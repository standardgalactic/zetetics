Artur Avila · Michael Th. Rassias
Yakov Sinai Editors
Analysis at 
Large
Dedicated to the Life and Work of 
Jean Bourgain

Analysis at Large

Artur Avila • Michael Th. Rassias • Yakov Sinai
Editors
Analysis at Large
Dedicated to the Life and Work of Jean
Bourgain

Editors
Artur Avila
Institute of Mathematics
University of Zurich
Zürich, Switzerland
Instituto Nacional de Matemática
Pura e Aplicada (IMPA)
Rio de Janeiro, Brasil
Michael Th. Rassias
Department of Mathematics and
Engineering Sciences
Hellenic Military Academy
Athens, Greece
Institute for Advanced Study
Program in Interdisciplinary Studies
Princeton, USA
Yakov Sinai
Department of Mathematics
Princeton University
Princeton, NJ, USA
ISBN 978-3-031-05330-6
ISBN 978-3-031-05331-3
(eBook)
https://doi.org/10.1007/978-3-031-05331-3
Mathematics Subject Classiﬁcation: 11-XX, 26-XX, 28-XX, 30-XX, 31-XX, 32-XX, 33-XX, 34-XX,
35-XX, 37-XX, 39-XX, 40-XX, 41-XX, 42-XX, 43-XX, 44-XX, 45-XX, 46-XX, 47-XX, 49-XX, 52-
XX, 53-XX, 57-XX, 58-XX, 60-XX, 65-XX, 68-XX, 70-XX, 76-XX, 81-XX, 83-XX, 90-XX, 91-XX,
93-XX
© The Editor(s) (if applicable) and The Author(s), under exclusive license to Springer Nature Switzerland
AG 2022
This work is subject to copyright. All rights are solely and exclusively licensed by the Publisher, whether
the whole or part of the material is concerned, speciﬁcally the rights of translation, reprinting, reuse
of illustrations, recitation, broadcasting, reproduction on microﬁlms or in any other physical way, and
transmission or information storage and retrieval, electronic adaptation, computer software, or by similar
or dissimilar methodology now known or hereafter developed.
The use of general descriptive names, registered names, trademarks, service marks, etc. in this publication
does not imply, even in the absence of a speciﬁc statement, that such names are exempt from the relevant
protective laws and regulations and therefore free for general use.
The publisher, the authors, and the editors are safe to assume that the advice and information in this book
are believed to be true and accurate at the date of publication. Neither the publisher nor the authors or
the editors give a warranty, expressed or implied, with respect to the material contained herein or for any
errors or omissions that may have been made. The publisher remains neutral with regard to jurisdictional
claims in published maps and institutional afﬁliations.
This Springer imprint is published by the registered company Springer Nature Switzerland AG
The registered company address is: Gewerbestrasse 11, 6330 Cham, Switzerland

Fig. 1 Photograph of Jean
Bourgain by Randall
Hagadorn (1994), Institute for
Advanced Study Public
Affairs photographs. From
the Shelby White and Leon
Levy Archives Center,
Institute for Advanced Study,
Princeton (N.J.).
Fig. 2 Photograph of Jean Bourgain and Russell Impagliazzo by Andrea Kane (circa 2010),
Institute for Advanced Study Public Affairs photographs. From the Shelby White and Leon Levy
Archives Center, Institute for Advanced Study, Princeton (N.J.)

Preface
Analysis at Large is a book dedicated to the great mathematician Jean Bourgain, who
passed away on December 22, 2018. His profound research has deeply inﬂuenced
an array of mathematical areas, with its main focus being in mathematical analysis
and its various facets and interconnections with other ﬁelds.
The present book publishes a highly selective collection of research and survey
papers in a wide spectrum of subjects which have been deeply inﬂuenced by
Bourgain’s monumental contributions and have led to celebrated breakthroughs
in mathematics. More speciﬁcally, topics investigated within this book include
Bourgain’s discretized sum-product theorem, Bourgain’s work in nonlinear dis-
persive equations, the slicing problem by Bourgain, harmonious sets, the joint
spectral radius, equidistribution of afﬁne random walks, Cartan covers and doubling
Bernstein type inequalities, a weighted Prékopa-Leindler inequality and sumsets
with quasicubes, the fractal uncertainty principle for the Walsh-Fourier transform,
the continuous formulation of shallow neural networks as Wasserstein-type gra-
dient ﬂows, logarithmic quantum dynamical bounds for arithmetically deﬁned
ergodic Schrödinger operators, polynomial equations in subgroups, trace sets of
restricted continued fraction semigroups, exponential sums, twisted multiplicativity
and moments, the ternary Goldbach problem, as well as the multiplicative group
generated by two primes in Z/QZ.
The papers have been contributed by leading experts in the corresponding topics
and present the state of the art in the problems treated, each paying homage to the
life and work of this pioneer in mathematics.
We are grateful to the mathematicians who have participated in this publication,
for contributing their valuable works in honor of J. Bourgain.
We also wish to thank the staff at Springer for their help throughout the
publication process of this book.
Zurich, Switzerland
Artur Avila
Athens, Greece
Michael Th. Rassias
Princeton, NJ, USA
Yakov Sinai
vii

Contents
On the Joint Spectral Radius ...................................................
1
Emmanuel Breuillard
The Failure of the Fractal Uncertainty Principle for the
Walsh–Fourier Transform ......................................................
17
Ciprian Demeter
The Continuous Formulation of Shallow Neural Networks as
Wasserstein-Type Gradient Flows .............................................
29
Xavier Fernández-Real and Alessio Figalli
On the Origins, Nature, and Impact of Bourgain’s Discretized
Sum-Product Theorem ..........................................................
59
Alexander Gamburd
Cartan Covers and Doubling Bernstein-Type Inequalities on
Analytic Subsets of C2 ........................................................... 101
Michael Goldstein, Wilhelm Schlag, and Mircea Voda
A Weighted Prékopa–Leindler Inequality and Sumsets with
Quasicubes ........................................................................ 125
Ben Green, Dávid Matolcsi, Imre Ruzsa, George Shakan,
and Dmitrii Zhelezov
Equidistribution of Afﬁne Random Walks on Some Nilmanifolds ......... 131
Weikun He, Tsviqa Lakrec, and Elon Lindenstrauss
Logarithmic Quantum Dynamical Bounds for Arithmetically
Deﬁned Ergodic Schrödinger Operators with Smooth Potentials .......... 173
Svetlana Jitomirskaya and Matthew Powell
The Slicing Problem by Bourgain .............................................. 203
B. Klartag and V. Milman
ix

x
Contents
On the Work of Jean Bourgain in Nonlinear Dispersive Equations ........ 233
Carlos E. Kenig
On Trace Sets of Restricted Continued Fraction Semigroups .............. 253
Alex Kontorovich
Polynomial Equations in Subgroups and Applications ...................... 273
Sergei V. Konyagin, Igor E. Shparlinski, and Ilya V. Vyugin
Exponential Sums, Twisted Multiplicativity, and Moments ................. 299
E. Kowalski and K. Soundararajan
The Ternary Goldbach Problem with a Missing Digit and Other
Primes of Special Types ......................................................... 333
Helmut Maier and Michael Th. Rassias
A Note on Harmonious Sets..................................................... 363
Yves François Meyer
On the Multiplicative Group Generated by Two Primes in Z/QZ ......... 373
Péter P. Varjú

On the Joint Spectral Radius
Emmanuel Breuillard
Dedicated to the memory of Jean Bourgain
Abstract For a bounded subset S of d × d complex matrices, the Berger-Wang
theorem and Bochi’s inequality allow to approximate the joint spectral radius of S
from below by the spectral radius of a short product of elements from S. Our goal
is twofold: we review these results, providing self-contained proofs, and we derive
an improved version with explicit bounds that are polynomial in d. We also discuss
other complete valued ﬁelds.
1
Introduction
We denote by ∥·∥a norm on Cd and its associated operator norm on the ring of d×d
matrices Md(C). For a bounded subset S ⊂Md(C), we let ∥S∥:= sups∈S ∥s∥. The
joint spectral radius [3, 10, 15, 27, 29] is deﬁned by:
ρ(S) :=
lim
n→+∞∥Sn∥
1
n
(1)
where Sn := {s1 · . . . · sn, si ∈S} is the n-th fold product set. From the submul-
tiplicativity of the operator norm, it is clear that the limit exists, is independent
of the choice of norm, and coincides with the inﬁmum of all ∥Sn∥
1
n , n ≥1. A
straightforward consequence is that S →ρ(S) is upper-semicontinuous for the
Hausdorff topology. Moreover ρ(Sk) = ρ(S)k for every k ∈N. It is also clear that
ρ(gSg−1) = ρ(S) for every g ∈GLd(C). Rota and Strang [27] observed that ρ(S)
is equal to the inﬁmum of ∥S∥as the norm varies among all possible norms on Cd.
Combined with John’s ellipsoid theorem, this easily yields:
E. Breuillard ()
DPMMS, University of Cambridge, Cambridge, UK
e-mail: Emmanuel.Breuillard@maths.ox.ac.uk
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
A. Avila et al. (eds.), Analysis at Large, https://doi.org/10.1007/978-3-031-05331-3_1
1

2
E. Breuillard
Lemma 1 Given a norm ∥·∥on Cd, for any bounded subset S ⊂Md(C), we have:
ρ(S) ≤
inf
g∈GLd(C) ∥gSg−1∥≤d · ρ(S).
When S is irreducible (i.e., does not preserve a proper subspace of Cd), it turns
out that there is norm such that ρ(S) = ∥S∥. The existence of such extremal norms
will be reviewed in Sect. 2 along with related known facts. It also follows easily from
this that ρ(S) = 0 if and only if the subalgebra C[S] generated by S is nilpotent.
It turns out that ρ(S) can also be approximated from below by eigenvalues. Let
(s) be the largest modulus of an eigenvalue of s ∈Md(C) and
(S) := max
s∈S (s).
It is clear that (S) ≤ρ(S) and thus (Sn)
1
n ≤ρ(S) for all n. When S is a
singleton, the classical Gelfand formula asserts that (s) = ρ({s}). For several
matrices, the key fact is as follows:
Theorem 1 (Berger-Wang [3])
ρ(S) = lim sup
n→+∞
(Sn)
1
n .
An immediate consequence is that S →ρ(S) is also lower-semicontinuous and
hence continuous for the Hausdorff topology. Theorem 1 had been conjectured by
Daubechies and Lagarias [10]. Elsner [11] gave a simple proof of it. In this article
we will be interested in giving explicit estimates quantifying this convergence. Our
ﬁrst observation is that in fact the following slightly stronger result holds:
Theorem 2 Let S ⊂Md(C) be a bounded subset with ρ(S) > 0. Then
lim sup
n→+∞
(Sn)
ρ(S)n = 1.
The question of the speed of convergence in Theorem 1 or 2 is an interesting one
and goes back at least to the Lagarias-Wang ﬁniteness conjecture [18], which posited
that the limsup should be attained at a certain ﬁnite n. This has been disproved by
Bousch and Mairesse [7] for 2 × 2 matrices (see also [13, 14, 21]), and Morris
(see [22, Thm 2.7]) gave an example with S = {a, b} ⊂SL2(R). In general,
counterexamples are thought to be rare.
Elsner’s proof of Theorem 1 is based on a pigeonhole argument, which we will
revisit in this note and can roughly be described as follows under the assumption
that S is irreducible: if ρ(S) = 1, then given a unit vector x ∈Cd, we may always

On the Joint Spectral Radius
3
ﬁnd s ∈S such that sx is also a unit vector (this follows from the existence of a
Barabanov norm, see Sect. 2), so iterating this construction, we eventually ﬁnd a
short product w = sn · . . . · sk with wy close to y = sk−1 · . . . · s1x, implying that w
has an eigenvalue close to 1. This idea also leads to a proof of Theorem 2 and to the
following quantitative and explicit version:
Theorem 3 Let S ⊂Md(C) be a bounded subset with ρ(S) = 1. Set n0(d) =
3d4d2 and let ε > 0. If n ≥ε−d2n0(d), then
max
k≤n (Sk) ≥1 −ε.
This yields a polynomial decay of the form | supk≤n (Sk) −1| = OS,d(n−1/d2)
in Theorem 2 when ρ(S) = 1. In [20] Morris proved a much stronger super-
polynomial upper bound on the speed of convergence: that is, | supk≤n (Sk)−1| =
OA,S(n−A) for every A ≥1, provided S is ﬁnite and ρ(S) = 1. However the implied
constant is not explicit. He also points out that his argument fails when S is inﬁnite.
In this note we will be interested in the d aspect. The bound on n in Theorem 3 is
super-exponential in d. If we aim to approximate the joint spectral radius no longer
up to a small error, but only up to a constant multiple, we can expect polynomial
bounds in d. In this vein, Bochi [5, Theorem B] established the following general
inequality:
Theorem 4 (Bochi [5]) There are constants c(d) > 0, N(d) > 0 such that for
every bounded set S ⊂Md(C) we have:
max
1≤k≤N(d) (Sk)
1
k ≥c(d) · ρ(S).
(2)
Note that Theorem 1 (but not Theorem 2) follows immediately from Bochi’s
inequality: indeed apply the inequality to Sn and let n tends to inﬁnity. On the other
hand, Theorem 3 implies Bochi’s inequality with N(d) = 3d8d2 and c(d) =
1
2
say. We are interested in quantifying the constants c(d) and N(d) in terms of the
dimension d. Example 1 (2) below shows that N(d) ≥d. Bochi’s proof gave
N(d) = 2d −1, but a non-constructive c(d) obtained via a topological argument
involving some geometric invariant theory.
In [8, 2.7, 2.9], another non-constructive proof was given with N(d) = d2. This
proof actually allows to take for N(d) = ℓ(d) the smallest upper bound on the
integer k such that for any S ⊂Md(C) the powers S, . . . , Sk span linearly the
matrix algebra C[S] generated by S. It is immediate that ℓ(d) ≤d2, but in a recent
breakthrough, Shitov [28] has proved that ℓ(d) ≤2d(log2 d + 2) greatly improving
an earlier bound in O(d3/2) due to Pappacena [24].
In order to motivate our main result and since it is very short, we give now a
direct proof of Theorem 4 using the following slight variant of the argument from
[8]:

4
E. Breuillard
Claim 1 There is c′(d) > 0 such that for every bounded subset S of Md(C) with
ρ(S) = 1 there is a non-zero idempotent p ∈Md(C) (i.e., p2 = p) such that c′(d)p
belongs to the complex convex hull of S, . . . , Sℓ(d).
Proof By the complex convex hull Conv(Q) of Q ⊂Md(C), we mean the set of
linear combinations α1q1 +. . .+αnqn with qi ∈Q and |α1|+. . .+|αn| = 1. Since
the problem is invariant under conjugation, in view of Lemma 1, we may assume
that S is conﬁned to a bounded region of Md(C), allowing us to pass to a Hausdorff
limit of potential counterexamples to the claim. By compactness and upper semi-
continuity of the joint spectral radius, we get a bounded subset S with ρ(S) ≥1,
but such that Conv(S ∪. . . ∪Sℓ(d)) contains no scalar multiple of an idempotent.
In particular, C[S] contains no idempotent. By the Artin-Wedderburn theorem, this
means that C[S] is a nilpotent subalgebra of Md(C). In particular, Sd = 0, which is
in contradiction with ρ(Sd) = ρ(S)d ≥1.
⊓⊔
Proof of Theorem 4 If ρ(S) = 0, there is nothing to prove. Otherwise, rescaling we
may assume ρ(S) = 1. If the left-hand side in (2) is at most c (and we may assume
c ≤1, so ck ≤c), then the trace of any element in Sk, k ≤ℓ(d), is at most cd
in modulus. The trace of the idempotent element p found in Claim 1 is a non-zero
integer. So c′(d) ≤c′(d)|Tr(p)| ≤cd. So setting c(d) = c′(d)/d and N(d) = ℓ(d)
yields (2) as desired.
⊓⊔
As with Bochi’s original argument, this one does not give any explicit estimate
on the constant c(d). It is however possible to “effectivize” the argument just given:
this requires effectivizing the proof of Wedderburn’s theorem and, after a fairly
painstaking analysis, the details of which we will spare the reader, yields a rather
poor lower bound on c(d) of doubly exponential type in d. Another route is to
use an idea appearing in the work of Oregon-Reyes [23, Rk. 4.5], which consists
in using the effective arithmetic nullstellensatz by making explicit the implication
{Tr(Sk) = 0 for all k = 1, . . . , ℓ(d)} ⇒{Sd = 0}. This also yields an effective
bound on c(d), which is again unfortunately rather poor, at least doubly exponential
in d.
The following result, which is the main contribution of this note, gives explicit
polynomial bounds on both c(d) and N(d).
Theorem 5 For every bounded set S ⊂Md(C), we have:
max
1≤k≤2d3 (Sk)
1
k ≥
1
28d5 · ρ(S).
In particular, applying this to Sm for a suitable integer m, we also have:
max
1≤k≤N2(d) (Sk)
1
k ≥1
2 · ρ(S),
where N2(d) = 2d3⌈8 + 5 log2 d⌉.

On the Joint Spectral Radius
5
By the same trick of replacing S by Sm for suitable m, the factor 1
2 can of course
be replaced by any number κ < 1 provided N2(d) is replaced by Nκ−1(d) :=
2d3⌈logκ−1(28d5)⌉. The proof exploits a different kind of pigeonhole argument,
where one argues, as in the classical Siegel lemma in number theory, that some non-
zero linear combination with small integer coefﬁcients of the iterates sn·. . .·s1x will
vanish or be very small. In turn, this forces one of the products to have a spectral
radius bounded away from zero.
The following natural questions then arise:
Questions How sharp is the bound d3+o(1) on N2(d)? We only know that N2(d)
must be at least d. Is there a polynomial bound on c′(d) in Claim 1 above?
In [5, Theorem A], Bochi proves another inequality, giving this time a lower
bound on ρ(S) in terms of the norms of Sn, which, when iterated, gives a speed of
convergence for (1); see [16]. Given any norm ∥· ∥on Cd,
∥Sd∥≤C0(d)ρ(S)∥S∥d−1.
(3)
While no explicit bound on C0(d) was given in [5], his proof gives a super-
polynomial bound in d3d/2 (see [16, Section 4]). It turns out that the pigeonhole
argument for our Theorem 5 gives a polynomial bound for (3) at the expense of
increasing the power of S:
Theorem 6 Let S ⊂Md(C) be a bounded subset and set n1 = 2d2. Then
∥Sn1∥≤27d4ρ(S)∥S∥n1−1.
(4)
Iterating (4) yields an explicit estimate quantifying the convergence in (1)
improving the bounds obtained in [16, Theorem 1].
Finally we examine what happens when the ﬁeld C is replaced by an arbitrary
algebraically closed complete valued ﬁeld (K, |·|). By Ostrowski’s theorem, if K is
not C, it must be non-Archimedean (for instance, Cp the completion of the algebraic
closure of the ﬁeld of p-adic numbers Qp, or the completion of the ﬁeld of Laurent
series over the algebraic closure of Fp). All of the above makes sense of course, and
the joint spectral radius is deﬁned in the same way. As it turns out, the analogues
of the results above are much simpler for such K, the Lagarias-Wang ﬁniteness
conjecture holds in a uniform way, and in fact:
Theorem 7 Let K be an algebraically closed non-archimedean complete valued
ﬁeld. Consider an ultrametric norm ∥·∥0 on Kd and a bounded subset S of Md(K).
Then
max
1≤k≤ℓ(d) (Sk)
1
k = ρ(S) =
inf
g∈GLd(K) ∥gSg−1∥0.
(5)
Moreover, ρ(S) > 0 if and only if the subalgebra generated by S is not nilpotent, in
which case there is an ultrametric norm ∥· ∥on Kd with ∥S∥= ρ(S).

6
E. Breuillard
Recall that ℓ(d) denotes the smallest integer k such that for any ﬁeld F and any
S ⊂Md(F) the power sets S, . . . , Sk span linearly the algebra F[S]. Obviously
ℓ(d) ≤d2 and recall that in fact ℓ(d) ≤2d log2 d + 4d −4 by [28].
If K is not algebraically closed, then (5) still holds with K replaced by its
algebraic closure K (indeed, the absolute value extends uniquely to K and the
completion of K will remain algebraically closed by Kürschák’s theorem [26, 5.J.]).
In the special case, when K is a local ﬁeld and S a compact subgroup of GLd(K),
the last assertion of the theorem recovers the well-known Bruhat-Tits ﬁxed point
theorem: the norm ∥· ∥will be preserved by S and thus be a ﬁxed point in the
Bruhat-Tits building of ultrametric norms [12].
Theorem 7 was proved in [8] for K = Cp. We will give a slightly more direct
proof of the general case.
Similarly, the analogue of Theorem 6 reads:
Theorem 8 For any ultrametric norm ∥· ∥0 on Kd and S ⊂Md(K) bounded
∥Sd∥0 ≤ρ(S)∥S∥d−1
0
.
(6)
2
Extremal Norms and Barabanov Norms
In this section we recall some well-known facts about the joint spectral radius and
extremal norms providing complete and self-contained proofs. Most of the material
can be found in the ﬁrst chapters of the book [15]. We then prove Theorem 2.
We begin by the observation of Rota and Strang mentioned in the introduction.
Recall that ∥· ∥denotes both a norm on Cd and its associated operator norm and
that for some subset Q (in either Cd or Md(C)), we set ∥Q∥:= supq∈Q ∥q∥.
Lemma 2 (Rota-Strang) Let S ⊂Md(C) be a bounded subset.
ρ(S) = inf
∥·∥∥S∥,
(7)
where the inﬁmum is over all norms on Cd.
Proof Let r > 0 with rρ(S) < 1 and consider the norm vr(x) := 
n≥0 ∥Snx∥rn.
Clearly vr(sx) ≤1
r vr(x) for all s ∈S. So vr(S) ≤r−1. Letting r−1 tend to ρ(S)
yields the result.
⊓⊔
Lemma 1 follows immediately by combining Lemma 2 with the following well-
known fact:
Lemma 3 (John’s Ellipsoid) If v is a norm on Cd and ∥·∥2 the standard hermitian
norm, then there is g ∈GLd(C) such that for all x ∈Cd

On the Joint Spectral Radius
7
∥gx∥2 ≤v(x) ≤
√
d · ∥gx∥2.
In particular if w(x) is any another norm, then for some h ∈GLd(C)
w(hx) ≤v(x) ≤d · w(hx).
Proof According to John’s ellipsoid theorem (e.g., [1]), every symmetric convex
body K in Rk contains a unique ellipsoid E of maximal volume and E moreover
satisﬁes K ⊂
√
dE. If K is the ball of radius 1 of the complex norm v in Cd = R2d,
then the uniqueness implies that the norm associated to E is hermitian, hence of the
form ∥gx∥2 for some g ∈GLd(C).
⊓⊔
Remark 1 This argument shows that the constant d in Lemma 1 can be replaced by
√
d if the norm is ∥· ∥2. In fact a more subtle argument (see, e.g., [4]) shows that it
can be replaced with √min{k, d} in case S has k elements.
One says that S is irreducible if it does not preserve a non-trivial proper subspace
of Cd. It is said to be product bounded if the semigroup it generates T := 
n≥1 Sn
is bounded. The following is also classical (see [2, 3, 11, 29]):
Lemma 4 (Extremal Norms) Suppose S is irreducible. Then ρ(S) > 0, S/ρ(S) is
product bounded and the inﬁmum in (7) is attained.
Norms realizing the inﬁmum in (7) are called extremal norms.
Proof By Burnside’s theorem, the subalgebra C[S] generated by S is all of Md(C).
Since C[S] is linearly spanned by S ∪. . . ∪Sd2, we may express each element
of the canonical basis Eij of Md(C) as a linear combination of elements from T .
Given that Tr(Eii) = 1, this means that at least one element of T has non-zero
trace, which clearly forces ρ(S) > 0. Rescaling, we may assume without loss of
generality that ρ(S) = 1. In particular |Tr(t)| ≤d for all t ∈T and thus |Tr(tEij)|
is bounded independently of t ∈T , which means that T is bounded. Finally, given
any norm ∥· ∥on Cd and setting v(x) := ∥T x∥, we get a well-deﬁned norm such
that v(sx) ≤v(x) for all s ∈S. Hence v is an extremal norm.
⊓⊔
The example of a single non-trivial unipotent matrix shows that the inﬁmum in
(7) is not attained in general. If S is not irreducible, it can be put in block triangular
form in some basis of Cd. Therefore the following is an immediate consequence of
the previous lemma (recall that an algebra N is nilpotent if there is an integer n such
that Nn = 0).
Corollary 1 Let S be a bounded subset of Md(C). Then ρ(S) = 0 if and only if
C[S] is a nilpotent subalgebra of Md(C).
If S is irreducible and ρ(S) = 1, T is bounded, and we may deﬁne
v(x) := lim sup
n→+∞
∥Snx∥.
(8)

8
E. Breuillard
Then v is a norm, because v(x) = 0 for some x ̸= 0 implies v(Snx) = 0 for all n,
which implies by irreducibility that v is identically zero and hence that ρ(S) = 0.
In particular:
Lemma 5 (Barabanov Norms) Let S be an irreducible bounded subset of Md(C),
then there is a complex norm v on Cd such that for all x ∈Cd,
max
s∈S v(sx) = ρ(S) · v(x).
(9)
Proof Indeed we may deﬁne v as in (8) for S replaced by S/ρ(S).
⊓⊔
A norm satisfying (9) is a special kind of extremal norm called a Barabanov norm
(see [2, 17, 25, 29]). Such norms are not unique in general (e.g., in Example 1 4.
below any norm ∥· ∥on Cd with ε∥x∥2 ≤∥x∥≤∥x∥2 is a Barabanov norm for S),
but they can be in some situations [19].
Another object is naturally associated to S when ρ(S) = 1; it is the attractor
semigroup [2, 29]
T∞:=

n≥1
SnT .
In other words, this is the set of limit points of ﬁnite products s1·. . .·sn whose length
n tends to inﬁnity. It is clearly compact, and for every operator norm, it contains an
element of norm at least 1. Indeed otherwise we would have ∥Sn∥< 1 for some n
and thus ρ(Sn) < 1, which is impossible as ρ(Sn) = ρ(S)n = 1. By construction,
the Barabanov norm (8) is also equal to v(x) = maxt∈T∞∥tx∥. Furthermore, it is
straightforward that T∞= T∞S = ST∞and T 2
∞= T∞and that:
Lemma 6 Suppose S is irreducible with ρ(S) = 1. Then T∞is also irreducible
and ρ(T∞) = 1.
Proof For every non-zero x ∈Cd, the linear span ⟨T∞⟩x contains ⟨T∞⟩Skx for each
k and hence ⟨T∞⟩Cd by irreducibility of S. So this must be 0 or Cd. The former is
impossible, because T∞̸= {0} by the above discussion. So T∞is irreducible. Finally
by construction v(T∞) = 1 and T k
∞= T∞for every k. Hence ρ(T∞) = 1.
⊓⊔
We are now in a position to prove Theorem 2.
Lemma 7 (Existence of an Idempotent) Suppose S is a bounded irreducible
subset of Md(C) with ρ(S) = 1. Then the attractor semigroup T∞contains a non-
zero idempotent.
Proof Let K be the subset of T∞made of elements with operator norm 1 for the
Barabanov norm (8). We have already seen that K is non-empty. If ab has norm one
and a, b ∈T∞, then both a and b have norm one. So K ⊂K2. Starting from some
t0 ∈K, we may write t0 = t1s1 with t1, s1 ∈K, and then similarly t1 = t2s2, etc.
For each n we have t0 = tnsn·. . .·s1. By compactness of K, there is a subsequence ni

On the Joint Spectral Radius
9
such that sni ·. . .·s1 converges, say towards k ∈K. Passing to a further subsequence,
we may assume that sni+1 · . . . · sni+1 also converges, say towards u ∈K. At the
limit we have k = uk. But there is a unit vector x such that y := kx has norm
1. Hence y = uy and u has 1 as an eigenvalue. So T∞contains an element u
with eigenvalue 1. Now looking at u in Jordan normal form and considering large
powers of u, we see that the Jordan blocks with eigenvalue of modulus 1 must be of
size 1, because powers of non-trivial unipotents are unbounded. Therefore {un}n≥1
contains an idempotent in its closure.
⊓⊔
Note that T∞may contain 0, so the lemma does not follow from a general result
guaranteeing the existence of idempotents in compact semigroups such as the Ellis-
Numakura lemma.
Proof of Theorem 2 We ﬁrst assume that S is irreducible. Rescaling, we may
assume that ρ(S) = 1. By Lemma 7, T∞contains an idempotent. In particular,
(T∞) = 1, which implies what we want. The general case follows from the
irreducible one. Indeed if S is not irreducible, it can be put in block triangular form,
and if Sii denotes the i-th diagonal block, then it is straightforward to check (either
from the deﬁnition or more directly from Theorem 1) that ρ(S) = maxi ρ(Sii).
⊓⊔
Example 1 The following are examples of irreducible subsets of Md(C) with joint
spectral radius equal to 1.
1. S = {Eij}ij the elementary matrices in Md(C). Note that S is made of rank 1
elements and T∞= S ∪{0}.
2. S = {Ei,i+1}1≤i<d ∪{Ed1}. Note that T = T∞= {0} ∪{Eij}ij.
3. S = Ud(C) ∪{t}, where Ud(C) is the group of unitary matrices and t =
diag(α1, . . . , αd) with |αi| < 1. Then T∞= T ∪{0}.
4. S = {id} ∪εUd(C) for ε < 1. Then T∞= T ∪{0}.
3
Explicit Bounds for Theorem 2
In this section we prove Theorem 3. We need a basic lemma.
Lemma 8 Let ∥· ∥be a norm on Cd. Let A ∈Md(C) and x ∈Cd with ∥A∥≤1
and ∥x∥= 1. Let ε > 0 and λ ∈C with |λ| ≤2. Assume that ∥Ax −λx∥≤(ε|λ|)d.
Then the spectral radius (A) of A satisﬁes (A) ≥|λ|(1 −4ε).
Proof Writing Akx −λkx = Ak−1(Ax −λx) + . . . + λk−1(Ax −λx) and using
that ∥A∥≤1, we obtain for k ≤d
∥Akx −λkx∥≤(ε|λ|)d(1 + |λ| + . . . + |λ|k−1) ≤(2ε|λ|)d.
If χA(t) = td + ad−1td−1 + . . . + a0 is the characteristic polynomial of A, then
∥χA(A)x −χA(λ)x∥≤ |ak|∥Akx −λkx∥, and χA(A) = 0 by Cayley-Hamilton.

10
E. Breuillard
But |ad−k| ≤
d
k

, and so |χA(λ)| ≤2d(2ε|λ|)d. To prove the claim, we may assume
that |λ| ≥(A). Writing αi for the roots of χA, the claim then follows from
||λ| −(A)|d ≤
d
1
||λ| −|αi|| ≤|χA(λ)|.
⊓⊔
Proof of Theorem 3 We may put S in block triangular form. Since ρ(S)
=
maxi ρ(Sii), at least one of the irreducible diagonal blocks Sii has ρ(Sii) = 1.
Hence, without loss of generality, we may assume that S is irreducible. Let v be
a Barabanov norm for S as in Lemma 5. Pick a unit vector x0 ∈Cd and ﬁnd
recursively s1, s2, . . . such that xn = sn · . . . · s1x0 satisﬁes v(xn) = 1 for all n ≥0.
Let δ = (ε/4)d. Note that the cardinality of a δ-separated set lying in the unit ball
for v is at most (1 + δ/2)d/(δ/2)d = (1 + 2
δ )d ≤n0(d)ε−d2, because the v-balls
of radius δ
2 centered at these points are disjoint and contained in the v-ball of radius
1 + δ
2 around the origin. By pigeonhole, there are 0 ≤n < n′ both smaller than
n0(d)ε−d2 such that v(xn −xn′) < δ. In other words, v(Axn −xn) < δ, where
A := sn′ · . . . · sn+1. By Lemma 8, it follows that (A) ≥1 −4δ1/d = 1 −ε.
⊓⊔
4
Explicit Bounds for Bochi’s Inequalities
In this section we prove Theorems 5 and 6. We begin by the Siegel-type lemma
already mentioned.
Lemma 9 (Siegel-Type Lemma) Let ∥· ∥be a norm on Cd. Let ε ∈(0, 1) and
T, n ∈N with (1 + T )n > (1 + 2nT ε−1)d. Pick x1, . . . , xn vectors in Cd with
∥xi∥≤1. Then there are integers c1, . . . , cn, not all zero, such that |ci| ≤T for all
i and
∥
n

1
cixi∥≤ε.
Proof Consider the sums n
1 dixi for integers di ∈[0, T ]. They have norm at most
T n. If all ε
2-balls around them were disjoint, then the ball of radius T n+ ε
2 around the
origin would contain at least (1+T )n disjoint balls of radius ε
2. Comparing volumes
we would have (1+T )n ≤(T n+ε/2)d/(ε/2)d, contrary to our assumption. Hence,
two of these balls, corresponding to (di)i and (d′
i)i, say, must intersect. Setting ci =
d′
i −di we get what we want.
⊓⊔
Lemma 10 Let ε > 0. Let A ∈Md(C) such that |Tr(Ak)| ≤εk for k = 1, . . . , d.
Then the spectral radius of A satisﬁes (A) ≤2ε.

On the Joint Spectral Radius
11
Proof Let sk = λk
1 + . . . + λk
d, where λ1, . . . , λd are the eigenvalues of A. The
Newton relations read sk + ad−1sk−1 + . . . + ad−k+1s1 = −kad−k, where td +
ad−1td−1 +. . .+a0 is the characteristic polynomial χA of A. We deduce from them
that |ad−k| ≤εk for each k = 1, . . . , d. If λ is an eigenvalue of A, then χA(λ) = 0
and thus
|λ|d ≤ε|λ|d−1 + . . . + εk|λ|d−k + . . . + εd.
Setting x = ε/|λ|, we obtain 1 ≤x + . . . + xd. But this implies x ≥1/2.
⊓⊔
Lemma 11 Let n ∈N and S ⊂Md(C) be a bounded set such that ε :=
maxk≤nd (Sk)
1
k ≤1. Let Q be the complex convex hull of S ∪. . . ∪Sn. Then
(Q) ≤2dε.
Proof Note that Conv(A)Conv(B) ⊂Conv(AB) for any two sets A, B ⊂Md(C).
So if a ∈Q, then ak belongs to the convex hull of 
k≤i≤nk Si. In particular
|Tr(ak)| ≤dεk ≤(dε)k
for each k = 1, . . . , d. The conclusion now follows from Lemma 10.
⊓⊔
We now prove Theorem 5. Rescaling and triangularizing S if necessary, we may
assume without loss of generality that ρ(S) = 1 and that S is irreducible. As in the
proof of Theorem 3, take a Barabanov norm ∥· ∥for S. Pick a unit vector x ∈Cd
and ﬁnd s1, . . . , sn, . . . in S such that ∥xn∥= 1 for all n, where xn := sn · . . . · s1x.
For T and ε > 0 as in Lemma 9, we obtain integers ci not all zero such that |ci| ≤T
and ∥n
1 cixi∥≤ε. Let i0 be the smallest index i with ci ̸= 0 and set y = xi0.
Hence, we may write:
∥ci0y +

i>i0
cisi · . . . · si0+1y∥≤ε.
In other words:
∥λy −Ay∥≤ε
N ,
(10)
where A :=
1
N

i>i0 −cisi · . . . · si0+1, λ =
ci0
N and N := 
i>i0 |ci|. Note that
N ̸= 0, because ε < 1 and ∥xi∥= 1 for all i. Note further that ∥A∥≤1 because
∥s∥≤1 for all s ∈S. And that |λ| ≥1
N ≥
1
T n, while |λ| ≤∥Ay∥+ ε
N ≤1+ ε
N ≤2.
We can then apply Lemma 8 to A and λ and get
(A) ≥|λ| −4( ε
N )
1
d ≥
1
2N ≥
1
2nT .

12
E. Breuillard
provided 4( ε
N )
1
d ≤1/2N. The conditions for Lemma 8 require that |λ| ≤2, while
those for Lemma 9 require (1 + T )n > (1 + 2nT ε−1)d. These conditions will be
fulﬁlled if we set T = 32d2, n = 2d2, and ε−1 = 8d(nT )d−1. We conclude that
(A) ≥
1
27d4 .
However, A belongs to the convex hull of S ∪. . .∪Sn. Therefore Lemma 11 implies
that
max
k≤nd (Sk)
1
k ≥
1
28d5 .
This yields the ﬁrst inequality in Theorem 5. The second follows by applying the
ﬁrst to Sm for m = ⌈8 + 5 log2 d⌉.
Proof of Theorem 6 This is very similar. Suppose ∥S∥= 1 and let δ = ∥Sn1∥. Pick
a unit vector x and s1, . . . , sn1 such that ∥sn1 · . . . · s1x∥= δ. Arguing as in the
above proof of Theorem 5, we get a y with ∥y∥≥δ such that (10) holds. Lemma 8
gives (A) ≥
1
2n1T if ε is chosen so that 4(εδ−1/n1T )1/d = 1/2n1T . Then setting
n1 = 2d2, n1T = Mδ−1, we see that the condition for Lemma 9 is fulﬁlled if
M ≥26d4. But ρ(S) ≥(A) ≥δ/2M, proving the claim.
⊓⊔
5
Ultrametric Complete Valued Fields
In this section we consider the analogue of the above for an algebraically closed
complete and non-Archimedean valued ﬁeld K and prove Theorem 7.
Let O := {x ∈K, |x| ≤1} be the ring of integers, m := {x ∈K, |x| < 1} its
maximal ideal, and k = O/m the residue ﬁeld. Recall that the value group of K is
dense in R>0 since K is algebraically closed. By an ultrametric norm on Kd, we
mean a map ∥· ∥: K →R≥0 such that ∥λx∥= |λ|∥x∥, ∥x + y∥≤max{∥x∥, ∥y∥},
and ∥x∥= 0 if and only if x = 0, for all x, y ∈Kd, λ ∈K.
An orthogonal basis for an ultrametric norm is a basis (ei)d
1 of Kd such that
∥x∥= max{ci|xi|} for some positive reals ci, if x = x1e1 + . . . + xded. We say
that it is orthonormal if ci = 1 for all i. If K is locally compact, or just spherically
complete [6, 2.4.4], all ultrametric norms admit an orthogonal basis, but in general
we only have:
Lemma 12 Let v and w be two ultrametric norms on Kd and α > 1 a real. Then
there is g ∈GLd(K) such that w(x) ≤v(gx) ≤αw(x) for all x ∈Kd.
Proof This is well-known and follows from the existence [6, 2.6.2 Prop. 3] of
almost orthogonal bases for ultrametric norms on Kd and the density in R+ of the
value group of K.
⊓⊔

On the Joint Spectral Radius
13
We begin by pointing out that the Rota-Strang observation, Lemma 2, and its
proof remain valid in the ultrametric setting. Combined with Lemma 12, this yields
the right-hand side of (5). It turns out that the inﬁmum in (7) is realized under some
mild conditions (milder than in the complex case):
Lemma 13 Suppose that the value group of K is all of R>0 and S ⊂Md(K) is
a bounded set. If ρ(S) = 0, then Sd = 0, while if ρ(S) > 0, then there is an
ultrametric norm ∥· ∥on Kd with ∥S∥= ρ(S).
Proof The ﬁrst assertion follows from the same argument as in Lemma 4. If ρ(S) >
0, we may rescale and assume that ρ(S) = 1, because we can pick λ ∈K with
|λ| = ρ(S). If S is irreducible, then the proof of Lemma 4 works verbatim and yields
the desired norm. In general, we may choose a basis of Kd for which S is in block
triangular form with irreducible blocks and deﬁne the norm ∥x∥= maxi ∥xi∥i,
where ∥· ∥i is a norm on the i-th block with ρ(Sii) = ∥Sii∥i, provided Sii ̸= 0
and arbitrary otherwise. We may further conjugate S by a block diagonal matrix g,
where the i-th block is the scalar matrix ti for some t ∈K with 0 ̸= |t| < 1/∥S∥.
Then, because of the ultrametric property, ∥gSg−1∥≤1. Thus ∥g · g−1∥is the
desired norm.
⊓⊔
We now proceed to the proof of Theorem 7. It follows the same idea as in the
proof of Claim 1 from the introduction, but we will need to palliate the lack of
compactness and the fact that the value group may not be all of R>0 by the use of
an ultrapower construction. The gist of the proof is in the following lemma:
Lemma 14 Suppose that ∥· ∥is an ultrametric norm admitting an orthonormal
basis. If S ⊂Md(K) is such that ∥S∥= ρ(S) = 1, then
max
k≤ℓ(d) (Sk) = 1.
Proof Let (ei)d
1 be the orthonormal basis, i.e., ∥x∥= maxd
1 |xi| if x = x1e1 + . . . +
xded. In this basis, S ⊂Md(O). Consider the convex hull Q of S, . . . , Sℓ(d), that is,
the O-module they span. If (Sk) < 1 for each k = 1, . . . , ℓ(d), the characteristic
polynomial of a matrix in Sk will be td modulo m. So the image of Q modulo m
in Md(k) will consist of nilpotent matrices, and it will be a subalgebra of Md(k)
by deﬁnition of ℓ(d). By Wedderburn’s theorem, it will therefore be a nilpotent
algebra, and we conclude that Sd ⊂Md(m). In particular, ∥Sd∥< 1, contradicting
our assumption that ρ(S) = 1.
⊓⊔
Proof of Theorem 7 Suppose ﬁrst that the value group of K is all of R>0 and that
all ultrametric norms on Kd admit an orthonormal basis. Then the theorem follows
from the combination of the two previous lemmas by renormalizing S. So to handle
the general case, it is enough to show that K can be embedded in another such ﬁeld
with the above properties. Any ultralimit K = ℓ∞(K)/ ≡of K with respect to
some non-principal ultraﬁlter U on N will do. Here ℓ∞(K) is the space of bounded
sequences in K and (xn)n ≡(yn)n if and only if limU |xn −yn| = 0. Indeed,

14
E. Breuillard
by the countable saturation property of ultraproducts (e.g., [9, 2.25]), an ultralimit
K will again be complete and algebraically closed, its value group will be R>0,
and, because of Lemma 12, all norms will admit an orthonormal basis. This shows
Theorem 7 in full.
⊓⊔
Proof of Theorem 8 This follows from Bochi’s original argument [5, Theorem A]
suitably adapted to the ultrametric setting. First, up to passing to a suitable ﬁeld
extension as in the proof of Theorem 7, we may assume that all norms admit an
orthonormal basis. Pick one so that ∥x∥0 = maxi |xi|. Then observe the following:
for every invertible diagonal matrix a, we have:
∥aSda−1∥0 ≤∥S∥0 · ∥aSa−1∥d−1
0
.
(11)
Indeed every matrix entry of an element of aSda−1 is a sum of monomials of the
form ai1s(1)
i1i2 ·. . .·s(d)
idid+1a−1
id+1 for matrices s(i) ∈S. We may write it as ai1s(1)
i1i2a−1
i2 ai2 ·
. . .·a−1
id aids(d)
idid+1a−1
id+1, a product of d factors each bounded by ∥aSa−1∥0. However
at least one of the d factors is bounded by ∥S∥0, because for at least one j ∈[1, d],
|a−1
ij aij+1| ≤1, proving (11). Now we claim that (11) holds for an arbitrary matrix
a ∈GLd(K), no longer assumed diagonal. Indeed this follows from the fact that
∥· ∥0 is invariant under GLd(O) and that any matrix in GLd(K) can be written as a
product k1ak2, with k1, k2 in GLd(O) and a diagonal, as can be easily checked using
operations on rows and columns as in Gaussian elimination. Finally, the theorem is
proved taking the inﬁmum in overall a ∈GLd(K) in view of (7).
⊓⊔
Finally we record one last observation.
Proposition 1 If S
⊂Md(K) is bounded and irreducible, then it admits a
Barabanov norm, i.e., an ultrametric norm ∥· ∥such that maxs∈S ∥sx∥= ρ(S)∥x∥
for all x ∈Kd.
Proof By the proof of Theorem 7, we may embed K into a complete algebraically
closed valued ﬁeld K whose value group is all of R>0. Pick λ ∈K with |λ| = ρ(S).
Then Lemma 13 implies that λ ̸= 0 and that S := S/λ ⊂Md(K) is product bounded
and admits an extremal norm ∥· ∥. We may deﬁne the Barabanov norm of S by the
same formula (8) applied to S. Irreducibility forces this semi-norm to be a genuine
norm.
⊓⊔
Acknowledgments I am grateful to Cagri Sert for many interesting discussions about the joint
spectral radius and for his remarks on this article. I am also indebted to Eduardo Oregon-Reyes for
his comments and to Ian Morris for bringing my attention to Bochi’s other inequality (3) and to
related references. Finally I wish to thank the anonymous referee for their comments and helpful
suggestions.

On the Joint Spectral Radius
15
References
1. Ball, K.: An elementary introduction to modern convex geometry. In: Flavors of Geometry,
vol. 31 of Math. Sci. Res. Inst. Publ., pp. 1–58. Cambridge Univ. Press, Cambridge (1997)
2. Barabanov, N.E.: On the Lyapunov exponent of discrete inclusions. I–III. Avtomat. i Telemekh.
(2), 40–46 (1988)
3. Berger, M.A., Wang, Y.: Bounded semigroups of matrices. Linear Algebra Appl. 166, 21–27
(1992)
4. Blondel, V.D., Nesterov, Y.: Computationally efﬁcient approximations of the joint spectral
radius. SIAM J. Matrix Anal. Appl. 27(1), 256–272 (2005)
5. Bochi, J.: Inequalities for numerical invariants of sets of matrices. Linear Algebra Appl. 368,
71–81 (2003)
6. Bosch, S., Güntzer, U., Remmert, R.:
Non-Archimedean analysis, vol.261. Grundlehren
der Mathematischen Wissenschaften [Fundamental Principles of Mathematical Sciences].
Springer, Berlin (1984). A systematic approach to rigid analytic geometry
7. Bousch, T., Mairesse, J.: Asymptotic height optimization for topical IFS, Tetris heaps, and the
ﬁniteness conjecture. J. Am. Math. Soc. 15(1), 77–111 (2002)
8. Breuillard, E.: A height gap theorem for ﬁnite subsets of GLd(Q) and nonamenable subgroups.
Ann. Math. (2) 174(2), 1057–1110 (2011)
9. Chatzidakis, Z.:
Motivic integration and its interactions with model theory and non-
Archimedean geometry. Vol.I, vol.383. London Mathematical Society Lecture Note Series.
Cambridge University Press, Cambridge (2011)
10. Daubechies, I., Lagarias, J.C.: Sets of matrices all inﬁnite products of which converge. Linear
Algebra Appl. 161, 227–263 (1992)
11. Elsner, L.:
The generalized spectral-radius theorem: an analytic-geometric proof.
In:
Proceedings of the Workshop “Nonnegative Matrices, Applications and Generalizations” and
the Eighth Haifa Matrix Theory Conference (Haifa, 1993), vol. 220, pp. 151–159 (1995)
12. Goldman, O., Iwahori, N.: The space of p-adic norms. Acta Math. 109, 137–177 (1963)
13. Hare, K.G., Morris, I.D., Sidorov, N., Theys, J.: An explicit counterexample to the Lagarias-
Wang ﬁniteness conjecture. Adv. Math. 226(6), 4667–4701 (2011)
14. Jenkinson, O., Pollicott, M.:
Joint spectral radius, Sturmian measures and the ﬁniteness
conjecture. Ergodic Theory Dynam. Syst. 38(8), 3062–3100 (2018)
15. Jungers, R.: The joint spectral radius, vol. 385. Lecture Notes in Control and Information
Sciences. Springer, Berlin (2009). Theory and Applications
16. Kozyakin, V.: On accuracy of approximation of the spectral radius by the Gelfand formula.
Linear Algebra Appl. 431(11), 2134–2141 (2009)
17. Kozyakin, V.: Iterative building of Barabanov norms and computation of the joint spectral
radius for matrix sets. Discrete Contin. Dyn. Syst. Ser. B 14(1), 143–158 (2010)
18. Lagarias, J.C., Wang, Y.: The ﬁniteness conjecture for the generalized spectral radius of a set
of matrices. Linear Algebra Appl. 214, 17–42 (1995)
19. Morris, I.D.: Criteria for the stability of the ﬁniteness property and for the uniqueness of
Barabanov norms. Linear Algebra Appl. 433(7), 1301–1311 (2010)
20. Morris, I.D.: A rapidly-converging lower bound for the joint spectral radius via multiplicative
ergodic theory. Adv. Math. 225(6), 3425–3445 (2010)
21. Morris, I.D., Sidorov, N.: On a devil’s staircase associated to the joint spectral radii of a family
of pairs of matrices. J. Eur. Math. Soc. (JEMS) 15(5), 1747–1782 (2013)
22. Oregón-Reyes, E.: Properties of sets of isometries of Gromov hyperbolic spaces. Groups
Geom. Dyn. 12(3), 889–910 (2018)
23. Oregón-Reyes, E.: A new inequality about matrix products and a Berger-Wang formula. J. Éc.
polytech. Math. 7, 185–200 (2020)
24. Pappacena, C.J.: An upper bound for the length of a ﬁnite-dimensional algebra. J. Algebra
197(2), 535–545 (1997)
25. Protasov, V.Yu.: A generalized joint spectral radius. A geometric approach. Izv. Ross. Akad.
Nauk Ser. Mat. 61(5), 99–136 (1997)

16
E. Breuillard
26. Ribenboim, P.: The Theory of Classical Valuations. Springer Monographs in Mathematics.
Springer, New York (1999)
27. Rota, G.-C., Strang, G.: A note on the joint spectral radius. Nederl. Akad. Wetensch. Proc. Ser.
A 63 = Indag. Math. 22, 379–381 (1960)
28. Shitov, Y.: An improved bound for the lengths of matrix algebras. Algebra Number Theory
13(6), 1501–1507 (2019)
29. Wirth, F.: The generalized spectral radius and extremal norms. Linear Algebra Appl. 342,
17–40 (2002)

The Failure of the Fractal Uncertainty
Principle for the Walsh–Fourier
Transform
Ciprian Demeter
To the memory of Jean Bourgain
Abstract We construct δ-regular sets with δ
≥
1
2 for which the analog of
the Bourgain–Dyatlov fractal uncertainty principle fails for the Walsh–Fourier
transform.
1
The Fractal Uncertainty Principle for the Fourier
Transform
This note explores the so-called fractal uncertainty principle, one of the last
signiﬁcant results of Jean Bourgain. The principle is a fundamental result in
Fourier analysis with far-reaching consequences in the spectral theory of hyperbolic
surfaces.
Deﬁnition 1.1 Let X ⊂R be a nonempty closed set. Consider the constants δ ∈
[0, 1), CR ≥1, and 0 ≤α0 ≤α1 ≤∞. We say that X is δ-regular with constant
CR on scales α0 to α1 if there is a Borel measure μX supported on X such that
•
For each interval I of size |I| ∈[α0, α1], we have μX(I) ≤CR|I|δ
•
If additionally I is centered at a point in X, then μX(I) ≥C−1
R |I|δ.
We will denote by |X| the Lebesgue measure of X.
Examples of regular sets will be discussed in Sect. 3. At this point, we only
mention that δ-regular sets need to have small Lebesgue measure, more precisely
The author is partially supported by the Research NSF grant DMS-1800305.
C. Demeter ()
Department of Mathematics, Indiana University, Bloomington, IN, USA
e-mail: demeterc@indiana.edu
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
A. Avila et al. (eds.), Analysis at Large, https://doi.org/10.1007/978-3-031-05331-3_2
17

18
C. Demeter
(see Lemma 2.9 in [2])
|X| ≤24C2
Rαδ
1α1−δ
0
.
(1)
The following fractal uncertainty principle for the Fourier transform
	
f (ξ) =

R
f (x)e−2πixξdx
was proved in [2]. It reﬁnes earlier versions due to Dyatlov–Zahl [4] and Bourgain–
Dyatlov [1].
Theorem 1.2 Let δ ∈[0, 1), CR ≥1, and N ≥1. Assume that
•
X ⊂[0, 1] is δ-regular with constant CR on scales 1
N to 1
•
Y ⊂[0, N] is δ-regular with constant CR on scales 1 to N
Then there exist constants β > 0 and C, both depending only on δ and CR, such
that for each f ∈L2(R) with Fourier transform supported on Y, we have
∥f ∥L2(X) ≤CN−β∥f ∥L2(R).
(2)
When δ < 1
2, this theorem has an easy proof that also provides an explicit value
for β. For reader’s convenience, we recall this argument below. If 	
f is supported on
Y, we have
∥f ∥L2(X) ≤|X|1/2∥f ∥L∞(R)
≤|X|1/2∥	
f ∥L1(R)
= |X|1/2∥	
f ∥L1(Y)
≤|X|1/2|Y|1/2∥	
f ∥L2(R)
= |X|1/2|Y|1/2∥f ∥L2(R).
If X and Y are as in the theorem, then (1) implies that |X|1/2|Y|1/2 ≤CN−β,
β = 1
2 −δ.
On the other hand, the proof from [2] in the case δ ≥1
2 is very involved. At its
heart, it relies both on the multiscale structure of regular sets and on the following
unique continuation result (Lemma 3.2 in [2]).
Lemma 1.3 Let I be a non-overlapping collection of intervals of size 1 and let
c0 > 0. For each I ∈I, let I ′′ ⊂I be an interval of size c0. Then there exists a
constant C depending only on c0 such that for all r ∈(0, 1), 0 < κ ≤e−C/r, and
f ∈L2(R) with 	
f compactly supported, we have

The Walsh–Fourier Transform
19

I∈I
∥f ∥2
L2(I) ≤C
r (

I∈I
∥f ∥2
L2(I ′′))κ∥e2πr|ξ| 	
f (ξ)∥2(1−κ)
L2(R) .
In the next section, we recall the details about the Walsh transform, a closely
related, though technically simpler analog of the Fourier transform. We will
construct sets X and Y as in Theorem 1.2 with regularity δ ≥1
2, such that the fractal
uncertainty principle fails when the Walsh transform replaces the Fourier transform.
This fundamental difference between the behavior of the two transforms explains
why the proof in [2] is so complicated. The argument in [2] must necessarily rely
not just on the ﬁne structure of the regular sets but also on the stronger form of the
uncertainty principle that governs the Fourier world. This has to do with the fact
that there is no (nontrivial) compactly supported function whose Fourier transform
is also compactly supported. Lemma 1.3 is a manifestation of this principle.
In the next section, we will see that there are compactly supported L2 functions
whose Walsh transforms are also compactly supported. This easily shows the failure
of Lemma 1.3, and ultimately of Theorem 1.2, in the Walsh framework. Our main
result, Theorem 3.1, is proved in the last section.
2
The Walsh Transform
For more details on the material in this section, the reader may consult the original
paper of Walsh [11], or the modern reference [8].
Let Z2 = {0, 1} with addition modulo 2 and Haar measure splitting the mass
evenly between 0 and 1. We consider the inﬁnite product group G = ∞
1 Z2
equipped with the product Haar measure. This is sometimes referred to as the Cantor
group.
Let D = {j2−i : 0 ≤j ≤2i} be the dyadic numbers in [0, 1]. They have zero
Lebesgue measure. The map
 : G →[0, 1],
(a−1, a−2, . . .) =

k≤−1
ak2k
is almost bijective—if x ∈[0, 1] \ D, −1({x}) consists of one point—measurable
and maps the Haar measure on G to the Lebesgue measure |·| on [0,1]. This suggests
a natural way to identify G with ([0, 1], ⊕, |·|), where ⊕is deﬁned as follows. Given
x, y ∈[0, 1] \ D, x = 
k≤−1 xk2k, y = 
k≤−1 yk2k, we write
x ⊕y =

k≤−1
ck2k,
ck = xk + yk (mod 2).
See Sec 2.2 in [6] for details.

20
C. Demeter
The characters on G are the so-called Walsh functions. For n ≥0, the n−th
Walsh function Wn : [0, 1) →{−1, 1} is deﬁned recursively by the formula
W0 = 1[0,1)
W2n(x) = Wn(2x) + Wn(2x −1)
W2n+1(x) = Wn(2x) −Wn(2x −1).
In particular,
W1(x) =

1,
0 ≤x < 1
2
−1,
1
2 ≤x < 1
,
W2(x) =

1,
x ∈[0, 1
4) ∪[ 1
2, 3
4)
−1,
x ∈[ 1
4, 1
2) ∪[ 3
4, 1)
W3(x) =

1,
x ∈[0, 1
4) ∪[ 3
4, 1),
−1,
x ∈[ 1
4, 3
4)
.
In many ways, the functions Wn resemble the (Fourier) system of exponen-
tials e2πinx. For example, the functions (Wn)n≥0 form an orthonormal basis for
L2([0, 1]). See Sec 4.1 [6] for more details.
The Walsh–Fourier coefﬁcients of a function f : [0, 1] →C are given by
FWf (n) =

f (x)Wn(x)dx, n ≥0.
To get a greater perspective on the role of the Walsh system and its closeness to the
Fourier system of exponentials, we introduce a new operation. For x, y ∈[0, ∞)
having unique representations (i.e., for Lebesgue almost all pairs (x, y))
x =
∞

k=−∞
xk2k,
y =
∞

k=−∞
yk2k,
we deﬁne

The Walsh–Fourier Transform
21
x ⊗y :=
∞

k=−∞
ck2k
where
ck =

j∈Z
xjyk−j (mod 2).
We note that this sum is always ﬁnite. From now on, we will implicitly ignore the
zero measure dyadic points.
Deﬁne the function eW : [0, ∞) →{−1, 1} such that eW(x) = 1 when x−1 = 0
and eW(x) = −1 when x−1 = 1. This 1-periodic function is the Walsh analog of
e2πix. It is easy to check that
Wn(x) = eW(x ⊗n)1[0,1](x).
(3)
We may introduce the Walsh (also called Walsh–Fourier) transform of a com-
pactly supported function f : [0, ∞) →C to be the function
FWf : [0, ∞) →C,
FWf (y) :=

[0,∞)
eW(x ⊗y)f (x)dx.
The Walsh–Fourier inversion formula takes the form FW ◦FW = id.
It is worth noting that
eW(x ⊗y) = eW(x ⊗z)
whenever x ∈[0, 1) and n ≤y, z < n+1. Consequently, if f is supported on [0, 1],
then FWf is constant on intervals [n, n + 1). This explains why for such functions
the Walsh–Fourier coefﬁcients completely characterize the function f .
While the Walsh transform behaves very similar to the Fourier transform, it has
one notable feature that makes it easier to work with. This has to do with the fact
that there are (plenty of) compactly supported functions whose Walsh transforms are
also compactly supported. A quick computation shows that for each dyadic interval
I = [l2k, (l + 1)2k), we have
FW1I(y) = |I|1[0,|I|−1](y)e(xI ⊗y),
(4)
where xI is an arbitrary element of I. Because of this feature, typically the results
that hold in the Fourier case are expected to also hold in the Walsh setting, with
the argument in the latter case being cleaner, less technical. The approach of ﬁrst
proving results in the Walsh setting and then “transferring” them to the Fourier
world was successfully employed in the time-frequency analysis of modulation
invariant operators, starting with [10]. The interested reader may consult the survey

22
C. Demeter
paper [3], which explores a few different arguments for the Walsh analog of
Carleson’s Theorem and contains some relevant references.
In this paper we present an example that goes against the aforementioned
philosophy. We show that a fundamental result that holds for the Fourier transform
is in fact false for the Walsh transform.
3
The Main Result
The “textbook” example of regular sets can be constructed as follows. Fix integers
0 < M < L. Let S be a collection of subsets S of {0, 1, . . . , L −1} with cardinality
M. We create a collection of nested sets X1, X2, . . . as follows. Pick S1 ∈S and let
A1 = L−1S1,
X1 = A1 + [0, L−1].
Next, for each a ∈A1, choose some S2,a ∈S and deﬁne
A2,a = a + L−2S2,a,
A2 = ∪a∈A1A2,a,
X2 = A2 + [0, L−2].
The rest of the construction is recursive. Assume we have constructed Aj and Xj
for 1 ≤j ≤n −1. For each a ∈An−1, choose some Sn,a ∈S and deﬁne
An,a = a + L−nSn,a,
An = ∪a∈An−1An,a,
Xn = An + [0, L−n].
Note that Xn ⊂[0, 1] consists of Mn intervals I ∈IXn of length L−n. Also, Xn
is log M
log L −regular on scales
1
Ln to 1, with constant Cn satisfying the uniform bound
Cn ≤C(M, L), where C(M, L) depends only on M, L. The reader may check that
Deﬁnition 1.1 is satisﬁed with the measure μXn given by μXn(I) =
1
Mn , for each
I ∈IXn.
We specialize this construction as follows. Fix the positive integers m1 and m2 ≥
m1. We consider a set as above with M = 2m2 and L = 2m1+m2. The collection S
will consist of only the set S = {k2m1, 0 ≤k ≤2m2 −1}.
More precisely, deﬁne
An = {
n

i=1
kn−i+12m1
Li
: 0 ≤k1, . . . , kn ≤2m2 −1}
and
Xn = An + [0, L−n].
(5)
Then Xn ⊂[0, 1] is
m2
m1+m2 −regular on scales L−n to 1, with constant Cn uniformly
bounded in n.

The Walsh–Fourier Transform
23
Deﬁne also the dilate
Yn = LnXn = {Lnx : x ∈Xn}.
Note that Yn is the union of intervals of length 1 and Yn
⊂[0, Ln]. It is
m2
m1+m2 −regular on scales 1 to Ln, with the same constant Cn as Xn.
Theorem 3.1 The (real) vector space VXn,Yn of all L2 functions
f : [0, 1] →R, supp f ⊂Xn, supp FWf ⊂Yn
has dimension at least 2n(m2−m1). In particular, for each n ≥1, there is a function
fn (other than the zero function) with FWfn supported on Yn such that
∥fn∥L2(Xn) = ∥fn∥L2([0,1]).
Fixing m1, m2 and letting n →∞shows that the Walsh analog of (2) fails to hold
for any β > 0, when δ ≥1
2.
We remark that the restriction m2 ≥m1 is needed in Theorem 3.1, as it is
equivalent with the lower bound δ ≥1
2 for the regularity of Xn, Yn. When δ < 1
2,
Theorem 1.2 remains true in the Walsh framework, and the argument from the ﬁrst
section for the Fourier case translates to the Walsh case, too.
4
Proofs
We start by proving a sequence of lemmas.
Lemma 4.1 For x, y ∈[0, ∞) and l ∈Z, we have
(2lx) ⊗y = x ⊗(2ly).
Proof If
x =

k∈Z
xk2k,
y =

k∈Z
yk2k
then
2lx =

k∈Z
xk−l2k,
2ly =

k∈Z
yk−l2k
and

24
C. Demeter
((2lx) ⊗y)k =

j∈Z
(2lx)jyk−j =

j∈Z
xj−lyk−j =

j∈Z
xjyk−j−l = (x ⊗(2ly))k.
⊓⊔
Combining this lemma with (3) and (4) reveals that if I = [ k
Ln , k+1
Ln ] ⊂[0, 1] then
FW1I(y) = L−nWk( y
Ln ).
(6)
Lemma 4.2 The functions W0, W1, . . . , W2m−1 span the vector space
Cm = {f : [0, 1] →R : f constant on dyadic intervals of length 2−m}.
Proof An easy induction argument based on the recursive formula for Wn shows
that W0, W1, . . . , W2m−1 ∈Cm. The vector space Cm has dimension 2m, and since
W0, W1, . . . , W2m−1 are linearly independent (being orthogonal), they form a basis
for this space.
⊓⊔
The recursive deﬁnition of Wn also immediately implies the following periodicity
property.
Lemma 4.3 The function Wk2l is 2−l periodic, if k, l are positive integers. More-
over, when x ∈[0, 2−l], we have
Wk2l(x) = Wk(x2l).
The combination of the last two lemmas yields the following result.
Proposition 4.4 Consider the (real) vector space of all F : [0, 1] →R having the
following two properties for some positive integers l, m
(P1):
F is 2−l periodic.
(P2):
F is constant on dyadic intervals of length 2−l−m.
Then this vector space coincides with the span of the Walsh functions Wk2l, for
0 ≤k ≤2m −1.
Let us recall that L = 2m1+m2. Rescaling the above result gives:
Corollary 4.5 For 1 ≤i ≤n, consider the (real) vector space Vi,n of all functions
Fi : [0, Ln] →R such that
(P1):
Fi is Li
2m1 periodic.
(P2):
Fi is constant on dyadic intervals of length Li−1.
Then Vi,n coincides with the span of the rescaled Walsh functions WkLn−i2m1( y
Ln ),
for 0 ≤k ≤2m2 −1.

The Walsh–Fourier Transform
25
Let VXn be the (real) vector space spanned by the Walsh transforms FW1I of all
intervals I of length L−n in Xn. According to (5) and (6), this is the same as the
vector space spanned by the rescaled Walsh functions
Wn
i=1 kn−i+12m1Ln−i( y
Ln ) : 0 ≤k1, . . . , kn ≤2m2 −1.
(7)
Note that VXn is a proper subset of the family of Walsh transforms of functions
supported on Xn. We are going to search for functions in VXn that are supported on
Yn.
Lemma 4.6 For each k, k′ ∈Z
WkWk′ = Wk⊕k′.
Proof
Wk(x)Wk′(x) = (−1)(x⊕k)−1(−1)(x⊕k′)−1 = (−1)

j xj k−1−j (−1)

j xj k′
−1−j
= (−1)

j xj (k⊕k′)−1−j = Wk⊕k′(x).
⊓⊔
Combining the last lemma and corollary, we get:
Proposition 4.7 The space VXn coincides with the collection of arbitrary ﬁnite
sums of products (over i) of functions Fi ∈Vi,n.
Proof Note that since kn−i+12m1 < L, we have
n

i=1
kn−i+12m1Ln−i = ⊕n
i=1kn−i+12m1Ln−i,
where the factors on the right-hand side are summed using ⊕rather than +. Thus
Wn
i=1 kn−i+12m1Ln−i( y
Ln ) =
n

i=1
Wkn−i+12m1Ln−i( y
Ln ).
⊓⊔
Lemma 4.8 Assume that f1, . . . , fN
:
R
→
R are linearly independent,
g1, . . . , gM : R →R are linearly independent, and {fngm :
1 ≤n ≤N, 1 ≤
m ≤M} are linearly independent. Let V1 be a linear subspace of span(f1, . . . , fN)

26
C. Demeter
of dimension d1 ≤N, and let V2 be a linear subspace of span(g1, . . . , gM) of
dimension d2 ≤M.
Then the linear space V spanned by the functions fg with f ∈V1 and g ∈V2
has dimension d1d2.
Proof It is clear that dim(V) ≤dim(V1) dim(V2), so it remains to prove the reverse
inequality. Assume that the functions f (k) = N
n=1 ak,nfn with 1 ≤k ≤d1 form
a basis for V1. It follows that the (d1, N) matrix A = (ak,n) contains a nonsingular
(d1, d1) minor A′. Assume that the functions g(l) = M
m=1 bl,mgm with 1 ≤l ≤
d2 form a basis for V2. It follows that the (d2, M) matrix B = (bl,m) contains a
nonsingular (d2, d2) minor B′.
We will show that the functions f (k)g(l), 1 ≤k ≤d1, and 1 ≤l ≤d2 are
linearly independent. We order the functions fngm using the lexicographic order
for pairs (n, m), that is, f1g1, . . . , f1gM, f2g1, . . . , f2gM, . . . , fNg1, . . . , fNgM.
We similarly order the functions f (k)g(l) lexicographically with respect to the pairs
(k, l). We construct the (d1 × d2, N × M) matrix C as follows. The (i, j) entry is
the coefﬁcient of the ith function f (k)g(l) with respect to the jth function fngm. We
denote this matrix by A ⊗B. One easy way to visualize it is to start with the matrix
A and replace each entry ak,n with the matrix ak,nB
C =
⎡
⎣
a1,1B . . . a1,NB
. . .
. . .
. . .
ad1,1B . . . ad1,NB
⎤
⎦.
We need to prove that C contains a nonsingular (d1d2, d1d2) minor. We claim
that this minor is C′ = A′ ⊗B′, with the tensor operation described above. It is
immediate that C′ is a minor of C. Also, it is well known that
det(C′) = det(A′)d1 det(B′)d2.
See, for example, [9]. In particular, det(C′) ̸= 0, as desired.
⊓⊔
We now prove Theorem 3.1 by induction. It sufﬁces to show that the vector space
of those F supported on Yn, that are in the span of the rescaled Walsh functions in
(7), has dimension at least 2n(m2−m1).
Let us start with the base case n
=
1. Using the characterization from
Proposition 4.7, it sufﬁces to prove that the vector space
{F ∈V1,1 : supp F ⊂Y1}
has dimension 2m2−m1. The functions F in this space are 2m2 periodic and constant
on all intervals [l, l + 1). Since Y1 contains exactly 2m2−m1 unit intervals in [0, 2m2]
(these are Ik = [k2m1, k2m1 + 1], 0 ≤k ≤2m2−m1 −1), and since

The Walsh–Fourier Transform
27
Y1 =

0≤k′≤2m1−1
((I0 ∪I1 ∪. . . ∪I2m2−m1−1) + k′2m2),
it is immediate that the values of F on I0, . . . , I2m2−m1−1 may be chosen arbitrarily.
This veriﬁes the base case of the induction. Note that by choosing the values of F
to be 1 on all these intervals, we get the function F = 1Y1. This shows that FW1Y1
is in VX1,Y1.
Next, let us prove the theorem for n ≥2, assuming its validity for n −1. We
write
Yn = LYn−1 ∩Zn,
Zn =

k≤Ln
2m1
[k2m1, k2m1 + 1].
(8)
Let V1,n(Zn) be the vector space of those F1 ∈V1,n that are supported on Zn.
Note ﬁrst that this has dimension 2m2−m1, since there are 2m2−m1 unit intervals in
Zn that lie in the periodicity interval [0, 2m2] associated with V1,n. Pick 2m2−m1
functions H in the span of WknLn−12m1, with 0 ≤kn ≤2m2 −1, such that the
rescaled functions H( y
Ln ) form a basis for V1,n(Zn).
By the induction hypothesis, we may ﬁnd a subset consisting of 2(n−1)(m2−m1)
linear independent functions G in the span of
Wn−1
i=1 kn−i2m1Ln−1−i : 0 ≤k1, . . . , kn−1 ≤2m2 −1
such that each G(
y
Ln−1 ) is supported on Yn−1. So G( y
Ln ) is supported on LYn−1.
Because of Lemma 4.8, (8) and since
Wn
i=1 kn−i+12m1Ln−i( y
Ln ) = WknLn−12m1( y
Ln )Wn−1
i=1 kn−i2m1Ln−1−i( y
Ln )
is supported on Yn, we conclude that there are at least 2n(m2−m1) linearly indepen-
dent functions in VXn (recall that these are functions spanned by the functions in
(7)) that are supported on Yn. We thus have
dim VXn,Yn ≥2n(m2−m1).
Remark 4.9 The inductive argument from above shows that in fact F = FW1Yn is
in VXn,Yn. Indeed, we observed that this is true for n = 1. The case n > 1 follows
since
1Yn = 1LYn−11Zn
and since 1Zn ∈V1,n(Zn).
Acknowledgments I am grateful to Semyon Dyatlov for pointing out to me the following facts.
The Walsh transform appears in applications to the toy model of open quantum baker’s maps. In
that case, the maps can be Walsh-quantized, and the spectral gap results do sometimes fail on these.

28
C. Demeter
This was observed by Nonnenmacher and Zworski in [7] (Section 5, in particular Remark 5.2). In
[5] (at the end of the Introduction), Dyatlov and Jin brieﬂy interpreted this phenomenon as special
instances of the failure of the fractal uncertainty principle for the Walsh–Fourier transform.
References
1. Bourgain, J., Dyatlov, S.: Fourier dimension and spectral gaps for hyperbolic surfaces. Geom.
Funct. Anal. 27(4), 744–771 (2017)
2. Bourgain, J., Dyatlov, S.: Spectral gaps without the pressure condition. Ann. Math. (2) 187(3),
825–867 (2018)
3. Demeter, C.: A guide to Carleson’s theorem. Rocky Mountain J. Math. 45(1), 169–212 (2015)
4. Dyatlov, S., Zahl, J.: Spectral gaps, additive energy, and a fractal uncertainty principle. Geom.
Funct. Anal. 26(4), 1011–1094 (2016)
5. Dyatlov, S., Jin, L.: Resonances for open quantum maps and a fractal uncertainty principle.
Comm. Math. Phys. 354(1), 269–316 (2017)
6. Folland, G.B.: A course in abstract harmonic analysis. Studies in Advanced Mathematics. CRC
Press, Boca Raton, FL (1995). x+276 pp.
7. Nonnenmacher, S., Zworski, M.: Distribution of resonances for open quantum maps. Comm.
Math. Phys. 269(2), 311–365 (2007)
8. Schipp, F., Wade, W.R., Simon, P.: Walsh series. An introduction to dyadic harmonic analysis.
With the Collaboration of J. Pal. Adam Hilger, Bristol (1990)
9. Silvester, J.: Determinants of Block Matrices. Mathematical Gazette, vol. 84(501), pp. 460–
467. The Mathematical Association, (2000)
10. Thiele, C.: The quartile operator and pointwise convergence of Walsh series. Trans. Am. Math.
Soc. 352(12), 5745–5766 (2000)
11. Walsh, J.L.: A closed set of normal orthogonal functions. Am. J. Math. 45, 5–24 (1923)

The Continuous Formulation of Shallow
Neural Networks as Wasserstein-Type
Gradient Flows
Xavier Fernández-Real and Alessio Figalli
Dedicated to the memory of Jean Bourgain
Abstract It has been recently observed that the training of a single hidden layer
artiﬁcial neural network can be reinterpreted as a Wasserstein gradient ﬂow for the
weights for the error functional. In the limit, as the number of parameters tends
to inﬁnity, this gives rise to a family of parabolic equations. This survey aims to
discuss this relation, focusing on the associated theoretical aspects appealing to the
mathematical community and providing a list of interesting open problems.
1991 Mathematics Subject Classiﬁcation 35Q49, 49Q22, 68T07
1
Introduction
The extensive and successful use of machine learning in recent years has been
remarkable. However, from a mathematical viewpoint, an adequate theoretical
understanding of its primary governing principles is still missing in many situations.
Often, each problem needs to be studied individually, even within the application of
the same technique, to obtain the desired visible result.
This work has received funding from the European Research Council (ERC) under the Grant
Agreement No 721675. In addition, X. F. was supported by the SNF grant 200021_182565.
X. Fernández-Real ()
EPFL, Lausanne, Switzerland
e-mail: xavier.fernandez-real@epﬂ.ch
A. Figalli
Department of Mathematics, ETH Zürich, Zürich, Switzerland
e-mail: alessio.ﬁgalli@math.ethz.ch
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
A. Avila et al. (eds.), Analysis at Large, https://doi.org/10.1007/978-3-031-05331-3_3
29

30
X. Fernández-Real and A. Figalli
Recently, a new continuous viewpoint of artiﬁcial neural networks has risen,
intending to shine some light on this computing system’s understanding. This theory
has already been developed and shown important results and, roughly speaking,
consists in viewing the gradient descent used to optimize parameters in a neural
network as a gradient ﬂow in the Wasserstein distance for their own empirical
measure.
More precisely, training neural networks can be thought of as discretizations
of a gradient ﬂow with the appropriate metric and functional. This observation
has opened the door to studying (at a theoretical level) the general convergence
properties of such methods deducing properties of the corresponding continuous
limit. Most of this study has been conducted from a numerical point of view, and
there are still many open questions that are also interesting from a purely theoretical
perspective.
In this framework, new mathematical problems and PDE systems have arisen,
which have not yet been fully adopted by the mathematical community. This short
survey aims to bridge this gap to present this fascinating problem in the gradient
ﬂows community’s language.
We refer the interested reader to [4, 7, 9, 11, 15] and references therein for an
in-depth introduction to the topic and also to [5, 6] for an approach more focused on
dynamical systems and optimal control problems.
2
Shallow Neural Network and Gradient Flows
Given a domain D ⊂Rn, and a function f : D →R, training a single hidden layer
artiﬁcial neural network (or shallow neural network) consists in approximating f
with expressions of the form
fN(x) = fN(x, w1, . . . , wN, θ1, . . . , θN) = 1
N
N

i=1
wih(θi, x),
(1)
where wi ∈R and θi ∈ ⊂Rd are parameters to be optimized (usually taken
in pairs (wi, θi)), and h :  × D →R is called the activation function, which
is nonlinear. Such construction of approximating functions is often graphically
represented as seen in Fig. 1, and when the number of layer increases, the number
of interconnections between the neurons increases as well, very loosely resembling
a biological neural network.
In applications, it is usual to assume that
d = n + 1
and
h(θ, x) = σ(θ′ · x + θ(d)),
(2)

The Continuous Formulation of Neural Networks
31
h(θ1, x)
h(θ2, x)
h(θ3, x)
h(θN, x)
Rd ⊃D ∋x
θ1
θ2
θ3
θN
˜w1
˜w2
˜w3
˜wN
θi ∈Rd+1
˜wi ∈R
y = N
i=1 ˜wih(θi, x)
Fig. 1 Graphic representation of the approximating functions given by what is known as a single
hidden layer artiﬁcial neural network. The variables are ˜wi = 1
N wi according to the notation in (1)
where θ = (θ′, θ(d)) ∈Rn×R, for a suitable nonlinearity σ.1 Thus, neural networks
try to approximate a given function with linear combinations of nonlinearities.
However, for the sake of generality, here we will not consider a speciﬁc form of
h(θ, x), and we focus instead on the general formulation where h(θ, x) can be
arbitrary.
The number N of parameters (w, θ) ∈Rd+1 used to in (1) corresponds to the
number of neurons or hidden units. When training a neural network, one tries to
minimize the expected error, sometimes called risk or generalization error, obtained
from approximating f by fN. To do so, one needs to deﬁne a loss function ℓ, that
we consider to be
ℓ

f, fN

= 1
2

D
|f (x) −fN(x)|2dx.
Let us denote by HN the class of fN that can be obtained as (1). Then, one wants
to solve the minimization problem
min
fN∈HN
ℓ

f, fN

,
(3)
where ℓis as above. The standard approach nowadays is to start from some choice
of weights ¯w = ( ¯w1, . . . , ¯wN) and ¯θ = ( ¯θ1, . . . , ¯θN) and perform gradient descent
on these parameters (w, θ) in order to (possibly) achieve the minimizer to (3):2
1 A typical nonlinearity is the sigmoid function. Namely, if we denote σ(t) =
1
1+e−t , we consider
h(θ, x) = σ(θ·x). However, nowadays, the most frequently used activation function in applications
is not smooth nor bounded: the ReLU function σ(t) = max{t, 0}.
2 In fact, in reality, one uses stochastic gradient descent, by considering random samples (xi, f (xi))
of our data or training set.

32
X. Fernández-Real and A. Figalli
⎧
⎨
⎩
d
dt (w(t), θ(t)) = −N ∇w,θℓ

f, fN(·, w(t), θ(t))

,
(w(t), θ(t)) = ( ¯w, ¯θ),
(4)
with w(t) = (w1(t), . . . , wN(t)) and θ(t) = (θ1(t), . . . , θN(t)).3 Unfortunately,
given the structure of the approximating functions (1), this problem is non-convex,
and thus one does not expect to arrive to the minimizer in general.
Because of this degeneracy, a recent approach has been to consider a continuum
model where one lets the number N of neurons go to inﬁnity. The general hope is
that this limit problem can be studied with PDE techniques, and then one may try
to extract informations also on the original problem (with N ﬁxed) provided N is
sufﬁciently large. This latter step has been studied, for instance, in [4], although
many questions are still open (see Sect. 5 for more details).
In this note we shall not discuss the consistency of the approximation as N →∞,
but we instead focus on the analysis of the continuum interpretation. As we shall
see, there is more than one way to interpret the limit as N →∞, and more than
one possible formulation exists. In the next sections, we ﬁrst present the continuum
energy functionals that one can obtain by taking the limit of ℓ

f, fN

as N →∞,
and then we shall analyze the possible gradient ﬂows that can arise from this model.
2.1
The μ Formulation
We start with the most commonly used interpretation of a neural network, when the
number of neurons is allowed to go to inﬁnity. In this case, we want to treat the two
variables w and θ in the same way. For that, let us slightly reformulate the previous
problem.
Set ξ := (w, θ) ∈R × ,  := R ×  ⊂Rd+1, and let us deﬁne (ξ, x) :=
w h(θ, x), so that we can deal with both parameters simultaneously. Thus, (1) can
be written as
fN(x) = fN(x, ξ1, . . . , ξN) = 1
N
N

i=1
(ξi, x).
Let μN denote the empirical distribution of {ξi}1≤i≤N, namely,
μN(ξ) = 1
N
N

i=1
δξi(ξ).
3 Actually, to avoid overﬁtting, it is usual to add to the loss function ℓa convex potential on the
parameters; see (7) or (13).

The Continuous Formulation of Neural Networks
33
Then the function fN can be expressed in terms of μN as
fN(x) =


(ξ, x)μN(dξ),
and the gradient descent (4) can be rewritten only in terms of the empirical measure
at time t, that is, μN(t) = 1
N
N
i=1 δξi(t)(ξ) with ξi(t) = (wi(t), θi(t)).
Letting N
→∞, the space of empirical measures can approximate any
probability measure μ ∈P(). Hence, this suggests the study of approximating
functions deﬁned as
fμ(x) :=


(ξ, x)μ(dξ)
∀μ ∈P().
(5)
Then, our minimization problem consists in minimizing
F(μ) := 1
2

D
(f −fμ)2dx
among probability measures μ ∈P(). That is,
min
μ∈P() F(μ) =
min
μ∈P()
1
2

D

f −


(ξ, x)μ(dξ)
2
dx.
(6)
In other words, we are looking at the best way of approximating f in L2(D) using
functions of the form (5).
Note that, for many choices of , the set of functions of the form (5) may
be dense in L2(D), so that the minimum may be zero (and we want to study
ways to attain or approximate it). Moreover, oftentimes, to avoid overﬁtting in the
training space, it is common to add a potential term used as a renormalization in the
optimization of the neural networks. Therefore, the energy that we want to minimize
over μ ∈P() becomes
F(μ) = 1
2

D

f −


(ξ, x)μ(dξ)
2
+


V (ξ)μ(dξ),
(7)
for some ﬁxed function V :  →R. A natural choice of V is given by the quadratic
potential
V (ξ) = λ
2|ξ|2,
with λ > 0.
(8)
Notice that, with this additional term, the minimum of our functional will not be
zero anymore.

34
X. Fernández-Real and A. Figalli
We remark that, by considering probability measures instead of discrete param-
eters, we are not losing information. Indeed, if we restrict our problem to the set of
atomic measures with N atoms, then we go back to formulation (1).
Remark 2.1 One might beneﬁt from the convex structure of the functional F with
respect to the classical linear structure of P(), namely,
F (αμ1 + (1 −α)μ2) ≤αF(μ1) + (1 −α)F(μ2)
∀α ∈[0, 1].
In particular, from here one can show that if μ1 and μ2 are two local minimizers,
then

D (ξ, x)μ1(dξ) =

D (ξ, x)μ2(dξ) for all x ∈D and their potential
energy is the same, i.e.,

 V (ξ)μ1(dξ) =

 V (ξ)μ2(dξ).4 In particular, local
minimizers are unique under .
An advantage of the continuous formulation is that the invariance with respect to
permutations of neurons is included in the model. Also, assuming that one already
knows symmetries for the objective function (e.g., rotational symmetry to identify
certain images), they can be incorporated directly into the minimization problem,
much more easily than in the discrete case.
2.2
Comparison Between the Continuous and Discrete Model
At the discrete level, adding a potential term corresponds to considering the
minimization of the loss functional
FN(fN) = 1
2

D
|f (x) −fN(x)|2 dx +
N

i=1
V (ξi),
(9)
4 Indeed, suppose that μ1 and μ2 are two local minimizers, and for α ∈[0, 1], consider μα :=
(1 −α)μ0 + αμ1. Then, we can compute
d
dα F(μα), which equals
d
dα F(μα) = α

D
|f −f1|2 −(1 −α)

D
|f −f0|2 + (1 −2α)
×

D
(f −f0)(f −f1) −

V (μ0 −μ1).
Since μ0 and μ1 are local minimizers, we have
d
dα

α=0F(μα) ≥0 and
d
dα

α=1F(μα) ≤0, and
therefore
0 ≥d
dα

α=1F(μα) −d
dα

α=0F(μα) =

D
|f0 −f1|2
thus f0 = f1. This implies that d
dα F(μα) = −

V (μ0−μ1), so it follows from d
dα

α=0F(μα) ≥0
and
d
dα

α=1F(μα) ≤0 that

V μ0 =

V μ1.

The Continuous Formulation of Neural Networks
35
for some convex function V . Equivalently, we are considering the discrete mini-
mization problem
min
ξi∈ FN(fN)
for
fN(x) = 1
N
N

i=1
(ξi, x).
(10)
We have seen that this minimization problem can be interpreted as a particular case
of the more general problem for probability measures. Namely, if we consider F
given by (7), then Problem (10) generalizes to
min
μ∈P() F(μ).
(11)
Notice also that, while Problem (10) is heavily non-convex, Problem (11) has a
convex structure (see Remark 2.1).
Consistency
The consistency between Problems (10) and (11) has generated some research in
the recent years. These are some results:
(i) If μN is the empirical distribution of a minimizer of FN and μ is a minimizer
of F, then FN(μN) = F(μ) + O(N−1). In addition, if V is coercive, then μN
converges weakly∗to a minimizer μ of F (up to subsequences).
(ii) The Wasserstein gradient ﬂow of F with initialization μN is the same as the
corresponding gradient descent of the discretized problem, cf. (4) (see [4]).
(iii) As shown in [11] (see also [14]), the stochastic gradient descent for (10) (cf.
(4)) converges to the gradient ﬂow of (11) with its own initialization. More
precisely, if one denotes by μ(k)
N the empirical distribution of the parameters
(ξk
i )1≤i≤N in the stochastic gradient descent for FN at step k, then one can
prove quantitative convergence of μ(t/ε)
N
to μt as N →∞and ε ↓0, where μt
is the gradient ﬂow in the Wasserstein metric for the functional F.
(iv) In [4] the authors proved that if one approximates an initial measure μ0 by N
atoms, the corresponding gradient descents converge, under some conditions
on the initial measure, to the gradient ﬂow for F with initial measure μ0, also
as t →∞. Thus, they showed that one does actually beneﬁt from the convex
structure in (11): given a nice enough initial measure (initial conﬁguration
of weights, with enough neurons), its gradient descent will converge to a
conﬁguration of parameters very close to a minimizer for F. This is currently
a non-quantitative result that checks the consistency of the problem posed.

36
X. Fernández-Real and A. Figalli
All these facts show that studying the minimization problem (11) could be very
useful in trying to derive properties for the discrete problem (10).
On the other hand, one should keep in mind that, in general, the Wasserstein
gradient ﬂow of (6) may not converge to a global minimizer but just to a stationary
point. For example, given an initial conﬁguration with a ﬁxed number of deltas,
the corresponding gradient ﬂow never increases the amount of deltas, and thus it
converges to some measure that has at most the same number of deltas as the initial
conﬁguration. In particular, this limit will not generally be a global minimizer of
F. Still, the result in [4] says that such limiting conﬁguration will approximate a
minimizer, under suitable conditions.
2.3
The (ρ, H) Formulation
An alternative approach to the previous generalization (what we called “the μ
formulation”) consists in taking advantage of the structure of , where the weights
w and positions θ have asymmetric roles. One can think of this approach as a
charged particles system, where we can discretize in θ (positions of the particle)
assigning a coefﬁcient w to each atomic measure of the discretization (charge of the
particle). We refer to some examples in [7].
While these continuous methods a priori do not necessarily arise from a discrete
gradient descent, they yield other evolution equations whose discretization could
beneﬁt from additional properties. As we will see, some of these associated PDE
systems also dissipate energy, suggesting that alternative gradient ﬂow formulations
are possible and interesting.
Recall that we have θ ∈ ⊂Rd and w ∈R. Consider the measure in θ given
by
ρN(θ) = 1
N
N

i=1
wiδθi(θ)
(observe that now ρN is not necessarily a probability measure, and not even a
positive measure, since the weights wi may be negative). Then the function fN
in (1) can be expressed as
fN(x) =


h(θ, x)ρN(dθ).
This suggests considering functions of the form
fm(x) =


h(θ, x)m(dθ),
where now m ∈M is a ﬁnite (signed) measure.

The Continuous Formulation of Neural Networks
37
Notice that this is related to what we were doing before with probability measures
μ deﬁned on  = R × . Indeed, to see the relation between the two formulations,
given μ ∈P(), consider its disintegration with respect to θ. Namely, one can write
μ(dξ) = νθ(dw) ⊗ρ(dθ),
where ρ and ν are formally deﬁned as5
ρ(θ) =

R
μ(dw, θ),
νθ(w) =
1
ρ(θ)μ(w, θ).
Then, given (ξ, x) = w h(θ, x), we have


(ξ, x)μ(dξ) =



R
w νθ(dw)

h(θ, x)ρ(dθ) =


h(θ, x)m(dθ)
where
m(dθ) =

R
w νθ(dw)

ρ(dθ).
In other words, (6) is equivalent to the minimization problem
min
m∈M()
1
2

D

f −


h(θ, x)m(dθ)
2
dx,
where M() denotes the set of (ﬁnite) signed measures on . Equivalently, if we
deﬁne
H(θ) =

R
w νθ(dw),
then our problem consists in ﬁnding the best approximation of f in L2(D) with
functions of the form
fρ,H(x) =


H(θ)h(θ, x)ρ(dθ).
(12)
In addition, keeping the same notation and assuming to introduce a potential term of
the form V (ξ) = λ
2|ξ|2 in the μ formulation, then by Jensen’s inequality, we have
5 This deﬁnition of the disintegration is correct if μ is absolutely continuous, and therefore can be
identiﬁed as a function. Otherwise, the existence and uniqueness of such representation is provided
by the disintegration theorem (see for instance [8, Theorem 1.4.10 and Appendix B]).

38
X. Fernández-Real and A. Figalli


|ξ|2μ(dξ) =



R
w2νθ(dw)ρ(θ) +


|θ|2ρ(dθ) ≥



H(θ)2 + |θ|2
ρ(dθ).
In particular, if we were assuming

|ξ|2μ(dξ) < +∞(i.e., μ has bounded second
moments) in the previous formulation, then it is natural to assume ρ to have bounded
second moments as well, and H ∈L2(, ρ).6
Notice that the expression (12) is similar to (5), the one appearing in the μ
formulation. There are, however, two main differences: on the one hand, the number
of parameters has been reduced (from ξ = (w, θ) to simply θ); on the other hand,
we are optimizing not only over probability measures ρ but also over functions
H ∈L2(, ρ). Thus, by looking at the explicit expression (ξ, x) had in the
previous formulation, we are trading off the amount of parameters of our problem
with a new variable to optimize. We can do so because, in reality, the freedom given
to the measure νθ(dw) was limited: since (ξ, x) = w h(θ, x), we only see it
through its ﬁrst moment. In particular, given μ = νθ(dw) ⊗ρ(dθ), one can replace
it with δH(θ)(dw) ⊗ρ(dw), and the problem remains the same. This is the idea
behind what we call “the (ρ, H) formulation.”
In conclusion, in the (ρ, H) formulation, we are considering the functional
G(ρ, H) = 1
2

D

f −


H(θ)h(θ, x)ρ(dθ)
2
dx +


¯V (H, θ)ρ(dθ), (13)
where now we have removed the dependence on the variable w, and we have added
a potential term ¯V : R ×  →R. Note that, in this case, the L2 regularization
induced by (8) corresponds to ¯V (H, θ) = λ
2(H 2 + |θ|2).
3
PDE Formulations
In this section we ﬁrst compute the Wasserstein gradient ﬂow in the μ formulation
(see Sect. 3.1). Then we discuss some evolution equations in the (ρ, H) formulation,
as introduced in [7] (Sect. 3.2). Finally, in Sect. 3.3, we present a new original
approach to the problem of deﬁning a gradient ﬂow (ρ, H) formulation, based on
propagation of chaos.
6 Similarly, if our potential term was given by the p-moments instead, i.e., V (ξ) = λ|ξ|p for some
p ≥1 and λ > 0, then it would be natural to assume H ∈Lp(, ρ).

The Continuous Formulation of Neural Networks
39
3.1
Gradient Flow in the μ Formulation
Recall that  = R ×  ⊂Rd+1, and ξ = (w, θ) ∈ denotes the parameters in
this setting. Let D ⊂Rn, and let h(θ, x) :  × D →R be a given function, and let
(ξ, x) = w h(θ, x).
We consider the minimization problem
min
μ∈P() F(μ),
(14)
where
F(μ) = 1
2

D


(ξ, x)μ(dξ) −f (x)
2
dx +


V (ξ) μ(dξ).
(15)
Note that this expression can be rewritten as
F(μ) = ¯F +

×
K(ξ, ¯ξ)μ(dξ)μ(d ¯ξ) +


S(ξ)μ(dξ) +


V (ξ)μ(dξ),
(16)
where
K(ξ, ¯ξ) = 1
2

D
(ξ, x)(¯ξ, x)dx,
S(ξ) = −

D
(ξ, x)f (x) dx, (17)
and ¯F = 1
2∥f ∥2
L2(D) is a constant. We remark that the smoothness of (ξ, x) is
related to the smoothness of S (in particular, if  is smooth, then S is a smooth).
The ﬁrst variation of F with respect to μ at ﬁxed measure μ∗∈P() is given
by7
δF
δμ (μ∗) =

D
(·, x)


(¯ξ, x) dμ∗(¯ξ) −f (x)

dx + V
= 2


K(·, ¯ξ)μ∗(d ¯ξ) + S + V,
(18)
so that the Wasserstein subdifferential on the support of μ∗is
7 By deﬁnition, δF
δμ (μ∗) is deﬁned as the unique element such that
d
dε

ε=0
F(μ∗+ εϕ) =


δF
δμ (μ∗) ϕ dξ
∀ϕ ∈C∞
c ().

40
X. Fernández-Real and A. Figalli
∇δF
δμ (μ∗) =

D
∇ξ(·, x)


(¯ξ, x) dμ∗(¯ξ) −f (x)

dx + ∇V
= 2


∇ξK(·, ¯ξ)μ∗(d ¯ξ) + ∇S + ∇V
(see, for instance, [1, Chapter 10] or [8, Chapter 4.2]). Also, the Wasserstein gradient
ﬂow of F is by deﬁnition (see [8, Chapter 4.2]
∂tμt = div

μt∇δF
δμ (μt)

,
(19)
therefore the formulas above give us the following PDE:
∂tμt = div (μt∇L(μt)) + div (μt∇S) + div(μt∇V ),
(20)
with
L(μt)(ξ) = 2


K(ξ, ¯ξ)μt(d ¯ξ).
(21)
Notice that L is an integral operator that is positive semi-deﬁnite.8 Also, it can be
checked by a direct computation that a solution μt(ξ) of the PDE satisﬁes an energy
dissipation from the gradient ﬂow structure, that is, the energy is monotone non-
increasing along trajectories:
d
dt F(μt) = −


∇δF
δμ (μt)

2
μt(dξ).
(22)
In particular, stationary points correspond to measures for which the derivative of
the energy is zero. This motives the following:
Deﬁnition 3.1 We say that measure μ∗is a stationary point of our functional F (in
the Wasserstein sense) if
∇δF
δμ (μ∗) = 0
on
supp(μ∗).
(23)
8 Indeed, it follows by (17) that


L(μ)(ξ) μ(dξ) = 1
2

D


(ξ, x)μ(dξ)
2
dx ≥0.

The Continuous Formulation of Neural Networks
41
Notice that if we consider the natural potential term V (ξ) = λ
2|ξ|2, then our PDE
(20) becomes
∂tμt = div (μt∇L(μt)) + div (μt∇S) + λ div(μt ξ).
Let us conclude this subsection by observing that, in general, the previous PDEs
are posed when the domain  = Rd+1. If, instead, one considers  a bounded
smooth domain, an extra zero Neumann boundary condition (so that the mass cannot
escape) needs to be imposed:
ν · ∇(L(μt) + S + V ) μt = 0
on ∂,
(24)
where ν denotes the unit outer normal vector to ∂.
3.2
A First PDE Approach in the (ρ, H) Formulation
As discussed before, an alternative approach is based on the (ρ, H) formulation
described in Sect. 2.3. So, it makes sense to design an appropriate evolution system
of PDEs with good convergence properties, which could potentially lead to a nice
particle method in the discrete case.
Let  ⊂Rd be the parameter space in this setting. Let D ⊂Rn and let h(θ, x) :
 × D →R be a ﬁxed activation function.
We consider now the functional
G(ρ, H) = 1
2

D


H(θ)h(θ, x)ρ(dθ) −f (x)
2
dx +


¯V (H, θ)ρ(dθ),
(25)
where, as before, f ∈L2(D) is a given function.
As in (16), we can write
G(ρ, H) = ¯G +

×
¯K(θ, ¯θ)H(θ)ρ(dθ)H( ¯θ)ρ(d ¯θ)
+


S(θ)H(θ)ρ(dθ) +


¯V (H, θ)ρ(dθ),
(26)
where
¯K(θ, ¯θ) = 1
2

D
h(θ, x)h( ¯θ, x)dx,
S(θ) = −

D
h(θ, x)f (x) dx,
(27)

42
X. Fernández-Real and A. Figalli
and ¯G = 1
2∥f ∥2
L2(D) is a constant. Notice that, also as before, the function S is
smooth if h is smooth with respect to θ.
We shall directly focus on the quadratic potential
¯V (H, θ) = ¯Vλ(H, θ) := λ
2

H 2 + |θ|2
,
(28)
so that, as discussed in Sect. 2.3, the natural space for H is given by L2(, ρ), and
our minimization problem is given by
min
ρ∈P()
H∈L2(,ρ)
G(ρ, H).
(29)
We now want to obtain an evolution system of PDEs for (ρ, H) with nice properties.
As we shall see, this can be performed in more than one way.
We ﬁrst start with the evolution of ρ ∈P(). As before, it makes sense to make
it evolve according to the Wasserstein gradient ﬂow of G. Namely, if we denote
(ρt, Ht) our evolution variables, we have
∂tρt = div

ρt∇δG
δρ (ρt, Ht)

,
where the ﬁrst variation density of G with respect to ρ at (ρ∗, H∗) ∈P() ×
L2(, ρ∗) is given by
δG
δρ (ρ∗, H∗) = 2H∗(·)


¯K(·, ¯θ)H∗( ¯θ)ρ∗(d ¯θ) + SH∗+ ¯Vλ(θ, H∗),
so that
∇δG
δρ (ρ∗, H∗) = 2∇

H∗(·)


¯K(·, ¯θ)H∗( ¯θ)ρ(d ¯θ)

+ ∇

SH∗

+ ∂H ¯Vλ(·, H∗)∇H∗+ (∇θ ¯Vλ)(·, H∗).
Thus, recalling (28), the evolution of ρt is given by
∂tρt = div

ρt∇(HtL(ρt, Ht))

+ div

ρt∇(SHt)

+ λ div

ρt

Ht∇Ht + θ

,
(30)
where
L(ρt, Ht)(θ) := 2


¯K(θ, ¯θ)Ht( ¯θ)ρt(d ¯θ)
(31)

The Continuous Formulation of Neural Networks
43
is a positive semi-deﬁnite integral operator (cf. (21)).
This gives the evolution of ρt, and one needs to couple it with an evolution for
Ht. We shall present now two possible approaches.
Separating Variables
The ﬁrst way to obtain an evolution for the non-conserved variable Ht is to disregard
partially the interaction between H and ρ: one performs the Wasserstein gradient
ﬂow of ρ, on the one hand, and the L2(, ρ) gradient ﬂow of H, on the other (see
[7, Examples 1 and 2]).
Namely, one considers
∂tHt = −δG
δH (ρt, Ht)
where, for a ﬁxed ρt, δG
δH (ρt, ·) denotes the variation of G(ρt, ·) with respect to H
in L2(, ρt).9 This is
δG
δH (ρ∗, H∗) = 2


¯K(·, ¯θ)H∗( ¯θ)ρ(d ¯θ) + S + ∂H ¯Vλ(·, H∗)
on supp ρ∗, and therefore the evolution of (ρt, Ht) is given by
∂tρt = div

ρt∇(HtL(ρt, Ht))

+ div

ρt∇(SHt)

+ λ div

ρt

Ht∇Ht + θ

∂tHt = −L(ρt, Ht) −S −λHt
(32)
(this is coupled with a Neumann boundary condition for ρt, analogous to (24),
whenever the domain  is not Rd).
Note that this evolution has some difﬁculties, since one needs to make sure that
all the terms appearing in the above PDE are well deﬁned, at least in a weak sense.
For instance, one needs to ensure that ρtHt∇Ht is well deﬁned. Giving a meaning
to this expression may be delicate if ρ is a singular measure. However, at least in the
smooth case, this PDE makes sense. In addition, there is dissipation of the energy
G along the path (ρt, Ht), namely,
9 Namely, for a ﬁxed ρ∗∈P(), δG
δH (ρ∗, H∗) is the unique function in L2(, ρ∗) such that
 δG
δH (ρ∗, H∗), ϕ
 
L2(,ρ∗)
= d
dε

ε=0
G(H∗+ εϕ)
∀ϕ ∈L2(, ρ∗).

44
X. Fernández-Real and A. Figalli
d
dt G(ρt, Ht) = −


∇δG
δρ (ρt, Ht)

2
ρt(dθ) −



δG
δH (ρt, Ht)

2
ρt(dθ).
In particular, since G(ρt, Ht) controls the L2(, ρt) norm of Ht, if one starts from
a pair (ρ0, H0) with H0 ∈L2(, ρ0), then Ht ∈L2(, ρt) (whenever the evolution
is well deﬁned). Also, integrating the dissipation inequality above over any time
interval implies that

 ∞
0


∇δG
δρ (ρt, Ht)

2
ρt(dθ) +



δG
δH (ρt, Ht)

2
ρt(dθ)

dt ≤G(ρ0, H0),
which implies in particular that ∇δG
δρ (ρt, Ht) and δG
δH (ρt, Ht) belong to L2(, ρt)
for a.e. t.
Transporting Along the Flow of ρt
Another way to describe the evolution of Ht is by incorporating the information that
it is transported along the ﬂow in the corresponding variable to be studied.
More precisely, note that the evolution of ρt in (32) can be written as a continuity
equation (see [8, Eq. (4.6)]):
∂tρt + div(ρtvt) = 0,
where
vt = −∇δG
δρ (ρt, Ht).
Hence, if we deﬁne Xt :  → as the ﬂow of vt, namely,
! ˙Xt = vt ◦Xt
X0 = Id,
(33)
then ρt = (Xt)#ρ0, where (Xt)#ρ0 denotes the push-forward measure of ρ0 through
the map Xt.10
Thus, instead of considering simply Ht (which does not see the ﬂow for ρt), an
alternative option consists in rewriting the functional in terms of the variable Ht ◦Xt,
which corresponds to transporting Ht along the ﬂow of ρt. Hence, recalling that we
are considering the potential ¯Vλ from (28), one considers the evolution of Ht ◦Xt
given by
10 That is,


ϕ(θ)[(Xt)#ρ0](dθ) =


ϕ(Xt(θ))(ρ0(dθ))
for any Borel function ϕ :  →R.

The Continuous Formulation of Neural Networks
45
∂t(Ht ◦Xt) = −(L(ρt, Ht) + S −λHt) ◦Xt.
Noticing that ∂t(Ht ◦Xt) = [∂tHt + vt · ∇Ht] ◦Xt (as a consequence of (33)), one
obtains
∂tHt + vt · ∇Ht = −L(ρt, Ht) −S −λHt.
Hence, the evolution system now becomes
∂tρt + div(ρtvt) = 0
∂tHt + vt · ∇Ht = −L(ρt, Ht) −S −λHt,
(34)
with
vt = −∇(HtL(ρt, Ht) + HtS) −λHt∇Ht −λθ,
(35)
and again there is a zero Neumann boundary condition for ρt whenever  is not Rd
(see (24)).
This corresponds the system introduced in [7, Section 5.4] in the zero potential
case (λ = 0), where they also design a particle method for this “modiﬁed gradient
ﬂow.” This is deﬁnitely a very interesting model. However, since this system does
not seem to dissipate energy in general, the mathematical analysis becomes more
complicated.
3.3
A Gradient Flow in the (ρ, H) Formulation via
Propagation of Chaos
Let us give yet another possible evolution for (ρt, Ht) that produces a dissipative
ﬂow and does not rely on the smoothness of the measure. In this case, we do so
by expressing the evolution in the μ formulation in the (ρ, H) variables, under a
propagation of chaos assumption. As we shall explain below, the resulting system
in this case is given by
∂tρt + div(ρtwt) = 0
∂tHt + wt · ∇Ht = −L(ρt, Ht) −S −∂H ¯V (·, Ht),
(36)
where now the vector wt is (cf. (35))

46
X. Fernández-Real and A. Figalli
wt = −Ht∇(L(ρt, Ht) + S) −∇θ ¯V (·, Ht),
(37)
and with zero Neumann boundary conditions
ν · wt ρt = 0
on ∂
(38)
whenever  is not Rd. In particular, the evolution of Ht is still given by the
corresponding evolution along the ﬂow transporting ρt, but differently from before,
ρt is not the standard Wasserstein ﬂow. As proved below, this system has the main
advantage that it dissipates energy; see Proposition 3.3.
In order to motivate the previous evolution system for the pair (ρt, Ht), we start
by rewriting the PDE (20) as a hierarchy system in the (w, θ) variables. This is
an inﬁnite non-closed system of PDEs that depends on higher moments for the
disintegration νθ and for the ﬁrst derivatives of the potential.
Lemma 3.2 Let (ξ, x) = w h(θ, x) and  = R ×  with  a smooth domain.
Consider μt a (smooth and fast decaying) solution to (20) and deﬁne the
disintegration into probability measures
μt(ξ) = νθ,t(w) ⊗ρt(θ).
Deﬁne Ht,i(θ) :=

R wiνθ,t(dw),
V w
t,i(θ) :=

R
wi∂wV (w, θ)νθ,t(dw),
V θ
t,i(θ) :=

R
wi∇θV (w, θ)νθ,t(dw),
and consider
L(ρt, Ht)(θ) := 2


¯K(θ, ¯θ)Ht( ¯θ)ρt(d ¯θ),
(39)
and ¯K and S be given by (27). Then, we have
⎧
⎪⎪⎪⎨
⎪⎪⎪⎩
∂tρt = divθ

ρtHt,1∇θ

L(ρt, Ht,1) + S

+ divθ(ρtV θ
t,0)
∂t(Ht,iρt) = divθ

ρtHt,i+1∇θ

L(ρt, Ht,1) + S

+ divθ(ρtV θ
t,i)
−iHt,i−1ρt(L(ρt, Ht,1) + S) −iV w
t,i−1ρt
∀i ≥1,
(40)
with boundary conditions (whenever  ̸= Rd)
ν ·
#
ρtHt,i∇θ

L(ρt, Ht,1) + S

+ ρtV θ
t,i−1
$
= 0
on ∂.
(41)
Proof Notice that

The Continuous Formulation of Neural Networks
47
L(μt)(ξ) = wL(ρt, Ht,1)(θ),
S = wS
(42)
(recall (17), (21), (27), and (31)). Integrating (20) with respect to w and recalling
(42), we obtain the ﬁrst equation
∂tρt = divθ(ρtHt,1∇θL(ρt, Ht,1)) + divθ(ρtHt,1∇θS) + divθ(ρtV θ
t,0)
using that

R
wμt(dw, θ) = ρtHt,1,

R
∇θV (w, θ)μt(dw, θ) = ρtV θ
t,0,
and that μtw has sufﬁcient decay in w so that the terms in ∂w in the divergence
disappear when integrating by parts.
Similarly, given i ≥1, we multiply (20) by wi and then integrate with respect to
w, to obtain
∂t(Ht,iρt) = divθ

ρtHt,i+1∇θ

L(ρt, Ht,1) + S

+ divθ(ρtV θ
t,i)
+

R
wi∂w

L(ρt, Ht,1) + S + ∂wV

νθ,t(dw) ⊗ρt

.
Integrating by parts, we obtain the desired result.
The Neumann boundary conditions follow with the same procedure.
⊓⊔
As noticed above, the previous system (40) is not closed, as the i-th equation
depends on Hi+1. Note however that the system could be closed if one knew that
νθ,t(w) = δHt(θ)(w), since in that case
Ht,i(θ) = Ht(θ)i = H i
t,1(θ)
∀i ≥1.
This suggests a propagation of chaos assumption on the w variable in the previous
expressions: by assuming that μ preserves being a delta in the w-variable (viz.,
νθ,t(dw) = δHt(θ) for some Ht(θ) for all t ≥0), one gets a well-deﬁned system
of equations that now depends only on (ρ, H) and no longer sees the μ structure
from before. In this case, if we denote Ht = Ht,1, we have that Ht,2 = H 2
t , V w
t,0 =
∂wV (Ht, θ), and V θ
t,i = H i
t ∇θV (Ht, θ). Also, since the equation for Ht,1 is already
closed, one does not need to look at the other equations for i ≥2.
Based on this discussion, our proposed new system is given by the following
evolution equations:
⎧
⎪⎪⎨
⎪⎪⎩
∂tρt = div

ρtHt∇

L(ρt, Ht) + S

+ div(ρt∇θ ¯V (θ, Ht))
∂t(Htρt) = div

ρtH 2
t ∇

L(ρt, Ht) + S

−ρt(L(ρt, Ht) + S)
+div(ρtHt∇θ ¯V (θ, Ht)) −ρt∂H ¯V (θ, Ht),
(43)

48
X. Fernández-Real and A. Figalli
where L is given by (39), and it is combined with the zero Neumann boundary
condition
ν ·
#
ρtHt∇

L(ρt, Ht) + S

+ ρt∇θ ¯V (θ, Ht)
$
= 0
on ∂
(44)
whenever  is not Rd (cf. (40)–(41)).
Note that (43)–(44) is exactly our proposed model (36)–(38). In order to see that
this new system is a reasonable candidate for the minimization of the energy (26),
we prove now that the energy decreases along this evolution.
Proposition 3.3 Let (ρt, Ht) solve (43)–(44), and let G be given by (26). Then
d
dt G(ρt, Ht) = −


Ht∇(L(ρt, Ht) + S) + ∇θ ¯V (θ, Ht)
2 ρt
−



L(ρt, Ht) + S + ∂H ¯V (θ, Ht)
2 ρt.
In particular, the energy G is decreasing along (ρt, Ht).
Proof We compute the derivative of G(ρt, Ht) starting from (26). We have
d
dt G(ρt, Ht) =


(L(ρt, Ht) + S) ∂t(Htρt)
+


∂H ¯V (θ, Ht)ρt∂tHt +


¯V (θ, Ht)∂tρt
= I + II + III,
so that we can use (43) to substitute the time derivatives by the corresponding
expressions. In particular, using that ∂t(Htρt) = Ht∂tρt + ρt∂tHt and (43), we
deduce that
ρt∂tHt = ρtHt∇Ht · ∇

L(ρt, Ht) + S

−ρt(L(ρt, Ht) + S)
+ ρt∇Ht · ∇θ ¯V (θ, Ht) −ρt∂H ¯V (θ.Ht).
For the sake of readability, let us denote
N t := L(ρt, Ht) + S,
∂H ¯Vt := (∂H ¯V )(θ, Ht),
¯Vt := ¯V (θ, Ht),
∇θ ¯Vt := (∇θ ¯V )(θ, Ht).
Using these formulas, and integrating by parts using (44), we get
I =


N t ∂t(Htρt) = −


|∇N t|2H 2
t ρt −


N
2
t ρt

The Continuous Formulation of Neural Networks
49
−


∇N t · ∇θ ¯VtHtρt −


∂H ¯VtN tρt,
II =


∂H ¯Vt∇Ht · ∇N tHtρt −


∂H ¯VtN tρt
+


∂H ¯Vt∇Ht · ∇θ ¯Vtρt −


|∂H ¯Vt|2ρt,
and
III = −


∇θ ¯Vt · ∇N tHtρt −


∂H ¯Vt∇Ht · ∇N tHtρt
−


|∇θ ¯Vt|2ρt −


∂H ¯Vt∇Ht · ∇θ ¯Vtρt.
Adding these identities, one ﬁnally gets
I + II + III = −


|∇N t|2H 2
t ρt −


|∇θ ¯Vt|2ρt −2


∇N t · ∇θ ¯VtHtρt
−


N
2
t ρt −


|∂H ¯Vt|2ρt −2


∂H ¯VtN tρt,
from which we obtain the desired result.
⊓⊔
Remark 3.4 The fact that the system (36) dissipates energy suggests that there
might be a gradient ﬂow structure associated to it. We claim that this is the case.
Indeed, denote by (ρ(1), ρ(2)) the set of transport plans between ρ(1) and ρ(2),
namely,
(ρ(1), ρ(2)) :=
%
γ ∈P( × ) : πj
# γ = ρ(j)&
,
where πj :  ×  →, j = 1, 2, are the canonical projection onto the ﬁrst and
second factor, respectively. Then, we consider the distance between (ρ(1), H (1)) and
(ρ(2), H (2)) given by
D2((ρ(1), H (1)), (ρ(2), H (2)))
:=
inf
γ ∈(ρ(1),ρ(2))

×

|θ1 −θ2|2 + |H (1)(θ1) −H (2)(θ2)|2
dγ (θ1, θ2).
A classical but tedious computation shows that, at least formally, the gradient ﬂow
of G with the distance D is given by (36).

50
X. Fernández-Real and A. Figalli
It would be interesting to make this argument rigorous (perhaps using a scheme
à la JKO [1, 10]) and to use this gradient ﬂow interpretation to better study (36).
4
Regularized Problems
In order to study the behavior of solutions to the PDEs constructed in the previous
sections (viz., (20), (32), (34)–(35), or (36)–(37)), it is sometimes convenient to
regularize them by adding a small perturbation to the energy functional (or the PDE)
that regularizes it.
For simplicity, we focus here on (20), although similar discussions could be done
to the other PDEs. We present here two possible of such strategies, by converting
the original PDE into a heat-type equation or a porous medium-type equation.
4.1
Heat Regularization
A natural way to control the degeneracy of critical points of our functional in (7)
or (15) is to add a small entropy term in the minimization procedure. That is, for
τ > 0, consider the functional
Fτ(μ) = 1
2

D


(ξ, x)μ(dξ) −f (x)
2
dx +


V (ξ) μ(dξ) + τ Ent(μ)
(45)
where
Ent(μ) :=
⎧
⎨
⎩

 ρ(ξ) log(ρ(ξ))dξ if μ(dξ) = ρ(ξ) dξ,
+∞
if μ ̸≪dξ.
Adding this entropy term corresponds to a variation in the stochastic gradient
descent in which, when performing discrete in time approximations of (4), one adds
a noisy diffusion term. Alternatively, in terms of the PDE describing the evolution
of the gradient ﬂow in the Wasserstein metric of Fτ, the addition of the entropy
corresponds to adding a small diffusive term in the right-hand side of (20) (see, for
instance, [10]). Thus, if μt is the Wasserstein gradient ﬂow of Fτ, then
∂tμt = div (μt∇L(μt)) + div (μt∇S) + div(μt∇V ) + τμt,
(46)
where we are using the notation in (17) and (21).
As before, when  is not Rd+1, we add zero Neumann boundary conditions:

The Continuous Formulation of Neural Networks
51
ν · {∇(L(μt) + S + V ) μt + τ∇μt} = 0
on ∂.
(47)
The PDE (46)–(47) presents a nicer structure than the original (20), and it has
been studied in the context of training shallow neural networks. In particular, in
[9, 11], this equation appears when approximating functions f by an increasing
number of “bumps.” There, the authors prove existence and uniqueness of solutions
(even in domains with Neumann boundary conditions (47)), and they provide some
regularity and convergence estimates for solutions. Observe that, in this case, one
gets immediate smoothing (and also immediate full support) for μt.
It is interesting to rewrite (45) in a different way, in terms of stationary solutions.
Indeed, let us denote by μ∗∈P() a stationary solution (viz., such that the
corresponding dissipation vanishes; see Deﬁnition 3.1). Then, we can write
Fτ(μ) −Fτ(μ∗) =

×
K(ξ, ¯ξ)μ(dξ)μ(d ¯ξ) −

×
K(ξ, ¯ξ)μ∗(dξ)μ∗(d ¯ξ)
+


S(ξ)(μ −μ∗)(dξ) +


V (ξ)(μ −μ∗)(dξ)
+ τ (Ent(μ) −Ent(μ∗)) .
(48)
On the other hand, since μ∗is a stationary solution, it has full support, and the ﬁrst
variation density of Fτ must be constant everywhere. That is,
δFτ
δμ (μ∗) = 2


K(ξ, ¯ξ)μ∗(d ¯ξ) + S(ξ) + V (ξ) + τ log(μ∗) ≡λ
in 
for some λ ∈R. In particular, integrating with respect to both μ∗and μ, we get
2

×
K(ξ, ¯ξ)μ∗(dξ)μ∗(d ¯ξ) +


(S(ξ) + V (ξ)) μ∗(dξ) + τ


log(μ∗)μ∗= λ,
2

×
K(ξ, ¯ξ)μ(dξ)μ∗(d ¯ξ) +


(S(ξ) + V (ξ)) μ(dξ) + τ


log(μ∗)μ = λ.
We can now subtract the previous two expressions and substitute in (48) to obtain
Fτ(μ) = Fτ(μ∗) +

×
K(ξ, ¯ξ)(μt(dξ) −μ∗(dξ))(μt(d ¯ξ)
−μ∗(d ¯ξ)) + τDKL(μ∥μ∗),
(49)
where
DKL(μ∥μ∗) :=
⎧
⎪⎨
⎪⎩

 μ log

μ
μ∗

if μ ≪μ∗,
+∞
if μ ̸≪μ∗,

52
X. Fernández-Real and A. Figalli
is the relative entropy (also called Kullback-Leibler divergence) of μ with respect
to μ∗. Note that the middle term in (49) is always non-negative (since K is positive
semi-deﬁnite) and that DKL(μ∥ν) ≥0 with equality if and only if μ = ν. In
particular, F(μ) ≥F(μ∗) with equality if and only if μ = μ∗.
Hence, besides obtaining a nice expression for Fτ in terms of a stationary
solution, (49) also shows that stationary solutions are unique and they coincide with
the unique minimizer of the functional (45).
4.2
The Porous Medium Regularization
Another possible regularization, that has been much less studied in this context, is
the one arising from the porous medium equation.
In this case, we consider the functional
Fτ(μ) = 1
2

D


(ξ, x)μ(dξ) −f (x)
2
dx +


V (ξ) μ(dξ) + τ
2


μ2
(50)
for some small parameter τ > 0 (again,

 μ2 = +∞by deﬁnition if μ is not
absolutely continuous). Then, the Wasserstein gradient ﬂow is given by
∂tμt = div (μt∇L(μt)) + div (μt∇S) + div(μt∇V ) + τ div(μt∇μt),
(51)
(with the analogous Neumann boundary condition when  is not Rd+1, cf. (24) and
(47)).
In this context, one still expects nice properties of the corresponding evolution
of the gradient ﬂow, consistent with those in the porous medium equation [17].
In particular, any stationary solution should have full support (since the support
increases with time, up until covering the whole domain). And the same reasoning
as in the case of the heat regularization (which was based on the full support of a
stationary solution μ∗) applies, and we get
Fτ(μ) = F(μ∗) +

K(ξ, ¯ξ)(μt(dξ) −μ∗(dξ))(μt(d ¯ξ) −μ∗(d ¯ξ))
+ τ
2


(μ −μ∗)2,
(52)
which is similar to (49), where the relative entropy is substituted by the L2 distance.
Thus, from (52), we also get the uniqueness of stationary solutions (and hence, they
coincide with the unique minimizer).

The Continuous Formulation of Neural Networks
53
Remark 4.1 The two previous regularizations also make sense in the (ρ, H)
formulation setting. In particular, one could also add a Laplacian or porous medium
term to the PDE transporting ρ in (32), (34), or (36), in order to obtain improved
convergence properties.
4.3
An Observation Without Regularization
We can also rewrite the functional F in (16) in terms of a local minimizer (thus
removing the explicit dependence on f in its expression), even in the case without
regularization.
That is, let μ∗be a local minimizer for F. In particular, it is a stationary point,
and it satisﬁes11
δF
δμ (μ∗) ≡λ
in
supp(μ∗).
(53)
Moreover, from the local minimality condition, we also have12
δF
δμ (μ∗) ≥λ
in
.
(54)
So, combining (53)–(54), and proceeding as in the regularized cases, we obtain
F(μt) −F(μ∗) ≥

 
(ξ, x)(μt(dξ) −μ∗(dξ))
2
dx.
11 To see this, take ϕ ∈C∞
c () with

 ϕ(ξ)μ∗(dξ) = 0, and for |ε| ≪1, we consider the
variation με := (1 + εϕ)μ∗∈P(). Then, by local minimality, we get
0 = d
dε

ε=0
F(με) =


δF
δμ (μ∗)(ξ) ϕ(ξ) μ∗(dξ)
∀ϕ ∈C∞
c () s.t.


ϕ(ξ)μ∗(dξ) = 0.
By the arbitrariness of ϕ, this implies that δF
δμ (μ∗) is constant on supp(μ∗).
12 To see this, given ν ∈P(), for ε ∈[0, 1], we consider the variation με := (1 −ε)μ∗+ εν ∈
P(). Then, by local minimality, we get
0 ≤d
dε

ε=0
F(με) =


δF
δμ (μ∗)(ξ)ν(dξ) −


δF
δμ (μ∗)(ξ)μ∗(dξ)
=


δF
δμ (μ∗)(ξ)ν(dξ) −λ =


δF
δμ (μ∗)(ξ) −λ

ν(dξ),
where the second equality follows from (53). By the arbitrariness of ν ∈P(), this implies that
δF
δμ (μ∗) is everywhere greater than or equal to λ.

54
X. Fernández-Real and A. Figalli
In particular we recover the uniqueness of local minimizers under , that we already
knew by Remark 2.1.
5
Open Questions
We conclude this manuscript by discussing some open questions that we believe to
have a mathematical interest.
5.1
Regularity and Convergence
One of the main open questions is concerned to the convergence properties of our
gradient ﬂows and its relation to the discrete version of the gradient descent. The
main currently known results in this direction can be found (and referenced) in
[4], where the authors are able to prove the consistency between the many neuron
limits and the Wasserstein gradient ﬂow as time goes to inﬁnity, whenever such
limits exist. Nonetheless, many questions remain open in this setting, starting from a
quantitative (uniform) convergence to the Wasserstein gradient ﬂow, in the limits as
N →∞and t →∞. Furthermore, the results in [4] use the speciﬁc (homogeneous)
structure of the activation function. Thus, the results included in [4] in more general
settings remain open, even if one assumes discriminating smooth kernels.
Concerning the continuous formulation (20), this PDE pose a series of interesting
challenges. For example:
(i) What are reasonable assumptions on μ0 and the data, to expect a conservation
of its smoothness over time? (That is, to avoid convergence in ﬁnite and/or
inﬁnite time to a singular measure.)
(ii) It looks likely to us that one can prove a qualitative rate of convergence,
using, for instance, the approach in [3]. More challenging and relevant in this
setting is to obtain quantitative convergence rates. Such quantiﬁcation seems
far from being easy in the μ formulation case, where one would need to ﬁnd
an “entropy-entropy dissipation inequality,” showing that the dissipation (22)
controls F(μt) −F(μ∗), at least when the μt is close to the minimizer μ∗.
(iii) Even in the regularized cases (46) or (51), ﬁnding quantitative rates of
convergence is an interesting open problem.13
13 Consider for simplicity the PDE (46) with V ≡0. Then, assuming that for t large μt is close in
some strong sense to the stationary state μ∗and that μ∗is smooth and has full support, then one
can get an inequality of the form
d
dt Fτ(μt) ≤−c (Fτ(μt) −Fτ(μ∗) + τF(μt, μ∗))2

The Continuous Formulation of Neural Networks
55
σ(θ1 · x)
σ(θ2 · x)
σ(θ3 · x)
σ(θN1 · x)
x
θ1
θ2
θ3
θN
θi ∈Rd+1
bji ∈R
σ
N1
i=1b1iσ(θi · x)

w1
w2
wN2
wi ∈R
σ
N1
i=1b2iσ(θi · x)

σ
N1
i=1bN2iσ(θi · x)

b11
b21
bN21
bN2N1
N2

j=1
wjσ
 N1

i=1
bjiσ(θi · x)

Fig. 2 Graphic representation of the approximating functions given by what is known as a two-
layer neural network (55)
5.2
Multilayer Neural Networks
Training a multilayer neural network corresponds to the approximation problem of
a given function f ∈L2(D), where the approximating functions are obtained by
iterations of the construction in (1).
Assume for simplicity that h(θ, x) = σ(θ · x) and ignore the independent term
(i.e., n = d and θ(d) = 0; see (2)). Then, in the two-layer case, given an input
x ∈Rn, we want to approximate a given output f (x) through a neural network
with two hidden layers, consisting of N1 and N2 neurons each. Let us denote the
parameters in this case as {wj}1≤j≤N2 with wi ∈R, {θj}1≤j≤N1 with θj ∈Rn,
and {bji}1≤j≤N2,1≤i≤N1 with bji ∈R. The corresponding approximating function
is then given by
N2

j=1
wjσ
 N1

i=1
bjiσ(θi · x)

,
(55)
for some activation function σ : R →R (see Fig. 2 and compare with Fig. 1). Thus,
we want to optimize the parameters in order to minimize a functional of the form
1
2

D
 N2

j=1
wjσ
 N1

i=1
bjiσ(θi · x)

−f (x)
2
dx.
for some suitable function F(μt, μ∗) such that F(μt, μ∗) →0 as t →∞. This suggests a rate of
convergence of the form Fτ(μt) −Fτ (μ∗) ∼1
t , at least in the regularized case.

56
X. Fernández-Real and A. Figalli
The corresponding expression of the previous functional in the (appropriate) limit
N1, N2 →∞is an interesting open problem, and some possible interpretations have
recently been suggested in [2, 12, 13, 16]. However, a simple uniﬁed connection
between multiple layers neural networks and Wasserstein gradient ﬂows, as the one
presented in this paper, seems to be missing.
In this direction, it might be worth mentioning that the (ρ, H)-approach seems
more adequate when dealing with systems in which one needs to consider separately
each of the layers: already in the single layer case, the (ρ, H)-formulation is the
one that takes advantage of the structure of the activation functions w h(θ, x). Even
there, however, one does not fully take advantage of the linear structure of h(θ, x) =
σ(θ · x) inside the function σ.
References
1. Ambrosio, L., Gigli, N., Savare, G.: Gradient Flows in Metric Spaces and in the Space of
Probability Measures. Lectures in Mathematics. Springer, Berlin (2008)
2. Araújo, D., Oliveira, R.I., Yukimura, D.: A mean-ﬁeld limit for certain deep neural networks.
Preprint arXiv https://arxiv.org/abs/1906.00193
3. Carrillo, J., Gvalani, R., Wu, J.: An invariance principle for gradient ﬂows in the space of
probability measures. Preprint arXiv https://arxiv.org/abs/2010.00424
4. Chizat, L., Bach, F.: On the global convergence of gradient descent for over-parameterized
models using optimal transport. In: Advances in Neural Information Processing Systems
(NeurIPS) (2018)
5. E, W.: A proposal on machine learning via dynamical systems. Commun. Math. Stat. 5, 1–11
(2017)
6. E. W., Han, J., Li, Q.: A mean-ﬁeld optimal control formulation of deep learning. Res. Math.
Sci. 6, 10 (2019)
7. E, W., Ma, C., Wu, L.: Machine learning from a continuous viewpoint, I. Sci. China Math. 63,
2233–2266 (2020)
8. Figalli, A., Glaudo, F.: An Invitation to Optimal Transport, Wasserstein Distances, and Gradient
Flows, EMS Textbooks in Mathematics, 144 pp. European Mathematical Society (EMS),
Zürich (2021)
9. Javanmard, A., Mondelli, M., Montanari, A.: Analysis of a twolayer neural network via
displacement convexity. Ann. Statist. 48, 3619–3642 (2020). ArXiv version: https://arxiv.org/
abs/1901.01375
10. Jordan, R., Kinderlehrer, D., Otto, F.: The variational formulation of the Fokker-Planck
equation. SIAM. J. Math. Anal. 29, 1–17 (1998)
11. Mei, S., Montanari, A., Nguyen, P.: A mean ﬁeld view of the landscape of two-layer neural
networks. PNAS 115, 7665–7671 (2018). ArXiv version: https://arxiv.org/abs/1804.06561
12. Nguyen, P.-M.: Mean ﬁeld limit of the learning dynamics of multilayer neural networks.
Preprint arXiv https://arxiv.org/abs/1902.02880
13. Nguyen, P.-M., Pham, H.-T.: A rigorous framework for the mean ﬁeld limit of multilayer neural
networks. Preprint arXiv https://arxiv.org/abs/2001.11443
14. Rotskoff, G., Vanden-Eijnden, E.: Neural networks as interacting particle systems: asymptotic
convexity of the loss landscape and universal scaling of the approximation error (2018).
Preprint arXiv

The Continuous Formulation of Neural Networks
57
15. Sirignano, J., Spiliopoulos, K.: Mean ﬁeld analysis of neural networks: a law of large numbers.
SIAM J. Appl. Math. 80(2), 725–752 (2020)
16. Sirignano, J., Spiliopoulos, K.: Mean ﬁeld analysis of deep neural networks. Math. Oper. Res.
47(1), 120–152 (2022)
17. Vázquez, J.L.: The Porous Medium Equation: Mathematical Theory. Oxford Lecture Series in
Mathematics and its Applications, vol. 33. Oxford University Press, Oxford (2006)

On the Origins, Nature, and Impact of
Bourgain’s Discretized Sum-Product
Theorem
Alexander Gamburd
Abstract We discuss the origins, nature, and development of the discretized sum-
product theorem, a result which Jean Bourgain viewed as one of his most signiﬁcant.
There are two labyrinths of the human mind: one concerns the composition of the
continuum, and the other the nature of freedom, and both spring from the same source –
the inﬁnite.
Baron von Leibniz
During World War II, when von Neumann was working on the design of nuclear weapons,
he came to the conclusion that analytical methods were inadequate to the task, and that the
only way to deal with equations of continuum mechanics is to discretize them. ...It is to
this task that von Neumann devoted his energies after the war.
Peter Lax
1
Overture
Baron Bourgain, the IBM von Neumann Professor in the School of Mathematics
at the Institute for Advanced Study (IAS), is one of the most original, penetrating,
This essay, dedicated to the memory of Jean Bourgain, is an augmented and expanded version of
Singular Adventures of Baron Bourgain in the Labyrinth of the Continuum, which appeared in the
Notices of the AMS, 67, 2020, 1716–1733. The opening image is coat of arms of Jean Bourgain,
who was bestowed the title of Baron by King Philippe of Belgium in July 2015.
A. Gamburd ()
Department of Mathematics, CUNY Graduate Center, New York, NY, USA
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
A. Avila et al. (eds.), Analysis at Large, https://doi.org/10.1007/978-3-031-05331-3_4
59

60
A. Gamburd
and versatile analytical minds of our troubled times, justly celebrated1 and revered
without reservations.
While he rejected outright the suggestion of a sixtieth birthday conference, a
proposal to have a gathering occasioned by the publication of his 500th paper was
1 An excerpt from Bourgain’s interview upon receiving the 2017 Breakthrough Prize in Mathemat-
ical Sciences concludes this essay.
The following quote is from The Work of Jean Bourgain by Luis Caffarelli, Proceedings of
ICM, 1994 [23] (the year Bourgain was awarded the Fields Medal): “Bourgain’s work touches on
several central topics of mathematical analysis: the geometry of Banach spaces, convexity in high
dimensions, harmonic analysis, ergodic theory, and, ﬁnally, nonlinear partial differential equations
from mathematical physics. In all of these areas, he made spectacular inroads into questions
where progress has been blocked for a long time. This he did by simultaneously bringing into
play different areas of mathematics: number theory, combinatorics, probability, and showing their
relevance to the problem in the previously unforeseen fashion. ...Some of the outstanding qualities
of Bourgain are his power to use whatever it takes—number theory, probabilistic methods, covering
techniques, sharp decompositions – to understand the problem at hand, and his versatility, which
allowed him to deeply touch so many areas in such a short period of time.”

Bourgain’s Discretized Sum-Product Theorem
61
Fig. 1 Two of Jean
Bourgain’s signature results
not immediately dismissed—the conference Analysis and Beyond: Celebrating Jean
Bourgain’s Work and Impact took place at the IAS in Princeton on May 21–24,
2016. The conference talks (all of which were videotaped) are a tribute to the depth
and breadth of Bourgain’s work and its singular and transcendent impact on the
whole of our discipline. The beauty and power of the ﬁrst result highlighted by
Jean’s hand (Fig. 1) on the conference poster ∥eitϕ∥p ≪Nε∥ϕ∥q is apparent
from reading the splendid paper by Andrea Nahmod in the Bulletin of the American
Mathematical Society (BAMS), [71]. The brief of this paper is to explicate the
origins, nature, and development of the second result, the discretized sum-product
inequality
N(A + A, δ) + N(A · A, δ) > N(A, δ)1+τ,
(1)
in analysis and beyond.
***
The three great branches of mathematics are, in historical order, Geometry, Algebra and
Analysis. Geometry we owe essentially to Greek civilization, Algebra is of Indo-Arab origin
and Analysis (or Calculus) was the creation of Newton and Leibniz, ushering in the modern
era.
Sir Michael Atiyah [1]
Von Zahlen und Figuren—“On Numbers and Shapes”2 is the title of one of the
most successful expositions of mathematics aimed at a broad audience, reﬂecting a
common perception of our discipline as a marriage between Algebra and Geometry.
This happy marriage, notwithstanding Count Tolstoy’s contention (“All happy
marriages are alike; each unhappy marriage is unhappy in its own way.”), is not
without tensions (as, perhaps, each happy marriage—including, possibly, bicameral
mind—is in its own way). “In these days the angel of topology and the devil of
abstract algebra ﬁght for the soul of each individual mathematical domain” is the
2 The book was written in 1933 by Hans Rademacher and Otto Toeplitz, two outstanding analysts
of the past century, who made a deliberate decision not to refer in their exposition to the analysis
(or Calculus) of Leibniz and Newton. The English translation is entitled “The Enjoyment of Math.”

62
A. Gamburd
way Hermann Weyl3 put it; three score and seven years later, in conversation at
Google with the company’s CEO, a somewhat divergent sentiment was expressed:
“When you form your ideas on the basis of words, you build from concepts, which
to be meaningful depend on relation to other concepts. When you form your ideas on
the basis of pictures, you form your views on the basis of impressions and of moods,
that cannot even be recreated very easily, so you cannot look back and check what
it was that impressed you so much.”4
This tension is embodied in the system of real numbers, the soil in which the
functions of Analysis grow, resembling Janus’s head facing in two directions: on the
one hand, it is the ﬁeld closed under the operations of addition and multiplication;
on the other hand, it is a continuous manifold the parts of which are so connected
as to defy exact isolation from each other. The one is algebraic; the other is the
geometric face of real numbers. Continued fractions are much more intrinsic and
geometric forms of discretizing the continuum; the lack of a practical algorithm for
their addition and multiplication leads to the regnancy of the discretization based on
the ordinary (digital or decimal, i.e., base 10) fractions.
Whereas Newton, in his development of Calculus, was primarily motivated by
“dynamics” (force, acceleration), as exempliﬁed by the falling of the apple on his
head, Leibniz, it appears, was more intrigued by what would now be described
by the appellation “fractal geometry of nature.” “Imagine a circle; inscribe within
it three other circles congruent to each other and of maximum radius; proceed
similarly within each of these circles and within each interval between them, and
imagine that the process continues ad inﬁnitum,”wrote Leibniz referencing conﬁg-
uration akin to the four mutually tangent circles appearing on Baron Bourgain’s
coat of arms. Leibniz’s deﬁnition of the straight line as a ‘curve, any part of which
is similar to the whole, and it alone has this property, not only among curves but
among sets’ is a reﬂection of the fractal nature of the continuum: the Cantor set
would satisfy Leibniz’s deﬁnition.5
Dynamics, broadly conceived, is perceived as a study of change, which in its
primordial (physical) context takes place within time. The Cantor set (and R) is,
so to speak, timeless, i.e., static in time, but there is “a condition of possibility”
of (almost) “equiprimordial” change “in the eye of the beholder,” taking form in
changing the degree of magniﬁcation scale and “zooming in.” This is reﬂected in
the “multi-scale” nature of Bourgain’s proof(s) of (1).
3 In Invariants, Duke Mathematics Journal 5 1939, anticipating by 4 years an even more sweeping
assertion, due to Jean-Paul Sartre: “L’enfer, c’est les autres.”
4 Henry Kissinger.
5 Leibniz also wrote the ﬁrst textbook on combinatorics Dissertatio de arte combinatoria and
invented the binary notation, which made possible modern computers and will play an important
role in navigating the labyrinth of Bourgain’s argument.
The ﬁrst collection of Leibniz’s works was published in 1735 by Rudolf Erich Raspe, better
known today for his authorship of Singular Adventures of Baron Munchausen.

Bourgain’s Discretized Sum-Product Theorem
63
To bring this opening section to a close, let us in passing note that both results
chosen by Jean are not equalities (inequalities, rather), commenting thus:
If Algebra is generally perceived as the study of equations, what perhaps lies
at the heart of Analysis are inequalities, or estimates, which compare the size of
two quantities or expressions. Einstein’s discovery that nothing travels faster than
light is an example of an inequality. The inequality 2X is considerably larger than
X arguably neatly encapsulates both the P vs NP problem (properly stated for
ﬁnite X) and Cantor’s continuum problem (when X is the ﬁrst inﬁnite ordinal). An
elementary inequality, taught in the middle school, asserts that the arithmetic mean
of two positive numbers is never less than their geometric mean. In between these
two extremes there is a vast range of estimates of great variety and importance. Such
estimates, reﬂecting and quantifying some subtle aspect of the underlying problem,
are often exceedingly difﬁcult to prove. It will be seen that for the inequality (1),
with which we are about to get intimate, the underlying issue lies at the heart of
the tension between the algebraic and (fractal)-geometric nature of the continuum.
Fractal derives from Latin fractus, meaning broken apart; algebra derives from the
Arabic al-jabr, meaning the reunion of broken parts.
2
Origins: Kakeya-Besicovitch Problem+
It is difﬁcult and often impossible to judge the value of a problem correctly in advance; for
the ﬁnal award depends upon the gain which science obtains from the problem. Nevertheless
we can ask whether there are general criteria which mark a good mathematical problem. An
old French mathematician said: ‘A mathematical theory is not to be considered complete
until you have made it so clear that you can explain it to the ﬁrst man whom you meet on
the street.’ This clearness and ease of comprehension, here insisted on for a mathematical
theory, I should still more demand for a mathematical problem if it is to be perfect; for what
is clear and easily comprehended attracts, the complicated repels us.
David Hilbert, Problems of Mathematics, 1900
In Hilbert’s6 democratic dictum, if followed by S¯oichi Kakeya (writing the paper
on an island nation in 1917, at the height of the Great War), the explanation of
the problem now bearing his name to almost every person at just about any street
in Eastern Eurasia might have run as follows: Entrusted with defending an island,
possessing a huge hill, cragged and steep, your task is to purchase at the least cost to
the nation’s treasury, a plot of land on the ﬂat hilltop with the following property—a
cannon of length one must be capable of pointing in any direction.
Kakeya improved by a factor of one-half the obvious solution (a circle of
diameter one, having area
π
4 ); his proposed shape (three-cusped hypocycloid
6 Hilbert’s paper on Dirichlet’s Principle is one of the two referenced by Kakeya [48]; the second
one (also on Dirichlet’s principle) is by Caratheodory, a student of Hilbert. In his magniﬁcent book
Geometry and Imagination, Hilbert refers to Besicovitch’s result (described below) as “showing
that this [Kakeya] problem has no solution.”

64
A. Gamburd
Fig. 2 Analysis and beyond
inscribed in the circle of radius 1) is alluded to in the rendering of A in the conference
poster (Fig. 2). In the same year, working in Perm,7 while the October/November
Russian/Soviet Revolution was unfolding, A. S. Besicovitch reduced the minimal
necessary sum to virtually8 nothing.
In fact, Besicovitch was working on the following question: if f is a Riemann
integrable function deﬁned on the plane, is it always possible to ﬁnd a pair of
orthogonal coordinate axis with respect to which

f (x, y)dx exists as a Riemann
integral for all y, and with resulting function of y also Riemann integrable?
Besicovitch noticed that if he could construct a compact set F of plane Lebesgue
measure zero containing a line segment in every direction, this would lead to a
counterexample as follows. Assume (by translating F if necessary) that F contains
no segment parallel to and of rational distance from either of a ﬁxed pair of axes. Let
f be the characteristic function of the set Fr consisting of those points of F with at
least one rational coordinate. As F contains a segment in every direction on which
both Fr and its complement are dense, there is a segment in each direction in which
f is not Riemann integrable. On the other hand, the set of points of discontinuity
of F is of plane measure zero, so f is Riemann integrable over the plane by the
well-known criterion of Lebesgue.
The basic idea underlying the original construction of Besicovitch [5] is to
form a ﬁgure obtained by splitting an equilateral triangle of unit height into many
smaller triangles of the same height by dividing up the base and then sliding these
elementary triangles varying distances along the base line. In 1964 Besicovitch
developed a completely different approach [6], using the projection theorem due
to Marstrand.
7 Subsequently Molotov (1940–1957); currently Perm.
8 The virtual collapse of the Russian currency appears to have had nothing to do with it. In 1924,
together with Tamarkin, Besicovitch crossed the Soviet border with Norway on foot and made his
way to Copenhagen to work with H. Bohr, eventually settling in Cambridge in 1927, where, in due
course, he became the Rouse Ball Chair. Besicovitch’s command of English remained stationary
from his early days in Cambridge (“It’s a story...”); for him, for example, the deﬁnite article
was superﬂuous. A story is told that during one of his lectures, an undergraduate tittered at some
distortion of English idiom. “Gentlemen,’ said Besicovitch, “there are 50 million Englishmen speak
English you speak; there are 500 million Russians speak English I speak.” [22]

Bourgain’s Discretized Sum-Product Theorem
65
2.1
Some Fundamental Properties of Plane Sets of Fractional
Dimension
In this 1954 paper [67], which was essentially the work for his doctoral thesis
at Oxford and was heavily inﬂuenced by Besicovitch, John Marstrand proved the
following fundamental result.
Theorem 1 (Marstrand’s Projection Theorem) Denote the projection in the
direction θ by πθ. If X ∈R2 is a Borel subset of Hausdorff dimension s, then
dimH(πθX) = min(s, 1) for almost every θ.
Concerning the ﬁner information about the set of exceptional θ in Theorem 1,
Kaufman proved [51] that if dim X ≥t, B ⊂S1 with dim B > t, then there exists
θ ∈B such that dim(πθ(X) ≥t. Using crucially (1), in The Discretized Sum-
product and Projection Theorems [14], Bourgain established the following, sharper
result:
Theorem 2 Given 0 < α < 2 and κ > 0, there is η > α
2 such that if X ⊂R2 is of
Hausdorff dimension greater than α, then dimH(πθ(X)) ≥η for all θ ∈S1 except
in an exceptional set E satisfying dimH(E) ≤κ.
2.2
Besicovitch Type Maximal Operators and Applications to
Fourier Analysis
We must admit with humility that, while number is purely a product of our mind, space has
a reality outside of our mind, so that we cannot prescribe its laws a priori.
Gauss, Letter to Bessel, 1830
The Kakeya problem in Rn is to estimate the fractal dimension of the Besicovitch
set E ⊂Rn, i.e., a set containing line segments of length one in all directions.
Conjecture 1 Let E be a Besicovitch set in Rn. Then β(n) = dim(E) = n.
There are several relevant notions of “fractal dimension,” the simplest being the
Minkowski dimension, deﬁned as follows. Let A be a closed subset of a metric space
X. Fix some radius δ. Let N(A, δ) be the least number of balls of radius δ needed to
cover A. If A is a rectiﬁable curve in Rn, it is easy to see that N(A, δ) is of order δ−1.
If A is a surface, N(A, δ) is approximately δ−2. This suggests the idea of deﬁning
the dimension of an arbitrary set as the number d for which N(A, δ) ∼δ−d. The
limit
lim
δ→0
log N(A, δ)
log(δ−1)
,
if it exists, is called Minkowski dimension, dimM(A).

66
A. Gamburd
The basic result proved by Davies [27] in 1971 is that β(2) = 2. The same
year C. Fefferman [37] discovered the intimate connection between the Kakeya
problem and the multiplier problem for the ball, proving that for d ≥2 the map
f →

|ξ|≤1 ˆf (ξ)eixξdξ deﬁnes only for p = 2 a bounded operator on Lp(Rd). This
seminal result made apparent the fundamental connection between Kakeya-type
questions and the higher-dimensional Fourier analysis, in particular in the theory
of oscillatory integral operators.9
In the 1980s, Drury [31] showed that
β(n) ≥n + 1
2
(2)
(see also Christ et al. [25]). The argument consists of intersecting the line segment
Lξ ⊂E, Lξ parallel to ξ in Sd−1 by a pair of parallel hyperplanes H1, H2 in Rd
and observing that for all δ > 0
1
δ
d−1
≲N(H1 ∩E, δ)N(H2 ∩E, δ).
(3)
The estimate (2) was ﬁrst improved by Bourgain in 1991, in the paper eponymous
with the title of this subsection [8], to n+1
2 +εn with εn given by a recursive argument
(for n = 3, this yields bound 7
3) by using a “bush” argument. A more efﬁcient
geometric argument, using “hairbrushes,” was given several years later by T. Wolff,
leading to
dimH(E) ≥n
2 + 1.
(4)
The space constraints prevent me from going into the details of these arguments;
referring the reader to beautiful surveys by Izabella Łaba [55], Terence Tao [89],
and Thomas Wolff [95], I will restrict myself to two remarks.
The ﬁrst remark is that these developments made apparent the connection
between Kakeya-type problems and results in combinatorial geometry, such as the
Szemerédi-Trotter Theorem [88], which will be brieﬂy discussed in Sect. 3.2.
9 A recent triumph in this area is the resolution of the Vinogradov’s conjecture by Bourgain,
Demeter, and Guth [15], establishing near-optimal bounds on the mean values of exponential sums
such as
N

n=1
e2πi(α1n+α2n2+...αknk)
as one varies the frequencies α1, . . . αk; these are of fundamental importance in analytic number
theory.

Bourgain’s Discretized Sum-Product Theorem
67
The second remark is that Bourgain’s interest in Kakeya problem was stimulated
by his discovery [9] of it being implied by the following version of Montgomery’s
conjecture10 for Dirichlet polynomials:
Conjecture 2 Let S(s) = N
n=1 anns with |an| ≤1 and F be a set of 1-separated
reals in the interval [0, T ], T > N. Then

t∈F
|S(it)|2 ≪T ε(N + |F|)N( max
1≤n≤N |an|2).
(6)
Regrettably skipping thus over many important and pertinent developments that
took place in the last decade of the past century, let us note, looking forward,
that in its closing year (1999), Bourgain unveiled the connection between Kakeya
problem and one of the most consequential and far-reaching results in arithmetic
combinatorics, obtained by Gowers in his groundbreaking A New Proof of Sze-
merédi’s Theorem for Arithmetic Progressions of Length Four [40]. This result,
Balog-Szemerédi Gowers Lemma, will play a crucial role in many a subsequent
development, of which some are discussed in this essay.
2.3
Balog-Szemerédi-Gowers Lemma
Either this universe is a mere confused mass, and an intricate context of things, which shall
in time be scattered and dispersed again; or it is a union consisting of order and administered
by Providence.
Marcus Aurelius “Meditations” 6, VIII
Complete disorder is impossible.
T.S. Motzkin
The Balog-Szemerédi-Gowers lemma is ostensibly a statement about group
structure, but the main tool in its proof is a remarkable (and remarkably useful)
graph-theoretic result best viewed in the context of Ramsey theory. Ramsey theory is
a systematic study of the following general phenomenon. Surprisingly often, a large
structure of a certain kind has to contain a fairly large highly organized substructure,
even if the structure itself is completely arbitrary and apparently chaotic. It can be
viewed as a vast generalization of the pigeonhole principle, which states that if a
set X of n objects is colored with S colors, then there must be a subset of X of
10 One of the consequences of Montgomery’s conjecture is the density hypothesis for the Riemann
zeta function
N(σ, T ) ≪T 2(1−σ)+ε.
(5)
Here 1
2 < σ < 1, T > 0 and N(σ, T ) is the number of zeros ρ = β + iγ of ζ(s) satisfying
β > σ , |γ | < T .

68
A. Gamburd
size at least n
s that uses just one color. Such a subset is called monochromatic. The
situation becomes more interesting if the set X has some additional structure. It
then becomes natural to ask for a monochromatic subset that keeps some of the
structure X. However it also becomes much less obvious if such a subset exists.
Frank Plumpton Ramsey in 1930 [76] took as his set X the set of all the edges in a
complete graph and the monochromatic subset he obtained consisted of all the edges
of some complete graph. One version of his theorem is as follows. For every positive
integer k, there is a positive integer N such that if the edges of the complete graph are
all colored either red or blue, then there must be k vertices such that all edges joining
them have the same color. That is, a sufﬁciently large complete graph colored with
two colors contains a complete subgraph of size k which is monochromatic. The
least integer N that works is known as R(k) and is known that
2
k
2 ≤R(k) ≤22k.
(7)
There were several results in Ramsey theory predating Ramsey’s theorem; in
particular, van der Waerden [93] proved that if you color the integers with some
ﬁnite number r of colors, there must be some color that contains arithmetic
progressions of every length. In 1935 Erdös and Turán conjectured that this holds
for “the most popular” color class. More precisely, they conjectured that for any
positive integer k and any real number ε > 0, there is a positive integer n0 such that
if n > n0, any set of at least εn positive integers between 1 and n contains k-term
arithmetic progression. This conjecture was proved by Szemerédi in 1975 using,
among other things, his celebrated regularity lemma [87], which can be very roughly
described as a statement that even the most “chaotic” systems can be decomposed
into a “relatively” small number of “approximately regular” subsystems.
Using the Szemerédi regularity lemma, the following result was established
by Balog and Szemerédi in 1994 [2], resulting in tower-like exponential-type
dependence (cf. (7)). Gowers achievement of the polynomial bounds KO(1) in the
statement below is crucial in the ensuing applications.
Theorem 3 (Balog-Szemerédi-Gowers Lemma) Let G(A, B, E) be a ﬁnite bipar-
tite graph, that is, a graph whose vertices can be partitioned into two disjoint
sets, with |E| ≥
|A||B|
K
. Then there exist subsets A′ ⊂A and B′ ⊂B with
|A′| ≫K−O(1)|A| and |B′| ≫K−O(1)|B| such that for every a ∈A and b ∈B, a
and b are joined by ≫K−O(1)|A|B| paths of length three.
The fact that the following corollary is valid for non-commutative groups was
established by Tao [90].
Corollary 4 Let A, B be ﬁnite nonempty subsets of a group G and suppose
∥1A ⋆1B∥l2(G) ≥|A|
3
4 |B|
3
4
K
(8)

Bourgain’s Discretized Sum-Product Theorem
69
for some11 K ≥1 . Then there exist subsets A′ ⊂A and B′ ⊂B with |A′| ≫
K−O(1)|A| and |B′| ≫K−O(1)|B| with |A′ ·B′| ≪KO(1)|A||B| and |A′ ·(A′)1| ≪
KO(1)|A|.
The quantity ∥1A ⋆1B∥l2(G) counts the number of solutions to the equation a1 ·
b1 = a2 · b2 with a1, a2 ∈A, and b1, b2 ∈B (multiplicative or additive quadruples)
and is also known as the multiplicative energy of A and B.
2.4
On the Dimension of Kakeya Sets and Related Maximal
Inequalities
The main result in this 1999 paper of Bourgain [10] is the following improvement
of (4) for large n
dimH(E) ≥1
25(13n + 12).
(9)
The heart of the argument consists in applying Balog-Szemerédi-Gowers lemma
to show that Kakeya set E satisﬁes Nδ ≥δ−α(n−1) with α > 1
2 as follows. Let L be
the lattice δZn ⊂Rn, and for each of the segments {x +te : |t| ≤1
2} with e ∈Sn−1
in the deﬁnition of Kakeya set. Let x+ and x−be the elements of L closest to x + 1
2e
and x −1
2e, respectively. Let A be the set whose elements are the various x+ and x−
and deﬁne G ⊂A × A to be the set of pairs (x+, x−); then let S be the set of sums
x+ + x−. Clearly |A| ≲Nδ(E), and in addition |S| ≲Nδ(E), since the midpoint
1
2(x+ + x−) is within Cδ of x ∈E. But it is equally clear that point of Pn−1 is
within Cδ of some difference x+ −x−. Thus δ−(n−1) ≲Nδ(E)2−ε, as claimed.
This paper marked the ﬁrst application in Harmonic Analysis of Additive
Combinatorics.12
11 Here ⋆denotes the convolution operation: f ⋆g =

G f (y)g(y−1x)dμ(y). Note that by Young’s
inequality, ∥1A ⋆1B∥l2(G) ≤|A|
3
4 |B|
3
4 .
12 “Bourgain’s argument was, to this author’s knowledge, the ﬁrst application of additive number
theory to Euclidean harmonic analysis. It was signiﬁcant, not only because it improved Kakeya
bounds, but perhaps even more so because it introduced many harmonic analysts to additive
number theory, including Tao, who contributed so much to the subject later on, and jump-started
interaction and communication between the two communities. The Green-Tao (Fig. 3) theorem and
many other developments might never have happened were it not for Bourgain’s brilliant leap of
thought in 1998.” Izabella Łaba, BAMS, 2008 [55].

70
A. Gamburd
Fig. 3 Jean Bourgain and Ben Green
3
Sum-Product Phenomena and the Labyrinth of the
Continuum
Additive combinatorics grew out of the classical additive number theory. Though
few isolated results existed before, the turning point was Schnirelmann’s approach
[80] to Goldbach’s conjecture asserting that any integer greater than three can be
expressed as a sum of two or three primes, depending on parity. Schnirelmann
proved the weaker result that there is a bound k so that every integer is a sum of at
most k primes, or, in other words, the primes form an additive basis. Schnirelmann’s
approach, notwithstanding it being soon superseded for the Goldbach’s problem
by Vinogradov’s method of exponential sums, kindled the interest in addition of
general sets; a result of fundamental and lasting importance in this subject is due to
Gregory Abelevich Freiman [38], a student of Gelfond, who was a close friend and
collaborator of Schnirelmann.13
3.1
Freiman’s Theorem and Ruzsa’s Calculus
Freiman’s Theorem gives characterization of sets with small doubling in terms
of generalized arithmetic progression. A d-dimensional generalized arithmetic
progression (GAP) is a set P of the form
{a + x1qq + · · · + xdqd : 0 ≤xi ≤li},
(10)
13 Schnirelmann committed suicide on 24 September 1938, fearing imminent persecution by
NKVD (subsequently KGB; currently FSB).

Bourgain’s Discretized Sum-Product Theorem
71
where l1, . . . ld are positive integers. We call d the dimension of P; by the size of
P, we mean ∥P∥= d
i=1(li + 1), which is the same as the number of elements if
all sums in (10) are distinct (in which case we say that P is proper). Note that
|P + P| < 2d|P| ≤2d∥P∥.
(11)
Theorem 5 (Freiman’s Theorem) If A ⊂Z, |A| = n, |A + A| ≤αn, then A is
contained in a generalized arithmetic progression of dimension at most d(α) and
size at most s(α)n.
The quantitative bound in Freiman’s theorem, used by Bourgain in his ﬁrst proof of
(1), is due to Mei-Chu Chang (Fig. 4) [24]: d < α (the best possible14) and s ≤eαc.
Fig. 4 Jean Bourgain and Mei-Chu Chang
14 It is known that a bound for s must be ≫2α; very likely the proper order is ecα. A beautiful
survey by T. Sanders in BAMS [82] covers the recent developments.

72
A. Gamburd
Freiman’s proof was considerably simpliﬁed by Ruzsa [77] (building on the
earlier work of Plünnecke [74]). One of the fundamental notions introduced by
Ruzsa is that of Ruzsa distance between two sets X and Y in a group, ρ(X, Y) =
log |X−Y|
√|X||Y|, allowing us to rewrite an elementary inequality for A, Y, Z ﬁnite sets in
a group (which, as observed by Tao, is not necessarily commutative) |A||Y −Z| ≤
|A −Y||A −Z| as
ρ(Y, Z) ≤ρ(Y, A) + ρ(A, Z),
(12)
a triangle inequality-like property; ρ is also symmetric (but ρ(X, X) is typically
positive). The following result of Plünnecke and Ruzsa was used in Bourgain’s 2+
proof in place of Freiman’s theorem.
Theorem 6 Let A, B be ﬁnite sets in a group and write |A| = m, |A + B| = αm.
For arbitrary nonnegative integers k, l we have
|kB −lB| ≤αk+lm.
3.2
Sum-Product Phenomena and Incidence Geometry
Freiman’s theorem is an example of an “inverse” result: knowing that the set has
small doubling, we can characterize its structure in terms of GAPs. One of the
basic “direct” results, applicable to arbitrary sets, is the “sum-product phenomenon,”
whose elementary and elemental nature might be described as follows. When
studying addition and multiplication tables for numbers from one to nine, one might
notice that there are many more numbers in the multiplication table. This basically
has to do with the fact that the numbers from one to nine form an arithmetic
progression. If you take a set forming an arithmetic progression (or a subset of it)
and add it to itself, it will not grow much; if you take a set forming a geometric
progression (or a subset of it) and multiply it by itself, it will also not grow
much. However a subset of integers cannot be both an arithmetic and a geometric
progression, and so it will grow either when multiplied or added with itself.
In 1983 Erdös and Szemerédi proved [35] that for any ﬁnite set of integers A
|A + A| + |A · A| ≥C|A|1+ε
(13)
for absolute constants C, ε and conjectured that in fact for any ε > 0 there is Cε
such that
|A + A| + |A · A| ≥Cε|A|2−ε.
(14)
We will give a beautiful proof (due to Elekes [33] and Székeley [86]) of (14)
with ε =
3
4 using Szemerédi-Trotter theorem in incidence geometry, mentioned

Bourgain’s Discretized Sum-Product Theorem
73
in Sect. 2.2, which in turn will follow from crossing number inequality obtained,
ultimately, from a purely topological result: Euler’s formula.
Crossing Number Inequality
During World War II, Turán worked as forced labor, moving wagons ﬁlled with
bricks from kilns to storage places. According to his recollections, it was not a very
tough job, except that they had to push much harder at the crossings. This led him to
consider the following problem: for a non-planar graph G, ﬁnd a drawing for which
the number of crossings is minimal. The minimal number of crossings in a drawing
is called crossing number of a graph Cr(G). Another practical application of this
problem appeared in the early 1980s, when it turned out that the chip area required
for the realization of an electrical circuit (VLSI layout) is closely related to crossing
number of underlying graph. The basic result, due to Leighton [57], is as follows:
Cr(G) ≥1
64
|E|3
|V |2 −|V |.
(15)
Here |V | and E denote, respectively, the number of vertices and edges in the graph.
The proof starts by observing that Euler’s formula implies that if Cr(G) = 0, then
|V |−|E|+|F| = 2. This readily implies that crossing number of any graph satisﬁes
Cr(G) ≥|E| −3|V | + 6.
The proof is concluded by considering a planar embedding of G with least crossing
number and choosing each vertex of G at random with probability p. Taking the
expectations of the relevant quantities gives
p4Cr(G) ≥p2|E| −3p|V | + 6;
letting p = 4|E|
|V | yields the desired inequality (15).
Szemerédi-Trotter Theorem
This is an assertion that given n points and m lines in the plane the number of
incidences
I(m, n) ≪m
2
3 n
2
3 + m + n,
(16)
(and this is sharp). Consider a set P of m points and a set L of n lines in the plane,
realizing the maximal number of incidences I(m, n). Deﬁne a drawing of a graph
G(V, E) in the plane: each point p ∈P becomes a vertex of G, and two points

74
A. Gamburd
p, q ∈P are connected by an edge if they lie on a common line l ∈L next to one
another. If a line l ∈L contains k ≥1 points of P, then it contributes k −1 edges to
P and hence I(m, n) = |E| + n. Since the edges are parts of the lines, at most
n
2

pairs may cross: Cr(G) ≤
n
2

. By the crossing number theorem, Cr(G) ≥1
64
|E|3|
m2 −
n, so
1
64
|E|3|
m2 −n ≤Cr(G) ≤
n
2

, and a calculation gives |E| = O(m
2
3 n
2
3 + m),
proving (16).
Proof of Sum-Product Inequality
We are ready to prove (13) with ε = 1
4. Let P = {(a, b)|a ∈A + A, b ∈A · A};
P is a subset of the plane and has cardinality |A + A||A · A|. Consider the set of
lines of the form {(x, y) : y = a(x −b)} where a, b are elements of A. Clearly
L has |A|2 elements. Moreover, each such line contains at least |A| points in P,
namely, the points (b + c, ac) with c ∈P. Thus I(P, L) ≥|A|3. Applying the
Szemerédi-Trotter theorem and elementary linear algebra, we conclude
|A + A| + |A · A| = (|A|
5
4 ).
(17)
Before turning to the discussion of Erdös-Volkmann and Katz-Tao discretized
ring conjectures, let us note that if the set A is δ-separated, by carefully adapting the
preceding proofs, we obtain an inequality of the form
N(A + A, δ2) + N(A · A, δ2) > N(A, δ)1+τ,
(18)
to be contrasted with Bourgain’s result (1).
3.3
On the Erdös-Volkmann and Katz-Tao Discretized Ring
Conjectures
Erdös-Volkmann Problem
With Volkmann we proved that for every 0 ≤α ≤1 there is a group of real numbers of
dimH = α. All our efforts so far failed in proving the existence of ring or ﬁeld of Hausdorff
dimension α.
P. Erdös,15 1979
15 Erdös expressed a similar sentiment in a letter to K. Falconer (reproduced with his kind
permission (Fig. 5)). We remark that in 2016 P. Mauldin showed [69] that assuming continuum
hypothesis, there exists subrings (and even subﬁelds) of R of arbitrary Hausdorff dimension, which
are not however Borel subsets.

Bourgain’s Discretized Sum-Product Theorem
75
Fig. 5 From a letter from P. Erdös to K. Falconer dated 18 June 1983
In 1966 Erdös and Volkmann proved [34] that for each α in (0, 1), there is an
additive Borel subgroup of the reals with Hausdorff dimension α. Several proofs
of this fact have now been given, all involving some sets of numbers which are
well approximated by rationals. It is a well-known result that there exist inﬁnitely
many rational approximations m
n to any real number r with an error less than n−2.
If α > 2, let E be the set of real numbers r that can be “well approximated” by
rational numbers in the sense that there are inﬁnitely many rational numbers m
n with
|r−m
n | <
1
nα . Jarník proved16 in 1931 that dimH(E) = 2
α . Falconer’s construction17
of an additive Borel subset with Hausdorff dimension α builds on Jarník’s Theorem:
take nk a sequence of positive integers which increases sufﬁciently rapidly, for
example, nk+1 > nk
k. Deﬁne the set Gα to consist of those real numbers for which
there exists M such for any k there is an integer p such that |x −p
nk | < Mn
−1
α
k
.
Clearly Gα is an additive subgroup, and it is not difﬁcult to show, using Jarník’s
theorem, that its Hausdorff dimension is equal to α.
Katz-Tao Discretized Ring Conjecture
It was shown by Falconer [36] that a Borel subring R of R cannot have Hausdorff
dimension exceeding 1
2 (by considerations of the distance set {|a −b|; a, b, ∈R ×
R} ⊂
√
R).
16 In fact, Jarník also proved [47] a two-dimensional version of this theorem, yielding a set in R2
which, as was shown by Kaufmann [52], has the maximal possible set of exceptional projections
discussed in Sect. 2.1.
17 Erdös and Volkmann based their construction of Gα on the following beautiful characterization
of (ir)rationals given by Cantor(1869): let x = [x] + ∞
k=2
ak(x)
k!
with the integers ak(x) satisfying
0 ≤ak(x) ≤k −1. Then x is irrational iff ak(x) > 0 for inﬁnitely many k and ak(x) ≤k −1
for inﬁnitely many k. For ﬁxed α their Gα consists of those x which satisfy ak(x) ≤κ(x)kα or
ak(x) ≥k −κ(x)kα for all k ≥k0(x) and κ(x) positive constant.

76
A. Gamburd
In the 2001 paper “Some connections between Falconer’s distance set conjecture
and sets of Furstenberg type” [50], motivated, in part, by connections with the
Kakeya problem, Nets Katz and Terence Tao formulated a quantitative version of
Erdös-Volkmann problem (discretized ring conjecture). A bounded subset A of R is
called a (δ, σ)1 set provided A is a union of δ-intervals and satisﬁes
|A ∩I| < (r
δ )1−σδ1−ε
(19)
whenever I ⊂R is an arbitrary interval of size δ ≤r ≤1 (0 < ε ≪1 in (19) is a
small parameter).
Katz and Tao conjectured that if A is a (δ, 1
2)1 set satisfying |A| > δ
1
2 +ε, then
necessarily |A + A| + |A · A| > δ
1
2 −c, with c > 0 an absolute constant. This was
proved by Bourgain in the paper eponymous with the title of this section. More
generally, he proved the following result (which is the precise formulation of (1)).
Theorem 7 If A is a (δ, σ)1 set, 0 < σ < 1, satisfying |A| > δσ+ε, then
necessarily |A + A| + |A · A| > δσ−c, with an absolute constant c = c(σ) > 0.
Labyrinth of the Continuum
The title of this subsection is described by Bourgain in the introduction to his paper
[11] in the sentence underlined below.
The statement in Theorem 7 is thus a purely combinatorial fact. We proceed by contradic-
tion, assuming
|A + A| + |A · A| < δσ−c.
(20)
The initial stages of the argument use only the additive information, thus |A+A| < δσ−c. It
is processed through multi-scale construction, based on Ruzsa’s sumset estimates, and, most
importantly, quantitative versions of Freiman’s famous theorem on ﬁnite sets of reals with
small doubling set. ...The ﬁnal product is a subset C of A with a tree structure which
exhibits a “multi-scale porosity property.” At this point, we start using multiplicative
structure and prove the existence of elements x1, x2 ∈A−A such that |x1C+x2C| > δσ−κ.
The key difﬁculty comes from the fact that Freiman’s theorem describes the
structure of sets of small doubling |A+A| < C|A| with a ﬁxed constant C, whereas
the assumption (20) deals with the situation where the constant C grows with A, as
A itself increases in size: the heart of Bourgain’s argument is the structure theorem
characterizing sets satisfying (20). The additive subgroups Gα described in Sect. 3.3
satisfy this assumption; let us look at their structure more closely, concentrating for
concreteness on the case α = 1
2 and giving an alternative description of it as a subset
of the binary tree representing the continuum (Fig. 6).
Let Pn = {0, . . . , n −1}, and let

Bourgain’s Discretized Sum-Product Theorem
77
Fig. 6 Labyrinth of the
continuum
An =
n

i=1
1
2i2 P2i =
 n

i=1
ai2−i2 : 1 ≤ai ≤2i
'
.
It is easy to see that the distance between distinct points x, x′ ⊂An is at least
1
4n2 ,
such that x has a unique representation as a sum n
i=1 ai4−i2 with 1 ≤ai ≤2i.
Each term of the sum n
i=1 ai2−i2 determines a distinct block of binary digits; it is
seen to be GAP (deﬁned in Sect. 3.1) as the image of P2 ×P4 · · ·×P2n →An given
by (x1, . . . xn) →n
i=1 xi2−i2. The rank of this GAP is n so |An + An| ≤2n|An|
and |An| = n
i=1 |P2i| = 2
n(n+1)
2
. So we have |An + An| = |An|1+o(1).
Now we pass to the limit, akin to the way used in constructing the Cantor set: at
stage n, we have a collection of 2
n(n+1)
2
intervals of length 2−n2; from each of these
intervals, we keep 2n+1 subintervals of length 2−(n+1)2 separated by gaps of length
2−n2−(n+1). It is easy to see that the resulting fractal set coincides with G 1
2 .
A full binary tree of height h can be identiﬁed with a set of 0, 1 valued sequences
of length ≤h. Let us say that the tree T has full branching for m generations at the
vertex σ if σ has all 2m possible descendants m generations below it, that is, ση ∈T
for all η ∈{0, 1}m. The tree is fully concentrated for m generations at σ if σ has a

78
A. Gamburd
single descendant m generations down, that is, there is a unique η ∈{0, 1}m with
ση ∈T . The sets An are represented by trees Tn of height n2. For every i < n, every
node at level i2 has full branching for i generations and every node at level i2 + i is
fully concentrated for i + 1 generations. Consequently, for every j ∈[i2, i2 + 1),
every node at level j has full branching for one generation; for j ∈[i2 +i, (i +1)2),
every node at level j is fully concentrated for one generation. Moreover, it is not
difﬁcult to see that for every m, we can partition the levels 0, 1, . . . , n2 into three
sets U, V, W such that:
a. For every i ∈U, every level i node has full branching for m generations.
b. For every j ∈V , every level j node is fully concentrated for m generations.
c. The set W constitutes a negligible fraction of the levels: |W|
n2 = o(1) as n →∞
(with m ﬁxed).
In the above description, U = 
i>m[i2, i2 + i −m), V = 
i>m[i2 + 1, (i +
1)2 −m), and W is the set of remaining levels.
Bourgain’s structure theorem for sets satisfying (20) can now be informally stated
as follows. Suppose |A+A| ∼|A|1+τ. If b ≥2 is a base (say b = 2), we can identify
A with a subset of the full b-ary tree of height m: the vertices at distance j from the
root are the intervals [kbm−j, (k + 1)bm−j) which intersect A. Given ε there are
τ > 0 and b ≥2 (which can be taken arbitrarily large) such that the following
holds if m is large enough. Suppose A ⊂{0, 1, . . . , bm−1} and |A + A| ≤bτm|A|
(which is the case if |A + A| ∼|A|1+τ). Then there is a subset A′ of A satisfying
the following properties:
1. |A′| ≥bεm|A|, that is to say A′ is a fairly dense subset of A.
2. The b-ary tree associated with A′ is regularized in the sense that any vertex at
level j has the same number Nj of children
3. Either Nj = 1 or Nj ≥b1−ε, so at each level the tree has either no branching or
close to full branching uniformly over all the vertices at that level.
From Theorem 7 Bourgain deduced that the answer to Erdös-Volkmann problem
was negative, which was proved independently at about the same time by Edgar and
Miller [32] who gave a simple and elegant proof using crucially Marstrand’s pro-
jection theorem 1. The essential idea of their argument served as the starting point
and inspiration for the celebrated paper by Bourgain, Katz, and Tao establishing the
sum-product theorem in Fp.
3.4
A Sum-Product Estimate in Finite Fields and Applications
The main result of this paper [19] is the following:
Theorem 8 Let A be a subset of Fp such that for some δ > 0
pδ < |A| < p1−δ.
(21)

Bourgain’s Discretized Sum-Product Theorem
79
Fig. 7 Jean Bourgain and Terence Tao
Then
|A + A| + |A · A| ≥c(δ)|A|1+ε
(22)
for some ε = ε(δ) > 0.
Here is Terence Tao’s (Fig. 7) recollection:
Regarding the prehistory of my paper with Jean Bourgain and Nets Katz, it all started
with a question of Tom Wolff back in 2000, shortly before his unfortunate death. Tom
had formulated the ﬁnite ﬁeld version of the Kakeya conjecture (now solved by Dvir), and
had observed that there appeared to be a connection between that conjecture (at least in
the 3D case) and what is now the sum-product theorem. (Roughly speaking, if the sum-
product phenomenon failed, then one could construct ‘Heisenberg group-like’ examples
that almost behaved like Kakeya sets.) So he posed the question to me (as a private
communication) as to whether the sum-product phenomenon was true. Nets and I chewed
on this problem for a while, and found connections to some other problems (the Falconer
distance problem, and the Szemeredi-Trotter theorem, over ﬁnite ﬁelds), but couldn’t settle
things one way or another. We then turned to Euclidean analogues, and formulated the
discretized ring conjecture and showed that this was equivalent to a non-trivial improvement
on the Falconer distance conjecture and on a conjecture of Wolff relating to some sets
studied by Furstenberg.
After chasing some dead ends on both the ﬁnite ﬁeld sum-product problem and the
discretized ring problem, we gave both problems to Jean, noting that the sum-product
problem would likely have applications to various ﬁnite ﬁeld incidence geometry questions,
including Kakeya in Fp3. Jean managed to solve the discretized ring problem using some
multi-scale methods, as well as some advanced Freiman theorem type technology based on

80
A. Gamburd
earlier work of Jean and Mei-Chu Chang. About the same time, Edgar and Miller solved
the qualitative version of the discretized ring problem (i.e. the Erdos ring conjecture).
This left the ﬁnite ﬁeld sum-product problem. All the methods in our collective
toolboxes were insensitive to the presence of subﬁelds (except perhaps for Freiman’s
theorem, but the bounds were (and still are) too weak to get the polynomial expansion;
the multi-scale ampliﬁcation trick that worked in the discretized ring conjecture was
unavailable here) and so were insufﬁcient to solve the problem. We knew that it would
sufﬁce to show that some polynomial combination of A with itself exhibited expansion, but
we were all stuck on how to do this for about a year, until Jean realized that the Edgar-
Miller argument (based on the linear algebra dichotomy between having a maximally large
span, and having a collision between generators) could be adapted for this purpose. (I still
remember vividly the two-page fax from Jean conveying this point. After this breakthrough
the paper got ﬁnished up quite rapidly. Of course nowadays there are many simple proofs
and strengthenings of this theorem, but it was certainly a very psychologically imposing
problem for us before we found the solution.
In 2006 Bourgain, Glibichuk, and Konyagin [18] proved (22) under the weaker
assumption that |A| < p1−δ and, combining this result with Balog-Szemerédi-
Gowers lemma, made remarkable progress towards the Montgomery-Vaughan-
Wooley conjecture. This asserts that multiplicative subgroups of Fp∗have “neg-
ligible additive structure” as soon as
|H|
log p →∞. This was established for H
satisfying |H| ≥p
1
4 +δ by Konyagin in 2002; Bourgain, Glibichuk, and Konyagin
proved that the result holds as soon as |H| > pε for any ε. Subsequently, Bourgain
reﬁned and extended this approach [12] to obtain hitherto untouchable estimates
for exponential sums pertaining to Difﬁe-Hellman key exchange [13], a result of
fundamental signiﬁcance in cryptographic applications.
4
Discrete and Continuous Variations on the Expanding
Theme
4.1
Bemerkung über den Inhalt von Punktmengen
The types of creatures on the earth are countless, and on an individual level their self-
preservation instinct as well as longing for procreation is always unlimited; however the
space on which this entire life process plays itself out is limited. It is the surface area of a
precisely measured sphere.
Hitlers Zweites Buch, 1928
It is a pity the demented housepainter was not briefed about the Hausdorff-
Banach-Tarski constructive solution of Lebensraum problem.18 Building on Haus-
18 When, as part of the “Final Solution,” Hausdorff, his wife Charlotte, and a sister of hers were
ordered to leave their house for local internment camp in January 1942, they opted for suicide.
During the night of July 3, 1941, 40 distinguished representatives of Lvov intelligentsia, including
S. Ruziewicz, perished at the hands of the S. S. “Nachtigall” battalion. Banach was saved by Rudolf
Weigel, the inventor of typhus vaccine, who employed him as a feeder of lice.

Bourgain’s Discretized Sum-Product Theorem
81
Fig. 8 Banach-Tarski hedgefund
dorff’s 1914 construction [44], detailed below, Banach and Tarski, in 1924, proved
[4] that there is a way of decomposing a three-dimensional ball (“precisely measured
sphere”) into a ﬁnite number of disjoint pieces and then reassembling the pieces to
form two balls of the same radius, where “reassembling” means that the pieces are
translated and rotated and that they end up still disjoint.
The construction, perhaps one of the most strikingly paradoxical in Mathematics
(Fig. 8), has its origins in the question posed by Lebesgue in 1904, in the ﬁrst
textbook on integration bearing his name [56]. One of the properties of his integral
is the monotone convergence theorem (MCT); is this property really fundamental
or follows from more familiar integral axioms? Now MCT is essentially equivalent
to countable additivity so the question is concerned with the existence of a positive,
ﬁnitely (but not countably) additive measure on the reals assigning measure one to
the unit interval.
In more detail, the problem is to assign a non-negative real number f (A) to each
bounded subset A ∈Rn in such a way that:
(1) f (E) = 1 if E is the closed unit cube in Rn
(2) f (A) = f (B) if A and B are congruent
(3) f (A ∪B) = f (A) + f (B) if A and B are disjoint
(4) f (A1 ∪A2 ∪. . . ) = f (A1) + f (A2) + . . . if A1, A2, . . . is any denumerable
sequence of mutually disjoint sets whose union is bounded
The congruence condition in 4.1 is as follows: A and B are congruent if there
exists an element g in the Euclidean group of distance preserving transformations
in Rn such that g(A) = g(B). The problem of existence of such an f is the σ-

82
A. Gamburd
additive measure problem; the problem of existence of f verifying only the ﬁrst
three properties is the ﬁnitely additive measure problem.
Lebesgue had left the countably additive measure problem in Rn unresolved; his
construction had proved the existence of f (A) for Lebesgue-measurable bounded
subsets and had left the existence of non-measurable subsets as an open question.
This was settled by Vitali on 1905 [92], whose construction is a forerunner of the
Hausdorff-Banach-Tarski. Let lθ be a line segment in R2 given by lθ = {(r, θ) :
0 ≤r ≤1} in polar coordinates. Consider 
θ lθ = D′ a unit disc with the origin
removed. The line segments lθ and lφ belong to the same equivalence class if θ −φ
is a rational multiple of π. Consider a set E that is a union of a set of lθ containing
exactly one representative from each equivalence class. Rationals are countable:
Q ∩[0, 1] = x1, x2, . . . . Write En = {lθ+2πxn : lθ ∈E}. Then each En is obtained
from E by rotation around the origin (by angle 2πxn); the sets En are disjoint (since
E contains representative from each equivalence class), 
n En = D′. Now take D′
and split it into the set F consisting of the union of the sets E2n and the set G
consisting of the sets E2n+1. Each E2n can be rotated to En, and the union of the
En gives us D′. Similarly, each E2n+1 can be rotated to En, and the union of the En
gives us D′ again. Thus the punctured unit disc can be split into a countable set of
disjoint pieces (all obtained by rotation of one particular set) and translated to form
disjoint sets whose union is two copies of D′.19
Hausdorff begins his 1914 paper Bemerkung über den Inhalt von Punktmengen
[44]by using the subgroup Gδ = {nδ , n ∈Z} (where δ is a ﬁxed irrational number)
to show that the σ-additive problem in Rn has no solution for any n ≥1. Both
Vitali and Hausdorff use a denumerably dense subgroup of the additive group (in
Hausdorff’s case the dense group is G = Gδ + Z).
He then proceeds to show that the ﬁnitely additive measure problem in Rn has
no solution if n ≥3 by reducing the problem to the unit sphere K = S2 in R3 and
then producing the so-called Hausdorff paradoxical decomposition
K = A ∪B ∪C ∪Q
(23)
where A, B, C, Q are four disjoint subsets of K, Q being denumerable and A ∼
B ∼C ∼B ∪C, the congruence here being under the group of rotations SO(3).
A decomposition (23) excludes the possibility of having an SO(3) invariant
ﬁnitely additive positive measure set function deﬁned for all subsets of K with
f (K) > 0: indeed for such an f , f (Q) must be zero and f (A) = f (B) =
f (C) = f (B ∪C) = f (B) + f (C), whence all of these numbers are zero, which
is impossible since 0 < f (K) = f (A) + f (B) + f (C).
The decomposition (23) is obtained by the consideration of a denumerable
subgroup G = G(θ, φ) of SO(3) generated by two rotations θ, φ such that
θ2 = 1 , φ3 = 1, 1 being identity map, and such that θ, φ satisfy no other nontrivial
19 Vitali’s construction makes use of the axiom of choice (because we chose one representative
from each equivalence class), and the same is true of the Banach-Tarski construction.

Bourgain’s Discretized Sum-Product Theorem
83
relations. As observed by von Neumann,20 the group G(θ, φ) is isomorphic to the
free product of Z2 and Z3 and must necessarily contain F2, the free group on two
generators
This left open the ﬁnitely additive problem in R1 and R2; Banach begins his 1923
paper21 (giving the title to the next subsection) by showing that in these spaces the
ﬁnitely additive measure problem does have inﬁnitely many solutions.
4.2
Sur le problème de la mesure
Banach was not a mathematician of ﬁnesse, he was a mathematician of power. Inside
he combined a spark of genius with that amazing inner imperative, which incessantly
whispered to him, as in Verlaine’s verse, ‘Il n’y a que la glorie ardente du mètier’ [There is
only one thing: that intense glory of the craft] – and mathematicians know well that their
craft depends on the same mystery as the craft of poets.
Hugo Steinhaus22
In this seminal paper [3], Banach considers three questions pertaining to the
invariance of ﬁnitely additive measures. First, he constructs a ﬁnitely additive,
positive, translation-invariant measure μ on the family of bounded subsets of R
such that:
(1) μ(A) < ∞for every bounded subset of R (so that μ gives rise in an obvious
way to an element μA of l∞(A)).
(2) μ[a,b](f ) =
 b
a f (x)dx for every Riemann integrable function f on an interval
[a, b].
(3) There exists a Lebesgue integrable function g on an interval [c, d] s.t.
μ[c,d](g) ̸=
 d
c g(x)dx.
20 In his seminal paper Zur allgemeinen Theorie des Masses, which introduced the notion of
amenability [72].
21 The ﬁrst equality in this paper appears just below its title: Stefan Banach (Léopol = Lwów).
“If I cared to deﬁne the single most prominent characteristic feature of Lvov school, I would
mention its interest in the foundation of various theories. What I mean by this is that if one imagines
mathematics as a tree, then the Lvov group was devoted to studying roots and trunks, perhaps even
the main boughs, with less interest in the side branches, leaves and ﬂowers.” S. Ulam (a student of
Banach and co-holder of the patent for hydrogen bomb).
22 H. Steinhaus “discovered” Banach on the park bench of Krakow Planty promenade, discussing
Lebesgue Measure with Otto Marcin Nikodym. (He viewed this as his “greatest discovery.”)
Lebesgue visited Lvov in 1938 to receive an honorary doctorate from Jan Kazimierz University
(where Steinhaus was at that time Dean of the Faculty). Upon being given a menu in Polish at the
celebratory dinner in the famous Scottish Café, Lebesgue looked at the menu for about 30 s with
utmost seriousness and said, Merci, je ne mange que des choses bien déﬁnies[Thank you, I eat only
well-deﬁned things] [83].

84
A. Gamburd
The second result, which Banach calls “le probleme large de la mesure,” is to
show that unlike the case of n ≥3, studied by Hausdorff, the ﬁnitely additive
measure problem in Rn for n = 1, 2 does have inﬁnitely many solutions.
The third question, posed by Ruziewicz in 1921, is whether Lebesgue measure
on the n-sphere is the unique ﬁnitely additive rotation invariant measure deﬁned
on Lebesgue subsets. Using Hahn-Banach theorem, Banach showed that that for
n = 1, the answer is negative, using essentially the commutativity of SO(2). He left
the case of n > 2 open.
For n > 3, the afﬁrmative answer was obtained in 1980/1981 by Margulis [65]
and Sullivan [85] who used Kazhdan’s property T [53].
In 1984 Drinfeld established [30] the afﬁrmative answer in the most difﬁcult case
of n = 2 by proving existence of an element in the group ring of SU(2) which has
a spectral gap. As proved by Sarnak (Fig. 9) [78], the afﬁrmative answer for n = 2
implies, via inductive construction, an afﬁrmative answer for n ≥2.
Drinfeld method used some sophisticated machinery from the theory of auto-
morphic representations, in particular Deligne’s solution of Ramanujan conjecture
[29]. In 1986 the explicit and optimal construction, appealing to the abovementioned
tools, was obtained by Lubotzky, Phillips, and Sarnak [59, 60], in tandem with
their celebrated construction (independently given by Margulis [66]) of Ramanujan
graphs [61].
Fig. 9 Jean Bourgain and Peter Sarnak

Bourgain’s Discretized Sum-Product Theorem
85
4.3
Ramanujan-Selberg Conjecture
In 1916 Ramanujan [75] made two deep conjectures about the coefﬁcients of
q
∞

n=1
(1 −qn)24 =
∞

n=1
τ(n)qn.
(24)
The ﬁrst was the multiplicativity of the coefﬁcients: if (m, n) = 1
τ(mn) = τ(m)τ(n);
(25)
the second was an estimate
|τ(n)| ≤d(n)n
11
2
(26)
where d(n) is the number of divisors of n. In particular,
|τ(p)| ≤p
11
2
(27)
for primes p.
The ﬁrst was proved by Mordell in 1917 [70] and marked the beginning of
Hecke’s theory of Hecke operators. The second was proved by Deligne in 1974
[29] and is one of the crowning achievements of twentieth-century mathematics.23
In his seminal 1965 paper On the estimation of Fourier coefﬁcients of modular
forms, Selberg [81] formulated an analogue of Ramanujan conjecture for non-
holomorphic or Maaß forms and showed that it is equivalent to the following
statement about the ﬁrst positive eigenvalue of the Laplacian (Selberg’s eigenvalue
conjecture24)
λ1(X(p)) ≥1
4,
(28)
where X(p) = H\(p), the quotient of the hyperbolic plane by the congruence
subgroup
(p) = {γ ∈SL2(Z) : γ ≡
1 0
0 1

mod p}.
23 “According to the author of the proof, Pierre Deligne, in order to present this proof, presupposing
everything known by a beginning graduate student in mathematics one would need about two
thousand pages of printed text. This theorem probably holds the record in modern mathematics for
the ratio of the length of its proof to the length of its statement” Y. Manin [63].
24 See the article with eponymous title by P. Sarnak in the Notices [79] for a tantalizing discussion.

86
A. Gamburd
By the variational characterization of the ﬁrst eigenvalue, we have
λ1(X(p)) =
inf

X(p) f dμ=0

X(p) |∇f |2dμ

X(p) f 2dμ .
(29)
Using Weil’s bound for Kloosterman sums (obtained as a consequence of his proof
of the Riemann hypothesis for curves), Selberg proved the following celebrated
result:
λ1(X(p)) ≥3
16.
(30)
This result can be viewed as (implicitly) giving rise to the ﬁrst family of expander
graphs.
4.4
Expanders
Expanders are highly connected sparse graphs widely used in computer science.
Clearly high connectivity is desirable in any communication network. The necessity
of sparsity is perhaps best seen in the case of the network of neurons in the brain:
since the axons have ﬁnite thickness, their total length cannot exceed the quotient
of the average volume of one’s head and the area of axon’s cross section. In fact,
this is the context in which expander graphs ﬁrst implicitly appeared in the work of
Barzdin and Kolmogorov in 1967 [54].
There are several ways of making the intuitive notions of connectivity and
sparsity precise; the simplest and most widely used is the following.
Given a subset of vertices, its boundary is the set of edges connecting the set to
its complement. The expansion of a subset is a ratio of the size of a boundary to the
size of a set. The expansion of a graph is a minimum over all expansion coefﬁcients
of its subsets. Note that the expansion coefﬁcient is strictly positive if and only if
the graph is connected.
The expansion coefﬁcient captures the notion of being highly connected; the
bigger the expansion coefﬁcient, the more highly connected is the graph. Of course
one can simply connect all the vertices, but in this case, the number of edges grows
as a square of the number of vertices. The problem of constructing expanders is
nontrivial because we put the second constraint: the graphs are to be sparse, i.e.,
the number of edges should grow linearly with the number of vertices. The simplest
way to accomplish this is to demand that the graphs be regular, that is, each vertex
has the same number of neighbors (say 3).
A family of k-regular graphs Gn,k forms a family of expanders if there is a ﬁxed
positive constant c, such that

Bourgain’s Discretized Sum-Product Theorem
87
lim inf
n→∞c(Gn,d) ≥c > 0.
(31)
The expansion coefﬁcient is a notion which is very easy to grasp, but it is
difﬁcult to compute numerically or to estimate analytically, as the number of subsets
grows exponentially with the number of vertices. The starting point of most current
work on expanders is that the expansion coefﬁcient has a spectral interpretation:25
to put it sonorously, if you hit a graph with a hammer, you can determine how
highly connected it is by listening to the bass note. In more technical terms, high
connectivity is equivalent to establishing a spectral gap for an averaging (or Laplace)
operator on the graph so that condition (31) has the following alternative expression:
lim inf
n→∞λ1((Gn,k)) ≥μ > 0,
(32)
making apparent the connection with Selberg’s celebrated 3
16 Theorem (30).
In 1973 Pinsker [73] observed that random regular graphs are expanders. In the
same year, Margulis [64] gave the ﬁrst explicit construction of expanders as Cayley
graphs26 of SL3(Fp) using Kazhdan’s property T [53].
4.5
Superstrong Approximation
The strong approximation for SLn(Z), asserting that the reduction πq modulo q is
onto, is a consequence of the Chinese remainder theorem; its extension to arithmetic
groups is far less elementary but well understood. If S is a ﬁnite symmetric
generating set of SLn(Z), strong approximation is equivalent to the assertion that
the Cayley graphs G(SLn(Z/qZ), πq(S)) are connected. The quantiﬁcation of this
statement, asserting that they are in fact highly connected, that is to say form a
family of expanders, is what we mean by superstrong approximation. The proof of
the expansion property for SL2(Z) has its roots in Selberg’s celebrated lower bound
(30). The generalization of the expansion property to G(Z) where G is a semi-
simple matrix group deﬁned over Q is also known thanks to developments towards
the general Ramanujan conjectures that have been established; this expansion
property is also referred to as property τ for congruence subgroups.
Let  be a ﬁnitely generated subgroup of GLn(Z) and let G = Zcl(). The
discussion of the previous paragraph applies if  is of ﬁnite index in G. However, if
 is thin, that is to say, of inﬁnite index in G(Z), then vol(G(R)\) = ∞, and the
25 The connection stems from the variational characterization of the ﬁrst eigenvalue, expressed in
(29).
26 Given a ﬁnite group G with a symmetric set of generators S, the Cayley graph G(G, S), is a
graph which has elements of G as vertices and which has an edge from x to y if and only if
x = σy for some σ ∈S. The Cayley graph of PSL2(F5) with respect to standard generators is a
buckyball, alluded to in the rendering of O on the conference poster (Fig. 2).

88
A. Gamburd
techniques used to prove both of these properties do not apply. It is remarkable that
under suitable natural hypothesis, strong approximation continues to hold in this thin
context, as proved by Matthews, Vasserstein, and Weisfeller in 1984 [68, 94]. That
the expansion property might continue to hold for thin groups was ﬁrst suggested
by Lubotzky and Weiss in 1993 [62]; for SL2(Z), the issue is neatly encapsulated in
the following 1-2-3 question of Lubotzky [58]. For a prime p ≥5 and i = 1, 2, 3,
let us deﬁne Si
p =
# 1 i
0 1

,
 1 0
i 1
$
. Let Gi
p = G

SL2(Z/pZ) , Si
p

, a Cayley graph
of SL2(Z/pZ) with respect to Si
p. By Selberg’s theorem, G1
p and G2
p are families
of expander graphs. However, the group ⟨
 1 3
0 1

,
 1 0
3 1

⟩has inﬁnite index and thus
does not come under the purview of Selberg’s theorem.
Following the groundbreaking work of Helfgott [45] (which builds crucially
on sum-product estimate in Fp discussed in Sect. 3.4), Bourgain and Gamburd
[16] gave a complete answer to Lubotzky’s question. The method introduced in
uniform expansion bounds for Cayley graphs of SL2(Z/pZ) and developed in
a series of papers became known as “Bourgain-Gamburd expansion machine”;
thanks to a number of major developments by many people, the general superstrong
approximation for thin groups is now known. The state of the art is summarized
in thin groups and superstrong approximation [21] which contains an expanded
version of most of the invited lectures from the eponymous MSRI ‘Hot Topics’
workshop, in the surveys by Breuillard [20] and Helfgott [46], and in the book by
Tao Expansion in Finite Simple Groups of Lie Type [91].
4.6
On the Spectral Gap for Finitely Generated Subgroups of
SU(d)
There is an Archimedean analogue of the expansion property, intimately related to
the Banach-Ruziewicz problem discussed in Sect. 4.2, deﬁned as follows.
For k ≥2, let g1, . . . , gk be a ﬁnite set of elements in G = SU(d) (d ≥2). We
associate with them an averaging (or Hecke) operator zg1,...,gk, taking L2(SU(d))
into L2(SU(d)):
zg1,...,gkf (x) =
k

j=1
(f (gjx) + f (g−1
j (x)).
We denote by supp(z) the set {g1, . . . , gk, g−1
1 , . . . , g−1
k } and by z the group
generated by supp(z). It is clear that zg1,...,gk is self-adjoint and that the constant
function is an eigenfunction of z with eigenvalue λ0(z) = 2k. Let λ1(zg1,...,gk)
denote the supremum of the eigenvalues of z on the orthogonal complement of the
constant functions in L2(SU(d)). We say that z has a spectral gap if λ1(zg1,...,gk) <
2k. It is common to, alternatively, refer to the situation described above, by asserting
that the spectral gap property holds for z.

Bourgain’s Discretized Sum-Product Theorem
89
It is easy to see that afﬁrmative solution of Banach-Ruziewicz follows from
existence of z in SU(2) having a spectral gap. In their 1986 paper, referenced at the
end of Sect. 4.2, Lubotzky, Philips and Sarnak posed a question of whether generic
in measure z in SU(2) has a spectral gap.
In 2008 Bourgain and Gamburd [17] proved (Theorem 9 below) the spectral
gap property for z in SU(2) satisfying the non-commutative diophantine property
(NDP)—in particular for free subgroups generated by elements with algebraic
entries.
The deﬁnition of non-commutative diophantine property27 introduced in the
paper “Spectra of elements in the group ring of SU(2)” by Gamburd, Jakobson,
and Sarnak [41] is as follows. We say that zg1,...,gk satisﬁes NDP if there is
D = D(g1, . . . , gk) > 0 (the diophantine constant of z) such that for any m ≥1
and a word Wm in g1, . . . , gk of length m with Wm ̸= ±e (where e denotes the
identity in SU(2)) ∥Wm ± e∥≥D−m.
Theorem 9 Let g1, . . . , gk be a set of elements in SU(2) generating a free group
and satisfying NDP (in particular, elements with algebraic entries28). Then zg1,...,gk
has a spectral gap.
Regarding the proof, let me just note that in the adaption of the “expansion
machine” to this Archimedean setting, the crucial role is played by the following
strengthening of Theorem 7.
Theorem 10 Given 0 < δ < 1 and κ > 0, there exists ε0 > 0 and ε1 > 0 such
that if δ > 0 is sufﬁciently small and A ⊂[1, 2] is a discrete set consisting of
δ-separated points, satisfying |A| = δ−σ and
|A ∩I| < ρκ|A|
(33)
whenever I is a size ρ interval with δ < ρ < δε0, then
N(A + A, δ) + N(A · A, δ) > δ−ε1|A|.
(34)
27 Recall that θ ∈R is called diophantine if there are positive constants C1, C2 s.t. for all (k, l) ∈
Z2 with k ̸= 0 we have |kθ −l| ≥c1k−c2. Equivalently, letting g = e2πθ ∈SO(2), we may
re-express this condition as follows: |gk −1| ≥c′
1k−c′
2. A classical result asserts that diophantine
numbers are generic in measure in R. Given diophantine θ1, . . . , θk and g1 = e2πθ1, . . . , gk =
e2πθk in SO(2), for any word W in g1, . . . , gk of length m, we have |Wm −1| ≥c1m−c2 for some
c1, c2. In the case of SO(3), given g1, . . . , gk generating a free subgroup, a pigeonhole argument
shows that for any m ≥1 there is always a word W in g1, g−1
1 , . . . , gk, g−1
k
of length at most m
such that ∥Wm −e∥≤10(2k −1)−m
6 , so the exponential behavior in the deﬁnition below is the
appropriate one.
28 It was established in [41] that elements with algebraic entries satisfy NDP. A major open
question is whether z generic in measure in SU(2) satisﬁes NDP. The best known result in this
direction is due to Kaloshin and Rodnianski [49]: for almost every pair (A, B) in SU(2) × SU(2),
there is a constant D > 0 s.t. for any n and any word Wm ∥Wm(A, B) ± e∥≥D−m2.

90
A. Gamburd
Theorem 9 is of importance in quantum computing [28, 43]. In the context of
quantum computation, elements of a three-dimensional rotation group are viewed as
“quantum gates,” and a set of elements generating a dense subgroup is called “com-
putationally universal” (since any element of rotation group can be approximated
by some word in the generating set to an arbitrary precision). A set of elements
is called “efﬁciently universal” if any element can be approximated by a word of
length which is logarithmic with respect to the inverse of the chosen precision (this
is the best possible). A consequence of Theorem 9 is that computationally universal
sets with algebraic entries are efﬁciently universal.
Another application is related to the theory of quasicrystals. Generalizing
Penrose’s two-dimensional aperiodic tiling, John Conway and Charles Radin [26]
constructed a self-similar (hierarchical) tiling of a three-dimensional space with
a single prototile, such that the tiles occur in an inﬁnite number of different
orientations in the tiling. The tile is a prism, which when scaled up by two is
subdivided into eight copies of itself (“daughter tiles”). If one iterates this same
subdivision procedure over and over, one creates in the limit the desired tiling of
three-dimensional space by prisms. Conway and Radin showed that the orientations
of tiles in the tiling are uniformly distributed and posed the question of how fast this
convergence to uniform distribution takes place. This question reduces to the study
of the spectral gap for the averaging operator associated with eight rotations giving
orientations of daughter tiles. A consequence of Theorem 9 is that this convergence
takes place exponentially fast.
5
Coda
The essence of mathematics lies precisely in its freedom.
Georg Cantor
Already history has in a sense ceased to exist, i.e. there is no such thing as a history of
our own times which could be universally accepted, and the exact sciences are endangered
as soon as military necessity ceases to keep people up to the mark. Hitler can say that the
Jews started the war, and if he survives, that will become ofﬁcial history. He can’t say that
two and two are ﬁve, because for the purposes of, say, ballistics they have to make four.
George Orwell, letter to N. Wilmett, 18 May 1944
Freedom is the freedom to say that two plus two make four. If that is granted, all else
follows.
George Orwell, Nineteen Eighty-Four, 1949
The difﬁculties of explaining Bourgain’s work to a broad mathematical audience
turned out to be quite substantial;29 omitting “mathematical” from the appellation
renders them nearly insurmountable.
29 “There is a continuing need to lead new generations along the thorny path which has no
shortcuts. The Ancients said there is no royal road in mathematics. But the vanguard is leaving
the great mass of pilgrims further and further behind, the procession is ever more strung out, and
the leaders are ﬁnding themselves alone far out ahead” H. Steinhaus [84].

Bourgain’s Discretized Sum-Product Theorem
91
Ian Stewart begins his admirable book The Problems of Mathematics (Oxford
University Press, 1987) with an interview with a mathematician conducted by
Seamus Android on behalf of the proverbial man in the street30 invoked in Hilbert’s
celebrated 1900 address Problems of Mathematics, referenced at the beginning of
Sect. 2.
Mathematician: It’s one of the most important discoveries of the last decade!
Android: Can you explain it in words ordinary mortals can understand?
Mathematician: Look, buster, if ordinary mortals could understand it, you would not
need mathematicians to do the job for you, right? You can’t get a feeling for what’s going
on without understanding the technical details. How can I talk about manifolds without
mentioning that the theorem only works if the manifolds are ﬁnite dimensional paracompact
Hausdorff with empty boundary?
Android: Lie a bit.
Mathematician: Oh, but I could not do that!
Android: Why not? Everybody else does.
Perhaps the most troubling omen of our times is an assault on the very basic
notions of logic and truth, in their most elemental Aristotelian sense, including, in
particular, the law of the excluded middle. Our discipline stands as a mighty fortress
against this assault, and I, for one, believe we should not be overly defensive about
our reluctance to lie a bit just because everybody else does.
***
Of all escapes from reality, mathematics is the most successful ever. It is a fantasy that
becomes all the more addictive because it works back to improve the same reality we
are trying to evade. All other escapes – sex, drugs, hobbies, whatever –are ephemeral by
comparison. The mathematician’s feeling of triumph, as he forces the world to obey the
laws his imagination has freely created, feeds on its own success. The world is permanently
changed by the workings of his mind, and the certainty that his creations will endure renews
his conﬁdence as no other pursuit.
Gian-Carlo Rota, ‘The Lost Cafe’, 1987
The one who writes a poem writes it above all because verse writing is an extraordinary
accelerator of conscience, of thinking, of comprehending the universe. Having experienced
this acceleration once, one is no longer capable of abandoning the chance to repeat this
experience; one falls into dependency on this process, the way others fall into dependency
on drugs or on alcohol. One who ﬁnds himself in this sort of dependency on language is, I
guess, what they call a poet.
Joseph Brodsky, ‘Nobel Lecture’, 1987
To paraphrase W. H. Auden (writing In Memory of W. B. Yeats),
[Mathematics]31 makes nothing happen: it survives
30 The proverbial meaning is a function of street’s location in space-time cultural continuum: it is
exceedingly unlikely, I reckon, that Aristotle’s remark in Nicomachean Ethics, IX that “without
friends none would care to live, though having all other things besides” should necessarily be
construed as endorsement of Facebook.
31 Save e.g. hydrogen bomb and computer.

92
A. Gamburd
In the valley of its making, where executives
Would never want to tamper.
In attempting to explain the signiﬁcance of Bourgain’s remarkable and remark-
ably useful results to a proverbial human-on-line, one may invoke their applica-
tions in mathematical physics, computer science, and cryptography, which are of
immense practical importance in contemporary life, making, in particular, the online
communication possible. Their subtlety, beauty, and depth appear to be much harder
to convey in “plain English.” Here and now, perhaps, we must remind ourselves that
the human-on-line, while attached to a digital device (built by von Neumann), is still
human and sound bite/tweet thus: while dealing with entities seemingly fake/unreal
(e.g., the real line), Bourgain’s singular adventures in the labyrinth of the continuum
represent a magniﬁcent and transcendent achievement of the human spirit.
***
I met Jean in September 2005, 6 months after my daughter (who drew the pictures
for this essay) was born, while visiting IAS for the program “Lie Groups, Represen-
tations and Discrete Mathematics” led by Alex Lubotzky. I do not remember the
precise date but do remember the hour: it was between 2 and 3 am. After changing
my daughter’s diapers, I could not sleep, went to Simonyi Hall, and ran into Jean
walking to the Library. It was in this discombobulated state that I was free of fear to
speak to him. By dawn, the problem which had been resisting my protracted attack
for a decade was vanquished in Jean’s ofﬁce.32
During this happiest year of my life, in 2005–2006, I stayed on the Lane named
after Hermann Weyl who was of the view that “Mathematics is not the rigid and
uninspiring schematism which the laymen is so apt to see in it; on the contrary, we
stand in mathematics precisely at that point of limitation and freedom which is the
essence of man himself.”
During my second visit to IAS, in 2007–2008, as von Neumann Fellow partic-
ipating in the “Arithmetic Combinatorics” Program led by Jean Bourgain and Van
Vu, I stayed on the Lane named after Erwin Panofsky. His magniﬁcent essay The
History of Art as a Humanistic Discipline, based on The Spencer Trask Princeton
University Lectures for 1937–38, commences thus:
Nine days before his death Immanuel Kant was visited by his physician. Old, ill, and nearly
blind, he rose from his chair and stood trembling with weakness and muttering unintelligible
32 Jean had the following daily routine. He would arrive at the dining hall for lunch within 5
minutes of its closing and, while descending the stairs, would look for whom to join for the meal
(the relevance of the person was determined primarily by their expertise in the problem Jean was
currently working on). After lunch and before the sunset, the door of his ofﬁce would be half-open.
After getting a bottle or red wine (typically Medoc), Jean would have dinner around 9 pm, followed
by a double espresso (typically in Small World Coffee), return to the ofﬁce, call his wife and son,
and then go for a brisk walk, encircling the Einstein Drive about 5 times. Between midnight and
the sunrise, the ofﬁce door would typically be closed. His handwritten notes (like that of Mozart’s
and unlike Beethoven’s) are virtually free of corrections, in part, because during the dinner and the
walk he would think about what would be set to paper upon his return to the ofﬁce.

Bourgain’s Discretized Sum-Product Theorem
93
words. Finally his faithful companion realized that he would not sit down until the visitor
has taken a seat. This he did, and Kant then permitted himself to be helped to his chair, and,
after regaining some of his strength, said, ‘Das Gefühl für Humanität hat mich noch nicht
verlassen’ – ‘The sense of humanity has not yet left me’. The two men were moved almost
to tears. For, though the word Humanität had come, in the eighteenth century, to mean little
more than politeness or civility, it had, for Kant, a much deeper signiﬁcance, which the
circumstances of the moment served to emphasize: man’s proud and tragic consciousness
of self-approved and self-imposed principles, contrasting with his utter subjection to illness,
decay and all that is implied in the word ‘mortality’.
Towards the end of the essay, Panofsky thus (pre-)echoes Orwell: “If the
anthropocratic civilization of the Renaissance is headed, as it seems to be, for a
Middle Ages in reverse –a satanocracy as opposed to the mediaeval theocracy – not
only the humanities but also natural sciences, as we know them, will disappear, and
nothing will be left but what serves the dictates of the sub-human.”
During my third, short visit (Fig. 10), I stayed on von Neumann Drive (the
only other “Drive” at IAS is named after Einstein). The similarities between von
Neumann and Baron Bourgain are subtle and striking.33 In his article The Legend
of John von Neumann [42], Paul Halmos has the following to say: “The heroes of
humanity are of two kinds: the ones who are just like all of us, but very much more
so, and the ones who, apparently, have and extra-human spark. We can all run, and
some of us can run the mile in less than 4 minutes; but there is nothing that most of us
can do that compares with the creation of the Great G-minor Fugue. Von Neumann’s
greatness was the human kind. We can all think clearly, more or less, some of the
time, but von Neumann’s clarity of thought was orders of magnitude greater than
that of most of us, all the time. Both Norbert Wiener and John von Neumann were
great men, and their names will live after them, but for different reasons. Wiener
saw things deeply but intuitively; von Neumann saw things clearly and logically.”
One may agree or disagree with Halmos’s assessment; it is my belief that Bourgain’s
greatness combined these two kinds.
***
The IAS (where Jean did most of the work described in this essay) ofﬁcial seal
(Fig. 11) is imprinted on the Analysis and Beyond conference poster. In a circular
format, the quiet elegant and classical Art Deco composition depicts two graceful
young ladies, one clothed and one otherwise, standing on opposite sides of a leafy
tree that appears to bear abundant fruit. Their poses are complementary, one looking
out towards the spectator and the other looking down, avoiding eye contact. The
33 The following remarks about Johnny are equally applicable to Jean. “It is usually difﬁcult to
sharpen von Neumann’s results. With small concern for expository simpliﬁcations or intuitive
motivations, he characteristically went straight to the heart of problems, and had an uncanny ability
to check all the essentially different possibilities, individually and in combination. This ability
gives most of his work an objective ﬁnality, and makes later workers begin by trying to simplify
von Neumann’s arguments, or to apply similar techniques to related problems” [7].
“The story used to be told about him in Princeton, that while he was indeed a demi-god, he had
made a detailed study of humans and could imitate them perfectly” [39].

94
A. Gamburd
Fig. 10 Jean Bourgain, Peter Sarnak, Alex Gamburd
ﬁgures are named in large sans serif letters, TRUTH to the left and BEAUTY on
the right. Truth holds a mirror that overlaps the circular frame to reﬂect reality.
Underlying the design of the seal is the evident allusion to the famous ﬁnal
couplet of “Ode on a Grecian Urn”: “Beauty is truth, truth beauty,” – that is all
Ye know on earth, and all ye need to know by John Keats, who was of the view
that “the excellence of every art is its intensity, capable of making all disagreebles
evaporate from their being in close relationship with Beauty and Truth.”
Having attempted in this essay a snapshot of the excellence of Bourgain’s art,
let me conclude by giving a glimpse of his intensity by quoting from the interview
upon receiving the 2017 Breakthrough Prize in Mathematical Sciences (Fig. 12):

Bourgain’s Discretized Sum-Product Theorem
95
Fig. 11 The IAS Seal
Fig. 12 Richard Taylor, Jean Bourgain, Terence Tao
If you have a question which is generally perceived as unapproachable, it is often that you
do not even quite know where you have to look to get a solution. From that point of view, we
are rather like Fourier,34 stranded in the desert, hopelessly lost. At the moment you get this
insight, all of a sudden you escape the desert and things open up for you. Then we feel very
34 Jean-Baptiste Joseph Fourier was a member of General Bonaparte’s expedition to Egypt(1798–
1801), important enough for the First Consul to make him, in 1802, the Prefect of the département
at Grenoble, a position which he held until Emperor Napoleon’s fall.

96
A. Gamburd
Fig. 13 Jean baron Bourgain 1954–2018
excited. These are the best moments. They make up for all the suffering with absolutely no
progress worth it.
Acknowledgments The author was supported, in part, by NSF award DMS-1603715.
Opening image and Figs. 1, 2, and 11 are courtesy of the Institute for Advanced Study.
Figures 3 and 9 are courtesy of C. J. Mozzochi.
Figure 4 is courtesy of Svetlana Jitomirskaya.
Figure 5 is courtesy of Kenneth Falconer.
Figures 6 and 8 are courtesy of Anna Gamburd.
Figure 7 is courtesy of Erik Huss, Royal Swedish Academy of Sciences.
Figure 10 is courtesy of Enrico Bombieri.
Figure 12 is courtesy of Terence Tao.
Figure 13 is courtesy of Claire Bourgain.
References
1. Atiyah, M.: Geometry and Physics of the 20th Century, Géométrie au XXe Siècle, sous
la direction de Joseph Kouneiher, Dominique Flament, Philippe Nabonnand, Jean-Jacques
Szczeciniarz, 4–9, Hermann, 2005
2. Balog, A., Szemerédi, E.: A statistical theorem of set addition. Combinatorica 14(3), 263–268
(1994)
3. Banach, S.: Sur le probleme de mesure. Fund. Math. 4, 7–33 (1923)
4. Banach, S, Tarski, A.: Sur la décomposition des ensembles de points en parties respectivement
congruentes. Fund. Math. 6, 244–277 (1924)
5. Besicovitch, A.S.: Sur deux questions d’intégrabilité des fonctions. J. Soc Phys.-Math. (Perm)
2, 105–123 (1919)

Bourgain’s Discretized Sum-Product Theorem
97
6. Besicovitch A.S.: On fundamental geometric properties of plane line sets, J. Lond. Math. Soc.
39, 441–448 (1964)
7. Birkhoff, G.: Von Neumann and lattice theory. Bull. Am. Math. Soc. 64, 50–56 (1958)
8. Bourgain, J.: Besicovitch type maximal operators and applications to Fourier analysis. Geom.
Funct. Anal. 1(2), 147–187 (1991)
9. Bourgain, J.: Remarks on Montgomery’s conjectures on Dirichlet sums. Geometric aspects of
functional analysis (1989–1990), 153–165, Lecture Notes in Math., vol. 1469. Springer, Berlin
(1991)
10. Bourgain, J.: On the dimension of Kakeya sets and related maximal inequalities. Geom. Func.
Anal. 9, 256–282 (1999)
11. Bourgain, J.: On the Erdös-Volkmann and Katz-Tao ring conjectures. Geom. Funct. Anal.
13(2), 334–365 (2003)
12. Bourgain, J.: Mordell’s exponential sum estimate revisited. J. Am. Math. Soc. 18(2), 477–499
(2005)
13. Bourgain, J.: Estimates on exponential sums related to the Difﬁe-Hellman distributions. Geom.
Funct. Anal. 15(1), 1–34 (2005)
14. Bourgain, J.: The discretized sum-product and projection theorems. J. Anal. Math. 112, 193–
236 (2010)
15. Bourgain, J., Demeter, C., Guth, L.: Proof of the main conjecture in Vinogradov’s mean value
theorem for degrees higher than three. Ann. Math. (2) 184(2), 633–682 (2016)
16. Bourgain, J., Gamburd, A.: Uniform expansion bounds for Cayley graphs of SL2(Fp). Ann.
Math. 167, 625–642 (2008)
17. Bourgain, J., Gamburd, A.: On the spectral gap for ﬁnitely-generated subgroups of SU(2).
Invent. Math. 171(1), 83–121 (2008)
18. Bourgain, J., Glibichuk, A.A., Konyagin, S.V.: Estimates for the number of sums and products
and for exponential sums in ﬁelds of prime order. J. Lond. Math. Soc. (2) 73(2), 380–398
(2006)
19. Bourgain, J., Katz, N., Tao, T.: A sum-product estimate in ﬁnite ﬁelds, and applications. Geom.
Funct. Anal. 14(1), 27–57 (2004)
20. Breuillard, E.: Approximate subgroups and super-strong approximation. Groups St Andrews
2013, 1–50, London Math. Soc. Lecture Note Ser., 422. Cambridge Univ. Press, Cambridge
(2015)
21. Breuillard, E., Oh, H.: Thin groups and superstrong approximation, Math. Sci. Res. Inst. Publ.,
61. Cambridge Univ. Press, Cambridge (2014)
22. Burkill, J.C., Abram Samoilovitch Besicovitch. 1891–1970, Biographical Memoirs of Fellows
of the Royal Society, vol. 17, pp. 1–16 (1971)
23. Caffarelli, L.: The work of Jean Bourgain, Proceedings of the International Congress of
Mathematicians, vol. 1, 2 (Zürich, 1994), pp. 3–5. Birkhäuser, Basel (1995)
24. Chang, M.: A polynomial bound in Freiman’s theorem. Duke Math. J. 113(3), 399–419 (2002)
25. Christ, M., Duoandikoetxea, J., Rubio de Francia, J.L.: Maximal operators associated to the
Radon transform and the Calderon-Zygmund method of rotations. Duke Math. J. 53, 189–209
(1986)
26. Conway, J., Radin, C.: Quaquaversal tilings and rotations. Invent. Math. 132, 179–188 (1998)
27. Davies, R.: Some remarks on the Kakeya problem. Proc. Camb. Philos. Soc. 69, 417–421
(1971)
28. Dawson, C.M., Nielsen, M.A.: The Solovay-Kitaev algorithm. Quantum Inf. Comput. 6, 81–95
(2006)
29. Deligne, P.: La conjecture de Weil. I. (French) Inst. Hautes Études Sci. Publ. Math. No. 43,
273–307 (1974)
30. Drinfeld, V.: Finitely-additive measures on S2 and S3, invariant with respect to rotations. Funct.
Anal. Appl. 18, 245–246 (1984)
31. Drury, S.: Lp estimates for the x-ray transform. Illinois J. Math. 27, 125–129 (1983)
32. Edgar, G.A., Miller, C.: Borel subrings of the reals. Proc. Am. Math. Soc. 131, 1121–1129
(2003)

98
A. Gamburd
33. Elekes, G.: On the number of sums and products. Acta Arith. 81, 365–367 (1997)
34. Erdös, P., Volkmann, B.: Additive Gruppen mit vorgegebener Hausdorffscher dimension. J.
Reine Angew. Math 221, 203–208 (1966)
35. Erdös, P., Szemerédi, E.: On sums and products of integers. In: Studies in Pure Mathematics,
pp. 213–218. Birkhäuser, Basel (1983)
36. Falconer, K.J.: The Hausdorff dimension of distance sets. Mathematika 32, 206–212 (1985)
37. Fefferman, C.: The multiplier problem for the ball. Ann. Math. 94, 330–336 (1971)
38. Freiman, G.: Foundations of a Structural Theory of Set Addition, Trans. Math. Monogr., vol.
37. Amer. Math. Soc., Providence (1973)
39. Goldstine, H.: Computer from Pascal to von Neumann. Princeton University Press, Princeton
(1972)
40. Gowers, T.: A new proof of Szemeredi’s theorem for arithmetic progressions of length four.
GAFA 8(3), 529–551 (1998)
41. Gamburd, A., Jakobson, D., Sarnak, P.: Spectra of elements in the group ring of SU(2). J. Eur.
Math. Soc. 1, 51–85 (1999)
42. Halmos, P.R.: The legend of John von Neumann. Am. Math. Monthly 80, 382–394 (1973)
43. Harrow, A., Recht, B., Chuang, I.: Efﬁcient discrete approximation of quantum gates. J. Math.
Phys. 43, 4445–4452 (2002)
44. Hausdorff, F.: Bemerkung über den Inhalt von Punktmengen. Math. Ann. 75, 428–434 (1914)
45. Helfgott, H.A.: Growth and generation in SL2(Z/pZ). Ann. Math. (2) 167(2), 601–623 (2008)
46. Helfgott, H.A.: Growth in groups: ideas and perspectives. Bull. Am. Math. Soc. (N.S.) 52(3),
357–413 (2015)
47. Jarník, V.: Über die simultanen diophantischen Approximationen. Math. Zeit. 33, 505–543
(1931)
48. Kakeya, S.: Some problems on maxima and minima regarding ovals. Tohoku Sci. Rep. 6, 71–88
(1917)
49. Kaloshin, V., Rodnianski, I.: Diophantine properties of elements of SO(3). Geom. Funct. Anal.
11, 953–970 (2001)
50. Katz, N., Tao, T.: Some connections between Falconer’s distance set conjecture, and sets of
Furstenberg type. N. Y. J. Math. 7, 149–187 (2001)
51. Kaufman, R.: On the Hausdorff dimension of projections. Mathematika 15, 153–155 (1968)
52. Kaufman R.: On the theorem of Jarník and Besicovitch. Acta Arithmetica 39, 265–267 (1981)
53. Kazhdan, D.A.: On the connection of the dual space of a group with the structure of its closed
subgroups. Funkcional. Anal. i Prilozhen. 1, 71–74 (1967)
54. Kolmogorov, A.N., Barzdin, Ya.M.: On the realization of networks in three-dimensional space.
Problemy Kibernet. 19, 261–268 (1967)
55. Łaba, I.: From harmonic analysis to arithmetic combinatorics. Bull. Am. Math. Soc. (N.S.)
45(1), 77–115 (2008)
56. Lebesgue, H.: Lecons sur l’Integration et la Recherche des Fonctions Primitives. Gauthier-
Villars, Paris (1904)
57. Leighton, T.: Complexity Issues in VLSI, Foundations of Computing Series. MIT Press,
Cambridge, (1983)
58. Lubotzky, A.: Cayley graphs: eigenvalues, expanders and random walks. In: Rowbinson, P.
(ed.), Surveys in Combinatorics. London Math. Soc. Lecture Note Ser. 18, pp. 155–189.
Cambridge Univ. Press, Cambridge (1995)
59. Lubotzky, A., Phillips, R., Sarnak, P.: Hecke operators and distributing points on S2 I.
Commun. Pure Appl. Math. 39(S), S149–S186 (1986)
60. Lubotzky, A., Phillips, R., Sarnak, P.: Hecke operators and distributing points on S2 II.
Commun. Pure Appl. Math. 40(4), 401–420 (1987)
61. Lubotzky, A., Phillips, R., Sarnak, P.: Ramanujan graphs. Combinatorica 8, 261–277 (1988)
62. Lubotzky, A., Weiss, B.: Groups and expanders. In: Friedman, J. (ed.), DIMACS Series in Disc.
Math. and Theor. Comp. Sci. vol. 10, pp. 95–109 (1993)
63. Manin, Yu. I.: Mathematics and physics. Translated from the Russian by Ann Koblitz and Neal
Koblitz. Progress in Physics, 3. Birkhäuser, Boston (1981)

Bourgain’s Discretized Sum-Product Theorem
99
64. Margulis, G.A.: Explicit constructions of expanders. Problemy Peredaci Informacii 9(4), 71–80
(1973)
65. Margulis, G.A.: Some remarks on invariant means. Monatsh. Math. 90, 233–235 (1980)
66. Margulis, G.A.: Explicit group-theoretic constructions of combinatorial schemes and their
applications in the construction of expanders and concentrators. Problemy Peredachi Infor-
matsii 24(1), 51–60 (1988)
67. Marstrand, J.M.: Some fundamental geometrical properties of plane sets of fractional dimen-
sions. Proc. Lond. Math. Soc. (3) 4, 257–302 (1954)
68. Matthews, C.R., Vaserstein, L.N., Weisfeiler, B.: Congruence properties of Zariski dense
subgroups. I. Proc. Lond. Math. Soc. (3) 48(3), 514–532 (1984)
69. Mauldin, R.D.: Subﬁelds of R with arbitrary Hausdorff dimension. Math. Proc. Camb. Philos.
Soc. 161(1), 157–165 (2016)
70. Mordell, L.J.: On Mr. Ramanujan’s empirical expansions of modular functions. Proc. Camb.
Philos. Soc. 19, 117–124 (1917)
71. Nahmod, A.R.: The nonlinear Schrödinger equation on tori: integrating harmonic analysis,
geometry, and probability. Bull. Am. Math. Soc. (N.S.) 53(1), 57–91 (2016)
72. von Neumann, J.: Zur allgemeinen Theorie des Maßes. Fund. Math. 13, 73–111 (1929)
73. Pinsker, M.S.: On the complexity of a concentrator. In: 7th International Teletraﬁc Conference,
pp. 318/1–318/4 (1973)
74. Plünnecke, H.: Eigenschaften und Abschätzungen von Wirkingsfunktionen, BMwFGMD-22
Gesellschaft für Mathematik und Datenverarbeitung, Bonn (1969)
75. Ramanujan, S.: On certain arithmetical functions. Trans. Camb. Philos. Soc. XXII, 159–184
(1916)
76. Ramsey, F.P.: On a problem of formal logic. Proc. Lond. Math. Soc. 30, 264–285 (1930)
77. Ruzsa, I.: Sums of Finite Sets. Number Theory (New York, 1991–1995), pp. 281–293.
Springer, New York (1996)
78. Sarnak, P.: Some Applications of Modular Forms. Cambridge Tracts in Mathematics, vol. 99.
Cambridge University Press, Cambridge (1990)
79. Sarnak, P.: Selberg’s eigenvalue conjecture. Notices Am. Math. Soc. 42, 1272–1277 (1995)
80. Schnirelmann, L.: Über additive Eigenschaften von Zahlen. Ann. Inst. Polyt. Novocherkassk
14, 3–28 (1930)
81. Selberg, A.: On the estimation of Fourier coefﬁcients of modular forms. Proc. Sympos. Pure
Math. VII, 1–15 (1965)
82. Sanders, T.: The structure theory of set addition revisited. Bull. Am. Math. Soc. (N.S.) 50(1),
93–127 (2013)
83. Steinhaus, H.: Mathematician for all seasons—recollections and notes, vol. 1 (1887–1945).
With a foreword by Kazimierz Dziewanowski. Translated from the Polish by Abe Shenitzer.
Edited and with an introduction by Robert G. Burns, Irena Szymaniec and Aleksander Weron.
Vita Mathematica, 18. Birkhäuser/Springer, Cham (2015)
84. Steinhaus, H.: Mathematician for all seasons—recollections and notes, vol. 2 (1945–1968).
Translated from the Polish by Abe Shenitzer. Edited by Robert G. Burns, Irena Szymaniec and
Aleksander Weron. Vita Mathematica, 19. Birkhäuser/Springer, Cham (2016)
85. Sullivan, D.: For n > 3 there is only one ﬁnitely additive rotationally invariant measure on the
n-sphere on all Lebesgue measurable sets. Bull. Am. Math. Soc. 4, 121–123 (1981)
86. L. Székely, Crossing numbers and hard Erdös problems in discrete geometry. Combin. Probab.
Comput. 6, 353–358 (1997)
87. Szemerédi, E.: Regular partitions of graphs, Problemes combinatoires et theorie des graphes
(Colloq. Internat. CNRS, Univ. Orsay, Orsay, 1976), pp. 399–401, Colloq. Internat. CNRS,
260, CNRS, Paris (1978)
88. Szemerédi, E., Trotter, W.: Extremal problems in discrete geometry. Combinatorica 3, 381–392
(1983)
89. Tao, T.: From rotating needles to stability of waves: emerging connections between combina-
torics, analysis and PDE. Notices AMS 48(3), 294–303 (2001)

100
A. Gamburd
90. Tao, T.: Product set estimates for non-commutative groups. Combinatorica 28(5), 547–594
(2008)
91. Tao, T.: Expansion in Finite Simple Groups of Lie Type. Graduate Studies in Mathematics, vol.
164. American Mathematical Society, Providence (2015)
92. Vitali, G.: Sul problema della misura dei gruppi di punti di una retta. Bologna, Tip. Gamberini
e Parmeggiani (1905)
93. van der Waerden, B.L.: Beweis einer Baudetschen Vermutung, Nieuw. Arch. Wisk. 15, 212–
216 (1927)
94. Weisfeiler, B.: Strong approximation for Zariski-dense subgroups of semi-simple algebraic
groups. Ann. Math. (2) 120(2), 271–315 (1984)
95. Wolff, T.: Recent Work Connected with the Kakeya Problem. Prospects in Mathematics
(Princeton, NJ, 1996), pp. 129–162. Amer. Math. Soc., Providence (1999)

Cartan Covers and Doubling
Bernstein-Type Inequalities on Analytic
Subsets of C2
Michael Goldstein, Wilhelm Schlag, and Mircea Voda
Dedicated to the memory of Jean Bourgain
Abstract We prove a version of the doubling Bernstein inequalities for the trace
of an analytic function of two variables on an analytic subset of C2. The estimate
applies to the whole analytic set in question including its singular points. The proof
relies on a version of the Cartan estimate for maps in C2 which we establish in this
work.
1
Introduction
In a series of papers [9–11], Fefferman and Narasimhan investigated the local
behavior of a polynomial f of N real or complex variables, restricted to a given
The second author was partially supported by the NSF, DMS-1500696. The ﬁrst author was
partially supported by NSERC grant. The ﬁrst author thanks the University of Chicago and Yale
University for hospitality. The authors are grateful to János Kollár and Mihnea Popa for helpful
discussions on Bézout’s theorem.
M. Goldstein ()
Department of Mathematics, University of Toronto, Toronto, ON, Canada
e-mail: gold@math.toronto.edu
W. Schlag
Department of Mathematics, Yale University, New Haven, CT, USA
Department of Mathematics, The University of Chicago, Chicago, IL, USA
e-mail: wilhelm.schlag@yale.edu
M. Voda
Department of Mathematics, The University of Chicago, Chicago, IL, USA
Department of Mathematics, University of Toronto, Toronto, ON, Canada
e-mail: mvoda@uchicago.edu
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
A. Avila et al. (eds.), Analysis at Large, https://doi.org/10.1007/978-3-031-05331-3_5
101

102
M. Goldstein et al.
n-dimensional algebraic variety X. Conceptually, the problem is to quantify to
what extent the local behavior of the trace of f on X deteriorates relative to an
N-dimensional ball. Of particular interest here is to determine the dependence of
quantitative estimates on the degree of the polynomials. Fefferman and Narasimhan
chose the classical Bernstein inequalities for polynomials of several variables to
measure the distortion of a polynomial restricted to an algebraic variety.
The authors’ interest in this particular problem arose as part of their work on
the Chulaevsky-Sinai conjecture. In their pioneering paper [6], Chulaevsky and
Sinai analyze the spectrum of a discrete Schrödinger operator on Z with a quasi-
periodic potential given by evaluating a generic smooth function on T2 along the
orbit of an ergodic shift. In [16] (building on work from [15]), the authors found
that some “generic versions” of these restricted Bernstein estimates play a crucial
role in addressing this conjecture.
There are two major differences between the current paper and [11]: (i) we
obtained estimates at singular points, and the estimates at regular points don’t
depend on the distance to the singular points, and (ii) we allow analytic functions
and analytic sets in place of polynomials and algebraic varieties.
Fefferman and Narasimhan had considered compact subsets of algebraic varieties
away from the singular points. For polynomials and algebraic varieties, Roytwarf
and Yomdin
[20] extended their Bernstein estimates to be independent of the
distance to the singular points. However, the aforementioned spectral analysis forces
us to consider analytic functions and sets rather than algebraic ones. Our estimates
for analytic functions are not as sharp as for polynomials. This however is something
which is absolutely natural due to elementary examples. For the same reason, the
estimates for analytic functions require some “transversality conditions” since there
is no way to prove the result in this setting upon the count of zeros alone.
The main result for us is Theorem A which addresses the mentioned applications
to the spectral problem. In Theorem B we obtain a sharper version of Theorem A
for the polynomial case, similar to [20]. The work of Roytwarf and Yomdin relies
on a classical inequality for the Taylor coefﬁcients of p-valent functions due to
Biernacki [1]. In turn [1] relies on a deeper growth bound for p-valent functions
obtained by Cartwright [4] (see [17] for a more detailed account of these issues). In
Theorem B we show that in the context of algebraic curves, the Bernstein estimates
by Roytwarf and Yomdin follow from a more elementary geometric approach in
the spirit of the argument principle, without any reference to properties of p-valent
functions. We also employ basic properties of the harmonic conjugate and of course
Bezout’s theorem (which is also needed in Roytwarf and Yomdin in order to estimate
the valency). It seems that this approach can be developed for a general algebraic
variety.
Regarding previous work in the analytic setting, we note that Coman-Poletsky
[7] (for n = 1) and Brudnyi [3] (for all n ≥1) studied Bernstein estimates (among
other local properties) for the restriction of analytic functions of n + 1 variables to
the graph of an analytic function of n variables. Both these papers naturally require
a certain transversality condition of the zeros sets of the functions in question. We
would like also to mention the Friedland–Yomdin paper [12] on doubling covering

Cartan Covers and Doubling Bernstein-Type Inequalities
103
and Comte–Yomdin patper [8] on zeros of analytic functions which are close in
spirit to the current paper.
We proceed to discuss the main results of the paper. First we need to introduce
some notation related to Cartan sets and to Bernstein exponents. The Cartan sets
will appear in our transversality condition to allow the application of the Cartan-
type estimate established in Theorem C.
Deﬁnition 1.1
(1) Let H ≥0, K ≥1. For B ⊂C2, we say that B ∈Car2,0(H, K) if
B ⊂
j0

j=1
B(vj, r)
with vj ∈C2, r = e−H , and some j0 ≤K.
(2) Let f be analytic on the ball B(v0, R) ⊂C2, S ⊂C2, and μ ∈(0, 1). Deﬁne
Mf (v0, R) =
sup
B(v0,R)
log |f |,
Mf (S, v0, R) =
sup
B(v0,R)∩S
log |f |,
Bf (μ; v0, R) = Mf (v0, R) −Mf (v0, μR),
Bf (μ; S, v0, R) = Mf (S, v0, R) −Mf (S, v0, μR).
We call Bf (μ; v0, R), Bf (μ; S, v0, R) Bernstein exponents. We make the
natural convention that if the function f vanishes identically, its Bernstein
exponents are zero.
(3) Let f be analytic on B(0, 1), μ ∈(0, 1). We deﬁne
Bf (μ) =
sup
v0∈B(0,1/4),0<R≤1/4
Bf (μ; v0, R).
(4) Given an analytic function f on a disk D(z0, R) ⊂C, the quantities Mf (z0, R)
and Bf (μ; z0, R) are deﬁned analogously to the above.
The classical Bernstein doubling inequality for a univariate polynomial f can be
expressed using the above notation as
Bf (μ; z0, R) ≤(log μ−1) × degf,
where μ ∈(0, 1), z0 ∈C, R > 0.
We will use some standard conventions. Unless stated otherwise, the constants
denoted by c, C might have different values each time they are used. We let a ≲b
denote a ≤Cb with some positive C, and a ≃b stand for a ≲b and b ≲a.
By writing a ≪b, we mean that a ≤Cb with a positive C, and furthermore
the constant C is large enough for all related statements that we make based on
a ≪b to hold. All these constants are absolute. In particular if a ≪b is part of the

104
M. Goldstein et al.
assumptions of a result, we mean that there exists a large enough absolute constant
C > 0 such that if a ≤Cb, then the conclusion holds. We adopt such notation
because we are not interested in the optimality of the implicit absolute constants.
However, we note that throughout the paper, the implicit constants are absolute and
can be determined explicitly.
Throughout we will impose the following transversality condition. Suppose the
functions f1, f2 are analytic in the ball B(0, 1) ⊂C2 and are normalized so that
Mfi(0, 1) ≤0, i = 1, 2. We let F = (f1, f2), and we deﬁne
NF (ε) := {v ∈B(0, 1) : |F(v)| < ε}.
We require that
NF (exp(−H0)) ∩B(0, 1/2) ∈Car2,0(H1, K1),
log K1 ≪H1,
(1)
for some H0 ≫H1 ≫B0 := maxi Bfi(1/4).
Remark 1.2 A priori it might appear that K1 can be exponentially large, i.e.,
exp(cH0) for some small c > 0. However, a simple argument, presented in
Lemma 6.1, shows that we always have the polynomial bound K1 ≤H C
0 , where
C is some absolute constant.
Let Z = {v ∈B(0, 1) : f2(v) = 0}. It is well known that there exists a discrete
set of singular points sng Z (relative to B(0, 1)) such that the set of regular points
reg Z := Z \ sng Z is a one-dimensional complex manifold (see, e.g., [5]).
Theorem A Assume the transversality condition holds and let Z be as above. Let
C0 = log(K1B2
0H 2
0 ). Then the following statements hold.
(1) For any v0 ∈B(0, 1/8) ∩Z and 0 < R ≤1/4,
Bf1(1/4; Z, v0, R) ≲max(log R−1, C0)B2
0H0.
(2) There exists an atlas of reg Z with charts deﬁned on D(0, 1) such that for any
chart φ satisfying φ(D(0, 1)) ∩B(0, 1/8) ̸= ∅and any D(z0, R) ⊂D(0, 1),
we have
Bf1◦φ(1/4; z0, R) ≤C(f2)C0B2
0H0.
Remark 1.3 The log R−1 factor from part (1) of Theorem A is needed because the
estimate covers singular points. See Example 7.2.
Theorem B Assume that f1, f2 are polynomials. Let Z be as above. Then there
exists an atlas of reg Z with charts deﬁned on D(0, 1) such that for any chart φ and
any D(z0, R) ⊂D(0, 1), we have
Bf1◦φ(1/4; z0, R) ≤C(f2) × degf1.

Cartan Covers and Doubling Bernstein-Type Inequalities
105
For our application in [16], we use the Cartan estimate for maps in C2 which
is Theorem C we state below. The proof of Theorem A relies on Theorem C. The
Cartan estimate for an analytic function f (v), v ∈C2 (see Lemma 2.2), basically
says that if the set {|f | < ε0} is “not two dimensional,” then {|f | < ε} is “one
dimensional” for any ε ≪ε0. We prove an analogue statement for mappings. Let
F : B(0, 1) ⊂C2 →C2 be analytic. We show that if the set {|F| < ε0} is “zero
dimensional,” then {|F| < ε} is “zero dimensional” for any ε ≪ε0. Of course, the
quantitative details of the statement here are as important as the topological ones.
Theorem C Assume the transversality condition holds. Then for any H ≫1, we
have
NF (exp(−HB2
0H0)) ∩B(0, 1/4) ∈Car2,0(H, K),
K ≲K1B2
0H 2
0 .
The proof of Theorem C proceeds in four steps: (a) apply the Weierstrass
preparation theorem to the given analytic functions in one of the two coordinates;
(b) determine the resultant of the two polynomials obtained in the previous step; (c)
apply Cartan’s theorem in one variable so as to guarantee that this resultant is not
too small off of a union of small disks in C, which in turn gives that at least one of
the two analytic functions is not too small outside of thin cylinders in C2; and (d)
repeat the previous steps with respect to the other variable. The intersection of the
two families of thin cylinders gives a Car2,0 set.
It would be interesting to extend this method to higher dimensions, i.e., to
the construction of Card,0(H, K) sets with d ≥3—at least for polynomials in
d variables. In principle, this appears possible, but it seems to require the use
of multivariate resultants, which are more delicate than the univariate ones. If
Theorem C extends to d ≥3, then one would obtain a Bernstein estimate as in
Theorem A. As our applications do not require this extension, we do not pursue
these matters here.
We conclude this introduction by providing some details of the aforementioned
spectral theory applications. Consider a trigonometric polynomial of two variables
V (z, w) =

|m|,|n|≤k
cm,ne(mz + nw),
(2)
e(ζ) := e2πiζ. To normalize the setting, we consider the unit sphere in the space of
the coefﬁcients
C1 = {(cm,n) ∈R4k+2 :

m,n
|cm,n|2 = 1}.
We use mes for the Lebesgue measure on the sphere. Take arbitrary ω ∈T2, λ ∈R.
Consider the determinant

106
M. Goldstein et al.
fN(v) =

λV (v)
−1
0 · · · · · ·
0
−1
λV (v + ω) −1 0 · · ·
0
...
...
...
...
...
−1
0
..........
0 −1
λV (v + (N −1)ω)

(3)
For v ∈R2, fN(v) is the characteristic determinant of the Schrödinger operator with
potential V (v + nω), n ∈Z on the interval [0, N −1] subject to Dirichlet boundary
conditions. In [16], we establish the following results: Given arbitrary ε > 0, there
exists a set C ⊂R4k+2 with mes(C1 \ C) < ε and λ0 = λ0(ε) depending only on ε
such that for any V with (cm,n) ∈C1 and any |λ| ≥λ0 there exists a set (V ) ⊂T2
with mes((V )) < ε such that for any ω ∈T2 \ (V ), any N, and any v0 ∈T2
the functions fN(v0 +r0v) and fN(vn +r0v), vn = v0 +nω, |n| > N, v ∈B(0, 1),
r0 = exp(−(log N)A), and A ≫1 being an absolute constant, obey all conditions
of Theorem A and Theorem C with B0, H0 ≤(log N)c, c ≪1.
The exceptional sets in this result are not artiﬁcial. In fact, the theorem fails for
some (cm,n) ∈C. A similar fact is true for the exceptional frequencies.
2
Cartan’s Estimate
Recall the following deﬁnition from [14].
Deﬁnition 2.1 Let H ≥0, K ≥1. For an arbitrary set B ⊂C, we say that B ∈
Car1(H, K) if B ⊂
j0
j=1
D(zj, rj) with zj ∈C, j0 ≤K, and 
j rj < e−H.
If d ≥1 is an integer and B ⊂Cd, then we deﬁne inductively that B ∈
Card(H, K) if for any 1 ≤j ≤d there exists Bj ⊂C, Bj ∈Car1(H, K), so that
B(j)
z
∈Card−1(H, K) for any z ∈C\Bj, here B(j)
z
=
#
(z1, . . . , zd) ∈B : zj = z
$
.
The above deﬁnition of Cartan sets is motivated by the following statement,
known as Cartan estimate on the lower bound of an analytic function of several
variables.
Lemma 2.2 ([14, Lem. 2.15]) Let ϕ(z1, . . . , zd) be an analytic function deﬁned in
a polydisk P =
d
j=1
D(zj,0, 1), zj,0 ∈C. Let M ≥sup
z∈P
log |ϕ(z)|, m ≤log
ϕ(z0)
,
z0 = (z1,0, . . . , zd,0). There exists a constant Cd (depending only on the dimension
d) such that for any given H ≫1 there exists a set B ⊂P, B ∈Card

H 1/d, K

,
and K = CdH(M −m), such that

Cartan Covers and Doubling Bernstein-Type Inequalities
107
log
ϕ(z)
 > M −CdH(M −m)
(4)
for any z ∈d
j=1 D(zj,0, 1/6) \ B. Furthermore, when d = 1, we can take K =
C(M −m) and keep only the disks of B containing a zero of φ in them.
Remark 2.3
(1) The choice of the constant 1/6 in [14, Lem. 2.15] was so that one could invoke
the one-dimensional Cartan estimate as stated in Theorem 4 of [19, Lecture 11].
However, it is straightforward to adjust the result from [19] and the proof from
[14] to replace 1/6 by any r < 1. Of course, the constant Cd would depend
(explicitly) on the particular choice of r.
(2) The deﬁnition of Cartan sets gives implicit information about their measure.
For example, using Fubini and the deﬁnition of Card, one gets by induction
that the set exceptional set B in the previous lemma satisﬁes mesCd(B) ≤
C(d) exp(−H).
The following notion will be needed for our discussion of Weierstrass’ prepara-
tion theorem.
Deﬁnition 2.4 Let f be analytic on the ball B(v0, R0) ⊂C2. Let e ∈C2 be an
arbitrary unit vector. We say that e is m–regular for f at v0 (or just m–regular if it
is clear from the context what v0 is) if
sup
z∈D(0,R0/4)
log |f (v0 + ze)| ≥m.
We show that Cartan’s estimate implies that most directions are regular. We use
σ to denote the standard spherical measure.
Lemma 2.5 Let f be as in Deﬁnition 2.4 and let
M ≥
sup
B(v0,R0)
log |f |,
sup
B(v0,R0/4)
log |f | ≥m.
Take arbitrary H ≫1 and set m = M −C2H(M −m), with C2 as in Lemma 2.2.
Denote by B the set of e which are not m–regular. Then
σ(B) ≲exp(−H 1/2).
Proof Apply the Cartan estimate to ﬁnd a set ˆB, mes( ˆB) ≲R4
0 exp(−H 1/2), such
that log
f (v)
 > m for any v ∈B(v0, R0/4)\ ˆB. Using spherical coordinates, write
mes( ˆB) ≥

B
dσ(e)

 R0/4
0
r3dr ≳R4
0σ(B)
and the statement follows.
⊓⊔

108
M. Goldstein et al.
3
Bernstein Exponent and Number of Zeros
In this section we provide a relation between Bernstein exponents for one variable
analytic functions and the number of their zeros.
Lemma 3.1 Let φ be a non-vanishing analytic function on D(z0, R). Then for any
z, |z −z0| = r < R, we have
−
2r
R −r (M −log |φ(z0)|) ≤log |φ(z)| −log |φ(z0)| ≤
2r
R + r (M −log |φ(z0)|),
where M = Mφ(z0, R).
Proof The estimates follows immediately from Harnack’s inequality applied to
u(z) = M −log |φ(z)|.
⊓⊔
Proposition 3.2 Let φ be an analytic function on D(0, 1) such that
Mφ(0, 1) ≤0,
Mφ(0, 1/4) ≥m.
Let n be the total number of zeros of φ in D(0, 3/4). Then for any |z0| < 1/8,
r < 1/8, μ ∈(0, 1), we have
Bφ(μ; z0, r) ≤Cr(n −m) −n log μ ≲−(r −log μ)m,
(5)
Proof Take ζ0 ∈D(0, 1/4) wit log |f (ζ0)| = m. Using Jensen’s formula applied to
f
 z + ζ0
1 + ζ0z

,
we get n ≲−m. So, we just have to prove the ﬁrst estimate in (5).
Let a1, . . . , an, be the zeros of φ in D(0, 7/8), repeated according to their
multiplicities. Let P(z) = n
k=1(z −ak), h = φ/P, and z1, |z1 −z0| = μr,
be such that log |h(z1)| = Mh(z0, μr). Note that h is non-vanishing and analytic on
D(0, 3/4). Using Lemma 3.1 we have that for any z ∈D(z0, μr)
log |h(z)| ≥log |h(z1)| −
2|z −z1|
1/2 −|z −z1|(Mh(z0, 1/2) −log |h(z1)|)
≥Mh(z0, μr) −Cμr(Mh(0, 3/4) −Mh(z0, μr)).
Therefore
Mφ(z0, μr) ≥Mh(z0, μr) −Cμr(Mh(0, 3/4) −Mh(z0, μr)) + MP (z0, μr)
and

Cartan Covers and Doubling Bernstein-Type Inequalities
109
Bφ(μ; z0, r) ≤Mh(z0, r) −Mh(z0, μr) + Cμr(Mh(0, 3/4) −Mh(z0, μr))
+ MP (z0, r) −MP (z0, μr).
(6)
Let z2, |z2 −z0| = r, such that log |h(z2)| = Mh(z0, r), and z3, |z3| = 1/4, such
that log |h(z3)| = Mh(0, 1/4). Using Lemma 3.1, we get
Mh(z0, r) −Mh(z0, μr) = log |h(z2)| −log |h(z1)|
≤
2|z2 −z1|
1/2 + |z2 −z1|(Mh(z1, 1/2)−log |h(z1)|) ≤Cr(Mh(0, 3/4)−Mh(z0, μr)),
Mh(z0, μr) −Mh(0, 1/4) = log |h(z1)| −log |h(z3)|
≥−
2|z3 −z1|
1/2 −|z3 −z1|(Mh(z3, 1/2) −log |h(z3)|)
≥−C(Mh(0, 3/4) −Mh(0, 1/4)).
Plugging these estimates in (6), we get
Bφ(μ; z0, r) ≤Cr(Mh(0, 3/4) −Mh(0, 1/4)) + BP (μ; z0, r).
(7)
Recall that we know BP (μ; z0, r) ≤−n log μ, so to get the conclusion, we just
have to estimate Mh(0, 3/4)−Mh(0, 1/4). Given z ∈D(0, 3/4), apply the submean
value property to get
log |h(z)| ≤1
2π

 2π
0
log |φ(z+eiθ/4)| dθ−1
2π

 2π
0
log |P(z+eiθ/4)| dθ ≤n log 4
and conclude Mh(0, 3/4) ≤n log 4. We used the assumption that Mφ(0, 1) ≤0 and
the fact that
1
2π

 2π
0
log |z −ak + eiθ/4| dθ =

log 1
4
, |z −ak| ≤1
4
log |z −ak|
, |z −ak| > 1
4
≥log 1
4.
(8)
Since clearly MP (0, 1/4) ≤0, we have Mh(0, 1/4) ≥Mφ(1/4). So,
Mh(0, 3/4) −Mh(0, 1/4) ≤C(n −m)
and the conclusion follows.
⊓⊔
Remark 3.3
(1) It is not true that conclusion of Proposition 3.2 can be made just in terms of the
number n of zeros of φ. Some estimate for Mφ(0, 1/4) is really needed. Here,

110
M. Goldstein et al.
an elementary example φ(z) = exp(−N + Nz), z ∈D(0, 1), and N > 0 is
arbitrary. Clearly, Mφ(0, 1) = 0, n = 0. On the other hand, Mφ(0, 1/4) ≃−N,
Bφ(1/4; 0, 1/8) ≃N.
(2) It is known from [20] that if we have control on the valency of the function
φ, instead of just the number of zeros, then the estimate for Mφ(0, 1/4) is not
needed anymore.
4
Weierstrass’ Preparation Theorem and Bernstein
Exponents
We start with a statement of the classical Weierstrass’ preparation theorem attuned
to our purposes.
Lemma 4.1 Let f (z, w) be analytic function on a polydisk
P := D(z0, R0) × D(w0, R0) ⊂C2,
R0 > 0.
Assume that f (·, w) has no zeros on some circle ρ0 = {z : |z −z0| = ρ0}, 0 <
ρ0 < R0/2, for any w ∈D(w0, r1), 0 < r1 < R0. Then there exists a Weierstrass
polynomial P(z, w) = zk + ak−1(w)zk−1 + · · · + a0(w) with aj(w) analytic in
D(w0, r1) and an analytic function g(z, w), (z, w) ∈P′ := D(z0, ρ0) × D(w0, r1)
so that the following properties hold:
(a) f (z, w) = P(z, w)g(z, w) for any (z, w) ∈P′.
(b) g(z, w) ̸= 0 for any (z, w) ∈P′.
(c) For any w ∈D(w0, r1), P(·, w) has no zeros in C \ D(z0, ρ0).
(d) We have
(
inf
ρ0×D(w0,r1)
log |f |
)
−k log(2ρ0) ≤inf
P′ log |g|,
(9)
sup
P′ log |g| ≤
(
sup
P
log |f |
)
+ k log 2
R0
.
(10)
Proof By the usual Weierstrass argument, one notes that
bp(w) :=
k

j=1
ζ p
j (w) =
1
2πi
*

zp ∂zf (z, w)
f (z, w) dz
are analytic in D(w0, r1). Here ζj(w) are the zeros of f (·, w) in D(z0, ρ0). Since
the coefﬁcients aj(w) are linear combinations of the bp, they are analytic in w.
Analyticity of g follows by standard arguments. We just have to prove (d). Since all

Cartan Covers and Doubling Bernstein-Type Inequalities
111
the roots of P(·, w) are in D(z0, ρ0), we have supP′ |P| ≤(2ρ0)k and (9) follows
using the minimum modulus principle. Note that actually the function g can be
deﬁned on P as g = f/P and it is analytic there. Given (z, w) ∈P′, apply the
sub-mean value property for subharmonic functions to get
log |g(z, w)| ≤1
2π

 2π
0
log |f (z + R0eiθ/2, w)| dθ
−1
2π

 2π
0
log |P(z + R0eiθ/2, w)| dθ
≤
(
sup
P
log |f |
)
+ k log 2
R0
.
The estimate on the mean value of the polynomial follows by considerations
analogous to (8).
⊓⊔
Next we describe how Bernstein exponents rule the application of Lemma 4.1.
Lemma 4.2 Let f be analytic on B(0, 1), M ≥supB(0,1) log |f |, m = M −B,
B ≫1, e1 a m-regular direction for f at 0 (recall Deﬁnition 2.4), and e2 another
non-collinear direction. With a slight abuse of notation, we denote by f (z, w) the
function in the new coordinates with respect to the basis e1, e2. Then there exists a
circle ρ0 = {|z| = ρ0}, 1/8 < ρ0 < 1/4, and r1 = exp (−CB), with C > 1 an
absolute constant, such that
inf
ρ0×D(0,r1)
log |f | ≥exp(M −CB).
(11)
In particular, Lemma 4.1 applies for f (z, w) with this choice of ρ0 and r1, as well
as with k ≲B and δ ≥M −CB.
Proof Since e1 is a m-regular direction, there exists z1, |z1| = 1/4, such that
log |f (z1, 0)| ≥m. Due to Cartan’s estimate, one has
log |f (z, 0)| ≥M −C(M −m) = M −CB
(12)
for any z ∈D(0, 1/4) \ B, where B ∈Car1

C′, C′B

, C′ ≫1. As a consequence
of the deﬁnition of Car1 sets, we can choose 1/8 < ρ0 < 1/4 such that B∩ρ0 = ∅.
Then
|f (z, 0)| ≥exp (M −CB)
(13)
for any z ∈ρ0. Note that due to Cauchy’s estimates
|f (z, w) −f (z, 0)| ≲eM|w|

112
M. Goldstein et al.
for any z ∈D(0, 1/2), w ∈D(0, 1/2). Taking into account (13), one obtains
|f (z, w)| > exp (M −CB)
for any z ∈ρ0, provided w ∈D(0, r1), r1 = exp (−CB), with C large enough (of
course, C is larger than in (13)). This proves (11) and allows us to apply Lemma 4.1
as stated. For the bound on the degree of the Weierstrass polynomial note that by
Jensen’s formula applied to f (z, 0), z ∈D(z1, 1/2),
k ≤# {z ∈D(0, 1/4) : f (z, 0) = 0} ≤# {z ∈D(z1, 1/2) : f (z, 0) = 0} ≲B.
⊓⊔
Remark 4.3
(1) Due to Lemma 2.5, we will always apply the previous lemma with B ≃
Bf (1/4; 0, 1). This is how the Bernstein exponent determines the size of the
polydisk on which we have the Weierstrass factorization.
(2) If we are given two functions f1, f2 satisfying the assumptions of Lemma 4.2
with the same M and B, then it is clear from the proof of the lemma that we can
arrange for the conclusion to hold for both functions with the same choice of
ρ0 and r1. Indeed, one only needs to choose ρ0 such that ρ0 ∩(B1 ∪B2) = ∅,
where Bi are the Cartan sets needed to guarantee (12) for fi.
5
Resultants
We brieﬂy recall the deﬁnition of the resultant of two univariate polynomials and
some of the basic properties that we’ll use. Let f (z) = anzn +an−1zn−1 +· · · +a0,
g(z) = bmzm + bm−1zm−1 + · · · + b0 be polynomials, ai, bj ∈C, an ̸= 0, bm ̸= 0.
Let ζi, 1 ≤i ≤n and ηj, 1 ≤j ≤m be the zeros of f (z) and g(z), respectively.
The resultant of f and g is deﬁned as follows:
Res(f, g) = am
n bn
m

i,j
(ζi −ηj) = (−1)mnbn
m

j
f (ηj) = (−1)mnam
n

i
g(ζi).
(14)
The resultant Res(f, g) can be expressed explicitly in terms of the coefﬁcients (see
[18]):

Cartan Covers and Doubling Bernstein-Type Inequalities
113
Res(f, g) =

m
+
,-
.
an
0
· · ·
an−1 an
· · ·
an−2 an−1 · · ·
· · ·
· · ·
· · ·
· · ·
· · ·
· · ·
· · ·
· · ·
· · ·
a0
a1
0
a0
n
+
,-
.
bm
0
· · · 0
bm−1 bm
· · · · · ·
bm−2 bm−1 · · · · · ·
· · ·
· · ·
· · · · · ·
· · ·
· · ·
· · · · · ·
· · ·
· · ·
· · · · · ·

(15)
Lemma 5.1 Let f, g, ζi, ηj as above. Set
tf = min(|an|, 1),
tg = min(|bm|, 1),
Tf = max
i (max |ai|, 1),
Tg = max
j (max |bj|, 1),
Rf = t−1
f Tf m,
Rg = t−1
g Tgn.
The following statements hold.
(0) max |ζi| ≤Rf ,
max |ηj| ≤Rg.
(1) If
Res(f, g)
 < δmtn
g ,
0 < δ < 1,
then there exists j such that
f (ηj)
 < δ.
In particular, there exists |z| ≤Rg such that max(
f (z)
,
g(z)
) < δ.
(2) If there exists z such that with s = max(m, n), t = min(tf , tg) holds
max[
f (z)
,
g(z)
] < tδs,
0 < δ < 1,
then
Res(f, g)
 < t2s(2R)s2δ,
R = max(Rf , Rg).
Proof (0) follows by noting that, for example,
|an||ζi|n ≤(max |ai|)(|ζi|n−1 + · · · + |ζi| + 1) ≤(max |ai|)n max(|ζi|n−1, 1).

114
M. Goldstein et al.
(1) follows by contradiction from (14). For (2) note that there must exist ζi0, ηj0
such that |z −ζi0| < δ, |z −ηj0| < δ and therefore, using (0) and (14),
|Res(f, g)| ≤t2s(2R)s2−1|ζi0 −ηj0| < t2s(2R)s2δ.
⊓⊔
6
Reﬁnement of the Assumption (1)
We give a simple argument showing that by making some small adjustments, we
actually have K1 ≤H C
0 in (1).
Lemma 6.1 Using the notation and assumptions of Theorem C, we have that
N(F, ε0/2) ∩B(0, 1/2) ∈Car2,0(H1/2, H C
0 )
where C is some large absolute constant.
Proof Let fi,N be the degree N Taylor polynomials (at the origin) associated with
fi, i = 1, 2 (recall that F = (f1, f2)). Since Mfi(0, 1) ≤0, a standard application
of the Cauchy estimates yields that
|fi −fi,N| < ε0/100
for N = C log ε−1
0
= CH0, C ≫1. Let FN = (f1,N, f2,N). We have
N(F, ε0/2) ∩B(0, 1/2) ⊂N(FN, 3ε0/4) ∩B(0, 1/2)
⊂N(F, ε0) ∩B(0, 1/2).
(16)
The set N(FN, 3ε0/4) ∩B(0, 1/2) is semialgebraic of degree less than CN, and
therefore it has at most NC connected components. We refer to [2, Ch. 9] for a brief
review of semialgebraic sets and their properties. It follows from our assumptions
that N(FN, 3ε0/4)∩B(0, 1/2) is covered by less than K1 balls of radius exp(−H1).
Therefore, each connected component of N(FN, 3ε0/4) ∩B(0, 1/2) can be covered
by just one ball of radius smaller than
CK1 exp(−H1) ≤exp(−H1/2)
(recall that log K1 ≪H1) and so
N(FN, 3ε0/4) ∩B(0, 1/2) ∈Car2,0(H1/2, NC).
The conclusion now follows from (6).
⊓⊔

Cartan Covers and Doubling Bernstein-Type Inequalities
115
7
Proofs of Theorems A, B, and C
We start with the proof of Theorem C.
Proof of Theorem C Take v0 = (z0, w0) ∈B(0, 1/4). By our assumptions
Bfi(1/4; v0, 1/4),
Mfi(v0, 1/4) ≤0.
Due to Lemma 2.5, we can ﬁnd unit vectors e1, e2, |⟨e1, e2⟩| ≪1, that are m-
regular at v0 for both f1, f2 restricted to B(v0, 1/4), with m = −CB0, C ≫
1. Then Lemma 4.2 applies to both f1, f2 and to both directions e1, e2. As in
Lemma 4.2, with a slight abuse of notation, we denote by fi(z, w) the functions in
the coordinates with respect to the basis e1, e2 centered at v0 and with the obvious
rescaling needed to apply the lemma. Applying Lemma 4.2 (see also Remark 4.3)
in the direction of e1 (and e2 as the choice of non-collinear direction), we can write
fi(z, w) = Pi(z, w)gi(z, w),
Pi(z, w) = zki + ai,ki−1(w)zki−1 + · · · + a0(w)
on P := D(0, ρ0) × D(0, r1), 1/8 < ρ0 < 1/4, r1 = exp(−CB0), where the
coefﬁcients ai,j(w) are analytic on D(0, r1), gi are analytic and non-vanishing on
P, the polynomials Pi(·, w) and w ∈D(0, r1) have no zeroes in C \ D(0, ρ0), and
ki ≲B0. Furthermore, using part (d) of Lemma 4.1,
−B0 ≲inf
P
log
gi
 ≤sup
P
log
gi
 ≲B0.
(17)
Let
R(w) = Res (P1(·, w), P2(·, w)) .
Note that by (15), R is analytic on D(0, r1). Since we chose v0 ∈B(0, 1/4), the
polydisk P is a subset of B(0, 1/2), as a set in the standard coordinates. This allows
to use the hypothesis to guarantee that there exist points vj = (zj, wj) (expressed
in the e1, e2 coordinates), 1 ≤j ≤J ≤K1 such that for
(z, w) ∈P \
⎛
⎝
J
j=1
B(vj, C exp(−H1))
⎞
⎠
we have
max(|f1(z, w)|, |f2(z, w)|) ≥exp(−H0)/
√
2
and by (17)

116
M. Goldstein et al.
max(|P1(z, w)|, |P2(z, w)|) ≳exp(−H0 −CB0).
(18)
Note that we used the radius C exp(−H1) instead of exp(−H1) to account for the
distortion under the change of coordinates. Since we are assuming that H1 ≫B0
and log K1 ≪H1, we can ﬁnd
w ∈D(0, r1/4) \
J
j=1
D(wj, C exp(−H1)).
For any such w (18) holds for any z ∈D(0, ρ0) and by part (1) of Lemma 5.1
log |R(w)| ≳−B0H0 −B2
0 ≳−B0H0.
Note that by the deﬁnition of the resultant (14), we have supD(0,r1) |R(w)| ≤1.
Take H ≫1. Applying Cartan’s estimate, we get
log |R(w)| ≳−HB0H0
for any
w ∈D(0, r1/4) \ B,
B =

1≤k≤K
D(w′
k, r1 exp(−H)),
K ≲B0H0.
By part (2) of Lemma 5.1,
max(|P1(z, w)|, |P2(z, w)|) ≥exp(−CHB2
0H0)
for any w ∈D(0, r1/4) \ B and z ∈C. Using (17), we get
|F(z, w)| ≳exp(−CHB2
0H0 −CB0) ≥exp(−HB2
0H0)
(19)
for any w ∈D(0, r1/4) \ B and z ∈D(0, ρ0). Applying Lemma 4.2 again in the
direction of e2 (and with e1 as the choice of non-collinear direction) and repeating
the above argument, we get that there exist 1/8 < ˜ρ0 < 1/4, ˜r1 = exp(−CB0),
such that (19) also holds for any z ∈D(0, ˜r1/4) \ ˜B and
w ∈D(0, ˜ρ0),
˜B =

1≤ℓ≤L
D(z′
ℓ, ˜r1 exp(−H)),
L ≲B0H0,
In particular, (19) holds for any
(z, w) ∈D(0, ˜r1/4) × D(0, r1/4) \
⎛
⎝
k,ℓ
D(z′
ℓ, ˜r1 exp(−H)) × D(w′
k, r1 exp(−H))
⎞
⎠.

Cartan Covers and Doubling Bernstein-Type Inequalities
117
Going back to standard coordinates, we obtained that there exist less than CB2
0H 2
0
points v′
j such that (19) holds for any
(z, w) ∈B(v0, exp(−CB0)) \
⎛
⎝
j
B(v′
j, exp(−H))
⎞
⎠.
Since (19) holds outside the initial Car2,0 set, we only need to apply the above
argument on K1 balls covering the initial set to get the conclusion.
⊓⊔
We will need the following lemma for the proof of Theorem A.
Lemma 7.1 Let f be analytic on the ball B(0, 1), Z = {v ∈B(0, 1) : f (v) = 0}.
Let B ∈Car2,0(H1, K1), H ≫1, log K ≪H. If 0 ∈Z, then
B(0, 1/4) ∩Z \ B ̸= ∅.
Proof We argue by contradiction. Assume B(0, 1/4) ∩Z ⊂B. By the assumptions
on B, we can ﬁnd 1/8 < r < 1/4 such that B ∩B(0, r) is compactly contained
in B. Therefore the zero set of f restricted to B(0, r) is compactly contained in
B(0, r) and Z∩B(0, r) is a compact analytic variety in C2. This cannot be, because
compact analytic varieties in C2 are necessarily ﬁnite sets (see, e.g., [5]) and analytic
functions of several variables cannot have isolated zeros (recall that 0 ∈Z).
⊓⊔
Proof of Theorem A
(1) Take v0 ∈B(0, 1/8) ∩Z, Z = {f2 = 0}, 0 < R ≤1/4. Let H =
C max(log R−1, C0) with C large enough (recall that C0 = log(K1B2
0H 2
0 )).
By Theorem C, we have
|F(v)| ≥exp(−HB2
0H0)
for all v
∈B(0, 1/4) \ B, B ∈Car2,0(H, K), K
≲K1B2
0H 2
0 . Note
that B(v0, R) ⊂B(0, 1/4) and our choice of H is such that we can apply
Lemma 7.1 to f2 restricted to B(v0, R) and the above B (after an obvious
rescaling). So, there exists v1 ∈B(v0, R/4) ∩Z \ B. Note that we have
|f1(v1)| = |F(v1)| ≥exp(−HB2
0H0)
and therefore
Mf1(Z, v0, R/4) ≥−HB2
0H0.
The ﬁrst statement now follows by recalling that
Mf1(Z, v0, R) ≤Mf1(0, 1) ≤0.

118
M. Goldstein et al.
(2) Take v0 ∈B(0, 1/8). By our assumptions
Bf2(1/4; v0, 1/4) ≤B0,
Mf2(v0, 1/4) ≤0.
Due to Lemma 2.5, we can ﬁnd a unit vector e1, that is m-regular at v0 for
f2 restricted to B(v0, 1/4), with m = −CB0, C ≫1. Let e2 be another unit
vector orthogonal to e1. As in Lemma 4.2, with a slight abuse of notation, we
denote by fi(z, w) the functions in the coordinates with respect to the basis
e1, e2 centered at v0 and with the obvious rescaling needed to apply the lemma.
Applying Lemma 4.2 in the direction of e1 (with e2 as the choice of non-
collinear direction), we can write
f2(z, w) = P(z, w)g(z, w),
P(z, w) = zk + ak−1(w)zk−1 + · · · + a0(w)
on P := D(0, ρ0) × D(0, r1), 1/8 < ρ0 < 1/4, r1 = exp(−CB0), where the
coefﬁcients aj(w) are analytic on D(0, r1) and k ≲B0. Since we also have that
g is analytic and non-vanishing on P,
Z ∩P = ZP ∩P,
ZP := {(z, w) ∈C × D(0, r1) : P(z, w) = 0}.
It is well known (see [5]) that for any point (z, w) of the variety ZP , there exist
ε > 0, δ > 0 such that the following statements hold.
(i) If (z, w) is a regular point, then there exists an analytic function ζ : D(0, ε) →
D(0, δ) such that
ZP ∩(D(z, δ) × D(w, ε)) = {(z + ζ(w′ −w), w′) : w′ ∈D(w, ε)}.
(ii) If (z, w) is a singular point, then there exist integers pi ≥1 and analytic
functions ζi : D(0, ε) →D(0, δ), 1 ≤i ≤i0(z, w) ≤k, such that 
i pi ≤k
and
ZP ∩(D(z, δ) × D(w, ε)) =

i
{(z + ζi((w′ −w)
1
pi ), w′) : w′ ∈D(w, ε)}.
By compactness we can cover B(0, 1/8)∩Z by ﬁnitely many polydisks 1
2P (more
precisely, by their preimages under the change of variables we assumed above), and
in turn Z ∩1
2P can be covered by ﬁnitely many polydisks D(zj, δj) × D(wj, εj/8)
with (zj, wj) ∈ZP and εj, δj as above. We will also use ζj and ζi,j the functions
associated with (zj, wj). Let r0 > 0 be the minimum over all the εj needed to
cover B(0, 1/8) ∩Z. Near each (zj, wj), we will deﬁne local charts and show we
can control the Bernstein exponent of f1 in the local charts. The control over the
Bernstein exponent will follow from Theorem C and Proposition 3.2. To this end,

Cartan Covers and Doubling Bernstein-Type Inequalities
119
we take H = C(log r−1
0 )C0, with C ≫1 large enough, and we note that, with this
choice of H, Theorem C guarantees that
|F(z, w)| ≥exp(−HB2
0H0), ∀(z, w) ∈P \ (C × B)
(20)
where B is a union of disks with the sum of the radii much smaller than rk
0 (recall
that k ≲B0 ≪H0). To deﬁne the charts, we distinguish two cases.
(i) (zj, wj) is regular. Let
ψj(w) = (zj + ζj(w), wj + w), w ∈D(0, εj).
It follows from (20) that
Mf1◦ψj (0, 1/4) ≥−HB2
0H0.
By Proposition 3.2 (recall that Mf1(0, 1) ≤0), it is clear that
Bf1◦ψj (1/4; z, r) ≲H ≤C(f2)C0B2
0H0
when D(z, r) ⊂D(0, εj/8). This shows the conclusion of part (2) holds if we deﬁne
the local chart by rescaling ψj|D(0,εj /8).
(ii) (zj, wj) is singular. Let
ψi,j(w) = (zj + ζi,j(w), wj + wpi), w ∈D(0, εj).
It follows from (20) that
Mf1◦ψi,j (0, 1/4) ≥−HB2
0H0
(recall that pi ≤k), and therefore Proposition 3.2 guarantees that
Bf1◦ψi,j (1/4; z, r) ≲HB2
0H0 ≤C(f2)C0B2
0H0
when D(z, r) ⊂D(0, εj/8). This shows that the conclusion holds if corresponding
to each w ∈D(0, εj/8)\{0} we deﬁne a local chart by rescaling ψi,j|D(w,r), where
D(w, r) is the largest disk about w in D(0, εj/8) on which wpi is one to one.
Clearly the above charts cover reg Z ∩B(0, 1/8), and we can complete an atlas
of reg Z by adding charts whose ranges don’t intersect B(0, 1/8). This concludes
the proof.
⊓⊔
Next we give an example showing that the log R−1 is actually necessary in part
(1) of Theorem A.

120
M. Goldstein et al.
Example 7.2 Let
f1(z, w) = z2 + w,
f2(z, w) = zw,
Z = {f2 = 0}.
Let R ≪1, v0 = (R/4, 0). Then straightforward computations show that
sup
B(v0,R/4)∩Z
log |f1(z, w)| =
sup
|z−R/4|<R/4
log |z2| = log
R
2
2
,
and
sup
B(v0,R)∩Z
log |f1(z, w)| = max
(
sup
|z−R/4|<R
log |z2|,
sup
|w|2+(R/4)2<R2 log |w|
)
= max
(
log
5R
4
2
, log
√
15R
4
)
= log
√
15R
4
,
provided R is small enough (R < 1/2 is enough). Therefore,
Bf1(1/4; Z, v0, R) = C + log R−1.
Finally, we will prove Theorem B, but we ﬁrst establish an auxiliary result. To
this end we will need the following extension of the classical Bézout theorem.
Suppose we have a system of n complex polynomial equations fi(z1, ..., zn) = 0,
i = 1, .., n. Let Z1, . . . , Zs be the irreducible components of the variety deﬁned by
the system. Then
deg(Z1) + · · · + deg(Zs) ≤degf1 × · · · × degfn.
(21)
The authors are grateful to János Kollár and Mihnea Popa for pointing out this
version of the Bézout bound (for a more general result, see [13, Thm. 12.3]).
Lemma 7.3 Let f (z, w), g(z, w) be non-constant polynomials with no common
factors. Let ζ(w) be an analytic function on D(0, r0) such that
{(ζ(w), w) : w ∈D(0, r0)} ⊂reg{f (z, w) = 0}.
(22)
Then there exists at most one straight line L ⊂C through the origin such that
#{ξ ∈(−r0, r0) : g(ζ(ξ), ξ) ∈L} > (degf )2degg.
(23)
Proof Let L be a line through the origin. We ﬁrst argue that if (23) holds, then we
must have {g(ζ(ξ), ξ) : ξ ∈(−r0, r0)} ⊂L. Write

Cartan Covers and Doubling Bernstein-Type Inequalities
121
f (z, ξ) := P(x + iy, ξ) + iQ(x + iy, ξ) = ˆP (x, y, ξ) + i ˆQ(x, y, ξ)
where P, Q are the real and imaginary parts of f , and ˆP , ˆQ are real polynomials of
three real variables x, y, ξ. Clearly deg ˆP = deg ˆQ = degf . Similarly write
g(z, ξ) := U(x + iy, ξ) + iV (x + iy, ξ) = ˆU(x, y, ξ) + i ˆV (x, y, ξ).
Without loss of generality, we may assume that the line L is horizontal. If (23) holds,
then the system
ˆP = 0,
ˆQ = 0,
ˆV = 0
(24)
has more than deg ˆP × deg ˆQ × deg ˆV solutions vj = (xj, yj, ξj) with
ξj ∈(−r0, r0),
xj + iyj = ζ(ξj),
ξj1 ̸= ξj2.
Complexify the variables x, y, ξ, and let Z1, . . . , Zs be the irreducible components
of the complex variety deﬁned by the system (24). By the Bézout bound (21), there
exists a component Zk that contains at least two of the solutions vj and therefore
has dimension at least one. Let v0 be one of the solutions contained in Zk. We will
argue that there exists an analytic mapping
t →v(t) = (x(t), y(t), ξ(t)) ∈Zk, t ∈D(0, δ)
(25)
such that v(0) = v0 and ξ(t) is non-constant. By [21] we know that there exists
a neighborhood N of v0 in Zk, such that for any v ∈N \ {v0}, there exists
a one-dimensional irreducible variety V through both v and v0. Since V can be
parametrized by a Riemann surface (see [5, Prop. 6.2]), we get the existence of a
mapping of the form (25). If ξ(t) is constant, then by the uniqueness theorem (see
[5, Cor. 5.3.2]), we must have V ⊂{ξ = ξ0}. If this happens for all such mappings
obtained by choosing different v ∈N \ {v0}, then N ⊂{ξ = ξ0}, and by the
uniqueness theorem, Zk ⊂{ξ = ξ0}. This would contradict the fact that Zk contains
two of the solutions vj (recall that ξj1 ̸= ξj2). So we proved the existence of the
mapping (25) with the desired properties. We have
f (x(t) + iy(t), ξ(t)) = 0,
V (x(t) + iy(t), ξ(t)) = 0, t ∈D(0, δ).
By the assumption (22), we get
x(t) + iy(t) = ζ(ξ(t)),
provided we choose δ small enough. Therefore
V (ζ(ξ(t)), ξ(t)) = 0, t ∈D(0, δ)

122
M. Goldstein et al.
and since ξ(t) is non-constant, there exists ε > 0 so that
V (ζ(ξ), ξ) = 0, ξ ∈(ξ0 −ε, ξ0 + ε).
So V (ζ(ξ), ξ) = 0 for all ξ ∈(−r0, r0), that is, {g(ζ(ξ), ξ) : ξ ∈(−r0, r0)} ⊂L.
Now we can ﬁnish the proof by arguing by contradiction. If the conclusion
doesn’t hold, it follows that we have {g(ζ(ξ), ξ) : ξ ∈(−r0, r0)} ⊂L1 ∩L2 = {0}
and therefore the system f = g = 0 has inﬁnitely many solutions. By the classical
Bézout theorem, this would contradict the assumption that f and g don’t have
common factors.
⊓⊔
Proof of Theorem B Let Z1, . . . , Zs be the irreducible components of Z. Each
of them is the zero set of an irreducible factor of f2. Let f2,1, . . . , f2,s be such
irreducible factors. Fix k ∈{1, . . . , s} and (z0, w0) ∈reg Z ∩Zk. We can make a
change of variables (as in the proof of part (2) of Theorem A) such that (z0, w0) is
mapped to the origin, and we can ﬁnd an analytic function ζ : D(0, ε0) →D(0, δ0)
so that
φ(w) = (ζ(w), w), w ∈D(0, ε0)
is a chart for reg Z ∩Zk around the origin.
If f2,k divides f1, then f1 vanishes identically on Zk, and its Bernstein exponent
is 0 by convention (in any chart). So, we just need to treat the case when f2,k and f1
have no common factors. Let ψ(w) = f1(φ(w)). We claim that
Bψ(1/4; w0, R) ≤C(f2)degf1
(26)
provided D(w0, R) ⊂D(0, ε0/8). We will check this claim by using the previous
lemma and Proposition 3.2. Let a1, . . . , an be the zeros of ψ. Since f1 and f2,k are
co-prime, using the classical Bézout theorem, we have
n ≤degf2,k × degf1.
Factorize
ψ(w) = h(w)P(w),
P(w) =
n

k=1
(w −ak).
From the proof of Proposition 3.2 (see (7)), we have
Bψ(1/4; w0, R) ≤CR(Mh(0, 3ε0/4) −Mh(0, ε0/4)) + BP (1/4; w0, R).
Recall that BP (1/4; w0, R) ≤n log 4 ≤C(f2)degf1. So, to check the claim (26),
we just need to estimate Mh(0, 3ε0/4) −Mh(0, ε0/4). Without loss of generality,

Cartan Covers and Doubling Bernstein-Type Inequalities
123
we can assume h(0) = 1, and therefore Mh(0, ε0/4) ≥0. Since h does not vanish,
we have
h(w) = eu(w)+iv(w),
where u + iv is analytic and u, v are real valued. Then
M := Mh(0, 3ε0/4) =
sup
w∈D(0,3ε0/4)
|u(w)|.
Due to the Borel-Carathéodory estimate (see [19, Thm. 11.1.1]),
N :=
sup
w∈D(0,7ε0/8)
|v(w)| ≳M.
Choose | ˆw| = 7ε0/8 such that |v( ˆw)| ≥N/2 and at the same time no root ak falls
on the straight line through ˆw and the origin. This allows us to deﬁne the continuous
functions θk(ξ) := arg(ξ ˆw −ak) ∈[0, 2π], ξ ∈(−∞, +∞). Set
θ(ξ) =

1≤k≤n
θk(ξ).
Take θ ∈(0, 2π) arbitrary. We have
Im e−iθψ(ξ ˆw) = eu(ξ ˆw)|P(w)| sin(v(ξ ˆw) + θ(ξ) −θ).
It is clear form this formula that if N ≫n, then for any θ,
#{ξ ∈(−7ε0/8, 7ε0/8) : f1(ζ(ξ ˆw), ξ ˆw) ∈Lθ} ≥N/4,
where Lθ is the line of angle θ through the origin. This and Lemma 7.3 imply that
we must have
N ≲(degf2,k)2degf1.
Putting the above together, we have
Mh(0, 3ε0/4) −Mh(0, ε0/4) ≲C(f2)degf1,
which completes the proof of claim (26).
Finally, it is clear that the conclusion holds by choosing the charts to be rescaled
versions of φ|D(0,ε0/8), for each (z0, w0) ∈reg Z.
⊓⊔

124
M. Goldstein et al.
References
1. Biernacki, M.: Sur les fonctions multivalentes de ordre p. CR. Acad. Sci. (Paris) 203, 449–451
(1936)
2. Bourgain, J.: Green’s Function Estimates for Lattice Schrödinger Operators and Applications,
volume 158 of Annals of Mathematics Studies (Princeton University Press, Princeton, 2005)
3. Brudnyi, A.: On local behavior of holomorphic functions along complex submanifolds of CN.
Invent. Math. 173(2), 315–363 (2008)
4. Cartwright, M.L.: Some inequalities in the theory of functions. Math. Ann. 111, 98–118 (1935)
5. Chirka, E.M.: Complex Analytic Sets, volume 46 of Mathematics and Its Applications (Soviet
Series) (Kluwer Academic Publishers Group, Dordrecht, 1989)
6. Chulaevsky, V.A., Sina˘ı, Ya. G.: Anderson localization for the 1-D discrete Schrödinger
operator with two-frequency potential. Commun. Math. Phys. 125(1), 91–112 (1989)
7. Coman, D., Poletsky, E.A.: Transcendence measures and algebraic growth of entire functions.
Invent. Math. 170(1), 103–145 (2007)
8. Comte, G., Yomdin, Y.: Zeroes and rational points of analytic functions. Preprint
arXiv:1608.02455
9. Fefferman, C., Narasimhan, R.: Bernstein’s inequality on algebraic curves. Ann. Inst. Fourier
(Grenoble) 43(5), 1319–1348 (1993)
10. Fefferman, C., Narasimhan, R.: On the polynomial-like behaviour of certain algebraic func-
tions. Ann. Inst. Fourier (Grenoble) 44(4), 1091–1179 (1994)
11. Fefferman, C., Narasimhan, R.: A local Bernstein inequality on real algebraic varieties. Math.
Z. 223(4), 673–692 (1996)
12. Friedland, O., Yomdin, Y.: Doubling coverings of algebraic hypersurfaces. Pure Appl. Funct.
Anal. 2(2), 221–241 (2017)
13. Fulton, W.: Intersection Theory, volume 2 of Ergebnisse der Mathematik und ihrer Grenzgebi-
ete. 3. Folge. A Series of Modern Surveys in Mathematics [Results in Mathematics and Related
Areas. 3rd Series. A Series of Modern Surveys in Mathematics], 2nd edn. (Springer, Berlin,
1998)
14. Goldstein, M., Schlag, W.: Fine properties of the integrated density of states and a quantitative
separation property of the Dirichlet eigenvalues. Geom. Funct. Anal. 18(3), 755–869 (2008)
15. Goldstein, M., Schlag, W., Voda, M.: On localization and spectrum of multi-frequency quasi-
periodic operators (2016). Preprint
16. Goldstein, M., Schlag, W., Voda, M.: On the spectrum of multi-frequency quasi-periodic
Schrödinger operators at large coupling. Invent. Math. 217(2), 603–701 (2019)
17. Hayman, W.K.: Multivalent Functions, volume 110 of Cambridge Tracts in Mathematics, 2nd
edn. (Cambridge University Press, Cambridge, 1994)
18. Lang, S.: Algebra, volume 211 of Graduate Texts in Mathematics, 3rd edn. (Springer, New
York, 2002)
19. Levin, B. Ya.: Lectures on Entire Functions, volume 150 of Translations of Mathematical
Monographs (American Mathematical Society, Providence, 1996)
20. Roytwarf, N., Yomdin, Y.: Bernstein classes. Ann. Inst. Fourier (Grenoble) 47(3), 825–858
(1997)
21. Shiffman, B.: Local complex analytic curves in an analytic variety. Proc. Am. Math. Soc. 24,
432–437 (1970)

A Weighted Prékopa–Leindler Inequality
and Sumsets with Quasicubes
Ben Green, Dávid Matolcsi, Imre Ruzsa, George Shakan,
and Dmitrii Zhelezov
Dedicated to the memory of Jean Bourgain
Abstract We give a short, self-contained proof of two key results from a paper
of four of the authors. The ﬁrst is a kind of weighted discrete Prékopa–Leindler
inequality. This is then applied to show that if A, B ⊆Zd are ﬁnite sets and U is a
subset of a “quasicube”, then |A + B + U| ⩾|A|1/2|B|1/2|U|. This result is a key
ingredient in forthcoming work of the ﬁfth author and Pälvölgyi on the sum-product
phenomenon.
2000 Mathematics Subject Classiﬁcation Primary 11B30
BG and GS are supported by BG’s Simons Investigator Grant number 376201.
Dávid Matolcsi is supported by the ÚNKP-21-1 New National Excellence Program of the Ministry
for Innovation and Technology from the source of the National Research, Development and
Innovation Fund.
B. Green ()
University of Oxford, Oxford, UK
e-mail: ben.green@maths.ox.ac.uk
D. Matolcsi
Eötvös Loránd University, Budapest, Hungary
I. Ruzsa
Rényi Institute of Mathematics, Budapest, Hungary
G. Shakan
Centre de Recherches Mathématiques, Montréal, QC, Canada
D. Zhelezov
Radon Institute for Computational and Applied Mathematics RICAM, Linz, Austria
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
A. Avila et al. (eds.), Analysis at Large, https://doi.org/10.1007/978-3-031-05331-3_6
125

126
B. Green et al.
1
Introduction
Quasicubes. The notion of a quasicube  ⊆Zd is deﬁned inductively. When d =
1, a quasicube is simply a set of size two. For larger d,  is a quasicube if
1. π( ) = {x0, x1} is a set of size two, where π : Zd →Z is the coordinate
projection onto the ﬁnal coordinate, and
2. The ﬁbre  i :=  ∩π−1(xi) (considered as a subset of Zd−1) is a quasicube.
Thus, for instance, the usual cube {0, 1}d is a quasicube. Another example of a
quasicube with d = 2 is the set  = {(0, 0), (1, 0), (0, 1), (1, 2)}.
The following result is established in [3].
Theorem 1.1 Let A, B ⊆Zd be ﬁnite sets and suppose that U ⊆Zd is contained
in a quasicube. Then |A + B + U| ⩾|A|1/2|B|1/2|U|.
Our aim in this note is to give a short, self-contained proof of this result.
2
A Weighted Discrete Prékopa–Leindler Inequality
As in [3], we deduce Theorem 1.1 from a weighted discrete Prékopa–Leindler
inequality. Let a, b : Z →[0, ∞) be compactly supported functions. We deﬁne
the max-convolution
a∗b(n) := sup
m∈Z
a(n −m)b(m),
and we write
∥a∥2 :=
 
n
a(n)21/2,
∥b∥2 :=
 
n
b(n)21/2.
The following result is equivalent to [3, Theorem 11.1].
Proposition 2.1 Let a, b : Z →[0, ∞) be compactly supported functions and let
p ∈[0, 1]. Then we have

n
max(pa∗b(n), (1 −p)a∗b(n −1)) ⩾∥a∥2∥b∥2.
In the case p = 1
2, this is (2.4) in the paper of Prékopa [4], where it is used to
establish the one-dimensional case of what is now known as the Prékopa–Leindler
inequality (we will recall the statement of this below). We will proceed in the
opposite direction, deducing Proposition 2.1 from Prékopa–Leindler.

A Weighted Prékopa–Leindler Inequality and Sumsets with Quasicubes
127
Suppose that f, g : R →[0, ∞) are compactly supported, piecewise continuous
functions. Then the (one-dimensional) Prékopa–Leindler inequality states that

f ∗g ⩾2∥f ∥2∥g∥2,
(1)
where the max-convolution is deﬁned by
f ∗g(x) := sup
y∈R
f (x −y)g(y),
and the norms are the usual Lebesgue norms
∥f ∥2 :=

f 2
1/2
,
∥g∥2 :=

g2
1/2
.
(It should always be clear from context whether we are applying ∗or ∥· ∥2 with
functions on Z or functions on R.) We note that Brascamp and Lieb [1] found a
much shorter proof of (1) than the original (see also this survey of Gardner [2]).
Proof of Proposition 2.1 By continuity we may assume that p ∈(0, 1). Set λ :=
log( 1
p −1). Apply (1) with functions f, g deﬁned by
f (x) := eλ{x}a(⌊x⌋),
g(y) := eλ{y}b(⌊y⌋).
Let n ∈Z and 0 ⩽t < 1. Suppose that x + y = n + t. Then, since x −1 <
⌊x⌋⩽x, we have n −2 < ⌊x⌋+ ⌊y⌋< n + 1, or in other words ⌊x⌋+ ⌊y⌋= n −1
or n. If ⌊x⌋+ ⌊y⌋= n −1, then
f (x)g(y) ⩽eλ(t+1)a∗b(n −1),
while if ⌊x⌋+ ⌊y⌋= n, then
f (x)g(y) ⩽eλta∗b(n).
Therefore
f ∗g(n + t) ⩽eλt max(a∗b(n), eλa∗b(n −1)).
Integrating over t ∈[0, 1) and then summing over n ∈Z yield

f ∗g ⩽eλ −1
λ

n
max(a∗b(n), eλa∗b(n −1)).
(2)
On the other hand,

128
B. Green et al.
∥f ∥2
2 = e2λ −1
2λ
∥a∥2
2,
∥g∥2
2 = e2λ −1
2λ
∥b∥2
2.
Substituting into (1) gives

n
max(a∗b(n), eλa∗b(n −1)) ⩾(eλ + 1)∥a∥2∥b∥2.
Recalling the choice of λ (thus p =
1
eλ+1), the proposition follows.
⊓⊔
3
Proof of the Main Theorem
The arguments of this section are all in [3], but there they form part of a more
general framework. Here we provide a self-contained account tailored to the speciﬁc
purpose of proving Theorem 1.1.
Proof of Theorem 1.1 We proceed by induction on d. The proof of the inductive
step also proves the base case d = 1.
Suppose that U is contained in a quasicube  ⊂Zd. Suppose that π( ) =
{x0, x1}, where π : Zd →Z is projection onto the last coordinate. Since the
inequality is translation-invariant, we may assume that x0 = 0 and x1 = q > 0.
Suppose ﬁrst that q = 1.
Let Ai := A ∩π−1(n) be the ﬁbre of A above n, and similarly for B. The set
U has just two ﬁbres U0, U1, and, by the deﬁnition of quasicubes, they are both
contained in quasicubes of dimension d −1.
Observe that the ﬁbre of A + B + U above n contains Ax + By + U0 whenever
x + y = n and Ax + By + U1 whenever x + y = n −1. By induction,
|Ax + By + U0| ⩾|Ax|1/2|By|1/2|U0|,
|Ax + By + U1| ⩾|Ax|1/2|By|1/2|U1|,
and so the ﬁbre (A + B + U)n of A + B + U above n has size at least
max

|U0| max
x+y=n |Ax|1/2|By|1/2, |U1|
max
x+y=n−1 |Ax|1/2|By|1/2
.
This is equal to
|U| max

pa∗b(n) + (1 −p)a∗b(n −1)

,

A Weighted Prékopa–Leindler Inequality and Sumsets with Quasicubes
129
where p := |U0|/|U|, a(x) := |Ax|1/2 and b(y) := |By|1/2. Summing over n and
applying Proposition 2.1, we obtain
|A + B + U| =

n
|(A + B + U)n|
⩾|U|

n
max

pa∗b(n) + (1 −p)a∗b(n −1)

⩾|U|∥a∥2∥b∥2 = |U||A|1/2|B|1/2.
This proves the result when q = 1. Suppose now that q is arbitrary, and foliate
A = 
r∈Z/qZ Ar, B = 
s∈Z/qZ Bs, where Ar := {a ∈A : π(a) ≡r(mod q)}
and similarly for Bs. Let r∗be such that |Ar| ⩽|Ar∗| for all r, and s∗be such that
|Bs| ⩽|Bs∗| for all s.
The sets Ar∗+Bs +U are disjoint as s varies, and so by the case q = 1 (rescaled),
we have
|A + B + U| ⩾

s
|Ar∗+ Bs + U| ⩾|U||Ar∗|1/2 
s
|Bs|1/2.
(3)
Similarly,
|A + B + U| ⩾|U||Bs∗|1/2 
r
|Ar|1/2.
(4)
Taking products of (3), (4) and using
|Ar∗|1/2 
r
|Ar|1/2 ⩾

r
|Ar| = |A|,
|Bs∗|1/2 
s
|Bs|1/2 ⩾

s
|Bs| = |B|,
the result follows.
⊓⊔
References
1. Brascamp, H.J., Leib, E.H.: On extensions of the Brunn-Minkowski and Prékopa-Leindler
theorems, including inequalities for log concave functions, and with an application to the
diffusion equation. J. Funct. Anal. 22(4), 366–389 (1976)
2. Gardner, R.: The Brunn-Minkowski inequality. Bull. Am. Math. Soc. 39(3), 355–405 (2002)
3. Matolcsi, D., Ruzsa, I.Z., Shakan, G., Zhelezov, D.: An analytic approach to cardinalities of
sumsets. Preprint
4. Prékopa, A.: Logarithmic concave measures with application to stochastic programming. Acta
Sci. Math. (Szeged) 32, 301–316 (1971)

Equidistribution of Afﬁne Random
Walks on Some Nilmanifolds
Weikun He, Tsviqa Lakrec, and Elon Lindenstrauss
Dedicated to the memory of Jean Bourgain
Abstract We study quantitative equidistribution in law of afﬁne random walks
on nilmanifolds, motivated by a result of Bourgain, Furman, Mozes, and the
third named author on the torus. Under certain assumptions, we show that a
failure to having fast equidistribution is due to a failure on a factor nilmanifold.
Combined with equidistribution results on the torus, this leads to an equidistribution
statement on some nilmanifolds such as Heisenberg nilmanifolds. In an appendix we
strengthen results of de Saxce and the ﬁrst named author regarding random walks
on the torus by eliminating an assumption on Zariski connectedness of the acting
group.
1
Introduction
In this paper we consider random walks on compact nilmanifolds by automorphisms
of the nilmanifolds as well as by afﬁne maps. Recall that a nilmanifold is a space of
the form X = N/, where N is a connected simply connected nilpotent Lie group
and  < N is a lattice (which in a nilpotent Lie group is necessarily cocompact;
cf. [18]). An automorphism of X is deﬁned to be the homeomorphism of X induced
by a Lie group automorphism of N that preserves ; we denote the group of all
The authors are supported by ERC 2020 grant HomDyn (grant no. 833423). W.H. is also supported
by KIAS Individual Grant (no. MG080401).
W. He
Korea Institute for Advanced Study, Seoul, Republic of Korea
e-mail: heweikun@kias.re.kr
T. Lakrec · E. Lindenstrauss ()
Einstein Institute of Mathematics, The Hebrew University of Jerusalem, Jerusalem, Israel
e-mail: elon@math.huji.ac.il
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
A. Avila et al. (eds.), Analysis at Large, https://doi.org/10.1007/978-3-031-05331-3_7
131

132
W. He et al.
such automorphisms by Aut(X). An afﬁne transformation on X is the composition
of an automorphism of X by left translation by an element of N; the group of afﬁne
transformations of X, denoted by Aff(X), is the semidirect product Aut(X) ⋉N.
The projection Aff(X) →Aut(X) will be denoted by θ.
Given a Borel probability measure μ on Aut(X) (or more generally Aff(X)) and
a starting point x ∈X, we can deﬁne a random walk by successively applying to
x a sequence of elements g1, g2, . . . each gi chosen i.i.d according to μ. Thus the
distribution of the random walk after n steps, i.e., of the random element gn...g1x in
X, is given by μ∗n ∗δx.
In this situation, Bekka and Guivarc’h give a sufﬁcient and necessary condition
for the random walk deﬁned by μ to have a spectral gap on L2(X):
Theorem A (Bekka-Guivarc’h [2, Theorem 1]) Let X = N/ be a nilmanifold
and let H be a countable subgroup of Aff(X). The following are equivalent
(i) The action of H on X = N/ has a spectral gap.
(ii) The action of H on T = N/[N, N] has a spectral gap.
(iii) There is no non-trivial H-invariant factor torus T ′ of T such that the projection
of H ⊂Aff(X) to Aut(T ′) is virtually abelian.
Recall for a torus T = V/ where V is an Euclidean space and  is a lattice in
V ; a factor torus is some T ′ = T /S where S is a subtorus of T (i.e., S = W/(W ∩)
for W a rational linear subspace of V relative to the rational structure deﬁned by ).1
If H is some subgroup of Aff(T ), then the factor torus T ′ is said to be H-invariant if
W is invariant under θ(H), equivalently if the action of H on T induces an action of
H on T ′ so that the projection map from T to T ′ is H-equivariant. For a nilmanifold
X = N/, the quotient N/[N, N] is a torus, called the maximal torus factor of
X.
When these equivalent conditions in Theorem A are satisﬁed, for all but a set
of x of exponentially small measure, the random walk gn...g1x emanating from
x is exponentially close to being equidistributed. The purpose of this paper is to
understand the random walk gn...g1x starting from any x ∈X.
Under certain assumptions on μ, that are substantially stronger than those in
Theorem A, we show that either the random walk equidistributes, namely, μ∗n ∗δx
converges to the Haar measure mX on X in the weak-∗topology or the random walk
is trapped in a proper closed set invariant under the group generated by Supp(μ).
Furthermore, the equidistribution result is quantitative. Informally, we show that if
the equidistribution is not fast, it is because the random walk is close to a “small”
orbit.
1 Note that ﬁnite index quotients are not considered factor tori under this deﬁnition.

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
133
1.1
Quantitative Equidistribution
Similar to the spirit of Theorem A, we aim to prove that if a random walk on a
nilmanifold does not equidistribute, it is because the projected random walk on a
factor torus does not equidistribute. This leads to the following deﬁnitions.
Consider a nilmanifold X = N/. We ﬁx a Riemannian distance on X. For
α ∈(0, 1), let C0,α(X) denote the space of α-Hölder continuous functions on X,
equipped with the norm
∥f ∥0,α = ∥f ∥∞+ sup
x̸=y∈X
|f (x) −f (y)|
d(x, y)α
.
For ν and η Borel measures on X, recall that the α-Wasserstein distance between
them is deﬁned by
Wα(ν, η) =
sup
f ∈C0,α(X):∥f ∥0,α≤1


X
f dν −

X
f dη
 .
Let T = V/ be a torus of dimension d. We choose an identiﬁcation Zd with its
group of unitary characters via some isomorphism a →χa. Each closed subgroup
L of T is uniquely determined by its dual
L∗= { a ∈Zd | L ⊂ker χa }.
Deﬁnition 1 A closed subgroup L of a torus T is said to have height ≤h if its dual
L∗⊂Zd can be generated by integer vectors of norm ≤h.
Remark This notion depends on the choice of the isomorphism from Zd to the group
of unitary characters. For any torus we encounter in this paper, we assume such
choice is implicitly ﬁxed in advance.
For the next two deﬁnitions, we will denote by T = N/[N, N] the maximal
torus factor of X and by π : X →T the canonical projection.
Deﬁnition 2 Let λ > 0, C > 1, and α ∈(0, 1] be parameters. Let μ be a Borel
probability measure on a Aut(X), and let  = ⟨Supp(μ)⟩. We say that the μ-induced
random walk on X satisﬁes (C, λ, α)-quantitative equidistribution if the following
holds for any integer m ≥1 and any t ∈(0, 1
2). Assume
m ≥C log 1
t
and
Wα(μ∗m ∗δx, mX) > t.
Then there exists a point x′ ∈X such that
(i) d(x, x′) ≤e−λm
(ii) π(x′) lies in a proper closed -invariant subgroup of T of height ≤t−C

134
W. He et al.
In the case where  acts irreducibly on T (i.e.,  acts irreducibly on N/[N, N] over
Q), the condition (ii) can be replaced by
(ii’) π(x′) consists of rational points of denominator ≤t−C
In the situation of an afﬁne random walk, the deﬁnition needs to be adjusted. We
ﬁx a left-invariant Riemannian distance on the Lie group Aff(X).
Deﬁnition 3 Let λ > 0, C > 1, and α ∈(0, 1] be parameters. Let μ be a ﬁnitely
supported Borel probability measure on Aff(X). We say that the μ-induced random
walk on X satisﬁes (C, λ, α)-quantitative equidistribution if the following holds for
any integer m ≥1 and any t ∈(0, 1
2). Assume
m ≥C log 1
t
and
Wα(μ∗m ∗δx, mX) > t.
Then there exist a point x′ ∈X and a closed subgroup H ′ ⊂Aff(X) such that
(i) d(x, x′) ≤e−λm
(ii) d(g, H ′) ≤e−λm for every g ∈Supp(μ)
(iii) π(H ′x′) −π(x′) lies in a proper closed θ(H ′)-invariant subgroup of T of
height ≤t−C
Here, we are thinking of H ′ as generated by e−λm-perturbations of elements of
Supp(μ). Since Aut(X) is discrete, the perturbation only happens on the translation
part. In particular, we will have θ(H ′) = θ(H) where H = ⟨Supp(μ)⟩. Again, if
θ(H) acts irreducibly on T , then the condition (iii) can be replaced by
(iii’) π(H ′x′) −π(x′) consists of rational points of denominator ≤t−C
In both the linear and afﬁne case, we say that the μ-induced random walk on
X satisﬁes (λ, α)-quantitative equidistribution if it satisﬁes (C, λ, α)-quantitative
equidistribution for some constant C.
Remark For 0 < α < α′ ≤1, we have Wα′(ν, η) ≤Wα(ν, η) for any measures ν
and η. Hence, (C, λ, α)-quantitative equidistribution implies (C, λ, α′)-quantitative
equidistribution for any α′ ∈(α, 1].
1.2
Statement of the Main Result
Let μ be a Borel probability measure on a Lie group H. If H acts on an Euclidean
space Z via θZ : H →GL(Z), we deﬁne the essential exponential growth rate of
the action on Z to be the quantity
τZ(μ) = inf
κ>0 lim sup
m→+∞
1
m min
#
log #A | A ⊂Aut(Z) and (θZ)∗μ∗m(A) ≥1−e−κm $
.

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
135
Clearly, if (θZ)∗μ is ﬁnitely supported,
τZ(μ) ≤
lim
m→+∞
1
m log

# Supp

(θZ)∗μ∗m
.
Let H ↷(X, mX) be a probability measure preserving action of H on a compact
space X. Let (UX, L2(X, mX)) denote the corresponding Koopman representation.
Let π : (X, mX) →(Y, mY ) be a factor, i.e., π∗mX = mY , H acts on (Y, mY ), and
π is H-equivariant. By composing with π, we can embed L2(Y, mY ) in L2(X, mX)
as an H-invariant subspace. Let UX,Y be the restriction of UX to the orthogonal
complement of L2(Y, mY ) in L2(X, mX). For a Borel probability measure μ on H,
deﬁne
σX,Y (μ) = −
lim
m→+∞
1
m log∥UX,Y (μ)m∥.
We say a measure μ on Aff(X) has a ﬁnite exponential moment if there exists
β > 0 such that

Aff(X)
LipX(g)β dμ(g) < +∞,
(1)
where for g ∈Aff(X),
LipX(g) =
sup
x,x′∈X, x̸=x′
d(gx, gx′)
d(x, x′) .
To keep track of the parameter β, we say more precisely that μ has a ﬁnite β-
exponential moment.
Theorem 1.1 Let μ be a probability measure on Aff(X) having a ﬁnite β-
exponential moment for some β > 0. Let  denote the subgroup generated by the
support of θ∗μ. Assume that there exists a rational -invariant connected central
subgroup Z ⊂N such that
τZ(μ) < 2σX,Y (μ)
(2)
where Y = N/(Z) is the corresponding factor nilmanifold.
If the μ-induced random walk on Y satisﬁes (λ, α)-quantitative equidistribution
for some λ > 0 and 0 < α ≤min{1, β}, then the μ-induced random walk on X
satisﬁes (λ′, α)-quantitative equidistribution for any λ′ ∈(0, λ).
Note that when the equivalent conditions in Theorem A hold for X and H =
⟨Supp(μ)⟩, we have σX,Y (μ) > 0. In some special situations, for instance, if θZ(H)
is a virtually nilpotent group, we have easily τZ(μ) = 0. Thus, in these situations,
Theorem 1.1 applies and reduces the problem of quantitative equidistribution on X

136
W. He et al.
to whether there is one on Y, a nilmanifold of smaller dimension. The idea is that
this will eventually reduce to the case of random walks on a torus, where much more
is known.
We believe that a result akin to Theorem 1.1 should hold more generally with the
assumption (2) relaxed to σX,Y (μ) > 0, with an appropriate (relative) irreducibility
assumption, e.g.,
Conjecture 1.2 Let μ be a probability measure on Aff(X) having a ﬁnite β-
exponential moment for some β > 0. Let H denote the subgroup generated by
Supp(μ) and  = θ(H). Assume that there exists a rational -invariant connected
central subgroup Z ⊂N with corresponding factor nilmanifold Y = N/(Z) so
that
(i) σX,Y (μ) > 0.
(ii) For any ﬁnite index subgroup H ′ < H, and any proper H ′-invariant afﬁne
subnilmanifold X′
⊂
X, the projection of X′ to Y is a proper afﬁne
subnilmanifold of Y.
(iii) The μ-induced random walk on Y satisﬁes (λ, α)-quantitative equidistribution
for some λ > 0 and 0 < α ≤min{1, β}.
Then the μ-induced random walk on X satisﬁes (λ′, α)-quantitative equidistribution
for any λ′ ∈(0, λ).
1.3
The Case of a Torus
Previous works [6, 7, 14–16] on the case of a torus have been conducted by
Bourgain, Furman, Mozes, Boyer, Saxcé, and the authors of the present paper. The
most general result known when this paper is written can be summarized as follows.
Recall that if μ is a Borel probability measure on GLd(R), the top Lyapunov
exponent of μ is
λ1,Rd(μ) =
lim
n→+∞
1
n

log∥g∥dμ∗n(g).
Theorem B ([6, 14, 15]; cf. Appendix B) Let X = Rd/Zd for some d ≥2. Let μ
be a probability measure on Aut(X) having ﬁnite exponential moment. Denote by
 ⊂GLd(Z) the subgroup generated by Supp(μ).
Assume that the action of  on Rd is strongly irreducible. Then the μ-induced
random walk on X satisﬁes (λ, α)-quantitative equidistribution for any λ in the
range (0, λ1,Rd(μ)) and any α ∈(0, 1].
Note that the assumption that  ↷Rd is strongly irreducible implies that X
itself is the only non-trivial -invariant factor torus. Thus, a proper -invariant
closed subgroup of X is a ﬁnite set of rational points. Its height controls the size
of denominators.

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
137
Theorem C ([7, 16]; cf. Appendix B) Let X = Rd/Zd for some d ≥2. Let μ be
a ﬁnitely supported probability measure on Aff(X). Denote by  ⊂GLd(Z) the
subgroup generated by Supp(θ∗μ).
Assume that the action of  on Rd is strongly irreducible. Then given λ ∈
(0, λ1,Rd(θ∗μ)) and α ∈(0, 1], there exists C = C(θ∗μ, λ, α) such that the μ-
induced random walk on X satisﬁes (C, λ, α)-quantitative equidistribution.
Note that the constant C depends only on θ∗μ and not on the translation part of the
elements in Supp(μ).
Note that the statements of Theorem B and Theorem C are somewhat stronger
than those in [15] and [16], in that there is no assumption that the Zariski closure of
 is connected. In Appendix B we explain how this assumption can be eliminated.
1.4
Consequences of the Main Theorem
Assume that there is a ﬁltration
1 = Z0 ⊂Z1 ⊂· · · ⊂Zl−1 ⊂Zl = N
of rational closed connected subgroups such that Zk/Zk−1 is central in N/Zk−1 for
all k = 1, . . . , l. Denote Xk = N/(Zk) for k = 0, . . . , l −1. Thus, we have a
tower of nilmanifolds,
X = X0 →X1 →· · · →Xl−1 = Zl/(Zl−1)
where the last nilmanifold is a torus. Theorem 1.1 combined with Theorem B
immediately leads to the following statement.
Theorem 1.3 Let μ be a probability measure on Aut(X) having a ﬁnite exponential
moment or a ﬁnitely supported probability measure on Aff(X). Let  denote the
subgroup of Aut(X) generated by the support of θ∗μ. Assume
(i) For all k = 1, . . . , l −1, Zk is -invariant.
(ii) For all k = 1, . . . , l −1, τZk/Zk−1(μ) < 2σXk−1,Xk(μ).
(iii) The action of  on Zl/Zl−1 is strongly irreducible.
Then the μ-random walk on X is (λ, α)-quantitatively equidistributed for any λ ∈
(0, λ1,Zl/Zl−1(μ)) and any α ∈(0, 1].
Note that unlike in [16, Theorem 1.3] (cf. Theorem C), here the implicit constant
C of the (λ, α)-quantitative equidistribution does depend on the translation part,
though mildly. For more details about the dependence of the implicit constants on
the translation part, see Lemma 4.5.2
2 Lemma 4.5 contains the key inductive step, combined with [16, Theorem 1.3] one can easily
see how the constants in Theorem 1.3 depend on the translation parts. As this is not particularly
illuminating, we do not give an explicit discussion here.

138
W. He et al.
From this quantitative statement, i.e., Theorem 1.3, we can deduce easily the
following qualitative statement.
Corollary 1.4 Let μ be either probability measure on Aut(X) with ﬁnite exponen-
tial moment or a Borel probability measure on Aff(X) with ﬁnite support. Let 
denote the subgroup generated by Supp(θ∗μ). Let H denote the subgroup generated
by Supp(μ).
Assume the same assumptions as in Theorem 1.3. Then for any x ∈X, either
μ∗m ∗δx converge to mX in the weak-∗topology or the projection of the orbit Hx
to the maximal torus factor is contained in a proper closed H-invariant subset.
Clearly, the two options in Corollary 1.4 are mutually exclusive.
From Corollary 1.4, follow easily the following classiﬁcation theorem about orbit
closures and stationary measures: if μ and  are as in in Theorem 1.3, then a -
orbit closure is either X or projects to a proper closed -invariant subset on the
maximal torus factor. Similarly, an ergodic μ-stationary measure on X is either
mX or supported on a proper closed invariant subset. However, these classiﬁcation
theorems can be deduced from the work of Benoist and Quint [4] and the work of
Eskin and the third-named author [11], works that deal with the much more general
context of random walks on homogeneous spaces. For instance, [4, Corollary 1.10]
states as follows. In the case of automorphism action, if  is a ﬁnitely generated
subgroup of Aut(X), whose Zariski closure in Aut(N) is a Zariski connected
semisimple subgroup with no compact factor, then every -orbit closure x is a
ﬁnite homogeneous union of afﬁne submanifolds. If moreover μ is a probability
measure  whose support generates , then the Cesàro mean 1
n
n
m=1 μ∗m ∗δx
converges in the weak-∗topology to the homogeneous measure probability measure
on x (the measure induced by the Haar measure on the stabilizer of x). In [11],
the requirement on semisimplicity is relaxed. However, there does not seem to be at
present a purely ergodic theoretic approach to Corollary 1.4 without the additional
Cesàro mean.
1.5
Idea of the Proof
To conclude this introduction, let us explain the conceptual ideas behind the proof
of the main theorem. Let f be a test function on X which witnesses Wα(μ∗m ∗
δx, mX) > t. The goal is to construct another witness which has the additional
property that it is constant on each ﬁber of π : X →Y. Using Fourier analysis
on the ﬁbers (i.e., the Z-direction), we may assume without loss of generality that
f behaves as a character on the ﬁbers. Now sample random elements g1 and g2
in Aff(X) according to μ∗m′ with some m′ ≤m and set f1 = f ◦g1 and f2 =
f ◦g2. Because τZ(μ) is small, with large probability, θZ(g1) = θZ(g2) so that
f1f2 is constant on each ﬁber. And because σX,Y (μ) is large, f1f2 is a witness to
Wα(μ∗(m−m′) ∗δx, mX) > tO(1) also with large probability.

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
139
2
Examples
This section is devoted to a few concrete examples where our main theorem applies
and an example where it does not apply.
2.1
Heisenberg Nilmanifold
Let N be the (2d+1)-dimensional Heisenberg group. Recall that a Heisenberg group
is a two-step simply connected nilpotent Lie group of one-dimensional center. Let
Z denote the center of N. Note that [N, N] = Z and it is isomorphic to R.
Let  be a lattice in N and set X = N/. The maximal factor torus of X is
T = N/[N, N] = N/Z. Let μ be a Borel probability measure on Aff(X) with
ﬁnite support. Let H denote the subgroup generated by Supp(μ) and  = θ(H).
Assume that
the action of  on N/Z is strongly irreducible.
(3)
We claim that the assumptions of Theorem 1.3 are satisﬁed for the ﬁltration {0} ⊂
Z ⊂N. Indeed, {0} ⊂Z ⊂N is the ascending central series of N. Hence the
assumptions on the ﬁltration are satisﬁed. It remains to see that τZ(μ) < 2σX,T (μ).
On the one hand, (3) implies the condition A of Theorem A. Hence the action of 
on X has a spectral gap, which implies σX,T (μ) > 0 (we remark that the special
case of Theorem A we use here for Heisenberg nilmanifolds was established by
Bekka and Heu in [3]). On the other hand, any γ ∈Aut(X) preserves both Z and
the lattice Z ∩ in Z. Hence the action of Aut(X) on Z consists only of {±1}.
It follows that τZ(μ) = 0, establishing condition (ii) of Theorem 1.3, and hence
Theorem 1.3 applies to Heisenberg nilmanifolds.
Qualitatively, we can say a little bit more than Corollary 1.4.
Theorem 2.1 Let X be a Heisenberg nilmanifold and μ a probability measure
on Aut(X) having a ﬁnite exponential moment, and let  denote the subgroup
generated by Supp(μ). Assume the irreducibility condition (3) holds. Then for every
x ∈X, either μ∗n ∗δx converges to mX in the weak-∗topology or the -orbit of x
is ﬁnite.
Proof By the discussion above, Corollary 1.4 applies. Thus, it is enough to see that
if the image of x in T = N/Z is rational, then the Aut(X)-orbit of x is ﬁnite.
By [10, Theorem 5.1.8], the Q-span of log() is a Q-structure of the Lie algebra
Lie(N) of N. We can choose a basis of this Q-structure and identify both Lie(N)
and N with R2d+1 = R2d ⊕Z so that the projection of  to R2d is exactly Z2d.
Then every automorphism γ ∈Aut(X) is of the form
(y, t) ∈R2d ⊕Z →(Aγ y, ϵγ t + Lγ y, ) ∈R2d ⊕Z

140
W. He et al.
where Aγ ∈GL2d(Z), ϵγ ∈{±1}, and Lγ : R2d →R is a linear form. From [10,
Theorem 5.4.2], we know that there is an integer q ∈N such that  ⊂Z2d ⊕1
q Z ⊂
R2d ⊕Z. This implies that the linear form Lγ must be rational of denominator q.
It follows that if (y, t) ∈R2d ⊕Z with y rational of denominator q′, then
Aut(X)(y, t) ⊂1
q′ Z2d ×

{±t} + 1
qq′ Z

⊂R2d ⊕Z.
Since the group law in these coordinates is bilinear with rational structural constants,
this allows to conclude that .(y, t) is ﬁnite.
⊓⊔
2.2
Heisenberg Nilmanifold over Number Fields
In the example above, the growth rate τZ(μ) for the action on the center Z is equal
to 0 because this action is virtually trivial. In the next example, we have again a two-
step nilpotent group N, but the group  ⊂Aut(X) will have a non-trivial action on
the center.
Let B : C2d × C2d
→C be a bilinear form with integral coefﬁcients in
the standard basis. For a commutative ring with unity R, deﬁne HeisB(R) to
be the group with underlying set R2d+1 = R2d × R and with the group law
∀(y, t), (y′, t′) ∈R2d × R,
(y, t)(y′, t′) =

y + y′, t + t′ + B(y, y′)

.
Let K be a number ﬁeld. Denote by OK its ring of integers and by O×
K the
group of units. Let r1 be the number of embeddings of K in R and r2 the number
of conjugate pairs of embeddings of K in C. Let ι: K →Rr1 × Cr2 be the
corresponding ring embedding so that ι(OK) is discrete, which in fact is a lattice in
Rr1 ×Cr2. This embedding of rings induces an embedding of groups HeisB(OK) →
HeisB(Rr1 × Cr2), which we denote again by ι. Let N = HeisB(Rr1 × Cr2) and
 = ι(HeisB(OK)). It is easy to check that  is a lattice in N. Hence X = N/ is
a nilmanifold.
Inside Aut(), we have automorphisms of the form
(y, t) ∈Heis(OK) →(Ay, ϵt + Ly) ∈Heis(OK)
where A ⊂GL2d(OK), ϵ ∈O×
K, and L ∈(O2d
K )∗such that
∀y, y′ ∈K2d, B(Ay, Ay′) = ϵB(y, y′).
They extend to Aut(N) via ι. Denote by 0 ⊂Aut(X) the group consisting of
such automorphisms. For example, for d = 1 and B = det, A can be any matrix

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
141
in GL2(OK) and ϵ = det(A), and 0 is isomorphic to a semi-direct product
GL2(OK) ⋉O2
K.
Consider the central subgroup
Z = {0} ⊕Rr1 × Cr2 ⊂(Rr1 × Cr2)2d × (Rr1 × Cr2) = N.
Then 0 preserves Z. Let μ be a probability measure on 0. Necessarily, τZ(μ) = 0
because 0 acts on Z via the abelian group O×
K, which grows at polynomial rate.
Let  be the group generated by Supp(μ). The action of  on N/Z = (Rr1 ×Cr2)2d
can be identiﬁed with  →GL2d(OK)
ι−→GL2d(R)r1 × GL2d(C)r2. If the action
of  on K2d is strongly irreducible over K, then the action of  on N/Z is strongly
irreducible over Q. If moreover  is not virtually abelian, then the condition (iii) of
Theorem A is satisﬁed. We conclude that
τZ(μ) = 0 < 2σX,T (μ)
where T = N/(Z). Hence Theorem 1.1 applies. However, Theorem B does
not apply to the induced random walk on T , as the action of  on N/Z is not
irreducible over R unless r1 + r2 = 1 (it is strongly irreducible over Q unless K is
a totally complex extension of a totally real ﬁeld, c.f. e.g., [19, §2]). However, it is
conjectured that a quantitative equidistribution holds for such random walks on T ,
at least under the assumption that the projection of  to GL2d(R)r1 × GL2d(C)r2
has semisimple Zariski closure with no compact factor.
2.3
A Non-semisimple Group of Toral Automorphisms
In both examples above, the growth rates of the action on the ﬁbers are all zero.
Now we give an example where we have a positive growth rate while our result still
applies.
Consider X = T2d = R2d/Z2d with d ≥2. Let A and D be independent random
elements in SLd(Z). Denote by η the law of A and ν that of D. Let Id denote the
d × d identity matrix. Let μ be the law of the random block triangular matrix
 A Id
0 D

.
Let Z = Rd ⊕{0} ⊂R2d and Y = R2d/Rd ⊕Zd. The ﬁltration {0} ⊂Z ⊂R2d is
preserved by , the group generated by the support of μ.
Proposition 2.2 In the above setting, given the measure η, there is some ν such that
Theorem 1.3 can be applied to μ and the ﬁltration {0} ⊂Z ⊂R2d.

142
W. He et al.
As a consequence, we can say the following about orbit closures under the action
of , the group generated by the support of the constructed μ. For every x ∈T2d,
either x is dense or x is contained in a ﬁnite union of afﬁne subtori parallel
to Rd/Zd ⊕{0}. For properly chosen η, the group  will not have semisimple
Zariski closure. Thus, the work of Benoist-Quint [4] does not apply to such group.
Neither does the work of Guivarc’h-Starkov [13] nor that of Muchnik [17] (though
stationary measures even in this case are analyzed by Eskin and the third named
author in [11]).
To show the proposition, we need the following lemma to control σX,Y (μ).
Lemma 2.3 In the setting above, denote by (UY , L2(Y, mY )) the Koopman repre-
sentation associated to the action of Aut(Y) on Y and by UY,0 the restriction of UY
to the subspace of mean zero functions. Then we have
∥UX,Y (μ)2∥≤
√
3∥UY,0(ν)∥.
Proof Let F : L2(X, mX) →ℓ2(Z2d) denote the isometry given by the Fourier
transform. Under this isometry, UX,Y is conjugated to a unitary representation T of
 on ℓ2((Zd \ {0}) × Zd). Explicitly, let ϕ ∈ℓ2((Zd \ {0}) × Zd). Then for all
(a, b) ∈(Zd \ {0}) × Zd,
(T (μ)ϕ)(a, b) =


ϕ(tg(a, b)) dμ(g) = E

ϕ(tAa, a + tDb)

.
Let P0 be the orthogonal projection ℓ2((Zd \ {0}) × Zd) →ℓ2((Zd \ {0}) × {0}).
Concretely, for ϕ ∈ℓ2((Zd \ {0}) × Zd) and (a, b) ∈(Zd \ {0}) × Zd,
(P0ϕ)(a, b) = δ0(b)ϕ(a, 0).
Then P0T (μ)P0 = 0 because
(P0T (μ)P0ϕ)(a, b) = δ0(b)E

δ0(a)ϕ(tAa, 0)

= 0.
Hence, taking the square of the equality T (μ) = P0T (μ) + (1 −P0)T (μ), we
see,
∥T (μ)2∥≤3∥(1 −P0)T (μ)∥.
To conclude, it sufﬁces to show
∥(1 −P0)T (μ)∥≤∥UY,0(ν)∥.
(4)
We ﬁrst show the inequality in the case where A is almost surely some ﬁxed
matrix g ∈SLd(Z). Consider, for a ∈Zd \ {0}, the subspace

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
143
Ha = ℓ2({a} × Zd) ⊂ℓ2((Zd \ {0}) × Zd).
Let Qa denote the orthogonal projection onto Ha. Observe that
∀a ∈Zd \ {0}, T (μ)Ha ⊂Htg−1a.
Moreover P0 preserves the subspaces Ha. Hence, for any ϕ ∈ℓ2((Zd \ {0}) × Zd),
the vectors (1 −P0)T (μ)Qaϕ, a ∈Zd \ {0}, are all orthogonal to each other. Thus
∥(1 −P0)T (μ)ϕ∥2 =

a∈Zd\{0}
∥(1 −P0)T (μ)Qaϕ∥2
≤

a∈Zd\{0}
∥(1 −P0)T (μ)Qa∥2∥Qaϕ∥2
≤

sup
a∈Zd\{0}
∥(1 −P0)T (μ)Qa∥2
∥ϕ∥2.
By identifying Ha with ℓ2(Zd) in the obvious way, we see that ∥(1−P0)T (μ)Qa∥=
∥Va∥where Va : ℓ2(Zd) →ℓ2(Zd \ {0}) is the operator deﬁned by
∀ψ ∈ℓ2(Zd), ∀b ∈Zd \ {0},
(Vaψ)(b) = E

ψ(tg−1a + tDb)

.
Let Wa : ℓ2(Zd) →ℓ2(Zd) be the isometry induced by translating the index by
tg−1a, so that Va = V0Wa. But V0 is conjugated to UY,0(ν) via the Fourier
transform. Hence
sup
a∈Zd\{0}
∥(1 −P0)T (μ)Qa∥≤
sup
a∈Zd\{0}
∥Va∥≤∥V0∥= ∥UY,0(ν)∥.
This shows (4) for the special case where A is almost surely constant.
Using the independence between A and D, we can write
μ =

SLd(Z)
μg dη(g),
with μg being the law of the random matrix
 g Id
0 D

.
Then ∥T (μ)∥≤

SLd(Z)∥T (μg)∥dη(g) proves (4).
⊓⊔
Proof of Proposition 2.2 Once η is chosen, the action of  on Z is determined.
Hence τZ(μ) is determined.

144
W. He et al.
Let ν0 be a symmetric probability measure on SLd(Z) whose support generates a
Zariski-dense subgroup. Then by a result of Furman and Shalom [12, Theorem 6.5]
(which is a special case of Theorem A),
∥UY,0(ν0)∥< 1.
Let ν = ν∗k
0
where k is an integer. By choosing k large enough, we can make
∥UY,0(ν0)∥arbitrarily small and hence σX,Y (μ) arbitrarily large by Lemma 2.3.
This ensures that
τZ(μ) < 2σX,Y (μ).
At the same time, the support of ν generates a Zariski dense subgroup  in SLd. In
particular the action of  on R2d/Z is strongly irreducible. This is why Theorem 1.3
can be applied.
⊓⊔
2.4
A Non-example
Let N be the connected and simply connected nilpotent Lie group whose Lie algebra
is the free two-step nilpotent Lie algebra on three generators. It can be realized as
N = R3 ⊕R3 with the group law being
(x, y)(x′, y′) = (x + x′, y + y′ + x ∧x′),
for all x, x′, y,′ y ∈R3,
where ∧denotes the usual cross product on R3. As explained in [2, Example 35],
the automorphism group Aut(N) of N is isomorphic to the subgroup of GL6(R) of
matrices gA,B of the form
gA,B =
 A
0
B det(A)(Atr)−1

,
with A ∈GL3(R) and B any 3 × 3 matrix with real coefﬁcients. Here Aut(N)
acts on the center Z of N via θZ : gA,B →det(A)(Atr)−1 and acts on N/Z via
θN/Z : gA,B →A.
Let  be any lattice in N and set X = N/. Let μ be a probability measure on
Aut(X) and  the group generated by its support. Denote moreover Y = N/(Z).
In order to apply Theorem 1.1 to the factor map X →Y, we need
(i) τZ(μ) to be small; informally, that is θZ() is a small group.
(ii) σX,Y (μ) to be large; in view of Theorem A, this requires θN/Z() to be a large
group (not virtually amenable by [2, Theorem 1 and Theorem 5]).

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
145
But θZ(), isomorphic to θN/Z(), cannot be small and large at the same time. This
is why, very likely, Theorem 1.1 does not apply to such random walks. However, we
still expect the conclusion of Theorem 1.1 to hold, provided that θN/Z() is a large
group (e.g., Zariski dense in SL3(R)).
3
The Setup
Throughout this paper, X = N/ denotes a nilmanifold. As recalled in the
introduction, this means that N is a connected simply connected nilpotent Lie group
and  ⊂N is a lattice, which is necessarily cocompact ([18, Theorem 2.1]). Recall
that the Q-span of log() deﬁnes a Q-structure on Lie(N), the Lie algebra of N. A
connected closed subgroup of N is said to be rational if its Lie algebra is rational in
Lie(N) with respect to this Q-structure. For a connected closed subgroup M ⊂N
to be rational, it is necessary and sufﬁcient that M ∩ is a lattice in M. For these,
see [10, §5.1].
Denote by Aut(X) = Aut(N/) denote the group of continuous automorphisms
of N preserving . Let Aff(X) = Aff(N/) = Aut(X) ⋉N denote the group
of (invertible) afﬁne transformations of X. More precisely for γ ∈Aut(X) and
n ∈N, let (γ, n) ∈Aff(X) denote the map X →X, x →nγ (x). Denote by
θ : Aff(X) →Aut(X) the projection to the automorphism part, that is, θ(γ, n) = γ
for all (γ, n) ∈Aff(X).
Moreover, we will identify an automorphism γ ∈Aut(X) with (γ, 1N) ∈Aff(X)
and an element n ∈N with the left translation (1, n) ∈Aff(X). With this notation
we have, for all γ ∈Aut(X) and all n ∈N, γ nγ −1 = γ (n). If g ∈Aff(X) and
n ∈N is central, then gng−1 = θ(g)(n).
Let mX denote the normalized N-invariant measure on X induced by the Haar
measure of N. The action Aff(X) ↷X preserves mX. Let (U, L2(X, mX)) denote
the associated Koopman representation. That is, for g ∈Aff(X), U(g) is the unitary
operator on L2(X, mX) deﬁned by
for all f ∈L2(X, mX) and almost all x ∈X, U(g)f (x) = f (g−1(x)).
Let also U∗(g) = U(g)∗= U(g−1). By an abuse of notation, we let U(g) and
U∗(g) denote also the operators from C0(X), the space of continuous functions, to
itself deﬁned in the obvious way.
Let μ be a Borel measure on Aff(X). We set U(μ) =

U(g) dμ(g) and
U∗(μ) =

U∗(g) dμ(g). For any integer m ≥0, any Borel measure η on X,
and any continuous function f ∈C0(X), we have

X
f dμ∗m ∗η =

X
U∗(μ)mf dη.

146
W. He et al.
3.1
Hölder Functions
We ﬁx a Riemannian metric on X and let d : X × X →[0, +∞) denote the
associated distance function. Let α ∈(0, 1]. Denote by C0,α(X) the set of α-Hölder
continuous functions from X to C. Endow it with the norm
∥f ∥0,α = ∥f ∥∞+ ωα(f )
where
ωα(f ) =
sup
x̸=y∈X
|f (x) −f (y)|
d(x, y)α
.
For g ∈Aff(X), deﬁne
LipX(g) =
sup
x,x′∈X, x̸=x′
d(gx, gx′)
d(x, x′) .
This quantity is ﬁnite since g is of class C∞and d is a Riemannian distance. It is
greater or equal to 1 since X is compact. Moreover, LipX : Aff(X) →[1, +∞) is
continuous and submultiplicative, i.e., for all g, h ∈G,
LipX(gh) ≤LipX(g) LipX(h).
(5)
It is straightforward to check that if g ∈Aff(X) and f ∈C0,α(X), then U∗(g)f
is still α-Hölder continuous and
∥U∗(g)f ∥0,α ≤LipX(g)α∥f ∥0,α.
Remark also that for f1, f2 ∈C0,α(X), then f1f2 ∈C0,α(X) and
∥f1f2∥0,α ≤∥f1∥0,α∥f2∥0,α.
(6)
4
The Main Argument
As in the statement of Theorem 1.1, let μ be Borel measure on Aff(X) having
a ﬁnite exponential moment. Let  ⊂Aut(X) denote the subgroup generated by
the support of θ∗μ. Let Z ⊂N be a -invariant rational connected closed central
subgroup. Then Y = N/(Z) is a nilmanifold, and we have a  ⋉N-equivariant
factor map π : X →Y. Let mY denote the N-invariant probability measure on Y
induced by the Haar measure of N. We deﬁned two quantities τZ(μ) and σX,Y (μ) in
the introduction. This section is dedicated to the proof of the following proposition.

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
147
Proposition 4.1 Assume that μ has a ﬁnite β-exponential moment. Assume
τZ(μ) < 2σX,Y (μ).
Then given 0 < α ≤min{1, β}, there exists a constant C ≥2 such that the following
holds.
For any Borel probability measure η on X, any t ∈(0, 1/2), and any m ≥
C log 1
t , if
Wα(μ∗m ∗η, mX) ≥t,
then
Wα(π∗η, mY ) ≥e−Cm.
In other words, if there is f ∈C0,α(X) satisfying


X
f dμ∗m ∗η −

X
f d mX
 > t∥f ∥0,α,
then there exists ϕ ∈C0,α(Y) such that


X
ϕ dπ∗η −

X
ϕ d mY
 > e−Cm∥ϕ∥0,α.
4.1
Principal Torus Bundle
Let S = Z/(Z ∩). Let d = dim Z. Then S is a torus of dimension d. Note that π
is a ﬁber bundle of ﬁber S. Moreover, it is a principal bundle: since Z is contained
in the center of N, the action of Z by left translation on X factors through S.
By choosing a basis in Z ∩, we ﬁx an isomorphism between Zd and the group
Hom(S, S1) of unitary characters of S. Denote the isomorphism as a →χa, a ∈Zd.
The Koopman representation U restricted to Z factors through S. Hence, we can
decompose L2(X, mX) into a Hilbert sum of characteristic subspaces
L2(X, mX) =

a∈Zd
Ha
(7)
where for a ∈Zd,
Ha = { f ∈L2(X, mX) | ∀z ∈Z, U(z)f = χa(z)f }.

148
W. He et al.
Here we identiﬁed χa with its lift as character of Z. For a = 0, H0 is the subspace
of functions that are constant on each ﬁber of π. Since π∗mX = mY , we have the
isometry
H0 = L2(Y, mY ).
Thus, the Hilbert space of the representation UX,Y is precisely 
a∈Zd\{0} Ha.
Since for all g ∈Aff(X) and z ∈Z, zg = gθ(g)−1(z), we have
∀g ∈Aff(X), ∀a ∈Zd,
U(g)Ha = Hθ(g)·a,
where γ · a ∈Zd is such that χγ ·a = χa ◦γ −1 for γ ∈. This deﬁnes an action of
 on Zd. Note that  acts via some homomorphism  →GLd(Z).
4.2
Fourier Transform
For continuous functions, the decomposition (7) can be made more explicit using
Fourier transforms. The aim here is to prove the following lemma using Fourier
transforms.
Lemma 4.2 Given α ∈(0, 1], there is a constant C depending on α such that the
following holds. If a measure η on X, a function f ∈C0,α(X), and t ∈(0, 1/2)
satisfy


X
f dη −

X
f d mX
 ≥t∥f ∥0,α,
then there exist a0 ∈Zd with ∥a0∥≤t−C and f0 ∈C0,α(X) ∩Ha0 such that


X
f0 dη −

X
f0 d mX
 ≥tC∥f0∥0,α.
Specializing this lemma to the case where X is a torus and Y is a point, we can
recover Lemma 4.5 in Boyer [8]. Our proof is slightly shorter.
Let mS denote the normalized Haar measure on S. For a ∈Zd, deﬁne for any
f ∈C0(X),
Faf (x) =

S
χa(z)(U(z)f )(x) d mS(z).

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
149
It is readily check that Faf
∈Ha. It preserves C0,α(X) for any α ∈(0, 1].
Moreover, since LipX is continuous and S is compact, we have, uniformly in a,
∀f ∈C0,α(X),
∥Faf ∥0,α ≪∥f ∥0,α.
(8)
Deﬁne also the Féjer kernel: for N ∈N,
FN =

(ai)∈[−N,N]d
 d
i=1

1 −|ai|
N

F(ai).
Lemma 4.3 Let α ∈(0, 1) and N ∈N. For any f ∈C0,α(X),
∥FNf −f ∥∞≪N−α∥f ∥0,α.
(9)
Here the implied constant depend on the choice of the basis on Z ∩.
Proof For t ∈T = R/Z, write e(t) = e2πit. While deﬁning χa, we had chosen a
basis of the lattice Z ∩. This choice induces an isomorphism ϕ : Td →S so that
for all t = (t1, . . . , td) ∈Td and all a = (a1, . . . , ad) ∈Zd,
χa(ϕ(t)) =
d
i=1
e(aiti).
For N ≥1, denote by KN : T →R the N-th Féjer kernel on the circle, i.e.,
∀t ∈T, KN(s) =
N−1

a=−N+1

1 −|a|
N

e(at) = 1
N
sin(Nπt)
sin(πt)
2
.
Let f ∈C0,α(X). It follows from the deﬁnition that for all x ∈X,
FNf (x) =

Td
 d
i=1
KN(ti)

f (ϕ(t1, . . . , td)−1x) dt1 · · · dtd.
We ﬁx a Riemannian distance dTd on Td. Since ϕ is smooth and both Td and X
are compact,
∀t ∈Td, ∀x ∈X,
d(ϕ(t)−1x, x) ≪dTd(t, 0)

150
W. He et al.
where the implied constant depends on the choice of dTd. It follows that
|f (x) −FNf (x)| =

Td
 d
i=1
KN(ti)

|f (ϕ(t1, . . . , td)−1x) −f (x)| dt1 · · · dtd
≤

Td
d
i=1
KN(ti)∥f ∥0,αd(ϕ(t1, . . . , td)−1x, x)α dt1 · · · dtd
≪∥f ∥0,α

Td
 d
i=1
KN(ti)

dTd((t1, . . . , td), 0)α dt1 · · · dtd
Note that for (t1, . . . , td) ∈[−1
2, 1
2]
d, we have dTd((t1, . . . , td), 0)α ≪tα
1 +· · ·+tα
d .
Hence

Td
 d
i=1
KN(ti)

dTd((t1, . . . , td), 0)α dt1 · · · dtd ≪

1
2
−1
2
KN(t)|t|α dt.
The last quantity is bounded by N−α, by [9, Lemma 1.6.4].
⊓⊔
Proof of Lemma 4.2 We ﬁrst prove the lemma for α ∈(0, 1). Let C denote the
implied constant in (9). Pick an integer N such that
t
8C ≤N−α ≤
t
4C .
By Lemma 4.3, we get
∥FNf −f ∥∞≤t
4∥f ∥0,α.
Combined with the assumption, this gives


X
FNf d(η −mX)
 ≥t
2∥f ∥0,α.
Then by the deﬁnition of the Féjer kernel,
t
2∥f ∥0,α ≤

a∈[−N,N]d


X
Faf d(η −mX)

Hence there exists a ∈[−N, N]d such that

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
151


X
Faf d(η −mX)
 ≥
t
2(2N + 1)d ∥f ∥0,α ≫t1+ d
α ∥f ∥0,α.
Thus, on account of (8), f0 = Faf satisﬁes the required properties.
If α = 1, then (9) in Lemma 4.3 becomes (cf. [9, Lemma 1.6.4])
∥FNf −f ∥∞≪log N
N
∥f ∥0,1.
The rest of the proof is similar.
⊓⊔
4.3
Essential Growth Rate
Recall the deﬁnition of the quantity τZ(μ) from the introduction. Consider a Borel
probability measure μ on Aut(Z) where Z is a connected simply connected abelian
Lie group. For κ > 0, let
τZ(μ, κ) = lim sup
m→+∞
1
m log min{ #A | A ⊂Aut(Z) with μ∗m(A) ≥1 −e−κm }.
This quantity is non-decreasing in κ. Let
τZ(μ) = lim
κ→0 τZ(μ, κ).
We deﬁne similarly τZ(μ) if, more generally, μ is a measure on a group which acts
measurably on Z by automorphisms.
Under an exponential moment assumption, this quantity is ﬁnite. Moreover it can
be bounded in terms of the top Lyapunov exponent of μ.
Lemma 4.4 Assume that the support of μ preserves a lattice of Z. Assume that μ
has a ﬁnite exponential moment. Then
τZ(μ) ≤(d2 −1)λ1,Z(μ)
where d = dim Z and λ1,Z(μ) denote the top Lyapunov exponent of the linear
random walk deﬁned by μ on Z.
Proof Without loss of generality, we assume Z = Rd and that Supp(μ) preserves
the lattice Zd. By the large deviation estimate (Theorem A.1 proved in the
Appendix), for any ω > 0, there is some κ > 0 such that for all m sufﬁciently
large
μ∗m(B(0, e(λ1,Z(μ)+ω)m)) ≥1 −e−κm.

152
W. He et al.
By taking A = GLd(Z) ∩B(0, e(λ1,Z(μ)+ω)m), we get
τZ(μ) ≤τZ(μ, κ) ≤(d2 −1)(λ1,Z(μ) + ω).
We obtain the desired inequality by letting ω →0.
⊓⊔
4.4
The Cauchy-Schwarz Argument
The heart of the proof of Proposition 4.1 is a use of the Cauchy-Schwarz inequality.
Let
Cβ =

Aff(X)
LipX(g)β dμ(g).
Lemma 4.5 Assume that μ has a ﬁnite β-exponential moment (i.e., that Cβ < ∞)
and that
τZ(μ) < 2σX,Y (μ).
Then for every 0 < α ≤min{1, β}, there exists a constant m0 depending on μ
and C depending on θ∗μ and 2σX,Y (μ) −τZ(μ), such that the following holds. Let
t ∈(0, 1/2) and f ∈C0,α(X)∩Ha0 with a0 ∈Zd \{0}. Let η be a Borel probability
measure on X. If


X
f dμ∗m ∗η
 ≥t∥f ∥0,α,
(10)
for some m ≥max(C log 1
t , m0), then there exists f1 ∈C0,α(X) ∩H0 such that


X
f1 dη −

X
f1 d mX
 ≥(2Cβ)−2m t2 ∥f1∥0,α.
Proof Without loss of generality, we may assume ∥f ∥0,α = 1.
We are going the partition  ⋉N according to the action on Zd. For a ∈Zd,
deﬁne
Pa = { g ∈ ⋉N | θ(g)−1 · a0 = a }.
For m ≥1 and a ∈Zd, deﬁne μ(m)
a
to be renormalized restriction of μ∗m to Pa so
that we have
μ∗m =

a∈Zd
μ∗m(Pa)μ(m)
a
.

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
153
Deﬁne also
f (m)
a
= U∗(μ(m)
a
)f
so that
U∗(μ)mf =

a∈Zd
μ∗m(Pa)f (m)
a
.
(11)
From the deﬁnition of Pa, we know that f (m)
a
∈Ha. Hence the sum in (11) is an
orthogonal one. In particular,
33U∗(μ)mf
332
2 =

a∈Zd
μ∗m(Pa)2∥f (m)
a
∥2
2.
(12)
From f (m)
a
∈Ha, follow that
f (m)
a
2 ∈H0. The functions
f (m)
a
2 are going to be
our candidates for f1.
The core of the argument is the following applications of the Cauchy-Schwarz
inequality. From (10) and (11), we get
t ≤


X
U∗(μ)mf dη
 ≤

a∈Zd
μ∗m(Pa)


X
f (m)
a
dη
 .
By the Cauchy-Schwarz inequality for the sum,
t2 ≤

a∈Zd
μ∗m(Pa)


X
f (m)
a
dη

2
.
By the Cauchy-Schwarz inequality for the integral,
t2 ≤

a∈Zd
μ∗m(Pa)

X
f (m)
a
2 dη.
(13)
We want to compare the right-hand side of the above equation (where the integration
is over the unknown measure η) to the following analogous expression involving
∥·∥2
2, i.e., when the integration is with respect to the Haar measure mX:

a∈Zd
μ∗m(Pa)
33f (m)
a
332
2 =

a∈Zd
μ∗m(Pa)

X
f (m)
a
2 d mX .
But ﬁrst, we need throw away the a’s for which the
33f (m)
a
33
0,α is too large. From
the exponential moment assumption and (5),

154
W. He et al.

a∈Zd
μ∗m(Pa)

Pa
LipX(g)β dμ(m)
a
(g) =

Aff(X)
LipX(g)β dμ∗m(g) ≤Cm
β .
By the Markov inequality, we have for any κ > 0,
μ∗m ∗δa0(Bκ) ≤e−κm
where
Bκ =
%
a ∈Zd |

Pa
LipX(g)β dμ(m)
a
(g) > Cm
β eκm &
.
For a ∈Zd \ Bκ, we have, since α ≤β,
33f (m)
a
33
0,α ≤

Pa
∥U∗(g)f ∥0,α dμ(m)
a
(g)
≤

Pa
LipX(g)α∥f ∥0,α dμ(m)
a
(g)
≤Cm
β eκm.
(14)
Next, we need to exploit the assumption τZ(μ) < 2σX,Y (μ). Choose τ > τZ(μ)
and σ < σX,Y (τ) such that σ −τ/2 = 2σX,Y (μ)−τZ(μ)
4
> 0 and moreover,
(i) For m ≥m1 = m1(μ), ∥UX,Y (μ)m∥≤e−σm.
(ii) There exists κ = κ(θ∗μ) ∈(0, 1
2) such that for m ≥m2 = m2(θ∗μ), there
exists A ⊂Zd satisfying #A ≤eτm and μ∗m ∗δa0(A) ≥1 −e−κm.
Note that κ only depends on θ∗μ because we are letting ⟨Supp(μ)⟩act on Z via
⟨Supp(μ)⟩
θ−→ →Aut(Z). By replacing A by A \ Bκ, we may assume without
loss of generality that A ⊂Zd \ Bκ.
Using the fact that ∥U∗(μ(m)
a
)∥≤1 (hence
33f (m)
a
33
2 ≤∥f ∥2 ≤1), the Cauchy-
Schwarz inequality, and (12) we obtain

a∈A
μ∗m(Pa)
33f (m)
a
332
2 ≤

a∈A
μ∗m(Pa)
33f (m)
a
33
2
≤
√
#A
4
a∈A
μ∗m(Pa)233f (m)
a
332
2
=
√
#A
33U∗(μ)mf
33
2
≤
√
#A
33UX,Y (μ)m33
≤e−(σ−τ/2)m.

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
155
Now remember (13). Bounding ∥f (m)
a
∥∞≤∥f ∥∞≤1 for a ∈Zd \ A, we
obtain
t2 ≤e−κm +

a∈A
μ∗m(Pa)

X
f (m)
a
2 dη,
which we rewrite as
t2 ≤e−κm +

a∈A
μ∗m(Pa)
33f (m)
a
332
2 +

a∈A
μ∗m(Pa)

X
f (m)
a
2 d(η −mX).
Then it follows from the above that
t2 ≤e−κm + e−(σ−τ/2)m +

a∈A
μ∗m(Pa)

X
f (m)
a
2 d(η −mX),
Now if
m ≥2 max
% 1
κ ,
1
σ −τ/2
&
log 2
t ,
then
t2
2 ≤

a∈A
μ∗m(Pa)

X
f (m)
a
2 d(η −mX).
Hence there exists a ∈A such that

X
f (m)
a
2 d(η −mX) ≥t2
2 .
Moreover, since A ⊂Zd \ Bκ, we have by (6) and (14),
33f (m)
a
233
0,α ≤
33f (m)
a
332
0,α ≤C2m
β e2κm ≤(2Cβ)2m.
Thus, f1 =
f (m)
a
2 satisﬁes the required properties, proving the lemma with m0 =
max{m1, m2} and C = 4 max
%
1
κ ,
4
2σX,Y (μ)−τZ(μ)
&
.
⊓⊔
4.5
Proof of the Key Proposition
We need one more lemma before we prove Proposition 4.1.

156
W. He et al.
Lemma 4.6 Assume that μ has a ﬁnite β-exponential moment. For every 0 < α ≤
min{1, β}, there exists a constant C ≥1 such that the following holds for any
parameter t ∈(0, 1/2) and any m ∈N sufﬁciently large. If there exists f0 ∈C0,α ∩
H0 satisfying


X
f0 dμ∗m ∗η −

X
f0 d mX
 ≥t∥f0∥0,α,
then there exists f1 ∈C0,α ∩H0 such that


X
f1 dη −

X
f1 d mX
 ≥e−CmtC∥f1∥0,α.
Proof Without loss of generality, assume ∥f0∥0,α = 1. By the moment assumption,
there is Cβ ≥1 such that for any m ∈N,

LipX(g)β dμ∗m(g) ≤Cm
β . Set
E = { g ∈Aff(X) | LipX(g)β > 4Cm
β t−1 }
so that we have
μ∗m(E) ≤t
4
by the Markov inequality . Thus for any α ∈(0, β],
∀g ∈Aff(X) \ E,
∥U∗(g)f0∥0,α ≤LipX(g)α∥f0∥0,α ≤4Cm
β t−1.
By the assumption on f0,
t ≤

Aff(X)


X
U∗(g)f0 d(η −mX)
 dμ∗m(g)
≤2μ∗m(E) +

Aff(X)\E


X
U∗(g)f0 d(η −mX)
 dμ∗m(g).
Hence

Aff(X)\E


X
U∗(g)f0 d(η −mX)
 dμ∗m(g) ≥t
2.
Hence there exists g ∈Aff(X) \ E such that f1 = U∗(g)f0 satisﬁes


X
f1 d(η −mX)
 ≥t
2.

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
157
Moreover, since g /∈E,
∥f1∥0,α ≤4Cm
β t−1,
showing the required property for f1.
⊓⊔
Proof of Proposition 4.1 Let t ∈(0, 1) be such that there exists f ∈C0,α(X) such
that


X
f dμ∗m ∗η −

X
f d mX
 ≥t∥f ∥0,α.
By Lemma 4.2 there is a0 ∈Zd and f0 ∈C0,α(X) ∩Ha0 such that


X
f0 dμ∗m ∗η −

X
f0 d mX
 ≥tO(1)∥f0∥0,α.
Using either Lemma 4.6 in the case where a = 0 or Lemma 4.5 otherwise (note
that a0 ̸= 0 implies

X f0 d mX = 0), we obtain some f1 ∈C0,α(X) ∩H0 such that


X
f1 dη −

X
f1 d mX
 ≥e−O(m)tO(1)∥f1∥0,α.
(15)
Letting ϕ ∈C0,α(Y) be such that f1 = ϕ ◦π, we have

X f1 dη =

Y ϕ dπ∗η,

X f1 d mX =

Y ϕ d mY , and ∥ϕ∥0,α ≪∥f1∥0,α. The last implied constant depends
only on the choice of Riemannian metrics on X and on Y. Therefore,


Y
ϕ dπ∗η −

Y
ϕ d mY
 ≫e−O(m)tO(1)∥ϕ∥0,α,
ﬁnishing the proof of the proposition.
⊓⊔
5
Proof of the Main Theorems
We are ready to prove the main theorem of this paper.
Proof of Proposition 4.1 We use the same notation μ, β, X, N, , Z, Y, , θ in
Proposition 4.1 as in Theorem 1.1.
Assume that the μ-induced walk on Y satisﬁes (CY , λ, α)-quantitative equidis-
tribution for parameters CY > 0, λ > 0 and 0 < α ≤min(1, β). Let λ′ ∈(0, λ).
We want to show that the μ-induced walk on X satisﬁes (CX, λ′, α)-quantitative
equidistribution for a large constant CX. Assume that for some t ∈(0, 1
2), m ≥
CX log 1
t holds that Wα(μ∗m ∗δx, mX) > t.

158
W. He et al.
Denote by π : X →Y the natural projection. Now we can apply Proposition 4.1,
whose constant we denote by Cπ, on η = μ∗(m−m′) ∗δx with m′ random walk steps.
Choose m′ to be such that
Cπ log 1
t < m′ < 2Cπ log 1
t .
By the proposition,
Wα(μ∗(m−m′) ∗δπ(x), mY ) = Wα(π∗η, mY ) ≥e−Cπm′ > t2C2π ,
If CX is large enough, then we can guarantee that m −m′ ≥CY log(t−2C2π ), so
that the premise of the (CY , λ, α)-quantitative equidistribution of the random walk
induced on Y applies.
For simplicity, we will assume for the remainder of the proof that μ is supported
on Aut(X) and leave the case that it is supported on Aff(X) to the reader. The two
proofs are almost identical.
The quantitative equidistribution on Y tells us that there exists y′ ∈Y with
d(π(x), y′) < e−λ(m−m′) such that the projection of y′ to the maximal torus factor
TY of Y is contained in a proper closed -invariant subgroup L of TY of height
≤t−2CY C2
π . Note that if CX > 2Cπλ
λ−λ′ , then e−λ(m−m′) < e−λ′m. By choosing x′ ∈X
to be the point closest to x in π−1(y′), we get d(x, x′) = d(π(x), y′) < e−λ′m.
Let TX denote the maximal torus factor of X. Then TY is a factor of TX. Moreover
the following the diagram of -equivariant maps commutes.
X
Y
TX
TY
π
π′
Thus, the projection of x′ to TX is contained in π′−1(L), which is a proper
closed -invariant subgroup of TX of height ≤O(t−2CY C2π ) by the following
observation.
Lemma 5.1 Let T ′ be a factor torus of a torus T and let π′ : T →T ′ be the factor
map. There exists C′ > 1 such that if L is a proper closed subgroup of T ′ of height
≤h, then π′−1(L) is a proper closed subgroup of T of height ≤C′h.
Proof A generating set of the dual of L can be mapped by the dual of π′ to a
generating set of the dual of π′−1(L). The dual of π′ changes the norm of the vectors
by at most a ﬁnite factor C′, the operator norm of this linear transformation.
By taking a new CX that is large enough, this give us (CX, λ′, α)-quantitative
equidistribution of the random walk on X.
⊓⊔
Theorem 1.3 follows immediately.

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
159
Proof of Theorem 1.3 Remark that for each k = 1, . . . , l −1, because X →Xk is
a smooth map between compact Riemannian manifolds, the condition that μ has a
ﬁnite exponential moment implies that the image measure in Aff(Xk) also has ﬁnite
exponential moment. It sufﬁces then to use Theorem B for the random walk on the
torus Xl−1 and apply Theorem 1.1 repeatedly l −1 times.
⊓⊔
Corollary 1.4 follows from the following lemma.
Lemma 5.2 Let X be a nilmanifold and μ a probability measure on Aff(X). Let
T denote the maximal torus factor of X. Let H denote the subgroup generated
by Supp(μ). If the μ-induced random walk on X satisﬁes a (C, λ, α)-quantitative
equidistribution for some C > 0, λ > 0, and α ∈(0, 1], then for any x ∈X
(i) Either μ∗m ∗δx converges to mX in the weak-∗topology
(ii) Or the projection of Hx to T is contained in a proper closed H-invariant subset
Proof Let π : X →T be the projection from X to its maximal torus factor. Assume
that μ∗m∗δx does not converge to mX in the weak-∗topology. The space of α-Hölder
functions C0,α(X) is dense in the space of continuous functions. It follows that there
is t > 0 such that
Wα(μ∗m ∗δx, mX) > t
for an unbounded sequence of m.
From the quantitative equidistribution, we get
(i) A sequence (xk) of points in X
(ii) A sequence (Hk) of subgroups of Aff(X)
(iii) A sequence (Lk) of proper closed subgroup of T of height ≤t−C and invariant
under θ(Hk) = θ(H)
such that
(i) limk→+∞xk = x
(ii) limk→+∞supg∈Supp(μ) d(g, Hk) = 0
(iii) π(Hkxk) −π(xk) ⊂Lk for all k
In T , there are only ﬁnitely many closed subgroup of height ≤t−C. Therefore, after
extracting a subsequence, we may assume that Lk =: L are all equal. Letting k go
to +∞, we ﬁnd
∀g ∈Supp(μ),
π(gx) −π(x) ∈L.
This is enough to conclude that π(x)+L ⊂T is H-invariant and π(Hx) ⊂π(x)+
L.
⊓⊔
Acknowledgments The proof in Appendix B grew out of a discussion together with Nicolas de
Saxcé. We are grateful to him for sharing his ideas.

160
W. He et al.
This paper is dedicated to the memory of Jean Bourgain, a great man and a profound
mathematician, whose deep work laid the framework for much that is done in this paper. In
particular, much of what the third named author knows about arithmetic combinatorics he learned
from Jean Bourgain. While working on this paper, we have been acutely aware of him being no
longer with us—no doubt if we could have discussed these questions with him we could have gone
much further.
Appendix A: A Large Deviation Estimate
Let μ be Borel probability measure on GLd(R), d ≥2. Consider the random walk
in the linear group deﬁned by μ. Recall that μ is said to have a ﬁnite exponential
moment if there is β > 0 such that

GLd(R)
max
#
∥g∥, ∥g−1∥
$β dμ(g) < +∞.
(16)
Recall also that the top Lyapunov exponent of μ is deﬁned by
λ1(μ) =
lim
m→+∞
1
m

GLd(R)
log∥g∥dμ∗m(g)
Theorem A.1 Let μ be a Borel probability measure on GLd(R). Assume μ has a
ﬁnite exponential moment. For any ω > 0 there is κ > 0 such that for all m large
enough.
μ∗m{ g ∈GLd(R) | log∥g∥> m(λ1(μ) + ω) } ≤e−κm.
Proof Let g1, g2, . . . be independent random variables distributed according to μ.
Given ω > 0, let l ≥1 be such that
E

log∥g1 · · · gl∥

< l(λ1(μ) + ω/3).
Observe that

log∥gkl−l+1 · · · gkl∥

k≥1 is a sequence of i.i.d. real-valued random
variables having a ﬁnite exponential moment. Thus, by Crámer’s theorem, there
exists τ > 0 such that for k large enough,
P

log∥g1 · · · gl∥+ · · · + log∥gkl−l+1 · · · gkl∥> kl(λ1(μ) + 2ω/3)

≤e−τk.
The norm is submultiplicative, hence for k large enough,
P

log∥g1 · · · gkl∥> kl(λ1(μ) + 2ω/3)

≤e−τk.

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
161
For any m, write m = kl+j with 0 ≤j < k. Using submultiplicativity again, we
see that if log∥g1 · · · gm∥> m(λ1(μ)+ω), then either log∥g1 · · · gkl∥> kl(λ1(μ)+
2ω/3) or there is 1 ≤i ≤j such that log∥gkl+i∥> ω
3l m. Thus,
P

log∥g1 · · · gm∥> m(λ1(μ) + ω)

≤e−τk + lP

log∥g1∥> ω
3l m

.
Finally, since μ has a ﬁnite exponential moment, there is some β > 0 such that
E

∥g1∥β
is ﬁnite. Hence by Markov’s inequality,
P

log∥g1∥> ω
3l m

= P

∥g1∥β > e
βω
3l m
≤e−βω
3l mE

∥g1∥β
.
Put together, we ﬁnd
P

log∥g1 · · · gm∥> m(λ1(μ) + ω)

≤e−κm
for κ = 1
2 min{ τ
l , βω
3l } and m large enough.
⊓⊔
Appendix B: The Case of a Torus
Here we explain how to remove the Zariski connectedness assumption in the main
theorem of [15]. Namely, the goal is the following.
Theorem B.1 Let X = Rd/Zd. Let μ be a probability measure on Aut(X) =
GLd(Z) having a ﬁnite exponential moment. Let  denote the subgroup generated
by the support of μ. Assume that the action of  on Rd is strongly irreducible. Then
given any λ ∈(0, λ1,Rd(μ)), there exists a constant C = C(μ, λ) ≥1 such that the
following holds. If x ∈X satisﬁes
| 
μ∗n ∗δx(a)| > t
and
n ≥C log ∥a∥
t
for some a ∈Zd \ {0} and t ∈(0, 1
2), then there exists a rational point x′ ∈X of
denominator at most ( ∥a∥
t )C such that d(x, x′) ≤e−λm.
The corresponding statement for afﬁne random walks is the following. Recall
that θ : Aff(X) →Aut(X) denote the linear part.
Theorem B.2 Let X = Rd/Zd. Let μ be a ﬁnitely supported probability measure
on Aff(X) = GLd(Z) ⋉Rd. Let  denote the subgroup generated by the support of
θ∗μ. Assume that the action of  on Rd is strongly irreducible. Then given any λ ∈
(0, λ1,Rd(μ)), there exists a constant C = C(θ∗μ, λ) ≥1 such that the following
holds. If x ∈X satisﬁes

162
W. He et al.
| 
μ∗n ∗δx(a)| > t
and
n ≥C log ∥a∥
t
for some a ∈Zd \{0} and t ∈(0, 1
2), then there exists a point x′ ∈X and a ﬁnite set
F ⊂Aff(X) such that d(x, x′) ≤e−λm, dH(Supp(μ), F) ≤e−λm, and moreover,
denoting by H the subgroup generated by F, the orbit Hx′ is ﬁnite of cardinality at
most ( ∥a∥
t )C.
In view of [8, Lemma 4.5] or alternatively Lemma 4.2, Theorem B follows.
The key point is a Fourier decay estimate for (θ∗μ)∗n, stated as Theorem B.7
below, replacing [15, Theorem 3.20]. To establish this Fourier decay property, we
ﬁrst need a Fourier decay estimate for multiplicative convolutions of measures
having nice non-concentration properties, Theorem B.3. Then in Sect. B.2, using
return times and the special case of Zariski-connected groups, we obtain a decom-
position of (θ∗μ)∗n as a sum of multiplicative convolutions of measures having the
required non-concentration properties. Once Theorem B.7 is established, the rest of
the proof of Theorem B.1 is identical to the corresponding part in [15] and that of
Theorem B.2 to the corresponding part in [16].
B.1
Multiplicative Convolutions in Simple Algebras
First, we need a slight improvement of [15, Theorem 2.1] by allowing the measures
we convolve to be different.
Let E be a normed simple algebra over R of ﬁnite dimension. For x ∈E, denote
by det(x) the determinant of the linear endomorphism E →E, y →xy. For ρ > 0,
write
S(ρ) = { x ∈E | |det(x)| ≤ρ }.
Deﬁnition 4 Let ϵ > 0, κ > 0, and τ > 0 be parameters. We say a Borel measure
η on E satisﬁes NC0(ϵ, κ, τ) at scale δ > 0 if
(i) η

E \ B(0, δ−ϵ)

≤δτ
(ii) For every x ∈E, η(x + S(δϵ)) ≤δτ
(iii) For every ρ ≥δ and every proper afﬁne subspace W ⊂E, η(W (ρ)) ≤δ−ϵρκ,
where W (ρ) denotes the ρ-neighborhood of W
Throughout this appendix, each occurrence of ((t)) with t > 0 denotes an
unspeciﬁed Borel measure of total mass at most t.
Deﬁnition 5 We say a Borel probability measure η on E satisﬁes NC(ϵ, κ, τ) at
scale δ if it can be written as η = η0 + ((δτ)) with η0 satisfying NC0(ϵ, κ, τ) at
scale δ.
Here, NC stands for non-concentration.
Let E∗denote the linear dual of E over R. Recall that the Fourier transform of a
ﬁnite Borel measure ν on E is deﬁned as

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
163
∀ξ ∈E∗,
ˆν(ξ) =

E
e(ξ(x)) dν(x)
where e(t) = e2πit, for t ∈R.
Theorem B.3 (Fourier Decay of Multiplicative Convolutions in Simple Alge-
bra) Let E be a normed simple algebra over R of ﬁnite dimension. Given κ > 0,
there exists s = s(E, κ) ∈N and ϵ = ϵ(E, κ) > 0 such that for any parameter
τ ∈(0, ϵκ), the following holds for any scale δ > 0 sufﬁciently small.
If η1, . . . , ηs are Borel probability measures on E satisfying NC(ϵ, κ, τ) at scale
δ, then for all ξ ∈E∗with δ−1+ϵ ≤∥ξ∥≤δ−1−ϵ,
|(η1 ∗· · · ∗ηs)∧(ξ)| ≤δϵτ.
The special case where η1 = · · · = ηs are the same measure is precisely [15,
Theorem 2.1]. We will deduce the general case from the special case using a trick
from an article of Bourgain and Dyatlov [5].
For measures η and η′ on E, we write η⊞η′ for the additive convolution between
η and η′. Similarly, η ⊟η′ denotes the image measure of η ⊗η′ under the map
(x, y) →x −y. Finally, for integer k ≥1, we write
η⊞k = η ⊞· · · ⊞η
-
.+
,
k times
.
The following two observations on the NC property are immediate.
Lemma B.4 Let ϵ, κ, τ, σ > 0 be parameters and let δ > 0.
(i) If η is a Borel probability measures on E satisfying NC(ϵ, κ, τ) at scale δ, then
η ⊟η satisﬁes NC(O(ϵ), κ, τ/2) at scale δ.
(ii) Convex combinations of probability measures satisfying NC(ϵ, κ, τ) also satisfy
NC(ϵ, κ, τ) at scale δ.
Lemma B.5 Let ϵ, κ, τ, σ > 0 be parameters and let δ > 0. Let η and η′ be Borel
probability measures on E such that η = δση′ + ((1)). If η satisﬁes NC(ϵ, κ, τ) at
scale δ, then η′ satisﬁes NC(ϵ + σ, κ, τ −σ) at scale δ.
Finally, we will need to compare Fourier transform of multiplicative convolutions
with that of multiplicative convolutions of additive convolutions.
Lemma B.6 Let ν, ν′, ν′′ be Borel probability measures on E, and then for any
integer k ≥1, the Fourier transform of ν ∗(ν′⊞k ⊟ν′⊞k) ∗ν′′ takes non-negative
real values and, moreover,
∀ξ ∈E∗,
|(ν ∗ν′ ∗ν′′)∧(ξ)|2k ≤

ν ∗(ν′⊞k ⊟ν′⊞k) ∗ν′′∧(ξ).

164
W. He et al.
Proof By deﬁnition,
(ν ∗ν′ ∗ν′′)∧(ξ) =



e(ξ(xyz)) dν(x) dν′(y) dν′′(z).
By Hölder’s inequality applied to the function (x, z) →

e(ξ(xyz)) dν′(y),
|(ν ∗ν′ ∗ν′′)∧(ξ)|2k
≤


 

e(ξ(xyz)) dν′(y)

2k
dν(x) dν′′(z)
=



e

ξ

x(y1 + · · · + yk −yk+1 −· · · −y2k)z

× dν′⊗2k(y1, . . . , y2k) dν(x) dν′′(z)
=

ν ∗(ν′⊞k ⊟ν′⊞k) ∗ν′′∧(ξ).
⊓⊔
Proof of Theorem B.3 For λ = (λ1, . . . , λs) ∈Cs, deﬁne
ηλ = λ1η1 ⊟η1 + · · · + λsηs ⊟ηs.
Consider the function F : Cs →C deﬁned by
F(λ) = 5
η∗s
λ (ξ) = (ηλ ∗· · · ∗ηλ)∧(ξ).
For all λ = (λ1, . . . , λs) ∈Rs with λ1 + · · · + λs = 1, by Lemma B.4, ηλ satisfy
NC(ϵ, κ, τ/2) at scale δ. Hence by [15, Theorem 2.1], we can bound
|F(λ)| ≤δϵ0τ
for some ϵ0 = ϵ0(E, κ).
Observe that F(λ) is a homogeneous polynomial function of degree s. Then
above implies
|∂1 · · · ∂sF(0, . . . , 0)| ≪δϵ0τ.
The left-hand side is the coefﬁcient of the monomial term λ1 · · · λs, which is
∂1 · · · ∂sF(0, . . . , 0) =

σ∈Ss

(ησ(1) ⊟ησ(1)) ∗· · · ∗(ησ(s) ⊟ησ(s))
∧(ξ).
By Lemma B.6, each term of the right-hand side is non-negative real. It follows that

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
165

(η1 ⊟η1) ∗· · · ∗(ηs ⊟ηs)
∧(ξ)
 ≪δϵ0τ.
In view of Lemma B.6, this concludes the proof of the theorem.
⊓⊔
B.2
Fourier Decay for Linear Random Walks
From now on let μ be a probability measure on Aut(Td) = GLd(Z). Let λ1
denote the top Lyapunov exponent of μ and let  denote the subgroup generated
by Supp(μ). We assume
(i) The measure μ has a ﬁnite exponential moment
(ii) The action of  on Rd is strongly irreducible
Let G denote the Zariski closure of  in GLd and G◦the identity component of G;
then 0 =  ∩G◦is a ﬁnite index subgroup of . Let E denote the subalgebra
generated by G◦(R). If γ1, . . . , γJ are a complete set of representatives for the
cosets in /0, then for any γ ∈, we have that γ E = γjE for some 1 ≤j ≤J.
Theorem B.7 (Fourier Decay for Random Walks in GLd(Z)) Let , μ, and
γ1, . . . , γJ be as above. Then there exists α0 = α0(μ) > 0 such that for every
α ∈(0, α0), there exists c = c(μ, α) > 0 such that for all n sufﬁciently large, all
1 ≤j ≤J and ξ ∈E∗with
eαn ≤eλ1n∥ξ∥≤eα0n
the following estimate on Fourier coefﬁcients of μ∗n holds:


γj E
e

ξ(γ −1
j
g)

dμ∗n(g)
 ≤e−c0n.
Let (gn)n≥1 be a sequence of independent random variables distributed according
to μ. Consider the return times to G◦,
τ(1) = inf{ n ≥1 | gn · · · g1 ∈G◦}
and recursively for m ≥2,
τ(m) = inf{ n > τ(m) | gn · · · g1 ∈G◦}.
They are the return times of a Markov chain on the ﬁnite space G/G◦. Thus for
every m ≥1, τ(m) is almost surely ﬁnite.
Let μ◦denote the law of gτ(1) · · · g1, which is a probability measure on G◦. It
has the following properties.

166
W. He et al.
Lemma B.8 ([1, Lemma 4.40]) If μ has a ﬁnite exponential moment, then so
does μ◦.
Denote T = E[τ(1)]. Let λ1 = λ1(μ) denote the top Lyapunov exponent of μ.
Lemma B.9 ([1, Lemma 4.42]) The top Lyapunov exponent of μ◦is
λ1(μ◦) = T λ1.
Lemma B.10 ([1, Lemma 4.42]) Given ω > 0, there is c = c(μ, ω) > 0 such that
for all m sufﬁciently large,
P

|τ(m) −T m| ≥ωm

≤e−cm.
Note that the support of μ◦generates  ∩G◦, whose Zariski closure is G◦. For
m ≥1, in view of Lemma B.9, it is appropriate to rescale (μ◦)∗m by a factor of
e−T λ1m. Put
˜μ◦
m = (e−T λ1m)∗(μ◦)∗m.
Under the assumptions recalled at the beginning of the paragraph, G◦acts irre-
ducibly on Rd and is Zariski-connected. Thus, we can apply the results in [15,
Section 3] to the random walk deﬁned by μ◦. As explained in [15, Proof of Theorem
3.20], Proposition 3.1 and Proposition 3.2 of [15] imply the following.
Lemma B.11 Write D = dim E. There exists κ = κ(μ◦) > 0 such that given any
α > 0 and ϵ > 0 there exists τ > 0 such that the additive convolution ( ˜μ◦
m)⊞D ⊟
( ˜μ◦
m)⊞D satisﬁes NC(ϵ, κ, τ) in E at all scales δ ∈[e−m, e−αm] for all m ≥1
sufﬁciently large.
For m ≥1 and l ≥1, we deﬁne νl to be the law of the variable
gτ(m) · · · g1
conditional to the event
τ(m) = l.
By this deﬁnition,
(μ◦)∗m =

l∈N
plνl.
(17)
where pl = P[τ(m) = l]. Here, we are hiding the dependency of νl and pl on m in
order to make the notations less cumbersome.
Let n, s and l1, . . . , ls be integers. Consider the events τ(jm) = l1 + · · · + lj,
j = 1, . . . , s. By the Markov property, we have
P

∀j = 1, . . . , s, τ(jm) = l1 + · · · + lj

= pl1 · · · pls

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
167
Now assume that l1+· · ·+ls +k = n with k ≥0 and condition the variable gn · · · g1
according to the events above. We obtain a decomposition
μ∗n =

l1+···+ls+k=n
pl1 · · · plsμ∗k ∗νls ∗· · · ∗νl1 + ((P[τ(sm) > n])).
(18)
With these preparations, the proof of Theorem B.7 is not difﬁcult.
Proof of Theorem B.7 Let α > 0 be given. In this proof, each occurrence of c
denotes a small positive constant depending on μ and α but independent of n.
Let κ = κ(μ◦) > 0 be the constant given by Lemma B.11. Let s = s(E, κ) ≥1
and ϵ = ϵ(E, κ) > 0 be the constants given by Theorem B.3. By Lemma B.11,
there exists τ > 0 such that ( ˜μ◦
m)⊞D ⊟( ˜μ◦
m)⊞D satisﬁes NC(ϵ/2, κ, 2τ) in E at
all scales δ ∈[e−m, e−αm/2], provided that m ≥1 is large enough. Without loss of
generality, we may assume τ < κϵ, τ < ϵ/2.
Let ω = ω(μ, α) to be a constant whose value is to be determined later. For
n ≥1, and choose m =
6
n
(T +ω)s
7
. Everything below is true for n sufﬁciently large
(larger than some n0 depending on μ and α). By Lemma B.10, we have
P[τ(sm) > n] ≤e−cn
and
P[τ(sm) < n −3ωn] ≤e−cn.
Put
L = { l ∈N | pl ≥e−ατ
4D m }.
We can bound

(l1,...,ls)̸∈Ls
pl1 · · · pls ≤sne−ατ
4D m ≤e−cn.
Thus, (18) becomes
μ∗n =

l1,...,ls∈L,k≤3ωn
l1+···+ls+k=n
pl1 · · · plsμ∗k ∗νls ∗· · · ∗νl1 + ((e−cn)).
Let γ be one of γ1, . . . , γJ . To ﬁnish the proof of the theorem, it sufﬁces to establish
an upper bound for the quantity
Il1,...,ls,k(ξ) :=

γ E
e

ξ(γ −1g)

d

μ∗k ∗νls ∗· · · ∗νl1

(g)

168
W. He et al.
uniformly for all l1, . . . , ls ∈L, k ≤3ωn with l1 + · · · + ls + k = n.
Indeed, developing ( ˜μ◦
m)⊞D ⊟( ˜μ◦
m)⊞D using (17), we see
( ˜μ◦
m)⊞D ⊟( ˜μ◦
m)⊞D = p2D
l
(e−T λ1m)∗

ν⊞D
l
⊟ν⊞D
l

+ ((1)).
Since p2D
l
≥e−ατm/2
≥δτ for l
∈L, it follows from Lemma B.5 that
(e−T λ1m)∗

ν⊞D
l
⊟ν⊞D
l

satisﬁes NC(ϵ, κ, τ) at all scales δ ∈[e−m, e−αm/2],
provided that m ≥1 is large enough.
Theorem B.3 tells us that for (l1, . . . , ls) ∈Ls, for all ξ ∈E∗with eαm/2 ≤
eT λ1sm∥ξ∥≤em,


ν⊞D
ls
⊟ν⊞D
ls

∗· · · ∗

ν⊞D
l1
⊟ν⊞D
l1
∧
(ξ)
 ≤e−αϵτm/2.
Using Lemma B.6 repeatedly s times, we obtain, for all ξ ∈E∗in the same range,

νls ∗· · · ∗νl1
∧(ξ)
 ≤e−
αϵτ
2(2D)s m ≤e−cn,
Let E acts on E∗on the right by
∀x, y ∈E, ∀ξ ∈E∗,
(ξ · x)(y) = ξ(xy).
For every γ ∈ and every ξ ∈E∗, we have
Il1,...,ls,k(ξ) =

γ E
(νls ∗· · · ∗νl1)∧(ξ · γ −1g) dμ∗k(g).
Note that for any g ∈γ E ∩,
∥ξ∥∥g−1∥−1 ≪γ ∥ξ · γ −1g∥≪γ ∥ξ∥∥g∥.
(19)
Using the assumption that μ has a ﬁnite exponential moment and Markov’s
inequality, we can ﬁnd a constant C = C(μ) ≥1 such that for any k ≥1, the
μ∗k-measure of the set of g ∈ such that
∥g∥≤eCk
and
∥g−1∥≤eCk
(20)
is at least 1 −e−k.
Set α0 =
1
4T s and let ξ ∈E∗be such that eαn ≤eλ1n∥ξ∥≤eα0n. Using
(1 −2ω)n ≤T sm ≤n and k ≤3ωn, we have, for any g ∈Supp(μ∗k) satisfying
(20),
e(α−(2λ1+4C)ω)n ≤eT λ1sm∥ξ · γ −1g∥≤e(α0+4Cω)n.

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
169
Here we assumed n to be larger than a constant depending on γ to beat the implied
constant in the ≪γ notation in (19). With the choice ω = min{
α
4λ1+8C ,
1
16CT s }, we
can guarantee that this implies
eαm/2 ≤eT λ1sm∥ξ · γ −1g∥≤em.
Putting everything together, we obtain
|Il1,...,ls,k(ξ)| ≤e−cn
for all l1, . . . , ls ∈L, k ≤3ωn with l1 + · · · + ls + k = n. This concludes the proof
of the theorem.
⊓⊔
B.3
Proof of Theorems B.1 and B.2
Let μ be a Borel probability measure on GLd(Z) ⋉Rd having a ﬁnite exponential
moment. Let x ∈X be a point. We shall use the shorthand νn = μ∗n ∗δx. Assume
that for some a ∈Zd \ {0} and t ∈(0, 1
2) and for some large n, we have
|	
νn(a)| > t.
(21)
Let  denote the group generated by θ∗μ. Let G denote the Zariski closure of 
and G◦the identity component of G. Let E be the subalgebra generated by G◦(R).
Let γ1, . . . , γJ be a complete set of representatives for the cosets in /( ∩E). For
any integer m, the we can decompose
(θ∗μ)∗m =
J

j=1
(γj)∗μm,j
where μm,j is a measure on  ∩E. By Theorem B.7, for m large enough, we have
the Fourier decay property for each μm,j,
∀ξ ∈E∗with eαm ≤eλ1m∥ξ∥≤eα0n,
| 8
μm,j(ξ)| ≤e−c0n.
Writing νn = μ∗m ∗νn−m, we have
	
νn(a) =


e(⟨a, gy⟩) dμ∗m(g) dνn−m(y)
=
J

j=1


e(⟨a, gy⟩)1γj E(θ(g)) dμ∗m(g) dνn−m(y)

170
W. He et al.
Thus, (21) implies that there exists j ∈{1, . . . , J} such that
t ≪



e(⟨a, gy⟩)1γj E(θ(g)) dμ∗m(g) dνn−m(y)

By Hölder’s inequality,
t2k ≪

 

e(⟨a, gy⟩)1γj E(θ(g)) dμ∗m(g)

2k
dνn−m(y)
After developing the 2k-power and separating the linear part with the translation
part, we obtain
t2k ≪

(γj E)2k

νn−m((g1 + · · · + gk −gk+1 −· · · −g2k)tra)

× d

(θ∗μ)∗m⊗2k(g1, . . . , g2k).
That is,
t2k ≪

 
νn−m(gtrγ tr
j a)
 d

μ⊞k
m,j ⊟μ⊞k
m,j

(g).
Then, the same argument in the proof of [15, Proposition 4.1] leads to
Proposition B.12 There are constants C ≥1 and σ > τ > 0 depending only on
θ∗μ such that for m ≥C|log t|, the above implies that there exists a r0-seperated
subset Q ⊂Rd/Zd such that
νn−m
 
x∈Q
B(x, ρ0)

≥tC
where ρ0 = e−σm∥a∥and r0 = eτmρ0.
From here on, the proof of Theorem B.1 is identical to that of [15, Theorem
1.2] and that of Theorem B.2 is identical to that of [16, Theorem 1.3]. That is, the
Zariski-connectedness condition is not used in the relevant parts in [15] and [16].
References
1. Aoun, R.: Random subgroups of linear groups are free. Duke Math. J. 160(1), 117–173 (2011).
MR 2838353
2. Bekka, B., Guivarc’h, Y.: On the spectral theory of groups of afﬁne transformations of compact
nilmanifolds. Ann. Sci. Éc. Norm. Supér. (4) 48(3), 607–645 (2015). MR 3377054

Equidistribution of Afﬁne Random Walks on Some Nilmanifolds
171
3. Bekka, B., Heu, J.-R.:Random products of automorphisms of Heisenberg nilmanifolds and
Weil’s representation. Ergodic Theory Dyn. Syst. 31(5), 1277–1286 (2011). MR 2832245
4. Benoist, Y., Quint, J.: Stationary measures and invariant subsets of homogeneous spaces (iii).
Ann. Math. 178, 1017–1059 (2013)
5. Bourgain, J., Dyatlov, S.: Fourier dimension and spectral gaps for hyperbolic surfaces. Geom.
Funct. Anal. 27(4), 744–771 (2017). MR 3678500
6. Bourgain, J., Furman, A., Lindenstrauss, E., Mozes, S.: Stationary measures and equidistri-
bution for orbits of nonabelian semigroups on the torus. J. Am. Math. Soc. 24(1), 231–280
(2011). MR 2726604
7. Boyer, J.-B.: On the afﬁne random walk on the torus (2017). e- prints: arXiv:1702.08387
8. Boyer, J.-B.: Almost sure functional central limit theorem for the linear random walk on the
torus. Probab. Theory Related Fields 173(1–2), 651–696 (2019). MR 3916116
9. Butzer, P.L., Nessel, R.J.: Fourier Analysis and Approximation (Academic Press, New York-
London, 1971). Volume 1: One-Dimensional Theory, Pure and Applied Mathematics, vol. 40.
MR 0510857
10. Corwin, L.J., Greenleaf, F.P.: Representations of Nilpotent Lie Groups and Their Applications.
Part I. Cambridge Studies in Advanced Mathematics, vol. 18 (Cambridge University Press,
Cambridge, 1990). Basic theory and examples. MR 1070979
11. Eskin, A., Lindenstrauss, E.: Random walks on locally homogeneous spaces. Preprint
12. Furman, A., Shalom, Y.: Sharp ergodic theorems for group actions and strong ergodicity.
Ergodic Theory Dyn. Syst. 19(4), 1037–1061 (1999). MR 1709429
13. Guivarc’h, Y., Starkov, A.N.: Orbits of linear group actions, random walks on homogeneous
spaces and toral automorphisms. Ergodic Theory Dyn. Syst. 24(3), 767–802 (2004). MR
2060998
14. He, W.: Random walks on linear groups satisfying a Schubert condition. Israel J. Math. 238(2),
593–627 (2020). MR 4145811
15. He, W., de Saxcé, N.: Linear random walks on the torus. Duke Math. J. 171(5), 1061–1133, (1
April 2022). MR 4402559
16. He, W., Lakrec, T., Lindenstrauss, E.: Afﬁne Random Walks on the Torus. International
Mathematics Research Notices (2021), rnaa322
17. Muchnik, R.: Semigroup actions on Tn. Geom. Dedicata 110, 1–47 (2005). MR 2136018
18. Raghunathan, M.S.: Discrete Subgroups of Lie Groups (Springer, New York-Heidelberg,
1972). Ergebnisse der Mathematik und ihrer Grenzgebiete, Band 68. MR 0507234
19. Wang, Z.: Quantitative density under higher rank abelian algebraic toral actions. Int. Math.
Res. Not. IMRN (16), 3744–3821 (2011). MR 2824843

Logarithmic Quantum Dynamical
Bounds for Arithmetically Deﬁned
Ergodic Schrödinger Operators with
Smooth Potentials
Svetlana Jitomirskaya and Matthew Powell
Dedicated to the memory of Jean Bourgain
Abstract We present a method for obtaining power-logarithmic bounds on the
growth of the moments of the position operator for one-dimensional ergodic
Schrödinger operators. We use Bourgain’s semialgebraic method to obtain such
bounds for operators with multifrequency shift or skew-shift underlying dynamics
with arithmetic conditions on the parameters.
1
Introduction
It is well known that Anderson localization (pure point spectrum with exponentially
decaying eigenfunctions) is highly unstable with respect to various perturbations.
For quasiperiodic operators, it very sensitively depends on the arithmetics of the
phase (a seemingly irrelevant parameter from the point of view of the physics of
the problem) and doesn’t hold generically [15]. It can also be destroyed by generic
rank one perturbations [7, 10]. This instability is therefore also present for the—
very physically relevant—notion of dynamical localization, deﬁned as non-spread
of the initially localized wave packet or boundedness in time of the moments of the
position operator (see (3)).
Thus moments of the position operator for generic rank one perturbations of
many operators with a.e. dynamical localization are unbounded in time. This bizarre
situation is partially rescued by a result of [5, 6]: when eigenfunctions have an
additional SULE (semi-uniform localization) property, the moments of the position
operators of all rank-one perturbations grow at most power-logarithmically. Indeed
SULE has since been proved for all operators with localization that come from
physically realizable models. From this point of view, power-logarithmic bounds of
S. Jitomirskaya () · M. Powell
Department of Mathematics, University of California, Irvine, CA, USA
e-mail: szhitomi@uci.edu; szhitomi@math.uci.edu; mtpowell@uci.edu
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
A. Avila et al. (eds.), Analysis at Large, https://doi.org/10.1007/978-3-031-05331-3_8
173

174
S. Jitomirskaya and M. Powell
the moments are the stable—and therefore physically relevant—property, making it
worthwhile to prove directly for operator families with (expected) a.e. localization,
bypassing the localization proof. This, in particular, includes one-dimensional
ergodic operator families Hω,x : ℓ2(Z) →ℓ2(Z) given by
(Hω,xψ)(n) = ψ(n −1) + ψ(n + 1) + V (T n
ω (x))ψ(n),
(1)
where Tω is an ergodic transformation and V is a real-valued function, in the regime
of positive Lyapunov exponents.
Direct proofs of upper quantum dynamical bounds for quasiperiodic and other
ergodic operators with positive Lyapunov exponents have been done, in increasing
generality in [8, 11, 14]. In all these cases, the results featured the desired stability
in phase and often were also arithmetic in frequency (in contrast with many
localization proofs). All the papers mentioned above obtain vanishing of the
transport exponents β(p) (see (4)), which implies sub-polynomial growth of the
moments. Here we present a method that allows to improve this to the desired
power-logarithmic bounds. We note that our results are also phase-stable and our
frequency conditions are arithmetic. The only previous direct proof of power-
logarithmic bounds was done for the Anderson model in [16] based on different
considerations, but we note that for the Anderson model, localization always holds
([4] or sees a very simple recent argument in [18]). Thus, to the best of our
knowledge, we present the ﬁrst proof of power-logarithmic quantum dynamical
bounds for models without localization.
To get such bounds we, inspired by the theory of logarithmic dimension
developed in [23], introduce the notion of logarithmic transport exponents (see (5))
and obtain estimates for them.
Technically, our method goes back to [12] where the existence of transfer
matrices growing appropriately along a subsequence was ﬁrst used to prove
zero Hausdorff dimension of spectral measures for one-frequency quasiperiodic
operators, including in situations where localization cannot hold. The ideas of [12]
were ﬁrst applied in [8] to obtain vanishing transport exponents for those models,
and then this was further modiﬁed and developed in [14] to allow very rough
functions. These methods however required continued fraction techniques and did
not extend naturally even to the case of higher-dimensional tori. This was tackled
in [11] which developed a method allowing to handle general dynamics of zero
topological entropy. Here, for our one-frequency result, we go back to the approach
of [8, 12, 14]. The method of [11] however is too rough for the logarithmic scale. It
turns out that for higher-dimensional shifts and skew-shifts already the basics of the
Bourgain’s semialgebraic/large deviations method [3] are ideally suited to obtain
the desired power-logarithmic bounds on the moments.
The key estimate from Bourgain’s method used here is the sublinear bound (23)
on the number of hits of a semialgebraic set by a shift [3] or skew-shift [22]
trajectory. In fact, all we need is a much weaker statement: the existence of at
least one miss in sublinear time, which of course follows from the sublinear bound.
We make some explicit estimates on the power used in the sublinear bound (23)

Quantum Dynamical Bounds for Ergodic Operators
175
in Sect. 4. The sublinear bound was also fruitfully used in a recent work [13] to
establish vanishing of transport exponents β(p) (thus subpolynomial bounds on the
moment growth) for long-range quasiperiodic operators, for which the authors of
[13] developed a non-transfer matrix-based approach. It is an interesting question
whether power-logarithmic bounds can be also obtained in that case.
We cover all scenarios where a.e. Anderson localization has been proved for
one-dimensional operators with analytic quasiperiodic and skew-shift potentials as
described in Bourgain’s book [3] and with Gevrey extensions in [19, 20]. For all
these models, the a.e. dynamical localization was also shown to hold [2]. Essentially,
what we demonstrate by this work is that power-logarithmic bounds on transport can
be viewed as dynamical localization-light, since the proof is considerably simpler
than that of localization and in fact can be obtained in many known scenarios as a
part of the latter proof. Yet the results are phase-stable and presumably optimal as far
as phase-stable results go. Just as with Anderson localization, our theorems are non-
perturbative (obtained as a corollary of positive Lyapunov exponents) for analytic
potentials over toral shifts and Gevrey potentials for one-frequency shifts, while they
require large coupling constants dependent on the frequency for the multifrequency
Gevrey and skew-shift cases. We note, however, that all such dependence comes
from the large deviation estimates that we use as a black box; we don’t add any
further “perturbative” components through our technique.
We proceed to formulate our main results. Consider the time-averaged quantity:
a(n, T ) = 2
T

 ∞
0
e2t/T 1
2

9
eitHω,xδ0, δn
:
2
+

9
eitHω,xδ1, δn
:
2
dt,
(2)
where δn(m) = 1 when m = n and 0 otherwise.
Dynamical localization is characterized by boundedness in time of the moments
of the position operator:
;
|X|p(T )
<
=

n∈Z
(1 + |n|)pa(n, T ).
(3)
For simplicity, we are restricting our attention to time-averaged quantities rather
than considering a(n, t) = 1
2
;
eitHω,xδ0, δn
<2 +
;
eitHω,xδ1, δn
<2
, but our anal-
ysis can be carried through for non-time-averaged quantities as well, following the
ideas in [8]. We only consider time-averaging for a small simpliﬁcation.
Dynamical localization always implies Anderson localization but is strictly
stronger [6, 17] . When dynamical localization does not hold, the moments of the
position are unbounded in time, and a natural quantity of interest is how fast this
growth is. Classically, this is captured by the upper and lower transport exponents:
β+(p) = lim sup
t→∞
ln ⟨|X|p(t)⟩
p ln t
;
β−(p) = lim inf
t→∞
ln ⟨|X|p(t)⟩
p ln t
,
(4)

176
S. Jitomirskaya and M. Powell
which describe power-law bounds on the growth of the moments. It is known that,
under very relaxed conditions (c.f. [11]), the transport exponents vanish when the
Lyapunov exponent is positive. Let us reﬁne the notion of transport exponents by
deﬁning the logarithmic transport exponents as
β+
ln(p) = lim sup
t→∞
ln ⟨|X|p(t)⟩
p ln ln t
;
β−
ln(p) = lim inf
t→∞
ln ⟨|X|p(t)⟩
p ln ln t
.
(5)
Our ﬁrst result is that positivity of the Lyapunov exponent will imply that this
exponent is ﬁnite for every p.
Let Tω represent either the shift or the skew-shift on the torus, Tν, Gσ(Tν)
denote the Gevrey class, L(E) denote the Lyapunov exponent, and DC(A, c) and
SDC(A, c) denote Diophantine conditions (see Sect. 2 for the relevant deﬁnitions).
In this regime, we have the following.
Theorem 1.1 Let Hω,x be an operator of the form (1) with Tω given by the shift
on T, and either f is analytic or f ∈Gσ(T), σ > 1, and obeys the transversality
condition (12). Suppose that L(E) > 0 for every E ∈R. Then for any x ∈T, ϵ > 0
and m > 0,
(1) If ω ∈R\Q, then lim infT →∞
⟨|X|m(T )⟩
(ln T )m(σ+1+ϵ) < ∞.
(2) If ω ∈DC(A, c), then lim supT →∞
⟨|X|m(T )⟩
(ln T )m(σ+1+ϵ) < ∞.
Remark 1 We can rewrite the conclusions of Theorem 1.1 as follows:
(1) If ω ∈R\Q, then β−
ln(p) ≤1 + σ for every p > 0 and x ∈T.
(2) If ω ∈DC(A, c), then β+
ln(p) ≤1 + σ for every p > 0 and x ∈T.
Remark 2 For analytic f the conclusion holds with σ = 1.
We have similar logarithmic quantum-dynamical bounds for non-constant ana-
lytic potentials on higher-dimensional tori.
Theorem 1.2 Let Hω,x be an operator of the form (1) with Tω given by the shift
on Tν with ν > 1. Suppose also that f is a non-constant analytic function on Tν,
ω ∈DC(A, c) and that L(E) > 0 for every E ∈R. Then there exists γ = γ (ν, A)
such that, for every m > 0,
β±
ln(m) ≤γ.
(6)
for all x ∈Tν.
Remark 3 For analytic f, the condition L(E) > 0 for every E ∈R is satisﬁed for
λf, where λ > λ0(f ). Also we have as an immediate corollary that there exists γ (ν)
such that for a.e. ω ∈Tν, β±
ln(m) ≤γ (ν) for every m > 0.
Things become a bit more technical when we consider the multifrequency shift
with potentials in the Gevrey class, or when considering the skew-shift instead of
the shift.

Quantum Dynamical Bounds for Ergodic Operators
177
Theorem 1.3 Let x ∈Tν. Let Hω,x be an operator of the form (1) with Tω given
by the shift on Tν with ν > 1. Suppose also that f = λf0 ∈Gσ(Tν) such that f0
obeys the transversality condition (12), ω ∈DC(A, c) and that L(E) > 0 for every
E ∈R. Then there exists λ0 = λ0(f0, ω) > 0 and γ = γ (σ, ν, A) such that, for
every λ > λ0 and m > 0,
β±
ln(m) ≤γ.
(7)
Remark 4 The condition on λ0 comes from [19] and is necessary to obtain and use
a large deviation estimate which is critical to our proof. See Theorem 2.4.
Theorem 1.4 Let Hω,x be an operator of the form (1) with Tω given by the
skew-shift on Tν, suppose f = λf0 ∈Gσ(Tν) such that f0 obeys (12), and
ω ∈SDC(A, c), for some A ≤2. Suppose that L(E) > 0 for every E ∈R.
Then there exists λ0 = λ0(f0, ω) > 0 and γ = γ (σ, ν, A) such that for every
λ > λ0 and m > 0,
β±
ln(m) ≤γ.
(8)
for all x ∈Tν.
Remark 5 As mentioned earlier, the perturbative nature of Theorems 1.3 and 1.4 is
fully captured in the ω-dependence of λ0 that comes from [19, 20], while the bound
γ that we prove to exist is constant for a.e. Diophantine ω.
Remark 6 We will see in our proof that the γ that appears in Theorems 1.3 and 1.4
has ω-dependence which appears precisely as the constant δ from (23). It is possible
to explicitly compute γ = C(σν + 1)

1
δ

. Here C is a universal constant C =
C(ν). The constant δ is different for the shift and skew-shift and will be obtained by
semialgebraic methods in Sect. 4, where we obtain the explicit estimates δ ≤
1
A+ν
for the shift and δ <
1
Aν2ν−1 for the skew-shift.
Remark 7 One of the only places where there is still room for improvement in this
approach is the estimate on δ in Theorem 2.2. The closer δ is to 1, the smaller γ
will be and thus the better the localization result. Our estimate for the shift follows
from a harmonic analysis approach given by Bourgain. For ω ∈DC(A, c), other
estimates have been obtained by other authors using alternative methods (c.f. [11]
and [22]), but when A ≫1, our localization result is stronger.
We note that the method in [11] while applicable to all our models and a lot more
is insufﬁcient to obtain ln-type estimates which we are after here, largely because
it allows to ﬁnd the required exponential growth of the transfer matrix only on
polynomially large length scales, whereas the growth needs to be on logarithmic
length scales to obtain ln-type estimates.
Related to dynamical bounds are dimensional bounds on spectral measures. It
is known that positive Lyapunov exponent implies that the spectral measures have

178
S. Jitomirskaya and M. Powell
Hausdorff dimension zero for every phase. A ﬁner notion, introduced in [21] and
explored in more generality in [23], is the logarithmic dimension. In short, we
say that the upper logarithmic dimension of a measure, μ, is less than α if the
measure is supported on a set of logarithmic dimension less than α. A result due to
Simon [24] says that spectral measures for 1D quasiperiodic operators with positive
Lyapunov exponent are supported on a set of logarithmic capacity 0 for a.e. phase.
This implies that the upper logarithmic dimension of the spectral measures is at most
1 for a.e. phase. It leaves unclear what happens on this null set of phases. Moreover,
while upper bounds on quantum dynamics imply suitable upper bounds on upper
dimension of spectral measures, the reverse is not, in general, true. Indeed, examples
are known where the spectral measure is pure point but quantum dynamics is
even quasi-ballistic (see [6]). Since we prove power-logarithmic quantum dynamics
bounds for all phase, a consequence is a (weaker) bound on the upper logarithmic
dimension for every phase. Thus, while we obtain weaker dimensional estimates
this way, we are able to handle every phase, not just a.e. phase.
By Theorem 2.6 from [23], we have the following corollary.
Corollary 1.1 Under the assumptions of Theorem 1.1, with ω ∈DC(A, c), we
have dim+
ln(μ) ≤1 + σ, where μ is the spectral measure related to δ0 and Hω,x.
Under the assumptions of Theorem 1.3, we have dim+
ln(μ) ≤γ.
Other quantities have been proposed for studying dynamical localization-type
estimates, see [1, 8], but one of the major advantages of β±
ln(p) is that, similar to
β±(p), it is stable under perturbations in certain circumstances. See Theorem 1.5
part (b) for a precise statement.
One transfer matrix-based way to approach upper dynamical bounds goes back
to a scheme by Damanik and Tcheremchantsev [8] wherein the quantity β±(p) was
related to suitable growth of the transfer matrices along suitable length scales (see
also [16]). In this paper, we reﬁne this scheme to allow us to obtain ﬁner dynamical
estimates. Our contribution is the following theorem, which required us to address
certain technical limitations in the original argument (see Sect. 2.2 for the relevant
deﬁnitions and Sect. 3 for full details).
Theorem 1.5 Suppose H1 is of the form (1) with bounded potential v1 and
σ(H1) ⊂[−K + 1, K −1].
(a) Suppose for all δ < ∞and T > T0, we have

 K
−K

min
l=±1
max
1≤lj≤(ln T )γ

Av1,E+i/T
j
(x)


2−1
dE = O(T −δ)
(9)
for some γ > 1. Then β+
ln,1(p) ≤γ, where β+
ln,1(p) is the transport exponent
associated to H1. If the above condition holds for a sequence Tn →∞, then
β−
ln,1(p) ≤γ.
(b) In addition to the above, suppose also that H2 is an operator of the form (1)
with bounded potential v2 such that σ(H2) ⊂[−K + 1, K −1] and suppose

Quantum Dynamical Bounds for Ergodic Operators
179
that there exists B > 0 such that for all E ∈[−K + 1, K −1], 0 < ϵ ≤1, and
|n| ≤ln(ϵ−1),
ϵB 
Av1,E+iϵ
n

 ≲

Av2,E+iϵ
n

 ≲ϵ−B 
Av1,E+iϵ
n

 .
(10)
Then β±
ln,2(p) ≤γ for every p > 0, where β±
ln,2(p) is the transport exponent
associated to H2.
Remark 8 It is worth noting that Theorem 1.5 is a purely deterministic result and
thus holds for general operators of the form
(Hu)(n) = u(n −1) + u(n + 1) + V (n)u(n),
where V is a bounded sequence of real numbers.
Theorem 1.5 is similar to Theorem 1 in [8], but there is a major issue with just
repeating the proof of Theorem 1 in [8] using (ln T )γ in place of T γ . The problem
is that the result in [8] a priori assume that β±(p) < ∞for every p > 0. This is the
well-known ballistic upper bound. We do not, unfortunately, have a similar a priori
estimate on β±
ln(p), even when β±(p) = 0, which means the original argument is
insufﬁcient. Our main technical achievement on the way to a proof of Theorem 1.5
is a sufﬁcient condition (Theorem 3.2) under which we can say β±
ln(p) < C <
∞for every p > 0. Once we have this, we can use the ideas from [8] to obtain
Theorem 1.5.
This essentially reduces the problem of bounding log-transport exponents to
obtaining lower bounds on the growth of the transfer matrix along particular length
scales. This will be done in a two-step process. First, we will demonstrate that, for
a ﬁxed energy and frequency, transfer matrix growth can be suboptimal only for a
set of phases of small measure. This will be captured by so-called large deviation
estimates. Then we will show that every phase will correspond to a transfer matrix
with good growth after at most power-log many iterates of the transformation.
The rest of our paper is organized in the following way. In Sect. 2 we introduce
the relevant deﬁnitions needed for our paper. Section 2.2 is devoted to those
deﬁnitions needed for the proof of Theorem 1.5. Section 2.3 recalls facts about
semialgebraic sets which will be necessary for the proof of Theorem 1.3. Section 2.4
recalls the large deviation theorems needed for measure estimates. We prove
Theorem 1.5 in Sect. 3. We explicitly compute discrepancy bounds in Sect. 4. We
prove two technical lemmas regarding the set of “good” phases in Sect. 5. Finally,
we prove Theorem 1.1 in Sect. 6 and Theorem 1.3 in Sect. 7. Proofs of Theorems 1.2
and 1.4 are essentially identical to that of Theorem 1.3. However, we describe the
small changes needed in, correspondingly, Sects. 8 and 9.

180
S. Jitomirskaya and M. Powell
2
Preliminaries
2.1
Schrödinger Operators and Transfer Matrices
We consider the two particular types of Schrödinger operator, Hω,x : ℓ2(Z) →
ℓ2(Z) given by
(Hω,xψ)(n) = ψ(n −1) + ψ(n + 1) + f (T n
ω (x))ψ(n), n ∈Z.
(11)
The ﬁrst case we consider is where x ∈Tν, Tω is the shift: Tωx = x + ω and
ω = (ω1, ..., ων) and (ω1, ..., ων, 1) are rationally independent. The second case
we consider is where x ∈Tν, Tω is the skew-shift: Tω(x1, ..., xν) = (x1 + ω, x2 +
x1, x3 + x2, ..., xν + xν+1) and ω ∈R\Q.
Additionally, we recall that Gσ(Tν) denotes the Gevrey class:
Gσ(Tν) =
%
f : Tν →R :
Dαf

∞< C|α|+1(α!)σ&
.
An equivalent deﬁnition of Gσ which we will take advantage of is:
Gσ(Tν) =
%
f : Tν →R : | ˆf (n)| ≤e−|n|1/σ &
.
In both of the cases, we will consider f ∈Gσ(Tν) in (11).
For technical reasons, we will further restrict our attention to those Gevrey class
functions that obey a transversality condition:
Dαf (x) ̸= 0
for any x ∈Tν, α ∈Nν.
(12)
From this point forward, when discussing f ∈Gσ(Tν), we will mean those f ∈
Gσ(Tν) that satisfy (12). Recall that, for any E ∈C, any solution to the eigen-
equation Hω,xψ = Eψ can be reconstructed from the n-step transfer matrix:
Af,E
n
(x) =
1

k=n
f (T k
ω(x)) −E −1
1
0

(13)
by
ψ(n + 1)
ψ(n)

= Af,E
n
(x)
ψ(1)
ψ(0)

.
(14)
We can then deﬁne
Ln(E) = 1
n

ln

Af,E
n
(x)

 dx

Quantum Dynamical Bounds for Ergodic Operators
181
and the Lyapunov exponent is given by
L(E) = lim Ln(E) = inf Ln(E).
We will also need a Diophantine condition. We say that ω ∈DC(A, c) if
||k · ω|| > c|k|−A for every k ∈Zν\{0}. We say that ω ∈SDC(A, c) if
||k · ω|| > c
1
|k|(ln |k|)A . We will only consider ω ∈SDC(A, c) for A ≤2, which
is a restriction imposed by Theorem 2.4. See [19] for details.
In what follows, C and c will denote ﬁnite constants and ϵ will denote a small
constant, all of which can only depend on f, ν, ω, or E. Moreover, these constants
may change throughout a proof, but ϵ will always denote a small constant, and
boundedness of C and c will be unchanged.
2.2
Transport Exponents
Recall that we have deﬁned
β+
ln(p) = lim sup ln ⟨|X|p(t)⟩
p ln ln t
;
β−
ln(p) = lim inf ln
;
|X|p
t
<
p ln ln t .
It is simple to verify via Hölder’s inequality that β±
ln(p) is non-decreasing in p, so
obtaining a bound on β±
ln(+∞) is sufﬁcient for bounding β±
ln(p) for any p > 0.
To bound β±
ln(+∞), for general operators, we will need to deﬁne the so-called
outside probabilities:
Pl(N, T ) =

n<−N
a(n, T )
(15)
Pr(N, T ) =

n>N
a(n, T )
(16)
P(N, T ) = Pl(N, T ) + Pr(N, T )
(17)
=

|n|>N
a(n, T )
(18)
along with associated log-transport quantities:
S+
ln(α) = −lim sup ln(P((ln T )α −2, T ))
ln ln T
(19)
S−
ln(α) = −lim inf ln(P((ln T )α −2, T ))
ln ln T
(20)
α±
ln = sup
#
α ≥0 : S±
ln(α) < ∞
$
.
(21)

182
S. Jitomirskaya and M. Powell
A quick note on our convention here: we use (ln T )α −2 so that S±
ln(0) = 0 as in
[8].
Our goal in Sect. 3 will be to show that, under suitable conditions, β±
ln(p) ≤α±
ln
for every p > 0, which will be used to establish Theorem 1.5.
2.3
Semialgebraic Sets
Deﬁnition 2.1 We say that a set S ⊂Rn is semialgebraic if it can be writ-
ten as a ﬁnite union of polynomial inequalities. More precisely, suppose P =
{p1, . . . , ps} ⊂R[X1, . . . , Xn] is a ﬁnite collection of real polynomials in n
variables, whose degrees are bounded by d. A closed semialgebraic set, S ⊂Rn, is
given by an expression of the form
S =
k
j=1

m∈Qj
#
x ∈Rn : pmsjm0
$
,
(22)
where Qj ⊂{1, ..., s} and sjm ∈{≤, =, ≥} are arbitrary. Moreover, we say that S
has degree at most sd and its degree is the inﬁmum of sd over all representations as
in (22).
Theorem 2.1 ([3] Corollary 9.6) Let S ⊂[0, 1]n be semialgebraic of degree B.
Let ϵ > 0 be a small number and |S| < ϵn, where |·| represents Lebesgue measure.
Then there exists C = C(n) such that S may be covered by at most BCϵ1−n ϵ-balls.
Using these results for general semialgebraic sets, we can obtain sublinear
bounds for the shift and skew-shift.
Theorem 2.2 Let Tω represent either the shift or the skew-shift. Let S ⊂[0, 1]n be
semialgebraic of degree B and |S| < η. Let ω ∈DC(A, c) (when considering the
shift) or ω ∈SDC(A, c) (when considering the skew-shift), and let N be an integer
such that
B ≤N < 1
η.
Then there is C = C(n) and δ = δ(ω) such that for any x0 ∈Tn,
#
%
k = 1, ..., N : T k
ω(x0) ∈S
&
< N1−δBC.
(23)
Remark 9 While the above result holds for any N ≥B, the resulting bound,
N1−δBC, will only be smaller than N when ln(N) > C ln(B), where C = C(n, δ).

Quantum Dynamical Bounds for Ergodic Operators
183
The case where Tω is the shift is due to Bourgain [[3] Corollary 9.7], and the case
for the skew-shift follows from Lemma 8.4 in [22]. The particular δ obtained differs
between the shift and skew-shift, as we will show in Sect. 4.
Remark 10 Different authors obtain different values of δ for the shift (c.f. [22] and
[11]) depending on what method they use. In Sect. 4 we explicitly estimate δ for the
shift using the approach from [3], which turns out to be better than the values from
[22] and [11] when ω ∈DC(A, c), A ≫1.
2.4
Large Deviation Theorems
Throughout the section, we will assume that the energy, E, is such that L(E) > 0.
The estimate we will obtain in Sect. 4 will rely on estimates on the measure of
semialgebraic sets. The particular semialgebraic sets we are interested in are the set
of phases, x, for which 1
n

Af,E
n
(x)

 converges to L(E) slowly. To this end, we
recall the following large deviation theorems, the ﬁrst of which is due to Bourgain,
Goldstein, and Schlag, and the second is due to S. Klein, which quantitatively
measure the rate of convergence.
For the shift model with non-constant analytic potential, there is a well-known
large deviation estimate.
Theorem 2.3 ([3] Theorem 5.5) Assume ω ∈Tν satisﬁes ω ∈DC(A, c). Let f
be a non-constant real analytic function on Tν. Then there is α = α(A) > 0 such
that

!
x ∈Tν :

1
N ln

Af,E
N (x)

 −LN(E)
 < N−α
= < e−Nα.
(24)
For the shift model with Gevrey class potential and skew-shift with analytic or
Gevrey class potential satisfying a transversality condition, we have:
Theorem 2.4 ([19] Theorem 6.1) Assume f ∈Gσ(T ν) satisﬁes a transversality
condition, and suppose f = λf0, for some λ ∈R and f0 ∈Gσ ﬁxed. Let ω ∈
DC(c, A) (for the shift) or ω ∈SDC(A, c), A ≤2 (for the skew-shift). Then there
exists λ0 = λ0(f0, A) such that for every ﬁxed |λ| > λ0 and for every energy E, we
have

!
x ∈Tν :

1
N ln

Af,E
N (x)

 −LN(E)
 < N−τ
= < e−Nα,
(25)
for some constants τ, α > 0 depending only on ν, and every N > N0(λ, c, f0, σ, ν).

184
S. Jitomirskaya and M. Powell
3
Transport Exponents
Our ﬁrst goal in this section is to relate β±
ln(p) to S±
ln. Observe that if S−
ln(α) < +∞,
we have:
P((ln T )α −2, T ) > (ln T )−S−
ln(α)−
(26)
and so
;
|X|p(T )
<
=
+∞

n=−∞
(|n| + 1)pa(n, T )
(27)
≥

|n|>(ln T )α−2
(|n| + 1)pa(n, T )
(28)
≥C(ln T )αpP((ln T )α −2, T )
(29)
≥C(ln T )αp(ln T )−S−
ln(α)−
(30)
= C(ln T )αp−S−
ln(α)−
(31)
and thus
β−
ln(p) ≥α −S−
ln(α)
p
.
(32)
A similar analysis for S+
ln(α) < +∞shows
β+
ln(p) ≥α −S+
ln(α)
p
.
(33)
Together, this shows that
β±
ln(+∞) ≥α±
ln.
(34)
On the other hand, it is possible to use α±
ln to bound β±
ln(+∞) from above:
Theorem 3.1 Let H be an operator of the form (1) with bounded potential and
suppose that for some η > 0, and for all p > 0, we have
;
|X|p(T )
<
< Cp(ln T )ηp.
(35)
Then 0 ≤α±
ln ≤η and
β±
ln(+∞) ≤α±
ln.
(36)

Quantum Dynamical Bounds for Ergodic Operators
185
Remark 11 We can replace (35) with the condition β+
ln(p) < η for every p > 0.
Remark 12 The following proof uses the same ideas as the proof of Theorem 4.1 in
[9].
Proof The bound 0 ≤α±
ln ≤η follows from the computation performed above, so
we will focus on proving (36).
Fix 0 ≤α ≤α+
ln, ϵ > 0 and consider the following:
;
|X|p(T )
<
=
+∞

n=−∞
(|n| + 1)pa(n, T )
(37)
=

|n|≤(ln T )α−2
+

(ln T )α−2<|n|≤(ln T )α+
ln+ϵ/2
(38)
+

(ln T )α+
ln+ϵ/2<|n|≤(ln T )η+ϵ
+

(ln T )η+ϵ<|n|
.
(39)
Let us label these sums 1–4. A few notes before we start bounding these sums.
First, we will assume α > 0. If α = 0, then we may proceed by removing the
second sum and replacing α with α+
ln in the ﬁrst sum. Second, if α+
ln = η, then the
third sum is unnecessary.
We can bound sum 1 by

|n|≤(ln T )α−2
< C(ln T )αp.
We can bound sum 2:

(ln T )α−2<|n|≤(ln T )α+
ln+ϵ/2
≤C(ln T )pα+
ln+pϵ/2P((ln T )α −2, T ).
If α+
ln = η, then sum 3 is unnecessary. If α+
ln < η, then we can bound sum 3 by

(ln T )α+
ln+ϵ/2<|n|≤(ln T )η+ϵ
≤(ln T )ηp+pϵP((ln T )α+
ln+ϵ/2, T ),
and by deﬁnition of α+
ln, the right-hand side goes to 0, so it can be further bounded
by some constant C.
Finally, we have the bound for sum 4. For any m,

(ln T )η+ϵ<|n|
≤(ln T )−(η+ϵ)m ;
|X|p+m(T )
<

186
S. Jitomirskaya and M. Powell
≤Cp+m(ln T )−(η+ϵ)m(ln T )η(p+m).
By taking m > ηp/ϵ, we have

(ln T )η+ϵ<|n|
< C.
Putting everything together, we have
;
|X|p(T )
<
< C + C(ln T )pα + C(ln T )pα+
ln+pϵ/2P((ln T )α −2, T ).
(40)
Taking ln throughout, and letting
f (T, p, α, ϵ) = max
%
αp ln ln(T ), (pα+
ln + pϵ
2 ) ln ln(T ) + ln(P ((ln T )α −2, T ))
&
,
we have
ln
;
|X|p(T )
<
< C + f (T, p, α, ϵ)
(41)
so
β+
ln(p) ≤max

α, α+
ln + ϵ
2 −S+
ln(α)
p
'
.
(42)
Taking p →∞yields our result for β+
ln(p). The proof for β−
ln(p) is similar.
⊓⊔
The major roadblock to using this result to obtain bounds on β±
ln(p) is that it
requires an a priori ﬁnite estimate on β±
ln(p) for every p > 0, which we do not
have in general. This differs from the situation arising when we merely want to
bound β±(p), since in that case we usually have a trivial ballistic upper bound:
β±(p) ≤1. To remedy this, we have the following, which provides a sufﬁcient
condition for β±(p) < C < ∞for every p > 0.
Theorem 3.2 Let H be an operator of the form (1) with bounded potential and
suppose that α±
ln < +∞. Moreover, suppose that, for some ξ > 0,
P((ln T )ξ, T ) = O(T −a)
(43)
for every a > 1, and for some γ < ∞, we have
;
|X|p(T )
<
< CpT γp.
(44)
Then for some η < ∞(35) holds.

Quantum Dynamical Bounds for Ergodic Operators
187
Remark 13 As noted above, (44) always holds with γ = 1 when the potential is
bounded.
Proof The proof proceeds the same as before, expressing ⟨|X|p(T )⟩as a sum and
decomposing that sum into four further sums, except we take η to be ξ. With this
modiﬁcation, the bounds for sums 1–3 still hold, but we need to be more careful
with the fourth sum.
We have:

(ln T )ξ+ϵ<|n|
=

(ln T )ξ+ϵ<|n|≤T γ +ϵ
+

T γ +ϵ<|n|
.
(45)
Let us denote the ﬁrst sum by I and the second sum by II. We can bound sum I by

(ln T )ξ+ϵ<|n|≤T γ +ϵ
≤T (γ +ϵ)pP((ln T )ξ+ϵ, T )
(46)
≤T p(γ +ϵ)−a
(47)
for large T, where we can take any a > 1. Taking a > p(γ + ϵ), we have

(ln T )ξ+ϵ<|n|≤T γ +ϵ < C. For sum II, we have

T γ +ϵ<|n|
= T −m(γ +ϵ)

T γ +ϵ<|n|
(|n| + 1)p+ma(n, T )
(48)
≤T −m(γ +ϵ) ;
|X|p+m(T )
<
(49)
≤Cm+pT (p+m)γ −m(γ +ϵ) < C.
(50)
for m > γp/ϵ. With these two bounds, we may proceed as before to conclude that
β+
ln(p) < C < +∞.
⊓⊔
We will now turn our attention to the proof of Theorem 1.5. We start with a
lemma due to Damanik and Tcheremchantsev:
Lemma 3.1 ([8] Theorem 7) Suppose H is of the form (1), where V is a bounded
real-valued function, and K ≥4 is such that σ(H) ⊂[−K + 1, K −1]. Then
Pr(N, T ) ≲e−cN + T 3

 K
−K

max
1≤n≤N

Af,E+i/T
n


2−1
dE
(51)
Pl(N, T ) ≲e−cN + T 3

 K
−K

max
1≤n≤N

Af,E+i/T
−n


2−1
dE
(52)
With this lemma, and the preceding theorems, we will prove Theorem 1.5.

188
S. Jitomirskaya and M. Powell
Proof of Theorem 1.5(a) In light of Theorem 3.1, it sufﬁces to show that α±
ln ≤γ.
We will do this for α+
ln and observe that the proof for α−
ln is the same.
Using (9) and Lemma 3.1, since γ > 1, we have
P((ln T )γ , T ) = O(T −δ)
(53)
for every δ < ∞. Thus
ln (P((ln T )γ , T ))
ln ln(T )
≤−δ ln(T )
ln ln(T ) .
(54)
We are left with
S+
ln(γ ) = +∞,
(55)
so α+
ln ≤γ.
⊓⊔
We will now prove the second part.
Proof of Theorem 1.5(b) Fix H1 and H2 of the form (1) with bounded potentials,
v1 and v2, and let K ≥4 be such that σ(Hi) ⊂[−K + 1, K −1] for i = 1, 2.
Denote the corresponding transfer matrices by Av1 and Av2 and the corresponding
transport exponents by β±
ln,1(p), β±
ln,2(p). Suppose that there is γ < ∞such that
for every M > 0 and T > T0(M),

 K
−K

max
0≤|n|≤(ln T )γ
Av1
n (x, E + i/T )
2
−1
dE ≤CT −M.
Moreover, suppose that there exists A > 0 such that for all E ∈[−K + 1, K −
1], 0 < ϵ ≤1, and |n| ≤ln(ϵ−1),
ϵA 
Av1,E+iϵ
n

 ≲

Av2,E+iϵ
n

 ≲ϵ−A 
Av1,E+iϵ
n

 .
(56)
Let P1(N, T ) and P2(N, T ) be the corresponding outside probabilities.
Observe, by Lemma 3.1 and our assumptions above, that for any M > 0, and
T > T0(M),
P2((ln T )γ , T ) ≤e−C(ln T )γ + T 3

 
 K
−K

max
0≤|n|≤(ln T )γ
Av2
n (x, E + i/T )
2
−1
dE
(57)
≤e−C(ln T )γ + T 3+A

 
 K
−K

max
0≤|n|≤(ln T )γ
Av1
n (x, E + i/T )
2
−1
dE
(58)
≤CT −M,
(59)

Quantum Dynamical Bounds for Ergodic Operators
189
and thus
ln(P2((ln T )γ , T ))
ln ln(T )
≤−M ln(T ) + ln(C)
ln ln(T )
.
(60)
We conclude as before.
⊓⊔
4
Semialgebraic Sets
Here we obtain an explicit estimate on the δ from Theorem 2.2.
Theorem 4.1 When Tω is the shift on Tn, and ω ∈DC(A, c), we can take δ ≤
1
A+n
in Theorem 2.2. When Tω is the skew-shift on Tn, and ω ∈SDC(A, c), we can take
δ <
1
n2n−1(1+ϵ) for any ϵ > 0.
Remark 14 The general idea of the proof is the same in both cases. We ﬁrst prove
a bound of the form # {k = 1, ..., N : Tω(x0) ∈Bϵ} ≤N−ζ, where Bϵ is a ball of
radius ϵ. Then we use the covering lemma for semialgebraic sets (Theorem 2.1) to
cover the desired semialgebraic set by ϵ-balls. Because of this similarity, we will
only give a proof for the shift. The details for the skew-shift can be found in [22]
(Lemma 8.4 and Theorem 8.7).
Proof Fix ϵ = N−δ and let χ(x) = χB(0,ϵ)(x) be the characteristic function of the
ball of radius ϵ centered at 0. Let R =
1
10ϵ and let
FR(xj) = 1
R
sin(Rx/2)
sin(x/2)
2
=

|m|<R

1 −|m|
R

eimxj =

|m|<R
5
FR(m)eimxj
be the usual Fejer kernel on R.
If χ(x) = 0, then χ(x) ≤CR−n n
j=1 FR(xj) holds trivially. On the other hand,
by our choice of ϵ and R, if χ(x) = 1, then FR(xj) ∼R, since, for small xj,
FR(xj) = 1
R
sin(Rxj/2)
sin(xj/2)
2
∼1
R R2 = R,
and we also have χ(x) ≤CR−n n
j=1 FR(xj). Thus we have
n

j=1
FR(xj) =
n

j=1

|m|<R
5
FR(m)eimxj
=

|m|<R
5
FR(m1) · · · 5
FR(mn)eim·x.
(61)

190
S. Jitomirskaya and M. Powell
Hence, if we set m = (m1, ..., mn), we have
N

j=1
χ(x0 + jω) ≤
CR−n
N

j=1

|mk|<R;1≤k≤n
5
FR(m1) · · · 5
FR(mn)eim·(x0+jω)
(62)
≤
CR−n

|mk|<R;1≤k≤n
⎛
⎝5
FR(m1) · · · 5
FR(mn)eim·x
⎛
⎝
N

j=1
eijm·ω
⎞
⎠
⎞
⎠
(63)
≤
CR−n

|mk|<R;1≤k≤n
⎛
⎝5
FR(m1) · · · 5
FR(mn)

N

j=1
eijm·ω

⎞
⎠.
(64)
At this point, we can split the sum into two parts: either mk = 0 for all 1 ≤k ≤n
or at least one mk ̸= 0. Thus we can write (64) = (65) + (66), where (65) and (66)
are given by
CR−n5
FR(0)n

N

j=1
eij0·ω

(65)
and
CR−n

0≤|mk|<R;1≤k≤n; some mk̸=0
⎛
⎝5
FR(m1) · · · 5
FR(mn)

N

j=1
eijm·ω

⎞
⎠.
(66)
Since 0 < 5
FR(m) ≤1 and
N
j=1 eijm·ω ≤N, we have for any x0
N

j=1
χ(x0 + jω) ≤CR−nN + CR−n

0<|m|<R

N

j=1
eijm·ω

= CR−nN + CR−n

0<|m|<R

1 −eiNm·ω
1 −eim·ω

≤CR−nN + CR−n

0<|m|<R
2|1 −eim·ω|−1
≤CR−nN + C
max
0<|m|<R 2|1 −eim·ω|−1.

Quantum Dynamical Bounds for Ergodic Operators
191
Since ω ∈DC(c, A), we know ||m · ω|| > c|m|−A, for every m ̸= 0, so |1 −
eim·ω|−1 ≲RA, and we conclude
N

j=1
χ(x0 + jω) ≤CR−nN + CRA
≤CN(R−n + RAN−1)
≤CN(ϵn + ϵ−AN−1).
Now, if we take δ =
1
n+A, then by our choice of ϵ, we have
ϵ−AN−1 = ϵ−AϵA+n
= ϵn,
so
N

j=1
χ(x0 + jω) ≤CNϵn.
We conclude the proof by observing that, by Theorem 2.1, it is possible to
cover S using no more than BCϵ1−n ϵ-balls, where C = C(n). Thus the above
computation shows that
# {k = 1, ..., N : x0 + kω ∈S} ≤CNϵnBCϵ1−n
= CNBCϵ
≤N1−δBC.
For the skew-shift, we have, by Lemma 8.3 and Theorem 8.7 from [22], that for
any ϵ′ > 0,
#
%
k = 1, ..., N : T k
ω(x0) ∈Bϵ
&
≤CN
−
1
2n−1(1+ϵ) +ϵ′
.
Applying Theorem 2.1, we have
#
%
k = 1, ..., N : T k
ω(x0) ∈S
&
≤CBCϵ1−nN
−
1
2n−1(1+ϵ) +ϵ′
⊓⊔

192
S. Jitomirskaya and M. Powell
5
Technical Lemmas
We will prove our results for right cocycles and observe that the exact same
arguments establish the same results for left cocycles.
Let us deﬁne
V f
k (E, a) :=
!
x ∈Tν : 1
k ln

Af,E
k
(x)

 ≥a
=
.
We will begin with the following lemma, which reduces everything to the study
of semialgebraic sets. Fix τ < 1 and 1 −τ/16 > a > c > d > 1 −τ/8 > 1 −τ.
Lemma 5.1 Let f ∈Gσ(Tν). There is some kτ(E) < ∞so that for k > kτ(E)
and |E−z| < e−kτL(E)
||f ||∞, we can ﬁnd N1 < ∞so that we have the following sequence
of inclusions:
V f
k (E, aL(E)) ⊂V
˜fN1
k
(E, cL(E)) ⊂V f
k (z, dL(E))
(67)
where ˜fN1(x) is a certain polynomial of degree N1, so V
˜fN1
k
(E, cL(E)) is semial-
gebraic of degree at most kN1.
Remark 15 We may take N1(k) ∼kσν+ in the above lemma.
Proof Let us ﬁx k ∈N large and ϵ > 0 small. First, since f ∈Gσ(Tν), we know
that
| ˆf (n)| ≤C1e−|n|1/(σ+).
(68)
Let fN0(x) = 
|n|≤N0 ˆf (n)ein·x. For N0 ≥kσ+ϵ, we have
|f (x) −fN0(x)| ≤e−k1+ϵ ≤e−k(1−c)L(E).
Now for such N0, there exists a polynomial ˜fN1(x) of degree N1 with N1 = kσν+ϵ
so that
|fN0(x) −˜fN1(x)| ≤e−k(1−d)L(E).
This can be seen by approximating einj xj by a Taylor polynomial of degree kσ+
and then bounding the error as usual. Note that these two inequalities hold for k
sufﬁciently large (dependent only on the dimension ν and ϵ).
By upper semicontinuity, compactness considerations, and a standard telescoping
argument, we have

Af,E
k
(x) −A
fN0,E
k
(x)

 < e−k1+ϵ
(69)

Quantum Dynamical Bounds for Ergodic Operators
193

Af,E
k
(x) −A
˜fN1(x),z
k

 < e−k(1−d+τ)L(E)ek(L(E)+ϵ) < ek(L(E)/2+ϵ)
(70)
for k sufﬁciently large and |E −z| < e−kτ(L(E)+ϵ)
||f ||∞
. The ﬁrst inclusion can now be
established by observing that, for x ∈V f
k (E, aL(E)), we have

A
fN0,E
k
(x)

 ≥

Af,E
k
(x)

 −

Af,E
k
(x) −A
fN0,E
k
(x)


≥eckL(E).
The other inclusion is proved in the same way.
The semialgebraic bound on V
˜fN1
k
(E, cL(E)) follows from the fact that
V
˜fN1
k
(E, cL(E)) is given by a single inequality involving a polynomial of degree
kN1.
⊓⊔
Now we have
Lemma 5.2 Let k, E, z, d, and V f
k (z, dL(E)) be as in Lemma 5.1. Then
|V f
k (z, dL(E))| > 1/2, where | · | represents Lebesgue measure.
Proof By deﬁnition of L(E), we have
L(E) ≤1
k

ln

Af,E
k
(x)

 dx
≤|V f
k (E, aL(E))|(L(E) + ϵ) + (1 −|V f
k (E, aL(E))|)(aL(E))
≤|V f
k (E, aL(E))|((1 −a)L(E) + ϵ) + aL(E).
Thus, by choosing ϵ appropriately (which can be done by upper semicontinuity and
taking k > k0(ϵ) sufﬁciently large), and the fact that a < 1, we have
|V f
k (E, aL(E))| ≥1
2.
(71)
The set inclusion proved above now yields the result.
⊓⊔
Our next goal is to show that for Tω either the shift or skew-shift, there is some
Nk < ∞such that for every x ∈Tν, Tω(x) ∈V f
k (z, dL(E)) for some 1 ≤j ≤Nk
and then obtain the required transfer matrix bounds. We will split the remaining
argument up into three cases: the shift with ν = 1, the shift with ν > 1,, and the
skew-shift with ν > 1.

194
S. Jitomirskaya and M. Powell
6
The Case ν = 1
Our goal is to ﬁrst establish the following estimates. Let d be as in Lemma 5.1.
Theorem 6.1 Let f ∈Gσ(T), ω ∈R\Q, and E ∈C such that L(E) > 0. For any
0 < τ < 1, there exist kτ = kτ(E) < ∞such that for any ϵ > 0, k > kτ, and
x ∈T, there is 1 ≤j ≤Ck1+σ+ϵ so that for any z ∈C with |z −E| < e−τkL(E)
||f ||∞,
we have

Af,z
k (x + jω)


2
> edkL(E).
(72)
Theorem 6.2 Fix ϵ > 0. Let f ∈Gσ(T), ω ∈DC(A, c), and L(E) > 0. Then for
any ξ, ζ > 1, there is C, c > 0 and TE < ∞such that for T > TE,
inf
!
min
ι=±1
max
1≤ιm≤C(ln T )ζ(1+σ+ϵ)

Af,z
m (x)


2
T −ξ
=
> c
(73)
where the inﬁmum is over all x ∈T and z ∈C with |z −E| < T −ζ. Moreover, TE
is uniformly bounded below for E in compact sets with positive L(E).
In particular, for E ∈[−K, K], we have max1≤n≤C(ln T )ζ(1+σ)

Af,E+i/T
n


2
≥
cT ξ for every ξ > 1 and large T.
If ω ∈R\Q, then the above holds for a sequence, Tn for n > nE for all E, and
for n > n0 for E ∈[−K, K].
When ν = 1, we can write ω as a continued fraction. Let pn
qn be the continued
fraction approximation of ω. We then have the following lemma.
Lemma 6.1 (Lemma 9 from [12]) Suppose  ⊂T is an interval with || > 1/qn.
Then for every x ∈T, there exists 1 ≤j ≤qn + qn−1 −1 such that x + jω ∈.
Lemmas 5.1 and 5.2, along with Remark 15, imply V f
k (z, dL(E)) contains an
open set, , of measure
1
2k1+σ+ϵ ≲||.
Now if we take k > Cq1/(1+σ+ϵ)
n
, we have || > 1/qn, and so, by Lemma 6.1,
Lemma 6.2 Let f, E, z, and d be as in Lemma 5.1. For k ∼q1/(1+σ+ϵ)
n
, there
exists 1 ≤j ≲k1+σ+ϵ such that x + jω ∈V f
k (z, dL(E)).
Theorem 6.1 now follows by the set inclusion we proved in the previous section.
Since the proof of Theorem 6.2 is identical to the proof of Theorem 7.2 in the
next section, we omit it and refer readers to the next section for the details.
With Theorem 6.2, we can prove Theorem 1.1.

Quantum Dynamical Bounds for Ergodic Operators
195
Proof of Theorem 1.1 Let us begin by ﬁxing x ∈T and f ∈Gσ(T). Moreover
suppose that L(E) > 0 for every E ∈R. First, we will consider the case ω ∈
DC(A, c). Fix ϵ > 0 and set γ = 1 + σ. The hypotheses of Theorem 6.2 are
satisﬁed, and we can combine the conclusion of Theorem 6.2 with the conclusion
of Lemma 3.1 to obtain
P((ln T )γ +ϵ −2, T ) ≤e−C(ln T )ζ(γ +ϵ) + CT −δ
for every ζ, δ > 1. Since γ > 1, we can further bound this by
P((ln T )γ +ϵ −2, T ) ≤CT −δ,
using a different constant C. As before, we obtain α+
ln ≤1 + σ < +∞.
We can now appeal to Theorem 3.2 to establish the hypotheses of Theorem 3.1,
so β+
ln(p) ≤α+
ln ≤1 + σ.
Now we turn to the case ω ∈R\Q. We can appeal to Theorem 6.2 to obtain the
above for a sequence Tn →∞. With a sequence, we have analogous statements as
above, but for S−and α−. Thus we obtain β−
ln(p) ≤1 + σ.
⊓⊔
7
The Case ν > 1
As in the case ν = 1, our goal is to ﬁrst establish the following estimates:
Theorem 7.1 Let f = λf0 ∈Gσ(T ν), ν > 1, ω ∈DC(A, c), λ > λ0(f0, ω), and
E ∈R such that L(E) > 0. For any 0 < τ < 1, there exist kτ = kτ(E) < ∞, δ =
δ(ω, ν), and γ = γ (σ, ν, δ) such that for any ϵ > 0, k > kτ, and x ∈Tν, there is
1 ≤j ≤kγ +ϵ so that for any z ∈C with |z −E| < e−τkL(E)
||f ||∞, we have

Af,z
k (x + jω)

 > ek(1−τ)L(E).
(74)
Theorem 7.2 Fix ϵ > 0. Let f = λf0 ∈Gσ(Tν), ν > 1, ω ∈DC(c, A), λ >
λ0(f0, ω), and L(E) > 0. Then for any ξ, ζ > 1, there is c > 0 and TE < ∞such
that for T > TE,
inf
!
min
ι=±1
max
1≤ιm≤(ln T )ζ(γ +ϵ)

Af,z
m (x)


2
T −ξ
=
> c
(75)
where γ and δ are as above, and the inﬁmum is over all x ∈Tν and z ∈C with
|z −E| < T −ζ. Moreover, the dependence of TE on E is through L(E), as in
Theorem 6.2. Thus, as before, TE is uniformly bounded below for E in compact sets
with positive L(E).

196
S. Jitomirskaya and M. Powell
Remark 16 If we consider just E ∈[−K, K] in the above theorem, then continuity
of L(E), which was established for our situation in [19], and compactness of
[−K, K] yield the desired uniform lower bound on T.
When ν > 1, we need to do a bit more work to obtain an analogue of Lemma 6.1.
We may appeal to Theorems 2.4 and 2.2 to obtain:
Lemma 7.1 Let ω ∈DC(A, c). For f = λf0 ∈Gσ(Tν), there exists λ0(f0, ω)
such that for λ > λ0 and every x ∈Tν, there exists 1 ≤j ≤kC(ν+A)(σν+1)+ such
that x + jω ∈V
˜fN1
k
(E, cL(E)).
Proof Recall that by Theorem 2.4, combined with (69), with N1 as in Lemma 5.1,
there exists a λ0 so that for all λ > λ0 and f = λf0, we have

!
x ∈Tν :

1
k ln

A
˜fN1,E
k
(x)

 −Lk(E)
 > 2k−τ
= < e−kα.
(76)
This implies

!
x ∈Tν : 1
k ln

A
˜fN1,E
k
(x)

 −L(E) < −2k−τ
= < e−kα,
(77)
since Lk(E) ≥L(E). Thus, for k sufﬁciently large, and N1(k) ∼kσν+, by
Remark 15,
Tν\V
˜fN1
k
(E, cL(E))
 < e−kα.
(78)
Since the left-hand side is the complement of a semialgebraic set of degree at most
kN1, it is itself semialgebraic of degree at most kN1. By Theorem 4.1, for ﬁxed
0 < ϵ < δ =
1
ν+A, we can thus set S =

Tν\V
˜fN1
k
(E, cL(E))

, η = e−kα,
B = kN1, and N = BC/(δ−ϵ) and then appeal to Theorem 2.2 to obtain, for any
0 < ϵ < δ,
# {1 ≤j ≤N : x + jω ∈S} < BC 1−δ
δ−ϵ BC = BC 1−ϵ
δ−ϵ .
(79)
Thus, for every x ∈Tν, there is a 1 ≤j ≤(kN1)C 1−ϵ
δ−ϵ < N1−ϵ so that x +
jω ∈V
˜fN1
k
(E, cL(E)). The result now follows from our choice of N1 ∼kσν+ in
Lemma 5.1.
⊓⊔
Theorem 7.1 now follows from the fact that V
˜fN1
k
(E, cL(E)) ⊂V f
k (z, dL(E)),
and observing that d > 1 −τ, just as in the case ν = 1.
Theorem 7.2 can now be proved using Theorem 7.1.

Quantum Dynamical Bounds for Ergodic Operators
197
Proof of Theorem 7.2 Fix ξ, ζ > 1 and 0 < τ <
ζ||f ||∞
ζ||f ||∞+ξ < 1. Consider any
Mk = Mk(ξ, ζ) such that the following holds:
ekτL(E)/(ζ||f ||∞) < Mk < ek(1−τ)L(E)/ξ
(80)
and
(ln Mk)(γ +ϵ)ζ > kγ + + k.
(81)
Both conditions can be satisﬁed by taking k sufﬁciently large due to our choice of
τ and ζ > 1. Appealing to Theorem 7.1, for every x ∈Tν, there is 1 ≤j ≤
(ln Mk)(γ +ϵ)ζ −k so that for |z −E| < M−ζ
k , we have

Af,z
k (x + jω)

 ≥Mξ
k .
(82)
Now recall that, by deﬁnition,
Af,z
k+j(x) = Af,z
k (x + jω)Af,z
j (x).
(83)
Moreover, A is an SL2(R) cocycle, so ||Ak|| =

A−1
k

 , and thus

Af,z
k (x + jω)

 ≤

Af,z
k+j(x)



Af,z
j (x)

 .
(84)
This together with (82) implies
max
1≤j≤(ln Mk)(γ +ϵ)ζ −k
%
Af,z
k+j(x)

 ,

Af,z
j (x)


&
≥Mξ
k .
(85)
Thus we must have
max
1≤j≤(ln Mk)(γ +ϵ)ζ

Af,z
j (x)


2
≥Mξ
k .
(86)
It is not difﬁcult to show that for some T0 = T0(E) < ∞and any T > T0,
we can ﬁnd k < ∞and Mk = T satisfying (80) and (81). Thus, we have, for any
ξ, ζ > 1,
inf
|z−E|<T −ζ ;x∈Tν

max
1≤ιj≤(ln T )(γ +ϵ)ζ

Af,z
j (x)


2
T −ξ
'
> c > 0.
(87)
It remains to show that we can also use the same Mk to obtain an analogous
bound for the left transfer matrix. Note that for an ergodic invertible cocycle, the

198
S. Jitomirskaya and M. Powell
Lyapunov exponent of the forward cocycles and the Lyapunov exponent of the
backward cocycles agree. Moreover, if Ak(ω, x) is the cocycle over rotations by
ω, then A−k(ω, x) = Ak(−ω, x + ω). Since ω and −ω obey the same Diophantine
condition, Lemma 7.1 also holds for Af,z
−k(x), which means we can use the exact
same Mk to obtain a bound as above.
⊓⊔
Now we can turn to the proof of Theorem 1.3.
Proof of Theorem 1.3 We can follow the same idea as in the proof of Theorem 1.1,
using Theorem 7.2 in place of Theorem 6.2. Let us ﬁx x ∈Tν, ω ∈DC(A, c) ⊂
Tν, and f
= λf0 ∈Gσ(Tν), where λ > λ0(f0, ω) so that we satisfy the
conclusions of Theorem 2.4. Moreover, suppose that L(E) > 0 so that we may
appeal to Theorem 7.2.
By Theorem 7.2, along with Theorem 3.1, we have
P((ln T )γ +ϵ −2, T ) ≤CT −β
for some γ = γ (A, c, σ, ν) < +∞and every β > 1. Moreover, it is clear that
ln(P((ln T )γ +ϵ −2, T ))
ln ln(T )
≤−δ ln(T )
ln ln(T ),
(88)
so by Theorems 3.2 and 3.1, β±
ln(p) ≤α±
ln ≤γ.
⊓⊔
8
The Analytic Case
The proofs of our main results in the case of an analytic potential are morally the
same as those for Gevrey potentials. Indeed, we can quickly obtain the following
using the same proofs as the analogous results above.
Theorem 8.1 Let f be a non-constant analytic function on Tν, ν ≥1, ω ∈
DC(A, c), and E ∈R such that L(E) > 0. For any 0 < τ < 1, there exist
kτ = kτ(E) < ∞, δ = δ(ω, ν), and γ = γ (ν, δ) such that for any ϵ > 0, k > kτ,
and x ∈Tν, there is 1 ≤j ≤kγ +ϵ so that for any z ∈C with |z −E| < e−τkL(E)
||f ||∞,
we have

Af,z
k (x + jω)

 > ek(1−τ)L(E).
(89)
Theorem 8.2 Fix ϵ > 0. Let f be a non-constant analytic function on Tν, ν ≥
1, ω ∈DC(c, A), and L(E) > 0. Then for any ξ, ζ > 1, there is c > 0 and
TE < ∞such that for T > TE,

Quantum Dynamical Bounds for Ergodic Operators
199
inf
!
min
ι=±1
max
1≤ιm≤(ln T )ζ(γ +ϵ)

Af,z
m (x)


2
T −ξ
=
> c
(90)
where γ and δ are as before, and the inﬁmum is over all x ∈Tν and z ∈C with
|z −E| < T −ζ.
Moreover, the dependence of TE on E is through L(E), as in Theorem 6.2. Thus,
as before, TE is uniformly bounded below for E in compact sets with positive L(E).
The main difference between these two results and the variants from Sects. 6
and 7 is the assumption on f. Here, we do not need to assume f = λf0 for
λ > λ0(f0, ω). Indeed, this condition is needed for the Gevrey case in order to use
the large deviation estimate Theorem 2.4, but the analogous estimate for analytic
potentials, Theorem 2.3, does not require such a condition. Once we have a large
deviation estimate, the proofs proceed exactly as in the proof of Theorem 7.1, with
(68) replaced by | ˆf (n)| ≤CEc|n|. Note that continuity of L(E), which is required
in the uniform minoration of TE, was established in [3].
9
The Skew-Shift Case, ν > 1
Let Tω denote the skew-shift on Tν. As in the shift case, our goal is to ﬁrst establish
the following estimates:
Theorem 9.1 Let f = λf0 ∈Gσ(T ν), ν > 1, ω ∈SDC(A, c), λ > λ0(f0, ω) and
E ∈R such that L(E) > 0. For any 0 < τ < 1, there exist kτ = kτ(E) < ∞, δ =
δ(ω, ν), and γ = γ (σ, ν, ω) such that for any ϵ > 0, k > kτ, and x ∈Tν, there is
1 ≤j ≤kγ +ϵ so that for any z ∈C with |z −E| < e−τkL(E)
||f ||∞, we have

Af,z
k (x + jω)

 > ek(1−τ)L(E).
(91)
Theorem 9.2 Fix ϵ > 0. Let f = λf0 ∈Gσ(Tν), ν > 1, ω ∈SDC(c, A), λ >
λ0(f0, ω), and L(E) > 0. Then for any ξ, ζ > 1, there is c > 0 and TE < ∞such
that for T > TE,
inf
!
min
ι=±1
max
1≤ιm≤(ln T )ζ(γ +ϵ)

Af,z
m (x)


2
T −ξ
=
> c
(92)
where γ and δ are as above, and the inﬁmum is over all x ∈Tν and z ∈C with
|z−E| < T −ζ. Moreover, if we restrict our attention to E in some compact interval
[−K, K], we can take TE uniformly bounded below.
In particular, for E ∈[−K, K], we have max1≤n≤(ln T )ζ(γ +ϵ)

Af,E+i/T
n


2
≥
CT ξ for every ξ > 1 and T large.

200
S. Jitomirskaya and M. Powell
An analogue of Lemma 6.1 follows using the same argument as in the multifre-
quency shift case. The proof is identical to the proof of Lemma 9.1, but we use the
skew-shift bound from Theorem 2.2 instead of the shift bound.
Lemma 9.1 Let δ be deﬁned as above. For f = λf0 ∈Gσ(Tν), there exists
λ0(f0, ω) such that for λ > λ0, every ϵ > 0 and x ∈Tν there exists 1 ≤j ≤
kC(1/δ)(σν+1)+ϵ such that Tω(x) ∈V
˜fN1
k
(E, cL(E)).
Theorem 9.1 now follows from the fact that V
˜fN1
k
(E, cL(E)) ⊂V f
k (z, dL(E)),
and observing that d > 1 −τ, just as in the case ν = 1.
Theorem 9.2 can now be proved using Theorem 9.1 in the same way that
Theorem 7.2 was proved using Theorem 7.1.
Proof of Theorem 1.4 We can use the same argument as the proof of Theorem 1.3,
using the analogous results from this section rather than those from Sect. 7.
⊓⊔
Acknowledgments We thank Wencai Liu for useful comments on the earlier version of the
manuscript. This work was partially supported by NSF DMS-2155211, DMS-2052899, and
Simons 681675. S.J. was a 2020-2021 Simons fellow.
References
1. Barbaroux, J.-M., Germinet, F., Tcheremchantsev, S.: Fractal dimensions and the phenomenon
of intermittency in quantum dynamics. Duke Math. J. 1, 161–193 (2001)
2. Bourgain, J., Jitomirskaya, S.: Anderson localization for the band model. In: Geometric
Aspects of Functional Analysis. Lecture Notes in Mathematics, vol. 1745, pp. 67–79 (2000)
3. Bourgain, J.: Green’s Function Estimates for Lattice Schrödinger Operators and Applications.
Princeton University Press, Princeton (2005)
4. Carmona, R., Klein, A., Martinelli, F.: Anderson localization for Bernoulli and other singular
potentials. Commun. Math. Phys. 188, 41–66 (1987)
5. del Rio, R., Jitomirskaya, S., Last, Y., Simon, B.: What is localization. Phys. Rev. Lett 75, 117
(1995)
6. del Rio, R., Jitomirskaya, S., Last, Y., Simon, B.: Operators with singular continuous spectrum,
IV. Hausdorff dimensions, rank one perturbations, and localization. J. Anal. Math. 69(1), 153–
200 (1996)
7. del Rio, R., Makarov, M., Simon, B.: Operators with singular continuous spectrum. II. Rank
one operators. Commun. Math. Phys. 165(1), 59–67 (1994)
8. Damanik, D., Tcheremchantsev, S.: Quantum dynamics via complex analysis methods: general
upper bounds without time-averaging and tight lower bounds for the strongly coupled
Fibonacci Hamiltonian. J. AMS. 20(3), 799–827 (2007)
9. Germinet, F., Kiselev, A., Tcheremchantsev, S.: Transfer matrices and transport for Schrödinger
operators. Annales de L’Institut Fourier 54(3), 787–830 (2004)
10. Gordon, A.: The point spectrum of the one-dimensional Schrödinger operator. Uspehi Mat.
Nauk 31, 257–258 (1976)
11. Han, R., Jitomirskaya, S.: Quantum dynamical bounds for ergodic potentials with underlying
dynamics of zero topological entropy. Anal. PDE 12(4), 867–902 (2019)

Quantum Dynamical Bounds for Ergodic Operators
201
12. Jitomirskaya, S., Last, Y.: Power-law subordinacy and singular spectra. II. Line operators.
Commun. Math. Phys. 211, 643–658 (2000)
13. Jitomirskaya, S., Liu, W.: Upper bounds on transport exponents for long range operators. J.
Math. Phys. 62(7) Paper No. 073506, 9 (2021)
14. Jitomirskaya, S., Mavi, R.: Dynamical bounds for quasiperiodic schrödinger operators with
rough potentials. Int. Math. Res. Notices 2017(1), 96–120 (2016)
15. Jitomirskaya, S., Simon, B.: Operators with singular continuous spectrum, III. Almost periodic
Schrödinger operators. Commun. Math. Phys. 165, 201–205 (1994)
16. Jitomirskaya, S., Schulz-Baldes, H.: Upper bounds on wavepacket spreading for random Jacobi
matrices. Commun. Math. Phys. 273, 601–618 (2007)
17. Jitomirskaya, S., Schulz-Baldes, H., Stolz, G.: Delocalization in random polymer models.
Commun. Math. Phys. 233(1), 27–48 (2003)
18. Jitomirskaya, S., Zhu, X.: Large deviations of the Lyapunov exponent and localization for the
1D Anderson model. Commun. Math. Phys. 370(3), 311–324 (2019)
19. Klein, S.: Anderson localization for the discrete one-dimensional quasi-periodic Schrödinger
operator with potential deﬁned by a Gevrey-class function. J. Funct. Anal. 218, 255–292 (2005)
20. Klein, S.: Localization for quasiperiodic Schrödinger operators with multivariable Gevrey
potential functions. J. Spectr. Theory 4(3), 431–484 (2014)
21. Landrigan, M.: Log-dimensional properties of spectral measures. Ph.D. Thesis, UC Irvine,
2001
22. Liu, W.: Quantitative inductive estimates for Green’s functions of non-self-adjoin matrices.
Analysis and PDE, to appear
23. Landrigan, M., Powell, M.: Fine dimensional properties of spectral measures (2021).
arxiv:2107.10883, to appear J. Spectr. Theory 2022
24. Simon, B.: Equilibrium measures and capacities in spectral theory. Inverse Probl. Imaging 1,
713–772 (2007)

The Slicing Problem by Bourgain
B. Klartag and V. Milman
Dedicated to the memory of Jean Bourgain
Abstract In the context of his work on maximal functions in the 1980s, Jean
Bourgain came across the following geometric question: Is there c > 0 such that
for any dimension n and any convex body K ⊆Rn of volume one, there exists
a hyperplane H such that the (n −1)-dimensional volume of K ∩H is at least
c? This innocent and seemingly obvious question (which remains unanswered!)
has established a new direction in high-dimensional geometry. It has emerged
as an “engine” that inspired the discovery of many deep results and unexpected
connections. Here we provide a survey of these developments, including many of
Bourgain’s results.
Foreword by V. Milman: Some Historical Reminiscences
In August 1984, I visited Jean Bourgain for a couple of days in Brussels where he
worked at the time. We intended to spend a year together at IHES, Paris (during
the 1984–1985 academic year). Jean was preparing his trip to Leningrad (now
St. Petersburg) in September, and I wanted to see him before he left (I had many
colleagues and friends there). When he brought me to the train station on my way
back to Paris, he proposed the following question: “Let K be a centrally symmetric
convex body in Rn; let V ol(K) = 1. Does there exist u ∈SLn such that all
hyperplane central sections of u(K) will have around the same (n −1)-dimensional
volume?”
B. Klartag ()
Department of Mathematics, Weizmann Institute of Science, Rehovot, Israel
e-mail: boaz.klartag@weizmann.ac.il
V. Milman
School of Mathematical Sciences, Tel Aviv University, Tel Aviv, Israel
e-mail: milman@tauex.tau.ac.il
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
A. Avila et al. (eds.), Analysis at Large, https://doi.org/10.1007/978-3-031-05331-3_9
203

204
B. Klartag and V. Milman
To say more precisely for the non-experts: Is there a universal number C
(independent of anything, including the dimension n) such that for every (n −1)-
dimensional subspace H the following holds:
1
C a ≤V oln−1(u(K) ∩H) ≤Ca?
(1)
Here C means a universal constant, as usual. Jean added that the question had arisen
in his work on maximal functions.
During the train trip back to Paris, I suddenly realized that some of our recent
joint observations with Gromov (see Lemma 1 in [21]) on some consequences of
the Brunn-Minkowski inequality may lead to the answer (see Lemma 2 in [21]).
I informed Jean about this upon arriving to Paris. This result of Jean on maximal
functions was published in 1986 in Amer. J. Math [21]. I should note here that only
a few years later did we learn about Hensley’s paper [45] where isotropic position
and Lemma 2 were already considered for problems of analytic number theory.
However, going back to 1984–1985, Jean asked me a few months later whether
the number “a” in (1), which already depended on the body K, is actually uniformly
independent of the dimension n, bounded from below. He knew how to prove that
it is bounded from above (by its value for the euclidean ball of volume 1). “I don’t
need this information for my paper” – Jean said – “this number is cancelled in
computations; but, I feel I should know it if I need to use it.” Jean thought that I may
see some geometric point from which it will easily follow, and indeed I thought at
ﬁrst it would be easy: If “a” for some K is extremely small, this means that all central
hyperplane sections have a very small volume for a body of volume 1. It looks very
counterintuitive; however, it is not yet proved, 35 years later.
The question appears in the “Remark” after Lemma 2 in [21]. Shortly after, Alain
Pajor and I produced some advanced study of the isotropic position and this problem
[83] and demonstrated some equivalent problems. In the meantime, Jean proved a
lower bound of
1
n0.25 log n (see [23]), and 20 years later, Boaz Klartag improved upon
it to obtain the better lower bound, of
1
n0.25 by a different approach.
It is surprising and striking how far-reaching and how consequential this problem
has become. We will demonstrate this in this survey.
Jean had revisited the aforementioned problem many times, from his 1986
congress talk in Berkeley [22] to his works [24, 26, 27] in later years.
I was told once by Jean that he had spent more time on this problem and had
dedicated more efforts to it than to any other problem he had ever worked on. A
few months before his passing, Jean wrote to me again, inquiring about any recent
progress. He wanted to know the answer before he would leave.

The Slicing Problem by Bourgain
205
1
Introduction
The classical Busemann-Petty problem, which is closely related to the slicing
problem, reads as follows: Let K and T be centrally symmetric convex bodies in Rn
and V oln−1(K ∩θ⊥) ≤V oln−1(T ∩θ⊥) for all θ ∈Sn−1 = {x ∈Rn ; |x| = 1}.
Does it follow that V olnK ≤V olnT ? Here θ⊥= {x ∈Rn ; ⟨x, θ⟩= 0} is the
hyperplane orthogonal to θ. This is Problem 1 in [30], where it is shown that the
answer is afﬁrmative when K is an ellipsoid.
For general K and T , the answer to the Busemann-Petty question turned out
to be “yes” for dimensions n ≤4. However, surprisingly, the intuition breaks,
and for dimensions n ≥5, it does not hold (see the book by Gardner [39] and
Koldobsky [64] for history and references). In fact, the intuition in high dimension
fails so miserably, and the computations are so difﬁcult that the counterexample in a
sufﬁciently high dimension is simple to describe: Just take K for the cube and T for
a Euclidean ball, as shown by K. Ball [5, 7]. Indeed, for n ≥10, K = [−1/2, 1/2]n
and for T , a Euclidean ball of volume 9/10 centered at the origin in Rn,
V oln−1(K∩θ⊥) ≤
√
2 < 0.9√e ≈
 n
2 + 1
(n−1)/n


n+1
2

·0.9(n−1)/n=V oln−1(T ∩θ⊥).
In order to overcome this obstruction, a question that looks more sensible to us today
is the following:
Question 1.1 Let K, T
⊆Rn be centrally symmetric convex bodies such that
V oln−1(K ∩θ⊥) ≤V oln−1(T ∩θ⊥) for all θ ∈Sn−1. Does it follow that
V olnK ≤C · V olnT for some universal constant C?
In particular, is it true that there exists a constant c > 0 (perhaps, very small)
such that for every dimension n and for any convex centrally symmetric body
K ⊂Rn, if V oln−1(K ∩θ⊥) < c for every θ ∈Sn−1 then V olnK ≤1? This is the
essence of the slicing problem, sometimes referred to as the hyperplane conjecture.
The assumption of central symmetry is not very essential (see, e.g., [50]), and
Question 1.1 is in fact equivalent to the following:
Question 1.2 Let K ⊂Rn be a convex set of volume one. Does there exist a
hyperplane H ⊂Rn, such that
V oln−1(K ∩H) > 1/C
for some universal constant C > 0, independent of the dimension n?
This is known as Bourgain’s slicing problem. It is not just a nice riddle; a positive
answer would have several consequences in convex geometry. In fact, in some sense,
the hyperplane conjecture is the “opening gate” to a better understanding of uniform
measures in high dimensions. It is simpler and it is implied by the thin-shell problem

206
B. Klartag and V. Milman
of Anttila, Ball, and Perisinnaki [2] and by the conjecture of Kannan, Lovász, and
Simonovits (KLS) on the isoperimetric inequality in convex sets [48], which we
discuss below. In fact, the slicing problem appears virtually in any study of the
uniform measure on convex sets in high dimension. Here is a sample of entirely
equivalent formulations of Question 1.2 mostly taken from [83]. We write A ≃B if
cA ≤B ≤CA for some universal constants c, C > 0.
1. Let K ⊂Rn be a convex body (i.e., a non-empty, bounded, open convex set).
Does there exist an ellipsoid E ⊂Rn, with V olnE = V olnK, such that V oln(K ∩
CE)/V oln(K) ≥1/2, where C > 0 is a universal constant?
2. Let K ⊂Rn be a convex body. Select n+2 independent, random points according
to the uniform measure on K. Let p(K) be the probability that these n+2 points
are the vertices of a convex polytope. Is it true that (1−p(K))1/n ≃1/√n? This
question is known as the Sylvester problem.
3. Let K ⊂Rn be a convex body of volume one. Is it true that there exists a volume-
preserving, afﬁne map T : Rn →Rn, such that
V oln−1(T (K) ∩H) ≃1
for any hyperplane through the origin H ⊂Rn?
4. Let K ⊂Rn be a convex body. Denote by Cov(K) the covariance matrix of
a random vector that is distributed uniformly in K. In Bourgain’s notation, the
isotropic constant of K is deﬁned as
LK = det(Cov(K))
1
2n
V oln(K)
1
n
.
(2)
The isotropic constant is invariant under invertible, afﬁne transformations. It is
known that (2πe)−1/2 + o(1) ≤LK for any convex body in Rn (the minimizer
is the Euclidean ball or an ellipsoid). Is it true that LK < C, for some universal
constant C > 0, independent of the dimension?
However, let us now take a step back. The slicing problem is part of the study of
measures in a high-dimensional space. One of the earliest results on probability
distributions in high-dimensional spaces is of course the classical central limit
theorem: The sum of independent random variables is approximately Gaussian when
the number of variables approaches inﬁnity, under quite general assumptions. In
other words, for large n, suppose that f1, . . . , fn are probability densities on the
real line of mean zero and variance one, satisfying certain mild regularity conditions.
Then, the integral

Ht
n

i=1
fi(xi)

The Slicing Problem by Bourgain
207
with Ht = {x ∈Rn ; n
i=1 xi = t√n} is approximately the Gaussian density
e−t2/2/
√
2π. Therefore, the value of this integral does not depend too much on the
speciﬁc form of the densities we started with, and the behavior is asymptotically
universal. This is a marvelous effect of universality in high dimensions, indicating
that when viewed correctly, high-dimensional measures exhibit regularity and order
rather than incomprehensible complications.
Another example for regularity in high dimensions is Dvoretzky’s theorem,
which asserts that any high-dimensional convex body has nearly Euclidean sections
of a large dimension; see [81] and references therein for background. Thus, the
symmetries of the Euclidean ball appear, even though we made only minimal
assumptions: only convexity and the high dimension. The central limit theorem and
Dvoretzky’s theorem are high-dimensional effects that lack clear analogs in low
dimensions.
As it turns out, there are motifs in high-dimensional geometry which seem to
compensate for the difﬁculties that arise from high dimensionality. One of these
motifs is the concentration of measure phenomenon. Quite unexpectedly, a scalar
Lipschitz function on a high-dimensional space behaves in many cases as if it
were a constant function. For example, if we sample ﬁve random points from
the n-dimensional unit sphere, for large n, and substitute them into a 1-Lipschitz
function, then we will almost certainly obtain ﬁve numbers that are very close
to one another. This phenomenon is reminiscent of the well-known geometric
property that in the high-dimensional Euclidean sphere, “most of the mass is close
to the equator, for any equator.” This geometric property, which follows from the
isoperimetric inequality, is unthinkable in, say, three dimensions. Since the second-
named author’s proof of Dvoretkzy’s theorem in the 1970s, the concentration of
measure has become a major tool in high-dimensional analysis.
It was a big surprise in the 1970s and 1980s that the asymptotic behavior
(i.e., when the dimension increases) of high-dimensional normed spaces is “well
organized” and not chaotic, as one could expect from the intuition which was based,
perhaps, on exponential growth of entropy (=covering) for n-dimensional spaces.
However, the concentration of measure balances the exponentially high entropy of
n-dimensional spaces and leads to a “regularity” in high dimension, limiting the
“geometric diversity” in high dimensions. The absolute constants involved in the
analysis may balance the rate of exponential decay (coming from concentration)
with the rate of exponential expansion (coming from covering/entropy). Surpris-
ingly, both exponents have “roughly” the same order of decay via expansion by
dimension, and only a constant factor is needed in order to compensate and obtain a
regularity result in high dimensions. The constant factors in the exponent are needed
for compensation, and this explains the “isomorphic” nature of the results, the fact
that absolute constants appear in their formulation.
So, a new intuition had to be created roughly four decades ago, and it was built
upon results which showed very regular patterns. Today, we may state that these
results were observed roughly in two different forms:

208
B. Klartag and V. Milman
(a) Geometric and structural results (e.g., Dvoretzky’s theorem, quotient of sub-
space theorem, Ramsey’s theorem in combinatorics).
(b) The uniform measure distribution (volume behavior) in high-dimensional con-
vex bodies.
In both of these forms, there is striking regularity and almost no pathology when
the dimension increases. Bourgain’s slicing problem had a major inﬂuence on (b),
and the entire direction actually stemmed from his conjecture and his work. The
Bourgain-Milman inequality [25] is one of the results from that period of time that
is closest to a bridge between (a) and (b).
The spatial arrangement of volume due to the geometry of Rn, for large n,
imposes rigidity on convex sets and convexity-related measures. Convexity is one
of the ways in which one may harness the concentration of measure phenomenon
in order to formulate clean, non-trivial theorems. The Brunn-Minkowski inequality
from the end of the nineteenth century states that for any non-empty Borel sets
A, B ⊆Rn,
|A + B|1/n ≥|A|1/n + |B|1/n,
(3)
where A + B = {x + y ; x ∈A, y ∈B} and |A| is the volume of the set A. The
Brunn-Minkowski inequality is a close relative of the isoperimetric inequality, and
equality holds in (3) essentially only when A and B are congruent convex bodies. In
addition to (1) above, let us mention another consequence of the Brunn-Minkowski
theory: the reverse Hölder inequalities, proven by Berwald [13] and Borell (see [83]
or Borell’s papers [17, 18, 20]). For any convex body K ⊆Rn, a linear functional
f : Rn →R and p, q > 0,

K
|f (x)|p dx
|K|
1/p
≤C

K
|f (x)|q dx
|K|
1/q
(4)
where C = Cp,q > 0 depends solely on p, q and neither on K nor on the dimension
n. This amusing property of convex domains goes beyond linear functionals.
Suppose now that f : Rn →R is an arbitrary polynomial of degree at most d.
Bourgain proved in his paper [23] that (4) holds true in this case, with the constant
C depending only on p, q and d, and not on the convex body or the dimension.
These results serve as evidence for the general hypothesis that in many respects
the uniform measure on a high-dimensional convex body resembles a Gaussian
measure.
In the same paper, [23] Bourgain proved that the constant C from Question 1.2
(or Question 1.1) may be replaced by Cn0.25 log n. The logarithmic factor was
later removed by the ﬁrst-named author in [51]. We proceed with a more detailed
account of the development of the study of the regularity of high-dimensional
convexity-related measures and the major inﬂuence that Jean Bourgain had on this
development.

The Slicing Problem by Bourgain
209
2
The Isotropic Position
The covariance matrix Cov(K) = (Covij(K))i,j=1,...,n of a convex body K ⊂Rn
is given by
Covij(K) =

K
xixj
dx
V oln(K) −

K
xi
dx
V oln(K)

K
xj
dx
V oln(K).
(5)
When V oln(K) = 1, its isotropic constant satisﬁes L2n
K = det Cov(K), according
to (2).
A convex body K ⊂Rn of volume one is isotropic (or in isotropic position) if its
barycenter lies at the origin and its covariance matrix is a scalar matrix. Any convex
body K ⊂Rn can be transformed into an isotropic convex body by applying an
afﬁne transformation of the form T x = αCov(K)−1/2x + v for appropriate α > 0
and v ∈Rn. It follows from (2) that when K is isotropic,
Cov(K) = L2
K · Id.
(6)
In other words, when K is isotropic, for any θ ∈Sn−1,

K
⟨x, θ⟩2dx = L2
K.
(7)
It follows from (6) that for any convex body K ⊆Rn with V oln(K) = 1 and for
any invertible linear map T : Rn →Rn,
L2
K ≤
1
n| det T |2/n

K
|T x|2dx.
(8)
Indeed, it sufﬁces to prove (8) in the case where K is isotropic. In this case, the right-
hand side of (8) equals L2
K · Trace[T ∗T ]/(n| det T |2/n) ≥L2
K, by the arithmetic-
geometric means inequality.
When K ⊆Rn is a convex body of volume one with barycenter at the origin, an
alternative deﬁnition of L2
K is that it is the minimum of the right-hand side of (8)
over all linear transformations of determinant one. Consequently, for such K ⊆Rn
there exists a linear map T with det(T ) = 1 and
L2
K = 1
n

K
|T x|2dx = 1
n

 ∞
0
V oln(K \ √sT −1(Bn))ds ≥1
n

 κ−2/n
n
0
>
1 −κnsn/2?
ds = L2
Bn,
where Bn = {x ∈Rn ; |x| = 1} is the Euclidean unit ball and κn = V oln(Bn).
Since L2
Bn = 1/(2πe)+o(1), we conclude that LK > c for some universal constant
c > 0.

210
B. Klartag and V. Milman
If K ⊂Rn is an isotropic convex body, then for any two hyperplanes H1, H2 ⊆
Rn through the origin,
V oln−1(K ∩H1)
V oln−1(K ∩H2) ≤C
(9)
for a universal constant C > 0. This was proven by Hensley [45] in the case where
K is centrally symmetric and rediscovered by the second-named author in Lemma 2
in [21]. Fradelizi [38] eliminated the assumption that K is centrally symmetric and
obtained the sharp bound C ≤
√
6 in (9). In order to prove (9), one ﬁxes a unit
vector θ ∈Sn−1 and denotes
ρ(t) = V oln−1(K ∩(tθ + θ⊥)).
A crucial property that follows from the Brunn-Minkowski inequality is that ρ is
log-concave, that is, the function log ρ is a concave function (which is allowed to
attain the value −∞). Therefore, the proof of (9) boils down to the proof of the
following one-dimensional inequality: For any log-concave probability density ρ :
R →[0, ∞) with

tρ(t)dt = 0,
1
√
12
≤ρ(0) ·
4
 ∞
−∞
t2ρ(t)dt ≤
1
√
2
.
(10)
The space of one-dimensional, log-concave probability densities of mean zero and
variance one is compact in the L1-topology. A compactness argument shows that an
inequality such as (10) holds true with some numerical constants. The sharp values
of the constants in (10) are due to Fradelizi [38]. Consequently, whenever K ⊆Rn
is an isotropic convex body, for any hyperplane H ⊆Rn through the origin,
1
√
12 · LK
≤V oln−1(K ∩H) ≤
1
√
2 · LK
.
(11)
The assumption that H passes through the origin is not entirely necessary for the
right-hand side inequality in (11), if one is willing to increase the constant. This
follows from a version of inequality (10) where ρ(0) is replaced by sup ρ; see
Fradelizi [38]. It follows that when K ⊆Rn is convex and isotropic, for any
hyperplane H ⊆Rn,
V oln(K ∩H) ≤
1
LK
.
(12)
From (12), we obtain the relatively trivial bound LK ≤C√n for the isotropic
constant. Indeed, since K is convex and of volume one, it cannot have a width
larger than 5√n in all directions, as otherwise K −K would contain a Euclidean
ball of volume larger than 4n, in contradiction to the Rogers-Shephard inequality

The Slicing Problem by Bourgain
211
[86]. We recall that this inequality states that V oln(K −K) ≤4nV oln(K) for any
convex body K ⊆Rn. Pick a direction in which the width of K is at most 5√n,
and use Fubini’s theorem to ﬁnd a hyperplane H orthogonal to this direction with
V oln(K ∩H) ≥1/(5√n). Now (12) shows that LK ≤5√n.
The idea demonstrated above, of reducing statements on convex bodies to one-
dimensional inequalities pertaining to log-concave functions, is a common theme
in convex geometry. For example, the reverse Hölder inequality (4) may be proven
by reducing matters to a one-dimensional inequality with log-concave probability
densities. A log-concave function in one dimension of a ﬁnite integral decays
exponentially at inﬁnity (see, e.g. [52, Lemma 2.1]). It follows (see [83] or [82]) that
for any convex body K ⊆Rn of volume one, the “ψ1-norm” of a linear functional
f : Rn →R satisﬁes
∥f ∥ψ1(K) ≤C∥f ∥L2(K)
(13)
where C > 0 is a universal constant, where ∥f ∥p
Lp(K) =

K |f |p and where for
α ≥1,
∥f ∥ψα(K) = inf
!
λ > 0 ;

K
exp(|f/λ|α) ≤2
=
.
(14)
The ψ1-norm of a function f is ﬁnite if its value distribution is subexponential, and
the ψ2-norm is ﬁnite if the distribution is sub-Gaussian. The contrast between ψ1-
norm and ψ2-norm, or between subexponential tail and sub-Gaussian tail, lies at the
heart of Bourgain’s bound LK ≤Cn1/4 log n. Before proceeding with Bourgain’s
proof, let us provide a bit of background on ψ2-processes and on certain results from
the local theory of Banach spaces that are related to Bourgain’s proof. Suppose that
μ is a probability measure on Rn, and denote
A :=
sup
θ∈Sn−1 ∥fθ∥ψ2(μ)
(15)
where fθ(x) = ⟨x, θ⟩and where the ψ2-norm of a function f with respect to the
measure μ is deﬁned analogously to (14) above. A key result by Talagrand [96, 97]
continuing the work of Fernique [35] states that for any norm ∥· ∥on Rn,

Rn ∥x∥dμ(x) ≤CA

Rn ∥x∥dγn(x)
(16)
where C > 0 is a universal constant and where γn is the standard Gaussian measure
on Rn. The proof of inequality (16) involves concepts such as majorizing measures
and generic chaining.
Bounds for the Gaussian integral of a norm, as on the right-hand side of (16), are
of great importance in the local theory of Banach spaces. One of the most important
and useful technical statements in this direction is the following theorem, which is

212
B. Klartag and V. Milman
a combination of three results, by Lewis [69], by Figiel and Tomczak-Jaegermann
[36], and, the most non-trivial, by Pisier [90, 91] (see also the appendix of [25] for
a complete proof):
Theorem 2.1 For any norm ∥· ∥on Rn, there exists an invertible linear transfor-
mation T such that

Rn ∥T x∥dγn(x) ·

Rn ∥(T −1)∗y∥∗dγn(y) ≤Cn log dBM
where ∥· ∥∗is the dual norm and where dBM is the Banach-Mazur distance of
the norm ∥· ∥from a Euclidean norm. The linear map T determines the so-called
ℓ-position.
When a norm ∥· ∥on Rn has K as its unit ball, its Banach-Mazur distance from
a Euclidean norm is
dBM = dBM(K) = inf{rs > 0 ; ∃T : Rn →Rn linear, with r−1Bn ⊆T (K) ⊆sBn}.
(17)
It is well-known that dBM ≤√n; see e.g. [82]. We remark in passing that up to
logarithmic factors, the slicing problem is equivalent to the question of whether
the isotropic position is an ℓ-position, as one may show; see [27] for related
results. Theorem 2.1 is a central ingredient of the original proof of the Bourgain-
Milman inequality [25], which states that for any convex body K ⊆Rn with
barycenter at the origin,
V oln(K)V oln(K◦) ≥cnV oln(Bn)2 ≥(c′/n)n,
(18)
where K◦= {x ∈Rn ; ∀y ∈K, |⟨x, y⟩| ≤1} is the polar body, i.e., the unit ball
of the dual norm. There are by now several proofs of (18) using methods and ideas
from very different parts of mathematics. Kuperberg’s proof relies on topology [66],
Nazarov’s proof on complex analysis [85], and the proof by Giannopoulos, Paouris,
and Vritsiou on transportation of measure via the logarithmic Laplace transform
[42] as in Section 4 below. Inequality (18) is a converse to the Santaló inequality,
which states that
V oln(K)V oln(K◦) ≤V oln(Bn)2,
and may be proven via Steiner symmetrizations [76, 77]. A clever application of
Hölder’s inequality shows that

Rn ∥x∥dγn(x) ≥cn · v−1/n where v > 0 is the
volume of the unit ball of the norm ∥·∥in Rn. It thus follows from Theorem 2.1 and
from the above that for any norm ∥·∥on Rn, there exists a linear map T : Rn →Rn
of determinant one such that

Rn ∥T x∥dγn(x) ≤Cn log n · V 1/n
(19)

The Slicing Problem by Bourgain
213
where now V > 0 is the volume of the unit ball of the dual norm ∥· ∥∗in Rn.
Let us now return to the proof of Bourgain’s bound for the isotropic constant. It
follows from (7) and from the Markov-Chebyshev inequality that for any isotropic
convex body K ⊆Rn,
V oln(K ∩(
√
2nLKBn)) = 1 −V oln(K \ (
√
2nLKBn)) ≥1 −

K |x|2dx
2nL2
K
= 1
2.
(20)
The ﬁrst step of the proof is to use (20) in order to show the following: When
replacing K with K ∩C√nLKBn, the isotropic constant changes by a factor of
at most C, and the new convex body is still roughly in isotropic position (up to a
constant). Thus, it sufﬁces to bound the isotropic constant of an isotropic convex
body K ⊆Rn which satisﬁes the additional assumption that
K ⊆10√nLKBn.
(21)
One corollary of (21) is that for any θ ∈Sn−1, the linear functional fθ(x) = ⟨x, θ⟩
satisﬁes
∥fθ∥L∞(K) ≤10√nLK.
The ψ1(K)-norm of fθ is at most CLK, according to (7) and (13) above. There is a
simple interpolation inequality between the ψ1-norm and the L∞-norm that yields
a bound for the ψ2-norm. Namely, for any θ ∈Sn−1,
∥fθ∥ψ2(K) ≤
@
∥fθ∥ψ1(K) · ∥fθ∥L∞(K) ≤
A
CLK · 10√nLK = C′n1/4LK.
(22)
The proof of the interpolation inequality on the left-hand side of (22) is simple; note
that when sup |f | ≤M,

K
e|f/
√
λM|2 ≤

K
e|f/λ| ≤2
if λ ≥∥f ∥ψ1(K). The next step in Bourgain’s proof is to apply (8) and conclude that
for any symmetric, positive-deﬁnite linear map T : Rn →Rn with det T = 1,
nL2
K ≤

K
⟨T x, x⟩≤

K
sup
y∈T K
|⟨x, y⟩| =

K
∥T x∥dx
(23)
where ∥x∥= supy∈K |⟨x, y⟩| is a norm on Rn whose unit ball is polar to K ∩(−K).
An interesting feature of the maneuver (23) is the comparison between an integral
with quadratic dependence on x, which is reﬂected in the square of LK on the left-
hand side, and an integral whose dependence on x is not quadratic but only linear.
Next, thanks to (22), we may apply the Talagrand bound (16) and conclude that

214
B. Klartag and V. Milman
nL2
K ≤

K
∥T x∥dx ≤Cn1/4LK

Rn ∥T x∥dγn(x).
(24)
Inequality (24) is valid for any linear map T : Rn →Rn of determinant one
(the assumption that T is symmetric and positive-deﬁnite is immaterial due to the
symmetries of the Gaussian measure). We may now choose T to be a map leading to
ℓ-position and apply Pisier’s bound in the form of inequality (19) above. This shows
that
nL2
K ≤Cn1/4LK · n log n · V oln(K ∩(−K))1/n ≤C′n1/4LK · n log n.
This completes the proof of Bourgain’s bound LK ≤Cn1/4 log n.
In his paper [21], Bourgain claimed a positive answer to the slicing problem in
the case where K ⊆Rn is unconditional, i.e., when for any x = (x1, . . . , xn) ∈Rn,
(x1, . . . , xn) ∈K
⇐⇒
(|x1|, . . . , |xn|) ∈K.
In this case, one may use the Loomis-Whitney inequality [71], which is valid for
any compact set in Rn:
V oln(K) ≤
n

i=1
V oln−1(Proje⊥
i K)1/(n−1),
(25)
where Proje⊥
i is the orthogonal projection onto the hyperplane e⊥
i
and ei is the
ith-standard unit vector in Rn. When K is convex and unconditional, Proje⊥
i K =
K ∩e⊥
i . Hence, (11) and (25) imply that LK ≤1/
√
2 when K is convex and
unconditional (this numerical constant may be improved). Moreover, if K ⊆T and
T is an unconditional convex body such that V oln(T )/V oln(K) ≤An, it is known
that LT ≤CA; see [83] or the recent book by Brazitikos, Giannopoulos, Valettas,
and Vritsiou [12], a large part of which is concerned with the slicing problem.
In addition to unconditional bodies, there are other classes of convex bodies for
which an afﬁrmative answer to the slicing problem is known. These include zonoids
[87], their duals, more generally subspaces and quotients of Lp spaces [8, 46, 47,
78], unit balls of Schatten class norms [65], random convex bodies [59], 2-convex
bodies, and other examples described in [12].
In [24], Bourgain proved the boundness of the isotropic constant for “ψ2-bodies”
which are convex bodies for which the ψ1-estimate (13) can be upgraded to a ψ2-
estimate. That is, for a convex body K ⊆Rn of volume one with barycenter at the
origin and for 1 ≤α ≤2, we write bα(K) to be the minimum b > 0 such that for
any linear functional f : Rn →R,
∥f ∥ψα(K) ≤b∥f ∥L2(K).

The Slicing Problem by Bourgain
215
Thus, b1(K) ≤C according to (13), while for ellipsoids E ⊆Rn we have b2(E) ≤
C. Bourgain proved that LK ≤Cb2(K) log b2(K), and the logarithmic factor was
later removed by the ﬁrst-named author and E. Milman in [63] using methods related
to those described in Section 4. The current state of the art is the bound LK ≤
C
@
bα(K)αn1−α/2 for any 1 ≤α ≤2, from [63].
A class of convex bodies in high dimensions with favorable properties is the
class of convex bodies of a ﬁnite volume ratio, a notion introduced by Szarek
and Tomczak-Jaegermann [94, 95]. These are centrally symmetric convex bodies
K ⊆Rn that contain an ellipsoid E such that V oln(K)/V oln(E) ≤Cn for a
universal constant C. Dvoretzky’s theorem asserts that an arbitrary convex body
in Rn has a k-dimensional section that is approximately Euclidean for k of the
order of magnitude of log n. This estimate is dramatically improved in the class
of ﬁnite-volume ratio bodies, and it was proven by Kashin [49] and then using this
terminology by Szarek and Tomczak-Jaegermann [94, 95] that such bodies contain
an approximately Euclidean section of dimension k ≥cn. In our joint work with
Bourgain [26, 27], we proved that the validity of the hyperplane conjecture in the
class of ﬁnite-volume ratio bodies would imply its validity in the class of all convex
bodies. This is proven via a method based on Steiner symmetrization.
We move on to describe yet another equivalent formulation of the slicing
problem, which is also related to Steiner symmetrizations. Let K ⊆Rn be a convex
body and let H = h⊥⊆Rn be a hyperplane, where h ∈Sn−1 is a unit vector.
Deﬁne the Steiner symmetral of K with respect to H as the set
SH (K) =
!
x + th ; x ∈H, t ∈R, K ∩(x + Rh) ̸= ∅, |t| ≤1
2Meas{K ∩(x + Rh)}
=
where Meas is the one-dimensional Lebesgue measure in the line x + Rh. Steiner
symmetrization preserves the volume of the set K, and it transforms convex sets
to convex sets. Applying consecutive Steiner symmetrizations with respect to a
sequence of hyperplanes makes K “more symmetric,” or “closer to a Euclidean
ball.” It was proven in [60] that for any convex body K ⊆Rn with V oln(K) =
V oln(Bn) there exist 3n Steiner symmetrizations that transform K into a convex
body ˜K with
1
C Bn ⊆˜K ⊆CBn.
(26)
When ˜K satisﬁes (26), we say that it is an “isomorphic Euclidean ball.” If one
applies only n −ℓsymmetrizations for some positive ℓ, then there exists an ℓ-
dimensional projection of K that remains unchanged in the symmetrization process.
Hence, at least n −O(1) symmetrizations are required to arrive at an isomorphic
Euclidean ball as in (26), or even at an isomorphic ellipsoid. However, there exist
certain special convex bodies, such as the unit cube, that can be transformed into an
isomorphic ellipsoid using fewer symmetrizations. Given a convex body K ⊂Rn
and a function c(ε) (0 < ε < 1), we say that “K is c(ε)-symmetrizable” if for any
ε > 0 there exist ⌊εn⌋Steiner symmetrizations that transform K into a convex body

216
B. Klartag and V. Milman
˜K with
dBM(K) < c(ε)
where dBM(K) is the Banach-Mazur distance between K and a Euclidean ball,
deﬁned analogously to (17). For example, the cube [−1, 1]n is c(ε)-symmetrizable
for c(ε) = C√| log ε|/ε. Suppose that we are allowed to remove 10% of the mass
of a convex body K. Can we now apply only εn Steiner symmetrizations and obtain
a body that resembles an ellipsoid, up to a universal constant?
Question 2.1 Does there exist C, d > 0, such that for any dimension n and for
any convex body K ⊆Rn, there exists a convex body T ⊆K with V oln(T ) >
0.9 · V oln(K) such that T is (C/ε)d-symmetrizable?
In [61], it is proven that Question 2.1 has an afﬁrmative answer if and only if
Bourgain’s hyperplane conjecture holds true.
3
Distribution of Volume in Convex Bodies
The assumption that K is convex was used in Bourgain’s proof through the ψ1-
bound (13), the fact that the distribution of values of a linear functional on a convex
set has a uniformly subexponential tail. In fact, instead of dealing with the uniform
measure on a given convex body K ⊆Rn of volume one, we may consider a more
general situation: Suppose that μ is a probability measure supported on K whose
continuous density is denoted by f . Assume that μ satisﬁes a ψ1-condition: For any
linear functional f : Rn →R,
∥f ∥ψ1(μ) ≤A∥f ∥L2(μ),
for some parameter A > 0, where the deﬁnition of the ∥· ∥ψ1(μ) norm is analogous
to (14). A straightforward adaptation of Bourgain’s argument (see the Appendix of
[57]) shows that under these assumptions there exists a hyperplane H ⊆Rn with

H
f ≥
c(A)
n1/4 log n,
(27)
where c(A) > 0 depends solely on A. Up to the logarithmic factor, the estimate
“n1/4 log n” in (27) is sharp, as shown by the ﬁrst-named author and Koldobsky
[57]. Thus, Bourgain’s bound for the slicing problem is sharp up to logarithmic
factors, if all that one takes from convexity is the uniform ψ1-estimate for linear
functionals.
Nevertheless, there is more to say about the distribution of volume in convex
bodies beyond the subexponential tail of linear functionals. We begin by discussing
the point of view emphasized by K. Ball [6] that connects between volume

The Slicing Problem by Bourgain
217
distribution of convex bodies and that of log-concave measures. Recall that a
function ρ : Rn →[0, ∞) is log-concave if −log ρ is a convex function, which
is allowed to attain the value +∞. For example, the characteristic function of a
convex body, which equals one on the body and vanishes elsewhere, is a log-concave
function.
A Borel measure on Rn is log-concave if it is supported in an afﬁne subspace
with a log-concave density in this subspace. It was proven by Borell [19] that a
ﬁnite, Borel measure μ on Rn is a log-concave measure if and only if the following
Brunn-Minkowski type inequality holds true: For any compacts A, B ⊆Rn and for
any 0 < λ < 1,
μ(λA + (1 −λ)B) ≥μ(A)λμ(B)1−λ.
(28)
It follows from (28) that the push-forward of a log-concave measure under a linear
map is again log-concave. In particular, by projecting the uniform measure on a
convex body to a lower-dimensional subspace, we obtain a log-concave measure on
this subspace. Given an integrable log-concave function ρ : Rn →R with ρ(0) > 0,
deﬁne
K(ρ) =
!
x ∈Rn ;

 ∞
0
ρ(tx)tndt ≥ρ(0)
n + 1
=
.
(29)
As shown by K. Ball [6], the set in (29) is always convex. The convexity of K(ρ) is
closely related to the Busemann inequality [29]; see [83].
The convex body K(ρ) seems to represent rather well the volume distribution of
the measure μ whose density is ρ. For example, if the barycenter of μ lies at the
origin, so does the barycenter of K(ρ). As in [51], we deﬁne the isotropic constant
of a log-concave function ρ : R →[0, ∞) with 0 <

ρ < ∞as
Lρ =
sup ρ

ρ
1/n
· det Cov(ρ)1/(2n)
where the covariance matrix Cov(ρ) is deﬁned analogously to (5). It was proven by
Ball [6] (see also [51]) that we always have
Lρ ≃LK(ρ).
(30)
Thus, the slicing problem is equivalent to the problem of bounding the isotropic
constant of an arbitrary log-concave measure μ on Rn.
A new era in the study of volume distribution in high-dimensional convex sets
began in 2005 when Paouris [89] found applications of the following property: For
any absolutely continuous, log-concave probability measure μ on Rn, there exists
θ ∈Sn−1 with

218
B. Klartag and V. Milman

Rn |⟨x, θ⟩|ndμ(x)
1/n
≃
4
Rn |x|2dμ(x).
(31)
This property is proven by associating a certain convex body with the measure
μ similarly to (29); see [62] or (better) the short argument in [1]. Note that this
property of log-concave measures does not follow from the ψ1-bound for linear
functionals, used in Bourgain’s proof (e.g., look at the random variable X = R
where R is a standard one-dimensional Gaussian and  is an n-dimensional standard
Gaussian independent of R). Recalling that the orthogonal projection of the uniform
measure of a convex body is always log-concave, we conclude the following from
(31): For any isotropic convex body K ⊆Rn and for any ℓ-dimensional subspace
E ⊆Rn, there exists a unit vector θ ∈E with

K
|⟨x, θ⟩|ℓdx
1/ℓ
≃
√
ℓLK.
(32)
Note that an isotropic convex body K is a ψ2-body if and only if (32) holds true for
any θ ∈Rn and for any ℓ. Thus, property (32) may be viewed as a weak form of a
ψ2-estimate, which is valid for any convex body. Paouris used (32) in order to prove
the following large deviation estimate:
Theorem 3.1 (Paouris [89]) Let K ⊆Rn be an isotropic convex body of volume
one. Then, for any t > 1,
V oln({x ∈K ; |x| ≥CtLK
√n}) ≤e−t√n
(33)
where C > 0 is a universal constant.
In order to appreciate Theorem 3.1, recall from (20) that
V oln({x ∈K ; |x| ≤2LK
√n}) ≥1/2,
i.e., at least half of the mass of K is located in a ball of radius 2LK
√n centered at
the origin. Theorem 3.1 tells us that only a tiny fraction, just an e−√n-fraction of the
mass of K, is located outside a ball of radius CLK
√n. This effect is a precursor to
the thin-shell estimate for isotropic convex bodies that we will discuss shortly. The
Paouris proof of Theorem 3.1 applies the second-named author’s estimates for the
Dvoretzky theorem (see [81]) in the context of the norm
∥y∥Lp(K) = ∥⟨·, y⟩∥Lp(K) =

K
|⟨x, y⟩|pdx
1/p
(y ∈Rn).
The unit ball of the dual norm is denoted by Zp(K) ⊆Rn, and it is referred to
as the Lp-centroid body of K; see also Lutwak and Zhang [72]. If K is isotropic,
then the set Z2(K) is a Euclidean ball of radius LK. In the case where K is centrally

The Slicing Problem by Bourgain
219
symmetric, we have Z∞(K) = K. The ψ1-estimate for linear functionals on convex
bodies (13) is equivalent to the assertion that
Zp(K) ⊆CpZ2(K)
for all p ≥1.
(34)
The idea of Paouris was to apply the quantitative theory of Dvoretzky’s theorem,
due to the second-named author [81], to the Lp-centroid bodies. Together with the
estimate (34), this quantitative theory yields the following: Suppose that K ⊆Rn
is an isotropic convex body and 1 ≤ℓ≤c√n. Then, for a random ℓ-dimensional
subspace E ⊆Rn, with high probability, the orthogonal projection of Zℓ(K) onto
E denoted by
ProjE(Zℓ(K))
(35)
is an isomorphic Euclidean ball. In other words, the convex body in (35) contains a
Euclidean ball of radius r centered at the origin, and it is contained in a Euclidean
ball of radius Cr. We may now invoke (32) and conclude that r has the order
of magnitude of
√
ℓLK. Thus, by the quantitative estimates revolving around
Dvoretzky’s theorem, due to Litvak, Milman, and Schechtman [70],
√
ℓLK ≃r ≃

Sn−1 ∥y∥ℓ
Lℓ(K)dσ(y)
1/ℓ
≃
B
ℓ
n

K
|x|ℓdx
1/ℓ
,
(36)
where σ is the rotationally invariant probability measure on Sn−1. Thus, (36) yields
estimates for Lp-moments of the Euclidean norm for all p ≤c√n, which imply
that only a fraction of at most e−√n of the volume of K is located outside a ball of
radius CLK
√n.
The tension between ψ1-estimates and ψ2-estimates for convex bodies, going
back to Bourgain’s work in the 1980s, is a central issue in the analysis of the slicing
problem. Recall that the inclusion (34) follows from the ψ1-bound, while a ψ2-
estimate with constant A would yield that Zp(μ) ⊆CA√pZ2(μ). In this respect,
it is worthwhile to mention yet another equivalent formulation of the hyperplane
conjecture, which may be extracted from [63, Remark 3.3]: Question 1.2 has an
afﬁrmative answer if and only if for any isotropic convex body K ⊆Rn and
any 1 ≤p ≤n,
V ol1/n(Zp(μ)) ≃√p · V ol1/n(Z2(μ)).
A question by the second-named author (see [10, 87, 88]) asks whether for any
convex body K ⊆Rn there exists a non-zero linear functional ϕ : Rn →R for
which
∥ϕ∥ψ2(K) ≤C∥ϕ∥L2(K),

220
B. Klartag and V. Milman
with a universal constant C. In other words, does any convex body have at least one
direction with a uniformly sub-Gaussian tail? In some sense, a direction where the
tail is approximately exponential resembles a “cone-like behavior” of the convex
body (see [52]), and the question is whether there always exists a direction in which
better, sub-Gaussian behavior is observed. It was proven by the ﬁrst-named author in
[52] that the answer is afﬁrmative up to logarithmic factors. The logarithmic factor
that the proof in [52] yielded is log5(t + 1) (in formula (37) below), and it was
subsequently improved to log2(t + 1) in Giannopoulos, Pajor, and Paouris [40] and
then to log(t + 1) in Giannopoulos, Paouris, and Valettas [41]:
Theorem 3.2 Let n ≥1 be an integer, and let K ⊂Rn be a convex body of volume
one. Then, there exists a non-zero linear functional ϕ : Rn →R such that for any
t ≥1,
V oln

{x ∈K; |ϕ(x)| ≥t∥ϕ∥L1(K)}

≤e−c
t2
log(t+1)
(37)
where c > 0 is a universal constant.
In the case of unconditional convex bodies, the logarithmic factor in (37) is
not needed at all, as proven in Bobkov and Nazarov [15]. In general, it is not
known whether the logarithmic factor is necessary, or equivalently, whether any
convex body admits at least one uniformly sub-Gaussian direction. We move on
to discuss the question of the existence of approximately Gaussian directions. A
conjecture that appears in the works of Anttila, Ball, and Perissinaki [2] and Brehm
and Voigt [28] suggests that any high-dimensional convex body admits at least one
approximately Gaussian direction. That is, it was conjectured that whenever X is a
random vector in Rn, uniformly distributed in some convex body, then there exists
0 ̸= θ ∈Rn such that the random variable
⟨X, θ⟩
is approximately a Gaussian random variable. The degree of the approximation is
expected to improve when the dimension n increases. The conjecture clearly holds
true in the case where X is uniform in an n-dimensional cube, by the classical central
limit theorem, and in the case where X is uniform in a Euclidean ball or an ellipsoid,
by the so-called Maxwell observation. The conjecture has turned out to be true in
general, as proven by the ﬁrst-named author [53]:
Theorem 3.3 (“Central Limit Theorem for Convex Bodies”) There exists a
sequence εn ↘0 for which the following holds: let K ⊂Rn be a convex body,
and let X be a random vector that is distributed uniformly in K. Then, there exist a
unit vector θ ∈Sn−1, t0 ∈R and V > 0 such that
sup
A⊆R
 P { ⟨X, θ⟩∈A } −
1
√
2πV

A
e−(t−t0)2
2V
dt
 ≤εn,

The Slicing Problem by Bourgain
221
where the supremum runs over all measurable sets A ⊆R.
Moreover, if the convex body K ⊆Rn is an isotropic body of volume one, then
there exists a subset  ⊆Sn−1 with σ() ≥1 −εn such that for all θ ∈,
sup
A⊆R
| P { ⟨X, θ⟩∈A } −P { Z ∈A } | ≤εn,
where Z is a Gaussian random variable of mean zero and variance L2
K.
The bound obtained in [54] for εn is εn ≤C/nα where C, α > 0 are universal
constants and α ≥1/15.
Theorem 3.3 exposes a universal property of high-dimensional convex bodies:
they all have approximately Gaussian one-dimensional marginals. Moreover, most
of these marginals of a high-dimensional convex body, with the isotropic normal-
ization, are approximately Gaussian. In fact, this phenomena is not restricted to
one-dimensional marginals. As was proven by Eldan and the ﬁrst-named author
[33], when one projects the uniform measure of an istoropic convex body K ⊂Rn to
a random k-dimensional subspace E with k ≤cnα, the probability measure obtained
in E has a density that is approximately Gaussian, both in total variation sense and
in the sense that the ratio between this density and a Gaussian density in E is very
close to 1 in large parts of the subspace E. Here, c, α > 0 are universal constants.
Interestingly, the Gaussian approximation property of convex bodies may be
reformulated in terms of a thin-shell condition, according to a beautiful general
principle that goes back to Sudakov [93] and to Diaconis and Freedman [31] (see
also Anttila, Ball, and Perissinaki [2], Bobkov [14], and von Weizsäcker [98]). This
principle reads as follows: suppose that X is any random vector in Rn with ﬁnite
second moments, normalized to have mean zero and identity covariance. Then, most
of the one-dimensional marginals of X are approximately Gaussian if and only if the
random variable |X|/√n is concentrated around the value one, i.e.,
E
|X|
√n −1
2
≤ε,
for a small number ε > 0. These assumptions imply that the Kolmogorov distance
between a typical marginal of X and a Gaussian distribution is bounded by C(ε +
n−α) for universal constants C, α > 0; see the formulation in [55]. In other words,
typical marginals are approximately Gaussian if and only if most of the mass of X
is concentrated in a “thin spherical shell” whose radius is √n and whose width is
much smaller than √n. Theorem 3.3 is therefore parallel to the estimate
σ 2
K
n := E

|X|
√nLK
−1
2
≤C
nα ,
(38)
valid for any random vector X that is distributed uniformly in an isotropic convex
body K ⊆Rn, where C, α > 0 are universal constants. Thus, most of the volume of

222
B. Klartag and V. Milman
Fig. 1 The thin-shell and large deviation regimes (illustration by S. Artstein-Avidan)
a convex body in high dimensions, with the isotropic normalization, is contained in a
thin spherical shell, whose width is much smaller than its radius. This complements
the Paouris large deviation bound, Theorem 3.1. See Fig. 1 for an illustration.
The parameter α from (38) is related to the width of the thin spherical shell that
contains most of the mass of an isotropic convex body K ⊆Rn. The argument in
[54] leads to the estimate α ≥1/6, which was improved to α ≥1/4 by Fleury [37],
to α ≥1/3 by Guédon and Milman [44], and then to α ≥1/2 by Lee and Vempala
[67] who built upon a stochastic localization technique of Eldan [32]. In terms of
the thin-shell parameter σK deﬁned in (38), the current best bound due to Lee and
Vempala [67] is that for any isotropic convex body K ⊆Rn,
σK ≤Cn1/4
(39)
where C > 0 is a universal constant. The “1/4” in (39) perhaps reminds us of the
best known result for the slicing problem LK ≤Cn1/4 from [51], which is up to
logarithmic factors due to Bourgain. This is not fully a coincidence. It was proven
by Eldan and the ﬁrst-named author in [34] that
sup
K⊆Rn LK ≤C sup
K⊆Rn σK.
(40)
Thus, any progress on the thin-shell parameter σK beyond the bound (39) would
automatically lead to progress in the slicing problem. It was conjectured in Anttila,
Ball, and Perissinaki [2] and in Bobkov and Koldobsky [16] that σK is bounded by a

The Slicing Problem by Bourgain
223
universal constant, perhaps up to a logarithmic factor. In view of (40), the thin-shell
conjecture would imply the hyperplane conjecture.
We move on to a brief discussion of further developments related to the
isoperimetric problem in convex bodies; see, e.g.. the recent survey by Lee and
Vempala [67] for a thorough treatment. In addition to the isotropic constant LK and
the thin-shell parameter σK, an important quantity related to an isotropic convex
body K ⊆Rn is its isoperimetric constant or Cheeger constant, deﬁned as follows:
1
ψK
:= LK · inf
A⊆K
V oln−1(K ∩∂A)
min{V oln(A), V oln(K \ A)}
(41)
where the inﬁmum runs over all subsets A ⊆K with smooth boundary and where
we recall that in this paper a convex body K is an open set and K is its closure. In
the inﬁmum in (41), we partition K into two parts so as to minimize the surface area
of the interface between them; we do not include in the surface area the part of ∂A
that lies on the boundary of K, only the interface between the two parts inside the
convex, open set K. The reason for the normalization in (41) is the following chain
of inequalities:
sup
K⊆Rn LK ≤C sup
K⊆Rn σK ≤˜C sup
K⊆Rn ψK ≤¯Cn1/4,
(42)
where the suprema run over all isotropic convex bodies in Rn and where the last
inequality was proven by Lee and Vempala [67]. It was conjectured in Kannan,
Lovász, and Simonovits (KLS) [48] that ψK ≤C for any isotropic convex body
K ⊆Rn, where C > 0 is a universal constant. This is a stronger conjecture than
slicing, in view of (42). Ball and Nguyen [9] proved the bound LK ≤exp(Cψ2
K)
for any isotropic convex body in Rn. Eldan reduced the study of the isoperimetric
KLS conjecture to the thin-shell conjecture, up to logarithmic factors. Denoting
ψn = supK⊆Rn ψK and σn = supK⊆Rn ψK, it was proven in Eldan’s breakthrough
paper [32] that
ψn ≤C
C
D
D
Elog n ·
n

ℓ=1
σ 2
ℓ
ℓ,
where C > 0 is a universal constant. It follows that up to factors logarithmic in
the dimension, the thin-shell conjecture is equivalent to the isoperimetric KLS
conjecture. We summarize this section by noting that current progress in the thin-
shell and KLS conjectures stops at n1/4, which is the best known bound for the
seemingly innocent slicing problem.

224
B. Klartag and V. Milman
4
Bound for the Isotropic Constant
In this section, we provide some details regarding the logarithmic improvement of
Bourgain’s bound for the isotropic constant. This improvement is related to the
following theorem due to the ﬁrst-named author [51], the so-called isomorphic
version of the slicing problem:
Theorem 4.1 Let K ⊂Rn be a convex body and 0 < ε < 1. Then, there exists a
convex body T ⊂Rn such that
(i) (1 −ε)T ⊆K ⊆(1 + ε)T .
(ii) LT < C/√ε, where C > 0 is a universal constant.
In [56], it is proven that T from Theorem 4.1 can be additionally assumed to be
a projective image of K. Recall that the projective image of a polytope is itself a
polytope with the same number of vertices and faces.
The Paouris large deviation estimate, which is Theorem 3.1 above, implies the
following: For any convex bodies K, T ⊆Rn, if

1 −1
√n

T ⊆K ⊆

1 + 1
√n

T
(43)
then
LK ≃LT .
(44)
Indeed, since isotropic constants are invariant under afﬁne transformations, we may
assume that K is an isotropic convex body. Theorem 3.1 shows that at most an
e−10√n-fraction of the volume of K is located outside the ball C√nLKBn. It thus
follows from (43) that at most an e−√n-fraction of the volume of T is located
outside this ball. The variational characterization (8) of the isotropic constant of
T now implies that LT ≤CLK, and (44) follows by symmetry. Consequently,
by substituting ε = 1/√n in Theorem 4.1, we conclude that for any convex body
K ⊆Rn,
LK ≤Cn1/4,
as advertised. Let us now elaborate on the ideas behind the proof of Theorem 4.1.
We are given a convex body K ⊆Rn. After translation, we may assume that the
barycenter of K lies at the origin. Consider the logarithmic Laplace transform
F(x) = FK(x) = log

Rn e⟨x,y⟩dy.

The Slicing Problem by Bourgain
225
The function F is smooth and convex in Rn, by the Cauchy-Schwartz inequality. In
fact, for any x ∈Rn, denoting by μx the probability measure on K with density
y →e⟨x,y⟩−F(x)1K(y), we have
∇F(x) = bar(μx)
and
∇2F(x) = Cov(μx),
(45)
where bar(μx) =

ydμx(y) is the barycenter of μx and where ∇2F(x) is the
Hessian matrix of F. Note that ∇F(x) ∈K for any x ∈Rn, since μx is a measure
supported on K, and hence its barycenter is in K by convexity. The Hessian of
F is positive-deﬁnite everywhere, according to (45). This convexity property of F
implies that the map x →∇F(x) is a diffeomorphism from Rn onto an open subset
of K (which is in fact K itself).
Fix 0 < ε < 1 as in the formulation of Theorem 4.1. We may use the point of
view of “transportation of measure” and change variables as follows:

εnK◦det Cov(μx)dx =

εnK◦det ∇2F(x)dx
“y=∇F(x)′′
=

∇F(εnK◦)
1dy ≤V oln(K),
as ∇F(εnK◦) ⊆∇F(Rn) ⊆K. In particular, there exists x ∈εnK◦such that
det Cov(μx) ≤
V oln(K)
V oln(εnK◦) = ε−n
V oln(K)2
nnV oln(K)V oln(K◦) ≤
C
ε
n
V oln(K)2,
(46)
where the last passage follows from the Bourgain-Milman inequality (18). Let us
take a closer look at the probability measure μx. It is a log-concave measure with
density
ρ(y) = e⟨x,y⟩−F(x)1K(y).
Since x ∈εnK◦, we know that |⟨x, y⟩| ≤εn for all y ∈K. Hence,
supK ρ
infK ρ =
supy∈K e⟨x,y⟩
infy∈K e⟨x,y⟩≤eεn
e−εn = e2εn.
(47)
Recall the convex body K(ρ) associated with the log-concave density ρ via formula
(29). It follows from (29) and (47) that
(1 −Cε)K ⊆K(ρ) ⊆(1 + Cε)K
for some universal constant C > 0. We still need to show that LK(ρ) ≤˜C/√ε, so
that Theorem 4.1 would follow with T = K(ρ). In view of (30), it sufﬁces to show
that
Lρ ≤C/√ε.
(48)

226
B. Klartag and V. Milman
However, since the barycenter of K lies at the origin, we know that ∇F(0) = 0 by
(45). Since F is a convex function, its critical points are global minimum points,
and hence F(x) ≥F(0) = log V oln(K) for any x ∈Rn. Consequently, by (46),
Lρ = (sup ρ)1/n · det Cov(ρ)1/(2n) = exp
supy∈K⟨x, y⟩−F(x)
n

· det Cov(ρ)1/(2n)
≤exp
εn −log V oln(K)
n

·
C
ε
n
V oln(K)2
1/(2n)
≤
˜C
√ε .
This completes the proof of (48), as well as our sketch of the proof of Theorem 4.1.
It is possible to view the hyperplane conjecture as a strong conjectural version of
the Bourgain-Milman inequality and of the M-ellipsoid theory due to the second-
named author. We present two interpretations of this point of view. The ﬁrst
interpretation is related to the strong slicing conjecture, which suggests that for any
convex body K ⊆Rn,
LK ≤Ln =
(n!)
1
n
(n + 1)
n+1
2n ·
√
n + 2
,
(49)
where n ⊆Rn is any simplex whose vertices span Rn and add up to zero. This
conjecture holds true in two dimensions. See also Rademacher [92] for supporting
evidence. On the other hand, the Mahler conjecture suggests that for any convex
body K ⊆Rn containing the origin in its interior,
V oln(K)V oln(K◦) ≥V oln(n) · V oln((n)◦) = (n + 1)n+1
(n!)2
.
(50)
In two dimensions, the conjecture was proven by Mahler [74]; see also Meyer [75],
and see Barthe and Fradelizi [11] for the case of convex bodies with symmetries.
The Bourgain-Milman inequality established (50) up to a factor of cn, for a universal
constant c > 0. In [56], it is shown that the strong version (49) of Bourgain’s
slicing conjecture implies Mahler’s conjecture (50). Let us also mention in
passing that in the centrally symmetric case, the strong version of Bourgain’s slicing
conjecture is that the isotropic constant is maximized for the cube. If this is true,
then an old conjecture by Minkowski would follow; see Magazinov [73] and also
Autissier [3]. The Minkowski conjecture suggests that for any lattice L ⊆Rn of
unit covolume and for any x ∈Rn there exists y ∈L with n
i=1 |xi −yi| ≤2−n.
There is also a second interpretation of the relationship between the slicing
problem and the notion of the M-ellipsoid and the Bourgain-Milman inequality.
For a convex body K ⊆Rn, an ellipsoid E ⊆Rn is called an M-ellipsoid for K
with constant A if
V oln(E) = V oln(K)
and
N(K, E) · N(E, K) ≤eAn.

The Slicing Problem by Bourgain
227
Here, N(K, T ) = inf{N ; ∃x1, . . . , xN ∈Rn, K ⊆N
i=1(xi + T )} is the covering
number of K by T , the minimal number of translates of T that may cover K. The
second-named author proved [79, 80] that there exists a universal constant C > 0,
such that any convex body K ⊆Rn has an M-ellipsoid with constant C. This fact
plays an important role in asymptotic geometric analysis. For example, assume the
normalization V oln(K) = V oln(Bn), and let u ∈SLn be such that u(E) = Bn. Set
K1 = u(K). Then, for any 0 < λ < 1, with high probability of choosing a random
⌊λn⌋-dimensional subspace E ⊆Rn, the convex body
ProjE(K1)
is a convex body of ﬁnite volume ratio, with a volume ratio constant depending
solely on λ. It was observed by K. Ball [4] that for an isotropic convex body
K ⊆Rn, the Euclidean ball of volume one is an M-ellipsoid for K with a constant
depending solely on LK. Hence, a positive solution to the slicing problem, i.e.,
a universal bound on LK, would imply the theorem on the existence of the M-
ellipsoid.
Note that the M-ellipsoid is an isomorphic notion: if E is an M-ellipsoid for K
with constant A and K/2 ⊆T ⊆2K, then a homothetic copy of E of volume
V oln(T ) is also an M-ellipsoid of T with constant 4α. Therefore, Theorem 4.1
implies the existence of an M-ellipsoid for any K, with some universal constant
C > 0.
Note Added in Proofs In November 2020, Yuansi Chen posted a breakthrough paper
that signiﬁcantly improves upon the above bounds for the isotropic constant of a
general convex body in Rn. In the notation of (42), it is shown that
sup
K⊆Rn LK ≤C sup
K⊆Rn ψK ≤C1 exp(C2
@
log n · log log n),
where the suprema run over all isotropic convex bodies in Rn. In particular, LK ≤
Cεnε for any convex body K ⊆Rn and ε > 0 with a coefﬁcient Cε > 0 depending
solely on ε. The proof utilizes the stochastic localization technique of Eldan [32], as
reﬁned by Lee and Vempala [67]. See Chen, Y., An Almost Constant Lower Bound of
the Isoperimetric Coefﬁcient in the KLS Conjecture. Geom. Funct. Anal. (GAFA),
Vol. 31, Issue 1, (2021). In March/April 2022, the ﬁrst named author and Joseph
Lehec posted a paper showing that in fact
sup
K⊆Rn LK ≤C log4 n
and
sup
K⊆Rn ψK ≤C log5 n

228
B. Klartag and V. Milman
where again the suprema run over all isotropic convex bodies in Rn. The new
ingredients in the proof include a certain functional analytic interpretation of the
heat ﬂow of a log-concave distribution, as well as an inequality involving dual
Sobolev norms (see [58]).
References
1. Adamczak, R., Latała, R., Litvak, A. E., Oleszkiewicz, K., Pajor, A., Tomczak-Jaegermann,
N.: A short proof of Paouris’ inequality. Canad. Math. Bull. 57(1), 3–8 (2014)
2. Anttila, M., Ball, K., Perissinaki, I.: The central limit problem for convex bodies. Trans. Am.
Math. Soc. 355(12), 4723–4735 (2003)
3. Autissier, P.: Un lemme matriciel effectif. Math. Z. 273(1–2), 355–361 (2013)
4. Ball, K.: Isometric problems in ℓp and sections of convex sets. Ph.D. Thesis, Cambridge
University, 1986
5. Ball, K.: Cube slicing in Rn. Proc. Am. Math. Soc. 97(3), 465–473 (1986)
6. Ball, K.: Logarithmically concave functions and sections of convex sets in Rn. Studia Math.
88(1), 69–84 (1988)
7. Ball, K.: Some remarks on the geometry of convex sets. Geometric aspects of functional
analysis, Israel seminar (1986/87). Springer Lecture Notes in Math., vol. 1317, pp. 224–231
(1988)
8. Ball, K.: Normed spaces with a weak Gordon-Lewis property. Lecture Notes in Mathematics,
vol. 1470, pp. 36–47. Springer (1991)
9. Ball, K., Nguyen, V.H.: Entropy jumps for isotropic log-concave random vectors and spectral
gap. Studia Math. 213(1), 81–96 (2012)
10. Barthe, F., Guédon, O., Mendelson, S., Naor, A.: A probabilistic approach to the geometry of
the ln
p-ball. Ann. Probab. 33, 480–513 (2005)
11. Barthe, F., Fradelizi, M.: The volume product of convex bodies with many hyperplane
symmetries. Am. J. Math. 135(2), 311–347 (2013)
12. Brazitikos, S., Giannopoulos, A., Valettas, P., Vritsiou, B.-H.: Geometry of isotropic convex
bodies. American Mathematical Society, Providence, RI (2014)
13. Berwald, L.: Verallgemeinerung eines Mittelwertsatzes von J. Favard für positive konkave
Funktionen. Acta Math. 79, 17–37 (1947)
14. Bobkov, S.G.: On concentration of distributions of random weighted sums. Ann. Prob. 31(1),
195–215 (2003)
15. Bobkov, S.G., Nazarov, F.L.: On convex bodies and log-concave probability measures with
unconditional basis. Geometric Aspects of Functional Analysis. Lecture Notes in Math., vol.
1807, pp. 53–69. Springer (2003)
16. Bobkov, S.G., Koldobsky, A.: On the central limit property of convex bodies. Geometric
Aspects of Functional Analysis. Lecture Notes in Math., vol. 1807, pp. 44–52. Springer (2003)
17. Borell, C.: Inverse Hölder inequalities in one and several dimensions. J. Math. Anal. Appl. 41,
300–312 (1973)
18. Borell, C.: Complements of Lyapunov’s inequality. Math. Ann. 205, 323–331 (1973)
19. Borell, C.: Convex measures on locally convex spaces. Ark. Mat. 12, 239–252 (1974)
20. Borell, C.: The Brunn-Minkowski inequality in Gauss space. Invent. Math. 30(2), 207–216
(1975)
21. Bourgain, J.: On high-dimensional maximal functions associated to convex bodies. Am. J.
Math. 108(6), 1467–1476 (1986)
22. Bourgain, J.: Geometry of Banach spaces and harmonic analysis. In: Proceedings of the
International Congress of Mathematicians (ICM Berkeley 1986), pp. 871–878. Amer. Math.
Soc. (1987)

The Slicing Problem by Bourgain
229
23. Bourgain, J.: On the distribution of polynomials on high-dimensional convex sets. Geometric
Aspects of Functional Analysis. Israel Seminar (1989–90). Lecture Notes in Math., vol. 1469,
pp. 127–137. Springer (1991)
24. Bourgain, J.: On the isotropy-constant problem for “Psi-2” bodies. Geom. Aspects of Funct.
Anal. Israel Seminar (2001–02). Lecture Notes in Math., vol. 1807, pp. 114–121. Springer
(2002)
25. Bourgain, J., Milman, V.D.: New volume ratio properties for convex symmetric bodies in Rn.
Invent. Math. 88(2), 319–340 (1987)
26. Bourgain, J., Klartag, B., Milman V.: A reduction of the slicing problem to ﬁnite volume ratio
bodies. C. R. Acad. Sci. Paris Ser. I 336, 331–334 (2003)
27. Bourgain, J., Klartag, B., Milman V.: Symmetrization and isotropic constants of convex bodies.
Geom. aspects of Funct. Anal. Israel Seminar. Springer Lecture Notes in Math., vol. 1850,
pp. 101–116. Springer (2004)
28. Brehm, U., Voigt, J.: Asymptotics of cross sections for convex bodies. Beiträge Algebra Geom.
41(2), 437–454 (2000)
29. Busemann, H.: A theorem on convex bodies of the Brunn-Minkowski type. Proc. Natl. Acad.
Sci. USA 35, 27–31 (1949)
30. Busemann, H., Petty, C.M.: Problems on convex bodies. Mathematica Scandinavica 4(1), 88–
94 (1956)
31. Diaconis, P., Freedman, D.: Asymptotics of graphical projection pursuit. Ann. Stat. 12(3), 793–
815 (1984)
32. Eldan, R.: Thin shell implies spectral gap up to polylog via a stochastic localization scheme.
Geom. Funct. Anal. (GAFA) 23(2), 532–569 (2013)
33. Eldan, R., Klartag, B.: Pointwise estimates for marginals of convex bodies. J. Funct. Anal.
254(8), 2275–2293 (2008)
34. Eldan, R., Klartag, B.: Approximately Gaussian marginals and the hyperplane conjecture.
Concentration, Functional Inequalities and Isoperimetry. Contemp. Math., vol. 545, pp. 55–
68. Amer. Math. Soc. (2011)
35. Fernique, X: Régularité de processus gaussiens. Invent. Math. 12, 304–320 (1971)
36. Figiel, T., Tomczak-Jaegermann, N.: Projections onto Hilbertian subspaces of Banach spaces.
Isr. J. Math. 53, 155–171 (1979)
37. Fleury, B.: Concentration in a thin euclidean shell for log-concave measures. J. Funct. Anal.
259, 832–841 (2010)
38. Fradelizi, M.: Hyperplane sections of convex bodies in isotropic position. Beiträge Algebra
Geom. 40(1), 163–183 (1999)
39. Gardner, R.J.: Geometric tomography. Second edition. Encyclopedia of Mathematics and its
Applications, vol. 58. Cambridge University Press, New York (2006)
40. Giannopoulos, A., Pajor, A., Paouris, G.: A note on subgaussian estimates for linear functionals
on convex bodies. Proc. Am. Math. Soc. 135(8), 2599–2606 (2007)
41. Giannopoulos, A., Paouris, G., Valettas, P.: On the existence of subgaussian directions for log-
concave measures. Concentration, Functional Inequalities and Isoperimetry. Contemp. Math.,
vol. 545, pp. 103–122. Amer. Math. Soc. (2011)
42. Giannopoulos, A., Paouris, G., Vritsiou, B.-H.: The isotropic position and the reverse Santaló
inequality. Isr. J. Math. 203(1), 1–22 (2014)
43. Gromov, M., Milman, V.D.: Brunn theorem and a concentration of volume phenomena for
symmetric convex bodies. Israel Seminar on Geometrical Aspects of Functional Analysis
(1983/84), 12 p. Tel Aviv Univ., Tel Aviv (1984)
44. Guédon, O., Milman, E.: Interpolating thin-shell and sharp large-deviation estimates for
isotropic log-concave measures. Geom. Funct. Anal. (GAFA) 21(5), 1043–1068 (2011)
45. Hensley, D.: Slicing convex bodies—bounds for slice area in terms of the body’s covariance.
Proc. Am. Math. Soc. 79(4), 619–625 (1980)
46. Junge, M.: Hyperplane conjecture for quotient spaces of Lp. Forum Math. 6(5), 617–635
(1994)

230
B. Klartag and V. Milman
47. Junge, M.: Proportional subspaces of spaces with unconditional basis have good volume
properties. Geometric Aspects of Functional Analysis (Israel, 1992–1994). Oper. Theory Adv.
Appl., vol. 77, pp. 121–129. Birkhäuser (1995)
48. Kannan, R., Lovász, L., Simonovits M.: Isoperimetric problems for convex bodies and a
localization lemma. J. Discr. Comput. Geom. 13, 541–559 (1995)
49. Kashin, B.S.: The widths of certain ﬁnite-dimensional sets and classes of smooth functions.
Izv. Akad. Nauk SSSR Ser. Mat. 41(2), 334–351 (1977). English translation: Math. USSR-Izv.
11(2), 317–333 (1978)
50. Klartag, B.: An isomorphic version of the slicing problem. J. Funct. Anal. 218(2), 372–394
(2005)
51. Klartag, B.: On convex perturbations with a bounded isotropic constant. Geom. and Funct.
Anal. (GAFA) 16(6), 1274–1290 (2006)
52. Klartag, B.: Uniform almost sub-gaussian estimates for linear functionals on convex sets.
Algebra Anal. (St. Petersburg Math. J.) 19(1), 109–148 (2007)
53. Klartag, B.: A central limit theorem for convex sets. Invent. Math. 168, 91–131 (2007)
54. Klartag, B.: Power-law estimates for the central limit theorem for convex sets. J. Funct. Anal.
245, 284–310 (2007)
55. Klartag, B.: High-dimensional distributions with convexity properties. Proc. of the Fifth Euro.
Congress of Math., Amsterdam, July 2008, pp. 401–417. Eur. Math. Soc. Publishing House
(2010)
56. Klartag, B.: Isotropic constants and Mahler volumes. Adv. Math. 330, 74–108 (2018)
57. Klartag, B., Koldobsky, A.: An example related to the slicing inequality for general measures.
J. Funct. Anal. 274(7), 2089–2112 (2018)
58. Klartag, B., Lehec, J.: Bourgain’s slicing problem and KLS isoperimetry up to polylog.
Preprint, arXiv:2203.15551
59. Klartag, B., Kozma, G.: On the hyperplane conjecture for random convex sets. Isr. J. Math.
170, 253–268 (2009)
60. Klartag, B., Milman, V.D.: Isomorphic Steiner symmetrization. Invent. Math. 153(3), 463–485
(2003)
61. Klartag, B., Milman, V.: Rapid Steiner symmetrization of most of a convex body and the slicing
problem. Combin. Probab. Comput. 14(5–6), 829–843 (2005)
62. Klartag, B., Milman, V.: Geometry of log-concave functions and measures. Geom. Dedicata
112, 169–182 (2005)
63. Klartag, B., Milman, E.: Centroid bodies and the logarithmic Laplace transform – a uniﬁed
approach. J. Funct. Anal. 262(1), 10–34 (2012)
64. Koldobsky, A.: Fourier analysis in convex geometry. Mathematical Surveys and Monographs,
vol. 116. American Mathematical Society, Providence, RI (2005)
65. König, H., Meyer, M., Pajor, A.: The isotropy constants of the Schatten classes are bounded.
Math. Ann. 312, 773–783 (1998)
66. Kuperberg, G.: From the Mahler conjecture to Gauss linking integrals. Geom. Funct. Anal.
(GAFA) 18(3), 870–892 (2008)
67. Lee, Y.T., Vempala, S.: Eldan’s stochastic localization and the KLS hyperplane conjecture:
an improved lower bound for expansion. Symposium on Foundations of Computer Science
(FOCS), pp. 998–1007. IEEE Computer Soc. (2017)
68. Lee, Y.T., Vempala, S.: The Kannan-Lovász-Simonovits conjecture. Current Developments in
Mathematics 2017, pp. 1–36. Int. Press (2019)
69. Lewis, D.R.: Ellipsoids deﬁned by Banach ideal norms. Mathematica 26, 18–29 (1979)
70. Litvak, A.E., Milman, V.D., Schechtman, G.: Averages of norms and quasi-norms. Math. Ann.
312(1), 95–124 (1998)
71. Loomis, L.H., Whitney, H.: An inequality related to the isoperimetric inequality. Bull. Am.
Math. Soc. 55, 961–962 (1949)
72. Lutwak, E., Zhang, G.: Blaschke-Santaló inequalities. J. Differ. Geom. 47(1), 1–16 (1997)
73. Magazinov, A.: A proof of a conjecture by Haviv, Lyubashevsky and Regev on the second
moment of a lattice Voronoi cell. Adv. Geom. 20(1), 117–120 (2020)

The Slicing Problem by Bourgain
231
74. Mahler, K.: Ein Übertragungsprinzip für konvexe körper. ˇCasopis Pest Mat. Fys. 68, 93–102
(1939)
75. Meyer, M.: Convex bodies with minimal volume product in R2. Monatsh. Math. 112(4), 297–
301 (1991)
76. Meyer, M., Pajor, A.: On Santaló’s inequality. Geometric Aspects of Functional Analysis
(1987–88). Lecture Notes in Math., vol. 1376, pp. 261–263. Springer (1989)
77. Meyer, M., Pajor, A.: On the Blaschke-Santaló inequality. Arch. Math. 55(1), 82–93 (1990)
78. Milman, E.: Dual mixed volumes and the slicing problem. Adv. Math. 207, 566–598 (2006)
79. Milman, V.D.: Inégalité de Brunn-Minkowski inverse et applications á la théorie locale des
espaces normés. [An inverse form of the Brunn-Minkowski inequality, with applications to the
local theory of normed spaces] C. R. Acad. Sci. Paris Sér. I Math. 302(1), 25–28 (1986)
80. Milman, V.D.: Isomorphic symmetrization and geometric inequalities.
Geometric Aspects
of Functional Analysis (1986/87). Lecture Notes in Math., vol. 1317, pp. 107–131. Springer
(1988)
81. Milman, V.D.: Dvoretzky’s theorem—thirty years later. Geom. Funct. Anal. 2(4), 455–479
(1992)
82. Milman, V.D., Schechtman, G.: Asymptotic theory of ﬁnite-dimensional normed spaces. With
an appendix by M. Gromov. Lecture Notes in Mathematics, vol. 1200. Springer (1986)
83. Milman, V.D., Pajor, A.: Isotropic position and inertia ellipsoids and zonoids of the unit ball of
a normed n-dimensional space. Geometric Aspects of Functional Analysis (1987–88). Lecture
Notes in Math., vol. 1376, pp. 64–104. Springer (1989)
84. Milman, V.D., Pajor, A.: Entropy and asymptotic geometry of non-symmetric convex bodies.
Adv. Math. 152(2), 314–335 (2000)
85. Nazarov, F.: The Hörmander proof of the Bourgain-Milman theorem. Geometric Aspects of
Functional Analysis. Lecture Notes in Math., vol. 2050, pp. 335–343. Springer (2012)
86. Rogers, C.A., Shephard, G.C.: The difference body of a convex body. Arch. Math. 8, 220–233
(1957)
87. Paouris, G.: ψ2-estimates for linear functionals on zonoids. Geometric Aspects of Functional
Analysis. Lecture Notes in Math., vol. 1807, 211–222. Springer, Berlin (2003)
88. Paouris, G.: On the #2 behavior of linear functionals on isotropic convex bodies. Studia Math.
168(3), 285–299 (2005)
89. Paouris, G.: Concentration of mass on convex bodies. Geom. Funct. Anal. (GAFA) 16(5),
1021–1049 (2006)
90. Pisier, G.: Holomorphic semigroups and the geometry of Banach spaces. Ann. Math. 115(2),
375–392 (1982)
91. Pisier, G.: The volume of convex bodies and Banach space geometry. Cambridge Tracts in
Mathematics, Vol. 94. Cambridge University Press, Cambridge (1989)
92. Rademacher, L.: A simplicial polytope that maximizes the isotropic constant must be a simplex.
Mathematika 62(1), 307–320 (2016)
93. Sudakov, V.N.: Typical distributions of linear functionals in ﬁnite-dimensional spaces of high-
dimension. (Russian) Dokl. Akad. Nauk. SSSR 243(6), 1402–1405 (1978). English translation
in Soviet Math. Dokl. 19, 1578–1582 (1978)
94. Szarek, S.J.: On Kashin’s almost Euclidean orthogonal decomposition of ℓ1
n. Bull. Acad. Polon.
Sci. Sér. Sci. Math. Astronom. Phys. 26(8), 691–694 (1978)
95. Szarek, S., Tomczak-Jaegermann, N.: On nearly Euclidean decomposition for some classes of
Banach spaces. Compositio Math. 40(3), 367–385 (1980)
96. Talagrand, M.: The generic chaining. Upper and Lower Bounds of Stochastic Processes.
Springer (2005)
97. Talagrand, M.: Upper and lower bounds for stochastic processes. Modern Methods and
Classical Problems. Springer (2014)
98. von Weizsäcker, H.: Sudakov’s typical marginals, random linear functionals and a conditional
central limit theorem. Probab. Theory Relat. Fields 107(3), 313–324 (1997)

On the Work of Jean Bourgain in
Nonlinear Dispersive Equations
Carlos E. Kenig
Dedicated to the memory of Jean Bourgain
Abstract In this brief note, we survey a sample of the deep and inﬂuential contribu-
tions of Jean Bourgain to the ﬁeld of nonlinear dispersive equations. Bourgain also
made many fundamental contributions to other areas of partial differential equations
and mathematical physics (as well as to a myriad of other areas in analysis, number
theory, combinatorics, theoretical computer science, and more). Quoting the citation
of the American Mathematical Society L. P. Steele Prize for Lifetime Achievement
awarded to Bourgain in 2018, “Jean Bourgain is a giant in the ﬁeld of mathematical
analysis, which he has applied broadly and to great effect.”
Jean Bourgain’s contributions to mathematics will be remembered forever. Those
of us who knew him will also remember his warmth, generosity, and graciousness.
1
Introduction
In this brief note, we survey a sample of the deep and inﬂuential contributions of
Jean Bourgain to the ﬁeld of nonlinear dispersive equations. Bourgain also made
many fundamental contributions to other areas of partial differential equations and
mathematical physics (as well as to a myriad other areas in analysis, number theory,
combinatorics, theoretical computer science, and more). Quoting the citation of the
AMS L. P. Steele Prize for Lifetime Achievement, awarded to Bourgain in 2018,
“Jean Bourgain is a giant in the ﬁeld of mathematical analysis, which he has applied
broadly and to great effect.”
Partially supported by NSF grant DMS-1800082. Reprinted with permission from the AMS.
C. E. Kenig ()
University of Chicago, Chicago, IL, USA
e-mail: cek@math.uchicago.math.edu
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
A. Avila et al. (eds.), Analysis at Large, https://doi.org/10.1007/978-3-031-05331-3_10
233

234
C. E. Kenig
Jean Bourgain’s contributions to mathematics will be remembered forever. Those
of us who knew him will also remember his warmth, generosity, and graciousness.
2
Nonlinear Dispersive Equations: The Well-Posedness
Theory Before Bourgain
The theory of nonlinear dispersive equation goes back to the nineteenth century, in
connection with water waves in shallow water. The Korteweg-de Vries equation,
which governs this phenomenon, was proposed by Boussinesq and by Korteweg-de
Vries, in the late nineteenth century, as a way of explaining the discovery by Scott
Russell (1835) of traveling waves. The generalized KdV equations (gKdV)k (k = 1
being the Korteweg-de Vries equation) are
(gKdV )k

∂tu + ∂3
xu + uk∂xu = 0, x ∈R, or x ∈T, t ∈R
u|t=0 = u0(x)
(here, T and Td are the 1-dimensional ( d-dimensional) torus). Another example of
nonlinear dispersive equations is the nonlinear Schrödinger equations (NLS),
(NLS)

i∂tu + u ± |u|p−1u = 0, x ∈Rd, or x ∈Td
u|t=0 = u0(x)
When d = 1, p = 3, these equations model the propagation of wave packets in
the theory of water waves. The equations also appear in non-linear optics and in
quantum ﬁeld theory. These equations have a Hamiltonian structure and preserve
mass and energy (although the energy maybe negative). For both equations, the
conserved mass is

|u0|2, where the integral is over Rd or Td. For (gKdV)k, the
conserved energy is E(u0) =

[(∂xu0)2 −ckuk+1
0
]dx, and for (NLS), it is E(u0) =

[(∇xu0)2 ∓cp|u0|p+1]dx, where the integrals are over Rd or Td.
These equations are called dispersive because their linear parts are dispersive.
Heuristically, the linear equations, when deﬁned for x ∈Rd, are called dispersive,
because the initial data gets “spread out” or “dispersed” by the evolution. (The linear
equations can be solved by using Fourier’s method). Since the mass of the solution
is constant (the L2 norm is conserved), this requires the size of the linear solution to
become small for large t, the so called “dispersive effect.” Note that this is a feature
of linear dispersive equations, the traveling wave solutions discovered by Russell
do not have this property, and they are purely nonlinear objects. Moreover, when
x ∈Td, there is no room for the solution to “spread out,” and the “dispersive effect”
disappears.
Even though these equations were introduced in the nineteenth century/early
twentieth century, their systematic study started much later. One of the ﬁrst things

On the Work of Jean Bourgain in Nonlinear Dispersive Equations
235
to understand for such equations is the “well-posedness.” An equation like (gKdV)k
or (NLS) is said to be locally well-posed (LWP) in a space B (with u0 ∈B),
if the equation has a unique solution u (in a suitable sense) for u0 ∈B, for
some T
= T (u0), 0 ≤t ≤T , u ∈C([0, T ]; B), and the mapping u0 ∈
B →u ∈C([0, T ]; B) is continuous. (That is to say, in analogy with ODE,
we have existence, uniqueness, and continuous dependence on the initial data). If
we can take T = +∞, we say that the problem is globally well-posed (GWP).
Since dispersive equations are (essentially) time reversible, we can replace [0, T ]
by [−T, T ]. Usually in this subject, the space B is taken to be an L2−based
Sobolev space, (or sometimes a weighted L2−based Sobolev space, with power
weights, in case we are working in Rd). The reason for using L2-based spaces as
opposed to Lp-based spaces is the failure of estimates for u0 ∈Lp, p ̸= 2, in
the associated linear problems. The ﬁrst (LWP) results used the analogy of these
problems to classical hyperbolic ones, which led (by the classical energy method
and its reﬁnements and compactness arguments [5, 6])to the (LWP) of (gKdV)k in
H s(R), for s > 3
2, for k = 1, 2, . . . , with the same result holding in H s(T), and
to the (LWP) of (NLS) in H s(Rd), for s >
d
2, with the same result holding in
H s(Td). (In the case of (NLS), some restrictions on p arise also, coming from the
possible lack of “smoothness” of α →|α|p−1α). Here, for f deﬁned on Rd, we
set 	
f (ξ) =

Rd e2πix·ξf (x)dx, H s(Rd) = {f :

(1 + |ξ|2)s| 	
f (ξ)|2dξ < ∞}
and for f deﬁned on Td, we set 	
f (n) =

Td e2πix·nf (x)dx, n ∈Zd, and
H s(Td) = {f : 
n∈Zd | 	
f (n)|2(1 + |n|2)s < ∞}. An inspection of these proofs
shows that “dispersive properties” of (∂t + ∂3
x) or of (i∂t + ) are not used at all
in the case of Rd, and hence they remain valid for the case of Td. Particular cases
of (gKdV)k and (NLS) are closely connected to complete integrability, a theory
which was ﬁrst developed largely in this regard [1]. These are the cases k = 1, 2
in (gKdV)k and p = 3, d = 1 in (NLS). The applicability of this method initially
required high order of differentiability of the data u0, and, in the case x ∈R, fast
decay of u0. More recently, this has been greatly improved (see [41, 42, 53]) but still
only applies to a few speciﬁc cases.
In the late 1970s and early 1980s, the pioneering works of Ginibre-Velo [32–34],
and Kato [45], through the use of important new advances in harmonic analysis
[83, 86], led to “low regularity” (LWP) and (GWP) results for (NLS) in Rd,
culminating with the deﬁnitive results of Tsutsumi [85]and Cazenave-Weissler [22].
This approach exploited the “dispersive properties” of (i∂t + ) and the connection
with the “restriction problem” for the Fourier transform (discovered and formulated
in the visionary work of E.M. Stein (see [81]) uncovered by Segal [78] and Strichartz
[83]).
More precisely, the solution of the initial value problem
(LS)

i∂tu + u = 0, x ∈Rd, t ∈R
u|t=0 = u0(x)

236
C. E. Kenig
is given by 	u(ξ, t) = eit|ξ|2	u0(ξ) = (eitu0)ˆ(ξ) or, u(x, t) =
cd
|t|
d
2

Rn ei|x−y|2/4t
u0(y)dy.
The second formula gives that, for u solving (LS),
|u(x, t)| ≤cd
|t|
d
2
∥u0∥L1,
(1)
which clearly shows the “dispersive effect” mentioned earlier. The relevant “restric-
tion problem” here is the one to the paraboloid = {(ξ, |ξ|2) : ξ ∈Rd} ⊂Rd+1. In
this case, we have the “restriction” inequality (for f ∈S (Rd+1))
 
| 	
f (ξ, |ξ|2)|2dξ
 1
2 ≲∥f ∥
L
2(d+2)
d+4 (Rd+1)
(2)
(see [83, 86]). The connection with (LS) is that the dual inequality to (2) is the
“extension inequality,” which gives, from the ﬁrst formula for the solution u of (LS),
the estimate
∥u∥
L
2(d+2)
d
(Rd+1) ≲∥u0∥L2(Rd).
(3)
Now, to solve (NLS), one needs to solve (by Duhamel’s principle) the equation (with
the notation eitu0 = S(t)u0))
u(t) = S(t)u0 ±

 t
0
S(t −t′)|u|p−1u(t′)dt′.
(4)
This is solved by using the contraction mapping principle on spaces constructed
exploiting the estimate (2) and related ones [32–34, 45].
The result of Cazenave-Weissler [22] is
Theorem 2.1 Assume that u0 ∈H s(Rd), s ≥0, s ≥s0, where p −1 =
4
d−2s0 .
Assume also that p −1 > [s] + 1 if p −1 /∈2Z⋆, where [s] is the greatest integer
smaller than s. Then (NLS) is locally well-posed for t ∈[−T, T ]. In the subcritical
case s > s0, we can take T = T (∥u0∥H s), in the critical case s = s0, T = T (u0).
This approach, relying on the estimates (1) and (3), uses crucially the “dispersive
properties”’ of (i∂t + ) in Rd, and hence it does not apply to Td. On the other
hand, on Rd it yields essentially optimal results in terms of the values of s when
B = H s(Rd), which greatly improve the results obtained by the energy method
described earlier.
There are several motivations for hoping to have “low regularity” well-posedness
results for (gKdV)k and (NLS). The ﬁrst one is that, if one can obtain (LWP) at
the regularity level given by the conserved mass, or the conserved energy, with
time of existence T = T (∥u0∥)L2, or T = T (∥u0∥H 1), one can use the a priori
control given by the conserved quantity, to obtain global well-posedness, simply

On the Work of Jean Bourgain in Nonlinear Dispersive Equations
237
iterating the local result. Another one is the belief that, since for the associated
linear problem we have well-posedness in H s, for any s, the threshold s for the non-
linear problem gives information on the nonlinear effects present in the problem.
We will see later another motivation, at very low regularity levels, stemming from
the connection with quantum ﬁeld theory and giving global well-posedness for
“generic” data. Turning to the “low regularity” local well-posedness theory for
(gKdV)k, the new difﬁculty is the fact that the nonlinear term contains a derivative,
which needs to be “recovered.” One might think that the fact that (∂t + ∂3
x) has a
“stronger dispersive effect” (we have for instance the bound |u(x, t)| ≲
1
t1/3 ∥u0∥L1
for the linear solution, which is stronger for small t than the
1
t1/2 we get for (LS),
d = 1) would compensate for the derivative in the nonlinearity, but this is not
obviously the case. Kato [43, 44] found a “local smoothing” effect for solutions
of (gKdV)k which allowed, when x ∈R, to control “a priori,” with u0 ∈L2(R)
quantities like
 j+1
j
 1
0

∂xu(x, t)
2
dxdt, j ∈Z, uniformly in j, but this only gave
rise to “weak solutions” with L2 data, but did not give uniqueness or continuous
dependence on the data. This was also restricted to x ∈R, since such an estimate
in T would contradict time reversibility and conservation of mass. In the 1980s
and early 1990s, in a joint project with G. Ponce and L. Vega, we developed a
new approach to the “low regularity” local and global well-posedness theory (for
x ∈R) for (gKdV)k, which in the case k ≥4 gave essentially optimal (in some
sense) results [4, 51]. This was also based on the contraction mapping theorem
and used tools from harmonic analysis. In addition to the analogs of the “extension
inequality” (3), (with (ξ, |ξ|2) being replaced by (ξ, ξ3)), we used a sharp form (for
linear equations) of the Kato“local smoothing” estimate, introduced in [30, 82, 87],
as well as an analog of the “maximal function” estimate introduced in [21] and
motivated by statistical mechanics (see also [31, 87]). The combination of these
two estimates allowed us to control well the nonlinear term uk∂xu. In addition, we
also applied the multilinear harmonic analysis tools developed by Coifman-Meyer
[23, 24]. This was all completely tied to dispersion and was totally dependent or the
fact that x ∈R. A sample result obtained, for KdV (k = 1), was
Theorem 2.2 ([49]) Let s >
3
4, u0 ∈H s(R). Then, ∃T = T (∥u0∥H s), and a
space Xs
T ⊂C([−T, T ]; H s), such that KdV has a unique solution u ∈Xs
T , which
depends continuously on u0.
The space Xs
T is constructed by using the estimates mentioned earlier, namely the
sharp “local smoothing” estimate, the “maximal function” estimate, and the variants
of the “extension estimate.” One then proves the result by the contraction mapping
principle in the space Xs
T , T = T (∥u0∥H s), showing that the mapping u0(u) =
W(t)u0 +
 t
0 W(t −t′)(u∂xu)(t′)dt′ has a ﬁxed point in Xs
T , where 
W(t)f (ξ) =
eitξ3 	
f (ξ).

238
C. E. Kenig
Remark 1 The approach was, in a certain sense, sharp: if we have a space Xs
T such
that ∀u0 ∈H s(R), the linear solution W(t)u0 belongs to Xs
T and such that, for all
v, w ∈Xs
T , we have v∂xw ∈L1
loc(R) and then s ≥3
4.
At this point, we had no idea on how to improve the results for k = 1, 3 (the k = 2
result in [49] was also “optimal,” as was shown in [51]), or how to do anything other
than the s > 3
2 result given by the energy method in the case x ∈T.
3
Bourgain’s Transformative Work on the Well-Posedness
Theory of Dispersive Equations
In the spring of 1990, I gave a lecture on the work (then in progress) in [49], and E.
Speer was in the audience. He asked me the following question: consider the quintic
(NLS) on T:

i∂tu + u ± |u|4u = 0, x ∈T, t ∈R
u|t=0 = u0(x) ∈H s(T).
(5)
Is this problem well-posed for s < 1
2?
I knew that the energy method gave s > 1
2, that complete integrability did not
apply, and that the methods we developed with Ponce and Vega, which relied on
dispersion, did not apply. Speer explained the reason for the question, which was in
connection with the work [56] of Lebowitz, Rose, and Speer, in which they had
constructed a Gibbs measure associated to the problem (5). The points that the
authors of [56] were concerned with were that the measure they constructed used
the periodic setting crucially and that the support of the measure was contained in
very low regularity spaces. So, they wanted to have a ﬂow for (5), in the support of
the Gibbs measure, which kept the Gibbs measure invariant. If so, a by-product
of all this would be that, for data in the support of the measure, local in time
existence could be globalized in time, similarly to the arguments in the presence
of conserved quantities that we saw before. I told Speer that I felt that the question
was very hard and that I thought that the person who could make progress in it, and
would probably be interested in the problem, was Jean Bourgain! Bourgain did get
interested and resolved completely the Lebowitz-Rose-Speer questions [7, 8, 10].
In doing so, he transformed the theory of nonlinear dispersive equations, starting
with his papers [7–9]. Moreover, he continued making fundamental contributions to
all aspects of this theory and transformed not only the well-posedness theory and
created the probabilistic theory suggested by [10, 11], and [56] but also many other
central areas in the ﬁeld. Let me now turn to Bourgain’s papers [7, 8], in which
he made his ﬁrst groundbreaking contributions to the well-posedness theory. These
works address the following two fundamental questions:

On the Work of Jean Bourgain in Nonlinear Dispersive Equations
239
1. How to prove low regularity well-posedness results for (NLS) and (gKdV)k, for
x ∈Td?
2. How to improve the well-posedness results on (KdV) on R?
It turns out that, in solving the ﬁrst question, Bourgain also found the path to
solving the second one. Also, once the ﬁrst question was solved, Bourgain turned to
the Gibbs measure questions from [56], in [10, 11], settling them and extending their
scope, as we shall see below. We thus turn to (NLS) on Td, and we will concentrate
on Bourgain’s results for d = 1, 2, which are the most relevant to our exposition.
Theorem 3.1 ([7])
(i) (NLS) is locally well-posed in H s(T), for s ≥0, p −1 <
4
1−2s . Thus, for
p −1 = 4, (NLS) is (LWP) in H s(T) for all s > 0.
(ii) (NLS) is locally well-posed in H s(T2), for p −1 = 2, s > 0.
Compared with corresponding results in R, R2, that we discussed earlier, one key
difﬁculty is the lack of a “dispersive effect.” Another difﬁculty is that, in the periodic
case, the Fourier transform, in the solution of the associated linear problem, is
replaced by Fourier series, leading to “exponential sums” that are much more
difﬁcult to estimate than integrals. For instance, the operator eitu0 = S(t)u0, now
takes the form
S(t)u0(x) =

n∈Zd
ei(xn+t|n|2)	u0(n).
The proof the Theorem 3.1 proceeds by using the contraction mapping principle.
The ﬁrst step is to ﬁnd estimates that replace the inequality (3), crucial in the case
of Rd, which is proved using oscillatory integral estimates. Bourgain achieved this
by using analytic number theory, and the results that he obtained in doing this have
independent interest in analytic number theory. As a sample, let me mention two
such estimates:
(a)
∥

n∈Z,|n|≤N
anei(nx+n2t)∥L6(T2) ≲Nε 
|an|2)
1
2 , ∀ε > 0,
which is used in Theorem 3.1(i).
and
(b)
∥

n∈Z2,|n1|≤N,|n2|≤N
anei(nx+|n|2t)∥L4(T3) ≲Nε 
n∈Z2
|an|2 1
2 , ∀ϵ > 0,
which is used in Theorem 3.1(ii).

240
C. E. Kenig
Their proof uses the argument of Tomas [86] in the proof of the “restriction
inequality,” combined with the “major arc” description of exponential sums (due to
Vinogradov) and number theoretic arguments inspired by Weyl type lemmas [88].
The second main contribution of Bourgain here is the introduction of new function
spaces in which to apply the contraction mapping principle.
For K, N positive integers, consider K,N = {ζ = (ξ, λ) ∈Zd ×R : N ≤|ξ| ≤
2N and K ≤|λ −|ξ|2| ≤2K}. For a function u in L2(Td × R), let
u(x, t) =

ξ∈Zd

	u(ζ)e2πi(ξx+tλ)dλ,
and deﬁne |||u|||s = supK,N(K + 1)
1
2 (N + 1)s 
K,N |	u(ζ)|2dζ
 1
2 .
Fixing an interval of t in [−δ, δ], one considers the restriction norm
|||u|||Xs = inf|||˜u|||s,
(6)
where the inﬁmum is taken over all ˜u coinciding with u in [−δ, δ] and shows that
the integral equation has a solution in Xs, for small δ, by (4), now on Td, using
the contraction mapping theorem. This applies to (i) and (ii) and uses crucially the
bounds (a) and (b).
It is difﬁcult to overestimate the impact of this work in the well-posedness theory.
It was simply a complete game changer. While versions of the spaces just described
were in the literature before, in earlier works of Rauch and Reed [76] and M.
Beals [3] dealing with propagation of singularities for solutions of semilinear wave
equations, and also implicit in the contemporary work of Klainerman-Machedon
[55] on the local well-posedness of semilinear wave equations, the ﬂexibility and
universality of Bourgain’s formulation of these spaces contributed decisively to their
wide applicability in solving a large number of previously intractable problems, in
the work of many researchers.
We now turn to the work in [8], on (gKdV )k, on T. We will restrict ourselves to
commenting on the results for k = 1.
Theorem 3.2 ([8]) (KdV) is locally well-posed on L2(T), with time of existence
depending on ∥u0∥L2, and hence by conservation of the L2 norm, it is globally
well-posed in L2(T).
The proof also proceeds by a contraction mapping argument, in spaces related to
the ones given by (6) but adapted to the linear operator ∂t + ∂3
x. A ﬁrst reduction is
to the case of data of integral 0, that is, whose zero Fourier coefﬁcient vanishes. The
space Xs now has norm
|||u|||s =
⎧
⎨
⎩

n∈Z,n̸=0
|n|2s

 +∞
−∞
(1 + |λ −n3|)|	u(n, λ)|2 dλ
⎫
⎬
⎭
1/2

On the Work of Jean Bourgain in Nonlinear Dispersive Equations
241
for u deﬁned for (x, t) ∈T2, with mean in x equal to 0. The relevant version of
(a), when s = 0, is now
(a’)
∥f ∥L4(T2) ≲
⎛
⎝
m,n∈Z
(1 + |n −m3|)2/3| ˆf (m, n)|2
⎞
⎠
1/2
.
A very important difference with (NLS) is the fact that there is a derivative in
the non-linearity, and no linear local smoothing effect, as we mentioned earlier.
Bourgain’s crucial insight here was that there is a nonlinear smoothing effect, best
captured by the function spaces introduced above. This is given in the following
estimates: let w(x, t) = ∂x(u2)(x, t), where we assume that

T u(x, t) dx = 0.
Then, for s ≥0,
⎛
⎝
n̸=0
|n|2s

|	w(n, λ)|2
(1 + |λ −n3|) dλ
⎞
⎠
1/2
≲|||u|||Xs,
⎛
⎝
n̸=0
|n|2s

|	w(n, λ)|
(1 + |λ −n3|) dλ
2
⎞
⎠
1/2
≲|||u|||Xs,
It is through these estimates, controlling ∂x(u2) by u, that we see this nonlinear
smoothing effect, which is a consequence of the “curvature” of (n, n3).
Finally, also in [8], Bourgain observed that this nonlinear smoothing effect also
carries over to the case x ∈R, using the function spaces
Xs
b =
!
u(x, t) :


(1 + |λ −ξ3|)2b · |1 + |ξ||2s|	u(ξ, λ)|2 dξ dλ < ∞, where (ξ, λ) ∈R2
=
.
He proved:
Theorem 3.3 ([8]) (KdV) is globally well-posed in L2(R).
Remark 2 By using a nonlinear smoothing effect, and thus replacing v∂xw in
Remark 1 by ∂x(u2), Bourgain bypassed the objection for improving s > 3
4, given in
Remark 1. To Ponce, Vega, and myself, this was a shocking observation. Of course,
this was just one of the many shocking observations made by Bourgain over the
years! These works of Bourgain have been and continue to be remarkably inﬂuential.
Remark 3 Theorem 3.2 and Theorem 3.3 generated substantial interest in the
question of ﬁnding the optimal s for (LWP) in each theorem. In [50], it was shown
that (LWP) for T holds for s > −1
2 and for R for s > −3
4, both by the contraction

242
C. E. Kenig
mapping principle. In [12], Bourgain observed that (LWP) cannot be proved by the
contraction mapping principle, for s < −1
2 on T and for s < −3
4 on R. In [40] and
[54], it was shown (independently) that (LWP) holds in H −1
2 (T) and H −3
4 (R), by
the contraction mapping principle, using a modiﬁcation of the spaces Xs
b introduced
by Bourgain. That a modiﬁcation of the spaces was needed was shown by Nakanishi,
Takaoka, and Tsutsumi [72]. Finally, (LWP) was shown in H −1(T) by Kappeler-
Topalov [42] and by Killip-Visan in H −1(R) [53], using inverse scattering. These
are the optimal spaces for (LWP) in the scale of Sobolev spaces, as was shown by
Molinet [69, 70].
4
A Quick Sampling of Some of the Other Groundbreaking
Contributions of Bourgain to Nonlinear Dispersive
Equations
4.1
Gibbs Measure Associated to Periodic (NLS)
We again consider the (NLS) equation

i∂tu + u ± |u|p−1u = 0, p > 1, u : Td × R →C
u|t=0 = u0
and recall the two conserved quantities: the mass
M(u) =

Td |u|2 dx = M(u0)
and the Hamiltonian (the energy)
H(u) = 1
2

Td |∇u|2 dx ±
1
p + 1

Td |u|p+1 dx = H(u0).
If we set ˆu(n, t) = an(t) + ibn(t), we see that u solves (NLS) if and only if
˙an(t) = ∂H
∂bn and ˙bn(t) = −∂H
∂an , n ∈Zd. Thus, (NLS) can be viewed as an inﬁnite-
dimensional Hamiltonian system. If the Hamiltonian system is ﬁnite-dimensional,
say we consider |n| ≤N, then the Gibbs measure dμ, given by
dμ =
1
ZN
e−H(an,bn) 
|n|≤N
dan dbn,
where ZN is a normalization constant, is well-deﬁned and invariant with respect to
the ﬂow. In the paper [56], Lebowitz-Rose-Speer were able to make sense of the

On the Work of Jean Bourgain in Nonlinear Dispersive Equations
243
Gibbs measure associated to (NLS) in T, with p = 5. They considered the formal
expression
“dμ = 1
Z e−H(an,bn) 
n∈Z
dan dbn",
by introducing ﬁrst the Gaussian measure
dρ = 1
˜Z
e−
n(1+n2)(|an|2+|bn|2) 
n
dan dbn,
with support in H s(T), s < 1
2, and then proved that dμ is absolutely continuous
with respect to dρ. The questions they formulated were as follows:
1. Is (NLS) on T, with p = 5, on H s(T), 0 < s < 1
2, well-deﬁned for all times, at
least for data in the support of the measure?
2. Is dμ invariant with respect to the (NLS) ﬂow?
In the paper [10], Bourgain answered both questions in the positive. To treat both
issues, he used the (LWP) result in H s, 0 < s < 1
2, given in Theorem 3.1, and then
used the invariance of the measure under the ﬂow to establish global well-posedness
almost surely dμ.
Bourgain then treated in [11] a very challenging question along these lines: Can
one do this for the cubic (NLS) on T2, at least in the defocusing case, that is, for the
equation
i∂tu + u −|u|2u = 0, x ∈T2?
The existence of dμ in this case was due to Glimm-Jaffe [36], but suppμ ⊂H s(T2),
s < 0, while Theorem 3.1 gives (LWP) in H s(T2), s > 0.
Bourgain overcame this difﬁculty through another shocking breakthrough. He
considered the following random data:
uω
0 =

n∈Z2
gn(ω)
(1 + |n|2)
1
2
einx,
where the {gn} are identically distributed complex Gaussian random variables. Since
uω
0 ∈H s(T2), s < 0, uω
0 belongs to the support of the Gibbs measure μ. (We are
going to ignore here the need for “Wick-ordering” the (NLS) equation here; see
[11]). The key observation is that if u is the (NLS) solution, w(t) = u(t) −S(t)uω
0
is (almost surely in ω) well-deﬁned in H ¯s(T2), where ¯s > 0, and one can then
solve for w, to obtain a local in time solution. Finally, the local in time solution
is extended globally in time, using the invariance of the Gibbs measure. This very
inﬂuential paper led to the notion of “probabilistic well-posedness” in dispersive

244
C. E. Kenig
equations in works of Burq-Tzvelkov [20], T. Oh [73], and many others, including
Bourgain-Bulut [17, 18].
4.2
Bourgain’s “High-Low Decomposition”
In Theorem 2.1, the local in time result can be extended to a global in time one, in
case the H s norm of the data is small, s ≥s0. In the mass (L2) subcritical case,
when p −1 < 4/d, that is when s0 < 0, the problem is locally well-posed in L2
and hence globally well-posed in L2. When p −1 ≥4/d, in the focusing case,
that is when the sign in front of the nonlinearity in (NLS) is negative, and hence
the Hamiltonian does not have a deﬁnite sign, sufﬁciently large smooth solution
may blow-up in ﬁnite time (see Glassey [35], Merle [58, 59], Bourgain-Wang [19],
Merle-Raphaël [60–64], Raphaël [74, 75], Merle-Raphaël-Rodnianski [65], etc.).
Also, if the nonlinearity is “defocusing,” that is, the sign in front of the nonlinear
term in (NLS) is negative so that the conserved Hamiltonian
H(u) = 1
2

|∇u|2 +
1
p + 1

|u|p+1,
controls

|∇u|2, and if p −1 <
4
d−2 (that is s0 < 1) and hence the problem is
energy subcritical, (NLS) is globally well-posed in the energy sphere H 1(Rd), by
iterating the result in Theorem 2.1.
Bourgain [13] developed a very general method to, in such circumstances, obtain
global well-posedness below the energy norm. A sample result is
Theorem 4.1 ([13]) The problem

i∂tu + u −u|u|2 = 0
u|t=0 = u0 ∈H s(R2)
is globally well-posed for s > 3
5. Moreover, the solution u satisﬁes u(t) −S(t)u0 ∈
H 1(R2) for all t (with a polynomial control in |t| of the H 1 norm).
The general scheme of the method is as follows: ﬁrst, one has to have a conserved
quantity (say I(u0)), such that I(u0) controls a certain H s0 norm. Next, one needs a
local well-posedness result (LWP) in H s1, for s1 < s0, with the ﬂow map satisfying
I(u(t)−S(t)u0) ≤F(∥u0∥H s1 ), where S(t) is the associated linear evolution, acting
unitarily on all H s spaces. One then expects a global well-posedness result in H s2,
for some s1 < s2 < s0. In the theorem stated, I is the Hamiltonian. One then splits,
for some T large and ﬁxed, u0 = u(N0)
0,1 + u(N0)
0,2 , with u(N)
0,1 =

|ξ|≤N0 ˆu0(ξ)eix·ξ dξ,
where N0 = N0(T ) is to be chosen.

On the Work of Jean Bourgain in Nonlinear Dispersive Equations
245
It is simple to see that H(u(N0)
0,1 ) ≲N2(1−s)
0
. One then solves the nonlinear
problem with initial data u(N0)
0,1 , for all times. If we choose the time interval I =
[0, δ], where δ = N−2(1−s)−ϵ
0
,
∥u(N0)
0,1 ∥L4(Rd×I) = o(1).
If we let u = u(N0)
1
+v, where u(N0)
1
is the global solution just mentioned, v satisﬁes
the difference equation

i∂tv + v −2|u(N0)
1
|2v −(u(N0)
1
)2 ¯v −(u(N0)
1
)v2 −2u(N0)
1
|v|2 −|v|2v = 0
v|t=0 = u(N0)
0,2 ,
with ∥u(N0)
0,2 ∥L2 ≲N−s
0 ; ∥u(N0)
0,2 ∥H s ≤C. One then gets, after calculations, v =
S(t)(u(N0)
0,2 ) + w, where w(t) ∈H 1, ∥w(t)∥L2 ≲N−s
0
and ∥w(t)∥H 1 ≲N1−2s+ϵ
0
.
Then, ﬁxing t1 = δ, we obtain u(t1) = u1 + v1, where u1 = u(N0)
1
(t1) + w(t1),
v1 = S(t1)(u(N0)
0,2 ). Using the conservation of H, and the bounds for w, this yields
H(u1) ≤H(u0) + CN2−3s+ϵ
0
,
while v1 has the same properties as u(N0)
0,2 . Iterating the procedure, to reach time T ,
we need a number of steps:
T
δ ≃T · N2(1−s)+ϵ
0
.
Thus, we need to ensure that
T · N2(1−s)+ϵ
0
· N2−3s+ϵ
0
< H(u(N0)
0,1 ) ≈N2(1−s)
0
.
This can be achieved for s > 2
3. A more elaborate argument gives s > 3
5.
This method, as mentioned before, is very general and has led to many global
well-posedness results, due to many researchers, for instance, in energy subcritical,
defocusing problems. The method also stimulated the “I-team” (Colliander, Keel,
Stafﬁlani, Takaoka and Tao) to develop the “I-method” to treat similar types of
situations. The “I-method” has been extraordinarily successful (see, for instance,
[25–28], etc.).
Besides his interest in global well-posedness for defocusing, energy subcritical
(NLS), Bourgain was very interested in corresponding global in time results
for energy critical and supercritical (NLS). In the next section, we will discuss
Bourgain’s work in the energy critical case. Understanding the global in time,
energy supercritical case was a problem that Bourgain considered very natural and

246
C. E. Kenig
intriguing. In [16], Bourgain conjectured the global existence of classical solutions,
with smooth, well-localized data, for defocusing energy supercritical (NLS). For
years, this problem was considered out of reach. Recently, this conjecture was
disproved for d
≥5 in the spectacular series of papers by Merle, Raphaël,
Rodnianski, and Szeftel [66, 67], who also were able to obtain corresponding results
for the compressible Euler and Navier-Stokes ﬂows [68].
4.3
Bourgain’s Work on the Defocusing Energy Critical (NLS)
In the remarkable paper [14], Bourgain considered the defocusing, energy critical
(NLS)

i∂tu + u −|u|
4
d−2 u = 0, d ≥3
u|t=0 = u0 ∈H 1(Rd)
(7)
Theorem 4.2 (7) is globally well-posed for u0 radial, when d = 3, 4. Moreover,
higher regularity of u0 is preserved for all times.
Remark 4 The result was proved independently by Grillakis [39], when d = 3. It
was extended to all d ≥3, still under u0 radial, by Tao in 2005.
Remark 5 In addition to global well-posedness, Bourgain established scattering,
that is, to say, there exist u±
0 ∈H 1(Rd), radial such that
lim
t→±∞
33u(t) −S(t)(u±
0 )
33
H 1(Rd) = 0.
Remark 6 The corresponding result for the defocusing energy critical nonlinear
wave equation
⎧
⎪⎪⎨
⎪⎪⎩
∂2
t u −u + |u|
4
d−2 u = 0
u|t=0 = u0 ∈H 1(Rd)
∂tu|t=0 = u1 ∈L2(Rd)
was established by Struwe [84] in the radial case and by Grillakis [37, 38] in the non-
radial case (see also [79, 80]), with scattering being obtained in [2]. The key idea was
to use the Morawetz identity [71], which for the wave equation has energy critical
scaling, combined with ﬁnite speed of propagation (another important feature of the
wave equation) to prevent “energy concentration.”
For the proof of Theorem 4.2, when d = 3, the starting point is to show that if

On the Work of Jean Bourgain in Nonlinear Dispersive Equations
247

 T⋆
0

R3 |u(x, t)|10 dx dt < ∞,
(8)
where T⋆is the “ﬁnal time of existence” of u, then T⋆= ∞and u scatters. This fact
is now referred to as “the standard ﬁnite time blow-up” criterion. In order to achieve
(8), Bourgain’s idea was to do so by induction on the size of the Hamiltonian of u0
and show that
∥u∥L10
x L10
[0,T⋆] ≤M(H(u0)),
for some function M. It is easy to show, from the proof of the local well-posedness
result (since ∥u0∥H 1 ≲H(u0)), that this is the case if H(u0) is small. Arguing by
contradiction, one assumes that
∥u∥L10
x L10
[0,T⋆] > M,
for some M large and that ∥v∥L10
x L10
t
< M1, whenever

i∂tv + v −|v|4v = 0
v|t=0 = v0,
provided H(v0) < H(u0) −η4, for some small η (depending only on H(u0)), and
then one reaches a contradiction for large M.
In order to reach this contradiction, Bourgain introduced a modiﬁcation of
the Morawetz estimate for the Schrödinger equation, due to Lin-Strauss [57].
Comparing Theorem 4.2 with the earlier work on the wave equation, by Grillakis,
mentioned in Remark 6, key difﬁculties are the inﬁnite speed of propagation and the
unfavorable scaling of the estimate in [57]. This is addressed in
Proposition 1 Let u be a solution of (7) in the energy space on a time interval I on
which (7) is well-posed in the energy space. Then,

I

|x|<|I|1/2
|u(x, t)|6
|x|
dx dt ≤CH(u0)|I|1/2.
It is in the application of this Proposition (which allows one to handle energy
concentration) that the radial hypothesis is used. The details of the proof are
intricate. The “induction on energy” used in the proof is an audacious idea, which
has been extremely inﬂuential. In [29], the “I-team” (Colliander-Keel-Stafﬁlani-
Takaoka-Tao) in a major breakthrough extended the d = 3 result in Theorem 4.2
to the non-radial case. An important ingredient of their proof is the introduction
of an “interaction Morawetz” inequality, a version of Proposition 1, in which the
origin is not a privileged point. This was extended to d = 4 by Ryckman-Visan [77]

248
C. E. Kenig
and to d ≥5 by Visan [89]. Later on, a new method, dubbed the “concentration-
compactness/rigidity theorem method,” was introduced in [46–48], which is very
ﬂexible and which could also treat focusing problems, under sharp size conditions.
This method also led to many more developments in this type of problems, in the
works of many researchers. For a proof of Theorem 4.2, and its non-radial version
in [29], using this new method, see the work of Killip-Visan [52].
5
Conclusion
The work of Jean Bourgain transformed the ﬁeld of nonlinear dispersive equations
by settling old conjectures, introducing new methods and ideas, and posing impor-
tant problems. The works brieﬂy described in this note are just a small (hopefully
representative) sample of Bourgain’s inﬂuential contributions to this ﬁeld. They will
continue to inspire researchers for generations to come.
Acknowledgments I am very grateful to Gigliola Stafﬁlani, for sharing with me the slides of her
lecture at the meeting “Honoring the Life and Work of Jean Bourgain” held at IAS, Princeton
on May 31-June 01, 2019. In particular, the presentation in Section 4.1 follows very closely her
exposition.
References
1. Ablowitz, M.J., Clarkson, P.A.: Solitons, nonlinear evolution equations and inverse scattering.
London Mathematical Society Lecture Note Series, vol. 149. Cambridge University Press,
Cambridge (1991)
2. Bahouri, H., Shatah, J.: Decay estimates for the critical semilinear wave equation. Ann. inst.
H. Poincaré Anal. Non-Linéaire 15(6), 783–789 (1998)
3. Beals, M.: Self-spreading and strength of singularities for solution to semilinear wave equation.
Ann. Math. 118, 187–214 (1983)
4. Birnir, B., Kenig, C., Ponce, G., Svanstedt, N., Vega, L.: On the ill-posedness of the IVP for
the generalized Korteweg-de Vries and nonlinear Schrödinger equations. J. Lond. Math. Soc.
53, 551–559 (1996)
5. Bona, J.L., Scott, R.: Solutions of the Korteweg-de Vries equation in fractional order Sobolev
spaces. Duke Math. J. 43, 87–99 (1976)
6. Bona, J.L., Smith, R.: The initial value problem for the Korteweg-de Vries equation. Roy. Soc.
Lond. Ser. A 278, 555–601 (1978)
7. Bourgain, J.: Fourier transform restriction phenomena for certain lattice subsets and appli-
cations to nonlinear evolution equations. Part I: Schrödinger equations. Geom. Funct. Anal.
(GAFA) 3, 107–156 (1993)
8. Bourgain, J.: Fourier transform restriction phenomena for certain lattice subsets and applica-
tions to nonlinear evolution equations. Part II. The KdV equation. Geom. Funct. Anal. (GAFA)
3, 209–262 (1993)
9. Bourgain, J.: Exponential sums and nonlinear Schrödinger equations. Geom. Funct. Anal.
(GAFA), 157–178 (1993)

On the Work of Jean Bourgain in Nonlinear Dispersive Equations
249
10. Bourgain, J.: Periodic nonlinear Schródinger equations and invariant measures. Comm. Math.
Phys. 160, 1–26 (1994)
11. Bourgain, J.: Invariant measures for the 2D-defocusing nonlinear Schródinger equation.
Comm. Math. Phys. 176, 421–445 (1996)
12. Bourgain, J.: Periodic Korteweg-de Vries equation with measures as initial data. Selecta Math
3, 115–159 (1997)
13. Bourgain, J.: Reﬁnements of Strichartz inequality and applications to 2D-NLS with critical
nonlinearity. IMRN NS, 253–283 (1998)
14. Bourgain, J.: Global well-posedness of defocusing critical nonlinear Schrödinger equation in
the radial case. J. Am. Math. Soc. 12, 145–171 (1999)
15. Bourgain, J.: Global solutions of nonlinear Schrödinger equations. Am. Math. Soc. Colloq.
Publ., vol. 46. American Mathematical Society, Providence, RI (1999)
16. Bourgain, J.: Problems in Hamiltonian PDE’s, GAFA 2000 (Tel Aviv, 1999). Geom. Funct.
Anal. 2000, Special Volume, Part I, pp. 32–56
17. Bourgain, J., Bulut, A.: Almost sure global well-posedness for the radial nonlinear Schrödinger
equation on the unit ball I: the 2D case. Ann. Inst. H. Poincaré Anal. Non Linéaire 31, 1267–
1288 (2014)
18. Bourgain, J., Bulut, A.: Almost sure well-posedness for the radial nonlinear Schrödinger
equation on the unit ball II: the 3D case. J. Eur. Math. Soc. (JEMS) 16, 1289–1325 (2014)
19. Bourgain, J., Wang, W.: Construction of blow-up solutions for the nonlinear Schrödinger
equation with critical nonlinearity. Dedicated to Ennio de Giorgi. Ann. Scuole Norm. Sup.
Pisa Cl. Sc. 25, 197–215 (1997)
20. Burq, N., Tzvetkov, N.: Random data Cauchy theory for supercritical wave equations II. A
global existence result. Invent. Math. 173, 477–496 (2008)
21. Carleson, L.: Some analytical problems related to statistical mechanics. LNM 779, 5–45 (1979)
22. Cazenave, T., Weissler, F.: The Cauchy problem for the critical nonlinear Schrödinger equation
in H s. Nonlinear Anal. TMA 14, 807–836 (1990)
23. Coifman, R., Meyer, Y.: Au delà des operateurs pséudo-differentiels. Astérisque, vol. 57.
Société Mathématique de France, Paris (1978)
24. Coifman, R., Meyer, Y.: Nonlinear harmonic analysis, operator theory and PDE, Beijing
lectures in harmonic analysis. Ann. Math. Stud., vol. 112. Princeton Univ. Press, Princeton,
NJ (1986)
25. Colliander, J., Keel, M., Stafﬁlani, G., Takaoka, H., Tao, T.: A reﬁned global well-posedness
result for Schrödinger equations with derivative. SIAM J. Math. Anal. 34, 64–86 (2002)
26. Colliander, J., Keel, M., Stafﬁlani, G., Takaoka, H., Tao, T.: Sharp global well-posedness for
KdV and modiﬁed KdV on R and T. J. Am. Math. Soc. 16, 705–749 (2003)
27. Colliander, J., Keel, M., Stafﬁlani, G., Takaoka, H., Tao, T.: Global existence and scattering
for rough solutions of a nonlinear Schrödinger equation on R3. Comm. Pure Appl. Math. 57,
987–1014 (2004)
28. Colliander, J., Keel, M., Stafﬁlani, G., Takaoka, H., Tao, T.: Multilinear estimates for periodic
KdV equations, and applications. J. Funct. Anal. 211, 173–218 (2004)
29. Colliander, J., Keel, M., Stafﬁlani, G., Takaoka, H., Tao, T.: Global well-posedness and
scattering for the energy-critical nonlinear Schrödinger equation in R3. Ann. Math. 167, 767–
865 (2008)
30. Constantin, P., Saut, J.-C.: Local smoothing properties of dispersive equations. J. Am. Math.
Soc. 1, 413–439 (1998)
31. Dahlberg, B., Kenig, C.: A note on the almost everywhere behavior of solutions to the
Schrödinger equation. LNM 908, 205–209 (1982)
32. Ginibre, J., Velo, G.: On a class of nonlinear Schrödinger equations, special theories in
dimensions 1, 2 and 3. Ann. Inst. H. Poincaré 28, 287–316 (1978)
33. Ginibre, J., Velo, G.: On the class of nonlinear Schrödinger equations. J. Funct. Anal. 32, 1–71
(1979)
34. Ginibre, J., Velo, G.: The global Cauchy problem for the nonlinear Schrödinger equation
revisited. Ann. Inst. H. Poincaré, Analyse NonLinëaire 2, 309–327 (1985)

250
C. E. Kenig
35. Glassey, R.T.: On the blowing up of solutions to the Cauchy problem for nonlinear Schrödinger
equations. J. Math. Phys. 18, 1794–1795 (1977)
36. Glimm, J., Jaffe, A.: Quantum Physics. Springer (1987)
37. Grillakis, M.: Regularity and asymptotic behavior of the wave equation with a critical
nonlinearity. Ann. Math. 132, 485–509 (1990)
38. Grillakis, M.: Regularity for the wave equation, with a critical nonlinearity. Comm. Pure Appl.
Math. 45, 749–774 (1992)
39. Grillakis, M.: On nonlinear Schrödinger equations. Comm. PDE 25, 1827–1844 (2000)
40. Guo, Z.: Global well-posedness of Korteweg-de Vries equation in H −3
4 . J. Math. Pures Appl.
91, 583–597 (2009)
41. Kappeler, T., Topalov, P.: Global well-posedness of mKdV in L2(T, R). Comm. PDE 30, 435–
449 (2005)
42. Kappeler, T., Topalov, P.: Global well-posedness of KdV in H −1(T, R). Duke Math. J. 135,
327–360 (2006)
43. Kato, T.: On the Korteweg-de Vries equation. Manuscripta Math 29, 89–99 (1979)
44. Kato, T.: On the Cauchy problem for the (generalized) Korteweg-de Vries equation. Adv. Math.
Supp. Stud. Stud. Appl. Math. 8, 93–126 (1983)
45. Kato, T.: Nonlinear Schrödinger equations. Ann. Inst. H. Poincaré, Phys-Théor. 46, 113–129
(1987)
46. Kenig, C., Merle, F.: Global well-posedness, scattering and blow-up for the energy critical,
focusing, non-linear Schrödinger equation in the radial case. Invent Math. 166, 646–675 (2006)
47. Kenig, C., Merle, F.: Global well-posedness, scattering and blow-up for the energy-critical
focusing non-linear wave equation. Acta Math. 201, 147–212 (2008)
48. Kenig, C., Merle, F.: Scattering for H
1
2 bounded solutions to the cubic, defocusing (NLS) in 3
dimensions. Trans. Am. Math. Soc. 362, 1937–1962 (2010)
49. Kenig, C., Ponce, G., Vega, L.: Well-posedness and scattering results for the generalized
Korteweg-de Vries equation via the contraction principle. Comm. Pure Appl. Math. 46, 527–
620 (1993)
50. Kenig, C., Ponce, G., Vega, L.: A bilinear estimate with applications to the KdV equation. J.
Am. Math. Soc. 9, 573–603 (1996)
51. Kenig, C., Ponce, G., Vega, L.: On the ill-posedness of some canonical dispersive equations.
Duke Math. J. 106, 617–633 (2006)
52. Killip, R., Visan, M.: Global well-posedness and scattering for the defocusing quintic NLS in
three dimensions. Anal. PDE 5, 855–885 (2012)
53. Killip, R., Visan, M.: KdV is well-posed in H −1. Ann. Math. 190, 249–305 (2019)
54. Kishimoto, N.: Well-posedness of the Cauchy problem for the Korteweg-de Vries equation at
the critical regularity. Differ. Integr. Equ. 22, 447–464 (2009)
55. Klainerman, S., Machedon, M.: Space-time estimates for the null forms and the local existence
theorem. Comm. Pure Appl. Math. 46, 1221–1268 (1993)
56. Lebowitz, J., Rose, H., Speer, E.: Statistical mechanics of the nonlinear Schrödinger equation.
J. Stat. Phys. 50, 657–687 (1988)
57. Lin, J., Strauss, W.: Decay and scattering of solutions of a nonlinear Schrödinger equation. J.
Funct. Anal. 30, 245–263 (1978)
58. Merle, F.: Construction of solutions with exact k blow-up points for the Schrödinger equation
with critical power nonlinearity. Comm. Math. Phys. 149, 205–214 (1992)
59. Merle, F.: Determination of blow-up solutions with minimal mass for nonlinear Schrödinger
equation with critical power. Duke Math. J. 69, 427–453 (1993)
60. Merle, F., Raphaël, P.: Sharp upper bound on the blow-up rate for the critical nonlinear
Schrödinger equation. Geom. Funct. Anal. 13, 591–642 (2003)
61. Merle, F., Raphaël, P.: On universality of blow-up proﬁle for L2 critical nonlinear Schrödinger
equation. Invent. Math. 156, 565–672 (2004)
62. Merle, F., Raphaël, P.: Proﬁles and quantization of the blow-up mass for critical nonlinear
Schrödinger equation. Comm. Math. Phys. 253, 675–704 (2005)

On the Work of Jean Bourgain in Nonlinear Dispersive Equations
251
63. Merle, F., Raphaël, P.: The blow-up dynamic and upper bound on the blow-up rate for critical
nonlinear Schrödinger equation. Ann. Math. 161, 157–222 (2005)
64. Merle, F., Raphaël, P.: On a sharp lower bound on the blow-up rate for the L2 critical nonlinear
Schrödinger equation. J. Am. Math. Soc. 19, 37–90 (2006)
65. Merle, F., Raphaël, P., Rodnianski, I.: Type II blow-up for the energy supercritical NLS. Camb.
J. Math. 3, 439–617 (2015)
66. Merle, F., Raphaël, P., Rodnianski, I., Szeftel, J.: On smooth self similar solutions to the
compressible Euler equations. arXiv:1912.10998
67. Merle, F., Raphaël, P., Rodnianski, I., Szeftel, J.: On blow-up for the energy super critical
defocusing non linear Schrödinger equations. arXiv: 1912.11009
68. Merle, F., Raphaël, P., Rodnianski, I., Szeftel, J.: On the implosion of a three dimensional
compressible ﬂuid. arXiv:1912.11009
69. Molinet, L.: A note on ill-posedness for the KdV equation. Differ. Integr. Equ. 24, 759–765
(2011)
70. Molinet, L.: Sharp ill-posedness and well-posedness for the KdV and mKdV equations on the
torus. Adv. Math. 230, 1895–1930 (2012)
71. Morawetz, C.S.: Notes on time decay and scattering for some hyperbolic problems. SIAM
(1975)
72. Nashanishi, K., Takaoka, H., Tsutsumi, Y.: Counterexamples to bilinear estimates related with
the KdV equation and the nonlinear Schrödinger equation. Methods Appl. Anal. 8, 569–578
(2001)
73. Oh, T.: Invariant Gibbs measures and a.s. global well-posedness for coupled KdV systems.
Differ. Integr. Equ. 22, 637–668 (2009)
74. Raphaël, P.: Stability of the log log bound for blow-up solutions to the critical non-linear
Schrödinger equation. Math. Ann. 331, 577–609 (2005)
75. Raphaël, P.: Existence and stability of a solution blowing up on a sphere for the L2 supercritical
nonlinear Schrödinger equation. Duke Math. J. 134, 199–258 (2006)
76. Rauch, J., Reed, M.: Nonlinear microlocal analysis of semilinear hyperbolic systems in one
variable. Duke Math. J. 49, 397–475 (1982)
77. Ryckman, E., Visan, M.: Global well-posedness and scattering for the defocusing energy-
critical nonlinear Schrödinger equation in R1+4. Am. J. Math. 129, 1–60 (2007)
78. Segal, I.E.: Space-time decay for solutions of wave equations. Adv. Math. 22, 305–311 (1976)
79. Shatah, J., Struwe, M.: Regularity results for nonlinear wave equations. Ann. Math. 138, 503–
518 (1993)
80. Shatah, J., Struwe, M.: Well-posedness in the energy space for semilinear wave equations with
critical growth. Int. Math. Res. Notices 1994(7), 303–309 (1994)
81. Stein, E.M.: Harmonic Analysis: real variable methods, orthogonality and oscillatory integrals.
Princeton Mathematical Series, vol. 43. Princeton University Press, Princeton, NJ (1993)
82. Sjölin, P.: Regularity of solutions to the Schrödinger equation. Duke Math. J. 55, 699–715
(1987)
83. Strichartz, R.S.: Restriction of Fourier Transforms to quadratic surfaces and decay of solutions
to wave equations. Duke Math. J. 44, 705–714 (1977)
84. Struwe, M.: Globally regular solutions to the u5 Klein-Gordon equation. Ann. Scuola Norm.
Sup. Pisa Cl. Sci. 15, 495–513 (1989)
85. Tsutsumi, Y.: L2 solutions for nonlinear Schrödinger equations and nonlinear groups. Funkcial.
Ekvac. 30, 115–125 (1987)
86. Tomas, P.: A restriction theorem for the Fourier transform. Bull. AMS 81, 477–478 (1979)
87. Vega, L.: Schrödinger equations: pointwise convergent to the initial data. Proc. AMS 102, 874–
878 (1988)
88. Vinogradov, I.M.: The Method of Trigonometric Sums in the Theory of Numbers. Inter-
sciences, NY (1954)
89. Visan, M.: The defocusing energy-critical nonlinear Schrödinger equation in higher dimen-
sions. Duke Math. J. 138, 281–374 (2007)

On Trace Sets of Restricted Continued
Fraction Semigroups
Alex Kontorovich
Dedicated to the memory of Jean Bourgain
Abstract We record an argument due to Jean Bourgain which gives lower bounds
on the size of the trace sets of certain semigroups related to continued fractions on
ﬁnite alphabets. These bounds are motivated by the “Classical Arithmetic Chaos”
Conjecture of McMullen (Dynamics of units and packing constants of ideals, 2012).
Speciﬁcally, a power is gained in the asymptotic size of the trace set over a “trivial”
exponent. The proof involves a new application of the Balog-Szemerédi-Gowers
Lemma from additive combinatorics.
1
Introduction
We begin with some personal remarks and reminiscences on the occasion of this
Dedicated Volume; we allow ourselves to be descriptive, returning to precision and
science in Sect 1.1. My collaboration with Jean Bourgain began in the fall of 2008,
when I applied for the 2009-2010 IAS Special Year in Analytic Number Theory.
To explain properly what we were trying to accomplish, I have to back up to my
2007 thesis. There I was interested in a kind of mixture between the theorems
of Friedlander-Iwaniec [14] and Piatetskii-Shapiro [35], the former being that the
polynomial
The author is partially supported by an NSF grant DMS-1802119, and the Simons Foundation
through MoMath’s Distinguished Visiting Professorship for the Public Dissemination of
Mathematics.
A. Kontorovich ()
Department of Mathematics, Rutgers University, Piscataway, NJ, USA
National Museum of Mathematics, New York, NY, USA
e-mail: alex.kontorovich@rutgers.edu
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
A. Avila et al. (eds.), Analysis at Large, https://doi.org/10.1007/978-3-031-05331-3_11
253

254
A. Kontorovich
FI(x, y) := x2 + (y2)2
(1)
represents inﬁnitely many primes and the latter that the sequence
PS(n) := ⌊nα⌋
does too, for sufﬁciently small values of the ﬁxed constant α > 1. Both sequences
are “thin”: the number of integers up to X represented by FI is about X3/4, whereas
for PS, it is about X1/α, so it is rather difﬁcult to produce primes in such sparse
sequences1 (the latter being still much easier than the former!2). The nice thing
about PS is that there is a parameter, α, to play with and thus a potential range of
thinness where one can succeed. The main idea of my thesis (suggested to me by
Peter Sarnak, motivated by his work with Jean and Alex Gamburd on the Afﬁne
Sieve [11]), was to see whether an amalgam of the two was possible in the group
setting; by this we mean the following:
Let  < SL2(Z) be some Zariski-dense subgroup of the modular group; if it
is of inﬁnite index (or even just non-congruence!), then we have no idea exactly
which pairs (c, d) arise as bottom rows, say, of elements in the group
 ∗∗
c d
 ?∈.
We would, in principle, ﬁrst need to try to write any such matrices as words in the
generators of . Regardless, consider the sequence
S := {c2 + d2 :
 ∗∗
c d

∈}.
(2)
The total number of such values c2+d2 < X can be counted effectively, that is, with
power savings, as was done in my thesis [24] (under a technical assumption that was
removed in [30]). The answer is roughly Xδ, where δ, assumed to exceed one-half, is
the critical exponent of  (equivalently [34], the Hausdorff dimension of the limit set
of ; the condition δ > 1/2 is needed to relate δ to the base eigenvalue λ0 = δ(1−δ)
of the hyperbolic Laplacian acting on square-integrable functions on the upper half
plane H invariant under ). Since one can exhibit  with δ arbitrarily close to 1,
one can play with this “thinness” parameter, similarly to Piatetskii-Shapiro, where
1/α < 1 plays the role of δ. If instead we returned to all integer pairs (c, d) but
forced d = y2 to be a perfect square, then we would exactly be in the situation
of Friedlander-Iwaniec (1). So this set S has both features, studying c2 + d2 for
restricted (by the group) values of (c, d), with the ﬂexibility of a parameter δ. Since
this phenomenon of δ being thin but not “too” thin will appear again and again, let
me refer to it as being slightly thin, that is, allowing δ < 1 but also requiring that
δ > 1 −ε0 for some (usually small) ε0 > 0.
1 Heath-Brown [19] was later able to do the same for the even thinner polynomial x3 + 2y3, which
takes about X2/3 values up to X.
2 See also [25] for a simpler instance of this “parity breaking.”

On Trace Sets
255
The problem of producing primes in S for any value of δ < 1 is still wide
open. The tools in my thesis managed to produce R-almost primes (i.e., numbers
with at most R prime factors) for R = 13 in slightly thin groups,3 and in my
application to IAS, I had proposed not just to use the linear sieve but to introduce
bilinear form techniques into the afﬁne sieve to attack this problem, with the hope
of producing actual primes. Admittedly, this is perhaps a rather niche question, but
one I enjoyed thinking about for its mixture of geometric, combinatorial, spectral,
dynamical, algebraic, and number theoretic techniques.
Jean must have read my application, because the next time I visited Peter at
IAS, Jean requested to speak with me. At our meeting, he outlined how to execute
such bilinear form ideas to produce primes, not in S but in certain algebraic traces
of entries of slightly thin subgroups of the Picard group SL2(Z[i]), the added
dimension allowing for more variables.4 Together, we whittled away at the problem
until we could produce, for slightly thin subgroups of the modular group SL2(Z),
primes in the values of the linear map f :
 a b
c d

→d (note that, for S in (2),
we would instead apply a quadratic map f :
 a b
c d

→c2 + d2). At some point
during a conversation with Jean and Peter, we realized that in fact we already had
almost all the tools needed to prove something much stronger: the reason we were
able to produce prime values of f is because we were actually producing almost
all numbers! (This is in contradistinction to f = c2 + d2 which is genuinely a thin
subset of Z.5)
Thus, producing an almost-all statement in the f = d values of slightly thin
subgroups of SL2(Z) became our ﬁrst joint paper [4]. It required an additional
stubborn technical ingredient (of independent interest) to count effectively in
bisectors in thin groups, which we proved in a companion paper jointly also with
Peter [12]; such ideas have since been generalized many times by many authors.
We had also noticed some similarities between this problem and the local-global
problem for Apollonian packings (see [4, Remark 1.12]), but there did not seem to
be an obvious way to transfer our technology, given that the Apollonian group was
not slightly thin, but had a ﬁxed dimension, δ ≈1.30; there was no parameter to
adjust!
At this point, I thought our collaboration was basically done and I could
return to civilian life. But as luck would have it, Curt McMullen pointed out
to us the similarity between the problem we had just attacked and Zaremba’s
conjecture [40] on bounded continued fractions of rationals. (See, e.g., [26] for a
detailed discussion of this problem.) We should have already been aware of the
connection, since years before, Jeff Lagarias had pointed out to me the similarity
between Zaremba and Apollonius (see [16, p. 37]), but somehow it took Curt’s
urging for us to begin working on it. The Zaremba problem was nearly identical,
except that we were missing a number of technical ingredients, including the
3 It turns out that I should have been able to product R-almost primes with R = 7, see [21].
4 Much later, I would exploit a similar feature in [29].
5 For a formal deﬁnition of thinness in a general context, see [27, p. 954].

256
A. Kontorovich
main consequences of [12]. The reason is that, in Zaremba, one must deal with
a sub-semi-group of SL2(Z), not a subgroup, thus rendering our spectral and
representation theoretic counting developments useless. Nevertheless, one could
substitute the thermodynamic formalism to count [13, 20], and we were able to
show density one for Zaremba [5]. Here the analog of being “slightly thin” is having
a sufﬁciently large allowed alphabet for the restricted partial quotients.
Again I thought that would basically be the end of things, but about a year
later, we realized that using some rather different techniques (relying not on “slight
thinness,” but instead exploiting the existence of values of shifted binary quadratic
forms inside the bend set, as observed by Sarnak [36], and taking inspiration from
Jean’s paper [3] on prime values in Apollonian packings), we could actually extend
the local-global technology to prove density one in the Apollonian problem; see [6].
It quickly became clear that the bilinear form technology developed on our
“Orbital Circle Method” phase could be applied much more widely, and we turned
our attention back to the original sequence (2) from my thesis. There we were able
to implement these ideas, along with some others (e.g., the “dispersion method”
in the group context), to push past the sieve level of distribution (see [27]) which
follows “for free” from counting arguments and “expansion” (i.e., certain families
of Cayley graphs being expanders), to a level “Beyond Expansion.” In the end, we
could produce, for any slightly thin group, R-almost primes in S, with R = 4 [7].
This became Part I in our Beyond Expansion program.
For Part II [8], we turned our attention to a problem of Einsiedler-Lindenstrauss-
Michel-Venkatesh, which itself actually served as the original motivation for the
Afﬁne Sieve (see [37]). This problem, involving the same semigroup as in our
Zaremba work, required “only” a square-free sieve, but as it turned out, expansion
alone was just barely insufﬁcient to solve the problem. An added difﬁculty was that,
unlike Zaremba where the linear function on the semigroup was f :
 a b
c d

→d,
here one needed to deal with the trace, f :
 a b
c d

→a + d. The nice thing about
f = d is that it is already itself bilinear, being expressible as f (γ ) = ⟨e2, γ e2⟩
(with e2 = (0, 1)t), but trace is not. Nevertheless, with some new ideas, we were
able to solve the problem, producing an inﬁnitude of “low-lying” but “fundamental”
closed geodesics on the modular surface. In Part III of the series [10], we added
the adjective “reciprocal” to the closed geodesics, inching such a tad closer to the
Markoff geodesics they are meant to imitate.
And the ﬁnal Part IV of the series, which is related to the theorem we wish to
explain in this note, was motivated by the “Classical Arithmetic Chaos Conjecture”
posed by Curt McMullen; see Sect 1.1. This problem was basically too difﬁcult for
us to say very much about at all, except that we could improve the “expansion”
exponent of distribution in the trace set all the way to what it would have been, had
some analog of the Ramanujan conjecture (on average) existed in this setting; see
[9].
Thus, it ended my collaboration with Jean Bourgain. Echoing what others have
said, with his passing, the mathematical world has lost an Archimedes, an Euler,
and a Gauss. It was an incredible privilege and honor to work with Jean, and I am
forever grateful.

On Trace Sets
257
The last few of our papers were being ﬁnalized as Jean was undergoing various
surgeries and chemotherapies, and one only appeared posthumously (one of ours,
that is, I’m sure Jean will continue co-authoring posthumously for a few more
years). In our conversations over the last few years, he never once showed any signs
of fear or despair at his condition, treating “mundane” things very matter of factly
and wanting to steer discussions back to theorems and (scientiﬁc) battles still to be
waged.
Of Jean’s many hand-written and scanned notes to me (as in the example below),
all have been converted to publications save one, which is the one we aim to record
now. To be perfectly honest, Jean thought it should be possible to do more here
and wanted to return to the problem later, not publish things as they stand. But now
there is no “later,” so I would like to record his theorem as is. At some point, Michael
Magee and I worked on this note as an appendix to our paper with Jean (which itself
later became an appendix); I would like to thank Michael for his work on it and his
permission to reuse some of it here. On to the science.
1.1
McMullen’s Arithmetic Chaos Conjecture
For x ∈R, we write its continued fraction expansion as
x = [a0; a1, . . . , aℓ, . . .] = a0 +
1
a1 +
1
a2 + ...
1
aℓ+ ...
,
which may be either ﬁnite or inﬁnite; here a0 ∈Z, and for j ≥1, the “partial
quotients” aj are positive integers. The bar in
[a0, a1, . . . , aℓ]
denotes periodically repeating partial quotients; it is very well-known that such
numbers are quadratic surds. For a ﬁnite “alphabet” A ⊂N, let CA denote the
Cantor-like set of numbers in the unit interval whose partial quotients lie in A,
CA := {[0; a1, . . . , aℓ, . . . ] : a1, a2, · · · ∈A},
and let δA be its Hausdorff dimension,
δA := H.dim(CA) ∈[0, 1).

258
A. Kontorovich
Motivated by conjectures on the rigidity of higher-rank diagonal ﬂows, McMullen
[31, 32] formulated the following rank-one problem:
Conjecture 1.1 (McMullen’s Classical Arithmetic Chaos Conjecture) Let A be
any alphabet with dimension δA exceeding 1/2. Then for any real quadratic ﬁeld
K, the set

On Trace Sets
259
{[a0, a1, . . . , aℓ] ∈K : all aj ∈A}
(3)
grows exponentially as the length ℓ→∞.
Exponential growth is not known for a single choice of A and K. Worse yet, it is
unknown unconditionally whether there is an alphabet A such that every K has at
least one surd with all partial quotients in A, that is, whether the union over all ℓ
of (3) is non-empty! On the other hand, Mercat [33] has proven this last statement
assuming the validity of Zaremba’s conjecture [5, 40]. Unconditionally, Wilson [38]
has shown that for any K, there is some A = A(K) so that (3) is non-empty
inﬁnitely often; see also [39].
1.2
Thin Semigroups
To connect this problem to “thin semigroups,” let GA ⊂GL2(Z) denote the
semigroup generated by matrices of the form
 0 1
1 a

with a ∈A,
GA :=
0 1
1 a

: a ∈A
 +
,
where the superscript “+” indicates generation without inverses. (See [28, Lecture
3] for why GA is “thin”.) This matrix semigroup was introduced in [5] to study
Zaremba’s conjecture, but is equally germane to McMullen’s problem, due to the
following elementary observation: if
γ =
0 1
1 a0

· · ·
0 1
1 aℓ

∈GA,
then
Q([a0, . . . , aℓ]) = K,
where
K = Q(
A
tr2 γ −4 det γ ).
(Recall that det γ = ±1.) That is, one can read off the discriminant of the real
quadratic ﬁeld corresponding to adjoining [a0, . . . , aℓ] in terms of the trace of γ .

260
A. Kontorovich
1.3
The Local-Global and Positive Density Conjectures
The above simple observation motivates one to study the set TA of traces of GA,
TA := {tr γ : γ ∈GA}.
Indeed, Bourgain and the author have formulated a certain “Local-Global Con-
jecture” for linear forms on GA (see [28, Conjecture 6.3.1]) which implies both
Zaremba’s conjecture and McMullen’s Conjecture 1.1, in particular, predicting
which traces should arise and with what multiplicity. A weaker problem, formulated
already by McMullen [32], is the following:
Conjecture 1.2 (McMullen’s Positive Density Conjecture for Traces) Let A be
an alphabet with δA > 1/2. Then the trace set TA comprises a positive proportion
of integers, that is,
#TA ∩[1, N] ≫N,
(4)
as N →∞.
The restriction to alphabets having δA exceed 1/2 is necessary, in light of the
following result of Hensley [20].
Theorem 1.3 (Hensley) As N →∞,
|GA ∩BN| ≍N2δA.
(5)
Indeed, if δA < 1/2, then TA is automatically a thin subset of the integers.
This positive density Conjecture 1.2, despite being much weaker than a full local-
global statement, is also wide open, even for any choice of (ﬁnite) alphabet A. If,
instead of traces, one considers the set DA of “bottom-right” entries,
DA := {d ∈N : ∃
 ∗∗
∗d

∈GA},
then one can show not just positive density but density one for “slightly thin”
alphabets (ones with δA > 1 −ε0); see [5]. Zaremba’s conjecture is equivalent
to a local-global statement for DA. The proof technique there shows the following:
Theorem 1.4 ([5]) Let A be an alphabet with δ = δA sufﬁciently near 1, δ >
1 −ε0. Then, there exist subsets SN ⊂GA ∩BN of nearly full cardinality,
#SN ≫N2δ
such that, for every d ≪N, the multiplicity of the map
 a b
c d

→d is bounded by

On Trace Sets
261
#{γ ∈SN, γ =
 ∗∗
∗d

} ≪N2δ−1.
(6)
This estimate will be the only “black box” used; besides this, the paper is self-
contained.
1.4
Statements of the Main Theorems
Returning to the trace set TA, the “trivial” bound towards (4) is
#TA ∩[1, N] ≫N2δA−1−o(1).
(7)
Indeed, a simple argument shows that each trace t < N occurs with multiplicity
≪N1+o(1), whence (7) follows from (5).
Our goal here is to give Jean Bourgain’s proofs of the following two results,
which improve over this.
Theorem 1.5 When δA > 1/2,
#TA ∩[1, N] ≫Nδ−o(1).
(8)
Theorem 1.6 Suppose {1, 2, 3} ⊂A and δ > 1 −ε0 so that (6) holds. Then as
N →∞,
#TA ∩[1, N] ≫Nδ+ 1−δ
29 −o(1).
(9)
Remark 1.7 The proof of Theorem 1.5 is elementary, and yet it already improves
upon (7), sometimes dramatically so. Indeed, when A = {1, 2}, we have δ{1,2} ≈
0.531 [17]; the trivial bound (7) gives only
#T{1,2} ∩[1, N] ≫N0.062,
while (8) gives
#T{1,2} ∩[1, N] ≫N0.531.
Remark 1.8 The original work [5] showed (6) as long as δ > 0.984, and this
bound was relaxed in [15] and [23] to δ > 0.781; the latter holds already for
A = {1, 2, 3, 4} which has dimension δ{1,2,3,4} ≈0.789; see [22]. Thus, for this
alphabet, Theorem 1.6 improves from (8) that

262
A. Kontorovich
#T{1,2,3,4} ∩[1, N] ≫N0.789,
to
#T{1,2,3,4} ∩[1, N] ≫N0.796.
The proof of Theorem 1.6 applies more generally to give an improvement in the
exponent whenever δ > 1/2 and A contains a three-term progression; but for ease
of exposition, we state this simpler version.
The core of Theorem 1.6 is the following version of the Balog-Szemerédi-
Gowers Lemma with polynomial dependencies of constants on one another. The
original version of the Balog-Szemerédi-Gowers Lemma with polynomial depen-
dencies of constants appeared in Gowers’ work on arithmetic progressions [18].
For subsets A, B of an ambient additive group and G ⊂A × B an arbitrary
subset, we use the notation
A
G+ B := {a + b : (a, b) ∈G}.
Lemma 1.9 Let A ⊂Z be a ﬁnite set and G ⊂A × A satisfy
|G| > 1
K |A|2
and
|A
G+ A| ≤|A|.
(10)
Then, there is a subset A′ ⊂A such that
|(A′ × A′) ∩G| ≫K−2|A|2
and
|A′ −A′| ≪K13|A|,
where the implied constants are absolute.
This version is a reﬁnement of Bourgain’s work [1, Lemma 2.1] on the dimension
of Kakeya sets. To make the argument almost self-contained (modulo Theorem 1.4),
we give a quick proof of Lemma 1.9 in Sect. 5.

On Trace Sets
263
1.5
Notation
Whenever we write BN, we mean the ball in the space of 2×2 matrices with respect
to the ℓ1 norm on their entries, and when we write ∥g∥, we mean the ℓ1 norm. We
write sqf for the squarefree part of a number and ω for the number of distinct prime
factors of a number. We use Vinogradov notation ≪,≫, O,o in the standard way
and indicate dependence of implied constants on other parameters by subscripts,
e.g., ≪ϵ. We use f ≍g to mean f ≪g and g ≪f . Normally, we view A
as ﬁxed so any implied constant may depend on A. For a subset A of an ambient
additive group, we write A + A and A −A for setwise sums and differences, e.g.,
A −A = {a1 −a2 : a1, a2 ∈A}, etc.
2
Preliminary Remarks
Write
γa :=
 0 1
1 a

,
for a generator of the semigroup GA. A ping-pong argument using the action of γa
on [0, 1] by Möbius transformations shows that GA is freely generated by the γa,
for a ∈A. Let
A := GA ∩SL2
be the sub-semigroup of orientation-preserving elements; equivalently, these are
even words in the generators (each of the latter has determinant det γa = −1).
The key (trivial) observation used throughout is the following:
a b
c d
  0 1
1 α

=
 b a + αb
d c + αd

,
(11)
whence b+c+αd is a trace in GA. Taking α = 1, 2, 3 (if we assume that {1, 2, 3} ⊂
A), we see that all three of
b + c + d, b + c + 2d, b + c + 3d ∈TA,
(12)
whenever
 ∗b
c d

∈GA.

264
A. Kontorovich
3
Proof of Theorem 1.5
For simplicity, assume that {1, 2} ⊂A; in general, we know by δ > 1/2 that |A| ≥
2, and trivial modiﬁcations are needed in what follows. In light of (12), we would
like to know the multiplicity of the map
ϕ : A →N2 :
 a b
c d

→(b + c, d).
Lemma 3.1 Let (n, m) ∈N2 with n, m ≪N. Then, the preimage of (n, m) has
cardinality at most
|ϕ−1(n, m)| ≤gcd(n2 + 4, m)1/2No(1).
Proof Suppose that (b + c, d) = (n, m). Clearly, d = m is determined. Since
ad −bc = 1 and c = n −b, we have
1 + b(n −b) ≡0(mod d).
The discriminant of this quadratic in b is  := n2 + 4, and it is elementary that the
number of solutions to b(mod d) is ≪ε (, d)1/2Nε. Since b ≤d, it is determined
once it is known mod d; then so is c = n −b, and then a = (1 + bc)/d.
⊓⊔
The issue becomes to discard
 a b
c d

∈A having large gcd(, d).
Lemma 3.2 For any ϵ > 0, there is a subset B′
N ⊂A ∩BN satisfying
|B′
N| > 1
2|A ∩B(N)|,
(13)
and if
 a b
c d

∈B′
N, then gcd((b + c)2 + 4, d) ≪ϵ Nϵ.
Lemma 3.2 follows immediately from the following: Lemma that we will also
use later.
Lemma 3.3 Suppose that δ > 1
2. For all ϵ > 0, there is η = η(ϵ) > 0 such that

!a b
c d

∈A ∩BN : gcd((b + c)2 + 4, d) > Nϵ
=  ≪ϵ N2δ−η.
In particular, in comparison to Theorem 1.3, these elements form a negligible subset.
Proof Given
 a b
c d

∈A ∩BN, suppose that there is “large” q > Nϵ dividing both
(b + c)2 + 4 and d. Then, bc + 1 ≡0 mod d implies
(b −c)2 ≡b2 + c2 + 2 ≡(b + c)2 + 4 ≡0 mod q.

On Trace Sets
265
Therefore, b ≡c mod q1 for some q1|q with q1 > Nϵ/2. Then,
d ≡b2 + 1 ≡c2 + 1 ≡0 mod q1.
(14)
We write each g ∈A with ∥g∥≍N in the form
g = g1g2
with
∥g2∥≍N′ := N
ϵ
10 .
(Note that for
 a b
c d

∈GA, the entries a, b, c, d are all commensurate and that
word length in the generators is log-commensurate to the Archimedean norm.)
Accordingly, we write
g1 =
 α β
γ ζ

,
g2 =
x y
z w

so that
a b
c d

=
αx + βz αy + βw
γ x + ζz γy + ζw

.
(15)
For each choice of g1 and y, we will show there are few possibilities for w if (14)
is to hold for some q1 > N
ϵ
2 . On the other hand, y and w determine g2, and hence
g1, y, w determine g. Combining (14) and (15), we get
γy + ζw ≡0 mod q1
(16)
and
(γ x + ζz)2 ≡−1 mod q1.
Thus, using det g2 = 1 gives
−y2 ≡y2(γ x + ζz)2 ≡(γyx + ζyz)2 ≡(γyx + ζ(xw −1))2 ≡ζ 2 mod q1
where the last equality uses (16). In other words,
y2 + ζ 2 ≡0 mod q1.
For ﬁxed g1, y the number of w so that (14) holds for some q1 is bounded by

266
A. Kontorovich

q1|y2+ζ 2
|{w : γy + ζw = 0 mod q1}|.
(17)
For each q1 in the sum, let q2 = gcd(q1, ζ 2). We have y2 ≡0 mod q2, and since
0 < y < N′, this implies q2 < N′. This means gcd(q1, ζ) < N′, and then γy +
ζw = 0 mod q1 speciﬁes w mod q3 := q1/ gcd(q1, ζ), with q3 > N
ϵ
2 N−ϵ
10 . But
since 0 < w ≪N
ϵ
10 , this speciﬁes w.
Then, each term in (17) is bounded by 1, and we can bound (17) by the number
of divisors of y2 + ζ 2 ≤N2, which is No(1). It remains to sum over g1 and y, and
this gives that the number of g ∈A ∩BN such that (14) holds for some q1 > N
ϵ
2
is
≤|{g1 : ∥g1∥≪N1−ϵ
10 }| · |{y ≪N
ϵ
10 }| · No(1)
≪N2δ(1−ϵ
10 )N
ϵ
10 No(1) ≪N2δ−η
for some η = η(ϵ) > 0.
⊓⊔
Proof of Theorem 1.5 For small ϵ > 0, let B′
N be the family of subsets from
Lemma 3.2. Combining Lemmas 3.1 and 3.2, the map
B′
N →TA(3N) × TA(4N) :
a b
c d

→(b + c + d, b + c + 2d)
has multiplicity at most No(1) and so
|TA(N)|2 > 1
2|A ∩BN|N−o(1) ≫N2δ−o(1).
Taking square roots completes the proof.
⊓⊔
4
Proof of Theorem 1.6
Assume now that {1, 2, 3} ⊂A, so we can exploit the full force of (12). By
Theorem 1.4, there is a family of subsets
S(N) ⊂A ∩BN
with |S(N)| ≫N2δ and such that the map
 a b
c d

→d has multiplicity M ≪N2δ−1.
Then, using Lemma 3.3 and echoing the previous argument, we can ﬁnd a subset
S′(N) ⊂S(N) such that the map

On Trace Sets
267
ψ : S′(N) →TA(3N) × TA(5N),
 a b
c d

→(b + c + d, b + c + 3d)
has multiplicity < No(1). Let
T0 = {b + c + jd :
 a b
c d

∈S′(N), 1 ≤j ≤3} ⊂TA(5N).
We apply Lemma 1.9 with A = T0 and
G = {(b + c + d, b + c + 3d) :
 a b
c d

∈S′(N)} = ψ(S′(N)).
By our previous bound on the multiplicity of ψ,
|G| > N2δ−o(1).
Also,
T0
G+ T0 = {2(b + c + d) :
 a b
c d

∈S′(N)}
so
|T0
G+ T0| ≤|T0|.
We can thus apply Lemma 1.9 with
K = |T0|2N−2δ+o(1)
Let A′ be the subset obtained from Lemma 1.9.
The key point is that for each element of (t1, t2) ∈(A′ × A′) ∩G, one has
t2 −t1 ∈2DA. Moreover, if (t1, t2) = ψ
 a b
c d

, then t2 −t1 = 2d. Since the
multiplicity of the denominator mapping on S′(N) is at most M, the multiplicity of
(t1, t2) →t2 −t1 is at most M on (A′ × A′) ∩G. Therefore,
K13|A| ≫|A′ −A′| ≥|(A′ × A′) ∩G|M−1 ≫K−2|A|2M−1
where the outer two inequalities are the output of Lemma 1.9. This gives
|A| ≪K15M,
or recalling the value of K,
|T0| < |T0|30N−30δ+o(1)M.
Substituting the value of M = N2δ−1 gives the result as claimed.

268
A. Kontorovich
5
Proof of Lemma 1.9
The following argument is a modiﬁcation of [2, Section 2]: By Cauchy-Schwarz and
(10),
|G| =

z∈A
G+A
|{(x, y) ∈G : x + y = z}|
≤|A|
1
2 |{(x1, y1; x2, y2) ∈G × G : x1 + y1 = x2 + y2}|
1
2 ,
implying that
|{(x1, y1; x2, y2) ∈G × G : x1 + y1 = x2 + y2}| > 1
K2 |A|3.
(18)
Denote w(x) = |{(x1, x2) ∈A : x1 −x2 = x}| and set
D = {x : w(x) >
1
10K2 |A|},
R = {(x, x′) ∈A2 : x1 −x2 ∈D},
and also write
Rx1 = {x2 ∈A : x1 −x2 ∈D}.
The set D is the “popular differences.” Then,
|{(x1, y1; x2, y2) ∈A4 : x1 + y1 = x2 + y2, either x1 −x2 /∈D or y1 −x2 /∈D}|
≤2|A|2
1
10K2 |A| =
1
5K2 |A|3,
since, for example, x1−x2 = y1−y2 so each of at most |A|2 pairs (x1, x2) with x1−
x2 /∈D contribute at most
1
10K2 |A| possibilities for (y1, y2). The other contributions
are estimated similarly. This estimate together with (18) gives
1
2K2 |A|3 < |{(x1, y1; x2, y2) ∈G × G : x1 + y1 = x2 + y2, x1 −x2 ∈D, y1 −x2 ∈D}|
≤

(x1,y1)∈G
|Rx1 ∩Ry1|
=

y
|(Ry × Ry) ∩G|.
(19)
Let

On Trace Sets
269
Y = {(x, x′) ∈A2 : |Rx ∩Rx′| < θ|A|}
where θ is a parameter to be speciﬁed. Obviously from the deﬁnition of Y, we have

y
|(Ry × Ry) ∩Y| =

(x,x′)∈Y
|Rx ∩Rx′| < θ|A|3.
Therefore, from (19), we see that

y
|(Ry × Ry) ∩G| >
1
4K2 |A|3 +
1
4K2θ

y
|(Ry × Ry) ∩Y|.
Thus, there is y0 ∈A such that
|(Ry0 × Ry0) ∩G| >
1
4K2 |A|2 +
1
4K2θ |(Ry0 × Ry0) ∩Y|.
(20)
In particular,
|Ry0| >
1
2K |A|.
(21)
Let
A′ = {x ∈Ry0 : |({x} × Ry0) ∩Y| < 1
3|Ry0|}.
(22)
Then, clearly
1
3|Ry0||Ry0\A′| < |(Ry0 × Ry0) ∩Y|,
and by (20), (5), we have
|(A′ × A′) ∩G| ≥|(Ry0 × Ry0) ∩G| −2|Ry0\A′|.|Ry0|
≥
1
4K2 |A|2 +

1
4K2θ −6

|(Ry0 × Ry0) ∩Y|
≥
1
4K2 |A|2
(23)
if we take
θ =
1
24K2 .

270
A. Kontorovich
Take now (x1, x2) ∈(A′ × A′) ∩G. By (22), there are at least 1
3|Ry0| values of
x ∈Ry0 such that (x1, x) /∈Y and (x2, x) /∈Y. For each of these x, we have by the
deﬁnition of Y
|Rx1 ∩Rx| ≥
1
24K2 |A|,
|Rx2 ∩Rx| ≥
1
24K2 |A|,
and then
x1 −x2 = (x1 −x) −(x2 −x)
= (x1 −y1) −(x −y1) −(x2 −y2) + (x −y2)
(24)
for at least
|A|2
576K4 pairs (y1, y2) (depending on x, x1, x2) with
(x1, y1), (x, y1), (x2, y2), (x, y2) ∈R.
By deﬁnition of R and D, each of the parenthetical terms in (24) admits a
representation in at least
|A|
10K2 ways as a difference of elements of A, and therefore,
the number of representations
x1 −x2 = (τ1 −τ2) −(τ3 −τ4) −(τ5 −τ6) + (τ7 −τ8),
τi ∈A
(25)
is at least
1
3|Ry0|. |A|2
576K4 .
 |A|
10K2
4 (21)
≫
1
K13 |A|7.
Considering the map on (τi)8
i=1 given by (25), we get
|A′ −A′| ≪
|A|8
K−13|A|7 = K13|A|.
This together with the previously established (23) proves Lemma 1.9.
References
1. Bourgain, J.: On the dimension of Kakeya sets and related maximal inequalities. Geom.
Funct. Anal. 9(2), 256–282 (1999)
2. Bourgain, J.: Sum-product theorems and applications. In: Additive Number Theory, pp. 9–38.
Springer, New York (2010)
3. Bourgain, J.: Integral Apollonian circle packings and prime curvatures. J. Anal. Math. 118(1),
221–249 (2012)
4. Bourgain, J., Kontorovich, A.: On representations of integers in thin subgroups of SL(2, Z).
GAFA 20(5), 1144–1174 (2010)

On Trace Sets
271
5. Bourgain, J., Kontorovich, A.: On Zaremba’s conjecture. Annals Math. 180(1), 137–196
(2014)
6. Bourgain, J., Kontorovich, A.: On the local-global conjecture for integral Apollonian gaskets.
Invent. Math. 196(3), 589–650 (2014)
7. Bourgain, J., Kontorovich, A.: The afﬁne sieve beyond expansion I: Thin hypotenuses. Int.
Math. Res. Not. IMRN (19), 9175–9205 (2015)
8. Bourgain, J., Kontorovich, A.: Beyond expansion II: low-lying fundamental geodesics. J.
Eur. Math. Soc. (JEMS) 19(5), 1331–1359 (2017)
9. Bourgain, J., Kontorovich, A.: Beyond expansion IV: Traces of thin semigroups. Discrete
Anal., Paper No. 6, 27 (2018)
10. Bourgain, J., Kontorovich, A.: Beyond expansion III: Reciprocal geodesics, 2019. To appear,
Duke Math. J. arXiv:1610.07260
11. Bourgain, J., Gamburd, A., Sarnak, P.:
Afﬁne linear sieve, expanders, and sum-product.
Invent. Math. 179(3), 559–644 (2010)
12. Bourgain, J., Kontorovich, A., Sarnak, P.: Sector estimates for hyperbolic isometries. GAFA
20(5), 1175–1200 (2010)
13. Bourgain, J., Gamburd, A., Sarnak, P.: Generalization of Selberg’s 3/16th theorem and afﬁne
sieve. Acta Math 207, 255–290 (2011)
14. Friedlander, J., Iwaniec, H.: The polynomial X2 + Y 4 captures its primes. Ann. Math. (2)
148(3), 945–1040 (1998)
15. Frolenkov, D.A., Kan, I.D.: A strengthening of a theorem of Bourgain-Kontorovich II. Mosc.
J. Comb. Number Theory 4(1), 78–117 (2014)
16. Graham, R.L., Lagarias, J.C., Mallows, C.L., Wilks, A.R., Yan, C.H.:
Apollonian circle
packings: number theory. J. Number Theory 100(1), 1–45 (2003)
17. Good, I.J.: The fractional dimensional theory of continued fractions. Proc. Camb. Philos.
Soc. 37, 199–228 (1941)
18. Gowers, W.T.: A new proof of Szemerédi’s theorem for arithmetic progressions of length
four. Geom. Funct. Anal. 8(3), 529–551 (1998)
19. Heath-Brown, D.R.: Primes represented by x3 + 2y3. Acta Math. 186(1), 1–84 (2001)
20. Hensley, D.: The distribution of badly approximable numbers and continuants with bounded
digits. In: Théorie des nombres (Quebec, PQ, 1987), pp. 371–385. de Gruyter, Berlin (1989)
21. Hong, J., Kontorovich, A.: Almost prime coordinates for anisotropic and thin pythagorean
orbits. Isr. J. Math. 209(1), 397–420 (2015)
22. Jenkinson, O.: On the density of Hausdorff dimensions of bounded type continued fraction
sets: the Texan conjecture. Stoch. Dyn. 4(1), 63–76 (2004)
23. Kan, I.D.: A strengthening of a theorem of Bourgain and Kontorovich. V. Tr. Mat. Inst.
Steklova 296(Analiticheskaya i Kombinatornaya Teoriya Chisel), 133–139 (2017)
24. Kontorovich, A.: The hyperbolic lattice point count in inﬁnite volume with applications to
sieves. Duke J. Math. 149(1), 1–36 (2009). arXiv:0712.1391
25. Kontorovich, A.: A pseudo-twin primes theorem (2012). In: Proceedings of the Edinburg
Conference, Workshop on Multiple Dirichlet Series. arXiv:0507569. To appear
26. Kontorovich, A.: From Apollonius to Zaremba: local-global phenomena in thin orbits. Bull.
Am. Math. Soc. (N.S.) 50(2), 187–228 (2013)
27. Kontorovich, A.: Levels of distribution and the afﬁne sieve. Ann. Fac. Sci. Toulouse Math.
(6) 23(5), 933–966 (2014)
28. Kontorovich, A.: Applications of thin orbits. In: Dynamics and Analytic Number Theory,
vol. 437. London Math. Soc. Lecture Note Ser., pp. 289–317. Cambridge Univ. Press,
Cambridge (2016)
29. Kontorovich, A.: The local-global principle for integral Soddy sphere packings. J. Modern
Dynam. 15, 209–236 (2019)
30. Kontorovich, A., Oh, H.: Almost prime Pythagorean triples in thin orbits. J. Reine Angew.
Math. 667, 89–131 (2012). arXiv:1001.0370
31. McMullen, C.T.: Uniformly Diophantine numbers in a ﬁxed real quadratic ﬁeld. Compos.
Math. 145(4), 827–844 (2009)

272
A. Kontorovich
32. McMullen, C.: Dynamics of units and packing constants of ideals (2012). Online lecture
notes, http://www.math.harvard.edu/~ctm/expositions/home/text/papers/cf/slides/slides.pdf
33. Mercat, P.: Construction de fractions continues périodiques uniformément bornées (2012).
To appear, J. Théor. Nombres Bordeaux
34. Patterson, S.J.: The Laplacian operator on a Riemann surface. Compositio Math. 31(1),
83–107 (1975)
35. Pjatecki˘i-˘Sapiro, I.I.: On the distribution of prime numbers in sequences of the form [f (n)].
Mat. Sb. 33, 559–566 (1953)
36. Sarnak, P.:
Letter to J. Lagarias (2007).
http://web.math.princeton.edu/sarnak/
AppolonianPackings.pdf
37. Sarnak, P.: Reciprocal geodesics. In: Analytic Number Theory, vol. 7. Clay Math. Proc.,
pp. 217–237. Amer. Math. Soc., Providence, RI (2007)
38. Wilson, S.M.J.: Limit points in the Lagrange spectrum of a quadratic ﬁeld. Bull. Soc. Math.
France 108, 137–141 (1980)
39. Woods, A.C.: The Markoff spectrum of an algebraic number ﬁeld. J. Aust. Math. Soc. Ser. A
25(4), 486–488 (1978)
40. Zaremba, S.K.: La méthode des “bons treillis” pour le calcul des intégrales multiples. In:
Applications of Number Theory to Numerical Analysis (Proc. Sympos., Univ. Montreal,
Montreal, Que., 1971), pp. 39–119. Academic Press, New York (1972)

Polynomial Equations in Subgroups and
Applications
Sergei V. Konyagin, Igor E. Shparlinski, and Ilya V. Vyugin
Dedicated to the Memory of Jean Bourgain
Abstract We obtain a new bound for the number of solutions to polynomial
equations in cosets of multiplicative subgroups in ﬁnite ﬁelds, which generalizes
previous results of P. Corvaja and U. Zannier (2013). We also obtain a conditional
improvement of recent results of J. Bourgain, A. Gamburd, and P. Sarnak (2016) and
S. V. Konyagin, S. V. Makarychev, I. E. Shparlinski, and I. V. Vyugin (2019) on the
structure of solutions to the reduction of the Markoff equation x2 + y2 + z2 = 3xyz
modulo a prime p.
2010 Mathematics Subject Classiﬁcation 11D79, 11T06
S. V. Konyagin ()
Steklov Mathematical Institute, Moscow, Russia
e-mail: konyagin@mi-ras.ru
I. E. Shparlinski
Department of Pure Mathematics, University of New South Wales, Sydney, NSW, Australia
e-mail: igor.shparlinski@unsw.edu.au
I. V. Vyugin
Institute for Information Transmission Problems RAS, Moscow, Russia
HSE University, Moscow, Russia
Steklov Mathematical Institute, Moscow, Russia
e-mail: vyugin@gmail.com
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
A. Avila et al. (eds.), Analysis at Large, https://doi.org/10.1007/978-3-031-05331-3_12
273

274
S. V. Konyagin et al.
1
Introduction
1.1
Background and Motivation
Bourgain, Gamburd, and Sarnak [2, 3] have recently initiated the study of reductions
modulo p of the set M of Markoff triples (x, y, z) ∈N3 which are positive integer
solutions to the Diophantine equation
x2 + y2 + z2 = 3xyz,
(x, y, z) ∈Z3.
(1)
Simple computation shows that the map
R1 : (x, y, z) →(3yz −x, y, z)
and similarly deﬁned maps R2, R3 (which are all involutions) send one Markoff
triple to another. Due to the symmetry of (1), the set M is also invariant under
permutations. Let S3 be the group of permutations of order 3. For σ ∈S3 we
denote by $σ the mapping π(x1, x2, x3) = (xσ(1), xσ(2), xσ(3)). It is easy to check
that the transformations Ri, i = 1, 2, 3 and the mappings $σ generate a group of
transformations acting on M.
A celebrated result of Markoff [18, 19] asserts that all integer positive solutions
to (1) can be generated from the solution (1, 1, 1) by using sequences of the above
transformations.
This naturally leads to the notion of the functional graph on Markoff triples
with the “root” (1, 1, 1) and edges (x1, y1, z1) →(x2, y2, z2), povided that
(x2, y2, z2) = T (x1, y1, z1), where
T ∈{R1, R2, R3} ∪{$σ : σ ∈S3}.
(2)
In this terminology, the result of Markoff [18, 19] asserts that this graph is
connected.
Baragar [1, Section V.3] and, more recently, Bourgain, Gamburd, and Sarnak [2,
3] conjecture that this property is preserved modulo all sufﬁciently large primes p
and the set of non-zero solutions Mp to (1) considered modulo p. In particular, this
means that Mp can be obtained from the set of Markoff triples M reduced modulo
p.
This conjecture, which we can also write as Mp = M (mod p), means that the
functional graph Xp associated with the transformation (2) remains connected.
Accordingly, if we deﬁne by Cp ⊆Mp the set of the triples in the largest
connected component of the above graph Xp, then we can state:
Conjecture 1.1 (Baragar [1]; Bourgain, Gamburd, and Sarnak [2, 3]) For every
prime p, we have Cp = Mp.

Polynomial Equations in Subgroups
275
Bourgain, Gamburd, and Sarnak [2, 3] have obtained several major results
towards Conjecture 1.1; see also [4, 8, 9, 11]. For example, by [2, Theorem 1], we
have
#

Mp \ Cp

= po(1),
as p →∞,
(3)
and also by [2, Theorem 2], we know that Conjecture 1.1 holds for all but maybe at
most Xo(1) primes p ≤X as X →∞.
The bound (3) has been improved in [16, Theorem 1.2] as
#

Mp \ Cp

≤exp

(log p)2/3+o(1)
,
as p →∞.
(4)
Furthermore, Bourgain, Gamburd, and Sarnak [2, 3] have also proved that the
size of any connected component of the graphs Xp is at least
#Xp ≥c(log p)1/3,
(5)
for some absolute constant c > 0. In turn, the bound (5) has been improved in [16,
Theorem 1.3] as
#Xp ≥c(log p)7/9.
(6)
The improvements in (4) and (6) are based on a bound of Corvaja and Zannier [7,
Corollary 2], on the number of solutions to the equation
P(u, v) = 0,
(u, v) ∈G1 × G2,
where P is a bivariate absolutely irreducible polynomial over the ﬁnite ﬁeld Fp of
p elements and G1, G2 ⊆Fp are multiplicative groups in the algebraic closure Fp
of Fp; see also [12, 14, 17, 20] for some related results.
Motivated by the above results and connections, here we
•
Derive a new bound on the number of solutions in subgroups to a systems of
several polynomials which covers under a uniﬁed setting the results of [7, 17, 20];
•
Obtain an improvement of (4) under a very plausible conjecture on the number
of solutions in subgroups of some particular equation over F∗
p.
1.2
New Results
As before, for a prime p, we use Fp to denote the algebraic closure of the ﬁnite ﬁeld
Fp of p elements.
We also say that a polynomial is irreducible if and only it is absolutely
irreducible.

276
S. V. Konyagin et al.
For a bivariate irreducible polynomial
P(X, Y) =

i+j≤d
aijXiY j ∈Fp[X, Y]
(7)
of total degree deg P ≤d, we deﬁne P ♯(X, Y) as the homogeneous polynomial of
degree d♯= min{i + j : aij ̸= 0} given by
P ♯(X, Y) =

i+j=d♯
aijXiY j.
(8)
We also consider the set of polynomials P:
P = {P(λX, μY) | λ, μ ∈F
∗
p}.
Since P(X, Y) is irreducible, it is not homogenous, and thus P(X, Y) ̸= P ♯(X, Y).
Hence, we can deﬁne g as the greatest common divisor of the following set of
differences:
g = gcd{i1 + j1 −i2 −j2 : ai1,j1ai2,j2 ̸= 0}.
(9)
Given a multiplicative subgroup G ⊆Fp, we say that two polynomials P, Q ∈
Fp[X, Y] are G-independent if there is no (u, v) ∈G2 and γ ∈F
∗
p such that
polynomials P(X, Y) and γ Q(uX, vY) coincide.
We now ﬁx h polynomials
Pk(X, Y) = P(λkX, μkY) ∈P,
k = 1, . . . , h,
(10)
which are G-independent.
The following result generalizes a series of previous estimates of a similar type;
see [7, 12, 14, 17, 20] and references therein.
Theorem 1.2 Suppose that P is irreducible,
degX P = m
and
degY P = n
and also that P ♯(X, Y) consists of at least two monomials. There exists a constant
c0(m, n), depending only on m and n, such that for any multiplicative subgroup
G ⊆Fp of order t = #G satisfying
1
2p3/4h−1/4 ≥t ≥max{h2, c0(m, n)},
and G-independent polynomials (10) we have

Polynomial Equations in Subgroups
277
h

i=1
#
%
(u, v) ∈G2 : Pi(u, v) = 0
&
< 12mn(m + n)gh2/3t2/3.
Our next result is conditional on the following:
Conjecture 1.3 There exist constants ε0 > 0 and A such that for any prime p,
any subgroup G ⊆Fp with #G ≤pε0, and any elements α1,1, α1,2, α2,1, α2,2 ∈Fp
satisfying
α1,1 ̸= 0,
α1,2 ̸= 0,
α1,1α2,2 −α1,2α2,1 ̸= 0,
(11)
the equation
α1,1u −α1,2
α2,1u −α2,2
= v
(12)
has at most A solutions in u, v ∈G.
Remark 1.4 It is likely that the constant A in Conjecture 1.3 cannot be taken less
than 9, even for G ⊆Fp rather than for G ⊆Fp; see some heuristic arguments in
Sect. 6. It is possible that this is optimal and Conjecture 1.3 holds with A = 9. Also
we must have ε0 ≤1/2; see Sect. 6.
Remark 1.5 It is easy to see that using the bound (4) instead of (3) in the argument
of the proof of Theorem 1.6 immediately allows us to relax the condition of
Conjecture 1.3 to counting solutions in subgroups G ⊆Fp2 of order #G ≤
exp

(log p)2/3+ε0
. However, we believe Conjecture 1.3 holds as stated.
Theorem 1.6 If Conjecture 1.3 holds for some ε0 and A, then for sufﬁciently large
p we have
#

Mp \ Cp

≤(log p)B,
where B = 16 log A + c for an absolute constant c.
Remark 1.7 Recently (after this work has been submitted) Chen [6] presented a
striking result giving a full resolution of Conjecture 1.1 (for all sufﬁciently large p).
However, we still believe that our present argument as well as the argument of [16]
are of interest since they apply to more general equations than (1), for example, to
equations of the form x2 + y2 + z2 = axyz + b, which the method of [6] is limited
to (1).

278
S. V. Konyagin et al.
2
Solutions to Polynomial Equations in Subgroups of Finite
Fields
2.1
Stepanov’s Method
Consider a polynomial  ∈Fp[X, Y, Z] such that
degX  < A,
degY  < B,
degZ  < C,
that is,
(X, Y, Z) =

0≤a<A

0≤b<B

0≤c<C
ωa,b,cXaY bZc.
We assume
A < t,
where t = #G is the order of the subgroup G ⊆F∗
p, and consider the polynomial
#(X, Y) = Y t(X/Y, Xt, Y t).
Clearly,
deg # ≤t + t(B −1) + t(C −1) = (B + C −1)t.
We now ﬁx some G-independent polynomials (10) and deﬁne the sets
Fk =

λ−1
k G × μ−1
k G

,
k = 1, . . . , h,
and
E =
h

k=1
Fk.
(13)
We also consider the locus of singularity
Msing =
#
(X, Y) | XY = P(X, Y) = 0 or
∂
∂Y P(X, Y) = P(X, Y) = 0
$
.
Lemma 2.1 Let P(X, Y) be an irreducible polynomial of bi-degree

degX P, degY P

= (m, n)
and let n ≥1. Then, for the cardinality of the set Msing, the following holds:
#Msing ≤(m + n)2.

Polynomial Equations in Subgroups
279
Proof If the polynomial P(X, Y) is irreducible, then the polynomials P(X, Y) and
∂P
∂Y (X, Y) are relatively prime. Thus, the Bézout theorem yields the bound L ≤
(m + n)(m + n −1), where L is the number of roots of the system
∂
∂Y P(X, Y) = P(X, Y) = 0.
Clearly, the number of X with P(X, 0) = 0 is less than or equal to degX P(X, Y) =
m, the number of pairs (0, Y) on the curve
P(X, Y) = 0,
(14)
where P is given by (7), is less than or equal to degY P(X, Y) = n. The total
numbers of such pairs is at most L + m + n ≤(m + n)2.
⊓⊔
Assume that the polynomial # and the G-independent polynomials (10) satisfy
the following conditions:
•
All pairs in the set
#
(X, Y) ∈E \ Msing | P(X, Y) = 0
$
are zeros of orders at least D of the function #(X, Y) on the curve (14);
•
The polynomials #(X, Y) and P(X, Y) are relatively prime.
If these conditions are satisﬁed, then the Bézout theorem gives us the upper bound
D−1 deg # deg P + #Msing for the number of roots (x, y) of the system
#(X, Y) = P(X, Y) = 0,
(X, Y) ∈G.
Since the polynomials Pk are G-independent, the sets Fk given by (13) are disjoint,
and also there is a one-to-one correspondence between the zeros:
Pk(X, Y) = 0, (X, Y) ∈G2,
⇐⇒P(u, v) = 0, (u, v) = (λ−1
k X, μ−1
k Y) ∈Fk.
Therefore, we obtain the bound
Nh ≤deg # · deg P
D
+ #Msing
≤(m + n)(B + C −1)t
D
+ #Msing
(15)
on the total number of zeros of Pk in G2, k = 1, . . . , h:

280
S. V. Konyagin et al.
Nh =
h

k=1
#{(u, v) ∈G2 : Pk(u, v) = 0}.
For completeness, we present proofs of several results from [17] which we use
here as well.
2.2
Some Divisibilities and Non-divisibilities
We begin with some simple preparatory results on the divisibility of polynomials.
Lemma 2.2 Suppose that Q(X, Y) ∈Fp[X, Y] is an irreducible G-independent
polynomial such that
Q(X, Y) | #(X, Y)
and Q♯(X, Y) consists of at least two monomials. Then,
Q♯(X, Y)⌊t/e⌋| #♯(X, Y),
where Q♯(X, Y) and #♯(X, Y) are deﬁned as in (8) and e is deﬁned as g in (9) with
respect to Q(X, Y) instead of P(x, y).
Proof Consider ρ ∈G and substitute X = ρI
X and Y = ρIY in the polynomials
Q(X, Y) and #(X, Y). Then,
Q(X, Y) −→Qρ(I
X, IY) = Q(ρI
X, ρIY),
and
#(X, Y) = #(ρI
X, ρIY)
= (ρIY)t((ρI
X)/(ρIY), (ρI
X)t, (ρIY)t) = #(I
X, IY),
because ρt = 1. Hence, for any ρ ∈G, we have
Qρ(X, Y) | #(X, Y),
and we also note that Qρ(X, Y) is irreducible.
Since Q(X, Y) is irreducible, e ⩾1 is correctly deﬁned, and there exist
at least s
= ⌊t/e⌋elements ρ1, . . . , ρs
∈G such that all nontrivial ratios
Qρi(X, Y)/Qρj (X, Y) are not constants, that is,
Qρi(X, Y)/Qρj (X, Y) /∈Fp,
1 ≤i < j ≤s.
(16)

Polynomial Equations in Subgroups
281
Obviously, the polynomials Qρ1(X, Y), . . . , Qρs(X, Y) are pairwise relatively
prime, because they are irreducible and satisfy (16). Furthermore, the polynomials
Q♯
ρi(X, Y) are homogeneous of degree d♯, and the following holds
Q♯(X, Y) = ρ−d♯
1
Q♯
ρ1(X, Y) = . . . = ρ−d♯
s
Q♯
ρs(X, Y).
So, we have
Qρ1(X, Y) · . . . · Qρs(X, Y) | #(X, Y);
consequently,
Q♯
ρ1(X, Y) · . . . · Q♯
ρs(X, Y) | #♯(X, Y).
Since
Q♯
ρ1(X, Y) · . . . · Q♯
ρs(X, Y) = (ρ1 · . . . · ρs)d♯Q♯(X, Y)s,
we obtain the desired result.
⊓⊔
Lemma 2.3 Let G(X, Y), H(X, Y) ∈Fp[X, Y] be two homogeneous polynomials.
Also suppose that G(X, Y) consists of at least two nonzero monomials, deg H < p,
and the number of monomials of the polynomial H(X, Y) does not exceed s for
some positive integer s < p. Then,
G(X, Y)s ∤H(X, Y).
Proof Clearly, if G(X, Y)s | H(X, Y), then G(X, 1)s | H(X, 1). The polynomial
G(X, 1) has at least one nonzero root. It has been proved in [14, Lemma 6] that
such a polynomial H(X, 1) cannot have a nonzero root of order s and the result
follows.
⊓⊔
Lemma 2.4 If AB < t/g and deg # < p, then for the polynomial P(X, Y) given
by (7) we have
P(X, Y) ∤#(X, Y).
2.3
Derivatives on Some Curves
There we study derivatives on an algebraic curve and deﬁne some special differential
operators. Throughout this section, we use

282
S. V. Konyagin et al.
∂
∂X,
∂
∂Y
and
d
dX
for standard partial derivatives with respect to X and Y and for the derivative with
respect to X along the curve (14), respectively. In particular,
d
dX = ∂
∂X + dY
dX
∂
∂Y ,
(17)
where by the implicit function theorem from the Eq. (14), we have
dY
dX = −
∂P
∂X(X, Y)
∂P
∂Y (X, Y)
.
We also deﬁne inductively
dk
dXk = d
dX
dk−1
dXk−1
the k-th derivative on the curve (14).
Consider the polynomials qk(X, Y) and rk(X, Y), k ∈N, which are deﬁned
inductively as
q1(X, Y) = −∂
∂XP(X, Y),
r1(X, Y) = ∂
∂Y P(X, Y),
and
qk+1(X, Y) = ∂qk
∂X
∂P
∂Y
2
−∂qk
∂Y
∂P
∂X
∂P
∂Y −(2k −1)qk(X, Y) ∂2P
∂X∂Y
∂P
∂Y
+ (2k −1)qk(X, Y)∂2P
∂Y 2
∂P
∂X,
rk+1(X, Y) = rk(X, Y)
∂P
∂Y
2
=
∂P
∂Y
2k+1
.
(18)
We now show by induction that
dk
dXk Y = qk(X, Y)
rk(X, Y) ,
k ∈N.
(19)
The base of induction is

Polynomial Equations in Subgroups
283
d
dX Y = −
∂
∂XP(X, Y)
∂
∂Y P(X, Y)
= q1(X, Y)
r1(X, Y) .
One can now easily verify that assuming (19) and (17) we have
dk+1
dXk+1 Y = d
dX
dk
dXk Y = d
dX
qk(X, Y)
rk(X, Y) = qk+1(X, Y)
rk+1(X, Y) ,
where qk+1 and rk+1 are given by (18), which concludes the induction and proves
the formula (19).
The implicit function theorem gives us the derivatives
dk+1
dXk+1 Y at a point (X, Y)
on the algebraic curve (14), if the denominator rk(X, Y) is not equal to zero.
Otherwise, rk(X, Y) = 0 if and only if the following system holds:
∂
∂Y P(X, Y) = P(X, Y) = 0.
Let us give the following estimates:
Lemma 2.5 For all integers k ≥1, the degrees of the polynomials qk(X, Y) and
rk(X, Y) satisfy the bounds
degX qk ≤(2k −1)m −k,
degY qk ≤(2k −1)n −2k + 2,
degX rk ≤(2k −1)m,
degY rk ≤(2k −1)(n −1).
Proof Direct calculations show that
degX q1 ≤m −1
and
degY q1 ≤n,
and using (18) (with k −1 instead of k) and examining the degree of each term, we
obtain the inequalities
degX qk ≤degX qk−1 + 2m −1 ≤(2k −1)m −k,
degY qk ≤degy qk−1 + 2n −2 ≤(2k −1)n −2k + 2.
We now obtain the desire bounds on degX qk and degY qk by induction.
For the polynomials rk, the statement is obvious.
⊓⊔
Lemma 2.6 Let Q(X, Y) ∈Fp[X, Y] be a polynomial such that
degX Q(X, Y) ≤μ,
degY Q(X, Y) ≤ν
(20)
and P(X, Y) ∈Fp[X, Y] be a polynomial such that

284
S. V. Konyagin et al.
degX P(X, Y) ≤m,
degY P(X, Y) ≤n.
Then, the divisibility condition
P(X, Y) | Q(X, Y)
(21)
on the coefﬁcients of the polynomial Q(X, Y) is equivalent to a certain system of not
more than (μ + ν + 1)mn homogeneous linear algebraic equations in coefﬁcients
of Q(X, Y) as variables.
Proof The dimension of the vector space L of polynomials Q(X, Y) that sat-
isfy (20) is equal to (μ + 1)(ν + 1). Let us call the vector subspace of polynomials
Q(X, Y) that satisfy (20) and (21) by I
L. Because Q(X, Y) = P(X, Y)R(X, Y)
where the polynomial R(X, Y) is such that
degX R(X, Y) ≤μ −m
and
degY R(X, Y) ≤ν −n,
(22)
then the vector space I
L is isomorphic to the vector space of the coefﬁcients of the
polynomials R(x, y) satisfying (22). The dimension of the vector space I
L is equal
to
dim I
L = (μ −m + 1)(ν −n + 1).
It means that the subspace I
L of the space L is given by a system of
(μ + 1)(ν + 1) −(μ −m + 1)(ν −n + 1)
= μn + νm −mn + m + n + 1 ≤(μ + ν + 1)mn
homogeneous linear algebraic equations.
⊓⊔
As in [17], we now consider the differential operators:
Dk =
∂P
∂Y
2k−1
XkY k dk
dXk ,
k ∈N,
(23)
where, as before,
dk
dXk denotes the k-th derivative on the algebraic curve (14) with the
local parameter X. We note now that the derivative of a polynomial in two variables
along a curve is a rational function. As one can see from the inductive formula for
dk
dXk , the result of applying any operator Dk to a polynomial in two variables is again
a polynomial in two variables.
Consider non-negative integers a, b, c such that a < A, b < B, c < C. From
the formulas (19) for derivatives on the algebraic curve (14), we obtain by induction
the following relations:

Polynomial Equations in Subgroups
285
Dk
X
Y
a
XbtY (c+1)t = Rk,a,b,c(X, Y)
X
Y
a
XbtY (c+1)t,
Dk#(X, Y)|X,Y∈Fi = Rk,i(X, Y)|X,Y∈Fi,
(24)
where Fi are from formula (13),
Rk,i(X, Y)
=

0≤a<A

0≤b<B

0≤c<C
ωa,b,cRk,a,b,c(X, Y)
X
Y
a
λ−bt
i
μ−(c+1)t
i
(25)
for some coefﬁcients ωa,b,c ∈Fp, a < A, b < B, c < C, and λi, μi from (13).
We now deﬁne
I
Rk,i(X, Y) = Y A−1Rk,i(X, Y).
(26)
Lemma 2.7 The rational functions Rk,a,b,c(X, Y) and I
Rk,i(X, Y), given by (24)
and (26), are polynomials of degrees
degX Rk,a,b,c ≤4km,
degY Rk,a,b,c ≤4kn,
and
degX I
Rk,i ≤A + 4km,
degY I
Rk,i ≤A + 4kn.
Proof We have
dk
dXk Xa+btY (c+1)t−a =

(ℓ1,...,ℓs)
Cℓ1,...,ℓsXa+bt−k+s
i=1 ℓi
Y (c+1)t−a−s
 dℓ1Y
dXℓ1

. . .
 dℓsY
dXℓs

,
(27)
where (ℓ1, . . . , ℓs) runs through all s-tuples of positive integers with ℓ1 +. . .+ℓs ≤
k, s = 0, . . . , k, and Cℓ1,...,ℓs are some constants.
By the formula (27) and the form of the operator (23), we obtain that
Rk,a,b,c(x, y) are polynomials and Rk,i(x, y) are rational functions. Actually, from
the formulas (27) and (19), we easily obtain that the denominator of
dk
dXk
X
Y
a
XbtY (c+1)t

286
S. V. Konyagin et al.
divides
 ∂P
∂Y (X, Y)
2k−1. Hence, we obtain that Rk,a,b.c(X, Y) are polynomials.
From the formula (25), we obtain that Rk,i is a rational function with denominator
divided by Y A−1. Consequently, I
Rk,i are polynomials.
The result now follows from Lemma 2.5 and the formulas (23) and (24).
⊓⊔
2.4
Multiplicity Points on Some Curves
We recall that Dk, k = 1, 2, . . . are the differential operators deﬁned by (23).
Lemma 2.8 If P(X, Y) | #(X, Y) and P(X, Y) | Dj#(X, Y), j = 1, . . . , k −1,
then at least one of the following alternatives holds:
•
either (x, y) is a root of order at least k of #(X, Y) on the algebraic curve (14).
•
or (x, y) ∈Msing.
Proof If Dj#(X, Y) vanishes on the curve P(X, Y) = 0, then either
dj
dXj #(x, y) = 0,
(28)
where, as before,
dj
dXj is j-th derivative on the algebraic curve (14) with the local
parameter X, or
xy = 0,
(29)
or
∂P
∂Y (x, y) = 0,
(30)
on the curve (14).
If we have (28) for j = 1, . . . , k −1 and also #(x, y) = 0, then the pair (x, y)
satisﬁes the ﬁrst case of conditions of Lemma 2.8.
If we have (29) or (30) on the curve (14), then the pair (x, y) satisﬁes the second
case of conditions of Lemma 2.8.
⊓⊔
3
Small Divisors of Integers
3.1
Smooth Numbers
As usual, we say that a positive integer is y-smooth if it is composed of prime
numbers up to y. Then, we denote by ψ(x, y) the number of y-smooth positive

Polynomial Equations in Subgroups
287
integers n ≤x. Among a large variety of bounds and asymptotic formulas for
ψ(x, y) (see [13, 15, 22]), the most convenient bound for our applications is given
by [22, Theorem 5.1].
Lemma 3.1 There is an absolute constant c0 such that for any ﬁxed real-positive
x ≥y ≥2, we have
ψ(x, y) ≤c0e−u/2x,
where
u = log x
log y .
3.2
Number of Small Divisors of Integers
For a real z and an integer n, we use τz(n) to denote the number of positive integer
divisors d | n with d ≤z. We present a bound on τz(n) for small values of z (which
we put in a slightly more general form than we need for our applications).
Lemma 3.2 There is an absolute constant C0 such that for any ﬁxed real-positive
ε < 1, there is n(ε) such that if n ≥n(ε) and z ≥(log n)2 log(1/ε), then
τz(n) ≤C0εz.
Proof Let s be the number of all distinct prime divisors of n, and let p1, . . . , ps be
the ﬁrst s primes. We note that
τz(n) ≤ψ(z, ps).
(31)
By the prime number theorem, we have n ≥p1 . . . ps = exp(ps + o(ps)), and
thus
ps ≪log n ≤z1/b,
(32)
where b = 2 log(1/ε). Combining Lemma 3.1 with (31) and (32), we see that
τz(n) ≤ψ(z, z1/b+o(1)) ≤c0e−b/2+o(1)z = (c0 + o(1))e−b/2z ≤C0εz
for any C0 > c0 (where c0 is as in Lemma 3.1), provided that n and thus z are large
enough.
⊓⊔

288
S. V. Konyagin et al.
4
Proof of Theorem 1.2
4.1
Preliminary Estimates
We deﬁne the following parameters:
A =
J t2/3
gh1/3
K
,
B = C =
6
h1/3t1/37
,
D =
J
t2/3
4gh1/3mn
K
.
The exact values of A, B, C, and D play no role until the optimization step at the
very end of the proof. However, it is important to note that their choice ensures (36)
and (37).
If Pi(x, y) = 0 for at least one i = 1, . . . , h, then
Dk#(x, y) = 0,
(x, y) ∈
h

i=1
Fi,
(33)
with the operators (23), where the sets Fi are as in (13). The condition (33) is given
by a system of linear homogeneous algebraic equations in the variables ωa,b,c. The
number of equations can be calculated by means of Lemmas 2.6 and 2.7. To satisfy
the condition (33) for some k, we have to make sure that the polynomials I
Rk,i(X, Y),
i = 1, . . . , h, given by (26), vanish identically on the curve (14). The bi-degree of
I
Rk,i(X, Y) is given by Lemma 2.7:
degX I
Rk,i ≤A + 4km,
degY I
Rk,i ≤A + 4kn.
The number of equations on the coefﬁcients that guarantee the vanishing of the
polynomial I
Rk,i(X, Y) on the curve (14) is given by Lemma 2.6 and is equal to
(μ + ν + 1)mn, where μ, ν are as in Lemma 2.6 and
μ ≤A + 4km,
ν ≤A + 4kn.
Finally, the condition (33) for some k is given by h(μ + ν + 1)mn ≤mnh(2A +
4k(m + n)) linear algebraic homogeneous equations. Consequently, the condi-
tion (33) for all k = 0, . . . , D −1 is given by the system of
L = hmn
D−1

k=0
(4k(m + n) + 2A + 1)
linear algebraic homogeneous equations in variables ωa,b,c. Now it is easy to see
that
L = h ((2A + 1)Dmn + 2nm(m + n)D(D −1))

Polynomial Equations in Subgroups
289
≤2hADmn + 2hmn(m + n)D2 = 2hmn(AD + (m + n)D2).
4.2
Optimization of Parameters
The system has a nonzero solution if the number of equations is less than to the
number of variables, in particular, if
2hmn(AD + (m + n)D2) < ABC,
(34)
as we have ABC variables. It is easy to get an upper bound for the left-hand
side of (34). For sufﬁciently large t > c0(m, n), where c0(m, n) is some constant
depending only on m and n, we have
2hmn(AD + (m + n)D2)
< 2hmn
h−1/3t2/3
g
h−1/3t2/3
4mng
+ (m + n) h−2/3t4/3
16m2n2g2

< 3
4
h1/3t4/3
g2
.
(35)
Assuming that c0(m, n) is large enough, we obtain
ABC =
Jh−1/3t2/3
g
K
⌊h1/3t1/3⌋2 > 3
4
h1/3t4/3
g2
,
which together with (35) implies (34).
It is clear that
gAB ≤t.
(36)
We also require that the degree of the polynomial #(x, y) should be less than p,
deg #(x, y) ≤(B −1)t + Ct < p.
(37)
Actually, the inequality (B −1)t + Ct < 2h1/3t4/3 < p is satisﬁed because t <
1
2p3/4h−1/4.
Finally, recalling Lemmas 2.2, 2.3 and 2.4, and also the irreducibility of the
polynomial P(x, y), we see that Pk(X, Y) and #(X, Y) are co-prime. Hence,
by Lemmas 2.1 and 2.8 and the inequality (15), we obtain that Nh satisﬁes the
inequality

290
S. V. Konyagin et al.
Nh ≤#Msing + (m + n)(B + C −1)t
D
< (m + n)2 + (m + n)
2h1/3t4/3
L
h−1/3t2/3/(4mng)
M
< 12mn(m + n)gh2/3t2/3
for sufﬁciently large t > c0(m, n), which concludes the proof.
5
Proof of Theorem 1.6
5.1
Outline of the Proof
Before giving technical details, we ﬁrst outline the sequence of the following
steps:
•
We consider the set R = Mp \Cp and show that if it is large then by Lemma 3.2
there is a large set L ⊆R elements of large orders.
•
Each element x ∈L has an orbit of size at least t(x)/2, which is also in R.
•
Using Conjecture 1.3, we estimate the size of intersections of these orbits for
distinct elements x1, x2 ∈L.
•
We conclude that all intersections together are small, and so to ﬁt all orbits in R,
the size of R must be even larger than we have initially assumed.
5.2
Formal Argument
We always assume that p is large enough. Deﬁne the mapping
T0 (x, y, z) →(x, z, 3xz −y) ,
where T0 = $1,3,2 ◦R2 is the composition of the permutations
$1,3,2 = (x, y, z) →(x, z, y)
and the involution
R2 : (x, y, z) →(x, 3xz −y, z)
as in the above.
Therefore, the orbit (x, y, z) of (x, y, z) under the above group of transforma-
tions  contains, in particular, the triples (x, un, un+1), n = 1, 2, . . ., where the

Polynomial Equations in Subgroups
291
sequence un satisﬁes a binary linear recurrence relation
un+2 = 3xun+1 −un,
n = 1, 2, . . . ,
(38)
with the initial values, u1 = y, u2 = z. This also means that (x, y, z) contains all
triples obtained by the permutations of the elements in (x, un, un+1).
Let ξ, ξ−1 ∈F∗
p2 be the roots of the characteristic polynomial Z2 −3xZ + 1
of the recurrence relation (38). In particular, 3x = ξ + ξ−1. Then, it is easy to see
that unless (x, y, z) = (0, 0, 0), which we eliminate from the consideration, the
sequence un is periodic with period t(x) which is the order of ξ in F∗
p2.
Let B be a ﬁxed positive number to be chosen later. We denote
M0 = (log p)B
and
M1 = M1/4
0
/3 = (log p)B/4/3.
Assume that the remaining set of nodes R = Mp \ Cp is of size #R > M0. Note
that if (x, y, z) ∈R, then also (y, x, z) ∈R, and for any x, y, there are at most
two values of z such that (x, y, z) ∈R. Therefore, there are more than (M0/2)1/2
elements x ∈F∗
p with (x, y, z) ∈R for some y, z ∈Fp.
Since there are obviously at most T (T + 1)/2 elements ξ ∈F∗
p2 of order at most
T , we conclude that there is a triple (x∗, y∗, z∗) ∈R with
t(x∗) >
A
(M0/2)1/2 > 2M1,
(39)
where t(x∗) is the period of the sequence un which is deﬁned as in (38) with respect
to (x∗, y∗, z∗).
Then, the orbit (x∗, y∗, z∗) of this triple has at least 2M1 elements. Let M
be the cardinality of the set X of projections along the ﬁrst components of all
triples (x, y, z) ∈(x∗, y∗, z∗). Since the orbits are closed under the permutation
of coordinates and permutations of the triples
(x∗, un, un+1),
n = 1, . . . , t(x∗),
where as above the sequence un is deﬁned as in (38) with respect to (x∗, y∗, z∗) and
t(x∗) is its period, produce the same projection no more than twice, we obtain
M ≥1
2t(x∗).
(40)
Recalling (39), we obtain
M > M1 = (log p)B/4/3.
(41)
Using that (x, y, z) ̸∈Mp, we notice that by the bound (3),

292
S. V. Konyagin et al.
M = po(1).
(42)
For t | p2 −1, we denote g(t) the number of x ∈X for which the period of the
sequence un deﬁned as in (38) satisﬁes t(x) = t. Observe that

t|p2−1
g(t) = M.
The same argument as used in the bound (40) implies that
g(t) = 0
for
t > 2M.
(43)
We apply Lemma 3.2 with
ε =
1
40AC0
,
(44)
where A is a bound from Conjecture 1.3 and C0 is as in Lemma 3.1. Take
B = 16 log(1/ε) + 1.
(45)
Since g(t) < t for any t and also since due to (41) we have
4
√
AM > (log p)B/8 ≥(log(p2 −1))2 log(1/ε),
by Lemma 3.2,

t≤4
√
AM
t|p2−1
g(t) <

t≤4
√
AM
t|p2−1
t ≤4
√
AMτ4
√
AM(p2 −1)
≤C0ε(4
√
AM)2 = 0.4M.
Hence, we conclude that

t>4
√
AM
t|p2−1
g(t) ≥0.6M.
Let L be the set of x ∈X with t(x) > 4
√
AM. We have shown that
#L ≥0.6M.
(46)
For each x ∈L, we ﬁx some y, z ∈Fp such (x, y, z) ∈(x∗, y∗, z∗) and again
consider the sequence un, n = 1, 2, . . ., given by (38) having the period t(x) = t0,

Polynomial Equations in Subgroups
293
so we consider the set
Z(x) = {un : n = 1, . . . , t0}.
Let Hx be the subgroup of F∗
p2 of order t(x) and ξ(x) satisfy the equation
3x = ξ(x) + ξ(x)−1. One can easily check, using an explicit expression for binary
recurrence sequences via the roots of the characteristic polynomial, that
Z(x) =
!
α(x)u + r(x)
α(x)u : u ∈Hx
=
,
where
r(x) = (ξ(x)2 + 1)2
9(ξ(x)2 −1)2 ,
and α(x) ∈F∗
p2. If for some r an element ξ = ξ0 satisﬁes the equation
r = (ξ2 + 1)2
9(ξ2 −1)2 ,
then other solutions are −ξ0, 1/ξ0, −1/ξ0. Moreover, 3x = ξ + ξ−1 can take, for a
ﬁxed r, at most two values whose sum is 0. Since every value is taken at most twice
among the elements of the sequence un, n = 1, . . . , t(x), we have
#Z(x) ≥1
2t(x) > 2
√
AM.
(47)
Now we construct a set L∗⊆L. If x, x∗∈L and x + x∗= 0, then we put one
of the elements x, x∗in L∗. If x ∈L and −x ̸∈L, then we set x ∈L∗. Due to (46),
we get
#L∗≥0.3M.
(48)
Moreover, for any distinct x, x∗∈L∗, we have x+x∗̸= 0 and, hence, r(x) ̸= r(x∗).
We claim that under Conjecture 1.3 for any distinct x, x∗∈L∗, the inequality
#

Z(x)

Z(x∗)

≤2A
(49)
holds.
Indeed, take distinct elements x, x∗∈L∗. By G, we denote the subgroup of F∗
p2
generated by Hx and Hx∗. Notice that due to (42) and (43), we have
#G = po(1).
(50)

294
S. V. Konyagin et al.
Next, #(Z(x) ∩Z(x∗) is the number of solutions to the equation
α(x)u + r(x)
α(x)u = α(x∗)v + r(x∗)
α(x∗)v ,
(u, v) ∈Hx × Hx∗,
as in the above or, equivalently,
Px,x∗(u, v) = 0,
(u, v) ∈Hx × Hx∗,
where
Px,x∗(X, Y) = α(x)2α(x∗)X2Y −α(x)α(x∗)2XY 2
−α(x)r(x∗)X + α(x∗)r(x)Y.
The number of solutions to the last equation in (u, v) ∈Hx × Hx∗does not exceed
the number of solutions in (u, v) ∈G2. Let Z = X/Y. Then, the equation is reduced
to
α(x)2α(x∗)Z −α(x)α(x∗)2
α(x)r(x∗)Z −α(x∗)r(x)
= U,
(51)
where U = Y −2Z−1.
Now we are in position to use Conjecture 1.3. The conditions (11) on the
coefﬁcients of linear functions in the numerator and in the denominator of the
fraction in (51) are satisﬁed since α(x) ̸= 0, α(x∗) ̸= 0, and r(x) ̸= r(x∗).
Also, for large p we have #G ≤pε0 due to (50). By Conjecture 1.3, Eq. (51) has
at most A solutions in Z, Y. For each solution, there are at most two possible values
of Y. Fixing Y, we determine X. So, the inequality (49) holds.
Denote
h = [
@
M/A] + 1.
Due to (41) and (48), we have #L∗≥h provided that p is large enough. We choose
h elements x1, . . . , xh from L∗. It follows from (49) that for j = 1, . . . , h we have
j−1

i=1
#

Z

xj
 
Z (xi)

≤2(j −1)A,
which implies by (47)
#
⎛
⎝Z

xj

\
j−1

i=1
Z (xi)
⎞
⎠≥2
√
AM −2(j −1)A.

Polynomial Equations in Subgroups
295
Observe that
#
⎛
⎝
h

j=1
Z

xj

⎞
⎠=
h

j=1
#
⎛
⎝Z

xj

\
j−1

i=1
Z (xi)
⎞
⎠.
Hence,
#
⎛
⎝
h

j=1
Z

xj

⎞
⎠> 2
√
AMh −(h −1)hA
= (2
√
AM −(h −1)A)h
> (2
√
AM −
√
AM)
@
M/A > M,
but this inequality contradicts the deﬁnition of M. Together with the choice of B
given by (44) and (45), this concludes the proof.
6
Comments
Let P(n) be the largest primitive prime divisor of 2n −1, that is, the largest prime
which divides 2n −1, but does not divide any of the numbers 2d −1 for 1 ≤d < n.
Note that P(n) ≡1 (mod n). By a striking result of Stewart [21, Theorem 1.1], we
have
P(n) ≥n exp

log n
104 log log n

,
provided that n is large enough. It is also natural to assume that log P(n)/ log n →
∞for n →∞. However, for us a weaker assumption is sufﬁcient. Namely, assume
that
lim sup log P(24m)
log m
= ∞.
We then take n = 24m, m ∈N, and p = P(n) such that n = po(1). Then, p ≡1
(mod 24). Since 2 is a quadratic residue modulo p, we can take ξ ∈Fp such that
ξ2 = 2. We consider a group G generated by ξ. Note that #G = 2n = po(1) as
n →∞. The group G contains an element ζ4 of order 4 and an element ζ6 of order
6. It is easy to check that
((±ζ4 ± 1)/ξ)8 = 1.

296
S. V. Konyagin et al.
Thus,
(±ζ4 ± 1)2n = ξ6n = 1.
Hence, ±ζ4 ± 1 ∈G. Also,
(±ζ6 −1)3 = 1.
Hence, similarly ±ζ6 −1 ∈G. Consider a set D consisting of 9 elements
D = {(p −1/2), 1, −2, ζ4, −ζ4, ζ4 −1, −ζ4 −1, ζ6 −1, −ζ6 −1}.
Clearly, x ∈G, x + 1 ∈G for any x ∈D. This shows that probably A in
Conjecture 1.3 should be at least 9.
We also observe that in Conjecture 1.3 the value of ε0 cannot be taken greater
than 1/2.
Indeed, suppose that p is a prime and p −1 has a divisor t = pε0+o(1), as
p →∞with a ﬁxed ε0 > 1/2 (the inﬁnitude of such primes follows instantly
from [10, Theorem 7]).
Let us ﬁx any α1,1, α1,2, α2,1, α2,2 ∈Fp. Clearly, the Eq. (12) has N = p+O(1)
of solutions (u, v) ∈

F∗
p
2
. Let G ⊆F∗
p be a subgroup of order t. Since F∗
p is the
union of (p −1)/t cosets aG of G, the direct product F∗
p × F∗
p is the union of
(p −1)2/t2 products of cosets of G. By the Dirichlet principle is that there is at
least one product aG ×bG such that the number of solutions (u, v) ∈aG ×bG (with
some a, b ∈F∗
p) is not less than
N
(p −1)2/t2 ≥(1 + o(1))t2/p ≥p2ε0−1+o(1)
and hence is not bounded as p →∞. Changing the variables Iu = a−1u, Iv = b−1v
in (12) we obtain another equation of the same type
α1,1ab−1Iu −α1,2b−1
α2,1aIu −α2,2
= Iv
with an unbounded number of solutions (Iu,Iv) ∈G2.
Finally, we note that using [5, Theorem 1.2] one concludes that Conjecture 1.3
holds (in much stronger and general form) for a sequence of primes of relative
density 1. However, this does not give any new results for the sets Mp because,
as we mentioned, Bourgain, Gamburd, and Sarnak [2, Theorem 2] have already
shown that Conjecture 1.1 holds for an overwhelming majority of primes p ≤X as
X →∞.

Polynomial Equations in Subgroups
297
Acknowledgments The authors are very grateful to William Chen for clarifying discussion
concerning his work [6] and to the referee for the careful reading of the manuscript and valuable
remarks.
This work was supported by the Australian Research Council Grants DP180100201 and
DP200100355 (Shparlinski) and by the Russian Science Foundation Grant 19-11-00001 (Vyugin).
References
1. Baragar, A.: The Markoff equation and equations of Hurwitz. Ph.D. Thesis, Brown University,
1991
2. Bourgain, J., Gamburd, A., Sarnak, P.: Markoff triples and strong approximation. C. R. Acad.
Sci. Paris, Ser. I 354, 131–135 (2016)
3. Bourgain, J., Gamburd, A., Sarnak, P.: Markoff surfaces and strong approximation, I. Preprint
(2016). http://arxiv.org/abs/1607.01530
4. Cerbu, A., Gunther, E., Magee, M., Peilen, L.: The cycle structure of a Markoff automorphism
over ﬁnite ﬁelds. J. Number Theory 211, 1–27 (2020)
5. Chang, M.-C., Kerr, B., Shparlinski, I., Zannier, U.: Elements of large order on varieties over
prime ﬁnite ﬁelds. J. Théor. Nombres Bordeaux 26, 579–593 (2014)
6. Chen, W.: Nonabelian level structures, Nielsen equivalence, and Markoff triples. Preprint
(2020). http://arxiv.org/abs/2011.12940
7. Corvaja, P., Zannier, U.: Greatest common divisors of u −1, v −1 in positive characteristic
and rational points on curves over ﬁnite ﬁelds. J. Eur. Math. Soc. 15, 1927–1942 (2013)
8. de Courcy-Ireland, M., Lee, S.: Experiments with the Markoff surface. Experimental Math.
(2018), (to appear)
9. de Courcy-Ireland, M., Magee, M.: Kesten-McKay law for the Markoff surface modp.
Annales Henri Lebesgue (to appear)
10. Ford, K.: The distribution of integers with a divisor in a given interval. Annals Math. 168,
367–433 (2008)
11. Gamburd, A., Magee, M. and Ronan, R.: An asymptotic formula for integer points on Markoff-
Hurwitz varieties. Annals Math., 190, 751–809 (2019)
12. Garcia, A., Voloch, J.F.: Fermat curves over ﬁnite ﬁelds. J. Number Theory 30, 345–356 (1988)
13. Granville, A.: Smooth numbers: Computational number theory and beyond. Algorithmic
Number Theory: Lattices, Number Fields, Curves, and Cryptography, pp. 267–322. Cambridge
University Press (2008)
14. Heath-Brown, D.R., Konyagin, S.V.: New bounds for Gauss sums derived from kth powers,
and for Heilbronn’s exponential sum. Quart. J. Math. 51, 221–235 (2000)
15. Hildebrand, A., Tenenbaum, G.: Integers without large prime factors. J. Théorie des Nombres
de Bordeaux 5, 411–484 (1993)
16. Konyagin, S.V., Makarychev, S.V., Shparlinski, I.E., Vyugin, I.V.: On the structure of graphs
of Markoff triples. Quart. J. Math. 71, 637–648 (2020)
17. Makarychev, S.V., Vyugin, I.V.: Solutions of polynomial equations in subgroups of Fp. Arnold
Math J. 5, 105–121 (2019)
18. Markoff, A.: Sur les formes quadratiques binaires indéﬁnies. Math. Ann. 15, 381–409 (1879)
19. Markoff, A.: Sur les formes quadratiques binaires indéﬁnies. Math. Ann. 17, 379–399 (1880)
20. Shkredov, I.D., Vyugin, I.V.: On additive shifts of multiplicative subgroups. Mat. Sb. 203, 81–
100 (2012) (in Russian)
21. Stewart, C.L.: On divisors of Lucas and Lehmer numbers. Acta Math. 211, 291–314 (2013)
22. Tenenbaum, G.: Introduction to analytic and probabilistic number theory. Grad. Studies Math.,
vol. 163. Amer. Math. Soc. (2015)

Exponential Sums, Twisted
Multiplicativity, and Moments
E. Kowalski and K. Soundararajan
Dedicated to the memory of Jean Bourgain
Abstract We study averages over squarefree moduli of the size of exponential sums
with polynomial phases. We prove upper bounds on various moments of such sums,
and obtain evidence of un-correlation of exponential sums associated to different
suitably unrelated and generic polynomials. The proofs combine analytic arguments
with the algebraic interpretation of exponential sums and their monodromy groups.
1
Introduction
Some of Jean Bourgain’s many interactions with number theory involved exponen-
tial sums in different ways. Among these, one can mention his ground-breaking use
of ideas from the circle method to solve Bellow’s problems concerning pointwise
ergodic theorems at times f (n), where f
∈Z[X] is a polynomial (see, in
particular, [5–7]) or its combination with bilinear forms in joint works with A.
Kontorovich to study some aspects of the sieve in orbits beyond a simple appeal
to expansion and spectral gaps (see, for instance, [8]). We respectfully dedicate this
paper to his memory.
E. Kowalski ()
ETH Zürich—D-MATH, Zürich, Switzerland
e-mail: kowalski@math.ethz.ch
K. Soundararajan
Department of Mathematics, Stanford University, Stanford, CA, USA
e-mail: ksound@stanford.edu
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
A. Avila et al. (eds.), Analysis at Large, https://doi.org/10.1007/978-3-031-05331-3_13
299

300
E. Kowalski and K. Soundararajan
1.1
Exponential Sums with Polynomials
This paper is primarily concerned with exponential sums with polynomial phases.
Let f ∈Z[X] be a non-constant polynomial with degree d. For q ⩾1 squarefree
and a coprime to q, we deﬁne
W(a; q) = Wf (a; q) =
1
√q

x (mod q)
e
af (x)
q

,
where the sum is over residue classes modulo q. For simplicity, we restrict attention
to squarefree q and set W(a; q) = 0 if q is not squarefree or if (a, q) > 1.
An application of the Chinese Remainder Theorem shows that the exponential
sums W(a; q) satisfy the following “twisted multiplicativity”: if (q1, q2) = 1, then
W(a; q1q2) = W(a ¯q1; q2)W(a ¯q2; q1),
where q1 ¯q1 ≡1 mod q2 and q2 ¯q2 ≡1 mod q1. Apart from ﬁnitely many primes,
the Weil bound gives |W(a; p)| ⩽(d −1), so that |W(a; q)| ≪(d −1)ω(q) where
ω(q) denotes the number of (distinct) prime factors of q. It follows that

q⩽x
|W(a; q)| ≪

q⩽x
(d −1)ω(q) ≪x(log x)d−2,
and we seek an improvement over this “trivial” bound, as well as bounds for
related mean values such as 
q⩽x |W(a; q)|2. The possibility of obtaining such
improvements was ﬁrst recognized by Hooley and explored further in the work of
Fouvry and Michel [13].
One of our main theorems gives a reﬁnement of these earlier results. Given a ﬁeld
K, we say that a polynomial f ∈K[X] is decomposable if there are polynomials g
and h in K[X], both with degree ⩾2, such that f = g ◦h. If f cannot be expressed
as such a composition, we call f indecomposable.
Theorem 1.1 Let f ∈Q[X] be an indecomposable polynomial with deg(f ) = d ⩾
3.
(1) For any a ⩾1,

q⩽x
|W(a; q)|2 ≪x(log log x)(d−1)2.
(2) There exists γ > 0, depending only on d, such that for any a ⩾1,

q⩽x
|W(a; q)| ≪
x
(log x)γ .

Exponential Sums, Twisted Multiplicativity, and Moments
301
Remark 1.2 The implied constants above (and in what follows) are allowed to
depend on f . Throughout, we ignore linear polynomials where W(a; q) is usually
0 and quadratic polynomials where |W(a; q)| is usually 1 (since these are quadratic
Gauss sums).
One can compute effectively a possible value of the constant γ (see Remark 5.4).
The possibility of obtaining non-trivial bounds for

q⩽x
|W(a; q)|
(with f allowed to be a rational function) was ﬁrst pointed out by Hooley in [18] in
the case of Kloosterman sums. Introducing ideas from algebraic geometry (notably
from the work of Katz [22]), Fouvry and Michel [13] reﬁned and extended Hooley’s
work to more general exponential sums. Under a hypothesis that the polynomial f is
generic (in a sense to be made precise below; see [13, H.1, H.2, H.3, H.3’]; note that
in fact Fouvry and Michel consider rational functions and not only polynomials),
Fouvry and Michel proved in [13, Th. 1.5] that

q⩽x
|W(a; q)| ≪x(log log x)kf −1
(1)
for some explicit integer kf ⩾1. Theorem 1.1 reﬁnes this in two ways. Firstly,
it applies to a larger class of polynomials f , with the much simpler criterion of
being indecomposable. For instance, if the degree d ⩾3 of f is prime, then f is
automatically indecomposable, so that our result applies, but any polynomial f such
that f ′ has a multiple root, say f = X3g for some g of degree d −3, fails to satisfy
the condition H.1 of [13], since the zeros of f ′ are not simple. On the other hand, it
is elementary to check that a polynomial f satisfying the conditions H.1, H.2, H.3
(or H.3’) is indecomposable (see Lemma 6.1 below, combined with Remark 1.10
for the terminology). Secondly, part (2) of the theorem improves on (1) qualitatively
by showing that the average of |W(a; q)| over q ⩽x tends to 0, which does not
follow from the method of Fouvry and Michel.
The proof of the second part of Theorem 1.1 relies on the following result, which
may be of independent interest.
Theorem 1.3 Let f ∈Z[X] of degree d ⩾3. Then, one of the following two
possibilities holds:
(1) The limit
lim
p→+∞
1
p

a∈F×p
|W(a; p)|4
exists and equals 2.
(2) There exists δ > 0 (depending only on d) and a subset of primes with positive
density ⩾δ on which

302
E. Kowalski and K. Soundararajan
1
p

a∈F×p
|W(a; p)|4 ⩾3 + O(p−1/2).
For a generic (again in a sense to be made precise later) polynomial f , the ﬁrst
case of the theorem holds.
Remark 1.4
(1) The work of Katz [21] contains material from which it is likely that one can
deduce Theorem 1.3. However, in view of the different focus and the generality
of [21], our independent and slightly more elementary proof seems worth
including.
(2) Using the method of [13, § 4], one can show that

q⩽x
|W(a; q)| ≫
x
log x
(or even a slightly better lower bound), and it is a natural question to ask whether
there exists a constant δ > 0 such that
x
(log x)δ+ε ≪

q⩽x
|W(a; q)| ≪
x
(log x)δ−ε
(2)
for any ε > 0. This is an open problem; in Remark 3.6, we will mention
a potential candidate value of δ, at least for the upper bound for generic
polynomials.
(3) It might be possible to extend Theorem 1.1 to certain rational functions, but
some additional work is required (e.g., to properly understand the analogue of
indecomposability for rational functions and to extend [22, Lemma 7.7.5]).
1.2
Sums of Twisted Multiplicative Functions
A key feature of the exponential sums considered above is their twisted multiplica-
tivity. In this section, we formulate, following Hooley [18], Fouvry and Michel [13],
and our own recent paper [26], a general result on bounding averages of twisted
multiplicative functions.
Suppose we are given a function V that associates to each prime p and each
reduced residue class a (mod p) a complex number V (a; p). Extend this to a
function V (a; q) where q is squarefree and a (mod q) is a reduced residue class
by “twisted multiplicativity”: that is, if q = q1q2 with (q1, q2) = 1, then
V (a; q1q2) = V (a ¯q1; q2)V (a ¯q2; q1).
(3)

Exponential Sums, Twisted Multiplicativity, and Moments
303
Set V (a; q) = 0 if q is not squarefree, or if a is not coprime to q. For each prime
p, let G(p) ⩾g(p) ⩾0 be such that
max
(a,p)=1 |V (a; p)| ⩽G(p),
and
1
p

(a,p)=1
|V (a; p)| ⩽g(p).
(4)
Extend g and G to all squarefree integers using multiplicativity, so that (4) remains
valid for all q.
The question then is to obtain, under suitable conditions, a bound for

q⩽x
|V (a; q)|
that improves upon the trivial bound

q⩽x
|V (a; q)| ⩽

q⩽x
G(q).
Theorem 1.5 Let M > 0 be such that G(p) ⩽M for all primes p. Then, for any
ﬁxed integer a ⩾1 and for all large x, we have

q⩽x
|V (a; q)| ≪
x
log x

p⩽x

1 + g(p)
p

(log log x)M,
where the implied constant may depend on M.
Remark 1.6
(1) The twisted multiplicativity (3) is naturally connected to the Chinese Remainder
Theorem via the Fourier transform. Suppose that for each prime p and any
residue class a (mod p), we are given a complex number v(a; p). We extend
v to squarefree moduli q and any residue class a (mod q) by means of the
Chinese Remainder Theorem: that is, we set
v(a; q) =

p|q
v(a; p).
Consider now the Fourier transform of v:
V (a; q) =

b (mod q)
v(b; q)e(ab/q).
Then, V (a; q) satisﬁes the twisted multiplicative relation (3).
If v(a; p) corresponds to a probability measure (thus all v(a; p) are non-
negative and 
a v(a; p) = 1), then |V (a; p)| ⩽1 for all a (mod p), so that
we may use G(p) = 1. Bounding the L1-norm by the L2-norm, we may take

304
E. Kowalski and K. Soundararajan
g(p) =
 1
p
p−1

a=1
|V (a; p)|2 1
2 =

p

a=1
|v(a; p)|2 −1
p
 1
2 ,
upon using Parseval.
(2) In the applications to equidistribution in [26], the functions that occur are Weyl
sums of the form
V (a; q) =
1
ϱ(q)

x∈Aq
e
a · x
q

for some h ∈Zn \ {0}, where Aq ⊂(Z/qZ)n are non-empty sets “deﬁned by
the Chinese Remainder Theorem”, and ϱ(q) = |Aq|.
1.3
Non-correlation of Exponential Sums for Different
Polynomials
Our next results are attempts to establish that the exponential sums associated to two
different polynomials f and g are uncorrelated. Here we use the notation Wf (a; q)
instead of W(a; q) to keep track of the dependency on the polynomial. The results
here will depend on polynomials being suitably generic (as in the work of Fouvry
and Michel [13] mentioned earlier), and we begin by making this notion precise.
Deﬁnition 1.7 (Morse Polynomial) Let K be a ﬁeld. A polynomial f ∈K[X]
of degree d ⩾1 is called Morse if it has no repeated roots, its derivative f ′ is
squarefree of degree d −1, and the values of f at the zeros of f ′ (in an algebraic
closure of K) are distinct.
Remark 1.8 The values of f at the zeros of the derivative of f are known as critical
values of f . Note that when f ′ is even, the critical values appear in pairs a + f (0),
−a + f (0) where a is a critical value of f (x) −f (0).
If d is smaller than the characteristic of K, then the condition that deg(f ′) =
d −1 is automatically fulﬁlled.
If f is a Morse polynomial, then 0 is not a critical value of f (since there would
then be a double zero).
We recall that in an abelian group A, a subset S ⊂A is called Sidon if the
equation a + b = c + d with (a, b, c, d) ∈S4 has only the obvious solutions where
a ∈{c, d}.
We will say that S ⊂A is a symmetric Sidon set if there exists α ∈A such that
S = α −S, and the equation a + b = c + d with (a, b, c, d) ∈S4 has only the
obvious solutions where a ∈{c, d} or b = α −a.
We require one last item of terminology. For any ﬁeld K, two polynomials f
and g in K[X] are linearly equivalent over K if there exist a, b, c, d in K, with a

Exponential Sums, Twisted Multiplicativity, and Moments
305
and c non-zero, such that
g(X) = af (cX + d) + b.
Note that the sets Vf and Vg of critical values of f and g are then related by
Vg = aVf + d.
In particular, if Vf is a Sidon set (resp. a symmetric Sidon set), then so is Vg.
Deﬁnition 1.9 (Sidon–Morse Polynomial) Let K be a ﬁeld. A polynomial f ∈
K[X] of degree d ⩾2 is called Sidon–Morse if it is Morse and one of the following
holds:
(1) The set of critical values of f is a Sidon set in the additive group of K.
(2) The polynomial f is linearly equivalent to an odd polynomial g, and the set of
critical values of g is a symmetric Sidon set in K.
For a polynomial f ∈A[X], with A an integral domain, we say that f is Morse
(or Sidon–Morse) if the deﬁnition is satisﬁed for the ﬁeld of fractions of A.
Remark 1.10 (1) To distinguish between the two alternatives above, we will say
that f is a symmetric Sidon–Morse polynomial in the second case.
(2) It would seem to be more natural to deﬁne a symmetric Sidon polynomial to be
one where the set of critical values of f is a symmetric Sidon set. This condition
is implied by our deﬁnition, and it may in fact be that this is an equivalent
deﬁnition (at least over Q), but we do not know if this is the case. We will see
how, at some crucial point in the proof of Theorem 6.3 below, this alternative
deﬁnition is not sufﬁcient to proceed.
(3) Any polynomial f of degree d ⩾3 in Z[X] whose derivative has Galois group
Sd−1 is a (non-symmetric) Sidon–Morse polynomial over Q (see [22, proof of
Th. 7.10.6]). It is then a Sidon–Morse polynomial over Fp for all but ﬁnitely
many p. In particular, a “generic” polynomial in Z[X], in a natural sense, is
Sidon–Morse over Q.
(4) The genericity conditions H.1, H.2, H.3 for f ∈Z[X] used by Fouvry and
Michel are equivalent to asking that f is a Sidon–Morse polynomial; if f
satisﬁes H.1, H.2, H.3’, then it is a symmetric Sidon–Morse polynomial (but
the converse is not always true, since H.3’ requires f to be odd, not merely
linearly equivalent to an odd polynomial).
Theorem 1.11
(1) Let f and g be polynomials in Z[X] with degree df ⩾3 and dg, respectively.
Assume that f is Sidon–Morse over Q and that df > dg. Then,

q⩽x
|Wf (a; q)Wg(a; q)|2 ≪x(log log x)A

306
E. Kowalski and K. Soundararajan
for some A depending only on df and dg, where the implied constant depends
on f and g.
(2) Let m ⩾1 be an integer and let f1, . . . , fm be polynomials of degrees
di = deg(fi) ⩾3. Assume that all fi are Sidon–Morse polynomials over Q
and moreover that, for any i ̸= j, the polynomials fi and fj are not linearly
equivalent over ¯Q.
Let s be the number of polynomials fi such that fi is a symmetric Sidon–Morse
polynomial of odd degree ⩾5. Then, for x ⩾2, we have

q⩽x
|W1(a; q) · · · Wm(a; q)| ≪
x
(log x)γ

q⩽x
|W1(a; q) · · · Wm(a; q)|2 ≪x(log log x)A

q⩽x
|W1(a; q) · · · Wm(a; q)|4 ≪x(log x)2m−s3s−1(log log x)A
for some γ > 0 and some A ⩾0 depending only on m and (d1, . . . , dm), where
Wi(a; q) = Wfi(a; q). The implied constants depend on the polynomials.
Remark 1.12
(1) Since the upper bounds for two polynomials essentially match those in The-
orem 1.1, this result suggests that the exponential sums are uncorrelated.
However, we cannot prove it rigorously, since we would need to prove some
matching lower bound, such as

q⩽x
|Wf (a; q)|4 ≫x(log log x)B
for any B ⩾1, for instance. The best current lower bound that we can achieve
in general (by adapting the method of Fouvry and Michel [13, §4]) is

q⩽x
|Wf (a; q)|4 ≫
x
log x (log log x)B
for any B ⩾1 (and the best upper bound that we can give for the last sum is

q⩽x
|Wf (a; q)|4 ≪x(log x)(log log x)A
for some A).
(2) In another paper, Fouvry and Michel [12, Th. 1.2, 1.3] proved that if f is a
Sidon–Morse polynomial, then there are inﬁnitely many squarefree integers q
with two prime factors such that

Exponential Sums, Twisted Multiplicativity, and Moments
307
|Wf (a; q)| ⩽q−β
where β > 0 depends only on the degree of f . It would be interesting to extend
this property to all indecomposable polynomials.
1.4
Previous Work
Fouvry and Michel also consider rational functions and lower bounds. In the case
of the Kloosterman sums
Kl2(a; q) =
1
√q

(x,q)=1
e
ax + ¯x
q

(i.e., f (x) = x + 1/x), they obtain
x
log x exp((log log x)5/12) ≪

q⩽x
| Kl2(a; q)| ≪
x
(log x)δ
(5)
for any δ < 1 −
8
3π (see [13, Th. 1.2, 1.3]).
In this particular case, it is known that if we sum the Kloosterman sums without
taking absolute values, one can prove much stronger estimates using the spectral
theory of automorphic forms, like

q⩽x
Kl2(1; q) ≪x2/3+ε
for any ε > 0 (see, e.g., [19, §16.6]). Patterson [28] has also proved a strong result
for certain cubic sums, namely for any non-zero integer a, the asymptotic formula

q⩽x

0⩽n<q
e
an3
q

∼c(a)X4/3
holds for some explicit constant c(a) > 0, and Patterson [29, Conj. 2.2] has
conjectured similar asymptotic formulas for all cubic polynomials.
It would be of considerable interest to obtain general conditions on a twisted
multiplicative function V (a; q), bounded at primes, that ensure a power saving in
the sums

q⩽x
V (a; q).

308
E. Kowalski and K. Soundararajan
Outline of the Paper We prove Theorem 1.5 in the next section. Section 3 gathers
a number of properties of exponential sums with polynomials, and Sect. 4 uses these
results to prove Theorem 1.1, assuming Theorem 1.3. The latter is proved in Sect. 5,
and Sect. 6 discusses generic polynomials. In both of these, we rely heavily on the
foundational studies of Katz. Section 7 concludes with the proof of Theorem 1.11,
and Sect. 8 contains some hopefully enlightening comments concerning parts of the
results of Katz that we use.
2
Sums of Twisted Multiplicative Functions
Since the proof of Theorem 1.5 follows the broad plan of our earlier work (and is
not far from that of Fouvry and Michel [13, §3]), we shall be brief.
Put z = x1/(α log log x) with α = 3(M2 + 1). We factor any integer q ⩽x as
q = rs where all prime factors of s are ⩽z and all prime factors of r are > z. We
then have
V (a; q) = V (a; rs) = V (¯ra; s)V (¯sa; r)
by twisted multiplicativity; hence
|V (a; q)| ⩽G(r)|V (¯ra; s)|.
We handle ﬁrst the terms where s ⩽x1/3. We split the sum over q ⩽x according
to the residue class of r modulo s, getting

q⩽x
s⩽x1/3
|V (a; q)| ⩽

s⩽x1/3

r⩽x/s
G(r)|V (¯ra; s)| ⩽

s⩽x1/3

t (mod s)
|V (¯ta; s)|

r⩽x/s
r≡t (mod s)
G(r).
By Shiu’s work on the Brun–Titchmarsh theorem for multiplicative functions
(see [32, Th. 1]), we may bound the sum over r above by
≪
x/s
ϕ(s) log(x/s) exp
 
z<p⩽x
G(p)
p

≪
x
sϕ(s) log x
log x
log z
M
≪
x
sϕ(s) log x (log log x)M.
Therefore,

q⩽x
s⩽x1/3
|V (a; q)| ≪
x
log x (log log x)M 
s⩽x1/3
1
sϕ(s)

t (mod s)
|V (¯ta; s)|
≪
x
log x (log log x)M 
s⩽x1/3
g(s)
ϕ(s) ≪
x
log x (log log x)M 
p⩽x

1 + g(p)
p

.

Exponential Sums, Twisted Multiplicativity, and Moments
309
We now consider the contribution of the terms with s > x1/3. Since G(p) ⩽M
for all p,

q⩽x
s>x1/3
|V (a; q)| ⩽

r⩽x2/3
Mω(r)

x1/3<s⩽x/r
Mω(s).
Applying the Cauchy–Schwarz inequality and [26, Lemma 3.2] to the inner sum,
we ﬁnd that

x1/3<s⩽x/r
Mω(s) ≪
 
s⩽x/r
M2ω(s)1/2

x1/3<s⩽x/r
1
1/2
≪x
r (log x)(M2−1)/2 exp

−log(x/r)
2 log z

≪x
r (log x)(M2−1)/2−α/6 ≪
x
r log x .
Therefore,

q⩽x
s>x1/3
|V (a; q)| ≪
x
log x

r⩽x2/3
Mω(r)
r
≪
x
log x exp
 
z⩽p⩽x
M
p

≪
x
log x (log log x)M.
The proof of Theorem 1.5 is now complete.
3
Exponential Sums of Polynomials: Preliminary Results
In this section, we collect together some results on the exponential sums Wf (a; p).
We shall use and expand on some of these results in later sections. First we recall
the Weil bound: if f ∈Z[X] has degree d ⩾1 and (a, p) = 1, then
|Wf (a; p)| ⩽(d −1).
(6)
Next we quote a result from Shao [31, Th. 2.1].
Lemma 3.1 Let f ∈Z[X] be a polynomial of degree d. Let κ denote the number
of irreducible factors of f (X) −f (Y) ∈Q[X, Y]. Then, κ ⩽τ(d) (the number of
divisors of d), and for large x, we have

p⩽x
1
p
 1
p

(a,p)=1
|W(a; p)|2
= (κ −1) log log x + O(1).
Proof The asymptotic for the sum over primes is given in Theorem 2.1 of Shao [31],
and the bound on κ is described in the remark after Theorem 2.1.
⊓⊔

310
E. Kowalski and K. Soundararajan
While Lemma 3.1 involves the factorization of F(X, Y) = (f (X)−f (Y))/(X−
Y) in Q[X, Y], it is of greater signiﬁcance to understand the factorization of
F(X, Y) over ¯Q[X, Y] (or equivalently over C[X, Y]).
Lemma 3.2 Let f ∈Z[X] be a polynomial of degree d, and suppose that the
polynomial F(X, Y) = (f (X) −f (Y))/(X −Y) factors into m irreducible factors
over ¯Q[X, Y]. If m = 1, then for all p we have
1
p

a∈F×p
|W(a; p)|2 = 1 + O(p−1/2).
If m > 1, then there is a set of primes P of density ⩾δ > 0 (with δ depending only
on the degree d) such that for p ∈P
1
p

a∈F×p
|W(a; p)|2 = m + O(p−1/2).
Proof If m = 1, then the afﬁne curve with equation F(X, Y) = 0 is geometrically
irreducible over Q, so that for all large p it is geometrically irreducible over Fp.
Orthogonality of characters and the Riemann hypothesis for curves over ﬁnite ﬁelds
then show that
1
p

a∈F×p
|W(a; p)|2 = 1
p

%
(x, y) ∈F2
p : F(x, y) = 0
& = 1 + O(p−1/2).
Now suppose m > 1, and let K be a ﬁnite Galois extension of Q such that
F(X, Y) factors in K[X, Y] into m different factors, each of which is irreducible in
¯Q[X, Y]. Thus, the afﬁne curve deﬁned by F(X, Y) is the union of m geometrically
irreducible curves over K. Note that the degree of the ﬁeld K may be bounded in
terms of d. We take P to be the set of primes splitting completely in K. By the
Chebotarev density theorem, P has density 1/[K : Q], which is bounded away
from 0 by an amount depending only on d. For p ∈P, the m geometrically
irreducible components of the curve F(X, Y) = 0 are deﬁned over Fp, and the
Riemann hypothesis gives here
1
p

a∈F×p
|W(a; p)|2 = m + O(p−1/2).
⊓⊔
Our next result is due to Fried [16, Th. 1] (see also the more elementary account
by Turnwald in [33, Th. 1]). It describes when the polynomial F(X, Y) = (f (X) −

Exponential Sums, Twisted Multiplicativity, and Moments
311
f (Y))/(X −Y) is absolutely irreducible, i.e., when m = 1 in the notation of the
previous lemma, and therefore, κ = 2 in the notation of Lemma 3.1.
We recall that for any integer d ⩾0, the Dickson polynomial Dd ∈Z[X, a] is
deﬁned to be the unique polynomial such that
Dd(X + aX−1, a) = Xd + (a/X)d
(see, e.g., [33, §1]); in particular, Dd(X, 0) = Xd.
Proposition 3.3 (Fried) Let f ∈Z[X] with degree d ⩾1, and let
F = (f (X) −f (Y))/(X −Y) ∈Q[X, Y].
(1) If deg(f ) is not an odd prime, then F is absolutely irreducible if and only if f
is indecomposable in Q[X].
(2) If d is an odd prime ⩾5, then F is absolutely irreducible if it is not linearly
equivalent in Q[X] to a Dickson polynomial Dd(X, a).
(3) If d = 3, then F is absolutely irreducible if and only if f is not linearly
equivalent in Q[X] to a Dickson polynomial D3(X, 0).
Putting Lemmas 3.1, 3.2, and Proposition 3.3 together, we arrive at the following
corollary:
Corollary 3.4 Let f
∈
Z[X] be a polynomial of degree d
⩾
1. If f is
indecomposable, then for large x we have

p⩽x
1
p
 1
p

a∈F×p
|W(a; p)|2
= log log x + O(1),
whereas if f is decomposable, then for large x we have

p⩽x
1
p
 1
p

a∈F×p
|W(a; p)|2
⩾2 log log x + O(1).
Proof If d is prime, then κ must be 2 = τ(d) in Lemma 3.1. Moreover, f is
automatically indecomposable, and so the stated result holds in this case. If f = g◦h
is decomposable, then f (X) −f (Y) has (X −Y), (h(X) −h(Y))/(X −Y) and
(g(h(X))−g(h(Y)))/(h(X)−h(Y)) as factors, so that κ ⩾3 in Lemma 3.1 and the
stated result holds. Finally, if the degree d is composite and f is indecomposable,
then the ﬁrst part of Proposition 3.3 shows that (f (X)−f (Y))/(X−Y) is irreducible
in ¯Q[X, Y] and, therefore, in Q[X, Y]. Either Lemma 3.1 or Lemma 3.2 now gives
the stated result.
⊓⊔

312
E. Kowalski and K. Soundararajan
Lastly, we consider the behavior of W(a; p) when f is assumed to be Sidon–
Morse over Q. Here the work of Katz permits a very precise understanding of such
exponential sums.
Proposition 3.5 Let f ∈Z[X] be a polynomial of degree d, and suppose that
f is Sidon–Morse over Q. Let Kd denote the compact group USpd−1(C) if f is
symmetric Sidon–Morse and the compact group SUd−1(C) if f is Sidon–Morse but
not symmetric. For any integer k ⩾0, we have
lim
p→+∞
1
p

a∈F×p
|W(a; p)|2k =

Kd
|tr(g)|2kdμ(g),
where μ is the Haar measure on Kd normalized to have total volume 1. Further-
more,

USpd−1(C)
|tr(g)|2kdμ(g)

= (2k −1)!!
for 1 ⩽k ⩽(d −1)/2
⩽(2k −1)!!
for all k ⩾1,
and

SUd−1(C)
|tr(g)|2kdμ(g)

= k!
for 0 ⩽k ⩽(d −1)
⩽k!
for all k ⩾0,
Proof This is largely a consequence of the work of Katz [22]. We recall the relevant
result of Katz in Theorem 6.3 and explain the link to the moments over Kd in
Remark 6.10. Further discussion of Katz’s theorem may be found in Sect. 8.
The moments over Kd for small k (which match the moments of a standard
complex Gaussian for Kd
= SUd−1(C) and the moments of a standard real
Gaussian for Kd = USpd−1(C)) were computed by Diaconis and Shahshahani,
and the upper bounds for all k may be found in the work of Perret-Gentil [30, Prop.
2.2].
⊓⊔
Remark 3.6 Katz’s Theorem also leads to a possible guess for the optimal value of
the upper bound in (2), in the case of Sidon–Morse polynomials, namely
δ = 1 −

Kd
|tr(g)|dμ(g)
(for instance, if Kd = SU2(C), this leads to δ = 1 −8/(3π), as in (5)).
Asymptotically, for large d, we have the Gaussian approximations

Kd
|tr(g)|dμ(g) ≈
1
√
2π

R
|x|e−x2/2dx =
B
2
π = 0.79788456 . . . ,

Exponential Sums, Twisted Multiplicativity, and Moments
313

Kd
|tr(g)|dμ(g) ≈1
π

C
|z|e−|z|2dz =
√π
2
= 0.8662269 . . .
in the USpd−1(C) and SUd−1(C) cases, respectively.
4
Proof of Theorem 1.1
We begin with the ﬁrst part of the theorem, which seeks a bound for

q⩽x |W(a; q)|2. We apply Theorem 1.5 to the function q →W(a; q)2, which is
twisted multiplicative. The Weil bound (6) allows us to take G(p) = (d −1)2 for
all but ﬁnitely many primes. Writing
g(p) = 1
p

(a,p)=1
|W(a; p)|2,
and recalling that f is indecomposable, Corollary 3.4 gives

p⩽x
g(p)
p
= log log x + O(1).
Theorem 1.5 yields

q⩽x
|W(a; q)|2 ≪
x
log x exp
 
p⩽x
g(p)
p

(log log x)(d−1)2 ≪x(log log x)(d−1)2.
Now we turn to the proof of the second part of the theorem, which we will deduce
from Theorem 1.5 and Theorem 1.3 (to be proved in Sect. 5). Applying Theorem 1.5
to the twisted multiplicative function |W(a; q)| and using the Weil bound (which
permits M = d −1 here), we obtain

q⩽x
|W(a; q)| ≪
x
log x (log log x)d−1 exp
 
p⩽x
1
p
 1
p

a∈F×p
|W(a; p)|

.
(7)
Let ϵ be a small positive number, and let P denote the set of primes p for which
1
p

a∈F×p
|W(a; p)|4 ⩾2 −ϵ.
By Theorem 1.3, we know that the set P has density ⩾δ = δ(d) > 0 with δ
depending only on d. For any real number y with |y| ⩽d −1, we claim that

314
E. Kowalski and K. Soundararajan
|y| ⩽1 + y2
2
,
and
|y| ⩽1 + y2
2
+
3/2 −y4
200(d −1)4 .
The ﬁrst inequality is clear and so is the second inequality in the range y4 ⩽3/2.
In the range 3/2 < y4 ⩽(d −1)4, note that (1 + y2)/2 −|y| ⩾(1 + √3/2)/2 −
(3/2)1/4 > 1/200, so that the desired inequality holds in this case also.
Applying the ﬁrst inequality above for primes p /∈P, we ﬁnd
1
p

a∈F×p
|W(a; p)| ⩽1
2 + 1
2p

a∈F×p
|W(a; p)|2,
while applying the second inequality above for primes p ∈P, we ﬁnd
1
p

a∈F×p
|W(a; p)| ⩽1
2 + 1
2p

a∈F×p
|W(a; p)|2 +
1
200(d −1)4
3
2 −1
p

a∈F×p
|W(a; p)|4
⩽1
2 + 1
2p

a∈F×p
|W(a; p)|2 −
1
400(d −1)4 .
Combining both inequalities, and using the ﬁrst part of Corollary 3.4, we conclude
that

p⩽x
1
p2

a∈F×p
|W(a; p)| ⩽
1
2 + 1
2 −
δ
400(d −1)4 + o(1)

log log x.
Inserting this bound in (7), the second part of the theorem follows:
5
The Fourth Moment: Proof of Theorem 1.3
As we shall see, for Sidon–Morse polynomials, the work of Katz [22] can be used
to show that Case (1) of Theorem 1.3 holds. The main challenge is to handle all
polynomials of degree ⩾3 and not just the generic ones.
Let f ∈Z[X] be a polynomial with d = deg(f ) ⩾3. If (f (X)−f (Y))/(X−Y)
is not absolutely irreducible, then Lemma 3.2 shows that there is a positive density
of primes on which the second moment of W(a; p) is at least 2 + O(p−1/2), so that
by Cauchy–Schwarz a stronger form of the second case of Theorem 1.3 holds (with
the fourth moment being ⩾4 + O(p−1/2)).
From now on, we will therefore assume that the polynomial
F(X, Y) = (f (X) −f (Y))/(X −Y)

Exponential Sums, Twisted Multiplicativity, and Moments
315
is absolutely irreducible. The remaining part of the proof will use in an essential
way the algebraic interpretation of the exponential sums W(a; p), which goes back
to Weil, and it seems difﬁcult to prove the lower bound for the fourth moment with
a direct elementary argument.
Fix a prime ℓ(for instance, ℓ= 2); all primes p will be assumed to be different
from ℓand to be larger than d. Let ι be a ﬁxed isomorphism ¯Qℓ→C; we use it to
identify ℓ-adic numbers and complex numbers.
Let p ̸= ℓ, p > d, be a prime number. We denote by ψp the ℓ-adic additive
character of Fp such that
ι(ψp(a)) = e
 a
p

for a ∈Fp.
Let Gp be the ℓ-adic sheaf f∗¯Qℓ/ ¯Qℓon the afﬁne line A1
Fp; it has rank d −1 and
is everywhere tamely ramiﬁed (since p > d). The sheaf Gp is a Fourier sheaf in the
sense of Katz [22, 7.3.5], and we denote by Fp its (unitarily normalized) Fourier
transform with respect to ψp (deﬁned in [22, 7.3.3], up to the normalization). The
trace function of Fp takes value 0 for a = 0 and takes value (after applying ι)
1
√p

x∈Fp
e
af (x)
p

= W(a; p)
for a ∈F×
p (see [22, Th. 7.3.8, (4)], where again the Fourier transform is not
normalized). The rank of Fp is also equal to d −1, and Fp is lisse and pure of
weight 0 outside 0 and ∞(see [22, Lemma 7.3.9]).
Lemma 5.1 If the polynomial (f (X) −f (Y))/(X −Y) is absolutely irreducible
over Q, then for all p large enough, the sheaf Fp is geometrically irreducible.
Proof This is a Fourier-side variant of Lemma 3.2. If the polynomial
F(X, Y) = (f (X) −f (Y))/(X −Y)
is absolutely irreducible, then the curve Cf,p over Fp with equation
(f (x) −f (y))/(x −y) = 0
is geometrically irreducible, which by the Riemann hypothesis for curves implies
that as ν →+∞, we have
|Cf,p(Fpν)| ∼pν.
However, the discrete Parseval formula implies that

316
E. Kowalski and K. Soundararajan
1
pν |Cf,p(Fpν)| = 1
pν

a∈F×
pν
 1
pν/2

x∈Fpν
e
tr(af (x))
p

2
(with the trace from Fpν to Fp) so we obtain
lim
ν→+∞
1
pν

a∈F×
pν
 1
pν/2

x∈Fpν
e
tr(af (x))
p

2
= 1,
and this implies that Fp is geometrically irreducible by Katz’s diophantine criterion
for irreducibility (see, e.g., [27, Lemma 4.14]).
⊓⊔
We now consider only primes p such that the sheaf Fp is geometrically
irreducible.
Let Gp be the arithmetic monodromy group of Fp and Gg
p the geometric
monodromy subgroup; we can view these as algebraic subgroups of GLd−1( ¯Qℓ).
The irreducibility property of Fp means that Gg
p acts irreducibly on ¯Qd−1
ℓ
.
By a deep theorem of Deligne (see [11, Th. 3.4.1 (iii) and Cor. 1.3.9]), the
connected component of the identity Gg
p,0 of the group Gg
p is semisimple. It
is invariant under all automorphisms of Gg
p; hence, it is a normal subgroup
of Gp (since inner automorphisms of Gp induce automorphisms of its normal
subgroup Gg
p). Let fp denote a ﬁxed element of the conjugacy class of the Frobenius
automorphism at p.
Let Ep be the sheaf End(End(Fp)). Its trace function for a ∈F×
p is |W(a; p)|4.
Let Vp be the subspace End(End( ¯Qd−1
ℓ
))Gg
p of vectors invariant under Gg
p, the
action of Gp on the space End(End( ¯Qd−1
ℓ
)) being “the obvious one” induced by
the action on ¯Qd−1
ℓ
(if a group G acts on a vector space E, it acts on End(E) by
g · u = g ◦u ◦g−1).
Applying the Grothendieck–Lefschetz trace formula and Deligne’s version of the
Riemann hypothesis, we get a formula
1
p

a∈F×p
|W(a; p)|4 = ι(tr(fp|Vp)) + O(p−1/2)
(8)
where the implied constant depends only on d (e.g., by conductor estimates, much
as in [15, Th. 9.1]).
Proposition 5.2 There exists a ﬁnite Galois extension K of Q of degree bounded
in terms of d only such that for all but ﬁnitely many primes p that are totally split
in K, the action of fp on Vp = End(End( ¯Qd−1
ℓ
))Gg
p is trivial.
Let us admit this proposition and conclude the proof of Theorem 1.3. For primes
totally split in the number ﬁeld K, we have ι(tr(fp|Vp)) = dim(Vp). On the other
hand, the deﬁnition of the action of Gg
p on End( ¯Qd−1
ℓ
) shows that the space Vp is

Exponential Sums, Twisted Multiplicativity, and Moments
317
the space of all linear maps End( ¯Qd−1
ℓ
) →End( ¯Qd−1
ℓ
) which commute with the
Gg
p-action. The identity is an element of this space, so its dimension is ⩾1. Since
the action on End( ¯Qd−1
ℓ
) is semisimple (e.g., by Deligne’s Theorem [11, Th. 3.4.1]
because it is still pure of weight 0), Schur’s Lemma in representation theory (see,
e.g., [25, Prop. 2.7.15 (3)]) implies that the dimension of Vp is exactly 1 if and
only if the action of Gg
p on End( ¯Qd−1
ℓ
) is irreducible. However, Vp contains both
the multiples of the identity and the space End0( ¯Qd−1
ℓ
) of matrices of trace zero
as stable subspaces, so this irreducibility can only hold if End0( ¯Qd−1
ℓ
) is zero, i.e.,
if d = 2. So for primes totally split in K, we have dim(Vp) ⩾2; hence
1
p

a∈F×p
|W(a; p)|4 ⩾2 + O(p−1/2)
by (8).
To improve on this unless the limit is equal to 2, we use very deep work of
Katz [22, Th. 14.3.4] that implies that Gg
p,0 is independent of p for all p large
enough. Take a prime p large enough so that Gg
p,0 has stabilized, and suppose that
dim(Vp) = 2 for some p split in K. Then, the group Gg
p,0 must act irreducibly
on matrices of trace zero. However, the Lie algebra of Gg
p is a stable subspace, so
that we must have Lie(Gg
p,0) = End0( ¯Qd−1
ℓ
). That means that Gg
p,0 is equal to
SLd−1( ¯Qℓ). Then, for all primes p large enough, we have ZGg
p,0 = GLd−1( ¯Qℓ),
where Z is the group of scalar matrices in GLd−1( ¯Qℓ), which implies that fp acts
trivially for all p large enough and then that the limit of the fourth moments exists
and is equal to 2.
To ﬁnally show that the constant 2 is best possible, we recall that Katz has
proved that if f is a Sidon–Morse polynomial (e.g., the derivative f ′ has Galois
group Sd−1), then Gg
p contains SLd−1( ¯Qℓ) for all p large enough (see Theorem 6.3),
in which case it is well-known that the action of Gg
p on the space of matrices of
trace zero is irreducible, so that the dimension of Vp is then equal to 2 for all p large
enough.
Remark 5.3 The arguments above are related to the easiest part of the Larsen’s
Alternative [23].
Proof of Proposition 5.2 We will begin by proving the statement without the infor-
mation that the degree of K can be bounded in terms of d only, since the latter
requires extra ingredients.
Step 1.
We ﬁrst prove that, for all primes p large enough, the action of fp on Vp
is of ﬁnite order. Since we are assuming that Gg
p acts irreducibly on ¯Qd−1
ℓ
, a
result of Katz shows that the connected component of the identity Gg
p,0 of Gg
p
acts irreducibly on ¯Qd−1
ℓ
, provided p is large enough (see [22, 7.7.3, Lemma
7.7.5]).

318
E. Kowalski and K. Soundararajan
Recall that the group of outer automorphisms of Gg
p,0 is the group Out(Gg
p,0)
of automorphisms modulo inner automorphisms. For g ∈Gp, let αp(g) ∈
Out(Gg
p,0) be the class modulo inner automorphisms of the automorphism x →
xgx−1 of Gg
p,0 (it is an automorphism since Gg
p,0 is normal in Gp). This deﬁnes
a group homomorphism
Gp
αp
−→Out(Gg
p,0).
We claim that the kernel of αp is Gg
p,0Z ∩Gp where Z is again the group of
scalar matrices in GLd−1( ¯Qℓ). Indeed, the condition αp(g) = 1 means that there
exists h ∈Gg
p,0 such that gxg−1 = hxh−1 for all x ∈Gg
p,0, which is equivalent
to h−1g belonging to the centralizer of Gg
p,0 in GLd−1( ¯Qℓ) or, in other words,
to h−1g commuting with the action of Gg
p,0 on ¯Qd−1
ℓ
. By Schur’s Lemma (see,
e.g., [25, Prop. 2.7.15 (2)]), the irreducibility of the action of Gg
p,0 implies that
this centralizer is equal to Z. Thus, g ∈ker(αp) is equivalent to g ∈Gg
p,0Z∩Gp.
We deduce therefore that we have an injective group homomorphism
Gp/(Gg
p,0Z ∩Gp)
αp
−→Out(Gg
p,0).
Because Gg
p,0 is a connected semisimple group, its outer automorphism group is
ﬁnite (see, e.g., [4, p. 42, prop. 18] in the case of compact groups). Hence, αp
injects Gp/(Gg
p,0Z ∩Gp) in a ﬁnite group. Since Z acts trivially on End(W)
for any representation W, and since Gg
p acts trivially on Vp, this shows that the
order of the action of fp on Vp is a divisor of the order of the outer automorphism
group.
Step 2.
We next prove that there exists a ﬁnite-dimensional continuous ℓ-adic
Galois representation
ϱ: Gal( ¯Q/Q) →GL(E)
for some ¯Qℓ-vector space E, such that for all but ﬁnitely many primes, the action
of Frobenius at p on E “is” the same as the action of fp on Vp. It is enough to
deﬁne a constructible ℓ-adic sheaf V on Spec(Z[1/ℓN]) for some integer N ⩾1
such that the stalk over all but ﬁnitely many primes p “is” the space Vp and
such that the action of fp coincides with the action of the Frobenius at p.
Indeed, this sheaf V will be lisse outside of a ﬁnite set S of primes and hence
will correspond to a Galois representation of the Galois group of the maximal
extension unramiﬁed outside S, and this is a quotient of the Galois group of Q.
To construct V , we use [27, Lemma 4.23] (see also [27, Lemma 4.27] for a more
difﬁcult application), applied to the data

Exponential Sums, Twisted Multiplicativity, and Moments
319
(X, Y, f, g) = (A4, Spec(Z[1/ℓ]), the structure morphism,
g(x, y, z, w) = f (x) + f (y) −f (z) −f (w))
and take the second cohomology sheaf of the complex resulting from this
application of [27, Lemma 4.23].
That this “works” results from the expression
1
p

a∈F×p
 1
√p

x∈Fp
e
af (x)
p

4
= 1
p3

x,y,z,w∈Fp

a∈F×p
e
ag(x, y, z, w)
p

,
combined with the cohomological expression
Vp ≃H 2
c (Gm × ¯Fp, End(End(Fp)))(1).
(9)
Step 3.
By the compatibility with Frobenius of the isomorphism (9) in Step 2,
and by Step 1, the action of Frobenius at p under ϱ is of ﬁnite order for all
but ﬁnitely many primes p. The image H of ϱ is a compact ℓ-adic Lie group
(identifying GL(E) with GLm( ¯Qℓ) for some m ⩾1, we ﬁrst note that H is
contained in GLm(L) for some ﬁnite extension L of Qℓ, by an oft-rediscovered
lemma—see, for instance, [24, Lemma 9.0.8]—and then it is a closed subgroup
of an ℓ-adic Lie group, hence itself an ℓ-adic Lie group by, e.g., [1, p. 227, th. 2]).
It follows from [1, Cor. 1, p. 169] that there is a neighborhood U of 1 ∈H
which contains no non-trivial ﬁnite subgroup; there is then a number ﬁeld K such
that the ﬁnite-index subgroup Gal( ¯Q/K) maps to U. All the Frobenius elements
in this subgroup (which exist outside any given ﬁnite set of primes because
Frobenius elements are dense, by a form of Chebotarev’s density theorem) must
map to the identity, which means that Gal( ¯Q/K) is in the kernel of ϱ. This
implies that for a prime p that is totally split in K, the action of fp, which “is”
the action of Frobenius under ϱ, is trivial. This proves the result, up to the bound
on the degree of K.
Step 4.
Now we explain how to bound the degree of K in terms of d only.
The ﬁrst ingredient is a fact from the theory of ﬁnite groups: for given positive
integers k and m, if  is a ﬁnite subgroup of GLk( ¯Qℓ) such that all elements of 
have order dividing m, then the order of  is bounded in terms of k and m only.
Indeed, by a well-known theorem of Jordan (see, e.g., [10, Th. 36.13]), there
exists a normal abelian subgroup 0 of  of index bounded in terms of k and m.
This reduces the problem to the abelian case; but 0 can be diagonalized, and the
bound on the order of its elements shows that 0 is isomorphic to a subgroup of
(Z/mZ)k, hence the result.
We want to apply this to the image  ⊂GL(E) of the Galois representation ϱ.
We have dim(E) ⩽(d −1)4. By the Chebotarev density theorem, it is then enough
to prove that the order of the action of fp on Vp is uniformly bounded in terms of d
only. For this we use the fact that there are, up to isomorphism, only ﬁnitely many

320
E. Kowalski and K. Soundararajan
possibilities for Gg
p,0, since it is a connected and semisimple subgroup of GLd−1
(this follows, in the equivalent case of compact Lie groups, from the discussion
in [4, §4, n09, Scholie], which shows that such subgroups are classiﬁed by their root
system R, which here has rank ⩽d −1, which gives only ﬁnitely many possibilities,
and for each root system R by a subgroup of the quotient Q(R)/P(R) discussed in
loc. cit.; since this quotient is ﬁnite by [2, §1, no10], there are again only ﬁnitely
many possibilities). So the order of fp is a divisor of the order of one of ﬁnitely
many ﬁnite groups (depending only on d).
⊓⊔
Remark 5.4 The argument in Step 4 shows that it is possible to give an effective
value for the constant γ in Theorem 1.1. Indeed, the index of 0 in Jordan’s Theorem
can be bounded effectively (for instance, one gets from [10, Th. 36.14] that
|| ⩽mk|0| ⩽mk(
√
8k + 1)2k2,
and better bounds are known), and the order of the groups Gp,0/Gg
0,0 can also be
bounded effectively from the classiﬁcation of roots systems.
6
Generic Polynomials
In this section, we will prove the kind of non-correlation estimates modulo primes
that are needed in the proof of Theorem 1.11. We also explain Proposition 3.5 at the
end.
We ﬁrst make some remarks concerning Sidon–Morse polynomials:
Lemma 6.1 Let K be any ﬁeld and let f ∈K[X] be a Morse polynomial of
degree d ⩾2.
(1) The polynomial f is indecomposable over K.
(2) For any c ∈K, the polynomials f + c and −f + c are Morse polynomials.
If f is a Sidon–Morse polynomial, then f + c and −f + c are Sidon–Morse
polynomials.
Proof
(1) We show that if f is decomposable, then it is not a Morse polynomial. Let
f = g ◦h where deg(g) ⩾2 and deg(h) ⩾2 be a decomposable polynomial.
Note that p does not divide either deg(g) or deg(f ) since p ∤d.
For any critical point α of g, the critical values of f contain, with multiplic-
ity, the values g(h(β)) where h(β) = α. This will give rise to a critical value
with multiplicity at least 2 unless h −α = γ (X −β)deg(h) for some γ ∈K×.
Since p does not divide deg(h), this can only occur for a single value of α, so
that g is of the form
g = δ(X −α)deg(g) + η

Exponential Sums, Twisted Multiplicativity, and Moments
321
for some δ ∈K× and η ∈K. Then, we get
g ◦h = η + δγ deg(g)(X −β)d,
which has a single critical value and is therefore not a Morse polynomial.
(2) This is straightforward from the deﬁnition, since the critical points of g = f +c
(resp. g = −f + c) are the same as those of f , so the critical values of g are
those of f translated by c (resp. the negative of those of f , translated by c).
⊓⊔
Let p be a prime number and f ∈Fp[X] a Sidon–Morse polynomial. We
deﬁne the ℓ-adic sheaf Ff associated to f as in the previous section. We will now
normalize it in a speciﬁc way. We denote by L2 the Kummer sheaf associated to the
Legendre character, with trace function a →(a/p).
Deﬁnition 6.2 (Normalized Sheaf) Let p be a prime and f ∈Fp[X] a Sidon–
Morse polynomial with p ∤deg(f ) −1.
(1) If f is not symmetric Sidon, then there is a unique c ∈Fp such that the sum of
the critical values of f + c is equal to 0, and the normalized sheaf I
Ff of f is
deﬁned to be
I
Ff = Ff +c ⊗L d−1
2
.
We then say that c = cf is the critical shift of f .
(2) If f is symmetric Sidon polynomial, and
f = g(βX + γ ) + δ
where g is odd, then we put
I
Ff = Fg.
We note that the sum of critical values of g is then equal to 0.
The trace function of I
Ff is 0 for a = 0 and for a ∈F×
p is given either by
I
Wf (a; p) =
1
√p
 a
p
d−1 
x∈Fp
e
a(f (x) + c)
p

=
 a
p
d−1
e
ac
p
 
x∈Fp
e
af (x)
p

(10)
or by
I
Wf (a; p) =
1
√p

x∈Fp
e
ag(x)
p


322
E. Kowalski and K. Soundararajan
=
1
√p e

−aδ
p
 
x∈Fp
e
af ((x −γ )/β)
p

= e

−aδ
p

Wf (a; p).
(11)
in the symmetric case. In particular, we see that in all cases, the formula
| I
Wf (a; p)| = |Wf (a; p)|
is valid all a modulo p.
The point of this normalization is the following theorem of Katz:
Theorem 6.3 (Katz) Let p be a prime number. Let f ∈Fp[X] be a Sidon–Morse
polynomial of degree d ⩾3. Assume that p > 2d −1 and that p ∤d −1.
(1) If f is not a symmetric Sidon–Morse polynomial, then the geometric mon-
odromy group of I
Ff is equal to SLd−1( ¯Qℓ).
(2) If f is a symmetric Sidon–Morse polynomial, which implies that d is odd, then
the geometric monodromy group of I
Ff is isomorphic to Spd−1( ¯Qℓ).
Proof
(1) If f is not of symmetric type, then the geometric monodromy group contains
SLd−1 under the assumption on p, by [22, Th. 7.9.6], and has trivial determinant
by [22, Lemma 7.10.4, (2)], so it must be SLd−1.
(2) If f is of symmetric type, then under the assumption on p, a conjugate of the
geometric monodromy group of I
Ff is contained in Spd−1 by [22, Lemma
7.10.4, (3)] (since the associated polynomial g is odd). By [22, Th. 7.9.7], it
contains either SLd−1 or Spd−1 or SOd−1; the only possibility that is compatible
with both these facts is that it is Spd−1.
⊓⊔
Remark 6.4 If we consider a Morse polynomial f such that the set of critical values
is a symmetric Sidon set, we might hope that (2) still holds. However, although one
can still deduce from the work of Katz that the geometric monodromy group of I
Ff
contains a symplectic group, we currently do not know if this condition is sufﬁcient
to ensure that I
F has conversely a symplectic symmetry.
We will also need a result that is essentially a consequence of the ideas of Fried.
Proposition 6.5 Let p be a prime number. Let f and g in Fp[X] be Sidon–Morse
polynomials of respective degree df ⩾3 and dg ⩾3. Assume that df < p and dg <
p.
If f and g are not linearly equivalent over ¯Fp, then f (X)−g(Y)+c and f (X)+
g(Y) + c are absolutely irreducible for any c.
Proof Since f + c is a Sidon–Morse polynomial (Lemma 6.1), and linearly
equivalent to g if and only if f is, we can assume that c = 0. Since −g is a Sidon–
Morse polynomial, and linearly equivalent to f if and only if so is g, we need to
only consider the case of f (X) −g(Y).

Exponential Sums, Twisted Multiplicativity, and Moments
323
Let G be the Galois group of the equation f (X) −Y = 0 over the ﬁeld ¯Fp(Y)
(so X is the variable). If f (X) −g(Y) is not absolutely irreducible, then G is also
isomorphic to the one for the equation g(X) −Y = 0 by [9, §2.1.1].1 By [9,
§2.1.4], if f and g are not linearly equivalent over ¯Fp, then the faithful permutation
representations of G on the roots of these two equations are not equivalent as
permutation representations, but have the same character (i.e., are equivalent as
linear representations). However, for Sidon–Morse polynomials f and g, the group
G and its permutation representation are isomorphic to Sd with the standard
permutation representation on d letters (see [22, Proof of Lemma 7.10.2.3]).
However, this is a contradiction, since this faithful permutation representation of Sd
is characterized by its character (the only non-obvious case is when d = 6, and
we consider the standard permutation representation and that given by a non-trivial
outer automorphism of S6, but these have different characters, e.g., because a
transposition is mapped to, respectively, a transposition, with 4 ﬁxed points, or a
product of three disjoint transpositions, without ﬁxed points).
⊓⊔
Proposition 6.6 Let p be a prime. Let m ⩾1 be an integer and let f1, . . . , fm
be Sidon–Morse polynomials in Fp[X]. Assume that p > 2 deg(fi) −1 and p ∤
(deg(fi) −1) for all i. Assume also that for all i ̸= j, the polynomials fi and fj
are not linearly equivalent over ¯Fp.
Then, the geometric monodromy group of the sheaf
N
1⩽i⩽m
I
Ffi
is the direct product of the geometric monodromy groups of the sheaves I
Ffi.
Proof We write di = deg(fi) and I
Fi = I
Ffi. We also denote by I
F ∨
i the dual of
I
Fi.
We will apply the Goursat–Kolchin–Ribet criterion, as developed by Katz [22,
Prop. 1.8.2] and expounded by Fouvry, Kowalski, and Michel [14, Lemma 2.4]. In
the language of loc. cit., it sufﬁces to check that the family ( I
Fi) is Gm-generous [14,
Def. 2.1], since the individual geometric monodromy groups of I
Fi are connected
by Theorem 6.3.
This desired property is the combination of four conditions. Condition (1)
holds because the sheaves I
Fi are pure of weight 0 on Gm and have a geometric
monodromy group (namely SLdi−1 or Spdi−1 by Theorem 6.3) that acts irreducibly
on ¯Qdi−1
ℓ
. Conditions (2) and (3) are then known properties of SLdi−1 and Spdi−1
(see [14, §3.1]).
To prove the most important Condition (4), it is enough to check that if i ̸= j,
there is no geometric isomorphism
1 This is written for the base ﬁeld C, but the argument extends to any algebraically closed ﬁeld
when the polynomials involved have degree less than the characteristic of the ﬁeld.

324
E. Kowalski and K. Soundararajan
I
Fi ≃I
Fj ⊗L ,
or
I
F ∨
i ≃I
Fj ⊗L
(12)
where L is a rank one sheaf lisse on Gm (see [14, Remark 2.2]). This is impossible
unless di = dj and unless either none or both of fi and fj are symmetric Sidon–
Morse. We now assume that di = dj, and we denote by d this common value.
Case 1.
Assume ﬁrst that neither fi nor fj is symmetric and that we have the
isomorphism I
Fi ≃I
Fj ⊗L in (12). We denote by ci and cj the critical shifts
of fi and fj.
We recall that since p > 2d−1, the sheaf I
Fi is, for all i, tamely ramiﬁed at 0 [22,
Lemma 7.10.4, (1)], with local monodromy isomorphic to the sum of the non-
trivial characters of order d [22, Lemma 7.10.4, (1)]. These must be permuted by
multiplication by the monodromy character χ0 of L at 0, which is only possible
if χ0 = 1, i.e., if L is lisse at 0.
Next, by [22, Th. 7.8.4, (2)] and the construction of I
Fi, the wild monodromy
representation of I
Fi at ∞is the direct sum
N
v∈Vi
Lψ(vX)
(13)
where Vi is the set of critical values of fi + ci and Lψ(vX) denotes the Artin–
Schreier sheaf modulo p with trace function a →e(av/p). Let v ∈Vi. The
putative isomorphism I
Fi ≃I
Fj ⊗L implies that there exists w ∈Vj such that
Lψ(vX) = L ⊗Lψ(wX),
as representations of the wild inertia group at ∞. In particular, L is an Artin–
Schreier sheaf at inﬁnity, say L ≃Lψ(cX) for some c, as representations of the
wild inertia group. The local isomorphism becomes
N
v∈Vi
Lψ(vX) ≃
N
w∈Vj
Lψ((c+w)X),
so that Vi = Vj + c as subsets of ¯Fp. But taking the sum of the values on both
sides, and using the deﬁnition of the normalized sheaf, we deduce that c = 0.
Thus, the sheaf L is trivial on the wild monodromy group and, therefore, is also
tamely ramiﬁed at ∞.
Since L is lisse on Gm and tame, it is a Kummer sheaf attached to some
multiplicative character χ of F×
p (which is its trace function). Since it is lisse
at 0, this character must be trivial. Hence, we deduce that I
Fi and I
Fj are in fact
geometrically isomorphic.
By the diophantine criterion for irreducibility (see, e.g., [27, Lemma 4.14]), this
implies that

Exponential Sums, Twisted Multiplicativity, and Moments
325
lim sup
ν→+∞
1
pν


a∈F×
pν
I
Wi(a; pν) I
Wj(a; pν)
 = lim sup
ν→+∞
1
pν

a∈F×
pν
| I
Wi(a; pν)|2 = 1,
(14)
where I
Wi(a; pν) is the trace function of I
Fi over the extension of degree ν of Fp.
By (10) and orthogonality of characters, the sum on the left-hand side is equal to
1
pν |{(x, y) ∈F2
pν | fi(x) + ci = fj(y) + cj}| −1
(noting that if the trace function of fi has the Legendre factor, then so does fj,
and they cancel out). If the polynomial fi(X) −fj(Y) + ci −cj is absolutely
irreducible, then we get
1
pν |{(x, y) ∈F2
pν | fi(x) + ci = fj(y) + cj}| −1 ≪p−ν/2
by the Riemann Hypothesis for curves, which contradicts (14). Thus, the
polynomial
fi(X) −fj(Y) + ci −cj
is not absolutely irreducible, which can only happen if fi and fj are linearly
equivalent over ¯Fp (Proposition 6.5).
Case 2.
We continue assuming that neither fi nor fj is symmetric and consider
the second case of an hypothetical isomorphism (12). It is elementary that the
dual I
F ∨
i
is the normalized sheaf associated to −fi (because Fi is the Fourier
transform of a sheaf that is self-dual, being the direct image of the self-dual
constant sheaf; see [22, Th. 7.3.8, (2)]). Thus, we are reduced to the previous
case.
Case 3.
Now we assume that fi and fj are symmetric. Since I
Fi and I
Fj are
then self-dual by Theorem 6.3 (2), we need to only exclude the possibility of a
geometric isomorphism of the form
I
Fi ≃I
Fj ⊗L .
Assume there is such an isomorphism. We denote by gi and gj the odd
polynomials associated to fi and fj so that I
Fi = Fgi and I
Fj = Fgj . Arguing
exactly as in Case 1, we see that the sheaf L is trivial. Then, continuing again as
in Case 1 using (11), we ﬁnd that there are δi and δj such that
fi(X) −fj(Y) −δi + δj
is not absolutely irreducible, and Proposition 6.5 allows us to conclude that fi
and fj would have to be linearly dependent.
⊓⊔

326
E. Kowalski and K. Soundararajan
Lemma 6.7 Let f and g in Z[X] be polynomials of common degree d ⩾3.
The polynomials f and g are linearly equivalent over ¯Q if and only if f (mod p)
and g (mod p) are linearly equivalent over an algebraic closure ¯Fp of Fp for
inﬁnitely many primes.
Proof The set Xf,g of tuples (a, b, c, d) in ¯Q such that
g = af (cX + d) + b
is deﬁned by polynomial equations with rational coefﬁcients. The polynomials f
and g are linearly equivalent over ¯Q if and only if Xf,g( ¯Q) is not empty. Since
Xf,g is an algebraic variety, this is true if and only if Xf,g(¯Fp) is not empty for
all p large enough (e.g., by the Nullstellensatz: if Xf,g( ¯Q) is empty, then there is
a representation of 1 as belonging to the ideal generated by the equations of Xf,g,
and this leads to a representation of 1 over ¯Fp for all primes large enough), which
proves the assertion.
⊓⊔
Corollary 6.8 Let m ⩾1 be an integer, and let f1, . . . , fm be Sidon–Morse
polynomials in Z[X] that are pairwise not linearly equivalent over ¯Q. Let s ⩽m be
the number of fi such that fi is symmetric Sidon–Morse of degree ⩾5.
We have
1
p

(a,p)=1
|Wf1(a; p) · · · Wfm(a; p)|2 = 1 + O(p−1/2)
(15)
1
p

(a,p)=1
|Wf1(a; p) · · · Wfm(a; p)|4 = 2m−s3s + O(p−1/2)
(16)
where the implied constant depends only on m and on the degrees of the polynomials
fi.
Proof Applying Lemma 6.7, we see that for p large enough, the assumptions of
Proposition 6.6 hold modulo p. Let p be such a prime. Using the same notation as
in (8), the left-hand side of (15) is equal to
ι(tr(fp| End(Wp)G)) + O(p−1/2)
where Wp is the tensor product space
O
i
¯Qdi−1
ℓ
as a representation of the geometric monodromy group G of
N
i
I
Fi.

Exponential Sums, Twisted Multiplicativity, and Moments
327
By Proposition 6.6, this representation can be identiﬁed with the external tensor
product of the representations of the individual geometric monodromy groups; since
this external tensor product is an irreducible representation (see, e.g., [25, Prop.
2.3.23]), the invariant space has dimension one, spanned by the scalar matrices, on
which fp acts trivially, and the ﬁrst result follows.
For the second result, we get in the same way the main term of (16) equal to
m

i=1
dim(End(End( ¯Qdi−1
ℓ
))Gi
where Gi is the geometric monodromy group of I
Fi. By the simplest case of the
Larsen Alternative (see [23, Th. 1.1.6]), each factor is equal to 3 if fi is a symmetric
Sidon–Morse polynomial of degree ⩾5 (with symplectic monodromy) and to 2 for
the others.
⊓⊔
We conclude this section with the following proposition, which is used in the
proof of the ﬁrst part of Theorem 1.11, where only one polynomial is assumed to be
a Sidon–Morse polynomial.
Proposition 6.9 Let f and g be non-constant polynomials in Z[X] of degrees df
and dg, respectively. Suppose that f is a Sidon–Morse polynomial, that df < dg,
and that g is absolutely irreducible. Then,
1
p

(a,p)=1
|Wf (a; p)Wg(a; p)|2 = 1 + O(p−1/2)
where the implied constant depends only on df and dg.
Proof This is a variant of the Goursat–Kolchin–Ribet argument, but where we only
fully control one of the sheaves.
Let p > df −1 be a prime such that f is a Sidon–Morse polynomial modulo p.
We denote by I
Ff the normalized sheaf associated to f modulo p and by Gf (resp.
Gg) the geometric monodromy group of I
F (resp. of Fg). Since f is a Sidon–
Morse polynomial, we have Gf = SLdf −1 or Gf = Spdf −1 (the latter when f is
symmetric Sidon–Morse) by Theorem 6.3.
Let further H be the geometric monodromy group of I
Ff ⊕Fg. We have a
natural inclusion H →Gf × Gg, and the composition of this inclusion with either
projection is surjective.
We denote by Wp the space
End( I
Ff ⊗Fg)H
and by fp a representative of the Frobenius automorphism in H. The analogue of (8)
in this case is the formula

328
E. Kowalski and K. Soundararajan
1
p

a∈F×p
|Wf (a; p)Wg(a; p)|2 = ι(tr(fp|Wp)) + O(p−1/2)
where the implied constant depends only on df and dg (and we used the fact that
the trace function of I
Ff has the same modulus as that of Ff ). By Schur’s Lemma,
it then sufﬁces to prove that the representation of H on I
Ff ⊗Fg is irreducible, and
in turn, it is enough to prove that H = Gf × Gg (using again the irreducibility of
external tensor product of irreducible representations, see [25, Prop. 2.3.23]).
We denote by L the kernel of the composition homomorphism
Gf →H ⊂Gf × Gg →Gg.
This is a normal subgroup of Gf ; hence, L is either ﬁnite or equal to Gf . If the
latter holds, then H contains Gf × {1}, and it follows easily that H = Gf × Gf .
Thus, we need to exclude the possibility that L is ﬁnite. However, if that is the
case, then Gf /L is isomorphic to a subgroup of Gg; hence, the Lie algebra of Gf
has a faithful representation of dimension ⩽dg−1. Since we assumed that df > dg,
this is impossible in view of the minimal dimensions of faithful representations of
the Lie algebras of SLdf −1 or Spdf −1 (which are equal to df −1; see, e.g., [3, p. 249,
Exercice 2 and p. 214, Table 2]).
⊓⊔
Remark 6.10 Theorem 6.3 also implies Proposition 3.5. Indeed, using the same
notation as in (8), the Riemann Hypothesis and conductor estimates imply that for k
ﬁxed and p large, we have

a∈F×p
|W(a; p)|2k = νk + O(p−1/2),
where νk is the multiplicity of the trivial representation of the geometric monodromy
group in the representation End( ¯Qd−1
ℓ
)⊗k. By character theory for compact groups,
we have
νk =

Kd
|tr(g)|2kdμ(g)
for a maximal compact subgroup Kd of the geometric monodromy group, where μ
is the Haar measure on Kd normalized to have total volume 1. We can take Kd =
SUd−1(C) if the geometric monodromy group is SLd−1 and Kd = USpd−1(C) if it
is Spd−1.

Exponential Sums, Twisted Multiplicativity, and Moments
329
7
Multiple Correlations
We now come to Theorem 1.11. For the ﬁrst part, we apply Theorem 1.5 to the
function a →|Wf (a; q)Wg(a; q)|2. We can take M = (df −1)2(dg −1)2. By
Proposition 6.9, we have
1
p

(a,p)=1
|Wf (a; p)Wg(a; p)|2 = 1 + O(p−1/2)
so we can take g(p) = 1 + O(p−1/2). Thus, Theorem 1.5 gives, for some
constant C ⩾0, the bound

q⩽x
|Wf (a; q)Wg(a; q)|2 ≪
x
log x

p⩽x

1 + 1
p +
C
p3/2

(log log x)(df −1)2(dg−1)2
≪x(log log x)(df −1)2(dg−1)2.
For the second part, we apply Theorem 1.5 to the functions
a →|W1(a; q) · · · Wm(a; q)|,
a →|W1(a; q) · · · Wm(a; q)|2,
a →|W1(a; q) · · · Wm(a; q)|4
and argue as in the proof of Theorem 1.1 using Corollary 6.8.
8
Remarks on Katz’s Theorem
We want to observe that Katz’s Theorem (Theorem 6.3) can be explained, in the
case of monodromy SLd−1, as the combination of two facts:
(1) The local monodromy computation (13), which has an intuitive meaning as the
algebraic analogue of the stationary phase expansion for oscillatory integrals
g(t) =

eitf (x)dx,
(2) A result of Gabber (see [22, Th. 1.0]) which (essentially) deduces the nature of
the monodromy group from the Sidon property of the critical values.

330
E. Kowalski and K. Soundararajan
Since the proof of Gabber’s result, in this special case, is relatively accessible
and (in our opinion) quite enlightening with respect to the relevance of the Sidon
condition, we include the precise statement and its proof.
Proposition 8.1 Let V be a ﬁnite-dimensional complex vector space of dimension
r ⩾1, and let G be a connected semisimple compact subgroup of GL(V ) which acts
irreducibly on V . Let D be the subgroup of elements of GL(V ) which are diagonal
with respect to some basis, and let χi, for 1 ⩽i ⩽r, be the characters D →C×
giving the coefﬁcients of the elements of D.
Let A ⊂D be a subgroup of the normalizer of G in GL(V ). Let S ⊂	
A be the
subset of the group of characters of A given by the restrictions to A of the diagonal
characters χi. If |S| = r and S is a Sidon set in 	
A, then G = SU(V ).
Proof We denote by Z ⊂D the subgroup of scalar matrices. We may assume that
G ⊂U(V ).
The group G is a compact real Lie group. We consider the representation of
the group A on End(V ) by conjugation. It acts on the elementary matrices Ei,j by
χiχ−1
j . The assumption that S has r elements and is a Sidon set means then that
End(V ) =
N
i,j
CEi,j
is a decomposition of the representation as a sum of characters where, for i ̸= j, the
line CEi,j is a non-trivial character of multiplicity one.
Since A ⊂NGL(V )(G), the complexiﬁed Lie algebra L ⊂End(V ) of G is
a subrepresentation of the representation of A on End(V ). Thus, there exists a
subspace H of the diagonal matrices and a subset X of pairs (i, j) of distinct integers
such that
L = H ⊕
N
(i,j)∈X
CEi,j.
This implies that L is in fact stable under conjugation by all of D. We have therefore
an induced morphism
D →Aut(L),
which induces an injective morphism D/Z →Aut(L). Its image is contained in
the neutral component of Aut(L). Since L is semisimple, the latter is equal to the
adjoint group of G (see, e.g., [2, p. 244, Prop. 30, (ii)]). It follows that the connected
semisimple group G ⊂SU(V ) has rank r −1; it follows that G = SU(V ) (e.g.,
by the Borel–de Siebenthal Theorem: the group G coincides with the connected
component of the identity of the centralizer in SU(V ) of the center of G, for instance
by [4, p. 36, prop. 13], and the center is contained in the group of scalar matrices by
Schur’s Lemma, so its centralizer is SU(V )).
⊓⊔

Exponential Sums, Twisted Multiplicativity, and Moments
331
This proposition is applied to a conjugate of the ﬁnite subgroup A of elements of
the form
diag(e(xv1/p), . . . , e(xvd−1/p))
where (v1, . . . , vd−1) are the critical values of f ; indeed, the local monodromy
computation implies that such a subgroup is contained in a maximal compact
subgroup of the monodromy group.
Acknowledgments E.K. was partially supported by a DFG-SNF lead agency program grant (grant
number 200020L_175755). K.S. is partially supported through a grant from the National Science
Foundation and a Simons Investigator Grant from the Simons Foundation. This work was started
when K.S. was a senior Fellow at the ETH Institute for Theoretical Studies, whom he thanks for
their warm and generous hospitality.
We thank W. Sawin for his comments concerning Sect. 5.
References
1. Bourbaki, N.: Groupes et algèbres de Lie, chapitre III. Springer
2. Bourbaki, N.: Groupes et algèbres de Lie, chapitre VI. Springer.
3. Bourbaki, N.: Groupes et algèbres de Lie, chapitre VIII. Springer
4. Bourbaki, N.: Groupes et algèbres de Lie, chapitre IX. Springer
5. Bourgain, J.: On the maximal ergodic theorem for certain subsets of the integers. Isr. J. Math.
61, 39–72 (1988)
6. Bourgain, J.: An approach to pointwise ergodic theorems. In: Geometric Aspects of Functional
Analysis (1986/87). Lecture Notes in Math., vol. 1317, pp. 204–223. Springer (1988)
7. Bourgain, J.: Pointwise ergodic theorems for arithmetic sets. Publications Mathématiques de
l’IHéS 69, 5–41 (1989)
8. Bourgain, J., Kontorovich, A.: On the local-global conjecture for integral Apollonian gaskets,
with an appendix by Péter Varjú. Invent. math. 196, 589–650 (2014)
9. Cassou-Noguès, P., Couveignes, J.M.: Factorisations explicites de g(y) −h(z). Acta Arith. 87,
291–317 (1999)
10. Curtis, C., Reiner, I.: Representation Theory of Finite Groups and Associative Algebras,
vol. 356. AMS Chelsea Publishing (1962)
11. Deligne, P.: La conjecture de Weil, II. Publ. Math. IHÉS 52, 137–252 (1980)
12. Fouvry, É., Michel, Ph.: À la recherche de petites sommes d’exponentielles. Annales de
l’Institut Fourier 52, 47–80 (2002)
13. Fouvry, É., Michel, Ph.: Sommes de modules de sommes d’exponentielles. Paciﬁc J. Math.
209, 261–288 (2003); erratum, Paciﬁc J. Math. 225, 199–200 (2006)
14. Fouvry, É., Kowalski, E., Michel, Ph.: A study in sums of products. Phil. Trans. R. Soc. A 373,
20140309 (2014)
15. Fouvry, É., Kowalski, E., Michel, Ph.: Algebraic twists of modular forms and Hecke orbits.
Geom. Funct. Anal. 25, 580–657 (2015); https://doi.org/10.1007/s00039-015-0310-2
16. Fried, M.: On a conjecture of Schur. Michigan Math. J. 17, 41–55 (1970)
17. Fried, M., Jarden, M.: Field arithmetic. Ergebnisse der Math., vol. 11. Springer (2008)
18. Hooley, C.: On the distribution of the roots of polynomial congruences. Mathematika 11, 39–49
(1964)
19. Iwaniec, H., Kowalski, E.: Analytic Number Theory, vol. 53. AMS Colloquium Publ., (2004)

332
E. Kowalski and K. Soundararajan
20. Katz, N.M.: Gauss sums, Kloosterman sums and monodromy groups. Annals of Math. Studies,
vol. 116. Princeton Univ. Press (1988)
21. Katz, N.M.: Perversity and exponential sums. In: Algebraic Number Theory in honor of K.
Iwasawa. Adv. Studies Pure Math., vol. 17, pp. 209–259 (1989)
22. Katz, N.M.: Exponential sums and differential equations. Annals of Math. Studies, vol. 124.
Princeton Univ. Press (1990)
23. Katz, N.M.: Larsen’s alternative, moments and the monodromy of Lefschetz pencils. In:
Contributions to Automorphic Forms, Geometry, and Number Theory (Collection in Honor
of J. Shalika’s 60th Birthday), pp. 521–560. J. Hopkins Univ. Press (2004)
24. Katz, N.M., Sarnak, P.: Random matrices, Frobenius eigenvalues and monodromy. Colloquium
Publ., vol. 45. A.M.S., (1999)
25. Kowalski, E.: An introduction to the representation theory of groups. Grad. Studies in Math.,
vol. 155. A.M.S., (2014)
26. Kowalski, E., Soundararajan, K.: Equidistribution from the Chinese remainder theorem. Adv.
Math. 385, 107776 (2021)
27. Kowalski, E., Michel, Ph., Sawin, W.: Bilinear forms with Kloosterman sums and applicatins.
Annals Math. 186, 413–500 (2017)
28. Patterson, S.J.: On the distribution of certain Hua sums, II. Asian J. Math. 6, 719–730 (2002)
29. Patterson, S.J.: The asymptotic distribution of exponential sums, II. Experiment. Math. 14,
87–98 (2005)
30. Perret-Gentil, C.: Gaussian distribution of short sums of trace functions over ﬁnite ﬁelds. Math.
Proc. Camb. Phil. Soc. 163, 385–422 (2017)
31. Shao, X.: Polynomial values modulo primes on average and sharpness of the larger sieve.
Algebra Number Theory 9, 2325–2346 (2015)
32. Shiu, P.: A Brun-Titchmarsh theorem for multiplicative functions. J. Reine Angew. Math. 313,
161–170 (1980)
33. Turnwald, G.: On Schur’s conjecture. J.. Aust. Math. Soc. 58, 312–357 (1995)

The Ternary Goldbach Problem with a
Missing Digit and Other Primes of
Special Types
Helmut Maier and Michael Th. Rassias
Dedicated to the Memory of Jean Bourgain
Abstract The goal of the present paper is to prove on assumption of the Gen-
eralized Riemann Hypothesis that each sufﬁciently large odd integer N0 can be
expressed in the form
N0 = p1 + p2 + p3 ,
where p1, p2 are Piatetski-Shapiro primes and p3 is a prime with a missing digit.
2010 Mathematics Subject Classiﬁcation: 11P32, 11N05, 11A63
1
Introduction
The ternary Goldbach problem concerns the representation of a large odd integer N
as a sum of three primes. It was ﬁrst treated by Vinogradov [15] for arbitrary primes
(cf. [13]). Helfgott [5] showed that this is true for all odd N ≥7.
The problem was later modiﬁed by the request that the primes be of special type.
Balog and Friedlander [1] considered the ternary Goldbach problem with variables
restricted to Piatetski-Shapiro primes.
H. Maier
Department of Mathematics, University of Ulm, Ulm, Germany
e-mail: helmut.maier@uni-ulm.de
M. Th. Rassias ()
Department of Mathematics and Engineering Sciences, Hellenic Military Academy, Vari Attikis,
Greece
Institute for Advanced Study, Program in Interdisciplinary Studies, Princeton, NJ, USA
e-mail: michail.rassias@math.uzh.ch
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
A. Avila et al. (eds.), Analysis at Large, https://doi.org/10.1007/978-3-031-05331-3_14
333

334
H. Maier and M. Th. Rassias
In [10], H. Maier and M. Th. Rassias showed that on assumption of the Generalized
Riemann Hypothesis each sufﬁciently large odd integer is the sum of a prime and
two isolated primes. For other combinations of the types, see [1–3, 8, 9, 14].
The goal of the present paper is the proof of the following:
Theorem 1.1 On assumption of the Generalized Riemann Hypothesis (GRH), each
sufﬁciently large odd integer N0 can be represented in the form
N0 = p1 + p2 + p3 ,
where for i = 1, 2 the pi are of the form pi = [nc0
i ], ni ∈N, with c0 = 1/γ0,
γ ∗< γ0 ≤1, where
γ ∗= 8
9 + 2
3
log(10/9)
log 10
(≈0.919 . . .)
and the decimal expansion of p3 does not contain the digit a0.
2
Outline of the Proof
In the sequel, we provide the main ideas as well as a sketch of proofs of the key
statements. For a more detailed presentation of the proof, the reader is referred to
[11].
One ingredient of the proof is Maynard’s approach [12] using sieve decompositions
based on ideas of Harman [4]. Another ingredient is the discrete circle method.
We recall the following deﬁnition from [11] which we complement by a few new
deﬁnitions.
Deﬁnition 2.1 Let a0 ∈{0, 1, . . . , 9}, k ∈N, and let
A :=
⎧
⎨
⎩

0≤i≤k
ni10i : ni ∈{0, 1, . . . , 9} \ {a0}
⎫
⎬
⎭,
X := 10k , B := {n ≤X, n ∈N} ,
P the set of prime numbers,
SA(θ) :=

a∈A
e(aθ) , SP(θ) :=

p≤x
e(pθ) , SA∩P(θ) :=

p∈A∩P
e(pθ) .
Let C be a set of integers. We deﬁne the characteristic function 1C by

The Ternary Goldbach Problem with a Missing Digit and Other Primes of Special Types
335
1C(n) :=
!1 ,
if n ∈C
0 ,
if n ̸∈C .
For d ∈N, we set
Cd := {c : cd ∈C}.
The sifted set U(C, z) is deﬁned by
U(C, z) := {c ∈C : p | c ⇒p > z} .
The sieving function S(C, z)—the counting function of U(C, z)—is given by
S(C, z) := #U(C, z) = #{c ∈C : p | c ⇒p > z} .
We let
wn := 1A(n) −κA#A
#B
,
κA :=
⎧
⎪⎨
⎪⎩
10((10) −1)
9(10)
,
if (10, a0) = 1
10
9 ,
otherwise ,
Sd(z) :=

n<X/d
p|n ⇒p>z
wnd = S(Ad, z) −κA#A
X
S(Bd, z) ,
1A(n) is called the A −part of wn ,
S(Ad, z) is called the A −part of Sd(z) ,
The B-parts are deﬁned analogously.
We also deﬁne the exponential sums
S(C, z, θ) :=

n∈U(C,z)
e(nθ) ,
Sd(z, θ) :=

n<X/d
p|n ⇒p>z
wnde(nθ) = S(Ad, z, θ) −κA#A
X
S(Bd, z, θ) , (θ ∈R) .
The essential idea of Harman’s sieve is contained in Harman [4], Theorem 3.1
from [4] (The Fundamental Theorem).

336
H. Maier and M. Th. Rassias
Suppose that for any sequences of complex numbers, am, bn, that satisfy |am| ≤1,
|bn| ≤1, we have for some λ > 0, α > 0, β ≤1/2, M ≥1 that

mn∈A
m≤M
am = λ

mn∈B
m≤M
am + O(Y)
(1)
and

mn∈A
Xα≤m≤Xα+β
ambn = λ

mn∈B
ambn + O(Y) ,
(2)
where Y is a suitably chosen constant.
Let cr be a sequence of complex numbers, such that |cr| ≤1, and if cr ̸= 0, then
p | r ⇒p > xϵ , for some ϵ > 0.
(3)
Then, if Xα < M, 2R < min(Xα, M) and M > X1−α, if 2R > Xα+β, we have

r∼R
crS(Ar, Xβ) = λ

r∼R
crS(Br, Xβ) + O(Y log3 X) .
(4)
Equation (1) is known as type I information, whereas (2) is known as type II
information.
In the application of Theorem 3.1, information about a (complicated) set A is
obtained from that of a (simple) set B.
In Maynard’s paper [12], the sets A and B are those from Deﬁnition 2.1. In a ﬁrst
step of the sieve decomposition, the counting function of interest #{p ∈A} is broken
up as follows:
#{p ∈A} = #{p ∈A : p > X1/2} + O(X1/2)
= S1(z4) + (1 + o(1)) κA#A
log X (here z4 = X1/2) .
The function S1 is now replaced in a series of steps by other terms of the form Sd.
These steps consist in the application of Buchstab’s recursion:
Let u1 < u2. Then,
S(C, u2) = S(C, u1) −

u1<p≤u2
S(Cp, p) .
(5)
In the transformation of the form
Sd(z) = S(Ad, z) −κA#A
log X S(Bd, z) ,

The Ternary Goldbach Problem with a Missing Digit and Other Primes of Special Types
337
(5) is now applied separately with C = Ad and C = Bd, and we get the recursion:
S1(u2) = S1(u1) −

u1<p≤u2
Sp(p) .
An important observation is that “the counting function version” of the Buchstab
recursion is linked to a “characteristic function version.”
1U(C,u2)(n) = 1U(C,u1)(n) −

u1<p≤u2
1U(Cp,p)(n) .
(6)
In our paper, the discrete circle method is applied, and therefore, we multiply (6)
with the exponential function e(nθ) (= e2πinθ) to obtain
1U(C,u2)(n)e(nθ) = 1U(C,u1)(n)e(nθ) −

u1<p≤u2
1U(Cp,p)(n)e(nθ) .
(7)
We get the following version of Buchstab’s recursion, which we state as
Lemma 2.2 Let u1 < u2. Then,
S(C, u2, θ) = S(C, u1, θ) −

u1<p≤u2
S(Cp, p, θ) .
(8)
We introduce another modiﬁcation in our paper. Instead of considering all the
integers in A as possible candidates for our representation of N0, we now only
choose the integers from a subset A∗of A, which are contained in a short subinterval
of B.
Deﬁnition 2.3 Let H ∈N, H ≤k. For
n =
k

j=1
nj10j, (nj ∈{0, . . . , 9}),
we write
nH,1 :=
k

j=k−H+1
nj10j =: ˜nH · 10k−H+1
and
nH,2 :=
k−H

j=0
nj10j .

338
H. Maier and M. Th. Rassias
Lemma 2.4 Let n = ˜nH · 10k−H+1 as in Deﬁnition 2.3. Then,
n ∈A if and only if ˜nH ∈A and nH,2 ∈A
(9)
There is an integer ˜nH ∈A ∩[0, 10H−1] such that for n∗
H := ˜nH10k−H+1 we have
the following:
n∗
H −5 · 10k−1 ≤3
2 10k−2
(10)
and for nH,2 ∈B∗:= [n∗
H, n∗
H + 10k−H ), the following holds:
n∗
H + nH,2 ∈A ⇒nH,2 ∈A .
(11)
Proof Equation (9) is obvious. To show (10) and (11), we consider the following
cases:
Case 1: a0 = 5, Case 2: a0 = 4, Case 3: a0 ̸∈{4, 5}.
Speciﬁcally, we have the following:
Case 1: Let nk−i ∈{0, . . . , 9} \ {a0} for 2 ≤i ≤H −1. Then, we may take
n∗= 4, 9 · 10k +
k−2

j=k−H+1
nj10j .
Case 2: Let nk−i ∈{0, . . . , 9} \ {a0} for 3 ≤i ≤H −1. Then, we may take
n∗= 5, 09 · 10k +
k−3

j=k−H+1
nj10j .
Case 3: The choices for n∗in cases 2 and 3 are both possible.
⊓⊔
Convention In the sequel, we have many estimates and deﬁnitions containing
positive constants C1, C2, . . . (actually powers (log X)Ci ). The Ci must satisfy
certain conditions, which will be described. However, it will always be possible
to choose the Ci, such that the mini Ci is arbitrarily large. An estimate containing
O

D(x)(log X)−A
(D(x) a certain function of X) means that A > 0 may be taken
arbitrarily large if mini Ci is sufﬁciently large.
Deﬁnition 2.5 We deﬁne X by 2X ≤N0 < 20X. We then deﬁne
Int(N0) =
N0 −n∗
H
2
−X
8 , N0 −n∗
H
2
+ X
8

,
(12)

The Ternary Goldbach Problem with a Missing Digit and Other Primes of Special Types
339
Sc0(θ) := 1
γ

p∈Int(N0)
p=[n1/γ ]
(log p)1−γ e(pθ) .
Let S ⊆[1, X] be a set of positive integers and v(n) be a sequence of real
numbers. For the exponential sum
E(θ) :=

n∈S
v(n)e(nθ)
(13)
we deﬁne
J(E) := 1
X

1≤a≤X
E
 a
X

S2
c0
 a
X

e

−N0
a
X

(14)
J(E, τ) := 1
X

a
X ∈T
E
 a
X

S2
c0
 a
X

e

−N0
a
X

for a subset T ⊆[0, 1] and the mean value
M(E) :=

(m,p2,p3)
m∈S,p2,p3∈Pc0,pi∈Int(N0)
m+p2+p3=N0
p1−γ
2
p1−γ
3
(log p2)(log p3)v(m) ,
The evaluation of J(E) is also called the a-variable circle method.
Lemma 2.6 We have J(E) = M(E).
Proof This follows by orthogonality.
⊓⊔
Instead of wn, Sd(z) from Deﬁnition 2.1, we now consider the expression given in
Deﬁnition 2.7 We determine H by 10H = ⌈(log X)C1⌉. Let n∗= n∗
H, which has
been constructed in Lemma 2.4, B∗as in Lemma 2.4 and A∗= A ∩B∗.
We let
w∗
n := 1A∗(n) −κA#A∗
#B∗
S∗
d(z) :=

n<X/d
p|n ⇒p>z
w∗
nd = S(A∗
d, z) −κA#A∗
#B∗
S(B∗
d, z)
1A∗
d(n) is called the A-part of w∗
n.
S(A∗
d, z) is called the A-part of S∗
d(z).

340
H. Maier and M. Th. Rassias
The B-parts are deﬁned analogously. The analogue of Lemma 2.2 leads to an
identity.
SA∗∩P(θ) =

j
Ej(θ) ,
where the exponential sums Ej(θ) are extended over integers n = p1 . . . pl, deﬁned
by linear inequalities to be satisﬁed by the vector
log p1
log X , . . . , log pl
log X

.
We also deﬁne the exponential sums
S∗
d(z, θ) =

n∈B∗
p|n ⇒p>z
w∗
nd = S(A∗
d, z, θ) −κA#A∗
#B∗
S(B∗
d, z, θ) .
For the evaluation of the sums J(E) from (14) by the a-variable circle method, we
partition the set { a
X : 1 ≤a ≤X} into the two subsets of the major arcs and the
minor arcs.
Deﬁnition 2.8 We set Q0 = (log X)3. For q ≤X, 1 ≤c ≤q, (c, q) = 1 and
L ∈[1, ∞), we set
Ic,q(L) :=
 c
q −q−1X−1L, c
q + q−1X−1L

.
We let L0 = (log X)C1, L1 = X1/5. The major arcs M are deﬁned as
M :=

q≤Q0
(c,q)=1
Ic,q(L0) .
The minor arcs m are deﬁned as
m := [0, 1] \ M .
For the evaluation of Sc0

c
q + ξ

, we apply the approach of Balog and Friedlan-
der [1].
We now obtain a local version of the result of Maynard [12]. Instead of considering
the sets Cd with C = A and B appearing in the Buchstab recursion in Lemma 2.2,
we now consider the sets Cd with
C∗= Cq,s := {m ∈C : m ≡s mod q} ,

The Ternary Goldbach Problem with a Missing Digit and Other Primes of Special Types
341
where C = A∗or B∗as deﬁned in Deﬁnition 2.7.
We carry out the type I and type II estimates closely following Maynard [12],
obtaining the contributions to J(E) of the major arcs of the a-variable circle method.
These type II estimates are based on the b-variable circle method:
Let R be a subset of B∗, J = A∗∩R. Then, we have
SJ (θ) = 1
X

1≤b≤X
SA
 b
X

SR

−
 b
X −θ

.
The minor arcs of the a-variable circle method ﬁnally are treated by estimates of
large sieve type and by estimates of exponential sums over prime numbers.
3
Structure of the Paper
In Sect. 4, we carry out the sieve decomposition of the local version of Maynard
[12] involving the exponential sums instead of counting functions and the sets A∗
and B∗contained in short intervals.
We shall reduce the proof of Theorem 1.1 to the proof of three Propositions:
Proposition 4.2 our type I estimate, Proposition 4.3 our type II estimate, and
Proposition 4.5 in which the A-part is estimated trivially. All these propositions
contain convolutions of the sums appearing in the Buchstab iterations with the
Piatetski-Shapiro sums.
In Sect. 6, we reduce Propositions 4.2, 4.3, and 4.5 to the local version of Maynard’s
result, Propositions 6.2 and 6.4, which do not involve the Piatetski-Shapiro sum.
Proposition 6.2 is handled by a method from combinatorial sieve theory, replacing
the Möbius function by functions with smaller support and Fourier analysis to ﬁx
locations and residue classes.
The proof of Proposition 4.3 is carried out by the classical circle method.
In Sect. 7, the ranges of summation are partitioned in small boxes.
These are now handled by the b-variable circle method, closely following Maynard
[12]. The dependency graph between the main statements is as follows:
Prop. 8.1
Prop. 8.2
Prop. 8.3
Prop. 7.2
Prop. 6.4
Prop. 4.3
Prop. 4.5
Prop. 4.2
Prop. 6.2
Theorem 1.1

342
H. Maier and M. Th. Rassias
4
Sieve Decomposition and Proof of Theorem 1.1
We now describe the modiﬁcation of Maynard’s method of sieve decomposition
and the reduction of the proof of Theorem 1.1 to the proof of three propositions,
Propositions 4.2, 4.3, and 4.5, in which the various types of information are used:
type I information in Proposition 4.2, type II information in Proposition 4.3, whereas
in Proposition 4.5 neither type I nor type II information are used.
Deﬁnition 4.1 Let η ∈(0, 1). Let v(n, η)n∈S be a family of sequences of real
numbers, indexed by the parameter η, S ﬁnite. The family of exponential sums
E(θ; η) :=

n∈S
v(n, η)e(nθ)
is called negligible, if
lim
η→0 lim sup
k→∞
|J(E)| log X
(#A∗)X
= 0.
The term “negligible" will also be applied to an individual exponential sum E(θ)
of the family E(θ, η).
Proposition 4.2 (Sieve Asymptotic Terms) Let ϵ > 0, 0 < η0 ≤θ2−θ1, l = l(η0)
be ﬁxed, where
θ1 = 9
25 + 2ϵ and θ2 = 17
40 −2ϵ.
Let L be a set of Oη0(1) afﬁne linear functions, L : Rl →R. Let
E0 := E0(θ, η0) =
∼

Xη0≤p1≤···≤pl
S∗
p1···pl(Xη0, θ) ,
where ∼indicates that the summation is restricted by the condition
L
log p1
log X , . . . , log pl
log X

≥0 ,
for all L ∈L.
Then, E0 is negligible.
Proposition 4.3 (Type II Terms) Let l = l(η0), θ1, θ2, L be as in Proposition 4.2,
and let I = {1, . . . , l} and j ∈{1, . . . , l},

The Ternary Goldbach Problem with a Missing Digit and Other Primes of Special Types
343
E1(θ, η0) :=
∼

Xη0≤p1≤···≤pl
Xθ1≤
i∈I pi≤Xθ2
p1···pl≤X/pj
S∗
p1···pl(pj, θ) ,
E2(θ, η0) :=
∼

Xη0≤p1≤···≤pl
X1−θ2≤
i∈I pi≤X1−θ1
p1···pl≤X/pj
S∗
p1···pl(pj, θ) ,
where ∼indicates the same restriction as in Proposition 4.2.
Then, E1 and E2 are negligible.
Deﬁnition 4.4 The Buchstab function ω is deﬁned by the delay-differential equa-
tion
ω(u) = 1
u , 1 ≤u ≤2 ,
ω′(u) = ω(u −1) −ω(u) , u > 2 .
For ⃗p = (p1, . . . , pl), pi primes for 1 ≤i ≤l, let
Log( ⃗p) =
log p1
log X , . . . , log pl
log X

.
Let C be a set of O(1) afﬁne linear functions. Let the polytope R be deﬁned by
R = {(u1, . . . , ul) ∈[0, 1]l : L(u1, . . . , ul) ≥0 for all L ∈L} .
Let
$( ⃗p) = p1 · · · pl ,
S(N0) =

p∤N0

1 +
1
(p −1)3
 
p|N0

1 −
1
(p −1)2

.
Proposition 4.5 Let l ∈N, δ > 0,
z : [0, 1]l →[δ, 1 −δ], ⃗u = (u1, . . . , ul) →z(⃗u) = z(u1, . . . , ul)
be continuous. Let

344
H. Maier and M. Th. Rassias
E(θ) :=

⃗p : Log( ⃗p)∈R
S(B∗( ⃗p), Xz(Log( ⃗p)), θ) .
Then,
J(E(θ)) = X(#B∗)
4 log X S0(N0)

· · ·

R
ω(1 −u1 −· · · −ul)
u1 · · · ulz(u1, . . . , ul) du1 . . . dul(1+o(1)).
We now replace each Buchstab recursion in the counting function version in
Maynard [12] by its exponential sum version.
In each step in [11], in which Proposition 4.2 or Proposition 4.3 is applied, we deal
with a negligible sum, which does not inﬂuence the asymptotics.
Each of the nine applications of Proposition 4.5 leads to a change of the estimate
proportional to an integral Ii (1 ≤i ≤9). The main result of Theorem 1.1 is
obtained by the estimate
I1 + · · · + I9 ≤0.996 < 1 .
(Maynard [12] has included a Mathematica® ﬁle detailing this computation with
his article on arxiv.org).
This computation is also applicable to our sequence of Buchstab recursions in the
exponential sum version and leads to the proof of Theorem 1.1.
5
Fourier Estimates and Large Sieve Inequalities
An important question to be settled is the distribution of the elements with missing
digits on congruence classes. Closely linked to that question is the estimate of
exponential sums extended over these integers, which also appear in the application
of the b-variable circle method.
These exponential sums are deﬁned by the following:
Deﬁnition 5.1 Let
A1 :=
⎧
⎨
⎩

0≤i≤k
ni10i : ni ∈{0, . . . , 9} \ {a0}, k ≥0
⎫
⎬
⎭.
For Y an integral power of 10, we write
FY (θ) := Y −log 9/ log 10


n<Y
1A1(n)e(nθ)
 .

The Ternary Goldbach Problem with a Missing Digit and Other Primes of Special Types
345
From the facts used about FY (θ), we just give Lemma 5.2 (Lemma 10.5 of [12]).
For the full list, see [11].
Lemma 5.2 (Large Sieve Estimates) We have
sup
β∈R

c≤q
sup
|η|<δ
FY
 c
q + β + η

≪(1 + δq)

q27/77 +
q
Y 50/77

sup
β∈R

q≤Q

0<c<q
(c,q)=1
sup
|η|<δ
FY
 c
q + β + η

≪(1 + δQ2)

Q54/77 +
Q2
Y 50/77

,
and for any integer d, we have
sup
β∈R

q≤Q
d|q

0<c<q
(c,q)=1
sup
|η|<δ
FY
 c
q + β + η

≪

1 + δQ2
d
 (Q2
d
27/77
+
Q2
dY 50/77
)
.
6
Local Versions of Maynard’s Results
The propositions of Sect. 4 now are reduced to other facts to be proven later.
The proof of all three propositions employs the circle method: the discrete (a-
variable) circle method for Propositions 4.2 and 4.3 and the classical continuous
variable circle method for Proposition 4.5. Whereas the minor arcs contributions for
all three cases are very similar, using estimates of the Piatetski-Shapiro sum due to
Balog and Friedlander and of exponential sums over prime numbers, there are major
differences in the treatment of the major arcs contributions.
In contrast to Propositions 4.3 and 4.5, where the sifted sets appear as a union of
simpler sets, the set considered in Proposition 4.2 is obtained by a modiﬁcation of
the inclusion-exclusion principle appearing in the sieve of Eratosthenes. We recall
the relation to the Möbius function μ(·):
Let C be a set of integers and P a set of primes. Then,
S(C, P, z) := #{n ∈C : p | n, p ∈P ⇒p > z}
=

n∈C

t|n
t|P(z)
μ(t) , with P(z) :=

p≤z
p∈P
p .
A basic idea in the theory of combinatorial sieves is the replacement of the
Möbius function by a function λ, having smaller support.

346
H. Maier and M. Th. Rassias
This is also done in the proof of Proposition 4.2: the Möbius function μ is replaced
by two functions λ+ and λ−, and we consider the exponential sums
S(C, z, θ, λ) :=

n∈C
e(nθ)
⎛
⎜⎜⎝

t|n
t|P(z)
λ(t)
⎞
⎟⎟⎠
for λ = λ+ and λ−.
We recall the following result from combinatorial sieve theory:
Lemma 6.1 (Fundamental Lemma 6.3 of [7]) Let κ > 0 and y > 1. There exist
two sets of real numbers
+ = (λ+
d ) and −= (λ−
d )
depending only on κ and y with the following properties:
λ±
1 = 1
(15)
|λ±
d | ≤1 , if 1 ≤d < y
(16)
λ±
d = 0 , if d ≥y
and for any integer n > 1,

d|n
λ−
d ≤0 ≤

d|n
λ+
d .
(17)
Moreover, for any multiplicative function g(d) with 0 ≤g(p) < 1 and satisfying
the dimension conditions

w≤p<z
(1 −g(p))−1 ≤
 log z
log w
κ 
1 +
κ
log w

for all 2 ≤w < y, we have

d|P(z)
λ±
d g(d) =
(
1 + O
(
e−s

1 +
κ
log z
10)) 
p<z
(1 −g(p)) ,
where P(z) denotes the product of all primes p < z and s = log y/ log z. The
implied constants depend only on κ.

The Ternary Goldbach Problem with a Missing Digit and Other Primes of Special Types
347
We then show Proposition 6.2 and ﬁnally reduce the proof of Proposition 4.2 to
Proposition 6.2 and Proposition 4.3.
We ﬁrst give the statement and sketch of proof for Proposition 6.2.
Proposition 6.2 Let ϵ > 0, 0 < η0 ≤θ2 −θ1, l = l(η0) be ﬁxed. Let L and
the summation condition ∼be as in Proposition 4.2, q ≤Q0, (c, q) = 1. Let
λ± satisfy the properties of Lemma 6.1 with y = X(η1/2
0
), and let λ±(t) = 0, if
(t, 10) > 1. Then, we have for λ = λ−or λ+:
∼

Xη0≤p1≤···≤pl

S

A∗
p1...pl, Xη0, c
q , λ

−κA#A∗
#B∗
S

B∗
p1...pl, Xη0, c
q , λ

= O

(#A∗)(log X)−A
.
Proposition 6.2 is proved by the use of exponential sum estimates from Section
5 to the A-part.
The same computation is now carried out for B∗instead of A∗. One ﬁnds that the
leading terms in the summation of Proposition 6.2 cancel.
From Proposition 6.2, we now deduce the following:
Lemma 6.3 Let
E0,A∗,λ(θ) =
∼

xη0≤p1≤···≤pl
S(A∗
p1···pl, Xη0, θ, λ)
E0,B∗,λ(θ) =
∼

xη0≤p1≤···≤pl
S(B∗
p1···pl, Xη0, θ, λ)
Then, for λ = λ−or λ+, we have
1
X

1≤a≤X

E0,A∗,λ
 a
X

−κA
#A∗
#B∗E0,B∗,λ
 a
X

S2
c0
 a
X

e

−N0
a
X

= O

#A∗X(log X)−A
.
From Lemma 6.1, we conclude
lim sup
k→∞
|J(E(θ, η∗, μ))| log X
|A∗|X
< ϵ , for η ≥η0 .
We modify the analysis given in [12], p. 156, to pass from Xη0 to Xθ2−θ1.

348
H. Maier and M. Th. Rassias
Given a set C and an integer d, we let
Tm(C; d, θ) :=

Xη≤p′
m≤···≤p′
1≤Xθ
dp′
1···p′m≤Xθ1
S(Cp′
1···p′m, Xη, θ)
Um(C; d, θ) :=

Xη≤p′
m≤···≤p′
1≤Xθ
dp′
1···p′
m≤Xθ1
S(Cp′
1···p′m, p′
mXη, θ)
Vm(C; d, θ) :=

Xη<p′m≤···≤p′
1≤Xθ
S(Cp′
1···p′m, p′
m, θ).
Buchstab’s identity shows that
Um(C; d, θ) = Tm(C; d, θ) −Um+1(C; d, θ) −Vm+1(C; d, θ)
The Tm-terms are now handled by Lemma 6.3, whereas the Vm-terms are reduced
to Proposition 4.3.
Proposition 4.3 is deduced from the following:
Proposition 6.4 (Type II Terms, Local Version) Let ϵ, η0, l, L, ˜ , q, c, t be as in
Proposition 6.2. Then, we have
∼

Xη0≤p1≤···≤pl

S

A∗
p1...pl, Xη0, c
q , λ

−κA#A∗
#B∗
S

B∗
p1...pl, Xη0, c
q , λ

= O

(#A∗)(log X)−A
.
As in the proof of Proposition 4.2, Proposition 4.3 is deduced from Proposi-
tion 6.4 by replacing the variable factors e

n

c
q + ξ

by e(n0ξ)e

n c
q

with
n0 ∈B∗.
Proposition 4.5 is proven by the classical circle method. Furthermore, one uses the
connection between the Buchstab function and the number of integers free of small
prime factors as well as the equidistribution of these integers on residue classes
modq.

The Ternary Goldbach Problem with a Missing Digit and Other Primes of Special Types
349
7
Sieve Asymptotics for Local Version of Maynard
We now shall reduce Proposition 6.4 to Proposition 7.2 stated below. The range of
the summation in Proposition 6.2 is deﬁned by several sets of linear forms of the
vectors
Log(1)(n) :=
log ˜p1
log X , . . . , log ˜pv
log X

,
(18)
where n = ˜p1 · · · ˜pv.
(1) The linear forms from L, included by ∼.
(2) The linear forms related to the conditions
n ∈A∗
p1···pv , p | n ⇒p > pj .
(3) The linear forms related to the chain of inequalities
p1 ≤· · · ≤pv .
(4) The linear forms analogous to (3) related to the other prime factors.
All the linear forms from (1) to (4) now form a set
L∗:=

v
˜L(v) ,
(19)
where v denotes the total number of prime factors.
To be able to describe the set of integers satisfying these linear inequalities by a
polytope, we pass from the vector Log(1) in (19) to the vector
Log(2)(n) :=
log ˜p1
log n , . . . , log ˜pv
log n

.
(20)
Obviously,
Log(2)(n) ∈Qv(η) := {(x1, . . . , xn) ∈Rv, η ≤x1 ≤· · · ≤xv, x1+· · ·+xv = 1}.
By a closed convex polytope in Rv, we mean a region R deﬁned by a ﬁnite number
of non-afﬁne linear inequalities in the coordinates (equivalently, this is the convex
hull of a ﬁnite set of points in Rv).
Given a closed convex polytope R ⊆Ql(η), we let
1R(n) :=
! 1 ,
if n = p1 · · · pv with Log(2)(n) ∈Rv
0 ,
otherwise ,

350
H. Maier and M. Th. Rassias
We now let 5
R ⊆[η, 1]v−1 denote the projection of R onto the ﬁrst v −1
coordinates (which is also a convex polytope).
Deﬁnition 7.1 Fix η > 0 and let v ∈Z satisfy 1 ≤v ≤2/q. Let γ > 0 and let
⃗a := (a1, a2, . . . , av−1)
be a sequence of real numbers. Let
⃗p := (p1, . . . , pv)
be an l-tuplet of prime numbers, ( ⃗p) = p1 · · · pv. Then, we deﬁne
C(⃗a, γ ) :=
%
⃗p = (p1, . . . , pv) : pj ∈(Xaj , Xaj +γ ), 1 ≤j ≤v1,

( ⃗p) ∈B∗&
and
C(⃗a, γ, q, s) :=
%
⃗p ∈C(⃗a, γ ) :

( ⃗p) ≡s mod q
&
.
The sequence ⃗a and the box C(⃗a, γ ) are called normal, if aj + γ < aj+1, for
1 ≤j ≤v −2.
Proposition 7.2 Let C(⃗a, γ ) be as deﬁned in Deﬁnition 7.1, γ = (log X)−C3 for
C3 > 0 ﬁxed. Let q ≤Q0, (s, q) = 1. Then,

n∈C(⃗a,γ,q,s)
wn = O
⎛
⎝
⎛
⎝
1
φ(q)

n∈C(⃗a,γ,q,s)
1
⎞
⎠(log X)−A
⎞
⎠.
Proof of Proposition 6.4 assuming Proposition 7.3
Deﬁnition 7.3 Let δ0 := (log X)−C3. We cover [η, 1]v−1 by Oη(δ−(v−1)
0
) disjoint
hypercubes C(⃗a, δ0). We partition the ⃗a ∈5
R into two disjoint sets:
Y1 := {⃗a ∈5
R : C(⃗a, δ0) ⊆5
R}
Y2 := {⃗a ∈5
R : C(⃗a, δ0) ∩bd 5
R ̸= ∅} .
Since the set L∗of linear forms deﬁning R imply
log pi
log n ̸= log pj
log n , for i ̸= j ,

The Ternary Goldbach Problem with a Missing Digit and Other Primes of Special Types
351
C(⃗a, γ ) ⊆R implies that C(⃗a, γ ) is normal.
We have thus by Proposition 7.2 that

⃗a : C(⃗a,δ0)⊆5
R

n∈C(⃗a,δ)
e

n c
q

w∗
n =

s mod q
(s,q)=1
e
sc
q


⃗a : C(⃗a,δ0)

n∈C(⃗a,δ0,q,s)
w∗
n
By the prime number theorem for short intervals and arithmetic progressions, we
have for any s0 with (s0, q) = 1

n∈C(⃗a,δ0,q,s)
1 =
⎛
⎝

n∈C(⃗a,δ0,q,s0)
1
⎞
⎠

1 + O(log X)−A
.
Thus, we obtain by Proposition 7.2

⃗a : C(⃗a,δ0)∈5
R

n∈C+(u,γ )
e

n c
q

w∗
n = O
⎛
⎝

⃗a : C(⃗a,δ0)⊆5
R
|C(⃗a, δ0)|
⎞
⎠(log X)−A .
For the contribution of Y2, we estimate the total volume of the C(⃗a, δ0) and treat the
A∗-part and the B∗-part separately.
Proposition 6.4 thus has been reduced to Proposition 7.2.
8
b-Variable Circle Method
In this section, we state propositions needed in the estimate of type II expressions
by the b-variable circle method. We then derive Proposition 7.2 from them.
Proposition 8.1 Fix η > 0 and let v ∈Z satisfy 1 ≤v ≤2/η. Let
C := C(⃗a, r, q, s)
be as in Deﬁnition 7.1. Let q ≤Q0. Let M(b) = M(b)(C4) be given by
M(b) :=
!
0 ≤b < X :

b
X −d
r
 ≤(log X)C4
X
=
for some integers d, r with r ≤(log X)C4, r | X.
Then, if C4 is chosen sufﬁciently large,

352
H. Maier and M. Th. Rassias
1
X

0≤b<X
b∈M
SA∗
 b
X

SC

−b
X

−κA#A∗
#B∗
#C(⃗a, r, q, s) = O

#A∗
(log X)A

.
The implied constants depend on A, but not on η, v, and the aj.
Proposition 8.2 (Generic Minor Arcs) Let C and M(C4) be as in Proposition 8.1.
Then, there is some exceptional set
E := E(C) ⊆[0, X] , with #E ≤X23/40 ,
such that
1
X

b<X
b̸∈E
SA∗
 b
X

SC

−b
X
 = O
#A∗
Xϵ

.
The implied constant depends on η but not on the aj.
Proposition 8.3 (Exceptional Minor Arcs) Let C and M = M(C4) be as given
in Proposition 8.1. Let a1, . . . , av−1 in the deﬁnition of C(⃗a, r, q, s) satisfy

i∈I
ai ∈
 9
40 + ϵ
2, 16
25 −ϵ
2

∪
23
40 + ϵ
2, 16
25 −ϵ
2

for some I ⊆{1, . . . , v −1}, and let C4 be sufﬁciently large. Let E ⊆[0, X] be any
set, such that #E ≤X23/40. Then, we have
1
X

b∈E
b̸∈M
SA∗
 b
X

SC

−b
X

= O

#A∗
(log X)A

.
The implied constant depends on η but not on the a1, . . . , av−1.
Proof of Proposition 7.2
By orthogonality, we have
#(C ∩A∗) = 1
X

1≤b≤X
SA∗
 b
X

SC

−b
X

.
Proposition 7.2 now follows by the partition given by Propositions 8.1, 8.2,
and 8.3.

The Ternary Goldbach Problem with a Missing Digit and Other Primes of Special Types
353
9
b-Variable Major Arcs
The principles for the treatment of the major arcs are the same as in [11]. M(b) is
partitioned into three disjoint sets M1, M2, M3 which are deﬁned by the fraction
d
r approximating b
X.
For two sets M1, M2, the A∗- and the B∗-estimates—as in [12]—give negligible
results.
In the A∗-estimate for the set M3, we again succeed to identify the main
contributions as originating in the fractions d
r with r | 10.
We apply the same techniques as in [11], which however are complicated by the
appearance of congruences modq. We now give details.
We split M(b) up as three disjoint sets.
M(b) = M1 ∪M2 ∪M3 ,
where
M1 :=
!
b ∈M(b) :

b
X −d
r
 ≤(log X)C2
X
for some d, r ≤(log X)C3, r ∤X
=
,
M2 :=
!
b ∈M(b) : b
X = d
r + v for some d, r ≤(log X)C3, r | X, 0 < |v| ≤(log X)C3
X
=
,
M3 :=
!
b ∈M(b) : b
X = d
r + v for some d, r ≤(log X)C3, r | X
=
.
By Lemma 5.2 and recalling X is a power of 10, we have
sup
b∈M1
SA∗
 b
X
 = #A∗
sup
b∈M1
F10k−H
 b
X

= O

#A∗exp(−(log X)−1/2+ϵ)

.
Using the trivial bound
SC(⃗a,r,q,s) = O(X(log X)B)
and noting that
M1 ≪(log X)3B ,
we obtain
1
X

b∈M1
SA∗
 b
X

SC

−b
X

= O

#A∗
(log X)A

.
(21)

354
H. Maier and M. Th. Rassias
This gives the result for M1. We now consider M2.
For ⃗p = (p1, . . . , pv) we write ⃗pv−1 = (p1, . . . , pv−1), 
v−1( ⃗p) = p1 · · · pv−1:
SC =

⃗pv−1=(p1,...,pv−1)
pj ∈(Xaj ,Xaj +γ )

( ⃗pv−1)pv∈B∗
( ⃗pv−1)pv≡s mod q
e
b 
v−1( ⃗p)pv
X

.
We note that if b ∈M2, then
b
X = d
r + c
X , for some integers b, r, |c| ≤(log X)C4, (c is an integer since r | X).
We now chose C5 > 0, C5 ∈Z, so large, that - after C1, . . . , C4 have been chosen -
the following considerations are true and set
 := ⌈log X⌉−C5 .
We remark that −1 is an integer.
We separate the sum SC
 b
X

by putting the prime variable pv in short intervals of
length
(#B∗)/(p1 · · · pv−1)
and in arithmetic progressions mod[q, r]. Thus, we have
SC
 b
X
 =

⃗pv−1 : pj ∈(Xaj ,Xaj +γ )

pv<
|B∗|
p1···pv−1
e(p1 · · · pv−1pv) .
If mp = jx + O(x) and p ≡u mod d, then we have
e

mp
d
r + c
X

= e
dum
r

e(jcx) + O((log X)C4) .
By the prime number theorem in short intervals and arithmetic progressions, we
have

p∈[jX/m,(j+1)X/m]
1 = E X
m (1 + O((log X)−A) ,
where E = 1 if the system
!p ≡u mod r
p ≡s mod q ,

The Ternary Goldbach Problem with a Missing Digit and Other Primes of Special Types
355
is solvable and E = 0 otherwise,
with
E X
m (1 + O((log X)−A) ≤|B∗|
sup
d≤(log X)C
r≤(log X)C

u≡l mod q
e
dum
r


1≤j<−1
e(jc) .
We have

1≤j<−1
e(jc) = e(−c) = −1 = O(1) .
We ﬁnally obtain
1
X

b∈M2
SA∗
 b
X

SC

−b
X

= O

#A∗
(log X)A

,
where the implied elements depend on η and γ , but not on the aj.
Finally, we consider M3.
For (d, r) = 1, we have
SC
d
r

=

0≤u≤r
e
du
r


n∈B∗
n≡u( mod r)
n≡s( mod q)
1 =
1
φ([q, r])
(
n∈L
1
)

0<u<r
(u,r)=1
r≡s( mod (q,r))
e
du
r

.
The solution set of
!n ≡u mod r
n ≡s mod q ,
is non-empty if and only if for the square-free kernels r0 of r the solution set of
!n ≡u mod r0
n ≡s mod q ,
is non-empty.
For the exponential sum

0<u<r
(u,r)=1
e
du
r

,
we have

356
H. Maier and M. Th. Rassias
r
r0 −1

g=0
e
d(s + gr0)
r

= e
du
r

r
r0 −1

g=0
e
 g
r/r0

=
!0, if r0 < r
1, if r0 = r
We ﬁnally obtain
SC(⃗a,r,q,s)
d
r

=

0<u<r
(u,r)=1
e
du
r

φ(q)
φ([q, r])

n∈C(⃗a,r,q,s)
1C(⃗a,r,q,s)(u)

1 + O((log X)−A)

=
φ(q)
φ([q, r])

n∈C(⃗a,r,q,s)
1

0<u<r
(u,r)=1
e
du
r
 
1 + O((log X)−A)

= μ(r)
φ(q)
φ([q, r])

n∈C(⃗a,r,q,s)
1 .
Since μ(r) = 0 for r | 10k, unless r ∈{1, 2, 5, 10}, the estimate can easily be
concluded.
10
Generic Minor Arcs
In this section, we establish Proposition 8.2 and obtain some bounds on the
exceptional set E by using the estimates of Lemma 5.2.
Lemma 10.1 Let C = C(⃗a, γ, q, s) as in Deﬁnition 7.1. We have that
#
!
0 ≤b < X :
Sc
 b
X
 ∼X
C
=
≪C2|C|
X
.
Proof We have

b :
SC

b
X

2
≥|C|2
10C2
SC
 b
X

2
≥|#C|2
10C2 #
!
b :
SC
 b
X
 ≥#C
10C
=
.
Thus,
#
!
b : |SC(⃗a,γ )| ≥|C|
10C
=
≤10C2
X2

b≤X
SC
 b
X

2
= 10C2
X2
X|C| ,

The Ternary Goldbach Problem with a Missing Digit and Other Primes of Special Types
357
the last identity following Parseval’s equation.
⊓⊔
Lemma 10.2 Let
E :=
!
0 ≤b ≤X : FX
 b
X

≥
1
X23/80
=
.
Then,
#E ≪X23/40−ϵ ,

b∈E
FX
 b
X

≪X23/80−ϵ ,
and
1
X

b<X
b̸∈E
FX
 b
X

SC

−b
X
 ≪1
Xϵ .
Proof The ﬁrst bound on the size of E follows from Section 5. For the second
bound, we see from Lemma 5.2 that

b∈E
FX
 b
X

≪

j≥0
2j ≤X23/80
#
!
0 ≤b < X : FX
 b
X

∼2−j
=
≪

j≥0
2j ≤X23/80
2(235/154−1)jX59/433 ≪X59/433+(23×235)/(80×154)−23/80 ,
and so the calculation above gives the result.
It remains to bound the sum over b ̸∈E. We divide the sum into O((log X)2)
subsums, where we restrict to these b, such that
FX
 b
X

∼1
B and
SC
 b
X
 ∼|C|
C
for some B ≥X23/80 and C ≤X2 (terms with C > X2 make a contribution
O(1/X)). This gives
1
X

b<X
b̸∈E
FX
 b
X

SC

−b
X


358
H. Maier and M. Th. Rassias
≪

X23/80≤B
1≤C≤X2
(log X)2
X

b<X
FX

b
X

≍1
B
SC

−b
X

∼X
C
FX
 b
X

SC

−b
X
 + 1
X2 .
⊓⊔
11
Exceptional Minor Arcs
In [12] in the treatment of the exceptional minor arcs, methods from the geometry of
numbers are of great importance. The key result, the Bilinear Sum Bound, Lemma
13.1, is derived by them.
In our paper, it is enough to have knowledge of this result.
Lemma 11.1 (Bilinear Sum Bound) Let N, M, R ≥1 and E satisfy
X9/25 ≤N ≤X17/40, R ≤X1/2, NM ≤1000X, and E ≤100 X1/2
R
and either E ≥1
X or E = 0.
Let F := F(R, E) be given by
F :=
!
b < X : b
X = d
r + v for some (d, r) = 1 with r ≍R, v = E
X
=
.
Then, for any 1-bounded complex sequences αn, βn, γb, we have

b∈F∩E

n∼N
m∼M
αnβmγbe

−bnm
X

≪X(log X)O(1))
(R + E)ϵ/10 .
Proof This is Lemma 13.1 of [12].
⊓⊔
We now derive Proposition 8.3 from Lemma 13.1.
Proof of Proposition 8.3
By symmetry, we may assume that I = {1, . . . , l1} for some l1 < l. By Dirichlet’s
theorem on diophantine approximation, any b ∈[0, X] has a representation
b
X = d
r + ν

The Ternary Goldbach Problem with a Missing Digit and Other Primes of Special Types
359
for some integers (d, r) = 1 with r ≤X1/2 and some real |ν| ≤1/X1/2r.
Thus, we can partition [0, X] into O((log X)2) sets F(R, E) as deﬁned by
Lemma 10.1 for different parameters R, E satisfying
1 ≤R ≤X1/2 and E = 0 or 1
X ≤E ≤100X2
R
.
Moreover, if b ̸∈M(b), then b ∈F = F(R, E) for some R, E with
R + E ≥(log X)C3 .
Thus, provided C3 is sufﬁciently large, we see that it is sufﬁcient to show that
1
X


b∈F∩E
SA
 b
X

SCq,s

−b
X
 ≪
#A
(R + E)ϵ/20 .
(22)
Recalling Deﬁnition 7.1
Cq,s := { ⃗p = (p1, p2, . . . , pl) : pi ∈Ii , $( ⃗p) ≡s (modq)},
let
C(I) :=×
j∈I
Iij , C(II) :=×
j̸∈I
Iij ,
such that
n ∈C(I)
i
⇒X9/25 ≤n ≤X17/40.
We have (with t−1t ≡1 (modq)):
Cq,s =

t mod q
(t,q)=1
(C(I)
q,t × C(II)
q,t−1s),
and thus,
1
X

n∈E
SA
 b
X

SCq,s

−b
X

≪

t mod q
(t,q)=1

b∈F∩E
SA
 b
X
 
n1∼N1
n2∼N2
αn1βn2 e

−bn1n2
X

,
where

360
H. Maier and M. Th. Rassias
αn1 :=

1 ,
if n1 ∈C(I)
q,t
0 ,
otherwise ,
βn2 :=

1 ,
if n2 ∈C(II)
q,t−1s
0 ,
otherwise .
Thus, it sufﬁces to show that
1
X

b∈F∩E
SA
 b
X
 
n∼N
αn

m∼M
βm e

−bnm
X

≪
#A∗
(log X)A ,
(23)
Let γb be the 1-bounded sequence, satisfying
SA
 b
X

= #AγbFX
 b
X

.
After substituting this expression for SA, we see that (23) follows immediately from
Lemma 10.1, if the parameter C3 is chosen sufﬁciently large.
12
The Ternary Goldbach Problem with a Prime with a
Missing Digit, a Piatetski-Shapiro Prime, and a Prime of
Another Special Type
We conclude this paper by sketching the proof of a modiﬁcation of Theorem 1.1.
One of the two Piatetski-Shapiro primes is replaced by a prime p of the form
p = x2 + y2 + 1 .
For details of the proof, we refer to a forthcoming paper.
Theorem 12.1 Assume the GRH. Let γ ∗, γ0, c0, a0 as in Theorem 1.1. Then, each
sufﬁciently large odd integer N0 can be represented in the form
N0 = p1 + p2 + p3 ,
where the pi are of the form p2 = [nc0
2 ],
p3 = x2
3 + y2
3 + 1 ,
for some x3, y3 ∈Z, and the decimal expansion of p1 does not contain the digit a0.
Sketch of Proof We again apply the local version of Maynard’s result.
We then follow Hooley [6], introduce the generating function

The Ternary Goldbach Problem with a Missing Digit and Other Primes of Special Types
361
SQ(θ) =

(x,y)∈Z
x2+y2+1=p prime
N0
2 −X
4 <p≤N0
2 −X
8
r(p −1)e(pθ) log p,
and use the non-principal Dirichlet character χ mod 4, to obtain the following
decompositions:
Let D := X1/2(log X)−C0, C0 > 0 and
S(1)
Q (θ) :=

d≤D
χ(d)

p∈Int(N0)
p≡1 mod d
e(pθ) log p ,
S(2)
Q (θ) :=

D<d≤X
D
χ(d)

p∈Int(N0)
p≡1 mod d
e(pθ) log p ,
S(3)
Q (θ) :=

X
D <d≤X
χ(d)

p∈Int(N0)
p≡1 mod d
e(pθ) log p ,
with
Int(N0) =
N0 −n∗
H
2
−X
8 , N0 −n∗
H
2
+ X
8

.
We deﬁne
J (i)(E) = 1
X

1≤a≤X
E
 a
X

Sc0
 a
X

S(i)
Q
 a
X

and
J(E) = J (1)(E) + J (3)(E) .
For each exponential sum E appearing in the Buchstab recursion in the exponential
sum version, we evaluate J(E) asymptotically. J (2)(E), which is of smaller order
of magnitude, will be estimated from above.
Acknowledgments M. Th. Rassias: I would like to express my gratitude to Artur Avila and
Ashkan Nikeghbali for their essential support throughout the preparation of this work.

362
H. Maier and M. Th. Rassias
References
1. Balog, A., Friedlander, J.: A hybrid of theorems of Vinogradov and Piatetski-Shapiro. Paciﬁc
J. Math. 156(1), 45–62 (1992)
2. Dimitrov, S. I.: The ternary Goldbach problem with prime numbers of a mixed type. Notes
Number Theory Discrete Math. 24(2), 6–20 (2018)
3. Dimitrov, S. I.: Prime triples p1, p2, p3 in arithmetic progressions such that p1 = x2 + y2 + 1,
p3 = [nc]. Notes Number Theory Discrete Math. 23(4), 22–33 (2017)
4. Harman, G.: Prime-detecting sieves, vol. 33. London Mathematical Society Monographs
Series. Princeton University Press, Princeton, NJ (2007)
5. Helfgott, H.A.: Major Arcs for Goldbach’s Theorem. Ann. of Math. Studies, Princeton, to
appear. See also http://arxiv.org/abs/1305.2897v1
6. Hooley, C.: Applications of Sieve Methods to the Theory of Numbers. Cambridge Univ. Press
(1976)
7. Iwaniec, H., Kowalski, E.: Analytic Number Theory, Vol. 53. Amer. Math. Soc. Colloq.,
Providence, RI (2004)
8. Jia, C.H.: On the Piatetski-Shapiro-Vinogradov theorem. Acta Arith. 73, 1–28 (1995)
9. Kumchev, A.: On the Piatetski-Shapiro-Vinogradov theorem. Journal de Théorie des Nombres
de Bordeaux 9, 11–23 (1997)
10. Maier, H., Rassias, M.Th.: The ternary Goldbach problem with a prime and two isolated
primes. Proc. Steklov Inst. Math. 296, 183–197 (2017). Also translated in Russian and
published in Trudy Matematich. Instituta im. V.A. Steklova 296, 192–206 (2017)
11. Maier, H., Rassias, M.Th.: The ternary Goldbach problem with two Piatetski-Shapiro primes
and a prime with a missing digit. Commun. Contemp. Math. (to appear). arXiv:2006.07873
12. Maynard, J.: Primes with restricted digits. Inventiones Mathematicae 217, 127–218 (2019)
13. Rassias, M.Th.: Goldbach’s Problem: Selected Topics. Springer (2017)
14. Teräväinen, J.: The Goldbach problem for primes that are sums of two squares plus one.
Mathematika 64(1), 20–70 (2018)
15. Vinogradov, I.M.: Representation of an odd number as the sum of three primes. Dokl. Akad.
Nauk SSSR 15, 291–294 (1937)

A Note on Harmonious Sets
Yves François Meyer
En hommage respectueux à Jean Bourgain
Abstract A ﬂaw in algebraic numbers and harmonic analysis, Elsevier (1972), is
corrected.
1
A Wrong Lemma Is Revisited
Harmonious sets are playing a seminal role in the mathematical theory of quasi-
crystals. This was showed by Robert Vaughan Moody in [5]. Harmonious sets
generalize lattices. The union  ∪M between two harmonious sets  and M is
not harmonious in general. The simplest counterexample is  = Z and M = α Z
when α /∈Q. If  is a harmonious set and if F is a ﬁnite set, then F ∪ is still
harmonious. This is Theorem II, page 45, Chapter II of [4]. Unfortunately, the proof
given in [4] is wrong. This wrong proof is based on Lemma 5, page 45. Lemma 5
is doubtful and its proof is incorrect. Two correct proofs of Theorem II are given
in this note. In both proofs, Lemma 5 of [4] is replaced by a weaker result which
implies Theorem II. Moreover, the second proof bridges the gap between the theory
of harmonious sets with some remarkable results by Nikolaï Bogolyubov and Erling
Følner [1, 2].
In this note, G is a locally compact abelian (l.c.a.) group. A function on G will
be a real or complex valued function. The given topology on G is denoted by T0.
Four deﬁnitions are needed.
Deﬁnition 1.1 Let f be a continuous and bounded function on G, and let 0 ≤ϵ <
2. An ϵ almost period τ of f is deﬁned by
Y. F. Meyer ()
CMLA, ENS-Cachan, Université Paris-Saclay, CNRS, France
e-mail: yves.meyer305@orange.fr
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
A. Avila et al. (eds.), Analysis at Large, https://doi.org/10.1007/978-3-031-05331-3_15
363

364
Y. F. Meyer
sup
x∈G
|f (x + τ) −f (x)| ≤ϵ ∥f ∥∞.
(1)
Deﬁnition 1.2 A set E ⊂G is relatively dense in G if there exists a compact set K
such that E + K = G. A set E ⊂G is relatively dense with respect to a ﬁnite set F
if E + F = G.
If M is relatively dense in the usual sense, then for every neighborhood V of 0 in
G there exists a ﬁnite set F such that M + V is relatively dense with respect to F.
Indeed, we know that there exists a compact set K such that M + K = G and there
exists a ﬁnite set F such that K ⊂F + V. Then, M + V + F = G.
Deﬁnition 1.3 A continuous and bounded function on G is Bohr almost periodic if
for any ϵ ∈[0, 2) the set Mϵ of ϵ almost period τ of f is relatively dense.
The Bohr compactiﬁcation I
G of G is deﬁned by the three following properties:
(a) I
G is a compact abelian group, (b) G is a dense subgroup of I
G, and (c) the Bohr
almost periodic functions on G are the restriction to G of the continuous functions
on I
G. The topology on G which is induced by the topology of I
G is denoted by
T . The topology T on G is the weakest topology on G for which the Bohr almost
periodic functions on G are continuous. In particular, T is weaker than T0. If E and
F are two subsets of G, E−F denotes the set of all differences x−y, x ∈E, y ∈F,
similarly for E + F. A subset E of G is closed for the topology T if and only if
E = K ∩G where K ⊂I
G is a compact set. Equivalently, E is closed if and only if
there exists a Bohr almost periodic function f such that E = {x ∈G; f (x) = 0}. If
G = R, N is not closed for the topology T since any Bohr almost periodic function
f vanishing on N vanishes on Z. Similarly, Z \ {0} is not closed for the topology
T . However, Z is closed for the topology T . Similarly, if G = R, the open interval
(0, 1) is not open for the topology T . However, if K ⊂G is a compact set for the
the topology T0, the topologies T0 and T coincide on K. For instance, if G = R,
the compact interval [0, 1] is also compact for the topology T .
Lemma 1.1 If  ⊂G is closed for the topology T and if K ⊂G is a compact set
for the topology T0, then  + K is closed for the topology T .
Indeed, we have  = L ∩G where L ⊂I
G is a compact set. Since K is contained
in the group G, we have  + K = (L + K) ∩G. However, L + K is a compact
subset of I
G which ends the proof.
Let  ⊂G be an open set for the topology T . Then, either  is the empty set or
 is relatively dense. That explains why the open interval (0, 1) is not open for the
topology T .
We now reach the deﬁnition of harmonious sets. If 0 ≤ϵ < 2, the ϵ-dual of a set
 ⊂Rn is the closed set ∗
ϵ ⊂Rn deﬁned by
∗
ϵ = {x; | exp(2πix · y) −1| ≤ϵ, ∀y ∈}.
(2)

A Note on Harmonious Sets
365
If  ⊂Rn is a lattice and if 0 ≤ϵ <
√
3, then ∗
ϵ is the dual lattice deﬁned
by ∗= {x; exp(2πix · y) = 1, ∀y ∈}. The deﬁnition of the ϵ-dual extends
naturally to the general case of a l.c.a. group . Let us begin with a deﬁnition:
Deﬁnition 1.4 Let T be the multiplicative group {z ∈C; |z| = 1}. A character χ
on a l.c.a. group  is a homomorphism χ :  →T.
The continuous characters on a l.c.a. group are playing the role of the trigonometric
functions χy(x) = exp(2πix · y) on Rn. A continuous character χy on  = Rn is
indexed by y ∈Rn and is given by χy(x) = exp(2πix · y). Similarly, a continuous
character χy on a l.c.a group  is indexed by an element y of the dual group G of
. In other terms, G = ∗is the multiplicative group consisting of all continuous
characters on . If G is the dual group of , then the dual group of G is .
Deﬁnition 1.5 Let  be a l.c.a. group and let G be the dual group of . If 0 ≤ϵ < 2,
the ϵ-dual of a set  ⊂ is the closed set ∗
ϵ ⊂G deﬁned by
∗
ϵ = {χ ∈G ; |χ(y) −1| ≤ϵ, ∀y ∈}.
(3)
The ϵ-dual ∗
ϵ is closed in for the topology T , we have ∗
ϵ = −∗
ϵ, and
∗
ϵ ± ∗
ϵ ⊂∗
2ϵ.
(4)
Deﬁnition 1.6 Let F ⊂ be a ﬁnite set and let 0 < ϵ < 2. The Bohr set B(F, ϵ) ⊂
G is deﬁned by B(F, ϵ) = {χ ∈G ; |χ(y) −1| ≤ϵ, ∀y ∈F}.
In other terms, B(F, ϵ) = F ∗
ϵ is the ϵ-dual of the ﬁnite set F. Bohr sets are
fundamental neighborhoods of 0 for the topology T . Any Bohr set B(F, ϵ) ⊂G is
closed for the topology T .
Deﬁnition 1.7 A set  ⊂ is harmonious if for any positive ϵ the set ∗
ϵ ⊂G is
relatively dense in G.
A harmonious set is uniformly discrete [4]: there exists a neighborhood V of 0
such that for λ ∈, λ′ ∈ and λ ̸= λ′ we have (λ + V ) ∩(λ′ + V ) = ∅. Let H
be the additive subgroup of  generated by . Then,  is harmonious if and only if
for any character χ : H →T and any positive ϵ there exists a continuous character
ξ on  such that supx∈ |χ(x) −ξ(x)| ≤ϵ. This is proved in [4], Chapter II.
Our goal is to prove the following theorem:
Theorem 1.1 If  is a l.c.a. group, if  ⊂ is harmonious, and if F ⊂ is ﬁnite,
then  ∪F is still harmonious.
Two proofs of Theorem 1.1 are given. They both rely on the interplay between
the additive properties of relatively dense sets and the topology T .
Here begins the ﬁrst proof. Theorem 1.1 is an easy consequence of the following
proposition:

366
Y. F. Meyer
Proposition 1.1 Let M ⊂G be a relatively dense set and let  ⊂G be a
neighborhood of 0 for the topology T . If M is closed for the topology T , then the
intersection M2 = (M −M) ∩ is relatively dense in G.
It will be proved that Proposition 1.1 implies Theorem 1.2 which is stronger than
Theorem 1.1. Lemma 5 of [4] is a similar statement, but the assumption that M
is closed for the topology T is forgotten. Moreover, the proof of Lemma 5 given
in [4] is wrong even if M is closed. Before proving Proposition 1.1, let us give an
important corollary.
Theorem 1.2 Let  ⊂ be a set of points. Let us assume that for any positive ϵ
there exists a ﬁnite subset Fϵ of  such that the ϵ-dual of  \ Fϵ is relatively dense.
Then,  is harmonious.
Theorem 1.2 obviously implies Theorem 1.1. To prove Theorem 1.2, it sufﬁces
to show that for any positive ϵ the 2ϵ-dual ∗
2ϵ of  is relatively dense. Let η be a
positive real number. The η-dual of  \ Fϵ is denoted by Q(η,ϵ), and the 2ϵ-dual of
Fϵ is denoted by ϵ. On one hand, ϵ is a neighborhood of 0 for the topology T .
On the other hand, Q(ϵ,ϵ) is closed for the topology T and Q(ϵ,ϵ)−Q(ϵ,ϵ) ⊂Q(2ϵ,ϵ).
By assumption, Q(ϵ,ϵ) is relatively dense. We now apply Proposition 1.1 to Q(ϵ,ϵ)
and conclude that Q(2ϵ,ϵ) ∩ϵ is relatively dense. However, Q(2ϵ,ϵ) ∩ϵ = ∗
2ϵ
which ends the proof. A similar statement is given by the following theorem:
Theorem 1.3 Let  ⊂ be a set of points. Let us assume that for any positive ϵ
there exists a ﬁnite set Fϵ and a subset ϵ of  such that  ⊂Fϵ + ϵ and that the
ϵ-dual of ϵ is relatively dense. Then,  is harmonious.
The proof of Theorem 1.3 is the same as the proof of Theorem 1.2.
Let us return to Proposition 1.1. Proposition 1.1 is a corollary of Lemma 1.2. The
notations used in Proposition 1.1 are kept here.
Lemma 1.2 If M ⊂G is relatively dense in G and is closed for the topology T ,
then for every V ⊂G which is a neighborhood of 0 for T0, M −M + V is a
neighborhood of 0 for the topology T .
Before proving Lemma 1.2, let us show that Lemma 1.2 implies Proposition 1.1.
We begin with two simple observations.
Lemma 1.3 Any non-empty set  ⊂G which is open for the topology T is
relatively dense in G.
Lemma 1.4 If M ⊂G and if there exists a compact set K such that M + K is
relatively dense in G, then M is relatively dense in G.
We are ready to show that Lemma 1.2 implies Proposition 1.1. Let B(F, ϵ) be
a Bohr set and M2 = (M −M) ∩B(F, ϵ). Let V ⊂B(F, ϵ/2) be a compact
neighborhood of 0 for the topology T0. Then,
(M −M + V ) ∩B(F, ϵ/2) ⊂M2 + V.
(5)

A Note on Harmonious Sets
367
Indeed if x ∈(M −M +V )∩B(F, ϵ/2), we have x = y+z, y ∈M −M, z ∈V and
x ∈B(F, ϵ/2). It implies y = x −z ∈B(F, ϵ/2) −V ⊂B(F, ϵ) and ﬁnally y ∈
(M −M)∩B(F, ϵ) = M2 which ends the proof of (5). By Lemma 1.2, M −M +V
is a neighborhood of 0 for the topology T . Therefore, (M −M + V ) ∩B(F, ϵ/2)
is also a neighborhood of 0 for the topology T . Finally, M2 + V is relatively dense
in G and so is M2.
We now prove Lemma 1.2 under the following form:
Lemma 1.5 Let us assume that M is relatively dense in G. If M is closed in G for
the topology T , then for every V ⊂G which is a neighborhood of 0 for the topology
T0, the interior of M + V for the topology T is non-empty.
In other terms, there exists a x0 ∈G such that M + V −x0 is a neighborhood of
0 for the topology T . Let us show that Lemma 1.5 implies Lemma 1.2. Without
losing generality, it can be assumed that V = W −W where W ⊂G is a compact
neighborhood of 0 for T0. We know that there exists a x0 ∈G such that  =
M + W −x0 is a neighborhood of 0 for the topology T . In particular, we have
0 = m + w −x0 where m ∈M and w ∈W. Therefore,  = M −m + W −w. But
M −m + W −w ⊂M −M + W −W which ends the proof of Lemma 1.2.
We now prove Lemma 1.5. Without losing generality, it can be assumed that
V = W −W where W ⊂G is a compact neighborhood of 0 for T0. Since M is
relatively dense, there exists a ﬁnite set F such that M+W+F = G. By Lemma 1.1,
the set E = M + W is closed for T , and we have E + F = G. We then use an
obvious remark:
Remark 1.1 Let X be a topological space, let A ⊂X, and let B ⊂X be two subsets
of X such that A ∪B = X. If the interior of A is empty and if B is closed, then
B = X.
Since G is the ﬁnite union of the sets E + y, y ∈F, Remark 1.1 implies that the
interior of E for T is non-empty. Lemma 1.5 is proved.
2
Bogolyobov’s Approach
The second proof of Theorem 1.2 relies on an improved version of Proposition 1.1
which was discovered by Nikolaï Bogolyubov and by Erling Følner [1, 2]. They
proved that Proposition 1.1 remains valid when M is any relatively dense set. The
assumption that M is closed for the topology T is no more needed, but the simple
difference M −M shall be replaced by an iterated difference. This does not affect
the proof of Theorem 1.2.
Let us begin with Bogolyubov’s theorem. It uses the following deﬁnition:
Deﬁnition 2.1 The lower and upper Banach densities of a set A of integers are
deﬁned by d∗(A) = limn→∞minx #(A ∩[x + 1, x + n])/n and d∗(A) =
limn→∞supx #(A ∩[x + 1, x + n])/n.

368
Y. F. Meyer
For instance, the upper Banach density of the union A of the intervals [2k, 2k +
k], k ∈N, is 1, and the lower Banach density of A is 0. Bogolyubov proved the
following result [1]:
Theorem 2.1 If A ⊂Z and d∗(A) > 0, then there exist k real numbers α1, . . . , αk,
and a positive ϵ with k and ϵ depending only on d∗(A) > 0, such that the Bohr set
B(α1, . . . , αk, ϵ) is contained in A −A + A −A.
Følner generalized Bogolyubov’s theorem to arbitrary l.c.a. groups.
Theorem 2.2 If M ⊂G is relatively dense with respect to a ﬁnite set F and if
V ⊂G is a neighborhood of 0 in G for the topology T0, then the set M4 = M −
M + M −M + V is a neighborhood of 0 for the topology T .
As above, Følner’s theorem implies the following result:
Corollary 2.1 If M ⊂G is relatively dense and if  is a neighborhood of 0 for the
topology T , then the set (M −M + M −M) ∩ is relatively dense.
This improves on Proposition 1.1 since it is no longer assumed that M is closed.
However, a second difference is needed. Følner’s theorem was already known and
published when I wrote my wrong proof of Lemma 5 of [3]. I was just ignorant.
Corollary 2.1 implies Theorem 1.2 by the argument used above. The only
difference being that 2ϵ is replaced by 4ϵ.
3
New Examples of Harmonious Sets
Using Theorem 1.2, we give new examples of harmonious sets. Let ωj, j ∈N, be
an increasing sequence of positive real numbers, and let mj, j ∈N, be a sequence
of natural integers. Let us assume that mjωj/ωj+1 →0 as j →∞. Then we have
the following:
Theorem 3.1 If the two sequences ωj, mj, j ∈N, are deﬁned as above, the set
 = {m ωj; 1 ≤m ≤mj, 1 ≤j}
(6)
is harmonious.
Let ϵ ∈(0, 2) and let us deﬁne N = Nϵ by
ωj+1 ≥20 mj ωj/ϵ, ∀j ≥N.
(7)
Next we deﬁne N by imposing j ≥N in (6). We shall prove that if N ≥Nϵ, the
ϵ-dual of N is relatively dense. Then, Theorem 1.2 implies Theorem 3.1. To prove
it we deﬁne

A Note on Harmonious Sets
369
Vj = {x; | exp(2πxωj) −1| ≤ϵ/mj}.
(8)
Then, Vj is 1/ωj periodic and is a union of intervals of length ϵ(2π mjωj)−1.
Using (7), one observes that each interval of Vj contains at least an interval of
Vj+1. Therefore, ∩j≥NVj is relatively dense which proves our claim. A similar
proof applies to the following theorem:
Theorem 3.2 Let ωj ≥1, j = 1, 2, . . . be an increasing sequence of real numbers
such that ωj+1 ≥2jωj, j = 1, 2, . . . . Then, the set  of all ﬁnite sums λ =

j≥1 αjωj, αj ∈{0, 1}, is harmonious.
We apply Theorem 1.3. For any ϵ > 0, we chose N such that 2N > 20/ϵ and deﬁne
Fϵ = N
1 αjωj, αj ∈{0, 1} and ϵ = ∞
N αjωj, αj ∈{0, 1}. By Theorem 1.3,
it sufﬁces to prove that the ϵ-dual of ϵ is relatively dense. We deﬁne
Wj = {x; | exp(2πxωj+N) −1| ≤ϵ/2j},
(9)
and we observe that for any λ ∈ϵ we have
| exp(2πxλ) −1| ≤
∞

1
| exp(2πxωj+N) −1|.
(10)
If x ∈∩j≥1Wj, the right hand side of (10) does not exceed ϵ and x belongs to
the ϵ-dual of ϵ. Then, it remains to prove that ∩j≥1Wj is relatively dense. This is
achieved by the argument which was used to prove Theorem 3.1.
4
The Union of Two Harmonious Sets
We now concentrate on the case G = Rn. If  is harmonious so are  ± . This is
obvious from the deﬁnition. Indeed, if χ is a weak character on ±, its restriction
to  is a weak character on . Therefore, χ is a uniform limit on  of a sequence
χj(x) = exp(2πiωj · x) of strong characters. We have χ(x + y) = χ(x)χ(y), and
it implies that χ is a uniform limit on  +  of the same sequence χj. The same
observation applies to  −.
Theorem 1.1 implies the following property:
Lemma 4.1 If  is a harmonious set and if F is a ﬁnite set, then  + F is still
harmonious.
This remark leads to the following equivalence relation between harmonious sets
and to partial order on the collection of harmonious sets  ⊂Rn.
Deﬁnition 4.1 If , ′ ⊂Rn, one writes  ≃′ if there exist two ﬁnite sets F
and F ′ such that  ⊂′ + F ′ and ′ ⊂ + F.

370
Y. F. Meyer
The partial order is deﬁned now.
Deﬁnition 4.2 If , ′ ⊂Rn, one writes  ≺′ if there exists a ﬁnite set F such
that  ⊂′ + F.
If  ≺′ and ′ ≺, we have  ≃′.
Deﬁnition 4.3 A harmonious set  is maximal if it is maximal for the partial order
of Deﬁnition 4.2.
If  is maximal, any harmonious set M containing  satisﬁes M ⊂+F where F
is ﬁnite. A set  ⊂Rn is called a Delone set if it is uniformly discrete and relatively
dense. We then have the following:
Theorem 4.1 Any harmonious set  which is a Delone set is maximal.
We shall prove that if M is a harmonious set, if F is a ﬁnite set, and if  ⊂
M +F, then there exists a ﬁnite set F1 such that M ⊂+F1. We ﬁrst observe that
M′ = M + F is harmonious. Then, it sufﬁces to prove that there exists a ﬁnite set
F ′ such that M′ ⊂ + F ′. In other words, we forget M and F and focus on M′.
We know that M′ −M′ is also harmonious. It implies that M′ −M′ is locally ﬁnite.
Since  is a Delone set, there exists a constant R > 0 with the following property:
for any m ∈M′, there exists a λ ∈ with |m −λ| ≤R. Let BR be the ball centered
at 0 with radius R. The set F ′ = (M′ −M′) ∩BR is ﬁnite since M′ −M′ is locally
ﬁnite. We have  ⊂M′ which implies m−λ ∈F ′. Therefore, M′ ⊂+F ′ which
ends the proof.
Corollary 4.1 Let  and M be two harmonious sets. If  is a Delone set and if
 ∪M is harmonious, then there exists a ﬁnite set F such that M ⊂ + F.
Conversely, let  and M be two harmonious sets. Then, M ⊂ + F implies that
 ∪M is harmonious. To prove Corollary 4.1, it sufﬁces to apply Theorem 4.1 to
. It implies that  is maximal. Since M1 =  ∪M is harmonious and contains ,
we have M1 ⊂ + F where F is ﬁnite.
How does one construct maximal harmonious sets? The “cut and projection"
scheme is an answer [4]. Here is the recipe. A lattice  ⊂RN is a discrete subgroup
such that the quotient group RN/ is compact. Equivalently,  = A(ZN) where A
is an invertible N×N matrix. Let m ≥1, N = n+m, RN = Rn×Rm. Let  ⊂RN
be a lattice. For X = (x, y) ∈Rn × Rm, one sets x = p1(X) and y = p2(X). We
now assume that p1 :  →p1() is a one-to-one mapping and that p2() is dense
in Rm. Recall that a compact set K ⊂Rm is Riemann integrable if its boundary has
a zero Lebesgue measure. We are now ready to deﬁne “model sets."
Deﬁnition 4.4 Let K ⊂Rm be a Riemann integrable compact set with a non-empty
interior. Then, the model set  = (, K) deﬁned by  and K is
 = {λ = p1(γ ); γ ∈, p2(γ ) ∈K}
(11)

A Note on Harmonious Sets
371
Then, (, K) is a harmonious set [4]. It is a Delone set. Therefore, it is a
maximal harmonious set. Conversely, if a harmonious set  is a Delone set, there
exists a model set M and a ﬁnite set F such that  ⊂M + F. Are there other
maximal harmonious sets ?
The harmonious set deﬁned by Theorem 3.1 is not maximal. Keeping the nota-
tions of Theorem 3.1, we deﬁne M by the same recipe with the only modiﬁcation
that mj is replaced by 2mj. Then, we cannot have M ⊂+F where F is ﬁnite. To
reach a contradiction, we consider the interval Ij = [(4/3)mj ωj, (3/2)mj ωj].
We have ( + F) ∩Ij
= ∅if j is sufﬁciently large. However, M ∩Ij
=
{mωj; (4/3)mj ≤m ≤(3/2)mj}.
Acknowledgments This work was supported by a grant from the Simons Foundation (601950,
YM).
References
1. Bogolyubov, N.N.: Some algebraical properties of almost periods. Zap. Kafedry Mat. Fiziki
Kiev 4, 185–194 (1939)
2. Følner, E.: Generalization of a theorem of Bogoliuboff to topological abelian groups. With an
appendix on Banach mean values in non-abelian groups. Math. Scand. 2, 5–18 (1954)
3. Følner, E.: Note on a generalization of a theorem of Bogoliuboff. Math. Scand. 2, 224–226
(1954)
4. Meyer, Y.: Algebraic Numbers and Harmonic Analysis. Elsevier (1972)
5. Moody, R.V.: Meyer sets and their duals. The Mathematics of aperiodic order. In: Moody,
R.V. (ed.) Proceedings of the Nato Advanced Study Institute on Long-range Aperiodic Order,
pp. 403–411. Nato ASI Series C489. Kluwer Acad. Press (1997)

On the Multiplicative Group Generated
by Two Primes in Z/QZ
Péter P. Varjú
Dedicated to the memory of Jean Bourgain.
Abstract We study the action of the multiplicative group generated by two prime
numbers in Z/QZ. More speciﬁcally, we study returns to the set ([−Qε, Qε] ∩
Z)/QZ. This is intimately related to the problem of bounding the greatest common
divisor of S-unit differences, which we revisit. Our main tool is the S-adic subspace
theorem.
1
Introduction
In this note, we study the multiplicative group {pmqn : m, n ∈Z} acting on Z/QZ,
where p and q are prime numbers and Q ∈Z≥2 with gcd(Q, pq) = 1. We are
interested in returns to the set ([−Qβ, Qβ] ∩Z)/QZ for some β ∈(0, 1). That is,
we aim to describe the set of (m, n) ∈Z2 such that pmqna = b for some a, b ∈
([−Qβ, Qβ] ∩Z)/QZ. If a and b lifts to integers that are much smaller than Qβ,
then small perturbations of (m, n) will also satisfy the same property. To eliminate
this triviality, we restrict our attention to the following subset of ([−Qβ, Qβ] ∩
Z)/QZ.
Deﬁnition 1 We write B(β, Q) for the set of residues a ∈Z/QZ that have lifts Ia
in [−Qβ, Qβ] ∩Z with gcd(Ia, pq) = 1.
The author has received funding from the European Research Council (ERC) under the European
Union’s Horizon 2020 research and innovation program (grant agreement No. 803711). The author
was supported by the Royal Society.
P. P. Varjú ()
University of Cambridge, Centre for Mathematical Sciences, Cambridge, UK
e-mail: pv270@dpmms.cam.ac.uk
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
A. Avila et al. (eds.), Analysis at Large, https://doi.org/10.1007/978-3-031-05331-3_16
373

374
P. P. Varjú
Notice that B(β, Q) contains a canonical representative of each “short orbit
segment” intersecting ([−Qβ, Qβ] ∩Z)/QZ in the following sense. Given a ∈
([−Qβ, Qβ]∩Z)/QZ, there is a′ ∈B(β, Q) and m′, n′ ∈Z such that a = pm′qn′a′
and
|m′| ≤β log Q/ log p,
|n′| ≤β log Q/ log q.
The choice of a′ is unique provided β < 1/3. This means that, in a sense, to
understand returns to ([−Qβ, Qβ] ∩Z)/QZ, it is enough to understand returns
to B(β, Q).
Our ﬁrst main result is the following:
Theorem 2 Let p and q be two prime numbers, and let K ∈Z≥1. Then, there is
C ∈R>1 and β ∈R>0 such that for all Q ∈Z>C, the set of (m, n) ∈Z2 satisfying
the conditions
•
|m| ≤K log Q/ log |p|,
•
|n| ≤K log Q/ log |q|,
•
there are a, b ∈B(β, Q) such that pmqna = b
is contained in a line.
The constant C is ineffective, but β can be made explicit. In particular, the
theorem holds with β = (147K)−1 with some C that is suitably large depending
on p, q, and K.
As can be seen from the proof, the result remains valid if we require only that p
and q are multiplicatively independent integers instead of being primes. However,
in that more general setting, it is less natural to restrict our study to the set B(β, Q).
Instead, one might formulate a result in terms of the set ([−Qβ, Qβ] ∩Z)/QZ
in place of B(β, Q) and replace the conclusion by saying that the resulting set of
(m, n) will be contained in a suitable neighborhood of a line. We leave this to the
interested reader.
Theorem 2 has the following corollary:
Corollary 3 Let p and q be two prime numbers. For an integer Q ∈Z≥2 with
gcd(pq, Q) = 1, we write ord(Q) for the order of the multiplicative group
generated by p and q in Z/QZ. Then,
lim
Q→∞
ord(Q)
(log Q)2 = ∞.
Again, this remains valid if we replace the condition of primality for p and q by
multiplicative independence.
Corollary 3 is not a new result. It is well known to follow from a result of
Hernández, Luca [7] and Corvaja, Zannier [3], which we will recall below.

Times 2, 3 mod Q
375
Before that, we discuss how Corollary 3 follows from Theorem 2. We observe
that the set
 = {(m, n) ∈Z2 : pmqn ≡1 mod Q}
is a sublatice of Z2 and its index is ord(Q). We write λ1 for the ﬁrst and λ2 for the
second minima of . If (m, n) ∈ is non-zero, then necessarily
|m| log p + |n| log q ≥log Q,
so λ1 ≥c log Q for some constant c that depends on p, q and our choice for the
norm with respect to which the minima are deﬁned. By Theorem 2, λ2/ log Q →∞
as Q →∞. Corollary 3 now follows from Minkowski’s theorem on successive
minima.
Now we discuss some relevant results from the literature. Bugeaud, Corvaja, and
Zannier [2, Theorem 1] proved that
gcd(an −1, bn −1) ≤max(an, bn)−ε
for all pair of multiplicatively independent integers a, b and for all ε > 0 provided
n is sufﬁciently large depending on a, b, and ε. This has been extended both by
Hernández, Luca [7, Theorem 2.1] and Corvaja, Zannier [3, Remark 1] to the case
when an and bn are replaced by two multiplicatively independent integers u and v
containing prime factors only from a previously ﬁxed set of primes S. They proved
that the inequality
gcd(u −1, v −1) ≤max(|u|, |v|)−ε
holds provided max(|u|, |v|) is sufﬁciently large depending on S and ε. This result
is well known to imply Corollary 3. See also Corvaja, Rudnick, and Zannier [4] for
a related application of these methods to the multiplicative order of integer matrices
mod Q, which contains Corollary 3. A further extension was obtained by Luca [9,
Theorem 2.1], who allows u and v to be rational numbers that may contain prime
factors outside S, provided their product (with multiplicities) is small compared to
max(|u|, |v|). Furthermore, in this work, u and v are allowed to be multiplicatively
dependent, provided they have no multiplicative relation with small exponents.
Corvaja and Zannier [5] developed these ideas in another direction to estimate
the greatest common divisors of rational functions evaluated at S units. These results
have been extended by Levin [8] to higher dimension.
See also the books of Zannier [10] and Corvaja, Zannier [6], where some of these
results are discussed further.
We introduce some notation. We ﬁx a set S, which consists of a ﬁnite number
of (ﬁnite) primes and the symbol ∞. We write Sf = S\{∞}. For each v ∈S, we
deﬁne a valuation |·|v on Q. If v is ﬁnite and x ∈Z, then we set |x|v = v−m, where
m is the largest integer with vm|x, and we extend | · |v to Q multiplicatively. This is

376
P. P. Varjú
the standard v-adic absolute value. We deﬁne | · |∞to be the standard Archimedean
absolute value. We write S for the set of positive integers all of whose prime factors
are contained in Sf .
Now we can state our second main result, which extends the abovementioned
result of Luca [9].
Theorem 4 For all ε > 0 and S as above, there are C ∈R>1, α ∈R>0 and
N ∈Z>0 such that the following holds:
Let a1, b1, a2, b2 ∈Z be numbers that are not divisible by any prime in Sf . Let
s1, t1, s2, t2 ∈S. Assume
gcd(a1s1, b1t1) = gcd(a2s2, b2t2) = 1.
Let
H = max(s1, t1, s2, t2).
Assume further that
gcd(a1s1 −b1t1, a2s2 −b2t2) ≥H ε.
(1)
Then at least one of the following three items holds:
(a) H ≤C,
(b) max(a1, b1, a2, b2) ≥H α,
(c) There are n1, n2 ∈Z not both 0 such that |n1|, |n2| ≤N −1 and
a1s1
b1t1
n1 =
a2s2
b2t2
n2.
The constant C is ineffective, but α and N can be made explicit. The theorem
always holds (with a suitably large C depending on ε and S) provided
N =
632
7ε
7
,
α =
7
512ε2.
In fact, we will use in the proof only that ε, N, and α satisfy the inequalities
(N + 1)ε >2N2α + 4,
(2)
ε >16(N −1)α.
(3)
This result improves on [9, Theorem 2.1] in the following aspects:
•
The result in [9] is not applicable when s1, t2, s2, t2 are of comparable size.

Times 2, 3 mod Q
377
•
The bound on max(a1, b1, a2, b2) in [9] is of the form H α/ log log H. (Note that H
signiﬁes a different quantity in the notation of [9], and we translated the bound
to our notation.)
•
We make the value of N explicit.
It was observed by Bugeaud, Corvaja, and Zannier that there are inﬁnitely many
values of n such that
gcd(an −1, bn −1) ≥exp(exp(c log n/ log log n)),
where a and b are multiplicatively independent integers and c > 0 is an absolute
constant; see the second remark after Theorem 1 in [2]. This signiﬁcantly limits the
extent of any possible improvement over (1). However, in this example, the greatest
common divisor is highly composite, and it is not clear how large a common prime
factor of s1 −1 and s2 −1 can be for some s1, s2 ∈S. This question is of particular
interest in the context of Corollary 3 if we restrict Q to be a prime.
It follows by the box principle that for any Q ∈Z≥1 and for any s ∈Z≥1, there
are a, b ∈Z with |a|, |b| ≤Q1/2 such that Q|as −b. This shows that we cannot
hope to take α larger than Cε in Theorem 4 for some constant C > 0. However, this
still leaves signiﬁcant room for improvement.
Theorem 2 easily follows from Theorem 4, which we show now.
Proof of Theorem 2 Assuming Theorem 4 Suppose there are a1, b1, a2, b2
∈
B(β, Q) and (m1, n1), (m2, n2) ∈Z2 that are not collinear such that
|m1|, |m2| ≤K log Q
log p ,
|n1|, |n2| ≤K log Q
log q
and
pm1qn1a1 = b1,
pm2qn2a2 = b2.
We show that Q must be bounded by a constant depending on p, q, and K only.
To this end, we set S = {p, q, ∞} and deﬁne s1, t1, s2, t2 ∈S such that s1/t1 =
pm1qn1 and s2/t2 = pm2qn2. We denote by the same symbols the unique lifts of
a1, b1, a2, b2 in Z ∩[−Qβ, Qβ]. We assume without loss of generality that
gcd(a1, b1) = gcd(a2, b2) = gcd(s1, t1) = gcd(s2, t2) = 1.
Since a1, b1, a2, b2 ∈B(β, Q), their lifts (denoted by the same symbol) are not
divisible by p or q, so we get
gcd(a1s1, b1t1) = gcd(a2s2, b2t2) = 1.
We also note that

378
P. P. Varjú
gcd(a1s1 −b1t1, a2s2 −b2t2) ≥Q ≥H 1/2K,
where
H = max(s1, t1, s2, t2) ≤max(p|m1|q|n1|, p|m2|q|n2|).
Now we see that all the assumptions of Theorem 4 hold with
ε := log Q/ log H ≥1/2K.
Item (b) of the conclusion cannot hold, because
max(|a1|, |b1|, |a2|, |b2|) ≤Qβ = H βε,
provided β is small enough so that βε ≤α.
Item (c) also cannot hold, because (m1, n1) and (m2, n2) are not collinear, and
this implies that a1s1/b1t1 and a2s2/b2t2 are multiplicatively independent. This
means that item (a) must hold, which is precisely what we wanted to prove.
For this argument to work, we only need that β is not larger than α/ε. With
α = (7/512)ε2 and ε ≥1/2K, we see that β = 1/147K is sufﬁcient.
⊓⊔
We prove Theorem 4 in the next section. The proof uses Schlickewei’s S-adic
generalization of Schmidt’s subspace theorem. The general approach goes back to
the paper of Bugeaud, Corvaja, and Zannier [2], which has been developed further
subsequently in [3–5, 7–9]. Our proof makes use of the new construction introduced
by Levin [8] to choose the linear forms for which the subspace theorem is applied.
1.1
Notation
Throughout the paper, we ﬁx a ﬁnite set S that consists of some prime numbers and
the symbol ∞. We write Sf = S\{∞}. We write S for the set of positive integers,
all of whose prime divisors are in Sf .
When we have a notation similar to X1, . . . , Xn, we sometimes write X• to refer
to the whole sequence, or to a generic element of the sequence. The exact meaning
will always be clear from the context.
The height of an integer vector x ∈Zd is deﬁned as
H(x1, . . . , xd) = max(|x1|∞, . . . , |xd|∞),
where | · |∞is the standard Archimedean absolute value on Q.

Times 2, 3 mod Q
379
2
Proof of Theorem 4
The purpose of this section is the proof of Theorem 4. Our main tool is Schmidt’s
subspace theorem in the following generalized form due to Schlickewei:
Theorem 5 (S-Adic Subspace Theorem) Let d ∈Z≥2. For each v ∈S, let
L(v)
1 , . . . , L(v)
d
∈Q[x1, . . . , xd] be linearly independent linear forms. Then for all
ε > 0, the solutions (x1, . . . , xd) ∈Zd of the inequality

v∈S
d
j=1
|L(v)
j (x1, . . . , xd)|v ≤H(x1, . . . , xd)−ε
(4)
lie in a ﬁnite union of proper subspaces of Qd.
See [1, Corollary 7.2.5] for a proof of this result. In our applications, we will use
the subspace theorem in a ﬁnite-dimensional vector space V over Q, and to facilitate
the application of the subspace theorem, we need to ﬁx an isomorphism from V
to Qd. In these applications, there will be no natural choice for this isomorphism,
and its exact choice will be largely immaterial. For this reason, we reformulate the
subspace theorem in the following equivalent form:
Theorem 6 Let V be a d ∈Z≥2 dimensional vector space over Q. For each v ∈S,
let (v)
1 , . . . , (v)
d
be a basis of the dual space V ∗. Furthermore, let (0)
1 , . . . , (0)
d
be another basis of V ∗. Then, for all ε, there is a ﬁnite set 1, . . . , m ∈V ∗
̸=0 such
that every solution of

v∈S
d
j=1
|(v)
j (x)|v ≤H((0)
1 (x), . . . , (0)
d (x))−ε
for x ∈V with (0)
j (x) ∈Z for all j = 1, . . . , d satisﬁes i(x) = 0 for some
i ∈{1, . . . , m}.
In our proof of Theorem 4, the ﬁrst application of the subspace theorem will
yield a ﬁnite collection of polynomials in two variables depending only on ε and
S such that one of the polynomials must vanish at the point (a1s1/b1t1, a2s2/b2t2)
for any putative counterexample to the theorem. After this, a second application of
the subspace theorem will be needed to conclude the proof. This second part of the
proof amounts to proving the following statement:
Proposition 7 For all ε > 0 and S as above, there are α ∈R>0 and N ∈Z>0 such
that the following holds: Fix a polynomial P ∈Q[x1, x2] of degree at most N −1.
Then, there is C (depending on P, S, and ε) such that the following holds:
Let a1, b1, a2, b2 ∈Z be numbers that are not divisible by any prime in Sf . Let
s1, t1, s2, t2 ∈S. Assume

380
P. P. Varjú
gcd(a1s1, b1t1) = gcd(a2s2, b2t2) = 1
and
P
a1s1
b1t1
, a2s2
b2t2

= 0.
Let
H = max(s1, t1, s2, t2).
Assume further that
gcd(a1s1 −b1t1, a2s2 −b2t2) ≥H ε.
Then at least one of the following three items holds:
(a) H ≤C,
(b) max(a1, b1, a2, b2) ≥H α,
(c) There are n1, n2 ∈Z not both 0 such that |n1|, |n2| ≤N −1 and
a1s1
b1t1
n1 =
a2s2
b2t2
n2.
The constant C is ineffective, but α and N can be made explicit. The proposition
always holds (with a suitably large C depending on ε, S and P) provided
N =
632
7ε
7
,
α =
7
512ε2.
Notice that this is just a restatement of Theorem 4 with the additional assumption
that the point (a1s1/b1t1, a2s2/b2t2) is restricted to a curve. This result is unlikely
to be either new or optimal. However, it sufﬁces for our purposes, and the proof is
simple, so we include it after we showed how Theorem 4 can be reduced to it.
The construction of the linear forms in the following proof is essentially a special
case of the construction of Levin [8, Proof of Theorem 3.2].
Proof of Theorem 4 Assuming Proposition 7 Let ε ∈R>0, and let α ∈R>0 and
N ∈Z>0 satisfy (2)–(3). We also ﬁx some a1, b1, a2, b2, s1, t1, s2, t2 that satisfy all
hypotheses of Theorem 4 and which fail items (b) and (c) of the conclusion. We aim
to show that item (a) of the conclusion holds, that is, H ≤C for some constant C
depending only on ε and S.
We let
Q = gcd(a1s1 −b1t1, a2s2 −b2t2).

Times 2, 3 mod Q
381
We assume, as we may, that Q is not divisible by any prime in Sf . If we had p|Q
for some p ∈Sf , then necessarily p ∤s1t1s2t2, and we could just omit p from S.
In what follows, we consider the space QN2 ≡Q{0,...,N−1}2 and write
y = (yl1,l2)l1=0,...,N−1,l2=0,...,N−1
for its typical element. We will apply the subspace theorem for the quotient space
V = Q{0,...,N−1}2/{(z, z, . . . , z)}.
We will evaluate the linear forms at the point Iy ∈V whose coordinates are
Iyl1,l2 = al1
1 sl1
1 bN−1−l1
1
tN−1−l1
1
al2
2 sl2
2 bN−1−l2
2
tN−1−l2
2
Q
.
Strictly speaking, this speciﬁes a point in Q{0,...,N−1}2, but we do not distinguish Iy
from its projection to V in our notation.
For each v ∈S, let (l(v)
1 , l(v)
2 ) be such that |Iyl1,l2|v is minimal for (l1, l2) =
(l(v)
1 , l(v)
2 ). We deﬁne the set of linear forms (v)
•
∈V ∗to be an enumeration of the
forms
y →yl1,l2 −yl(v)
1 ,l(v)
2
for (l1, l2) ∈{0, . . . , N −1}2\(l(v)
1 , l(v)
2 ). It is easy to verify that these are indeed in
V ∗, that is they are constant on cosets of the line {(z, z, . . . , z)}, and that they also
form a basis.
We also deﬁne (0)
•
= (∞)
•
. We note that
Iyl1,l2 −Iyl′
1,l′
2 ∈Z
for all l1, l2, l′
1, l′
2 ∈{0, . . . , N −1}, since
a1s1 ≡b1t1,
a2s2 ≡b2t2 mod Q,
and hence
al1
1 sl1
1 bN−1−l1
1
tN−1−l1
1
al2
2 sl2
2 bN−1−l2
2
tN−1−l2
2
mod Q
is independent of l1 and l2. For this reason,
(0)
• (Iy) ∈ZN2−1.
We observe that

382
P. P. Varjú
|Iyl1,l2 −Iyl(v)
1 ,l(v)
2 |v ≤Cv|Iyl1,l2|v
for each (l1, l2) and v ∈S, where Cv = 1 if v is ﬁnite and C∞= 2. This means that
we have

v∈S
•|(v)
• (Iy)|v ≤2N2−1

v∈S
N−1
l1=0
N−1
l2=0 |Iyl1,l2|v

v∈S |Iyl(v)
1 ,l(v)
2 |v
.
(5)
Here • signiﬁes multiplication over the index suppressed by the • notation.
We ﬁrst estimate the numerator in (5). For each (l1, l2) ∈{0, . . . , N −1}2, we
have

v∈S
|Iyl1,l2|v = |al1
1 bN−1−l1
1
al2
2 bN−1−l2
2
|∞
|Q|∞
≤H 2(N−1)αQ−1.
This gives us

v∈S
N−1

l1=0
N−1

l2=0
|Iyl1,l2|v ≤H 2(N−1)N2αQ−N2.
Next, we estimate the denominator in (5). We note that
|Iyl(v)
1 ,l(v)
2 |∞≥Q−1.
Furthermore, we have
|Iyl(v)
1 ,l(v)
2 |v ≥|sN−1
1
tN−1
1
sN−1
2
tN−1
2
|v
for all ﬁnite v ∈S; hence

v∈Sf
|Iyl(v)
1 ,l(v)
2 |v ≥s−N+1
1
t−N+1
1
s−N+1
2
t−N+1
2
≥H −4(N−1).
(Here we used that Q is not divisible by any prime in S.)
Combining our estimates for the numerator and denominator in (5), we get

v∈S
•|(v)
• (Iy)|v ≤2N2−1Q−N2+1H 2(N−1)N2α+4(N−1)
≤2N2−1H 2(N−1)N2α+4(N−1)−(N2−1)ε.
We write

Times 2, 3 mod Q
383
2δ = (N2 −1)ε −2(N −1)N2α −4(N −1),
which is positive by (2). We assume as we may that 2N2−1 ≤H δ; for otherwise
H ≤2δ−1(N2−1), and we see that item (a) of the conclusion holds. Therefore, we
have

v∈S
•|(v)
• (Iy)|v ≤H −δ.
We observe that
H((0)
• (Iy)) ≤2 max
l1,l2
|Iyl1,l2|∞≤H 2(1+α)(N−1),
and hence

v∈S
•|(v)
• (Iy)|v ≤H((0)
• (Iy))−
δ
2(1+α)(N−1) .
This means that the subspace theorem applies, and we conclude that there is a
ﬁnite collection of linear forms • such that j(Iy) = 0 for some j. It may appear
that the set of linear forms • depends on Iy, for the linear forms (v)
•
were chosen
in a manner depending on it. However, there are only ﬁnitely many possibilities, and
if we take • to be the union of all linear forms that we obtain from each possible
application of the subspace theorem, then it is independent of Iy.
Now j lifts to a nonzero linear form on QN×N, and it induces a non-zero
polynomial Pj ∈Q[x1, x2] such that
Pj
a1s1
b1t1
, a2s2
b2t2

= 0.
We can now apply Proposition 7 for each polynomial Pj that arises in this way, and
we conclude the proof.
⊓⊔
We turn to the proof of Proposition 7. It requires the following simple lemma:
Lemma 8 Let y1 ̸= y2 ∈Z, Q ∈Z̸=0 be such that Q|y1 −y2 and Q is not divisible
by any primes in S. Then,

v∈S
min(|y1|v, |y2|v) ≤2
Q ·

v∈S
|y1y2|v
Proof It is clear that neither the assumptions nor the conclusion of the lemma
changes if we divide both y1 and y2 by a divisor of gcd(y1, y2) all of whose prime
factors are in S. For this reason, we may assume that gcd(y1, y2) contains no prime
factor that is in S.

384
P. P. Varjú
We have

v∈S
min(|y1|v, |y2|v) =

v∈S
|y1y2|v
max(|y1|v, |y2|v).
Since gcd(y1, y2) contains no prime factor that is in S, we have max(|y1|v, |y2|v) =
1 for all ﬁnite places v ∈S. In addition, we have max(|y1|∞, |y2|∞) ≥Q/2,
because y1 and y2 are distinct integers whose difference is divisible by Q. Plugging
these observations into the above identity, we get the claim of the lemma.
⊓⊔
Proof of Proposition 7 Let ε ∈R>0, and let α ∈R>0 and N ∈Z>0 satisfy (2)–(3).
Let P be as in Proposition 7. We also ﬁx some a1, b1, a2, b2, s1, t1, s2, t2 that satisfy
all hypotheses of the proposition and which fail items (b) and (c) of the conclusion.
We aim to show that item (a) of the conclusion holds.
We assume without loss of generality that P is irreducible. Write d1 and d2 for
the degrees of P in x1 and x2, respectively, and let
P(x1, x2) =
d1

j1=0
d2

j2=0
αj1,j2xj1
1 xj2
2 .
We note that d1, d2 ≤N −1 by assumption.
We also assume without loss of generality that d1, d2 ≥1. Indeed, if we had
d2 = 0, say, then there would be only ﬁnitely many possibilities for a1s1/b1t1 such
that P(a1s1/b1t1, ·) = 0 holds, and this in turn restricts a1, s1, b1, t1 to a ﬁnite set.
This imposes an upper bound on gcd(a1s1 −b1t1, a2s2 −b2t2) and hence on H
unless a1s1 −b1t1 = 0. However, this latter case is not possible, because item (c) of
the conclusion would hold with
a1s1
b1t1
1
=
a2s2
b2t2
0
.
We see that d1 = 0 or d2 = 0 implies that item (c) of the conclusion holds, so we
can indeed assume d1, d2 ≥1.
We also note that at least one in each of the four sets α0,•, αd1,•, α•,0, and α•,d2
of coefﬁcients does not vanish. (Here we used that P is irreducible and P ̸= x1 and
P ̸= x2.)
In what follows, we consider the space Q2d1×2d2, whose typical element is
denoted by
y = (yl1,l2)l1=0,...,2d1−1,l2=0,...,2d2−1.
For m1 = 0, . . . , d1 −1 and m2 = 0, . . . , d2 −1, we write

Times 2, 3 mod Q
385
#m1,m2(y) =
d1

j1=0
d2

j2=0
αj1,j2yj1+m1,j2+m2,
which is a linear form on Q2d1×2d2. We observe that a point (x1, x2) ∈Q2
̸=0 satisﬁes
P(x1, x2) if and only if
#m1,m2((xl1
1 xl2
2 )l1=0,...,2d1−1,l2=0,...,2d2−1) = 0
holds for at least one and hence for all m1, m2 in the relevant range. We write V for
the 3d1d2-dimensional subspace of Q2d1×2d2 on which all #m1,m2 vanish.
We consider the point Iy ∈V given by
Iyl1,l2 = al1
1 sl1
1 b2d1−1−l1
1
t2d1−1−l1
1
al2
2 sl2
2 b2d2−1−l2
2
t2d2−1−l2
2
.
To verify that #m1,m2(Iy) = 0, we note that
b−2d1+1
1
t−2d1+1
1
b−2d2+1
2
t−2d2+1
2
· Iyl1,l2 =
a1s1
b1t1
l1a2s2
b2t2
l2.
In what follows, we use the subspace theorem to show that there is a ﬁnite
collection • ∈V ∗
̸=0 such that j(Iy) = 0 for some j, and this collection of linear
forms is independent of the choice of a1, b1, a2, b2, s1, t1, s2, t2. Each j can be
lifted to a linear form on Q2d1×2d2, which is not in the span of the #m1,m2. We
denote this linear form with the same symbol. Then, the polynomial
Qj(x1, x2) = j((xl1
1 xl2
2 )l1=0,...,2d1−1,l2=0,...,2d2−1)
is not in the ideal generated by P, but
Qj
a1s1
b1t1
, a2s2
b2t2

= 0.
Each such Qj has only ﬁnitely many common solutions with P. This means that
the point
a1s1
b1t1
, a2s2
b2t2

must belong to a certain ﬁnite set, which depends only on P and S, and this means
that item (a) in the conclusion holds with some C that depends only on P and S.
This will complete the proof.
The next step is to choose the families of linear forms on V needed for the
application of the subspace theorem. For each place v ∈S, we choose a set

386
P. P. Varjú
Lv ⊂{0, . . . , 2d1 −1} × {0, . . . , 2d2 −1} of cardinality dim V = 3d1d2. We then
deﬁne (v)
•
to be an enumeration of the linear forms y →yl1,l2 for (l1, l2) ∈Lv.
Let i be the smallest and let k be the largest index such that α0,i ̸= 0 and αd1,k ̸=
0, respectively. (Recall that αj1,j2 are the coefﬁcients of P.) Each of the sets Lv will
be either
{0, . . . , 2d1 −1}×{0, . . . , 2d2 −1}\{d1, . . . , 2d1 −1}×{k, . . . , k +d2 −1}
(6)
or
{0, . . . , 2d1 −1} × {0, . . . , 2d2 −1}\{0, . . . , d1 −1} × {i, . . . , i + d2 −1}.
(7)
We ﬁrst show that the resulting linear forms (v)
•
form a basis of V ∗in either
case. In fact, we show this only in the case of (6), because the case of (7) can be
treated in a similar fashion. Since |(6)| = dim V , it is enough to show that the linear
forms y →yl1,l2 for (l1, l2) ∈(6) span V ∗. To that end, it is enough to show that
y →yl1,l2 is in the span for all (l1, l2) ∈{d1, . . . , 2d1 −1} × {k, . . . , k + d1 −1}.
Fix some (l′
1, l′
2) ∈{d1, . . . , 2d1 −1} × {k, . . . , k + d1 −1}. We observe that
yl′
1,l′
2 = −

(j1,j2)̸=(d1,k)
αj1,j2
αd1,k
yj1+l′
1−d1,j2+l′
2−k
for all y ∈V . This means that y →yl′
1,l′
2 is in the span of the linear forms y →yl1,l2
for
(l1, l2) ∈{0, . . . , l′
1 −1} × {0, . . . , 2d2 −1} ∪{l′
1} × {0, . . . , l′
2 −1}.
Using this observation, we can prove that (l′
1, l′
2) is in the span of y →yl1,l2 for
(l1, l2) ∈(6) by induction ﬁrst on l′
1 and then on l′
2.
For each v ∈S, we deﬁne (v)
•
using (6) if |Iyd1,k|v ≥|Iy0,i|v, and we use (7)
otherwise. We write A = (6) ∩(7) and B = (6)\(7). We observe that {0, . . . , 2d1 −
1} × {0, . . . , 2d2 −1} is the disjoint union of the sets A, B, and B + (d1, k −i).
For each v ∈S, (v)
•
contains y →yl1,l2 for all (l1, l2) ∈A, and it also contains
precisely one of y →yl1,l2 or y →yl1+d1,l2+k−i for each (l1, l2) ∈B, and it
contains the one which gives a smaller or equal | · |v value to Iy. This means that

v∈S
•|(v)
• (Iy)|v =

v∈S

(l1,l2)∈A
|Iyl1,l2|v
×

v∈S

(l1,l2)∈B
min(|Iyl1,l2|v, |Iyl1+d1,l2+k−i|v).
Here • signiﬁes multiplication over the index suppressed by the • notation.

Times 2, 3 mod Q
387
We note that Iyl1,l2 ̸= Iyl1+d1,l2+k−i for each (l1, l2) ∈B follows from
a1s1
b1t1
d1 ̸=
a2s2
b2t2
i−k
,
which in turn follows from our assumption that item (c) in the conclusion does
not hold. Therefore, we can apply Lemma 8 for each pair Iyl1,l2,Iyl1+d1,l2+k−i for
(l1, l2) ∈B and get

v∈S
•|(v)
• (Iy)|v ≤
 2
Q
|B|
·

v∈S
2d1−1

l1=0
2d2−1

l2=0
|Iyl1,l2|v.
We note that

v∈S
|Iyl1,l2|v = |al1
1 b2d1−1−l1
1
al2
2 b2d2−1−l2
2
|∞≤H (2d1+2d2−2)α.
This and Q ≥H ε gives

v∈S
•|(v)
• (Iy)|v ≤2d1d2H 4d1d2(2d1+2d2−2)α−d1d2ε.
We write
2δ = ε −8(d1 + d2 −1)α,
which is positive by assumption (3). We assume as we may that 2 ≤H δ, for
otherwise H ≤21/δ, and item (a) of the conclusion holds. We have, therefore,

v∈S
•|(v)
• (Iy)|v ≤H −δd1d2.
We apply the subspace theorem with the linear forms (v)
•
deﬁned above and
with (0)
•
= (∞)
•
. We note that (0)
• (Iy) ∈Z3d1d2 and
H((0)
• (Iy)) ≤max
l1,l2
|Iyl1,l2|∞≤H (2d1+2d2−2)(1+α).
We have, therefore,

v∈S
•|(v)
• (Iy)|v ≤H((0)
• (Iy))−
δd1d2
(2d1+2d2−2)(1+α) .
This means that the subspace theorem applies, and hence there is a ﬁnite collection
of linear forms • ∈V ∗
̸=0 such that j(Iy) = 0 for some j.

388
P. P. Varjú
It may appear that the linear forms • depend on Iy, because the choice of (v)
•
for each v ∈S depends on it. However, there are only ﬁnitely many possibilities
we need to consider, so we can simply take the union of the linear forms that result
from each possible application of the subspace theorem. As we discussed above,
this completes the proof.
⊓⊔
Acknowledgments I am grateful to Elon Lindenstrauss for the very helpful discussions on the
subject of this note and to Yann Bugeaud, Pietro Corvaja, Umberto Zannier, and the anonymous
referee for the very helpful comments on an earlier version of this note.
References
1. Bombieri, E., Gubler, W.: Heights in Diophantine geometry. New Mathematical Monographs,
vol. 4. Cambridge University Press, Cambridge (2006). MR2216774 ↑6
2. Bugeaud, Y., Corvaja, P., Zannier, U.: An upper bound for the G.C.D. of an −1 and bn −1.
Math. Z. 243(1), 79–84 (2003). MR1953049 ↑3 4 5
3. Corvaja, P., Zannier, U.: On the greatest prime factor of (ab + 1)(ac + 1). Proc. Am. Math.
Soc. 131(6), 1705–1709 (2003). MR1955256 ↑2, 3, 5
4. Corvaja, P., Rudnick, Z., Zannier, U.: A lower bound for periods of matrices. Comm. Math.
Phys. 252(1–3), 535–541 (2004). MR2104888 ↑3, 5
5. Corvaja, P., Zannier, U.: A lower bound for the height of a rational function at S-unit points.
Monatsh. Math. 144(3), 203–224 (2005). MR2130274 ↑3, 5
6. Corvaja, P., Zannier, U.: Applications of Diophantine approximation to integral points and
transcendence. Cambridge Tracts in Mathematics, vol. 212. Cambridge University Press,
Cambridge (2018). MR3793125 ↑3
7. Hernández, S., Luca, F.: On the largest prime factor of (ab+1)(ac+1)(bc+1). Bol. Soc. Mat.
Mexicana (3) 9(2), 235–244 (2003). MR2029272 ↑2, 3, 5
8. Levin, A.: Greatest common divisors and Vojta’s conjecture for blowups of algebraic tori.
Invent. Math. 215(2), 493–533 (2019). MR3910069 ↑3, 5, 7
9. Luca, F.: On the greatest common divisor of u−1 and v−1 with u and v near S-units. Monatsh.
Math. 146(3), 239–256 (2005). MR2184226 ↑3, 4, 5
10. Zannier, U.: Some problems of unlikely intersections in arithmetic and geometry. Annals
of Mathematics Studies, vol. 181. Princeton University Press, Princeton, NJ (2012). With
appendixes by David Masser. MR2918151 ↑3

