HIGH PRECISION MODELING OF GERMANIUM DETECTOR WAVEFORMS USING
BAYESIAN MACHINE LEARNING
Benjamin E. Shanks
A dissertation submitted to the faculty at the University of North Carolina at Chapel Hill
in partial fulﬁllment of the requirements for the degree of Doctor of Philosophy in the
Department of Physics.
Chapel Hill
2017
Approved by:
John F. Wilkerson
Joaquin Drut
Matthew P. Green
Reyco Henning
David C. Radford

c⃝2017
Benjamin E. Shanks
ALL RIGHTS RESERVED
ii

ABSTRACT
Benjamin E. Shanks:
High precision modeling of germanium detector waveforms using
Bayesian machine learning
(Under the direction of John F. Wilkerson)
The universe as we see it today is dominated by matter, but the Standard Model of
particle physics cannot explain why so little antimatter remains. If the neutrino is its own
antiparticle – a so-called Majorana particle – lepton number must be violated, which is a key
component of theories that explain the observed matter-antimatter asymmetry. Neutrinoless
double-beta decay (0νββ), a hypothetical radioactive decay in certain nuclei, is the only
experimentally accessible signature that can prove if neutrinos are Majorana in nature. But
if it exists, 0νββ must be exceedingly rare, with current half-life limits over 1025 years.
Measuring a process with such a faint signal requires extraordinary eﬀorts to eliminate
backgrounds. The Majorana Demonstrator is a search for 0νββ of germanium-76 in
an array of germanium detectors, with the goal of “demonstrating” backgrounds low enough
to justify building a larger experiment with ∼1 tonne of isotope.
Reducing backgrounds even further will be critical to the discovery potential of a tonne
scale experiment. One powerful method to reject background is pulse shape discrimination,
which uses the shape of measured detector signals to diﬀerentiate between background and
candidate 0νββ events. With a better understanding of pulse shapes from our detectors,
we may be able to improve the discrimination eﬃciency.
We have developed a detailed
model of signal formation in germanium detectors, where the shape depends sensitively
on characteristics speciﬁc to each individual detector crystal. To train the parameters for
speciﬁc crystals in the Demonstrator, we have implemented a Bayesian machine learn-
ing algorithm which is able to infer detector characteristics using only standard calibration
waveforms. This model is accurate to the level of parts per thousand of the signal amplitude,
iii

is able to discriminate against common background events, and has even shown some ability
to estimate the position of origin for signals inside the detector.
iv

ACKNOWLEDGEMENTS
There are countless people whose support has made this dissertation possible. Thanks
to my advisor, John Wilkerson, who allowed me the freedom to explore new ideas, the
direction to bring them to fruition and a steady hand when things seemed hopeless. Chris
O’Shaughnessy was the earliest and strongest supporter of this work, and it would never
would have materialized without his encouragement and input. I’ve relied extensively on the
work and germanium detector expertise of David Radford. Reyco Henning provided valuable
advice and suggestions. Matt Green taught me how to be useful around a vacuum system.
I have been fortunate to be surrounded many excellent Majorana collaborators, both to
learn from and to help pass the time in South Dakota.
Before coming back to physics, I spent a few years at General Electric. Mike Durling’s
backing and advice came at a critical point in my career. Mauricio Castillo-Eﬀen took me
under his wing and introduced me to MCMC. Their inﬂuence on this work and my career
can’t be understated.
Finally, thanks to my parents for a lifetime of encouragement and support, to my friends
for keeping me grounded, and to Carly for inspiring and sharing the journey alongside me.
v

TABLE OF CONTENTS
LIST OF TABLES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
ix
LIST OF FIGURES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
x
LIST OF ABBREVIATIONS AND SYMBOLS
. . . . . . . . . . . . . . . . .
xiii
1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
1.1
Neutrinoless double beta decay
. . . . . . . . . . . . . . . . . . . . . . . . .
1
1.2
The Majorana Demonstrator . . . . . . . . . . . . . . . . . . . . . . .
5
1.2.1
Initial results of the Majorana Demonstrator
. . . . . . . . . .
7
1.3
Signal modeling for germanium 0νββ experiments . . . . . . . . . . . . . . .
7
2
Modeling signal formation in germanium detectors . . . . . . . . . . . . .
15
2.1
Operating Principles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
15
2.1.1
Semiconductor detector design . . . . . . . . . . . . . . . . . . . . . .
15
2.1.2
P-type point contact detectors . . . . . . . . . . . . . . . . . . . . . .
18
2.1.3
Signal Formation: The Shockley-Ramo Theorem . . . . . . . . . . . .
21
2.1.4
Pulse Shape Discrimination
. . . . . . . . . . . . . . . . . . . . . . .
24
2.2
Signal Parameterization
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
24
2.2.1
Detector Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . .
27
2.2.2
Waveform Parameters
. . . . . . . . . . . . . . . . . . . . . . . . . .
39
2.2.3
Electronics Parameters . . . . . . . . . . . . . . . . . . . . . . . . . .
44
vi

2.3
Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
48
3
Machine learning of germanium detector parameters . . . . . . . . . . . .
50
3.1
Bayesian modeling
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
51
3.1.1
Markov chain Monte Carlo . . . . . . . . . . . . . . . . . . . . . . . .
51
3.1.2
Diﬀusive nested sampling
. . . . . . . . . . . . . . . . . . . . . . . .
52
3.2
Learning model implementation . . . . . . . . . . . . . . . . . . . . . . . . .
55
3.2.1
Likelihood function . . . . . . . . . . . . . . . . . . . . . . . . . . . .
56
3.2.2
Waveform parameterization and priors . . . . . . . . . . . . . . . . .
58
3.2.3
Detector and electronics parameterization and priors
. . . . . . . . .
61
3.2.4
Sampling strategy . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
72
3.3
Choosing a training set
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
72
3.4
Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
82
4
Results & Applications
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
83
4.1
Machine learning results . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
83
4.1.1
Fit parameters
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
85
4.1.2
Fit to second detector
. . . . . . . . . . . . . . . . . . . . . . . . . .
88
4.2
Validation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
90
4.3
Uncertainties
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
102
4.4
Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
107
5
Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110
5.1
Summary of results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
110
vii

5.2
Additional studies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
111
5.3
Improvements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
112
5.3.1
Model improvements . . . . . . . . . . . . . . . . . . . . . . . . . . .
112
5.3.2
Training improvements . . . . . . . . . . . . . . . . . . . . . . . . . .
113
5.3.3
Computational improvements . . . . . . . . . . . . . . . . . . . . . .
114
5.4
Outlook for the Demonstrator and beyond . . . . . . . . . . . . . . . . .
114
BIBLIOGRAPHY . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116
viii

LIST OF TABLES
1.1
Summary of current 0νββ half life limits . . . . . . . . . . . . . . . . . . . .
5
3.1
Summary of the free parameters in the model. . . . . . . . . . . . . . . . . .
71
4.1
Training waveforms for detector P42661A . . . . . . . . . . . . . . . . . . . .
85
4.2
Fit parameters for P42661A . . . . . . . . . . . . . . . . . . . . . . . . . . .
89
4.3
Training waveforms for detector P2574A . . . . . . . . . . . . . . . . . . . .
90
ix

LIST OF FIGURES
1.1
Eﬀective Majorana mass as a function of lightest neutrino mass
. . . . . . .
3
1.2
Diagram comparing spectra for 2νββ and 0νββ
. . . . . . . . . . . . . . . .
5
1.3
Diagram of the Demonstrator shield
. . . . . . . . . . . . . . . . . . . .
8
1.4
Diagram of the Demonstrator detector unit
. . . . . . . . . . . . . . . .
9
1.5
Image of strings within a Demonstrator cryostat . . . . . . . . . . . . . .
10
1.6
Preliminary spectrum for initial Demonstrator data . . . . . . . . . . . .
11
1.7
0νββ 90% sensitivity as a function of background . . . . . . . . . . . . . . .
13
2.1
Schematic of a PPC detector . . . . . . . . . . . . . . . . . . . . . . . . . . .
19
2.2
Image of a PPC detector . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
20
2.3
Schematic of a coaxial detector
. . . . . . . . . . . . . . . . . . . . . . . . .
21
2.4
Weighting potential in a PPC detector . . . . . . . . . . . . . . . . . . . . .
22
2.5
Waveforms from multiple positions in a PPC detector . . . . . . . . . . . . .
23
2.6
Waveforms from single and multisite interactions
. . . . . . . . . . . . . . .
25
2.7
Carrier drift velocity in Ge as a function of electric ﬁeld and crystal axis
. .
31
2.8
Band structure in germanium . . . . . . . . . . . . . . . . . . . . . . . . . .
32
2.9
Constant-energy surfaces at germanium conduction band minima
. . . . . .
32
2.10 Constant-energy contours in germanium heavy-hole band . . . . . . . . . . .
34
2.11 Simulated eﬀect of charge trapping on waveforms
. . . . . . . . . . . . . . .
36
2.12 Simulated eﬀect of trapped charge release on waveforms . . . . . . . . . . . .
38
2.13 Comparison of various waveforms with same drift time
. . . . . . . . . . . .
39
2.14 Simulated eﬀect of crystal axis orientation on waveforms
. . . . . . . . . . .
40
2.15 Fractional risetime diﬀerence due to azimuthal velocity asymmetry . . . . . .
41
2.16 Error introduced by cloud shape approximation with a gaussian convolution
43
2.17 The generalized gaussian shape for charge clouds
. . . . . . . . . . . . . . .
44
2.18 Schematic of the Demonstrator signal readout chain . . . . . . . . . . . .
45
x

2.19 Simulated eﬀect of electronics shaping
. . . . . . . . . . . . . . . . . . . . .
47
2.20 Bode diagram of preamp gain . . . . . . . . . . . . . . . . . . . . . . . . . .
48
3.1
Illustration of diﬀusive nested sampling algorithm . . . . . . . . . . . . . . .
55
3.2
Digitized and windowed Demonstrator waveforms . . . . . . . . . . . . .
57
3.3
Noise distribution of Demonstrator waveforms . . . . . . . . . . . . . . .
57
3.4
Time alignment of digitized waveforms . . . . . . . . . . . . . . . . . . . . .
60
3.5
Decaying tail of a Demonstrator waveform . . . . . . . . . . . . . . . . .
62
3.6
Fit to decaying tail of waveforms
. . . . . . . . . . . . . . . . . . . . . . . .
63
3.7
Low-pass transfer function parameterization . . . . . . . . . . . . . . . . . .
65
3.8
Limits of velocity parameterization . . . . . . . . . . . . . . . . . . . . . . .
66
3.9
Electric ﬁeld in PPC detector . . . . . . . . . . . . . . . . . . . . . . . . . .
66
3.10 Histogram of electric ﬁeld in PPC detector . . . . . . . . . . . . . . . . . . .
67
3.11 Reparameterized velocity curves . . . . . . . . . . . . . . . . . . . . . . . . .
68
3.12 Charge trapping eﬀect on waveform amplitude . . . . . . . . . . . . . . . . .
71
3.13 Demonstrator calibration track
. . . . . . . . . . . . . . . . . . . . . . .
73
3.14 Demonstrator 228Th calibration spectrum . . . . . . . . . . . . . . . . . .
74
3.15 Current waveforms from 2614 keV photopeak
. . . . . . . . . . . . . . . . .
75
3.16 Eﬀect of A/E cut on 2614 keV photopeak
. . . . . . . . . . . . . . . . . . .
76
3.17 Waveforms before and after A/E cut from 2614 keV photopeak . . . . . . . .
77
3.18 Current waveforms of events which survive A/E cut . . . . . . . . . . . . . .
78
3.19 Cut based on waveform baseline . . . . . . . . . . . . . . . . . . . . . . . . .
80
3.20 Distribution of drift times of single site events . . . . . . . . . . . . . . . . .
81
4.1
Training waveforms for detector P42661A . . . . . . . . . . . . . . . . . . . .
84
4.2
Result of waveforms ﬁt to detector P42661A . . . . . . . . . . . . . . . . . .
86
4.3
Residuals of waveforms ﬁt to detector P42661
. . . . . . . . . . . . . . . . .
87
4.4
Drift velocity curve from ﬁt
. . . . . . . . . . . . . . . . . . . . . . . . . . .
88
xi

4.5
Training waveforms for detector P2574A . . . . . . . . . . . . . . . . . . . .
91
4.6
Residuals of waveforms ﬁt to detector P2574A . . . . . . . . . . . . . . . . .
92
4.7
Fit likelihoods for waveforms from single and double escape peak . . . . . . .
94
4.8
Comparison of A/E and ﬁt likelihood cut on the SEP and DEP
. . . . . . .
95
4.9
Waveforms of DEP events in detector P42661A
. . . . . . . . . . . . . . . .
96
4.10 Positions estimated for DEP events in detector P42661A . . . . . . . . . . .
98
4.11 Simulated DEP event positions
. . . . . . . . . . . . . . . . . . . . . . . . .
99
4.12 Azimuthal position estimated for DEP events
. . . . . . . . . . . . . . . . .
100
4.13 Waveforms of DEP events in detector P42574A
. . . . . . . . . . . . . . . .
101
4.14 Positions estimated for DEP events in detector P42574A . . . . . . . . . . .
102
4.15 Histogram of Markov chain values for electronics parameters . . . . . . . . .
104
4.16 Histogram of Markov chain values for velocity parameters . . . . . . . . . . .
105
4.17 Histogram of Markov chain values for detector parameters
. . . . . . . . . .
106
4.18 Histogram of Markov chain values for position . . . . . . . . . . . . . . . . .
108
xii

LIST OF ABBREVIATIONS AND SYMBOLS
0νββ
Neutrinoless Double-beta Decay
2νββ
Double-beta Decay
A/E
Current pulse amplitude to energy ratio
BEGe
Broad Energy Germanium
DEP
Double Escape Peak
DNS
Diﬀusive Nested Sampling
FET
Field Eﬀect Transistor
HPGe
High Purity Germanium
LMFE
Low Mass Front End
MCMC Markov Chain Monte Carlo
PPC
P-type Point Contact
PSD
Pulse Shape Discrimination
Q
End-point Energy
ROI
Region of Interest
SEP
Single Escape Peak
SURF
Sanford Underground Research Laboratory
xiii

CHAPTER 1:
Introduction
Section 1.1:
Neutrinoless double beta decay
Determining the Majorana or Dirac nature of the neutrino is one of most important open
challenges in neutrino physics. Unfortunately, any eﬀect that would distinguish between
them appears only at O(mν/E). Typical experiments fall in the regime mν/E ≪10−6 [1],
making a measurement of the neutrino nature extremely diﬃcult. The only signature of a
Majorana mass currently considered feasible to detect is neutrinoless double-beta decay.
Two-neutrino double beta decay (2νββ) is a second order standard-model-allowed process
observed in certain isotopes which have even numbers of both protons and neutrons. These
“even-even” nuclei are sometimes more stable than neighboring odd-odd isotopes due to
spin-pairing, which occurs independently for both protons and neutrons. In such an instance
normal β-decay is energetically forbidden, but Goeppert-Mayer [2] suggested in 1935 that a
double beta decay ((A, Z) →(A, Z + 2) + 2e−+ 2 ¯ve) might occur as a second order process
with an extremely long half-life (> 1017 yr). A half century passed before the ﬁrst direct
laboratory measurement by Elliott et. al. of 2νββ in 82Se [3], with a half life of 1.08 × 1020
years.
In 1937, Ettore Majorana suggested that neutral fermions could be their own antiparti-
cles [4], a description now known as Majorana fermions. Four years after Goeppert-Mayer
proposed 2νββ, Furry [5] showed that the existence of a Majorana neutrino would imply
an additional double decay mode in which no neutrino is emitted. In the modern formula-
tion of this process, the right-handed antineutrino emitted from one decaying neutron can
develop a left-handed component and be absorbed by a neighboring neutron. This is not
possible for a Dirac neutrino, since the neutrino and antineutrino are distinct particles. The
1

Majorana nature of the neutrino therefore permits virtual neutrino exchange to mediate the
0νββ decay (A, Z) →(A, Z + 2) + 2e−, violating lepton number by two units.
There are several diﬀerent lepton number violating mechanisms which could mediate
0νββ. The scenario considered most likely is “light neutrino mediated” decay. If we assume
the weak charged current is purely left handed and that either no unknown particles exist,
or any unknown particles are too massive to contribute signiﬁcantly to the 0νββ process,
then the process is mediated only by the three light neutrinos. To ﬁrst order, the half life of
the light neutrino exchange 0νββ process is then given by [6]
 T 0ν
1/2
−1 = G0ν |M0ν|2 ⟨mββ⟩2
(1.1)
where G0ν is a phase space factor, |M0ν|2 the nuclear matrix element and ⟨mββ⟩2 the eﬀective
Majorana mass, which is essentially an average of the mass states weighted by their mixing
in the electron neutrino:
⟨mββ⟩≡

X
i
U 2
eimi
 =
c2
12c2
13m1 + c2
13s2
12m2ei2φ2 + s2
13m3ei2φ3
(1.2)
Here, Uei are the component of the Pontecorvo-Maki-Nakagawa-Sakata (PMNS) neutrino
mixing matrix [7] that describes the composition of the electron neutrino in terms of the
mass state mi. The Majorana phases, φ1 and φ2, are possible CP violating terms in the
PMNS matrix for Majorana neutrinos (Dirac neutrinos have only one such phase). The
terms sij and cij are the sine and cosine, respectively, of the mixing angles θij of the PMNS
matrix, as measured by neutrino oscillation experiments.
The relationship between the
lightest neutrino mass and mββ is shown in Figure 1.1. The eﬀective Majorana mass, and
therefore the half-life of 0νββ, depends sensitively on the neutrino masses, and especially
on the neutrino mass ordering. A measurement of the half-life could, in turn, provide a
measurement of the neutrino mass.
The nuclear matrix element present in the half-life expression Equation 1.1 encapsulates
2

Figure 1.1: Eﬀective Majorana mass plotted as a function of lightest neutrino mass for the
cases of both normal (red) and inverted (green) mass ordering. The solid lines outline the
allowed parameter space allowed from neutrino oscillation experiments, with uncertainties
from neutrino mixing angles shown in the lighter color bands. Figure from [8].
the nuclear physics of the transition between the initial and daughter nucleii, and is not
exactly calculable. The term can be written
M0ν = g2
AM (0ν),
(1.3)
where gA is the axial vector coupling constant, and M (0ν) contains the contributions from
the Fermi, Gamow-Teller and tensor operators for the transition [8].
The value of gA is renormalized during calculations of nuclear models, and so can take on
an eﬀective value to describe the observed transition strength. In general, limitations in the
model cause the the eﬀective value of gA in model calculations to be reduced, or “quenched,”
from the value for quarks of 1.269 [9]. Because the half life term depends on the eﬀective
value as g4
A, the presence of quenching will aﬀect the half life with fourth power dependence.
However, the strength of the quenching eﬀect is currently not well understood and is the
3

focus of current theoretical eﬀorts [10].
Multiple approximation method have been employed to calculate M (0ν), as reviewed in
[10], notably the quasi-random phase approximation (QRPA), the interacting boson model
(IBM) and the interacting shell model (ISM). However, there are a large number of virtual
intermediate states available to the nucleus during the decay which increase computational
complexity of the calculation. For a given 0νββ candidate nucleus, disagreement between
calculations can vary by up to a factor of three – creating an order of magnitude uncertainty in
the half-life, and further complicating comparison between experiments in diﬀerent isotopes.
The experimental signature of 0νββ is a peak in the energy spectrum at the endpoint
energy of the decay (Qββ), as all the energy is shared between the pair of detected electrons.
The 2νββ mode creates a continuous spectrum varying up to the endpoint of the decay. A
simulated spectrum is shown in Figure 1.2. Typical measured half-lives for the 2νββ mode
are around 1021 years, while the best limits for 0νββ have extended to 1025 years [11].
Given the extremely rare nature of the decay, 0νββ experiments must be constructed with
a number of common design goals in mind. First, the largest possible mass of candidate iso-
tope should be present. Many experiments are designed such that the source material forms
the bulk of the detector. Backgrounds must be suppressed through radiopure construction
materials, analytic signal rejection or both. In order to distinguish remaining backgrounds
(including the irreducible 2νββ background) from signal, it is desirable to have good energy
resolution in the region of interest around Qββ. A summary of experimental considerations
is found in [6].
The search for neutrinoless double beta decay is an active ﬁeld, and there are current
experiments in a number of isotopes, including 76Ge, 130Te, and 136Xe. Table 1.1 summarizes
the limits from major experiments.
In order to cover the parameter space preferred for
inverted ordering neutrinos, an experiment must reach a sensitivity of mββ ≈20 meV (see
Figure 1.1), requiring tens of tonne-years of exposure. For this reason, most collaborations
intend to scale their current design into a next-generation detector with a tonne or more of
4

Figure 1.2: Spectra for 2νββ (dashed line) and 0νββ (solid line). Curves are drawn assuming
the decay rate of 0νββ is 1% that of 2νββ, with a 2% resolution. Figure from [6].
Experiment Name
Isotope
Half life limit (×1025 y)
GERDA Phase II [12]
76Ge
4.0
CUORE-0 [13]
130Te
0.4
EXO-200 [14]
136Xe
1.1
KamLAND-Zen [15]
136Xe
10.7
Table 1.1: Summary of current 0νββ half life limits.
isotopic mass.
Section 1.2:
The Majorana Demonstrator
The Majorana Demonstrator [16] is a search for neutrinoless double beta decay in
the isotope 76Ge. The experiment consists of an array of high purity germanium (HPGe)
detectors of the p-type point contact (PPC) geometry. In total, there are 44.1 kg of detectors,
of which 29.7 kg are 88% enriched in 76Ge. The main goal of the Demonstrator is to
prove a germanium detector array can be constructed with suﬃciently low background to
justify investment in a tonne-scale germanium-76 0νββ experiment. Using the nuclear matrix
element calculated with QRPA[17], a 76Ge experiment must be sensitive to a half-life T 0ν
1/2 ≈
5 · 1027 years in order to cover the inverted ordering at mββ ≈20 meV. With backgrounds
< 1 count/tonne-year, 10 tonne-years of exposure are required to reach this sensitivity at 3σ
conﬁdence. The exposure required increases signiﬁcantly at higher background levels.
5

The Demonstrator aims to achieve < 3 counts/tonne-year in a 4-keV-wide region of
interest (ROI) around Qββ, which is 2039 keV for 76Ge. Due to additional background reduc-
tion from self-shielding and granularity cuts, this scales to < 1 count/tonne-year for a tonne-
scale experiment. The current design goal for a tonne scale experiment is 0.1 count/tonne-
year in the ROI, which has been revised downward to ensure the inverted ordering region
is covered for the worst-case nuclear matrix element calculations. In addition to showing
the feasibility of a tonne-scale experiment, the Demonstrator will have a sensitivity to
T 0ν
1/2 ≈1026 yr. Using the same matrix element as above, this corresponds to mββ ≈100
meV.
The Demonstrator was designed and constructed to achieve the lowest possible back-
ground. Cosmic muon-induced signals are diminished by 4850’ of rock overburden above the
experiment site at the Davis Campus of Sanford Underground Research Facility (SURF) in
Lead, SD. An underground cleanroom lab facility was established with < 500 particles/ft3.
Parts within the cryostat, which therefore have a direct shine path to detectors, were main-
tained in dry boxes purged with liquid nitrogen boil-oﬀto minimize radon plate out. All
detector manipulation took place in a ntirogen-purged glovebox with a particle count < 10
particles/ft3. Radon levels and particle counts in the lab were carefully monitored before
sensitive work proceeded.
Construction materials were chosen to ensure radiopurity. The majority of the cryostat
material is composed of copper, which was manufactured with excellent chemical purity via
electroforming. However, copper is cosmogenically activated, inducing long-lived radioactive
isotopes, mainly 57Co and 60Co. To avoid cosmogenics, the Majorana collaboration built
an underground electroforming facility where copper was grown starting in 2011. The copper
was machined into parts in an underground shop staﬀed with a dedicated machinist.
A six-layer compact shield was designed with both active [18] and passive components.
On the outer layer, borated plastic moderates neutrons. Scintillator panels actively reject
muon events. A nearly airtight enclosure is ﬁlled with nitrogen purge gas to mitigate radon.
6

The remaining layers are composed of lead and copper, with electroformed copper used for
the innermost layer. A schematic of the shield is shown in Figure 1.3.
The Majorana detector unit design is shown in Figure 1.4. The germanium crystal is
electrically isolated using plastic standoﬀs, which double as the thermal path for cooling.
High voltage is applied via a copper contact ring, and signals are read out with a copper
contact pin.
A novel low noise low-mass front-end (LMFE) board [19] was designed to
provide a resistive feedback readout. Since it is low mass and made of ultra pure materials,
the LMFE can be placed near the detector, which minimizes stray capacitance. Three to
ﬁve detectors are stacked into a “string” which shares a common thermal connection to a
coldplate above. Each Majorana cryostat maintains cryogenic temperature and ultrahigh
vacuum for up to seven strings. Figure 1.5 contains an image of a fully loaded cryostat.
1.2.1:
Initial results of the Majorana Demonstrator
The Demonstrator is currently taking data with both modules in-shield. The collabo-
ration has analyzed the ﬁrst 32.4 days of data in this ﬁnal conﬁguration, taken from August
25 to September 27, 2016, and constituting 1.39 years of isotopic exposure. The spectrum
after preliminary analysis cuts is shown in Figure 1.6. For energies greater than ∼500 keV,
the two neutrino spectrum dominates the spectrum. Given the low exposure of this dataset,
we evaluate the background in a 400 keV wide window centered around Qββ. After cuts, one
background event remains in this window, which projects to 5.1+8.9
−3.2 counts / (ROI · t · y) for
a 2.9 keV ROI for module one detectors, and 2.6 keV ROI for module two detectors (where
each ROI was chosen to optimize sensitivity given resolution at Qββ). This corresponds to
a background index of 1.8 × 10−3 counts / (keV · t · y).
Section 1.3:
Signal modeling for germanium 0νββ experiments
The Demonstrator is meant to show that we can achieve backgrounds low enough to
justify building a tonne scale experiment that could cover the allowed parameter space for
7

(a)
(b)
Figure 1.3: (a) A schematic of the Demonstrator shield. (b) A picture of the shield
components up to the Radon enclosure. A cryostat is visible inside the shield. The removable
“blank” monolith seen here pulled away from the shield has been replaced with a second
cryostat, and both modules are currently taking data.
8

(a)
(b)
Figure 1.4: (a) A conceptual drawing of the Demonstrator detector unit. (b) Picture of
an assembled detector unit with LMFE visible on top.
9

Figure 1.5: Image of strings hanging from a Demonstrator cryostat. Seven strings hang
from a copper cold plate, obscured in the photo by the cryostat exterior.
10

Figure 1.6: Preliminary spectrum of initial Demonstrator data. The spectrum encom-
passes the ﬁrst 1.39 kg·y of enriched detector exposure for the Demonstrator in its ﬁnal
conﬁguration. The spectrum is shown after analysis cuts are applied. 2νββ of 76Ge is the
dominant spectral feature in the region above 500 keV. Qββ for 76Ge is 2039 keV.
11

0νββ in the inverted ordering. In the case of a background-free experiment, the half-life
sensitivity level S(T1/2) scales linearly with exposure,
S(T1/2) ∝M · t
(1.4)
where M is the isotopic mass and t the total time over which data are collected. In the
presence of background, due to poisson statistics, the sensitivity instead scales as a square
root of exposure
S(T1/2) ∝
r
M · t
b · ∆E
(1.5)
where b is the background index and ∆E the size of the ROI. Figure 1.7 plots the rela-
tionship between exposure and sensitivity for an enriched germanium, both for the case of
a background-free experiment and for several background indexes. As we approach the ∼
10 tonne-years of exposure necessary to cover the inverted ordering region, the background
dramatically impacts the sensitivity level of the experiment. Given this reality, it is espe-
cially important that the design of next generation experiments maximize the capability to
discriminate against background with analysis cuts.
By developing an accurate model of signal formation in germanium detectors, we have two
diﬀerent paths to achieving lower background in a tonne scale experiment. During the design
phase, we can use the model to create accurate simulated waveforms. These waveforms can
be used to realistically evaluate the eﬃciency of analysis cuts against simulated backgrounds,
and inform detector design to achieve maximal eﬃciency.
In addition to being used for design simulations, it is possible to use the model to discrim-
inate against background events. To ﬁrst order, it can be used to identify which waveforms
originate from the deposition of energy in the crystal bulk, like ββ events, thereby discrim-
inating against backgrounds which scatter at multiple locations in the detector, or against
events that are distorted due to edge eﬀects in the detector ﬁelds. Because of the unique two-
electron ββ signature, an extremely sensitive model could conceivably discriminate between
12

Exposure [ton-years]
3
−
10
2
−
10
1
−
10
1
10
2
10
3
10
 90% Sensitivity [years]
1/2
T
24
10
25
10
26
10
27
10
28
10
29
10
30
10
 range
min
β
β
 IO m
Background free
0.1 counts/ROI-t-y
1.0 count/ROI-t-y
10 counts/ROI-t-y
Ge (87% enr.)
76
Figure 1.7: 0νββ 90% sensitivity as a function of background in the region of interest (ROI)
for an enriched germanium-76 experiment. The horizontal blue band corresponds to the
mββ at the bottom of the inverted ordering region, with uncertainty based on the diﬀerence
between nuclear matrix element calculations, and assuming no quenching of gA. Figure from
Jason Detwiler.
13

ββ events and single-site γ events.
Any analysis based on comparing waveforms to a model should, in principle, extract
the maximal amount of available information about that waveform (assuming the model
is accurate and exhaustive), optimized for the physical characteristics of speciﬁc detectors.
When applied to background discrimination, this means a suﬃciently accurate model should
outperform simpler pulse shape heuristics. Furthermore, additional interesting information
can be ascertained about waveforms, including the location of energy deposition within the
detector volume.
In Chapter 2, we describe a model of signal formation in germanium detectors, and extend
it speciﬁcally for the unique circumstances of the Demonstrator detectors. Chapter 3
describes an algorithm which we have developed to optimize the parameters of the model
to match observed waveforms.
Finally, we evaluate the ability of the model to describe
waveforms using Demonstrator data in Chapter 5.
14

CHAPTER 2:
Modeling signal formation in germanium detectors
Section 2.1:
Operating Principles
2.1.1:
Semiconductor detector design
The interaction of radiation within a semiconductor material transfers energy from the
incident particle to electrons bound in the atomic valence band. When the energy absorbed
by an electron exceeds a threshold, the electron enters the conduction band and leaves
behind a vacancy in the valence band, called a hole. Each hole is deﬁned by the absence of
an electron and therefore carries positive eﬀective charge. Because the energy required to
create an electron–hole pair in a semiconductor is very small (∼3 eV) [20], a large number of
electron–hole pairs will be freed due to the interaction, creating a “cloud” of charge carriers.
Both carrier types are free to drift through the material under the inﬂuence of an electric
ﬁeld, but in opposite directions due to their opposing charge. This feature allows the device
to serve as a detector of the ionized signal.
A semiconductor detector measures the total energy deposited in an interaction by col-
lecting the charge carriers at a readout electrode. Applying an external voltage across the
detector creates an internal electric ﬁeld which sweeps the carriers to the electrode. However,
if the voltage diﬀerence also produces too large a steady-state current, it will overwhelm the
signal from charge carriers produced from radiation. We therefore require a detector design
that can hold an external voltage diﬀerence without generating a large current. In a sample
of pure semiconductor, only electrons which are excited beyond the electron–hole creation
threshold energy are mobile and able to contribute to the ﬂow of current.
If a perfect
semiconductor were suﬃciently cooled to mitigate thermal creation of electron–hole pairs, it
could function as a detector simply by applying a voltage diﬀerence across the crystal and
15

measuring current spikes.
However, in a real world semiconductor sample, some population of elemental impurities
will always occupy sites in the crystal lattice. Due to characteristics of their valence shell,
some elements are able to donate an electron to the conduction band with an energy require-
ment signiﬁcantly less than the band gap. These impurities are called electron “donors”.
Other impurities are prone to “accepting” electrons, thereby creating a hole in the conduc-
tion band. If there is a net surplus of donor over acceptor impurities, the concentration of
electrons at ﬁnite temperature naturally contains a surplus of electrons over holes, and is
considered “n-type.” If the majority impurity type is acceptor, there are a surplus of holes,
and the material is “p-type”. In either case, the contribution from impurities increases the
net number of mobile charge carriers, and thereby lowers the resistivity by several orders of
magnitude. Because of the low resistivity, if a voltage diﬀerence is applied across conducting
contacts in the simple detector design described above, a large steady-state current will ﬂow
between electrodes.
To reduce the current, we can make use of the convenient property that semiconductors
can be easily manufactured into diodes. A diode is “rectifying,” which means current ﬂows
freely when voltage is applied in the “forward” direction, but when “reverse” biased, almost
no current ﬂows. Diodes naturally form at the boundary between n and p type regions within
a semiconductor. If this junction is reverse biased, it can be operated as a detector with
very little current ﬂow.
The overabundance of holes on the p side of the junction causes net diﬀusion of holes
into the n material. Once across the junction, the hole recombines with a donor impurity,
leaving an immobile positive ion in the n material. Similarly, electrons on the n side diﬀuse
into the p, and are captured by acceptors. The net eﬀect produces a positive space charge
on the n side of the material, and an equal magnitude negative charge accumulation on the
p side. The junction will therefore exhibit a natural steady-state potential diﬀerence, called
the “contact potential.” The region over which the impurities are ionized and space charge
16

exists is “depleted” of free charge carriers, because its majority carriers have recombined
with stationary impurities.
If an external voltage is applied across the junction in a direction which reinforces the
contact potential, it will attract electrons across the junction from the p region, and holes
from the n. In both cases, these are the minority carriers, and are very low in concentration.
The material therefore exhibits very low conductivity and nearly no current will ﬂow. On
the other hand, if a voltage is applied opposite and greater than the contact potential, the
majority carriers will again cross the junction, and current will ﬂow freely. This p-n junction
therefore behaves as a rectifying element. Holding the p side of the diode at positive voltage
to the n side constitutes forward biasing, and the opposite is reverse biasing. Increasing the
reverse bias causes the depletion region to grow outward from the junction and deeper into
the material. If the reverse bias reaches a critical level, the depleted region will break down
and current will again ﬂow rapidly.
The reverse biased diode is able to function as a detector because incident radiation
can still generate new electron–hole pairs within the depleted region.
In this case, the
internal electric ﬁeld produced by applied voltage and the impurity sites in the crystal,
which have been ionized due to the external reverse bias, will force the minority carrier
towards the junction. The depleted region therefore constitutes the active volume in which
energy deposited by radiation can be collected.
A p-n junction is usually created by doping two halves of a crystal with opposite impu-
rities. If the both regions have equal impurity concentrations, the depleted zone will extend
to equal depth on each side. However, if one region has a much greater impurity concentra-
tion, its carriers will need to travel further across the junction to ﬁnd a recombination site,
thereby creating a deeper depletion layer in the lower concentration material. In a detector,
it is desirable to maximize the volume that can be depleted before reaching the breakdown
voltage. Semiconductor detectors are therefore created using a sample of material with low
net impurity concentration, and the junction is formed by doping a thin surface layer with
17

extremely high concentration [21]. This high concentration layer is referred to as either p+
or n+ type, and generally serves as one of the detector electrodes. A detector manufactured
from n-type crystal will have a thin p+ rectifying electrode, and one from a p-type crystal
will have a thin n+ electrode.
Because the detector bulk is very high purity, an appreciable number of minority carriers
will remain after depletion. To reduce steady-state leakage current from these carriers, the
readout contact is highly doped with the impurities of the same type as the bulk crystal
material. This highly doped region will have very low concentrations of the minority carrier.
This is called a “noninjecting” electrode. As a junction of two similar-typed semiconductors,
it does not rectify, and is an “ohmic” contact [22].
2.1.2:
P-type point contact detectors
The P-type point contact (PPC) germanium detector geometry was developed to main-
tain a low detector capacitance in a relatively large-volume design [23]. Detector capacitance
is coupled to the electronic noise generated on the observed signal. Therefore, a low capac-
itance detector is able to achieve low thresholds and retain high resolution at low energies.
The detectors were originally designed to increase sensitivity to the low energy nuclear recoil
from dark matter scattering, and PPC detector experiments have produced leading exclu-
sion limits for low dark matter masses [24, 25]. The possibility of measuring coherent elastic
neutrino–nucleus scattering has also been explored [26]. Stable operation has been achieved
with thresholds at or below ∼500 eV [24, 27].
The approximate geometry of a PPC detector is diagrammed in Figure 2.1, and a picture
shown in Figure 2.2. Using a small, shallow p+ “point” contact reduces the capacitance
compared to traditional “coaxial” geometries, which use a long central contact bored several
centimeters into the detector diagrammed in Figure 2.3. The p+ layer is doped via ion
implantation, often with boron, and is ∼0.3 µm thick. The n+ layer is created by drifting
lithium into the crystal lattice, and can be up to a mm thick [28]. A proprietary passivation
18

n+ electrode
p+ contact
passivation layer
Figure 2.1: Cross-sectional schematic of the PPC detector geometry.
The detectors are
cylindrically symmetric, and produced with diameters around 6-7 cm, and axial lengths
between roughly 3-5 cm. The p+ “point” contact is ∼2 mm in diameter. A positive bias of
a few kilovolts is placed on the outer n+ electrode, while the point contact is held at ground.
The passivation layer reduces the ﬂow of current along the detector surface.
treatment on the surface between the outer and point contact reduces current ﬂow across
the detector surface.
An extremely low net impurity concentration is required to create depletion layer thick-
ness on the order of centimeters with external bias of a few kilovolts. The net number density
of charge carriers in the crystal bulk cannot exceed a few times 1010 cm−3, which corresponds
to less than one part per trillion germanium atoms. This level of purity can be achieved in
germanium using sophisticated manufacturing techniques [21]. Beginning with a bar of raw
germanium, the material undergoes the zone reﬁnement process, in which one end of the
crystal is melted, then the molten zone is slowly swept to the opposite end. Because some
impurities have diﬀerent solubility in liquid than solid germanium, repeated application of
this process segregates the impurities and can improve the purity by two or three orders of
magnitude. A “boule” of crystal then is formed by Czochralski growth in a pure hydrogen
19

Figure 2.2: Picture of a PPC detector. The point contact is visible at the center of the top
surface.
atmosphere, which further increases the material purity. The boule is then manufactured
into detectors.
Impurity segregation during the Czochralski process tends to introduce a gradient in
impurity concentration along the axis of crystal growth [21]. In a PPC detector, the point
contact is always manufactured on the higher impurity side of the detector. When depleted,
the impurities in the p type material will leave stationary negative charges in the detector.
By placing the point contact on the high impurity end, these impurity sites create an axial
electric ﬁeld which sweeps holes towards the p+ contact. Since the axial ﬁelds in a PPC
detector can otherwise be quite low, the impurity gradient is important to ensure proper
collection of hole carriers [23].
20

n+ electrode
p+ contact
passivation
layer
Figure 2.3: Cross-sectional schematic of the coaxial germanium detector geometry. The p+
contact is bored several cm into the detector, which is ∼5-7 cm long.
2.1.3:
Signal Formation: The Shockley-Ramo Theorem
As soon as a cloud of electron–hole pairs is created in the depleted region of a detector,
they begin to drift under the inﬂuence of the electric ﬁeld. This creates a current which,
in turn, induces a current at the readout electrode. The generated signal therefore persists
over the entire drift time of both charge carriers. In a PPC detector, holes will drift to the
p+ point contact, and electrons towards the n+ outer contact. Because they are opposite
charges drifting in opposite directions, they will each induce a net positive signal on the
readout electrode.
The magnitude of induced charge as a function of time depends on the positon of charges
and the electrode geometry of the detector. It is possible to express this for each electrode
in terms of a quantity called the “weighting potential,” denoted ϕ0 [29, 30]. The weighting
potential is not the electric potential inside the detector, but instead the solution of the
Laplace equation with the boundary conditions ϕ0=1 for the readout electrode and ϕ0=0 for
21

−30
−20
−10
0
10
20
30
Radius (mm)
0
5
10
15
20
25
30
Height (mm)
0.0
0.2
0.4
0.6
0.8
1.0
Weighting Potential
Figure 2.4: Weighting potential for the point contact in a PPC detector. The point contact
is located at bottom center, in the “dimple.” Black lines are “isochrones,” or lines of equal
drift time for holes to reach the point contact. Each isochrone is spaced by 100 ns. The
range of isochrones in this plot is from 100-700 ns.
every other electrode. By this deﬁnition, the weighting potential will always carry a value
between zero and one. The Shockley-Ramo theorem then relates the total charge induced
on the electrode, Q, as a carrier with charge q drifts through the weighting potential as a
function of time:
Q(t) = q∆ϕ0(t)
(2.1)
Given a model for charge carrier migration, the Shockley-Ramo theorem can be used to
calculate the signal produced at the readout electrode.
A calculated weighting potential for a PPC detector is shown in Figure 2.4. The PPC
geometry characteristically produces a sharp peak in weighting potential in the millime-
ters directly surrounding the point contact. This weighting potential conﬁguration has two
important consequences for the signals produced in PPC detectors. First, since the high
weighting potential region is a small fraction of the total detector volume, the vast majority
of signals originate in an area with low initial weighting potential. For these events, holes
drifting toward the point contact traverse a ∆ϕ0 of nearly unity, while the ∆ϕ0 of electrons
22

0
200
400
600
800
0.00
0.25
0.50
0.75
1.00
Hole-Induced Charge [A.U.]
0
200
400
600
800
Time since charge creation [ns]
0.00
0.25
0.50
0.75
1.00
Total Charge [A.U]
0
20
Radial position [mm]
0
10
20
30
Axial position [mm]
Figure 2.5: Simulated waveforms from eight points in a PPC detector. Positions are marked
on the plot at right, which shows half a detector cross section. The shortest waveforms on
left correspond to the marker closest to the point contact. The top left plot shows only the
hole contribution, while the bottom shows the total contribution from both carriers.
is nearly zero.
Therefore, the hole contribution dominates the total signal produced for
most PPC waveforms. Second, given the low weighting potential in the bulk, relatively little
signal forms until the holes reach the immediate vicinity of the point contact. The result
is a waveform that sharply increases just before all the charge is collected. Both of these
attributes are visible in the simulated waveforms shown in Figure 2.5. This ﬁgure together
with the isochrones, or contours of equal drift time, in Figure 2.4, show that the drift time
can vary by hundreds of nanoseconds, but no matter the point of origin, the majority of the
signal is generated over the ﬁnal few tens of nanoseconds.
23

2.1.4:
Pulse Shape Discrimination
For neutrinoless double beta decay experiments, an important beneﬁt of characteristic
PPC waveform shape is that it enables discrimination between single and multiple point
interactions [23]. A multisite interaction occurs when incident radiation deposits energy at
more than one location in the detector, such as high energy gamma ray Compton scattering.
Since a 0νββ decay deposits its energy within ∼1 mm3, rejecting multisite events can reduce
background signals.
Due to the long drift time and short collection time of PPC waveforms, charges deposited
at diﬀerent isochrones (see Figure 2.4) will have clearly time-separated signal components.
In terms of the time dependence of the collected charge, the arrival of each new charge
cloud generates a new “step” to a higher total charge, seen in Figure 2.6. By diﬀerentiating
the collected charge and looking at current, each time–separated charge cloud appears as a
distinct peak. Methods of multisite pulse shape discrimination in 0νββ experiments include
cuts based on the energy-normalized amplitude of the current pulse [31] and χ2 comparison
of each waveform to a set of known single site pulse shapes [32].
Section 2.2:
Signal Parameterization
The Shockley-Ramo theorem provides a framework to calculate the detector response
for any arbitrary signal in the detector. Calculating the weighting potential requires under-
standing the detector geometry. Next, a model must be developed to simulate the position
of charge carriers as a function of time. Understanding the drift path, in turn, requires a
model for the electric ﬁelds in the detector and velocities of the charge carriers.
If we wish to compare simulated waveforms to data, we must account for the fact that the
frequency response of electronics in the data acquisition system also aﬀects the shape of the
observed waveform. Finally, a high precision model requires adjustments for higher-order
eﬀects such as size and shape of the charge cloud.
24

Figure 2.6: Charge (top) and current (bottom) signals formed by single and multisite in-
teractions in a PPC detector. The left plots show a single site interaction with one smooth
pulse, while the multisite waveform at right has “steps” in the charge pulse, and multiple
peaks in the current pulse. Figure from [33].
This section describes the overall model used in this work. Parameters are sorted by
three categories:
1. Detector Parameters: Aﬀect the signal created at the electrode for every waveform
simulated in a detector. Examples include detector dimension or drift mobility.
2. Waveform Parameters: Speciﬁc to each individual waveform. Includes the location of
energy deposition and charge cloud size.
25

3. Electronics Parameters: Describe the shaping of waveforms by the electronics readout
chain. Like detector parameters, these are common to all waveforms from the same
detector.
A c software package developed within the GRETINA and Majorana collaborations
[34] forms the framework of this model. The weighting potential and electric ﬁeld for a
given set of detector parameters are calculated using a program called fieldgen. Both are
calculated via numerical relaxation on a grid, set for this work to 0.1 mm, using the detector
geometry described in Section 2.2.1. We assume azimuthal detector symmetry, and so the
relaxation is performed over only the radial and axial dimensions. The weighting potential
calculation solves the 2-D Laplace equation given boundary conditions of 1 on the n+ contact
and 0 on the p+ point contact. The electric ﬁeld calculation solves the 2-D Poisson equation,
including the charge from ionized impurities using a model of impurity distribution described
in 2.2.1. The n+ contact boundary condition is set to the detector operating voltage, and
the point contact set to 0 V.
Using the output of fieldgen, siggen calculates charge trajectories for a given set of
waveform and detector parameters. Given an initial position of energy deposition, siggen
calculates a drift velocity for the local electric ﬁeld as described in Section 2.2.1. This velocity
is used to determine the position after some time step ∆t, set for this work to 1 ns. The
signal path is determined by iterating over a number of time steps until the charge reaches
an electrode. The induced signal at the point contact is calculated for each time step by
using the Shockley-Ramo theorem (Equation 2.1), where ∆ϕ0 is given by the diﬀerence in
weighting potential at the ﬁnal and initial position of the step.
It should be noted that fieldgen and siggen only attempt to model the detector bulk.
Edge eﬀects which are not modeled include reduced velocity for charges near the passivated
surface and diﬀusion of charge across the n+-p boundary. These eﬀects are only signiﬁcant
in waveforms with energy deposition ∼<1 mm from the detector surface.
As part of the work of this dissertation, the siggen code has been updated and incor-
26

porated into a Python package called pysiggen[35]. Included in pysiggen are updates to
the model for drift carrier velocities and electronics shaping. The python implementation
provides several advantages, including rapid development and ease of interface with numer-
ous external packages. By writing computationally intensive sections in c and wrapping into
Python using cython [36], these advantages can be realized without sacriﬁcing much in the
way of computation time.
2.2.1:
Detector Parameters
Dimensions
The Majorana collaboration contracted AMETEK/ORTEC [37] to produce PPC de-
tectors for the Demonstrator using enriched 76Ge material. In order to maximize total
enriched detector mass cut from each crystal boule, ORTEC allowed the exact dimensions
of each cylindrical detector to vary slightly. The typical mass is on the order of 1 kg, with
diameters ranging from 60-70 mm and lengths from 40-50 mm. The point contact, located
at bottom center of the detector, is recessed in a “dimple” with a radius and depth which
vary from detector to detector by up to a millimeter. This dimple is modeled in fieldgen
as a hemispheroidal indentation. The outer diameter of each detector has a “taper,” a 45◦
chamfer on the bottom outside edges, which is nominally 4.5 mm in height. Finally, the top
outside edges have a “bulletization” rounding radius, which is around 1.2 mm. Upon accep-
tance of the detectors, Majorana collaborators measured the detector dimensions using a
high precision optical measuring device.
The n+ contact on these detectors is created by diﬀusing lithium into the crystal. The
thickness of this layer is on the order of hundreds of microns, and can reach a millimeter.
Because the depleted volume of the detector is on the p side of the p-n+ junction, the n+
layer thickness reduces the active detector volume. In order to simulate only the active
volume, the detector dimensions are therefore reduced from the measured values by the
thickness of the n+ layer.
27

Impurities
Through the zone reﬁnement and crystal pulling process described in Section 2.1.2, OR-
TEC is able to create detectors with impurity concentrations on the order of 109 atoms per
cubic centimeter. In general, the seed end of the crystal has higher impurity levels, and
pulling the crystal introduces a gradient along the crystal length. The detector is manufac-
tured in line with the direction of pulling, such that the impurity gradient aligns with the
axial direction of the detector. The charge introduced by the impurities aﬀects the electric
ﬁeld within the detector during operation. The gradient varies greatly between crystals, but
is generally between ∼0.01 −0.2 × 1010cm−4.
The siggen model used in this work allows for a linear impurity gradient, and assumes
no radial impurity gradient. It is possible that a radial gradient is also present [38], but for
successful crystal pulls at ORTEC, it is assumed this eﬀect is negligible.
Impurities can be measured using the Hall eﬀect, but the technique has relatively high
uncertainties [21]. However, the impurity proﬁle, together with the detector dimensions,
determine the bias voltage at which the entire crystal volume depletes.
The signals of
a depleted and undepleted detector are signiﬁcantly diﬀerent, with the latter producing
distinctly “rounded”, slower pulses due to diﬀusion in the undepleted region. Performing
a careful characterization of the depletion voltage, and comparing to predicted depletion
voltage for a given impurity proﬁle, provides an independent check to the Hall measurements.
Operating Voltage
In general, germanium detectors are operated at some margin above the depletion voltage
to ensure depletion, and to increase ﬁeld strength and therefore drift velocity. Beyond the
depletion voltage, ﬁeld strength scales linearly with increased bias.
Suggested operating
voltages are supplied by ORTEC, which are applied to Demonstrator detectors with a
high precision WIINER MPOD crate [39] with an iseg EHS 8260P high voltage supply [40].
Typical bias voltages range from 1500-5000 V.
28

Drift Velocity
Accurately modeling signals in germanium detectors depends critically on understanding
carrier drift velocities. Because the charges are propagating in a crystal, carrier mobilities
are governed by the solid state physics of the system. This introduces nontrivial dependence
of the drift velocity on both the magnitude of the electric ﬁeld and the orientation of ﬁeld
with respect to the axes of crystal symmetry.
At low electric ﬁeld and high temperature, the carrier drift velocity in germanium is
Ohmic, meaning it increases linearly with electric ﬁeld. In this regime, the velocity for each
carrier is characterized by a mobility µ0, where
⃗v = µ0 ⃗E
(2.2)
The drift velocity, ⃗v, will necessarily align with the electric ﬁeld, ⃗E.
As the energy of
the carriers relative to the lattice temperature increases, scattering with the crystal lattice
causes a deviation from Ohmic behavior [41]. This scattering causes the drift velocity to
reach a point of saturation, such that the drift velocity becomes constant with increasing
ﬁeld. Carriers with energies high enough relative to the thermal energy of the crystal to
deviate from Ohmic behavior are referred to as “hot” electrons or holes. Empirically, the
high ﬁeld drift velocity follows the form [42]:
v(E) =
µ0E
(1 + (E/E0)β)1/β
(2.3)
At low ﬁelds (E ≪E0), the denominator term goes to one, and the Ohmic behavior v ∝µ0E
is recovered. At high ﬁeld (E ≫E0), the velocity approaches asymptotically to a saturation
velocity, v = µ0E0.
Here, E0 is a parameter with units of electric ﬁeld which sets the
saturation velocity. The general shape is visible in Figure 2.7. The β parameter controls the
curvature between the linear and saturated regions, and typically falls between 0.2-2. This
29

equation can describe germanium carrier mobilities at a range of temperatures [43].
In addition to scattering oﬀthe lattice, it is possible for carriers to scatter with charged
crystal impurities [44, 45]. It is therefore possible for the observed parameters of Equation 2.3
to vary between germanium detector crystals even when operated at the same temperature.
Germanium has a diamond cubic lattice, with crystallographic basis vectors in the ⟨100⟩,
⟨110⟩and ⟨111⟩directions. The band structure (Figure 2.8) varies in energy depending upon
the orientation of the wave vector ⃗k with respect to the crystal axis. At high ﬁelds, this
generates an anisotropy in the induced carrier drift velocity, where the velocity magnitude
varies depending on the orientation of the ﬁeld. In addition, the induced current at high
ﬁelds is no longer necessarily parallel to the electric ﬁeld [48] 1. The details on how this
arises are somewhat diﬀerent for electrons, which propagate in the conduction band, and
holes, which are aﬀected by the valence band structure.
The lowest minima in the germanium conduction band are four ellipsoidal “valleys.” The
long axis of each ellipsoid is aligned with an ⟨111⟩crystallographic axis [50, 51], as shown in
Figures 2.9. Electrons populating this minimum with a wave vector ⃗k parallel to the long
axis have larger eﬀective masses than those with a k value perpendicular to the axis, and
therefore have reduced conductivity and contribute less to the current.
To understand how this generates misalignment between the ﬁeld and current vector,
consider ﬁrst an electric ﬁeld applied at some arbitrary angle with respect to a single ellipsoid.
Because of the diﬀerence in mass, an electric ﬁeld which is aligned with the small-mass
ellipsoid axis will generate a larger current than one aligned in the large-mass ⟨111⟩direction.
In addition, the higher conductivity in the small-mass direction causes the current vector to
rotate somewhat toward the low-mass direction. Each of these eﬀects is present regardless
of the electric ﬁeld strength.
For a ﬁeld applied in a true germanium crystal, the net current will be a vector sum of
1This eﬀect is also observed in other semiconductors, including silicon.
30

102
103
4
6
8
10
Velocity [1E6 cm/s]
⟨100⟩holes
⟨111⟩holes
102
103
Electric Field [V/cm]
4
6
8
10
12
Velocity [1E6 cm/s]
⟨100⟩electrons
⟨111⟩electrons
Figure 2.7: Drift velocity of holes and electrons at 78 K for the ⟨100⟩and ⟨111⟩axes. Hole
values are from [46], electrons from [47]. The curves are produced using Equation 2.3 ﬁt to
experimental data, with parameters obtained by ﬁtting to experimental data.
31

Figure 2.8: Band structure in germanium. Curves indicate the energy associated with various
bands as a function of wavevector. The conduction band minimum at ⟨111⟩, labelled Eg, is
associated with the ellipsoidal surfaces shown in Figure 2.9. At the valence band maximum
enery, two degenerate bands meet, giving rise to hole populations with two distinct eﬀective
masses. The wider of the two is the so-called “heavy hole” band. Figure from [49].
Figure 2.9: Surfaces of equal energy around the minima in the germanium conduction band.
Each of the minima are ellipsoidal in shape, with long axes aligned along the ⟨111⟩axis.
Minima on parallel surfaces represent opposite ends of one complete ellipsoid, so there are
four distinct symmetry-related minima. Figure from [52].
32

the current vectors produced from each of the four minima. At low ﬁelds, cubic symmetry
necessitates that the components misaligned with the ﬁeld cancel, and the net current vector
is parallel to the ﬁeld. However, at high ﬁelds, the velocities of the electrons are high enough
that behavior is no longer Ohmic. Electrons in ellipsoids for which the ﬁeld is most aligned
with the small-mass axis become hotter, and therefore have reduced mobilities compared
to large-mass dominated valleys. This breaks the symmetry and results in a current which
no longer aligns with the electric ﬁeld [41]. The anisotropy is enhanced by “inter-valley”
electron transfer with higher local minima in the band structure [53].
The situation for holes is somewhat more complicated due to the degeneracy in the
valence band maximum, seen at ⃗k = 0 in Figure 2.8. Two bands have the same ground state
energy, but diﬀerent shape, creating a situation in which ground state holes can have two
diﬀerent masses. The wider of the two bands has a higher eﬀective mass and is labelled the
“heavy” hole band. The shape of the heavy hole band, shown in Figure 2.10, is warped–
spherical, with some dependence on crystal axis. The anisotropy produces eﬀective masses
which are largest in the ⟨111⟩direction and smallest in the ⟨100⟩. By the same argument as
electrons above, this condition causes misalignment of the current and electric ﬁeld vectors.
The light hole band is almost perfectly spherical and does not signiﬁcantly introduce
anisotropic drift. In addition, at thermal equilibrium, the heavy holes makes up 96% of the
hole population [41]. For these reasons, it is possible to model the hole transport using only
the heavy hole band without signiﬁcant loss of accuracy [54].
For ﬁelds aligned with crystallographic axes, rotational symmetry requires that the drift
velocity aligns with ﬁeld. However, the eﬀect of the band structure described above causes
decreased mobility for the ⟨111⟩compared to the ⟨100⟩direction, for both holes and electrons.
Each axis can be then independently described by Equation 2.3. Fits to experimental data
for holes and electrons along the ⟨111⟩and ⟨100⟩axes are shown in Figure 2.7.
Due to the localized weighting potential in a PPC detector, the hole contribution domi-
nates signals for signals originating from the vast majority of the detector (see Section 2.1.3).
33

Figure 2.10: Energy in the ⟨110⟩plane of the heavy hole germanium valence band, shown
with the solid line. The radial direction indicates valence band energy for the wavector at
matching the polar angle. The dashed circle is included to emphasize deviations from a
spherical structure. Figure from [54].
The hole drift velocity is therefore more important to model correctly. However, because of
the complex valence band structure discussed above, precise calculation of the velocity for
arbitrary ﬁeld direction is diﬃcult, and usually performed with computationally expensive
Monte Carlo calculations [46]. To decrease calculation time in pysiggen, we have imple-
mented an approximate model of hole velocity for ﬁelds with arbitrary crystal orientation
ﬁrst developed for gamma ray tracking experiments like AGATA [52]. Given the ﬁeld ori-
entation and velocity in the ⟨111⟩and ⟨100⟩directions, this model provides an approximate
magnitude and direction for the velocity. The approximation is able to predict the ⟨110⟩
drift velocity to high accuracy.
We therefore require as input to pysiggen six parameters to describe the hole velocities:
the three parameters µ0, E0 and β of Equation 2.3 for both the ⟨111⟩and ⟨100⟩crystal axes.
This allows the ﬂexibility to account for diﬀerences in drift velocity between detectors due
to diﬀerences, for example, in temperature or impurity concentration.
The currently implemented model of electron velocity in siggen is somewhat simpler.
34

With input of velocities in all three crystallographic directions, it performs polynomial in-
terpolation to calculate ﬁeld in a given orientation. The velocity values are taken from data
collected in [43]. More precise models exist [47, 52] and could be implemented in the future.
While it is possible this introduces percent-level error in waveform shape for events originat-
ing near the point contact, in the crystal bulk we expect accuracy to the order of parts per
ten thousand.
Charge Trapping and release
The presence of impurity sites and crystal defects introduces potential wells for charge
carriers. It is possible for some carriers to become trapped at these sites as they drift through
the detector. Charge that becomes trapped will no longer induce signal at the electrode, so
trapping attenuates the observed pulse amplitude. This eﬀect can be modeled in terms of a
mean free drift time of charge carriers before encountering trapping [55].
In the assumed model, the magnitude of drifting charge is reduced by a constant fraction
per unit time, resulting in an exponential attenuation in charge as a function of drift time:
q(t) = q0e−t/τT
(2.4)
where q(t) is the time-dependent charge contained in the carrier cloud, q0 is the charge
created in the initial interaction, and τT is the mean free drift time of trapping. We have
implemented this model in siggen by reducing the eﬀective charge of the charge cloud as a
function of time. An example of waveforms generated with varying charge trapping constants
is shown in Figure 2.11.
The mean hole trapping time will vary between detectors due to diﬀerences in trapping
site concentration between crystals. Because the magnitude of charge trapped depends on
drift time, pulses further from the point contact will experience greater charge trapping and
therefore lower amplitude than closer interactions of the same energy. The energy of each
35

0
100
200
300
400
500
600
700
800
0.0
0.2
0.4
0.6
0.8
1.0
Charge [Norm. to no trapping]
No Trapping
τT =5 µs
τT =10 µs
0
100
200
300
400
500
600
700
800
Time since charge created [ns]
0.0
0.1
Residual [A.U.]
Figure 2.11: Simulated eﬀect of charge trapping on hole compontent of PPC waveforms using
the model described in Section 2.2.1. The black waveform shows the induced charge from
hole carriers with no charge trapping. The red and blue show charge trapped waveforms
mean charge trapping constants of 5µs and 10µs. These are much shorter than the hundreds
of µs constants observed in the Demonstrator, but are chosen to more clearly display the
eﬀect. The residuals at bottom, which compare each trapped waveform to the no–trapping
case, measure the the total charge trapped as a function of time.
36

waveform is reconstructed from the amplitude of the pulse, so charge trapping results in
a degradation of energy resolution. This eﬀect has been observed in the Demonstrator
detectors with trapping constants on the order of hundreds of microseconds, corresponding
to an energy reduction on the order of parts per thousand. The collaboration has developed
a technique to correct the energy reconstruction which improves the resolution at 2614 keV
by a factor as high as two.
Charges will eventually thermally escape from trapping sites. Release of trapped charge
contributes a delayed current, resulting in a slow component of the signal. Like trapping, the
release can be modeled in terms of an exponential time constant, τR. This eﬀect is modeled
very simply in pysiggen by summing the total current trapped charge and exponentially
returning the charge to the cloud. During the drift time, the charge is added to the current
location of the charge cloud, and not released at the point it was trapped. Once the charge
cloud has reached the contact, amplitude is added to the signal exponentially until it reaches
the amplitude expected for a signal with no trapping. The model is shown in Figure 2.12
This model for charge release is an imperfect approximation. A more complete model
should re-inject charge at the point it was trapped. Doing so, however, would greatly increase
the computational complexity of a waveform simulation.
The current implementation of pysiggen includes only one set of charge trapping and
release constants which is applied to both the hole and electron signal. Physically, the two
carriers are trapping at diﬀerent types of impurities, and therefore there is no reason to expect
their trapping and release times should be identical. However, since the hole contribution
dominates the signal in a PPC detector, this approximation should not introduce signiﬁcant
error.
37

0
250
500
750
1000
1250
1500
1750
2000
0.0
0.2
0.4
0.6
0.8
1.0
Charge [Norm. to no trapping]
No trapping
τ=10 µs
τT =10 µs, τR=1 µs
0
250
500
750
1000
1250
1500
1750
2000
Time since charge created [ns]
0.00
0.05
Residual [A.U.]
Figure 2.12: Eﬀect of charge release from trapping sites as modeled in pysiggen.
The
addition of charge release causes the red waveform to return exponentially in amplitude
from its trapped value, in blue, to the no-trapping value, in black.
38

2.2.2:
Waveform Parameters
Interaction Position
Given a weighting potential, electric ﬁeld, and drift velocity model, the generated signal
for interactions for any a given position can be calculated. Both the drift path and total
drift time of the charge cloud are obviously sensitive to the radial and axial position. To
ﬁrst order, the shape of the waveform is dominated by the hole drift time, and therefore the
isochrone of origin. However, Figure 2.13 shows that there are percent-level diﬀerences in
waveforms even along an isochrone.
0
100
200
300
400
500
0.00
0.25
0.50
0.75
1.00
Hole-Induced Charge [A.U.]
0
100
200
300
400
500
Time since charge creation [ns]
−0.02
0.00
0.02
Total Charge [A.U]
0
10
20
30
Radial position [mm]
0
5
10
15
20
25
30
Axial position [mm]
Figure 2.13: A comparison of shape between simulated waveforms with the same drift time
(400 ns). Each event originates at azimuthal position φ = 0, which corresponds to the ⟨100⟩
crystal axis. The position of each event, shown at right, corresponds with the waveform color
at left. Residuals are drawn compared to a waveform from the position at right marked in
black. Diﬀerences between the waveforms are at the part per hundred level, which originate
because of diﬀerences in weighting potential and electric ﬁeld along the drift path.
As described in Section 2.2.1, the velocity of charge carriers in high electric ﬁelds are
anisotropic with respect to crystal axis. The crystal growth process ensures that the detector
is oriented axially along the ⟨001⟩axis. The crystal structure of germanium is diamond cubic,
so the plane perpendicular to the axial will contain a axis and, separated by π/4 radians, a
39

0
100
200
300
400
500
0.0
0.2
0.4
0.6
0.8
1.0
Hole-Induced Charge [A.U.]
φ=0 rad
φ=π/8 rad
φ=π/4 rad
0
100
200
300
400
500
Time since charge created [ns]
0.00
0.25
Residual [A.U.]
Figure 2.14: Comparison between waveforms simulated at the same radial and axial position
(r = 20, z = 20), but varying the azimuthal position. The crystal axis anisotropy in drift
velocity at high electric ﬁeld is responsible for the change in drift time. The fastest velocities
occur along the ⟨100⟩axis, corresponding to φ = 0, while the ⟨110⟩axis corresponds with
φ = π/4. Residuals are shown relative to the φ = 0 waveform.
⟨110⟩axis. The waveform is therefore sensitive to the azimuthal position of the event, but
with an eight-fold degeneracy. An example of waveforms from the same position generated
at diﬀerent azimuthal positions is shown in Figure 2.14. The fractional diﬀerence in risetime,
and therefore the residual diﬀerence, between waveforms from the ⟨100⟩and ⟨110⟩axis will
vary as a function of position (Figure 2.15). In general, maximum residual diﬀerences are
on the order of parts per hundred.
The position of the waveform is therefore modeled in three dimensional cylindrical co-
ordinates. The parameters r and z, which express the radial and axial position, can vary
anywhere within the detector volume. The azimuthal φ position is modeled only from [0, π/4],
corresponding to the crystal axis symmetry.
40

0
5
10
15
20
25
30
Radius (mm)
0
5
10
15
20
25
30
Height (mm)
0.00
0.02
0.04
0.06
0.08
0.10
0.12
0.14
Fractional Drift Time Diﬀerence
Figure 2.15: Fractional diﬀerence in rise time calculated between events which occur at the
⟨100⟩and ⟨110⟩axes as a function of position. The drift velocity is lower along the ⟨110⟩.
The rise time diﬀerence increases with increasing radius due to the integrated eﬀect of the
lower drift velocity. The diﬀerence is highest at lower axial position because here the the
calculated cloud drifts purely along the ⟨100⟩or ⟨110⟩axis to the point contact, whereas
for higher positions both clouds must also drift along the ⟨001⟩axis (aligned with the axial
direction), which reduces the percent of the drift time the two clouds experience diﬀerent
drift velocities.
41

Energy
Assuming that all the charge generated in an event is collected, the signal amplitude
depends linearly on energy. In pysiggen, the simulated signal is adjusted for energy before
the charge trapping correction is applied. When incorporating the shaping of the electronics
(see Section 2.2.3), all ﬁlters applied are corrected to preserve unity gain of the signal. By
this procedure, the energy parameter remains a true measurement of energy, independent of
any other parameter’s eﬀect on amplitude.
Charge cloud size & shape
The size and shape of the ionization charge cloud created in the crystal varies depending
on the type of particle interacting and the total energy deposited. After creation, the cloud
size can further grow due to diﬀusion and self-repulsion. We assume this cloud is created
spherical gaussian in nature, reﬂecting a point-like energy deposition2. As charges accelerate
and decelerate, the cloud stretches in space, but remains roughly gaussian in time. Since
the majority of signal is generated very near the point contact, we make the further approx-
imation that the cloud size correction can be performed with a single gaussian convolution
in the time domain. The gaussian sigma is parameterized in time, which corresponds to the
spatial width via the ﬁnal velocity of the charge.
This approximation was made to reduce computational complexity, but does not fully
encapsulate the shape of the signal. To quantify the degree of error introduced, the true signal
produced by spherical gaussian signal was created using Monte Carlo. A million random
points were generated around the interaction point, with each of the r, φ and z components
and normally distributed with σ = 0.5 mm. A waveform was simulated for each of these
points, and averaged to create a ﬁnal signal. This was compared to the simpliﬁed gaussian
convolution, choosing the gaussian sigma which minimized the least square diﬀerence from
2For radiation with longer interaction track lengths, such as MeV-scale electrons, the charge will be elongated
from a simple spherical gaussian cloud. This eﬀect is not currently modeled.
42

the Monte Carlo waveform. Figure 2.16 shows the result of this study. For realistic charge
cloud sizes at any point in the detector, the calculated diﬀerence between the full Monte
Carlo model and the simpliﬁed gaussian convolution is on the order of parts per thousand.
0
100
200
300
400
500
600
0.0
0.2
0.4
0.6
0.8
1.0
Hole signal [A.U.]
no smoothing
Monte Carlo
Gaussian Filter
0
100
200
300
400
500
600
Time since charge created [ns]
0.000
0.001
Residual [A.U]
Figure 2.16: Measure of the error introduced by approximating the charge cloud shape as
a gaussian convolution in the time domain of a single-point waveform. The red waveform
shows the approximated waveform, while the blue waveform is the average of a set of many
waveforms drawn from a spherical gaussian distribution around the same point. The residual
below shows the diﬀerence between the Monte Carlo and Gaussian Filter waveforms.
In addition to the charge cloud size, pysiggen includes an optional parameter to modify
the shape of the gaussian cloud. The spherical gaussian charge cloud assumes a point-like
energy deposition.
For events in which the energy despotion has some ﬁnite width, the
charge cloud distribution should initially be more like a uniform sphere. However, diﬀusion
as the cloud travels still spreads the charge in a gaussian manner. To combine the eﬀects,
pysiggen utilized a “generalized Gaussian” distribution, which introduces a parameter p to
43

the cloud shape distribution such that the convolution weighting distribution w(t) becomes
w(t) ∝exp
 
−1
2

t
σ

2p!
,
(2.5)
where σ still controls the width, and p controls the shape. The usual gaussian distribution
is recovered for p = 1 and, in the limit p →∞, w(t) becomes a uniform distribution over
(−σ, σ). See Figure 2.17 for examples of this distribution.
−60
−40
−20
0
20
40
60
0.0
0.2
0.4
0.6
0.8
1.0
p = 1.0
p = 1.2
p = 2.0
p = 5.0
Figure 2.17: Generalized gaussian charge cloud shape described in Section 2.2.2. The distri-
bution of Equation 2.5 is drawn with σ = 20 for four diﬀerent values of p.
2.2.3:
Electronics Parameters
The Majorana collaboration designed an optimized detector electronics readout and
ampliﬁcation system in an eﬀort to minimize noise while achieving low radioactive back-
grounds, which is shown schematically in Figure 2.18. The readout is performed with a
resistive feedback circuit, containing an input ﬁeld eﬀect transistor (FET) and amorphous
44

Figure 2.18: Schematic of the Demonstrator signal readout chain. The low mass front end
(LMFE) board is located within the cryostat, very near to the detector point contact, as seen
in Figure 1.4. The LMFE contains a resistive feedback element (RC element at top), ﬁeld
eﬀect transistor with drain and source lines, and capacitively coupled pulser input (bottom).
The four lines are bundles into one cable, which runs ∼2 m to additional ampliﬁcation
elements outside the shield. Figure from [33].
germanium resistor, called the “low mass front end” (LMFE) board [19]. The LMFE is lo-
cated within a few millimeters of the detector, reducing stray input capacitance and therefore
series noise. However, given this positioning, the LMFE hardware must be must be minimal
and constructed only with very radiopure materials, while the rest of the preampliﬁer sys-
tem is located outside of the cryostat. Approximately 2 m of 0.4 mm diameter cable runs
between the LMFE and ﬁrst stage of the preampliﬁer, thereby creating a feedback loop 4
m long. A second stage preampliﬁer, also outside the cryostat, is capacitively coupled to a
second stage of ampliﬁcation. The signal is then digitized with 14 bit precision at 100 MHz
with GRETINA digitizer boards [56], which were originally developed for the GRETINA
experiment.
Given the extremely long feedback loop, and because the FET response depends sen-
sitively on temperature, it is diﬃcult to accurately model the response of the electronics
readout with a circuit simulator. A capacitively-coupled pulser line runs to the input of the
45

FET, but the pulser input is also shaped by 2 meters of cable running into the cryostat.
Without a direct measurement of the transfer function, we have developed an empirical
parameterization.
The LMFE and inductance from the cable attenuate high frequency components of the
signal, and can be modeled as a low-pass ﬁlter.
A transfer function of order n can be
generically modeled as a digital ﬁlter in the z domain
H(z) = cnzn + cn−1zn−1 + . . . + c0
dnzn + dn−1zn−1 + . . . + d0
(2.6)
To determine which order was appropriate for the Demonstrator electronics, we at-
tempted to ﬁt waveforms with a generic ﬁlter of ﬁrst, second, and third order. Qualitatively,
the second order ﬁlter was found to match the shape of the observed waveforms signiﬁcantly
better than a ﬁrst order ﬁlter. The third order ﬁlter showed no dramatic improvement over
the second order. For this reason, we chose to use a second order transfer function.
The ﬁt to the second order preferred values of c0 near to zero, giving us a total digital
ﬁlter function with four free parameters
Hlow(z) =
az2 + bz
z2 + 2cz + d2.
(2.7)
In the time domain, this corresponds to a convolution with a decaying oscillatory kernel,
H(t) ∝e−t cos(ωt + φ),
(2.8)
with the correspondence between the time and z domain is given by:
ω = cos−1 c
d

and
φ = tan−1

ac −b
a
√
d2 −c2

(2.9)
46

0
200
400
600
800
1000
Time since charge created [ns]
0.0
0.2
0.4
0.6
0.8
1.0
Voltage [A.U.]
No electronics shaping
With electronics shaping
Figure 2.19: Simulated eﬀect of the electronics chain on waveform shape. Note that the
risetime is increased by ∼100 ns.
The steady-state, or DC, gain for the ﬁlter is given by
lim
z→1
az2 + bz
z2 + 2cz + d2 =
a + b
1 + 2c + d2
(2.10)
and therefore increasing the value of a+b only linearly scales the amplitude without otherwise
aﬀecting the shape.
Capacitative couplings, most notably between the ﬁrst and second preamp stages, cause
the waveform to exponentially decay. Empirically, we observe two strong coupling constants
with diﬀerent strength. We model this with three additional parameters describing a linear
combination of two exponential decay functions:
Hhi(z) = c
z −1
z −exp(−T
τ1) + (1 −c)
z −1
z −exp(−T
τ2).
(2.11)
Here, τ1 is set by the RC constant of the coupling between the ﬁrst and second stage ampli-
ﬁers, usually around 72 µs, and τ2 is a ∼2µs coupling we believe is intrinsic to the digitizer.
The constant c expresses the fractional mixing between the decay constants.
The total transfer function originating from the electronics is the product of Hlow and
47

103
104
105
106
107
108
Frequency (rad/s)
−40
−30
−20
−10
0
Amplitude (dB)
Low-Pass
Hi-Pass
Figure 2.20: Bode diagram of preamp gain using the model described in Section 2.2.3. The
total gain (on this logarithmic plot) is the sum of the two curves.
Hhi. The shaping introduced by the electronics chain using this model, based on parameters
observed in the Demonstrator, is shown in Figure 2.19. The length of cable in the feedback
loop is responsible for the dramatic increase in rise time [33]. A Bode diagram showing the
frequency response is shown in Figure 2.20.
The process of digitizing can also change the shape of the recorded waveform. There is
some inherent nonlinearity in the relationship between analog amplitude and digitally con-
verted amplitude due to limitations of the analog-to-digital converters on board the digitizer.
For the Demonstrator, this nonlinearity of the GRETINA digitizer has been studied and
shown to introduce no more than ≤1 ADC unit error for any given sample. Because this
is less than the noise amplitude, which is several ADC units, we ignore nonlinearity in our
model.
Section 2.3:
Conclusion
Germanium detectors are reverse-biased semiconductor diodes which measure the holes
and electrons produced by ionizing radiation. Internal electric ﬁelds drift the carrier charges
48

to a readout electrode, where they are read by a data acquisition system. A model, based
fundamentally on the Shockley-Ramo theorem, has been developed to calculate the signal
induced at the electrode during charge collection. This model is parameterized to account for
diﬀerences between PPC detectors. As an extension speciﬁc to the data acquisition system
of the Majorana Demonstrator, an empirical representation of an electronics transfer
function has been added.
Accurately simulating the waveforms from any speciﬁc detector with this model requires
the input of over a dozen parameters. Some are well-understood, but others are measured
poorly or not at all. Chapter 3 will focus on a technique to optimally estimate these param-
eters.
49

CHAPTER 3:
Machine learning of germanium detector parameters
The parameters outlined in the previous chapter suﬃciently encompass the physics of
waveform generation to enable high precision modeling of PPC detector signals. However,
successfully modeling any speciﬁc detector requires precise tuning of over a dozen parame-
ters, many of which are either unknown or highly uncertain. In the absence of independent
measurements, it is possible to gain understanding of parameters by studying observed wave-
forms.
The shape of each waveform carries information about each of the detector parameters.
In principle, if the model described above is suﬃciently accurate, this information can be
extracted by ﬁtting the free model parameters to the waveform. This approach is limited,
however, due to the presence of noise, the high dimensionality and high degree of correlation
in the ﬁt. When such a ﬁt is performed on a single waveform, it tends to “overﬁt,” or select
parameters which ﬁt the current waveform well but can’t be used to ﬁt additional waveforms.
To address this issue, we have developed an algorithm which pools the information from
many waveforms in order to maximize the extracted knowledge about the parameters. Be-
cause it can infer information from a large and unspecialized data set, we label this a machine
learning algorithm. Speciﬁcally, we use the framework of Bayesian modeling [57], which al-
lows us to separately model each waveform’s individual parameters while sharing common
parameters related to the detector and electronics. The hierarchical model is trained to the
data using Markov chain Monte Carlo (MCMC) [58].
This chapter contains a detailed description of the model formulation, the MCMC sam-
pling and the training procedure.
50

Section 3.1:
Bayesian modeling
A Bayesian model attempts to infer the probability of the value of a set of parameters,
θ, given a data set x. We can write this as p(θ|x), which represents the probability density
for θ conditional on the observation of x. The foundation of any Bayesian method is Bayes’
law [57]:
p(θ|x) = p(θ)p(x|θ)
p(x)
,
(3.1)
which expresses p(θ|x) (known as the posterior distribution) in terms of p(θ) (the prior dis-
tribution), and p(x|θ) (the likelihood function). The prior is a distribution which represents
the knowledge of θ before the measurement. The likelihood represents the probability of
measuring x if the parameter set θ is true, and is computed using a model. The denomina-
tor, p(x), is a constant normalization factor obtained by integrating over all possible values
of θ. Since it is a constant, p(x) is only necessary to compare posteriors between models.
3.1.1:
Markov chain Monte Carlo
Markov chain Monte Carlo (MCMC) is a method for numerically estimating a distribution
by sampling from it via a random walk [57]. Given a starting point, θ0, the MCMC algorithm
steps randomly through a sequence of values for the parameter θ1, θ2, . . . such that the
sampling density of the parameter values converges to a “target” distribution. When used
for Bayesian analysis, the posterior is chosen as the target distribution.
The algorithm is based on a “Markov chain,” meaning that the value selected for the
n th sample, θn, depends only on the previous step in the sequence, θn−1. The steps along
the Markov chain are governed by a “transition distribution” T(θn|θn−1), which describes
the probability distribution of selecting θn given the value of the previous step in the chain.
The random walk, or Monte Carlo, aspect of the algorithm is that the value chosen for the
given step is probabilistic according to the transition distribution. The crux of designing
of an MCMC algorithm is choosing a transition distribution such that it samples from the
51

target distribution and converges quickly enough to be computationally achievable.
A simple and commonly used sampling method for MCMC is the Metropolis-Hastings
algorithm [59].
In Metropolis-Hastings, a “proposal” value θ′ is chosen from a proposal
distribution q(θ′|θn−1). The proposal is then accepted with a probability, α, proportional to
the ratio of the target distribution at the current and proposed distribution. Assuming the
target distribution is the posterior p(θ|x), the acceptance probability is
α = min

1,
p(θ′|x)/q(θ′|θn−1)
p(θn−1|x)/q(θn−1|θ′)

(3.2)
If the proposal is accepted, then θn = θ′. Otherwise, the value remains the same, θn = θn−1.
3.1.2:
Diﬀusive nested sampling
The Metropolis-Hastings algorithm is prone to failure for strongly multimodal target
distributions, because it is diﬃcult to deﬁne a proposal distribution which can suitably
sample from well-separated maxima in the target distribution. Similarly, multidimensional
models with highly correlated variables are diﬃcult to properly sample since the proposal
must correctly adjust multiple parameters simultaneously to correctly explore the target
distribution. These issues were observed when a Metropolis-Hastings sampler was applied
to the model of Chapter 2. The estimation of position, especially, appears to be strongly
multimodal.
Diﬀusive nested sampling [60] is an algorithm which extends upon Metropolis-Hastings in
a way which can more robustly sample diﬃcult distributions. It is an extension of “classic”
nested sampling [61], which constrains sampling to progressively constrained regions of the
prior space, called levels. The ﬁrst level is simply the full prior space. After a set number
of iterations, which can be sampled by with Metropolis-Hastings MCMC, a new level is
created which encompasses e−1 percent of the likelihoods. As the algorithm runs, new levels
are successively created, each compressed (in terms of enclosed probability) by a factor of
52

e−1. Given a likelihood threshold l for a level, and a likelihood function L(θ), the target
distribution for the MCMC algorithm is
p(θ; l) = p(θ)1[L(θ) > l]
X(l)
(3.3)
where
X(l) =
Z
p(θ)1[L(θ) > l]dθ
(3.4)
and 1 is a function that is unity when the conditional argument is true and 0 otherwise.
X(l) is a measure of the cumulative probability above the threshold value for a given level,
and so should for level N should be e−N as a result of the level creation scheme. Figure 3.1
shows the progressive compression of the prior space. By only sampling the progressively
higher regions of likelihood space, nested sampling is able to accurately converge around the
highest region of the posterior distribution.
Diﬀusive nested sampling extends the classic nested sampling algorithm by sampling
instead from a mixture of levels, weighted toward the highest likelihood levels. This allows
the algorithm to “backtrack” and explore diﬀerent regions of the prior space. This capacity
improves the ability to sample highly correlated and multimodal target distributions, also
shown in Figure 3.1.
The sampling is now over all levels, so the sampling distribution
becomes
p(θ) =
X
j
wjp(θ)1[L(θ) > lj]
X(lj)
(3.5)
where lj is the likelihood threshold for level j, and wj is the weight assigned to that level,
which are exponentially weighted toward the highest likelihood levels with some “backtrack-
ing length” scale λ:
wi ∼exp(j/λ).
(3.6)
As the diﬀusive nested sampler runs, MCMC steps from the target distribution (Equa-
tion 3.5) are saved. An approximate value of X for each sample based on its likelihood
53

and the likelihood of the adjacent levels. Given the sample likelihood, this can be used to
compute the weight of a set of parameters in terms of the posterior distribution.
To improve the ability to map a diﬃcult posterior, it is possible to evolve simultaneously
multiple “particles,” each of which independently estimates the parameters of the model.
Each particle evolves along a Markov Chain independently from a starting position chosen
randomly from the prior. This is especially useful for complicated posterior spaces, which
might be strongly multimodal. If the likelihood for the parameters of given particle falls
too far behind the rest of the particle population, it can be eliminated and replaced with a
duplicate of a higher likelihood particle, thereby ensuring no particles become “stuck” in a
relatively low likelihood local maximum.
We use a software implementation of diﬀusive nested sampling named DNest4 [62]. The
individual particles used in diﬀusive nested sampling can be run in parallel, with their results
pooled at regular intervals. In DNest4, the parallelization is implemented via shared memory
on a single machine. In order to improve the number of particles that can be run simultane-
ously, we have extended the DNest4 code to run in parallel on scientiﬁc computing clusters
with the Message Passing Interface (MPI) standard using the OpenMPI implementation [63].
When parallelized to utilize a core for each particle used in the DNS algorithm, the corre-
sponding reduction in computation time scales with the number of particles, O(nparticles).
In addition, the likelihood function can be parallelized by computing each waveform’s
pysiggen model in parallel. We can maximize eﬃciency by parallelizing both the diﬀusive
nested sampling algorithm and evaluation of the likelihood function. For evaluation of the
likelihood of a single particle, pysiggen must be run once for each waveform in the training
set. By parallelizing the call to pysiggen, we are able to improve computation time an
additional factor of nwaveforms. By combining this with the parallelization of particles, utilizing
∼nparticles · nwaveforms cores, we are able to improve the computation time by O(nparticles ·
nwaveforms).
54

Figure 3.1: Illustration of the nested sampling algorithms. As the algorithm proceeds in step
number, new levels are created, shown as progressively darker shades of blue. In diﬀusive
nested sampling, the algorithm has some probability to “backtrack” and sample from lower
likelihood regions. Figure from [60].
Section 3.2:
Learning model implementation
The goal of the machine learning model is to use a set of training waveforms to make
an accurate prediction of the detector and electronics parameters. The set of waveforms is
chosen from calibration data of the highest available energy (2614 keV 208Tl photopeak) to
maximize the signal to noise ratio, and drawn with a variety of rise-times to sample events
from across the detector volume. The model is constructed such that the set of parameters
which describe the detector or electronics, φ, are shared among all waveforms. An individual
set of parameters θi is assigned to each waveform to describe attributes which are unique to
that event, such as position, and compared to the observed data for that waveform, xi. The
total unnormalized posterior for a set of n waveforms is then constructed as a sum of each
individual posterior:
p(θ, φ|x) ∝
n
X
i=0
p(xi|θi, φ)p(θi)p(φ).
(3.7)
55

3.2.1:
Likelihood function
We wish to compare simulated waveforms from pysiggen with observed waveforms, which
have been measured as part of the Demonstrator experiment. The digitizer boards records
2038 samples in 10 ns increments, so in principle, the dataset x can consist of as many as
2038 elements. In reality, most of this 20 µs window is either ﬂat “baseline” preceding the
signal, or simple RC decay as the preampliﬁer returns to baseline (see Figure 3.2).
We
therefore window the signal around the ∼µs–long rising edge where the signal is of most
interest.
Under the assumption that pysiggen produces a deterministic and correctly–modeled
waveform, the likelihood of measuring a given value xj for an individual digitized sample is a
function of the diﬀerence between xj and the pysiggen prediction yj and the noise present on
the waveform. We model the noise on each waveform as Gaussian and white. While there is
some frequency structure in the Demonstrator noise, the waveforms under consideration
are high enough in signal to noise ratio that any eﬀect should be very minor. The noise
present on the baseline, and its distribution, is shown in Figure 3.3. The noise standard
deviation, σ is measured from the digitized baseline prior to the waveform and used to ﬁnd
a value. The likelihood for each individual sample j, then, follows a normal distribution.
Using the standard notation N(µ, σ2) for a normal distribution with mean µ and variance
σ2, we have
p(xj|θ, φ) ∼N(xj −yj, σ2),
(3.8)
and the total likelihood is the sum of the likelihood for each sample within the data window,
such that for waveform i with m samples,
p(xi|θi, φ) ∼
m
X
j=0
N(xj −yj, σ2).
(3.9)
56

0
500
1000
1500
2000
Digitizer Sample Number [10s of ns]
0
1000
2000
3000
4000
5000
6000
Voltage [adc value]
980
1000
1020
1040
1060
Digitizer Sample Number [10s of ns]
0
1000
2000
3000
4000
5000
6000
Figure 3.2: A digitized Demonstrator waveform at 2614 keV, shown in full at left, and
windowed around the rising edge at right. Each sample is plotted as a horizontal step to
emphasize the digitization. Note that the baseline value is 100 ADC counts above zero.
There is noise present on the waveforms, but because it is at the level of ∼5 ADC counts,
it is not visible in these plots.
0
100
200
300
400
500
600
700
800
Digitizer Sample Number [10s of ns]
−4
−2
0
2
4
Voltage [adc value]
−5
0
5
Voltage [adc value]
0.00
0.05
0.10
0.15
0.20
Normalized density
Figure 3.3: Noise characteristics of Demonstrator waveforms. The plot at left shows the
noise present on ﬂat baseline from the ﬁrst 800 samples of the waveform in Figure 3.2. The
mean baseline value has been subtracted such that the mean value is zero. The plot at right
is a histogram of the subtracted baseline value for 32 waveforms, normalized such that the
sum of all bins is unity.
57

3.2.2:
Waveform parameterization and priors
The pysiggen parameters speciﬁc to each waveform, as discussed in Section 2.2.2, are
position, energy, and charge cloud shape. However, for the purposes of the learning model,
we use training waveforms from a monoenergetic photopeak, which allows us to model them
with a common energy parameter1. This eases a strong correlation in shape that improves
convergence of the charge trapping parameter, and will be described in greater detail in
Section 3.2.3.
In order to compare the pysiggen waveform with digitized data, an additional parameter
is required to align the waveform in time with the digitized signal. The parameterization
and prior for the time alignment, as well position and charge shape, are discussed below.
Position
Although it would be natural to model the position in cylindrical coordinates, it is impor-
tant to recognize that the hole drift time is a principal driver of the overall waveform shape.
From the isochrones seen in Figure 2.4, it is apparent that there is a strong anticorrelation in
drift time between the radial and axial directions. To reduce the impact of this correlation,
we perform the ﬁt using polar coordinates, with the origin located at the point contact.
At present, it is assumed that there is no a priori knowledge of a waveform’s position, so
the prior for each of the three positions is uniform over the appropriate range of values. For
the radial and polar coordinates, this is anywhere within the detector active volume. The
crystal axis dependence on drift velocity, discussed in Section 2.2.2, is periodic with a unique
angular span of π/4 radians. We therefore set the azimuthal coordinate prior as uniform
in the [0, π/4] quadrant, and recognize that any estimation of this parameter is eight-fold
degenerate with respect to the true azimuthal position in the detector.
1Within a photopeak, there is a spread in energy caused by the statistical variance of the creation of charge
carriers, which is a Poisson process. The training waveforms are taken from a narrow energy band around
the photopeak maximum to account for this.
58

Charge cloud
The model uses the generalized gaussian model of Equation 2.5. During ﬁtting, we have
seen that waveforms at 2614 keV tend to cluster around σ = 20 ns and p = 2. We therefore
set each prior with a wide normal distribution around these values: a standard deviation of
20 ns for σ and 10 for p. The sigma prior is limited by the range (1,40) ns, where the lower
bound is chosen to prevent σ of less than one sample. The p parameter range bounds are
(1,20), which corresponds to a gaussian distribution, and 20 is a value high enough to be
indistinguishable from a uniform distribution.
Time alignment
The Demonstrator digitizer continuously digitizes the signal on each input channel at
100 MHz, storing the values in a temporary buﬀer. When the signal exceeds a threshold over
the ﬂat baseline value, deﬁned by the output of an on-board trapezoidal ﬁlter, it triggers
the digitizer to save the event to disk. To avoid triggering on noise, it is necessary to set
the trigger threshold several standard deviations above the noise amplitude. A waveform
with a short drift time will therefore cross the trigger threshold closer in time to its true
start time than a longer drifting waveform, as shown in Figure 3.4. There is some additional
uncertainty on the exact trigger point due to noise and the inherent 10 ns width of the
digitization sample.
To enable high precision time alignment, it is therefore necessary to add a parameter
which aligns the pysiggen waveform with the digitized waveform. Aligning by the start point
of the waveform would be most convenient. However, because drift time is highly correlated
with position, this would tightly correlate the alignment time and position parameters. It
advantageous to instead choose an alignment time point at a high fraction of the waveform
rising edge, where all waveforms have relatively similar shapes.
In addition to reducing
correlation with other parameters, it is easier to make a robust prediction of a time point on
the rising edge than the start time, especially for long drift-time waveforms which have very
59

900
950
1000
1050
1100
Digitizer Sample Number [10s of ns]
0
1000
2000
3000
4000
5000
6000
Voltage [adc value]
950
960
970
980
990
1000
Digitizer Sample Number [10s of ns]
0
20
40
60
80
100
120
140
Figure 3.4: Four digitized Demonstrator waveforms from the 2614 keV Tl208 photopeak.
The plot at left shows the two microseconds of the signal roughly centered around the rising
edge. The same waveforms are shown at right, more tightly windowed around the trigger
point. The baseline value is subtracted from each waveform. The point at sample ∼985
where the waveforms roughly intersect is where the digitizer is triggered. The waveform with
the shortest drift time, in blue, has less elapsed time between signal start and the trigger
point than the longer drifting waveforms.
60

little signal amplitude at their start.
Because the pysiggen waveform is calculated in discrete time steps, aligning at an arbi-
trary, continuous-valued time point requires interpolation. The siggen calculation produces
an output in 1 ns time steps. To compare with digitized data, pysiggen downsamples to 10
ns increments and performs a piecewise-linear interpolation between the calculated points.
We have chosen to align based on the 95% rise-time of the waveform amplitude as the
alignment point, deﬁned as the point where the waveform reaches 95% of its maximum value.
The prior is normally distributed around an estimated value from the parameter, which is
calculated simply as the sample number where the waveform exceeds 95% of its maximum
value. The prior has a standard deviation of one sample (10 ns).
3.2.3:
Detector and electronics parameterization and priors
The parameters which are shared between all waveforms in the training set aﬀect char-
acteristics of either the detector or the electronics shaping.
Electronics transfer function
The electronics shaping, as described in Section 2.2.3, is divided into a high-pass and
low-pass contribution:
Hhi(z) = c
z −1
z −exp(−T
τ1) + (1 −c)
z −1
z −exp(−T
τ2),
Hlow(z) =
az2 + bz
z2 + 2cz + d2.
(3.10)
The high-pass ﬁlter, characterized by three parameters, describes the decay of the signal
to baseline after energy is collected. Because these parameters aﬀect the signal shape after
the rising edge, they are largely uncorrelated with the parameters which describe the signal
formation process. It is therefore possible to perform a simple maximum likelihood ﬁt on
the decaying tail of individual waveforms to gain an understanding of these parameters. The
ﬁt is performed on the tail only, which we deﬁne as starting 20 samples (200 ns) after the
61

1000
1200
1400
1600
1800
2000
Digitizer Sample Number [10s of ns]
5400
5600
5800
6000
6200
6400
6600
Voltage [adc value]
Figure 3.5: Decaying tail of the waveform shown in Figure 3.2. The vertical dashed red line
is 20 samples past the waveform maximum. The ﬁt to the tail shown in Figure 3.6 uses the
samples after this point.
waveform maximum, and extending to the end of the digitization window (see Figure 3.5).
The results of this ﬁt over many waveforms, shown for one detector in Figure 3.6, is used to
set a normal prior distribution for each parameter.
The parameters associated with the low-pass ﬁlter aﬀect the rising edge and therefore
can’t be ﬁt separately in the same way as those for the high-pass ﬁlter. The transfer function
is applied in pysiggen as a digital ﬁlter in the z domain in the form of Equation 2.7, which
has four free parameters. However, since the DC gain of the ﬁlter does not eﬀect the shape,
and the signal amplitude is ﬁt as an energy parameter, we can reduce this expression to a
unity gain ﬁlter with three parameters:
Hlow(z) = 1 + 2c + d2
1 + b
·
z2 + bz
z2 + 2cz + d2
(3.11)
62

70.0
70.2
70.4
70.6
70.8
71.0
71.2
71.4
τ1 [µs]
0
50
100
150
Number
1.2
1.4
1.6
1.8
2.0
2.2
τ2 [µs]
0
50
100
150
Number
0.9918
0.9920
0.9922
0.9924
0.9926
0.9928
0.9930
0.9932
0.9934
c [unitless]
0
50
100
150
200
Number
Figure 3.6: Results of a three-parameter maximum likelihood ﬁt to high pass ﬁlter shaping
(Equation 2.11) with the decaying tail of 1208 waveforms. All waveforms are from the 2614
keV photopeak and are from the same Demonstrator detector (P42661A). The mean and
variance for each parameter are used to set priors for the full machine learning ﬁt.
63

We have found the MCMC converges fastest when ﬁtting the time-domain representation
of the oscillation parameters, ω = cos−1(c/d) and φ = tan−1 
c−b
√
d2−c2

. A beneﬁt of this
parameterization is that, since the convolution kernel goes as cos(ωt + φ), each is naturally
cyclical with 2π and can therefore be bounded and given a uniform prior.
There is freedom in how to parameterize the third free parameter. We have found that the
shape is quite sensitive to the combination g =
1
1+2c+d2, which is the contribution to the gain
from the denominator. The numerator parameters can be scaled without changing the gain,
but because of the z2 term in the denominator, c and d cannot be scaled without changing
the shape. The combination g then represents sort of an intrinsic gain when a + b = 1. The
choice is somewhat arbitrary, but appears to converge fairly well. There is no natural bound
to this parameter, so a very wide gaussian distribution is used around a reasonable value.
The eﬀect of each of the three parameters is shown in Figure 3.7.
Drift velocity
Recalling Section 2.2.1, we must ﬁt the three parameters of Equation 2.3 for both the
⟨100⟩and ⟨111⟩crystal axes. Again, the equation, together with its physical limits, is:
v(E) =
µ0E
(1 + (E/E0)β)1/β ,
lim
E→0 v(E) = µ0E,
lim
E→∞v(E) = µ0E0
(3.12)
We therefore have two independent handles on velocity at very low and very high ﬁeld,
and the parameter β controls how “sharply” they connect. In the middle ﬁeld region, the
three parameters combine nonlinearly in a way that would be diﬃcult to ﬁt without the
input of the high and low ﬁeld behavior. Figure 3.8 shows that, for holes in germanium,
the linear low ﬁeld behavior falls oﬀat ∼10V, and the saturation velocity is reached ∼>
10,000V.
Figures 3.9 and 3.10 show the electric ﬁeld inside a Demonstrator enriched germanium
detector. The span of electric ﬁeld values are well within the range of moderate ﬁeld where
64

0
200
400
600
800
1000
0.0
0.2
0.4
0.6
0.8
1.0
Voltage [A.U.]
ω = [6, 16] × 10−3
0
200
400
600
800
1000
0.0
0.2
0.4
0.6
0.8
1.0
Voltage [A.U.]
φ = [−π
2 , 0]
0
200
400
600
800
1000
Time since charge created [ns]
0.0
0.2
0.4
0.6
0.8
1.0
Voltage [A.U.]
g = [500, 5000]
Figure 3.7: Eﬀect of the three low-pass electronics transfer function parameters on the
waveform shape. From top to bottom, the ω, φ and g parameters are plotted holding the
other two constant. Each parameter has a grey band, showing the eﬀect of varying the value
over the range shown in the label. The dashed red line, which is the same in each plot, shows
the curve for a waveform with values trained by Demonstrator data. The range for each
parameter is chosen such that the waveform stays near in shape to the red curve.
65

100
101
102
103
104
105
Electric Field [V/cm]
10−1
100
101
Velocity [1E6 cm/s]
β = 0.5
β = 0.6
β = 0.8
β = 0.9
β = 1.0
Figure 3.8: Drift velocity curves using the Equation 2.3 parameterization, varying the value
of β. The black dashed lines show the linear v ∼µ0E behavior at low ﬁeld and constant
v ∼µ0E0 velocity at high ﬁeld. The values E0 = 181 and µ0 = 66333 are from ⟨100⟩direction
observed by [46].
−30
−20
−10
0
10
20
30
Radial position [mm]
0
5
10
15
20
25
30
Axial position [mm]
102
103
Electric Field [V/cm]
Figure 3.9: Electric ﬁeld in a representative Demonstrator enriched detector.
66

0
200
400
600
800
1000
1200
1400
Electric Field [V/cm]
0
1000
2000
3000
4000
5000
6000
7000
Number
Figure 3.10: A one dimensional histogram of the electric ﬁeld values in Figure 3.9. Fields in
the detector mainly fall between 200-1200 V/cm.
the velocity parameters are more correlated and therefore more diﬃcult to ﬁt. We therefore
wish to reparameterize the equation in terms of parameters which are more directly inﬂuenced
by the electric ﬁelds present in our detectors. Speciﬁcally, it would be helpful to express the
curve in terms of velocities at the bottom and top end of the observed range of ﬁelds.
If we begin with the velocity at two ﬁelds EA and EB,
vA =
µ0EA
(1 + (EA/E0)β)1/β ,
vB =
µ0EB
(1 + (EB/E0)β)1/β ,
(3.13)
we can express µ0 and E0 in terms of vA, EA, vB and EB,
E0 =
 
ψβEβ
B −Eβ
A
1 −ψβ
!1/β
,
where
ψ = EAvB
EBvA
(3.14)
and
µ0 = vA
EA
 
1 +
EA
E0
β!1/β
.
(3.15)
The three parameters vA, vB and β are used to perform the ﬁt.
Figure 3.11 shows the
reparameterization using EA = 250V and EB = 1000V. The velocity is well described in the
67

101
102
103
104
Electric Field [V/cm]
100
101
Velocity [1E6 cm/s]
β = 0.5
β = 0.6
β = 0.8
β = 0.9
β = 1.0
Figure 3.11: Velocity curves using the parameterization of Equation 3.14.
The velocity
reference points used in this plot are EA = 250V and EB = 1000V, using the same ⟨100⟩
direction velocity parameters from [46] as Figure 3.8.
range of ﬁelds observed in the detector by the parameters vA and vB, but the β parameter
no longer has much leverage over the curve shape in this region. We have seen signiﬁcant
improvement in overall convergence using (vA, vB, β) model, so the this is implemented in
the machine learning ﬁt.
The priors for vA and vB are normally distributed, with means set using the values given
by [46] and 20% standard deviation. Measured values of β can vary greatly, and our ﬁt value
of β does not tend to converge reliably in any case. For this reason, we conservatively set a
uniform prior on β from 0 to 1.
Point contact dimensions
Because the weighting potential in a PPC detector is very strongly weighted near the point
contact, the generated signal depends very sensitively on the dimensions of the point contact.
68

The point contact dimple is modeled as a hemispheroidal indentation.
Precision optical
measurements of its diameter and depth are available for some, but not all, Demonstrator
detectors. A separate measurement was made at ORTEC during manufacturing but with
uncertain accuracy. For detectors measured at both ORTEC and with the Demonstrator
optical device, values can vary by as much as a few tenths of a millimeter.
For this reason, we allow the radius and depth of the point contact dimple to ﬂoat in the
model. For detectors with optical device measurements, the measured values used to set a
gaussian prior with 0.1mm standard deviation. Detectors without the optical measurement
are given a ﬂat prior in a range of 0.5mm around the ORTEC provided value.
Because point contact parameters aﬀect the electric ﬁeld and weighting potential, chang-
ing them requires calculating ﬁelds with fieldgen, which is an expensive process. To im-
prove the speed of the machine learning process, we precompute the ﬁelds for a grid of point
contact values. The ﬁeld for arbitrary point contact dimensions is then calculated via bi-
linear interpolation between the precalculated values. To facilitate interpolation, the range
of allowed point contact values must be bound between the minimum and maximum values
precomputed for each parameter. We use a 0.5mm window calculated in 0.1mm increments
around the measured value.
Impurity proﬁle
As discussed in Section 2.2.1, there is considerable uncertainty in the measurement of
impurity. Since the impurity is measured at each end of the detector, the impurity gradient
is even less certain.
Like the point contact dimensions above, the impurity values aﬀect the ﬁeld values and
therefore must be precomputed. The range for precalculation is chosen to encompass a range
of reasonable values based roughly on 50% range around the measured values, but taking
into account the range over which the detector fully depletes. The prior is simply set as ﬂat
over this range.
69

Charge trapping, charge releasing and energy
Charge trapping, as described in Section 2.2.1 , reduces the amount of charge in the
carrier cloud as a function of time. When trapping eﬀects are nonnegligable, the amplitude
of waveforms with the same interaction energy will depend on the drift time of the charge
cloud, with longer drifting waveforms more strongly attenuated. This eﬀect is clearly visible
in Demonstrator data, as shown in Figure 3.12.
To ﬁrst order, the diﬀerence in waveform shape due to charge trapping is simply the
reduction in amplitude. When each waveform in a training set is given an individual energy
parameter, the ﬁt therefore has a strong local maximum to simply reduce the amplitude with
the energy parameter and choose a very long mean charge trapping time constant. To avoid
this, we select a training set with all waveforms from the same energy peak, and share a
common energy parameter. This forces the ﬁt to use charge trapping, and not an individual
energy value, to match the observed amplitude.
The energy prior is normally distributed around the maximum the training set waveform
with the shortest observed drift time, with a 10 ADC standard deviation.
There is little prior knowledge of the charge trapping constant. The reduction in ampli-
tude in Figure 3.12 can be reproduced with charge trapping on the order of a few hundred µs.
However, since charge can subsequently be released from the traps, the observed reduction
is actually a combination of both the trapping and untrapping rates.
To be cautious, we use a uniform prior over a wide range of possible charge trapping and
untrapping values. The trapping constant is allowed to vary between 10µs and 1000µs, while
the untrapping constant varies from 1µs to 1000µs. We have observed good convergence in
the trapping parameters with this approach.
Summary of free parameters
In total, there are 19 parameters shared between all waveforms, and 6 parameters which
describe each individual waveform. Table 3.1 summarizes the parameters.
70

0
50
100
150
Digitizer Sample Number [10s of ns]
0
1000
2000
3000
4000
5000
6000
Voltage [adc value]
25
50
75
100
125
150
Digitizer Sample Number [10s of ns]
6390
6400
6410
6420
6430
6440
6450
6460
6470
6480
Figure 3.12: Sixty waveforms from the 2614 keV photopeak for a Demonstrator detector.
Each color is a separate waveform. The plot at right shows the full waveforms, which are
time aligned by their estimated start time. The plot at right is windowed to emphasize the
amplitude of the waveform. Longer drift time waveforms have lower amplitudes, which is
caused by charge trapping.
Type:
Detector
Waveform
Electronics
Point contact length
Interaction position (x3)
Hi-pass (x3)
Point contact depth
Alignment time
Low-pass (x3)
Average impurity concentration
Charge cloud (x2)
Impurity gradient
Charge trapping constant
Charge release constant
Training set energy
⟨100⟩: β, µ0, E0
⟨111⟩: β, µ0, E0
Total:
13
6
6
Table 3.1: Summary of the free parameters in the model.
71

3.2.4:
Sampling strategy
The proposal distribution for each parameter is set according to the prior. Following
the recommendation of [62], we use a “heavy tailed” proposal distribution rather than tune
proposal step sizes to improve sampling. The distribution is a student-t distribution multi-
plied by the width of the prior distribution. For normally distributed parameters, this is the
distribution standard deviation, and for uniformly distributed parameters, it is the width of
the allowed region.
For any given step in the chain, we update one or more parameters from either the
global parameter set (φ) or an individual waveform’s parameter set (θi). By updating more
than one parameter simultaneously, we can better sample correlated parameters. However,
parameters from diﬀerent waveform sets should not be correlated, so it is desirable to update
only one set of parameters at a time. To satisfy both of these conditions, we block update
either detector or waveform parameters, each with 50% probability. If updating waveforms,
we update one or more waveforms simultaneously, with the number drawn randomly from
an exponential t-tailed distribution. This step chooses which parameter sets to update.
Once the parameter sets are chosen, we must update the parameters within the set.
Following the example of [62] for heavily sampling from correlated distributions, we draw
a random number n from 100N(0,1). Then, for n iterations, we randomly update one of the
parameters in the set.
Section 3.3:
Choosing a training set
The machine learning algorithm trains the parameters of the model described above by
ﬁtting a set of training waveforms. In order for the model to be accurate, it is necessary that
the training waveforms arise from representative, single site interactions within the detector
bulk. Additionally, it is advantageous that the waveforms have as high a signal to noise ratio
as possible.
72

Figure 3.13: The Demonstrator calibration system. A line source is inserted via the clear
plastic tubing track through the shield, at left. The track source wraps helically around the
copper cryostat.
Training waveforms are selected from Demonstrator calibration data. The calibration
is performed by inserting a 228Th line source into the shield, which wraps around the module
cryostat (see Figure 3.13) [64].
The spectrum from a 228Th calibration is shown in Figure 3.14.
The highest energy
feature in the spectrum is the 2614 keV photopeak from the decay of 208Tl, a daughter
nuclide in the 228Th chain. To maximize the signal to noise ratio of our training waveforms,
we choose waveforms from this peak. However, a large number of interactions in this peak
originate either from the incoming gamma either Compton scattering or pair producing
in the detector. In both cases, for the full energy of the interaction to be recorded, it is
necessary that the event be multisite in nature. We can apply a cut based on the current
pulse amplitude to energy ratio (A/E) to eliminate the majority of the multisite events.
As described in Section 2.1.4, a single site waveform has only one current peak, while
a multisite waveform has multiple. Since the energy of a current waveform scales with its
integral, at a given energy a multi-peaked current waveform will be wider than a single-
peaked waveform, and therefore have a lower maximum value. By removing events with
73

Energy (keV)
1000 1200 1400 1600 1800 2000 2200 2400 2600 2800
Counts
1
10
2
10
3
10
4
10
Figure 3.14: Calibration spectrum using a 228Th source in the Demonstrator. The highest
energy peak in the spectrum is the 2614 keV peak, a photopeak from the decay of 208Tl, a
228Th daughter nuclide. The next two highest intensity features are the 208Tl double and
single escape peaks at 1592 keV and 2103 keV, respectively. The remaining peaks are from
various 228Th chain decays.
74

400
600
800
1000
1200
1400
1600
1800
2000
Time [ns]
0
50
100
150
200
250
300
Current value [arb.]
Passing waveforms
Cut waveforms
Figure 3.15: Current waveforms for 100 events from the 2614 keV 228Tl photopeak. Each
charge waveform is simultaneously diﬀerentiated and smoothed via convolution with a win-
dow which is the ﬁrst derivative of a gaussian, with a 50 ns standard deviation. Waveforms
in red fail the A/E cut due to the low amplitude of the current pulse. Many of the failing
events have multiple current peaks, clearly marking them as multisite events.
75

Energy (keV)
2604 2606 2608 2610 2612 2614 2616 2618 2620 2622 2624
Counts
1
10
2
10
3
10
All events
Events after A/E cut
Figure 3.16: Eﬀect of an A/E cut on the amplitude of the 2614 keV 228Tl photopeak. The
cut reduces the peak for this calibration run from 26,108 to 2,185 events, or by 92%.
low current peak amplitude, shown in Figure 3.15, the A/E discriminates against multisite
events. The value for the A/E cut is chosen to accept 90% of the 208Tl double escape peak,
which is dominated by single site events. Figure 3.16 shows reduction in the amplitude to 8%
of the 2614 keV peak after the A/E cut. Examining the waveforms remaining after the cut
in Figure 3.17, the variance in shape before ∼800 ns is due to varying drift times. However,
the outlier waveforms near the maximum at ∼1000 ns show there remain clearly multisite
events in the set. A multisite event could create this shape if a relatively high energy charge
cloud arrives at the point contact before a second lower-energy cloud. Evidently, the A/E
cut is ineﬃcient at removing this type of multisite event.
Figure 3.18 shows the current waveforms for the events which survive the A/E cut. In
current space, it is easier to understand the failure mode of the A/E cut: waveforms which
have a high energy cloud with a short drift time and a low energy cloud with a longer drift
time create current peaks which are nearly mirrors of single site events with long drift times.
76

0
200
400
600
800
1000
1200
1400
0
1000
2000
3000
4000
5000
6000
Voltage [adc value, no baseline subtraction]
Before A/E cut
0
200
400
600
800
1000
1200
1400
Time [ns]
0
1000
2000
3000
4000
5000
6000
Voltage [adc value, no baseline subtraction]
After A/E cut
Figure 3.17: On top, 500 waveforms from the 2614 keV photopeak before an A/E cut is
applied. At bottom, 500 waveforms that survive the A/E cut. Each waveform drawn is
translucent, such that darker bands are more densely populated regions. Waveforms are
aligned at their 50% risetime time point.
77

400
600
800
1000
1200
1400
1600
1800
2000
Time [ns]
0
50
100
150
200
250
300
350
Current value [arb.]
Passing waveforms
Cut waveforms
Figure 3.18: Current waveforms for events which survive the A/E cut. Each charge waveform
is simultaneously diﬀerentiated and smoothed via convolution with a window which is the
ﬁrst derivative of a gaussian, with a 50 ns standard deviation. Waveforms in red are multisite,
and tagged based on the extended tail at on the falling edge of the current peak.
To eliminate these events, we introduce a cut based on the fall-time from the current peak
to the baseline. Since our goal is only a representative training set, the eﬃciency of this cut
has not been studied in detail.
An additional cut is made based on the mean baseline value. For a given detector, the
baseline value for all events should be the same. However, the electronics take several tens
of µs to settle back to baseline after an event is measured. If a second event occurs before
the baseline is fully recovered, the observed baseline in the ﬁrst few microseconds of the
digitization window will deviate from the equilibrium window. The shape of the waveform
will be distorted as the electronics continue to settle, so these waveforms must be rejected
78

from the training set2. Figure 3.19 shows the waveforms this cut removes.
Finally, we wish to ensure that all waveforms in the training set originate from interactions
in the “bulk” of the detector. If the interaction occurs in the small volume around the point
contact where the initial weighting potential of the interaction is relatively high, the electron
contribution to the waveform will be signiﬁcant. Several approximations made in the model
described in Section 2.2 assume that the hole contribution dominates, so these waveforms
should be excluded from the training set.
Since events closer to the point contact have
shorter drift times, these events can be simply removed by a drift time cut. Figure 3.20
shows the distribution of rise times once all other cuts have been applied. Conservatively,
we exclude events with drift times less than 500 ns.
Once all cuts have been applied, we must choose a subset of the remaining waveforms to
use in the training set. As a proxy for sampling events originating from positions throughout
the detector, we aim to select waveforms uniformly distributed in drift time. To this end,
we group the remaining waveforms by drift time into a bins, choosing a number of bins
corresponding to the size of the desired training set. One waveform is then chosen randomly
from each bin to create a training set.
While this procedure is largely able to discriminate against multisite waveforms, it is still
possible for “slightly” multisite waveforms to pass through the cut. We have been able to
identify such events based on their failure to converge during the machine learning ﬁt. In
these cases, the event is manually excluded and replaced with a waveform of similar drift
time. Without a pure source of single site events, having to iterate on training set to exclude
multisite events is probably unavoidable.
Similarly, because the energy parameter is shared between all waveforms in the set, it is
imperative that all waveforms truly have the same energy. However, there is some natural
statistical ﬂuctuation in the number of electron-hole pairs produced by an interaction. The
2This situation is much more common during calibration, when the count rate is quite high, than during
0νββ data collection.
79

75
80
85
90
95
100
105
Baseline mean [adc value]
0
50
100
150
Nuumber
200
400
600
800
1000
1200
1400
1600
Time [ns]
0
1000
2000
3000
4000
5000
6000
Voltage [adc value]
Passing waveforms
Cut waveforms
Figure 3.19: Cut based on baseline value. The top plot shows a histogram of the mean
baseline value for the ﬁrst 800 samples of 2614 keV waveforms remaining after the multisite
event cuts. Only waveforms with baselines between the red dashed lines, drawn 3 ADC
counts from the mode, are accepted. The bottom plot shows the waveforms accepted and
rejected by this cut, in black and red respectively.
Of 1,842 waveforms, 1,583 (85%) of
waveforms pass this cut.
80

400
500
600
700
800
900
1000
Estimated 99.5% risetime [ns]
0
10
20
30
40
50
60
Number
Figure 3.20: Distribution of estimated drift time for waveforms which pass the multisite
discrimination and baseline cuts.
81

ﬁt is sensitive to this ﬂuctuation, and higher or lower than average energy waveforms will
not have the correct amplitude. Again, these waveforms are excluded from the training set
manually.
Each waveform in the set is windowed around the rising edge. Because the model before
the waveform start is only a ﬂat baseline, adding window before the start of the waveform
adds no information. It is only necessary to ensure the window begins early enough to cap-
ture the beginning of each pulse. The tail contains information about the transfer function
decay parameters, and it is useful to keep enough tail in the window to ensure those param-
eters converge. However, increasing the length in turn increases the required computation
time. We have found that a 250 sample window, centered around the 99.5% risetime, works
acceptably.
It is possible that the procedure of cuts described above accidentally eliminates some
single site events which should be retained in the training set. Given the current accuracy
of the model, we believe the set of training waveforms originate a suﬃciently diverse set
of locations to provide the algorithm with information from isochrones across the detector.
However, should the accuracy improve in the future, more careful consideration should be
made to ensure that the training waveforms do not discriminate against any speciﬁc regions
of origin.
Section 3.4:
Conclusions
By constructing a Bayesian model that combines multiple waveforms with shared detector
parameters, it is possible to learn about the detector and electronics model parameters by
solving for the posterior distribution.
Because the model is both high dimensional and
strongly correlated, MCMC with diﬀusive nested sampling is a good choice of algorithm
for estimating the posterior. Still, we are able to improve the convergence properties of
the algorithm by choosing a parameterization of the model which attempts to minimize
correlations, and choosing a varied set of single site training waveforms.
82

CHAPTER 4:
Results & Applications
Section 4.1:
Machine learning results
The learning algorithm described above was implemented by integrating pysiggen into
the framework of DNest4. We then used diﬀusive nested sampling to estimate the parameters
for an enriched germanium detector from the Demonstrator, which is identiﬁed by the
serial number P42661A. This detector is the third from the top on a string opposite the
crossarm opening, which is given the Demonstrator designation P5D3. The training set
selected for detector P42661A is shown in Figure 4.1, chosen at sixteen waveforms to keep
computation time to convergence reasonable. The event identiﬁcation number corresponding
to each waveform is listed in Table 4.1.
The diﬀusive nested sampling algorithm was run with 20 particles, which was the maxi-
mum number which could be run in parallel on the UNC killdevil computing cluster. A new
level was created each time 10,000 samples exceeded the likelihood of the current threshold,
with each level compressed by e−1 relative to the previous. Every 1,000 samples, one par-
ticle at random was saved to disk as a way to store the MCMC target distribution. Each
particle was run for 680,000 iterations, when the Markov Chain was empirically found to be
converged.
Sampling the posterior with high enough density to fully map the distribution would
require roughly an order of magnitude more iterations, which was not computationally fea-
sible. Instead, we can simply take the highest likelihood sample in the MCMC as the best
ﬁt.
The best ﬁt to the training waveforms is shown in Figure 4.2. The residual shows that
the model is accurate nearly to the level of the noise amplitude. There is, however, some
83

0
50
100
150
200
250
0
1000
2000
3000
4000
5000
6000
Voltage [adc value]
20
30
40
50
60
70
80
90
Sample number [10s of ns]
0
20
40
60
80
100
120
Voltage [adc value]
Figure 4.1: Training set used for machine learning ﬁt for detector P42661A. There are sixteen
waveforms in the set. The top plot shows the full 250-sample window used in the ﬁt, centered
around the estimated 95% rise time. The bottom plot shows the diﬀerences in the shape at
the start of each waveform.
84

Number
Color
Rise Time [ns]
Run number
Entry number
1
red
528
11515
128965
2
blue
565
11511
96633
3
green
584
11510
317207
4
purple
621
11511
48362
5
orange
646
11510
56040
6
cyan
682
11511
202862
7
magenta
684
11515
62152
8
goldenrod
705
11512
71698
9
brown
724
11511
95195
10
deeppink
770
11514
208461
11
lightsteelblue
824
11511
13079
12
maroon
839
11516
92744
13
violet
904
11515
225892
14
lawngreen
915
11513
1225
15
grey
939
11513
6869
16
chocolate
969
11542
8401
Table 4.1: Training set of sixteen waveforms for detector P42661A. The color is used for
all plots of these waveforms within this work. Rise time is estimated from the start time
to the 99.5% rise time.
Run number and entry number are unique identiﬁers from the
Demonstrator dataset. Each waveform is taken from the high gain ampliﬁcation channel.
structure evident in the residual. The structure indicates either that the model does not
fully capture the physics of the signal, or that the ﬁt was not able to properly converge on
the global maximum.
To help determine the quality of convergence, we performed a set on a second set of
sixteen training waveforms. The residual structure for the second set is very similar to the
ﬁrst training set, as seen in Figure 4.3.
4.1.1:
Fit parameters
The parameters for ﬁts from both training sets are compiled in Table 4.2.
The drift velocity curves over the range of ﬁelds relevant to the detector for training set
one are plotted in Figure 4.4, compared to the measured value from [46] which formed the
basis of the prior. The magnitude of the anisotropy between the ⟨100⟩and ⟨111⟩axes is
85

0
500
1000
1500
2000
2500
0
1000
2000
3000
4000
5000
6000
7000
Voltage [Arb.]
0
500
1000
1500
2000
2500
Digitizer Time [ns]
−5
0
5
Residual
Figure 4.2: Best ﬁt of the training waveforms to the model. At top, all waveforms are shown,
with the best ﬁt overlaid. The residual, on bottom, shows that the ﬁt is accurate nearly
to the level of noise. However, some structure remains, which is more clearly visible when
averaged, as in Figure 4.3.
roughly the same as expected from previous measurements, but the overall drift velocity is
lower by ∼10%. The curves are similar for training set two. The disagreement between the
measured and ﬁt values of the β parameters are not surprising, since the reparameterization
in Section 3.2.3 leaves β with little inﬂuence over the velocity over the ﬁelds of interest.
The impurity and point contact dimensions estimated for the detector are shown in
86

0
50
100
150
200
250
Sample number [10s of ns]
4
2
0
2
4
6
Average residual [adc]
0
50
100
150
200
250
Sample number [10s of ns]
4
2
0
2
4
Average residual [adc]
Figure 4.3: The residual between the training waveform and ﬁt, averaged over the sixteen
waveforms in the training set. The top and bottom plots use two diﬀerent sets of sixteen
waveforms as training samples. If the model were perfectly accurate, the average residual
would be ﬂat at zero, shown by the dashed black line.
The structure after sample 100
suggests the model, though accurate at approximately the part per thousand level, could be
further improved.
87

103
2 × 102
3 × 102
4 × 102
6 × 102
Electric ﬁeld [V/cm]
4
6
8
10
12
Velocity [1E6 cm/s]
ﬁt ⟨100⟩
ﬁt ⟨111⟩
prior ⟨100⟩
prior ⟨100⟩
Figure 4.4: Drift velocity curves for the ⟨100⟩and ⟨111⟩axes. The values in red are from
the ﬁt to detector P42661A. The values in black are from the measurement by [46].
Table 4.2. Optical measurements of the point contact for this detector were not available,
so we compare to the values measured at ORTEC. The measured depletion voltage for this
detector is 1200 V. With the parameters taken from the ﬁt, the calculated depletion voltage
is 1400 ± 25 V. The diﬀerence is likely due to an incorrectly estimated impurity proﬁle.
4.1.2:
Fit to second detector
To ensure the process is applicable across diﬀerent crystals, the same training process
was applied a second Demonstrator detector. Detector P42574A hails from a diﬀerent
crystal boule than P42661A, and was pulled at an earlier date. It is located as the third
detector from the top in a string located crosswise to the crossarm, designated P6D3. The
training waveforms are shown in Figure 4.5, with more details in Table 4.3. The residual
structure for the ﬁt to sixteen P42574A waveforms is shown in Figure 4.6. The model is
88

Velocity parameters
Parameter
Fit Value (Set 1)
Fit Value (Set 2)
Measured Value
⟨100⟩: v250
4.89 × 106 cm/s
5.05 × 106 cm/s
5.50 × 106 cm/s
⟨100⟩: v1000
7.26 × 106 cm/s
7.16 × 106 cm/s
8.61 × 106 cm/s
⟨100⟩: β
0.1
0.41
0.744
⟨111⟩: v250
4.40 × 106 cm/s
4.41 × 106 cm/s
4.83 × 106 cm/s
⟨111⟩: v1000
6.31 × 106 cm/s
6.48 × 106 cm/s
7.17 × 106 cm/s
⟨111⟩: β
0.9
0.47
0.580
Electronics parameters
Parameter
Fit Value (Set 1)
Fit Value (Set 2)
φ
-1.44 mm
-1.52 mm
ω
0.01124 mm
0.01123
gain
1554.7
1521.9
τ1
73.4 µs
71.0µs
τ2
1.4 µs
1.1µs
c
0.90
0.99
Detector parameters
Parameter
Fit Value (Set 1)
Fit Value (Set 2)
Measured Value
PC Radius
1.54 mm
1.6 mm
1.5 mm
PC Length
1.21 mm
1.64 mm
1.7 mm
Avg. Impurity Conc.
0.55 ×1010 cm−3
0.44 ×1010 cm−3
0.59 ×1010 cm−3
Impurity Gradient
0.014 ×1010 cm−4
0.071 ×1010 cm−4
0.016 ×1010 cm−4
τtrap
294.3 µs
267.3 µs
τrelease
5.1 µs
2.8 µs
Waveform Amplitude
6432.4 ADC
6444.2 ADC
Table 4.2: Fit values for the hole drift velocities for both training sets for P42661A. Mea-
sured values for velocity are from [46] and for detector parameters are from manufacturer
measurements. There are no reported uncertainties associated with any of the measured
values.
89

once again able to ﬁt to residuals at the ∼6 ADC level, and the structure in the residual
looks very similar to that for detector P42661A.
Number
Color
Rise Time [ns]
Run number
Entry number
1
red
424
11514
113363
2
blue
448
11514
99694
3
green
483
11510
307803
4
purple
513
11511
134776
5
orange
578
11510
16756
6
cyan
604
11514
96625
7
magenta
657
11512
29496
8
goldenrod
675
11511
33826
9
brown
709
11510
308551
10
deeppink
758
11510
257709
11
lightsteelblue
778
11512
112523
12
maroon
838
11511
7198
13
violet
878
11517
28223
14
lawngreen
891
11510
200387
15
grey
946
11516
169409
16
chocolate
955
11588
90466
Table 4.3: Training set of sixteen waveforms for detector P2574A. The color corresponds
to the waveforms in Figure 4.5. Rise time is estimated from the start time to the 99.5%
rise time. Run number and entry number are unique identiﬁers from the Demonstrator
dataset. Each waveform is taken from the high gain ampliﬁcation channel.
Section 4.2:
Validation
To validate the parameters selected by the machine learning ﬁt, we can apply the model
to estimate the position of a large population of single site events. Events from calibration
data should be distributed roughly evenly throughout the detector volume. If the model
cannot accurately reconstruct waveforms from any given volume of the detector, it should
be apparent by examining the reconstructed position distribution. We can also evaluate the
ability of the model to discern between populations of single and multisite events, comparing
its accuracy to the A/E algorithm.
It would be computationally intractable to run the full model described in Chapter 3 for
90

0
50
100
150
200
250
0
1000
2000
3000
4000
5000
6000
Voltage [adc value]
20
30
40
50
60
70
80
90
100
Sample number [10s of ns]
0
20
40
60
80
100
120
Voltage [adc value]
Figure 4.5: Training set of sixteen waveforms used for machine learning ﬁt for detector
P2574A. The top plot shows the full 250-sample window used in the ﬁt, centered around the
estimated 95% rise time. The bottom plot shows the diﬀerences in the shape at the start of
each waveform.
91

0
50
100
150
200
250
Sample number [10s of ns]
6
4
2
0
2
4
6
Average residual [adc]
Figure 4.6: The residual between the training waveform and ﬁt, averaged over the sixteen
waveforms in the training set, for detector P42574A.
92

several thousand waveforms. Instead, we have developed a subset of the model which uses
DNest4 to ﬁt only the parameters individual to each waveform. The shared detector and
electronics parameters are ﬁxed to the values computed in the full machine learning ﬁt. This
gives us a much simpler ﬁt which can be performed on each waveform individually.
For a source of single and multi site events, we can use the Tl208 escape peaks. The
escape peaks are features in an energy spectrum created from pair production events from a
photopeak at higher energy. When the created positron annihilates, it creates a pair of 511
keV gammas inside the detector. One or both of these gammas can go on to “escape” the
detector volume, thereby reducing the total measured energy of the event by 511 keV or 1022
keV, respectively creating a “single escape” peak (SEP) and “double escape” peak (DEP)
at energies 511 keV and 1022 keV below the photopeak. In the case of double escape peak
events, since both 511 keV gammas escaped, there is a high probability that the interaction
was conﬁned to the single site of the pair production. For the single escape peak, one of the
511 keV gammas must have interacted in the detector, very likely at a distance separated
from the original interaction location. The single escape peak is therefore largely composed
of multisite events. For the 208Tl photopeak, the double and single escape peaks are at 1592
keV and 2103 keV, respectively. They are visible in the spectrum in Figure 3.14.
We used the detector and electronics parameters from the ﬁt to P42661A to ﬁt 11,466
calibration events, 6,378 of which are from the SEP and 5,088 from the DEP. The ﬁt likeli-
hood distribution for each event in shown in Figure 4.7, which shows that the DEP events
are reconstructed with higher likelihood values than single escape peak events.
The A/E cut value is deﬁned such that it retains 90% of events in the DEP. We can
attempt to create a similar cut using a ﬁt likelihood threshold, since our model should ﬁt
single site events better than multisite. The results of a cut which retains 90% of DEP events
in shown in Figure 4.8.
The waveforms for all events in the DEP are shown in Figure 4.9. Many of the failing
events are characterized by an extremely long time for the waveform to rise from ∼90% of
93

200
250
300
350
400
Negative Log Likelihood
0.000
0.005
0.010
0.015
0.020
0.025
0.030
0.035
Number density
All Events
DEP
SEP
Figure 4.7: The plot shows the negative log likelihood (NLL) for ﬁts to waveforms from
the 208Tl single and double escape peaks. Because it is negative likelihood, a lower value
corresponds to a better ﬁt. The distribution for the DEP and SEP are each normalized to
the total number of events in that peak. Multisite waveforms should have higher NLL values
than single site events.The SEP distribution is signiﬁcantly lower in amplitude because many
multisite events from the distribution have extremely high NLL values and are therefore
beyond the scale of this plot.
94

1582.5 1585.0 1587.5 1590.0 1592.5 1595.0 1597.5 1600.0 1602.5
Energy [keV]
0
100
200
300
400
500
600
700
800
Number
All events
A/E cut
Fit cut
2092.5 2095.0 2097.5 2100.0 2102.5 2105.0 2107.5 2110.0 2112.5
Energy [keV]
0
100
200
300
400
500
600
Number
All events
A/E cut
Fit cut
Figure 4.8: Comparison of A/E cut and likelihood ﬁt cuts on the 208Tl double (at top) and
single (at bottom) escape peaks. Both cuts are deﬁned to retain 90% of events in the DEP.
Using an extremely simple cut, we are able to discriminate against multisite events in the
SEP nearly as eﬃciently as the A/E cut.
95

Figure 4.9: Waveforms and estimated residuals for DEP waveforms in detector P42661A. Red
waveforms fail the likelihood cut, while black waveforms pass. Many of the cut waveforms
show a very long time between the time points corresponding to ∼90% to ∼99% of the
maximum amplitude, suggesting that these events may have a percentage of their holes
slowed by diﬀusion in the n+ layer.
96

the amplitude to the maximum. It is likely that these events deposited energy very near
to the n+-p boundary at the outside of the detector. Holes in low ﬁeld regions around this
boundary can diﬀuse slowly into the depleted region of the detector, creating a delayed signal
component. Since this diﬀusion dominated region is not part of the current model, it is no
surprise that they should ﬁt poorly.
The estimated radial and azimuthal position of DEP events is shown in Figure 4.10.
Given the clustering of poorly ﬁtting events at low r and z, whose waveforms have the fast
rise time corresponding to isochrones near the point contact, it is clear that events near
the point contact are not ﬁtting with high precision. Waveforms in this region will have
non-negligable electron contributions to the waveform. Given the approximations made in
the model that the hole contribution dominates, it is no surprise that point contact events
should ﬁt poorly. The residual for waveforms which do pass the cut have approximately the
same structure as seen in the training waveforms.
The estimated positions can be compared to Figure 4.11, which shows the Geant4
simulated position of double escape events in the detector. There is some preference for the
events to occur at the edges of the detector, where there is less material for annihilation
gammas to penetrate before escaping. However, it is clear that the simulated events do not
cluster strongly in any speciﬁc location of the detector.
In the MCMC estimated positions, there is a strong cluster in the corner of the detector
opposite the point contact. There is an additional cluster at ∼(r = 500 mm2, z = 20 mm).
Each are likely caused by some inaccuracy in the model. In addition, there is an area just
above the taper at high r and low z which contains nearly no reconstructed events. We
model this taper as a perfectly sharp angle, which is somewhat unphysical, and probably
causes distortion in the modeled ﬁelds in the region, seen in Figure 3.9. In reality, there is
some curvature radius on the taper edge which should be incorporated into the model.
The estimated azimuthal position is shown in Figure 4.12. The model appears to cluster
waveforms near φ = 0, π/8 and π/4. This likely points to some issue with the estimated
97

Figure 4.10: Estimated position for 5,088 DEP events in detector P42661A using values from
training set one. Events which fail the 90% DEP cut are shown in red, events which pass
are in black. The radial position is squared to normalize for the increased detector volume
in a given voxel at higher radius. In these coordinates, the position distribution should be
roughly uniform (see Figure 4.11). The taper is visible in the corner at low axial position
and high radial position.
98

0
200
400
600
800
1000
1200
Radial position [mm2]
0
5
10
15
20
25
30
35
Axial position [mm]
Figure 4.11: Position distribution for DEP events in P42661A using a Geant4-based sim-
ulation of the Demonstrator geometry with the thorium source inserted. Double escape
events are tagged by energy and the presence of a positron during the track. Some clustering
is visible at the corners of the detector.
drift velocity curves in Figure 4.4, since the azimuthal position reconstruction depends on
the drift velocity anisotropy between crystal axes.
The DEP analysis was also repeated for detector P42574A. Figure 4.13 shows the wave-
forms corresponding to this ﬁt, while Figure 4.14 shows the positions. The behavior in this
detector is broadly similar to P42661A. A cluster of failing events appears near the point
contact, and there is some strong clustering of positions. Especially interesting is the lin-
ear cluster at ∼(r = 500 mm2, z = 27 mm), which is similar to one which appears at a
proportionally similar position within detector P42661A.
There are two interesting diﬀerences between the position maps. While P42661A shows
strong clustering in the corner opposite the point contact, in P42574A there is a strong cluster
just below the corner.
It is possible this is related to poorly estimated impurity proﬁle
parameters. Additionally, detector P42574A has a large sparse region of high likelihood
events reconstructed at low radial and high axial position.
99

0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
Estimated azimuthal position [rad]
0
50
100
150
200
250
Number
Figure 4.12: Estimated azimuthal position for DEP events which pass the 90% cut. If the
model were perfect, we should expect this distribution to be ﬂat between 0 and π/4.
100

Figure 4.13: Waveforms and estimated residuals for DEP waveforms in detector P42574A.
Red waveforms fail the likelihood cut, while black waveforms pass. Again, a large fraction
of the failing events have the long drift time between ∼90% and ∼99% of the maximum
amplitude.
101

Figure 4.14: Estimated position for DEP events in detector P42574A. Red points fail a 90%
eﬃciency likelihood cut, while black points pass the cut. Similar to detector P42661A, there
is clustering in certain locations. Additionally, the area at high axial and low radial position
is particularly sparse.
Section 4.3:
Uncertainties
There are several possible sources of uncertainty in the estimation of values from the
detector training algorithm. Because we are training the model on a ﬁnite set of waveforms,
it is possible the estimated value is biased based on the waveforms selected for the training
set.
Additionally, if the Markov chain cannot smoothly sample the parameter space, it
can become “stuck” on one local maximum likelihood value, and not ﬁnd the true global
maximum.
In general, choosing a training set with the largest possible number of waveforms should
produce the most accurate estimate of the parameters. However, to make the algorithm
computationally feasible, we chose to train with only sixteen waveforms. To attempt to
understand the uncertainty associated with the selection of this training set, we ran the
algorithm with two diﬀerent sets of training waveforms for detector P42661A. The esti-
mated parameters for both sets are shown in Table 4.2. For velocity and electronics ﬁlter
102

parameters, the diﬀerence in estimated values is roughly on order of 10%.
There is a larger discrepancy between sets for impurity concentration and point contact
dimension parameters. It is diﬃcult to deﬁnitively ascribe the diﬀerence in estimated value
to physical diﬀerences between the training sets, because it is also possible that the Markov
chain is not correctly converging on the optimum value for these parameters. Qualitatively,
we can judge how well the a Markov chain is converging to a true global maximum likelihood
based on the structure of a histogram of the values explored by the chain for a given pa-
rameter. Figure 4.15 shows a histogram of the ﬁnal 1,000 values of the chain for electronics
shaping parameters. The chain is exploring a continuous region of the possible space for each
of these parameters. In contrast, Figure 4.16 and Figure 4.17 show the ﬁnal 1,000 values for
the velocity and detector parameters. Most of these histograms show sharp peaks clustered
around disparate values (each of which corresponds to the location in parameter space of a
distinct particle in the diﬀusive nested sampler). It is possible that the likelihood space is
truly so strongly multimodal that this is a correct representation of the target distribution.
However, it is more likely that the chain is unable to smoothly sample the parameter space
due to the complexity of the model.
It should be expected that the velocity and detector parameters are more diﬃcult to
sample than the electronics parameters. Figure 2.19 shows that the electronics is a dominant
eﬀect on the waveform shape. Because the electronics shape the signal after it has formed
in the detector, the extremely long rise time of the Demonstrator amp eﬀectively washes
out the imprint of the detector and velocity parameters. In addition, there are a number
of very strong correlations in the model which describes signal formation. The model for
hole drift velocity, for example, depends both on the parameters of the velocity curve as
well as the modeled electric ﬁeld. This creates a strong correlation between the impurity
concentration and velocity parameters.
It is possible to approximate an uncertainty for parameters with poor chain performance
by evaluating the region of parameter space the chain explores before it becomes fragmented.
103

−1.441 −1.440 −1.439 −1.438 −1.437
φ
0
100
200
300
Number
11.238 11.240 11.242 11.244 11.246 11.248
ω × 103
0
100
200
1555
1556
1557
1558
1559
gain
0
100
200
300
Number
73.2
73.4
73.6
73.8
τ1 [µs]
0
100
200
1.36
1.37
1.38
1.39
1.40
τ2 [µs]
0
100
200
300
Number
0.98880
0.98885
0.98890
c
0
100
200
300
Figure 4.15: Histogram of the ﬁnal 10,000 saved steps in the Markov chain for electronics
ﬁlter parameters in P42661A training set one.
For each of these parameters, the chain
is exploring a continuous region around a single value. This is the proper behavior for a
well-converged chain.
104

4.882
4.884
4.886
4.888
4.890
⟨100⟩v250 [1E6 cm/s]
0
250
500
750
Number
4.4015
4.4020
4.4025
4.4030
4.4035
⟨111⟩v250 [1E6 cm/s]
0
200
400
600
7.26
7.28
7.30
7.32
⟨100⟩v1000 [1E6 cm/s]
0
1000
2000
Number
6.285
6.290
6.295
6.300
6.305
6.310
⟨111⟩v1000 [1E6 cm/s]
0
500
1000
0.04
0.06
0.08
0.10
0.12
⟨100⟩β
0
500
1000
Number
0.90
0.91
0.92
⟨111⟩β
0
500
1000
Figure 4.16: Histogram of the ﬁnal 10,000 saved steps in the Markov chain for velocity
parameters in P42661A training set one. For these parameters, the chain is exploring diﬀerent
well-separated pockets of diﬀerent values. This indicates either that the likelihood space is
extremely multi-modal likelihood space or that the chain is having diﬃculty sampling over
the allowed space for these parameters.
105

0.0130
0.0135
0.0140
Avg. imp. [1E10 cm−3]
0
500
1000
Number
−0.5454
−0.5452
−0.5450
Imp. grad. [1E10 cm−4]
0
250
500
750
1.538
1.539
1.540
1.541
1.542
1.543
PC Radius [mm]
0
500
1000
Number
1.2080 1.2085 1.2090 1.2095 1.2100 1.2105
PC Length [mm]
0
500
1000
294
295
296
297
298
τ trap [µs]
0
250
500
750
Number
5000
5100
5200
5300
τ release [µs]
0
250
500
750
Figure 4.17: Histogram of the ﬁnal 10,000 saved steps in the Markov chain for detector
parameters in P42661A training set one. Like in Figure 4.16, the chain is not smoothly
sampling over these parameter values.
106

Figure 4.18 shows a series histogram of the estimated radial and axial position as the chain
iterates. We can estimate the uncertainty in the position estimate as the rough area the
chain explores in subplot (b).
In principle, the issue of poor chain performance could be addressed by increasing the
number of particles run in the diﬀusive nested sampling algorithm. However, the availabil-
ity of computational resources has limited us to 20 particles for the sixteen waveform set
considered above.
Section 4.4:
Conclusions
Diﬀusive nested sampling was utilized to ﬁt a training set of sixteen waveforms from
two diﬀerent detectors from the Demonstrator. The model is able to ﬁt the waveforms
with residuals on the order of parts per thousand of the overall signal amplitude. There is,
however, some structure which remains in the residuals, indicating either that the model is
incorrect or that it has converged on a suboptimal set of parameters.
The performance of the ﬁt was evaluated by performing a simpliﬁed ﬁt to individual
waveforms from the 208Tl escape peaks. Using the majority single site events of the DEP, we
estimated the ability of the model to estimate position. In general, there are no large volumes
it totally fails to sample correctly, with the exception of the region near the point contact,
and the region near the taper. The nonuniform clustering seen in position, especially in φ,
again suggests some deﬁciency or degeneracy in the model.
Given the complexity and high degree of correlation in the model, it is diﬃcult to spec-
ulate as to the exact parameters which are causing these issues. It is clear that the residual
aﬀects all waveforms equally, which could point to the shaping due to electronics.
The
electronics response function chosen in Section 2.2.3 was arrived at empirically but without
high-precision measurements using signals of known input. Future measurements should be
dedicated to ensuring that this function is adequate at the level of accuracy now required of
the model.
107

Figure 4.18: Histogram of position parameters for diﬀerent slices of the Markov chain for
P42661A training set one. The chain was run for 680,000 saved steps. Each plot shows
a histogram of chain values for position over a diﬀerent slice of the iteration number: (a)
steps 1,000–7,700; (b) 7,700 – 14,400; (c) 14,400-21,100; (d)21,100-27,800. In (a), the chain
is exploring the region generally along a drift time isochrone, and has shown preference for
the region around (r = 15mm, z = 15mm).
In (b) and (c), the chain splinters into on
disconnected subspaces of position. By (d), the chain samples only a few of the 0.1mm ×
0.1mm pixels. (The red circle is included to emphasize where on the plot the pixels are
located).
108

Even with an imperfect model, a cut based on ﬁt likelihood was shown to discriminate
against multisite events with nearly the same eﬃciency as an A/E cut. Given that the cut
is deﬁned at 90% eﬃciency in the DEP, and we are sacriﬁcing a large number of events to
the point contact region, it is clear that the current model can at least discriminate between
single and multisite events with accuracy.
109

CHAPTER 5:
Conclusions
Section 5.1:
Summary of results
We have developed a model which is able to simulate waveforms formed in Majorana
Demonstrator PPC germanium detectors with high precision. This model incorporates
semiconductor physics with an empirical representation of the shaping introduced by readout
electronics. Using the framework of Bayesian statistics, we have utilized the model to build
an algorithm to learn the correct model parameters for a given detector. The model is trained
using only a small number of calibration waveforms which have been carefully selected to
provide information about single site event shapes from across the detector volume.
When the algorithm is applied to a training set of sixteen waveforms from a Demon-
strator detector, the model is able to reconstruct waveforms to the level of parts per
thousand. However, the structure present in the residual suggests either the model is miss-
ing key physics, or the model is not correctly converging on a global maximum. Even with
this limitation, the model is clearly able to distinguish between normal and abnormal events
with high eﬃciency.
The distribution of estimated position for single site events is less uniform than would be
expected. Again, this points to either the model or parameters being incorrect. In addition
to clustering, both analyzed detectors showed some regions which are with fewer estimated
events compared to simulation. Again, this points either to a deﬁciency in the model or a
failure of the MCMC algorithm.
110

Section 5.2:
Additional studies
There are several studies which would improve understanding of the results described
above. In Section 4.3, we showed that the MCMC is likely failing to properly explore the
full parameter space. As a future study of the MCMC convergence, the algorithm can be
run several times on the same training set with diﬀerent random number seeds. Changing
the seed will change the initial state of the Markov chain, which is drawn randomly from the
prior distribution. If the parameter estimates diﬀer substantially between seeds, it is proof
that the chain is converging poorly.
It is also possible that increasing the number of waveforms in the training set could
help improve the ability of the chain to converge. If the chain is failing because there is
insuﬃcient information in the sixteen waveform training set to create a strong preference in
likelihood space, additional waveforms would provide more information. On the other hand,
adding waveforms also increases the dimensionality of the ﬁt, which makes convergence more
diﬃcult. Still, it is worth attempting to train on larger sets, keeping in mind that increasing
the size also increases the required computational resources.
In addition, several studies are necessary to investigate possible dependence of the esti-
mated parameters on the choice of training set waveforms. All the data discussed in this
work originate from a single calibration set, taking place over the course of several hours. It
is possible that some parameters could change in time due to environmental or other factors.
For example, it is conceivable that ambient temperature could aﬀect the electronics ﬁlter pa-
rameters. The learning algorithm should be applied to training waveforms from calibrations
taken weeks and months apart to evaluate the stability of all parameters.
Similarly, all training waveforms in the results above were taken from the 2614 keV 208Tl
photopeak, which was chosen to maximize the signal to noise ratio. It is feasible that the
estimated parameters might changes based on the energy of the training waveforms used.
This can be examined by training with waveforms originating from diﬀerent energies, such
as the double escape peak or Compton continuum edge.
111

Finally, it would be extremely useful to begin dedicated measurements to validate the
parameters estimated by the model. As a ﬁrst step, collimated scans could be performed
with a relatively high energy source.
The estimated position distribution could then be
compared to the location of the collimated beam as a more precise form of validation than
simply looking at the distribution of DEP events.
Section 5.3:
Improvements
5.3.1:
Model improvements
We have put great eﬀort into trying to resolve the origin of the structure in the residual
by adjusting the model and incorporating additional physics. One possibility is that the
model is correct, but the MCMC algorithm is unable to converge on the global likelihood
maximum. Given the state of the Markov chain shown in Figures 4.15 and 4.16, it seems
worth exploring improvements to the MCMC before attempting to introduce new changes
to the model.
Should it prove necessary to adjust the model, there are a few areas which stand out
as obvious candidates for improvement to the observed residual. Because the residual is
of equal strength for waveforms of all drift times, its origin cannot be a localized eﬀect.
This eliminates the failure to ﬂoat electron velocity parameters as a possible culprit. The
electronics ﬁlter parameters stand out as clearly aﬀecting all waveforms equally. It might be
possible to increase the order of the low pass ﬁlter to fully encapsulate the Demonstrator
electronics frequency response. A second possibility is that the approximations about charge
cloud shape described in Section 2.2.2 are no longer accurate at this level of precision. Finally,
since the holes from all waveforms are collected at the point contact, error in the ﬁeld or
weighting potential in this region could give rise to the residual. At present, the point contact
is modeled as a perfect hemispherical indentation into the detector surface, which creates a
sharp corner where the two join. In reality, this corner has some curvature, which could be
112

included in the model in the future.
In the long term, modeling waveforms which originate in the volume immediately sur-
rounding the detector will require including an electron drift velocity parameterization in the
model. Given that this region is a relatively small percentage of the overall detector volume,
and would require increasing the dimensionality of the ﬁt, this is probably a low priority.
As a parallel project, it would be interesting to attempt to incorporate into the model
the eﬀects which distort waveform shape at the edges of the detectors. For instance, we
believe diﬀusion in low ﬁeld regions near the n+ contact is responsible for the waveforms
with slowed rise times from ∼90% to maximum in Figures 4.10 and 4.14. Modeling this
eﬀect might allow us to ﬁt the slowed waveforms which originate near the n+ contact in
This could, in turn, allow for improved understanding of the depth of the n+ contact and
the true active volume of each detector.
5.3.2:
Training improvements
Improving the uncertainties on parameters before introducing them to the model could
improve convergence of the chain and reduce required computation time. Perhaps the sim-
plest to implement is a dedicated measurement of the electronics ﬁlter parameters. By using
a signal generator to inject a signal of known shape at the detector, the transfer function
parameters could be ﬁt completely independently of the detector and waveform parameters.
The work described in this document was started after construction on the Demonstra-
tor was well underway, which prevented us from taking any dedicated detector characteri-
zation data. In the future, dedicated collimated scans could be used to create training sets
of waveforms with well-understood location. Understanding the location would consider-
ably shrink the size of the allowed parameter space from the prior and simplify the training
algorithm.
113

5.3.3:
Computational improvements
An impediment to broadly applying this technique is the heavy computational load it
requires. The training algorithm as implemented in this work, using sixteen waveforms, takes
approximately a day of wall time on the UNC killdevil cluster using 341 cores. Assuming the
detector parameters are stable in time over the course of data taking for the experiment, this
should only need to be run once per detector. Once detector parameters are frozen, ﬁtting
each individual waveform takes on the order of a minute (and is trivially parallelizable).
The simplest way to improve the computation time required for the training step is
to improve the information input to the training step, as described above.
With better
information on electronics parameters and waveform position, the training step would take
considerably less time to complete. Additionally, improving the model to account for the
residual should smoothen the convergence process and improve computation time. Model
improvement should similarly improve the convergence time for individual waveforms.
Finally, more work can focus on improving the computation itself. There is remaining
optimization which should be done within pysiggen, especially in the application of convo-
lutions for charge cloud size and electronics ﬁltering. Some speedup should be possible by
porting the python components to the c language.
Section 5.4:
Outlook for the Demonstrator and beyond
As we continue to improve the model, it is important to keep in mind that the ultimate
measure of this technique is its applications for the Demonstrator and future tonne-scale
experiments. In Section 4.2, we showed that a simple likelihood-based cut can eﬀectively
discriminate against multi-site events in the single escape peak, as well as reject unusual
waveforms in the double escape peak. An obvious next step is to apply the cut to waveforms
from Demonstrator background data. Given that a large number of the Demonstrator
background events around the ROI have been identiﬁed as alpha events with a distorted
114

waveform shape, it would be interesting to evaluate the ability of the likelihood cut to reject
alphas. Additionally, the 2νββ events in the spectrum will provide a check on the ability of
the technique to ﬁt ββ waveforms.
Although the position estimation shown in Section 4.2 is imperfect, it represents the ﬁrst
time event origin has been estimated inside a PPC detector. The availability of this new in-
formation can be used for several purposes in a 0νββ experiment. During the commissioning
phase, should any unexpected background appear within the experiment, the location could
help localize the position of the source. Additionally, since ββ events should be distributed
uniformly through the detector volume, position information can serve as a useful check on
systematics from analysis cuts.
As we move toward a tonne-scale germanium 0νββ experiment, understanding the ori-
gin and characteristics of every waveform will become paramount. This can be achieved by
designing the tonne-scale experiment with the capabilities of this technique in mind. For ex-
ample, the narrow bandwidth of the Demonstrator preamp electronics causes a dramatic
increase in waveform rise time, and eﬀectively blurs out information about the detector and
waveform properties. A wider-bandwidth preampﬁﬁcation chain should increase the amount
of this information which is available in the measured waveform, which could enable im-
proved background rejection. It would be possible to quantify this improvement by studying
the algorithm performance on waveforms simulated with a higher bandwidth preamp.
115

BIBLIOGRAPHY
[1] L. Camilleri, E. Lisi, and J. F. Wilkerson, “Neutrino Masses and Mixings: Status and
Prospects,” Annu. Rev. Nucl. Part. Sci. 58 (2008) 343–369.
[2] M. Goeppert-Mayer, “Double Beta-Disintegration,” Phys. Rev. 48 (Sep, 1935)
512–516. http://link.aps.org/doi/10.1103/PhysRev.48.512.
[3] S. R. Elliott, A. A. Hahn, and M. K. Moe, “Direct evidence for two-neutrino
double-beta decay in 82Se,” Phys. Rev. Lett. 59 (Nov, 1987) 2020–2023.
http://link.aps.org/doi/10.1103/PhysRevLett.59.2020.
[4] E. Majorana, “Teoria simmetrica dell’elettrone e del positrone,” Il Nuovo Cimento
(1924-1942) 14 no. 4, (Sep, 2008) 171. https://doi.org/10.1007/BF02961314.
[5] W. H. Furry, “On Transition Probabilities in Double Beta-Disintegration,” Phys. Rev.
56 (Dec, 1939) 1184–1193. http://link.aps.org/doi/10.1103/PhysRev.56.1184.
[6] I. Avignone, Frank T., S. R. Elliott, and J. Engel, “Double Beta Decay, Majorana
Neutrinos, and Neutrino Mass,” Rev.Mod.Phys. 80 (2008) 481–516, arXiv:0708.1033
[nucl-ex].
[7] Z. Maki, M. Nakagawa, and S. Sakata, “Remarks on the Uniﬁed Model of Elementary
Particles,” Progress of Theoretical Physics 28 no. 5, (1962) 870–880.
[8] S. Dell’Oro, S. Marcocci, and F. Vissani, “New expectations and uncertainties on
neutrinoless double beta decay,” Phys. Rev. D 90 (Aug, 2014) 033005.
https://link.aps.org/doi/10.1103/PhysRevD.90.033005.
[9] J. Barea, J. Kotila, and F. Iachello, “Nuclear matrix elements for double-β decay,”
Phys. Rev. C 87 (Jan, 2013) 014315.
https://link.aps.org/doi/10.1103/PhysRevC.87.014315.
[10] J. Engel and J. Menndez, “Status and future of nuclear matrix elements for
neutrinoless double-beta decay: a review,” Reports on Progress in Physics 80 no. 4,
(2017) 046301. http://stacks.iop.org/0034-4885/80/i=4/a=046301.
[11] Particle Data Group Collaboration, C. Patrignani et al., “Review of Particle
Physics,” Chin. Phys. C40 no. 10, (2016) 100001.
[12] GERDA Collaboration, M. Agostini et al., “Background-free search for neutrinoless
double-β decay of 76Ge with GERDA,” Nature 544 no. 7648, (04, 2017) 47–52.
[13] CUORE Collaboration, K. Alfonso et al., “Search for Neutrinoless Double-Beta
Decay of 130Te with CUORE-0,” Phys. Rev. Lett. 115 (Sep, 2015) 102502.
https://link.aps.org/doi/10.1103/PhysRevLett.115.102502.
116

[14] EXO Collaboration, J. B. Albert et al., “Search for Majorana neutrinos with the ﬁrst
two years of EXO-200 data,” Nature 510 no. 7504, (06, 2014) 229–234.
http://dx.doi.org/10.1038/nature13432.
[15] KamLAND-Zen Collaboration, A. Gando et al., “Search for Majorana Neutrinos
Near the Inverted Mass Hierarchy Region with KamLAND-Zen,” Phys. Rev. Lett. 117
(Aug, 2016) 082503.
https://link.aps.org/doi/10.1103/PhysRevLett.117.082503.
[16] Majorana Collaboration, N. Abgrall et al., “The Majorana Demonstrator
Neutrinoless Double-Beta Decay Experiment,” Adv.High Energy Phys. 2014 (2014)
365432, arXiv:1308.1633 [physics.ins-det].
[17] F. ˇSimkovic, A. Faessler, H. M¨uther, V. Rodin, and M. Stauf, “0νββ-decay nuclear
matrix elements with self-consistent short-range correlations,” Phys. Rev. C 79 (May,
2009) 055501. http://link.aps.org/doi/10.1103/PhysRevC.79.055501.
[18] Majorana Collaboration, N. Abgrall et al., “Muon ﬂux measurements at the davis
campus of the sanford underground research facility with the majorana demonstrator
veto system,” Astroparticle Physics 93 (2017) 70 – 75.
http://www.sciencedirect.com/science/article/pii/S0927650517300038.
[19] P. Barton, P. Luke, M. Amman, Y. D. Chan, J. Detwiler, J. Loach, R. Martin,
A. Poon, C. Tindall, and K. Vetter, “Low-noise low-mass front end electronics for
low-background physics experiments using germanium detectors,” in Nuclear Science
Symposium and Medical Imaging Conference (NSS/MIC), 2011 IEEE, pp. 1976–1979.
Oct, 2011.
[20] ORTEC, “Review of the Physics of Semiconductor Detectors.”
https://www.ortec-online.com/-/media/ametekortec/other/review_of_the_
physics_of_semiconductor_detectors.pdf. Accessed: 2017-07-07.
[21] E. E. Haller, W. L. Hansen, and F. S. Goulding, “Physics of ultra-pure germanium,”
Advances in Physics 30 no. 1, (1981) 93–138.
[22] G. Knoll, Radiation Detection and Measurement. John Wiley & Sons, 2010.
https://books.google.com/books?id=4vTJ7UDel5IC.
[23] P. N. Luke, F. S. Goulding, N. W. Madden, and R. H. Pehl, “Low capacitance large
volume shaped-ﬁeld germanium detector,” IEEE Transactions on Nuclear Science 36
no. 1, (1989) 926–30.
[24] CoGeNT Collaboration Collaboration, C. E. Aalseth et al., “Results from a Search
for Light-Mass Dark Matter with a p-Type Point Contact Germanium Detector,”
Phys. Rev. Lett. 106 (Mar, 2011) 131301.
https://link.aps.org/doi/10.1103/PhysRevLett.106.131301.
117

[25] Majorana Collaboration, N. Abgrall et al., “New Limits on Bosonic Dark Matter,
Solar Axions, Pauli Exclusion Principle Violation, and Electron Decay from the
Majorana Demonstrator,” Phys. Rev. Lett. 118 (Apr, 2017) 161801.
https://link.aps.org/doi/10.1103/PhysRevLett.118.161801.
[26] P. S. Barbeau, J. I. Collar, and O. Tench, “Large-mass ultralow noise germanium
detectors: performance and applications in neutrino and astroparticle physics,”
Journal of Cosmology and Astroparticle Physics 2007 no. 9, (2007) 9.
[27] N. Abgrall et al., “Search for Pauli exclusion principle violating atomic transitions and
electron decay with a p-type point contact germanium detector,” The European
Physical Journal C 76 no. 11, (2016) 619.
http://dx.doi.org/10.1140/epjc/s10052-016-4467-0.
[28] ORTEC, “Overview of Semiconductor Photon Detectors.”
https://www.ortec-online.com/-/media/ametekortec/other/
overview-of-semiconductor-photon-detectors.pdf. Accessed: 2017-05-09.
[29] W. Shockley, “Currents to Conductors Induced by a Moving Point Charge,” Journal
of Applied Physics 9 no. 10, (1938) 635–636.
http://scitation.aip.org/content/aip/journal/jap/9/10/10.1063/1.1710367.
[30] S. Ramo, “Currents Induced by Electron Motion,” Proceedings of the IRE 27 no. 9,
(Sept, 1939) 584–585.
[31] M. Agostini et al., “Pulse shape discrimination for GERDA Phase I data,” Eur. Phys.
J. C73 no. 10, (2013) 2583, arXiv:1307.2610 [physics.ins-det].
[32] R. Cooper, D. Radford, K. Lagergren, et al., “A pulse shape analysis technique for the
Majorana experiment,” Nucl. Instrum. Methods Section A 629 (2011) 303–310.
[33] N. Abgrall et al., “The Majorana Demonstrator Neutrinoless Double-Beta Decay
Experiment,” Advances in High Energy Physics 2014 (2014) 18.
[34] “mjd ﬁeldgen and mjd siggen software.”
http://radware.phy.ornl.gov/MJ/mjd_siggen/.
[35] https://github.com/benshanks/pysiggen. pysiggen software.
[36] S. Behnel, R. Bradshaw, C. Citro, L. Dalcin, D. Seljebotn, and K. Smith, “Cython:
The Best of Both Worlds,” Computing in Science Engineering 13 no. 2, (March-april,
2011) 31 –39.
[37] ORTEC, “Oak Ridge, TN, USA.”.
[38] W. L. Hansen and E. Haller, “High-Purity Germanium Crystal Growing,” MRS
Proceedings 16 (1982) .
118

[39] W. P. Electronics, “MPOD Power Supplies.” http:
//www.wiener-d.com/sc/power-supplies/mpod--lvhv/mpod-hv-module.html.
Accessed: 2017-07-18.
[40] iseg High Voltage, “EHS High Voltage Supplies.”
http://iseg-hv.com/en/products/detail/EHS. Accessed: 2017-07-18.
[41] E. Conwell, High Field Transport in Semiconductors. Solid State Physics: Advances in
Research and Applications. Supplement. Academic Press, 1967.
https://books.google.com/books?id=vdgWAQAAMAAJ.
[42] D. M. Caughey and R. E. Thomas, “Carrier mobilities in silicon empirically related to
doping and ﬁeld,” Proceedings of the IEEE 55 no. 12, (Dec, 1967) 2192–2193.
[43] M. Omar and L. Reggiani, “Drift velocity and diﬀusivity of hot carriers in germanium:
Model calculations,” Solid-State Electronics 30 no. 12, (1987) 1351 – 1354.
http://www.sciencedirect.com/science/article/pii/0038110187900633.
[44] J. Gunn, “Eﬀect of electron and impurity density on the ﬁeld-dependence of mobility
in germanium,” Journal of Physics and Chemistry of Solids 8 (1959) 239 – 241.
http://www.sciencedirect.com/science/article/pii/0022369759903257.
[45] D. M. Brown and R. Bray, “Analysis of Lattice and Ionized Impurity Scattering in
p-Type Germanium,” Phys. Rev. 127 (Sep, 1962) 1593–1602.
https://link.aps.org/doi/10.1103/PhysRev.127.1593.
[46] L. Reggiani, C. Canali, F. Nava, and G. Ottaviani, “Hole drift velocity in
germanium,” Phys. Rev. B 16 (Sep, 1977) 2781–2791.
https://link.aps.org/doi/10.1103/PhysRevB.16.2781.
[47] L. Mihailescu, W. Gast, R. Lieder, H. Brands, and H. Jger, “The inﬂuence of
anisotropic electron drift velocity on the signal shapes of closed-end {HPGe}
detectors,” Nuclear Instruments and Methods in Physics Research Section A:
Accelerators, Spectrometers, Detectors and Associated Equipment 447 no. 3, (2000)
350 – 360.
http://www.sciencedirect.com/science/article/pii/S0168900299012863.
[48] W. Sasaki, M. Shibuya, and K. Mizuguchi, “Anisotropy of Hot Electrons in n-type
Germanium,” Journal of the Physical Society of Japan 13 no. 5, (1958) 456–460.
http://dx.doi.org/10.1143/JPSJ.13.456.
[49] “Germanium band structure and carrier concentration.”
http://www.ioffe.ru/SVA/NSM/Semicond/Ge/bandstr.html. Accessed: 2017-07-01.
[50] G. Dresselhaus, A. F. Kip, and C. Kittel, “Cyclotron Resonance of Electrons and
Holes in Silicon and Germanium Crystals,” Phys. Rev. 98 (Apr, 1955) 368–384.
119

https://link.aps.org/doi/10.1103/PhysRev.98.368.
[51] M. Cardona and F. H. Pollak, “Energy-Band Structure of Germanium and Silicon:
The k·p Method,” Phys. Rev. 142 (Feb, 1966) 530–543.
https://link.aps.org/doi/10.1103/PhysRev.142.530.
[52] B. Bruyneel, P. Reiter, and G. Pascovici, “Characterization of large volume {HPGe}
detectors. Part I: Electron and hole mobility parameterization,” Nuclear Instruments
and Methods in Physics Research Section A: Accelerators, Spectrometers, Detectors
and Associated Equipment 569 no. 3, (2006) 764 – 773.
http://www.sciencedirect.com/science/article/pii/S0168900206015166.
[53] M. I. Nathan, “Anisotropy of the Conductivity of n-Type Germanium at High Electric
Fields,” Phys. Rev. 130 (Jun, 1963) 2201–2204.
https://link.aps.org/doi/10.1103/PhysRev.130.2201.
[54] L. Reggiani, “The anisotropy of the hot-hole drift velocity in Ge,” Journal of Physics
and Chemistry of Solids 37 no. 3, (1976) 293 – 300.
http://www.sciencedirect.com/science/article/pii/0022369776900901.
[55] M. Martini and T. McMath, “Trapping and detrapping eﬀects in lithium-drifted
germanium and silicon detectors,” Nuclear Instruments and Methods 79 no. 2, (1970)
259 – 276.
http://www.sciencedirect.com/science/article/pii/0029554X70901497.
[56] S. Zimmermann, J. T. Anderson, D. Doering, J. Joseph, C. Lionberger,
T. Stezelberger, and H. Yaver, “Implementation and Performance of the Electronics
and Computing System of the Gamma Ray Energy Tracking In-Beam Nuclear Array
(GRETINA),” IEEE Transactions on Nuclear Science 59 no. 5, (Oct, 2012)
2494–2500.
[57] A. Gelman, J. Carlin, H. Stern, D. Dunson, A. Vehtari, and D. Rubin, Bayesian Data
Analysis, Third Edition. Chapman & Hall/CRC Texts in Statistical Science. Taylor &
Francis, 2013. https://books.google.com/books?id=ZXL6AQAAQBAJ.
[58] W. Gilks, S. Richardson, and D. Spiegelhalter, Markov Chain Monte Carlo in
Practice. Chapman & Hall/CRC Interdisciplinary Statistics. Taylor & Francis, 1995.
https://books.google.com/books?id=TRXrMWY_i2IC.
[59] W. K. Hastings, “Monte Carlo Sampling Methods Using Markov Chains and Their
Applications,” Biometrika 57 no. 1, (1970) 97–109.
http://www.jstor.org/stable/2334940.
[60] B. J. Brewer, L. B. P´artay, and G. Cs´anyi, “Diﬀusive nested sampling,” Statistics and
Computing 21 no. 4, (2011) 649–656.
http://dx.doi.org/10.1007/s11222-010-9198-8.
120

[61] J. Skilling, “Nested sampling for general Bayesian computation,” Bayesian Anal. 1
no. 4, (12, 2006) 833–859. http://dx.doi.org/10.1214/06-BA127.
[62] D. F.-M. Brendon J. Brewer, “DNest4: Diﬀusive Nested Sampling in C++ and
Python,” arXiv:1606.03757 [stat.CO].
[63] E. Gabriel, G. E. Fagg, G. Bosilca, T. Angskun, J. J. Dongarra, J. M. Squyres,
V. Sahay, P. Kambadur, B. Barrett, A. Lumsdaine, R. H. Castain, D. J. Daniel, R. L.
Graham, and T. S. Woodall, “Open MPI: Goals, Concept, and Design of a Next
Generation MPI Implementation,” in Proceedings, 11th European PVM/MPI Users’
Group Meeting, pp. 97–104. Budapest, Hungary, September, 2004.
[64] N. Abgrall et al., “The Majorana Demonstrator calibration system,”
arXiv:1702.02466 [physics.ins-det].
121

