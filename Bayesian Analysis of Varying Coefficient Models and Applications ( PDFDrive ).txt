Bayesian Analysis of Varying Coeﬃcient Models
and Applications
Zhaowei Hua
A dissertation submitted to the faculty of the University of North Carolina at Chapel
Hill in partial fulﬁllment of the requirements for the degree of Doctor of Philosophy in
the Department of Biostatistics.
Chapel Hill
2011
Approved by:
Hongtu Zhu
David B. Dunson
Fei Zou
Wei Sun
Sy-Miin Chow

c⃝2011
Zhaowei Hua
ALL RIGHTS RESERVED
ii

Abstract
ZHAOWEI HUA: Bayesian Analysis of Varying Coeﬃcient Models and
Applications.
(Under the direction of Hongtu Zhu and David B. Dunson.)
The varying coeﬃcient models have been very important analytic tools to study the
dynamic pattern in biomedicine ﬁelds. Since nonparametric varying coeﬃcient models
make few assumptions on the speciﬁcation of the model, the ‘curse of dimensionality’
is an very important issue.
Nonparametric Bayesian methods combat the curse of
dimensionality through specifying a sparseness-favoring structure. This is accomplished
through the Bayesian penalty for model complexity (Jeﬀreys and Berger, 1992) and
is aided through centering on a base Bayesian parametric model. This dissertation
presents three novel semiparametric Bayesian methods for the analysis of longitudinal
data, diﬀusion tensor imaging data, and longitudinal circumplex data.
In longitudinal data analysis, we propose a semiparametric Bayes approach to allow
the impact of the predictors to vary across subjects, which allows ﬂexibly local bor-
rowing of information across subjects. Local hypothesis testing and conﬁdence bands
are developed for the identiﬁcation of time windows for signiﬁcant predictor impact,
adjusting for multiple comparisons. The methods are assessed using simulation studies
and applied to a yeast cell-cycle gene expression data set.
In analyzing diﬀusion tensor imaging data, we propose a semiparametric Bayesian
local functional model to connect multiple diﬀusion properties along white matter ﬁber
bundles with a set of covariates of interest. An LPP2 prior facilitates global and local
borrowing of information among subjects, while an inﬁnite factor model ﬂexibly rep-
resents low-dimensional structure. Local hypothesis testing and conﬁdence bands are
iii

developed to identify ﬁber segments for signiﬁcant association of covariates with mul-
tiple diﬀusion properties, controlling for multiple comparisons. The method is assessed
by a simulation study and illustrated via two ﬁber tract data sets for neurodevelopment.
In analyzing longitudinal circumplex data, we propose a semiparametric Bayesian
inﬁnite state-space circumplex model to capture the dynamic transition pattern of
aﬀective experience, where aﬀects are characterized as an ordering on the circumference
of a circle. A sticky inﬁnite state hidden Markov model via hierarchical Dirichlet proces
is used to address the time related state-switching structure and the self-transition
feature. The method is assessed by a simulation study and an emotion data set for the
dynamics of emotion regulation.
iv

Acknowledgments
The period of my dissertation is a precious component in my life that I beneﬁt from
many people in completing this dissertation and get inspired in problem solving.
I want to express my deepest gratitude to my advisors, Dr. Hongtu Zhu and Dr.
David B. Dunson. Both of them are the shining models as world-class researchers. Their
broad visions, deep insights, and high research standards are the leading sources in my
growth throughout my dissertation research. I particularly appreciate the generous
ﬁnancial support from Dr. Hongtu Zhu, as well as the support from Dr. David B.
Dunson in funding application.
I want to sincerely thank my committee members Dr. Sy-Miin Chow, Dr. Fei Zou
and Dr. Wei Sun. I appreciate Dr. Sy-Miin Chow for her suggestions in improving
my 3rd topic, providing the circumplex data, and her ﬁnancial support. I thank Dr.
Fei Zou and Dr. Wei Sun for commenting my views, reading my dissertation, and
suggestions in improving my dissertation. I also owe my thanks to Dr. Wei Sun for his
friendship and his personal support.
I am greatly thankful to Dr. Joseph Ibrahim for his generous ﬁnancial support
with NCI training grant program in genomics and cancer. I particularly appreciate Dr.
Michael Kosorok for oﬀering me a graduate fellowship at SAMSI and Dr. Amy Herring
for her guidance at SAMSI.
I am deeply indebted to Dr. Jianwen Cai for introducing me into the Biostatistics
research area in advising my master paper and her encouragements.
v

I owe my special thanks to Dr. Todd Schwartz for his guidance in diverse exciting
projects at School of Nursing and his encouragement in my study at UNC with his
professional and personal support. I am heartily thankful to Dr. William Kalsbeek for
oﬀering me an opportunity to work with him on an interesting sampling design project
and his professional support. I am grateful to Dr. Diane holditch-davis and Dr. Mark
Weaver for the initial opportunity at School of Nursing as a research assistant.
My sincere thanks also goes to Dr. Suchindran for oﬀering me the admission op-
portunity to this prestigious department and his professional support.
Many friends and schoolmates have helped me weather the up and down days of
my graduate student life. I greatly value their friendships. In particular, I want to
thank all the group members in our BIAS lab where we are encouraged to pursue deep
knowledge and understanding.
Finally and most importantly, my lovely words go to my husband Jiansuo. His
persistent love and patience has been the pillar throughout my graduate life. I partic-
ularly thank my fellow brothers and sisters in God who have made home away from
home. I thank my parents and sister’s family back home for their unconditional love
and support.
vi

Table of Contents
Abstract . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
iii
List of Figures
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
x
List of Tables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
xi
List of Abbreviations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
xii
1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
1.1
Frequentist Analysis of Varying Coeﬃcient Models . . . . . . . . . . . .
2
1.1.1
Kernel-local Polynomial Smoothing . . . . . . . . . . . . . . . .
2
1.1.2
Spline Smoothing . . . . . . . . . . . . . . . . . . . . . . . . . .
4
1.2
Bayesian Analysis of Varying Coeﬃcient Models . . . . . . . . . . . . .
7
1.2.1
Bayesian Spline Models . . . . . . . . . . . . . . . . . . . . . . .
8
1.2.2
Random Eﬀects Models with Dirichlet Process . . . . . . . . . .
9
1.3
Applications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
11
1.3.1
Analysis of Longitudinal Data with Time-Varying
Coeﬃcient Models
. . . . . . . . . . . . . . . . . . . . . . . . .
11
1.3.2
Analysis of Survival Data with Time-Varying Coeﬃcient Models
12
2
Semiparametric Bayes local additive models for longitudinal data .
15
2.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
15
2.2
Semiparametric Bayes Local Additive Model . . . . . . . . . . . . . . .
19
vii

2.2.1
LPP2 prior
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
19
2.2.2
The Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
21
2.2.3
Induced Properties . . . . . . . . . . . . . . . . . . . . . . . . .
23
2.2.4
Hypothesis Formulation & Testing
. . . . . . . . . . . . . . . .
24
2.2.5
Bayesian Conﬁdence Band . . . . . . . . . . . . . . . . . . . . .
26
2.3
Posterior Computation . . . . . . . . . . . . . . . . . . . . . . . . . . .
27
2.4
Simulation Study . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
28
2.5
Yeast Cell-Cycle Gene Expression Application . . . . . . . . . . . . . .
30
2.5.1
Background and Motivation . . . . . . . . . . . . . . . . . . . .
30
2.5.2
Analysis and Results . . . . . . . . . . . . . . . . . . . . . . . .
33
2.6
Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
35
2.7
Appendix
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
40
2.7.1
Appendix A: Proof of Proposition 1 . . . . . . . . . . . . . . . .
40
2.7.2
Appendix B: the MCMC Posterior Computation Algorithm . .
40
3
Semiparametric Bayesian Local Functional Models
for Diﬀusion Tensor Tract Statistics . . . . . . . . . . . . . . . . . . . .
47
3.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
47
3.2
Methodologies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
50
3.2.1
Multivariate Random Coeﬃcient Model . . . . . . . . . . . . . .
50
3.2.2
Inﬁnite Latent Factor Model . . . . . . . . . . . . . . . . . . . .
52
3.2.3
Priors
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
54
3.2.4
LPP2 prior
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
55
3.2.5
Hypothesis Formulation & Testing
. . . . . . . . . . . . . . . .
58
3.2.6
Bayesian Conﬁdence Bands
. . . . . . . . . . . . . . . . . . . .
59
viii

3.2.7
Bayesian Cluster Analysis . . . . . . . . . . . . . . . . . . . . .
60
3.3
Monte Carlo Simulations . . . . . . . . . . . . . . . . . . . . . . . . . .
61
3.4
Clinical DTI Fiber Tract Data . . . . . . . . . . . . . . . . . . . . . . .
63
3.4.1
Background and Analysis
. . . . . . . . . . . . . . . . . . . . .
63
3.4.2
Results: Right Internal Capsule Tract . . . . . . . . . . . . . . .
66
3.4.3
Results: Splenium Tract . . . . . . . . . . . . . . . . . . . . . .
68
3.5
Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
70
3.6
Appendix: Posterior Computation . . . . . . . . . . . . . . . . . . . . .
71
4
Bayesian Sticky HDP Inﬁnite Hidden Markov Circumplex Model .
87
4.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
87
4.2
Bayesian Sticky HDP-iHMM Circumplex Model . . . . . . . . . . . . .
90
4.2.1
Circumplex Model
. . . . . . . . . . . . . . . . . . . . . . . . .
90
4.2.2
Sticky HDP-iHMM State-space Circumplex Model . . . . . . . .
91
4.2.3
Background: Dirichlet Processes . . . . . . . . . . . . . . . . . .
93
4.2.4
The Sticky HDP-iHMM Model
. . . . . . . . . . . . . . . . . .
97
4.3
Posterior Computation . . . . . . . . . . . . . . . . . . . . . . . . . . .
99
4.4
Simulation Study . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
104
4.5
PANAS Data Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . .
106
4.6
Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
107
Bibliography
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
113
Bibliography
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
113
ix

List of Figures
2.1
LPP2: posterior probability curves in favor of local H1k(t)s . . . . . . .
38
2.2
Posterior estimation of time-varying coeﬃcients
. . . . . . . . . . . . .
39
2.3
Boxplots: the number of global and local clusters
. . . . . . . . . . . .
45
2.4
DP: posterior probability curves in favor of local H1k(t)s
. . . . . . . .
46
3.1
A schematic overview of SBLFM
. . . . . . . . . . . . . . . . . . . . .
77
3.2
Right internal capsule tract description . . . . . . . . . . . . . . . . . .
78
3.3
RI: the gender eﬀects on FA and MD trajectories
. . . . . . . . . . . .
79
3.4
RI: the gestational age eﬀects on FA and MD trajectories . . . . . . . .
80
3.5
Right internal capsule tract: analysis of FA and MD . . . . . . . . . . .
81
3.6
Right internal capsule tract: analysis of λ1, λ2 and λ3 . . . . . . . . . .
82
3.7
Splenium tract description . . . . . . . . . . . . . . . . . . . . . . . . .
83
3.8
Splenium tract : analysis I of FA and MD
. . . . . . . . . . . . . . . .
84
3.9
Splenium tract: analysis II of FA and MD
. . . . . . . . . . . . . . . .
85
3.10 Splenium tract: analysis of λ1, λ2 and λ3 . . . . . . . . . . . . . . . . .
86
4.1
A circular structure of aﬀects classiﬁed into six clusters . . . . . . . . .
108
4.2
Performance of state labeling in the simulated data . . . . . . . . . . .
110
4.3
The classiﬁed states for the PANAS data.
. . . . . . . . . . . . . . . .
111
4.4
PANAS: plot of sin θs versus cos θs posteriori . . . . . . . . . . . . . . .
112
x

List of Tables
2.1
Comparison of LPP2 prior, DP prior and ﬁxed eﬀects model . . . . . .
37
2.2
Type I error rates and powers of the global hypothesis tests
. . . . . .
37
2.3
FDRs and powers of local hypothesis tests . . . . . . . . . . . . . . . .
37
2.4
The coverage rates of 95% conﬁdence band for 4 methods . . . . . . . .
37
3.1
Simulation study: FDR and power of the local hypothesis tests . . . . .
76
4.1
Simulation study: estimated directions for the synthetic data.
. . . . .
109
4.2
PANAS: the diﬀerence and the ratio between PE and NE scores . . . .
109
xi

List of Abbreviations
CRF
Chinese restaurant franchise
DP
Dirichlet process
DTI
Diﬀusion tensor imaging
FA
Fractional anisotropy
FDR
False discovery rate
FNR
False negative rate
HDP
Hierarchical Dirichlet process
iHMM
Inﬁnite state hidden Markov model
LPP
Local partition process
MCMC
Markov chain Monte Carlo
MD
Mean diﬀusivity
MDS
Multidimensional scaling
MRI
Magnetic resonance imaging
MSE
Mean squared error
PANAS
Positive and negative aﬀect schedule
SBLFM
Semiparametric Bayesian local functional models
TFs
Transcription factors
VM
Von Mises distribution
xii

Chapter 1
Introduction
Varying coeﬃcient models are a class of widely developed models. It was initially
introduced by Cleveland et al. (1991) to extend the applications of local regression
techniques from one-dimensional to multidimensional setting. Local regression models
were further extended by Hastie and Tibshirani (1993) to be formulated as varying
coeﬃcient models, which also tied generalized additive models and dynamic general-
ized linear model into one framework. Semivarying coeﬃcient models (Zhang et al.,
2002), mix-eﬀect varying coeﬃcient models (Liang et al., 2003), and random varying-
coeﬃcient models (Wu and Liang, 2004) were later developed to address diﬀerent sit-
uations. Semivarying coeﬃcient models allow the linear eﬀects of some predictors on
the outcomes. Random varying-coeﬃcient models assumes the subject-speciﬁc varying
coeﬃcient eﬀects, while mix-eﬀect varying coeﬃcient models allow both ﬁxed varying
coeﬃcient eﬀects and random varying coeﬃcient eﬀects.
Varying coeﬃcient models arise from various statistical contexts. The vast volume
of literature includes, among many others, Nicholls and Quinn (1982), Chen and Tsay
(1993) and Cai et al. (2000b) on non-linear time series, Hoover et al. (1998), Wu et al.
(1998) and Fan and Zhang (2000a) on longitudinal data analysis, Ramsay and Silverman
(1997) on functional data analysis, Gelfand and Vounatsou (2003), Baladandayuthapani

et al. (2008) on spatial data analysis, Lu et al. (2009) and Brezger et al. (2007a) on
varying coeﬃcient spatiotemporal model, Cleveland et al. (1991), Hastie and Tibshirani
(1993), Carroll et al. (1998), Kauermann and Tutz (1999), Xia and Li (1999), Zhang
and Lee (2000) and Fan and Zhang (1999, 2000b) on local multidimensional regression,
and Cai et al. (2000a) on generalized linear models with varying coeﬃcients.
In this dissertation, we ﬁrst review the existing literature in the rest of this chapter.
In Chapter 2, we propose semiparametric Bayes local additive models for the analysis
of longitudinal data. In Chapter 3, we develop a multivariate semiparametric Bayesian
local factor functional regression framework to analyze ﬁber tract data. In Chapter 4,
a semiparametric Bayesian state-space time-varying circumplex model is introduced to
analyze longitudinal circumplex data.
1.1
Frequentist Analysis of Varying Coeﬃcient Models
There are currently two major approaches to estimate the varying coeﬃcients, which are
kernel-local polynomial smoothing (Wu et al., 1998; Hoover et al., 1998; Fan and Zhang,
1999; Kauermann and Tutz, 1999), and spline smoothing (Hastie and Tibshirani, 1993;
Hoover et al., 1998; Chiang et al., 2001; Huang et al., 2002, 2004; Huang and Shen,
2004). We are going to outline these two approaches in the following subsections.
1.1.1
Kernel-local Polynomial Smoothing
Kernel local polynomial smoothing is a richly developed methodology associated with
a large amount of contributing literature; see for example Fan and Gijbels (1992, 1995,
1996), Fan (1993), Ruppert and Wand (1994), Fan et al. (1995), and Ruppert (1997).
Its main idea is based on Taylor expansion to locally approximate a smooth function
by a polynomial of some degree. Assume f(t) is a smooth function with a (p + 1)-st
continuous derivative for some positive integer p at an arbitrary ﬁxed point t0. The
2

f(t) can be locally approximated by a polynomial of degree p around a neighborhood
of t0, as in the form of Taylor expansion:
f(t) ≈f(t0) + (t −t0)f (1)(t0) + · · · + (t −t0)pf (p)(t0)/p!,
where f (r)(t0) is the r-th derivative of f(t) at t0.
Suppose that we have a set of data {Ui, XT
i , yi : i = 1, . . . , n} sampled from
(U, XT, y), we ﬁt a varying-coeﬃcient model of the form
y = XTa(U) + ϵ,
where E(ϵ) = 0, and V ar(ϵ) = σ2(U). The kernel local polynomial estimator ˆa(U) of
a(U) is obtained by minimizing
L(a, b) =
n
X
i=1
{yi −XT
i a −XT
i b1(Ui −u) −· · · −XT
i bp(Ui −u)}2Kh(Ui −u),
where Kh(t) = K(t/h)/h, K(t) is a kernel function, such as Epanechnikov kernel
K(t) = 0.75(1 −t2)+ and h is bandwidth.
Denote X = (X1, . . . , Xn)T, U u = (U1−u, . . . , Un−u), Γu = (X, U uX, . . . , U p
uX),
Y = (y1, . . . , yn)T, and Wu = diag(Kh(U1 −u), . . . , Kh(Un −u)). The one-stage kernel
local polynomial estimator ˆa(U) is given by
ˆa(U) = (1T
p ⊗Iq, 0q)(ΓT
uWuΓu)−1ΓT
uWuY.
Under some conditions, ˆa(U) is asymptotically normally distributed:
cov−1/2(ˆa(u)){ˆa(u) −a(u) −bias(ˆa(u))}
D→N(0, Iq),
3

where bias(ˆa(u)) = 2−1µ2a(2)(u)h2, cov(ˆa(u)) = {nhf(u)E(XXT|U = u)}−1ν0σ2(u),
and
D→denotes convergence in distribution. The bias of ˆa(U) comes from the approxi-
mation error of the linear approximation of a(u). In the asymptotic covariance matrix
of ˆa(U), the 2hf(u) is approximately the probability of U falling into the neighbour-
hood of u with radius h, and 2nhf(u) is approximately the expected number of Ui in
the neighbourhood of u.
Bandwidth selection is an important issue in kernel smoothing. Larger bandwidth
may gain on variance side, but loses on bias side. Smaller bandwidth may gain on bias
side, but loses on variance side. The basic idea of a data driven bandwidth selection
procedure is to ﬁnd an estimator of mean squared error (MSE) of ˆa(U) ﬁrst, and
then minimizes MSE with respect to bandwidth. The optimal bandwidth is the one
minimizing the MSE. Wu et al. (1998) and Hoover et al. (1998) proposed to use cross-
validation to select the bandwidth. Zhang and Lee (2000) systematically investigated
both variable bandwidth and constant bandwidth selection. For longitudinal data, it is
better to delete a whole subject rather than just a single observation when estimating
MSE(h).
1.1.2
Spline Smoothing
Three types of spline approaches have been developed for varying coeﬃcient models.
Such approaches include regression spline (Shi et al., 1996; Rice and Wu, 2001; Wu and
Zhang, 2002; Liang et al., 2003), penalized spline (Eilers and Marx, 1996; Kauermann,
2005) and smoothing spline (Hoover et al., 1998; Brumback and Rice, 1998; Chiang
et al., 2001; Eubank et al., 2004). The key idea of these approaches is to express varying
coeﬃcient functional eﬀect as a linear combination of some spline bases. However, they
diﬀer from each other in the number of knots and penalization.
Regression spline
methods and penalized spline methods usually use fewer knots than smoothing spline
4

methods. The smoothness of regression spline methods is controlled by the number
of the associated basis functions. When the number of pre-speciﬁed basis functions is
large, it is very challenging to ﬁt the regression spline models due to high-dimensionality
and roughness.
The penalized spline method uses two truncated power bases and
penalizes the high order derivative of the associated regression splines. In contrast, the
smoothing spline method penalizes the roughness of the resultant functions. For the
sake of space, we are going to brieﬂy review the smoothing spline method as follows.
Suppose that we have a set of longitudinal sample (yij, xij, zij, tij), for i = 1, . . . , n,
and j = 1, ..., ni, where xi(tij) = (xij0, . . . , xijK)T, zi(tij) = (zij0, . . . , zijM)T and
(yij, xij, zij, tij) denote the jth outcome, two set of covariates and time design points,
respectively, of the ith subject.
We ﬁt a nonparametric mixed eﬀects time-varying
coeﬃcient model:
yij = xi(tij)Tβ(tij) + zi(tij)Tvi(tij) + ϵi(tij),
(1.1)
where β(t) = (β0(t), . . . , βK(t))T are smooth ﬁxed eﬀects of interest, vi(t) = (vi0(t), . . . , viM(t))T
are random eﬀects sampled from a Gaussian process with zero mean and Γ covariance
function, ϵi(t) is a zero-mean stochastic process, and vi(t) and ϵi(t) are independent.
We use the cubic smoothing spline method to estimate the ﬁxed eﬀects and the random
eﬀects:
βk(tij) = hT
ijβk, k = 0, 1, . . . , K,
vim(tij) = hT
ijvim, m = 0, 1, . . . , M,
where βk = (βk(τ1), . . . , βk(τL))T denotes the values of βk(t) at a set of design knots
τ1, . . . , τL, vim = (vim(τ1), . . . , vim(τL))T denotes the values of vim(t) at τ1, . . . , τL, and
hij denote a L-dimensional unit vector whose l-th entry is 1 if tij = τl and 0 otherwise.
5

Let β = (βT
0 , . . . , βT
K)T, vi = (vT
i0, . . . , vT
iM)T, xij = xi(tij) ⊗hij, zij = zi(tij) ⊗hij,
Xi = (xi1, . . . , xini)T, Zi = (zi1, . . . , zini)T, yi = (yi1, . . . , yini)T, and ϵi = (ϵi1, . . . , ϵini)T.
Then the nonparametric mixed eﬀect time-varying coeﬃcient model (1.1) can be ex-
pressed as
yi = Xiβ + Zivi + ϵi, ϵi ∼Nni(0, Ri), vi ∼N(M+1)L(0, D).
If the components of β(t) and vi(t)s are twice continuously diﬀerentiable and their
second derivatives are square integrable, the cubic spline smoothing estimator ˆβk(t) of
βk(t) is the least square minimizer of the following penalized generalized log-likelihood:
J(β, {vi}n
i=1, λ)
=
n
X
i=1
(yi −Xiβ −Zivi)TR−1
i (yi −Xiβ −Zivi)
+
n
X
i=1
M
X
m=0
λim
Z b
a
[v
′′
im(t)]2dt +
K
X
k=0
λk
Z b
a
[β
′′
k(t)]2dt,
where λk, k = 0, . . . , K, λim, i = 1, . . . , n, m = 0, . . . , M, are the positive smoothing
parameters. The ﬁrst summation term being proportional to the twice negative loga-
rithm of the generalized likelihood represents the goodness of ﬁt. The second term is
the weighted sum of the roughness of all the random-eﬀect coeﬃcient functions, and the
third term is the weighted sum of the roughness of all the ﬁx-eﬀect coeﬃcient functions.
The smoothing parameters λk, k = 0, . . . , K, and λim, i = 1, . . . , n, m = 0, . . . , M, are
used to trade oﬀthe goodness of ﬁt with the roughness of the smoothing spline esti-
mators.
A major problem of smoothing spline technique is the choice of the optimal smooth-
ing parameters to achieve the best performance of the resulting estimators. The “leave-
one-subject-out” cross-validation (SCV) rule (Rice and Silverman, 1991; Hoover et al.,
1998) is the most popular smoothing parameter selector. The idea is to minimize the
6

weighted sum of mean square errors associated with deletion of each subject, called
SCV rule, with respect to the smoothing parameters. The advantages of SCV include:
(i) deletion of the entire data for one subject at a time preserves the within-subject
correlation of the data; (ii) SCV does not require to specify the within-subject corre-
lation structure. However, it is challenging to minimize SCV rule when the number of
smoothing parameters is large. Alternatively, the “leave-one-point-out” cross-validation
(PCV) rule is used in Wang and Taylor (1995) and Eubank et al. (2004) among many
others. The key advantage of PCV is less computationally intensive with no need to
repeatedly compute the estimators. The drawback of PCV is the lack of accounting for
the within-subject correlation.
1.2
Bayesian Analysis of Varying Coeﬃcient Models
There are two major approaches to model varying coeﬃcients from nonparametric
Bayesian perspective, which are basis expansion methods (Rajan and Rayner, 1996;
Lee and Shaddick, 2007; Brezger et al., 2007b; Huang et al., 2008; Malloy et al., 2010)
and stochastic process mothods (Marina et al., 2008; He et al., 2010; Berrocal et al.,
2010; Reich et al., 2010). Bayesian basis expansion methods approximately express
any function g as g(·) = P
h bhfh(·) by some chose basis f = {f1, f2, f3, . . .}, such as
spline, wavelet and Fourier bases. The random function g can thus be parametrized
by the basis coeﬃcient vector b = (b1, b2, . . .). Specifying a prior probability model on
b implicitly induces a prior probability model on the random function. Alternatively,
stochastic process priors have been proposed as nonparametric prior distributions to
model varying coeﬃcient functions, including Gaussian process and random walk. In
the following subsections, we are going to focus on reviewing Bayesian spline models
and random eﬀects models with Dirichlet Process (DP).
7

1.2.1
Bayesian Spline Models
Bayesian spline models have been studied in the literature for Bayesian regression
splines and Bayesian penalized splines. For the literature of Bayesian regression splines,
please refer to Denison et al. (1998b) and Hastie and Tibshirani (2000) among many
others. For the work related to Bayesian penalized splines, see Biller and Fahrmeir
(1997), Fahrmeir and Lang (2001), Brezger and Lang (2006), and Fahrmeir et al. (2004)
for a brief view.
To estimate βk(t) in the model (1.1), a common cubic regression splines is to express
βk(t) as
βk(t) =
X
bhfh(t),
where f(t) = (1, x, x2, x3, (t −ξ1)3
+, . . . , (t −ξT)3
+) is the set of basis functions with
(x)+ = max(x, 0) and ξ = (ξ1, . . . , ξT) is a set of knots . The Bayesian speciﬁcation is
completed by placing a prior p(ξ, b, σ) on the sets of knots and basis function coeﬃcients.
Relevant work can be found at Smith and Kohn (1996), Denison et al. (1998b) and
Dimatteo et al. (2001). The strategy is to factor the prior p(ξ, b, σ) = p(ξ)p(σ)p(b|σ).
Zellner g-prior (Zellner, 1986) is used by Smith and Kohn (1996) for p(b). Assuming
a conjugate normal prior b ∼N(0, cσ(BTB)−1) with B is the design matrix in the
sampled data set, the condition posterior mean E(b|ξ, σ) is the linear shrinkage of the
least square estimator ˆb. Dimatteo et al. (2001) chose a scalar c such that the prior
variance in the Zellner g-prior equals to the information from one observation. Denison
et al. (1998b) uses least square estimates of b conditioning on y and other parameters,
which is equivalent to assigning a ridge prior b ∼N(0, V ) with V = diag(∞, v, . . . , v).
Posterior computation typically proceeds via reversible jump MCMC (Green, 1995).
Denison et al. (1998a) use ”birth,” ”death” and ”move” decisions to add, delete and
8

change knots in each iteration. It is important in updating ξ posteriori to marginalize
ξ with respect to the coeﬃcients b. With the conjugate normal prior for b, the marginal
posterior p(ξ|σ, y) can be evaluate analytically. Smith and Kohn (1998) proposed an
interesting alternative, called focused sampling, for posterior computation.
1.2.2
Random Eﬀects Models with Dirichlet Process
To estimate the random eﬀects vim(t) in model (1.1), a popular option is to use ba-
sis expansion to express vim(t) as a linear combination of a set of pre-speciﬁed basis
functions:
vim(t) =
p
X
h=1
θihfh(t),
where θi = (θi1, . . . , θip)T are basis coeﬃcients speciﬁc to the ith subject, and f(t) =
{f1(t), . . . , fp(t)} is a set of basis functions. Similar to the previous subsection, we
specify a set of cubic spline basis functions for f = (1, x, x2, x3, (t−ξ1)3
+, . . . , (t−ξT)3
+),
in which ξ = (ξ1, . . . , ξT) is a set of knots and (x)+ returns 0 for negative x and x for
positive x.
A Bayesian nonparametric speciﬁcation is completed by placing a DP prior for
the distribution of the random basis coeﬃcients vector θi. Assume θi ∼Q with Q
unknown, DP(αQ0) models Q as inﬁnite mixtures of point masses through a stick-
breaking representation:
Q
=
∞
X
h=1
whδθh(·), θh
i.i.d
∼Q0,
wh
=
Uh
Y
j<h
(1 −Uj), Uh
i.i.d
∼Beta(1, α),
where wh is a probability weight formulated from a stick-breaking procedure, δθ(·)
9

denotes a point mass at θ which is sampled from Q0, Q0 is a p-dimensional central
probability measure as a prior guess, and α is a precision parameter expressing conﬁ-
dence in the prior guess. Under this formulation, the probability of θi allocated to δθ(·)
is equivalent to wh.
An important property of DP prior for Q is the discrete nature of Q. This speciﬁ-
cation creates ties among θis, i = 1, . . . , n, such that each subject is allocated into one
of k ≤n clusters. Subjects allocated to the same cluster have the same random eﬀects
value. Denote Si = j for the ith subject assigned to cluster j. All subjects having
Si = j have θi = θ∗
h, where θ∗
h denotes the value taken by the random basis coeﬃcients
vector of all subjects in cluster j. Hence, all subject in the same cluster have identical
random eﬀects vim(t) which equals to f(t)θ∗
h.
The standard approach for posterior computation is based on Markov chain Monte
Carlo (MCMC) algorithms. Three major types of MCMC algorithms have been pro-
posed, which are collapsed Gibbs sampler (Maceachern, 1994), the blocked Gibbs sam-
pler (Ishwaran and James, 2001), and reversible jump-type approaches (Jain and Neal,
2004; Dahl, 2007). The collapsed Gibbs sampler avoids updating the inﬁnitely many
parameters through marginalizing out Q, which is based on the P´olya urn scheme of
Blackwell and MacQueen (1973). The blocked Gibbs sampler uses truncation of the
stick-breaking procedure to approximate Q. To avoid truncation, Walker (2007) pro-
posed a slice sampling approach and Papaspiliopoulos and Roberts (2008) proposed a
retrospective MCMC algorithm. Further, Papaspiliopoulos (2008) proposed an eﬃcient
exact block Gibbs sampler which combines the advantages of the retrospective MCMC
method and the slice sampling method.
10

1.3
Applications
The evolution of the varying coeﬃcient models is deeply rooted in applications and
reﬂects the increasingly large and complex problems that are arising in science and
industry. They have been successfully applied to many scientiﬁc areas, including eco-
nomics, ﬁnance, politics, epidemiology, medical science, ecology and so on. This pro-
posal focuses on the applications of the varying coeﬃcient models in biomedicine and
epidemiology areas. They arise from diﬀerent statistical contexts, such as the analysis
of longitudinal data, survival data, spatial data, functional data, genetics data and
imaging data. We are going to brieﬂy review the time-varying coeﬃcient models in the
analysis of longitudinal data and survival data in the following subsections.
1.3.1
Analysis of Longitudinal Data with Time-Varying
Coeﬃcient Models
In the analysis of longitudinal data from biomedicine and epidemiology studies, it
is of highly interest to study the patterns of time-varying variables, such as disease
progression or trends of health status. Longitudinal data usually consist of repeatedly
measured outcomes and covariates from a random sample of subjects measured over
time. One statistical focus in analyzing longitudinal data is to assess the time-varying
impacts of covariates on outcome trajectories, where the covariates might or might not
be time dependent. Thus nonparametric varying-coeﬃcient models become particularly
useful in longitudinal analyses.
A longitudinal sample is typically denoted by (yij, xij, zij, tij), for i = 1, . . . , n,
and j = 1, ..., ni, where xi(tij) = (xij0, . . . , xijK)T, zi(tij) = (zij0, . . . , zijM)T and
(yij, xij, zij, tij) denote the jth outcome, two set of covariates and time design points,
respectively, of the ith subject. To examine whether the associations of covariates with
11

outcomes change over time, we can ﬁt a ﬁxed-eﬀect varying coeﬃcient model (Brum-
back and Rice, 1998; Hoover et al., 1998), or a mix-eﬀect varying coeﬃcient model
(Liang et al., 2003) as the above model (1.1), or a random varying-coeﬀcient model
(Wu and Liang, 2004). The time-varying coeﬃcients can be estimated by the kernel,
polynomial and smoothing spline methods.
The issue of incorporating the within subject correlation structure into the esti-
mation procedure is important in longitudinal data analysis. Lin and Carroll (2001)
addressed this situation in the nonparametric ﬁxed eﬀects time-varying coeﬃcient mod-
els.
The studies of the estimation of the within subject correlation structure were
systematically considered by Fan et al. (2007) and Sun et al. (2007).
Missing data has been an important topic in long term longitudinal studies. Hogan
et al. (2004) studied the mixtures of varying coeﬃcient models for longitudinal data
having discrete or continuous nonignorable dropout.
1.3.2
Analysis of Survival Data with Time-Varying Coeﬃcient
Models
Survival analysis concerns the failure time to some event, such as failure of a machine
component, death of a patient, or recurrence of prostate cancer of a male patient.
The Cox proportional hazard (PH) model (Cox, 1972) is the most popular model in
the analysis of survival data. However, it doesn’t address any potential possible dy-
namic feature in the data set. Varying coeﬃcient proportional hazard function models
ﬁrst introduced by Hastie and Tibshirani (1993) can be used to address any dynamic
structure.
Suppose that we have a survival sample (Ui, XT
i , yi, δi), i = 1, . . . , n, where yi =
min(Ti, Ci), δi = I(Ti > Ci), Ti and Ci are respectively the survival time and censoring
12

time of the ith subject, and Ui is a scalar covariate.
We assume a noninformative
censoring mechanism. The distinct failure times are denoted by t(1) < . . . < t(L), with
dl individuals failing at t(l) for l = 1, . . . , L. We ﬁt a varying coeﬃcient proportional
hazard function model (Zhang and Steele, 2004) as follows:
h(t|X, U) = h0(t) exp{XTa(U)}.
For any give u, the local partial likelihood estimator (Fan et al., 2006) of a(u) is
obtained by maximizing the following local partial log-likelihood function
L
X
l=1
 X
j∈Dl
Kh(Uj −u)
"
XT
j {a + b(Uj −u)} −log
 X
k∈Rl
exp[XT
k {a + b(Uj −u)}]Kh(Uk −u)
!#!
,
where Rl is the set of indices for the individuals at risk up to time t(l), and Dl is the
set of indices for the events at t(l).
For independent data, kernel estimation of the semiparametric varying-coeﬃcient
proportional hazard function models have been studied by Cai and Sun (2003), Tian
et al. (2005), and Fan et al. (2006), and spline estimation was studied by Ahmad et al.
(2005). Other related works include Zucker and Karr (1990), and Winnett and Sasieni
(2003). There are several nonparametric regression models for clustered failure time
data.
Under the assumption of independence, Cai et al. (2007) investigated kernel
smoothing properties for varying coeﬃcient models for multivariate survival data with
stratiﬁed baseline hazards. Yu and Lin (2008) studied weighted local polynomial kernel
estimating equations for clustered failure time data. They concluded the most eﬃcient
local polynomial kernel estimator can be attained by silencing the within-cluster cor-
relation. Yu and Lin (2010) studied the performance of proﬁle-kernel estimators of the
nonparametric time-varying coeﬃcients in a semiparametric time-varying coeﬃcient
model for clustered survival data under working independence, and showed that they
13

are semiparametric eﬃcient for independent data.
14

Chapter 2
Semiparametric Bayes local additive
models for longitudinal data
2.1
Introduction
Longitudinal data arise frequently in biomedical ﬁelds when subjects are repeatedly
measured over time. To study the time pattern of covariate eﬀects on an outcome
variable, time-varying coeﬃcient models are commonly used since their formal intro-
duction to the statistical literature by Hastie and Tibshirani (1993). Nonparametric
regression methods to estimate time-varying coeﬃcient functions have been developed
by Hoover et al. (1998), and Lin and Ying (2001) among many others.
Please re-
fer to Wu and Zhang (2006) and Fan and Zhang (2008) for comprehensive reviews of
statistical procedures for varying coeﬃcient models.
We focus on a random time-varying coeﬃcient model:
Yij = βi0(tij) + X′
iβi(tij) + ϵi(tij),
i = 1, . . . , n, j = 1, . . . , mi, tij ∈[0, T],
(2.1)
where Yij is the observed response variable, Xi is a K × 1 covariate vector for the i-th
subject, βi0(tij) is a subject-speciﬁc baseline and βi(tij) = (βi1(tij), . . . , βiK(tij))′ is a

K × 1 covariate eﬀect vector for the i-th subject at time tij. To estimate the unknown
functions βi0(t) and βi(t) in model (2.1), a common approach is to express them as
linear combinations of some pre-speciﬁed basis functions. Heterogeneity in the curves
is then controlled by the variation of their basis coeﬃcients which are usually treated as
random eﬀects and follow a speciﬁc random eﬀects distribution. A concern rises about
the sensitivity of associated inferences to the choice of the random eﬀects distribution
on the basis coeﬃcients.
There is a rich Bayesian nonparametric literature associated with modelling ran-
dom eﬀects.
It has now become routine to use Dirichlet process (DP) priors (Fer-
guson, 1973, 1974) and DP mixtures (DPM) (LO, 1984; Escobar and West, 1995)
for random eﬀects distributions in Bayesian hierarchical models. For important early
references, refer to Bush and MacEachern (1996), M¨uller and Rosner (1997) and Klein-
man and Ibrahim (1998).
Cruz-Mes´ıa et al. (2007) adopted an analysis-of-variance
dependent DP (De Iorio et al., 2004) for the problem of sequential classiﬁcation anal-
ysis. Ohlssen et al. (2007) provide a review and tutorial on the practical use of such
approaches, and the DPpackage in R is now available for routine use (http://cran.r-
project.org/web/packages/DPpackage/index.html).
It is important to capture the local structure of similarity and deviation among sub-
jects in detecting the signals for model (2.1). The DP prior assumes the random eﬀects
distribution P ∼DP(αP0), where P0 is the base distribution and α is a concentration
parameter. Subjects are partitioned into clusters with the number of sample clusters
being proportional to α log n. Small α favors few clusters to be occupied leading to
substantial borrowing of information across subjects within a cluster in estimating the
basis coeﬃcients. A drawback of the DP prior is the assumption of global clustering.
Two subjects are either allocated to a common cluster or two diﬀerent clusters. It is
common in reality that two subjects have similar trajectories in certain time periods
16

while having local deviations. In such situations, DP priors either inappropriately allo-
cate two subjects to a common cluster, obscuring the local diﬀerences or assigns them
to two separate clusters. Dunson (2009) proposed a local partition process (LPP) prior
on random eﬀects, which allows both global and local clustering. The LPP prior leads
to borrowing of information in estimating the basis coeﬃcients and can accommodate
basis selection to address the curse of dimensionality.
Characterizing local features has been an important focus in functional data anal-
ysis. Representative Bayesian semiparametric approaches include Bayesian wavelet-
based functional mixed modeling (Morris and Carroll, 2006), random eﬀects models
relying on adaptive basis function representations (Thompson and Rosen, 2008; Botts
and Daniels, 2008) and hierarchical Gaussian processes (Behseta et al., 2005). A hybrid
Dirichlet mixture model (Petrone et al., 2009) was proposed to distinguish functional
local features by characterizing individual functions as a patchwork of segments which
are locally drawn from a collection of global GP realizations. We propose to capture
the local features through assigning an LPP prior on the random eﬀects distribution
of the basis function coeﬃcients, where a pre-speciﬁed set of basis functions are as-
sumed to linearly span the unknown time-varying coeﬃcient functions βi0(t) and βik(t),
k = 1, . . . , K.
The motivating application for this chapter is a yeast cell-cycle gene expression data
set. The expression proﬁles of 297 genes identiﬁed as cell cycle-regulated genes in the
genome of Saccharomyces cerevisiae were measured over 2 cell cycles. Since transcrip-
tion factors (TFs) are key elements controlling the movement of genetic information
from DNA to mRNA at cell-cycle level transcription, it is important to capture the dy-
namic behavior of gene expression regulated by TFs. In addition, cell cycle-regulated
genes are involved in diﬀerent processes such as DNA synthesis, budding, and cytoki-
nesis (Spellman et al., 1998) in each cell cycle, implying diﬀerent expression behaviors
17

of diﬀerent genes. Typical analyses assume a common time-varying behavior for all the
genes (Wang et al., 2007, 2008). We propose to use our random time-varying coeﬃ-
cient model with LPP prior to determine the gene-speciﬁc time-varying TF regulating
course.
Considering TFs regulating cell cycle-regulated genes which are active at diﬀerent
biological processes, it is important to develop a local inference approach to determine
TFs-regulated time windows. Current Bayesian varying-coeﬃcient models allow regres-
sion coeﬃcient to vary with time and/or spatial location (refer to Lee and Shaddick
(2007) for a recent reference). Such approaches can be used to obtain a posterior mean
estimate of the varying coeﬃcient curve, as well as pointwise 95% credible intervals.
However, formal Bayesian hypothesis testing of local signiﬁcance of a predictor within
a given time window is not considered. Although one can potentially identify time
regions across which the pointwise credible bands do not include zero as potentially
signiﬁcant, this may lead to an inﬂated type I error rate.
The goals of this chapter cover three aspects. The ﬁrst applies the LPP prior to
the random eﬀects distributions in the random time-varying coeﬃcient model (2.1)
to facilitate global and local borrowing of information among subjects. The second
constructs a Bayesian conﬁdence band for the mean time-varying eﬀect of the predictor.
The third develops a Bayesian local hypothesis testing approach to examine if and where
the predictor has signiﬁcant impact on an outcome trajectory. Multiplicity issues arising
from pointwise inference is accounted for by controlling false discovery rate (FDR).
In this chapter, section 2.2 introduces the model and associated inferences motivated
by the above considerations. Section 2.3 introduces an MCMC algorithm for posterior
computation. Subsection 2.4 is for an illustrative simulation. Section 2.5 applies the
model to a yeast cell-cycle gene data set data set. Section 2.6 makes some further
discussion.
18

2.2
Semiparametric Bayes Local Additive Model
2.2.1
LPP2 prior
Dunson (2009) proposed a class of local partition process priors (LPP) for unknown
random eﬀects distributions to facilitate both global and local clustering of random
eﬀects, providing a generalization of the widely-used Dirichlet process prior that avoids
the global clustering assumption. Our focus is on the simpler LPP2 prior, which is
reviewed below.
Sample two collections of independent and identically distributed p-dimensional
random elements Θgh = (Θg,h,1, . . . , Θg,h,p)′, g = 0, 1, h = 1, . . . , ∞, from a base dis-
tribution P0. Denote Ξ0 = {Θ0h}∞
h=1 for the global family of coeﬃcient vectors and
Ξ1 = {Θ1h}∞
h=1 for the local family.
Introduce a p-dimensional indices vector z =
(z1, . . . , zp)′ for the allocation to global clustering or local clustering, with zj ∼Ber(νj)
(Ber: Bernoulli) independently, taking the value of 1 for global clustering and 0 for local
clustering, j = 1, . . . , p. Deﬁne a p × 2 local cluster indices matrix ψ = (ψ′
1, . . . , ψ′
p)′,
with ψj = (1 −zj, φj) and φj ∈{1, . . . , ∞}, j = 1, . . . , p. A corresponding hybrid atom
Θψ = (Θψ1,1, . . . , Θψp,p)′ is obtained by setting the jth element of Θψ equal to Θψj,j.
Considering n vectors of p-dimensional random eﬀects for n subjects, θi = (θi1, . . . , θip)′ ∼
P with P unknown, i = 1, . . . , n, LPP2 prior models P as a hybrid mixture distribution:
P =
1
X
z1=0
(1−z1,∞)
X
ψ1=(1−z1,1)
· · ·
1
X
zp=0
(1−zp,∞)
X
ψp=(1−zp,1)
πψ1,...,ψpδΘψ,
(2.2)
where δx denotes a degenerate distribution with all its mass at x, πψ1,...,ψp is the prob-
ability of θi = Θψ that πψ1,...,ψp ≥0 and
1P
z1=0
(1−z1,∞)
P
ψ1=(1−z1,1)
· · ·
1P
zp=0
(1−zp,∞)
P
ψp=(1−zp,1)
πψ1,...,ψp = 1.
Let πh denote Pr(θij = Θg,h,j), g = 0, 1, h = 1, . . . , ∞, j = 1, . . . , p. Those random
eﬀects having zj = 1 are speciﬁed to be allocated together to a component in the
19

global family Ξ0, while others having zj = 0 are speciﬁed to be allocated to their own
component in the local family Ξ1. Let J0 = {j : zj = 1} and J1 = {j : zj = 0}.
Conditional on the values of z,
Pr(ψj = (0, h), j ∈J0|z1, . . . , zp) = πh, h = 1, . . . , ∞,
Pr(ψj = (1, hj), j ∈J1|z1, . . . , zp) =
Y
j∈J1
πhj, hj = 1, . . . , ∞.
The allocation probability of θi = Θψ in (3.8) is then simply
πψ1,...,ψp = Pr(ψ1 = (1 −z1, h1), . . . , ψp = (1 −zp, hp)) = πh
 Y
j∈J1
πhj

p
Y
j=1
ν
zj
j (1 −νj)1−zj

.
The speciﬁcation is completed by choosing the hyperpriors
νj ∼Beta(1, γ),
j = 1, . . . , p,
πh = π∗
h
Y
l<h
(1 −π∗
l ),
π∗
h ∼Beta(1, α),
h = 1, . . . , ∞,
j = 0, 1, . . . , p,
where γ controls the overall weight on the local family, and α controls the overall
number of clusters. As shorthand the LPP prior is denoted P ∼LPP2(α, γ, P0).
The LPP2 prior speciﬁcation (3.8) can also be viewed as a hybrid mixture model of
inﬁnitely many components drawn from P0 via 2-stage clustering. Stage 1 determines
the membership of global or local clustering for each of the p components.
Those
components allocated to the global clustering membership will be clustered together
to an atom in the global family at stage 2, while those allocated to the local family
will be allocated individually to their own clusters.
The joint cluster membership
probability at stage 1 corresponds to Pr(z1, . . . , zp) = Qp
j=1 ν
zj
j
(1 −νj)1−zj. The joint
cluster allocation weight at stage 2 conditional on stage 1 corresponds to Pr(ψ1 =
(1 −z1, h1), . . . , ψp = (1 −zp, hp)|z1, . . . , zp). The overall joint cluster allocation weight
20

corresponds to πψ1,...,ψp.
2.2.2
The Model
We propose a semiparametric Bayesian local additive model for the analysis of repeated
measurements. Considering a functional response Yi(t) for the ith subject i = 1, . . . , n,
we rewrite model (2.1) as
Yi(t) = βi0(t) +
K
X
k=1
βik(t)xik + ϵi(t),
ϵi(t) ∼N(0, τ −1),
(2.3)
where βi0(t) is the ith subject’s baseline curve, βik(t) is the ith subject’s time-varying
coeﬃcient for the kth predictor xik, xik is normalized, and the measurement error pro-
cess ϵi(t) is a realization of an uncorrelated zero-mean Gaussian process with variance
τ −1.
Similar to Huang et al. (2002), we consider basis expansion to estimate the time-
varying coeﬃcient regression functions. Assume that {βik(t)}K
k=0 can be expressed as a
linear combination of basis functions as follows:
βik(t) =
pk
X
l=1
θiklbkl(t) = bik(t)′θik,
(2.4)
where θik = (θik1, . . . , θikpk)′ and the basis functions bk(t) = (bk1(t), . . . , bkpk(t))′. Var-
ious basis systems can be applied, including Fourier bases, polynomial bases, Wavelet
bases, and B-spline bases such as cubic B-spline bases. For computational convenience,
we let the basis function bk(t) ≡b(t) = (b1(t), · · · , bp(t))′ and pk ≡p for all k. We
specify Gaussian kernel as the basis functions b1(t) = 1, bj+1(t) = exp(−ζ||t −ηj||2),
j = 1, . . . , p −1, where η1, . . . , ηp−1 are equally spaced kernel locations and ζ = 25. Let
21

θi = (θ′
i1, · · · , θ′
iK)′ and Bi(t) = (b(t)′xi1, · · · , b(t)′xiK)′, model (2.3) can be written as
Yi(t) = b(t)′θi0 + Bi(t)′θi + ϵi(t).
(2.5)
A Bayesian speciﬁcation of our model is completed with LPP2 priors for the distri-
butions of the random eﬀects, {θik}K
k=0. Assuming θi0 ∼P and θi ∼˜P with P and ˜P
unknown and independent, we let:
P
∼
LPP2(α0, γ0, P0)
˜P
∼
LPP2(α1, γ1, ⊗{P0k}K
k=1), P0k = P0,
(2.6)
where the prior guess is around a p-dimensional parametric base distribution P0, and
(α0, α1) and (γ0, γ1) are hyperparameters, with (α0, α1) characterizing concentration
around the prior guess and (γ0, γ1) determining the overall allocation weight on the
local family. These hyperparameters impact the induced global and local clustering
structure, and by choosing hyperpriors we allow a high degree of data adaptivity.
Considering the potentially varied shapes of the time-varying functions, we devise to
automatically select among a large number of pre-speciﬁed potential basis functions and
accommodate uncertainty in basis function selection by choosing a shrinkage prior for
the basis coeﬃcients. To achieve the shrinkage property, we specify the base distribution
P0 as:
P0 :
θik ∼Np(0p×1, Λ−1),
i = 1, . . . , n,
k = 0, 1, . . . , K.
(2.7)
Λ = diag(λ1, · · · , λp) with λl ∼G(0.5, 0.5). To allow borrowing information across co-
eﬃcients over the degree of shrinkage, we prefer λl = λ, a common λ across coeﬃcients.
This speciﬁcation leads to light-tails feature of P0 a priori and approximately Gaussian
feature a posteriori. The coeﬃcients for unnecessary basis functions are shrunk to zero
22

a posteriori, while the coeﬃcients for signiﬁcant basis functions fall in the tails. If
too many unnecessary basis functions are included, Λ will be over-estimated and the
coeﬃcients for important basis functions will be heavily shrunk.
2.2.3
Induced Properties
The LPP2(α, γ, P0) prior on the random eﬀects distribution constructs a nonparametric
prior for the time-varying coeﬃcient functions in the model speciﬁed through (2.3) −
(2.7). Considering a generic unknown function
f(t) =
p
X
j=1
ϑjbj(t) = B(t)′ϑ,
with t ∈[0, T], ϑ = (ϑ1, . . . , ϑp)′ and assuming ϑ ∼P, P ∼LPP2(α, γ, P0), with P0
deﬁned as in (2.7), the induced prior presents the following properties.
Proposition 2.2.1. Conditional on Λ−1 = diag{λ−1
1 , . . . , λ−1
p },
(f(t1), f(t2), . . . , f(tL))′|Λ−1 ∼NL(0L×1, ΣL×L)
with ΣL×L = [σij], i = 1, . . . , L, j = 1, . . . , L, and σij = B(ti)′Λ−1B(tj).
Further,
Corr(f(t1), f(t2)|Λ−1) =
B(t1)′Λ−1B(t2)
(B(t1)′Λ−1B(t1))1/2(B(t2)′Λ−1B(t2))1/2.
According to the Cauchy-Schwarz inequality, the correlation is bounded above by 1
and converges to 1 as t1 →t2. An appealing property of the induced prior is, when
λ1 = . . . = λp = λ,
Corr(f(t1), f(t2)|λ) =
B(t1)′B(t2)
(B(t1)′B(t1))1/2(B(t2)′B(t2))1/2,
23

which depends only on the set of basis functions and not the base measure P0. When a
local basis is chosen, such as B-splines or Gaussian kernels, a local dependence structure
will result with the correlation between f(t1) and f(t2) decaying to close to zero as t1
and t2 move further apart. We can extend this correlation structure for long-range
dependencies by accommodating non-diagonal Λ or choosing Fourier bases.
From the above, it follows directly that the LPP2(α, γ, P0) prior on the distribution
of the basis coeﬃcients leads to baseline and time-varying coeﬃcient functions that are
assigned Gaussian process priors marginally. In particular, the curves for individual
subjects are drawn from a Gaussian process with mean function m(t) = 0 and covari-
ance function c(t1, t2) = B(t1)′Λ−1B(t2). By specifying hyperpriors on the parameters
in Λ, the data inform about the parameters in the covariance function. Although the
marginal prior for the individual curves is a Gaussian process, the marginal distribution
across subjects is nonparametric and highly ﬂexible, so the variation among subjects is
not restricted to be Gaussian.
2.2.4
Hypothesis Formulation & Testing
We are interested in testing the null hypotheses that a predictor has no eﬀect at a
particular time or interval of times, and that there are time intervals across which the
predictor has no eﬀect. We provide a local interval null hypothesis testing approach
to make pointwise inference for the predictor eﬀects over time. The local null and
alternative hypotheses for the kth predictor eﬀect speciﬁc to a time point t ∈[0, T] are
formulated as:
H0k(t) :
βk(t)
 ≤ϵ, versus H1k(t) :
βk(t)
 > ϵ,
24

where βk(t) represents the mean of the subject-speciﬁc time-varying coeﬃcients for the
kth predictor at time t. To test whether the average time-varying coeﬃcient curve for
the kth predictor deviates from a small neighborhood of zero anywhere in time interval
[0, T], the global null and alternative hypotheses are formulated as
H0k :
βk(t)
 ≤ϵ, for all t ∈[0, T]
H1k :
βk(t)
 > ϵ, for any t ∈[0, T].
The global null hypothesis is the intersection of all the local null hypotheses. Any
rejection of a local null hypothesis leads to the rejection of the global null hypothesis.
We choose a suitable small value 0.05 for ϵ as our default, noting again that the data
have been normalized.
To conduct local hypotheses testing, we use the Bayesian decision rule for multiple
testing proposed by M¨uller et al (2004). Following the implementation in Wang &
Dunson (2010), our strategy is to reject H0k(t) if the posterior alternative hypothesis
probability υkt = Pr(H1k(t)|Data) ≥r for any t ∈[0, T], with r as a common threshold
for all the local hypotheses. r is chosen to minimize the posterior expected false negative
rate (FNR) under the constraint of the posterior expected false discovery rate (FDR)
being no greater than αT, where αT is pre-speciﬁed (we focus on a value of 0.05).
Denote dkt = 1(υkt ≥r), an indicator of rejecting H0k(t). The posterior expected FNR
and FDR are calculated as:
FNR =
PK
k=1
R T
0 (1 −dkt)υktdt
K
R T
0 dt −PK
k=1
R T
0 dktdt + κ0
≈
PK
k=1
Ptm
t=t1(1 −dkt)υktT/m
KT −PK
k=1
Ptm
t=t1 dktT/m + κ0
,
FDR =
PK
k=1
R T
0 dkt(1 −υkt)dt
PK
k=1
R T
0 dktdt + κ0
≈
PK
k=1
Ptm
t=t1 dkt(1 −υkt)T/m
PK
k=1
Ptm
t=t1 dktT/m + κ0
,
where t1, . . . , tm is a ﬁne grid of times equally spaced along [0, T] and κ0 is a small
25

positive constant to avoid a zero denominator. In summary, our decision rule is to
determine the optimal threshold r∗by r∗= argmin FNR{r ∈[0, 1], FDR ≤αT}.
For each combination of k and t ∈{t1, . . . , tm}, we reject H0k(t) if υkt ≥r∗. For a
suﬃciently ﬁne grid of m ≥10, the results are robust to m, with the optimal threshold
appropriately adapting to the chosen m.
2.2.5
Bayesian Conﬁdence Band
We focus on constructing a Bayesian simultaneous conﬁdence band for the mean coeﬃ-
cient curve βk(t), k = 1, . . . , K, from its posterior MCMC samples. Assuming there is
a collection of posterior sampled curves βs
k = (βs
k(t1), . . . , βs
k(tL))′, s = 1, . . . , S index-
ing posterior iterations after burn-in, our goal is to compute a simultaneous conﬁdence
band for βk(t). The principle in constructing a Bayesian conﬁdence band is to search
for a region Rα = {Rα(t), t ∈[0, T]} such that Pr{βk(t) ∈Rα(t), t ∈[0, T]} = 1 −α a
posteriori.
The most commonly-used method is to compute a conﬁdence band based on point-
wise conﬁdence intervals, which we denote as CR. The constructed conﬁdence band is
obtained as [βL
k (tl), βU
k (tl)],
l = 1, . . . , L, where βL
k (tl) is the α/2 empirical percentile
of the posterior samples and βU
k (tl) is the 1 −α/2 percentile. However, such pointwise
conﬁdence bands are not interpretable as joint conﬁdence bands. A method proposed
by Crainiceanu et al.(2007) assumes approximate posterior normality and derives the
1 −α sample percentile c1−α of
max
l=1,...,L

βs
k(tl) −ˆβk(tl)
q
c
var(ˆβk(tl))
, s = 1, . . . , S,
where ˆβk(tl) is the posterior mean at time tl and
q
c
var(ˆβk(tl)) is its posterior standard
26

deviation. A simultaneous conﬁdence region is given by the hyperrectangular
[ˆβk(tl) −c1−α
q
c
var(ˆβk(tl)), ˆβk(tl) + c1−α
q
c
var(ˆβk(tl))], l = 1, . . . , L.
In our implementation, we replace c1−α by cb which is calculated by cb = max(|cα/2|, |c1−α/2|)
to account for skewness. We denote this method as Pnorm.
Alternatively, we propose two new approaches that avoid the posterior normal-
ity assumption.
The strategy remains based on pointwise measures of uncertainty.
The ﬁrst method Mdev computes the posterior sample average curve ˆβk(tl) and the
pointwise α/2 percentile sα/2(tl) and 1 −α/2 percentile s1−α/2(tl), l = 1, . . . , L. By
deriving the maximal deviations sα/2 = maxl=1,...,L
(ˆβk(tl) −sα/2(tl)) and s1−α/2 =
maxl=1,...,L (s1−α/2(tl) −ˆβk(tl)) for the lower and upper α/2 percentiles away from the
posterior mean estimator ˆβk(tl), we obtain the conﬁdence band
[ˆβk(t) −sα/2, ˆβk(t) + s1−α/2].
This interval is potentially conservative. The second method Mdiﬀsearches the qbα
sample percentile of
max
l=1,...,L
βs
k(tl) −ˆβk(tl)
 s = 1, . . . , S,
such that 1 −(bα)L = α. The conﬁdence band is calculated by
[ˆβk(t) −qbα, ˆβk(t) + qbα].
2.3
Posterior Computation
We develop a Markov chain Monte Carlo (MCMC) algorithm for posterior computa-
tion by adapting an eﬃcient exact block Gibbs sampler (Papaspiliopoulos, 2008) for
27

Dirichlet mixture models. The exact block Gibbs sampler combines the advantages of
the retrospective MCMC method of Papaspiliopoulos & Roberts (2008) and the slice
sampling method of Walker (2007). Allowing data to inform information about the hy-
perparameters involved in the model through (2.3) −(2.7), we specify α0 ∼Ga(aα, bα),
γ0 ∼Ga(aγ, bγ), α1 ∼Ga(aα, bα), γ1 ∼Ga(aγ, bγ), τ ∼Ga(aτ, bτ). Introducing aux-
iliary variables {uikl} to avoid truncated approximations, k = 0, . . . , K, l = 0, . . . , p,
i = 1, . . . , n, the complete data joint likelihood of y, u, and z is:
n
Y
i=1
{g(yi; Θ0ψi0, Θψi1,...,ψiK, τ)1(ui00 < π0φi00)
p
Y
l=1
1(ui0l < π0φi0l)νzi0l
0l (1 −ν0l)(1−zi0l)
K
Y
k=1
1(uik0 < πφik0)
p
Y
l=1
1(uikl < πφikl)νzikl
kl (1 −νkl)(1−zikl)},
where yi is a mi × 1 outcome vector for the i-th subject, g(·) is the density function
of the outcome vector yi, i = 1, . . . , n, and the {uikl}s are constrained to the interval
(0, 1).
Please refer to the appendix B for the sampling algorithm in details.
This algorithm is straightforward to implement and exhibits good performance
in convergence and mixing.
To perform hypothesis testing, we estimate the poste-
rior hypothesis probability from the MCMC posterior samples.
For any t ∈[0, T],
Pr(H1k(t)|Data) is estimated as the proportion of iterations after burn-in satisfying
1/n Pn
i=1 ˆβik(t) /∈[−ϵ, ϵ].
2.4
Simulation Study
We conducted a simulation study to assess the ﬁnite sample performance of our ap-
proach. In each simulation, we generate a sample of 100 curves from the following
28

model:
Yi(t) = βi0(t) + βi1(t)xi + ϵi(t), ϵi(t) ∼N(0, τ −1),
i = 1, . . . , 100, t ∈[0, 1].
Each curve has 40 observations equally spaced along the time interval [0, 1] and we
set τ = 1. The covariate xi’s are sampled from Unif(0, 1) and then standardized to
have mean 0 and standard deviation 1. The baseline βi0(t) for t ∈[0, 1], i = 1, . . . , 100
is generated from a Gaussian process with mean curve mi0(t) = ai0 + bi0 sin(πt/60)
and covariance function c0(t, t′) = σ2
0ρ|t−t′|, where ai0 ∼N(5, 1), bi0 ∼N(20, 1),
σ0 = 0.224 and ρ = 0.5.
The covariate eﬀect βi1(t) is considered for three cases:
(1) global null case:
βi1(t) ∼GP(0, c1(t, t′)), (2) local alternative case:
βi1(t) ∼
GP((ai1 + bi1 cos(π(t −20)/20))1(t > 0.4), c1(t, t′)), and (3) global alternative case:
βi1(t) ∼GP(ai1 + bi1 cos(π(t −20)/20), c1(t, t′)). The random coeﬃcients ai1 ∼N(3, 1)
and bi1 ∼N(2, 1). The covariance function c1(t, t′) is set equivalent to c0(t, t′).
We analyze each simulated scenario using 100 repeated simulations by our method.
We set Ga(1, 1) hyperpriors for α0, γ0, α1, and γ1, and a Ga(0.1, 0.1) hyperprior for
τ. The exact block Gibbs sampler is run 25,000 iterations, with the ﬁrst 2500 samples
discarded as burn-in.
Every 20th sample is collected to thin the chain.
For each
case, our Gibbs sampler converges rapidly and exhibits eﬃcient mixing based on the
examination of the trace plots of α0, β0, α1, β1, τ, the elements of estimated functions,
and the performance of hypothesis testing as scaling up the simulation iterations. It
is not reliable to assess convergence and mixing based on the elements of the posterior
sampled atoms Θh or Θjh due to label switching issues.
We compare the LPP2 prior, the standard DP prior and a ﬁxed eﬀects model with
P0 as prior in terms of posterior estimation and posterior hypothesis testing. Mean
square error (MSE) is used to assess the accuracy of posterior estimation. Table 2.1
shows the LPP2 prior having smaller average mean square error than the DP prior
29

and the ﬁxed eﬀects model under each of the three cases. In performing the global
hypothesis testing, we propose to reject the global null if any local null hypothesis is
rejected. Table 2.2 summarizes type I error rates in the global null case and powers in
the global and local alternative cases. LPP2 prior is shown to have a type I error closer
to the signiﬁcance level 0.05 in the null case (0.05 vs 0.19) and larger power in the local
alternative case (0.72 vs 0.63) than DP prior. To perform the time-wise local inference,
the proposed approach rejects the local null hypotheses if Pr(H1k(t)|Data) ≥r, where
r is optimized to minimize FNR under the constraint of FDR ≤0.05. The averages of
the observed FDRs and powers from 100 repeated data sets are calculated to evaluate
the local hypothesis test approach. As seen in table 2.3, LPP2 prior has FDRs closer
to 0.05 in the global null case (0.042 vs 0.034) and the local alternative case (0.032 vs
0.028), and larger power in the local alternative case (0.367 vs 0.332) and the global
alternative case (0.998 vs 0.973).
We employ 4 approaches: Mdiﬀ, Mdev, Pnorm and CR to construct simultaneous
95% conﬁdence bands. The comparison results of the 95% conﬁdence band coverage
rates are listed in Table 2.4. As seen in Table 2.4, our proposed approach Mdiﬀgives
the 95% conﬁdence band coverage rate around 95% in the global null case, the local
alternative case and the global alternative case. The proposed Mdev performs similarly
to Pnorm in all the cases, while the CR has poor performance.
2.5
Yeast Cell-Cycle Gene Expression Application
2.5.1
Background and Motivation
The cell cycle is a regulated life process leading to the division and replication of a cell.
In cells with a nucleus, it consists of four sequential phases: GAP 1 (G1) for cell size
growth and preparation for DNA replication, Synthesis (S) for DNA replication, GAP 2
30

(G2) for continual cell growth and preparation for mitosis, and Mitosis (M) for division
of chromosomes and cytoplasm into two daughter cells. Since 1985 (Nasmyth), there has
been collective evidence that transcription factors (TFs) regulate the expression of the
cell-cycle-regulated genes at diﬀerent stages of cell cycle. As reported in the literature
for yeast (Simon et al., 2001), MBF and SBF function in the G1/S transition, Mcm1p
regulates actively in early G1, M and the M/G1 boundary, and Swi5p and Ace2p takes
account of many gene expressions in M and M/G1. However, the function of these TFs
over the full cell cycle remains unknown. Other potential active TFs are also waiting
to be discovered to function in the cell cycle to regulate the gene expression.
We apply our approach to a yeast cell cycle gene expression data set, appended
with a derivative ChIP binding data set. The yeast cell cycle gene expression data
set, collected over 2 cell cycles for 297 genes, is a subset of the data set collected
by Spellman et al. (1998) to identify a catalog of protein-encoding transcripts in the
genome of Saccharomyces cerevisiae. 6,178 yeast ORFs were examined simultaneously
for their expression at mRNA levels, which were synchronized by α pheromone for
G1 arrest, cdc15 for mitosis, and so on. Genes captured by α pheromone over two
cell cycle periods were measured at 18 time points, for every 7 minutes within a total
of 119 minutes.
297 genes were identiﬁed as cell-cycle-regulated by a model-based
approach (Luan and Li, 2003).
The derivative ChIP binding data set contains the
binding probabilities of 96 TFs to these 297 cell-cycle-regulated genes, where each TF
has at least 1 non-zero binding probability. These binding probabilities were obtained
by applying the mixture model approach (Chen, Jensen, and Stoeckert 2007; Wang,
Chen, and Li 2007) to the ChIP data of Lee et al. (2002).
Our ﬁrst analysis goal is to apply the random eﬀects time-varying coeﬃcient model
(2.3)-(2.7) to connect the log gene expression measures with a set of TFs. Let yi(t)
denote the log-expression level of the i-th gene at time point t, and xik denote the
31

binding probability of the k-th TF to the i-th gene, for k = 1, . . . , 96 and i = 1, . . . , 297.
Wang et al. (2008) linked the binding probabilities to the gene expression levels using
a ﬁxed eﬀect nonparametric time-varying coeﬃcient model:
yi(t) = β0(t) +
96
X
k=1
βk(t)xik + ϵi(t),
(2.8)
where βk(t) is the population mean transcription eﬀect of the k-th TF on the log expres-
sion level of the i-th gene at time point t, and ϵi(t)’s were assumed to be independent
within and across genes. However, considering that diﬀerent cell-cycle-regulated genes
function in diﬀerent processes such as DNA synthesis, budding, and cytokinesis (Spell-
man et al., 1998), one needs to account for the diﬀerential behaviors of the TFs in
regulating diﬀerent genes in the network of transcript regulations. To address the issue
of diﬀerential transcription behaviors, we ﬁt our random eﬀects time-varying coeﬃcient
model :
yi(t) = βi0(t) +
96
X
k=1
βik(t)xik + ϵi(t).
where we assume the gene-speciﬁc time-varying regulating course βik(t) for the k-th
TF on the i-th gene expression. We additionally construct Bayesian 95% conﬁdence
bands for the overall mean time-varying coeﬃcient curves for each TF to explain the
uncertainty in estimation.
Our second analysis goal is to identify the key TFs in cell-cycle regulated gene
expression network and proﬁle their active/inactive phases. Wang et al. (2008) iden-
tiﬁed the signiﬁcant TFs through zeroing small regression coeﬃcients using the SCAD
penalty. However, they didn’t incorporate the statistical inference error from the prob-
ability perspective.
We apply the point-wise Bayesian local null hypothesis testing
procedure to assess if a TF plays a signiﬁcant role in regulating gene expression while
32

identifying the active and inactive phases of TF regulation across cell cycles. We limit
type I errors by controlling expected FDR to be no more than 0.05.
In analyzing the data, we assume that between-gene expression levels are indepen-
dent. For a speciﬁc gene i, within-gene expression levels are assumed to be independent
given its baseline eﬀect βi0(t) and transcription eﬀects {βik(t)}96
k=1. We place Dirichlet
process and LPP2 priors on the distributions of the basis coeﬃcients. Given that many
of the log gene expression trajectories have similar shapes with only local deviation, we
expect that the LPP2 prior will produce a more parsimonious representation of the log
gene expression trajectories.
2.5.2
Analysis and Results
We focus initially on reanalyzing the yeast cell cycle gene data with the proposed ap-
proach. We assign Ga(1, 1) hyper priors for the hyperparameters α0, γ0, α1, and γ1,
and a Ga(0.1, 0.1) prior for the precision parameter τ. We recommend these priors as
default values in other analyses of standardized data, because these priors are weakly
informative across a wide range of plausible values for general longitudinal data, allow-
ing the data to inform strongly. Gaussian kernels as proposed in the model of Section
(2.2.2) are used as basis functions. We summarize the 1125 posterior samples from the
MCMC output with thinning of 20 iterations after the burn-in of 2500 iterations. Using
multiple chains with widely-distributed points, the proposed exact block Gibbs sampler
exhibits good rates of convergence and mixing. This formulation took 113 seconds per
iteration in Matlab 2010b on a Lenovo X61 laptop. We repeated the analysis for a
variety of hyperparameters values. We multiplied the mean and variance of α0, γ0, α1,
and γ1 by 2 and 0.5, and multiplied the variance of P0 by 2 and 0.5. There were no
noticeable diﬀerences in the results.
Our approach has the inherent ability to identify latent clusters in the data, which
33

is not available in the model of (2.8). The estimated values of the hyperparameters
α0 and α1 were ˆα0 = 0.15 and ˆα1 = 0.18, with 95% credible intervals of [0.01, 0.53]
and [0.01, 0.55]. These values suggest few global and local clusters are present in the
data, which means that a sparse representation of the data is obtained. The posterior
probability of φ∗
0 = 1 was 0.96, suggesting that subjects are allocated to 1 global
cluster for the baseline eﬀects. The number of local clusters tended to be small, with
the estimated averages of 1.07 and 2.34 for the baseline eﬀect and the covariate eﬀects.
The estimated values of the hyperparameters γ0 and γ1 were 6.23 and 54.46, with 95%
credible intervals of [2.48, 11.12] and [40.96, 88.53]. Since the values of γ0 and γ1 close
to zeros favors pure global clustering, while large values favor pure local clustering,
there is clear evidence in the data favoring our approach over the Dirichlet process.
Wang et al. (2008) used the estimated time-varying eﬀect curve and the conﬁdence
band to visualize peak eﬀects. We conducted a formal Bayesian local hypothesis test-
ing procedure to characterize the activation/deactivation phase of TFs in regulating
the expression of cell cycle-regulated genes. The proposed Bayesian multiple hypoth-
esis testing procedure gives the optimal rejection threshold r∗= 0.886 by controlling
FDR ≤0.05. The decision rule rejects H0k, k = 1, . . . , 96 if any υkt ≥0.886. Figure 2.4
presents the posterior probability curves in favor of time-wise local alternative hypothe-
ses for eight experimentally veriﬁed TFs to regulate gene expression during cell cycle.
Our procedure found some interesting features not discovered in Wang et al. (2008).
For example, Wang et al. (2008) didn’t identify the fact that FKH2 is associated with
genes expressed in G1 and S (Simon et al., 2001), while our procedure showed FKH2
to be active during G1/S phase. MBP1, SWI4 and SWI6 work as a complex to bind
predominantly to promoter regions of G1 genes (Simon et al., 2001). Although Wang
et al. (2008) found approximately similar peak eﬀect time points for SWI4 and SWI6,
Figure 2.4 clearly displays that they have similar active time windows.
34

We use our proposed Mdiﬀmethod to construct the 95% Bayesian conﬁdence bands
for the time-varying transcription eﬀects. As presented in Figure 2.2, MBP1, SWI4,
SWI6, MCM1, NDD1, FKH2, ACE2, and SWI5 were shown to have periodic tran-
scriptional eﬀect patterns over the collected two cell cycles, while Wang et al. (2008)
only showed certain periodic patterns for SWI4 and FKH2. Since the Mdiﬀmethod
considers the multiplicity issue in a conservative way similar to the Bonferroni method,
the constructed conﬁdence bands are wide. Methodology for improved construction of
simultaneous conﬁdence bands is an important area for future research.
We repeated the analysis using DP priors for P ∼DP(α0P0) and ˜P ∼DP(α1P0).
The posterior means of α0 and α1 were 2.43 and 0.58, with 95% credible intervals of
[1.26, 3.99] and [0.14, 1.42]. The posterior means of the number of clusters were 14
for the baseline eﬀect and 3.99 for the transcription factor eﬀects, reﬂecting a larger
number of clusters than in the local partition process.
In addition, the point-wise
local hypothesis testing procedure didn’t proﬁle the active phases of the veriﬁed TFs in
the literature, as illustrated in the Appendix Figure 2 in the supplementary material.
This is likely due to the tendency of the Dirichlet process to overly favor clustering of
subjects. In the situation of sparse basis coeﬃcients, we recommend the local partition
process for gains in inference.
2.6
Discussion
This chapter has proposed a nonparametric Bayesian model for longitudinal data anal-
ysis, which allows a ﬂexible time-varying baseline and covariate eﬀects for each subject,
while characterizing variability among subjects using a local partition process prior.
Posterior computation under the proposed Bayesian model is straightforward to im-
plement eﬃciently, with the steps involved consisting of sampling sequentially from
standard distributions. We have proposed novel methods for hypothesis testing and
35

estimation of simultaneous conﬁdence bounds on the mean time-varying coeﬃcients
curves, with preliminary simulation studies showing excellent frequentist operating
characteristics for these methods.
A standard Bayesian nonparametric formulation
based on Dirichlet process priors for the random eﬀects has substantially worse perfor-
mance in all cases we have considered. We hope that this illustration of the potential of
nonparametric Bayes methods for longitudinal data analysis stimulates more work on
developing novel nonparametric methods motivated by biomedical applications. In such
settings, it is often the case that “oﬀthe shelf” priors, such as Dirichlet and Gaussian
processes, can be substantially improved upon, with the applied context motivating
modiﬁcations having more biologically realistic properties.
36

Table 2.1: Comparison of the LLP2 prior, the DP prior and the ﬁxed eﬀects model:
mean square errors obtained from the 3 simulation cases: (i) global null case, (ii)
local alternative case, and (iii) global alternative case.
LPP2
DP
Fixed Eﬀects
βi0(t)
βi1(t)
βi0(t)
βi1(t)
βi0(t)
βi1(t)
Global Null
0.536
0.969
0.561
9.571
0.989
1.047
Local Alternative
0.560
0.836
0.588
19.561
1.148
1.191
Global Alternative
1.300
2.673
1.365
16.741
1.580
1.719
Table 2.2: Type I error rates and powers of the global
hypothesis tests under both LPP2 prior and DP prior
obtained from 100 repeated data sets for the 3 simula-
tion cases: (i) global null case, (ii) local alternative case,
and (iii) global alternative case.
LPP2
DP
Global Null
0.05
0.19
Local Alternative
0.72
0.63
Global Alternative
0.92
0.92
Table 2.3: The average of observed FDRs and powers for multiple hypothesis testing
procedure under the LPP2 prior and the DP prior obtain from 100 simulated data
sets for the 3 simulation cases: (i) global null case, (ii) local alternative case, and
(iii) global alternative case.
LPP2
DP
FDR
Power
FDR
Power
Global Null
0.042
-
0.034
-
Local Alternative
0.032
0.367
0.028
0.332
Global Alternative
-
0.998
-
0.973
Table 2.4: The coverage rates of 95% conﬁdence band for 4 methods: Mdiﬀ, Mdev,
Pnorm, CR under the LPP2 prior for the 3 simulation cases: (i) global null case,
(ii) local alternative case, and (iii) global alternative case.
Mdiﬀ
Mdev
Pnorm
CR
Global Null
0.987
0.733
0.880
0
Local Alternative
0.967
0.680
0.847
0
Global Alternative
0.950
0.645
0.774
0
37

Fig. 2.1: Posterior probabilities of time-wise local alternative hypothesis for analyzing
the yeast cell-cycle gene expression data using LPP2 prior. The dashed line corresponds
to the optimal rejecting threshold r∗= 0.886.
G1: TFs reported to regulate gene
expression at the G1 phase; G2: TFs reported to regulate gene expression at the G2
phase; M: TFs reported to regulate gene expression at the M phase. A: active phase
above the threshold level; D: deactive phase below the threshold level.
38

Fig. 2.2: Posterior estimated mean time-varying coeﬃcients (solid line: —) and point-
wise 95% conﬁdence bands (dashed lines: - - -) for analyzing the yeast cell-cycle gene
expression data. G1: TFs reported to regulate gene expression at the G1 phase; G2:
TFs reported to regulate gene expression at the G2 phase; M: TFs reported to regulate
gene expression at the M phase.
39

2.7
Appendix
2.7.1
Appendix A: Proof of Proposition 1
From the realization of the LPP2 prior through sticking-breaking process, regardless of
which component a basis coeﬃcient ϑj comes from, ϑj is drawn from the base Cauchy
measure P0. Then by the property of the linear combination of normal distributions
remaining a normal distribution, conditional on Λ−1 = diag{λ−1
1 , . . . , λ−1
p }, the condi-
tional distribution
f(t)|Λ−1 ∼N(0, B(t)′Λ−1B(t)).
Furthermore, the covariance between f(t1) and f(t2) conditional on Λ−1 is easily derived
as
Cov(f(t1), f(t2)|Λ−1) = B(t1)′Λ−1B(t2).
Then for a vector of such functions indexed by a ﬁnite time set, it follows that
[f(t1), f(t2), . . . , f(tL)]′|Λ−1 ∼NL(0L×1, ΣL×L)
with ΣL×L = [σij], i = 1, . . . , L, j = 1, . . . , L, and σij = B(ti)′λ−1
1 B(tj).
2.7.2
Appendix B: the MCMC Posterior Computation Algo-
rithm
We deﬁne the following notations for convenient use in the description of the sampler:
• W0 = (w′
01, . . . , w′
0n)′, with w0i = (b(t1), . . . , b(tmi))′, i = 1, . . . , n,
• Z0 = diag(1(z101 = 1 −j), . . . , 1(z10p = 1 −j), . . . , 1(zn01 = 1 −j), . . . , 1(zn0p =
1 −j)),
40

• Φ0 = diag(1(φ101 = h), . . . , 1(φ10p = h), . . . , 1(φn01 = h), . . . , 1(φn0p = h)),
• R0 = (r′
0, . . . , r′
0)′
np×p with r0 = diag(1, . . . , 1)p×p,
• Y = (y′
1, . . . , y′
n)′,
• Z0Y = diag(1(Pp
l=1 1(z10l = 1 −j) ≥1), . . . , 1(Pp
l=1 1(zn0l = 1 −j) ≥1))n×n,
• Φ0Y = diag(1(Pp
l=1 1(φ10l = h) ≥1), . . . , 1(Pp
l=1 1(φn0l = h) ≥1))n×n.
• W = (w′
1, . . . , w′
n)′, with wi = (Bi(t1), . . . , Bi(tmi))′ for i = 1, . . . , n,
• Z = diag(1(z111 = 1 −j), . . . , 1(z11p = 1 −j), . . . , 1(z1K1 = 1 −j), . . . , 1(z1Kp =
1 −j), . . . , 1(zn11 = 1 −j), . . . , 1(zn1p = 1 −j), . . . , 1(znK1 = 1 −j), . . . , 1(znKp =
1 −j)),
• Φ = diag(1(φ111 = h), . . . , 1(φ11p = h), . . . , 1(φ1K1 = h), . . . , 1(φ1Kp = h), . . . , 1(φn11 =
h), . . . , 1(φn1p = h), . . . , 1(φnK1 = h), . . . , 1(φnKp = h)),
• R = (r′, . . . , r′)′
npK×pK with r = diag(1, . . . , 1)pK×pK,
• Y = (y′
1, . . . , y′
n)′,
• ZY = diag(1(PK
k=1
Pp
l=1 1(z1kl = 1 −j) ≥1), . . . , 1(PK
k=1
Pp
l=1 1(znkl = 1 −j) ≥
1))n×n,
• ΦY
= diag(1(PK
k=1
Pp
l=1 1(φ1kl = h) ≥1), . . . , 1(PK
k=1
Pp
l=1 1(φnkl = h) ≥
1))n×n,
Our sampling algorithm proceeds as follows:
Step 1. Update the subject-speciﬁc baseline βi0(t) part
1.
Update the latent ui0l from its conditional distribution Unif(0, π0φi0l) for
l = 0, 1, . . . , p.
41

2.
Update the latent zi0l from its conditional distribution Ber(pi0l), with
pi0l =
ν0lN(yi; θi0(zi0l=1), θi, τ)
ν0lN(yi; θi0(zi0l=1), θi, τ) + (1 −ν0l)N(yi; θi0(zi0l=0), θi, τ),
where θi0(zi0l=j) refers to the current value of θi0 with inserting Θ00φi0ll to the
lth component for j = 1, and Θ01φi0ll for j = 0.
3.
Update the stick-breaking variable π∗
0h with its conditional distribution
Beta(
p
X
l=0
n
X
i=1
1(φi0l = h) + 1,
p
X
l=0
n
X
i=1
1(φi0l > h) + α)
for h ≤φ∗
0, with φ∗
0 = max{φi0l, i = 1, . . . , n, l = 0, 1, . . . , p}; for h > φ∗
0,
sample it from Beta(1, α0).
4.
Update φi0l with its conditional probability Pr(φi0l = h) ∝1(h ∈Ai0l)N(yi; θi0(φi0l=h), θi, τ),
where Ai0l = {h : π0h > ui0l} ⊂{1, 2, . . . , ∞}, which is obtained by sampling
π∗
0h for h = 1, . . . , ˜φ0 with ˜φ0 the smallest value satisfying
˜φ0
X
h=1
π∗
0h
Y
l<h
(1 −π∗
0l) ≥1 −u∗
0,
where u∗
0 = min{ui0l, i = 1, . . . , n, l = 0, 1, . . . , p}.
5.
Update Θ0jh from its conditional distribution Np(µ0jh, Σ0jh), where
Σ0jh = [diag(λ0jh, . . . , λ0jh)p×p + τW ′
0jhW0jh]−1 and µ0jh = τΣ0jhW ′
0jhY0jh,
in which Y0jh refers to the contribution for Θ0jh from subjects with zi0l =
1 −j and φi0l = h. In addition, W0jh = diag(w01, . . . , w0n)Z0Φ0R0, and
Y0jh = diag(y1, . . . , yn)Z0Y Φ0Y 1n, where 1n is a n × 1 vector of entries of 1.
6.
Update λ0jh from its conditional distribution Ga(0.5+p/2, 0.5+Θ′
0jhΘ0jh/2).
42

7.
Update ν0l from its conditional distribution Beta(1+P
i zi0l, γ0+P
i(1−zi0l)).
8.
Update the hyperparameter γ0 from its conditional distribution Ga(aγ +
p, bγ −Pp
l=1 log(1 −ν0l)).
9.
Update the hyperparameter α0 from its conditional distribution Ga(aα +
φ∗
0, bα −Pφ∗
0
h=1 log(1 −π∗
0h)).
Step 2. Sample the coeﬃcient regression functions {βik(t)}K
k=1 part in a manner similar
to Step 1.
1.
Update the latent uikl from its conditional distribution Unif(0, πφikl) for k =
1, . . . , K, l = 0, 1, . . . , p.
2.
Update the latent zikl from its conditional distribution Ber(pikl), with
pikl =
νklN(yi; θi0, θi(zikl=1), τ)
νklN(yi; θi0, θi(zikl=1), τ) + (1 −νkl)N(yi; θi0, θi(zikl=0), τ),
where θi(zikl=j) refers to the current value of θi with inserting Θ0φikll to the
lth component for j = 1, and Θ1φikll for j = 0.
3.
Update the stick-breaking variable π∗
h with its conditional distribution
Beta(
p
X
l=0
K
X
k=1
n
X
i=1
1(φikl = h) + 1,
p
X
l=0
K
X
k=1
n
X
i=1
1(φikl > h) + α)
for h ≤φ∗, with φ∗= max{φikl, i = 1, . . . , n, k = 1, . . . , K, l = 0, 1, . . . , p};
for h > φ∗, sample it from Beta(1, α1).
4.
Update φikl with its conditional probability Pr(φikl = h) ∝1(h ∈Aikl)N(yi; θi0, θi(φikl=h), τ),
where Aikl = {h : πh > uikl} ⊂{1, 2, . . . , ∞}, which is obtained by sampling
43

π∗
h for h = 1, . . . , ˜φ with ˜φ the smallest value satisfying
˜φ
X
h=1
π∗
h
Y
l<h
(1 −π∗
l ) ≥1 −u∗,
where u∗= min{uikl, i = 1, . . . , n, k = 1, . . . , K, l = 0, 1, . . . , p}.
5.
Update Θjh = (Θjh1, . . . , ΘjhK) and λjhk, j = 0, 1:
a.
Update Θjh from its conditional distribution Np(µjh, Σjh), where
Σjh = [diag(λjh11p, . . . , λjhK1p)pK×pK+τW ′
jhWjh]−1 and µjh = τΣjhW ′
jhYjh,
with Yjh referring to the contribution for Θjh from subjects with zikl =
1 −j and φikl = h, so as to Wjh, for l = 1, . . . , p. Speciﬁcally, Wjh =
diag(w1, . . . , wn)ZΦR, and Yjh = diag(y1, . . . , yn)ZY ΦY 1n, where 1n is
a n × 1 vector of entries of 1.
b.
Update λjhk from its conditional distribution Ga(0.5+p/2, 0.5+Θ′
jhkΘjhk/2).
6.
Update νkl from its conditional distribution Beta(1 + P
i zikl, γ1 + P
i(1 −
zikl)).
7.
Update the hyperparameter γ1 from its conditional distribution Ga(aγ +
pK, bγ −PK
k=1
Pp
l=1 log(1 −νkl)).
8.
Update the hyperparameter α1 from its conditional distribution Ga(aα +
φ∗, bα −Pφ∗
h=1 log(1 −π∗
h)).
Step 3. Update the precision parameter τ with its conditional distribution Ga(aτ+P
i ni/2, bτ+
P
i{yi −βi0(t) −PK
k=1 βik(t)xik}′{yi −βi0(t) −PK
k=1 βik(t)xik}/2).
44

Appendix Figure 1
Fig. 2.3: Boxplots showing the number of global and local clusters for baseline eﬀects
and TFs eﬀects
45

Appendix Figure 2
Fig. 2.4: Posterior probabilities of time-wise local alternative hypothesis for analyzing
the yeast cell-cycle gene expression data using DP prior. The dashed line corresponds
to the optimal rejecting threshold r∗= 0.683.
G1: TFs reported to regulate gene
expression at the G1 phase; G2: TFs reported to regulate gene expression at the G2
phase; M: TFs reported to regulate gene expression at the M phase. A: active phase
above the threshold level; D: deactive phase below the threshold level.
46

Chapter 3
Semiparametric Bayesian Local
Functional Models
for Diﬀusion Tensor Tract
Statistics
3.1
Introduction
Diﬀusion tensor imaging (DTI) is an magnetic resonance imaging (MRI) technique
that measures the diﬀusion orientation of water molecules in tissue. The mobility of
water molecules is aﬀected by the tissue properties of white matter ﬁber tracts, such
as the density of the ﬁbers, the average ﬁber diameter, and the directionality of the
ﬁbers. In turn, the information collected on the diﬀusion properties of water molecules
provides the structural organization of the white matter ﬁber tracts (Kubicki et al.,
2007). The water diﬀusion directions and magnitudes at each voxel in the brain can be
described by a 3 × 3 symmetric positive matrix, called a diﬀusion tensor (DT) (Basser
et al., 1994a,b). The degree of diﬀusivity can be quantiﬁed by the three eigenvalue-
eigenvector pairs of DT, and its related parameters, such as fractional anisotropy (FA)

(Pierpaoli and Basser, 1996; Hasan et al., 2001; Hasan and Narayana, 2003; Zhu et al.,
2006). A rich literature in neuroimaging has been developed to analyze white matter
ﬁber tract maturation and integrity via a set of water diﬀusion parameters such as
FA, mean diﬀusivity (MD) and so on, used as markers (Moseley, 2002; Mukherjee and
McKinstry, 2006; Cascio et al., 2007; Rollins, 2007).
Three major analytic approaches for grouping analysis of DTI data set have been
explored including analyses based on region-of-interest (ROI), voxels, and ﬁber tracts
(Smith et al., 2006; O’Donnell et al., 2009; Snook et al., 2007). The region-of-interest
(ROI) method (Bonekam et al., 2008; Gilmore et al., 2008) suﬀers from diﬃculties in
identifying meaningful ROIs, particularly the long curved structures common in ﬁber
tracts, instability of statistical results, and the partial volume eﬀect in relatively large
ROIs (Snook et al., 2007). Voxel based analysis (Chen et al., 2009; Focke et al., 2008;
Camara et al., 2007; Snook et al., 2005) suﬀers from issues of alignment quality and
the arbitrary choice of smoothing extent (Hecke et al., 2009; Ashburner and Friston,
2000; Smith et al., 2006; Jones et al., 2005).
There is an extensive interest in the DTI literature in developing ﬁber tract based
analysis of diﬀusion properties (Smith et al., 2006; O’Donnell et al., 2009; Yushkevich
et al., 2008; Goodlett et al., 2009; Zhu et al., 2010, 2011; Goldsmith et al., 2011). Such
analyses usually consist of DTI atlas building and a follow-up statistical analysis (Smith
et al., 2006; Goodlett et al., 2009; Zhu et al., 2010). DTI atlas building is primarily to
establish DTI correspondence across all DTI datasets from diﬀerent subjects and to ex-
tract a set of individual DTI tracts (or skeleton) with the same corresponding geometry
but varying DTs and diﬀusion properties. For instance, Smith et al. (2006) developed a
tract-based spatial statistics framework to construct local diﬀusion properties along the
white matter skeleton, ﬁtted pointwise linear regression models, and performed point-
wise hypothesis tests on the skeleton. This method essentially ignores the functional
48

nature of diﬀusion properties along the white matter skeleton, and thus suﬀers from low
statistical power in detecting interesting features and exploring variability in functional
data. Goodlett et al. (2009) used functional principal component analysis (fPCA) cou-
pled with the Hotelling T 2 statistic to compare a univariate diﬀusion property, such as
fractional anisotropy, across two (or more) populations for a single hypothesis test per
tract. Zhu and his coauthors (Zhu et al., 2010, 2011) proposed a multivariate vary-
ing coeﬃcient model based on fPCA for the analysis of ﬁber bundle multiple diﬀusion
properties and their association with a set of covariates of interest such as age. Greven
et al. (2010) developed a functional mixed eﬀects model as a generalization of mixed
eﬀects models and fPCA for the analysis of longitudinal DTI ﬁber tract data. So far,
frequentist inference is the primary approach for making statistical inferences in these
statistical models for ﬁber tract based analysis of diﬀusion properties.
In this chapter, we propose a new semiparametric Bayes approach to model the as-
sociation between multiple ﬁber bundle diﬀusion properties and covariates of interest.
A multivariate random coeﬃcient model is developed to characterize heterogeneity in
the shape of the ﬁber bundle diﬀusion properties among subjects, while allowing the im-
pact of covariates to vary across subjects. We assume a nonparametric Bayesian LPP2
prior (Dunson, 2009) on the distribution of the random coeﬃcients to facilitate global
and local borrowing of information among subjects. We consider a sparse latent factor
model to more ﬂexibly capture the within-subject correlation structure and assume a
multiplicative gamma process shrinkage prior on the factor loadings which allows in-
troduction of inﬁnitely many factors (Bhattacharya and Dunson, 2011). We propose
Bayesian local hypothesis testing to identify ﬁber segments, where multiple diﬀusion
properties are signiﬁcantly associated with covariates of interest, while controlling for
multiple comparisons. We propose a Bayesian conﬁdence band for the average eﬀect
of each covariate. Finally, we use the nonparametric LPP2 prior to randomly cluster
49

subjects via global and local clustering. Posterior computation proceeds via an eﬃcient
Markov chain Monte Carlo (MCMC) algorithm using the exact block Gibbs sampler.
3.2
Methodologies
This chapter focuses on developing a semiparametric Bayesian multivariate functional
regression analysis pipeline, named as SBLFM, to assess the association between ﬁber
bundle diﬀusion properties and a set of covariates of interest (e.g., age). Before SBLFM,
we use DTI atlas building followed by atlas ﬁber tractography and ﬁber parametriza-
tion as described in Goodlett et al. (2009) to extract DTI ﬁbers and establish DTI ﬁber
correspondence across all DTI datasets from diﬀerent subjects. We skip its description
here for the sake of simplicity (Goodlett et al., 2009; Zhu et al., 2010). After performing
the DTI atlas building step, we obtain a set of individual ﬁber tracts (or skeleton) with
the same corresponding geometry but varying DTs and diﬀusion properties. Subse-
quently, we run the analysis pipeline SBLFM including a multivariate random varying
coeﬃcient model, a semiparametric Bayesian estimation method, a Bayesian approach
to construct conﬁdence bands, a Bayesian local hypothesis testing procedure, and a
Bayesian posterior cluster analysis procedure (Fig. 3.1). The computational algorithm
for SBLFM is developed by using Matlab.
3.2.1
Multivariate Random Coeﬃcient Model
Assume n subjects are measured along a ﬁber bundle over a grid of T points for M
diﬀusion properties (e.g. FA), denoted by {Yi(dt) : i = 1, . . . , n, t = 1, . . . , T}, where
Yi(dt) = (Y (1)
i
(dt), . . . , Y (M)
i
(dt))′ is an M × 1 vector of diﬀusion properties for the i-th
subject, dt ∈[0, L] is the arc length of point t relative to a ﬁxed end point of the ﬁber
bundle, and L is arc length of this ﬁber bundle. For the i-th subject, we relate the
m-th functional diﬀusion response Y (m)
i
(dt) to a set of K covariates via a multivariate
50

random coeﬃcient model given by
Y (m)
i
(dt)
=
β(m)
i
(dt)′Xi + ϵ(m)
i
(dt), ϵ(m)
i
(dt) ∼N(0, σ2
m,t),
(3.1)
where Xi = (1, x′
i)′ is the design vector for the i-th subject with xi = (xi1, · · · , xiK)′
being a K × 1 vector of covariates of interest, and β(m)
i
(dt) = (β(m)
i,0 (dt), . . . , β(m)
i,K (dt)′
is a (K + 1) × 1 vector of random coeﬃcients for the m-th diﬀusion property. The
measurement error ϵ(m)
i
(dt) is assumed to be drawn from a normal distribution with
mean zero and standard deviation σm,t.
We model the random coeﬃcient function β(m)
i,k (dt) by using a linear combination of
cubic B-spline basis functions bl(dt)s as follows:
β(m)
i,k (dt) =
p
X
l=1
η(m)
ikl bl(dt) = b(dt)′η(m)
ik ,
(3.2)
where b(dt) = (b1(dt), . . . , bp(dt))′ is a p × 1 vector for B-spline basis functions and
η(m)
ik
= (η(m)
ik1 , . . . , η(m)
ikp )′ is a p × 1 vector of random coeﬃcients. Thus, the model (3.1)
can be written as
Y (m)
i
(dt) = Bi(dt)′η(m)
i
+ ϵ(m)
i
(dt) for m = 1, . . . , M,
(3.3)
where η(m)
i
= (η(m)
i0
′, . . . , η(m)
iK
′)′ and Bi(dt) = Xi ⊗b(dt) are (K + 1)p × 1 vectors.
Heterogeneity in the ﬁber bundle diﬀusion properties is then controlled by the variation
of η(m)
i
, which are usually treated as random eﬀects and follow a speciﬁc parametric
distribution. There is a serious concern about the sensitivity of associated inferences
to the choice of the random eﬀects distribution on the basis coeﬃcients.
Let ηi = (η(1)
i
′, . . . , η(M)
i
′)′ be an M(K + 1)p × 1 vector, Bi = (Bi(d1), . . . , Bi(dT))′
be a T × (K + 1)p matrix, and Yi = (Y (1)
i
′, . . . , Y (M)
i
′)′ be an MT × 1 vector, where
51

Y (m)
i
= (Y (m)
i
(d1), . . . , Y (m)
i
(dT))′ is a T×1 vector for m = 1, . . . , M. The concantenated
representation of model (3.3) is given by
Yi = (IM ⊗Bi)ηi + ϵi, ϵi ∼NMT(0, Σ),
(3.4)
where NMT(0, Σ) is an MT ×1 Gaussian random vector with mean zero and covariance
matrix Σ = diag(σ2
1,1, . . . , σ2
M,T).
3.2.2
Inﬁnite Latent Factor Model
Given the massive dimensionality of the random eﬀect vector ηi, it is important to favor
lower dimensional representations of the dependence structure to address the curse of
dimensionality. Instead of prespecifying a restrictive dependence structure, we follow
the approach of using a Bayesian factor model, which relates the random eﬀects ηi to
latent factors θi through the following characterization
ηi = Aθi,
(3.5)
where A is a (K + 1)pM × ∞factor loadings matrix and θi ∼N∞(0, I∞). For di-
mensionality reduction, one would typically restrict the dimension of the latent factor
vector θi to be orders of magnitude less than that of ηi. However, following the moti-
vation of Bhattacharya and Dunson (2011), we bypass the challenging issue of selecting
the number of factors by incorporating inﬁnitely many factors, while choosing a prior
that favors the elements of A to be shrunk to zero increasingly as the column index
increases.
We obtain the within-subject correlation structure through projecting Yi as a linear
combination of the underlying ∞-dimensional latent random vector θi after denoising,
52

via
Yi = (IM ⊗Bi)Aθi + ϵi, ϵi ∼NMT(0, Σ),
(3.6)
where Bi(dt) = Xi ⊗b(dt) and Bi = (Bi(d1), . . . , Bi(dT))T. The common factors θi
explain the within-subject dependence structure among the MT variables for each Yi.
Let Yif and σ2
f be, respectively, the f-th component of Yi and the f-th diagonal
element of Σ.
Conditional on θi, Yif1 and Yif2 are uncorrelated for all f1 and f2
∈{1, . . . , MT}. Marginalizing over the distribution of θi, the covariance structure Ω
of the data distribution Yi ∼NMT(0, Σ) is induced as
Ω= Var(Yi|A, Σ) = (IM ⊗Bi)AAT(IM ⊗Bi)T + Σ.
Speciﬁcally, conditional on A and Σ, we have:
Var(Yif1|θi, A, Σ)
=
σ2
f1,
Cov(Yif1, Yif2|θi, A, Σ)
=
0,
Var(Yif1|A, Σ)
=
(IM ⊗BiA)f1(IM ⊗BiA)T
f1 + σ2
f1,
Cov(Yif1, Yif2|A, Σ)
=
(IM ⊗BiA)f1(IM ⊗BiA)T
f2,
where (IM ⊗BiA)f1 is the f1th row of (IM ⊗BiA).
A constraint is usually speciﬁed on A to deﬁne a unique model free from identiﬁca-
tion problems, since Ωis invariant under the transformations A∗= AP for any semi-
orthogonal matrix P (PP T = I). The traditional full rank lower triangular constraint
for identiﬁability implicity speciﬁes order dependence among the responses (Geweke and
Zhou, 1996). The choice of ordering of the response variables is a modeling decision
(Carvalho et al., 2008). From the Baysian perspective, we don’t require identiﬁability
53

of the loading elements in A for a wide class of applications such as covariance matrix
estimation. In our case, we specify the multiplicative gamma process shrinkage prior,
which will be given in (3.7), on a parameter expanded loadings matrix with redundant
parameters. The induced prior on the covariance matrix is invariant to ordering of the
data. This shrinkage prior adaptively selects a truncation of the inﬁnite loadings to
one having ﬁnite columns, which facilitates the posterior computation and provides an
accurate approximation to the inﬁnite factor model.
Although FRATS (Zhu et al., 2010) and FADTTS (Zhu et al., 2011) have been
proposed to analyze the DTI ﬁber bundle data sets of multiple diﬀusion measures with
a set of covariates such as gender and gestational age, they assume identical eﬀects
of the covariates on the diﬀusion properties for all subjects. Our SBLFM developed
here relaxes the assumption to allow the subject speciﬁc functional covariate eﬀects on
the multiple diﬀusion outcome functions. In addition, FRATS and FADTTS assume a
covariate-free correlation structure among the multiple diﬀusion properties. We intro-
duce the random factors underlying the subject speciﬁc covariate eﬀects to allow the
correlation structure among the multiple diﬀusion measures to vary with the levels of
the covariates along the ﬁber tracts. Moreover, we specify a LPP2 prior on the distri-
butions of the subject speciﬁc random factors to produce a global and local clustering
structure of the multiple diﬀusion trajectories across the subjects.
3.2.3
Priors
We choose independent priors for A, θi, and Σ and develop an eﬃcient Markov chain
Monte Carlo (MCMC) algorithm given in the Appendix for posterior computation.
To remove the redundant factors, we place the multiplicative gamma process shrink-
age prior (Bhattacharya and Dunson, 2011) on the loadings matrix A to increasingly
shrink the loadings toward zero with the column index. This speciﬁcation avoids the
54

traditional drawback of order dependence from the lower triangular constraint for iden-
tiﬁability. We use the inverse gamma priors on the diagonal elements of Σ. To allow
the latent clustering structure among subjects, we specify a LPP2 prior (Dunson, 2009)
on the prior distribution P of θi. Let Ga(a, b) be a gamma distribution with scale a
and shape b. Speciﬁcally, these priors in details are given as follows:
A
=
{Agh}, g = 1, . . . , (K + 1)pM ; h = 1, . . . , ∞,
Agh|φgh, τh
∼
N(0, φ−1
gh τ −1
h ), φgh ∼Ga(v/2, v/2), τh =
h
Y
l=1
δl,
δ1
∼
Ga(a1, 1), δl ∼Ga(a2, 1), l ≥2,
σ−2
f
∼
Ga(aσ, bσ), f = 1, . . . , MT,
(3.7)
θi
∼
P, P ∼LPP2(α, γ, P0), P0 : θi ∼N∞(0, ζI∞), ζ ∼Ga(0.5, 0.5),
where δl, l = 1, . . . , ∞, are independent, τh is a global shrinkage parameter for the
hth column, and the φghs are local shrinkage parameters for the elements in the hth
column. When a2 > 1, the τhs increase stochastically as the column index h increases,
which means more shrinkage favored over the columns of higher indexes. The loading
component speciﬁc prior precision φ−1
gh τ −1
h
allows shrinking the coeﬃcients of the B-
spline basis functions. The LPP2 prior assumption speciﬁes an ∞-dimensional central
probability measure P0 as a prior guess, a precision parameter α expressing conﬁdence
in the prior guess, and a hyperparameter γ determining the overall allocation weight
on the local family.
3.2.4
LPP2 prior
In modelling the multiple trajectories of diﬀusion measures over subjects, we are in-
terested in identifying the latent cluster structure of Yis among subjects, which can
be induced by specifying a nonparametric prior on the unknown distribution of the
55

random factors θi. Dirichlet process prior (Ferguson, 1973, 1974) is the routine ap-
proach to induce a sparse representation of subjects. However, it has the drawback of
global clustering, in which two subjects are either allocated to an identical cluster or
two diﬀerent clusters. In DTI imaging data analysis, it is common that two subjects
have similar diﬀusion trajectories over the major region of ﬁber bundles while having
local deviations. Under the Dirichlet process, either such subjects are inappropriately
clustered together, obscuring local diﬀerences, or allocated to separate clusters causing
unnecessary computational burden. We used the LPP2 prior (Dunson, 2009) to model
the unknown random eﬀects distributions to facilitate both global and local clustering
of random eﬀects. It relaxes the global clustering assumption of the widely-used Dirich-
let process prior, while accomplishing sparseness for substantial gains in computational
eﬃciency.
After truncating the loadings matrix A to h∗≪(K + 1)pM columns, we assume
the resulting h∗-dimensional random eﬀects θi = (θi1, . . . , θih∗)T ∼P with P unknown,
i = 1, . . . , n. The LPP2 prior models P as a hybrid mixture distribution:
P =
1
X
z1=0
(1−z1,∞)
X
ψ1=(1−z1,1)
· · ·
1
X
z∗
h=0
(1−zh∗,∞)
X
ψh∗=(1−z∗
h,1)
πψ1,...,ψh∗δΘψ,
(3.8)
where δx denotes a degenerate distribution with all its mass at x, πψ1,...,ψh∗is the
probability of θi = Θψ having the property that πψ1,...,ψh∗≥0 and
1
X
z1=0
(1−z1,∞)
X
ψ1=(1−z1,1)
· · ·
1
X
zh∗=0
(1−zh∗,∞)
X
ψh∗=(1−zh∗,1)
πψ1,...,ψh∗= 1.
The indicator zj ∼Ber(νj), j = 1, . . . , h∗, denotes the allocation to global clustering or
local clustering, taking the value of 1 for global clustering and 0 for local clustering. The
hybrid atom Θψ = (Θψ1,1, . . . , Θψh∗,h∗)T is obtained by setting the jth element of Θψ
56

equal to Θψj,j with ψj = (1 −zj, φj) and Θψj ∼P0 for φj ∈{1, . . . , ∞}, j = 1, . . . , h∗,
where P0 is a base distribution.
Let πh denote Pr(θij = Θghj), g = 0, 1, h = 1, . . . , ∞, j = 1, . . . , h∗.
Those
random eﬀects having zj = 1 are assigned together to a component in the global family
Ξ0 = {Θ0h}∞
h=1, while others having zj = 0 are assigned to their own component in the
local family Ξ1 = {Θ1h}∞
h=1. Let J0 = {j : zj = 1} and J1 = {j : zj = 0}. Conditional
on the values of z, we have
Pr(ψj = (0, h), j ∈J0|z1, . . . , zh∗) = πh, h = 1, . . . , ∞,
Pr(ψj = (1, hj), j ∈J1|z1, . . . , zh∗) =
Y
j∈J1
πhj, hj = 1, . . . , ∞.
The allocation probability of θi = Θψ in (3.8) is then simply
πψ1,...,ψh∗= Pr(ψ1 = (1 −z1, h1), . . . , ψh∗= (1 −zh∗, hh∗)) = πh
 Y
j∈J1
πhj
 h∗
Y
j=1
ν
zj
j (1 −νj)1−zj

.
The speciﬁcation is completed by choosing the hyperpriors
νj ∼Beta(1, γ),
j = 1, . . . , h∗,
πh = π∗
h
Y
l<h
(1 −π∗
l ),
π∗
h ∼Beta(1, α),
h = 1, . . . , ∞,
where γ controls the overall weight on the local family, and α controls the overall
number of clusters. As short hand, the LPP2 prior on the random eﬀects distribution
P is denoted by P ∼LPP2(α, γ, P0).
The LPP2 prior speciﬁcation (3.8) can also be viewed as a hybrid mixture model of
inﬁnitely many components drawn from P0 via 2-stage clustering. Stage 1 determines
the membership of global or local clustering for each of the h∗components. Those
components allocated to the global clustering membership will be clustered together
57

to an atom in the global family at stage 2, while those allocated to the local family
will be allocated individually to their own clusters.
The joint cluster membership
probability at stage 1 corresponds to Pr(z1, . . . , zh∗) = Qh∗
j=1 ν
zj
j
(1 −νj)1−zj. The joint
cluster allocation weight at stage 2 conditional on stage 1 corresponds to Pr(ψ1 =
(1 −z1, h1), . . . , ψh∗= (1 −zh∗, hh∗)|z1, . . . , zh∗). The overall joint cluster allocation
weight corresponds to πψ1,...,ψh∗.
3.2.5
Hypothesis Formulation & Testing
We are interested in making pointwise inference for the covariate eﬀects along a ﬁber
bundle. The local null and alternative hypotheses for the kth covariate eﬀect on the
mth diﬀusion property speciﬁc to a location dt ∈[0, L] are formulated as:
H(m)
0k (dt) :
β
(m)
k
(dt)
 ≤ϵ versus H(m)
1k (dt) :
β
(m)
k
(dt)
 > ϵ,
where β
(m)
k
(dt) represents the mean of the subject-speciﬁc random coeﬃcients for the
kth predictor on the mth diﬀusion property at location dt. The zero-neighborhood size
ϵ is chosen as being proportional to the maximum posterior standard deviation of the
posterior samples of β(m)
i,k (dt) multiplied by ϵ∗. It is important to be aware that the
data have been normalized prior to analysis.
To conduct local hypotheses testing, we use the Bayesian decision rule for multiple
testing proposed by M¨uller et al. (2004). Following the implementation in Wang and
Dunson (2010), our strategy is to reject H(m)
0k (t) if the posterior alternative hypothesis
probability υ(m)
kt
= Pr(H(m)
1k (t)|Data) ≥r for any t ∈[0, T], with r as a common
threshold for all the local hypotheses. r is chosen to minimize the posterior expected
false negative rate (FNR) under the constraint of the posterior expected false discovery
rate (FDR) being no greater than αT, where αT is pre-speciﬁed (we focus on a value
58

of 0.05). Denote d(m)
kt
= 1(υ(m)
kt
≥r), an indicator of rejecting H(m)
0k (t). The posterior
expected FNR and FDR are calculated as:
FNR =
PM
m=1
R T
0 (1 −d(m)
kt )υ(m)
kt dt
M
R T
0 dt −PM
m=1
R T
0 d(m)
kt dt + κ0
≈
PM
m=1
PtW
t=t1(1 −d(m)
kt )υ(m)
kt T/W
KT −PM
m=1
PtW
t=t1 d(m)
kt T/W + κ0
,
FDR =
PM
m=1
R T
0 d(m)
kt (1 −υ(m)
kt )dt
PM
m=1
R T
0 d(m)
kt dt + κ0
≈
PM
m=1
PtW
t=t1 d(m)
kt (1 −υ(m)
kt )T/W
PM
m=1
PtW
t=t1 d(m)
kt T/W + κ0
,
where t1, . . . , tW is a ﬁne grid of points equally spaced along [0, T] and κ0 is a small
positive constant to avoid a zero denominator. In summary, our decision rule is to
determine the optimal threshold r∗by r∗= argmin FNR{r ∈[0, 1], FDR ≤αT}. For
each combination of m and t ∈{t1, . . . , tW}, we reject H(m)
0k (t) if υ(m)
kt
≥r∗. For a suﬃ-
ciently ﬁne grid, the results are robust to w, with the optimal threshold appropriately
adapting to the chosen w.
3.2.6
Bayesian Conﬁdence Bands
We construct a Bayesian simultaneous conﬁdence (credible) band for the mean coeﬃ-
cient curve β
(m)
k
(t), k = 1, . . . , K, m = 1, . . . , M, from its posterior MCMC samples.
Assuming there is a collection of posterior sampled curves β(m),s
k
= (β(m),s
k
(t1), . . . , β(m),s
k
(tL))T,
s = 1, . . . , S indexing posterior iterations after burn-in, our goal is to compute a simulta-
neous conﬁdence band for β
(m)
k
(t). The principle in constructing a Bayesian conﬁdence
band is to search for a region Rα = {Rα(t), t ∈[0, T]} such that
Pr{β
(m)
k
(t) ∈Rα(t), t ∈[0, T]} = 1 −α,
where α is a pre-speciﬁed signiﬁcance level.
The strategy is based on pointwise measures of uncertainty. We used the method
59

proposed by Crainiceanu et al. (2007) which assumes approximate posterior normality
at each grid point and derives the 1 −α sample percentile c1−α of
max
l=1,...,L

β(m),s
k
(tl) −ˆβ(m)
k
(tl)
q
c
var(ˆβ(m)
k
(tl))
, s = 1, . . . , S,
where ˆβ(m)
k
(tl) is the posterior mean at time tl and
q
c
var(ˆβ(m)
k
(tl)) is its posterior
standard deviation. A simultaneous conﬁdence region is given by the hyperrectangular
[ˆβ(m)
k
(tl) −c1−α
q
c
var(ˆβ(m)
k
(tl)), ˆβ(m)
k
(tl) + c1−α
q
c
var(ˆβ(m)
k
(tl))], l = 1, . . . , L.
In our implementation, we replaced c1−α by cb which is calculated by cb = max(|cα/2|, |c1−α/2|)
to account for skewness.
3.2.7
Bayesian Cluster Analysis
We propose a Bayesian clustering approach to identify the number of clusters and to
probabilistically assign each individual to the identiﬁed clusters. The nonparametric
LPP2(α, γ, P0) prior has the feature of randomly clustering subjects via global and
local clustering. Given a truncated h∗-dimensional random eﬀects vector θi for the i-th
subject, the LPP2 prior assigns those elements having zij = 1 for j = 1, . . . , h∗together
to a global cluster, while assigning the remaining elements having zij = 0 to their own
clusters. If subjects i and i′ are in the same cluster for the j-th random eﬀect, such that
θij = θi′j, the LPP2 prior will propagate such clustering information to other random
eﬀects, increasing the probability of θij′ = θi′j′, j′ ̸= j.
60

The set of probability weights assignment for both global clustering and local clus-
tering are formulated by a sticking-breaking process:
φij =
∞
X
h=1
πhδh, πh = π∗
h
Y
l<h
(1 −π∗
l ), π∗
h ∼Beta(1, α), j = 0, 1, . . . , h∗,
where φij indexes the assigned cluster for θij, with j = 0 for global clustering and
j = 1, . . . , h∗for each element’s own clustering, and πh is the weight for a set of the
elements (global clustering) or an element (local clustering) to be assigned to the h-th
cluster. Small α favors the assigned clusters to be concentrated on the ﬁrst few ones
to achieve sparseness for posterior computation eﬃciency.
In practical posterior computation, we developed a posterior cluster analysis proce-
dure on the clustering of the subject speciﬁc latent random factors {θi : i = 1, . . . , n}.
We speciﬁed a LPP2 prior on the unknown distributions of the subject speciﬁc latent
factors θi. Denote ob
g,θ for the number of global clusters among {θi : i = 1, . . . , n}
at the b-th iteration in the Gibbs sampler, and similarly denote ob
l,θ for the number
of local clusters.
We obtained the posterior samples of {ob
g,θ : b = 1, . . . , B} and
{ob
l,θ : b = 1, . . . , B}. The overall weight allocated to the local cluster family equals a
priori to 1/(1 + γ) according to the speciﬁcation of LPP2(α, γ, P0) in Dunson (2009).
Given the posterior sample average ˆγ, the proportion of local clustering a posteriori for
θi is estimated by 1/(1 + ˆγ).
3.3
Monte Carlo Simulations
We conducted a set of Monte Carlo simulations to evaluate the false discovery rate
(FDR) and the power of the local hypothesis testing approach. We simulated the two
diﬀusion measures FA and MD along the right internal capsule tract obtained in the
61

clinical study from the following model:
(FAi(dt), MDi(dt))T = (xT
i B(1)
i (dt), xT
i B(2)
i (dt))T + ϵi(dt),
xT
i B(m)
i
(dt) = (β(m)
0i (dt), β(m)
1i (dt), β(m)
2i (dt))xi, m = 1, 2,
(3.9)
where dt ∈[0, L], xi = (1, Gi, Ai) with Gi and Ai referring to the gender and gestational
age of the i-th subject, B(m)
i
(dt) = (β(m)
0i (dt), β(m)
1i (dt), β(m)
2i (dt)) is a 3 × 1 coeﬃcient
vector with its component β(m)
ki (dt), k = 0, 1, 2, to be drawn from a Gaussian process
GP(β(m)
k
(dt), σ2
0ρdt−d′
t), and the measurement error ϵi(dt) is a 2 × 1 vector of Gaus-
sian random variables with mean zero and covariance matrix Σ(dt).
To mimic the
realistic clinic imaging data, we obtain the estimates ˆβ(m)
k
(dt) of β(m)
k
(dt) and ˆΣ(dt) of
Σ(dt) by analyzing the FA and MD measures along the right internal capsule using
the methodology proposed by Zhu et al. (2011).
We set σ2
0 = 0.004 and ρ = 0.5.
Further, ﬁxing (β(m)
0i (dt), β(m)
1i (dt)) for all m and dt at their obtained estimates from
the clinic data, we let (β(1)
2 (dt), β(2)
2 (dt)) = c(dt)(ˆβ(1)
2 (dt), ˆβ(2)
2 (dt)) and consider ﬁve
scenarios for (β(1)
2 (dt), β(2)
2 (dt)): null case of c(dt) = 0 and local alternative cases for
c(dt) = 0.2, 0.4, 0.6, and 0.8.
We analyzed each simulated scenario using 100 repeated simulations. We set n =
32, 64. We randomly chose 16 males and 16 females for n = 32 (32 males and 32 females
for n = 64) from our clinical data and used their values of gender and gestational age to
simulate the values of FA and MD along the right internal capsule tract. We assigned
Ga(1, 1) hyper priors for the hyperparameters α and γ, and Ga(2, 1) priors on a1 and a2.
We speciﬁed ν = 3 and chose 5 log((K + 1)pM) as the starting number of factors. The
exact block Gibbs sampler ran 10,000 iterations, with the ﬁrst 5000 samples discarded
as burn-in. Every 5th sample was collected to thin the chain. For each case, our Gibbs
sampler converges rapidly and exhibits eﬃcient mixing.
62

We conducted the local hypothesis testing of H(m)
0
(dt) :
β(m)
2
(dt)
 ≤ϵ for a point dt
along the right internal capsule tract and the m-th diﬀusion property against H(m)
1
(dt) :
β(m)
2
(dt)
 > ϵ.
We speciﬁed ϵ = 0.1, 0.15, and 0.2.
We evaluated FDR for the
local hypothesis testing procedure at the null case c(dt) = 0 and the local alterna-
tive cases c(dt) = 0.2, 0.4, 0.6, and 0.8, and its powers at the local alternative case
c(dt) = 0.2, 0.4, 0.6, and 0.8. For each simulation, the signiﬁcant levels for the local
hypothesis testing procedure were set at α = 0.01, and 100 replications were used to
estimate the FDR and powers. For a ﬁxed α at the alternative cases, if FDR is smaller
than α, the testing procedure is conservative, whereas if it is observed to be greater
than α, the testing procedure is liberal. At the null case, FDR equals to 1 based on its
deﬁnition. Table 4.1 displays that the FDR is accurate for the sample sizes of 32 and
64. Consistent with our expectations, the statistical power for rejecting the local null
hypotheses increases with the sample size and decreases with the zero neighborhood
size ϵ.
3.4
Clinical DTI Fiber Tract Data
3.4.1
Background and Analysis
The DTI ﬁber tract data comes from a clinical study approved by the Institute Review
Board of the University of North Carolina at Chapel Hill. This larger study was de-
signed to investigate early brain development. Healthy infants less than 1-year old were
recruited with written informed consents obtained from their patients before imaging
acquisition. In our study, a total of 128 healthy full-term infants (75 males and 53
females) are included, whose mean gestational age at MR scanning is 298±17.6 days
(range: 262 to 433 days). All infants were placed with eﬀorts such that they slept
comfortably inside the MR scanner and none of them was sedated during the imaging
63

procedure. They were fed and calmed to sleep on a warm blanket with suitable ear
protection.
The device used to acquire all images is a 3T Allegra head only MR system (Siemens
Medical Inc., Erlangen, Germany), featuring in 40 mT/m for the maximal gradient
strength and 400 mT/(m.msec) for the maximal slew rate. Every subject was scanned
for contiguous slices with slice thickness of 2mm to cover the whole brain. Each slice
was repeated 5 times such that an average was obtained to improve the signal-to-noise
ratio. These acquired DTI images are obtained via a single shot EPI DTI sequence
(TR/TE=5400/73 msec) with eddy current compensation. Diﬀusion gradients were
collected at six non-collinear directions:(1,0,1), (-1,0,1), (0,1,1), (0,1,-1), (1,1,0), and
(-1,1,0), at the b-value level of 1000 s/mm2. The reference scan at the b-value of 0 was
implemented to construct diﬀusion tensor matrices. The voxel resolution was set at
isotropic 2mm, and the in-place ﬁeld of view was set at 256mm in both directions.
The diﬀusion tensors were constructed using a weighted least square estimation
method (Zhu et al., 2007; Basser et al., 1994b). We then processed all 128 DTI data
sets using the image processing steps in the DTI atlas building and compute diﬀusion
properties along all ﬁber tracts of interest.
We focused on analyzing two tracts of
interest including the splenium of the corpus callosum tract and the right internal
capsule tract (Fig. 3.2(a) and Fig. 3.7(a)). We computed fractional anistropy (FA),
mean diﬀusivity (MD), and the three eigenvalues of the diﬀusion tensors, denoted by,
λ1 ≥λ2 ≥λ3, at each grid point on both tracts for each of the 128 subjects. FA denotes
the inhomogeneous extent of local barriers to water diﬀusion, and MD measures the
averaged magnitude of local water diﬀusion. The three eigenvalues of diﬀusion tensor
reﬂect the magnitude of water diﬀusivity along and perpendicular to the long axis of
white matter ﬁbers (Song et al., 2003).
64

We focused on addressing four goals in the analysis of the multiple diﬀusion prop-
erties along the right internal capsule tract and the splenium tract. Our ﬁrst goal was
to determine if there is a diﬀerence in the multiple diﬀusion properties along the ﬁber
bundles between male and female infants. Our secondary goal was to investigate the
development of the diﬀusion properties along the ﬁber bundles vs gestational age. Our
third goal was to accomplish a parsimonious representation of the multiple diﬀusion
trajectories across subjects. Our fourth goal was to examine the covariate-dependent
correlation pattern among the multiple diﬀusion properties along the ﬁber bundles.
We applied SBLFM (3.9) to model the smoothed FA and MD functions (M=2) along
the right internal capsule and the splenium capsule with xi = (Gi, Ai)T, where Gi and
Ai refer to the gender (1 for female and 0 for male) and the gestational age of the ith
infant. We estimated the ith subject speciﬁc functional regression coeﬃcients βm
i (dt) for
the mth functional diﬀusion measure. We then estimated the mean coeﬃcient curve
β
(m)
k
(dt) a posteriori and constructed their 95% Bayesian conﬁdence bands from the
posterior MCMC samples. We also performed local hypothesis testing procedures to
determine if and where gender and gestational age are signiﬁcant in the development
of the diﬀusion trajectories along both of these two ﬁber tracts. The posterior cluster
analysis is conducted to describe how many clusters exist among the 128 infants in
terms of the water diﬀusion properties FA and MD. The correlation analysis is then
implemented to illustrate the development of the correlation pattern between FA and
MD along both ﬁber tracts for male infants of average gestational age of 298 days, as
well as the pattern between the gestational age eﬀects on FA and MD. Finally, based
on the signiﬁcant results for MD, we analyzed the three eigenvalues of diﬀusion tensors
with FA along the two ﬁber tracts.
We assigned Ga(1, 1) hyper priors for the hyperparameters α and γ, a Ga(0.1, 0.1)
prior for the precision parameters σ−2
f , and Ga(2, 1) priors on a1 and a2. We speciﬁed
65

ν = 3 and a default choice of 5 log((K + 1)pM) as the initialized number of factors.
We recommend these settings as default values in other analyses of DTI ﬁber tract
data. We summarized the 1000 posterior samples from the MCMC output with thin-
ning of 5 iterations after the burn-in of 5000 iterations. Using multiple chains with
widely-distributed points, the proposed exact block Gibbs sampler exhibits good rates
of convergence and mixing. This formulation took 519 seconds per 100 iterations in
Matlab 2010b on a Lenovo X61 laptop. We repeated the analysis for a variety of hy-
perparameter values. We multiplied the mean and variance of α and γ by 2 and 0.5,
and multiplied the variance of P0 by 2 and 0.5. We used ν = 3.5, 4, 5 and varied bσ
between 0.1 and 0.5. We also used diﬀerent starting number of factors between 3 and
10. The results are robust with no conclusions changed.
3.4.2
Results: Right Internal Capsule Tract
We initially focused on analyzing the smoothed FA and MD curves (Fig. 3.2(b) and
(c)) of the 128 infants, which were obtained from the adaptive local polynomial kernel
smoothing technique. Our primary interest lies in investigating if and where gender
and gestational age are signiﬁcant in the development of FA and MD along the right
internal capsule tract. We conducted Bayesian local hypothesis testing procedures at
each grid point along the tract to examine the eﬀects of gender and gestation age on FA
and MD values. Fig. 3.3(c) showed that the degrees of both fractional anisotropy and
mean diﬀusivity vary signiﬁcantly between males and females along partial regions of
the right internal capsule tract. The posterior mean eﬀect curves of gender on FA and
MD and their 95% conﬁdence bands (Fig. 3.3(a) and (b)) provided more evidence that
females have less fractional anisotropy than males in a major region of the right internal
capsule tract, and females have stronger mean diﬀusivity than males in half of the tract
with weaker diﬀerences in the other half. The diﬀerence in mean diﬀusivity between
66

males and females are also observed in the sample average MD values (Fig. 3.3(d)).
Such sophisticated diﬀerences between males and females were not discovered by the
previous FRADS and FADTTS methods. Similar to FRADS and FADTTS, Fig. 3.4(b)
found uniformly signiﬁcant eﬀects of gestational age on the FA and MD trajectories.
Additional supportive evidence were observed that FA increases with gestational age
(Fig. 3.4(a) and (c)), while MD decreases with gestational age (Fig. 3.4(d)).
We performed posterior cluster analysis to examine latent clusters in the FA and MD
trajectories along the right internal capsule tract across the 128 infants. The estimated
value of the hyperparameter γ, controlling allocation weight on the local family, equals
0.51 with 95% credible interval of [0.12, 1.20]. This implies that the posterior proportion
of local clustering is 1/3, indicating that the data favors global clustering of the FA and
MD trajectories across infants. The estimated value of the hyperparameter α = 5.34,
with 95% credible interval of [2.59, 9.65]. These values suggest that few clusters are
present in the data and a sparse representation of the data is obtained. This conclusion
is further supported by the estimated values of 4.45, 3.94, and 4.42 for the number of
overall clusters, global clusters, and local clusters respectively (Fig. 3.2(d)).
Along the right internal capsule tract, we further computed the posterior mean
curves of FA and MD (Fig. 3.5(a)) for males of average gestational age, and estimated
the posterior covariance matrix (Fig. 3.5(b) and (c)). Then we obtained correlation
coeﬃcient between FA and MD at each grid point for males of average gestation age. We
observed negative correlations at around 60% of grid points and positive correlation at
the other around 40% of grid points (Fig. 3.5(d)). Moreover, we computed the posterior
covariance matrix for the gestational age eﬀects on FA and MD values (Fig. 3.5(f) and
(g)) and derived the grid pointwise correlation between the gestational age eﬀects on
FA and MD. Fig. 3.5(h) displayed negative correlations at most grid points.
67

In the analysis of the three eigenvalues with FA, we focused on the association be-
tween gender and gestation age with the three eigenvalues and the correlation among the
three eigenvalues along the right internal capsule tract. We examined the association
between both covariates of interest and all eigenvalues along the tract by performing
local hypothesis testing at each grid point. A similar locally signiﬁcant pattern of gen-
der eﬀect was found for all three eigenvalues (Fig. 3.6(b)). Gestational age eﬀect was
found uniformly signiﬁcant for λ2 and λ3, while locally head-and-tail signiﬁcant for λ1
(Fig. 3.6(c)). We observed positive correlation between λ2 and λ3 for both males and
females of mean gestational age (Fig. 3.6(d) and (e)), and positive correlation between
the gestational age eﬀects on λ2 and λ3 (Fig. 3.6(f)). Overall, these correlations are
stronger than those between λ1 and λ3 or λ1 and λ2. This agrees with the small dif-
ferences between λ2 and λ3, while the relatively large diﬀerences between λ1 and λ3 or
λ1 and λ2 in the middle of the right internal capsule tract (Fig. 3.2(e), (f) and (g)).
Finally, we performed a cluster analysis among the three eigenvalues and obtained a
sparse representation of the three eigenvalue functions along the right internal capsule
tract (Fig. 3.2(h)).
3.4.3
Results: Splenium Tract
We applied SBLFM (3.9) to analyze the FA and MD trajectories along the splenium
tract from 128 infants. We started with the Bayesian local hypothesis testing procedure
to identify the region in which gender or gestational age is signiﬁcantly associated with
FA and MD. Fig. 3.8 (c) shows that gender is only slightly signiﬁcant in the head
region for MD development in the splenium tract. The posterior estimation for the
mean eﬀects of gender and the corresponding 95% conﬁdence bands agrees with the
testing results. Fig. 3.8(d)-(e) display the uniformly increasing eﬀects of gestational age
on FA development and decreasing eﬀects on MD development at a major region. The
68

local hypothesis testing results (Fig. 3.8(f)) support that gestational age is uniformly
signiﬁcant along the splenium tract for the developmental change of the degree of
fractional anisotropy, while locally signiﬁcant for that of the degree of mean diﬀusivity.
The posterior sampling distribution of the number of clusters among the 128 infants
is given in Fig. 3.7 (d). The posterior mean estimates of the number of overall clusters,
global clusters, and local clusters are 3.42, 3.07, and 3.40 respectively, indicating that
the 128 infants concentrate on a few clusters. The weight parameter γ for allocation
on the local family was estimated to be 0.38 with 95% credible interval of [0.08, 0.98].
The estimated posterior mean of the proportion of local clustering is 0.28, which means
a favoring of global clustering on infants. The estimated posterior mean of α equals
to 6.46, with 95% credible interval of [2.94, 11.80]. This result agrees with the sparse
clusters identiﬁed in the data.
The posterior estimation of the mean curves of FA and MD for males of average
gestational age and the posterior estimates of their covariance matrices is given in Fig.
3.9 (a)-(c). Fig. 3.9 (d) displays that males of average gestational age have positive
correlations between FA and MD at a major region of the splenium tract. Furthermore,
Fig. 3.9 (e)-(g) displays the estimated gestational age functional eﬀect curves and their
corresponding covariance matrices. We observed that the gestational age eﬀects on FA
and MD are negatively correlated almost over the whole splenium tract (Fig. 3.9 (h)),
which is consistent with the opposite trend of gestational age on FA and MD (Fig. 3.9
(e)).
We additionally found that both gender and gestational age are locally signiﬁcantly
associated with the developmental pattern of the three eigenvalues along the splenium
tract (Fig. 3.10 (b) and (c)). We further observed large correlation between λ2 and λ3
and relatively weak correlation between λ1 and λ2 or λ1 and λ3 for both male and female
of average gestational age. This agrees with the small diﬀerence between λ2 and λ3
69

while relatively large diﬀerence between λ1 and λ3 in the ﬁrst half of the splenium tract
(Fig. 3.7(e), (f) and (g)). We didn’t observe noticeable diﬀerence among the pairwise
correlations of the gestational age eﬀects on the three eigenvalues (Fig. 3.10(h)).
3.5
Discussion
The contributions of our work are twofold. From the statistical perspective, we have
developed a new Bayesian functional analysis pipeline SBLFM for delineating the struc-
ture of the variability of multiple diﬀusion properties along major white matter ﬁber
bundles and their association with a set of covariates of interest. The SBLFM pipeline
integrates ﬁve advanced Bayesian statistical tools from the statistical literature. Com-
pared with the existing literation (Zhu et al., 2010, 2011), our SBLFM explicitly model
the subject-speciﬁc functional covariate eﬀects on the multiple diﬀusion outcome func-
tions and the covariate-speciﬁc correlation structure among the multiple diﬀusion mea-
sures. From the application perspective, we have demonstrated SBLFM in a clinical
study of neurodevelopment.
Our results have revealed the complex inhomogeneous
spatiotemporal maturation patterns of ﬁber bundle diﬀusion properties.
Several limitations need to be addressed in future research. First, since the existing
ﬁber tract based methods including SBLFM requires DTI ﬁber correspondence across
subjects, SBLFM cannot be used to investigate some scenarios in practice. For in-
stance, it is possible that the centroid of the localization of white matter lesion may
vary across time and subjects. In this case, one cannot use both ROI-based methods
and tract based methods. Secondly, although we have used the B-spline basis functions
in SBLFM, it is interesting to consider other basis functions, such as wavelet. Thirdly,
SBLFM is limited to diﬀusion properties along ﬁber bundle, but it is interesting to
consider full DTs and other representations based on high angular resolution diﬀusion
image (HARDI) (Lenglet et al., 2009; Tuch et al., 2002; Schwartzman, 2006; Lepore
70

et al., 2008; Schwartzman et al., 2005; Zhu et al., 2009; Whitcher et al., 2007). Fourthly,
SBLFM can be readily extended to more complex brain structures, such as the medial
manifolds of ﬁber tracts (Yushkevich et al., 2008), functional neuroimaging data (Bow-
man et al., 2008; Woolrich et al., 2004; Lei et al., 2009; G¨ossl et al., 2001), and group
analysis of neuroimaging data (Rosa et al., 2010; Penny et al., 2007).
3.6
Appendix: Posterior Computation
We develop an eﬃcient Markov chain Monte Carlo (MCMC) algorithm for posterior
computation. After truncating the loadings matrix A to h∗≪(K + 1)pM columns,
we adapt an eﬃcient exact block Gibbs sampler (Papaspiliopoulos, 2008) for Dirichlet
mixture models. This exact block Gibbs sampler combines the advantages of the retro-
spective MCMC method (Papaspiliopoulos and Roberts, 2008) and the slice sampling
method (Walker, 2007). It introduces auxiliary variables to avoid truncated approxima-
tions. This algorithm is straightforward to implement and exhibits good performance
in convergence and mixing. We will describe the adaptation strategy on the truncated
level h∗after introducing the Gibbs sampler.
Allowing data to inform information about the hyperparameters involved in the
model through (3.1)−(3.7), we specify α ∼Ga(aα, bα) and γ ∼Ga(aγ, bγ). Introducing
auxiliary variables u = {uih : i = 1, . . . , n;
h = 0, 1, . . . , h∗} to avoid truncated
approximations, the complete data joint likelihood of y, u and z is:
n
Y
i=1
g(Yi; A, θψi, Σ)1(ui0 < πψi0)
h∗
Y
h=1
1(uih < πψih)νzih
h (1 −νh)1−zih,
where Yi is a PM
m=1 nmi × 1 outcome vector for the M measures of the i-th subject, g(·)
is the density function of the outcome vector Yi, i = 1, . . . , n, and the elements in u are
constrained to the interval (0, 1).
71

Starting from the initiation step, the Gibbs sampler at the truncated level h∗pro-
ceeds as follows:
1. Update the hth column of the factor loadings matrix Ah∗, denoted by Ah, from
its conditional distribution
p(Ah|−) ∼N((CT
h Σ−1
N Ch + Σ−1
Ah)−1CT
h Σ−1
N Yh, (CT
h Σ−1
N Ch + Σ−1
Ah)−1),
where Yh = (Y T
1h, . . . , Y T
nh)T with Yih = Yi−P
j̸=h IM⊗BiAjθψij, Ch =






θψ1h(IM ⊗B1)
...
θψnh(IM ⊗Bn)






,
ΣN = In ⊗Σ, ΣAh = diag(φ−1
1,hτ −1
h , . . . , φ−1
(K+1)pM,hτ −1
h ), for h = 1, . . . , h∗.
2. Update φgh from its conditional distribution
p(φgh|−) ∼Ga(v + 1
2
, v + A2
ghτh
2
).
3. Update δ1 from its conditional distribution
p(δ1|−) ∼Ga(a1 + 1
2(K + 1)pMh∗, 1 + 1
2
h∗
X
h=1
τ (1)
h
(K+1)pM
X
g=1
φghA2
gh),
and update δl, l ≥2 from its conditional distribution
p(δl|−) ∼Ga(a2 + 1
2(K + 1)pM(h∗−l + 1), 1 + 1
2
h∗
X
h=l
τ (l)
h
(K+1)pM
X
g=1
φghA2
gh),
where τ (l)
h = Qh
t=1,h̸=l δt, l = 1, . . . , h∗.
72

4. Update σ−2
f , f = 1, . . . , MT, from its conditional distribution
p(σ−2
f |−) ∼Ga(aσ + n
2, bσ + 1
2
n
X
i=1
(yif −(IM ⊗Bi)fAθψi)2),
where (IM ⊗Bi)f denotes the fth row of (IM ⊗Bi).
5. Update uih from its conditional distribution
p(uih|−) ∼Unif(0, πψih).
6. Update the latent zih from its conditional distribution
p(zih|−) ∼Ber(
νhN(yi; A, θi(zih=1), Σ)
νhN(yi; A, θi(zih=1), Σ) + (1 −νh)N(yi; A, θi(zih=0), Σ)),
where θi(zih=j) refers to the current value of θi with inserting θ0φi0h to the hth
component for j = 1, and θ1φihh for j = 0.
7. Update the stick-breaking weights π∗
q from its conditional distribution
p(π∗
q|−) ∼Beta(
h∗
X
h=0
n
X
i=1
1(ψih = q) + 1,
h∗
X
h=0
n
X
i=1
1(ψih > q) + α),
for q ≤ψ∗with ψ∗= max{ψih : i = 1, . . . , n, h = 0, 1, . . . , h∗}, for q > ψ∗, sample
π∗
q from p(π∗
q|−) ∼Beta(1, α).
8. Update the allocation index ψih from its conditional distribution
P(ψih = q|−) ∝1(q ∈Cπ(uih))N(yi; A, θψih=q, Σ),
where Cπ(uih) = {q : πq > uih} ⊂{1, 2, . . . , ∞}, and π∗
q is sampled for q =
73

1, . . . , ˜ψ such that
˜ψ
X
q=1
π∗
q
Y
l≤q
(1 −π∗
l ) ≥1 −u∗,
where u∗= min{uih : i = 1, . . . , n, h = 0, 1, . . . , h∗}.
9. Update θjq from its conditional distribution
p(θjq|−) ∼Nh∗([diag(1h∗ζjq)+W ′
jqΣ−1
N Wjq]−1W ′
jqΣ−1
N Yjq, [diag(1h∗ζjq)+W ′
jqΣ−1
N Wjq]−1),
in which Yjq refers to the contribution for θjq from subjects with zih = 1 −j and
φih = q. In addition, Wjq = diag(w1, . . . , wn)ZΦR, and Yjq = diag(y1, . . . , yn)ZY ΦY 1n,
where
• wi = IM ⊗BiA,
• Z = Blkdiag(Z1, . . . , Zn) with Zi = diag(1(zi1 = 1 −j), . . . , 1(zih∗= 1 −j)),
• Φ = Blkdiag(Φ1, . . . , Φn) with Φi = diag(1(ψi1 = q), . . . , 1(ψih∗= q)),
• R = 1n ⊗Ih∗,
• ZY = Blkdiag(ZY1, . . . , ZYn) with ZYi = 1(Ph∗
h=1 1(zih = 1 −j) ≥1),
• ΦY = Blkdiag(ΦY1, . . . , ΦYn) with ΦYi = 1(Ph∗
h=1 1(ψih = q) ≥1),
• and 1n is a n × 1 vector of entries of 1.
10. Update ζjq from its conditional distribution Ga(0.5 + h∗/2, 0.5 + θ′
jqθjq/2).
11. Update the hyperparameter γ from its conditional distribution Ga(aγ + h∗, bγ −
Ph∗
h=1 log(1 −νh)).
12. Update the hyperparameter α from its conditional distribution Ga(aα + ψ∗, bα −
Pψ∗
q=1 log(1 −π∗
q)).
74

To choose the eﬀective number of factors, we use an adaptation approach (Bhat-
tacharya and Dunson, 2011) to update the truncated number of factors h∗across
iterations.
Starting with a conservative guess ˜h∗of h∗, we adapt with probability
p(t) = exp(α0 + α1t) at the tth iteration. We specify α0 and α1 such that the chain
comes with adaptation around every 10 iterations at the beginning and exponentially
fast decreasing in adaptation frequency. In detail, at the tth iteration, we monitor
the columns in the factor loadings by comparing ut with p(t), where ut is a sequence
randomly generated from Unif(0, 1). If ut ≤p(t), we remove the columns having all
elements within some pre-speciﬁed small zero neighborhood, called redundant columns,
and retain non-redundant columns for other parameters. If no such redundant column
is detected, we add a new column to the loadings, and sample other parameters from
their prior distributions to ﬁll in the additional columns.
75

Table 3.1: Simulation study: FDR and power of the local hypothesis tests for the
eﬀects of gestational age on FA and MD along the right internal capsule tract,
evaluated at ﬁve diﬀerent values of c and three diﬀerent values of ϵ for sample sizes
of 32 and 64 subjects.
ϵ = 0.1
ϵ = 0.15
ϵ = 0.2
n
c
FDR
Power
FDR
Power
FDR
Power
32
0
1.00
-
1.00
-
1.00
-
0.2
0.01
0.52
0.01
0.45
0.01
0.40
0.4
0.01
0.88
0.01
0.84
0.01
0.80
0.6
0.01
0.98
0.01
0.96
0.01
0.95
0.8
0.01
0.99
0.01
0.99
0.01
0.99
64
0
1.00
-
1.00
-
1.00
-
0.2
0.01
0.74
0.01
0.68
0.01
0.64
0.4
0.01
0.98
0.01
0.96
0.01
0.95
0.6
0.01
0.99
0.01
0.99
0.01
0.99
0.8
0.01
1.00
0.01
1.00
0.01
1.00
76

Fig. 3.1: A schematic overview of SBLFM: a multivariate semiparametric varying-
coeﬃcient model for multiple diﬀusion properties, a MCMC posterior estimation
method for estimating the coeﬃcient functions, a construction of Bayesian conﬁdence
bands of the mean covariate eﬀect curves, a Bayesian local hypothesis testing procedure,
and a posterior cluster analysis procedure.
77

Fig. 3.2: Right internal capsule tract description: (a) the right internal capsule tract
extracted from the tensor atlas with color presenting mean FA value; diﬀusion proper-
ties of FA in panel (b), MD in panel (c), λ1 in panel (e), λ2 in panel (f), λ3 in panel
(g); the number of clusters posteriori in FA and MD trajectories in panel (d) and the
number of clusters posteriori in λ1, λ2 and λ3 trajectories in panel (h).
78

Fig. 3.3: Results of the gender eﬀects on FA and MD along the right internal capsule
tract: the estimated coeﬃcient curves (–) and the corresponding 95% conﬁdence bands
(- -) for FA in panel (a) and MD in panel (b); (c) the posterior probability curves in
favor of the grid point-wise alternative hypotheses; (d) the estimated mean FA and
MD.
79

Fig. 3.4: Results of the gestational age eﬀects on FA and MD along the right internal
capsule tract: (a) 3D surf plot of FA along the right internal capsule tract for visualizing
the gestational age eﬀects ; (b) the posterior probability curves in favor of the grid point-
wise alternative hypotheses; the estimated coeﬃcient curves (–) and the corresponding
95% conﬁdence bands (- -) for FA in panel (c) and MD in panel (d).
80

Fig. 3.5: Results from the analysis of FA and MD along the right internal capsule tract:
(a) the posterior estimated curves of FA and MD for males of average gestational age;
the estimated covariance matrices for FA in panel (b) and MD in panel (c) for males
of average gestational age; (d) the estimated correlations between FA and MD for
males of average gestational age; (e) the posterior estimated gestational age eﬀects; the
estimated covariance matrices for the gestational age eﬀects on FA in panel (f) and MD
in panel (g); (h) the estimated correlations between the gestational age eﬀects on FA
and MD.
81

Fig. 3.6: Results from the analysis of the three eigenvalues of diﬀusion tensor on the
right internal capsule tract: (a) the estimated mean functions for λ1 (blue), λ2 (red) and
λ3 (green); the posterior probability curves in favor of the grid point-wise alternative
hypotheses for the gender eﬀects in panel (b) and the gestational age eﬀects in panel
(c); the estimated correlations among λ1, λ2 and λ3 for males of mean gestational age in
panel (d) and females of mean gestational age in panel (e), and among the gestational
age eﬀects on λ1, λ2 and λ3 in panel (f).
82

Fig. 3.7: Splenium tract description: (a) the splenium capsule tract extracted from the
tensor atlas with color presenting mean FA value; diﬀusion properties of FA in panel
(b), MD in panel (c), λ1 in panel (e), λ2 in panel (f), λ3 in panel (g); the number of
clusters posteriori in FA and MD trajectories in panel (d) and the number of clusters
posteriori in λ1, λ2 and λ3 trajectories in panel (h).
83

Fig. 3.8: Results from the analysis of FA and MD along the splenium tract: the esti-
mated coeﬃcient curves (–) and the corresponding 95% conﬁdence bands (- -) for the
gender eﬀects (panel (a) for FA and panel (b) for MD) and the gestational age eﬀects
(panel (d) for FA and panel (e) for MD); the posterior probability curves in favor of
the grid point-wise alternative hypotheses for the gender eﬀects (panel (c)) and the
gestational age eﬀects (panel (f)).
84

Fig. 3.9: Results from the analysis of FA and MD along the splenium tract: (a) the
posterior estimated curves of FA and MD for males of average gestational age; the
estimated covariance matrices for FA in panel (b) and MD in panel (c) for males
of average gestational age; (d) the estimated correlations between FA and MD for
males of average gestational age; (e) the posterior estimated gestational age eﬀects; the
estimated covariance matrices for the gestational age eﬀects on FA in panel (f) and MD
in panel (g); (h) the estimated correlations between the gestational age eﬀects on FA
and MD.
85

Fig. 3.10: Results from the analysis of the three eigenvalues of diﬀusion tensor on the
splenium tract: (a) the estimated mean functions for λ1 (blue), λ2 (red) and λ3 (green);
the posterior probability curves in favor of the grid point-wise alternative hypotheses
for the gender eﬀects in panel (b) and the gestational age eﬀects in panel (c); the
estimated correlations among λ1, λ2 and λ3 for males of mean gestational age in panel
(d) and females of mean gestational age in panel (e), and among the gestational age
eﬀects on λ1, λ2 and λ3 in panel (f).
86

Chapter 4
Bayesian Sticky HDP Inﬁnite
Hidden Markov Circumplex Model
4.1
Introduction
The circumplex model is useful in the study of aﬀects, which refer to the experience of
feeling or emotion (Huitt, 2003). Aﬀective states are depicted by a circular structure
based on the dimensions of valence and arousal (Russell and Carroll, 1999), as shown
in Fig (4.1), where valence refers to the intrinsic attractiveness (positive valence) or
aversiveness (negative valence) (Frijda, 1986), and arousal refers to being awake or
reactive to stimuli (Csikszentmihalyi, 1998; Mirr, 2001). Each emotion arises as a linear
combination of these two dimensions, or as varying degrees of both valence and arousal.
For example, Joy is conceptualized as an aﬀect produced by strong activation in the
neural systems associated with positive valence or pleasure and moderate activation in
the neural systems associated with arousal. Similarly, other aﬀects are the products of
the activities of these two neurophysiological systems in which the degrees of activation
diﬀer.
Hence, speciﬁc emotions arise from cognitive interpretations and labeling of
these activation patterns of these two neurophysiological systems.

Within this circumplex model, aﬀects having the same valence tend to have substan-
tial positive correlation, while aﬀects of the opposite valence tend to have weak negative
correlation. This phenomenon is referred to as “two fundamental psychometric prin-
ciples” in Watson and Clark (1997). These two principles underlie their conceptual
theory of the independence between “Positive Aﬀect” and “Negative Aﬀect” (Watson
and Tellegen, 1985) and have been tested in the scales of Positive and Negative Aﬀect
Schedule (PANAS) for the assessment of aﬀects (Watson et al., 1988). The correlation
between two aﬀects is modeled as a function of the angle between them in the circular
ordering.
Circumplex model has been studied in the literature to model the correlation struc-
ture among aﬀects. Correlations between adjacent scales with the circular ordering
are the highest. As circular separation increases, correlations decrease. Hence, the
corresponding correlation matrix has a circumplex structure, such that correlations
decrease ﬁrst and then increase when one moves away from the main diagonal. Un-
der the constraint of the circumplex structure, Guttman (1954) and Anderson (1960)
proposed stochastic processes on the circumference of the circle which produce positive
correlations with moving average and Markov properties respectively. Methods allowing
negative correlations are developed in Cudeck (1986) and Wiggins et al. (1981). Browne
(1992) extended the model of Anderson (1960) to allow for negative correlations. Lenk
et al. (2006) extended the work of Browne (1992) from Bayesian perspective and accom-
modated subject-speciﬁc random eﬀects to account for personal response scale usage
and subject-speciﬁc factors.
Circumplex model is a type of multidimensional scaling (MDS) methods, which is
a family of models that map a group of objects into a low dimensional space where
points representing the objects and the distances between the points corresponding to
the similarity/dissimlarity measure among the objects. It aims to seek a conﬁguration
88

of points such that the distances “match” the similarities as well as possible. MDS
methods have been applied into a wide variety of disciplines, including behavior science,
social science, political science, marketing research, biomedical science, and so on. It
sprung from psychometric analysis to evaluate the similarity of people’s judgements over
a set of objects with the ﬁrst appearance (Torgerson, 1952). During the recent decade of
the bursting of high-dimensional large data sets, MDS was applied to gene analysis like
revealing the relational pattern of gene-expressions (Taguchi and Oono, 2005). In the
frontier of the biotechnological ﬁeld, MDS was applied for protein structure prediction
(Mooney et al., 2006) and the quality assessment of mass spectrometry data (Harezlak
et al., 2007).
This chapter is motivated by a data set from a clinical study which is designed to
understand the mechanism of emotion regulation based on empirical measurements.
Participants were measured on a 17-scale PANAS measures in a daily diary study
for a total of 7 days. Each subject reports their aﬀect scales 5 times each day, with
4 times at day and 1 time at night.
The resultant data structure corresponds to
the traditional cross-sectional circumplex data while measured repeatedly over time.
Hence, we call such kind of data as longitudinal circumplex data. A major interest
to analyze this data set is to discover the latent emotion states hidden in the emotion
items of the PANAS ratings.
An appropriate circumplex model for the analysis of
such longitudinal circumplex data has not been developed in the literature. We are
motivated to bridge the gap between the statistical methods of emotion regulation and
the existing longitudinal circumplex data.
The analysis of the longitudinal circumplex data should consider the temporal struc-
ture of emotions. In the past few decades, researchers tended to conceptualize emotion
as a process. Emotion is regarded as versatile, ”dynamic”, and often shows persistent
patterns of self-regularity (Carver and Scheier, 1982; Chow et al., 2004; Larsen, 2000).
89

In this chapter, we target to extend the work of Lenk et al. (2006) to a semiparamet-
ric Bayesian state-space circumplex model for the analysis of longitudinal circumplex
data. Assuming an inﬁnite many collection of emotion states hidden in the population,
a hierarchical Dirichlet proces (Teh et al., 2006) is used to facilitate the discovery of
the time related state-switching structure. In addition, a sticky component (Fox et al.,
2008) is added to address the phenomenon of emotion persistence.
Section 4.2 introduces the model and associated inferences motivated by the above
considerations. Section 4.3 introduces an MCMC algorithm for posterior computation.
Section 4.4 is for an illustrative simulation. Section 4.5 applies the model to an emotion
data set. Section 4.6 makes some further discussion.
4.2
Bayesian Sticky HDP-iHMM Circumplex Model
4.2.1
Circumplex Model
Circumplex model is a useful tool to quantify the correlation structure among aﬀective
states where the underlying structure of aﬀective states can be characterized on the
circumference of a circle. Consider a latent response score Yi,j of the ith subject to the
jth item representing an aﬀective state, i = 1, . . . , n, j = 1, . . . , J. Lenk et al. (2006)
proposed a random eﬀects circumplex model for the latent response variable Yi,j:
Yi,j = Uj + Hi + Ai sin θj + Bi cos θj + ϵi,j, θ1 = 0, θj ∈[0, 2π],
(4.1)
where Uj is a scalar for the mean latent response for the jth item, Hi is a scalar for the
ith subject speciﬁc random eﬀect to capture scale-usage eﬀects, Ai and Bi are scalars
specifying the random factor scores for the ith subject, and sin θj and cos θj are the
jth item speciﬁc loadings, which are constrained to the unit circle. The error term ϵi,j,
i = 1, . . . , n, j = 1, . . . , J are independently and normally distributed with mean 0 and
90

variance σ2
j speciﬁc to the jth item.
The subject by item interaction term Ai sin θj+Bi cos θj characterizes the circumplex
correlation. Specifying Hi ∼N(0, λ2), Ai ∼N(0, τa), Bi ∼N(0, τb), and letting τa =
τb = τ makes the inter-item correlations to have a circumplex structure, after adjusting
for the scale-usage eﬀects.
Conditional on the angles, the variance of Yi,j and the
covariance between Yi,j and Yi,k are given by
Var(Yi,j|θj)
=
λ2 + τ 2 + σ2
Cov(Yi,j, Yi,k|θj, θk)
=
λ2 + τ 2 cos(θj −θk).
4.2.2
Sticky HDP-iHMM State-space Circumplex Model
Considering our motivated data, suppose i = 1, . . . , n subjects respond to j = 1, . . . , J
items on a rating scale with G ordinal categories over t = 1, . . . , T time points. Let
Wi,j,t denote the rating of the ith subject toward the jth item at time t. We introduce
a set of the ith subject speciﬁc ordered latent cut points {ci,g}: ci,0 = −∞, ci,1 =
−1 < ci,2 < . . . < ci,G−2 < ci,G−1 = 1, ci,G = ∞. We assume that the observed ordinal
response Wi,j,t is associated with a latent response variable Yi,j,t falling between two
latent cutpoints:
Wi,j,t = g,
iﬀ
ci,g−1 ≤Yi,j,t < ci,g,
for
g = 1, . . . , G.
We extend model (4.1) to accommodate the dynamics of the latent response over time
by modeling the latent responses Yi,j,t:
Yi,j,t = Uj + Hi,t + Ai,t sin θj + Bi,t cos θj + ϵi,j,t, θ1 = 0, θj ∈[0, 2π].
(4.2)
91

where Uj is the mean latent response of the jth item, Hi,t, Ai,t and Bi,t are the ith
subject speciﬁc latent random eﬀects vector at time t, and sin θj and cos θj are the jth
item speciﬁc loadings. The error terms ϵi,j,t are assumed to be independently drawn
from N(0, σ2
j).
We introduce the sticky inﬁnite state hidden Markov model via hierarchical Dirichlet
proces (HDP-iHMM) (Fox et al., 2008) for the subject speciﬁc latent random factor
scores φi,t = (Hi,t, Ai,t, Bi,t)T:
φi,t|si,t, {φ∗
k}∞
k=1 = φ∗
si,t
{φ∗
k}∞
k=1|P0 ∼P0, P0 : φ∗
k ∼N(0, diag(λ2, τ 212))
si,t|si,t−1, {ωe}∞
e=1 ∼Mult(ωsi,t−1)
{ωe}∞
e=1|α, κ, β ∼DP(α + κ, αβ + κδe
α + κ
)
β|γ ∼Stick(γ),
(4.3)
where si,t denotes the state of the ith subject at time t, the inﬁnite collection of state
speciﬁc parameters {φ∗
k}∞
k=1 are drawn from a 3-dimensional normal base measure P0,
ωe corresponds to the state e speciﬁc transition distribution, κ > 0 is the self-transition
parameter for the current state e, β is the average transition distribution. The average
transition distribution β is formulated by a stick-breaking process of parameter γ.
The state speciﬁc transition distribution ωe is generated from the Dirichlet process
with central transition distribution β as the base measure and a precision parameter
α controlling the degree of deviation. The current state si,t depends on the previous
state si,t−1 via the multinomial distribution of transition parameters ωsi,t−1.
The Bayesian speciﬁcation is completed by assigning priors on other parameters in
the model (4.2). We place the multivariate normal prior on the item mean responses
vector U = (U1, . . . , UJ)T, the conditionally uniform prior on the latent cutpoints ci,
92

the gamma priors on σ−2
j , λ−2, and τ −2, and the extended Von Mises priors on the
angles θj:
U
∼
N(µ0, Σ0),
ci
∼
X(−1 < ci,2 < . . . < ci,G−2 < 1),
ci,g|ci,g−1, ci,g+1
∼
Unif(ci,g−1, ci,g+1), g = 2, . . . , G −2,
σ−2
j
∼
Ga(r0, s0), λ−2 ∼Ga(u0,1, v0,1), τ −2 ∼Ga(u0,2, v0,2),
θj
∼





VM(d0, Q0, [0, π]),
for j = 2,
VM(d0, Q0, [0, 2π]),
for j > 2.
(4.4)
where d0 = (0, 1)T, Q0 = 0.2I2. This Von Mises distribution is fairly ﬂat on [0, 2π].
The probability density function of the extended Von Mises distribution VM(d, Q, C)
is given by p(θ|d, Q, C) ∝exp{−0.5(ξ(θ) −d))TQ(ξ(θ) −d)}X(θ ∈C), where ξ(θ) =
(sin(θ), cos(θ))T, d is a two-dimensional vector, Q is a 2×2 matrix, X(·) is the indicator
function, and C is a subset of [0, 2π].
4.2.3
Background: Dirichlet Processes
Dirichlet Process
A Dirichlet process (DP) (Ferguson, 1973, 1974) deﬁnes a distribution for a random
density function G(φ) on a parameter space Φ, denoted by G(φ) ∼DP(γ, P0). The
stick-breaking representation (Sethuraman, 1994) expresses G(φ) as
G(φ)
=
∞
X
k=1
βkδφ∗
k(·), φ∗
k
i.i.d
∼P0
βk
=
β∗
k
Y
l<k
(1 −β∗
l ), β∗
k
i.i.d
∼Beta(1, γ), k = 1, . . . , ∞,
(4.5)
93

where βk is a probability weight formulated from a stick-breaking procedure, δφ∗(·)
denotes a point mass at φ∗which is sampled from P0, P0 is a central probability
measure as a prior guess, and γ is a precision parameter expressing conﬁdence in the
prior guess. Under this formulation, the probability of φ allocated to δφ∗
k(·) is equivalent
to βk. We denote the distribution on the set of weights β = {βk}∞
k=1 by β ∼Stick(γ).
The discreteness of G implied from the deﬁnition of the DP process generates a
clustering structure in the samples drawn from G.
Suppose φi ∼G, i = 1, . . . , n.
Integrating over G, the predictive distribution of φn+1 is obtained from the P´olya urn
representation (Blackwel and Macqueen, 1973)
φn+1|φn, γ, P0 ∼
K
X
k=1
nk
γ + nδφ∗
k +
γ
γ + nP0,
(4.6)
where {φ∗
k}K
k=1 denote the distinct values (clusters) taken by the set {φi}n
i=1, nk is the
number of φi’s taking the value of φ∗
k, and the hyperparameter γ determines the weight
for a new cluster to be created.
The above P´olya urn sampling scheme is closely related to the Chinese restaurant
process. Let φi as a customer entering a restaurant with inﬁnitely many tables, and
each table serving a unique dish φ∗
k. Every arriving customer chooses a already occupied
table with a probability in proportion to the number of customers currenly sitting at
this table, and a new table with a probability in proportion to γ. It is implied that
small γ favors fewer tables to be selected.
The DP is commonly used as a nonparametric prior for the distribution of the
parameters in a mixture model of unknown complexity. Assume we have an observation
yi ∼F(φi) with φi ∼G(φ). The above sample scheme generates an indication variable
zi to denote the mixture component for the observation yi ∼F(φ∗
zi). Unlike standard
mixture models having ﬁxed number of mixture components, the DP prior allows an
94

inﬁnite number of mixture components and lets the data inform the actual number of
components.
Hierarchical Dirichlet Process
Teh et al. (2006) extends the DP to the hierarchical Dirichlet Process (HDP) for cases
where groups of mixture model generative data are related but with an unknown shar-
ing structure. Assume J groups of data yji ∼F(φji). The HDP generates a global
probability measure G0 ∼DP(γ, P0) on the parameter space Φ and then draws the
group speciﬁc distribution Gj ∼DP(α, G0). The global measure G0 acts as a central
distribution for Gj, with α controlling the degree of variability. The stick-breaking
representation expresses G0 and Gj as:
G0
=
∞
X
k=1
βkδφ∗
k(·),
β = {βk}∞
k=1 ∼Stick(γ)
Gj
=
∞
X
k=1
ωjkδφ∗
k(·),
ωj = {ωjk}∞
k=1 ∼DP(α, β),
(4.7)
where φ∗
k
i.i.d
∼P0. Since G0 is discrete, each Gj shares the same set of global parameters
but with diﬀerent sets of weights. An indicator variable zji ∼Mult(ωj) (multinomial
distribution) is generated to link an observation yji to the unique global parameter φ∗
zji.
Multiple φji’s might take identical values of some global parameter φ∗
k.
An equivalent representation of the HDP mixture model is given via the following
conditional distributions:
yji|zji, {φ∗
k}∞
k=1
∼
F(φ∗
zji),
φ∗
k
∼
P0,
zji
∼
Mult(ωj),
ωj|α, β
∼
DP(α, β),
β
∼
Stick(γ).
(4.8)
95

The underlying process generating the HDP mixture model can be described using
the metaphor of a Chinese restaurant franchise (CRF) (Teh et al., 2006). There are
J restaurants (groups) sharing a global menu G0. Each jth restaurant has inﬁnitely
many tables (clusters) serving dishes (parameters) for customers (observations), and its
own menu Gj deﬁning the customer sitting structure. Integrating out the jth restau-
rant speciﬁc menu Gj, customer yji sits at already occupied table tji with probability
proportional to the number of currently seated customers or selects a new table with
probability proportional to α. The conditional distribution of dish φji for customer yji
is given by
φji|φ−i
j , α, G0 ∼
Tj
X
t=1
njt
α + Nj −1δφ∗
jt +
α
α + Nj −1G0,
(4.9)
where njt is the number of customers in the jth restaurant sitting at table t and sharing
dish (parameter) φ∗
jt, and φ−i
j
= {φj1, . . . , φji−1, φji+1, . . . , φjNj}. Integrating out G0,
each table serves a dish (parameter) φ∗
jt = φ∗
kjt with probability proportional to the
number of other tables serving that dish in the franchise, or chooses a new dish with
probability proportional to γ. The conditional distribution of the dish φ∗
jt is written as
φ∗
jt|Φ∗
1, . . . , Φ∗
j−1, Φ∗(−t)
j
, γ, P0 ∼
M
X
k=1
mk
γ + P
k mk
δφ∗
k +
γ
γ + P
k mk
P0,
(4.10)
where Φ∗
r = {φ∗
r1, . . . , φ∗
rTr} includes all the dishes in the rth restaurant, Φ∗(−t)
j
includes
all the dishes in the jth restaurant except the dish φ∗
jt, mk is the number of tables in
all restaurants serving the dish φ∗
k, and M denotes the number of global dishes already
served in the franchise. Observation yji is then drawn from the generating distribution
F(φ∗
zji) with the parameter φ∗
zji = φ∗
jtji = φ∗
kjtji.
The HDP mixture model can be derived as the limit of a sequence of ﬁnite hi-
erarchical mixture model (Ishwaran and Zarepour, 2002; Teh et al., 2006; Fox et al.,
96

2008):
β
∼
Dir(γ/L, . . . , γ/L)
ωj
∼
Dir(αβ1, . . . , αβL),
(4.11)
where the number of mixture components L →∞. This weak limit approximation is
useful to develop eﬃcient blocked posterior sampling algorithm.
4.2.4
The Sticky HDP-iHMM Model
To model the situations where a system changes over time in a discontinuous fashion,
regime-switching state-space models is a good choice. Regimes refer to discrete stages
between which certain parameters or characteristics of the system switch. The dynamics
of emotions experienced by each subject can be regarded as two discrete “regimes” along
the valence dimension, positive and negative emotion phases, and unknown, potentially
inﬁnitely many “regimes” along the arousal dimension. The emotion switching system
has the feature of state persistence, where a currently experienced emotion state is
reluctant to move to another state. Hence, we use the sticky HDP-iHMM model (Teh
et al., 2006; Ni et al., 2007; Fox et al., 2008) to address the time related state-switching
structure and the self-transition feature in the time-dependent latent emotion factor
φi,t in model (4.3).
Assume the subject speciﬁc time-dependent parameters φi,t = (Hi,t, Ai,t, Bi,t)T switch-
ing among an inﬁnite collection of emotion and arousal regimes. Let each HDP group-
speciﬁc set of weights, ωj act as a state-speciﬁc transition distribution in the inﬁnite
state space (inﬁnitely many groups). Denote zit for the current emotion state of the
Markov chain for the ith subject at time t. The current state zit is generated from the
97

multinomial distribution of transition parameters ωzit−1,
zit ∼Mult(ωzit−1),
(4.12)
where zit−1 indexes the group to which yit is assigned.
The current state zit links
the parameter φ∗
zit to φi,t. To incorporate the self-transition feature, the state-speciﬁc
transition distribution ωj is speciﬁed as,
ωj ∼DP(α + κ, αβ + κδj
α + κ
),
(4.13)
where κ > 0 is the self-transition sticky parameter for the current state j, and δj denotes
a point mass at the current state j. The original HDP-iHMM model is retrieved when
κ = 0.
The Chinese restaurant metaphor of the sticky HDP-iHMM model now has a special
family of loyal customers to the franchise. Denote zt−1 as the grandparent,zt as the
parent, and zt+1 as the child. The parent enters a restaurant j which its parent chose
zt−1 = j, and chooses a table tji ∼ωj which serves dish kjtji.
It is implied that
zt = zji = kjtji. The increased family favor will likely to drive the child to choose
the same dish as its parent, and in turn, develops a loyal family to the franchise over
generations. On the other side, it is also possible that the child turns away from its
parent’s occasional un-popular choice to the most popular dish served in this franchise.
Hence, such sticky (loyalty) feature can be observed in the increased popularity of a
table dish randomly chosen by
kjt ∼Mult(αβ + κδj
α + κ
).
(4.14)
A set of auxiliary random variables ¯kjt and qjt is introduced to facilitate the inference
98

algorithm:
¯kjt
∼
β,
qjt
∼
Ber(
κ
α + κ),
kjt
=





¯kjt,
qjt = 0;
j,
qjt = 1,
(4.15)
where qjt is an indicator variable with the value of 1 to override the current state as
the previous state, and 0 to move to any state randomly silencing the sticky tendency.
4.3
Posterior Computation
In this section we develop a block z Gibbs sampler to implement the sticky HDP-iHMM
circumplex model. We incorporate the block z sampler of Fox et al. (2008) to sample
the parameters φi,t = (Hi,t, Ai,t, Bi,t)T, where a variant of the HMM forward-backward
procedure is used to harness the Markov structure and jointly sample the state sequence
z1:T. A set of auxiliary variables mjk, ¯mjk, and qjt is added to facilitate the block z
sampling. We place the block constraints (Lenk et al., 2006) to sample the item angles
θj.
We deﬁne the following notations for convenient use in the description of the sam-
pler:
• Y = (Y·,1, . . . , Y·,J), where Y·,j = (YT
1,j, . . . , YT
n,j)T, and Yi,j = (Yi,j,1, . . . , Yi,j,T)T,
for i = 1, . . . , n, j = 1, . . . , J,
• Σ = diag(σ2
1, . . . , σ2
J),
• θ = (θ1, . . . , θJ)T,
• X = (XsXc), where Xs = (sin(θ1), . . . , sin(θJ))T and Xc = (cos(θ1), . . . , cos(θJ))T,
99

• H = (HT
1 , . . . , HT
n)T, where Hi = (Hi,1, . . . , Hi,T)T.
• A = (AT
1 , . . . , AT
n)T, where Ai = (Ai,1, . . . , Ai,T)T.
• B = (BT
1 , . . . , BT
n)T, where Bi = (Bi,1, . . . , Bi,T)T.
Starting from the initiation step, the posterior sampler proceeds as follows:
1. Conditional on the previous set of state-speciﬁc transition densities ω(n−1), the
global transition density β(n−1), and the model parameters φ(n−1), U(n−1), θ(n−1),
block sample the state sequences z and the parameters φi,t:
(a) Compute backward messages mt,t−1(k) sequentially in time. Set ω = ω(n−1),
U = U(n−1), θ = θ(n−1). For t ∈{T, . . . , 1}, k ∈{1, . . . , L}, initialize mes-
sages mT+1,T(k) = 1 and then compute mt,t−1(k) = PL
l=1 ωk(l)N(yt; Ul, φl, θl, Σl).
(b) Initialize nkl = 0 and Yk = ∅, (k, l) ∈{1, . . . , L}2. Sequentially sample the
state assignments z1:T forward in time
zt ∼
L
X
l=1
fl(yt)δl,
where fl(yt) = ωzt−1(l)N(yt; Ul, φl, θl, Σl)mt+1,t(l).
Increment nzt−1zt and
update yt to the cached statistics Yzt for sampling φzt.
(c) Sample the auxiliary variables m, ¯m, and q:
i. Denote Jkl = {t|zt−1 = k, zt = l}, for each (k, l) ∈{1, . . . , L}2. Start
with mkl = 0, n = 0, for each t ∈Jkl, sample
x ∼Ber(
αβl + κδ(k, l)
n + αβl + κδ(k, l)),
increment n, and if x = 1 increment mkl.
100

ii. Sample the number of override variables in restaurant k:
qk· ∼Binomial(mkk,
ρ
ρ + βk(1 −ρ)),
for k ∈{1, . . . , L}, where ρ =
κ
α+κ.
iii. Set the number of informative tables in restaurant k serving dish l as:
¯mkl
=





mkl,
k ̸= l;
mkk −qk·,
k = l,
(d) Sample the global transition density via
β ∼Dir(γ/L + ¯m.1, . . . , γ/L + ¯m.L).
(e) Sample the new transition densities ωk and the model parameters φk, k =
1, . . . , L via
ωk
∼
Dir(αβ1 + nk1, . . . , αβk + κ + nkk, . . . , αβL + nkL),
φk
∼
p(φ|η, Yk).
2. Sample U from its conditional distribution N(µu, Σu), where µu = Σu(Σ−1(Y −
H1T
J −AXT
s −BXT
c )T1nT + Σ−1
0 µ0) and Σu = (nΣ−1 + Σ−1
0 ).
3. Sample σ−2
j
from its conditional distribution Ga(r0 + nT/2, s0 + 0.5 P
i,T(Yi,j,t −
Uj −Hi,t −Ai,tsin(θj) −Bi,tcos(θj))2).
4. Sample λ−2 from its conditional distribution Ga(u0,1 + nT/2, v0,1 + HTH/2).
5. Sample τ −2 from its conditional distribution Ga(u0,2 + nT/2, v0,2 + ATA/2 +
BTB/2).
101

6. Sample the latent cutpoints ci,g from the conditional distributions Unif(max(¯yg, ci,g−1),
min(yg+1, ci,g+1)), where ¯yg = max{Yi,j,t : Wi,j,t = g} and yg+1 = min{Yi,j,t :
Wi,j,t = g + 1}, g = 2, . . . , G −2.
7. Sample the latent responses Yi,j,t from the conditional distributions:
(a) for observed Wi,j,t,
p(Yi,j,t|−) ∼N(Uj+Hi,t+Ai,t sin θj+Bi,t cos θj, σ2
j)X(ci,wi,j,t−1 < Yi,j,t < ci,wi,j,t).
(b) for missing Wi,j,t,
p(Yi,j,t|−) ∼N(Uj + Hi,t + Ai,t sin θj + Bi,t cos θj, σ2
j).
8. Sample the item angles θ using a hybrid sampling strategy. These angles are
placed in C blocks of constraints B1, . . . , BC. Denote Bc = min{θj : j ∈Bc} and
¯Bc = max{θj : j ∈Bc} for the minimum and maximum angles in the cth block,
c = 2, . . . , C. For the ﬁrst block, the “minimum” and “maximum” angles are
deﬁned as
B1
=





2π,
if BC > max{θj : j ∈B1};
min{θj : j ∈B1 and θj > ¯BC},
if BC < max{θj : j ∈B1},
¯B1
=
max{θj : j ∈B1 and θj < B2}.
These blocks satisfy the ordering
0 ≤¯B1 < B2 < ¯B2 < . . . < BC < ¯BC < B1 ≤2π.
102

(a) Gibbs step: sample θ from the conditional distribution
p(θ|−)
∝
J
Y
j=1
V M(dj, Qj, Cj),
Qj
=
σ−2
j



ATA
ATB
BTA
BTB


+ Q0,
dj
=
Q−1
j {(A B)T(Y·,j −Uj1nT + A) + Q0d0}
where Cj is the constraint set for θj.
(b) Metropolis step: generate θj from a mixture of R uniform distributions.
Denote b1, . . . , bC for the indices of the last angle in each block such that
1, . . . , b1 ∈B1 and bc−1 + 1, . . . , bc ∈Bc, c = 2, . . . , C.
i. For θj ∈B1, generate the candidate angle from the jump distributions
g1(ψm|ψ2, . . . , ψm−1, θm, . . . , θJ)
∼
R
X
r=1
pr
X(ar,m,1 < ψm < br,m,1)
br,m,1 −ar,m,1
,
ar,m,1
=
max{ ¯BC −2π, θm −ur},
br,m,1
=
min{B2, θm + ur},
for m = 2, . . . , b1. If ψm < 0, set ψm = 2π + ψm.
ii. For θj ∈SC
c=2 Bc, generate the candidate angle from the uniform random
walk
gc(ψm|ψ2, . . . , ψm−1, θm, . . . , θJ)
∼
R
X
r=1
pr
X(ar,m,c < ψm < br,m,c)
br,m,c −ar,m,c
,
ar,m,1
=
max{ ¯Bc−1, θm −ur},
br,m,1
=
min{Bc+1, θm + ur},
103

for m = bc−1 + 1, . . . , bc. Note BC+1 = B1.
The acceptance probability for the candidates are
min{1,
[ψ|Y ] QC
c=1
Qbc
m=bc−1+1 gc(θm|θ2, . . . , θm−1, ψm, . . . , ψJ)
[θ|Y ] QC
c=1
Qbc
m=bc−1+1 gc(ψm|ψ2, . . . , ψm−1, θm, . . . , θJ)
},
where b0 + 1 = 2.
We use a modiﬁed Brier score (Lenk et al., 2006) as the ﬁt measure. After the burn
in, we compute a Brier score at each iteration h:
BS(h) =
1
NG
n
X
i=1
J
X
j=1
T
X
t=1
G
X
g=1
δi,j,t(zi,j,t,g −P(Wi,j,t = g|Ω(h)))2,
where N is the total number of observations, the indicator variable zi,j,t,g = 1 if the
ith subject responded g to the jth item at time t and 0 otherwise, δi,j,t takes the value
of 1 if this record is not missing, and P(Wi,j,t = g|Ω) is the predictive probability for
Wi,j,t = g conditional on the parameters Ωand the data.
4.4
Simulation Study
We conducted a Monte Carlo simulation study to access the performance of the sticky
HDP-iHMM circumplex model. We simulated a three-state sequence data containing
T = 9 time points. At each state s, we generated 16 item responses on a 7 point ordinal
scale for 50 subjects from the following model:
Yi,j,s
=
Uj + Hi,s + Ai,s sin θj + Bi,s cos θj + ϵi,j,s,
Wi,j,s
=
g,
iﬀ
cg−1 ≤Yi,j,s < cg,
for
g = 1, . . . , 7.
(4.16)
104

where the item speciﬁc response means Uj were drawn from N(0, 1), the item speciﬁc
angles θj were randomly generated under the constraints of four blocks along the circle
with four angles in each block, and the state speciﬁc random factors (Hi,s, Ai,s, Bi,s)T
were generated from a 3-dimensional normal distribution with the Gaussian mean of
(−10, 0, 10)T and the diagonal covariance matrix with 0.01 variances. The measurement
error ϵi,j,s was assumed to be drawn from a normal distribution with mean 0 and
variance 0.01. The cutoﬀpoints were set as (−1, −0.6, −0.2, 0.2, 0.6, 1).
We analyzed the simulated data using our sticky HDP-iHMM circumplex model and
applied the block-z Gibbs sampler. The block-z Gibbs sampler ran 7,000 iterations, with
the ﬁrst 2000 samples discarded as burn-in. Every 5th sample was collected to thin
the chain. Our Gibbs sampler converges rapidly and exhibits eﬃcient mixing. We set
0.98 for the self-transition probability in the sticky HDP-iHMM model. We assigned
Ga(1, 1) hyperpriors for the hyperparameters α and γ. We used a truncation level
of L = 5 in the block sampler, while letting the sampler learn a strict subset of the
available states.
Our algorithm was able to recover the true states accurately. Fig. 4.2 plots the true
state sequence in the upper panel and the labeled state sequence learned in the sampler
in the lower panel. Three colors stand for three states, navy for state 1, dodger blue for
state 2, and green yellow for state 3. The true state sequence shares the same color map
as the labeled state sequence. The posterior estimates of the angles are accurate for
the angles in the 2nd to 4th block, while have relatively large bias for the angles in the
ﬁrst block (Table 4.1). The brier score comparing the posteriori predictive probabilities
and the ordinal outcomes was 0.056.
105

4.5
PANAS Data Analysis
The PANAS data comes from a large emotion study.
This study was designed to
investigate the emotion dynamics. Participants were asked to complete a “daily” survey
four times a day for a total of thirty days in addition to one ”nightly” survey each day.
We included 55 individuals who did the daily self-reports of their feelings over the ﬁrst 7
consecutive days. Eight ordinal positive emotion (PE) items and nine ordinal negative
emotion (NE) items measured on a scale from 1 ( = none) to 4 ( = always) were used
for model ﬁtting purpose in the chapter. The PE items include enthusiastic, interested,
determined, active, strong, proud, inspired, and attentive.
The NE items included
scared, afraid, upset, nervous, ashamed, guilty, distressed, jittery, and irritable.
We analyzed the PANAS data set using the sticky HDP-iHMM circumplex model.
We collected 1000 samples for every 5th samples from the block-z Gibbs sampler, after
the initial burn in of 2000 iterations. We initiated a truncation level of L = 5, and
placed Ga(1, 1) hyperpriors for the hyperparameters α and γ. We chose 0.98 for the
self-transition probability, favoring state persistence. The chain converges rapidly and
exhibits eﬃcient mixing. We estimated the item speciﬁc direction posteriori and labeled
the emotion states over the seven days.
The analysis results for the PANAS data are displayed in Fig. 4.3 and 4.4. The
emotions were labeled as two states over the seven days (Fig. 4.3), where the ﬁrst
six days fell in one state, and the seventh day fell in the other state. This result is
supported by the fact that day 7 has the smallest averages of both the diﬀerence and
the ratio between the PE scores and the NE scores (Table 4.2). This phenomenon
concludes that the prolonged eﬀects on emotions from the emotion induction exposure
in the laboratory experiment extended for six days and elapsed in the seventh day.
The estimates of the emotion directions along the unit circle were graphed in Fig. 4.4,
where the PE items are in the right panel and the NE items are in the left panel. The
106

brier score evaluating the distance between the posteriori predictive probabilities and
the ordinal outcomes was 0.063.
4.6
Discussion
We demonstrated the considerable beneﬁts of the extended circumplex model in which
the time related state switching structure is constructed by the sticky HDP-iHMM
model. The circumplex model has been appealing to social science researchers because
of its circular correlation structure of measure items.
Our approach further yields
another appealing feature allowing the capture of the state persistence/switching dy-
namics. We have also presented an eﬃcient sampling technique. The synthetic data
analysis and the empirical application clearly demonstrate the practical importance of
our state-space extensions. We believe that our contributions will facilitate rigorous
tests and increase the popularity of circumplex models in the analysis of psychological
measures.
107

Fig. 4.1: A circular structure of aﬀects classiﬁed into six clusters. PA = positive aﬀect;
NA = negative aﬀect; HighAct = high activation; MediumAct = medium activation;
LowAct = low activation.
108

Table 4.1: Simulation study: estimated directions for the synthetic data.
Standardized
Item
Block
True
Estimate
Bias
Bias
1
1
0.000
0.000
0.000
0.000
2
1
1.425
0.697
-0.723
-0.511
3
1
0.865
0.701
-0.165
-0.190
4
1
1.210
0.650
-0.559
-0.462
5
2
2.828
3.054
0.226
0.080
6
2
2.731
2.853
0.121
0.045
7
2
1.793
1.540
-0.254
-0.141
8
2
2.259
2.840
0.581
0.257
9
3
3.692
3.571
-0.121
-0.033
10
3
3.893
3.594
-0.299
-0.077
11
3
4.064
3.597
-0.467
-0.115
12
3
3.371
3.323
-0.048
-0.014
13
4
6.135
6.148
0.014
0.002
14
4
5.718
5.875
0.157
0.028
15
4
4.968
4.996
0.028
0.006
16
4
5.601
5.884
0.283
0.051
Table 4.2: PANAS data: the averages of the diﬀerence and the ratio between positive
emotion (PE) scores and negative emotion (NE) scores.
day
Measure
Average
1
2
3
4
5
6
7
PE-NE
Average
1.44
1.41
1.48
1.37
1.31
1.37
1.29
PE/NE
Average
2.23
2.22
2.34
2.29
2.18
2.22
2.17
109

Fig. 4.2: Performance of state labeling in the simulated data. Upper panel: the true
state sequence; lower panel: the labeled state sequence.
110

Fig. 4.3: The classiﬁed states for the PANAS data.
111

Fig. 4.4: Plot of the sine versus cosine of the posteriori estimated angles for the PANAS
data. Right panel: positive emotion (PE) items; left panel: positive emotion (NE)
items;
112

Bibliography
Ahmad, I., Leelahanon, S., and Li, Q. (2005), “Eﬃcient estimation of a semiparametric
partially linear varying coeﬃcient model,” The Annals of Statistics, 33, 258283.
Anderson, T. (1960), “Some stochastic process models for intelligence test scores,” in
In K.J. Arrow, S. Karlin, and P. Suppes (Eds.), Mathematical methods in the social
sciences, Stanford, University Press, pp. 205–220.
Ashburner, J. and Friston, K. J. (2000), “Voxel-based morphometry: The methods,”
Neuroimage, 11, 805–821.
Baladandayuthapani, V., Mallick, B. K., Young Hong, M., Lupton, J. R., Turner, N. D.,
and Carroll, R. J. (2008), “Bayesian hierarchical spatially correlated functional data
analysis with application to colon carcinogenesis,” Biometrics, 64, 64–73.
Basser, P. J., Mattiello, J., and LeBihan, D. (1994a), “Estimation of the eﬀective self-
diﬀusion tensor from the NMR spin echo,” Journal of Magnetic Resonance Ser. B,
103, 247–254.
— (1994b), “MR diﬀusion tensor spectroscopy and imaging,” Biophysical Journal, 66,
259–267.
Behseta, S., Kass, R. E., and Wallstrom, G. L. (2005), “Hierarchical models for assessing
variability among functions,” Biometrika, 92, pp. 419–434.
Berrocal, V. J., Gelfand, A. E., and Holland, D. M. (2010), “A spatio-temporal down-
scaler for output from numerical models,” Journal of Agricultural Biological and
Environmental Statistics, 15, 176–197.
Bhattacharya, A. and Dunson, D. B. (2011), “Sparse Bayesian inﬁnite factor models,”
Biometrika, 98, 291–306.
Biller, C. and Fahrmeir, L. (1997), “Bayesian spline-type smoothing in generalized
regression models,” .
Blackwel, D. and Macqueen, J. (1973), “Ferguson distributions via p´olya urn schemes,”
Annals Of Statistics, 1, 353–355.
Bonekam, D., Nagae, L. M., Degaonkar, M., Matson, M., Abdalla, W. M., Barker,
P. B., Mori, S., and Horsk´a, A. (2008), “Diﬀusion tensor imaging in children and
adolescents: Reproducibility, hemispheric, and age-related diﬀerences,” NeuroImage,
34, 733–742.
113

Botts, C. H. and Daniels, M. J. (2008), “A ﬂexible approach to Bayesian multiple curve
ﬁtting,” Computational Statistics & Data Analysis, 52, 5100–5120.
Bowman, F. D., Caﬀo, B., Bassett, S. S., and Kilts, C. (2008), “A Bayesian hierarchical
framework for spatial modeling of fMRI data,” NeuroImage, 39, 146 – 156.
Brezger, A., Fahrmeir, L., and Hennerfeind, A. (2007a), “Adaptive Gaussian Markov
random ﬁelds with applications in human brain mapping,” Journal of Royal Statis-
tical Society C, 56, 327–345.
— (2007b), “Adaptive Gaussian Markov random ﬁelds with applications in human
brain mapping,” J. Roy. Statist. Soc. C, 56, 327–345.
Brezger, A. and Lang, S. (2006), “Generalized structured additive regression based on
Bayesian P-splines,” Comput. Statist. Data Anal, 50, 967–991.
Browne, M. (1992), “Circumplex models for correlation matrices,” Psychometrika, 57,
469–497, 10.1007/BF02294416.
Brumback, B. and Rice, J. A. (1998), “Smoothing spline models for the analysis of
nested and crossed samples of curves (with discussion),” J. Amer. Statist. Assoc.,
93, 961994.
Bush, C. and MacEachern, S. (1996), “A semiparametric Bayesian model for ran-
domised block designs,” Biometrika, 83, 275–285.
Cai, J., Fan, J., Zhou, H., and Zhou, Y. (2007), “Hazard models with varying-
coeﬃcients for multivariate failure time data,” Ann Statist, 35, 324354.
Cai, Z., Fan, J., and Li, R. (2000a), “Eﬃcient estimation and inferences for varying-
coeﬃcient models,” J. Amer. Statist. Assoc., 95, 888902.
Cai, Z., Fan, J., and Yao, Q. (2000b), “Functional-coeﬃcient regression models for
nonlinear time series,” J. Amer. Statist. Assoc., 95, 941956.
Cai, Z. and Sun, Y. (2003), “Local linear estimation for time-dependent coeﬃcients in
Coxs regression model,” Scand J of Statist, 30, 93111.
Camara, E., Bodammer, N., Rodriguez-Fornells, A., and Tempelmann, C. (2007), “Age-
related water diﬀusion changes in human brain: A voxel-based approach,” NeuroIm-
age, 34, 1588–1599.
Carroll, R. J., Ruppert, D., and Welsh, A. H. (1998), “Local estimating equations,” J.
Amer. Statist. Assoc., 93, 214227.
Carvalho, C. M., Chang, J., Lucas, J. E., Nevins, J. R., Wang, Q., and West, M.
(2008), “High-dimensional sparse factor modeling: Applications in gene expression
genomics,” J. Amer. Statist. Assoc. , 103, 1438–1456.
114

Carver, C. S. and Scheier, M. F. (1982), “Control-theory - a useful conceptual-
framework for personality-social, clinical, and health psychology,” Psychological Bul-
letin, 92, 111–135.
Cascio, C. J., Gerig, G., and Piven, J. (2007), “Diﬀusion tensor imaging: Application
to the study of the developing brain,” J Am Acad Child Adolesc Psychiatry, 46,
213–223.
Chen, R. and Tsay, R. J. (1993), “Functional-coeﬃcient autoregressive models,” J.
Amer. Statist. Assoc., 88, 298308.
Chen, Y. S., An, H. Y., Zhu, H. T., Stone, T., Smith, J. K., Hall, C., Bullitt, E., Shen,
D. G., and Lin, W. L. (2009), “White matter abnormalities revealed by diﬀusion
tensor imaging in non-demented and demented HIV+ patients,” NeuroImage, 47,
1154–1162.
Chiang, C.-T., Rice, J. A., and Wu, C. O. (2001), “Smoothing spline estimation for
varying coeﬃcient models with repeatedly measured dependent variables,” J. Amer.
Statist. Assoc., 96, 605619.
Chow, S.-M., Nesselroade, J. R., Shifren, K., and McArdle, J. J. (2004), “Dynamic
structure of emotions among individuals with Parkinsons disease,” Structural Equa-
tion Modeling, 11, 560 – 582.
Cleveland, W. S., Grosse, E., and Shyu, W. M. (1991), Local regression models. In
statistical models in S (Chambers, J. M. and Hastie, T. J., eds),, Wadsworth &
Brooks, Paciﬁc Grove.
Cox, D. R. (1972), “Regression models and life tables (with discussion),” J. Roy. Statist.
Soc. B, 34, 187220.
Crainiceanu, C. M., Ruppert, D., Carroll, R. J., Joshi, A., and Goodner, B. (2007),
“Spatially adaptive Bayesian penalized splines with heteroscedastic errors,” Journal
of Computational and Graphical Statistics, 16, 265–288.
Cruz-Mes´ıa, R. D. L., Fernando, A. Q., and M¨ueller, P. (2007), “Semiparametric
Bayesian classiﬁcation with longitudinal markers,” Journal of Royal Statistical Soci-
ety C, 56, 119–137.
Csikszentmihalyi, M. (1998), Finding Flow: The Psychology of Engagement With Ev-
eryday Life, Basic Books.
Cudeck, R. (1986), “A note on structural models on the circumplex,” Psychometrika,
51, 143147.
Dahl, D. B. (2007), “Comment on article by jain and neal,” Bayesian Analysis, 2,
473–477.
115

De Iorio, M., M¨uller, P., Rosner, G., and MacEachern, S. (2004), “An ANOVA model
for dependent random measures,” J. Amer. Statist. Assoc., 99, 205–215.
Denison, D. G. T., Mallick, B. K., and Smith, A. F. M. (1998a), “A Bayesian CART
algorithm,” Biometrika, 85, 363–377.
— (1998b), “Automatic bayesian curve ﬁtting,” Journal of Royal Statistical Society B,
60, pp. 333–350.
Dimatteo, I., Genovese, C. R., and Kass, R. E. (2001), “Bayesian curve ﬁtting with
free-knot splines,” Biometrika, 88, 1055–1071.
Dunson, D. B. (2009), “Nonparametric Bayes local partition models for random eﬀects,”
Biometrika, 96, 249–262.
Eilers, P. H. C. and Marx, B. D. (1996), “Flexible smoothing with B-splines and penal-
ties,” Statistical Science, 11, 89–102.
Escobar, M. and West, M. (1995), “Bayesian density estimation and inference using
mixtures,” J. Amer. Statist. Assoc., 90, 577–588.
Eubank, R. L., Huang, C. F., Maldonado, Y. M., Wang, N., Wang, S. J., and Buchanan,
R. J. (2004), “Smoothing spline estimation in varying-coeﬃcient models,” J. Roy.
Statist. Soc. B, 66, 653–667.
Fahrmeir, L., Kneib, T., and Lang, S. (2004), “Penalized structured additive regression
for space-time data: A Bayesian perspective ,” Statistica Sinica, 14, 715–745.
Fahrmeir, L. and Lang, S. (2001), “Bayesian inference for generalized additive mixed
models based on Markov random ﬁeld priors,” Journal of Royal Statistical Society
C, 50, pp. 201–220.
Fan, J. (1993), “Local linear regression smoothers and their minimax eﬃciencies,” The
Annals of Statistics, 21, 196–216.
Fan, J. and Gijbels, I. (1992), “Variable bandwidth and local linear regression
smoothers,” Annals of statistics, 21, 433–446.
— (1995), “Data-driven bandwidth selection in local polynomial ﬁtting: Variable band-
width and spatial adaptation,” J. Roy. Statist. Soc. B, 57, 371394.
— (1996), Local Polynomial Modelling and Its Applications, Chapman and Hall, Lon-
don.
Fan, J., Heckman, N. E., and Wand, M. P. (1995), “Local polynomial kernel regression
for generalized linear models and quasi-likelihood functions,” Journal of the American
Statistical Association, 90, pp. 141–150.
116

Fan, J., Huang, T., and Li, R. Z. (2007), “Analysis of longitudinal data with semipara-
metric estimation of covariance function,” J. Amer. Statist. Assoc., 35, 632641.
Fan, J., Lin, H., and Zhou, Y. (2006), “Local partial-likelihood estimation for lifetime
data,” Ann Statist, 34, 290325.
Fan, J. and Zhang, J. T. (2000a), “Functional linear models for longitudinal data,” J.
Roy. Statist. Soc. B, 62, 303322.
Fan, J. and Zhang, W. (1999), “Statistical estimation in varying coeﬃcient models,”
Ann. Statist., 27, 14911518.
— (2000b), “Simultaneous conﬁdence bands and hypothesis testing in varying-
coeﬃcient models,” Scand. J. Statist., 27, 715731.
— (2008), “Statistical methods with varying coeﬃcient models,” Statistics and Its
Interface, 1, 179195.
Ferguson, T. S. (1973), “A Bayesian analysis of some nonparametric problems,” The
Annals of Statistics, 1, 209–230.
— (1974), “Prior distributions on spaces of probability measures,” The Annals of Statis-
tics, 2, pp. 615–629.
Focke, N. K., Yogarajah, M., Bonelli, S. B., Bartlett, P. A., Symms, M. R., and Duncan,
J. S. (2008), “Voxel-based diﬀusion tensor imaging in patients with mesial temporal
lobe epilepsy and hippocampal sclerosis,” NeuroImage, 40, 728–737.
Fox, E. B., Sudderth, E. B., Jordan, M. I., and Willsky, A. S. (2008), “An HDP-
HMM for systems with state persistence,” in Proceedings of the 25th international
conference on Machine learning, New York, NY, USA: ACM, ICML ’08, pp. 312–319.
Frijda, N. H. (1986), “The Emotions,” in The Emotions, Cambridge(UK): Cambridge
University Press, p. 207.
Gelfand, A. E. and Vounatsou, P. (2003), “Proper multivariate conditional autoregres-
sive models for spatial data analysis,” Biostatistics, 4, 11–15.
Geweke, J. and Zhou, G. (1996), “Measuring the pricing error of the arbitrage pricing
theory,” Review of Financial Studies, 9, 557–587.
Gilmore, J. H., Smith, L. C., Wolfe, H. M., Hertzberg, B. S., Smith, J. K., Chescheir,
N. C., Evans, D. D., Kang, C., Hamer, R. M., Lin, W., and Gerig, G. (2008), “Pre-
natal mild ventriculomegaly predicts abnormal development of the neonatal brain,”
Biol Psychiatry, 64, 1069–1076.
Goldsmith, A., Feder, J., Crainiceanu, C., Caﬀo, B., and Reich, D. (2011), “Penalized
functional regression,” Journal of Computational and Graphical Statistics.
117

Goodlett, C. B., Fletcher, P. T., Gilmore, J. H., and Gerig, G. (2009), “Group analysis
of DTI ﬁber tract statistics with application to neurodevelopment,” NeuroImage, 45,
S133–S142.
G¨ossl, C., Auer, D. P., and Fahrmeir, L. (2001), “Bayesian Spatiotemporal Inference
in Functional Magnetic Resonance Imaging,” Biometrics, 57, 554–562.
Green, P. J. (1995), “Reversible jump Markov chain Monte Carlo computation and
Bayesian model determination,” Biometrika, 82, 711–732.
Greven, S., Crainiceanu, C., Caﬀo, B., and Reich, D. (2010), “Longitudinal functional
principal component analysis,” Electron. J. Stat., 4, 1022–1054.
Guttman, L. (1954), “A new approach to factor analysis: The radex.” in In P.F.
Lazarsfeld (Ed.), Mathematical thinking in the social sciences, New York: Columbia
University Press, pp. 258–348.
Harezlak, J., Wang, M., Christiani, D., and Lin, X. (2007), “Quantitative quality-
assessment techniques to compare fractionation and depletion methods in SELDI-
TOF mass spectrometry experiments,” Bioinformatics, 23, 2441–2448.
Hasan, K. M., Basser, P. J., Parker, D. L., and Alexander, A. L. (2001), “Analytical
computation of the eigenvalues and eigenvectors in DT-MRI,” J Magn Reson, 152,
41–47.
Hasan, K. M. and Narayana, P. A. (2003), “Computation of the fractional anisotropy
and mean diﬀusivity maps without tensor decoding and diagonalization: theoretical
analysis and validation,” Magn Reson Med, 50, 589–598.
Hastie, T. and Tibshirani, R. (2000), “Bayesian backﬁtting,” Statistical Science, 15,
pp. 196–213.
Hastie, T. J. and Tibshirani, R. J. (1993), “Varying-coeﬃcient models,” J. Roy. Statist.
Soc. B., 55, 757796.
He, J. H., Mcgee, D. L., and Niu, X. F. (2010), “Application of the Bayesian dynamic
survival model in medicine,” Statistics in Medicine, 29, 347–360.
Hecke, W. V., Sijbers, J., Backer, S. D., Poot, D., Parizel, P. M., and Leemans, A.
(2009), “On the construction of a ground truth framework for evaluating voxel-based
diﬀusion tensor MRI analysis methods,” NeuroImage, 46, 692–707.
Hogan, J. W., Lin, X., and Herman, B. (2004), “Mixtures of varying coeﬃcient models
for longitudinal data with discrete or continuous nonignorable dropout,” Biometrics,
60, 854864.
118

Hoover, D. R., Rice, J. A., Wu, C. O., and Yang, L.-P. (1998), “Nonparametric smooth-
ing estimates of time-varying coeﬃcient models with longitudinal data,” Biometrika,
85, 809822.
Huang, J. Z. and Shen, H. (2004), “Functional coeﬃcient regression models for nonlinear
time series: A polynomial spline approach,” Scandinavian Journal of Statistics, 31,
515534.
Huang, J. Z., Wu, C. O., and Zhou, L. (2002), “Varying-coeﬃcient models and basis
function approximations for the analysis of repeated measurements,” Biometrika, 89,
111128.
— (2004), “Polynomial spline estimation and inference for varying coeﬃcient models
with longitudinal data,” Statistica Sinica, 14, 763788.
Huang, Y., Liang, H., and Wu, H. (2008), “Identifying signiﬁcant covariates for anti-
HIV treatment response: Mechanism-based diﬀerential equation models and empiri-
cal semiparametric regression models,” Statistics in Medicine, 27, 4722–4739.
Huitt, W. (2003), “The aﬀective system,” Tech. rep., Valdosta, GA: Valdosta State
University.
Ishwaran, H. and James, L. F. (2001), “Gibbs sampling methods for stick-breaking
priors,” Journal of the American Statistical Association, 96, pp. 161–173.
Ishwaran, H. and Zarepour, M. (2002), “Exact and approximate representations for
the sum Dirichlet process,” Canadian Journal Of Statistics-Revue Canadienne De
Statistique, 30, 269–283.
Jeﬀreys, W. and Berger, J. (1992), “Ockham’s razor and Bayesian analysis,” American
Statistician, 80, 64–72.
Jones, D. K., Symms, M. R., Cercignani, M., and Howard, R. J. (2005), “The eﬀect of
ﬁlter size on VBM analyses of DT-MRI data,” NeuroImage, 26, 546–554.
Kauermann, G. (2005), “A note on smoothing parameter selection for penalized spline
smoothing,” Journal of Statistical Planning and Inference, 127, 53–69.
Kauermann, G. and Tutz, G. (1999), “On model diagnostics using varying coeﬃcient
models,” Biometrika, 86, 119128.
Kleinman, K. and Ibrahim, J. (1998), “A semiparametric Bayesian approach to the
random eﬀects model,” Biometrics, 54, 921–938.
Kubicki, M., McCarley, R., Westin, C.-F., Park, H.-J., Maier, S., Kikinis, R., Jolesz,
F. A., and Shenton, M. E. (2007), “A review of diﬀusion tensor imaging studies in
schizophrenia,” Journal of Psychiatric Research, 41, 15–30.
119

Larsen, R. (2000), “Toward a science of mood regulation,” Psychological Inquiry, 11,
129–141.
Lee, D. and Shaddick, G. (2007), “Time-varying coeﬃcient models for the analysis of
air pollution and health outcome data,” Biometrics, 63, 1253–1261.
Lei, X., Timothy, D. J., Thomas, E. N., and Derek, N. E. (2009), “Modeling Inter-
Subject Variability in fMRI Activation Location: A Bayesian Hierarchical Spatial
Model,” Biometrics, 65, 1041–1051.
Lenglet, C., Campbell, J. S. W., Descoteaux, M., Haro, G., Savadjiev, P., Wassermann,
D., Anwander, A., Deriche, R., Pike, G. B., Sapiro, G., Siddiqi, K., and Thompson,
P. M. (2009), “Mathematical methods for diﬀusion MRI processing,” NeuroImage,
45, S111–S122.
Lenk, P., Wedel, M., and B¨ckenholt, U. (2006), “Bayesian estimation of circumplex
models subject to prior theory constraints and scale-usage bias,” Psychometrika, 71,
33–55, 10.1007/s11336-001-0958-4.
Lepore, N., Brun, C. A., Chou, Y., Chiang, M., Dutton, R. A., Hayashi, K. M., Luders,
E., Lopez, O. L., Aizenstein, H. J., Toga, A. W., Becker, J. T., and Thompson, P. M.
(2008), “Generalized tensor-based morphometry of HIV/AIDS using multivariate
statistics on deformation tensors,” IEEE Transactions in Medical Imaging, 27, 129–
141.
Liang, H., Wu, H. L., and Carroll, R. J. (2003), “The relationship between virologic
and immunologic responses in AIDS clinical research using mixed-eﬀects varying-
coeﬃcient models with measurement error,” Biostatistics, 4, 297–312.
Lin, D. Y. and Ying, Z. (2001), “Semiparametric and nonparametric regression analysis
of longitudinal data (with discussions),” J. Amer. Statist. Assoc., 96, 103126.
Lin, X. and Carroll, R. J. (2001), “Semiparametric regression for clustered data using
generalized estimating equations,” J. Amer. Statist. Assoc., 96, 10451056.
LO, A. (1984), “On a class of Bayesian nonparametric estimates. 1. Density estimates.”
The Annals of Statistics, 12, 351–357.
Lu, Z., Steinskog, D. J., Tjstheim, D., and Yao, Q. (2009), “Adaptively varying-
coeﬃcient spatiotemporal models,” Journal of Royal Statistical Society B, 71, 859–
880.
Maceachern, S. (1994), “Estimating normal means with a conjugate style Dirichlet
process prior,” Communications in Statistics-Simulation and Computation, 23, 727–
741.
120

Malloy, E. J., Morris, J. S., Adar, S. D., Suh, H., Gold, D. R., and Coull, B. A.
(2010), “Wavelet-based functional linear mixed models: An application to measure-
ment error-corrected distributed lag models,” Biostatistics, 11, 432–452.
Marina, S. P., Dani, G., Fl´avia, M. L., and Esther, S. (2008), “Spatially varying dy-
namic coeﬃcient models,” Journal of Statistical Planning and Inference, 138, 1038–
1058.
Mirr, M. P. (2001), ““Abnormally Increased Behavioral Arousal” Cris Stewart- Amidei
and Joyce A. Kunkel.” in Neuroscience Nursing: Human Response to Neurologic
Dysfunction, W. B. Sunders Philadelphia: PA.
Mooney, C., Vullo, A., and Pollastri, G. (2006), “Protein structural motif prediction
in multidimensional phi-psi space leads to improved secondary structure prediction,”
Journal of Computational Biology, 13, 1489–1502.
Morris, J. and Carroll, R. (2006), “Wavelet-based functional mixed models,” Journal
of Royal Statistical Society B, 68, 179–199.
Moseley, M. (2002), “Diﬀusion tensor imaging and aging-a review,” NMR Biomed., 15,
553–560.
Mukherjee, P. and McKinstry, R. C. (2006), “Diﬀusion tensor imaging and tractography
of human brain development,” Neuroimaging Clin N Am, 16, 19–43.
M¨uller, P., Parmigiani, G., Robert, C., and Rousseau, J. (2004), “Optimal sample
size for multiple testing: The case of gene expression microarrays,” Journal of the
American Statistical Association, 99, 990–1001.
M¨uller, P. and Rosner, G. (1997), “A Bayesian population model with hierarchical
mixture priors applied to blood count data,” J. Amer. Statist. Assoc., 92, 1279–
1292.
Ni, K., Qi, Y., and Carin, L. (2007), “Multiaspect target detection via the inﬁnite
hidden Markov model,” Journal Of The Acoustical Society Of America, 121, 2731–
2742.
Nicholls, D. F. and Quinn, B. G. (1982), Random Coeﬃcient Autoregressive Models:
An Introduction, Springer-Verlag, New York.
O’Donnell, L., Westin, C.-F., and Golby, A. (2009), “Tract-based morphometry for
white matter group analysis,” Neuroimage, 45, 832–844.
Ohlssen, D. I., Sharples, L. D., and Spiegelhalter, D. J. (2007), “Flexible random-
eﬀects models using Bayesian semi-parametric models: Applications to institutional
comparisons,” Statistics in Medicine, 26, 2088–2112.
121

Papaspiliopoulos, O. (2008), “A note on posterior sampling from Dirichlet mixture
models.” Tech. rep., Universitat Pompeu Fabra.
Papaspiliopoulos, O. and Roberts, G. (2008), “Retrospective Markov chain Monte Carlo
Methods for Dirichlet process hierarchical models,” Biometrika, 95, 169–186.
Penny, W., Kilner, J., and Blankenburg, F. (2007), “Robust Bayesian general linear
models,” NeuroImage, 36, 661 – 671.
Petrone, S., Guindani, M., and Gelfand, A. E. (2009), “Hybrid Dirichlet mixture models
for functional data,” Journal of Royal Statistical Society B, 71, 755–782.
Pierpaoli, C. and Basser, P. J. (1996), “Toward a quantitative assessment of diﬀusion
anisotropy,” Magn Reson Med, 36, 893–906.
Rajan, J. J. and Rayner, P. J. W. (1996), “Generalized feature extraction for time-
varying autoregressive models,” IEEE Transactions on Signal Processing, 44, 2498–
2507.
Ramsay, J. O. and Silverman, B. W. (1997), Functional data analysis, Springer, New
York.
Reich, B. J., Fuentes, M., Herring, A. H., and Evenson, K. R. (2010), “Bayesian variable
selection for multivariate spatially varying coeﬃcient regression ,” Biometrics, 66,
772–782.
Rice, J. A. and Silverman, B. W. (1991), “Estimating the mean and covariance structure
nonparametrically when the data are curves,” J. Roy. Statist. Soc. B, 53, 233243.
Rice, J. A. and Wu, C. O. (2001), “Nonparametric mixed eﬀects models for unequally
sampled noisy curves,” Biometrics, 57, 253259.
Rollins, N. K. (2007), “Clinical applications of diﬀusion tensor imaging and tractogra-
phy in children,” Pediatr Radiol, 37, 769–780.
Rosa, M. J., Bestmann, S., Harrison, L., and Penny, W. (2010), “Bayesian model
selection maps for group studies,” NeuroImage, 49, 217 – 224.
Ruppert, D. (1997), “Empirical-bias bandwidths for local polynomial nonparametric
regression and density estimation,” Journal of the American Statistical Association,
92, pp. 1049–1062.
Ruppert, D. and Wand, M. P. (1994), “Multivariate locally weighted least squares
regression,” The Annals of Statistics, 22, pp. 1346–1370.
Russell, J. A. and Carroll, J. M. (1999), “On the bipolarity of positive and negative
aﬀect,” Psychological Bulletin, 125, 3–30.
122

Schwartzman, A. (2006), “Random Ellipsoids and False Discovery Rates: Statistics for
Diﬀusion Tensor Imaging Data,” Ph.D. thesis, Stanford University.
Schwartzman, A., Dougherty, R. F., and Taylor, J. E. (2005), “Cross-subject compari-
son of principal diﬀusion direction maps,” Magn Reson Med, 53, 1423–1431.
Sethuraman, J. (1994), “A constructive deﬁnition of dirichlet priors,” Statistica Sinica,
4, 639–650.
Shi, M. G., Weiss, R. E., and Taylor, J. M. G. (1996), “An analysis of paediatric CD4
counts for acquired immune deﬁciency syndrome using ﬂexible random curves,” J.
Roy. Statist. Soc. C, 45, 151–163.
Smith, M. and Kohn, R. (1996), “Nonparametric regression using Bayesian variable
selection,” Journal of Econometrics, 75, 317–343.
— (1998), “Nonparametric estimation of irregular functions with independent or auto-
correlated errors,” In Practical Nonparametric and Semiparametric Bayesian Statis-
tics. Lecture Notes in Statist., 133, 157–179.
Smith, S. M., Jenkinson, M., Johansen-Berg, H., Rueckert, D., Nichols, T. E., Mackay,
C. E., Watkins, K. E., Ciccarelli, O., Cader, M., Matthews, P., and Behrens, T. E.
(2006), “Tractbased spatial statistics: voxelwise analysis of multi-subject diﬀusion
data,” NeuroImage, 31, 1487–1505.
Snook, L., Paulson, L. A., Roy, D., Phillips, L., and Beaulieu, C. (2005), “Diﬀusion
tensor imaging of neurodevelopment in children and young adults,” NeuroImage, 26,
1164–1173.
Snook, L., Plewes, C., and Beaulieu, C. (2007), “Voxel based versus region of interest
analysis in diﬀusion tensor imaging of neurodevelopment,” NeuroImage, 34, 243–252.
Song, S. K., Sun, S. W., Ju, W. K., Lin, S. J., Cross, A. H., and Neufeld, A. H. (2003),
“Diﬀusion tensor imaging detects and diﬀerentiates axon and myelin degeneration in
mouse optic nerve after retinal ischemia,” Neuroimage, 20, 1714–1722.
Spellman, P., Sherlock, G., Zhang, M. Q., Iyer, V. R., Anders, K., Eisen, M., Brown,
P., Botstein, D., and Futcher, B. (1998), “Comprehensive identiﬁcation of cell cycle-
regulated genes of the yeast saccharomyces cerevisiae by microarray hybridization,”
Molecular Biology of Cell, 9, 3273–3297.
Sun, Y., Zhang, W., and Tong, H. (2007), “Estimation of the covariance matrix of
random eﬀects in longitudinal studies,” Ann. Statist., 35, 27952814.
Taguchi, Y. and Oono, Y. (2005), “Relational patterns of gene expression via non-metric
multidimensional scaling analysis,” Bioinformatics, 21, 730–740.
123

Teh, Y. W., Jordan, M. I., Beal, M. J., and Blei, D. M. (2006), “Hierarchical Dirichlet
processes,” Journal Of The American Statistical Association, 101, 1566–1581.
Thompson, W. K. and Rosen, O. (2008), “A Bayesian model for sparse functional
data,” Biometrics, 64, 54–63.
Tian, L., Zucker, D., and Wei, L. J. (2005), “On the Cox model with time-varying
coeﬃcients,” J Am Statist Assoc, 100, 172183.
Torgerson, W. (1952), “Multidimensional scaling: I. Theory and method,” Psychome-
trika, 17, 401–419, 10.1007/BF02288916.
Tuch, D. S., Reese, T. G., Wiegell, M. R., Makris, N., Belliveau, J. W., and Wedeen,
V. J. (2002), “High angular resolution diﬀusion imaging reveals intravoxel white
matter ﬁber heterogeneity,” Magnetic Resonance in Medicine, 48, 577–582.
Walker, S. G. (2007), “Sampling the Dirichlet mixture model with slices,” Communi-
cations in Statistics - Simulation and Computation, 36, 45–54.
Wang, L., Chen, G., and Li, H. (2007), “Group SCAD regression analysis for microarray
time course gene expression data,” Bioinformatics, 23, 1486–1494.
Wang, L. and Dunson, D. (2010), “Semiparametric Bayes multiple testing: Applications
to tumor data,” Biometrics, 66, 493–501.
Wang, L., Li, H., and Huang, J. Z. (2008), “Variable selection in nonparametric varying-
coeﬃcient models for analysis of repeated measurements,” J. Amer. Statist. Assoc.,
103, 1556–1569.
Wang, Y. X. and Taylor, J. M. G. (1995), “Inference for smooth curves in longitudinal
data with application to an aids clinical trial,” Statistics in Medicine, 14, 1205–1218.
Watson, D. and Clark, L. A. (1997), “The measurement and mismeasurement of mood:
Recurrent and emergent issues,” Journal of Personality Assessment, 86, 267–296.
Watson, D., Clark, L. A., and Tellegen, A. (1988), “Development and validation of brief
measures of positive and negative aﬀect: The PANAS scales,” Journal of Personality
and Social Psychology, 54, 1063–1070.
Watson, D. and Tellegen, A. (1985), “Toward a consensual structure of mood,” Psy-
chological Bulletin, 98, 219–235.
Whitcher, B., Wisco, J. J., Hadjikhani, N., and Tuch, D. S. (2007), “Statistical group
comparison of diﬀusion tensors via multivariate hypothesis testing,” Magnetic Reso-
nance in Medicine, 57, 1065–1074.
Wiggins, J. S., Steiger, J. H., and Gaelick, L. (1981), “Evaluating circumplexity models
in personality data,” Multivariate Behavioral Research, 16, 263289.
124

Winnett, A. and Sasieni, P. (2003), “Iterated residuals and time-varying covariate ef-
fects in Cox regression,” J R Statist Soc B, 65, 473488.
Woolrich, M., Jenkinson, M., Brady, J., and Smith, S. (2004), “Fully bayesian spa-
tiotemporal modeling of fMRI data,” IEEE Trans. Med. Imaging, 23, 213 – 231.
Wu, C. O., Chiang, C. T., and Hoover, D. R. (1998), “Asymptotic conﬁdence regions
for kernel smoothing of a varying-coeﬃcient model with longitudinal data,” J. Amer.
Statist. Assoc., 93, 13881402.
Wu, H. L. and Liang, H. (2004), “Backﬁtting random varying-coeﬃcient models with
timedependent smoothing covariates,” Scandinavian Journal of Statistics, 31, 3–19.
Wu, H. L. and Zhang, J. T. (2002), “Local polynomial mixed-eﬀects models for longi-
tudinal data,” J. Amer. Statist. Assoc., 97, 883–897.
— (2006), Nonparametric Regression Methods for Longitudinal Data Analysis, Hobo-
ken, New Jersey.: John Wiley & Sons, Inc.
Xia, Y. and Li, W. K. (1999), “On the estimation and testing of functional-coeﬃcient
linear models,” Statistica Sinica, 9, 735758.
Yu, Z. and Lin, X. (2008), “Nonparametric regression using local kernel estimating
equations for correlated failure time data,” Biometrika, 95, 123137.
Yu, Z. S. and Lin, X. H. (2010), “Semiparametric regression with time-dependent co-
eﬃcients for failure time data analysis,” Statistica Sinica, 20, 853–869.
Yushkevich, P. A., Zhang, H., Simon, T., and Gee, J. C. (2008), “Structure-speciﬁc
statistical mapping ofwhite matter tracts,” Neuroimage, 41, 448–461.
Zhang, W. and Lee, S. Y. (2000), “Variable bandwidth selection in varying-coeﬃcient
models,” Journal of Multivariate Analysis, 74, 116134.
Zhang, W., Lee, S. Y., and Song, X. (2002), “Local polynomial ﬁtting in semivarying
coeﬃcient models,” J. Multivar. Anal., 82, 166188.
Zhang, W. and Steele, F. (2004), “A semiparametric multilevel survival model,” Journal
of the Royal Statistical Society C, 53, 387404.
Zhu, H., Kong, L., Li, R., Styner, M., Gerig, G., Lin, W., and Gilmore, J. H. (2011),
“FADTTS: Functional analysis of diﬀusion tensor tract statistics,” NeuroImage, 56,
1412 – 1425.
Zhu, H. T., Cheng, Y. S., Ibrahim, J. G., Li, Y. M., Hall, C., and Lin, W. L. (2009), “In-
trinsic regression models for positive deﬁnitive matrices with applications in diﬀusion
tensor images,” Journal of the American Statistical Association, 104, 1203–1212.
125

Zhu, H. T., Styner, M., Tang, N. S., Liu, Z. X., Lin, W. L., and Gilmore, J. (2010),
“FRATS: Functional regression analysis of DTI tract statistics,” IEEE Transactions
on Medical Imaging, 29, 1039–1049.
Zhu, H. T., Xu, D., Amir, R., Hao, X., Zhang, H., Alayar, K., Ravi, B., and Peterson,
B. (2006), “A statistical framework for the classiﬁcation of tensor morphologies in
diﬀusion tensor images,” Magnetic Resonance Imaging, 24, 569–582.
Zhu, H. T., Zhang, H. P., Ibrahim, J. G., and Peterson, B. G. (2007), “Statistical
analysis of diﬀusion tensors in diﬀusion-weighted magnetic resonance image data
(with discussion),” Journal of the American Statistical Association, 102, 1085–1102.
Zucker, D. M. and Karr, A. F. (1990), “Nonparametric survival analysis with time-
dependent covariate eﬀects:
A penalized partial likelihood approach,” The Ann
Statist, 18, 329353.
126

