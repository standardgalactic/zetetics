Bayesian Analysis of Varying CoeÔ¨Écient Models
and Applications
Zhaowei Hua
A dissertation submitted to the faculty of the University of North Carolina at Chapel
Hill in partial fulÔ¨Ållment of the requirements for the degree of Doctor of Philosophy in
the Department of Biostatistics.
Chapel Hill
2011
Approved by:
Hongtu Zhu
David B. Dunson
Fei Zou
Wei Sun
Sy-Miin Chow

c‚Éù2011
Zhaowei Hua
ALL RIGHTS RESERVED
ii

Abstract
ZHAOWEI HUA: Bayesian Analysis of Varying CoeÔ¨Écient Models and
Applications.
(Under the direction of Hongtu Zhu and David B. Dunson.)
The varying coeÔ¨Écient models have been very important analytic tools to study the
dynamic pattern in biomedicine Ô¨Åelds. Since nonparametric varying coeÔ¨Écient models
make few assumptions on the speciÔ¨Åcation of the model, the ‚Äòcurse of dimensionality‚Äô
is an very important issue.
Nonparametric Bayesian methods combat the curse of
dimensionality through specifying a sparseness-favoring structure. This is accomplished
through the Bayesian penalty for model complexity (JeÔ¨Äreys and Berger, 1992) and
is aided through centering on a base Bayesian parametric model. This dissertation
presents three novel semiparametric Bayesian methods for the analysis of longitudinal
data, diÔ¨Äusion tensor imaging data, and longitudinal circumplex data.
In longitudinal data analysis, we propose a semiparametric Bayes approach to allow
the impact of the predictors to vary across subjects, which allows Ô¨Çexibly local bor-
rowing of information across subjects. Local hypothesis testing and conÔ¨Ådence bands
are developed for the identiÔ¨Åcation of time windows for signiÔ¨Åcant predictor impact,
adjusting for multiple comparisons. The methods are assessed using simulation studies
and applied to a yeast cell-cycle gene expression data set.
In analyzing diÔ¨Äusion tensor imaging data, we propose a semiparametric Bayesian
local functional model to connect multiple diÔ¨Äusion properties along white matter Ô¨Åber
bundles with a set of covariates of interest. An LPP2 prior facilitates global and local
borrowing of information among subjects, while an inÔ¨Ånite factor model Ô¨Çexibly rep-
resents low-dimensional structure. Local hypothesis testing and conÔ¨Ådence bands are
iii

developed to identify Ô¨Åber segments for signiÔ¨Åcant association of covariates with mul-
tiple diÔ¨Äusion properties, controlling for multiple comparisons. The method is assessed
by a simulation study and illustrated via two Ô¨Åber tract data sets for neurodevelopment.
In analyzing longitudinal circumplex data, we propose a semiparametric Bayesian
inÔ¨Ånite state-space circumplex model to capture the dynamic transition pattern of
aÔ¨Äective experience, where aÔ¨Äects are characterized as an ordering on the circumference
of a circle. A sticky inÔ¨Ånite state hidden Markov model via hierarchical Dirichlet proces
is used to address the time related state-switching structure and the self-transition
feature. The method is assessed by a simulation study and an emotion data set for the
dynamics of emotion regulation.
iv

Acknowledgments
The period of my dissertation is a precious component in my life that I beneÔ¨Åt from
many people in completing this dissertation and get inspired in problem solving.
I want to express my deepest gratitude to my advisors, Dr. Hongtu Zhu and Dr.
David B. Dunson. Both of them are the shining models as world-class researchers. Their
broad visions, deep insights, and high research standards are the leading sources in my
growth throughout my dissertation research. I particularly appreciate the generous
Ô¨Ånancial support from Dr. Hongtu Zhu, as well as the support from Dr. David B.
Dunson in funding application.
I want to sincerely thank my committee members Dr. Sy-Miin Chow, Dr. Fei Zou
and Dr. Wei Sun. I appreciate Dr. Sy-Miin Chow for her suggestions in improving
my 3rd topic, providing the circumplex data, and her Ô¨Ånancial support. I thank Dr.
Fei Zou and Dr. Wei Sun for commenting my views, reading my dissertation, and
suggestions in improving my dissertation. I also owe my thanks to Dr. Wei Sun for his
friendship and his personal support.
I am greatly thankful to Dr. Joseph Ibrahim for his generous Ô¨Ånancial support
with NCI training grant program in genomics and cancer. I particularly appreciate Dr.
Michael Kosorok for oÔ¨Äering me a graduate fellowship at SAMSI and Dr. Amy Herring
for her guidance at SAMSI.
I am deeply indebted to Dr. Jianwen Cai for introducing me into the Biostatistics
research area in advising my master paper and her encouragements.
v

I owe my special thanks to Dr. Todd Schwartz for his guidance in diverse exciting
projects at School of Nursing and his encouragement in my study at UNC with his
professional and personal support. I am heartily thankful to Dr. William Kalsbeek for
oÔ¨Äering me an opportunity to work with him on an interesting sampling design project
and his professional support. I am grateful to Dr. Diane holditch-davis and Dr. Mark
Weaver for the initial opportunity at School of Nursing as a research assistant.
My sincere thanks also goes to Dr. Suchindran for oÔ¨Äering me the admission op-
portunity to this prestigious department and his professional support.
Many friends and schoolmates have helped me weather the up and down days of
my graduate student life. I greatly value their friendships. In particular, I want to
thank all the group members in our BIAS lab where we are encouraged to pursue deep
knowledge and understanding.
Finally and most importantly, my lovely words go to my husband Jiansuo. His
persistent love and patience has been the pillar throughout my graduate life. I partic-
ularly thank my fellow brothers and sisters in God who have made home away from
home. I thank my parents and sister‚Äôs family back home for their unconditional love
and support.
vi

Table of Contents
Abstract . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
iii
List of Figures
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
x
List of Tables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
xi
List of Abbreviations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
xii
1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
1.1
Frequentist Analysis of Varying CoeÔ¨Écient Models . . . . . . . . . . . .
2
1.1.1
Kernel-local Polynomial Smoothing . . . . . . . . . . . . . . . .
2
1.1.2
Spline Smoothing . . . . . . . . . . . . . . . . . . . . . . . . . .
4
1.2
Bayesian Analysis of Varying CoeÔ¨Écient Models . . . . . . . . . . . . .
7
1.2.1
Bayesian Spline Models . . . . . . . . . . . . . . . . . . . . . . .
8
1.2.2
Random EÔ¨Äects Models with Dirichlet Process . . . . . . . . . .
9
1.3
Applications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
11
1.3.1
Analysis of Longitudinal Data with Time-Varying
CoeÔ¨Écient Models
. . . . . . . . . . . . . . . . . . . . . . . . .
11
1.3.2
Analysis of Survival Data with Time-Varying CoeÔ¨Écient Models
12
2
Semiparametric Bayes local additive models for longitudinal data .
15
2.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
15
2.2
Semiparametric Bayes Local Additive Model . . . . . . . . . . . . . . .
19
vii

2.2.1
LPP2 prior
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
19
2.2.2
The Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
21
2.2.3
Induced Properties . . . . . . . . . . . . . . . . . . . . . . . . .
23
2.2.4
Hypothesis Formulation & Testing
. . . . . . . . . . . . . . . .
24
2.2.5
Bayesian ConÔ¨Ådence Band . . . . . . . . . . . . . . . . . . . . .
26
2.3
Posterior Computation . . . . . . . . . . . . . . . . . . . . . . . . . . .
27
2.4
Simulation Study . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
28
2.5
Yeast Cell-Cycle Gene Expression Application . . . . . . . . . . . . . .
30
2.5.1
Background and Motivation . . . . . . . . . . . . . . . . . . . .
30
2.5.2
Analysis and Results . . . . . . . . . . . . . . . . . . . . . . . .
33
2.6
Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
35
2.7
Appendix
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
40
2.7.1
Appendix A: Proof of Proposition 1 . . . . . . . . . . . . . . . .
40
2.7.2
Appendix B: the MCMC Posterior Computation Algorithm . .
40
3
Semiparametric Bayesian Local Functional Models
for DiÔ¨Äusion Tensor Tract Statistics . . . . . . . . . . . . . . . . . . . .
47
3.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
47
3.2
Methodologies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
50
3.2.1
Multivariate Random CoeÔ¨Écient Model . . . . . . . . . . . . . .
50
3.2.2
InÔ¨Ånite Latent Factor Model . . . . . . . . . . . . . . . . . . . .
52
3.2.3
Priors
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
54
3.2.4
LPP2 prior
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
55
3.2.5
Hypothesis Formulation & Testing
. . . . . . . . . . . . . . . .
58
3.2.6
Bayesian ConÔ¨Ådence Bands
. . . . . . . . . . . . . . . . . . . .
59
viii

3.2.7
Bayesian Cluster Analysis . . . . . . . . . . . . . . . . . . . . .
60
3.3
Monte Carlo Simulations . . . . . . . . . . . . . . . . . . . . . . . . . .
61
3.4
Clinical DTI Fiber Tract Data . . . . . . . . . . . . . . . . . . . . . . .
63
3.4.1
Background and Analysis
. . . . . . . . . . . . . . . . . . . . .
63
3.4.2
Results: Right Internal Capsule Tract . . . . . . . . . . . . . . .
66
3.4.3
Results: Splenium Tract . . . . . . . . . . . . . . . . . . . . . .
68
3.5
Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
70
3.6
Appendix: Posterior Computation . . . . . . . . . . . . . . . . . . . . .
71
4
Bayesian Sticky HDP InÔ¨Ånite Hidden Markov Circumplex Model .
87
4.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
87
4.2
Bayesian Sticky HDP-iHMM Circumplex Model . . . . . . . . . . . . .
90
4.2.1
Circumplex Model
. . . . . . . . . . . . . . . . . . . . . . . . .
90
4.2.2
Sticky HDP-iHMM State-space Circumplex Model . . . . . . . .
91
4.2.3
Background: Dirichlet Processes . . . . . . . . . . . . . . . . . .
93
4.2.4
The Sticky HDP-iHMM Model
. . . . . . . . . . . . . . . . . .
97
4.3
Posterior Computation . . . . . . . . . . . . . . . . . . . . . . . . . . .
99
4.4
Simulation Study . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
104
4.5
PANAS Data Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . .
106
4.6
Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
107
Bibliography
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
113
Bibliography
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
113
ix

List of Figures
2.1
LPP2: posterior probability curves in favor of local H1k(t)s . . . . . . .
38
2.2
Posterior estimation of time-varying coeÔ¨Écients
. . . . . . . . . . . . .
39
2.3
Boxplots: the number of global and local clusters
. . . . . . . . . . . .
45
2.4
DP: posterior probability curves in favor of local H1k(t)s
. . . . . . . .
46
3.1
A schematic overview of SBLFM
. . . . . . . . . . . . . . . . . . . . .
77
3.2
Right internal capsule tract description . . . . . . . . . . . . . . . . . .
78
3.3
RI: the gender eÔ¨Äects on FA and MD trajectories
. . . . . . . . . . . .
79
3.4
RI: the gestational age eÔ¨Äects on FA and MD trajectories . . . . . . . .
80
3.5
Right internal capsule tract: analysis of FA and MD . . . . . . . . . . .
81
3.6
Right internal capsule tract: analysis of Œª1, Œª2 and Œª3 . . . . . . . . . .
82
3.7
Splenium tract description . . . . . . . . . . . . . . . . . . . . . . . . .
83
3.8
Splenium tract : analysis I of FA and MD
. . . . . . . . . . . . . . . .
84
3.9
Splenium tract: analysis II of FA and MD
. . . . . . . . . . . . . . . .
85
3.10 Splenium tract: analysis of Œª1, Œª2 and Œª3 . . . . . . . . . . . . . . . . .
86
4.1
A circular structure of aÔ¨Äects classiÔ¨Åed into six clusters . . . . . . . . .
108
4.2
Performance of state labeling in the simulated data . . . . . . . . . . .
110
4.3
The classiÔ¨Åed states for the PANAS data.
. . . . . . . . . . . . . . . .
111
4.4
PANAS: plot of sin Œ∏s versus cos Œ∏s posteriori . . . . . . . . . . . . . . .
112
x

List of Tables
2.1
Comparison of LPP2 prior, DP prior and Ô¨Åxed eÔ¨Äects model . . . . . .
37
2.2
Type I error rates and powers of the global hypothesis tests
. . . . . .
37
2.3
FDRs and powers of local hypothesis tests . . . . . . . . . . . . . . . .
37
2.4
The coverage rates of 95% conÔ¨Ådence band for 4 methods . . . . . . . .
37
3.1
Simulation study: FDR and power of the local hypothesis tests . . . . .
76
4.1
Simulation study: estimated directions for the synthetic data.
. . . . .
109
4.2
PANAS: the diÔ¨Äerence and the ratio between PE and NE scores . . . .
109
xi

List of Abbreviations
CRF
Chinese restaurant franchise
DP
Dirichlet process
DTI
DiÔ¨Äusion tensor imaging
FA
Fractional anisotropy
FDR
False discovery rate
FNR
False negative rate
HDP
Hierarchical Dirichlet process
iHMM
InÔ¨Ånite state hidden Markov model
LPP
Local partition process
MCMC
Markov chain Monte Carlo
MD
Mean diÔ¨Äusivity
MDS
Multidimensional scaling
MRI
Magnetic resonance imaging
MSE
Mean squared error
PANAS
Positive and negative aÔ¨Äect schedule
SBLFM
Semiparametric Bayesian local functional models
TFs
Transcription factors
VM
Von Mises distribution
xii

Chapter 1
Introduction
Varying coeÔ¨Écient models are a class of widely developed models. It was initially
introduced by Cleveland et al. (1991) to extend the applications of local regression
techniques from one-dimensional to multidimensional setting. Local regression models
were further extended by Hastie and Tibshirani (1993) to be formulated as varying
coeÔ¨Écient models, which also tied generalized additive models and dynamic general-
ized linear model into one framework. Semivarying coeÔ¨Écient models (Zhang et al.,
2002), mix-eÔ¨Äect varying coeÔ¨Écient models (Liang et al., 2003), and random varying-
coeÔ¨Écient models (Wu and Liang, 2004) were later developed to address diÔ¨Äerent sit-
uations. Semivarying coeÔ¨Écient models allow the linear eÔ¨Äects of some predictors on
the outcomes. Random varying-coeÔ¨Écient models assumes the subject-speciÔ¨Åc varying
coeÔ¨Écient eÔ¨Äects, while mix-eÔ¨Äect varying coeÔ¨Écient models allow both Ô¨Åxed varying
coeÔ¨Écient eÔ¨Äects and random varying coeÔ¨Écient eÔ¨Äects.
Varying coeÔ¨Écient models arise from various statistical contexts. The vast volume
of literature includes, among many others, Nicholls and Quinn (1982), Chen and Tsay
(1993) and Cai et al. (2000b) on non-linear time series, Hoover et al. (1998), Wu et al.
(1998) and Fan and Zhang (2000a) on longitudinal data analysis, Ramsay and Silverman
(1997) on functional data analysis, Gelfand and Vounatsou (2003), Baladandayuthapani

et al. (2008) on spatial data analysis, Lu et al. (2009) and Brezger et al. (2007a) on
varying coeÔ¨Écient spatiotemporal model, Cleveland et al. (1991), Hastie and Tibshirani
(1993), Carroll et al. (1998), Kauermann and Tutz (1999), Xia and Li (1999), Zhang
and Lee (2000) and Fan and Zhang (1999, 2000b) on local multidimensional regression,
and Cai et al. (2000a) on generalized linear models with varying coeÔ¨Écients.
In this dissertation, we Ô¨Årst review the existing literature in the rest of this chapter.
In Chapter 2, we propose semiparametric Bayes local additive models for the analysis
of longitudinal data. In Chapter 3, we develop a multivariate semiparametric Bayesian
local factor functional regression framework to analyze Ô¨Åber tract data. In Chapter 4,
a semiparametric Bayesian state-space time-varying circumplex model is introduced to
analyze longitudinal circumplex data.
1.1
Frequentist Analysis of Varying CoeÔ¨Écient Models
There are currently two major approaches to estimate the varying coeÔ¨Écients, which are
kernel-local polynomial smoothing (Wu et al., 1998; Hoover et al., 1998; Fan and Zhang,
1999; Kauermann and Tutz, 1999), and spline smoothing (Hastie and Tibshirani, 1993;
Hoover et al., 1998; Chiang et al., 2001; Huang et al., 2002, 2004; Huang and Shen,
2004). We are going to outline these two approaches in the following subsections.
1.1.1
Kernel-local Polynomial Smoothing
Kernel local polynomial smoothing is a richly developed methodology associated with
a large amount of contributing literature; see for example Fan and Gijbels (1992, 1995,
1996), Fan (1993), Ruppert and Wand (1994), Fan et al. (1995), and Ruppert (1997).
Its main idea is based on Taylor expansion to locally approximate a smooth function
by a polynomial of some degree. Assume f(t) is a smooth function with a (p + 1)-st
continuous derivative for some positive integer p at an arbitrary Ô¨Åxed point t0. The
2

f(t) can be locally approximated by a polynomial of degree p around a neighborhood
of t0, as in the form of Taylor expansion:
f(t) ‚âàf(t0) + (t ‚àít0)f (1)(t0) + ¬∑ ¬∑ ¬∑ + (t ‚àít0)pf (p)(t0)/p!,
where f (r)(t0) is the r-th derivative of f(t) at t0.
Suppose that we have a set of data {Ui, XT
i , yi : i = 1, . . . , n} sampled from
(U, XT, y), we Ô¨Åt a varying-coeÔ¨Écient model of the form
y = XTa(U) + œµ,
where E(œµ) = 0, and V ar(œµ) = œÉ2(U). The kernel local polynomial estimator ÀÜa(U) of
a(U) is obtained by minimizing
L(a, b) =
n
X
i=1
{yi ‚àíXT
i a ‚àíXT
i b1(Ui ‚àíu) ‚àí¬∑ ¬∑ ¬∑ ‚àíXT
i bp(Ui ‚àíu)}2Kh(Ui ‚àíu),
where Kh(t) = K(t/h)/h, K(t) is a kernel function, such as Epanechnikov kernel
K(t) = 0.75(1 ‚àít2)+ and h is bandwidth.
Denote X = (X1, . . . , Xn)T, U u = (U1‚àíu, . . . , Un‚àíu), Œìu = (X, U uX, . . . , U p
uX),
Y = (y1, . . . , yn)T, and Wu = diag(Kh(U1 ‚àíu), . . . , Kh(Un ‚àíu)). The one-stage kernel
local polynomial estimator ÀÜa(U) is given by
ÀÜa(U) = (1T
p ‚äóIq, 0q)(ŒìT
uWuŒìu)‚àí1ŒìT
uWuY.
Under some conditions, ÀÜa(U) is asymptotically normally distributed:
cov‚àí1/2(ÀÜa(u)){ÀÜa(u) ‚àía(u) ‚àíbias(ÀÜa(u))}
D‚ÜíN(0, Iq),
3

where bias(ÀÜa(u)) = 2‚àí1¬µ2a(2)(u)h2, cov(ÀÜa(u)) = {nhf(u)E(XXT|U = u)}‚àí1ŒΩ0œÉ2(u),
and
D‚Üídenotes convergence in distribution. The bias of ÀÜa(U) comes from the approxi-
mation error of the linear approximation of a(u). In the asymptotic covariance matrix
of ÀÜa(U), the 2hf(u) is approximately the probability of U falling into the neighbour-
hood of u with radius h, and 2nhf(u) is approximately the expected number of Ui in
the neighbourhood of u.
Bandwidth selection is an important issue in kernel smoothing. Larger bandwidth
may gain on variance side, but loses on bias side. Smaller bandwidth may gain on bias
side, but loses on variance side. The basic idea of a data driven bandwidth selection
procedure is to Ô¨Ånd an estimator of mean squared error (MSE) of ÀÜa(U) Ô¨Årst, and
then minimizes MSE with respect to bandwidth. The optimal bandwidth is the one
minimizing the MSE. Wu et al. (1998) and Hoover et al. (1998) proposed to use cross-
validation to select the bandwidth. Zhang and Lee (2000) systematically investigated
both variable bandwidth and constant bandwidth selection. For longitudinal data, it is
better to delete a whole subject rather than just a single observation when estimating
MSE(h).
1.1.2
Spline Smoothing
Three types of spline approaches have been developed for varying coeÔ¨Écient models.
Such approaches include regression spline (Shi et al., 1996; Rice and Wu, 2001; Wu and
Zhang, 2002; Liang et al., 2003), penalized spline (Eilers and Marx, 1996; Kauermann,
2005) and smoothing spline (Hoover et al., 1998; Brumback and Rice, 1998; Chiang
et al., 2001; Eubank et al., 2004). The key idea of these approaches is to express varying
coeÔ¨Écient functional eÔ¨Äect as a linear combination of some spline bases. However, they
diÔ¨Äer from each other in the number of knots and penalization.
Regression spline
methods and penalized spline methods usually use fewer knots than smoothing spline
4

methods. The smoothness of regression spline methods is controlled by the number
of the associated basis functions. When the number of pre-speciÔ¨Åed basis functions is
large, it is very challenging to Ô¨Åt the regression spline models due to high-dimensionality
and roughness.
The penalized spline method uses two truncated power bases and
penalizes the high order derivative of the associated regression splines. In contrast, the
smoothing spline method penalizes the roughness of the resultant functions. For the
sake of space, we are going to brieÔ¨Çy review the smoothing spline method as follows.
Suppose that we have a set of longitudinal sample (yij, xij, zij, tij), for i = 1, . . . , n,
and j = 1, ..., ni, where xi(tij) = (xij0, . . . , xijK)T, zi(tij) = (zij0, . . . , zijM)T and
(yij, xij, zij, tij) denote the jth outcome, two set of covariates and time design points,
respectively, of the ith subject.
We Ô¨Åt a nonparametric mixed eÔ¨Äects time-varying
coeÔ¨Écient model:
yij = xi(tij)TŒ≤(tij) + zi(tij)Tvi(tij) + œµi(tij),
(1.1)
where Œ≤(t) = (Œ≤0(t), . . . , Œ≤K(t))T are smooth Ô¨Åxed eÔ¨Äects of interest, vi(t) = (vi0(t), . . . , viM(t))T
are random eÔ¨Äects sampled from a Gaussian process with zero mean and Œì covariance
function, œµi(t) is a zero-mean stochastic process, and vi(t) and œµi(t) are independent.
We use the cubic smoothing spline method to estimate the Ô¨Åxed eÔ¨Äects and the random
eÔ¨Äects:
Œ≤k(tij) = hT
ijŒ≤k, k = 0, 1, . . . , K,
vim(tij) = hT
ijvim, m = 0, 1, . . . , M,
where Œ≤k = (Œ≤k(œÑ1), . . . , Œ≤k(œÑL))T denotes the values of Œ≤k(t) at a set of design knots
œÑ1, . . . , œÑL, vim = (vim(œÑ1), . . . , vim(œÑL))T denotes the values of vim(t) at œÑ1, . . . , œÑL, and
hij denote a L-dimensional unit vector whose l-th entry is 1 if tij = œÑl and 0 otherwise.
5

Let Œ≤ = (Œ≤T
0 , . . . , Œ≤T
K)T, vi = (vT
i0, . . . , vT
iM)T, xij = xi(tij) ‚äóhij, zij = zi(tij) ‚äóhij,
Xi = (xi1, . . . , xini)T, Zi = (zi1, . . . , zini)T, yi = (yi1, . . . , yini)T, and œµi = (œµi1, . . . , œµini)T.
Then the nonparametric mixed eÔ¨Äect time-varying coeÔ¨Écient model (1.1) can be ex-
pressed as
yi = XiŒ≤ + Zivi + œµi, œµi ‚àºNni(0, Ri), vi ‚àºN(M+1)L(0, D).
If the components of Œ≤(t) and vi(t)s are twice continuously diÔ¨Äerentiable and their
second derivatives are square integrable, the cubic spline smoothing estimator ÀÜŒ≤k(t) of
Œ≤k(t) is the least square minimizer of the following penalized generalized log-likelihood:
J(Œ≤, {vi}n
i=1, Œª)
=
n
X
i=1
(yi ‚àíXiŒ≤ ‚àíZivi)TR‚àí1
i (yi ‚àíXiŒ≤ ‚àíZivi)
+
n
X
i=1
M
X
m=0
Œªim
Z b
a
[v
‚Ä≤‚Ä≤
im(t)]2dt +
K
X
k=0
Œªk
Z b
a
[Œ≤
‚Ä≤‚Ä≤
k(t)]2dt,
where Œªk, k = 0, . . . , K, Œªim, i = 1, . . . , n, m = 0, . . . , M, are the positive smoothing
parameters. The Ô¨Årst summation term being proportional to the twice negative loga-
rithm of the generalized likelihood represents the goodness of Ô¨Åt. The second term is
the weighted sum of the roughness of all the random-eÔ¨Äect coeÔ¨Écient functions, and the
third term is the weighted sum of the roughness of all the Ô¨Åx-eÔ¨Äect coeÔ¨Écient functions.
The smoothing parameters Œªk, k = 0, . . . , K, and Œªim, i = 1, . . . , n, m = 0, . . . , M, are
used to trade oÔ¨Äthe goodness of Ô¨Åt with the roughness of the smoothing spline esti-
mators.
A major problem of smoothing spline technique is the choice of the optimal smooth-
ing parameters to achieve the best performance of the resulting estimators. The ‚Äúleave-
one-subject-out‚Äù cross-validation (SCV) rule (Rice and Silverman, 1991; Hoover et al.,
1998) is the most popular smoothing parameter selector. The idea is to minimize the
6

weighted sum of mean square errors associated with deletion of each subject, called
SCV rule, with respect to the smoothing parameters. The advantages of SCV include:
(i) deletion of the entire data for one subject at a time preserves the within-subject
correlation of the data; (ii) SCV does not require to specify the within-subject corre-
lation structure. However, it is challenging to minimize SCV rule when the number of
smoothing parameters is large. Alternatively, the ‚Äúleave-one-point-out‚Äù cross-validation
(PCV) rule is used in Wang and Taylor (1995) and Eubank et al. (2004) among many
others. The key advantage of PCV is less computationally intensive with no need to
repeatedly compute the estimators. The drawback of PCV is the lack of accounting for
the within-subject correlation.
1.2
Bayesian Analysis of Varying CoeÔ¨Écient Models
There are two major approaches to model varying coeÔ¨Écients from nonparametric
Bayesian perspective, which are basis expansion methods (Rajan and Rayner, 1996;
Lee and Shaddick, 2007; Brezger et al., 2007b; Huang et al., 2008; Malloy et al., 2010)
and stochastic process mothods (Marina et al., 2008; He et al., 2010; Berrocal et al.,
2010; Reich et al., 2010). Bayesian basis expansion methods approximately express
any function g as g(¬∑) = P
h bhfh(¬∑) by some chose basis f = {f1, f2, f3, . . .}, such as
spline, wavelet and Fourier bases. The random function g can thus be parametrized
by the basis coeÔ¨Écient vector b = (b1, b2, . . .). Specifying a prior probability model on
b implicitly induces a prior probability model on the random function. Alternatively,
stochastic process priors have been proposed as nonparametric prior distributions to
model varying coeÔ¨Écient functions, including Gaussian process and random walk. In
the following subsections, we are going to focus on reviewing Bayesian spline models
and random eÔ¨Äects models with Dirichlet Process (DP).
7

1.2.1
Bayesian Spline Models
Bayesian spline models have been studied in the literature for Bayesian regression
splines and Bayesian penalized splines. For the literature of Bayesian regression splines,
please refer to Denison et al. (1998b) and Hastie and Tibshirani (2000) among many
others. For the work related to Bayesian penalized splines, see Biller and Fahrmeir
(1997), Fahrmeir and Lang (2001), Brezger and Lang (2006), and Fahrmeir et al. (2004)
for a brief view.
To estimate Œ≤k(t) in the model (1.1), a common cubic regression splines is to express
Œ≤k(t) as
Œ≤k(t) =
X
bhfh(t),
where f(t) = (1, x, x2, x3, (t ‚àíŒæ1)3
+, . . . , (t ‚àíŒæT)3
+) is the set of basis functions with
(x)+ = max(x, 0) and Œæ = (Œæ1, . . . , ŒæT) is a set of knots . The Bayesian speciÔ¨Åcation is
completed by placing a prior p(Œæ, b, œÉ) on the sets of knots and basis function coeÔ¨Écients.
Relevant work can be found at Smith and Kohn (1996), Denison et al. (1998b) and
Dimatteo et al. (2001). The strategy is to factor the prior p(Œæ, b, œÉ) = p(Œæ)p(œÉ)p(b|œÉ).
Zellner g-prior (Zellner, 1986) is used by Smith and Kohn (1996) for p(b). Assuming
a conjugate normal prior b ‚àºN(0, cœÉ(BTB)‚àí1) with B is the design matrix in the
sampled data set, the condition posterior mean E(b|Œæ, œÉ) is the linear shrinkage of the
least square estimator ÀÜb. Dimatteo et al. (2001) chose a scalar c such that the prior
variance in the Zellner g-prior equals to the information from one observation. Denison
et al. (1998b) uses least square estimates of b conditioning on y and other parameters,
which is equivalent to assigning a ridge prior b ‚àºN(0, V ) with V = diag(‚àû, v, . . . , v).
Posterior computation typically proceeds via reversible jump MCMC (Green, 1995).
Denison et al. (1998a) use ‚Äùbirth,‚Äù ‚Äùdeath‚Äù and ‚Äùmove‚Äù decisions to add, delete and
8

change knots in each iteration. It is important in updating Œæ posteriori to marginalize
Œæ with respect to the coeÔ¨Écients b. With the conjugate normal prior for b, the marginal
posterior p(Œæ|œÉ, y) can be evaluate analytically. Smith and Kohn (1998) proposed an
interesting alternative, called focused sampling, for posterior computation.
1.2.2
Random EÔ¨Äects Models with Dirichlet Process
To estimate the random eÔ¨Äects vim(t) in model (1.1), a popular option is to use ba-
sis expansion to express vim(t) as a linear combination of a set of pre-speciÔ¨Åed basis
functions:
vim(t) =
p
X
h=1
Œ∏ihfh(t),
where Œ∏i = (Œ∏i1, . . . , Œ∏ip)T are basis coeÔ¨Écients speciÔ¨Åc to the ith subject, and f(t) =
{f1(t), . . . , fp(t)} is a set of basis functions. Similar to the previous subsection, we
specify a set of cubic spline basis functions for f = (1, x, x2, x3, (t‚àíŒæ1)3
+, . . . , (t‚àíŒæT)3
+),
in which Œæ = (Œæ1, . . . , ŒæT) is a set of knots and (x)+ returns 0 for negative x and x for
positive x.
A Bayesian nonparametric speciÔ¨Åcation is completed by placing a DP prior for
the distribution of the random basis coeÔ¨Écients vector Œ∏i. Assume Œ∏i ‚àºQ with Q
unknown, DP(Œ±Q0) models Q as inÔ¨Ånite mixtures of point masses through a stick-
breaking representation:
Q
=
‚àû
X
h=1
whŒ¥Œ∏h(¬∑), Œ∏h
i.i.d
‚àºQ0,
wh
=
Uh
Y
j<h
(1 ‚àíUj), Uh
i.i.d
‚àºBeta(1, Œ±),
where wh is a probability weight formulated from a stick-breaking procedure, Œ¥Œ∏(¬∑)
9

denotes a point mass at Œ∏ which is sampled from Q0, Q0 is a p-dimensional central
probability measure as a prior guess, and Œ± is a precision parameter expressing conÔ¨Å-
dence in the prior guess. Under this formulation, the probability of Œ∏i allocated to Œ¥Œ∏(¬∑)
is equivalent to wh.
An important property of DP prior for Q is the discrete nature of Q. This speciÔ¨Å-
cation creates ties among Œ∏is, i = 1, . . . , n, such that each subject is allocated into one
of k ‚â§n clusters. Subjects allocated to the same cluster have the same random eÔ¨Äects
value. Denote Si = j for the ith subject assigned to cluster j. All subjects having
Si = j have Œ∏i = Œ∏‚àó
h, where Œ∏‚àó
h denotes the value taken by the random basis coeÔ¨Écients
vector of all subjects in cluster j. Hence, all subject in the same cluster have identical
random eÔ¨Äects vim(t) which equals to f(t)Œ∏‚àó
h.
The standard approach for posterior computation is based on Markov chain Monte
Carlo (MCMC) algorithms. Three major types of MCMC algorithms have been pro-
posed, which are collapsed Gibbs sampler (Maceachern, 1994), the blocked Gibbs sam-
pler (Ishwaran and James, 2001), and reversible jump-type approaches (Jain and Neal,
2004; Dahl, 2007). The collapsed Gibbs sampler avoids updating the inÔ¨Ånitely many
parameters through marginalizing out Q, which is based on the P¬¥olya urn scheme of
Blackwell and MacQueen (1973). The blocked Gibbs sampler uses truncation of the
stick-breaking procedure to approximate Q. To avoid truncation, Walker (2007) pro-
posed a slice sampling approach and Papaspiliopoulos and Roberts (2008) proposed a
retrospective MCMC algorithm. Further, Papaspiliopoulos (2008) proposed an eÔ¨Écient
exact block Gibbs sampler which combines the advantages of the retrospective MCMC
method and the slice sampling method.
10

1.3
Applications
The evolution of the varying coeÔ¨Écient models is deeply rooted in applications and
reÔ¨Çects the increasingly large and complex problems that are arising in science and
industry. They have been successfully applied to many scientiÔ¨Åc areas, including eco-
nomics, Ô¨Ånance, politics, epidemiology, medical science, ecology and so on. This pro-
posal focuses on the applications of the varying coeÔ¨Écient models in biomedicine and
epidemiology areas. They arise from diÔ¨Äerent statistical contexts, such as the analysis
of longitudinal data, survival data, spatial data, functional data, genetics data and
imaging data. We are going to brieÔ¨Çy review the time-varying coeÔ¨Écient models in the
analysis of longitudinal data and survival data in the following subsections.
1.3.1
Analysis of Longitudinal Data with Time-Varying
CoeÔ¨Écient Models
In the analysis of longitudinal data from biomedicine and epidemiology studies, it
is of highly interest to study the patterns of time-varying variables, such as disease
progression or trends of health status. Longitudinal data usually consist of repeatedly
measured outcomes and covariates from a random sample of subjects measured over
time. One statistical focus in analyzing longitudinal data is to assess the time-varying
impacts of covariates on outcome trajectories, where the covariates might or might not
be time dependent. Thus nonparametric varying-coeÔ¨Écient models become particularly
useful in longitudinal analyses.
A longitudinal sample is typically denoted by (yij, xij, zij, tij), for i = 1, . . . , n,
and j = 1, ..., ni, where xi(tij) = (xij0, . . . , xijK)T, zi(tij) = (zij0, . . . , zijM)T and
(yij, xij, zij, tij) denote the jth outcome, two set of covariates and time design points,
respectively, of the ith subject. To examine whether the associations of covariates with
11

outcomes change over time, we can Ô¨Åt a Ô¨Åxed-eÔ¨Äect varying coeÔ¨Écient model (Brum-
back and Rice, 1998; Hoover et al., 1998), or a mix-eÔ¨Äect varying coeÔ¨Écient model
(Liang et al., 2003) as the above model (1.1), or a random varying-coeÔ¨Äcient model
(Wu and Liang, 2004). The time-varying coeÔ¨Écients can be estimated by the kernel,
polynomial and smoothing spline methods.
The issue of incorporating the within subject correlation structure into the esti-
mation procedure is important in longitudinal data analysis. Lin and Carroll (2001)
addressed this situation in the nonparametric Ô¨Åxed eÔ¨Äects time-varying coeÔ¨Écient mod-
els.
The studies of the estimation of the within subject correlation structure were
systematically considered by Fan et al. (2007) and Sun et al. (2007).
Missing data has been an important topic in long term longitudinal studies. Hogan
et al. (2004) studied the mixtures of varying coeÔ¨Écient models for longitudinal data
having discrete or continuous nonignorable dropout.
1.3.2
Analysis of Survival Data with Time-Varying CoeÔ¨Écient
Models
Survival analysis concerns the failure time to some event, such as failure of a machine
component, death of a patient, or recurrence of prostate cancer of a male patient.
The Cox proportional hazard (PH) model (Cox, 1972) is the most popular model in
the analysis of survival data. However, it doesn‚Äôt address any potential possible dy-
namic feature in the data set. Varying coeÔ¨Écient proportional hazard function models
Ô¨Årst introduced by Hastie and Tibshirani (1993) can be used to address any dynamic
structure.
Suppose that we have a survival sample (Ui, XT
i , yi, Œ¥i), i = 1, . . . , n, where yi =
min(Ti, Ci), Œ¥i = I(Ti > Ci), Ti and Ci are respectively the survival time and censoring
12

time of the ith subject, and Ui is a scalar covariate.
We assume a noninformative
censoring mechanism. The distinct failure times are denoted by t(1) < . . . < t(L), with
dl individuals failing at t(l) for l = 1, . . . , L. We Ô¨Åt a varying coeÔ¨Écient proportional
hazard function model (Zhang and Steele, 2004) as follows:
h(t|X, U) = h0(t) exp{XTa(U)}.
For any give u, the local partial likelihood estimator (Fan et al., 2006) of a(u) is
obtained by maximizing the following local partial log-likelihood function
L
X
l=1
 X
j‚ààDl
Kh(Uj ‚àíu)
"
XT
j {a + b(Uj ‚àíu)} ‚àílog
 X
k‚ààRl
exp[XT
k {a + b(Uj ‚àíu)}]Kh(Uk ‚àíu)
!#!
,
where Rl is the set of indices for the individuals at risk up to time t(l), and Dl is the
set of indices for the events at t(l).
For independent data, kernel estimation of the semiparametric varying-coeÔ¨Écient
proportional hazard function models have been studied by Cai and Sun (2003), Tian
et al. (2005), and Fan et al. (2006), and spline estimation was studied by Ahmad et al.
(2005). Other related works include Zucker and Karr (1990), and Winnett and Sasieni
(2003). There are several nonparametric regression models for clustered failure time
data.
Under the assumption of independence, Cai et al. (2007) investigated kernel
smoothing properties for varying coeÔ¨Écient models for multivariate survival data with
stratiÔ¨Åed baseline hazards. Yu and Lin (2008) studied weighted local polynomial kernel
estimating equations for clustered failure time data. They concluded the most eÔ¨Écient
local polynomial kernel estimator can be attained by silencing the within-cluster cor-
relation. Yu and Lin (2010) studied the performance of proÔ¨Åle-kernel estimators of the
nonparametric time-varying coeÔ¨Écients in a semiparametric time-varying coeÔ¨Écient
model for clustered survival data under working independence, and showed that they
13

are semiparametric eÔ¨Écient for independent data.
14

Chapter 2
Semiparametric Bayes local additive
models for longitudinal data
2.1
Introduction
Longitudinal data arise frequently in biomedical Ô¨Åelds when subjects are repeatedly
measured over time. To study the time pattern of covariate eÔ¨Äects on an outcome
variable, time-varying coeÔ¨Écient models are commonly used since their formal intro-
duction to the statistical literature by Hastie and Tibshirani (1993). Nonparametric
regression methods to estimate time-varying coeÔ¨Écient functions have been developed
by Hoover et al. (1998), and Lin and Ying (2001) among many others.
Please re-
fer to Wu and Zhang (2006) and Fan and Zhang (2008) for comprehensive reviews of
statistical procedures for varying coeÔ¨Écient models.
We focus on a random time-varying coeÔ¨Écient model:
Yij = Œ≤i0(tij) + X‚Ä≤
iŒ≤i(tij) + œµi(tij),
i = 1, . . . , n, j = 1, . . . , mi, tij ‚àà[0, T],
(2.1)
where Yij is the observed response variable, Xi is a K √ó 1 covariate vector for the i-th
subject, Œ≤i0(tij) is a subject-speciÔ¨Åc baseline and Œ≤i(tij) = (Œ≤i1(tij), . . . , Œ≤iK(tij))‚Ä≤ is a

K √ó 1 covariate eÔ¨Äect vector for the i-th subject at time tij. To estimate the unknown
functions Œ≤i0(t) and Œ≤i(t) in model (2.1), a common approach is to express them as
linear combinations of some pre-speciÔ¨Åed basis functions. Heterogeneity in the curves
is then controlled by the variation of their basis coeÔ¨Écients which are usually treated as
random eÔ¨Äects and follow a speciÔ¨Åc random eÔ¨Äects distribution. A concern rises about
the sensitivity of associated inferences to the choice of the random eÔ¨Äects distribution
on the basis coeÔ¨Écients.
There is a rich Bayesian nonparametric literature associated with modelling ran-
dom eÔ¨Äects.
It has now become routine to use Dirichlet process (DP) priors (Fer-
guson, 1973, 1974) and DP mixtures (DPM) (LO, 1984; Escobar and West, 1995)
for random eÔ¨Äects distributions in Bayesian hierarchical models. For important early
references, refer to Bush and MacEachern (1996), M¬®uller and Rosner (1997) and Klein-
man and Ibrahim (1998).
Cruz-Mes¬¥ƒ±a et al. (2007) adopted an analysis-of-variance
dependent DP (De Iorio et al., 2004) for the problem of sequential classiÔ¨Åcation anal-
ysis. Ohlssen et al. (2007) provide a review and tutorial on the practical use of such
approaches, and the DPpackage in R is now available for routine use (http://cran.r-
project.org/web/packages/DPpackage/index.html).
It is important to capture the local structure of similarity and deviation among sub-
jects in detecting the signals for model (2.1). The DP prior assumes the random eÔ¨Äects
distribution P ‚àºDP(Œ±P0), where P0 is the base distribution and Œ± is a concentration
parameter. Subjects are partitioned into clusters with the number of sample clusters
being proportional to Œ± log n. Small Œ± favors few clusters to be occupied leading to
substantial borrowing of information across subjects within a cluster in estimating the
basis coeÔ¨Écients. A drawback of the DP prior is the assumption of global clustering.
Two subjects are either allocated to a common cluster or two diÔ¨Äerent clusters. It is
common in reality that two subjects have similar trajectories in certain time periods
16

while having local deviations. In such situations, DP priors either inappropriately allo-
cate two subjects to a common cluster, obscuring the local diÔ¨Äerences or assigns them
to two separate clusters. Dunson (2009) proposed a local partition process (LPP) prior
on random eÔ¨Äects, which allows both global and local clustering. The LPP prior leads
to borrowing of information in estimating the basis coeÔ¨Écients and can accommodate
basis selection to address the curse of dimensionality.
Characterizing local features has been an important focus in functional data anal-
ysis. Representative Bayesian semiparametric approaches include Bayesian wavelet-
based functional mixed modeling (Morris and Carroll, 2006), random eÔ¨Äects models
relying on adaptive basis function representations (Thompson and Rosen, 2008; Botts
and Daniels, 2008) and hierarchical Gaussian processes (Behseta et al., 2005). A hybrid
Dirichlet mixture model (Petrone et al., 2009) was proposed to distinguish functional
local features by characterizing individual functions as a patchwork of segments which
are locally drawn from a collection of global GP realizations. We propose to capture
the local features through assigning an LPP prior on the random eÔ¨Äects distribution
of the basis function coeÔ¨Écients, where a pre-speciÔ¨Åed set of basis functions are as-
sumed to linearly span the unknown time-varying coeÔ¨Écient functions Œ≤i0(t) and Œ≤ik(t),
k = 1, . . . , K.
The motivating application for this chapter is a yeast cell-cycle gene expression data
set. The expression proÔ¨Åles of 297 genes identiÔ¨Åed as cell cycle-regulated genes in the
genome of Saccharomyces cerevisiae were measured over 2 cell cycles. Since transcrip-
tion factors (TFs) are key elements controlling the movement of genetic information
from DNA to mRNA at cell-cycle level transcription, it is important to capture the dy-
namic behavior of gene expression regulated by TFs. In addition, cell cycle-regulated
genes are involved in diÔ¨Äerent processes such as DNA synthesis, budding, and cytoki-
nesis (Spellman et al., 1998) in each cell cycle, implying diÔ¨Äerent expression behaviors
17

of diÔ¨Äerent genes. Typical analyses assume a common time-varying behavior for all the
genes (Wang et al., 2007, 2008). We propose to use our random time-varying coeÔ¨É-
cient model with LPP prior to determine the gene-speciÔ¨Åc time-varying TF regulating
course.
Considering TFs regulating cell cycle-regulated genes which are active at diÔ¨Äerent
biological processes, it is important to develop a local inference approach to determine
TFs-regulated time windows. Current Bayesian varying-coeÔ¨Écient models allow regres-
sion coeÔ¨Écient to vary with time and/or spatial location (refer to Lee and Shaddick
(2007) for a recent reference). Such approaches can be used to obtain a posterior mean
estimate of the varying coeÔ¨Écient curve, as well as pointwise 95% credible intervals.
However, formal Bayesian hypothesis testing of local signiÔ¨Åcance of a predictor within
a given time window is not considered. Although one can potentially identify time
regions across which the pointwise credible bands do not include zero as potentially
signiÔ¨Åcant, this may lead to an inÔ¨Çated type I error rate.
The goals of this chapter cover three aspects. The Ô¨Årst applies the LPP prior to
the random eÔ¨Äects distributions in the random time-varying coeÔ¨Écient model (2.1)
to facilitate global and local borrowing of information among subjects. The second
constructs a Bayesian conÔ¨Ådence band for the mean time-varying eÔ¨Äect of the predictor.
The third develops a Bayesian local hypothesis testing approach to examine if and where
the predictor has signiÔ¨Åcant impact on an outcome trajectory. Multiplicity issues arising
from pointwise inference is accounted for by controlling false discovery rate (FDR).
In this chapter, section 2.2 introduces the model and associated inferences motivated
by the above considerations. Section 2.3 introduces an MCMC algorithm for posterior
computation. Subsection 2.4 is for an illustrative simulation. Section 2.5 applies the
model to a yeast cell-cycle gene data set data set. Section 2.6 makes some further
discussion.
18

2.2
Semiparametric Bayes Local Additive Model
2.2.1
LPP2 prior
Dunson (2009) proposed a class of local partition process priors (LPP) for unknown
random eÔ¨Äects distributions to facilitate both global and local clustering of random
eÔ¨Äects, providing a generalization of the widely-used Dirichlet process prior that avoids
the global clustering assumption. Our focus is on the simpler LPP2 prior, which is
reviewed below.
Sample two collections of independent and identically distributed p-dimensional
random elements Œògh = (Œòg,h,1, . . . , Œòg,h,p)‚Ä≤, g = 0, 1, h = 1, . . . , ‚àû, from a base dis-
tribution P0. Denote Œû0 = {Œò0h}‚àû
h=1 for the global family of coeÔ¨Écient vectors and
Œû1 = {Œò1h}‚àû
h=1 for the local family.
Introduce a p-dimensional indices vector z =
(z1, . . . , zp)‚Ä≤ for the allocation to global clustering or local clustering, with zj ‚àºBer(ŒΩj)
(Ber: Bernoulli) independently, taking the value of 1 for global clustering and 0 for local
clustering, j = 1, . . . , p. DeÔ¨Åne a p √ó 2 local cluster indices matrix œà = (œà‚Ä≤
1, . . . , œà‚Ä≤
p)‚Ä≤,
with œàj = (1 ‚àízj, œÜj) and œÜj ‚àà{1, . . . , ‚àû}, j = 1, . . . , p. A corresponding hybrid atom
Œòœà = (Œòœà1,1, . . . , Œòœàp,p)‚Ä≤ is obtained by setting the jth element of Œòœà equal to Œòœàj,j.
Considering n vectors of p-dimensional random eÔ¨Äects for n subjects, Œ∏i = (Œ∏i1, . . . , Œ∏ip)‚Ä≤ ‚àº
P with P unknown, i = 1, . . . , n, LPP2 prior models P as a hybrid mixture distribution:
P =
1
X
z1=0
(1‚àíz1,‚àû)
X
œà1=(1‚àíz1,1)
¬∑ ¬∑ ¬∑
1
X
zp=0
(1‚àízp,‚àû)
X
œàp=(1‚àízp,1)
œÄœà1,...,œàpŒ¥Œòœà,
(2.2)
where Œ¥x denotes a degenerate distribution with all its mass at x, œÄœà1,...,œàp is the prob-
ability of Œ∏i = Œòœà that œÄœà1,...,œàp ‚â•0 and
1P
z1=0
(1‚àíz1,‚àû)
P
œà1=(1‚àíz1,1)
¬∑ ¬∑ ¬∑
1P
zp=0
(1‚àízp,‚àû)
P
œàp=(1‚àízp,1)
œÄœà1,...,œàp = 1.
Let œÄh denote Pr(Œ∏ij = Œòg,h,j), g = 0, 1, h = 1, . . . , ‚àû, j = 1, . . . , p. Those random
eÔ¨Äects having zj = 1 are speciÔ¨Åed to be allocated together to a component in the
19

global family Œû0, while others having zj = 0 are speciÔ¨Åed to be allocated to their own
component in the local family Œû1. Let J0 = {j : zj = 1} and J1 = {j : zj = 0}.
Conditional on the values of z,
Pr(œàj = (0, h), j ‚ààJ0|z1, . . . , zp) = œÄh, h = 1, . . . , ‚àû,
Pr(œàj = (1, hj), j ‚ààJ1|z1, . . . , zp) =
Y
j‚ààJ1
œÄhj, hj = 1, . . . , ‚àû.
The allocation probability of Œ∏i = Œòœà in (3.8) is then simply
œÄœà1,...,œàp = Pr(œà1 = (1 ‚àíz1, h1), . . . , œàp = (1 ‚àízp, hp)) = œÄh
 Y
j‚ààJ1
œÄhj

p
Y
j=1
ŒΩ
zj
j (1 ‚àíŒΩj)1‚àízj

.
The speciÔ¨Åcation is completed by choosing the hyperpriors
ŒΩj ‚àºBeta(1, Œ≥),
j = 1, . . . , p,
œÄh = œÄ‚àó
h
Y
l<h
(1 ‚àíœÄ‚àó
l ),
œÄ‚àó
h ‚àºBeta(1, Œ±),
h = 1, . . . , ‚àû,
j = 0, 1, . . . , p,
where Œ≥ controls the overall weight on the local family, and Œ± controls the overall
number of clusters. As shorthand the LPP prior is denoted P ‚àºLPP2(Œ±, Œ≥, P0).
The LPP2 prior speciÔ¨Åcation (3.8) can also be viewed as a hybrid mixture model of
inÔ¨Ånitely many components drawn from P0 via 2-stage clustering. Stage 1 determines
the membership of global or local clustering for each of the p components.
Those
components allocated to the global clustering membership will be clustered together
to an atom in the global family at stage 2, while those allocated to the local family
will be allocated individually to their own clusters.
The joint cluster membership
probability at stage 1 corresponds to Pr(z1, . . . , zp) = Qp
j=1 ŒΩ
zj
j
(1 ‚àíŒΩj)1‚àízj. The joint
cluster allocation weight at stage 2 conditional on stage 1 corresponds to Pr(œà1 =
(1 ‚àíz1, h1), . . . , œàp = (1 ‚àízp, hp)|z1, . . . , zp). The overall joint cluster allocation weight
20

corresponds to œÄœà1,...,œàp.
2.2.2
The Model
We propose a semiparametric Bayesian local additive model for the analysis of repeated
measurements. Considering a functional response Yi(t) for the ith subject i = 1, . . . , n,
we rewrite model (2.1) as
Yi(t) = Œ≤i0(t) +
K
X
k=1
Œ≤ik(t)xik + œµi(t),
œµi(t) ‚àºN(0, œÑ ‚àí1),
(2.3)
where Œ≤i0(t) is the ith subject‚Äôs baseline curve, Œ≤ik(t) is the ith subject‚Äôs time-varying
coeÔ¨Écient for the kth predictor xik, xik is normalized, and the measurement error pro-
cess œµi(t) is a realization of an uncorrelated zero-mean Gaussian process with variance
œÑ ‚àí1.
Similar to Huang et al. (2002), we consider basis expansion to estimate the time-
varying coeÔ¨Écient regression functions. Assume that {Œ≤ik(t)}K
k=0 can be expressed as a
linear combination of basis functions as follows:
Œ≤ik(t) =
pk
X
l=1
Œ∏iklbkl(t) = bik(t)‚Ä≤Œ∏ik,
(2.4)
where Œ∏ik = (Œ∏ik1, . . . , Œ∏ikpk)‚Ä≤ and the basis functions bk(t) = (bk1(t), . . . , bkpk(t))‚Ä≤. Var-
ious basis systems can be applied, including Fourier bases, polynomial bases, Wavelet
bases, and B-spline bases such as cubic B-spline bases. For computational convenience,
we let the basis function bk(t) ‚â°b(t) = (b1(t), ¬∑ ¬∑ ¬∑ , bp(t))‚Ä≤ and pk ‚â°p for all k. We
specify Gaussian kernel as the basis functions b1(t) = 1, bj+1(t) = exp(‚àíŒ∂||t ‚àíŒ∑j||2),
j = 1, . . . , p ‚àí1, where Œ∑1, . . . , Œ∑p‚àí1 are equally spaced kernel locations and Œ∂ = 25. Let
21

Œ∏i = (Œ∏‚Ä≤
i1, ¬∑ ¬∑ ¬∑ , Œ∏‚Ä≤
iK)‚Ä≤ and Bi(t) = (b(t)‚Ä≤xi1, ¬∑ ¬∑ ¬∑ , b(t)‚Ä≤xiK)‚Ä≤, model (2.3) can be written as
Yi(t) = b(t)‚Ä≤Œ∏i0 + Bi(t)‚Ä≤Œ∏i + œµi(t).
(2.5)
A Bayesian speciÔ¨Åcation of our model is completed with LPP2 priors for the distri-
butions of the random eÔ¨Äects, {Œ∏ik}K
k=0. Assuming Œ∏i0 ‚àºP and Œ∏i ‚àºÀúP with P and ÀúP
unknown and independent, we let:
P
‚àº
LPP2(Œ±0, Œ≥0, P0)
ÀúP
‚àº
LPP2(Œ±1, Œ≥1, ‚äó{P0k}K
k=1), P0k = P0,
(2.6)
where the prior guess is around a p-dimensional parametric base distribution P0, and
(Œ±0, Œ±1) and (Œ≥0, Œ≥1) are hyperparameters, with (Œ±0, Œ±1) characterizing concentration
around the prior guess and (Œ≥0, Œ≥1) determining the overall allocation weight on the
local family. These hyperparameters impact the induced global and local clustering
structure, and by choosing hyperpriors we allow a high degree of data adaptivity.
Considering the potentially varied shapes of the time-varying functions, we devise to
automatically select among a large number of pre-speciÔ¨Åed potential basis functions and
accommodate uncertainty in basis function selection by choosing a shrinkage prior for
the basis coeÔ¨Écients. To achieve the shrinkage property, we specify the base distribution
P0 as:
P0 :
Œ∏ik ‚àºNp(0p√ó1, Œõ‚àí1),
i = 1, . . . , n,
k = 0, 1, . . . , K.
(2.7)
Œõ = diag(Œª1, ¬∑ ¬∑ ¬∑ , Œªp) with Œªl ‚àºG(0.5, 0.5). To allow borrowing information across co-
eÔ¨Écients over the degree of shrinkage, we prefer Œªl = Œª, a common Œª across coeÔ¨Écients.
This speciÔ¨Åcation leads to light-tails feature of P0 a priori and approximately Gaussian
feature a posteriori. The coeÔ¨Écients for unnecessary basis functions are shrunk to zero
22

a posteriori, while the coeÔ¨Écients for signiÔ¨Åcant basis functions fall in the tails. If
too many unnecessary basis functions are included, Œõ will be over-estimated and the
coeÔ¨Écients for important basis functions will be heavily shrunk.
2.2.3
Induced Properties
The LPP2(Œ±, Œ≥, P0) prior on the random eÔ¨Äects distribution constructs a nonparametric
prior for the time-varying coeÔ¨Écient functions in the model speciÔ¨Åed through (2.3) ‚àí
(2.7). Considering a generic unknown function
f(t) =
p
X
j=1
œëjbj(t) = B(t)‚Ä≤œë,
with t ‚àà[0, T], œë = (œë1, . . . , œëp)‚Ä≤ and assuming œë ‚àºP, P ‚àºLPP2(Œ±, Œ≥, P0), with P0
deÔ¨Åned as in (2.7), the induced prior presents the following properties.
Proposition 2.2.1. Conditional on Œõ‚àí1 = diag{Œª‚àí1
1 , . . . , Œª‚àí1
p },
(f(t1), f(t2), . . . , f(tL))‚Ä≤|Œõ‚àí1 ‚àºNL(0L√ó1, Œ£L√óL)
with Œ£L√óL = [œÉij], i = 1, . . . , L, j = 1, . . . , L, and œÉij = B(ti)‚Ä≤Œõ‚àí1B(tj).
Further,
Corr(f(t1), f(t2)|Œõ‚àí1) =
B(t1)‚Ä≤Œõ‚àí1B(t2)
(B(t1)‚Ä≤Œõ‚àí1B(t1))1/2(B(t2)‚Ä≤Œõ‚àí1B(t2))1/2.
According to the Cauchy-Schwarz inequality, the correlation is bounded above by 1
and converges to 1 as t1 ‚Üít2. An appealing property of the induced prior is, when
Œª1 = . . . = Œªp = Œª,
Corr(f(t1), f(t2)|Œª) =
B(t1)‚Ä≤B(t2)
(B(t1)‚Ä≤B(t1))1/2(B(t2)‚Ä≤B(t2))1/2,
23

which depends only on the set of basis functions and not the base measure P0. When a
local basis is chosen, such as B-splines or Gaussian kernels, a local dependence structure
will result with the correlation between f(t1) and f(t2) decaying to close to zero as t1
and t2 move further apart. We can extend this correlation structure for long-range
dependencies by accommodating non-diagonal Œõ or choosing Fourier bases.
From the above, it follows directly that the LPP2(Œ±, Œ≥, P0) prior on the distribution
of the basis coeÔ¨Écients leads to baseline and time-varying coeÔ¨Écient functions that are
assigned Gaussian process priors marginally. In particular, the curves for individual
subjects are drawn from a Gaussian process with mean function m(t) = 0 and covari-
ance function c(t1, t2) = B(t1)‚Ä≤Œõ‚àí1B(t2). By specifying hyperpriors on the parameters
in Œõ, the data inform about the parameters in the covariance function. Although the
marginal prior for the individual curves is a Gaussian process, the marginal distribution
across subjects is nonparametric and highly Ô¨Çexible, so the variation among subjects is
not restricted to be Gaussian.
2.2.4
Hypothesis Formulation & Testing
We are interested in testing the null hypotheses that a predictor has no eÔ¨Äect at a
particular time or interval of times, and that there are time intervals across which the
predictor has no eÔ¨Äect. We provide a local interval null hypothesis testing approach
to make pointwise inference for the predictor eÔ¨Äects over time. The local null and
alternative hypotheses for the kth predictor eÔ¨Äect speciÔ¨Åc to a time point t ‚àà[0, T] are
formulated as:
H0k(t) :
Œ≤k(t)
 ‚â§œµ, versus H1k(t) :
Œ≤k(t)
 > œµ,
24

where Œ≤k(t) represents the mean of the subject-speciÔ¨Åc time-varying coeÔ¨Écients for the
kth predictor at time t. To test whether the average time-varying coeÔ¨Écient curve for
the kth predictor deviates from a small neighborhood of zero anywhere in time interval
[0, T], the global null and alternative hypotheses are formulated as
H0k :
Œ≤k(t)
 ‚â§œµ, for all t ‚àà[0, T]
H1k :
Œ≤k(t)
 > œµ, for any t ‚àà[0, T].
The global null hypothesis is the intersection of all the local null hypotheses. Any
rejection of a local null hypothesis leads to the rejection of the global null hypothesis.
We choose a suitable small value 0.05 for œµ as our default, noting again that the data
have been normalized.
To conduct local hypotheses testing, we use the Bayesian decision rule for multiple
testing proposed by M¬®uller et al (2004). Following the implementation in Wang &
Dunson (2010), our strategy is to reject H0k(t) if the posterior alternative hypothesis
probability œÖkt = Pr(H1k(t)|Data) ‚â•r for any t ‚àà[0, T], with r as a common threshold
for all the local hypotheses. r is chosen to minimize the posterior expected false negative
rate (FNR) under the constraint of the posterior expected false discovery rate (FDR)
being no greater than Œ±T, where Œ±T is pre-speciÔ¨Åed (we focus on a value of 0.05).
Denote dkt = 1(œÖkt ‚â•r), an indicator of rejecting H0k(t). The posterior expected FNR
and FDR are calculated as:
FNR =
PK
k=1
R T
0 (1 ‚àídkt)œÖktdt
K
R T
0 dt ‚àíPK
k=1
R T
0 dktdt + Œ∫0
‚âà
PK
k=1
Ptm
t=t1(1 ‚àídkt)œÖktT/m
KT ‚àíPK
k=1
Ptm
t=t1 dktT/m + Œ∫0
,
FDR =
PK
k=1
R T
0 dkt(1 ‚àíœÖkt)dt
PK
k=1
R T
0 dktdt + Œ∫0
‚âà
PK
k=1
Ptm
t=t1 dkt(1 ‚àíœÖkt)T/m
PK
k=1
Ptm
t=t1 dktT/m + Œ∫0
,
where t1, . . . , tm is a Ô¨Åne grid of times equally spaced along [0, T] and Œ∫0 is a small
25

positive constant to avoid a zero denominator. In summary, our decision rule is to
determine the optimal threshold r‚àóby r‚àó= argmin FNR{r ‚àà[0, 1], FDR ‚â§Œ±T}.
For each combination of k and t ‚àà{t1, . . . , tm}, we reject H0k(t) if œÖkt ‚â•r‚àó. For a
suÔ¨Éciently Ô¨Åne grid of m ‚â•10, the results are robust to m, with the optimal threshold
appropriately adapting to the chosen m.
2.2.5
Bayesian ConÔ¨Ådence Band
We focus on constructing a Bayesian simultaneous conÔ¨Ådence band for the mean coeÔ¨É-
cient curve Œ≤k(t), k = 1, . . . , K, from its posterior MCMC samples. Assuming there is
a collection of posterior sampled curves Œ≤s
k = (Œ≤s
k(t1), . . . , Œ≤s
k(tL))‚Ä≤, s = 1, . . . , S index-
ing posterior iterations after burn-in, our goal is to compute a simultaneous conÔ¨Ådence
band for Œ≤k(t). The principle in constructing a Bayesian conÔ¨Ådence band is to search
for a region RŒ± = {RŒ±(t), t ‚àà[0, T]} such that Pr{Œ≤k(t) ‚ààRŒ±(t), t ‚àà[0, T]} = 1 ‚àíŒ± a
posteriori.
The most commonly-used method is to compute a conÔ¨Ådence band based on point-
wise conÔ¨Ådence intervals, which we denote as CR. The constructed conÔ¨Ådence band is
obtained as [Œ≤L
k (tl), Œ≤U
k (tl)],
l = 1, . . . , L, where Œ≤L
k (tl) is the Œ±/2 empirical percentile
of the posterior samples and Œ≤U
k (tl) is the 1 ‚àíŒ±/2 percentile. However, such pointwise
conÔ¨Ådence bands are not interpretable as joint conÔ¨Ådence bands. A method proposed
by Crainiceanu et al.(2007) assumes approximate posterior normality and derives the
1 ‚àíŒ± sample percentile c1‚àíŒ± of
max
l=1,...,L

Œ≤s
k(tl) ‚àíÀÜŒ≤k(tl)
q
c
var(ÀÜŒ≤k(tl))
, s = 1, . . . , S,
where ÀÜŒ≤k(tl) is the posterior mean at time tl and
q
c
var(ÀÜŒ≤k(tl)) is its posterior standard
26

deviation. A simultaneous conÔ¨Ådence region is given by the hyperrectangular
[ÀÜŒ≤k(tl) ‚àíc1‚àíŒ±
q
c
var(ÀÜŒ≤k(tl)), ÀÜŒ≤k(tl) + c1‚àíŒ±
q
c
var(ÀÜŒ≤k(tl))], l = 1, . . . , L.
In our implementation, we replace c1‚àíŒ± by cb which is calculated by cb = max(|cŒ±/2|, |c1‚àíŒ±/2|)
to account for skewness. We denote this method as Pnorm.
Alternatively, we propose two new approaches that avoid the posterior normal-
ity assumption.
The strategy remains based on pointwise measures of uncertainty.
The Ô¨Årst method Mdev computes the posterior sample average curve ÀÜŒ≤k(tl) and the
pointwise Œ±/2 percentile sŒ±/2(tl) and 1 ‚àíŒ±/2 percentile s1‚àíŒ±/2(tl), l = 1, . . . , L. By
deriving the maximal deviations sŒ±/2 = maxl=1,...,L
(ÀÜŒ≤k(tl) ‚àísŒ±/2(tl)) and s1‚àíŒ±/2 =
maxl=1,...,L (s1‚àíŒ±/2(tl) ‚àíÀÜŒ≤k(tl)) for the lower and upper Œ±/2 percentiles away from the
posterior mean estimator ÀÜŒ≤k(tl), we obtain the conÔ¨Ådence band
[ÀÜŒ≤k(t) ‚àísŒ±/2, ÀÜŒ≤k(t) + s1‚àíŒ±/2].
This interval is potentially conservative. The second method MdiÔ¨Äsearches the qbŒ±
sample percentile of
max
l=1,...,L
Œ≤s
k(tl) ‚àíÀÜŒ≤k(tl)
 s = 1, . . . , S,
such that 1 ‚àí(bŒ±)L = Œ±. The conÔ¨Ådence band is calculated by
[ÀÜŒ≤k(t) ‚àíqbŒ±, ÀÜŒ≤k(t) + qbŒ±].
2.3
Posterior Computation
We develop a Markov chain Monte Carlo (MCMC) algorithm for posterior computa-
tion by adapting an eÔ¨Écient exact block Gibbs sampler (Papaspiliopoulos, 2008) for
27

Dirichlet mixture models. The exact block Gibbs sampler combines the advantages of
the retrospective MCMC method of Papaspiliopoulos & Roberts (2008) and the slice
sampling method of Walker (2007). Allowing data to inform information about the hy-
perparameters involved in the model through (2.3) ‚àí(2.7), we specify Œ±0 ‚àºGa(aŒ±, bŒ±),
Œ≥0 ‚àºGa(aŒ≥, bŒ≥), Œ±1 ‚àºGa(aŒ±, bŒ±), Œ≥1 ‚àºGa(aŒ≥, bŒ≥), œÑ ‚àºGa(aœÑ, bœÑ). Introducing aux-
iliary variables {uikl} to avoid truncated approximations, k = 0, . . . , K, l = 0, . . . , p,
i = 1, . . . , n, the complete data joint likelihood of y, u, and z is:
n
Y
i=1
{g(yi; Œò0œài0, Œòœài1,...,œàiK, œÑ)1(ui00 < œÄ0œÜi00)
p
Y
l=1
1(ui0l < œÄ0œÜi0l)ŒΩzi0l
0l (1 ‚àíŒΩ0l)(1‚àízi0l)
K
Y
k=1
1(uik0 < œÄœÜik0)
p
Y
l=1
1(uikl < œÄœÜikl)ŒΩzikl
kl (1 ‚àíŒΩkl)(1‚àízikl)},
where yi is a mi √ó 1 outcome vector for the i-th subject, g(¬∑) is the density function
of the outcome vector yi, i = 1, . . . , n, and the {uikl}s are constrained to the interval
(0, 1).
Please refer to the appendix B for the sampling algorithm in details.
This algorithm is straightforward to implement and exhibits good performance
in convergence and mixing.
To perform hypothesis testing, we estimate the poste-
rior hypothesis probability from the MCMC posterior samples.
For any t ‚àà[0, T],
Pr(H1k(t)|Data) is estimated as the proportion of iterations after burn-in satisfying
1/n Pn
i=1 ÀÜŒ≤ik(t) /‚àà[‚àíœµ, œµ].
2.4
Simulation Study
We conducted a simulation study to assess the Ô¨Ånite sample performance of our ap-
proach. In each simulation, we generate a sample of 100 curves from the following
28

model:
Yi(t) = Œ≤i0(t) + Œ≤i1(t)xi + œµi(t), œµi(t) ‚àºN(0, œÑ ‚àí1),
i = 1, . . . , 100, t ‚àà[0, 1].
Each curve has 40 observations equally spaced along the time interval [0, 1] and we
set œÑ = 1. The covariate xi‚Äôs are sampled from Unif(0, 1) and then standardized to
have mean 0 and standard deviation 1. The baseline Œ≤i0(t) for t ‚àà[0, 1], i = 1, . . . , 100
is generated from a Gaussian process with mean curve mi0(t) = ai0 + bi0 sin(œÄt/60)
and covariance function c0(t, t‚Ä≤) = œÉ2
0œÅ|t‚àít‚Ä≤|, where ai0 ‚àºN(5, 1), bi0 ‚àºN(20, 1),
œÉ0 = 0.224 and œÅ = 0.5.
The covariate eÔ¨Äect Œ≤i1(t) is considered for three cases:
(1) global null case:
Œ≤i1(t) ‚àºGP(0, c1(t, t‚Ä≤)), (2) local alternative case:
Œ≤i1(t) ‚àº
GP((ai1 + bi1 cos(œÄ(t ‚àí20)/20))1(t > 0.4), c1(t, t‚Ä≤)), and (3) global alternative case:
Œ≤i1(t) ‚àºGP(ai1 + bi1 cos(œÄ(t ‚àí20)/20), c1(t, t‚Ä≤)). The random coeÔ¨Écients ai1 ‚àºN(3, 1)
and bi1 ‚àºN(2, 1). The covariance function c1(t, t‚Ä≤) is set equivalent to c0(t, t‚Ä≤).
We analyze each simulated scenario using 100 repeated simulations by our method.
We set Ga(1, 1) hyperpriors for Œ±0, Œ≥0, Œ±1, and Œ≥1, and a Ga(0.1, 0.1) hyperprior for
œÑ. The exact block Gibbs sampler is run 25,000 iterations, with the Ô¨Årst 2500 samples
discarded as burn-in.
Every 20th sample is collected to thin the chain.
For each
case, our Gibbs sampler converges rapidly and exhibits eÔ¨Écient mixing based on the
examination of the trace plots of Œ±0, Œ≤0, Œ±1, Œ≤1, œÑ, the elements of estimated functions,
and the performance of hypothesis testing as scaling up the simulation iterations. It
is not reliable to assess convergence and mixing based on the elements of the posterior
sampled atoms Œòh or Œòjh due to label switching issues.
We compare the LPP2 prior, the standard DP prior and a Ô¨Åxed eÔ¨Äects model with
P0 as prior in terms of posterior estimation and posterior hypothesis testing. Mean
square error (MSE) is used to assess the accuracy of posterior estimation. Table 2.1
shows the LPP2 prior having smaller average mean square error than the DP prior
29

and the Ô¨Åxed eÔ¨Äects model under each of the three cases. In performing the global
hypothesis testing, we propose to reject the global null if any local null hypothesis is
rejected. Table 2.2 summarizes type I error rates in the global null case and powers in
the global and local alternative cases. LPP2 prior is shown to have a type I error closer
to the signiÔ¨Åcance level 0.05 in the null case (0.05 vs 0.19) and larger power in the local
alternative case (0.72 vs 0.63) than DP prior. To perform the time-wise local inference,
the proposed approach rejects the local null hypotheses if Pr(H1k(t)|Data) ‚â•r, where
r is optimized to minimize FNR under the constraint of FDR ‚â§0.05. The averages of
the observed FDRs and powers from 100 repeated data sets are calculated to evaluate
the local hypothesis test approach. As seen in table 2.3, LPP2 prior has FDRs closer
to 0.05 in the global null case (0.042 vs 0.034) and the local alternative case (0.032 vs
0.028), and larger power in the local alternative case (0.367 vs 0.332) and the global
alternative case (0.998 vs 0.973).
We employ 4 approaches: MdiÔ¨Ä, Mdev, Pnorm and CR to construct simultaneous
95% conÔ¨Ådence bands. The comparison results of the 95% conÔ¨Ådence band coverage
rates are listed in Table 2.4. As seen in Table 2.4, our proposed approach MdiÔ¨Ägives
the 95% conÔ¨Ådence band coverage rate around 95% in the global null case, the local
alternative case and the global alternative case. The proposed Mdev performs similarly
to Pnorm in all the cases, while the CR has poor performance.
2.5
Yeast Cell-Cycle Gene Expression Application
2.5.1
Background and Motivation
The cell cycle is a regulated life process leading to the division and replication of a cell.
In cells with a nucleus, it consists of four sequential phases: GAP 1 (G1) for cell size
growth and preparation for DNA replication, Synthesis (S) for DNA replication, GAP 2
30

(G2) for continual cell growth and preparation for mitosis, and Mitosis (M) for division
of chromosomes and cytoplasm into two daughter cells. Since 1985 (Nasmyth), there has
been collective evidence that transcription factors (TFs) regulate the expression of the
cell-cycle-regulated genes at diÔ¨Äerent stages of cell cycle. As reported in the literature
for yeast (Simon et al., 2001), MBF and SBF function in the G1/S transition, Mcm1p
regulates actively in early G1, M and the M/G1 boundary, and Swi5p and Ace2p takes
account of many gene expressions in M and M/G1. However, the function of these TFs
over the full cell cycle remains unknown. Other potential active TFs are also waiting
to be discovered to function in the cell cycle to regulate the gene expression.
We apply our approach to a yeast cell cycle gene expression data set, appended
with a derivative ChIP binding data set. The yeast cell cycle gene expression data
set, collected over 2 cell cycles for 297 genes, is a subset of the data set collected
by Spellman et al. (1998) to identify a catalog of protein-encoding transcripts in the
genome of Saccharomyces cerevisiae. 6,178 yeast ORFs were examined simultaneously
for their expression at mRNA levels, which were synchronized by Œ± pheromone for
G1 arrest, cdc15 for mitosis, and so on. Genes captured by Œ± pheromone over two
cell cycle periods were measured at 18 time points, for every 7 minutes within a total
of 119 minutes.
297 genes were identiÔ¨Åed as cell-cycle-regulated by a model-based
approach (Luan and Li, 2003).
The derivative ChIP binding data set contains the
binding probabilities of 96 TFs to these 297 cell-cycle-regulated genes, where each TF
has at least 1 non-zero binding probability. These binding probabilities were obtained
by applying the mixture model approach (Chen, Jensen, and Stoeckert 2007; Wang,
Chen, and Li 2007) to the ChIP data of Lee et al. (2002).
Our Ô¨Årst analysis goal is to apply the random eÔ¨Äects time-varying coeÔ¨Écient model
(2.3)-(2.7) to connect the log gene expression measures with a set of TFs. Let yi(t)
denote the log-expression level of the i-th gene at time point t, and xik denote the
31

binding probability of the k-th TF to the i-th gene, for k = 1, . . . , 96 and i = 1, . . . , 297.
Wang et al. (2008) linked the binding probabilities to the gene expression levels using
a Ô¨Åxed eÔ¨Äect nonparametric time-varying coeÔ¨Écient model:
yi(t) = Œ≤0(t) +
96
X
k=1
Œ≤k(t)xik + œµi(t),
(2.8)
where Œ≤k(t) is the population mean transcription eÔ¨Äect of the k-th TF on the log expres-
sion level of the i-th gene at time point t, and œµi(t)‚Äôs were assumed to be independent
within and across genes. However, considering that diÔ¨Äerent cell-cycle-regulated genes
function in diÔ¨Äerent processes such as DNA synthesis, budding, and cytokinesis (Spell-
man et al., 1998), one needs to account for the diÔ¨Äerential behaviors of the TFs in
regulating diÔ¨Äerent genes in the network of transcript regulations. To address the issue
of diÔ¨Äerential transcription behaviors, we Ô¨Åt our random eÔ¨Äects time-varying coeÔ¨Écient
model :
yi(t) = Œ≤i0(t) +
96
X
k=1
Œ≤ik(t)xik + œµi(t).
where we assume the gene-speciÔ¨Åc time-varying regulating course Œ≤ik(t) for the k-th
TF on the i-th gene expression. We additionally construct Bayesian 95% conÔ¨Ådence
bands for the overall mean time-varying coeÔ¨Écient curves for each TF to explain the
uncertainty in estimation.
Our second analysis goal is to identify the key TFs in cell-cycle regulated gene
expression network and proÔ¨Åle their active/inactive phases. Wang et al. (2008) iden-
tiÔ¨Åed the signiÔ¨Åcant TFs through zeroing small regression coeÔ¨Écients using the SCAD
penalty. However, they didn‚Äôt incorporate the statistical inference error from the prob-
ability perspective.
We apply the point-wise Bayesian local null hypothesis testing
procedure to assess if a TF plays a signiÔ¨Åcant role in regulating gene expression while
32

identifying the active and inactive phases of TF regulation across cell cycles. We limit
type I errors by controlling expected FDR to be no more than 0.05.
In analyzing the data, we assume that between-gene expression levels are indepen-
dent. For a speciÔ¨Åc gene i, within-gene expression levels are assumed to be independent
given its baseline eÔ¨Äect Œ≤i0(t) and transcription eÔ¨Äects {Œ≤ik(t)}96
k=1. We place Dirichlet
process and LPP2 priors on the distributions of the basis coeÔ¨Écients. Given that many
of the log gene expression trajectories have similar shapes with only local deviation, we
expect that the LPP2 prior will produce a more parsimonious representation of the log
gene expression trajectories.
2.5.2
Analysis and Results
We focus initially on reanalyzing the yeast cell cycle gene data with the proposed ap-
proach. We assign Ga(1, 1) hyper priors for the hyperparameters Œ±0, Œ≥0, Œ±1, and Œ≥1,
and a Ga(0.1, 0.1) prior for the precision parameter œÑ. We recommend these priors as
default values in other analyses of standardized data, because these priors are weakly
informative across a wide range of plausible values for general longitudinal data, allow-
ing the data to inform strongly. Gaussian kernels as proposed in the model of Section
(2.2.2) are used as basis functions. We summarize the 1125 posterior samples from the
MCMC output with thinning of 20 iterations after the burn-in of 2500 iterations. Using
multiple chains with widely-distributed points, the proposed exact block Gibbs sampler
exhibits good rates of convergence and mixing. This formulation took 113 seconds per
iteration in Matlab 2010b on a Lenovo X61 laptop. We repeated the analysis for a
variety of hyperparameters values. We multiplied the mean and variance of Œ±0, Œ≥0, Œ±1,
and Œ≥1 by 2 and 0.5, and multiplied the variance of P0 by 2 and 0.5. There were no
noticeable diÔ¨Äerences in the results.
Our approach has the inherent ability to identify latent clusters in the data, which
33

is not available in the model of (2.8). The estimated values of the hyperparameters
Œ±0 and Œ±1 were ÀÜŒ±0 = 0.15 and ÀÜŒ±1 = 0.18, with 95% credible intervals of [0.01, 0.53]
and [0.01, 0.55]. These values suggest few global and local clusters are present in the
data, which means that a sparse representation of the data is obtained. The posterior
probability of œÜ‚àó
0 = 1 was 0.96, suggesting that subjects are allocated to 1 global
cluster for the baseline eÔ¨Äects. The number of local clusters tended to be small, with
the estimated averages of 1.07 and 2.34 for the baseline eÔ¨Äect and the covariate eÔ¨Äects.
The estimated values of the hyperparameters Œ≥0 and Œ≥1 were 6.23 and 54.46, with 95%
credible intervals of [2.48, 11.12] and [40.96, 88.53]. Since the values of Œ≥0 and Œ≥1 close
to zeros favors pure global clustering, while large values favor pure local clustering,
there is clear evidence in the data favoring our approach over the Dirichlet process.
Wang et al. (2008) used the estimated time-varying eÔ¨Äect curve and the conÔ¨Ådence
band to visualize peak eÔ¨Äects. We conducted a formal Bayesian local hypothesis test-
ing procedure to characterize the activation/deactivation phase of TFs in regulating
the expression of cell cycle-regulated genes. The proposed Bayesian multiple hypoth-
esis testing procedure gives the optimal rejection threshold r‚àó= 0.886 by controlling
FDR ‚â§0.05. The decision rule rejects H0k, k = 1, . . . , 96 if any œÖkt ‚â•0.886. Figure 2.4
presents the posterior probability curves in favor of time-wise local alternative hypothe-
ses for eight experimentally veriÔ¨Åed TFs to regulate gene expression during cell cycle.
Our procedure found some interesting features not discovered in Wang et al. (2008).
For example, Wang et al. (2008) didn‚Äôt identify the fact that FKH2 is associated with
genes expressed in G1 and S (Simon et al., 2001), while our procedure showed FKH2
to be active during G1/S phase. MBP1, SWI4 and SWI6 work as a complex to bind
predominantly to promoter regions of G1 genes (Simon et al., 2001). Although Wang
et al. (2008) found approximately similar peak eÔ¨Äect time points for SWI4 and SWI6,
Figure 2.4 clearly displays that they have similar active time windows.
34

We use our proposed MdiÔ¨Ämethod to construct the 95% Bayesian conÔ¨Ådence bands
for the time-varying transcription eÔ¨Äects. As presented in Figure 2.2, MBP1, SWI4,
SWI6, MCM1, NDD1, FKH2, ACE2, and SWI5 were shown to have periodic tran-
scriptional eÔ¨Äect patterns over the collected two cell cycles, while Wang et al. (2008)
only showed certain periodic patterns for SWI4 and FKH2. Since the MdiÔ¨Ämethod
considers the multiplicity issue in a conservative way similar to the Bonferroni method,
the constructed conÔ¨Ådence bands are wide. Methodology for improved construction of
simultaneous conÔ¨Ådence bands is an important area for future research.
We repeated the analysis using DP priors for P ‚àºDP(Œ±0P0) and ÀúP ‚àºDP(Œ±1P0).
The posterior means of Œ±0 and Œ±1 were 2.43 and 0.58, with 95% credible intervals of
[1.26, 3.99] and [0.14, 1.42]. The posterior means of the number of clusters were 14
for the baseline eÔ¨Äect and 3.99 for the transcription factor eÔ¨Äects, reÔ¨Çecting a larger
number of clusters than in the local partition process.
In addition, the point-wise
local hypothesis testing procedure didn‚Äôt proÔ¨Åle the active phases of the veriÔ¨Åed TFs in
the literature, as illustrated in the Appendix Figure 2 in the supplementary material.
This is likely due to the tendency of the Dirichlet process to overly favor clustering of
subjects. In the situation of sparse basis coeÔ¨Écients, we recommend the local partition
process for gains in inference.
2.6
Discussion
This chapter has proposed a nonparametric Bayesian model for longitudinal data anal-
ysis, which allows a Ô¨Çexible time-varying baseline and covariate eÔ¨Äects for each subject,
while characterizing variability among subjects using a local partition process prior.
Posterior computation under the proposed Bayesian model is straightforward to im-
plement eÔ¨Éciently, with the steps involved consisting of sampling sequentially from
standard distributions. We have proposed novel methods for hypothesis testing and
35

estimation of simultaneous conÔ¨Ådence bounds on the mean time-varying coeÔ¨Écients
curves, with preliminary simulation studies showing excellent frequentist operating
characteristics for these methods.
A standard Bayesian nonparametric formulation
based on Dirichlet process priors for the random eÔ¨Äects has substantially worse perfor-
mance in all cases we have considered. We hope that this illustration of the potential of
nonparametric Bayes methods for longitudinal data analysis stimulates more work on
developing novel nonparametric methods motivated by biomedical applications. In such
settings, it is often the case that ‚ÄúoÔ¨Äthe shelf‚Äù priors, such as Dirichlet and Gaussian
processes, can be substantially improved upon, with the applied context motivating
modiÔ¨Åcations having more biologically realistic properties.
36

Table 2.1: Comparison of the LLP2 prior, the DP prior and the Ô¨Åxed eÔ¨Äects model:
mean square errors obtained from the 3 simulation cases: (i) global null case, (ii)
local alternative case, and (iii) global alternative case.
LPP2
DP
Fixed EÔ¨Äects
Œ≤i0(t)
Œ≤i1(t)
Œ≤i0(t)
Œ≤i1(t)
Œ≤i0(t)
Œ≤i1(t)
Global Null
0.536
0.969
0.561
9.571
0.989
1.047
Local Alternative
0.560
0.836
0.588
19.561
1.148
1.191
Global Alternative
1.300
2.673
1.365
16.741
1.580
1.719
Table 2.2: Type I error rates and powers of the global
hypothesis tests under both LPP2 prior and DP prior
obtained from 100 repeated data sets for the 3 simula-
tion cases: (i) global null case, (ii) local alternative case,
and (iii) global alternative case.
LPP2
DP
Global Null
0.05
0.19
Local Alternative
0.72
0.63
Global Alternative
0.92
0.92
Table 2.3: The average of observed FDRs and powers for multiple hypothesis testing
procedure under the LPP2 prior and the DP prior obtain from 100 simulated data
sets for the 3 simulation cases: (i) global null case, (ii) local alternative case, and
(iii) global alternative case.
LPP2
DP
FDR
Power
FDR
Power
Global Null
0.042
-
0.034
-
Local Alternative
0.032
0.367
0.028
0.332
Global Alternative
-
0.998
-
0.973
Table 2.4: The coverage rates of 95% conÔ¨Ådence band for 4 methods: MdiÔ¨Ä, Mdev,
Pnorm, CR under the LPP2 prior for the 3 simulation cases: (i) global null case,
(ii) local alternative case, and (iii) global alternative case.
MdiÔ¨Ä
Mdev
Pnorm
CR
Global Null
0.987
0.733
0.880
0
Local Alternative
0.967
0.680
0.847
0
Global Alternative
0.950
0.645
0.774
0
37

Fig. 2.1: Posterior probabilities of time-wise local alternative hypothesis for analyzing
the yeast cell-cycle gene expression data using LPP2 prior. The dashed line corresponds
to the optimal rejecting threshold r‚àó= 0.886.
G1: TFs reported to regulate gene
expression at the G1 phase; G2: TFs reported to regulate gene expression at the G2
phase; M: TFs reported to regulate gene expression at the M phase. A: active phase
above the threshold level; D: deactive phase below the threshold level.
38

Fig. 2.2: Posterior estimated mean time-varying coeÔ¨Écients (solid line: ‚Äî) and point-
wise 95% conÔ¨Ådence bands (dashed lines: - - -) for analyzing the yeast cell-cycle gene
expression data. G1: TFs reported to regulate gene expression at the G1 phase; G2:
TFs reported to regulate gene expression at the G2 phase; M: TFs reported to regulate
gene expression at the M phase.
39

2.7
Appendix
2.7.1
Appendix A: Proof of Proposition 1
From the realization of the LPP2 prior through sticking-breaking process, regardless of
which component a basis coeÔ¨Écient œëj comes from, œëj is drawn from the base Cauchy
measure P0. Then by the property of the linear combination of normal distributions
remaining a normal distribution, conditional on Œõ‚àí1 = diag{Œª‚àí1
1 , . . . , Œª‚àí1
p }, the condi-
tional distribution
f(t)|Œõ‚àí1 ‚àºN(0, B(t)‚Ä≤Œõ‚àí1B(t)).
Furthermore, the covariance between f(t1) and f(t2) conditional on Œõ‚àí1 is easily derived
as
Cov(f(t1), f(t2)|Œõ‚àí1) = B(t1)‚Ä≤Œõ‚àí1B(t2).
Then for a vector of such functions indexed by a Ô¨Ånite time set, it follows that
[f(t1), f(t2), . . . , f(tL)]‚Ä≤|Œõ‚àí1 ‚àºNL(0L√ó1, Œ£L√óL)
with Œ£L√óL = [œÉij], i = 1, . . . , L, j = 1, . . . , L, and œÉij = B(ti)‚Ä≤Œª‚àí1
1 B(tj).
2.7.2
Appendix B: the MCMC Posterior Computation Algo-
rithm
We deÔ¨Åne the following notations for convenient use in the description of the sampler:
‚Ä¢ W0 = (w‚Ä≤
01, . . . , w‚Ä≤
0n)‚Ä≤, with w0i = (b(t1), . . . , b(tmi))‚Ä≤, i = 1, . . . , n,
‚Ä¢ Z0 = diag(1(z101 = 1 ‚àíj), . . . , 1(z10p = 1 ‚àíj), . . . , 1(zn01 = 1 ‚àíj), . . . , 1(zn0p =
1 ‚àíj)),
40

‚Ä¢ Œ¶0 = diag(1(œÜ101 = h), . . . , 1(œÜ10p = h), . . . , 1(œÜn01 = h), . . . , 1(œÜn0p = h)),
‚Ä¢ R0 = (r‚Ä≤
0, . . . , r‚Ä≤
0)‚Ä≤
np√óp with r0 = diag(1, . . . , 1)p√óp,
‚Ä¢ Y = (y‚Ä≤
1, . . . , y‚Ä≤
n)‚Ä≤,
‚Ä¢ Z0Y = diag(1(Pp
l=1 1(z10l = 1 ‚àíj) ‚â•1), . . . , 1(Pp
l=1 1(zn0l = 1 ‚àíj) ‚â•1))n√ón,
‚Ä¢ Œ¶0Y = diag(1(Pp
l=1 1(œÜ10l = h) ‚â•1), . . . , 1(Pp
l=1 1(œÜn0l = h) ‚â•1))n√ón.
‚Ä¢ W = (w‚Ä≤
1, . . . , w‚Ä≤
n)‚Ä≤, with wi = (Bi(t1), . . . , Bi(tmi))‚Ä≤ for i = 1, . . . , n,
‚Ä¢ Z = diag(1(z111 = 1 ‚àíj), . . . , 1(z11p = 1 ‚àíj), . . . , 1(z1K1 = 1 ‚àíj), . . . , 1(z1Kp =
1 ‚àíj), . . . , 1(zn11 = 1 ‚àíj), . . . , 1(zn1p = 1 ‚àíj), . . . , 1(znK1 = 1 ‚àíj), . . . , 1(znKp =
1 ‚àíj)),
‚Ä¢ Œ¶ = diag(1(œÜ111 = h), . . . , 1(œÜ11p = h), . . . , 1(œÜ1K1 = h), . . . , 1(œÜ1Kp = h), . . . , 1(œÜn11 =
h), . . . , 1(œÜn1p = h), . . . , 1(œÜnK1 = h), . . . , 1(œÜnKp = h)),
‚Ä¢ R = (r‚Ä≤, . . . , r‚Ä≤)‚Ä≤
npK√ópK with r = diag(1, . . . , 1)pK√ópK,
‚Ä¢ Y = (y‚Ä≤
1, . . . , y‚Ä≤
n)‚Ä≤,
‚Ä¢ ZY = diag(1(PK
k=1
Pp
l=1 1(z1kl = 1 ‚àíj) ‚â•1), . . . , 1(PK
k=1
Pp
l=1 1(znkl = 1 ‚àíj) ‚â•
1))n√ón,
‚Ä¢ Œ¶Y
= diag(1(PK
k=1
Pp
l=1 1(œÜ1kl = h) ‚â•1), . . . , 1(PK
k=1
Pp
l=1 1(œÜnkl = h) ‚â•
1))n√ón,
Our sampling algorithm proceeds as follows:
Step 1. Update the subject-speciÔ¨Åc baseline Œ≤i0(t) part
1.
Update the latent ui0l from its conditional distribution Unif(0, œÄ0œÜi0l) for
l = 0, 1, . . . , p.
41

2.
Update the latent zi0l from its conditional distribution Ber(pi0l), with
pi0l =
ŒΩ0lN(yi; Œ∏i0(zi0l=1), Œ∏i, œÑ)
ŒΩ0lN(yi; Œ∏i0(zi0l=1), Œ∏i, œÑ) + (1 ‚àíŒΩ0l)N(yi; Œ∏i0(zi0l=0), Œ∏i, œÑ),
where Œ∏i0(zi0l=j) refers to the current value of Œ∏i0 with inserting Œò00œÜi0ll to the
lth component for j = 1, and Œò01œÜi0ll for j = 0.
3.
Update the stick-breaking variable œÄ‚àó
0h with its conditional distribution
Beta(
p
X
l=0
n
X
i=1
1(œÜi0l = h) + 1,
p
X
l=0
n
X
i=1
1(œÜi0l > h) + Œ±)
for h ‚â§œÜ‚àó
0, with œÜ‚àó
0 = max{œÜi0l, i = 1, . . . , n, l = 0, 1, . . . , p}; for h > œÜ‚àó
0,
sample it from Beta(1, Œ±0).
4.
Update œÜi0l with its conditional probability Pr(œÜi0l = h) ‚àù1(h ‚ààAi0l)N(yi; Œ∏i0(œÜi0l=h), Œ∏i, œÑ),
where Ai0l = {h : œÄ0h > ui0l} ‚äÇ{1, 2, . . . , ‚àû}, which is obtained by sampling
œÄ‚àó
0h for h = 1, . . . , ÀúœÜ0 with ÀúœÜ0 the smallest value satisfying
ÀúœÜ0
X
h=1
œÄ‚àó
0h
Y
l<h
(1 ‚àíœÄ‚àó
0l) ‚â•1 ‚àíu‚àó
0,
where u‚àó
0 = min{ui0l, i = 1, . . . , n, l = 0, 1, . . . , p}.
5.
Update Œò0jh from its conditional distribution Np(¬µ0jh, Œ£0jh), where
Œ£0jh = [diag(Œª0jh, . . . , Œª0jh)p√óp + œÑW ‚Ä≤
0jhW0jh]‚àí1 and ¬µ0jh = œÑŒ£0jhW ‚Ä≤
0jhY0jh,
in which Y0jh refers to the contribution for Œò0jh from subjects with zi0l =
1 ‚àíj and œÜi0l = h. In addition, W0jh = diag(w01, . . . , w0n)Z0Œ¶0R0, and
Y0jh = diag(y1, . . . , yn)Z0Y Œ¶0Y 1n, where 1n is a n √ó 1 vector of entries of 1.
6.
Update Œª0jh from its conditional distribution Ga(0.5+p/2, 0.5+Œò‚Ä≤
0jhŒò0jh/2).
42

7.
Update ŒΩ0l from its conditional distribution Beta(1+P
i zi0l, Œ≥0+P
i(1‚àízi0l)).
8.
Update the hyperparameter Œ≥0 from its conditional distribution Ga(aŒ≥ +
p, bŒ≥ ‚àíPp
l=1 log(1 ‚àíŒΩ0l)).
9.
Update the hyperparameter Œ±0 from its conditional distribution Ga(aŒ± +
œÜ‚àó
0, bŒ± ‚àíPœÜ‚àó
0
h=1 log(1 ‚àíœÄ‚àó
0h)).
Step 2. Sample the coeÔ¨Écient regression functions {Œ≤ik(t)}K
k=1 part in a manner similar
to Step 1.
1.
Update the latent uikl from its conditional distribution Unif(0, œÄœÜikl) for k =
1, . . . , K, l = 0, 1, . . . , p.
2.
Update the latent zikl from its conditional distribution Ber(pikl), with
pikl =
ŒΩklN(yi; Œ∏i0, Œ∏i(zikl=1), œÑ)
ŒΩklN(yi; Œ∏i0, Œ∏i(zikl=1), œÑ) + (1 ‚àíŒΩkl)N(yi; Œ∏i0, Œ∏i(zikl=0), œÑ),
where Œ∏i(zikl=j) refers to the current value of Œ∏i with inserting Œò0œÜikll to the
lth component for j = 1, and Œò1œÜikll for j = 0.
3.
Update the stick-breaking variable œÄ‚àó
h with its conditional distribution
Beta(
p
X
l=0
K
X
k=1
n
X
i=1
1(œÜikl = h) + 1,
p
X
l=0
K
X
k=1
n
X
i=1
1(œÜikl > h) + Œ±)
for h ‚â§œÜ‚àó, with œÜ‚àó= max{œÜikl, i = 1, . . . , n, k = 1, . . . , K, l = 0, 1, . . . , p};
for h > œÜ‚àó, sample it from Beta(1, Œ±1).
4.
Update œÜikl with its conditional probability Pr(œÜikl = h) ‚àù1(h ‚ààAikl)N(yi; Œ∏i0, Œ∏i(œÜikl=h), œÑ),
where Aikl = {h : œÄh > uikl} ‚äÇ{1, 2, . . . , ‚àû}, which is obtained by sampling
43

œÄ‚àó
h for h = 1, . . . , ÀúœÜ with ÀúœÜ the smallest value satisfying
ÀúœÜ
X
h=1
œÄ‚àó
h
Y
l<h
(1 ‚àíœÄ‚àó
l ) ‚â•1 ‚àíu‚àó,
where u‚àó= min{uikl, i = 1, . . . , n, k = 1, . . . , K, l = 0, 1, . . . , p}.
5.
Update Œòjh = (Œòjh1, . . . , ŒòjhK) and Œªjhk, j = 0, 1:
a.
Update Œòjh from its conditional distribution Np(¬µjh, Œ£jh), where
Œ£jh = [diag(Œªjh11p, . . . , ŒªjhK1p)pK√ópK+œÑW ‚Ä≤
jhWjh]‚àí1 and ¬µjh = œÑŒ£jhW ‚Ä≤
jhYjh,
with Yjh referring to the contribution for Œòjh from subjects with zikl =
1 ‚àíj and œÜikl = h, so as to Wjh, for l = 1, . . . , p. SpeciÔ¨Åcally, Wjh =
diag(w1, . . . , wn)ZŒ¶R, and Yjh = diag(y1, . . . , yn)ZY Œ¶Y 1n, where 1n is
a n √ó 1 vector of entries of 1.
b.
Update Œªjhk from its conditional distribution Ga(0.5+p/2, 0.5+Œò‚Ä≤
jhkŒòjhk/2).
6.
Update ŒΩkl from its conditional distribution Beta(1 + P
i zikl, Œ≥1 + P
i(1 ‚àí
zikl)).
7.
Update the hyperparameter Œ≥1 from its conditional distribution Ga(aŒ≥ +
pK, bŒ≥ ‚àíPK
k=1
Pp
l=1 log(1 ‚àíŒΩkl)).
8.
Update the hyperparameter Œ±1 from its conditional distribution Ga(aŒ± +
œÜ‚àó, bŒ± ‚àíPœÜ‚àó
h=1 log(1 ‚àíœÄ‚àó
h)).
Step 3. Update the precision parameter œÑ with its conditional distribution Ga(aœÑ+P
i ni/2, bœÑ+
P
i{yi ‚àíŒ≤i0(t) ‚àíPK
k=1 Œ≤ik(t)xik}‚Ä≤{yi ‚àíŒ≤i0(t) ‚àíPK
k=1 Œ≤ik(t)xik}/2).
44

Appendix Figure 1
Fig. 2.3: Boxplots showing the number of global and local clusters for baseline eÔ¨Äects
and TFs eÔ¨Äects
45

Appendix Figure 2
Fig. 2.4: Posterior probabilities of time-wise local alternative hypothesis for analyzing
the yeast cell-cycle gene expression data using DP prior. The dashed line corresponds
to the optimal rejecting threshold r‚àó= 0.683.
G1: TFs reported to regulate gene
expression at the G1 phase; G2: TFs reported to regulate gene expression at the G2
phase; M: TFs reported to regulate gene expression at the M phase. A: active phase
above the threshold level; D: deactive phase below the threshold level.
46

Chapter 3
Semiparametric Bayesian Local
Functional Models
for DiÔ¨Äusion Tensor Tract
Statistics
3.1
Introduction
DiÔ¨Äusion tensor imaging (DTI) is an magnetic resonance imaging (MRI) technique
that measures the diÔ¨Äusion orientation of water molecules in tissue. The mobility of
water molecules is aÔ¨Äected by the tissue properties of white matter Ô¨Åber tracts, such
as the density of the Ô¨Åbers, the average Ô¨Åber diameter, and the directionality of the
Ô¨Åbers. In turn, the information collected on the diÔ¨Äusion properties of water molecules
provides the structural organization of the white matter Ô¨Åber tracts (Kubicki et al.,
2007). The water diÔ¨Äusion directions and magnitudes at each voxel in the brain can be
described by a 3 √ó 3 symmetric positive matrix, called a diÔ¨Äusion tensor (DT) (Basser
et al., 1994a,b). The degree of diÔ¨Äusivity can be quantiÔ¨Åed by the three eigenvalue-
eigenvector pairs of DT, and its related parameters, such as fractional anisotropy (FA)

(Pierpaoli and Basser, 1996; Hasan et al., 2001; Hasan and Narayana, 2003; Zhu et al.,
2006). A rich literature in neuroimaging has been developed to analyze white matter
Ô¨Åber tract maturation and integrity via a set of water diÔ¨Äusion parameters such as
FA, mean diÔ¨Äusivity (MD) and so on, used as markers (Moseley, 2002; Mukherjee and
McKinstry, 2006; Cascio et al., 2007; Rollins, 2007).
Three major analytic approaches for grouping analysis of DTI data set have been
explored including analyses based on region-of-interest (ROI), voxels, and Ô¨Åber tracts
(Smith et al., 2006; O‚ÄôDonnell et al., 2009; Snook et al., 2007). The region-of-interest
(ROI) method (Bonekam et al., 2008; Gilmore et al., 2008) suÔ¨Äers from diÔ¨Éculties in
identifying meaningful ROIs, particularly the long curved structures common in Ô¨Åber
tracts, instability of statistical results, and the partial volume eÔ¨Äect in relatively large
ROIs (Snook et al., 2007). Voxel based analysis (Chen et al., 2009; Focke et al., 2008;
Camara et al., 2007; Snook et al., 2005) suÔ¨Äers from issues of alignment quality and
the arbitrary choice of smoothing extent (Hecke et al., 2009; Ashburner and Friston,
2000; Smith et al., 2006; Jones et al., 2005).
There is an extensive interest in the DTI literature in developing Ô¨Åber tract based
analysis of diÔ¨Äusion properties (Smith et al., 2006; O‚ÄôDonnell et al., 2009; Yushkevich
et al., 2008; Goodlett et al., 2009; Zhu et al., 2010, 2011; Goldsmith et al., 2011). Such
analyses usually consist of DTI atlas building and a follow-up statistical analysis (Smith
et al., 2006; Goodlett et al., 2009; Zhu et al., 2010). DTI atlas building is primarily to
establish DTI correspondence across all DTI datasets from diÔ¨Äerent subjects and to ex-
tract a set of individual DTI tracts (or skeleton) with the same corresponding geometry
but varying DTs and diÔ¨Äusion properties. For instance, Smith et al. (2006) developed a
tract-based spatial statistics framework to construct local diÔ¨Äusion properties along the
white matter skeleton, Ô¨Åtted pointwise linear regression models, and performed point-
wise hypothesis tests on the skeleton. This method essentially ignores the functional
48

nature of diÔ¨Äusion properties along the white matter skeleton, and thus suÔ¨Äers from low
statistical power in detecting interesting features and exploring variability in functional
data. Goodlett et al. (2009) used functional principal component analysis (fPCA) cou-
pled with the Hotelling T 2 statistic to compare a univariate diÔ¨Äusion property, such as
fractional anisotropy, across two (or more) populations for a single hypothesis test per
tract. Zhu and his coauthors (Zhu et al., 2010, 2011) proposed a multivariate vary-
ing coeÔ¨Écient model based on fPCA for the analysis of Ô¨Åber bundle multiple diÔ¨Äusion
properties and their association with a set of covariates of interest such as age. Greven
et al. (2010) developed a functional mixed eÔ¨Äects model as a generalization of mixed
eÔ¨Äects models and fPCA for the analysis of longitudinal DTI Ô¨Åber tract data. So far,
frequentist inference is the primary approach for making statistical inferences in these
statistical models for Ô¨Åber tract based analysis of diÔ¨Äusion properties.
In this chapter, we propose a new semiparametric Bayes approach to model the as-
sociation between multiple Ô¨Åber bundle diÔ¨Äusion properties and covariates of interest.
A multivariate random coeÔ¨Écient model is developed to characterize heterogeneity in
the shape of the Ô¨Åber bundle diÔ¨Äusion properties among subjects, while allowing the im-
pact of covariates to vary across subjects. We assume a nonparametric Bayesian LPP2
prior (Dunson, 2009) on the distribution of the random coeÔ¨Écients to facilitate global
and local borrowing of information among subjects. We consider a sparse latent factor
model to more Ô¨Çexibly capture the within-subject correlation structure and assume a
multiplicative gamma process shrinkage prior on the factor loadings which allows in-
troduction of inÔ¨Ånitely many factors (Bhattacharya and Dunson, 2011). We propose
Bayesian local hypothesis testing to identify Ô¨Åber segments, where multiple diÔ¨Äusion
properties are signiÔ¨Åcantly associated with covariates of interest, while controlling for
multiple comparisons. We propose a Bayesian conÔ¨Ådence band for the average eÔ¨Äect
of each covariate. Finally, we use the nonparametric LPP2 prior to randomly cluster
49

subjects via global and local clustering. Posterior computation proceeds via an eÔ¨Écient
Markov chain Monte Carlo (MCMC) algorithm using the exact block Gibbs sampler.
3.2
Methodologies
This chapter focuses on developing a semiparametric Bayesian multivariate functional
regression analysis pipeline, named as SBLFM, to assess the association between Ô¨Åber
bundle diÔ¨Äusion properties and a set of covariates of interest (e.g., age). Before SBLFM,
we use DTI atlas building followed by atlas Ô¨Åber tractography and Ô¨Åber parametriza-
tion as described in Goodlett et al. (2009) to extract DTI Ô¨Åbers and establish DTI Ô¨Åber
correspondence across all DTI datasets from diÔ¨Äerent subjects. We skip its description
here for the sake of simplicity (Goodlett et al., 2009; Zhu et al., 2010). After performing
the DTI atlas building step, we obtain a set of individual Ô¨Åber tracts (or skeleton) with
the same corresponding geometry but varying DTs and diÔ¨Äusion properties. Subse-
quently, we run the analysis pipeline SBLFM including a multivariate random varying
coeÔ¨Écient model, a semiparametric Bayesian estimation method, a Bayesian approach
to construct conÔ¨Ådence bands, a Bayesian local hypothesis testing procedure, and a
Bayesian posterior cluster analysis procedure (Fig. 3.1). The computational algorithm
for SBLFM is developed by using Matlab.
3.2.1
Multivariate Random CoeÔ¨Écient Model
Assume n subjects are measured along a Ô¨Åber bundle over a grid of T points for M
diÔ¨Äusion properties (e.g. FA), denoted by {Yi(dt) : i = 1, . . . , n, t = 1, . . . , T}, where
Yi(dt) = (Y (1)
i
(dt), . . . , Y (M)
i
(dt))‚Ä≤ is an M √ó 1 vector of diÔ¨Äusion properties for the i-th
subject, dt ‚àà[0, L] is the arc length of point t relative to a Ô¨Åxed end point of the Ô¨Åber
bundle, and L is arc length of this Ô¨Åber bundle. For the i-th subject, we relate the
m-th functional diÔ¨Äusion response Y (m)
i
(dt) to a set of K covariates via a multivariate
50

random coeÔ¨Écient model given by
Y (m)
i
(dt)
=
Œ≤(m)
i
(dt)‚Ä≤Xi + œµ(m)
i
(dt), œµ(m)
i
(dt) ‚àºN(0, œÉ2
m,t),
(3.1)
where Xi = (1, x‚Ä≤
i)‚Ä≤ is the design vector for the i-th subject with xi = (xi1, ¬∑ ¬∑ ¬∑ , xiK)‚Ä≤
being a K √ó 1 vector of covariates of interest, and Œ≤(m)
i
(dt) = (Œ≤(m)
i,0 (dt), . . . , Œ≤(m)
i,K (dt)‚Ä≤
is a (K + 1) √ó 1 vector of random coeÔ¨Écients for the m-th diÔ¨Äusion property. The
measurement error œµ(m)
i
(dt) is assumed to be drawn from a normal distribution with
mean zero and standard deviation œÉm,t.
We model the random coeÔ¨Écient function Œ≤(m)
i,k (dt) by using a linear combination of
cubic B-spline basis functions bl(dt)s as follows:
Œ≤(m)
i,k (dt) =
p
X
l=1
Œ∑(m)
ikl bl(dt) = b(dt)‚Ä≤Œ∑(m)
ik ,
(3.2)
where b(dt) = (b1(dt), . . . , bp(dt))‚Ä≤ is a p √ó 1 vector for B-spline basis functions and
Œ∑(m)
ik
= (Œ∑(m)
ik1 , . . . , Œ∑(m)
ikp )‚Ä≤ is a p √ó 1 vector of random coeÔ¨Écients. Thus, the model (3.1)
can be written as
Y (m)
i
(dt) = Bi(dt)‚Ä≤Œ∑(m)
i
+ œµ(m)
i
(dt) for m = 1, . . . , M,
(3.3)
where Œ∑(m)
i
= (Œ∑(m)
i0
‚Ä≤, . . . , Œ∑(m)
iK
‚Ä≤)‚Ä≤ and Bi(dt) = Xi ‚äób(dt) are (K + 1)p √ó 1 vectors.
Heterogeneity in the Ô¨Åber bundle diÔ¨Äusion properties is then controlled by the variation
of Œ∑(m)
i
, which are usually treated as random eÔ¨Äects and follow a speciÔ¨Åc parametric
distribution. There is a serious concern about the sensitivity of associated inferences
to the choice of the random eÔ¨Äects distribution on the basis coeÔ¨Écients.
Let Œ∑i = (Œ∑(1)
i
‚Ä≤, . . . , Œ∑(M)
i
‚Ä≤)‚Ä≤ be an M(K + 1)p √ó 1 vector, Bi = (Bi(d1), . . . , Bi(dT))‚Ä≤
be a T √ó (K + 1)p matrix, and Yi = (Y (1)
i
‚Ä≤, . . . , Y (M)
i
‚Ä≤)‚Ä≤ be an MT √ó 1 vector, where
51

Y (m)
i
= (Y (m)
i
(d1), . . . , Y (m)
i
(dT))‚Ä≤ is a T√ó1 vector for m = 1, . . . , M. The concantenated
representation of model (3.3) is given by
Yi = (IM ‚äóBi)Œ∑i + œµi, œµi ‚àºNMT(0, Œ£),
(3.4)
where NMT(0, Œ£) is an MT √ó1 Gaussian random vector with mean zero and covariance
matrix Œ£ = diag(œÉ2
1,1, . . . , œÉ2
M,T).
3.2.2
InÔ¨Ånite Latent Factor Model
Given the massive dimensionality of the random eÔ¨Äect vector Œ∑i, it is important to favor
lower dimensional representations of the dependence structure to address the curse of
dimensionality. Instead of prespecifying a restrictive dependence structure, we follow
the approach of using a Bayesian factor model, which relates the random eÔ¨Äects Œ∑i to
latent factors Œ∏i through the following characterization
Œ∑i = AŒ∏i,
(3.5)
where A is a (K + 1)pM √ó ‚àûfactor loadings matrix and Œ∏i ‚àºN‚àû(0, I‚àû). For di-
mensionality reduction, one would typically restrict the dimension of the latent factor
vector Œ∏i to be orders of magnitude less than that of Œ∑i. However, following the moti-
vation of Bhattacharya and Dunson (2011), we bypass the challenging issue of selecting
the number of factors by incorporating inÔ¨Ånitely many factors, while choosing a prior
that favors the elements of A to be shrunk to zero increasingly as the column index
increases.
We obtain the within-subject correlation structure through projecting Yi as a linear
combination of the underlying ‚àû-dimensional latent random vector Œ∏i after denoising,
52

via
Yi = (IM ‚äóBi)AŒ∏i + œµi, œµi ‚àºNMT(0, Œ£),
(3.6)
where Bi(dt) = Xi ‚äób(dt) and Bi = (Bi(d1), . . . , Bi(dT))T. The common factors Œ∏i
explain the within-subject dependence structure among the MT variables for each Yi.
Let Yif and œÉ2
f be, respectively, the f-th component of Yi and the f-th diagonal
element of Œ£.
Conditional on Œ∏i, Yif1 and Yif2 are uncorrelated for all f1 and f2
‚àà{1, . . . , MT}. Marginalizing over the distribution of Œ∏i, the covariance structure ‚Ñ¶
of the data distribution Yi ‚àºNMT(0, Œ£) is induced as
‚Ñ¶= Var(Yi|A, Œ£) = (IM ‚äóBi)AAT(IM ‚äóBi)T + Œ£.
SpeciÔ¨Åcally, conditional on A and Œ£, we have:
Var(Yif1|Œ∏i, A, Œ£)
=
œÉ2
f1,
Cov(Yif1, Yif2|Œ∏i, A, Œ£)
=
0,
Var(Yif1|A, Œ£)
=
(IM ‚äóBiA)f1(IM ‚äóBiA)T
f1 + œÉ2
f1,
Cov(Yif1, Yif2|A, Œ£)
=
(IM ‚äóBiA)f1(IM ‚äóBiA)T
f2,
where (IM ‚äóBiA)f1 is the f1th row of (IM ‚äóBiA).
A constraint is usually speciÔ¨Åed on A to deÔ¨Åne a unique model free from identiÔ¨Åca-
tion problems, since ‚Ñ¶is invariant under the transformations A‚àó= AP for any semi-
orthogonal matrix P (PP T = I). The traditional full rank lower triangular constraint
for identiÔ¨Åability implicity speciÔ¨Åes order dependence among the responses (Geweke and
Zhou, 1996). The choice of ordering of the response variables is a modeling decision
(Carvalho et al., 2008). From the Baysian perspective, we don‚Äôt require identiÔ¨Åability
53

of the loading elements in A for a wide class of applications such as covariance matrix
estimation. In our case, we specify the multiplicative gamma process shrinkage prior,
which will be given in (3.7), on a parameter expanded loadings matrix with redundant
parameters. The induced prior on the covariance matrix is invariant to ordering of the
data. This shrinkage prior adaptively selects a truncation of the inÔ¨Ånite loadings to
one having Ô¨Ånite columns, which facilitates the posterior computation and provides an
accurate approximation to the inÔ¨Ånite factor model.
Although FRATS (Zhu et al., 2010) and FADTTS (Zhu et al., 2011) have been
proposed to analyze the DTI Ô¨Åber bundle data sets of multiple diÔ¨Äusion measures with
a set of covariates such as gender and gestational age, they assume identical eÔ¨Äects
of the covariates on the diÔ¨Äusion properties for all subjects. Our SBLFM developed
here relaxes the assumption to allow the subject speciÔ¨Åc functional covariate eÔ¨Äects on
the multiple diÔ¨Äusion outcome functions. In addition, FRATS and FADTTS assume a
covariate-free correlation structure among the multiple diÔ¨Äusion properties. We intro-
duce the random factors underlying the subject speciÔ¨Åc covariate eÔ¨Äects to allow the
correlation structure among the multiple diÔ¨Äusion measures to vary with the levels of
the covariates along the Ô¨Åber tracts. Moreover, we specify a LPP2 prior on the distri-
butions of the subject speciÔ¨Åc random factors to produce a global and local clustering
structure of the multiple diÔ¨Äusion trajectories across the subjects.
3.2.3
Priors
We choose independent priors for A, Œ∏i, and Œ£ and develop an eÔ¨Écient Markov chain
Monte Carlo (MCMC) algorithm given in the Appendix for posterior computation.
To remove the redundant factors, we place the multiplicative gamma process shrink-
age prior (Bhattacharya and Dunson, 2011) on the loadings matrix A to increasingly
shrink the loadings toward zero with the column index. This speciÔ¨Åcation avoids the
54

traditional drawback of order dependence from the lower triangular constraint for iden-
tiÔ¨Åability. We use the inverse gamma priors on the diagonal elements of Œ£. To allow
the latent clustering structure among subjects, we specify a LPP2 prior (Dunson, 2009)
on the prior distribution P of Œ∏i. Let Ga(a, b) be a gamma distribution with scale a
and shape b. SpeciÔ¨Åcally, these priors in details are given as follows:
A
=
{Agh}, g = 1, . . . , (K + 1)pM ; h = 1, . . . , ‚àû,
Agh|œÜgh, œÑh
‚àº
N(0, œÜ‚àí1
gh œÑ ‚àí1
h ), œÜgh ‚àºGa(v/2, v/2), œÑh =
h
Y
l=1
Œ¥l,
Œ¥1
‚àº
Ga(a1, 1), Œ¥l ‚àºGa(a2, 1), l ‚â•2,
œÉ‚àí2
f
‚àº
Ga(aœÉ, bœÉ), f = 1, . . . , MT,
(3.7)
Œ∏i
‚àº
P, P ‚àºLPP2(Œ±, Œ≥, P0), P0 : Œ∏i ‚àºN‚àû(0, Œ∂I‚àû), Œ∂ ‚àºGa(0.5, 0.5),
where Œ¥l, l = 1, . . . , ‚àû, are independent, œÑh is a global shrinkage parameter for the
hth column, and the œÜghs are local shrinkage parameters for the elements in the hth
column. When a2 > 1, the œÑhs increase stochastically as the column index h increases,
which means more shrinkage favored over the columns of higher indexes. The loading
component speciÔ¨Åc prior precision œÜ‚àí1
gh œÑ ‚àí1
h
allows shrinking the coeÔ¨Écients of the B-
spline basis functions. The LPP2 prior assumption speciÔ¨Åes an ‚àû-dimensional central
probability measure P0 as a prior guess, a precision parameter Œ± expressing conÔ¨Ådence
in the prior guess, and a hyperparameter Œ≥ determining the overall allocation weight
on the local family.
3.2.4
LPP2 prior
In modelling the multiple trajectories of diÔ¨Äusion measures over subjects, we are in-
terested in identifying the latent cluster structure of Yis among subjects, which can
be induced by specifying a nonparametric prior on the unknown distribution of the
55

random factors Œ∏i. Dirichlet process prior (Ferguson, 1973, 1974) is the routine ap-
proach to induce a sparse representation of subjects. However, it has the drawback of
global clustering, in which two subjects are either allocated to an identical cluster or
two diÔ¨Äerent clusters. In DTI imaging data analysis, it is common that two subjects
have similar diÔ¨Äusion trajectories over the major region of Ô¨Åber bundles while having
local deviations. Under the Dirichlet process, either such subjects are inappropriately
clustered together, obscuring local diÔ¨Äerences, or allocated to separate clusters causing
unnecessary computational burden. We used the LPP2 prior (Dunson, 2009) to model
the unknown random eÔ¨Äects distributions to facilitate both global and local clustering
of random eÔ¨Äects. It relaxes the global clustering assumption of the widely-used Dirich-
let process prior, while accomplishing sparseness for substantial gains in computational
eÔ¨Éciency.
After truncating the loadings matrix A to h‚àó‚â™(K + 1)pM columns, we assume
the resulting h‚àó-dimensional random eÔ¨Äects Œ∏i = (Œ∏i1, . . . , Œ∏ih‚àó)T ‚àºP with P unknown,
i = 1, . . . , n. The LPP2 prior models P as a hybrid mixture distribution:
P =
1
X
z1=0
(1‚àíz1,‚àû)
X
œà1=(1‚àíz1,1)
¬∑ ¬∑ ¬∑
1
X
z‚àó
h=0
(1‚àízh‚àó,‚àû)
X
œàh‚àó=(1‚àíz‚àó
h,1)
œÄœà1,...,œàh‚àóŒ¥Œòœà,
(3.8)
where Œ¥x denotes a degenerate distribution with all its mass at x, œÄœà1,...,œàh‚àóis the
probability of Œ∏i = Œòœà having the property that œÄœà1,...,œàh‚àó‚â•0 and
1
X
z1=0
(1‚àíz1,‚àû)
X
œà1=(1‚àíz1,1)
¬∑ ¬∑ ¬∑
1
X
zh‚àó=0
(1‚àízh‚àó,‚àû)
X
œàh‚àó=(1‚àízh‚àó,1)
œÄœà1,...,œàh‚àó= 1.
The indicator zj ‚àºBer(ŒΩj), j = 1, . . . , h‚àó, denotes the allocation to global clustering or
local clustering, taking the value of 1 for global clustering and 0 for local clustering. The
hybrid atom Œòœà = (Œòœà1,1, . . . , Œòœàh‚àó,h‚àó)T is obtained by setting the jth element of Œòœà
56

equal to Œòœàj,j with œàj = (1 ‚àízj, œÜj) and Œòœàj ‚àºP0 for œÜj ‚àà{1, . . . , ‚àû}, j = 1, . . . , h‚àó,
where P0 is a base distribution.
Let œÄh denote Pr(Œ∏ij = Œòghj), g = 0, 1, h = 1, . . . , ‚àû, j = 1, . . . , h‚àó.
Those
random eÔ¨Äects having zj = 1 are assigned together to a component in the global family
Œû0 = {Œò0h}‚àû
h=1, while others having zj = 0 are assigned to their own component in the
local family Œû1 = {Œò1h}‚àû
h=1. Let J0 = {j : zj = 1} and J1 = {j : zj = 0}. Conditional
on the values of z, we have
Pr(œàj = (0, h), j ‚ààJ0|z1, . . . , zh‚àó) = œÄh, h = 1, . . . , ‚àû,
Pr(œàj = (1, hj), j ‚ààJ1|z1, . . . , zh‚àó) =
Y
j‚ààJ1
œÄhj, hj = 1, . . . , ‚àû.
The allocation probability of Œ∏i = Œòœà in (3.8) is then simply
œÄœà1,...,œàh‚àó= Pr(œà1 = (1 ‚àíz1, h1), . . . , œàh‚àó= (1 ‚àízh‚àó, hh‚àó)) = œÄh
 Y
j‚ààJ1
œÄhj
 h‚àó
Y
j=1
ŒΩ
zj
j (1 ‚àíŒΩj)1‚àízj

.
The speciÔ¨Åcation is completed by choosing the hyperpriors
ŒΩj ‚àºBeta(1, Œ≥),
j = 1, . . . , h‚àó,
œÄh = œÄ‚àó
h
Y
l<h
(1 ‚àíœÄ‚àó
l ),
œÄ‚àó
h ‚àºBeta(1, Œ±),
h = 1, . . . , ‚àû,
where Œ≥ controls the overall weight on the local family, and Œ± controls the overall
number of clusters. As short hand, the LPP2 prior on the random eÔ¨Äects distribution
P is denoted by P ‚àºLPP2(Œ±, Œ≥, P0).
The LPP2 prior speciÔ¨Åcation (3.8) can also be viewed as a hybrid mixture model of
inÔ¨Ånitely many components drawn from P0 via 2-stage clustering. Stage 1 determines
the membership of global or local clustering for each of the h‚àócomponents. Those
components allocated to the global clustering membership will be clustered together
57

to an atom in the global family at stage 2, while those allocated to the local family
will be allocated individually to their own clusters.
The joint cluster membership
probability at stage 1 corresponds to Pr(z1, . . . , zh‚àó) = Qh‚àó
j=1 ŒΩ
zj
j
(1 ‚àíŒΩj)1‚àízj. The joint
cluster allocation weight at stage 2 conditional on stage 1 corresponds to Pr(œà1 =
(1 ‚àíz1, h1), . . . , œàh‚àó= (1 ‚àízh‚àó, hh‚àó)|z1, . . . , zh‚àó). The overall joint cluster allocation
weight corresponds to œÄœà1,...,œàh‚àó.
3.2.5
Hypothesis Formulation & Testing
We are interested in making pointwise inference for the covariate eÔ¨Äects along a Ô¨Åber
bundle. The local null and alternative hypotheses for the kth covariate eÔ¨Äect on the
mth diÔ¨Äusion property speciÔ¨Åc to a location dt ‚àà[0, L] are formulated as:
H(m)
0k (dt) :
Œ≤
(m)
k
(dt)
 ‚â§œµ versus H(m)
1k (dt) :
Œ≤
(m)
k
(dt)
 > œµ,
where Œ≤
(m)
k
(dt) represents the mean of the subject-speciÔ¨Åc random coeÔ¨Écients for the
kth predictor on the mth diÔ¨Äusion property at location dt. The zero-neighborhood size
œµ is chosen as being proportional to the maximum posterior standard deviation of the
posterior samples of Œ≤(m)
i,k (dt) multiplied by œµ‚àó. It is important to be aware that the
data have been normalized prior to analysis.
To conduct local hypotheses testing, we use the Bayesian decision rule for multiple
testing proposed by M¬®uller et al. (2004). Following the implementation in Wang and
Dunson (2010), our strategy is to reject H(m)
0k (t) if the posterior alternative hypothesis
probability œÖ(m)
kt
= Pr(H(m)
1k (t)|Data) ‚â•r for any t ‚àà[0, T], with r as a common
threshold for all the local hypotheses. r is chosen to minimize the posterior expected
false negative rate (FNR) under the constraint of the posterior expected false discovery
rate (FDR) being no greater than Œ±T, where Œ±T is pre-speciÔ¨Åed (we focus on a value
58

of 0.05). Denote d(m)
kt
= 1(œÖ(m)
kt
‚â•r), an indicator of rejecting H(m)
0k (t). The posterior
expected FNR and FDR are calculated as:
FNR =
PM
m=1
R T
0 (1 ‚àíd(m)
kt )œÖ(m)
kt dt
M
R T
0 dt ‚àíPM
m=1
R T
0 d(m)
kt dt + Œ∫0
‚âà
PM
m=1
PtW
t=t1(1 ‚àíd(m)
kt )œÖ(m)
kt T/W
KT ‚àíPM
m=1
PtW
t=t1 d(m)
kt T/W + Œ∫0
,
FDR =
PM
m=1
R T
0 d(m)
kt (1 ‚àíœÖ(m)
kt )dt
PM
m=1
R T
0 d(m)
kt dt + Œ∫0
‚âà
PM
m=1
PtW
t=t1 d(m)
kt (1 ‚àíœÖ(m)
kt )T/W
PM
m=1
PtW
t=t1 d(m)
kt T/W + Œ∫0
,
where t1, . . . , tW is a Ô¨Åne grid of points equally spaced along [0, T] and Œ∫0 is a small
positive constant to avoid a zero denominator. In summary, our decision rule is to
determine the optimal threshold r‚àóby r‚àó= argmin FNR{r ‚àà[0, 1], FDR ‚â§Œ±T}. For
each combination of m and t ‚àà{t1, . . . , tW}, we reject H(m)
0k (t) if œÖ(m)
kt
‚â•r‚àó. For a suÔ¨É-
ciently Ô¨Åne grid, the results are robust to w, with the optimal threshold appropriately
adapting to the chosen w.
3.2.6
Bayesian ConÔ¨Ådence Bands
We construct a Bayesian simultaneous conÔ¨Ådence (credible) band for the mean coeÔ¨É-
cient curve Œ≤
(m)
k
(t), k = 1, . . . , K, m = 1, . . . , M, from its posterior MCMC samples.
Assuming there is a collection of posterior sampled curves Œ≤(m),s
k
= (Œ≤(m),s
k
(t1), . . . , Œ≤(m),s
k
(tL))T,
s = 1, . . . , S indexing posterior iterations after burn-in, our goal is to compute a simulta-
neous conÔ¨Ådence band for Œ≤
(m)
k
(t). The principle in constructing a Bayesian conÔ¨Ådence
band is to search for a region RŒ± = {RŒ±(t), t ‚àà[0, T]} such that
Pr{Œ≤
(m)
k
(t) ‚ààRŒ±(t), t ‚àà[0, T]} = 1 ‚àíŒ±,
where Œ± is a pre-speciÔ¨Åed signiÔ¨Åcance level.
The strategy is based on pointwise measures of uncertainty. We used the method
59

proposed by Crainiceanu et al. (2007) which assumes approximate posterior normality
at each grid point and derives the 1 ‚àíŒ± sample percentile c1‚àíŒ± of
max
l=1,...,L

Œ≤(m),s
k
(tl) ‚àíÀÜŒ≤(m)
k
(tl)
q
c
var(ÀÜŒ≤(m)
k
(tl))
, s = 1, . . . , S,
where ÀÜŒ≤(m)
k
(tl) is the posterior mean at time tl and
q
c
var(ÀÜŒ≤(m)
k
(tl)) is its posterior
standard deviation. A simultaneous conÔ¨Ådence region is given by the hyperrectangular
[ÀÜŒ≤(m)
k
(tl) ‚àíc1‚àíŒ±
q
c
var(ÀÜŒ≤(m)
k
(tl)), ÀÜŒ≤(m)
k
(tl) + c1‚àíŒ±
q
c
var(ÀÜŒ≤(m)
k
(tl))], l = 1, . . . , L.
In our implementation, we replaced c1‚àíŒ± by cb which is calculated by cb = max(|cŒ±/2|, |c1‚àíŒ±/2|)
to account for skewness.
3.2.7
Bayesian Cluster Analysis
We propose a Bayesian clustering approach to identify the number of clusters and to
probabilistically assign each individual to the identiÔ¨Åed clusters. The nonparametric
LPP2(Œ±, Œ≥, P0) prior has the feature of randomly clustering subjects via global and
local clustering. Given a truncated h‚àó-dimensional random eÔ¨Äects vector Œ∏i for the i-th
subject, the LPP2 prior assigns those elements having zij = 1 for j = 1, . . . , h‚àótogether
to a global cluster, while assigning the remaining elements having zij = 0 to their own
clusters. If subjects i and i‚Ä≤ are in the same cluster for the j-th random eÔ¨Äect, such that
Œ∏ij = Œ∏i‚Ä≤j, the LPP2 prior will propagate such clustering information to other random
eÔ¨Äects, increasing the probability of Œ∏ij‚Ä≤ = Œ∏i‚Ä≤j‚Ä≤, j‚Ä≤ Ã∏= j.
60

The set of probability weights assignment for both global clustering and local clus-
tering are formulated by a sticking-breaking process:
œÜij =
‚àû
X
h=1
œÄhŒ¥h, œÄh = œÄ‚àó
h
Y
l<h
(1 ‚àíœÄ‚àó
l ), œÄ‚àó
h ‚àºBeta(1, Œ±), j = 0, 1, . . . , h‚àó,
where œÜij indexes the assigned cluster for Œ∏ij, with j = 0 for global clustering and
j = 1, . . . , h‚àófor each element‚Äôs own clustering, and œÄh is the weight for a set of the
elements (global clustering) or an element (local clustering) to be assigned to the h-th
cluster. Small Œ± favors the assigned clusters to be concentrated on the Ô¨Årst few ones
to achieve sparseness for posterior computation eÔ¨Éciency.
In practical posterior computation, we developed a posterior cluster analysis proce-
dure on the clustering of the subject speciÔ¨Åc latent random factors {Œ∏i : i = 1, . . . , n}.
We speciÔ¨Åed a LPP2 prior on the unknown distributions of the subject speciÔ¨Åc latent
factors Œ∏i. Denote ob
g,Œ∏ for the number of global clusters among {Œ∏i : i = 1, . . . , n}
at the b-th iteration in the Gibbs sampler, and similarly denote ob
l,Œ∏ for the number
of local clusters.
We obtained the posterior samples of {ob
g,Œ∏ : b = 1, . . . , B} and
{ob
l,Œ∏ : b = 1, . . . , B}. The overall weight allocated to the local cluster family equals a
priori to 1/(1 + Œ≥) according to the speciÔ¨Åcation of LPP2(Œ±, Œ≥, P0) in Dunson (2009).
Given the posterior sample average ÀÜŒ≥, the proportion of local clustering a posteriori for
Œ∏i is estimated by 1/(1 + ÀÜŒ≥).
3.3
Monte Carlo Simulations
We conducted a set of Monte Carlo simulations to evaluate the false discovery rate
(FDR) and the power of the local hypothesis testing approach. We simulated the two
diÔ¨Äusion measures FA and MD along the right internal capsule tract obtained in the
61

clinical study from the following model:
(FAi(dt), MDi(dt))T = (xT
i B(1)
i (dt), xT
i B(2)
i (dt))T + œµi(dt),
xT
i B(m)
i
(dt) = (Œ≤(m)
0i (dt), Œ≤(m)
1i (dt), Œ≤(m)
2i (dt))xi, m = 1, 2,
(3.9)
where dt ‚àà[0, L], xi = (1, Gi, Ai) with Gi and Ai referring to the gender and gestational
age of the i-th subject, B(m)
i
(dt) = (Œ≤(m)
0i (dt), Œ≤(m)
1i (dt), Œ≤(m)
2i (dt)) is a 3 √ó 1 coeÔ¨Écient
vector with its component Œ≤(m)
ki (dt), k = 0, 1, 2, to be drawn from a Gaussian process
GP(Œ≤(m)
k
(dt), œÉ2
0œÅdt‚àíd‚Ä≤
t), and the measurement error œµi(dt) is a 2 √ó 1 vector of Gaus-
sian random variables with mean zero and covariance matrix Œ£(dt).
To mimic the
realistic clinic imaging data, we obtain the estimates ÀÜŒ≤(m)
k
(dt) of Œ≤(m)
k
(dt) and ÀÜŒ£(dt) of
Œ£(dt) by analyzing the FA and MD measures along the right internal capsule using
the methodology proposed by Zhu et al. (2011).
We set œÉ2
0 = 0.004 and œÅ = 0.5.
Further, Ô¨Åxing (Œ≤(m)
0i (dt), Œ≤(m)
1i (dt)) for all m and dt at their obtained estimates from
the clinic data, we let (Œ≤(1)
2 (dt), Œ≤(2)
2 (dt)) = c(dt)(ÀÜŒ≤(1)
2 (dt), ÀÜŒ≤(2)
2 (dt)) and consider Ô¨Åve
scenarios for (Œ≤(1)
2 (dt), Œ≤(2)
2 (dt)): null case of c(dt) = 0 and local alternative cases for
c(dt) = 0.2, 0.4, 0.6, and 0.8.
We analyzed each simulated scenario using 100 repeated simulations. We set n =
32, 64. We randomly chose 16 males and 16 females for n = 32 (32 males and 32 females
for n = 64) from our clinical data and used their values of gender and gestational age to
simulate the values of FA and MD along the right internal capsule tract. We assigned
Ga(1, 1) hyper priors for the hyperparameters Œ± and Œ≥, and Ga(2, 1) priors on a1 and a2.
We speciÔ¨Åed ŒΩ = 3 and chose 5 log((K + 1)pM) as the starting number of factors. The
exact block Gibbs sampler ran 10,000 iterations, with the Ô¨Årst 5000 samples discarded
as burn-in. Every 5th sample was collected to thin the chain. For each case, our Gibbs
sampler converges rapidly and exhibits eÔ¨Écient mixing.
62

We conducted the local hypothesis testing of H(m)
0
(dt) :
Œ≤(m)
2
(dt)
 ‚â§œµ for a point dt
along the right internal capsule tract and the m-th diÔ¨Äusion property against H(m)
1
(dt) :
Œ≤(m)
2
(dt)
 > œµ.
We speciÔ¨Åed œµ = 0.1, 0.15, and 0.2.
We evaluated FDR for the
local hypothesis testing procedure at the null case c(dt) = 0 and the local alterna-
tive cases c(dt) = 0.2, 0.4, 0.6, and 0.8, and its powers at the local alternative case
c(dt) = 0.2, 0.4, 0.6, and 0.8. For each simulation, the signiÔ¨Åcant levels for the local
hypothesis testing procedure were set at Œ± = 0.01, and 100 replications were used to
estimate the FDR and powers. For a Ô¨Åxed Œ± at the alternative cases, if FDR is smaller
than Œ±, the testing procedure is conservative, whereas if it is observed to be greater
than Œ±, the testing procedure is liberal. At the null case, FDR equals to 1 based on its
deÔ¨Ånition. Table 4.1 displays that the FDR is accurate for the sample sizes of 32 and
64. Consistent with our expectations, the statistical power for rejecting the local null
hypotheses increases with the sample size and decreases with the zero neighborhood
size œµ.
3.4
Clinical DTI Fiber Tract Data
3.4.1
Background and Analysis
The DTI Ô¨Åber tract data comes from a clinical study approved by the Institute Review
Board of the University of North Carolina at Chapel Hill. This larger study was de-
signed to investigate early brain development. Healthy infants less than 1-year old were
recruited with written informed consents obtained from their patients before imaging
acquisition. In our study, a total of 128 healthy full-term infants (75 males and 53
females) are included, whose mean gestational age at MR scanning is 298¬±17.6 days
(range: 262 to 433 days). All infants were placed with eÔ¨Äorts such that they slept
comfortably inside the MR scanner and none of them was sedated during the imaging
63

procedure. They were fed and calmed to sleep on a warm blanket with suitable ear
protection.
The device used to acquire all images is a 3T Allegra head only MR system (Siemens
Medical Inc., Erlangen, Germany), featuring in 40 mT/m for the maximal gradient
strength and 400 mT/(m.msec) for the maximal slew rate. Every subject was scanned
for contiguous slices with slice thickness of 2mm to cover the whole brain. Each slice
was repeated 5 times such that an average was obtained to improve the signal-to-noise
ratio. These acquired DTI images are obtained via a single shot EPI DTI sequence
(TR/TE=5400/73 msec) with eddy current compensation. DiÔ¨Äusion gradients were
collected at six non-collinear directions:(1,0,1), (-1,0,1), (0,1,1), (0,1,-1), (1,1,0), and
(-1,1,0), at the b-value level of 1000 s/mm2. The reference scan at the b-value of 0 was
implemented to construct diÔ¨Äusion tensor matrices. The voxel resolution was set at
isotropic 2mm, and the in-place Ô¨Åeld of view was set at 256mm in both directions.
The diÔ¨Äusion tensors were constructed using a weighted least square estimation
method (Zhu et al., 2007; Basser et al., 1994b). We then processed all 128 DTI data
sets using the image processing steps in the DTI atlas building and compute diÔ¨Äusion
properties along all Ô¨Åber tracts of interest.
We focused on analyzing two tracts of
interest including the splenium of the corpus callosum tract and the right internal
capsule tract (Fig. 3.2(a) and Fig. 3.7(a)). We computed fractional anistropy (FA),
mean diÔ¨Äusivity (MD), and the three eigenvalues of the diÔ¨Äusion tensors, denoted by,
Œª1 ‚â•Œª2 ‚â•Œª3, at each grid point on both tracts for each of the 128 subjects. FA denotes
the inhomogeneous extent of local barriers to water diÔ¨Äusion, and MD measures the
averaged magnitude of local water diÔ¨Äusion. The three eigenvalues of diÔ¨Äusion tensor
reÔ¨Çect the magnitude of water diÔ¨Äusivity along and perpendicular to the long axis of
white matter Ô¨Åbers (Song et al., 2003).
64

We focused on addressing four goals in the analysis of the multiple diÔ¨Äusion prop-
erties along the right internal capsule tract and the splenium tract. Our Ô¨Årst goal was
to determine if there is a diÔ¨Äerence in the multiple diÔ¨Äusion properties along the Ô¨Åber
bundles between male and female infants. Our secondary goal was to investigate the
development of the diÔ¨Äusion properties along the Ô¨Åber bundles vs gestational age. Our
third goal was to accomplish a parsimonious representation of the multiple diÔ¨Äusion
trajectories across subjects. Our fourth goal was to examine the covariate-dependent
correlation pattern among the multiple diÔ¨Äusion properties along the Ô¨Åber bundles.
We applied SBLFM (3.9) to model the smoothed FA and MD functions (M=2) along
the right internal capsule and the splenium capsule with xi = (Gi, Ai)T, where Gi and
Ai refer to the gender (1 for female and 0 for male) and the gestational age of the ith
infant. We estimated the ith subject speciÔ¨Åc functional regression coeÔ¨Écients Œ≤m
i (dt) for
the mth functional diÔ¨Äusion measure. We then estimated the mean coeÔ¨Écient curve
Œ≤
(m)
k
(dt) a posteriori and constructed their 95% Bayesian conÔ¨Ådence bands from the
posterior MCMC samples. We also performed local hypothesis testing procedures to
determine if and where gender and gestational age are signiÔ¨Åcant in the development
of the diÔ¨Äusion trajectories along both of these two Ô¨Åber tracts. The posterior cluster
analysis is conducted to describe how many clusters exist among the 128 infants in
terms of the water diÔ¨Äusion properties FA and MD. The correlation analysis is then
implemented to illustrate the development of the correlation pattern between FA and
MD along both Ô¨Åber tracts for male infants of average gestational age of 298 days, as
well as the pattern between the gestational age eÔ¨Äects on FA and MD. Finally, based
on the signiÔ¨Åcant results for MD, we analyzed the three eigenvalues of diÔ¨Äusion tensors
with FA along the two Ô¨Åber tracts.
We assigned Ga(1, 1) hyper priors for the hyperparameters Œ± and Œ≥, a Ga(0.1, 0.1)
prior for the precision parameters œÉ‚àí2
f , and Ga(2, 1) priors on a1 and a2. We speciÔ¨Åed
65

ŒΩ = 3 and a default choice of 5 log((K + 1)pM) as the initialized number of factors.
We recommend these settings as default values in other analyses of DTI Ô¨Åber tract
data. We summarized the 1000 posterior samples from the MCMC output with thin-
ning of 5 iterations after the burn-in of 5000 iterations. Using multiple chains with
widely-distributed points, the proposed exact block Gibbs sampler exhibits good rates
of convergence and mixing. This formulation took 519 seconds per 100 iterations in
Matlab 2010b on a Lenovo X61 laptop. We repeated the analysis for a variety of hy-
perparameter values. We multiplied the mean and variance of Œ± and Œ≥ by 2 and 0.5,
and multiplied the variance of P0 by 2 and 0.5. We used ŒΩ = 3.5, 4, 5 and varied bœÉ
between 0.1 and 0.5. We also used diÔ¨Äerent starting number of factors between 3 and
10. The results are robust with no conclusions changed.
3.4.2
Results: Right Internal Capsule Tract
We initially focused on analyzing the smoothed FA and MD curves (Fig. 3.2(b) and
(c)) of the 128 infants, which were obtained from the adaptive local polynomial kernel
smoothing technique. Our primary interest lies in investigating if and where gender
and gestational age are signiÔ¨Åcant in the development of FA and MD along the right
internal capsule tract. We conducted Bayesian local hypothesis testing procedures at
each grid point along the tract to examine the eÔ¨Äects of gender and gestation age on FA
and MD values. Fig. 3.3(c) showed that the degrees of both fractional anisotropy and
mean diÔ¨Äusivity vary signiÔ¨Åcantly between males and females along partial regions of
the right internal capsule tract. The posterior mean eÔ¨Äect curves of gender on FA and
MD and their 95% conÔ¨Ådence bands (Fig. 3.3(a) and (b)) provided more evidence that
females have less fractional anisotropy than males in a major region of the right internal
capsule tract, and females have stronger mean diÔ¨Äusivity than males in half of the tract
with weaker diÔ¨Äerences in the other half. The diÔ¨Äerence in mean diÔ¨Äusivity between
66

males and females are also observed in the sample average MD values (Fig. 3.3(d)).
Such sophisticated diÔ¨Äerences between males and females were not discovered by the
previous FRADS and FADTTS methods. Similar to FRADS and FADTTS, Fig. 3.4(b)
found uniformly signiÔ¨Åcant eÔ¨Äects of gestational age on the FA and MD trajectories.
Additional supportive evidence were observed that FA increases with gestational age
(Fig. 3.4(a) and (c)), while MD decreases with gestational age (Fig. 3.4(d)).
We performed posterior cluster analysis to examine latent clusters in the FA and MD
trajectories along the right internal capsule tract across the 128 infants. The estimated
value of the hyperparameter Œ≥, controlling allocation weight on the local family, equals
0.51 with 95% credible interval of [0.12, 1.20]. This implies that the posterior proportion
of local clustering is 1/3, indicating that the data favors global clustering of the FA and
MD trajectories across infants. The estimated value of the hyperparameter Œ± = 5.34,
with 95% credible interval of [2.59, 9.65]. These values suggest that few clusters are
present in the data and a sparse representation of the data is obtained. This conclusion
is further supported by the estimated values of 4.45, 3.94, and 4.42 for the number of
overall clusters, global clusters, and local clusters respectively (Fig. 3.2(d)).
Along the right internal capsule tract, we further computed the posterior mean
curves of FA and MD (Fig. 3.5(a)) for males of average gestational age, and estimated
the posterior covariance matrix (Fig. 3.5(b) and (c)). Then we obtained correlation
coeÔ¨Écient between FA and MD at each grid point for males of average gestation age. We
observed negative correlations at around 60% of grid points and positive correlation at
the other around 40% of grid points (Fig. 3.5(d)). Moreover, we computed the posterior
covariance matrix for the gestational age eÔ¨Äects on FA and MD values (Fig. 3.5(f) and
(g)) and derived the grid pointwise correlation between the gestational age eÔ¨Äects on
FA and MD. Fig. 3.5(h) displayed negative correlations at most grid points.
67

In the analysis of the three eigenvalues with FA, we focused on the association be-
tween gender and gestation age with the three eigenvalues and the correlation among the
three eigenvalues along the right internal capsule tract. We examined the association
between both covariates of interest and all eigenvalues along the tract by performing
local hypothesis testing at each grid point. A similar locally signiÔ¨Åcant pattern of gen-
der eÔ¨Äect was found for all three eigenvalues (Fig. 3.6(b)). Gestational age eÔ¨Äect was
found uniformly signiÔ¨Åcant for Œª2 and Œª3, while locally head-and-tail signiÔ¨Åcant for Œª1
(Fig. 3.6(c)). We observed positive correlation between Œª2 and Œª3 for both males and
females of mean gestational age (Fig. 3.6(d) and (e)), and positive correlation between
the gestational age eÔ¨Äects on Œª2 and Œª3 (Fig. 3.6(f)). Overall, these correlations are
stronger than those between Œª1 and Œª3 or Œª1 and Œª2. This agrees with the small dif-
ferences between Œª2 and Œª3, while the relatively large diÔ¨Äerences between Œª1 and Œª3 or
Œª1 and Œª2 in the middle of the right internal capsule tract (Fig. 3.2(e), (f) and (g)).
Finally, we performed a cluster analysis among the three eigenvalues and obtained a
sparse representation of the three eigenvalue functions along the right internal capsule
tract (Fig. 3.2(h)).
3.4.3
Results: Splenium Tract
We applied SBLFM (3.9) to analyze the FA and MD trajectories along the splenium
tract from 128 infants. We started with the Bayesian local hypothesis testing procedure
to identify the region in which gender or gestational age is signiÔ¨Åcantly associated with
FA and MD. Fig. 3.8 (c) shows that gender is only slightly signiÔ¨Åcant in the head
region for MD development in the splenium tract. The posterior estimation for the
mean eÔ¨Äects of gender and the corresponding 95% conÔ¨Ådence bands agrees with the
testing results. Fig. 3.8(d)-(e) display the uniformly increasing eÔ¨Äects of gestational age
on FA development and decreasing eÔ¨Äects on MD development at a major region. The
68

local hypothesis testing results (Fig. 3.8(f)) support that gestational age is uniformly
signiÔ¨Åcant along the splenium tract for the developmental change of the degree of
fractional anisotropy, while locally signiÔ¨Åcant for that of the degree of mean diÔ¨Äusivity.
The posterior sampling distribution of the number of clusters among the 128 infants
is given in Fig. 3.7 (d). The posterior mean estimates of the number of overall clusters,
global clusters, and local clusters are 3.42, 3.07, and 3.40 respectively, indicating that
the 128 infants concentrate on a few clusters. The weight parameter Œ≥ for allocation
on the local family was estimated to be 0.38 with 95% credible interval of [0.08, 0.98].
The estimated posterior mean of the proportion of local clustering is 0.28, which means
a favoring of global clustering on infants. The estimated posterior mean of Œ± equals
to 6.46, with 95% credible interval of [2.94, 11.80]. This result agrees with the sparse
clusters identiÔ¨Åed in the data.
The posterior estimation of the mean curves of FA and MD for males of average
gestational age and the posterior estimates of their covariance matrices is given in Fig.
3.9 (a)-(c). Fig. 3.9 (d) displays that males of average gestational age have positive
correlations between FA and MD at a major region of the splenium tract. Furthermore,
Fig. 3.9 (e)-(g) displays the estimated gestational age functional eÔ¨Äect curves and their
corresponding covariance matrices. We observed that the gestational age eÔ¨Äects on FA
and MD are negatively correlated almost over the whole splenium tract (Fig. 3.9 (h)),
which is consistent with the opposite trend of gestational age on FA and MD (Fig. 3.9
(e)).
We additionally found that both gender and gestational age are locally signiÔ¨Åcantly
associated with the developmental pattern of the three eigenvalues along the splenium
tract (Fig. 3.10 (b) and (c)). We further observed large correlation between Œª2 and Œª3
and relatively weak correlation between Œª1 and Œª2 or Œª1 and Œª3 for both male and female
of average gestational age. This agrees with the small diÔ¨Äerence between Œª2 and Œª3
69

while relatively large diÔ¨Äerence between Œª1 and Œª3 in the Ô¨Årst half of the splenium tract
(Fig. 3.7(e), (f) and (g)). We didn‚Äôt observe noticeable diÔ¨Äerence among the pairwise
correlations of the gestational age eÔ¨Äects on the three eigenvalues (Fig. 3.10(h)).
3.5
Discussion
The contributions of our work are twofold. From the statistical perspective, we have
developed a new Bayesian functional analysis pipeline SBLFM for delineating the struc-
ture of the variability of multiple diÔ¨Äusion properties along major white matter Ô¨Åber
bundles and their association with a set of covariates of interest. The SBLFM pipeline
integrates Ô¨Åve advanced Bayesian statistical tools from the statistical literature. Com-
pared with the existing literation (Zhu et al., 2010, 2011), our SBLFM explicitly model
the subject-speciÔ¨Åc functional covariate eÔ¨Äects on the multiple diÔ¨Äusion outcome func-
tions and the covariate-speciÔ¨Åc correlation structure among the multiple diÔ¨Äusion mea-
sures. From the application perspective, we have demonstrated SBLFM in a clinical
study of neurodevelopment.
Our results have revealed the complex inhomogeneous
spatiotemporal maturation patterns of Ô¨Åber bundle diÔ¨Äusion properties.
Several limitations need to be addressed in future research. First, since the existing
Ô¨Åber tract based methods including SBLFM requires DTI Ô¨Åber correspondence across
subjects, SBLFM cannot be used to investigate some scenarios in practice. For in-
stance, it is possible that the centroid of the localization of white matter lesion may
vary across time and subjects. In this case, one cannot use both ROI-based methods
and tract based methods. Secondly, although we have used the B-spline basis functions
in SBLFM, it is interesting to consider other basis functions, such as wavelet. Thirdly,
SBLFM is limited to diÔ¨Äusion properties along Ô¨Åber bundle, but it is interesting to
consider full DTs and other representations based on high angular resolution diÔ¨Äusion
image (HARDI) (Lenglet et al., 2009; Tuch et al., 2002; Schwartzman, 2006; Lepore
70

et al., 2008; Schwartzman et al., 2005; Zhu et al., 2009; Whitcher et al., 2007). Fourthly,
SBLFM can be readily extended to more complex brain structures, such as the medial
manifolds of Ô¨Åber tracts (Yushkevich et al., 2008), functional neuroimaging data (Bow-
man et al., 2008; Woolrich et al., 2004; Lei et al., 2009; G¬®ossl et al., 2001), and group
analysis of neuroimaging data (Rosa et al., 2010; Penny et al., 2007).
3.6
Appendix: Posterior Computation
We develop an eÔ¨Écient Markov chain Monte Carlo (MCMC) algorithm for posterior
computation. After truncating the loadings matrix A to h‚àó‚â™(K + 1)pM columns,
we adapt an eÔ¨Écient exact block Gibbs sampler (Papaspiliopoulos, 2008) for Dirichlet
mixture models. This exact block Gibbs sampler combines the advantages of the retro-
spective MCMC method (Papaspiliopoulos and Roberts, 2008) and the slice sampling
method (Walker, 2007). It introduces auxiliary variables to avoid truncated approxima-
tions. This algorithm is straightforward to implement and exhibits good performance
in convergence and mixing. We will describe the adaptation strategy on the truncated
level h‚àóafter introducing the Gibbs sampler.
Allowing data to inform information about the hyperparameters involved in the
model through (3.1)‚àí(3.7), we specify Œ± ‚àºGa(aŒ±, bŒ±) and Œ≥ ‚àºGa(aŒ≥, bŒ≥). Introducing
auxiliary variables u = {uih : i = 1, . . . , n;
h = 0, 1, . . . , h‚àó} to avoid truncated
approximations, the complete data joint likelihood of y, u and z is:
n
Y
i=1
g(Yi; A, Œ∏œài, Œ£)1(ui0 < œÄœài0)
h‚àó
Y
h=1
1(uih < œÄœàih)ŒΩzih
h (1 ‚àíŒΩh)1‚àízih,
where Yi is a PM
m=1 nmi √ó 1 outcome vector for the M measures of the i-th subject, g(¬∑)
is the density function of the outcome vector Yi, i = 1, . . . , n, and the elements in u are
constrained to the interval (0, 1).
71

Starting from the initiation step, the Gibbs sampler at the truncated level h‚àópro-
ceeds as follows:
1. Update the hth column of the factor loadings matrix Ah‚àó, denoted by Ah, from
its conditional distribution
p(Ah|‚àí) ‚àºN((CT
h Œ£‚àí1
N Ch + Œ£‚àí1
Ah)‚àí1CT
h Œ£‚àí1
N Yh, (CT
h Œ£‚àí1
N Ch + Œ£‚àí1
Ah)‚àí1),
where Yh = (Y T
1h, . . . , Y T
nh)T with Yih = Yi‚àíP
jÃ∏=h IM‚äóBiAjŒ∏œàij, Ch =
Ô£´
Ô£¨
Ô£¨
Ô£¨
Ô£¨
Ô£≠
Œ∏œà1h(IM ‚äóB1)
...
Œ∏œành(IM ‚äóBn)
Ô£∂
Ô£∑
Ô£∑
Ô£∑
Ô£∑
Ô£∏
,
Œ£N = In ‚äóŒ£, Œ£Ah = diag(œÜ‚àí1
1,hœÑ ‚àí1
h , . . . , œÜ‚àí1
(K+1)pM,hœÑ ‚àí1
h ), for h = 1, . . . , h‚àó.
2. Update œÜgh from its conditional distribution
p(œÜgh|‚àí) ‚àºGa(v + 1
2
, v + A2
ghœÑh
2
).
3. Update Œ¥1 from its conditional distribution
p(Œ¥1|‚àí) ‚àºGa(a1 + 1
2(K + 1)pMh‚àó, 1 + 1
2
h‚àó
X
h=1
œÑ (1)
h
(K+1)pM
X
g=1
œÜghA2
gh),
and update Œ¥l, l ‚â•2 from its conditional distribution
p(Œ¥l|‚àí) ‚àºGa(a2 + 1
2(K + 1)pM(h‚àó‚àíl + 1), 1 + 1
2
h‚àó
X
h=l
œÑ (l)
h
(K+1)pM
X
g=1
œÜghA2
gh),
where œÑ (l)
h = Qh
t=1,hÃ∏=l Œ¥t, l = 1, . . . , h‚àó.
72

4. Update œÉ‚àí2
f , f = 1, . . . , MT, from its conditional distribution
p(œÉ‚àí2
f |‚àí) ‚àºGa(aœÉ + n
2, bœÉ + 1
2
n
X
i=1
(yif ‚àí(IM ‚äóBi)fAŒ∏œài)2),
where (IM ‚äóBi)f denotes the fth row of (IM ‚äóBi).
5. Update uih from its conditional distribution
p(uih|‚àí) ‚àºUnif(0, œÄœàih).
6. Update the latent zih from its conditional distribution
p(zih|‚àí) ‚àºBer(
ŒΩhN(yi; A, Œ∏i(zih=1), Œ£)
ŒΩhN(yi; A, Œ∏i(zih=1), Œ£) + (1 ‚àíŒΩh)N(yi; A, Œ∏i(zih=0), Œ£)),
where Œ∏i(zih=j) refers to the current value of Œ∏i with inserting Œ∏0œÜi0h to the hth
component for j = 1, and Œ∏1œÜihh for j = 0.
7. Update the stick-breaking weights œÄ‚àó
q from its conditional distribution
p(œÄ‚àó
q|‚àí) ‚àºBeta(
h‚àó
X
h=0
n
X
i=1
1(œàih = q) + 1,
h‚àó
X
h=0
n
X
i=1
1(œàih > q) + Œ±),
for q ‚â§œà‚àówith œà‚àó= max{œàih : i = 1, . . . , n, h = 0, 1, . . . , h‚àó}, for q > œà‚àó, sample
œÄ‚àó
q from p(œÄ‚àó
q|‚àí) ‚àºBeta(1, Œ±).
8. Update the allocation index œàih from its conditional distribution
P(œàih = q|‚àí) ‚àù1(q ‚ààCœÄ(uih))N(yi; A, Œ∏œàih=q, Œ£),
where CœÄ(uih) = {q : œÄq > uih} ‚äÇ{1, 2, . . . , ‚àû}, and œÄ‚àó
q is sampled for q =
73

1, . . . , Àúœà such that
Àúœà
X
q=1
œÄ‚àó
q
Y
l‚â§q
(1 ‚àíœÄ‚àó
l ) ‚â•1 ‚àíu‚àó,
where u‚àó= min{uih : i = 1, . . . , n, h = 0, 1, . . . , h‚àó}.
9. Update Œ∏jq from its conditional distribution
p(Œ∏jq|‚àí) ‚àºNh‚àó([diag(1h‚àóŒ∂jq)+W ‚Ä≤
jqŒ£‚àí1
N Wjq]‚àí1W ‚Ä≤
jqŒ£‚àí1
N Yjq, [diag(1h‚àóŒ∂jq)+W ‚Ä≤
jqŒ£‚àí1
N Wjq]‚àí1),
in which Yjq refers to the contribution for Œ∏jq from subjects with zih = 1 ‚àíj and
œÜih = q. In addition, Wjq = diag(w1, . . . , wn)ZŒ¶R, and Yjq = diag(y1, . . . , yn)ZY Œ¶Y 1n,
where
‚Ä¢ wi = IM ‚äóBiA,
‚Ä¢ Z = Blkdiag(Z1, . . . , Zn) with Zi = diag(1(zi1 = 1 ‚àíj), . . . , 1(zih‚àó= 1 ‚àíj)),
‚Ä¢ Œ¶ = Blkdiag(Œ¶1, . . . , Œ¶n) with Œ¶i = diag(1(œài1 = q), . . . , 1(œàih‚àó= q)),
‚Ä¢ R = 1n ‚äóIh‚àó,
‚Ä¢ ZY = Blkdiag(ZY1, . . . , ZYn) with ZYi = 1(Ph‚àó
h=1 1(zih = 1 ‚àíj) ‚â•1),
‚Ä¢ Œ¶Y = Blkdiag(Œ¶Y1, . . . , Œ¶Yn) with Œ¶Yi = 1(Ph‚àó
h=1 1(œàih = q) ‚â•1),
‚Ä¢ and 1n is a n √ó 1 vector of entries of 1.
10. Update Œ∂jq from its conditional distribution Ga(0.5 + h‚àó/2, 0.5 + Œ∏‚Ä≤
jqŒ∏jq/2).
11. Update the hyperparameter Œ≥ from its conditional distribution Ga(aŒ≥ + h‚àó, bŒ≥ ‚àí
Ph‚àó
h=1 log(1 ‚àíŒΩh)).
12. Update the hyperparameter Œ± from its conditional distribution Ga(aŒ± + œà‚àó, bŒ± ‚àí
Pœà‚àó
q=1 log(1 ‚àíœÄ‚àó
q)).
74

To choose the eÔ¨Äective number of factors, we use an adaptation approach (Bhat-
tacharya and Dunson, 2011) to update the truncated number of factors h‚àóacross
iterations.
Starting with a conservative guess Àúh‚àóof h‚àó, we adapt with probability
p(t) = exp(Œ±0 + Œ±1t) at the tth iteration. We specify Œ±0 and Œ±1 such that the chain
comes with adaptation around every 10 iterations at the beginning and exponentially
fast decreasing in adaptation frequency. In detail, at the tth iteration, we monitor
the columns in the factor loadings by comparing ut with p(t), where ut is a sequence
randomly generated from Unif(0, 1). If ut ‚â§p(t), we remove the columns having all
elements within some pre-speciÔ¨Åed small zero neighborhood, called redundant columns,
and retain non-redundant columns for other parameters. If no such redundant column
is detected, we add a new column to the loadings, and sample other parameters from
their prior distributions to Ô¨Åll in the additional columns.
75

Table 3.1: Simulation study: FDR and power of the local hypothesis tests for the
eÔ¨Äects of gestational age on FA and MD along the right internal capsule tract,
evaluated at Ô¨Åve diÔ¨Äerent values of c and three diÔ¨Äerent values of œµ for sample sizes
of 32 and 64 subjects.
œµ = 0.1
œµ = 0.15
œµ = 0.2
n
c
FDR
Power
FDR
Power
FDR
Power
32
0
1.00
-
1.00
-
1.00
-
0.2
0.01
0.52
0.01
0.45
0.01
0.40
0.4
0.01
0.88
0.01
0.84
0.01
0.80
0.6
0.01
0.98
0.01
0.96
0.01
0.95
0.8
0.01
0.99
0.01
0.99
0.01
0.99
64
0
1.00
-
1.00
-
1.00
-
0.2
0.01
0.74
0.01
0.68
0.01
0.64
0.4
0.01
0.98
0.01
0.96
0.01
0.95
0.6
0.01
0.99
0.01
0.99
0.01
0.99
0.8
0.01
1.00
0.01
1.00
0.01
1.00
76

Fig. 3.1: A schematic overview of SBLFM: a multivariate semiparametric varying-
coeÔ¨Écient model for multiple diÔ¨Äusion properties, a MCMC posterior estimation
method for estimating the coeÔ¨Écient functions, a construction of Bayesian conÔ¨Ådence
bands of the mean covariate eÔ¨Äect curves, a Bayesian local hypothesis testing procedure,
and a posterior cluster analysis procedure.
77

Fig. 3.2: Right internal capsule tract description: (a) the right internal capsule tract
extracted from the tensor atlas with color presenting mean FA value; diÔ¨Äusion proper-
ties of FA in panel (b), MD in panel (c), Œª1 in panel (e), Œª2 in panel (f), Œª3 in panel
(g); the number of clusters posteriori in FA and MD trajectories in panel (d) and the
number of clusters posteriori in Œª1, Œª2 and Œª3 trajectories in panel (h).
78

Fig. 3.3: Results of the gender eÔ¨Äects on FA and MD along the right internal capsule
tract: the estimated coeÔ¨Écient curves (‚Äì) and the corresponding 95% conÔ¨Ådence bands
(- -) for FA in panel (a) and MD in panel (b); (c) the posterior probability curves in
favor of the grid point-wise alternative hypotheses; (d) the estimated mean FA and
MD.
79

Fig. 3.4: Results of the gestational age eÔ¨Äects on FA and MD along the right internal
capsule tract: (a) 3D surf plot of FA along the right internal capsule tract for visualizing
the gestational age eÔ¨Äects ; (b) the posterior probability curves in favor of the grid point-
wise alternative hypotheses; the estimated coeÔ¨Écient curves (‚Äì) and the corresponding
95% conÔ¨Ådence bands (- -) for FA in panel (c) and MD in panel (d).
80

Fig. 3.5: Results from the analysis of FA and MD along the right internal capsule tract:
(a) the posterior estimated curves of FA and MD for males of average gestational age;
the estimated covariance matrices for FA in panel (b) and MD in panel (c) for males
of average gestational age; (d) the estimated correlations between FA and MD for
males of average gestational age; (e) the posterior estimated gestational age eÔ¨Äects; the
estimated covariance matrices for the gestational age eÔ¨Äects on FA in panel (f) and MD
in panel (g); (h) the estimated correlations between the gestational age eÔ¨Äects on FA
and MD.
81

Fig. 3.6: Results from the analysis of the three eigenvalues of diÔ¨Äusion tensor on the
right internal capsule tract: (a) the estimated mean functions for Œª1 (blue), Œª2 (red) and
Œª3 (green); the posterior probability curves in favor of the grid point-wise alternative
hypotheses for the gender eÔ¨Äects in panel (b) and the gestational age eÔ¨Äects in panel
(c); the estimated correlations among Œª1, Œª2 and Œª3 for males of mean gestational age in
panel (d) and females of mean gestational age in panel (e), and among the gestational
age eÔ¨Äects on Œª1, Œª2 and Œª3 in panel (f).
82

Fig. 3.7: Splenium tract description: (a) the splenium capsule tract extracted from the
tensor atlas with color presenting mean FA value; diÔ¨Äusion properties of FA in panel
(b), MD in panel (c), Œª1 in panel (e), Œª2 in panel (f), Œª3 in panel (g); the number of
clusters posteriori in FA and MD trajectories in panel (d) and the number of clusters
posteriori in Œª1, Œª2 and Œª3 trajectories in panel (h).
83

Fig. 3.8: Results from the analysis of FA and MD along the splenium tract: the esti-
mated coeÔ¨Écient curves (‚Äì) and the corresponding 95% conÔ¨Ådence bands (- -) for the
gender eÔ¨Äects (panel (a) for FA and panel (b) for MD) and the gestational age eÔ¨Äects
(panel (d) for FA and panel (e) for MD); the posterior probability curves in favor of
the grid point-wise alternative hypotheses for the gender eÔ¨Äects (panel (c)) and the
gestational age eÔ¨Äects (panel (f)).
84

Fig. 3.9: Results from the analysis of FA and MD along the splenium tract: (a) the
posterior estimated curves of FA and MD for males of average gestational age; the
estimated covariance matrices for FA in panel (b) and MD in panel (c) for males
of average gestational age; (d) the estimated correlations between FA and MD for
males of average gestational age; (e) the posterior estimated gestational age eÔ¨Äects; the
estimated covariance matrices for the gestational age eÔ¨Äects on FA in panel (f) and MD
in panel (g); (h) the estimated correlations between the gestational age eÔ¨Äects on FA
and MD.
85

Fig. 3.10: Results from the analysis of the three eigenvalues of diÔ¨Äusion tensor on the
splenium tract: (a) the estimated mean functions for Œª1 (blue), Œª2 (red) and Œª3 (green);
the posterior probability curves in favor of the grid point-wise alternative hypotheses
for the gender eÔ¨Äects in panel (b) and the gestational age eÔ¨Äects in panel (c); the
estimated correlations among Œª1, Œª2 and Œª3 for males of mean gestational age in panel
(d) and females of mean gestational age in panel (e), and among the gestational age
eÔ¨Äects on Œª1, Œª2 and Œª3 in panel (f).
86

Chapter 4
Bayesian Sticky HDP InÔ¨Ånite
Hidden Markov Circumplex Model
4.1
Introduction
The circumplex model is useful in the study of aÔ¨Äects, which refer to the experience of
feeling or emotion (Huitt, 2003). AÔ¨Äective states are depicted by a circular structure
based on the dimensions of valence and arousal (Russell and Carroll, 1999), as shown
in Fig (4.1), where valence refers to the intrinsic attractiveness (positive valence) or
aversiveness (negative valence) (Frijda, 1986), and arousal refers to being awake or
reactive to stimuli (Csikszentmihalyi, 1998; Mirr, 2001). Each emotion arises as a linear
combination of these two dimensions, or as varying degrees of both valence and arousal.
For example, Joy is conceptualized as an aÔ¨Äect produced by strong activation in the
neural systems associated with positive valence or pleasure and moderate activation in
the neural systems associated with arousal. Similarly, other aÔ¨Äects are the products of
the activities of these two neurophysiological systems in which the degrees of activation
diÔ¨Äer.
Hence, speciÔ¨Åc emotions arise from cognitive interpretations and labeling of
these activation patterns of these two neurophysiological systems.

Within this circumplex model, aÔ¨Äects having the same valence tend to have substan-
tial positive correlation, while aÔ¨Äects of the opposite valence tend to have weak negative
correlation. This phenomenon is referred to as ‚Äútwo fundamental psychometric prin-
ciples‚Äù in Watson and Clark (1997). These two principles underlie their conceptual
theory of the independence between ‚ÄúPositive AÔ¨Äect‚Äù and ‚ÄúNegative AÔ¨Äect‚Äù (Watson
and Tellegen, 1985) and have been tested in the scales of Positive and Negative AÔ¨Äect
Schedule (PANAS) for the assessment of aÔ¨Äects (Watson et al., 1988). The correlation
between two aÔ¨Äects is modeled as a function of the angle between them in the circular
ordering.
Circumplex model has been studied in the literature to model the correlation struc-
ture among aÔ¨Äects. Correlations between adjacent scales with the circular ordering
are the highest. As circular separation increases, correlations decrease. Hence, the
corresponding correlation matrix has a circumplex structure, such that correlations
decrease Ô¨Årst and then increase when one moves away from the main diagonal. Un-
der the constraint of the circumplex structure, Guttman (1954) and Anderson (1960)
proposed stochastic processes on the circumference of the circle which produce positive
correlations with moving average and Markov properties respectively. Methods allowing
negative correlations are developed in Cudeck (1986) and Wiggins et al. (1981). Browne
(1992) extended the model of Anderson (1960) to allow for negative correlations. Lenk
et al. (2006) extended the work of Browne (1992) from Bayesian perspective and accom-
modated subject-speciÔ¨Åc random eÔ¨Äects to account for personal response scale usage
and subject-speciÔ¨Åc factors.
Circumplex model is a type of multidimensional scaling (MDS) methods, which is
a family of models that map a group of objects into a low dimensional space where
points representing the objects and the distances between the points corresponding to
the similarity/dissimlarity measure among the objects. It aims to seek a conÔ¨Åguration
88

of points such that the distances ‚Äúmatch‚Äù the similarities as well as possible. MDS
methods have been applied into a wide variety of disciplines, including behavior science,
social science, political science, marketing research, biomedical science, and so on. It
sprung from psychometric analysis to evaluate the similarity of people‚Äôs judgements over
a set of objects with the Ô¨Årst appearance (Torgerson, 1952). During the recent decade of
the bursting of high-dimensional large data sets, MDS was applied to gene analysis like
revealing the relational pattern of gene-expressions (Taguchi and Oono, 2005). In the
frontier of the biotechnological Ô¨Åeld, MDS was applied for protein structure prediction
(Mooney et al., 2006) and the quality assessment of mass spectrometry data (Harezlak
et al., 2007).
This chapter is motivated by a data set from a clinical study which is designed to
understand the mechanism of emotion regulation based on empirical measurements.
Participants were measured on a 17-scale PANAS measures in a daily diary study
for a total of 7 days. Each subject reports their aÔ¨Äect scales 5 times each day, with
4 times at day and 1 time at night.
The resultant data structure corresponds to
the traditional cross-sectional circumplex data while measured repeatedly over time.
Hence, we call such kind of data as longitudinal circumplex data. A major interest
to analyze this data set is to discover the latent emotion states hidden in the emotion
items of the PANAS ratings.
An appropriate circumplex model for the analysis of
such longitudinal circumplex data has not been developed in the literature. We are
motivated to bridge the gap between the statistical methods of emotion regulation and
the existing longitudinal circumplex data.
The analysis of the longitudinal circumplex data should consider the temporal struc-
ture of emotions. In the past few decades, researchers tended to conceptualize emotion
as a process. Emotion is regarded as versatile, ‚Äùdynamic‚Äù, and often shows persistent
patterns of self-regularity (Carver and Scheier, 1982; Chow et al., 2004; Larsen, 2000).
89

In this chapter, we target to extend the work of Lenk et al. (2006) to a semiparamet-
ric Bayesian state-space circumplex model for the analysis of longitudinal circumplex
data. Assuming an inÔ¨Ånite many collection of emotion states hidden in the population,
a hierarchical Dirichlet proces (Teh et al., 2006) is used to facilitate the discovery of
the time related state-switching structure. In addition, a sticky component (Fox et al.,
2008) is added to address the phenomenon of emotion persistence.
Section 4.2 introduces the model and associated inferences motivated by the above
considerations. Section 4.3 introduces an MCMC algorithm for posterior computation.
Section 4.4 is for an illustrative simulation. Section 4.5 applies the model to an emotion
data set. Section 4.6 makes some further discussion.
4.2
Bayesian Sticky HDP-iHMM Circumplex Model
4.2.1
Circumplex Model
Circumplex model is a useful tool to quantify the correlation structure among aÔ¨Äective
states where the underlying structure of aÔ¨Äective states can be characterized on the
circumference of a circle. Consider a latent response score Yi,j of the ith subject to the
jth item representing an aÔ¨Äective state, i = 1, . . . , n, j = 1, . . . , J. Lenk et al. (2006)
proposed a random eÔ¨Äects circumplex model for the latent response variable Yi,j:
Yi,j = Uj + Hi + Ai sin Œ∏j + Bi cos Œ∏j + œµi,j, Œ∏1 = 0, Œ∏j ‚àà[0, 2œÄ],
(4.1)
where Uj is a scalar for the mean latent response for the jth item, Hi is a scalar for the
ith subject speciÔ¨Åc random eÔ¨Äect to capture scale-usage eÔ¨Äects, Ai and Bi are scalars
specifying the random factor scores for the ith subject, and sin Œ∏j and cos Œ∏j are the
jth item speciÔ¨Åc loadings, which are constrained to the unit circle. The error term œµi,j,
i = 1, . . . , n, j = 1, . . . , J are independently and normally distributed with mean 0 and
90

variance œÉ2
j speciÔ¨Åc to the jth item.
The subject by item interaction term Ai sin Œ∏j+Bi cos Œ∏j characterizes the circumplex
correlation. Specifying Hi ‚àºN(0, Œª2), Ai ‚àºN(0, œÑa), Bi ‚àºN(0, œÑb), and letting œÑa =
œÑb = œÑ makes the inter-item correlations to have a circumplex structure, after adjusting
for the scale-usage eÔ¨Äects.
Conditional on the angles, the variance of Yi,j and the
covariance between Yi,j and Yi,k are given by
Var(Yi,j|Œ∏j)
=
Œª2 + œÑ 2 + œÉ2
Cov(Yi,j, Yi,k|Œ∏j, Œ∏k)
=
Œª2 + œÑ 2 cos(Œ∏j ‚àíŒ∏k).
4.2.2
Sticky HDP-iHMM State-space Circumplex Model
Considering our motivated data, suppose i = 1, . . . , n subjects respond to j = 1, . . . , J
items on a rating scale with G ordinal categories over t = 1, . . . , T time points. Let
Wi,j,t denote the rating of the ith subject toward the jth item at time t. We introduce
a set of the ith subject speciÔ¨Åc ordered latent cut points {ci,g}: ci,0 = ‚àí‚àû, ci,1 =
‚àí1 < ci,2 < . . . < ci,G‚àí2 < ci,G‚àí1 = 1, ci,G = ‚àû. We assume that the observed ordinal
response Wi,j,t is associated with a latent response variable Yi,j,t falling between two
latent cutpoints:
Wi,j,t = g,
iÔ¨Ä
ci,g‚àí1 ‚â§Yi,j,t < ci,g,
for
g = 1, . . . , G.
We extend model (4.1) to accommodate the dynamics of the latent response over time
by modeling the latent responses Yi,j,t:
Yi,j,t = Uj + Hi,t + Ai,t sin Œ∏j + Bi,t cos Œ∏j + œµi,j,t, Œ∏1 = 0, Œ∏j ‚àà[0, 2œÄ].
(4.2)
91

where Uj is the mean latent response of the jth item, Hi,t, Ai,t and Bi,t are the ith
subject speciÔ¨Åc latent random eÔ¨Äects vector at time t, and sin Œ∏j and cos Œ∏j are the jth
item speciÔ¨Åc loadings. The error terms œµi,j,t are assumed to be independently drawn
from N(0, œÉ2
j).
We introduce the sticky inÔ¨Ånite state hidden Markov model via hierarchical Dirichlet
proces (HDP-iHMM) (Fox et al., 2008) for the subject speciÔ¨Åc latent random factor
scores œÜi,t = (Hi,t, Ai,t, Bi,t)T:
œÜi,t|si,t, {œÜ‚àó
k}‚àû
k=1 = œÜ‚àó
si,t
{œÜ‚àó
k}‚àû
k=1|P0 ‚àºP0, P0 : œÜ‚àó
k ‚àºN(0, diag(Œª2, œÑ 212))
si,t|si,t‚àí1, {œâe}‚àû
e=1 ‚àºMult(œâsi,t‚àí1)
{œâe}‚àû
e=1|Œ±, Œ∫, Œ≤ ‚àºDP(Œ± + Œ∫, Œ±Œ≤ + Œ∫Œ¥e
Œ± + Œ∫
)
Œ≤|Œ≥ ‚àºStick(Œ≥),
(4.3)
where si,t denotes the state of the ith subject at time t, the inÔ¨Ånite collection of state
speciÔ¨Åc parameters {œÜ‚àó
k}‚àû
k=1 are drawn from a 3-dimensional normal base measure P0,
œâe corresponds to the state e speciÔ¨Åc transition distribution, Œ∫ > 0 is the self-transition
parameter for the current state e, Œ≤ is the average transition distribution. The average
transition distribution Œ≤ is formulated by a stick-breaking process of parameter Œ≥.
The state speciÔ¨Åc transition distribution œâe is generated from the Dirichlet process
with central transition distribution Œ≤ as the base measure and a precision parameter
Œ± controlling the degree of deviation. The current state si,t depends on the previous
state si,t‚àí1 via the multinomial distribution of transition parameters œâsi,t‚àí1.
The Bayesian speciÔ¨Åcation is completed by assigning priors on other parameters in
the model (4.2). We place the multivariate normal prior on the item mean responses
vector U = (U1, . . . , UJ)T, the conditionally uniform prior on the latent cutpoints ci,
92

the gamma priors on œÉ‚àí2
j , Œª‚àí2, and œÑ ‚àí2, and the extended Von Mises priors on the
angles Œ∏j:
U
‚àº
N(¬µ0, Œ£0),
ci
‚àº
X(‚àí1 < ci,2 < . . . < ci,G‚àí2 < 1),
ci,g|ci,g‚àí1, ci,g+1
‚àº
Unif(ci,g‚àí1, ci,g+1), g = 2, . . . , G ‚àí2,
œÉ‚àí2
j
‚àº
Ga(r0, s0), Œª‚àí2 ‚àºGa(u0,1, v0,1), œÑ ‚àí2 ‚àºGa(u0,2, v0,2),
Œ∏j
‚àº
Ô£±
Ô£¥
Ô£≤
Ô£¥
Ô£≥
VM(d0, Q0, [0, œÄ]),
for j = 2,
VM(d0, Q0, [0, 2œÄ]),
for j > 2.
(4.4)
where d0 = (0, 1)T, Q0 = 0.2I2. This Von Mises distribution is fairly Ô¨Çat on [0, 2œÄ].
The probability density function of the extended Von Mises distribution VM(d, Q, C)
is given by p(Œ∏|d, Q, C) ‚àùexp{‚àí0.5(Œæ(Œ∏) ‚àíd))TQ(Œæ(Œ∏) ‚àíd)}X(Œ∏ ‚ààC), where Œæ(Œ∏) =
(sin(Œ∏), cos(Œ∏))T, d is a two-dimensional vector, Q is a 2√ó2 matrix, X(¬∑) is the indicator
function, and C is a subset of [0, 2œÄ].
4.2.3
Background: Dirichlet Processes
Dirichlet Process
A Dirichlet process (DP) (Ferguson, 1973, 1974) deÔ¨Ånes a distribution for a random
density function G(œÜ) on a parameter space Œ¶, denoted by G(œÜ) ‚àºDP(Œ≥, P0). The
stick-breaking representation (Sethuraman, 1994) expresses G(œÜ) as
G(œÜ)
=
‚àû
X
k=1
Œ≤kŒ¥œÜ‚àó
k(¬∑), œÜ‚àó
k
i.i.d
‚àºP0
Œ≤k
=
Œ≤‚àó
k
Y
l<k
(1 ‚àíŒ≤‚àó
l ), Œ≤‚àó
k
i.i.d
‚àºBeta(1, Œ≥), k = 1, . . . , ‚àû,
(4.5)
93

where Œ≤k is a probability weight formulated from a stick-breaking procedure, Œ¥œÜ‚àó(¬∑)
denotes a point mass at œÜ‚àówhich is sampled from P0, P0 is a central probability
measure as a prior guess, and Œ≥ is a precision parameter expressing conÔ¨Ådence in the
prior guess. Under this formulation, the probability of œÜ allocated to Œ¥œÜ‚àó
k(¬∑) is equivalent
to Œ≤k. We denote the distribution on the set of weights Œ≤ = {Œ≤k}‚àû
k=1 by Œ≤ ‚àºStick(Œ≥).
The discreteness of G implied from the deÔ¨Ånition of the DP process generates a
clustering structure in the samples drawn from G.
Suppose œÜi ‚àºG, i = 1, . . . , n.
Integrating over G, the predictive distribution of œÜn+1 is obtained from the P¬¥olya urn
representation (Blackwel and Macqueen, 1973)
œÜn+1|œÜn, Œ≥, P0 ‚àº
K
X
k=1
nk
Œ≥ + nŒ¥œÜ‚àó
k +
Œ≥
Œ≥ + nP0,
(4.6)
where {œÜ‚àó
k}K
k=1 denote the distinct values (clusters) taken by the set {œÜi}n
i=1, nk is the
number of œÜi‚Äôs taking the value of œÜ‚àó
k, and the hyperparameter Œ≥ determines the weight
for a new cluster to be created.
The above P¬¥olya urn sampling scheme is closely related to the Chinese restaurant
process. Let œÜi as a customer entering a restaurant with inÔ¨Ånitely many tables, and
each table serving a unique dish œÜ‚àó
k. Every arriving customer chooses a already occupied
table with a probability in proportion to the number of customers currenly sitting at
this table, and a new table with a probability in proportion to Œ≥. It is implied that
small Œ≥ favors fewer tables to be selected.
The DP is commonly used as a nonparametric prior for the distribution of the
parameters in a mixture model of unknown complexity. Assume we have an observation
yi ‚àºF(œÜi) with œÜi ‚àºG(œÜ). The above sample scheme generates an indication variable
zi to denote the mixture component for the observation yi ‚àºF(œÜ‚àó
zi). Unlike standard
mixture models having Ô¨Åxed number of mixture components, the DP prior allows an
94

inÔ¨Ånite number of mixture components and lets the data inform the actual number of
components.
Hierarchical Dirichlet Process
Teh et al. (2006) extends the DP to the hierarchical Dirichlet Process (HDP) for cases
where groups of mixture model generative data are related but with an unknown shar-
ing structure. Assume J groups of data yji ‚àºF(œÜji). The HDP generates a global
probability measure G0 ‚àºDP(Œ≥, P0) on the parameter space Œ¶ and then draws the
group speciÔ¨Åc distribution Gj ‚àºDP(Œ±, G0). The global measure G0 acts as a central
distribution for Gj, with Œ± controlling the degree of variability. The stick-breaking
representation expresses G0 and Gj as:
G0
=
‚àû
X
k=1
Œ≤kŒ¥œÜ‚àó
k(¬∑),
Œ≤ = {Œ≤k}‚àû
k=1 ‚àºStick(Œ≥)
Gj
=
‚àû
X
k=1
œâjkŒ¥œÜ‚àó
k(¬∑),
œâj = {œâjk}‚àû
k=1 ‚àºDP(Œ±, Œ≤),
(4.7)
where œÜ‚àó
k
i.i.d
‚àºP0. Since G0 is discrete, each Gj shares the same set of global parameters
but with diÔ¨Äerent sets of weights. An indicator variable zji ‚àºMult(œâj) (multinomial
distribution) is generated to link an observation yji to the unique global parameter œÜ‚àó
zji.
Multiple œÜji‚Äôs might take identical values of some global parameter œÜ‚àó
k.
An equivalent representation of the HDP mixture model is given via the following
conditional distributions:
yji|zji, {œÜ‚àó
k}‚àû
k=1
‚àº
F(œÜ‚àó
zji),
œÜ‚àó
k
‚àº
P0,
zji
‚àº
Mult(œâj),
œâj|Œ±, Œ≤
‚àº
DP(Œ±, Œ≤),
Œ≤
‚àº
Stick(Œ≥).
(4.8)
95

The underlying process generating the HDP mixture model can be described using
the metaphor of a Chinese restaurant franchise (CRF) (Teh et al., 2006). There are
J restaurants (groups) sharing a global menu G0. Each jth restaurant has inÔ¨Ånitely
many tables (clusters) serving dishes (parameters) for customers (observations), and its
own menu Gj deÔ¨Åning the customer sitting structure. Integrating out the jth restau-
rant speciÔ¨Åc menu Gj, customer yji sits at already occupied table tji with probability
proportional to the number of currently seated customers or selects a new table with
probability proportional to Œ±. The conditional distribution of dish œÜji for customer yji
is given by
œÜji|œÜ‚àíi
j , Œ±, G0 ‚àº
Tj
X
t=1
njt
Œ± + Nj ‚àí1Œ¥œÜ‚àó
jt +
Œ±
Œ± + Nj ‚àí1G0,
(4.9)
where njt is the number of customers in the jth restaurant sitting at table t and sharing
dish (parameter) œÜ‚àó
jt, and œÜ‚àíi
j
= {œÜj1, . . . , œÜji‚àí1, œÜji+1, . . . , œÜjNj}. Integrating out G0,
each table serves a dish (parameter) œÜ‚àó
jt = œÜ‚àó
kjt with probability proportional to the
number of other tables serving that dish in the franchise, or chooses a new dish with
probability proportional to Œ≥. The conditional distribution of the dish œÜ‚àó
jt is written as
œÜ‚àó
jt|Œ¶‚àó
1, . . . , Œ¶‚àó
j‚àí1, Œ¶‚àó(‚àít)
j
, Œ≥, P0 ‚àº
M
X
k=1
mk
Œ≥ + P
k mk
Œ¥œÜ‚àó
k +
Œ≥
Œ≥ + P
k mk
P0,
(4.10)
where Œ¶‚àó
r = {œÜ‚àó
r1, . . . , œÜ‚àó
rTr} includes all the dishes in the rth restaurant, Œ¶‚àó(‚àít)
j
includes
all the dishes in the jth restaurant except the dish œÜ‚àó
jt, mk is the number of tables in
all restaurants serving the dish œÜ‚àó
k, and M denotes the number of global dishes already
served in the franchise. Observation yji is then drawn from the generating distribution
F(œÜ‚àó
zji) with the parameter œÜ‚àó
zji = œÜ‚àó
jtji = œÜ‚àó
kjtji.
The HDP mixture model can be derived as the limit of a sequence of Ô¨Ånite hi-
erarchical mixture model (Ishwaran and Zarepour, 2002; Teh et al., 2006; Fox et al.,
96

2008):
Œ≤
‚àº
Dir(Œ≥/L, . . . , Œ≥/L)
œâj
‚àº
Dir(Œ±Œ≤1, . . . , Œ±Œ≤L),
(4.11)
where the number of mixture components L ‚Üí‚àû. This weak limit approximation is
useful to develop eÔ¨Écient blocked posterior sampling algorithm.
4.2.4
The Sticky HDP-iHMM Model
To model the situations where a system changes over time in a discontinuous fashion,
regime-switching state-space models is a good choice. Regimes refer to discrete stages
between which certain parameters or characteristics of the system switch. The dynamics
of emotions experienced by each subject can be regarded as two discrete ‚Äúregimes‚Äù along
the valence dimension, positive and negative emotion phases, and unknown, potentially
inÔ¨Ånitely many ‚Äúregimes‚Äù along the arousal dimension. The emotion switching system
has the feature of state persistence, where a currently experienced emotion state is
reluctant to move to another state. Hence, we use the sticky HDP-iHMM model (Teh
et al., 2006; Ni et al., 2007; Fox et al., 2008) to address the time related state-switching
structure and the self-transition feature in the time-dependent latent emotion factor
œÜi,t in model (4.3).
Assume the subject speciÔ¨Åc time-dependent parameters œÜi,t = (Hi,t, Ai,t, Bi,t)T switch-
ing among an inÔ¨Ånite collection of emotion and arousal regimes. Let each HDP group-
speciÔ¨Åc set of weights, œâj act as a state-speciÔ¨Åc transition distribution in the inÔ¨Ånite
state space (inÔ¨Ånitely many groups). Denote zit for the current emotion state of the
Markov chain for the ith subject at time t. The current state zit is generated from the
97

multinomial distribution of transition parameters œâzit‚àí1,
zit ‚àºMult(œâzit‚àí1),
(4.12)
where zit‚àí1 indexes the group to which yit is assigned.
The current state zit links
the parameter œÜ‚àó
zit to œÜi,t. To incorporate the self-transition feature, the state-speciÔ¨Åc
transition distribution œâj is speciÔ¨Åed as,
œâj ‚àºDP(Œ± + Œ∫, Œ±Œ≤ + Œ∫Œ¥j
Œ± + Œ∫
),
(4.13)
where Œ∫ > 0 is the self-transition sticky parameter for the current state j, and Œ¥j denotes
a point mass at the current state j. The original HDP-iHMM model is retrieved when
Œ∫ = 0.
The Chinese restaurant metaphor of the sticky HDP-iHMM model now has a special
family of loyal customers to the franchise. Denote zt‚àí1 as the grandparent,zt as the
parent, and zt+1 as the child. The parent enters a restaurant j which its parent chose
zt‚àí1 = j, and chooses a table tji ‚àºœâj which serves dish kjtji.
It is implied that
zt = zji = kjtji. The increased family favor will likely to drive the child to choose
the same dish as its parent, and in turn, develops a loyal family to the franchise over
generations. On the other side, it is also possible that the child turns away from its
parent‚Äôs occasional un-popular choice to the most popular dish served in this franchise.
Hence, such sticky (loyalty) feature can be observed in the increased popularity of a
table dish randomly chosen by
kjt ‚àºMult(Œ±Œ≤ + Œ∫Œ¥j
Œ± + Œ∫
).
(4.14)
A set of auxiliary random variables ¬Økjt and qjt is introduced to facilitate the inference
98

algorithm:
¬Økjt
‚àº
Œ≤,
qjt
‚àº
Ber(
Œ∫
Œ± + Œ∫),
kjt
=
Ô£±
Ô£¥
Ô£≤
Ô£¥
Ô£≥
¬Økjt,
qjt = 0;
j,
qjt = 1,
(4.15)
where qjt is an indicator variable with the value of 1 to override the current state as
the previous state, and 0 to move to any state randomly silencing the sticky tendency.
4.3
Posterior Computation
In this section we develop a block z Gibbs sampler to implement the sticky HDP-iHMM
circumplex model. We incorporate the block z sampler of Fox et al. (2008) to sample
the parameters œÜi,t = (Hi,t, Ai,t, Bi,t)T, where a variant of the HMM forward-backward
procedure is used to harness the Markov structure and jointly sample the state sequence
z1:T. A set of auxiliary variables mjk, ¬Ømjk, and qjt is added to facilitate the block z
sampling. We place the block constraints (Lenk et al., 2006) to sample the item angles
Œ∏j.
We deÔ¨Åne the following notations for convenient use in the description of the sam-
pler:
‚Ä¢ Y = (Y¬∑,1, . . . , Y¬∑,J), where Y¬∑,j = (YT
1,j, . . . , YT
n,j)T, and Yi,j = (Yi,j,1, . . . , Yi,j,T)T,
for i = 1, . . . , n, j = 1, . . . , J,
‚Ä¢ Œ£ = diag(œÉ2
1, . . . , œÉ2
J),
‚Ä¢ Œ∏ = (Œ∏1, . . . , Œ∏J)T,
‚Ä¢ X = (XsXc), where Xs = (sin(Œ∏1), . . . , sin(Œ∏J))T and Xc = (cos(Œ∏1), . . . , cos(Œ∏J))T,
99

‚Ä¢ H = (HT
1 , . . . , HT
n)T, where Hi = (Hi,1, . . . , Hi,T)T.
‚Ä¢ A = (AT
1 , . . . , AT
n)T, where Ai = (Ai,1, . . . , Ai,T)T.
‚Ä¢ B = (BT
1 , . . . , BT
n)T, where Bi = (Bi,1, . . . , Bi,T)T.
Starting from the initiation step, the posterior sampler proceeds as follows:
1. Conditional on the previous set of state-speciÔ¨Åc transition densities œâ(n‚àí1), the
global transition density Œ≤(n‚àí1), and the model parameters œÜ(n‚àí1), U(n‚àí1), Œ∏(n‚àí1),
block sample the state sequences z and the parameters œÜi,t:
(a) Compute backward messages mt,t‚àí1(k) sequentially in time. Set œâ = œâ(n‚àí1),
U = U(n‚àí1), Œ∏ = Œ∏(n‚àí1). For t ‚àà{T, . . . , 1}, k ‚àà{1, . . . , L}, initialize mes-
sages mT+1,T(k) = 1 and then compute mt,t‚àí1(k) = PL
l=1 œâk(l)N(yt; Ul, œÜl, Œ∏l, Œ£l).
(b) Initialize nkl = 0 and Yk = ‚àÖ, (k, l) ‚àà{1, . . . , L}2. Sequentially sample the
state assignments z1:T forward in time
zt ‚àº
L
X
l=1
fl(yt)Œ¥l,
where fl(yt) = œâzt‚àí1(l)N(yt; Ul, œÜl, Œ∏l, Œ£l)mt+1,t(l).
Increment nzt‚àí1zt and
update yt to the cached statistics Yzt for sampling œÜzt.
(c) Sample the auxiliary variables m, ¬Øm, and q:
i. Denote Jkl = {t|zt‚àí1 = k, zt = l}, for each (k, l) ‚àà{1, . . . , L}2. Start
with mkl = 0, n = 0, for each t ‚ààJkl, sample
x ‚àºBer(
Œ±Œ≤l + Œ∫Œ¥(k, l)
n + Œ±Œ≤l + Œ∫Œ¥(k, l)),
increment n, and if x = 1 increment mkl.
100

ii. Sample the number of override variables in restaurant k:
qk¬∑ ‚àºBinomial(mkk,
œÅ
œÅ + Œ≤k(1 ‚àíœÅ)),
for k ‚àà{1, . . . , L}, where œÅ =
Œ∫
Œ±+Œ∫.
iii. Set the number of informative tables in restaurant k serving dish l as:
¬Ømkl
=
Ô£±
Ô£¥
Ô£≤
Ô£¥
Ô£≥
mkl,
k Ã∏= l;
mkk ‚àíqk¬∑,
k = l,
(d) Sample the global transition density via
Œ≤ ‚àºDir(Œ≥/L + ¬Øm.1, . . . , Œ≥/L + ¬Øm.L).
(e) Sample the new transition densities œâk and the model parameters œÜk, k =
1, . . . , L via
œâk
‚àº
Dir(Œ±Œ≤1 + nk1, . . . , Œ±Œ≤k + Œ∫ + nkk, . . . , Œ±Œ≤L + nkL),
œÜk
‚àº
p(œÜ|Œ∑, Yk).
2. Sample U from its conditional distribution N(¬µu, Œ£u), where ¬µu = Œ£u(Œ£‚àí1(Y ‚àí
H1T
J ‚àíAXT
s ‚àíBXT
c )T1nT + Œ£‚àí1
0 ¬µ0) and Œ£u = (nŒ£‚àí1 + Œ£‚àí1
0 ).
3. Sample œÉ‚àí2
j
from its conditional distribution Ga(r0 + nT/2, s0 + 0.5 P
i,T(Yi,j,t ‚àí
Uj ‚àíHi,t ‚àíAi,tsin(Œ∏j) ‚àíBi,tcos(Œ∏j))2).
4. Sample Œª‚àí2 from its conditional distribution Ga(u0,1 + nT/2, v0,1 + HTH/2).
5. Sample œÑ ‚àí2 from its conditional distribution Ga(u0,2 + nT/2, v0,2 + ATA/2 +
BTB/2).
101

6. Sample the latent cutpoints ci,g from the conditional distributions Unif(max(¬Øyg, ci,g‚àí1),
min(yg+1, ci,g+1)), where ¬Øyg = max{Yi,j,t : Wi,j,t = g} and yg+1 = min{Yi,j,t :
Wi,j,t = g + 1}, g = 2, . . . , G ‚àí2.
7. Sample the latent responses Yi,j,t from the conditional distributions:
(a) for observed Wi,j,t,
p(Yi,j,t|‚àí) ‚àºN(Uj+Hi,t+Ai,t sin Œ∏j+Bi,t cos Œ∏j, œÉ2
j)X(ci,wi,j,t‚àí1 < Yi,j,t < ci,wi,j,t).
(b) for missing Wi,j,t,
p(Yi,j,t|‚àí) ‚àºN(Uj + Hi,t + Ai,t sin Œ∏j + Bi,t cos Œ∏j, œÉ2
j).
8. Sample the item angles Œ∏ using a hybrid sampling strategy. These angles are
placed in C blocks of constraints B1, . . . , BC. Denote Bc = min{Œ∏j : j ‚ààBc} and
¬ØBc = max{Œ∏j : j ‚ààBc} for the minimum and maximum angles in the cth block,
c = 2, . . . , C. For the Ô¨Årst block, the ‚Äúminimum‚Äù and ‚Äúmaximum‚Äù angles are
deÔ¨Åned as
B1
=
Ô£±
Ô£¥
Ô£≤
Ô£¥
Ô£≥
2œÄ,
if BC > max{Œ∏j : j ‚ààB1};
min{Œ∏j : j ‚ààB1 and Œ∏j > ¬ØBC},
if BC < max{Œ∏j : j ‚ààB1},
¬ØB1
=
max{Œ∏j : j ‚ààB1 and Œ∏j < B2}.
These blocks satisfy the ordering
0 ‚â§¬ØB1 < B2 < ¬ØB2 < . . . < BC < ¬ØBC < B1 ‚â§2œÄ.
102

(a) Gibbs step: sample Œ∏ from the conditional distribution
p(Œ∏|‚àí)
‚àù
J
Y
j=1
V M(dj, Qj, Cj),
Qj
=
œÉ‚àí2
j
Ô£´
Ô£¨
Ô£≠
ATA
ATB
BTA
BTB
Ô£∂
Ô£∑
Ô£∏+ Q0,
dj
=
Q‚àí1
j {(A B)T(Y¬∑,j ‚àíUj1nT + A) + Q0d0}
where Cj is the constraint set for Œ∏j.
(b) Metropolis step: generate Œ∏j from a mixture of R uniform distributions.
Denote b1, . . . , bC for the indices of the last angle in each block such that
1, . . . , b1 ‚ààB1 and bc‚àí1 + 1, . . . , bc ‚ààBc, c = 2, . . . , C.
i. For Œ∏j ‚ààB1, generate the candidate angle from the jump distributions
g1(œàm|œà2, . . . , œàm‚àí1, Œ∏m, . . . , Œ∏J)
‚àº
R
X
r=1
pr
X(ar,m,1 < œàm < br,m,1)
br,m,1 ‚àíar,m,1
,
ar,m,1
=
max{ ¬ØBC ‚àí2œÄ, Œ∏m ‚àíur},
br,m,1
=
min{B2, Œ∏m + ur},
for m = 2, . . . , b1. If œàm < 0, set œàm = 2œÄ + œàm.
ii. For Œ∏j ‚ààSC
c=2 Bc, generate the candidate angle from the uniform random
walk
gc(œàm|œà2, . . . , œàm‚àí1, Œ∏m, . . . , Œ∏J)
‚àº
R
X
r=1
pr
X(ar,m,c < œàm < br,m,c)
br,m,c ‚àíar,m,c
,
ar,m,1
=
max{ ¬ØBc‚àí1, Œ∏m ‚àíur},
br,m,1
=
min{Bc+1, Œ∏m + ur},
103

for m = bc‚àí1 + 1, . . . , bc. Note BC+1 = B1.
The acceptance probability for the candidates are
min{1,
[œà|Y ] QC
c=1
Qbc
m=bc‚àí1+1 gc(Œ∏m|Œ∏2, . . . , Œ∏m‚àí1, œàm, . . . , œàJ)
[Œ∏|Y ] QC
c=1
Qbc
m=bc‚àí1+1 gc(œàm|œà2, . . . , œàm‚àí1, Œ∏m, . . . , Œ∏J)
},
where b0 + 1 = 2.
We use a modiÔ¨Åed Brier score (Lenk et al., 2006) as the Ô¨Åt measure. After the burn
in, we compute a Brier score at each iteration h:
BS(h) =
1
NG
n
X
i=1
J
X
j=1
T
X
t=1
G
X
g=1
Œ¥i,j,t(zi,j,t,g ‚àíP(Wi,j,t = g|‚Ñ¶(h)))2,
where N is the total number of observations, the indicator variable zi,j,t,g = 1 if the
ith subject responded g to the jth item at time t and 0 otherwise, Œ¥i,j,t takes the value
of 1 if this record is not missing, and P(Wi,j,t = g|‚Ñ¶) is the predictive probability for
Wi,j,t = g conditional on the parameters ‚Ñ¶and the data.
4.4
Simulation Study
We conducted a Monte Carlo simulation study to access the performance of the sticky
HDP-iHMM circumplex model. We simulated a three-state sequence data containing
T = 9 time points. At each state s, we generated 16 item responses on a 7 point ordinal
scale for 50 subjects from the following model:
Yi,j,s
=
Uj + Hi,s + Ai,s sin Œ∏j + Bi,s cos Œ∏j + œµi,j,s,
Wi,j,s
=
g,
iÔ¨Ä
cg‚àí1 ‚â§Yi,j,s < cg,
for
g = 1, . . . , 7.
(4.16)
104

where the item speciÔ¨Åc response means Uj were drawn from N(0, 1), the item speciÔ¨Åc
angles Œ∏j were randomly generated under the constraints of four blocks along the circle
with four angles in each block, and the state speciÔ¨Åc random factors (Hi,s, Ai,s, Bi,s)T
were generated from a 3-dimensional normal distribution with the Gaussian mean of
(‚àí10, 0, 10)T and the diagonal covariance matrix with 0.01 variances. The measurement
error œµi,j,s was assumed to be drawn from a normal distribution with mean 0 and
variance 0.01. The cutoÔ¨Äpoints were set as (‚àí1, ‚àí0.6, ‚àí0.2, 0.2, 0.6, 1).
We analyzed the simulated data using our sticky HDP-iHMM circumplex model and
applied the block-z Gibbs sampler. The block-z Gibbs sampler ran 7,000 iterations, with
the Ô¨Årst 2000 samples discarded as burn-in. Every 5th sample was collected to thin
the chain. Our Gibbs sampler converges rapidly and exhibits eÔ¨Écient mixing. We set
0.98 for the self-transition probability in the sticky HDP-iHMM model. We assigned
Ga(1, 1) hyperpriors for the hyperparameters Œ± and Œ≥. We used a truncation level
of L = 5 in the block sampler, while letting the sampler learn a strict subset of the
available states.
Our algorithm was able to recover the true states accurately. Fig. 4.2 plots the true
state sequence in the upper panel and the labeled state sequence learned in the sampler
in the lower panel. Three colors stand for three states, navy for state 1, dodger blue for
state 2, and green yellow for state 3. The true state sequence shares the same color map
as the labeled state sequence. The posterior estimates of the angles are accurate for
the angles in the 2nd to 4th block, while have relatively large bias for the angles in the
Ô¨Årst block (Table 4.1). The brier score comparing the posteriori predictive probabilities
and the ordinal outcomes was 0.056.
105

4.5
PANAS Data Analysis
The PANAS data comes from a large emotion study.
This study was designed to
investigate the emotion dynamics. Participants were asked to complete a ‚Äúdaily‚Äù survey
four times a day for a total of thirty days in addition to one ‚Äùnightly‚Äù survey each day.
We included 55 individuals who did the daily self-reports of their feelings over the Ô¨Årst 7
consecutive days. Eight ordinal positive emotion (PE) items and nine ordinal negative
emotion (NE) items measured on a scale from 1 ( = none) to 4 ( = always) were used
for model Ô¨Åtting purpose in the chapter. The PE items include enthusiastic, interested,
determined, active, strong, proud, inspired, and attentive.
The NE items included
scared, afraid, upset, nervous, ashamed, guilty, distressed, jittery, and irritable.
We analyzed the PANAS data set using the sticky HDP-iHMM circumplex model.
We collected 1000 samples for every 5th samples from the block-z Gibbs sampler, after
the initial burn in of 2000 iterations. We initiated a truncation level of L = 5, and
placed Ga(1, 1) hyperpriors for the hyperparameters Œ± and Œ≥. We chose 0.98 for the
self-transition probability, favoring state persistence. The chain converges rapidly and
exhibits eÔ¨Écient mixing. We estimated the item speciÔ¨Åc direction posteriori and labeled
the emotion states over the seven days.
The analysis results for the PANAS data are displayed in Fig. 4.3 and 4.4. The
emotions were labeled as two states over the seven days (Fig. 4.3), where the Ô¨Årst
six days fell in one state, and the seventh day fell in the other state. This result is
supported by the fact that day 7 has the smallest averages of both the diÔ¨Äerence and
the ratio between the PE scores and the NE scores (Table 4.2). This phenomenon
concludes that the prolonged eÔ¨Äects on emotions from the emotion induction exposure
in the laboratory experiment extended for six days and elapsed in the seventh day.
The estimates of the emotion directions along the unit circle were graphed in Fig. 4.4,
where the PE items are in the right panel and the NE items are in the left panel. The
106

brier score evaluating the distance between the posteriori predictive probabilities and
the ordinal outcomes was 0.063.
4.6
Discussion
We demonstrated the considerable beneÔ¨Åts of the extended circumplex model in which
the time related state switching structure is constructed by the sticky HDP-iHMM
model. The circumplex model has been appealing to social science researchers because
of its circular correlation structure of measure items.
Our approach further yields
another appealing feature allowing the capture of the state persistence/switching dy-
namics. We have also presented an eÔ¨Écient sampling technique. The synthetic data
analysis and the empirical application clearly demonstrate the practical importance of
our state-space extensions. We believe that our contributions will facilitate rigorous
tests and increase the popularity of circumplex models in the analysis of psychological
measures.
107

Fig. 4.1: A circular structure of aÔ¨Äects classiÔ¨Åed into six clusters. PA = positive aÔ¨Äect;
NA = negative aÔ¨Äect; HighAct = high activation; MediumAct = medium activation;
LowAct = low activation.
108

Table 4.1: Simulation study: estimated directions for the synthetic data.
Standardized
Item
Block
True
Estimate
Bias
Bias
1
1
0.000
0.000
0.000
0.000
2
1
1.425
0.697
-0.723
-0.511
3
1
0.865
0.701
-0.165
-0.190
4
1
1.210
0.650
-0.559
-0.462
5
2
2.828
3.054
0.226
0.080
6
2
2.731
2.853
0.121
0.045
7
2
1.793
1.540
-0.254
-0.141
8
2
2.259
2.840
0.581
0.257
9
3
3.692
3.571
-0.121
-0.033
10
3
3.893
3.594
-0.299
-0.077
11
3
4.064
3.597
-0.467
-0.115
12
3
3.371
3.323
-0.048
-0.014
13
4
6.135
6.148
0.014
0.002
14
4
5.718
5.875
0.157
0.028
15
4
4.968
4.996
0.028
0.006
16
4
5.601
5.884
0.283
0.051
Table 4.2: PANAS data: the averages of the diÔ¨Äerence and the ratio between positive
emotion (PE) scores and negative emotion (NE) scores.
day
Measure
Average
1
2
3
4
5
6
7
PE-NE
Average
1.44
1.41
1.48
1.37
1.31
1.37
1.29
PE/NE
Average
2.23
2.22
2.34
2.29
2.18
2.22
2.17
109

Fig. 4.2: Performance of state labeling in the simulated data. Upper panel: the true
state sequence; lower panel: the labeled state sequence.
110

Fig. 4.3: The classiÔ¨Åed states for the PANAS data.
111

Fig. 4.4: Plot of the sine versus cosine of the posteriori estimated angles for the PANAS
data. Right panel: positive emotion (PE) items; left panel: positive emotion (NE)
items;
112

Bibliography
Ahmad, I., Leelahanon, S., and Li, Q. (2005), ‚ÄúEÔ¨Écient estimation of a semiparametric
partially linear varying coeÔ¨Écient model,‚Äù The Annals of Statistics, 33, 258283.
Anderson, T. (1960), ‚ÄúSome stochastic process models for intelligence test scores,‚Äù in
In K.J. Arrow, S. Karlin, and P. Suppes (Eds.), Mathematical methods in the social
sciences, Stanford, University Press, pp. 205‚Äì220.
Ashburner, J. and Friston, K. J. (2000), ‚ÄúVoxel-based morphometry: The methods,‚Äù
Neuroimage, 11, 805‚Äì821.
Baladandayuthapani, V., Mallick, B. K., Young Hong, M., Lupton, J. R., Turner, N. D.,
and Carroll, R. J. (2008), ‚ÄúBayesian hierarchical spatially correlated functional data
analysis with application to colon carcinogenesis,‚Äù Biometrics, 64, 64‚Äì73.
Basser, P. J., Mattiello, J., and LeBihan, D. (1994a), ‚ÄúEstimation of the eÔ¨Äective self-
diÔ¨Äusion tensor from the NMR spin echo,‚Äù Journal of Magnetic Resonance Ser. B,
103, 247‚Äì254.
‚Äî (1994b), ‚ÄúMR diÔ¨Äusion tensor spectroscopy and imaging,‚Äù Biophysical Journal, 66,
259‚Äì267.
Behseta, S., Kass, R. E., and Wallstrom, G. L. (2005), ‚ÄúHierarchical models for assessing
variability among functions,‚Äù Biometrika, 92, pp. 419‚Äì434.
Berrocal, V. J., Gelfand, A. E., and Holland, D. M. (2010), ‚ÄúA spatio-temporal down-
scaler for output from numerical models,‚Äù Journal of Agricultural Biological and
Environmental Statistics, 15, 176‚Äì197.
Bhattacharya, A. and Dunson, D. B. (2011), ‚ÄúSparse Bayesian inÔ¨Ånite factor models,‚Äù
Biometrika, 98, 291‚Äì306.
Biller, C. and Fahrmeir, L. (1997), ‚ÄúBayesian spline-type smoothing in generalized
regression models,‚Äù .
Blackwel, D. and Macqueen, J. (1973), ‚ÄúFerguson distributions via p¬¥olya urn schemes,‚Äù
Annals Of Statistics, 1, 353‚Äì355.
Bonekam, D., Nagae, L. M., Degaonkar, M., Matson, M., Abdalla, W. M., Barker,
P. B., Mori, S., and Horsk¬¥a, A. (2008), ‚ÄúDiÔ¨Äusion tensor imaging in children and
adolescents: Reproducibility, hemispheric, and age-related diÔ¨Äerences,‚Äù NeuroImage,
34, 733‚Äì742.
113

Botts, C. H. and Daniels, M. J. (2008), ‚ÄúA Ô¨Çexible approach to Bayesian multiple curve
Ô¨Åtting,‚Äù Computational Statistics & Data Analysis, 52, 5100‚Äì5120.
Bowman, F. D., CaÔ¨Äo, B., Bassett, S. S., and Kilts, C. (2008), ‚ÄúA Bayesian hierarchical
framework for spatial modeling of fMRI data,‚Äù NeuroImage, 39, 146 ‚Äì 156.
Brezger, A., Fahrmeir, L., and Hennerfeind, A. (2007a), ‚ÄúAdaptive Gaussian Markov
random Ô¨Åelds with applications in human brain mapping,‚Äù Journal of Royal Statis-
tical Society C, 56, 327‚Äì345.
‚Äî (2007b), ‚ÄúAdaptive Gaussian Markov random Ô¨Åelds with applications in human
brain mapping,‚Äù J. Roy. Statist. Soc. C, 56, 327‚Äì345.
Brezger, A. and Lang, S. (2006), ‚ÄúGeneralized structured additive regression based on
Bayesian P-splines,‚Äù Comput. Statist. Data Anal, 50, 967‚Äì991.
Browne, M. (1992), ‚ÄúCircumplex models for correlation matrices,‚Äù Psychometrika, 57,
469‚Äì497, 10.1007/BF02294416.
Brumback, B. and Rice, J. A. (1998), ‚ÄúSmoothing spline models for the analysis of
nested and crossed samples of curves (with discussion),‚Äù J. Amer. Statist. Assoc.,
93, 961994.
Bush, C. and MacEachern, S. (1996), ‚ÄúA semiparametric Bayesian model for ran-
domised block designs,‚Äù Biometrika, 83, 275‚Äì285.
Cai, J., Fan, J., Zhou, H., and Zhou, Y. (2007), ‚ÄúHazard models with varying-
coeÔ¨Écients for multivariate failure time data,‚Äù Ann Statist, 35, 324354.
Cai, Z., Fan, J., and Li, R. (2000a), ‚ÄúEÔ¨Écient estimation and inferences for varying-
coeÔ¨Écient models,‚Äù J. Amer. Statist. Assoc., 95, 888902.
Cai, Z., Fan, J., and Yao, Q. (2000b), ‚ÄúFunctional-coeÔ¨Écient regression models for
nonlinear time series,‚Äù J. Amer. Statist. Assoc., 95, 941956.
Cai, Z. and Sun, Y. (2003), ‚ÄúLocal linear estimation for time-dependent coeÔ¨Écients in
Coxs regression model,‚Äù Scand J of Statist, 30, 93111.
Camara, E., Bodammer, N., Rodriguez-Fornells, A., and Tempelmann, C. (2007), ‚ÄúAge-
related water diÔ¨Äusion changes in human brain: A voxel-based approach,‚Äù NeuroIm-
age, 34, 1588‚Äì1599.
Carroll, R. J., Ruppert, D., and Welsh, A. H. (1998), ‚ÄúLocal estimating equations,‚Äù J.
Amer. Statist. Assoc., 93, 214227.
Carvalho, C. M., Chang, J., Lucas, J. E., Nevins, J. R., Wang, Q., and West, M.
(2008), ‚ÄúHigh-dimensional sparse factor modeling: Applications in gene expression
genomics,‚Äù J. Amer. Statist. Assoc. , 103, 1438‚Äì1456.
114

Carver, C. S. and Scheier, M. F. (1982), ‚ÄúControl-theory - a useful conceptual-
framework for personality-social, clinical, and health psychology,‚Äù Psychological Bul-
letin, 92, 111‚Äì135.
Cascio, C. J., Gerig, G., and Piven, J. (2007), ‚ÄúDiÔ¨Äusion tensor imaging: Application
to the study of the developing brain,‚Äù J Am Acad Child Adolesc Psychiatry, 46,
213‚Äì223.
Chen, R. and Tsay, R. J. (1993), ‚ÄúFunctional-coeÔ¨Écient autoregressive models,‚Äù J.
Amer. Statist. Assoc., 88, 298308.
Chen, Y. S., An, H. Y., Zhu, H. T., Stone, T., Smith, J. K., Hall, C., Bullitt, E., Shen,
D. G., and Lin, W. L. (2009), ‚ÄúWhite matter abnormalities revealed by diÔ¨Äusion
tensor imaging in non-demented and demented HIV+ patients,‚Äù NeuroImage, 47,
1154‚Äì1162.
Chiang, C.-T., Rice, J. A., and Wu, C. O. (2001), ‚ÄúSmoothing spline estimation for
varying coeÔ¨Écient models with repeatedly measured dependent variables,‚Äù J. Amer.
Statist. Assoc., 96, 605619.
Chow, S.-M., Nesselroade, J. R., Shifren, K., and McArdle, J. J. (2004), ‚ÄúDynamic
structure of emotions among individuals with Parkinsons disease,‚Äù Structural Equa-
tion Modeling, 11, 560 ‚Äì 582.
Cleveland, W. S., Grosse, E., and Shyu, W. M. (1991), Local regression models. In
statistical models in S (Chambers, J. M. and Hastie, T. J., eds),, Wadsworth &
Brooks, PaciÔ¨Åc Grove.
Cox, D. R. (1972), ‚ÄúRegression models and life tables (with discussion),‚Äù J. Roy. Statist.
Soc. B, 34, 187220.
Crainiceanu, C. M., Ruppert, D., Carroll, R. J., Joshi, A., and Goodner, B. (2007),
‚ÄúSpatially adaptive Bayesian penalized splines with heteroscedastic errors,‚Äù Journal
of Computational and Graphical Statistics, 16, 265‚Äì288.
Cruz-Mes¬¥ƒ±a, R. D. L., Fernando, A. Q., and M¬®ueller, P. (2007), ‚ÄúSemiparametric
Bayesian classiÔ¨Åcation with longitudinal markers,‚Äù Journal of Royal Statistical Soci-
ety C, 56, 119‚Äì137.
Csikszentmihalyi, M. (1998), Finding Flow: The Psychology of Engagement With Ev-
eryday Life, Basic Books.
Cudeck, R. (1986), ‚ÄúA note on structural models on the circumplex,‚Äù Psychometrika,
51, 143147.
Dahl, D. B. (2007), ‚ÄúComment on article by jain and neal,‚Äù Bayesian Analysis, 2,
473‚Äì477.
115

De Iorio, M., M¬®uller, P., Rosner, G., and MacEachern, S. (2004), ‚ÄúAn ANOVA model
for dependent random measures,‚Äù J. Amer. Statist. Assoc., 99, 205‚Äì215.
Denison, D. G. T., Mallick, B. K., and Smith, A. F. M. (1998a), ‚ÄúA Bayesian CART
algorithm,‚Äù Biometrika, 85, 363‚Äì377.
‚Äî (1998b), ‚ÄúAutomatic bayesian curve Ô¨Åtting,‚Äù Journal of Royal Statistical Society B,
60, pp. 333‚Äì350.
Dimatteo, I., Genovese, C. R., and Kass, R. E. (2001), ‚ÄúBayesian curve Ô¨Åtting with
free-knot splines,‚Äù Biometrika, 88, 1055‚Äì1071.
Dunson, D. B. (2009), ‚ÄúNonparametric Bayes local partition models for random eÔ¨Äects,‚Äù
Biometrika, 96, 249‚Äì262.
Eilers, P. H. C. and Marx, B. D. (1996), ‚ÄúFlexible smoothing with B-splines and penal-
ties,‚Äù Statistical Science, 11, 89‚Äì102.
Escobar, M. and West, M. (1995), ‚ÄúBayesian density estimation and inference using
mixtures,‚Äù J. Amer. Statist. Assoc., 90, 577‚Äì588.
Eubank, R. L., Huang, C. F., Maldonado, Y. M., Wang, N., Wang, S. J., and Buchanan,
R. J. (2004), ‚ÄúSmoothing spline estimation in varying-coeÔ¨Écient models,‚Äù J. Roy.
Statist. Soc. B, 66, 653‚Äì667.
Fahrmeir, L., Kneib, T., and Lang, S. (2004), ‚ÄúPenalized structured additive regression
for space-time data: A Bayesian perspective ,‚Äù Statistica Sinica, 14, 715‚Äì745.
Fahrmeir, L. and Lang, S. (2001), ‚ÄúBayesian inference for generalized additive mixed
models based on Markov random Ô¨Åeld priors,‚Äù Journal of Royal Statistical Society
C, 50, pp. 201‚Äì220.
Fan, J. (1993), ‚ÄúLocal linear regression smoothers and their minimax eÔ¨Éciencies,‚Äù The
Annals of Statistics, 21, 196‚Äì216.
Fan, J. and Gijbels, I. (1992), ‚ÄúVariable bandwidth and local linear regression
smoothers,‚Äù Annals of statistics, 21, 433‚Äì446.
‚Äî (1995), ‚ÄúData-driven bandwidth selection in local polynomial Ô¨Åtting: Variable band-
width and spatial adaptation,‚Äù J. Roy. Statist. Soc. B, 57, 371394.
‚Äî (1996), Local Polynomial Modelling and Its Applications, Chapman and Hall, Lon-
don.
Fan, J., Heckman, N. E., and Wand, M. P. (1995), ‚ÄúLocal polynomial kernel regression
for generalized linear models and quasi-likelihood functions,‚Äù Journal of the American
Statistical Association, 90, pp. 141‚Äì150.
116

Fan, J., Huang, T., and Li, R. Z. (2007), ‚ÄúAnalysis of longitudinal data with semipara-
metric estimation of covariance function,‚Äù J. Amer. Statist. Assoc., 35, 632641.
Fan, J., Lin, H., and Zhou, Y. (2006), ‚ÄúLocal partial-likelihood estimation for lifetime
data,‚Äù Ann Statist, 34, 290325.
Fan, J. and Zhang, J. T. (2000a), ‚ÄúFunctional linear models for longitudinal data,‚Äù J.
Roy. Statist. Soc. B, 62, 303322.
Fan, J. and Zhang, W. (1999), ‚ÄúStatistical estimation in varying coeÔ¨Écient models,‚Äù
Ann. Statist., 27, 14911518.
‚Äî (2000b), ‚ÄúSimultaneous conÔ¨Ådence bands and hypothesis testing in varying-
coeÔ¨Écient models,‚Äù Scand. J. Statist., 27, 715731.
‚Äî (2008), ‚ÄúStatistical methods with varying coeÔ¨Écient models,‚Äù Statistics and Its
Interface, 1, 179195.
Ferguson, T. S. (1973), ‚ÄúA Bayesian analysis of some nonparametric problems,‚Äù The
Annals of Statistics, 1, 209‚Äì230.
‚Äî (1974), ‚ÄúPrior distributions on spaces of probability measures,‚Äù The Annals of Statis-
tics, 2, pp. 615‚Äì629.
Focke, N. K., Yogarajah, M., Bonelli, S. B., Bartlett, P. A., Symms, M. R., and Duncan,
J. S. (2008), ‚ÄúVoxel-based diÔ¨Äusion tensor imaging in patients with mesial temporal
lobe epilepsy and hippocampal sclerosis,‚Äù NeuroImage, 40, 728‚Äì737.
Fox, E. B., Sudderth, E. B., Jordan, M. I., and Willsky, A. S. (2008), ‚ÄúAn HDP-
HMM for systems with state persistence,‚Äù in Proceedings of the 25th international
conference on Machine learning, New York, NY, USA: ACM, ICML ‚Äô08, pp. 312‚Äì319.
Frijda, N. H. (1986), ‚ÄúThe Emotions,‚Äù in The Emotions, Cambridge(UK): Cambridge
University Press, p. 207.
Gelfand, A. E. and Vounatsou, P. (2003), ‚ÄúProper multivariate conditional autoregres-
sive models for spatial data analysis,‚Äù Biostatistics, 4, 11‚Äì15.
Geweke, J. and Zhou, G. (1996), ‚ÄúMeasuring the pricing error of the arbitrage pricing
theory,‚Äù Review of Financial Studies, 9, 557‚Äì587.
Gilmore, J. H., Smith, L. C., Wolfe, H. M., Hertzberg, B. S., Smith, J. K., Chescheir,
N. C., Evans, D. D., Kang, C., Hamer, R. M., Lin, W., and Gerig, G. (2008), ‚ÄúPre-
natal mild ventriculomegaly predicts abnormal development of the neonatal brain,‚Äù
Biol Psychiatry, 64, 1069‚Äì1076.
Goldsmith, A., Feder, J., Crainiceanu, C., CaÔ¨Äo, B., and Reich, D. (2011), ‚ÄúPenalized
functional regression,‚Äù Journal of Computational and Graphical Statistics.
117

Goodlett, C. B., Fletcher, P. T., Gilmore, J. H., and Gerig, G. (2009), ‚ÄúGroup analysis
of DTI Ô¨Åber tract statistics with application to neurodevelopment,‚Äù NeuroImage, 45,
S133‚ÄìS142.
G¬®ossl, C., Auer, D. P., and Fahrmeir, L. (2001), ‚ÄúBayesian Spatiotemporal Inference
in Functional Magnetic Resonance Imaging,‚Äù Biometrics, 57, 554‚Äì562.
Green, P. J. (1995), ‚ÄúReversible jump Markov chain Monte Carlo computation and
Bayesian model determination,‚Äù Biometrika, 82, 711‚Äì732.
Greven, S., Crainiceanu, C., CaÔ¨Äo, B., and Reich, D. (2010), ‚ÄúLongitudinal functional
principal component analysis,‚Äù Electron. J. Stat., 4, 1022‚Äì1054.
Guttman, L. (1954), ‚ÄúA new approach to factor analysis: The radex.‚Äù in In P.F.
Lazarsfeld (Ed.), Mathematical thinking in the social sciences, New York: Columbia
University Press, pp. 258‚Äì348.
Harezlak, J., Wang, M., Christiani, D., and Lin, X. (2007), ‚ÄúQuantitative quality-
assessment techniques to compare fractionation and depletion methods in SELDI-
TOF mass spectrometry experiments,‚Äù Bioinformatics, 23, 2441‚Äì2448.
Hasan, K. M., Basser, P. J., Parker, D. L., and Alexander, A. L. (2001), ‚ÄúAnalytical
computation of the eigenvalues and eigenvectors in DT-MRI,‚Äù J Magn Reson, 152,
41‚Äì47.
Hasan, K. M. and Narayana, P. A. (2003), ‚ÄúComputation of the fractional anisotropy
and mean diÔ¨Äusivity maps without tensor decoding and diagonalization: theoretical
analysis and validation,‚Äù Magn Reson Med, 50, 589‚Äì598.
Hastie, T. and Tibshirani, R. (2000), ‚ÄúBayesian backÔ¨Åtting,‚Äù Statistical Science, 15,
pp. 196‚Äì213.
Hastie, T. J. and Tibshirani, R. J. (1993), ‚ÄúVarying-coeÔ¨Écient models,‚Äù J. Roy. Statist.
Soc. B., 55, 757796.
He, J. H., Mcgee, D. L., and Niu, X. F. (2010), ‚ÄúApplication of the Bayesian dynamic
survival model in medicine,‚Äù Statistics in Medicine, 29, 347‚Äì360.
Hecke, W. V., Sijbers, J., Backer, S. D., Poot, D., Parizel, P. M., and Leemans, A.
(2009), ‚ÄúOn the construction of a ground truth framework for evaluating voxel-based
diÔ¨Äusion tensor MRI analysis methods,‚Äù NeuroImage, 46, 692‚Äì707.
Hogan, J. W., Lin, X., and Herman, B. (2004), ‚ÄúMixtures of varying coeÔ¨Écient models
for longitudinal data with discrete or continuous nonignorable dropout,‚Äù Biometrics,
60, 854864.
118

Hoover, D. R., Rice, J. A., Wu, C. O., and Yang, L.-P. (1998), ‚ÄúNonparametric smooth-
ing estimates of time-varying coeÔ¨Écient models with longitudinal data,‚Äù Biometrika,
85, 809822.
Huang, J. Z. and Shen, H. (2004), ‚ÄúFunctional coeÔ¨Écient regression models for nonlinear
time series: A polynomial spline approach,‚Äù Scandinavian Journal of Statistics, 31,
515534.
Huang, J. Z., Wu, C. O., and Zhou, L. (2002), ‚ÄúVarying-coeÔ¨Écient models and basis
function approximations for the analysis of repeated measurements,‚Äù Biometrika, 89,
111128.
‚Äî (2004), ‚ÄúPolynomial spline estimation and inference for varying coeÔ¨Écient models
with longitudinal data,‚Äù Statistica Sinica, 14, 763788.
Huang, Y., Liang, H., and Wu, H. (2008), ‚ÄúIdentifying signiÔ¨Åcant covariates for anti-
HIV treatment response: Mechanism-based diÔ¨Äerential equation models and empiri-
cal semiparametric regression models,‚Äù Statistics in Medicine, 27, 4722‚Äì4739.
Huitt, W. (2003), ‚ÄúThe aÔ¨Äective system,‚Äù Tech. rep., Valdosta, GA: Valdosta State
University.
Ishwaran, H. and James, L. F. (2001), ‚ÄúGibbs sampling methods for stick-breaking
priors,‚Äù Journal of the American Statistical Association, 96, pp. 161‚Äì173.
Ishwaran, H. and Zarepour, M. (2002), ‚ÄúExact and approximate representations for
the sum Dirichlet process,‚Äù Canadian Journal Of Statistics-Revue Canadienne De
Statistique, 30, 269‚Äì283.
JeÔ¨Äreys, W. and Berger, J. (1992), ‚ÄúOckham‚Äôs razor and Bayesian analysis,‚Äù American
Statistician, 80, 64‚Äì72.
Jones, D. K., Symms, M. R., Cercignani, M., and Howard, R. J. (2005), ‚ÄúThe eÔ¨Äect of
Ô¨Ålter size on VBM analyses of DT-MRI data,‚Äù NeuroImage, 26, 546‚Äì554.
Kauermann, G. (2005), ‚ÄúA note on smoothing parameter selection for penalized spline
smoothing,‚Äù Journal of Statistical Planning and Inference, 127, 53‚Äì69.
Kauermann, G. and Tutz, G. (1999), ‚ÄúOn model diagnostics using varying coeÔ¨Écient
models,‚Äù Biometrika, 86, 119128.
Kleinman, K. and Ibrahim, J. (1998), ‚ÄúA semiparametric Bayesian approach to the
random eÔ¨Äects model,‚Äù Biometrics, 54, 921‚Äì938.
Kubicki, M., McCarley, R., Westin, C.-F., Park, H.-J., Maier, S., Kikinis, R., Jolesz,
F. A., and Shenton, M. E. (2007), ‚ÄúA review of diÔ¨Äusion tensor imaging studies in
schizophrenia,‚Äù Journal of Psychiatric Research, 41, 15‚Äì30.
119

Larsen, R. (2000), ‚ÄúToward a science of mood regulation,‚Äù Psychological Inquiry, 11,
129‚Äì141.
Lee, D. and Shaddick, G. (2007), ‚ÄúTime-varying coeÔ¨Écient models for the analysis of
air pollution and health outcome data,‚Äù Biometrics, 63, 1253‚Äì1261.
Lei, X., Timothy, D. J., Thomas, E. N., and Derek, N. E. (2009), ‚ÄúModeling Inter-
Subject Variability in fMRI Activation Location: A Bayesian Hierarchical Spatial
Model,‚Äù Biometrics, 65, 1041‚Äì1051.
Lenglet, C., Campbell, J. S. W., Descoteaux, M., Haro, G., Savadjiev, P., Wassermann,
D., Anwander, A., Deriche, R., Pike, G. B., Sapiro, G., Siddiqi, K., and Thompson,
P. M. (2009), ‚ÄúMathematical methods for diÔ¨Äusion MRI processing,‚Äù NeuroImage,
45, S111‚ÄìS122.
Lenk, P., Wedel, M., and B¬®ckenholt, U. (2006), ‚ÄúBayesian estimation of circumplex
models subject to prior theory constraints and scale-usage bias,‚Äù Psychometrika, 71,
33‚Äì55, 10.1007/s11336-001-0958-4.
Lepore, N., Brun, C. A., Chou, Y., Chiang, M., Dutton, R. A., Hayashi, K. M., Luders,
E., Lopez, O. L., Aizenstein, H. J., Toga, A. W., Becker, J. T., and Thompson, P. M.
(2008), ‚ÄúGeneralized tensor-based morphometry of HIV/AIDS using multivariate
statistics on deformation tensors,‚Äù IEEE Transactions in Medical Imaging, 27, 129‚Äì
141.
Liang, H., Wu, H. L., and Carroll, R. J. (2003), ‚ÄúThe relationship between virologic
and immunologic responses in AIDS clinical research using mixed-eÔ¨Äects varying-
coeÔ¨Écient models with measurement error,‚Äù Biostatistics, 4, 297‚Äì312.
Lin, D. Y. and Ying, Z. (2001), ‚ÄúSemiparametric and nonparametric regression analysis
of longitudinal data (with discussions),‚Äù J. Amer. Statist. Assoc., 96, 103126.
Lin, X. and Carroll, R. J. (2001), ‚ÄúSemiparametric regression for clustered data using
generalized estimating equations,‚Äù J. Amer. Statist. Assoc., 96, 10451056.
LO, A. (1984), ‚ÄúOn a class of Bayesian nonparametric estimates. 1. Density estimates.‚Äù
The Annals of Statistics, 12, 351‚Äì357.
Lu, Z., Steinskog, D. J., Tjstheim, D., and Yao, Q. (2009), ‚ÄúAdaptively varying-
coeÔ¨Écient spatiotemporal models,‚Äù Journal of Royal Statistical Society B, 71, 859‚Äì
880.
Maceachern, S. (1994), ‚ÄúEstimating normal means with a conjugate style Dirichlet
process prior,‚Äù Communications in Statistics-Simulation and Computation, 23, 727‚Äì
741.
120

Malloy, E. J., Morris, J. S., Adar, S. D., Suh, H., Gold, D. R., and Coull, B. A.
(2010), ‚ÄúWavelet-based functional linear mixed models: An application to measure-
ment error-corrected distributed lag models,‚Äù Biostatistics, 11, 432‚Äì452.
Marina, S. P., Dani, G., Fl¬¥avia, M. L., and Esther, S. (2008), ‚ÄúSpatially varying dy-
namic coeÔ¨Écient models,‚Äù Journal of Statistical Planning and Inference, 138, 1038‚Äì
1058.
Mirr, M. P. (2001), ‚Äú‚ÄúAbnormally Increased Behavioral Arousal‚Äù Cris Stewart- Amidei
and Joyce A. Kunkel.‚Äù in Neuroscience Nursing: Human Response to Neurologic
Dysfunction, W. B. Sunders Philadelphia: PA.
Mooney, C., Vullo, A., and Pollastri, G. (2006), ‚ÄúProtein structural motif prediction
in multidimensional phi-psi space leads to improved secondary structure prediction,‚Äù
Journal of Computational Biology, 13, 1489‚Äì1502.
Morris, J. and Carroll, R. (2006), ‚ÄúWavelet-based functional mixed models,‚Äù Journal
of Royal Statistical Society B, 68, 179‚Äì199.
Moseley, M. (2002), ‚ÄúDiÔ¨Äusion tensor imaging and aging-a review,‚Äù NMR Biomed., 15,
553‚Äì560.
Mukherjee, P. and McKinstry, R. C. (2006), ‚ÄúDiÔ¨Äusion tensor imaging and tractography
of human brain development,‚Äù Neuroimaging Clin N Am, 16, 19‚Äì43.
M¬®uller, P., Parmigiani, G., Robert, C., and Rousseau, J. (2004), ‚ÄúOptimal sample
size for multiple testing: The case of gene expression microarrays,‚Äù Journal of the
American Statistical Association, 99, 990‚Äì1001.
M¬®uller, P. and Rosner, G. (1997), ‚ÄúA Bayesian population model with hierarchical
mixture priors applied to blood count data,‚Äù J. Amer. Statist. Assoc., 92, 1279‚Äì
1292.
Ni, K., Qi, Y., and Carin, L. (2007), ‚ÄúMultiaspect target detection via the inÔ¨Ånite
hidden Markov model,‚Äù Journal Of The Acoustical Society Of America, 121, 2731‚Äì
2742.
Nicholls, D. F. and Quinn, B. G. (1982), Random CoeÔ¨Écient Autoregressive Models:
An Introduction, Springer-Verlag, New York.
O‚ÄôDonnell, L., Westin, C.-F., and Golby, A. (2009), ‚ÄúTract-based morphometry for
white matter group analysis,‚Äù Neuroimage, 45, 832‚Äì844.
Ohlssen, D. I., Sharples, L. D., and Spiegelhalter, D. J. (2007), ‚ÄúFlexible random-
eÔ¨Äects models using Bayesian semi-parametric models: Applications to institutional
comparisons,‚Äù Statistics in Medicine, 26, 2088‚Äì2112.
121

Papaspiliopoulos, O. (2008), ‚ÄúA note on posterior sampling from Dirichlet mixture
models.‚Äù Tech. rep., Universitat Pompeu Fabra.
Papaspiliopoulos, O. and Roberts, G. (2008), ‚ÄúRetrospective Markov chain Monte Carlo
Methods for Dirichlet process hierarchical models,‚Äù Biometrika, 95, 169‚Äì186.
Penny, W., Kilner, J., and Blankenburg, F. (2007), ‚ÄúRobust Bayesian general linear
models,‚Äù NeuroImage, 36, 661 ‚Äì 671.
Petrone, S., Guindani, M., and Gelfand, A. E. (2009), ‚ÄúHybrid Dirichlet mixture models
for functional data,‚Äù Journal of Royal Statistical Society B, 71, 755‚Äì782.
Pierpaoli, C. and Basser, P. J. (1996), ‚ÄúToward a quantitative assessment of diÔ¨Äusion
anisotropy,‚Äù Magn Reson Med, 36, 893‚Äì906.
Rajan, J. J. and Rayner, P. J. W. (1996), ‚ÄúGeneralized feature extraction for time-
varying autoregressive models,‚Äù IEEE Transactions on Signal Processing, 44, 2498‚Äì
2507.
Ramsay, J. O. and Silverman, B. W. (1997), Functional data analysis, Springer, New
York.
Reich, B. J., Fuentes, M., Herring, A. H., and Evenson, K. R. (2010), ‚ÄúBayesian variable
selection for multivariate spatially varying coeÔ¨Écient regression ,‚Äù Biometrics, 66,
772‚Äì782.
Rice, J. A. and Silverman, B. W. (1991), ‚ÄúEstimating the mean and covariance structure
nonparametrically when the data are curves,‚Äù J. Roy. Statist. Soc. B, 53, 233243.
Rice, J. A. and Wu, C. O. (2001), ‚ÄúNonparametric mixed eÔ¨Äects models for unequally
sampled noisy curves,‚Äù Biometrics, 57, 253259.
Rollins, N. K. (2007), ‚ÄúClinical applications of diÔ¨Äusion tensor imaging and tractogra-
phy in children,‚Äù Pediatr Radiol, 37, 769‚Äì780.
Rosa, M. J., Bestmann, S., Harrison, L., and Penny, W. (2010), ‚ÄúBayesian model
selection maps for group studies,‚Äù NeuroImage, 49, 217 ‚Äì 224.
Ruppert, D. (1997), ‚ÄúEmpirical-bias bandwidths for local polynomial nonparametric
regression and density estimation,‚Äù Journal of the American Statistical Association,
92, pp. 1049‚Äì1062.
Ruppert, D. and Wand, M. P. (1994), ‚ÄúMultivariate locally weighted least squares
regression,‚Äù The Annals of Statistics, 22, pp. 1346‚Äì1370.
Russell, J. A. and Carroll, J. M. (1999), ‚ÄúOn the bipolarity of positive and negative
aÔ¨Äect,‚Äù Psychological Bulletin, 125, 3‚Äì30.
122

Schwartzman, A. (2006), ‚ÄúRandom Ellipsoids and False Discovery Rates: Statistics for
DiÔ¨Äusion Tensor Imaging Data,‚Äù Ph.D. thesis, Stanford University.
Schwartzman, A., Dougherty, R. F., and Taylor, J. E. (2005), ‚ÄúCross-subject compari-
son of principal diÔ¨Äusion direction maps,‚Äù Magn Reson Med, 53, 1423‚Äì1431.
Sethuraman, J. (1994), ‚ÄúA constructive deÔ¨Ånition of dirichlet priors,‚Äù Statistica Sinica,
4, 639‚Äì650.
Shi, M. G., Weiss, R. E., and Taylor, J. M. G. (1996), ‚ÄúAn analysis of paediatric CD4
counts for acquired immune deÔ¨Åciency syndrome using Ô¨Çexible random curves,‚Äù J.
Roy. Statist. Soc. C, 45, 151‚Äì163.
Smith, M. and Kohn, R. (1996), ‚ÄúNonparametric regression using Bayesian variable
selection,‚Äù Journal of Econometrics, 75, 317‚Äì343.
‚Äî (1998), ‚ÄúNonparametric estimation of irregular functions with independent or auto-
correlated errors,‚Äù In Practical Nonparametric and Semiparametric Bayesian Statis-
tics. Lecture Notes in Statist., 133, 157‚Äì179.
Smith, S. M., Jenkinson, M., Johansen-Berg, H., Rueckert, D., Nichols, T. E., Mackay,
C. E., Watkins, K. E., Ciccarelli, O., Cader, M., Matthews, P., and Behrens, T. E.
(2006), ‚ÄúTractbased spatial statistics: voxelwise analysis of multi-subject diÔ¨Äusion
data,‚Äù NeuroImage, 31, 1487‚Äì1505.
Snook, L., Paulson, L. A., Roy, D., Phillips, L., and Beaulieu, C. (2005), ‚ÄúDiÔ¨Äusion
tensor imaging of neurodevelopment in children and young adults,‚Äù NeuroImage, 26,
1164‚Äì1173.
Snook, L., Plewes, C., and Beaulieu, C. (2007), ‚ÄúVoxel based versus region of interest
analysis in diÔ¨Äusion tensor imaging of neurodevelopment,‚Äù NeuroImage, 34, 243‚Äì252.
Song, S. K., Sun, S. W., Ju, W. K., Lin, S. J., Cross, A. H., and Neufeld, A. H. (2003),
‚ÄúDiÔ¨Äusion tensor imaging detects and diÔ¨Äerentiates axon and myelin degeneration in
mouse optic nerve after retinal ischemia,‚Äù Neuroimage, 20, 1714‚Äì1722.
Spellman, P., Sherlock, G., Zhang, M. Q., Iyer, V. R., Anders, K., Eisen, M., Brown,
P., Botstein, D., and Futcher, B. (1998), ‚ÄúComprehensive identiÔ¨Åcation of cell cycle-
regulated genes of the yeast saccharomyces cerevisiae by microarray hybridization,‚Äù
Molecular Biology of Cell, 9, 3273‚Äì3297.
Sun, Y., Zhang, W., and Tong, H. (2007), ‚ÄúEstimation of the covariance matrix of
random eÔ¨Äects in longitudinal studies,‚Äù Ann. Statist., 35, 27952814.
Taguchi, Y. and Oono, Y. (2005), ‚ÄúRelational patterns of gene expression via non-metric
multidimensional scaling analysis,‚Äù Bioinformatics, 21, 730‚Äì740.
123

Teh, Y. W., Jordan, M. I., Beal, M. J., and Blei, D. M. (2006), ‚ÄúHierarchical Dirichlet
processes,‚Äù Journal Of The American Statistical Association, 101, 1566‚Äì1581.
Thompson, W. K. and Rosen, O. (2008), ‚ÄúA Bayesian model for sparse functional
data,‚Äù Biometrics, 64, 54‚Äì63.
Tian, L., Zucker, D., and Wei, L. J. (2005), ‚ÄúOn the Cox model with time-varying
coeÔ¨Écients,‚Äù J Am Statist Assoc, 100, 172183.
Torgerson, W. (1952), ‚ÄúMultidimensional scaling: I. Theory and method,‚Äù Psychome-
trika, 17, 401‚Äì419, 10.1007/BF02288916.
Tuch, D. S., Reese, T. G., Wiegell, M. R., Makris, N., Belliveau, J. W., and Wedeen,
V. J. (2002), ‚ÄúHigh angular resolution diÔ¨Äusion imaging reveals intravoxel white
matter Ô¨Åber heterogeneity,‚Äù Magnetic Resonance in Medicine, 48, 577‚Äì582.
Walker, S. G. (2007), ‚ÄúSampling the Dirichlet mixture model with slices,‚Äù Communi-
cations in Statistics - Simulation and Computation, 36, 45‚Äì54.
Wang, L., Chen, G., and Li, H. (2007), ‚ÄúGroup SCAD regression analysis for microarray
time course gene expression data,‚Äù Bioinformatics, 23, 1486‚Äì1494.
Wang, L. and Dunson, D. (2010), ‚ÄúSemiparametric Bayes multiple testing: Applications
to tumor data,‚Äù Biometrics, 66, 493‚Äì501.
Wang, L., Li, H., and Huang, J. Z. (2008), ‚ÄúVariable selection in nonparametric varying-
coeÔ¨Écient models for analysis of repeated measurements,‚Äù J. Amer. Statist. Assoc.,
103, 1556‚Äì1569.
Wang, Y. X. and Taylor, J. M. G. (1995), ‚ÄúInference for smooth curves in longitudinal
data with application to an aids clinical trial,‚Äù Statistics in Medicine, 14, 1205‚Äì1218.
Watson, D. and Clark, L. A. (1997), ‚ÄúThe measurement and mismeasurement of mood:
Recurrent and emergent issues,‚Äù Journal of Personality Assessment, 86, 267‚Äì296.
Watson, D., Clark, L. A., and Tellegen, A. (1988), ‚ÄúDevelopment and validation of brief
measures of positive and negative aÔ¨Äect: The PANAS scales,‚Äù Journal of Personality
and Social Psychology, 54, 1063‚Äì1070.
Watson, D. and Tellegen, A. (1985), ‚ÄúToward a consensual structure of mood,‚Äù Psy-
chological Bulletin, 98, 219‚Äì235.
Whitcher, B., Wisco, J. J., Hadjikhani, N., and Tuch, D. S. (2007), ‚ÄúStatistical group
comparison of diÔ¨Äusion tensors via multivariate hypothesis testing,‚Äù Magnetic Reso-
nance in Medicine, 57, 1065‚Äì1074.
Wiggins, J. S., Steiger, J. H., and Gaelick, L. (1981), ‚ÄúEvaluating circumplexity models
in personality data,‚Äù Multivariate Behavioral Research, 16, 263289.
124

Winnett, A. and Sasieni, P. (2003), ‚ÄúIterated residuals and time-varying covariate ef-
fects in Cox regression,‚Äù J R Statist Soc B, 65, 473488.
Woolrich, M., Jenkinson, M., Brady, J., and Smith, S. (2004), ‚ÄúFully bayesian spa-
tiotemporal modeling of fMRI data,‚Äù IEEE Trans. Med. Imaging, 23, 213 ‚Äì 231.
Wu, C. O., Chiang, C. T., and Hoover, D. R. (1998), ‚ÄúAsymptotic conÔ¨Ådence regions
for kernel smoothing of a varying-coeÔ¨Écient model with longitudinal data,‚Äù J. Amer.
Statist. Assoc., 93, 13881402.
Wu, H. L. and Liang, H. (2004), ‚ÄúBackÔ¨Åtting random varying-coeÔ¨Écient models with
timedependent smoothing covariates,‚Äù Scandinavian Journal of Statistics, 31, 3‚Äì19.
Wu, H. L. and Zhang, J. T. (2002), ‚ÄúLocal polynomial mixed-eÔ¨Äects models for longi-
tudinal data,‚Äù J. Amer. Statist. Assoc., 97, 883‚Äì897.
‚Äî (2006), Nonparametric Regression Methods for Longitudinal Data Analysis, Hobo-
ken, New Jersey.: John Wiley & Sons, Inc.
Xia, Y. and Li, W. K. (1999), ‚ÄúOn the estimation and testing of functional-coeÔ¨Écient
linear models,‚Äù Statistica Sinica, 9, 735758.
Yu, Z. and Lin, X. (2008), ‚ÄúNonparametric regression using local kernel estimating
equations for correlated failure time data,‚Äù Biometrika, 95, 123137.
Yu, Z. S. and Lin, X. H. (2010), ‚ÄúSemiparametric regression with time-dependent co-
eÔ¨Écients for failure time data analysis,‚Äù Statistica Sinica, 20, 853‚Äì869.
Yushkevich, P. A., Zhang, H., Simon, T., and Gee, J. C. (2008), ‚ÄúStructure-speciÔ¨Åc
statistical mapping ofwhite matter tracts,‚Äù Neuroimage, 41, 448‚Äì461.
Zhang, W. and Lee, S. Y. (2000), ‚ÄúVariable bandwidth selection in varying-coeÔ¨Écient
models,‚Äù Journal of Multivariate Analysis, 74, 116134.
Zhang, W., Lee, S. Y., and Song, X. (2002), ‚ÄúLocal polynomial Ô¨Åtting in semivarying
coeÔ¨Écient models,‚Äù J. Multivar. Anal., 82, 166188.
Zhang, W. and Steele, F. (2004), ‚ÄúA semiparametric multilevel survival model,‚Äù Journal
of the Royal Statistical Society C, 53, 387404.
Zhu, H., Kong, L., Li, R., Styner, M., Gerig, G., Lin, W., and Gilmore, J. H. (2011),
‚ÄúFADTTS: Functional analysis of diÔ¨Äusion tensor tract statistics,‚Äù NeuroImage, 56,
1412 ‚Äì 1425.
Zhu, H. T., Cheng, Y. S., Ibrahim, J. G., Li, Y. M., Hall, C., and Lin, W. L. (2009), ‚ÄúIn-
trinsic regression models for positive deÔ¨Ånitive matrices with applications in diÔ¨Äusion
tensor images,‚Äù Journal of the American Statistical Association, 104, 1203‚Äì1212.
125

Zhu, H. T., Styner, M., Tang, N. S., Liu, Z. X., Lin, W. L., and Gilmore, J. (2010),
‚ÄúFRATS: Functional regression analysis of DTI tract statistics,‚Äù IEEE Transactions
on Medical Imaging, 29, 1039‚Äì1049.
Zhu, H. T., Xu, D., Amir, R., Hao, X., Zhang, H., Alayar, K., Ravi, B., and Peterson,
B. (2006), ‚ÄúA statistical framework for the classiÔ¨Åcation of tensor morphologies in
diÔ¨Äusion tensor images,‚Äù Magnetic Resonance Imaging, 24, 569‚Äì582.
Zhu, H. T., Zhang, H. P., Ibrahim, J. G., and Peterson, B. G. (2007), ‚ÄúStatistical
analysis of diÔ¨Äusion tensors in diÔ¨Äusion-weighted magnetic resonance image data
(with discussion),‚Äù Journal of the American Statistical Association, 102, 1085‚Äì1102.
Zucker, D. M. and Karr, A. F. (1990), ‚ÄúNonparametric survival analysis with time-
dependent covariate eÔ¨Äects:
A penalized partial likelihood approach,‚Äù The Ann
Statist, 18, 329353.
126

