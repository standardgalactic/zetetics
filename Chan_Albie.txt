Exotic Circuits for Enhanced Quantum
Algorithms and Computation
by
Albie Chan
A thesis
presented to the University of Waterloo
in fulfillment of the
thesis requirement for the degree of
Master of Science
in
Physics (Quantum Information)
Waterloo, Ontario, Canada, 2023
© Albie Chan 2023

Author’s Declaration
This thesis consists of material all of which I authored or co-authored: see Statement
of Contributions included in the thesis. This is a true copy of the thesis, including any
required final revisions, as accepted by my examiners.
I understand that my thesis may be made electronically available to the public.
ii

Statement of Contributions
This thesis consists of material adapted from two manuscripts (arXiv:2305.19200 and
arXiv:2304.08529) submitted for publication, in which I was lead and contributing author
respectively.
Chapter 2: This chapter is based on arXiv:2305.19200 (lead author: A. Chan). I
produced all VQE simulation results shown in Figs. 2.3, 2.4, 2.6, and 2.7, and all supple-
mentary data presented in App. C. I designed and constructed all of Figs. 2.1–2.7. Fig. 2.1
was designed with assistance from Z. Shi, who also provided invaluable support with per-
forming simulations involving the IBM Quantum platform. C. Muschik conceived design
ideas for Figs. 2.1, 2.3, and 2.6, and provided iterative feedback during their construction.
Chapter 3: This chapter is an independent, abridged writeup based on arXiv:2304.08529
(lead author: J.M. Ramiro). The material in this chapter adapted ideas and concepts
from the manuscript and supplementary notes by J.M. Ramiro, L. Dellantonio, and C.
Muschik. I produced all numerical results involving the coherent gate-based (Fig. 3.3)
and measurement-based (Fig. 3.5) protocols as an independent verification of the results
presented in the manuscript. The measurement-based protocol described in Sec. 3.3.1 and
App. H is a modified version of the original protocol, which I developed following discus-
sions with Z. Shi. J.M. Ramiro, L. Dellantonio, and W. Dür formulated the theory behind
both gate-based (Sec. 3.2.1) and measurement-based (Sec. 3.3.1) protocols. L. Dellanto-
nio originally derived Eqs. (3.17) and (3.23). I designed and constructed Figs. 3.3 and
3.5. Figs. 3.1, 3.2, and 3.4 were designed by J.M. Ramiro and L. Dellantonio, and are
reproduced in this thesis with kind permission from the aforementioned authors.
Contributions to other parts of the thesis are as follows:
C. Muschik and Z. Shi provided substantial input on the introduction (Chapter 1)
and conclusions (Chapter 4), and contributed key ideas discussed therein.
I designed and constructed Figs. A.1, B.1, B.2, F.1, F.2, and G.1, and performed all
equation derivations shown in the appendixes.
Appendix D: The procedure for error analysis was proposed by Z. Shi during one of
many impromptu whiteboard discussions.
Appendix F: The fast_wolf algorithm was formulated by W. Dür and first employed
in the MB-VQE scheme introduced in Phys. Rev. Lett. 126, 220501. The pseudocode
shown (Alg. 1) is based on Z. Shi’s implementation of the algorithm.
All chapters and appendixes in this thesis incorporated helpful suggestions and feedback
from L. Dellantonio, Z. Shi, and C. Muschik.
iii

Abstract
Quantum circuits play an essential role in many disciplines of quantum information
science. They can not only be represented in the traditional gate-based (GB) paradigm,
but also an alternative measurement-based (MB) paradigm.
The latter begins from a
resource state possessing many entangled ancillary qubits, and proceeds via mid-circuit
measurements of these ancillas. More generally, ancillary qubits feature prominently in
quantum error-correcting schemes, opening up the possibility for exploiting both paradigms
on an equal footing. In this thesis, we explore how circuits designed with such features
(referred to as “exotic”) can be employed to enhance the quality of quantum algorithms
and their general computations.
First, we examine variational quantum eigensolvers (VQEs) – a highly successful class
of quantum algorithms for simulating physical models on quantum computers. Initially
developed as a GB technique, they were recently extended to the MB model which en-
abled a first paradigm shift in the field.
Our work seeks to push the integration and
design frontiers of the VQE further by blending aspects of the GB and MB paradigms
to form hybrid variational circuits. This can facilitate the design of a problem-informed
variational ansatz, while enabling the efficient implementation of many-body Hamiltonians
on noisy-intermediate-scale-quantum (NISQ) devices. To test the effectiveness of our ap-
proach, we demonstrate our hybrid circuits on IBM superconducting quantum computers
by performing VQEs involving the perturbed planar code, Z2 lattice gauge theory, quantum
chromodynamics, and the lithium hydride molecule.
Second, we propose a technique to mitigate the problem of noise and decoherence in
quantum computation, which affect VQEs and many other quantum algorithms. Specifi-
cally, we consider circuits containing auxiliary registers and perform identical noisy com-
putations on them in a superimposed fashion. We describe a concrete, scalable protocol for
executing these circuits in both the GB and the MB paradigms, comparing and contrasting
the mechanisms in which noise impacts them. Through analytical and numerical analyses,
we illustrate how performing circuits in this manner leads to a noise interference process
that yields improvements in computational fidelity.
The works discussed in this thesis constitute novel applications of exotic circuits that
are both resource-efficient and versatile in nature. Together, these qualities can pave the
way for more reliable quantum algorithms and computations on NISQ hardware.
iv

Acknowledgements
“Complacency is the forerunner of mediocrity. You can never work too hard on attitudes,
effort and technique.” – Don Meyer
I would like to extend my sincere gratitude to those who have supported me throughout
my MSc program at Waterloo. As an newcomer to quantum physics, I knew that embarking
on such a journey would be rife with unexpected challenges and learning curves. However,
these individuals helped bring a human side to a uncompromising discipline, and that has
made it all the more bearable.
First, to my research collaborators from IQC and Innsbruck: Luca Dellantonio, Zheng
Shi, Jorge Miguel-Ramiro, and Wolfgang Dür. Thank you for giving me the opportunity
to work on two fantastic projects, as well as a forum to present and express my ideas.
I thoroughly enjoyed our often lengthy, but friendly discourses on variational algorithms
and quantum information theory. They were full of interesting twists and nothing short of
enlightening. Many thanks for your thoughtful suggestions and feedback, and for working
tirelessly to steer progress in the right direction. I would also like to acknowledge the
other group members – Jinglei, Yasar, Jan, Victor, and Abhijit for being such a positive
presence, and my committee members Chris Wilson and Thomas Jennewein for taking the
time to hear about my work. It’s been a privilege getting to know you all.
A warm, heartfelt acknowledgement goes to my supervisor, Christine Muschik, who
accepted me under her wing despite my knowing little about high-energy physics or lattice
gauge theories. I have learned much about these topics from her, and I could not be more
thankful for the patience, guidance, and understanding she has shown me. Her attention
to detail has also inspired me to strive for excellence in all my endeavours. I want to
thank her for being a terrific group leader and for staying on top of things when it came
to critical deadlines and paper submissions. I especially admire her knack for conceiving
brilliant “rescue” plans whenever we seemed to hit brick walls.
Further acknowledgement goes to Emma Barlett and Erica Boland for being great
admin supports at IQC. Their efforts to facilitate meetings and other logistics have helped
me tremendously during hectic times. They are both exceptional individuals I could always
count on.
Lee, Neil, and Russell – thank you for supporting my decision to pursue grad studies.
To my parents and my extended family – thanks for all the love and support you’ve given
me. Terence, without your timely advice and encouragement, I would not be where I am
today. And finally, to everyone else I’ve gotten to know over the past eight years, thanks
for being part of a budding stage in my career.
v

Table of Contents
List of Figures
ix
List of Tables
xi
1
Introduction
1
2
Merging Computational Models for Hybrid Variational Quantum Eigen-
solvers
3
2.1
Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6
2.2
Protocol design: ansatz modification
. . . . . . . . . . . . . . . . . . . . .
7
2.3
2D planar code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
2.3.1
VQE demonstration
. . . . . . . . . . . . . . . . . . . . . . . . . .
11
2.3.2
Further analysis and VQE demonstrations . . . . . . . . . . . . . .
11
2.4
Protocol implementation: Pauli gadgets . . . . . . . . . . . . . . . . . . . .
15
2.5
VQE demonstrations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
17
2.5.1
Particle physics: quantum chromodynamics in 1D . . . . . . . . . .
17
2.5.2
Lattice gauge theory: pure Z2 . . . . . . . . . . . . . . . . . . . . .
19
2.5.3
Quantum chemistry: lithium hydride . . . . . . . . . . . . . . . . .
20
2.5.4
Extension to multiple gadgets . . . . . . . . . . . . . . . . . . . . .
20
2.6
Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
24
vi

3
Superimposing Quantum Operations for Effective Noise Mitigation
25
3.1
Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
28
3.1.1
Steinspring, Kraus and process matrix representation . . . . . . . .
28
3.1.2
Principle for fidelity enhancement . . . . . . . . . . . . . . . . . . .
30
3.1.3
Figures of merit . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
31
3.2
Enhanced gate-based computation . . . . . . . . . . . . . . . . . . . . . . .
33
3.2.1
Working protocol . . . . . . . . . . . . . . . . . . . . . . . . . . . .
33
3.2.2
Probabilistic approach . . . . . . . . . . . . . . . . . . . . . . . . .
36
3.2.3
ϵ-deterministic approach . . . . . . . . . . . . . . . . . . . . . . . .
37
3.2.4
Protocol example . . . . . . . . . . . . . . . . . . . . . . . . . . . .
38
3.2.5
Performance and analysis
. . . . . . . . . . . . . . . . . . . . . . .
41
3.3
Enhanced measurement-based computation . . . . . . . . . . . . . . . . . .
46
3.3.1
Working protocol . . . . . . . . . . . . . . . . . . . . . . . . . . . .
46
3.3.2
Performance and analysis
. . . . . . . . . . . . . . . . . . . . . . .
47
3.4
Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
50
4
Conclusions and Outlook
51
References
53
APPENDICES
66
A Overview of Measurement-Based Quantum Computing
67
B Hybrid VQE Demonstrations – Methods and Techniques
73
C Hybrid VQE Demonstrations – Supplementary Information
80
D Hybrid VQE Demonstrations – Error Analysis
86
E Perturbative Analysis of the M × N Planar Code
89
vii

F The fast_wolf Algorithm
93
G Verifying Equivalence of the GB and MB Paradigms
99
H Performing Coherent MBQC
105
viii

List of Figures
2.1
Enhancing VQEs by combining MB and GB principles to form hybrid ansatz
circuits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5
2.2
Example of a graph state and its typical connectivity . . . . . . . . . . . .
8
2.3
VQE demonstration of ansatz modification on IBM Quantum systems, ap-
plied to the perturbed planar code (PC)
. . . . . . . . . . . . . . . . . . .
10
2.4
VQE demonstrations of ansatz modification on fake IBM backends, applied
to the perturbed planar code (PC)
. . . . . . . . . . . . . . . . . . . . . .
12
2.5
Discretizing quantum chromodynamics on a one-dimensional lattice . . . .
18
2.6
VQE demonstrations of hybrid ansatz circuits on IBM Quantum systems,
involving a single Pauli gadget . . . . . . . . . . . . . . . . . . . . . . . . .
22
2.7
Applying multiple Pauli gadgets to improve VQE accuracy . . . . . . . . .
23
3.1
Conceptual illustration of the fidelity enhancement protocol
. . . . . . . .
27
3.2
Schematic representation of the GB protocol for fidelity enhancement . . .
32
3.3
Numerical performance of the coherent gate-based (GB) protocol in miti-
gating various noisy scenarios, with variable number of superposition branches 42
3.4
Schematic representation of the MB protocol for fidelity enhancement . . .
45
3.5
Numerical performance of the coherent measurement-based (MB) protocol
in mitigating various noisy scenarios, with variable number of superposition
branches . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
48
A.1 MB pattern for ˆZ⊗3(θ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
70
B.1 Complete workflow for the numerical VQE program . . . . . . . . . . . . .
77
ix

B.2 Sample dynamic circuit performed in the Z2 VQE demonstration . . . . . .
78
F.1
LC-reduced graph for the RY (θ)–CZ modified 1 × 1 PC, with attached
connector qubits
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
96
F.2
Schematic diagram of the fast_wolf algorithm applied to the RY (θ)–CZ
modified 1 × 1 PC, with arbitrary non-Clifford inputs . . . . . . . . . . . .
98
G.1 MB pattern for RY (θ)–CZ, obtained by concatenating smaller patterns
corresponding to each operation in Eq. (G.3) . . . . . . . . . . . . . . . . .
100
x

List of Tables
3.1
Sample results after performing the gate-based protocol for fidelity enhance-
ment, before unitary optimization . . . . . . . . . . . . . . . . . . . . . . .
39
3.2
Sample results after performing the gate-based protocol for fidelity enhance-
ment, after unitary optimization . . . . . . . . . . . . . . . . . . . . . . . .
40
C.1 Reduced 4-qubit Hamiltonian for the LiH molecule
. . . . . . . . . . . . .
81
C.2 Optimized energies, operator expectation values, fidelities, and errors for
the Z2 VQE demonstration . . . . . . . . . . . . . . . . . . . . . . . . . . .
82
C.3 Optimized energies, operator expectation values, fidelities, and errors for
the QCD VQE demonstration . . . . . . . . . . . . . . . . . . . . . . . . .
83
C.4 Optimized energies, fidelities, and errors for the LiH VQE demonstration .
84
C.5 Optimized energies and errors for the 2 × 1 PC VQE demonstration . . . .
84
C.6 Initial and final (optimized) variational parameters for each VQE demon-
stration
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
85
xi

Chapter 1
Introduction
Quantum circuits are a core ingredient for describing quantum computations (QC) and
their associated operations [1]. They have been instrumental to the development of funda-
mental concepts in quantum algorithms, cryptography, and communication [1]. Quantum
circuits are conventionally expressed in the gate-based (GB)1 paradigm, where a sequence
of black-box unitaries act on a target state of interest. Additionally, they may incorporate
non-unitary measurements during the qubit readout stage. These measurements are no-
table for having no analogue in classical circuits, and highlight the probabilistic nature of
quantum-mechanical systems [1].
While GB circuits cast measurements in a supporting role, Raussendorf, Browne, and
Briegel [2] proposed a computing approach that relies primarily on measurements. Known
as the one-way scheme, it employs the measurement-based (MB) paradigm [3, 4] and per-
forms computations using an entangled cluster or graph state (containing ancillary qubits)
instead of unitary gates. Here, projective measurements of the ancillas drive the computa-
tion forward and are made possible by the correlations existing between them. Despite its
irreversibility, MB-QC provides a convenient realization on platforms adept at generating
large entangled clusters, particularly optical lattices and solid-state systems [2, 5]. These
have proved useful in applications involving multipartite systems such as quantum com-
munication [6], blind quantum computation [7], and quantum error correction with surface
codes [8]. On the other hand, the theoretical description of MB-QC employs powerful con-
cepts from graph theory and the stabilizer formalism, enabling one to express it in both
graph and circuit languages. Interestingly, their circuit representation possesses elements
1Although the terms “gate-based” and “circuit-based” are often used synonymously, we use the former
throughout since the measurement-based paradigm is also expressible in terms of circuits (albeit less
frequently than clusters or graphs).
1

that are uncommon in standard computing applications thus far, including mid-circuit
measurements, and conditional operations. Yet remarkably, they maintain a direct corre-
spondence with GB circuits, with the existence of well-known techniques (e.g. phase-map
decomposition [9], ZX-calculus [10]) for translating between the paradigms. Thus, the MB
paradigm may be regarded as a alternative perspective for harnessing quantum computing
power, with its own unique circuit elements and practical considerations.
Aside from MB-QC, the use of auxiliary registers (wires) in a circuit also carries sig-
nificance in quantum information theory. A well-known example is that of quantum error-
correcting codes [8, 11, 12], where multiple physical qubits are needed to construct a single
fault-tolerant logical qubit. The auxiliary registers are entangled with the input state and
then measured to obtain the syndrome of possible errors, such that they may be detected
and corrected according to the measurement outcomes. On the other hand, quantum error
mitigation in the NISQ era [13, 14] remains the more practical approach to leveraging cur-
rent progress in quantum hardware development. While not all error mitigation techniques
rely on auxiliary registers, entanglement purification offers us some inspiration [15, 16]: by
employing one of the two low-fidelity Bell pairs as auxiliary systems, we can probabilisti-
cally increase the entanglement of the other pair. One may easily imagine the same idea
being applied to the error mitigation problem.
It is apparent that the concepts of MB-QC, graph states, mid-circuit measurements,
and auxiliary qubits suggest new, “exotic” possibilities for quantum circuits. Given this
flexibility, it is natural to ask whether these features carry any benefits, for instance in
enhancing quantum algorithms or general computations. This is precisely the question
investigated in this thesis, as we examine two distinct applications of exotic circuits. In
Chapter 2, we formulate these circuits as ansätze (trial states) for variational quantum
eigensolvers (VQEs), a well-known quantum-classical algorithm used to study low-lying
energy states. Specifically, we blend aspects of the GB and MB computational models
within these ansätze in various ways, and demonstrate how such techniques can yield
a more versatile approach to performing VQEs from both design and implementation-
level standpoints. In Chapter 3, we present a more abstract formulation of exotic circuits
in the context of noise analysis. Here, we show how coherently superimposing multiple
instances of a noisy computation can lead to consistent reductions in the overall noise
level, and hence improved performance.
Akin to the first approach, we showcase how
these superimposed circuits may be designed in both the GB and MB paradigms, while
highlighting subtle differences in the way noise processes act on them. Finally, in Chapter
4, we draw conclusions based on the performance and viability of the exotic circuits, and
look ahead to future areas of exploration where they may play a substantial role.
2

Chapter 2
Merging Computational Models for
Hybrid Variational Quantum
Eigensolvers
Many hard problems in physics require the simulation of complex Hamiltonians. Since
their computational cost often renders classical methods intractable, quantum algorithms
are required to obtain accurate solutions. However, these algorithms are curtailed by NISQ
devices that are limited in both the number of qubits and the attainable circuit depths
[17]. Since then, research efforts aimed at reducing requirements have focused on the class
of quantum-classical algorithms. They employ quantum and classical processors working
together in a feedback loop to approximate solutions numerically. One such algorithm
is known as the variational quantum eigensolver (VQE), which determines a system’s
low-lying energy states via the classical optimization of a variational ansatz (trial state)
[18, 19, 20]. This can provide useful information toward analyzing the system’s quantum
mechanical properties, including its finite-temperature behaviour and phase transitions
[21, 22] Consequently, VQEs have been successful in areas spanning quantum chemistry
[23], materials science [24, 25] and high-energy physics [21, 26, 27, 28, 29, 30].
Such
developments have enabled opportunities for NISQ devices to tackle problems that would
otherwise be out of reach.
Current demonstrations of VQEs are GB, in which the ansatz is expressed as a sequence
of unitary black-box operations. However, as proposed in Ref. [22], VQEs can also operate
using MB-QC (see App. A). The resulting algorithm, known as MB-VQE, expresses the
ansatz as an entangled resource state [2, 31, 32, 33] which undergoes computation via
a series of local rotations and measurements [22]. As an alternative, entirely gate-free
3

concept, MB-VQEs permit the use of VQEs on platforms for which the implementation of
entangling gates is challenging. A unique feature of performing MB-QC and MB-VQE is
the measurements that condition subsequent operations on their specific outcomes. These
intermediate measurements are crucial to performing MB-QC deterministically, since they
implement corrective operations that combat the random nature of measurement [2, 33].
In this chapter, we introduce hybrid VQEs that merge the strengths of the MB and GB
paradigms for circuit implementations. In particular, we leverage current quantum hard-
ware developments that have enabled fast, high-fidelity mid-circuit measurements on su-
perconducting qubits, trapped ions, and ultracold neutral atoms [34, 35, 36, 37, 38, 39, 40].
This allows us to incorporate MB elements within these architectures, which predominately
use the GB paradigm in their existing applications. We demonstrate the capabilities of our
approach by performing a series of VQE simulations on IBM superconducting quantum
computers. In doing so, we address two major challenges toward realizing effective VQEs
– namely, the design of a good variational ansatz, and the physical realization of robust
VQEs on NISQ devices.
To address the first challenge, we utilize MB principles to formulate an alternative
approach for designing GB-VQE circuits. The versatility of this approach is seen when
applied to problems with graph representations (MB patterns), as it permits one to access
graph-inspired variational families directly in the GB formalism. It entails modifying each
entangling gate with suitable operations [Fig. 2.1(a)], such that the equivalent graph is
modified in a variationally tunable way.
We apply this idea to the perturbed planar
code (PC), as an example of how an effective GB-VQE ansatz can be designed based on
an initial graph state. More broadly, this design tool can be useful when formulating a
problem-informed VQE ansatz.
For the second challenge, we exploit MB elements that employ parameterized ancilla
qubits and conditional measurements, and integrate them within VQE circuits. Here, the
parameters dictate the choice of a measurement basis as opposed to rotations in parameter
space, thus lending a unique variational aspect. We demonstrate this idea via MB patterns
known as “Pauli gadgets”, which realize n-body interaction terms as shown in Fig. 2.1(b).
Such terms appear in many target Hamiltonians as a consequence of the underlying physics,
particularly in models from condensed matter physics or in gauge theories. By realizing
such interactions via measurements, these gadgets are implemented efficiently via the num-
ber of entangling operations, a current bottleneck on NISQ platforms. In conjunction with
local rotation gates, the Pauli gadget gives rise to novel VQEs that merge GB and MB
paradigms in their circuits. We perform VQE demonstrations of these “hybrid” circuits for
1D quantum chromodynamics, Z2 lattice gauge theory, and the lithium hydride molecule,
showcasing their compact depth and effectiveness across a broad range of applications.
4

GB-MB Connector
(a)
LC
RX
RY
RZ
IN + OUT
M-R( )휃
CZ-Edge
LC
GB
CZ
(b)
θ1
θ3, θ4, θ5
θ3
θ4
θ5
MB
Ansatz Modification
θ1
Variational Measurements
≡
: -body terms 
̂ℋn
̂풫⊗n(θ) = exp(i θ
2
̂풫1 ⊗
̂풫2… ⊗
̂풫n)
 
̂풫j ∈{ ̂X, ̂Y, ̂Z}, ∀j
Condensed Matter Physics, Quantum 
Chemistry, High-Energy Physics, …
θ2
⃗θ
…
1
2
n −1
n
| + ⟩
1
2
3
4
5
1
2
3
4
5
M-R(𝜃)
FIG. 2.1: Enhancing VQEs by combining MB and GB principles to form hybrid ansatz
circuits. (a) Based on MB principles, gate modification (wavy lines with arrows) allows access to
graph-inspired variational state families in the GB formalism. Starting from a base circuit derived
from a graph state (MB pattern), we dress each entangling gate with unitary operations that tune
the circuit’s entanglement structure. (b) The Pauli gadgets ˆP⊗n(θ) are MB patterns (graphs)
that permit a VQE implementation of a hybrid ansatz on NISQ devices. Each gadget, when
combined with local rotations, realizes an n-body interaction term in the target Hamiltonian. The
parameterized ancilla qubits (in orange) provide a variational aspect by tuning the measurement
bases used to perform MB-QC on them. These compact gadgets provide resource advantages in the
number of entangling operations, and allows one to efficiently realize VQE circuits of arbitrary
complexity.
Grey, teal, and red arrows denote the overall workflow, classical–quantum VQE
feedback loop, and corrective operations (i.e. byproduct Pauli operators ˆUΣ) on the measured
qubits respectively. On circuit platforms such as IBM Quantum, MB elements are implemented
dynamically with mid-circuit measurements.
5

2.1
Background
In this section, we summarize the relevant concepts underlying hybrid circuits and VQEs.
In its simplest form, a VQE approximates the ground state (GS) energy E0 of a target
Hamiltonian ˆH with a parameterized ansatz state |ψa(⃗θ)⟩. The traditional (GB) VQE
represents the ansatz as a circuit whose gates are parameterized by ⃗θ. From the ansatz, the
quantum processor computes the mean energy E = ⟨ψa| ˆH|ψa⟩, which a classical optimizer
minimizes by updating ⃗θ [19]. The quantum processor then reevaluates the ansatz and the
process repeats iteratively until a stopping condition for convergence (in E) is attained. A
schematic of the VQE algorithm is shown in App. B.
The accuracy of a VQE in approximating E0 relies heavily on the specific ansatz chosen.
Despite the existence of well-established techniques (e.g. domain-specific and heuristics
[41]) to formulate the ansatz, they are often beset by practical limitations. These include
a susceptibility to barren plateaus and local minima in the energy landscape [42, 43]. It
is also possible for the GS to be highly entangled, which can result in large circuit depth
requirements. For example, heuristic designs often encapsulate many repeating layers with
all-to-all connectivity [41]. This can pose challenges on NISQ devices due to restrictions
in their quantum volumes and qubit connectivity. Such drawbacks motivate the use of
our hybrid VQE approaches, which present a contrast through efficient ansatz design and
implementation methods.
MB elements (patterns) process quantum information via the MB-QC protocol, which
treats a resource state as a cluster or graph connecting a set of input, ancilla, and out-
put qubits.
The computation proceeds as a series of projective measurements on the
resource in the eigenbases of the Pauli operators ˆX, ˆY , ˆZ, or a rotated basis (e.g. R(θ) =
(|0⟩± eiθ|1⟩)/
√
2). Owing to the random nature of measurement, corrective operations
(depending on the measurement outcomes) are applied to ensure the output result is al-
ways the same. These encompass byproduct operators ˆUΣ ∈{ˆI, ˆX, ˆZ, ˆX ˆZ, ˆZ ˆX} acting on
each output and angle adaptations R(θ) →R(±θ) for qubits measured in rotated bases.
Together, the entangling, measurement, and corrective operators form an MB-QC realizing
a specific unitary.
On IBM Quantum systems, MB-QC is performed on circuits using the dynamic mode
of execution. It performs the projective measurements as mid-circuit measurements, and
permits the application of corrective operations conditioned on their outcomes. By doing
so, we avoid the necessity of having to postselect non-corrective outcomes (e.g. all ‘0’).
This scales inefficiently since one would require on average 2mN measurement samples
(shots) to retain only N samples, where m is the number of mid-circuit measurements. We
refer to Apps. A and B for further details.
6

2.2
Protocol design: ansatz modification
Here, we describe an MB-inspired tool for designing GB-VQE algorithms. It constructs
VQE circuits by creating a problem-tailored ansatz and introducing variational modifica-
tions to its entangling operations, permitting one to access a physics-informed variational
family. To understand the working principle, we first consider the tool on the level of graph
states. These states are an equivalent representation of multi-qubit Pauli stabilizer states,
being the +1 eigenvector of the correlation operator:
ˆSn = ˆXn
Y
k
ˆZk,
(2.1)
where k are the nearest neighbour qubits (vertices) of qubit n. Eq. (2.1) is important as it
describes the connectivity of graph states – each qubit n is stabilized by ˆX and the qubits
k it is connected to are each stabilized by ˆZ (e.g. realizing a CZ interaction). It follows
that when all qubits are initialized in |+⟩, a CZ-edge between qubits n and k will realize
the maximally entangled state:
CZ|+⟩n|+⟩k = |0⟩n|+⟩k + |1⟩n|−⟩k
√
2
.
(2.2)
From Eq. (2.2), we may view graphs as providing the “entanglement structure” (Fig. 2.2)
necessary for MB-QC, which is consumed during qubit measurement. Additionally, their
resource nature suggests that modifications can be made for instance, by attaching other
graph state operations to their edges (see App. A). This novel idea was first explored
in Ref. [22] to create custom ansätze that are highly adept at accessing finer corners of
a system’s Hilbert space (i.e. the states between two perturbative regimes). Provided
that the modifications take place before any destructive measurements, they preserve the
entanglement structure and thus provide an efficient way to generate arbitrarily complex
graphs. These properties were found to be advantageous for problems whose unperturbed
ground states possess a graph representation, such as the toric [44], planar [45, 46], and
color [46] stabilizer codes. In these scenarios, one employs the ground state as the initial
ansatz and performs the edge modifications when it is subjected to local perturbations.
If the edge modifications are unitary, GB circuit analogues of these graphs can be
derived and modified in an equivalent fashion (see App. G). We focus on this version,
known as “gate modification”, where parameterized single- and two-qubit gates are used to
dress each entangling gate (corresponding to a graph edge) to yield the same variational
effect. As an added benefit, one can also enclose the ansatz with local rotation layers, which
can further broaden the range of accessible states without incurring extra entangling gates.
7

1
|+⟩
|+⟩
|+⟩
|+⟩
|+⟩
|+⟩
|+⟩
𝐶𝑍
2
3
4
5
6
7
𝑆'! = 𝑋*!𝑍'"𝑍'#𝑍'$ 
𝑆'% = 𝑋*%𝑍'"𝑍'$𝑍'&
𝑆'" = 𝑍'!𝑍'%𝑋*"𝑍'#𝑍'$
𝑆'# = 𝑍'!𝑍'"𝑋*#𝑍''𝑍'&
𝑆'' = 𝑍'#𝑋*'𝑍'$𝑍'&
𝑆'$ = 𝑍'!𝑍'%𝑍'"𝑍''𝑋*$
𝑆'& = 𝑍'%𝑍'#𝑍''𝑋*&
FIG. 2.2: Example of a graph state and its typical connectivity. The vertices represent
qubits (initialized in the |+⟩state) and the edges represent CZ operations between them. The
graph’s connectivity is fully captured by its n correlation operators ˆS, where the state of each
qubit n is defined as a stabilizer state of ˆSn.
8

2.3
2D planar code
We illustrate the ansatz-modification tool for the planar code (PC), a frequently employed
surface code used for quantum error correction. Such codes are at the core of modern
experimental efforts to realize fault-tolerant computation.
The PC is defined on a M × N lattice with open boundary conditions and qubits
residing on the edges. Each qubit edge produces a gauge field that imposes local symmetries
on each vertex. This results in a partitioning of the Hilbert space into non-overlapping
charge sectors (via the Gauss’ law), signifying the existence of electric field operators.
When stray fields are present (i.e. in experimental settings), these act in the form of local
perturbations on each qubit edge. In 2D, the gauge fields also self-interact over a square
path of links (plaquette) which gives rise to a magnetic field. Consequently, the PC is
stabilized by star ( ˆSs) and plaquette ( ˆPp) operators acting on the neighbouring qubits
(edges) of each vertex s and plaquette p, respectively [44]. The overall PC Hamiltonian
is therefore ˆHPC = ˆH+ + ˆH□+ ˆH△, where ˆH+ and ˆH□are the star and plaquette terms
respectively, and ˆH△is an added perturbation term. These terms are given by:
ˆH+ = −
ns
X
s=1
ˆSs;
ˆH□= −
np
X
p=1
ˆPp;
ˆH△= ξ
nq
X
q=1
ˆZq;
ˆPp =
Y
i∈□p
ˆXi;
ˆSs =
Y
i∈+s
ˆZi.
(2.3)
Here, ns and np are the numbers of vertices and plaquettes, respectively, and ξ is the
strength of the perturbation acting on each of the nq qubits. Furthermore, as shown in
Fig. 2.3(a), i ∈□p (i ∈+s) indicates the set of qubit edges belonging to a plaquette p
(vertex s). The perturbation ˆH△imparts changes to the degree of entanglement in the
ground state, yielding a continuum of states from maximally entangled (for ξ = 0), to
the fully polarized |1⟩⊗nq state (for ξ →∞).
The intermediate regime, in particular,
characterizes imperfect realizations of the error-correcting code [47].
The hybrid ansatz is constructed from a graph state representation of the GS of the PC
Hamiltonian (ξ = 0) [Fig. 2.3(a; i–ii)]. It carries an equivalent [2] circuit representation
consisting of CZ and H gates [Fig. 2.3(a)]. While this state starts the VQE in a suitable
corner of the Hilbert space, the GS of the full Hamiltonian is found by adding modifications
containing variational parameters following the strategy in Fig. 2.1(a). Here, we modify
each CZ gate between qubits m and n so that it realizes CZm,nRY (θ)n [Fig. 2.3(a; iii)]. The
parameter θ effectively tunes the entanglement generated by a CZ gate and the resulting
variable ansatz permits us to approximate the GS for different ξ ∈[0, ∞).
9

1
2
3
4
5
6
7
8
9
11
12
7
IL RL
GML
RL LC
9
10
12
5
4
2
11
IL RL
GML
RL LC
9
8
6
10
…
FIG. 2.3: VQE demonstration of ansatz modification on IBM Quantum systems, ap-
plied to the perturbed planar code (PC). (a) (i) PC depicted as an M ×N lattice in 2D, with
star ( ˆSs) and plaquette ( ˆPp) stabilizer operators. (ii) GS for the M × N PC as a graph, showing
qubits (circles) residing on the edges. (iii) VQE ansatz circuit for the 1 × 1 and 2 × 1 perturbed
PC based on (ii), where each entangling CZ (corresponding to a graph edge) is modified with
an extra RY (θ) gate placed before (magenta line; see Fig. 2.1(a)). IL, RL, GML, and LC stand
for initialization, rotation, gate modification, and local Clifford layers respectively. All LC gates
are Hadamards. (b) VQE results for the modified 2 × 1 perturbed PC acquired on ibm_lagos
and ibm_perth. The exact GS (E0) and VQE (EV QE) energies, relative error (|∆E|/Eg), and
the state fidelity (F) are shown vs. perturbation strength ξ. The exact energies for the first two
excited states (E1 and E2) are also shown for comparison. The relative error is calculated from the
energy difference |∆E| = |EV QE −E0|, expressed in units of the first2 energy gap Eg = E1 −E0.
Shaded grey regions indicate statistical uncertainty on the error. All energies are unitless and may
be expressed in absolute units (e.g. eV, J, Ha) using a scaling factor with appropriate dimensions.
10

2.3.1
VQE demonstration
For the VQE demonstration1 of the PC, we consider two vertical plaquettes (M, N) = (2, 1)
as a non-trivial example of a gate-modified ansatz (i.e. one that is not a simple repetition
of rotation and entanglement layers). It possesses the Hamiltonian given in Eq. (2.4).
We ran the corresponding variational circuit in Fig. 2.3(a; iii) on ibm_lagos and
ibm_perth. The circuit contains 7 qubits and 2 × 7 + 8 = 22 parameters from the gate
modifications and added RY +RX rotation layers. Since a uniform perturbation strength ξ
is employed, the problem symmetry is preserved (App. E) in that qubits on equivalent ver-
tices of the graph (i.e. with similarly positioned neighbours and connections; see Sec. 2.3.2)
are described by the same θ. This enabled a reduction from 22 to 11 parameters.
The data [shown in Fig. 2.3(b)] exhibit close agreement with the GS energies from exact
diagonalization (ED), as confirmed by the small energy differences attained at convergence;
0.091 ≤∆E/Eg ≤0.556, where Eg = E1 −E0 is the exact first energy gap.2 This is also
evidenced by the span of the error bars (see App. D) remaining consistently below E1.
Importantly, the expected system behaviour is recovered as we clearly identify a transition
region at intermediate ξ (∼1) where the total energy crosses over from approximating a
randomly oriented to completely polarized set of spins. These limiting behaviours corre-
spond to the entangled state 1
2(|0⟩⊗7 + |1011010⟩+ |0101101⟩+ |1110111⟩) and separable
state |1⟩⊗7, respectively (see App. E for more details).
2.3.2
Further analysis and VQE demonstrations
We further analyze the ansatz-modification technique by considering other PC lattices
containing multiple plaquettes in both spatial directions.
In addition to the 7-qubit
(M, N) = (2, 1) case studied on a quantum computer (Sec. 2.3.1), we conduct fake back-
end simulations3 for (M, N) = (1, 2) and (2, 2), which require lattices of 7 and 12 qubits
1 Further information regarding the simulation methods and data are presented in Apps. B and C,
respectively. Calibration data (error rates, qubit properties, etc.) corresponding to the IBM Quantum
systems employed are reported in Ref. [48].
2 At ξ = 2, the first excited state is nearly degenerate with the GS (E1 −E0 = 0.120). Therefore, for
a more apt comparison, we employ the second energy gap E2 −E1 instead; see App. C. To indicate that
a different calculation was employed for ξ = 2, we denote the corresponding point with a lighter colour in
the plot of |∆E|/Eg [Fig. 2.3(b)].
3 These backends serve to mimic the behavior of IBM Quantum systems, albeit with more stable
characteristics and simplified noise models [41]. Any simulations involving such backends are performed
entirely on a classical computer.
11

(M, N) = (1, 1)
(M, N) = (1, 2)
(M, N) = (2, 1)
(M, N) = (2, 2)
2
2
2
1
2
1
2
3
2
2
(2 x 2) + (2L - 1)       
params.
(2 x 3) + (4L - 2)             
params.
1
2
2
3
3
(2 x 4) + (6L - 3) params.
1
1
2
2
4
4
(2 x 6) + (12L - 6) params.
5
5
5
5
6
3
4
3
𝛉𝟏
𝛉𝟏
𝛉𝟏
𝜽𝟏
𝜽𝟏
𝜽𝟐𝜽𝟐
𝜽𝟏
𝜽𝟏
𝜽𝟏
𝜽𝟏
𝜽𝟐
𝜽𝟐
𝜽𝟑
𝜽𝟑
𝜽𝟑
𝜽𝟐
𝜽𝟏
𝜽𝟐
𝜽𝟐
𝜽𝟑
𝜽𝟑
𝜽𝟒
𝜽𝟓
𝜽𝟑
𝜽𝟔
𝜽𝟔
𝜽𝟓
𝜽𝟑
𝜽𝟏
𝜽𝟒
𝜽𝟒
𝜽𝟒
𝒒𝟏
𝒒𝟐
𝒒𝟑
𝒒𝟒
𝒒𝟏
𝒒𝟐
𝒒𝟑
𝒒𝟒
𝒒𝟓
𝒒𝟔
𝒒𝟕
𝒒𝟏
𝒒𝟐
𝒒𝟑
𝒒𝟒
𝒒𝟓
𝒒𝟔
𝒒𝟕
𝒒𝟏
𝒒𝟐
𝒒𝟑
𝒒𝟒
𝒒𝟓
𝒒𝟔
𝒒𝟕
𝒒𝟖
𝒒𝟗
𝒒𝟏𝟎
𝒒𝟏𝟏
𝒒𝟏𝟐
1
FIG. 2.4: VQE demonstrations of ansatz modification on fake IBM backends, applied
to the perturbed planar code (PC). (a) The edge-modified graphs used to construct the
gate-modified circuits for the VQE, employing the notation in Fig. 2.1. For (M, N) = (1, 1),
the modified graph is also depicted as an LC-reduced graph (see Apps. A and F), with the
effective edge modifications shown as dotted blue lines and parameterized qubits in orange. The
applied symmetry is represented as follows: qubits with the same number inside their circles
are parameterized with the same angle (in the rotation layers), while each modified CZ-edge
is parameterized with the angle θ shown next to the arrow.
The total number of variational
parameters is also expressed in terms of the number of modification layers L. (b) VQE results for
the perturbed PC, with (M, N) = (1, 2), (2, 1), (2, 2), and the gate modification being RY (θ)–CZ.
Shown are plots of the EoF for CZ(RY (θ))| + +⟩, E vs. perturbation strength ξ, and ∆E/E0 vs.
ξ. The black dashed lines indicate ED GS energies, and all energies are unitless. The backends
used are fake_lagos [(M, N) = (1, 2) and (2, 1)], and fake_guadalupe [(M, N) = (2, 2)] with
5 × 104 measurement shots. The optimizer used is COBYLA with a maximum of 250 iterations.
12

respectively. Furthermore, applying the model symmetry yields 8 and 18 free parame-
ters respectively. Both characteristics are reflected in the graph state for each scenario
[Fig. 2.4(a)]. Their corresponding Hamiltonians are:
ˆH(2,1)
PC = −ˆX1 ˆX2 ˆX3 ˆX4 −ˆX4 ˆX5 ˆX6 ˆX7 −ˆZ2 ˆZ4 ˆZ5 −ˆZ3 ˆZ4 ˆZ6
... −ˆZ1 ˆZ2 −ˆZ1 ˆZ3 −ˆZ5 ˆZ7 −ˆZ6 ˆZ7 + ξ
7
X
i=1
ˆZi;
(2.4)
ˆH(1,2)
PC = −ˆX1 ˆX3 ˆX4 ˆX6 −ˆX2 ˆX4 ˆX5 ˆX7 −ˆZ1 ˆZ2 ˆZ4 −ˆZ4 ˆZ6 ˆZ7
... −ˆZ1 ˆZ3 −ˆZ3 ˆZ6 −ˆZ2 ˆZ5 −ˆZ5 ˆZ7 + ξ
7
X
i=1
ˆZi;
(2.5)
ˆH(2,2)
PC = −ˆX1 ˆX3 ˆX4 ˆX6 −ˆX2 ˆX4 ˆX5 ˆX7 −ˆX6 ˆX8 ˆX9 ˆX11 −ˆX7 ˆX9 ˆX10 ˆX12
... −ˆZ4 ˆZ6 ˆZ7 ˆZ9 −ˆZ3 ˆZ6 ˆZ8 −ˆZ5 ˆZ7 ˆZ10 −ˆZ1 ˆZ2 ˆZ4 −ˆZ9 ˆZ11 ˆZ12
... −ˆZ1 ˆZ3 −ˆZ2 ˆZ5 −ˆZ8 ˆZ11 −ˆZ10 ˆZ12 + ξ
12
X
i=1
ˆZi,
(2.6)
which encompass all plaquette, star, and perturbation operators, with numbers correspond-
ing to the qubit labels in Fig. 2.4(a).
For the choice of modification, we continue to employ the RY (θ)–CZ operation used in
the (M, N) = (2, 1) case. To verify that it fully modifies the degree of entanglement between
connected vertices (qubits), we plot its entanglement of formation (EoF)4 vs. θ when acting
on the input state | + +⟩. As shown in Fig. 2.4(b), we observe a periodic function varying
between zero and one (near one for fake backends).
These values correspond to fully
separable and maximally entangled respectively, which confirms the tunable behavior.
We now present the VQE simulation results on fake_lagos (noisy) and fake_guadalupe
(noiseless). Each scenario was optimized using COBYLA (see App. B), with a maximum
of 250 iterations and 5 × 104 measurement shots. For (M, N) = (1, 2) and (2, 1), fake
backend noise was introduced, while the (M, N) = (2, 2) simulation was performed with-
out noise and utilized L = 1 and 2 modification layers. The VQE circuits employed were
derived from the connectivity of the graph states in Fig. 2.4(a) (see Fig. 2.3(a) for the
(M, N) = (2, 1) circuit). Here, the concept of multiple layers is best understood in the
4As a general measure of entanglement, the EoF for a bipartite mixed state ρAB is calculated as
min[P
ipiE(|ψi⟩)], where the |ψi⟩are pure states derived from all possible spectral decompositions of ρAB
(i.e. P
i pi|ψi⟩⟨ψi|), and E(|ψAB⟩) = −Tr(ρAlog2ρA) = −Tr(ρBlog2ρB) is the entanglement entropy for a
bipartite pure state |ψAB⟩[49].
13

GB paradigm. Specifically, a circuit of L layers involves concatenating 2L−1 modification
operations, which is needed to avoid gate cancellation when θ is a multiple of 2π.
Our use of extra layers serves two purposes. It not only enables the optimization to
access finer corners of the parameter space, but also permits each modification to influence
a larger area of the graph’s entanglement structure. This is particularly important when
adjacent vertical plaquettes are present (M > 1), given the nonlocality of its connections
[Fig. 2.4(a)]. However, these advantages can be greatly offset by hardware noise because
of the increased number of CXs. Thus, it is best to study the effects of multiple layers
in the absence of noise, as we do here. Furthermore, the model symmetry may be applied
separately to each layer, which yields 3 + 2L, 4 + 4L, 5 + 6L, and 6 + 12L total parameters
for (M, N) = (1, 1), (1, 2), (2, 1), and (2, 2) respectively.
The energy plots in Fig. 2.4(b) for (M, N) = (1, 2) and (2, 1) exhibit good agreement
with the exact GS energies in the presence of fake noise (order of relative errors between
10−4 and 10−2), with slightly reduced accuracy in the latter case due to the presence
of adjacent vertical plaquettes.
However, we observe an improved approximation with
L = 2 compared to L = 1 in the noiseless (M, N) = (2, 2) case, which becomes prominent
at ξ ≈1.
This corresponds to the regime where the perturbation begins to strongly
affect the ground state, and therefore requires more variational parameters (i.e. layers) for
an accurate approximation. For a further discussion of the perturbative effects, refer to
App. E.
We remark that any parameterized unitary operation which attains a continuum of
EoF values between zero and one constitutes an effective modification. While this imparts
flexibility toward the circuit design, we emphasize that our specific choice of RY (θ)–CZ
is motivated by the limiting performance factors on IBM Quantum systems, namely the
measurement budget for VQE optimization and CX error rates. These factors are miti-
gated when the modification contains minimal free parameters and entangling operations,
resulting in a less intensive optimization and reduced noise levels respectively. Since qubit
connectivity restrictions on IBM systems often incur additional entangling (SWAP) gates,
our modification also permits a more feasible extension to multiple layers.
14

2.4
Protocol implementation: Pauli gadgets
Next, we consider the implementation of hybrid VQEs, in which GB and MB elements are
incorporated within the same circuit ansatz. To achieve this, we introduce MB patterns
that employ variational measurements on ancillas. Here, the variational parameters ⃗θ are
encoded in the choice of rotated measurement bases. While there exists a variety of MB
techniques [2, 31, 32, 33, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65] that
can be adapted for this purpose, we demonstrate the concept with a class of MB patterns
known as “Pauli gadgets” ( ˆP⊗n). They consist of n vertices (serving as input and output)
connected to a single vertex measured in the rotated basis R(θ) [Fig. 2.1(b)]. Through a
series of gadgets and rotation gates, one can readily design a hybrid ansatz circuit that
generates multi-qubit Pauli interactions of the form:
n
O
i=1
ˆPi;
ˆP ∈{ˆI, ˆX, ˆY , ˆZ}.
(2.7)
Such interactions are present in many target Hamiltonians encountered in quantum chem-
istry, high energy- or condensed matter physics. To better understand their realization,
we remark that the n gadget vertices implement only Z-interactions (i.e. ˆZ⊗n) [66], and
thus require additional operations. One straightforward choice is to apply local Clifford
ˆH ( ˆS ˆH) operations on these vertices which enable transformations into X(Y )-interactions
respectively. [67, 68, 69]. The action of the Pauli gadget then becomes:
ˆP⊗n(θ) =
 O
ℓ̸=k
ˆ
Hℓ
 O
k
( ˆS† ˆH)k

exp
iθ
2
O
j
ˆZj
 O
k
( ˆH ˆS)k
 O
ℓ̸=k
ˆ
Hℓ

= exp
iθ
2
 O
ℓ̸=k
ˆXℓ
 O
k
ˆYk
 O
j̸=k̸=ℓ
ˆZj

,
(2.8)
where j, k, ℓ∈{1, 2..., n}. In VQEs however, we may use traditional rotation gates to
perform these operations. Doing so yields further advantages since their continuous pa-
rameterization provides enhanced tunability of the measurement bases (e.g.
ability to
generate linear combinations of Eq. (2.7)) while contributing extra variational parameters
toward the classical optimization. These benefits highlight the synergistic role of rotation
gates alongside Pauli gadgets, and showcase the hybrid paradigm nature of the ansatz.
The advantages of employing Pauli gadgets are their efficient resource requirement and
versatility in engineering any desired interaction.
Compared to the 2n −2 entangling
operations required by their GB counterparts (deployed in circuit synthesis and T-gate
15

optimization), the Pauli gadget requires only n. This provides a linear depth reduction
at the cost of a single ancilla qubit, which becomes increasingly relevant upon increasing
the number of qubits, variational layers, or many-body interaction terms. As shown in
Figs. 2.6 and 2.7, these hybrid circuits contain n+g qubits, where g is the total number of
Pauli gadgets (ancillas) measured mid-circuit. This can be reduced to n + 1 qubits if one
recycles the first ancilla after its measurement, thus yielding a further resource advantage.
We remark that these mid-circuit measurements are inherent to MB-QC, and contrast
them with typical readout measurements performed at the end of a circuit (see App. B).
16

2.5
VQE demonstrations
We now showcase the broad applicability of the Pauli gadgets and their hybrid ansätze via
three concrete demonstrations.1 Here, we remark that our use of MB elements to reduce
the number of entangling operations is relevant, as CXs are a bottleneck (i.e. incurring
the largest cost and error rates) on the IBM Quantum platform.
2.5.1
Particle physics: QCD in 1D
Particle physics simulations are a promising candidate for achieving quantum advantage
[27, 70, 71, 72], and have motivated the study of benchmark models on quantum computers
[21, 28, 29, 30, 73, 74]. For our first gadget demonstration, we examine a phase transition
phenomena in quantum chromodynamics (QCD). As a component of the Standard Model,
QCD describes the strong force between quarks mediated by gluons and is governed by the
SU(3) gauge group. Here, we consider QCD on a one-dimensional lattice, where each site
contains a quark or antiquark corresponding to a color component of the fermionic field.
We remark that a lattice gauge theory formulation is of crucial importance – it provides a
non-perturbative tool that enables quantum computers to simulate QCD phenomena that
are intractable with standard perturbative techniques [75, 76].
To formulate the Hamiltonian, we follow the procedure of Ref. [77] and cast it into a
form suitable for quantum computation. The resulting expression describes a unit cell ()
possessing three quarks and three antiquarks in the zero-baryon number (B = 0) sector,
and is a sum of kinetic (hopping), mass, and electric field terms:
ˆH(B=0)
k
= −1
2( ˆX1 ˆZ2 ˆZ3 + ˆZ1 ˆX2 ˆZ3 + ˆZ1 ˆZ2 ˆX3);
ˆH(B=0)
m
= ˜m(3 −ˆZ1 −ˆZ2 −ˆZ3);
ˆH(B=0)
e
= 1
6x(3 −ˆZ1 ˆZ2 −ˆZ1 ˆZ3 −ˆZ2 ˆZ3),
(2.9)
where the dimensionless numbers ˜m and x are the bare quark mass and coupling constant,
respectively. We note the specific form of Eq. (2.9) corresponds to a tetraquark state in
the strong coupling limit (Fig. 2.5), with its specific arrangement of quarks and antiquarks
corresponding to an elementary block of two adjacent unit cells [77].
We conducted a VQE demonstration on ibm_perth and ibm_peekskill to determine
the ground state of the Hamiltonian in Eq. (2.9), with model parameters x = 0.8 and
˜m ∈[−1, 1].
The ansatz used consists of a single ˆP⊗3 gadget (g = 1) with RY and
17

FIG. 2.5: Discretizing quantum chromodynamics on a one-dimensional lattice [77].
(a) Each unit cell of the lattice (highlighted in orange) contains up to three quarks (red, green,
and blue; represented by solid circles) and three antiquarks (antired, antigreen, and antiblue;
represented by stripped circles).
The various terms in the Hamiltonian (Eq.
2.9) arise from
the physics governing lattice gauge theories. The fermionic matter fields ˆϕ (on the lattice sites)
correspond to a mass term ˆHm, and are coupled to gauge fields via connecting links ˆU. The gauge
fields employ electric field operators ( ˆHe) to impose local charge symmetries on each site, while
the links maintain the symmetries and permit matter to “hop” between sites, yielding a kinetic
term ˆHk. (b) Depiction of the strongly coupled tetraquark state corresponding to two adjacent
unit cells.
RY –RZ gates added before and after, respectively [Fig. 2.6(a)]. We exploit the model
symmetry to reduce the number of free parameters from 3 × 3 + 1 = 10 to 4. We then
calculate the quantity ⟨ˆN⟩= ⟨ˆHm⟩/ ˜m for different values of ˜m to observe transitions in
the mean occupation number [Fig. 2.6(a)]. For consistency checks, we also plot a second,
related number operator ⟨ˆ
N ′⟩= (1/3) P
i<j(1 −ˆZi)(1 −ˆZj) for i, j = 1, 2, 3.
We observe in Fig. 2.6(a) that in the negative (positive) mass limits (|x/ ˜m| < 1), ⟨ˆN⟩
and ⟨ˆ
N ′⟩attain their maximal (minimal) occupation numbers, indicating the presence
(absence) of quarks and antiquarks on all lattice sites. These correspond to the baryonium
(vacuum) state. The state transitions (i.e. intermediate occupation numbers) between the
two extremes occur in the region ˜m ∈[−0.2, 0.2] [Fig. 2.6(a)], in accordance with Ref. [77].
Fig. 2.6(a) also exhibits good agreement with ED values in both large mass limits | ˜m| > 0.2
(F ≥83.4%; |∆E|/Eg ≤9.92 × 10−2), and in the transition region | ˜m| ≤0.2 (F ≥77%;
18

|∆E|/Eg ≤3.11 × 10−1). The generally lower fidelity in the latter can be attributed to a
smaller energy gap between the ground state and first excited states. However, we note
that a single gadget with local rotations suffices to resolve the energy difference while
maintaining state fidelities above 75%. These observations highlight the suitability of our
Pauli gadgets in VQE problems involving many-body interactions.
2.5.2
Lattice gauge theory: pure Z2
Next, we analyze a pure (i.e. matterless) LGT possessing a Z2 symmetry, which describes
invariance under spin flips as observed in the transverse-field Ising model [78]. For context,
we note that the PC model discussed in Sec. 2.3 corresponds to a Z2 theory, where the
charge configurations and signs of the Hamiltonians are fixed by ˆH+. The Z2 LGT achieves
the same effect by enforcing Gauss’ law within its Hilbert space. This allows us to switch
to a more general formulation by omitting ˆH+ and the negative signs in Eq. (2.5). We may
then express the Z2 Hamiltonian as a sum of electric and magnetic contributions:
ˆHZ2 = λ ˆH□+ 1
λ
ˆH△,
(2.10)
where ˆH□and ˆH△are defined in Eq. (2.5), and λ is the coupling strength [79].
We performed a VQE demonstration on ibm_peekskill for a single plaquette [Fig. 2.6(b)],
and plot the expectation of the normalized plaquette ⟨ˆH□⟩5 and E-field operators ⟨ˆH△/4⟩
for λ ∈[0.5, 3.3].
Since the only multi-qubit interaction is the plaquette term X⊗4 in
Eq. (2.10), the ansatz contains a ˆP⊗4 gadget (g = 1), with RY and RY –RZ gates added
before and after, respectively [Fig. 2.6(b)].
Furthermore, the elimination of redundant
parameters in the rotation layers allows us to reduce the number of parameters from
3 × 4 + 1 = 13 to 4.
The target plot in Fig. 2.6(b) exhibits a competition between the two operators ˆH△
and ˆH□. The former (latter) dominates in the small (large) λ regime and is indicative of
decoupled spins (ferromagnetic ordering). As expected, there is a crossover around λ = 2
where the spins begin coupling due to the formation of a circulating B-field around the
plaquette. This crossover is generally well captured by the VQE, as evidenced by F ranging
from 76.8% to 86.2% and consistent resolution of the energy difference (|∆E|/Eg ≤0.573).
While the large-λ regime (≥2.88) yielded GS energies closer to and beyond the first excited
5⟨ˆH□⟩and ⟨ˆH△⟩provide strong indicators of VQE performance since they contribute little to the overall
energy in the small and large-λ regimes respectively. This implies that a high accuracy and precision is
needed to ensure their agreement with ED.
19

state (|∆E|/Eg ≥0.9), we remark that its near-degeneracy with E0 (Eg ≤0.2349) and use
of a limited resource budget can pose optimization challenges with resolving the energy
gap (see App. B for more details).
2.5.3
Quantum chemistry: lithium hydride
Our final demonstration showcases how Pauli gadgets may be used to simulate molecular
systems. We determine the ground state of the lithium hydride (LiH) molecule, and follow
Ref. [80] to obtain a reduced 4-qubit Hamiltonian consisting of 100 many-body Pauli terms
(App. E).
We performed a VQE simulation on ibm_perth at an interatomic distance of 1.6 Å. The
hybrid ansatz used is similar to that of the Z2 demonstration, consisting of a ˆP⊗4 gadget
surrounded by RY and RX gates [Fig. 2.6(c)]. Here, the prior elimination of redundant
qubits in Ref. [80] implies that we must retain all 9 parameters in the optimization. To
highlight the gadget’s ability in this more complex scenario, we choose initial parameters
far from the GS (corresponding to E > −7 Ha), as opposed to the near-optimal settings
(E < −7.7 Ha) attainable from UCCSD and Hartree-Fock methods [41].
The optimization plots in Fig. 2.6(c) verify the effective performance of the hybrid
ansatz, as it converges within 1.1% of E0 ≈−7.88 Ha after only 99 iterations, with F
improving from 6.7 to ∼78%. We remark that the final error [68] and fidelity not only
contains contributions from hardware noise, but also from the limited ability of a single
gadget to capture specific two-, three-, and four-body interactions terms in the Hamilto-
nian. For the latter, we may improve the result by appending extra Pauli gadgets (with
local rotations) to the ansatz, as discussed in the next section.
2.5.4
Extension to multiple gadgets
We analyze the efficacy of Pauli gadgets by examining how multiple Pauli gadgets can
improve the approximation of the LiH GS energy. Similar to the PC model, we achieve
this by layering multiple gadgets in series, dispersing local rotations in between them. To
minimize the number of added parameters, we apply a single RY rotation layer between
each gadget, with the usual RX layer only after the last gadget [Fig. 2.7(a)]. This yields
a total of 5g + 4 variational parameters. We simulated3 g = 1, 2, 3, 4 ˆP⊗4 gadgets in a
noiseless fashion on fake_guadalupe with 512 or 1024 shots and 250 iterations.
This
normally requires 4 + g qubits, however, as mentioned in Sec. 2.4, one may reduce the
required qubits to 5 if reset operations are available.
20

From the progress plots [Fig. 2.7(b)], we observe that a larger g requires more itera-
tions to converge but attains a lower relative error in the GS energy and higher fidelity.
This is expected since the greater number of variational parameters enables the ansatz to
thoroughly explore greater regions of the Hilbert space. and thus improve the GS approx-
imation. We also note the significant increase in F from 58.6% (g = 1) to 89.3% (g = 2).
This reflects the sensitivity of the quantity since ρ is constructed by fitting an exponential
number of matrix elements (see App. B), and thus incurs larger inaccuracies with relatively
few variational parameters and/or shots. With respect to capturing the many-body inter-
actions in Table C.1, we remark that appending identical 4-body gadgets suffices since each
is capable of generating k-body interactions for k < 4. This can offer a practical advantage
as it reduces the variety of gadgets that must be experimentally realized.
21

1D QCD
Ref. [76] 
LiH
Ref. [79] 
ℤ! Plaq.
Ref. [78] 
FIG. 2.6: VQE demonstrations of hybrid ansatz circuits on IBM Quantum systems,
involving a single Pauli gadget. All VQE runs were performed dynamically, i.e. with mid-
circuit measurements. All LC gates are Hadamards. The relative errors (∆E/Eg) are calculated
from the energy difference |∆E| = |EV QE −E0|, expressed in units of the energy gap Eg = E1−E0
or E0. Shaded grey regions indicate statistical uncertainty on the error. (a) 1D QCD model (on
ibm_lagos and ibm_peekskill): ⟨ˆN⟩and ⟨ˆ
N′⟩vs. reduced bare quark mass ˜m (x = 0.8, −1 ≤
˜m ≤1), with plots of |∆E|/Eg and F. (b) Z2 lattice gauge theory model (on ibm_peekskill):
⟨ˆH□⟩and ⟨ˆH△⟩vs. coupling strength λ (0.5 ≤λ ≤3.3), with plots of |∆E|/Eg and F. (c) LiH
molecule (at interatomic distance = 1.6 Å, on ibm_perth): Convergence plots of |∆E|/E0 and
F with respect to the VQE iteration number Niter. For comparison, the errors corresponding to
excited state energies (|∆E| = Eg and |∆E| = E2 −E0) are plotted as horizontal lines.
22

|+⟩
|+⟩
|+⟩
|+⟩
FIG. 2.7: Applying multiple Pauli gadgets to improve VQE accuracy. (a) Depiction of
g = 4 ˆP⊗4 gadgets in a hybrid circuit, with CZ, RZ and H (LC) operations in the MB pattern
for each gadget explicitly shown. (b) Noiseless VQE simulation results (relative error ∆E/E and
state fidelity F vs. iteration number) for determining the GS energy of the LiH molecule (at 1.6
Å) with varying numbers of ˆP⊗4 gadgets (g = 1, 2, 3, 4). Lighter color shades around the solid
lines indicate the uncertainty in ∆E/E0. The backend used is fake_guadalupe with 512 or 1024
measurement shots. The optimizer employed is COBYLA with a maximum of 250 iterations.
23

2.6
Conclusions
In this chapter, we have detailed a new hybrid approach to performing VQEs which merges
the strengths of the GB and MB computing paradigms within a variational circuit (ansatz).
While MB approaches are known for having high error thresholds [81, 82, 83, 84] and permit
more efficient implementations of certain operations [22, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,
61, 62, 63, 64, 85], GB approaches offer greater flexibility, and high fidelity implementations
are available on a multitude of physical platforms.
We have introduced our hybrid approach on two levels showcasing how MB aspects can
enhance the efficiency of standard GB-VQEs. On the design level, we adapted the MB
principle of modifying the entanglement structure of variational graph states to circuits,
thus enabling the creation of a problem-informed ansatz in the GB paradigm. On the
implementation level, we utilized MB elements known as Pauli gadgets, which employ mid-
circuit measurements to efficiently implement multi-qubit interactions. We then expanded
the range of possible interactions via local rotation gates, and integrated them alongside the
gadgets to form a “hybrid paradigm” circuit ansatz. Bringing the benefits of MB elements to
NISQ devices is especially timely in view of mid-circuit measurements becoming available
on various platforms [34, 35, 36, 37, 38, 39, 40].
These measurements implement the
corrective operations necessary for deterministic MB-QC and avoids the need for inefficient
postselection.
Our VQE demonstrations on IBM Quantum systems demonstrated the wide applica-
bility of our hybrid approach in testbed scenarios, and their effectiveness in capturing
the underlying physics. These constitute a major step toward practical VQEs, capable of
solving hard problems in quantum chemistry, quantum error correction, and lattice gauge
theory. We also performed VQE simulations that extrapolated these models toward larger
system sizes and circuit depths, and found that they maintained a comparable performance
(with improvements present in noiseless runs). These results indicate the potential of our
techniques given the availability of more scalable and fault-tolerant devices.
The tools we described in this chapter can be directly applied outside the realm of VQEs
towards the broader class of variational quantum algorithms [86], e.g. in quantum neural
networks and quantum machine learning [87, 88, 89, 90, 91, 92, 93, 94, 95]. In addition,
the Pauli gadget may also be utilized to efficiently simulate real-time, dynamic evolutions
of many-body Hamiltonians [73, 77, 96, 97, 98]. Finally, it will be interesting to explore
novel readout schemes which use MB elements such as the Pauli gadget to improve the
measurement efficiency for many-body observables [19, 68, 99]. Such endeavours may yield
new, exciting opportunities to further elucidate the behaviours of fundamental physical
systems.
24

Chapter 3
Superimposing Quantum Operations for
Effective Noise Mitigation
In recent years, quantum computing has become a frontrunner in the pursuit of solving
classically intractable problems. Despite their burgeoning potential in a variety of mathe-
matical and scientific areas, their present experimental realizations are highly susceptible
to noise processes. These stem from apparatus imperfections, interactions with external
fields, and system defects [17, 100, 101], all of which result in leakage of the quantum infor-
mation into the environment. To obtain reliable results, protocols such as error correction
[11, 12] and fault-tolerant computation (by virtue of the threshold theorem) [102, 103]
are often deployed. However, they all require large ratios between the number of physical
qubits and logical qubits they seek to protect. Such an overhead in resources poses chal-
lenges for near-term computation, given their limited scalability and ability to maintain
control of the qubit interactions.
In this chapter, we present an alternative protocol to the above approaches. Rather
than subjecting a target input to a noisy computation, we perform these computations
multiple times in a coherently controlled superposition. With the help of added resources
(i.e. control and auxiliary circuit registers), our approach generates correlations between
the auxiliary and input states in such a way that the noise level is effectively reduced. While
these involve probabilistic aspects such as measurements and postselection, it is remarkably
possible to achieve a deterministic, on-average improvement when combined with unitary
optimization. Furthermore, our protocol is capable of reaching full correction in the infinite
limit of superpositions or branches. This provides one with the freedom to design circuits
with varying degrees of noise mitigation based on the available hardware. More broadly, the
protocol is conceptually simple to analyze on the theory and implementation levels, thanks
25

to how superposition is generated in our approach. This contrasts with previous works,
which investigated superposition using purely communication-based approaches involving
the quantum switch and space-time trajectories [104, 105].
First, we will discuss the basic mathematical theory underlying the “fidelity enhance-
ment” stemming from our approach.
Then, we present numerical demonstrations that
showcase different scenarios where effective noise reduction is achieved, including those
where the added resources themselves incur noise. In a similar spirit to Chapter 2, we
also formulate and perform our protocol in both the GB and MB paradigms. While they
yield similar advantages in noise reduction, these advantages stem from different physical
processes inherent to their computational procedures, which we highlight throughout our
analysis. We emphasize here that all our techniques are geared toward mitigation (i.e. par-
tial correction) of the noise as opposed to its complete elimination. This is what enables
the required computational resources to be lessened, thereby providing a suitable approach
for current NISQ devices.
26

ൿ
ห𝜓in
𝑼
ൿ
𝑈ห𝜓in
𝓔𝑈ȁ
ۧ
𝜓inۦȁ
𝜓in 𝑈†
ȁ ۧ
0 𝑐
(𝑏)
𝓔𝑼
ൿ
ห𝜓in
𝓔𝑼
𝓔𝑼
ȁ ۧ
1 𝑐
+
𝓔𝑼
𝓔𝑼
𝓔𝑼
𝜌out
(𝑎)
(𝑐)
ൿ
ห𝜓in 𝑎
ൿ
ห𝜙0 𝑏
ۧ
ȁ+ 𝑐
𝓔𝑼
𝐹0 = 1
𝐹0 < 1
FIG. 3.1: Conceptual illustration of the fidelity enhancement protocol, applied to an
arbitrary computation U acting on m input qubits. (a) The fidelity F is calculated with
respect to the output of the ideal (noiseless) computation. In the ideal case, the absence of error
guarantees unit fidelity, i.e. F = 1. When considering realistic (i.e experimental) settings, we
must consider noise processes acting on the system. In this incoherent case, the fidelity is generally
reduced, i.e. F < 1. (b)–(c) Schematic of the underlying idea behind the protocol. By employing
a control register c initialized in the srtate |+⟩, one can generate a coherent superposition of two
or more identical noisy computations (between a target input and auxiliary registers). In this
coherent case, correlations are generated between the registers such that it is possible for the
noises to interfere destructively, thereby improving F.
27

3.1
Background
Before introducing the protocol, we describe relevant concepts for understanding noise
processes and their influence on a quantum computation. These include the mathematical
formalism used to describe noise models, and metrics to quantity the performance of a
noisy computation.
3.1.1
Steinspring, Kraus and process matrix representation
Noisy processes such as decoherence are captured by the Steinspring representation [1, 106],
which characterizes the dynamics of open quantum systems. These systems comprise a
target system interacting with an external environment, which corrupts the desired result
of a computation. This interaction may be regarded as a time-evolution of the target (ρt
in)
and environment (ρe
in = |e0⟩⟨e0|) states, where the latter is often unknown. Together, they
form the initial input state ρin = ρt
in ⊗ρe
in, which is assumed to be pure and separable. The
evolution then proceeds as a joint unitary transformation Ute on both systems, yielding
the output ρout = UteρinU †
te. To obtain the target output, we trace out the environmental
system to obtain:
ρt
out = Tre
h
Ute(ρt
in ⊗|e0⟩⟨e0|)U †
te
i
=
X
i
⟨ei|Ute(ρt
in ⊗|e0⟩⟨e0|)U †
te|ei⟩
=
X
i
Ki(Utρt
inU †
t )K†
i ,
(3.1)
where Tre is the partial trace over the environment, |ei⟩are the environmental basis states,
and Ki are known as Kraus operators. The latter describes the influence of the environment
and obeys the completeness relation P
i K†
i Ki = I. Eq. (3.1) is important as it arises from
the action of a quantum channel EUt (a completely positive and trace-preserving map)
on ρt
in, so that EUt(ρin) = ρt
out. This exemplifies the notion that quantum channels are
a unitary evolution in a larger, purified Hilbert space, where their Kraus operators are
associated with the environmental basis states,
|ψ⟩t|e0⟩e 7→
X
j
UteKj |ψ⟩t ⊗|j⟩e .
(3.2)
Here, the leakage of information into the environment (e) enables a characterization of the
noise, and the partial trace over the environment allows one to obtain a description solely
28

in terms of Kraus operators.
We may also decompose any Kraus operator into a weighted sum of Pauli operators,
as they themselves obey the completeness relation:
Ki =
X
j
ci,jPj,
(3.3)
where P ∈{I, X, Y, Z} and P
j |ci,j|2 = 1. This allows us to re-express Eq. (3.1) as:
ρt
out =
X
a,b
χabPa
 Utρt
inU †
t

P†
b,
(3.4)
where the coefficients χab = P
i ciac∗
ib and P ∈{I, X, Y, Z}⊗m is an m-qubit Pauli string
(for an m-qubit input). This is known as the canonical or process matrix representation [1],
which facilitates the description of noise types naturally described in the Pauli basis. It is
particularly relevant as we focus on depolarizing and dephasing channels in our analysis.
Their corresponding Kraus operators are given by:
Dephasing: K0 = √p0I, K1 =
p
1 −p0Z,
(3.5a)
Depolarizing: K0 = √p0I, Ki =
r
1 −p0
3
Pi,
(3.5b)
where Pi = X, Y, Z for i = 1, 2, 3 and p0 denotes the probability of incurring no error.
In this representation, we may conveniently characterize such channels by examining their
process matrices χ (with normalized elements χab). For example, the m = 2 matrices for
dephasing and depolarizing channels1 respectively are:
χ = diag(p2
0, 0, 0, p0(1 −p0), 0, 0, 0, 0, 0, 0, 0, 0, (1 −p0)p0, 0, 0, (1 −p0)2);
(3.6a)
χ = diag(p2
0, p0(1 −p0)/3, p0(1 −p0)/3, p0(1 −p0)/3, (1 −p0)p0/3, (1 −p0)2/9,
(1 −p0)2/9, (1 −p0)2/9, (1 −p0)p0/3, (1 −p0)2/9, (1 −p0)2/9, (1 −p0)2/9,
(1 −p0)p0/3, (1 −p0)2/9, (1 −p0)2/9, (1 −p0)2/9),
(3.6b)
with no-error probability pne = χ00 = p2
0.
1In cases where m ≥2, we compose these channels by considering tensor products of all m-operator
permutations of Ki. For instance, the m = 2 dephasing channel has Kraus operators: K0 =
p
p2
0(I ⊗I),
K1 =
p
p0(1 −p0)(I ⊗Z), K2 =
p
(1 −p0)p0(Z ⊗I), and K3 =
p
(1 −p0)2(Z ⊗Z).
29

3.1.2
Principle for fidelity enhancement
Given a noisy computation, it is useful to quantify its detrimental effects by computing
the state fidelity – a measure of how “close” two states are. We consider as our reference
the noiseless situation, where only the desired computation acts on the target system
ρt
in. Denoting the subscript “0” to mean the absence of noise, we express the output as
ρt
0 = Utρt
inU †
t . In the noisy case, the output ρt
out has the form of Eq. (3.1). We then
calculate the state fidelity F between these two states as:
F = Tr

(
p
ρt
0ρt
out
p
ρt
0)
1
2
2
,
(3.7)
which equals unity when the computation is unaffected by the noise (i.e. ρt
out = ρt
0). If
the input is pure, then ρt
in = |ψt
in⟩⟨ψt
in| and ρt
0 = Ut|ψt
in⟩⟨ψt
in|U †
t , allowing us to simplify
Eq. (3.7) to:
F = ⟨ψt
out|ρt
out|ψt
out⟩.
(3.8)
However, for a pure |ψin⟩, a noisy computation will generally transform the state into a
mixed one, i.e. ρout. Thus, it is more apt to define the fidelity as:
Fic = Tr(ρoutU|ψin⟩⟨ψin|U †).
(3.9)
We refer to Fic as the incoherent fidelity, which is the quantity we aim to improve on with
our coherent superposition protocol.
We now describe the fidelity enhancement principle underlying our protocols, using the
simplest example of two superposition branches in Fig. 3.1. The superposition is generated
by an auxiliary control register c, which we set to |+⟩to maximize its effect. We then
apply EU – a noisy version of the desired computation U – identically to both branches.
Due to the coherent superposition, the noises become correlated and interfere with each
other. Since this interference can be destructive in nature, one may achieve partial can-
cellation (reduction) of the noise2. We then collapse the superposition by measuring the
control in the X-basis, which leads to two outcomes (assuming the control state remains
fixed) and their associated output states. Here, we let their state fidelities be F1 and
F2, with probabilities p1 and p2. Our protocol is then capable of yielding probabilistic
2It is interesting to note the similarities between coherently superimposing noise, and the use of coherent
states in quantum metrology to reduce shot noise toward the Heisenberg limit. In particular, both draw
benefits from the assumption of uncorrelated noise. In our protocol, it allows fidelity improvements to be
more readily obtained and understood, while in quantum metrology, it enables a desired sampling variance
(precision) to be achieved with a fewer number of measurement shots [107, 108].
30

(i.e. max(F1, F2) > Fic) and/or deterministic (i.e. p1F1 + p2F2 > Fic) fidelity improve-
ments. We remark that a generalization to d branches (d > 2) is achievable by employing
a multi-level (qudit) control system where |+⟩c =
1
√
d
Pd−1
i=0 |i⟩.
3.1.3
Figures of merit
Despite the usefulness of calculating state fidelity [Eq. (3.7)], it can vary depending on the
input state chosen. This makes it difficult to describe as an indicator of performance, and
as such, we turn to more specific figures of merit to quantify our advantages. Here, we
employ the Choi-Jamiołkowski (CJ) isomorphism, which directly relates quantum states
with channels [109]. At the center of the description is the 2m-qubit Bell state:
|Φ+
m⟩a,b =
|0⟩a|0⟩b + |1⟩a|1⟩b
√
2
⊗m
,
(3.10)
where a and b refer to the two halves of the state, corresponding to two m-qubit systems
commonly named “Alice” and “Bob”. We subject Bob’s half of the state to a noisy com-
putation, while Alice’s half remains unaffected. If we set |ψin⟩= |Φ+
m⟩3, one may define a
fidelity-type quantity known as the Choi-Jamiołkowski (CJ) fidelity:
FCJ = ⟨Φ+
m|a,b(I ⊗U †)ρa,b
out(I ⊗U)|Φ+
m⟩a,b,
(3.11)
where ρa,b
out is the joint output state after the noisy computation, and U acts on Bob’s (the
target) system. The CJ fidelity is notable for imposing a lower bound on the achievable
fidelity F over all arbitrary input states. This remarkable property arises from the max-
imally entangled nature of Eq. (3.10), and its relation to teleportation. The presence of
noise serves to decohere and destroy the entanglement, which lowers FCJ and the degree
the transmitted state resembles (I ⊗U)|Φ+
m⟩a,b.
Throughout our numerical analyses (Secs. 3.2.5 and 3.3.2), we quantify the degree of
advantage as the CJ-infidelity ratio R between the incoherent and coherent cases:
R = 1 −FCJ, ic
1 −FCJ
,
(3.12)
such that the greater R is above 1, the greater the noise reduction, with R = 1 indicating
no reduction (i.e. same as the incoherent case).
3Note that |Φ+
m⟩requires double the number of input registers (2m), and conventionally, Alice’s m reg-
isters are placed above Bob’s m registers. After state initialization, Alice’s registers remain idle throughout
the computation.
31

𝓔𝑼
1
⋮
𝓔𝑼
𝓔𝑼
𝓔𝑼
2
3
4
5
ൿ
ห𝜓in 𝑎
𝑚- qubit 
input
ൿ
ห+𝑑𝑐
𝑑- level 
control
ൿ
ห𝜙0 𝑏1
𝑚- qubit 
auxiliaries
ൿ
ห𝜙0 𝑏2
ൿ
ห𝜙0 𝑏𝑑−1
6
𝜌out
⋮
⋮
FIG. 3.2: Schematic representation of the GB protocol for fidelity enhancement. Ver-
tical dashed lines, marked with numbers 1–6, identify the system’s state after the corresponding
steps of the protocol (refer to Ref. [65]). The initial |ψin⟩a and auxiliary |ϕ0⟩bi (i = 1, . . . , d −1)
states, as well as the noisy computations EU are explicity shown. The multi-qubit gates between
lines 1 and 2, as well as 3 and 4, are cSWAP operations defined by Eq. (3.14).
32

3.2
Enhanced gate-based computation
With the background in place, we now present the protocol for performing coherent com-
putations, starting with the original gate-based (GB) version of the protocol. We explain
the steps from a high-level perspective, and refer to Ref. [65] for more details regarding the
derivation and notations used.
3.2.1
Working protocol
The GB protocol entails performing the circuit shown in Fig. 3.2. It consists of a control
system |+d⟩c, an m-qubit register for the input state |ψin⟩t, and d −1 identical registers of
m-qubit auxiliary states |ϕ0⟩i, where i = 1, ..., d −1.
Step 1: First, we prepare all systems mentioned above. The control register is initialized
to |+⟩c =
1
√
d
Pd−1
i=0 |i⟩, with d indicating the number of branches (superpositions) used to
perform the desired computation U. If only qubits are available, one may implement the
control register using n > log2d qubits with each in |+⟩. The auxiliary states |ϕ0⟩i may
be chosen freely (i.e. as separable, entangled, or product of entangled states) and plays a
direct role in the degree of noise reduction obtained. The initial state is then:
|+d⟩c|ψin⟩t
d−1
O
i=1
|ϕ0⟩i,
(3.13)
Step 2: Next, we apply a generalized d-level version of the cSWAP (Fredkin) gate,
which acts according to:
cSWAP = |0⟩⟨0|c ⊗I +
d−1
X
i=1
|i⟩⟨i|c ⊗SWAPt,i,
(3.14)
where,
SWAPt,i =
m
O
j=1

|ψ(j)
in ⟩⟨ϕ(j)
0 |t

|ϕ(j)
0 ⟩⟨ψ(j)
in |i

.
(3.15)
The cSWAP gate swaps the input |ψin⟩(i.e.
Bob’s part of the Bell state) with every
auxiliary register, effectively dispersing it across all branches. In particular, the choice of
which states to swap is dictated by the control state |i⟩for i = 1, 2, ..., d. For i = 0, no
swap occurs and corresponds to the incoherent case. We note that in multi-qubit cases
33

(m > 1), a SWAP exchanges the jth qubit of states |ψin⟩t and |ϕ0⟩i for j = {1, 2, .., m}, as
described by Eq. (3.15).
Step 3: The computation of interest U is now applied to the input and all auxiliary
registers. In the GB paradigm, we model noise as arising from the imperfect application
of U given by Eq. (3.1), which corresponds to the map EU. Here, we assume that the noise
affecting each register is uncorrelated (independent), which ensures they may be cancelled
out, and that they are identical.
Step 4: We then apply a second cSWAP operation, which serves to undo all the register
swaps in Step 2.
In the ideal (noiseless) scenario, it completely cancels with the first
cSWAP, leaving the overall state as U applied to the inputs and auxiliary systems in
Eq. (3.13). However, in a noisy scenario, the overall state remains entangled among its
registers. As described in the next step, it is this correlation that allows the different noise
types to interfere, resulting in their partial or complete cancellation.
Step 5: The control and auxiliary systems are measured to collapse the overall super-
position, yielding the output state ρout. This step is crucial since we use it to showcase its
higher fidelity over the incoherent case [Eq. (3.9)]. We measure the control system in the
generalized X- or Fourier basis, which is spanned by the set of states:
(
1
√
d
d−1
X
k=0
e
2πikl
d |k⟩c
)d−1
l=0
.
(3.16)
The rationale is that any ideal result will involve the control in |+⟩, and consequently, our
choice of basis allows us to distinguish this state and extract the best possible advantage.
Choosing a basis for the auxiliary states is less straightforward, and we discuss a systematic
approach in Sec. 3.2.2. Assuming the control and auxiliaries are measured in the states
|+⟩and |ϕf⟩respectively, the output state is [65]:
ρout = Ad
d
 X
i
KiU|ψin⟩⟨ψin|U †K†
i
... + (d −1)
X
i,j
 
⟨ϕf|KjU|ϕ0⟩⟨ϕ0|U †K†
i |ϕf⟩
A2
!
KiU|ψin⟩⟨ψin|U †K†
j

;
Ad =
 X
i
|⟨ϕf|KiU|ϕ0⟩|2
d−1
,
(3.17)
which is a sum of an incoherent term [∝Eq. (3.1)] and a coherent term that corresponds
34

to the input distributed over the auxiliary registers (i.e. from Step 2). We focus on the
latter term, which contains the product:
⟨ϕf|KjU|ϕ0⟩⟨ϕ0|U †K†
i |ϕf⟩.
(3.18)
Eq. (3.18) represents the interference between noise types, as evidenced by the cross-terms
involving the Kraus operators Ki and Kj. Here, |ϕf⟩refers to the chosen state that the
auxiliary register is projected onto. We observe that the greater U|ϕ0⟩is susceptible to
the noise, such that it more closely resembles |ϕf⟩, the greater the interference and extent
of noise reduction. Although counter-intuitive, we may relate this property to our act of
measuring the input and auxiliary systems, which “reveals” the nature of the noise acting
on them. This knowledge is required for interference to occur, and is strengthened the
more noise impacts the systems responsible for the interference (i.e. the auxiliaries).
Naturally, we wish to maximize Eq. (3.18) – which we achieve by defining two perfor-
mance quantities ω1 and ω2:
ω1 = 1 −
P
j≥1
⟨ϕ0|U †KjU|ϕ0⟩
2
1 −pne
;
(3.19a)
ω2 = |⟨ϕf|U|ϕ0⟩|2,
(3.19b)
where pne = pm
0 is the probability of incurring no error. Both ω1 and ω2 range between 0
and 1, with the former due to P
i K†
i Ki = I. Considering (ω1, ω2) = (1, 1), we find that
Eq. (3.18) is indeed maximized by imposing that |ϕf⟩= U|ϕ0⟩and the only surviving
Kraus term be i = j = 0, which corresponds to an ideal computation (since K0 = I).
The coherent term becomes pd
neU|ψ⟩in⟨ψ|U † while the incoherent term (containing all Ki
with i ≥1) becomes proportional to pd−1
ne /d (see Eq. (27) of Ref. [65]). We observe that
in the asymptotic limit of branches (d →∞), one can arbitrarily minimize the incoherent
term, with FCJ tending to one. We also see that the extremes (ω1, ω2) = (1, 1) and (0, 0)
correspond to maximum and no noise reduction respectively, with intermediate values
indicating partial reduction.
Step 6: Finally, we perform a postprocessing step on the results in one of two ways.
We either postselect a single outcome corresponding to the highest fidelity, or retain all
or part of the outcomes and perform a unitary optimization to improve the on-average
fidelity. We discuss these approaches further in the next sections.
35

3.2.2
Probabilistic approach
The idea behind postselection revolves around the desire to attain maximal fidelity. It
involves retaining a single outcome over the control and auxiliary registers corresponding
to the state:
|+d⟩c
d−1
O
i=1
|ϕf⟩i.
(3.20)
which corresponds to the output in Eq. (3.17). From Sec. 3.2.1, it is ideal to set |ϕf⟩=
U|ϕ0⟩which allows ω2 = 1. However, from an experimental standpoint, our initialization
of each auxiliary in |ϕ0⟩requires an application of U † to undo the computation. This can
introduce further noise that lowers the fidelity improvement. We can circumvent this with
a more generic choice for |ϕf⟩, one that is completely sensitive to arbitrary noises. More
specifically, setting |ϕ0⟩to the m-qubit Bell state |Φ+
m⟩4 [Eq. (3.10)] fulfils this condition
since:
⟨Φ+
m|U †KiU|Φ+
m⟩=
p
pm
0 δi,0
(3.21)
for i = 0, 1, ..., 4m −1 (i.e. all m-qubit Paulis), where K0 = √pm
0 I⊗m. Since this implies
⟨ϕf|U|Φ+
m⟩= 1, we are ensured that (ω1, ω2) = (1, 1).5 Furthermore, by expressing arbitrary
noise in the form of Eq. (3.4) with process matrix χ, one can prove (see Ref. [65]) that:
FCJ = χ′
00 > χ00 = FCJ, ic,
(3.22)
where χ′
00 = χd
00/ps, and ps is the success probability of obtaining Eq. (3.20):
ps = χd−1
00
d
+ d −1
d
χd−2
00
 X
i
|χi0|2

.
(3.23)
Eqs. (3.22) and (3.23) highlight two important features of the protocol: firstly, FCJ in-
creases asymptotically toward 1 (its maximum) as d →∞, and secondly, such behaviour
is independent of the specific noise acting on the computation.
Despite these general advantages, Bell states are inherently challenging to prepare ex-
4Here, we may treat the auxiliary registers similarly to the input (i.e. each is augmented with an idle
register). However, we note if m = 2 and d ≥2, one may encode |Φ+
1 ⟩directly in each auxiliary to avoid
incurring extra resources. Alternatively, one may resort to maximally entangled GHZ states |0⟩⊗m+|1⟩⊗m
√
2
both separately and in conjunction with Bell states to achieve comparable effects. For simplicity, we do
not consider such scenarios here and refer to Ref. [65] for more details.
5Under this condition, the state in Eq. (3.20) reduces to the ideal (noiseless) output. One can then show
that projection onto this state yields the maximum possible FCJ over all possible outputs; see Ref. [65].
36

perimentally and require extra resources (2m qubits for each |ϕ0⟩i). However, it turns out
for noises described by rank-2 matrices such as dephasing, we may attain w1 = 1 with non-
entangled |ϕ0⟩i. In this example, since Z is the only non-identity Kraus, setting each |ϕ0⟩i
to either eigenstate of X or Y guarantees maximal sensitivity. As for w2 = 1, we must pos-
sess individual knowledge of the unitary U and its action on |ϕ0⟩, to avoid acting U †. From
there, we may select the auxiliary such that it is an eigenstate of U (i.e. U|ϕ0⟩= |ϕ0⟩). For
example, if U is an RZ-gate, then it is appropriate to set |ϕ0⟩= |0⟩or |1⟩. Note that if U is
Clifford (i.e. composed of H, S and CX gates), then we may initialize |ϕ0⟩and determine
U|ϕ0⟩classically efficiently, and such knowledge is not required. In the numerical analysis
(Sec. 3.2.5), we take into account such considerations. We emphasize, however, that the
benefit of this approach lies in its plug-and-play nature – one need not know anything
about the unitary or noise type, and fidelity improvement can still be obtained provide
both ω1 and ω2 are effectively > 0.
3.2.3
ϵ–deterministic approach
While the probabilistic approach is capable of mitigating a noisy computation, it relies on
a high ps (i.e. probability of measuring the postselected outcome) to be effective. However,
there exist scenarios where ps is low, such as when d is relatively large or when ω1 and ω2
are closer to unity. In these scenarios, additional outcomes must be retained in order to
increase ps. Although this often lowers the (now) on-average fidelity ¯FCJ, we may boost
this quantity by performing a prior optimization step in which correcting unitaries are
applied to each output state. If we label the possible outcomes as q = 1, 2, ..., 2m(d−1)d,
each corresponding to an output ρ(q)
out with probability p(q)
s , then the optimization seeks to
find a unitary U (q)
c
that improves F(q)
CJ as much as possible to F(q)
CJ, opt (corresponding to
U (q)
c ρ(q)
outU (q)
c
†). Moreover, a user may specify a desired failure threshold ϵ which dictates
the number of outcomes r ≤2m(d−1)d retained such that ps = Pr
q=1 p(q)
s
≥1−ϵ. This forms
the basis for the ϵ-deterministic approach, which yields the improved on-average fidelity:
¯FCJ, opt = 1
ps
r
X
q=1
p(q)
s F(q)
CJ, opt .
(3.24)
Here, we perform the optimization as a minimization problem for each outcome, where the
cost function is the infidelity 1 −F(q)
CJ . From this, we show in Sec. 3.2.5 that it is possible
to attain advantages even in situations where all outcomes are kept (i.e. ϵ = 0).
In principle, the optimization may incorporate free parameters to vary in pursuit of
finding the best corrections and fidelities (akin to a VQE). These may be used to optimize
37

other relevant aspects of the protocol, such as the initial auxiliary states |ϕ0⟩i and measure-
ment bases. However, we note the optimization challenges encountered when the number
of branches (d) or inputs (m) is large (e.g. high problem dimensionality), and the need for a
prior extensive characterization of the noise (e.g. via process tomography) in experimental
settings. To avoid additional (hidden) resources, we employ local, single-qubit correcting
unitaries in our optimizations, and restrict them to discrete gates in the Clifford group,
which incur minimal noise due to their efficient classical implementation.
3.2.4
Protocol example
To illuminate the ideas behind the GB protocol, we apply it to a basic scenario involving
three branches (d = 3) and dephasing noise [Eq. (3.5a)] with noise parameter p0 = 0.6 and
noiseless cSWAPs. We employ a single-qubit input (m = 1) and an S gate as the main
computation (U|Φ+
1 ⟩= (I ⊗S)|Φ+
1 ⟩; U|ϕ0⟩= S|ϕ0⟩). As discussed in Sec. 3.2.2, we may
set |ϕ0⟩= |+⟩to ensure (ω1, ω2) = (1, 1). In the incoherent case (d = 1), we have:
ρout, ic = 0.6(U|Φ+
1 ⟩⟨Φ+
1 |U †) + 0.4(ZU|Φ+
1 ⟩⟨Φ+
1 |U †Z)
= 0.5|00⟩⟨00| −0.1i|00⟩⟨11| + 0.1i|11⟩⟨00| + 0.5|11⟩⟨11|,
(3.25)
and FCJ, ic = 3/5 = 0.6, where the ideal output is:
U|Φ+
1 ⟩⟨Φ+
1 |U † = 0.5|00⟩⟨00| −0.5i|00⟩⟨11| + 0.5i|11⟩⟨00| + 0.5|11⟩⟨11|.
(3.26)
Now, let us contrast this with the output of the coherent protocol. Plugging into Eq. (3.17),
one finds that Ad = 0.6d−1, and the output state is therefore:
ρout = 0.62
3

0.6(U|Φ+
1 ⟩⟨Φ+
1 |U †) + 0.4(ZU|Φ+
1 ⟩⟨Φ+
1 |U †Z)

... + 2

0.6(U|Φ+
1 ⟩⟨Φ+
1 |U †) + 0(...)

= 0.818(U|Φ+
1 ⟩⟨Φ+
1 |U †) + 0.182(ZU|Φ+
1 ⟩⟨Φ+
1 |U †Z)
(normalized)
= 0.5|00⟩⟨00| −0.318i|00⟩⟨11| + 0.318i|11⟩⟨00| + 0.5|11⟩⟨11|.
(3.27)
where (...) contains the remainder of the summation over Kraus operators with (i, j) =
(I, Z), (Z, I), (Z, Z). From Eq. (3.27), we can observe how the coherent term suppresses
the undesired terms involving Z and boosts the amplitude of the ideal computation (∝
U|Φ+
1 ⟩⟨Φ+
1 |U †), thereby resulting in an improved FCJ. Recall that in doing so, we have
measured the control and auxiliaries in orthonormal bases spanned by |+3⟩and U|ϕ0⟩
38

respectively. The results of these measurements are shown in in Table 3.1.
Table 3.1: Sample results after performing the gate-based protocol for fidelity enhancement, before
unitary optimization. The postselected outcome is highlighted in bold.
q
Outcomes (ctrl, aux)
ρ(q)
out(|00⟩⟨00|, |00⟩⟨11|, |11⟩⟨00|, |11⟩⟨11|)
F(q)
CJ
p(q)
s
1
2
3
4
5
6
7
8
9
10
11
12
0, 00
0, 01
0, 10
0, 11
1, 00
1, 01
1, 10
1, 11
2, 00
2, 01
2, 10
2, 11
0.5, -0.318i, 0.318i, 0.5
0.662, −0.0004i, 0.0004i, 0.338
0.469, −0.096i, 0.096i, 0.531
0.36, 0.0116i, −0.0116i, 0.64
0.5, 0.5i, −0.5i, 0.5
0.247, 0.0789 −0.256i, 0.0789 + 0.256i, 0.753
0.534, 0.0268 −0.105i, 0.0268 + 0.105i, 0.466
0.6875, −0.108 −0.25i, −0.108 + 0.25i, 0.3125
0.5, 0.5i, −0.5i, 0.5
0.247, −0.0789 −0.256i, −0.0789 + 0.256i, 0.753
0.534, −0.0268 −0.105i, −0.0268 + 0.105i, 0.466
0.6875, 0.108 −0.25i, 0.108 + 0.25i, 0.3125
0.818
0.5
0.596
0.488
0
0.756
0.605
0.75
0
0.756
0.605
0.75
0.264
0.123
0.125
0.115
0.048
0.0393
0.0567
0.0427
0.048
0.0393
0.0567
0.0427
Here, the measured outcomes ‘0’, ‘1’, and ‘2’ correspond to the computational basis states
|0⟩, |1⟩, and |2⟩respectively. We observe that the “all 0” outcome (q = 1) corresponds to
ρout and is therefore postselected (with ps = 0.264) when using the probabilistic approach
(the other outcomes are associated with states that are orthogonal to the control and/or
auxiliaries).
Note that this outcome corresponds to the highest FCJ (see Ref. [65] for
details) and that:
FCJ = 0.818 > 0.6 = FCJ, ic.
(3.28)
From this, we find the infidelity ratio to be:
R = (1 −0.6)/(1 −0.818) = 2.2.
(3.29)
One can enhance the relatively low ps by employing the ϵ-deterministic approach. During
optimization, we determine the unitary correction (from the single qubit Clifford group) for
each output state (outcome q) that results in the greatest fidelity increase. The outcomes
are then accepted one-by-one from the highest to lowest optimized fidelity until the desired
ϵ = 1 −ps is attained. Suppose one wishes to achieve ϵ = 0.25 =⇒ps = 0.75. Then, the
approach yields the optimized results in Table 3.2.
39

Table 3.2: Sample results after performing the gate-based protocol for fidelity enhancement, after
unitary optimization. Outcomes are arranged from the highest optimized fidelity to the lowest.
q
Outcomes (ctrl, aux)
U (q)
c
U (q)
c ρ(q)
outU (q)
c
†(|00⟩⟨00|, |00⟩⟨11|, |11⟩⟨00|, |11⟩⟨11|)
F(q)
CJ, opt
p(q)
s
Accept? (ϵ = 0.25)
5
9
1
6
10
8
12
7
11
3
4
2
1, 00
2, 00
0, 00
1, 01
2, 01
1, 11
2, 11
1, 10
2, 10
0, 10
0, 11
0, 01
I ⊗SS
I ⊗SS
I ⊗I
I ⊗I
I ⊗I
I ⊗I
I ⊗I
I ⊗I
I ⊗I
I ⊗I
I ⊗SS
I ⊗I
0.5, −0.5i, 0.5i, 0.5
0.5, −0.5i, 0.5i, 0.5
Same as in Table 3.1
Same as in Table 3.1
Same as in Table 3.1
Same as in Table 3.1
Same as in Table 3.1
Same as in Table 3.1
Same as in Table 3.1
Same as in Table 3.1
0.36, −0.0116i, 0.0116i, 0.64
Same as in Table 3.1
1
1
0.818
0.756
0.756
0.75
0.75
0.605
0.605
0.596
0.512
0.5
0.048
0.048
0.264
0.0393
0.0393
0.0427
0.0427
0.0567
0.0567
0.125
0.115
0.123
✓
✓
✓
✓
✓
✓
✓
✓
✓
✓
✗
✗
We see that by accepting further outcomes (excluding q = 2 and 4), we are able to improve
ps from 0.264 to
X
q∈{1,...,12}\{2,4}
p(q)
s
= 0.762
(3.30)
at the expense of slightly lower FCJ and R values (note that exceeding the desired ps is
common given the finite number of outcomes). Nevertheless, we still obtain a degree of
enhancement since:
¯FCJ, opt =
X
q∈{1,...,12}\{2,4}
p(q)
s F(q)
CJ,opt = 0.7588 > 0.6 = FCJ, ic,
(3.31)
and,
R = (1 −0.6)/(1 −0.7588) = 1.658 > 1.
(3.32)
40

3.2.5
Performance and analysis
We now proceed to analyze the numerical performance of the coherent GB protocol in
a variety of settings involving the probabilistic and ϵ-deterministic approaches. Here, we
examine two kinds of unitaries U, namely, T and CX gates for one- and two-qubit input
scenarios respectively. These operations are essential to many quantum algorithms, with
the former used in magic state distillation [110], and the latter essential for stabilizer
measurements [111]. To assess the protocol directly, we first present results where the
control register and generalized cSWAPs are assumed to be noiseless. Then, we analyze a
separate scenario where noise affects them both, which we use to establish an upper bound
on the achievable fidelity. For the noise, we apply either dephasing and depolarizing noises
to T and CX. These choices are motivated by the ideas of Sec. 3.2.2, and ensures that a
choice of |ϕ0⟩such that ω2 = 1 exists.
The GB protocol results are shown in Fig. 3.3 for d = 2, 3, 4 superposition branches and
various noise parameters pne. In (a)–(e), we employ the parameterized auxiliary states:
|ϕ0⟩= cos(θ)|0⟩+ sin(θ)|1⟩(1 input);
(3.33)
|ϕ0⟩= sin2(θ)|00⟩+ cos(θ)sin(θ)(|01⟩+ |10⟩) + cos2(θ)|11⟩(2 inputs),
(3.34)
which by varying θ, permits us to examine scenarios with differing ω1 ∈[0, 1]. As general
observations, we find that (1) R is consistently higher when ω1 = 1 vs. < 1, and (2) R
tends towards larger values as d increases. These agree with the asymptotic behavior of
FCJ and theoretical predictions in the noiseless limit (see Ref. [65]). We further confirm
observation (1) by varying ω1 at a fixed pne, which we perform for the probabilistic CX
case [Fig. 3.3(e)]. As expected, there is a steady increase in R upon increasing ω1 toward 1.
In the probabilistic scenarios [Figs. 3.3(a), (c), (e)], we confirm that the success probability
ps decays with increasing d and ω1. These behaviours are a consequence of Eqs. (3.22) and
(3.23)6, and suggest an appropriate use for the ϵ-deterministic approach [Figs. 3.3(b), (d)].
In these scenarios, we study the limiting case where ϵ = 0 and all outcomes are retained (i.e.
fully deterministic). While they exhibit lower R values than in the probabilistic approach,
we remarkably find that R > 1 for a significant range of pne parameters, suggesting an
advantage can be obtained by performing the protocol as-is. Moreover, while R decreases
in the probabilistic approach with greater noise (smaller pne), we witness increases in the
deterministic approach thanks to the optimization employed. Such unitary corrections can
further reduce the noise if they are predominantly weighted toward single Pauli operators.
6As ω1 increases, R and hence FCJ = χ′
00 undergo increases. Since χ00 (the incoherent fidelity) is fixed
for some d, Eq. (3.22) implies ps must decrease.
41

𝑑
𝑑
FIG. 3.3: Numerical performance of the coherent gate-based (GB) protocol in miti-
gating various noisy scenarios, with variable number of superposition branches. First
row: Dephasing noise applied to the T gate (m = 1) using the (a) probabilistic and (b) fully
deterministic (ϵ = 0) approaches for ω1 = 0.5, 1. Second row: Dephasing noise applied to the CX
gate (m = 2) using the (c) probabilistic and (d) fully deterministic approaches for ω1 = 0.75, 1.
For all plots, the incoherent to coherent fidelity ratio R and postselection success probability ps
are plotted vs. the no-error probability pne [defined by Eq. (3.5a)].
42

𝑑
FIG. 3.3 (cont.): (e) Further analysis of (c) where ω1 is varied [via the choice of |ϕ0⟩in Eq. (3.33)]
between [0, 1] at a fixed pne of 0.9. Each cSWAP is also assumed to be noiseless, with noise
stemming from the main computation only (applied after each unitary gate). Both R and ps are
plotted as functions of ω1. (f) Performance of the probabilistic approach (d = 2) when depolarizing
noise acts on a 2-qubit operation (m = 2) with variable number of layers NL. Each layer consists
of T gates on each of the two qubits, followed by a CX. Here, the auxiliary state is chosen such
that (ω1, ω2) = (1, 1) [see Eq. (3.34)]. In addition to the main computation (acting with fixed
noise parameter 1 −p0 = 10−4), noise also acts after each cSWAP operation with parameter 1 −p
[defined by Eq. (3.5b)]. The target plot shows R vs. NL for various noise level ratios prel between
cSWAPs and operations in U. For reference, the threshold for noise reduction (R = 1) is plotted
as a horizontal line. The corresponding success probabilities ps are also plotted vs. NL.
43

In Fig. 3.3(f), we analyze a more realistic scenario where the cSWAPs and control
registers are noisy. In contrast to the noiseless cases above, we choose U to be a multi-gate
operation CX(T ⊗T) of NL layers. The rationale for a variable computation depth stems
from the cSWAP always being applied twice, which allows us to analyze a direct competition
between noises affecting the cSWAPs and U. We apply depolarizing noise after applying
each gate in U (only on registers acted by the particular gate), and to all registers after
applying a cSWAP. We then analyze R vs. NL for different ratios prel = (1 −p)/(1 −p0)
between the cSWAP noise (1 −p) and gate noise (fixed at 1 −p0 = 10−4).
Here, we
set |ϕ0⟩= |Φ+
1 ⟩7, d = 2, and employ the probabilistic approach. We observe that when
prel = 0, the plot agrees with Fig. 3.3(d) for d = 2 in the noiseless limit. However, as
noise is added to the cSWAP (prel > 0), we see that the effect is detrimental for small
NL, with R < 1 indicating a worse performance than the corresponding incoherent case.
Interestingly, we observe that advantages (R > 1) begin manifesting as NL increases, with
more computational layers required for noisier cSWAPs. This directly relates to the impact
of noise on the auxiliary states (see Sec. 3.2.1), and implies that the noise on U must exceed
the noise on both cSWAPs for our protocol to yield a level of noise reduction. While the
large circuit depths required by U pose challenges with experimental realization, we remark
that our choice to break U up into separate operations lends a more practical approach,
in light of recent proposals for realizing high-fidelity multi-qubit gates [112, 113, 114].
From the results, we can make further remarks regarding use of the two postprocessing
approaches. The increasing R values and high ps in Fig. 3.3(f) suggest the probabilistic
approach is well-suited when applied to a noisy computation of large depth. In contrast,
the ϵ-deterministic approach is best employed when applied to a single noisy gate [Fig.
3.3(b), (d)], especially when one wishes to both maximize ps and achieve a non-negligible
advantage. This can be useful even within larger computations – if several constituent
gates are of low fidelity, one may apply the approach to each upon their execution, in
a multi-stage application of the protocol. The suitability toward small computations is
particularly relevant, owing to the extra resources needed to perform the optimization step
(Sec. 3.2.3).
7See note 4.
44

1
2
3
4
5
cSWAP
ൿ
ห𝜓in 𝑎
ൿ
ห𝜙0 𝑏1
cSWAP
𝓔𝑼
𝓔𝑼
𝜌out
6
ൿ
ห+𝑑𝑐
FIG. 3.4: Schematic representation of the MB protocol for fidelity enhancement. A
d-dimensional control register in the state |+⟩d generates the superposition by swapping the m-
qubit input state with d m-qubit auxiliaries in a controlled manner. All operations (cSWAP,
U) are performed in the MB-paradigm, with each represented by a cluster (resource) state (see
App. A and Ref. [2]). To mirror the GB protocol (Fig. 3.2), all cluster states (including inputs
and outputs) are concatenated together to form steps 1–5. Here, the noise EU arises from the
imperfect preparation of each cluster realizing U. To facilitate analysis, the control register is
treated externally and not integrated as part of the overall cluster (see App. H).
45

3.3
Enhanced measurement-based computation
We now present the MB-QC version of our coherent protocol. Although the underlying
manner in which noise acts is different, it also serves as a limiting factor towards scaling
the size and complexity of computations. We first describe the protocol, then proceed to
compare and contrast its performance in the same scenarios of Sec. 3.2.5.
3.3.1
Working protocol
The MB protocol is conceptually similar to the GB protocol, with the primary difference
being the use of cluster states and ancillary qubit measurements (see App. A) to perform
the cSWAPs and computations U. Our choice to perform MB-QC on clusters contrasts
with the graphs employed in Chapter 2, and is well-suited since we regard the computations
of interest on the level of individual elements (i.e. gates). More specifically, we replace
each gate in Fig. 3.2 with its equivalent cluster state |G⟩, and concatenate them to form
the resource state depicted in Fig. 3.4. Each |G⟩is expressed in the form of Eq. (A.2), and
may be derived from well-known MB patterns in Ref. [2].
Another difference concerns the noise model governing MB-QC. Due to the larger num-
ber of qubits present, errors are incurred multiple times within an operation, which reflect
potential imperfections in preparing the cluster and the quality of the projective mea-
surements. As such, we act noise locally on each qubit j in a given cluster prior to its
measurement, i.e.:
ρG =
N
Y
j=1
Ej(|G⟩⟨G|),
(3.35)
where N is the number of qubits in the cluster. Here, we may employ the same noise
representation in terms of Kraus operators (E = P
i KiρK†
i ; see Sec. 3.1.1). However, it is
crucial to note that even if identical noise is applied to each qubit j, the additional factors
inherent to MB-QC (e.g. chosen measurement bases, entanglement structure) suggests
that the overall effect of noise becomes nontrivial. This can greatly influence the degree
of noise reduction when compared to the GB version, and places emphasis on the specific
design of the cluster used to implement a particular operation.
As Fig. 3.4 shows, the overall setup consists of the same d-level control, m-qubit input,
and d −1 auxiliary states. In Step 1, the input and auxiliary systems are prepared as
components of the overall cluster state, with their input qubits initialized to Eq. (3.13).
However, the control register is less straightforward to prepare in this manner, as there are
no well-known MB patterns for d > 2. As such, we treat the control externally of the cluster
46

and prepare it according to the GB protocol. This also impacts the way we perform the
cSWAP in Steps 2, as it requires entire clusters to be swapped at a time. To achieve this,
we resort to a mathematical procedure involving block-diagonal matrices, which is detailed
in App. H. We then perform MB-QC on the parts of the cluster realizing U and the final
cSWAP (Steps 3 and 4), with noise applied prior to measuring each qubit. Depending on
their outcomes, we apply correcting byproduct operators (App. A) to ensure the resulting
state is always the same. As before, we measure the control and auxiliary systems at Step
5 to obtain ρout, with the same probabilistic (Sec. 3.2.2) and ϵ-deterministic (Sec. 3.2.3)
methods to post-process the result.
3.3.2
Performance and analysis
We study the numerical performance of the coherent MB protocol in scenarios similar to
that of the GB protocol (Sec. 3.2.5).
For each simulation, the entire resource state is
performed in a piecemeal fashion, such that the output of one cluster operation is used as
input for the next. This keeps the size of the processed cluster relatively small, particularly
as density matrices are used and manipulated throughout.
In Figs. 3.5(a) and (c) (i.e. probabilistic approach with noiseless cSWAPs and control),
we observe that the overall behaviour and trends resemble that of the GB results; how-
ever, their R values tend to decrease more rapidly with increasing noise parameters. We
attribute this to our multiple applications of noise (i.e. on every cluster qubit), which on
average, leads to a noisier quantum channel overall. Consequently, we require nonzero ϵ
(i.e. 0.5 and 0.75 for the T and CX operations respectively) in the ϵ-deterministic cases
[Figs. 3.5(b), (d)] in order to attain comparable R values to the GB results. Nevertheless,
these scenarios highlight situations in which noise reduction over the incoherent case is
obtained to some degree. We also remark, that due to the more complex nature of the
noise model, we heuristically choose each |ϕ0⟩to be |+⟩⊗m, m = 1, 2, which generally cor-
responds to (ω1, ω2) < (1, 1). As evidenced by Figs. 3.5(b) and (d), this is responsible for
the R values being slightly above or consistently equal to 1 when all outcomes are retained
(ϵ = 0), indicating little to no advantage.
Similar to the GB protocol, we analyze the scenario where noise acts on the control and
every cluster qubit involved in the cSWAP operation, and study U = [CX(T ⊗T)]NL for
d = 2. Here, NL is linearly proportional to the cluster size. Again, we choose |ϕ0⟩= |Φ+
1 ⟩
and use the probabilistic approach. However, we set cSWAP and U noises to the same
level p0, and keep all measurement outcomes constant to minimize variability stemming
from the byproduct operators (App. A) acting on noisy states. As Fig. 3.5(e) confirms, we
recover the same observation that our protocol is beneficial (R > 1) when NL is sufficiently
47

𝑑
𝑑
FIG. 3.5: Numerical performance of the coherent measurement-based (MB) protocol
in mitigating various noisy scenarios, with variable number of superposition branches.
All operations are implemented by preparing and concatenating cluster states, then measuring
their qubits in prescribed bases. First row: Dephasing noise applied to the T operation (m =
1) using the (a) probabilistic and (b) ϵ-deterministic approaches for ϵ = 0, 0.5.
Second row:
Dephasing noise applied to the CX operation (m = 2) using the (c) probabilistic and (d) ϵ-
deterministic approaches for ϵ = 0, 0.5, 0.75. For (a)–(d), the incoherent to coherent fidelity ratio
R and postselection success probability ps are plotted vs. the no-error probability pne [defined by
Eq. (3.5a)]. For the latter, all nonzero ϵ are indicated as horizontal lines (at 1 −ϵ) to indicate
the minimum thresholds for accepting outcomes. Each cSWAP is also assumed to be noiseless,
with noise stemming from the main computation only (applied to each cluster qubit comprising
the unitary).
48

FIG. 3.5 (cont.): (e) Performance of the probabilistic approach (d = 2) when depolarizing noise
acts on a 2-qubit operation (m = 2) with variable number of layers NL. Each layer consists of a
cluster state implementing T operations on each of the two qubits, followed by a CX. In addition
to the main computation, noise also acts on each cluster qubit comprising the cSWAPs. Both
sources of noise are applied with the same noise parameter p0 [defined by Eq. (3.5b)], and the
target plot shows R vs. NL for various 1 −p0. For reference, the threshold for noise reduction
(R = 1) is plotted as a horizontal line. The corresponding success probabilities ps are also plotted
vs. NL. In all scenarios, the auxiliary state is chosen heuristically as |+⟩(m = 1) or |++⟩(m = 2)
which corresponds to (ω1, ω2) < (1, 1).
large such that the noise on U exceeds that on the cSWAPs. This can be achieved with a
wide range of p0 and NL values, albeit with generally lower ps.
49

3.4
Conclusions
In this chapter, we have introduced and analyzed a protocol that is capable of mitigating
noisy quantum computations. It involves performing an identical number of them in a
coherent superposition, and leads to a interference process between noises in different
branches. We demonstrated via numerical simulations that this interference can lead to
varying degrees of noise mitigation, which can be attained in a range of different scenarios
involving basic unitary operations and Pauli noises.
We also provided a concrete way
of performing the protocol in both the GB and MB paradigms, which employs exotic
circuit features such as the inclusion of auxiliary registers, generalized cSWAP operations,
and ancillary cluster qubits from MB-QC. In particular, we have seen that the amount
of mitigation is dictated not only by how noise affects the inputs, but also the auxiliary
systems, and that an appropriate choice for their initial states can maximize the advantage
we obtain.
Ref. [65] presents further extensions of the protocol to a circuit-free version that does
not require additional cSWAPs and auxiliary systems, and is tailored to an physical imple-
mentation using photonic interferometers and beamsplitters. A so-called nested scenario is
also described, which enables one to readily scale the number of branches without increas-
ing the dimensionality of the control system. It also enables the degree of noise mitigation
to be optimized using non-identical auxiliary states.
Our coherent superposition protocol serves as a NISQ-friendly approach to overcoming
noise and decoherence in quantum computations, standing in contrast to resource-heavy
fault-tolerant computing and error correction methods. We remark however, that the tools
and techniques of our protocol are not limited to this area, and have the potential to impact
other consequential fields such as quantum communication, metrology, and sensing [115].
50

Chapter 4
Conclusions and Outlook
In this thesis, we examined two different ways in which exotic circuits may be employed to
enhance quantum algorithms and computation. We employ the umbrella term “exotic” to
mean elements of ancillary registers, graphs (or clusters), mid-circuit measurements, and
conditional operations which are commonly found in the MB paradigm but less common
for traditional GB-QC.
In Chapter 2, we employed exotic circuits in VQE algorithms, where they serve as the
ansatz for determining ground state properties. We achieved this by blending elements
of the GB and MB computing paradigms to produce a hybrid VQE ansatz. Using cor-
responding ansatz modification and Pauli gadget techniques, we obtain compact circuits
that are both versatile and resource-efficient. The Pauli gadget, in particular, minimizes
the overhead and offers a practical means for performing MB-QCs on platforms that do
not implement highly entangled resource states.
To test our hybrid approaches, we performed these circuits on IBM superconducting
qubit systems, where they succeeded in simulating key ground-state phenomena (i.e. phase
transitions and perturbative effects) for a broad range of physical models. These models
span different areas of physics, encompassing lattice gauge theory (Z2), 1D quantum chro-
modynamics, error-correcting surface codes (PC), and molecular systems (LiH). Although
our results are similar in quality to those of standard GB-VQEs, our inclusion of both
paradigms expands the range of compatible quantum platforms for VQEs, while retaining
the resource and performance benefits of each. Our approach also displayed promise in
scaling up to larger systems and circuit depths, maintaining a strong performance in their
corresponding VQE simulations. These innovations constitute a new, enhanced way of
thinking about VQE algorithms from both the design and realization perspectives.
51

In Chapter 3, we used exotic circuits to mitigate noise impacting general quantum
computations.
Specifically, we augment a circuit with multiple auxiliary registers and
perform the same noisy computation on each in a controlled coherent superposition. This
creates an interference process between registers that, under certain conditions, allows for a
partial elimination of the noise. We identified such conditions in scenarios involving Pauli
noises and basic unitary operations, and gave a concrete, scalable protocol to perform
these circuits in the GB and MB paradigms. We performed our protocol as numerical
simulations that confirmed and quantified the advantage via the infidelity ratio as a figure
of merit. Most notably, they indicated that our advantages can be maximized by selecting
an appropriate initial auxiliary state, and increasing the number of superposition branches
and/or computational depth.
Despite the MB and GB paradigms being equivalent in
the noiseless limit, their differing noise models led to significant differences in their noise
reduction mechanisms. Nevertheless, we find both paradigms to be capable of mitigating
noise, with similar results and steps in their corresponding protocols.
We emphasize that both GB- and MB-computing paradigms were treated equally in
our discussions. MB-QC has so far proven to be more challenging to implement experi-
mentally, particularly with high-fidelity cluster states [116]. In contrast, our exotic circuits
took a different approach by exploiting MB-QC in traditionally GB applications. As men-
tioned above, we have showcased tools (i.e. Pauli gadgets) that enable a resource-efficient
implementation of MB-QC. These aspects serve to highlight MB-QC as an equally power-
ful approach not only in the subset of applications involving exotic circuits, but in other
quantum physics and information science areas that rely on general quantum computations.
Looking ahead, our exotic circuits may be used to continue the lines of investigation
begun in our works. For instance, one can identify other physical models and design pos-
sibilities suited for our hybrid VQE techniques, and attempt to perform simulations on
hardware involving the scaled-up scenarios mentioned. Meanwhile, the coherent compu-
tation protocols may be applied within more concrete settings (e.g. using interferometric
elements and photonic degrees of freedom), allowing one to ascertain whether our noise
advantages have a consequential impact. These investigations may be facilitated by lever-
aging numerical packages (e.g. Qiskit [41], QuTiP [117], Cirq [118]) to validate our circuits,
as well as tailoring the circuits’ techniques toward the requirements of specific problems,
which would enable more direct analyses.
In a broader sense, this thesis demonstrated how exotic circuits can be beneficial not
only for near-term QC, but also for solving problems that are classically intractable and/or
incur significant resources on quantum hardware. It is hoped that the work expounded
upon here will provide new insights toward achieving reliable, high-fidelity results in the
NISQ era and beyond.
52

References
[1] Michael A. Nielsen and Isaac L. Chuang.
Chapter 4:
Quantum Circuits, page
171–215. Cambridge University Press, 2010.
[2] Robert Raussendorf, Daniel E. Browne, and Hans J. Briegel. Measurement-based
quantum computation on cluster states. Phys. Rev. A, 68:022312, Aug 2003.
[3] Richard Jozsa.
An introduction to measurement based quantum computation.
Quantum Information Processing: From Theory to Experiment, 199:137, 2006.
[4] Tzu-Chieh Wei.
Measurement-based quantum computation.
Oxford Research
Encyclopedia of Physics, 2021.
[5] Hezi Zhang, Anbang Wu, Yuke Wang, Gushu Li, Hassan Shapourian, Alireza Sha-
bani, and Yufei Ding.
A compilation framework for photonic one-way quantum
computation. arXiv:2209.01545, 2022.
[6] Tomoyuki Morimae.
Acausal measurement-based quantum computing.
Physical
Review A, 90(1), 2014.
[7] Xiaoqian Zhang.
Measurement-based universal blind quantum computation with
minor resources. Quantum Information Processing, 21(1), 2021.
[8] Janna Hinchlif. Measurement-based quantum error correction. University of Brisftol,
2015.
[9] N. de Beaudrap, V. Danos, and E Kashefi. Phase map decomposition for unitaries.
arXiv:quant-ph/0603266, 2006.
[10] R Duncan, A Kissinger, S Perdrix, and van der Wetering. Graph-theoretic simplifi-
cation of quantum circuits with the ZX-calculus. Quantum, 4:279, 2020.
53

[11] Daniel Eric Gottesman. Stabilizer Codes and Quantum Error Correction. California
Institute of Technology, 1997.
[12] Daniel A. Lidar and Todd A. Brun, editors. Quantum Error Correction. Cambridge
University Press, September 2013.
[13] Sarmed A Rahman, Randy Lewis, Emanuele Mendicelli, and Sarah Powell. Self-
mitigating trotter circuits for SU(2) lattice gauge theory on a quantum computer.
Phys. Rev. D, 106:074502, Oct 2022.
[14] Zhenyu Cai, Ryan Babbush, Simon C. Benjamin, Suguru Endo, William J. Huggins,
Ying Li, Jarrod R. McClean, and Thomas E. O’Brien. Quantum error mitigation.
arXiv:2210.00921, 2022.
[15] Charles H. Bennett, Gilles Brassard, Sandu Popescu, Benjamin Schumacher, John A.
Smolin, and William K. Wootters. Purification of noisy entanglement and faithful
teleportation via noisy channels. Physical Review Letters, 76(5):722–725, 1996.
[16] Jian-Wei Pan, Christoph Simon, Časlav Brukner, and Anton Zeilinger. Entanglement
purification for quantum communication. Nature, 410(6832):1067–1070, 2001.
[17] John Preskill. Quantum Computing in the NISQ era and beyond. Quantum, 2:79,
August 2018.
[18] Alberto Peruzzo, Jarrod McClean, Peter Shadbolt, Man-Hong Yung, Xiao-Qi Zhou,
Peter J Love, Alán Aspuru-Guzik, and Jeremy L O’Brien. A variational eigenvalue
solver on a photonic quantum processor. Nat. Commun., 5:4213, 2014.
[19] Jarrod R McClean, Jonathan Romero, Ryan Babbush, and Alán Aspuru-Guzik.
The theory of variational hybrid quantum-classical algorithms.
New J. Phys.,
18(2):023023, 2016.
[20] Jules Tilly, Hongxiang Chen, Shuxiang Cao, Dario Picozzi, Kanav Setia, Ying Li,
Edward Grant, Leonard Wossnig, Ivan Rungger, George H. Booth, and Jonathan
Tennyson.
The variational quantum eigensolver: A review of methods and best
practices. Phys. Rep., 986:1–128, 2022.
[21] Danny Paulson, Luca Dellantonio, Jan F. Haase, Alessio Celi, Angus Kan, Andrew
Jena, Christian Kokail, Rick van Bijnen, Karl Jansen, Peter Zoller, and Christine A.
Muschik. Simulating 2d effects in lattice gauge theories on a quantum computer.
PRX Quantum, 2:030334, Aug 2021.
54

[22] R. R. Ferguson, L. Dellantonio, A. Al Balushi, K. Jansen, W. Dür, and C. A. Muschik.
Measurement-based variational quantum eigensolver. Phys. Rev. Lett., 126:220501,
Jun 2021.
[23] Mario Motta and Julia E. Rice. Emerging quantum computing algorithms for quan-
tum chemistry. Wiley Interdiscip. Rev. Comput. Mol. Sci., 12(3):e1580, 2022.
[24] Bela Bauer, Dave Wecker, Andrew J. Millis, Matthew B. Hastings, and Matthias
Troyer. Hybrid quantum-classical approach to correlated materials. Phys. Rev. X,
6:031045, Sep 2016.
[25] Bela Bauer, Sergey Bravyi, Mario Motta, and Garnet Kin-Lic Chan.
Quantum
algorithms for quantum chemistry and quantum materials science.
Chem. Rev.,
120(22):12685–12717, 2020.
[26] Mari Carmen Bañuls, Rainer Blatt, Jacopo Catani, Alessio Celi, Juan Ignacio Cirac,
Marcello Dalmonte, Leonardo Fallani, Karl Jansen, Maciej Lewenstein, Simone Mon-
tangero, et al. Simulating lattice gauge theories within quantum technologies. Eur.
Phys. J. D, 74(8):1–42, 2020.
[27] Andrew J Daley, Immanuel Bloch, Christian Kokail, Stuart Flannigan, Natalie Pear-
son, Matthias Troyer, and Peter Zoller. Practical quantum advantage in quantum
simulation. Nature, 607(7920):667–676, 2022.
[28] Christian Kokail, Christine Maier, Rick van Bijnen, Tiff Brydges, Manoj K Joshi,
Petar Jurcevic, Christine A Muschik, Pietro Silvi, Rainer Blatt, Christian F Roos,
et al.
Self-verifying variational quantum simulation of lattice models.
Nature,
569(7756):355–360, 2019.
[29] Jan F. Haase, Luca Dellantonio, Alessio Celi, Danny Paulson, Angus Kan, Karl
Jansen, and Christine A. Muschik. A resource efficient approach for quantum and
classical simulations of gauge theories in particle physics. Quantum, 5:393, February
2021.
[30] Yasar Y Atas, Jinglei Zhang, Randy Lewis, Amin Jahanpour, Jan F Haase, and
Christine A Muschik. SU(2) hadrons on a quantum computer via a variational ap-
proach. Nat. Commun., 12(1):6499, 2021.
[31] Robert Raussendorf and Hans J. Briegel. A one-way quantum computer. Phys. Rev.
Lett., 86:5188–5191, May 2001.
55

[32] Dan Browne and Hans Briegel.
One-way quantum computation.
Quantum
information: From foundations to quantum technology applications, pages 449–473,
2016.
[33] Hans J Briegel, David E Browne, Wolfgang Dür, Robert Raussendorf, and Maarten
Van den Nest. Measurement-based quantum computation. Nat. Phys., 5(1):19–26,
2009.
[34] A. D. Córcoles, Maika Takita, Ken Inoue, Scott Lekuch, Zlatko K. Minev, Jerry M.
Chow, and Jay M. Gambetta. Exploiting dynamic quantum circuits in a quantum
algorithm with superconducting qubits. Phys. Rev. Lett., 127:100501, Aug 2021.
[35] MS Allman, CH Baldwin, M Foss-Feig, D Hayes, K Mayer, Ryan-Anderson C, and
Neyenhuis B. Demonstration of the trapped-ion quantum ccd computer architecture.
Nature, 592(7853):209, 2021.
[36] J. P. Gaebler, C. H. Baldwin, S. A. Moses, J. M. Dreiling, C. Figgatt, M. Foss-Feig,
D. Hayes, and J. M. Pino. Suppression of midcircuit measurement crosstalk errors
with micromotion. Phys. Rev. A, 104:062440, Dec 2021.
[37] Emma Deist, Yue-Hui Lu, Jacquelyn Ho, Mary Kate Pasha, Johannes Zeiher, Zhenjie
Yan, and Dan M. Stamper-Kurn. Mid-circuit cavity measurement in a neutral atom
array. Phys. Rev. Lett., 129:203602, Nov 2022.
[38] Sainath Motlakunta, Nikhil Kotibhaskar, Chung-You Shih, Anthony Vogliano, Dar-
ian Mclaren, Lewis Hahn, Jingwen Zhu, Roland Hablützel, and Rajibul Islam.
Preserving a qubit during adjacent measurements at a few micrometers distance.
arXiv:2306.03075, 2023.
[39] Roman Stricker,
Davide Vodola,
Alexander Erhard,
Lukas Postler,
Michael
Meth, Martin Ringbauer, Philipp Schindler, Thomas Monz, Markus Müller, and
Rainer Blatt.
Experimental deterministic correction of qubit loss.
Nature,
585(7824):207–210, 2020.
[40] TM Graham, L Phuttitarn, R Chinnarasu, Y Song, C Poole, K Jooya, J Scott,
A Scott, P Eichler, and M Saffman. Mid-circuit measurements on a neutral atom
quantum processor. arXiv:2303.10051, 2023.
[41] Qiskit contributors.
Qiskit: An open-source framework for quantum computing,
2023.
56

[42] Harper R. Grimsley, George S. Barron, Edwin Barnes, Sophia E. Economou, and
Nicholas J. Mayhall. Adaptive, problem-tailored variational quantum eigensolver mit-
igates rough parameter landscapes and barren plateaus. npj Quantum Information,
9(1), 2023.
[43] Anton Nykänen, Matteo A. C. Rossi, Elsi-Mari Borrelli, Sabrina Maniscalco, and
Guillermo García-Pérez. Mitigating the measurement overhead of adapt-vqe with
optimised informationally complete generalised measurements.
arXiv:2212.09719,
2022.
[44] A.Yu. Kitaev. Fault-tolerant quantum computation by anyons. Ann. Phys., 303(1):2–
30, 2003.
[45] Paweł Mazurek, Andrzej Grudka, Michał Horodecki, Paweł Horodecki, Justyna
Łodyga, Łukasz Pankowski, and Anna Przysiężna. Long-distance quantum commu-
nication over noisy networks without long-time quantum memory. Physical Review
A, 90(6), 2014.
[46] Kao-Yueh Kuo and Ching-Yi Lai. Comparison of 2d topological codes and their
decoding performances. 2022 IEEE International Symposium on Information Theory
(ISIT), 2022.
[47] R. Hübener, C. Kruszynska, L. Hartmann, W. Dür, M. B. Plenio, and J. Eisert.
Tensor network methods with graph enhancement. Phys. Rev. B, 84:125103, Sep
2011.
[48] Albie Chan, Zheng Shi, Luca Dellantonio, Wolfgang Dür, and Christine A.
Muschik. Hybrid variational quantum eigensolvers: merging computational mod-
els. arXiv:2305.19200, 2023.
[49] William K. Wootters. Entanglement of formation of an arbitrary state of two qubits.
Physical Review Letters, 80(10):2245–2248, 1998.
[50] Hans J. Briegel and Robert Raussendorf. Persistent entanglement in arrays of inter-
acting particles. Phys. Rev. Lett., 86:910–913, Jan 2001.
[51] Daniel Gottesman and Isaac L Chuang.
Demonstrating the viability of univer-
sal quantum computation using teleportation and single-qubit operations. Nature,
402(6760):390–393, 1999.
57

[52] Barbara M. Terhal and David P. DiVincenzo. Adaptive quantum computation, con-
stant depth quantum circuits and Arthur-Merlin games. Quantum Inf. Comput.,
4(2):134–145, 2004.
[53] Peter Høyer and Robert Špalek. Quantum fan-out is powerful. Theory Comput.,
1(5):81–103, 2005.
[54] Sergey Bravyi and Alexei Kitaev. Universal quantum computation with ideal Clifford
gates and noisy ancillas. Phys. Rev. A, 71:022316, Feb 2005.
[55] Dan Browne, Elham Kashefi, and Simon Perdrix. Computational depth complexity
of measurement-based quantum computation. In Wim van Dam, Vivien M. Kendon,
and Simone Severini, editors, Theory of Quantum Computation, Communication,
and Cryptography, pages 35–46, Berlin, Heidelberg, 2011. Springer Berlin Heidelberg.
[56] Richard Jozsa and Marrten Van Den Nest. Classical simulation complexity of ex-
tended Clifford circuits. Quantum Info. Comput., 14(7, 8):633–648, May 2014.
[57] Adam Paetznick and Krysta M Svore. Repeat-until-success: non-deterministic de-
composition of single-qubit unitaries. Quantum Inf. Comput., 14(15-16):1277–1301,
2014.
[58] Yasuhiro Takahashi and Seiichiro Tani. Collapse of the hierarchy of constant-depth
exact quantum circuits. Comput. Complex., 25:849–881, 2016.
[59] Guanyu Zhu, Ali Lavasani, and Maissam Barkeshli.
Universal logical gates on
topologically encoded qubits via constant-depth unitary circuits. Phys. Rev. Lett.,
125:050502, Jul 2020.
[60] Lorenzo Piroli, Georgios Styliaris, and J. Ignacio Cirac. Quantum circuits assisted by
local operations and classical communication: Transformations and phases of matter.
Phys. Rev. Lett., 127:220503, Nov 2021.
[61] Ruben Verresen, Nathanan Tantivasadakarn, and Ashvin Vishwanath. Efficiently
preparing Schrödinger’s cat, fractons and non-Abelian topological order in quantum
devices. arXiv:2112.03061, 2021.
[62] Nathanan Tantivasadakarn, Ryan Thorngren, Ashvin Vishwanath, and Ruben Ver-
resen.
Long-range entanglement from measuring symmetry-protected topological
phases. arXiv:2112.01519, 2021.
58

[63] Zhenning Liu and Alexandru Gheorghiu.
Depth-efficient proofs of quantumness.
Quantum, 6:807, September 2022.
[64] Sergey Bravyi, Isaac Kim, Alexander Kliesch, and Robert Koenig. Adaptive constant-
depth circuits for manipulating non-abelian anyons. arXiv:2205.01933, 2022.
[65] Jorge Miguel-Ramiro, Zheng Shi, Luca Dellantonio, Albie Chan, Christine A.
Muschik, and Wolfgang Dür. Enhancing quantum computation via superposition
of quantum gates. arXiv:2304.08529, 2023.
[66] D.E. Browne and H.J. Briegel. One-way quantum computation - a tutorial introduc-
tion. arXiv:quant-ph/0603226v2, 2006.
[67] A. Jena, S. Genin, and M. Mosca.
Pauli partitioning with respect to gate sets.
arXiv:1907.07859, 2019.
[68] Ariel Shlosberg, Andrew J. Jena, Priyanka Mukhopadhyay, Jan F. Haase, Felix Led-
itzky, and Luca Dellantonio. Adaptive estimation of quantum observables. Quantum,
7:906, January 2023.
[69] D. Gottesman.
Fault-tolerant quantum computation.
Chaos Solit. Fractals,
10:1749–1758, 1999.
[70] L. Funcke, T. Hartung, K. Jansen, S. Kühn, M. Schneider, P. Stornati, and X. Wang.
Towards quantum simulations in particle physics and beyond on noisy intermediate-
scale quantum devices. Philos. Trans. R. Soc. A, 380(2216):20210062, 2022.
[71] Natalie Klco, Alessandro Roggero, and Martin J Savage. Standard model physics
and the digital quantum revolution: thoughts about the interface. Rep. Prog. Phys.,
85(6):064301, May 2022.
[72] Erez Zohar.
Quantum simulation of lattice gauge theories in more than one
space dimension—requirements, challenges and methods. Philos. Trans. R. Soc. A,
380(2216):20210069, 2022.
[73] Esteban A Martinez, Christine A Muschik, Philipp Schindler, Daniel Nigg, Alexan-
der Erhard, Markus Heyl, Philipp Hauke, Marcello Dalmonte, Thomas Monz, Peter
Zoller, et al. Real-time dynamics of lattice gauge theories with a few-qubit quantum
computer. Nature, 534(7608):516–519, 2016.
59

[74] Christine Muschik, Markus Heyl, Esteban Martinez, Thomas Monz, Philipp
Schindler, Berit Vogell, Marcello Dalmonte, Philipp Hauke, Rainer Blatt, and Peter
Zoller. U(1) Wilson lattice gauge theories in digital quantum simulators. New J.
Phys., 19(10):103020, 2017.
[75] Erez Zohar, J Ignacio Cirac, and Benni Reznik. Quantum simulations of lattice gauge
theories using ultracold atoms in optical lattices. Reports on Progress in Physics,
79(1):014401, 2015.
[76] D. Marcos, P. Widmer, E. Rico, M. Hafezi, P. Rabl, U. J. Wiese, and P. Zoller.
Two-dimensional lattice gauge theories with superconducting quantum circuits.
arXiv:1407.606, 2014.
[77] Y. Y. Atas, J. F. Haase, J. Zhang, V. Wei, S. M.-L. Pfaendler, R. Lewis, and C.A.
Muschik. Simulating one-dimensional quantum chromodynamics on a quantum com-
puter: Real-time evolutions of tetra- and pentaquarks. arXiv:2207.03473, 2022.
[78] Arata Yamamoto. Real-time simulation of (2+1)-dimensional lattice gauge theory
on qubits. Progress of Theoretical and Experimental Physics, 2021(1), 2020.
[79] D. Horn, M. Weinstein, and S. Yankielowicz. Hamiltonian approach to Z(N) lattice
gauge theories. Phys. Rev. D, 19:3715–3731, Jun 1979.
[80] Abhinav Kandala, Antonio Mezzacapo, Kristan Temme, Maika Takita, Markus
Brink, Jerry M Chow, and Jay M Gambetta. Hardware-efficient variational quantum
eigensolver for small molecules and quantum magnets. Nature, 549(7671):242–246,
2017.
[81] Robert Raussendorf and Jim Harrington. Fault-tolerant quantum computation with
high threshold in two dimensions. Phys. Rev. Lett., 98:190504, May 2007.
[82] M. Zwerger, H. J. Briegel, and W. Dür. Universal and optimal error thresholds for
measurement-based entanglement purification. Phys. Rev. Lett., 110:260503, Jun
2013.
[83] M Zwerger, HJ Briegel, and W Dür. Hybrid architecture for encoded measurement-
based quantum computation. Sci. Rep., 4(1):5364, 2014.
[84] M. Zwerger, H. Briegel, and W. Dür. Measurement-based quantum communication.
App. Phys. B, 122:50, 06 2015.
60

[85] Xiao Yuan, Jinzhao Sun, Junyu Liu, Qi Zhao, and You Zhou. Quantum simulation
with hybrid tensor networks. Phys. Rev. Lett., 127:040501, Jul 2021.
[86] Marco Cerezo, Andrew Arrasmith, Ryan Babbush, Simon C Benjamin, Suguru Endo,
Keisuke Fujii, Jarrod R McClean, Kosuke Mitarai, Xiao Yuan, Lukasz Cincio, et al.
Variational quantum algorithms. Nat. Rev. Phys., 3(9):625–644, 2021.
[87] Yunseok Kwak, Won Joon Yun, Soyi Jung, and Joongheon Kim. Quantum neural
networks: Concepts, applications, and challenges.
In 2021 Twelfth International
Conference on Ubiquitous and Future Networks (ICUFN), pages 413–416. IEEE,
2021.
[88] Amira Abbas, David Sutter, Christa Zoufal, Aurélien Lucchi, Alessio Figalli, and Ste-
fan Woerner. The power of quantum neural networks. Nat. Comput. Sci., 1(6):403–
409, 2021.
[89] Oleksandr Kyriienko and Vincent E. Elfving. Generalized quantum circuit differen-
tiation rules. Phys. Rev. A, 104:052417, Nov 2021.
[90] David Peral García,
Juan Cruz-Benito,
and Francisco José García-Peñalvo.
Systematic literature review:
Quantum machine learning and its applications.
arXiv:2201.04093, 2022.
[91] Oleksandr Kyriienko, Annie E. Paine, and Vincent E. Elfving. Protocols for trainable
and differentiable quantum generative modelling. arXiv:2202.08253, 2022.
[92] Junyu Liu, Frederik Wilde, Antonio Anna Mele, Liang Jiang, and Jens Eisert. Noise
can be helpful for variational quantum algorithms. arXiv:2210.06723, 2022.
[93] Junyu Liu, Francesco Tacchino, Jennifer R. Glick, Liang Jiang, and Antonio Mezza-
capo. Representation learning via quantum neural tangent kernels. PRX Quantum,
3:030323, Aug 2022.
[94] Han Zheng, Gokul Subramanian Ravi, Hanrui Wang, Kanav Setia, Frederic T.
Chong, and Junyu Liu. Benchmarking variational quantum circuits with permu-
tation symmetry. arXiv:2211.12711, 2022.
[95] Annie E. Paine, Vincent E. Elfving, and Oleksandr Kyriienko.
Quantum kernel
methods for solving regression problems and differential equations. Phys. Rev. A,
107:032428, Mar 2023.
[96] Seth Lloyd. Universal quantum simulators. Science, 273(5278):1073–1078, 1996.
61

[97] Ben P Lanyon, Cornelius Hempel, Daniel Nigg, Markus Müller, Rene Gerritsma,
F Zähringer, Philipp Schindler, Julio T Barreiro, Markus Rambach, Gerhard Kirch-
mair, et al.
Universal digital quantum simulation with trapped ions.
Science,
334(6052):57–61, 2011.
[98] Y. Salathé, M. Mondal, M. Oppliger, J. Heinsoo, P. Kurpiers, A. Potočnik, A. Mez-
zacapo, U. Las Heras, L. Lamata, E. Solano, S. Filipp, and A. Wallraff. Digital
quantum simulation of spin models with circuit quantum electrodynamics. Phys.
Rev. X, 5:021027, Jun 2015.
[99] Hsin-Yuan Huang, Michael Broughton, Jordan Cotler, Sitan Chen, Jerry Li, Ma-
soud Mohseni, Hartmut Neven, Ryan Babbush, Richard Kueng, John Preskill, et al.
Quantum advantage in learning from experiments. Science, 376(6598):1182–1186,
2022.
[100] Chih-Chiao Hung, Tim Kohler, and Kevin D. Osborn. Quantum defects from single
surface exhibit strong mutual interactions. arXiv:2302.00318, 2023.
[101] Kishor Bharti, Alba Cervera-Lierta, Thi Ha Kyaw, Tobias Haug, Sumner Alperin-
Lea, Abhinav Anand, Matthias Degroote, Hermanni Heimonen, Jakob S. Kottmann,
Tim Menke, Wai-Keong Mok, Sukin Sim, Leong-Chuan Kwek, and Alán Aspuru-
Guzik. Noisy intermediate-scale quantum algorithms. Rev. Mod. Phys., 94:015004,
Feb 2022.
[102] P.W. Shor. Fault-tolerant quantum computation. IEEE Comput. Soc. Press, 1996.
[103] Daniel Gottesman. Theory of fault-tolerant quantum computation. Physical Review
A, 57(1):127–137, 1998.
[104] Philip Walther, Kevin J Resch, Terry Rudolph, Emmanuel Schenck, Harald We-
infurter, Vlatko Vedral, Markus Aspelmeyer, and Anton Zeilinger.
Experimental
one-way quantum computing. Nature, 434(7030):169–176, 2005.
[105] Giulio Chiribella and Hlér Kristjánsson. Quantum shannon theory with superposi-
tions of trajectories. Proceedings of the Royal Society A: Mathematical, Physical
and Engineering Sciences, 475(2225):20180903, 2019.
[106] Richard E. Cleve. Quantum information processing - quantum information theory
(i), November 2021.
62

[107] B. M. Escher, R. L. de Matos Filho, and L. Davidovich. General framework for
estimating the ultimate precision limit in noisy quantum-enhanced metrology. Nature
Physics, 7(5):406–411, 2011.
[108] Rafał Demkowicz-Dobrzański, Jan Kołodyński, and Mădălin Guţă.
The elusive
heisenberg limit in quantum-enhanced metrology.
Nature Communications, 3(1),
2012.
[109] Man-Duen Choi.
Completely positive linear maps on complex matrices.
Linear
Algebra and its Applications, 10(3):285–290, 1975.
[110] Sergey Bravyi and Alexei Kitaev. Universal quantum computation with ideal clifford
gates and noisy ancillas. Physical Review A, 71(2), 2005.
[111] Scott Aaronson and Daniel Gottesman. Improved simulation of stabilizer circuits.
Phys. Rev. A, 70:052328, Nov 2004.
[112] Harry Levine, Alexander Keesling, Giulia Semeghini, Ahmed Omran, Tout T. Wang,
Sepehr Ebadi, Hannes Bernien, Markus Greiner, Vladan Vuletić, Hannes Pichler,
and Mikhail D. Lukin. Parallel implementation of high-fidelity multiqubit gates with
neutral atoms. Phys. Rev. Lett., 123:170503, Oct 2019.
[113] Xiu Gu, Jorge Fernández-Pendás, Pontus Vikstal, Tahereh Abad, Christopher War-
ren, Andreas Bengtsson, Giovanna Tancredi, Vitaly Shumeiko, Jonas Bylander,
Göran Johansson, and Anton Frisk Kockum. Fast multiqubit gates through simulta-
neous two-qubit gates. PRX Quantum, 2:040348, Dec 2021.
[114] Yosep Kim, Alexis Morvan, Long B. Nguyen, Ravi K. Naik, Christian Jünger, Larry
Chen, John Mark Kreikebaum, David I. Santiago, and Irfan Siddiqi. High-fidelity
three-qubit iToffoli gate for fixed-frequency superconducting qubits. Nature Physics,
18(7):783–788, May 2022.
[115] Jorge Miguel-Ramiro, Zheng Shi, Albie Chan, Luca Dellantonio, Christine A.
Muschik, and Wolfgang Dür. SQEM: Superposed quantum error mitigation. Preprint:
arxiv, 2023.
[116] Muhammad Kashif and Saif Al-Kuwari. Physical realization of measurement based
quantum computation. arXiv:2302.00318, 2023.
[117] J.R. Johansson, P.D. Nation, and Franco Nori.
Qutip 2: A python framework
for the dynamics of open quantum systems. Computer Physics Communications,
184(4):1234–1240, 2013.
63

[118] Cirq Developers.
Cirq, December 2022.
See full list of authors on Github:
https://github .com/quantumlib/Cirq/graphs/contributors.
[119] Matthew Neeley,
Radoslaw C Bialczak,
M Lenander,
Erik Lucero,
Matteo
Mariantoni, AD O’connell, D Sank, H Wang, M Weides, J Wenner, et al.
Gen-
eration of three-qubit entangled states using superconducting phase qubits. Nature,
467(7315):570–573, 2010.
[120] Radoslaw C Bialczak, Markus Ansmann, Max Hofheinz, Erik Lucero, Matthew Nee-
ley, Aaron D O’Connell, Daniel Sank, Haohua Wang, James Wenner, Matthias Stef-
fen, et al. Quantum process tomography of a universal entangling gate implemented
with josephson phase qubits. Nat. Phys., 6(6):409–413, 2010.
[121] Lorenza Viola and Seth Lloyd. Dynamical suppression of decoherence in two-state
quantum systems. Phys. Rev. A, 58:2733–2744, Oct 1998.
[122] Lorenza Viola, Emanuel Knill, and Seth Lloyd. Dynamical decoupling of open quan-
tum systems. Phys. Rev. Lett., 82:2417–2421, Mar 1999.
[123] Lorenza Viola, Seth Lloyd, and Emanuel Knill. Universal control of decoupled quan-
tum systems. Phys. Rev. Lett., 83:4888–4891, Dec 1999.
[124] H. Y. Carr and E. M. Purcell.
Effects of diffusion on free precession in nuclear
magnetic resonance experiments. Phys. Rev., 94:630–638, May 1954.
[125] M. J. D. Powell. A direct search optimization method that models the objective and
constraint functions by linear interpolation. In S. Gomez and J.-P. Hennart, editors,
Advances in Optimization and Numerical Analysis, volume 275 of Mathematics and
Its Applications, pages 51–67. Springer, 1994.
[126] D. R. Jones, C. D. Perttunen, and B. E. Stuckman. Lipschitzian optimization without
the Lipschitz constant. Journal of Optimization Theory and Applications, 79:157–
181, 1993.
[127] Steven G. Johnson. The NLopt nonlinear-optimization package. https://github.
com/stevengj/nlopt, 2007.
[128] Miroslav Urbanek, Benjamin Nachman, Vincent R. Pascuzzi, Andre He, Christian W.
Bauer, and Wibe A. de Jong. Mitigating depolarizing noise on quantum computers
with noise-estimation circuits. Physical Review Letters, 127(27), 2021.
[129] The Qiskit Nature developers and contributors. Qiskit Nature 0.6.0, April 2023.
64

[130] Sergey B. Bravyi and Alexei Yu. Kitaev. Fermionic quantum computation. Ann.
Phys., 298(1):210–226, 2002.
[131] Jiaxin Zhang. Modern Monte Carlo methods for efficient uncertainty quantification
and propagation: A survey. arXiv:2011.00680, 2020.
[132] Nicolai Friis, Vedran Dunjko, Wolfgang Dür, and Hans J. Briegel. Implementing
quantum control for unknown subroutines. Physical Review A, 89(3), 2014.
65

APPENDICES
66

Appendix A
Overview of Measurement-Based
Quantum Computing
In this appendix, we give a more detailed description of the MB-QC protocol. At the
outset, one prepares an entangled resource state – a graph or cluster containing input (I),
body (B) and output (O) qubits connected via CZ-edges. The body and output qubits
are initialized in |+⟩, while the input qubits encode the input state |ψin⟩. The initial state
of the resource |G⟩is therefore:
|G⟩=
Y
{i,j}∈E
CZi,j

|ψin⟩I
O
m∈{B,O}
|+⟩m

,
(A.1)
where E is the set of prescribed edges. This is a +1 eigenstate of the operators ˆSn (i.e.
ˆSn|G⟩= |G⟩), where
ˆSn = ˆXn
Y
k∈N(n)
ˆZk,
(A.2)
and N(n) are the neighbours of qubit n (i.e. those connected to qubit n via a CZ-edge).
The main computation is driven by a series of projective measurements on the input
and body qubits, typically in the eigenbasis of the Pauli operators ˆX, ˆY , ˆZ, or the rotated
basis R(θ) =
n
|0⟩+eiθ|1⟩
√
2
, |0⟩−eiθ|1⟩
√
2
o
.
Conventionally, all input qubits I are chosen to be
measured in the X-basis [2]. Each measurement applied to a qubit removes it from the
resource state and modifies the remaining connections depending on the prescribed basis.
Concurrently, |ψin⟩is propagated through each body qubit (known as feedforward), and
67

upon reaching the output qubits it will have undergone a linear transformation V :
V : |ψin⟩→|ψout⟩: HI →HO,
(A.3)
where HI (HO) denotes the Hilbert space spanned by the input (output) qubits, and
|I| = |O| for a unitary transformation. To ensure the result |ψout⟩is deterministic, i.e.,
the same for each possible set of random measurement outcomes, corrective operations are
applied. These comprise byproduct Pauli operators ˆUΣ ∈{ˆI, ˆX, ˆY , ˆZ}⊗|O| acting on |ψout⟩
and angle adaptations Mi(R(θ)) →Mi(R(±θ)) for qubits i measured in non-Clifford bases
(i.e. θ ̸≡0 mod π/2). The angle adaptations require knowledge of prior outcomes, implying
that a temporal (causal) order for measuring the adaptive qubits must exist for a pattern
to yield deterministic results. In other words, an adaptive qubit may be measured only
after all measurements that it depends on have taken place. The projective measurements
( ˆP), the byproduct operators and the angle adaptations form an MB pattern realizing V ,
with
|ψout⟩= V |ψin⟩= ˆUΣ ˆP|G⟩.
(A.4)
Elementary one- and two-logical qubit gates correspond to well-known patterns [2],
which are sufficient for universal computation. An arbitrary gate sequence may be achieved
by concatenating each output of a pattern to the corresponding input of the next [2].
Example.
To illustrate the MB-QC procedure, we will derive and verify the MB pat-
tern corresponding to the ˆZ⊗3(θ) operation, which is combined with rotation gates to form
the ˆP⊗3 gadget. In the GB paradigm, it realizes the unitary:
ˆUGB(θ) = CX1,2CX2,3RZ3(θ)CX2,3CX1,2
= diag(e−iθ/2, eiθ/2, eiθ/2, e−iθ/2, eiθ/2, e−iθ/2, e−iθ/2, eiθ/2).
(A.5)
From the gate sequence in Eq. (A.5), we may construct an equivalent MB pattern via
concatenation, which yields a 31-qubit pattern [Fig. A.1]. (Note CX can be expressed in
terms of CZ and H operations.) To reduce the number of initial qubits, we apply graph-
theoretic simplifications to the pattern via the ZX-calculus (Ref. [10]), which enables a
reduction from 31 to 15 qubits. The simplified pattern is shown in Fig. A.1, where the
edges are:
E ={(4, 5), (6, 7), (13, 8), (9, 4), (9, 12), (12, 5), (5, 14), (15, 10), (4, 11), (1, 11), (6, 5), (3, 7),
(9, 6), (6, 10), (4, 8), (2, 9)}.
(A.6)
68

The relation between input and output states is therefore:
|ψout,MB⟩13,14,15 = ˆP ˆUΣ|G⟩1,2,...,15 = ˆP ˆUΣ
 Y
{i,j}∈E
CZi,j

|Gψin,MB⟩1,2,3 ⊗|+⟩⊗12
4,5,...,15

,
(A.7)
where |G⟩is the term in square brackets. By convention, we measure the input qubits
first, followed by the non-adaptive (Clifford) and adaptive (non-Clifford) qubits. Since
the inputs and non-adaptive qubits are not affected by the temporal ordering, they may
be measured simultaneously. To calculate ˆUΣ, we solve eigenvalue equations (Eq. (82) of
Ref. [2]) for each qubit i. These equations are a direct consequence of Eq. (A.2), and
determine whether to apply ˆXi, ˆZi or both on qubit i if it measures 1 (denoted by si). A
similar step is performed to solve for the adaptive corrections on qubit 12, which indicate
which outcomes of qubit 1–11 require the measurement angle of qubit 12 to be flipped (i.e.
θ →−θ). Here, we must obey the temporal ordering by considering only qubits that have
been measured up to that point (i.e. qubits 1–11). For the pattern in Fig. A.1, we find the
projective measurements and byproducts to be:
ˆP = M12
 R(θ(−1)s5+s8+s10)
 11
Y
k=1
Mk(X),
(A.8)
ˆUΣ = ˆZs3+s6+s12
15
ˆXs7+s10
15
ˆZs2+s12
14
ˆXs5+s9
14
ˆZs1+s4+s12
13
ˆXs8+s11
13
,
(A.9)
where Mk is the measurement operator on qubit k and sk ∈{0, 1} its corresponding
outcome.
Because of the outcome dependence of ˆUΣ, they must be applied after the
measurements and therefore require commutation over the operations in Eq. (A.5), which
V implements.
Here, we note that the diagonal form of the unitary implies that ˆUΣ
remains unchanged after commutation [32]; however, the adaptive corrections on qubit 12
are affected. Eqs. (A.7) and (A.8) become:
|ψout,MB⟩13,14,15 = ˆUΣ ˆP ′|G⟩1,2,...,15,
(A.10)
ˆP ′ = M12
 R(θ(−1)s7+s9+s11)
 11
Y
k=1
Mk(X),
(A.11)
where we have used the commutation relations in Eqs. (72) and (73) of Ref. [2].
For
simplicity, we consider a scenario where each qubit of the input state is a Pauli eigenvector
|+⟩; however, any valid measurement pattern can process an arbitrary input. We discuss
how to address such cases in App. F.
69

Simplify  
via 
ZX-Calculus
FIG. A.1: MB pattern for Z⊗3(θ), obtained by concatenating smaller patterns corre-
sponding to each operation in Eq. (A.5). To reduce the number of initial qubits, the pattern
is simplified via the techniques of Ref. [10]. Black and light green circles denote input and output
qubits respectively, blue lines denote CZ-edges, green circles denote nonadaptive qubits measured
in the X-basis, and orange circles denote adaptive qubits measured in the R(θ)-basis. The num-
bers label the qubits and their measurement order (excluding outputs).
One may now proceed and perform Eq. (A.11) directly. However, since the majority of
qubits (1–11) are non-adaptive, they can be efficiently simulated classically via the stabilizer
formalism of Ref. [111]. To do this, we employ the tableau representation of stabilizer states
and track the input state as it undergoes Clifford operations and measurements. For all
qubits initialized in |+⟩, the stabilizer state is given by:
{(+ ˆX1)...(+ ˆX15)}.
(A.12)
After performing all CZs and non-adaptive (X-basis) measurements in Eq. (A.11), the
canonical form stabilizers over the remaining adaptive and output qubits (assuming an
outcome of 0 for qubits 1–11) are:
{(+ ˆZ1), (+ ˆZ2), ..., (+ ˆZ11), (+ ˆX12 ˆX15), (+ ˆZ12 ˆZ13 ˆZ14 ˆZ15), (+ ˆX13 ˆX15)},
(A.13)
where elementary row operations were used to reduce each of qubits 1–11 to a single +Z.
These stabilizers, corresponding to the post-measured state |0⟩may be subsequently traced
out from the overall state. Using the Gottesman-Knill theorem [111], we then work out a
unitary ˆUCliff that produces a reduced graph state stabilized by the operators above. To
achieve the form of Eq. (A.2) (which describes the connectivity of graphs), we express
Eq. (A.13) as a generator matrix over qubits 12–15 and reduce the stabilizer ( ˆX) portion
to row-echelon form, where each manipulation incurs a local Clifford (LC) operation H or
70

S (see Ref. [111]). The resulting stabilizers and circuit are:




ˆZ1
0
1
0
0
ˆZ2
0
1
0
0
ˆZ3
0
1
0
0
ˆZ4
0
1
0
0
ˆX1
1
0
0
0
ˆX2
0
0
1
0
ˆX3
0
0
0
1
ˆX4
1
0
1
1
H4
−→




ˆZ1
0
0
0
1
ˆZ2
0
0
0
1
ˆZ3
0
0
0
1
ˆZ4
1
1
1
0
ˆX1
1
0
0
0
ˆX2
0
1
0
0
ˆX3
0
0
1
0
ˆX4
0
0
0
1
(A.14)
→{(+ ˆX1 ˆZ4), (+ ˆX2 ˆZ4), (+ ˆX3 ˆZ4), (+ ˆX4 ˆZ1 ˆZ2 ˆZ3)}
(A.15)
=⇒ˆUCliff = H4CZ1,4CZ1,3CZ1,2,
(A.16)
where H4 is a LC-operation and we have relabelled qubits 13, 14, 15, 12 as 1, 2, 3, 4
respectively. Consequently, V reduces to a 4-qubit (3 + 1 ancilla) pattern, and we have:
|ψout,MB⟩1,2,3 = Vreduced ˆUCliff|+⟩⊗4
1,2,3,4
= ( ˆZ3 ˆZ2 ˆZ1)s4M4
 R(θ(−1)s4)
 ˆUCliff|+⟩⊗4
1,2,3,4.
(A.17)
One observes that the graph structure corresponding to Eq. (A.15) resembles that shown
in Fig. 2.1(a). If qubit 4 is measured with outcome 1 (s4 = 1), we obtain the final output:
|ψout,MB⟩1,2,3 = 1
√
8
ˆZ3 ˆZ2 ˆZ1
h
e−iθ/2
X
x∈{b1...b3∈⃗b|b1+...+b3=0}
|x⟩−eiθ/2
X
x′∈{b1...b3∈⃗b|b1+..+b3=1}
|x′⟩
i
= 1
√
8
h
e−iθ/2
X
x∈{b1...b3∈⃗b|b1+...+b3=0}
|x⟩+ eiθ/2
X
x′∈{b1...b3∈⃗b|b1+...+b3=1}
|x′⟩
i
,
(A.18)
where ⃗b = {0, 1}⊗3. It is straightforward to verify that the state is equivalent (up to a
global phase) to ˆUGB acting on |+⟩⊗3.
In summary, MB-QC constitutes a natural method of computation for platforms that
implement highly entangled graph or cluster states, including photonic and spin qubits.
Despite the larger number of ancillary qubits employed in comparison to GB-QC, the
method is beneficial when the resource state contains a large Clifford portion, as shown in
71

the example above. By performing the majority of the pattern classically, one drastically
reduces the size of the resource state to be implemented. On a practical level, this can
yield fewer computational steps, and in noisy cases, opportunities for the overall resource
to decohere.
72

Appendix B
Hybrid VQE Demonstrations –
Methods and Techniques
In this appendix, we discuss the numerical program and associated methods used to perform
VQE simulations on IBM Quantum systems.
We also detail the error mitigation and
suppression techniques implemented to combat noise and decoherence effects prevalent on
real hardware. A schematic of the entire program is depicted in Fig. B.1.
Setup. The program takes in three main inputs, which are specified by the user:
1. A target Hamiltonian ˆH describing the physical system, expressed as a sum of Pauli
interactions [Eq. (2.7)].
2. A parameterized ansatz circuit that outputs |ψ(θ)
a ⟩to compute the mean energy E =
⟨ψa| ˆH|ψa⟩.
3. A starting guess for the variational parameters (⃗θ(i)).
To assess VQE performance, we use the above to calculate the exact GS (|ψ0⟩) and GS
energy E0 = ⟨ψ0|H|ψ0⟩via exact diagonalization (ED). We note that this is feasible only
for small to intermediate system sizes.
Measurement protocol. To calculate the total energy, we group all observables in ˆH
into n commuting sets gn, where all commuting observables within a set are measured
simultaneously by a single circuit (for a total of n). For example, in the Z2 demonstration,
we require two circuits — one measuring XXXX and the other measuring ZZZZ, since
they commute with all terms in ˆH□and ˆH△respectively.
73

Choosing measurement shot numbers. Given the iterative nature of VQE, a practical
approach involves minimizing the allocated budget, which encompasses the number of op-
timizer iterations/function evaluations and the total number of measurement shots over
all circuit executions. While there are standard choices for the former, selecting an appro-
priate budget for the latter while balancing performance is less straightforward. Here, we
take an adaptive approach based on the size of the first energy gap Eg = E1 −E0. We
treat Eg as an indicator of the optimization difficulty in that the smaller it is, the more
statistical counts are needed to resolve the difference. In this sense, we may regard Eg as
the standard deviation over all i commuting sets gi ∈ˆH, weighted by their respective shots
Ngi:
Eg =
s
⟨ˆHg1⟩2
Ng1
+ ⟨ˆHg2⟩2
Ng2
+ ... + ⟨ˆHgi⟩2
Ngi
.
(B.1)
We also assume that the variation due to gi is weighted by the sum of the n coefficients
corresponding to the n Pauli terms in the group:
⟨ˆHgi⟩2 =
X
n
(g(n)
i
)2.
(B.2)
To minimize the L.H.S, we require that all terms in Eq. (B.1) are equal:
P g12
Ng1
=
P g22
Ng2
= ... =
P gi2
Ngi
.
(B.3)
For practical purposes, we run each circuit with the same number of shots, and so the
problem reduces to optimizing the total number Ntot = Ng1 + Ng2 + ... + Ngi. One can
employ a classical optimizer to solve for each Ngi; however, in the case of two groups, the
problem may be solved directly and we find that:
Ng1 = RNg2;
R =
P g12
P g22
(B.4)
=⇒Ng1 =
R
1 + RNtot =⇒Eg =
s
2
1 + R
RNtot
 X
g2
1
(B.5)
=⇒Ntot = 2
 1 + R
R(Eg)2
 X
g2
1.
(B.6)
We then extend Eq. (B.6) directly to the general case, and replace the prefactor with a
generic scaling factor s that can be chosen depending on the range of shots desired. We
74

also drop the weighting factor (1+R)/R and match Ntot to the commuting group with the
largest coefficient sum. Thus, we have:
Ntot =

s
(Eg)2 max
g∈G
 X
i
(c(i)
g )2

,
(B.7)
where G is the set of all commuting groups belonging to ˆH and c(i)
g is the coefficient of the
ith Pauli in group g. To ensure a representative enough sample, we impose that Ntot is at
least 250. Likewise, Ntot is capped at 5 × 104 to avoid large processing demands on the
hardware. Any calculated Ntot falling outside these ranges are set to the closer of the two
limits.
Readout mitigation. This is a standard technique to reduce errors from readout mea-
surements [119, 120], which yield the counts data for calculating observable expectation
values. The main principle involves capturing the extent of the readout errors via a cal-
ibration matrix M. Each element in M is the probability of initializing a computational
basis state |x⟩and subsequently measuring |x′
meas⟩(i.e. |⟨x′
meas|x⟩|2). This requires the
execution of 2n basis circuits, where n is the number of qubits in ˆH. For example, M has
the following structure for n = 3 (acquired from a sample run on ibm_perth):
|000⟩
|001⟩
|010⟩
|011⟩
|100⟩
|101⟩
|110⟩
|111⟩






















⟨000|
0.95446
0.02772
0.01029
0.00000
0.00980
0.00000
0.00000
0.00000
⟨001|
0.02178
0.95248
0.00000
0.01437
0.00000
0.00596
0.00000
0.00000
⟨010|
0.01386
0.00000
0.97942
0.01848
0.00000
0.00000
0.00648
0.00000
⟨011|
0.00000
0.01386
0.00617
0.95277
0.00000
0.00000
0.00000
0.00386
⟨100|
0.00594
0.00000
0.00000
0.00000
0.95686
0.02187
0.01296
0.00000
⟨101|
0.00000
0.00396
0.00000
0.00000
0.02157
0.94433
0.00000
0.01544
⟨110|
0.00000
0.00000
0.00000
0.00000
0.00784
0.00199
0.96544
0.00579
⟨111|
0.00000
0.00000
0.00000
0.01027
0.00000
0.02187
0.01296
0.96525
(B.8)
For low noise levels, M is expected to be predominantly diagonal and close to the identity
(as is shown above). Furthermore, if ancillary qubits are present (i.e. in the Pauli gadget
demonstrations), we determine a separate calibration matrix over n qubits for each possible
set of ancillary outcomes.
If Cideal is the counts distribution corresponding to the exact E0, then MCideal leads
to an approximation of the noisy distribution Cnoisy. Naturally, we wish to perform the
reverse. Näively, this is achieved by applying M −1Cnoisy, where M −1 is the inverse of M;
however, it can yield negative counts (quasiprobabilities). We remedy this by performing
75

a least-square fit to the closest valid distribution. After the calibration matrix is deter-
mined, it is stored and applied to the counts distribution from every subsequent circuit
evaluation. This is most ideal when the hardware-specific parameters (i.e. error rates,
decoherence times) are constant; however, as drifts in the parameters over time are ex-
pected, we determine M more than once (i.e. after each data point) to ensure the errors
are accurately captured throughout the course of the VQE run. In all demonstrations, we
employ 104 shots for each basis circuit used to determine M.
VQE algorithm. As shown in Fig. B.1, the VQE proceeds as a closed feedback loop
between the quantum processor and classical optimizer. Prior to circuit execution, we
apply various techniques to suppress noise:
1. Performing the circuits requires one to specify a mapping between virtual and phys-
ical hardware qubits. Since the latter is restricted by the qubit topology, SWAP
operations (each incurring three CXs) are added to match the connectivity of the
considered circuit. With CXs being the most expensive operation on IBM Quantum
systems, we choose mappings that lead to the fewest number of added SWAPs. At
the time of the simulation run, we also ensure that the chosen qubits have reasonably
small CX errors and long decoherence times.
2. Resets and delays are added to the beginning of each circuit. This improves the
likelihood of each qubit being properly initialized in the ground state |0⟩.
3. On the pulse level, we schedule circuits to incorporate dynamical decoupling (DD)
[121, 122, 123].
This mitigation technique inserts extra pulses (equivalent to the
identity) whenever a particular qubit is idle. Although it introduces further noise,
the periodicity of the applied pulses enable undesired state rotations from system-
environmental interactions to be reversed. Here, we employ X-X pulses, which are
commonly employed in spin-refocusing techniques to increase the coherence time of
qubits [124].
During the VQE, the ansatz circuit is sent to and executed on the IBM Quantum hardware,
which outputs results in the form of counts data. From the counts, we compute the total
energy E and contributions ⟨ˆO1⟩, ⟨ˆO2⟩...⟨ˆON⟩from specific observables of interest. The
value of E is then sent to a classical optimizer, which modifies ⃗θ with the goal of minimizing
E. The above process repeats until a stopping condition for convergence is met by the
optimizer, at which point the final energy Eopt and parameters ⃗θ(opt) are returned.
All circuits are performed on IBM Quantum systems, with readout measurements cho-
sen depending on the desired basis.
Furthermore, all circuits employing Pauli gadgets
76

1. Physical Model
ℋ" = Σ! ⊗"#$
%
𝑐"𝜎" 
2. Starting Guess
𝜃⃗(') = {𝜃$
' , 𝜃)
('),…, 𝜃*
(')}
3. Exact Solution (ED)
 
Hybrid Ansatz
𝐸= Σ! ℋ"!
𝑂0$ , 𝑂0) … 𝑂0+
VQE
𝐸,-., Δ𝐸,-., 𝜎,-.
𝑂0/,,-.  ∀ 𝐾= 1, … , 𝑘
Output
Execute
Prepare  
Tomography 
Circuits
ℱ= 𝑇𝑟
𝜌!𝜌" # 
Optimizer
Noise Supression
Dynamical Decoupling
Circuit Optimization
Resets + Delays 
Noise Mitigation
Readout Mitigation 
“Self” Mitigation
Fit Data 
(Least Sq.)
GB/MB Hardware
Counts
𝐸" = Ψ" ℋ* Ψ"
𝑂0$ ', 𝑂0) ', … , 𝑂0+ '
Input
Compute
SETUP
𝜃⃗("#$)
RESULTS
XX…X
XX…Y
ZZ…Y
ZZ…Z
…
Reconstruct 𝜌!
3. Exact Solution (ED)
 
Hybrid Ansatz
VQE
Output
Execute
Prepare  
Tomography 
Circuits
Optimizer
Noise Supression
Dynamical Decoupling
Circuit Optimization
Resets + Delays 
Noise Mitigation
Readout Mitigation 
“Self” Mitigation
Fit Data 
(Least Squares)
Quantum Hardware
Counts
Revise 
Compute
SETUP
RESULTS
…
Reconstruct 𝜌!
2. Starting Guess
1. Physical Model
Minimize 𝐸
FIG. B.1: Complete workflow for the numerical VQE program. Readout mitigation and
all noise suppression techniques are employed during execution of each variational circuit, while
self-mitigation occurs immediately after ⃗θ (opt) is determined.
are performed dynamically. These incorporate added if_test instructions in the circuit,
which act corrective byproduct ( ˆUΣ) and adaptive operations (see App. A) on the main
qubits based on the outcomes of the ancillary qubits measured previously.1 This enables
one in practice to perform MB-QC with a circuit (i.e. as opposed to clusters or graphs).
By convention, the byproduct operator for a Pauli gadget only acts nontrivially when the
ancilla measurement outcome is ‘1’. Fig. B.2 depicts the dynamic circuit used in the Z2
demonstration.
We employ the COBYLA and DIRECT methods for the classical optimization. COBYLA
[125] enables a rapid and expansive search of the energy landscape with few iterations,
while DIRECT [126] enables a more systematic search, identifying promising areas that
may contain the global minimum. When using the latter, we follow the recommendation
in Ref. [127] and perform a second, local minimization (i.e. COBYLA) afterwards to refine
the search in the most promising region. While SPSA is often recommended for noisy
simulations [80, 92], we avoid its use as it generally requires large iteration numbers to
converge. Indeed, our circuits have reasonably small depths and few parameters such that
they achieve a low-enough level of noise for other optimizers to be effective.
Self-mitigation. At the conclusion of the VQE run, we employ the self-mitigation tech-
nique [13, 77, 128]. It specifically addresses CX errors by evaluating the ansatz circuit in
two ways. First, there is a physical run using the circuit parameterized with ⃗θ(opt), then
there is a mitigation run which involves a modified version of the physical as reference. In
both runs, each CX is dressed with randomly chosen single-qubit operations (see Ref. [77]
1The adaptive bases discussed in App. A are not required for the Pauli gadget, provided the byproduct
operators are applied immediately after each gadget [32].
77

IL
RL
RL
Readout 
Pauli Gadget (MB Portion) 
FIG. B.2: Sample dynamic circuit performed in the Z2 VQE demonstration. The qubits
and corresponding classical registers for storing measurement outcomes are labelled by q and c
respectively. After the mid-circuit measurement of the ancilla (q4), the dynamic if_else instruc-
tion (highlighted in red) implements the byproduct operators ˆUΣ = ( ˆZ0 ˆZ1 ˆZ2 ˆZ3)c4 corresponding
to the ˆZ⊗4 operation (see App. A). The measurement basis of the circuit is XXXX.
for details). These do not alter the action of the CX operations (they only change the
basis), but instead transform the CX noise from being coherent to incoherent in nature.
The correction acts as a scale factor on any given Pauli-string observable ⟨ˆO⟩, based on
the results of evaluating the physical and mitigation runs. It is given by:
⟨ˆO⟩phys, true = ⟨ˆO⟩phys, meas ×
 
⟨ˆO⟩mitig, true
⟨ˆO⟩mitig, meas
!κ
,
(B.9)
where κ is the ratio of CX gate numbers between the physical and mitigation circuits, and
“true” (“meas”) refers to the exact (noisy) expectation values. To minimize added resources,
all observables that commute with the measurement basis of the ansatz circuit are corrected
with the same factor. For simplicity, we also formulate our mitigation circuits so that κ = 1
and ⟨ˆO⟩mitig, true = 1. We achieve κ = 1 by including only the CXs present in the ansatz
circuit [128]. In both cases, a suitable initial state is chosen to ensure ⟨ˆO⟩mitig, true = 1,
with LC-operations added where necessary.
State fidelity. In the final step, we perform full state tomography to determine the
ansatz state corresponding to ⃗θ(opt). This requires the evaluation of 3n circuits (i.e. all
78

n-qubit combinations of X, Y , and Z Paulis). In all demonstrations, we employ 104 shots
for each circuit evaluation. If ancillas are present, their counts are marginalized over the
counts of the readout qubits. The 3n counts distributions are then fitted to a valid density
matrix ρa using maximum likelihood estimation, which corresponds to the reconstructed
ansatz state. This enables us to compute the state fidelity F between ρa and the exact GS
(ρ0) as
F = Tr(√ρaρ0)2,
(B.10)
where Tr is the trace operation. As with exact diagonalization, calculating F via tomog-
raphy is practical only for small system sizes owing to the exponential scaling.
79

Appendix C
Hybrid VQE Demonstrations –
Supplementary Information
This appendix presents target Hamiltonians, ground state properties, and raw data from
the hybrid VQE demonstrations on IBM Quantum systems (Ch. 2). All demonstrations
employed single-layer ansatz modifications (L = 1) or single Pauli gadgets (g = 1).
Notes:
1. For all data presented, we refer to App. B for a discussion of how the measure-
ment shots were selected. All scaling factors s in Eq. (B.7) were chosen heuristically
based on prior trial-and-error VQE simulation runs, combined with the optimization
difficulty of the considered model.
2. NCX refers to the number of CX gates in a VQE circuit after its qubits were mapped
to the respective IBM system.
3. Unless otherwise stated, all reported energies are unitless and may be expressed in
absolute units (e.g. eV, J, Ha) using a scaling factor with appropriate dimensions.
1D QCD: ˆH defined by Eq. (2.9); see Ref. [77] for ground state properties.
PC: ˆH defined by Eq. (2.4) (M = 2, N = 1); see App. E for a perturbative analysis
of ground state properties.
80

Z2 LGT, single plaquette:
ˆHZ2 = λ ˆX1 ˆX2 ˆX3 ˆX4 + 1
λ
4
X
i=1
ˆZi
(C.1)
|Ψ0⟩=
s
1
2 +
2
√
16 + λ4
4 −
√
16 + λ4
λ2
|0⟩⊗4 + |1⟩⊗4

,
E0 = −
r
16
λ2 + λ2
(C.2)
LiH:
|Ψ0⟩≈0.9877 |0011⟩−0.1154 |1100⟩,
E0 = −7.881072044030926
(C.3)
Hamiltonian derived from Qiskit VQE tutorial [41, 129] (shown in Table C.1), with parity
transformation to map fermionic to spin qubits [130]. State simplifications include freezing
core orbitals [80] to reduce the number of initial qubits from 12 to 4.
Table C.1: 4-qubit Hamiltonian for the LiH molecule.
All Pauli terms are weighted by the
coefficients shown and summed.
IIIZ
−0.0938
IIZX
−0.00318
IIIX
0.00318
IIXX
−0.00125
IIY Y
0.00125
IIZZ
−0.212
IIXZ
0.0192
IIXI
0.0192
IIZI
0.358
IZII
0.0938
ZXII
0.00318
IXII
0.00318
XXII
−0.00125
Y Y II
0.00125
ZZII
−0.212
XZII
−0.0192
XIII
0.0192
ZIII
−0.358
IZIZ
−0.122
IZZX
0.0121
IZIX
−0.0121
IZXX
0.0317
IZY Y
−0.0317
IXIZ
0.0121
ZXIZ
0.0121
IXZX
−0.00327
ZXZX
−0.00327
IXIX
0.00327
ZXIX
0.00327
IXXX
−0.00865
ZXXX
−0.00865
IXY Y
0.00865
ZXY Y
0.00865
Y Y IZ
0.0317
XXIZ
−0.0317
Y Y ZX
−0.00865
XXZX
0.00865
Y Y IX
0.00865
XXIX
−0.00865
Y Y XX
−0.031
XXXX
0.031
Y Y Y Y
0.031
XXY Y
−0.031
ZZIZ
0.0559
ZZZX
0.00187
ZZIX
−0.00187
ZZXX
0.0031
ZZY Y
−0.0031
XIIZ
0.0128
XZIZ
−0.0128
XIZX
−0.00235
XZZX
0.00235
XIIX
0.00235
XZIX
−0.00235
XIXX
−0.00798
XZXX
0.00797
XIY Y
0.00797
XZY Y
−0.00797
ZIIZ
0.113
ZIZX
−0.0108
ZIIX
0.0108
ZIXX
−0.0336
ZIY Y
0.0336
IZZZ
−0.0559
IZXZ
−0.0128
IZXI
−0.0128
IXZZ
−0.00187
ZXZZ
−0.00187
IXXZ
0.00235
ZXXZ
0.00235
IXXI
0.00235
ZXXI
0.00235
Y Y ZZ
−0.0031
XXZZ
0.0031
Y Y XZ
0.00798
XXXZ
−0.00798
Y Y XI
0.00798
XXXI
−0.00798
ZZZZ
0.0845
ZZXZ
−0.00899
ZZXI
−0.00899
XIZZ
−0.00899
XZZZ
0.00899
XIXZ
0.00661
XZXZ
−0.00661
XIXI
0.00661
XZXI
−0.00661
ZIZZ
0.0604
ZIXZ
0.011
ZIXI
0.011
IZZI
0.113
IXZI
−0.0108
ZXZI
−0.0108
Y Y ZI
−0.0336
XXZI
0.0336
ZZZI
−0.0604
XIZI
−0.011
XZZI
−0.011
ZIZI
−0.113
IIII
−7.012
81

Table C.2: Optimized energies, operator expectation values, fidelities, and errors for the Z2 VQE demonstration
(s = 100).
λ
System
Optimizer
Shots, Iters.
NCX
κ
E(i)
VQE
E(f)
VQE
E0
Eg
0.5
0.63
0.85
1.12
1.52
1.98
2.33
2.65
2.88
3.3
ibm_peekskill
ibm_peekskill
ibm_peekskill
ibm_peekskill
ibm_peekskill
ibm_peekskill
ibm_peekskill
ibm_peekskill
ibm_peekskill
ibm_peekskill
COBYLA
COBYLA
COBYLA
COBYLA
COBYLA
COBYLA
COBYLA
COBYLA
COBYLA
COBYLA
13857, 50
16267, 50
22187, 50
34372, 50
50000, 50
50000, 50
50000, 50
50000, 50
50000, 50
50000, 50
7
7
7
7
7
7
7
7
7
7
1
1
1
1
1
1
1
1
1
1
−3.958
−3.162
−2.197
−1.651
−1.157
−0.793
−0.824
−0.587
−0.604
−0.392
−7.427
−6.036
−4.547
−3.436
−2.735
−2.548
−2.659
−2.784
−2.896
−3.104
−8.016
−6.380
−4.782
−3.743
−3.039
−2.829
−2.894
−3.050
−3.197
−3.516
3.984
3.144
2.280
1.635
1.029
0.606
0.411
0.294
0.235
0.160
λ
⟨ˆ□⟩VQE
⟨ˆ□⟩0
⟨ˆ△⟩VQE
⟨ˆ△⟩0
F
σE,VQE
σ□,VQE
σ△,VQE
|∆E|/Eg
0.5
0.63
0.85
1.12
1.52
1.98
2.33
2.65
2.88
3.3
0.0321
−0.0468
−0.166
−0.262
−0.363
−0.481
−0.572
−0.755
−0.868
−0.8559
−0.0624
−0.0987
−0.178
−0.299
−0.500
−0.700
−0.805
−0.869
−0.901
−0.939
−0.936
−0.922
−0.936
−0.880
−0.830
−0.790
−0.773
−0.518
−0.286
−0.230
−0.998
−0.995
−0.984
−0.954
−0.866
−0.714
−0.593
−0.495
−0.434
−0.345
0.862
0.850
0.826
0.811
0.815
0.776
0.818
0.768
0.792
0.812
0.0289
0.0178
0.0153
0.0109
0.00976
0.0112
0.0143
0.0160
0.0197
0.0206
0.00482
0.00560
0.00676
0.00665
0.00763
0.0100
0.0135
0.0150
0.0189
0.0199
0.0285
0.0169
0.0137
0.00870
0.00608
0.00514
0.00493
0.00552
0.00579
0.00510
0.148
0.109
0.103
0.188
0.296
0.464
0.573
0.904
1.282
2.569
82

Table C.3: Optimized energies, operator expectation values, fidelities, and errors for the QCD VQE demonstration
(s = 10).
˜ma
Systemb
Optimizer
Shots, Iters.
NCX
κ
E(i)
VQE
E(f)
VQE
E0
Eg
−1.0
−0.5
−0.2
−0.05
0.01
0.05
0.1
0.2
0.5
1.0
ibm_lagos
ibm_lagos
ibm_lagos
ibm_lagos
ibm_lagos
ibm_peekskill
ibm_peekskill
ibm_lagos
ibm_lagos
ibm_lagos
COBYLA
COBYLA
COBYLA
COBYLA
COBYLA
COBYLA
COBYLA
COBYLA
COBYLA
COBYLA
750, 50
1522, 50
3953, 50
9680, 55
10402, 56
9380, 57
7290, 50
3953, 50
1131, 50
454, 50
4
4
4
4
4
4
4
4
4
4
1
1
1
1
1
1
1
1
1
1
−3.574
−2.179
−1.322
−0.831
−0.704
−0.518
−0.299
1.228
2.073
3.446
−6.240
−3.220
−1.626
−0.952
−0.763
−0.623
−0.570
−0.384
−0.335
−0.164
−6.259
−3.395
−1.791
−1.122
−0.924
−0.822
−0.723
−0.591
−0.395
−0.259
2.878
1.771
0.965
0.639
0.610
0.639
0.719
0.965
1.771
2.878
˜m
⟨ˆN⟩VQE
⟨ˆN⟩0
⟨ˆ
N ′⟩VQE
⟨ˆ
N ′⟩0
F
σE,VQE
σN,VQE
σN′,VQE
|∆E|/Eg
−1.0
−0.5
−0.2
−0.05
0.01
0.05
0.1
0.2
0.5
1.0
5.817
5.638
5.414
4.518
3.067
2.591
1.441
0.548
0.443
0.00737
5.822
5.580
4.963
3.725
2.849
2.275
1.702
1.037
0.420
0.178
3.662
3.454
3.247
2.250
1.060
0.751
0.808
0.00223
0.00905
−0.0801
3.768
3.469
2.815
1.780
1.170
0.814
0.497
0.197
0.0298
0.00468
0.902
0.834
0.888
0.791
0.884
0.792
0.808
0.771
0.923
0.893
0.0368
0.0245
0.0120
0.00741
0.00461
0.00598
0.00845
0.0152
0.0273
0.0499
0.00258
0.00692
0.00147
0.00164
0.00150
0.000951
0.000730
0.00320
0.00352
0.00716
0.0242
0.0170
0.0103
0.00817
0.00404
0.00194
0.00716
0.00902
0.0140
0.00648
0.00673
0.0992
0.171
0.266
0.264
0.311
0.214
0.214
0.0363
0.0332
a At x = 0.8.
b Owing to logistical challenges with the IBM Quantum platform, data points were collected over multiple systems.
83

Table C.4: Optimized energies, fidelities, and errors for the LiH VQE demonstration.a All energies are expressed in
Hartrees (Ha).
System
Optimizer
Shots, Iters.
NCX
κ
E(i)
VQE
E(f)
VQE
E0
E1
E2
F(i)
F(f)
σE,VQE
|∆E|/E0
ibm_perth
COBYLA
10000, 99
7
1
−6.967
−7.794b
−7.881
−7.766
−7.748
0.0673c
0.782c
0.000534
0.0110
a At an interatomic distance of 1.6 Å.
b Since VQE convergence behavior is analyzed here, we do not apply self-mitigation to the final energy.
c See Fig. 2.6(e).
Table C.5: Optimized energies and errors for the 2 × 1 PC VQE demonstration (s = 25).a
ξ
Systemb
Optimizerc
Shots, Itersc
NCXd
κd
E(i)
VQE
E(f)
VQE
E0
Eg
σE,VQE
|∆E|/Eg
0.01
0.0316
0.1
0.316
1.0
1.5
2.0
3.0
4.0
6.0
8.0
10.0
ibm_perth
ibm_lagos
ibm_perth
ibm_perth
ibm_lagos
ibm_lagos
ibm_perth
ibm_lagos
ibm_lagos
ibm_perth
ibm_lagos
ibm_lagos
DIRECT+COBYLA
DIRECT+COBYLA
DIRECT+COBYLA
DIRECT+COBYLA
DIRECT+COBYLA
DIRECT+COBYLA
DIRECT+COBYLA
DIRECT+COBYLA
DIRECT+COBYLA
DIRECT+COBYLA
DIRECT+COBYLA
DIRECT+COBYLA
946, 50 + 50
960, 50 + 50
965, 50 + 50
781, 50 + 50
1653, 50 + 50
10172, 50 + 50
50000, 50 + 50
11722, 50 + 50
4755, 50 + 50
2546, 50 + 50
1981, 50 + 50
1729, 50 + 50
27
27
27
27
27
27
27
27
27
27
26
27
43/27
36/27
40/27
40/27
36/27
36/27
40/27
36/27
36/27
40/27
39/26
36/27
−1.525
−1.516
−1.284
−1.216
−1.755
−1.850
−0.668
−2.269
−1.914
−2.179
−3.106
−2.168
−7.750
−7.800
−7.465
−8.422
−10.880
−13.688
−17.828
−23.588
−30.585
−45.345
−61.001
−80.911
−8.001
−8.009
−8.083
−8.632
−11.465
−13.822
−16.245
−23.083
−30.062
−44.042
−58.031
−72.025
1.991
1.977
1.983
2.316
2.217
1.156
0.120
1.918
3.938
7.959
11.969
15.975
0.227
0.105
0.169
0.199
0.117
0.0696
0.0743
0.227
0.654
2.594
6.316
8.107
0.126
0.106
0.312
0.091
0.264
0.116
0.402e
0.263
0.133
0.164
0.248
0.556
a Since 7 qubits are used in this demonstration, performing full state tomography is impractical and therefore the fidelities F were not calculated.
b See note in Table C.3.
c See discussion in Sec. B regarding optimization methods.
d On account of the larger number of qubits and their fixed connectivity on IBM Quantum systems, we employed the noise adaptive layout
method to map qubits onto hardware [41]. The mapping is chosen automatically by Qiskit’s transpiler (based on current calibration data)
and leads to variations in the number of CX gates incurred by each circuit in a VQE run. Here, we reflect the full range of CX numbers
during self-mitigation by calculating κ from the physical and mitigation circuits with the largest and smallest CX numbers respectively,
over all measurement bases. In other words, we employ the maximum possible κ.
e Calculated using the gap of the second excited state E2 −E1 = 3.939, since the first excited state and the GS are nearly degenerate.
84

Table C.6: Initial and final (optimized) variational parameters for each VQE demonstration.
Model
Free Param.
⃗θ (i)
⃗θ (f)
Z2
λ = 0.5
λ = 0.63
λ = 0.85
λ = 1.12
λ = 1.52
λ = 1.98
λ = 2.33
λ = 2.65
λ = 2.88
λ = 3.3
{3.07, 5.56, 1.11, 4.17}
{3.07, 5.56, 1.11, 4.17}
{3.07, 5.56, 1.11, 4.17}
{3.07, 5.56, 1.11, 4.17}
{3.07, 5.56, 1.11, 4.17}
{3.07, 5.56, 1.11, 4.17}
{3.07, 5.56, 1.11, 4.17}
{3.07, 5.56, 1.11, 4.17}
{3.07, 5.56, 1.11, 4.17}
{3.07, 5.56, 1.11, 4.17}
{3.274, 6.232, 2.023, 4.508}
{3.674, 6.119, 2.946, 4.138}
{3.119, 6.063, 1.11, 4.962}
{3.179, 5.948, 1.152, 4.974}
{3.210, 5.858, 2.710, 4.626}
{3.451, 5.741, 2.654, 4.668}
{3.210, 5.627, 2.766, 4.637}
{3.003, 5.302, 2.728, 4.654}
{3.302, 5.002, 2.790, 4.630}
{2.994, 4.984, 2.726, 4.595}
QCD
˜m = −1
˜m = −0.5
˜m = −0.2
˜m = −0.05
˜m = 0.01
˜m = 0.05
˜m = 0.1
˜m = 0.2
˜m = 0.5
˜m = 1
{π, π/2, π, π/2}
{π, π/2, π, π/2}
{π, π/2, π, π/2}
{π, π/2, π, π/2}
{π, π/2, π, π/2}
{π, π/2, π, π/2}
{π, π/2, π, π/2}
{π/2} × 4
{π/2} × 4
{π/2} × 4
{4.261, 1.551, 3.210, 1.728}
{4.142, 1.826, 3.142, 1.829}
{4.009, 1.682, 3.029, 1.887}
{3.640, 1.571, 3.142, 1.848}
{3.184, 1.502, 3.101, 1.795}
{3.280, 1.722, 3.293, 1.551}
{3.679, 2.131, 3.142, 1.571}
{2.105, 1.581, 2.897, 2.185}
{2.183, 1.671, 3.217, 1.757}
{0.785, 4.328, 2.955, 0.955}
PC
ξ = 0.01
ξ = 0.0316
ξ = 0.1
ξ = 0.316
ξ = 1.0
ξ = 1.5
ξ = 2.0
ξ = 3.0
ξ = 4.0
ξ = 6.0
ξ = 8.0
ξ = 10.0
{π} × 11
{π} × 11
{π} × 11
{π} × 11
{π} × 11
{π} × 11
{π} × 11
{π} × 11
{π} × 11
{π} × 11
{π} × 11
{π} × 11
{5.278, 3.113, 3.118, 3.099, 3.103, 3.100,
3.117, 1.047, 3.113, 3.115, 3.108}
{1.051, 3.137, 3.127, 3.159, 3.043, 3.221,
3.144, 6.272, 3.146, 3.147, 3.142}
{1.047, 3.142, 3.159, 2.990, 3.142, 3.142,
3.142, 6.021, 3.142, 3.142, 3.142}
{1.852, 3.142, 3.142, 3.142, 3.142, 3.142,
3.142, 5.236, 4.745, 3.142, 3.142}
{1.032, 3.142, 3.094, 3.141, 3.130, 3.215,
3.335, 6.283, 3.122, 3.120, 3.124}
{1.046, 3.388, 2.844, 2.994, 3.146, 3.036,
3.003, 6.282, 2.980, 3.142, 3.209}
{1.651, 3.142, 1.964, 3.142, 3.227, 3.219,
3.124, 6.160, 3.142, 3.142, 3.142}
{1.679, 3.142, 1.711, 3.142, 3.142, 2.978,
2.685, 5.775, 1.384, 6.283, 6.283}
{1.832, 3.142, 1.832, 3.142, 3.166, 3.166,
3.171, 6.018, 4.696, 4.718, 3.142}
{1.702, 3.976, 1.369, 3.017, 2.552, 2.447,
2.539, 6.254, 0.352, 5.622, 3.498}
{1.703, 2.287, 2.094, 3.237, 3.136, 3.211,
3.178, 6.283, 2.942, 5.658, 3.717}
{1.499, 3.778, 1.360, 2.496, 2.355, 2.939,
2.273, 6.078, 4.990, 5.584, 3.703}
LiH
ID = 1.6 Å
{0.1} × 9
{0.483, 1.713, −1.475, 4.600, 2.326,
1.048, −0.126, −0.126, −0.126}
85

Appendix D
Hybrid VQE Demonstrations – Error
Analysis
In this appendix, we elaborate on the method used to compute observable errors with
statistical correlations and after self-mitigation is applied (App. B). For a given observable
ˆO ∈ˆH measured with N shots, the variance is given by:
Var( ˆO) = 1
N
X
i
N (i)(O(i) −⟨ˆO⟩)2,
(D.1)
where O(i) is the ith unbiased estimator (i.e. a computational basis measurement outcome)
of ˆO with frequency N (i), P
i N (i) = N, and ⟨ˆO⟩= P
i N (i)O(i)/N is the average over all
estimators. The uncorrelated error is then calculated as the standard deviation
q
Var( ˆO).
To lower resource requirements, we exploit the property that any set of commuting
observables in ˆH can be measured simultaneously (i.e. with a single circuit). Specifically, if
ˆO is an n-qubit Pauli string ˆP1 ˆP2... ˆPn ∈{ˆI, ˆX, ˆY , ˆZ}⊗n, then any n-qubit Pauli ˆQ1 ˆQ2... ˆQn
where ˆQi ∈{ ˆPi, I} will commute with ˆO. These observables are grouped into a set G from
which we designate a single circuit capable of measuring each of them during readout. We
note that this is guaranteed since each ˆO ∈G must act either ˆI or the same ˆX, ˆY or ˆZ
on a given qubit. Thus, one may set each qubit basis to the corresponding non-identity
Pauli (if present in at least one ˆO, else it remains unmeasured) and this constitutes a valid
N-qubit measurement basis for the circuit.
The grouping requires us to account for correlations that exist between observables in
G. In the context of error analysis, these manifest as covariances since each observable
86

is influenced by the statistics of the same counts distribution.
Partitioning ˆH into K
commuting groups Gk, we obtain:
ˆH =
|G1|
X
j1=1
cj1 ˆOj1 +
|G2|
X
j2=1
cj2 ˆOj2 + ... +
|GK|
X
jK=1
cjK ˆOjK,
(D.2)
with coefficients c1, ..., c|Gk| and measurement basis ˆOk corresponding to the group Gk. Note
that a particular ˆOjk may belong to multiple G; its expectation value is then computed
from the combined counts of multiple circuits, which contributes to increased estimation
accuracy at no added cost. Let ˆO′ denote such an observable (with coefficient c) belonging
to k ≤K groups. Then its contribution to each Gk is cRk ˆO′, where Rk = Nk/(PK
k=1 Nk).
To compute the covariance, we consider all bitwise products between ˆOa and ˆOb (cross-
terms) within each G. We then have the set G×, which we define as the set G augmented
with the cross-terms, i.e.:
G× = G ∪{ ˆOa ˆOb ∀a, b ≤|G| : a ̸= b}.
(D.3)
Therefore, the variance of ˆH with correlations included (denoted with a tilde) is:
g
Var( ˆH) =
K
X
k=1
g
Var( ˆOk)
Nk
,
(D.4)
where,
g
Var( ˆOk) = c2
k Var( ˆOk) +
|G×
k |
X
ℓ=1
ˆOk̸= ˆOℓ

c2
ℓR2
ℓVar( ˆOℓ) + 2ckcℓRk
 ⟨ˆOk ˆOℓ⟩−⟨ˆOk⟩⟨ˆOℓ⟩

|
{z
}
Cov( ˆOk, ˆOℓ)

,
(D.5)
and Cov( ˆOk, ˆOℓ) denotes the co-variance between ˆOk and ˆOℓ.
Now, we may proceed to calculate the errors after self-mitigation. Since ⟨ˆO⟩phys, true
is a function of ⟨ˆO⟩phys, meas and ⟨ˆO⟩mitig, meas, we must propagate their respective errors.
87

Applying the variance formula to Eq. (B.9), with ⟨ˆOk,mitig, true⟩fixed at 1, we obtain:
g
Var( ˆOk,phys, true)
(D.6)
=
 ∂⟨ˆOk⟩phys, true
∂⟨ˆOk⟩phys, meas
2
g
Var( ˆOk,phys, meas) +
 ∂⟨ˆOk⟩phys, true
∂⟨ˆOk⟩mitig, meas
2
g
Var( ˆOk,mitig, meas)
(D.7)
=

1
⟨ˆOk⟩mitig, meas
2κ
g
Var( ˆOk,phys, meas) + κ2

⟨ˆOk⟩phys, meas
(⟨ˆOk⟩mitig, meas)κ+1
2
g
Var( ˆOk,mitig, meas),
(D.8)
with
q
g
Var( ˆOk, phys, true) being the errors reported in the simulation data tables (App. C).
Here, we remark that the propagation formula linearly approximates ⟨ˆO⟩phys, true, and there-
fore assumes the errors from the physical and mitigation runs to be uncorrelated and rel-
atively small. This is a fair assumption since their respective observables are calculated
from separate circuits and retain the same counts distribution after correcting the expec-
tation values. However, if self-mitigation is instead used to correct each frequency in the
counts distribution, then a reshaping can occur and potentially amplify the errors. These
situations would require alternate techniques (e.g. Monte Carlo [131]) that analyze how
the observables’ error distributions transform under propagation, owing to their nonlinear
relations with the function.
88

Appendix E
Perturbative Analysis of the M × N
Planar Code
In this appendix, we analyze the M × N planar code on a more physical level by studying
how the local perturbations act on its qubits. To achieve this, we employ time-independent
perturbation theory to approximate the GS and associated energy as a function of the
perturbation strength ξ. Since the free part of the Hamiltonian [Eq. (2.3)] is ˆH0 = ˆH□+
ˆH+, its corresponding GS energy is given by the contributions from all its corresponding
plaquette and star operators:
E(0)
0
= −
MN
|{z}
# plaquettes
−(M −1)(N −1)
|
{z
}
# 4-body star
−2(M + N −2)
|
{z
}
# 3-body star
−
4
|{z}
# 2-body star
=
nq+1
X
i=1
(−1),
(E.1)
where each operator contributes a minimum eigenvalue of –1 and the superscript (0) in-
dicates the unperturbed (uncorrected) case. On the other hand, the associated GS arises
from the contribution of all self- and multi-plaquette interactions:
|Ψ(0)
0 ⟩=
1
√
2MN

1 +
MN
X
p1=1
Y
p1
□p1 +
MN
X
p1,p2=1
p1<p2
Y
p1,p2
□p1□p2 + ... + □p1□p2...□pMN

|0⟩⊗nq. (E.2)
Here, nq is the number of qubits and each □p is a 4-body plaquette operator ˆXA ˆXB ˆXC ˆXD,
where A, B, C, D labels the four qubits forming the edges of plaquette p. Since the M × N
lattice possesses a graph state representation, we may cast Eq. (E.2) in a simpler form
involving its stabilizers. Denoting Q as the set of all qubits (i.e. {1, 2,...,nq}), Egrph as
89

the set of all CZ edges (acting on qubits a and b), and LC ⊂Q as the subset of qubits
requiring local Clifford (H) operations, we have:
|Ψ(0)
0 ⟩=
 O
q
Hq
 Y
Egrph
CZa,b

|+⟩⊗nq;
q ∈LC
(E.3)
From this GS expression, one may systematically generate all excited states by applying
combinations of ˆX and ˆZ operators, which serve to flip the constituent eigenvalues of the
GS from –1 to +1. These states form a complete, mutually orthonormal basis, and are
given as:
|Ψ(0)
n ⟩=

nq
O
j=1
( ˆX
⃗xj
j )k( ˆZ
⃗xj
j )1−k

|Ψ(0)
0 ⟩(n = 1, 2...),
(E.4)
where ⃗x ∈{0, 1}nq : ⃗x ̸= 0nq, and k =
(
0,
j /∈LC
1,
j ∈LC . Based on Eq. (E.4), we can derive
the action of the free Hamiltonian on an excited state, and obtain an exact form for the
excited state energies (each energy corresponding to a specific ⃗x):
ˆH0|Ψ(0)
n ⟩=
nq+1
X
i=1
ˆH0,i

nq
O
j=1
( ˆX
⃗xj
j )k( ˆZ
⃗xj
j )1−k

|Ψ(0)
0 ⟩
(E.5)
=
nq+1
X
i=1
nq
O
j=1
ˆAi
j|Ψ(0)
0 ⟩;
ˆAi
j ∈{ˆIj, ˆXj, ˆZj, ˆZj ˆXj, ˆXj ˆZj}
(E.6)
=⇒E(0)
n
=
nq+1
X
i=1
nq
Y
j=1
ai
j, where :
(E.7)
aj
i =
(
−1,
ˆAi
j ∈{( ˆXj ˆZj; j /∈LC), ( ˆZj ˆXj; j ∈LC)}
+1,
ˆAi
j ∈{ˆIj, ( ˆZj; j /∈LC), ( ˆXj; j ∈LC)}
,
(E.8)
and ˆH0,i is the ith term in ˆH0. We can now proceed with the perturbative analysis, where
we determine the first and second order corrections in the GS energy and GS respectively.
90

The first-order energy correction vanishes since:
E(1)
0
= ⟨Ψ(0)
0 | ˆH△|Ψ(0)
0 ⟩,
= ξ⟨+|⊗nq

nq
O
j=1
ˆZj

|+⟩⊗nq = ξ⟨+|−⟩⊗nq = 0,
(E.9)
and is indicative of a non-polarized (singlet) state in which all the up and down spins are
paired. For the second-order correction, we have:
E(2)
0
=
X
n
|⟨Ψ(0)
n | ˆH△|Ψ(0)
0 ⟩|2
E(0)
0
−E(0)
n
= ξ2 X
⃗x
| P
j′⟨+|⊗nq(Q
Egrph CZa,b) ˆXk
j′(Q
Egrph CZa,b)( ˆZ1−k
j′
N
j ˆZ
⃗xj
j )|+⟩⊗nq|2
P
i(−1 + Q
j ai
j)
= ξ2 X
⃗x
| P
j′⟨+|⊗nq(N
j′′∈Vj′′→j′ ˆZk
j′′)( ˆXk
j′ ˆZ
⃗xj′+1−k
j′
)(N
j̸=j′ ˆZ
⃗xj
j )|+⟩⊗nq|2
P
i(−1 + Q
j ai
j)
= ξ2 X
⃗x
| P
j′⟨+|⊗nq ˆXk
j′( ˆZ
⃗xj′+1−k
j′
N
j̸=j′ ˆZ
⃗xj+ck
j
)|+⟩⊗nq|2
P
i(−1 + Q
j ai
j)
,
(E.10)
where V ⊂Q is the set of all qubits j′′ connected via CZ-edges to the qubit j′, and
c =
(
0,
j /∈V
1,
j ∈V . The non-zero contributions in E(2)
0
occur when each qubit is acted on
by an even number of perturbative ˆZ operators, which prevents orthogonality between
ˆH△|Ψ(0)
0 ⟩and |Ψ(0)
n ⟩. Since the perturbation is odd under parity transformation, its action
above imposes interactions between antisymmetric states which is a characteristic of spin-
1/2 systems. From Eq. (E.10), we may now determine the first order correction to the
GS:
|Ψ(1)
0 ⟩=
X
n
⟨Ψ(0)
n | ˆH△|Ψ(0)
0 ⟩
E(0)
0
−E(0)
n
|Ψ(0)
n ⟩
(E.11)
=

ξ
X
⃗x
P
j′⟨+|⊗nq ˆXk
j′( ˆZ
⃗xj′+1−k
j′
N
j̸=j′ ˆZ
⃗xj+ck
j
)|+⟩⊗nq
P
i(−1 + Q
j ai
j)
 O
j
( ˆX
⃗xj
j )k( ˆZ
⃗xj
j )1−k

|Ψ(0)
0 ⟩.
(E.12)
91

Applying Eqs. (E.10) and (E.12) to the 1 × 1 PC (single plaquette), the corrected GS
energy and GS to their respective orders are:
E0(ξ) ≈−5 −8ξ2
(E.13)
|Ψ0(ξ)⟩≈
 1
√
2 −ξ
√
2

|0⟩⊗4 +
 1
√
2 + ξ
√
2

|1⟩⊗4.
(E.14)
For the 1 × 2 (2 × 1) PC, containing two horizontal (vertical) plaquettes:
E0(ξ) ≈−8 −37
4 ξ2
(E.15)
|Ψ0(ξ)⟩≈
1
2 −13
8 ξ

|0⟩⊗7 +
1
2 + 1
8ξ

(|1011010⟩+ |0101101⟩) +
1
2 + 11
8 ξ

|1110111⟩.
(E.16)
From these equations, we observe that increasing the perturbation ξ shifts the GS energy
downwards, while the GS shifts towards states which have qubits that are all or predomi-
nantly in the polarized |1⟩state. This is expected since the dominance of the terms in ˆH△
(each containing a single ˆZ operator) acting on |1⟩contributes eigenvalues ∝−ξ for large ξ.
With these expressions valid for small-to-intermediate ξ, the ˆZ-operator terms guarantee a
crossover to |1⟩⊗nq as ξ →∞. It is also worth mentioning the equal positive and negative
contributions by the perturbation on |Ψ0⟩, which is due to its uniform nature. This pre-
serves the underlying symmetry of the problem, and thus enables redundant parameters
to be eliminated in the VQE implementation. We remark that if different perturbation
strengths were applied to each qubit, then a symmetry breaking is expected and all free
parameters must be optimized separately.
92

Appendix F
The fast_wolf Algorithm
In this appendix, we introduce the fast_wolf algorithm which performs efficient MB-QC
with large numbers of adaptive qubits. Unlike non-adaptive qubits (which may be classi-
cally processed), adaptive qubits form the essential part of a resource state. In the standard
MB-QC approach, all of them must be initialized and entangled before any measurements
can occur, which leads to a clear exponential scaling and performance bottleneck. However,
this is not a strict requirement as practical graph designs often do not possess all-to-all-
connectivity. In these scenarios, information propagation is confined along smaller, local
portions of the graph. The fast_wolf method takes advantage of this by processing the
graph in a piecewise fashion. It processes these local parts one at a time and measures
only qubit(s) in its immediate vicinity.
The method is also capable of handling arbitrary non-Clifford inputs to the MB pattern,
which cannot be processed efficiently via the stabilizer formalism. These correspond to
states which are not eigenstates of the Pauli operators ˆI, ˆX, ˆY , ˆZ, such as T|+⟩. To achieve
this, we initially omit the arbitrary input qubits when classically simulating the non-
adaptive portion (App. A). After obtaining the LC-reduced graph, we attach “connector”
qubits (initialized in |+⟩or |−⟩) to prescribed body qubits and then entangle it with an
arbitrary input. The role of these connectors is to allow teleportation of the input state
into the graph upon their measurement.
The fast_wolf simulation begins from the input qubits and entangles them with their
nearest body-qubit neighbours. For non-Clifford inputs, the connectors are also entangled
to the inputs, with both sets of qubits subsequently measured in the X-basis. From there,
the body qubits are entangled with their respective neighbours and measured in the pre-
scribed basis. This process continues until only the output qubits remain, at which point
the byproduct operators ˆUΣ are applied to |ψout⟩based on the outcomes from the adap-
93

tive basis measurements and earlier classical simulation. Throughout, we act local Clifford
(H, S) operations on a particular qubit (as determined from the classical simulation) im-
mediately after it is entangled with its neighbours.
We make two further remarks. First, since only a single adaptive qubit is measured
at a time, any angle flip in the basis depends solely on the outcome of the measurement,
although an overall temporal ordering must still be followed to realize a deterministic
pattern. Second, it is often convenient to determine all the steps involved in the fast_wolf
procedure beforehand, storing them as a prescription list which can be reused if the same
graph is executed multiple times (i.e. during a VQE run).
We present the pseudocode for the fast_wolf algorithm on the next page. It is divided
into two main functions — simulate_cliff performs the efficient classical simulation, and
simulate_fast_wolf is the piecewise execution of the graph itself:
94

Algorithm 1 fast_wolf
Inputs:
P: A valid measurement pattern with input (I), output (O), nonadaptive (B(NA)), and adaptive body
(B(A)) qubits
|ψin⟩: an arbitrary state over I
Outputs:
|ψout⟩: the final state over O
1: function simulate_fast_wolf(P, |ψin⟩)
2:
G, LC ←simulate_cliff(P, |ψin⟩)
3:
|ΨG⟩←1
4:
|ΨG⟩←|ΨG⟩⊗|Ψi⟩∀i ∈I
▷Construct |ΨG⟩from I ∪IC ∪N(IC) ∈G
5:
if IC ̸= ∅then
6:
|ΨG⟩←CZi,j|ΨG⟩∀(i, j) ∈(IC, N ˜
(I)) : i ̸= j
7:
|ΨG⟩←LCk|ΨG⟩∀k ∈IC
8:
|ΨG⟩←CZm,n|ΨG⟩∀(m, n) ∈(I, IC) : m ̸= n
9:
Measure n ∀n ∈I ∪IC (in X-basis)
10:
end if
11:
Q ←{1, 2, ..., (|IC| + |B(A)| + |O|)}
12:
while |Q| > |O| do
▷Additional body qubits remain
13:
for q ∈Q do
14:
|ΨG⟩←|ΨG⟩⊗|Ψr⟩
15:
|ΨG⟩←CZq,r|ΨG⟩∀r ∈N(q)
16:
if q ∈B(A) ∪O then
▷Measuring q must be valid w.r.t temporal ordering
17:
|ΨG⟩←LCq|ΨG⟩
18:
Measure q in prescribed basis
19:
Q ←Q −q
▷Remove measured qubit q
20:
end if
21:
end for
22:
end while
▷Exit loop when only output qubits remain
23:
|ψout⟩←|ΨG⟩
24:
|ψout⟩←U (i)
Σ |ψout⟩∀i ∈O
▷Apply byproduct operators U (i)
Σ
to qubit i
25:
return |ψout⟩
26: end function
27:
28: function simulate_cliff(P, |ψin⟩)
29:
Construct tableau T from I ∪B(NA) ∈P
30:
Measure I ∪B(NA) in T
31:
Determine resulting graph G over B(A) ∪O
32:
if ˆP|ψin⟩̸= ±|ψin⟩∀ˆP ∈{ˆI, ˆX, ˆY , ˆZ}⊗|I| then:
33:
Add connectors ICq ∀q ∈I to G
▷Input is not a Pauli eigenstate (i.e. non-Clifford)
34:
end if
35:
Determine LCq ∈{H, S, CZ}; ∀q ∈IC ∪B(A) ∪O
36:
return G, LC
37: end function
95

IC
IC
IC
IC
𝜃!
𝜃"
4
5
6
7
3
10
14
12
9
1
13
11
2
0
8
𝜃#
FIG. F.1: LC-reduced graph for the RY (θ)–CZ modified 1 × 1 PC, with attached con-
nector qubits (labelled by IC) to permit non-Clifford input states. Connector, body,
and output qubits are shown in green, orange, and light green respectively. Dotted circles around
qubits indicate LC operations applied to them. Black circles indicate the arbitrary inputs, which
undergo teleportation via the connectors into the main portion of the graph.
Example. To illustrate the fast_wolf algorithm, we apply it to the RY (θ)–CZ modi-
fied 1×1 PC [Fig. 2.3(a)] with an arbitrary non-Clifford input |ψin⟩(defined over qubits 0 –
3). The corresponding LC-reduced graph is depicted in Fig. F.1. Performing the algorithm
on the graph yields the following prescription steps:
1.
(init_input, {0, 1, 2, 3}), (init_connector, {8, 9, 10, 11}),
2.
(init_body, 13), (cz, 13, 11), (s, 11), (cz, 2, 11), (measure, 11),
3.
(init_body, 14), (cz, 14, 10), (s, 10), (cz, 3, 10), (measure, 10),
4.
(init_body, 12), (cz, 12, 9), (s, 9), (cz, 1, 9), (measure, 9),
5.
(init_out, 4), (cz, 4, 8), (cz, 0, 8), (measure, {8, 3, 2, 1, 0})
6.
(init_out, 5), (cz, 5, 12), (s, 12), (measure, 12),
7.
(init_out, 7), (cz, 7, 14), (s, 14), (measure, 14),
8.
(cz, 7, 4), (init_out, 6), (cz, 6, 13), (s, 13), (measure, 13),
9.
(cz, 7, 5), (cz, 7, 6), (s, 6), (s, 7), (s, 5), (s, 4), (permute, 3, 2,
0, 1),
where the input connectors (8–11), body qubits (12–14), and outputs (4–7) are initial-
ized to either |+⟩or |−⟩depending on the outcomes from the efficient classical simulation,
96

and the qubits are labelled as in Fig. F.1. An extra permutation is prescribed at the end to
ensure the ordering of qubits in |ψout⟩is consistent with that of |ψin⟩. With the exception
of the first initialization and final LC/permutation step, we consider a step to conclude
whenever a measurement (or sequence of measurements) is performed. We obtain the state
at the end of each step, and employ it as the input of the next.
Fig. F.2 shows a schematic of how the above steps are performed, in both their graph and
circuit representations. Here, we have assumed all adaptive and non-adaptive outcomes
are ‘0’ so that no byproduct or adaptive corrections are required. From the figure, the
advantages of the method are abundantly clear. We observe that at most 9 qubits are
present at any time (vs. 15 in the standard approach), and no more than 3 qubits are
entangled at once.
One may also verify that for any choice of |ψin⟩and angles θ1, θ2,
θ3, ˆUΣ|ψout⟩is indeed equivalent to the action of the modified GB circuit [described by
Eq. (H.1)] on |ψin⟩.
Although the fast_wolf method is a practical way to simulate arbitrary inputs and
complex patterns, it is important to note the challenges of the technique in experimental
settings. For instance, the resource state must be entangled multiple times with qubits
in arbitrary states. Given the challenges with generating and maintaining entanglement
interactions in the lab, this can lead to greater imperfections in resource state preparation
while affecting the computational fidelity. Moreover, it also remains to be seen whether the
fast_wolf method provides a significant enough exponential size reduction. This can be
done through a detailed bounds or complexity analysis. If the number of qubits remains
large for a given pattern, one can resort to a concatenation of smaller patterns, with
simulate_fast_wolf applied separately to each. However, this requires prior knowledge
of the unitary decomposition, which may be unknown if one designs patterns in an arbitrary
fashion (i.e. not from concatenating basic operations; see App. A).
97

IC
IC
IC
IC
IC
IC
|−⟩
IC
IC
IC
|−⟩
3
10
9
1
11
2
0
8
|+⟩
|−⟩
|−⟩
|𝝍𝒊𝒏⟩
|𝜓#⟩
3
10
9
1
11
2
0
8
|+⟩
|−⟩
|−⟩
0
1
2
3
8
9
10
11
13
|−⟩
|𝜓#⟩
|𝜓$⟩
13
11
10
9
8
3
2
1
0
3
10
9
1
2
0
8
|+⟩
|−⟩
|−⟩
13
14
|−⟩
14
13
10
c
c
9
8
3
2
1
0
|𝜓$⟩
|𝜓%⟩
3
9
1
2
0
8
|+⟩
|−⟩
13
14
|−⟩
12
|𝜓%⟩
14
12
13
9
8
3
2
1
0
|𝜓&⟩
c
3
1
2
0
8
|+⟩
13
14
12
|+⟩
4
|𝜓'⟩
|𝜓&⟩
12
14
13
8
3
2
1
0
4
c
13
14
12
4
5
|−⟩
13
14
4
5
7
|−⟩
𝜃!
𝜃"
13
4
5
7
6
|−⟩
𝜃#
4
5
7
6
12
14
13
4
5
c
|𝜓'⟩
|𝜓(⟩
14
13
4
5
c
7
|𝜓(⟩
13
4
5
7
6
c
|𝜓)⟩
4
5
7
6
𝑈*
|𝜓+⟩
|𝝍𝒐𝒖𝒕⟩
|𝜓)⟩
|𝜓+⟩
FIG. F.2: Schematic diagram of the fast_wolf algorithm applied to the RY (θ)–CZ modified 1×1 PC, with
arbitrary non-Clifford inputs. Arrows indicate the process flow, straight blue edges are CZ-operations applied,
lightning symbols indicate measurements performed on the graph qubits, and wavy lines indicate the correlations that
exist after measurement (which can vary in strength). Qubits initialized at a given step are highlighted with red labels
and initial states, while color shade changes signify changes to their state after measurement.
98

Appendix G
Verifying Equivalence of the GB and
MB Paradigms
In this appendix, we demonstrate that our ansatz-modification technique applied to the
perturbed PC acts identically in the GB and MB paradigms. In other words, we verify
that their corresponding unitary transformations are equivalent, that is: ˆUGB ≡ˆUMB. For
the purpose of analysis, we represent these paradigms as circuits and graphs respectively.
If ˆUMB is known beforehand, then verifying equivalence is trivial. However, it is often
the case that the unitary is unknown; this can occur if the graph was designed determinis-
tically, but in an arbitrary fashion (i.e. without resorting to concatenation of well-known
patterns). In these situations, it is in fact possible to recover the operation by analyzing
the relation between the pattern and its action on a unitary map. We use this technique,
known as phase map decomposition (PMD) [9], as a general means of performing the veri-
fication. As a further check, we also present an alternative approach based on elements of
our MB framework discussed in earlier appendixes.
For simplicity, we consider the M = N = 1 case (Figs. 2.3 and 2.4). Excluding the
rotation layers, the modified circuit [Fig. 2.3(a)] realizes the overall unitary:
ˆUGB(θ1, θ2, θ3) = H2H3H4 ˆU am,GB
1,4
(θ3) ˆU am,GB
1,3
(θ2) ˆU am,GB
1,2
(θ1)H1H2H3H4,
(G.1)
99

1
2
3
4
≡
2𝜋−𝜃
FIG. G.1: MB pattern for RY (θ)–CZ, obtained by concatenating smaller patterns
corresponding to each operation in Eq. (G.3). It is applied as a modification to each graph
edge of the 1 × 1 perturbed PC. To reduce the number of initial qubits, the pattern is simplified
via the techniques of Ref. [10].
Here, the pattern is regarded as a black-box unitary that is
“inserted” into a graph edge to modify its degree of entanglement. Black and light green circles
denote input and output qubits respectively, blue lines denote CZ-edges, green and red circles
denote nonadaptive qubits measured in the X- and Y -basis respectively, and orange circles denote
adaptive qubits measured in the R(θ)-basis. The numbers label the qubits and their measurement
order (excluding outputs).
where,
ˆU am,GB
m,n
(θ) = CZm,nRY (θ)n = CZm,n(S†HRZ(−θ)HS)n
(G.2)
=




cos(θ/2)
−sin(θ/2)
0
0
sin(θ/2)
cos(θ/2)
0
0
0
0
cos(θ/2)
−sin(θ/2)
0
0
−sin(θ/2)
−cos(θ/2)



. (G.3)
To perform the analysis on graphs, we express the RY (θ)–CZ modification as an MB
pattern (shown in Fig. G.1) that is “inserted” into the edges of the 1×1 graph [Fig. 2.3(a)]1
1Further processing of each modification yields the LC-reduced graph shown in Fig. 2.4(a).
100

The unitary of the modified graph may then be expressed in an similar form:
ˆUMB(θ1, θ2, θ3) = H2H3H4 ˆU am,MB
1,4
(θ3) ˆU am,MB
1,3
(θ2) ˆU am,MB
1,2
(θ1)H1H2H3H4,
(G.4)
where each edge modification between qubits m and n acts an identical unitary ˆU am,MB
m,n
(θ).
As described above, the problem then boils down to determining this unitary. Here, we
treat the initialization and LC operations externally of the pattern (as these can be simu-
lated classically). We may also simplify the pattern obtained from direct concatenation via
the ZX-calculus (Ref. [10]), which reduces the number of qubits from 28 to 12. As shown
in Fig. G.1, it corresponds to:
V =

M10(R(2π −θ))
9
Y
i=8
Mi(Y )
7
Y
i=1
Mi(X)

ˆUΣ,
(G.5)
|ψout⟩11,12 = V
Y
{j,k}∈E
CZj,k(|ψin⟩1,2 ⊗|+⟩⊗10
3,4,...,12),
(G.6)
with E = {(1, 4), (9, 10), (5, 6), (5, 9), (7, 9), (8, 10), (3, 8), (4, 5), (7, 12), (6, 11), (2, 3)}.
Method 1: Phase map decomposition. The PMD method regards the MB pattern as acting
three distinct maps, each expressed as a matrix:
1. A dilation map PI→A that expands the Hilbert space of the inputs (corresponding to
the addition of ancillary qubits in |+⟩.
2. A diagonal phase map ΦA→A that captures the entanglement (CZ-edges) prescribed
by the pattern and correspondingly, any −1 and rotation phases incurred.
3. A contraction map RA→O that reduces the Hilbert space to that defined over the
output qubits (corresponding to the ancillary measurements).
The overall unitary transformation ˆU is then described as the composition of these maps:
ˆU = R ◦Φ ◦P.
(G.7)
The method also assumes the positive branch has been taken by the pattern, which is
defined as the unique set of measurement outcomes that do not require any corrections
(i.e. each UΣ = ˆI). In this case, it is the “all 0” outcome. Letting n label the computational
basis states in the rows and columns, where n′ ≡bin(n), we compute the three maps via
the procedures outlined in Ref. [9]. We find that:
PI→A[., n] = |n′⟩1,2 ⊗| + ...+⟩3,...,12;
n = 0, 1..., 22 −1,
(G.8)
101

ΦA→A = Ph(2π −θ)10Ph(π/2)9Ph(– π/2)8
Y
{j,k}∈E
CZj,k = diag(d1,1, d2,2, ..., d212,212),
(G.9)
RA→O[., m] = ⟨+... + |m′⟩1,2,...,10 ⊗|m′⟩11,12;
m = 0, 1, ..., 212 −1,
(G.10)
where Ph(θ) is the phase operator defined as the matrix
1
0
0
eiθ

, with
dn,n = e−i[(2π−θ)n′
10+(π/2)(n′
9−n′
8)](−1)
P
jk∈E n′
jn′
k.
(G.11)
Multiplying the matrices of Eqs. (G.8), (G.9), and (G.10) together, we finally obtain:
∴ˆU[nR, nP] = RA→O[nR, .] ◦ΦA→A ◦PI→A[., nP]
(G.12)
=⇒ˆU am,MB(θ) =





ˆU[0, 0]
ˆU[0, 1]
ˆU[0, 2]
ˆU[0, 3]
ˆU[1, 0]
ˆU[1, 1]
ˆU[1, 2]
ˆU[1, 3]
ˆU[2, 0]
ˆU[2, 1]
ˆU[2, 2]
ˆU[2, 3]
ˆU[3, 0]
ˆU[3, 1]
ˆU[3, 2]
ˆU[3, 3]





(G.13)
= 2−5e−iθ/2




cos(θ/2)
−sin(θ/2)
0
0
sin(θ/2)
cos(θ/2)
0
0
0
0
cos(θ/2)
−sin(θ/2)
0
0
−sin(θ/2)
−cos(θ/2)



. (G.14)
Method 2: Measurement-based framework.
As a further check, we may also determine
ˆU am,MB via the MB-QC framework discussed in App. A. Since the framework works on
the statevector level and not directly with operators, we must construct the unitary from
its constituent columns and determine the relative phases that exist between them. We
perform this method as a four-step procedure on Eq. (G.5):
1. First, we process the pattern up to the measurement of the adaptive qubit(s) (qubit
10), with the non-adaptive portion (1-9) simulated classically. The resulting state is:
102

|ψ⟩10,11,12 =

9
Y
i=1
Mi(Z)

(H10RZ(2π −θ)10)(H9S†
9)(H8S8)
7
O
i=1
Hi

· · ·
Y
{j,k}∈E
CZj,k

|ψin⟩1,2 ⊗|+⟩⊗10
3,4,...,12

,
(G.15)
where the X, Y , and R(θ) measurements are re-expressed as computational (Z) basis
measurements up to transformation operations.
2. Next, we learn the relative phase factor incurred on |ψ⟩10,11,12 when |ψin⟩1,2 is set
to each two-qubit computational basis state (i.e. |00⟩, |01⟩, |10⟩, |11⟩). Each corre-
sponding |ψ⟩forms one of the four orthonormal columns of the unitary matrix. For
a basis state |b⟩defined over all pattern qubits, the action of each operation above
(H, CZ, S, RZ) on their constituent |0⟩or |1⟩states incurs a specific phase on them.
Denoting t and c as control and target qubits respectively, these operations transform
the states as:
(+1)|bt⟩
Ht
7−→(+1)|0t⟩+ (−1)bt|1t⟩
(+1)|bt⟩
St
7−→(+i)bt|bt⟩
(+1)|bt⟩
S†
t
7−→(−i)bt|bt⟩
(+1)|bt⟩
CZc,t
7−−−→
(
(+1)bt|bt⟩, bc = |0⟩
(−1)bt|bt⟩, bc = |1⟩
(+1)
bt⟩
RZ(θ)t
7−−−−→e(−1)1−bt(iθ/2)|bt⟩,
(G.16)
where bt ∈{0, 1}. Over all |ψ⟩, we determine the first nonzero entries with identical
amplitudes (from the top of the vectors)2 and record the phase differences between
them. In the case of Eq. (G.15), we find that for θ > 03:
2In other words, with the smallest binary ket labels. We select these entries for comparing phases since
additional phase differences can exist further down the statevector, even if the topmost elements have the
same phases. These entries generally correspond to ket labels with a greater number of ‘1’s, and therefore
have extra phases tacked on by the operations in Eq. (G.16).
103

|00⟩1,2 7→–2−3/2 (eθ/2 + e–θ/2)|000⟩10,11,12 =⇒phase = +1
|01⟩1,2 7→–(i)2−3/2 (eθ/2 + e–θ/2)|001⟩10,11,12 =⇒phase = +i
|10⟩1,2 7→–2−3/2 (eθ/2 + e–θ/2)|010⟩10,11,12 =⇒phase = +1
|11⟩1,2 7→–(i)2−3/2 (eθ/2 + e–θ/2)|011⟩10,11,12 =⇒phase = +i,
(G.17)
where the phases are taken relative to the |00⟩input, and we have imposed that all
measured qubits (1-9) yield an outcome of ‘0’ (positive branch).
3. For each computational basis input, we then process the remaining adaptive portion
in an MB fashion and obtain the corresponding output |ψout⟩. The outputs are:
|00⟩1,2 7→|ψout,MB⟩11,12 = {−cos(θ/2), −sin(θ/2), 0, 0}T
|01⟩1,2 7→|ψout,MB⟩11,12 = {−i sin(θ/2), i cos(θ/2), 0, 0}T
|10⟩1,2 7→|ψout,MB⟩11,12 = {0, 0, −cos(θ/2), sin(θ/2)}T
|11⟩1,2 7→|ψout,MB⟩11,12 = {0, 0, −i sin(θ/2), −i cos(θ/2)}T.
(G.18)
4. Finally, we multiply each |ψout⟩by the relative phase factor corresponding to its basis
input |ψin⟩. We then collect all |ψout⟩together as the columns of a matrix, ordering
them according to their input states (i.e. |00⟩, |01⟩, |10⟩, |11⟩, from left to right).
This matrix is effectively ˆU am,MB(θ). Performing this step on Eq. (G.18), we obtain:
ˆU am,MB(θ)
=




(+1)(−cos(θ/2))
(+i)(−i sin(θ/2))
0
0
(+1)(−sin(θ/2))
(+i)(i cos(θ/2))
0
0
0
0
(+1)(−cos(θ/2))
(+i)(−i sin(θ/2))
0
0
(+1)(sin(θ/2))
(+i)(−i cos(θ/2))




(G.19)
= (−1)




cos(θ/2)
−sin(θ/2)
0
0
sin(θ/2)
cos(θ/2)
0
0
0
0
cos(θ/2)
−sin(θ/2)
0
0
−sin(θ/2)
−cos(θ/2)



.
(G.20)
Since Eqs. (G.14) and (G.20) are identical to Eq. (G.3) (up to global phases), it follows that
ˆUMB(θ1, θ2, θ3) ≡ˆUGB(θ1, θ2, θ3). Thus, equivalency between the MB and GB paradigms
has been shown.
3For θ < 0, Eqs. (G.17) and (G.20) incur a global phase of +1 instead of –1.
104

Appendix H
Performing Coherent MBQC
In this appendix, we give further details regarding the treatment of the generalized cSWAPs
in the MB version of the coherent superposition protocol. Recall from Eq. (3.14) that
the operation swaps the target input |ψ0⟩with the auxiliary state |ϕ0⟩i when the d-level
control is in |i⟩; i = 1, 2, ..., d −1. For a control qubit (d = 2), the operation reduces to
the Fredkin which can be translated into a MB cluster using its decomposition of seven T
gates (Ref. [65]). For a control qudit, one may resort to a multi-qubit implementation as in
the GB version (i.e. with log2d qubits). However, the direct sum structure of the ensuing
implementation does not translate to known cluster states that encapsulate the whole
operation. This motivates the following alternative approach, where we regard the control
as an external GB degree of freedom but use it to swap entire MB patterns in a quantum
switch-like manner. For simplicity, we will omit the m extra input registers needed to
calculate the CJ fidelity, however the procedure described below remains unchanged.
Given an m-qubit input, the generalized cSWAP matrix consists of d block diagonals
(each of size 2md) of the form:










N
j
I|ψ(j)
0 ⟩
N
i,j
I|ϕ(j)
0 ⟩i
N
j
SWAP|ψ(j)
0 ⟩,|ϕ(j)
0 ⟩1
N
i,j
i̸=1
I|ϕ(j)
0 ⟩i
...
N
j
SWAP|ψ(j)
0 ⟩,|ϕ(j)
0 ⟩d
N
i,j
i̸=d
I|ϕ(j)
0 ⟩i










(H.1)
where i = (1, 2, .., d) and j = (1, 2, ..., m). We analyze the effect of noise on each block
105

separately (see below), by executing each of its SWAP and I operations as clusters [2].
For the former, we employ the decomposition SWAPc,t = CXc,tCXt,cCXc,t. Acting local
noise in the form of Eq. (3.35), we obtain the effective action of the quantum map for some
arbitrary ρ via the CJ-isomorphism. Specifically, we input the Bell state |Φ+⟩(|Φ+
2 ⟩), apply
noise to the cluster implementing I (SWAP), and obtain the output Choi matrix η. The
action of the quantum map is given by:
E(ρ) = TrA(I ⊗ρT
B)ηAB,
(H.2)
where A and B are the two systems denoted Alice and Bob, with Bob’s system undergoing
the noisy computation. We may then characterize the noise, first by perform a spectral
decomposition of ηAB and then determining the Kraus operators corresponding to the
channel. This is performed as such:
ηAB =
X
n
cn|ϕn⟩⟨ϕn| →|ϕn⟩= [ϕ(1)
n , .., ϕ(2|AB|)
n
]T
(H.3)
=⇒Kn = cn
N



ϕ(1)
n
...
ϕ(2|AB|/2)
n
...
...
...
ϕ(2|AB|/2(2|AB|/2−1))
n
...
ϕ(2|AB|)
n



(H.4)
=⇒E(ρ) =
X
n
KnρK†
n; n = 1, 2, ...2|AB|,
(H.5)
where we have undone the vectorization in Eq. (H.4), P
n |cn|2 = 1, and N is a normaliza-
tion factor. If there are n operations in a block, we model the overall noise by composing
each of their individual channels sequentially, i.e.: E1(ρ) ◦E2(ρ)... ◦En(ρ). For example, if
the Kraus operators corresponding to noisy unitaries UA and UB are A and B, then:
EA(ρ) ◦EB(ρ) =
X
m,n
(BnAm)ρ(BnAm)†.
(H.6)
Now, let C(i) be the overall Kraus operators in the ith block of Eq. (H.1). Then, the state
ρcSWAP after applying the generalized cSWAP to ρ (defined over the control in |+⟩c, and
all inputs and auxiliaries), is calculated as:
ρcSWAP =





P
n
C(1)
n ρ(1,1)C(1)†
n
P
n
C(1)
n ρ(1,2)C(2)†
n
...
P
n
C(1)
n ρ(1,d)C(d)†
n
...
...
...
P
n
C(d)
n ρ(d,1)C(1)†
n
P
n
C(d)
n ρ(d,2)C(2)†
n
...
P
n
C(d)
n ρ(d,d)C(d)†
n




,
(H.7)
106

where ρ(i,j) is the ith row and jth column partition of ρ (block matrix of size 2md), and
the off-diagonal elements describe interferences between the channels of each path. For
bookkeeping purposes, each set of Kraus operators is arranged by their eigenvalues cn from
least to greatest, allowing us to pair the nth operators between any two sets. Furthermore,
the hermicity of density matrices implies P
n C(a)
n ρ(a,b)C(b)†
n
= P
n C(b)
n ρ(b,a)C(a)†
n
, meaning
that only the lower triangular portion of Eq. (H.7) needs to be computed. Despite the
total number of Kraus operators in the approach exponentially scaling in md, we note
that the generalized cSWAPs are performed only twice regardless of the size of the main
computation U. This computational advantage is further bolstered by the fact that the
size of the cluster implementing the cSWAPs scales linearly as O(md + log2d).
Although direct manipulation of matrices is not possible in a physical experiment (in-
stead, expensive process tomography is often required to characterize noise), it facilitates
direct numerical analyses. We have also assumed that the noises between and within each
block in Eq. (H.1) are uncorrelated. This is reasonable if the control system is spatially
far away from the main system enacting the SWAPs (e.g. implemented on a different ap-
paratus) such that the ensuing channels are weakly correlated. Related setups involving
photonics and trapped ions have been explored in Ref. [132], where the control is treated
as a black-box with no prior knowledge of the unitaries, and each unitary is realized on a
separate physical apparatus.
As a clarifying note, if noise affects the generalized cSWAPs, then attention must be
given to ensuring that noise acts exactly once on every cluster qubit in the protocol. Based
on how the operations are concatenated in Fig. 3.4, we therefore act noise on:
• All qubits of the 1st generalized cSWAP cluster
• Body and output qubits of each cluster in U, except the last one
• Body qubits only for the last cluster in U
• All qubits of the 2nd generalized cSWAP cluster
For noiseless cSWAP runs, we simply act noise on every qubit for each operation in U.
Finally, it may be observed that the results presented in Fig. 3.5 are generally better than
their counterparts in Fig. 10 of Ref. [65]. This stems from simplified versions of the clusters
used for the cNOT and T operations, which contain fewer qubits compared to the patterns
prescribed in Ref. [2]. Likewise, for d = 2, the use of SWAPs involves significantly fewer
cluster qubits than the Fredkin. However, the main conclusions and underlying physics
remain unchanged.
107

