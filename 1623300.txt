Density of states
1
Density of states based free energy
calculation from molecular simulations
Sadanand Singh, Manan Chopra and Juan J. de Pablo
University of Wisconsin-Madison, Madison WI 53706 (USA)
Key Words
Uniform Sampling, Metadynamics, Flat Histogram, Flux Maxi-
mization
Abstract One of the central problems in statistical mechanics is that of ﬁnding the density of
states of a system. Knowledge of the density of states of a system is equivalent to that of its
fundamental equation, from which all thermodynamic quantities can be obtained. Over the last
several years molecular simulations have made considerable strides in their ability to generate
the density of states of complex ﬂuids and materials. In this review we discuss some of the
more promising approaches proposed in the recent literature, along with their advantages and
limitations.
CONTENTS
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3
Density of states (DOS) simulations
. . . . . . . . . . . . . . . . . . . . . . . . . .
4
Multidimensional DOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6
Expanded Ensemble DOS (EXEDOS) . . . . . . . . . . . . . . . . . . . . . . . . . . . .
8
DOS with Molecular Dynamics: Metadynamics . . . . . . . . . . . . . . . . . . . . . .
10

Annual Review of Chemical and Biological Engineering 2011 3
1056-8700/97/0610-00
Mathematical foundation of DOS based methods . . . . . . . . . . . . . . . . . . .
13
Acceptance criterion for Wang-Landau DOS simulations . . . . . . . . . . . . . . . . .
13
Acceptance criterion for EXEDOS simulations
. . . . . . . . . . . . . . . . . . . . . .
14
Convergence of DOS-based methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
15
Histogram reweighing in DOS-based methods . . . . . . . . . . . . . . . . . . . . . . . .
17
Advanced DOS-based Monte-Carlo (MC) methods . . . . . . . . . . . . . . . . . .
19
Conﬁgurational biased DOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
19
Conﬁgurational temperature DOS (CT DOS)
. . . . . . . . . . . . . . . . . . . . . . .
20
Use of multiple windows . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
23
Round-trip algorithms
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
24
Use of rejected states to enhance sampling . . . . . . . . . . . . . . . . . . . . . . . . .
27
Additional improvements of DOS simulations . . . . . . . . . . . . . . . . . . . . . . .
29
Advancements in metadynamics
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
30
Flat-histogram metadynamics (FHM) . . . . . . . . . . . . . . . . . . . . . . . . . . . .
31
Well-tempered metadynamics (WTM)
. . . . . . . . . . . . . . . . . . . . . . . . . . .
33
Flux-tempered metadynamics (FTM) . . . . . . . . . . . . . . . . . . . . . . . . . . . .
33
Multiple walkers in metadynamics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
41
Parallel tempered metadynamics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
42
Bias-exchange metadynamics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
44
Self-learning metadynamics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
46
Concluding remarks
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
47
2

Density of states
3
1
Introduction
Molecular simulations can be classiﬁed into two categories: Monte Carlo ap-
proaches (1), which seek to sample the conﬁguration space of a system, and
molecular dynamics (2), which follow a system’s evolution in time by integrating
Newton’s equation of motion. In either case, mechanical properties such as the
internal energy U or the pressure P can be easily determined as direct averages of
instantaneous properties, such as the interactions between particles or the forces
between them. Thermal properties, such as the free energy, are more diﬃcult
to calculate. They cannot be extracted directly from a simulation and require
that ensemble or time averages of indirect properties be determined (3). In the
so-called Widom particle insertion approach (4), for example, one attempts to
determine the average energy that a “ghost” particle would experience if it were
inserted at random into the system of interest, without disturbing the conﬁg-
uration of the existing, real particles. The average of the exponential of that
energy is proportional to the chemical potential (or molar Gibbs free energy) of
the system.
In recent years, however, molecular simulations have undergone a paradigm
shift in which the free energy itself is used to guide sampling of conﬁguration
space (5–45). Such methods not only oﬀer the promise of more eﬃcient sampling,
particularly in systems characterized by rough free energy landscapes but also
lead to direct estimates of the free energy. This review focuses on a discussion
of such methods, which we refer to collectively as “density-of-states” sampling
techniques.
A common problem encountered in molecular simulations is that of “rare
events”. The free energy surfaces of complex systems often exhibit deep min-

4
Singh et al.
ima, corresponding to stable phases or states, separated by large barriers. Such
barriers constitute sampling or dynamical bottlenecks that hinder the evolution
of the system from one minimum to the next. The presence of free energy barriers
and bottlenecks leads to separation of time scales in which the time t spend in
a stable phase is much greater than the time spent crossing the barriers. This
separation of time scales serves to deﬁne a “rare event” - an event so infrequent
that it deﬁes study by traditional simulations (46). In case of the density of states
(DOS) simulations, such a separation in time scales is countered by introduction
of biasing potential or force in the system, that lead to the balance of above
described two time scales.
We begin this review with a brief overview of various DOS-based methods.
We then provide the underlying mathematical background for several such algo-
rithms. Subsequent sections are devoted to a discussion of novel, more advanced
algorithms that combine elements from multiple advanced sampling techniques.
A concluding section is devoted to a discussion of the general applicability of
such techniques for simulations of complex systems in the areas of materials and
bio-molecular research.
2
Density of states (DOS) simulations
The central quantity of interest in DOS-based simulations is the microcanonical
partition function or density of states Ω(E, V, N). For a given system having
volume V and number of particles N, Ωis proportional to the number of distinct
states having energy E.
All thermodynamic properties of the system can be
calculated from knowledge of Ω(E, V, N). For example, the canonical ensemble

Density of states
5
average of a quantity X(E) can be determined from Ω(E) according to
< X >NV T =
P
E X(E)Ω(E)e−βE
P
E Ω(E)e−βE
,
(1)
where the sum extends over the entire range of energy accessible to the sys-
tem. Conventional canonical ensemble Monte-Carlo or molecular dynamics simu-
lations generate conﬁgurations that are distributed with probability proportional
to Ω(E, V, N) exp(−βE), where β = 1/kBT, but do not yield a direct estimate
of Ω. Density-of-states methods provide a means to measure Ωdirectly.
A little over a decade ago, Wang and Landau (24) introduced a remarkably
simple and eﬀective approach for direct calculation of the density of states from
a Monte Carlo simulation. While several methods had already been proposed to
estimate Ω, Wang and Landau’s contribution was seminal in that it allowed for
the automatic, on-the-ﬂy calculation of the density of states of a system with little
intervention from the user. Equally importantly, in their approach sampling was
guided by the density of states, thereby allowing the method to overcome large
free energy barriers in a systematic manner. The Wang-Landau (WL) method
is based on the observation that if a random walk is performed in energy space
with a probability proportional to the reciprocal of the density of states,
1
Ω(E),
then the corresponding histogram of energies should be perfectly ﬂat. In practice
a WL simulation is implemented by modifying an estimated density of states
in a manner that produces a “ﬂat” histogram of visits to distinct energy levels
over a speciﬁed energy range. One starts with a simple “guess” of the density
of states (e.g. Ω= 1 for all values of E). A random walk in energy space is
performed by generating trial conﬁgurations by simple random displacements; a

6
Singh et al.
trial conﬁguration is accepted according to:
p(E1 →E2) = min
Ω(E1)
Ω(E2), 1

,
(2)
where E1 and E2 denote the energies of the system before and after the trial move.
Every time that an energy level E is visited, the corresponding density of states
is updated by multiplying the current value by a modiﬁcation factor f that is
greater than unity, i.e. Ω(E) →Ω(E)×f. The initial value f0 of the modiﬁcation
factor can be set to f0 = e. Such a choice allows for relatively fast sampling of all
possible energy levels. A histogram of energy, H(E), is also updated every time
that an energy “state” is visited. The energy range of interest is sampled and
the density of states is modiﬁed until the accumulated histogram H(E) becomes
suﬃciently “ﬂat”. Suﬃcient ﬂatness is achieved, for example, when all entries (or
bins) of the histogram do not deviate by more than 70 or 80% from their mean,
⟨H(E)⟩. Once the histogram is ﬂat, the modiﬁcation factor is reduced according
to the formula, f1 = √f0 and the histogram H(E) is reset to zero. The above
cycle is repeated until the newly constructed histogram H(E) is again “ﬂat”.
The algorithm stops when the modiﬁcation factor f is smaller than a predeﬁned
value, typically in the vicinity of ln f = 10−10.
2.1
Multidimensional DOS
The original WL DOS algorithm (24) was originally conceived in the context of
an Ising system, having discrete energy states. That approach was subsequently
extended to systems in a continuum (a Lennard-Jones ﬂuid) by Yan et al. (47,48).
Yan et al. (47) also presented extensions to open systems, where both the num-
ber of particles N and the energy E were sampled for a Lennard-Jones ﬂuid,
thereby generating an estimate for Ω(N, E) over a wide range of density that

Density of states
7
enabled calculation of the entire phase behavior of the Lennard-Jones ﬂuid from
Ω(N, E). Figure 1 shows the density of states Ω(N, E) of Lennard Jones system
with the corresponding liquid-vapor coexistence curve. One can see that DOS
simulations permit calculation of vapor liquid equilibria at relatively low temper-
ature, where alternative approaches such as Gibbs ensemble simulations would
be overly demanding.
(a)
(b)
ln[Ω(N,E)]
ρ*
E/ε
T*
Figure 1: Two-dimensional density of states and the corresponding vapor-liquid
coexistence curve for the truncated Lennard-Jones system. Each line in Figure
(a) corresponds to a diﬀerent value of N in the range N = 0 to N = 110 for a
volume of 125 σ3 Lennard-Jones units [from Reference (47)]; p∗represents the
pressure in reduced units.
Subsequent reﬁnements of the WL DOS algorithm facilitated applications to
more complex systems (30, 49–55), including glasses (56), polymers (57) and
proteins (58–63). In what follows we discuss in more detail several extensions or
reﬁnements of the WL DOS method.
In cases where it is of interest to determine the density of states as a function
of E and V , regular canonical-ensemble displacement moves, where trial conﬁgu-
rations are generated through random perturbations of an existing conﬁguration

8
Singh et al.
must be supplemented with isobaric-ensemble volume moves, where the volume
of the simulation box is also changed. Canonical ensemble trial moves are ac-
cepted with the probability criteria (1) given by Equation 2. Volume-change trial
moves are accepted according to:
P(E1, V1 →E2, V2) = min
"
1,
V2
V1
N g(E1, V1)
g(E2, V2)
#
.
(3)
Simulations are carried out in manner analogous to that employed for uni-dimensional
DOS; the H(E, V ) histogram is reset whenever it is deemed suﬃciently ﬂat and
the modiﬁcation factor is decreased according to the prescription fi+1 = √fi.
2.2
Expanded Ensemble DOS (EXEDOS)
As outlined above, DOS algorithms can be used to generate diﬀerent projec-
tions of the micro-canonical density of states Ω(E, V, N), which can then be used
to determine averages in traditional statistical mechanical ensembles such as the
NV T, NPT or µV T. There are cases, however, where it is of interest to generate
a free energy proﬁle along a particular order parameter or reaction coordinate.
Consider, for example, the potential of mean force that is required to bring two
molecules in a liquid into close proximity. That potential of mean force is pro-
portional to radial distribution function and can be measured experimentally.
Consider the potential of mean force required to unfold a protein by pulling on
its ends, which can also be measured by atomic force microscopy. A potential
of mean force can be determined by resorting to an expanded ensemble formal-
ism (12,16,26). The thermodynamic space of interest is subdivided into M states
along an order parameter or reaction coordinate s such that the mth state corre-
sponds to a particular value of s = sm. The partition function of this expanded

Density of states
9
ensemble is given by:
Ω=
M
X
m=1
Q(N, V, T, m)gm =
M
X
m=1
Qmgm,
(4)
where Qm and gm denote a canonical partition function and a positive weight
factor for state m, respectively.
The probability pm with which a state m is
visited is related to the partition function, Ω, through:
pm = Qmgm
Ω
.
(5)
In general, one has the following relation between any two expanded states m
and k,
Qm
Qk
= pmgk
pkgm
.
(6)
The free energy diﬀerence between two states m and k is therefore given by:
β[F(sm) −F(sk)] = −ln Qm
Qk
= −[ln gk −ln gm] + [ln pk −ln pm].
(7)
If a uniform sampling of states is enforced, then ln pk −ln pm = 0 and β[F(sm) −
F(sk)] = −[ln gk −ln gm].
For a continuous order parameter, a uniform sampling of states can be achieved
by performing DOS simulations along a reaction coordinate, as opposed to energy
space. The approach is referred to as expanded ensemble density of states, or
EXEDOS. The aim of the simulation is to determine the weights as a function
of the order parameter, g(s). One generates trial conﬁgurations through ran-
dom displacements of the reaction coordinate at random and by accepting them
according to
P(s1 →s2) = min{1, e−β(E2−E1)−(ln g2−ln g1)}.
(8)
As before, g(s) is initially assumed to be a constant, typically 1. A histogram
H(s) is accumulated and eventually reset to zero whenever it is deemed to be

10
Singh et al.
suﬃciently ﬂat.
A modiﬁcation factor is used to update g(s), whose value is
decreased as repeated cycles of the algorithm are performed.
The converged
value of g(s) corresponds to the free energy proﬁle along the reaction coordinate
s, as indicated in Equation 7.
The above formulation of EXEDOS can be further generalized to any number
of dimensions, and can therefore be used to obtain free energy surfaces along an
arbitrary number of order parameters.
2.3
DOS with Molecular Dynamics: Metadynamics
The DOS and EXEDOS algorithms described above are all based on Monte-Carlo
algorithms. Given the widespread availability of molecular dynamics simulation
codes (64–69), however, it is of interest to devise advanced sampling techniques
that rely on molecular dynamics “moves” to explore phase space. The central
idea behind density of state simulations is to arrive at a set of weights (the den-
sity of states) such that sampling along a given thermodynamic variable of order
parameter is uniform. That idea can be carried over to molecular dynamics tech-
niques, where properly chosen forces can be introduced to evolve the system in
a manner that leads to uniform sampling. The so-called “local elevation search
method” (14), various “adaptive bias force methods” (14, 23, 37–39, 42) and the
“self-healing umbrella sampling” (70) technique are all examples of such a strat-
egy.
“Metadynamics,” originally introduced by Parrinello et al. (71, 72), relies on
similar ideas. In metadynamics, uniform sampling is sought along a ﬁnite number
of collective variables (CVs), sα(x), α = 1, 2, . . . , d where d is a small number and
x denotes the Cartesian coordinates of the system. In a traditional molecular

Density of states
11
dynamics simulation the system can be trapped in local energy minima. To pro-
mote uniform sampling, metadynamics adds a small repulsive Gaussian potential
to the system to help it escape from such minima, at intervals of time τG. The
height W and the width δsα of the Gaussian potential are chosen in a way that
provides a reasonable compromise between accuracy and eﬃciency when explor-
ing the free energy surface. At any given time t, for a system at a point s in CV
space, the net force acting on a particle ftotal(t) is given by:
ftotal(t) =
−∂V (x)
∂x
−
d
X
α=1
∂VG(sα(x), t)
∂sα
∂sα
∂x ,
(9)
where V (x, t) is the original potential energy experienced by a particle at x, and
VG(sα(x), t) is the net added Gaussian potential given by:
VG(s, t) = W
X
t′≤t
exp
 
−
d
X
α=1
(sα −sα(t′))2
2δs2α
!
.
(10)
Figure 2 provides an illustration of the mechanism by which hills are added to the
actual potential energy. In addition to facilitating uniform sampling of the CV
space, metadynamics also yields the free energy proﬁle along the CVs according
to F(s) = −VG(s, t →∞). Laio et al. (73) have recently published an extensive
review of metadynamics.
One shortcoming of the original metadynamics prescription is that it does not
oﬀer a well-deﬁned, optimal procedure to determine whether a simulation has
converged. Several solutions have been proposed to address this issue, some of
which are discussed in more detail in Section 5. One that stands out in the con-
text of this review is that proposed by Min et al. (74), which takes advantage
of a direct relationship between metadynamics (71, 72) and the WL DOS algo-
rithm (24). In their implementation of metadynamics, the simulation is started
with an arbitrary hill height W, and a histogram of visits to distinct collective

12
Singh et al.
V(x)
x
Figure 2: A schematic representation evaluation of potential energy in a of meta-
dynamics method. The thick line represents the bare potential energy V (x) of
the system. The thin lines correspond to the sum V (x) + P VG(x, t) at time t
(see Equation 10). The numbers denote the number of Gaussains aded to the
system at a given time t. As more and more Gaussians are added, the potential
energy minima are gradually ﬁlled and sampling of diﬀerent states becomes more
uniform. [from Reference (71)]
variable states is recorded. Similar to the Wang-Landau algorithm, once that
histogram is suﬃciently “ﬂat”, the height of the hills W is decreased. The pro-
cess continues until the hills’ height reaches some pre-speciﬁed value. Additional
details of this method are given in Section 5.1.
At this point it is instructive to emphasize the connection between WL DOS
simulations (24), EXEDOS simulations (16) and the metadynamics simulations (71).
In an EXEDOS simulation, with applied weight of w(s), the system is distributed
along an order parameter s nw(s) ∝w(s)g(s), where g(s) is the density of states

Density of states
13
of the system. As pointed out earlier, the goal of DOS simulations is to visit all
states uniformly by constructing weights such that w(s) ∝
1
gs. Once converged,
an EXEDOS simulation yields the free energy as βF(s) = ln w(s) = −ln g(s).
In metadynamics, F(s) is given by −VG(s), i.e. the negative of the sum of all
the added Gaussians, in a limit of long simulation times. The weights applied
in a DOS simulation ln w(s) are therefore equivalent to those applied in metady-
namics, i.e. F(s) = −VG(s) = kBT ln w(s). In view of this relationship, it is of
interest to discuss WL based simulations and metadynamics approaches within
the common umbrella of density of states, where the underlying idea is to have
the simulation be guided by the underlying free energy surface.
3
Mathematical foundation of DOS based methods
The acceptance criteria for Monte-Carlo based DOS simulations depend on weights
that change continuously as the simulation proceeds. As such, this class of algo-
rithms generally violates the condition of detailed balance. Proving the conver-
gence of DOS methods has been challenging, and much work has been carried
out towards that end under diﬀerent controlled conditions. Before commenting
on the issue of convergence, we begin by deriving the acceptance criteria for
Monte-Carlo based DOS methods and brieﬂy discuss the parameters that enter
metadynamics and their eﬀect on the accuracy and performance of a simulation.
3.1
Acceptance criterion for Wang-Landau DOS simulations
While a DOS algorithm does not generally satisfy the condition of detailed bal-
ance, the acceptance criteria for DOS simulations are in fact based on that con-
dition (31,75,76). The detailed balance condition for any Monte-Carlo algorithm

14
Singh et al.
is:
Γ(o →n) = Γ(n →o),
(11)
where Γ(o →n) is the transition probability from state o to state n.
That
transition probability can be decomposed into three factors:
Γ(o →n) = Pensemble(o) × Ppropose(o →n) × Paccept(o →n),
(12)
where Pensemble(o) is the probability of ﬁnding the system in conﬁguration o,
Ppropose(o →n) is the probability of proposing a transition from conﬁguration o
to a trial conﬁguration n, and Paccept(o →n) is the probability of accepting that
transition. In the original WL DOS approach, Pensemble(o) ∝
1
Ω(Eo) and, in the
absence of any biases, Ppropose(o →n) = Ppropose(n →o). One therefore has
Paccept(o →n)
Paccept(n →o) = Ω(Eo)
Ω(En).
(13)
One form of Paccept that satisﬁes Equation 13 and that is used in the Wang-
Landau DOS algorithm is:
Paccept(o →n) = min

1, Ω(Eo)
Ω(En)

.
(14)
The value of Ωis calculated on the ﬂy, and detailed balance is not satisﬁed at
the outset of a simulation. As the simulation proceeds, however, Ωapproaches
an asymptotic value. In the limit where Ωno longer changes detailed balance is
satisﬁed.
3.2
Acceptance criterion for EXEDOS simulations
In EXEDOS simulations (16) the goal is to calculate a free energy proﬁle along
a reaction coordinate or order parameter. As discussed earlier, the free energy

Density of states
15
change along the order parameter s is given by:
∆Λensemble(s(o) →s(n)) = kBT log Pensemble(s(o))
Pensemble(s(n)),
(15)
where ∆Λensemble(s(o) →s(n)) represents the free energy change in the ensemble
of interest. P EXEDOS
ensemble (s) is the probability that the system has order parameter
s, and is given by:
P EXEDOS
ensemble (s) =
W(s)
R
δ(s −s(qN))Wensemble(qN)dqN
R
s W(s)
R
δ(s −s(qN))Wensemble(qN)dqNds,
(16)
where W(s) are the EXEDOS weights for the order parameter value s and
Wensemble(qN) are the ensemble weights for the underlying ensemble. The aim
is to achieve uniform sampling along s, i.e. to have a constant P EXEDOS
ensemble (s).
That implies W(s) ∝
R
δ(s −s(qN))Wensemble(qN)dqN. Also, the Pensemble for
any generic unbiased ensemble can be written as
Pensemble(s) =
R
δ(s −s(qN))Wensemble(qN)dqN
R
s
R
δ(s −s(qN))Wensemble(qN)dqNds.
(17)
Hence, W(s) ∝
1
Pensemble(s). In an EXEDOS simulation, one generates conﬁgura-
tions in an given ensemble weighted by W(s), hence Pensemble(o) ∝
Wensemble(o)
Pensemble(s(o).
One therefore arrives at the following acceptance rule in an EXEDOS simulation:
Pensemble(o →n) = min

1, Pensemble(s(o))Wensemble(n)
Pensemble(s(n))Wensemble(o)

.
(18)
The quantity Wensemble represents the weight corresponding to a given ensemble.
For the canonical NV T ensemble, Wensemble = e−βU; for the NPT ensemble,
Wensemble = e−βU−PV .
3.3
Convergence of DOS-based methods
The acceptance criteria in DOS algorithms are based on the “on-the-ﬂy” estimate
of Ω. This leads to a coupling of accepted states and the past history of the sim-
ulation. Therefore, unlike the case with regular Metropolis sampling (77), a DOS

16
Singh et al.
simulation does not follow a Markov process (44,76,78). Earl and Deem (79) have
derived a general condition for convergence in Monte-Carlo methods whose his-
tory dependence is contained in the simulated density distribution. The authors
conclude that for a DOS method to converge, the condition of detailed balance
need only be satisﬁed asymptotically, and the calculated density of states need
only approach the exact one with an error proportional to 1/time. Several au-
thors have explained the convergence of the DOS algorithm. Zhou and Bhatt (78)
showed analytically that for a model with N discrete energy states, the WL DOS
algorithm does indeed converge to the correct density of states Ω. They also
found that the statistical error scales as √ln f, where f is the modiﬁcation fac-
tor. This result has also been found by Lee et al. (75) in their simulations. Zhou
and Bhatt (78) pointed out that the statistical error in DOS simulations can be
decreased both by reducing f or by running multiple calculations. They showed
that using large values of f leads to systematic errors in the calculated value
of Ωdue to the correlation between adjacent records in the histograms. They
proposed that DOS simulations be started with a large f, and that f be subse-
quently reduced in large steps. Multiple measurements can be made in the ﬁnal
stage to reduce the statistical error eﬀectively.
Morozov et al. (76) examined the accuracy and convergence of the DOS algo-
rithm for a two-level system. Consistent with Zhou and Bhatt (78), they found
that the statistical error scales as √ln f. Furthermore, they also found that the
gradient of entropy S, S = ln Ω, also aﬀects the accuracy and convergence of
DOS methods. Given the dependence of convergence on the modiﬁcation factor
f, Belardinelli et al. (80) proposed a time dependent modiﬁcation factor, namely,
f(t) ∝1/t. With that prescription, the calculated density of states gcalc(E, t)

Density of states
17
approaches asymptotically the exact value gexact(E) as ∝t−0.5, thereby avoiding
the saturation error originally identiﬁed by Yan et al. (81). Belardinelli et al. (82)
analyzed in more detail the time dependence of the error calculated with the 1/t
algorithm and found that it varies as N−1/2, where N is the number of Monte
Carlo (MC) steps, in quantitative agreement with the simple sampling Monte
Carlo method. More recently, Zhou et al. (83) have the 1/t rule and have shown
that the convergence of a simulation is at least as good as the conventional Monte
Carlo algorithm, i.e., the statistical error vanishes as 1/t, where t is a normalized
time of the simulation. Importantly, they also prove that the error cannot vanish
faster than 1/t.
3.4
Histogram reweighing in DOS-based methods
The usefulness of a DOS simulation can be enhanced signiﬁcantly by resorting
to histogram reweighing (84,85). For example, the free energy proﬁle generated
by a DOS-based algorithm in an NPT ensemble at inverse temperature β1 can
be reweighed to obtain a free energy proﬁle at an inverse temperature β2. While
histogram reweighing in the context of a traditional WL strategy has been dis-
cussed in the literature (86–88), extensions to EXEDOS simulations have been
less common. In the following, we outline a speciﬁc procedure to do so.
The probability that a system exhibits order parameter s at temperature β2 in
an NPT ensemble is given by is given as:
Pβ2,P(s) =
R
δ(s −s)e−β2(U+PV )dqN
R
e−β2(U+PV )dqN
.
(19)
This equation can be rewritten as:
Pβ2,P(s) =
R
δ(s −s)e−β2(U+PV )dqN
R
e−β1(U+PV )w(s)dqN
×
R
e−β1(U+PV )w(s)dqN
R
e−β2(U+PV )dqN
.
(20)

18
Singh et al.
Equation 20 can be further modiﬁed to:
Pβ2,P(s) =
R
δ(s −s)e−β1(U+PV )e(β1−β2)(U+PV )dqN
R
e−β1(U+PV )w(s)dqN
×
R
e−β1(U+PV )w(s)dqN
R
e−β1(U+PV )e(β1−β2)(U+PV )dqN .
(21)
By introducing the isobaric-isothermal NPT probability distribution and weight
functions, Equation 21 can be expressed as:
Pβ2,P(s) =
R
δ(s −s)e−β1(U+PV )e(β1−β2)(U+PV )Pβ1,P(s)w(s)dqN
R
e−β1(U+PV )w(s)dqN
|
{z
}
‘a’
×
R
e−β1(U+PV )w(s)dqN
R
e−β1(U+PV )e(β1−β2)(U+PV )Pβ1,P(s)w(s)dqN
|
{z
}
‘b’
.
(22)
In an actual simulation Equation 22 must be discretized. Note that the term
‘a’ in Equation 22 will pick only the values of U and V for which the order
parameter is s, while the term ‘b’ will include the complete sum. If we divide the
order parameter range into Nb discrete bins and store the corresponding U and V
values from an EXEDOS simulation in the respective bins, the probability that a
conﬁguration will exhibit a value of s in the range (sm, sm+1) can be written as:
Pβ2,P(sm,sm+1) =
Pβ1,P(sm,sm+1)
PNm
i=1 e−(β2−β1)(Ui,m+PVi,m)
PNb
m=1 Pβ1,P(sm,sm+1)
PNm
i=1 e−(β2−β1)(Ui,m+PVi,m) ,
(23)
where Ui,m and Vi,m denote the ith entry in the mth bin, and Nm is the total
number of entries in the mth bin. Using Equation 23, one can predict a free energy
proﬁle at temperature β2, provided that proﬁle is known from an NPT EXEDOS
simulation at temperature β1. Similar derivations can be carried out for arbitrary
DOS-based approaches. References (89) and (90) present two useful derivations
of histogram reweighing for the speciﬁc case of metadynamics simulations.

Density of states
19
4
Advanced DOS-based Monte-Carlo (MC) methods
As alluded to earlier, several ideas have been proposed to address the convergence
of DOS-based Monte Carlo techniques. In what follows we brieﬂy highlight several
such methods that we believe to be of particular importance for study of complex
systems.
4.1
Conﬁgurational biased DOS
The original WL DOS method was implemented on a 2-D Ising model employing
simple local moves (24).
The free energy surface of molecular systems, such
as proteins or polymers, is more complex, and more elaborate Monte-Carlo
trial moves are often required for eﬃcient sampling.
Jain and de Pablo (57)
proposed a modiﬁed version of the traditional WL DOS that takes into ac-
count the use of advanced biased moves, in particular through the use of sim-
ple conﬁgurational bias (91,92) and topological conﬁgurational bias (93) moves.
The modiﬁed algorithm is similar to the traditional WL DOS but the accep-
tance criteria. As described in Section 3.1, in deriving Equation 13 we assumed
Ppropose(o →n) = Ppropose(n →o). If a conﬁgurational bias is introduced, Equa-
tion 13 must be rewritten as
Paccept(o →n)
Paccept(n →o) = Ω(Eo)Ppropose(n →o)
Ω(En)Ppropose(o →n).
(24)
Hence, the Metropolis acceptance criteria used in the case of a conﬁgurational
biased DOS simulation becomes:
Paccept(o →n) = min

1, Ω(Eo)Ppropose(n →o)
Ω(En)Ppropose(o →n)

.
(25)
The particular form of the function Ppropose(o →n) depends on the details of the
trial move (57).

20
Singh et al.
4.2
Conﬁgurational temperature DOS (CT DOS)
In traditional DOS simulations, the convergence factor f is decreased monotoni-
cally as the simulation proceeds. Conﬁgurations generated at diﬀerent stages of
the simulation therefore do not contribute equally to the running estimate of the
free energy proﬁle. As originally pointed out by Yan et al. (81), in late stages of
the simulation, the convergence factor is so small that the contribution of the cor-
responding conﬁgurations to the free energy becomes negligible. In other words,
many of the conﬁgurations generated in a conventional WL DOS simulation are
not utilized eﬀectively, and increasing simulation time does little to improve the
ﬁnal result of a simulation.
In order to circumvent this problem, Yan et al. (81) realized that rather than
updating directly the density of states through a random walk in energy space,
one can actually update the derivative of the density of states with respect to
energy, and then integrate that function to arrive at Ω(E) (94). That derivative
is the temperature:
1
T =
 ∂S
∂E

V
= kB
∂ln Ω(N, V, E)
∂E

V
,
(26)
which can be integrated to give the density of states according to
ln Ω(N, V, E) =
Z E
E0
1
kBT dE .
(27)
Equation 27 requires that the temperature be known as a function of the energy.
Yan et al. (81) used the instantaneous “conﬁgurational temperature,” which can
be determined from the particles’ coordinates according to
1
kBTconfig
= ⟨−P
i ∆i.Fi⟩
⟨P
i |Fi|2⟩
,
(28)
where Fi is the force acting on particle i. In their proposed random walk algo-
rithm, which they referred to as “conﬁgurational temperature DOS (CT DOS)”,

Density of states
21
the dynamically modiﬁed density of states only serves to guide the random walker
through conﬁguration space. The ﬁnal thermodynamic density of states is calcu-
lated from the conﬁgurational temperature accumulated in the simulation accord-
ing to Equation 27. Since all conﬁgurations generated throughout the simulation
contribute equally to the estimated conﬁgurational temperature, the algorithm
eliminates the problem of non-uniform contributions to the density of states en-
countered in traditional WL DOS sampling.
For systems in which the conﬁgurational temperature is not directly acces-
sible, (e.g.
hard-sphere or lattice systems), Yan et al. (81) also introduced a
microcanonical formulation, in which the sum of kinetic and potential energy is
constant, but the potential energy is allowed to ﬂuctuate. The kinetic energy can
then be used to estimate an instantaneous temperature, which is used as outlined
above to calculate the density of states. In such an ensemble, the probability to
observe a conﬁguration x having total energy E and potential energy U(x) is
given by:
π(E, x) ∝[E −U(x)](l−2)/2Θ[E −U(x)]
Ω(N, V, E)
,
(29)
where l is the total number of degrees of freedom of the system, Θ is the unit
step function and Ω(N, V, E) is the density of states corresponding to the total
energy E, which is calculated on the ﬂy as in a WL DOS simulation.
Figure 3 compares the performance of various algorithms for a truncated and
shifted Lennard-Jones ﬂuid. Results are shown for the statistical error as a func-
tion of convergence factor.
For a given amount of computer time, the errors
corresponding to the CT DOS method are much lower than those obtained in a
WL-DOS simulation. Yan et al. (81) estimate that for simple LJ ﬂuid simulations
their proposed approach is approximately two orders of magnitude faster than

22
Singh et al.
traditional WL DOS simulations. The CT DOS method has shown to be partic-
ularly eﬀective for complex systems, including proteins (60) and glasses (95).
Statistical Errors in ln Ω
Convergence Factor (ln f)
Figure 3:
Performance of CTDOS algorithm as compared to normal Wang-
Landau DOS simulations for a truncated-and-shifted Lennard-Jones liquid
(0.85 < T ∗< 1.5; ρ∗= 0.78).
The percentage given in the label represents
the degree of ﬂatness of the histogram. For Wang-Landau simulations, the errors
reach an asymptotic value as the simulation time increases (or ln f decreases).
For CTDOS simulations, the error decreases as simulation time increases. For a
given amount of simulation time, the errors of CTDOS are smaller than those of
WL DOS. [from Reference (81)]

Density of states
23
4.3
Use of multiple windows
It has been shown by Dayal et al. (96) that the computational time required by
DOS techniques scales as the exponential of the system size and the corresponding
energy range. One way of circumventing this problem is to divide the energy
range of interest into smaller ranges, and then combine the results from smaller
simulations to generate the entire density of states for a broad energy domain.
More speciﬁcally, Yan et al. (81) proposed to divide a wide energy range into
smaller, slightly overlapping energy windows. Independent WL DOS or CT DOS
simulations are run in each of these energy windows, and conﬁguration exchanges
or “swap” moves are proposed between adjacent windows every Nswap steps.
Once converged, the density of states functions corresponding to all windows are
merged to generate the density of states over the entire energy range of interest.
Such an approach gives rise to the problem of choice of width of windows. Several
approaches (97–100) have been proposed to calculate the width of windows.
Several attempts have been made to improve various aspects of multiple-
window DOS simulations.
A particularly eﬀective approach was proposed by
Janosi and Doxastakis (101), who rely on a multiple-walker multiple-window ap-
proach depicted in Figure 4.
They propose to divide the order parameter of
interest into multiple overlapping windows. Each windows is sampled by using
multiple independent walkers (multiple realizations of the box). At regular inter-
vals randomly chosen walkers from adjacent windows ar swapped. The advantage
of their method over traditional WL DOS simulations is evident in the results
shown in Figure 5 for a Q = 10 Potts model. One can see that the number of
steps by a walker necessary to produce a ﬂat histogram of energies in the late
stages (small ln f) of a DOS simulation is smaller when 8 walkers are used than

24
Singh et al.
Figure 4:
Schematic representation of the multiple-window multiple-walker
method as proposed by Janosi et al. (101). The order parameter ξ is divided
into three windows, and N diﬀerent walkers are used to simulate each windows.
The dotted arrow represents a possible conﬁguration exchange move.
a single walker is used (which corresponds to a WL simulation). This scheme is
particularly helpful for parallel architecture. The authors also demonstrate the
advantages of using such an approach in conjunction with smart Monte-Carlo
moves.
4.4
Round-trip algorithms
An important concept in DOS-based simulations is the so-called “tunneling time”
required for the random walker to travel from the lower bound of a given energy

Density of states
25
Distribution
Figure 5: Advantages of multiple-window multiple-walker algorithm over WL
DOS simulations for a Q = 10 Potts model using diﬀerent number of walkers. τ
denotes the number of steps by a walker necessary to produce a ﬂat histogram
of energies in the late stages (small ln f) of a DOS simulation. The ﬁgure shows
the normalized distribution of τ, extracted from 5000 independent simulations.
[from Reference (101)]
range to its upper bound. Ideally one would like that tunneling time to be as
short as possible. Dayal et al. (96), however, have shown that for a 2D Ising
model the “tunneling time” in a conventional ﬂat-histogram WL DOS method
increases signiﬁcantly with system size N, thereby placing restrictions on the
types of problems that can be addressed by WL DOS sampling simulations. These
restrictions can be alleviated by resorting to multiple windows, as mentioned
earlier. They can also be circumvented by relaxing the ﬂat-histogram condition
of the original WL algorithm. Trebst et al. (102) have proposed an algorithm that
systematically optimizes the sampling in DOS-based simulations by maximizing

26
Singh et al.
the number of round-trips between the low and the high end of the energy range.
Such an approach implicitly leads to minimization of the tunneling time.
To
measure the number of round trips, these authors deﬁned two types of walkers:
unlabeled walkers and labeled walkers (‘+’ and ‘-’, respectively, with distributions
given by n+ and n−). The labels serve to indicate which of the two extrema of
the energy space the walker last visited. The two extrema of the energy window
act as “reﬂecting” and “absorbing” boundaries for the labeled walkers: if the
label is ‘+’, a visit to the upper energy bound does not change the label, whereas
a visit to the lower energy bound leads the walker to change its label from ‘+’ to
‘-’. The fraction of time that a walker is labeled ‘+’ is given by f(E) = n+(E)
nw(E),
where nw(E) denotes the number of times system has visited an energy value of
E when w weights are applied to it. A current j can then be deﬁned to quantify
the ﬂow of labeled walkers according to
j = D(E)nw(E) df
dE ,
(30)
where D(E) represents the labeled walker’s diﬀusivity. Noting that at steady
state the current j should be constant, and also noting that f(E) satisﬁes the
boundary conditions f(Emax) = 1 and f(Emin) = 0, Equation 30 can be written
as:
1
j =
Z Emax
Emin
dE
D(E)nw(E) .
(31)
In order to maximize the number of round-trips in a given energy range, Equa-
tion 31 needs to be minimized under the constraint that nw(E) be a probability
distribution function. Using an Euler-Lagrange relation, the optimal solution is
found to be:
noptimal
w
=
1
D(E)λ ,
(32)

Density of states
27
where λ is an arbitrary constant. The problem is therefore one of ﬁnding the
diﬀusivity D(E) of labeled walkers.
Trebst et al. (102) proposed an iterative
feedback algorithm to estimate D(E) in which simulations are started with arbi-
trary weights w(E). A ﬁxed number of Monte-Carlo steps is performed and the
weights are modiﬁed according to the collected statistics using a set of rules that
are based on Equation 32:
ln w(E)(new) = ln w(E)(old) + 0.5

ln df
dE −ln nw(E)(old)

.
(33)
The feedback loop is continued until the weights stop changing.
Trebst et al. (102) have shown that, using this algorithm, the relative sta-
tistical error in the density of states scales as O(1/N1/2
round trips).
For the 2D
ferromagnetic and fully frustrated Ising models, round-trip times, τ, from the
ground state to the maximum entropy state scale as O([N ln N]2), which rep-
resents a signiﬁcant speedup compared to the power-law behavior O(N2+z) of
conventional ﬂat-histogram DOS algorithms, where 0 < z ≤1. Results for the
Ising model system are given in Figure 6; for simple systems, the advantage of
ﬂux methods over ﬂat-histogram approaches is evident. An extension of the work
of Trebst et al. (102) for EXEDOS simulations has been presented by Escobedo
et al. (103) and by Mart´ınez-Veracoechea et al. (104).
4.5
Use of rejected states to enhance sampling
All of the DOS-based methods described above rely on the original Metropolis
concept (77) in which only accepted trial moves are used to compute thermo-
dynamic averages. Rejected states are never used to estimate observables such
as the density of states. Frenkel et al. (105) showed that rejected states can in
fact be used in traditional Monte Carlo simulations to improve sampling. Chopra

28
Singh et al.
16
64
L = N
1/2
0.1
1
10
100
τ / N
2
Round Trip Maximization
Wang-Landau DOS
Figure 6: Scaling of round-trip times (τ) in the energy interval [-N,0] for the
2D fully frustrated Ising model with N spins using Metropolis dynamics. The
open symbols show results from WL DOS simulations and the ﬁlled symbols show
results from the round trip maximization algorithm. [from Reference (102)]
et al. (106) were subsequently able to show that rejected states can also be in-
cluded in WL-DOS and CT DOS algorithms to improve sampling and the overall
performance of DOS-based simulations.
In order to include rejected states in the WL-DOS algorithm, a single WL-
DOS step between two states o to n is replaced by M WL-DOS steps, where
M is a large number.
The states o and n will be referred to as microstates,
and the M intermediate WL-DOS steps as microsteps.
These microsteps are
analogous to the sampling of a “Markovian web” in Reference (105). If out of
M microsteps, Mo steps are taken to state o (and Mn steps to state n), and
if in every visit to o (or n) the density of states Ωis updated according to

Density of states
29
Ω(Eo) = Ω(Eo)f [or Ω(En) = Ω(En)f], where f is an arbitrary modiﬁcation
factor, then, in eﬀect, after M microsteps, Ω(Eo) is modiﬁed to Ω(Eo)fMo (and
Ω(En) to Ω(En)fMn). In the limit of M going to inﬁnity, Mo (or Mn) is given by
Mo = MP(o) [and Mn = MP(n)], where P(s) is the probability of visiting state
s during the microsteps. The probability P(s) in DOS simulations is proportional
to 1/Ω(Es); for the microsteps, P(o) is given by Ω(n)/(Ω(o) + Ω(n)) and P(n)
is given by Ω(o)/(Ω(o) + Ω(n)). After the microsteps, the density of states Ωis
updated according to:
Ω(E) =



















Ω(Eo)f
Ω(n)
(Ω(o)+Ω(n)) ,
if E = Eo
Ω(En)f
Ω(o)
(Ω(o)+Ω(n)) ,
if E = En
Ω(E),
if E ̸= E0 or En .
(34)
Note that no histogram update is performed during the microsteps. The remain-
der of the algorithm is identical to that of a conventional DOS simulation. The
analysis for CT DOS algorithm is similar. As illustrated in Figure 7, Chopra
et al. (106) reported that for DOS simulations of a simple Lennard-Jones liquid,
CTDOS with the use of rejected states provides results of higher accuracy than
those obtained by a traditional WL DOS method.
4.6
Additional improvements of DOS simulations
Additional improvements over the original WL DOS approach rely on the concept
of parallel tempering (20) or replica exchange (21). Escobedo et al. (59), for ex-
ample, have shown that EXEDOS simulations can be improved by applying small
number of replicas to the expanded ensemble simulations. Another improvement
to DOS approaches, suggested by Shell et al. (107), seeks to accelerate the time
required to reach a ﬂat histogram by providing an estimator of the initial guess

30
Singh et al.
0.95
0.96
0.97
0.98
0.99
1
T
*
0.0016
0.008
0.04
Error in CV / kB
WLDOS
WLDOSH
CTDOS
CTDOSH
Figure 7:
Statistical error in the calculation of speciﬁc heat (Cv/kB) for a
truncated-and-shifted Lennard-Jones liquid (ρ∗= 1).
For a given amount of
computer time, the CTDOS method with the use of rejected states (CTDOSH)
provides results of higher accuracy than those obtained by a traditional WL DOS
method. [from Reference (106)]
of density of states that relies on inﬁnite-temperature transition probabilities, i.e.
the probabilities associated with move proposal only.
5
Advancements in metadynamics
Just as was the case for traditional DOS simulations, some of the central concerns
in metadynamics simulations are related to convergence. The issue of conver-
gence in metadynamics is perhaps more severe because, as originally proposed,
the method relies on a continuous inﬂux of energy into the system through-
out the entire durantion of an MD simulation; detailed balance is not satisﬁed
asymptotically, as was the case in Monte Carlo DOS based approaches. Several

Density of states
31
strategies (72–74, 108–112) have been proposed in recent years to address such
concerns. Most of these strategies provide only ad-hoc solutions; mathematical
proofs of convergence have been scarce. We discuss several of these techniques
in what follows and, for a few simple model systems, we provide comparative
results.
Metadynamics yields a free energy proﬁle F(s) as a function of an order pa-
rameter s. One of the simplest solutions to deal with the problem of convergence
involves a simple averaging of F(s) performed over the ﬁnal portion of a regular
metadynamics simulation run. Mathematically, the converged free energy curve
is given by:
F(s) = 1
τ
Z T
T −τ
dtF(s, t),
(35)
where τ represents the time over which the averaging is performed and T repre-
sents the total time for a metadynamics run. It has been shown numerically that
such an approach works for a model Langevin system without memory friction
or inertia (113) and for a two-dimensional Ising model (114) using Monte-Carlo
metadynamics. For more complex systems, where the free energy is unknown `a
priori, it is unclear whether this approach would work and how parameters τ and
T would inﬂuence the results.
5.1
Flat-histogram metadynamics (FHM)
Another solution to the problem of convergence in metadynamics has been pro-
posed by Min et. (74), based on ﬂat-histogram ideas from WL DOS simulations.
Min et al. (74) propose to start a regular metadynamics with large hill heights,
and to collect a histogram of visits to distinct order parameter states. Once that
histogram is suﬃciently ﬂat, the height of the hills is decreased. In a sense, the

32
Singh et al.
height of the hills being added plays a role analogous to that of the modiﬁcation
factor f in DOS-based algorithms. As the hill height becomes smaller, the con-
dition of detailed balance can be shown to be satisﬁed asymptotically similar to
the case of WL DOS simulations. After several metadynamics cycles, the hills
are so small that the free energy surface F(s) changes only negligibly, thereby
leading to a converged free energy surface. Mathematically, the distribution of
the system, i.e. the histogram nw(s) is given by nw(s) ∝w(s)Ω(s) where w(s)
represents the weights applied to the system to ensure uniform sampling of the
order parameter space, and Ω(s) is the density of states of the system. In this
notation, nw(s) denotes the number of times that a state s is visited for a given
applied weight w(s). In the spirit of DOS approaches, once the histogram is ﬂat
and nw(s) is constant, the free energy F(s) is given by:
F(s)
kBT = ln w(s) = −ln Ω(s).
(36)
As noted before, in traditional metadynamics, the free energy surface F(s) is
given by the negative of the added Gaussian potentials −VG(s). Hence, we see
from Equation 36 that the added Gaussian potentials are analogous to the weights
applied to ensure uniform sampling: ln w(s) = −ln Ω(s) = −VG(s)
kBT . More gen-
erally, in metadynamics, the additional Gaussian potential terms can be seen as
the set of weights w(s) applied to the system to ensure uniform sampling of the
complete order parameter space. Such a result provides a direct link between
DOS-based methods and the metadynamics approaches that rely on molecular
dynamics simulations to evolve the system.

Density of states
33
5.2
Well-tempered metadynamics (WTM)
Barducci et al. have proposed an alternative means to improve convergence, the
so-called well-tempered metadynamics (WTM) method (115), which is inspired
on ideas from the self-healing umbrella sampling technique (70). In WTM, the
order parameter space s is sampled at an elevated temperature T + ∆T. For a
system with a single collective variable s, the sum of added Gaussian potentials
at any time t is given by:
VG(s, t) = W
X
t′≤t
exp

−VG(s, t′)
∆T

exp

−(s −s(t′))2
2δs2

,
(37)
where all parameters have the same meaning as in Equation 10. Parameter ∆T
controls the rate of decay for the height of the added Gaussian potentials or hills.
The ﬁnal free is is given by:
F(s) = −T + ∆T
∆T
VG(s, t) .
(38)
Note that when ∆T →∞, WTM approaches the traditional metadynamics tech-
nique, and when ∆T →0, it approaches an unbiased simulation. It has been
shown mathematically that, in the long time limit, WTM leads to a converged
free energy surface. The time for convergence, however, depends strongly on the
values of parameters W, δs and ∆T. Given that the actual free energy proﬁle
is not known `a priori, for complex systems it can be challenging to identify an
optimal set of parameters leading to eﬃcient convergence of the algorithm
5.3
Flux-tempered metadynamics (FTM)
As pointed out earlier, metadynamics can be linked directly to DOS-based ap-
proaches.
The concerns raised by Dayal et al. (96) about the limitations of
ﬂat-histogram based sampling algorithms therefore extend to metadynamics. Re-

34
Singh et al.
cently, we have proposed an algorithm, the so-called “ﬂux-tempered metadynam-
ics (FTM),” (112) that addresses convergence by relying on ideas from round-trip
maximization (see Section 4.4). Based on the equivalence between ln w(s) and the
added Gaussian potentials VG(s), as described with respect to the ﬂat-histogram
method proposed by Min et al. (74), Equation 33 can be re-written for metady-
namics according to
VG(s)(new) =VG(s)(old) + m(s);
where, m(s) = −1
2kBT

ln df
ds −ln nw(s)(old)

.
(39)
Just as the strategy of Trebst et al. (102), the FTM method is iterative in nature
and detailed balance is satisﬁed. One major advantage of FTM over other versions
of metadynamics is that the simulated free energy surface does not depend on
the actual metadynamics parameters, such as the hill height W or hill width δs.
It is instructive to compare the performance of various versions of metadynam-
ics on a simple toy model. In what follows we consider an isolated butane molecule
in vacuum. The molecule consists of four atoms labeled C1, C2, C3 and C4. The
potential consists of three bonds corresponding to C1-C2(r1), C2-C3(r2) and C3-
C4(r3), two angles corresponding to C1-C2-C3(θ1) and C2-C3-C4(θ2), and one
dihedral angle corresponding to C1-C2-C3-C4(φ). The potential energy of the
system is given by:
U(r1, r2, r3, θ1, θ2, φ) =Kr(r1 −r0)2 + Kr(r2 −r0)2 + Kr(r3 −r0)2
+Kθ(θ1 −θ0)2 + Kθ(θ2 −θ0)2
+Kφ(1 + cos(nφ)).
(40)
The spring constants Kr and Kθ given by 445 kcal/mol/˚A2 and 230 kcal/mol/radians2,
respectively. The reference bond length (r0) and angle (θ0) are given by 1.528
˚A and 1.91 radians, respectively. The dihedral potential strength and periodic-

Density of states
35
ity are controlled by parameters Kφ and n, respectively, whose values have been
chosen as 10 kcal/mol and 2, respectively. The free energy, F(φ) is sought along
the dihedral angle coordinate. The theoretical value of the desired F(φ) is given
by the dihedral part of the potential function in Equation 40, Fanalytical(φ) =
Kφ(1 + cos(nφ)).
The butane molecule was simulated at 300 K, with a simple velocity-Verlet
integrator and a time step of 0.001 ps. A Nos´e-Hoover thermostat (116) was
used to control temperature.
The parameters of the Nos´e-Hoover thermostat
were computed as speciﬁed in Reference (116). Additional details of the can be
found in Reference (112).
Four variants of metadynamics are considered here. In all cases, hills were
added every 0.1 ps.
First, a conventional metadynamics algorithm was im-
plemented using two values of hill height (W), namely 0.1 kcal/mol and 0.01
kcal/mol. Second, for the well-tempered metadynamics method, all simulations
were performed with an initial hill height of 0.1 kcal/mol. The optimal value
of the parameter ∆T in Equation 37 was determined by trial and error. Note
that determining an optimal value of this parameter is possible only because of
the simplicity of the butane molecule; for more complex systems, doing so can
be challenging. Figure 8 shows the eﬀect of diﬀerent parameters on the quality
of the simulated free energy proﬁle. In particular, we see that a poor choice of
parameters can lead to convergence times that diﬀer by more than three orders
of magnitudes.
Third, the ﬂat-histogram metadynamics as proposed by Min et al. was im-
plemented with an initial hill height of 0.1 kcal/mol. Finally, the ﬂux-tempered
metadynamics (FTM) was also implemented as outlined in Reference (112). The

36
Singh et al.
0.01
1
100
t (ns)
0
10
20
30
40
50
60
Err (t)
W = 0.1, ∆T = 1
W = 0.01, ∆T = 1
W = 0.1, ∆T = 10
W = 0.01, ∆T = 10
W = 0.1, ∆T = 100
W=0.01, ∆T = 100
W = 0.1, ∆T = 1000
W = 0.01, ∆T = 1000
Figure 8: Error as a function of simulation time (see Equation 41) in the free en-
ergy proﬁle of an isolated butane molecule when diﬀerent values of the hill height
W and parameter ∆T are used for well-tempered metadynamics simulations.
initial guess for the FTM method was generated from a conventional metady-
namics run for 500 ps with a hill height of 0.01 kcal/mol. The resulting free
energy proﬁles for all four methods after a simulation run of 1 ns are plotted in
Figure 9.
The FTM method is able to generate a converged free energy proﬁle relatively
quickly, whereas the other variants of metadynamics yield free energy proﬁles that
exhibit considerably larger errors. The convergence can be quantiﬁed through the
following deﬁnition of the error in F(s):
Err(t) = inf
C∈R
Z s+
s−
ds |F(s, t) −Fanalytical(s) −C(t)| ,
(41)
where F(s, t) is the free energy obtained from any method at time t, Fanalytical(s)

Density of states
37
-π
-2π/3
-π/3
0
π/3
2π/3
π
φ
-10
-5
0
5
10
15
Free Energy (kcal/mol)
Meta, W=0.1
Meta, W=0.01
WTM
FHM
FTM
Analytical
Figure 9: Free energy as a function of dihedral angle as obtained by several meth-
ods after a simulation run of 1 ns for an isolated butane molecule. (Meta: Meta-
dynamics, WTM: Well-tempered metadynamics, FHM: Flat-histogram metady-
namics, FTM: Flux tempered metadynamics). [from Reference (112)]
is the analytical (exact) free energy curve, and the optimal value of C(t) is found
using a least-squares ﬁt. Figure 10 shows the error function as deﬁned in Equation
41 for the butane molecule. The FTM method proposed here converges in 1 ns,
faster than all other methods (which require more than 5 ns to converge). More
importantly, the error Err(t) in the free energy proﬁle generated by the FTM
method is considerably smaller [Err(t) ≈0.6] than that obtained with other
methods [Err(t) ≥3.3].
The FTM simulations can be particularly helpful for more complex systems,
including proteins.
Figure 11 shows results for the extension of a 15-residue
helical polyalanine peptide in explicit water from diﬀerent types of metadynamics
simulations and from an extensive umbrella sampling simulation, with statistics

38
Singh et al.
10
100
1000
10000
time (ps)
0
10
20
30
40
50
Err(t)
Meta, W=0.1
Meta, W=0.01
WTM
FHM
FTM
Figure 10: Error as a function of simulation time (see Equation 41) in free energy
proﬁle as a function of time for diﬀerent simulation methods for an isolated butane
molecule. See Figure 9 for deﬁnitions of the acronyms. [from Reference (112)]
collected over 2µs of simulation time. In order to generate an acceptable free
energy proﬁle [Error function(from Equation 41)≤1], the FTM converges several
orders of magnitude faster than the other metadynamics methods considered
here.
Several other approaches (111,117,118) that have been proposed to deal with
the issue of convergence avoid the idea of calculating a free energy proﬁle directly
from metadynamics.
Babin et al. (111) and Zhang et al. (118), for example,
use metadynamics to identify a minimum free energy path, and then use this
information to perform umbrella sampling (45) simulations to arrive at a ﬁnal
converged free energy proﬁle. Li et al. (117) propose to perform metadynamics
in energy space. Once a rough bias is obtained, a new simulation is started with

Density of states
39
2
2.5
3
end-to-end distance (nm)
-80
-75
-70
-65
-60
-55
-50
F (kJ mol
-1)
Meta
WTM
FHM
FTM
Reference
Figure 11: Free energy as a function of end-to-end distance as obtained by sev-
eral methods after a simulation run of 20 ns for 15-residue polyalanine peptide
(structures shown in inset) in explicit water (solvent not shown for clarity). See
Figure 9 for deﬁnitions of the acronyms. The reference free energy is from an
umbrella sampling simulation with 40 windows in the order parameter range of
interest (1.7-3.1 nm) and 50 ns of simulation time for each window.
a ﬁxed bias. The ﬁnal free energy is obtained from the statistics generated from
the ﬁxed bias simulations and by applying a weighted histogram analysis (86,87)
with the applied bias.
Beyond the issue of convergence, several authors have examined the accuracy,
speed and parameter dependence of metadynamics. For conventional metady-
namics, Laio et al. (119) have quantiﬁed the dependence of the resulting errors on
diﬀerent metadynamics parameters for a model Langevin system without memory

40
Singh et al.
friction or inertia according to:
¯ǫ = C(d)
s
Sδs
DτG
W
β ,
(42)
where C(d) represents the lower bound to the error, S is the system size, D
is the diﬀusivity of the system in the collective variable space, β is the inverse
temperature, W is the height of the added hills, τG is the frequency of hill addition
and δs is the width of the hills. Authors conclude that the easier it is for the
variables s to diﬀuse through the region of interest (equivalent to a large value
of D), better the accuracy will be. The error in general increases as the region
explored, S by metadynamics becomes bigger or topologically more complex,
thus suggesting that the method should be used with caution for reconstructing
the free energy proﬁle on large regions or on free energy surfaces containing
many basins connected by narrow paths. Furthermore, various metadynamics
parameters like hill height, W, hill width, δs and frequency of addition of hills,
τG play vital role in controlling the errors, but unlike other parameters can be
tuned.
The application of metadynamics for simulation of complex systems is limited
by the choice of collective variables. Ideally, one should use the slowest reac-
tion coordinates to ﬁll the hills; in practice such coordinates are seldom known.
In the absence of well-deﬁned strategies for selection of optimal collective vari-
ables, it is common to work simultaneously with multiple collective variables.
The obvious problem with such an approach is one of computational resources:
the time required for a traditional metadynamics simulation follows a power-law
dependence on the number of collective variables. The next section describes sev-
eral improvements to enhance sampling with a sub-optimal choice of collective
variables.

Density of states
41
5.4
Multiple walkers in metadynamics
With the advent of multi-core computers, multiple simulations of the same sys-
tem can be run in parallel. In the approach proposed by Raiteri et al. (120),
multiple interacting simulations, or walkers, are used to explore the same free
energy surface. Each walker contributes to a history-dependent potential that,
in metadynamics, serves as an estimate of the free energy. In particular, the free
energy surface from a multiple walker simulation with Nw walkers is given by:
FG(s, t) = W
τG
Nw
X
i=1
Z t
0
dt′ exp

−|s −si(t′)|2
2|δs|2

,
(43)
where si is the position of the ith walker and other symbols have the same meaning
as in Equation 10.
The idea presented in this method can be connected to the results of Equa-
tion 42. Noting that the error in the free energy is inversely proportional to the
diﬀusivity of the walkers, we see that by increasing that quantity the error in
the free energy surface can be decreased signiﬁcantly. From the eference (120),
representative results for a real system of complex of a tetracationic cyclophane
and a 1,5-dihydroxy-napthalene solvated in acetonitrile are shown in Figure 12.
This system is known to have two energy minima states with a high energy bar-
rier of ≈15 kJ/mol. Raiteri et al. (120) showed that the error in the calculated
free energy surface is independent of the number of walkers. They also showed
that the maximum number of allowed walkers grows exponentially with the di-
mensionality of the free energy that is desired. For more complex systems, larger
numbers of walkers can be used.

42
Singh et al.
A
B
Figure 12: Cyclophane ring and 1,5-dihydroxy-napthalene (shown in (A) and
(B)) solvated in acetonitrile (solvent not shown for clarity).
Total simulation
time (squares) and time simulated by each walker (circles) required for one walker
to escape from the starting well, averaged over 10 independent simulations, as
a function of the number of walkers (NW ). The total time is almost constant,
the time required per walker decreases as 1/NW , indicating that the algorithm
exhibits a linear scaling. [from Reference (120)]
5.5
Parallel tempered metadynamics
Parallel tempering (20, 33, 121) or replica exchange (122) are commonly used
to improve sampling in Monte Carlo and molecular dynamics simulations.
A
method proposed by Bussi et al. (123) combines the ideas of parallel tempering
with metadynamics. Consistent with conventional implementations of parallel
tempering (20,21,33,122), multiple replicas of the system are run simultaneously
at diﬀerent temperatures. While a conventional metadynamics (71) simulation
is carried out on each replica independently, conﬁgurations between neighboring
replicas are exchanged periodically subject to a Metropolis acceptance criterion.

Density of states
43
The acceptance ratio for an exchange involving replicas i and j is given by:
paccept
ij
= min{1, exp[(βj −βi)(U(qj) −U(qi))
+ βi(V i
G(s(qi)) −V i
G(s(qj)))
+ βj(V j
G(s(qj)) −V j
G(s(qi)))]},
(44)
where U is the potential energy of a system and q represents the coordinates
of the system. If an exchange is accepted, the coordinates are exchanged and
momenta are rescaled according to
q′
i = qj;
p′
i =
s
βj
βi
pj.
(45)
q′
j = qi;
p′
j =
s
βj
βi
pi.
(46)
As the simulation proceeds, the biases corresponding to diﬀerent temperatures
tend to compensate the corresponding free energies, and the various CVs start
diﬀusing freely on a barrier-less landscape. This leads to a signiﬁcant decrease in
the autocorrelation time. Bussi et al. (123) have presented results for a double-
well potential model of Langevin dynamics in the high friction limit. Their results
are shown in Figure 13. Two replicas are evolved in a simple one-dimensional free
energy proﬁle with a unit diﬀusion coeﬃcient. The lower-temperature replica is
at T = 1/3, while the higher one is at T = 1. In standard metadynamics (left
plot in Figure 13), the starting basin has to be completely ﬁlled before the other
basin begins to be sampled. On the other hand, when parallel tempering (PT) is
used in conjunction with metadynamics, the low temperature replica can tunnel
to the second well after a short transient time interval. The method has also
been used for predicting structures of complex molecules like proteins (123).

44
Singh et al.
Figure 13: Metadynamics (left) and parallel tempering metadynamics (right) of a
particle in two-well potential simulated using Langevin dynamics. The ordinate
axis provides an energy scale (V (x)), the absicca provide the position of the
particle, x. The thick line represents potential energy V (x) of the system. The
thin lines correspond to the V (x) + P VG(x, t) at time t. The numbers represent
the simulation time t. [from Reference (123)]
5.6
Bias-exchange metadynamics
One common feature of most parallel tempering simulations is that a large num-
ber of replicas are required for correct and optimal sampling. An exception is
provided by the work of Faller et al. (121), who introduced parallel tempering
in a multicanonical ensemble. In this approach, multicanonical weights are de-
rived by a self-consistent iterative process using a Boltzmann inversion of global
energy histograms. Such a procedure gives rise to a much broader overlap of
thermodynamic-property histograms and fewer replicas are necessary. In gen-
eral, for complex and large systems, a large number of temperature replicas is
generally required to sample the slowest CVs. Piana et al. (124) have proposed
a modiﬁcation of metadynamics in which multiple replicas are simulated in dif-

Density of states
45
ferent boxes at the same temperature but with diﬀerent biases. This approach
is particularly helpful for systems where a reasonable set of slow CVs can be
guessed a priori. In this way, only a few replicas are necessary. In addition to
running replicas where a bias is applied, an additional replica is with no bias
is also simulated. The replicas with biasing help enhancing sampling, but the
ﬁnal free energy is calculated on the basis of statistics generated in the replica
without a bias. The acceptance criteria for trial exchanges between replicas i and
j is given by
paccept
ij
= min(1, exp{β[V i
G(qi, t) + V j
G(qj, t) −V i
G(qj, t) −V j
G(qi, t)]}).
(47)
If an exchange move is accepted, the collective variables jump from si(qi) to si(qj)
and from sj(qj) to sj(qi). This method has been shown to be helpful in simu-
lations of the structure of unknown peptides. Note, however, that this method
does not yield the free energy proﬁle of the system to within an arbitrary accu-
racy. The calculated free energy proﬁle depends on the statistics generated from
a given simulation run and there are no criteria to stop a calculation. The idea
of running multiple replicas under diﬀerent potentials has been used also in gen-
eral (125) where biasing may not be guided by metadynamics. Recently, Smiatek
et al. (90) have proposed a method that applies the histogram reweighing tech-
nique described in Section 3.4 in the context of metadynamics simulations. Such
an approach can be also applied to bias-exchange simulations and, in that case,
on could in principle rely on statistics generated from all replicas to determine a
free energy.

46
Singh et al.
5.7
Self-learning metadynamics
Another recent development in the area of metadynamics (126) aims to acceler-
ate the simulations by constructing a bias potential in terms of a patchwork of
one-dimensional, locally valid collective coordinates. For complex system, typi-
cally there are several collective variables that are important for eﬀective sam-
pling in metadynamics. Determination of such collective variables are typically
challenging. In the new approach of self-learning metadynamics, such collective
coordinates adapt to any new features encountered during the simulation.
A
ﬂowchart describing the algorithm has been presented in Figure 14.
In their
work, the authors demonstrate the application of their algorithm to model pro-
teins. An important point to note here is that, as in traditional metadynamics,
this method too does not provide an indication of convergence.
Figure 14: Description of the self learning metadynamics algorithm. [from Ref-
erence (126)]

Density of states
47
6
Concluding remarks
Although with the advent of better computational resources longer and complex
simulations can be performed, the resources are not enough for a meaningful
analysis of noble systems. Density of state based methods provide vital tools for
the study of complex real systems. In this class of methods, the sampling in a tra-
ditional Monte-Carlo or molecular dynamics (metadynamics based approaches)
is enhanced by guiding the system to sample adequately the phase space of in-
terest by the application of biases that adapt on the ﬂy. Such approach has been
applied to numerous real life systems in literature.
Some of the common issues that have still been not addressed suﬃciently are
of convergence and the choice of order parameter. The issue of convergence with
Monte-Carlo based density of state approaches has been addressed more rigor-
ously as compared to those in molecular dynamics based metadynamics methods.
An open problem in the case of metadynamics simulations remain of choice of
collective variables (CVs). In general, in a biasing based sampling algorithm, one
needs to add bias in the slowest order parameter space. The knowledge of such
variables are often unknown, given that traditional molecular simulations can not
access relevant time and length scales of complex systems.
In this review, we have presented a brief summary of most of the relevant
works in the area of density of state (DOS) based free energy calculation and
advanced sampling algorithms. In particular, we divide such methods in two cat-
egories: one those involve Monte-Carlo moves (traditional DOS and EXEDOS
approaches) and others that involve molecular dynamics, more speciﬁcally meta-
dynamics based methods. With the availability of several advanced molecular
dynamics packages, the use of molecular dynamics simulations for study of novel

48
Singh et al.
systems have been quite ubiquitous in recent literature. PLUMED is a software
package (127) that implements metadynamics in several of such well known pack-
ages. The modular nature of this package makes it more attractive for it can be
easily adapted to newly developed metadynamics algorithms.
Literature Cited
1. Landau, D.P. & Binder, K. (2000). A Guide to Monte Carlo Simulations in
Statistical Physics. Cambridge University Press.
2. Van Gunsteren, W.F. & Berendsen, H.J.C. (1990). Computer simulation
of molecular dynamics methodology applications and perspectives in chem-
istry. Angewandte Chemie International Edition in English 29, 992–1023.
3. McQuarrie, D.A. (2000). Statistical Mechanics. University Science Books.
4. Widom, B. (1963). Some Topics in the Theory of Fluids. Journal of Chemical
Physics 39, 2808–2812.
5. Torrie, G.M. & Valleau, J.P. (1977). Non-physical sampling distributions in
Monte-Carlo free-energy estimation - Umbrella sampling. Journal of Com-
putational Physics 23, 187–199.
6. Beveridge, D.L. & Dicapua, F.M. (1989). Free-energy via molecular simu-
lation - applications to chemical and biomolecular systems. Annual Review
of Biophysics and Biophysical Chemistry 18, 431–492.
7. Carter, E.A., Ciccotti, G., Hynes, J.T. & Kapral, R. (1989). Constrained
reaction coordinate dynamics for the simulation of rare events. Chemical
Physics Letters 156, 472–477.
8. Straatsma, T.P. & McCammon, J.A. (1991). Multiconﬁguration thermody-
namic integration. Journal of Chemical Physics 95, 1175–1188.

Density of states
49
9. Berg, B.A. & Neuhaus, T. (1991). Multicanonical algorithms for ﬁrst order
phase transitions. Physics Letters B 267, 249–253.
10. Berg, B.A. & Neuhaus, T. (1991). Multicanonical algorithms for 1st order
phase-transitions. Physics Letters B 267, 249–253.
11. Berg, B.A. & Neuhaus, T. (1992). Multicanonical ensemble - a new approach
to simulate 1st-order phase-transitions. Physical Review Letters 68, 9–12.
12. Lyubartsev, A.P., Martsinovski, A.A., Shevkunov, S.V. & Vorontsov-
Velyaminov, P.N. (1992). New approach to Monte Carlo calculation of the
free energy: Method of expanded ensembles. Journal of Chemical Physics
96, 1776–1783.
13. Kollman, P. (1993). Free-energy calculations - Applications to chemical and
biochemical phenomena. Chemical Reviews 93, 2395–2417.
14. Huber, T., Torda, A.E. & Vangunsteren, W.F. (1994). Local elevation -
A method for improving the searching properties of molecular-dynamics
simulation. Journal of Computer-Aided Molecular Design 8, 695–708.
15. Hansmann, U.H.E. & Okamoto, Y. (1996). Monte Carlo simulations in gen-
eralized ensemble: Multicanonical algorithm versus simulated tempering.
Physical Review E 54, 5863–5865.
16. Escobedo, F.A. & dePablo, J.J. (1996).
Expanded grand canonical and
Gibbs ensemble Monte Carlo simulation of polymers. Journal of Chemical
Physics 105, 4391–4394.
17. Jarzynski, C. (1997). Nonequilibrium equality for free energy diﬀerences.
Physical Review Letters 78, 2690–2693.
18. den Otter, W.K. & Briels, W.J. (1998). The calculation of free-energy diﬀer-
ences by constrained molecular-dynamics simulations. Journal of Chemical

50
Singh et al.
Physics 109, 4139–4146.
19. Sprik, M. & Ciccotti, G. (1998). Free energy from constrained molecular
dynamics. Journal of Chemical Physics 109, 7737–7744.
20. Yan, Q.L. & de Pablo, J.J. (2000). Hyperparallel tempering Monte Carlo
simulation of polymeric systems. Journal of Chemical Physics 113, 1276–
1282.
21. Sugita, Y. & Okamoto, Y. (2000). Replica-exchange multicanonical algo-
rithm and multicanonical replica-exchange method for simulating systems
with rough energy landscape. Chemical Physics Letters 329, 261–270.
22. Hayryan, S., Hu, C.K., Hu, S.Y. & Shang, R.J. (2001). Multicanonical par-
allel simulations of proteins with continuous potentials. Journal of Compu-
tational Chemistry 22, 1287–1296.
23. Darve, E. & Pohorille, A. (2001). Calculating free energies using average
force. Journal of Chemical Physics 115, 9169–9183.
24. Wang, F.G. & Landau, D.P. (2001). Determining the density of states for
classical statistical models: A random walk algorithm to produce a ﬂat
histogram. Physical Review E 64.
25. Wang, F.G. & Landau, D.P. (2001). Eﬃcient, multiple-range random walk
algorithm to calculate the density of states. Physical Review Letters 86,
2050–2053.
26. Calvo, F. (2002).
Sampling along reaction coordinates with the Wang-
Landau method. Molecular Physics 100, 3421–3427.
27. de Pablo, J.J. & Escobedo, F.A. (2002). Molecular simulations in chemical
engineering: Present and future. Aiche Journal 48, 2716–2721.
28. Darve, E., Wilson, M.A. & Pohorille, A. (2002). Calculating free energies

Density of states
51
using a scaled-force molecular dynamics algorithm. Molecular Simulation
28, 113–144.
29. Berg, B.A. (2003).
Multicanonical simulations step by step.
Computer
Physics Communications 153, 397–406.
30. Hove, J. (2004). Density of states determined from Monte Carlo simulations.
Physical Review E 70, 056707.
31. Landau, D.P., Tsai, S.H. & Exler, M. (2004). A new approach to Monte
Carlo simulations in statistical physics: Wang-Landau sampling. American
Journal of Physics 72, 1294–1302.
32. Kofke, D.A. (2005). Free energy methods in molecular simulation. Fluid
Phase Equilibria 228, 41–48.
33. Earl, D.J. & Deem, M.W. (2005). Parallel tempering: Theory, applications,
and new perspectives. Physical Chemistry Chemical Physics 7, 3910–3916.
34. Khan, M.O., Kennedy, G. & Chan, D.Y.C. (2005). A scalable parallel Monte
Carlo method for free energy simulations of molecular systems. Journal of
Computational Chemistry 26, 72–77.
35. Virnau, P. & Muller, M. (2004). Calculation of free energy through succes-
sive umbrella sampling. Journal of Chemical Physics 120, 10925–10930.
36. Ensing, B., De Vivo, M., Liu, Z.W., Moore, P. & Klein, M.L. (2006). Meta-
dynamics as a tool for exploring free energy landscapes of chemical reactions.
Accounts of Chemical Research 39, 73–81.
37. Lelievre, T., Rousset, M. & Stoltz, G. (2007). Computation of free energy
proﬁles with parallel adaptive dynamics. The Journal of chemical physics
126, 134111.
38. Babin, V., Roland, C. & Sagui, C. (2008). Adaptively biased molecular

52
Singh et al.
dynamics for free energy calculations. The Journal of chemical physics 128,
134101.
39. Babin, V., Karpusenka, V., Moradi, M., Roland, C. & Sagui, C. (2009).
Adaptively Biased Molecular Dynamics: An Umbrella Sampling Method
With a Time-Dependent Potential.
International Journal of Quantum
Chemistry 109, 3666–3678.
40. Vanden-Eijnden, E. (2009). Some Recent Techniques for Free Energy Cal-
culations. Journal of Computational Chemistry 30, 1737–1747.
41. Knight, J.L. & Brooks, Charles L., I. (2009). lambda-Dynamics Free Energy
Simulation Methods. Journal of Computational Chemistry 30, 1692–1700.
42. Dickson, B.M., Legoll, F., Lelievre, T., Stoltz, G. & Fleurat-Lessard, P.
(2010).
Free energy calculations: An eﬃcient adaptive biasing potential
method. Journal of Physical Chemistry B 114, 5823–5830.
43. Christ, C.D., Mark, A.E. & van Gunsteren, W.F. (2010). Basic Ingredi-
ents of Free Energy Calculations: A Review.
Journal of Computational
Chemistry 31, 1569–1582.
44. Atchade, Y.F. & Liu, J.S. (2010). The wang-landau algorithm in general
state spaces: applications and convergence analysis. Statistica Sinica 20,
209–233.
45. Kastner, J. (2011). Umbrella sampling. Wiley Interdisciplinary Reviews:
Computational Molecular Science , 1–11.
46. Pratt, L.R. (1986). A statistical-method for identifying transition-states in
high dimensional problems. Journal of Chemical Physics 85, 5045–5048.
47. Yan, Q.L., Faller, R. & de Pablo, J.J. (2002). Density-of-states Monte Carlo
method for simulation of ﬂuids. Journal of Chemical Physics 116, 8745–

Density of states
53
8749.
48. Faller, R. & de Pablo, J.J. (2003). Density of states of a binary Lennard-
Jones glass. Journal of Chemical Physics 119, 4405–4408.
49. Kim, E.B., Guzm´an, O., Grollau, S., Abbott, N.L. & de Pablo, J.J. (2004).
Interactions between spherical colloids mediated by a liquid crystal:
A
molecular simulation and mesoscale study.
Journal of Chemical Physics
121, 1949–1961.
50. Mastny, E.A. & de Pablo, J.J. (2005). Direct calculation of solid-liquid equi-
libria from density-of-states Monte Carlo simulations. Journal of Chemical
Physics 122, 124109.
51. Jayasri, D., Sastry, V.S.S. & Murthy, K.P.N. (2005). Wang-Landau Monte
Carlo simulation of isotropic-nematic transition in liquid crystals. Physical
Review E 72, 036702.
52. Chopra, M., M¨uller, M. & de Pablo, J.J. (2006). Order-parameter-based
Monte Carlo simulation of crystallization.
Journal of Chemical Physics
124, 134102.
53. Poulain, P., Calvo, F., Antoine, R., Broyer, M. & Dugourd, P. (2006). Per-
formances of Wang-Landau algorithms for continuous systems.
Physical
Review E 73, 056704.
54. Zhou, C.G., Schulthess, T.C., Torbrugge, S. & Landau, D.P. (2006). Wang-
Landau algorithm for continuous models and joint density of states. Physical
Review Letters 96, 120201.
55. Seaton, D.T., Mitchell, S.J. & Landau, D.P. (2008). Developments in Wang-
Landau Simulations of a simple continuous homopolymer. Brazilian Journal
of Physics 38, 48–53.

54
Singh et al.
56. Ghosh, J. & Faller, R. (2008). Comparing the density of states of binary
Lennard-Jones glasses in bulk and ﬁlm. The Journal of chemical physics
128, 124509.
57. Jain, T.S. & de Pablo, J.J. (2002). A biased Monte Carlo technique for
calculation of the density of states of polymer ﬁlms. The Journal of Chemical
Physics 116, 7238–7243.
58. Gront, D., Kolinski, A. & Skolnick, J. (2000). Comparison of three Monte
Carlo conformational search strategies for a proteinlike homopolymer model:
Folding thermodynamics and identiﬁcation of low-energy structures. Jour-
nal of Chemical Physics 113, 5065–5071.
59. Fenwick, M.K. & Escobedo, F.A. (2003). Expanded ensemble and replica ex-
change methods for simulation of protein-like systems. Journal of Chemical
Physics 119, 11998–12010.
60. Rathore, N., Knotts, T.A. & de Pablo, J.J. (2003). Conﬁgurational tem-
perature density of states simulations of proteins. Biophysical Journal 85,
3963–3968.
61. Rathore, N., Knotts, T.A. & de Pablo, J.J. (2003). Density of states simu-
lations of proteins. Journal of Chemical Physics 118, 4285–4290.
62. Nagasima, T., Kinjo, A.R., Mitsui, T. & Nishikawa, K. (2007).
Wang-
Landau molecular dynamics technique to search for low-energy conforma-
tional space of proteins. Physical Review E 75, 066706.
63. Swetnam, A.D. & Allen, M.P. (2011). Improving the Wang-Landau Algo-
rithm for Polymers and Proteins. Journal of Computational Chemistry 32,
816–821.
64. Plimpton, S. (1995).
Fast parallel algorithms for short-range molecular-

Density of states
55
dynamics. Journal of Computational Physics 117, 1–19.
65. Phillips, J.C., Braun, R., Wang, W., Gumbart, J., Tajkhorshid, E., Villa, E.,
Chipot, C., Skeel, R.D., Kale, L. & Schulten, K. (2005). Scalable molecular
dynamics with NAMD. Journal of Computational Chemistry 26, 1781–1802.
66. Case, D.A., Cheatham, T.E., Darden, T., Gohlke, H., Luo, R., Merz, K.M.,
Onufriev, A., Simmerling, C., Wang, B. & Woods, R.J. (2005). The Amber
biomolecular simulation programs. Journal of Computational Chemistry 26,
1668–1688.
67. Hess, B., Kutzner, C., van der Spoel, D. & Lindahl, E. (2008). GROMACS
4: Algorithms for Highly Eﬃcient, Load-Balanced, and Scalable Molecular
Simulation. Journal of Chemical Theory and Computation 4, 435–447.
68. Brooks, B.R., Brooks, C. L., I., Mackerell, A. D., J., Nilsson, L., Petrella,
R.J., Roux, B., Won, Y., Archontis, G., Bartels, C., Boresch, S., Caﬂisch, A.,
Caves, L., Cui, Q., Dinner, A.R., Feig, M., Fischer, S., Gao, J., Hodoscek,
M., Im, W., Kuczera, K., Lazaridis, T., Ma, J., Ovchinnikov, V., Paci,
E., Pastor, R.W., Post, C.B., Pu, J.Z., Schaefer, M., Tidor, B., Venable,
R.M., Woodcock, H.L., Wu, X., Yang, W., York, D.M. & Karplus, M.
(2009).
CHARMM: The Biomolecular Simulation Program.
Journal of
Computational Chemistry 30, 1545–1614.
69. Harvey, M.J., Giupponi, G. & Fabritiis, G.D. (2009). ACEMD: Accelerating
Biomolecular Dynamics in the Microsecond Time Scale. Journal of Chemical
Theory and Computation 5, 1632–1639.
70. Marsili, S., Barducci, A., Chelli, R., Procacci, P. & Schettino, V. (2006).
Self-healing Umbrella Sampling: A Non-equilibrium Approach for Quanti-
tative Free Energy Calculations. The Journal of Physical Chemistry B 110,

56
Singh et al.
14011–14013.
71. Laio, A. & Parrinello, M. (2002). Escaping free-energy minima. Proceedings
of the National Academy of Sciences of the United States of America 99,
12562–12566.
72. Micheletti, C., Laio, A. & Parrinello, M. (2004). Reconstructing the density
of states by history-dependent metadynamics. Physical Review Letters 92,
170601.
73. Laio, A. & Gervasio, F.L. (2008). Metadynamics: a method to simulate rare
events and reconstruct the free energy in biophysics, chemistry and material
science. Reports on Progress in Physics 71, 126601.
74. Min, D.H., Liu, Y.S., Carbone, I. & Yang, W. (2007). On the convergence
improvement in the metadynamics simulations: A Wang-Landau recursion
approach. Journal of Chemical Physics 126, 194104.
75. Lee, H.K., Okabe, Y. & Landau, D.P. (2006). Convergence and reﬁnement
of the Wang-Landau algorithm. Computer Physics Communications 175,
36–40.
76. Morozov, A.N. & Lin, S.H. (2007). Accuracy and convergence of the Wang-
Landau sampling algorithm. Physical Review E 76, 026701.
77. Metropolis, N., Rosenbluth, A.W., Rosenbluth, M.N., Teller, A.H. & Teller,
E. (1953). Equation of State Calculations by Fast Computing Machines.
Journal of chemical physics 21, 1087–1092.
78. Zhou, C.G. & Bhatt, R.N. (2005). Understanding and improving the Wang-
Landau algorithm. Physical Review E 72, 025701.
79. Earl, D.J. & Deem, M.W. (2005).
Markov chains of inﬁnite order and
asymptotic satisfaction of balance: Application to the adaptive integration

Density of states
57
method. Journal of Physical Chemistry B 109, 6701–6704.
80. Belardinelli, R.E. & Pereyra, V.D. (2007). Fast algorithm to calculate den-
sity of states. Physical Review E 75, 046701.
81. Yan, Q. & de Pablo, J.J. (2003). Fast Calculation of the Density of States
of a Fluid by Monte Carlo Simulations. Physical Review Letters 90, 035701.
82. Belardinelli, R.E., Manzi, S. & Pereyra, V.D. (2008). Analysis of the con-
vergence of the 1/t and Wang-Landau algorithms in the calculation of mul-
tidimensional integrals. Physical Review E 78.
83. Zhou, C. & Su, J. (2008). Optimal modiﬁcation factor and convergence of
the Wang-Landau algorithm. Physical Review E 78, 046705.
84. Ferrenberg, A.M. & Swendsen, R.H. (1988). New monte-carlo technique for
studying phase-transitions. Physical Review Letters 61, 2635–2638.
85. Ferrenberg, A.M. & Swendsen, R.H. (1989). Optimized monte-carlo data-
analysis. Physical Review Letters 63, 1195–1198.
86. Kumar, S., Bouzida, D., Swendsen, R.H., Kollman, P.A. & Rosenberg, J.M.
(1992). The weighted histogram analysis method for free-energy calculations
on biomolecules .1. The method. Journal of Computational Chemistry 13,
1011–1021.
87. Kumar, S., Rosenberg, J.M., Bouzida, D., Swendsen, R.H. & Kollman, P.A.
(1995). Multidimensional free-energy calculations using the weighted his-
togram analysis method. Journal of Computational Chemistry 16, 1339–
1350.
88. Shirts, M.R. & Chodera, J.D. (2008). Statistically optimal analysis of sam-
ples from multiple equilibrium states. Journal of Chemical Physics 129,
124105.

58
Singh et al.
89. Bonomi, M., Barducci, A. & Parrinello, M. (2009).
Reconstructing the
Equilibrium Boltzmann Distribution from Well-Tempered Metadynamics.
Journal of Computational Chemistry 30, 1615–1621.
90. Smiatek, J. & Heuer, A. (2011). Calculation of Free Energy Landscapes: A
Histogram Reweighted Metadynamics Approach. Journal of Computational
Chemistry 32, 2084–2096.
91. de Pablo, J.J., Laso, M. & Suter, U.W. (1992). Simulation of polyethylene
above and below the melting point. The Journal of Chemical Physics 96,
2395–2403.
92. Siepmann, J.I. & Frenkel, D. (1992). Conﬁgurational bias Monte-Carlo - a
new sampling scheme for ﬂexible chains. Molecular Physics 75, 59–70.
93. Dijkstra, M., Frenkel, D. & Hansen, J.P. (1994). Phase separation in binary
hard-core mixtures. The Journal of Chemical Physics 101, 3179–3189.
94. Butler, B.D., Ayton, O., Jepps, O.G. & Evans, D.J. (1998). Conﬁgurational
temperature: Veriﬁcation of Monte Carlo simulations. Journal of Chemical
Physics 109, 6519–6522.
95. Yan, Q.L., Jain, T.S. & de Pablo, J.J. (2004). Density-of-states Monte Carlo
simulation of a binary glass. Physical Review Letters 92, 235701.
96. Dayal, P., Trebst, S., Wessel, S., Wurtz, D., Troyer, M., Sabhapandit, S. &
Coppersmith, S.N. (2004). Performance limitations of ﬂat-histogram meth-
ods. Physical Review Letters 92.
97. Shell, M.S., Debenedetti, P.G. & Panagiotopoulos, A.Z. (2004).
Flat-
histogram dynamics and optimization in density of states simulations of
ﬂuids. Journal of Physical Chemistry B 108, 19748–19755.
98. Troster, A. & Dellago, C. (2005). Wang-Landau sampling with self-adaptive

Density of states
59
range. Physical Review E 71, 066705.
99. Cunha-Netto, A.G., Caparica, A.A., Tsai, S.H., Dickman, R. & Landau,
D.P. (2008).
Improving Wang-Landau sampling with adaptive windows.
Physical Review E 78, 055701.
100. Zhan, L. (2008). A parallel implementation of the Wang-Landau algorithm.
Computer Physics Communications 179, 339–344.
101. Janosi, L. & Doxastakis, M. (2009). Accelerating ﬂat-histogram methods
for potential of mean force calculations. The Journal of chemical physics
131, 054105.
102. Trebst, S., Huse, D.A. & Troyer, M. (2004). Optimizing the ensemble for
equilibration in broad-histogram Monte Carlo simulations. Physical Review
E 70, 046701.
103. Escobedo, F.A. & Martinez-Veracoechea, F.J. (2007). Optimized expanded
ensembles for simulations involving molecular insertions and deletions. I.
Closed systems. Journal of Chemical Physics 127, 174103.
104. Martinez-Veracoechea, F.J. & Escobedo, F.A. (2008). Variance minimiza-
tion of free energy estimates from optimized expanded ensembles. Journal
of Physical Chemistry B 112, 8120–8128.
105. Frenkel, D. (2004). Speed-up of Monte Carlo simulations by sampling of re-
jected states. Proceedings of the National Academy of Sciences 101, 17571–
17575.
106. Chopra, M. & de Pablo, J.J. (2006). Improved density of states Monte Carlo
method based on recycling of rejected states. Journal of Chemical Physics
124.
107. Shell, M.S., Debenedetti, P.G. & Panagiotopoulos, A.Z. (2003).
An im-

60
Singh et al.
proved Monte Carlo method for direct calculation of the density of states.
Journal of Chemical Physics 119, 9406–9411.
108. Wu, Y., Schmitt, J.D. & Car, R. (2004). Mapping potential energy surfaces.
Journal of Chemical Physics 121, 1193–1200.
109. Gervasio, F.L., Laio, A. & Parrinello, M. (2005). Flexible docking in solution
using metadynamics. Journal of the American Chemical Society 127, 2600–
2607.
110. Ensing, B. & Klein, M.L. (2005). Perspective on the reactions between F-
and CH3CH2F: The free energy landscape of the E2 and S(N)2 reaction
channels. Proceedings of the National Academy of Sciences of the United
States of America 102, 6755–6759.
111. Babin, V., Roland, C., Darden, T.A. & Sagui, C. (2006). The free energy
landscape of small peptides as obtained from metadynamics with umbrella
sampling corrections. Journal of Chemical Physics 125.
112. Singh, S., Chiu, C.c. & de Pablo, J. (2011). Flux Tempered Metadynamics.
Journal of Statistical Physics 144, 1–14.
113. Bussi, G., Laio, A. & Parrinello, M. (2006). Equilibrium Free Energies from
Nonequilibrium Metadynamics. Physical Review Letters 96, 090601.
114. Crespo, Y., Marinelli, F., Pietrucci, F. & Laio, A. (2010). Metadynamics
convergence law in a multidimensional system. Physical Review E 81.
115. Barducci, A., Bussi, G. & Parrinello, M. (2008). Well-tempered metady-
namics: a smoothly converging and tunable free-energy method. Physical
Review Letters 100, 020603.
116. Martyna, G.J., Klein, M.L. & Tuckerman, M. (1992). Nose-hoover chains
- The canonical ensemble via continuous dynamics. Journal of Chemical

Density of states
61
Physics 97, 2635–2643.
117. Li, H., Min, D., Liu, Y. & Yang, W. (2007). Essential energy space ran-
dom walk via energy space metadynamics method to accelerate molecular
dynamics simulations. The Journal of chemical physics 127, 094101.
118. Zhang, Y. & Voth, G.A. (2011). Combined Metadynamics and Umbrella
Sampling Method for the Calculation of Ion Permeation Free Energy Pro-
ﬁles. Journal of Chemical Theory and Computation 7, 2277–2283.
119. Laio, A., Rodriguez-Fortea, A., Gervasio, F.L., Ceccarelli, M. & Parrinello,
M. (2005). Assessing the accuracy of metadynamics. Journal of Physical
Chemistry B 109, 6714–6721.
120. Raiteri, P., Laio, A., Gervasio, F.L., Micheletti, C. & Parrinello, M. (2006).
Eﬃcient reconstruction of complex free energy landscapes by multiple walk-
ers metadynamics. Journal of Physical Chemistry B 110, 3533–3539.
121. Faller, R., Yan, Q.L. & de Pablo, J.J. (2002). Multicanonical parallel tem-
pering. Journal of Chemical Physics 116, 5419–5423.
122. Rosta, E. & Hummer, G. (2009). Error and eﬃciency of replica exchange
molecular dynamics simulations.
The Journal of chemical physics 131,
165102.
123. Bussi, G., Gervasio, F.L., Laio, A. & Parrinello, M. (2006). Free-energy
landscape for beta hairpin folding from combined parallel tempering and
metadynamics.
Journal of the American Chemical Society 128, 13435–
13441.
124. Piana, S. & Laio, A. (2007). A bias-exchange approach to protein folding.
Journal of Physical Chemistry B 111, 4553–4559.
125. Kannan, S. & Zacharias, M. (2010). Application of biasing-potential replica-

62
Singh et al.
exchange simulations for loop modeling and reﬁnement of proteins in explicit
solvent. Proteins-Structure Function and Bioinformatics 78, 2809–2819.
126. Tribello, G.A., Ceriotti, M. & Parrinello, M. (2010). A self-learning algo-
rithm for biased molecular dynamics. Proceedings of the National Academy
of Sciences of the United States of America 107, 17509–17514.
127. Bonomi, M., Branduardi, D., Bussi, G., Camilloni, C., Provasi, D., Raiteri,
P., Donadio, D., Marinelli, F., Pietrucci, F., Broglia, R.A. & Parrinello,
M. (2009). PLUMED: A portable plugin for free-energy calculations with
molecular dynamics. Computer Physics Communications 180, 1961–1972.

