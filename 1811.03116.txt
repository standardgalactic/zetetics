A post-quantum theory of classical gravity?
Jonathan Oppenheim1
1Department of Physics and Astronomy, University College London,
Gower Street, London WC1E 6BT, United Kingdom
We present a consistent theory of classical gravity coupled to quantum ﬁeld theory. The dynamics
is linear in the density matrix, completely positive and trace-preserving, and reduces to Einstein’s
theory of general relativity in the classical limit.
As a result, the dynamics doesn’t suﬀer from
the pathologies of the semi-classical theory based on expectation values.
The assumption that
general relativity is classical necessarily modiﬁes the dynamical laws of quantum mechanics – the
theory must be fundamentally stochastic in both the metric degrees of freedom and in the quantum
matter ﬁelds. This allows it to evade several no-go theorems purporting to forbid classical-quantum
interactions. The measurement postulate of quantum mechanics is not needed since the interaction
of the quantum degrees of freedom with classical space-time necessarily causes decoherence. We
ﬁrst derive the most general form of classical-quantum dynamics and consider realisations which
have as its limit deterministic classical Hamiltonian evolution. The formalism is then applied to
quantum ﬁeld theory interacting with the classical space-time metric. One can view the theory as
fundamental or as an eﬀective theory useful for computing the back-reaction of quantum ﬁelds on
geometry.
arXiv:1811.03116v2  [hep-th]  25 Jun 2021

2
I.
MUST WE QUANTISE GRAVITY?
The two pillars of modern theoretical physics are general relativity, which holds that gravity is the bending of
space-time by matter, and quantum ﬁeld theory, which describes the matter which live in that space-time. Yet they
are fundamentally inconsistent. Einstein’s equations for gravity
Gµν
?= 8πG
c4 Tµν
(1)
has a left hand side which encodes the space-time degrees of freedom via the Einstein tensor and is treated classically,
while on the right hand side1 sits the energy-momentum tensor encoding the matter degrees of freedom which must
be an operator according to quantum theory. The widespread belief is that this should be remedied by ﬁnding a
quantum theory of gravity so that the left hand side of Equation (1) is also an operator. Yet, with string theory
turning 50[1], and loop quantum gravity in its mid 30’s[2, 3], a theory of quantum gravity feels as distant as ever.
Another possibility is that gravity should still be treated classically, but that Einstein’s equation should be modiﬁed.
There is some sense to this. Space-time, though dynamical, can be understood as describing the background on which
quantum ﬁelds of matter interact. Gravity, through the equivalence principle, is unique in this regard – no other ﬁelds
can be described as a universal geometry in which quantum ﬁelds live. Having this classical background structure
is certainly convenient for our current understanding of quantum mechanics.
Quantum ﬁeld theory allows us to
predict the result of future measurements on a space-like surface, based on past initial data. The identiﬁcation of a
Cauchy surface on which to give this initial data, not to mention the identiﬁcation of a one parameter family of future
hypersurfaces, is natural when the background structure is classical, while it is unclear whether it is possible to quantise
this causal structure in a way which is independent of these background choices. While this diﬃculty may be merely
technical, background independent approaches such as loop quantum gravity, String Field Theory[4], and others[5, 6]
have yet to demonstrate that this is possible. There are also some experimental hints pointing towards the absence of
the graviton[7, 8] which might give this view some additional weight. And unlike the case for electromagnetism, gravity
is not believed to suﬀer an ultraviolet catastrophe of the kind that required electromagnetism to be quantised[9, 10].
Nonetheless, there is no strong case that gravity is exceptional, and the overwhelming consensus has been that we
must quantise it along with all the other ﬁelds. In part, this is due to a number of no-go theorems and arguments over
the years[11–21] purporting to require the quantisation of the gravitational ﬁeld. A recent no-go theorem[21] holds
not only for coupling classical mechanics with quantum theory, but also with modiﬁcations to quantum-mechanics,
so called post-quantum theories which alter the quantum state space or dynamics2. But given the diﬃculties faced
in constructing such a theory, it seems important to revisit this consensus. Whether we should quantise gravity is
not a question we’ll address here, but the necessity of doing so is one that has been challenged. Indeed, not only
is it logically possible to have quantum ﬁelds interacting with classical space-time, we will construct such a theory.
The no-go theorems on the need to quantise gravity implicitly or explicitly assume the coupling of quantum ﬁelds to
space-time is not stochastic. This loophole can be exploited to construct a theory of classical space-time which can
be acted upon by quantum ﬁelds.
Although the construction of a consistent fundamental theory are the principle motivations of the present work,
two other motivations remain even if one believes that the fundamental theory of gravity is quantum. One, is that
a natural ﬁrst step to quantising gravity would be to consider a probabilistic theory, since many of the conceptual
diﬃculties faced in quantising gravity are also found in classical probabilistic theories. The diﬃculty encountered with
understanding the role of diﬀeomorphism invariance when one doesn’t have a deﬁnite 4-geometry, and the technical
diﬃculty encountered with calculating the constraint algebra, has a much more tractable form in the theory considered
here. This theory serves as a sandbox in which to understand issues around the quantisation of the gravitational ﬁeld.
After all, a probability density ρ and the Liouville equation have a lot in common with the wave-function ψ and the
Heisenberg equations of motion.
Another important motivation of this work, lies in understanding the back-reaction that quantum ﬁelds have on
space time. In many cases, such as in the evaporation of large black holes, or in inﬂationary cosmology, we are
interested in the limit in which space-time can be treated classically, while the matter itself, such as the black hole
radiation, or vacuum ﬂuctuations, must be treated quantumly. We would like to compute the back-reaction that
quantum matter produces on space-time, yet we have no consistent theory which enables us to do this. The current
approach to describe gravity classically, is to take the expectation value of the right hand side of Equation (1), leading
to the semi-classical Einstein’s equations[23, 24]
Gµν
?= 8πG
c4 ⟨Tµν⟩
(2)
1 In the proceeding sections we will use units where ℏ= c = 16πG = 1
2 For a discussion of post-quantum theories in the context of gravity, see for example [22] which considers modiﬁcations of the state space.

3
Although this equation is often used to understand the back-reaction on space-time, it is only valid when ﬂuctuations
are small, while to understand quantum eﬀects, we are precisely interested in the case where quantum ﬂuctuations are
signiﬁcant. Taking the semi-classical Einstein’s equation seriously leads to pathological behaviour. If a heavy object
is in a statistical mixture of being in two locations (as depicted in Figure 1), a test mass will fall towards the point
between the two locations and the object itself will be attracted to the place where it might have been. This has been
ruled out experimentally, in one of the most sublime examples of trolling ever published in PRL[25].
FIG. 1. On the left hand side, the gravitational ﬁeld become correlated with the quantum system, a planet in a statistical
mixture of being in two possible locations (“L” and “R”), and a test particle falls towards the planet. If one treats the semi-
classical Einstein’s equations as fundamental, the test particle falls down the middle which is indeed the average trajectory of
its path in the left hand panel. The planets are also attracted towards the place they might have been. The systems in the
linear theory considered here exhibit the behaviour depicted in the left hand panel.
The failure of the semi-classical Einstein’s equation, has generally been viewed as a reason we must quantise
gravity[26, 27]. However, one sees the same apparent paradox in a fully quantum theory of two systems. Take for
example the interaction Hamiltonian HMG = HM ⊗HG, and the limit where the M and G system are close to a
product state with density matrix ρMG ≈σM ⊗σG. Then Heisenberg’s equation of motion for the M system, after
tracing out the G system give
∂σM
∂t
≈−i[σM, HM] ⊗⟨HG⟩
(3)
for as long as the two systems remains approximately uncorrelated. In this limit, the state of the system M also
appears to be coupled to an expectation value, even though we know that this is not what happens. By tracing out the
G system, we have lost view of the fact that the two systems will get correlated. Once the systems become correlated,
the reduced dynamics is no longer even linear in the reduced state σM since trG HGρGM ̸= ⟨HG⟩σM. While this in no
way suggests the semi-classical Einstein’s equation are correct even on average, it’s pathologies have led to a widely
held objection to theories which treat gravity classically, while it is clear from the above example that the pathologies
of the semi-classical Einstein’s equations have nothing to do with treating one system classically, and everything to
do with taking expectation values. The same apparent pathologies occur if the system G is classical. The theory
presented here doesn’t suﬀer from these issues – the equations of motion are linear in the density matrix, just like
quantum mechanics and the classical Liouville equation.
A second widely held belief is that a classical theory of gravity is incompatible with superpositions and the uncer-
tainty relation3 as depicted in Figure 2. If the gravitational ﬁeld produced by a particle is classical, the gravitational
ﬁeld it produces can in principle be measured to suﬃciently high precision to determine the particle’s position. This
would either prevent particles from being in superposition or would violate the uncertainty principle if the interference
experiment of Figure 2 is carried out. However, if the coupling between the quantum and classical degrees of freedom
is stochastic, then measuring the classical degrees of freedom will not necessarily determine the particle’s quantum
state to arbitrary precision. This could be because the information one gains is noisy, or because the gravitational
ﬁeld reacts at random times4).
The fact that coupling classical gravity to quantum theory necessarily requires stochasticity is a primary motiva-
tion to this work. A stochastic theory of gravity5 is particularly compelling in light of the black hole information
problem[37–39], and its sharper version, the AMPS ”paradox” [40, 41]. Since deterministic theories appear to re-
quire a breakdown of gravity at low energies6, serious consideration to non-deterministic theories should be given[44].
3 This argument is usually attributed to Feynman[12, 28] and Aharonov[29] in relation to the gravitational ﬁeld (see also [14, 30–32]).
The argument in [14] additionally contain a claim concerning superluminal signalling which is addressed in [33].
4 A similar refutation was independently reached by David Poulin (private communication) and is implicit in [34]
5 Although there is some similarity in language, the theory introduced here is not related to the theory which goes by the name of
Stochastic Gravity[36]. There, noise is added on top of the semi-classical Einstein’s equations. However it is unclear how adding noise
makes Equation (2) any less problematic from the point of view of the issues reviewed in Figure 1.
6 For a strong case for non-unitarity, see for example[42, 43].

4
FIG. 2. Consider a variation of the gedanken experiment proposed by Feynman[12, 28] and Aharonov[29] in which a massive
particle travels through two slits as a plane wave. Quantum theory predicts an interference pattern on the screen behind the
slits which enables a determination of the particle’s momentum. The particle may emit gravity waves and have some amplitude
of emitting photons via the Bremsstrahlung process as it goes through the slits. At late times, the state the electromagnetic
ﬁeld far from the slits will be diﬀerent depending on which slit the particle goes through, but these two states, though slightly
diﬀerent, need not be orthogonal. The quantum nature of the electromagnetic ﬁeld prevents an experimenter from distinguishing
these two non-orthogonal states and while the electromagnetic interaction might lead to some decoherence of the particle, if the
interaction is small enough the interference pattern remains. On the other hand, if the gravitational ﬁeld is classical and the
interaction deterministic, then one could imagine measuring the gravitational ﬁeld close to the particle without disturbing the
ﬁeld to unambiguously determine which path the particle went through. One could therefore never get interference fringes (or
the uncertainty principle would be violated). Two classical states cannot be diﬀerent but non-orthogonal. Actually measuring
the gravitational ﬁeld is not required since classical systems are undisturbed – even if we can’t actually measure the ﬁeld to the
required accuracy[35], it is impossible to write down a pure quantum state of the particle which is correlated with a classical
gravitational ﬁeld determined by the particle’s position. Since the theory presented here modiﬁes quantum theory so that the
interaction is stochastic, the gravitational ﬁeld need not become unambiguously correlated with the particle’s path and the
interference pattern is restored. Probability densities over classical states can be diﬀerent and non-orthogonal.
However theories with information destruction face imposing obstacles. Banks, Peskin and Susskind argued that they
lead to violations of locality or energy conservation[45, 46], and Coleman argued that they merely result in false
decoherence corresponding to unknown coupling constants[47]. There are a few attempts to work around this. Unruh
and Wald proposed that if the information destruction was at suﬃciently high energy, then violations in momentum
and energy conservation would also be at high energy, and hence, not observable in the lab[48]. Models which are
local, yet violate cluster-decomposition were proposed in [49], and ones which have only mild violations of energy
conservation at the expense of some non-locality were proposed in [50]. However, none of these attempts have been
theories of gravity, and once the back-reaction to space-time is considered, and the constraints of general relativity
taken into account, the situation is diﬀerent enough to warrant reconsidering the issue. We shall return to this point
in the Discussion section, where we will argue that the objection due to Coleman[47] does not apply because the
classical nature of the gravitational ﬁeld means that the theory cannot necessarily be puriﬁed onto a larger Hilbert
space.
An early attempt to couple classical gravity to quantum mechanics was made in [51] using the Aleksandrov-
Gerasimenko bracket[52, 53]
∂σ
∂t
?= −i[H, σ] + 1
2

{H, σ} −{σ, H}

(4)
However, the dynamics it generates leads to negative probabilities[51, 54]. Unless we are prepared to modify the
Born rule, or equivalently, our interpretation of the density matrix, any dynamics must be trace-preserving (TP) to
conserve probability, and be completely positive (CP), for probabilities to remain positive. So, although the dynamics
of Equation (4) makes a frequent appearance in attempts to couple quantum and classical degrees of freedom [55–57]
(c.f. [58]), and while it may give insight in some regimes, it cannot serve as a fundamental theory. Other attempts,
such as using the Schro¨edinger-Newton equation[59, 60] (c.f. [61, 62]), suﬀer from the problem that the equations are
non-linear in the density matrix, and thus will lead to superluminal signalling[63] and a breakdown of the statistical
mechanical interpretation of the density matrix7.
And yet experimentalists working in the ﬁeld of quantum control routinely couple quantum and classical degrees
of freedom together, usually by invoking the mysterious measurement postulate of quantum theory. This presents
7 If someone prepares a system in one of two states σ0 or σ1 depending on the value of a coin toss (|0⟩⟨0| with probability p, |1⟩⟨1| with
probability 1 −p), then the evolution L of the system must satisfy p|0⟩⟨0| ⊗Lσ0 + (1 −p)|1⟩⟨1| ⊗Lσ1 = L(pσ0 + (1 −p)σ1) otherwise
the system evolves diﬀerently depending on whether we are aware of the value of the coin toss. A violation of linearity further implies
that when the system is in state σ0 it evolves diﬀerently depending on what state the system would have been prepared in, had the coin
been |1⟩⟨1| instead of |0⟩⟨0|. This motivates our restriction to linear theories.

5
another path to treat gravity classically, where one imagines the system of interest is fundamentally quantum, but
that observables are restricted or a measurement is performed on them [54, 64–66]. However, for gravity, this would
require ﬁrst quantising the theory, which might well be an impossible task. A complementary approach, is to apply a
measurement to the quantum system instead, and then couple the output to the classical degrees of freedom[67–70].
Both these approaches, at least initially, invoked the measurement postulate of quantum mechanics, or an ad-hoc ﬁeld
which produces a stochastic collapse of the wave function [71–75] which then source the gravitational ﬁeld.
And here lies the essence of the problem – if nature is fundamentally quantum, our notion of classicality hinges
on the measurement postulate. Thus the emphasis in this work, is to invert the logic: assume that since space-time
describes causal structure and relationships between the matter degrees of freedom, it is a-priori and fundamentally
classical. Then examine the implications of this. One, will be that the quantum degrees of freedom inherit classicality
from space-time. By treating the space-time metric as a classical degree of freedom, we obtain for free, not only a
theory of quantum matter and gravity, but also a theory which produces the gravitationally induced collapse of the
wave-function, conjectured by Karolyhazyy, Diosi and Penrose[76–78]8. Collapse arises as a simple consequence of
treating space-time classically. Such an approach can be found in [79] where a variation of Equation (2) is studied,
but it is argued that their interaction of a quantum system with a classical measuring device necessarily leads to
decoherence and consistency of the measurement postulate. Likewise Diosi and Tilloy[68, 69] point out that although
they introduce a spontaneous collapse model to source the Newtonian potential, this can be thought of as formal,
and it is the consistency of hybrid dynamics which requires decoherence of the quantum matter. Poulin [50], also
notes that the classical coupling leads to decoherence of the quantum system. The theory considered here however,
cannot be reduced to a linear spontaneous collapse model, because the dynamics is not Markovian or even linear in
the density matrix when the gravitational degrees of freedom are traced out (although it is linear and Markovian when
we include the metric degrees of freedom). There are also realisations of the theory considered here, where stochastic
jumps in phase-space can be ﬁnite and correlate to Lindblad operators, so that one has objective collapse of the wave
function, not just decoherence.
We proceed by assuming that gravity is classical, and then explore the consequences. The ﬁrst natural question
is: what is the most general linear dynamics which maps the set of classical-quantum states to itself. More precisely,
what is the most general linear dynamics which is completely positive, trace-preserving and preserves the division of
degrees of freedom into classical and quantum. Two generators of such dynamics has previously been proposed. In
[80] a master equation with diagonal coupling to Lindblad operators Lα was considered, of the form
∂ϱ(¯z)
∂t
= −i[H(¯z; t), ϱ(¯z)] +
X
α,¯z′
W α(¯z|¯z′)Lαϱ(¯z′)L†
α −1
2W α(¯z){L†
βLα, ϱ(¯z)}+
(5)
where ¯z are the classical degree of freedom, {·}+ is the anti-commutator, and ϱ(¯z) is a subnormalized density matrix
and is a functional of the classical degrees of freedom.When W α(¯z|¯z′) = W α(¯z)δ(¯z −¯z′), this reduces to the GKSL
or Lindblad equation[81, 82]. This has been shown to be the most general master equation in the case of discrete
classical variables and bounded Lindblad operators by embedding the classical system in Hilbert space[83]. However,
for continuous classical degrees of freedom, one generally requires non-diagonal couplings. Indeed, Diosi[34] considered
this case, and in particular an interaction Hamiltonian H(¯z) =
R
dx¯z(x)L(x) and the master equation
∂ϱ(¯z)
∂t
={H0, ψ} −i[H(¯z; t), ϱ(¯z)] + 1
2

{H(¯z), σ} −{σ, H(¯z)}

+
Z
dxdyD2(x, y){¯z(y), {¯z(x), ϱ(¯z)}}
+ W(x, y) [L(x), [ϱ(¯z), L(y)]]
(6)
ram which adds diﬀusion and a Lindbladian to the Aleksandrov-Gerasimenko bracket, and is completely positive
provided D2W −1 ≥1. These two CQ master equations are consistent, and have been studied in the context of
measurement theory[84], in the classical limit of the collisionless Boltzmann equation[85], in models for Newtonian
gravity[67, 68, 86], and in discussions around black-hole evaporation[50]. In Section III, we show that Equation (12)
is the most general Markovian classical-quantum dynamics given assumptions on the boundedness of the generators,
using a fully classical-quantum formalism. The most general classical-quantum map is Equation (26) with the condition
(27). In [87], we prove that there are two classes of this consistent classical-quantum dynamics, one which is continuous
and generalises Equation (6) to the case of arbitrary interaction Hamiltonians and multiple Lindblad operators and
classical degrees of freedom. The other class of dynamics is that of Equation (5) but with non-diagonal Lindblad
couplings which we show has discrete, ﬁnite sized jumps in phase space.
8 The original motivation for gravitational decoherence was based on non-linear interactions, which is not present in the linear theory
considered here. Penrose’s motivation was that one branch in a superposition would cause the time-like killing vectors in another branch
to be uncertain, while in a linear theory, diﬀerent branches evolve independently. Diosi originally postulated gravitational decoherence
via the non-linear Schr¨odinger-Newton equation, while more recent approaches are based on a linear hybrid theory[68, 69] as we also
consider here.

6
Following this derivation, the central contribution presented here will be the application of these general dynamics
to quantum ﬁeld theory coupled to classical general relativity with Einstein’s equation emerging in the appropriate
limit. We begin in Section IV, where we present Equation (15) where continuous and deterministic classical evolution
emerges in some limit. This follows from considering a perturbative expansion of the more general dynamics. Away
from this limit, the quantum system can retain some coherence, but complete positivity requires the classical system
to undergo diﬀusion or discrete, ﬁnite sized jumps in phase-space. A discrete realisation of this dynamics makes use
of a discrete and non-commuting directional divergence, Equations (61)-(63). This generates a discrete version of
Liouville dynamics on the classical system and the action of a dynamical semi-group on the quantum system, thus
providing a natural generalisation of both classical and quantum evolution. The dynamics includes the continuous
evolution equation of [34] and a discrete master equation, where a parameter τ governs how continuous and classical
the total system is, with the system’s trajectory in the classical phase-space going from ﬁnite-sized hops to continuous
deterministic dynamics as τ →0. In this limit, the quantum system decoheres and becomes classical. For larger τ
(or ℏ), the decoherence times are longer, while the jump distance in the classical phase-space increases resulting in
greater diﬀusion in the system’s trajectory.
In Section IV B, we present a simple example of the discrete dynamics, namely a quantum spin system with a
classical position and momentum interacting with a potential. We see that if the particle is initially in a superposition
of spin states, then it eventually collapses to one of them through its interaction with the classical degrees of freedom.
In essence, the classical potential acts like a Stern-Gerlach device, so that after some time, the particle’s classical
degrees of freedom uniquely determine the value of the spin. Unlike standard decoherence, the collapse of the quantum
state happens suddenly, when the system undergoes a classical jump in its momentum. At that point, monitoring the
momentum unambiguously reveals the particle’s spin. The quantum state of the system remains pure, conditioned
on the state of the classical system. There is thus no need for the mysterious measurement postulate of quantum
theory, a postulate which has meant that the interpretation of quantum theory has been open to dispute, and whose
problematic nature has recently received renewed attention[88].
We then generalise to a hybrid version of quantum ﬁeld theory in Section IV C, and then apply the formalism
to general relativity in Section V. We work in the ADM formalism[89], treating the metric as classical, while the
matter living on space-time are quantum ﬁelds. In the classical limit, the equations of motion reduce to Einstein’s
equations. The equations we derive, allow one to calculate the back-reaction of quantum ﬁelds on classical space time.
This allows us to go beyond the semi-classical Einstein’s equation and we expect it to prove useful in attempts to
understand black hole evaporation or the eﬀect of vacuum ﬂuctuations in cosmology. The interaction of the quantum
system with classical space-time causes the wave function to collapse, at a rate determined by the system’s energy
momentum tensor. The stochastic nature of the interaction suggests that information is destroyed in black holes,
although the quantum state conditioned on the metric degrees of freedom can remain pure. The theory suggests
a number of possible experiments which could falsify or verify it, and we discuss this, as well as the implications
for astrophysical observations in the Discussion, Section VI. We begin in Section II by reviewing the formalism of
classical-quantum dynamics and then discuss how the evolution law we will derive relates to both classical stochastic
dynamics and quantum maps.
II.
CONSISTENT CLASSICAL-QUANTUM DYNAMICS
The state of a quantum system is represented in a Hilbert space HS by a density matrix – a positive trace one
matrix σ. A classical system lives in phase-space, a 2n dimensional manifold M of points ¯z = (¯q, ¯p)T and its state can
be represented by a normalised probability density ρ(¯z) over this space. A discrete9 classical system is represented
by a discrete random variable ¯z, and the system has a probability p(¯z) of being at ¯z. Here, as in [34, 50, 80, 84, 85],
we consider a hybrid classical-quantum system which lives on both the Hilbert space and the classical phase space
(or is represented by a random variable). We denote its state by a positive subnormalized matrix ϱ(¯z) in HS at each
point10 ¯z, such that
Z
d¯z tr ϱ(¯z) = 1
(7)
In quantum theory, such a system is sometimes said to be in a cq-state, and has a density matrix of the form
ϱcq =
Z
d¯zρ(¯z)|¯z⟩⟨¯z| ⊗σ(¯z)
(8)
9 We shall here present the continuous case, with the discrete case following from taking the integrals to sums, and the Dirac-delta function
δ(¯z −¯z′) to the Kronecker-delta function
10 As Barbara Soda noted, one can generalise this formalism to the case where the connection between the Hilbert spaces at each point ¯z
is non-trivial.

7
with σ(¯z) a normalised density matrix and |¯z⟩an orthonormal basis. Here, we will use the more compact notation
ϱ(¯z), in part because if we want ¯z to be phase space, then using a fully quantum system requires special conditions on
the q and p degrees of freedom which would then live on diﬀerent systems. The probability density that the system is
in classical state ¯z is ρ(¯z) = tr ϱ(¯z), and conditioned on the classical system being in state ¯z, the quantum system is in
the subnormalized state ϱ(¯z), while σ(¯z) is the normalised state of the quantum system. We denote by ϱ, the state of
the entire system, which is a subnormalized quantum state ϱ(¯z) over each point ¯z of the phase space manifold, such
that
R
¯z tr ϱ(¯z) = 1. When we consider gravity, each point ¯z is a classical ﬁeld (the 3-metric, and 3-momentum) over
R3.
We now ask, what is the most general dynamical map which take any cq-state at time t = 0 to another cq-state at
a later time t. This will require us to adapt Kraus’s representation theorem[90] to the classical-quantum case. Let
us recall that for quantum systems, if the map is also Markovian, i.e. its generator is invariant with respect to time
translations, then the most general CPTP map is the GKSL or Lindblad equation[81, 82]
∂σ
∂t = −i
ℏ[H, σ] −λαβ
LασL†
β −1
2{L†
βLα, σ}+

(9)
with H the Hamiltonian, and λαβ a positive deﬁnite matrix. Lα is a traceless basis of operators, orthogonal in the
Hilbert-Schmidt norm, and one cane always diagonalise it. In that case, LασL†
α is sometimes called the jump term
since one could interpret it as giving the rate at which the system jumps from being in another quantum state into
σ, while 1
2{L†
αLα, σ}+ is sometimes called the no event term acts to preserve the trace.
For a classical stochastic process on the other hand, an initial state at t = 0, ρ(¯z, 0) evolves to
ρ(¯z, t) =
Z
d¯zP(¯z|¯z′; t)ρ(¯z′, 0)
(10)
with P(¯z|¯z′) ≥0 and
R
d¯zP(¯z|¯z′; t) = 1. This simply ensures that 0 ≤ρ(¯z, t) ≤1 and is normalised for any input
distribution. This is equivalent to P(¯z|¯z′; t) being the conditional probability that the state makes a transition to ¯z
at time t given that it was initially at ¯z′. For a continuous process, the most general dynamics can be give by the
rate equation
dρ(¯z)
dt
=
Z
d¯z′W(¯z|¯z′; t)ρ(¯z′) −W(¯z; t)ρ(¯z)
(11)
where W(¯z|¯z′; t) are positive rates for the system to transition from state ¯z′ to state ¯z (this can be thought of as
the jump term). To conserve probability, we require W(¯z; t) =
R
d¯z′W(¯z′|¯z; t) being the total rate for the system to
transition away from state ¯z to one of the states ¯z′ (this is analogous to the no event term in the GKSL equation).
For continuous dynamics, the most general Markovian rate equation is the Fokker-Planck equation, also known as the
Forward Kolmogorov equation.
Here we present the most general classical-quantum dynamics which is linear and completely positive. We then
ﬁnd the generators of this map, deriving the most general continuous time master equation for the dynamics. As in
the proof of the generality of the GKSL equation, the proof presented here is valid for a separable Hilbert space, and
countable set of bounded Lindblad operators Lα. In the case of unbounded operators[91], one can cast the equation
in the form we derive, but it’s possible the dynamics are not unique.
Under these assumptions, we will ﬁnd that the most general master equation, can be put into the form is
∂ϱ(¯z)
∂t
= −i[H(¯z; t), ϱ(¯z)] + λαβ(¯z; t)

Lαϱ(¯z; t)L†
β −1
2{L†
βLα, ϱ(¯z)}+

+
Z
d¯z′W αβ(¯z|¯z′; t)Lαϱ(¯z′)L†
β −1
2W αβ(¯z; t){L†
βLα, ϱ(¯z)}+
(12)
with W αβ(¯z|¯z′) being positive semi-deﬁnite to ensure complete positivity of the evolution. We use Einstein summation
notation for the α, β. For continuous quantum systems, the sum is replaced by an integral. Lα can be any operators,
but we can always rewrite the above equation in terms of a basis of Lindblad operators orthogonal in Hilbert-Schmidt
norm, such that the Lα, (distinguished by having α in bold font) are traceless, and L0 = 1. We have separated out
the pure Lindbladian couplings λαβ(¯z; t) from W αβ(¯z; t) for convenience.
The terms proportional to W 00(¯z|¯z′) and W 00(¯z) are thus purely classical and accounts for both stochastic and
deterministic evolution of the classical degrees of freedom. In the case of continuous deterministic dynamics, this term
is just the Poisson bracket {h00(¯z), ϱ(¯z)} with h00(¯z) a classical Hamiltonian. We have here separated out a pure
Lindbladian term with couplings λαβ(¯z) to be consistent with conventions of the classical literature, but it is often

8
convenient to absorb them into the deﬁnition of W αβ(¯z|¯z′; t). The W αβ(¯z|¯z′) can be interpreted as the jump term,
both from a classical and quantum point of view. The anti-commutator terms are the collective no-event terms.
The condition that the master equation preserve probability, requires
W αβ(¯z) =
Z
d¯z′W αβ(¯z′|¯z)
(13)
and one can verify this is the case by noting that the total probability is a constant
∂
∂t
Z
d¯z tr ϱ(¯z) = 0
(14)
Although our derivation allows for the coupling terms to be time-dependent, we will later assume that the dynamics
is Markovian, and thus we will drop the time dependence from λ(¯z; t) and W αβ(¯z|¯z′; t).
In the case that the quantum and classical system do not get correlated (for example, when one acts as a heat
bath for the other) this reduces to a semi-classical version of the stochastic-master Equation (11) when we trace out
the quantum system, while if we integrate out ¯z we get an averaged version of GKSL dynamics. However, more
generally, tracing out the quantum or classical system results in dynamics which is non Markovian, since there can
be correlations between the classical and quantum systems, nor is the reduced dynamics even linear on the quantum
state. When we integrate over ¯z the presence of correlations between the classical system and the quantum one,
translate into diﬀerent eﬀective coupling strengths W(¯z) for diﬀerent quantum states.
In Section IV, we introduce a class of theories which reproduce Hamiltonian dynamics in the case where quantum
ﬂuctuations are small. This master equation can be expanded as11
∂ϱ(¯z)
∂t
= −i[H(¯z), ϱ(¯z)] + W αβ(¯z)
τ
h
Lαϱ(¯z)L†
β −1
2{L†
βLα, ϱ(¯z)}+
i
−LαXαβ
h (¯z) · ∇ϱ(¯z)L†
β + τLα∇· [γαβ
h (¯z)]ϱ(¯z)L†
β + τLα∇· Dαβ(¯z)ϱ(¯z) · ←−
∇L†
β + · · ·
(15)
where ∇= (∂¯q, ∂¯p)T is the divergence in phase space ¯z = ¯q, ¯p, and Xαβ
h
a matrix of vector ﬁelds which, as we will
detail, is generated by a Hamiltonian H(¯z) = hαβ(¯z)L†
βLα over quantum and classical degrees of freedom via the
symplectic matrix Ωand Xαβ
h (¯z) = Ω∇hαβ(¯z) and gives deterministic evolution in the classical limit. γαβ
h (¯z) are taken
to correspond to friction terms and is a vector in the 2n dimensional phase space, while the Dαβ(¯z) corresponding to
diﬀusion terms is a matrix both in αβ and in phase space. One typically considers Dαβ(¯z) to depend only on ¯q and
the diﬀusion to be in ¯p. Dropping terms of higher order and tracing out the quantum system gives a semi-classical
version of the Liouville equation
∂ρ(¯z)
∂t
= tr{H(¯z), ϱ(¯z)} + · · ·
(16)
If we retain the term proportional to τ, an appropriate choice of γαβ
h (¯z) and Dαβ(¯z) corresponds to a hybrid version
of the Fokker-Planck equation. Truncated the expansion in Equation (16) can result in negative probabilities, but
the full evolution equation is completely positive and provides a natural generalisation of both classical Hamiltonian
dynamics and the GKSL equation.
We also see that tracing out the quantum system doesn’t result in the pathological behaviour found in the semi-
classical Einstein’s equation as depicted in Figure 1 as the dynamics is linear in the density matrix. Rather, Equation
(16) is similar to the situation described in our discussion of Equation (3) where we have linear evolution of two
coupled systems which can become correlated.
III.
THE CLASSICAL-QUANTUM MAP AND MASTER EQUATION
We will ﬁrst derive the most general classical-quantum map which takes a cq-state, ϱ(¯z; 0) at t = 0 to another
cq-state, state ϱ(¯z; t) and then derive the general continuous time master equation. Let us recall Kraus’s theorem,
that for a quantum system, the most general map E(σ) is completely positive (CP), trace preserving (TP)
σ(t) =
X
µ
Kµσ(0)K†
µ
(17)
11 Here, we have included the pure Lindbladian term proportional to λαβ(¯z) in the W αβ(¯z) term.

9
with the operators Kµ satisfying
K†
µKµ = 1
(18)
where CP means that 1 ⊗E acting on HS ⊗HS takes positive operators to positive operators, and together with the
trace preserving condition, ensures that density matrices are mapped to density matrices, even if the map acts on
part of a system.
Let us now consider the case of a map which acts on cq-states. Because the map has to be linear in ϱ(¯z), and in
particular probabilities tr ϱ(¯z), we can write the total map Λt acting on ψ in terms of quantum maps Λ¯z|¯z′;t such that
ϱ(¯z; t) =
Z
d¯z′Λ¯z|¯z′;t
 ϱ(¯z′)

(19)
Since the initial state could be ϱ = σ(¯z′), i.e. a normalised quantum state with support only at ¯z′, the map Λ¯z|¯z′;t(ψ)
must be completely positive for all ¯z, ¯z′. An initial state at ¯z′ must be mapped to another quantum state at each ¯z.
But the maps need not preserve the trace – it must merely be completely positive, trace non-increasing, since if we
act it on the normalised state at ¯z′, a ﬁnal state at ¯z can’t have trace larger than one as this would correspond to a
probability
R
d¯zρ(¯z) larger than one. Thus one easily sees that a necessary and suﬃcient condition for a cq-map, is
that each Λ¯z|¯z′;t must be a completely positive, trace non-increasing map, with the total map
Λ¯z′;t :=
Z
d¯zΛ¯z|¯z′;t
(20)
being trace-preserving. This is the analogue of the classical condition
R
d¯zP(¯z|¯z′) = 1.
We can then write the map in terms of sets12 of Kraus operators Kµ(¯z|¯z′)
ϱ(¯z; t) =
Z
d¯z′ X
µ
Kµ(¯z|¯z′)ϱ(¯z′, 0)Kµ(¯z|¯z′)†
(21)
where P
µ Kµ(¯z|¯z′)†Kµ(¯z|¯z′) ≤1. This follows from the fact that the action of the entire map must preserve the
trace, thus summing over µ and taking the trace of both sides of Equation (21) on an arbitrary initial state ϱ(¯z′, 0),
requires
X
µ
Z
d¯z Kµ(¯z|¯z′)†Kµ(¯z|¯z′) = 1
(22)
Equation (21) gives the most general map on hybrid classical-quantum states. It is the hybrid generalisation of both
the classical probability map of Equation (10), and in some sense, an extension of the Kraus representation theorem
Equation (17). However, it can also be considered a special case of a Kraus decomposition, as we could restrict
ourselves to quantum states that have the form of Equation (8) and write its action as
ψcq(t) =
Z
d¯zd¯z′ X
µ
|¯z⟩⟨¯z′| ⊗Kµ(¯z|¯z′)ψcq(0)|¯z′⟩⟨¯z| ⊗Kµ(¯z|¯z′)†
(23)
We now want to derive the generator L of this map
Λt = exp(Lt)
(24)
using
Lϱ(¯z; t) = lim
δt→0
ϱ(¯z; t + δt) −ϱ(¯z; t)
δt
(25)
To this end, we write the Kraus operators in terms of an orthonormal basis of operators13 Lα to obtain
ϱ(¯z; t) =
X
α,β=0
Z
d¯z′Λαβ(¯z|¯z′; t)Lαϱ(¯z′; 0)L†
β
(26)
12 One can also consider the case where µ is continuous, in which case the sum over µ becomes an integral, but uniqueness of the master
equation is only proven for Kµ(¯z|¯z′) a countable set.
13 Once again, here we take the number of basis elements to be countable, but one could consider the more general case with the proviso
that the form of the master equation is not unique.

10
where complete-positivity for all ¯z, ¯z′ requires the Λαβ(¯z|¯z′; t) be a positive semi-deﬁnite Hermitian matrix in α, β for
all ¯z, ¯z′ (see [92] and also Appendix A). The trace-preserving condition, Equation (22) requires
X
αβ
Z
d¯zΛαβ(¯z|¯z′; t)L†
βLα = 1
(27)
Since Lα is an arbitrary basis, we can always take L0 = 1, and the trace-preservation condition, means that
the other Lα are traceless, and we denote them with bold font α. We are interested in changes of the state over
inﬁnitesimally short times δt. Using the assumption that the Lindblad operators are bounded and Λαβ continuous,
we expand the Λαβ as
Λ00(¯z|¯z′; t + δt) = Λ00(¯z|¯z′; t) −δ(¯z −¯z′)γ00(¯z′; t)δt + W 00(¯z|¯z′; t)δt + O(δt2)
(28)
Λαβ(¯z|¯z′; t + δt) = Λαβ(¯z|¯z′; t) + δ(¯z −¯z′)λαβ(¯z′; t)δt + W αβ(¯z|¯z′; t)δt + O(δt2) αβ ̸= 00
(29)
since when δt →0, Λαβ(¯z|¯z′; t + δt) needs to act as Λαβ(¯z|¯z′; t). We have divided up the terms proportional to δt into
two contributions14. To understand each of the terms, it’s perhaps simplest to restrict ourselves to the Markovian
case, which allows us to take t = 0 (since only diﬀerences in time matter) in which case Λ00(¯z|¯z′; t = 0) = 1δ(¯z −¯z′)
(when δt →0 the system has to remain at the same point in phase space and the quantum system doesn’t change),
while the other Λαβ(¯z|¯z′; t = 0) = 0 since these terms are associated with Lindblad operators Lα acting on the state
and nothing happens to the state in the limit δt →0. The ﬁrst term proportional to δt in Equation (29) can be
thought of as the probability the system doesn’t move in phase-space while the quantum system has Lαϱ(¯z)L†
β applied
to it, while the W αβ(¯z|¯z′; t) term in both equations gives the probability that the system goes from ¯z′ to ¯z for each
αβ. We adopt the convention that the sign in front of γ00 to be negative anticipating that it will contribute negatively
– it’s the no-event term, and the probability that the system is unchanged can only decrease with time.
An expansion similar to the above is used to derive Equation (11) for continuous classical stochastic processes,
albeit without the distinction that the quantum dynamics requires. Taking the limit dt →0 and keeping only the
ﬁrst order terms require that the set of operators Lα be countable and bounded. In the Markovian case and t = 0 it
is easy to see that positivity of the matrix Λαβ(¯z|¯z′; δt) require that W αβ(¯z|¯z′; t = 0) also be a positive semi-deﬁnite
matrix for ¯z ̸= ¯z′, and that λαβ(¯z; t = 0) + W αβ(¯z|¯z′; t = 0)δ(¯z −¯z′) and 1 −γ00(¯z; t = 0) + W αβ(¯z|¯z′; t = 0)δ(¯z −¯z′)
are positive semi-deﬁnite15
To ﬁnd the generator of the dynamics, we substitute Equations (28)-(29) into Equation (26) to get
ϱ(¯z; t + δt) =
Z
d¯z′δ(¯z −¯z′)
 1 −δtγ00(¯z′; t)

ϱ(¯z′; t) + δtλα0(¯z; t)Lαϱ(¯z′; t) + δtλ0β(¯z; t)ϱ(¯z′; t)L†
β
+ δtλαβ(¯z; t)Lαϱ(¯z′; t)L†
β

+
X
αβ
Z
d¯z′δtW αβ(¯z|¯z′; t)Lα(x)ϱ(¯z′; t)L†
β
(30)
and subtracting ϱ(¯z; t), dividing by δt and taking the limit δt →0 gives
∂ϱ(¯z)
∂t
= −γ00(¯z; t)ϱ(¯z; t) + λα0(¯z; t)Lαϱ(¯z; t) + λ0β(¯z; t)ϱ(¯z; t)L†
β + λαβ(¯z; t)Lαϱ(¯z; t)L†
β
+
X
αβ
Z
d¯z′W αβ(¯z|¯z′; t)Lαϱ(¯z′; t)L†
β
(31)
As in the derivation of the GKSL equation, we now deﬁne the two Hermitian operators
H(¯z; t) := 1
2i(λ0βL†
β −λα0Lα),
N(¯z; t) := −γ00(¯z; t) + 1
2(λ0βL†
β + λα0Lα)
(32)
so that we can write Equation (31) as
∂ϱ(¯z)
∂t
= −i[H(¯z; t), ϱ(¯z; t)] + λαβ(¯z; t)ϱ(¯z; t)Lαϱ(¯z; t)L†
β +
Z
d¯z′W αβ(¯z|¯z′; t)Lαϱ(¯z′; t)L†
β + {N(¯z, t), ϱ(¯z; t)}+ (33)
14 This is not necessary since W αβ(¯z|¯z′; t) could include both contributions, but is consistent with previous literature.
15 It is for this reason we use the convention of a minus sign in front of γ00(¯z; t), but one could deﬁne λ00(¯z; t) := 1 −γ00(¯z; t) in order to
treat them on the same footing. One can more readily conduct this proof using indicator functions which are distributions in ¯z, ¯z′, and
we refer the reader to [87] for details.

11
Having subtracted ϱ(¯z; t) from Equation (27) the trace-preservation condition, Equation (20) becomes Equation (14)
i.e.
Z
d¯z tr ∂ϱ(¯z; t)
∂t
= 0
for any input state ϱ(¯z′; t), which requires
N(¯z′) = 1
2
 X
αβ
λαβ(¯z′)L†
βLα +
Z
d¯z
X
αβ
W αβ(¯z|¯z′)L†
βLα

(34)
Deﬁning the outgoing ﬂux W αβ(¯z) by Equation (13), gives the desired form of the master equation, Equation (12).
The ﬁrst term of Equation (12) is the free evolution of the quantum system at each point in phase-space, the
second term corresponding to λαβ(¯z) is pure Lindbladian, with a rate determined by the classical degrees of freedom.
The remaining term, corresponding to W αβ gives the interaction term between the classical and quantum degrees of
freedom. It is worth noting that the term corresponding to αβ = 00
∇00ϱ(¯z) :=
Z
d¯z′W 00(¯z|¯z′)ϱ(¯z′) −W 00(¯z)ϱ(¯z)
(35)
is the purely classical evolution of the system and is identical to Equation (11).
It can be stochastic, or it can
correspond to deterministic dynamics generated by a classical Hamiltonian H(¯z) in which case, we can write it in
terms of the Poisson bracket, or equivalently as
∇00ϱ(¯z) = −X00
h · ∇ϱ(¯z)
(36)
where X00
h is the Hamiltonian vector ﬁeld
X00
h = Ω∇H
(37)
with Ωthe symplectic matrix
Ω=

0
In
−In
0

(38)
so that
X00
h = (∂h00
∂¯p , −∂h00
∂¯q )T
(39)
∇00 could also include diﬀusion term as in the Fokker-Planck equation, but it will be natural to treat it in the same
way we treat the other W αβ, in which case it will be a stochastic version of Hamiltonian dynamics which we now
introduce.
IV.
NON-COMMUTING HAMILTONIAN DYNAMICS
We would like stochastic hybrid dynamics which has continuous evolution in the classical limit. Here, we explore
the discrete master equation, corresponding to Equation (15) which gives a classical-quantum version of the Liouville
or Fokker-Planck equation at higher order. We begin by taking ¯z to be phase space variables ¯q, ¯p, and will later
present the case where ¯z represent ﬁeld degrees of freedom over x, since the generalisation is straight-forward, while
the notation is more cumbersome. The dynamics will be generated by a Hamiltonian operator which can also depend
on phase space variables ¯z and a decomposition of the Hamiltonian in terms of Lindblad operators Lα
H(¯z) = hαβ(¯z)L†
βLα
(40)
When we get to the ﬁeld theory case, we will see that Lorentz invariance, and later, diﬀeomorphism invariance, place
very tight constraints on this decomposition. The h00(¯z) term is purely classical, since it couples only via 1 to the
quantum degrees of freedom. There is some ambiguity in what is included in the Lα and what in hαβ(¯z), but it will
turn out that this ambiguity is inconsequently when applying this formalism to general relativity. The matrix hαβ
is Hermitian, and it is sometimes convenient to take it to be positive as is the case for the coupling term of general

12
relativity. We deﬁne a generator of dynamics Xh which has both phase space components and components α,β in
Hilbert space determined by the Lindblad operators I.e.
Xαβ
h
=
∂hαβ
∂¯p , −∂hαβ
∂¯q
T
(41)
Just as XH determines the rate of ﬂow along diﬀerent directions in phase space in the case of purely deterministic
classical evolution, here, Xαβ
h , additionally sets the rate of quantum jumps along diﬀerent Lindblad operators.
We have already expanded Λt in terms of inﬁnitesimally small times δt, and we will now also expand it in terms of
the phase space vector ∆:= ¯z −¯z′, which we can then take arbitrarily small if we choose. To this end, let us write
Λαβ(¯z|¯z′; t) = Λαβ(¯z|¯z −∆; t) and perform, both an expansion in δt and a Kramers-Moyal expansion[93, 94] in ∆. We
can either do this directly on Equations (28)-(29) but it’s slightly less cumbersome to perform it on W αβ(¯z|¯z −∆; t).
W αβ(¯z|¯z −∆; t)ϱ(¯z −∆) = W αβ(¯z + ∆−∆|¯z −∆; t)ϱ(¯z −∆)
=
∞
X
n=0
(−∆· ∇)n
n!

W αβ(¯z + ∆|¯z; t)ϱ(¯z)

(42)
We now integrate this expression over ∆to write
Z
d∆W αβ(¯z|¯z −∆; t)ϱ(¯z −∆) =
∞
X
n=0
(−∇)⊗n ·
M αβ
n (¯z; t)
n!
ϱ(¯z)

(43)
in terms of the moments16
M αβ
n (¯z; t) =
Z
d∆(∆)⊗nW αβ(¯z + ∆|¯z; t)
(44)
The zeroth moments
M αβ
0
=
Z
d∆W αβ(¯z + ∆|¯z; t)
(45)
are just W αβ(¯z; t) of Equation (13). The ﬁrst moments are the vectors
M αβ
1
=
Z
d∆∆W αβ(¯z + ∆|¯z; t)
(46)
For a Hamiltonian H and decomposition hαβ, we will see that there is a natural choice of W αβ(¯z + ∆|¯z; t) so that
the vector of ﬁrst moments has a contribution corresponding to Hamiltonian ﬂow
Xαβ
h (¯z) := Ω∇hαβ(¯z)
(47)
where we have indicated that W αβ(¯z + ∆|¯z) is generated from the ﬁeld hαβ, with the subscript h. This we do in
Section IV A. We can also consider a contribution corresponding to friction γαβ
h
so that
Z
d∆∆W αβ
h (¯z + ∆|¯z) :=Xαβ
h (¯z) −γαβ
h (¯z)
(48)
Although there could be some arbitrariness in this division, a standard friction term is of the form γαβ
h (¯z) = τγ∂hαβ/∂¯p
with γ a constant and τ included for later convenience.
Next there is the matrix of diﬀusion terms
Dαβ(¯z) := 1
2
Z
d∆∆⊗∆W αβ
h (¯z + ∆|¯z).
(49)
16 Here, we write Mαβ
n (¯z; t) as an n-fold tensor power, since ∆⊗n · ∇⊗n = (∆· ∇)n with ∆· ∇the directional divergence in the direction
∆. This has the advantage that the notation is compact, but the disadvantage that it distinguishes the moment corresponding to ∂q∂p
to that of ∂p∂q (for example).

13
Making the Markovian approximation so that we may drop the explicit dependence on time, and putting this
together gives
Z
d∆W αβ(¯z|¯z −∆)ϱ(¯z −∆) = Wh(¯z)ϱ(¯z) −Xαβ
h
· ∇ϱ(¯z) + ∇· γαβ
h ϱ(¯z) + ∇· Dαβ(¯z)ϱ(¯z) · ←−
∇+ · · ·
(50)
where we have used the fact that ∇· Xαβ
h
= 0, and the notation ←−
∇is to indicate that ∇acts on the second ∆in the
tensor product of Dαβ(¯z), while ∇acts on the ﬁrst. One typically refers to the terms which contain ∇ϱ(¯z) as the
drift, since they determine the rate at which the expectation values of observables change. The terms corresponding
to second derivatives lead to diﬀusion in phase space. Note that if Dαβ(¯z) depends on both the q and p, then it
can also include contributions to the drift. Here we will take Dαβ(¯z) to only depend on the q so that there are no
anomalous drift terms coming from this and higher order terms.
The Pawula theorem[95], says that either the Kramers-Moyal expansion truncates at the second moment, or requires
an inﬁnite sum of terms. In the latter case, our truncated master equation will not be completely positive, and should
be regarded as an approximation of the dynamics of Equation (12). We will call a particular expansion of H in terms
of Lindblad operators, and the choice of W αβ(¯z +∆|¯z) or Λαβ(¯z +∆|¯z) a realisation and although we will present two
simple realisations in Section IV A, the main requirement we demand is that the moment expansion include Xαβ
h (¯z),
the Hamiltonian vector ﬁeld for hαβ(¯z) in it’s ﬁrst moment, Equation (48). This ensures that we are able to reproduce
the deterministic classical equations of motion in the appropriate limit. When we consider applying our results to ﬁeld
theory and later General Relativity, Lorentz covariance and gauge invariance implies further constraints on W αβ(¯z|¯z′).
Substituting the Kramers-Moyal expansion of W αβ(¯z|¯z′) into Equation (12) gives
∂ϱ(¯z)
∂t
= −i[H(¯z), ϱ(¯z)] +
 λαβ(¯z) + M αβ
0 (¯z)
h
Lαϱ(¯z)L†
β −1
2{L†
βLα, ϱ(¯z)}+
i
−LαXαβ
h (¯z) · ∇ϱ(¯z)L†
β + Lα∇· [γαβ
h (¯z)ϱ(¯z)]L†
β + Lα∇· Dαβ(¯z)ϱ(¯z) · ←−
∇L†
β + · · ·
When we consider realisations of W αβ, we typically ﬁnd that each order in the expansion carries with it higher powers
of some constant τ. If we identify 1
τ W αβ(¯z) := λαβ(¯z) + M αβ
0 , and Dαβ →τDαβ this is Equation (15) highlighted in
the Introduction.
An important category of realisations, are ones in which M αβ
n (¯z) for n ≥2 and γαβ
h (¯z) only depend on the conjugate
coordinates ¯q, and the diﬀusion is only in the conjugate momenta ¯p. I.e.
∂ϱ(¯z)
∂t
= −i[H(¯z), ϱ(¯z)] + W αβ(¯z)
τ
h
Lαϱ(¯z)L†
β −1
2{L†
βLα, ϱ(¯z)}+
i
−LαXαβ
h (¯z) · ∇ϱ(¯z)L†
β + τLα
∂
∂p · [γαβ
h (¯z)ϱ(¯z)]L†
β + τLα
∂
∂p · Dαβ(¯z)ϱ(¯z) ·
←−
∂
∂pL†
β + · · ·
(51)
This means that the ¯q still obey the equation of motion17
˙q = ∂h00
∂p
(52)
and allows one to deﬁne ¯p deterministically in terms of ¯q and ˙¯q. Equation (51) is thus a classical-quantum version
of the Wiener process or Fokker-Planck equation and we will refer to such a master equation as Brownian. For such
a master equation, it is the conjugate momentum which is inﬂuenced by the quantum system. In the more general
case, ¯p is only deﬁned in terms of expectation values.
It’s worth noting that in our expansion, we have a purely Lindbladian term which is itself trace-preserving, and a
total divergence term, with the quantity Xαβ
h
−γαβ
h
−Dαβ · ←−
∇acting as a current. Thus if we integrate over phase
space, this term also conserves probability, contributing only a boundary term. Generally though, this term is not
positive by itself, and one typically has to include the full expansion to ensure this. Looking at each of the terms
in Equation (15), we see that the ﬁrst term is just the deterministic quantum evolution. One can have a purely
deterministic classical evolution term as well. Since L0 = 1, the X00
h term is generated by the pure classical term h00
in the expansion H = hαβL†
βLα.
−X00
h (¯z) · ∇ψ = {h00(¯z), ϱ(¯z)}
(53)
17 This can be veriﬁed using the Heisenberg representation for all moments of ¯q (see Section B)

14
The other deterministic term, at least on the classical system and for a particular αβ is LαXαβ
h (¯z) · ∇ϱ(¯z)L†
β, which,
if we trace out the quantum system, gives the required dynamics we are looking for, Equation (16).
The other non-deterministic parts include the pure Lindblad term, and if we trace out the quantum system it
contributes nothing to the dynamics of the classical system, except in indirectly, as it evolves the quantum system
which back-reacts on the classical system. On the quantum system it can generate decoherence, and if the Lindblad
operators are diagonal in raising and lowering operators, it raises and lowers the state of the quantum system. The
ﬁnal two terms, if we trace out the quantum degrees of freedom are the friction and diﬀusion terms on phase space,
as in the Fokker-Planck equation, although here, there is again some non-Markovianity as the quantum system can
serve as a memory for the classical system.
The Lindbladian term can determine the rate at which the wave-function collapses and if this rate is small then the
diﬀusion term tends to be large. This is to be expected since as discussed in the introduction, a purely deterministic
evolution on phase space would collapse the wave function instantly, and so a slow rate of collapse requires either a
very noisy stochastic evolution or a very slow jump rate.
We can now write a formal solution of Equation (15). One way to do this, is to perform the standard trick of
doubling the Hilbert space18, and instead of writing the density matrix ϱ(¯z) in its eigenbasis as
ϱ(¯z) =
X
i
pi(¯z)|i⟩⟨i|
(54)
we write it as a pure entangled state in the Schmidt basis
|ϱ(¯z)⟩AB =
X
i
p
pi(¯z)|i⟩A ⊗|i⟩B
(55)
The cq-master equation can then be written as
∂|ϱ(¯z)⟩AB
∂t
=
h
−iH(¯z) ⊗1 + i1 ⊗HT (¯z) + (λαβ(¯z) + W αβ(¯z))
 Lα ⊗L∗
β −1
2L†
βLα ⊗1 −1
21 ⊗LT
αL∗
β

−Lα ⊗L∗
βXαβ
h
· ∇+ Lα ⊗L∗
β∇· γαβ
h (¯z) + Lα ⊗L∗
β ∇⊗2 · Dαβ(¯z) + · · ·
i
|ϱ(¯z)⟩AB
(56)
and if we designate the operator in square brackets as L then the formal solution to the rate equation is
|ϱ(¯z; t)⟩AB = eLt|ψ(¯z; 0)⟩
(57)
A.
Realisations of W αβ(¯z, ¯z −∆)
Here, we present some simple and constructive examples for W αβ(¯z, ¯z −∆) which have the properties we require,
namely, positive semi-deﬁnite matrices whose ﬁrst moment contain a term which generates Hamiltonian ﬂow via
Equation (48). A simple realisation, valid for small τ is
W αβ(¯z, ¯z −∆) ≈1
τ δ(2N)(∆−τXαβ
h (¯z))
(58)
This gives the Liouville term as the ﬁrst moment as required, and 1/τ as the zeroth moment governing the collapse
rate. We could take τ to depend on α, β, or include a distribution f αβ over τ which allows one to conserve energy in
the case of unconstrained systems, as we discuss elsewhere[96]. The realisation of Equation (58) can be considered an
approximation of
Z
d∆W αβ(¯z, ¯z −∆)ϱ(¯z −∆) = 1
τ e
τ P
k
h
∂hαβ
∂qk
∂
∂pk −∂hαβ
∂pk
∂
∂qk
i
ϱ(¯z)
(59)
valid for larger τ.
These simple realisations lead to a natural non-commuting and ﬁnite τ generalisation of the
directional divergence. To see this, let us deﬁne basis vectors eαβ and deﬁne
∇αβϱ(¯z)eαβ := 1
τ
h Z
d∆W αβ
h (¯z|¯z −∆)Lαϱ(¯z −∆)L†
β −W αβ
h (¯z)1
2{L†
βLα, ϱ(¯z)}+
i
(60)
18 For the moment we take the quantum system to be ﬁnite dimensional, since extension to the continuous case is straightforward

15
leading to
∇αβϱ(¯z)eαβ =
Lαeτ{hαβ,·}ϱ(¯z)L†
β −1
2{L†
βLα, ϱ(¯z)}+
τ
(61)
which for small τ looks very much like a ﬁnite directional divergence (both along the direction Xαβ
h
and along the
Lindblad operators). Indeed, in cases where
∇αβϱ(¯z)eαβ ≈1
τ
h
Lαψ(¯z −τXαβ
h )L†
β −1
2{L†
βLα, ϱ(¯z)}+
i
(62)
It is sometimes the case that Xαβ
h
is non-negative (or non-positive), in which case this discrete, non-commuting
directional derivative takes the simpler form of a non-commuting ﬁnite diﬀerence
Xαβ
h ∇αβϱ(¯z) ≈Xαβ
h
τ
h
Lαψ(¯z −τ)L†
β −1
2{L†
βLα, ϱ(¯z)}+
i
(63)
Care must be taken to ensure it is norm preserving, which is the case if for example Xαβ
h
depends only on q and the
jump is in p.
The non-commuting divergence is trace-preserving and completely positive, and allows us to write the master
equation as
∂ϱ(¯z)
∂t
= −i
ℏ[H(¯z), ϱ(¯z)] + ∇αβϱ(¯z)eαβ
= −i
ℏ[H(¯z), ϱ(¯z)] + 1
τ
h
Lαϱ(¯z)L†
β −1
2{L†
βLα, ϱ(¯z)}+
i
−Xαβ
h
· Lα∇ϱ(¯z)L†
β + · · ·
(64)
If we make the model more deterministic (τ →0), the strength of the pure-Lindbladian term increases to compensate,
while if we make the Lindbladian term small, the diﬀusion terms at second order become signiﬁcant. Here, we have
temporarily switched units to show ℏ, since it strongly suggests that we set τ = ℏ. Thus as ℏ→0, the decoherence
renders the system completely classical, the diﬀusion terms and those of higher order go to zero, and we are left
with purely continuous classical equations of motion. For gravity, the realisations are more tightly constrained due
to gauge invariance, but similar realisations can be used to obtain dynamics which recover General Relativity in the
classical limit.
B.
Example: Qubit coupled to a classical potential
Let us now review a simple system, solved in greater detail in [96] which will contain some features we will encounter
with gravity19. While the model bears some similarity to the Stern-Gerlach experiment (c.f. also [54]), the behaviour of
the spin can diﬀer depending on how one decomposes the Hamiltonian in terms of Lindblad operators. Our system will
consist of a classical particle which will couple to the spin of a two level system or the energy of a quantum harmonic
oscillator. The classical degrees of freedom are the position q = x and momentum p of the particle, with free evolution
given by h00 = p2/2. We could take this evolution to be deterministic or stochastic and we will consider the former
here and discuss the latter in [96]. We take the total cq-Hamiltonian to be given by H(¯z) = p2/2m + B(q)H(m) with
H(m) = ω 1
2(a†a + aa†) for the oscillator and H(m) =

ω
0
0 −ω

for the qubit.
To model a Stern-Gerlach experiment we consider a two level system with states | ↑⟩,| ↓⟩and a cq-density matrix
which depends on the classical degrees of freedom.
ϱ(q, p) =

u↑(q, p)
α(q, p)
α∗(q, p) u↓(q, p)

(65)
For simplicity we consider a linear potential B(q) = Bq and a decomposition of the Hamiltonian, Equation (40), in
terms of Lindblad operators L↑= √ω| ↑⟩⟨↑|, L↓= √ω| ↓⟩⟨↓| with h↑↑(¯z) = −h↓↓(¯z) = Bq and the others zero.
An example which builds towards understanding the ﬁeld theoretic case is the harmonic oscillator with Lindblad
19 A helpful suggestion by Carlo Sparaciari has streamlined the presentation of this section.

16
operators a and a†. This is more interesting in the sense that the pure Lindbladian term raises and lowers the state
of the quantum system.
In the qubit system this corresponds to choosing Lindblad operators L↑= √ω| ↓⟩⟨↑|,
L↓= √ω| ↑⟩⟨↓| with diagonal couplings W αβ(¯z|¯z −∆) = δαβW αβ(¯z|¯z −∆), or even a single Lindblad operator
L =

0
√ω
√ω
0

. Here, we just present the more trivial ﬁrst case decomposition – the other cases, including non-
trivial B(q) are studied both analytically and numerically using an unravelling approach in [96]. We take a simple
realisation of the discrete dynamics, that of Equation (58) for small τ
∂ϱ(q, p)
∂t
= −i[H(m)(q, p), ϱ(q, p)] + {h00, ϱ(q, p)} +
X
α,β
1
τ
h
Lαϱ(q −τ ∂hαβ
∂p , p + τ ∂hαβ
∂q )L†
β −1
2{L†
βLα, ϱ(q, p)}+
i
= −iBq[

ω
0
0 −ω

, ϱ(q, p)] + { p2
2m, ϱ(q, p)} + ω
τ | ↑⟩⟨↑|ϱ(q, p + τB)| ↑⟩⟨↑|
+ ω
τ | ↓⟩⟨↓|ϱ(x, p −τB)| ↓⟩⟨↓| −ω
2τ {1, ϱ(q, p)}+
i
(66)
In terms of the matrix elements of the cq-state, Equation (66), the master equation decouples into two equations
for the diagonal components and one for the oﬀ-diagonal coherence term
∂u↑(q, p)
∂t
= −p
m
∂u↑(q, p)
∂q
+ ω
τ

u↑(q, p + τB) −u↑(q, p)

∂u↓(q, p)
∂t
= −p
m
∂u↓(q, p)
∂q
+ ω
τ

u↓(q, p −τB) −u↓(q, p)

(67)
∂α(q, p)
∂t
= −2iBqωα(q, p) −p
m
∂α(q, p)
∂q
−ω
τ α(q, p)
(68)
The latter has a solution
α(q, p) = ρ(q −p
mt)e−2iBωt(q−pt
2m )−ωt
τ
(69)
where ρ(q−pt) is any normalised function of its argument. We see that the coupling of the qubit results in decoherence,
since the oﬀ-diagonal elements decay exponentially fast.
More than that, the wave function collapses into a deﬁnite state of being in the up or down state. This we see
through the equation for the diagonal terms. Comparing Equations (67) to the Equation (11), we see that at a rate
of ω/τ the system undergoes jumps in momentum by ±τB depending on its state. Since we can monitor the classical
degrees of freedom without disturbing the system, measuring the change in momentum will uniquely determine the
value of the spin. In this sense, the interaction leads to more than just decoherence, but an objective collapse of the
wave-function, and eliminates the problem of the tails[97, 98] which spontaneous collapse models suﬀer from, or of
having a non-linear equation which arbitrarily introduces a preferred basis. More generally, if the ∇hαβ (or τ if we
let it depend on αβ) is unique when diagonalised, then monitoring the classical system uniquely determines which
Lindblad operators were applied to the state. Thus an initially pure quantum state, remains pure conditioned on the
classical degrees of freedom.
The solution (a Poisson distribution) for the diagonal terms of ϱ in this and a more general setting is given in [96]
but the evolution can be understood in broad terms by inspection. The particle is making a momentum jump of ±τB
at a rate of ω/τ, so on average it has an acceleration of ±ωB exactly as we would expect for a Stern-Gerlach. We
can imagine that at each dt, there is a probability of the particle undergoing a jump in momentum, so by the law of
large numbers, we expect the particle to have made on average ωt/τ jumps, normally distributed with a variance of
ω
τ (1 −ω
τ ). If we Taylor expand Equation (67)
∂u(q, p)
∂t
= −p
m
∂u(q, p)
∂x
± ωB ∂u(q, p)
∂p
+ ωB2τ
2
∂2u(q, p)
∂p2
+ · · ·
(70)
(where u is u↑or u↓, for ± respectively), then to ﬁrst order we have a particle undergoing acceleration ±ωB depending
on its spin, as expected, with a diﬀusion term at higher order. However, care must be taken, as if we truncate the
Taylor expansion, the density matrix can become negative. Equation (66) is completely positive however, and can be
understood as follows: an initial pure state in superposition will initially have a constant momentum, but will then
undergo jumps in momentum of ﬁnite size τB, and at a rate ω/τ. This causes the state to collapse to the up or down
state, at a rate ω/τ.

17
If we trace out the qubit and look at the average value of the particle’s trajectory, then for a uniform superposition
of up and down spin, it will have zero average acceleration, but if we look at the full state, the particle undergoes
acceleration (albeit stochastically) in a direction which depends on the value of the spin.
We thus see that the
evolution of the particle corresponds to the left panel of Figure 1, not the right one.
C.
Post-quantum ﬁeld theory
In order to consider applying our master equation to ﬁeld theories, we must ﬁrst ensure that it can be made
Lorentz covariant. Although it was initially thought that such dynamics are impossible[99], GKSL equations which
are covariant under the proper orthochronous Lorentz group were introduced in [100]. This was further taken up
in [49, 50] (see also [101]). A Lorentz invariant Schwinger-Keldish action for open quantum scalar ﬁeld theory was
used to show that the GKSL equation for scalar ﬁeld theories is renormalizable[102]20. The formalism used there is
manifestly Lorentz invariant.
In order to make the dynamics here Lorentz-covariant, one can begin by choosing Lindblad operators and couplings,
such that the right hand side of Equation (12) transforms like ∂/∂t, so that both sides of the equation transform in
the same way under a Lorentz boost. This has been referred to as a minimal Lorentz covariance requirement[99]. We
will ﬁrst construct a ﬁeld theory version of Equation (12) and then discuss how to make it covariant under the proper
orthochronous Lorentz group.
To obtain the ﬁeld theoretic version of the master equation, we take the Lindblad operators Lα to also depend on x
and in particular, take them to be local ﬁeld operators Lα(x). We can think of them as carrying a double index α, x.
This requires the couplings W to carry not just an index αβ but also x, y. Then, instead of a sum or integral over just
α, β, we also have an integral over x,y. Cluster-separability demands that the rate be zero unless |x −y| is small[45].
Although this is not necessary to protect causality and merely results in correlations being created over space-like
separations[49], we will here allow the coupling constants W αβ
h (¯z|¯z −∆; x, y), to depend on x−y but generally demand
that they are small unless |x −y| is. Finally, locality requires that local changes in the quantum ﬁeld be accompanied
by local changes in the classical ﬁeld, and we thus write the coupling as W αβ(¯z|¯z′; x, y). Here, the classical phase
space variables ¯z could be classical ﬁelds, thus the semi-colon notation indicates that W αβ(¯z|¯z′; x, y) is a functional of
the ﬁeld ¯z(x) over x. For the cq-state at ¯z, we will continue to write it as ϱ(¯z; t) with the understanding that it lives
in Fock space, and is an operator-valued distribution functional of the classical ﬁelds ¯z(x) over the entire manifold
of points x. If we consider the points x to be on a lattice, with the continuum obtained in the limit that the lattice
spacing goes to zero, then we can think of the measure D¯z over phase space as Πxdq(x)dp(x), and in the continuum
limit, the master equation is given by a functional integral.
If we take the Lindblad operators to be local ﬁeld operators Lα(x), then the ﬁeld theoretic version of Equations
(12) and (15) is 21
∂ϱ(¯z)
∂t
= −i[H(¯z), ϱ(¯z)] +
Z
d3xd3yD∆W αβ
h (¯z|¯z −∆; x, y)Lα(x)ϱ(¯z −∆)L†
β(y) −1
2W αβ
h (¯z; x, y){L†
β(y)Lα(x), ϱ(¯z)}+
(71)
= −i[H(¯z), ϱ(¯z)] +
Z
d3xd3yW αβ
h (¯z; x, y)
h
Lα(x)ϱ(¯z)L†
β(y) −1
2{L†
β(y)Lα(x), ϱ(¯z)}+
i
−
Z
d3x
h
Xαβ
h (¯z; x)Lα(x) · ∇ϱ(¯z)L†
β(x) −∇· Dαβ
h (¯z; x, y) · Lα(x)ϱ(¯z)L†
β(y)←−
∇
−
Z
d3x∇· [γαβ
h (¯z; x, y)Lα(x)ϱ(¯z)L†
β(y)]
i
+ · · ·
(72)
In ﬂat space, one can consider as an example the scalar ﬁeld discussed later in Section V, and take the pure Lindbladian
coupling term W αβ(¯z; x, y) to be a constant 1/τ. If we wish to reproduce Hamiltonian dynamics in the classical limit,
then we will generally take the Xαβ
h
term to transform just as the Poisson bracket would for a Lorentz-invariant
classical ﬁeld theory, since the only diﬀerence between it and {H(¯z), ϱ(¯z)} is operator ordering.
20 There are subtleties here that we clarify in [103]. The full master equation of [102] is not completely positive, but one can ﬁnd Lorentz
invariant master equations which are CP, as well as master equations which are CP and Lorentz covariant, but not Lorentz invariant.
21 One can also consider master equations which contain multiple jumps at higher order, i.e.
Z
D∆dx1dx2...W α1β1,α2β2...(¯z|¯z −∆; x1, x2, ...) · · · Lα2(x2)Lα1(x1)ϱ(¯z −∆)L†
β1(x1)L†
β2(x2) · · ·
but we will not do so here.

18
As an example we could decompose the Hamiltonian of the ﬁeld theory in terms of the Lindblad operators used in
[50, 100, 102]
H(x) =
Z
d3xhαβ(¯z; x)L†
β(x)Lα(x)
(73)
and hαβ(¯z; x) couples the quantum ﬁeld to a classical ﬁeld ¯z(x), which in the case of gravity, we can take to be the
3-metric and its conjugate 3-momentum. The couplings
Xαβ
h (¯z; x) = δhαβ(¯z; x)
δ¯z(x)
(74)
then reproduce the Hamiltonian back-reaction of the quantum ﬁelds on the classical ones. If one wants to be explicit
about W αβ(¯z|¯z′; x, y) one can use the realisation presented in Section V. In [87] we show that depending on the
decomposition hαβ(¯z; x), there are discrete dynamics or continuous dynamics. In particular, it is shown that the
Kramers-Moyal expansion in Equation (72) never terminates and leads to ﬁnite sized jumps in phase space unless the
only non-zero Dαβ
h (¯z; x, y) are D00
h (x, y), and the only non-zero Xαβ
h (¯z; x) are Xα0
h (¯z; x) and X0α
h (¯z; x), and the higher
order terms all vanish. In other words, the continuous master equation is obtained by restricting the decomposition
of Equation (73) to only include terms
H(x) =
Z
d3xh0α(¯z; x)1Lα(x)
(75)
while otherwise, one has discrete dynamics.
Recalling that for 2n phase space degrees of freedom per point, D00
h (¯z; x, y) is a 2n × 2n matrix over x, y and
denoting Wh(¯z; x, y) as the matrix with elements W αβ
h (¯z; x, y), and Xh(¯z; x) as the vector with elements X0α
h (¯z; x),
the continuous master equation is completely positive provided that the square matrix

D00
h (x, y)
δ(x, y)Xh(¯z; y)
X†
h(¯z; x)δ(x, y)
Wh(¯z; x, y)

⪰0
(76)
which for invertible22 Wh(¯z; x, y) is equivalent to the condition that D00
h (x, y) be positive semi-deﬁnite along with its
Schur complement 23
D00
h (x, y) −X†
h(¯z; x)W −1
h (¯z; x, y)Xh(¯z; y) ⪰0
(77)
where W −1
h (¯z; x, y) is the generalized inverse of Wh(¯z; x, y). This is a generalisation of the condition found in [34, 86].
Turning back to Lorentz covariance, one might worry that there is a dependence on the choice ∂t in the master
equation
∂tϱ(¯z) = Ltϱ(¯z)
(78)
As discussed in [100] we can consider any 4-vector a from the future cone F+ i.e. a · a ≥0, and a0 ≥0, and consider
the dynamics ∂aϱ(¯z) = La Indeed, consider M an element of the proper orthochronous Lorentz group. Let π(a, M)
be a representation of the Poincar´e group and let the evolution of the state ϱ(¯z) be given by a completely positive
trace-preserving Markovian map Ea. The Lorentz covariance condition as deﬁned in [100] (see also [50, 105]) is then
π(a, M)Ebπ(a, M)−1 = EMb
(79)
for any b ∈F+. In other words, if we perform a boost from the lab frame, evolve the state, then boost back into the
lab, one gets the same ﬁnal state as evolving the initial state in the lab for the boost time. The open quantum scalar
ﬁeld theory we will consider in the next section satisﬁes this property when the background space-time is ﬂat.
22 The positivity condition for singular Wh(¯z; x, y) is a straightforward extension of this, see for example [104].
23 We can further show that this relation holds for the zeroth, ﬁrst and second moments of any consistent classical-quantum coupling, and
provides an experimentally testable signature of classical gravity.

19
V.
POST-QUANTUM GENERAL RELATIVITY
We now have a procedure to take a Hamiltonian which couples classical and quantum degrees of freedom, and use
it to generate consistent hybrid dynamics. Let us now do that for General Relativity coupled to quantum matter via
the energy-momentum tensor. We will do so in the ADM formulation of General Relativity[89, 106], whose classical
formulation we now recall. One starts with a slicing up of space-time into space-like hypersurfaces, labelled by the
parameter t, and the evolution of these hypersurfaces is governed by the classical ADM Hamiltonian
HADM[N, ⃗N] =
Z
d3x(NHT + N aHT
a ) +
I
∞
d2sa(gab
,b −gb,a
b )
(80)
with
HT (x) = Gabcdπabπcd −g1/2R + H(m)(x)
(81)
denoting the total Superhamiltonian, with R the intrinsic curvature on the 3-manifold, Gabcd(x) the deWitt metric,
Gabcd(x) = 1
2g−1/2(gacgbd + gadgbc −gabgcd)
(82)
and H(m)(x) = √gnµnνTµν the matter Hamiltonian density in terms of components of the energy-momentum tensor
T µν(x) along nµ(x), the future-oriented normal vector to the hypersurface. We will sometimes drop the explicit x
dependence from ﬁeld quantities. The purely gravitational part of the Superhamiltonian, we denote by H(x) :=
Gabcdπabπcd −g1/2R. We will choose nµ to lie along a time-like direction ∂/∂x0, and we will choose a speciﬁc time
coordinate labelled t with the caveat that if we wish to make explicit the general covariance of the theory, we should
write it as an arbitrary time-like vector.
The total Supermomentum is given by
HT
a (x) = −2gac∇bπcb + H(m)
a
(83)
with ∇b the covariant derivative with respect to the 3-metric and the matter contribution H(m)
a
(x) = √gTaµnµ.
Ha := −2gac∇bπcb is the purely gravitational contribution.
Here, the phase space ¯z are the components of the
3-metric gab, and πab its conjugate momenta
πab = √g
 Kab −gabK

(84)
Kab is the extrinsic curvature. We will take H(m)(x) to include the cosmological constant term √ggabΛcc.
N and N a are the lapse and shift and in order for the dynamics to be invariant with respect to them, we need to
impose primary constraints on their conjugate momenta
PN(x) ≈0,
PNa(x) ≈0
(85)
where ≈denotes that the constraints are weakly zero in the sense that they only vanish on part of the phase space
(the constraint surface). To ensure that these primary constraints are conserved in time, i.e. that
˙
PN(x) = 0
˙
PNa(x) = 0
(86)
we require secondary constraints
HT (x) ≈0,
HT
a (x) ≈0
(87)
In the present paper, we ignore the boundary term, but the formalism can be extended to apply to its inclusion.
In addition to the constraints, we have the non-trivial dynamical equations of motion.
∂gab
∂t
= δHADM
δπab
,
∂πab
∂t
= −δHADM
δgab
(88)
where δ indicates the Fr´echet derivative. The constraints, once initially satisﬁed, are preserved by the dynamical
equations of motion.

20
One can write a Liouville equation for classical general relativity
∂ρ(g, π; t)
∂t
=
Z
d3x{NHT , ρ} +
Z
d3x{N aHT
a , ρ}
(89)
where the Poisson bracket contains a part due to the gravitational degrees of freedom, as well as any matter degrees
of freedom. For example, for the part of the ADM Hamiltonian which couples matter to gravity we have
{H(m), ρ} =
Z
d3x
 δH(m)
δgab(x)
δρ
δπab(x) −δH(m)
δπab(x)
δρ
δgab(x) + {H(m), ρ}matter

(90)
where {·, ·}fields includes the variation with respect to the classical ﬁeld degrees of freedom of matter.
We are now ready to construct CQ-dynamics for general relativity interacting with quantum ﬁelds. We will quantise
the Poisson bracket with respect to matter, by making it a commutator, thus the Poisson bracket of Equation (90)
will no longer be with respect to matter degrees of freedom. The part of the Poisson bracket which contains variations
with respect to gravitational degrees of freedom remains and will become our stochastic dynamics. We ﬁrst replace
T µν with the stress tensor of quantum ﬁeld theory, H(m) = √gTµνnµnν(x). We can now write
H(x) = Gabcdπabπcd −g1/2R + H(m)(x)
(91)
as long as we recall that this object is hybrid and cannot be used to derive classical or quantum evolution in the
traditional way. For the discrete master equation24, we expand H(x) in terms of local ﬁeld operators Lα(x)
H(x) = H(gab, πab; x)1 + hαβ(g, π; x)L†
β(x)Lα(x)
(92)
with L0(x) = 1 multiplying the purely classical part of the Superhamiltonian (i.e. we deﬁne h00 as H, the pure gravity
contribution).
The Supermomentum can be treated similarly, where the term stress-energy term in equation (83) is replaced by
its quantum counterpart
H(m)
a
→H(m)
a
(93)
leading to
Ha = Ha(g, π; x)1 + pαβ
a (g, π; x)L†
β(x)Lα(x)
(94)
Although the matrix with elements N apαβ
a
is not generally a positive semi-deﬁnite matrix, the combination Nhαβ +
N apαβ
a
is.
To make things concrete it is useful to have in mind a scalar ﬁeld, especially since Lindbladian evolution has been
shown to be renormalizable in this case[102] and the general case can be treated similarly. However, the procedure
we outline can be generalised to any quantum ﬁeld theory. We have 25
H(m)(x) = 1
2

g−1/2πφ(x)2 + √ggab∇aφ(x)∇bφ(x) + √gm2φ(x)2 −4√gΛcc

(95)
H(m)
a
(x) = πφ(x)∇aφ(x)
(96)
For the discrete evolution, we can now decompose the Hamiltonian as in Equation (92), with the metric degrees of
freedom included in hαβ(g, π; x).
hππ(x) := g−1/2,
hφφ(x) := √g,
hab(x) := √ggab,
hΛΛ = √g,
(97)
with the rest zero, leaving the Lindblad operators as
Lπ(x) =
1
√
2π(x),
Lφ(x) = m
√
2φ(x),
La(x) =
1
√
2∂aφ(x),
LΛ =
√
2Λ|Λ⟩⟨Λ|
(98)
24 For the continuous master equation, which we will consider elsewhere, we use Lindblad operators Lij(x) = δH(m)(x)/δgij, H(m)(x)
and L0 = 1.
25 More rigorously, for any Cauchy surface we deﬁne observables in terms of a smearing function F(x, t) and φ[F] :=
R
dxdtφ(x, t)F(x, t)
over a small interval in time. We then have the covariant commutation relations [φ[F], φ[G]] = ∆(F, G) where ∆is the Pauli-Jordan
function. This can be used to deﬁne the algebra of observables for operators (□+ m2)φ = 0, φ[(□+ m2)F] = 0. Then we use the GNS
theorem to relate the algebraic states to the Hilbert space. See for example [107–110]. In general, care must be taken in deﬁning the
algebra of observables for quantum ﬁelds in evolving space times, or in the case of some time dependent Hamiltonians[111–113].

21
Note that the hαβ(g, π; x) do not include the N pre-factor, since we will be using it to apply the constraint equation,
however, when we look at the dynamical equations of motion we will need to include it. We have chosen a simple
form for LΛ, but a priori, other choices are possible, for example, the shift operator. Their particular dependence is
not important in terms of the broad outline of this discussion, rather, what is important is that we can decompose
H(m)(x) in terms of local ﬁeld operators. The expansion of the Supermomentum in terms of local operators could be
treated similarly, with
Lπ(x) = π(x),
La(x) = ∂aφ(x),
L1 = 1 .
(99)
Note that H(m)
a
(x) has no metric dependence, and except for h00(g, π; x), hαβ(g, π; x) depends only on the 3-metric,
and not on πab, and we will restrict ourselves to this ”minimally coupled” case.
We could in some situations expand the ﬁeld operators in terms of raising and lowering operators b⃗p(g),b†
⃗p(g) to
obtain
Z
d3xN(x)H(m)(x) = 1
2
Z
d3p
(2π)3 ω⃗p

b†
⃗p(g)b⃗p(g) + b⃗p(g)b†
⃗p(g)

(100)
where b⃗p(g) is chosen to annihilate the vacuum of the space-time deﬁned by the metric gab and we have dropped
the cosmological constant term for simplicity. In a ﬁxed background for example, the Lindblad equation using the
Lindblad operators of Equation(98) are equivalent to those of Equation (100). In this way, one sees the covariance of
the master equation, however for general dynamical space-times an expansion of local operators in terms of creation
and annihilation operators is not possible and we will use local Lindblad operators such as those of Equation (98).
The dynamical equations of motion are generated by the cq-ADM Hamiltonian
HADM[N, ⃗N] =
Z
d3x
 NH(x) + N aHa(x)

(101)
with H(x) and Ha(x) given by Equations (92) and (94).
Invariance of the dynamics under the choice of lapse
and shift places strong constraints on the dynamics. It requires that the stochastic part of the master equation,
be generated by NW αβ
h (¯z|¯z −∆; x, y). I.e. that the model be linear in the sense that W αβ
Nh(¯z|¯z −∆; x, y) can be
replaced by NW αβ
h (¯z|¯z −∆; x, y) and W αβ
Napa(¯z|¯z −∆; x, y) by NaW αβ
pa (¯z|¯z −∆; x, y). 26. We will not restrict ourself
to a particular realisation of W αβ
h (¯z|¯z −∆; x, y) and W αβ
pa (¯z|¯z −∆; x, y) at this point, but we will assume that the
realisation satisﬁes this linear condition and then present realisations which have this property.
We thus have the master equation
∂ϱ(g, π)
∂t
=
Z
d3xN{H, ϱ(¯z)} +
Z
d3xN a{Ha, ϱ(¯z)} −i
Z
d3xNhαβ[L†
β(x)Lα(x), ψ] −i
Z
d3xN apαβ
a [L†
β(x)Lα(x), ψ]
+
Z
d3xd3yD∆
h
NW αβ
h (¯z|¯z −∆; x, y)Lα(x)ϱ(¯z −∆)L†
β(y) −1
2NW αβ
h (¯z; x, y){L†
β(y)Lα(x), ψ}+
i
+
Z
d3xD∆
h
NaW αβ
pa (¯z|¯z −∆; x, y)Lα(x)ϱ(¯z −∆)L†
β(y) −1
2NaW αβ
pa (¯z; x, y){L†
β(y)Lα(x), ψ}+
i
(102)
where we write ¯z when gab(x),πab(x) are too cumbersome and have absorbed the bare term λαβ(¯z; x, y) into
W αβ(¯z|¯z′; x, y). The ﬁrst two terms corresponds to the deterministic classical evolution associated with the Lindblad
operators L0(x) = 1 which we separate out for convenience. The dynamics associated with this classical part could
be stochastic, and could a priori include jumping or diﬀusion terms as well as friction terms. We take such terms to
be included in W 00
h (¯z|¯z −∆; x). Because they are associated with L0 they do not need to be positive.
The next two terms of Equation (102) are the commutators of the components of the energy-momentum tensor,
describing how quantum matter evolves in space-time. Finally, we have the interaction terms between gravity and
matter which must be stochastic. As shorthand, we will denote Equation (102) by
∂ϱ(g, π)
∂t
= LHADM ϱ(g, π)
=
Z
d3x

N(x)L(x)ϱ(g, π) + N a(x)La(x)ϱ(g, π)

(103)
26 In the same way that one can replace {NH, ρ} by N{H, ρ} in the classical case, when the constraint H ≈0 is satisﬁed, see [114] for
further discussion. In what follows, we take the lapse and shift outside the functional derivatives under the assumption that they either
have no explicit metric dependence, or the constraints are satisﬁed. The constraints in this theory will not be those of GR, but must be
modiﬁed.

22
Because H(m)
a
(x) has no metric dependence, the evolution along N a can be pure Lindbladian or purely deterministic
In [114], we argue that gauge invariance requires the latter, i.e. that W αβ
pa (¯z|¯z −∆; x, y) = W αβ
pa (¯z; x, y) = 0. Equation
(102) then simpliﬁes to
∂ϱ(g, π)
∂t
=
Z
d3x
h
N{H, ϱ(¯z)} + N a{Ha, ϱ(¯z)} −i
Z
d3xN[H(m)(x), ϱ] −i
Z
d3xN a[H(m)
a
(x), ϱ]
+
Z
d3xND∆
h
W αβ
h (¯z|¯z −∆; x)Lα(x)ϱ(¯z −∆)L†
β(x) −1
2W αβ
h (¯z; x){L†
β(x))Lα(x), ϱ}+
i
(104)
This should be thought of us the fundamental dynamical equation, but we can perform a Kramers-Moyal expansion
on it. Since we expect all moments to appear, the moment expansion will include terms such as δhαβ(¯z)
δgab
δϱ(¯z)
δπab since it
transforms like a density. This moment at zeroth order in τ is needed to recover the classical limit of general relativity.
We now require a positive transition matrix W αβ
h (¯z|¯z −∆; x, y) (except for the W 00
h (¯z|¯z −∆; x, y) component), and
that each moment transform as a density to ensure invariance of the dynamics under spatial diﬀeomorphism. An
example of such a realisation for the discrete master equation is given in [114], namely for α, β ̸= 0,
Z
D∆NW αβ
h (¯z|¯z −∆; x)Lα(x)ϱ(¯z −∆)L†
β(x) = N
τ exp
h
τ(h−1)(¯z; x){h(¯z; x), ·}
iα
γhβγ(¯z; x)Lα(x)ϱ(¯z)L†
β(x)
(105)
where exp[M]α
γ are the components of the matrix exponential of the matrix M and it is purely local in x. Here, M has
components M k
i =
h
τ(h−1)ij(¯z; x){hjk(¯z; x), ·}
i
and W αβ(¯z; x) = 1
τ hαβ(¯z; x). and gives a Kramers-Moyal expansion,
up to constants of
Z
W αβ
h (¯z|¯z −∆; x)ϱ(¯z −∆)D∆= 1
τ hαβ(gab; x)ϱ(¯z) + δhαβ(¯z; x)
δgab
δϱ(¯z)
δπab −δhαβ(¯z; x)
δπab
δϱ(¯z)
δgab
+ τDabcd,αβ(g; x) δ2ϱ(¯z)
δπabδπcd + · · ·
(106)
where the diﬀusion terms Dabcd,αβ(g; x), and all higher order moments are tensor densities of the appropriate weight
to contract with the derivatives acting on the density matrix. The absence of functional derivatives with respect to
g, higher than δϱ/δgab means that this is a Brownian realisation . Equation (84) is unmodiﬁed and we only have
diﬀusion in π. Higher order functional derivatives in π can be suitably smeared to control divergences. If we want to
ensure that our evolution equation is invariant under canonical transformations, we can express it in terms of Poisson
brackets, with the second order term being written for example, as {Jo, {Ji, ϱ(¯z)}}.
There is more freedom when it comes to W 00
h (¯z|¯z −∆; x, y) which could include dispersion terms, non-Brownian
terms, or even friction terms such as those of the form
δγijϱ
δπij(x),
γij(x) := ηijkl(x)
δH
δπkl(x)
(107)
with ηijkl a local function of the metric, and γij(x). However, gauge invariance places strong restrictions on these
terms, and here we leave them unspeciﬁed and denote them by the diﬀerential operator Γ00(x)ϱ.
The resulting
evolution law is
∂ϱ(¯z)
∂t
=
Z
d3x
h
N{H, ϱ(¯z)} + N a{Ha, ϱ(¯z)} −i
Z
d3xN[H(m), ϱ(¯z)] −i
Z
d3xN a[H(m)
a
, ϱ(¯z)]
+
Z
d3x1
τ Nhαβ(g; x)
h
Lα(x)ϱ(¯z)L†
β(x) −1
2{L†
β(x)Lα(x), ϱ(¯z)}+
i
+
Z
d3xNΓ00(x)ϱ(¯z)
+
Z
d3xN
hδhαβ(¯z; x)
δgab(x) Lα(x)δϱ(¯z)
δπab L†
β(x) + τDabcd,αβ
π
(g; x)
δ2
δπabπcd + · · ·
(108)
If we trace out the quantum system, then dropping terms of second order and higher we are left with
∂ρ(g, π)
∂t
=
Z
d3xN{H(x), ρ} +
Z
N ad3x{Ha(x), ρ} +
Z
d3x√g tr N{H(m)(x), ϱ} + · · ·
(109)
which, when the constraints of GR are satisﬁed, is the classical Liouville equation for general relativity sourced by
quantum matter. We thus see that in the classical limit we recover Einstein’s equations.

23
A realisation which gives the continuous master equation will be discussed in [115] (see also [87]) and is given by
∂ϱ(g, π, t)
∂t
=
Z
dxN{H(x), ϱ} +
Z
dxN a{Ha(x), ϱ} −i
h
H(m)[N, ⃗N], ϱ
i
+ 1
2
Z
dxN

{H(m)(x), ϱ} −{ϱ, H(m)(x)}

+ 1
2
Z
dxdyNλµνστ(g; x, y) [Lµν(x), [ϱ, Lστ(y)]] + 1
2
Z
dxdyDαβ
2 (x, y)N{J′
α(g; y, x), {Jβ(g; x, y), ϱ}}
(110)
when the constraints are satisﬁed. Here, Lij(x) := δH(m)(x)
δgij
, Lnn(x) := H(m)(x), and the pure Lindbladian cou-
plings λµνστ(g; x, y) consist of submatrices with elements27 λijkl := D0,ijkl(g; x, y), λijnn(g; x, y), λnnkl(g; x, y) and
the constant λnnnn(g; x, y).
The condition for complete positivity can be found from Equation (77).
Denoting
the generalised inverse of the matrix D0(g; x, y) as D−1
0 , we require that the matrix with elements Dijkl
0
(x, y) and
Dαβ
2
δJ′
α(g;x,y)
δgij
δJβ(g;x,y)
δgkl
−
 D−1
0
ijkl (x, y) be positive semi-deﬁnite as a matrix and kernel to guarantee complete posi-
tivity of the master equation. Dαβ
2 (x, y), Jα(N, ⃗N, g; x, y) and D0,ijkl(N, ⃗N, g; x, y) are chosen so that the realisation
is linear in the lapse and shift28. This realisation has the clear advantage of being continuous, while the former
realisation has the advantage of being linear in the Hamiltonian.
In terms of the evolution of the quantum system, for each classical space-time manifold, the quantum system
undergoes both decoherence, as well as unitary evolution generated by the Hamiltonian, as well as quantum jumps
which are accompanied by a back-reaction on the space-time. The diﬀusion terms imply that the solution of Equations
(108) and (110) (or alternatively (110)) should be a Gaussian when we trace out the quantum system. This presents
a testable deviation from classical general relativity, potentially observable when the other terms are small, such as
at low acceleration. The absence of such terms is likely to falsify this model. On the other hand since diﬀusion of
the metric can result in stronger gravitational ﬁelds when we might otherwise expect none to be present, it raises
the possibility that diﬀusion may explain galaxy rotation curves[116] and galaxy formation without the need for dark
matter.
In addition to the dynamical equation of motion, Equation (102) or (108), we need to impose the constraints of
general relativity. Let us recall how this is done classically. There, the Hamiltonian and momentum constraint of
Equation (87) follows from demanding that the Lagrangian be invariant under arbitrary time reparametrizations, and
spatial diﬀeomorphisms. This leads to the primary constraints, pN = 0 and pNi = 0. Here, these are just constraints
on the classical phase space, and so we can constrain ρ to lie in the surface on phase space where they are zero.
Preservation of the primary constraints is implemented in the ADM formalism by requiring that ˙pN = 0 and
˙
pNa = 0
(the Supermomentum and Superhamiltonian constraints).
Were we to impose the constraint in an equivalent manner here, it would amount to demanding that HADM be
invariant under the action of PN and PNa. This would lead to a Hamiltonian constraint of the form
H(x) + 16πGH(m)(x)
?≈0
(111)
which would be impossible to satisfy, since it contains both a classical term and a local quantum operator.
However, such a constraint is not needed – rather, we should instead ask, what restrictions are required such that
the equations of motion satisfy the required symmetry. In the classical case, we demand that physical degrees of
freedom do not depend on the choice of lapse N and shift N a i.e. that these are gauge choices. This requirement
necessarily leads to the constraints of general relativity. Likewise here, we should not ﬁrst demand that the constraints
be satisﬁed, but rather, require that the equations of motion be invariant under the choice of lapse and shift. This
turns out to lead to modiﬁed constraints which are not of the form (111). We discuss how the constraints can be
generated from gauge invariance of the equations of motion in [114]. Invariance of the equations of motion under
spatial diﬀeomorphisms is already guaranteed as the evolution equation involves only integrals over scalar densities.
In order to ﬁnd a solution to the dynamical and constraint equations, we need the equations to be compatible.
Attempts to quantise gravity have ﬂoundered on this point, as the constraints are operators and typically don’t
commute, so no simultaneous solution of the constraints exist. This is the case in loop quantum gravity, although it
is hoped that one can ﬁnd an operator ordering such that the constraints close. Likewise string theory is background
27 Greek indices are akin to space-time indices µ = n, i, and we use n instead of 0 since 0 already corresponds to the 1 Lindblad operator.
28 If
we
take
the
Jα
to
be
local
in
the
metric,
the
simplest
case
is
then
√g,
so
that
the
diﬀusion
term
is
1
2
R
dxdyN(x)D2(x, y)
p
g(x)
p
g(y)gij(x)gkl(y)
δϱ
δπij(x)δπkl(y) +· · · , but there are other more complicated realisations which also recover
the dynamical Einstein’s equation as a limited case (by adding friction and additional diﬀusion terms for example). The additional
Lindbladian couplings corresponding to the Lindblad operator H(m)(x) are not needed in order to reproduce general relativity in the
classical limit, nor to preserve positivity, but instead appear to be required by gauge invariance. The constraint equations for this
realisation are derived in [115] by following the procedure outlined in [114].

24
dependent, which presumably means that in the full theory, gauge invariance is broken.
While it is hoped that
frameworks for String Field Theory could result in a background independent approach, it’s not clear that whether
this can be maintained. Here, we also require constraint compatibility, but it takes on a diﬀerent form. Because
we have attempted to implement gauge invariance on the level of the equations of motion rather than as operator
identities, the relevant notion of constraint compatibility is not simply the commutation of operators, but whether
the evolution operators and constraints and generators ”commute” with one another other when applied to the state.
In other words, we require for example
La(x)L(y)ϱ(¯z) −L(y)La(x)ϱ(¯z) ≈0
(112)
and similarly we require that the ”commutation relations” for all other generators vanish on the constraint surface –
the right hand side must be a linear combination of generators and constraint equations. This notion of constraint
compatibility replaces the closure of the Dirac algebra in the classical theory.
This program is initiated in [114] in the Heisenberg representation to ﬁnd gauge invariant observables A. This
constraint structure, while involved, is far simpler than the constraint structure of loop quantum gravity or canonical
quantisation, and provides a model in which to understand some of the conceptual challenges these theories face.
While the constraints are more complicated because they are implemented on the level of equations of motion, the
classical nature of the gravitational ﬁeld means they don’t suﬀer from operator ordering issues and are more tractable.
VI.
DISCUSSION
We have here exhibited a theory of classical general relativity coupled to quantum ﬁeld theory which is invariant
under spatial diﬀeomorphisms. The theory is consistent – the dynamics is completely positive, norm preserving, and
linear in the density matrix. We have here speciﬁed the dynamics up to a choice of the positive semi-deﬁnite matrix
W αβ
h (¯z|¯z −∆; x, y). The choice is constrained by gauge invariance, and further criteria it must satisfy is given in [114].
Two particular choices of W αβ
h (¯z|¯z −∆; x, y), that of Equation (105) and that corresponding to Equation (110) are
considered in [114] and [115] along with the constraint equations which correspond to them. Both recover classical
general relativity as a limiting case.
The dynamics is such that the metric remains classical even when back-reacted upon by quantum ﬁelds, and this
has two important consequences. First, the interaction is necessarily stochastic, which we here take as an important
feature, given that the principle motivations behind the theory were attempts to resolve the black hole information
problem. That there exists a fully quantum theory of gravity has been an argument against theories which have
fundamental information loss. In the sense that given any such dynamics one can always ﬁnd a puriﬁcation of the
state, such that the full theory is unitary. As a result, information loss will be trivial, in the sense that it amounts
to a unitary theory with unknown coupling constants[47]. However, the argument in [47] need not apply here. Any
puriﬁcation which keeps some degrees of freedom classical would need to obey an unnatural condition, namely that
it remain of the form
ϱAB =
X
|g, π⟩A ⊗|g, π⟩B ⊗|ϱmatter(g, π)⟩AB
(113)
with system B being the purifying system 29. For these degrees of freedom to remain classical, one further needs to
impose the condition that one can only measure in the basis where |g, π⟩A is diagonal. If one lifts this restriction on
measurements, or allows dynamics more general than the one preserving the form of the state of Equation (113), then
it is far from clear that the dynamics would still be completely positive and trace-preserving. The dynamics here only
needs to give positive probabilities on measurements which commute with the basis representing the classical degrees
of freedom. It does not need to be give positive probabilities for all measurements. Thus we cannot conclude that
this theory has consistent dynamics on the puriﬁed state. The fact that the quantum system couples to a classical
one, provides a potential loophole to the no-go theorem of [47] ruling out non-trivial information destruction, while as
argued in the introduction, information destruction provides the loophole out of the no-go argument of Feynman and
Aharonov against quantum systems interacting with classical ones. The two no-go theorems annihilate each other.
The second consequence of having a quantum-classical interaction is that the measurement postulate of quantum
theory is no longer needed. One has fundamental decoherence of the quantum ﬁeld by the classical metric. In this
view, classicality is not an emergent or eﬀective property of large quantum systems, but rather, fundamental. In the
29 This puriﬁed state is reminiscent of the thermo-ﬁeld double state, so ubiquitous in discussions around the AdS/CFT correspondence.
It suggests that some of the apparent paradoxes[117–120] found in that context might be resolved by restricting measurements in this
manner.

25
discrete theory discussed here, hαβ is diagonal and unique for each Lindblad operator. As with the Stern-Gerlach
example, the accompanying jump in phase space unambiguously determines which Lindblad operator was applied to
the quantum state. If we know the initial pure state of the quantum system, then by monitoring the classical system,
we know which sequence of Lindblad operators were applied to the quantum state and at what times. As such, the
quantum state conditioned on the classical degrees of freedom remains pure. This is ironic given the motivation of
obtaining dynamics which allowed for the destruction of information in black hole evaporation. The dynamics here,
while stochastic, can leave the quantum state pure – it is rather the classical degrees of freedom, which gain entropy.
This suggests that in black hole evaporation, and for discrete realisations where the Lindblad operators are uniquely
determined, the associated entropy is the entropy of the classical space-time. Since the formalism introduced here
allows one to study the back reaction of matter ﬁelds on the gravitational ﬁeld, there is hope that we can better
understand black holes, as well as other systems where gravity and quantum eﬀects are important.
Let us next address the objection to theories of information destruction due to Banks, Peskin and Susskind
(BPS)[45], which is that a local interaction which leads to decoherence, will violate energy conservation to such
a degree that it will contradict observation. The argument of BPS, is that if one has Lindbladian evolution with
Lindblad operators being local ﬁeld operators,
∂ϱ(¯z)
∂t
= −i[H(¯z), ϱ(¯z)] +
Z
d3xd3yDαβ
0 (x, y)

Lα(x)ϱ(¯z)L†
β(y) −1
2(¯z; x, y){L†
β(y)Lα(x), ϱ(¯z)}+

(114)
then energy will not be conserved whenever Dαβ
0 (x, y) has short range (decays rapidly with |x −y|). In essence,
local operators Lα(x) don’t commute with the Hamiltonian, and in the limit where Dαβ
0 (x, y) is a delta function, the
average rate of energy production contains terms which go as [Lα(x), [H, L†
β(x)]]. If we are initially in the vacuum,
this term will result in the creation of particles of energy up to the Planck scale. This in itself does not rule out such
theories, since one can make the Lindbladian coupling arbitrarily weak, or coupled to the curvature[49] so that the
eﬀect is weak in ﬂat space and strong near black holes. Both approaches are natural in the context of gravity, since
the coupling natural involves Newton’s constant G and the parameter τ. Nor does locality require Dαβ
0 (x, y) to be
short range – local observables will still evolve locally provided the Lα(x) are local operators, but if Dαβ
0 (x, y) doesn’t
fall oﬀfast enough with |x −y|, then correlations can be created over ﬁnite distances[45, 49]. Alternatively, one can
make the violations of energy conservation small by introducing a small violation of locality[50]. On a fundamental
level, this need not trouble us – if the dynamics is Lindbladian, there is no reason to expect energy conservation –
the dynamics isn’t unitary and so Noether’s theorem doesn’t apply. The generator of time-translations is not the
Hamiltonian but the Lindbladian30. However, at a minimum, one does have to ensure that the vacuum is stable
enough that it doesn’t contradict experimental observation.
In the context of the theories considered here, the situation is signiﬁcantly diﬀerent from the Lindbladian evolution
considered by BPS. First, the action of the Lindblad operators on the quantum ﬁeld is accompanied by a back action
on the classical degrees of freedom, and in particular, the gravitational degrees of freedom. While the argument of
BPS suggests there will be an increase in the expectation value of the energy density of the matter Hamiltonian
H(m)(x), this can be accompanied by a decrease in the energy of the classical system due to this back-reaction31.
In this case, this is the kinetic energy density Gijklπijπkl of the pure gravity part of the Superhamiltonian, H(x).
In the case of a discrete realisation of this theory, such as Equation (105), the action of the Lindblad operator is
accompanied by a jump in πij(x). Likewise, the diﬀusion term of the continuous realisation, Equation (110) acts on
the kinetic term of H(x) in the Heisenberg representation with an energy ﬂux
R
dyDijkl
2
(x, y)Gijkl(x) which can be
negative and state independent. Whether this back-reaction is enough to restore equilibrium or slow the production
of energy in the matter sector of the theory is an open question.
Secondly, in general relativity there is no local deﬁnition of energy. Instead, we have the Hamiltonian constraint,
which we can think of as describing what eﬀect energy has on the state of the system. The Superhamiltonian is
everywhere zero in the classical theory, and the total energy a boundary term. Whether energy is conserved in general
relativity is thus a more subtle question than in other theories, and in this context, the relevant question is whether
the Hamiltonian constraint is preserved in time. This becomes a question of compatibility of the constraint equations
and whether the algebroid of constraints closes. The question then, becomes whether the theory is gauge invariant,
and in what sense. Of course, the Hamiltonian constraint is not of the form Equation (111), and the full dynamics
are subtle, especially in light of gauge freedom. A fuller understanding of the algebroid of constraint equations thus
remains an open issue, with some initial progress reported in [114].
30 See [49, 105, 121, 122] for extensions of Noether’s theorem to semi-groups
31 We should recall however, that in classical-quantum theories, there is no energy operator in the usual sense, since the Hamiltonian is a
hybrid object

26
The classical-quantum theory has a number of experimental signatures. It predicts gravitational collapse of the
wave-function, which already a number of experiments are looking for[123–125], and with some suggestion of excess
noise in ultracold cantilever experiments[126]. It predicts stochastic, ﬁnite sized jumps or continuous diﬀusion of the
gravitational ﬁeld which might be detectable in the lab with current technology. The theory also predicts diﬀusion
which might be observable in astrophysical systems and in cosmology. The theory is highly constrained, especially
if τ = ℏ, since increasing the coherence time results in larger jumps and more diﬀusion. Finally, it predicts a null
result to recently proposed experiments to test the quantum nature of gravity [127, 128]. Here, space-time, as well
as gab, πab are taken to be continuous, while the jumps in phase space are not. It’s possible to imagine a theory in
which the metric is discrete or even space-time itself, however, there is no need to go this far in the present context.
Here, space-time is treated as fundamentally classical, but one could instead view this theory as simply the result
of taking the classical limit of the gravitational degrees of freedom of a quantum theory of gravity. In this case,
the present work provides a consistent way to explore this limit which does not suﬀer from the pathologies of the
semi-classical Einstein equation. This has been lacking in our investigation into how space-time reacts to quantum
systems. Whether the theory presented here is taken to be fundamental or not, the ability to consistently study
back-reaction eﬀects in cosmology and black-hole evaporation is an important application of the results presented
here. In this regard, care should be taken, since an eﬀective theory might violate our assumptions of Markovianity or
complete positivity at short time scales or when the gravitational degrees of freedom have not fully decohered.
Acknowledgements I would like to thank Dorit Aharonov, Robert Alicki, Sougato Bose, Lajos Diosi, Michal
Horodecki, Veronika Hubeny, David Jennings, Don Marolf, Lluis Masanes, Sandu Popescu, John Preskill, Benni
Reznik, Lenny Susskind, Bill Unruh, and groups 17 and 18 of PHAS3441 for interesting discussions. I would especially
like to thank Joan Camps, Barbara Soda, Carlo Sparaciara, and Zach Weller-Davies for helpful discussion clarifying
some of the points raised here. I am grateful to David Poulin for introducing me to Equation (5) and his comments on
an early version of the ADM realisation of the theory during the KITP QINFO17 program, as well as Lajos Diosi and
Antoine Tilloy for drawing my attention to their work. I’d also like to thank Lydia Marie Williamson for correcting
a number of typos from an earlier version of this draft. This research was supported by an EPSRC Established
Career Fellowship, a Royal Society Wolfson Merit Award, the National Science Foundation under Grant No. NSF
PHY11-25915 and by the Simons Foundation It from Qubit Network.
[1] G. Veneziano, Il Nuovo Cimento A (1965-1970) 57, 190 (1968).
[2] A. Sen, Phys. Lett., B 119, 89 (1982).
[3] A. Ashtekar, Physical Review Letters 57, 2244 (1986).
[4] E. Witten, Phys. Rev. D 46, 5467 (1992).
[5] L. Hardy, arXiv preprint gr-qc/0509120 (2005).
[6] O. Oreshkov, F. Costa, and ˇC. Brukner, Nature communications 3, 1 (2012).
[7] R. Lieu, Classical and Quantum Gravity 35, 19LT02 (2018).
[8] R. A. Norte, M. Forsch, A. Wallucks, I. Marinkovi´c, and S. Gr¨oblacher, Phys. Rev. Lett. 121, 030405 (2018).
[9] L. Smolin, General relativity and gravitation 16, 205 (1984).
[10] P. Simidzija, A. Kempf, and E. Martin-Martinez, Physics Letters B 816, 136208 (2021).
[11] Bohr, Niels and Leon Rosenfeld ([1933] 1983), ”On the Question of the Measurability of Electromagnetic Field Quantities”,
in John A. Wheeler and Wojciech H. Zurek (eds.), Quantum Theory and Measurement. Translated by Aage Petersen.
Originally published as ”Zur Frage der Messbarkeit der Elektromagnetischen Feldgr6ssen” (Mat.-fys. Medd Dan. Vid
Selsk. 12). Princeton: Princeton University Press, 479-522.
[12] C. M. DeWitt and D. Rickles, The role of gravitation in physics: Report from the 1957 Chapel Hill Conference, Vol. 5
(epubli, 2011) chapter 23, the Necessity of Gravitational Quantization, contains arguments by Feynman, Wheeler, De
Witt, Salecker, Rosenfeld and others.
[13] B. S. DeWitt, Journal of Mathematical Physics 3, 619 (1962).
[14] K. Eppley and E. Hannah, Foundations of Physics 7, 51 (1977).
[15] J. Caro and L. Salcedo, Physical Review A 60, 842 (1999).
[16] L. Salcedo, Physical Review A 54, 3657 (1996).
[17] D. Sahoo, Journal of Physics A: Mathematical and General 37, 997 (2004).
[18] D. R. Terno, Foundations of Physics 36, 102 (2006).
[19] L. Salcedo, Physical Review A 85, 022127 (2012).
[20] C. Barcel´o, R. Carballo-Rubio, L. J. Garay, and R. G´omez-Escalante, Physical Review A 86, 042120 (2012).
[21] C. Marletto and V. Vedral, npj Quantum Information 3, 29 (2017).
[22] M. P. M¨uller, J. Oppenheim, and O. C. Dahlsten, Journal of High Energy Physics 2012, 1 (2012).
[23] C. Møller et al., Colloques Internationaux CNRS 91 (1962).
[24] L. Rosenfeld, Nuclear Physics 40, 353 (1963).
[25] D. N. Page and C. Geilker, Physical Review Letters 47, 979 (1981).

27
[26] W. Unruh, in Quantum theory of gravity. Essays in honor of the 60th birthday of Bryce S. DeWitt (1984).
[27] S. Carlip, Classical and Quantum Gravity 25, 154010 (2008).
[28] R. P. Feynman, Feynman lectures on gravitation, edited by F. B. Morinigo, W. G. Wagner,
and B. Hatﬁeld (1996)
pp10-11.
[29] Y. Aharonov and D. Rohrlich, Quantum Paradoxes: Quantum Theory for the Perplexed (Wiley-VCH, 2003) pp212-213.
[30] A. Mari, G. De Palma, and V. Giovannetti, Sci. Rep. 6, 22777 (2016), arXiv:1509.02408 [quant-ph].
[31] G.
Baym
and
T.
Ozawa,
Proceedings
of
the
National
Academy
of
Sciences
106,
3035
(2009),
http://www.pnas.org/content/106/9/3035.full.pdf.
[32] A. Belenchia, R. Wald, F. Giacomini, E. Castro-Ruiz, ˇC. Brukner, and M. Aspelmeyer, arXiv preprint arXiv:1807.07015
(2018).
[33] A. Kent, arXiv preprint arXiv:1807.08708 (2018).
[34] L. Diosi, arXiv preprint quant-ph/9503023 (1995).
[35] J. Mattingly, Physical Review D 73, 064025 (2006).
[36] B. L. Hu and E. Verdaguer, Living Reviews in Relativity 11, 3 (2008).
[37] S. W. Hawking, Phys. Rev. D 14, 2460 (1976).
[38] S. W. Hawking, Communications in Mathematical Physics 87, 395 (1982).
[39] For background reading, we refer the reader to the review of John Preskill, hep-th/9209058.
[40] A. Almheiri, D. Marolf, J. Polchinski, and J. Sully, Journal of High Energy Physics 2013, 1 (2013).
[41] S. L. Braunstein, arXiv preprint arXiv:0907.1190v1 (2009).
[42] B. Unruh, “untitled,” (2013), Black Holes: Complementarity, Fuzz, or Fire?
[43] W. G. Unruh and R. M. Wald, Reports on Progress in Physics 80, 092002 (2017).
[44] J. Ellis, J. S. Hagelin, D. V. Nanopoulos, and M. Srednicki, Nuclear Physics B 241, 381 (1984).
[45] T. Banks, M. E. Peskin, and L. Susskind, Nuclear Physics B 244, 125 (1984).
[46] D. J. Gross, Nuclear Physics B 236, 349 (1984).
[47] S. Coleman, Nuclear Physics B 307, 867 (1988).
[48] W. G. Unruh and R. M. Wald, Phys. Rev. D 52, 2176 (1995).
[49] J. Oppenheim and B. Reznik, Arxiv preprint arXiv:0902.2361 (2009), the manuscript was never submitted to a journal,
but an updated version is available upon request.
[50] D. Poulin and J. Preskill, “Information loss in quantum ﬁeld theories,” (2017), Frontiers of Quantum Information Physics,
KITP.
[51] W. Boucher and J. Traschen, Physical Review D 37, 3522 (1988).
[52] I. Aleksandrov, Zeitschrift f¨ur Naturforschung A 36, 902 (1981).
[53] V. I. Gerasimenko, Theoretical and Mathematical Physics 50, 49 (1982).
[54] L. Di´osi, N. Gisin, and W. T. Strunz, Physical Review A 61, 022108 (2000).
[55] A. Anderson, Physical review letters 74, 621 (1995).
[56] R. Kapral and G. Ciccotti, The Journal of chemical physics 110, 8919 (1999).
[57] R. Kapral, Annu. Rev. Phys. Chem. 57, 129 (2006).
[58] O. V. Prezhdo and V. V. Kisil, Physical Review A 56, 162 (1997).
[59] L. Diosi, Physics letters A 120, 377 (1987).
[60] R. Penrose, Philosophical transactions-royal society of London series a mathematical physical and engineering sciences ,
1927 (1998).
[61] L. P. Pitaevskii, Sov. Phys. JETP 13, 451 (1961).
[62] E. P. Gross, Il Nuovo Cimento (1955-1965) 20, 454 (1961).
[63] N. Gisin, Helv. Phys. Acta 62, 363 (1989).
[64] J. Jauch, Helv. Phys. Acta 37, 293 (1964).
[65] L. Di´osi and J. J. Halliwell, Physical review letters 81, 2846 (1998).
[66] A. Peres and D. R. Terno, Physical Review A 63, 022101 (2001).
[67] D. Kafri, J. Taylor, and G. Milburn, New Journal of Physics 16, 065020 (2014).
[68] A. Tilloy and L. Di´osi, Physical Review D 93, 024026 (2016).
[69] A. Tilloy and L. Di´osi, Physical Review D 96, 104045 (2017).
[70] F. Dowker and Y. Ghazi-Tabatabai, Journal of Physics A: Mathematical and Theoretical 41, 205306 (2008).
[71] P. Pearle, Phys. Rev. A 39, 2277 (1989).
[72] G. Ghirardi, A. Rimini,
and T. Weber, in Quantum Probability and Applications, L. Accardi et al. (eds) (Springer,
Berlin., 1985).
[73] G. C. Ghirardi, A. Rimini, and T. Weber, Phys. Rev. D 34, 470 (1986).
[74] N. Gisin and I. C. Percival, Proc. R. Soc. London Ser. A 447, 189N (1992).
[75] S. L. Adler and T. A. Brun, Journal of Physics A: Mathematical and General 34, 4797 (2001).
[76] F. Karolyhazy, Il Nuovo Cimento A (1965-1970) 42, 390 (1966).
[77] L. Di´osi, Physical Review A 40, 1165 (1989).
[78] R. Penrose, General relativity and gravitation 28, 581 (1996).
[79] M. J. Hall and M. Reginatto, Physical Review A 72, 062109 (2005).
[80] P. Blanchard and A. Jadczyk, Annalen der Physik 507, 583 (1995), https://arxiv.org/abs/hep-th/9409189.
[81] V. Gorini, A. Kossakowski, and E. C. G. Sudarshan, Journal of Mathematical Physics 17, 821 (1976).
[82] G. Lindblad, Comm. Math. Phys. 48, 119 (1976).

28
[83] D. Poulin, (2017), private communication (result announced in [50]).
[84] L. Di´osi, Physica Scripta 2014, 014004 (2014).
[85] R. Alicki and S. Kryszewski, Physical Review A 68, 013809 (2003).
[86] L. Di´osi, in Journal of Physics-Conference Series, Vol. 306 (2011) p. 012006.
[87] J. Oppenheim, B. Soda, C. Sparaciari, and Z. Weller-Davies, “Gravitationally induced decoherence vs space-time diﬀusion:
testing the quantum nature of gravity,” Manuscript in preparation.
[88] D. Frauchiger and R. Renner, arXiv preprint arXiv:1604.07422 (2016).
[89] R. Arnowitt, S. Deser, and C. W. Misner, General Relativity and Gravitation 40, 1997 (2008).
[90] K. Kraus, Phys. Rev. D 35, 3070 (1987).
[91] I. Siemon, A. S. Holevo, and R. F. Werner, Open Systems & Information Dynamics 24, 1740015 (2017).
[92] For a review, see for example, Quantum Dynamical Semigroups and Applications, R. Alicki and K. Lendi, Springer (2007),
and The Theory of Open Quantum Systems, H.-P. Breuer and F. Petruccione, Oxford University Press (2002).
[93] H. A. Kramers, Physica 7, 284 (1940).
[94] J. Moyal, Journal of the Royal Statistical Society. Series B (Methodological) 11, 150 (1949).
[95] R. Pawula, Phys. Rev. 162, 186 (1967).
[96] J. Oppenheim, B. Soda, C. Sparaciari, and Z. Weller-Davies, “Objective trajectories in hybrid classical-quantum dynam-
ics,” (2020), https://arxiv.org/abs/2011.06009.
[97] A. Shimony, in PSA: Proceedings of the Biennial Meeting of the Philosophy of Science Association, Vol. 1990 (Philoso-
phy of Science Association, 1990) pp. 49–59.
[98] For a review, see for example http://plato.stanford.edu/entries/qm-collapse/.
[99] M. Srednicki, Nucl. Phys. B410, 143 (1993), arXiv:hep-th/9206056.
[100] R. Alicki, M. Fannes, and A. Verbeure, Journal of Physics A: Mathematical and General 19, 919 (1986).
[101] D. Beckman, D. Gottesman, M. Nielsen, and J. Preskill, Physical Review A 64, 052309 (2001).
[102] A. Baidya, C. Jana, R. Loganayagam, and A. Rudra, Journal of High Energy Physics 2017, 204 (2017), also, initial work
by Poulin and Preskill (unpublished note).
[103] J. Oppenheim and Z. Weller-Davies, (2020), unpublished draft.
[104] S. Boyd, S. P. Boyd, and L. Vandenberghe, Convex optimization (Cambridge university press, 2004) appendix A.5.5.
[105] A. Holevo, Journal of Mathematical Physics 37, 1812 (1996).
[106] B. S. DeWitt, Physical Review 160, 1113 (1967).
[107] R. Brunetti, K. Fredenhagen, and R. Verch, Communications in Mathematical Physics 237, 31 (2003).
[108] C. J. Fewster and R. Verch, in Annales Henri Poincar´e, Vol. 13 (Springer, 2012) pp. 1613–1674.
[109] K. Fredenhagen and F. Lindner, Communications in Mathematical Physics 332, 895 (2014).
[110] K. Fredenhagen and K. Rejzner, Journal of Mathematical Physics 57, 031101 (2016).
[111] M. Asorey, J. F. Carinena, and M. Paramio, Journal of Mathematical Physics 23, 1451 (1982).
[112] C. G. Torre and M. Varadarajan, Classical and quantum gravity 16, 2651 (1999).
[113] I. Agullo and A. Ashtekar, Physical Review D 91, 124010 (2015).
[114] J. Oppenheim and Z. Weller-Davies, “The constraints of post-quantum classical gravity,” (2020).
[115] J. Oppenheim, “The constraints of a continuous realisation of hybrid classical-quantum gravity,” Manuscript in prepara-
tion.
[116] V. C. Rubin and W. K. Ford Jr, The Astrophysical Journal 159, 379 (1970).
[117] D. Marolf and A. C. Wall, Classical and Quantum Gravity 30, 025001 (2012).
[118] K. Papadodimas and S. Raju, Physical Review D 89, 086010 (2014).
[119] D. L. Jaﬀeris, arXiv preprint arXiv:1703.01519 (2017).
[120] J. Oppenheim, “Does ads/cft have an ensemble ambiguity problem?”
(2016), unpublished note, partially presented at
the It from Qubit Annual Meeting, Simons Foundation headquarters, New York, December 8, 2016.
[121] J. C. Baez and B. Fong, Journal of Mathematical Physics 54, 013301 (2013).
[122] I. Marvian and R. W. Spekkens, Nature communications 5, 3821 (2014).
[123] A. Bassi, K. Lochan, S. Satin, T. P. Singh, and H. Ulbricht, Reviews of Modern Physics 85, 471 (2013).
[124] J. Schm¨ole, M. Dragosits, H. Hepach, and M. Aspelmeyer, Classical and Quantum Gravity 33, 125031 (2016).
[125] D. Carney, P. C. Stamp, and J. M. Taylor, arXiv preprint arXiv:1807.11494 (2018).
[126] A. Vinante, R. Mezzena, P. Falferi, M. Carlesso, and A. Bassi, Physical review letters 119, 110401 (2017).
[127] S. Bose, A. Mazumdar, G. W. Morley, H. Ulbricht, M. Toroˇs, M. Paternostro, A. A. Geraci, P. F. Barker, M. Kim, and
G. Milburn, Physical review letters 119, 240401 (2017).
[128] C. Marletto and V. Vedral, Physical review letters 119, 240402 (2017).
[129] A. Kossakowski, Bull. Acad. Polon. Sci. Math. 20, 1021 (1972).

29
Appendix A: Conditions for complete positivity of a CQ-map
Here we extend a theorem due to Kossakowski[129] for a cq-map E(t) to be completely positive on a separable
Hilbert space32. Let us consider all complete sets of projectors Pr(¯z) on the doubled Hilbert space HS ⊗HS and
classical degrees of freedom ¯z.
Theorem 1. L is a generator of continuous time, completely positive, Markovian evolution of ϱ(¯z) which preserves
R
d¯z tr ϱ(¯z) if and only if for all sets of orthogonal projectors {Pr(¯z)}:
tr Ps(¯z)L¯z|¯z′ ⊗1(Pr(¯z′)) ≥0
∀r ̸= s, ¯z, ¯z′
(A1)
tr Ps(¯z)L¯z|¯z′ ⊗1(Ps(¯z′)) ≥0
∀s, ¯z ̸= ¯z′
(A2)
Z
¯z
tr L¯z|¯z′ ⊗1(Pr(¯z′)) = 0
∀r, ¯z′
(A3)
where Lϱ(¯z) =
R
d¯z′L¯z|¯z′ϱ(¯z′)
As a consequence of the above, we automatically get
tr
Z
d¯z′δ(¯z −¯z′)Ps(¯z)L¯z|¯z′ ⊗1(Ps(¯z′)) ≤0 ∀s, ¯z
(A4)
since the probability conservation condition, Equation (A3) ensures that outward ﬂux from any Ps(¯z) contributes
negatively to the probability rate. The proof of Theorem 1 follows from writing
L¯z|¯z′ := lim
δt→0
E¯z|¯z′(δt) −1δ(¯z −¯z′)
δt
(A5)
where E(t)ϱ(¯z) =
R
d¯z′E¯z|¯z′(t)ϱ(¯z′), and using the fact that the map E¯z|¯z′ is completely positive, probability conserving
map if and only if
tr Ps(¯z)E¯z|¯z′ ⊗1(Pr(¯z′)) ≥0 ∀{Ps(¯z)}, {Pr(¯z′)}, ¯z, ¯z′
(A6)
and
X
¯z
tr E¯z|¯z′ ⊗1(Pr(¯z′)) = 1 ∀{Pr(¯z)}, r, ¯z′ .
(A7)
It follows that E¯z|¯z′ is trace non-increasing
E¯z|¯z′ ⊗1(Pr(¯z′)) ≤1
(A8)
Equation (A2) is an additional constraint on the quantum system not found in [129], although if one considers the
projector to also be on the classical degree of freedom, then it becomes subsumed by Equation (A1). From Kraus’s
theorem, we know that this implies that Λαβ(¯z|¯z′; t) in Equation (26) needs to be positive semi-deﬁnite in α, β for all
¯z, ¯z′.
Appendix B: Heisenberg representation
Equations (12) and (15) tells us how the classical-quantum state evolves. As with both quantum and classical
mechanics, there is an alternative ”Heisenberg” picture in which the state doesn’t evolve but the operators do. One
can easily derive the time evolution of operators in this representation, since it follows from demanding that for all
ϱ(¯z)
d
dt
Z
d¯z tr AS(¯z, t)ϱS(¯z) = d
dt
Z
d¯z tr AH(¯z, t)ϱH(¯z)
(B1)
32 see also [87] for a more complete proof using indicator functions.

30
where the subscript S indicates the Schr¨odinger representation, and H, the Heisenberg representation. Using this
and Equation (12) for the evolution of ϱS(¯z) leads to the Heisenberg evolution equation for the operator A(¯z, t) over
phase space
dAH(¯z, t)
dt
=∂AH(¯z, t)
∂t
+ i[H(¯z), AH(¯z, t)]
+
Z
d∆W αβ(¯z + ∆|¯z)L†
βAH(¯z + ∆, t)Lα −1
2W αβ(¯z){L†
βLα, AH(¯z, t)}+
=∂AH(¯z, t)
∂t
+ i[H(¯z), AH(¯z, t)] + W αβ(¯z)
h
L†
βAH(¯z, t)Lα −1
2{AH(¯z, t), L†
β(x)Lα}+
i
−L†
β{hαβ, AH(¯z, t)}Lα
i
+ · · ·
(B2)
where we have used cyclicity of operators under the trace, and integration by parts. We have included the purely
classical term in W 00 but for deterministic evolution, it would be −{H(¯z), AH(¯z, t)}. For a ﬁeld theory, and in general
relativity, we are usually interested in the evolution of diﬀeomorphism invariant operators such as
AH(¯z) =
Z
d3x√gA(¯z; x)
(B3)
where A(¯z; x) is a local scalar operator. In such a case, we have
dAH(¯z, t)
dt
=∂AH(¯z, t)
∂t
+ i[H(¯z), AH(¯z, t)]
+
Z
d3x
h
d∆W αβ(¯z + ∆|¯z; x, y)L†
β(y)AH(¯z + ∆, t)Lα(x) −1
2W(¯z; x, y){L†
β(y)Lα(x), AH(¯z, t)}+
i
=∂AH(¯z, t)
∂t
+ i[H(¯z), AH(¯z, t)] +
Z
W αβ(¯z; x, y)
h
L†
β(y)AH(¯z, t)Lα(x) −1
2{L†
β(y)Lα(x), AH(¯z, t)}+
i
d3x
−
Z
d3xL†
β(x){hαβ(¯z; x), AH(¯z, t)}Lα(x) + · · ·
(B4)
= Note that care must be taken here. While the Heisenberg representation allows one to compute how the expectation
value of an observable A will change with time, if the evolution is non-unitary, then it is not necessarily the case that
⟨An(t)⟩= ⟨A(t)⟩n. For example, if there is dispersion, than typically ⟨p2⟩−⟨p⟩2 will increase with time.

