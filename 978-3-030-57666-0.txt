Lecture Notes in Mathematics  2273
Shigeki Akiyama
Pierre Arnoux   Editors
Substitution and 
Tiling Dynamics: 
Introduction 
to Self-inducing 
Structures
CIRM Jean-Morlet Chair, Fall 2017

Lecture Notes in Mathematics
Volume 2273
Editors-in-Chief
Jean-Michel Morel, CMLA, ENS, Cachan, France
Bernard Teissier, IMJ-PRG, Paris, France
Series Editors
Karin Baur, University of Leeds, Leeds, UK
Michel Brion, UGA, Grenoble, France
Camillo De Lellis, IAS, Princeton, NJ, USA
Alessio Figalli, ETH Zurich, Zurich, Switzerland
Annette Huber, Albert Ludwig University, Freiburg, Germany
Davar Khoshnevisan, The University of Utah, Salt Lake City, UT, USA
Ioannis Kontoyiannis, University of Cambridge, Cambridge, UK
Angela Kunoth, University of Cologne, Cologne, Germany
Ariane Mézard, IMJ-PRG, Paris, France
Mark Podolskij, University of Luxembourg, Esch-sur-Alzette, Luxembourg
Sylvia Serfaty, NYU Courant, New York, NY, USA
Gabriele Vezzosi, UniFI, Florence, Italy
Anna Wienhard, Ruprecht Karl University, Heidelberg, Germany
More information about this series at http://www.springer.com/series/304


Shigeki Akiyama • Pierre Arnoux
Editors
Substitution and Tiling
Dynamics: Introduction
to Self-inducing Structures
CIRM Jean-Morlet Chair, Fall 2017

Editors
Shigeki Akiyama
Institute of Mathematics
University of Tsukuba
Tsukuba, Japan
Pierre Arnoux
Institut de Mathématiques de
Marseille (I2M)
Aix-Marseille University
Marseille Cedex 09, France
ISSN 0075-8434
ISSN 1617-9692
(electronic)
Lecture Notes in Mathematics
ISBN 978-3-030-57665-3
ISBN 978-3-030-57666-0
(eBook)
https://doi.org/10.1007/978-3-030-57666-0
Jointly published with Société Mathématique de France (SMF), Paris, France
Mathematics Subject Classiﬁcation: 37B10, 05B45, 37B50, 68R15, 52C23
© The Editor(s) (if applicable) and The Author(s), under exclusive license to Springer Nature Switzerland
AG 2020
This work is subject to copyright. All rights are solely and exclusively licensed by the Publisher, whether
the whole or part of the material is concerned, speciﬁcally the rights of translation, reprinting, reuse
of illustrations, recitation, broadcasting, reproduction on microﬁlms or in any other physical way, and
transmission or information storage and retrieval, electronic adaptation, computer software, or by similar
or dissimilar methodology now known or hereafter developed.
The use of general descriptive names, registered names, trademarks, service marks, etc. in this publication
does not imply, even in the absence of a speciﬁc statement, that such names are exempt from the relevant
protective laws and regulations and therefore free for general use.
The publisher, the authors, and the editors are safe to assume that the advice and information in this book
are believed to be true and accurate at the date of publication. Neither the publisher nor the authors or
the editors give a warranty, expressed or implied, with respect to the material contained herein or for any
errors or omissions that may have been made. The publisher remains neutral with regard to jurisdictional
claims in published maps and institutional afﬁliations.
This Springer imprint is published by the registered company Springer Nature Switzerland AG.
The registered company address is: Gewerbestrasse 11, 6330 Cham, Switzerland

v

Preface
Tilings have been drawn and studied for centuries, in art and science, from the
Sumerian patterns, Roman mosaics, Alhambra wall tilings (see Fig. 1), and the
attempts of Johannes Kepler to tile the plane with ﬁvefold symmetric patterns (see
Fig. 2), a goal which cannot be realized by a periodic tiling. These attempts were
one of the inspirations for the now-classic ﬁvefold Penrose tiling, see the Foreword
of Ref. [7] in Chap. 7.
The study of periodic tilings and their symmetry groups, the so-called crystal-
lographic group, was developed to understand the structure of physical crystals;
detailed account on the classiﬁcation of periodic tilings and their symmetries can
be found in the book by Grünbaum–Shephard (See Ref. [58] in Chap. 2), which still
contains a lot of interesting open questions and attracts many researchers. The book
Fig. 1 One of the many Alhambra wall tilings. Source: https://commons.wikimedia.org/wiki/File:
Tassellatura_alhambra.jpg
vii

viii
Preface
Fig. 2 Kepler Aa tiling: an
attempt to tile the plane with
ﬁvefold symmetric patterns.
Source: https://gallica.bnf.fr/
ark:/12148/btv1b26001687/
f4.item
also contains many examples of aperiodic tilings: however, they wrote at the time
“Unlike the material in the earlier sections of the book, many of our assertions here
are not supported by published proofs” because the subject was in its infancy when
[58] was published.
If early studies were devoted to periodic tilings, our main concern in this book
is the presentation of several recent developments in the study of aperiodic tilings.
One could say that the relation of aperiodic tilings to periodic tilings is similar to the
relation of irrational numbers to rational numbers and similarly opens a vast range
of new phenomena.
The modern theory of aperiodic tilings started in the beginning of the 1960s,
with the proof by Berger of the undecidability of the Domino problem, using
aperiodic tilings, followed by the invention of the Penrose tiling, the Heighway
dragon, and the Knuth–Davis twindragon, soon followed by the discovery of quasi-
crystals and the study of tiling spaces which are one of the basic examples of
non-commutative geometry. Self-similar tilings, like the Fibonacci and Penrose
tilings, were a fundamental element of this development. They have known many
generalizations, and the recent years have seen a number of advances in the domain.
This book presents lecture notes delivered at the research school Tiling dynamical
systems, one of the Morlet Chair events organized in the second semester of 2017 as
part of the program Tilings and Discrete Geometry organized by Shigeki Akiyma
during his invitation to CIRM as Morlet Chair Professor.
The simplest aperiodic tilings are deﬁned by substitutions; there are various types
of substitutions (these various types, and their generalizations, are a central theme

Preface
ix
in this book), but in the simplest form, a substitution consists of replacing each
letter of a ﬁnite alphabet by a word on this alphabet; the ﬁrst one is probably the
Fibonacci substitution, on the alphabet {a, b}, which replaces a by ab and b by a.
To this substitution, one can associate inﬁnite words which can be inﬁnitely recoded
by ﬁrst decomposing them in the words a and ab (which implies that bb does not
appear) and then replacing ab by a and a by b. The set of all these words is invariant
by the shift, and this deﬁnes an interesting discrete dynamical system associated
with the substitution, a substitutive dynamical system (see Fig. 3 for the associated
self-similar tiling). Tiling dynamical systems are continuous-time analogues of the
substitutive dynamical systems; these are tilings of the line (or the plane or space)
by a ﬁnite number of shapes (the tiles) that can be either subdivided (inﬂation)
in smaller similar tiles or regrouped (deﬂation) in larger similar tiles (see Fig. 4).
This leads to remarkable structures, like the celebrated Penrose tiling, with “self-
inducing” properties: they contain smaller and larger copies of themselves.
The main object of the research school, as well as of the whole semester,
was to study these self-inducing systems and tiling dynamical systems, and their
a
b
a
a
b
a
b
a
a
b
a
a
b
a
b
a
b
a
a
b
a
b
a
a
Fig. 3 The Fibonacci tiling, associated with the substitution a →ab, b →a
Fig. 4 Rauzy dragon: an example of a pseudo-self-similar structure, generated by a substitution
rule, or alternatively by a fusion rule. Source: courtesy of T. Fernique

x
Preface
generalizations, from many different points of views and to increase research
interactions among related people. The semester provided excellent opportunities
for research discussion among people working on discrete geometry, number theory,
fractal geometry, theoretical computer science, and dynamical systems.
The book consists of eight chapters, the ﬁrst six of which are expanded lecture
notes, and the last two of which are selected contributions.
Chapter 1, by B. Solomyak, is an introduction to the domain of tilings. It starts
by deﬁning the fundamental notions of Delone sets and Meyer sets, the Delone
sets with inﬂation symmetry and their number-theoretic properties (in relation with
Pisot and Perron numbers). It then studies the related substitution tilings and their
associated dynamical systems, clarifying the notions of self-afﬁne and pseudo-self-
afﬁne tilings and their properties. The last section presents some developments
(inﬁnite local complexity, pure discrete spectrum, and Fourier quasi-crystals) and
some open problems.
Chapter 2, by N. P. Frank, deals with the various models of tilings, from the
simplest, discrete tilings in one dimension (symbolic systems), to continuous tilings
of the line, discrete systems in higher dimension (Zd systems), and tilings in higher
dimension. It presents several ways to build systems with a hierarchical structure,
either the same at all levels (substitutive systems) or with rules varying with the level
(S-adic systems) and develops a new formalism, the fusion rule to build supertiles,
which regroups several different ways to build recurrent tilings with interesting
hierarchical properties; the properties of these tilings are studied from the dynamical
and the diffraction (Fourier analysis) perspectives, and this chapter also contains a
historical introduction of the spectral study of tiling generated by substitution.
Chapter 3, by J.Thuswaldner, discusses in depth S-adic systems and their
geometric realizations. S-adic symbolic systems are a natural generalization of
substitutive systems. They are systems which are generated by an inﬁnite sequence
of substitutions belonging to a ﬁnite set S. The most elementary case is that of
a rotation on a circle of unit length; a rotation by an irrational quadratic number
with periodic continued fraction has very particular diophantine properties (this is a
simple example of a self-induced dynamical system) and is the geometric realization
of a substitutive system determined by this periodic continued fraction. A circle
rotation by an irrational number, with an inﬁnite nonperiodic continued fraction is
inﬁnitely renormalizable, but not self-induced, and it is a geometric realization of a
corresponding S-adic system. Is the same thing true in higher dimension, for toral
rotations? In fact, it is almost always true in higher dimension. This is shown, in a
precise sense, by using properties of some generalized continued fractions.
The study of tiling dynamics is historically motivated by quasi-crystals: a real
material having long-range order but no translational periods. The recurrence
properties of quasi-crystals have been studied for a long time, in relation to the
diffraction spectrum and the spectral properties of the corresponding Schrödinger
operators. In pursuing these directions, topological properties of tiling dynamics
play an essential role. They determine, for instance, the labelling of the gaps in
the spectrum. The study of the topological invariants involves elements of non-
commutative geometry as developed by Connes. One of the ﬁrst examples of

Preface
xi
non-commutative spaces he proposed, the space of all Penrose tilings foliated by the
translation action, stands at the beginning of the developments described in Chap. 4.
In this chapter, J. Kellendonk gives an account on the construction of spaces,
dynamical systems and algebras for tilings, and how their topological invariants
help to understand the topological properties of the underlying material.
Chapter 5, by M. Rigo, deals with an apparently very different domain, that
of combinatorial games. These games provide an original introduction to the
historical relations between tilings and language theory, logics, and computer
science. The best-known combinatorial game is certainly the Nim game, where
each player takes out tokens from one or several piles of tokens, and the winner
is the player who takes the last token. Since the game is deterministic, there
are winning and losing positions; it turns out that this set of winning positions
has a remarkable structure, which can be determined by a ﬁnite automaton. It is
related to substitutive sequences, numeration systems, Pisot numbers, and to higher
dimensional extensions associated with tilings of Nd having interesting properties.
The birth of the modern theory of tilings is associated with the famous proof
by Berger of the undecidability of the Domino problem. In Chap. 6, E. Jeandel and
P. Vanier revisit this proof and give us a modern view of this problem, including
the necessary foundations on automata, Turing machines, and shift spaces. They
carefully expose four different proofs of the undecidability result. A crucial point
of any proof of the undecidability of the Domino problem is to exhibit a set of tiles
which can tile the plane, but only in an aperiodic way, and the authors emphasize on
the various constructions of these sets of tiles.
To a tiling space, one can associate a dynamical spectrum, coming from the Rd-
action by translation, which allows to deﬁne a spectral measure; one can also deﬁne
a diffraction measure, coming initially from physics, with close connections to the
spectral measure; these two types of spectra already appear in the ﬁrst two chapters.
Chapter 7 of the book, contributed by M. Baake and U. Grimm, deals with the
properties of these measures, and in particular with the question of the existence of
a nontrivial continuous or singular component. An essential element to answer this
question is the study of autocorrelation and the pair correlation function. Using this
technique, conditions are given to ensure that the diffraction measure is singular.
The last chapter, by P. Mercat and S. Akiyama, deals with the Pisot substitution
conjecture, one of the main open problems in the ﬁeld of substitutive tilings.
This conjecture, which has several forms and generalizations, says that any sub-
stitution dynamical system of irreducible Pisot type has pure discrete spectrum,
see Sect. 2.6.3.1 for more details (by contrast, when the inﬂation factor is not a
Pisot number, complicated behaviour such as inﬁnite local complexity become
possible, see Fig. 5, and also Fig. 2.6 of Chap. 2); it occurs in several chapters of
this book. Chapter 8 contains a noteworthy simple new characterization of subshifts
with a discrete spectrum, which is basically checkable by automata computation;
this gives an algorithm to verify that a given subshift of Pisot type satisﬁes the
Pisot conjecture. This characterization is shown to be an equivalence for subshifts
generated by irreducible Pisot substitutions and applies as well to S-adic systems.

xii
Preface
Fig. 5 The Frank–Robinson
tiling: an example of tiling
with a non-Pisot inﬂation
factor and inﬁnite local
complexity
We thank the lecturers for giving a series of introductory talks at CIRM as well
as providing us detailed expositions of this developing area. We believe that this
book will give a nice access to these subjects and plenty of research directions to
the related researchers.
Tsukuba, Japan
Shigeki Akiyama
Marseille, France
Pierre Arnoux
January–July 2020

Contents
1
Delone Sets and Dynamical Systems .......................................
1
Boris Solomyak
1.1
Introduction ............................................................
1
1.2
Delone Sets of Finite Type ............................................
2
1.3
Meyer Sets .............................................................
5
1.4
Inﬂation Symmetries ..................................................
7
1.5
Substitution Delone Sets and Substitution Tilings ...................
12
1.5.1
Substitution Delone m-Sets ...................................
12
1.5.2
Tilings and Substitution Tilings ..............................
14
1.5.3
Representable Delone m-Sets.................................
17
1.5.4
Characterization of Expansion Maps .........................
18
1.5.5
Pseudo-Self-Afﬁne Tilings....................................
19
1.6
Dynamical Systems from Delone Sets in Rd .........................
22
1.6.1
Eigenvalues of Delone Set Dynamical Systems .............
24
1.7
Concluding Remarks and Open Problems............................
25
1.7.1
Inﬁnite Local Complexity.....................................
26
1.7.2
Pure Discrete Spectrum .......................................
26
1.7.3
Fourier Quasicrystals..........................................
28
1.7.4
Open Problems (Expansion Maps) ...........................
29
References .....................................................................
29
2
Introduction to Hierarchical Tiling Dynamical Systems ................
33
Natalie Priebe Frank
2.1
Introduction ............................................................
33
2.1.1
Outline of the Paper ...........................................
36
2.1.2
Not Covered ...................................................
37
2.2
The Fundamental Objects .............................................
37
2.2.1
Motivation: Shift Spaces ......................................
37
2.2.2
Straightforward Generalization: Sequences in Zd ...........
38
2.2.3
Straightforward Generalization: Tilings of R ................
38
2.2.4
Geometric Generalization: Tilings of Rd ....................
39
xiii

xiv
Contents
2.3
The Dynamical Systems Viewpoint...................................
41
2.3.1
Tiling Spaces ..................................................
41
2.3.2
Notions of Equivalence for Symbolic and Tiling
Dynamical Systems ...........................................
43
2.3.3
Repetitivity and Minimality...................................
44
2.3.4
Invariant and Ergodic Measures..............................
45
2.4
Supertile Construction Techniques ...................................
46
2.4.1
Motivation: Symbolic Substitutions ..........................
46
2.4.2
Generalization: One-dimensional Self-Similar Tilings ......
48
2.4.3
More Tricky Generalization: Multidimensional
Constant-Length Substitutions in Zd .........................
49
2.4.4
Geometric Generalization: Self-Afﬁne, Self-Similar,
and Pseudo-Self-Similar Tilings ..............................
50
2.4.5
Fusion: A General Viewpoint .................................
54
2.4.6
Tiling Spaces from Supertile Methods .......................
63
2.4.7
Recognizability or the Unique Composition Property.......
64
2.5
Ergodic-Theoretic and Dynamical Analysis of Supertile
Methods ................................................................
65
2.5.1
Transition (a.k.a. Incidence, Substitution,
Abelianization, or Subdivision) Matrices ....................
65
2.5.2
Primitivity .....................................................
66
2.5.3
Ergodic Measures for Fusions ................................
70
2.5.4
General Result: Substitution Systems are Not
Strongly Mixing ...............................................
71
2.5.5
Fusion Rules with Various Properties ........................
71
2.6
Spectral Analysis of Supertile Methods: Dynamical Spectrum .....
72
2.6.1
The Koopman Representation ................................
73
2.6.2
Eigenfunctions.................................................
74
2.6.3
Pure Discrete Dynamical Spectrum ..........................
77
2.6.4
The Continuous Part of the Spectrum ........................
80
2.7
Spectral Analysis of Supertile Methods: Diffraction Spectrum .....
82
2.7.1
Autocorrelation for Symbolic Sequences ....................
83
2.7.2
Diffraction in Rd ..............................................
84
2.7.3
Intensities ......................................................
88
2.8
Connection Between Diffraction and Dynamical Spectrum .........
88
2.8.1
When the Diffraction is Not Pure Point ......................
89
2.9
For Further Reading ...................................................
90
References .....................................................................
90
3
S-adic Sequences: A Bridge Between Dynamics, Arithmetic,
and Geometry ................................................................
97
Jörg M. Thuswaldner
3.1
Introduction ............................................................
98
3.2
The Classical Case.....................................................
99
3.2.1
Sturmian Sequences and Their Basic Properties.............
99
3.2.2
The Classical Continued Fraction Algorithm ................ 103

Contents
xv
3.2.3
Dynamical Properties of Sturmian Sequences ............... 107
3.2.4
Sturmian Sequences Code Rotations ......................... 110
3.2.5
Natural Extensions and the Geodesic Flow
on SL2(Z) \ SL2(R)........................................... 116
3.3
Problems with the Generalization to Higher Dimensions ........... 122
3.3.1
Arnoux-Rauzy Sequences..................................... 122
3.3.2
Imbalanced Arnoux-Rauzy Sequences ....................... 124
3.3.3
Weak Mixing and the Existence of Eigenvalues ............. 127
3.4
The General Setting ................................................... 128
3.4.1
S-adic Sequences .............................................. 129
3.4.2
Generalized Continued Fraction Algorithms................. 132
3.5
The Importance of Primitivity and Recurrence....................... 134
3.5.1
Primitivity and Minimality.................................... 135
3.5.2
Recurrence, Weak Convergence, and Unique Ergodicity.... 136
3.6
The Importance of Balance and Algebraic Irreducibility ............ 142
3.6.1
S-adic Rauzy Fractals ......................................... 143
3.6.2
Balance, Algebraic Irreducibility, and Strong
Convergence ................................................... 148
3.7
Properties of S-adic Rauzy Fractals .................................. 152
3.7.1
Set Equations for S-adic Rauzy Fractals and Dual
Substitutions ................................................... 153
3.7.2
An S-adic Rauzy Fractal Is the Closure of Its Interior ...... 158
3.7.3
The Generalized Left Eigenvector ............................ 160
3.7.4
An S-adic Rauzy Fractal Has a Boundary of Measure
Zero ............................................................ 162
3.8
Tilings, Coincidence Conditions, and Combinatorial Issues ........ 165
3.8.1
Multiple Tiling and Inner Subdivision of the Subtiles....... 165
3.8.2
Coincidence Conditions and Tiling Properties............... 167
3.8.3
How to Check Geometric Coincidence and Geometric
Finiteness? ..................................................... 170
3.9
S-adic Systems and Torus Rotations.................................. 174
3.9.1
Statement of the Conjugacy Result ........................... 175
3.9.2
Proof of the Conjugacy Result ................................ 176
3.9.3
A Metric Result................................................ 178
3.9.4
Proof of the Metric Result .................................... 179
3.9.5
Corollaries for Arnoux-Rauzy and Brun Systems ........... 184
3.10
Concluding Remarks: Natural Extensions, Flows, and Their
Poincaré Sections ...................................................... 185
References ..................................................................... 186
4
Operators, Algebras and Their Invariants for Aperiodic Tilings....... 193
Johannes Kellendonk
4.1
Tilings and the Topology of Their Hulls.............................. 193
4.1.1
Basic Notions .................................................. 194
4.1.2
Undecorated Tilings ........................................... 194

xvi
Contents
4.1.3
Wang Tilings................................................... 195
4.1.4
Pattern Equivariant Functions and Local Derivability ....... 196
4.2
Operators from Tilings ................................................ 198
4.2.1
Tight Binding Operators ...................................... 198
4.2.2
Tight Binding Operators for Wang Tilings ................... 199
4.2.3
A Simple Class of One-dimensional Models ................ 200
4.2.4
Gaps and the Integrated Density of States ................... 203
4.3
Algebras for Tilings ................................................... 204
4.3.1
The Pattern Equivariant Approach............................ 204
4.3.2
The Groupoid Approach ...................................... 207
4.3.3
Crossed Products with Zd ..................................... 208
4.3.4
Extensions and Exact Sequences ............................. 210
4.4
K-Theoretic Invariants for Tilings .................................... 211
4.4.1
Short Deﬁnition of K-Theory ................................ 212
4.4.2
Calculating K-Groups for Tiling Algebras................... 214
4.4.3
Numerical Invariants for Pattern Equivariant Operators..... 216
4.5
Bulk Boundary Correspondence ...................................... 218
4.5.1
General Philosophy............................................ 218
4.5.2
The Toeplitz Extension as Half Space Algebra .............. 220
4.5.3
One-dimensional Examples................................... 221
References ..................................................................... 224
5
From Combinatorial Games to Shape-Symmetric Morphisms ......... 227
Michel Rigo
5.1
Introduction ............................................................ 227
5.2
Notation and Conventions ............................................. 228
5.3
Bits of Combinatorial Game Theory.................................. 230
5.4
Automatic and Regular Sequences.................................... 238
5.4.1
Generalities on Sequences and Morphisms .................. 238
5.4.2
Iterating a Constant-Length Morphism....................... 240
5.4.3
k-Kernel of a Sequence ....................................... 243
5.4.4
Changing the Base............................................. 245
5.4.5
k-Regular Sequences .......................................... 246
5.5
Characterizing P-Position of Wythoff’s Game
in Polynomial Time.................................................... 249
5.5.1
From Morphic Words to Automatic Words .................. 251
5.5.2
Positional Numeration Systems .............................. 255
5.5.3
Syntactic Characterization of P-Positions of
Wythoff’s Game ............................................... 257
5.6
Extension to a Multidimensional Setting ............................. 259
5.6.1
2-Regularity for Grundy Values of the Game of Nim ....... 264
5.6.2
Grundy Values of the Game of Wythoff...................... 266

Contents
xvii
5.7
Shape-Symmetry....................................................... 266
5.7.1
Abstract Numeration Systems ................................ 275
5.7.2
Multidimensional S-Automatic Sequences .................. 280
5.7.3
Proof of Theorem 5.7.14 ...................................... 282
5.8
Games with a Finite Set of Moves .................................... 284
5.9
Bibliographic Notes ................................................... 287
References ..................................................................... 288
6
The Undecidability of the Domino Problem .............................. 293
Emmanuel Jeandel and Pascal Vanier
6.1
Statement and Consequences ......................................... 294
6.1.1
Deﬁnitions and Statement..................................... 294
6.1.2
Algorithmic Consequences ................................... 294
6.1.3
Algorithms to Prove A Tileset Does Not Tile the Plane ..... 297
6.2
Main Ingredients in the Proofs ........................................ 303
6.2.1
Turing Machines............................................... 304
6.2.2
Encoding of Turing Machines in Tilings: The Fixed
Domino Problem .............................................. 309
6.2.3
Towards the Domino Problem ................................ 311
6.3
The Substitutive Method 1/2 .......................................... 312
6.3.1
Preliminary Discussion ....................................... 312
6.3.2
Substitutions ................................................... 313
6.3.3
Grids Inside Tilings ........................................... 317
6.3.4
Bibliographic Notes ........................................... 320
6.4
The Construction of Aanderaa and Lewis ............................ 321
6.4.1
Tiling Problems on One-dimensional Objects ............... 321
6.4.2
The Subshift Sp and p-Adic Numbers ....................... 327
6.4.3
Sp as a Toeplitz Subshift ...................................... 329
6.4.4
Sp × Sp as a Distance Shift................................... 331
6.4.5
Undecidability for Distance Shifts............................ 336
6.4.6
Bibliographic Notes ........................................... 337
6.5
The Construction of Kari .............................................. 338
6.5.1
Balanced Representations of Reals ........................... 338
6.5.2
Multiplying Balanced Representations ....................... 340
6.5.3
An Aperiodic Tileset .......................................... 342
6.5.4
Undecidability ................................................. 345
6.6
The Substitutive Method 2/2 .......................................... 347
6.6.1
The Fixed Point Theorem of Computability Theory......... 349
6.6.2
Simulating a Tileset with a Turing Machine ................. 350
6.6.3
A Fixedpoint Based Tileset ................................... 352
6.6.4
Undecidability ................................................. 353
6.6.5
Bibliographic Notes ........................................... 354
References ..................................................................... 355

xviii
Contents
7
Renormalisation of Pair Correlations and Their Fourier
Transforms for Primitive Block Substitutions ............................ 359
Michael Baake and Uwe Grimm
7.1
Introduction ............................................................ 359
7.2
Preliminaries ........................................................... 361
7.2.1
Logarithmic Integrals and Mahler Measures................. 362
7.2.2
Radon Measures ............................................... 362
7.2.3
Riesz Products ................................................. 366
7.3
Uniform Distribution and Averages................................... 368
7.4
Results in One Dimension............................................. 372
7.5
Consequences and an Application .................................... 376
7.6
Results in Higher Dimensions ........................................ 379
7.7
Binary Block Substitutions of Constant Size......................... 382
7.8
Block Substitutions with Squares ..................................... 384
7.9
The Frank–Robinson Tiling ........................................... 389
7.10
Closing Remarks....................................................... 392
References ..................................................................... 393
8
Yet Another Characterization of the Pisot Substitution Conjecture ... 397
Paul Mercat and Shigeki Akiyama
8.1
Introduction ............................................................ 397
8.2
A Criterion for a Subshift to Have Purely Discrete Spectrum ....... 399
8.2.1
Subshift ........................................................ 399
8.2.2
Discrete Line Associated to a Word .......................... 400
8.2.3
Geometrical Criterion for the Pure Discreteness of
the Spectrum................................................... 402
8.2.4
An Easy Example: Generalization of Sturmian
Sequences...................................................... 406
8.3
Pure Discreteness for Irreducible Unit Pisot Substitution ........... 407
8.3.1
Substitutions ................................................... 407
8.3.2
Topology and Main Criterion ................................. 408
8.3.3
Proof That an Inner Point Implies the Pure
Discreteness of the Spectrum ................................. 409
8.4
Algebraic Coincidence Ensures an Inner Point ...................... 411
8.4.1
Algebraic Coincidence of Substitutive Delone Set .......... 411
8.4.2
Substitutive Meyer Set from Du .............................. 412
8.4.3
Algebraic Coincidence for Du ................................ 412
8.4.4
Proof of the Existence of an Inner Point ..................... 413
8.5
Computation of the Interior ........................................... 415
8.5.1
Regular Languages ............................................ 416
8.5.2
Discrete Line Associated to a Regular Language ............ 417
8.5.3
Computation of the Interior ................................... 420
8.5.4
Proof of the Theorem 8.5.11 .................................. 421
8.5.5
Examples....................................................... 423

Contents
xix
8.6
Pure Discreteness for Various Inﬁnite Family of Substitutions...... 425
8.6.1
Proof of Pure Discreteness Using a Geometrical
Argument ...................................................... 425
8.6.2
Proof of Pure Discreteness Using Automata ................. 432
8.7
Pure Discreteness for a S-adic System ............................... 437
8.7.1
Representation of Du,a by an Automaton .................... 438
8.7.2
Proof of the Inclusion ......................................... 441
8.7.3
Pure Discreteness of the Spectrum ........................... 443
References ..................................................................... 447
Index ............................................................................... 449

Chapter 1
Delone Sets and Dynamical Systems
Boris Solomyak
Abstract In these notes we focus on selected topics around the themes: Delone
sets as models for quasicrystals, inﬂation symmetries and expansion constants,
substitution Delone sets and tilings, and associated dynamical systems.
1.1
Introduction
This is an expository article, based on a 1.5-hour talk delivered at the School
on Tilings and Dynamics, held in CIRM, Luminy (November 2017). There are
no new results here; most of the content is at least 10 years old. The goal of
the talk was to supplement the lectures of N. P. Frank [16], and the notes are
written in the same spirit. There is, of course, too much material here for a single
lecture, but we tried to present at least a somewhat complete picture of the subject,
from a personal viewpoint. Two themes that we tried to emphasize are (a) the
characterization of expansion symmetries, and (b) the duality of substitution Delone
sets and substitution tilings.
In Sects. 1.2–1.4 we develop the notions of Delone sets and their classiﬁcation, as
well as characterization of (scalar) inﬂation symmetries. We largely follow the paper
by J. C. Lagarias [37], although many original ideas are due to Y. Meyer [49, 50].
Some relatively easy statements are proved completely; other proofs are sketched,
and still others are referred to the original papers. Several examples are worked out
in detail to illustrate the results.
Section 1.5 is central for us, although it contains almost no proofs. Here we
develop the notions of substitution Delone sets and substitution tilings and discuss
the relation between them. In particular, representable substitution Delone sets (or
rather, “multi-color” Delone sets, or m-sets) are introduced. Much of the section
is based on the paper by J. C. Lagarias and Y. Wang [39], with a few important
B. Solomyak ()
Bar-Ilan University, Ramat-Gan, Israel
© The Editor(s) (if applicable) and The Author(s), under exclusive license
to Springer Nature Switzerland AG 2020
S. Akiyama, P. Arnoux (eds.), Substitution and Tiling Dynamics: Introduction
to Self-inducing Structures, Lecture Notes in Mathematics 2273,
https://doi.org/10.1007/978-3-030-57666-0_1
1

2
B. Solomyak
additions from [40]. We include a discussion of a theorem about pseudo-self-afﬁne
tilings being mutually locally derivable with self-afﬁne tilings, following [60], since
this is a nice application of the duality between substitution Delone sets and tilings.
Section 1.6 is devoted to dynamical systems arising from tilings and Delone sets.
Since this is one of the main themes of [16], we have limited ourselves to a very
brief exposition, highlighting the aspects related to the topics developed in earlier
sections, speciﬁcally, the number-theoretic issues arising from the description of
eigenvalues and the Meyer property.
The last Sect. 1.7 contains some general remarks and references on several topics
not included in the main text: inﬁnite local complexity, pure discrete spectrum,
and Fourier quasicrystals. We conclude with a short list of open problems on the
characterization of expansion maps for tilings with inﬂation symmetry.
1.2
Delone Sets of Finite Type
Here we borrow much from the paper [37].
Deﬁnition 1.2.1 A discrete set X in Rd is a Delone set if it is
(a) Uniformly discrete: there exists r > 0 such that every open ball of radius r
contains at most one point of X; equivalently, the distance between distinct
points in X is at least 2r.
(b) Relatively dense: there exists R > 0 such that every closed ball of radius R
contains at least one point of X.
Delone sets are also sometimes called separated nets. The notion of Delone sets
as fundamental objects of study in crystallography was introduced by the Russian
school in the 1930s; in particular, by Boris Delone (or Delaunay). One can think
about a Delone set as an idealized model of an atomic structure of a material without
“holes”. This is obviously too general to be considered an “ordered” structure, so
we impose some conditions on the set.
For a set X ⊂Rd denote by [X] the abelian group (equivalently, Z-module)
generated by X. Recall that [X] :=
k
i=1 nixi : k ∈N, ni ∈Z

. The following
classes of Delone sets have been studied:
Deﬁnition 1.2.2 Let X be a Delone set in Rd.
(a) X is ﬁnitely generated if [X −X] (equivalently, [X]) is a ﬁnitely generated
abelian group.
(b) X is of ﬁnite type if X−X is a discrete closed subset of Rd; i.e., the intersection
of X −X with any ball is a ﬁnite set.
In the next section we will add to these the notion of Meyer set.
Exercise 1.2.3 (Easy) Give an example of a ﬁnitely generated Delone set which is
not of ﬁnite type.

1
Delone Sets and Dynamical Systems
3
We will see many such examples in Sect. 1.3.
Exercise 1.2.4 (Easy) Show that a Delone set X is of ﬁnite type if and only if it has
ﬁnite local complexity (FLC), that is, for any ρ > 0 there are ﬁnitely many “local
clusters” X ∩B(y, ρ), up to translation.
We will prove that every Delone set of ﬁnite type is ﬁnitely generated, but ﬁrst
we introduce the important notion of address map. Recall that a ﬁnitely generated
subgroup of Rd is free. We can choose a free basis, its cardinality is independent of
the choice of basis; it is called the rank of the free group.
Deﬁnition 1.2.5 Let X be a ﬁnitely generated Delone set. Choose a basis of [X],
say,
[X] = [v1, v2, . . . , vs].
The address map φ : [X] →Zs associated to this basis is
φ
 s

i=1
nivi

= (n1, . . . , ns).
The address map for the Delone set of control points of a self-similar tiling
has been used by Thurston [64] (we describe it in Sect. 1.4). The address map
is not unique, it depends on the choice of a basis, so it is determined up to left-
multiplication by an element of GL(s, Z). Observe that s ≥d since the linear span
of a Delone set is obviously the entire Rd. If s = d, then X is a subset of a lattice;
this is a special case—usually, s > d. Quoting J. Lagarias [37]:
The structure of a ﬁnitely generated Delone set is to some extent analyzable by studying
its image in Rs under the address map. The address map describes X using s “internal
dimensions.”
Theorem 1.2.6 (See [37]) For a Delone set X in Rd, the following properties are
equivalent:
(i) X is a Delone set of ﬁnite type.
(ii) X is ﬁnitely generated and any address map φ : [X] →Zs is globally Lipshitz
on X:
∥φ(x) −φ(x′)∥≤C0∥x −x′∥, for all x, x′ ∈X,
for some constant C0 depending on φ.
Proof (Sketch) (ii) ⇒(i). If x, x′ ∈X are such that ∥x −x′∥≤T , then by
hypothesis,
∥φ(x −x′)∥= ∥φ(x) −φ(x′)∥≤C0T.

4
B. Solomyak
Addresses all lie in Zs, hence there are only ﬁnitely many choices for φ(x −x′),
hence for x −x′, since φ : X →Zs is one-to-one. It follows that (X −X)∩B(0, T )
is ﬁnite, so X is of ﬁnite type.
⊓⊔
Lemma 1.2.7 (See [37]) Let X be a Delone set in Rd with parameters (r, R). Then
there exist constants k > 1 and C = C(R, r), such that given any two points
x, x′ ∈X there is a chain of points
x = x0, x1, x2, . . . , xm = x′
in X such that
(a) ∥xi −xi−1∥≤kR for all i;
(b) m ≤C∥x −x′∥.
Lagarias [37] proved that one can take k = 2 and C(R, r) = 4R/r2. We give a
simple proof for k = 4 and C(R, r) = (2R)−1 + r−1.
Proof (Lemma 1.2.7) Let m = ⌊∥x−x′∥
2R
⌋+ 1 and consider the points x =
x′
0, x′
1, . . . , x′
m−1, x = x′
m at equal distance ∥x−x′∥
m
≤2R from each other. By
the (r, R)-property, we can choose xi ∈X, for i = 1, . . . , m −1, such that
∥xi −x′
i∥≤R. Then ∥xi −xi+1∥≤R + 2R + R = 4R for all i = 0, . . . , m −1. It
remains to note that
m ≤∥x −x′∥
2R
+ 1 ≤∥x −x′∥
2R
+ ∥x −x′∥
r
,
and the proof is complete.
⊓⊔
Now we can deduce the implication (i) ⇒(ii). By Lemma 1.2.7, [X −X] is
generated by {x −x′ : ∥x −x′∥≤kR}, which is ﬁnite; thus X is ﬁnitely generated.
Let φ : [X] →Zs be an address map. Let
C1 := max{∥φ(y)∥: y ∈(X −X) ∩B(0, kR)}.
Given x, x′, by Lemma 1.2.7 we have a chain in X connecting x to x′ which satisﬁes
∥xi −xi+1∥≤kR, and the number of points is at most C∥x−x′∥. Using Z-linearity
of φ on [X], we can write
∥φ(x) −φ(x′)∥≤
m

i=1
∥φ(xi) −φ(xi−1∥
=
m

i=1
∥φ(xi −xi−1∥
≤C1m ≤C1C∥x −x′∥,
which proves (ii).
⊓⊔

1
Delone Sets and Dynamical Systems
5
1.3
Meyer Sets
Meyer sets were introduced by Meyer [49] in 1972 in the form of “relatively dense
harmonious sets,” but they remained in obscurity for a long time (see the fascinating
interview [14] with Yves Meyer on the occasion of the 2017 Abel Prize awarded
to him). The paper [50] introduced them to the quasicrystal community under the
name “quasicrystal”. Now they are generally called Meyer sets, see [36, 51].
Deﬁnition 1.3.1 Let X be a Delone set in Rd. It is called a Meyer set if the self-
difference set X −X is uniformly discrete, equivalently, a Delone set.
Actually, this was not the original deﬁnition. An interesting feature of Meyer sets
is that they can be characterized in seemingly very different terms: using discrete
geometry, almost linear mappings, and cut-and-project sets.
Deﬁnition 1.3.2 Let Rn = Ed ⊕H, where Ed ≈Rd (the “physical space”)
and H ≈Rm (the “internal space”) are linear subspaces of Rn, not necessarily
orthogonal.Let π and πint be the projection onto Ed parallel to H, and the projection
to H parallel to Ed, respectively. A window Ω is a bounded open subset of H.
Let Γ be a full rank lattice in Rn (that is, Γ is a discrete subgroup of rank n;
equivalently, it is a subgroup which forms a Delone set). The cut-and-project set
X(Γ, Ω) associated to the data (Γ, Ω) is
X(Γ, Ω) = π

{w ∈Γ : πint(w) ∈Ω}
	
.
A cut-and-project set is called nondegenerate if π is one-to-one on Γ . It is
irreducible if πint(Γ ) is dense in H. Cut-and-project sets (sometimes with different
requirements for the window) are also called model sets.
Theorem 1.3.3 (Y. Meyer, J. Lagarias, see [37]) For a Delone set X in Rd, the
following properties are equivalent:
(i) X is a Meyer set, that is, X −X is a Delone set.
(ii) there is a ﬁnite set F such that X −X ⊆X + F.
(iii) X is a ﬁnitely generated Delone set and the address map φ : [X] →Zs is an
almost linear mapping, i.e., there is a linear map L : Rd →Rs and C > 0
such that
∥φ(x) −Lx∥≤C for all x ∈X.
(iv) X is a subset of a non-degenerate cut-and-project set.
The theorem is mostly due to Meyer, except that the implication (i) ⇒(ii) was
proved by Lagarias [36]. R. V. Moody [51] did much to popularize the concept;
his article [51] contains other interesting characterizations of Meyer sets, e.g., in
terms of Harmonic Analysis and a certain kind of “duals". For a more complete
characterization of Meyer sets, see [63] by N. Strungaru.

6
B. Solomyak
Proof (Partial Sketch) (ii) ⇒(iii) First note that X is of ﬁnite type. Indeed, (X −
X) ∩B(0, N) ⊂(X + F) ∩B(0, N) is ﬁnite for any N > 0. Thus it is ﬁnitely
generated, and we can consider the address map φ. We construct L : Rd →Rs as
an “ideal address map,” as follows. For each y ∈Rd deﬁne
L(y) := lim
k→∞
φ(xk)
2k
,
where xk ∈X satisﬁes ∥xk −2ky∥≤R. Using (ii) one proves that this limit
exists and is unique (independent of the choice of xk), and is linear, roughly
along these lines: By the deﬁnition of xk, xk+1 and the triangle inequality we have
∥2xk −xk+1∥≤3R. But
2xk −xk+1 = xk −(xk+1 −xk) = xk −(z + w),
for some z ∈X and w ∈F (the ﬁnite set from (ii)). Thus,
∥xk −z∥≤3R + C1, where C1 = max
u∈F ∥u∥.
Since φ is Z-linear on X, we have
2φ(xk) −φ(xk+1) = [φ(xk) −φ(z)] −φ(w),
hence
∥2φ(xk) −φ(xk+1)∥≤∥φ(xk) −φ(z)∥+ ∥φ(w)∥
≤C0(3R + C1) + C2 =: C′.
where C2 = maxu∈F ∥φ(u)∥and C2 is from Theorem 1.2.6. Therefore,



φ(xk)
2k
−φ(xk+1)
2k+1



 ≤C′/2k+1,
and convergence follows. Now it is not difﬁcult to check linearity of L. For x = y ∈
X we can take x0 = x and, summing the geometric series, obtain
∥φ(x) −L(x)∥≤C′.
This shows almost linearity of the address map.
(iii) ⇒(i) It is clear that X −X is relatively dense, so we only need to show
that it is uniformly discrete. Equivalently, that there is a lower bound on the norm of
z ∈(X −X) −(X −X), whenever z ̸= 0. Suppose that ∥z∥≤R. By the hypothesis
(iii), we have ∥φ(z) −Lz∥≤4C, since φ is Z-linear on [X] and L is linear on Rd.

1
Delone Sets and Dynamical Systems
7
Therefore,
∥φ(z)∥≤4C + ∥L∥R.
Since φ is one-to-one on [X] and φ(z) ∈Zs, we see that there are only ﬁnitely many
possibilities for z. The desired claim follows.
For the equivalence of (iv) and (i)–(iii), see [37] or [51]. The direction (iv) ⇒
(i) is simple: one needs to verify that a relatively dense subset of a cut-and-project
set is Delone, then note that for a lattice Λ and a window Ω we have X(Λ, Ω) −
X(Λ, Ω) ⊆X(Λ, Ω −Ω).
The direction (iii) ⇒(iv) proceeds by taking the physical space Ed = L(Rd) ⊂
Zs and a complementary subspace H as the internal subspace. We then “lift” X to
Zs via the address map (which is, of course, a lattice in Rs), project it onto H and
note that the projection is bounded by the property (iii). We can then choose any
bounded open set containing the projection as a window. See [37] for details.
⊓⊔
1.4
Inﬂation Symmetries
This section is largely based on [37].
Deﬁnition 1.4.1 A Delone set X in Rd has an inﬂation symmetry by the real
number η > 1 if ηX ⊆X.
Recall that a (complex) number η is an algebraic integer if p(η) = 0 for some
monic polynomial p ∈Z[x], that is, p(x) = xs + s−1
j=0 cjxj, with cj ∈Z. The
degree of η is the minimal degree of p(x) ∈Z[x] such that p(η) = 0. The algebraic
(or Galois) conjugates of η are the roots of the minimal polynomial for η, other
then η. (Although in Galois theory, η itself is sometimes included in the list of
conjugates, for us it is more convenient to exclude it.) Several classes of algebraic
integers appear:
Deﬁnition 1.4.2 Let η be a real algebraic integer greater than one.
(a) η is a Pisot number or Pisot-Vijayaraghavan (PV)-number if all algebraic
conjugates satisfy |η′| < 1.
(b) η is a Salem number if for all conjugates |η′| ≤1 and at least one satisﬁes
|η′| = 1.
(c) η is a Perron number if for all conjugates |η′| < η.
(d) η is a Lind number if for all conjugates |η′| ≤η and at least one satisﬁes |η′| =
η.
“Lind numbers” were introduced by Lagarias [37], but this apparently did not
become standard terminology.
Deﬁnition 1.4.3 Let X be a Delone set in Rd. Finite subsets of X are called X-
clusters. The Delone set X in Rd is called repetitive if for any T > 0 there exists

8
B. Solomyak
MX(T ) > 0 such that every ball of diameter MX(T ) contains a translated copy of
every X-cluster of diameter T .
Theorem 1.4.4 (J. Lagarias [37], Y. Meyer [49]) Let X be a Delone set in Rd
such that ηX ⊆X for a real number η > 1.
(i) If X is ﬁnitely generated, then η is an algebraic integer.
(ii) If X is a Delone set of ﬁnite type, then η is a Perron number or a Lind number.
(ii′) If X is repetitive Delone set of ﬁnite type, then η is a Perron number.
(iii) If X is a Meyer set, then η is a Pisot number or a Salem number.
Proof (Partial Sketch)
(i) We will prove a more general statement:
⊓⊔
Lemma 1.4.5 Let X be a ﬁnitely generated Delone set in Rd such that QX ⊆X
for some expanding linear map Q. Then all eigenvalues of Q are algebraic integers.
Proof of Lemma Since X is ﬁnitely generated, it can be written [X] = [v1, . . . , vs]
for some free generators and the address map φ : [X] →Zs. Since QX ⊆X, we
also have Q([X]) ⊆[X]. It follows that Qvj is an integer linear combination of
the vectors vj (recall that these are the free generators of [X]). Deﬁne the matrix
V = [v1, . . . , vs] of size d × s. We thus obtain an integer matrix M of size s × s
such that
QV = V M.
(1.1)
It is clear that {vj}j≤s spans Rd, because X does, hence rank(V ) = d. Let e be a left
eigenvector of Q corresponding to an eigenvalue λ. Then λeV = eQV = eV M.
Notice that eV is not zero, because the rows of V are linearly independent. Thus eV
is an eigenvector for M corresponding to λ. But M is an integer matrix, so all its
eigenvalues are algebraic integers.
⊓⊔
(ii) Let γ be a conjugate of η. We continue the argument of the lemma. Since η
is an eigenvalue of the integer matrix M, so is γ . Thus there is an eigenvector
eγ ∈Rs corresponding to γ . We want to prove that |γ | ≤η. Let φ be the
address map as in the proof of the lemma. Then {φ(vj)}j≤s is the canonical
basis of Rs, by deﬁnition. Since vj’s are the generators of [X], we must have
that φ(X) spans Rs. It follows that we can ﬁnd x0, x ∈X such that φ(x−x0) =
φ(x) −φ(x0) has a non-zero coefﬁcient corresponding to eγ in the canonical
eigen(root)vector expansion corresponding to M. We have ηnx ∈X for all
n ∈N, and
φ(ηnx) = Mnφ(x),
(1.2)

1
Delone Sets and Dynamical Systems
9
by the deﬁnition of M. Now, by Theorem 1.2.6, we have,
∥φ(ηnx) −φ(ηnx0)∥≤C0∥ηnx −ηnx0∥= C0ηn∥x −x0∥.
On the other hand, by (1.2) and the choice of x, x0,
∥φ(ηnx) −φ(ηnx0)∥= ∥Mn(φ(x −x0))∥≥c|γ |n,
for some c > 0, and we can conclude that |γ | ≤|η|.
⊓⊔
(ii′) This can derived be similarly to [64, §10], see also [61]; we omit the proof.
(iii) Consider the address map φ and the matrix M as above. Recall that for a Meyer
set the address map is almost linear, that is, there exists a linear map L : Rd →
Rs such that ∥φ(x)−Lx∥≤C for all x ∈X. Consider the range H := L(Rd),
a d-dimensional subspace of Rs.
Claim The subspace H is invariant under M; in fact, H is contained in the
eigenspace of M corresponding to η.
Proof of Claim Choose any unit vector w ∈H, then w = Lz for some z ∈Rd. For
any k > 1 we can ﬁnd x ∈X such that ∥kz −x∥≤R. Then ∥kw −Lx∥≤∥L∥R,
hence
∥kw −φ(x)∥≤C + ∥L∥R.
(1.3)
Since ηx ∈X, we also have ∥φ(ηx) −L(ηx)∥≤C, therefore,
∥φ(ηx) −ηφ(x)∥≤∥φ(ηx) −L(ηx)∥+ η∥φ(x) −Lx∥≤C(1 + η).
Recall from (1.2) that φ(ηx) = Mφ(x), thus ∥(M −ηI)φ(x)∥≤C(1 + η).
Combining this with (1.3) yields
∥(M −ηI)kw∥≤C(1 + η) + ∥M −ηI∥· (C + ∥L∥R) =: 
C.
Therefore, ∥(M −ηI)w∥≤
C/k for all k > 1, and the claim follows.
Now we repeat part of the argument from (ii): given a conjugate γ of η and the
corresponding eigenvector eγ for M, choose x with φ(x) having non-zero coefﬁcient
corresponding to eγ . By the Claim, eγ ̸∈H. As above, we have φ(ηnx) = Mnφ(x),
hence
c|γ |n ≤∥Mnφ(x) −ηnLx∥= ∥φ(ηnx) −L(ηnx)∥≤C,
for some c > 0, since Lx has a zero coefﬁcient corresponding to eγ . It follows that
|γ | ≤1, as desired.
⊓⊔

10
B. Solomyak
Example 1.4.6
(i) Let η > 1 be an irrational algebraic integer. One can construct a ﬁnitely
generated Delone set X ⊆R, with ηX ⊆X as follows. We will have X ⊆Z[η]
(the ring generated by Z and η) and X = −X. Start with X ⊂[0, η) = {0, 1}
and proceed by induction, adding points to X from [ηk, ηk+1), once we did this
in [ηk−1, ηk). First make sure that X∩[ηk, ηk+1) ⊇η(X∩[ηk−1, ηk)), and then
add more points from Z[η], if necessary, to maintain the relative denseness,
but also preserve uniform discreteness. The latter is easy, since Z[η] is dense
in R. Finally, observe that Z[η] = [1, η, . . . , ηs−1] is ﬁnitely generated as a
Z-module, where s is the degree of η.
(ii) Let η > 1 be a Perron number. One can construct a Delone set X ⊆R
with inﬂation symmetry η. In fact, it will even be a substitution Delone set,
discussed in the next section. It is obtained as a set of endpoints of a self-
similar tiling of R corresponding to a primitive substitution. By a theorem of
D. Lind [47], for any Perron number η there exists a primitive integer matrix
M with η as a dominant eigenvalue. Moreover, by a minor modiﬁcation of the
construction, one can make sure that the entry (1, 1) of the matrix is positive
and the ﬁrst column sum is at least three, see [61]. Then simply choose any
substitution with substitution matrix M.
It is known that such an X is Meyer if and only if η is a Pisot number.
(iii) β-integers. Fix β > 1, with β ̸∈N. Let Xβ = X+
β
(−X+
β ), where
X+
β =
 N

j=0
ajβj, aj ∈{0, 1, . . ., ⌊β⌋}, “greedy” expansion

.
Then Xβ is relatively dense in R and βX ⊂X.
•
Xβ is Delone if and only if the orbit of 1 under Tβ(x) = βx (mod 1) does
not accumulate to 0.
•
Delone Xβ is ﬁnitely generated iff β is an algebraic integer.
•
Delone Xβ is of ﬁnite type iff β is a Parry β-number (see [53]), i.e., the
orbit {T n
β (1)}n≥0 is ﬁnite.
•
If β is Pisot (or Salem of degree four [12]), then Xβ is Meyer.
We will now explain the last claim, that Pisot β implies the Meyer property,
at the same time illustrating some of the concepts in the proofs of the theorem
above.
Fix β > 1 algebraic integer, such that {T n
β 1}n≥0 does not accumulate to
zero. Then Xβ ⊂R is Delone and [Xβ] = Z[β]. Free generators for [Xβ] can
be chosen vj = βj−1, j ≤s, where s is the degree of β. Let c0 + c1x + · · · +
cs−1xs−1 + xs be the minimal integer polynomial for β.

1
Delone Sets and Dynamical Systems
11
We have Qx = βx on R, and QXβ ⊂Xβ. Then QV = V M, where
V = [v1, . . . , vs] is a row and
M =
⎛
⎜⎜⎜⎜⎜⎜⎜⎝
0 . . . . . . 0
−c0
1
0 . . . 0
−c1
0
1 . . . 0
−c2
. . . . . . . . . . . .
. . .
. . . . . . . . . 0 −cs−2
0
0 . . . 1 −cs−1
⎞
⎟⎟⎟⎟⎟⎟⎟⎠
(1.4)
Let φ be the associated address map, φ : [Xβ] = Z[β] →Rs. We have
φ(βn) = Mnφ(1) = Mn
⎛
⎜⎜⎜⎝
1
0
...
0
⎞
⎟⎟⎟⎠.
Now suppose that β is Pisot. Then we have
φ(βn) = βneβ + O(ϱn),
(1.5)
where eβ is the eigenvector of M corresponding to β and ϱ ∈(0, 1) is the
maximal absolute value of the Galois conjugates of β. Deﬁne L : R →Rs
by L(x) = xeβ, a linear map. We want to show that ∥φ(x) −Lx∥≤C on
Xβ, whence Xβ is a Meyer set by Theorem 1.3.3. In view of (1.5), we have for
x = N
j=0 ajβj ∈X+
β :
∥φ(x) −Lx∥=






φ
 N

j=0
ajβj
−L
 N

j=0
ajβj






= O

max
j
|aj| ·
N

j=0
ϱj
= O(1),
as desired.
The same proof works, e.g., for the set of endpoints of a self-similar tiling
on R with a Pisot inﬂation factor.
(iv) Salem inﬂation factors. For every Salem number β there exists a Meyer set in
R with inﬂation β; see [49] for Meyer’s original construction. I am grateful to
Shigeki Akiyama who showed me the following example, which is, apparently,
“folklore”.
Let β be a Salem number of degree s ≥4, and let p(x) = c0 + c1x +
· · · + cs−1xs−1 + xs be the minimal polynomial for β. Let β2, . . . , βs be the

12
B. Solomyak
Galois conjugates of β. It is well-known that p(x) is a reciprocal polynomial,
i.e., c0 = 1 and cs−j = cj for j = 1, . . . , s −1, and the conjugates satisfy
|β2| = . . . = |βs−1| = 1 and |βs| < 1, see [56]. Consider
Xβ :=

x =
N

n=0
anβn : an ∈Z, max
2≤j≤s

N

n=0
anβn
j
 < 1

.
It is immediate that βXβ ⊂Xβ. Moreover, Xβ is a non-degenerate model set,
hence it is Meyer.
In order to prove the last claim, we consider the matrix M from (1.4)
above and identify Xβ with Xβeβ, where eβ is the right eigenvector of M
corresponding to β. The subspace spanned by eβ is our “physical space”.
The “internal space” H is the linear span of the other eigenvectors. One
can check that (with appropriate normalization) the coordinate ak of a vector
y = (yj)s
1 ∈Rs with respect to the eigenvector of M corresponding to βk is
given by s−1
j=0 yjβj
k . Thus, taking Zs as a lattice and the window in H given
by the condition
∥y∥:= max
2≤k≤s |ak| < 1 for y =
s

k=2
akeβk,
we get the desired representation as a cut-and-project set. The details are left to
the reader. (Instead of the unit ball in the ℓ∞norm as a window we can choose
a different radius and a different norm to get other examples of Meyer sets with
the same inﬂation symmetry.)
1.5
Substitution Delone Sets and Substitution Tilings
This section is based on [39] and [41]; see also [10].
If we think about Delone sets as being models of atomic structures, it is natural
to add the feature of “color” or “type” of a point/atom. Thus we are going to talk
about “m-sets”. (Sometimes, the term “multiset” is used, but it usually refers to a
set with multiplicities, and we want to avoid this.)
1.5.1
Substitution Delone m-Sets
Deﬁnition 1.5.1 An m-multiset in Rd is a subset Λ = Λ1 ×· · ·×Λm ⊂Rd ×· · ·×
Rd
(m copies) where Λi ⊂Rd. We also write Λ = (Λ1, . . . , Λm) = (Λi)i≤m. We

1
Delone Sets and Dynamical Systems
13
say that Λ = (Λi)i≤m is a Delone m-set in Rd if each Λi is Delone and supp(Λ) :=
m
i=1 Λi ⊂Rd is Delone.
Although Λ is a product of sets, it is convenient to think of it as a set with types
or colors, i being the color of points in Λi. (However, we do not assume that Λi
are pairwise disjoint!) A cluster of Λ is, by deﬁnition, a family P = (Pi)i≤m where
Pi ⊂Λi is ﬁnite for all i ≤m. For a bounded set A ⊂Rd, let A∩Λ := (A∩Λi)i≤m.
There is a natural translation Rd-action on the set of Delone m-sets and their clusters
in Rd. The translate of a cluster P by x ∈Rd is x + P = (x + Pi)i≤m. We say that
two clusters P and P′ are translationally equivalent if P = x + P′, i.e. Pi = x + P ′
i
for all i ≤m, for some x ∈Rd.
Recall that a linear map Q : Rd →Rd is expanding if its every eigenvalue lies
outside the unit circle.
Deﬁnition 1.5.2 Λ = (Λi)i≤m is called a substitution Delone m-set if Λ is a
Delone m-set and there exist an expanding map Q : Rd →Rd and ﬁnite sets
Dij for i, j ≤m (possibly empty) such that
Λi =
m

j=1
(QΛj + Dij),
i ≤m,
(1.6)
where  denotes disjoint union. The substitution matrix S is deﬁned by Sij =
♯(Dij). The substitution m-set is primitive if S is primitive, i.e., some power of S
has only strictly positive entries.
With an abuse of terminology, we say that supp(Λ), or sometimes even Λ, is
simply a substitution Delone set.
There is a connection between substitution Delone sets and Delone sets with
inﬂation symmetries, discussed in Sect. 1.3. Of course, here Q is more general,
whereas in Sect. 1.3 it was a homothety x →ηx. It is not always true that
supp(Λ) ⊃Q(supp(Λ)); a sufﬁcient condition is that for every j ≤m there exists
i ≤m such that Dij ∋0. This may be achieved by passing from Λi to Λi + xi,
which satisfy a system of equations as in (1.6), with modiﬁed Dij; the only issue is
whether the new m-set is still a Delone m-set. In any case, the following holds:
Lemma 1.5.3 Suppose that Λ is a substitution Delone m-set with expansion map
Q. If supp(Λ) is ﬁnitely generated, then all eigenvalues of Q are algebraic integers.
For the proof, it is convenient to consider the set of “inter-atomic vectors” (more
precisely, translation vectors between points of the same color):
Ξ(Λ) :=
m

i=1
(Λi −Λi).
(1.7)

14
B. Solomyak
It is immediate from (1.6) that Q(Ξ(Λ)) ⊂Ξ(Λ). Even though it need not be a
Delone set (it is Delone when supp(Λ) is a Meyer set), the proof proceeds similarly
to the proof of Lemma 1.4.5.
There is another important necessary condition for Q to be an expansion map.
Theorem 1.5.4 ([39, Thm. 2.3]) If Λ is a primitive substitution Delone m-set
with expansion map Q, then the Perron-Frobenius (PF) eigenvalue λ(S) of the
substitution matrix S equals | det(Q)|.
In fact, it is not difﬁcult to see that
supp(Λ) is relatively dense ⇒λ(S) ≥| det(Q)|;
supp(Λ) is uniformly discrete ⇒λ(S) ≤| det(Q)|.
For each primitive substitution Delone m-set Λ (1.6) one can set up an adjoint
system of equations
QAj =
m

i=1
(Dij + Ai),
j ≤m.
(1.8)
From the theory of graph-directed iterated function systems, it follows that (1.8)
always has a unique solution for which A = {A1, . . . , Am} is a family of non-
empty compact sets of Rd. It is proved in [39, Thm.2.4 and Thm.5.5] that if Λ is a
primitive substitution Delone m-set, then all the sets Ai from (1.8) have non-empty
interiors and, moreover, each Ai is the closure of its interior. From Theorem 1.5.4 it
follows that the interiors of the sets in the right-hand side of (1.8) are disjoint, hence
we have a natural candidate for a tiling. We next review brieﬂy the relevant tiling
deﬁnitions.
1.5.2
Tilings and Substitution Tilings
This section has a signiﬁcant overlap with [16].
We begin with a set of types (or colors) {1, . . . , m}, which we ﬁx once and for all.
A tile in Rd is deﬁned as a pair T = (A, i) where A = supp(T ) (the support of T ) is
a compact set in Rd which is the closure of its interior, and i = ℓ(T ) ∈{1, . . . , m}
is the type of T . We let g + T = (g + A, i) for g ∈Rd. Given a tile T and a set
X ⊆Rd we use the notation:
T + X = {T + x : x ∈X}.
A ﬁnite set P of tiles is called a patch if the tiles of P have mutually disjoint interiors
(strictly speaking, we have to say “supports of tiles,” but this abuse of language

1
Delone Sets and Dynamical Systems
15
should not lead to confusion). A tiling of Rd is a set T of tiles such that Rd =
{supp(T ) : T ∈T } and distinct tiles have disjoint interiors. Given a tiling T ,
ﬁnite sets of tiles of T are called T -patches.
We always assume that any two T -tiles with the same color are translationally
equivalent. (Hence there are ﬁnitely many T -tiles up to translation.)
Deﬁnition 1.5.5 Let A = {T1, . . . , Tm} be a ﬁnite set of tiles in Rd such that Ti =
(Ai, i); we will call them prototiles. Denote by PA the set of patches made of tiles
each of which is a translate of one of Ti’s. We say that ω : A →PA is a tile-
substitution (or simply substitution) with expanding map Q if there exist ﬁnite sets
Dij ⊂Rd for i, j ≤m, such that
ω(Tj) =
m

i=1
(Ti + Dij).
(1.9)
Since ω(Tj) is a patch, it follows that for all j ≤m,
QAj =
m

i=1
(Ai + Dij),
and the sets in the right-hand side have disjoint interiors.
The substitution (1.9) is extended to all translates of prototiles by ω(x + Tj) =
Qx + ω(Tj), and to patches and tilings by ω(P) = {ω(T ) :
T ∈P}. The
substitution ω can be iterated, producing larger and larger patches ωk(Tj). As for a
substitution Delone m-set, we associate to ω its m × m substitution matrix S, with
Sij := ♯(Dij). The substitution ω is said to be primitive if S is primitive. The tiling
T is called a ﬁxed point of a substitution if ω(T ) = T .
Deﬁnition 1.5.6 A tiling is called self-afﬁne if it is a ﬁxed point of a primitive tile-
substitution. Usually it is also assumed that the tiling has ﬁnite local complexity
(FLC). If the expansion map Q is a similitude, that is, Q = ηO for some η > 1 and
an orthogonal linear transformation O, then we say that the tiling is self-similar. For
a self-similar tiling in R2 one also considers the complex expansion factor λ ∈C,
|λ| > 1, by identifying the plane with C and the map Q with z →λz.
Example 1.5.7 Figures 1.1 and 1.2 show a self-afﬁne tiling found by G. Gelbrich:
the tile substitution is
ω(T ) = T ∪(−T ) ∪(−T + (1, 0)) ∪(−T + (0, 1)),

16
B. Solomyak
Fig. 1.1 Tile substitution
Fig. 1.2 Patch of the
self-afﬁne tiling
where supp(ω(T )) = Q(supp(T )) + (1/2, −1/2), with
Q =
 −2 1
2 1

.
It is actually a p2 crytallographic tiling, and therefore periodic, see [25].
Below, in Example 1.5.18, one can see a ﬁgure showing a self-similar tiling.
I am grateful to S. Akiyama and to an anonymous volunteer who helped with the
examples and the ﬁgures.
Notice that a ﬁxed point of a substitution naturally deﬁnes a substitution Delone
m-set, as follows: By deﬁnition, we can write T = m
j=1(Tj +Λj) for some Delone

1
Delone Sets and Dynamical Systems
17
sets Λj. Then we have
m

i=1
(Ti + Λi) = T = ω(T ) =
m

j=1

ω(Tj) + QΛj
	
=
m

j=1
 m

i=1
(Ti + Dij) + QΛj

=
m

i=1

Ti +
m

j=1
(QΛj + Dij)

.
It follows that Λ = (Λi)m
i=1 satisﬁes the system of equations (1.6). In general, it
is not necessarily true that Λi are disjoint, but we can ensure this, e.g., by taking
Tj := Tj −c(Tj), where Tj is a T -tile of type j and c(Tj) is a point chosen in its
interior. Then we obtain that Λ is a substitution Delone m-set.
A natural question is when this procedure can be reversed.
1.5.3
Representable Delone m-Sets
Deﬁnition 1.5.8 A Delone m-set Λ = (Λi)i≤m is called representable (by tiles) for
a tiling if there exists a set of prototiles A = {Ti : i ≤m} so that
Λ + A := {x + Ti : x ∈Λi, i ≤m} is a tiling of Rd,
(1.10)
that is, Rd = 
i≤m

x∈Λi(x + Ai) where Ti = (Ai, i) for i ≤m, and the sets
in this union have disjoint interiors. In the case that Λ is a primitive substitution
Delone m-set we will understand the term representable to mean relative to the tiles
Ti = (Ai, i), for i ≤m, arising from the solution to the adjoint system (1.8). We
call Λ + A the associated tiling of Λ.
Deﬁnition 1.5.9 For a substitution Delone m-set Λ = (Λi)i≤m satisfying (1.6),
deﬁne a matrix Φ = (Φij)m
i,j=1 whose entries are ﬁnite (possibly empty) families
of linear afﬁne transformations on Rd given by
Φij = {f : x →Qx + a : a ∈Dij} .
We deﬁne Φij(Ξ) := 
f ∈Φij f (Ξ) for a set Ξ ⊂Rd. For an m-set (Ξi)i≤m let
Φ

(Ξi)i≤m
	
=
 m

j=1
Φij(Ξj)

i≤m .
Thus Φ(Λ) = Λ by deﬁnition. We say that Φ is an m-set substitution.

18
B. Solomyak
Let Λ be a substitution Delone m-set and Φ the associated m-set substitution.
Deﬁnition 1.5.10 Let Λ be a primitive substitution Delone m-set and let P be a
cluster of Λ. The cluster P will be called legal if it is a translate of a subcluster of
Φk({xj}) for some xj ∈Λj, j ≤m and k ∈N. (Here {xj} is an m-set which is
empty in all coordinates other than j, for which it is a singleton.)
Lemma 1.5.11 ([41]) Let Λ be a primitive substitution Delone m-set such that
every Λ-cluster is legal. Then Λ is repetitive.
Not every substitution Delone m-set is representable (see [41, Ex. 3.12]), but the
following theorem provides the sufﬁcient condition for it.
Theorem 1.5.12 ([41]) Let Λ be a repetitive primitive substitution Delone m-set.
Then every Λ-cluster is legal if and only if Λ is representable.
Remark 1.5.13 In [39, Lemma 3.2] it is shown that if Λ is a substitution Delone
m-set, then there is a ﬁnite m-set (cluster) P ⊂Λ for which Φn−1(P) ⊂Φn(P) for
n ≥1 and Λ = limn→∞Φn(P). We call such a m-set P a generating m-set. Note
that, in order to check that every Λ-cluster is legal, we only need to see if some
cluster that contains a ﬁnite generating m-set for Λ is legal.
1.5.4
Characterization of Expansion Maps
An important question, ﬁrst raised by Thurston [64], is to characterize which
expanding linear maps may occur as expansion maps for self-afﬁne (self-similar)
tilings. It is pointed out in [64] that in one dimension, η > 1 is an expansion factor
if and only if it is a Perron number (necessity follows from the Perron-Frobenius
theorem and sufﬁciency follows from a result of Lind [47] as in Example 1.4.6(ii)).
In two dimensions, Thurston [64] proved that if λ is a complex expansion factor of
a self-similar tiling, then λ is a complex Perron number, that is, an algebraic integer
whose Galois conjugates, other than λ, are all less than |λ| in modulus.
The following theorem was stated in [30], but complete proof was not available
until much later.
Theorem 1.5.14 ( [30, 33]) Let φ be a diagonalizable (over C) expansion map on
Rd, and let T be a self-afﬁne tiling of Rd with expansion φ. Then
(i) every eigenvalue of φ is an algebraic integer;
(ii) if λ is an eigenvalue of φ of multiplicity k and γ is an algebraic conjugate of λ,
then either |γ | < |λ|, or γ is also an eigenvalue of φ of multiplicity greater or
equal to k.

1
Delone Sets and Dynamical Systems
19
Here part (i) is included for completeness; it is a folklore result, proved similarly
to Lemma 1.4.5. Recently Theorem 1.5.14 was ﬁnally extended to the general,
not necessarily diagonalizable, case by J. Kwapisz [35]; we don’t state precise
“generalized Perron” conditions here, but refer the reader to his paper. Basically, one
has to take into account the multiplicity of Jordan blocks as well. It is conjectured
that the necessary condition is also sufﬁcient, at least, in the weaker form: one
should be able to construct a self-afﬁne tiling with expansion map Qn for some
n ∈N. Sufﬁciency (in the stronger form) in dimension one follows from [47], as
discussed in Sect. 1.3, Example (ii), and the construction in the two-dimensional
self-similar case is found in [32]. A natural approach to the conjecture would be to
construct ﬁrst a substitution Delone m-set with the desired inﬂation symmetry, and
then apply Theorem 1.5.12. This way, the geometric shape of tiles comes from the
adjoint equation, and one has more freedom.
The starting point in the proofs of necessity of the Perron condition is deﬁning
the control points for the tiles [64].
Deﬁnition 1.5.15 Let T be a ﬁxed point of a primitive tile-substitution with
expanding map Q. For each T -tile T , ﬁx a tile γ T in the patch ω(T ); choose γ T
with the same relative position for all tiles of the same type. This deﬁnes a map
γ : T →T called the tile map. Then deﬁne the control point for a tile T ∈T by
{c(T )} =
∞

n=0
Q−n(γ nT ).
The control points have the following properties:
(a) T ′ = T + c(T ′) −c(T ), for any tiles T, T ′ of the same type;
(b) Q(c(T )) = c(γ T ), for T ∈T .
It immediately follows from these properties that Λ = (Λi)i≤m, where Λi =
{c(T ) :
T
∈T of type i}, is a substitution Delone m-set. Moreover, X :=
supp(Λ) = {c(T ) : T ∈T } is a Delone set satisfying QX ⊂X. Thurston [64]
deﬁned the address map φ : [X] →Zs, as in Sect. 1.1, and considered the induced
action of the linear expanding map Q. See the references for the rest.
1.5.5
Pseudo-Self-Afﬁne Tilings
We mention brieﬂy another instance where the duality between substitution Delone
m-sets and substitution tilings was useful. The reader is referred to [16, 4.4.2] and
the original papers for more details.

20
B. Solomyak
Deﬁnition 1.5.16 ([5]) To a subset F ⊂Rd and a tiling T of Rd we associate a
T -patch by [F]T = {T ∈T : supp(T ) ∩F ̸= ∅}. Let T and T2 be two tilings. Say
that T2 is locally derivable (LD) from T1 with radius R > 0 if for all x, y ∈Rd,
[BR(x)]T1 = [BR(y)]T2 + (x −y) ⇒[{x}]T2 = [{y}]T2 + (x −y).
If T2 is LD from T1 and T1 is LD from T2, the tilings are mutually locally derivable
(MLD).
Deﬁnition 1.5.17 Let Q : Rd →Rd be an expanding linear map. A repetitive FLC
tiling of Rd is called a pseudo-self-afﬁne tiling with expansion Q if T is LD from
QT . If Q is a similitude, the pseudo-self-afﬁne tiling is called pseudo-self-similar.
E. A. Robinson, Jr. [55] conjectured that every pseudo-self-afﬁne tiling is MLD
with a self-afﬁne tiling. This was settled in the afﬁrmative: for pseudo-self-similar
tilings in R2 in [21], and in [60] in full generality. A few comments:
•
In [21] the method of “redrawing the boundary” was used (following [32] to
some extent); as a result we obtained an MLD self-similar tiling where each tile
is a topological disk bounded by a Jordan curve.
•
In contrast, in [60] we ﬁrst constructed an MLD substitution Delone m-set in
Rd, and then applied Theorem 1.5.12. This way we only know that each tile
is a compact set, which is a closure of its interior; the tiles need not even be
connected.
•
In both papers [21, 60] we needed to pass from the expansion Q for the original
tiling to the expansion Qk for k sufﬁciently large for the resulting self-similar (or
self-afﬁne) tiling, in order for the construction to work, similarly to the weaker
form of the conjecture, discussed after Theorem 1.5.14.
Example 1.5.18 Here is an example of a pseudo-self-similar tiling, due to J. Socolar
(the help of S. Akiyama and an anonymous volunteer is gratefully acknowledged).
See the online Tiling Encyclopedia:
https://tilings.math.uni-bielefeld.de/substitution/limhex/
Note that there is one prototile T , up to translation and rotation, which appears
in 6 orientations, so that up to translation there are 6 prototiles. It is pseudo-self-
similar, with the expansion map given by z →e2πi/3z in the complex plane. The
subdivision rule leads to an iterated function system and the set equation
2T = T ∪(T −1) ∪(w5T + w2) ∪(w2T + w), where w = e2πi/3.
The solution looks rather complicated: see T and the subdvision of 2T in Fig. 1.3
and the patch of the resulting self-similar tiling in Figs. 1.4, 1.5, and 1.6.

1
Delone Sets and Dynamical Systems
21
Fig. 1.3 Subdivision rule 2T →T ∪(T −1) ∪(w5T + w2) ∪(w2T + w) where w = e2πi/3
Fig. 1.4 Patch of the pseudo-self-similar tiling
Fig. 1.5 The self-similar tile and the tile-substitution

22
B. Solomyak
Fig. 1.6 Patch of the
self-similar tiling
1.6
Dynamical Systems from Delone Sets in Rd
This section is not intended to be a comprehensivesurvey (even in the “local” sense);
we only touch on some aspects of this topic. For more on the background and other
topics see [16] and references therein.
Let Λ be an FLC Delone m-set and let XΛ be the collection of all Delone m-sets
each of whose clusters is a translate of a Λ-cluster. We introduce a “big ball” metric
on XΛ in the standard way: two Delone m-sets are close if they agree exactly in a
large neighborhood of the origin, possibly after a small translation. Precisely:
ρ(Λ1, Λ2) := min{ρ(Λ1, Λ2), 2−1/2} ,
(1.11)
where
ρ(Λ1, Λ2) = inf{ϵ > 0 : ∃x, y ∈Bϵ(0),
B1/ϵ(0) ∩(−x + Λ1) = B1/ϵ(0) ∩(−y + Λ2)} .

1
Delone Sets and Dynamical Systems
23
For the proof that ρ is a metric, see [40]. It is well-known that (XΛ, ρ) is compact
(here the FLC assumption is crucial). Here we restrict ourselves to the FLC case;
the general case is discussed brieﬂy in Sect. 1.7.
Observe that XΛ = {−h + Λ : h ∈Rd} where the closure is taken in the
topology induced by the metric ρ. The group Rd acts on XΛ by translations which
are homeomorphisms, and we get a topological dynamical system (XΛ, Rd). We
should point out that most of the deﬁnitions and statements in this section have a
parallel version in the tiling setting. It is usually not a problem to pass from the tiling
framework to the Delone set framework and back, and we will do so freely.
Certain discrete-geometric and statistical properties of the Delone m-set Λ
correspond to properties of the associated dynamical system. For instance, Λ is
repetitive if and only if (XΛ, Rd) is minimal (i.e., every orbit is dense), see [55].
We next discuss cluster (patch) frequencies and invariant measures. For a cluster
P and a bounded set A ⊂Rd denote
LP(A) = ♯{x ∈Rd : x + P ⊂A ∩Λ},
where ♯denotes the cardinality. In plain language, LP(A) is the number of translates
of P contained in A, which is clearly ﬁnite. For a bounded set F ⊂Rd and r > 0,
let (F)+r := {x ∈Rd : dist(x, F) ≤r} denote the r-neighborhood of F. A van
Hove sequence for Rd is a sequence F = {Fn}n≥1 of bounded measurable subsets
of Rd satisfying
lim
n→∞Vol((∂Fn)+r)/Vol(Fn) = 0, for all r > 0.
(1.12)
Deﬁnition 1.6.1 Let {Fn}n≥1 be a van Hove sequence. The Delone m-set Λ has
uniform cluster frequencies (UCF) (relative to {Fn}n≥1) if for any non-empty cluster
P, the limit
freq(P, Λ) = lim
n→∞
LP(x + Fn)
Vol(Fn)
≥0
exists uniformly in x ∈Rd.
Recall that a topological dynamical system is uniquely ergodic if there is a unique
invariant probability measure (which is then automatically ergodic). It is known
(see e.g. [40, Thm. 2.7]) that for a Delone m-set Λ with FLC, the dynamical system
(XΛ, Rd) is uniquely ergodic if and only if Λ has UCF. A primitive FLC substitution
Delone m-set is known to have UCF (see [41]), hence we get a uniquely ergodic Rd-
action (XΛ, Rd, μ).

24
B. Solomyak
1.6.1
Eigenvalues of Delone Set Dynamical Systems
Let μ be an ergodic invariant Borel probability measure for the dynamical system
(XΛ, Rd). A point α = (α1, . . . , αd) ∈Rd is called an eigenvalue (or dynamical
eigenvalue) for the Rd-action if there exists an eigenfunction f ∈L2(XΛ, μ), that
is, f ̸≡0 and
f (−g + S) = e2πi⟨g,α⟩f (S),
for all g ∈Rd.
(1.13)
Here ⟨g, α⟩is the usual scalar product in Rd and the equality is understood in L2,
that is, for μ-a.e. S.
An eigenvalue α is a continuous or topological eigenvalue if (1.13) has a
continuous solution. A characterization of topological eigenvalues was obtained in
[59].
Deﬁnition 1.6.2 Let Λ be a Delone m-set of ﬁnite type. We say that y ∈Rd is a
topological ε-almost-period for Λ if
Λ ∩B1/ε(0) = (Λ −y) ∩B1/ε(0).
Denote by Ψε(Λ) the set of topological ε-almost-periods.
Theorem 1.6.3 ([59]) Let Λ be a repetitive Delone m-set of ﬁnite type. Then α is a
topological eigenvalue for (XΛ, Rd) if and only if
lim
ε→0
sup
y∈Ψε(Λ)
|e2πi⟨y,α⟩−1| = 0.
(1.14)
In [59] the theorem is proved for a single Delone set dynamical system, but the
proof transfers to the case of Delone m-sets without any changes.
There is a connection between the diffraction spectrum of a Delone m-set and the
dynamical spectrum, going back to Dworkin [15], but this topic is beyond the scope
of these Notes. On this matter, the reader should consult e.g., [3, 7] and references
therein.
N. Strungaru [62] proved that any Meyer set has a relatively dense set of Bragg
peaks, which implies, via the link with the dynamical spectrum, that the set of
eigenvalues for the associated dynamical system is relatively dense as well. More
recently, J. Kellendonk and L. Sadun [28] proved that the latter property holds for
topological eigenvalues too. In fact, they established the following
Theorem 1.6.4 ([28, Thm. 1.1]) A repetitive FLC Delone set dynamical system
in Rd has d linearly independent topological eigenvalues if and only if it is
topologically conjugate to a Meyer set dynamical system.

1
Delone Sets and Dynamical Systems
25
In the case of substitution systems, we obtained the following result earlier,
jointly with J.-Y. Lee:
Theorem 1.6.5 ([42, Thm. 4.14]) Let Λ = (Λj)m
j=1 be a representable prim-
itive FLC substitution Delone m-set. The set of eigenvalues for the Rd-action
(XΛ, Rd, μ) is relatively dense in Rd if and only if supp(Λ) = m
j=1 Λj is a Meyer
set.
As a corollary, we showed in [42] that if the Rd-action (XΛ, Rd, μ) has purely
discrete spectrum, then supp(Λ) is a Meyer set. This was an answer to a question of
J. Lagarias from [38].
For the proof of sufﬁciency of the Meyer property we relied on the result of
Strungaru [62] quoted above. The proof of necessity in Theorem 1.6.4 proceeds via
the notion of Pisot families. Let Q be the expansion map for the substitution Delone
set. By Lemma 1.5.3, the set of eigenvalues of Q consists of algebraic integers.
Following Mauduit [48], we say that a set P of algebraic integers forms a Pisot
family if for every λ ∈P and every Galois conjugate λ′ of λ, if λ′ ̸∈P, then
|λ′| < 1.
The link from eigenvalues to Number Theory comes from the following, which
we restate here in different terms:
Theorem 1.6.6 ([58, Thm. 4.3]) Let Λ be a repetitive substitution Delone m-set
with expansion map Q, which has FLC. Let Ξ(Λ) be the set of “inter-atomic”
vectors deﬁned in (1.7). If α ∈Rd is an eigenvalue for (XΛ, Rd, μ), then for any
x ∈Ξ(Λ) we have ∥⟨Qnx, α⟩∥→0 as n →∞.
Here ∥t∥denotes the distance from t to the nearest integer. Then we apply the
following result, a generalization of the classical Pisot theorem, which we only
partially state:
Theorem 1.6.7 ([34, 48]) Let λ1, . . . , λr be distinct algebraic numbers such that
|λi| ≥1, i = 1, . . ., r, and let P1, . . . , Pr be nonzero polynomials with complex
coefﬁcients. If r
i=1 Pi(n)λn
i is real for all n and
lim
n→∞



r

i=1
Pi(n)λn
i



 = 0,
Then {λ1, . . . , λr} is a Pisot family.
1.7
Concluding Remarks and Open Problems
This material was not presented in the talk; we hope it provides a useful supplement
to the Notes, without any claims of being comprehensive.

26
B. Solomyak
1.7.1
Inﬁnite Local Complexity
The FLC—ﬁnite type assumption—is often too restrictive. In the general case the
metric (1.11) is replaced by
ϱ(Λ1, Λ2) := min{ϱ(Λ1, Λ2), 2−1/2} ,
where we deﬁne ϱ(Λ1, Λ2) as
inf{ε > 0 : B1/ε(0) ∩Λ1 ⊂Λ2 + Bε(0), B1/ε(0) ∩Λ2 ⊂Λ1 + Bε(0)}.
The induced topology is called the local rubber topology in [6], see also [11]; it
agrees with the topology induced by the vague topology on measures, if we identify
a Delone set Λ with the measure δΛ = 
λ∈Λ, called the “Dirac comb”. The “hull”
XΛ of Λ is then deﬁned as the closure of the translation orbit of Λ in this metric.
The space XΛ is compact, and we get a topological dynamical system (XΛ, Rd),
where the action is by translations. A similar construction works for tilings as well.
Dynamical properties of general non-FLC Delone dynamical systems have been
studied in [23, 52], in particular, questions of minimality and unique ergodicity.
There is a large literature on non-FLC tiling substitutions. In particular, two large
classes have been considered:
(I) The tiling has ﬁnite local complexity with respect to the larger group of
Euclidean isometries, but the prototiles appear in inﬁnitely many (dense)
orientations. This is caused by a presence of irrational rotation in the expansive
linear map associated with the tile substitution. The best known example in this
class is the pinwheel tiling of Conway and Radin [54]; see also the recent [24]
and references therein.
(II) There are ﬁnitely many prototiles up to translation, but the FLC breaks down.
Substitution tilings of this kind were constructed by Danzer [13] and Kenyon
[31], and investigated more systematically by Frank and Robinson [17]. This
phenomenon is usually associated with a non-Pisot expansion factor. In this
setting we have also recently studied the question of unique ergodicity and
spectral properties, in a joint work with J.-Y. Lee [43].
A very general class of hierarchical tilings, which includes all of the above
and much more (“fusion tilings”) was considered by Frank and Sadun [18–20];
see [16] in this volume for details and additional references. See also [22] by
D. Frettlöh for a comprehensive review of classes of hierarchical tilings.
1.7.2
Pure Discrete Spectrum
We would be amiss without any mention of the problem: when is the dynamical
system (XΛ, Rd, μ) pure discrete? There is a huge literature devoted to it, so we only

1
Delone Sets and Dynamical Systems
27
make a few remarks, referring the reader to [7] and references there for additional
information. Here we do not give precise deﬁnitions, and also do not necessarily
distinguish between Delone sets, m-sets, and multisets.
First of all, pure discrete dynamical spectrum is equivalent to pure discrete
diffraction spectrum, under very general conditions: [6, 26, 40, 44] are some of the
papers devoted to this question.
Lagarias [38] calls a Delone set Λ purely diffractive, or Patterson set, if it has a
unique autocorrelation measure γΛ, for which the associated diffraction measure γΛ
is pure point. Lagarias [38, Problem 4.10] asked whether for a repetitive Delone set
of ﬁnite type, being purely diffractive implies being a Meyer set. In this generality
the answer is “no”, a counter-example, called the scrambled Fibonacci tiling, was
given in [19] (see also [28]). As already mentioned, if we additionally assume that
Λ is a primitive substitution Delone m-set, then the answer is “yes”. This was [38,
Problem 4.11].
Pure discrete spectrum has been linked with various notions of almost peri-
odicity. Let us say that y ∈Rd is a statistical ε-period of a Delone set Λ if
dens(Λ △(Λ −y)) ≤ε, where dens is the upper density of a set deﬁned by
dens = lim sup
R→∞
1
Vol(BR)♯(Λ ∩BR(0)).
From our result in [59] it follows that if the set of statistical ε-periods is relatively
dense in Rd for all ε > 0, then the dynamical spectrum is pure discrete (for any
ergodic invariant measure). Baake and Moody [9] proved, in particular, that if Λ is
Meyer, then this condition is also necessary (their result is much more general; this
is just one of the consequences of the theory developed in [9]). Gouéré extended
this further and proved that a Delone set is a Patterson set if and only if it is almost
periodic in the Besicovitch pseudo-metric deﬁned by
ϱ(Λ, Λ′) = lim sup
R→∞
1
Vol(BR)

BR(0)
ϱ(Λ −t, Λ′ −t) dt.
For the most up-to-date results on this topic see the chapter by N. Strungaru [63] in
[4].
Given a Delone set Λ, the corresponding Dirac comb δΛ is called strongly almost
periodic if δΛ ∗φ is a Bohr almost periodic function, for any continuous compactly
supported function φ. Lagarias [38, Problem 4.4] asked with this property implies
that Λ is completely periodic. Kellendonk and Lenz [29] demonstrate that the
answer is “yes” in the FLC case, but “no” in the general case. They also show that
the strong almost periodicity is equivalent to the dynamical system (XΛ, Rd) being
equicontinuous.
Regular model sets form an important class of pure diffractive Delone sets. We
deﬁned cut-and-project sets in Deﬁnition 1.3.2, with a Euclidean internal space H.
More generally, the internal space may be taken to be a locally compact Abelian
group G, and the cut-and-project set corresponding to a window Ω ⊂H and a

28
B. Solomyak
lattice Γ < Rd × G is deﬁned similarly. It is called a regular model set if the
boundary ∂Ω has zero Haar measure in G. Repetitive regular modular sets are
known to be pure point diffractive, and they have only topological eigenvalues
[27, 57]. Baake et al. [8] characterized the dynamical systems associated to repetitive
regular model sets as those which satisfy the following four conditions: (a) all
elements of the space X = XΛ are Meyer sets; (b) the translation Rd-action is
minimal and uniquely ergodic; (c) the measure-preserving Rd-action has pure point
dynamical spectrum and all eigenvalues are topological, and (d) the continuous
eigenfunctions separate almost all points of the space X.
Many papers are devoted to the question of pure point spectrum for substitutions,
in the symbolic, tiling, and Delone m-set frameworks, but we only mention a few.
On the Pisot discrete spectrum conjecture, the reader should see [1]. For self-
afﬁne tilings and substitution Delone m-sets criteria for pure pointedness based on
“coincidence conditions” were obtained in [41, 58], and an efﬁcient algorithm for
checking them was developed in [2].
1.7.3
Fourier Quasicrystals
Following Lagarias [38], say that a uniformly discrete set Λ ⊂Rd is a Fourier
quasicrystal, if there exists a translation bounded measure μ supported on Λ,
such that the Fourier transform μ (in the distribution sense) is a discrete measure.
(Sometimes the measure μ is called a Fourier quasicrystal.) The set of point masses
of μ is called the spectrum of μ. A Dirac comb δΛ for a lattice Λ is a classical
example.
A Fourier quasicrystal is necessarily a Patterson set (see [38]), but the converse
does not hold. Meyer’s model sets are Fourier quasicrystals [49], with a dense
spectrum of the corresponding measure.
Roughly speaking, in building a Fourier quasicrystal on a Patterson set, the
problem is how to choose the “weights” ψ(y) for the measure μ = 
y∈Λ ψ(y)δy,
in order for the Fourier transform μ to be a discrete measure. This requires careful
“accounting” of the “phase information” coming from μ, which is lost when
considering the diffraction measure (see [38] for details).
[38, Problem 4.1(a) ] asked whether a Fourier quasicrystal Λ, such that the
spectrum of the corresponding measure μ = 
y∈Λ ψ(y)δy is also a uniformly
discrete set, is necessarily contained in L + F, where L is a lattice in Rd and F
is a ﬁnite set. Lev and Olevskii [45] proved that the answer is “yes” in Rd for any
d ≥1, if the weights ψ(y) are positive, and also for d = 1 for arbitrary weights.
The case of Rd, d ≥2, and arbitrary weights is apparently still open. [38, Problem
4.1(b) ] asked whether the conclusion still holds if the support of μ and its spectrum
are only assumed to be closed discrete sets. Here the answer is “no,” as shown by
the same authors in [46].

1
Delone Sets and Dynamical Systems
29
1.7.4
Open Problems (Expansion Maps)
In Sect. 1.5.4 we discussed results on the characterization of expansion maps for
self-similar and self-afﬁne tilings, assuming FLC. Even there, not everything is
understood:
Problem 1 Suppose that Q is a “generalized Perron expansion map” in Rd (as
described in Sect. 1.5.4). Does there exists a self-afﬁne tiling with expansion Q?
Perhaps, with expansion Qn for n sufﬁciently large?
The problem seems to be completely open without the FLC assumption.
Problem 2 Which expansive linear maps Q can arise as expansions for a substitu-
tion tiling in Rd, without FLC? Assume that there are ﬁnitely many prototiles, either
up to translation, or up to Euclidean isometries. Maybe assume that Q is a pure
dilation by λ > 1 for the beginning.
The only thing we know about this is that det(Q) must be a Perron number
(assuming the substitution is primitive), and of course, the examples.
Acknowledgments Thanks to CIRM, Luminy, for hospitality and for providing a perfect work
environment. The author is grateful to Shigeki Akiyama, the 2017 Morlet Chair, and to Pierre
Arnoux for the invitation and for running a very successful and stimulating program. Valuable
comments and suggestions from M. Baake and anonymous referees are gratefully acknowledged.
Additional thanks are due to S. Akiyama and an anonymous volunteer for their help with the
ﬁgures. The research of B.S. was supported by the Israel Science Foundation (Grant 396/15).
References
1. S. Akiyama, M. Barge, V. Berthé, J.-Y. Lee, A. Siegel, On the Pisot substitution conjecture, in
Mathematics of Aperiodic Order, ed. by J. Kellendonk, D. Lenz, J. Savinien, Progr. Math.,
vol. 309 (Birkhäuser/Springer, Basel, 2015), pp. 33–72
2. S. Akiyama, J.-Y. Lee, Algorithm for determining pure pointedness of self-afﬁne tilings. Adv.
Math. 226, 2855–2883 (2011)
3. M. Baake, U. Grimm, Aperiodic Order. Vol. 1: A Mathematical Invitation (Cambridge
University Press, Cambridge, 2013)
4. M. Baake, U. Grimm (eds.), Aperiodic Order, Vol. 2. Crystallography and Almost Periodicity.
Encyclopedia of Mathematics and Its Applications, vol. 166 (Cambridge University Press,
Cambridge, 2017)
5. M. Baake, M. Schlottman, P.D. Jarvis, Quasiperiodic tilings with tenfold symmetry and
equivalence with respect to local derivability. J. Phys. A 24, 4637–4654 (1991)
6. M. Baake, D. Lenz, Dynamical systems on translation bounded measures: pure point dynamical
and diffraction spectra. Ergodic Theory Dyn. Syst. 24, 1867–1893 (2004)
7. M. Baake, D. Lenz, Spectral notions of aperiodic order. Discrete Contin. Dyn. Syst. 10, 161–
190 (2017)
8. M. Baake, D. Lenz, R.V. Moody, Characterization of model sets by dynamical systems. Ergodic
Theory Dyn. Syst. 26, 1–42 (2006)

30
B. Solomyak
9. M. Baake, R.V. Moody, Weighed Dirac combs with pure point diffraction. J. Reine Angew.
Math. (Crelle) 573, 61–94 (2004)
10. C. Bandt, Self-similar tilings and patterns described by mappings, in The Mathematics of Long-
Range Aperiodic Order (Waterloo, ON, 1995), ed. by R.V. Moody. NATO Adv. Sci. Inst. Ser.
C Math. Phys. Sci., vol. 489 (Kluwer Acad. Publ., Dordrecht, 1997), pp. 45–83
11. J. Bellissard, D.J.L. Herrmann, M. Zarrouati, Hulls of aperiodic solids and gap labeling
theorems, in Directions in Mathematical Quasicrystals, ed. by M. Baake, R.V. Moody. CRM
Monograph Series, vol. 13 (AMS, Providence, RI, 2000), pp. 207–258
12. D.W. Boyd, Salem numbers of degree four have periodic expansions, Théorie des nombres
(Quebec, PQ, 1987) (de Gruyter, Berlin, 1989), pp. 57–64
13. L. Danzer, Inﬂation species of planar tilings which are not of locally ﬁnite complexity. Proc.
Steklov Inst. Math. 230, 118–126 (2002)
14. B. Dundas, C. Skau, Interview with Abel laureate Yves Meyer. Eur. Math. Soc. Newsl. 105,
14–22 (2017)
15. S. Dworkin, Spectral theory and X-ray diffraction. J. Math. Phys. 34, 2964–2967 (1993)
16. N.P. Frank, Introduction to hierarchical tiling dynamical systems, in Substitution and Tiling
Dynamics: Introduction to Self-inducing Structures, ed. by S. Akiyama, P. Arnoux. Lecture
Notes in Mathematics (Springer, Cham, 2020)
17. N.P. Frank, E.A. Robinson, Jr., Generalized β-expansions, substitution tilings, and local
ﬁniteness. Trans. Am. Math. Soc. 360, 1163–1177 (2008)
18. N.P. Frank, L. Sadun, Topology of (some) tiling spaces without ﬁnite local complexity. Discrete
Contin. Dyn. Syst. 23, 847–865 (2009)
19. N.P. Frank, L. Sadun, Fusion: a general framework for hierarchical tilings of Rd. Geom.
Dedicata 171(1), 149–186 (2014)
20. N.P. Frank, L. Sadun, Fusion tilings with inﬁnite local complexity. Topology Proc. 43, 235–276
(2014)
21. N.P. Frank, B. Solomyak, A characterization of planar pseudo-self-similar tilings. Discrete
Comput. Geom. 26, 289–306 (2001)
22. D. Frettlöh, More inﬂation tilings, in Aperiodic Order, vol. 2, Encyclopedia Math. Appl., 166,
(Cambridge University Press, Cambridge, 2017), pp. 1–37
23. D. Frettlöh, C. Richard, Dynamical properties of almost repetitive Delone sets. Discrete Contin.
Dyn. Syst. 34(2), 531–556 (2014)
24. D. Frettlöh, A.L.D. Say-awen, M.L.A.N. De Las Peñas, Substitution tilings with dense tile
orientations and n-fold rotational symmetry. Indag. Math. (N.S.) 28(1), 120–131 (2017)
25. G. Gelbrich, Crystallographic reptiles. Geom. Dedicata 51, 235–256 (1994)
26. J.-B. Gouéré, Quasicrystals and almost periodicity. Commun. Math. Phys. 255, 655–681
(2005)
27. A. Hof, On diffraction by aperiodic structures. Commun. Math. Phys. 169, 25–43 (1995)
28. J. Kellendonk, L. Sadun, Meyer sets, topological eigenvalues, and Cantor ﬁber bundles. J.
Lond. Math. Soc. 89, 114–130 (2014)
29. J. Kellendonk, D. Lenz, Equicontinuous Delone dynamical systems. Canad. J. Math. 65, 149–
170 (2013)
30. R. Kenyon, Self-Similar Tilings. Ph.D Thesis (Princeton University, NJ, 1990)
31. R. Kenyon, Self-replicating tilings, in Symbolic Dynamics and Its Application (New Haven,
CT, 1991), ed. by P. Walters. Contemp. Math., vol. 135 (American Mathematical Society,
Providence, RI, 1992), pp. 239–263
32. R. Kenyon, The construction of self-similar tilings. Geom. Funct. Anal. 6, 471–488 (1996)
33. R. Kenyon, B. Solomyak, On the characterization of expansion maps for self-afﬁne tilings.
Discrete Comput. Geom. 43, 577–593 (2010)
34. I. Környei, On a theorem of Pisot. Publ. Math. Debrecen 34(3–4), 169–179 (1987)
35. J. Kwapisz, Inﬂations of self-afﬁne tilings are integral algebraic Perron. Invent. Math. 205,
173–220 (2016)
36. J.C. Lagarias, Meyer’s concept of quasicrystal and quasiregular sets. Commun. Math. Phys.
179, 365–376 (1996)

1
Delone Sets and Dynamical Systems
31
37. J.C. Lagarias, Geometric models for quasicrystals I. Delone sets of ﬁnite type. Discrete
Comput. Geom. 21, 161–191 (1999)
38. J.C. Lagarias, Mathematical quasicrystals and the problem of diffraction, in Directions in
Mathematical Quasicrystals, ed. by M. Baake, R.V. Moody. CRM Monograph Series, vol.
13 (AMS, Providence, RI, 2000), pp. 61–93
39. J.C. Lagarias, Y. Wang, Substitution Delone sets. Discrete Comput. Geom. 29, 175–209 (2003)
40. J.-Y. Lee, R.V. Moody, B. Solomyak, Pure point dynamical and diffraction spectra. Ann. Henri
Poincaré 3, 1003–1018 (2002)
41. J.-Y. Lee, R.V. Moody, B. Solomyak, Consequences of pure point diffraction spectra for
multiset substitution systems. Discrete Comput. Geom. 29, 525–560 (2003)
42. J.-Y Lee, B. Solomyak, Pure point diffractive substitution Delone sets have the Meyer property.
Discrete Comput. Geom. 39, 319–338 (2008)
43. J.-Y. Lee, B. Solomyak, On substitution tilings and Delone sets without ﬁnite local complexity.
Discrete Contin. Dyn. Syst. 39(6), 3149–3177 (2019)
44. D. Lenz, N. Strungaru, Pure point spectrum for measure dynamical systems on locally compact
Abelian groups. J. Math. Pures Appl. 92, 323–341 (2009)
45. N. Lev, A. Olevskii, Quasicrystals and Poisson’s summation formula. Invent. Math. 200, 585–
606 (2015)
46. N. Lev, A. Olevskii, Quasicrystals with discrete support and spectrum. Rev. Mat. Iberoam.
32(4), 1341–1352 (2016)
47. D. Lind, The entropies of topological Markov shifts and a related class of algebraic integers.
Ergodic Theory Dyn. Syst. 4, 283–300 (1984)
48. C. Mauduit, Caractérisation des ensembles normaux substitutifs. Invent. Math. 95, 133–147
(1989)
49. Y. Meyer, Algebraic Numbers and Harmonic Analysis (North-Holland, Amsterdam, 1972)
50. Y. Meyer, Quasicrystals, Diophantine approximation and algebraic numbers, in Beyond
quasicrystals (Les Houches, 1994), ed. by F. Axel, D. Gratias (Springer, Berlin, 1995), pp.
3–16
51. R.V. Moody, Meyer sets and their duals, in The Mathematics of Long-Range Aperiodic Order
(Waterloo, ON, 1995), ed. by R.V. Moody. NATO Adv. Sci. Inst. Ser. C Math. Phys. Sci. vol.
489 (Kluwer, Dordrecht, 1997), pp. 403–441
52. P. Müller, C. Richard, Ergodic properties of randomly coloured point sets. Canad. J. Math. 65,
349–402 (2013)
53. W. Parry, On the β-expansions of real numbers. Acta Math. Acad. Sci. Hungar. 11, 401–416
(1960)
54. C. Radin, The pinwheel tilings of the plane. Ann. Math. 139, 661–702 (1994)
55. E.A. Robinson, Symbolic dynamics and tilings of Rd, in Symbolic Dynamics and Its Appli-
cations, ed. by S.G. Williams. Proc. Sympos. Appl. Math., vol. 60 (American Mathematical
Society, Providence, RI, 2004), pp. 81–119
56. R. Salem, Algebraic Numbers and Fourier Analysis (D. C. Heath and Co., Boston, MA, 1963)
57. M. Schlottman, Generalized model sets and dynamical systems, in Directions in Mathematical
Quasicrystals, ed. by M. Baake, R.V. Moody. CRM Monograph Series, vol. 13 (American
Mathematical Society, Providence, RI, 2000), pp. 143–159
58. B. Solomyak, Dynamics of self-similar tilings. Ergodic Theory Dyn. Syst. 17, 695–738 (1997)
[Corrections: ibid. 19 (1999), 1685.]
59. B. Solomyak, Spectrum of dynamical systems arising from Delone sets, in Quasicrystals and
Discrete Geometry, ed. by J. Patera. The Fields Institute for Research in Mathematical Sciences
Monograph Series, vol. 10 (American Mathematical Society, Providence, RI, 1998), pp. 265–
275
60. B. Solomyak, Pseudo-self-afﬁne tilings in Rd. Zap. Nauchn. Semin. POMI 326, 198–213
(2005); translation in J. Math. Sci. (N.Y.) 140, 452–460 (2007)
61. B. Solomyak, Tilings and Dynamics. EMS Summer School on Combinatorics, Automata and
Number Theory, 8–19 May 2006, Liege, available at address http://u.math.biu.ac.il/~solomyb/
PREPRINTS/liege.pdf

32
B. Solomyak
62. N. Strungaru, Almost periodic measures and long-range order in Meyer sets. Discrete Comput.
Geom. 33, 483–505 (2005)
63. N. Strungaru, Almost periodic pure point measures, in Aperiodic Order, vol. 2. Encyclopedia
Math. Appl., vol. 166 (Cambridge University Press, Cambridge, 2017), pp. 271–342
64. W. Thurston, Groups, Tilings, and Finite State Automata. AMS Lecture Notes (1989)

Chapter 2
Introduction to Hierarchical Tiling
Dynamical Systems
Natalie Priebe Frank
Abstract This chapter is about the tiling dynamical systems approach to the study
of aperiodic order. We compare and contrast four related types of systems: ordinary
(one-dimensional) symbolic systems, one-dimensional tiling systems, multidimen-
sional Zd-systems, and multidimensional tiling systems. Aperiodically ordered
structures are often hierarchical in nature, and there are a number of different
yet related ways to deﬁne them. We will focus on what we are calling “supertile
construction methods”: symbolic substitution in one and many dimensions, S-
adic sequences, self-similar and pseudo-self-similar tilings, and fusion rules. The
techniques of dynamical analysis of these systems are discussed and a number
of results are surveyed. We conclude with a discussion of the spectral theory of
supertile systems from both the dynamical and diffraction perspectives.
2.1
Introduction
The central objects in these lecture notes are tilings constructed via a variety of
methods that together we call supertile methods. These tilings display hierarchical
structure that is highly ordered yet not periodic. Their study is truly multidisci-
plinary, having originated in ﬁelds as disparate as logic, chemistry and geometry.
To motivate the topic we offer three examples from the history of the ﬁeld that are
relevant to these lectures.
First, imagine square tiles whose edges come in given combinations of colors,
and you are only allowed to put two tiles next to each other if the edge colors match.
Can you make an inﬁnite tiling of the plane with these tiles? This is the question
logician Hao Wang was considering in 1961 [105]. In particular he was thinking
about the decidability of what is now known as the domino problem: “Given a ﬁnite
N. P. Frank ()
Department of Mathematics and Statistics, Vassar College, Poughkeepsie, NY, USA
e-mail: nafrank@vassar.edu
© The Editor(s) (if applicable) and The Author(s), under exclusive license
to Springer Nature Switzerland AG 2020
S. Akiyama, P. Arnoux (eds.), Substitution and Tiling Dynamics: Introduction
to Self-inducing Structures, Lecture Notes in Mathematics 2273,
https://doi.org/10.1007/978-3-030-57666-0_2
33

34
N. P. Frank
set of tiles in the plane, can it be made to form an inﬁnite tiling?” The answer
depended on whether an aperiodic prototile set exists, i.e. a set of tiles that are able
to form an inﬁnite tiling of the plane, but every tiling they make must be nonperiodic.
The question was proved to be undecidable by Robert Berger [22] with the discovery
of an aperiodic set of prototiles. That prototile set had over 20,000 tiles in it, but
in 1971 Raphael Robinson published an aperiodic set with only 6 tiles [94]. In
Robinson’s version the hierarchical structure is clearly evident and in fact drives the
proof of aperiodicity. In this volume in [63] we ﬁnd four proofs of undecidability,
including how to construct the aperiodic tile set(s).
A second development, which entered the public consciousness through a
Scientiﬁc American article by Martin Gardner [54], was Penrose’s 1974 discovery of
an aperiodic set of two tiles. In the middle of the twentieth century, Roger Penrose
began to develop an interest in tiling questions in part because of Hilbert’s Problem
18. The interest intensiﬁed as Penrose and his father developed a collaboration with
M. C. Esher (see the foreword to [11]). Penrose was trying to create a hierarchical
tiling and found his original tiling (which in that foreword he tells us is [82, Fig. 4])
by experimentation.
There are a number of versions of Penrose tilings, all of which can be generated
by a supertile method. In Figs. 2.1 and 2.2 we show a pseudo-self-similar version
(see Sect. 2.4.4.2), for which the tiles also form an aperiodic tile set. Figure 2.1
shows the rule for inﬂating and replacing the tiles, and Fig. 2.2 shows the result of
inﬂating and replacing a central patch twice.
The third and possibly most invigorating development we mention here is the
discovery of quasicrystals in 1982 [97]. This earned Dan Shechtman the Wolf
Prize in Physics in 1999 and the Nobel Prize in Chemistry in 2011 [73]. In his
laboratory in what is now the U. S. National Institute of Standards and Technology,
Shechtman analyzed an aluminum-magnesium alloy and found that its diffraction
image revealed contradictory properties: it had bright spots indicative of a periodic
atomic structure, but had symmetries impossible for such a structure. The discovery
went against all conventional wisdom at the time, but eventually the scientiﬁc
community accepted that there was no mistake, this alloy did indeed display ‘quasi’-
crystalline structure. In some of the images in Fig. 2.3 one can see the ‘forbidden’
tenfold rotational symmetries.
Fig. 2.1 The Penrose rhombuses and their inﬂate-and-subdivide rules

2
Introduction to Hierarchical Tiling Dynamical Systems
35
Fig. 2.2 1-, 2-, and 3-supertiles for the Penrose rhombus tiling
63.43°
31.72°
79.2°
58.29°
37.38°
36°
Fig. 2.3 The quasicrystal diffraction images as they appear in the original paper [97]
Coincidentally, in 1982 Alan Mackay [77] published the diffraction pattern of a
Penrose tiling, shown in its original form in Fig. 2.4. Once Shechtman’s diffraction
pattern was published, it did not take long for similarities between it and Mackay’s
to be noticed. This established Penrose tilings and highly structured tilings like
them (including some generated by supertile methods), as mathematical models
of quasicrystals. It is apparent that spectral methods, then, are an interesting way
to study aperiodic tilings. Spectral analysis, including mathematical diffraction, has

36
N. P. Frank
Fig. 2.4 The Penrose
diffraction image as it appears
in the original paper [77]
proved to be an effective tool for the study of tilings generated by supertile methods.
The last three sections of these notes discuss spectral theory from dynamical and
diffraction perspectives.
2.1.1
Outline of the Paper
In Sect. 2.2 we begin by giving general deﬁnitions of the four types of structures
of interest and the basic relationships between them. Speciﬁcs of why and how the
dynamical systems viewpoint is used appears in Sect. 2.3. In this section we compare
and contrast how the metrics are related, show how standard dynamical properties
like minimality can be interepreted, and talk about invariant measures and their
connection to the idea of frequency. In Sect. 2.4 we learn about the various supertile
construction methods and give examples of many of them. In Sect. 2.5 we introduce
the idea of transition matrices and how their properties allow us to extend dynamical
results to supertile systems. Section 2.6 is devoted to the dynamical spectrum of

2
Introduction to Hierarchical Tiling Dynamical Systems
37
supertile systems, while Sect. 2.7 is devoted to their diffraction spectra. Section 2.8
presents results on the connection between the two types of spectrum. We conclude
in Sect. 2.9 with a selection of references.
2.1.2
Not Covered
The ﬁeld of aperiodic order and tiling dynamical systems spans a broad range of
topics and we have not attempted to give a complete survey. Topics we do not
discuss include tiling cohomology, matching rules, the projection method, tilings
with inﬁnite local complexity, K-theory of C∗-algebras for tilings, spectral triples,
decidability and tiling problem questions. Moreover we do not consider tilings of
hyperbolic space or other spaces, or anything about the spectrum of Schrodinger
operators modeled on tilings.
2.2
The Fundamental Objects
2.2.1
Motivation: Shift Spaces
The way that we study tiling spaces is a generalization of symbolic dynamics, a
large branch of dynamical systems theory. Thus we begin by describing the basic
setup in this situation.
Let A be a ﬁnite set we will call our alphabet. A sequence is a function x :
Z →A and we denote the set of all sequences to be AZ. We equip the space with
a metric that deﬁnes the product topology, as follows. Let N(x, y) = min{n ≥
0 such that x(j) ̸= y(j) for some |j| = n}, and deﬁne d(x, y) to be exp(−N(x, y)).
That is, x and y are very close if they agree on a large ball centered at the origin.
For each j ∈Z, we can shift a sequence x by j, yielding the sequence x −j
deﬁned by (x −j)(k) = x(k + j). This is known as the shift map, and is a Z-action
on sequences. (Notice that (x −j)(0) = x(j), meaning that x has been shifted so
that what was at j is now at the origin.) The space AZ along with the shift map is
known as the full shift on |A| symbols.1 The shift map allows us to investigate the
long-range structure of sequences by moving distant parts ‘into view’ of the origin.
This perspective is consistent with our choice of metric topology.
There is already some dynamics to study for the full shift, but things get much
more interesting when we restrict our attention to closed, nonempty, shift-invariant
subsets Ω ⊂AZ. We call such an Ω a shift space or subshift of AZ and use
the terminology shift dynamical system for (Ω, Z). Subshifts are handy tools for
1Ordinarily in the literature the shift map is given with notation like σ(x), so that x −j = σ j(x).
We use the notation “x −j” instead to be consistent with the more general case.

38
N. P. Frank
encoding the dynamics of many types of systems, and they also arise in natural
processes. Readers interested in diving into the vast literature on this subject might
ﬁnd [6, 42, 67, 74, 76] in their libraries.
Example 1 Let Ω consist of the periodic sequences . . . 0101.0101 . . . and its shift
. . . 1010.1010 . . ., where the decimal point is there to denote where the origin is.
Shifting by j ∈Z just moves the decimal point j units to the right (or left, if j is
negative). One sees quickly that Ω is shift-invariant and that the dynamical system
is periodic with period 2.
Because periodic systems like these are completely understood we will tend to
assume that the sequences in our sequence spaces are not periodic. Instead, supertile
construction methods generate sequences with just the right amount of long-range
order to be tractable for analysis.
2.2.2
Straightforward Generalization: Sequences in Zd
Let A be a ﬁnite alphabet and consider AZd to be the set of all sequences in
Zd, that is, functions from Zd to A. Given x, y ∈AZd, let N(x, y) = min{n ≥
0 such that x(j) ̸= y(j) for some |j| = n}, where |j| is the largest absolute value
of the components of j. Then d(x, y) = exp(−N(x, y)) provides an origin-centric
metric as before.
Translation by elements of Zd is deﬁned as before and provides a way to
analyze the structure of multidimensional sequences. There are complications and
considerations due to the extra dimensions that we will discuss as we encounter
them.
2.2.3
Straightforward Generalization: Tilings of R
We choose a closed interval for each symbol in A. For any element x ∈AZ make
a tiling by placing the interval corresponding to x(0) with its left endpoint at 0, and
placing copies of all the other symbols of x in the corresponding order, with overlap
at the interval endpoints. In this perspective a tile is a closed interval labelled by an
element of A. Tiles and tilings can be translated by elements of R and there is an
origin-centric tiling metric that we will describe in the general situation in the next
section.
Figure 2.5 depicts a tiling of R with two tile types, a longer interval pic-
tured in dark blue and a shorter interval pictured in light blue. (The colors
represent the labels). The patch shown corresponds to the symbolic sequence
. . . abbbaaaabbbabbbabbba. . .

2
Introduction to Hierarchical Tiling Dynamical Systems
39
Fig. 2.5 A patch of a one-dimensional tiling with two tile lengths
2.2.4
Geometric Generalization: Tilings of Rd
The ﬁnite alphabet A is replaced by a ﬁnite prototile set P. A prototile p ∈P is a
closed topological disk in Rd carrying a label (for instance, a color). The closed set
is known as the support of p (denoted supp(p)) and the label is there to distinguish
any tiles that may have congruent shapes. We can apply any self-map of Rd to a
prototile by applying it to the support and carrying the label along. Although it is
common to use some or all elements of the Euclidean group to move tiles around,
we restrict our attention to translations only. A P-tile or just tile is any translate of
a prototile from P. Two tiles are equivalent if their supports are translates of each
other and they carry the same label.
Consider some ﬁxed set of prototiles P. A P-patch (or patch when the prototile
set is understood) is a set of tiles that intersect at most on their boundaries that is
supported on a connected set in Rd. For technical reasons it is often assumed that
the supports form a topological disk. A P-tiling or just tiling of Rd is a collection
of tiles that ‘cover’ Rd in the sense that the union of the tile supports is Rd, but also
‘pack’ Rd in the sense that any two supports intersect only on their boundaries. Let
ΩP denote the space of all P-tilings. As with the full shift AZ, in which an element
is an inﬁnite sequence, elements of ΩP are inﬁnite tilings of Rd.
Like tiles, patches and tilings can be translated by elements of Rd. We write
T −v to denote the tiling obtained by translating the support of every tile of T by
v. Note that the origin in T −v corresponds to v in T , so this translation brings the
neighborhood of v into view of the origin.
Analogous to the simpler cases, we say a tiling T is nonperiodic if there is no v
for which T −v = T . In higher dimensions it is possible to be periodic in some
directions but not fully periodic: the directions of periodicity must form a basis for
Rd for full periodicity.
Now geometry plays a fundamental role, and there is the possibility that tiles in a
tiling can be adjacent in many different ways. Consider the tiling in Fig. 2.6, which
is constructed from a set of four rectangular tiles, with side lengths given by 1 and
1+
√
17
2
. There are many offsets where vertices meet edges, and the number of those
offsets will go to inﬁnity as we consider larger and larger patches.
Deﬁnition 2.2.1 We say a tiling T ∈ΩP has ﬁnite local complexity (FLC) if it
contains only ﬁnitely many two-tile patches up to translation. A subset of tilings
Ω ⊂ΩP is said to have ﬁnite local complexity if there are only ﬁnitely many
two-tile patches up to translation in Ω.

40
N. P. Frank
Fig. 2.6 A patch of a tiling with four prototiles and inﬁnite local complexity
For the purposes of this work we assume ﬁnite local complexity in all tilings and
tiling spaces unless otherwise stated.2
It is convenient to have notation for the patch of a tiling that intersects a subset of
Rd. Let T be a tiling of Rd and let B ⊂Rd. The patch of tiles in T whose supports
intersect B is denoted T ∩B. One could say that T has ﬁnite local complexity if the
set of patches

T ∩{x} such that x ∈Rd
is ﬁnite up to translation.
2FLC is a common restriction, but if you want to learn about the inﬁnite local complexity case see
[47] and references within.

2
Introduction to Hierarchical Tiling Dynamical Systems
41
2.3
The Dynamical Systems Viewpoint
2.3.1
Tiling Spaces
A tiling space is a translation-invariant subset Ω of the full tiling space ΩP that is
closed in the metric we describe next. We form a dynamical system by letting an
additive subgroup G of Rd act on it by translation. Ordinarily G is just Rd itself, but
occasionally it might be Zd or some other full rank subgroup. We use the notation
(Ω, G) to denote the tiling dynamical system.
2.3.1.1
The “big ball” Metric
The metric used in dynamical systems theory for tilings is modeled on the metric
for shift spaces, and therefore is also origin-centric. The deﬁnition of the metric
becomes technical because translation is a continuous action and because the
prototiles can have interesting geometry. Still the basic idea is that two tilings are
close if they very nearly agree on a ball around the origin.
We give the deﬁnition of metric for tilings of ﬁnite local complexity. Let T and
T ′ be tilings of Rd from a prototile set P. Informally, we say T and T ′ are within
ϵ of one another if they agree on a ball of radius 1/ϵ, except for a small translation.
Here is a formal deﬁnition.
Deﬁnition 2.3.1 Let R(T , T ′) be the supremum of all r ≥0 such that there exists
x, y ∈Rd with
1. |x| < 1/2r and |y| < 1/2r, and
2. On the ball of radius r around the origin, (T −x) ∩Br(0) = (T ′ −y) ∩Br(0).
We deﬁne
d(T , T ′) := min

1
R(T , T ′), 1

.
There are various versions in the literature; this version parallels [100].
2.3.1.2
Two Common Ways to Construct Tiling Spaces
There are two main ways that tiling spaces are constructed. One is to make a closed,
translation-invariant space around a given tiling; in this situation the space is called
the ‘hull’ of the tiling. The other is to specify an ‘atlas’ of allowed patches and
include tilings that contain these patches only.

42
N. P. Frank
For the ﬁrst method, suppose there is some tiling T ∈ΩP that is of particular
interest. We can construct the hull of the tiling T as the orbit closure of T :
ΩT = {T −v for all v}.
By deﬁnition it is closed and it is not difﬁcult to show that it is translation-invariant.
The second method is akin to making a shift space from a language of allowed
words. Let R be a set of P-patches. We say that T ∈ΩP is allowed by R if every
patch in T is translation-equivalent to a subpatch of an element of R. The tiling
space ΩR is the set of all allowed tilings.
We will ignore all questions of which types of rules R admit non-trivial tiling
spaces, referring them to theoretical computer scientists and/or logicians. But it
should be clear that if nontrivial, ΩR should be translation-invariant and closed
in the big ball metric.
2.3.1.3
Cylinder Sets and the Metric Topology
Because both are important to our further analysis we discuss these topics for both
the motivating symbolic case and for the tiling situation.
In symbolic dynamics the fundamental sets are cylinder sets. Consider a shift
space Ω and suppose w is a ﬁnite word in A∗, where A∗is the set of non-
empty words on A. The cylinder set Ωw generated by w is given by Cw = {x ∈
Ω such that x(U) = w}; it is the set of all sequences that contain the word w in the
location given by U, with no other restrictions. One can check that cylinder sets are
both closed and open in the metric topology. One can also check that for any ϵ > 0
and any x ∈Ω, the ball of radius ϵ around x is a cylinder set for a word around the
origin in x. Thus cylinder sets form a basis for the topology in shift spaces. When
we are considering sequences in Zd the cylinder sets are completely analogous.
The situation becomes somewhat more complicated for tilings of Rd when the
translation group G is uncountable. Let P be a P-patch, let U ⊂Rd, and let Ω ⊂
ΩP be a tiling space. The cylinder set ΩP,U is the set of all tilings in Ω that contain
a copy of P translated by an element of U. That is,
ΩP,U = {T ∈Ω such that P −u is aT −patch for some u ∈U}.
The reader can check that if ϵ is sufﬁciently small and U = Bϵ(0) (the open ball
of radius ϵ around the origin), the cylinder set is open. In [93, p. 13] we see how to
get a countable basis for the topology by discretizing ϵn →0, since there are only a
countable number of patches of any size up to translation.
The basic fact of compactness is proved in several works, see for example [92].
We include a short argument here for the tiling situation.
Lemma 2.3.2 If Ω ⊂ΩP is closed and of ﬁnite local complexity, then Ω is
complete and compact.

2
Introduction to Hierarchical Tiling Dynamical Systems
43
Proof Let {Tn} be a Cauchy sequence in Ω and ﬁx some K ∈Z. Consider ϵ > 0
for which 1/ϵ > K. There is some M such that for n, m ≥M, d(Tn, Tm) < ϵ.
This means that the patches Tn ∩B1/ϵ(0) and Tm ∩B1/ϵ(0) agree up to translation
by at most ϵ. Thus the patches Tn ∩BK(0) and Tm ∩BK(0) agree up to translation
< ϵ. As ϵ →0 there is a patch PK covering BK(0) that is the limit of the patches
Tn ∩BK(0). We obtain a nested sequence of patches PK and therefore there is a
tiling T such that PK ⊂T for all K ∈Z, and this tiling must be the limit of the
Cauchy sequence. All of the tiles in T belong in a PK for some K and so are P-tiles,
thus T ∈ΩP. Since Ω is closed we know T ∈Ω, proving sequential compactness.
Under many conditions, for instance topological transitivity, Ω is connected.
Each tiling in Ω deﬁnes a path component that is a continuous embedding of Rd. In
general there are uncountably many distinct P-tilings up to translation, and therefore
there are uncountably many path components.
2.3.2
Notions of Equivalence for Symbolic and Tiling
Dynamical Systems
Suppose we have a sequence in A = {0, 1}. In what way does it change if we
make every 0 into an a and every 1 into a b? What about if we had a checkerboard
tiling with black and white squares, and split each black square horizontally into two
rectangles? In the symbolic case there are local maps called “sliding block codes”
which determine factor maps and topological conjugacies between shift spaces. The
tiling equivalent is local derivability through local mappings.
2.3.2.1
Sliding Block Codes
We follow [74]. Let A and A′ be ﬁnite alphabets and suppose Ω is a shift space in
AZ. Choose nonnegative integers m and n and let Bm,n denote the set of all words
of length m + n + 1 that appear in Ω. Let Φ : Bm,n →A′ be any map. Then the
sliding block code φ : Ω →(A′)Z is deﬁned by this map via
yi = Φ(xi−mxi−m+1 · · · xi+n−1xi+n) = (φ(x))i.
Thus we see that a sliding block code will convert every sequence x to a sequence
y entry by entry, examining the block in x around xi and using it to determine the
value of yi. It is not difﬁcult to check that sliding block codes are continuous. This
powerful theorem tells us that sliding block codes are the only maps on shift spaces
that are both continuous and shift-commuting:

44
N. P. Frank
Theorem 2.3.1 (Curtis-Lyndon-Hedlund, See [74]) Suppose Ω and Ω′ are shift
spaces, not necessarily on the same alphabet, and let θ : Ω →Ω′. Then θ is a
sliding block code if and only if it is shift-commuting and continuous.
In particular this means that topological conjugacies between shift dynamical
systems are invertible sliding block codes and vice versa.
2.3.2.2
Local Derivability
Local mappings are the analogue to sliding block codes for tilings of Rd. We give a
brief deﬁnition here; a full exposition appears in section 5.2 of [11].
Deﬁnition 2.3.3 A continuous surjective mapping between tiling spaces Q : Ω →
Ω′ is a local mapping if there is an r > 0 such that for any x ∈Rd and T1, T2 ∈Ω,
if T1 ∩Br(x) = T2 ∩Br(x), then Q(T1) ∩{x} = Q(T2) ∩{x}.
That is to say, the patch in T containing the ball Br(x) completely determines the
tile at the center of the ball in Q(T ). If such a local mapping exists we say Q(T ) is
locally derivable from T . If Q is invertible we say T and Q(T ) are mutually locally
derivable, and we also use this terminology for their tiling spaces. It is not difﬁcult
to show that any local mapping is continuous in the big ball topology.
Lemma 2.3.4 If Ω and Ω′ are mutually locally derivable tiling spaces, then their
dynamical systems are topologically conjugate.
If there were to be a tiling analogue of the Curtis-Lyndon-Hedlund theorem, it
would mean that the only continuous translation-commuting maps between tiling
spaces are local mappings. That is, the above lemma would be an “if and only if”.
The fact that it is not was ﬁrst shown in [85] and [91].
Nonlocal homeomorphisms for tilings tend to require information from far
distances in T to settle the precise location of the origin in Q(T ). In Example 13 of
Sect. 2.4.7 we describe how to make a nonlocal homeomorphism between two tiling
spaces generated by a related pair of supertile methods.
2.3.3
Repetitivity and Minimality
Recall that a dynamical system is called transitive if there is a dense orbit and
minimal if every orbit is dense.
Deﬁnition 2.3.5 A tiling T is said to be repetitive3 iff for every ﬁnite patch P in T
there is an R = R(P) > 0 such that T ∩BR(x) contains a translate of P for every
3Also known in the literature as T being uniformly recurrent, almost periodic, and having the local
isomorphism property.

2
Introduction to Hierarchical Tiling Dynamical Systems
45
x ∈Rd. It is linearly repetitive iff there is a C > 0 such that for any T -patch P
there is a translate of P in any ball of radius C diam(P) in T .
In other words, a tiling is repetitive if for every patch P there is some radius R
such that every ball of that radius contains a copy of P. Moreover, it is linearly
repetitive if R can be taken to be C diam(P), that is, the radius depends only
linearly on the size of P. In [35, 36] it is shown that a symbolic system is linearly
repetitive if and only if it is “primitive and proper” S-adic (a supertile method
discussed in Sect. 2.4.5.2).
Standard arguments show the following, stated here using tiling terminology but
applicable to symbolic spaces as well.
Lemma 2.3.6 (See E.g. [92, 93, 100]) Let T ∈ΩP and let ΩT denote its hull. The
tiling dynamical system (ΩT , Rd) is minimal if and only if T is repetitive.
Large classes of supertile methods produce sequences or tilings that are repeti-
tive, and therefore their dynamical systems are minimal.
2.3.4
Invariant and Ergodic Measures
Let Ω be a shift or tiling space with topology given by the appropriate metric, and
let G be the group of translations deﬁning its dynamical system. A Borel probability
measure μ on Ω is said to be invariant with respect to translation if μ(A −g) =
μ(A) for all Borel measurable sets A and all g ∈G. We say μ is ergodic with
respect to translation if whenever A is a translation-invariant set, then μ(A) equals
0 or 1. The set of invariant Borel probability measures is convex and its extremal
elements are ergodic (see for example [84] or [104] for the general theory of ergodic
measures).
A dynamical system is said to be uniquely ergodic if it possesses only one
ergodic measure. Because the set of all invariant measures is convex and the ergodic
measures are the extremal measures from that set, this implies that the ergodic
measure is also the only invariant measure.
Let P be a P-patch and let U be a ﬁxed and very small ball so that if T ∈ΩP,U,
then P −g ∈T for at most one g ∈U. Denote by IP,U the indicator function for
ΩP,U and suppose μ is some ergodic measure for translation. Then from elementary
measure theory along with the ergodic theorem4 we know that for μ-almost every
T0 ∈Ω,
μ(ΩP,U) =

Ω
IP,U(T )dμ(T ) = lim
r→∞
1
V ol(Br(0))

Br(0)
IP,U(T0 −x)dx.
4For a more indepth discussion of the meaning of the word ‘frequency’ and the appropriate ergodic
theorem for this setting, see [50, Section 3.3].

46
N. P. Frank
Consider the integral on the right. For every copy of P in T0 ∩Br(0) that isn’t too
close to the boundary of Br(0) the indicator function will be 1 over a set of size
V ol(U). Any copy of P that is too close to the boundary will only yield a portion of
that, but as r →∞this effect is negligible. Letting the notation #(P ∈T0 ∩Br(0))
mean the number of copies of P in T0 ∩Br(0), it is straightforward to show that the
term on the right therefore becomes limr→∞#(P∈T0∩Br(0))
V ol(Br(0))
V ol(U). For μ-almost
every T0 we get the same answer and so we can say that μ deﬁnes a frequency
measure on the set of P-patches as:
μ(ΩP,U) = V ol(U)f reqμ(P).
2.4
Supertile Construction Techniques
When we consider a sequence or tiling space Ω under the action of translation it
is not particularly interesting if the elements of Ω are periodic. Considering the
dynamics on the full shift AZd or full tiling space ΩP is more interesting, since the
spaces have many properties including carrying many different measures, having
many possible letter/tile frequencies, and having nontrivial positive topological
and measure-theoretic entropies, for instance. But in this study we wish to apply
the theory to spaces whose elements all have common properties that arise from
given construction techniques. In particular we look at sequences and tilings
constructed via substitution or fusion, which we are generically terming “supertile
constructions”.
2.4.1
Motivation: Symbolic Substitutions
Introduced as examples of symbolic dynamical systems by Gottschalk in [57], these
are the fundamental (and simplest) objects on which our other supertile methods
are based. Much is known about substitution sequences and the books [42, 89] are
devoted to results on the subject. We will expose many of these results and see when
they have generalizations or fail to generalize to higher-dimensional structures.
Given a ﬁnite alphabet A, a substitution is a map σ : A →A∗, where A∗
is the set of non-empty words on A. The substitution can be applied to words by
concatenating the substitution of the letters in the word. We use the terminology
n-superword to mean a word of the form σ n(a) for some a ∈A.
A sequence x ∈AZ is said to be admitted by σ if every subword of x is a
subword of a superword of some size. We deﬁne Ωσ ⊂AZ to be the set of all
sequences admitted by σ. It is clear that Ωσ is a shift-invariant subset of AZ and the
reader can check that it is also closed in the metric topology deﬁned in Sect. 2.2.1.

2
Introduction to Hierarchical Tiling Dynamical Systems
47
Example 2 (A Constant-Length Substitution) Let A = {a, b} and let σ(a) = abb
and σ(b) = aaa. The ﬁrst few level-n blocks of type a are:
a →abb →abb aaa aaa →abb aaa aaa abb abb abb abb abb abb →· · · ,
where the spaces are there to help the reader see the level-n subblocks within. In
this example each letter is substituted by a block of the same length (in this case 3),
which is why the substitution is known as having constant length.
Clearly one could construct a substitution of constant length on any size of
alphabet and any given integer length. The family in the next example contains the
most famous and well-studied example of a substitution of non-constant length.
Example 3 (‘Noble Means’ Substitutions and the Fibonacci Substitution) Let A =
{a, b} and choose a positive integer k. Deﬁne σ(a) = akb and σ(b) = a, where by
‘ak’ we mean the word composed of k consecutive ‘a’s. For example, let k = 1. In
this case the ﬁrst several level-n blocks of type a are:
a →ab →ab a →ab a ab →ab a ab ab a →ab a ab ab a ab a ab →· · · ,
where again we’ve included spaces to help the reader distinguish the level-n
subblocks. Note that the superword lengths are Fibonacci numbers, and in fact all
of the superwords for k = 1 share this property. That is why this case is called the
Fibonacci substitution.
Of course Fibonacci numbers are closely related to the golden mean, and in fact it
is the larger eigenvalue of a matrix associated with the substitution (see Sect. 2.5.1).
When k is changed we obtain other ‘noble means’ (silver if k = 2) from this matrix.
All noble means substitutions have dynamical, spectral, and geometric properties in
common with one another and therefore with the Fibonacci tiling, which is well-
studied (see [11, 42, 89] and references therein).
The next family also contains the Fibonacci substitution, but in this class
Fibonacci is the outlier, having few properties in common with the other elements.
Example 4 Let A = {a, b}, choose a positive integer k, and let σ(a) = abk and
σ(b) = a. The ﬁrst few supertiles in the case where k = 3 are
a →abbb →abbb a a a →abbb a a a abbb abbb abbb →· · · .
A corresponding tiling of the line that yields well to spectral and dynamical analysis
is discussed next.

48
N. P. Frank
2.4.2
Generalization: One-dimensional Self-Similar Tilings
We know from Sect. 2.2.3 that we can take any sequence in AZ and convert it into
a tiling of R by choosing interval lengths for each element of A. We certainly can
do this for substitution sequences, and if we do it artfully we get tilings with some
geometry to exploit. The process of doing it artfully leads naturally to the idea of
inﬂation rules and self-similar tilings. It is worth doing in the context of an example
ﬁrst.
Example 5 Consider tiles ta and tb that are intervals of length |ta| and |tb| labelled
by a and b. For a positive integer k, we can use the symbolic substitution σ(a) =
abk and σ(b) = a to deﬁne a tile substitution S so that the patch S(ta) is the tile
ta followed by k tb’s and the patch S(tb) is just ta. In that case the lengths of the
supertiles are |S(ta)| = |ta| + k|tb| and |S(tb)| = |ta|.
The ideal situation, geometrically, would be if there was an “inﬂation factor”
λ > 1 such that |S(ta)| = λ|ta| and |S(tb)| = λ|tb|. A quick calculation yields that
this λ would have to satisfy the equation k = λ2 −λ. As expected, in the Fibonacci
case when k = 1, we obtain that λ is the golden mean. For larger values of k we
ﬁnd that λ is either ‘strongly non-Pisot’ or, occasionally, an integer. Later we will
discuss how the algebraic properties of λ affect the dynamics of the system. The
case where k = 3 yields λ = 1+
√
13
2
and the rule S is depicted in Fig. 2.7.
The k = 3 case is fully analyzed from a diffraction standpoint in [9] and as
the basis for a two-dimensional tiling with inﬁnite local complexity in [48]. The
diffraction spectrum for all values of k is given a preliminary analysis in [13] and
thorough treatment in [14].
Suppose now that σ is a symbolic substitution on a general ﬁnite alphabet A.
As before it is possible to ﬁnd the expansion factor and natural tile lengths (more
on that later). Suppose te is the tile corresponding to the symbol e ∈A. Then we
deﬁne S(te) to be the patch of tiles corresponding to σ(e), supported on the interval
λ supp(te). Often, S is referred to as an ‘inﬂation rule’ or an ‘inﬂate-and-subdivide
rule’.
We can extend S to be a map on the space of all tilings ΩP as follows. Let
T ∈ΩP be a tiling and let t ∈T be any tile. We deﬁne S(t) to be the patch given
by the substitution of the prototile of t, translated so that it occupies the set λ supp(t).
Then S(T ) is the tiling obtained by applying S to all tiles in T simultaneously. For
most T ∈ΩP, S(T ) is not equal to T . However there will be ﬁxed or periodic
points for S. A ﬁxed point for S is known as a self-similar tiling.
Inflate
Subdivide
Inflate
Subdivide
Fig. 2.7 Inﬂation and subdivision for the case k = 3

2
Introduction to Hierarchical Tiling Dynamical Systems
49
2.4.3
More Tricky Generalization: Multidimensional
Constant-Length Substitutions in Zd
Symbolic substitutions of constant length generalize directly to substitutions of
constant size in Zd. We choose a ‘rectangular’ shape in d dimensions, and every
letter of the alphabet is substituted with a block of letters in that shape. There is no
problem with iteration of the substitution because all of the blocks ﬁt together along
every dimension so concatenation of the blocks happens naturally. To generalize
symbolic substitutions of non-constant length to Zd we will use the fusion paradigm.
Fix lengths l1, l2, . . . ld, positive integers with each li > 1, and deﬁne the location
set Id to be the ‘rectangle’ given by
Id = {j = (j1, . . . jd) such that ji ∈0, 1, . . . , li −1 for all i = 1, ..d}.
(2.1)
A block substitution S is deﬁned to be a map from A × Id into A. Then for any
e ∈A we denote by S(e) a block of letters; we call it a 1-superblock or 1-supertile.
In any particular example it is not hard to build an n-superblock through
concatenation, but notation describing it precisely obscures this fact. Since the
notation is not needed elsewhere in these notes we omit it. Instead we deﬁne
n-superblocks inductively, using the relative positions of the letters in S(e) to
determine the relative positions of their Sn−1 blocks in Sn(e). Because all of the
substituted blocks have the same dimensions, if two letters were adjacent it is clear
that their substitutions will ﬁt next to one another properly.
Any position k ∈Id represents a location in a 1-superblock and we can think of
S restricted to k as a map from A to itself. Indeed it can be useful to think of S as
a block of maps (pk)k∈Id. The nature of these maps is key to the dynamics of the
system and they are used to compute the cocycle for the skew product representation
of the system [45, 89]. An important subclass is deﬁned as follows.
Deﬁnition 2.4.1 Let the substitution S as deﬁned in this section be written as S =
(pk)k∈Id. We say S is bijective if and only if each pk is a bijection from A to itself.
Example 6 A two-dimensional version of the Thue-Morse substitution uses A =
{0, 1} with d = 2 and l1 = l2 = 2.
S(0) = 1 0
0 1,
S(1) = 0 1
1 0 ,
(2.2)
where both blocks are located in Z2 with their lower left corners at the origin. If
instead we wish to see S as a matrix (pk)k∈I2 of maps on A, denote by g0 the
identity map and g1 the map switching 0 and 1, we obtain:
S(∗, I2) = (pk)k∈I2 = g1 g0
g0 g1 .
(2.3)

50
N. P. Frank
Fig. 2.8 The ﬁrst three
superblocks of type 0. The
lines emphasize
(n −1)-superblocks inside
the n-superblocks
For example we see that p(0,0) = g0 and p(0,1) = g1. Also we note that this example
is bijective. The ﬁrst few superblocks of type 0 are shown in Fig. 2.8.
2.4.4
Geometric Generalization: Self-Afﬁne, Self-Similar,
and Pseudo-Self-Similar Tilings
The geometric structure evident in the tilings in this section is governed by
expanding linear maps. This makes it particularly amenable to study from a number
of viewpoints, and therefore these are the most widely studied of the tilings
considered in these notes. There are many examples in Chapter 6 of [11] and we try
not to repeat too many of those here. Sometimes tilings created using other supertile
methods can be transformed into self-similar tilings and the results that exist for
them can be used. Sometimes they can’t.
The earliest deﬁnition of self-similar tilings that seems to appear in print is
in [102], which is a set of AMS colloquium lecture notes by William Thurston.
However, the author tells us the ideas in the lectures are not all his own and refers
in an informal way to a number of places where the subject was beginning to be
studied.
2.4.4.1
Self-Afﬁne and Self-Similar Tilings
We ﬁrst follow the deﬁnitions laid out in [100], and use terminology from there,
[46], and [11]. We also give a simpler but more restrictive version of the deﬁnition
that the reader will ﬁnd in [11] and lots of other places.
Deﬁnition 2.4.2 Let φ : Rd →Rd be a linear transformation all of whose
eigenvalues are greater than one in modulus. A tiling T is called self-afﬁne with
expansion map φ if
1. for each tile t ∈T , φ(supp(t)) is the support of a union of T -tiles, and
2. t and t′ are equivalent up to translation if and only if φ(supp(t)) and φ(supp(t′))
support equivalent patches of tiles in T .

2
Introduction to Hierarchical Tiling Dynamical Systems
51
If φ is a similarity, the tiling is called self-similar. For self-similar tilings of R or
R2 ∼= C there is an inﬂation constant λ for which φ(z) = λz.5
There are a few differences between our deﬁnition and the one in [100] upon
which it is based. One is that φ is not required to be diagonalizable, and the other is
that a self-afﬁne tiling is not required to be repetitive. Proofs on the algebraic nature
of the expansion constant originally required diagonalizability [66] but the condition
was recently removed in [68]. A nonrepetitive tiling satisfying our deﬁnition of self-
afﬁne would be called “φ-subdividing” in [100]. Although we have taken ﬁnite local
complexity to be a blanket assumption throughout this paper, note that our deﬁnition
can be used in the inﬁnite local complexity case as well.
What is inconvenient about this deﬁnition is the fact that one must begin by
already having the self-afﬁne tiling at hand. To be more consistent with the way we
think about symbolic substitutions we can deﬁne an inﬂation rule on prototiles ﬁrst.
Deﬁnition 2.4.3 Let P be a ﬁnite prototile set in Rd and let φ : Rd →Rd be a
diagonalizable linear transformation all of whose eigenvalues are greater than one
in modulus. A function S : P →P∗is called a tiling inﬂation rule6 with inﬂation
map φ if for every p ∈P,
φ(supp(p)) = supp(S(p)).
The linear map φ makes it easy to extend S to tiles, patches, and tilings. The
substitution of a tile t = p + x, for p ∈P and x ∈Rd, is the patch S(t) :=
S(p) + φ(x). The substitution of a patch or tiling is the substitution applied to each
of its tiles. This means that we can consider S as a self-map on the full tiling space
ΩP. If a tiling T is invariant under S we call it a self-afﬁne tiling. We use the term
n-supertile to mean a patch of the form Sn(t).
We can use either of the methods in Sect. 2.3.1.2 to construct a tiling space for
S. If there is a self-similar tiling T , we can make its hull by taking the orbit closure
under translation. Or, we could consider the set R of all n-supertiles, for all n and
all prototile types, and use that as our set of admissible patches. Often the resulting
spaces are identical, though not in the following example.
Example 7 (Danzer’s T2000 Tiling) Figure 2.9 gives an example from the tilings
encyclopedia [1] attributed to Ludwig Danzer. It uses a total of 24 tiles, two sizes of
triangles in twelve orientations. We show the inﬂation rule on the two sizes only; the
inﬂation rule of the rotations are the corresponding rotations of these. The expansion
map is φ(x, y) = (
√
3x,
√
3y).
5In the literature (notably [100, 102]) it is taken as given that φ is orientation preserving, which
can be assumed by squaring any substitution that is not.
6These are also known as inﬂate-and-subdivide rules and tiling substitution rules.

52
N. P. Frank
Fig. 2.9 The T2000 inﬂate-and-subdivide rule
Fig. 2.10 2- and 3-supertiles
Fig. 2.11 A patch from a T2000 tiling
Figure 2.10 shows the second and third iteration of the larger triangle, and
Fig. 2.11 shows a large patch of an inﬁnite tiling. The sharp-eyed viewer will notice
that the tiling appears to use only 6 rotations each of the small and large triangles,
not 12. This is because the substitution is not ‘primitive’ in the sense of Sect. 2.5.2:
there is no number N such that each N-supertile contains all 24 tile types. They will
always have exactly 12 when N is sufﬁciently large. A side effect is that the two
methods for producing tiling spaces are different in that the hull of any self-similar
tiling is a connected space, while the space of admissible tilings has two connected
components, one a rotation of the other by 60◦. In this example we could “ﬁx” this

2
Introduction to Hierarchical Tiling Dynamical Systems
53
problem by restricting our attention to an appropriate 12-prototile set and using two
iterations of the substitution.7
For the same reason there will be no self-similar tilings for the substitution as it
is shown in Fig. 2.9, but there are period-two tilings. By replacing the substitution as
shown with its square, we obtain self-similar tilings with expansion factor 3 instead
of
√
3.
2.4.4.2
Pseudo-Self-Similar Tilings
In this situation we still have an expanding linear map φ acting on our tilings,
but we no longer have that φ(supp(p)) is exactly the support of a patch of tiles.
Instead it may only approximate the shape of supp(p). Well-known examples of
such substitutions are the Penrose tilings using rhombuses and/or ‘kites and darts’
[54, 83] (or also [46, 58, 90]) and the “binary” tilings [55] (or see [46, p. 307] or [11,
p. 217]). In these examples there is a substitution rule that still ‘ﬁts’ to ultimately
form a tiling, but not exactly on top of the expanded tiles. Examples of this nature
appear in abundance in the Tilings Encyclopedia [1] as they occur in projection
tilings constructed in a similar way to Penrose tilings.
For the deﬁnition we must make precise what we mean by expanding a tiling T
to obtain the tiling φ(T ). For every tile t in T , φ(t) is deﬁned to be a tile supported
on φ(supp(t)) that carries the label of t. We deﬁne φ(T ) := 
t∈T φ(t).
Deﬁnition 2.4.4 (See [88, 99]) Let P be a ﬁnite prototile set in Rd and let φ :
Rd →Rd be a diagonalizable linear transformation all of whose eigenvalues are
greater than one in modulus. We say a tiling T ∈ΩP is pseudo-self-similar with
expansion φ if T is locally derivable from φ(T ).
Example 8 (Variation on Thurston’s Hexagonal Example) In [102] a fractal “rep-
tile” is constructed that makes a periodic tiling on the hexagonal lattice. The example
is based on the observation that a regular hexagon is approximated by a patch of
seven hexagons. To make a nonperiodic version we use two colors of hexagons in
our inﬂation rule.
The inﬂation map φ is given by the matrix

5/2
√
3/2
−
√
3/2 5/2

. Pictured in Fig. 2.12 is
what happens to the hexagonal prototiles when inﬂated by this map and ‘subdivided’
into a patch of tiles at the original scale. The location of the origin is marked with
a point in each tile and patch. To see how each supertile is spatially related to the
inﬂated prototile we have shown their overlap in Fig. 2.13. Figure 2.14 shows the
1-, 2-, and 3-supertiles for the blue hexagon.
7In general, non-primitive substitutions can have more complicated structure.

54
N. P. Frank
Fig. 2.12 The
inﬂate-and-subdivide rule for
a hexagonal
pseudo-self-similar tiling
Fig. 2.13 The inﬂated blue
tile and its patch, left; the
inﬂated green tile and its
patch, right
First in [88] for R2 and later [99] for Rd it is proved that every pseudo-self-similar
tiling is mutually locally derivable from a self-similar tiling. In R2 the argument
ends up using ideas from iterated function systems, but in Rd other methods are
required.
2.4.5
Fusion: A General Viewpoint
Symbolic substitutions and tiling inﬂation rules can be seen as a sort of ‘cellular’
model: the supertiles grow, level by level, because each symbol or tile within them
has expanded to become a word or patch. Fusion takes an ‘atomic’ model: symbols
or tiles are like atoms that come together to form ‘molecules’ (our 1-supertiles) that
then assemble themselves into larger structures (2-supertiles) that continue to merge
into larger supertiles level by level.
The sets of n-supertiles obtained by symbolic or tiling substitutions can be seen
as fusion rules since it is possible (and natural) to see an n-supertile as being a
union of (n −1)-supertiles just as easily as seeing it as the union of lots and lots of
1-supertiles. In this viewpoint the (n −1)-supertiles in Sn(a) are concatenated as
prescribed by the original substitution rule on a. One could also imagine creating
supertiles by applying different substitutions or tile inﬂations at each stage (if
geometry permits); this is a more general situation captured in the symbolic case
by S-adic systems and in the tiling case by fusion rules.

2
Introduction to Hierarchical Tiling Dynamical Systems
55
Fig. 2.14 2- and 3-supertiles for the blue prototile
Fusion does not require an underlying linear map φ but instead takes a combi-
natorial approach. There have been other combinatorial approaches to generalizing
symbolic substitutions. An early attempt to understand substitutions on graphs and
in particular the dual graph for the Penrose inﬂation appears in [86]. A deﬁnition of
substitution for the dual graphs of planar tilings is discussed in [46]. Combinatorial
substitutions are deﬁned a little bit differently in [40], and a related notion
called “local rule” substitutions are deﬁned in [39]. A deﬁnition of “topological
substitutions” is given in [20]. Separately, an extremely successful program on
“generalized” or “dual” substitutions began with [8]; see [7] for results tying
substitutions to Markov partitions of hyperbolic toral automorphisms, complex
numeration systems and β-expansions. We follow [50] for the fusion deﬁnition we
give here and note that although we use the context of tilings in Rd the deﬁnitions
are appropriate for (multidimensional) sequences as well.
Suppose that we have a ﬁnite prototile set P in Rd. Given two P-patches P1
and P2 and two translations x1 and x2, if the patches (P1 −x1) and (P2 −x2)
intersect only on their boundaries to form a patch with connected support we call
(P1 −x1) ∪(P2 −x2) a fusion of P1 to P2. Of course there could be many different
ways two given patches can be fused, and we could make the fusion of any ﬁnite
number of patches inductively. Patch fusion is our tiling analogue to concatenation
for symbols.
We form our fusion rule by deﬁning the sets of supertiles as follows. The set P0
is just the prototile set P. The set P1 is our set of 1-supertiles and is deﬁned to be a

56
N. P. Frank
ﬁnite set of ﬁnite P-patches. We use the notation P1 = {P1(1), P1(2), . . ., P1(j1)}.
The set P2 is deﬁned to be some ﬁnite set of ﬁnite patches that are fusions of
patches from P1. The elements of P2 are our 2-supertiles and we use the notation
P2 = {P2(1), P2(2), . . . , P2(j2)}. One could think of the patches in P2 as either
P-patches, or as P1-patches (i.e., as patches made from 1-supertiles).
We continue inductively, forming P3 as a ﬁnite set of patches that are fusions of
2-supertiles, and in general letting Pn be a ﬁnite set of patches that are fusions of
(n −1)-supertiles. We use the notation Pn = {Pn(1), . . . , Pn(jn)} and think of our
n-supertiles both as patches of ordinary tiles and also as patches of k-supertiles for
any k < n. We collect all of our supertiles together into an atlas of patches called
our fusion rule R, that is
R =

n∈N
Pn = {Pn(j) | n ∈N and 1 ≤j ≤jn} .
The fusion rule can be used as a pre-language for our tiling space as deﬁned in
Sect. 2.3.1.2. That means that tilings are fusion tilings by this rule if and only if all
of their patches are seen somewhere in a patch in R.
Remarks
1. In general we will assume that some sequence of n-supertiles grows to cover Rd
so that there are tilings of Rd that are allowed by the fusion rule. That is, we take
as a standing assumption that our fusion tiling spaces are nonempty.
2. The number jn of supertiles can vary from level to level.
3. When d = 1, if we consider translations by elements of Z with all tiles having
unit length, fusion tilings correspond to Bratteli-Vershik systems (except for edge
sequences that have no predecessors or no successors). See [21] for more about
the relationship between tilings and Bratteli-Vershik systems.
4. As stated currently, the deﬁnition of fusion rule allows for every P-tiling to
be seen as a fusion tiling. Construct the fusion rule R by letting the set of n-
supertiles contain every possible patch of P-tiles containing n or fewer tiles. All
of ΩP is contained in this fusion tiling space.
Example 9 (The Chacon transformation [29]) This example was the ﬁrst to show
that there exist transformations with weakly but not strongly mixing dynamical
systems. It was originally constructed using the “cut-and-stack” method8 and can
be seen as a substitution as well as a fusion tiling.
To see the Chacon transformation as a fusion rule for tilings of the line, let la and
lb to be two positive numbers, let a denote a prototile with support [0, la], and let b
denote a prototile with support [0, lb]. We let the symbols a and b also serve as the
labels of the tiles if those are needed.
8Actually, it is possible to see the process of fusion as a cutting and stacking process.

2
Introduction to Hierarchical Tiling Dynamical Systems
57
For each n there are two n-supertiles, which we consider being of types a and b.
We deﬁne P1(a) = a ∪(a + la) ∪(b + 2la) ∪(a + 2la + lb) and P1(b) = b. We
think of P1(a) as “aaba”, and it has length 3la + lb. The length of P1(b) is just lb,
and we will let Pn(b) = b for all n.
To make P2(a) we fuse three copies of P1(a) and one copy of P1(b) together in
the same order as we did for P1(a), and we let P2(b) = b. The length of the new a
supertile is three times that of the previous a supertile plus the length of b.
In general, we have:
Pn+1 = {Pn+1(a), Pn+1(b)}
= {Pn(a)Pn(a)Pn(b)Pn(a) , Pn(b)}
= {Pn(a)Pn(a) b Pn(a) , b}.
This is an example where not all supertiles expand. In the original formulation b is
seen as a ‘spacer’, and the offsets between a’s it provides are the cause of the weak
but not strong mixing.
Example 10 (A Direct Product Substitution) Let A = {a, b} and deﬁne σ(a) =
abb, σ(b) = aa. We take the direct product of this substitution with itself, with
alphabet (a, a), (a, b), (b, a), (b, b). We use the convention that the substitution
on the ﬁrst letter runs horizontally and the substitution on the second letter goes
upwards. With that we obtain
S((a, a)) =
(a, b) (b, b) (b, b)
(a, b) (b, b) (b, b)
(a, a) (b, a) (b, a)
,
S((a, b)) = (a, a) (b, a) (b, a)
(a, a) (b, a) (b, a),
S((b, a)) =
(a, b) (a, b)
(a, b) (a, b)
(a, a) (a, a)
,
S((b, b)) = (a, a) (a, a)
(a, a) (a, a).
It is better to visualize the substitution as a tiling, so we show the prototiles and
1-supertiles in Fig. 2.15. The ﬁrst row is P0 = {(a, a), (a, b), (b, a), (b, b)} and the
second is
P1 = {P1 ((a, a)), P1 ((a, b)) , P1 ((b, a)), P1 ((b, b))}.
It is possible to iterate this as a substitution, concatenating in two dimensions
in much the same way as we would do in one dimension. We choose instead to
think of it as a fusion, where the n + 1-supertiles are constructed using the same
concatenation of n-supertiles at every level.This concatenation is diagrammed in
Fig. 2.16 and the 2-supertiles are shown in Fig. 2.17.

58
N. P. Frank
Fig. 2.15 The prototiles and 1-supertiles for the direct product substitution
Fig. 2.16 Direct product fusion rule making (n + 1)-supertiles from n-supertiles
Fig. 2.17 The 2-supertiles for the direct product fusion
Fig. 2.18 The 1-supertiles for the DPV
The Z2 dynamical system associated with the direct product acts the same as the
direct product of the one-dimensional systems. To get something new we rearrange
the substitution on some of the letters to break the direct product structure, obtaining
“Direct Product Variation” (DPV) tilings. Varying the structure is easily done but
care must be taken so that the DPV substitution can be iterated to form legitimate
patches and tilings.
Example 11 (A Variation on the Direct Product) In this example we have chosen
to rearrange only the tiles in the ﬁrst supertile (compare Figs. 2.15 and 2.18). The

2
Introduction to Hierarchical Tiling Dynamical Systems
59
requisite care was taken to ensure that the 1-supertiles ﬁt together to form 2-
supertiles supported on topological disks, and that this nice situation will continue
in perpetuity.
Unlike the DP case, if we try to iterate it as a substitution it becomes problematic:
it is not clear how to concatenate the substituted tiles. Each supertile may be
in a different relationship to its neighbors than the original tile was. In some
examples it is possible to determine how to ﬁt the supertiles together by looking at
bounded patches around the original tiles. Those are the kinds of examples that have
prompted deﬁnitions ‘combinatorial’ or ‘local rules’ substitutions [39, 40, 43, 86].
For this example, however, concatenation of individual 1-supertiles inside large
patches cannot be determined by local information and so the fusion paradigm is
necessary. (See [46] for a discussion of the origin of these nonlocal problems and
their consequences.)
Figure 2.19 gives the general template for concatenating the n-supertiles to make
the (n+1)-supertiles, and Fig. 2.20 shows us the set of 2-supertiles. Already we can
see that the direct product structure has been disrupted.
For your entertainment we include a comparison of the 3-supertiles of type (a, a)
for the DP and DPV substitution in Fig. 2.21. Direct product tilings have a distinct
appearance with horizontal and vertical bands clearly visible. The DPV can be
compared to the introductory Fig. 2.6, which is a version of the DPV with ‘natural’
tile sizes.
The topology, and in particular the cohomology, of a DPV based on a strongly
non-Pisot substitution in product with the substitution 1 →11 (which gives a
Fig. 2.19 DPV fusion rule making (n + 1)-supertiles from n-supertiles
Fig. 2.20 The 2-supertiles for the DPV fusion

60
N. P. Frank
Fig. 2.21 The 3-supertiles of type (a, a) for the DP (left) and DPV (right)
“solenoid” system) is analyzed in [49]. In that example the DPV uses natural tile
sizes and has inﬁnite local complexity.
2.4.5.1
Special Classes of Fusion Tilings
A fusion rule R is called prototile-regular if each Pn has the same number of
elements. A prototile-regular fusion rule is called transition-regular if the number
of each tile type in each supertile type doesn’t change from level to level. The DP
and DPV examples shown were both prototile- and transition-regular, and they are
also ‘algorithmic’ in the sense of the next example.
Example 12 (A “Uniform Shape Substitution”) This is an example of the type of
substitution found in [39]. We call it algorithmic because a simple computer algo-
rithm can be written to describe the formation of the n-supertiles. The algorithm is
iterative, accepting n-supertiles and fundamental level-n translations and returning
(n + 1) versions of these. Interesting for these examples is that there may be more
than one possible input (prototile set and fundamental translations) that leads to a
tiling of R2.
Because it isn’t obvious how to make a simpliﬁed ﬁgure like we did for DPVs
that describe the combinatorics of how to put the n-supertiles together to make the
(n+1)-supertiles, we give the algorithm instead. Let An and Bn denote n-supertiles
and let kn and ln represent fundamental translation vectors at the nth level, and let
L =
 2 1
−1 1

. Then
An+1 = An ∪(Bn + kn) ∪(Bn + ln)
and
Bn+1 = Bn ∪(An + kn) ∪(An + ln).
The level-(n + 1) translations are kn+1 = Lkn and ln+1 = Lln.

2
Introduction to Hierarchical Tiling Dynamical Systems
61
Fig. 2.22 Level-n tiles of type A for n = 1, . . . 6, beginning with square tiles. Each square tile is
the same size despite the image rescaling, which is there solely for display purposes
To run the algorithm, put in a prototile set and some initial vectors and see what
happens when the algorithm is iterated. There are at least three distinctly-shaped
prototile sets and corresponding initial vectors that lead to tilings of R2; we include
only one here.
One possible prototile set is colored unit squares with their lower left endpoints
at the origin. With this input set it is necessary to set k0 = (1, 0) and l0 = (0, 1).
Figure 2.22 shows the ﬁrst six supertiles of the blue (A) prototile. It is essential to
note that each successive supertile is shown at a scale smaller than it actually is: all
the tiles should be the same size as the ﬁrst one. The rescaling is just there to display
the supertiles together. Also note the dot in each image: it represents the location of
the origin and allows us to see the rotational aspect of this fusion rule.
It is the ‘shape’ of the substitution that matters: it is ‘uniform’ in the sense that
the shapes of the n-supertiles of either type are the same and it is only the coloring
that differs. In our example we have chosen a bijective coloring, using the word
‘bijective’ in the same way as we used it for substitutions in Zd.
Another prototile set that works is a pair of colored hexagons with vertex set
{(1, 0), (0, 1), (−1, 1), (−1, 0), (0, −1), (1, −1)},
in which case it is necessary to set k0 = (2, −1) and l0 = (1, 1).

62
N. P. Frank
These tilings turn out to be pseudo-self-similar with expansion map L. Moreover,
Fig. 2.22 provides convincing evidence of the existence of a fractal-shaped tile that
could be used as the ‘uniform shape’ and which makes a self-similar tiling.
2.4.5.2
S-adic Systems
S-adic systems are both generalizations of symbolic substitutions and specializa-
tions of fusion rules. There are substitutions, but they can change from level to
level and thus have to be applied in reverse order, effectively turning them into
a fusion rule. The term “S-adic” and basic deﬁnitions are proposed in [38], as
part of a larger study of symbolic systems of low complexity. There are many
reasons why this generalization is useful, as it intersects with continued fractions
and interval exchange transformations, and has been very interesting in the study
of combinatorics on words. The topic and its connections to numerous areas is
surveyed in [103]. Recently, a few generalizations of S-adic systems to higher
dimensions have been made that do not use the fusion paradigm [51, 53].
We follow the notation of [24] ﬁrst and then explain how this well-studied family
of systems ﬁts into the fusion paradigm and can be seen as a supertile construction
method. Let A0, A1, A2, . . . be a family of ﬁnite alphabets, and, for each n, let
σn : An+1 →A∗
n be a map taking an element from An+1 to a nonempty word in the
alphabet An.9 Let {an}∞
n=0 represent a sequence for which an ∈An for all n ∈N.
An inﬁnite word x ∈AN
0 admits the S-adic expansion {(σn, An)}∞
n=0 if
x = lim
n→∞σ0σ1 · · · σn−1(an).
We have the usual two options to make a sequence space, either as the hull of x or
as the set of all sequences admitted by the set of n-superwords.
(The theoretical computer science community has established terminology for
the set of all allowed words: a ‘language’. In this terminology the directive sequence
{σn} has a language associated with it given by
L =

n∈N
σ0σ1 · · · σn−1(A∗n),
where the notation M denotes the smallest language containing the set M. The S-
adic system given by {σn} can then be studied through the shift space admitted by
this language.)
9There is a separate lexicon in which what are known to some as “substitutions” are known to
others as “non-erasing morphisms” and the set A∗is called the “free monoid” instead of the set of
all ﬁnite words from A [6, 76].

2
Introduction to Hierarchical Tiling Dynamical Systems
63
Let us see how this ﬁts into the fusion paradigm. The prototile set is A0, which
could be seen as labelled unit intervals if we prefer a tiling to a sequence. The 1-
supertiles are constructed using the map σ0 : A1 →A0. For each a ∈A1, σ0(a)
is a word in A0 which by abuse of notation we might think of as a patch instead. In
either case we call it a 1 supertile. The 1-supertiles are given by
P1 = {σ0(a) such that a ∈A1}
The 2-supertiles are given by σ0(σ1(a)), where a is now an element of A2, and
we need to see why those are fusions of 1-supertiles. Notice that σ1(a) is a word in
A∗
1, and so we can apply σ0 to each of its letters. Thus one can see σ0(σ1(a)) as the
fusion of blocks of the form σ0(a′) in the order prescribed by σ1(a). Thus the set of
2-supertiles is
P2 = {σ0σ1(a) such that a ∈A2}
Now the 3-supertiles are given by σ0σ1σ2(a), where now a ∈A3. To see these
are fusions of 2-supertiles, suppose σ2(a) = b1b2 · · · bk, which is in A∗
2. Then
σ0σ1(σ2(a)) = σ0σ1(b1)σ0σ1(b2) · · · σ0σ1(bk), which is a fusion of 2-supertiles.
Clearly, then, the n-supertiles take the form
Pn = {σ0σ1 · · · σn−1(a) such that a ∈An},
and can be seen as fusions of (n −1)-supertiles as desired. So in this work we
consider S-adic constructions to be supertile constructions as well.
2.4.6
Tiling Spaces from Supertile Methods
As we discussed in Sect. 2.3.1.2, tiling spaces are often given as either the hull of a
speciﬁc tiling or as the tilings admitted by a speciﬁc language. It is reasonable to try
both approaches for supertile methods.
In the case of general symbolic substitutions in Z, constant-length substitutions
in Zd, and self-afﬁne or -similar tilings of Rd, we have noted that we can consider
the substitution as an action on the sequence or tiling space. Thus if T is a ﬁxed
point of the substitution we can study the supertile rule by studying the hull of T .
This doesn’t work for arbitrary fusion rules, since they don’t deﬁne actions on the
full tiling space.
For fusion rules (and therefore all supertile methods) one can consider the set of
all n-supertiles to be the set R. Thinking of R as a pre-language (which may be an
abuse of terminology), we see that if there are inﬁnite tilings in ΩP that are admitted
by R, then the space ΩR is nontrivial. We do not attempt to determine precise
conditions that enforce nontriviality, but that is easy to check in examples. In [50]
a blanket assumption is that the boundaries of the n-supertiles become arbitrarily

64
N. P. Frank
small compared to their interiors as n →∞. (Such a sequence of sets is called
a “van Hove sequence”, and we call fusions of this sort van Hove.) We clearly
need some sort of growth condition for supertiles in order for the tiling space to be
nontrivial.
Often the Ωs you get by either method are identical, but there are exceptions.
One notable exception is if the invariant T contains a ‘defective’ patch that is not
allowed by the substitution but is stable under the substitution rule. The Danzer
T2000 example was another exception arising from not having primitivity.
2.4.7
Recognizability or the Unique Composition Property
Suppose you are given an element of a tiling (or sequence) space given by some
supertiling method. All you see are the tiles in the tiling. Can you determine
uniquely how the tiles group into supertiles? If so, the tiling (or sequence) is
recognizable.
To make this deﬁnition it is convenient to introduce the notion of “supertiling
spaces”. Let Ω be a (nonempty) tiling space deﬁned for some supertile method.
Fix an n and choose some T ∈Ω. For any x ∈Rd the patch T ∩{x} must be
contained in some n-supertile, either from the generating tiling or from R. The
n-supertile might not be unique, but there are only ﬁnitely many possibilities. A
diagonalization argument can be made to extrapolate that all tiles in T itself can be
composed into n-supertiles that overlap only on their boundary. A tiling Tn obtained
by this composition, i.e. where the prototile set is considered at Pn rather than P, is
called an n-supertiling of T . The space of all n-supertilings of Ω is denoted Ωn and
is a translation-invariant subspace of the tiling space ΩPn.
Since each n-supertile is constructed from (n −1)-supertiles by deﬁnition, there
is a unique decomposition map fn taking Ωn to Ωn−1. It is possible that the tiling T
can be composed in more than one way into a tiling in Ωn. In this case the supertile
rule is “not recognizable” or does not have the “unique composition property”.
Deﬁnition 2.4.5 (See [50]) A supertile rule is said to be recognizable if the
decomposition map from Ωn to Ωn−1 is invertible for all n.
This deﬁnition looks at recognizability as a sort of global property determined
by the connection between supertiling spaces. It can, however, be convenient to
think of it locally as converting patches of n-supertiles into (n + 1)-supertiles.
If a supertile rule is recognizable then every tiling in Ω can be unambiguously
expressed as a tiling with n-supertiles for every n. It is not difﬁcult to show that
the decomposition maps are uniformly continuous, and if they are invertible the
inverse is also uniformly continuous. Thus there exists a family of recognizability
radii rn (n = 1, 2, . . .), such that, whenever two tilings in Ω have the same patch
of radius rn around a point v ∈Rd, then the n-supertiles intersecting v in those two
tilings are identical.

2
Introduction to Hierarchical Tiling Dynamical Systems
65
The terminology original to the symbolic substitutions case is ‘recognizability’,
and it is shown in [81] that recognizability and nonperiodicity are equivalent in that
case. Solomyak [100] gave the concept the name ‘unique composition property’ for
self-afﬁne tilings. He proved in [98] that unique composition and nonperiodicity are
equivalent. In [50] the notion is deﬁned for fusions, where it is shown by example
that there are no general results connecting nonperiodicity to recognizability.
Recognizability turns out to be essential for many arguments and is almost
always assumed. It is central in the following construction.
Example 13 (How to Make a Nonlocal Homeomorphism) We use two tiling spaces
associated with the Fibonacci substitution of Example 3. Let Ω be the space with
labelled unit-length tiles and Ω′ to be the space with natural tile lengths, normalized
so that the n-supertiles in both spaces asymptotically converge in length. These
spaces are easily shown to be recognizable.
We can make an invertible local map Q by requiring that T and Q(T ) have the
same underlying sequence of a’s and b’s and then determining the precise location
of 0 in Q(T ). This location is determined from the location of 0 in T using the
supertile structure: one considers the sequence of n-supertiles in T containing 0,
and translates Q(T ) a little bit for each n so that, say, the left endpoints of the n-
supertiles line up. Since the lengths converge asymptotically the adjustments at each
stage will go to 0 and the precise location of Q(T ) can be determined.
2.5
Ergodic-Theoretic and Dynamical Analysis of Supertile
Methods
2.5.1
Transition (a.k.a. Incidence, Substitution, Abelianization,
or Subdivision) Matrices
We can obtain basic geometric and statistical information by associating a matrix or
matrices to a supertile rule. Transition matrices keep track of how many n-supertiles
of each type there are in each (n + 1)-supertile. They go by many names in the
literature but we will use ‘transition’ as our terminology.
These matrices are fundamental to their supertile rules, among other things
helping to compute frequencies and ergodic measures. Since we can count how
many times pi appears in Sn(pj), and we can count the total number of tiles in
Sn(pj), we can estimate the relative frequency of pi. The Perron-Frobenius theory
of matrices allows us to draw conclusions about the frequency statistics in our hulls
accordingly. In particular we will see how to use transition matrices to construct
ergodic measures.
The matrices for self-similar tilings of Rd, substitutions in Z, constant-length
substitutions of Zd, and stationary (or even transition-regular) fusion rules in Rd or
Zd are all obtained the same way, so we use tiling terminology to refer to all cases.
We assume the prototile set has been given some arbitrary order P = {p1, . . . p|P|},

66
N. P. Frank
which we shall keep ﬁxed. Then the transition matrix for S is the |P| × |P| matrix
M whose (i, j) entry Mij is the number of tiles of type pi in S(pj). It is not hard to
check that the tile population information for Sn is given by Mn.
Fusion rules have a somewhat more complicated transition matrix situation. This
is due to two facts: ﬁrst, that the fusion rules used to construct the n-supertiles may
be completely unrelated to the rules used to construct the m-supertiles when m ̸= n,
and second, that the number of supertiles can vary from level to level. Thus we need
an inﬁnite family of (possibly non-square) transition matrices in order to give us the
population information we seek.
Recall that Pn is the set of n-supertiles. We deﬁne the transition matrix Mn−1,n to
be the |Pn−1|×|Pn| matrix whose (k, l) entry is the number of supertiles equivalent
to Pn−1(k) (i.e. the number of (n −1) supertiles of type k) in the supertile Pn(l).
Notice that the matrix product Mn,N = Mn,n+1Mn+1,n+2 · · · MN−1,N is well-
deﬁned when N > n. The entries of Mn,N reveal the number of n-supertiles of
every type of N-supertile. If there is more than one fusion of Pn−1-supertiles that
can make Pn(l), we ﬁx a preferred one to be used in all computations.
2.5.2
Primitivity
Generally speaking, a supertile method is primitive if one ﬁnds every type of
n-supertile in every type of N-supertile, provided N is sufﬁciently large. This
assumption is useful in obtaining minimality, repetitivity, and unique ergodicity
results and ensures that our hulls have a certain level of homogeneity.
For this deﬁnition, suppose M or Mn,n+N are the transition matrices for the
supertile rules.
Deﬁnition 2.5.1 A symbolic or tiling substitution rule is deﬁned to be primitive if
and only if there is an N such that all of the entries of MN are strictly positive. A
fusion rule is deﬁned to be primitive if and only if for every n ∈N there exists an N
such that the entries of Mn,n+N are strictly positive.
In this latter situation it is possible that N varies depending on n.
2.5.2.1
General Result: Primitivity Implies Minimality
Recall that a topological dynamical system (Ω, G) is said to be minimal if and only
if Ω is the orbit closure of any of its elements.

2
Introduction to Hierarchical Tiling Dynamical Systems
67
Proposition 2.5.1 10 Let Ω be the space of tilings allowed by a supertile construc-
tion and let G be its group of translations. If the supertile construction is primitive,
then (Ω, G) is minimal.
Note that this proposition is not an if and only if: the Chacon substitution is an
example of a supertile construction that is minimal even though it is not primitive.
Although the most study has been done on primitive systems, progress has been
made in the non-primitive case as well [25, 26, 78]. We should note, however,
that primitivity and minimality are ‘morally’ the same in the sense that minimal
nonprimitive systems in one dimension can be transformed into primitive ones using
a return word procedure [78]. A way to do it for a Chacon DPV in two dimensions
is shown in [46].
2.5.2.2
Result for Substitution Systems: Primitivity Implies Unique
Ergodicity
Because it is easy to write down the transition matrix for a substitution rule, it can
often easily be determined that a substitution dynamical system is uniquely ergodic.
The general theorem that makes this possible in all cases is the Perron-Frobenius
theorem. The situation for fusions is more subtle and will be discussed later.
Part of the Perron-Frobenius theorem requires matrices that are irreducible in the
sense that for each index (i, j) there is an n ∈N such that Mn
ij > 0. This condition
is weaker than primitivity because the entries are not required to be simultaneously
positive for any n. Clearly, a primitive matrix is irreducible. We cite the portions
of the Perron-Frobenius theorem that are relevant to our study as a combination of
statements from [74, p. 109], [67, p. 16], and [100, p. 704].
Theorem 2.5.2 (Perron-Frobenius Theorem) Let M be an irreducible matrix.
Then M has positive left and right eigenvectors l and r with corresponding
eigenvalue θ > 0 that is both geometrically and algebraically simple. If θ′ is another
eigenvalue for M then |θ′| ≤θ. Any positive left or right eigenvector for M is a
multiple of l or r.
Moreover, if M is primitive and l and r are normalized so that l · r = 1, it is true
that
lim
n→∞
Mn
θn = rl.
The eigenvector l and r are ordinarily called the Perron eigenvectors and θ is
always called the Perron eigenvalue for M.
10See [64, 89] for symbolic substitutions, [87] for self-afﬁne tilings, and [50] for fusions.

68
N. P. Frank
In order to ﬁnd the result that primitivity implies unique ergodicity for symbolic
substitutions, a good reference is [89, Ch. V.4]. There we ﬁnd this stronger result:
Theorem 2.5.3 ([89], Theorem V.13) If a symbolic substitution system is minimal,
then it is uniquely ergodic.
It is stronger because primitivity is not the only way for a symbolic substitution
system to be minimal. For example, the Chacon system is minimal and therefore
uniquely ergodic despite it not being primitive.
The situation for self-afﬁne tilings is as follows.
Corollary 2.5.4 (Folklore; Corollary 2.4 of [100]) Suppose T is a self-afﬁne
tiling with expansion map φ for which the transition matrix M is primitive.
Then the Perron eigenvalue of M is |detφ|. Writing the prototile set as P =
{p1, p2, . . . , pm}, the left eigenvector can be obtained by l = (V ol(pj))m
j=1.
Moreover,
lim
n→∞|detφ|−nMn
ij = riV ol(pj).
The last equation proves particularly useful in computing frequencies and ergodic
measures as we will show in the case study, next. Moreover, one can show that the
n-supertile frequencies are given by
1
|det(φ)|n r and we can get the frequencies of
everything else from that information.
The adaptation of the previous result to multidimensional constant-length sym-
bolic substitutions is carried out in [45].
2.5.2.3
Case Study: Ergodic Measures for Constant-Length Zd
Substitutions
By results in [45], we can use Corollary 2.5.4 to make an instructive example. We
consider a tiling model of sequences in Ω where each tile is a unit ‘cube’ in Rd
labeled by the appropriate element of A.
If S is a primitive, nonperiodic substitution with size l1 · l2 · · · ld = K and φ is
its natural expanding map, Corollary 2.5.4 implies that the largest eigenvalue of M
must be equal to | det φ| = K. The left Perron eigenvector l must the tile volumes,
which are all 1. This implies that |A|
i=1 ri = 1 and that
lim
n→∞K−nMn =
⎛
⎜⎜⎜⎝
r1
r1
· · · r1
r2
r2
· · · r2
...
...
...
r|A| r|A| · · · r|A|
⎞
⎟⎟⎟⎠.
We know that the dynamical system (Ω, Zd) is uniquely ergodic, and by
our discussion of the connection between ergodic measures and frequencies in

2
Introduction to Hierarchical Tiling Dynamical Systems
69
Sect. 2.3.4 we know that frequencies exist and must be equal for almost every
element of Ω. One can show that it sufﬁces to compute frequencies in larger
and larger supertiles, rather than in arbitrary balls of expanding radius. In fact, by
primitivity it doesn’t matter which type of supertiles we look at, so we will just look
at Sn(a1) as n →∞. We will use the notation Nai(B) to denote the number of
occurrences of the letter ai in a block B. Then
f req(ai) = lim
n→∞
Nai(Sn(a1))
Kn
,
(2.4)
since Kn is the volume of the substituted block Sn(a1). The numerator is
easily computed since it is simply Mn
i1. Thus we have that f req(ai)
=
limn→∞K−nMn
i1 = ri, and so computation of f req(ai) reduces to computation of
the right eigenvector for M.
Sometimes the computation comes out particularly nice. For instance, we have
the following proposition:
Proposition 2.5.5 Let S be a primitive and nonperiodic substitution of constant
length l1 · l2 · · · ld = K in Zd. Then M has the property that |A|
j=1 Mij = K for all
i ∈1, 2, . . .|A| if and only if the frequency of any letter ai ∈A is 1/|A|.
Proof If |A|
j=1 Mij
= K, then a right eigenvector for M is given by r =
(1/|A|, . . ., 1/|A|). Since l · r = 1 it must be the (unique) right Perron eigenvector
for M. Since f req(ai) = ri the result follows.
Conversely, the vector r deﬁned as above again is a right eigenvector and we have
that
(Mr)i =
|A|

j=1
Mij/|A| = (Kr)i = K/|A|,
and the result follows.
Bijective substitutions (deﬁned in Sect. 2.4.3) automatically satisfy the former
condition, and so do the Rudin-Shapiro-like substitutions seen in [44].
Corollary 2.5.6 If S is a primitive, nonperiodic, bijective substitution of constant
length in Zd, then the frequency of any letter ai ∈A is 1/|A|.
Proof (Sketch) The row sum for row i is the number of times we see ai in the
substitution of any tile. Because the substitution is bijective, for any given location
in the substitution we know that ai appears exactly once. That means that the number
of times ai appears is the number of spots in the substitution, which is K.

70
N. P. Frank
2.5.3
Ergodic Measures for Fusions
Let us suppose that R is a primitive, recognizable, van Hove fusion rule in Rd that
admits a nontrivial tiling space Ω. What are the possibilities for translation-invariant
measures? We suppose for convenience11 that the group action for dynamics is G =
Rd and follow [50], section 3.4.
We cannot use the Perron-Frobenius theorem in this situation because our
transition matrices change from level to level, so we adapt it to work here. Because
of the relationship between S-adic systems, Bratteli diagrams, and fusion tilings,
our analysis is closely related to that in [27, 41] and others. (Our work takes the
analysis into the continuous dynamics situation.)
By recognizability we know that every tiling T ∈Ω has a unique n-supertiling
Tn ∈Ωn. Consider a particular n-supertile Pn(j) ∈Pn. We denote its frequency in
T as an n-supertile as ˜fPn(j), if it exists. We know that Pn(j) as a patch of ordinary
tiles may have a larger frequency ¯fPn(j) in T . In fact, recognizability gives us a ﬁnite
list of patches S1, S2, . . . Sq that appear if and only if Pn(j) appears as a supertile.
That means that we can compute ¯fPn(j) = q
i=1 ¯fSi if the latter frequencies exist
in T .
In the symbolic or tiling substitution case we found a right eigenvector r that
represented the prototile frequencies and satisﬁed r · l = 1, where l is the vector
of tile volumes. We might say that r is ‘volume-normalized’, and the useful thing
about that is that it makes the ergodic measure a probability measure. We need to
extend this concept to fusion tilings.
In the substitution case, the n-supertile frequencies are all given by the vector
1
|detφ|n r. For fusion rules the supertile frequencies are not as simple. We let a
nonnegative vector ρn = (ρn(1), . . . , ρn(jn)) ∈Rjn represent the n-supertile
frequencies.
Deﬁnition 2.5.2 Let ρ be a sequence of vectors {ρn} described above. We say that
ρ is volume-normalized if for all n we have jn
i=1 ρn(i)V ol(Pn(i)) = 1. We say
that it has transition consistency if ρn = Mn,NρN whenever n < N. A transition-
consistent sequence ρ that is normalized by volume is called a sequence of well-
deﬁned supertile frequencies.
As before, volume-normalization is there to ensure that the measure is a prob-
ability measure. The transition-consistency requirement ensures that the measure
is additive: it is necessary that the frequency of N-supertiles be related to the fre-
quencies of the n-supertiles they are composed of. This property was automatically
satisﬁed before because r was an eigenvector. For fusion rules, it turns out that
the invariant measures are completely determined by sequences of well-deﬁned
supertile frequencies:
11How to adapt the analysis appears in [50, section 3.7].

2
Introduction to Hierarchical Tiling Dynamical Systems
71
Theorem 2.5.7 ([50]) Let R be a recognizable, primitive, van Hove fusion rule
with tiling dynamical system (Ω, Rd). There is a one-to-one correspondence
between the set of all invariant Borel probability measures on (Ω, Rd) and the set
of all sequences of well-deﬁned supertile frequencies with the correspondence that,
for all patches P,
f reqμ(P) = lim
n→∞
jn

i=1
# (P in Pn(i)) ρn(i).
(2.5)
Thus one could, given a sequence of well-deﬁned supertile frequencies, construct
a translation-invariant ergodic measure μ as follows. Given any patch P, get the
frequency f reqμ(P) as in Eq. (2.5). Then, the measure of a cylinder set ΩP,U will
be f reqμ(P)V ol(U), provided U is not too large. Since the cylinder sets form a
basis for the topology, we can now measure any Borel measurable set.
2.5.4
General Result: Substitution Systems are Not Strongly
Mixing
Recall that a measure-preserving system is strongly mixing if for all measurable sets
A, B and for any sequence of vectors vn whose lengths increase without bound it
is true that limn→∞μ (A ∩(B −vn)) = μ(A)μ(B). There is a standard argument
proving that a substitution system isn’t strongly mixing, appearing for substitution
sequences in [34] and for self-similar tilings in [100]. Here is a general result.
Theorem 2.5.8 ([50]) The dynamical system of a strongly primitive van Hove
fusion rule with a constant number of supertiles at each level and bounded transition
matrices, and with group G = Zd or Rd, cannot be strongly mixing.
For tiling or symbolic substitutions neither the transition matrix nor the number
of supertiles changes from level to level, so these are never strongly mixing. Indeed,
we see that constructing a strongly mixing supertile method requires a certain degree
of unboundedness, either in the number of supertiles at each level or in the entries
of the transition matrices between consecutive levels.
2.5.5
Fusion Rules with Various Properties
The fusion paradigm can be used to construct interesting examples where the
standard results from substitution systems need not apply. Here are some that appear
in [50].

72
N. P. Frank
1. Example 3.7 provides us with an example of a one-dimensional, prototile- but
not transition-regular fusion rule that has a minimal but not uniquely ergodic
dynamical system.
2. Again prototile-regular, example 3.8 shows how a measure arising from a
sequence of supertiles can fail to be ergodic.
3. Example 4.4, the “scrambled Fibonacci”, is based on the Fibonacci substitu-
tion/fusion, but is systematically altered at occasional levels. The alterations
are enough to eliminate topological point spectrum, but the system still has
measurable eigenvalues. Thus we have a system that is topologically weakly
mixing but measure-theoretically pure point. It appears in [65], along with a
related example where the measurable and topological eigenvalues differ.
4. Example 4.8 gives us an example of a uniquely ergodic symbolic fusion system
that has ‘coincidence with ﬁnite waiting’ but is not pure point spectrum. This
contrasts with Dekking’s classical result on coincidence for constant-length
symbolic substitutions [33], where coincidence implies pure pointedness.
5. Example 4.9 provides a one-dimensional symbolic fusion that is not prototile-
regular, where not only is the system not uniquely ergodic, but also the ergodic
measures can have different spectral types.
6. Example 4.11 is an example of a symbolic fusion rule that is strictly ergodic and
yet has positive entropy.
2.6
Spectral Analysis of Supertile Methods: Dynamical
Spectrum
For the remainder of these lectures we discuss the two main spectral methods for
analyzing tiling spaces: dynamical and diffraction. Spectral theory of dynamical
systems is widely used and provides a measure-theoretic tool that standardizes
spaces acted on by a group G ⊆Rd by comparing them to Lebesgue measure
on the dual group of G. This is achieved using what is now called the Koopman
representation, which represents G as unitary operators on L2(Ω, μ), and applying
the spectral theorem for unitary operators. A nice development of the subject for
G = Z or Z+ can be found in [84, 104]; also for G = Z [56] provides a well-
contextualized historic overview and survey of results up to 1999. The book [89] is
entirely devoted to analyzing symbolic substitutions in one dimension using spectral
theory, as is Chapter 7 of [42]. The paper [19] extends many of these results to the
multidimensional constant-length Zd substitution case. The dynamical spectrum
framework for self-similar tilings of Rd is laid out in [100]. One can see [11,
Appendix B] for a brief discussion of how the theory for Z actions can be extended
to the higher-dimensional and/or continuous case, but the author is not aware of any
survey of the spectral theory of tiling dynamical systems.
Strong motivation for studying the diffraction spectrum of tilings comes from
the quasicrystal model. Indeed, Shechtman’s Nobel prize-winning discovery of

2
Introduction to Hierarchical Tiling Dynamical Systems
73
quasicrystals arose from a diffraction experiment [97]. A lovely and somewhat
underappreciated early book on crystals, quasicrystals, tilings, diffraction, and
the history of the subject is [96], which bridges the gap between physics and
mathematics for those looking for perspective. Fourier analysis is used to deﬁne
virtual diffraction experiments on tilings, and [11] is an excellent source to learn
about how it works. The method was originally proposed in [60], and there is a
fundamental argument in [37] that allows us to see that the diffraction spectrum
is related to the dynamical spectrum. There has been special emphasis on the
discrete (a.k.a. point or atomic) part of the diffraction spectrum of tilings because
it represents the bright spots appearing on a diffraction image known as “Bragg
peaks”. In particular, extensive work has been done to determine conditions under
which there exists such point spectrum, and when the spectrum is composed solely
of it. We will discuss a selection of results in this direction as well as what is known
about the connection between the two types of spectral analysis.
2.6.1
The Koopman Representation
Let (Ω, G) be a dynamical system with G representing a group of translations.
Suppose μ is a translation-invariant ergodic Borel probability measure for the
system. The function space L2(Ω, μ) is a Hilbert space and one often looks at it
when trying to analyze a system. From a physics perspective one could consider a
function as taking measurements or running experiments on the tilings in the tiling
space.
For each j ∈G there is a unitary operator Uj : L2(Ω, μ) →L2(Ω, μ) deﬁned
by
Uj(f )(T ) = f (T −j).
This family of operators is sometimes called the Koopman operator and it is a
representation of G. Since L2(Ω, μ) is a separable Hilbert space the tools of
operator theory are available. The spectrum of the Koopman operator is called the
dynamical spectrum of Ω (or of the supertile method that generated it).
Every f ∈L2(Ω, μ) has a spectral measure associated with it. No matter which
construction method was used, all of the cases look like this: for j ∈G we deﬁne
ˆf (j) =
 
Ω f (T −j)f (T )dμ(T ). One can think of comparing the values of f at
two spots in T , separated by j, and averaging the result over all of Ω. In each of
our situations this satisﬁes the appropriate notion of positive deﬁniteness so that the
appropriate version of Bochner’s theorem12 guarantees us the existence of a positive
12The general results on spectral theory of dynamical systems in this section can be found in many
places, for instance [56, 71]; specialization to the tiling case ﬁrst appears in [100].

74
N. P. Frank
real-valued measure σf on Td with these same Fourier coefﬁcients. That is,
ˆf (j) =

Ω
f (T −j)f (T )dμ(T ) =

ˆG
zjdσf (z),
(2.6)
where zj := zj1
1 · · · zjd
d and the dual group to G is denoted ˆG.
The spectral type of a function f , then, is determined by how σf decomposes
with respect to Lebesgue measure. Is it discrete, singular continuous, or absolutely
continuous? Or perhaps a mix? The supertile rule that determines Ω ultimately
determines what is possible for these spectral types and is our primary interest in
this topic.
Each f ∈L2(Ω, μ) generates a cyclic subspace of L2 given by its closed linear
span:
Z(f ) = span {Ujf such that j ∈G}.
Part of the spectral analysis of operators involves ﬁnding generating functions
fi, i = 1, 2, . . . for which
L2(Ω, μ) =
!
Z(fi).
This decomposition is not exactly unique but the number and spectral types of the
functions are. It is possible to ﬁnd functions f1, f2, f3, . . . such that L2(Ω, μ) =
" Z(fi) and for which σf1 ≫σf2 ≫σf3 ≫. . .. Again the functions are not
unique, but their spectral types are and the spectral type of f1 is known as the
maximal spectral type of the system. This decomposition determines the Koopman
operator up to unitary equivalence.
2.6.2
Eigenfunctions
To begin thinking more about the spectrum of Uj we can investigate its eigenvalues
and eigenvectors. The easiest case is when G = Z. In that case we are looking at any
functions f ∈L2(Ω, μ) for which there is some λ such that Uf = λf . In general
f is known as a measurable eigenfunction, and if it happens to be continuous then
it is called a topological eigenfunction. Notice that since U is unitary it must be
that |λ| = 1 and we write λ = e2πiα for some α ∈R. Obviously once we have
an eigenvalue/eigenfunction pair then for any n ∈Z we have that Unf = λnf =
e2πiαnf .
Now let’s generalize to a continuous one-dimensional action, i.e. when G = R.
An eigenfunction is a function for which there exists an α ∈R such that for all x ∈R
it is true that Uxf = e2πiαxf . That is, for all T ∈Ω it is true that f (T −x) =
e2πiαxf (T ).

2
Introduction to Hierarchical Tiling Dynamical Systems
75
When G is Zd or Rd with d > 1, the eigenvalues themselves live in higher
dimensions and the inner product becomes necessary. In this situation we say f
is an eigenfunction if there exists an α ∈Rd for which Ujf = exp (2πiα · j)f
for all j ∈G. That is, for all T
∈Ω and all j ∈G we ﬁnd f (T −j) =
exp (2πiα · j)f (T ).
An important technical point, which seems to be a point of contention, is whether
it is λ or α that is considered the eigenvalue for f . Both perspectives have merit.
The argument for using λ is that it is standard usage in functional analysis for
the spectrum of the unitary operator. The argument for α is that it resides in the
dual group of G and therefore is more directly relevant to diffraction analysis and
abstract harmonic analysis. We will allow either to count as the eigenvalue, being
more precise when necessary.
There is a difference between the situation where G = Zd and G = Rd that
also manifests itself when we allow G = Rd but the tiling is a suspension of a Zd
action. When G = Zd or the tiling space is a suspension of a Zd action, then every
α ∈Zd is an eigenvalue of the system; that is, in these cases there is always some
discrete spectrum. In fact when G = Zd, the dual group is Td and we have that if
α is any eigenvalue, then α + j is also an eigenvalue for the same eigenfunction, so
the spectrum is only considered on Td.
When G = Rd but the system is a suspension of a Zd-action, all elements of Zd
continue to be eigenvalues but we get that α and α +j have different eigenfunctions
for j ∈Zd. However, the eigenfunctions are closely related: if we let f denote the
eigenfunction for α and fj that of α + j, then fj(T ) = exp(2πij · x(T ))f (T ),
where x(T ) is the location in Rd of any vertex13 of T . Put another way, the
eigenfunction for α + j is the product of the eigenfunction for α with a function
that keeps track of where the tiling is relative to the suspension.
When G = Rd and the space cannot be seen as the suspension over a lattice we
must consider all possible values of the dual group of Rd, which is still Rd. Thus
spectral images in this case are not restricted to a torus.
Example 14 Let’s compute the spectral measure of an eigenfunction f of (Ω, μ)
with eigenvalue α. For j ∈G we have
ˆf (j) =

Ω
exp(2πiα · j)f (T )f (T )dμ(T ) = exp(2πiα · j),
since eigenfunctions are of almost everywhere constant modulus that can be taken
to be 1. Thus the spectral measure of f is a measure σf on Td with these Fourier
coefﬁcients. One can check that the measure on Td with these coefﬁcients is the
atomic measure supported on α, and so σf = δα.
13One can show that this term is independent of the choice of vertex.

76
N. P. Frank
2.6.2.1
Conditions for Presence of Discrete Spectrum
It is not surprising that spectral properties were investigated soon after the dynamical
systems approach to substitution sequences was introduced. Coven and Keane [32]
investigated a class of examples and their approach was generalized by Martin [80].
Dekking [33] generalized these results using different methods, completely deter-
mining the point part of the dynamical spectrum of constant-length substitutions in
one dimension.
Theorem 2.6.1 ([33], Quoted from Section 7.3 of [42]) Let σ be a non-periodic
(symbolic) substitution of constant length n. Let u be a periodic point for σ. We call
the height of the substitution the greatest integer m which is coprime with n and
divides all the strictly positive ranks of occurrence of the letter u0 in u. The height
is less than the cardinality of the alphabet. The maximal equicontinuous factor14 of
the substitutive dynamical system associated with σ is the addition of (1, 1) on the
abelian group Zn × Z/mZ.
One would expect the discrete spectrum of a symbolic substitution of non-
constant length to have a connection to the expansion factor of the system, and
Host’s result [62] gives a criterion that we quote here, following [42, Chapter 7]. We
leave undeﬁned the term “coboundary”, which we will not be using again.
Theorem 2.6.2 ([62], Quoted from Section 7.3 of [42]) Let σ be a not shift-
periodic and primitive substitution over the alphabet A. A complex number λ of
modulus one is an eigenvalue of (Ω, Z) if and only if there exists p > 0 such that
for every a ∈A, the limit h(a) = limn→∞λ|σ pn(a)| is well deﬁned, and h is a
coboundary of σ.
The constant function 1 is always a coboundary, making it simpler to check:
Theorem 2.6.3 (Corollary 7.3.17 of [42]) Let σ be a not shift-periodic and
primitive substitution over the alphabet A. If there exists p such that λ ∈C satisﬁes
limn→∞λ|σ pn(a)| = 1 for every a ∈A, then λ is an eigenvalue of the substitutive
dynamical system associated with σ.
One of the main results in [100] is the characterization of eigenvalues and
eigenfunctions for self-similar tiling systems. The method of proof is constructive
in that given the eigenvalue condition, an eigenfunction is constructed whose value
for a tiling T depends on special points derived from the supertile structure of T .
In [100], general results on the presence or absence of eigenfunctions and
therefore on weak mixing are determined. There are results for self-afﬁne tilings
of Rd that are made stronger in the d = 1 and 2 cases. The statement presented
here is essentially quoted from that paper, except that the result of [98] is taken into
account. Note that the set of translations between tiles in T is given by Ξ(T ), where
14Recall that this is the largest topological factor of the dynamical system that is a rotation of a
compact group.

2
Introduction to Hierarchical Tiling Dynamical Systems
77
x ∈Ξ(T ) if and only if x is a translation taking a tile t ∈T to an equivalent tile in
T , i.e. t −x ∈T .
Theorem 2.6.4 (Theorem 5.1 of [100])
(i) Let T be a nonperiodic self-afﬁne tiling of Rd with expansion map φ. Then
α ∈Rd is an eigenvalue of the measure-preserving system (Ω, μ) if and only
if
lim
n→∞e2πi(φn(x)·α) = 1
for all
x ∈Ξ(T ).
(2.7)
Moreover, if Eq. (2.7) holds, the eigenfunction can be chosen continuous.15
(ii) Let T be a self-similar tiling of R with expansion constant λ. The tiling
dynamical system is not weakly mixing if and only if |λ| is a real Pisot number.
If λ is real Pisot and T is nonperiodic, there exists nonzero a ∈R such that
the set of eigenvalues contains aZ[λ−1].
(iii) Let T be a nonperiodic self-similar tiling of R2 ≡C with expansion constant
λ ∈C. Then the tiling dynamical system is not weakly mixing if and only if λ is
a complex Pisot number. Moreover, if λ is a non-real Pisot number there exists
nonzero a ∈C such that the set of eigenvalues contains {(α1, α2) : α1 +iα2 ∈
aZ[λ−1]}.
2.6.3
Pure Discrete Dynamical Spectrum
Dekking’s work in [33] was the ﬁrst to deﬁne a notion now known as the
“coincidence condition” for a symbolic substitution σ. It is that there are numbers
k and l such that the image of any letter of the alphabet under σ k has the same
lth letter. This combinatorial condition is easy to check in any given example and
eliminates any spectrum that is not discrete. The idea has been generalized to non-
constant length symbolic substitutions and to self-similar tiling systems with the
goal of characterizing purely discrete spectrum in those cases. Algorithms have been
developed such as the “balanced pair algorithm” for substitution sequences (see [79]
and references therein or the original source [75], stated for adic transformations on
Markov compacta). For the multidimensional case there is a series of papers [3–5]
on the “overlap algorithm” making checkable conditions; the original version of this
for tilings appears in [100]. In terms of spectral analysis of supertile systems, spaces
with a purely discrete dynamical spectrum are the most well understood.
15This is also true for substitution sequences [62], but not for general fusions.

78
N. P. Frank
2.6.3.1
Symbolic Substitutions and the Pisot Substitution Conjecture
Let us begin with Dekking’s original result.
Theorem 2.6.5 ([33], Quoted from Section 7.3 of [42]) Let σ be a substitution
of constant length and of height 1. The substitutive dynamical system associated
with σ has a purely discrete spectrum if and only if the substitution σ satisﬁes the
condition of coincidence.
The situation is not settled in the non-constant length substitution case. A
substitution σ satisﬁes the strong coincidence condition if there are integers k and
l such that for every a, b ∈A, the substitutions σ k(a) and σ k(b) not only have the
same lth letter, but the preﬁxes of length l −1 in each have the same number of
letters of each type. The latter part of this condition ensures that σ (k+j)(e) will have
coinciding j-supertiles at the corresponding location for all j ≥1.
It is thought, but not known, that algebraic properties of the transition matrix can
determine coincidences. In particular, a substitution is said to be of Pisot type if all
of the eigenvalues of its transition matrix except for the Perron-Frobeniuseigenvalue
have modulus strictly between 0 and 1. It is said to be irreducible if the characteristic
polynomial is irreducible.
There are a family of conjectures collectively known as “Pisot substitution
conjectures”, that all more or less say, “the substitution dynamical system has pure
discrete spectrum if it is of irreducible Pisot type”. These conjectures are in place
not only for one-dimensional symbolic substitutions, but also for one-dimensional
tiling substitutions and a few other sorts of substitutions; the situation is nicely
summarized in [2]. Immediately relevant to our work following two conjectures
cited there that are equivalent by Clark and Sadun [31].
Conjecture 2.6.1 (Pisot Substitution Conjecture: Symbolic Substitutive Case) If σ
is an irreducible Pisot substitution then the substitutive system (Ω, Z) has pure
discrete spectrum.
Conjecture 2.6.2 (Pisot Substitution Conjecture: One-dimensional Tiling Case) If
S is an irreducible Pisot substitution for one-dimensional tilings, then its tiling
dynamical system (Ω, R) has pure discrete spectrum.
Progress has recently been made to settle the second conjecture: in [17] the
conjecture is conﬁrmed for substitutions that are injective on initial letters and
constant on ﬁnal letters. Closely related is the question of whether the substitution
satisﬁes the strong coincidence condition. Again from [2]:
Conjecture 2.6.3 (Strong Coincidence Conjecture) Every irreducible Pisot substi-
tution satisﬁes the strong coincidence condition.

2
Introduction to Hierarchical Tiling Dynamical Systems
79
The following two theorems together settle the Pisot substitution conjecture for
two-letter substitutions:
Theorem 2.6.6 ([61]) Let σ be a substitution of Pisot type over a two-letter
alphabet which satisﬁes the coincidence condition. Then the substitution dynamical
system associated with σ has a purely discrete spectrum.
Theorem 2.6.7 ([18]) Any substitution of Pisot type over a two-letter alphabet
satisﬁes the coincidence condition.
The question of whether a substitution sequence has purely discrete dynamical
system if and only if its expansion factor is Pisot remains open for alphabets of size
3 or higher and has proved remarkably difﬁcult to resolve. The methods used in the
two-letter case don’t apply in these cases. A survey of the state of results as of 2015
(not including [17]) appears in [2].
2.6.3.2
Purely Discrete Spectrum for Supertile Methods in Rd
There is a sufﬁcient condition given in [100] that works in all dimensions, and then
a specialized version for R2 we will talk about.
Theorem 2.6.8 ([100, Theorem 6.1]) Let T be a self-afﬁne tiling of Rd with
expansion map φ. If there exists a basis B for Rd such that for all x ∈B,

(1 −dens(Dφn(x)) < ∞,
(2.8)
then the tiling dynamical system (ΩT , Rd, μ) has pure discrete spectrum.
The strongest result is obtained for R and R2.
Theorem 2.6.9 ([100, Theorem 6.2]) Let T be a self-similar tiling of Rd, d ≤
2, with expansion constant λ. The tiling dynamical system (ΩT , Rd, μ) has pure
discrete spectrum if and only if λ is Pisot (real or non-real) and
lim
n→∞dens(Dλnx) = 1,
x ∈Ξ[T ].
(2.9)
An overlap algorithm is deﬁned in [100, p. 721-724] that determines whether
a self-similar tiling has a pure discrete spectrum. We give only the general idea
of the algorithm here. One makes a graph GO(T , x) out of all overlaps one can
see by comparing the tile(s) in T at some z ∈R2, with the tile(s) in T −x at
z. Most of those overlaps will be two tiles of different types, but sometimes they
are of the same type, and on occasion x may be a return vector for the tiles at this
particular z. When that happens we are said to have a coincidence, properly deﬁned
as T ∩{z} = (T −x) ∩{z}. An overlap is a vertex in the overlap graph, and edges
connect overlaps that are related via substitution.

80
N. P. Frank
Theorem 2.6.10 ([100, Proposition 6.7]) Suppose that T is a self-similar tiling of
the plane with expansion constant λ a non-real Pisot number, and x ∈Ξ[T ]. The
following are equivalent:
(i) the tiling dynamical system (ΩT , R2, μ) has pure discrete spectrum,
(ii) from any vertex of GO(T , x) there is a path leading to a coincidence, and
(iii) dens(Dλnx) →1 as n →∞.
2.6.4
The Continuous Part of the Spectrum
The results given above mean that we have a pretty good understanding of the
discrete part of the spectrum for supertile systems. In particular we understand
when there is point spectrum, and where the point masses are. We also understand
when there must be a continuous component to the spectrum. What remains is to
understand the nature of the continuous part. For instance, is it singular or absolutely
continuous with respect to Lebesgue measure?
There are two classic examples of one-dimensional constant-length substitution
sequences16 with mixed spectrum: the Thue-Morse sequence and the Rudin-Shapiro
sequence. Thue-Morse is given by the bijective substitution 0 →01, 1 →10 which,
lacking coincidences, was long known to have some continuous spectrum. A variety
of results over the years proved that the continuous part is singular with respect to
Lebesgue measure. It has been thought that the continuous part of the spectrum of a
bijective substitution is always singular, but that question remains open. However, if
the alphabet only has two symbols then singularity has been proved in [12], in one
and several dimensions.
The original Rudin-Shapiro sequence is not bijective but it lacks coincidences
and therefore has a continuous spectral component that has been known to be
absolutely continuous for some time (see [42, 89]). Generalizations to higher
dimensions were developed in [44], where the continuous part of the dynamical
spectrum was shown to be absolutely so. Recent work [30] gives a different
generalization and shows the continuous part of the diffraction spectrum to be
absolutely continuous. The “twisted silver mean” substitution, introduced in [10],
uses a ‘bar swap’ method seen in some of the Rudin-Shapiro constructions, but on a
non-constant length substitution. The result is a mixed spectrum, which is analysed
fully in [10] and found to have a mixed but singular spectrum.
For substitutions of length q, a necessary condition for the presence of absolutely
continuous spectrum had been conjectured: The transition matrix should have an
eigenvalue of modulus √q. This conjecture was veriﬁed in [23] with the result that if
the transition matrix has no eigenvalue of modulus √q then the dynamical spectrum
is singular.
16These sequences were actually deﬁned using number-theoretic constructions, but have simple
substitution rules also.

2
Introduction to Hierarchical Tiling Dynamical Systems
81
The results and techniques of [89] are given an important generalization to
multidimensional constant-length substitutions in [19]. Without requirements on
primitivity or height, Bartlett is able to show that “abelian” bijective substitutions
have only singular continuous spectrum, settling the longstanding conjecture in
these cases. A general algorithm for computing the spectrum for constant-length
multidimensional substitutions in Zd is also given.
Example 15 (Explicit Computations for the Thue-Morse Substitution) Let ΩT M be
the subshift for the Thue-Morse symbolic substitution 0 →01, 1 →10. We will
show how to make all of the eigenfunctions for the dynamical system, and also how
to make a function whose measure is (singular) continuous with respect to Lebesgue
measure. Together these functions generate all of L2.
To make an example of a nontrivial eigenfunction we consider the 2-supertiles
in T . Since 2-supertiles have length 4 in this example, there are four locations the
origin can occupy in either type of 2-supertile. Let us call them 0, 1, 2, 3 as we go
from left to right. Deﬁne O(T ) = i if the origin occupies the ith location of its
2-supertile. Now deﬁne f (T ) = exp (2πiO(T )/4).
Notice that if O(T ) = i and i < 3 then O(T −1) = i + 1. If O(T ) = 3
then O(T −1) = 0.17 Thus if O(T ) < 3 we get that U(f )(T ) = f (T −1) =
exp (2πi(O(T ) + 1)/4) and if O(T ) = 3 then U(f )(T ) = 1. This means that
U(f ) = exp(2πi/4)f , and so f is an eigenfunction with eigenvalue α = 1/4.
We compute the Fourier coefﬁcient ˆf (n), as deﬁned in Eq. (2.6). We know
Un(f )(T ) = exp(2πi(O(T −n))/4)
= exp(2πi(O(T ) + n)/4) = exp(2πin/4)f (T ),
and so
f (n) = (Un(f ), f ) =

ΩT M
exp(2πin/4)f (T )f (T )dμ(T )
=

ΩT M
exp(2πin/4)dμ(T ) = exp(2πin/4)
for all n. These are the Fourier coefﬁcients of a Dirac δ-function with its peak at
exp(2πin/4). Since σf is unique this makes it equal to this Dirac delta function.
Variations of the function f are easy to construct by looking at different sizes
of supertiles. If f is based on the location of the origin in an n-supertile, it will
have an eigenvalue with a 2n in the denominator. Since this substitution has height
1, this implies that the eigenvalues of the Koopman operator for the Thue-Morse
substitution are Z[1/2].
17This is indicative of the ‘odometer’-like structure of constant-length substitutions: the shift map
augments until a ﬁxed number and then resets to 0, augmenting elsewhere. In general the supertile
structure of any constant-length substitution looks like an odometer, see for example [45].

82
N. P. Frank
None of the functions we just constructed depend on the actual letter at the origin.
We can supplement these with a function that only knows what letter is at the origin
in T : Deﬁne g(T ) =
#
1
if T (0) = 1
−1
if T (0) = 0
. It is shown in [45] that together this and
the eigenfunctions span all of L2(ΩT M, μ).
Notice that g is orthogonal to the eigenfunction f since
< f, g >=

ΩT M
f (T )g(T )dμ(T ) =

Ω+
T M
f (T )dμ(T ) −

Ω−
T M
f (T )dμ(T ),
where Ω+
T M (resp. Ω−
T M) are the set of all tilings with a 1 (resp. 0) at the origin.
Each of the two integrals on the right are equal because they depend only on the
supertile structure of T and not the letter at the origin. Thus the inner product of g
and f is 0. We have obtained:
L2(ΩT M, μ) = H0
!
Z(g),
(2.10)
where H0 denotes the span of the eigenfunctions.
The function space L2 of general bijective substitutions in Zd breaks into a direct
sum of pieces that are discrete or continuous analogously to this example. If the
bijections comprising the substitution commute with translation, it is possible to
explicitly deﬁne the generators of the continuous spectral pieces [45, Theorem 4.2].
The nature of the continuous part of the spectrum continues to be investigated.
2.7
Spectral Analysis of Supertile Methods: Diffraction
Spectrum
The diffraction spectrum of tilings is motivated by physics. In this viewpoint we
consider the tiling as representing the atomic structure of a solid and we wish to
mathematically simulate what happens in a diffraction experiment on the solid. That
is, one passes x-rays or electrons through the solid, where they will bounce off
atoms and interfere constructively and destructively, ultimately creating an image
that represents something about the structure they passed through. Fourier analysis
turns out to be the right mathematical analogue for this. We describe the situation
for symbolic dynamics ﬁrst, then generalize to Rd.

2
Introduction to Hierarchical Tiling Dynamical Systems
83
2.7.1
Autocorrelation for Symbolic Sequences
Consider a sequence T0 ∈Ω ⊂AZ, where for convenience we assume that A is
a ﬁnite subset of the complex numbers. We know that constructive and destructive
interference depends on the repetition at various distances in T0. For instance, if T0
was periodic then there would be total agreement at distances that are multiples of
the period, leading to strong constructive interference at those distances.
A reasonable way to measure the extent to which T0 agrees with itself at a
distance k ∈Z is to consider the global average of T0(n −k)T0(n) over all n. Thus
we deﬁne a correlation function C : Z →C to be a cluster point of the sequences
#
1
N
N−1

n=0
T0(n −k)T0(n)
$
.
A diagonalization argument shows that for a given C there will be some sequence
{Nj} such that
C(k) = lim
j→∞
1
Nj
Nj −1

n=0
T0(n −k)T0(n).
For most examples of interest from primitive supertile methods, notably the
uniquely ergodic ones, it turns out that C(k) is unique, and it is useful to assume
that. (The general situation is described in detail starting on page 74 of [89]).
Suppose μ is an ergodic measure on Ω and consider the continuous function
O : Ω →C given by O(T ) = T (0). Then for μ-almost every T ∈Ω we have that
C(k) = lim
j→∞
1
Nj
Nj −1

n=0
T (n −k)T (n) =

Ω
O(T −k)O(T )dμ(T ).
That means C(k) = ˆO(k) from a dynamical spectrum perspective.
On the other hand, C(k) can be shown to be positive deﬁnite and so there is a
positive measure on the torus that has C(k) as its Fourier coefﬁcients. This measure,
which we denote ˆγ , is known in [89] as the correlation measure of the sequence T ;
it is the analogue of the diffraction measure (In general the diffraction measure is
the Fourier transform of the autocorrelation, which is deﬁned similar to C(k)). One
can see from this analysis that the diffraction spectrum should be subordinate to the
dynamical spectrum.

84
N. P. Frank
2.7.2
Diffraction in Rd
2.7.2.1
Overview
A tiling T is a model for the atomic structure of matter, where the atoms or
molecules occupy locations given by the tiles. In our simulation of a diffraction
experiment, we imagine that waves of some appropriate wavelength are sent through
the tiling, where they interfere constructively and destructively as determined by
relative distances between the tiles. The diffracted waves form an image where
we see bright spots of intense constructive interference (our “Bragg peaks”) and
a greyscale spectrum were the interference ranges from constructive to destructive.
The mathematics of diffraction has a long development that is based on Fourier
analysis. Because our tilings are inﬁnite there are technicalities that have to be
handled using tempered distributions and translation-bounded measures. It was Hof
in [60] who ﬁrst advocated using this overall method to approach the diffraction
of aperiodic structures and Dworkin [37] who noticed the connection between
diffraction and dynamical spectrum; [15] provides a recent and quite accessible
survey. An early computation for self-similar tilings is [52]. A serious treatment of
the details as well as the history behind mathematical diffraction appears in Chapters
8 and 9 of [11], along with numerous references. A more condensed and self-
contained description of the diffraction spectrum appears in [69], and we loosely
follow that development here.
Before we begin, consider this intuitive description of the mathematics of
diffraction that appears in [72, Section 5]. It clearly shows why the Fourier transform
is central to the theory.
When modeling diffraction, the two basic principles are the following: Firstly, each point
x in the solid gives rise to a wave ξ →exp(−ixξ). The overall wave w is the sum of the
single waves. Secondly, the quantity measured in an experiment is the intensity given as the
square of the modulus of the wave function.
We start by implementing this for a ﬁnite set F ⊂Rd. Each x ∈F gives rise to a wave
ξ →exp(−ixξ) and the overall wavefunction wF induced by F is accordingly
wF (ξ) =

x∈F
exp(−ixξ).
Thus, the intensity IF is
IF (ξ) =

x,y∈F
exp(−i(x −y)ξ) = 

x,y∈F
δx−y.′′
2.7.2.2
Diffraction via Delone Sets
It is natural to consider diffraction theory on discrete sets in Rd called Delone sets,
so we need to convert our tiling T into a point set Λ that represents the locations

2
Introduction to Hierarchical Tiling Dynamical Systems
85
and types of atoms in the solid T represents.18 We recall that a subset Λ ⊂Rd is
called a Delone set if there exist 0 < r ≤R such that every ball of radius r contains
at most one point of Λ and every ball of radius R contains at least one point of Λ.
A Delone multiset is a set Λ = Λ1 × Λ2 × · · · × Λm, where each Λi is a Delone
set in Rd and the set 
i≤m Λi, which by abuse of notation we also denote by Λ, is
Delone. An obvious way to turn T into a Delone multiset is to mark a special point
in the prototile of type i for each i = 1, .., m, and let Λi be the Delone set of all
copies of that point in T .
So Λ represents our set of scatterers from T and we have kept track of the type
of each scatterer. To account for different scattering strengths choose ai ∈C for
i ≤m. Using the notation δx to represent the Dirac delta function at x thought of as
a probability measure with support concentrated at x, we have the weighted Dirac
comb
ω =

i≤m
aiδΛi =

i≤m
ai

x∈Λi
δx.
This is a point measure on Rd that is not bounded, but is translation bounded in the
sense that supx∈Rd |ω|(x + K) < ∞for all compact K.
The autocorrelation is deﬁned to be the convolution of ω with the weighted Dirac
comb ˜ω = 
i≤m aiδ−Λi. Because convolutions are necessarily deﬁned on measures
with bounded support we end up with a limit that yields the autocorrelation
measure19
γω = lim
R→∞
1
V ol(BR(0))

ω|BR(0) ∗˜ω|BR(0)
	
=

i,j≤m
aiaj

z∈Λi−Λj
f req(z)δz,
where the frequency is computed as the limit, if it exists, as the average number of
times z is a return vector per unit area:
f req(z) = lim
R→∞
1
V ol(BR(0))#{x ∈Λi ∩BR(0) and x −z ∈Λj}.
Since T has ﬁnite local complexity, Λi −Λj is a discrete set and that makes γω a
point measure also.
Deﬁnition 2.7.1 If the autocorrelation measure γω exists, the diffraction measure
of T is the Fourier transform 
γω.
18This volume contains an overview of the history and development of tilings and Delone sets in
[101].
19This is also known as the “natural” autocorrelation measure because the averaging sets used are
balls centered at the origin as opposed to an arbitrary van Hove sequence.

86
N. P. Frank
From a physical perspective where we are running a diffraction experiment on a
solid modeled by T , the measure 
γω tells us how much intensity is scattered into
a given volume. We decompose 
γω into its pure point, singular continuous, and
absolutely continuous parts with respect to Lebesgue measure on Rd:

γω = ( 
γω)pp + ( 
γω)sc + ( 
γω)ac.
The pure point part tells us the location of the Bragg peaks that are so characteristic
of the diffraction images of crystals and quasicrystals. The degree of disorder in the
solid is quantiﬁed by the continuous parts. The singular continuous part is rarely
observed in physical experiments [11, Remark 9.3].
Example 16 The left column of Fig. 2.23 is a series of increasingly complex
examples of self-similar tilings with two colors of square tiles. These tilings
are examples of the sort analyzed in [44, 45]. Simulations of the corresponding
diffraction images are also shown. Each tiling is a substitution of constant length
2 × 2 or 4 × 4. The tiling in the last row is a two-letter factor of a substitution on 8
letters; the other three are simple two-letter substitutions. In all cases there are point
measures concentrated on Z[1/2] × Z[1/2].
The top tiling has a purely discrete spectrum because its substitution satisﬁes the
strong coincidence condition. The tiling in the middle of the ﬁgure is made from a
bijective substitution and thus has a continuous component to its spectral measure.
Because it is a constant-length symbolic substitution on two letters the continuous
portion of the measure is singularly continuous with respect to Lebesgue measure
[19].
The tiling on the right is a generalized Rudin-Shapiro tiling [44]. The original
substitution is on eight letters and although it has no coincidence, it is not bijective.
The tiling shown in the ﬁgure is a two-tile factor that is locally derived from the
8-letter substitution (and in fact the local derivability is mutual, so the factor makes
no difference dynamically). The continuous portion of the spectral measure for this
tiling is absolutely continuous.
It is interesting to simulate the diffraction images of these tilings in light of
these theoretical results. Anyone who produces sample images of any sort probably
knows that there are usually parameters that can be altered to enhance the images.
In our case such parameters include the weights on the dirac comb, the maximum
intensity, and scaling functions. Tinkering with the parameters on a local scale
does not change the overall qualitative appearance too much, and the apparent
difference between the absolutely continuous diffraction (on the right) and the other
two is persistent. The diffraction images for tilings with pure discrete spectrum
and those with a singular component consistently appear similar throughout a wide
range of parameters, with areas of extreme brightness and darkness. The absolutely
continuous spectral images are notable for their lack of these extremes.

2
Introduction to Hierarchical Tiling Dynamical Systems
87
Fig. 2.23 The top tiling is substitutive with coincidence and it has a purely discrete spectrum. The
substitution for the middle tiling is bijective and the spectrum is mixed, with a singular continuous
part. The bottom tiling is not bijective but has a mixed spectrum with absolutely continuous part

88
N. P. Frank
2.7.3
Intensities
How bright are the Bragg peaks? A preliminary formula was asserted in [28] and
became known after a while as the “Bombieri/Taylor conjecture” (see also [60]).
The formula, given below, is in terms of a limit. The convergence of this limit
has been studied in many different situations, surveyed in [72]. In that paper Lenz
shows that the formula is correct for a wide swath of aperiodic structures, including
tilings generated through substitution and through projection, as well as those that
are linearly repetitive. The setting in [72] is as follows.
Given a Delone set Λ, an element ξ ∈Rn, and a subset B ⊂Rn
cξ
B(Λ) =
1
V ol(B)

x∈Λ∩B
exp(−2πiξ · x).
For the cases under consideration the intensity at ξ ∈Rd is shown to exist and is
given by
%
γ (ξ) = lim
n→∞|cξ
Cn(Λ)|2,
where Cn is the cube of side length 2n centered at the origin and ξ ∈Rd. In many
of the situations discussed in [72] it is also proved that the eigenfunctions for the
Koopman operator are continuous.
2.8
Connection Between Diffraction and Dynamical
Spectrum
A recent survey of this topic is [15], which uniﬁes the various notions of diffraction
and dynamical spectrum, explains what was known up until 2016, and provides
numerous references. Done in the context of Delone sets with ﬁnite local com-
plexity, it applies to tilings of Rd and their dynamical systems. In particular it
explains the notions of diffraction for individual sets Λ as well as their hulls,
and explicitly shows how to map from the Schwarz space of test functions under
the diffraction measure to the Koopman representation of the dynamical system.
Through this mapping they note that “the diffraction measure completely controls
a subrepresentation of T ′′, thus making explicit the connection between dynamical
and diffraction spectrum.
The original paper connecting diffraction to dynamical spectrum is [37]. In it,
Dworkin makes an argument showing how to deduce pure point diffraction spectrum
if pure point dynamical spectrum has been established.
For a general system it may be that the diffraction spectrum does not contain as
much information as the dynamical spectrum, but in the case of pure point spectrum

2
Introduction to Hierarchical Tiling Dynamical Systems
89
it is known that the two classes are identical as long as there is unique ergodicity.
The result, proved in [69], is in the context of Delone multisets.
Theorem 2.8.1 ([69]) Suppose that a Delone multiset Λ has ﬁnite local complexity
and uniform cluster frequencies. Then the following are equivalent:
(i) Λ has pure point dynamical spectrum;
(ii) The measure ν = 
i≤m aiδΛi has pure point diffraction spectrum, for any
choice of complex numbers (ai)i≤m;
(iii) The measures δΛi have pure point spectrum, for i ≤m.
The condition of Λ having “uniform cluster frequencies” is equivalent to the
fact that its hull is uniquely ergodic, which we know is the case for many tilings
constructed using supertile methods. It would be remiss not to mention [70], the
companion work to [69]. It includes the result that for lattice substitution multiset
systems,20 being a regular model set is equivalent to having pure point spectrum.
2.8.1
When the Diffraction is Not Pure Point
Recent work in [16] attempts to understand the dynamical spectrum when it is larger
than the diffraction spectrum. An idea has been around for a while that factors of
a system can give nuance to the diffraction spectrum. That is, “the missing parts
of the dynamical spectrum could be reconstructed from the diffraction measures of
suitable factors of the original system”. In the uniquely ergodic case, the authors of
[16] are able to show (see Corollary 9 for technical details) that (1) the diffraction
measure of a factor is a spectral measure for the Koopman operator, and (2) the set
of diffraction measures of factors of a system are dense in the set of all spectral
measures for the system.
In [59] it is shown that there exist substitutions which require inﬁnitely many
factors to reconstruct the pure point dynamical spectrum from the respective
diffraction. There it is noted that it is not true that the maximal spectral measure
of a subshift can be realized as the fundamental diffraction of a subshift factor.
As is true for the dynamical spectrum, one of the major areas of study is to
determine the nature of the continuous part of the diffraction spectrum. In [9] it is
shown that the continuous part of the spectrum of a →abbb, b →a is singularly
continuous with respect to Lebesgue measure. The general case a →abk, b →a
is considered in [14]. The analysis is based on a ‘renormalization’ process wherein
the substitution structure of the self-similar tiling is used to ﬁnd recursion relations
for the autocorrelation measure. This method was also applied to the twisted silver
mean in [10].
20Not a particularly restrictive subclass according to Section 5.1 of [70].

90
N. P. Frank
2.9
For Further Reading
A good primary source for fundamental results on tiling dynamical systems is B.
Solomyak’s “The dynamics of self-similar tilings” [100]. This paper lays out the
basic deﬁnitions and takes an ergodic theoretic approach to the systems. A funda-
mental resource in elementary tiling theory is B. Grunbaum and G. C. Shephard’s
Tilings and Patterns [58], which catalogs nearly everything that is known about
periodic tilings and more. It contains an enormous number of examples, and does
include a few nonperiodic tilings such as the Penrose, Robinson, and Ammann
tilings. Good general ergodic theory references for Z-actions are K. Petersen’s
Ergodic Theory and P. Walters’ An Introduction to Ergodic Theory [84, 104].
Fundamental symbolic dynamics references are D. Lind and B. Marcus’ An Intro-
duction to Symbolic Dynamics and Coding and Bruce Kitchens’ Symbolic Dynamcs
[67, 74]. Symbolic substitutions are surveyed up to 2002 in the collectively written
Substitutions in Dynamics, Arithmetics, and Combinatorics [42]. A recent survey
of S-adic expansions appears in V. Berthé and V. Delecroix’s “Beyond substitutive
dynamical systems: S-adic expansions” [24]. The deﬁnitive volume for the study
of aperiodic order is M. Baake and U. Grimm’s Aperiodic Order [11]. It takes a
physical perspective and is full of examples of every sort, many analyzed fully.
There are a few other expositions of tilings and tiling spaces that are worth
mentioning here. For a rigorous dynamical introduction to the theory, with mul-
tidimensional actions surveyed up to 2004 see E. A. Robinson, Jr.’s “Symbolic
dynamics and tilings of Rd” [93]. Radin’s AMS Student Mathematical Library notes
Miles of Tiles [90] introduces readers to the dynamics and ergodic theory with a
strong physical motivation. At a university student level, it carries the additional
interest of treating tilings with inﬁnitely many tile rotations such as the pinwheel
tiling. Substitutions on the graphs of tilings are considered in the author’s “A primer
on substitution tilings of Euclidean space” [46], which includes several examples
of such combinatorial substitutions and their associated self-similar tilings. The
topology of tiling spaces is the subject of L. Sadun’s Topology of Tiling Spaces [95],
which takes the reader through self-similar tiling constructions with and without
rotations, shows tiling spaces are inverse limits, and does cohomology in the tiling
context. There are many more topics we have not even mentioned, so the reader is
encouraged to ﬁnd a compelling topic to pursue.
Acknowledgments The author would like to thank Michael Baake, Franz Gähler, E. A. Robinson,
Jr., Dan Rust, Lorenzo Sadun, and Boris Solomyak for their comments on drafts of this work.
References
1. Tilings encyclopedia (2018). http://tilings.math.uni-bielefeld.de/. Accessed Dec 2018
2. S. Akiyama, M. Barge, V. Berthé, J.-Y. Lee, A. Siegel, On the Pisot Substitution Conjecture.
Mathematics of Aperiodic Order, Progress in Mathematics, vol. 309 (Birkhäuser/Springer,
Basel, 2015), pp. 33–72, MR 3381478

2
Introduction to Hierarchical Tiling Dynamical Systems
91
3. S. Akiyama, Strong coincidence and overlap coincidence. Discrete Contin. Dyn. Syst. 36(10),
5223–5230 (2016). MR 3543543
4. S. Akiyama, J.-Y. Lee, Algorithm for determining pure pointedness of self-afﬁne tilings. Adv.
Math. 226(4), 2855–2883 (2011). MR 2764877
5. S. Akiyama, J.-Y. Lee, Overlap coincidence to strong coincidence in substitution tiling
dynamics. Eur. J. Combin. 39, 233–243 (2014). MR 3168528
6. J.-P. Allouche, J. Shallit, Automatic Sequences. Theory, Applications, Generalizations (Cam-
bridge University Press, Cambridge, 2003), MR 1997038
7. P. Arnoux, M. Furukado, E. Harriss, S. Ito, Algebraic numbers, free group automorphisms and
substitutions on the plane. Trans. Amer. Math. Soc. 363(9), 4651–4699 (2011). MR 2806687
8. P. Arnoux, S. Ito, Pisot substitutions and Rauzy fractals. Bull. Belg. Math. Soc. Simon
Stevin 8(2), 181–207 (2001). Journées Montoises d’Informatique Théorique (Marne-la-
Vallée, 2000). MR 1838930
9. M. Baake, N.P. Frank, U. Grimm, E.A. Robinson Jr., Geometric properties of a binary non-
pisot inﬂation and absence of absolutely continuous diffraction. Studia Math. 247, 109–154
(2019)
10. M. Baake, F. Gähler, Pair correlations of aperiodic inﬂation rules via renormalisation: some
interesting examples. Topology Appl. 205, 4–27 (2016). MR 3493304
11. M. Baake, U. Grimm, Aperiodic Order. Vol. 1. Encyclopedia of Mathematics and its
Applications, vol. 149 (Cambridge University Press, Cambridge, 2013), A Mathematical
Invitation, With a foreword by Roger Penrose. MR 3136260
12. M. Baake, U. Grimm, Squirals and beyond: substitution tilings with singular continuous
spectrum. Ergodic Theory Dynam. Syst. 34(4), 1077–1102 (2014). MR 3227148
13. M. Baake, U. Grimm, Diffraction of a binary non-pisot inﬂation tiling. J. Phys. Conf. Ser.
809(1), 012026 (2017)
14. M. Baake, U. Grimm, N. Mañibo, Spectral analysis of a family of binary inﬂation rules. Lett.
Math. Phys. 108(8), 1783–1805 (2018). MR 3814725
15. M. Baake, D. Lenz, Spectral notions of aperiodic order. Discrete Contin. Dyn. Syst. Ser. S
10(2), 161–190 (2017). MR 3600642
16. M. Baake, D. Lenz, A. van Enter, Dynamical versus diffraction spectrum for structures with
ﬁnite local complexity. Ergodic Theory Dyn. Syst. 35(7), 2017–2043 (2015). MR 3394105
17. M. Barge, Pure discrete spectrum for a class of one-dimensional substitution tiling systems.
Discrete Contin. Dyn. Syst. 36(3), 1159–1173 (2016). MR 3431249
18. M. Barge, B. Diamond, Coincidence for substitutions of Pisot type. Bull. Soc. Math. France
130(4), 619–626 (2002). MR 1947456
19. A. Bartlett, Spectral theory of Zd substitutions. Ergodic Theory Dyn. Syst. 38(4), 1289–1341
(2018). MR 3789166
20. N. Bédaride, A. Hilion, Geometric realizations of two-dimensional substitutive tilings. Q. J.
Math. 64(4), 955–979 (2013). MR 3151599
21. J. Bellissard, A. Julien, J. Savinien, Tiling groupoids and Bratteli diagrams. Ann. Henri
Poincaré 11(1–2), 69–99 (2010). MR 2658985
22. R. Berger, The undecidability of the domino problem. Mem. Amer. Math. Soc. No. 66, 72
(1966). MR 0216954
23. A.
Berlinkov,
B.
Solomyak,
Singular
substitutions
of
constant
length
(2017).
ArXiv:1705.00899v2
24. V. Berthé, V. Delecroix, Beyond Substitutive Dynamical Systems: S-adic Expansions (Numer-
ation and Substitution 2012). RIMS Kôkyûroku Bessatsu, vol. B46, (Research Institute for
Mathematical Sciences (RIMS), Kyoto, 2014), pp. 81–123. MR 3330561
25. S. Bezuglyi, J. Kwiatkowski, K. Medynets, Aperiodic substitution systems and their Bratteli
diagrams. Ergod. Theory Dyn. Syst. 29(1), 37–72 (2009). MR 2470626
26. S. Bezuglyi, J. Kwiatkowski, K. Medynets, B. Solomyak, Invariant measures on stationary
Bratteli diagrams. Ergod. Theory Dyn. Syst. 30(4), 973–1007 (2010). MR 2669408

92
N. P. Frank
27. S. Bezuglyi, J. Kwiatkowski, K. Medynets, B. Solomyak, Finite rank Bratteli diagrams:
structure of invariant measures. Trans. Amer. Math. Soc. 365(5), 2637–2679 (2013). MR
3020111
28. E. Bombieri, J.E. Taylor, Which distributions of matter diffract? An initial investigation. J.
Phys. 47(7) , Suppl. Colloq. C3, C3–19–C3–28 (1986). International workshop on aperiodic
crystals (Les Houches, 1986). MR 866320
29. R.V. Chacon, A geometric construction of measure preserving transformations, in Proceed-
ings of the Fifth Berkeley Symposium Mathematical. Statistics and Probability (Berkeley,
California, 1965/66), Vol. II: Contributions to Probability Theory, Part 2 (University of
California Press, Berkeley, 1967), pp. 335–360. MR 0212158
30. L. Chan, U. Grimm, Spectrum of a Rudin-Shapiro-like sequence. Adv. Appl. Math. 87, 16–23
(2017). MR 3629260
31. A. Clark, L. Sadun, When size matters: subshifts and their related tiling spaces. Ergod. Theory
Dyn. Syst. 23(4), 1043–1057 (2003). MR 1997967
32. E.M. Coven, M.S. Keane, The structure of substitution minimal sets. Trans. Amer. Math. Soc.
162, 89–102 (1971). MR 0284995
33. F.M. Dekking, The spectrum of dynamical systems arising from substitutions of constant
length. Z. Wahrscheinlichkeitstheorie und Verw. Gebiete 41(3), 221–239 (1977/1978). MR
0461470
34. F.M. Dekking, M. Keane, Mixing properties of substitutions. Z. Wahrscheinlichkeitstheorie
und Verw. Gebiete 42(1), 23–33 (1978). MR 0466485
35. F. Durand, Linearly recurrent subshifts have a ﬁnite number of non-periodic subshift factors.
Ergod. Theory Dyn. Syst. 20(4), 1061–1078 (2000). MR 1779393
36. F. Durand, Corrigendum and addendum to: “Linearly recurrent subshifts have a ﬁnite
number of non-periodic subshift factors” [Ergodic Theory Dynam. Systems 20(4), 1061–1078
(2000); MR1779393 (2001m:37022)]. Ergod. Theory Dyn. Syst. 23(2), 663–669 (2003). MR
1972245
37. S. Dworkin, Spectral theory and x-ray diffraction. J. Math. Phys. 34(7), 2965–2967 (1993).
MR 1224190
38. S. Ferenczi, Rank and symbolic complexity. Ergod. Theory Dyn. Syst. 16(4), 663–682 (1996).
MR 1406427
39. T. Fernique, Local rule substitutions and stepped surfaces. Theoret. Comput. Sci. 380(3),
317–329 (2007). MR 2331001
40. T. Fernique, N. Ollinger, Combinatorial substitutions and soﬁc tilings. Journées Automates
Cellulaires (2010) (Turku). arXiv:1009.5167
41. A.M. Fisher, Nonstationary mixing and the unique ergodicity of adic transformations. Stoch.
Dyn. 9(3), 335–391 (2009). MR 2566907
42. N.P. Fogg, Substitutions in Dynamics, Arithmetics and Combinatorics, ed. by V. Berthé, S.
Ferenczi, C. Mauduit, A. Siegel. Lecture Notes in Mathematics, vol. 1794 (Springer, Berlin,
2002). MR 1970385
43. N.P. Frank, Detecting combinatorial hierarchy in tilings using derived Voronoï tesselations.
Discrete Comput. Geom. 29(3), 459–476 (2003). MR 1961011
44. N.P. Frank, Substitution sequences in Zd with a non-simple Lebesgue component in the
spectrum. Ergod. Theory Dyn. Syst. 23(2), 519–532 (2003). MR 1972236
45. N.P. Frank, Multidimensional constant-length substitution sequences. Topol. Appl. 152(1–2),
44–69 (2005). MR 2160805
46. N.P. Frank, A primer of substitution tilings of the Euclidean plane. Expo. Math. 26(4), 295–
326 (2008). MR 2462439
47. N.P. Frank, Tilings with Inﬁnite Local Complexity. Mathematics of Aperiodic Order, Progress
in Mathematics, vol. 309 (Birkhäuser/Springer, Basel, 2015), pp. 223–257. MR 3381483
48. N.P. Frank, E.A. Robinson, Jr., Generalized β-expansions, substitution tilings, and local
ﬁniteness. Trans. Amer. Math. Soc. 360(3), 1163–1177 (2008). MR 2357692
49. N.P. Frank, L. Sadun, Topology of some tiling spaces without ﬁnite local complexity. Discrete
Contin. Dyn. Syst. 23(3), 847–865 (2009). MR 2461829

2
Introduction to Hierarchical Tiling Dynamical Systems
93
50. N.P. Frank, L. Sadun, Fusion: a general framework for hierarchical tilings of Rd. Geom.
Dedicata 171, 149–186 (2014). MR 3226791
51. D. Frettlöh, More Inﬂation Tilings, in Aperiodic Order, Vol. 2. Encyclopedia of Mathematics
and its Applications, vol. 166 (Cambridge University Press, Cambridge, 2017), pp. 1–37. MR
3791847
52. F. Gähler, R. Klitzing, The diffraction pattern of self-similar tilings, in The Mathematics
of Long-Range Aperiodic Order (Waterloo, ON, 1995). NATO Advanced Science Institutes
Series C: Mathematical and Physical Sciences, vol. 489 (Kluwer Academic Publishers,
Dordrecht, 1997), pp. 141–174. MR 1460023
53. F. Gähler, E.E. Kwan, G.R. Maloney, A computer search for planar substitution tilings with
n-fold rotational symmetry. Discrete Comput. Geom. 53(2), 445–465 (2015). MR 3316232
54. M. Gardner, Mathematical games. Sci. Amer. 236(1), 110–121 (1977)
55. C. Godrèche, F. Lançon, A simple example of a non-Pisot tiling with ﬁve-fold symmetry. J.
Physique I 2(2), 207–220 (1992). MR 1185612
56. G.R. Goodson, A survey of recent results in the spectral theory of ergodic dynamical systems.
J. Dyn. Control Syst. 5(2), 173–226 (1999). MR 1693318
57. W.H. Gottschalk, Substitution minimal sets. Trans. Amer. Math. Soc. 109, 467–491 (1963).
MR 0190915
58. B. Grünbaum, G.C. Shephard, Tilings and Patterns (W. H. Freeman and Company, New York,
1987). MR 857454
59. J.L. Herning, Spectrum and factors of substitution dynamical systems, ProQuest LLC, Ann
Arbor, MI. Thesis (Ph.D.)–The George Washington University, 2013. MR 3167382
60. A. Hof, On diffraction by aperiodic structures. Comm. Math. Phys. 169(1), 25–43 (1995).
MR 1328260
61. M. Hollander, B. Solomyak, Two-symbol Pisot substitutions have pure discrete spectrum.
Ergod. Theory Dyn. Syst. 23(2), 533–540 (2003). MR 1972237
62. B. Host, Valeurs propres des systèmes dynamiques déﬁnis par des substitutions de longueur
variable. Ergod. Theory Dyn. Syst. 6(4), 529–540 (1986). MR 873430
63. E. Jeandel, P. Vanier, The Undecidability of the Domino Problem. This volume, Lecture Notes
in Mathematics (Springer, Berlin, 2019)
64. T. Kamae, Spectrum of a substitution minimal set. J. Math. Soc. Japan 22, 567–578 (1970).
MR 0286092
65. J. Kellendonk, L. Sadun, Meyer sets, topological eigenvalues, and Cantor ﬁber bundles. J.
Lond. Math. Soc. (2) 89(1), 114–130 (2014). MR 3174736
66. R. Kenyon, B. Solomyak, On the characterization of expansion maps for self-afﬁne tilings.
Discrete Comput. Geom. 43(3), 577–593 (2010). MR 2587839
67. B.P. Kitchens, Symbolic Dynamics: One-sided, Two-sided and Countable State Markov Shifts.
Universitext (Springer, Berlin, 1998). MR 1484730
68. J. Kwapisz, Inﬂations of self-afﬁne tilings are integral algebraic Perron. Invent. Math. 205(1),
173–220 (2016). MR 3514961
69. J.-Y. Lee, R.V. Moody, B. Solomyak, Pure point dynamical and diffraction spectra. Ann.
Henri Poincaré 3(5), 1003–1018 (2002). MR 1937612
70. J.-Y. Lee, R.V. Moody, B. Solomyak, Consequences of pure point diffraction spectra for
multiset substitution systems. Discrete Comput. Geom. 29(4), 525–560 (2003). MR 1976605
71. M. Lema´nczyk, Spectral Theory of Dynamical Systems. Mathematics of Complexity and
Dynamical Systems, Vol. 1–3 (Springer, New York, 2012), pp. 1618–1638. MR 3220776
72. D. Lenz, Continuity of eigenfunctions of uniquely ergodic dynamical systems and intensity
of Bragg peaks. Comm. Math. Phys. 287(1), 225–258 (2009). MR 2480747
73. S. Lidin, The Discovery of Quasicrystals: Scientiﬁc Background on the Nobel Prize in
Chemistry 2011 (The Royal Swedish Academy of Sciences, Stockholm, 2011)
74. D. Lind, B. Marcus, An Introduction to Symbolic Dynamics and Coding (Cambridge
University Press, Cambridge, 1995). MR 1369092
75. A.N. Livshits, On the spectra of adic transformations of Markov compact sets. Uspekhi Mat.
Nauk 42(3(255)), 189–190 (1987). MR 896889

94
N. P. Frank
76. M. Lothaire, Algebraic Combinatorics on Words. Encyclopedia of Mathematics and its
Applications, vol. 90 (Cambridge University Press, Cambridge, 2002), A collective work
by J. Berstel, D. Perrin, P. Seebold, J. Cassaigne, A. De Luca, S. Varricchio, A. Lascoux,
B. Leclerc, J.-Y. Thibon, V. Bruyere, C. Frougny, F. Mignosi, A. Restivo, C. Reutenauer, D.
Foata, G.-N. Han, J. Desarmenien, V. Diekert, T. Harju, J. Karhumaki, W. Plandowski, With
a preface by Berstel and Perrin. MR 1905123
77. A.L. Mackay, Crystallography and the Penrose pattern. Phys. A 114(1–3), 609–613 (1982).
MR 678468
78. G.R. Maloney, D. Rust, Beyond primitivity for one-dimensional substitution subshifts and
tiling spaces. Ergod. Theory Dyn. Syst. 38(3), 1086–1117 (2018). MR 3784255
79. B.F. Martensen, Generalized balanced pair algorithm. Topology Proc. 28(1), 163–178 (2004).
Spring Topology and Dynamical Systems Conference. MR 2105455
80. J.C. Martin, Substitution minimal ﬂows. Amer. J. Math. 93, 503–526 (1971). MR 0300261
81. B. Mossé, Puissances de mots et reconnaissabilité des points ﬁxes d’une substitution. Theoret.
Comput. Sci. 99(2), 327–334 (1992). MR 1168468
82. R. Penrose, The rôle of aesthetics in pure and applied mathematical research. Bull. Inst. Math.
Appl. 10, 266–271 (1974)
83. R. Penrose, Pentaplexity: a class of nonperiodic tilings of the plane. Math. Intell. 2(1), 32–37
(1979/1980). MR 558670
84. K. Petersen, Ergodic Theory. Cambridge Studies in Advanced Mathematics, vol. 2 (Cam-
bridge University Press, Cambridge, 1989, Corrected Reprint of the 1983 Original). MR
1073173
85. K. Petersen, Factor maps between tiling dynamical systems. Forum Math. 11(4), 503–512
(1999). MR 1699171
86. J. Peyrière, Frequency of patterns in certain graphs and in Penrose tilings. J. Physique 47(7),
Suppl. Colloq. C3, C3–41–C3–62 (1986). International workshop on aperiodic crystals (Les
Houches, 1986). MR 866322
87. B. Praggastis, Numeration systems and Markov partitions from self-similar tilings. Trans.
Amer. Math. Soc. 351(8), 3315–3349 (1999). MR 1615950
88. N. Priebe, B. Solomyak, Characterization of planar pseudo-self-similar tilings. Discrete
Comput. Geom. 26(3), 289–306 (2001). MR 1854103
89. M. Queffélec, Substitution Dynamical Systems—Spectral Analysis. Lecture Notes in Mathe-
matics, vol. 1294 (Springer, Berlin, 1987). MR 924156
90. C. Radin, Miles of Tiles. Student Mathematical Library, vol. 1 (American Mathematical
Society, Providence, 1999). MR 1707270
91. C. Radin, L. Sadun, Isomorphism of hierarchical structures. Ergod. Theory Dyn. Syst. 21(4),
1239–1248 (2001). MR 1849608
92. C. Radin, M. Wolff, Space tilings and local isomorphism. Geom. Dedicata 42(3), 355–360
(1992). MR 1164542
93. E.A. Robinson, Jr., Symbolic Dynamics and Tilings of Rds. Symbolic Dynamics and
Its Applications, Proceedings of Symposia in Applied Mathematics, vol. 60 (American
Mathematical Society, Providence, 2004), pp. 81–119. MR 2078847
94. R.M. Robinson, Undecidability and nonperiodicity for tilings of the plane. Invent. Math. 12,
177–209 (1971). MR 0297572
95. L. Sadun, Topology of Tiling Spaces. University Lecture Series, vol. 46 (American Mathemat-
ical Society, Providence, 2008). MR 2446623
96. M. Senechal, Quasicrystals and Geometry (Cambridge University Press, Cambridge, 1995).
MR 1340198
97. D. Shechtman, I. Blech, D. Gratias, J.W. Cahn, Metallic phase with long-range orientational
order and no translational symmetry. Phys. Rev. Lett. 53, 1951–1953 (1984)
98. B. Solomyak, Nonperiodicity implies unique composition for self-similar translationally ﬁnite
tilings. Discrete Comput. Geom. 20(2), 265–279 (1998). MR 1637896

2
Introduction to Hierarchical Tiling Dynamical Systems
95
99. B. Solomyak, Pseudo-self-afﬁne tilings in Rd. Zap. Nauchn. Sem. S.-Peterburg. Otdel. Mat.
Inst. Steklov. 326 (2005), Teor. Predst. Din. Sist. Komb. i Algoritm. Metody. 13, 198–213,
282–283 (2005); Translation in J. Math. Sci. 140(3), 452–460 (2007). MR 2183221
100. B. Solomyak, Dynamics of self-similar tilings. Ergodic Theory Dynam. Syst. 17(3), 695–738
(1997). MR 1452190
101. B. Solomyak, Lecture on Delone Sets and Tilings. This Volume, Lecture Notes in Mathemat-
ics (Springer, Berlin, 2019)
102. W. Thurston, Groups, Tilings, and Finite State Automata. AMS Colloquium Lecture Notes
(American Mathematical Society, Providence, 1989)
103. J. Thuswaldner, S-adic Sequences. A Bridge Between Dynamics, Arithmetic, and Geometry.
This Volume, Lecture Notes in Mathematics (Springer, Berlin, 2019)
104. P. Walters, An Introduction to Ergodic Theory. Graduate Texts in Mathematics, vol. 79
(Springer, New York, 1982). MR 648108
105. H. Wang, Proving theorems by pattern recognition, II. Bell Syst. Tech. J. 40, 1–41 (1961).

Chapter 3
S-adic Sequences: A Bridge Between
Dynamics, Arithmetic, and Geometry
Jörg M. Thuswaldner
Abstract A Sturmian sequence is an inﬁnite nonperiodic string over two letters
with minimal subword complexity. In two papers, the ﬁrst written by Morse and
Hedlund in 1940 and the second by Coven and Hedlund in 1973, a surprising
correspondence was established between Sturmian sequences on one side and
rotations by an irrational number on the unit circle on the other. In 1991 Arnoux
and Rauzy observed that an induction process (invented by Rauzy in the late
1970s), related with the classical continued fraction algorithm, can be used to
give a very elegant proof of this correspondence. This process, known as the
Rauzy induction, extends naturally to interval exchange transformations (this is the
setting in which it was ﬁrst formalized). It has been conjectured since the early
1990s that these correspondences carry over to rotations on higher dimensional
tori, generalized continued fraction algorithms, and so-called S-adic sequences
generated by substitutions. The idea of working towards such a generalization
is known as Rauzy’s program. Recently Berthé, Steiner, and Thuswaldner made
some progress on Rauzy’s program and were indeed able to set up the conjectured
generalization of the above correspondences. Using a generalization of Rauzy’s
induction process in which generalized continued fraction algorithms show up,
they proved that under certain natural conditions an S-adic sequence gives rise
to a dynamical system which is measurably conjugate to a rotation on a higher
dimensional torus. Moreover, they established a metric theory which shows that
counterexamples like the one constructed in 2000 by Cassaigne, Ferenczi, and
Zamboni are rare. It is the aim of the present chapter to survey all these ideas and
results.
J. M. Thuswaldner ()
Department Mathematics and Information Technology, University of Leoben, Leoben, Austria
e-mail: joerg.thuswaldner@unileoben.ac.at
© The Editor(s) (if applicable) and The Author(s), under exclusive license
to Springer Nature Switzerland AG 2020
S. Akiyama, P. Arnoux (eds.), Substitution and Tiling Dynamics: Introduction
to Self-inducing Structures, Lecture Notes in Mathematics 2273,
https://doi.org/10.1007/978-3-030-57666-0_3
97

98
J. M. Thuswaldner
3.1
Introduction
A Sturmian sequence is an inﬁnite string over two letters with low subword
complexity. In particular, it has exactly n + 1 different subwords of a given length
n ∈N. Sturmian sequences have been studied extensively in the literature from
various points of view and we refer to Lothaire [101, Chapter 2] or Pytheas
Fogg [82, Chapter 6] for detailed accounts. The history of the research surveyed
in the present chapter starts with two papers written by Morse and Hedlund [107] as
well as Coven and Hedlund [67] in 1940 and 1973, respectively. In these papers the
authors established a surprising correspondence between Sturmian sequences and
rotations by an irrational number α on the torus T = R/Z. In their proof “balance
properties” of Sturmian sequences play a prominent role. Several decades later,
Arnoux and Rauzy [22] observed that an induction process in which the classical
continued fraction algorithm appears can be used to give another very elegant proof
of this correspondence (see also Rauzy’s earlier papers [112, 113] on this induction
process). Their proof also shows how arithmetic and Diophantine properties of an
irrational number α are encoded in the corresponding Sturmian sequence.
It has been conjectured since the early 1990s that these correspondences between
rotations on T, continued fractions, and Sturmian sequences carry over to rotations
on higher dimensional tori, generalized continued fraction algorithms, and so-called
S-adic sequences generated by substitutions. The idea of working towards such
a generalization is known as Rauzy’s program and starting with Rauzy [114] a
number of examples which hint at such a generalization was devised. A natural
class of S-adic sequences to study in this context are so-called Arnoux-Rauzy
sequences which go back to Arnoux and Rauzy [22]. These are sequences over three
letters that behave analogously to Sturmian sequences in many regards. However,
in 2000 Cassaigne et al. [63] could construct Arnoux-Rauzy sequences with strong
“imbalance”, a property which cannot occur for a Sturmian sequence. Cassaigne et
al. [62] even constructed Arnoux-Rauzy sequences that give rise to weakly-mixing
dynamical systems which are far from rotations in their dynamical behavior. All
this shows the limitations of Rauzy’s program and indicates that the situation in the
general setting is more complicated than it is in the classical case.
Nevertheless, recently Berthé et al. [52] made some progress on Rauzy’s
program and were indeed able to set up the conjectured generalization of the above
correspondences. Using a generalization of Rauzy’s induction process in which
generalized continued fraction algorithms show up, they proved that under certain
natural conditions an S-adic sequence gives rise to a dynamical system which
is measurably conjugate to a rotation on a higher dimensional torus. Moreover,
they established a metric theory which shows that exceptional cases like the ones
constructed in [62] and [63] are rare. A prominent role in this generalization
is played by tilings induced by generalizations of the classical Rauzy fractal
introduced by Rauzy [114].
Another idea which can be linked to the above results goes back to Artin [26],
who observed that the classical continued fraction algorithm and its natural exten-

3
S-adic Sequences
99
sion can be viewed as a Poincaré section of the geodesic ﬂow on the space of
two-dimensional lattices SL2(Z)\SL2(R). Arnoux and Fisher [14] revisited Artin’s
idea and showed that the correspondence between continued fractions, rotations,
and Sturmian sequences can be interpreted in a very nice way in terms of an
extension of this geodesic ﬂow to pointed lattices which is called the scenery ﬂow.
Currently, Arnoux et al. [12] are setting up a generalization of this connection
between continued fraction algorithms and geodesic ﬂows. In particular, they code
the Weyl Chamber Flow, a diagonal Rd−1-action on the space of d-dimensional
lattices SLd(Z)\SLd(R), arithmetically and geometrically by generalized continued
fraction algorithms. In this coding, which provides a new view of the relation
between S-adic sequences and rotations on higher dimensional tori, non-stationary
Markov partitions deﬁned in terms of generalized Rauzy fractals are of great
importance.
It is the aim of the present chapter to survey all these ideas and results. In
Sect. 3.2 we deal with the case of Sturmian sequences and Sect. 3.3 discusses the
problems with the extension of the theory to the more general situation. From
Sect. 3.4 onwards we set up the general theory of S-adic sequences and their relation
to generalized continued fraction algorithms and rotations on higher dimensional
tori.
3.2
The Classical Case
We start our journey by giving some elements of the interaction between Sturmian
sequences, the classical continued fraction algorithm, and irrational rotations on the
circle. After that we discuss natural extensions of continued fractions and show
how all these objects turn up in the study of the geodesic ﬂow acting on the space
SL2(Z)\SL2(R) of lattices and its extension to pointed lattices. We will prove
most of the results that we state and although our exposition is self-contained we
recommend the reader to have a look at the survey [82, Chapter 6] in order to ﬁnd
more background information on the subject of this section.
3.2.1
Sturmian Sequences and Their Basic Properties
For a ﬁnite set {1, 2, . . ., d} denote by {1, 2, . . ., d}∗the set of all ﬁnite words
v0 . . . vn−1 whose letters vi, 0 ≤i < n, are contained in {1, 2, . . ., d}. Moreover,
let {1, 2, . . . , d}N be the space of (right-inﬁnite) sequences w = w0w1 . . . whose
letters wi, i ∈N, are elements of {1, 2, . . ., d}. The shift Σ : {1, 2, . . ., d}N →
{1, 2, . . ., d}N on this space of sequences is deﬁned by Σ(w0w1 . . .) = w1w2 . . .
Let w = w0w1 . . . ∈{1, 2, . . ., d}N be a sequence. A factor (or subword) of
w is a word v0 . . . vn−1 ∈{1, 2, . . ., d}∗for which there is k ≥0 such that
wk . . . wk+n−1 = v0 . . . vn−1. In this case we say that v occurs in w at position k.

100
J. M. Thuswaldner
The complexity function pw : N →N of w assigns to each integer n the number of
words v0 . . . vn−1 ∈{1, 2, . . ., d}∗that are factors of w. If w is ultimately periodic
in the sense that there exist k > 0 and N ≥0 with wn = wn+k for each n ≥N then
pw is a bounded function. On the other hand, a result by Coven and Hedlund [67]
which is not hard to prove states that a sequence w ∈{1, 2, . . ., d}N that admits the
inequality pw(n) ≤n for a single choice of n is ultimately periodic (see also [82,
Proposition 1.1.1]). It is the class of not ultimately periodic sequences with smallest
complexity function that we are interested in.
Deﬁnition 3.2.1 (Sturmian Sequence)
A sequence w ∈{1, 2}N is called a
Sturmian sequence if its complexity function satisﬁes pw(n) = n + 1 for all n ∈N.
It is a priori not clear that Sturmian sequences exist at all. However, we will see
in Theorem 3.2.11 below that they can be characterized as so-called natural codings
of irrational rotations which are easy to construct (and will be deﬁned in Sect. 3.2.4).
A detailed account on the early history of Sturmian sequences, which goes back
to Bernoulli [39], is given in [101, Notes to Chapter 2]. The name “Sturmian
sequence” was coined in 1940 by Morse and Hedlund [107]. Sturmian sequences
have been studied extensively. For an overview on fundamental properties of
Sturmian sequences we refer in particular to Lothaire [101, Chapter 2], Pytheas
Fogg [82, Chapter 6], or Allouche and Shallit [6, Chapters 9 and 10]. Belov et
al. [38] discuss some aspects of Sturmian sequences which are related to the present
survey.
We start with the discussion of basic properties of Sturmian sequences. The fact
that pw(n) = n + 1 holds for a Sturmian sequence entails that for each n there is
only one factor v0 . . . vn−1 of w with the property that both words v0 . . . vn−11 and
v0 . . . vn−12 are factors of w. Such a word v0 . . . vn−1 is called right special factor
of w. Left special factors are deﬁned analogously.
Our ﬁrst lemma deals with recurrence of Sturmian sequences. Recall that a
sequence w ∈{1, 2}N is called recurrent if each factor of w occurs inﬁnitely often,
i.e., at inﬁnitely many positions, in w.
Lemma 3.2.2 (Cf. e.g. [82, Proposition 6.1.2]) A Sturmian sequence is recurrent.
Proof Suppose that this is wrong and let w be a nonrecurrent Sturmian sequence.
Then there exists a factor v of length n, say, that occurs only ﬁnitely many times
in w. Then there exists k ∈N such that w′ = Σkw does not contain v as a factor.
However, as pw(n) = n+1 this implies that pw′(n) ≤n and, hence, w′ is ultimately
periodic. However, then also w is ultimately periodic, a contradiction.
⊓⊔
Next we discuss balance. To give a formal deﬁnition we introduce some notation.
For a word v ∈{1, 2}∗we denote by |v| its length, i.e., the number of letters of v.
Moreover, for i ∈{1, 2}, we write |v|i for the number of occurrences of the letter i
in v.
Deﬁnition 3.2.3 (Balanced Sequence) A sequence w ∈{1, 2}N is called balanced
if each pair of factors (v, v′) of w with |v| = |v′| satisﬁes
|v|1 −|v′|1
 ≤1.

3
S-adic Sequences
101
As was observed already in [107], there is a tight relation between Sturmian
sequences and balance.
Proposition 3.2.4 Let w ∈{1, 2}N be given. Then w is a Sturmian sequence if and
only if w is not ultimately periodic and balanced.
The proof of this result is combinatorial. It is based on the observation that for a
sequence w which is not balanced there is a word v ∈{1, 2}∗such that 1v1 and 2v2
are factors of w. Since the details are a bit tricky we do not give them here and refer
the reader to [107] or [82, Chapter 6, p. 147ff ].
The fact that Sturmian sequences are balanced will now be exploited in order to
prove that they can be coded using the Sturmian substitutions
σ1 :
#
1 →1,
2 →21,
σ2 :
#
1 →12,
2 →2.
(3.1)
The domain of these substitutions can naturally be extended from {1, 2} to {1, 2}∗
and {1, 2}N by concatenation. The next statement essentially says that balance is
maintained by “desubstitution”.
Lemma 3.2.5 (See e.g. [14, Lemma 4.2]) If a sequence w ∈{1, 2}N is not
balanced, then for each a ∈{1, 2} the sequence σ1(aw) is not balanced.
Proof If w is not balanced it is easy to see that there are words u and v with |u| = |v|
and |u|1 = |v|1 such that 1u1 and 2v2 are factors of w. Since 1u1 occurs in w there
is b ∈{1, 2} such that b1u1 occurs in aw (we need a in case 1u1 is the initial word
of w). As σ1(b) always ends with 1 and σ1(2) begins with 2, the words 11σ1(u)1
and 21σ1(v)2 have the same length and both occur in σ1(aw). As the number of 1s
in these two words clearly differs by 2 the lemma follows.
⊓⊔
Let w = w0w1 . . . ∈{1, 2}N be given. If w is a Sturmian sequence, it contains
exactly three of the four factors 11, 12, 21, 22. Since it clearly contains 12 and 21
as factors, it either doesn’t contain 22, in which case we say that w is of type 1, or
it doesn’t contain 11, in which case we say it is of type 2. Using recurrence one can
easily see that for each Sturmian sequence w ∈{1, 2}N at least one of the sequences
1w and 2w is Sturmian as well. A Sturmian sequence w ∈{1, 2}N is called special
if 1w as well as 2w are both Sturmian sequences. With these notions we get the
following “desubstitution” of Sturmian sequences (see also [22, Section 1] where
an analog of this was proved along somewhat different lines).
Lemma 3.2.6 (See e.g. [14, Proposition 4.3]) Let u be a Sturmian sequence of
type 1.
(i) If u is not special then either u = σ1(v) with v Sturmian, or u = Σσ1(v) with
v Sturmian starting with 2 (but not both).
(ii) If u is special then u = σ1(v1) = Σσ1(v2) where Σv1 = Σv2 is a special
Sturmian sequence.
If u is of type 2 the same statement with the symbols 1 and 2 interchanged holds.

102
J. M. Thuswaldner
Proof Since u is of type 1 it is immediate that it can be written as u = σ1(v) for
some v ∈{1, 2}N.
To prove (i) suppose that u is not special. Then either 1u or 2u is Sturmian, but
not both.
If 1u is Sturmian, 1u = σ1(v′) with v′ starting with 1 and, hence, by Lemma 3.2.5
and Proposition 3.2.4, v = Σv′ is Sturmian, and u = σ1(v). If u starts with 2 then
u ̸= Σσ1(v′) for v′ starting with 2. If u starts with 1 then also v starts with 1. If we
replace the ﬁrst letter of v by 2 this yields a sequence w satisfying u = Σσ1(w).
However, if w is also Sturmian Σv = Σw is special and, hence, one easily checks
that u is special, a contradiction and we are done.
If 2u is Sturmian then 12u has to be Sturmian (since 22 is forbidden) and thus
12u = σ1(1v) with v Sturmian and beginning with 2. Thus u = Σσ1(v). As before,
we can write u = σ1(w) where w is the word obtained from v by replacing the ﬁrst
letter by 1. This leads again to the contradiction of u being special.
To show (ii) assume u is special. Then, as u has to start with 1 the sequences
12u = σ1(12v) and 21u = σ1(21v) are Sturmian (11u cannot be Sturmian for
imbalance reasons, see [82, Proposition 6.1.23]). By Lemma 3.2.5 and Proposi-
tion 3.2.4 the sequences 1v and 2v are Sturmian, so v is special and u = σ1(1v) =
Σσ1(2v).
The proof of the type 2 case is analogous.
⊓⊔
From the proof of Lemma 3.2.6 we see that for a special sequence u of type 1
there exists a special sequence v such that 21u = σ1(21v) and 12u = σ1(12v)
are Sturmian sequences. If u is special of type 2 we get the existence of a special
sequence v with 21u = σ2(21v) and 12u = σ2(12v) Sturmian by analogous
reasoning. If u is a special Sturmian sequence then the two Sturmian sequences
12u and 21u are called limit sequences or ﬁxed sequences. By the above arguments
they can be desubstituted to sequences that are limit sequences as well. This process
can be iterated: let w be a limit sequence. Then there is a sequence (w(n))n≥0 of
limit sequences with
w = w(0)
and
w(n) = σin(w(n+1)) for n ≥0.
This can be rewritten as
w = σi0 ◦· · · ◦σin(w(n+1)).
(3.2)
As w is Sturmian, the sequence (in) ∈{1, 2}N has to change its value inﬁnitely often
because otherwise w would be ultimately constant. Now observe that a sequence
w(n) starting with a letter a results in a sequence w(0) also starting with a. Moreover,
since the sequence (in) changes its value inﬁnitely often we see that the ﬁrst letter of
w(n) determines a preﬁx of w whose length tends to inﬁnity with n. Thus, equipping
{1, 2}N with the product topology of the discrete topology yields
w = lim
n→∞σi0 ◦· · · ◦σin(a),
(3.3)

3
S-adic Sequences
103
where a is the ﬁrst letter of w (note that we slightly abuse notation here: to be exact
the argument of σin should be aa . . . ∈AN since the limit is not deﬁned for ﬁnite
words). We could also group the blocks of the sequence (in). So if it starts with a
block of a0 times the symbol 1 followed by a block of a1 times the symbol 2 and so
on we can rewrite (3.3) as
w = lim
k→∞σ a0
1 ◦σ a1
2 ◦σ a2
1 ◦· · · ◦σ a2k
1
(a).
(3.4)
A sequence w that can be represented by iteratively composing substitutions as in
(3.2) is called an S-adic sequence.
Note that for arbitrary Sturmian sequences a similar coding as in (3.2) is possible,
however, in the general case shifts have to be inserted between the composed
substitutions on the appropriate places according to Lemma 3.2.6. Inserting these
shifts does not change the collection of factors (called language) of the sequence.
Thus each Sturmian sequence w is associated with a sequence (σim) which
determines its language. We call this sequence the coding sequence of w. Summing
up we proved the following proposition.
Proposition 3.2.7 (See [22, Section 1]) Let σ1, σ2 be the Sturmian substitutions.
Then for each Sturmian sequence w there exists a coding sequence σ = (σin),
where (in) takes each symbol in {1, 2} an inﬁnite number of times, such that w has
the same language as
u = lim
n→∞σi0 ◦σi1 ◦· · · ◦σin(a).
Here a ∈{1, 2} can be chosen arbitrarily.
Since it will turn out that (3.3) and (3.4) are nonabelian versions of the classical
continued fraction algorithm we will now review the basics of this well-known
concept.
3.2.2
The Classical Continued Fraction Algorithm
The “S-adic” representations of a Sturmian sequence given in (3.3) and (3.4) are
related to continued fraction expansions of irrational numbers. For this reason we
provide a brief discussion of the classical continued fraction algorithm (see e.g. [76,
Chapter 3] for an introduction to continued fractions of a dynamical ﬂavor or [41]
for a discussion of continued fractions in a context related to the present paper).

104
J. M. Thuswaldner
We start with the well-known additive Euclidean algorithm. Given a pair of two
nonnegative real numbers (a, b) ̸= (0, 0) we deﬁne the mapping F : R2
≥0 \ {0} →
R2
≥0 \ {0} by
F(a, b) =
#
(a −b, b),
if a > b,
(a, b −a),
if a ≤b.
If we iterate this mapping starting with (a, b) ∈R2
>0 we see that we reach a pair of
the form (0, c) or (c, 0) with c > 0 if and only if the ratio a/b is rational. If a/b ̸∈Q
the iterations of F on (a, b) produce an inﬁnite sequence of pairs of strictly positive
numbers. Setting
M1 =
1 1
0 1

and
M2 =
1 0
1 1

(3.5)
we see that F(a, b)t = M−1
1 (a, b)t if a > b and F(a, b)t = M−1
2 (a, b)t if a ≤
b. Thus iterating F on a pair (a, b) with a/b ̸∈Q produces an inﬁnite sequence
(Min)n∈N ∈{M1, M2}N deﬁned by
(a, b)t = Mi0F(a, b)t = Mi0Mi1F 2(a, b)t = Mi0Mi1Mi2F 3(a, b)t = · · · .
(3.6)
This sequence (Min) is called the additive continued fraction expansion of (a, b).
In (3.14) we will see that, up to a scalar factor, (a, b) is determined by the sequence
(in).
Since the sequence (Min) is invariant under the multiplication of (a, b) by a
scalar, we may use projective coordinates. This motivates the following deﬁnition.
Let P be the projective line and X = {[a : b] ∈P : a ≥0, b ≥0}. Deﬁne
M : X →{M1, M2} by M([a : b]) = M1 if a > b and M([a : b]) = M2 if a ≤b.
Then the mapping
F : X →X;
x →M(x)−1x
(3.7)
is called the linear additive continued fraction mapping.
Since (a, b) ̸= (0, 0) we can deﬁne a projective version of (3.7). Indeed, we can
write [a : b] = [1, b/a] if a > b and [a : b] = [a/b, 1] if a ≤b and the mapping F
can be written as (c ∈[0, 1])
F[1 : c] =
#
[1 −c : c] = [ 1−c
c
: 1],
if c > 1
2,
[1 −c : c] = [1 :
c
1−c],
if c ≤1
2,
F[c : 1] =
#
[1 : 1−c
c ],
if c > 1
2,
[ c
1−c : 1],
if c ≤1
2.
(3.8)

3
S-adic Sequences
105
Fig. 3.1 The Farey map
0.2
0.4
0.6
0.8
1.0
0.2
0.4
0.6
0.8
1.0
Since the coordinate 1 contains no information in (3.8) and c ∈[0, 1], this deﬁnes a
mapping f : [0, 1] →[0, 1] by
f (x) =
#
1−x
x ,
if x > 1
2,
x
1−x ,
if x ≤1
2.
The mapping f is called projective additive continued fraction mapping or Farey
map. It is visualized in Fig. 3.1.
The additive continued fraction algorithm can be “accelerated” in the following
way. Assume that a, b > 0 are given. If a > b we do not just subtract b from a.
We subtract it m times where m is chosen in a way that 0 ≤a −mb < b. If a ≤b
we proceed analogously. This results in the multiplicative Euclidean algorithm G :
R2
>0 →R2
≥0 \ {0} with
G(a, b) =
#
(a −⌊a
b⌋b, b),
if a > b,
(a, b −⌊b
a⌋a),
if a ≤b.
As in (3.6), iterating G on a pair (a, b) ∈R2
>0 yields a sequence of matrices
Ma0
1 , Ma1
2 , Ma2
1 , . . . with positive integers a0, a1, . . . satisfying (we assume a > b
here; otherwise the sequence would start with a power of M2)
(a, b)t = Ma0
1 G(a, b)t = Ma0
1 Ma1
2 G2(a, b)t = Ma0
1 Ma1
2 Ma2
1 G3(a, b)t = · · · .
(3.9)
However, contrary to (3.6) this sequence stops if the iteration runs into a vector one
of whose coordinates is 0 because G is not deﬁned for such vectors. Indeed, as can
easily be veriﬁed, we run into such a vector if and only if a/b ∈Q.

106
J. M. Thuswaldner
Again we move to the projective line and set X = {[a : b] ∈P : a > 0, b > 0}.
Deﬁne M : X →{Mm
1 , Mm
2
: m ≥1} by M([a : b]) = Mm
1 if a > b and
0 ≤a −mb < b and M([a : b]) = Mm
2 if a ≤b and 0 ≤b −ma < b. Then the
mapping
G : X →X;
x →M(x)−1x
(3.10)
is called the linear multiplicative continued fraction mapping.
Similar to the additive case assume that a, b > 0 and choose the representatives
[a : b] = [1, b/a] if a > b and [a : b] = [a/b, 1] if a ≤b. The mapping G can
then be written as (c ∈(0, 1])
G[1 : c] = [1 −⌊1
c⌋c : c] = [{ 1
c}c : c] = [{ 1
c} : 1],
G[c : 1] = [1 : { 1
c}].
(3.11)
As the coordinate 1 contains no information in (3.11) this deﬁnes a mapping g :
(0, 1] →[0, 1) by
g(x) =
1
x

.
(3.12)
The mapping g is called projective multiplicative continued fraction mapping or
Gauss map. It is visualized in Fig. 3.2.
By direct calculation (see e.g. [76, Chapter 3]) it follows from the deﬁnition
that for each irrational x ∈(0, 1) the Gauss map g can be iterated inﬁnitely often.
This iteration process determines a sequence (an) of positive integers deﬁned by
Fig. 3.2 The Gauss map
x →{ 1
x }
0.0
0.2
0.4
0.6
0.8
1.0
0.2
0.4
0.6
0.8
1.0

3
S-adic Sequences
107
an =
&
1
gn(x)
'
which admits to develop x in its (multiplicative) continued fraction
expansion
x =
1
a0 +
1
a1 +
1
a2 +
1
a3 + ...
(which will be denoted by x = [a0, a1, . . .]). By deﬁnition this is the same sequence
(an) as the one we obtain in the exponents of the matrices in (3.9) when setting
(a, b) = (1, x). One can show that this sequence is ultimately periodic if and only
if x is a quadratic irrational. If x is rational one can associate a ﬁnite sequence with
x in this way.
Continued fractions play an eminent role in Diophantine approximation. It is
therefore of special interest that they will appear in our theory of Sturmian sequences
naturally without being presupposed.
3.2.3
Dynamical Properties of Sturmian Sequences
We want to have a look at the “abelianized” version of (3.3) and (3.4) in order to get
a link between Sturmian sequences and the classical continued fraction algorithm.
For a word v ∈{1, 2}∗deﬁne the abelianization l(v) = (|v|1, |v|2)t, and for
i ∈{1, 2} associate to the Sturmian substitution σi from (3.1) the incidence matrix
Mi = (|σi(k)|j)1≤j,k≤2. Then M1 and M2 are the matrices deﬁned in (3.5) which
were used to deﬁne the linear version of the classical additive continued fraction
algorithm in (3.7). Indeed, since lσi(v) = Mil(v) we see that the vectors (here
e1, e2 are the standard basis vectors)
Mi0 · · · Minea
(3.13)
form an abelianized version of the expression in the limit of (3.3). Since (in) changes
its value inﬁnitely often, MinMin+1 is a positive matrix for inﬁnitely many n (in
particular, MinMin+1 = M1M2 for inﬁnitely many n; we therefore call the whole
sequence (Min) a primitive sequence of matrices). This property entails that the
positive cone R2
≥0 is shrunk to a line by these matrices, more precisely, there exists
a vector u ∈R2
>0 such that

n≥0
Mi0 · · · MinR2
≥0 = R+u
(3.14)

108
J. M. Thuswaldner
(see [84, pp. 91–95], [125, Chapter 26], or Proposition 3.5.5 below). This says that
the additive continued fraction algorithm deﬁned by (3.6) is weakly convergent (as
is well known, this algorithm is even strongly convergent which is related to the
balance property of Sturmian sequences). We call u, which is uniquely deﬁned up
to scalar factors by the sequence (Min), a generalized right eigenvector of (Min).
We also see from (3.14) that the vector (a, b)t in (3.6) is deﬁned by the sequence
(Min) up to a scalar factor.
We go back to the (nonabelian) S-adic setting. Assume that a Sturmian sequence
w = w0w1 . . . has a coding sequence (σin) whose associated sequence of incidence
matrices (Min) satisﬁes (3.14). We will now prove that in this case w has uniform
letter frequencies, i.e., the limit
fi(w) = lim
ℓ→∞
|wk . . . wk+ℓ−1|i
ℓ
exists uniformly in k for each i ∈{1, 2}. We get even more, namely, the following
lemma holds. In its proof and in all the remaining part of this section we use the
abbreviations
σi[m,n) = σim ◦· · · ◦σin−1
and
Mi[m,n) = Mim · · · Min−1.
Lemma 3.2.8 Let w = w0w1 . . . be a Sturmian sequence with coding sequence
(σin) whose associated sequence of incidence matrices (Min) has a generalized right
eigenvector u. Then w has uniform letter frequencies and (f1(w), f2(w))t =
u
∥u∥1 .
Proof Let u/∥u∥1 = (u1, u2)t. By Proposition 3.2.7 for all k, ℓ, n ∈N we can
write
wk . . . wk+ℓ−1 = pσi[0,n)(v)s
for some p, v, s ∈{1, 2}∗, where the lengths of p, s are bounded by the number
max{|σi[0,n)(1)|, |σi[0,n)(2)|}.
Now, for each a ∈{1, 2} we have the inequality

|wk . . . wk+ℓ−1|a
ℓ
−ua
 ≤
|p|a −|p|ua

ℓ
+
|σi[0,n)(v)|a −|σi[0,n)(v)|ua

ℓ
+
|s|a −|s|ua

ℓ
.
(3.15)
By the convergence of the positive cone to u in (3.14) we know that
|σi[0,n)(b)|a/|σi[0,n)(b)| is close to ua for all a, b ∈{1, 2} if n is large. Thus for
each ε > 0 there is N ∈N such that whenever ℓ≥N we can choose n in a way
that |p|, |s| ≤εℓand
|σi[0,n)(b)|a −|σi[0,n)(b)|ua
 < ε|σi[0,n)(b)| for all letters a
and b. This proves that the right hand side of (3.15) is bounded by 3ε and thus
limℓ→∞|wk . . . wk+ℓ−1|a/ℓ= ua uniformly in k.
⊓⊔

3
S-adic Sequences
109
For a proof of Lemma 3.2.8 along similar lines in a more general setting we
refer to Lemma 3.5.10 (see also Berthé and Delecroix [44, Theorem 5.7]; a proof
using balance, which also gives irrationality of the frequencies, is contained in [82,
Proposition 6.1.10]).
In the same way as for letters, we can deﬁne uniform frequencies for factors of an
inﬁnite sequence w ∈{1, 2}N. Let w be a Sturmian sequence with coding sequence
(σin). The sequence is the shifted image of another Sturmian sequence under an
arbitrary large block σi[0,n) of substitutions. This enables one to show that for the
words σi[0,n)(a) there exist uniform frequencies in w. Since (in) changes its value
inﬁnitely often, the length of the words σi[0,n)(a) tends to inﬁnity for each letter a
if n →∞. Using this fact one can prove the following result along similar lines as
Lemma 3.2.8 (for details we refer to the proof of Lemma 3.5.10 below; see also [44,
Theorem 5.7]).
Lemma 3.2.9 Let w = w0w1 . . . ∈{1, 2}N be a Sturmian sequence with coding
sequence (σin) whose associated sequence of incidence matrices (Min) has a gen-
eralized right eigenvector u. Let v ∈{1, 2}∗be given, and let |wkwk+1 . . . wk+ℓ−1|v
be the number of occurrences of the factor v in the factor wkwk+1 . . . wk+ℓ−1 of w.
Then |wkwk+1 . . . wk+ℓ−1|v/ℓtends to a limit fv(w) for ℓ→∞uniformly in k.
We can associate a dynamical system with a Sturmian sequence w in a very
natural way. Let Xw = {Σkw : k ∈N} be the closure of the shift orbit of w.
Alternatively, Xw can be viewed as the set of all sequences u whose language
L(u) (i.e., its set of factors) satisﬁes L(u) ⊆L(w). Thus if σ = (σin) is the
coding sequence of w, Proposition 3.2.7 implies that Xw contains all Sturmian
sequences with coding sequence σ. Since Xw is shift invariant the shift Σ acts on
Xw and the dynamical system (Xw, Σ) is well deﬁned. We call (Xw, Σ) a Sturmian
system. From what we know about Sturmian sequences we can derive a number
of properties for these dynamical systems. The notions of minimality and unique
ergodicity of a dynamical system used in the following lemma are deﬁned precisely
in Deﬁnitions 3.5.2 and 3.5.7, respectively.
Proposition 3.2.10 A Sturmian system (Xw, Σ) has the following properties.
(i) The system (Xw, Σ) is minimal.
(ii) The set Xw is the set of all Sturmian sequences having the same language.
(iii) The set Xw is the set of all Sturmian sequences having the same coding
sequence σ.
(iv) The system (Xw, Σ) is uniquely ergodic.
(v) We have Xw = Xw′ for any w′ ∈Xw.
Proof Let (σin) be the coding sequence of w with (Min) being the associated
sequence of matrices.
We start with (i). By Proposition 3.2.7 we may assume w.l.o.g. that w =
limn→∞σi[0,n)(1). Let v ∈Xw be given. To prove minimality it sufﬁces to show
that L(v) = L(w). Since L(v) ⊆L(w) is true by deﬁnition we need to prove
the reverse inclusion. Let u ∈L(w). By the deﬁnition of w and the primitivity

110
J. M. Thuswaldner
of the sequence (Min) there is m ∈N such that u occurs in σi[0,m)(1). However,
there is a Sturmian word w(m) satisfying w = σi[0,m)(w(m)). Since w(m) is balanced
by Proposition 3.2.4, the letter 1 occurs in w(m) with bounded gaps. This implies
that σi[0,m)(1) and, hence, u occurs in w with bounded gaps. Thus u occurs in each
element of the orbit closure Xw of w, hence, also in v. Thus L(v) = L(w) is
established.
Since L(v) = L(w) holds for each v ∈Xw according to the previous paragraph
we have pv(n) = pw(n) = n + 1 for all n ∈N, hence, v is Sturmian with the same
language as w. This proves (ii).
To prove (iii) we follow the proof of [82, Lemma 6.3.12]. Assume w.l.o.g. that the
elements of Xw are of type 1 and let u, u′ ∈Xw. Then according to Lemma 3.2.6
there exist Sturmian words v, v′ such that u = σ1(v) or u = Σσ1(v) as well as
u′ = σ1(v′) or u′ = Σσ1(v′). We ﬁrst prove that v, v′ belong to the same Sturmian
system. By (ii) we have to show that L(v) = L(v′). Suppose that x ∈L(v). Since x
occurs inﬁnitely often in v by recurrence, there is y ∈L(v) starting with the letter
2 such that x is a subword of y. The word σ1(y) occurs in u and by (ii) it occurs
also in u′ and because σ1(y) begins with 2 and ends with 1 it can be desubstituted
in only one way by σ1, namely to y. This proves that y and, hence, also x occurs in
v′. Thus L(v) ⊆L(v′). The other inclusion follows by interchanging the roles of v
and v′. Iterating this argument yields that u and u′ have the same coding sequence.
Thus all elements of Xw have the same coding sequence. As Sturmian sequences
with the same coding sequence have the same language by Proposition 3.2.7, Xw
contains all Sturmian sequences having the same coding sequence as w.
Item (iv) follows immediately by combining Lemma 3.2.9 with [82, Proposi-
tion 5.1.21] (see also Proposition 3.5.9 below) which states that the existence of
uniform word frequencies implies unique ergodicity. Alternatively, one can use
Boshernitzan [56].
Finally, (v) follows from (ii).
⊓⊔
We emphasize on the fact that for minimality and unique ergodicity of (Xw, Σ)
the recurrence of w as well as the primitivity of the sequence (Min) is of importance.
This will be the same in the general case (see Sect. 3.5 below). In view of assertion
(iii) of the previous lemma we will write Xσ instead of Xw, where σ is the coding
sequence of w.
3.2.4
Sturmian Sequences Code Rotations
It was observed already by Morse and Hedlund [107] and Coven and Hedlund [67]
that each Sturmian sequence is a natural coding of a rotation by some irrational
number α. We now sketch a proof of this fact which goes back to Rauzy and in which
the multiplicative continued fraction expansion of α pops up when we represent such
a coding in an S-adic fashion. For proofs of this kind we refer to [13, 14, 46, 47]; a

3
S-adic Sequences
111
Fig. 3.3 Two iterations of
the irrational rotation Rα on
T which is subdivided into
the two intervals I1 and I2
x
x
2
R
x
0
I1
I2
R
different, combinatorial proof along the lines of the original proof by Morse, Coven,
and Hedlund is presented in [101, Theorem 2.1.13] and [6, Section 10.5].
Before we give the main result of this section we provide some deﬁnitions. Let
T be the 1-torus, i.e., the unit interval [0, 1] with its end points glued together. A
rotation or translation on T by a real number α is a mapping Rα : T →T with
x →x + α (mod 1). If α ̸∈Q this gives a minimal dynamical system. Moreover,
observe that Rα can be regarded as a two interval exchange of the intervals I1 =
[0, 1−α) and I2 = [1−α, 1) or of the intervals I ′
1 = (0, 1−α] and I ′
2 = (1−α, 1],
see Fig. 3.3. We say that a sequence w = w0w1 . . . ∈{1, 2}N is a natural coding of
Rα if there is x ∈T such that Rk
α(x) ∈Iwk for each k ∈N or Rk
α(x) ∈I ′
wk for each
k ∈N.
Theorem 3.2.11 A sequence w ∈{1, 2}N is Sturmian if and only if there exists
α ∈R \ Q such that w is a natural coding of the rotation Rα.
The sufﬁciency part of the theorem is easy. Indeed, it just follows from the
observation that
v0 . . . vn−1 is a factor of a natural coding of Rα
⇐⇒
n−1

k=0
R−k
α Ivk ̸= ∅,
(3.16)
whose proof is an easy exercise (see [46, Lemma 2.7]).
The proof of the necessity part of Theorem 3.2.11 needs more work and we will
see that the classical continued fraction algorithm pops up along the way without
being presupposed. We need the following key lemma.
Lemma 3.2.12 For α ∈(0, 1) irrational let u be the coding of the point 1 −
α/(α + 1) under the irrational rotation Rα/(α+1). Then there is a sequence (σin)
of substitutions such that
u = lim
n→∞σi0 ◦· · · ◦σin(2).

112
J. M. Thuswaldner
The sequence (in) ∈{1, 2}N is of the form 1a02a11a22a3 . . . where the sequence
[a0, a1, a2, a3, . . .] is the continued fraction expansion of α. For α > 1 a similar
result with switched symbols holds.
Proof We assume α < 1 (α > 1 can be treated in a similar way). For computational
reasons consider the rotation R by α on the interval J = [−1, α) with the partition
P1 = [−1, 0) and P2 = [0, α). The natural coding u of 1 −α/(α + 1) by Rα/(α+1)
is the natural coding of 0 by R. Let R′ be the ﬁrst return map of R to the interval
J ′ =
(
α
& 1
α
'
−1, α

. Let v be a coding of the orbit of 0 for R′. As can be seen from
Fig. 3.4, after each occurrence of 2 in u we leave the interval J ′ and there follows
a block of 1s of length
)
1
α
*
before we enter the interval J ′ again. Thus v emerges
from u by removing such a block of 1s after each letter 2 occurring in u. By the
deﬁnition of σ1 this just means that u = σ ⌊1/α⌋
1
(v). We can now renormalize the
interval J ′ by dividing it by −α and, as illustrated in Fig. 3.4, then R′ is conjugate
to a rotation (called R′ again) by

1
α

on the interval

−1,
 1
α
+
, where v is the
natural coding of the partition P ′
2 = (−1, 0] and P ′
1 =

0,
 1
α
+
. Note that the
Gauss map α →

1
α

from (3.12) comes up here without being presupposed. Since
we are in the same setting as before (just with the letters 1 and 2 interchanged), we
P2
P1
0
R 0
R2
R
R'
3
1
1
1
0
R'
1
1
1
P1
P2
'
'
0
0
0
0
Fig. 3.4 The rotation R′ induced by R

3
S-adic Sequences
113
can iterate this process and thereby obtain a sequence (u(n))n≥0 of natural codings
such that
u = u(0)
and
u(n) = σin(u(n+1)) for n ≥0
for some sequence (σin) with (in) ∈{1, 2}N having inﬁnitely many changes between
the letters 1 and 2. Arguing in the same way as in Sect. 3.2.1 we gain that
u = lim
n→∞σi0 ◦· · · ◦σin(a)
where a = 2 is the ﬁrst letter of u. The assertion on the continued fraction expansion
follows from the above proof as well. Just note that the interval we use has length
α + 1 so that the rotation by α on this interval is conjugate to Rα/(α+1).
⊓⊔
Proof (Conclusion of the Proof of Theorem 3.2.11) The sufﬁciency assertion has
been treated in (3.16). The necessity part of the theorem can now be obtained as
follows. Let w be a Sturmian sequence. Consider its coding sequence (σin) and
write (in) ∈{1, 2}N as 1a02a11a22a3 . . . Then u = limn→∞σi0 ◦· · · ◦σin(2) is a
natural coding of Rα/(1+α) where α = [a0, a1, a2, . . .]. By Proposition 3.2.7 the
sequence w has the same language as u and (3.16) together with an approximation
argument implies that w is a natural coding of Rα/(1+α) (it is easy to verify that there
are limit cases where we really need the intervals I ′
1, I ′
2 to deﬁne the natural coding
for w).
⊓⊔
The fact that Sturmian sequences have irrational uniform letter frequencies is
an immediate consequence of Theorem 3.2.11. Moreover, we have the following
corollary of Theorem 3.2.11 for Sturmian systems.
Corollary 3.2.13 A Sturmian system (Xσ, Σ, μ) is measurably conjugate to an
irrational rotation (T, Rα, λ). Here μ is the unique Σ-invariant measure on Xσ
and λ is the Haar measure on T.
Proof Let ϕ : Xσ →T be deﬁned by ϕ(w0w1 . . .) = x if Rk
α(x) ∈Iwk for each
k ∈N or Rk
α(x) ∈I ′
wk for each k ∈N. Using Theorem 3.2.11 and the minimality of
Rα it is easy to check that this is well deﬁned. Surjectivity of ϕ follows immediately
from Theorem 3.2.11. To investigate injectivity let u = u0u1 . . . and v = v0v1 . . .
be distinct elements of Xσ with ϕ(u) = ϕ(v). By the minimality of Rα this is only
possible if the orbit of ϕ(u) passes through 0 and u is naturally coded by I1, I2 while
v is naturally coded by I ′
1, I ′
2 (or vice versa).1 Since the set of such elements u and
v is countable, ϕ is bijective everywhere save for a countable set. Moreover, ϕ is
easily seen to be continuous and ϕ ◦Σ = Rα ◦ϕ holds by the deﬁnition of ϕ. This
implies the result.
⊓⊔
1This implies that u and v have Σx and Σy in their orbit where x and y are the two limit sequences
of σ. This interesting fact, which is not needed in this proof, should be proved by the reader.

114
J. M. Thuswaldner
We illustrate the concepts of this section by a classical example.
Example 3.2.14 (A Variant of the Fibonacci Sequence) Let σ be given by
σ = σ1 ◦σ2 :
#
1 →121,
2 →21.
This is a reordering of the square of the well-known Fibonacci substitution (which
is deﬁned by 1 →12, 2 →1; see for instance in [82, Section 1.2.1]). Consider the
coding sequence σ = (σ). In this case the associated limit sequences are “purely
substitutive”. One of the two limit sequences is
w = lim
n→∞σ n(2) = 21121121211211212112121121121 . . .
Since only one substitution plays a role here, the associated “S-adic” system
(Xσ, Σ) is called a substitutive system. Let ϕ = 1+
√
5
2
. By the Perron-Frobenius
theorem the generalized right eigenvector u of the sequence of incidence matrices
M of σ is the eigenvector (ϕ, 1)t corresponding to the dominant eigenvalue ϕ2 of
the incidence matrix of σ. Let L be the eigenline deﬁned by this eigenvector. Being
a Sturmian sequence, w is balanced by Proposition 3.2.4 and has uniform letter
frequencies (f1(w), f2(w))t =
1
1+ϕ (ϕ, 1)t by Lemma 3.2.8. This is reﬂected by the
fact that the “broken line”
B = {l(p) : p is a preﬁx of w}
(3.17)
associated with the sequence w stays at bounded distance from the eigenline L (see
Fig. 3.5).
Because w = limn→∞σ n(2) = limn→∞(σ1 ◦σ2)n(2), it has coding sequence
σ1, σ2, σ1, σ2, . . . Since the “run lengths” of σi in this sequence are always equal
to 1 we set α = [1, 1, 1, . . .] = ϕ−1 and, hence, α/(α + 1) = ϕ−2. Thus from
Theorem 3.2.11 and its proof we see that w is a natural coding of the rotation by ϕ−2
of the point 1−α/(α+1) = ϕ−1 ∈[0, 1) with respect to the partition I1 = [0, ϕ−1),
I2 = [ϕ−1, 1) (or the according partition I ′
1, I ′
2) of [0, 1). This gives us an easy way
to construct w (and the broken line B). Indeed, start at the origin, write out 2 and go
up to the lattice point (0, 1)t. After that, inductively proceed as follows: whenever
the current lattice point is above L, write out 1 and go right to the next lattice point
by adding the vector (1, 0)t and whenever the current lattice point is below L, write
out 2 and go up to the next lattice point by adding the vector (0, 1)t.2
Let π be the projection along L to the line L⊥orthogonal to L. If we project all
points on the broken line and take the closure of the image, due to the irrationality
2We could also have started with writing out 1 and going to the right from the origin. This would
have produced the second limit sequence of (σ) which coincides with w save for the ﬁrst two
letters.

3
S-adic Sequences
115
2
1
1
2
1
1
2
1
2
1
1
L
R
Fig. 3.5 The broken line and its projection to the Rauzy fractal
of u we obtain the interval
Ru = {πl(p) : p is a preﬁx of w}
on L⊥(the subscript u indicates that Ru lives in the space L⊥= u⊥orthogonal to
u which is an arbitrary choice; other choices will play a roll in subsequent sections).
We color the part of the interval for which we write out 1 at the associated lattice
point light grey, the other part dark grey. This subdivides the interval Ru into two
subintervals Ru(1) and Ru(2), where
Ru(i) = {πl(p) : pi is a preﬁx of w}
(i = 1, 2).
Moreover, we see that moving a step along the broken line amounts to exchanging
these two intervals in the projection: points in Ru(1) are moved downwards by a
ﬁxed vector, while points in Ru(2) are moved upwards by a ﬁxed vector.
Thus passing along the broken line each step amounts to exchanging the intervals
Ru(1) and Ru(2) in the projection. If we identify the end points of Ru this interval
exchange becomes a rotation. This is the rotation which is coded by the Sturmian
sequence w. The union Ru = Ru(1) ∪Ru(2) is called the Rauzy fractal associated
with the substitution σ (or with the sequence σ = (σ)). The reason why we speak
about fractals here will become apparent in Sect. 3.6.1 when we deﬁne the analogs
of Ru in a more general setting.
Suppose we would be given an arbitrary sequence w ∈{1, 2}N with letter
frequency vector u whose broken line stays within bounded distance of the line
L = R+u. Then we could draw a similar picture as in Fig. 3.5. However, although
the projection π would project the vertices of the associated broken line to a
bounded set, there is no reason for its closure Ru to be an interval. Also, if we

116
J. M. Thuswaldner
use two colors as in the example above, it may well happen that the two sets Ru(1)
and Ru(2) have considerable overlap. This bad behavior prevents us from seeing a
rotation in the projections.
Making sure that the closure of the projection of the broken line behaves
topologically well and allows a partition whose atoms are essentially different will
be our main concern when we establish a theory of S-adic sequences that are codings
of rotations on higher dimensional tori in the subsequent sections and, hence, give
rise to dynamical systems that are measurably conjugate to torus rotations.
3.2.5
Natural Extensions and the Geodesic Flow
on SL2(Z) \ SL2(R)
In this section we talk about natural extensions of the Gauss map and of the coding
map of Sturmian sequences by substitutions. Moreover, we show how to relate these
natural extensions to the geodesic ﬂow on the space SL2(Z)\SL2(R) of unimodular
two-dimensional lattices.
So far we could relate Sturmian sequences to rotations on the circle by using
the classical continued fraction algorithm. In our discussion we coded a Sturmian
sequence w by a sequence of substitutions (σin) as
w = lim
k→∞σ a0
1 ◦σ a1
2 ◦σ a2
1 ◦· · · ◦σ a2k
1
(a)
(see (3.4)). In the induction process used in the proof of Theorem 3.2.11 we recoded
w by a “desubstitution” process. If we look at the ﬁrst step of this process we
produce the sequence
u = lim
k→∞σ a1
2 ◦σ a2
1 ◦· · · ◦σ a2k
1
(a).
However, the mapping w →u cannot be inverted since it is not possible to
reconstruct a0 from u. Similarly, the Gauss map g cannot be inverted since
g([a0, a1, . . .]) = [a1, a2, . . .], and a0 cannot be reconstructed from the image
[a1, a2, . . .].
In this section we want to make both of these mappings bijective by constructing
a geometric model for their natural extensions (in the sense of Rohlin [116]). To
this matter we look again at the induction used in Lemma 3.2.12 which is visualized
once more in Fig. 3.6a. In this ﬁgure we see why this induction process cannot
be reversed: the intervals [R(0), R2(0)) and [R2(0), R3(0)) get lost during the
induction process and cannot be reconstructed.
A ﬁrst idea on how to mend this is indicated in Fig. 3.6b: one could “stack” the
lost intervals on the larger interval of the induced rotation. This would keep the
information of the last induction step. However, acting in this way we can go back
at most to the setting from which we started but not farther to the “past”.

3
S-adic Sequences
117
(a)
(b)
Fig. 3.6 (a) Induction without restacking loses some part of the information. The intervals
[R(0), R2(0)) and [R2(0), R3(0)) depicted in light gray are no longer present in the induced
rotation. (b) Induction together with restacking the intervals keeps all the information. The light
gray intervals [R(0), R2(0)) and [R2(0), R3(0)) are stacked on the longer interval of the induced
rotation
To make the induction process bijective, it is more convenientto build rectangular
boxes above the intervals as indicated in Fig. 3.7 (this approach is extensively
exploited in Arnoux and Fisher [14]; we follow here [82, Section 6.6]). The lengths
of the boxes are given by the intervals on which the induction process starts: one
box is of length 1, the other one has length α for some α ∈(0, 1) \ Q. The heights
are chosen in a way that the longer rectangle is also the higher one and that the
total area of the two rectangles is equal to one. The induction process can now be
performed on the rectangles as indicated in Fig. 3.7: let a × d be the size of the left
rectangle and b × c the size of the right one. Slice the larger rectangle by vertical

118
J. M. Thuswaldner
restack
renormalize
Fig. 3.7 Step 1: restack the boxes. Step 2: renormalize in a way that the larger box has length 1
again
cuts into pieces of lengths equal to b until a slice of length less than b remains. Then
stack all slices of length b on the smaller rectangle. The result can be seen in the
middle of Fig. 3.7. After that renormalize the resulting pair of rectangles (as we did
in the induction process on the intervals) by making it “thinner” and “longer” in a
way that the length of the larger rectangle is equal to 1 again and the area of the
whole region remains 1.
Call the resulting mapping on the rectangles Ψ . A priori, the mapping Ψ is a
mapping from a subset of R4 to a subset of R4. However, since ad + bc = 1 and
max{a, b} = 1, we can eliminate two coordinates and we are left with a mapping in
two variables.
We make this precise in the following deﬁnition.
Deﬁnition 3.2.15 (Natural Extension of the Gauss Map, see [14]) Let Δm be the
set of pairs (a × d, b × c) of rectangles of total area 1 such that the widest one is
the highest one (i.e., a > b ⇔d > c) and such that the width of the widest one
is equal to 1 (i.e., max{a, b} = 1). Let Δm,0 be the subset of Δm with a = 1, and
Δm,1 the subset of Δm with b = 1.
The mapping Ψ is deﬁned on Δm,1 as
(a, d) →
 1
a

, a −da2
,
and similarly on Δm,0. It is called the natural extension of the Gauss map (which is
seen in the ﬁrst coordinate).
Remark 3.2.16 The subscript “m” stands for multiplicative since we work here
with the multiplicative version of the classical continued fraction algorithm deﬁned
by the Gauss map. An analogous theory exists for the additive algorithm as well,
see [14].
The mapping Ψ is bijective as becomes clear from its geometric interpretation.
Moreover, it is easy to show that Ψ preserves the Lebesgue measure. By integrating
away the second coordinate one can show that the invariant measure of the Gauss

3
S-adic Sequences
119
map is
dx
ln2(1+x) (see e.g. [76, Chapter 3]). We mention that another natural extension
of the Gauss map deﬁned on the unit square is provided in [108].
We can also see Sturmian sequences in the rectangular boxes. To this end note
ﬁrst that a pair of boxes a × d and b × c is a fundamental domain of the lattice
spanned by the vectors (a, c)t and (−b, d)t. This is illustrated in Fig. 3.8 and has
the consequence that the “L-shaped” region formed by this pair of boxes can be used
to tile the plane with respect to this lattice as indicated in Fig. 3.9.
Let us mark a point in this tiling. If we start from this point and move upwards
and write out 1 whenever we pass through a large rectangle, and 2, whenever we pass
through a small one, we get the coding u of a rotation by α on the interval (−1, α)
which, by Theorem 3.2.11, is a Sturmian sequence. This is indicated in Fig. 3.9. In
the same way we can produce a Sturmian sequence v by moving horizontally.
If we restack each of the fundamental domains, according to the procedure
described above, we get a new fundamental domain (indicated by the shaded region
in Fig. 3.9). We now code the same vertical line using this restacked region. Doing
this we obtain another Sturmian sequence u(1) which, by the deﬁnition of the
restacking process, satisﬁes u = σ(u(1)), where σ is the substitution deﬁning the
induction process as in the proof of Lemma 3.2.12. On the other hand, looking at the
Fig. 3.8 A pair of boxes is a
fundamental domain of a
lattice
b
d
a
c
Fig. 3.9 The vertical line is
coded by a Sturmian
sequence u, the horizontal
line by a Sturmian sequence
v. The restacking procedure
desubstitutes u and
substitutes v. The shaded
region is a restacked
fundamental domain
u
v

120
J. M. Thuswaldner
horizontal line we get v(−1) = σ(v) as the new coding. Thus the restacking process
corresponds to the mapping
(u, v) →(u(1), v(−1)).
As mentioned at the beginning of this section, we cannot reconstruct u from u(1),
however we can reconstruct (u, v) from (u(1), v(−1)) since the type of the Sturmian
sequence v(−1) tells us (which power of) which of the two substitutions σ1, σ2 from
(3.1) we have to use to get back. This makes the coding process bijective as well.
We could mark the pair of rectangles discussed above by a point (x, y) and look at
the itinerary of this point under the restacking process. This would give an extension
˜Ψ of the mapping Ψ that is deﬁned on the T2-ﬁbers over Δm (see [14]).
The following remark is of particular importance.
Remark 3.2.17 Regardless of the point in the “L-shaped” region in which we start,
the “vertical” Sturmian sequence will always be contained in the same Sturmian
system. Thus we can say that the “L-shaped” pairs of rectangles parametrize the
Sturmian systems (which are characterized by their coding sequence according to
Proposition 3.2.10(iii)), while the (x-coordinates of the) points in a given region
parametrize the sequences contained in this system. The same is true for the
“vertical” Sturmian sequence w.r.t. the y-coordinates.
We also mention that the vertical line producing the coding u can also be
extended downwards. This yields a sequence ˜u ∈AZ as a coding. Such a sequence
is an example of a bi-inﬁnite Sturmian sequence (the same can be done in the
horizontal direction). Bi-inﬁnite Sturmian sequences are studied for instance in [82,
Section 6.2]. It turns out that some of their properties are nicer than in our one-sided
case since one no longer has troubles coming from “the beginning” of the sequences.
Artin [26] observed that the continued fraction algorithm can be viewed as a
Poincaré section of the geodesic ﬂow on the unit tangent bundle SL2(Z) \ SL2(R)
of the modular surface SL2(Z) \ H. In the meantime this correspondence between
the continued fraction algorithm and the geodesic ﬂow was studied by many
authors (see e.g. Series [121]) and discussed in connection with our setting by
Arnoux [10] and later by Arnoux and Fisher [14]. The necessary details on the
modular surface and its unit tangent bundle including an explanation why the ﬂow
diag(et, e−t) which will come up below is a geodesic ﬂow on the homogeneous
space SL2(Z) \ SL2(R) can be found for instance in [10] or [76, Chapter 9].
We now explain brieﬂy how the geodesic ﬂow on SL2(Z) \ SL2(R) enters our
model. We have to restack the rectangles as above and then renormalize the lattice
again. This can be done also in the following way. First multiply the basis of the
lattice from the right by diag(et, e−t) for t varying from 0 to the threshold value for
which the width of the smallest rectangle equals 1. Then restack as above to end
up at a pair of rectangles whose larger rectangle has width 1. Altogether, starting
from a pair of rectangles drawn on the left hand side of Fig. 3.7 we ended up with a

3
S-adic Sequences
121
pair drawn on its right side. We just did the renormalization smoothly and we did it
before the restacking instead of after it.
What we do can be explained more precisely as follows:
•
Deﬁne the set
Ωm =Ωm,0 ∪Ωm,1
=

M =
 a c
−b d

: 0 < a < 1 ≤c, 0 < d < b, ad + bc = 1

∪

M =
 a c
−b d

: 0 < c < 1 ≤a, 0 < b < d, ad + bc = 1

.
One can show that a.e. lattice has exactly one basis made of row vectors of a
matrix in Ωm (see [10]). Thus Ωm is a (measure theoretic) fundamental domain
for the action of SL2(Z) on SL2(R).
•
Start with a lattice, associate with it a basis taken from Ωm.
•
Hit this lattice (together with the chosen basis) with the geodesic ﬂow
diag(et, e−t), t ≥0.
•
For increasing t this will eventually deform the basis in a way that the width
of the smaller rectangle gets equal to 1 (and we would leave Ωm when
deforming this basis further). If we restack at this point we end up with a pair
of rectangles contained in the Poincaré section Δm: indeed, after restacking the
larger rectangle will have width 1.
•
Change the basis of the lattice to the basis corresponding to the new pair of
rectangles according to Fig. 3.8. Note that restacking does not change the lattice,
so the geodesic ﬂow, which acts on SL2(Z) \ SL2(R), is not affected by this base
change. However, this restacking has the effect that it creates a new basis of the
lattice that remains inside Ωm when it gets further deformed by the action of the
ﬂow. Thus we can repeat the procedure.
•
Repeating this procedure, the geodesic ﬂow yields a sequence of restackings:
any time the width of the smaller rectangle gets equal to 1 by restacking, the
according basis gets inside the Poincaré section Δm. This restacking performs
one step of the natural extension of the Gauss map.
•
Thus the geodesic ﬂow on SL2(Z) \ SL2(R) can be regarded as a so-called
suspension ﬂow of the natural extension of the Gauss map.
This viewpoint has many advantages and one can prove results on continued
fractions using the well-developed theory of the geodesic ﬂow on SL2(Z)\SL2(R).
The same procedure can also be performed for pointed pairs of rectangles (which
we needed to study Sturmian sequences, see Fig. 3.9). This has the effect that the
geodesic ﬂow on SL2(Z) \ SL2(R) has to be replaced by the so-called scenery ﬂow
which also takes care of the distinguished point in the “L-shaped” region. All this is
described in detail in [14].

122
J. M. Thuswaldner
We mention that similar results have been obtained for variants of the classical
continued fraction algorithm. For instance, Arnoux and Schmidt [23, 24] proved
that the α-continued fraction algorithm, Rosen’s continued fraction algorithm as
well as Veech’s continued fraction algorithm can be viewed as Poincaré sections of
a geodesic ﬂow. The material presented in this section also forms an easy case of the
wide and appealing ﬁeld of interval exchange transformations and their dynamics
(see e.g. Viana [125] for a survey).
3.3
Problems with the Generalization to Higher Dimensions
According to Cassaigne et al. [63] it was conjectured since the beginning of the
1990s that the beautiful correspondence between Sturmian sequences, continued
fractions, and irrational rotations on the circle described in Sect. 3.2 can be
extended to higher dimensions. The same paper gives strong indications towards
the wrongness of this conjecture. Indeed, in [63] Arnoux-Rauzy sequences over
a three letter alphabet that are not balanced and that cannot be viewed as natural
codings of rotations on the two dimensional torus with ﬁnite fundamental domain
are constructed. It is the objective of the present section to explain their work and
to give an account on further results by Cassaigne et al. [62] concerning weakly
mixing Arnoux-Rauzy systems as well as Arnoux-Rauzy systems with nontrivial
eigenvalues.
3.3.1
Arnoux-Rauzy Sequences
In an attempt to pave the way for a generalization to higher dimensions of
the correspondence between combinatorics, arithmetics, and dynamical systems
outlined in Sect. 3.2, Arnoux and Rauzy [22] deﬁned sequences over the alphabet
{1, 2, 3} whose properties are inspired by Sturmian sequences.
In the following deﬁnition a right special factor of a sequence w ∈{1, 2, 3}N is
a factor v of w for which there are distinct letters a, b ∈{1, 2, 3} such that va and
vb both occur in w. A left special factor is deﬁned analogously. The deﬁnition of
several other objects and notations from Sect. 3.2 carry over from two to three letter
alphabets without any change and we will use them without deﬁning them again
(we will give exact deﬁnitions for the general setting from Sect. 3.4 onwards).
Deﬁnition 3.3.1 (Arnoux-Rauzy Sequence, see [22])
A sequence w ∈{1, 2, 3}N
is called Arnoux-Rauzy sequence if pw(n) = 2n + 1 and if w has only one right
special factor and only one left special factor for each given length n.
Let w be an Arnoux-Rauzy sequence. Let (Γn) be a sequence of directed graphs
deﬁned in the following way. For each n ∈N the vertices of Γn are the factors of
length n of w. There is a directed edge from u to v if and only if there are letters

3
S-adic Sequences
123
a, b ∈{1, 2, 3} and a word x ∈{1, 2, 3}∗such that u = ax and v = xb. Inspecting
these graphs we see that two cases can occur. If the left special factor v of length n
is also the right special factor then Γn is a bouquet of three circles whose common
vertex is v, otherwise it is a union of three circles that share the line between the
vertices corresponding to the right and left special factor. An investigation of these
graphs (as done in [22, Section 2]) shows that Arnoux-Rauzy sequences are “S-adic”
and we get the following analog of Proposition 3.2.7.
Proposition 3.3.2 (See [22, Section 2]) Let the Arnoux-Rauzy substitutions
σ1, σ2, σ3 be deﬁned by
σ1 :
⎧
⎪⎪⎨
⎪⎪⎩
1 →1,
2 →12,
3 →13,
σ2 :
⎧
⎪⎪⎨
⎪⎪⎩
1 →21,
2 →2,
3 →23,
σ3 :
⎧
⎪⎪⎨
⎪⎪⎩
1 →31,
2 →32,
3 →3.
(3.18)
Then for each Arnoux-Rauzy sequence w there exists a sequence σ = (σin), where
(in) takes each symbol in {1, 2, 3} an inﬁnite number of times, such that w has the
same language as
u = lim
n→∞σi0 ◦σi1 ◦· · · ◦σin(1).
(3.19)
By this proposition each Arnoux-Rauzy sequence w has a coding sequence σ of
Arnoux-Rauzy substitutions and we may deﬁne the dynamical system (Xw, Σ) =
(Xσ, Σ) as the dynamical system associated with w, where Xw = Xσ is the set of
sequences whose language equals the language of w and which just depends on σ.
These dynamical systems are called Arnoux-Rauzy systems.
Let w be an Arnoux-Rauzy sequence with coding sequence σ = (σin) and
let (Min) be the associated sequence of incidence matrices. Since each symbol in
{1, 2, 3} occurs inﬁnitely often in (in) the associated sequence of incidence matrices
(Min) is easily seen to be primitive in the sense that for each m ∈N there is n > m
such that Mi[m,n) is a positive matrix. Indeed, a block Mi[m,n) is primitive if and only
if it contains each of the three matrices M1, M2, M3 at least once.
Lemma 3.3.3 Let w be an Arnoux-Rauzy sequence with coding sequence σ. Then
the dynamical system (Xσ, Σ) is minimal and uniquely ergodic.
Proof Minimality follows if we can show that L(v) = L(w) for each v ∈Xσ. This
in turn holds if each factor of w occurs inﬁnitely often in w with bounded gaps,
which we will now prove. Let x be a factor of w. As w has the same language as the
sequence u in (3.19), by primitivity of (Min) there is m ∈N such that x occurs in
σi[0,m)(1). Using primitivity again we see that there exists n > m such that Mi[m,n) is
a positive matrix. This entails that the word σi[m,n)(b) contains 1 for any b ∈{1, 2, 3}
and, hence, σi[0,n)(b) contains σi[0,m)(1) and, a fortiori, also x for each b ∈{1, 2, 3}.
Thus x occurs in w inﬁnitely often with gaps bounded by 2 max{|σi[0,n)(b)| : b ∈
{1, 2, 3}}.

124
J. M. Thuswaldner
Unique ergodicity of (Xσ, Σ) can be derived from a general result of Bosher-
nitzan [56] due to the fact that (Xσ, Σ) is minimal and its elements have linear
complexity with slope less than 3.
⊓⊔
This proof implies that each Arnoux-Rauzy sequence is uniformly recurrent.
Generalizing an idea of Arnoux [9], in [22] it was shown that each Arnoux-Rauzy
sequence w can be viewed as a coding of a 6-interval exchange transformation (by
using sequences over an alphabet with only three letters!) and that each Arnoux-
Rauzy system can be represented by such a 6-interval exchange. In view of a
result by Katok [94] this implies that Arnoux-Rauzy systems cannot be mixing.
The incidence matrices of Arnoux-Rauzy substitutions can be used to deﬁne a
generalized continued fraction algorithm in the sense of Sect. 3.4.2 below. However,
this algorithm only works for vectors taken from a set of measure zero, the so-called
Rauzy gasket. For more on this interesting set we refer to [25, 29, 30, 69, 99].
Another interesting class of sequences of complexity 2n + 1 over the alphabet
{1, 2, 3} has been deﬁned recently in [64] and is currently subject to intensive
investigation. Compared to Arnoux-Rauzy sequences it has the advantage that it
is deﬁned in terms of only two substitutions and gives rise to a continued fraction
algorithm that works on a set of full measure.
3.3.2
Imbalanced Arnoux-Rauzy Sequences
To get the perfect analogy with the Sturmian case it would be desirable to represent
a given Arnoux-Rauzy sequence w as a natural coding of a rotation on the two-
dimensional torus T2. In the seminal paper of Rauzy [114], this was achieved for
the sequence w = lim σ n(1), where σ is the famous Tribonacci substitution deﬁned
by
σ :
⎧
⎪⎪⎨
⎪⎪⎩
1 →12,
2 →13,
3 →1.
(3.20)
Since σ 3 = σ1 ◦σ2 ◦σ3 the sequence w is an example of an Arnoux-Rauzy
sequence (with periodic coding sequence). Several years ago Barge, Štimac, and
Williams [37] as well as Berthé et al. [48] could generalize this result and proved
that each Arnoux-Rauzy sequence w with periodic coding sequence is a natural
coding of a rotation on T2 (a weaker result in this direction is already contained in
[18]). A general theory for nonperiodic sequences was established only recently, see
Berthé et al. [52], and we will come back to this in later sections.
We recall that a sequence w = w0w1 . . . ∈{1, 2, 3}N is a natural coding of a
rotation R on T2 if there exists a fundamental domain Ω of T2 in R2 together with
a partition Ω = Ω1 ∪Ω2 ∪Ω3 such that on each Ωi the map R′ induced on Ω by

3
S-adic Sequences
125
the rotation R acts as a translation by a vector ai ∈R2 and for some point x ∈Ω
we have R′k(x) ∈Ωwk for each k ∈N (see also Deﬁnition 3.9.2).
An Arnoux-Rauzy sequence is not always a coding of a rotation on T2 with
bounded fundamental domain. The reason for this is the lack of balance for some
particular instances of such sequences. Following Cassaigne et al. [63] we now
sketch the construction of an Arnoux-Rauzy sequence that is not balanced.
Let C ≥1 be an integer. Generalizing the notion of balance from Sect. 3.2.1
we say that a sequence w ∈{1, 2, 3}N is C-balanced if each pair of factors (u, v)
of w having the same length satisﬁes
|u|a −|v|a
 ≤C for each a ∈{1, 2, 3}.
The following result implies that there is no uniform C that gives C-balance for
each Arnoux-Rauzy sequence. Here a substitution is called primitive if its incidence
matrix is primitive.
Lemma 3.3.4 (See [63, Proposition 2.2]) For each integer C ≥1 there is a ﬁnite
sequence of Arnoux-Rauzy substitutions σi1, . . . , σik such that σ = σi1 ◦· · · ◦σik is
primitive and for each Arnoux-Rauzy sequence w the Arnoux-Rauzy sequence σ(w)
is not C-balanced.
Proof We prove by induction that for each n ≥2 there exist an, bn, cn ∈N and a
primitive composition of Arnoux-Rauzy matrices σ (n) such that for each Arnoux-
Rauzy sequence w the sequence σ (n)(w) contains two factors u(n) and v(n) of equal
length with
⎛
⎝
|u(n)|i
|u(n)|j
|u(n)|k
⎞
⎠=
⎛
⎝
an
bn + n
cn
⎞
⎠
and
⎛
⎝
|v(n)|i
|v(n)|j
|v(n)|k
⎞
⎠=
⎛
⎝
an + 1
bn
cn + n −1
⎞
⎠
for some choice i, j, k with {i, j, k} = {1, 2, 3}. This will prove the result because
|u(n)|j −|v(n)|j
 = n shows that σ (n)(w) is not (n −1)-balanced.
For the induction start take n = 2 and σ (2) = σ1σ2 with u(2) = 212 and v(2) =
131.
To perform the induction step assume that the result is true for some n and let
u(n), v(n), an, bn, cn, i, j, k, and σ (n) be as above. Set σ (n+1) = σ n
k ◦σ n
i ◦σ (n).
We now construct u(n+1) and v(n+1). Let u be a nonempty factor of some Arnoux-
Rauzy sequence w. Then for each a ∈{1, 2, 3} the word σa(u)a is a factor of σa(w)
which begins with a. If we deﬁne σ(a,+)(u) = σa(u)a and σ(a,−)(u) as the sufﬁx
of σa(u) of length |σa(u)| −1 (i.e., the ﬁrst letter of σa(u) is canceled) we see that
u(n+1) = σ n
(k,−)σ n
(i,+)(vn) and v(n+1) = σ n
(k,+)σ n
(i,−)(vn) are factors of σ (n+1)(w).
Using the deﬁnition of σ(a,+) and σ(a,−) one can now check directly that
⎛
⎝
|u(n+1)|k
|u(n+1)|i
|u(n+1)|j
⎞
⎠=
⎛
⎝
an+1
bn+1 + n + 1
cn+1
⎞
⎠
and
⎛
⎝
|v(n+1)|k
|v(n+1)|i
|v(n+1)|j
⎞
⎠=
⎛
⎝
an+1 + 1
bn+1
cn+1 + n
⎞
⎠,

126
J. M. Thuswaldner
where
⎛
⎝
an+1
bn+1
cn+1
⎞
⎠=
⎛
⎝
cn + n −1 + n(an + n(bn + cn + n) + bn)
an + n(bn + cn + n −1)
bn
⎞
⎠.
⊓⊔
This lemma can even be sharpened in the following way.
Lemma 3.3.5 (See [63, Proposition 2.3]) For each integer C ≥1 and each
composition of Arnoux-Rauzy substitutions σ there exists a primitive composition
of Arnoux-Rauzy sequences σ ′ such that for each Arnoux-Rauzy sequence w the
Arnoux-Rauzy sequence σ ◦σ ′(w) is not C-balanced.
The proof is technical and we do not provide it here. The idea is to use
Lemma 3.3.4 in order to choose σ ′ in a way that σ ′(w) is not K-balanced for each
Arnoux-Rauzy sequence w, where K, which depends on the incidence matrix of σ,
is so large that even after the application of σ we cannot reach C-balance.
We are now able to establish the following result.
Theorem 3.3.6 (See [63, Theorem 2.4]) There exists an Arnoux-Rauzy sequence
which is not C-balanced for any C ≥1.
Proof By Lemma 3.3.5 one can construct primitive compositions of Arnoux-Rauzy
substitutions σ (1), . . . , σ (C) such that σ (1) ◦· · ·◦σ (C)(w) is not C-balanced for any
Arnoux-Rauzy sequence w. Thus u = limC→∞σ (1) ◦· · · ◦σ (C)(w) is the desired
sequence.
⊓⊔
Using this proposition we are able to establish the following result of [63] which
strongly indicates that an unconditional generalization of the theory presented in
Sect. 3.2 is not possible.
Corollary 3.3.7 (Cf. [63, Corollary 2.6]) There exists an Arnoux-Rauzy sequence
which is not a natural coding of a minimal rotation on the 2-torus with bounded
fundamental domain.
Proof By Theorem 3.3.6 there is an Arnoux-Rauzy sequence w which is not C-
balanced for any C > 0. Assume that w is a natural coding of a minimal rotation
on T2 with bounded fundamental domain Ω. Each letter j ∈{1, 2, 3} corresponds
to a translation aj on Ω and, hence, to each word u = u0 . . . un−1 ∈{1, 2, 3}∗
there corresponds the translation au = n−1
k=0 auk on Ω. Since Ω is bounded and
the rotation is minimal one easily checks that the vectors a1, a2, a3 satisfy R+a1 +
R+a2 + R+a3 = R2. This implies that there exists a constant γ > 0 such that
two words u, v ∈{1, 2, 3}∗with
|u|i −|v|i
 ≥C for some i ∈{1, 2, 3} satisfy
∥au −av∥1 > γ C.
Since w is not balanced there is a letter i ∈{1, 2, 3} such that for each C > 0
there exist two factors u, v ∈{1, 2, 3}∗of w with
|u|i −|v|i
 ≥C. Thus ∥au −
av∥1 > γ C. Since C can be arbitrarily large, this difference can be made arbitrarily
large. Thus one of the two vectors au, av can be made arbitrarily large. Assume
w.l.o.g. that this is au. Since there is an element x ∈Ω with x + au ∈Ω, the

3
S-adic Sequences
127
diameter of Ω is bounded from below by the length of au. This contradicts the
boundedness of the fundamental domain Ω.
⊓⊔
Remark 3.3.8 We mention that in [63, Corollary 2.6] it is claimed that Corol-
lary 3.3.7 is true without assuming that the fundamental domain is bounded.
However, we were not able to verify this proof.
3.3.3
Weak Mixing and the Existence of Eigenvalues
In Cassaigne et al. [62] the authors give a criterion for weak mixing for some class
of Arnoux-Rauzy systems. On the other hand they provide a class of Arnoux-Rauzy
systems that admit nontrivial eigenvalues. Before we give the details, we recall the
required terminology from ergodic theory (good references here are for instance
Einsiedler and Ward [76] or Walters [126]; we also mention Halmos [85] where
some concepts are illustrated in an intuitive way).
Let (X, T, μ) be a dynamical system with invariant measure μ. We say that a
complex number λ is a measurable eigenvalue of T if there exists f ∈L1(μ),
f ̸= 0, such that f (T x) = λf (x) for μ-almost every x. Such an f is called an
eigenfunction for λ. For topological dynamical systems the notion of topological
eigenvalue is deﬁned analogously by using continuous eigenfunctions instead of
functions from L1(μ).
The transformation T is called weakly mixing if for each A, B ⊂X of positive
measure we have
lim
n→∞
1
n

0≤k<n
|μ(T −k(A) ∩B) −μ(A)μ(B)| = 0.
Weak mixing is equivalent to the fact that 1 is the only measurable eigenvalue of T
and the only eigenfunctions are constants (in this case the dynamical system is said
to have continuous spectrum). We note that rotations are never weakly mixing. They
have pure discrete spectrum (with will be deﬁned in Deﬁnition 3.9.1), meaning that
they have “a lot of eigenfunctions” and therefore they have a completely different
dynamical behavior. Indeed, from the deﬁnition of weak mixing we see that iterated
preimages of each set tend to “smear” (or mix) over the whole space, this is of course
not the case for the iterated preimages of a rotation.
We now come back to the aim of this section and discuss mixing properties of
Arnoux-Rauzy systems. Let
u = lim
n→∞σ k1
i1 ◦σ k2
i2 ◦· · · ◦σ kn
in (1)
with in ̸= in+1 be an Arnoux-Rauzy sequence. We deﬁne (nℓ) to be the sequence of
indices n for which in ̸= in+2. The sequence u is uniquely deﬁned by the sequences
(kn) and (nℓ) (up to permutation of letters). The following result shows a result on
weak mixing Arnoux-Rauzy systems for large partial quotients (kn).

128
J. M. Thuswaldner
Theorem 3.3.9 (See [62, Theorem 2]) For an Arnoux-Rauzy sequence w with
coding sequence σ and associated sequences (kn) and (nℓ) the system (Xσ , Σ, μ)
(with μ being the unique invariant measure) is weakly mixing if the sequence
(knℓ+2)ℓ∈N is unbounded and the sums 
ℓ≥1
1
knℓ+1 and 
ℓ≥1
1
knℓconverge.
This implies that (Xσ, Σ, μ) is not measurably conjugate to a rotation on T2.
The proof of this result is quite involved. In fact, to get weak mixing, by
deﬁnition one has to show that there exists no measurable eigenvalue apart from
1 for the system (Xσ, Σ, μ). This is achieved by verifying the following criterion
(see [62, Proposition 10]): if ϑ is a measurable eigenvalue of (Xσ, Σ, μ), then
kn+1{hnϑ} →0 for n →∞. Here hn is the length of σ k1
i1 ◦· · · ◦σ kn
in (1). This
criterion is proved using a sequence of nested Rohlin towers which are naturally
built using the coding sequence σ. As mentioned above, because an Arnoux-Rauzy
system can be represented by a 6-interval exchange, it cannot be mixing in view of
Katok [94].
To give this section a good end we mention that [62] also contains results that
support the hope that at least something along the lines of Sect. 3.2 can be done in
higher dimensions. Indeed, the authors are able to exhibit criteria for the existence of
nontrivial continuous eigenvalues (not equal to 1) for Arnoux-Rauzy systems which
implies that these systems have a rotation as a continuous factor. The novelty here is
the fact that these systems still have unbounded partial quotients (kn). For bounded
partial quotients criteria for the existence of continuous and measurable eigenvalues
are provided in the more general setting of linear recurrent minimal Cantor systems
in Cortez et al. [66].
It will be our concern in the subsequent sections to exhibit S-adic sequences that
are even measurable conjugates of rotations on tori of dimension greater than or
equal to two.
3.4
The General Setting
So far we have seen some elements of the correspondence between Sturmian
sequences, the classical continued fraction algorithm, and rotations on the circle.
We have also reviewed some results that highlight the problems and limitations of
a generalization of this nice interplay between several branches of mathematics to
higher dimensions. Nevertheless, we are able to set up a quite general extension
of the results contained in Sect. 3.2. Indeed, in the subsequent sections of this
chapter we will relate sequences generated by substitutions on alphabets over d
letters to generalized continued fraction algorithms and to rotations on the (d −1)-
dimensional torus. From this point on we will give exact deﬁnitions of all objects we
use. This may seem redundant as some objects have already been introduced before
but as the subject is quite difﬁcult and a variety of concepts and notations is needed
along the way we found it better for the reader to do it that way.

3
S-adic Sequences
129
3.4.1
S-adic Sequences
We now deﬁne so-called S-adic sequences which form analogs of sequences of the
form (3.2) and (3.19) for arbitrary “coding sequences” of substitutions over a ﬁxed
ﬁnite alphabet. To this end we need some notation.
Let A = {1, 2, . . . , d} be a ﬁnite alphabet whose elements will be called
letters or symbols. Deﬁne A∗to be the free monoid generated by A equipped
with the operation of concatenation. The elements of A∗, which are of the form
v = v0v1 . . . vn−1 with n ∈N and vi ∈A for i ∈{0, 1, . . . , n −1}, will be
referred to as words. The integer n, which is equal to the number of letters in the
word v, is called the length of v and will be denoted by |v|. The unique word of
length 0 is called the empty word. Let AN be the space of right inﬁnite sequences
w = w0w1 . . . with wi ∈A for each i ∈N. We equip AN with the product topology
of the discrete topology on A. To a sequence w = w0w1 . . . ∈AN we associate a
function pw : N →N which is deﬁned by
n →|{v ∈A∗: v = wkwk+1 . . . wk+n−1 for some k ∈N}|.
The function pw is called the complexity function of the sequence w. For more on
this function we refer for instance to Cassaigne and Nicolas [65].
A substitution σ over the alphabet A is an endomorphism on A∗that in our
setting will always assumed to be nonerasing in the sense that the image of each
letter is a nonempty word taken from A∗. Being a morphism, a substitution is
completely deﬁned by giving its image for each letter. Thus our previous examples
of Sturmian substitutions in (3.1) and of Arnoux-Rauzy substitutions in (3.18) are
indeed substitutions. We can extend the domain of a substitution σ to AN in a natural
way by deﬁning it symbol-wise, i.e., by setting σ(w0w1 . . .) = σ(w0)σ(w1) . . . The
mapping σ deﬁned in this way is continuous on AN.
With each substitution σ over the alphabet A we associate the |A|×|A| incidence
matrix Mσ whose columns are the abelianized images of σ(i) for i ∈A. More
precisely, letting |v|i be the number of occurrences of a given letter i ∈A in a word
v ∈A∗this matrix is given by Mσ = (mij) = (|σ(j)|i). The incidence matrix can
be seen as the abelianized version of σ. If we deﬁne the abelianization mapping
l : A∗→Nd by l(w) = (|w|1, . . . , |w|d)t (here xt is the transpose of a vector
x ∈Rd) we have the commutative diagram
A∗
σ
A∗
l
l
Nd
Mσ
Nd
(3.21)
which says that lσ(w) = Mσl(w) holds for each w ∈A∗.
We will be interested in special classes of substitutions. Let σ be a substitution.
Then σ is called unimodular if | det Mσ| = 1, it is called primitive if Mσ is a

130
J. M. Thuswaldner
primitive matrix (i.e., Mσ has a power each of whose entries is greater than zero), it
is called irreducible if Mσ has irreducible characteristic polynomial, and it is called
Pisot if the characteristic polynomial of Mσ is the minimal polynomial of a Pisot
number. We recall that a Pisot number is an algebraic integer β > 1 whose Galois
conjugates (apart from β itself) are all smaller than 1 in modulus.
In full generality substitutions are studied for instance in [6, 40, 87] and, in a
context related to the present chapter, in [82].
We will now deﬁne the analogs of the “coding sequences” used in Sects. 3.2
and 3.3 for a more general setting. We go in the reverse direction: in the mentioned
earlier sections the sequence (of letters) was there ﬁrst and we constructed a
sequence of substitutions that generates this sequence. Now we start with a sequence
of substitutions in order to deﬁne a sequence of letters.
Let σ = (σn)n∈N be a sequence of substitutions over a given ﬁnite alphabet A.
For convenience, we will set Mn = Mσn for the incidence matrix of σn and write
M = (Mn) for the sequence of these incidence matrices. Moreover, as we will often
need blocks of substitutions as well as blocks of matrices we set
σ[m,n) = σm ◦σm+1 ◦· · · ◦σn−1
and
M[m,n) = MmMm+1 · · · Mn−1
for positive integers m ≤n (here we set σ[n,n)(a) = a for all a ∈A and deﬁne
M[n,n) to be the |A| × |A| identity matrix).
We associate with σ a sequence of languages, for all m ∈N,
L(m)
σ
= {v ∈A∗: v is a factor of σ[m,n)(a) for some a ∈A, m ≤n}
and call Lσ = L(0)
σ
the language of σ. Here u ∈A∗is a factor of v ∈A∗if
v ∈A∗uA∗, or, more informally, if the word u occurs somewhere as subword in
the word v. We will use this notation also for (right inﬁnite) sequences later. Then
u ∈A∗is a factor of v ∈AN if v ∈A∗uAN. The set of all factors of a sequence v
is called the language of v. It is denoted by L(v). We also introduce the notion of
preﬁx and sufﬁx that will be used later. A preﬁx of a word v ∈A∗is a word u ∈A∗
with v ∈uA∗and a sufﬁx of v ∈A∗is a word u ∈A∗with v ∈A∗u. A preﬁx of a
sequence v ∈AN is a word u ∈A∗with v ∈uAN.
After these preparations we can deﬁne S-adic sequences for a given sequence
of substitutions σ. The terminology “S-adic” goes back to Ferenczi [77]. In our
deﬁnition we follow Arnoux et al. [20] (see also [52, Section 2.2]).
Deﬁnition 3.4.1 (S-adic Sequence) Let A be a given ﬁnite alphabet, let σ =
(σn)n≥0 be a sequence of substitutions over A, and set S := {σn : n ∈N}. We
call a sequence w ∈AN an S-adic sequence (or a limit sequence) for σ if there
exists a sequence (w(n))n≥0 of sequences w(n) ∈AN with
w(0) = w,
w(n) = σn(w(n+1))
(for all n ∈N).
(3.22)

3
S-adic Sequences
131
In this case we call σ the coding sequence or the directive sequence for w. (Note
that (3.22) says that w can be “desubstituted” inﬁnitely often).
Let S be a ﬁnite set of substitutions over a given alphabet A. For this case S-adic
sequences have been thoroughly studied in the literature. With Sturmian sequences
and Arnoux-Rauzy sequences we already discussed two prominent classes of S-adic
sequences. Durand [71, 72] proved that linearly recurrent3 sequences are S-adic
with ﬁnite S. Ferenczi [77] and Leroy [97] showed that a uniformly recurrent4
sequence w with an at most linear complexity function pw is S-adic with ﬁnite S; see
also [98]. The so-called S-adic conjecture (see e.g. [82, Section 12.1.2] or [73, 97])
is also formulated for a ﬁnite set of substitutions S. It asks to what extent a converse
of this assertion can be true, i.e., which criteria are needed for an S-adic sequence
w to have linear complexity function pw. Berthé and Labbé [49] show linearity
of the complexity of S-adic sequences associated with the Arnoux-Rauzy-Poincaré
multidimensional continued fraction algorithm (their bound pw(n) ≤
5
2n + 1 is
even strong enough to conclude from Boshernitzan [56] that, like Arnoux-Rauzy
sequences, these sequences pertain to uniquely ergodic dynamical systems). Arnoux
et al. [20] study S-adic sequences in the same context as we will do it. However, they
restrict their attention to sets of substitutions S whose elements have a common
incidence matrix. If S is a singleton, an S-adic sequence is called substitutive.
Substitutive sequences are very well studied (see for instance [82]; moreover in
the paragraphs following Deﬁnition 3.4.2 we review the literature on substitutive
sequences related to our subject). They are strongly related to automatic sequences
by Cobham’s Theorem, see e.g. [6, Theorem 6.3.2].
Generalizing Sturmian systems we introduce dynamical systems for S-adic
sequences. To this end, for a ﬁnite alphabet A deﬁne the shift on AN as Σ : AN →
AN by Σ(w0w1 . . .) = w1w2 . . .
Deﬁnition 3.4.2 (S-adic System)
For an S-adic sequence w over a ﬁnite alphabet
A we denote by Xw = {Σkw : k ∈N} the orbit closure of w under the action of
the shift Σ. If we denote the restriction of Σ to Xw by Σ again we call the pair
(Xw, Σ) the S-adic system (or S-adic shift) generated by w.
Alternatively, the set Xw can be deﬁned using languages by setting Xw = {v ∈
AN : L(v) ⊆L(w)}. The proof of the fact that both deﬁnitions of Xw agree is an
easy exercise. Also the set Xσ =  Xw, where the union is extended over all S-adic
sequences with directive sequence σ, and the associated dynamical system (Xσ , Σ)
are of interest.5 A recent survey on S-adic systems is provided in [44].
3A sequence is called linearly recurrent if there is a constant K such that each of its factors u
occurs inﬁnitely often in the sequence with gaps bounded by K|u|.
4A sequence is called uniformly recurrent if each of its factors occurs inﬁnitely often in the
sequence with bounded gaps.
5If we impose the additional property of primitivity on the coding sequence of a sequence w ∈AN
it turns out that Xw depends only on the directive sequence σ deﬁning the S-adic sequence w and
we have Xσ = Xw. This will be worked out precisely in Sect. 3.5.

132
J. M. Thuswaldner
In all what follows we will assume that all our substitutions and matrices are
unimodular.
The case of σ = (σ), the constant sequence formed by a given unimodular
substitution σ over some alphabet A, has been studied extensively. In this case we
call (X(σ), Σ) a substitutive system (see Queffelec [110] for a profound study of
dynamical properties of these systems). The theory of Sect. 3.2 can be generalized
quite well to substitutive systems if σ is a unimodular Pisot substitution. The
seed for such a generalization was planted by Rauzy [114]. Constructing the
prototype of what is now called Rauzy fractal, he proved that the dynamical system
(Xσ, Σ) is measurably conjugate to a rotation on T2 if σ = (σ) with σ being the
Tribonacci substitution introduced in (3.20). It was conjectured since then that each
unimodular Pisot substitution σ gives rise to a substitutive system (X(σ), Σ) which
is measurably conjugate to a rotation on the torus. This conjecture is still open and
known as Pisot (substitution) conjecture.
In the meantime, the Pisot conjecture was studied by many people and interesting
partial results have been achieved. We mention Arnoux and Ito [18] as well as Ito
and Rao [91] who could prove the Pisot conjecture subject to some combinatorial
coincidence conditions. Conditions of this type will also play an important role in
the general theory we will develop here, see Sect. 3.8.2. Recently, Barge [32, 33]
made considerable progress on this subject using reﬁnements of the notion of
proximality (see [27, 35]). For survey papers on the subject we refer e.g. to [4, 51].
For extensions of this theory to the nonunimodular case see [106, 122].
3.4.2
Generalized Continued Fraction Algorithms
We now generalize the concept of continued fraction algorithm deﬁned in Sect. 3.2.2
and introduce generalized continued fraction algorithms. Standard references for
these objects are Brentjes [58] and Schweiger [119]. Also Labbé’s Cheat Sheets [95]
for 3-dimensional continued fraction algorithms are highly recommended. For
discussions of generalized continued fraction algorithms in a context similar to ours
we refer e.g. to [11, 19, 21, 41].
Deﬁnition 3.4.3 (Generalized Continued Fraction Algorithm)
For d ≥2 let X
be a closed subset of the projective space Pd−1 and let {Xi}i∈I be a partition of X
(up to a set of measure 0) indexed by a countable set I. Let M = {Mi : i ∈I}
be a set of unimodular d × d integer matrices (that act on Pd−1 by homogeneity)
satisfying M−1
i
Xi ⊂X and let M : X →M given by M(x) = Mi whenever
x ∈Xi. The generalized continued fraction algorithm associated with this data is
given by the mapping
F : X →X;
x →M(x)−1x.

3
S-adic Sequences
133
If I is a ﬁnite set, the algorithm given by F is called additive, otherwise it is called
multiplicative.
Note that F is deﬁned only almost everywhere since {Xi}i∈I in general is only a
partition up to measure zero. We conﬁne ourselves to unimodular matrices. Thus
the algorithms in Deﬁnition 3.4.3 are sometimes called unimodular algorithms.
Interesting examples of nonunimodular continued fraction algorithms are provided
by the N-continued fraction algorithm introduced by Burger et al. [60] and by the
Reverse algorithm, a certain “completion” of the Arnoux-Rauzy algorithm studied
in [19, Section 4].
We illustrate the deﬁnition of generalized continued fraction algorithms by a
classical example: Brun’s continued fraction algorithm.
Example 3.4.4 (Brun’s Algorithm)
The linear version of Brun’s algorithm is
deﬁned on the subset
X = {[w1 : w2 : w3] : 0 ≤w1 ≤w2 ≤w3} ⊂P2.
It maps a vector [w1 : w2 : w3] to sort[w1 : w2 : w3 −w2], i.e., it subtracts the
second largest entry from the largest one and sorts the resulting entries in ascending
order. By a straightforward calculation we see that M = {M1, M2, M3} with
M1 =
⎛
⎝
0 1 0
0 0 1
1 0 1
⎞
⎠,
M2 =
⎛
⎝
1 0 0
0 0 1
0 1 1
⎞
⎠,
M3 =
⎛
⎝
1 0 0
0 1 0
0 1 1
⎞
⎠,
(3.23)
and that the partition X = X1 ∪X2 ∪X3 is given by Fig. 3.10.
Fig. 3.10 The partition of X
induced by Brun’s continued
fraction algorithm
[1 : 1 : 1]
[0 : 0 : 1]
[0 : 1 : 1]
[1 : 1 : 2]
[0 : 1 : 2]
X1
X3
X2

134
J. M. Thuswaldner
With this data the linear Brun continued fraction mapping can be deﬁned
according to Deﬁnition 3.4.3 by
FB : X →X;
x →M−1
i
x
for x ∈Xi.
Since M1, M2, and M3 are unimodular, Brun’s algorithm is a unimodular continued
fraction algorithm. As we did for the classical continued fraction algorithm in
Sect. 3.2.2, we can deﬁne a projective version also in the case of Brun’s algorithm.
This projective version is the original version of this algorithm and goes back to
Brun [59]. It is deﬁned on the set
Δ = {(x1, x2) ∈R2 : 0 ≤x1 ≤x2 ≤1}
(3.24)
by
fB : (x1, x2) →
⎧
⎪⎪⎪⎨
⎪⎪⎪⎩

x1
1−x2 ,
x2
1−x2

,
for x2 ≤1
2,

x1
x2 , 1−x2
x2

,
for 1
2 ≤x2 ≤1 −x1,

1−x2
x2 , x1
x2

,
for 1 −x1 ≤x2.
(3.25)
To see that fB is the projective version of FB we use the same reasoning as in the
classical case in Sect. 3.2.2.
We refer to Example 3.5.12 where we provide S-adic sequences associated with
Brun’s algorithm.
Other well-known generalized continued fraction algorithms include the Jacobi-
Perron algorithm [109] and the Selmer algorithm [120].
3.5
The Importance of Primitivity and Recurrence
As indicated in Sect. 3.3 it is not possible to generalize the results of Sect. 3.2 to
higher dimensions (or, equivalently, to alphabets of cardinality greater than two)
without additional conditions on the sequence of substitutions σ. In this section we
will discuss two natural conditions that we will have to impose on our sequences of
substitutions. The ﬁrst one is primitivity, the second one is recurrence. Both of them
will have important consequences for the underlying S-adic system: primitivity will
imply minimality, and if we assume recurrence on top of primitivity, the system will
be uniquely ergodic.

3
S-adic Sequences
135
3.5.1
Primitivity and Minimality
In the following deﬁnition a matrix is called nonnegative if each of its entries is
greater than or equal to zero. In a positive matrix each entry is greater than zero.
Deﬁnition 3.5.1 (Primitivity)
A sequence M = (Mn)n≥0 of nonnegative integer
matrices is primitive if for each m ∈N there is n > m such that M[m,n) is a
positive matrix. A sequence σ of substitutions is primitive if its associated sequence
of incidence matrices is primitive.
Note that primitivity of (Mn)n≥0 implies primitivity of the “shifted” sequence
(Mn+k)n≥0 for each k ∈N. The same applies for primitive sequences of substitu-
tions.
Our deﬁnition of primitivity is taken from [52, Section 2.2]. It coincides with the
notion of weak primitivity introduced in [44, Deﬁnition 5.1] and with the notion of
nonstationary primitivity deﬁned in [81, p. 339]. The more restrictive property of
strong primitivity which is also introduced in [44, Deﬁnition 5.1] requires that the
integer n in Deﬁnition 3.5.1 can be chosen in a way that the difference n −m is
uniformly bounded in m. In other papers, this stronger property is called primitivity
(see e.g. [71–73]).
As we will see in the ﬁrst result of this section, the assumption of primitivity
entails minimality of the associated S-adic systems. We recall the deﬁnition of this
basic concept.
Deﬁnition 3.5.2 (Minimality)
Let (X, T ) be a topological dynamical system.
(X, T ) is called minimal if the orbit of each point is dense in X, i.e., if
{T nx : n ∈N} = X holds for each x ∈X.
The following lemma summarizes the consequences of primitivity for an S-adic
system. It is proved for instance in [20, Proposition 2.1 and 2.2]; the minimality
assertion can already be found in [71, Lemma 7].
Proposition 3.5.3 If σ is a primitive sequence of substitutions, the following
properties hold.
(i) There exists at least one and at most |A| limit sequences for σ.
(ii) Let w, w′ be two S-adic sequences with directive sequence σ. Then the
dynamical systems (Xw, Σ) and (Xw′, Σ) are equal.
(iii) For a limit sequence w of σ the S-adic system (Xw, Σ) is minimal.
Proof To show (i) let σ = (σn) and for each n ∈N let An be the set of all ﬁrst letters
occurring in the family σ[0,n)(A) of words. Then (An) is a decreasing sequence of
nonempty subsets of A. Hence, there is a ∈0
n≥0 An. By construction there is a
sequence (an) with a0 = a such that an is the ﬁrst letter of σn(an+1). Moreover,
σ[0,n)(an) is a preﬁx of σ[0,n+1)(an+1). By primitivity, the lengths of these words

136
J. M. Thuswaldner
tend to inﬁnity which implies that w = limn→∞σ[0,n)(anan . . .) converges.6 By the
same reasoning (here we use that primitivity also holds for “shifted” sequences),
we see that w(m) = limn→∞σ[m,n)(anan . . .) converges as well and the sequence
(w(m)) satisﬁes the conditions of Deﬁnition 3.4.1. Thus w = w(0) is an S-adic
sequence with directive sequence σ.
If w is an S-adic sequence with directive sequence σ, by Deﬁnition 3.4.1 we
can associate a sequence (w(n)) with it. For n ∈N let an be the ﬁrst letter
of w(n). Primitivity implies that |σ[0,n)(an)| →∞for n →∞and, hence,
the sequence w is determined by the sequence (an). In particular, we can write
w = limn→∞σ[0,n)(anan . . .). Since an uniquely determines ap for each p < n,
there are at most |A| possible different choices for such a sequence.
To prove (ii) let w and w′ be two S-adic sequences with directive sequence σ.
Associate the sequences (an) and (a′
n), respectively, with them as above. If u is a
factor of w then u is a factor of σ[0,m)(am) for some m. By primitivity, there exists
n > m such that am occurs in σ[m,n)(a′
n). Thus σ[0,m)(am) and a fortiori also u is a
factor of w′ and, hence, L(w) ⊆L(w′). Exchanging the roles of w and w′ we can
therefore conclude that L(w) = L(w′) which implies that Xw = Xw′.
It remains to prove (iii). This follows if we can show that L(v) = L(w) for each
v ∈Xw. This in turn holds if each factor of w occurs inﬁnitely often in w with
bounded gaps, which we will now prove. Let u be a factor of w and let (an) be the
sequence of letters associated to w as above. Then u is a factor of σ[0,m)(am) for
some m. By primitivity, there exists n > m such that u is a factor of σ[0,n)(a) for
each a ∈A. Since w is an S-adic sequence, w = σ[0,n)(w(n)) holds for some w(n) ∈
AN. Thus u occurs in w inﬁnitely often with gaps bounded by 2 max{|σ[0,n)(a)| :
a ∈A}.
⊓⊔
If σ is a primitive sequence of substitutions, assertion (ii) of this proposition
implies that Xσ = Xw and, hence, (Xσ, Σ) = (Xw, Σ) for w being an arbitrary
S-adic sequence with directive sequence σ. Since we will assume primitivity
throughout the remaining part of the paper we will always work with Xσ.
3.5.2
Recurrence, Weak Convergence, and Unique Ergodicity
The next concept we introduce is recurrence. Let S be a ﬁnite set of substitutions. If
we take a random sequence of substitutions σ ∈SN whose elements are taken from
a ﬁnite set S we will almost always (w.r.t. any natural measure on the space SN) get
a sequence σ each of whose patterns occurs inﬁnitely often. This inﬁnite repetition
of patterns is made precise in the following deﬁnition.
6Only the ﬁrst letter an in the argument of σ[0,n) is relevant for the limit. However, since we use
the topology on AN and σ[0,n)(an) ̸∈AN we have to write σ[0,n)(anan . . .).

3
S-adic Sequences
137
Deﬁnition 3.5.4 (Recurrence)
A sequence M = (Mn) of integer matrices is
called recurrent if for each m ∈N there is n ≥1 such that (M0, . . . , Mm−1) =
(Mn, . . . , Mn+m−1). A sequence σ = (σn) of substitutions is called recurrent if for
each m ∈N there is n ≥1 such that (σ0, . . . , σm−1) = (σn, . . . , σn+m−1).
Note that recurrence of a sequence of substitutions σ implies that each block
of substitutions that occurs once in σ must occur inﬁnitely often (the same is
true for sequences of matrices). Thus recurrence of (σn)n∈N implies recurrence of
(σm+n)n∈N for each m ∈N and an analogous statement holds for sequences of
matrices. We also emphasize that a nonrecurrent sequence of substitutions may well
have a recurrent sequence of incidence matrices. This is due to the fact that two
different substitutions can have the same incidence matrix.
We now study consequences of primitivity and recurrence. We start with the
following result which follows from contraction properties of the Hilbert metric,
a metric on projective space that goes back to Birkhoff [55] and Furstenberg [84,
pp. 91–95] (we mention [81, Appendix A] and [125, Chapter 26] as more recent
references). A special case of this result is stated in Sect. 3.2, see (3.14).
Proposition 3.5.5 Let M = (Mn) be a primitive and recurrent sequence of
nonnegative integer matrices. Then there is a vector u ∈Rd
>0 satisfying

n≥0
M[0,n)Rd
≥0 = R+u.
(3.26)
Proof To prove this result we deﬁne a metric on the space W = {R+w : w ∈
Rd
≥0 \ {0}} of nonnegative rays through the origin by (see [81, Appendix A])
dW(R+v, R+w) =
max
1≤i,j≤d log viwj
vjwi
,
where v = (v1, . . . , vd) and w = (w1, . . . , wd). It can be checked by direct
calculation that this is a metric on W which is the so-called Hilbert Metric (cf.
e.g. [81, Lemma A.5] or [125, Chapter 26]). Let diamW(A) be the diameter of a
set A ⊂W w.r.t. this metric. Then diamW(W) = ∞and diamW(MW) < ∞for
every positive matrix M. It follows from the deﬁnitions that a nonnegative matrix
M is nonexpanding in the sense that dW(MR+v, MR+w) ≤dW(R+v, R+w) for
all R+v, R+w ∈W. Moreover, one can show that each positive matrix M is a
contraction, i.e., there is κ < 1 (depending on M) such that dW(MR+v, MR+w) ≤
κ dW(R+v, R+w) for all R+v, R+w ∈W (see for instance [55] or [125, Proposi-
tion 26.3] for a proof of this).
We now apply these contraction properties to our setting. Since M is primitive
and recurrent, there exists a positive matrix B and an integer h > 0 such that B =
M[mi,mi+h) for a sequence of positive integers (mi)i≥0 satisfying mi + h ≤mi+1.
By the preceding paragraph we get that diamW(BW) = γ for some γ > 0 and

138
J. M. Thuswaldner
that B is a contraction with some contraction factor κ < 1. Thus for each m ∈
{mi + h, mi+1 + h −1} we have
diamW


0≤n≤m
M[0,n)Rd
≥0

≤γ κi.
Since κ < 1 and i →∞for m →∞this yields the result. Positivity of the entries
of u follows from the primitivity of M.
⊓⊔
This result motivates the following deﬁnition.
Deﬁnition 3.5.6 (Weak Convergence and Generalized Right Eigenvector) If a
sequence of nonnegative integer matrices satisﬁes (3.26) for some u ∈Rd
≥0 \ {0}
we say that M is weakly convergent to u. In this case we call u a generalized right
eigenvector of M. If a sequence σ of substitutions has a sequence of incidence
matrices M which is weakly convergent to u, we say that σ is weakly convergent to
u and call u a generalized right eigenvector of σ.
Our next goal is to establish unique ergodicity of S-adic systems with primitive
and recurrent directive sequences. We start with a fundamental deﬁnition (and refer
to [126, §6.5] for background material on this).
Deﬁnition 3.5.7 (Unique Ergodicity)
A topological dynamical system (X, T ) on
a compact space X is said to be uniquely ergodic if there is a unique T -invariant
Borel probability measure on X.
By a theorem of Krylov and Bogoliubov (see e.g. [126, Corollary 6.9.1]) there
always exists an invariant probability measure on (X, T ) if X is compact.
A uniquely ergodic dynamical system is ergodic (thus the name) since otherwise
there would be a T -invariant set E with μ(E) ∈(0, 1) which could be used to
deﬁne a second T -invariant Borel probability measure ν(B) =
μ(B∩E)
μ(E)
on X.
Unique ergodicity is equivalent to the fact that each point is generic in the sense that
Birkhoff’s ergodic theorem holds everywhere (cf. [126, Theorem 6.19]). Roughly
speaking, this is true since nongeneric points (as for instance periodic points) could
be used to construct a second invariant measure.
We note that unique ergodicity is close to minimality in the sense that there are
many dynamical systems that either enjoy both or none of the two properties. If
(X, T ) is uniquely ergodic with T -invariant measure μ having full support then
minimality follows. However, there are examples of systems that have only one
of these two properties. For a discussion of such examples in a context similar to
ours see [78] and the references given there. What happens for these examples is
that although we have a primitive sequence of matrices (leading to minimality) this
primitivity is so weak that it does not make the positive cone convergeto a single line
as in (3.26). This entails that no letter frequencies exist which permits to construct
many invariant measures (see also [53, 54, 81]).
It has been mentioned already in Sect. 3.2 that the existence of uniform frequen-
cies of letters and words in a shift (Xw, Σ) entail unique ergodicity. We want to

3
S-adic Sequences
139
give the elegant proof of this result here before we use it in order to establish unique
ergodicity of primitive and recurrent S-adic systems. To this matter we need the
following deﬁnition (see Lemma 3.2.9 for the special case of Sturmian sequences).
Deﬁnition 3.5.8 (Uniform Word and Letter Frequencies)
Let w = w0w1 . . . ∈
AN be given and for each k, ℓ∈N and each v ∈A∗let |wk . . . wk+ℓ−1|v be the
number of occurrences of v in wk . . . wk+ℓ−1. We say that w has uniform word
frequencies if for each v ∈A∗the ratio |wk . . . wk+ℓ−1|v/ℓtends to a limit fv(w)
(which does not depend on k) for ℓ→∞uniformly in k. It has uniform letter
frequencies if this is true for each v ∈A.
Proposition 3.5.9 (See [82, Proposition 5.1.21]) Let w ∈AN be a sequence with
uniform word frequencies and let Xw = {Σkw : k ∈N} be the shift orbit closure
of w. Then (Xw, Σ) is uniquely ergodic.
Proof For every factor v of w = w0w1 . . . let [v] be the cylinder of all sequences
in Xw that have v as a preﬁx. Deﬁne a function μ on these cylinders by μ([v]) =
μ(Σ−n[v]) = fv(w). Since cylinders generate the topology on Xw this deﬁnes a
Borel measure μ on Xw. Our goal is to show that every element of Xw is generic in
the sense of Birkhoff’s ergodic theorem. To this end note ﬁrst that (here 1Y denotes
the characteristic function of a set Y ⊂Xw)
1
N

n<N
1[v](Σn+j w) →μ([v]) =

1[v]dμ
holds uniformly in j
∈N for every v
∈A∗by the existence of uniform
word frequencies for w. Since continuous functions are monotone limits of simple
functions this extends to
1
N

n<N
g(Σn+j w) →

gdμ
(3.27)
uniformly in j ∈N for each g ∈C(Xw). By this uniform convergence, in (3.27) we
may choose j = nk with any sequence (nk) and (3.27) holds uniformly in k. Since
each u ∈Xw is the limit of (Σnkw) for some sequence (nk) this implies that
1
N

n<N
g(Σnu) →

gdμ
holds for each g ∈C(Xw) and each u ∈Xw. Thus each point is generic in the sense
of Birkhoff’s ergodic theorem which is equivalent to unique ergodicity (by [126,
Theorem 6.19] which was already mentioned above).
⊓⊔
We now show that the conditions we introduced so far imply unique ergodicity of
S-adic systems. In view of Proposition 3.5.9 we will establish the following lemma
(see also [44, Theorem 5.7]).

140
J. M. Thuswaldner
Lemma 3.5.10 Let σ be a sequence of substitutions with associated sequence of
incidence matrices M. If M is primitive and recurrent then each sequence w ∈Xσ
has uniform word frequencies.
Proof Let w = w0w1 . . . ∈Xσ be given. We follow the proof of [44, Theorem 5.7]
to establish that w has uniform word frequencies.
Part 1: Uniform Letter Frequencies Since M satisﬁes the conditions of
Proposition 3.5.5, it admits a generalized right eigenvector u. Let u/∥u∥1
=
(u1, u2, . . . , ud)t. Since w ∈Xσ, for all k, ℓ, n ∈N we can write
wk . . . wk+ℓ−1 = pσ[0,n)(v)s
for some p, v, s ∈A∗, where the lengths of p, s are bounded by the number
max{|σ[0,n)(a)| : a ∈A}. Now for each a ∈A

|wk . . . wk+ℓ−1|a
ℓ
−ua
 ≤
|p|a −|p|ua

ℓ
+
|σ[0,n)(v)|a −|σ[0,n)(v)|ua

ℓ
+
|s|a −|s|ua

ℓ
.
(3.28)
By the convergence of the positive cone to u in Proposition 3.5.5 we know that
|σ[0,n)(b)|a/|σ[0,n)(b)| is close to ua for all a, b ∈A if n is large. Thus for each
ε > 0 there is N ∈N such that whenever ℓ≥N we can choose n in a way
that |p|, |s| ≤εℓand
|σ[0,n)(b)|a −|σ[0,n)(b)|ua
 < ε|σ[0,n)(b)| for all letters
a and b. This proves that the right hand side of (3.28) is bounded by 3ε and,
hence, limℓ→∞|wk . . . wk+ℓ−1|a/ℓ= ua uniformly in k. Thus w has uniform letter
frequencies.
Part 2: Uniform Word Frequencies For m ∈N let u(m) be a right eigenvector of
the shifted sequence σ (m) = (σm+n)n∈N and set u(m)/∥u(m)∥1 = (u(m)
1
, . . . , u(m)
d
).
Such an eigenvector exists by Proposition 3.5.5 since the shifted sequence σ (m) has
a primitive and recurrent sequence of incidence matrices as well.
Fix v ∈Lσ. We claim that for each m ∈N and each w(m) = w(m)
0
w(m)
1
. . . ∈
Xσ (m) we have
lim
j→∞
q+j−1
i=q
|σ[0,m)(w(m)
i
)|v
|σ[0,m)(w(m)
q
. . . w(m)
q+j−1)|
=

a∈A u(m)
a
|σ[0,m)(a)|v

a∈A u(m)
a
|σ[0,m)(a)|
=: g(v, m)
(3.29)

3
S-adic Sequences
141
uniformly in q ∈N. This claim follows because, since w(m) has uniform letter
frequencies (u(m)
1
, . . . , u(m)
d
) by Part 1, we get that
lim
j→∞
|σ[0,m)(w(m)
q
. . . w(m)
q+j−1)|
j
=

a∈A
u(m)
a
|σ[0,m)(a)|
and
lim
j→∞
q+j−1
i=q
|σ[0,m)(w(m)
i
)|v
j
=

a∈A
u(m)
a
|σ[0,m)(a)|v
uniformly in q ∈N.
Now we proceed similarly to Part 1. First deﬁne
m+
n = max{|σ[0,n)(a)| : a ∈A}
and
m−
n = min{|σ[0,n)(a)| : a ∈A},
and observe that primitivity of σ implies that both of these quantities tend to ∞for
n →∞. For each n ∈N choose a ﬁxed w(n) = w(n)
0 w(n)
1
. . . ∈Xσ (n). As w ∈Xσ,
for all k, ℓ∈N we can write
wk . . . wk+ℓ−1 = pσ[0,n)(w(n)
q
. . . w(n)
q+r−1)s
for some q, r ∈N, where the lengths of p, s ∈A∗are bounded by m+
n . There are
three possibilities for an occurrence of v in wk . . . wk+ℓ−1. Firstly, v can overlap
with p or s. This can happen at most 2m+
n times. Secondly, v can have nonempty
overlap with the images σ[0,n)(w(n)
i
) and σ[0,n)(w(n)
i+1) of two consecutive letters
w(n)
i
and w(n)
i+1 of w(n)
q
. . . w(n)
q+r−1. This can happen at most |v|(r −1) ≤|v| ℓ
m−n
times. Thirdly, v can occur as a factor of σ[0,n)(w(n)
i
) for some i ∈{q, . . ., q +
r −1} which happens exactly q+r−1
i=q
|σ[0,n)(w(n)
i
)|v times. Each of these three
possibilities contributes one of the summands of the right hand side of the estimate
|wk . . . wk+ℓ−1|v
ℓ
−g(v, n)
 ≤2m+
n
ℓ
+ |v|
m−n
+

q+r−1
i=q
|σ[0,n)(w(n)
i
)|v
ℓ
−g(v, n)
.
(3.30)
Letting ℓ→∞and using (3.29) for the third term on the right this yields that
lim sup
ℓ→∞
|wk . . . wk+ℓ−1|v
ℓ
−g(v, n)
 ≤|v|
m−n
.
(3.31)
Since for n →∞the quantity |wk...wk+ℓ−1|v
ℓ
does not change while |v|
m−n →0 we
conclude from (3.31) that (g(v, n))n∈N is a Cauchy sequence converging to the
frequency fv(w) of v in w. Since |v|
m−n does not depend on k and the convergence

142
J. M. Thuswaldner
in (3.29) is uniform in q, the estimate (3.30) implies that |wk...wk+ℓ−1|v
ℓ
→fv(w) for
ℓ→∞uniformly in k and the proof is ﬁnished.
⊓⊔
The following main result of this section is an immediate consequence of
Propositions 3.5.3, 3.5.9, and Lemma 3.5.10.
Theorem 3.5.11 Let σ be a sequence of substitutions with associated sequence of
incidence matrices M. If M is primitive and recurrent then (Xσ, Σ) is minimal and
uniquely ergodic.
A proof of a similar result as Theorem 3.5.11 is sketched in Berthé and
Delecroix [44]. Moreover, we refer to Fisher [81] and Bezuglyi et al. [53, 54], where
theorems of this ﬂavor are proved in the context of Bratteli-Vershik systems.
Example 3.5.12 We associate substitutions with the matrices M1, M2, and M3 that
came up in (3.23) during the deﬁnition of Brun’s continued fraction algorithm.
Indeed, the substitutions
σ1 :
⎧
⎪⎪⎨
⎪⎪⎩
1 →3,
2 →1,
3 →23,
σ2 :
⎧
⎪⎪⎨
⎪⎪⎩
1 →1,
2 →3,
3 →23,
σ3 :
⎧
⎪⎪⎨
⎪⎪⎩
1 →1,
2 →23,
3 →3.
(3.32)
are called Brun substitutions (see [52, Sections 3.3 and 9.2] where also the relation
between these substitutions and a slightly different set of “Brun substitutions”
studied in [42] is discussed).
It is immediate that M1M2M1M2 is a strictly positive matrix. Thus we get the
following result.
Proposition 3.5.13 Let S = {σ1, σ2, σ3} be the set of Brun substitutions and σ ∈
SN. If σ is recurrent and contains the block (σ1, σ2, σ1, σ2) then the associated S-
adic system (Xσ, Σ) is minimal and uniquely ergodic.
Proof Since σ is recurrent it contains the block (σ1, σ2, σ1, σ2) inﬁnitely often.
Thus σ is primitive and the result follows from Theorem 3.5.11.
⊓⊔
3.6
The Importance of Balance and Algebraic Irreducibility
Let σ be a sequence of unimodular substitutions over an alphabet A = {1, 2, . . . , d}
and let (Xσ, Σ) be the S-adic system deﬁned by it. At the end of Sect. 3.2.4 we gave
some rough idea on how we want to prove that (Xσ, Σ) is measurably conjugate
to a rotation on Td−1. Indeed, we wish to project the broken line (see (3.17) for
an example) associated with a limit sequence w ∈Xσ to a hyperplane in Rd not
containing the frequency vector u of the sequences in Xσ. On a natural subdivision
R(1), . . . , R(d) of the closure R of this projection we want to deﬁne a domain

3
S-adic Sequences
143
exchange and a rotation. This is possible only if the sets R(i), i ∈A, have suitable
topological properties and the mentioned subdivision has no essential overlaps.
In the present section we will deﬁne these sets R and R(i), i ∈A, and discuss
basic properties of them. Besides primitivity and recurrence, the crucial conditions
we will have to impose on σ in order to get suitable properties of the sets R and
R(i) will be algebraic irreducibility of the sequence of incidence matrices of σ
and balance of the language Lσ. Both of these conditions will be deﬁned and
ﬁrst consequences of them will be discussed. This paves the way to obtain deeper
topological and measure theoretic properties of R and R(i) in Sect. 3.7. The theory
we will outline in the present as well as in the forthcoming sections is mainly due
to Berthé et al. [52] and we refer to this paper for rigorous proofs of the statements
we give.
3.6.1
S-adic Rauzy Fractals
Following Berthé et al. [52, Section 2.9] we will now deﬁne S-adic Rauzy fractals.
As mentioned before, on these objects we will be able to “see” the rotations to which
we want to (measurably) conjugate our S-adic systems. In the deﬁnition we will use
the following notations. For a vector w ∈Rd \ {0} we write w⊥for the hyperplane
orthogonal to w, i.e., w⊥= {x ∈Rd : ⟨x, w⟩= 0} with ⟨·, ·⟩being the dot product
on Rd, and we equip the space w⊥with the (d −1)-dimensional Lebesgue measure
λw. Since its orthogonal hyperplane will be of special interest later we introduce the
vector 1 = (1, . . . , 1)t.
For vectors u, w ∈Rd \ {0} satisfying u ̸∈w⊥we denote the projection along u
to w⊥by πu,w.
Deﬁnition 3.6.1 (S-adic Rauzy Fractal and Subtiles)
Let σ be a sequence
of unimodular substitutions over the alphabet A and assume that σ is weakly
convergent to a generalized right eigenvector u ∈Rd
>0. The S-adic Rauzy fractal
in the representation space w⊥, w ∈Rd
≥0 \ {0}, associated with σ is the set
Rw := {πu,wl(p) : p is a preﬁx of a limit sequence of σ}.
The set Rw can be covered by the subtiles
Rw(i) := {πu,wl(p) : pi is a preﬁx of a limit sequence of σ}
(i ∈A).
(3.33)
For convenience we will use the notation R(i) = R1(i) and R = R1.
The prototype of a Rauzy fractal goes back to Rauzy [114] and was used
there in order to show that a certain substitutive dynamical system is measurably
conjugate to a rotation on the torus, see Example 3.6.2 below. In the meantime

144
J. M. Thuswaldner
there exists a vast literature on Rauzy fractals. For constant sequences σ = (σ)
with σ being a Pisot substitution fundamental properties of Rauzy fractals were
studied for instance by Ito and Kimura [89], Holton and Zamboni [86], Arnoux
and Ito [18], Canterini and Siegel [61], Sirvent and Wang [124], Hubert and
Messaoudi [88], and Ito and Rao [91]. Akiyama [2, 3] and Messaoudi [103, 104]
consider versions of Rauzy fractals for β-numeration, in Siegel [122], Minervino
and Thuswaldner [106], and Minervino and Steiner [105] Rauzy fractals with p-adic
factors are related to nonunimodular substitutions. For versions of Rauzy fractals
corresponding to substitutions with reducible incidence matrices (whose most
prominent representative is the so-called “Hokkaido Fractal” studied by Akiyama
and Sadahiro [5]) we refer to [3, 75, 100]. A case of a non-Pisot substitution is
treated in [16]. Surveys containing information on Rauzy fractals are provided in
[51, 123] (see also [4] for their relation to the Pisot substitution conjecture). An
easily accessible treatment of Rauzy fractals intended for a broad audience is given
in [17].
Recently, Boyland and Severa [57] considered a particular family of S-adic
sequences associated with the so-called inﬁmax S-adic family over three letters.
These sequences do not ﬁt into our framework. Indeed, they have two “expanding
directions” which entails that the authors have to project on a 1-dimensional
subspace of R3 in order to obtain compact Rauzy fractals. Their Rauzy fractals turn
out to be Cantor sets which can be subdivided naturally into three subtiles whose
convex hulls are intervals that intersect on their boundary points. This fact is used to
show that the inﬁmax S-adic systems can be geometrically represented as 3-interval
exchange transformations.
In what follows, instead of “S-adic Rauzy fractal” we will often just say “Rauzy
fractal”. This will cause no confusion. To give the reader a feeling for a Rauzy fractal
and its importance in the remaining part of this chapter we provide an example.
Example 3.6.2 (Tribonacci Substitution)
We explain the deﬁnition of a Rauzy
fractal for the constant sequence σ
= (σ)n∈N with σ being the Tribonacci
substitution introduced in (3.20). The sequence σ is easily checked to be primitive
and obviously it is recurrent. Thus it admits a generalized right eigenvector u which
is just the Perron-Frobenius eigenvector of Mσ. Since each of the words σ(1), σ(2),
and σ(3) begins with 1 the only limit sequence of (σ) is given by
w = lim
n→∞σ n(1) = 1213121121312121312112131213121 . . .
and, hence, Rw := {πu,wl(p) : p is a preﬁx of w} for w ∈Rd
≥0 \ {0}. In Fig. 3.11
we illustrate the deﬁnition of Ru and its subtiles (we choose w = u in this case
so the occurring projection πu,u is an orthogonal projection). As mentioned before,
this famous prototype of a Rauzy fractal ﬁrst appears in Rauzy [114].
For this example it is known since Rauzy [114] that one can deﬁne a rotation
on the Rauzy fractal using the broken line. This can be used to prove that the
substitutive system (X(σ), Σ) is measurably conjugate to a rotation on T2. We want
to give an idea on how this works without going into the details. To this end it is

3
S-adic Sequences
145
Fig. 3.11 The broken line and its projection to u⊥deﬁning the Rauzy fractal Ru for the case of the
Tribonacci substitution (note that only the vertices of the broken line are projected; not the whole
edges). Each of the three subtiles Ru(i) is shaded differently. The shaded triangle represents a part
of the plane u⊥in which Ru is situated
convenient to work with R = R1 and its subtiles. It was shown in [114] that each
of the three subtiles R(i), i ∈{1, 2, 3}, is a compact subset of the space 1⊥which
is equal to the closure of its interior and has a boundary of λ1-measure 0. Moreover,
it is proved that these subtiles are pairwise disjoint apart from overlaps on their
boundaries. Thus we can almost everywhere deﬁne a “domain exchange” E in the
following way. If we set
˜R(i) := {πu,1l(pi) : pi is a preﬁx of w}
(i ∈{1, 2, 3})
we see from the deﬁnition of R(i) that ˜R(i) = R(i) + πu,1l(i) (recall that w is
the only limit sequence of σ). As the Lebesgue measure λ1 doesn’t change under
translation and we still have that R = ˜R(1)∪˜R(2)∪˜R(3) also the translated pieces
only overlap on a set of measure 0. The domain exchange
E : R →R;
x →x + πu,1l(i)
for x ∈R(i)
is thus well deﬁned almost everywhere and it moves R(i) to ˜R(i) for each i ∈
{1, 2, 3}. By what was said above, E is an almost everywhere bijective symmetry.
The effect of E on the points of R is illustrated in Fig. 3.12. As in the Sturmian case
discussed in Sect. 3.2.4, each step on the broken line performs the domain exchange
on R.
The problem that remains is the transition from the domain exchange to the
rotation. In the Sturmian case this was achieved by identifying the endpoints of an
interval. Here things become more complicated as intervals are replaced by fractals
and we have to make identiﬁcations on ∂R.
To settle this, Rauzy [114] proved that R forms a fundamental domain of the
lattice
Λ = (πu,1l(1) −πu,1l(2))Z ⊕(πu,1l(1) −πu,1l(3))Z,

146
J. M. Thuswaldner
Fig. 3.12 The domain exchange on the classical Rauzy fractal associated with the Tribonacci
substitution: the bright domain R(1) is translated by πu,1l(1), the darker domain R(2) is translated
by πu,1l(2), and ﬁnally the darkest domain R(3) is translated by πu,1l(3). The union of the
translated domains gives R again
i.e., it forms a tiling of 1⊥when translated by elements of Λ. Thus R can be
seen as a subset of the 2-torus 1⊥/Λ and since it is a fundamental domain of Λ it
covers the torus without overlaps (apart from the boundary). This gives the desired
identiﬁcations on ∂R. If we look at the domain exchange on this torus we see that
πu,1l(i) ≡πu,1l(j) (mod Λ) holds for i, j ∈{1, 2, 3}. Thus on this torus all the
translations performed by the domain exchange E become the same and, hence, on
the torus the mapping E induces a rotation by πu,1l(1). One can show (by deﬁning
a suitable “representation map” for the elements of X(σ) on the torus 1⊥/Λ) that
(X(σ), Σ) is measurably conjugate to (1⊥/Λ, + πu,1l(1)), which is a rotation on
the 2-torus. We also refer to [52, Section 8] where rigorous arguments are given in
a general context (a sketch of these arguments is provided in Sect. 3.9.2 below).
In the preceding example various properties of the Rauzy fractal were needed
in order to get the measurable conjugacy between the substitutive system and the
rotation. Our aim is to establish these conditions for S-adic Rauzy fractals under a
set of natural conditions. Since tiling properties of S-adic Rauzy fractals will play
an important role we will now deﬁne some collections of Rauzy fractals that will
later be shown to provide tilings in the following sense.
Deﬁnition 3.6.3 (Multiple Tiling and Tiling)
A collection K of subsets of a
Euclidean space E is called a multiple tiling of E if each element of K is a compact
set which is equal to the closure of its interior, and if there is m ∈N such that almost
every point (w.r.t. Lebesgue measure) of E is contained in exactly m elements of K.
If m = 1 then a multiple tiling is called a tiling.
The collections of tiles we need in our setting are deﬁned in terms of so-called
discrete hyperplanes. These objects were ﬁrst deﬁned and studied in the context
of theoretical computer science (see [115] and later [7, 93]) and have interesting

3
S-adic Sequences
147
connections to generalized continued fraction algorithms (cf. e.g. [45, 79, 80, 90,
92]). The formal deﬁnition reads as follows. Pick w ∈Rd
≥0 \ {0}, then (setting
ei = l(i) for i ∈A)
Γ (w) = {[x, i] ∈Zd × A : 0 ≤⟨x, w⟩< ⟨ei, w⟩}.
This has a geometrical meaning: if we interpret the symbol [x, i] ∈Zd × A as the
hypercube or “face”
[x, i] =

x +

j∈A\{i}
λjej : λj ∈[0, 1]

,
(3.34)
the set Γ (w) turns into a “stepped hyperplane” that approximates w⊥by hyper-
cubes. In Fig. 3.13 this is illustrated for two cases: for a rational vector w, which
leads to a periodic pattern and for an irrational vector w which yields an aperiodic
one. A ﬁnite subset of a discrete hyperplane will often be called a patch.
Using the concept of discrete hyperplane we deﬁne the following collections
of Rauzy fractals. Let σ be a sequence of substitutions with generalized right
eigenvector u ∈Rd
>0 and choose w ∈Rd
≥0 \{0}. Then, following [52, Section 2.10],
we set
Cw = {πu,wx + Rw(i) : [x, i] ∈Γ (w)}.
(3.35)
As mentioned above, we will see that each of these collections forms a tiling of the
space w⊥under natural conditions. A special role will be played by the collection
C1 which will give rise to a periodic tiling of 1⊥by lattice translates of the Rauzy
fractal R.
Fig. 3.13 Examples of stepped planes. On the left hand side the stepped plane Γ (1), on the right
hand side Γ (u) with u as in Example 3.6.2. Since 1 is rational the stepped plane Γ (1) is periodic,
while the irrationality of u leads to an aperiodic structure in Γ (u)

148
J. M. Thuswaldner
3.6.2
Balance, Algebraic Irreducibility, and Strong
Convergence
Let (Xσ, Σ) be an S-adic system. As we mentioned already, the associated Rauzy
fractals can be used to prove that (Xσ, Σ) is measurably conjugate to a rotation on
a torus provided that they have suitable properties. In the present section we will
discuss two conditions that have to be imposed on σ in order to guarantee that each
of the associated Rauzy fractals Rw, w ∈R≥0 \ {0}, as well as each of their subtiles
Rw(i), i ∈A, is a compact set that is the closure of its interior and has a boundary
of zero measure λw.
The ﬁrst property is balance and as we will see immediately it entails com-
pactness of Rw and its subtiles (see e.g. [1, 44] or [52, Section 2.4] for similar
deﬁnitions).
Deﬁnition 3.6.4 (Balance)
Let A be an alphabet and consider a pair of words
(u, v) ∈A∗× A∗of the same length. If there is C > 0 such that
|v|i −|u|i
 ≤C
holds for each letter i ∈A, the pair (u, v) is called C-balanced. A language L ⊂A∗
is called C-balanced if each pair (u, v) ∈L × L with |u| = |v| is C-balanced. It is
called ﬁnitely balanced if it is C-balanced for some C > 0.
In Deﬁnition 3.2.3 and in Sect. 3.3.2 we deﬁned balance of an inﬁnite sequence
and applied this notion to Sturmian sequences as well as to Arnoux-Rauzy
sequences. For a general S-adic system (Xσ, Σ) it is more convenient to look
at balance of the associated language Lσ since there might be more than one
limit sequence associated with the given directive sequence σ. Of course, by
Proposition 3.5.3(ii) primitivity of σ implies that each of these limit sequences has
the language Lσ of factors.
The following result goes back essentially to [1, Proposition 7] and, in the form
we present it here, is contained in [52, Lemma 4.1] (in fact, the conditions that are
imposed on σ in that paper are slightly weaker than ours).
Proposition 3.6.5 Let σ be a primitive and recurrent sequence of unimodular
substitutions. Then Rw and each of its subtiles is compact for each w ∈Rd
≥0 \ {0}
if and only if Lσ is ﬁnitely balanced.
Proof Since Rw as well as each of its subtiles is closed by deﬁnition it sufﬁces to
prove that
Rw is bounded for each w ∈Rd
≥0 \ {0}
⇐⇒
Lσ is ﬁnitely balanced.
(3.36)
We start with proving (3.36) for the case w = 1 and follow [52]. Let u be a
generalized right eigenvector for σ which exists by Proposition 3.5.5.
If R is bounded then there is C
> 0 such that ∥πu,1l(p)∥∞
≤C for
each preﬁx of a limit sequence of σ. Let u, v ∈Lσ be of equal length. Then,
by primitivity these words are factors of a limit sequence which entails that

3
S-adic Sequences
149
∥πu,1l(u)∥∞, ∥πu,1l(v)∥∞≤2C. As l(u) −l(v) ∈1⊥this yields ∥l(u) −l(v)∥∞=
∥πu,1l(u) −πu,1l(v)∥∞≤4C and, hence, Lσ is 4C-balanced.
Assume now that Lσ is C-balanced and let w be a limit sequence of σ. Let p
be a preﬁx of w and write w = v0v1 . . . where vk ∈A∗with |vk| = |p| for each
k ≥0. By C-balance, ∥πu,1l(vk) −πu,1l(p)∥∞≤C for each k ∈N and, hence,


 1
n
n−1
k=0 πu,1l(vk)−πu,1l(p)


∞≤C for each n ∈N. By Lemma 3.5.10 (see proof
of Part 1), the letter frequencies of w are given by the entries of the vector u/∥u∥1
which implies that limn→∞1
n
n−1
k=0 πu,1l(vk) = 0 and thus
∥πu,1l(p)∥∞=




 lim
n→∞
1
n
n−1

k=0
πu,1l(vk) −πu,1l(p)




∞
≤C.
This ﬁnishes the proof of (3.36) for the case w = 1. The full statement (3.36)
follows from this because Rw = πu,wR, which implies that R is bounded if and
only if Rw is bounded for each w ∈Rd
≥0 \ {0}.
⊓⊔
Our next aim is to make sure that Rw(i) has nonempty interior for each w ∈
Rd
≥0 \ {0} and each i ∈A. This will require much more work. In a ﬁrst step
observe that we have no hope to get nonempty interior if u has coordinates which are
rationally dependent, i.e., if there is x ∈Zd such that ⟨x, u⟩= 0. Indeed, in this case
the set Rw is contained in a ﬁnite union of proper afﬁne subspaces of w⊥. We wish
to exclude this case ﬁrst. This is related to an irreducibility property (going back to
[52, Section 2.2]) of the underlying set of incidence matrices which we deﬁne now.
Deﬁnition 3.6.6 (Algebraic Irreducibility)
Let M = (Mn) be a sequence of
nonnegative integer matrices. We say that M is algebraically irreducible if for each
m ∈N there is n > m such that the characteristic polynomial of M[m,ℓ) is irreducible
for each ℓ≥n.
A sequence σ of substitutions is called algebraically irreducible if it has a
sequence of incidence matrices which is algebraically irreducible.
Remark 3.6.7 For our purposes we can replace algebraic irreducibility by the
weaker condition that for each m ∈N the matrix Mm is regular and there is n > m
such that M[m,ℓ) does not have 1 as eigenvalue for each ℓ≥n. This condition is
easier to check than algebraic irreducibility.
However, since we will always have to assume balance in our setting all but
the dominant eigenvalue of large blocks M[m,ℓ) should be inside the closed unit
disk anyway (cf. also the deﬁnition of the Pisot condition in (3.59)). Thus this new
condition is not essentially weaker than algebraic irreducibility. For this reason we
work with algebraic irreducibility in the sequel.
Together with other properties, algebraic irreducibility of σ implies rational
independence of the right eigenvector. We announce this in the following lemma,
whose elegant proof is taken from [52, Lemma 4.2].

150
J. M. Thuswaldner
Lemma 3.6.8 Let σ be an algebraically irreducible sequence of substitutions with
ﬁnitely balanced language Lσ that admits a generalized right eigenvector u ∈Rd
≥0\
{0}. Then u has rationally independent coordinates.
Proof The proof is done by contradiction. Assume that u has rationally dependent
coordinates. Then there is x ∈Zd \ {0} such that ⟨x, u⟩= 0. This implies that
⟨(M[0,n))tx, ei⟩= ⟨x, M[0,n)ei⟩= ⟨x, lσ[0,n)(i)⟩= ⟨x, πu,1lσ[0,n)(i)⟩is uniformly
bounded in i ∈A and n ∈N by balance of Lσ . Thus (M[0,n))tx ∈Zd is bounded
and, hence, there exists an integer k and inﬁnitely many ℓ> k with (M[0,k))tx =
(M[0,ℓ))tx. Multiplying by ((M[0,k))t)−1 we see that x is an eigenvector of (M[k,ℓ))t
with eigenvalue 1. Since ℓcan be chosen arbitrarily large this contradicts algebraic
irreducibility.
⊓⊔
In Deﬁnition 3.5.6 the concept of weak convergence of a sequence of matrices
is introduced. In what follows, we will need a stronger form of convergence, viz.
strong convergence. If we look back to Lemma 3.2.12 we see that the cascade of
inductions we perform on the interval leads to smaller and smaller intervals (that are
blown up by renormalization) whose lengths tend to 0. To get an analogous behavior
on S-adic Rauzy fractals we need to introduce a certain subdivision on them whose
pieces have a diameter that tends to zero. It will turn out that strong convergence is
the right condition to guarantee this behavior. We thus recall the deﬁnition of strong
convergence which is well known in the theory of generalized continued fraction
algorithms (see e.g. [119, Deﬁnition 19]) and then derive it from the conditions we
introduced so far.
Deﬁnition 3.6.9 (Strong Convergence)
We say that a sequence M = (Mn) of
nonnegative integer matrices is strongly convergent to u ∈Rd
≥0 \ {0} if
lim
n→∞πu,1M[0,n)ei = 0
for all i ∈A.
If σ has a strongly convergent sequence of incidence matrices we say that σ is
strongly convergent.
The difference between weak and strong convergence is explained and illustrated
in Fig. 3.14: while weak convergence of vectors can be seen on the unit ball, strong
convergence takes place at their end points.
M[0,n) e1
M[0,n) e2
u
Fig. 3.14 The sequence M = (Mn) of matrices is weakly convergent, if the intersections of
M[0,n)ei with the unit ball converge to the intersection of the generalized right eigenvector u with
the unit ball. It is strongly convergent, if the minimal distance of the point M[0,n)ei to the ray R+u
converges to zero for each i ∈A. Summing up: weak convergence takes place on the unit ball
while strong convergence concerns the end points of the vectors

3
S-adic Sequences
151
The following result on strong convergence will be needed in the sequel. It is the
content of [52, Proposition 4.3].
Proposition 3.6.10 Let σ be a primitive, algebraically irreducible, and recurrent
sequence of substitutions with ﬁnitely balanced language Lσ. Then
lim
n→∞sup{∥πu,1M[0,n)l(v)∥∞: v ∈L(n)
σ } = 0.
By primitivity this implies that σ is strongly convergent.
The proof of this result is quite tricky. We give a sketch to illustrate the ideas and
refer to [52, Proposition 4.3] for details.
Proof (Sketch) Let w be a limit sequence of σ. By primitivity we may apply Propo-
sition 3.5.3(ii) to the shifted sequence (σn, σn+1, σn+2, . . .). Thus the language L(n)
σ
is equal to the language L(w(n)) of factors of the nth “desubstitution” w(n) of w (see
(3.22)), i.e., each v ∈L(n)
σ
satisﬁes l(v) = l(p) −l(q), where p and q are preﬁxes
of w(n). Thus it sufﬁces to prove
lim
n→∞sup{∥πu,1M[0,n)l(p)∥∞: p is a preﬁx of w(n)} = 0.
(3.37)
Let (in) be the sequence of ﬁrst letters of w(n) and choose ε > 0 arbitrary.
Deﬁne the sets Sn
=
{πu,1l(p)
:
p is a preﬁx of σ[0,n)(in)} and
˜R
:=
{πu,1l(p) : p is a preﬁx of w}.
Then Sn →
˜R for n →∞in Hausdorff metric. Since, on the other hand,
πu,1M[0,n)l(p) + Sn ⊂˜R holds for each p ∈A∗such that pin is a preﬁx w(n)
we obtain
∥πu,1M[0,n)l(p)∥∞< ε
(3.38)
for each p ∈A∗such that pin is a preﬁx w(n) for a large enough n. We have to prove
(3.38) for arbitrary preﬁxes p of w(n). If N(p) = {n ∈N : pin is a preﬁx of w(n)}
is inﬁnite then (3.38) yields
lim
n∈N(p), n→∞∥πu,1M[0,n)l(p)∥∞= 0.
(3.39)
Using algebraic irreducibility and balance by some tricky arguments it is now
possible to ﬁnd a set P of preﬁxes of w such that the abelianizations l(P) contain a
basis of Rd and N(P) = 0
p∈P N(p) is an inﬁnite set (moreover, the elements of P
can by “synchronized” in a certain way by using the recurrence of σ). This implies
that (3.39) is true for each p ∈P when N(p) is replaced by N(P), i.e.,
lim
n∈N(P), n→∞∥πu,1M[0,n)l(p)∥∞= 0
(p ∈P).

152
J. M. Thuswaldner
Since l(P) contains a basis of Rd we gain
lim
n∈N(P), n→∞∥πu,1M[0,n)x∥∞= 0
(x ∈Rd).
(3.40)
Using primitivity and recurrence again, Eq. (3.37) can be obtained using (3.38) and
(3.40). This again requires some work and we omit the details.
⊓⊔
3.7
Properties of S-adic Rauzy Fractals
Based on the results of the previous section we will now study deeper properties of
S-adic Rauzy fractals. In particular, the present section is devoted to the illustration
of the proof of the following result from Berthé et al. [52, Theorem 3.1 (ii)].
Theorem 3.7.1 Let S be a ﬁnite set of unimodular substitutions over a ﬁnite
alphabet A and let σ = (σn) be a primitive and algebraically irreducible sequence
of substitutions taken from the set S. Assume that there is C > 0 such that for every
ℓ∈N there exists n ≥1 such that (σn, . . . , σn+ℓ−1) = (σ0, . . . , σℓ−1) and the
language L(n+ℓ)
σ
is C-balanced.
Then each subtile R(i), i ∈A, of the Rauzy fractal R is a nonempty compact
set which is equal to the closure of its interior and has a boundary whose Lebesgue
measure λ1 is zero.
Remark 3.7.2
(i) We can see that the assumptions of this theorem contain all the properties
we discussed in the previous subsections. We could have used the stronger
assumption that σ is primitive, recurrent, algebraically irreducible, and has C-
balanced language L(n)
σ
for each n ∈N. However, although this assumption
is more handy and holds for many natural examples it would lead to a
measure zero subset of the set of “all” sequences σ. The conditions we give
in Theorem 3.7.1 will turn out to be “generic” in the sense that they are true
for “almost all” sequences σ. All this will be made precise when we develop a
metric counterpart of our theory in Sect. 3.9.3.
(ii) Let σ be a substitution on the alphabet A. It is easy to prove that for each
C > 0 there is C′ > 0 such that σ(w) is C′-balanced for each C-balanced
sequence w ∈AN. Applying this to the substitution σ = σ[0,n+ℓ) for some
n, ℓwith balanced language L(n+ℓ)
σ
we see that we can choose the constant C
in Theorem 3.7.1 in a way that also Lσ is C-balanced. We will always assume
that C is chosen in this way in the sequel.
(iii) We conﬁne ourselves to ﬁnite sets S of substitutions to keep things as simple
as possible. With a bit more effort it is possible to generalize Theorem 3.7.1
to inﬁnite sets S. This is of interest because inﬁnite sets S correspond to
multiplicative continued fraction algorithms like the important Jacobi-Perron
algorithm or an acceleration of the Arnoux-Rauzy algorithm proposed recently
by Avila et al. [30]. This more general setting is treated in [52].

3
S-adic Sequences
153
Theorem 3.7.1 will enable us to study tiling properties of Rw and its subtiles
which will ﬁnally lead to the measurable conjugacy of (Xσ, Σ) to a rotation.
The proof of Theorem 3.7.1 is quite long and technical and we refer to [52,
Section 6] for details. Our aim here is to illustrate the main ideas in a way that is
hopefully more accessible to a broader readership than the original research paper.
First we will establish a set equation for the subtiles Rw(i), i ∈A, of Rw that
governs certain subdivisions of Rw(i). Using this set equation we will be able to
establish the properties of S-adic Rauzy fractals stated in Theorem 3.7.1.
Theorem 3.7.1 has a number of predecessors. For instance, Lagarias and
Wang [96] proved that each self-afﬁne tile T is the closure of its interior and ∂T
has Lebesgue measure zero. For substitutive Rauzy fractals the according result was
proved by Sirvent and Wang [124]. However, in all these cases the sets have strong
self-afﬁnity properties which are no longer present in our setting. We therefore need
new ideas and more efforts to get the desired results (in particular, the proof of the
fact that the boundary of an S-adic Rauzy fractal has measure zero will need quite
some work).
3.7.1
Set Equations for S-adic Rauzy Fractals and Dual
Substitutions
The ﬁrst important tool in the proof of Theorem 3.7.1 will be a set equation for
the subtiles Rw(i), w ∈Rd
≥0 \ {0} and i ∈A, of a sequence σ of unimodular
substitutions as well as for related subtiles associated with “shifts” of σ. This set
equation equips the sets Rw(i) with a subdivision structure that is governed by σ.
We now give an idea on how this works.
Let σ = (σn) be a primitive and recurrent sequence of unimodular substitutions
over the alphabet A with generalized right eigenvector u ∈Rd
>0 and choose w ∈
Rd
≥0 \ {0}. In all what follows, keep in mind the deﬁnition of the subtile Rw(i) from
(3.33). We choose a limit sequence w of σ and associate with it the sequence (w(n))
of its “desubstitutions” according to (3.22).
Consider the set {πu,wl(p)
:
pi is a preﬁx of w} and observe that by the
deﬁnition of a limit sequence each p ∈A∗for which pi is a preﬁx of w can be
written as p = σ0(p′)p0 with p0i a preﬁx of σ0(j) for some j ∈A and p′j some
preﬁx of w(1). Using this decomposition of p we obtain the decomposition
{πu,wl(p) : pi is a preﬁx of w} =

j∈A, p0∈A∗
σ0(j)=p0iA∗
{πu,wl(p0) + πu,w(lσ0(p′)) : p′j is a preﬁx of w(1)}.
(3.41)

154
J. M. Thuswaldner
From (3.21) we see that lσ0(p′) = M0l(p′). Moreover, direct calculation (see [52,
Lemma 5.2]) yields that πu,wM0 = M0πM−1
0 u,Mt
0w. Inserting this in (3.41) we gain
{πu,wl(p) : pi is a preﬁx of w} =

j∈A, p0∈A∗
σ0(j)=p0iA∗
πu,wl(p0) + M0{πM−1
0 u,Mt
0wl(p′) : p′j is a preﬁx of w(1)}.
Taking the union over all (ﬁnitely many, by Proposition 3.5.3) limit sequences of σ
and taking the closure we obtain by (3.33) that
Rw(i) =

j∈A, p0∈A∗
σ0(j)=p0iA∗
πu,wl(p0)+
M0{πM−1
0 u,Mt
0wl(p′) : p′j is a preﬁx of some limit sequence of (σn+1)}.
(3.42)
We now inspect the closures in the union in (3.42). Looking at the deﬁnition of
subtiles in (3.33) we see that these are subtiles of the Rauzy fractal corresponding to
the shifted sequence (σn+1)n≥0 of σ. Indeed, it follows from Proposition 3.5.5 that
M−1
0 u is the right eigenvector of this shifted sequence. This motivates the following
deﬁnitions.
For k ∈N let
π(k)
u,w = πM−1
[0,k)u,Mt
[0,k)w,
(3.43)
denote the subtiles of the shifted sequence of substitutions (σn+k)n∈N which live in
the hyperplane (Mt
[0,k)w)⊥by
R(k)
w (i) := {π(k)
u,wl(p′) : p′j is a preﬁx of some limit sequence of (σn+k)n∈N},
(3.44)
and set R(k)
w
=

i∈A R(k)
w (i). Together with these notations (3.42) can be
generalized by using similar arguments as we used in its proof. The generalized
form of (3.42) reads as follows (for a detailed proof see [52, Proposition 5.6]).
Proposition 3.7.3 (The Set Equation)
Let σ be a primitive and recurrent
sequence of unimodular substitutions with generalized right eigenvector u. Then for
each [x, i] ∈Zd × A and every k, ℓ∈N with k < ℓwe have
π(k)
u,wx + R(k)
w (i) =

[y,j]∈E∗
1(σ[k,ℓ))[x,i]
M[k,ℓ)(π(ℓ)
u,wy + R(ℓ)
w (j)),
(3.45)

3
S-adic Sequences
155
where
E∗
1(σ)[x, i] = {[M−1
σ (x + l(p)), j] : j ∈A, p ∈A∗, pi preﬁx of σ(j)}.
(3.46)
The elements in the union on the right hand side of (3.45) are called the level
(ℓ−k) subtiles of π(k)
u,wx+R(k)
w (i). The collection of all the elements in the union is
called the (ℓ−k)-th subdivision of π(k)
u,wx + R(k)
w (i). This will often be applied for
the case k = 0. In Fig. 3.16 the set equation is illustrated for the situation discussed
in Example 3.7.8.
The dual geometric realization E∗
1(σ) of a substitution σ deﬁned in (3.46) will
turn out to be useful when we deﬁne so-called coincidence conditions in Sect. 3.8.2.
If we regard the pairs [x, i] as hypercubes as we did in (3.34) this dual also has a
geometric meaning. We explain this in the following example.
Example 3.7.4 Let σ be the Tribonacci substitution deﬁned in (3.20). Then by direct
computation we see that E∗
1(σ) is given by
E∗
1(σ)[0, 1] = {[0, 1], [0, 2], [0, 3]},
E∗
1(σ)[0, 2] = {[(0, 0, 1)t, 1]},
E∗
1(σ)[0, 3] = {[(0, 0, 1)t, 2]}
together with the obvious fact that E∗
1(σ)[x, i] = M−1
σ x + E∗
1(σ)[0, i]. One can
extend the deﬁnition of E∗
1(σ) to subsets of Y ⊂Zd × A in a natural way by setting
E∗
1(σ)Y =

[x,i]∈Y
E∗
1(σ)[x, i].
Using this extension we can then iterate E∗
1(σ). The geometric interpretation of
E∗
1(σ)12[0, 1] is depicted in Fig. 3.15. It is not by accident that this image is a good
approximation of (an afﬁne image of) the classical Rauzy fractal corresponding to σ
depicted in Fig. 3.12. In fact, E∗
1(σ) can even be used to give an alternative deﬁnition
of R, see for example [18, 51].
The dual E∗
1(σ) and its higher dimensional generalizations have been investi-
gated thoroughly in connection with the study of substitutive dynamical systems and
their Rauzy fractals (see [18, 51, 74, 91, 100, 117]). We need a result of Fernique [79]
that shows how E∗
1(σ) behaves with respect to discrete hyperplanes. Before we state
it we introduce some notation. Let σ be a sequence of substitutions with generalized
right eigenvector u ∈Rd
>0 and let a ﬁxed vector w ∈Rd
≥0 \ {0} be given (such that
the Rauzy fractal Rw can be deﬁned). Then, motivated by the projections (3.43) we
needed in the formulation of the set equation we set
u(k) = (M[0,k))−1u,
w(k) = (M[0,k))tw
(k ∈N).
(3.47)

156
J. M. Thuswaldner
Fig. 3.15 An approximation
of R using E∗
1(σ)
Lemma 3.7.5 Let σ = (σn) be a sequence of unimodular substitutions. Then for
all k < ℓthe following assertions hold.
(i) M[k,ℓ)(w(ℓ))⊥= (w(k))⊥,
(ii) E∗
1(σ[k,ℓ))Γ (w(k)) = Γ (w(ℓ)),
(iii) for distinct pairs [x, i], [x′, i′] ∈Γ (w(k)) the images E∗
1(σ[k,ℓ))[x, i] and
E∗
1(σ[k,ℓ))[x′, i′] are disjoint patches of Γ (w(ℓ)).
Proof Assertion (i) is an immediate consequence of the deﬁnition of w(k), asser-
tions (ii) and (iii) are the content of [79, Theorem 1]. Their proof is a bit tedious,
however, it just uses the deﬁnition of discrete hyperplane and checks the required
conditions (assertion (iii) is essentially already contained in [18, Lemma 3]).
⊓⊔
Combining Proposition 3.7.3 and Lemma 3.7.5 we get the following result in
which we use the notation
C(k)
w = {πu,wx + R(k)
w (i) : [x, i] ∈Γ (w(k))}
(k ∈N)
for the collection of subtiles associated with the shifted sequence (σn+k)n∈N of σ.
Proposition 3.7.6 Let σ be a primitive and recurrent sequence of unimodular
substitutions with generalized right eigenvector u. Then for each [x, i] ∈Zd × A
and every k, ℓ∈N with k < ℓwe have

[x,i]∈Γ (w(k))
πu,wx + R(k)
w (i) =

[y,j]∈Γ (w(ℓ))
M[k,ℓ)(π(ℓ)
u,wy + R(ℓ)
w (j)).

3
S-adic Sequences
157
The collection M[k,ℓ)C(ℓ)
w is a reﬁnement of C(k)
w in the sense that each element of the
latter is a ﬁnite union of elements of the former.
The following lemma shows that the set equation subdivides Rauzy fractals into
sets whose diameter eventually tends to zero (see [52, Lemma 5.5]).
Lemma 3.7.7 Let σ = (σn) ∈SN be a primitive, algebraically irreducible, and
recurrent sequence of unimodular substitutions with balanced language Lσ , and let
w ∈Rd
≥0 \ {0}. Then
lim
n→∞M[0,n)R(n)
w = {0}.
Proof As M[0,n)π(n)
u,w = πu,w M[0,n) and πu,w = πu,w πu,1, we conclude that
M[0,n)π(n)
u,w l(v) = πu,w πu,1 M[0,n) l(v) for all v ∈L(n)
σ . Now, the result follows
from Proposition 3.6.10 and the deﬁnition of R(n)
w in (3.44).
⊓⊔
We explain the concepts and results of this section in the next example.
Example 3.7.8 Recall the deﬁnition of the Arnoux-Rauzy substitutions σ1, σ2, σ3
from (3.18) and consider a sequence
σ = (σ1, σ2, σ3, σ1, σ2, σ3, σ1, σ2, σ3, . . . ),
where the dots “. . . ” mean that the sequence is continued in a way that σ is primitive
and recurrent.
If we start with three blocks of the form σ1, σ2, σ3 it turns out that Rw is close to
the classical Rauzy fractal studied in Example 3.6.2 in Hausdorff metric, which, of
course, doesn’t say anything about its topological properties or tiling properties; we
just did it this way to get nice pictures in Fig. 3.16.
In Fig. 3.16a we show a patch P0 of the collection Cw (for some convenient vector
w ∈R3
≥0 \ {0}) of subtiles associated with σ, while Fig. 3.16b shows a patch P1 of
the collection C(1)
w associated with the shifted sequence
σ (1) = (σ2, σ3, σ1, σ2, σ3, σ1, σ2, σ3, . . . ).
Note that, since w and w(1) are not collinear, these patches live in two different
planes which is illustrated in Fig. 3.16c.
In this setting, the set equation in Proposition 3.7.3 says that each element of the
collection Cw can be viewed as the union of elements from M0C(1)
w . In other words,
if we take the patch P1 depicted in Fig. 3.16b and apply the linear mapping M0 to it,
the resulting patch M0P1 lies in the same plane w⊥as the collection Cw and some
elements of P0 are unions of elements from M0P1. In Fig. 3.16d this is illustrated:
the image of the patch P1 from Fig. 3.16b under the mapping M0 is subdividing
some parts of P0. Figure 3.16e illustrates that, according to Proposition 3.7.6, each
element of Cw is a union of elements from M0C(1)
w .

158
J. M. Thuswaldner
(a)
(b)
(c)
)
e
(
)
d
(
Fig. 3.16 Illustration of the set equation. (a) shows a patch P0 of the collection Cw = C(0)
w , (b)
shows a patch P1 of C(1)
w . In (c) P0 and P1 are drawn together to illustrate that they lie in different
planes. In (d) the matrix M0 is applied to P1: the image M0P1 is located in the same plane as P0
and forms a subdivision of tiles of P0. The subdivision of P0 in patches of M0C(1)
w is shown in (e)
for the whole patch P0
Note that in Fig. 3.16 the collections Cw and C(1)
w
are depicted as tilings and the
patches of M0C(1)
w subdivide the elements of Cw without overlap. This is the situation
we “dream” of. So far, we only know that elements of Cw are unions of elements of
M0C(1)
w . To realize this ideal situation we need to work more.
3.7.2
An S-adic Rauzy Fractal Is the Closure of Its Interior
The present section is devoted to the interior of the subtiles. We start with a covering
result taken from [52, Proposition 6.2]. In its statement we use the following

3
S-adic Sequences
159
terminology. Let K be a collection of subsets of a set D. The covering degree of
K (in D) is the largest number m having the property that each x ∈D is contained
in at least m elements of K.
Lemma 3.7.9 Let σ be a sequence of unimodular substitutions and w ∈R≥0 \
{0}. If σ is primitive, recurrent, algebraically irreducible, and has ﬁnitely balanced
language Lσ then C(n)
w
covers (w(n))⊥with ﬁnite covering degree for each n ∈N.
The covering degree of C(n)
w increases monotonically with n.
Proof We prove the covering property for Cw. The covering property for C(n)
w
as
well as the monotonicity of the covering degree follow from this by the set equation
in Proposition 3.7.3.
By Proposition 3.7.6 with the choices k = 0 and ℓ= n ≥n0 we know that

T ∈Cw
T =

n≥n0

T ∈C(n)
w
M[0,n)T =

n≥n0

[y,j]∈Γ (w(n))
M[0,n)(π(n)
u,wy + R(n)
w (j))
(3.48)
holds for each n0 ∈N. Because Cw is a locally ﬁnite collection of compact sets
it sufﬁces to show that 
T ∈Cw T is dense in w⊥. To prove this we show that the
right hand side of (3.48) is dense in w⊥for each n0 ∈N. To see this note that by
the deﬁnition of the discrete hyperplane Γ (w(n)) the set of translates in this union
satisﬁes (recall from (3.47) that w(n) = (M[0,n))tw)
{M[0,n)π(n)
u,wy : [y, j] ∈Γ (w(n))} =
{πu,wM[0,n)y : y ∈Zd, 0 ≤⟨y, (M[0,n))tw⟩≤max
i∈A⟨ei, (M[0,n))tw⟩} =
{πu,wz : z ∈Zd, 0 ≤⟨z, w⟩≤max
i∈A⟨M[0,n)ei, w⟩}.
As u has rationally independent coordinates by Lemma 3.6.8, the set
{πu,wz : z ∈Zd, 0 ≤⟨z, w⟩}
is dense in w⊥. Since maxi∈A⟨M[0,n)ei, w⟩→∞for n →∞by primitivity, this
yields that

n≥n0

[y,j]∈Γ (w(n))
M[0,n)π(n)
u,wy = {πu,wz : z ∈Zd, 0 ≤⟨z, w⟩}.
(3.49)
is dense in w⊥for each n0
∈
N. Because n0 was arbitrary, and the limit
limn→∞M[0,n)R(n)
w (i) = {0} by Lemma 3.7.7 this implies that the right hand side
of (3.48) is dense in w⊥for each n0 ∈N and we are done.
⊓⊔
From this result we get the assertion on the interiors of S-adic Rauzy fractals.

160
J. M. Thuswaldner
Proposition 3.7.10 Let σ be a sequence of unimodular substitutions over the
alphabet A and w ∈R≥0\{0}. If σ is primitive, recurrent, algebraically irreducible,
and has ﬁnitely balanced language Lσ, then R(i) is the closure of its interior for
each i ∈A.
Proof Choose some w ∈R≥0 \ {0}. By Lemma 3.7.9 the collection C(n)
w is a locally
ﬁnite covering of (w(n))⊥by compact sets for each n ∈N. Thus by Baire’s theorem
for each n ∈N there is in ∈A such that int(R(n)
w (in)) ̸= ∅. By primitivity of σ
the set equation in Proposition 3.7.3 implies that each R(n)
w (i) contains R(k)
w (ik) for
some k > n. Thus for each n ∈N and each i ∈A we have int(R(n)
w (i)) ̸= ∅.
For each i ∈A and each n ∈N, Proposition 3.7.3 yields a subdivision of Rw(i)
in translates of sets of the form M[0,n)R(n)
w (j), j ∈A. The diameters of these sets
tend to 0 by Lemma 3.7.7. Since they all contain inner points, the set of inner points
of Rw(i) is dense in Rw(i). In other words, Rw(i) is the closure of its interior. The
result now follows by taking w = 1.
⊓⊔
3.7.3
The Generalized Left Eigenvector
Let σ be a primitive and recurrent sequence of unimodular substitutions. If we look
at the set equation in Proposition 3.7.3 for k = 0 and ℓ= n we see that it subdivides
the sets Rw(i), i ∈A, into translates of sets of the form R(n)
w (j), j ∈A. In the
well-studied substitutive case R(n)
w (i) = Rw(i) holds for each n, i.e., the sets Rw(i)
are subdivided into small copies of themselves. This fact is crucial in most of the
proofs of properties of substitutive Rauzy fractals (see e.g. [123]). In our case, in
general the sets R(n)
w are not only different for each n ∈N, but also live in different
hyperplanes (w(n))⊥of Rn.
In what follows we want to deal with this problem by choosing a strictly
increasing sequence (nk) of integers such that R(nk)
w
(i) is at least getting closer
and closer to Rw(i) in Hausdorff metric when k →∞.
To this matter let σ be a sequence of substitutions that satisﬁes the assumptions
of Theorem 3.7.1. We now successively choose subsequences of the integers to get
the desired properties.
(a) Consider the set equation in Proposition 3.7.3 for the choices k = 0, ℓ= m
and k = n, ℓ= n + m. Look at the subdivision of Rw(i) and R(n)
w (i). We can
hope to get Rw(i) and R(n)
w (i) close to each other in Hausdorff metric if they
have the same subdivision structure. From Proposition 3.7.3 we see that these
subdivision structures are the same if (σ0, . . . , σm−1) = (σn, . . . , σn+m−1).
Since σ is recurrent, there exist strictly increasing sequences (nk) and (ℓk) such
that
(σ0, . . . , σℓk−1) = (σnk, . . . , σnk+ℓk−1).
(3.50)
By recurrence and primitivity it is possible to choose (nk) and (ℓk) in a way that
there is some h such that M[ℓk−h,ℓk) is the same primitive matrix for all k ∈N.

3
S-adic Sequences
161
(b) We know that M[0,ℓk)R(ℓk)
w (j) tends to {0} in Hausdorff metric for k →∞
by Lemma 3.7.7 so that the subdivision corresponding to the choice k = 0,
ℓ= ℓk in the set equation gives a subdivision of Rw(j) into sets whose
diameter tends to 0 for k →∞. However, if we consider R(nk)
w
(i), there is no
reason for M[nk,nk+ℓk)R(nk+ℓk)
w
(j) = M[0,ℓk)R(nk+ℓk)
w
(j) to tend to {0} unless
R(nk+ℓk)
w
(j) is bounded uniformly in k. To this end we need to assume that
L(nk+ℓk)
σ
is C-balanced as this implies that R(nk+ℓk)
w
(j) is indeed bounded by
Proposition 3.6.5. In view of the conditions imposed on σ in Theorem 3.7.1 it
is, however, possible to change the sequence (nk) and (ℓk) chosen in (a) in a
way that also L(nk+ℓk)
σ
is C-balanced for C ∈N not depending on k.
(c) Still (a) and (b) give us no reason for R(nk)
w
living in a hyperplane w(nk) close
to w which is needed in order to get R(nk)
w
close to Rw in Hausdorff metric.
By the compactness of the space of directions in Rd, using the Hilbert metric
from Proposition 3.5.5 it is possible to exhibit a vector v ∈R≥0 \ {0} for which
there exists subsequences of (nk) and (ℓk) (called (nk) and (ℓk) again) such that
limk→∞v(nk)/∥v(nk)∥1 = v/∥v∥1. Here we set v(n) = (M[0,n))tv.
Summing up, if the conditions of Theorem 3.7.1 are in force we can choose
sequences (nk) and (ℓk) satisfying (a), (b), and (c). The vector v deﬁned in (c)
deserves special attention.
Deﬁnition 3.7.11 (Generalized Left Eigenvector) A vector v as in (c) is called a
generalized left eigenvector of σ.
Sequences (nk) and (ℓk) associated with σ in the above way will just be called
associated sequences for σ in the sequel (they are related to the property PRICE
of [52, Deﬁnition 5.8]). It turns out that associated sequences are suitable for our
purposes. In particular, we get the following result (we refer to [52, Proposition 5.12]
for details).
Proposition 3.7.12 Let σ be a sequence of substitutions that admits associated
sequences (nk) and (ℓk) and has a generalized left eigenvector v. Then for each
i ∈A
lim
k→∞R(nk)
v
(i) = Rv(i)
in Hausdorff metric.
Proof (Sketch) By (3.50) in (a) the sets Rv(i) and R(nk)
v
(i) have the same
subdivision structure governed by E∗
1(σ[0,ℓk)) for k ∈N. More precisely,
Rv(i) =

[y,j]∈E∗
1(σ[0,ℓk))[0,i]
M[0,ℓk)(π(ℓk)
u,v y + R(ℓk)
v
(j)),
R(nk)
v
(i) =

[y,j]∈E∗
1(σ[0,ℓk))[0,i]
M[0,ℓk)(π(nk+ℓk)
u,v
y + R(nk+ℓk)
v
(j)).
(3.51)

162
J. M. Thuswaldner
By Proposition 3.6.10 the sets M[0,ℓk)R(ℓk)
v
(j) tend to {0} in Hausdorff metric for
k →∞. With more effort, using the balance conditions of (b) and the convergence
properties of (c), one can also show that the sets M[0,ℓk)R(nk+ℓk)
v
(j) tend to {0} in
Hausdorff metric for k →∞. So replacing all these sets by {0} on the right hand
side of (3.51) changes the sets on the left hand side of (3.51) only very little in
Hausdorff metric for large k ∈N. Thus for large k ∈N the Hausdorff distance
between R(nk)
v
(i) and Rv(i) is (up to an error tending to 0 for k →∞) bounded by
max

∥M[0,ℓk)(π(ℓk)
u,v y −π(nk+ℓk)
u,v
y∥∞: [y, j] ∈E∗
1(σ[0,ℓk))[0, i]

=
max

∥πu,vM[0,ℓk)y −π(nk)
u,v M[0,ℓk)y∥∞: [y, j] ∈E∗
1(σ[0,ℓk))[0, i]

.
One can now show that the latter maximum tends to 0 for k →∞. Here one
uses that by the deﬁnition of the generalized left eigenvector in (c) the hyperplanes
(v(nk))⊥converge to v⊥.
⊓⊔
3.7.4
An S-adic Rauzy Fractal Has a Boundary of Measure
Zero
We now turn to the boundary of an S-adic Rauzy fractal. We start with a result on
level ℓsubtiles contained in the interior of a given subtile whose detailed proof is
contained in [52, Lemma 6.6].
Lemma 3.7.13 Let σ be a sequence of unimodular substitutions that satisﬁes
the properties of Theorem 3.7.1 and let associated sequences (nk), (ℓk), and a
generalized left eigenvector v be given.
Then there is ℓ∈N such that for each i, j ∈A there is [y, j] ∈E∗
1(σ[0,ℓ))[0, i]
such that
(i) M[0,ℓ)(π(ℓ)
u,vy + R(ℓ)
v (j)) ⊂int(Rv(i)),
(ii) M[0,ℓ)(π(nk+ℓ)
u,v
y+R(nk+ℓ)
v
(j)) ⊂int(R(nk)
v
(i)) for each sufﬁciently large k ∈N.
Moreover, the covering degree of C(n)
v
does not depend on n.
Proof (Sketch) Since the conditions in the lemma imply that int(Rv(i)) ̸= ∅(see
Proposition 3.7.10) and that the diameter of M[0,ℓ)R(ℓ)
v (j) becomes arbitrarily small
for large ℓ(see Lemma 3.7.7), assertion (i) follows easily from primitivity.
The fact that ℓand y can be chosen in a way that (i) and (ii) hold simultaneously
is more difﬁcult to prove. By Proposition 3.7.12 we get that R(nk)
v
(i) →Rv(i) in
Hausdorff metric. Moreover, Rv(i) and R(nk)
v
(i) have the same subdivision structure
for ℓk steps. This implies that the “inner structure” of these tiles is similar for large
k. However, as inner points are not respected by the Hausdorff metric, technical
difﬁculties occur and also the “outer structure”, i.e., the structure of the collections

3
S-adic Sequences
163
Cv and C(nk)
v
has to be exploited. One can show that if a patch P occurs in a
discrete hyperplane Γ (w), then translates of P occur relatively densely in each
discrete hyperplane Γ ( ˜w) provided that ∥w −˜w∥∞is small enough. In particular,
containment of translates of a patch P is an open property of discrete hyperplanes.
Thus, if k is large then at level nk there is a translation yk ∈Zd such that the sets
Γ (v) and Γ (v(nk)) −yk have a large patch around the origin in common.
Summing up, this means that the collections C(nk)
v
−π(nk)
u,y yk converge7 to Cv for
k →∞. This implies that the covering degree of C(nk)
v
−π(nk)
u,y yk is less than or
equal to the covering degree of Cv = C(0)
v
for k large enough. Since the covering
degree of C(n)
v
is monotonically increasing in n by Lemma 3.7.9, the last assertion
of the lemma follows.
The fact that the collections C(nk)
v
−π(nk)
u,y yk converge to Cv and have the same
covering degree can now be used to show that inner points of elements of Cv are
close to inner points of elements of C(nk)
v
−π(nk)
u,y yk for large k. Using this together
with the fact that Rv(i) and R(nk)
v
(i) have the same subdivision structure for ℓk
steps, one can show that (i) and (ii) holds simultaneously as claimed.
⊓⊔
After these preparations we can also prove the result on the measure of the
boundary of S-adic Rauzy fractals announced in Theorem 3.7.1.
Proposition 3.7.14 Let σ be a sequence of unimodular substitutions over the
alphabet A that satisﬁes the assertions of Theorem 3.7.1. Then the Lebesgue
measure λ1(∂R(i)) is zero for each i ∈A.
Proof (Sketch) Choose ℓ∈N and the sequences (nk) and (ℓk) as in Lemma 3.7.13
and consider Rv(i) for some i ∈A (see Fig. 3.17a), where v is a generalized
left eigenvector of σ. Then subdivide Rv(i) into its level ℓsubtiles as shown
in Fig. 3.17b. According to Lemma 3.7.13(i) there is at least one level ℓsubtile
M[0,ℓ)(π(ℓ)
u,vy + R(ℓ)
v (j)) which is a subset of int(Rv(i)); this is indicated with
a black boundary in Fig. 3.17b. Letting mij = λv(M[0,ℓ)R(ℓ)
v (j))/λv(Rv(i)) and
m = min{mij : i, j ∈A} we therefore gain
λv(∂Rv(i)) = λv(Rv(i) \ int(Rv(i))) ≤(1 −m)λv(Rv(i)).
Now we subdivide all level ℓsubtiles of Rv(i) apart from M[0,ℓ)(π(ℓ)
u,vy + R(ℓ)
v (j))
in level nk subtiles where k is chosen in a way that nk ≥ℓ. This is illustrated in
Fig. 3.17c.
7In [111] a space of tilings is equipped with a topology by saying that two tilings are close to
each other if their tiles are close to each other in Hausdorff metric inside a large ball around the
origin. Although Cv and C(nk)
v
are no tilings, an analogous topology can be used here: Cv and
C(nk)
v
−π(nk)
u,y yk are said to be close to each other if Γ (v) and Γ (v(nk)) −yk coincide inside a large
ball B around the origin and the tiles associated to an element of [y, i] ∈Γ (v)∩B in each of these
two collections are close to each other in Hausdorff metric.

164
J. M. Thuswaldner
)
b
(
)
a
(
)
d
(
)
c
(
Fig. 3.17 Illustration of the proof of Proposition 3.7.14. In (a) a subtile Rv(i), i ∈A, is shown.
In (b) we see the ℓth subdivision of Rv(i). The level ℓsubtile contained in int(Rv(i)) has black
boundary. In (c) all other level ℓsubtiles are further subdivided in level nk subtiles. Each of them
contains a level nk + ℓsubtile in its interior. These level nk + ℓsubtiles, which a fortiori are also
contained in int(Rv(i)), are depicted in (d) also with black boundary
We iterate this procedure: each level nk subtile Rnk we got in this way is
subdivided in level nk + ℓsubtiles. By Lemma 3.7.13(ii) one of these level nk + ℓ
subtiles lies in the interior of Rnk (see Fig. 3.17d for an illustration of this) and, a
fortiori, in the interior of Rv(i). If we set
m(nk)
ij
= λv(M[0,nk+ℓ)R(nk+ℓ)
v
(j))
λv(M[0,nk)R(nk)
v
(i))
= λv(M[nk,nk+ℓ)R(nk+ℓ)
v
(j))
λv(R(nk)
v
(i))
= λv(M[0,ℓ)R(nk+ℓ)
v
(j))
λv(R(nk)
v
(i))
(note that the last equation follows from recurrence of σ if k is chosen large enough)
and m(nk) = min{m(nk)
ij
: i, j ∈A} we obtain
λv(∂Rv(i)) ≤(1 −m)(1 −m(nk))λv(Rv(i)).
Iterating this further we get for some inﬁnite set K ⊂N that
λv(∂Rv(i)) ≤(1 −m)
1
k∈K
(1 −m(nk))λv(Rv(i)).
(3.52)

3
S-adic Sequences
165
One can show that m(nk) is uniformly bounded away from 0. To this end one needs
Proposition 3.7.12 and the fact that ℓk is chosen in a way that there is some h such
that M[ℓk−h,ℓk) is the same primitive matrix for all k ∈N (see (a) in Sect. 3.7.3).
Now (3.52) yields λv(∂Rv(i)) = 0 and, hence, λ1(∂R(i)) = 0.
⊓⊔
Propositions 3.7.10 and 3.7.14 imply Theorem 3.7.1.
3.8
Tilings, Coincidence Conditions, and Combinatorial
Issues
We now turn to tiling conditions of Rauzy fractals. Already in the substitutive case
combinatorial conditions like the strong coincidence condition (see e.g. [18]) or the
super coincidence condition and its variants (cf. [36, 51, 91]) have to be imposed
in order to gain all the tiling results on Rauzy fractals required for our purposes.
Here we discuss an S-adic version of these concepts and establish a variety of tiling
results. For detailed proofs we refer again to Berthé et al. [52]. As before, our aim
is to discuss the main ideas and to make these ideas understandable without going
into all the technical details.
3.8.1
Multiple Tiling and Inner Subdivision of the Subtiles
In this section we prove tiling properties of Rauzy fractals that hold without further
combinatorial conditions. Our ﬁrst result contains a multiple tiling property of the
collections of Rauzy fractals Cv deﬁned in (3.35).
Proposition 3.8.1 Let σ
= (σn) be a primitive and algebraically irreducible
sequence of unimodular substitutions. Assume that there is C > 0 such that for
every ℓ∈N there exists n ≥1 such that (σn, . . . , σn+ℓ−1) = (σ0, . . . , σℓ−1) and
the language L(n+ℓ)
σ
is C-balanced.
If v is a generalized left eigenvector of σ then the collection Cv forms a multiple
tiling of the hyperplane v⊥.
Proof (Sketch) Let (ℓk) and (nk) be associated sequences for σ. We subdivide the
proof in seven observations. In the sequel BX(x, ε) denotes an open ball in a metric
space X centered at x with radius ε.
(i) Let w ∈Rd
≥0 \ {0}. As mentioned in the proof of Lemma 3.7.13 one can show
that each patch P ⊂Γ (w) is repetitive in the following sense: there exists
δP > 0 and a radius rP > 0 such that for each ˜w ∈Rd
≥0 \ {0} with ∥˜w −
w∥∞< δP and each z with [z, i] ∈Γ ( ˜w) a translate of P occurs in Γ ( ˜w) ∩
BRn(z, rP ). This means that each patch occurring in a discrete hyperplane D

166
J. M. Thuswaldner
occurs uniformly repetitively in each hyperplane D′ which is close enough to
D. This general property of discrete hyperplanes is proved in [52, Lemma 6.5].
(ii) Let m be the covering degree of Cv. Then each point x ∈v⊥which is covered
exactly m times by elements of Cv is not contained in the boundary of any
element of Cv. Suppose this was wrong and let R1, . . . , Rm ∈Cv be the
elements containing x. Since Cv is a locally ﬁnite union of compact sets there
is ε > 0 such that Bv⊥(x, ε) doesn’t intersect any R ∈Cv \ {R1, . . . , Rm}.
By assumption x ∈∂Ri for some 1 ≤i ≤m. Thus there is y ∈Bv⊥(x, ε)
with y ̸∈Ri and, hence, y is covered by at most m −1 elements of Cv, a
contradiction.
(iii) Choose x which is covered exactly m times by elements of Cv. Since the
elements of Cv are uniformly bounded, the set of elements of Cv which contain
x is contained in a set {πu,vx+Rv(i) : [x, i] ∈P}, where P is a patch of Γ (v)
which is chosen so large that, regardless of how the elements of Γ (v) continue
outside P, they will not contribute elements of Cv containing x because they
are bounded and located “too far away” from x. Thus, whenever we encounter
a translate P + t of P in Γ (v), the point x + πu,vt will be covered m times
by elements of Cv as well. Thus by (i) and (ii) there exist rm and r′
m such that
in each ball of radius r′
m the hyperplane v⊥contains a ball of radius rm that is
covered by exactly m elements of Cv.
(iv) C(nk)
v
converges to Cv in a sense described in the proof of Lemma 3.7.13. Thus
by (i) the radii rm and r′
m in (iii) can be chosen in a way that in each ball of
radius r′
m the hyperplane (v(nk))⊥contains a ball of radius rm that is covered
by exactly m elements of C(nk)
v
for k large enough.
(v) Suppose that Cv is not a multiple tiling. Then there is a set X ⊂v⊥with
λv(X) > 0 which is covered at least m + 1 times. Since the boundaries of
the elements of Cv have measure 0 by Proposition 3.7.14, there is x, which is
covered a least m + 1 times and which is not contained in the boundary of any
element of Cv. Thus there is ε > 0 such that Bv⊥(x, ε) is covered at least m+1
times.
(vi) Suppose that Cv is not a multiple tiling. By analogous arguments as in (iii),
by (v) there exist rm+1 and r′
m+1 such that in each ball of radius r′
m+1 the
hyperplane v⊥contains a ball of radius rm+1 that is covered by at least m + 1
elements of Cv.
(vii) By Proposition 3.7.6 each element of Cv can be subdivided into elements of
M[0,nk)C(nk)
v
. The diameters of the elements of M[0,nk)C(nk)
v
tend to 0 for k →
∞by Lemma 3.7.7 and the balls of radius r′
m occurring in (iv) are shrunk by
M[0,nk) to ellipsoids contained in balls of radius less than rm+1. Thus by (iv)
we can chose k so large that in each ball of radius rm+1 in v⊥there are points
which are covered exactly m times by M[0,nk)C(nk)
v
. Thus, by Proposition 3.7.6,
in each ball of radius rm+1 there are points which are covered at most m times
by Cv. This contradicts (vi) and the result follows.
⊓⊔

3
S-adic Sequences
167
This result can be generalized to Cw for arbitrary w ∈Rd
≥0 \{0}. To establish this
generalization one needs to show ﬁrst that the measures of the subtiles of Rv are
determined by
(λv(Rv(1)), . . ., λv(Rv(d))) = m(λv(πu,v[0, 1]), . . ., λv(πu,v[0, d])),
where m is the covering degree of the multiple tiling Cv. This can be proved along
similar lines as in the substitutive case, see [91, Lemma 2.3]. Using this, measure
theoretical considerations lead to the following generalization of Proposition 3.8.1.
Proposition 3.8.2 Let σ
= (σn) be a primitive and algebraically irreducible
sequence of unimodular substitutions. Assume that there is C > 0 such that for
every ℓ∈N there exists n ≥1 such that (σn, . . . , σn+ℓ−1) = (σ0, . . . , σℓ−1) and
the language L(n+ℓ)
σ
is C-balanced.
Then for each w ∈Rd
≥0 \ {0} the collection Cw forms a multiple tiling of the
hyperplane w⊥.
It remains to show that this multiple tiling is actually a tiling. As we will see
later, additional assumptions are needed to prove this. However, there is one tiling
result which holds without additional assumptions. This result, which concerns the
“inner tiling” of Rw(i) by the set equation (3.45) will be proved next.
Proposition 3.8.3 Let σ
= (σn) be a primitive and algebraically irreducible
sequence of unimodular substitutions. Assume that there is C > 0 such that for
every ℓ∈N there exists n ≥1 such that (σn, . . . , σn+ℓ−1) = (σ0, . . . , σℓ−1) and
the language L(n+ℓ)
σ
is C-balanced.
Then the unions in the set equation (3.45) of Proposition 3.7.3 are disjoint in
measure.
Proof From Proposition 3.8.2 we know that Cw is a multiple tiling for each w ∈
Rd
≥0 \ {0} with multiplicity m not depending on w. Together with Proposition 3.7.6
this implies that the (ℓ−k)th subdivisions of all the tiles in the multiple tiling Cw(k)
form a multiple tiling M[k,ℓ)Cw(ℓ) of the same covering degree (for all k, ℓ∈N with
k < ℓ). This is possible only if each tile of Cw(k) is tiled without overlaps by elements
of M[k,ℓ)Cw(ℓ). This proves the result.
⊓⊔
3.8.2
Coincidence Conditions and Tiling Properties
Let σ be a sequence of unimodular substitutions over an alphabet A. In view of
Example 3.6.2 in order to prove that (Xσ, Σ) is measurably conjugate to a rotation
on a torus we need two properties of the associated Rauzy fractal R. Firstly, the
subtiles R(i), i ∈A, need to be disjoint in measure and secondly, the Rauzy fractal
itself has to be a fundamental domain of a (well-chosen) torus. The latter property
is equivalent to the fact that R admits a lattice tiling of v⊥. Setting w = 1 in

168
J. M. Thuswaldner
Proposition 3.8.2 we obtain that C1 is a multiple tiling of 1⊥. Since the discrete
hyperplane Γ (1) can be written as Γ (1) = {[x, i] : ⟨x, 1⟩= 0, i ∈A} we see that

R∈C1
R =

[x,i]∈Γ (1)
πu,1x + R(i) =

x∈Zd : ⟨x,1⟩=0
πu,1x + R.
Thus R is a covering of 1⊥w.r.t. the lattice {x ∈Zd : ⟨x, 1⟩= 0} and we have to
prove that the elements of the union on the right hand side are measure disjoint to
get tiling properties of R.
We have therefore three types of unions which we want to be disjoint in
measure:
(i) The unions of subtiles on the right hand side of the set equation (3.45).
(ii) The union R = R(1) ∪· · · ∪R(d).
(iii) The union 1⊥= 
x∈Zd : ⟨x,1⟩=0 πu,1x + R = 
[x,i]∈Γ (1) πu,1x + R(i).
The elements of the unions in (i) are disjoint in measure by Proposition 3.8.3.
One can use this fact in order to prove that the unions in (ii) are disjoint in measure
as well. However, to make this proof work we need an additional assumption on σ.
Deﬁnition 3.8.4 (Strong Coincidence Condition) A sequence σ of substitutions
over an alphabet A satisﬁes the strong coincidence condition if there is ℓ∈N such
that for each pair (j1, j2) ∈A2 there are i ∈A and p1, p2 ∈A∗with l(p1) = l(p2)
such that σ[0,ℓ)(j1) ∈p1iA∗and σ[0,ℓ)(j2) ∈p2iA∗.
This deﬁnition has an easy geometric meaning: it says that the broken lines
associated with σ[0,ℓ)(j1) and σ[0,ℓ)(j2) have at least one line segment in common
for each pair (j1, j2) ∈A2.
Example 3.8.5 Figure 3.18 shows that the strong coincidence condition is satisﬁed
for the constant sequence σ = (σ) with σ(1) = 121, σ(2) = 21. Because we are in
a case with a two letter alphabet we only have to deal with the instance (j1, j2) =
(1, 2).
Using the strong coincidence condition we get the following result.
Proposition 3.8.6 Let σ
= (σn) be a primitive and algebraically irreducible
sequence of unimodular substitutions. Assume that there is C > 0 such that for
every ℓ∈N there exists n ≥1 such that (σn, . . . , σn+ℓ−1) = (σ0, . . . , σℓ−1) and
the language L(n+ℓ)
σ
is C-balanced.
Fig. 3.18 The broken lines
associated with i, σ[0,1)(i),
and σ[0,2)(i) for i ∈{1, 2}.
Coincidence is indicated by
the bold line
i
σ[0 ,1) (i)
σ[0 ,2) (i)

3
S-adic Sequences
169
If the strong coincidence condition holds then the subtiles R(i), i ∈A, are
disjoint in measure.
Proof (Sketch) Let (nk) and (ℓk) be the associated sequences of σ. Let R(j1)
and R(j2) be two subtiles with j1, j2 ∈A distinct and assume that the strong
coincidence condition holds with ℓ∈N. By the deﬁnition of the dual E∗
1 in (3.46)
this implies that for k satisfying nk ≥ℓthere is zk ∈Zd and a letter i ∈A such that
[zk, j1], [zk, j2] ∈E∗
1(σ[0,nk))[0, i]. Thus the set equation
R(i) =

[y,j]∈E∗
1(σ[0,nk))[0,i]
M[0,nk)(π(nk)
u,1 y + R(nk)(j)),
(see (3.45)) contains M[0,nk)(zk+R(nk)(j1)) and M[0,nk)(zk+R(nk)(j2)) in the union
on the right hand side. Proposition 3.8.3 now implies that R(nk)(j1) and R(nk)(j2)
are disjoint in measure. Since this is true for arbitrarily large k, using results along
the line of Proposition 3.7.12 (in particular, [52, Lemma 6.8]) this implies that R(j1)
and R(j2) are disjoint in measure as well.
⊓⊔
What we did in the proof of Proposition 3.8.6 can be explained in a simple way.
If the strong coincidence condition holds, each intersection of the subtiles R(j1) ∩
R(j2) can be realized as an intersection of two elements in the union on the right
hand side of the set equation (3.45). Since we know that the elements in the union
of the set equation are measure disjoint, the same is true for R(j1) and R(j2). More
brieﬂy: in case of strong coincidence the elements in the union in (ii) are special
cases of the elements in some union in (i).
The same strategy can be used in order to prove that the unions in (iii) are
measure disjoint. To this end we need another type of coincidence condition.
Deﬁnition 3.8.7 (Geometric Coincidence Condition) A sequence σ of unimodu-
lar substitutions over an alphabet A satisﬁes the geometric coincidence condition if
the following is true. For each r > 0 there is n0 ∈N such that for each n ≥n0 the set
E∗
1(σ[0,n))[0, in] contains a ball of radius r of the discrete hyperplane Γ ((M[0,n))t1)
for some in ∈A.
Along similar lines as Proposition 3.8.6 one can prove the following tiling
criterion for Rauzy fractals (see [52, Proposition 7.9]).
Proposition 3.8.8 Let σ
= (σn) be a primitive and algebraically irreducible
sequence of unimodular substitutions. Assume that there is C > 0 such that for
every ℓ∈N there exists n ≥1 such that (σn, . . . , σn+ℓ−1) = (σ0, . . . , σℓ−1) and
the language L(n+ℓ)
σ
is C-balanced. Then the following assertions are equivalent.
(i) The collection C1 forms a tiling of 1⊥.
(ii) The sequence σ satisﬁes the geometric coincidence condition.
(iii) The sequence σ satisﬁes the strong coincidence condition and for each r > 0
there exists n0 ∈N such that 
i∈A E∗
1(σ[0,n))[0, i] contains a ball of radius r
of Γ ((M[0,n))t 1) for all n ≥n0.

170
J. M. Thuswaldner
(iv) The sequence σ satisﬁes the following effective condition: There are n ∈N,
i ∈A, and z ∈Rd, such that

[y, j] ∈Γ ((M[0,n))t 1) : ∥π(M[0,n))−1u,1(y −z)∥≤C

⊂E∗
1(σ[0,n))[0, i],
where C ∈N is chosen in a way that L(n)
σ
is C-balanced.
An (essentially) more restrictive condition than the geometric coincidence
condition and its variants in Proposition 3.8.8 is the following one.
Deﬁnition 3.8.9 (Geometric Finiteness Property) A sequence σ of unimodular
substitutions over an alphabet A satisﬁes the geometric ﬁniteness property if for
each r > 0 there is n0 ∈N such that 
i∈A E∗
1(σ[0,n))[0, i] contains the ball {[x, i] ∈
Γ ((M[0,n))t 1) : ∥x∥≤r} for all n ≥n0.
The geometric ﬁniteness property implies that 
i∈A E∗
1(σ[0,n))[0, i] generates a
whole discrete plane for n →∞, and that 0 is an inner point of the Rauzy fractal
R (as is proved in [52, Proposition 7.10]). It is immediate that together with the
strong coincidence condition the geometric ﬁniteness property is more restrictive
than the condition in Proposition 3.8.8(iii). The name geometric ﬁniteness property
comes from the fact that it is related to certain ﬁniteness properties in number
representations w.r.t. positional number systems (see for instance Barat et al. [31]
for a survey on these objects). By Proposition 3.8.8(iii) strong coincidence plus
geometric ﬁniteness imply that C1 forms a tiling of 1⊥.
3.8.3
How to Check Geometric Coincidence and Geometric
Finiteness?
In most cases it is easy to check strong coincidence of a sequence σ = (σn) of
substitutions over an alphabet A. For instance, this property trivially holds if σ0(i)
starts with the same letter for each i ∈A. However, it is a priori not so clear how
to check geometric coincidence or geometric ﬁniteness and although there is an
effective criterion for geometric coincidence contained in Proposition 3.8.8(iv) this
is only suitable for checking single instances. Geometric coincidence asserts that
a large piece of a discrete hyperplane can be generated by the dual substitution
E∗
1(σ[0,n)) acting on [0, in] if n is large. If geometric ﬁniteness holds, even a
whole discrete hyperplane can be generated by the patches E∗
1(σ[0,n)) 
i∈A[0, i]
for n →∞. The idea of generating discrete hyperplanes in this way using sequences
of substitutions coming from generalized continued fraction algorithms goes back
to Ito and Ohtsuki [90]. More recently, Berthé et al. [42, 48] provide a systematic

3
S-adic Sequences
171
study on how to check geometric coincidence as well as geometric ﬁniteness. While
[48] concentrates on Arnoux-Rauzy substitutions, the more general treatment in
[42] uses substitutions related to the Brun as well as the Jacobi-Perron algorithm
as guiding examples. In this section we give a brief discussion of their ideas which
are centered around an “annulus property” of stepped hyperplanes generated by
E∗
1(σ[0,n)).
Let σ = (σn) be a sequence of unimodular substitutions over an alphabet A and
let S = {σn : n ∈N}. The fact that σ satisﬁes the geometric coincidence condition
in Deﬁnition 3.8.7 roughly says that the patch E∗
1(σ[0,n))[0, in] contains a larger
and larger ball when n is growing. In this section, for the sake of simplicity, we
will deal with the geometric ﬁniteness property. Indeed, we will assume that this
ball is centered at the origin and instead of [0, in] we will use U = 
i∈A[0, i] as
our “seed”. So we want to show that for each R > 0 there is n0 ∈N such that
E∗
1(σ[0,n))U contains the ball {[x, i] ∈Γ ((M[0,n))t 1) : ∥x∥≤R} for all n ≥n0.
Following [42] we shall reformulate the geometric ﬁniteness property in a
more combinatorial way. Let P be a patch of a discrete hyperplane containing U
and interpret its elements as faces as in (3.34). Then the minimal combinatorial
radius rad(P) of P is equal to the length ℓof the shortest sequence of faces
[x1, j1], . . . , [xℓ, jℓ] ∈P satisfying [x1, j1] ∈U, [xℓ, jℓ] contains a part of the
boundary of P (regarded as a topological manifold), and [xk, jk]∩[xk+1, jk+1] ̸= ∅
for 1 ≤k ≤ℓ−1. Intuitively, rad(P) is the minimal distance between 0 and
the boundary of P. For instance, one easily checks that the minimal combinatorial
radius of the patch on the left hand side of Fig. 3.13 is equal to six. Clearly a
sequence σ enjoys the geometric ﬁniteness property if and only if rad

E∗
1(σ[0,n))U
	
tends to ∞for n →∞.
Let P[m,n) = E∗
1(σ[m,n))U. We have to show that the minimal combinatorial
radii of the patches P[0,n) tend to ∞for n →∞. Since the patches P[0,n) can
have complicated shapes there is no obvious way to do this. One approach to prove
this property goes back to Ito and Ohtsuki [90] and makes use of “annuli”. Let
ℓ< m < n and suppose that U ⊂E∗
1(σ)U holds for each σ ∈S (this is not a crucial
assumption and, if it is not true, can often be gained by blocking the substitutions
of the sequence σ). Then P[m,n) ⊂P[ℓ,n) holds by the deﬁnition of E∗
1(σ) (note
in particular that E∗
1(τ)E∗
1(σ) = E∗
1(στ) for σ, τ ∈S). The idea is to make sure
that whenever (σℓ, . . . , σm−1) is of a certain shape then P[ℓ,n) \ P[m,n) contains an
annulus of positive width. One can then show that if (σ0, . . . , σn) contains the block
(σℓ, . . . , σm−1) for k times, the patch P[0,n) contains k “concentric” annuli and has
a minimal combinatorial radius greater than or equal to k.
To achieve this we ﬁrst search for a block (σ0, . . . , σm−1) such that A = P[0,m) \
U contains an annulus of positive width, i.e., ∂P[0,m) ∩U = ∅. If σ is recurrent,
the block (σ0, . . . , σm−1) occurs inﬁnitely often in σ. Let (nj) with n0 = 0

172
J. M. Thuswaldner
and nj ≥nj−1 + m be an increasing sequence such that (σnj , . . . , σnj +m−1) =
(σ0, . . . , σm−1). Fix k ∈N and set A0 = P[0,nk+m) \ P[m,nk+m) and Aj :=
P[nj−1+m,nk+m) \ P[nj +m,nk+m) for j ≥1. Then
P[0,nk+m) = (P[0,nk+m) \ P[m,nk+m)) ∪P[m,nk+m)
= A0 ∪P[m,nk+m)
= A0 ∪(P[m,nk+m) \ P[n1+m,nk+m)) ∪P[n1+m,nk+m)
= A0 ∪A1 ∪P[n1+m,nk+m)
= A0 ∪A1 ∪(P[n1+m,nk+m) \ P[n2+m,nk+m)) ∪P[n2+m,nk+m)
= A0 ∪A1 ∪A2 ∪P[n2+m,nk+m)
= · · · = A0 ∪· · · ∪Ak ∪U.
(3.53)
Because
Aj = P[nj−1+m,nk+m) \ P[nj +m,nk+m)
⊃P[nj ,nk+m) \ P[nj +m,nk+m)
= E∗
1(σ[nj +m,nk+m))(P[nj ,nj +m) \ U)
= E∗
1(σ[nj +m,nk+m))A
for j ≥1 (the last step comes from the recurrence property; the case j = 0
follows along similar lines) each Aj contains some image of A under E∗
1. If
the annulus A has certain “covering properties” that are described in detail in
[42, 48], one can show that images of A under E∗
1 are annuli of positive width
as well. Thus such an annulus of positive width is contained in each of the pairwise
disjoint subsets A0, . . . , Ak of P[0,nk+m) and therefore (3.53) implies that the patch
P[0,nk+m) contains a “concentric” annulus for each of the k + 1 (non overlapping)
occurrence of the block (σ0, . . . , σm−1) in (σ0, . . . , σnk+m−1). Since an application
of E∗
1 maps disjoint annuli to disjoint annuli also P[0,n) = E∗
1(σ[nk+m,n))P[0,nk+m)
with nk + m ≤n < nk+1 + m contains k + 1 such “concentric” annuli. Thus
if n →∞, the number of such annuli in P[0,n) tends to ∞. Since the above-
mentioned covering properties of A imply that A0 ∪· · · ∪Ak ∪U = P[0,nk+m)
is simply connected for each k ∈N and that the same is true for all the patches
P[0,n) (see [48]), we gain that the minimal combinatorial radii of the patches P[0,n)
tend to ∞for n →∞.
The following example shows that this method can be used in order to prove
geometric ﬁniteness for large classes of sequences of substitutions.
Example 3.8.10 We want to illustrate the construction of the annulus A around U
for the case of sequences of Arnoux-Rauzy substitutions σ = (σn) (all details for

3
S-adic Sequences
173
Fig. 3.19 An illustration of the annulus property for sequences of Arnoux-Rauzy substitutions
this case can be found in [48]). Suppose that σ is a recurrent sequence of Arnoux-
Rauzy substitutions which contains each of the three Arnoux-Rauzy substitutions
(3.18). Then, by recurrence, σ contains a block (σ0, . . . , σm−1) in which each
Arnoux Rauzy substitution occurs at least twice. In the graph depicted in Fig. 3.19
the action of E∗
1 on U is illustrated.8 The vertices of this graph are patches and
there is an edge P1
i−→P2 if P2 ⊂E∗
1(σi)P1. Thus each vertex has an outgoing
edge for each i ∈{1, 2, 3} (loops and outgoing edges of patches that contain
an annulus of positive width around U are suppressed). Examining the graph we
see that E∗
1(σ[k,n))U contains an annulus around U of positive width whenever
the block (σk, . . . , σn−1) contains at least two occurrences of each Arnoux-Rauzy
substitution. Thus, P[0,m) is a patch which contains U together with an annulus A of
positive width around it.
If one proves that the annulus A has the above-mentioned covering properties
(which was done in [48]) one can iterate this procedure as indicated above and
prove that P[0,n) is simply connected and contains a growing number of “concentric”
8We note that in [48] the dual E∗
1(σ) is deﬁned using sufﬁxes of the images of σ instead of preﬁxes.
Nevertheless, this difference does not change the behavior of E∗
1(σ) signiﬁcantly and in Fig. 3.19
we get the same image as the authors obtained in [48, Figure 1].

174
J. M. Thuswaldner
annuli for growing n. Thus the minimal combinatorial radius of P[0,n) tends to ∞
for n →∞and, hence, σ has the geometric ﬁniteness property.
Summing up, in Example 3.8.10 we have sketched a proof of the following result.
Proposition 3.8.11 Let σ be a sequence of Arnoux-Rauzy substitutions. If σ is
recurrent and contains each of the three Arnoux-Rauzy substitutions then σ satisﬁes
the geometric ﬁniteness property.
3.9
S-adic Systems and Torus Rotations
Let σ be a sequence of unimodular substitutions over an alphabet A with d letters.
In the past sections we proved a variety of properties of Rauzy fractals. Using all
these results makes Rauzy fractals suitable to “see” a rotation on the torus Td−1
acting on them. This rotation turns out to be measurably conjugate to the underlying
S-adic system (Xσ, Σ). In this section we prove the according results which form
special cases of the main results of [52] and provide some examples.
In Sect. 3.9.1 we state Theorem 3.9.4, a result that gives the measurable conju-
gacy between (Xσ, Σ) and a torus rotation together with some of its consequences
under a set of natural conditions. Section 3.9.2 is devoted to the proof of this
result. In Sect. 3.9.3 we formulate a metric version of Theorem 3.9.4. In particular,
for a ﬁnite set S of substitutions we consider the shift9 (SN, Σ, ν) acting on all
inﬁnite sequences of substitutions taken from S. The measure ν is chosen in a way
that this shift becomes ergodic. We prove that the conditions of Theorem 3.9.4
are “generic” w.r.t. the measure ν if the Pisot condition (3.59) on the Lyapunov
exponents associated with a linear cocycle of (SN, Σ, ν) is in force. Thus under
this Pisot condition we gain that ν-almost all σ ∈SN give rise to an S-adic system
(Xσ, Σ) that is measurably conjugate to a torus rotation. This result is the content
of Theorem 3.9.5. Section 3.9.4 is devoted to the proof of this result. Finally,
Sect. 3.9.5 gives examples for S-adic systems associated with Arnoux-Rauzy and
Brun substitutions. This shows that the Pisot condition is satisﬁed in many natural
situations.
9Note that there are two kinds of shifts: the one just deﬁned acts on the sequence of substitutions
SN, the other one (the S-adic shift) acts on the set of sequences Xσ which is deﬁned in terms of
a single sequence of substitutions σ ∈SN. It should cause no confusion that both of these shift
mappings are denoted by Σ.

3
S-adic Sequences
175
3.9.1
Statement of the Conjugacy Result
Before we state the ﬁrst main result of this survey we give some terminology.
We start with a spectral property of a measurable dynamical system that is “the
opposite” of continuous spectrum (see Sect. 3.3.3; we refer to this section also for
the deﬁnition of an eigenfunction).
Deﬁnition 3.9.1 (Pure Discrete Spectrum, see [126, Deﬁntion 3.2])
An ergodic
dynamical system (X, T, μ) on a probability space X has pure discrete spectrum if
there exists an orthonormal basis of L2(μ) which consists of eigenfunctions of T .
It is well known that an ergodic dynamical system on a probability space that has
pure discrete spectrum is measurably conjugate to a rotation on a compact abelian
group. On the other hand, each ergodic rotation on a compact abelian group has
pure discrete spectrum (see for instance [126, Theorems 3.5 and 3.6]; these results
can be proved by using character theory and Pontryagin duality for compact abelian
groups).
The notion of natural coding came up already in Sects. 3.2.4 and 3.3.2 in the
framework of Sturmian sequences and Arnoux-Rauzy sequences. Sloppily speaking
a natural coding is a coding of a torus rotation that induces translations on the
atoms of the partition that was used to deﬁne the coding. We give a precise general
deﬁnition of this concept.
Deﬁnition 3.9.2 (Coding and Natural Coding)
Let Λ be a full-rank lattice in Rd
and Tt : Rd/Λ →Rd/Λ, x →x +t a rotation on the torus Rd/Λ. Let Ω ⊂Rd be a
fundamental domain for the lattice Λ and ˜Tt : Ω →Ω the mapping induced by Tt
on Ω. Assume that Ω = Ω1 ∪· · · ∪Ωk is a (measure theoretic w.r.t. the Lebesgue
measure) partition of Ω.
A sequence w = w0w1 . . . ∈{1, . . ., k}N is the coding of a point x ∈Ω with
respect to this partition if ˜T j
t (x) ∈Ωwj holds for each j ∈N. If, in addition, for
each 1 ≤i ≤k the restriction ˜Tt|Ωi is given by the translation x →x + ti for
some ti ∈Rd we call w a natural coding of Tt.
For the sake of completeness we give the deﬁnition of bounded remainder set.
Deﬁnition 3.9.3 (Bounded Remainder Set)
Let Λ be a full-rank lattice in Rd.
A subset A of Rd/Λ is called a bounded remainder set for the rotation Tt : Rd/Λ →
Rd/Λ, x →x + t if there exist γ, C > 0 such that, for a.e. x ∈Rd/Λ,
|#{n < N : T n
t (x) ∈A} −γ N| < C
holds for all N ∈N.
The following result gives sufﬁcient conditions for an S-adic system (Xσ, Σ) to
be measurably conjugate to an irrational rotation on a torus. The subtiles R(i) of the
Rauzy fractal R turn out to be bounded remainder sets for this rotation and induce
natural codings of the elements of (Xσ, Σ).

176
J. M. Thuswaldner
Theorem 3.9.4 (See [52, Theorem 3.1]) Let S be a ﬁnite set of unimodular
substitutions over a ﬁnite alphabet A = {1, 2, . . . , d} and let σ = (σn) be a
primitive and algebraically irreducible sequence of substitutions taken from the set
S. Assume that there is C > 0 such that for every ℓ∈N there exists n ≥1 such that
(σn, . . . , σn+ℓ−1) = (σ0, . . . , σℓ−1) and the language L(n+ℓ)
σ
is C-balanced.
If the collection C1 forms a tiling of 1⊥then the following results hold.
1. The S-adic shift (Xσ, Σ, μ), with μ being the unique Σ-invariant Borel proba-
bility measure on Xσ, is measurably conjugate to a rotation T on the torus Td−1;
in particular, its measure-theoretic spectrum is purely discrete.
2. Each element of Xσ is a natural coding of the torus rotation T with respect to
the partition {R(i) : i ∈A} of the fundamental domain R.
3. The subtile R(i) is a bounded remainder set for the torus rotation T for each
i ∈A.
For the special case of two letter alphabets the tiling condition does not have to
be assumed. It can be derived from the remaining assumptions of Theorem 3.9.4.
The corresponding result is proved in [50] and generalizes an analogous result for
substitutive systems from [34].
3.9.2
Proof of the Conjugacy Result
In this section we illustrate the proof of Theorem 3.9.4 given in [52]. We assume
throughoutthis section that the sequence σ satisﬁes the conditions of Theorem 3.9.4.
The main part is the proof of the measurable conjugacy between (Xσ , Σ, μ)
and a rotation on the torus Td−1, where d is the cardinality of the underlying
alphabet. Here μ is the unique Σ-invariant Borel probability measure on Xσ (see
Theorem 3.5.11).
Our ﬁrst aim is to set up the representation map from Xσ to the Rauzy fractal.
We deﬁne this map using a nested sequence of the subsets
R(u) := {πu,wl(p) : pu is a preﬁx of a limit sequence of σ}
(u ∈A∗)
of the Rauzy fractal R. In particular, we set
ϕ : Xσ →R;
v0v1v2 . . . →

n∈N
R(v0v1 . . . vn−1).
(3.54)
To show that ϕ is a well-deﬁned continuous surjection one has to prove that the
intersection on the right-hand side of (3.54) is a single point. Using the minimality
of (Xσ, Σ) and the strong convergenceproperty from Proposition 3.6.10 this is done
in [52, Section 8].

3
S-adic Sequences
177
In the next step one proves that (Xσ, Σ, μ) is measurably conjugate to the
domain exchange (R, E, λ1), where E is given by
E : R →R;
x →x + πu,1l(i)
for x ∈R(i) \

j̸=i
R(j)
which is illustrated in Fig. 3.12. Since C1 is a tiling, the overlaps of the subtiles R(i)
have measure 0 and, hence, E is well deﬁned a.e. w.r.t. the measure λ1 on R. To
prove the asserted conjugacy, we have to show that ϕ is bijective μ-a.e. and that the
diagram
X
Σ
X
R
E
R
(3.55)
commutes. Since
E ◦ϕ = ϕ ◦Σ
(3.56)
follows easily by direct calculation it remains to prove the bijectivity assertion. This
runs as follows (all statements are true up to measure zero). First observe that, for
all i ∈A, E satisﬁes
E(R(i)) = {πu,1 l(pi) : p ∈A∗, pi is a preﬁx of a limit word of σ}.
Therefore, we have 
i∈A E(R(i)) = R and, hence, E is a surjective piecewise
isometry. Therefore, E is bijective. Since the subtiles R(i), i ∈A, are disjoint in
measure and
R(w0w1 · · · wn−1) =
n−1

ℓ=0
E−ℓR(wℓ),
(3.57)
the injectivity of E implies that also the elements of the collection of “length n
subtiles”10 Kn = {R(u) : u ∈Lσ with |u| = n} are disjoint in measure. By
(3.56) the measure λ1 ◦ϕ is a shift invariant probability measure on Xσ. As by
Theorem 3.5.11 there is only one such measure, μ = λ1 ◦ϕ. Now, essential
disjointness of the elements of Kn implies that ϕ(x) ̸= ϕ(y) for all distinct x, y
satisfying ϕ(x), ϕ(y) ∈R \ 
n∈N,K∈Kn ∂K. As, by (3.57) and Theorem 3.7.1,
λ1(∂K) = μ(ϕ−1(∂K)) = 0 for all K ∈Kn, n ∈N, the map ϕ is μ-a.e. injective.
10Not to be confused with the level n subtiles introduced in Sect. 3.7.1.

178
J. M. Thuswaldner
Since surjectivity follows from the deﬁnition of ϕ this proves μ-a.e. bijectivity.
Finally, using (3.56), the commutativity of the diagram (3.55) follows from the
bijectivity of ϕ.
Since C1 forms a tiling of 1⊥by assumption, the Rauzy fractal R is a fundamental
domain of the lattice Λ = 1⊥∩Zd spanned by e1 −ei, i ∈A\{1}. But as πu,1 ei ≡
πu,1 e1 (mod Λ) holds for each i ∈A, the canonical projection of E onto the torus
1⊥/Λ ≃Td−1 is equal to the rotation T : Td−1 →Td−1, x →x + πu,1 e1. Thus,
if we denote by ϕ the canonical projection of ϕ to the torus 1⊥/Λ, the diagram
X
Σ
X
ϕ
ϕ
1⊥/Λ
+ πu,1 e1
1⊥/Λ
commutes. Note that ϕ is m to 1 onto, where m is the covering degree of C1,
and, hence, a bijection as C1 forms a tiling. This proves the ﬁrst assertion of
Theorem 3.9.4.
The second assertion of Theorem 3.9.4 follows from the deﬁnition of a natural
coding because the rotation T was deﬁned in terms of an exchange of domains.
Finally, due to [1, Proposition 7], the C-balance of Lσ implies that R(i) is a bounded
remainder set for each i ∈A, which also proves the last assertion.
3.9.3
A Metric Result
As mentioned already in Remark 3.7.2(i), the assumptions of Theorems 3.7.1
and 3.9.4 allow for a metric version of these results. To be more precise, let S be a
ﬁnite set of substitutions and consider the full shift (SN, Σ, ν), where ν is an ergodic
Σ-invariant probability measure satisfying some mild conditions. Our aim is to state
a version of Theorems 3.5.11, 3.7.1, and 3.9.4 that is valid for ν-a.e. σ ∈SN. This
second main result of the present survey is also a special case of a result from Berthé
et al. [52].
To state our result we need to introduce some new concepts. Let S be a ﬁnite
set of substitutions over the alphabet A = {1, 2, . . ., d} and consider the shift
(SN, Σ, ν), where ν is some Σ-invariant probability measure on SN. With each
σ = (σn)n≥0 we associate the linear cocycle operator A(σ) = (M0)t (recall that
M0 is the incidence matrix of σ0) and deﬁne the Lyapunov exponents ϑ1, . . . , ϑd of

3
S-adic Sequences
179
(SN, Σ, ν) iteratively by
ϑ1 + ϑ2 + · · · + ϑk = lim
n→∞
1
n

SN log ∥∧k 
A(Σn−1(σ)) · · · A(σ)
	
∥∞dν(σ)
= lim
n→∞
1
n

SN log ∥∧k (M[0,n))t∥∞dν
(3.58)
= lim
n→∞
1
n

SN log ∥∧k M[0,n)∥∞dν
for 1 ≤k ≤d, where ∧k denotes the k-fold wedge product. We say that (SN, Σ, ν)
satisﬁes the Pisot condition if
ϑ1 > 0 > ϑ2 ≥· · · ≥ϑd
(3.59)
(cf. [44, §6.3]). Using these deﬁnitions we get the following metric version of
Theorems 3.5.11, 3.7.1, and 3.9.4.
Theorem 3.9.5 (See [52, Theorem 3.3]) Let S be a ﬁnite set of unimodular
substitutions and assume that the shift (SN, Σ, ν) is ergodic and satisﬁes the Pisot
condition. Assume further that ν assigns positive measure to every cylinder and
that there exists a cylinder corresponding to a substitution with positive incidence
matrix. Then, for ν-almost every σ ∈SN the following assertions hold.
1. (Xσ , Σ) is minimal and uniquely ergodic (denote the unique Σ-invariant
measure by μ).
2. Each subtile R(i), i ∈A, is equal to the closure of its interior and satisﬁes
λ1(∂R(i)) = 0.
3. If the collection C1 associated with σ forms a tiling of 1⊥then (Xσ, Σ, μ) is
measurably conjugate to a rotation T on Td−1, each element of Xσ is a natural
coding of T w.r.t. the partition {R(i) : i ∈A} of R, and each R(i), i ∈A, is a
bounded remainder set for T .
3.9.4
Proof of the Metric Result
In the present section we give a quite complete proof of Theorem 3.9.5. The
idea is to show that each of the conditions posed in Theorem 3.9.4 is generic.
A prominent tool in this proof is the Multiplicative Ergodic Theorem (also called
Oseledec Theorem; see for instance [8, 3.4.1 Theorem]). Also the famous Poincaré
Recurrence Theorem (cf. e.g. [126, Theorem 1.4]), which states that a.e. orbit in
a measurable dynamical system (X, T, μ) starting in a set of positive measure E
hits E inﬁnitely often, will be used. In our setting, the Oseledec theorem has the
following consequence.

180
J. M. Thuswaldner
Proposition 3.9.6 Let S be a ﬁnite set of unimodular substitutions over the alphabet
A = {1, 2, . . ., d} and assume that the shift (SN, Σ, ν) is ergodic with Lyapunov
exponents ϑ1, . . . , ϑd satisfying the Pisot condition (3.59). Assume further that
ν assigns positive measure to every cylinder and that there exists a cylinder
corresponding to a substitution with positive incidence matrix. Then for ν-a.e.
σ ∈SN the following assertions hold.
(i) The sequence σ is primitive and recurrent, thus the letter frequency vector u =
u(σ) exists.
(ii) For each ε > 0 there exists n0 = n0(ε, σ) such that the sequence of incidence
matrices M = (Mn) = (Mn(σ)) satisﬁes11
∥(M[0,n))t|u⊥∥2 < e(ϑ2+ε)n
for each n ≥n0.
Proof Since ν puts positive mass on each cylinder, ν-a.e. σ is recurrent by Poincaré
recurrence. Together with the fact that there is a cylinder corresponding to a positive
incidence matrix Poincaré recurrence also implies primitivity for ν-a.e. σ. Thus ν-
a.e. σ has a letter frequency vector u by Proposition 3.5.5. This proves (i).
In order to apply the Multiplicative Ergodic Theorem [8, 3.4.1 Theorem] we need
to assure log-integrability of the cocycle which, in our case, means that
max{0, log ∥M0(σ)∥2} ∈L1(SN, ν).
(3.60)
Since S ﬁnite, the quantity max{0, log ∥M0(σ)∥2} is bounded and therefore (3.60)
always holds. Thus, because ϑ1 is a simple Lyapunov exponent, [8, 3.4.1 Theorem]
implies that for ν-a.e. σ there is a hyperplane H = H(σ) ⊂Rd such that
limn→∞1
n log ∥M[0,n)(σ)t|H∥2 ≤ϑ2. This implies that for each ε > 0 there is
n0 = n0(ε, σ) such that
∥M[0,n)(σ)t|H∥2 < e(ϑ2+ε)n
(3.61)
holds for n ≥n0. It remains to show that H = u⊥. However, this follows because
for x ̸∈u⊥we have that ⟨M[0,n)(σ)tx, 1⟩= ⟨x, M[0,n)(σ)1⟩is unbounded because
for large n the vector M[0,n)(σ)1 is a large vector close to the line R+u. Thus the
only hyperplane for which (3.61) can possibly hold is H = u⊥and (ii) follows.
⊓⊔
Proposition 3.9.6 is now used in order to show that balance is generic for
elements of a shift (SN, Σ, ν) satisfying the Pisot condition.
Lemma 3.9.7 Let S be a ﬁnite set of unimodular substitutions over the alphabet
A = {1, 2, . . ., d} and assume that the shift (SN, Σ, ν) is ergodic and satisﬁes
the Pisot condition (3.59). Assume further that ν assigns positive measure to every
11Here ∥· ∥2 is the operator norm w.r.t. the Euclidean norm on Rd.

3
S-adic Sequences
181
cylinder and that there exists a cylinder corresponding to a substitution with positive
incidence matrix. Then the sets
S(C) = {σ ∈SN : Lσis C-balanced}
(C ∈N)
satisfy
lim
C→∞ν(S(C)) = 1,
i.e., balance of Lσ is a generic property of σ ∈SN.
Proof By Proposition 3.9.6 we see that for ν-a.e. σ ∈SN the sequence is primitive
and recurrent, and for the letter frequency vector u = (u1, . . . , ud)t (with ∥u∥1 = 1)
we have

n≥0
∥(M[0,n))t|u⊥∥2 < ∞.
(3.62)
We assume that σ ∈SN has all these properties and follow the proof of [44,
Theorem 5.8]. Let w ∈Xσ be arbitrary. Since by the proof of Proposition 3.5.3(iii)
each element of Xσ has the same language, each factor v of w is a factor of a limit
sequence of σ and, hence, by (3.4.1) can be written as
v = p0σ0(p1 . . . σN−2(pN−1σN−1(x)sN−1) . . .s1)s0
(3.63)
where pn and sn is a preﬁx and a sufﬁx of σn(i) for some i ∈A, respectively, for
each 0 ≤n ≤N −1 and x is a factor of σN(i) for some i ∈A. To make the notation
easier we set pN = x and sN = ε. We mention that (3.63) is the Dumont-Thomas
decomposition of v which was ﬁrst introduced in [70]. Using (3.63) and denoting
by e1, . . . , ed the standard basis vectors of Rd we have
|v|i −|v|ui =
N

n=0
(|σ[0,n)(pn)|i −|σ[0,n)(pn)|ui + |σ[0,n)(sn)|i −|σ[0,n)(sn)|ui)
=
N

n=0
⟨ei −ui(e1 + · · · + ed), M[0,n)l(pn + sn)⟩

182
J. M. Thuswaldner
for each i ∈A. Since u1 + · · · + ud = 1 we see that ei −ui(e1 + · · · + ed) ∈u⊥.
This can be used to get
|v|i −|v|ui
 ≤
N

n=0
⟨ei −ui(e1 + · · · + ed), M[0,n)l(pn + sn)⟩

=
N

n=0
⟨(M[0,n))t(ei −ui(e1 + · · · + ed)), l(pn + sn)⟩

≤2
√
d
N

n=0
∥(M[0,n))t|u⊥∥2∥Mn∥2.
Since S is a ﬁnite set, the quantity ∥Mn∥2 is uniformly bounded in n. Thus, using
(3.62) this implies that w is ﬁnitely balanced. Since σ was taken from a set of full
measure ν of SN this ﬁnishes the proof.
⊓⊔
Before we can put everything together we need to deal with the genericness of
algebraic irreducibility. This has been done in [52, Lemma 8.7] in the following
fashion.
Lemma 3.9.8 Let S be a ﬁnite set of unimodular substitutions over the alphabet
A = {1, 2, . . ., d} and assume that the shift (SN, Σ, ν) is ergodic and satisﬁes the
Pisot condition (3.59). If ν-a.e. sequence σ ∈SN is primitive then ν-a.e. sequence
σ ∈SN is algebraically irreducible.
Proof (Sketch) Let σ be a generic sequence with sequence of incidence matrices
M = (Mn) and ﬁx k ∈N. Then for ℓ→∞the matrix M[k,ℓ) maps the unit
sphere into an ellipse whose largest semiaxis tends to inﬁnity and all of whose other
semiaxes tend to zero by the Pisot condition. We prove that for ℓlarge enough there
can be only one eigenvalue λ with |λ| ≥1.
Indeed, if ℓis large enough then M[k,ℓ) is strictly positive, thus there is a dominant
Perron-Frobenius eigenvalue λ0 > 1. It corresponds to an eigenvector w0 with
strictly positive entries. Suppose that there is another real eigenvalue λ with |λ| ≥1
and corresponding eigenvector w. Since the image of the unit sphere under M[k,ℓ) is
an ellipse with the above mentioned properties, the corresponding eigenvector has
to have a direction close to w0 for ℓlarge, because otherwise its length would be
shrunk by the application of M[k,ℓ) as can be seen in Fig. 3.20. Thus, if ℓis large
enough then w must have strictly positive entries. However, such an eigenvector
has to belong to the Perron-Frobenius eigenvalue, a contradiction. The case of
nonreal eigenvalues can be treated similarly. Thus M[k,ℓ) has only one eigenvalue
of modulus greater than or equal to 1. Since M[k,ℓ) is an unimodular integer matrix,
it cannot have 0 as an eigenvalue. This implies that the characteristic polynomial
of M[k,ℓ) is irreducible and, hence, σ is algebraically irreducible. Indeed, we even
proved that the characteristic polynomial of M[k,ℓ) is the minimal polynomial of the
Pisot number λ0.
⊓⊔

3
S-adic Sequences
183
w
–2
- 1
1
2
–1.0
–0.5
0.5
1.0
Fig. 3.20 An illustration of the elliptic image of the unit circle under M[k,ℓ). The dashed lines are
the axes of the ellipse, the largest axis being the direction of the Perron-Frobenius eigenvector w0.
If the indicated vector w is an eigenvector of M[k,ℓ) for another eigenvalue, its direction has to be
far from the direction of w0 (because not all of its entries can be positive). This entails that its
length is less than 1 and so it can only correspond to an eigenvalue less than 1 in modulus
We now have all the necessary ingredients to ﬁnish the proof of Theorem 3.9.5.
Proof (Conclusion of the Proof of Theorem 3.9.5) We show that the conditions of
Theorem 3.9.4 are satisﬁed for ν-a.e. σ ∈SN. To keep things simple we give the
proof only for ν being a Bernoulli measure. Primitivity and algebraic irreducibility
hold ν-a.e. by Proposition 3.9.6(i) and Lemma 3.9.8, respectively.
It remains to deal with the condition involving recurrence and balance. We claim
that there is C ∈N such that
ν([σ0, . . . , σℓ−1] ∩Σ−ℓS(C)) > 0 for each (σn) ∈SN and each ℓ≥0.
(3.64)
Indeed, since ν is a Bernoulli measure, [σ0, . . . , σℓ−1] is independent from
Σ−ℓS(C). Thus we have
ν([σ0, . . . , σℓ−1] ∩Σ−ℓS(C)) = ν([σ0, . . . , σℓ−1])ν(S(C))
and the claim (3.64) follows because ν([σ0, . . . , σℓ−1]) > 0 by assumption and
ν(S(C)) > 0 for C large enough by Lemma 3.9.7. By another application of
Poincaré recurrence (3.64) yields that for ν-a.e. σ ∈SN and for every ℓ∈N there
is n > 0 such that Σnσ ∈[σ0, . . . , σℓ−1] and Σn+ℓσ ∈S(C).
Summing up we see that the assumptions of Theorem 3.9.4 are satisﬁed for ν-a.e.
σ ∈SN. Thus Theorem 3.9.5 (1) follows from Theorem 3.5.11, Theorem 3.9.5 (2)
follows from Theorem 3.7.1, and Theorem 3.9.5 (3) follows from Theorem 3.9.4.
⊓⊔
Remark 3.9.9 With small amendments in the conclusion of the proof of Theo-
rem 3.9.5 it is possible to prove Theorem 3.9.5 for soﬁc subshifts (X, Σ, ν) of
(SN, Σ, ν). Even the case of inﬁnitely many substitutions (i.e., |S| = ∞) can be
treated provided that the log-integrability condition (3.60) is satisﬁed. In this case
one has to deal with the S-adic graph introduced in [44]. As mentioned above, the
general result is contained in [52].

184
J. M. Thuswaldner
3.9.5
Corollaries for Arnoux-Rauzy and Brun Systems
We now want to apply the two main theorems to Arnoux-Rauzy as well as Brun S-
adic systems. Since these systems and their related generalized continued fraction
algorithms have been studied quite well in the literature this will yield unconditional
results on measurable conjugacy to a torus rotation, natural codings, and bounded
remainder sets.
We start with the case of Arnoux-Rauzy systems. Let S = {σ1, σ2, σ3} be the
set of Arnoux-Rauzy substitutions deﬁned in (3.18). First we give a version of
Theorem 3.9.5 for the S-adic sequences taken from SN.
Corollary 3.9.10 (See [52, Theorem 3.8]) Let S be the set of Arnoux-Rauzy
substitutions deﬁned in (3.18) and consider the full shift (SN, Σ, ν) equipped with
an ergodic invariant measure ν that assigns positive mass to each cylinder. Then
ν-a.e. σ ∈SN deﬁnes an S-adic system (Xσ, Σ) that is measurably conjugate to a
rotation T on the 2-torus T2. Moreover, each element of Xσ forms a natural coding
of T w.r.t. the partition {Ri : i ∈A} deﬁned by the subtiles of the Rauzy fractal R.
Each of these subtiles is a bounded remainder set of T .
Proof (Sketch) It is easy to see that each cylinder containing each of the three sub-
stitutions has positive incidence matrix. Thus the result follows from Theorem 3.9.5
if we can establish that (SN, Σ, ν) satisﬁes the Pisot condition and that for ν-a.e.
σ ∈SN the associated collection C1 of Rauzy fractals forms a tiling. The fact that the
Pisot condition holds was proved by Avila and Delecroix [28]. The tiling property is
a consequence of Proposition 3.8.8. Indeed, assertion (iii) of this proposition holds
by the following results. Firstly, strong coincidence follows from [37, Proposition 4]
(or [52, Section 9] where “negative coincidence” was used). The other assertion
from Proposition 3.8.8(iii) is a weaker form of the geometric ﬁniteness property
which holds by Proposition 3.8.11 (see also [48, Theorem 4.7]).
⊓⊔
With help of the balance properties of Arnoux-Rauzy sequences proved in [43]
it is possible to use Theorem 3.9.4 in order to show results for concrete Arnoux-
Rauzy systems. For instance it is proved in [52, Corollary 3.9] that any linearly
recurrent Arnoux-Rauzy sequence with recurrent directive sequence generates an
S-adic system (Xσ , Σ) that is measurably conjugate to a rotation on a 2-torus.
For the second class of examples let S = {σ1, σ2, σ3} be the set of Brun
substitutions deﬁned in (3.32). In this case a version of Theorem 3.9.5 completely
analogous to Corollary 3.9.10 holds.
Corollary 3.9.11 (See [52, Theorem 3.10]) Let S be the set of Brun substitutions
deﬁned in (3.32) and consider the full shift (SN, Σ, ν) equipped with an ergodic
invariant measure ν that assigns positive mass to each cylinder. Then ν-a.e. σ ∈SN
deﬁnes an S-adic system (Xσ , Σ) that is measurably conjugate to a rotation T on
the 2-torus T2. Moreover, each element of Xσ forms a natural coding of T w.r.t. the
partition {Ri : i ∈A} deﬁned by the subtiles of the Rauzy fractal R. Each of these
subtiles is a bounded remainder set of T .

3
S-adic Sequences
185
Proof (Sketch) First observe that σ1σ2σ1σ2 has positive incidence matrix. One uses
again [28] to ensure that the Pisot condition holds (see also [83, 102, 118] for
similar results). The tiling property follows from geometric coincidence which is
established in [42] for the Brun class.
⊓⊔
Contrary to the Arnoux-Rauzy continued fraction algorithm, the Brun algorithm
can be performed for all elements (x1, x2) ∈Δ with Δ as in (3.24). Thus, using
Brun systems we get natural codings for a.a. torus rotations t ∈T2.
Corollary 3.9.12 (See [52, Corollary 3.12]) Let S be the set of Brun substitutions
deﬁned in (3.32). Then for almost every t ∈T2 (w.r.t. the Haar measure on T2) there
is σ ∈SN such that the shift (Xσ, Σ) is measurably conjugate to the rotation Tt by
t on T2. Moreover, the sequences in Xσ form natural codings of the rotation Tt.
To create concrete examples of Brun S-adic shifts being measurably conjugate to
a rotation, one can use Theorem 3.9.4 together with the balance results established
in [68].
3.10
Concluding Remarks: Natural Extensions, Flows, and
Their Poincaré Sections
It remains to extend the ideas and results presented in Sect. 3.2.5 to generalized
continued fraction algorithms and S-adic systems on d letters. This is the subject of
the ongoing paper by Arnoux et al. [12].
It is possible to study natural extensions of generalized continued fraction
algorithms (see for instance [19, 21]). In the way we do it in [12], the analogs
of the L-shaped regions of Sect. 3.2.5 are “Rauzy-Boxes” which are deﬁned as
suspensions of S-adic Rauzy fractals. They were introduced in the S-adic setting
in [52, Section 2.9] but have been studied earlier in the substitutive case, see for
instance Ito and Rao [91]. These Rauzy boxes allow nonstationary Markov partitions
for so-called “mapping families” in the sense studied by Arnoux and Fisher [15] that
can be visualized by restacking S-adic Rauzy fractals in a suitable way.
Also Artin’s idea of viewing continued fraction algorithms as Poincaré sections
of the geodesic ﬂow on SL2(Z)\SL2(R) can be generalized. In this generalization
the role of the geodesic ﬂow is played by the Weyl Chamber Flow, a diagonal
Rd−1-action on the space SLd(Z)\SLd(R) of d-dimensional lattices. It turns out
that each coordinate direction of this Rd−1-action has a Poincaré section which is
arithmetically coded by a generalized continued fraction algorithm. Geometrically,
this is visualized by deforming a given Rauzy box (one for each coordinate) by
the action of the Weyl Chamber Flow and restacking it accordingly as soon as a
Poincaré section is reached.
Details of all this will be contained in [12].

186
J. M. Thuswaldner
Acknowledgments I warmly thank Shigeki Akiyama and Pierre Arnoux for inviting me to
contribute to this volume. I very much appreciate their constant encouragement and support, and
the many discussions I had with them. Moreover, I am indebted to Valérie Berthé, Sébastien Labbé,
and Wolfgang Steiner for their suggestions.
References
1. B. Adamczewski, Balances for ﬁxed points of primitive substitutions. Theor. Comput. Sci.
307(1), 47–75 (2003). Words
2. S. Akiyama, Self afﬁne tilings and Pisot numeration systems, in Number Theory and Its
Applications, ed. by K. Gy˝ory, S. Kanemitsu (Kluwer, Dordrecht, 1999), pp. 1–17
3. S. Akiyama, On the boundary of self afﬁne tilings generated by Pisot numbers. J. Math. Soc.
Japan 54(2), 283–308 (2002)
4. S. Akiyama, M. Barge, V. Berthé, J.Y. Lee, A. Siegel, On the Pisot substitution conjecture, in
Mathematics of Aperiodic Order. Progr. Math., vol. 309 (Birkhäuser/Springer, Basel, 2015),
pp. 33–72
5. S. Akiyama, T. Sadahiro, A self-similar tiling generated by the minimal Pisot number, in
Proceedings of the 13th Czech and Slovak International Conference on Number Theory
(Ostravice, 1997), vol. 6 (1998), pp. 9–26
6. J.P. Allouche, J. Shallit, Automatic Sequences: Theory, Applications, Generalizations. (Cam-
bridge University Press, Cambridge, 2003)
7. A. Andres, R. Acharya, C. Sibata, Discrete analytical hyperplanes. Graph. Model. Image
Process. 59, 302–309 (1997)
8. L. Arnold, Random Dynamical Systems. Springer Monographs in Mathematics (Springer,
Berlin, 1998)
9. P. Arnoux, Un exemple de semi-conjugaison entre un échange d’intervalles et une translation
sur le tore. Bull. Soc. Math. France 116(4), 489–500 (1989) (1988)
10. P. Arnoux, Le codage du ﬂot géodésique sur la surface modulaire. Enseign. Math. (2) 40(1-2),
29–48 (1994)
11. P. Arnoux, Continued fractions: natural extensions and invariant measures, in Natural
Extension of Arithmetic Algorithms and S-adic System. RIMS Kôkyûroku Bessatsu, vol. B58
(Res. Inst. Math. Sci. (RIMS), Kyoto, 2016), pp. 19–32
12. P. Arnoux, V. Berthé, M. Minervino, W. Steiner, J. Thuswaldner, Nonstationary Markov
partitions, ﬂows on homogeneous spaces, and continued fractions (2018, in preparation)
13. P. Arnoux, S. Ferenczi, P. Hubert, Trajectories of rotations. Acta Arith. 87(3), 209–217 (1999)
14. P. Arnoux, A.M. Fisher, The scenery ﬂow for geometric structures on the torus: the linear
setting. Chinese Ann. Math. Ser. B 22(4), 427–470 (2001)
15. P. Arnoux, A.M. Fisher, Anosov families, renormalization and non-stationary subshifts.
Ergodic Theory Dyn. Syst. 25(3), 661–709 (2005)
16. P. Arnoux, M. Furukado, E. Harriss, S. Ito, Algebraic numbers, free group automorphisms
and substitutions on the plane. Trans. Am. Math. Soc. 363(9), 4651–4699 (2011)
17. P. Arnoux, E. Harriss, What is . . . a Rauzy fractal? Not. Am. Math. Soc. 61(7), 768–770
(2014)
18. P. Arnoux, S. Ito, Pisot substitutions and Rauzy fractals. Bull. Belg. Math. Soc. Simon Stevin
8(2), 181–207 (2001). Journées Montoises d’Informatique Théorique (Marne-la-Vallée, 2000)
19. P. Arnoux, S. Labbé, On some symmetric multidimensional continued fraction algorithms.
Ergodic Theory Dyn. Syst. 38, 1601–1626 (2018)
20. P. Arnoux, M. Mizutani, T. Sellami, Random product of substitutions with the same incidence
matrix. Theor. Comput. Sci. 543, 68–78 (2014)
21. P. Arnoux, A. Nogueira, Mesures de Gauss pour des algorithmes de fractions continues
multidimensionnelles. Ann. Sci. École Norm. Sup. (4) 26(6), 645–664 (1993)

3
S-adic Sequences
187
22. P. Arnoux, G. Rauzy, Représentation géométrique de suites de complexité 2n + 1. Bull. Soc.
Math. France 119(2), 199–215 (1991)
23. P. Arnoux, T.A. Schmidt, Cross sections for geodesic ﬂows and α-continued fractions.
Nonlinearity 26(3), 711–726 (2013)
24. P. Arnoux, T.A. Schmidt, Commensurable continued fractions. Discrete Contin. Dyn. Syst.
34(11), 4389–4418 (2014)
25. P. Arnoux, Š. Starosta, The Rauzy gasket, in Further Developments in Fractals and Related
Fields. Trends Mathematics (Birkhäuser/Springer, New York, 2013), pp. 1–23
26. E. Artin, Ein mechanisches System mit quasiergodischen Bahnen. Abh. Math. Sem. Univ.
Hamburg 3(1), 170–175 (1924)
27. J. Auslander, Minimal Flows and Their Extensions. North-Holland Mathematics Studies, vol.
153. (North-Holland Publishing Co., Amsterdam, 1988). Notas de Matemática [Mathematical
Notes], 122
28. A. Avila, V. Delecroix, Some monoids of Pisot matrices (2015). Preprint, http://arxiv.org/abs/
1506.03692
29. A. Avila, P. Hubert, A. Skripchenko, Diffusion for chaotic plane sections of 3-periodic
surfaces. Invent. Math. 206(1), 109–146 (2016)
30. A. Avila, P. Hubert, A. Skripchenko, On the Hausdorff dimension of the Rauzy gasket. Bull.
Soc. Math. France 144(3), 539–568 (2016)
31. G. Barat, V. Berthé, P. Liardet, J. Thuswaldner, Dynamical directions in numeration. Ann.
Inst. Fourier (Grenoble) 56(7), 1987–2092 (2006). Numération, pavages, substitutions
32. M. Barge, The Pisot conjecture for β-substitutions. Ergodic Theory Dyn. Syst. 38(2), 444–
472 (2016)
33. M. Barge, Pure discrete spectrum for a class of one-dimensional substitution tiling systems.
Discrete Contin. Dyn. Syst. 36(3), 1159–1173 (2016)
34. M. Barge, B. Diamond, Coincidence for substitutions of Pisot type. Bull. Soc. Math. France
130(4), 619–626 (2002)
35. M. Barge, J. Kellendonk, Proximality and pure point spectrum for tiling dynamical systems.
Mich. Math. J. 62(4), 793–822 (2013)
36. M. Barge, J. Kwapisz, Geometric theory of unimodular Pisot substitutions. Amer. J. Math.
128(5), 1219–1282 (2006)
37. M. Barge, S. Štimac, R.F. Williams, Pure discrete spectrum in substitution tiling spaces.
Discrete Contin. Dyn. Syst. 33(2), 579–597 (2013)
38. A.Y. Belov, G.V. Kondakov, I.V. Mitrofanov, Inverse problems of symbolic dynamics, in
Algebraic Methods in Dynamical Systems. Banach Center Publ., vol. 94 (Polish Acad. Sci.
Inst. Math., Warsaw, 2011), pp. 43–60
39. J. Bernoulli, Sur une nouvelle espece de calcul. Recueil pour les Astronomes, Berlin, vol. 1
(1772), pp. 255–284
40. J. Berstel, Transductions and context-free languages, Leitfäden der Angewandten Mathematik
und Mechanik [Guides to Applied Mathematics and Mechanics], vol. 38 (B. G. Teubner,
Stuttgart, 1979)
41. V. Berthé, Multidimensional Euclidean algorithms, numeration and substitutions. Integers
11B, A2 (2011)
42. V. Berthé, J. Bourdon, T. Jolivet, A. Siegel, A combinatorial approach to products of Pisot
substitutions. Ergodic Theory Dyn. Syst. 36(6), 1757–1794 (2016)
43. V. Berthé, J. Cassaigne, W. Steiner, Balance properties of Arnoux-Rauzy words. Int. J.
Algebra Comput. 23(4), 689–703 (2013)
44. V. Berthé, V. Delecroix, Beyond substitutive dynamical systems: S-adic expansions. RIMS
Lecture Note ‘Kôkyûroku Bessatsu’ B46, 81–123 (2014)
45. V. Berthé, E. Domenjoud, D. Jamet, X. Provençal, Fully subtractive algorithm, tribonacci
numeration and connectedness of discrete planes, in Numeration and Substitution 2012.
RIMS Kôkyûroku Bessatsu, vol. B46 (Res. Inst. Math. Sci. (RIMS), Kyoto, 2014), pp. 159–
174

188
J. M. Thuswaldner
46. V. Berthé, S. Ferenczi, L.Q. Zamboni, Interactions between dynamics, arithmetics and
combinatorics: the good, the bad, and the ugly, in Algebraic and Topological Dynamics.
Contemp. Math., vol. 385 (American Mathematical Society, Providence, RI, 2005), pp. 333–
364
47. V. Berthé, C. Holton, L.Q. Zamboni, Initial powers of Sturmian sequences.
Acta Arith.
122(4), 315–347 (2006)
48. V. Berthé, T. Jolivet, A. Siegel, Substitutive Arnoux-Rauzy sequences have pure discrete
spectrum. Unif. Distrib. Theory 7(1), 173–197 (2012)
49. V. Berthé, S. Labbé, Factor complexity of S-adic words generated by the Arnoux-Rauzy-
Poincaré algorithm. Adv. Appl. Math. 63, 90–130 (2015)
50. V. Berthé, M. Minervino, W. Steiner, J. Thuswaldner, The S-adic Pisot conjecture on two
letters. Topology Appl. 205, 47–57 (2016)
51. V. Berthé, A. Siegel, J.M. Thuswaldner, Substitutions, Rauzy fractals, and tilings, in Combi-
natorics, Automata and Number Theory. Encyclopedia of Mathematics and its Applications,
vol. 135 (Cambridge University Press, Cambridge, 2010)
52. V. Berthé, W. Steiner, J.M. Thuswaldner, Geometry, dynamics, and arithmetic of S-adic shifts.
Ann. Inst. Fourier (Grenoble) 69(3), 1347–1409 (2019)
53. S. Bezuglyi, J. Kwiatkowski, K. Medynets, B. Solomyak, Invariant measures on stationary
Bratteli diagrams. Ergodic Theory Dyn. Syst. 30(4), 973–1007 (2010)
54. S. Bezuglyi, J. Kwiatkowski, K. Medynets, B. Solomyak, Finite rank Bratteli diagrams:
structure of invariant measures. Trans. Am. Math. Soc. 365(5), 2637–2679 (2013)
55. G. Birkhoff, Extensions of Jentzsch’s theorem. Trans. Am. Math. Soc. 85, 219–227 (1957)
56. M. Boshernitzan, A unique ergodicity of minimal symbolic ﬂows with linear block growth.
J. Anal. Math. 44, 77–96 (1984/85)
57. P. Boyland, W. Severa, Geometric representation of the inﬁmax S-adic family. Fundam. Math.
240(1), 15–50 (2018)
58. A.J. Brentjes, Multidimensional continued fraction algorithms, Mathematical Centre Tracts,
vol. 145 (Mathematisch Centrum, Amsterdam, 1981)
59. V. Brun, Algorithmes euclidiens pour trois et quatre nombres, in Treizième congrès des
mathèmaticiens scandinaves, tenu à Helsinki 18-23 août 1957 (Mercators Tryckeri, Helsinki,
1958), pp. 45–64
60. E.B. Burger, J. Gell-Redman, R. Kravitz, D. Walton, N. Yates, Shrinking the period lengths
of continued fractions while still capturing convergents. J. Number Theory 128(1), 144–153
(2008)
61. V. Canterini, A. Siegel, Geometric representation of substitutions of Pisot type. Trans. Am.
Math. Soc. 353(12), 5121–5144 (2001)
62. J. Cassaigne, S. Ferenczi, A. Messaoudi, Weak mixing and eigenvalues for Arnoux-Rauzy
sequences. Ann. Inst. Fourier (Grenoble) 58(6), 1983–2005 (2008)
63. J. Cassaigne, S. Ferenczi, L.Q. Zamboni, Imbalances in Arnoux-Rauzy sequences. Ann. Inst.
Fourier (Grenoble) 50(4), 1265–1276 (2000)
64. J. Cassaigne, S. Labbé, J. Leroy, A set of sequences of complexity 2n + 1, in Combinatorics
on Words. Lecture Notes in Comput. Sci., vol. 10432 (Springer, Cham, 2017), pp. 144–156
65. J. Cassaigne, F. Nicolas, Factor complexity, in: Combinatorics, Automata and Number
Theory. Encyclopedia Math. Appl., vol. 135 (Cambridge University Press, Cambridge, 2010),
pp. 163–247
66. M.I. Cortez, F. Durand, B. Host, A. Maass, Continuous and measurable eigenfunctions of
linearly recurrent dynamical Cantor systems. J. Lond. Math. Soc. (2) 67(3), 790–804 (2003)
67. E.M. Coven, G.A. Hedlund, Sequences with minimal block growth. Math. Systems Theory
7, 138–153 (1973)
68. V. Delecroix, T. Hejda, W. Steiner, Balancedness of Arnoux-Rauzy and Brun words, in
WORDS. Lecture Notes in Computer Science, vol. 8079, pp. 119–131 (Springer, Berlin, 2013)
69. R. DeLeo, I.A. Dynnikov, Geometry of plane sections of the inﬁnite regular skew polyhedron
{4, 6 | 4}. Geom. Dedicata 138, 51–67 (2009)

3
S-adic Sequences
189
70. J.M. Dumont, A. Thomas, Systemes de numeration et fonctions fractales relatifs aux
substitutions. Theor. Comput. Sci. 65(2), 153–169 (1989)
71. F. Durand, Linearly recurrent subshifts have a ﬁnite number of non-periodic subshift factors.
Ergodic Theory Dyn. Syst. 20, 1061–1078 (2000)
72. F. Durand, Corrigendum and addendum to: “Linearly recurrent subshifts have a ﬁnite number
of non-periodic subshift factors” [Ergodic Theory Dynam. Systems 20 (2000), no. 4, 1061–
1078]. Ergodic Theory Dyn. Syst. 23, 663–669 (2003)
73. F. Durand, J. Leroy, G. Richomme, Do the properties of an S-adic representation determine
factor complexity? J. Integer Seq. 16(2), Article 13.2.6, 30 pp. (2013)
74. H. Ei, Some properties of invertible substitutions of rank d, and higher dimensional
substitutions. Osaka J. Math. 40(2), 543–562 (2003)
75. H. Ei, S. Ito, H. Rao, Atomic surfaces, tilings and coincidences. II. Reducible case. Ann. Inst.
Fourier (Grenoble) 56(7), 2285–2313 (2006). Numération, pavages, substitutions
76. M. Einsiedler, T. Ward, Ergodic Theory with a View Towards Number Theory. Graduate Texts
in Mathematics, vol. 259 (Springer, London, 2011)
77. S. Ferenczi, Rank and symbolic complexity. Ergodic Theory Dyn. Syst. 16(4), 663–682
(1996)
78. S. Ferenczi, A.M. Fisher, M. Talet, Minimality and unique ergodicity for adic transformations.
J. Anal. Math. 109, 1–31 (2009)
79. T. Fernique, Multidimensional Sturmian sequences and generalized substitutions. Int. J.
Found. Comput. Sci. 17(3), 575–599 (2006)
80. T. Fernique, Generation and recognition of digital planes using multi-dimensional continued
fractions, in Discrete Geometry for Computer Imagery. Lecture Notes in Comput. Sci., vol.
4992 (Springer, Berlin, 2008)
81. A.M. Fisher, Nonstationary mixing and the unique ergodicity of adic transformations.
Stochastics Dyn. 9(3), 335–391 (2009)
82. N.P. Fogg, Substitutions in Dynamics, Arithmetics and Combinatorics. Lecture Notes in
Mathematics, vol. 1794 (Springer, Berlin, 2002)
83. T. Fujita, S. Ito, M. Keane, M. Ohtsuki, On almost everywhere exponential convergence of
the modiﬁed Jacobi-Perron algorithm: a corrected proof. Ergodic Theory Dyn. Syst. 16(6),
1345–1352 (1996)
84. H. Furstenberg, Stationary Processes and Prediction Theory. Annals of Mathematics Studies,
No. 44 (Princeton University Press, Princeton, NJ, 1960)
85. P.R. Halmos, Lectures on Ergodic Theory (Chelsea Publishing Co., New York, 1960)
86. C. Holton, L.Q. Zamboni, Geometric realizations of substitutions. Bull. Soc. Math. France
126(2), 149–179 (1998)
87. J.E. Hopcroft, J.D. Ullman, Introduction to Automata Theory, Languages, and Computation.
Addison-Wesley Series in Computer Science (Addison-Wesley Publishing Co., Reading, MA,
1979).
88. P. Hubert, A. Messaoudi, Best simultaneous Diophantine approximations of Pisot numbers
and Rauzy fractals. Acta Arith. 124(1), 1–15 (2006)
89. S. Ito, M. Kimura, On Rauzy fractal. Japan J. Ind. Appl. Math. 8(3), 461–486 (1991)
90. S. Ito, M. Ohtsuki, Parallelogram tilings and Jacobi-Perron algorithm. Tokyo J. Math. 17(1),
33–58 (1994)
91. S. Ito, H. Rao, Atomic surfaces, tilings and coincidence. I. Irreducible case. Israel J. Math.
153, 129–155 (2006)
92. D. Jamet, N. Lafrenière, X. Provençal, Generation of digital planes using generalized
continued-fractions algorithms, in Discrete Geometry for Computer Imagery. Lecture Notes
in Comput. Sci., vol. 9647, pp. 45–56 (Springer, Cham, 2016)
93. D. Jamet, J.L. Toutant, On the connectedness of rational arithmetic discrete hyperplanes,
in Discrete Geometry for Computer Imagery. Lecture Notes in Comput. Sci., vol. 4245,
(Springer, Berlin, 2006), pp. 223–234
94. A. Katok, Interval exchange transformations and some special ﬂows are not mixing. Israel J.
Math. 35(4), 301–310 (1980)

190
J. M. Thuswaldner
95. S. Labbé, 3-dimensional continued fraction algorithms cheat sheets (2015). http://arxiv.org/
abs/1511.08399
96. J. Lagarias, Y. Wang, Self-afﬁne tiles in Rn. Adv. Math. 121, 21–49 (1996)
97. J. Leroy, Some improvements of the S-adic conjecture. Adv. Appl. Math. 48(1), 79–98 (2012)
98. J. Leroy, An S-adic characterization of minimal subshifts with ﬁrst difference of complexity
1 ≤p(n + 1) −p(n) ≤2. Discrete Math. Theor. Comput. Sci. 16(1), 233–286 (2014)
99. G. Levitt, La dynamique des pseudogroupes de rotations. Invent. Math. 113(3), 633–670
(1993)
100. B. Loridant, M. Minervino, Geometrical models for a class of reducible Pisot substitutions.
Discrete Comput. Geom. 60, 981–1028 (2018)
101. M. Lothaire, Algebraic Combinatorics on Words. Encyclopedia of Mathematics and its
Applications, vol. 90 (Cambridge University Press, Cambridge, 2002). A collective work
by J. Berstel, D. Perrin, P. Seebold, J. Cassaigne, A. De Luca, S. Varricchio, A. Lascoux,
B. Leclerc, J.-Y. Thibon, V. Bruyere, C. Frougny, F. Mignosi, A. Restivo, C. Reutenauer,
D. Foata, G.-N. Han, J. Desarmenien, V. Diekert, T. Harju, J. Karhumaki and W. Plandowski,
with a preface by J. Berstel and D. Perrin
102. R. Meester, A simple proof of the exponential convergence of the modiﬁed Jacobi-Perron
algorithm. Ergodic Theory Dyn. Syst. 19(4), 1077–1083 (1999)
103. A. Messaoudi, Frontière du fractal de Rauzy et système de numération complexe. Acta Arith.
95(3), 195–224 (2000)
104. A. Messaoudi, Propriétés arithmétiques et topologiques d’une classe d’ensembles fractales.
Acta Arith. 121(4), 341–366 (2006)
105. M. Minervino, W. Steiner, Tilings for Pisot beta numeration. Indag. Math. (N.S.) 25(4), 745–
773 (2014)
106. M. Minervino, J.M. Thuswaldner, The geometry of non-unit Pisot substitutions. Ann. Inst.
Fourier (Grenoble) 64(4), 1373–1417 (2014)
107. M. Morse, G.A. Hedlund, Symbolic dynamics II. Sturmian trajectories. Am. J. Math. 62,
1–42 (1940)
108. H. Nakada, S. Ito, S. Tanaka, On the invariant measure for the transformations associated with
some real continued-fractions. Keio Eng. Rep. 30(13), 159–175 (1977)
109. O. Perron, Grundlagen für eine Theorie des Jacobischen Kettenbruchalgorithmus. Math. Ann.
64(1), 1–76 (1907)
110. M. Queffélec, Substitution Dynamical Systems—Spectral Analysis. Lecture Notes in Mathe-
matics, vol. 1294, 2nd edn. (Springer, Berlin, 2010)
111. C. Radin, M. Wolff, Space tilings and local isomorphism. Geom. Dedicata 42(3), 355–360
(1992)
112. G. Rauzy, Une généralisation du développement en fraction continue, in Séminaire Delange-
Pisot-Poitou, 18e année: 1976/77, Théorie des nombres, Fasc. 1, pp. Exp. No. 15, 16
(Secrétariat Math., Paris, 1977)
113. G. Rauzy, échanges d’intervalles et transformations induites. Acta Arith. 34(4), 315–328
(1979)
114. G. Rauzy, Nombres algébriques et substitutions. Bull. Soc. Math. France 110(2), 147–178
(1982)
115. J.P. Reveillès, Géométrie discrète, calculs en nombres entiers et algorithmes. Ph.D. thesis,
Université Louis Pasteur, Strasbourg (1991)
116. V.A. Rohlin, Exact endomorphism of a Lebesgue space. Magyar Tud. Akad. Mat. Fiz. Oszt.
Közl. 14, 443–474 (1964)
117. Y. Sano, P. Arnoux, S. Ito, Higher dimensional extensions of substitutions and their dual maps.
J. Anal. Math. 83, 183–206 (2001)
118. B.R. Schratzberger, The exponent of convergence for Brun’s algorithm in two dimensions.
Österreich. Akad. Wiss. Math.-Natur. Kl. Sitzungsber. II 207, 229–238 (1999) (1998)
119. F. Schweiger, Multidimensional Continued Fractions Oxford Science Publications (Oxford
University Press, Oxford, 2000)

3
S-adic Sequences
191
120. E.S. Selmer, Continued fractions in several dimensions. Nordisk Nat. Tidskr. 9, 37–43, 95
(1961)
121. C. Series, The modular surface and continued fractions. J. London Math. Soc. (2) 31(1), 69–
80 (1985)
122. A. Siegel, Représentation des systèmes dynamiques substitutifs non unimodulaires. Ergodic
Theory Dyn. Syst. 23(4), 1247–1273 (2003)
123. A. Siegel, J.M. Thuswaldner, Topological properties of Rauzy fractals. Mém. Soc. Math. Fr.
(N.S.) 118, 144pp (2009)
124. V.F. Sirvent, Y. Wang, Self-afﬁne tiling via substitution dynamical systems and Rauzy fractals.
Pac. J. Math. 206(2), 465–485 (2002)
125. M. Viana, Ergodic theory of interval exchange maps. Rev. Mat. Complut. 19(1), 7–100 (2006)
126. P. Walters, An Introduction to Ergodic Theory. Graduate Texts in Mathematics, vol. 79
(Springer, New York, 1982)

Chapter 4
Operators, Algebras and Their
Invariants for Aperiodic Tilings
Johannes Kellendonk
Abstract We review the construction of operators and algebras from tilings of
Euclidean space. This is mainly motivated by physical questions, in particular after
topological properties of materials. We explain how the physical notion of locality
of interaction is related to the mathematical notion of pattern equivariance for
tilings and how this leads naturally to the deﬁnition of tiling algebras. We give a
brief introduction to the K-theory of tiling algebras and explain how the algebraic
topology of K-theory gives rise to a correspondence between the topological
invariants of the bulk and its boundary of a material.
4.1
Tilings and the Topology of Their Hulls
In condensed matter theory tilings are used to describe the spatial arrangement of
the constituents which make up a material, for instance a quasicrystal. They describe
the spatial structure of the material.
Associated to a tiling are various topological spaces and topological dynamical
systems. Their topology is peculiar. It takes into account the topology of the space
in which the tiling lies and, at the same time, its pattern structure, that is, the way
how ﬁnite patterns repeat over the tiling. Continuity in the tiling topology is related
to locality in physics.
J. Kellendonk ()
Institute Camille Jordan, Université Claude Bernard Lyon1, Villeurbanne, France
e-mail: kellendonk@math.univ-lyon1.fr
© The Editor(s) (if applicable) and The Author(s), under exclusive license
to Springer Nature Switzerland AG 2020
S. Akiyama, P. Arnoux (eds.), Substitution and Tiling Dynamics: Introduction
to Self-inducing Structures, Lecture Notes in Mathematics 2273,
https://doi.org/10.1007/978-3-030-57666-0_4
193

194
J. Kellendonk
4.1.1
Basic Notions
There exist various introductions to the theory of aperiodic tilings which cover
the basic notions we need, for instance [4, 41]. We recall here only the strict
necessary.
•
A tiling is a covering of Rd by tiles whose interiors do not overlap.
•
A tile is here a possibly decorated compact convex polyhedron. The polyhedron
(up to translational congruence) is its shape. The decoration is by symbols from
a symbol set A and serves to distinguish equal shapes (or enforce matching
conditions). We assume that tiles match face to face.
•
The tiles of a tiling at different positions are considered different. If the tiling has
only ﬁnitely many tiles up to translation and only ﬁnitely many symbols then it
is said to have ﬁnite local complexity (FLC).
Examples are Voronoi tilings (or their dual) coming from Delone sets.
A tiling T can be translated by a vector x ∈Rd in the space it lies. By this we
mean that the individual tiles are shifted by x. We denote the tiling translated by x
as T +x (the tile which has been on the origin 0 of the space in which T lies is now
on x). A period of a tiling is a vector x ∈Rd such that T + x = T . Aperiodicity
may occur through the shapes of the tiles, like for instance in the Penrose tilings, or
through the decorations, or through both. In order not to overburden the notation and
complexity we now consider the ﬁrst two cases separately and only indicate how to
do the third.
4.1.2
Undecorated Tilings
An undecorated tiling by compact convex polyhedra without decorations can be
equivalently described as the closed subset of Rd given by the union of the
boundaries of its tiles. In the following we attach a language and a hull to any closed
subset of Rd.
Let T be a closed subset of Rd. For R ≥0 and x ∈Rd, the R-patch of T
centered at x is intersection of the R-ball at x with T , union with the boundary of
the R-ball,
BR[T ; x] := (BR(x) ∩T ) ∪∂BR(x).
The R-patch class of an R-patch BR[T ; x] is its translational congruence class. The
representative of the R-patch class of BR[T ; x] at 0 is BR[T ; x]−x = BR[T −x; 0],
we simply denote it by BR[T −x].

4
Operators, Algebras and Their Invariants for Aperiodic Tilings
195
Using R-patches we deﬁne a metric-topology on the set of all closed subsets of
Rd. Let T , T ′ be two closed subsets, their distance is
D(T , T ′) = inf{ϵ : dH(Bϵ−1[T ], Bϵ−1[T ′]) ≤ϵ}
where dH is the Hausdorff distance between the set of all compact subsets of
Bϵ−1(0) which contain ∂Bϵ−1(0). We call L(T ) = 
R≥0 LR(T ),
LR(T ) = {BR[T −x] : x ∈Rd}
dH
the language of T . We say that a closed subset T ′ of Rd is allowed for the language
of T if each R-patch-class of T ′ occurs in L(T ). The set of all closed subsets which
are allowed for T is called the continuous hull of T and denoted by Ω(T ). If R′ ≤R
we have a continuous map LR(T ) ∋BR[T ′] →BR′[T ′] ∈LR′(T ) associating to
the R′-patch of T ′ its restriction to the ball of smaller radius R. The hull Ω(T )
can be seen as the inverse limit of these maps. In particular, the metric topology on
Ω(T ) is the same as the inverse limit topology, namely it is the smallest topology
so that all the maps Ω(T ) ∋T ′ →BR[T ′] ∈LR(T ) are continuous.
Examples:
1. If T is bounded then Ω(T ) is the d-sphere.
2. If Λ is a regular lattice in Rd and T has period lattice Λ then Ω(T ) is the torus
Rd/Λ.
3. If T is a hyperplane of dimension k then Ω(T ) is the d −k-sphere, its south pole
corresponds to T and its north pole to the empty set.
Applied to an undecorated tiling this construction yields its continuous hull. If
T has FLC then {BR[T −x] : x ∈Rd} is already closed in the Hausdorff topology
and so any R-patch of LR(T ) has a translate occuring in T . Then Ω(T ) is the set
of all tilings of Rd whose R-patches occur somewhere in T .
4.1.3
Wang Tilings
Consider an (undecorated) tiling T whose vertex set V happens to lie in a regular
lattice Λ ⊂Rd. Choose a closed fundamental domain I (a parallel epiped) for
Λ and superimpose T with the periodic tiling whose tiles are I + λ, λ ∈Λ.
Then the boundary points of the tiles of T mark on the tiles of the periodic tiling
patterns which we can take as symbols, and thus our tiling T can be alternatively
described by a tiling by decorated parallel epipeds. The two tilings contain the
same information, they can be transformed into each other by inspection of their R-
patches. This is an example of mutual local derivability [5] the deﬁnition of which
we recall further down. The tiling by decorated parallel epipeds is a so-called Wang
tiling.

196
J. Kellendonk
A Wang tiling is a tiling in which all tiles are cubes meeting face to face (or a
parallel epipeds, but we can always apply a linear transformation to deform it into a
cube), but the tiles carry decorations1 and so Wang tilings may be aperiodic. Once
we have ﬁxed which tile contains the origin 0 of our space, the set of tiles of the
tiling are in bijective correspondence to Zd and their decorations may be described
by a map into a space of decorations, or symbols, ξ : Zd →A. This suggests a
more symbolic approach to the construction of the hull, and so we start with the
description of the symbolic hull of a Wang tiling. We suppose that A is a compact
set and if it is ﬁnite the Wang tiling is said to have ﬁnite local complexity. The
(symbolic) N-patch of a Wang tiling at n ∈Zd is the decoration of the cube of size
2N + 1 at n, more precisely, this is the subset {ξn+m : ∥m∥max ≤N} ⊂A[−N,N]d .
The (symbolic) language of ξ is ℓ(ξ) = 
N ℓN(ξ) where ℓN(ξ) is the closure of
the set of N-patches of ξ (shifted to 0) in A[−N,N]d . We can make the same inverse
limit construction as above to obtain the symbolic hull of the Wang tiling which we
denote Ξ(ξ) or simply Ξ if the context is clear.
The additional information which is needed to construct from a the map ξ :
Zd →A a tiling of Rd is the location of the origin, that is, a choice of point x in the
cube I. Given such a point the Wang tiling symbolized by ξ is placed in Rd in such
a way that the point x lies on the origin of our space if we identify I with the tile
corresponding to 0 ∈Zd (so with symbol ξ0). The continuous hull Ω of the Wang
tiling is then the quotient of I × Ξ by the following relation: If x belongs to the
boundary of I then the origin of our space will be in two or more tiles of the Wang
tiling. These possibilities have to be identiﬁed. More precisely, if α : AZd →AZd
denotes the translation action, αm(ξ)(n) = ξ(n −m), then
Ω = Rd ×Zd Ξ
which is the quotient of the cartesian product w.r.t. the diagonal action, i.e. w.r.t. the
relation (x, ξ) ∼(x + m, αm(ξ)). The continuous hull Ω is thus a ﬁbre bundle over
the d-torus Rd/Zd with typical ﬁbre Ξ.
4.1.4
Pattern Equivariant Functions and Local Derivability
The notion of pattern equivariant functions has been introduced for tilings of ﬁnite
local complexity in [27]. We extend here this notion to arbitrary tilings.
Let T be a closed subset. A map f from Rd to a topological space Y is called
strongly pattern equivariant for T (or local) if there exist R ≥0 and a continuous
function b : LR(T ) →Y (a sort of continuous sliding block code) such that
f (x) = b(BR[T −x]).
1Originally the decorations encode matching conditions, but we will not make use of that here.

4
Operators, Algebras and Their Invariants for Aperiodic Tilings
197
In particular, if the R-patch of T at x, when shifted by the vector y −x coincides
with the R-patch of T at y then f (x) = f (y). If Y is a metric space then we deﬁne
(weakly) pattern equivariant functions as functions from Rd to Y which are uniform
limits of strongly pattern equivariant functions.
A closed subset T ′ is locally derivable from a closed subset T if there exists
R > 0 and a continuous function b : LR(T ) →L1(T ′) (a local rule) such that
B1[T ′ −x] = b(BR[T −x])
(4.1)
for all x ∈Rd. In other words, we can construct the 1-patch of T ′ at x from the
R-patch class of T at x. If T ′ is locally derivable from T and vice versa we say
that the two are mutually locally derivable. Since (4.1) has to hold for all x ∈Rd
there is, for each r > 0, a unique extension br : LR+r(T ) →L1+r(T ′) such
that B1+r[T ′ −x] = br(BR+r[T −x]). The br are also continuous and so a local
derivation extends to a continuous map from the hull of T to the hull of T ′.
Note that if S is locally derivable from T , then the local rule b allows to locally
derive a set S(T ′) for any other element of Ω(T ). Any locally derivable uniformly
discrete subset S from T deﬁnes a transversal
ΞS = {T ′ ∈Ω : 0 ∈S(T ′)}.
Since s ∈S(T ′) if and only if 0 ∈S(T ′ −s) we see that
S(T ′) = {x ∈Rd : T ′ −x ∈ΞS}.
Clearly, the vertex set V of a tiling T is locally derivable. We call ΞV the canonical
transversal of Ω(T ).
Let F : Rd →Rd be a differentiable function whose differential dF is strongly
pattern equivariant for an undecorated tiling T . We can apply F to the vertex set V
of T to obtain a new set V′ = F(V) which we would like to interprete as vertex
set of a new tiling T ′. If dF is close enough to the identity we can do this by (a)
requiring that the new tiles are the convex hulls of their vertices, and (b) preserving
the combinatorial structure, that is, the information which vertices are vertices of the
same tile. One may think of F as being homotopic to the identity and the new tiling
to be obtained by a continuous deformation. At least if T is FLC it can be shown
that, if dF is close enough to the identity then F is invertible and dF −1 is strongly
pattern equivariant for T ′. This then implies that F induces a homeomorphism
F : Ω(T ) →Ω(T ′) which maps ΞV(T ) to ΞV′(T ′). Using this technique of
deformation [10, 28] one can show the following result.
Theorem 4.1.1 ([43]) Let T be a tiling of ﬁnite local complexity. There exists a
tiling T ′ of ﬁnite local complexity whose vertices lie in a regular lattice and a
homeomorphism between the continuous hulls of T and T ′ which preserves the
canonical transversals.

198
J. Kellendonk
Up to homeomorphisms preserving the canonical transversals any tiling of FLC can
therefore be understood as a Wang tiling. Indeed, if the vertices V′ lie in a regular
lattice Λ then Λ must be locally derivable from T ′ and so we may identify ΞΛ(T ′)
with {0} × Ξ where Ξ is the symbolic hull of the Wang tiling described above. It
then follows that the continuous hulls of T ′ and of the Wang tiling also agree.
4.2
Operators from Tilings
We are interested in wave phenomena in a media whose structures are modeled
by tilings. The waves might either be probability waves of quantum mechanics,
or classical waves, like light or acoustic waves. The waves are solutions of wave
equations, like the Schrödinger equation or the Helmholtz equation, which typically
are differential equations. Assuming that the waves satisfy the superposition
principle and the equations are linear, the stationary problem consists of solving
an eigenvalue equation in the Hilbert space L2(Rd), or more precisely to determine
the spectrum of a linear differential operator H on L2(Rd).
If no external forces are present then the locality principle requires that the
differential operator H has the form
H =

α
fαDα
where Dαψ = 2d
i=1
 ∂
∂xi
	αiψ for α ∈Nd, and the coefﬁcients fα are pattern
equivariant functions on Rd for the underlying tiling, typically non-zero only for
a ﬁnite number of α. External magnetic ﬁelds can be incorporated by minimal
coupling, but we won’t consider that case here.
H is typically an unbounded operator on L2(Rd) which requires a certain amount
of care, in particular as we will want to attach it to a C∗-algebra. This could be
done by considering bounded functions of H, like the heat-kernel exp(−tH) or the
resolvent (H −x)−1, but alternatively by considering so-called tight binding models
whose operators are from the start bounded. This is what we will do here.
4.2.1
Tight Binding Operators
Let S be a Delone set which is locally derivable from a tiling T . For instance, the
vertex set of T is locally derivable from T . A tight binding operator is an operator
on ℓ2(S, CN) of the form
Hψ(x) =

y∈S
Hxyψ(y)
(4.2)

4
Operators, Algebras and Their Invariants for Aperiodic Tilings
199
where, for each pair (x, y), Hxy is an N × N matrix. If there is an R > 0 such that
Hxy = 0 provided |y −x| > R the model has ﬁnite range and convergence of the
sum is not an issue. The locality principle now translates into the requirement that
the Hxy are pattern equivariant in the following sense: We call double R-patch at
(x, y) ⊂Rd × Rd the set
BR[T ; x, y] := BR[T ; x] × BR[T ; y] ⊂Rd × Rd
and its class [BR[T ; x, y]] the equivalence class under the diagonal action of Rd,
(t, t′) + x = (t + x, t′ + x). The distance ∥x −y∥between x and y is called the
range of the double R-patch at (x, y). The set of double R-patch classes of closed
subsets to Rd is a metric space w.r.t. the Hausdorff metric.2 A function Rd × Rd ∋
(x, y) →Y is then strongly pattern equivariant if, for some R, M > 0, there is a
continuous function b deﬁned on the set double R-patch classes with range smaller
or equal to M such that f (x, y) = b([BR[T ; x, y]]).
A simple example of an operator of the form (4.2) is the discrete Laplacian on
the Penrose tiling. Here S is the vertex set of the tiling, N = 1, Hxy = 1 if x and y
are vertices of a common edge whereas Hxy = 0 otherwise.
4.2.2
Tight Binding Operators for Wang Tilings
If the vertex set of T lies in a regular lattice Λ then we may take S = Λ ∼= Zd above
and rewrite (4.2) as
Hψ(x) =

n∈Zd
Hn(x)ψ(x −n)
(4.3)
for ψ ∈ℓ2(Zd, CN), where Hn(x) = Hx x−n. H has ﬁnite rank if Hn = 0 once n is
larger than a given size. The above notion of pattern equivariance using double R-
classes simpliﬁes and we only have to make sure that Hn : Zd →MN(C) is strongly
pattern equivariant for each n ∈Zd. H depends thus only on the symbolic sequence
ξ : Zd →A of the Wang tiling derived from T and S. Using the translation
operators on Zd, T nψ(x) = ψ(x −n) we can write
H =

n∈Zd
HnT n.
By Theorem 4.1.1, any operator of the form (4.2) on a tiling of FLC can be brought
into the form (4.3). This applies, for instance, also to the discrete Laplacian on the
2The Hausdorff metric between equivalence classes of compact sets is the inﬁmum over the
Hausdorff distances between representatives of the classes.

200
J. Kellendonk
Penrose tiling, even though the version written in the form (4.3) might look a lot
more complicated and does not display its ﬁvefold symmetry. But the form (4.3)
has important structural consequences which, in particular, allow us to work with
crossed product algebras instead of more general groupoid algebras.
4.2.3
A Simple Class of One-dimensional Models
To illustrate the different phenomena which can occur in different type of tilings we
consider four simple tight binding models deﬁned on one-dimensional Wang tilings.
The reader may consult [31] for more details.
Given a symbolic sequence ξ ∈AZ over some symbol space A, we consider the
following operators on ℓ2(Z, CN).
1. H = H0 + T + T ∗with H0(n) = b(ξn) for some real block sliding code b :
A →R of range 0 (N = 1). H is the discrete Laplacien on Zd plus an onsite
potential which depends only on the symbol at site x.
2. H =
 0 Q∗
Q 0

with Q = 
n∈Z QnT n with Qn(m) = bn(ξm) for complex block
sliding codes of ﬁnite range bn : ℓL(A) →C, only ﬁnitely many being non-
zero (N = 2). H is the Hamlitonian of a typical one dimensional tight binding
model of ﬁnite range with chiral symmetry, namely H anti-commutes with the
self adjoint unitary Γ =
1 0
0 −1

.
The sequences ξ we consider here are obtained from a cut & project scheme with
dimension and codimension equal to one, namely they are constructed as follows.
For a given irrational number θ ∈[0, 1] we consider the Kronecker ﬂow line
L := {(t, θ′t)|t ∈R}/Z2
on the torus R2/Z2 with slope θ′ =
θ
1−θ (see the red sloped line in the pictures
(1–3)). A window W is a (not necessarily connected) curve in the torus which is
transversal to the ﬂow in the sense that there exists ϵ > 0 such that for every point
w ∈W and all 0 < |t| < ϵ, w + (t, θ′t) ̸= W. We consider three types of windows.
In picture (1) W is a closed continuous (blue) curve with a single slope, in (2) W
a closed continuous curve with more than one slope. Finally in Picture (3) W has
a single slope but is not a closed loop. It makes a jump, and we suppose that the
boundary points of W belong to W and lie on a line parallel to L, but not equal to L.

4
Operators, Algebras and Their Invariants for Aperiodic Tilings
201
θ
)
3
(
)
2
(
)
1
(
We parametrize the intersection of L with window W by a sequence of real numbers
(tn)n∈Z, that is, (tn, θ′tn) ∈W + Z2, ordered according to the standard order of the
real line (there is an irrelevant choice of which element is the zeroth one). The
symbolic sequence we are looking at is ξn = tn+1 −tn, so A is a compact subset
of R+.
If one computes the symbolic hull Ξ of ξ one ﬁnds the following. Except for
an important subtlety in the third case, all elements of the hull can be obtained by
moving W relative to L and repeating the same construction: take s ∈S := {(t, 1 −
t)|0 ≤t < 1}, parametrize the intersection of L with s +W, (tn, θ′tn) ∈s +W +Z2
and set ξn(s) = tn+1 −tn. The choice of zeroth element coherent by demanding it to
change continuously with s, which is possible except at the two points s for which
(t0, θ′t0) ∈s + ∂W + Z2.
(1) If the window W is a closed continuous curve with a single slope then the
sequence ξ is periodic and the hull consists of a single point. The models
introduced above with periodic ξ have a band spectrum.
(2) If the transversal W is a closed continuous curve with more than one slope, then
the sequence ξ is aperiodic and takes inﬁnitely many values (it has inﬁnite local
complexity). Sequences of this type are almost periodic in the sense of Bohr.
Physically they describe incommensurate structures. With an appropriate shape
for W and b(ξn) = λξn the operator H = H0 + T + T ∗is the Harper model.
The computation of its spectral properties has a long history [34]. Its spectrum
is a Cantor set [3]. Its spectral type depends on the value of λ. Below a critical
value for λ the operator has absolute continuous spectrum, at the critical value
it has singular continuous spectrumn, and above that critical value it has pure
point spectrum (for almost all θ) [24].
The map S ∋s →ξ(s) ∈Ξ is bijective and continuous and so yields
a homeomorphism between the circle S and the symbolic hull Ξ. We may
parametrize S in such a way that the shift action on Ξ corresponds to the
rotation by θ.
(3) If the window W is a discontinuous curve with a single slope then the sequences
ξ are so-called Sturmian sequences. They are aperiodic and have ﬁnite local
complexity. They are also referred to as quasi-periodic, because such structures
are used for one dimensional quasicrystals. With the choice of W as in the
picture (3) there are only two possible values for ξn, let’s call them a and b,

202
J. Kellendonk
a > b. If the onsite potential of the above model H = H0 + T + T ∗takes
different values on a and b, we have the so-called Kohmoto model. Its spectrum
is expected to be a Cantor set and singular continuous; this could be rigorously
proven for the value of θ which corresponds to the Fibonacci sequence [14].
The jumps in W as in Picture (3) lead to an important subtlety. If the line
L passes through one boundary point of s + W then it passes also through the
other boundary point. This situation will occur whenever L ∩(s + ∂W) ̸= ∅,
which happens for a countable dense set of values for s ∈S. For these values,
which we call singular, ξ(s) will contain a third length c and therefore not in
the symbolic hull of the original sequence ξ. However, by selecting only one
of the two boundary points one obtains an element of the hull. Stated in terms
of sequences, if s is singular then ξ(s) contains somewhere the word bcb. If
we replace this word by either ab or ba then the resulting sequence will be in
the symbolic hull Ξ. As a consequence, Ξ contains the sequences ξ(s) coming
from the points of S which are not singular and, for each singular point of S,
two sequences corresponding to the above two choices. The sequences of Ξ
which come from singular points of S can be characterised by the fact that they
contain a pair ab (or ba) which can be ﬂipped to ba (or ab, respectively) so that
the result lies still in Ξ. Such a ﬂip is called a phason ﬂip . It plays an important
role in quasi-crystal physics.
Topologically, Ξ is the circle S disconnected along its singular points [17].
By disconnecting an interval [0, 1] at some point 0 < r < 1 we mean the
following: We take r out to get two half open intervals and then add to each half
open interval individually its missing boundary point. The result is the disjoint
union of [0, r] with [r, 1] which hence has two connected components. There
is an obvious map from this disjoint union back to the interval, just identify the
two added boundary points.
Using inverse limits one can perform this procedure to a circle for a
countable subset points. If this subset is dense then the resulting disconnected
circle, which we denote Sc, is totally disconnected, the connected component
of a point will contain only that point. There will then be a map from the
disconnected circle Sc to the original circle S which is almost everywhere one
to one, and two to one at the singular points.
The shift action on the hull can be described on Sc as follows: on the non-
singular points of S the action is by rotation by θ, as in the almost periodic case,
and the single orbit of singular points of S corresponds to two orbits in Sc.
(4) In the context of the above situation there is another possibility to resolve the
issue of a third length c appearing in ξ(s) for singular s [30]. We explain
this the idea, which goes back to [16], ﬁrst for the interval [0, 1] which we
disconnected above at some interior point r. Instead of adjoing two boundary
points to the half-open intervals [0, r) and (r, 1] to make them closed and
disconnected we may add an intervall [0, 1] whose boundary points become the
missing boundary points of the half-open intervals. The result is then a single
(connected) interval [0, r) ∪[r, r + 1] ∪(r + 1, 2] = [0, 2]. When doing this
for the circle with inﬁnitely many points the result will be a again a circle,

4
Operators, Algebras and Their Invariants for Aperiodic Tilings
203
which we call the augmented circle Saug. It seems that the augmented circle has
inﬁnite circumference, but since we are only interested in its topology this is
irrelevant. For the symbolic sequences ξ this has the following interpretation.
If ξ(s) is singular and thus contains the forbidden word bcb then, apart from
the choices ab and ba, we have the possibility to replace bcb with atbt where
at = (1−t)a+tb and bt = ta+(1−t)b, t ∈[0, 1]. This enlarges the symbol set
to A = [a, b]. For t ̸= 0, 1 the resulting sequences are no longer Sturmian, but
the augmentation has a nice physical interpretation; it corresponds to making
the phason ﬂips a continuous motion.
This has consequences for the hull with its shift action. The augmented hull
˜Ξ is by deﬁnition the set of sequences obtained in the above way, that is, it
contains Ξ together with a countable set of intervals. Topologically we may
identify it with Saug and then the shift action corresponds to, the rotation by θ
on the points which are not singular, and a permutation of the added in intervals.
Indeed, if we require that the t-variable is kept ﬁxed there is only one possible
continuous extension of the Z-action to Saug.
The effect on the spectrum of the associated Hamiltonian has been numeri-
cally analysed in [30]. If the underlying sequence contains atbt for t ̸= 0, 1, the
spectrum contains an additional eigenvalue in each gap.
4.2.4
Gaps and the Integrated Density of States
A gap in the spectrum of self adjoint operators is a connected component of its
complement in R. Physically a gap means that the material cannot have (electronic
or wave) states at energies which lie in the gap.3 In other words, the density of states
vanishes in the gaps of the spectrum. The integrated density of states at energy
E, IDS(E), is the integral over the density of states from −∞to E. It is thus a
positive increasing function which is constant on gaps. Under suitable homogeneity
assumptions on the material (for instance, if the tiling dynamical system is uniquely
ergodic) the integrated density of states at E can be expressed as the trace per unit
volume of P≤E(H), the spectral projection of H to its states with energy lower
than E. The trace per unit volume is a linear functional which can be evaluated on
operators of ℓ2(Zd) (provided they are trace-class w.r.t. it) which is invariant under
conjugation with unitaries and normalised so that its value on the identity operator
is 1.
We will see that, if E lies in a gap then IDS(E) is a numerical topological
invariant of the operator, which takes values in a countable sub-group of R which
depends only on the underlying tiling. The topological invariance manifests itself in
the property that the number is robust against perturbations which do not close the
gap.
3At low enough temperature.

204
J. Kellendonk
4.3
Algebras for Tilings
We construct C∗-algebras for tilings for two reasons. First, by assigning in a
coherent way a C∗-algebra to a tiling we can study the tiling using the tools of
C∗-theory and non-commutative topology. Second, the algebra is a natural host for
pattern equivariant operators for the tiling and so in particular contains operators
describing the physics of the material modeled by the tiling.
The abstract deﬁnition of a C∗-algebra is as a complex ∗-Banach algebra whose
norm satisﬁes the C∗-condition, ∥a∗a∥= ∥a∥2. One of the fundamental theorems
in C∗-theory says that any C∗-algebra can be faithfully represented on a Hilbert
space. While this allows to view C∗-algebra s more concretely as the norm closed
sub-algebras of the bounded operators on a Hilbert space, a point of view which
is close to physics, the abstract deﬁnition has its advantages when it comes to the
study of its topological invariants.
4.3.1
The Pattern Equivariant Approach
We describe the approach to tiling algebras via pattern equivariant integral kernels.
When restricted to tilings of ﬁnite local complexity this is essentially the same than
[26, 31].
We ﬁx a tiling T which we view as the closed subset of Rd given by the boundary
points of its tiles. We construct a C∗-algebra for T using double R-patch classes.
Recall that LR(T ) is the closure in the Hausdorff metric (between closed subsets
of the R-ball at 0) of the set of all R-patches of T which are centered at 0.
Deemphazising the role of the origin we may also describe LR(T ) as the closure
of R-patch classes of T in the Hausdorff metric, deﬁning the Hausdorff distance
between two equivalence classes as the inﬁmum of the distance taken over all
possible representatives. An element of the inverse limit Ω(T ) =
lim
+∞←R LR(T )
can then also be described as [T ; x], the translational equivalence class of a tiling
T together with a point x in the tiling. It corresponds to the tiling T −x, that is the
representative of T which has x on the origin of Rd.
Recall furthermore the deﬁnition of a double R-class of T as the equivalence
class of a double R-patch BR[T ; x, y] = BR[T ; x] × BR[T ; y] under the diagonal
action by translation. We denote the equivalence class by 3BR[T ; x, y]4 and deﬁne,
for M ≥0,
LR,M(T ) = {
3
BR[T ; x, y]
4
: |y −x| ≤M}
dH
the closure of the set of double R-classes of range bounded by M. Then LR(T ) =
LR,0(T ), as we may identify 3BR[T ; x, x]4 with BR[T −x], the R-patch of T at x
shifted to 0.

4
Operators, Algebras and Their Invariants for Aperiodic Tilings
205
If R > R′ we have an obvious surjection
LR,M(T ) ↠LR′,M(T )
(4.4)
given by
3
BR[T ; x, y]
4
→
3
BR′[T ; x, y]
4
and if M < M′ an obvious inclusion
LR,M(T ) #→LR,M′(T ).
(4.5)
Consider the continuous function v : LR,M(T ) →BM(0)
v(
3
BR[T ; x, y]
4
) = x −y
and deﬁne C0(LR,M(T )) to be the space of continuous functions (sliding block
codes) b : LR,M(T ) →C which vanish on v−1(∂BM(0)). Then the surjection (4.4)
and the inclusion (4.5) induce inclusions
C0(LR′,M(T )) #→C0(LR,M′(T ))
where R′ < R and M < M′, which are algebra homomorphisms w.r.t. pointwise
multiplication. We deﬁne the space of strongly pattern equivariant (for T ) elements
as the algebraic direct limit
A(s)(T ) =
lim
R,M→∞C0(LR,M(T ))
When equipped with pointwise multiplication and complex conjugation, A(s)(T ) is
a non-unital commutative ∗-algebra. But on A(s)(T ) we have a second ∗-algebra
structure, namely the non-commutative convolution product C0(LR,M(T )) ×
C0(LR′,M′(T )) →C0(LR′′,M′′(T ), R′′ = max(R, R′), M′′ = M + M′, deﬁned by
b ⋆b′(
3
BR′′[T ; x, y]
4
) =

BM(x)∩BM′(y)
b(
3
BR[T ; x, z]
4
)b′(
3
BR′[T ; z, y]
4
)dz
b∗(
3
BR[T ; x, y]
4
) = b(
3
BR[T ; y, x]
4
)
Every element of Ω(T ) deﬁnes a representation πT of A(s)(T ) on L2(Rd). Given
b ∈C0(LR,M(T )),
πT (b)ψ(x) =

BM(x)
b([BR[T ; x, z]])ψ(z)dz.
This is compatible with the inclusions and one easily sees that πT is faithful, as the
translates of T in Ω(T ) form a dense set. As a result ∥πT (b)∥≤∥πT (b)∥for all
T ∈Ω(T ). The continuous tiling algebra A(T ) is the completion of (A(s)(T ), ⋆)
in the norm ∥b∥:= ∥πT (b)∥.

206
J. Kellendonk
We may interprete the above in the following way: Any element b ∈A(s)(T )
lies in some C0(LR,M(T )) and thus deﬁnes a strongly pattern equivariant function
fb : Rd × Rd →C by
fb(x, y) = b(
3
BR[T ; x, y]
4
)
which we call its integral kernel. A(s)(T ) can thus be seen as the algebra of strongly
pattern equivariant integral kernels over Rd with their usual product and ∗-structure
f ⋆g(x, y) =

Rd f (x, z)g(z, y)dz
f ∗(x, y]) = f (y, x)
and the representation πT corresponds to the usual representation of integral kernels
πT (b)ψ(x) =

Rd fb(x, z)ψ(z)dz.
Let S be a Delone set which is locally derivable from T . The discrete tiling
algebra associated to S is obtained by restricting the above construction to double
R-patches BR[T ; x, y] with x, y ∈S. We denote LR,M
S
(T ) ⊂LR,M(T ) the closure
of the double R-patch classes with x, y ∈S and ∥y −x∥≤M. The discrete tiling
algebra AS(T ) is the completion of the algebra (A(s)
S (T ), ⋆) where
A(s)
S (T ) =
lim
R,M→∞C0(LR,M
S
(T ))
is the algebraic limit and
b ⋆b′(
3
BR′′[T ; x, y]
4
) =

z∈S
b(
3
BR[T ; x, z]
4
)b′(
3
BR′[T ; z, y]
4
)
and the ∗-structure is b∗(
3
BR[T ; x, y]
4
)
=
b(
3
BR[T ; y, x]
4
). Similar to the
continuous case, every element of Ξ(T ) deﬁnes a representation πS
T of A(s)(T )
on L2(S(T )). Given b ∈C0(LR,M(T )),
πS
T (b)ψ(x) =

z∈S(T )∩BM(0)
b([BR[T ; x, z]])ψ(z)
(4.6)
and the completion is taken in the norm ∥b∥= ∥πS
T (b)∥. The representation πS
T on
ℓ2(S) can again be written using integral kernels,
πS
T (b)ψ(x) =

z∈S
fb(x, z)ψ(z).

4
Operators, Algebras and Their Invariants for Aperiodic Tilings
207
This corresponds exactly to (4.2) and indeed, tight binding operators with local
coefﬁcients are represented by elements of the discrete tiling algebra.
One advantage of discrete tiling algebras is that they are unital. Indeed, since S
is uniformly discrete, C0(LR,M
S
(T )) = C(LR,0
S
(T )) for some small enough M > 0.
Therefore A(s)
S (T ) contains C(LR,0
S
(T )) and thus a unit.
4.3.2
The Groupoid Approach
While the deﬁnition of the tiling algebras by means of pattern equivariant functions
is very intuitive, as it mimicks local operators, a more abstract deﬁnition is needed
for K-theory calculations. In fact, the algebras can be understood as groupoid C∗-
algebra s and in the case that the groupoid is a transformation groupoid, they become
crossed product algebras for which tools in K-theory have been developed.
The Gelfand spectrum of the commutative algebra A(s)(T ) with pointwise
multiplication is given by
G(T ) =

M≥0
lim
∞←R LR,M(T ).
The elements of G are of the form [T ; x, y] where [T, x] ∈Ω(T ). G is a the
continuous tiling groupoid, it carries the groupoid product
[T ; x, y][T ′; x′, y′] = [T, x, y′]
provided T ′ = T and x′ = y.
Cc(G) with the standard convolution product for groupoid algebras is nothing else
then (A(s)(T ), ⋆). A(T ) is therefore the groupoid C∗-algebra of G(T ).
Under the homeomorphism G(T ) ∋[T ; x, y] →([T ; x], x −y) ∈Ω(T ) × Rd
the product becomes
([T ; x], v)([T ′, x′], v′]) = ([T ; x], v + v′)
provided [T ′; x′] = [T, x −v]
The product encodes thus the action αv([T ; x]) := [T ; x −v] of Rd on Ω(T ). It
follows that the continuous tiling algebra is the crossed product C∗-algebra
A(T ) ∼= C(Ω(T )) ⋊α Rd
associated to the continuous dynamical system (Ω(T ), Rd, α) of the tiling.
Also AS(T ) can be interpreted as a groupoid C∗-algebra, namely of the discrete
tiling groupoid associated to S,
GS(T ) =

M≥0
lim
∞←R LR,M
S
(T )

208
J. Kellendonk
whose unit space is the discrete hull
ΞS = lim
∞←R LR,0
S
(T ).
Indeed, the elements of GS are given by triples [T ; x, y] with x, y ∈S(T ) and
T ∈Ω(T ) and the product is the same as for G but x, y are restricted to S(T ).
4.3.3
Crossed Products with Zd
The case which we will describe in more detail is the one in which GS(T ) is actually
a transformation groupoid so that AS(T ) is a crossed product by Zd. As some details
about crossed products with Zd are needed further down we recall them here, see
also [15]. For that we start more generally with an action α of Zd on a (unital) C∗-
algebra B. Let BαZd be the linear space of Laurent polynomials 
n∈Zd bnun (only
ﬁnitely many bn are non-zero) with coefﬁcients bn ∈B. Here u1, · · · , ud are d
variables and un = un1
1 · · · und
d . Deﬁne the associative product and ∗-structure
bnunb′
mum = bnαn(b′
m)un+m,
(bun)∗= α−n(b∗)u−n.
(4.7)
In particular, the u1, · · · , ud commute and satisfy the relations of unitaries, uiu∗
i =
u∗
i ui = 1.
Any representation ρ of B on some Hilbert space H gives rise to a representation
πρ of BαZd on ℓ2(Zd, H):
πρ(b)ψ(n) = ρ(α−n(b))ψ(n),
πρ(um)ψ(n) = ψ(n −m)
and if ρ is faithful then the crossed product C∗-algebra B ⋊α Zd is the completion
of the above algebra BαZd w.r.t. the norm ∥· ∥:= ∥πρ(·)∥. πρ is called the
representation induced by ρ.
We now specify to the case of discrete tiling algebras which may be written as
crossed products with Zd. This might not always be the case and so we need to make
some assumptions. We say that T is a decoration of Zd if there exists an oriented
graph Γ , such that
1. There is an isomorphism (of oriented graphs) ν between Γ and the Caley graph
of Zd,
2. the set of vertices S of Γ is a Delone subset of Rd which is locally derivable
from T ,
3. for all edges (x, y) of Γ , ν(x, y) is locally derivable from T ,
4. the combinatorial distance between x, y ∈S (the minimal number of edges
needed to link x with y) is Lipschitz equivalent to their euclidean distance in
Rd.

4
Operators, Algebras and Their Invariants for Aperiodic Tilings
209
Before we exploit these conditions we remark that they naturally occur in many
situations. They are clearly satisﬁed for Wang tilings where we can take S to be the
vertices and the edges of Γ to be the edges of the cubes. The orientation can be
coherently ﬁxed by a global choice of orientation on Rd. More generally, an tiling
from which we can locally derive a lattice S allows the construction of such a graph
Γ in a similar way. Recall that after deformation this can always be achieved for
FLC tilings. But S does not have to be a lattice, for instance, for one dimensional
tilings (with a lower and an upper bound on thel tile size) we may use the tiles to
deﬁne the edges of Γ , oriented according to a choice of orientation for R.
Let ν be an isomorphism between Γ and the Caley graph of Zd. Then we can
deﬁne a map
˜v : GS(T ) →Zd
as follows. Given (x, y) ∈S × S there is a path in Γ from y to x. We map this
path with ν to a path in the Caley graph of Zd. As such the path corresponds to
an element of Zd which we denote ν(x, y). While the path need not be unique, the
group element is. We now deﬁne
˜v([T ; x, y]) = ν(x, y).
By the above conditions 2. and 3., for any edge (x, y) of Γ there exists R > 0 such
that ˜v([T ; x, y]) can be derived from the double R-patch class [BR[T ; x, y]]. The
R depends on (x, y) but since, by 4., the combinatorial distance between x and y is
bounded by a constant times their euclidean distance, we can, given M > 0, choose
the R uniformly for all (x, y) ∈S × S with ∥y −x∥≤M. This shows that ˜v is
extends by continuity to GS(T ). From ν(x, y) = ν(x, z) + ν(z, y) for all z ∈S
we derive that ˜v is a groupoid homomorphism. Clearly, when restricted to the orbit
of [T ; x, x] in GS(T ) (which is a group), then ˜v is a group isomorphism. Since the
orbit of T is dense by construction, the restriction of ˜v to any orbit of GS(T ) is an
isomorphism. We therefore can deﬁne an action α on ΞS by Zd,
αn([T ; x]) = [T, y]
where y is the unique element of S such that ˜v([T ; x, y]) = n. Since ˜v is strongly
pattern equivariant this action is continuous and the map
Gs ∋[T ; x, y] →([T ; x], ˜v([T ; x, y])) ∈ΞS ⋊α Zd
a continuous groupoid homorphism. Moreover, the map is bijective. Condition 4
now guarantees that its inverse is continuous. Indeed, it implies that ˜v−1(ei) ∈LR,M
S
for some ﬁnite R and M, where ei is a generator of Zd. Since LR,M
S
is compact
also ˜v−1(ei) is compact, which shows that the restriction of ˜v to ˜v−1(ei) is a
homeomorphism onto ΞS × {ei}. A similar argument works for any n ∈Zd.

210
J. Kellendonk
It now follows from the general theory [38] that the discrete tiling algebra AS(T )
is isomorphic to the crossed product C(ΞS) ⋊α Zd of C(ΞS) with Zd. We ﬁnd it
instructive to explain this directly: We have seen that A(s)
S (T ) contains C(LR,0
S
(T )).
It furthermore contains the indicator functions on compact open subsets of LR,0
S
(T ).
Above we saw that ˜v−1(n) is compact. It is also open and thus its indicator function
χn an element of AS(T ). Let b ∈C(LR,0
S
(T )). Then
χn ⋆b([T ; x, y]) = χn([T ; x, y])b([T ; y, y])
b ⋆χn([T ; x, y]) = b([T ; x, x])χn([T ; x, y]).
Now χn([T ; x, y]) = 1 is equivalent to αn(b)([T ; x, x]) = b([T ; y, y]) and hence
we have χn ⋆b = αn(b) ⋆χn. Therefore, if un = χn, the relations (4.7) are
satisﬁed. This shows that A(s)
S (T ) contains BαZd with B = limR→∞C(LR,0
S
(T )).
Furthermore, any b ∈C0(LR,M
S
(T )) can be written as a ﬁnite linear combination of
elements from C(LR,0
S
(T )) and χn. Hence BαZd is dense in AS(T ). Since C(ΞS)
is the closure of B we have AS(T ) ∼= C(ΞS) ⋊α Zd.
Given [T ; x] ∈ΞS the representation πS
T (4.6) is unitarily equivalent to a
representation on ℓ2(Zd) in which χn acts as the translation operator T n. Indeed,
the unitary intertwining the representation corresponds to the bijection ν(x, ·) :
S(T −x) →Zd. Furthermore, the representation on ℓ2(Zd) obtained in this way is
the d-fold iterated induced representation of the representation ρT : C(ΞS) →C
given by ρT (f )ψ(x) = f ([T ; x])ψ(x).
For Wang tilings, the symbolic hull Ξ plays the role of ΞS.
4.3.4
Extensions and Exact Sequences
One of the basic building blocks of algebraic topology are extentions. An extension
of a C∗-algebra A is a C∗-algebra E together with a surjective morphism q : E →
A. Let J = ker q. J is a closed two-sided ideal of E. Denoting by i : J →E the
inclusion map we have a short exact sequence (SES)
0 →J
i→E
q→A →0
that is, a chain of algebras with morphisms i, q such that i is injective, im i = ker q
and q is surjective.
Of particular importance is the Toeplitz extension T (B, β) of the crossed product
A = B ⋊β Z. Its construction is close to that of B ⋊β Z, but instead of the
algebra BβZ generated by the elements of B and a unitary u subject to the relation
ub = β(b)u we now take the algebra generated by the elements of B and a (proper)
isometry ˆu and its ∗-adjoint ˆu∗, which are subject to the relations
ˆub = β(b)ˆu,
bˆe = ˆeb

4
Operators, Algebras and Their Invariants for Aperiodic Tilings
211
where ˆe = 1 −ˆuˆu∗, and b ∈B. Saying that ˆu is an isometry means that ˆu∗ˆu = 1
and implies that ˆe is a projection, properness requires ˆe to be neither 0 nor 1. We
denote this algebra by BβN. Elements of BβN are thus ﬁnite sums of ﬁnite products
of elements from B, ˆu and ˆu∗. The above relation imply that also ˆu∗b = β−1(b)ˆu∗.
We have a surjective ∗-algebra morphism q : BβN →BβZ which is given by
q(b) = b,
q(ˆu) = u
and hence satisﬁes q(ˆe) = 0. The kernel of q is the subalgebra generated by ˆe.
Identifying ˆe with the half-inﬁnite Jacobi matrix which has as only non-zero entry
a 1 at the upper left corner, and ˆu with the Jacobi matrix which is 1 on the lower
diagonal, we see that ker q can be identiﬁed with the algebra of half-inﬁnite matrices
with entries from B of which only ﬁnitely many are non-zero. This is the tensor
product B ⊗F where F is the algebra of half-inﬁnite complex matrices with only
ﬁnitely many are non-zero entries. We thus have a SES
0 →B ⊗F →BβN
q→BβZ →0
The Toeplitz extension is the universal C∗-completion of BβN and gives rise to the
SES of C∗-algebra s
0 →B ⊗K →T (B, β)
q→B ⋊β Z →0
(4.8)
Here K is the algebra of compact operators. Recall that a representation ρ of B on H
induces a representation πρ of B ⋊β Z on ℓ2(Z, H). It also induces a representation
ˆπρ of T (B, β) on ℓ2(N, H), namely
πρ(b)ψ(n) = ρ(α−n(b))ψ(n),
πρ(ˆu)ψ(n) = ψ(n −1) with ψ(−1) = 0.
4.4
K-Theoretic Invariants for Tilings
Having assigned to a tiling various C∗-algebra s, their K-groups yield invariants
for the tiling. These invariants can serve to distinguish tilings, or even classify them
under weaker notions of equivalence. But they also aquire physical signiﬁcance, as
the algebra is physically motivated.
In turns out that the discrete tiling algebras constructed above for a given tiling
and a Delone set S which is locally derivable from the tiling are all strongly Morita
equivalent to the continuous tiling algebra. Since K-groups do not distinguish
strongly Morita equivalent algebras, the different algebras lead to the same K-
groups. Having said that, K-groups can come with extra structure. The K0-group
can be ordered, for instance, and scaled (this is then called a dimension group)

212
J. Kellendonk
[40]. Whereas the order structure is again the same for strongly Morita equivalent
algebras, the scale is not, and different choices for S lead to different scales.
4.4.1
Short Deﬁnition of K-Theory
We provide a deﬁnition of the K-groups which is motivated by physics. The
elements of the groups are essentially homotopy classes of Hamiltonians which
have a gap in their spectrum. This approach is based on van Daele’s formulation
of K-theory [12] and has been adapted to topological phases in [29], though we
consider only the complex case here. For the more traditional approach we refer the
reader to [9, 40].
If the local arrangement of atoms in a solid are described by a tiling (in the sense
of being mutually locally derivable with the tiling) then it is natural to consider the
tiling algebra as the C∗-algebra of observables. But what follows can in principle be
carried out with any C∗-algebra A which is motivated by the physical system one
wants to consider.
The energy observable corresponds to a self-adjoint element H of A (the
Hamiltonian, or a bounded function of the Hamiltonian), represented in the relevant
physical representation of A. A gap in the spectrum of H indicates that the system is
an insulator, provided the Fermi energy lies in that gap. The topological phase of the
insulator is, by deﬁnition, the homotopy class of H under continuous deformation
which preserves self-adjointness and the presence of a gap at the Fermi energy.
Assuming that A is unital we may shift the gap and the Fermi energy to 0 and thus
say that the topological phase of H is its connected component in the set of self-
adjoint invertible elements GL(As.a.) of A. Following a standard procedure one can
construct an abelian group K0(A) whose elements are generated by the homotopy
classes of GL(As.a.). K1(A) is obtained by a similar construction, but for the set
of connected components of GL(A), that is, without the self-adjointness constreint.
In physics, the role of an invertible element Q ∈A is as the chiral half of an
insulator with chiral symmetry; the Hamiltonian of such an insulator has the form
H =
 0 Q∗
Q 0

.
To construct a group out of the homotopy classes of GL(A) we consider homo-
topy classes in all GL(Mn(A)), n ≥1, the invertible elements in the matrix algebras
over A. To compare matrices of different sizes we use the inclusion GL(Mn(A)) ∋
x →x ⊕1 ∈GL(Mn+1(A)) which induces an inclusion of homotopy classes. The
direct limit of the quotient spaces by homotopy limn GL(Mn(A))/ ∼h admits an
addition [x] + [y] = [x ⊕y] ([x] denotes the homotopy class of x). It turns out
that x ⊕y is homotopic to x ⊕y in GL(M2(A)), and also to xy ⊕1. The addition
law deﬁned above is therefore the abelianization of the product in A and yields an
abelian group structure with neutral element [1] and inverse −[x] = [x−1]. K1(A)
is this abelian group.

4
Operators, Algebras and Their Invariants for Aperiodic Tilings
213
The construction of K0(A) follows similar lines, except one requires self-
adjointness, and therefore considers the direct limit limn GL(Mn(A)s.a.)/ ∼h.
Addition is still deﬁned by [x] + [y] = [x ⊕y], but since a product of two self-
adjoint elements need not to be self-adjoint, it is not the abelianization of the product
in A and V (A) := limn GL(Mn(A)s.a.)/ ∼h does not contain inverse elements.
Instead V (A) is an abelian monoid with neutral element [1]. K0(A) is the associated
Grothendieck group V (A) × V (A)/ ∼. Here ([x1], [y1]) ∼([x2], [y2]) if there
exist [z] ∈V (A) such that [x1] + [y2] + [z] = [x2] + [y1] + [z] and addition is
componentwise, ([x1], [y1]) + ([x2], [y2]) = ([x1] + [x2], [y1] ⊕[y2]).
The more conventional picture of K0(A) uses homotopy classes of projections.
Any H ∈GL(As.a.) is homotopic to a self-adjoint unitary, that is, an element of the
form 1 −2p where p is a projection. This projection is the spectral projection onto
the negative spectral part of H. A homotopy class of invertible self-adjoint elements
corresponds therefore to a homotopy class of projections.
Similarily, any invertible element is homotopic to a unitary. This yields the
conventional picture of K1(A) as homotopy classes of unitaries.
4.4.1.1
Basic Properties of K-Theory
We list the basic properties of K0 and K1.
1. Functoriality. Whenever we have an algebra homomorphism ϕ : A →B
between two unital C∗-algebra s and ϕ preserves the unit, then we obtain a group
homomorphism ϕ∗: Ki(A) →Ki(B) simply by setting ϕ∗([x]) = [ϕ(x)] where
ϕ is extended to Mn(A) entrywise. Furthermore (ψ ◦ϕ)∗= ψ∗◦ϕ∗.
2. Ki preserves direct sums. Ki(A ⊕B) = Ki(A) ⊕Ki(B).
3. Stability. The map x →x ⊕1 induces an isomorphism Ki(Mn(A)) →
Ki(Mn+1(A)). In particular, Ki(K ⊗A) ∼= Ki(A), where K are the compact
operators, and (strongly) Morita equivalent algebras have the same K-theory.
4. Continuity. Ki commutes with limits, Ki(limn An) = limn Ki(An).
4.4.1.2
Deﬁnition of Ki(A) for Non-unital Algebras
The deﬁnition we gave above for Ki(A) needs invertibility, and hence a unit for A.
If A is not unital we have to add a unit to A. This is done in the following way.
Let A+ = A×C with product (a, λ)(b, μ) = (ab+λb+μa, λμ) and ∗-structure
(a, λ)∗= (a∗, λ). This is a unital algebra with unit (0, 1). We have a surjective
algebra homomorphism π : A+ →C, π(a, λ) = λ, whose kernel is A. Since A+ is
unital we may deﬁne its Ki-groups in the above way (A+ is a C∗-algebra in a natural
way). We thus get a group homomorphism π∗: Ki(A+) →Ki(C). By deﬁnition,
Ki(A) = ker π∗.

214
J. Kellendonk
4.4.1.3
More Involved Properties of K-Theory
The deﬁnition, in particular of K0(A) for non-unital A is not very direct, but it is
crucial to obtain the following important properties.
1. Bott periodicity. We have not given a deﬁnition of Ki(A) for i > 1, but the
reasonable deﬁnition of Ki(A) for i even, or odd, turns out to be isomorphic to
K0(A), or K1(A), respectively. This is called Bott periodicity.
2. Six term exact sequence (boundary maps). Given a short exact sequence of
C∗-algebra s
0 →J
i→E
q→A →0
there are group homomorphisms (boundary maps) δi : Ki(A) →Ki−1(J)
making the following long sequence of K-groups exact
Ki(J)
i∗→Ki(E)
q∗
→Ki(A)
δi→Ki−1(J) · · ·
Due to Bott periodicity, the above sequence is of period 6. We will provide
formulas for the boundary maps below which can be interpreted physically.
4.4.2
Calculating K-Groups for Tiling Algebras
There are tools to calculate the K-groups for the continuous tiling algebra C(Ω) ⋊
Rd and tools to calculate them in the case there is a transversal ΞS such that the
corresponding discrete tiling algebra is a crossed product C(ΞS) ⋊α Zd. We saw
that the latter is guaranteed if the tiling has FLC. Apart from the scale, the K-
groups of C(Ω) ⋊Rd and C(ΞS) ⋊α Zd coincide, as the algebras are strongly
Morita equivalent. Both calculations need extra structure and boil down to express
the K-groups as cohomology groups.
4.4.2.1
Via the Connes-Thom Isomorphism and Approximants
One method of computation of their K-groups makes use of the approximants
LR(T ) of the tiling discussed above. This method is feasible if the approximates
are subject to a strong hierarchical order, as, for instance, substitutional tilings
[1, 31, 42].
The Connes-Thom isomorphism [11] is one of the fundamental results in K-
theory which allows to relate the K-theory of a crossed product algebra with R,
B ⋊β R, to the K-theory of B. Indeed, for any (continuous) action β of R on a

4
Operators, Algebras and Their Invariants for Aperiodic Tilings
215
C∗-algebra B one has
Ki(B ⋊β R) ∼= Ki−1(B).
Starting with the continuous algebra C(Ω) ⋊α Rd we can apply iteratively the
Connes-Thom isomorphism to get
Ki(C(Ω) ⋊α Rd) ∼= Ki−d(C(Ω)).
As Ω(T ) = lim
←LR(T ) the algebra C(Ω) is the C∗-completion of the limit
lim
→C(LR(T )) so that, using the continuity of the K-functor we get
Ki(C(Ω)) =
lim
R→+∞Ki(C(LR))
The LR are ﬂat branched manifolds. For low enough dimension (d ≤3) Ki(C(LR))
is isomorphic to the singular cohomology of the space LR which is computable. If
T has a hierarchical structure relating LR for different R (or suitable modiﬁcations
thereof) then the direct limit can be computed. For substitution tilings a computer
code is available to perform these calculations [18].
4.4.2.2
Via Iteration of the Pimsner-Voiculescu Sequence and Group
Cohomology
A second approach to the calculation of K-groups of tilings which are decorations
of Zd is based on the iteration of the Pimsner-Voiculescu sequence [35]. It is useful
if one has good control on the action α of Zd on the discrete hull Ξ [17, 19, 23, 25].
Consider an isomorphism φ : M →M of an abelian group. The quotient
CφM := coker(id−φ) is called the group of coinvariants and the subgroup IφM :=
ker(id −φ) the group of invariants of M w.r.t. to φ. These are the cohomology
groups of the group Z with coefﬁcients in M, namely H 0(Z, M) = IφM and
H 1(Z, M) = CφM. Any isomorphism β on B induces a isomorphism β∗on Ki(B).
The Toeplitz extension (4.8) gives rise to a 6-term exact sequence, the Pimsner-
Voiculescu sequence, which can be split into two short exact sequences (i = 1, 2)
0 →Cβ∗Ki(B)
ı∗→Ki(B ⋊β Z)
δi→Iβ∗Ki−1(B) →0.
(4.9)
where ı∗is induced by the inclusion B #→B ⋊β Z and δi is the boundary map
from Sect. 4.4.1.3. By iteration we can express the K-group of C(Ξ)⋊α Zd through
similar short exact sequences with coinvariants and invariants of Ki(C(Ξ)). If d ≤
3 then all these sequence split and we obtain [23]
Ki(C(Ξ) ⋊α Zd) ∼=
!
k
H i+2k(Zd, C(Ξ, Z))

216
J. Kellendonk
The group cohomology is computable if we have a good understanding of the Zd-
action α on Ξ. This is, for instance, the case for almost canonical cut & project
tilings, and also here computer codes are available to perform the calculations [18].
4.4.3
Numerical Invariants for Pattern Equivariant Operators
We have seen that a pattern equivariant operator is an element in the representation
πT , or πS
T , of the continuous or discrete algebra of some tiling T . We denote this
algebra now simply by A.
If the operator is self-adjoint and invertible it comes from a self-adjoint invertible
element h ∈A and so deﬁnes a class in K0(A). This class is the equivalence class
of ([h], [1]) ∈V (A) × V (A) under the relation ∼deﬁning the Grothendieck group
which we discussed above, but we simply denote this class by [h], as the further
calculations depend essentially only on the homotopy class of h.
If the operator is only invertible thus coming from an invertible element Q ∈A
then its homotopy class deﬁnes an element in K1(A).
The K-classes are the abstract topological invariants of the operators. They
are invariants in the sense that they are stable under continuous deformation in
GL(As.a.) or GL(A), respectively.
Numerical topological invariants for pattern equivariant operators can now be
obtained from additive functionals on Ki(A). Such functionals can be given by
index pairings with K-homology classes of A [22], or by Chern characters [11]. We
will discuss here only the simplest cases, namely the functional on K0(A) deﬁned
by a trace, and the winding number on K1(A) deﬁned by a trace and a derivation.
These have physical interpretation in the examples we consider below.
4.4.3.1
Traces and Gap Labelling
Gap-labelling means the assignment of labels to the gaps in the spectrum of a
self-adjoint operator. These labels are supposed to be stable under continuous
deformations of the operator which do not close the gap. In Bellissard’s approach
to the gap-labelling by means of the K0-group of the C∗-algebra A of observables
[6, 7] the operator is an element of A and continuity means continuity in the norm
of that algebra.
A (positive) trace on A is a linear functional tr : A →C which satisﬁes
tr(uau∗) = tr(a) for all a ∈A and unitary u ∈A+, and tr(a∗a) ≥0. It follows that
tr(p) = tr(p′) for two homotopic projections. Let P−(h) be the spectral projection
onto the negative energy part of h. Note that P−(h) ∈A since h has a spectral gap
at energy 0. Thus h →tr(P−(h)) is homotopy invariant in GL(As.a.) and
tr∗([h]) = tr(P−(h))

4
Operators, Algebras and Their Invariants for Aperiodic Tilings
217
extends to a functional on K0(A) with values in R. Indeed, if h is in GL(Mn(A)s.a.)
we extend tr to Mn(A) using the matrix trace.
We can therefore formulate the gap labelling in the following way: If h is a self-
adjoint element of A and Δ a gap in the spectrum of h then, for any E ∈Δ the
shifted element h −E belongs to GL(As.a.) and so deﬁnes an element of K0(A).
This class [h −E] is the abstract gap-label of the gap Δ of h.
If we have a trace tr on A such that, for a ∈A, tr(a) corresponds to the trace
per unit volume of πT (a) (or of πS
T (a) in a tight binding representation), then the
integrated density of states at E of the operator πT (h) is given by tr(P−(h)). The
latter is the numerical gap-label of the gap Δ of h.
The traces on A = C(Ξ) ⋊α Zd are given by α-invariant Borel-probability
measures on Ξ. Indeed, if μ is such a measure then
trμ(anun) =

Ξ
a0(ξ)dμ(ξ)
deﬁnes a trace on A which is normalised, tr(1) = 1. If μ is ergodic, then for μ-
almost sure ξ ∈Ξ the trace per unit volume of πξ(a) equals tr(a). In particular,
if Ξ carries a unique α-invariant ergodic probability measure μ then for all ξ the
integrated density of πξ(h) takes the same value IDS(E) = trμ(P−(h−E)) [8, 26].
4.4.3.2
Derivations and the Winding Number
A ∗-derivation on A is a densely deﬁned linear map d : A →A which satisﬁes
the Leibniz rule, d(ab) = (da)b + a(db) and commutes with the ∗-operation. This
implies that d1 = 0 and thus for any invertible Q (in the domain of d) dQ−1 =
−Q−1dQQ−1. Moreover, if Q is unitary then (Q−1dQ)∗= −Q−1dQ.
If we have in addition a trace tr which is invariant under the derivation d, that is,
tr ◦d = 0, then
Wtr,d(Q) :=
1
2πi tr(Q−1dQ)
deﬁnes a real number which is stable under homotopy in GL(A). It is called the
winding number w.r.t. to (tr, d). W extends to a functional on K1(A), again by
extending tr with the matrix trace if Q ∈GL(Mn(A)) [11].
There is a little subtlety related to the fact that d is only densely deﬁned. We need
to be sure that the homotopy classes of invertibles in the domain of d are in bijection
to the homotopy classes of GL(A). This can be done in the above cases [11].

218
J. Kellendonk
4.5
Bulk Boundary Correspondence
A tiling covers the whole space Rd and so models a material which does not have
a boundary. A real material has, of course, a boundary. The pattern equivariant
operators above describe therefore properties in the interior of the material, that is,
properties which do not depend on its boundary. Such properties are referred to as
bulk properties. The bulk-boundary correspondence principle states that certain bulk
properties correspond to boundary properties, i.e. properties which are conﬁned to
the boundary of the material.
The bulk-boundary correspondence, in the form we discuss it, is of topological
nature. It is a correspondence between the topological invariants of the material
when seen without boundary and topological invariants localised near the boundary.
It manifests itself through a so-called boundary map in algebraic topology which
maps the elements of the K-group of our algebra into the K-group of an algebra
which contains the operators describing the boundary physics.
The topological nature of the bulk-boundary correspondence has physical conse-
quences. Since topological invariants are robust against perturbations it explains the
emergence of robust boundary spectrum in topological insulators.
There is a continuous and a discrete version of the bulk boundary correspon-
dence. We discuss the discrete version for Wang tilings which is based on the
Toeplitz extension.
4.5.1
General Philosophy
The bulk-boundary correspondence was ﬁrst formulated by Halperin [20] for the
Quantum Hall Effect and by Hatsugai [21] in the context of band theory for periodic
tight binding operators. Its topological nature and universality comes to full light
through its formulation based on the K-theory of C∗-algebras. This was ﬁrst worked
out for the Quantum Hall Effect in [33], and later put into a general framework [32].
Today it is quite developed and we can refer the reader to the book [37] for further
information.
Let A be the algebra containing all pattern equivariant operators of the tiling
describing the spatial structure of the material. The bulk invariants, that is the
topological invariants associated to pattern equivariant operators, are elements of
K∗(A). The ﬁrst goal is to ﬁnd a short exact sequence
0 →J →E
q→A →0
(4.10)
such that the elements of the ideal J can be represented as operators localised at the
boundary. The boundary map δ from the 6-term exact sequence associated with the
above short exact sequence
δi : Ki(A) →Ki+1(J)

4
Operators, Algebras and Their Invariants for Aperiodic Tilings
219
maps the bulk invariants to invariants which are expressed in terms of operators of J
and therefore localised at the boundary. This is the heart (abstract form) of the bulk
boundary correspondence. While there is no reason for δi to deﬁne a one-to-one
correspondence, it will deﬁne a correspondence between some of the invariants.
Let us have a closer look at the boundary maps δi. Let h ∈GL(A)s.a., the
Hamiltonian of an insulator. It has a gap Δ at 0 and the inverse of the gap width
|Δ| is a characteristic time tΔ =
2π
|Δ|. h deﬁnes an element of K0(A) or, if it has
chiral symmetry, an element of K1(A). To construct the image of these elements
under the boundary map we need a lift ˆh ∈Es.a. of h, that is, q(ˆh) = h.
We consider ﬁrst the situation δ0 = exp, the so-called exponential map. It is
given by
exp([h]) = [UΔ],
UΔ = PΔ(ˆh)⊥−e−itΔ(ˆh−E0)PΔ(ˆh)
where E0 = inf Δ and PΔ(ˆh) is the spectral projection of ˆh to energies in Δ and
PΔ(ˆh)⊥its orthocomplement. The homotopy class of UΔ does not depend on the
chosen lift ˆh. By construction UΔ −1 belongs to the ideal J. If ˆh is invertible then
[ˆh] ∈K0(E) is a preimage of [h] and exp([h]) is trivial. If however no invertible lift
can be found, then ˆh has spectrum inside the gap Δ of h, and UΔ is the unitary of
time evolution by the characteristic time tΔ of the states of ˆh in Δ. More generally,
if ˆh has a spectral gap overlapping with Δ and it is not protected by chiral symmetry,
then it is homotopic to an invertible lift and so we see that non-triviality of exp([h])
implies that any self-adjoint lift h in E must have spectrum covering Δ. It then
follows that the spectrum of UΔ covers the circle of complex numbers of absolute
value 1 and no homotopy can retract that spectrum to a point.
We consider the case δ1 = ind, referred to as the index map. As already
mentionned h ∈GL(A)s.a. deﬁnes an element of K1(A) if it has so-called
chiral symmetry and we consider topological phases which are protected under
this symmetry. We assume that the chiral symmetry is inner and thus given by a
generator Γ , a self-adjoint unitary, and h anti-commutes with Γ . It gives rise to an
isomorphism between A and M2(A++) where A++ = Π+AΠ+, Π± = 1
2(1 ± Γ ).
Written as an element of M2(A++), h and Γ have the form
h =
 0 Q∗
Q 0

,
Γ =
1 0
0 −1

and Q ∈GL(A++). The homotopy class of Q deﬁnes an element of K1(A++),
which is isomorphic to K1(A) since A and A++ are strong Morita equivalent. Now
the index map is given as follows
ind[Q] =
3
PΔ(ˆh)⊥Γ −PΔ(ˆh)

cos(tΔ ˆh)Γ −sin(tΔ ˆh)
	4

220
J. Kellendonk
as one computes using van Daele’s formula applied to the class of h [13].4 If ˆh
is invertible and has chiral symmetry then ind([Q]) is trivial. Conversely, non-
triviality of ind([Q]) implies that any lift ˆh ∈E with chiral symmetry must
have spectrum at energy 0. Finally, if 0 is an isolated point of the spectrum of
ˆh then the spectral projection P0(ˆh) of ˆh onto energy 0 is an element of J and
PΔ(ˆh)⊥Γ −PΔ(ˆh)

cos(tΔ ˆh)Γ −sin(tΔ ˆh)
	
homotopic to P0(ˆh)⊥−P0(ˆh), indeed,
a homotopy is given by contracting tΔ ˆh to P0(ˆh) + π
2
P>0(ˆh) −P<0(ˆh)	.
4.5.2
The Toeplitz Extension as Half Space Algebra
We now specify to the algebra A = C(Ξ) ⋊α Zd for a Wang tiling. We follow
[32, 33, 37] to describe an extension of this algebra which describes the physics on
half-space, the proto type of space with a boundary. We choose one direction in Zd,
let’s say along the d’th coordinate, and deﬁne the boundary to be perpendicular to it.
The material with boundary is now described by the restriction of the tiling to half
space, that is, we restrict the symbolic content ξ ∈Ξ to Zd−1 × N. We can rewrite
A = B ⋊β Z where B = C(Ξ) ⋊α∥Zd−1 and β = α⊥. We argue that the Toeplitz
extension T (B, β) describes the physics on the half space. This is best seen by
looking at its iterated induced representation. Recall that the physically motivated
representation (4.6) is the iterated induced representation of ρT : C(Ξ) →C,
ρT (f )ψ(x) = f ([T ; x])ψ(x) on ℓ2(Zd). Applying this idea to T (B, β) we iterate
the induction on ρT d −1 of times to get a representation of B = C(Ξ) ⋊α∥Zd−1
on ℓ2(Zd−1) and then once for the Toeplitz extension to get a representation of
T (B, β) on ℓ2(Zd−1 × N). The operators in this representation are precisely the
pattern equivariant operators restricted to the half space. The elements of the ideal
J in the short exact sequence are restrictions of pattern equivariant operators to the
half space which are non-zero only near the boundary.
The exact sequence in K-theory arising from the Toeplitz extension (4.8) gives
rise to the bijective correspondences
Ki(C(Ξ)⋊α Zd)/ı∗Ki(C(Ξ)⋊α∥Zd−1)
δi∼= Iα⊥
∗Ki−1(C(Ξ)⋊α∥Zd−1).
(4.11)
This is the K-theoretic bulk boundary correspondence. We refer to the case with
i = 0 as even, and that with i = 1 as the odd correspondence. Note that the
boundary maps are explicit, as a lift ˆh of h in the Toeplitz extension is simply
given by replacing the translation operator in the dth coordinate by its truncation
to Zd−1 × N.
4 In [37] one ﬁnds a formula for the same class with a different representative, the above is also be
valid if A is a real C∗-algebra.

4
Operators, Algebras and Their Invariants for Aperiodic Tilings
221
4.5.3
One-dimensional Examples
If the dimension is d = 1 then (4.11) becomes, for odd i,
K1(C(Ξ) ⋊α Z)/ı∗K1(C(Ξ))ind ∼= Iα∗K0(C(Ξ)).
(4.12)
Since Ξ is the closure of a single orbit, Iα∗K0(C(Ξ)) has a single generator, the
class of −1, which corresponds to a Hamiltonian whose spectrum is purely negative.
Likewise the invariants of K0(Ck) are generated by the class of −1. One computes
that [u] is a pre-image for [−1], that is, ind([u]) = [−1].
Let μ be an ergodic α-invariant probability measure on Ξ and recall that
it deﬁnes a trace tr on C(Ξ) and C(Ξ) ⋊α Z. Consider the ∗-derivation δ :
C(Ξ)αZ →C(Ξ)αZ given by δ(bun) = 2πinbun. The trace tr deﬁnes a tracial
state on K0(C(Ξ)) and, together with the derivation δ a winding number Wtr,δ on
K1(C(Ξ)⋊αZ). One ﬁnds that Wtr,δ(u) = tr(1). Thus applying the winding number
to the left hand side and the tracial state to the right hand side of (4.12) one obtains
the odd numerical bulk-boundary correspondence
Wtr,δ([Q]) = tr(ind[Q]).
(4.13)
This has the following physical interpretation: If h =
 0 Q∗
Q 0

is the Hamiltonian
with chiral symmetry and gap Δ at energy 0 then the spectrum of any lift ˆh of h
has at most ﬁnitely many values in Δ. Moreover, these values are eigenvalues to
eigenfunctions localized at the edge. Hence ind[Q] = [P0(ˆh)⊥−P0(ˆh)] and thus
tr(ind[Q]) is equal to the number of 0 energy eigenstates of ˆh. We thus have the
following well-known result (see also [36, 37]).
Odd Bulk Boundary Correspondence The winding number Wtr,δ of Q is the
number of 0 energy boundary states of ˆh.
For even i (4.11) is
K0(C(Ξ) ⋊α Z)/ı∗K0(C(Ξ))
exp
∼= Iα∗K1(C(Ξ))
(4.14)
Other than in the case of odd i the situation depends on the nature of the hull Ξ.
Again, given an ergodic α-invariant measure on Ξ we obtain a trace tr and a tracial
state, now for the left hand side. To obtain a winding number for the right hand side
we need a derivation on C(Ξ).
We discuss these issues here for the one-dimensional systems of Sect. 4.2.3.
1. We consider a periodic sequence ξ. If the period is k the discrete hull Ξ consists
of k isolated points on which Z acts by a cyclic permutation. Hence C(Ξ) = Ck
and the unique invariant probability measure is the uniform probability measure

222
J. Kellendonk
on k points. But we have K1(Ck) = 0 and hence the even bulk-boundary
correspondence is trivial.
2. We consider an almost periodic sequence ξ. The discrete hull Ξ is homeomor-
phic to the circle S and α is rotation by the irrational number θ ∈[0, 1]. Now
K1(C(S)) ∼= Z with generator given by the class of the function z(s) = e2πis.
Hence also the coinvariants and the invariants of K1(C(S)) are generated by [z].
Furthermore, K0(C(S)) ∼= Z with generator given by the class of −1, which
then is also the generator of the coinvariants and the invariants of K0(C(S)).
K1(C(S) ⋊α Z ∼= Z2 with generators [z] and [u]. K0(C(S) ⋊α Z ∼= Z2 with
generators [−1] and [hθ]. The second generator is the class of the function
hθ = 1 −2Pθ where Pθ is the famous Rieffel projection [39].
The exponential map can be computed on the generators and one ﬁnds that
the even bulk-boundary correspondence is given by
exp([hθ]) = −[z],
exp([−1]) = 0.
Since θ is irrational, the unique ergodic invariant measure on the circle is the
Lebesgues measure. Furthermore, functions of class C1 in C(S) can be derived
and thus we have a densely deﬁned derivation ∂s. Applying the resulting tracial
state to the left and the winding number Wtr,∂s to the right hand side we get
tr(1) = 1, tr(Pθ) = θ [39], Wtr,∂s(u) = 0, Wtr,∂s(z) = 1, so that the even
numerical bulk boundary correspondence is given by
tr([h]) + θWtr,∂s(exp[h]) ∈N.
(4.15)
This has the following interpretation. The bulk invariant tr([h]) is the IDS of h at
energy 0 (Fermi energy) and it can take real values of the form mθ + N where
N, m ∈N and N is such that mθ + N ∈[0, 1]. Thus, except if m = 0, N is
determined by the value of m as θ is irrational.
The boundary invariant Wtr,∂s(exp[h]) is a response coefﬁcient related to a
mechanical force. The derivation ∂s is the inﬁnitesimal generator of translation
in the hull and translation has the effect of changing the position of the atoms
(boundary points of the tiles) in the structure. This atomic motion corresponds to
a variation of the potential which the electrons at the edge are subjected to, and
hence they feel a gradient force. The above winding number of UΔ corresponds
to the expectation value of the gradient force on all edge states with energy inside
Δ, integrated over one cycle of the circle Ξ, in units of |Δ| [30]. We summarize:
Even Bulk Boundary Correspondence If mθ + N is the IDS of h at 0 then
the work exhibited by the atomic motion through a cycle around S, on the edge
states of energy inside Δ, is −m|Δ|.

4
Operators, Algebras and Their Invariants for Aperiodic Tilings
223
3. We consider a quasi periodic sequence ξ, more precisely a Sturmian sequence.
Now Ξ is the cut up circle Sc. It is totally disconnected and therefore
K0(C(Ξ)) ∼= CαC(Ξ, Z) and K1(C(Ξ)) ∼= 0. It follows that the even bulk-
boundary correspondence is trivial, as in the periodic case. There is nevertheless
a difference with the periodic case, namely CαC(Ξ, Z) has two generators. Next
to the class [−1] it contains the class [1 −2χθ] where χθ is the characteristic
function on a clopen subset of Ξ which has measure θ w.r.t. the unique ergodic
invariant probability measure.
4. The reason why the even BBC is trivial in the periodic and the quasi-periodic case
is, that in these cases the K1-group of the ideal in the Toeplitz extension is trivial.
This is due to the fact that the connected component of a point in the hull contains
only that point. There is also no obvious deﬁnition of a winding number, as there
is no notion of continuous translation in such spaces, any translation pushes a
point out of its connected component. Likewise we can’t deﬁne a gradient force.
It is here where the augmented system comes into play.
Recall that we can make the phason ﬂips continuous by augmenting the
system, that is, adding sequences in which the phason ﬂip is only partially carried
out. Since ˜Ξ is a circle, K1(C( ˜Ξ)) is non-trivial and the even bulk boundary
correspondence becomes non-trivial as well. But this means that we abandon the
simple Toeplitz extension for C(Ξ) ⋊α Z and replace it by a more complicated
short exact sequence. We outline the construction refering the reader to [30] for
more details.
The augmented hull ˜Ξ contains Ξ as a closed shift-invariant subset. The
Toeplitz extension T (C( ˜Ξ), α) of the augmented model is therefore also an
extension of C(Ξ) ⋊α Z. If we take this extension for (4.10) then we end up
with the short exact sequence
0 →Cα∗K0(C( ˜Ξ))
˜i∗
−→K0(C(Ξ) ⋊α Z)
5
exp
−→Iα∗K1(C( ˜Ξ)) →0
where ˜i∗is induced by the inclusion after restriction C( ˜Ξ) →C(Ξ) →
C(Ξ) ⋊α Z. Again α∗is the identity and K0(C( ˜Ξ)) ∼= K1(C( ˜Ξ)) ∼= Z. Of
the two generators of K0(C(Ξ) ⋊α Z), the class [−1] and the class [1 −2χθ],
the ﬁrst lies in the kernel of the exponential map and for the second one ﬁnds
exp([1 −2χθ]) = −[˜z] where ˜z : ˜Ξ →C is the function with winding number
−1.
There is a unique ergodic invariant probability measure on Ξ (when identify-
ing Ξ with Sc, which is from the point of view of measure theory the same as S,
the above measure is the Lebesgues measure) which we use to deﬁne the trace
and tracial state on K0(C(Ξ) ⋊α Z). To deﬁne the winding number on C( ˜Ξ)
we use the derivation w.r.t. the parameter t describing the continuous phason
motion and the trace ˜tr coming from the Lebesgue measure on the added intervals
(see [30] for more details). We then get the non-trivial even bulk boundary
correspondence: tr([χθ]) = −θW ˜tr,∂t([˜z]) modulo Z. As in the almost periodic
case the winding number of the boundary invariant has a physical interpretation;

224
J. Kellendonk
it is the work the phason ﬂips exhibit on the boundary states with energy in the
gap Δ, in units of |Δ| [30]. We summarize:
Even Bulk Boundary Correspondence If n + mθ is the IDS of h at 0 then the
work exhibited by a cycle of phason ﬂips on the edge states of energy inside Δ is
−m|Δ|.
This identity has been experimentally observed [2].
References
1. J.E. Anderson, I.F. Putnam, Topological invariants for substitution tilings and their associated
C∗-algebras. Ergod. Theory Dyn. Syst. 18(3), 509–537 (1998)
2. F. Baboux, E. Levy, A. Lemaitre, C. Gómez, E. Galopin, L.L. Gratiet, I. Sagnes, A Amo,
J. Bloch, E. Akkermans, Measuring topological invariants from generalized edge states in
polaritonic quasicrystals. Phys. Rev. B 95, 161114(R) (2017)
3. A. Avila, S. Jitomirskaya, The ten Martini problem. Ann. Math. 170, 303–342 (2009)
4. M. Baake, U. Grimm, Aperiodic Order (Vol. 1) (Cambridge University Press, Cambridge,
2013)
5. M. Baake, M. Schlottmann, P.D. Jarvis, Quasiperiodic tilings with tenfold symmetry and
equivalence with respect to local derivability. J. Phys. A Math. General 24(19), 4637 (1991)
6. J. Bellissard, K-theory of C∗-Algebras in solid state physics, in Statistical Mechanics and Field
Theory: Mathematical Aspects, (Springer, Berlin, 1986), pp. 99–156
7. J. Bellissard, Gap Labeling Theorems for Schrödinger Operators, ed. by M. Waldschmidt, P.
Moussa, J.-M. Luck, C. Itzykson. From Number Theory to Physics (Springer, Berlin, 1995)
8. J. Bellissard, D.J.L. Herrmann, M. Zarrouati, Hull of aperiodic solids and gap labelling
theorems. Directions Math. Quasicrystals 13, 207–258 (2000)
9. B. Blackadar, K-theory for Operator Algebras. Mathematical Sciences Research Institute
Publications, vol. 5, 2nd edn. (Cambridge University Press, Cambridge, 1998)
10. A. Clark, L. Sadun, When shape matters: deformations of tiling spaces. Ergod. Theory Dyn.
Syst. 26(1), 69–86 (2006)
11. A. Connes, Non-commutative Geometry (Academic, San Diego, 1994)
12. A. van Daele, K-theory for graded Banach algebras I. Quarterly J. Math. 39(2), 185–199 (1988)
13. A. van Daele, K-theory for graded Banach algebras II. Paciﬁc J. Math. 135(2), 377–392 (1988)
14. D. Damanik, M. Embree, A. Gorodetski, Spectral properties of Schrödinger operators arising
in the study of quasicrystals, in Mathematics of Aperiodic Order (Birkhäuser, Basel, 2015), pp.
307–370
15. K. Davidson, C*-Algebras by Example, vol. 6 (American Mathematical Society, Providence,
1996)
16. M.R. Herman, Sur la conjugaison différentiable des difféomorphismes du cercle à des rotations.
Pub. Math. IHES 49, 5–234 (1979)
17. A. Forrest, J. Hunton, J. Kellendonk, Topological Invariants for Projection Method Patterns
(No. 758) (American Mathematical Society, Providence, 2002)
18. F. Gähler, Computer code, private communication
19. F. Gähler, J. Hunton, J. Kellendonk, Integral cohomology of rational projection method
patterns. Algebr. Geometri. Topol. 13(3), 1661–1708 (2013)
20. B.I. Halperin, Quantized Hall conductance, current carrying edge states, and the existence of
extended states in a two-dimensional disordered potential. Phys. Rev. B 25(4), 2185 (1982)
21. Y. Hatsugai, Chern number and edge states in the integer quantum Hall effect. Phys. Rev. Lett.
71(22), 3697 (1993)

4
Operators, Algebras and Their Invariants for Aperiodic Tilings
225
22. N. Higson, J. Roe, Analytic K-homology (OUP Oxford, Oxford, 2000)
23. J. Hunton, Spaces of projection method patterns and their cohomology, in Mathematics of
Aperiodic Order (Birkhäuser, Basel, 2015), pp. 105–135
24. S. Jitomirskaya, Metal-insulator transition for the almost Mathieu operator. Ann. Math. 150,
1159–1175 (1999)
25. P. Kalugin, Cohomology of quasiperiodic patterns and matching rules. J. Phys. A Math.
General 38(14), 3115 (2005)
26. J. Kellendonk, Noncommutative geometry of tilings and gap labelling. Rev. Math. Phys. 7(07),
1133–1180 (1995)
27. J. Kellendonk, Pattern-equivariant functions and cohomology. J. Phys. A Math. General 36(21),
5765 (2003)
28. J. Kellendonk, Pattern equivariant functions, deformations and equivalence of tiling spaces.
Ergod. Theory Dynam. Syst. 28(4), 1153–1176 (2008)
29. J. Kellendonk, On the C∗-algebraic approach to topological phases for insulators. Ann. Henri
Poincaré 18(7), 2251–2300 (2017)
30. J. Kellendonk, E. Prodan, Bulk-boundary correspondence for Sturmian Kohmoto like models.
Ann. Henri Poincaré 20(6), 2039–2070 (2019)
31. J. Kellendonk, I.F. Putnam, Tilings, C∗-algebras and K-theory, in Directions in Mathematical
Quasicrystals, ed. by M. Baake, R.V. Moody. CRM Monograph Series, vol. 13 (2000)
(American Mathematical Society, Providence, 1999), pp. 177–206
32. J. Kellendonk, S. Richard, Topological boundary maps in physics, in Perspectives in Operator
Algebras and Mathematical Physics. Theta Series in Advanced Mathematics, vol. 8 (Theta,
Bucharest, 2008), pp. 105–121
33. J. Kellendonk, T. Richter, H. Schulz-Baldes, Edge current channels and Chern numbers in the
integer quantum Hall effect. Rev. Math. Phys. 14, 87–119 (2002)
34. Y. Last, Spectral theory of Sturm-Liouville operators on inﬁnite intervals: a review of recent
developments, in Sturm-Liouville Theory (Birkhäuser Basel, Basel, 2005), pp. 99–120
35. M. Pimsner, D. Voiculescu. Exact sequences for K-groups of certain cross products of C∗-
algebra s. J. Op. Theory 4, 93–118 (1980)
36. E. Prodan, H. Schulz-Baldes, Non-commutative odd Chern numbers and topological phases of
disordered chiral systems. J. Funct. Analy. 271(5), 1150–1176 (2016)
37. E. Prodan, H. Schulz-Baldes, Bulk and Boundary Invariants for Complex Topological Insula-
tors (Springer, Berlin, 2016)
38. J. Renault, A groupoid Approach to C*-algebras (Vol. 793). (Springer, Berlin, 2006)
39. M. Rieffel, C∗-algebras associated with irrational rotations. Paciﬁc J. Math. 93(2), 415–429
(1981)
40. M. Rordam, F. Larsen, N.J. Laustsen, An Introduction to K-theory of C∗-Algebras (Cambridge
University Press, Cambridge, 2000)
41. L.A. Sadun, Topology of Tiling Spaces (Vol. 46) (American Mathematical Society, Providence,
2008)
42. L. Sadun, Cohomology of Hierarchical Tilings, in Mathematics of Aperiodic Order
(Birkhäuser, Basel, 2015), pp. 73–104
43. L. Sadun, R.F. Williams, Tiling spaces are Cantor set ﬁber bundles. Ergod. Theory Dyn. Syst.
23(1), 307–316 (2003)

Chapter 5
From Combinatorial Games
to Shape-Symmetric Morphisms
Michel Rigo
Abstract Siegel suggests in his book on combinatorial games that quite simple
games provide us with challenging problems: “No general formula is known for
computing arbitrary Grundy values of Wythoff’s game. In general, they appear
chaotic, though they exhibit a striking fractal-like pattern.”. This observation is the
ﬁrst motivation behind this chapter. We present some of the existing connections
between combinatorial game theory and combinatorics on words. In particular,
multidimensional inﬁnite words can be seen as tilings of Nd. They naturally arise
from subtraction games on d heaps of tokens. We review notions such as k-
automatic, k-regular or shape-symmetric multidimensional words. The underlying
general idea is to associate a ﬁnite automaton with a morphism.
5.1
Introduction
Combinatorial game theory (CGT) uses many tools from other ﬁelds: number
theory, continued fractions, numeration systems, cellular automata, etc. We will
limit ourselves to subtraction games played on heaps of tokens. When analyzing
Sprague–Grundy values of some well-known and popular subtraction games—like
Nim or Wythoff’s game—notions such as k-automatic, k-regular and morphic (also
called substitutive) multidimensional sequences enter naturally the picture. The aim
of this chapter is to introduce these concepts and present the interplay existing
between CGT and combinatorics on words (COW). The focus is put on inﬁnite
(multidimensional) words generated by iterated morphisms. The organization of this
M. Rigo ()
University of Liège, Department of Mathematics, Liège, Belgium
e-mail: M.Rigo@ulg.ac.be
© The Editor(s) (if applicable) and The Author(s), under exclusive license
to Springer Nature Switzerland AG 2020
S. Akiyama, P. Arnoux (eds.), Substitution and Tiling Dynamics: Introduction
to Self-inducing Structures, Lecture Notes in Mathematics 2273,
https://doi.org/10.1007/978-3-030-57666-0_5
227

228
M. Rigo
chapter faithfully reﬂects the course presented during the school1 “Tiling Dynamical
System” organized during the Jean Morlet Chair attributed to Professor Shigeki
Akiyama.
After setting notation in Sect. 5.2, minimal requirements and basic results about
CGT are given in Sect. 5.3. Well-known facts about k-automatic and k-regular
(unidimensional) sequences are presented in Sect. 5.4. For some general references,
see [8, 62, 72, 73]. Let PW : N2 →{0, 1} be the bidimensional inﬁnite word deﬁned
by PW(m, n) = 1 if and only if (m, n) is a P-position, i.e., a loosing position or a
zero of the Sprague–Grundy function, of Wythoff’s game. Section 5.5 deals with
the syntactic characterization of these P-positions in terms of representations in the
Fibonacci numeration system. This result by Fraenkel is proved using the inﬁnite
Fibonacci word and a transducer computing the successor function in the Fibonacci
numeration system. In particular, we make explicit the general fact that morphic
words can be generated by ﬁnite automata. We look at the sequence of states
reached by all the accepted words when they have been genealogically ordered. The
transformation from morphisms to automata is recurrent in this chapter: uniform
and non-uniform morphisms for words, uniform and non-uniform morphisms in a
multidimensional setting.
The multidimensional point of view begins with Sect. 5.6. We ﬁrst look at k-
automatic and k-regular multidimensional words. It turns out that characterizing the
P-positions of Wythoff’s game leads to a shape-symmetric morphism as introduced
and studied by A. Maes in a logical setting. The word PW depicted in Table 5.5
is the ﬁxed point of a morphism ϕW and it has the shape-symmetric property with
respect to ϕW. These notions are well ﬁtted to a volume dedicated to tilings and
are presented in Sect. 5.7. We introduce a generalization of numeration systems
whose language of representations is regular: abstract numeration systems. Indeed,
a multidimensional inﬁnite word is S-automatic, for some abstract numeration
system S, if and only if it is the image by a coding of a shape-symmetric word.
Hence we prove that PW codes the P-positions of the Wyhtoff’s game. We conclude
this chapter with a short discussion about games with a ﬁnite set of rules and some
bibliographic notes.
5.2
Notation and Conventions
We assume that 0 belongs to the set N of non-negative integers. An alphabet is just
a ﬁnite set. A (ﬁnite) word over an alphabet A is a ﬁnite sequence of elements in
A, i.e., a map from a ﬁnite set {0, . . . , ℓ−1} to A. The length of the word w is
denoted by |w|. The set of ﬁnite words over A is denoted by A∗. Equipped with
the concatenation product, it is a free monoid. A (right) inﬁnite word is a map from
N to A. It is indeed more convenient (when working with automatic sequences)
1A video is available at http://library.cirm-math.fr/.

5
From Combinatorial Games to Shape-Symmetric Morphisms
229
to start indexing with 0. We will indifferently use the terminology inﬁnite word or
sequence. Compared with other chapters of this book, we will never encounter bi-
inﬁnite words. Let d ≥2 be an integer. By extension, we say that a map from Nd to
an alphabet A is a (multidimensional) inﬁnite word or sequence. Inﬁnite words will
be denoted using a bold face letter such as x or PW.
Let k ≥2 be an integer. We let repk(n) denote the usual base-k expansion
of n ≥0. It is a word over the alphabet {0, . . ., k −1}. We set repk(0) to be
the empty word denoted by ε. Except when stated otherwise (when dealing with
a transducer computing the successor function in the proof of Theorem 5.5.20
or, when considering an automaton realizing addition in base 2 in the proof of
Lemma 5.6.8), we use the most signiﬁcant digit ﬁrst convention (MSDF): if n > 0,
the most signiﬁcant digit of repk(n) is written on the left—as a preﬁx—and is non-
zero. If w = wℓ· · · w0 is a word over an alphabet A ⊂Z, then the k-numerical
value of w (w.r.t. A) is given by the map
valk : A∗→Z, w →
ℓ

i=0
wi ki .
In this chapter, we will also encounter other numeration systems, i.e., bijections
from N to some (inﬁnite) formal language L. We will adapt the corresponding
notation to repL : N →L and valL : L →N.
We assume that the reader is familiar with basic concepts from graph theory. If
G = (V, E) is a directed graph and u, v ∈V are two of its vertices, we write
(u, v) ∈E or u →v to denote an edge of G. Nevertheless, we recall the deﬁnition
of a ﬁnite automaton. We will encounter automata in Sect. 5.4. For more, see, for
instance, [79, 83, 86].
Deﬁnition 5.2.1 A deterministic ﬁnite automaton (DFA for short) is a 5-tuple M =
(Q, q0, A, δ, F) where Q is a ﬁnite set of states, q0 ∈Q is the initial state, A is the
alphabet of the automaton, δ : Q × A →Q is the transition function and F ⊆Q is
the set of ﬁnal states.
For a DFA M, the transition function is extended to δ : Q × A∗→Q by
δ(q, ε) = q and δ(q, aw) = δ(δ(q, a), w) for all q ∈Q, a ∈A, w ∈A∗. If the
automaton is clear from the context, we simply write q · w instead of δ(q, w). The
state reached when reading w from the initial state will also be written M · w. The
language accepted or recognized by M is
L(M) = {w ∈A∗| M · w ∈F} .
A language is regular if it is accepted by some DFA.
Deﬁnition 5.2.2 A deterministic ﬁnite automaton with output (DFAO for short)
is given by a 5-tuple M = (Q, q0, A, δ, μ) where the ﬁrst four components are
deﬁned as for a DFA and μ : Q →B is the output map (where B is some alphabet).
A DFAO where the output map takes at most two values is a standard DFA.

230
M. Rigo
Deﬁnition 5.2.3 A non-deterministic ﬁnite automaton (NFA for short) over an
alphabet A is given by a 5-tuple N = (Q, I, A, Δ, F) where Q is a ﬁnite set of
states, I ⊆Q is the set of initial states, Δ ⊂Q × A∗× Q is the (ﬁnite) transition
relation and F ⊆Q is the set of ﬁnal states. A word w is accepted by N if there
exist an integer i, some (possibly empty) words v1, . . . , vi and a sequence of states
q1, . . . , qi+1 such that w = v1 · · · vi and
•
(q1, v1, q2), (q2, v2, q3), . . . , (qi, vi, qi+1) ∈Δ
•
q1 ∈I, qi+1 ∈F.
Otherwise stated, there is at least one accepting path with label w from an initial
state to some ﬁnal state. The language accepted by N is the set of accepted words.
One can assume that (q, ε, q) belongs to Δ for all q ∈Q.
5.3
Bits of Combinatorial Game Theory
They are many kinds of games that you can think of. We deliberately restrict
ourselves to one of the most simple classes: subtraction games (taking and breaking
games) [48]. In this setting, we have two players acting in turns. They have a ﬁnite
number of tokens organized in piles to start with. The tokens are given in some
initial position. Typically, the players have to remove some tokens complying to
prescribed rules. A player may not pass: at least one token must be removed. The
set of rules is known in advance and we have the same rules for both players. There
is no chance involved (no randomness) and the information is completely known
for both players—no hidden information for one of the two players [1, 67]. Finally
we will assume a normal play convention: the ﬁrst player unable to move loses the
game. Nim game and Wythoff’s game will provide us with quite enough material.
I do not assume that the reader has any particular knowledge about CGT. Some
general references are [2, 13, 85]. I was also inspired by Ferguson’s lecture notes
from UCLA. This section serves as a self-contained introduction to the topic. It is
not at all aimed to be exhaustive.
Example 5.3.1 (Finite Subtraction Game)
Starting from a single ﬁnite pile of
tokens, the players may remove either 1, 2 or 4 tokens. The player taking the last
token wins the game. An example of game is given by the following sequence
9
−2
−→7
−1
−→6
−1
−→5
−2
−→3
−2
−→1
−1
−→0.
For instance, we can immediately see that when a player is in a position with 3
tokens left, he/she will lose the game because the only available options are to
remove either 1 or 2 tokens. We will encounter ﬁnite subtraction game with several
piles of tokens in Sect. 5.8.

5
From Combinatorial Games to Shape-Symmetric Morphisms
231
Example 5.3.2 (Game of Nim)
Let p ≥1 be the number of piles of tokens to
play with. If we assume here that the piles are ordered, a position is coded by a
p-tuple of non-negative integers. An initial position is given: a game starts with p
piles containing respectively x1, . . . , xp ≥0 tokens. In their turn to play, the player
chooses a non-empty pile and removes a positive number of tokens from it. Thus,
from a position of the form (x1, . . . , xp) the available options are given by p-tuples
of the form (y1, . . . , yp) ∈Np where there exists j such that yj < xj and yi = xi
for all i ̸= j. In particular, the number of options available from (x1, . . . , xp) is
just p
i=1 xi. The game is lost for the player left in the position (0, . . . , 0). Loosing
positions will be determined in Theorem 5.3.13.
In this section, to avoid any confusion, generic positions are denoted by Greek
letters: α, β, γ . Formally, if α and β are two positions of a subtraction game, we
say that β is an option of α, if there is a move permitting the players to go from α
to β. The set of options of α is denoted by Opt(α). We can extend Opt to a set X
of positions in a natural way: Opt(X) = ∪α∈X Opt(α). The reﬂexive and transitive
closure of Opt is denoted by Opt∗: β belongs to Opt∗(α) if and only if there exists
a ﬁnite (possibly empty) sequence of moves from α to β. In graph-theoretic terms,
one can speak of successor instead of option.
Example 5.3.3 (Wythoff’s Game)
Consider the following modiﬁcation of the game
of Nim on two piles. We add extra rules to the set of Nim rules. A player can,
as for Nim, either remove a positive number of tokens from one pile, or remove
simultaneously the same number of tokens from both piles. So from a position
(x1, x2) ̸= (0, 0), a player can move to either (x1 −i, x2) with 0 < i ≤x1, or
(x1, x2 −i) with 0 < i ≤x2, or (x1 −i, x2 −i) with 0 < i ≤min{x1, x2}. An
example of play, starting with the position (4, 3), is given below:
(4, 3)
−(2,0)
−→(2, 3)
−(1,1)
−→(1, 2)
−(0,1)
−→(1, 1)
−(1,1)
−→(0, 0).
The chosen move is indicated on the arrows. The reader may already notice this:
the player in position (1, 2) whatever the chosen move is, will give a position for
the other player from which the game can always be won. Loosing positions will be
determined by Theorem 5.3.14.
Note that it is a quite natural setting to encounter subtraction games whose rule-
set extends the game of Nim.
Deﬁnition 5.3.4 (Game-Graph) A subtraction game is given (notation will not
refer to the chosen game). The game-graph Grγ , for an initial position γ , is the
ﬁnite directed graph whose set V (Grγ ) of vertices is the set of positions that can
be reached from γ by a ﬁnite sequence of allowed moves, i.e., V (Grγ ) = Opt∗(γ ).
There is an edge from α to β if and only if β belongs to Opt(α). The set of edges is
denoted by E(Grγ ).
Remark 5.3.5 In a subtraction game, consider two positions α and β. If β can be
reached from α, i.e., β ∈Opt∗(α), then the game-graph Grβ associated with β is a

232
M. Rigo
subgraph of the game-graph Grα associated with α. More precisely, we have
E(Grβ) = E(Grα) ∩

V (Grβ) × V (Grβ)
	
and there is no edge in Grα from V (Grβ) to V (Grα) \ V (Grβ).
For subtraction games, the corresponding game-graph is obviously acyclic: the
total number of tokens left is decreasing. Thus, there exists at least one vertex with
out-degree equal to zero.2
Deﬁnition 5.3.6 Let G = (V, E) be a directed graph. To stick to the game setting,
we denote by Opt(u) the set of vertices v such that (u, v) ∈E. In particular, the
out-degree of u is # Opt(u). A kernel of G is a subset K of V with the following
two properties:
•
K is stable: ∀u ∈K, Opt(u) ∩K = ∅;
•
K is absorbing: ∀v ∈V \ K, Opt(v) ∩K ̸= ∅.
Let G = (V, E) be a ﬁnite directed acyclic graph (it is common in the literature
to ﬁnd the acronym DAG). For instance, DAG are the graphs with a topological sort
of the vertices [74]. Let us describe an algorithm to compute a kernel of G [12]. Let
G0 = G. We will build a ﬁnite sequence of subgraphs (Gi)i≥0.
•
Let P0 be the set of vertices of G0 with out-degree equal to zero (sometimes
called sink vertices),
P0 = {v ∈V (G0) | Opt(v) = ∅}.
•
Let N0 be the set of vertices x of G0 such that Opt(x) ∩P0 ̸= ∅.
Due to the absorbing property, the vertices of P0 must belong to any kernel of G.
Therefore, the vertices in N0 do not belong to any kernel of the graph due to stability.
Let G1 be the subgraph obtained by removing the vertices in P0 ∪N0. This graph
is again acyclic. We repeat the procedure and deﬁne P1 and N1 accordingly. If a
vertex v belong to P1, it has no option in V (G1). In the original graph G0, it has no
option in P0 because otherwise we would have v ∈N0. Thus again the vertices of
P1 must belong to any kernel of G and the vertices in N1 are in no kernel of G. We
deﬁne a sequence of subgraphs where Gi+1 is obtained by removing Pi ∪Ni from
Gi. The procedure halts when we reach an empty subgraph. We directly get the next
proposition.
Proposition 5.3.7 Let G = (V, E) be a ﬁnite directed acyclic graph. Applying the
above algorithm, the set ∪iPi is the unique kernel of G.
2Consider a simple path v0 →v1 →· · · →vr of maximal length r in a ﬁnite acyclic graph. Then
vr has out-degree zero. Proceed by contradiction and assume that there is an edge starting from vr.
Either it goes to one of the vi’s with i < r and it creates a cycle. Or, it goes to some other vertex
and we may build a longer simple path. Both situations lead to a contradiction.

5
From Combinatorial Games to Shape-Symmetric Morphisms
233
Remark 5.3.8 If the graph is not acyclic, the situation is not so nice. Consider a
simple (oriented) cycle of length n. It is easy to see that if n is odd (resp. even), then
the graph has no kernel (resp. two kernels). Moreover, the reader may notice that
the previous algorithm does not work anymore.
Consider a subtraction game. For a game-graph Grβ, since it is acyclic, we have
a partition of the set of vertices of Grβ into two subsets: those belonging to the
kernel and those out of it. The ﬁrst ones will be called P-positions, the other ones
N-positions. Moreover, thanks to Remark 5.3.5, we see that the status of a position
is invariant with respect to the initial position: if α, β are two positions such that
β ∈Opt∗(α), then the kernel of Grβ is a subset of the kernel of Grα. The following
deﬁnition is thus meaningful.
Deﬁnition 5.3.9 (N- and P-Positions) Consider a subtraction game. A position is
a losing position, or P-position, if all its options are N-positions. A position is a
winning position, or N-position, if there exists an option which is a P-position. The
set of P-positions (resp. N-positions) is denoted P (resp. N).
The classical meaning of P or N in CGT refers to the “previous” player or the
“next” move. In a P-position, the previous player (so not the one being in that actual
position) is able to win the game. In a N-position, the actual player may choose the
correct next move to win the game. This choice is the notion of a winning strategy:
selecting for every P-position one available N-position among the options.
Remark 5.3.10 In a subtraction game on p piles of tokens, if there is a move from
(x1, . . . , xp) to (y1, . . . , yp), then 
i xi > 
i yi. Let C ≥0 be an integer. If we
know the status N or P of all positions (x1, . . . , xp) such that 
i xi ≤C, then we
can determine the status of any position (x1, . . . , xp) such that 
i xi = C + 1.
Example 5.3.11 Consider the ﬁnite subtraction game of Example 5.3.1. Prove that
n is a P-position if and only if n ≡0 (mod 3).
Even though the status N or P of positions can be determined by some naive
methods, let us stress the fact that in terms of algorithmic complexity, computing the
kernel of the game-graph or, equivalently using the above remark, has an exponential
cost compared to the size of the input (size of the game position) [44]. Indeed,
when playing a game like Wythoff’s game, a position (x1, x2) is coded by a word
(let us think about the base-2 expansions of x1 and x2 that are the inputs given
to the algorithm) whose length is proportional to logx1 + log x2 = log(x1.x2).
But the game-graph has a number of vertices equal to (x1 + 1).(x2 + 1) which is
exponentially larger than the size of the input. One can therefore ask for an algorithm
determining the status of a position whose complexity is a polynomial in the length
of the coding. We will see in Sect. 5.5 that deciding the status of a position of the
Wythoff’s game can be done in polynomial time.
Deﬁnition 5.3.12 Let m, n be two non-negative integers. Let x = xℓ· · · x0 and
y = yℓ· · · y0 be two words over {0, 1} such that val2(x) = m and val2(y) = n.
In other words, x and y are the base-2 expansions of m and n up to some leading

234
M. Rigo
zeroes ensuring that we have two words of the same length. The Nim-sum of m and
n is the integer
m ⊕n =
ℓ

j=0

xj + yj mod 2
	
2j.
As an example, 7 ⊕2 ⊕9 = 12. It is an easy exercise to show that (N, ⊕) is an
Abelian group.
Theorem 5.3.13 (Bouton’s Theorem [15])
For the game of Nim played on p ≥1
piles of tokens, a position (x1, . . . , xp) is in P if and only if
p
!
i=1
xi = 0.
Proof From Deﬁnition 5.3.9, we have to prove that the set K of p-tuples with zero
Nim-sum is stable and absorbing. If we consider a p-tuple whose Nim-sum is zero,
playing one move of Nim will change exactly one of the piles of tokens. Thus we
modify exactly one term, let us say xj, of the Nim-sum. Therefore, at least one bit
of rep2(xj) is modiﬁed and thus the Nim-sum is no more equal to zero. This shows
that the set K is stable.
Now we have to prove that K is absorbing. Consider a p-tuple whose Nim-sum s
is non-zero. There exists ℓ≥0 such that 2ℓ≤s < 2ℓ+1. Let xj be a component such
that the base-2 expansion of xj has a non-zero digit in the position corresponding
to 2ℓ(such an element exists), i.e., rep2(xj) = v1w where |w| = ℓ. We can thus
replace xj with a smaller integer in such a way that the total Nim-sum is zero.
⊓⊔
Two years after Bouton’s result, Wythoff proposed a modiﬁcation of the game of
Nim and characterized the corresponding set of P-position [87].
Theorem 5.3.14 (Wythoff’s Theorem)
A pair (x, y) is a P-position of the game
of Wythoff if and only if it is of the form

⌊nϕ⌋, ⌊nϕ2⌋

or

⌊nϕ2⌋, ⌊nϕ⌋

,
for some n
where ϕ is the Golden ratio (1 +
√
5)/2.
For a proof, see the original paper of Wythoff. It is enough to prove that for the
game-graph associated with Wythoff’s game, the above set is stable and absorbing.
This can be considered as a “difﬁcult” exercise (one has to deal with integer and
fractional parts of multiple of the Golden ratio).
Deﬁnition 5.3.15 (MeX) If S is a strict subset of N, then MeX(S) = min(N \ S).
So it is the least non-negative integer not in S. It stands for “minimal excluded”
value. In particular, MeX(∅) = 0.

5
From Combinatorial Games to Shape-Symmetric Morphisms
235
For a subtraction game, we introduce a map associating a non-negative integer
with each position. This map is deﬁned recursively. Its use will be clear when we
introduce the sum of games.
Deﬁnition 5.3.16 The Sprague–Grundy function G (of a game with an acyclic
game-graph) is deﬁned by
G(x) = MeX ({G(y) | y ∈Opt(x)}) .
Example 5.3.17 (Continuing Example 5.3.1) If the players are allowed to remove
1, 2, 4 tokens from a single pile, the ﬁrst values of the Sprague–Grundy function are
given in Table 5.1. It is an easy exercise (left to the reader) to prove that this function
is periodic of period 3: G(n) = n mod 3. We will reconsider games with a ﬁnite
set of moves in Sect. 5.8. See Proposition 5.8.1.
Proposition 5.3.18 Consider a subtraction game. A position α is a P-position if
and only if G(α) = 0.
Proof One has to prove that {α | G(α) = 0} is the kernel of the game-graph. This
is a direct consequence of the use of the MeX operator in the deﬁnition of G.
⊓⊔
The reader may wonder why Sprague–Grundy functions, or simply Grundy
functions, could be useful. It turns out that we can consider the (disjunctive) sum of
games. Assume that we have several games G1, . . . , Gn in front of the two players,
e.g. a Wythoff’s game G1 in position (3, 4), a game of Nim G2 in position (1, 2, 3)
and another Wythoff’s game G3 in position (2, 2). The idea is that, at each turn, the
actual player chooses the game where he/she plays a move. We use the same normal
convention: when there is no more available move (in any of the n games), the game
is lost.
Deﬁnition 5.3.19 (Sum of Games) Let Gr1, . . . , Grn be the game-graphs of n
games G1, . . . , Gn respectively. The game-graph of the sum of G1, . . . , Gn has
the Cartesian product
V (Gr1) × · · · × V (Grn)
as set of vertices. If (α1, . . . , αn) is a vertex, i.e., αi is a position of Gi, for all i, then
there is an edge to (β1, . . . , βn) whenever there exists j such that βj ∈Opt(αj)
(being understood that βj is an option of αj in the game Gj) and βi = αi for all
i ̸= j.
Table 5.1 First few values of G for a ﬁnite subtraction game
n
0
1
2
3
4
5
6
7
8
9
10
· · ·
G(n)
0
1
2
0
1
2
0
1
2
0
1
· · ·

236
M. Rigo
This theory has been independently developed by R. P. Sprague and
P. M. Grundy.3
Theorem 5.3.20 (Sprague–Grundy Theorem)
Let Gi be impartial combinato-
rial games with Gi as respective Grundy functions, i = 1, . . . , n. Then the sum of
games G1 + · · · + Gn has a Grundy function G given by
G(α1, . . . , αn) = G1(α1) ⊕· · · ⊕Gn(αn)
where, for all i, αi is a position in Gi.
Proof Let (α1, . . . , αn) be an arbitrary position in the sum of the n games. Let b be
the integer G1(α1) ⊕· · · ⊕Gn(αn). We will prove that
1. for all non-negative integers a < b, there is an option from (α1, . . . , αn) with
G-value a;
2. no option of (α1, . . . , αn) has G-value b.
If the two items are proved, by deﬁnition of the Sprague–Grundy function, this
means that G(α1, . . . , αn) = b = G1(α1) ⊕· · · ⊕Gn(αn).
Let d = a ⊕b and ℓbe the length of the base-2 expansion of d, i.e., 2ℓ−1 ≤d <
2ℓ. Since a < b, the base-2 expansion of b must have a 1 in position ℓand a must
have 0 in that position. Indeed, if the most signiﬁcant digits of a and b are the same,
then these digits will cancel each other in the Nim-sum; the position corresponding
to 2ℓ−1 is the most signiﬁcant one where they differ:
rep2(a) = u0v,
rep2(b) = u1v′,
|v| = |v′| = ℓ−1 .
But b = G1(α1)⊕· · ·⊕Gn(αn). Hence, there exists i such that the base-2 expansion
of Gi(αi) has a 1 in position ℓ. Hence, d ⊕Gi(αi) < Gi(αi). In the ith game, by
deﬁnition of the Sprague–Grundy function Gi, there is thus a move from αi to some
position α′
i such that Gi(α′
i) = d ⊕Gi(αi). In the sum of the games, there is a move
from (α1, . . . , αi, . . . , αn) to (α1, . . . , α′
i, . . . , αn) and
G1(α1) ⊕· · · ⊕Gi(α′
i) ⊕· · · ⊕Gn(αn)
= d ⊕G1(α1) ⊕· · · ⊕Gi(αi) ⊕· · · ⊕Gn(αn)
= d ⊕b = a.
Let us consider the second item and proceed by contradiction. Assume that the
position (α1, . . . , αi, . . . , αn) has an option (α1, . . . , α′
i, . . . , αn) with the same G-
value. Hence,
G1(α1) ⊕· · · ⊕Gi(αi) ⊕· · · ⊕Gn(αn) = G1(α1) ⊕· · · ⊕Gi(α′
i) ⊕· · · ⊕Gn(αn)
3The following proof is inspired by the one found in Thomas S. Ferguson’s lecture notes on CGT.

5
From Combinatorial Games to Shape-Symmetric Morphisms
237
and we conclude that Gi(αi) = Gi(α′
i) which contradicts the fact that Gi is a
Sprague–Grundy function and that α′
i is an option of αi (in the ith game).
⊓⊔
Remark 5.3.21 A game of Nim on p piles of tokens can be seen as the sum of p
games of Nim on a single pile. Consequently, if we have p piles with respectively
x1, . . . , xn tokens, then the corresponding Grundy value for this position is ⊕p
i=1xi.
Also, with a single pile, the Grundy value of the position n ≥0 is simply n. Thus,
Bouton’s theorem can retrospectively be seen as a corollary of Proposition 5.3.18
and Sprague–Grundy theorem.
In Table 5.2, we give the ﬁrst few values of the Sprague–Grundy sequence
(GNIM(m, n))m,n≥0 for Nim on two piles. Our interest in this example comes from
Exercises 21 and 22 found in [8, Section 16.6, p. 451].
Of course, values in this table can easily be obtained by computing a Nim-sum
but we would like to know more about the structure of this table. Can we ﬁnd some
general pattern or recurrence occurring in it? We can also ask the same question for
Wythoff’s game. The following table can easily be computed using Remark 5.3.10.
It will turn out that the analysis of Tables 5.2 and 5.3 are quite different.
Table 5.2 First few values of the Grundy function for Nim on two piles
9 9 8 11 10 13 12 15 14
1
0
8 8 9 10 11 12 13 14 15
0
1
7 7 6
5
4
3
2
1
0
15 14
6 6 7
4
5
2
3
0
1
14 15
5 5 4
7
6
1
0
3
2
13 12
4 4 5
6
7
0
1
2
3
12 13
3 3 2
1
0
7
6
5
4
11 10
2 2 3
0
1
6
7
4
5
10 11
1 1 0
3
2
5
4
7
6
9
8
0 0 1
2
3
4
5
6
7
8
9
0 1
2
3
4
5
6
7
8
9
Table 5.3 First few values of the Grundy function for Wythoff’s game
9 9 10 11 12 8
7
13 14 15 16
8 8
6
7
10 1
2
5
3
4
15
7 7
8
6
9
0
1
4
5
3
14
6 6
7
8
1
9 10
3
4
5
13
5 5
3
4
0
6
8
10
1
2
7
4 4
5
3
2
7
6
9
0
1
8
3 3
4
5
6
2
0
1
9
10 12
2 2
0
1
5
3
4
8
6
7
11
1 1
2
0
4
5
3
7
8
6
10
0 0
1
2
3
4
5
6
7
8
9
0
1
2
3
4
5
6
7
8
9

238
M. Rigo
It is indeed an old open problem to obtain non-trivial information about the values
given in Table 5.3. Not much is known, even for the positions with G-value equal to
1. See Sect. 5.6.2.
5.4
Automatic and Regular Sequences
The question concluding the previous section motivates us for introducing ﬁrst,
k-automatic sequences and then, k-regular sequences (k
≥2 is an integer).
The main difference between the two concepts is that the ﬁrst one is limited to
sequences taking values in an alphabet. We will see, in Sect. 5.6 where concepts are
generalized to a multidimensional setting, that the bidimensional inﬁnite sequence
(GNIM(m, n))m,n≥0 is 2-regular. This will provide us with a general construction
scheme and recurrence relations for (GNIM(m, n))m,n≥0.
There are many good references dealing with automatic and regular sequences.
To cite just a few, we mention Allouche and Shallit’s book [8], the original paper by
Cobham [31] and the survey [17].
Many characterizations of these sequences do exist. A k-automatic sequence can
be deﬁned as the image under a coding, i.e., a mapping4 on a smaller alphabet, of
a ﬁxed point of a k-uniform morphism (see Deﬁnition 5.4.5). It is the sequence of
outputs of a DFA fed with base-k expansions (see Theorem 5.4.12). For every letter,
the set of indices corresponding to this letter is deﬁned by a ﬁrst order formula in
⟨N, +, Vk⟩. This is the so-called Büchi–Bruyère theorem [17]. When k is a prime
power, it can be deﬁned in terms of algebraic formal power series (this is the so-
called Christol–Kamae–Mendès France–Rauzy theorem [28]). It also appears as a
column of the space-time diagram of a cellular automaton [78], see Theorem 5.4.16
below. Finally, it can be deﬁned in terms of ﬁniteness of the its k-kernel (see
Theorem 5.4.19).
5.4.1
Generalities on Sequences and Morphisms
Let us take some time to deﬁne properly some important notions. We ﬁrst deﬁne
a distance turning AN into a complete ultrametric space for which the notion of
convergence is usual. For general references, see, for instance, [8, 27, 62, 72].
Deﬁnition 5.4.1 Let w, x be two distinct inﬁnite words in AN. We let Λ(w, x)
denote the longest common preﬁx of w and x and we deﬁne a map d : AN × AN →
[0, +∞) by
d(w, x) = 2−|Λ(w,x)| .
4A coding is a morphism from A∗to B∗where the image of every letter has length 1.

5
From Combinatorial Games to Shape-Symmetric Morphisms
239
Note that |Λ(w, x)| = inf{i ∈N | wi ̸= xi}. Moreover, we set d(w, w) = 0. Hence,
the longer preﬁx two words share, the closer they are. It is obvious that d(w, x) > 0
whenever w ̸= x.
Deﬁnition 5.4.2 Let (wn)n≥0 be a sequence of inﬁnite words over the alphabet A.
This sequence converges to the word z ∈AN if d(wn, z) →0 whenever n →+∞.
Otherwise stated, for all ℓ∈N, there exists N such that, for all n ≥N, wn and z
share a common preﬁx of length at least ℓ. We say that z is the limit of the converging
sequence (wn)n≥0.
Let (wn)n≥0 be a sequence of ﬁnite words over A. If # is an extra symbol that
does not belong to A, then any word u ∈A∗is in one-to-one correspondence with
the inﬁnite word u #ω ∈(A ∪{#})N where #ω means the concatenation of inﬁnitely
many copies of #. We say that the sequence (wn)n≥0 converges to the inﬁnite word
w if the sequence of inﬁnite words (wn#ω)n≥0 converges to w.
Let f : A∗→A∗be a morphism, i.e., a map such that f (uv) = f (u)f (v) for all
words u, v ∈A∗. Observe that a morphism is completely deﬁned from the images
of the letters. Let a be a letter in the alphabet A. If there exists a ﬁnite word u such
that f (a) = au, then
lim
n→+∞f n(a) = a u f (u) f 2(u) f 3(u) · · · .
(5.1)
Note that this limit denoted by f ω(a) is well deﬁned in the above topology. It can
possibly be equal to a ﬁnite word if, for some k ≥1, we have f k(u) = ε. To avoid
this situation, a morphism f : A∗→A∗is said to be prolongable on the letter
a ∈A, not only if there exists a ﬁnite word u such that f (a) = au but also, if
lim
n→+∞|f n(a)| = +∞.
We will encounter a more general situation, where a second morphism is applied
to the inﬁnite word obtained by iterating a ﬁrst morphism. If g : A∗→B∗is a non-
erasing morphism, i.e., for all a ∈A, g(a) ̸= ε, it can be extended to a map from
AN to BN as follows. If x = x0x1 · · · is an inﬁnite word over A, then the sequence of
words (g(x0 · · · xn−1))n≥0 converges to an inﬁnite word over B. Its limit is denoted
by g(x) = g(x0)g(x1)g(x2) · · · .
Note that we can always consider non-erasing prolongable morphisms and
codings.
Theorem 5.4.3 Let f
: A∗→A∗be a (possibly erasing) morphism that is
prolongable on a letter a ∈A. Let g : A∗→B∗be a (possibly erasing)
morphism. If the word g(f ω(a)) is inﬁnite, there exists a non-erasing morphism
h : C∗→C∗prolongable on a letter c ∈C and a coding j : C∗→B∗such that
g(f ω(a)) = j(hω(c)).

240
M. Rigo
This result was already stated by Cobham in 1968 [29]. For a proof, see [8]. An
alternative short proof is given in [53]. This result is also discussed in details in [21]
and [23].
Deﬁnition 5.4.4 (Morphic Word) An inﬁnite word obtained by iterating a pro-
longable morphism is said to be purely substitutive or purely morphic. In the
literature, one also ﬁnds the term pure morphic. If x ∈AN is pure morphic and if
g : A →B is a coding, then the word y = g(x) is said to be morphic or substitutive.
5.4.2
Iterating a Constant-Length Morphism
It is now time to present k-automatic sequences. See the original paper of Cobham
[30] and the comprehensive book [8].
Deﬁnition 5.4.5 (Uniform Morphism) Let k ≥2. A morphism f : A∗→B∗
satisfying |f (a)| = k, for all a ∈A, is said to be of constant length k or k-uniform.
A 1-uniform morphism is a coding.
Deﬁnition 5.4.6 Let A, B be two alphabets. An inﬁnite word w ∈BN is k-
automatic if there exist a k-uniform morphism f : A∗→A∗prolongable on a ∈A,
and a 1-uniform morphism g : A∗→B∗, such that w = g(f ω(a)).
The quotient ⌊j/k⌋of the Euclidean division of j by k is denoted by j DIV k.
So to speak, for any symbol xj occurring in x = f ω(a), we can track its history,
see Fig. 5.1: xj has been produced by f from xj DIV k. The latter symbol appears
itself in the image by f of x(j DIV k) DIV k, and so on and so forth. Note that if the
base-k expansion of j is repk(j) = ci · · · c1c0, then the base-k expansion of j DIV k
is ci · · · c1. This simple observation permits one to easily track the past of a given
symbol xj by considering the preﬁxes of repk(j). In other words, we have the next
result.
Lemma 5.4.7 Let f : A∗→A∗be a k-uniform morphism prolongable on a and
x = x0x1x2 · · · = f ω(a). Let j such that km ≤j < km+1, for some m ≥0. Then
j = kq + r with km−1 ≤q < km and 0 ≤r < k and the symbol xj is the (r + 1)st
symbol occurring in f (xq).
The next construction will be crucial in this chapter. In particular, it explains
where the term “automatic sequence” comes from. The automaton that we introduce
encodes exactly the same information as the morphism f . The fact that the
Fig. 5.1 Tracking a symbol
in a k-automatic word
k
k2

5
From Combinatorial Games to Shape-Symmetric Morphisms
241
morphism has constant length implies that the DFA is complete, i.e., the transition
function is deﬁned for all (b, i) ∈A × {0, . . ., k −1}.
Deﬁnition 5.4.8 (DFA Associated with a Morphism)
We associate with a k-
uniform morphism f
:
A∗
→
A∗and a letter a
∈
A, a DFA Af
=
(A, a, {0, . . ., k −1}, δf , A) where δf (b, i) = wb,i if f (b) = wb,0 · · · wb,k−1.
We assume that the letter a is clear from the context, if it is not the case, one can
use a notation such as Af,a. If a state b has a loop labeled by 0, then the morphism
is prolongable on the letter b.
It is a bit tricky, but the alphabet A is the set of states of this automaton.
Example 5.4.9 Consider the morphism f and the associated automaton depicted in
Fig. 5.2.
Proposition 5.4.10 Let x = f ω(a) = x0x1 · · · with f a k-uniform morphism
prolongable on the letter a. With the above notation, for the DFA Af associated
with f , we have, for all j ≥0,
xj = δf (a, repk(j)) = Af · repk(j) .
Proof This is a direct consequence of Lemma 5.4.7. Reading an extra symbol in
Af corresponds to append a digit on the right (least signiﬁcant digit) of a base-k
expansion. The reader can also look at the proof of Theorem 5.5.6 expressed in a
more general setting.
⊓⊔
The converse also holds.
Proposition 5.4.11 Let (A, a, {0, . . ., k −1}, δ, A) be a DFA s.t. δ(a, 0) = a.
Then the word x = x0x1x2 · · · deﬁned by xj = δ(a, repk(j)), for all j ≥0,
is the ﬁxed point of a k-uniform morphism f prolongable on a where f (b) =
δ(b, 0) · · · δ(b, k −1) for all b ∈A.
Proof This is a direct consequence of Lemma 5.4.7.
⊓⊔
0
1
2
0, 2
1
1
0
2
Fig. 5.2 A uniform morphism and its automaton

242
M. Rigo
Theorem 5.4.12 Let w = w0w1w2 · · · be an inﬁnite word over an alphabet B. It
is of the form g(f ω(a)) where f : A∗→A∗is a k-uniform morphism prolongable
on a ∈A and g : A∗→B∗is a coding if and only if there exists a DFAO
(A, a, {0, . . ., k −1}, δ, μ : A →B)
such that δ(a, 0) = a and, for all j ≥0, wj = μ(δ(a, repk(j))).
A proof of this result can essentially be derived from Lemma 5.4.7. One has
simply to put together the previous two propositions and consider an extra coding
and thus an output function for the DFA. Nevertheless, we will prove later on (see
Theorems 5.5.6, 5.7.26, and Proposition 5.7.27) a general statement that includes
the case discussed above.
The next notion will permit us to easily discuss recognizable series.
Deﬁnition 5.4.13 (Transition Matrices) With a DFA or a DFAO over the alphabet
A = {0, . . ., k −1}, we may associate k square matrices of NA×A, a transition
matrix Mi for each label i < k. The matrix Mi is deﬁned by
[Mi]a,b =
1 , if a · i = b;
0 , otherwise.
Note that each row of these matrices contains exactly one 1. Multiplying such a
matrix on the left by a row vector of the form 
0 · · · 0 1 0 · · · 0
	 gives a vector of
the same form.
Example 5.4.14 Let us continue Example 5.4.9. The corresponding three matrices
are given by
M0 =
⎛
⎝
1 0 0
0 0 1
0 1 0
⎞
⎠
M1 =
⎛
⎝
0 1 0
0 1 0
0 0 1
⎞
⎠,
M2 =
⎛
⎝
0 0 1
0 1 0
1 0 0
⎞
⎠.
The next observation is a prelude to the notion of a linear representation of a
recognizable series.
Remark 5.4.15 If the initial state is the ﬁrst one, then the state reached when reading
a word w1 · · · wℓin the automaton (from the initial state) can be determined by the
following matrix product:

1 0 · · · 0
	 Mw1 · · · Mwℓ.
We obtain the characteristic vector of the reached state (all entries are 0 except one).
This is easily shown by induction on the length of the input word. If the input word is
empty, the matrix product is empty hence equal to the identity matrix and we get the
initial characteristic vector. If

1 0 · · · 0
	
Mw1 · · · Mwi is the characteristic vector of

5
From Combinatorial Games to Shape-Symmetric Morphisms
243
the state s reached when reading w1 · · · wi then the multiplication by Mwi+1 is equal
to s · wi+1 by deﬁnition of the matrix.
We would like to mention a connection with cellular automata.
Theorem 5.4.16 (Rowland and Yassawi [78]) A sequence over a ﬁnite ﬁeld Fq of
characteristic p is p-automatic if and only if it occurs as a column of the space-time
diagram, with eventually periodic initial conditions, of a linear cellular automaton
with memory over Fq.
5.4.3
k-Kernel of a Sequence
The next characterization of k-automatic sequences will be extensively used in this
chapter. It will lead to the notion of k-regular sequence which is based on a property
of the module generated by the k-kernel of a sequence. Note that the next notion
introduced by Eilenberg [39] is not related to the graph-theoretic notion introduced
in Deﬁnition 5.3.6 (the standard terminology is a bit unfortunate).
Deﬁnition 5.4.17 Let k ≥2. The k-kernel of a sequence x = (x(n))n≥0 is the set
of subsequences:
Kerk(x) =

(x(kin + s))n≥0 | i ≥0, 0 ≤s < ki
.
An alternative way to deﬁne the k-kernel is ﬁrst to introduce k operators of k-
decimation, for r ∈{0, . . . , k −1}, we set
∂k,r((x(n))n≥0) := (x(kn + r))n≥0 .
(5.2)
The k-kernel of x is thus the set of sequences of the form
∂k,r1 ◦· · · ◦∂k,rm((x(n))n≥0),
r1, . . . , rm ∈{0, . . . , k −1}.
(5.3)
Remark 5.4.18 Notice that considering a subsequence of the form (x(kin + s))n≥0
with repk(s) = rm · · · r1, m ≤i, corresponds exactly to extracting the subse-
quence of indices whose base-k expansions have a sufﬁx of length i of the form
0i−mrm · · · r1. (We assume that expansions of length less than i may be preceded by
leading zeroes.)
Theorem 5.4.19 (Eilenberg) A sequence is k-automatic if and only if its k-kernel
is ﬁnite.
A proof can be found in [8, Thm. 6.6.2]. We provide an alternative proof of the
fact that automaticity implies ﬁniteness of the kernel.

244
M. Rigo
Table 5.4 The 3-kernel of f ω(a) for the morphism given in Example 5.4.9
ε
0
1
2
01
02
10
20
22
010
020
022
201
202
220
0220
2022
a
a
a
b
c
b
c
c
b
a
c
b
a
b
c
a
a
a
b
b
c
b
c
c
a
c
b
a
b
a
c
b
c
a
b
a
c
c
b
c
a
b
c
b
a
c
c
b
a
b
c
b
a
a
Proof We make use of Theorem 5.4.12. Let x be a k-automatic sequence obtained
by feeding a DFAO M with base k-expansions, i.e., for all n ≥0, x(n) = M ·
repk(n). We ﬁrst assume that there is no extra coding involved. Words of {0, . . . , k−
1}∗act on the set Q of states of M. For all words u ∈{0, . . . , k −1}∗, we have a
map
fu : Q →Q,
q →q · u .
The set of such maps endowed with composition is referred to as the transition
monoid of M. It is ﬁnite because the number of such maps is bounded by #Q#Q.
Let u ∈{0, . . ., k −1}∗. We observe that the subsequence (x(k|u|n + valk(u)))n≥0
is obtained as follows
x(k|u|n + valk(u)) = M · (repk(n)u) = fu(M · repk(n)).
Hence the number of subsequences in the k-kernel is equal to the cardinality of
the transition monoid of M (assuming that every state of M can be reached from
the initial state5). If there is an extra coding to be applied to f ω(a), since we are
considering a mapping onto a smaller alphabet, the number of distinct subsequences
decreases.
⊓⊔
How to compute the transition monoid of a DFA? Assume that the set of states
Q is {q1, . . . , qn}. Then starting with the n-tuple (q1, . . . , qn), we compute (q1 ·
a, . . ., qn · a) for all letters a. We list the pairwise distinct and newly created n-
tuples. For each such tuple, we iterate the process and build a labeled graph where
transitions are of the form
(r1, . . . , rn)
a
−→(r1 · a, . . . , rn · a).
This algorithm explores all the n-tuples of the form (q1 · w, . . . , qn · w) where w is
a word. Paths from (q1, . . . , qn), in this graph, correspond to the possible maps fu.
In particular, if two words u and v lead to same vertex, then fu = fv. We apply this
algorithm to the automaton depicted in Fig. 5.2 and start with the 3-tuple (a, b, c)
(Table 5.4). More details can, for instance, be found in [58].
5This means that every letter of the alphabet appears at least once in x.

5
From Combinatorial Games to Shape-Symmetric Morphisms
245
Example 5.4.20 (Thue–Morse Word) The Thue–Morse word is the ﬁxed point
f ω(a) of the morphism f : a →ab, b →ba,
abbabaabbaababbabaababbaabbabaab· · ·
Its 2-kernel is ﬁnite and contains 2 elements. This word is ubiquitous in COW [7].
For instance, it is well-known that the Thue–Morse word is overlap-free: it does not
contain any factor of the form cvcvc where c is a letter and v belongs to {a, b}∗. In
particular, the Thue–Morse word is not ultimately periodic.
5.4.4
Changing the Base
Example 5.3.17 shows that the sequence (G(n))n≥0 (when removing 1, 2 or 4
tokens) is periodic: (0, 1, 2)ω. It is not difﬁcult to devise a k-automatic sequence
equal to (0, 1, 2)ω. For instance, assume that k = 2. We consider the following
2-uniform morphism and coding
f : a →ab, b →cd, c →ef, d →ab, e →cd, f →ef
g : a, d →0, b, e →1, c, f →2.
More generally, every ultimately periodic word uvω, v ̸= ε, is k-automatic for all
k ≥2.
What could happen when computing the 3-kernel of the Thue–Morse word? It
turns out that this 3-kernel is inﬁnite. This can be obtained from a famous result on
numeration systems.
Theorem 5.4.21 (Cobham’s Theorem [30]) Let k, ℓ≥2 be two multiplicatively
independent integers, i.e., log k/ log ℓis irrational. If a sequence is both k-automatic
and ℓ-automatic, then it is ultimately periodic.
Proposition 5.4.22 Let k ≥2 and n ≥1 be integers. A sequence is k-automatic if
and only if it is kn-automatic.
Cobham’s theorem can be considered as difﬁcult. No immediate proof seems6 to
be known [69, 76]. On the other hand, Proposition 5.4.22 is an easy exercise. Each
digit in base kn corresponds to n digits in base k and the image by a morphism
preserves the regularity of languages.
Cobham’s theorem has been extended to various settings (multidimensional and
logical frameworks [17], non-constant length morphism, ...). In the non-constant
6When writing this chapter, a paper by Thijmen J. P. Krebs appeared on arXiv [55].

246
M. Rigo
length setting, what replaces the base k is the Perron–Frobenius eigenvalue of the
matrix associated with the morphism. See the theorem of Cobham–Durand [38].
5.4.5
k-Regular Sequences
We have seen that k-automatic sequences take values in an alphabet. Nevertheless,
when studying unbounded sequences (which is the case of most Grundy functions)
we need to replace k-automaticity with a more general concept.
Regular sequences (again the usual terminology could be misleading) can
be studied in a more general algebraic setting than the one considered here.
Since, we are exclusively dealing with sequences taking integer entries, e.g.
(GNIM(m, n))m,n≥0, we will limit ourselves a bit and have a simple presentation
with Deﬁnition 5.4.23. In this section, we still consider the case of inﬁnite words.
The multidimensional setting will be presented later on.
Deﬁnition 5.4.23 The sequence x ∈ZN is k-regular, if the Z-module generated by
Kerk(x) is ﬁnitely generated, i.e., there exists t1, . . . , tℓ∈ZN such that
⟨Kerk(x)⟩= ⟨t1, . . . , tℓ⟩.
(5.4)
The ring Z is embedded in ﬁelds such as Q, R or C. Thus sequences we are
considering can be seen as elements of QN which is a Q-vector space (instead
of considering a Z-module). So another way to describe k-regularity is to say
that the orbit of x under the action of compositions of the operators (5.2) of k-
decimation ∂k,r remains in a ﬁnite dimensional vector space.
Remark 5.4.24 The original deﬁnition given by Allouche and Shallit [6] is the
following one. Let R be a ring containing a commutative Noetherian ring R′, i.e.,
every ideal of R′ is ﬁnitely generated. A sequence x in RN is (R′,k)-regular, if
there exists t1, . . . , tℓ∈RN such that every sequence in Kerk(x) is an R′-linear
combination of t1, . . . , tℓ.
Observe that if x is (R′,k)-regular, then ⟨Kerk(x)⟩is a submodule of a ﬁnitely
generated R′-module. In general, this does not imply that the submodule itself
is ﬁnitely generated. This means that we only have the inclusion ⟨Kerk(x)⟩⊂
⟨t1, . . . , tℓ⟩instead of equality in (5.4). Nevertheless, since R′ is assumed to be
Noetherian, one can show (using more algebra) that every submodule of a ﬁnitely
generated R′-module is ﬁnitely generated and thus ⟨Kerk(x)⟩is ﬁnitely generated.
From that (up to taking other generators), we can assume equality in (5.4). Dealing
with integer sequences, we can take R = R′ = Z.
Similarly to recognizable formal series, with every k-regular sequence
(s(n))n≥0 ∈ZN is associated a linear representation (λ, μ, ν). There exist a
positive integer r, a row vector λ ∈Z1×r and a column vector ν ∈Zr×1, a

5
From Combinatorial Games to Shape-Symmetric Morphisms
247
matrix-valued morphism μ : {0, . . ., k −1} →Zr×r such that
s(n) = λ μ(c0 · · · cℓ) ν = λ μ(c0) · · · μ(cℓ) ν
for all cℓ, . . . , c0 ∈{0, . . ., k −1}∗such that valk(cℓ· · · c0) = ℓ
i=0 ci ki = n.
The converse also holds: if there exists a linear representation associated with the
canonical k-ary expansion of integers (one has to take into account the technicality
of representations starting with leading zeroes), then the sequence is k-regular.
See, for instance, [8, Theorem 16.2.3]. As a corollary, the nth term of a k-regular
sequence can be computed with ⌊logk(n)⌋matrix multiplications.
Remark 5.4.25 These matrix multiplications are a natural extension of those
encountered in Remark 5.4.15. Instead of a classical DFA, the linear representation
can be seen as a weighted automaton with r states.
Proof (Existence of a Linear Representation) Let s = (s(n))n≥0 ∈ZN be a k-
regular sequence. By deﬁnition, there exists a ﬁnite number of sequences t1, . . . , tℓ
such that ⟨Kerk(s)⟩= ⟨t1, . . . , tℓ⟩. In particular, each tj is a Z-linear combination
of elements in the k-kernel of s. We have ﬁnitely many tj’s, so t1, . . . , tℓare Z-
linear combinations of ﬁnitely many elements in Kerk(s). Thus we can assume that
⟨Kerk(s)⟩is generated by ﬁnitely many elements from Kerk(s) itself. Without loss
of generality, we assume from now on that t1, . . . , tℓbelong to Kerk(s).
From (5.3), for all r ∈{0, . . . , k −1} and all i ∈{1, . . ., ℓ}, ∂k,r(ti) is a sequence
in Kerk(s) and thus, there exist coefﬁcients (Ar)1,i, . . . , (Ar)ℓ,i such that
∂k,r(ti) =
ℓ

j=1
(Ar)j,i tj .
Notice that Ar is an ℓ× ℓmatrix. Roughly, if we were in a vector space setting, this
means that the matrices Ar represent the linear operators ∂k,r in the basis t1, . . . , tℓ.
Let p ≥0 be an integer. Notice that if repk(p) = rm · · · r0, then s(p) is the ﬁrst
term, i.e., corresponding to the index n = 0, of the sequence
(s(bm+1n + p))n≥0 = ∂k,r0 ◦· · · ◦∂k,rm

(s(n))n≥0
	
.
We will use the fact that ∂k,r is linear, i.e., if α, β are coefﬁcients and v, w are two
sequences, then ∂k,r(αv + βw) = α∂k,r(v) + β∂k,r(w). It is easy to see that
∂k,r0 ◦· · · ◦∂k,rm (ti) =
ℓ

j=1
(Ar0 · · · · · Arm)j,i tj .

248
M. Rigo
If we have the following decomposition of s (in a vector space setting, we would
have a unique decomposition of s in the basis t1, . . . , tℓ)
s =
ℓ

i=1
σi ti
then, by linearity,
(s(bm+1n + p))n≥0 =
ℓ

i=1
σi
ℓ

j=1
(Ar0 · · · · · Arm)j,i (tj(n))n≥0 =
ℓ

j=1
τj (tj(n))n≥0
where
⎛
⎜⎝
τ1
...
τℓ
⎞
⎟⎠= Ar0 · · · · · Arm
⎛
⎜⎝
σ1
...
σℓ
⎞
⎟⎠.
Consequently, s(p) is obtained as
s(p) =
ℓ

i=1
τi ti(0) =

t1(0) · · · tℓ(0)
	
6
78
9
=:λ
Ar0 · · · · · Arm
⎛
⎜⎝
σ1
...
σℓ
⎞
⎟⎠
6 78 9
=:ν
and μ(c) = Ac.
⊓⊔
Example 5.4.26 For the sum-of-digits function given by
s2(n) =
ℓ

i=0
ni
whenever rep2(n) = nℓ· · · n0,
the sequence s = (s2(n))n≥0 has a (base-2) linear representation given by
λ =

0 1
	
, μ(i) =
1 0
i 1

, ν =
1
0

,
i = 0, 1.
We let 1 denote the constant sequence (1)n≥0. It does not belong to the 2-kernel of
s but it belongs to the Z-module generated by it because it is equal to ∂2,1(s) −s.
Nevertheless, it is enough to see that ∂2,0(1) = ∂2,1(1) = 1 and take s and 1 as
generators to proceed as in the proof above. From the following relations, we deduce
the two columns of the matrix μ(0)
∂2,0(s) = 1 · s + 0 · 1,
∂2,0(1) = 0 · s + 1 · 1

5
From Combinatorial Games to Shape-Symmetric Morphisms
249
and, for μ(1),
∂2,1(s) = 1 · s + 1 · 1,
∂2,1(1) = 0 · s + 1 · 1 .
The vector λ is given by s2(0) = 0 and 1(0) = 1. The vector ν is obtained from
s = 1 · s + 0 · 1. To compute s2(19), observe that rep2(19) = 10011. Thus we
compute

0 1
	
μ(1)μ(1)μ(0)μ(0)μ(1)
1
0

= 3 .
Remark 5.4.27 In [9, Section 6], a practical procedure to guess relations a possibly
k-regular sequence will satisfy is described. Consider a sequence (s(n))n≥0. The
idea is to construct a matrix in which the rows represent truncated versions of
elements of the k-kernel of (s(n))n≥0, together with row reduction. Start with a
matrix having a single row, let us say corresponding to the ﬁrst m elements of the
sequence. Then, in view of the ﬁrst paragraph of the proof providing the existence of
a linear representation, repeatedly add subsequences of the form (s(kℓn+r))n≥0 not
linearly dependent of the previous stored sequences. From this, you have candidate
relations that remain to be proved.
Remark 5.4.28 There is an intermediate notion of a k-synchronized sequence s
where a DFA, in the sense discussed in Sect. 5.6, accepts pairs of base-k expansions
corresponding to (n, s(n)). See [18].
5.5
Characterizing P-Position of Wythoff’s Game
in Polynomial Time
First let us explain what we mean by “the Fibonacci word is coding the P-
positions of Wythoff’s game”. From that result, we will introduce Zeckendorf [88]
(or Fibonacci) numeration system and reobtain a well-known result by Fraenkel,
Theorem 5.5.20, characterizing P-positions of Wythoff’s game from Fibonacci
expansions of integers. In this section, we will deal with two copies of the Fibonacci
word! One is deﬁned as a map whose domain is N and the other one has domain
N>0, we will try to avoid any confusion using notation f and f′ respectively. The
alphabet of f and f′ can be either {a, b} or, {1, 2}. It does not really matter.
Deﬁnition 5.5.1 (Fibonacci Word) The Fibonacci word over {a, b}
f = abaababaabaababaababaaba· · ·
is the unique ﬁxed point of the morphism F : a →ab, b →a.

250
M. Rigo
A (homogeneous) Beatty sequence is just the sequence of integer part of positive
multiples of an irrational number. In our setting, Theorem 5.3.14 provides us with
a pair of complementary Beatty sequences because 1
ϕ +
1
ϕ2 = 1. Thus (⌊nϕ⌋)n≥1
and (⌊nϕ2⌋)n≥1 make a partition of N>0. This is a consequence of Beatty theorem
(sometimes known as Rayleigh theorem). Regarding this result, papers of interest
are [41, 68].
Theorem 5.5.2 (Beatty Theorem) Let α, β > 1 be irrational numbers such that
1/α + 1/β = 1. Then (⌊nα⌋)n≥1 and (⌊nβ⌋)n≥1 make a partition of N>0.
There are various characterizations of Sturmian words (the Fibonacci word is
Sturmian). One of those is given in terms of irrational mechanical words, i.e., the
sequence of ﬁrst differences of a Beatty sequence. See, for details, [63, Sec. 2.1.2].
Also see [40]. Here we start indexing inﬁnite words with 1, because of Beatty
theorem and the ﬁrst non-zero P-position of Wythoff is (1, 2). In particular, using
those mechanical words, one can show that the nth letter in the Fibonacci word
f′ = f1f2f3 · · · = 212212122122 · · ·
(5.5)
over {1, 2} can be obtained as
fn = ⌊(n + 1) ϕ⌋−⌊n ϕ⌋,
∀n ≥1.
Wythoff’s result, Theorem 5.3.14, can therefore be restated as follows.
Proposition 5.5.3 The nth P-position

⌊nϕ⌋, ⌊nϕ2⌋
	
of Wythoff’s game is given by
the indices (starting with 1) of the nth a and nth b in the Fibonacci word f′.
Proof Since fn = ⌊(n + 1) ϕ⌋−⌊n ϕ⌋, if fn = 1, this means ⌊n ϕ⌋and ⌊(n + 1) ϕ⌋
are consecutive positive integers. If fn = 2, this means that there exists m such
that ⌊nϕ⌋, ⌊mϕ2⌋and ⌊(n+1) ϕ⌋are three consecutive integers. Indeed, because of
Beatty theorem, the gap between two consecutive multiples of ϕ must be ﬁlled with
a multiple of ϕ2.
Apply the morphism 1 →a and 2 →ab to f′ = 21221 · · ·. We get exactly
the Fibonacci word over {a, b} because the Fibonacci word is the ﬁxed point of the
morphism F : a →ab, b →a and we may replace 1, 2 by b and a respectively.
The effect of 2 →ab is to insert an extra symbol b between two a’s (the images of
1 and 2 both start with a). Thus the multiples ⌊nϕ⌋are exactly given by the indices
of the a’s in the Fibonacci word f′. The remaining indices (ﬁlling the partition of
N>0) corresponding to b’s are thus given by the multiples ⌊nϕ2⌋.
⊓⊔

5
From Combinatorial Games to Shape-Symmetric Morphisms
251
5.5.1
From Morphic Words to Automatic Words
Since the Fibonacci morphism F is not of constant length (it is not uniform in
the sense of Deﬁnition 5.4.5), it is time to extend Deﬁnition 5.4.8. Note that the
automaton deﬁned below is not necessarily complete: the transition function could
be partial.
Deﬁnition 5.5.4 We associate with a morphism f : A∗→A∗and a letter a ∈A, a
DFA
Af = (A, a, {0, . . ., max
b∈A |f (b)| −1}, δf , A)
where δf (b, i) = wb,i if f (b) = wb,0 · · · wb,|f (b)|−1. We assume that the letter a is
clear from the context, if it is not the case, one can use a notation such as Af,a.
Deﬁnition 5.5.5 (Genealogical Order) Let (A, <) be an ordered alphabet. We
can order A∗using the genealogical ordering (also called radix order). Words are
ﬁrst ordered by increasing length and for words of the same length, one uses the
lexicographic ordering induced by the order < on A. The order is denoted by <gen.
Compared with the lexicographic order, the genealogical order is a well-order,
that is, every non-empty subset has a minimal element. For instance, the set a+b =
{anb | n > 0} has no minimal element for the lexicographic order.
Here is the natural generalization of Proposition 5.4.10, base-k expansions are
replaced with words accepted by Af . We will proceed to the proof of this result at
the end of this section.
Theorem 5.5.6 Let (A, <) be an ordered alphabet. Let x ∈AN be an inﬁnite
word, ﬁxed point f ω(a) of a morphism f : A∗→A∗prolongable on a. Consider
the language Lf of words accepted by Af except those starting with 0. If Lf is
genealogically ordered: Lf = {w0 <gen w1 <gen w2 <gen · · · }, then the nth
symbol of x, n ≥0, is the state Af · wn.
Remark 5.5.7 Adding an extra coding and considering the word g(f ω(a)) does
not lead to any difﬁculty. The DFA is replaced with a DFAO where the output
function is simply g. Thus, the nth symbol of g(f ω(a)) is given by g(Af · wn).
See Example 5.5.10.
Let us apply this theorem to the Fibonacci word f. The corresponding automaton
is depicted in Fig. 5.3. The language accepted by this DFA (excluding words
Fig. 5.3 DFA associated
with a →ab, b →a
1
0
0

252
M. Rigo
starting with 0) is 1{0, 01}∗∪{ε}. This is the set of words over {0, 1} avoiding
the factor 11. This is exactly the language of the Fibonacci numeration: the greedy
expansions of the non-negativeintegers in this positional numeration system. Details
on numeration systems are presented in the next section.
Remark 5.5.8 For a morphism f of constant length k, the language Lf given by
Theorem 5.5.6 is {1, . . ., k −1}{0, . . ., k −1}∗∪{ε} which is exactly the language
of the base-k numeration system. For the Fibonacci morphism F, the corresponding
language is associated with the so-called Fibonacci numeration system.
Nevertheless, the language Lf given by Theorem 5.5.6 is not always related
to a “well-known” numeration system. The term “well-known” means associated
with a positional numeration system deﬁned in Sect. 5.5.2. In the general situation:
genealogically ordering a regular language leads to abstract numeration systems
discussed in Sect. 5.7.1.
Prior to the proof of Theorem 5.5.6, we need the following lemma. If x =
x0x1x2 · · · is an inﬁnite word, then the shifted word σ(x) is the word x1x2x3 · · · .
Lemma 5.5.9 Let A = {a1 < · · · < an} be a totally ordered alphabet. Let z ̸∈Q.
Let A = (Q, q0, A, δA, F) be a DFA where δA : Q × A →Q is (in general) a
partial7 function. Deﬁne the morphism ψA : (Q∪{z})∗→(Q∪{z})∗by ψA(z) =
z q0 and, for all q ∈Q,
ψA(q) = δA(q, a1) · · · δA(q, an).
In this latter expression if δA(q, ai) is not deﬁned for some i, then it is replaced by
ε. Let L be the regular language accepted by (Q, q0, A, δ, Q) where all states of
A are ﬁnal. Then the shifted word σ(ψω
A(z)) is the sequence (xn)n∈N of the states
reached in A by the words of L in genealogical order, i.e., for all n ∈N,
xn = A · wn
where wn is the (n + 1)th word of the genealogically ordered language L.
Proof By deﬁnition of ψ, ﬁrst observe that we have the following factorization,
see (5.1):
ψω
A(z) = z x0 x1 x2 · · · = z q0 ψA(q0) ψ2
A(q0) · · ·
and x0 = q0 = δA(q0, ε). Then by the deﬁnition of ψA, if xn = δA(q0, wn), n ≥0,
then the factor
un = ψA(xn) = δA(q0, wna1) · · · δA(q0, wnan)
(5.6)
7Compared with complete functions in Deﬁnition 5.4.8.

5
From Combinatorial Games to Shape-Symmetric Morphisms
253
appears in ψω
A(z) with the usual convention of replacing the undeﬁned transitions
with ε. Indeed, zx0x1x2 · · · is a ﬁxed point of ψA and each xn produces a factor
ψA(xn) = un appearing later on in the inﬁnite word, similar to the situation depicted
in Fig. 5.1. Moreover this factor is preceded by
δA(q0, wn−1a1) · · · δA(q0, wn−1an)
and followed by
δA(q0, wn+1a1) · · · δA(q0, wn+1an) .
It is therefore clear that we get all states reached from the initial state when
considering the labels of all the paths in A in increasing genealogical order.
⊓⊔
Proof of Theorem 5.5.6 From Cobham’s theorem on morphic words (The-
orem 5.4.3), we assume that f
is non-erasing. We consider the alphabet
C
= {0, . . . , maxb∈A |f (b)| −1} and the DFA Af
= (A, a, C, δ, A) from
Deﬁnition 5.5.4 having a as initial state.
Let L ⊆C∗be the language recognized by Af . Since f (a) = au for some non-
empty word u, it is clear that if w ∈L then 0w ∈L. Indeed by deﬁnition of Af , its
initial state a has a loop labeled by 0, the ﬁrst letter in C. If we apply Lemma 5.5.9
to this automaton Af , we obtain a morphism ψAf generating the sequence of the
states reached by the words of L. This morphism is deﬁned as follows. Let z ̸∈A.
We have ψAf (z) = za and, for all b ∈A, ψAf (b) = f (b).
The main point leading to the conclusion is to compare ψω
Af (z) and f ω(a). Since
f (a) = au, using (5.1) we have the following factorizations
f ω(a) = au f (u) f 2(u) f 3(u) · · ·
and
ψω
Af (z) = za a u f (a) f (u) f 2(a) f 2(u) f 3(a) f 3(u) · · · .
If we erase the factors z, a, f (a), f 2(a), . . . occurring in that order in the above
factorization of ψω
Af (z), we recover f ω(a). Recall that ψω
Af (z) is, except for
z, the sequence of states reached in Af by considering all the possible paths in
genealogical order. The second occurrence of a in ψω
Af (z) is the state reached in
Af when reading 0 ∈L. By the property (5.6) of ψAf , the factor f n(a) in the
above factorization corresponds to the states reached in Af when reading the words
in L of length n + 1 starting with 0. Consequently, when giving to Af the words
of Lf := L \ 0C∗in increasing genealogical order, we build exactly the sequence
f ω(a) = (yn)n≥0, i.e., if w0 <gen w1 <gen w2 <gen · · · are the words of Lf in
genealogical order, then yn = A · wn.
⊓⊔

254
M. Rigo
Example 5.5.10 Consider the alphabets A = {a, b, c}, B
= {d, e} and the
morphisms
f : A∗→A∗,
⎧
⎨
⎩
a →abc
b →bc
c →aac
and
g : A∗→B∗,

a →d
b, c →e.
The corresponding automaton Af is given in Fig. 5.4 and the output function is
represented on the outgoing arrows.
The inﬁnite word generated by the morphism f is f ω(a) = (xn)n≥0
=
abcbcaacbcaacabcabcaac· · · .
Corollary 5.5.11 Let (A, <) be an ordered alphabet. Let x ∈AN be an inﬁnite
word, ﬁxed point f ω(a) of a morphism f : A∗→A∗prolongable on a. Consider
the language Lf = {w0 <gen w1 <gen w2 <gen · · · } of words accepted by Af
except those starting with 0.
Let n ≥0. If Af · wn = b and |f (b)| = rb, then the factor f (b) occurs in x in
position corresponding to wn0, . . . , wn(rb −1).
In Example 5.5.10, the ﬁfth b occurring in f ω(a) in position 17 corresponds to
the word 211 in Lf . Deleting the last one gives the word 21 which corresponds to the
third a occurring in f ω(a). In particular, this symbol a gives the factor f (a) = abc
corresponding to the words 210, 211, 212. Finally, the ﬁrst c corresponds to the
word 2, so the second and third a occur in f (c).
d
e
e
0
0
2
1
2
1
0, 1
w0 = ε
w8 = 100
w16 = 210
w1 = 1
w9 = 101
w17 = 211
w2 = 2
w10 = 110
w18 = 212
w3 = 10
w11 = 111
w19 = 220
w4 = 11
w12 = 112
w20 = 221
w5 = 20
w13 = 200
w21 = 222
w6 = 21
w14 = 201
w7 = 22
w15 = 202
Fig. 5.4 The automaton Af associated with a →abc, b →bc, c →aac and the ﬁrst few
words in the associated language Lf

5
From Combinatorial Games to Shape-Symmetric Morphisms
255
5.5.2
Positional Numeration Systems
A numeration system is a sequence U = (Un)n≥0 of integers such that U is
increasing, U0 = 1 and that the set {Ui+1/Ui | i ≥0} is bounded. This latter
condition ensures that there exists an alphabet of digits used to represent integers. If
w = wℓ· · · w0 is a word over an alphabet A ⊂Z then the numerical value of w is
valU(w) =
ℓ

i=0
wi Ui.
Using a greedy algorithm [43], every integer n has a unique (normal) U-represen-
tation or U-expansion repU(n) = wℓ· · · w0 which is a ﬁnite word over a minimal
alphabet called the canonical alphabet of U and denoted by AU. The normal U-
representation satisﬁes
valU(repU(n)) = n and for all i ∈{0, . . . , ℓ−1}, valU(wi · · · w0) < Ui+1.
Remark 5.5.12 We call these systems positional because the position of a digit
within an expansion is relevant. A digit in ith position (i = 0 corresponding to
the rightmost digit) is multiplied by Ui to get the numerical value of the expansion.
For some general references on numeration systems, see Frougny’s chapter in
[63] or [72, 73]. The greediness of the expansion has the following consequence.
Proposition 5.5.13 (Order Preserving Map) Let m, n be two non-negative inte-
gers. We have m < n if and only if repU(m) is genealogically less than repU(n).
Deﬁnition 5.5.14 Let B ⊂Z be an alphabet. If w ∈B∗is such that valU(w) ≥0,
then the function that maps w to repU(valU(w)) is called normalization.
Deﬁnition 5.5.15 A numeration system U is said to be linear if there exist k ∈
N \ {0}, d1, . . . , dk ∈Z, dk ̸= 0, such that, for all n ≥k, Un = d1Un−1 + · · · +
dkUn−k. The polynomial PU(X) = Xk −d1Xk−1 −· · · −dk−1X −dk is called the
characteristic polynomial of U.
Deﬁnition 5.5.16 Recall that a Pisot-(Vijayaraghavan) number is an algebraic
integer β > 1 whose Galois conjugates have modulus less than 1. We say that
U = (Un)n≥0 is a Pisot numeration system if the numeration system U is linear and
PU(X) is the minimal polynomial of a Pisot number β. Integer8 base numeration
systems are particular cases of Pisot systems. For instance, see [16] where it is
shown that most properties related to integer base systems, can be extended to Pisot
systems. For a Pisot system β, there exists some c > 0 such that |Un −c βn| →0,
as n tends to inﬁnity.
8Integer are the only rational numbers that are Pisot numbers.

256
M. Rigo
Example 5.5.17 With the Fibonacci sequence F = 1, 2, 3, 5, 8, 13, . . ., we have a
Pisot numeration system associated with the Golden ratio. Thanks to the greediness
of the expansions, we have repF (N) = 1{0, 01}∗∪{ε}.
Thanks to the observation stated in Proposition 5.5.13, we can directly reformu-
late Theorem 5.5.6.
Corollary 5.5.18 Let (A, <) be an ordered alphabet. Let w ∈AN be an inﬁnite
word, ﬁxed point f ω(a) of a morphism f : A∗→A∗prolongable on a. Let Lf be
the language of words accepted by Af except those starting with 0. If there exists a
numeration system U such that repU(N) = Lf , then the nth symbol of w, n ≥0, is
Af · repU(n).
Remark 5.5.19 The above corollary implies that if the state a ∈A is reached in Af
when reading a word w from the initial state, then the symbol with index valU(w)
occurring in the ﬁxed point w is a. Moreover, the ordered outgoing transitions from
state a with respective labels 0, . . . , |f (a)| −1 are such that f (a) = (a · 0) · · · (a ·
(|f (a)| −1)).
Let us apply this result to the Fibonacci word f = f0f1f2 · · · = abaab · · ·
starting with index 0. It is important to note that in Theorem 5.5.6 and the above
corollary, indices start with 0 (which is not the case in Proposition 5.5.3 and this
difference has to be dealt with). Applying the above corollary with the DFA depicted
in Fig. 5.3, we get that
•
fj = a if and only if repF(j) ends with 0;
•
fj = b if and only if repF(j) ends with 1.
As for k-automatic sequences and Lemma 5.4.7, we can still “keep track of the
past”: since F : a →ab, b →a, we have
fj = a for some repF (j) = u if and only if fvalF (u0) = a and fvalF (u1) = b
and similarly,
fj = b for some repF(j) = v if and only if fvalF (v0) = a and fvalF (v1) = a.
In particular, the nth symbol b occurring in f belongs to the image by the morphism
F of the nth a in f. Otherwise stated, the nth a and the nth b in the Fibonacci word
occur at indices (we recall, starting with 0) of the form:
valF (u0) and valF (u01) with u ∈repF (N) .
(5.7)
If repF (j)
=
ci · · · c2c1c0, then fj belongs to F(xvalF (ci···c1)). The symbol
xvalF (ci···c1) appears itself in the image by the morphism F of the letter xvalF (ci···c2);
xj appears in F2(xvalF (ci···c2)), and so on and so forth. For k-automatic sequences,
we were simply using DIV k iteratively, here the result is similar: at each step, we
remove the last digit of the F-representation of j.

5
From Combinatorial Games to Shape-Symmetric Morphisms
257
5.5.3
Syntactic Characterization of P-Positions of Wythoff’s
Game
We can now put together all the results and material of this section to obtain the
following result. It provides us with a polynomial time algorithm to decide whether
or not a pair is a P-position. Note that (x, x) is a N-position because one can
directly play to (0, 0).
Theorem 5.5.20 (Fraenkel [42]) A pair (x, y), with x < y, is a P-position of
Wythoff’s game if and only if repF (x) ends with an even number of zeroes and
repF (y) = repF (x)0.
Proof From Proposition 5.5.3, we know that a pair (x, y), with 0 < x < y, is a
P-position if and only if there exists n such that x is the index (starting with 1) of
the nth a (resp. nth b) occurring in the Fibonacci word f′.
We now make use of Corollary 5.5.18 and observation (5.7): (x, y) is a P-
position if and only if there exists a (valid) F-representation u such that
repF (x−1), repF (y−1)	 = (u0, u01).
(5.8)
We subtract 1 because Corollary 5.5.18 deals with the word f whose indices start
with 0 and not 1 as in f′. From (5.8) what can be said about the form of repF (x) and
repF (y)? First, we have
repF(x) = repF (valF (u0) + 1) and repF(y) = repF (valF (u01) + 1)
•
First case:9 Assume that u is of the form u′0. We easily get valid F-
representations:
repF (x) = repF (valF (u′00) + 1) = u′01 ends with no zero,
repF (y) = repF (valF (u′001) + 1) = u′010 previous word shifted by zero.
•
Second case: Assume that u is of the form u′1 (where u′ ends with 0 to have a
valid F-representation). We get
repF(x) = repF (valF (u′10) + 1) = repF (valF (u′11)),
repF (y) = repF(valF (u′101) + 1) = repF (valF (u′110)).
9The ﬁrst few values may be checked by hand.

258
M. Rigo
Fig. 5.5 Transducer
computing the successor
function from right to left
(Fibonacci system)
s
r
q
p
1
1 0
0 01
0 0, 1 1
10
1
0 0
0
This means that we need to normalize u′11 and u′110 (in the sense of Def-
inition 5.5.14) or equivalently, to compute the successor of u′10 and u′101.
Hopefully, a transducer computing the successor function from right to left, i.e.,
least signiﬁcant digit ﬁrst, for the Fibonacci system is well-known. See [47].
This transducer is depicted in Fig. 5.5. If we feed the transducer with a valid F-
representation u′10, it is either of the form w100(10)n10 or, 10(10)n10, for some
n ≥0 (because we are considering large enough numbers). A computation for
the ﬁrst form is depicted below:
s (w1
w1)
←−s ( 0
01)
←−r
:
(0
0)
←−q (1
0)
←−r
;n (0
0)
←−q (1
0)
←−r (0
.)
←−p :from right to left.
So in the ﬁrst situation, the successor of u′10 is
w10(01)n0
6
78
9
u′
10 →w101(00)n00
ends with 2n + 2 zeroes, n ≥0
and for the successor of u′101, we get
w10(01)n0
6
78
9
u′
101 →w101(00)n000
the previous word shifted by one zero.
In the second situation, we have for the successor of u′10
1(01)n0
6 78 9
u′
10 →100(00)n00
2n + 4 zeroes, n ≥0
and the successor of u′101
1(01)n0
6 78 9
u′
101 →100(00)n000
the previous word shifted by one zero.
Putting together the different cases gives the expected result.
⊓⊔
To conclude with this section, let us present the bidimensional word PW coding
the P-positions of Wythoff’s game. We have PW(m, n) = 1 if and only if (m, n)

5
From Combinatorial Games to Shape-Symmetric Morphisms
259
Table 5.5 The bidimensional word w(m, n) coding P-positions of Wythoff
10 0 0 0 0 0 0 1 0 0 0
0
9
0 0 0 0 0 0 0 0 0 0
0
8
0 0 0 0 0 0 0 0 0 0
0
7
0 0 0 0 1 0 0 0 0 0
0
6
0 0 0 0 0 0 0 0 0 0
1
5
0 0 0 1 0 0 0 0 0 0
0
4
0 0 0 0 0 0 0 1 0 0
0
3
0 0 0 0 0 1 0 0 0 0
0
2
0 1 0 0 0 0 0 0 0 0
0
1
0 0 1 0 0 0 0 0 0 0
0
0
1 0 0 0 0 0 0 0 0 0
0
0 1 2 3 4 5 6 7 8 9 10
is a P-position. Thanks to Proposition 5.3.18, it is a projection of (G(m, n))m,n≥0
given in Table 5.3.
We ask the same kind of (not yet answered) questions as before for the tables
(GNIM(m, n))m,n≥0 or (GW (m, n))m,n≥0. We would like to have insight about
the structure of the table, ﬁnd some patterns, etc. The main difference between
Table 5.5 and (GNIM(m, n))m,n≥0 or (GW (m, n))m,n≥0 is that we are with PW over
an alphabet {0, 1}.
In Sect. 5.6.1, we prove that (GNIM(m, n))m,n≥0 is 2-regular. It is well-known
that the mapping on a ﬁnite alphabet of a 2-regular word is 2-automatic [6]. In
Sect. 5.7, we prove that (PW(m, n))m,n≥0 is a morphic shape-symmetric word.
5.6
Extension to a Multidimensional Setting
This extension is pretty straightforward. The only technical part is that one has to
pad shorter expansions to deal with words of the same length. In the ﬁrst sections
of this chapter, we have considered DFA over alphabets such as {0, . . ., k −1}. But
there is no objection to consider other ﬁnite sets as alphabets such as
{0, 1}2 = {0, 1} × {0, 1} =
0
0

,
0
1

,
1
0

,
1
1

.
(5.9)
With this alphabet, the corresponding languages are subsets of ({0, 1}2)∗. We make
no distinction between pairs written horizontally or vertically, but it seems more
natural to write them as column vectors because that is what the machine should read
simultaneously. Examples of DFA over ({0, 1}2)∗are given in Figs. 5.8 and 5.20.
There is no objection to take d-tuples instead of pairs and also, we can have
alphabets with more than two symbols. A DFA over ({0, 1}3)∗is given in Fig. 5.9.

260
M. Rigo
Deﬁnition 5.6.1 Let d ≥1, k ≥2 be integers. The base-k expansion of a d-tuple
of non-negative integers is deﬁned by
repk : Nd →

{0, . . . , k −1}d∗
,
(n1, . . . , nd) →
⎛
⎜⎝
0ℓ−| repk(n1)| repk(n1)
...
0ℓ−| repk(nd)| repk(nd)
⎞
⎟⎠
where ℓ= max{| repk(n1)|, . . . , | repk(nd)|}.
Let d ≥1, k ≥2 be integers. A map f : A →Akd where the image of a letter in
A is a d-dimensional cube of size k, can be extended to a k-uniform morphism over
the set of d-dimensional cubes. The image of a cube of size ℓis a cube of size k · ℓ.
The morphism is prolongable on the letter a ∈A if the “lower-left” corner of f (a)
is equal to a.
Example 5.6.2 (Pascal Triangle mod 2) Consider the morphism
ψ : 0 →0 0
0 0 ,
1 →1 0
1 1 .
Iterating n times the morphism ψ from 1 gives (explanations will follow) the
ﬁrst 2n rows of the binomial coefﬁcients modulo 2 (up to a rotation of 3π/4). The
binomial coefﬁcient
m
n
	
(mod 2) corresponds to the point of coordinates (m−n, n)
in the picture on the left of Fig. 5.6. It is important to keep in mind this “change
of variables”. Note that the sequence of normalized sets with ratio 1/2n where
1’s (resp. 0’s) are full (resp. empty) unit squares, is a sequence of compact sets
converging, for the Hausdorff distance, to the Sierpi´nski gasket [3, 11]. On fractal
patterns of the Pascal triangle and generalizations, see, e.g., [4, 5, 50, 61].
Lemma 5.4.7 and thus Theorem 5.4.12 are translated verbatim.
Lemma 5.6.3 Let f be a k-uniform d-dimensional morphism prolongable on a
and x = f ω(a) = (x(n1, . . . , nd))n1,...,nd≥0. Let (j1, . . . , jd) such that kmi ≤ji <
kmi+1, for some mi ≥0, for all i. Then ji = kqi + ri with kmi−1 ≤qi < kmi and
0 ≤ri < k and the symbol x(j1,...,jd) occurs in the d-cube of size k f (x(q1,...,qd)) in
position (r1, . . . , rd).
Fig. 5.6 Third iterate of ψ
and the corresponding Pascal
triangle modulo 2

5
From Combinatorial Games to Shape-Symmetric Morphisms
261
Fig. 5.7 Tracking the past of
a symbol in a bidimensional
2-automatic word
Example 5.6.4 With notation of the previous lemma, k = d = 2, consider Fig. 5.7.
The symbol in position (12, 10), where rep2(12) = 1100 and rep2(10) = 1010,
is in the image of the symbol which is in position (val2(110), val2(101)) =
(6, 5). Moreover, since the last letter of 1100 and 1010 are both 0, x(12, 10)
is the lower-left corner of f (x(6, 5)). Now, x(6, 5) appears in the image of
x((val2(11), val2(10)) = x(3, 2). Since the last digits in the base-2 expansion of
6 and 5 are respectively 0 and 1, x(6, 5) is the upper-left corner of f (x(3, 2)). We
can continue this way until we reach x(1, 1).
Theorem 5.6.5 [81, 82] Let w : Nd →B be an inﬁnite d-dimensional word over
an alphabet B. It is of the form g(f ω(a)) where f : A →Akd is a k-uniform
morphism, prolongable on a ∈A and g : A →B is a coding if and only if there
exists a DFAO
(A, a, {0, . . ., k −1}d, δ, μ : A →B)
such that δ(a, (0, . . . , 0)) = a and, for all (j1, . . . , jd) ∈Nd,
w(j1, . . . , jd) = μ(δ(a, repk(j1, . . . , jd)))
with the base-k expansion given in Deﬁnition 5.6.1.
The next example should sufﬁce to explain how to derive a suitable DFAO from
a morphism. If images of letters are d-dimensional cubes of size k, then transitions
are labeled by d-tuples of digits in {0, . . . , k −1}.
Example 5.6.6 (Pascal Triangle Modulo 2) We associate with the morphism ψ an
automaton with input alphabet (5.9). Let r, s, t, u, v ∈{0, 1}. If
ψ(r) = u
v
s
t

262
M. Rigo
Fig. 5.8 An automaton
generating the Pascal triangle
modulo 2 (left of Fig. 5.6)
1
0
then, we have the transitions
r
⎛
⎝0
0
⎞
⎠
−→s,
r
⎛
⎝1
0
⎞
⎠
−→t,
r
⎛
⎝0
1
⎞
⎠
−→u,
r
⎛
⎝1
1
⎞
⎠
−→v.
The morphism from Example 5.6.2 corresponds to the DFA depicted in Fig. 5.8.
We can make use of Lucas’s theorem (recalled below) for p = 2. From (5.10),
the binomial coefﬁcient
m
n
	
, with m ≥n, is even if and only if rep2(m, n) contains
the pair of digits
0
1
	
(because the other three pairs give binomial coefﬁcients equal
to 1). To prove that the morphism ψ generates the Pascal triangle modulo 2, recall
that we have some change of variables. It sufﬁces to observe that rep2(m, n) contains
the pair of digits
0
1
	
if and only if rep2(m −n, n) contains the pair of digits
1
1
	
. The
reader can probably carry on a proof of this necessary and sufﬁcient condition.10
We take the opportunity of Lemma 5.6.8 to give a proof involving automata. The
latter condition is recognized by the DFA depicted in Fig. 5.8 and associated with
the morphism ψ.
Theorem 5.6.7 (Lucas’s Theorem)
Let p be a prime. Let m and n be two non-
negative integers. If
repp(m, n) =
mk mk−1 · · · m1 m0
nk nk−1 · · · n1 n0

then the following congruence relation holds
m
n

≡
k1
i=0
mi
ni

mod p,
(5.10)
using the following convention:
m
n
	
= 0 if m < n.
Lemma 5.6.8 Let m ≥n. The pair rep2(m, n) contains the pair of digits
0
1
	
if and
only if rep2(m −n, n) contains the pair of digits
1
1
	
.
10One can relate this result to a theorem of Kummer. The p-adic valuation of
m
n
	
is the number of
carries when adding n to m −n in base p. See, e.g., [77] and the references therein.

5
From Combinatorial Games to Shape-Symmetric Morphisms
263
0
1
Fig. 5.9 A DFA accepting rep2(x, y, x + y) ⊂{0, 1}3
Proof The DFA depicted in Fig. 5.9 is mimicking base-2 addition. It recognizes 3-
tuples of words (u, v, w) such that u, v and w have the same length and val2(u) +
val2(v) = val2(w). Successful paths are those starting and ending in state 0. The
DFA reads least signiﬁcant digits ﬁrst. State 1 corresponds to the situation where
there is a carry to take into account. The undeﬁned transitions lead to some sink
state.
We can make use of this DFA to recognize rep2(m −n, n, m). Notice that
whenever rep2(n, m) contains a pair
1
0
	
(the last two of the three components), in a
successful path, we must use the unique transition from state 0 to state 1. This means
that rep2(m −n, n) contains the pair
1
1
	
(the ﬁrst two of the three components) and
conversely.
⊓⊔
Deﬁnition 5.6.9 For the sake of simplicity, consider the case d = 2. Consider
a bidimensional sequence x = (x(m, n))m,n≥0. The k-kernel of x is the set of
bidimensional subsequences
Kerk(x) =

(x(kim + r, kin + s))m,n≥0 | i ≥0, 0 ≤r, s < ki
.
Note that we have the same multiplicative factor ki for both components. One
element of the k-kernel corresponds to selecting two sufﬁxes
(0i−prp · · · r1, 0i−qsq · · · s1)
where repk(r) = rp · · · r1 and repk(s) = sq · · · s1. Theorem 5.4.19 can be extended
to this setting: a d-dimensional word satisﬁes the conditions of Theorem 5.6.5 if and
only if its k-kernel is ﬁnite. See, for instance, [8, 81, 82].
Example 5.6.10 (Pascal Triangle Modulo 2) Let (p2(m, n))m,n≥0 be the ﬁxed point
of the morphism ψ given in Example 5.6.2. We compute its 2-kernel as follows.

264
M. Rigo
From Lemma 5.6.3 and the form of ψ, we derive that, for all m, n ≥0,
p2(2m, 2n)
= p2(m, n),
p2(2m + 1, 2n)
= p2(m, n),
p2(2m, 2n + 1)
= p2(m, n),
p2(2m + 1, 2n + 1) = 0.
These relations can also be deduced from the DFA in Fig. 5.8: Reading the pair of
digits
1
1
	
leads to state 0, reading another pair does not change the state. Hence, the
2-kernel only contains the sequence itself and the null sequence. An alternative is
to proceed as in the Proof of Theorem 5.4.19 and compute the transition monoid of
the DFA in Fig. 5.8.
5.6.1
2-Regularity for Grundy Values of the Game of Nim
Compared with Example 5.6.10 where the 2-kernel of the Pascal triangle modulo 2
is ﬁnite, we can deﬁne a multidimensional k-regular sequence: the Z-module
generated by Kerk(x) is ﬁnitely generated. It is now time to reconsider Table 5.2.
Proposition 5.6.11 (Exercises 21 and 22, Section 16.6, p. 451 [8]) If we consider
the game of Nim on two token piles, the bidimensional sequence (GN(m, n))m,n≥0
is 2-regular.
Proof From Bouton’s theorem and simple base-2 manipulations, we get
GN(2m, 2n) =
2m ⊕2n
= 2 GN(m, n),
GN(2m + 1, 2n) =
(2m + 1) ⊕2n
= 2 GN(m, n) + 1,
GN(2m, 2n + 1) =
2m ⊕(2n + 1)
= 2 GN(m, n) + 1,
GN(2m + 1, 2n + 1) = (2m + 1) ⊕(2n + 1) = 2 GN(m, n).
Hence the 2-kernel is generated by (GN(m, n))m,n≥0 and the constant sequence
(1)m,n≥0.
⊓⊔
Remark 5.6.12 To prove that a sequence (s(n))n≥0 is k-regular, it is enough to ﬁnd
some j ≥1 and kj linear relations expressing, for all r < kj, s(kjn+r) in terms of
elements of the form s(kin + t) with i < j and t < ki. This observation is similar
in a multidimensional setting.
From the relations given in the proof of Proposition 5.6.11, we can express any
element (GN(2jm + r, 2jn + t))m,n≥0 of the 2-kernel as a linear combination of
(GN(m, n))m,n≥0 and (1)m,n≥0. An example should be enough to understand the
reasoning. Can (GN(8m + 5, 8n + 2))m,n≥0 be expressed as a Z-linear combination
of these two sequences?

5
From Combinatorial Games to Shape-Symmetric Morphisms
265
GN(8m + 5, 8n + 2) = GN (2(4m + 2) + 1, 2(4n + 1))
= 2 GN(4m + 2, 4n + 1) + 1
= 2 GN(2(2m + 1), 2.2n + 1) + 1
= 2 [2 GN(2m + 1, 2n) + 1] + 1
= 4 GN(2m + 1, 2n) + 3
= 4 [2 GN(m, n) + 1] + 3
= 8 GN(m, n) + 7.
We can discuss a bit further the meaning of the relations given in the proof of
Proposition 5.6.11. The situation is similar to the one of Lemma 5.6.3 and Fig. 5.7.
The only difference is that we have a function whose domain is not necessarily
bounded. A 2 × 2 block in the bidimensional word (GN(i, j))i,j≥0 whose lower-
left corner has coordinates (2m, 2n) is completely determined from the value of
GN(m, n):
GN(m, n) →2 GN(m, n) + 1
2 GN(m, n)
2 GN(m, n)
2 GN(m, n) + 1
(5.11)
The situation is depicted within Table 5.6. The value of GN(2, 1) determines the
2 × 2 block with lower-left corner of coordinates (4, 2). The four elements of that
block give the 4 × 4 block whose lower-left corner has coordinates (8, 4) and so on
and so forth.
Table 5.6 First few values of GN(m, n) highlighting the action of the map (5.11)
9 8 11 10 13 12 15 14
1
0
8 9 10 11 12 13 14 15
0
1
7 6
5
4
3
2
1
0
15 14 13 12
6 7
4
5
2
3
0
1
14 15 12 13
5 4
7
6
1
0
3
2
13 12 15 14
4 5
6
7
0
1
2
3
12 13 14 15
3 2
1
0
7
6
5
4
11 10
2 3
0
1
6
7
4
5
10 11
1 0
3
2
5
4
7
6
9
8
0 1
2
3
4
5
6
7
8
9

266
M. Rigo
Fig. 5.10 Graph of
GW (5, n) −n for
50 ≤n ≤150
5.6.2
Grundy Values of the Game of Wythoff
Even though it looks quite similar to the situation encountered with the game of
Nim, Table 5.3 is challenging! We quote the book [85, p. 200]: “No general formula
is known for computing arbitrary G-values of Wythoff. In general, they appear
chaotic, though they exhibit a striking fractal-like pattern...Despite this apparent
chaos, the G-values nonetheless have a high degree of geometric regularity.”
We collect some results from Blass and Fraenkel about GW(m, n) [14]:
•
On every parallel to the main diagonal, (GW (n, n + j))n≥0 takes every possible
value.
•
Points with Grundy value 1 are “close” to those with value 0.
•
Recursive algorithms to determine the points with Grundy value 1 are provided.
Deﬁnition 5.6.13 A sequence (aj)j≥0 is additively periodic if
∃p, q, ∀j ≥q : aj+p = aj+p.
Note that (aj)j≥0 is additively periodic if and only if (aj −j)j≥0 is ultimately
periodic.
Example 5.6.14 As an example, the row GW (5, n) is such that for all n ≥27,
GW (5, n + 24) = GW (5, n) + 24 (Fig. 5.10).
Every row and column of GW (m, n) is additively periodic, see [32, 56].
5.7
Shape-Symmetry
Table 5.5 will permit us to introduce the notion of shape-symmetry. Our aim in
this section is to prove Theorem 5.7.14 stating that Table 5.5 is the ﬁxed point
of a morphism with the shape-symmetry property. A picture is the analogue in a

5
From Combinatorial Games to Shape-Symmetric Morphisms
267
multidimensional setting of a ﬁnite word. It is a bit more intricate to deﬁne the
concatenation of pictures. The results and material presented in this section come
from [64] and [22]. We ﬁrst start with formal deﬁnitions, Example 5.7.4 is presented
afterwards.
Deﬁnition 5.7.1 (Picture) Let A be an alphabet. Let s1, . . . , sd ≥1 be in N>0 ∪
{∞}. A d-dimensional picture over A is a map
x : {0, . . ., s1 −1} × · · · × {0, . . ., sd −1} →A
and (s1, . . . , sd) is the shape of x. It is denoted by |x| and |x|i = si. If si < ∞, for
all i, x is bounded. The set of bounded pictures over A is denoted by Bd(A).
Deﬁnition 5.7.2 (Factor) Let x
∈
Bd(A) be a bounded picture of shape
(s1, . . . , sd). Let i1, j1, . . . , id, jd be integers such that 0 ≤ik ≤jk < sk for
all k ∈{1, . . ., d}. We let
x[(i1, . . . , id), (j1, . . . , jd)]
denote the picture y of shape (j1 −i1 + 1, . . . , jd −id + 1) deﬁned by
y(n1, . . . , nd) = x(i1 + n1, . . . , id + nd)
for all n1 < j1 −i1, . . . , nd < jd −id. In 2 dimensions, this just means that we
specify the lower-left and upper-right corner of a sub-picture.
We let 0 (resp. 1) denote the row vector (of convenient dimension) whose entries
are all equal to zero (resp. one). Let i ∈{1, . . ., s}. If z is a d-tuple, we let zi denote
the (d −1)-tuple where the ith coordinate has been removed.
Deﬁnition 5.7.3 (Concatenation) Let x, y ∈Bd(A). If we have for some i ∈
{1, . . ., d}, |x|i = |y|i = (s1, . . . , si−1, si+1, . . . , sd), then we deﬁne the concate-
nation of x and y along the ith direction to be the d-dimensional picture x ⊙i y of
shape
(s1, . . . , si−1, |x|i + |y|i, si+1, . . . , sd).
satisfying
1. x = (x ⊙i y)[0, |x| −1] and
2. y = (x ⊙i y)[(0, . . ., 0, |x|i, 0, . . . , 0), (0, . . ., 0, |x|i, 0, . . . , 0) + |y| −1].
In our examples, taking the usual convention for matrices, we ﬁrst count the
number of rows, then the number of columns. Concatenation along the direction 1
(resp. 2) follows the vertical (resp. horizontal) axis.

268
M. Rigo
Example 5.7.4 Consider the two pictures
x = a b
c d
and
y = a a b
b c d
of respective shape |x| = (2, 2) and |y| = (2, 3). Since |x|2 = |y|2 = 2, we get
x ⊙2 y = a
b
a
a
b
c
d
b
c
d
and
y ⊙2 x = a
a
b
a
b
b
c
d
c
d .
However x ⊙1 y is not deﬁned because 2 = |x|1 ̸= |y|1 = 3. The pictures x ⊙2 y
and y ⊙2 x both have shape (2, 5). Thus we can, for instance, deﬁne
z = (x ⊙2 y) ⊙1 (y ⊙2 x) =
a
a
b
a
b
b
c
d
c
d
a
b
a
a
b
c
d
b
c
d
.
Remark 5.7.5 A map γ : A
→
Bd(A) cannot necessarily be extended to a
morphism γ : Bd(A) →Bd(A). As an example, consider the map deﬁned by
γ : a →b d
a a ,
b →b
c ,
c →a a ,
d →d .
Take the following bounded picture
x = c d
a b .
Considering the two rows of x, we may apply ⊙2 because |γ (a)|2 = |γ (b)|2 = 2
and |γ (c)|2 = |γ (d)|2 = 1. Considering the two columns of x, we may apply ⊙1
because |γ (a)|1 = |γ (c)|1 = 2 and |γ (b)|1 = |γ (d)|1 = 1. Hence the image of x
by γ is well-deﬁned:
γ (x) =
a
a
d
b
d
b
a
a
c
but γ 2(x) is not well-deﬁned! Indeed, see Fig. 5.11, if we try to put together the
images by γ of the different letters, we do not get a picture: Conditions to have a
well-deﬁned morphism are given in (5.12) and Theorem 5.7.13.

5
From Combinatorial Games to Shape-Symmetric Morphisms
269
Fig. 5.11 A map cannot
necessarily be extended to a
morphism
b
d
a
a
b
d
a
a
d
b
c
d
b
c
b
d
a
a
b
d
a
a
a
a
Consider the section of a picture by a hyperplane. In this discrete setting, all the
hyperplanes that we consider have equation of the form xi = k for some i.
Deﬁnition 5.7.6 (Section) Let x be a d-dimensional picture of shape |x|
=
(s1, . . . , sd). For all i ∈{1, . . . , d} and k < si, we let x|i,k denote the (d −1)-
dimensional picture of shape
|x|i = (s1, . . . , si−1, si+1, . . . , sd)
deﬁned by setting the ith coordinate equal to k in x, that is,
x|i,k(n1, . . . , ni−1, ni+1, . . . , nd) = x(n1, . . . , ni−1, k, ni+1, . . . , nd)
for all nj < sj with j ∈{1, . . . , d} \ {i}.
What is the exact meaning for a morphism to be well-deﬁned on a given picture?
Let γ : A →Bd(A) be a map and x be a bounded d-dimensional picture such that
∀i ∈{1, . . ., d}, ∀k < |x|i, ∀a, b ∈Alph(x|i,k) : |γ (a)|i = |γ (b)|i.
(5.12)
We let Alph(x|i,k) denote the set of letters occurring in x|i,k. Then the image of x by
γ is the d-dimensional picture deﬁned as
γ (x) = ⊙1
0≤n1<|x|1

· · ·

⊙d
0≤nd<|x|dγ (x(n1, . . . , nd))

· · ·

.
Note that the ordering of the products in the different directions is unimportant. If a
bounded picture x does not satisfy (5.12), then γ (x) is undeﬁned. This means that
the map γ can be extended to a subset of Bd(A). It is a quite restrictive requirement.
In two dimensions, condition (5.12) simply means that the images by γ of all the
elements belonging to the same column (resp. rows) are pictures having the same
number of columns (resp. row), see Fig. 5.12. With d dimensions, (5.12) means that,
for all sections by a hyperplane xi = k, the images of all letters in this section have
a shape with the same component along the direction orthogonal to that hyperplane.
This ensures that building γ (x) by concatenating the images of letters, we will not
obtain “holes” or “overlaps”.

270
M. Rigo
Fig. 5.12 Illustration of the
condition (5.12)
x
x2 = 2
x1 = 6
Deﬁnition 5.7.7 (Multidimensional Morphism) If for all a ∈A and all n ≥1,
γ n(a) is well-deﬁned from γ n−1(a), then γ is said to be a d-dimensional morphism.
If there exists a letter b such that γ (b)0,...,0 = b and, for all i, |γ n(b)|i →+∞when
n →+∞, then γ is said to be prolongable on b. We assume that the picture grows
in every direction. It is not a strong assumption. If this is not the case and one of the
direction remains constant, then we have a ﬁnite union of hyperplanes and words of
lower dimension.
Remark 5.7.8 Let x, y be two bounded pictures such that |x|i
= |y|i and a
morphism γ . Assume that γ (x) and γ (y) are well-deﬁned pictures. If γ (x ⊙i y)
is well-deﬁned, then it is equal to γ (x) ⊙i γ (y) which is thus well-deﬁned. On
the other hand, if γ (x) ⊙i γ (y) is deﬁned, there is no reason for γ (x ⊙i y) to be
well-deﬁned. As an example, take
γ : a →b
b
a
a ,
b →b
b
and
x = a
b
y = b
a
We have
x ⊙2 y = a
b
b
a ,
γ (x) ⊙2 γ (y) =
b
b
b
b
a
a
b
b
b
b
a
a
but γ (x ⊙2 y) is undeﬁned because (5.12) is not satisﬁed. The images by γ of letters
on each row of x ⊙2 y have different number of rows.
Deﬁnition 5.7.9 (Projection)
Let γ : A →Bd(A) be a d-dimensional morphism
prolongable on a. The ith projection of γ is a unidimensional morphism γi deﬁned
as follows. For all b, γi(b) is the intersection of the picture γ (b) with the hyperplane
xi = 0.

5
From Combinatorial Games to Shape-Symmetric Morphisms
271
Deﬁnition 5.7.10 (Shape-Symmetry) Let γ : Bd(A) →Bd(A) be a d-dimen-
sional morphism having the d-dimensional inﬁnite word x as a ﬁxed point. This
word is shape-symmetric with respect to γ if, for all permutations ν of {1, . . ., d},
we have, for all n1, . . . , nd ≥0,
|γ (x(n1, . . . , nd))| = (s1, . . . , sd) ⇒|γ (x(nν(1), . . . , nν(d)))| = (sν(1), . . . , sν(d)).
Note that, on the diagonal, γ (x(j, . . ., j)) must be a cube.
Example 5.7.11 The multidimensional k-automatic words are trivially shape-
symmetric with respect to a morphism that sends letters to hypercubes of size
k.
Example 5.7.12 The following morphism will be extensively used
ϕW : a →c
d
a
b
b →e
i
c →i
j
d →i
e →f
b
f →h
d
g
b
g →h
d
f
b
h →i
m
i →h
d
i
m
j →c
k
k →c
d
l
m
l →c
d
k
m
m →h
i
with the coding
μW : a, e, g, j, l →1,
b, c, d, f, h, i, k, m →0.
The fourth iterate of ϕ4
W(a) is given in Table 5.7.
It can be shown that ϕW is a two-dimensional morphism, see the next theorem.
The size of the nth iterate from a is given by the nth Fibonacci number. The inﬁnite
word with a in position (0, . . . , 0) and which is a ﬁxed point of ϕW, is shape-
Table 5.7 The fourth iterate
of ϕ4
W (a)
i
m
i
i
j
i
m
i
h
d
h
c
d
h
d
h
i
m
i
l
m
i
m
i
h
d
c
h
d
h
d
e
i
m
k
i
m
g
b
i
i
j
i
f
b
i
m
i
c
d
e
h
d
h
d
h
a
b
i
i
m
i
m
i

272
M. Rigo
symmetric with respect to ϕW. For instance, the image of e (second row, third
column) has shape (1, 2) and the image of j (second column, third row) has a
transposed shape (2, 1).
The two projections of ϕW are given by
[ϕW]1 : a →ac, c →i, i →ih, h →i
(5.13)
and
[ϕW]2 : a →ab, b →i, i →im, m →i .
(5.14)
Up to some renaming of letters, these two morphisms are equal.
The following result can be found in Maes’s thesis [64]. In this thesis, Maes
provides two different proofs. We only present the one using automata.
Theorem 5.7.13 (A. Maes)
Let d ≥1. Let A be an alphabet.
•
Determining whether or not a map μ: A →Bd(A) can be extended to a d-
dimensional morphism, prolongable on a letter a, is a decidable problem.
•
If μ is prolongable on the letter a, then it is decidable whether or not the ﬁxed
point μω(a) is shape-symmetric with respect to μ.
Sketch of the Proof The reader should be used to the construction. We associate a
DFA Aμ, just as in Example 5.6.6, with the map μ: A →Bd(A) and a speciﬁed
initial symbol a. The set of states is A and transitions are labeled by d-tuples of
digits: if μ(b) has shape |μ(b)| = (s1, . . . , sd), we have a transition (c1, . . . , cd)
for 0 ≤ci < si and for all i ∈{1, . . ., d}. So the number of outgoing transitions
from b ∈A is 2
i |μ(b)|i. The DFA associated with the map γ of Remark 5.7.5 is
depicted in Fig. 5.13. From this DFA, we build d new NFAs. Let i ∈{1, . . ., d}.
We deﬁne a NFA Ni where, for every transition, we only keep the ith component of
the label (we proceed to a projection that explains the non-determinism). Moreover,
the set Ii of initial states is made of all the states that can be reached from a when
reading a word in 0∗(Fig. 5.14).
Fig. 5.13 The DFA
associated with the map γ of
Remark 5.7.5
a
b
d
c

5
From Combinatorial Games to Shape-Symmetric Morphisms
273
Fig. 5.14 The NFAs N1 and
N2 derived from Aγ
a
b
d
c
a
b
d
c
0, 1
0
1
0
0
0, 1
0
0
1
1
1
0
0
0
We apply the subset construction (Rabin–Scott theorem) to these NFAs. The
corresponding DFAs are denoted by Di, i = 1, . . . , d. Recall that states of Di are
subsets of states of Ni and thus of Aμ, i.e., a state of Di is a subset of the alphabet A.
Observe that the initial state Ii of Di is made of the states that can be reached in Aμ
by a word in (Nd)∗whose ith component is in 0∗. If μ is a morphism prolongable on
a, then Ii is exactly the set of letters occurring in the intersection of μω(a) with the
hyperplane xi = 0. Therefore, in view of (5.12), for all b ∈Ii, the quantities |μ(b)|i
must all be the same. Let Q be a state of Di. There exists a word w ∈N∗such that,
for all b in Q, there exists a word in (Nd)∗which is the label of a path from a to b in
Aμ and whose ith component is in 0∗w. If μ is a morphism prolongable on a, then
w can be chosen in Lμi where μi is the ith projection of μ (see Deﬁnition 5.7.9) and
Lμi is the language given by Theorem 5.5.6 where words do not start with 0. If w
is the (n + 1)st word, n ≥0, in the genealogically ordered language Lμi, then Q is
exactly the set of letters occurring in the intersection of μω(a) with the hyperplane
xi = n. In view of (5.12), for all b ∈Q, the quantities |μ(b)|i must all be the same.
We conclude that, if μ is a morphism prolongable on a, then:
•
For all i ∈{1, . . ., d}, for any two letters b, c belonging to the same state of Di,
we have |μ(b)|i = |μ(c)|i.
Conversely, if the above condition holds, then proceed by induction on the iterate
j ≥0. Assume that μj(a) exists. Let n ≥0. Then the set of letters occurring in
the intersection of μj(a) with xi = n is a subset of some state in Di. Therefore,
the above condition and (5.12) permit us to deﬁne μj+1(a). In Table 5.8, we have
applied the subset construction to N1. This shows that, starting with a, the map γ
cannot be extended to a morphism. The last column contains the ﬁrst component of
the shape of γ (e) for the letters e in the corresponding subset.
Table 5.8 Subset
construction applied to N1
State of D1
|γ(·)|1
D1 · ε = I1
{a, b, c}
2, 2, 1
D1 · 1
{a, d}
2, 1
D1 · 10
{a, b, d}
2, 2, 1
D1 · 100
{a, b, c, d}
2, 2, 1, 1

274
M. Rigo
Let us now turn to the second decision problem. From Deﬁnition 5.7.10, it should
be clear that:
•
Given a morphism μ prolongable on a letter a, the ﬁxed point μω(a) is shape-
symmetric with respect to μ if and only if the languages Lμ1, . . . , Lμd are equal.
It is well-known that testing equality of regular languages is decidable (see, e.g.,
[86]). For instance, from (5.13) and (5.14), we directly see that if ϕω
W(a) exists then
it is shape-symmetric with respect to ϕW.
⊓⊔
In Fig. 5.15, we have depicted the ﬁrst iteration (two viewpoints) of what a shape-
symmetric morphism looks like in three dimensions.
We can already state the main result related to Wythoff’s game because it is
related to shape-symmetric morphisms.
Theorem 5.7.14 The morphism ϕW deﬁned in Example 5.7.12 and the coding μW
give the two-dimensional inﬁnite word coding the P-positions of Wythoff.
The proof will be given in Sect. 5.7.3. In particular, the DFA associated with
ϕW is depicted in Fig. 5.20. If we apply the procedure described in the proof of
Theorem 5.7.13, when determinizing the two NFAs we get the following Table 5.9
showing that ϕW is a prolongable morphism.
Example 5.7.15 (Product of Substitutions) Let μ : A∗→A∗and ν : B∗→B∗
be two morphisms prolongable respectively on a ∈A and b ∈B. We deﬁne the
product (called direct product in Priebe Frank’s chapter (this volume)) μ × ν :
A × B →Bd(A × B) where (μ × ν)(c, d) is the picture obtained as the cross
product of the two ﬁnite words μ(c) and ν(d). It is easy to check that the map μ×ν
is a morphism prolongable on (a, b). The corresponding ﬁxed point is the cross
product of μω(a) and νω(b). Take the Thue–Morse morphism f : 0 →01, 1 →10
Fig. 5.15 Initial blocks of some two-dimensional shape-symmetric morphism

5
From Combinatorial Games to Shape-Symmetric Morphisms
275
Table 5.9 Applying Maes’s
procedure to ϕW
State of D1
|γ(·)|1
D1 · ε = I1
{a, b, i, m}
2, 2, 2, 2
D1 · 1
{c, d, e, h}
1, 1, 1, 1
D1 · 10
{b, f, i, j, m}
2, 2, 2, 2, 2
D1 · 11
{}
D1 · 100
{b, g, i, k, m}
2, 2, 2, 2, 2
D1 · 1000
{b, f, i, l, m}
2, 2, 2, 2, 2
State of D2
|γ(·)|2
D2 · ε = I2
{a, c, h, i}
2, 2, 2, 2
D2 · 1
{b, d, j, m}
1, 1, 1, 1
D2 · 10
{c, e, h, i, k}
2, 2, 2, 2, 2
D2 · 11
{}
D2 · 100
{c, f, h, i, l}
2, 2, 2, 2, 2
D2 · 1000
{c, g, h, i, k}
2, 2, 2, 2, 2
of Example 5.4.20 and the Fibonacci morphism F : a →ab, b →a of
Deﬁnition 5.5.1.
f × F : (0, a) →(0, b) (1, b)
(0, a) (1, a) ,
(0, b) →(0, a) (1, a) ,
(1, a) →(1, b) (0, b)
(1, a) (0, a) ,
(1, b) →(1, a) (0, a) .
Note that we get a word shape-symmetric with respect to μ × ν if and only if Lμ
and Lν are equal (where the languages are given by Theorem 5.5.6). In particular,
the product of a morphism by itself gives shape-symmetry. See also [80].
5.7.1
Abstract Numeration Systems
Abstract numeration systems are based on an inﬁnite (regular) language over a
totally ordered alphabet. They are natural generalizations of classical systems such
as integer base systems or Pisot systems [16]. Recall that the genealogical ordering
was introduced in Deﬁnition 5.5.5. For a survey chapter introducing abstract
numeration systems, see [59].

276
M. Rigo
Deﬁnition 5.7.16 An abstract numeration system (or ANS for short) is a triple S =
(L, A, <) where L is an inﬁnite regular11 language over a totally ordered alphabet
(A, <). The map repS : N →L is the one-to-one correspondence mapping n ∈N
to the (n + 1)st word in the genealogically ordered language L, which is called the
S-representation of n. The S-representation of 0 is the ﬁrst word in L. The inverse
map is denoted by valS : L →N. If w is a word in L, valS(w) is its S-numerical
value.
ANS were introduced in [60]. Note that valS(w) is sometimes called the rank
of w. See, for instance, [26].
Remark 5.7.17 A motivation for studying abstract numeration systems is that it is
quite convenient to have a regular language of admissible representations. Given a
ﬁnite word, one can decide in linear time with respect to the length of the entry,
using a DFA, whether or not this word is a valid representation.
Another motivation comes from Cobham’s theorem about base dependence. See
Theorem 5.4.21 for its statement in terms of k-recognizable12 sets of integers. In
view of this theorem of Cobham, if a set of integers is recognizable within two
“sufﬁciently different” systems, then this set is ultimately periodic. Moreover, every
ultimately periodic set is always k-recognizable for every integer base k ≥2.
Therefore, if one thinks about a possible generalization of this theorem of Cobham,
then a minimal requirement is that ultimately periodic sets—in particular N—should
have a set of S-representations which is a regular language.
Example 5.7.18 (Integer Base System) Let k ≥2 be an integer. Consider the
language
L = {ε} ∪{1, . . . , k −1}{0, . . ., k −1}∗.
The ANS built on L using the natural ordering of the digits in {0, . . ., k −1} is
the usual base-k numeration system. Note that we do not allow leading zeroes in
representations. Indeed, adding leading zeroes would change the length of the word
and therefore the ordering (and thus the value) of this word. Recall that, in the
genealogical ordering, words are ﬁrst ordered with respect to their length.
Example 5.7.19 (Unambiguous Integer Base System)
Let k ≥2 be an integer.
Consider the language
U = {1, . . ., k}∗.
11One could relax the assumption about regularity of the language on which the numeration system
is built to encompass a larger framework. Nevertheless, most of the nice properties that we shall
present (in particular, the equivalence with morphic words) do not hold without the regularity
assumption.
12A set X ⊆N is k-recognizable if repk(X) ⊆{0, . . . , k −1}∗is recognized by a DFA or,
equivalently, if the characteristic sequence of X is k-automatic.

5
From Combinatorial Games to Shape-Symmetric Morphisms
277
As the reader may observe, in this system, the digit set is {1, . . ., k} instead of
{0, . . ., k −1}. Therefore, we avoid any discussion about possible leading zeroes.
For k = 2, the ﬁrst few words in the ordered language U, using the natural ordering
of {1, . . ., k}, are
ε <gen 1 <gen 2 <gen 11 <gen 12 <gen 21 <gen 22
<gen 111 <gen 112 <gen 121 <gen 122 <gen · · · .
Let U be the ANS built on U. Note that if cℓ· · · c0 is a word over {1, . . ., k}, then
valU(cℓ· · · c0) =
ℓ

i=0
ci ki .
Let n ≥0. In particular, note that valU(kn) = k kn−1
k−1 and the next word in the
genealogical ordering, i.e., the ﬁrst word of the next length, gives valU(1n+1) =
kn+1−1
k−1 . For more about unambiguous systems, see [51, 52].
Example 5.7.20 We can reconsider Example 5.5.17. We have repF (N)
=
1{0, 01}∗∪{ε}. Hence, ordering the words of this regular language gives an abstract
numeration system. Because of Proposition 5.5.13, this remark can be applied to
every positional numeration system whose language of U-representations is regular.
Example 5.7.21 Consider L = a∗b∗with a < b and the ANS S = (L, {a, b}, <).
The ﬁrst few words in L in increasing genealogical order are
ε <gen a <gen b <gen aa <gen ab <gen bb <gen
aaa <gen aab <gen abb <gen bbb <gen · · · .
For example, valS(abb) = 8 and repS(3) = aa. If we consider the bijection from
L to N2 mapping the word aibj to the pair (i, j), i, j ≥0, it is not difﬁcult to
see that the genealogical ordering of L corresponds to the primitive recursive Peano
enumeration of N2, that is
valS(aibj) = 1
2(i + j)(i + j + 1) + j =
i + j + 1
2

+
j
1

.
(5.15)
Many papers are dedicated to numeration systems satisfying conditions of the form
(5.15). For more on these combinatorial numeration systems, see [25] and the
references therein, in particular [54].
Example 5.7.22 (Preﬁx-Closed Language) Consider the preﬁx-closed language
{a, ba}∗{ε, b}.

278
M. Rigo
Fig. 5.16 A trie for words of
length ≤3 in {a, ba}∗{ε, b}
0
1
2
3
4
5
6
7
8
9
10
a
b
a
b
a
a
b
a
a
b
When considering such a language ordered by genealogical order, the nth level of
the trie contains all words of L of length n in lexicographic order from left to right
assuming that the children of a node are also ordered with respect to the ordering of
the alphabet. To enumerate the words in the language: proceed one level at a time,
from left to right. In Fig. 5.16 we represent the ﬁrst four levels of the corresponding
trie, i.e., a rooted tree where the edges are labeled by letters from A, and the nodes
are labeled by preﬁxes of words in the considered language L. Let u ∈A∗, a ∈A.
If ua is (a preﬁx of) a word in L, then there is an edge between u and ua. Note that
for a preﬁx-closed language L, all preﬁxes of words in L belong to L. In the nodes,
we have written the S-numerical value of the corresponding words in L. The root is
associated with ϵ. See also [65, 66].
In Sect. 5.4 and in particular, with Theorem 5.4.12, we have seen that k-automatic
sequences can be obtained by feeding a DFAO with base-k expansions of integers.
Now that we have generalized numeration systems, we can feed a DFAO with S-
representations of integers.
Deﬁnition 5.7.23 Let S = (L, A, <) be an ANS. We say that an inﬁnite word x =
x0x1x2 · · · ∈BN is S-automatic, if there exists a DFAO (Q, q0, A, δ, μ : Q →B)
such that xn = μ(δ(q0, repS(n))) for all n ≥0.
This notion was introduced in [70, 75]. For an intermediate notion, see [84].
Example 5.7.24 Let k ≥2. Every k-automatic sequence is S-automatic for the
ANS introduced in Example 5.7.18.
Example 5.7.25 We consider the alphabets A = {a, b}, B = {0, 1, 2, 3}, the ANS
S = (a∗b∗, A, a < b) of Example 5.7.21 and the DFAO depicted in Fig. 5.17. We
obtain the ﬁrst few terms of the corresponding S-automatic sequence
x = 0102303120023101012302303120312023100231012 · · · .

5
From Combinatorial Games to Shape-Symmetric Morphisms
279
Fig. 5.17 A DFAO with
output alphabet {0, 1, 2, 3}
0
1
2
3
Notice that taking another ANS such as R = ({a, ba}∗{ε, b}, {a, b}, a < b),
we obtain with the same DFAO another inﬁnite word y = 01023131023· · · which
is R-automatic (underlined letters indicate the differences between x and y). This
stresses the fact that a S-automatic sequence really depends on two ingredients: an
ANS and a DFAO.
Theorem 5.5.6 can directly be restated in terms of ANS: morphic words are S-
automatic for some ANS S. This is just a question of terminology. We state it in the
case of a pure morphic word. It is not difﬁcult to add an extra coding taking into
account in the output function of the corresponding DFAO.
Theorem 5.7.26 Let (A, <) be an ordered alphabet. Let w ∈AN be an inﬁnite
word, ﬁxed point f ω(a) of a morphism f : A∗→A∗prolongable on a. Consider
the language Lf of words accepted by the automaton Af associated with f , except
those starting with 0. Then the word w is S-automatic for the ANS S = (Lf , A, <)
and the DFAO AF .
Now we turn to the converse of Theorem 5.7.26.
Proposition 5.7.27 Let S be an ANS. Every S-automatic sequence is a morphic
word.
Proof Let S = (L, A, <) be an ANS. Let A = (Q, q0, A, δA, F) be a complete
DFA accepting L. Let B = (R, r0, A, δB, μ : R →B) be a DFAO generating
an S-automatic sequence x = (xn)n≥0 over B, i.e., for all n ≥0, xn
=
μ(δB(r0, repS(n))).
Consider the Cartesian product automaton P = A × B deﬁned as follows. The
set of states of P is Q×R. The initial state is (q0, r0) and the alphabet is A. For any
word w ∈A∗, the transition function Δ : (Q × R) × A∗→Q × R is given by
Δ((q, r), w) = (δA(q, w), δB(r, w)) .
This means that the product automaton mimics the behaviors of both A and B in
a single automaton. In particular, after reading w in P, Δ((q0, r0), w) belongs to
F ×R if and only if w belongs to L. Moreover if repS(n) = w and Δ((q0, r0), w) =
(q, r), then xn = μ(r).

280
M. Rigo
Now we can apply Lemma 5.5.9 to P and deﬁne a morphism ψP prolongable on
a letter z which does not belong to Q × R. In view of the previous paragraph, we
deﬁne ν : ((Q × R) ∪{z})∗→B∗by
ν(q, r) =
 μ(r), if q ∈F;
ε,
otherwise;
and ν(z) = ε. As Lemma 5.5.9 can be used to describe the sequence of reached
states, ν(ψP(z)) is exactly the sequence (xn)n≥0. This proves that x is morphic.
⊓⊔
Note that the morphisms obtained at the end of this proof are erasing. This is not
a problem thanks to Theorem 5.4.3.
5.7.2
Multidimensional S-Automatic Sequences
We have something similar to Deﬁnition 5.6.1 but since the digit 0 modiﬁes the
length of a word (see Examples 5.7.18 and 5.7.19), we use an extra padding symbol
not in the original alphabet.
Deﬁnition 5.7.28 If w1, . . . , wd are ﬁnite words over the alphabet A, the padding
map (·)#: (A∗)d →((A ∪{#})d)∗is deﬁned as
(w1, . . . , wd)# := (#m−|w1|w1, . . . , #m−|wd|wd)
where m = max{|w1|, . . . , |wd|}. For all n1, . . . , nd ≥0, we set
repS(n1, . . . , nd) := (repS(n1), . . . , repS(nd))# .
As an example, (ab, bbaa)# = (##ab, bbaa).
Deﬁnition 5.7.29 An inﬁnite d-dimensional word x ∈BN is S-automatic for
an abstract numeration system S = (L, A, <), if there exists a DFAO A =
(Q, q0, (A ∪#)d, δ, τ : Q →B) such that, for all n1, . . . , nd ≥0,
τ(δ(q0, repS(n1, . . . , nd)) = xn1,...,nd.
In this case, we say that the DFAO A generates the inﬁnite word x.
Example 5.7.30 Consider the ANS S = ({a, ba}∗{ε, b}, {a, b}, a < b) and the
DFAO depicted in Fig. 5.18. Since this automaton is fed with entries of the form
(repS(n1), repS(n2))#, we do not consider the transitions on input (#, #). If the
outputs of the DFAO are considered to be the states themselves, then the DFAO
generates the bidimensional inﬁnite S-automatic word given in Fig. 5.19.

5
From Combinatorial Games to Shape-Symmetric Morphisms
281
p
q
r
s
(a, #), (a, a), (b, a)
(b, #), (#, a), (#, b)
(a, b), (b, b)
(a, #), (b, #), (b, b)
(#, a), (#, b), (a, b)
(a, a), (b, a)
(b, a), (#, b), (a, b)
(a, #), (b, #), (#, a), (b, b)
(a, a), (b, b)
(b, a), (#, b), (a, b)
(a, #), (b, #), (#, a)
(a, a)
Fig. 5.18 A deterministic ﬁnite automaton with output
aab
q
p
s
p
s
s
p
s
aaa
p
p
s
p
s
q
p
s
ba
p
s
q
p
s
q
s
q
ab
q
p
s
p
s
s
s
r
aa
p
p
s
p
s
q
q
s
b
q
p
s
q
s
q
p
s
a
p
p
s
s
q
s
p
s
ε
p
q
q
p
q
p
q
q
ε
a
b
aa
ab
ba
aaa
aab
Fig. 5.19 A bidimensional inﬁnite S-automatic word
The main goal of [22] is to prove the following result, an extension of Salon’s
theorem.
Theorem 5.7.31 Let d ≥1. The d-dimensional inﬁnite word x is S-automatic for
some abstract numeration system S = (L, A, <) where ε ∈L if and only if x is the
image by a coding of a shape-symmetric inﬁnite d-dimensional word.
This result is not surprising: we have seen in the proof of Theorem 5.7.13 that
an inﬁnite word is shape-symmetric with respect to a morphism μ if and only if
the languages Lμi are all equal. But to deﬁne a S-automatic word, we use the same
ANS for the representation of every component.

282
M. Rigo
5.7.3
Proof of Theorem 5.7.14
Recall that ϕW was deﬁned in Example 5.7.12.
Proof of Theorem 5.7.14 We associate with ϕW the DFA with input alphabet (5.9)
depicted in Fig. 5.20. For the sake of readability, some labels are omitted. Ingoing
transitions to state i (resp. m, d, h) all have label
0
0
	
(resp.
1
0
	
,
1
1
	
,
0
1
	
). For
r, s, t, u, v belonging to the 13-letter alphabet {a, b, . . ., m}, if
ϕW(r) = u
v
s
t
,
s
t ,
u
s
or
s
we have transitions like
r
⎛
⎝0
0
⎞
⎠
−→s,
r
⎛
⎝1
0
⎞
⎠
−→t,
r
⎛
⎝0
1
⎞
⎠
−→u,
r
⎛
⎝1
1
⎞
⎠
−→v.
From Table 5.9 and Theorem 5.7.13, we already know that ϕW is a morphism
prolongable on a.
First observe that, if all states are assumed to be ﬁnal, this automaton accepts the
words
u
v

Fig. 5.20 The DFA associated with the morphism ϕW

5
From Combinatorial Games to Shape-Symmetric Morphisms
283
where |u| = |v| and u, v are both valid F-representation (possibly padded with
leading zeroes to get two words of the same length).
Second, if we restrict to the “black” part (still assuming a, b, c, e, f, g, j, k, l to
be ﬁnal), the automaton accepts exactly the words
0w1 · · · wℓ
w1 · · · wℓ0

and
w1 · · · wℓ0
0w1 · · · wℓ

where w1 · · · wℓis a valid F-representation.
Finally, taking into account the coding given in Example 5.7.12, the set of ﬁnal
states is {a, e, g, j, l}. We have the extra acceptance condition that w1 · · · wℓends
with an even number of zeroes. With our previous characterization of P-positions
given by Theorem 5.5.20, this concludes the proof.
⊓⊔
As a concluding remark, we try to answer the following question. The reader
may wonder how we got the morphism ϕW having only access to Table 5.5.
We considered some kind of “reverse engineering” strategy. We ﬁrst conjectured
that the Fibonacci word is playing a role (clear from Theorem 5.5.20). Hence,
we cut the bidimensional word using, on both axis, the directive sequence
2, 1, 2, 2, 1, 2, 1, 2, 2, 1, . . . deduced from the Fibonacci word f′ (5.5), see
Table 5.10. It produces pictures of shape (2, 2), (2, 1), (1, 2) and (1, 1). If a
morphism ϕW exists, then every time we see a given symbol, its image must have
a constant shape (same observation for iterates). Thus by looking at the future of a
symbol, we may distinguish several types of 0’s and 1’s. With this heuristic, we get
a ﬁnite number of candidates for symbols and images providing the morphism ϕW.
For instance the ﬁrst three 1’s in positions (0, 0), (1, 2) and (2, 1) must correspond
to different symbols. Indeed, they should give rise to images of respective shape
(2, 2), (2, 1) and (1, 2).
Table 5.10 The bidimensional word w(m, n) coding P-positions of Wythoff
10 0 0 0 0 0 0 1 0 0 0
0
9
0 0 0 0 0 0 0 0 0 0
0
8
0 0 0 0 0 0 0 0 0 0
0
7
0 0 0 0 1 0 0 0 0 0
0
6
0 0 0 0 0 0 0 0 0 0
1
5
0 0 0 1 0 0 0 0 0 0
0
4
0 0 0 0 0 0 0 1 0 0
0
3
0 0 0 0 0 1 0 0 0 0
0
2
0 1 0 0 0 0 0 0 0 0
0
1
0 0 1 0 0 0 0 0 0 0
0
0
1 0 0 0 0 0 0 0 0 0
0
0 1 2 3 4 5 6 7 8 9 10

284
M. Rigo
5.8
Games with a Finite Set of Moves
In the very ﬁrst Example 5.3.1, we were considering a single pile of tokens and
subtraction games where only ﬁnitely many moves are available. Note that Nim
does not belong to this category, one can remove an unbounded number of tokens
(whenever available). In this short section, we introduce ﬁnite subtraction games on
several piles. For one pile, the situation is completely understood [85].
Proposition 5.8.1 Every ﬁnite subtraction game on one pile, i.e., the set I ⊂N of
moves is ﬁnite, has an ultimately periodic Sprague–Grundy function.
Proof This is a classical pigeonhole principle argument. Let m = #I be the
maximal number of options for any position. Hence G(n) ≤m for all n. Let
k = max I. Hence, from position n ≥k, the options are in {n−k, . . . , n−1}. There
are (m+1)k possible k-tuples taking values in {0, . . ., m}. Since G(n) depends only
on G(n −ℓ) for 1 ≤ℓ≤k, hence, by pigeonhole principle, there exist i < j such
that
G(i + n) = G(j + n) for all n ∈{0, . . . , k −1}.
Thus j −i is a period of G with preperiod i.
⊓⊔
Another similar result is given in [85, p. 188].
Proposition 5.8.2 Consider a ﬁnite subtraction game on one pile with I ⊂N as
set of moves. If there exist N ≥0 and p ≥1 such that
G(n + p) = G(n),
∀n ∈{N, . . . , N −1 + max I}
then G(n + p) = G(n) for all n ≥N.
If we may optionally split a pile, the situation is more intricate. It gives rise to the
notion of an octal game which is played with tokens divided into piles. Two players
take turns moving until no moves are possible. The name came from the fact that
the rules are coded by words over {0, . . ., 7}.
Deﬁnition 5.8.3 (Octal Game) Every move consists of selecting just one of the
piles, and either
•
removing all of the tokens in the pile, leaving no pile,
•
removing some but not all of the tokens, leaving one smaller pile, or
•
removing some of the tokens and dividing the remaining tokens into two
nonempty piles.
Piles other than the selected pile remain unchanged. The last player to move wins in
a normal play convention.

5
From Combinatorial Games to Shape-Symmetric Morphisms
285
The coding of an octal game (known as Conway code) is an inﬁnite word
d0 • d1d2d3 · · ·
di ∈{0, . . . , 7}
where di written in base 2 has a ﬁxed 3-digit length, e(i)
2 e(i)
1 e(i)
0
∈{0, 1}3. It gives
the conditions under which i tokens may be removed.
•
if e(i)
0
= 1, then a (full) pile with i tokens can be suppressed;
•
if e(i)
1
= 1, then a pile with n > i tokens can be replaced with a pile with n −i
tokens left;
•
if e(i)
2
= 1, then a pile with n > i + 1 tokens can be replaced with two piles
containing respectively a and b tokens, a, b ≥1, a + b = n −i.
Example 5.8.4 The game of Nim on an arbitrary number of piles is coded by
0 • 3333 · · ·. Indeed, with a leading zero rep2(3) = 011. In general, classical
subtraction games where a pile cannot be split into two piles is coded by a word
over {0, 1, 2, 3}.
A subtraction game is ﬁnite if and only if it is coded by a ﬁnite word (i.e., an
inﬁnite word with only ﬁnitely many non-zero digits), e.g. with a set of moves I =
{3, 5, 6}, the game is coded by 0 • 003033. The game of Example 5.3.1 is coded by
0 • 3303.
Theorem 5.8.5 (Octal Game Periodicity [85]) Consider a ﬁnite octal game coded
by d0 • d1d2 · · · dk with dk ̸= 0. If there exist N ≥0 and p ≥1 such that
G(n + p) = G(n),
∀n with N ≤n < 2N + p + max I
then G(n + p) = G(n) for all n ≥N.
A general open problem is to determine whether all ﬁnite octal games have an
ultimately periodic Grundy function. For instance, 0•07 has period 34 and preperiod
53; 0 • 165 has period 1550 and preperiod 5181; 0 • 106 has period ≃3.1011 and
preperiod ≃4.1011. Up to our knowledge, 0 • 007 has no known periodicity. See
[10, 49, 85].
In view of Proposition 5.8.1, one can conjecture that for a ﬁnite subtraction
game on two (or more) piles of tokens, the Sprague–Grundy function should be
deﬁnable in the Presburger arithmetic ⟨N, +⟩or, equivalently,each value of G should
correspond to a semilinear set in N2. Indeed, this is exactly the situation encountered
when considering generalizations to Nd of Cobham’s theorem (Theorem 5.4.21) to
Cobham–Semenov theorem [17]. See the latter survey for precise deﬁnitions.
Deﬁnition 5.8.6 A set X of Nn is linear if there exist v0, v1, . . . , vk ∈Nn such that
X = v0 + N v1 + · · · + N vk .
The vectors v1, . . . , vk are usually called the periods of X. A set X of Nn is
semilinear if it is a ﬁnite union of linear sets.

286
M. Rigo
The next facts follow from a work in progress with X. Badin De Montjoye,
V. Gledel, V. Marsault and A. Massuir.
Proposition 5.8.7 Every ﬁnite subtraction game on two piles with at most two
moves, has a Sprague–Grundy function deﬁnable in ⟨N, +⟩.
In Fig. 5.21, we have represented G-value 0 in white. Darker points correspond
to higher Grundy values. In this ﬁgure, we have considered two piles of tokens with
the moves α = (2, 1) and β = (3, 5). The reader may notice that α+β is a vector of
period. On the right of Fig. 5.21, we have depicted an example with 3 moves (1, 3),
(3, 1) and (4, 4).
Proof If there is a single move, the result is clear. Assume that we have the
moves α = (α1, α2) and β = (β1, β2). The ﬁrst 2 max(α1, β1) columns of
(G(m, n))m,n≥0 are ultimately periodic. Similarly, the ﬁrst 2 max(α2, β2) rows are
ultimately periodic. We show that α + β is a vector of period. Let x ∈N2 be a
position such that x −α and x −β belong to N2. We will prove that
G(x) = G[x + α + β] .
Assume that G(x) = 0 and G[x+α+β] = 2. From the position x+α+β, we can
either subtract α or β. By deﬁnition of the Grundy function, {G[x +α], G[x +β]} =
{0, 1}. But this contradicts the fact that G(x) = 0; we would have two consecutive
positions x and either x +α or x +β with the same G-value. The reasoning is similar
if we assume that G[x + α + β] = 1.
Assume that G(x) = 1 and G[x + α + β] = 2. From the last equality, we have
{G[x + α], G[x + β]} = {0, 1}. One of these two positions leads directly to x. This
is a contradiction.
Fig. 5.21 First values of G with I = {(2, 1), (3, 5)} (left) and I = {(1, 3), (3, 1), (4, 4)} (right)

5
From Combinatorial Games to Shape-Symmetric Morphisms
287
Assume that G(x) = 1 and G[x + α + β] = 0. These equalities imply that
G[x +α] = G[x +β] = 2. Then, considering the options of these last two positions,
we deduce that G[x + α −β] = G[x + β −α] = 0. Since, G(x) = 1, either
G[x −β] = 0 or, G[x −α] = 0 contradicting the previous equality.
Assume that G(x) = 2 and G[x + α + β] = 0. This implies that G[x + α] =
G[x + β] = 1. Then, considering the options of these two positions, we deduce that
G[x + α −β] = G[x + β −α] = 0. Since, G(x) = 2, then {G[x −β], G[x −α]} =
{0, 1} contradicting the previous equality. The reasoning is similar if we assume that
G[x + α + β] = 1.
⊓⊔
We conjecture that with two piles of tokens and the set of moves
I = {(1, 2), (2, 1), (3, 5), (5, 3), (2, 2)},
the corresponding word (G(m, n))m,n≥0 is not deﬁnable in ⟨N, +⟩. We can therefore
wonder how Proposition 5.8.1 could be generalized to two or more piles of tokens.
5.9
Bibliographic Notes
The link between morphisms and automata which is a cornerstone of this chapter
can already be found in the fundamental work of Cobham [31]. In this chapter, we
did not present the Dumont–Thomas approach relating substitutions to numeration
systems. See [37]. The papers [65, 66] also develop similar constructions. Several
surveys are of interest, see [17] for integer base systems, [71] where connections
with games are also mentioned.
A few papers are dealing with combinatorial games linked with morphic words.
See [34–36, 46, 57]. In particular, Theorem 5.7.14 was proved in [33]. For instance,
we have also considered alterations (adding/removing moves) of the set of moves in
order to keep the same set of P-positions as the original game. We may characterize
moves that can be adjoined without changing the P-positions of Wythoff’s game.
No move is redundant. The notion of invariant game is introduced in [36]. About
Wythoff’s game, see [42] and [45]. For connections between games and Beatty
sequences, see [36] and then [20, 57].
We did not discuss much about the logical characterization of k-automatic
sequences (and generalizations to Pisot systems). See again [17, 24] and also the last
chapter of [73] for a comprehensiveintroduction.Maes’s motivations were primarily
set on decidability of arithmetic theories: which expansions of ⟨N, <⟩by morphic
predicates or automata are decidable? See also [19] where it is shown that for a
morphic predicate P the associated monadic second-order theory MT h⟨N, <, P⟩
is decidable. A trace of abstract numeration system (not mentioned in these terms
at that time) can already be found in Maes’s thesis [64, Rem. 6.9, p. 134]: “The set
of codes of N given by the above automaton is of course a regular language...The
language read by A is 0∗L. However, the above coding is not a numeration system

288
M. Rigo
in the sense of [16]. Indeed, the representation of a natural number is not obtained
using a ‘Euclidean division’ algorithm.”. In some sense, Maes was conjecturing
Theorem 5.7.26 and Proposition 5.7.27: the set of morphic words is equal to the set
of S-automatic words, for some ANS S.
Acknowledgments Even though it was some hard work preparing the lectures and this chapter,
I am quite happy with the ﬁnal result (with this kind of exercise, you always selﬁshly learn a lot
and ask yourself new questions). I therefore warmly thank Professors Shigeki Akiyama and Pierre
Arnoux for their invitation to contribute to this school. I would also like to thank Eric Duchêne
for his constant help when collaborating on game related problems. I also had several colleagues
reading drafts of this chapter: ﬁrst M. Stipulanti and then, E. Duchêne, J. Leroy and A. Parreau.
I thank them all for their feedback. Finally, I thank the anonymous reviewer for his/her careful
reading and many suggestions.
References
1. M.H. Albert, R.J. Nowakowski (eds.), Games of no chance 3, in Mathematical Sciences
Research Institute Publications, vol. 56 (Cambridge University Press, Cambridge, 2009).
Papers from the Combinatorial Game Theory Workshop held in Banff, AB, June 2005
2. M.H. Albert, R.J. Nowakowski, D. Wolfe, Lessons in Play: An Introduction to Combinatorial
Game Theory (A K Peters/CRC Press, 2007)
3. J.-P. Allouche, V. Berthé, Triangle de Pascal, complexité et automates. Bull. Belg. Math. Soc.
Simon Stevin 4(1), 1–23 (1997). Journées Montoises (Mons, 1994)
4. J.-P. Allouche, F. von Haeseler, H.-O. Peitgen, A. Petersen, G. Skordev, Automaticity of
double sequences generated by one-dimensional linear cellular automata. Theoret. Comput.
Sci. 188(1–2), 195–209 (1997)
5. J.-P. Allouche, F. von Haeseler, Peitgen, H.-O., G. Skordev, Linear cellular automata, ﬁnite
automata and Pascal’s triangle. Discrete Appl. Math. 66(1), 1–22 (1996)
6. J.-P. Allouche, J. Shallit, The ring of k-regular sequences. Theoret. Comput. Sci. 98(2), 163–
197 (1992)
7. J.-P. Allouche, J. Shallit, The ubiquitous Prouhet–Thue–Morse sequence, in Sequences and
Their Applications (Singapore, 1998). Springer Series of Discrete Mathematics and Theoretical
Computer Science (Springer, London, 1999), pp. 1–16
8. J.-P. Allouche, J. Shallit, Automatic Sequences, Theory, Applications, Generalizations (Cam-
bridge University Press, Cambridge, 2003)
9. J.-P. Allouche, J. Shallit, The ring of k-regular sequences. II. Theoret. Comput. Sci. 307(1),
3–29 (2003)
10. R.B. Austin, Impartial and Partisan Games. Master’s thesis, Univ. of Calgary (1976)
11. A. Barbé, F. von Haeseler, Limit sets of automatic sequences. Adv. Math. 175(2), 169–196
(2003)
12. C. Berge, The Theory of Graphs (Dover Publications, Mineola, 2001)
13. E.R. Berlekamp, J.H. Conway, R.K. Guy, Winning Ways for Your Mathematical Plays, vol. 1,
2nd edn. (A K Peters, Natick, 2001)
14. U. Blass, A.S. Fraenkel, The Sprague–Grundy function for Wythoff’s game. Theoret. Comput.
Sci. 75(3), 311–333 (1990)
15. C.L. Bouton, Nim, a game with a complete mathematical theory. Ann. Math. 3, 35–39 (1905)
16. V. Bruyère, G. Hansel, Bertrand numeration systems and recognizability. Theoret. Comput.
Sci. 181(1), 17–43 (1997)
17. V. Bruyère, G. Hansel, C. Michaux, R. Villemaire, Logic and p-recognizable sets of integers.
Bull. Belg. Math. Soc. Simon Stevin 1(2), 191–238 (1994)

5
From Combinatorial Games to Shape-Symmetric Morphisms
289
18. A. Carpi, C. Maggi, On synchronized sequences and their separators. Theor. Inform. Appl.
35(6), 513–524 (2002) (2001). A tribute to Aldo de Luca
19. O. Carton, W. Thomas, The monadic theory of morphic inﬁnite words and generalizations. Inf.
Comput. 176, 51–65 (2002)
20. J. Cassaigne, E. Duchêne, M. Rigo, Non-homogeneous Beatty sequences leading to invariant
games. SIAM J. Discret. Math. 30, 1798–1829 (2016)
21. J. Cassaigne, F. Nicolas, Factor complexity, in Combinatorics, Automata and Number Theory.
Encyclopedia of Mathematics and Its Applications, vol. 135 (Cambridge University Press,
Cambridge, 2010), pp. 163–247
22. É. Charlier, T. Kärki, M. Rigo, Multidimensional generalized automatic sequences and shape-
symmetric morphic words. Discret. Math. 310(6–7), 1238–1252 (2010)
23. É. Charlier, J. Leroy, M. Rigo, Asymptotic properties of free monoid morphisms. Linear
Algebra Appl. 500, 119–148 (2016)
24. É. Charlier, N. Rampersad, J. Shallit, Enumeration and decidable properties of automatic
sequences. Internat. J. Found. Comput. Sci. 23(5), 1035–1066 (2012)
25. É. Charlier, M. Rigo, W. Steiner, Abstract numeration systems on bounded languages and
multiplication by a constant. Integers 8, #A35 (2008)
26. Ch. Choffrut, W. Goldwurm, Rational transductions and complexity of counting problems.
Math. Syst. Theory 28(5), 437–450 (1995)
27. Ch. Choffrut, J. Karhumäki, Combinatorics of words, in Handbook of Formal Languages, vol.
1 (Springer, Berlin, 1997), pp. 329–438
28. G. Christol, T. Kamae, M. Mendès France, G. Rauzy, Suites algébriques, automates et
substitutions. Bull. Soc. Math. France 108(4), 401–419 (1980)
29. A. Cobham, On the Hartmanis-Stearns problem for a class of tag machines, in IEEE
Conference Record of 1968 Ninth Annual Symposium on Switching and Automata Theory
(1968), pp. 51–60. Also appeared as IBM Research Technical Report RC-2178, August 23
1968
30. A. Cobham, On the base-dependence of sets of numbers recognizable by ﬁnite automata. Math.
Syst. Theory 3, 186–192 (1969)
31. A. Cobham, Uniform tag sequences. Math. Syst. Theory 6, 164–192 (1972)
32. A. Dress, A. Flammenkamp, N. Pink, Additive periodicity of the Sprague–Grundy function of
certain Nim games. Adv. Appl. Math. 22, 249–270 (1999)
33. E. Duchêne, A.S. Fraenkel, R.J. Nowakowski, M. Rigo, Extensions and restrictions of
Wythoff’s game preserving its P positions. J. Combin. Theory Ser. A 117(5), 545–567 (2010)
34. E. Duchêne, M. Rigo, Cubic Pisot unit combinatorial games. Monatsh. Math. 155(3–4), 217–
249 (2008)
35. E. Duchêne, M. Rigo, A morphic approach to combinatorial games: the Tribonacci case. Theor.
Inform. Appl. 42(2), 375–393 (2008)
36. E. Duchêne, M. Rigo, Invariant games. Theor. Comput. Sci. 411(34–36), 3169–3180 (2010)
37. J.M. Dumont, A. Thomas, Systèmes de numération et fonctions fractales relatifs aux substitu-
tions. Theoret. Comput. Sci. 65 (1989)
38. F. Durand, Cobham’s theorem for substitutions. J. Eur. Math. Soc. 13(6), 1799–1814 (2011)
39. S. Eilenberg, Automata, Languages, and Machines, vol. A (Academic Press [A subsidiary of
Harcourt Brace Jovanovich, Publishers], New York, 1974). Pure and Applied Mathematics,
vol. 58
40. N.P. Fogg, in Substitutions in Dynamics, Arithmetics and Combinatorics, ed. by V. Berthé, S.
Ferenczi, C. Mauduit A. Siegel. Lecture Notes in Mathematics, vol. 1794 (Springer, Berlin,
2002)
41. A.S. Fraenkel, The bracket function and complementary sets of integers. Can. J. Math. 21,
6–27 (1969)
42. A.S. Fraenkel, How to beat your Wythoff games’ opponent on three fronts. Am. Math. Mon.
89(6), 353–361 (1982)

290
M. Rigo
43. A.S. Fraenkel, The use and usefulness of numeration systems, in Combinatorial Algorithms on
Words (Maratea, 1984). NATO Adv. Sci. Inst. Ser. F Comput. Systems Sci., vol. 12 (Springer,
Berlin, 1985), pp. 187–203
44. A.S. Fraenkel, Complexity, appeal and challenges of combinatorial games. Theoret. Comput.
Sci. 313(3), 393–415 (2004). Algorithmic combinatorial game theory
45. A.S. Fraenkel, Euclid and Wythoff games. Discret. Math. 304, 65–68 (2005)
46. A.S. Fraenkel, Complementary iterated ﬂoor words and the Flora game. SIAM J. Discret. Math.
24(2), 570–588 (2010)
47. Ch. Frougny, On the sequentiality of the successor function. Inf. Comput. 139(1), 17–38 (1997)
48. S.W. Golomb, A mathematical investigation of games of “take-away”. J. Combin. Theory 1,
443–458 (1966)
49. R.K. Guy, C.A. Smith, The G-values of various games. Proc. Camb. Philos. Soc. 52, 514–526
(1956)
50. F. von Haeseler, H.-O. Peitgen, G. Skordev, Self-similar structure of rescaled evolution sets of
cellular automata. I. Internat. J. Bifur. Chaos Appl. Sci. Eng. 11(4), 913–926 (2001)
51. J. Honkala, Bases and ambiguity of number systems. Theoret. Comput. Sci. 31(1–2), 61–71
(1984)
52. J. Honkala, On unambiguous number systems with a prime power base. Acta Cybernet. 10(3),
155–163 (1992)
53. J. Honkala, On the simpliﬁcation of inﬁnite morphic words. Theoret. Comput. Sci. 410(8–10),
997–1000 (2009)
54. G. Katona, A theorem of ﬁnite sets, in Theory of Graphs (Proceedings of the Colloquium
Tihany, 1966) (Academic Press, New York, 1968), pp. 187–207
55. Krebs, T.J.P.: A more reasonable proof of Cobham’s theorem. CoRR abs/1801.06704 (2018).
http://arxiv.org/abs/1801.06704
56. H.A. Landman, More games of no chance, in Chap. A Simple FSM-Based Proof of the Additive
Periodicity of the Sprague–Grundy Function of Wythoff’s Game (Cambridge University Press,
Cambridge, 2002)
57. U. Larsson, P. Hegarty, A.S. Fraenkel, Invariant and dual subtraction games resolving the
Duchêne–Rigo conjecture. Theoret. Comput. Sci. 412(8–10), 729–735 (2011)
58. M.V. Lawson, Finite Automata (Chapman & Hall/CRC, Boca Raton, 2004)
59. P. Lecomte, M. Rigo, Abstract numeration systems, in Combinatorics, Automata and Number
Theory. Encyclopedia of Mathematics and its Applications, vol. 135 (Cambridge University
Press, Cambridge, 2010), pp. 108–162
60. P.B.A. Lecomte, M. Rigo, Numeration systems on a regular language. Theory Comput. Syst.
34(1), 27–44 (2001)
61. J. Leroy, M. Rigo, M. Stipulanti, Generalized Pascal triangle for binomial coefﬁcients of words.
Adv. in Appl. Math. 80, 24–47 (2016)
62. M. Lothaire, in Combinatorics on Words. Cambridge Mathematical Library (Cambridge
University Press, Cambridge, 1997)
63. M. Lothaire, in Algebraic Combinatorics on Words. Encyclopedia of Mathematics and its
Applications, vol. 90 (Cambridge University Press, Cambridge, 2002)
64. A. Maes, Morphic predicates and applications to the decidability of arithmetic theories. Ph.D.
thesis, UMH Univ. Mons-Hainaut (1999)
65. V. Marsault, J. Sakarovitch, The signature of rational languages. Theoret. Comput. Sci. 658,
216–234 (2017)
66. V. Marsault, J. Sakarovitch, Trees and languages with periodic signature. Indag. Math. 28(1),
221–246 (2017)
67. R.J. Nowakowski (ed.), Games of no chance 4, in Mathematical Sciences Research Institute
Publications, vol. 63 (Cambridge University Press, New York, 2015). Selected papers from
the Banff International Research Station (BIRS) Workshop on Combinatorial Games held in
Banff, AB, 2008
68. K. O’Bryant, Fraenkel’s partition and brown’s decomposition. Integers 3 (2003)

5
From Combinatorial Games to Shape-Symmetric Morphisms
291
69. D. Perrin, Finite automata, in Handbook of Theoretical Computer Science, vol. B (Elsevier,
Amsterdam, 1990), pp. 1–57
70. M. Rigo, Generalization of automatic sequences for numeration systems on a regular language.
Theoret. Comput. Sci. 244(1–2), 271–281 (2000)
71. M. Rigo, Numeration systems: a link between number theory and formal language theory, in
Developments in Language Theory. Lecture Notes in Computer Science, vol. 6224 (Springer,
Berlin, 2010), pp. 33–53
72. M. Rigo, Formal Languages, Automata and Numeration Systems 1. (ISTE/ Wiley, Lon-
don/Hoboken, 2014). Introduction to Combinatorics on Words, With a foreword by Valérie
Bethé
73. M. Rigo, Formal Languages, Automata and Numeration Systems 2. Networks and Telecommu-
nications Series (ISTE/ Wiley, London/Hoboken, 2014). Applications to recognizability and
decidability, With a foreword by Valérie Berthé
74. M. Rigo, Advanced graph theory and combinatorics, in Networks and Telecommunications
Series. ISTE, London (Wiley, Hoboken, 2016)
75. M. Rigo, A. Maes, More on generalized automatic sequences. J. Autom. Lang. Comb. 7(3),
351–376 (2002)
76. M. Rigo, L. Waxweiler, A note on syndeticity, recognizable sets and Cobham’s theorem. Bull.
Eur. Assoc. Theor. Comput. Sci. EATCS 88, 169–173 (2006)
77. E. Rowland, Binomial coefﬁcients, valuations, and words, in Developments in Language
Theory. Lecture Notes in Computer Science, vol. 10396 (Springer, Berlin, 2017), pp. 68–74
78. E. Rowland, R. Yassawi, A characterization of p-automatic sequences as columns of linear
cellular automata. Adv. in Appl. Math. 63, 68–89 (2015)
79. J. Sakarovitch, Elements of Automata Theory (Cambridge University Press, Cambridge, 2009)
80. P.V. Salimov, On uniform recurrence of a direct product. Discret. Math. Theoret. Comput. Sci.
12, 1–8 (2010)
81. O. Salon, Suites automatiques à multi-indices et algébricité. C. R. Acad. Sci. Paris Sér. I Math.
305(12), 501–504 (1987)
82. O. Salon, Suites automatiques à multi-indices, in Séminaire de Théorie des Nombres de
Bordeaux (1986/1987), pp. 4.01–4.27. Followed by an appendix by J. Shallit
83. J. Shallit, A Second Course in Formal Languages and Automata Theory (Cambridge University
Press, Cambridge, 2008)
84. J.O. Shallit, A generalization of automatic sequences. Theoret. Comput. Sci. 61, 1–16 (1988)
85. A.N. Siegel, in Combinatorial Game Theory. Graduate Studies in Mathematics, vol. 146
(American Mathematical Society, Providence, 2013)
86. T.A. Sudkamp, Languages and Machines: An Introduction to the Theory of Computer Science
(Addison-Wesley, Reading, 2006)
87. W.A. Wythoff, A modiﬁcation of the game of nim. Nieuw Arch. Wiskd. 7, 199–202 (1907)
88. É. Zeckendorf, Représentation des nombres naturels par une somme de nombres de Fibonacci
ou de nombres de Lucas. Bull. Soc. Roy. Sci. Liège 41, 179–182 (1972)

Chapter 6
The Undecidability of the Domino
Problem
Emmanuel Jeandel and Pascal Vanier
Abstract One of the most fundamental problems in tiling theory is to decide, given
a surface, a set of tiles and a tiling rule, whether there exists a way to tile the
surface using the set of tiles and following the rules. As proven by Berger (The
Undecidability of the Domino Problem. Ph.D. thesis, Harvard University, 1964) in
the 1960s, this problem is undecidable in general. When formulated in terms of
tilings of the discrete plane Z2 by unit tiles with colored constraints, this is called the
Domino Problem and was introduced by Wang (Bell Syst Tech J 40:1–41, 1961) in
an effort to solve satisfaction problems for ∀∃∀formulas by translating the problem
into a geometric problem. There exist a few different proofs of this result. The most
well-known proof is probably the proof by Robinson (Invent Math 12(3):177–209,
1971) which is a variation on the proof of Berger. A relatively new proof by Kari
(Machines, computations, and universality (MCU). vol. 4664, 2007, pp. 72–79) has
some nice ramiﬁcations for tilings of surfaces and groups. In terms of ingredients,
one can divide the proofs in 4 categories. The remaining two categories are given
by the proof of Aanderaa and Lewis (J Symb Log 39(3):519–548, 1974) and the
ﬁxed point method of Durand et al. (J Comput Syst Sci 78(3):731–764 , 2012). In
this course, we will give a brief description of the problem and to the meaning of
the word “undecidable”, and then give the four different proofs. As we will explain,
the undecidability of the Domino Problem has as a consequence the existence of an
aperiodic tileset. All four sections will be organized in such a way that the interested
reader can ﬁrst extract from the proof the aperiodic tileset into consideration, before
we go into more details to actually prove the undecidability of the problem.
E. Jeandel ()
Université de Lorraine, CNRS, Inria, LORIA, Nancy, France
e-mail: emmanuel.jeandel@loria.fr
P. Vanier
Laboratoire d’Algorithmique, Complexité et Logique Université de Paris-Est, LACL, UPEC,
Créteil, France
e-mail: pascal.vanier@lacl.fr
© The Editor(s) (if applicable) and The Author(s), under exclusive license
to Springer Nature Switzerland AG 2020
S. Akiyama, P. Arnoux (eds.), Substitution and Tiling Dynamics: Introduction
to Self-inducing Structures, Lecture Notes in Mathematics 2273,
https://doi.org/10.1007/978-3-030-57666-0_6
293

294
E. Jeandel and P. Vanier
6.1
Statement and Consequences
6.1.1
Deﬁnitions and Statement
Deﬁnition 6.1.1 (Wang [51]) Let C be a ﬁnite set, called the set of colors. A Wang
tile t over C is a map from {N, S, E, W} to C.
A tileset τ is a ﬁnite set of Wang tiles.
A ﬁrst example is given in Fig. 6.1. C can be thought as a set of colors, patterns,
symbols or integers.
Deﬁnition 6.1.2 Let P ⊆Z2, a coloring x of support P assigns to each element of
P a tile of τ. When P = Z2, x is a conﬁguration.
A tiling of P by τ assigns to each element of P a tile from τ such that colors of
adjacents tiles agree on their common border. Formally, a tiling is a map x : P →τ
such that:
•
If (i, j) ∈P and (i + 1, j) ∈P then x(i, j)(E) = x(i + 1, j)(W)
•
If (i, j) ∈P and (i, j + 1) ∈P then x(i, j)(N) = x(i, j + 1)(S)
When P = Z2, it is a tiling of the plane. We say that τ tiles P if there exists a tiling
of P by τ.
An example of a tiling of a ﬁnite set by the tileset τ of Fig. 6.1 is given in Fig. 6.2.
Although this particular tileset, as evidenced by the ﬁgure, can be used to tile a
large rectangle, it turns out that it doesn’t tile the entire plane. In fact, it cannot tile a
square of size 15. In general, knowing if a tileset τ tiles the plane is a hard problem:
Theorem 6.1.3 (Berger [7]) There is no algorithm that, given a set of Wang tiles
τ, decides if τ tiles the plane.
In the rest of these notes, we will explain what this theorem means, and how to
prove it.
6.1.2
Algorithmic Consequences
In this section, we want to investigate what the theorem of Berger actually means in
practice when one studies tilings.
0
0
0
2
0
1
0
1
0
2
1
0
1
0
0
0
1
1
2
1
2
1
1
0
2
2
0
1
Fig. 6.1 A tileset τ1 composed of 7 tiles

6
The Undecidability of the Domino Problem
295
2
0
0
0
0
1
0
2
1
0
0
1
0
1
0
2
1
0
0
1
0
1
2
1
1
2
1
1
2
0
0
0
0
1
0
2
1
0
0
1
2
0
0
0
0
0
1
0
0
0
1
0
0
0
1
0
0
0
1
0
0
1
0
2
1
0
0
1
0
0
1
0
0
0
1
0
0
0
1
0
0
0
1
0
0
1
2
1
1
0
0
1
0
1
2
1
1
2
1
1
2
0
0
0
0
0
1
0
0
1
2
1
1
0
0
1
0
1
2
1
0
1
2
1
1
0
2
2
0
0
1
0
0
1
0
2
1
0
0
1
0
0
1
0
0
1
2
1
1
0
2
2
0
0
1
0
0
1
0
2
1
0
2
2
0
1
0
2
1
0
0
1
0
0
1
0
0
0
1
0
0
1
2
1
1
0
2
2
0
1
0
2
1
0
0
1
0
0
1
0
1
0
2
2
0
0
1
0
0
0
1
0
0
1
2
1
1
0
0
1
0
1
0
2
1
0
2
2
0
0
1
0
0
0
1
0
0
1
2
1
0
1
0
2
1
0
0
1
0
1
2
1
1
0
2
2
0
0
1
0
0
0
1
0
0
1
0
2
1
0
0
1
0
1
2
1
1
0
2
2
0
0
1
0
0
0
1
0
0
1
0
2
1
0
2
2
0
1
2
1
1
0
0
1
0
0
1
0
0
0
1
0
0
1
0
2
1
0
2
2
0
1
2
1
1
2
1
1
2
0
0
0
0
1
0
2
1
0
2
2
0
0
1
0
0
1
2
1
1
2
1
1
2
0
0
0
0
1
0
2
0
1
0
2
1
0
0
1
0
0
1
0
0
0
1
0
0
1
0
2
1
0
0
1
0
1
0
2
1
0
0
1
0
0
1
0
0
0
1
0
Fig. 6.2 A tiling of a ﬁnite rectangle by τ1
Let τ be a set of Wang tiles. τ falls in three different cases:
•
τ does not tile the plane
•
τ tiles the plane, and a periodic tiling by τ exists
•
τ tiles the plan, but no periodic tiling exists. We will say that τ is aperiodic.
There are various possible deﬁnitions of what a periodic tiling is, but they are all
equivalent in our case. We will say that a tiling x is periodic if there exists p s.t
x(i, j) = x(i mod p, j mod p).
From the algorithmic point of view, it is easy to see if τ does not tile the plane.
Indeed
Proposition 6.1.4 (Compactness (Folklore)) τ tiles the plane iff for all n, the
tileset τ tiles a square of size n × n.
This proposition gives us an algorithm to prove that τ does not tile the plane: For all
n, ﬁnd a way to tile with τ an n × n square. If it is not possible for one value of n,
then accept.

296
E. Jeandel and P. Vanier
The second case of the trichotomy is also easy to test algorithmically: For all n,
try to ﬁnd a way to tile a n×n square in a periodic manner. If this succeeds for some
n, then accept.
As the Domino Problem is undecidable, this means there is no algorithm to test
for the third case: Indeed, combining the three algorithms together would solve the
Domino Problem. Intuitively, this means that there exists aperiodic tilesets τ for
which we cannot prove that they are aperiodic. This intuition is made a bit more
precise if we look at what Berger proved exactly:
Theorem 6.1.5 (Berger [7]) We can transform effectively any program p into a
tileset τ s.t.
•
If p halts, then τ does not tile the plane.
•
If p does not halt, then τ tiles the plane aperiodically.
It is well known that no algorithm can decide if a program halts (see Theorem 6.2.4
for a proof), and therefore this theorem implies the undecidability of the Domino
problem. It also means in terms of provability that, starting from a program that
tries to prove some mathematical statement P, we could build a tileset τ s.t. proving
that τ is aperiodic is equivalent to proving the property P.
Berger’s theorem tells us that we cannot decide whether a set τ tiles the plane.
However, it doesn’t say anything about what the tilings, if they exist, look like.
Recall that Berger’s proof, starting from a program p, builds a set of tiles τ s.t. τ
tiles the plane iff p does not halt. It turns out that the tilings by τ, if they exist, are
easy to build: There exists a tiling x by τ and a program that on input (n, m) outputs
in ﬁnite time the tile of x at position (n, m). This program doesn’t even need to
know if there exists a tiling by τ: If no such tiling exists, it will output “error” for
some value of n and m.
The situation as described by Berger is therefore not as hopeless as it could be.
Later results show however that there exist tilesets that are much more complicated
that the ones Berger built.
Theorem 6.1.6 (Hanf–Myers [21, 41]) There exists a tileset τ s.t. tilings by τ exist
but no tilings by τ can be produced by a program.
We also mention the following curiosity:
Theorem 6.1.7 (Levin [35]) There exists a tileset τ s.t.:
•
Tilings by τ exist
•
No tilings by τ can be produced by a program.
•
There exists a probabilistic program (i.e. with a random coin) that will produce
a tiling by τ with probability at least 1/2
The constant 1/2 can be replaced by 1 −ϵ for any ϵ > 0. This result is stated in
[35] but no formal proof is given. One could obtain the result using e.g. the results
of Simpson [49] and some basic notions of algorithmic randomness theory.

6
The Undecidability of the Domino Problem
297
6.1.3
Algorithms to Prove A Tileset Does Not Tile the Plane
While the theorem of Berger prevents any algorithm to succeed in deciding that a
tileset tiles the plane in the general case, it is still interesting to ﬁnd algorithms that
can do it in particular cases. As evidenced by the previous discussion, the easy part
is to prove that a tileset does not tile the plane: it is sufﬁcient to ﬁnd an integer N
s.t. no tilings of a square of size N exists.
From the point of view of complexity, better algorithms exist and we will
investigate them in this section. Of course, none of these algorithms work: Some
of them will not always terminate, some of them may answer “I don’t know”.
6.1.3.1
The First Algorithm
An easy algorithm is therefore to test, for all N, if there exists a tiling of a square
of size N × N. While this is the easiest algorithm to describe, it is not easy to
implement in a reasonable manner. It is important for this algorithm to not only test
if there exists a tiling of a square of size N × N, but to enumerate all of them: This
information will indeed be useful when trying to tile squares of size (N +1)×(N +
1): it sufﬁces to take all squares of size N × N and to ﬁnd all ways of completing
them into squares of bigger sizes.
Of course there might be a large number of possible tilings: If we denote by |τ|
the number of tiles of τ, we see that we can have at most |τ|N×N tilings of a N × N
square. This means generating all of them might be costly, and that our algorithm
will be of complexity 2O(N2)). We can do a bit better by realizing that we do not
need to know what the tilings of the square look like, but only what they look like
on the border. Indeed, the only information we need to complete a tiling of a N ×N
square into a tiling of a (N + 1) × (N + 1) square is the colors on the border of
the square. Doing this reduces the complexity of the whole operation to 2O(N). See
Fig. 6.3 for an example.
For the tileset τ1 of Fig. 6.2, it can be proven that there is no tiling of a 15 × 15
square, so that the tileset τ1 indeed does not tile the plane.
Fig. 6.3 As the two
colorings have the same
border, they can be
considered to be equal when
listing all tilings of a 2 × 2
square
1
0
0
0
2
1
1
0
2
2
0
1
2
2
0
1
1
0
0
0
2
1
1
2
2
1
2
1
1
2
0
1

298
E. Jeandel and P. Vanier
6.1.3.2
Graphs and Automata
It is possible for a tileset τ to tile a square of size N × N but for it to not even tile
an entire row. We might expect therefore better results by looking at tilings of N
consecutive rows rather than tilings of squares. Before explaining how this can be
done, we remark the following:
Proposition 6.1.8 Let τ be a tileset consisting of q = |τ| Wang tiles.
If τ tiles a horizontal strip of height N, τ tiles a square of size N × N.
If τ tiles a square of size N × N, it tiles a horizontal strip of height ⌊logq N⌋.
Proof The ﬁrst statement is obvious. For the second statement, suppose that τ tiles
a square of size N × N. In particular, τ tiles a rectangle of height ⌊logq N⌋and
length N.
We look at each column of colors we see inside this rectangle. As the rectangle
is of length N, there are N + 1 different positions. As the rectangle is of height
⌊logq N⌋, at most q⌊logq N⌋< N + 1 different associations of color can appear.
By the pigeonhole principle, some column of colors appear at least twice. We
can therefore obtain a tiling of an horizontal strip by repeating periodically a
subrectangle. See Fig. 6.4.
The bound we obtain is not tight.
It remains to explain how to test efﬁciently if there is a tiling of a horizontal strip
of height N.
The key is to represent the tileset as a ﬁnite automaton (more accurately ﬁnite
transducers). The representation is as follows: The states of our ﬁnite automaton are
the colors C. For each tile t ∈τ, there is an edge from t[W] to t[E] labelled with
(t[S], t[N]).
Figure 6.5 represents τ1 as an automaton. In this representation, it is easy to see
if τ1 tiles a inﬁnite strip of height 1. Indeed, an inﬁnite strip of height 1 represents
one (biinﬁnite) run of the automaton.
Proposition 6.1.9 τ1 tiles an inﬁnite strip of height 1 iff the automaton that
represents τ1 has a directed cycle.
1
0
2
2
0
1
0
2
1
0
0
1
0
0
1
0
0
0
1
0
0
1
2
1
1
0
2
2
0
1
0
2
1
0
0
1
0
0
1
0
1
0
2
2
0
0
1
0
0
0
1
0
0
1
2
1
1
0
0
1
0
1
0
2
1
0
2
2
0
0
1
0
0
0
1
0
0
1
2
1
Fig. 6.4 This rectangle of large width contains (by pigeonhole) a smaller rectangle (in bold) with
the same colors on the east side and the west side. This rectangle can be used in a periodic fashion
to obtain a tiling of a horizontal strip of height 2

6
The Undecidability of the Domino Problem
299
0
0
0
2
0
1
0
1
0
2
1
0
1
0
0
0
1
1
2
1
2
1
1
0
2
2
0
1
1
0
0,0
1,2
2,0
1,0
2
0,1
0,1
1,0
Fig. 6.5 The tileset τ1 and its representation as an automaton. The bold (resp. dashed) transition
correspond to the bold (resp. dashed) tile
A strip of height 2 represents therefore two inﬁnite runs of the automaton, s.t.
the north labels of the automaton at the bottom agree with the south labels of the
automaton on top. This suggest the following deﬁnition:
Proposition 6.1.10 Let A and B be two automata, with states QA and QB. The
product of A and B is the automaton with states QA × QB where there is an edge
from (qa, qb) to (q′
a, q′
b) labeled (sa, nb) iff there is a color c and an edge from qa
to q′
a labeled (sa, c) in A and an edge from qb to q′
b labeled (c, nb) in B.
Intuitively, A is the automaton on the bottom and B the automaton on the top.
An example is given in Fig. 6.6. Let A be the automaton corresponding to the
tileset τ and An its n-times composition. Intuitively, an edge in An corresponds to a
well-tiled pattern of size 1 × n, as shown in the ﬁgure for n = 2. As a consequence,
a path in An exists iff τ tiles an inﬁnite strip of height n.
We therefore obtain again an algorithm to semi-test if a tileset tiles the plane by
computing An for all values of n.
In terms of efﬁciency, it is easy to see that we obtain a complexity similar to
the previous algorithm, although we are actually testing for a stronger property. Of
course, one can do this both in the vertical and the horizontal direction. Doing this
we can prove that τ1 does not tile a vertical strip of width 8, although it can tile a
14 × 14 square.
The main interest however is in the fact that translating the problem into the
theory of automata means we can use all the tools available in the theory of
automata. Indeed, the translation of the fact that τ tiles the plane is about the iteration
of the automaton A, which makes it clear that it doesn’t really depend on τ, but
on the language of inﬁnite words encoded by τ. In particular, we can minimize in
some way the automaton A (and actually all the automata An) under consideration,
without changing the problem. We leave [26] as an additional reference about ﬁnite
automata. These techniques have been used successfully to prove that the smallest
aperiodic tileset has 11 tiles [27].

300
E. Jeandel and P. Vanier
1
0
0
0
2,0
0
1
1,0
1
2
0,2
2
0
2,1
2
1
1,1
0,0
0,1
1,0
2,1
1
1
1,1
2
2
0,0
0,1
0,0
0,2
0
2
1,0
0,0
1,1
0,0
1,1
2
1
1
0
1
0
0
0
Fig. 6.6 The composition of the automaton corresponding to τ1 with itself. The bold edge
correspond to the bold and dashed edges in the previous picture, and to the 2 × 1 pattern on
the bottom left
6.1.3.3
A Semi-Algorithm Based on the Anderson–Putnam Complex
We will brieﬂy present here a method that can prove, in some cases, that a tileset τ
does not tile the plane without even trying to tile a square with τ.
This method is based on the Anderson-Putnam complex and its second singular
homology group, and can be transformed into an “iff” condition [10]. However, we
will use here a down to earth approach.
To understand the idea, ﬁrst suppose that τ has a periodic tiling, say, τ tiles a
square of size p × p.

6
The Undecidability of the Domino Problem
301
Let c ∈C be a color that can appear horizontally. If we look at a square that
is tiled periodically by τ, it is obvious that in this square the color c should appear
exactly the same number of times on the east side as on the west side. If we denote
by xi the number of times the i-th tile of τ appear, this gives us an equation relating
all tiles that contain the color c:
Deﬁnition 6.1.11 Let τ = {t1 . . . tn} be a tileset. Let x1 . . . xn be n real variables,
where xi is associated to the tile ti of τ.
Let c be a color.
The horizontal equation for c is the equation:

ti∈E(c)
xi =

ti∈W(c)
xi
where E(c) is the set of all tiles that have the color c in their east side, and W(c) the
set of all tiles that have the color c in their west side.
We deﬁne similarly the vertical equation for c.
Basically the horizontal equation for c states that the number of times the color
c appear somewhere on the east side in the periodic tiling should be equal to the
number of times c appear on the west side.
Rather than considering the number of times the tiles appear, we will consider
their density. We therefore have an additional equation, stating that the sum of all
densities should be one:
Deﬁnition 6.1.12 The set of equations for τ is the combination of all horizontal
equations, all vertical equations, and the unit equation:

i
xi = 1
Proposition 6.1.13 If τ tiles a square periodically, then the set of equations for τ
has a nonnegative solution.
Proof Take xi to be the density of the tile ti.
What is interesting is that this is actually true more generally:
Proposition 6.1.14 If τ tiles the plane, then the set of equations for τ has a
nonnegative solution.
This is true even if τ has no periodic tiling.
Proof Suppose that τ tiles the plane. Let n ∈N. By hypothesis, τ tiles an n × n
square. Let pi,n be the number of times the tile ti appear in this square and xi,n =
pi,n/n2 the density of the tile ti.
The unit equation is obviously satisﬁed by the xi,n.

302
E. Jeandel and P. Vanier
Let c be a color. It is easy to see that

ti∈E(c)
pi,n −

ti∈W(c)
pi,n = O(n)
Indeed the difference between these quantities is bounded by the number of times
the color c appear in the border of the square.
We therefore get

ti∈E(c)
xi,n −

ti∈W(c)
xi,n = O
1
n

We now extract from the sequence (xi,n)n∈N ∈[0, 1]|τ| a converging subsequence
to get the result.
In our proof we see that the solution xi we obtain to the system of equations is the
limit of densities. Using more complex results from ergodic theory, we can prove
that we can take xi to actually be the density of the tile ti in a speciﬁc tiling of the
plane.
This is of course only a necessary condition for τ to tile the plane. Let’s look for
example at the tileset τ1 from Fig. 6.2.
We obtain the following set of equations:
x1 + x2 + x3 = x1 + x4
(6.1)
x4 + x5 = x2 + x5 + x6
(6.2)
x6 + x7 = x3 + x7
(6.3)
x1 + x2 + x4 + x7 = x3 + x4 + x6
(6.4)
x3 + x6 = x2 + x5 + x7
(6.5)
x5 = x1
(6.6)
x1 + x2 + x3 + x4 + x5 + x6 + x7 = 1
(6.7)
The ﬁrst three equations are the horizontal equations, the following three equations
correspond to the vertical constraints.
Even though τ1 does not tile the plane, the system admits solutions. Among them,
there is for example: x3 = x4 = x6 = 1/5 and x7 = 2/5, the other variables being 0.
This solution corresponds to the tiling of the pattern in Fig. 6.7. Each color appear
the same number of times in the east and west side of this ﬁgure, but this pattern
cannot be used to tile the plane periodically. However, it can be used to tile some
surface: Just glue the north side and the south side of the pattern together and do
the same in the east and west side. One can prove that solutions of the system of
equations can always be used to tile some surface but that the genre of the surface

6
The Undecidability of the Domino Problem
303
Fig. 6.7 A tiling of a ﬁnite
pattern by τ1 where colors
appear the same number of
times in the east (resp. north)
side and the west (resp.
south) side
0
2
1
0
1
0
0
0
2
1
1
0
2
2
0
1
2
2
0
1
will have to grow linearly in the number of tiles if the tileset τ does not have a tiling.
This is in essence the result of [10].
6.2
Main Ingredients in the Proofs
There are basically four vastly different proofs of the undecidability of the Domino
Problem: The proof by Berger [7, 8] later simpliﬁed by Robinson [47], the proof by
Aanderaa and Lewis [1], best presented in the book of Lewis [36], the proof by Kari
[32], and the proof by Durand, Romashchenko and Shen [14]. All other proofs of
the result the authors are aware of can be roughly characterized as variants of the
construction of Berger.
It is interesting to note that Kari’s proof relies on the proof by Hooper [25] of the
undecidability of the immortality problem of Turing machines (more on this later).
As a consequence, three of the different proofs were obtained by, or use results
of, PhD students of Hao Wang (Robert Berger, Philip Hooper and Stål Aanderaa),
working on the undecidability of the ∀∃∀fragment of ﬁrst order logic.
We will focus in this section on the common elements in all the proofs. First,
there is a need to deﬁne precisely what it is meant by “undecidable”, for which we
need a formal deﬁnition of an algorithm (or a program). Then we will prove the
undecidability of the ﬁxed domino problem, which is the ﬁrst brick in most of the
proofs. We will then explain why the previous proof cannot be adapted directly to
obtain the main result, and what is needed to accomplish it.

304
E. Jeandel and P. Vanier
6.2.1
Turing Machines
The theorem by Berger states that no algorithm can decide, starting from a set of
Wang tiles τ, if τ tiles the plane.
To prove such a theorem, one needs a formal deﬁnition of a program. Since 1930,
various equivalent deﬁnitions, due to Church, Turing or Herbrand–Gdel [11, 34, 50]
have been given.
For our purpose, the deﬁnition by Turing will be the most suitable, although some
results have been obtained [33] using the concept of 2-counter machines introduced
by Minsky [39].
We refer the reader to [37, 39, 44] for more information about Turing machines.
The book [26] offers in particular an introduction to both Turing machines and ﬁnite
automata.
A Turing machine is a formal deﬁnition of a computation device. This device
takes as input a word in some given alphabet, and outputs, after several steps, a
word in some other alphabet.
The machine uses the concept of a tape, which is an inﬁnite or biinﬁnite array
of cells. Each position of the cell contains a symbol, and one speciﬁc position of
the tape is marked by the head. The Turing machine makes a decision at each step
depending on the symbol it can read on the tape at the position of the head, and its
internal state. Based on these informations, the machine can shift the position of the
head, change the symbol of the tape, and change its internal state.
Deﬁnition 6.2.1 A Turing machine is given by:
•
A ﬁnite set of states Q. One distinguishes in Q a speciﬁc state q0 ∈Q, called the
initial state, and two special states qa, qr, the accepting and refusing state.1
•
An input alphabet Σ
•
A work alphabet Γ ⊃Σ, it contains a special symbol B (not present in Σ),
called the blank symbol.
•
A transition function: δ : Γ × Q →Γ × Q × {−1, 1}
Intuitively δ(a, q) = (b, q′, d) means that, if the Turing machine reads the
symbol a on its head and is currently in state q, then it will write the symbol b
instead of a, change its internal state to q′, and move its head in direction d.
The transition function is best depicted with a graph. Vertices represent states of
the machine, and there is an edge from q to q′ labeled with a/b, d if δ(a, q) =
(b, q′, d). It is also customary to write +1, −1 as →and ←as they denote
movement of the head.
An example of a Turing machine is given in Fig. 6.8. The machine works as
follows: we ﬁrst write the input on the tape (see the ﬁrst row of Fig. 6.9). The Turing
1The set of states is called Q rather than S for some forgotten historical reason. Alan M. Turing
uses the vocabulary “conﬁguration” rather than “state”, but the word “state” has become more
common nowadays.

6
The Undecidability of the Domino Problem
305
Fig. 6.8 An example of a Turing machine. The initial state is q0 = 0. The accepting state is state
qa = B
machine starts with initial state q0. At each step, the Turing machine looks at its
internal state and the symbol at the position of the head. The transition function
then tells us what symbol should be written at the position of the head, and what is
the new state and the new position of the head. Figure 6.9 contains the ﬁrst steps of
the execution of a Turing Machine.

306
E. Jeandel and P. Vanier
Fig. 6.9 The ﬁrst 15 steps of
the Turing machine of
Fig. 6.8 on input 11
B
1
1
B
B
B
B
B
B
B
0
B
1
1
B
B
B
B
B
B
B
1
B
0
1
B
B
B
B
B
B
B
6
B
0
1
B
B
B
B
B
B
B
9
B
0
1
0
B
B
B
B
B
B
8
B
0
1
0
1
B
B
B
B
B
A
B
0
1
0
1
B
B
B
B
B
A
B
0
1
0
1
B
B
B
B
B
A
B
0
1
0
1
B
B
B
B
B
A
B
0
1
0
1
B
B
B
B
B
1
B
0
1
0
1
B
B
B
B
B
2
B
0
1
0
1
B
B
B
B
B
2
B
0
1
0
1
B
B
B
B
B
2
B
0
1
0
1
B
B
B
B
B
2
B
0
1
0
1
B
B
B
B
B
3
Deﬁnition 6.2.2 An instantaneous description (also called a conﬁguration) is a
tuple w = (c, h, q) ∈Γ Z × Z × Q. The content of the tape is represented by
c, while h contains the position of the head on the tape, and q the internal state of
the machine.
For w = (c, h, q) an ID, the successor of w is the ID w′ = (c′, h′, q′) deﬁned
by:
•
Let δ(ch, q) = (b, q′, d)
•
c′
j = cj for j ̸= h and c′
h = b.
•
h′ = h + d

6
The Undecidability of the Domino Problem
307
We write M(w) for the successor of w and Mn(w) is deﬁned in the usual way.
Deﬁnition 6.2.3 Let M be a Turing machine.
Let u be a word. The initial ID is wu = (c, h, q) where
•
ci+1 = ui when it make sense and ci = B otherwise (the word u is represented
on the tape, starting at position 1.
•
h = 0 (The head is initially at position 0)
•
q = q0 (The initial state is q0).
We say that u is accepted if there exists n s.t. Mn(wu) = (c′, h′, qa). We say
that a Turing machine accepts a language L if on every input the Turing machine
eventually reaches either the accepting state qa or the rejecting state qr, and L is
exactly the set of accepted words.
Notice that there are three possible behaviours of a Turing machine on input u:
Either it eventually reaches the accepting or the rejecting state, or it keeps running
forever.
If the Turing machine is deﬁned with an inﬁnite array of cells rather than an
biinﬁnite array (i.e. conﬁgurations are in Γ N × N × Q), a fourth possibility arises:
the Turing machine may try to go left when the head is in the leftmost cell, in which
case it crashes. It is easy to impose safeguards so that the last case never happens.
If we look at what is written on the tape of the Turing machine when it reaches an
accepting state, we can deﬁne a function computed by a Turing machine. We leave
the details to the reader.
A ﬁrst example of a Turing machine is depicted on Fig. 6.8, with the ﬁrst 15 steps
of the machine represented in Fig. 6.9.
This machine has not been chosed arbitrarily, and we can explain what it does.
The input of the machine has to be understood as an integer coded in binary, written
from least to most signiﬁcant bit, i.e. the integer 6 is written 011. The state 1 has
two different outgoing transitions, depending on whether the ﬁrst symbol is a 0 or a
1. This means we have two different behaviours depending if the integer is even or
odd.
We will ﬁrst focus on the case where the integer is even. When in state 2, the
head keeps going right, until it reaches the end of the word (state 3) and then we go
to state 4 or 5 depending on the last symbol. States 4 and 5 essentially shift the input
to the left. This means replacing each symbol with the symbol previously seen; the
state 4 (resp. 5) means the previously seen symbol was a 0 (resp. 1). When we reach
the begining of the word, we go again to state 1. We have said that, if an integer
is even, we will delete its ﬁrst bit, meaning that states 2 to 5 essentially divide an
integer by 2.
States 7, 8, 9 basically multiply an integer by 3. Multiplying an integer by 3 in
binary may produce a carry of value 0, 1 and 2, which correspond respectively to the
three states 7, 8, 9. As an example, suppose the carry is currently 1, and the integer
to multiply by 3 begins with a 1. As 3 × 1 + 1 = 0 + 2 × 2, this means the ﬁrst
bit of the output should be a 0 and our new carry is equal to 2. This corresponds
to the transition from state 8 to state 9. The state 6 is essentially there to kickstart

308
E. Jeandel and P. Vanier
the process, and detect if the output is the integer 1. The state A rewinds the head
so that it is again at the initial position. In other words, states 6 to A, starting from
an integer n, produces the integer 3n + 1, except if n = 1 in which case the Turing
machine stops.
As a whole, our Turing Machine is essentially mimicking the Collatz sequence:
Starting from an integer n written in binary, we do the operation n →n/2 or n →
3n + 1 until n is equal to 1. Knowing if this particular Turing machine halts on all
inputs that ends with the symbol 1 is therefore equivalent to the Collatz Conjecture.
(For simplicity, the Turing machine we designed does not work if the input ends
with a symbol 0, i.e. if it codes the integer 0, or if an integer is coded with additional
symbols 0 at the end).
This somewhat easy example should convince the reader that Turing machines
are indeed able to represent arbitrary computations. We have somehow coded
traditional constructions from programming languages: We have a while loop that
ends when the integer n is equal to 1 (this is done by states 1 and 6), and we have
used subroutines that divides by 2 or multiply by 3 respectively (states 3/4 and states
7/8/9).
One can prove that any program in your favorite programming language may be
translated into an equivalent Turing machine. The Church-Turing thesis essentially
states that all reasonable models of computation we can devise are equivalent, in
the sense that they deﬁne exactly the same computable functions. In fact, almost all
models also use, up to a polynomial, the same ressources in time and memory, this
is the extent of the extended Church-Turing thesis.
With the vocabulary of Turing machines, we can give the ﬁrst formal example of
an undecidable problem:
Theorem 6.2.4 There is no algorithm that, given a Turing machine M and a word
u, decides if M halts on input u.
This problem is called the “Halting problem”.
Proof To prove that such an algorithm does not exist, we need to formalize exactly
its input. So we need an encoding of descriptions of Turing machines into words.
We write machine(u) for the Turing machine whose encoding is u.
Suppose such an algorithm exists. As algorithms can be turned into Turing
machines, we therefore have the existence of a Turing machine N s.t., on input
u and v, works as follows:
•
If machine(u) halts on input v, N accepts
•
If machine(u) does not halt on input v, N rejects.
We obtain from N a Turing machine N′ that works in the following way: On
input v:
•
If machine(v) halts on input v, N′ does not halt
•
If machine(v) of code v does not halt on input v, N′ halts.

6
The Undecidability of the Domino Problem
309
We then obtain a contradiction by looking at the behaviour of N′ on input w s.t.
machine(w) = N′.
Corollary 6.2.5 There is no algorithm that, given a Turing machine M, decides if
M halts on the empty input.
Proof (Sketch) Given a Turing machine M and an input u, we can easily build a
Turing machine N s.t. N on the empty input simulates M on input u: N proceeds
by ﬁrst writing u on its tape, and then “calls” the Turing machine M. Therefore an
algorithm that solves the halting problem on the empty input can solve it on any
input.
6.2.2
Encoding of Turing Machines in Tilings: The Fixed
Domino Problem
Figure 6.9 shows that the execution of a Turing machine can be written essentially as
a two-dimensional object, with each row representing a step of the Turing machine.
It is therefore not surprising that this model is quite easy to encode into Wang tiles.
There exists multiple equivalent encodings in the litterature.
In the case of Turing machines with an inﬁnite (rather than biinﬁnite) tape, such
an encoding is proposed in Fig. 6.10, and a quarter of plane using these tiles is given
in Fig. 6.11.
If we write the input on the bottom left of a quarter of a plane, then the only way
to ﬁll up the quarter of a plane is to simulate the execution of the Turing machine.
If furthermore, we delete all tiles involving the accepting state qa, then a tiling is
possible iff the Turing machine does not halt.
Using the three tiles at the bottom of Fig. 6.10, we can initialize the computation
so that it starts with the empty input and state q0. In fact, any tiling of the quarter
plane that contains at the origin the tile that is at the bottom-left of Fig. 6.10
simulates the execution of the Turing machine with empty input. This is in fact a
tiling of the entire plane, as the rest can be ﬁlled up with the blank tiles. Therefore,
we have a tiling of the entire plane, with a speciﬁc tile at the origin, iff the Turing
machine does not halt on empty input.
We have proven:
Theorem 6.2.6 (Undecidability of the Fixed Domino Problem, see Wang [52],
Büchi [9], and Kahr et al. [29]) There is no algorithm that decides, given a set of
Wang tiles τ and a predescribed tile t ∈τ whether there exists a tiling of the plane
by τ that contains t.
If we look at the construction, we can obtain
Corollary 6.2.7 There is no algorithm that decides, given a set of Wang tiles τ and
a predescribed tile t ∈τ whether there exists a tiling of the quarter of the plane by
τ with t at the corner.

310
E. Jeandel and P. Vanier
Fig. 6.10 Coding of a Turing
machine by Wang Tiles
a
a
a
a
q
(q , a)
a
a
q
(q , a)
a
q
(q
a
q
a
, a)
if δ(q, a) = (q , a ,
1)
q
(q
a
q
a
, a)
if δ(q, a) = (
+1)
q0 q0
(q0 , B)
B
q , a ,
It is possible to adjust slightly the set of tiles so that we can, starting from an
input u, produce a ﬁnite pattern P s.t. there is a tiling by τ that contains the pattern
P iff the Turing machine does not halt with input u. Doing this we obtain
Theorem 6.2.8 (Robinson [47]) There exists a set of Wang tiles τ s.t. there is no
algorithm that decides, given a ﬁnite pattern P whether there exists a tiling of the
plane by τ that contains P.
Sketch of Proof Let M be the Turing machine that on input u simulates machine(u)
on the empty input. This machine is indeed implementable, and it is easy to see that
there is no algorithm that decides, given an input u, if M halts on input u. We now
code this Turing machine as in Fig. 6.10.

6
The Undecidability of the Domino Problem
311
0
B
1
1
B
B
B
B
B
1
1
1
B
B
B
B
B
0
6
1
B
B
B
B
B
0
1
9
B
B
B
B
B
0
1
0
8
B
B
B
B
0
1
A
0
1
B
B
B
0
A
1
0
1
B
B
B
A
0
1
0
1
B
B
A
B
0
1
0
1
B
B
B
1
0
1
0
1
B
B
B
0
2
1
0
1
B
B
B
0
1
2
0
1
B
B
B
0
1
0
2
1
B
B
B
0
1
0
1
2
B
B
B
0
1
0
3
1
B
B
Fig. 6.11 A tiling of a quarter of plane by the set of Wang tiles of Fig. 6.10. The link with Fig. 6.9
should be obvious
6.2.3
Towards the Domino Problem
With one notable exception, the coding we presented before is central in all the
proofs of the undecidability of the Domino Problem. However this is far from
sufﬁcient.

312
E. Jeandel and P. Vanier
Indeed, the construction gives rise to a lot of tilings if the primordial tile is not
used. First, we can have tilings with no head per row, using e.g. only the ﬁrst tile
on the top left of Fig. 6.10, or even using only the blank tile. Second, we can have
tilings with more than one head per row. There are easy tricks to stop this problem
from happening, e.g. by having different background colors before and after the
head. The third problem is that there can be tilings that correspond to uninitialized
computations, i.e. biinﬁnite computations rather than a computation starting from a
ﬁnite input and the initial state.
There are no easy solutions to the remaining problems. Three of the methods
outlined built a set of Wang tiles in which a quarter of plane appears, in such a way
that the corner of the quarter of the plane can be locally identiﬁed. It is then a routine
exercise to enforce that a speciﬁc tile appears in that corner, so that we can use the
previous construction inside this quarter of plane.
The last method uses a very different encoding technique, which will enforce that
every row codes a conﬁguration of a Turing machine in such a way that the head
is always present. The remaining problem is therefore uninitialized computations,
which is solved using the following theorem:
Theorem 6.2.9 (Hooper [25]) There is no algorithm that, given a Turing machine
M, decides if M halts on all conﬁgurations.
This is still true if we restrict ourselves to Turing machines with a working
alphabet of size 2.
This last proof of the undecidability of the Domino problem is tremendously
simpler, but one could say that part of the complexity of the proof is hidden inside
the proof of Theorem 6.2.9, which is far from trivial.
It is interesting to remark that Hooper was, like Robert Berger, a PhD Student of
Hao Wang. In fact, this theorem was obtained for the same purpose as Berger’s, i.e.
proving the undecidability of the ∀∃∀fragment of ﬁrst order logic.
6.3
The Substitutive Method 1/2
6.3.1
Preliminary Discussion
We now start with the ﬁrst proof of the Undecidability of the Domino Problem. The
proof we present here follows closely Berger [7] and Robinson [47] although we
will use some recent results and concepts from Ollinger [43].
As we saw in the previous section, it is easy to use Turing machines to prove the
undecidability of the Fixed Domino Problem, i.e. whether there exists a tiling by τ
that contains some speciﬁc tile t. The problem of the construction is, of course, that
τ always has some trivial tilings that do not contain t. We need therefore some way
to force the tile t to appear.

6
The Undecidability of the Domino Problem
313
This suggests a nave approach to prove the undecidability of the (General)
Domino problem: First build a speciﬁc tileset τs with the property that every tiling
of the plane with τs contains exactly one copy of a speciﬁc tile ts. Now, given a
tileset τ and a tile t, superimpose τs with τ by forcing the tile t to appear exactly on
top of ts. Let’s call τ ×τs this new tileset. Then it is clear that τ ×τs tiles the plane iff
there exists a tiling of the plane by τ that contains t. Therefore we cannot decide the
General Domino Problem as it would allow us to decide the Fixed Domino Problem,
case closed.
However, such a tileset τs cannot exist:
Proposition 6.3.1 Let τs be a tileset. If every tiling by τs contains the tile ts, then
there exists some integer n s.t. every tiling of a square of size n contains the tile ts.
Proof If it were not the case, we would have tilings of arbitrary large squares
without the tile ts. By compactness (Proposition 6.1.4), this would imply that there
is a tiling without ts.
Therefore the tile ts, on top of which we want to kickstart the computation
process of τ appears in every sufﬁciently large square. This means that our
construction would have to contain inﬁnitely many instances of the computation
process. How to manage all these different computations in such a way that they do
not overlap is not an easy task.
The solution is provided by building tileset τs with some speciﬁc properties. The
general idea is to ﬁrst build an aperiodic tileset, and then try to embed computation
in it. While in theory, the method can be used starting from any aperiodic tileset,
the only tilesets that have been used successfully for this method are substitutive
tilesets, that we now deﬁne.
6.3.2
Substitutions
Deﬁnition 6.3.2 Let A be a ﬁnite alphabet. A (square) substitution is a map φ from
A to An×n. If w is a (two-dimensional) word of size m × m, then the image by φ of
w, named φ(w) is the word of size nm × nm deﬁned by
φ(w)(ni1+i2,nj1+j2) = φ(wi1,j1)i2,j2
We write φk(w) for the k-th iterate of φ. The map φ is extended naturally to
w ∈AZ×Z using the same formula.
The substitutive subshift associated to φ is the set Sφ of all conﬁgurations of
AZ×Z s.t. x ∈Sφ iff there exists an inﬁnite sequence (wi)i<0 s.t. φ(wi) = wi+1 and
w0 = x.
An example of a substitution is given in Fig. 6.12. This substitution is quite
random and has no relevance in the rest of the paper.

314
E. Jeandel and P. Vanier
Fig. 6.12 A substitution φ
on A = {0, 1} and φk(1) for
k = 0, 1, 2, 3
0
0 1
1 0
1
1 1
0 1
1
1 1
0 1
1 1 1 1
0 1 0 1
0 1 1 1
1 0 0 1
1 1 1 1 1 1 1 1
0 1 0 1 0 1 0 1
0 1 1 1 0 1 1 1
1 0 0 1 1 0 0 1
0 1 1 1 1 1 1 1
1 0 0 1 0 1 0 1
1 1 0 1 0 1 1 1
0 1 1 0 1 0 0 1
Intuitively the substitutive subshift Sφ looks like φk(w) at the inﬁnity. The term
“subshift” comes from the symbolic dynamics school. We refer to other articles in
this volume for details on subshifts.
Deﬁnition 6.3.3 (Informal Deﬁnition) A tileset τ is substitutive if the set of tilings
by τ is, up to a recoloring, a substitutive subshift.
There are a lot of examples of substitutive tilesets [7, 47]. In fact, one can show
that, for any φ, Sφ can be realized as a tileset τ [17, 20, 40].
Most constructions of substitutive tilesets are hindered by the fact that the tilings
are not directly substitutive, but this is only true of their recolorings.
We therefore strive to ﬁnd a tileset that is intrinsically substitutive:
Deﬁnition 6.3.4 ([5, 13, 14, 43]) Let τ be a tileset. We say that τ is intrinsically
substitutive with factor 2 if there exists a one-to-one substitution φ : τ →τ 2×2
s.t.:
•
For any ﬁnite pattern w, φ(w) is a valid tiling precisely when w is a valid tiling
•
For any tiling of the plane x by τ, there exist y s.t. φ(y) = x upto shift.
The second point ensure that φ somehow exhausts all possible patterns that can
appear in a tiling of the plane. Notice that, in the second property y is automatically
a valid tiling (as every pattern of y is valid by the ﬁrst property).
Theorem 6.3.5 ([13, 43]) There exists an intrinsically substitutive aperiodic tileset.
The tileset obtained by Ollinger is depicted in Fig. 6.13. Although the tiles are
decorated for cosmetic reasons, they are really Wang tiles: two tiles can be put
together if they match on their common edge. Each tile is composed of three layers,
as seen in Fig. 6.14. An example of a large square tiled by τ is given in Fig. 6.15.
The ﬁrst layer ensures that, in each tiling of the plane, the tiles are grouped in
squares of size 2 × 2 to form a small red square.
The substitution that corresponds to τs is given in Fig. 6.16.
Proposition 6.3.6 The tileset τs depicted in Fig.6.13 is intrinsically substitutive
and aperiodic.

6
The Undecidability of the Domino Problem
315
Fig. 6.13 The tileset τs
Fig. 6.14 The three layers inside a tile
Fig. 6.15 A portion of a tiling by τs

316
E. Jeandel and P. Vanier
(a)
(b)
(c)
(d)
(e)
Fig. 6.16 The substitution. The layer 1 of φ(t) is the same for all tiles t, as shown in subﬁgure
(a). The second layer of φ(t) is cut in half. First, The layer 1 of the tile t is stretched (subﬁgure
(b)). Second, the wires in the layer 2 of t are extended horizontally and vertically (subﬁgure (c)).
Finally subﬁgure (d) explains how the layer 3 of φ(t) is obtained from t. Subﬁgure (e) gives two
examples
Proof Let φ be the substitution deﬁned in Fig. 6.16. It is easy to see that φ is one to
one, and an easy inspection of φ shows that φ(w) is valid precisely when w is valid.
We say that a tiling of a 2 × 2 square is well behaved if its ﬁrst layer consists of
a small red square (i.e. similar to Fig. 6.16a).
We now look at every possible tiling of a 4 × 4 square by τ where the central
2×2 square is well behaved. By an exhaustive analysis, we see that every such 2×2
square is of the form φ(w) for some w. (This is easily seen by writing and running
a small program. A detailed proof is also given in [5].)
Now let x be a tiling of the plane. We regroup the cells of x into 2 × 2 well-
behaved squares (xi,j)i,j∈Z ∈(τ 2×2)Z2. By the previous argument, each of them is
of the form φ(wi,j), which means that x = φ(w) upto shift.
Therefore τ is intrinsically substitutive.
τ should be aperiodic. Indeed, suppose that there exists a tiling x by τ of period
p, and choose p as small as possible. As x can be divided into 2×2 squares that are

6
The Undecidability of the Domino Problem
317
not periodic, p should be even. Now x = φ(w) for some tiling of the plane w. As x
is periodic of period p, φ(w) should be periodic of period p/2, a contradiction.
The reader familiar with the work of Robinson [2, 19, 28, 47] might recognize
something familiar in Fig. 6.15. The tileset of Robinson can indeed be obtained from
the tileset τs by some identiﬁcation of colors, see the bibliographic notes below.
6.3.3
Grids Inside Tilings
We now explain how to use the tileset we built previously to obtain the undecid-
ability of the Domino Problem. The proof highly depends on properties of this
tileset, and it is unknown whether a similar reasoning could be used starting from
any substitutive tileset.
First, to understand the tilings, we need to simplify the pictures. We will forget
about the ﬁrst and third layer, and focus only on the wires of color red in the second
layer. It is easy to see that they form arbitrarily large squares. We obtain Fig. 6.17
Fig. 6.17 Squares inside the tilings by τs

318
E. Jeandel and P. Vanier
by considering only half of the squares. This is done in practice by changing τs to
have two different shades of red (say, light red and dark red) and forcing light red
wires to cross only dark red wires. Figure 6.17 then represents only, say, the light
red squares.
We now see that tilings by τs are formed of squares that do not cross.
Remember that by Corollary 6.2.7 there is no algorithm to decide, given a tileset
τ and a tile t, whether there exists a tiling of a quarter of plane by τ with t at the
corner. By compactness, it means there is no algorithm to decide, given a tileset τ
and a tile t whether one can tile arbitrary large squares by τ with t at the bottom-left
corner.
Our goal now is clear: starting with a tileset τ and a tile t, we will ﬁll up the
squares of τs by tilings by τ in such a way that t appear in the bottom-left corner.
One difﬁculty remains: While the squares in τs do not cross, they are included one
in each other, which means that we cannot use all the space in one square, as some
of it is already occupied by other squares. We will therefore ﬁrst extract in each
square the largest “free” subsquare.
Let S be a square, that we see as a subset of positions of the form C × D for
some segments C and D. Let U (for “used”) be the set of positions inside S that are
occupied by a smallest square.
By a free subsquare of S, we denote a set of horizontal positions H ⊆C and
vertical positions V ⊆D s.t. H × D and C × V do not intersect U.
To obtain the largest free subsquare of S, we just have to cross out every
horizontal (resp. vertical) coordinate on which a smallest square lies. We will call
these coordinates “obstructed”. In our particular case this can be done easily by local
rules: The idea is that each square will emit horizontal (resp. vertical) signals on their
exterior borders that propagate horizontally (resp. vertically) and that die out when
they encounter another border. This is explained nicely in [47], see Fig. 6.18. To be
exact, notice that the parts that are not crossed do not correspond to whole tiles, but
only quarters of them. This has no bearing in the following.
As can be seen in the ﬁgure, larger squares of the tiling have larger free
subsquares formed by joining the unobstructed space. It remains to put the tileset τ
inside the free subsquare.
The idea is that the position (i, j) of the supposed tiling by τ will be contained
in the position (hi, vh) of the square S, where hk (resp. vk) is the k-th element of H
(resp. V ). As no element of H × D is occupied by a smallest square, we can use
cells of H × (D \ V ) to propage the vertical constraints of τ inside the grey area
of the tiling of Fig. 6.18. We can also force the tile at the bottom-left quarter of the
square easily, by enforcing that the only tile that can appear on top of a corner tile
of τs is the tile t.
Putting everything together we have the desired proof.
Theorem 6.3.7 The Domino Problem is undecidable.
Proof Let τ be a tileset and t ∈τ. We use the construction above to obtain a new
tileset τr combining τ and τs.

6
The Undecidability of the Domino Problem
319
Fig. 6.18 The squares with the obstructed rows and columns grayed out. Inside a square, the
remaining unobstructed space, in white, forms a square whose size is a quarter of its container
square
Suppose this new tileset τr admits a tiling. This tiling contains arbitary large
squares, and therefore arbitrary large free subsquares. But these subsquares form a
tiling by τ with the tile t at the corner. Therefore there exist arbitrary large squares
tiled by τ with t at the corner.
Conversely, if there exist arbitrary large squares tiled by τ with t at the corner,
we can obtain a tiling of the plane by τr by putting in each free subsquare of each
square a valid tiling.
We have therefore proven that there exists arbitrary large squares tiled by τ with
t at the corner iff there exists a tiling by τr.
Therefore no algorithm can solve the Domino Problem: If such an algorithm
existed, it could be used, via the given transformation, to decide, given a tileset τ

320
E. Jeandel and P. Vanier
and a tile t, whether there exists tilings of arbitrary large squares by τ with t at the
corner, which is undecidable by Corollary 6.2.7.
6.3.4
Bibliographic Notes
There exist a lot of different proofs of the Undecidability of the Domino Problem
based on building ﬁrst an aperiodic substitutive tileset and then encoding tilings with
a ﬁxed tile t inside the squares it produces. Notice that in theory, this proof doesn’t
need a substitutive tileset, but only a tileset from which we can extract arbitrary
large squares. However all known variants of this proof uses substitutive (or more
accurately near substitutive) tilesets.
The ﬁrst proof of the kind is the proof by Berger [7]. Technically the construction
of Berger is not a division into squares which overlap, but a division into inﬁnite
vertical strips of arbitrary width which can overlap, but the principle stays the same.
The proof we presented here is essentially from Robinson [47], except we used
the tileset of Ollinger [43] as a basis instead of the tileset of Robinson. The tileset
used in Robinson’s article is very similar to Ollinger; it uses the same tiles as
Fig. 6.13 except that the green wires are now centered, i.e. the two colors “green on
top” and “green on bottom” of the east/west side of the second layer are identiﬁed,
and the same goes for the colors “green on left” and “green on right” on the
north/south side. Robinson also speaks in his note [46] of a set of 52 tiles, that
was later published in an article of Poizat[45]. This set is the same as Fig. 6.13
without the ﬁrst layer. The fact that these two tilesets of Robinson look very close
to Ollinger’s tileset and the fact that Robinson himself hints at a set of 104 tiles
in his note [46] suggests that the set discovered by Ollinger was already known to
Robinson.
There exist a lot of literature explaining and reexplaining Robinson’s tileset [2,
28, 48]. The tileset of Ollinger is explained in [43]. Further details that prove the
tileset is substitutive and minimal can be found in the thesis of Ballier [5].
The simpliﬁcations made by Robinson lead to a smaller tileset but also have
a major drawback: the tileset is not intrinsically substitutive, which makes the
proof of its aperiodicity (and a complete description of the possible tilings) more
difﬁcult. The tileset of Ollinger is not the ﬁrst intrinsically substitutive tileset that
was discovered. In fact, Berger set of 103 tiles is intrinsically substitutive, although
this was never proven. This property is also used very often to prove aperiodicity
of tilesets in the plane R2, where it is sometimes called “the unique composition
property”, see e.g. [3, p. 2].
To ﬁnish, remark that the whole construction is based on the fact that an aperiodic
substitutive tileset with some speciﬁc property exist, but the tileset we use (and
similar tilesets used by Berger, Robinson, or others) appears somehow by miracle.
Sect. 6.6 of this document explains how to prove using tools from computability
theory and programming languages that such a tileset exist.

6
The Undecidability of the Domino Problem
321
6.4
The Construction of Aanderaa and Lewis
The construction by Aanderaa and Lewis we present here is not well known. As with
all early constructions of an aperiodic tilesets, this tileset was built in the context of
the undecidability of the ∀∃∀fragment of ﬁrst order logic, and is actually the ﬁrst
published example of an aperiodic deterministic tileset, i.e. a tileset s.t. any row
determines uniquely all rows in the upper half plane above this row. This also gives
a proof of the undecidability of the nilpotency of one-dimensional cellular automata.
The ﬁrst proof of the idea was published by Aanderaa and Lewis in 1974 [1]; a
better version may be found in the book by Lewis [36]. Our exposition here follows
somewhat Lewis but the construction is actually quite different, in particular with
the introduction of soﬁc shifts and p-adic numbers.
This construction is quite interesting as it uses only elementary number theory,
and is actually building at ﬁrst a one dimensional object rather than a two-
dimensonial tiling.
While not stricly necessary, it is however recommended to have a good under-
standing of the basics of symbolic dynamics. We refer the reader to the book [38]
and to other articles of this book.
6.4.1
Tiling Problems on One-dimensional Objects
6.4.1.1
Symbolic Dynamics
We brieﬂy recall in this section classical notions from symbolic dynamics.
The concept of Wang tiles is not intrinsically two-dimensional, and one can
deﬁne Wang tiles for tilings of the discrete line Z rather than the discrete plane
Z2. This can also be generalized obviously to higher dimensions, or even to tilings
of ﬁnitely generated groups:
Deﬁnition 6.4.1 (One-dimensional Wang Tiles) Let C be a ﬁnite set, called the
set of colors. A Wang tilet over C is a map from {E, W} to C. A tileset τ is a ﬁnite
set of Wang tiles.
Deﬁnition 6.4.2 A tiling of Z by τ assigns to each element of Z a tile from τ s.t.
colors of adjacents tiles agree on their common border.
Formally, a tiling is a map x : Z →τ s.t.
•
∀i, x(i)(E) = x(i + 1)(W)
We say that τ tiles Z if there exists a tiling of Z by τ.
Proposition 6.4.3 The Domino Problem is decidable on Z: there exists an algo-
rithm, that on input a tileset τ, decides if τ tiles the discrete line Z.
The idea is very similar to the construction presented in Fig. 6.5.

322
E. Jeandel and P. Vanier
0
0
0
2
0
1
1
2
1
3
2
1
3
3
1
0
2
3
Fig. 6.19 The tileset τ2 and its representation as a graph
Proof Let τ be a one-dimensional tileset. Consider the (multi)-graph whose vertices
are the colors C, and there is an edge from u to v if there exists a Wang tile with u
on the west side and v on the east side. Then it is obvious that there exists a tiling
by τ if and only if the graph G contains a cycle. See Fig. 6.19 for an example.
In the following, we will be interested in soﬁc shifts, which correspond to Wang
tiles with an additional symbol. We deﬁned them only for one-dimensional objects,
although we will also need their two-dimensional variant:
Deﬁnition 6.4.4 (Decorated one-dimensional Wang Tiles) Let C be a ﬁnite set,
called the set of colors, and A a ﬁnite set, called an alphabet. A decorated Wang tile
t over C is as 2-tuple (t′, a) where t′ is a Wang tile and a ∈A is the decoration.
Given a decorated Wang tile t = (t′, a), we note π(t) = a. A decorated tileset τ is
a ﬁnite set of decorated Wang tiles.
Tilings by decorated Wang tiles are deﬁned exactly as tilings by Wang tiles.
Deﬁnition 6.4.5 If x is a tiling of Z by a decorated tileset τ, we write π(x) the
extension of π to words over the alphabet A. It is deﬁned by π(x)i = π(x(i)).
The soﬁc shift deﬁned by τ, denoted Xτ is the set of all words π(x), for x a tiling
by τ.
An example of a decorated tileset τ, a tiling by τ, and the corresponding inﬁnite
word are given in Fig. 6.20.
The term “shift” corresponds to the fact that the tilings are invariant by shift:
Deﬁnition 6.4.6 Let x be a bi-inﬁnite word over an alphabet A. The shift of x,
σ(x), is the bi-inﬁnite word deﬁned by σ(x)i = xi+1
We deﬁne σ n(x) for n ∈Z similarly.
Deﬁnition 6.4.7 A set of inﬁnite words X ⊆AZ is a subshift if it is closed under
shift (x ∈X ⇐⇒σ(x) ∈X) and topologically closed (for the product topology
on AZ)

6
The Undecidability of the Domino Problem
323
0
0
a
0
2
b
0
1
a
1
2
b
1
3
a
2
1
b
3
3
b
0
0
a
0
0
a
0
0
a
0
2
b
2
1
b
1
3
a
3
3
b
3
3
b
3
3
b
. . .
a
a
a
b
b
a
b
b
b
Fig. 6.20 The tileset τ3, a tiling x by τ3, and the corresponding bi-inﬁnite word π(x)
The subshift generated by a set T is the smallest subshift that contains T , i.e. the
topological closure of {σ n(x), x ∈T, n ∈Z}
We refer to other articles in this volume for more reference about symbolic
dynamics.
Proposition 6.4.8 Xτ is a subshift.
If we decorate the edges from the graph obtained in Fig. 6.19 with the labels from
Fig. 6.20, we obtain a ﬁnite automaton such that the projections π(x) correspond
exactly to the biinﬁnite paths in this automaton.
In a sense, this means that the behaviour of one-dimensionalsets of Wang tiles are
entirely understood once we understand the theory of ﬁnite automata. In particular:
Proposition 6.4.9 Let L be the set of ﬁnite words that can occur in some inﬁnite
word in Xτ. Then L is regular.
Conversely, let L be a regular language. The set of inﬁnite words, all factors of
which are in L is a soﬁc shift.
See [38, Chapter 3] for more details.
6.4.1.2
Distance Shifts
Now that we have the concept of a soﬁc shift, we can introduce the main
construction of Aanderaa and Lewis. The core of the proof is based on the following
deﬁnition:
Deﬁnition 6.4.10 Given a soﬁc shift X ⊆(A × A)Z, the distance shift XΔ
corresponding to X is the set of all pairs (x, y) ∈AZ × AZ s.t. for all i ∈Z,
(x, σ i(y)) ∈X.
The deﬁnition is of course symmetric in x and y: a pair (x, y) is in the distance shift
iff for all n, m ∈Z, (σ n(x), σ m(y)) ∈X.
We call this shift a distance shift, as it can compare patterns in x and in y that
are at any distance from each other, just by shifting x or y to put them in the same
position.

324
E. Jeandel and P. Vanier
As an example, let X be the set of all words (x, y) ∈({0, 1} × {0, 1})Z with the
following property: If xi = yi = 1 for some i, then x = y. It is an exercise left to
the reader to show that X is a soﬁc shift.
What is the distance shift deﬁned by X? To know this, let (x, y) ∈({0, 1} ×
{0, 1})Z such that for all n, m ∈N, (σ n(x), σ m(y)) ∈X.
•
If ∀i, xi = 0, then any y can do. That is, (0Z, y) ∈XΔ for all y ∈{0, 1}Z.
•
If ∀i, yi = 0, then any x can do. That is, (x, 0Z) ∈XΔ for all x ∈{0, 1}Z.
•
Suppose that x contains only one occurrence of the letter 1, say in position i.
Then it is easy to see that y should contain at most one occurrence of 1: shift y
so that one of the occurences of 1 in y coincides with the only occurence in x:
As σ n(y)i = xi = 1 we get σ n(y) = x.
•
Similarly, if y contains only one occurence of the letter 1, then x contains at most
one occurrence of the letter 1.
•
Otherwise x and y contains at least two occurences of the letter 1. Then it is easy
to see that x and y are periodic words. Indeed suppose that xi = xj = 1 and
that yk = 1. Then σ i(x)0 = σ k(y)0 = 1 and therefore σ k(y) = σ i(x). Similary,
σ j(x) = σ k(y) and therefore σ i(x) = σ j(x). With a bit more work, we can
show that x and y are (up to shift) of the form (0p1)Z for some p.
This easy example shows that the structure of XΔ can already be quite complicated.
In particular, if X is soﬁc, XΔ might be far from soﬁc.
The result of Aanderaa and Lewis is the following:
Theorem 6.4.11 ([1, 36]) There is no algorithm that decides, given a soﬁc shift X
whether XΔ is empty.
The proof of this theorem will be given over the next sections.
6.4.1.3
Application to the Domino Problem
It is not obvious from the theorem how it can be applied for the undecidability of
the Domino Problem. The key idea is the following: Starting from a soﬁc shift X ⊆
(A×A)Z, we build a two-dimensional object X2 s.t. for each conﬁguration (x, y) ∈
X, the n-th row of the corresponding conﬁguration in X2 is the pair (x, σ n(y)). The
result is depicted on Fig. 6.21. It is easy to see that X2 is indeed a soﬁc shift:
Proposition 6.4.12 Let X be a one-dimensional soﬁc shift over an alphabet A×A.
Consider the following two-dimensional shift X2:
•
Every cell of the subshift is composed of two layers.
•
The ﬁrst layer contains a word w ∈AZ2 that is identical on all rows wi,j = xi
for some x ∈AZ.
•
The second layer contains a word z ∈AZ2 that is shifted on consecutive rows:
zi,j+1 = zi+1,j. In other words zi,j = yi+j for some y ∈AZ
•
The word in each row is in X.

6
The Undecidability of the Domino Problem
325
x0 ,y0
x0 ,y1
x0 ,y2
x0 ,y3
x0 ,y4
x0 ,y5
x0 ,y6
x0 ,y7
x0 ,y8
x0 ,y9
x1 ,y1
x1 ,y2
x1 ,y3
x1 ,y4
x1 ,y5
x1 ,y6
x1 ,y7
x1 ,y8
x1 ,y9
x1 ,y10
x2 ,y2
x2 ,y3
x2 ,y4
x2 ,y5
x2 ,y6
x2 ,y7
x2 ,y8
x2 ,y9
x2 ,y10
x2 ,y11
x3 ,y3
x3 ,y4
x3 ,y5
x3 ,y6
x3 ,y7
x3 ,y8
x3 ,y9
x3 ,y10
x3 ,y11
x3 ,y12
x4 ,y4
x4 ,y5
x4 ,y6
x4 ,y7
x4 ,y8
x4 ,y9
x4 ,y10
x4 ,y11
x4 ,y12
x4 ,y13
x5 ,y5
x5 ,y6
x5 ,y7
x5 ,y8
x5 ,y9
x5 ,y10
x5 ,y11
x5 ,y12
x5 ,y13
x5 ,y14
x6 ,y6
x6 ,y7
x6 ,y8
x6 ,y9
x6 ,y10
x6 ,y11
x6 ,y12
x6 ,y13
x6 ,y14
x6 ,y15
x7 ,y7
x7 ,y8
x7 ,y9
x7 ,y10
x7 ,y11
x7 ,y12
x7 ,y13
x7 ,y14
x7 ,y15
x7 ,y16
x8 ,y8
x8 ,y9
x8 ,y10
x8 ,y11
x8 ,y12
x8 ,y13
x8 ,y14
x8 ,y15
x8 ,y16
x8 ,y17
x9 ,y9
x9 ,y10
x9 ,y11
x9 ,y12
x9 ,y13
x9 ,y14
x9 ,y15
x9 ,y16
x9 ,y17
x9 ,y18
Fig. 6.21 A portion of the shift X2
Then X2 is soﬁc and each row of X2 is composed of pairs (x, y) s.t. for all j,
(x, σ j(y)) ∈X.
Furthermore, there exists an algorithm that can obtain a set of decorated Wang
tiles for X2 from a set of decorated Wang tiles for X.
In fact the j-th row of X2 proves that (x, σ j(y)) ∈X. Therefore X2 is empty iff
XΔ is empty.
Corollary 6.4.13 The Domino problem is undecidable.
Notice that, even taking into account the projection π that deleted the colors,
the tilings we obtain using the Aanderaa-Lewis method are quite different from the
tilings of the previous section.
In fact, the construction used above can give us a stronger result if done correctly.
Recall that each row should be part of a soﬁc shift X, which means they
correspond to decorations of Wang tiles. We represent in Fig. 6.22 the shift X2 with
the Wang tiles these decorations are part from.
Now it is well known that each soﬁc shift can be obtained from a right-resolving
set of Wang tiles, that is a set of Wang tiles where the colors on the east side is
entirely determined from the colors on the west side and the label of the tile (This is
obtained by the usual process of determinization of a ﬁnite automaton).
If this is the case, the tiling we obtain has a deterministic property: the half
plane at the right of the line is entirely determined by the line. In fact, the symbols
at the black position are entirely determined by the three gray symbols that are
immediately above and at its left: x4 is obtained from the tile on the top, y8 from the
tile at the top left, z4
4 by the tile at the left, and z5
4 is uniquely determined knowing
the three others.
This means that we can convert the picture and the shift X2 into a north-west
deterministic set of Wang tiles. (A set of Wang tiles is north-west deterministic if

326
E. Jeandel and P. Vanier
x0 ,y0
z0
0
z0
1
x0 ,y1
z1
0
z1
1
x0 ,y2
z2
0
z2
1
x0 ,y3
z3
0
z3
1
x0 ,y4
z4
0
z4
1
x0 ,y5
z5
0
z5
1
x0 ,y6
z6
0
z6
1
x0 ,y7
z7
0
z7
1
x0 ,y8
z8
0
z8
1
x0 ,y9
z9
0
z9
1
x1 ,y1
z0
1
z0
2
x1 ,y2
z1
1
z1
2
x1 ,y3
z2
1
z2
2
x1 ,y4
z3
1
z3
2
x1 ,y5
z4
1
z4
2
x1 ,y6
z5
1
z5
2
x1 ,y7
z6
1
z6
2
x1 ,y8
z7
1
z7
2
x1 ,y9
z8
1
z8
2
x1 ,y10
z9
1
z9
2
x2 ,y2
z0
2
z0
3
x2 ,y3
z1
2
z1
3
x2 ,y4
z2
2
z2
3
x2 ,y5
z3
2
z3
3
x2 ,y6
z4
2
z4
3
x2 ,y7
z5
2
z5
3
x2 ,y8
z6
2
z6
3
x2 ,y9
z7
2
z7
3
x2 ,y10
z8
2
z8
3
x2 ,y11
z9
2
z9
3
x3 ,y3
z0
3
z0
4
x3 ,y4
z1
3
z1
4
x3 ,y5
z2
3
z2
4
x3 ,y6
z3
3
z3
4
x3 ,y7
z4
3
z4
4
x3 ,y8
z5
3
z5
4
x3 ,y9
z6
3
z6
4
x3 ,y10
z7
3
z7
4
x3 ,y11
z8
3
z8
4
x3 ,y12
z9
3
z9
4
x4 ,y4
z0
4
z0
5
x4 ,y5
z1
4
z1
5
x4 ,y6
z2
4
z2
5
x4 ,y7
z3
4
z3
5
x4 ,y8
z4
4
z4
5
x4 ,y9
z5
4
z5
5
x4 ,y10
z6
4
z6
5
x4 ,y11
z7
4
z7
5
x4 ,y12
z8
4
z8
5
x4 ,y13
z9
4
z9
5
x5 ,y5
z0
5
z0
6
x5 ,y6
z1
5
z1
6
x5 ,y7
z2
5
z2
6
x5 ,y8
z3
5
z3
6
x5 ,y9
z4
5
z4
6
x5 ,y10
z5
5
z5
6
x5 ,y11
z6
5
z6
6
x5 ,y12
z7
5
z7
6
x5 ,y13
z8
5
z8
6
x5 ,y14
z9
5
z9
6
x6 ,y6
z0
6
z0
7
x6 ,y7
z1
6
z1
7
x6 ,y8
z2
6
z2
7
x6 ,y9
z3
6
z3
7
x6 ,y10
z4
6
z4
7
x6 ,y11
z5
6
z5
7
x6 ,y12
z6
6
z6
7
x6 ,y13
z7
6
z7
7
x6 ,y14
z8
6
z8
7
x6 ,y15
z9
6
z9
7
x7 ,y7
z0
7
z0
8
x7 ,y8
z1
7
z1
8
x7 ,y9
z2
7
z2
8
x7 ,y10
z3
7
z3
8
x7 ,y11
z4
7
z4
8
x7 ,y12
z5
7
z5
8
x7 ,y13
z6
7
z6
8
x7 ,y14
z7
7
z7
8
x7 ,y15
z8
7
z8
8
x7 ,y16
z9
7
z9
8
Fig. 6.22 A tiling from X2 with the (one-dimensional) Wang tiles drawn
the colors on the east and south part of the Wang tile are uniquely determined by the
two other colors.) It is then easy to see that Theorem 6.4.11 implies the following
statements:
Theorem 6.4.14 The Domino problem for north-west deterministic set of Wang
tiles is undecidable
Corollary 6.4.15 The nilpotency problem for one-dimensional cellular automata
is undecidable.
The classical proof of this result is attributed to Kari [30] but in fact this result is
already mentioned in the original article of Aanderaa and Lewis [1].
The rest of the section is devoted to the proof of Theorem 6.4.11. As the proof
is quite long and difﬁcult, we will focus on proving that there exists a nonempty
distance shift with no periodic points, which implies that there exists a two-
dimensional aperiodic tileset. The modiﬁcation to obtain the undecidability result
will be mentioned brieﬂy at the end.
The general idea is to ﬁnd a set S s.t. if x, y ∈S, then the subword of x that
corresponds to the position where it differs from y (assuming this set of positions
is biinﬁnite) is itself in S. By comparing in particular x with σ n(x), this implies in
particular some kind of hierarchical structure in x.

6
The Undecidability of the Domino Problem
327
It is easy, with a soﬁc shift or equivalently with a ﬁnite automaton, to isolate the
positions where x and y differs. Therefore there is some hope to be able to deﬁne
such a set S as a distance shift (more precisely, S × S will be our distance shift).
The set S that will work is the subshift Sp we build below that corresponds to a
Toeplitz subshift based on p-adic numbers. There will be an additional difﬁculty in
the proof: if x, y ∈Sp, then the subword of x that corresponds to the position where
it differs from y (assuming this set of positions is biinﬁnite) is “almost” in Sp. What
this “almost” part means is quite technical and will be describe later.
We will ﬁrst describe this set Sp and how it related to p-adic numbers. We will
then describe the hierarchical properties it satisﬁes. Finally, we will explain why
the difference between two words of Sp is almost a word in Sp and how to use
this to build our distance shift. This distance shift, when passed through the two-
dimensional machinery explained in the few previous pages, will gives us a two-
dimensional aperiodic tileset.
We will ﬁnish by brieﬂy indicating what remains to be done to obtain the
undecidability of the emptiness of a distance shift, and therefore the undecidability
of the Domino problem
6.4.2
The Subshift Sp and p-Adic Numbers
Let p be an integer Let ap(n) be the ﬁrst non-zero digit in the expansion of n in base
p. That is, ap(n) = r if n = q × pk+1 + pkr for some q and r ̸= 0 mod p. For
example a10(1664) = 4, a10(71,500) = 5 and a10(71,050) = 5.
Note that ap(0) is not well deﬁned. We deﬁne it as taking all values in the
alphabet {0, 1, . . ., p −1} (this makes ap a multivalued function).
We will be interested in the hierarchical structure of the word u deﬁned by un =
ap(n), and of all other words similar to u.
For reference, here are the 80 digits of u around 0 when p = 3 with the arbitary
choice a3(0) = 2.
2212212112212212112212112112212212112212.2.1211221211211221221211221211211221211211
The main part of the construction of Aanderaa and Lewis is to build the subshift
generated by this point, for large values of p. To understand how to do it, we ﬁrst
have to understand this subshift.
For this we need the notion of p-adic integers. p-adic integers are formal sums
m =

k≥0
mkpk
with mk ∈{0, . . . , p −1}. p-adic integers form a group under addition, where
addition is done componentwise with propagation of carry, and even a ring with
the multiplication deﬁned the usual way. The integers Z can be seen as a subset of

328
E. Jeandel and P. Vanier
this group: Nonnegative integers correspond to formal sums where all but ﬁnitely
many terms are 0. Negative integers correspond to formal sums where all but ﬁnitely
many terms are equal to p−1. The ring of p-adic integers will be denoted Zp. It has
the natural, discrete topology: d(n, m) = p−min{i,ni̸=mi} which makes it a compact
space, in which Z is dense.
The function a can be extended to Zp in the natural way: For m ∈Zp, let i be
the minimal position s.t. mi ̸= 0. Then ap(m) = mi. It is easy to see that ap is a
continuous function.2
Proposition 6.4.16 Let p be an integer and Sp the subshift generated by the
sequence u with ui = ap(i). Sp contains exactly all points i →ap(m + i) for
m ∈Zp.
Proof For m ∈Zp, let um be the sequence deﬁned by (um)i = ap(m + i) and
let X = {um, m ∈Zp}. By continuity of ap, we get that if mk
k→∞
−−−→m then
umk
k→∞
−−−→um, so X is closed. In particular X is a subshift and thus Sp ⊆X.
For n ∈Z, un = σ n(u) and therefore un ∈Sp as Sp is shift-invariant. If m ∈
Zp then m = lim mk for mk ∈Z and therefore um = lim umk ∈Sp as Sp is
topologically closed. Therefore X ⊆Sp, and thus X = Sp.
Notice that all the points i →ap(m + i) are distinct. This gives a continuous
map:
f : Sp →Zp
x →f (x)
s.t. f (σ(x)) = f (x)+1. This makes our dynamical system an almost 1-1 extension
of the odometer (the dynamical system (Zp, T ) on the odometer deﬁned by T (x) =
x + 1). The extension is almost 1-1 due to the fact that all points of Zp except the
integers have only one preimage.
Here are a few useful properties of ap:
•
ap(pm) = ap(m) for all m ∈Zp.
•
ap(m + p) = ap(m) if m ̸= 0 mod p
•
ap(m + pk) = ap(m) if m ̸= 0 mod pk
Notice that m = 0 mod p makes sense not only for m ∈Z but also for m ∈Zp.
The following proposition will be useful:
2This statement is somewhat wrong, as ap is a multivalued function at 0. (An exact statement
would be that ap is upper hemicontinuous: If the sequence yn converges to y, then ap(y) contains
(but may contain more) all limit points of ap(yn)). The fact that ap is multivalued is a burden that
is not worth the hassle, and we urge the reader to consider ap as a normal, single valued function,
even though it is not.

6
The Undecidability of the Domino Problem
329
Proposition 6.4.17 Let x be a word s.t. for all k, there exists nk ∈Z s.t. xi =
ap(nk + i) if nk + i ̸= 0 mod pk. Then there exist m ∈Zp s.t. xi = ap(m + i) for
all i. In particular x ∈Sp.
Proof Let j ∈] −pk/2, pk/2] s.t. j = −nk mod pk. Let w = xj be the character
at position j. By replacing nk by nk + pkr for some suitable r we can assume wlog
that j + nk = pk+1w. In particular ap(j + nk) = w = xj.
Therefore, xi = ap(i + nk) for i ∈] −pk/2, pk/2].
Let m be a limit point of the sequence (nk)k∈N. Then by construction xi =
ap(m + i) for all i.
6.4.3
Sp as a Toeplitz Subshift
Sp has also the structure of a Toeplitz subshift (as all symbolic almost 1-1 extensions
of odometers). Let us recall what the point u ∈Sp looks like when p = 5:
1234112342123431234412341123411234212343123441234212341123421234312344123431234112342123431234412
By deﬁnition of ap, ap(n + p) = ap(n) if n ̸= 0 mod p. So if we delete one
symbol every p symbols in u, we obtain a periodic point.
This can be formalized in the following way:
Deﬁnition 6.4.18 If x is a sequence on the alphabet A, the p-skeleton of x denoted
skelp(x) is the sequence over the alphabet A ∪{⋆} deﬁned by:
skelp(x)i =
 xi if ∀n, xi+np = xi
⋆otherwise
Intuitively, and in what follows, the ⋆symbol represents a symbol the value of which
is unknown. The 5-skeleton of u for p = 5 is therefore:
..1234⋆1234⋆1234⋆1234⋆1234⋆1234⋆1234⋆1234⋆1234⋆1234⋆1234⋆1234⋆1234⋆1234⋆1234⋆1234⋆1234⋆1234⋆1234..
It is easy to see that any word of Sp actually has the p-skeleton:
...12...p′⋆12...p′⋆12...p′⋆12...p′⋆12...p′⋆12...p′⋆12...p′⋆12...p′⋆12...p′⋆12...p′⋆12...p′⋆12...p′⋆12...
with p′ = p −1. Furthermore, any word of Sp has the following p2-skeleton (the
differences with the p-skeleton have been highlighted)
...12...p′112...p′21............p′p′12...p′⋆12...p′112...p′21.........p′p′12...p′⋆12...p′112...p′21...p′p′12...

330
E. Jeandel and P. Vanier
As the p-skeleton contains only the periodic part of a word, we will be interested
mainly in the complement of the p-skeleton:
Deﬁnition 6.4.19 If x is a sequence on the alphabet A, the p-coskeleton of x
denoted coskelp(x) is the sequence over A ∪{_} deﬁned by:
The reduced p-coskeleton is the image of coskelp(x)i under the morphism h
deﬁned by h(a) = a for a ∈A and h(_) = ϵ
It is a bit painful to deﬁne exactly how to apply a morphism on a biinﬁnite word.
Note however that applying an erasing morphism (like h) to a biinﬁnite word might
produce in some cases a ﬁnite word, or a word that is ﬁnite in one direction and
inﬁnite in the other direction.
We go back to the running example:
12341123421234312344123411234112342123431234412342123411234212343123441234312341123421234312344123
Its 5-coskeleton is:
..._ _ _ _ _1_ _ _ _ _2_ _ _ _ _3_ _ _ _ _4_ _ _ _ _1_ _ _ _ _1_ _ _ _ _2_ _ _ _ _3_ _ _ _ _4_ _ _ _ _2_ _ _ _ _1_ _ _ _ _2_ _ _ _ _3...
and its reduced 5-coskeleton is:
12341123421234312344123411234112342123431234412342123411234212343123441234312341123421234312344123
In fact, the following proposition is an easy consequence of the fact that
ap(pn) = ap(n), and the proof is left to the reader:
Proposition 6.4.20 Let x ∈Sp. Then the reduced p-coskeleton of x is also in Sp.
This gives us an easy way to show that a word x ∈Sp:
Proposition 6.4.21 Recall that p′ = p −1 and let S be a set of conﬁgurations
s.t.:
1. Every x ∈S has the form (12 . . .p′⋆)Z. That is, there exists n ∈Z s.t. xi+n =
ap(i) if i ̸= 0 mod p.
2. The word x′ deﬁned by x′
i = xpi+n is in S with n as deﬁned in (1).
Then S ⊆Sp.
Notice that x′ is exactly the reduced p-coskeleton of x.
Proof We ﬁrst prove by induction on k that if x ∈S, then there exists some n ∈
[0, pk −1] s.t. xi+n = ap(i) for i ̸= 0 mod pk. This is true for k = 1 by deﬁnition.
Now suppose the result is true for k and let x ∈S and x′, n as in the deﬁnition. We
can suppose wlog that n ∈[0, p −1]. By induction hypothesis, there exists n′ ∈
[0, pk −1] s.t. x′
i+n′ = ap(i) for i ̸= 0 mod pk. Let N = n + pn′ ∈[0, pk+1 −1].
Then xi+N = ap(i) for all i ̸= 0 mod pk+1 which ends the induction.
We now conclude by Proposition 6.4.17.

6
The Undecidability of the Domino Problem
331
6.4.4
Sp × Sp as a Distance Shift
Our goal now is to prove that Sp × Sp is a distance shift, which means that we can
somehow decide if (x, y) ∈Sp ×Sp by local rules involving x and all possible shifts
of y.
The previous proposition is a ﬁrst step toward a solution. The problem is that
there is no easy way to extract the pk-coskeleton of a conﬁguration easily. There is
however a workaround. It turns out that, if we compare two points x, y ∈Sp, then
the set of positions where they differ looks like the pk-coskeleton for some k.
Let’s look for example at the point x deﬁned by xn = a5(n) and the point y
deﬁned by yn = a5(n + 10). The third row shows x when it differs from y.
The only difference between the two last sequences is that some symbols are
missing (i.e. replaced by _) in the third sequence. The same is true more generally
and is illustrated in Fig. 6.23.
Deﬁnition 6.4.22 If x and y are two conﬁgurations on alphabet A, the difference
of x and y, denoted by diff(x, y) is the conﬁguration on alphabet A ∪{_} deﬁned
by
diff(x, y)i =
 _ if xi = yi
xi otherwise
It is of course obvious that most symbols should be the same in x and y. If
xi = ap(i) and yi = ap(i + pk) then all positions of valuation less than k will be
identical in x and y.
Proposition 6.4.23 Let xi = ap(i) and yi = ai(i + pk).
Then diff(x, y) ⊆coskelpk(x), in the sense that diff(x, y)i = coskelpk(x)
whenever diff(x, y)i ̸= _.
12341123421234312344123411234112342123431234412342123411234212343123441234312341123421234312344123
23412342123431234123412341234212343123412342123412342123431234123431234123421234312341234123412342
41123412343124412341123411234123431244123412341123412343124412343124112341234312441234412341123412
23412342123431234123412341234212343123412342123412342123431234123431234123421234312341234123412342
34112342134123441234112341123421341234412342134112342134123441234123411234213412344123441234112342
23412342123431234123412341234212343123412342123412342123431234123431234123421234312341234123412342
34112342134123441234112341123421341234412342134112342134123441234123411234213412344123441234112342
23422343123412341123412342234312341234212341123422343123412343123411234223431234123412341123422343
Fig. 6.23 In the ﬁrst row, the sequence a5. In the second row, the values of a5(1 + n) when it
differs from a5(n) (values that are equal are not shown) In the third row, the values of a5(3 + n)
when it differs from a5(n) The other rows correspond to the choices 10, 25, 30, and 50

332
E. Jeandel and P. Vanier
The above examples seem to suggest that there are only few positions where the
reverse does not hold. The following lemma explains, in the case of k of valuation
0, that at most 4 symbols of the 1-skeleton in every block of size p2 will be replaced
by the symbol _ in diff(x, y).
Lemma 6.4.24 Let k ̸= 0 mod p. If ap(i + k) = ap(i) then
•
i = 0 mod p2 or
•
i = −k mod p2 or
•
i = pk mod p2 or
•
i = −kp −k mod p2.
In particular, given any k ̸= 0 mod p there are (at most) four values of i mod p2
s.t ap(i + k) = ap(i) and no three of them are consecutive.
Proof
•
If i + k ̸= 0 mod p and i ̸= 0 mod p, then ap(i) = i mod p and ap(i + k) =
i + k mod p and therefore ap(i) ̸= ap(i + k).
•
If i + k = 0 mod p but i + k ̸= 0 mod p2. Then ap(i + k) = (i + k)/p
mod p and ap(i) = i mod p. Therefore we obtain i = (i + k)/p mod p and
i = −k(p + 1) mod p2.
•
If i = 0 mod p but i ̸= 0 mod p2 we get similarly i + k = i/p mod p and
i = pk mod p2
Corollary 6.4.25 Let m, n ∈Zp s.t m ̸= n but m and n coincide exactly on their
ﬁrst r digits, i.e. m −n = kpr with k ̸= 0.
If ap(m + i) = ap(n + i) then
•
i ̸= −m mod pr or
•
i = −m mod pr+2 or
•
i = −n mod pr+2 or
•
i = −n + p(m −n) mod pr+2 or
•
i = −m −p(m −n) mod pr+2.
The proof is an easy generalization of the lemma and is left as an exercise. The
corollary states the following: For any x, y, diff(x, y) looks almost like the pr-
coskeleton of x, except diff(x, y) might contain at most 4 additional symbols
replaced with a symbol _ compared to the coskeleton.
Now we have seen that, if we delete the symbol _ from the pr-coskeleton of x,
we obtain an element of Sp, and in particular an inﬁnite concatenation of words of
the form:
12 . . .p′112 . . .p′21 . . .p′p′12 . . .p′⋆
where ⋆denotes any symbol.
As a consequence, if we delete the _ symbol from diff(x, y), we also obtain
inﬁnite concatenations of words of the same form, except that 4 symbols might be
missing in each block.

6
The Undecidability of the Domino Problem
333
This is formalized in the next proposition.
Proposition 6.4.26 Let W be the collection of blocks of size p2 of the form
4 . . . p′ 1 1 2 . . . p′ 2 1 . . . p′ p′ 1 2 . . . p′ ⋆1 2 3
where ⋆denotes any symbol. Let ˆW be the set of subwords of words of W of length
at least p2 −4.
Let x, y ∈Sp and suppose that x and y differ in more than one position.
Then h(diff(x, y)) ∈( ˆW)Z where h is the erasing morphism: h(_) = ϵ and
h(a) = a otherwise.
In particular, let x ̸= y ∈Sp. Then the image by h of every factor of diff(x, y) is
a factor of ( ˆW)Z
The words x and y may differ in only one position when xi = yi = ap(n + i) with
n ∈Z rather than n ∈Zp.
It would seem more natural to change the words in W so that the factor 123
appears at the beginning rather than at the end. The version we use is essentially
cosmetic but greatly simpliﬁes the proof.
What is interesting and nontrivial is that this proposition is a characterization of
words in Sp.
Deﬁnition 6.4.27 We say that a pair of words (x, y) satisﬁes property P if every
factor of h(diff(x, y)) (resp. h(diff(y, x))) is a factor of ( ˆW)Z.
Notice that “every factor of h(diff(x, y)) is a factor of ( ˆW)Z” is the same as
“h(diff(x, y)) ∈( ˆW)Z” when h(diff(x, y)) is a biinﬁnite word, however it also
makes sense even if diff(x, y) is a ﬁnite word, or is simply inﬁnite.
We are now in position to state the main theorem:
Theorem 6.4.28 Let p > 6.
Let x, y be two words over the alphabet {1, . . ., p −1} s.t.
•
x ∈W Z
•
y ∈W Z
•
For all k, the words x and σ k(y) have property P
Then x ∈Sp and y ∈Sp.
The theorem is an easy consequence of the following proposition:
Proposition 6.4.29 Suppose that x and y are composed of blocks of size p of the
form
1 2 . . . p′ ⋆

334
E. Jeandel and P. Vanier
and that for all k, the words x and σ k(y) have property P. Then x ∈W Z and
y ∈W Z
Proof of the Theorem Let S be the set of all conﬁgurations x s.t. there exists y
s.t.:
•
x ∈(12 . . .p′⋆)Z
•
y ∈(12 . . .p′⋆)Z
•
For all k, the words x and σ k(y) have property P
Let x ∈S and y that witnesses it. Upto shift, we may suppose that yi = xi = i
mod p for i ̸= p. Let x′
i = xpi and y′
i = ypi.
By the previous proposition, x ∈W Z which implies that x′ ∈(12 . . .p′⋆)Z, and
the same is true for y′.
Furthermore, we can prove that x′ and y′ satisfy property P. Indeed we have
h(diff(x′, σ k(y′))) = h(diff(x, σ pk(y))) as x and y have the same p-skeleton and
therefore disagree only on the positions that are inside x′ and y′.
Therefore we have proven that x′ ∈S. We conclude by Proposition 6.4.21.
Proof of the Proposition The proof of the proposition is quite technical and should
be skipped at ﬁrst read.
The various depictions here suppose that p = 10, that is p −1 = 9. The general
pictures can be obtained by replacing all occurrences of 9 with “p −1” and all
occurrences of 8 with “p −2”.
By taking shifts of x and y we can suppose wlog that xi = i mod p for i ̸= 0
mod p, and similarly for y. We will prove by comparing x and σ 2(y) that x and
y almost have the predescribed structure. Considering x and σ −2(y) will ﬁnish the
proof.
First we compare x and σ 2(y):
i mod p
4 . . . 8 9 0 1 2 3
x
4 . . . 8 9 ⋆1 2 3
σ 2(y)
6 . . . ⋆1 2 3 4 5
z = diff(x, σ 2(y) 4 . . . ? 9 ? 1 2 3
The ⋆symbol corresponds to positions in x and σ 2(y) where the value is currently
unknown. The only symbols in z = diff(x, σ 2(y)) that could be equal to the symbol
_ are the question mark symbols. By assumption, we know that h(z) ∈( ˆW)Z.
This gives us a decomposition of z into blocks: write z = . . . w−1w0w1 . . . s.t.
h(wi) ∈ˆW.
It should be obvious that the only possibility is for each wi to be of size exactly
p2, and to be of the form 45 . . .p′ ⋆45 . . .. . . p′ ⋆123. Indeed, z contains the factor
“34” periodically with period p, and this factor appear at most p −1 times inside a
word of ˆW (which is of length between p2 −4 and p2), so at least one out of every
p occurrences of the factor “34” should correspond to the last letter of a word in ˆW
followed by the ﬁrst letter of a word in ˆW, which proves the result.

6
The Undecidability of the Domino Problem
335
We now look at each word wi independently. We will look at the situation from
the point of view of editing distance:
wi
4 5 . . . ? 9 ? 1 2 . . . ? 9 ? 1 . . . . . . ? 9 ? 1 2 . . . 9 ? 1 2 3
t
4 5 . . . 8 9 1 1 2 . . . 8 9 2 1 . . . . . . 8 9 9 1 2 . . . 9 ⋆1 2 3
The question marks inside wi represents symbols that are either equal to the symbol
of x, or are equal to the symbol _. The word t is a word of W. We know that wi,
when deleting the _ symbols, is equal to a word of ˆW, i.e. equal to the word t with
at most 4 symbols removed. In other words, we should delete at most 4 symbols
from wi, and that can only be done in the places where the _ symbol appears, and
add at most 4 symbols to obtain the word t depicted.
This is only possible if every symbol of wi which is not a _ symbol has the same
value that the symbol at the same position in t.
We now look at the p2 symbols of x that correspond to wi. We have just said that
any symbol of x that was not changed into a symbol _, that is, every position in x
that contains a different value that σ 2(y), has the same symbol as t. Now looking
back at the table, the only possibility for a ⋆symbol in x (i.e. a symbol for which
we did not know previously the value) to become a _ symbol, if if this symbol was
actually a symbol 2.
We have therefore proven that the p2 symbols of x that correspond to wi are of
the form
4 5 . . . 8 9 1 1 2 . . . 8 9 2 1 . . . . . . 9 9 1 2 . . . 9 ⋆1 2 3
where at most 4 of the underlined symbols might actually have been replaced by
the symbol 2. Thus x is a concatenation of blocks of W where at most four symbols
might have been replaced with the symbol 2.
We now start the reasoning again with x and σ −2(y), which proves that x is a
concatenation of blocks of W, where at most four symbols might have been replaced
with the symbol p −2.
Both situations cannot happen simultaneously unless no symbols were actually
replaced, i.e. x ∈W Z.
Corollary 6.4.30 There exists a soﬁc shift X s.t. the distance shift XΔ correspond-
ing to X is exactly Sp × Sp. In particular the distance shift has no periodic point
and therefore gives rise to an aperiodic 2-dimensional SFT.
Proof The soﬁc shift is the set of all x, y s.t.
•
x ∈W Z
•
y ∈W Z
•
(x, y) satisfy property P.
The only nontrivial part of this statement might be that the set of all (x, y) that
satisfy property P is a soﬁc shift.

336
E. Jeandel and P. Vanier
Indeed, let W be the language of ˆW Z, i.e. the set of all factors of words in ˆW Z.
W is easily seen to be a regular language as ˆW is ﬁnite. Now let L be the set of all
words (u, v) over the alphabet (A × A) s.t. h(diff(u, v)) ∈W. Then L is a regular
language as the inverse image by a morphism of a regular language. The set of (x, y)
all factors of which are in L is therefore a soﬁc shift.
6.4.5
Undecidability for Distance Shifts
In this section we will brieﬂy describe what should be changed to prove that there
is no algorithm that decide if a distance shift is empty.
The subshift X we build in the previous corollary codes the distance shift Sp×Sp.
Now suppose that the letters are colored with two colors, gray and light gray. We do
the same construction, but taking for W all words where color alternates between
the levels. That is, W contains all words of the form
4 · · · p 1 1 2 · · · p 2 1 2 · · ·· · ·· · · p p 1 2 · · · p
1 2 3
and all words of the form
4 · · · p 1 1 2 · · · p 2 1 2 · · ·· · ·· · · p p 1 2 · · · p
1 2 3
and we take as a soﬁc subshift the set X of all pairs (x, y) s.t.:
•
x and y are of the form

1 2 · · · p′ ⋆
Z
•
(x, y) satisfy property P (for this new set W)
The reader should be convinced that the previous reasoning go through and that
the distance shift deﬁned by X is exactly the same as Sp × Sp except that symbols
are colored depending on their valuation (remember that the valuation of an integer
n , or a p-adic number n , is k if pk is the greatest integer that divides n). More
precisely if xi = ap(i + n) for n ∈Zp, then xi is light gray if i + n is of valuation
k for k even, and dark gray otherwise.
We can go a bit further. Let B be a ﬁnite alphabet. Let P ⊆B × B. We now look
at words over the alphabet {1, 2, . . ., p −1} × B. Symbols in {1, 2, . . ., p −1} and
symbols and B will be written in two different layers to simplify the exposition.
Consider the following set of words W:
4 . . . p′ 1 1 2 . . . p′ 2 1 . . . p′ p′ 1 2 . . . p′ ⋆1 2 3
a . . . a b a a . . . a b a . . . a b a a . . . a ⋆a a a
for all pairs (a, b) ∈P.

6
The Undecidability of the Domino Problem
337
And we take as a soﬁc subshift the set X of all pairs (x, y) s.t.:
•
x and y are of the form
1 2 . . . p′ ⋆1 2 . . . p′ ⋆1 2 . . . p′ ⋆...
a0 a0 . . . a0 ⋆a0 a0 . . . a0 ⋆a0 a0 . . . a0 ⋆...
•
(x, y) satisfy property P (for this new set W)
Now the distance shift deﬁned by this new set X as the following form: Its
elements are pairs (x, y) ∈Sp × Sp. Furthermore, if xi = ap(i + n) then:
•
xi has the symbol a0 if i + n is of valuation 0
•
All positions j s.t. j + n is of valuation k ∈N contain the same symbol ak
•
For all k, (ak, ak+1) ∈P
Now suppose that B are one-dimensional Wang tiles and that P codes the
adjacency relation: (t, t′) ∈P if t′ can be placed on the right of t.
Then it is is easy to see that this distance shift codes somehow a tiling of N by
this set of Wang tiles.
It seems a strange idea to code a tiling in this complicated way, but we have
gained something here: we were able to ﬁx the tile that should be in position 0
(namely the symbol a0). This is fundamental: As we saw earlier, this is precisely the
difﬁculty in proving the undecidability of the domino problem: ﬁnd a way to ﬁx the
symbol at position (0, 0).
To obtain the undecidability of the domino problem, we therefore have to ﬁnd a
way to do the same construction but for two-dimensional Wang tiles.
The idea is to construct a distance shift that code Sp × Sq for two different
(relatively prime) values p and q. Using the same idea as explained before, we
will be able to guarantee that all positions of valuation k for p and k′ for q have
the same symbol ak,k′, that the symbol a0,0 is the predescribed symbol, and that the
pairs (ak,k′, ak+1,k′) and (ak,k′, ak,k′+1) satisfy the horizontal and vertical rules.
6.4.6
Bibliographic Notes
Our presentation differs greatly from the previous presentations by Aanderaa-Lewis
[1] and Lewis [36]. In fact, the concept of p-adic numbers, of subshifts and soﬁc
shifts are not present in the original articles. Aanderaa and Lewis introduce in
particular the notion of perfect tilings, normal tilings and admissible tilings; The
admissible tilings they deﬁne in a awkward way are just the elements of the subshift
generated by the normal tilings.
There are important differences between the construction of Aanderaa-Lewis
and the construction we gave here. In fact, the concept of distance shift that they
use are called sampling systems, and are apriori weaker than distance shifts. As a

338
E. Jeandel and P. Vanier
consequence, they are not able to obtain a construction for something as simple as
Sp × Sp.
The construction they obtain correspond more or less to Tp × Tp where Tp is the
subshift generated by the word u deﬁned by un = bp(n) where bp(n) are the last
two nonzero coefﬁcients in the expansion of n in base p, i.e. b10(13,370) = 37 and
b10(13,070) = 07. The subshift they build is actually bigger than Tp × Tp: Each
cell n contains in theory the last two nonzero coefﬁcients in the expansion of n in
base p, but the second-to-last coefﬁcient (the “3” in b10(13,370) = 37) can actually
differ from his normal value, but in a controlled way.
6.5
The Construction of Kari
We now present the construction by Kari [31] for which the technique is very
different from the ones of Berger and Anderaa-Lewis.
We will ﬁrst present a construction of an aperiodic tileset that was initially
designed to have a very small number of tiles, and then we will explain what to
change to obtain the undecidability of the Domino Problem. The presentation here
is inspired by the two groundbreaking articles of Kari [31, 32], see also [16].
While the Anderaa-Lewis construction can be explained through p-adic num-
bers, the core of Kari’s construction is to represent numbers in a bi-inﬁnite way so
that each row of the tileset represents a different number. For the small aperiodic
tileset, this will be enforced by ensuring that a row on top of another one can only
be obtained by multiplying the previous number by a factor 2 or a factor 2
3. The fact
that it is not possible to obtain 1 by any multiplication of 2’s and 2
3’s will imply
aperiodicity.
Let us ﬁrst talk about the bi-inﬁnite representations of numbers that will be used.
6.5.1
Balanced Representations of Reals
Deﬁnition 6.5.1 Let α be a positive real number, a ∈{⌊α⌋, (⌊α⌋+ 1)}Z is a
balanced representation of α iff for any subword a[i,i+n−1] we have:
nα −1 ≤
i+n−1

k=i
ak ≤nα + 1
In other words, a balanced representation of a real number is a sequence
composed only of its two nearest integers where the average over ﬁnite subwords of
length n is within 1
n of α. This means in particular that if we take longer and longer
subwords, their average converges to α.

6
The Undecidability of the Domino Problem
339
Fig. 6.24 The Beatty
sequence and balanced
representation of φ = 1+
√
5
2
.
The ones and the twos of the
balanced representation
correspond respectively to
cutting a vertical and a
horizontal integer line
= ... 1, 2, 1, 2, 2, 1, 2, 1, ...
= ... 0, 1, 3, 4, 6, 8, 9, 11,12, ...
Such a balanced representation for a ﬁnite word is easy to construct by means of
Beatty sequences [6]. Given a real number α we denote B (α) its Beatty sequence,
with B (α)k = ⌊kα⌋. Informally, the Beatty sequence of a number α corresponds to
how many horizontal lines of the Z2 grid the line y = αx has crossed at coordinate
x, see Fig. 6.24.
Now if we take the sequence of ﬁrst differences of the Beatty sequence of α
b (α)k = B (α)k+1 −B (α)k,
it is a symbolic sequence on alphabet {⌊α⌋, ⌊α + 1⌋}. And it is a balanced
representation of α as for any i:
i+n−1

k=i
b (α)k = ⌊(i + n)α⌋−⌊iα⌋
and
nα −1 ≤⌊(i + n)α⌋−⌊iα⌋< nα + 1.
So the sequence b (α) is a balanced representation of α it is also sometimes called
the β-sequence for α, see [42], or a rotation sequence [18]. It is interesting to note
that when α is irrational this sequence corresponds to the sturmian word for the
cutting line y = αx.

340
E. Jeandel and P. Vanier
6.5.2
Multiplying Balanced Representations
Given a positive rational number q = n
m, it turns out that by multiplying a balanced
representation of (ai)i∈Z of some real number α by q one still obtains a balanced
representation. We however have to deﬁne what we mean by multiplying a balanced
representation.
To multiply a by q we will multiply each digit individually while using a carry:
ci + qai = bi + ci+1
where ci and ci+1 are respectively the carry inherited from the previous multiplica-
tion and the carry sent to the next. With such a deﬁnition, when multiplying some
subword a[i,i+n−1] by q, one obtains a word b[i,i+n−1] with
ci + q
i+n−1

k=i
ak =
i+n−1

k=i
bk + ci+n.
See Fig. 6.25 for an example of multiplication of a balanced representation.
Lemma 6.5.2 If a is a balanced representation of some α then there exists a
balanced representation b of qα that can be obtained by multiplying a by q.
Furthermore, the set of carries being used is ﬁnite and only depends on q.
Proof Take b any balanced representation of qα. Since
nα −1 ≤
i+n

k=i
ai ≤nα + 1
and
nqα −1 ≤
i+n

k=i
bi ≤nqα + 1
we have
−(1 + q) ≤
i+n

k=i
qai −bi ≤1 + q
Fig. 6.25 An example of multiplication of a balanced representation. On the bottom row, a
balanced representation of φ + 1, on the top a balanced representation of 2
3(φ + 1). The carries are
shown in the middle

6
The Undecidability of the Domino Problem
341
Thus, it sufﬁces to take carries that are in [−(1 + q), (1 + q)], and because the ai’s
and bi’s are integers and q = n
m is a rational, the carries are the multiples of 1
m in
this interval.
We now know that this set of carries is ﬁnite, which would be sufﬁcient to
construct a tileset as will be seen in the next section. However Kari noticed that
it is possible to restrict oneself to a smaller set of carries by looking directly at how
the Beatty sequences for α and qα are related.
Lemma 6.5.3 The balanced sequence b (qα) can be obtained by multiplying b (α)
using carries belonging only to
S =

−n −1
m
, −n −2
m
, . . . , m −1
m

Proof Since
q⌊α⌋−1 < ⌊qα⌋< q(⌊α⌋+ 1)
we have that
−q < q⌊α⌋−⌊qα⌋< 1
which means in particular that for any α:
(q⌊α⌋−⌊qα⌋) ∈

−n −1
m
, −n −2
m
, . . . , m −1
m

Now suppose we have incarry ci ∈S and ci = qB (α)i−1 −B (qα)i−1:
ci + qb (α)i −b (qα)i = qB (α)i−1 −B (qα)i−1
+ qB (α)i −qB (α)i−1
−B (qα)i + B (qα)i−1
= (qB (α)i −B (qα)i)
= (q⌊iα⌋−⌊qiα⌋) ∈S
It is thus possible to obtain b (qα) by multiplying b (α) by q using only carries
from S.
So we now know that multiplying balanced representations by some positive
rational can yield balanced representations. Let us now see in the next subsection
how this translates to aperiodic tilings.

342
E. Jeandel and P. Vanier
6.5.3
An Aperiodic Tileset
The idea now is to use the fact that our multiplication uses only a ﬁnite number
of rational carries (see Lemma 6.5.2) to implement multiplication by using non-
deterministic transducers.
For a multiplication by q = n
m, the states will correspond to the possible carries:
S =

−n −1
m
, −n −2
m
, . . . , m −1
m

The idea is to take balanced representations of numbers that belong only to the
interval [1, 3], avoiding any possible representation of 0. In particular, numbers in
[1, 1.5] will be multiplied by 2 and numbers in [1.5, 3] by 2
3. The alphabet on which
the transducers will act will hence be Σ = {1, 2, 3}. The transition table will contain
all transitions
s
a|b
−→s′
verifying aq + s = b + s′.
We can now construct a tileset corresponding to our transducer: for each
transition we get one tile where the bottom and top represent the input and the
output respectively and the left and right edges represent the inward carry and the
outward carry respectively.
So in order to apply multiplications by 2 and 2
3 we need two different transducers
and corresponding sets of tiles. We can assume their set of states is disjoint, up to
renaming the states. Limiting the output of the transducer multiplying by 2 to {2, 3}
de facto limits the input interval to [1, 1.5].
Figure 6.26 shows the tiles for 2 and Figs. 6.27 and 6.28 show the tiles for 2
3.
Lemma 6.5.4 The tileset T tiles the plane.
Proof Take some irrational real α in [1, 3], one can tile Z × N, by applying
iteratively a multiplication by 2 to b (α) when α ∈[1, 1.5] and a multiplication
1
2
-1
-1
2
3
-1
0
1
3
0
-1
1
2
0
0
0
-1
1,3
1,2
2,3
1,2
Fig. 6.26 On the left the transducer corresponding to multiplication by 2 and on the right the
corresponding tiles. Notice how the input must belong to {1, 2} and the outputs to {2, 3}, which
translates the fact that the input belongs to [1, 2] and the output to [2, 3]

6
The Undecidability of the Domino Problem
343
Fig. 6.27 The transducer
corresponding to
multiplication by 2
3 for inputs
in [1, 2] and outputs in [1, 3]
0
1
3
2
3
1
3
2,2
3,2
2,1
3,2
1,1
3,1
2,1
2,1
1,1
1,1
2,2
3,2
3,2
Fig. 6.28 The set of tiles for
the multiplication by 2
3. We
assume the 0 of this part of
the tileset is different from the
one of the multiplication by 2
3
2
0
0
2
1
0
1
3
1
1
0
1
3
1
1
1
3
0
3
2
1
3
1
3
2
2
1
3
1
3
2
1
1
3
2
3
2
1
1
3
0
3
2
1
3
1
3
3
1
1
3
2
3
2
2
2
3
0
1
1
2
3
1
3
3
2
2
3
2
3
by 2
3 when α ∈[1.5, 3]: the result always stays in [1, 3]. By compactness the tileset
then tiles the whole plane.
We now know that we can tile the plane aperiodically however, lines of a valid
tiling do not necessarily correspond to a balanced representation, we therefore still
have to prove that the tileset always tiles aperiodically.
Lemma 6.5.5 The tileset T tiles only aperiodically.
Proof Suppose T tiles periodically, then there exists a tiling c : Z2 →T periodic
in both directions. Let a and b be its horizontal and vertical periods respectively and
let xi be the ﬁnite sum of the values represented on top of c(1, i) to c(a, i). Since
all the values are positive, xi cannot be zero. And since the carry on the left is equal
to the carry on the right of the period, xi = qix(i−1) with qi equal to 2 or 2
3.
Therefore, x0 = qn · · · q1x0 which is imposible since no nonempty product of
2’s and 2
3’s can equal 1.
See Fig. 6.29 for an example of tiling by this tileset. The tileset obtained here is
not Kari’s tileset but a tileset built using the same techniques. Kari’s original tileset
used only numbers in the interval [ 1
2, 2] but still used multiplications by 2 and 2
3 and
used a technical trick to avoid 0.

344
E. Jeandel and P. Vanier
3
2
1
3
1
3
2
2
1
3
1
3
3
1
1
3
2
3
3
2
2
3
2
3
2
2
2
3
0
3
2
0
0
2
1
0
1
3
3
2
1
3
1
3
3
2
1
3
1
3
2
2
1
3
1
3
2
3
2
1
1
3
0
2
1
0
1
3
1
1
1
3
0
2
1
0
1
3
2
1
1
3
2
3
2
2
2
3
0
1
1
0
1
3
2
1
1
3
0
2
1
0
1
3
2
1
1
3
2
3
2
3
1
2
0
0
1
2
0
0
1
3
0
-1
1
2
-1
-1
1
2
-1
-1
2
3
-1
0
1
2
0
0
1
2
0
0
1
3
0
-1
1
2
-1
-1
2
2
2
1
3
1
3
2
1
1
3
0
3
2
0
0
2
1
0
1
3
2
2
1
3
1
3
3
1
1
3
2
3
2
2
2
3
0
2
1
0
1
3
3
2
1
3
1
3
2
2
1
3
1
3
2
3
2
1
1
3
0
1
1
0
1
3
2
1
1
3
0
1
1
0
1
3
2
1
1
3
0
1
1
0
1
3
2
1
1
3
0
1
1
0
1
3
2
1
1
3
0
2
1
0
1
3
2
3
1
2
0
0
1
2
0
0
1
2
0
0
1
2
0
0
1
2
0
0
1
2
0
0
1
2
0
0
1
2
0
0
1
2
0
0
1
2
0
0
2
2
1
1
3
2
3
2
2
2
3
0
2
1
0
1
3
2
1
1
3
2
3
2
2
2
3
0
2
1
0
1
3
2
2
1
3
1
3
2
1
1
3
0
2
1
0
1
3
2
2
1
3
1
3
2
3
1
3
0
-1
2
3
-1
0
1
3
0
-1
1
2
-1
-1
2
3
-1
0
1
3
0
-1
2
3
-1
0
1
2
0
0
1
3
0
-1
2
3
-1
0
2
3
2
1
3
1
3
3
2
1
3
1
3
3
2
1
3
1
3
2
2
1
3
1
3
3
2
1
3
1
3
3
1
1
3
2
3
3
2
2
3
2
3
2
2
2
3
0
3
2
0
0
3
2
0
0
2
3
2
1
1
3
0
2
1
0
1
3
2
1
1
3
2
3
2
2
2
3
0
2
1
0
1
3
1
1
1
3
0
2
1
0
1
3
2
2
1
3
1
3
2
1
1
3
0
2
1
0
1
3
2
3
1
2
0
0
1
3
0
-1
1
2
-1
-1
2
3
-1
0
1
2
0
0
1
3
0
-1
1
2
-1
-1
2
3
-1
0
1
2
0
0
1
2
0
0
2
2
2
1
3
1
3
3
1
1
3
2
3
2
2
2
3
0
3
2
0
0
2
1
0
1
3
3
2
1
3
1
3
2
2
1
3
1
3
3
1
1
3
2
3
2
2
2
3
0
2
1
0
1
3
2
3
2
1
1
3
0
1
1
0
1
3
2
1
1
3
0
2
1
0
1
3
1
1
1
3
0
2
1
0
1
3
2
1
1
3
2
3
1
1
2
3
1
3
2
1
1
3
2
3
1
1
2
3
1
3
2
3
1
2
0
0
1
2
0
0
1
2
0
0
1
2
0
0
1
3
0
-1
1
2
-1
-1
1
2
-1
-1
1
2
-1
-1
1
2
-1
-1
1
2
-1
-1
2
2
1
1
3
2
3
2
2
2
3
0
2
1
0
1
3
2
2
1
3
1
3
3
1
1
3
2
3
2
2
2
3
0
2
1
0
1
3
2
2
1
3
1
3
2
1
1
3
0
2
1
0
1
3
2
3
1
3
0
-1
2
3
-1
0
1
3
0
-1
2
3
-1
0
1
3
0
-1
2
3
-1
0
1
3
0
-1
2
3
-1
0
1
3
0
-1
1
2
-1
-1
2
3
2
1
3
1
3
3
2
1
3
1
3
3
2
1
3
1
3
3
2
1
3
1
3
3
2
1
3
1
3
3
2
1
3
1
3
3
2
1
3
1
3
3
2
1
3
1
3
3
2
1
3
1
3
2
2
1
3
1
3
Fig. 6.29 An example of tiling, the bottom row starts from the balanced representation of φ + 1,
and the transducers are then applied according to which interval the resulting multiplied integer
belongs to

6
The Undecidability of the Domino Problem
345
6.5.4
Undecidability
What is interesting about this construction of aperiodic tilesets is that it allows a
different encoding of computation: we will use piecewise afﬁne maps in order to
encode computations. While in the usual encoding of Turing machines in tilesets, the
head and the current state are explicitly encoded in some tile, using piecewise afﬁne
functions will allow to encode the state implicitly in two real numbers representing
the full instantaneous description of the Turing machine at some timestep.
6.5.4.1
Computing with Piecewise Afﬁne Maps
Let us ﬁrst explain how Turing machine computations may be encoded by piecewise
afﬁne maps. Let M be a Turing machine working on alphabet Γ = {0, 1} and with
state set Q = {0, . . . , n}.
Let (c, h, q) ∈Γ Z×Z×Q be an ID of said Turing machine. We will encode this
ID inside two real numbers (l, r) so that the fractional part of l and r will encode the
left and right side of the inﬁnite tape respectively and ⌊l⌋will encode the symbol
currently under the head and ⌊r⌋the current state of the machine. This encoding
will be done in a way reminiscent of Cantor middle thirds: if the symbol currently
under the head is 1, then l ∈[2, 3] and if it is 0 then l ∈[0, 1].
Knowing the state of the machine is thus equivalent to determining to which
[k, k + 1[ interval r belongs to, moving to a new state corresponds to adding/-
substracting some integer to r and moving the head corresponds to shifting
(multiplying) the tape and writing the new symbol (adding a constant).
The transition function hence corresponds to applying a rational piecewise afﬁne
map depending only on ⌊r⌋and ⌊l⌋. This map will not be deﬁned on [1, 2] reﬂecting
the fact that [1, 2] does not code for any valid symbol of the tape.
Let’s see an example, with the Turing machine in state q and the following tape:
. . . 0000101001001.1.0101010101010101010 . . .
(l, r) can be as follows:
l = 2.2002002020000 . . .
r = q.0202020202020202020 . . .
If the machine goes from state q to state q′, writes s and shifts the tape to the right,
it is equivalent to do the following operations on l and r:
l := (l −⌊l⌋) · 10
r := ((r −⌊r⌋) + 2 · s)/10 + q′

346
E. Jeandel and P. Vanier
which leads to the following new values of l and r:
l = 2.002002020000 . . .
r = q′.(2s)0202020202020202020 . . .
Thus our Turing machine has become a set of afﬁne maps whose application
depend only on which rational intervals r and l belong to. Let us now formalize
this.
Deﬁnition 6.5.6 (l, r) is a valid coding of ID (c, h, q) iff
•
for any i ∈N, 10(10i · l −⌊10i · l⌋) is in [0, 1] when ch−i = 0 and is in [2, 3]
when ch−i = 1,
•
for any i ∈N∗, 10(10i · r −⌊10i · r⌋) is in [0, 1] when ch+i = 0 and is in [2, 3]
when ch+i = 1,
•
and ⌊r⌋∈Q.
Theorem 6.5.7 Let M be a Turing machine and f a piecewise afﬁne map con-
structed as stated before:
1. If c is an ID of M, and (l, r) a valid coding of c, then f (l, r) is a valid coding of
c′ the ID obtained after one more step of M.
2. If (l, r) is such that f n(l, r) is deﬁned for all n ∈N, then there exists an ID c
and a valid coding (l′, r′) of c such that f n(l′, r′) is deﬁned for all n ∈N.
Proof (1) is straightforward. For (2), let (l, r) be such reals, suppose (l, r) is not
a valid coding, and let l = ∞
i=0 li10−i and r = ∞
i=0 ri10−i, since (l, r) is not
valid, this means that some li and ri are not zeroes or twos, but since f n(l, r) is
always deﬁned, this also means that these never appear as l0, so the computation
to which they correspond is a computation that never reaches them. It then sufﬁces
to replace them by zeroes to obtain a valid coding, c then corresponds to this valid
coding. See [12] for a more precise proof.
Using two disjoint sets like [0, 1] and [2, 3] allows us to avoid some decoding
problems that would necessarily happen if the tape was directly coded with its
representation in binary.3
6.5.4.2
Undecidability of the Domino Problem
The piecewise afﬁne map that we have constructed can easily be transformed into a
set of tiles: it has rational coefﬁcients, adding or substracting a rational number can
be done in a similar way to what was done for multiplication and the fact that we
3The representations 0.100 . . . and 0.011 . . . code the same real but should not encode the same
tape.

6
The Undecidability of the Domino Problem
347
are now considering two reals and not only one does not constitute an obstacle, the
transducers can as easily be constructed.
The outputs of any transducer coding for a transition will belong either to {0, 1}
or to {2, 3}, thus ensuring that numbers written on one row either belong to [0, 1] or
to [2, 3] and that invalid codings can never appear as a result of applying piecewise
afﬁne map.
In order to obtain the undecidability of the domino problem, we will use the
immortality problem:
Theorem 6.2.9 (Hooper [25]) There is no algorithm that, given a Turing machine
M, decides if M halts on all conﬁgurations.
This is still true if we restrict ourselves to Turing machines with a working
alphabet of size 2.
By not having any representation for any halting state in the tileset corresponding
to the piecewise afﬁne map, any tiling by this tileset will represent an inﬁnite
computation of our Turing machine. And thus the tileset will only be able to tile
a half plane if the Turing machine is immortal, by compactness, if the tileset tiles
the half plane, it tiles the whole plane.
6.6
The Substitutive Method 2/2
The construction of an aperiodic tileset, and the undecidability result, that we
describe in this section comes from the work of Durand, Romashchenko and Shen
[14] and is inspired by the work of Gács in the 70’s.
We saw in Sect. 6.3 the concept of an intrinsically substitutive tileset, and we
gave an example of such a tileset. However, we gave no indication how this tileset
was obtained, or how to prove in general that such a tileset should exist. The core of
the construction of Durand, Romashchenko and Shen is to use recursion theory to
prove this.
We will ﬁrst redeﬁne more generally the notion of substitutive tiling, and of a
simulation
Deﬁnition 6.6.1 ([5, 13, 14, 43]) Let σ, τ be two tilesets.
We say that σ simulates τ with zoom factor N if there exists a one-to-one
function φ : τ →σ N×N s.t.
•
For any ﬁnite pattern w, φ(w) is a valid tiling for σ precisely when w is a valid
tiling for τ.
•
For any tiling of the plane x by σ, there exist w s.t. φ(w) = x upto shift. More
precisely there exists a unique pair (i′, j′) ∈[0, N −1]×[0, N −1] and a unique
w s.t. xi+i′,j+j′ = φ(w)i,j .
The uniqueness property means that there is only one way to shift x to obtain an
image of φ.

348
E. Jeandel and P. Vanier
Theorem 6.6.2 ([14]) There exists a tileset that simulates itself.
We will explain in this section how this theorem is proven, and then how to apply
it to obtain the undecidabilty of the domino problem.
The idea is that, given a tileset τ, it is easy to build a tileset σ that simulates τ
with a given zoom factor N.
We now somehow want to have σ = τ in the previous construction.
How to do this is similar to the ﬁxed point theorem of recursion theorem,
which allows in particular to prove that functions that call themselves are (partial)
computable.
We will ﬁrst illustrate this ﬁxed point theorem in a particular example.
Suppose we want to compute recursively the factorial function, in a language
where recursion is not allowed. Here is what we would write in Python:
def f(n):
if n == 0:
return 1
else:
return n*f(n-1)
But in our ﬁctive language, recursion is not allowed, so we cannot write call f .
One solution is to have f call another function g, and then somehow set g to be
equal to f . A ﬁrst version would be:
def f(n):
if n == 0:
return 1
else:
return n*g(n-1)
g = f
In this example, g is a global variable that was somehow deﬁned before the deﬁnition
of f and then changed value afterwards. This is bad programming practice, so we
prefer to give it as an argument to f:
def f(g,n):
if n == 0:
return 1
else:
return n*g(g,n-1)
we can then call f with input (f, n) to obtain the result. This version would however
make type theorists jump out of their skin,4 as it not easy to ﬁnd what type is f .
4It however works in python.

6
The Undecidability of the Domino Problem
349
We will then proceed differently. Suppose that our programming language has a
way to convert the code of a program (which is just a string of characters) into a
function. Let call this procedure eval. Then we can write:
def f(x,n):
if n == 0:
return 1
else:
return n*eval(x)(x,n-1)
Now f is just a function that takes an integer and a string and outputs an integer.
Now if we feed f with n and its own code, then we obtain the factorial function.5
The tileset we will construct mimics exactly this idea.
6.6.1
The Fixed Point Theorem of Computability Theory
The generalization of what preceeds is called Kleene’s ﬁxed point theorem and is
one of the fundamental theorems of computability theory. Usually in computability
theory functions, strings, integers are all represented by ﬁnite binary sequences that
may be seen as integers, and thus all theorems are on computable functions on
integers.
Theorem 6.6.3 (Kleene’s Fixed Point)
If f : N × N →N is a computable
function, then there exists a computable function g such that f (g, n) = g(n).
Proof Let U be a universal program: given p, n1, . . . , nk as arguments, U computes
p with arguments n1, . . . , nk, that is to say:
U(p, n1, . . . , nk) = p(n1, . . . , nk).
This is essentially what the eval function from before does.
Consider s(p) = U(p, p), the function that applies p to its own code and denote
h(i, n) = f (s(i), n). Now set g(n) = h(h, n) we have:
g(n) = h(h, n) = f (s(h), n) = f (h(h), n) = f (g, n)
5Up to a few syntactic changes, the reasoning we took actually works in python, as shown by the
following two lines:
x = “lambda n,x: 1 if n == 0 else n*eval(x)(n-1,x)”
f = lambda n: eval(x)(n,x).

350
E. Jeandel and P. Vanier
One way to interpret this theorem is that there exists a function g that “mim-
ics” an inﬁnite application of f on itself: g(n) = f (g, n) = f (f (g, n)) =
f (f (f (. . .), n), n).
The universal Turing machine of the proof induces some overhead to the time
t(n) that the program p would take by itself on an input of size n. Using several
tapes, one can design a universal TM taking an overhead at most polynomial in
t(n), see for instance [4, 22].
The aim is to construct a tileset using Kleene’s ﬁxed point theorem to obtain a
self simulating tileset.
6.6.2
Simulating a Tileset with a Turing Machine
A tile can be summed up by the colors c = ⟨n, w, s, e⟩of its four borders:
w
n
e
s
And thus a tileset can be seen as a computable function g(c) that accepts when c
represents a tile belonging to the tileset and rejects otherwise:
Deﬁnition 6.6.4 A computable function g codes a tileset τ with k colors if:
•
g interprets its argument as a quadruplet of colors: g rejects if its input is not of
size 4 log k.
•
g accepts only when c represents a tile of τ.
Now if g is a function deﬁning a tileset τ, we are going to design a computable
function f (N, k, g, c) that veriﬁes if the tile c is in a tileset τ ′ simulating τ with
zoom factor N. That is to say, f builds the tileset τ ′ from g and then checks that its
input c belongs to it.
The tileset constructed by f will divide the plane into macrotiles, virtual tiles
formed by an N × N square of smaller tiles. Each macrotile then runs the function
g on input C = ⟨n, w, s, e⟩, the 4 colors coded in the border of the macrotile. The
program g is only allowed to accept, so that only valid macrotiles may be formed.
Let us now see the details.

6
The Undecidability of the Domino Problem
351
The tileset constructed by f ﬁrst starts by separating the grid into N ×N squares:
N
N
N
N
N
N
N
N
N
N
This can easily be done by having tiles that count modulo N, the borders of the
macrotile appearing on the transition between 0 and N −1:
i
(j + 1) mod N
(i + 1) mod N
j
The center of each macrotile then contains a zone on each side that represents
the color of the side and wires that route them towards a computation zone which
applies g to c:
nwse
g(n, w, s, e)
We make the computation zone of size N/2 × N/2 inside each macrotile.
If N is big enough, this computation zone has enough time and space to run g:
Theorem 6.6.5 If g codes τ with k colors, there exists N such that for any N′ > N,
f (N′, k, g, c) codes a tileset simulating τ with zoom factor N′.

352
E. Jeandel and P. Vanier
Proof Let t be an upper bound of the time taken by g on any accepting input of size
4 log k, when g is executed on a universal machine. We now take N = 2t.
Let N′ > N. By our choice of N, the computation zone inside each macrotile
deﬁned by f (N′, k, g, c) is big enough for the computation of g to ﬁt.
In this case, each macrotile codes colors n, s, e, w on its border s.t. g(⟨n, s, e, w⟩)
accepts, i.e. the macrotile codes a tile of τ.
Therefore the whole tileset τ ′ is simulating τ with zoom factor N′.
6.6.3
A Fixedpoint Based Tileset
Wishful thinking would lead us to apply the ﬁxedpoint theorem to f however this
is not possible as is for several reasons:
•
First, g does not take the same arguments as f . As deﬁned before, g supposes
that N and k are externally deﬁned.
•
N and k would depend on the size of f to be deﬁned.
The solution to this is straightforward and is to make k and N become arguments
of g. The only modiﬁcation needed in the previous construction for is to hardcode N
and k as inputs of g inside the macrotiles that are constructed by f . As the number
of tiles generated by f is O(N2), this means that taking k = N2 colors is sufﬁcient
to code them all. Furthermore, there is always room in the macrotiles to carry N2
colors, as this only takes 2 log N bits.
So we now have a function f (g, N, c) which takes a function g(N, c) as an
argument.
It now sufﬁces to apply Kleene’s ﬁxed point theorem to f . We obtain a new
program ρ such that f (ρ, N, c) = ρ(N, c).
Theorem 6.6.6 There exists N such that for any n > N, ρ(N, c) codes a tileset τ
simulating itself with zoom factor N.
Proof As f is polynomial in log N, |g| and |c|, this means that ρ’s runtime is
polynomial in log N. So taking N ≫poly(log N) sufﬁces to have enough runtime
inside the macrotiles.
ρ deﬁnes a tileset τ which produces macrotiles of size N × N that themselves
check if they belong to τ by running ρ in their computation zone. Thus ρ simulates
itself with zoom factor N.
We can now show that τ indeed tiles the plane by inductively deﬁning macrotiles
of level k, this will also give us a picture of what tiling by τ look like:
•
The macrotiles of level 0 are the macrotiles formed by N × N squares of tiles of
τ.
•
The macrotiles formed N × N squares of macrotiles of level k are macrotiles of
level k + 1, see Fig. 6.30.

6
The Undecidability of the Domino Problem
353
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p(n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
p( n, w, s, e)
n
w
s
e
f n, w, s, e
Fig. 6.30 An N × N square of macrotiles of level k forms a macrotile of level k + 1
τ does indeed tile the plane since for any k one can tile an N2k × N2k square just
by taking a macrotile of level k, which implies that there exists a tiling of the plane,
by compactness.
One may also show that τ is aperiodic:
Lemma 6.6.7 A tileset that simulates itself is aperiodic.
Proof Let T be a tileset that simulates itself with zoom factor N and suppose it is
periodic. Since any tiling is uniquely subdivided in N × N zones, the period must
be divisible by N. However, since the tileset simulates itself, any tiling can also be
uniquely subdivided in N2 × N2 zones, so N2 must also divide the period. By the
same argument this must be true for any N2k, which is impossible.
6.6.4
Undecidability
The tileset τ we constructed in the previous subsection, while aperiodic, does
not prove the undecidability of the Domino Problem. In order to do this, given a
Turing machine M we will construct τM in a similar fashion, but we will embed
computations of M into the macrotiles which will prevent the tileability in case M
halts.
We cannot use exactly the construction from before, as a zoom factor of N for
each level of macrotiles will mean that the macrotiles of different levels have the
same computation space and thus all computations would be bounded by the same
N. The goal being that macrotiles of level k simultaneously generate macrotiles of
level k + 1 and simulate a computation of M for more and more time steps.

354
E. Jeandel and P. Vanier
Thus, if M halts, some macrotile of level k would uncover it and prevent the
formation of macrotiles of level k + 1 and the tileset to tile the plane.
To achieve this, instead of making f hardcode N as an input to g, f hardcodes
2N. Thus the computation zone is doubled with each simulation. So now a macrotile
of level k + 1 divides the plane in 2kN × 2kN macrotiles of level k. And the
computation zone inside the macrotiles of level k + 1 now is 2kN/2.
The program run by a macrotile can be summed up by the following pseudocode:
def f (g, N, c):
constuct Tk: a tileset dividing the plane in N × N
macrotiles which contain a
computation of g(2N, c′).
if c ̸∈Tk:
reject
else:
launch N/2 timesteps of the simulation of M
if the simulation halts reject
Instead of a constant zoom factor between the different levels, each level k now
has zoom factor Nk = 2kN which gives more and more computational room. So
each level of macrotiles now ensures more simulation steps of M and thus if M
halts, it will happen at some ﬁnite level which will prevent the tileability.
6.6.5
Bibliographic Notes
The ﬁxed point tileset construction originally appeared in [15]. Its versatility
allowed Durand, Romashchenko and Shen to prove new and original results on
tilings as well as reprove ancient results [14]. For instance, among the results
that can be proven with almost no modiﬁcations of the construction is a result
by Hanf and Myers [21, 41] stating that there exists tilesets producing only non
computable tilings of the plane. Other results that can be proved using variations of
this technique include:
•
Substitutive tilesets deﬁned by a rectangular substitution are soﬁc, as was proved
by Mozes [40].
•
d-dimensional effective subshifts are subactions of d + 1 dimensional soﬁc
subshifts, a result originally discovered only with d + 2-dimensional soﬁc shifts
by Hochman [23].
•
A characterization of the entropy of tilings by right recursively enumerable
numbers (Hochman and Meyerovitch [24]).
•
That there exists tilesets robust to errors.
•
A characterization of the set of non-expansive directions of tilings [54].
•
The subshift whose conﬁgurations are constituted only of squares whose sizes
are chosen from a co-recursively enumerable set [53].

6
The Undecidability of the Domino Problem
355
References
1. S.O. Aanderaa, H.R. Lewis, Linear sampling and the ∀∃∀case of the decision problem. J.
Symb. Log. 39(3), 519–548 (1974). See also [H.R. Lewis, Unsolvable Classes of Quantiﬁca-
tional Formulas (Addison-Wesley, Reading, 1979)]
2. C. Allauzen, B. Durand, Tiling problems. in The Classical Decision Problem, Perspectives in
Mathematical Logic, chap. A (Springer, Berlin, 2001), pp. 407–420
3. R. Ammann, B. Grunbaum, G. Shephard, Aperiodic tiles. Discret. Comput. Geom. 8(1), 1–25
(1992)
4. S. Arora, B. Barak, Computational Complexity: A Modern Approach, 1st edn (Cambridge
University Press, New York, 2009)
5. A. Ballier, Propriétés structurelles, combinatoires et logiques des pavages. Ph.D. thesis, Aix-
Marseille Université (2009)
6. S. Beatty, Problem 3173. Am. Math. Mon. 33, 159 (1926)
7. R. Berger, The Undecidability of the Domino Problem. Ph.D. thesis, Harvard University (1964)
8. R. Berger, The Undecidability of the Domino Problem. No. 66 in Memoirs of the American
Mathematical Society (The American Mathematical Society, Providence, 1966)
9. J.R. Büchi, Turing-Machines and the Entscheidungsproblem. Math. Ann. 148(3), 201–213
(1962). https://doi.org/10.1007/BF01470748
10. J.R. Chazottes, J.M. Gambaudo, F. Gautero, Tilings of the plane and Thurston semi-norm.
Geom. Dedicata 173(1), 129–142 (2014). https://doi.org/10.1007/s10711-013-9932-4
11. A. Church, An unsolvable problem of elementary number theory. Am. J. Math. 58(2), 345–363
(1936)
12. P. Collins, J.H. van Schuppen, Observability of hybrid systems and turing machines, in 43rd
IEEE Conference on Decision and Control (2004), pp. 7–12. https://doi.org/0.1109/CDC.2004.
1428598
13. B. Durand, L.A. Levin, A. Shen, Local rules and global order, or aperiodic tilings. Math. Intell.
27(1), 64–68 (2004)
14. B. Durand, A. Romashchenko, A. Shen, Fixed-point tile sets and their applications. J. Comput.
Syst. Sci. 78(3), 731–764 (2012). https://doi.org/10.1016/j.jcss.2011.11.001
15. B. Durand, A. Shen, A. Romashchenko, Fixed Point and Aperiodic Tilings. Tech. Rep. TR08-
030, ECCC (2008)
16. S. Eigen, J. Navarro, V.S. Prasad, An aperiodic tiling using a dynamical system and Beatty
sequences, in Recent Progress in Dynamics. MSRI Publications, vol. 54 (Cambridge University
Press, Cambridge, 2007)
17. T. Fernique, N. Ollinger, Combinatorial substitutions and Soﬁc Tilings , in Journées Automates
Cellulaires (JAC), TUCS (2010), pp. 100–110
18. N.P. Fogg, in Substitutions in Dynamics, Arithmetics and Combinatorics, chap. Sturmian
Sequences. Lecture Notes in Mathematics (Springer, Berlin, 2002)
19. F. Gähler, A. Julien, J. Savinien, Combinatorics and Topology of the Robinson Tiling. Comptes
Rendus de l’Académie des Sciences de Paris, Série I—Mathématiques (2012), pp. 627–631.
https://doi.org/10.1016/j.crma.2012.06.007
20. C. Goodman-Strauss, Matching rules and substitution tilings. Ann. Math. 147(1), 181–223
(1998)
21. W. Hanf, Non recursive tilings of the plane I. J. Symbolic Log. 39(2), 283–285 (1974)
22. F.C. Hennie, R.E. Stearns, Two-tape simulation of multitape turing machines. J. ACM 13(4),
533–546 (1966). https://doi.org/10.1145/321356.321362
23. M. Hochman, On the dynamics and recursive properties of multidimensional symbolic
systems. Invent. Math. 176(1), 2009 (2009)
24. M. Hochman, T. Meyerovitch, A characterization of the entropies of multidimensional shifts
of ﬁnite type. Ann. Math. 171(3), 2011–2038 (2010). https://doi.org/10.4007/annals.2010.171.
2011

356
E. Jeandel and P. Vanier
25. P.K. Hooper, The undecidability of the turing machine immortality problem. J. Symbolic Log.
31(2), 219–234 (1966)
26. J.E. Hopcroft, J.D. Ullman, Introduction to Automata Theory, Languages and Computation
(Addison-Wesley, Reading, 1979)
27. E. Jeandel, M. Rao, An aperiodic set of 11 Wang tiles. Preprint
28. A. Johnson, K. Madden, Putting the pieces together: understanding Robinson’s nonperiodic
tilings. Coll. Math. J. 28(3), 172–181 (1997)
29. A. Kahr, E.F. Moore, H. Wang, Entscheidungsproblem reduced to the ∀∃∀case. Proc. Natl.
Acad. Sci. U. S. A. 48(3), 365–377 (1962)
30. J. Kari, The nilpotency problem of one-dimensional cellular automata. SIAM J. Comput. 21(3),
571–586 (1992)
31. J. Kari, A small aperiodic set of Wang tiles. Discret. Math. 160, 259–264 (1996)
32. J. Kari, The tiling problem revisited, in Machines, Computations, and Universality (MCU).
Lecture Notes in Computer Science, vol. 4664 (2007), pp. 72–79
33. J. Kari, N. Ollinger, Periodicity and immortality in reversible computing, in MFCS 2008.
Lecture Notes in Computer Science, vol. 5162 (2008), pp. 419–430
34. S. Kleene, Two papers on the predicate calculus., chap., in Finite Axiomatizability of Theories
in the Predicate Calculus Using Additional Predicate Symbols. No. 10 in Memoirs of the
American Mathematical Society (American Mathematical Society, Providence, 1952)
35. L.A. Levin, Forbidden information. J. ACM 60(2), 9:1–9 (2013). https://doi.org/10.1145/
2450142.2450145
36. H.R. Lewis, Unsolvable Classes of Quantiﬁcational Formulas (Addison-Wesley, Reading,
1979)
37. H.R. Lewis, C.H. Papadimitriou, Elements of the Theory of Computation (Prentice-Hall,
Englewood Cliffs, 1998)
38. D.A. Lind, B. Marcus, An Introduction to Symbolic Dynamics and Coding (Cambridge
University Press, New York, 1995)
39. M.L. Minsky, Computation: Finite and Inﬁnite Machines (Prentice-Hall, Englewood Cliffs,
1967)
40. S. Mozes, Tilings, substitutions systems and dynamical systems generated by them. J. Anal.
Math. 53, 139–186 (1989)
41. D. Myers, Non recursive tilings of the plane II. J. Symbolic Log. 39(2), 286–294 (1974)
42. R. Nillsen, K. Tognetti, G. Winley, Bernoulli (Beta) and Integer Part Sequences (Australian
Mathematical Society, Canberra, 1999)
43. N. Ollinger, Two-by-two substitution systems and the undecidability of the domino problem,
in CiE 2008. Lecture Notes in Computer Science, vol. 5028 (2008), pp. 476–485
44. C.H. Papadimitriou, Computational Complexity (Addison Wesley, Reading, 1995)
45. B. Poizat, Une théorie ﬁniement axiomatisable et superstable. Groupe d’études de théories
stables 3, 1–9 (1980)
46. R.M. Robinson, Seven polygons which permit only nonperiodic tilings of the plane. Not. Am.
Math. Soc. 14, 835 (1967)
47. R.M. Robinson, Undecidability and nonperiodicity for tilings of the plane. Invent. Math. 12(3),
177–209 (1971). https://doi.org/10.1007/BF01418780
48. O. Salon, Quelles tuiles! (Pavages apériodiques du plan et automates bidimensionnels). J.
Théor. Nombres Bordeaux 1(1), 1–26 (1989)
49. S.G. Simpson, Medvedev degrees of two-dimensional subshifts of ﬁnite type. Ergodic Theory
Dynam. Syst. 34, 679–688 (2014). https://doi.org/10.1017/etds.2012.152
50. A.M. Turing, On computable numbers, with an application to the entscheidungsproblem. Proc.
Lond. Math. Soc. s2-42(1), 230–265 (1937)
51. H. Wang, Proving theorems by pattern recognition II. Bell Syst. Tech. J. 40, 1–41 (1961)

6
The Undecidability of the Domino Problem
357
52. H. Wang, Dominoes and the ∀∃∀case of the decision problem, in Mathematical Theory of
Automata (1963), pp. 23–55
53. L.B. Westrick, Seas of squares with sizes from a Π0
1 set. Isr. J. Math. 222(1), 431–462 (2017).
https://doi.org/10.1007/s11856-017-1596-6
54. C. Zinoviadis, Hierarchy and expansiveness in 2d subshifts of ﬁnite type, in Proceedings of the
Ninth International Conference on Language and Automata Theory and Applications, LATA
2015, Nice, March 2–6, 2015 (2015), pp. 365–377

Chapter 7
Renormalisation of Pair Correlations
and Their Fourier Transforms
for Primitive Block Substitutions
Michael Baake and Uwe Grimm
Abstract For point sets and tilings that can be constructed with the projection
method, one has a good understanding of the correlation structure, and also of
the corresponding spectra, both in the dynamical and in the diffraction sense. For
systems deﬁned by substitution or inﬂation rules, the situation is less favourable, in
particular beyond the much-studied class of Pisot substitutions. In this contribution,
the geometric inﬂation rule is employed to access the pair correlation measures of
self-similar and self-afﬁne inﬂation tilings and their Fourier transforms by means
of exact renormalisation relations. In particular, we look into sufﬁcient criteria for
the absence of absolutely continuous spectral contributions, and illustrate this with
examples from the class of block substitutions. We also discuss the Frank–Robinson
tiling, as a planar example with inﬁnite local complexity and singular continuous
spectrum.
7.1
Introduction
The theory of model sets via the projection method, see [7, 56] and references
therein for background, has led to a reasonably good understanding of mathematical
models for perfect quasicrystals. This is particularly true of systems with pure point
spectrum, and applies to spectra both in the diffraction and in the dynamical sense;
see [7, 13, 14, 38, 40] and references therein for more, in particular on equivalence
results for the different types of spectra.
M. Baake
Fakultät für Mathematik, Universität Bielefeld, Bielefeld, Germany
e-mail: mbaake@math.uni-bielefeld.de
U. Grimm ()
School of Mathematics & Statistics, The Open University, Milton Keynes, UK
e-mail: uwe.grimm@open.ac.uk
© The Editor(s) (if applicable) and The Author(s), under exclusive license
to Springer Nature Switzerland AG 2020
S. Akiyama, P. Arnoux (eds.), Substitution and Tiling Dynamics: Introduction
to Self-inducing Structures, Lecture Notes in Mathematics 2273,
https://doi.org/10.1007/978-3-030-57666-0_7
359

360
M. Baake and U. Grimm
Another intensely-studied approach starts from a substitution on a ﬁnite alphabet,
or considers an inﬂation rule for a ﬁnite set of prototiles; see [7, 29, 55] and
references therein for more. If the inﬂation multiplier happens to be a Pisot–
Vijayaraghavan (PV) number, one meets an interesting overlap with the projection
method via systems that can both be described by inﬂation and as a regular
model set; see [7, Ch. 7] for some classic examples. However, the still open Pisot
substitution conjecture, compare [1, 51], shows that important parts of the picture
are still missing.
Considerably less is known for more general substitution or inﬂation schemes,
be it beyond the PV case, in higher dimensions, or both. In particular, the study
of non-PV substitutions is only at its beginning. Some recent progress [4, 6]
in one dimension was possible by realising that such systems admit an exact
renormalisation approach to their pair correlation measures; see [18, 19] for related
results on the spectral measures for these systems.
The purpose of this contribution is to show how to extend such an exact
renormalisation approach to higher dimensions, and also beyond the case of inﬂation
tilings of ﬁnite local complexity (FLC). To be able to discuss some interesting
classes of examples, we will build on several results from [6]. One of our goals is to
formulate an effective sufﬁcient criterion for the absence of absolutely continuous
(ac) diffraction, which then implies that the diffraction measure is a singular
measure, with the analogous result on the spectral measure of maximal type where
possible at present. This clearly is expected to be the typical situation for inﬂation
systems with vanishing topological entropy, but no general classiﬁcation is known
so far.
To formulate a criterion for the absence of ac components, it will be instrumental
to identify a natural cocycle attached to the inﬂation rule together with an appropri-
ate Lyapunov exponent. Implicitly, this amounts to an asymptotic analysis of inﬁnite
matrix products of Riesz product type. They have shown up in various ways in the
spectral theory of inﬂation systems [4, 10, 18, 19, 48]. It should not be surprising
to meet them again, in a slightly different fashion. In fact, they provide perhaps the
most natural point of entry for a renormalisation type analysis of inﬂation systems.
This contribution is both a summary of known results, including those from [3, 5,
6, 44], and their extension to some new territory, in particular in higher dimensions
(as announced in [45] and discussed in [6]). For the latter purpose, we proceed in
an example-oriented manner via the class of block substitutions (not necessarily of
constant size), which is still sufﬁciently simple to see the underlying ideas, yet rich
enough to illustrate some new phenomena. In particular, in view of recent general
interest [28, 31–33, 41, 55], we include some examples of inﬁnite local complexity
as well. Various general results that we employ are discussed and proved in [6], for
which we only give a brief account here.
The material presented below is organised as follows. In Sect. 7.2, we set the
scene by recalling some basic material, including some proofs for convenience,
in particular where we are not aware of a good reference. Section 7.3 continues
this account, covering some important aspects of uniform distribution and averages,
which will be instrumental in most of our later calculations. Then, in Sect. 7.4,

7
Renormalisation for Block Substitutions
361
we discuss inﬂation systems in one dimension, from the viewpoint of exact
renormalisation of the pair correlation measures and their Fourier transforms, with
one concrete example of recent interest being discussed in Sect. 7.5. For further fully
worked-out examples, we refer to [4, 5, 10, 44].
Starting with Sect. 7.6, we develop the entire theory for higher-dimensional
inﬂation tilings with ﬁnitely many prototiles up to translations, which is then applied
to various examples. In particular, we treat binary block substitutions of constant
size (Sect. 7.7) and a rather versatile family of block substitutions with squares
(Sect. 7.8), which comprises tilings with inﬁnite local complexity. This is also a
feature of the Frank–Robinson tiling (Sect.7.9), which is shown to have singular
continuous diffraction beyond the trivial Bragg peak at the origin. Some concluding
remarks and open problems follow in Sect. 7.10.
7.2
Preliminaries
Our general references for concepts, notation and background are [7, 9]. Here,
we collect further methods and results, where we begin with a simple property of
Hermitian matrices.
Fact 7.2.1 Let H = (hij)1⩽i,j⩽d ∈Mat(d, C) be Hermitian and positive semi-
deﬁnite, with rank m. Then, all diagonal elements of H are non-negative. If hii = 0
for some i, one has hij = hji = 0 for all 1 ⩽j ⩽d. In particular, H = 0 iff
m = 0.
Whenever H
̸= 0, there are m Hermitian, positive semi-deﬁnite matrices
H1, . . . , Hm of rank 1 such that H = m
r=1 Hr together with Hr Hs = 0 for r ̸= s.
Proof By Sylvester’s criterion, H positive semi-deﬁnite means that all principal
minors are non-negative, hence in particular all diagonal elements of H. Assume
hii = 0 for some i, and select any j ∈{1, . . ., d}. By semi-deﬁniteness in
conjunction with Hermiticity, one ﬁnds
0 = hii hjj ⩾hij hji = |hij|2 ⩾0,
which implies the second claim. The equivalence of H = 0 with m = 0 is clear.
Employing Dirac’s notation, the spectral theorem for Hermitian matrices asserts
that one has H = d
i=1 |vi⟩λi ⟨vi|, where the eigenvectors |vi⟩can be chosen to
form an orthonormal basis (so ⟨vi|vj⟩= δi,j and |vi⟩⟨vi| is a projector of rank 1),
while all eigenvalues are non-negative due to positive semi-deﬁniteness. The rank
of H is the number of positive eigenvalues, counted with multiplicities. Ordering
the eigenvalues as λ1 ⩾λ2 ⩾· · · ⩾λd ⩾0, one can choose Hr = |vr⟩λr ⟨vr| for
1 ⩽r ⩽m, and the claim is obvious.
⊓⊔

362
M. Baake and U. Grimm
7.2.1
Logarithmic Integrals and Mahler Measures
The logarithmic Mahler measure of a polynomial p ∈C[x] is deﬁned as
m(p) :=
 1
0
log
p

e2π it	 dt.
(7.1)
It was originally introduced by Mahler as a measure of the complexity of p; compare
[25]. If p(x) = a 2s
i=1(x −αi), it follows from Jensen’s formula [49, Prop. 16.1]
that
m(p) = log|a| +
s

i=1
log

max{1, |αi|}
	
.
(7.2)
This has the following immediate consequence.
Fact 7.2.2 If p is a monic polynomial that has no roots outside the unit disk, one
has m(p) = 0. In particular, this holds if p is a cyclotomic polynomial,1 or a
product of such a polynomial with a monomial.
⊓⊔
Clearly, for polynomials p and q, one has m(pq) = m(p) + m(q). If p ∈Z[x],
one can say more about the possible values of m(p). They are of interest both in
number theory and in dynamical systems; see [3, 25] and references therein.
Mahler measures of multivariate (or multi-variable) polynomials are deﬁned by
an integration over the corresponding torus. Concretely, for any p ∈C
3
x1, . . . , xd
4
,
one has
m(p) :=

Td log
p

e2π it1, . . . , e2π itd	 dt1 · · · dtd ,
(7.3)
where Td = Rd/Zd denotes the d-torus. Unfortunately, in contrast to the one-
dimensional situation, there is no simple general way to calculate such integrals. If
we need to single out a variable, we do so by a subscript. For instance, mx(1+x+xy)
denotes the logarithmic Mahler measure of 1 + x + xy, viewed as a polynomial in
x, with y being a coefﬁcient. We refer to [25] for general background and examples.
7.2.2
Radon Measures
Let μ denote a (generally complex) Radon measure on Rd, which we primarily view
as a linear functional over the space Cc(Rd) of compactly supported continuous
1A non-constant polynomial p ∈Z[x] is called cyclotomic if p(x) divides xn−1 for some n ∈N.

7
Renormalisation for Block Substitutions
363
functions. The ‘ﬂipped-over’ version μ is deﬁned by μ(g)
=
μ(g), where
g(x) := g(−x). A measure μ is called positive when μ(g) ⩾0 for all g ⩾0,
and positive deﬁnite when μ(g ∗g) ⩾0 for all g ∈Cc(Rd). Here, g ∗h
refers to the convolution of two integrable functions, as deﬁned by

g ∗h
	
(x) =
 
Rd g(x −y)h(y) dy. By |μ|, we denote the total variation measure of μ. If
|μ|(Rd) < ∞, the measure is bounded or ﬁnite, while we call it translation bounded
when supt∈Rd|μ|(t +K) < ∞holds for some compact set K ⊂Rd with non-empty
interior.
If f : Rd −→Rd is an invertible mapping, we deﬁne the pushforward f.μ of a
measure μ by f.μ	(g) = μ(g ◦f ), where g is an arbitrary test function. Viewing
μ as a regular Borel measure via the general Riesz–Markov representation theorem,
compare [50], the matching relation for a bounded Borel set E is

f.μ
	
(E) =

f.μ
	
(1E) = μ(1E ◦f ) = μ

1f −1(E)
	
= μ

f −1(E)
	
.
Of particular importance is the Dirac measure at x, denoted by δx, which is deﬁned
by δx(g) = g(x) for test functions. For Borel sets, the matching relation is
δx(E) =
#
1,
if x ∈E,
0,
otherwise,
which is often used in the form δx(E) = δx

1E
	
. For a point set S ⊂Rd, which is
at most countable in our setting [7], one deﬁnes the corresponding Dirac comb as
δS = 
x∈S δx.
When ν is absolutely continuous relative to μ, denoted by ν ≪μ, with Radon–
Nikodym density h, we write ν = hμ, so that

hμ
	
(g) = μ(hg). For the
pushforward, this leads to
f.(hμ) =

h ◦f −1	
· (f.μ),
(7.4)
as follows from a simple calculation with a test function. Now, when we have
f (x) = Ax with A ∈GL(d, R) and μ is Lebesgue measure, it is sometimes more
convenient to rewrite this relation as
A.h := f.h = h ◦f −1
|det(A)| = h ◦A−1
|det(A)| ,
(7.5)
to be understood as a relation between absolutely continuous measures. The
convolution μ ∗ν of two ﬁnite measures is deﬁned by

μ ∗ν
	
(g) =

Rd

Rd g(x + y) dμ(x) dν(y),

364
M. Baake and U. Grimm
which can be extended in various ways, in particular to the case where one measure
is ﬁnite and the other is translation bounded [16, Prop. 1.13].
Lemma 7.2.3 If μ and ν are two convolvable measures on Rd and if the mapping
f : Rd −→Rd is both invertible and linear, the pushforward operation satisﬁes the
relation f.(μ ∗ν) = (f.μ) ∗(f.ν).
Proof Let g be a general test function and deﬁne ga by ga(x) = g(a + x). Then,
one has
f.(μ ∗ν)	(g) =

Rd

Rd gf (x + y)	 dμ(x) dν(y)
=

Rd

Rd gf (x) + f (y)	 dμ(x) dν(y)
=

Rd μgf (y) ◦f 	 dν(y) =

Rd(f.μ)gf (y)
	 dν(y)
=

Rd

Rd gx + f (y)	 df.μ	(x) dν(y)
=

Rd

Rd gx
f (y)	 dν(y) df.μ	(x)
=

Rd ν(gx ◦f ) df.μ	(x) =

Rd
f.ν	(gx) df.μ	(x)
=

Rd

Rd g(x + y) df.ν	(y) df.μ	(x)
=

(f.ν) ∗(f.μ)
	
(g) =

(f.μ) ∗(f.ν)
	
(g),
where the step from the fourth to the ﬁfth line, as well as the last step, rely on
Fubini’s theorem.
⊓⊔
A linear map f on Rd is expansive if there exists a constant α > 1 such that
∥f (x)∥⩾α∥x∥for all x ∈Rd. This implies that all eigenvalues satisfy |λ| ⩾α
and that f is invertible.
Lemma 7.2.4 Let μ be a Radon measure on Rd such that μ|U = μ({0}) δ0 holds
for some open neighbourhood U of 0. Then, if f is an expansive linear map on Rd,
one has
lim
n→∞f n.μ = μ({0}) δ0.

7
Renormalisation for Block Substitutions
365
Proof Let E ⊂Rd be a ﬁxed, bounded Borel set. Viewing μ as a regular Borel
measure, one has f n.μ	(E) = μf −n(E)	. Since f is expansive, with expansion
constant α > 1, it is invertible, and f −1 is contractive, with ∥f −1(x)∥⩽1
α ∥x∥for
all x ∈Rd. Consequently, f −n(E) ⊂U for n sufﬁciently large.
Now, the set E contains 0 if and only if f −n(E) does, so

f n.μ
	
(E) = μ({0}) δ0(E)
for n large enough. Since E was bounded but otherwise arbitrary, our claim on the
measure μ follows.
⊓⊔
The Fourier transform of measures will play an important role in many of our
arguments. We follow the classical approach as outlined in [16, Ch. 1], see also
[7, Ch. 8] as well as [46], where the Fourier transform of an integrable function f
is given by

f (k) =

Rd e−2π i⟨k|x⟩f (x) dx
as usual, where ⟨·|·⟩denotes the standard inner product of Rd. If μ is a ﬁnite
measure, its Fourier transform is a continuous function, written as
μ(k) =

Rd e−2π i⟨k|x⟩dμ(x).
For translation-bounded measures, we shall also employ standard notions and
techniques from the theory of tempered distributions; compare [50, Sec. 6.2].
Below, we will make frequent use of a relation that tracks the consequence of an
invertible linear map under Fourier transform.
Lemma 7.2.5 Let μ be a Fourier-transformable measure on Rd, and consider a
matrix A ∈GL(d, R). Then, with A∗:= (AT )−1 denoting the dual matrix, one has
%
A.μ =
A∗.μ
|det(A)| .
Moreover, when μ is absolutely continuous relative to Lebesgue measure, hence
represented by a locally integrable function, the relation simpliﬁes to
%
A.μ = μ ◦AT = AT.μ.
Proof If g is an arbitrary test function, one has
%
A.μ (g) =

A.μ
	
(g) = μ(g ◦A) =

Rd

Rd e−2π i⟨x|At⟩g(x) dx dμ(t).

366
M. Baake and U. Grimm
Observing ⟨x|At⟩= ⟨t|ATx⟩and setting x = A∗y, hence dx = |det(A∗)| dy, one
ﬁnds
%
A.μ (g) =

Rd

Rd e−2π i⟨t|y⟩g(A∗y) dy dμ(t)
|det(A)| =

Rd

g ◦A∗	(t) dμ(t)
|det(A)|
= μ

g ◦A∗	
|det(A)|
= μ

g ◦A∗	
|det(A)|
=

A∗.μ
	
(g)
|det(A)| ,
which implies the ﬁrst claim. The second claim is a consequence of Eq. (7.5).
⊓⊔
7.2.3
Riesz Products
Of particular interest in the context of singular measures are measures that have a
representation as inﬁnite Riesz products. Let us recall one paradigmatic example of
pure point type, and then generalise it. Here, an expression of the form 2
m⩾0 fm(k)
with continuous functions fm is a short-hand for the measure that is deﬁned as the
vague limit of a sequence of absolutely continuous measures, the latter being given
by the Radon–Nikodym densities 2n
m=0 fm(k) with n ⩾0.
Lemma 7.2.6 As a relation between translation-bounded measures on R, one has
1
m⩾0

1 + cos(2π2mk)
	
= δZ ,
where k ∈R and convergence is in the vague topology.
Proof We employ a method that is well known from the theory of Bernoulli
convolutions; compare [47]. Deﬁne μ = δ0 + δ1 and consider the measure
ν = 1
2 μ ∗μ = δ0 + 1
2(δ1 + δ−1),
which means that
ν(k) = 1 + cos(2πk).
With f (x) = 2x, one has f.ν = 1
2 (f.μ)∗(f.μ) by Lemma 7.2.3, where f.μ = 5
f.μ.
Moreover, one has μ∗(f.μ)∗. . . ∗(f n−1.μ) = 2n−1
ℓ=0 δℓ. Now, for n ⩾1, a simple

7
Renormalisation for Block Substitutions
367
convolution calculation gives
n−1∗
m=0
f m.ν =
2n−1

ℓ=1−2n
2n −|ℓ|
2n
δℓ
n→∞
−−−−→δZ,
with convergence in the vague topology.
With 
f m.ν = ν ◦f m, which follows from Lemma 7.2.5, an application of the
convolution theorem in conjunction with the continuity of the Fourier transform
leads to

n−1∗
m=0
f m.ν =
n−1
1
m=0
(ν ◦f m)
n→∞
−−−−→<
δZ = δZ,
(7.6)
where the last step is the Poisson summation formula (PSF); see the general version
in [7, Prop. 9.4]. Our claim now follows via the observation that ν ◦f m	(k) =
1 + cos(2π2mk).
⊓⊔
More generally, let 2 ⩽M ∈N be ﬁxed and consider
μ =
M−1

ℓ=0
δℓ
and
ν = μ ∗μ
M
= δ0 +
M−1

ℓ=1
M −ℓ
M

δℓ+ δ−ℓ
	
.
With f (x) = Mx, one has μ ∗(f.μ) ∗. . . ∗(f n−1.μ) = Mn−1
ℓ=0
δℓand
n−1∗
m=0
f m.ν =
Mn−1

ℓ=1−Mn
Mn −|ℓ|
Mn
δℓ
n→∞
−−−−→δZ
in the vague topology, so that Eq. (7.6) holds here as well. Observe that
ν(k) = 1 + 2
M−1

ℓ=1
M −ℓ
M
cos(2πℓk),
which satisﬁes ν(k) ⩾0 and  1
0 ν(k) dk = 1. Moreover, 2n−1
m=0
ν ◦f m	 deﬁnes a
probability density on [0, 1] for each n ∈N. Now, the generalisation of Lemma 7.2.6
reads as follows.
Proposition 7.2.7 For any 2 ⩽M ∈N, one has
1
m⩾0

1 + 2
M−1

ℓ=1
M −ℓ
M
cos(2πℓMmk)

= δZ,
where k ∈R and convergence is in the vague topology.
⊓⊔

368
M. Baake and U. Grimm
It is clear how to extend this to more than one dimension, the details of which
are left to the interested reader.
7.3
Uniform Distribution and Averages
While uniform distribution results are usually stated for one dimension, many of
them have natural, though less well-known, generalisations to higher dimensions.
We shall need some of them to calculate limits of various Birkhoff sums in our
examples. To formulate the results, we represent Td = Rd/Zd as the half-open unit
cube [0, 1)d with (coordinate-wise) addition modulo 1. As before, we use ⟨x|y⟩=
d
i=1 xiyi for the standard inner product in Rd. Let us recall some useful properties
of non-singular linear forms.
Fact 7.3.1 Consider a non-singular linear form f : Rd −→R, which can thus be
written as f (x) = ⟨a|x⟩with 0 ̸= a ∈Rd. Then, if E is a Lebesgue null set in R,
its preimage f −1(E) is a Lebesgue null set in Rd.
Proof Let μL and νL denote Lebesgue measure in Rd and R, respectively. Clearly,
the linear mapping f is differentiable, with ∇f (x) = a ̸= 0 for all x ∈Rd, hence
certainly measurable and surjective. Now, the pushforward f.μL deﬁnes a regular
Borel measure on R, with

f.μL
	
(E) = μL

f −1(E)
	
for any Borel set E ⊆R;
compare [36, Thm. 39.C]. Due to the linearity of f , for any t ∈R, we have the
relation f −1(t + E) = zt + f −1(E) for some zt ∈Rd with f (zt ) = t, which
covers the empty set via the standard convention x + ∅= ∅.
This property implies

f.μL
	
(t + E) =

f.μL
	
(E) for all t ∈R and all Borel
sets E, which means that f.μL is translation invariant and thus a multiple of Haar
measure on R. Consequently, we have f.μL = cνL, where c > 0 follows from
a ̸= 0. This means that f.μL and νL are equivalent as measures, and our claim on
the Lebesgue null sets follows.
⊓⊔
Fact 7.3.2 Let α ∈R with |α| > 1 be given and let f be the linear form from
Fact 7.3.1. Then, for Lebesgue-a.e. x ∈Rd, the sequence f (αnx)	
n∈N is uniformly
distributed modulo 1.
Proof One has f (αnx) = αnt with t = ⟨a|x⟩and a ̸= 0. Clearly, (αnt)n∈N is
uniformly distributed modulo 1 for a.e. t ∈R by standard results from uniform
distribution theory; compare [39, Thm. 4.3 and Exc. 4.3]. If E is the corresponding
null set of exceptional points, uniform distribution modulo 1 of

f (αnx)
	
n∈N fails
precisely for all x ∈f −1(E) ⊂Rd. By Fact 7.3.1, f −1(E) is a null set in Rd, which
implies the claim.
⊓⊔
Lemma 7.3.3 Let α ∈R with |α| > 1 be ﬁxed. Then, for Lebesgue-a.e. x ∈Rd,
the sequence (αnx)n∈N taken modulo 1 is uniformly distributed in Td.

7
Renormalisation for Block Substitutions
369
Proof For d = 1, this is a well-known result from metric equidistribution theory
[39, Ch. 4], as mentioned earlier. For d > 1 and any given x ∈Rd, it is convenient to
employ Weyl’s criterion [39, Thm. 6.2] and consider the convergence behaviour of
character sums. In fact, this implies that uniform distribution of (αnx)n∈N modulo 1
is equivalent to uniform distribution modulo 1 of the sequences (αn⟨k|x⟩)n∈N for all
k ∈Zd \ {0}; compare [39, Thm. 6.3]. For each such k, let Ek be the exceptional set
of points x ∈Rd where uniform distribution fails, which is a null set by Fact 7.3.2.
Since Zd \ {0} is countable, the set 
k∈Zd\{0} Ek is still a null set in Rd, and the
claim follows.
⊓⊔
Next, we need to understand averages of various types of periodic and almost
periodic functions, in particular along exponential sequences of the above type.
Lemma 7.3.4 Let α ∈R with |α| > 1 be ﬁxed. For any a ∈Rd and then a.e.
x ∈Rd, one has
lim
N→∞
1
N
N−1

n=0
e2π iαn⟨a|x⟩= δa,0.
Proof When a = 0, the limit is 1 for all x ∈Rd, so let a ̸= 0. Then, by Fact 7.3.2,
(αn⟨a|x⟩)n∈N is uniformly distributed modulo 1 for a.e. x ∈Rd, where the null set
Ea of exceptions depends on a. So, for any given a and then every x ∈Rd \ Ea, we
get
lim
N→∞
1
N
N−1

n=0
e2π iαn⟨a|x⟩=
 1
0
e2π it dt = 0
by Weyl’s lemma.
⊓⊔
The next step is an extension to (complex) trigonometric polynomials, as given
by
Pm(x) = c0 +
m

ℓ=1
cℓe2π i⟨kℓ|x⟩
with m ∈N0 and coefﬁcients cℓ∈C. When m ⩾1, the frequency vectors
k1, . . . , km are assumed to be non-zero and distinct. Clearly, under the conditions of
Lemma 7.3.4, one obtains
lim
N→∞
1
N
N−1

n=0
Pm(αnx) = c0 = M(Pm)
(7.7)

370
M. Baake and U. Grimm
for a.e. x ∈Rd. Here, M(f ) is the mean of a bounded function,
M(f ) := lim
n→∞
1
vol(An)

An
f (x) dx,
(7.8)
where A = (An)n∈N is a ﬁxed sequence of growing sets for the averaging process.
The sets An are supposed to be sufﬁciently ‘nice’, which means that one assumes
a property of Følner or van Hove type. To be concrete, we can think of An as the
closed cube of sidelength n centred at 0. It is clear that the limit in (7.8) exists
for trigonometric polynomials. More generally, it exists for all functions that are
uniformly almost periodic, which are often also called Bohr almost periodic. They
are the continuous functions that can uniformly be approximated by trigonometric
polynomials. In other words, the space of uniformly almost periodic functions is the
∥.∥∞-closure of the space of trigonometric polynomials; see [23] for general results.
Proposition 7.3.5 Let f : Rd −→C be a uniformly (or Bohr ) almost periodic
function, and let α ∈R with |α| > 1 be given. Then, for a.e. x ∈Rd, one has
lim
N→∞
1
N
N−1

n=0
f (αnx) = M(f ).
In particular, this applies to functions of the form f = log(g) with g a non-negative,
uniformly almost periodic function that is bounded away from 0.
Proof The ﬁrst claim for d = 1 is [11, Thm. 6.4.4]. A close inspection of its proof
reveals that the same chain of arguments also applies to the case d > 1, which is all
we need here.
The second claim follows from the ﬁrst because g(x) ⩾δ > 0 for all x ∈Rd
implies that log(g) is again uniformly almost periodic [4, Fact 6.14].
⊓⊔
In the attempt to generalise Proposition 7.3.5 beyond uniformly almost periodic
functions, one difﬁculty emerges when f is no longer locally Riemann-integrable.
Let us ﬁrst look at periodic functions, where we begin by recalling a classic result.
Fact 7.3.6 ([11, Lemma 6.3.3]) Let q ∈Z with |q| ⩾2 be ﬁxed, and consider a
function f ∈L1
loc(R) that is 1-periodic. Then,
1
N
N−1

n=0
f (qnx)
N→∞
−−−−→
 1
0
f (y) dy = M(f )
holds for a.e. x ∈R.
⊓⊔
The key ingredient to Fact 7.3.6 is the ergodicity of Lebesgue measure on T for
the dynamical system deﬁned by x →qx modulo 1, which permits to use Birkhoff’s
ergodic theorem instead of Weyl’s lemma and uniform distribution of (qnx)n∈N for
a.e. x ∈R. The natural counterpart on Td can be stated as follows.

7
Renormalisation for Block Substitutions
371
Lemma 7.3.7 Let Q be a non-singular endomorphism of Td such that no eigen-
value is a root of unity, and consider a Zd-periodic function f ∈L1
loc(Rd). Then, for
a.e. x ∈Rd, one has
1
N
N−1

n=0
f (Qnx)
N→∞
−−−−→

Td f (y) dy = M(f ).
In particular, this result applies to every toral endomorphism that is expansive.
Proof Under our assumptions, Lebesgue measure is an invariant and ergodic
measure for the dynamical system deﬁned by Q on Td; see [24, Cor. 2.20]. The
main statement now follows from Birkhoff’s ergodic theorem. Since all eigenvalues
of an expansive Q ∈End(Td) satisfy |λ| > 1, the last claim is clear.
⊓⊔
Beyond Fact 7.3.6 and Lemma 7.3.7, we will need the following result, which
can be viewed as a variant of Sobol’s theorem [52]; see also [11, 37].
Lemma 7.3.8 Let p ⩾0 be a trigonometric polynomial in d variables, and let
α ∈R with |α| > 1 be ﬁxed. Let us further assume that, for some sufﬁciently small
δ > 0, the critical points of p with value in [0, δ] are isolated. Then, for Lebesgue-
a.e. x ∈Rd, one has
lim
N→∞
1
N
N−1

n=0
log

p(αnx)
	
= M

log(p)
	
.
Proof (Sketch) Since the case p(k) ⩾δ > 0 for all k ∈Rd is covered by
Proposition 7.3.5, we assume infk∈Rd p(k) = 0, hence infk∈Rd log(p(k)) = −∞,
which is the origin of the complication. Note, however, that all singularities of
log(p) are of logarithmic type and hence locally integrable, so log(p) is no longer
uniformly, but still Stepanov almost periodic; see [11, pp. 356–359] as well as [23,
Sec. VI.4].
Now, we have to deal with the small local minima of p. By assumption, there is
a δ > 0 such that the points k with ∇p(k) = 0 and p(k) ∈[0, δ] are isolated. As p
is a quasiperiodic function, the set of critical points of this type, Z say, must then be
uniformly discrete.
Now, with a Borel–Cantelli argument, compare [11, Thm. 6.3.5] and
[10, Prop. 5.1], one can derive that, for a.e. x ∈Rd, the sequence (αnx)n∈N0 stays
sufﬁciently far away from Z so that the average via the Birkhoff sum ultimately
is not distorted by the singularities or almost singularities of log(p), and Sobol’s
theorem can be applied. This gives
lim
N→∞
1
N
N−1

n=0
log

p(αnx)
	
= M

log(p)
	
for a.e. x ∈Rd as claimed.
⊓⊔

372
M. Baake and U. Grimm
At this point, we are set to start the spectral analysis of inﬂation systems via their
pair correlations, where we begin with the theory in one dimension.
7.4
Results in One Dimension
Let us recall the situation in one dimension from [5, 6]. Consider a primitive sub-
stitution ϱ on an L-letter alphabet A = {a1, . . . , aL}. It deﬁnes a unique symbolic
hull Xϱ, which is compact and consists of a single local indistinguishability (LI)
class. This hull can be constructed as the closure of the shift orbit of a two-sided
ﬁxed point of a suitable power of ϱ. This shift space gives rise to a uniquely (in
fact, strictly) ergodic dynamical system under the Z-action of the shift, denoted as
(Xϱ, Z).
The corresponding substitution matrix M is the primitive L × L-matrix with
elements Mij = cardai

ϱ(aj )
	
⩾0 and Perron–Frobenius (PF) eigenvalue λ > 1.
The matching (properly normalised) right eigenvector of M encodes the letter
frequencies, while the left eigenvector determines the ratios of natural tile lengths
for a consistent geometric inﬂation rule. The latter acts on L intervals (which are
our prototiles), one for each letter, of lengths corresponding to the entries of the left
eigenvector. If the L intervals do not have distinct lengths, we distinguish congruent
ones by labels (or colours). The inﬂation map induced by ϱ then consists of a scaling
of the intervals by the inﬂation multiplier λ and their subsequent dissection into
original prototiles, according to the order determined by the substitution rule ϱ. In
this setting, the inﬂation again deﬁnes a strictly ergodic dynamical system, now (in
general) under the continuous translation action of R, denoted as (Y, R), with Y the
new tiling hull.
To capture the geometric information, let us collect the relative positions of the
tiles in the inﬂation map in a set-valued displacement matrix T . Each element Tij
thus is a set, viewed as a list of length Mij that contains the relative positions of
the interval (or tile) of type i in the inﬂated interval (or supertile) of type j (and
is the empty set if Mij = 0). To deﬁne the distance between tiles, we assign a
reference point to each tile, which we usually choose to be the left endpoint of the
interval. Clearly, since the reference point determines the tile and its position, the
set of (labelled or coloured) reference points is mutually locally derivable (MLD)
with the tiling by intervals. For a given tiling, deﬁne 'i as the set of all reference
points of tiles of type i, and ' = ˙L
i=1'i as the set of all such reference points.
Let νij(z) with z ⩾0 be the relative frequency of the occurrence of a tile of type
i (left) and one of type j (right) at distance z, with the understanding that
νij (−z) = νji(z).
These are the pair correlation coefﬁcients of the inﬂation rule, which exist for all
elements of the hull and are independent of the choice of the element. Given ',

7
Renormalisation for Block Substitutions
373
decomposed as ' = ˙
i'i, one can represent each coefﬁcient as a limit,
νij(z) = lim
r→∞
card

Br(0) ∩'i ∩('j −z)
	
card(Br(0) ∩')
= dens

'i ∩('j −z)
	
dens(')
⩾0.
Due to the strict ergodicity, one has νij(z) > 0 if and only if z ∈Sij := 'j −'i,
where the sets Sij are independent of the choice of ' from the hull, because the
latter is minimal and thus consists of a single LI class [7].
Let us now recall the general renormalisation relations for the νij from [4, 5, 10],
which are proved in full generality in [6], also for higher dimensions; see Eq. (7.18)
below.
Lemma 7.4.1 Let νij be the pair correlation coefﬁcients of the geometric inﬂation
rule induced by the primitive L-letter substitution ϱ with inﬂation multiplier λ, and
let T be the corresponding set-valued displacement matrix. Then, they satisfy the
identities
νij(z) = 1
λ
L

m,n=1

r∈Tim

s∈Tjn
νmn
z + r −s
λ

for arbitrary z ∈R.
⊓⊔
Remark 7.4.2 The identities of Lemma 7.4.1 have a special structure, which we
call an exact renormalisation for the following reason. First, there is a ﬁnite subset
of identities that close, and give what is known as the self-consistency part of the
identities. Then, all remaining relations are purely recursive, which also implies
that the solution space of the renormalisation identities is ﬁnite-dimensional. This is
further discussed and explored in [5, 6].
♦
Now, deﬁne ϒij = 
z∈Sij νij(z) δz , which is a pure point measure for each
1 ⩽i, j ⩽L. For the measure vector ϒ = (ϒ11, ϒ12, . . . , ϒLL), we use f.ϒ for the
componentwise pushforward, where f (x) = λx as before. With this, Lemma 7.4.1
implies the matching relation for the pair correlation measures to be
ϒ = 1
λ
 
δT
∗⊗δT
	 ∗(f.ϒ),
where δT is the measure-valued matrix with elements δTij and
∗⊗denotes the Kro-
necker product of two measure-valued matrices with convolution as multiplication.
All elements of ϒ are Fourier-transformable as measures, which follows from
[5, Lemma 1]. Thus, we deﬁne the Fourier matrix of our inﬂation system as
B(k) := 
δT (k) = 
δT (−k),

374
M. Baake and U. Grimm
which is an L×L matrix function with trigonometric polynomials as entries, and
thus analytic in k. Now, by Fourier transform in conjunction with the convolution
theorem, one ﬁnds
ϒ = 1
λ2

B(.) ⊗B(.)
 
f −1.ϒ
	
,
(7.9)
to be read as a relation between measure vectors. The main advantage of this
formulation is that we now actually obtain three equations from (7.9) as follows.
Each ϒij is a measure that has a unique decomposition into a pure point (pp) and
a continuous part, with a countable supporting set for the pure point part. Taking the
union of the latter over all i, j allows us to deﬁne the decomposition
ϒ = ϒpp + ϒcont
with a matching decomposition R = Epp ˙∪Econt. Here, Epp is a countable set, and
we may assume without loss of generality that it is also invariant under f and f −1,
for instance by replacing Epp with 
n∈Z f n(Epp), which is still countable. The
complement then still is a valid supporting set for the continuous part, and also
invariant under f and f −1.
Repeating this type of argument, we can further split ϒcont into its singular
continuous (sc) and absolutely continuous (ac) component, which goes along with
a decomposition R = Epp ˙∪Esc ˙∪Eac, where each supporting set is invariant under
f and f −1; see [6] for a more detailed discussion of this point. This decomposition
leads to the following result.
Lemma 7.4.3 The measure vector ϒ satisﬁes the three separate equations
ϒα = 1
λ2

B(.) ⊗B(.)
 
f −1.ϒα
	
,
for α ∈{pp, sc, ac}.
Proof This is a consequence of the fact that B(k) ⊗B(k) is analytic in k, hence
cannot change the spectral type, together with

f −1.ϒ
	
α = f −1.ϒα due to f being a
simple dilation, which cannot change the spectral type either. The claim now follows
from restricting Eq. (7.9) to the supporting sets Eα constructed above.
⊓⊔
All three equations have interesting implications, as discussed in [4–6]. Here,
we concentrate on the ac part. To obtain some insight into the latter, we denote
the Radon–Nikodym density vector of ϒac by h. Then, Lemma 7.4.3 results in the
relation
h(k) = 1
λ

B(k) ⊗B(k)
	
h(λk),
which has to hold for a.e. k ∈R and can be iterated. Note that the different power
of λ in the denominator in comparison to Lemma 7.4.3 results from a change of

7
Renormalisation for Block Substitutions
375
variable transformation. For values of k with det(B(k)) ̸= 0, it can also be inverted
to get an iteration in the opposite direction. It is a crucial observation from [4, 6, 10]
that the asymptotic behaviour can be analysed from the simpler iterations
v(k) =
1
√
λ B(k)v(λk)
and
v(λk) =
√
λ B−1(k)v(k),
(7.10)
where the components of v(k) are locally square-integrable functions. Using
Fact 7.2.1, this emerges from a decomposition of

hij(k)
	
, viewed as a positive
semi-deﬁnite Hermitian matrix, as a sum of rank-1 matrices of the form vi(k) v†
j(k)
and the observation that the overall growth rate is dictated by the maximal growth
rate of these summands; see [4, 6] for details.
To capture the asymptotic behaviour, one deﬁnes the Lyapunov exponents,
compare [57], for the iterations that emerge from Eq. (7.10), which is possible when
B(k) is invertible for a.e. k ∈R. It turns out that the required values can all be
related to the extremal Lyapunov exponents of the matrix cocycle deﬁned by
B(n)(k) := B(k)B(λk) · · · B(λn−1k),
(7.11)
which happens to be the Fourier matrix of ϱn. The quantities of interest to us here
are controlled by the maximal Lyapunov exponent of this cocycle, deﬁned as
χB(k) := lim sup
n→∞
1
n log


B(n)(k)


,
(7.12)
where ∥.∥refers to any sub-multiplicative matrix norm, such as the spectral norm or
the Frobenius norm. In favourable cases, χB(k) will exist as a limit for a.e. k ∈R,
as we shall see later in several examples. The main criterion can now be formulated
as follows.
Theorem 7.4.4 Let ϱ be a primitive substitution on a ﬁnite alphabet, and consider
the corresponding inﬂation rule with inﬂation multiplier λ = λPF for intervals of
natural length. Let χB(k) be the maximal Lyapunov exponent of the Fourier matrix
cocycle (7.11), and assume that det

B(k)
	
̸= 0 for at least one k ∈R.
If there is some ε > 0 such that χB(k) ⩽1
2 log(λ) −ε holds for Lebesgue-a.e.
k ∈R, one has ϒac = 0, and the diffraction measure of the system is singular.
Proof (Sketch) Under our assumptions,2 for a.e. k
∈
R with k
̸=
0, the
sequence

h(λnk)
	
n∈N of Radon–Nikodym density vectors, as n →∞, displays
an exponential growth of order e2(D−δ)n, where D = 1
2 log(λ) −χB(k) ⩾ε > 0
and δ > 0 can be chosen such that D −δ > 0. The implied constant will depend on
k and δ. Such a behaviour is incompatible with the translation-boundedness of the
components of ϒac, which is a contradiction unless h(k) = 0 for a.e. k ∈R, hence
2Since det

B(k)
	
is a trigonometric polynomial, it is either identically 0 or has isolated zeros.

376
M. Baake and U. Grimm
ϒac = 0. For further details, we refer to [4, Sec. 6.7 and App. B] as well as to the
general treatment in [6].
⊓⊔
Remark 7.4.5 The statement of Theorem 7.4.4 can be strengthened and extended in
various ways. First of all, one can show that χB(k) ⩽log
√
λ holds for a.e. k ∈R.
As a consequence, a non-trivial ac diffraction component is only possible when
χB(k) = log
√
λ is true for k in a subset of positive measure in every interval of the
form [−λa, −a] or [a, λa] with a > 0. When λ is a PV number without any further
restriction, which thus also covers all primitive inﬂation rules of constant length as
well as those with integer inﬂation factor, the relation must even hold for Lebesgue-
a.e. k ∈R; see [6] for details. This poses severe restrictions on the existence of
ac diffraction in inﬂation systems beyond the necessary criterion of Berlinkov and
Solomyak [17].
♦
7.5
Consequences and an Application
For the Fibonacci inﬂation, the exact renormalisation for the pair correlation
functions was used to establish a spectral purity result and then pure point spectrum
[5], thus conﬁrming a known property in an independent way. The same line of
thought works for all noble means inﬂations in complete analogy.
It is tempting to expect a similar result for all irreducible PV inﬂations, but one
quickly realises that spectral purity is essentially equivalent to almost everywhere
injectivity of the factor map onto the maximal equicontinuous factor (MEF). While
the existence of non-trivial point spectrum in one-dimensional inﬂation tilings
requires λ to be a PV number [54], it is the exclusion of any continuous spectral
component that would settle the (still open) Pisot substitution conjecture.
A less ambitious task thus is to establish the mere absence of absolutely
continuous diffraction or spectral measures. It has long been ‘known’ (without
mathematical proof) that the presence of ac diffraction requires a particular scaling
property of the diffraction measure as a function of the system size. This stems
from the heuristic expectation that a structure has an ac diffraction spectrum if
its ﬂuctuations are somewhat similar to those of a disordered random structure,
so ﬂuctuations growing as
√
N for a chain of length N, in line with the law of
large numbers. This behaviour corresponds to a wandering exponent equal to 1
2; see
[2, 35, 43] for an application to aperiodic structures.
In the case of constant-length substitutions, this effectively corresponds to a
condition on the spectrum of the substitution matrix M. Namely, if λ is its PF
eigenvalue, M must also have an eigenvalue
√
λ or one of that modulus. The
necessity of an eigenvalue of modulus
√
λ for the existence of an ac spectral
measure was recently proved in [17]. That this criterion is necessary, but not

7
Renormalisation for Block Substitutions
377
sufﬁcient, can be shown by an example, for instance using the constant-length
substitution
a →ab ,
b →ca ,
c →bd ,
d →dc
(7.13)
on the 4-letter alphabet {a, b, c, d}. The substitution matrix reads
M =
⎛
⎜⎜⎝
1 1 0 0
1 0 1 0
0 1 0 1
0 0 1 1
⎞
⎟⎟⎠
and has spectrum {2, ±
√
2, 0}, hence clearly satisﬁes the
√
λ -criterion. Neverthe-
less, as was shown in [20] on the basis of Bartlett’s algorithmic classiﬁcation of
spectral types [15], all spectral measures of this substitution are singular.
Let us apply Lyapunov exponents to reach this conclusion in an independent way.
It is straight-forward to calculate
T =
⎛
⎜⎜⎝
{0} {1} ∅∅
{1} ∅{0} ∅
∅{0} ∅{1}
∅∅{1} {0}
⎞
⎟⎟⎠
and
B(k) =
⎛
⎜⎜⎝
1 z 0 0
z 0 1 0
0 1 0 z
0 0 z 1
⎞
⎟⎟⎠
where z = e2π ik. One has det

B(k)
	
= z4 −1 which vanishes only for k ∈1
4Z, so
that B(k) is invertible for a.e. k ∈R. Let us now, for n ∈N, deﬁne the matrices
B(n)(k) := B(k)B(2k)B(4k) · · · B(2n−1k).
(7.14)
By deﬁnition, B(1) = B is the Fourier matrix of ϱ, while B(n) is the Fourier matrix
of ϱn, and hence a natural object to study in this context.3
Since the substitution is of constant length, B(n) deﬁnes a cocycle over the
compact dynamical system deﬁned by k →2k modulo 1 on T. We thus have
Oseledec’s multiplicative ergodic theorem [57] at our disposal, which implies
that the Lyapunov exponents exist for a.e. k ∈R and satisfy forward Lyapunov
regularity, hence in particular sum to
lim
n→∞
1
n
n−1

ℓ=0
log
detB(2ℓk)	 = Mlog
detB(.)		 = m(z4 −1) = 0,
3Notice that, while the Fourier matrices B(k) for different k generally do not commute, the matrices
B(2)(k) = B(k)B(2k), which correspond to the square of the substitution rule (7.13), form a
commuting family of matrices. This corresponds to the fact that the substitution is non-Abelian
in the sense of [48], meaning that the column-wise letter permutations do not commute, while its
square becomes Abelian.

378
M. Baake and U. Grimm
where the ﬁrst equality is a consequence of Birkhoff’s ergodic theorem, as detailed
in Fact 7.3.6, while the last step follows directly from Fact 7.2.2.
To continue, it is helpful to observe that B(k) admits a k-independent splitting
of C4 into a two-dimensional and two one-dimensional subspaces. Concretely, one
ﬁnds
UB(k)U−1 =
⎛
⎜⎜⎝
1+z
0
0 0
0
1−z 0 0
0
0
−z 1
0
0
1 z
⎞
⎟⎟⎠
with
U = 1
2
⎛
⎜⎜⎝
1 1
1
1
1 −1 −1 1
1 −1 1 −1
1 1 −1 −1
⎞
⎟⎟⎠,
where the unitary matrix U is an involution, so U−1 = U. By standard arguments,
it is clear that two of the four exponents are given by m(1 + z) = 0 and
m(1 −z) = 0, which derives from the invariant one-dimensional subspaces. The
remaining two exponents must still sum to 0, and can be determined from the
induced cocycle ˜B(n)(k) = ˜B(k) ˜B(2k) · · · ˜B(2n−1k) with ˜B(k) =
 −z 1
1 z
	
. With
pN(k) := ∥˜B(N)(k)∥2
F, which is a trigonometric polynomial due to the use of the
Frobenius norm, we know that
χB(k) = χ ˜B(k) ⩽1
N M

log ∥˜B(N)(k)∥F
	
= m(pN)
2N
=: mN
(7.15)
holds for a.e. k ∈R and every N ∈N. In particular, one has the (almost sure)
estimate χB(k) ⩽lim infN→∞mN.
Now, employing Jensen’s formula again, the numbers mN can easily be calcu-
lated numerically with high precision, and are given in Table 7.1 for N ⩽12. These
values clearly show that χB(k) ⩽
1
5 < log
√
2 ≈0.346574, which implies the
absence of ac diffraction.
Since we are in the constant-length case, this result translates into one on the
spectral measures via the general results of [48, Prop. 7.2] on the maximal spectral
type of a constant-length substitution; see also [15, Thm. 3.4]. The crucial point to
observe here is that we do not need to consider the spectral measures of all functions
that are square-integrable over the hull, but only those of the (possibly weighted)
lookup functions for the type of level-m supertile at 0, for all m ∈N0.
Our diffraction measure provides the result for the spectral measure of the lookup
functions of the prototiles themselves, compare [14], while we can repeat our
analysis for any supertile in noting that this will simply lead to a rescaling, as a result
of Lemma 7.2.5. Concretely, the spectral measures will then be Riesz products of the
Table 7.1 Some values of the means mN from Eq. (7.15), calculated via Eq. (7.2). The numerical
error is always less than 10−3
N
1
2
3
4
5
6
7
8
9
10
11
12
mN
0.693
0.478
0.379
0.334
0.302
0.274
0.252
0.235
0.220
0.208
0.198
0.189

7
Renormalisation for Block Substitutions
379
same type in the sense that only ﬁnitely many initial factors are missing. Since they
clearly have the same Lyapunov exponents and growth rates, our result translates
to their spectral measures as well. In line with [20], but by a completely different
method, we have thus arrived at the following result.
Corollary 7.5.1 Consider the dynamical system (Xϱ, Z) deﬁned by the primi-
tive constant-length substitution ϱ from (7.13), which has inﬂation multiplier 2.
Although its substitution matrix also has an eigenvalue
√
2, and thus satisﬁes the
necessary criterion for the presence of an absolutely continuous spectral measure,
no such measure exists, and all spectral measures are singular.
⊓⊔
It follows from the full analysis in [20] that the extremal spectral measures are
either pure point or singular continuous, and that both possibilities occur here. Let
us brieﬂy mention that [6] presents a method to construct inﬁnitely many other
examples of this kind, which demonstrates that the
√
λ -criterion alone is far from
sufﬁcient for the emergence of ac spectral components.
7.6
Results in Higher Dimensions
One advantage of the geometric language with tilings is its generalisability to higher
dimensions. Here, a tile in Rd is a compact set t that is the closure of its interior, and
we will only consider cases where t is simply connected, though this is not required
for the general theory. A prototile is a representative of a tile and all its translates
under the action of Rd.
Given a ﬁnite set T = {t1, . . . , tL} of L prototiles and an expansive linear map
Q, one speaks of a stone inﬂation relative to Q (otherwise often called a self-afﬁne
inﬂation) if there is a rule how to exactly subdivide each level-1 supertile Q(ti) into
translated copies of the original tiles. Iterating such an inﬂation rule, called ϱ as
before, leads to tilings that cover Rd, and via the orbit closure in the standard local
rubber topology also to a compact hull Y. If the inﬂation is primitive, see [7, 12, 34]
for details, this hull is minimal and consists of a single LI class, which is to say
that any two elements of the hull are LI. It is an interesting and important fact that
this property is not restricted to the FLC situation, but still holds for more general
inﬂation tilings [30], with the properly adjusted notions of indistinguishability and
repetitivity; see also [41].
To keep track of the relative positions of the tiles under the inﬂation procedure,
we need to equip each ti with a reference or control point. While there are usually
many ways to do so, some will be more ‘natural’ than others. What really counts is
that the tiling and the point set contain the same information. So, it is imperative to
choose the control points such that they are MLD with the tiling. When congruent
tiles exist, the control points are coloured to distinguish them according to the tile
type. This means that the space of (coloured) control point sets and the tiling hull
are topologically conjugate as dynamical systems under the translation action of Rd

380
M. Baake and U. Grimm
in a local way. For this reason, we usually identify the two pictures, and speak of
tilings or point sets interchangeably, always using Y to denote the hull.
Now, we can deﬁne the displacement sets Tij essentially as before, so
Tij = {all relative positions of ti in Q(tj)},
(7.16)
where the relative positions are deﬁned via the control points. Note that all quantities
are deﬁned in complete analogy to the one-dimensional case. In particular, the
corresponding Fourier matrix is once again given by
B(k) = 
δT (k).
(7.17)
Note that k ∈Rd reﬂects the dimension of the Euclidean space the tiling lives in,
while B(k) ∈Mat(L, C) covers the combinatorial structure of the inﬂation rule. As
before,
M = B(0)
is the non-negative inﬂation or incidence matrix, with leading eigenvalue λ =
|det(Q)| by construction of the stone inﬂation. Many explicit examples are dis-
cussed in [7, Ch. 6] as well as in [26, 29, 33]; see also the TILINGS ENCYCLOPE-
DIA.4 Quite frequently, Q will be a homothety, simply meaning Q(x) = λx and thus
referring to the case of a self-similar inﬂation, but it can also contain a rotation (as in
Gähler’s shield tiling; see [7, Sec. 6.3.2]) or scale differently in different directions
(as in general block substitutions; see Fig. 7.1 below for an example). The crucial
point here is that space and combinatorial information are properly separated for the
renormalisation approach.
The renormalisation equations for the pair correlation coefﬁcients are derived [6]
by the same arguments used in Lemma 7.4.1 above, where the local recognisability
in the aperiodic case follows from [53]. The result reads
νij (z) =
1
|det(Q)|
L

m,n=1

r∈Tim

s∈Tjn
νmn

Q−1(z + r −s)
	
,
(7.18)
which, in terms of the corresponding pair correlation measures, becomes
ϒ =
1
|det(Q)|
 
δT
∗⊗δT
	 ∗(Q.ϒ).
4The TILINGS ENCYCLOPEDIA is maintained by Dirk Frettlöh and Franz Gähler, and is accessible
online at http://tilings.math.uni-bielefeld.de.

7
Renormalisation for Block Substitutions
381
Fig. 7.1 A simple example of a primitive binary block substitution in the plane. It is a stone
inﬂation for the linear map Q = diag(3, 2). The lower left corners of all blocks are used as control
points (not shown), which are coloured according to the block type
Note that these relations also apply to periodic inﬂation tilings, as shown in [6].
Taking Fourier transforms, with the dual map
Q∗:= (QT )−1,
we obtain the relations
ϒ =
1
|det(Q)|2

B(.) ⊗B(.)
 Q∗.ϒ	
(7.19)
by Lemma 7.2.5. Once again, they have to hold separately for the pure point,
singular continuous and absolutely continuous components, respectively, as in
Lemma 7.4.3.
Due to the appearance of Q∗, one deﬁnes the Fourier matrix cocycle as
B(n)(k) = B(k)B(QT k) · · · B((QT )n−1k),
(7.20)
where the transpose can also be seen as a consequence of Eqs. (7.16) and (7.17)
via a simple calculation with the Fourier transform. Now, as in the one-dimensional
case, one has the following result [6].
Fact 7.6.1 If B(k) is the Fourier matrix of the primitive stone inﬂation rule ϱ, the
Fourier matrix of ϱn is given by B(n)(k) from Eq. (7.20).
⊓⊔
With χB as deﬁned in Eq. (7.12), and in complete analogy to the one-dimensional
case, one can now derive [6, Thm. 5.7] the following criterion for the absence of ac
diffraction components.
Theorem 7.6.2 Consider a ﬁnite set T of prototiles in Rd and a primitive stone
inﬂation for T , with expansive linear map Q, and suppose that this deﬁnes an FLC
tiling system. Assume further that each prototile is equipped with a control point,
possibly coloured, such that the tilings and the corresponding control point sets are
MLD. Deﬁne Fourier matrix and Lyapunov exponents as explained above.
Suppose that B(k) is invertible for a.e. k ∈Rd and that there is some ε > 0 such
that χB(k) ⩽1
2 log|det(Q)| −ε holds for a.e. k ∈Rd. Then, one has ϒac = 0 and
the diffraction measure of the tiling system is singular.
⊓⊔
Remark 7.6.3 A closer inspection of the proof in [6] reveals that the FLC condition
is actually not necessary. Indeed, if one starts form a stone inﬂation with ﬁnitely

382
M. Baake and U. Grimm
many prototiles up to translations, the criterion from Theorem 7.6.2 works without
further modiﬁcations. We shall see and discuss several examples later on.
♦
Let us note in passing that the comments of Remark 7.4.5, with the obvious
adjustments, apply to this higher-dimensional case as well. In particular, the
conditions for the appearance of ac spectral components in higher dimensions are
as restrictive as in one dimension.
7.7
Binary Block Substitutions of Constant Size
An interesting class is provided by primitive, binary block substitutions in d
dimensions, where we have two types of unit blocks, white (0) and black (1) say,
which are both substituted into a block of equal size and shape. Here, we assume
the corresponding linear expansion to be Q = diag(n1, . . . , nd) with all ni ⩾2, so
Q = QT in this case.
Let us now place the inﬂated white block on top of the inﬂated black one (in
Rd+1 that is), so that one can easily identify bijective and coincident positions via
the corresponding columns. We cast them into polynomials as follows. Let p be the
polynomial in z = (z1, . . . , zd) for all positions, which means that
p(z) =
d1
j=1

1 + zj + . . . + z
nj −1
j

.
Likewise, q and r are the polynomials for bijective columns of type
3 0
1
4
and
3 1
0
4
,
while s0 and s1 stand for the polynomials of the coincident columns of type
3 0
0
4
and
3 1
1
4, respectively. Clearly, one has q+r+s0 +s1 = p. With k = (k1, . . . , kd) ∈Rd,
the Fourier matrix then has the form
B(k) =
q(z) + s0(z)
r(z) + s0(z)
r(z) + s1(z)
q(z) + s1(z)

with
zj = e2π ikj .
Since det

B(k)
	
= p(z)

q(z) −r(z)
	
, the matrix B(k) is invertible for a.e. k ∈Rd;
see [8] for more on bijective block substitutions and [26] for some general results.
The Fourier matrix cocycle belongs to the compact dynamical system deﬁned by
k →Qk modulo 1 on Td. In this situation, we may use Oseledec’s multiplicative
ergodic theorem [57], which tells us that the two Lyapunov exponents exist for a.e.
k ∈Rd and add up to
lim
N→∞
1
N
N−1

ℓ=0
log
detB(Qℓk)	

7
Renormalisation for Block Substitutions
383
whenever this limit exists, which is true for a.e. k ∈Rd by Lemma 7.3.7. The limit
is

Td log
det

B(k)
	 dk = m(p) + m(q −r) = m(q −r),
because m(p) = 0 by Fact 7.2.2.
Since (1, 1) is a left eigenvector of B(k) for all k ∈Rd, with eigenvalue
p(z1, . . . , zd) and the zj from above, one obtains
1
N log


(1, 1)B(N)(k)


N→∞
−−−−→m(p) =
d

j=1
m

1 + zj + . . . + z
nj −1
j
	
= 0
for a.e. k ∈Rd. Since we thus know one exponent together with the sum, we get
that
χB(k) = χB
max(k) = m(q −r)
holds for a.e. k ∈Rd. By standard estimates [6, 10, 44], one now ﬁnds
exp

m(q −r)
	
< ∥q −r∥1 ⩽∥q −r∥2 =
=
det(Q) −nc ⩽
=
det(Q) ,
where the ﬁrst step follows from Jensen’s inequality; see [42] for a suitable
formulation. Moreover, with nc denoting the total number of coincident columns,
the equality is a result of Parseval’s identity. Together, we get the inequality
m(q −r) < log √det(Q), which gives the required criterion for the absence of
absolutely continuous components in ϒ.
Clearly, the corresponding property also holds in higher dimensions, and we have
the following general result; see also [6].
Theorem 7.7.1 The diffraction measure of a primitive binary block substitution of
constant size in dimension d ⩾2 is always singular.
⊓⊔
Example 7.7.2 For the block substitution of Fig. 7.1, Q = diag(3, 2) is the linear
expansion. With (z1, z2) = (x, y), the polynomials are p(x, y) = (1+x+x2)(1+y)
together with q(x, y) = x2(1 + y), r(x, y) = y, s0(x, y) = 1 + x(1 + y) and
s1(x, y) = 0. This gives
B(k) =
1 + (x + x2)(1 + y)
(1 + x)(1 + y)
y
x2(1 + y)

with (x, y) =

e2π ik1, e2π ik2	
and det

B(k)
	
= p(x, y)(x2 + x2y −y). The existence of the various limits of
Birkhoff sums we need here, for a.e. k ∈R2, follows once again from Lemma 7.3.7.

384
M. Baake and U. Grimm
The non-zero Lyapunov exponent is given by
m(x2 + x2y −y) = m(x2 + x2y + y) = m(1 + x−2y + y) = m(1 + x + y)
= 3
√
3
4π L(2, χ−3) = 2
 1/3
0
log

2 cos(πt)
	
dt ≈0.323066,
where L(z, χ−3) is the L-function for the principal Dirichlet character χ−3 of the
imaginary quadratic ﬁeld Q
√
−3
	
. Here, the ﬁrst equality follows from a change
of variable transformation, while the third emerges by a standard formula from
[25]. The connection between logarithmic Mahler measures and special values of
L-functions is a famous result that ﬁrst appeared in [58] as the groundstate entropy5
of the anti-ferromagnetic Ising model on the triangular lattice; see [3, 49] and
references therein for more.
♦
Remark 7.7.3 The absence of ac diffraction immediately implies that the spectral
measure for the ‘one-point lookup function’ must be singular. As in the one-
dimensional case, this implies that the spectral measure is also singular for any
function that looks up the level-n supertile at the origin; see the discussion before
Corollary 7.5.1. Then, by [15], any spectral measure must be singular, and our
system has singular dynamical spectrum. This gives another, independent proof of
a result that was previously shown in [8, 26]; see also [29].
♦
7.8
Block Substitutions with Squares
Here, we are interested in inﬂation rules with a single prototile of unit area and
linear expansion Q, but some added complexity from the set S of relative positions
of the tiles within the supertile. In particular, this will be our ﬁrst class of examples
where we go beyond the FLC case. The special interest in this class originates
in the fact that the Fourier matrix cocycle, B(n)(k), simply is a sequence of
multivariate trigonometric polynomials. We thus write P (n)(k) to indicate this. The
renormalisation equation becomes an equation directly for the autocorrelation and
reads
γ = ν ∗(f.γ )
with
ν = δS ∗δ−S
|det(Q)| .
(7.21)
Let us begin with a particularly simple case.
5It is interesting historically that this connection was overlooked for a long time because the
numerical value given there (for the correct integral) was erroneous, which was corrected in an
erratum 23 years later.

7
Renormalisation for Block Substitutions
385
Example 7.8.1 The staggered block substitution deﬁned by
with arbitrary a ∈R results in a tiling that is lattice-periodic, with lattice of periods
+ = ⟨v, e2⟩Z, where v = e1 + ae2. In particular, the resulting tiling is 1-periodic
in e2-direction. Since dens(+) = 1, the autocorrelation is γ = δ+, where we use
a reference point in the lower left corner of every unit square as indicated. The
diffraction measure is γ = δ+∗with the dual lattice +∗= ⟨e1, e2 −ae1⟩Z.
Let us look at this result from the renormalisation point of view, which is also
applicable here because the inﬂation can easily be changed into a stone inﬂation
without changing the control point positions; see Remark 7.8.2 below. As mentioned
above, the approach also works for periodic cases, like the one at hand. By an
iteration of the renormalisation equation (7.21) and an application of Lemma 7.2.4,
the autocorrelation is
γ = ∗
m⩾0
f m.ν
with
ν =

δ0 + 1
2(δe2 + δ−e2)
	
∗

δ0 + 1
2(δv + δ−v)
	
,
where f (x) = 2x. Now, Fourier transform leads to the two-dimensional Riesz
product
γ =
1
m⩾0
1 + cos(2π2m(k1 + ak2))	1 + cos(2π2mk2)	 =

ℓ∈Z
γ (1)
ℓ
× δ(2)
ℓ
with γ (1)
ℓ
= 2
m⩾0
1 + cos(2π2m(k1 + aℓ))	 and k = (k1, k2). Here, we have
adopted the standard notation for product distributions or measures, where the upper
index refers to the two coordinate directions. Clearly, one has γ (1)
0
= δ(1)
Z
by
Lemma 7.2.6. Moreover, the distribution γ (1)
ℓ
is 1-periodic for every ℓ∈Z, which
means that γ is 1-periodic in e1-direction, independently of a.
Whenever a ∈Z, one ﬁnds γ (1)
ℓ
= δ(1)
Z by Lemma 7.2.6, and hence γ = δZ2 as
required. More generally, given k2 = ℓ, the only contribution to γ (1)
ℓ
emerges for
k1 + aℓ= r ∈Z, hence for k = re1 + ℓ(e2 −ae1) ∈+∗, which means that the
Riesz product representation also gives γ = δ+∗, as it must.
Now, looking at this result from the cocycle perspective, we ﬁnd that
P(k) = (1 + y)(1 + xya) with x = e2π ik1 and y = e2π ik2, so that
χP (k) := lim
n→∞
1
n
n−1

ℓ=0
log|P(2ℓk)| = Mlog|P|	

386
M. Baake and U. Grimm
holds for a.e. k ∈R2 by Lemma 7.3.8, where one observes that log|P| = 1
2 log|P|2
with |P|2 satisfying the required conditions. Now, the mean can be calculated as
Mlog|P|	 = my(1 + y) + lim
T →∞
1
T
 T
0
mx(1 + xya) dk2 = 0,
where both Mahler measures are zero because all roots of the polynomials lie on the
unit circle. This ﬁts with the explicit calculation of γ from above.
♦
Remark 7.8.2 By standard methods, which are explained in [7] and in [33], one can
replace the square in Example 7.8.1 with a new prototile so that the inﬂation rule is
turned into a stone inﬂation. This has no effect on the position of the control point,
wherefore we continue with the simpler formulation as a block substitution.
In the same vein, one can see that our approach also works for more general
inﬂation rules, certainly as long as they are MLD with a stone inﬂation. For
examples of such rules and their reduction to stone inﬂations, see [7, Ch. 5] and
[33].
♦
Extending this initial example, we may consider a block substitution with M
columns of N blocks each, where entire columns can be shifted in vertical direction
by an arbitrary amount, as indicated in the next diagram,
(7.22)
When using the lower left corner as reference point for each square, it is clear that
a modiﬁcation into a stone inﬂation according to Remark 7.8.2 does not change
the resulting point set. For this reason, we stick to the formulation with squares for
simplicity.
Let us now assume that the ith column is shifted by ai ∈R in vertical direction,
with i ∈{0, 1, . . . , M −1}. Since a0 only results in a global shift of the entire
block, we set a0 = 0 without loss of generality, and consider the remaining ai as
shifts relative to column 0.
As in the previous case, which had the FLC property, we deﬁne the hull as the
orbit closure of a ﬁxed point tiling, where the closure is now taken with respect to
the local rubber topology [13]. This deﬁnes a compact tiling space [30], without
any change in the FLC case. However, this slight modiﬁcation takes care of the
potential occurrence of a tiling with inﬁnite local complexity. As before, we obtain a
dynamical system, under the continuous translation action of R2, which is uniquely
ergodic; see also [41]. Each tiling in the hull is 1-periodic in the e2-direction.

7
Renormalisation for Block Substitutions
387
From the set S of relative displacements, one ﬁnds
P(k) = 
δS(k) = (1 + y + . . . + yN−1)

1 + xya1 + x2ya2 + . . . + xM−1yaM−1	
with x = e2π ik1 and y = e2π ik2. Note that the trigonometric polynomial P is
quasiperiodic, but 1-periodic in k1. Now, with Q = diag(M, N), the cocycle is
deﬁned by
P (n)(k) = P(k)P(Qk) · · · P(Qn−1k),
with P (1) = P as usual. Our Lyapunov exponent can be calculated as follows,
χP (k) = lim
n→∞
1
n log
P (n)(k)
 = lim
n→∞
1
n
n−1

ℓ=0
log
P(Qℓk)
.
By an obvious variant of Lemma 7.3.8, where α is replaced by the expansion Q, the
limit exists for a.e. k ∈R2 and is given by
M

log|P|
	
= lim
T →∞
1
T
 T
0
 1
0
log
P(k)
 dk1 dk2
= my

1 + y + . . . + yN−1	
+ lim
T →∞
1
T
 T
0
mx

1 + xya1 + . . . + xM−1yaM−1	
dk2 .
As 1 + y + . . . + yN−1 is cyclotomic, the ﬁrst term vanishes. The integrand in the
second is the logarithmic Mahler measure of a polynomial (in x) with all coefﬁcients
on the unit circle, which is known as a unimodular polynomial. By an application
of Jensen’s inequality in conjunction with Parseval’s equation, one can show that its
logarithmic Mahler measure is bounded by log
√
M for every k2 ∈R. Consequently,
we have
M

log|P|
	
⩽log
√
M < log
√
MN
because N > 1 by assumption. This implies that we cannot have any absolutely
continuous diffraction, and γ must be singular.
The remarkable aspect of this simple class of examples is that the tilings are
generally not FLC; compare [33] and references therein. One can say a bit more
about the explicit structure of the diffraction measure. First of all, it is 1-periodic
in e1-direction, and it consists of parallel arrangements of one-dimensional layers,
distinct in general, which have their own Riesz product representation. We leave
further details to the interested reader.

388
M. Baake and U. Grimm
Remark 7.8.3 The above results can be generalised to Rd+1 with d ⩾1 as follows.
Consider a block of M1 × · · · × Md × N cubes, with all Mi ⩾2 and N ⩾2. Now,
modify this block as an arrangement of M1 × · · · × Md columns of N cubes each,
where column (m1, . . . , md) is shifted by an arbitrary real number am1,...,md in ed+1-
direction. We may set a0,...,0 = 0 without loss of generality. With the expansion
Q = diag(M1 , . . . , Md , N), one can now repeat the above analysis. Here, one
obtains tilings of Rd+1 that are 1-periodic in ed+1-direction.
Writing
z = (z1, . . . , zd, zd+1) =

e2π ik1, . . . , e2π ikd, e2π ikd+1	
= (x1, . . . , xd, y),
one ﬁnds the polynomial
P(k) =

1 + y + . . . + yN−1	
R(k)
with
R(k) =
M1−1

m1=0
· · ·
Md−1

md=0
xm1
1 · · · xmd
d
yam1,...,md ,
where R, and hence also P, is 1-periodic in ei-direction for all 1 ⩽i ⩽d. The
maximal Lyapunov exponent, for a.e. k ∈Rd+1, is now given by
χB(k) = lim
T →∞
1
T
 T
0
mx(R) dkd+1 ⩽log
=
M1 · · · Md
= 1
2
d

i=1
log(Mi) < 1
2 log

det(Q)
	
,
where the last estimate is a consequence of N ⩾2, while the intermediate steps
work in complete analogy to our above treatment for d = 1. The conclusion is, once
again, the absence of absolutely continuous diffraction.
♦
Obviously, one can extend this class of examples by colouring blocks. This will
lead to higher-dimensional Fourier matrices again, with an uncoloured tiling of the
above type as a factor system. We leave further details to the interested reader, and
turn to a perhaps more interesting non-FLC example.

7
Renormalisation for Block Substitutions
389
7.9
The Frank–Robinson Tiling
Let us take a closer look at the tiling dynamical system deﬁned by the stone inﬂation
(7.23)
where the short edge has length 1 and the long one length
λ = 1
2
1 +
√
13 	 ≈2.303,
while the linear expansion is Q = λ12. This inﬂation deﬁnes the Frank–Robinson
tiling [30], see also [27], a patch of which is shown in Fig. 7.2. Note that the
algebraic integer λ is neither a PV number nor a unit. By standard PF theory, the
relative prototile frequencies in any Frank–Robinson tiling are given by
(ν1, . . . , ν4) = 1
9(4 −λ, 4λ −7, 4λ −7, 19 −7λ);
(7.24)
see [7, Ex. 5.8] for details. With the chosen edge lengths, the density of the control
point set ' induced by Eq. (7.23) is dens(') = (3 + λ)/13 ≈0.408.
Fig. 7.2 A patch of the
Frank–Robinson tiling
deﬁned by the stone inﬂation
rule (7.23), obtained by three
inﬂation steps from a single
large square

390
M. Baake and U. Grimm
If we deﬁne the hull as the orbit closure of a ﬁxed point tiling (under the square
of the rule (7.23)) in the local rubber topology, we get a compact tiling space of
inﬁnite local complexity; see [30] and [7, Ex. 5.8] for more. As in the FLC case, it
is also true here [41, Cor. 5.7 and Ex. 6.3] that the tiling dynamical system does not
have any non-trivial eigenfunction. In the diffraction context, this implies that the
pp part consists of the trivial Bragg peak at k = 0 only; see below for its intensity.
By taking the lower-left corner of each prototile as its control point, as indicated
in Eq. (7.23) and Fig. 7.2, we turn each tiling of the hull into a Delone set that is
MLD with the tiling. Now, the absence of non-trivial eigenfunctions translates to
the diffraction of this Delone set by asserting that the trivial Bragg peak at k = 0 is
the only contribution to the pure point part of the diffraction measure.
The Fourier matrix B is given by
B(x, y) =
⎛
⎜⎜⎝
x2y2
1
1
1
p(x, y)
0
r(y) 0
p(y, x) r(x)
0
0
q(x, y)
0
0
0
⎞
⎟⎟⎠,
with (x, y) = e2π ik1, e2π ik2	
(7.25)
and the (trigonometric) polynomials
r(x) = xλ + xλ+1 + xλ+2,
p(x, y) = x2 + x2y + yλ+2,
q(x, y) = 1 + x + y + xy + xλyλ
x2 + y2 + xy2 + x2y + x2y2	
.
(7.26)
Note that B(0) is the inﬂation matrix of the tiling, with PF eigenvalue λ2.
Now, the cocycle is given by B(n)(k) = B(k)B(λk) · · · B(λn−1k), with maximal
Lyapunov exponent
χB(k) = lim sup
n→∞
1
n log ∥B(n)(k)∥,
where the choice of the (sub-multiplicative) matrix norm is arbitrary. Absence of
absolutely continuous components of the diffraction will be implied if we show
that χB(k) ⩽log(λ) −ε for some ε > 0 and a.e. k ∈R2. Since it is convenient
to work with the square of the Frobenius norm,6 we prefer to compare 2χB with
log(λ2) ≈1.668 instead.
6The spectral norm gives better bounds, but is harder to calculate. Also, computing means is easier
with simple trigonometric polynomials, via harvesting their quasiperiodicity.

7
Renormalisation for Block Substitutions
391
By standard subadditive arguments along the lines used for our previous exam-
ples, one ﬁnds that, for any N ∈N and then a.e. k ∈R2,
2χB(k) ⩽1
N M

log ∥B(N)(.)∥2
F
	
=: mN ,
(7.27)
where M again denotes the mean. Since log ∥B(N)(.)∥2
F is a quasiperiodic function
in two variables, with fundamental frequencies 1 and λ, the mean can be expressed
as an integral over the 4-torus, T4. To this end, one introduces new variables u1, u2
and v1, v2 such that
B(k) = ˜B(u1, u2, v1, v2)

u1=λk1 , u2=k1 , v1=λk2 , v2=k2
where ˜B is 1-periodic in each variable. Here, ˜B is deﬁned in complete analogy to
(7.25), with the corresponding modiﬁcations on r, p and q from Eq. (7.26); compare
[4] for a related one-dimensional case analysed previously. One now ﬁnds
mN = 1
N M

log ∥˜B(N)(.)∥2
F
	
= 1
N

T4 log ∥˜B(N)(u1, u2, v2, v2)∥2
F du1 du2 dv1 dv2 ,
(7.28)
which can be calculated numerically with good precision. Figure 7.3 illustrates the
result.
1
2
3
0
1
2
3
4
5
6
7
8
9
10
Fig. 7.3 Numerical values of the upper bounds mN of 2χB from Eq. (7.28), for 1 ⩽n ⩽10.
The horizontal line is at height 2 log(λ) ≈1.668. The estimated numerical errors are indicated by
vertical bars (the dotted line is for eye guidance only)

392
M. Baake and U. Grimm
Let us summarise this section as follows.
Theorem 7.9.1 Let ' be the set of control points of any element of the Frank–
Robinson tiling hull. Then, the diffraction measure of the corresponding Dirac
comb, δ', is of the form γ = dens(')2 δ0 + γsc, where the singular continuous
part can be expressed in terms of a generalised Riesz product.
More generally, if one assigns general complex weights u1, . . . , u4 to the four
types of control points, not all zero, the corresponding diffraction measure is still
singular, where the only point measure is the central peak at 0 with intensity
I0 = dens(')2 ν1u1 + . . . + ν4u4
2,
where dens(') = (3 + λ)/13 and where the νi are the prototile frequencies from
Eq. (7.24).
⊓⊔
The natural next step consists in deﬁning the (integrated) distribution function
for γsc in the positive quadrant, as
F(k1, k2) = γsc

[0, k1]×[0, k2]
	
,
with the matching extension to the other quadrants. This leads to a continuous func-
tion (which requires an extra argument along the directions of e1 and e2; compare
[8, Sec. 5] for a similar analysis) which behaves as F(k1, k2) ∼γ ({0}) k1k2 for
large values of k1 and k2. As such, it does not reveal the interesting structure of the
sc measure. A better understanding of the latter requires a multi-fractal analysis,
which is outside the scope of this survey.
At this point, it is suggestive to assume that also the dynamical spectrum is
singular, in particular in the light of [14], but we have no complete answer to this
question at present.
7.10
Closing Remarks
As we have illustrated by various examples, Lyapunov exponents lead to useful
insight on the spectral nature of inﬂation tilings in any dimension. They are a
powerful tool to exclude absolutely continuous spectral components. So far, our
approach is taylored to inﬂation tiling spaces with ﬁnitely many prototiles up to
translations, and thus gives no new insight to pinwheel-type systems. Nevertheless,
the latter also have a strong renormalisation structure, and further progress seems
possible.
To explore the absence of ac diffraction and spectral measures in more generality,
one would need a more analytic (rather than numerical) approach to the estimates for
upper bounds, or, ideally, exact expressions of Fürstenberg type for the exponents.
Also, it would help to establish the almost sure existence of Lyapunov exponents

7
Renormalisation for Block Substitutions
393
as limits, which does not seem to be an easy task outside the constant-length or the
Pisot case.
In this exposition, we have mainly considered the absolutely continuous part
of the spectrum. It is not difﬁcult to analyse the pure point part as well, where
some results are discussed in [5, 6]. Considerably more involved seems the singular
continuous part, which originates from the different scalings one encounters.
Various results on the spectral measures in one dimension are derived in [18, 19]
via matrix Riesz products, which are not restricted to the self-similar case. It would
be interesting to establish a connection with the topological constraints on size and
shape changes [21, 22], which should at least be possible in the irreducible Pisot
case.
Acknowledgments It is our pleasure to thank Alan Bartlett, Michael Coons, Natalie Frank,
Franz Gähler, Alan Haynes, Neil Mañibo, Robbie Robinson, Dan Rust, Lorenzo Sadun and Boris
Solomyak for discussions and helpful comments on the manuscript. Various useful hints from
an anonymous reviewer are gratefully acknowledged. This work was supported by the German
Research Foundation (DFG), within the CRC 1283 at Bielefeld University, and by EPSRC through
grant EP/S010335/1.
References
1. S. Akiyama, M. Barge, V. Berthé, J.-Y. Lee, A. Siegel, On the Pisot substitution conjecture,
in Mathematics of Aperiodic Order, ed. by J. Kellendonk, D. Lenz, J. Savinien (Birkhäuser,
Basel, 2015), pp. 33–72
2. S. Aubry, C. Godrèche, J.M. Luck, Scaling properties of a structure intermediate between
quasiperiodic and random. J. Stat. Phys. 51, 1033–1074 (1988)
3. M. Baake, M. Coons, N. Mañibo, Binary constant-length substitutions and Mahler measures
of Borwein polynomials, in From Analysis to Visualization: JBCC 2017, ed. by D. Bailey,
N.S. Borwein, R.P. Brent, R.S. Burachik, J.-A.H. Osborn, B. Sims, Q.J. Zhu (Springer, Cham,
2020), pp. 303–322; arXiv:1711.02492
4. M. Baake, N.P. Frank, U. Grimm, E.A. Robinson, Geometric properties of a binary non-Pisot
inﬂation and absence of absolutely continuous diffraction. Stud. Math. 247, 109–154 (2019);
arXiv:1706.03976
5. M. Baake, F. Gähler, Pair correlations of aperiodic inﬂation rules via renormalisation: some
interesting examples. Topol. Appl. 205, 4–27 (2016); arXiv: 1511.00885
6. M. Baake, F. Gähler, N. Mañibo, Renormalisation of pair correlation measures for primitive
inﬂation rules and absence of absolutely continuous diffraction. Commun. Math. Phys. 370,
591–635 (2019); arXiv:1805.09650
7. M. Baake, U. Grimm, Aperiodic Order. Vol. 1: A Mathematical Invitation (Cambridge
University Press, Cambridge, 2013)
8. M. Baake, U. Grimm, Squirals and beyond: Substitution tilings with singular continuous
spectrum. Ergodic Theory Dyn. Syst. 34, 1077–1102 (2014); arXiv:1205.1384
9. M. Baake, U. Grimm (eds.), Aperiodic Order. Vol. 2: Crystallography and Almost Periodicity
(Cambridge University Press, Cambridge, 2017)
10. M. Baake, U. Grimm, N. Mañibo, Spectral analysis of a family of binary inﬂations rules. Lett.
Math. Phys. 108, 1783–1805 (2018); arXiv:1709.09083
11. M. Baake, A. Haynes, D. Lenz, Averaging almost periodic functions along exponen-
tial sequences, in Aperiodic Order. Vol. 2: Crystallography and Almost Periodicity, ed.

394
M. Baake and U. Grimm
by M. Baake, U. Grimm (Cambridge University Press, Cambridge, 2017), pp. 343–362;
arXiv:1704.08120
12. M. Baake, D. Lenz, Dynamical systems on translation bounded measures: pure point
dynamical and diffraction spectra. Ergodic Theory Dyn. Syst. 24, 1867–1893 (2004);
arXiv:math.DS/0302061
13. M. Baake, D. Lenz, Spectral notions of aperiodic order. Discrete Contin. Dyn. Syst. S 10,
161–190 (2017); arXiv:1601.06629
14. M. Baake, D. Lenz, A.C.D. van Enter, Dynamical versus diffraction spectrum for struc-
tures with ﬁnite local complexity. Ergodic Theory Dyn. Syst. 35, 2017–2043 (2015);
arXiv:1307.7518
15. A. Bartlett, Spectral theory of Zd substitutions. Ergodic Theory Dyn. Syst. 38, 1289–1341
(2018); arXiv:1410.8106
16. C. Berg, G. Forst, Potential Theory on Locally Compact Abelian Groups (Springer, Berlin,
1975)
17. A. Berlinkov, B. Solomyak, Singular substitutions of constant length. Ergodic Theory Dyn.
Syst. 39, 2384–2402 (2019); arXiv:1705.00899
18. A. Bufetov, B. Solomyak, On the modulus of continuity for spectral measures in substitution
dynamics. Adv. Math. 260, 84–129 (2014); arXiv:1305.7373
19. A. Bufetov, B. Solomyak, A spectral cocycle for substitution systems and translation ﬂows. J.
Anal. Math. (in press); arXiv:1802.04783
20. L. Chan, U. Grimm, Spectrum of a Rudin–Shapiro-like sequence. Adv. Appl. Math. 87, 16–23
(2017); arXiv:1611.04446
21. A. Clark, L. Sadun, When size matters: Subshifts and their related tiling spaces. Ergodic Theory
Dyn. Syst. 23, 1043–1057 (2003); arXiv:math.DE/0201152
22. A. Clark, L. Sadun, When shape matters: deformation of tiling spaces. Ergodic Theory Dyn.
Syst. 26, 69–86 (2006); arXiv:math.DE/0306214
23. C. Corduneanu, Almost Periodic Functions, 2nd English edn. (Chelsea, New York, 1989)
24. M. Einsiedler, T. Ward, Ergodic Theory — with a View Towards Number Theory (Springer,
London, 2011)
25. G. Everest, T. Ward, Heights of Polynomials and Entropy in Algebraic Dynamics (Springer,
London, 1999)
26. N.P. Frank, Multi-dimensional constant-length substitution sequences. Topol. Appl. 152, 44–
69 (2005)
27. N.P. Frank, A primer of substitution tilings of the Euclidean plane. Expo. Math. 26, 295–326
(2008); arXiv:0705.1142
28. N.P. Frank, Tilings with inﬁnite local complexity, in Mathematics of Aperiodic Order, ed. by
J. Kellendonk, D. Lenz, J. Savinien (Birkhäuser, Basel, 2015), pp. 223–257; arXiv: 1312.4987
29. N.P. Frank, Introduction to hierarchical tiling dynamical systems, in Substitution and Tiling
Dynamics: Introduction to Self-inducing Structures, ed. by S. Akiyama, P. Arnoux. Lecture
Notes in Mathematics, vol. 2273 (Springer, Cham, 2020); arXiv:1802.09956
30. N.P. Frank, E.A. Robinson, Generalized β-expansions, substitution tilings, and local ﬁniteness.
Trans. Am. Math. Soc. 360, 1163–1177 (2008); arXiv: math.DS/0506098
31. N.P. Frank, L. Sadun, Topology of (some) tiling spaces without ﬁnite local complexity. Discrete
Contin. Dyn. Syst. A 23, 847–865 (2009); arXiv:math.DS/ 0701424
32. N.P. Frank, L. Sadun, Fusion: a general framework for hierarchical tilings of Rd. Geom.
Dedicata 171, 149–186 (2014); arXiv:1101.4930
33. D. Frettlöh, More inﬂation tilings, in Aperiodic Order. Vol. 2: Crystallography and Almost
Periodicity, ed. by M. Baake, U. Grimm (Cambridge University Press, Cambridge, 2017),
pp. 1–37
34. D. Frettlöh, C. Richard, Dynamical properties of almost repetitive Delone sets. Discrete Contin.
Dyn. Syst. A 34, 531–556 (2014); arXiv:1210.2955
35. C. Godrèche, J.M. Luck, Multifractal analysis in reciprocal space and the nature of the Fourier
transform of self-similar structures. J. Phys. A: Math. Gen. 23, 3769–3797 (1990)
36. P.R. Halmos, Measure Theory (Springer, New York, 1974, reprint)

7
Renormalisation for Block Substitutions
395
37. J. Hartinger, R.F. Kainhofer, R.F. Tichy, Quasi-Monte Carlo algorithms for unbounded,
weighted integration problems. J. Complexity 20, 654–668 (2004)
38. J. Kellendonk, D. Lenz, J. Savinien (eds.), Mathematics of Aperiodic Order (Birkhäuser, Basel,
2015)
39. L. Kuipers, H. Niederreiter, Uniform Distribution of Sequences, reprint (Dover, New York,
2006)
40. J.-Y. Lee, R.V. Moody, B. Solomyak, Pure point dynamical and diffraction spectra. Ann. Henri
Poincaré 3, 1003–1018 (2002); arXiv:0910.4809
41. J.-Y. Lee, B. Solomyak, On substitution tilings and Delone sets without ﬁnite local complexity.
Discrete Contin. Dyn. Syst. A 39, 3149–3177 (2019); arXiv:1804.10235
42. E.H. Lieb, M. Loss, Analysis, 2nd edn. (American Mathematical Society, Providence, RI, 2001)
43. J.M. Luck, A classiﬁcation of critical phenomena on quasi-crystals and other aperiodic
structures. Europhys. Lett. 24, 359–364 (1993)
44. N. Mañibo, Lyapunov exponents for binary substitutions of constant length. J. Math. Phys. 58,
113504 (9 pp) (2017); arXiv:1706.00451
45. N. Mañibo, Spectral analysis of primitive inﬂation rules. Oberwolfach Rep. 14, 2830–2832
(2017)
46. R.V. Moody, N. Strungaru, Almost periodic measures and their Fourier transforms, in
Aperiodic Order. Vol. 2: Crystallography and Almost Periodicity, ed. by M. Baake, U. Grimm
(Cambridge University Press, Cambridge, 2017), pp. 173–270
47. Y. Peres, W. Schlag, B. Solomyak, Sixty years of Bernoulli convolutions, in Fractal Geometry
and Stochastics II, ed. by C. Bandt, S. Graf, M. Zähle (Birkhäuser, Basel, 2000), pp. 39–65
48. M. Queffélec, Substitution Dynamical Systems — Spectral Analysis. Lecture Notes in Mathe-
matics, vol. 1294, 2nd edn. (Springer, Berlin, 2010)
49. K. Schmidt, Dynamical Systems of Algebraic Origin (Birkhäuser, Basel, 1995)
50. B. Simon, Analysis, Part I: Real Analysis (American Mathematical Society, Providence, RI,
2014)
51. B. Sing, Pisot Substitutions and Beyond, PhD thesis, Bielefeld University (2007). Available
electronically at urn:nbn:de:hbz:361-11555
52. I.M. Sobol, Calculation of improper integrals using uniformly distributed sequences. Soviet
Math. Dokl. 14, 734–738 (1973)
53. B. Solomyak, Nonperiodicity implies unique composition for self-similar translationally ﬁnite
tilings. Discrete Comput. Geom. 20, 265–279 (1989)
54. B. Solomyak, Dynamics of self-similar tilings. Ergodic Theory Dyn. Syst. 17, 695–738 (1997)
and 19, 1685 (1999) (Erratum)
55. B. Solomyak, Delone sets and dynamical systems, in Substitution and Tiling Dynamics:
Introduction to Self-inducing Structures, ed. by S. Akiyama, P. Arnoux. Lecture Notes in
Mathematics, vol. 2273 (Springer, Cham, 2020)
56. N. Strungaru, Almost periodic pure point measures, in Aperiodic Order. Vol. 2: Crystallography
and Almost Periodicity, ed. by M. Baake, U. Grimm (Cambridge University Press, Cambridge,
2017), pp. 271–342; arXiv: 1501.00945
57. M. Viana, Lectures on Lyapunov Exponents (Cambridge University Press, Cambridge, 2013)
58. G.H. Wannier, Antiferromagnetism. The triangular Ising net. Phys. Rev. 79, 357–364 (1950)
and Phys. Rev. B 7, 5017 (1973) (Erratum)

Chapter 8
Yet Another Characterization of the Pisot
Substitution Conjecture
Paul Mercat and Shigeki Akiyama
Abstract We give a sufﬁcient geometric condition for a subshift to be measurably
isomorphic to a domain exchange and to a translation on a torus. This gives
another characterization of the Pisot substitution conjecture. For an irreducible unit
Pisot substitution, we introduce a new topology on the discrete line and give a
simple necessary and sufﬁcient condition for the symbolic system to have pure
discrete spectrum. This condition gives rise to an algorithm based on computation of
automata. To see the power of this criterion, we provide families of substitutions that
are shown, using different methods, to satisfy the Pisot substitution conjecture:
•
a →akbc, b →c, c →a, for k ∈N
•
a →albak−l, b →c, c →a, for k ∈N≥1, for 0 ≤l ≤k.
We also provide an example of S-adic system with pure discrete spectrum.
8.1
Introduction
Sturmian systems are well-known examples of subshifts that are conjugate to trans-
lations on the torus R/Z. In 1982, Gérard Rauzy (see [18]) gave a generalization
to higher dimension for the subshift generated by the inﬁnite ﬁxed point of the
Tribonacci substitution:
⎧
⎨
⎩
a →ab
b →ac
c →
a
.
P. Mercat ()
Aix-Marseille Université, Marseille, France
e-mail: paul.mercat@univ-amu.fr
S. Akiyama
Institute of Mathematics, University of Tsukuba, Tsukuba, Japan
e-mail: akiyama@math.tsukuba.ac.jp
© The Editor(s) (if applicable) and The Author(s), under exclusive license
to Springer Nature Switzerland AG 2020
S. Akiyama, P. Arnoux (eds.), Substitution and Tiling Dynamics: Introduction
to Self-inducing Structures, Lecture Notes in Mathematics 2273,
https://doi.org/10.1007/978-3-030-57666-0_8
397

398
P. Mercat and S. Akiyama
He constructed a compact subset of R2 (which we call now the Rauzy fractal) that
tiles the plane by translation and on which we can deﬁne a domain exchange which
is measurably conjugate both to the symbolic subshift, and to a translation on the
two dimensional torus R2/Z2.
In 2001, Arnoux and Ito (see [2]) generalized the work of Rauzy to any
irreducible unit Pisot substitution. They introduced a combinatorial condition which
is easy to check, called the strong coincidence, that permits to get a measurable
conjugacy between the subshift and a domain exchange, which is also a ﬁnite
extension of a translation on a torus.
All the known examples satisﬁed the condition, and this led to one of the main
open questions in the ﬁeld, the Pisot substitution conjecture. This conjecture has
also been cited in Chaps. 1, 2, 3, and 7, and we cite below the statement given in
Chap. 2 as Conjecture 2.6.1, which is the simplest and most restricted form of the
conjecture.
Conjecture 8.1.1 (Pisot Substitution Conjecture: Symbolic Substitutive Case) If σ
is an irreducible Pisot substitution then the associated substitutive system (Ωσ, Z)
has pure discrete spectrum.
This conjecture has been proved in the case of two letters (see [3]), but not
for larger alphabets. It admits several generalizations, to tilings and to higher
dimensions, and it can be formulated in several equivalent ways, symbolic or
geometric, see [1]. One way to attack this conjecture is to understand well the
construction of [2]. Then we soon realize that the strong coincidence (which is still
open for all irreducible Pist substitutions) seems a little too weak to achieve this
goal. To obtain a measurable conjugacy between the subshift of an irreducible unit
Pisot substitution and a translation on a torus, several equivalent conditions (super
coincidence, Geometric coincidence) have been studied, see for example [4, 10].
This article gives another formulation of these various coincidences and a short
proof of their equivalence. The new criterion is checked by automata computation.
We introduce a topology on Zd that permits to characterize easily when the
subshift of a given irreducible unit Pisot substitution over d letters is measurably
isomorphic to a translation on a (d −1)-dimensional torus: see Theorem 8.3.3. We
show that this condition is equivalent to the non-emptiness of some computable
regular language: see Theorem 8.5.11.
In the last section, we use this condition to prove pure discreteness for the family
of substitution
sk :
⎧
⎨
⎩
a →akbc
b →c
c →a

8
Yet Another Characterization of the Pisot Substitution Conjecture
399
for k ∈N, where ak means that the letter a is repeated k times. And we also prove
pure discreteness for the family of substitution
sl,k :
⎧
⎨
⎩
a →albak−l
b →c
c →a
for k ∈N≥1, 0 ≤l ≤k, by computing explicitly a automaton describing algebraic
relations, and showing that pure discreteness for the substitution
sk :
⎧
⎨
⎩
a →akb
b →c
c →a
implies pure discreteness for the other substitutions.
We also use the criterion to prove pure discreteness for the S-adic system with
the two substitutions
s1 :
⎧
⎨
⎩
a →aab
b →
c
c →
a
and
s2 :
⎧
⎨
⎩
a →aba
b →
c
c →
a
,
for all words in {s1, s2}N.
8.2
A Criterion for a Subshift to Have Purely Discrete
Spectrum
In this section, we describe a general geometric criterion for a subshift to be
measurably isomorphic to a translation on a torus. Let us start by introducing some
notations.
8.2.1
Subshift
We denote by AN (respectively AZ) the set of inﬁnite (respectively bi-inﬁnite) words
over an alphabet A. We denote by |u| the length of a word u, and |u|a denotes the
number of occurrences of the letter a in a word u ∈A∗. And we denote by
Ab(u) = (|u|a)a∈A ∈NA

400
P. Mercat and S. Akiyama
the abelianisation vector of a word u ∈A∗. The canonical basis of RA will be
denoted by (ea)a∈A = (Ab(a))a∈A.
The shift on inﬁnite words is the application
S :
AN −→AN
(ui)i∈N −→(ui+1)i∈N
We can also deﬁne the shift on bi-inﬁnite words in an obvious way, and it becomes
invertible.
We denote SNu = {Snu | n ∈N} and SZu = {Snu | n ∈Z}. We use the usual
metric on AN:
d(u, v) = 2−n where n is the length of the maximal common preﬁx.
The map S is continuous for this metric. Given an inﬁnite word u, the compact set
SNu is S-invariant. We call subshift generated by u, the dynamical system (SNu, S).
The same can be done for bi-inﬁnite words.
8.2.2
Discrete Line Associated to a Word
Let u ∈AN be an inﬁnite word over the alphabet A. Then, the associated discrete
line is the following subset of ZA:
Du :=

Ab(v) ∈ZA v ﬁnite preﬁx of u

.
If u ∈AZ is a bi-inﬁnite word, then the corresponding discrete line is
Du := −Dv ∪Dw,
where v, w ∈AN are inﬁnite words such that u = tvw, where tv = . . . vn . . . v2v0
denotes the mirror of the word v = v0v2 . . . vn . . ..
For u ∈AN, we can partition this discrete line into d = |A| pieces. For every
a ∈A, let
Du,a :=

Ab(v) ∈ZA va ﬁnite preﬁx of u

.
The sets Du,a + ea, a ∈A, also gives almost a partition of Du:
Du = {0} ∪

a∈A
Du,a + ea.

8
Yet Another Characterization of the Pisot Substitution Conjecture
401
For a bi-inﬁnite word u ∈AZ, we have the same, but we get a real partition, without
the {0}. In both cases, these partitions permit to see the shift S on the word u as a
domain exchange E:
E : Du −→Du
x −→x + ea for a ∈A such that x ∈Du,a.
There is also a property of tiling for this discrete line: we have the following
Proposition 8.2.1 Let Γ0 be the subgroup of ZA generated by (ea−eb)a,b∈A, and let
u be any bi-inﬁnite aperiodic word over the alphabet A. Then Du is a fundamental
domain for the action of Γ0 on ZA. Moreover the translation T by ea (for any a ∈A)
on ZA/Γ0 is conjugate to the domain exchange E on Du by the natural quotient map
π0 : ZA →ZA/Γ0, and the shift (SZu, S) is conjugate to the domain exchange
(Du, E) by the map
c : SZu →Du
Snu →En0 .
Remark 8.2.2 We have the same for inﬁnite non-eventually periodic words, but we
get a fundamental domain for the action on the half-space

(xa)a∈A ∈ZA 
a∈A xa ≥0

,
and a conjugacy with the shift on SNu.
Proof The vectors (ea)a∈A are equivalent modulo the group Γ0. Hence, this discrete
line is equivalent to Zea for any letter a ∈A, and this is an obvious fundamental
domain of ZA for the action of Γ0. The map c is well-deﬁned and one-to-one because
the word u is aperiodic. And it gives a conjugacy between the shift (SZu, S) and the
domain exchange (Du, E): c ◦S = E ◦c. The natural quotient map π0 : ZA →
ZA/Γ0 restricted to Du is bijective, and it gives a conjugacy between the domain
exchange (Du, E) and the translation (ZA/Γ0, T ): π0 ◦E = T ◦π0.
If the discrete line Du stays near a given line of RA (this will be the case for
example for periodic points of Pisot substitutions), then we can project onto a
hyperplane P of RA (for example the hyperplane of equation 
a∈A xa = 0) along
this line. The projection of ZA is dense in the hyperplane for almost all lines, and
the group Γ0 becomes a lattice in the hyperplane. If the projection of the discrete
line is not so bad, we can expect that the closure gives a tiling of the hyperplane, and
that the closure of each piece of the partition of the discrete line doesn’t intersect
each other. And we can expect that the conjugacy given by the previous proposition
becomes a conjugacy of the closures. Figure 8.1 shows the conjugacy given by the
Proposition 8.2.1, and what we get if everything goes well.
Let us now give a general geometric criterion that permits to know that everything
works well as in Fig. 8.1.

402
P. Mercat and S. Akiyama
Fig. 8.1 Commutative
diagrams of the conjugacy
between the shift S, the
domain exchange E and the
translation T on the quotient
torus, before and after taking
the closure
8.2.3
Geometrical Criterion for the Pure Discreteness of the
Spectrum
Here is the main general geometric criterion for a subshift to have a pure discrete
spectrum. We use the notations deﬁned in Sect. 8.2.2.
Theorem 8.2.3 Let u ∈AN be an inﬁnite word over an alphabet A, and let π
be a linear projection from RA onto a hyperplane P. We assume that we have the
following:
•
the restriction of π to ZA is injective and has a dense image,
•
the set π(Du) is bounded,
•
the subshift (SNu, S) is minimal,
•
the boundaries of π(Du,a), a ∈A, have zero Lebesgue measure,
•
the union π(Du) = 
a∈A π(Du,a) is disjoint in measure.
Then there exists a σ-algebra and a S-invariant measure μ such that the subshift
(SNu, S, μ) is a ﬁnite extension of the translation of the torus (P/π(Γ0), T, λ),
where T is the translation by π(ea) (for any a ∈A) on the torus P/π(Γ0), Γ0 is
the group generated by

ea −eb a, b ∈A

, and λ is the Lebesgue measure. And it
is also a topological semi-conjugacy.
If moreover the union

t∈π(Γ0)
π(Du) + t = P
is disjoint in Lebesgue measure, then the subshift (SNu, S, μ) is uniquely ergodic
and is isomorphic to the translation on the torus (P/π(Γ0), T, λ) and to a domain
exchange on π(Du).
Remark 8.2.4 The disjointness in measure of the union

t∈π(Γ0)
π(Du) + t = P,

8
Yet Another Characterization of the Pisot Substitution Conjecture
403
implies the disjointness in measure of the union

a∈A
π(Du,a) = π(Du),
and it also implies that the boundaries of π(Du,a), a ∈A, have zero Lebesgue
measure.
Indeed, if we have λ(π(Du,a) ∩π(Du,b)) > 0, then we have
λ

(π(Du) + π(ea −eb)) ∩π(Du)

≥λ

(π(Du,a) ∩π(Du,b)) + π(ea)

> 0,
so we have a = b.
And we obtain that the boundary of each π(Du,a), a ∈A, has zero Lebesgue
measure, since
∂π(Du,a) ⊆π(Du,a) ∩
⎛
⎝
b∈A\{a}
π(Du,b) ∪

t∈π(Γ0)\{0}
π(Du) + t
⎞
⎠.
In order to prove this theorem, we start by showing that we can extend by
continuity the map π ◦c : SNu →π(Du) that gives the conjugacy between the
shift (SNu, S) and the domain exchange (π(Du), E).
Lemma 8.2.5 Let u ∈AN be a non-eventually periodic inﬁnite word over an
alphabet A, and let π be a projection from RA onto a hyperplane P. We assume
that π(Du) is bounded. Then the map
π ◦c : SNu →π(Du)
Snu →En0
can be extended by continuity at any point of the closure whose orbit is dense in
SNu.
To prove this lemma, we need the following geometric lemma, saying that we
can always translate a bounded set of Rd in order to have a non empty but arbitrarily
small intersection with the initial set.
Lemma 8.2.6 Let Ω be a bounded subset of Rd. Then, we have
inf
t∈Ω−Ω diam(Ω ∩(Ω −t)) = 0.
The proof is left as an exercise. It can be proven for example by considering a
diameter and using the parallelogram law.
Proof of Lemma 8.2.5 Let w ∈SNu having dense orbit in SNu and let ϵ > 0. By
Lemma 8.2.6, there exists t ∈Du−Du such that diam(π(Du)∩(π(Du)−π(t))) ≤ϵ.

404
P. Mercat and S. Akiyama
Let n1 and n2 ∈N such that c(Sn2u) −c(Sn1u) = t. We can assume that n1 ≤n2
up to replace t by −t. Then, there exists n0 ∈N such that d(Sn0w, u) ≤2−n2.
Now, for all v ∈SNu such that d(w, v) ≤2−(n0+n2), we have that c(Sn0+n1v) ∈
Du∩(Du−t), because c(Sn0+n2v)−c(Sn0+n1v) = t. Hence, if we let η = 2−(n0+n2),
we have for all v, v′ ∈Du,
d(v, w) ≤η
and
d(v′, w) ≤η
⎫
⎬
⎭⇒d(π ◦c(v), π ◦c(v′)) = d(π ◦c(Sn0+n1v), π ◦c(Sn0+n1v′)) ≤ϵ.
This proves that we can extend π ◦c by continuity at point w.
Lemma 8.2.7 Let u ∈AN be an inﬁnite non-eventually periodic word over an
alphabet A, and let π be a projection from RA onto a hyperplane P. We assume
that we have the following conditions:
•
the restriction of the projection π to ZA is injective and has a dense image,
•
the set π(Du) is bounded,
•
for every a ∈A, the boundary of π(Du,a) has zero Lebesgue measure,
•
the union 
a∈A π(Du,a) = π(Du), is disjoint in Lebesgue measure.
Then the natural coding cod of (π(Du), E) for the partition Du = 
a∈A Du,a, can
be extended by continuity to a full measure part M of the closure. And we have
∀x ∈M,
lim
y→x
y∈π(Du)
(π ◦c)−1(y) = cod(x).
Proof Let Ω = π(Du) and ∀a ∈A, Ωa = π(Du,a). We can extend the domain
exchange E in an obvious way:
E′ :

a∈A
◦
Ωa −→Ω
x
−→x + π(ea) for a ∈A such that x ∈
◦
Ωa.
The part of full Lebesgue measure that we consider is the E′-invariant set
M :=

n∈N
E′−nΩ.
Let ϵ > 0 and let x ∈M. Let n0 ∈N≥1 such that 2−n0 ≤ϵ. The set
Mn0 :=
n0

n=0
E′−nΩ

8
Yet Another Characterization of the Pisot Substitution Conjecture
405
is an open set containing x, because E′ is continuous and E′−1Ω = 
a∈A
◦
Ωa
is open. Hence there exists η > 0 such that B(x, η) ⊆Mn0. And for every y ∈
B(x, η) ∩M, the natural coding of (M, E′) for the partition M = 
a∈A M ∩Ωa +
π(ea) coincides with the coding of x for the n0 ﬁrst steps. Hence, cod is continuous
on M. We get also the last part of the lemma by observing that if y ∈B(x, η) ∩
π(Du), then the coding of y (which is equal to (π ◦c)−1(y)) also coincide with the
coding of x for the n0 ﬁrst steps.
Now we can prove the main theorem of this section. We start by extending the
map π ◦c by continuity, and we show that this map is almost everywhere one-to-one.
It gives us an isomorphism between the subshift (SNu, S, μ), for some measure μ,
and a domain exchange deﬁned Lebesgue-almost everywhere on π(Du). Then, we
show that the map π0 : π(Du) →P/π(Γ0) is ﬁnite-to-one, and it gives us that the
subshift is a ﬁnite extension of the translation on the torus (P/π(Γ0), T, λ). Then if
we assume that we have also the last hypothesis that π(Du) tiles the hyperplane P,
then we deduce that we have the isomorphism with the translation on the torus, and
we show that the unique ergodicity of the translation on the torus implies the unique
ergodicity of the subshift.
Proof of the Theorem 8.2.3 The hypothesis on the projection π show that u cannot
be eventually periodic. Indeed, if u was eventually periodic with a period v ∈A∗,
then the hypothesis that π(Du) is bounded implies that π(Ab(v)) = 0, but this
contradict the hypothesis that the restriction of π to ZA is injective.
The Lemma 8.2.5 shows that we can extend the map π ◦c by continuity to a
map c : SNu →π(Du). If we compose c with the natural projection π0 onto the
torus P/π(Γ0), we get a continuous function which is onto, because of the equality
π(Γ0) + π(Du) = P that comes from Γ0 + Du = ZA. And we have the equality
π0 ◦c ◦S = T ◦π0 ◦c,
where T is the translation by π(ea) (for any a ∈A) on the torus P/π(Γ0). Indeed,
this equality is true on the dense subset SNu by the Proposition 8.2.1, and the
maps π0, S and T are continuous. This proves that the translation on the torus
(P/π(Γ0), T ) is a topological factor of the subshift (SNu, S).
Let’s consider the σ-algebra that we get from the Borel σ-algebra with the
continuous map π0 ◦c : SNu →P/π(Γ0). A measure μ on this σ-algebra can
be deﬁned by μ((π0 ◦c)−1(A)) = λ(A) for any Borel set A of P/π(Γ0), where
λ is the Lebesgue measure. By continuity, this measure μ that we get on SNu is
S-invariant, and for this measure the translation of the torus (P/π(Γ0), T, λ) is a
factor of the subshift (SNu, S, μ). Then, the Lemma 8.2.7 gives
∀x ∈c−1(M), x = lim
y→x
y∈SNu
(π ◦c)−1 ◦π ◦c(y) = cod(x) ◦c.

406
P. Mercat and S. Akiyama
So the map c is one-to-one on the subset of full μ-measure c−1(M). Hence, the map
c : SNu →π(Du) is a measurable conjugacy between the subshift (SNu, S, μ) and
the domain exchange (π(Du), E, λ).
To prove that the subshift is a ﬁnite extension of the translation on the torus,
it remains to show that the number of preimages by π0 is bounded and almost
everywhere constant. The boundedness is a consequence of the hypothesis that
π(Du) is bounded, and because π(Γ0) is a discrete subgroup of P. But this number
of preimages is invariant by the translation, so by ergodicity of the translation on
the torus, it is almost everywhere constant. Hence we get that the domain exchange
(π(Du), E, λ) (which is isomorphic to the subshift (SNu, S, μ)) is a ﬁnite extension
of the translation on the torus (P/π(Γ0), T, λ).
If we assume moreover that the sets π(Du)+t, t ∈π(Γ0), are disjoint in measure,
then the map π0 : π(Du) →P/π(Γ0) is invertible almost everywhere, is one-
to-one on c−1(M), and is a measurable conjugacy between the domain exchange
(π(Du), E, λ) and the translation on the torus (P/π(Γ0), T, λ). And the map π0◦c :
SNu →P/π(Γ0) is a measurable conjugacy between the subshift (SNu, S, μ) and
the translation on the torus (P/π(Γ0), T, λ).
Then, the unique ergodicity of the translation on the torus implies that the subshift
is also uniquely ergodic. Indeed, if μ′ is an S-invariant measure of SNu, then the
pushforward (π0 ◦c)∗(μ′) is a T -invariant measure of the torus P/π(Γ0), so it is
proportional to the Lebesgue measure. And the μ′-measure of the complementary
of the set c−1(M) is 0, so the support of μ′ is included in the support of μ. And the
restriction of π0 ◦c to c−1(M) is injective and bi-continuous, thus we have μ′ = μ
up to a scaling constant.
8.2.4
An Easy Example: Generalization of Sturmian
Sequences
An easy example where all works ﬁne is obtained by taking a random line of Rd
with a positive direction vector. We consider the natural Zd-tiling by hypercubes,
and we take the sequence of hyperfaces that intersect the line. Almost surely, this
gives a discrete line corresponding to some word u over the alphabet of the d type
of hyperfaces. It is not difﬁcult to see that the orthogonal projection π along the
line onto a hyperplane P behave correctly for almost every choice of line. It gives a
set whose closure tile the plane, on which a domain exchange acts. This dynamics
is conjugate to the subshift generated by the word u. It is also conjugate to the
translation by π(e1) on the torus P/π(Γ0) ≃Td−1. Figure 8.2 shows the domain
exchange for a line whose a direction vector is around (0.54973, 0.36490, 0.99501)
in R3.
Remark 8.2.8 The word appearing in this last example is obtain by a simple
algorithm: If the positive direction vector of the line is (v1, v2, v3), and if the line

8
Yet Another Characterization of the Pisot Substitution Conjecture
407
Fig. 8.2 Domain exchange conjugate to a translation on the torus T2, and also conjugate to the
subshift generated by a word corresponding to a discrete approximation of a line of R3
goes through the point (c1, c2, c3) then we have almost surely
∃(k1, k2, k3) ∈Z3, ∀j ∈{1, 2, 3}, kj = ⌊vj
kin −cin
vin
+ cj⌋
⇒∃!in+1 ∈{1, 2, 3}, ∀j ∈{1, 2, 3}\{in+1}, kj = ⌊vj
kin+1 + 1 −cin+1
vin+1
+ cj⌋.
The sequence (in)n∈N deﬁne an inﬁnite word over the alphabet {1, 2, 3}, and we get
a bi-inﬁnite word by invertibility of this algorithm.
8.3
Pure Discreteness for Irreducible Unit Pisot Substitution
In this section, we deﬁne a topology on NA that permits to give a simple condition to
get the pure discreteness of the spectrum of the subshift coming from an irreducible
Pisot unit substitution, using the criterion of the previous section. And in the next
section, we show that the reciprocal is true.
8.3.1
Substitutions
Let s be a substitution (i.e. a word morphism) over a ﬁnite alphabet A of cardinality
d. We denote by A∗the set of ﬁnite words over the alphabet A. Let Ms (or simply
M when there is no ambiguity) be the incidence matrix of s. It is the d × d matrix
whose coefﬁcients are
ma,b = |s(b)|a , ∀(a, b) ∈A2,

408
P. Mercat and S. Akiyama
where |u|a denotes the number of occurrences of the letter a in a word u ∈A∗. A
periodic point of s is a ﬁxed point of some power of s. It is an inﬁnite word u ∈AN
such that there exists k ∈N≥1 such that sk(u) = u.
A substitution s is primitive if there exists a n ∈N such that for all a and b ∈A,
the letter b appears in sn(a). A substitution s is irreducible if its incidence matrix
is irreducible—i.e. if the degree of the Perron eigenvalue of the matrix equals the
number of letters of the substitution.
If u is a periodic point of a primitive substitution, we can check that the subshift
(SNu, S) depends only on the substitution and is minimal.
We say that a substitution s is Pisot if the maximal eigenvalue of its incidence
matrix is a Pisot number—i.e. an algebraic integer greater than one, and whose
conjugates have modulus less than one. If a substitution is Pisot irreducible, we can
verify that the projection π onto a hyperplane, along the eigenspace for the Pisot
eigenvalue is bounded. We say that a Pisot number is an unit if its inverse is an
algebraic integer. We say that a substitution is an irreducible Pisot unit substitution
if the substitution is irreducible (i.e. the characteristic polynomial of the incidence
matrix is irreducible), the highest eigenvalue of the incidence matrix is a Pisot
number, and the determinant of the incidence matrix is ±1. It is equivalent to say
that the incidence matrix has only one eigenvalue of modulus greater or equal to
one, and that this eigenvalue is a Pisot unit number.
8.3.2
Topology and Main Criterion
Let A be a ﬁnite set, P be an hyperplane of RA (for example the hyperplane of
equation 
a∈A xa = 0), and π be an irrational projection onto this hyperplane—
that is a projection such that π(ZA) is dense in P. We deﬁne, for any subset S of P,
the discrete line of points that project to S:
QS =

x ∈NA π(x) ∈S

.
This permits to deﬁne a topology on NA by taking the following set of open sets

QU U open subset of P

.
And we can extend this topology to ZA by considering the open sets of ZA

S ⊆ZA S ∩NA is an open subset of NA
.
Remark 8.3.1 We could deﬁne the topology directly on the whole space ZA and
work with bi-inﬁnite words, but this topology permits to deal with inﬁnite words.

8
Yet Another Characterization of the Pisot Substitution Conjecture
409
Properties 8.3.2 The topology that we just deﬁned has the following properties:
•
If the projection π is such that π(ZA) is dense in P, then for any open subset U
of P, we have that π(QU) is dense in U, and we have
QU = ∅⇐⇒U = ∅.
•
For any bounded subset S ⊆P and any t ∈ZA, the symmetric difference
(QS + t)ΔQS+t
is ﬁnite. In particular, we have
◦
QS = ∅⇐⇒
◦
QS+t = ∅⇐⇒
◦
8 96 7
QS + t = ∅.
•
If det(M) ∈{−1, 1}, then for any bounded subset S of P, the symmetric
difference (MQS)ΔQπ(MS) is ﬁnite. In particular, we have
◦
8 96 7
MQS = ∅⇐⇒
◦
Qπ(MS) = ∅.
•
The space NA is a Baire space for this topology.
The fact that NA is a Baire space follows from the fact that P is a Baire space,
by the Baire category theorem. Indeed, if Q is a dense open set of Zd, then there
exists a dense open set U of P such that Q = QU. Hence, a countable intersection
of dense open subsets of Zd is a dense subset of Zd.
This topology gives a necessary and sufﬁcient condition for the subshift of a Pisot
irreducible substitution, to have a pure discrete spectrum:
Theorem 8.3.3 Let s be an irreducible unit Pisot substitution over an alphabet A,
and let u ∈AN be a periodic point of s. Then the subshift (SNu, S) has pure discrete
spectrum if and only if ∃a ∈A,
◦
Du,a ̸= ∅.
8.3.3
Proof That an Inner Point Implies the Pure Discreteness
of the Spectrum
In this subsection, we prove the ﬁrst statement and the sufﬁciency of the second
statement. The necessity is proven in the next section.
Proof (First Part of the Proof of the Theorem 8.3.3) Up to replace the substitution
s by a power, we can assume that the periodic point u is a ﬁxed point. Let us show
that the hypothesis of the Theorem 8.2.3 are satisﬁed.
•
The restriction of the projection π to ZA is injective, and π(ZA) is dense in P:
this is known for every irreducible Pisot substitution.
•
The set π(Du) is bounded: it is well known that for any Pisot irreducible
substitution, the Rauzy fractal π(Du) is compact.

410
P. Mercat and S. Akiyama
•
The subshift (SNu, S) is minimal: this is true for every primitive substitution,
see [17] proposition 5.5.
Now if we assume that ∃a ∈A,
◦
Du,a ̸= ∅, then we have the following
Lemma 8.3.4 We have for all a ∈A,
◦
Du,a ̸= ∅and Du,a =
◦
Du,a.
Proof We have the equality
Du,a =

b
t−→a∈As
MDu,b + t,
where b
t−→a ∈As means that it is a transition in the automaton As (i.e. there
exists words u, v ∈A∗such that s(b) = uav and Ab(u) = t). By primitivity, up to
iterate enough this equality, every set Du,b appears in the union, so every set Du,a
has non-empty interior as soon as one of them has non-empty interior. This ends the
proof of Lemma 8.3.4.
If we iterate n + 1 times the equality, we get
Du,a =

b
tn−→...
t0−→a∈As
MnDu,b +
n

k=0
Mktk,
where b
tn−→. . .
t0−→a ∈As means that there exists states (qi)n+1
i=0 of As with q0 = a
and qn+1 = b, such that for every i, qi+1
ti−→qi is a transition in As. Each term
of this union has non-empty interior, because each Du,b has non-empty interior and
det(M) ∈{−1, 1}. And the diameter of each π(MnDu,b) tends to zero as n tends to
inﬁnity, so it proves that the interior of Du,a is dense in Du,a.
Hence,
◦
Du is a dense open subset of π(Du). By Baire’s theorem, for all t ∈
Γ0\{0}, the empty set
◦
Du ∩(
◦
Du + t) is a dense subset of
◦
Du ∩(
◦
Du + t), therefore
the sets
◦
Du and (
◦
Du + t) are disjoint. Moreover the boundary of π(Du) has zero
Lebesgue measure since the substitution s is Pisot unimodular. This gives the wanted
disjointness in measure.
The hypothesis of the Theorem 8.2.3 are satisﬁed, thus the subshift (SNu, S) is
uniquely ergodic and measurably conjugate to the rotation by π(ea) on the torus
P/π(Γ0) with respect to the Lebesgue measure. In particular, it has pure discrete
spectrum.

8
Yet Another Characterization of the Pisot Substitution Conjecture
411
8.4
Algebraic Coincidence Ensures an Inner Point
In this section, we prove that pure discreteness of the subshift (SNu, S) ensures the
non emptiness of
◦
Du,a for some a.
8.4.1
Algebraic Coincidence of Substitutive Delone Set
A Delone set is a relatively dense and uniformly discrete subset of Rd. We say that
Λ = (Λa)a∈A is a Delone multi-color set in Rd (also called Delone m-set in chapter
1) if each Λa is a Delone set and ∪a∈AΛa ⊂Rd is Delone. Here a ‘multi-set’ Λ is
simply a vector whose entries are Delone sets. We introduce this concept instead of
taking their union, only because Λa ∩Λb may not be empty for a ̸= b. We think that
each element of Λa has color a. A set Λ ⊂Rd is a Meyer set if it is a Delone set and
there exists a ﬁnite set F that Λ −Λ ⊂Λ + F. A Delone set is a Meyer set if and
only if Λ−Λ is uniformly discrete in Rd [13]. Note that a Meyer set has ﬁnite local
complexity (FLC), i.e., for any r > 0 there are only ﬁnitely many transitionally
inequivalent clusters (conﬁgurations of points) in a ball of radius r. Λ = (Λa)a∈A
is called a substitution Delone multi-color set if Λ is a Delone multi-color set and
there exist an expansive matrix B and ﬁnite sets Dab for a, b ∈A such that
Λa =

b∈A
(BΛb + Dab),
a ∈A,
(8.1)
where the union on the right side is disjoint. The translation closure of the
multi-color Delone set gives a topological dynamical system, which is minimal
and uniquely ergodic if the substitution matrix (#Dab) is primitive. Lagarias and
Wang [12] proved that | det B| must be equal to the Perron Frobenius root of the
substitution matrix.
Self-afﬁne tiling dynamical system is the minimal and uniquely ergodic topolog-
ical dynamical system given by a self-afﬁne tiling with translation action (Solomyak
[21]). One can restates its translation dynamics by the translation action on the
corresponding multi-colored Delone set Λ (see [15]) Here a point in Λa represents
a tile colored by a. The points are located in relatively the same position in the
same colored tile. Lee [14] introduced algebraic coincidence of substitutive multi-
color Meyer set in Rd which is equivalent to pure discreteness of the corresponding
dynamical system.
In this section, we prove that if 1-dimensional substitutive Meyer set associated
to an irreducible Pisot unit substitution satisfy the algebraic coincidence, then there
exists a ∈A such that
◦
Du,a̸= ∅, which completes the proof of the main theorem.

412
P. Mercat and S. Akiyama
8.4.2
Substitutive Meyer Set from Du
Let s be a primitive substitution over an alphabet A whose substitution matrix is M.
Assume that v = . . . vn . . . v1 and u = u1 . . . un . . . are one-sided inﬁnite words
such that vu ∈AZ is a 2-sided ﬁxed point of s. The u (resp. v) is a right (resp.
left) inﬁnite ﬁxed point of s and v1u1 is the subword of σ n(a) for some n ∈N and
a ∈A. The left abelianisation Dv,a is deﬁned by
#
−
n

i=1
evi
 vn = a
$
.
and Dvu,a = Dv,a ∪Du,a. As s is a substitution, Du,a (resp. Dv,a) has one to
one correspondence to the words {u1 . . . un| n ∈N} (resp. {vn . . . v1| n ∈N}). We
also deﬁne Dvu = 
a∈A Dvu,a. Then Dvu is a geometric realization of the ﬁxed
point vu ∈AZ, that is, the set of vertices of a broken line naturally generated by
corresponding fundamental unit vectors ea (a ∈A).
We project this broken line to make a self-similar tiling of the real line by tiles
(intervals) corresponding to each letter. This is done by associating intervals whose
lengths are given by the entry of a left eigenvector ℓ= (ℓa)a∈A. The corresponding
expanding matrix is of size 1 and equal to the Perron Frobenius root of M. Deﬁne
ψ : Du,v →R by ψ(n
i eui) = n
i=1 ℓui and ψ(−n
i evi) = −n
i=1 ℓvi
according to the domain Du or Dv. Put Λa = {ψ(v)| v ∈Du,a} for a ∈A. We
normalize the eigenvector ℓso that ψ becomes the orthogonal projection to the 1-
dimensional subspace π−1(0) generated by the expanding vector of M. Then this is
exactly the set of left end points of intervals which consists the tiling. It is clear that
ψ : Du,a →Λa is bijective and preserves addition structure, i.e., if x ± y ∈Du,a
for x, y ∈Du,a then ψ(x ± y) = ψ(x) ± ψ(y) holds in Λa and vice versa. By
this choice of the length, Λ = (Λa)a∈A forms a substitution multi-colored Delone
set. When s is a Pisot substitution, Λ is a substitution multi-colored Meyer set. The
closure of the set of translations {Λ −t| t ∈R} by local topology forms a compact
set X and (X, R) is a topological dynamical system. By primitivity of s, this system
is minimal and uniquely ergodic. Moreover the system (X, R) is not weakly mixing
if and only if s is a Pisot substitution [21]. Clark and Sadun [6] showed that if s is an
irreducible Pisot substitution, then (X, R) shows pure discrete spectrum if and only
if (SNu, S) does. Therefore we can use techniques developed in the tiling dynamical
system to our problem.
8.4.3
Algebraic Coincidence for Du
In this setting the algebraic coincidence in [14] reads
∃a ∃n ∈N ∃η′ ∈R
βn 
a∈A
(Λa −Λa) ∈Λa −η′
(8.2)

8
Yet Another Characterization of the Pisot Substitution Conjecture
413
and the projection ψ is bijective, (8.2) is equivalent to
∃a ∃n ∈N ∃η ∈Rd
Mn(∪a∈A(Du,a −Du,a)) ∈Du,a −η.
(8.3)
Clearly we see η ∈Du,a. By primitivity of s, we easily see that for any a, b ∈A,
there exists k ∈N that
βk(Λa −Λa) ⊂(Λb −Λb)
(8.4)
Yet we need another result depending heavily on irreducibility of substitution:
Lemma 8.4.1 ([4, 20]) Let s be a primitive irreducible substitution and Λ be an
associated substitution Delone multi-color set in R. Then we have
A
a∈A
(Λa −Λa)
B
=
A
(

a∈A
Λa) −(

a∈A
Λa)
B
.
(8.5)
Here ⟨X⟩stands for the additive subgroup of Rd generated by the set described in
X. Since
ψ−1
CA
(

a∈A
Λa) −(

a∈A
Λa)
BD
contains all fundamental unit vector ea (a ∈A), it clearly coincides with Zd.
Therefore Lemma 8.4.1 implies
A
a∈A
(Du,a −Du,a)
B
= Zd
(8.6)
8.4.4
Proof of the Existence of an Inner Point
Note that the substitution matrix M is contained in GL(d, Z), because s is a Pisot
unit substitution.
Without loss of generality, we assume that u begins with a ∈A, which implies
0 ∈Du.a. We will prove that there exists N ∈N that π(η) is an inner point of Du,a
where η ∈Du,a appeared in (8.3).
Let
ϕ : P(ZA) →
P(ZA)
S
→Mn(S −S)
D : P(ZA) →P(ZA)
S
→S −S ,

414
P. Mercat and S. Akiyama
where n ∈N is such that
∀b ∈A, Mn(Du,b −Du,b) ⊆Du,a −η.
Lemma 8.4.2 For all k ∈N≥1, we have
ϕk
C
b∈A
Du,b −Du,b
D
⊆Du,a −η.
Proof Easy, by induction.
Lemma 8.4.3 Let P ⊆ZA such that ψ(P) is relatively dense in R+ and π(P) is
bounded. Then, there exists R > 0 such that
QB(0,1) ⊆

x∈P
B(x, R),
where B(x, R) is the ball of ZA of center x and radius R.
Proof Let M > 0 such that ∀x ∈R+, d(x, ψ(P)) ≤M. There exists C1 > 0 and
C2 > 0 such that
∀(x, y) ∈(RA)2, d(x, y) ≤C1d(ψ(x), ψ(y)) + C2d(π(x), π(y))
depending on the choice of the left eigenvector for the map ψ, and the choice of
the linear projection π. We choose R = C1M + C2(diam(π(P ∪{0})) + 1). Let
x ∈QB(0,1), then we have ψ(x) ∈R+, and for y ∈P such that d(x, P) = d(x, y)
we have
d(x, y)
≤C1d(ψ(x), ψ(P)) + C2d(π(x), π(y))
≤C1M + C2(diam(π(P ∪{0})) + 1) ≤R.
Therefore, we have x ∈
y∈P B(y, R).
Lemma 8.4.4 There exists N ∈N such that
B(0, 1) ⊆DN
C
b∈A
Du,b −Du,b
D
,
where B(0, 1) is the unit ball of P.

8
Yet Another Characterization of the Pisot Substitution Conjecture
415
Proof The set ψ(Du,a) is relatively dense in R+ and π(Du,a) is bounded. So, by
Lemma 8.4.3, there exists a R > 0 such that
QB(0,1) ⊆

x∈Du,a
B(x, R).
And we have, by (8.6),

N∈N
DN
C
b∈A
Du,b −Du,b
D
=
A
b∈A
(Du,b −Du,b)
B
= ZA.
Thus there exists N ∈N≥3 large enough such that
B(0, R) ⊆DN−1
C
b∈A
Du,b −Du,b
D
,
where B(0, R) is the ball of ZA of center 0 and radius R. Then, we have
QB(0,1) ⊆

x∈Du,a
B(x, R) ⊆B(0, R) −D2(Du,a) ⊆DN
C
b∈A
Du,b −Du,b
D
. ⊓⊔
Using these lemmas, we have the inclusion
MnNQB(0,1)
⊆MnNDN 
b∈A Du,b −Du,b
	
= ϕN 
b∈A Du,b −Du,b
	 ⊆Du,a −η.
And this implies that Du,a contains MnNQB(0,1) + η, therefore it has non-empty
interior.
8.5
Computation of the Interior
In this section, we show that the interior of some subsets of Zd, for the topology
deﬁned in the Sect. 8.3.2, can be described by a computable regular language. This
gives a way to decide the Pisot substitution conjecture for any given irreducible
Pisot unit substitution.

416
P. Mercat and S. Akiyama
8.5.1
Regular Languages
Let Σ be a ﬁnite set, and let Σ∗= 
n∈N Σn be the set of ﬁnite words over the
alphabet Σ. A subset of P(Σ∗), is called a language over the alphabet Σ. We say
that a language L over an alphabet Σ is regular if the set

u−1L u ∈Σ∗
is ﬁnite, where u−1L := 
v ∈Σ∗uv ∈L
.
An automaton is a quintuplet A = (Σ, Q, I, F, T ), where Σ is a ﬁnite set called
alphabet, Q is a ﬁnite set called states, I ⊆Q is the set of initial states, F ⊆Q is
the set of ﬁnal states, and T ⊆Q × Σ × Q is the set of transitions. We denote by
p
t−→q a transition (p, t, q) ∈T , and we will write
q0
t1−→q1
t2−→. . .
tn−→qn ∈T
when for all i = 1, 2, . . . , n we have (qi−1, ti, qi) ∈T . We call language recognized
by A the language LA over the alphabet Σ deﬁned by
LA = {u ∈Σ∗|
∃(qi)i ∈Q|u|+1, q0 ∈I, q|u| ∈F,
and q0
u1
−→q1
u2
−→. . .
u|u|
−−→q|u| ∈T }.
The following proposition is a classical result about regular languages
(see [5, 9, 11, 19]).
Proposition 8.5.1 A language is regular if and only if it is the language recognized
by some automaton.
We say that an automaton is deterministic if I has cardinality one, and if for every
state q ∈Q and every letter t ∈Σ, there exists at most one state q′ ∈Q such that
(q, t, q′) ∈T is a transition.
The minimal automaton of a regular language L, is a deterministic automa-
ton recognizing L and having the minimal number of states. Such automaton
exists, is unique, and the number of states is equal to the cardinal of the set

u−1L u ∈Σ∗
\{∅}. To an automaton, we can associate the adjacency matrix in
MQ(Z) whose (s′, s) coefﬁcient is the number of transitions from state s to state s′.
We denote by tL the mirror of a language L.
tL :=

unun−1 . . . u1u0 u0u1 . . . un−1un ∈L

.

8
Yet Another Characterization of the Pisot Substitution Conjecture
417
8.5.2
Discrete Line Associated to a Regular Language
Given a word u over an alphabet Σ ⊆Zd, and a matrix M ∈Md(Z), we deﬁne
Qu,M =
|u|−1

k=0
Miui.
Given a language L over an alphabet Σ ⊆Zd, and a matrix M ∈Md(Z), we deﬁne
the following subset of Zd.
QL,M = 
Qu,M u ∈L
 =
|u|−1
k=0 Miui u ∈L

.
We will also call this set a discrete line, because when M has a Pisot number as
eigenvalue and no other eigenvalue of modulus greater than one, then this set stays
at bounded distance of a line of Rd—line which is the eigenspace of the matrix M
for the Pisot eigenvalue. And we show now that every discrete line coming from a
substitution is also the discrete line of some regular language. When it will be clear
from the context what is the matrix, we will simply write Qu and QL.
Remark 8.5.2 The notation QS was also deﬁned for a part S ⊆P, but there is no
ambiguity, because parts of P and languages are always different objects, and we
use the same notation because in both cases it represents a discrete line.
To a substitution s over the alphabet A, and a, b ∈A, we associated the following
deterministic automaton As
a,b with
•
set of states A,
•
initial state a,
•
set of ﬁnal states {b},
•
alphabet Σ = {t ∈Zd|∃(c, u, v) ∈A × A∗× A∗, s(c) = uv with Ab(u) =
t and |v| > 0},
•
set of transitions T
= {(c, t, d) ∈A × Σ × A|∃u, v
∈A∗, s(c) =
udv and Ab(u) = t}.
We denote by Ls
a,b the language of this automaton. We denotes by As the automaton
As
a,b where we forget the data of the initial state and the set of ﬁnal states.
Remark 8.5.3 This automaton is the abelianisation of what we usually call the
preﬁx automaton.
Remark 8.5.4 For a substitution s and two letters a and b, the language Ls
a,b has
little to do with what we usually call the language of the substitution s (i.e. the set
of ﬁnite factors of periodic points of s). The alphabet of Ls
a,b is not even the same
as the alphabet of the substitution s.

418
P. Mercat and S. Akiyama
Proposition 8.5.5 If u is a ﬁxed point of a substitution s whose ﬁrst letter is a, then
we have for every letter b,
Du,b = QtLs
a,b,Ms.
Remark 8.5.6 This proposition corresponds to write elements of the discrete line
Du,b using the Dumont-Thomas numeration.
Remark 8.5.7 If we want to describe the left inﬁnite part of the discrete line
associated to a bi-inﬁnite ﬁxed point of the substitution s, we have to consider the
automata A
ts
a,b where ts is the reverse substitution of s—that is ∀a ∈A, ts(a) =
t(s(a)). We can also describe a bi-inﬁnite discrete line with only one automaton over
the bigger alphabet Σs ∪−Σ ts.
Remark 8.5.8 The automaton As permits to compute easily the map E1(s) deﬁned
in [2]:
E1(s)(x, ea) =

a
t−→b∈T
(Mx + t, eb),
where T is the set of transitions of As.
We can also compute easily the map E∗
1(s) when det(M) ∈{−1, 1}:
E∗
1(s)(x, e∗
b) =

a
t−→b∈T
(M−1(x −t), e∗
a).
And we have
(y, eb) ∈E1(s)(x, ea) ⇐⇒a
y−Mx
−−−−→b ∈T ⇐⇒(x, e∗
a) ∈E∗
1(s)(y, e∗
b).
Proof of the Proposition 8.5.5 The ﬁrst idea is to describe the set of preﬁxes of
sn(a) followed by a letter b, by words of length n in the regular language tLs
a,b, like
in the Fig. 8.3 but with a different alphabet.
Lemma 8.5.9 For every n ∈N, there exists a natural map
ϕn :

b∈A

v ∈A∗vb preﬁx of sn(a)
 →

b∈A

w ∈Ls
a,b |w| = n

such that
∀b ∈A, ϕn

v ∈A∗vb preﬁx of sn(a)
	 =

w ∈Ls
a,b |w| = n

.

8
Yet Another Characterization of the Pisot Substitution Conjecture
419
Fig. 8.3 Different ways of describing the same thing. Equivalence between the choice of a preﬁx
of sn(a) followed by a letter b, a path of length n in a tree to a letter b, a path of length n in the preﬁx
automaton with initial state a and ﬁnal state b, for the substitution s : a →ab, b →ac, c →a.
For example, the preﬁx abaca of s3(a) corresponds to the word 101, and the preﬁx a corresponds
to the word 001
Proof By induction on n. For n = 0, the map ϕ is uniquely deﬁned. If n ≥1,
for v ∈A∗such that vb is a preﬁx of sn(a), there exists a unique uplet of words
(v′, v′′, v′′′) ∈(A∗)3, and an unique letter c ∈A such that s(v′c) = vbv′′′, where
s(c) = v′′bv′′′. We deﬁne ϕn(v) = ϕn−1(v′) Ab(v′′). This is a word of length n
in the regular language Ls
a,b, because by induction we have ϕn−1(v′) ∈Ls
a,c, with
ϕn−1(v′) of length n −1, and the equality s(c) = v′′bv′′′ implies that there exists a
transition for state c to state b labeled by Ab(v′′) in the automaton As.
We check that the formulae linking the abelianisation of the preﬁx and the
corresponding word in tLs
a,b is the one expected.
Lemma 8.5.10 For every v ∈A∗such that vb is a preﬁx of sn(a), we have
Ab(v) = Q tϕn(v),
where ϕn is the map deﬁned by Lemma 8.5.9 above.
Proof For every such word v, the map ϕn gives a unique sequence (vk, ck, wk) in
A∗× A × A∗such that we have ∀0 ≤k ≤n −1, s(ck) = vk+1ck+1wk+1, with
c0 = a, v0 = w0 = ϵ, and cn = b. And, we have
sn(a) = vbw = sn−1(v1)sn−2(v2) . . .s(vn−1)vncnwns(wn) . . . sn−2(w2)sn−1(w1).

420
P. Mercat and S. Akiyama
Therefore we have
Ab(v) = Ab

sn−1(v1)sn−2(v2) . . . s(vn−1)vn

= Mn−1 Ab(v1) + Mn−2 Ab(v2) + . . . + M Ab(vn−1) + Ab(vn)
= QAb(vn) Ab(vn−1)... Ab(v2) Ab(v1)
= Q tϕn(v).
With these two lemmas, we get
Du,b = 
Ab(v) vb preﬁx of u

=

n∈N

Ab(v) vb preﬁx of sn(a)

=

n∈N

Q tw w ∈Ls
a,b, |w| = n

= QtLs
a,b.
This ends the proof of the Proposition 8.5.5.
8.5.3
Computation of the Interior
We have seen in the previous section that the subshift associated to an irreducible
Pisot substitution has pure discrete spectrum as soon as the interior of a piece of
the discrete line is non-empty (see Theorem 8.3.3), for the topology deﬁned in
Sect. 8.3.2. In this section, we give a way to compute the interior (and hence to
test the Pisot substitution conjecture) with the following
Theorem 8.5.11 Let L be a regular language over an alphabet Σ ⊆ZA, M be
an irreducible Pisot unimodular matrix, and π be the projection on a hyperplane P
along the eigenspace of M for its maximal eigenvalue β. Then, there exists a regular
language
◦
L ⊆L such that Q ◦
L =
◦
QL. Moreover, this language
◦
L is computable
from L.
Remark 8.5.12 The language
◦
L doesn’t depend on the choice of the hyperplane P.
With this theorem, the criterion given by the Theorem 8.3.3 gives the following
result:
Corollary 8.5.13 Let s be an irreducible Pisot unit substitution over an alphabet
A. If there exist letters a, b ∈A such that a is the ﬁrst letter of a ﬁxed point of s,

8
Yet Another Characterization of the Pisot Substitution Conjecture
421
and the regular language t ◦
Lsa,b is non-empty, then the subshift (SNu, S) has pure
discrete spectrum.
And, the Pisot substitution conjecture is equivalent to
Conjecture 8.5.14 For any irreducible Pisot unit substitution s over an alphabet A
and for any letters a, b ∈A, the regular language t ◦
Lsa,b is non-empty.
8.5.4
Proof of the Theorem 8.5.11
In order to compute the interior, we need a big enough alphabet.
Lemma 8.5.15 For any Pisot unit primitive matrix M ∈Md(N), there exists Σ′ ⊆
ZA such that 0 ∈
◦
QΣ′∗,M.
Proof Let’s consider any substitution s whose incidence matrix is the irreducible
unit Pisot matrix M. Let u be a periodic point for this substitution. We know that
π(Du) is bounded and is a fundamental domain for the action of the lattice π(Γ0) on
π(ZA), where Γ0 is the subgroup of ZA spanned by ea −eb, a, b ∈A. Hence, there
exists a ﬁnite subset S ⊆Γ0 such that Du +S = 
x + y (x, y) ∈Du × S
 contains
zero in its interior. Then, the alphabet Σ′ = Σs +S satisfy that 0 ∈
◦
QΣ′Σ∗s ⊆
◦
QΣ′∗.
The alphabet given by this lemma is not optimal. Here are two conjectures that
gives natural choices of alphabet. The ﬁrst one gives an alphabet of minimal size,
and the second one gives the alphabet Σ that naturally comes from the substitution.
Conjecture 8.5.16 For all irreducible unit Pisot matrix M with spectral radius β,
we have 0 ∈
◦
QΣ′∗, for Σ′ = {−1, 0, 1, 2, . . ., ⌈β⌉−2}.
Conjecture 8.5.17 For all irreducible unit Pisot substitution s, we have
◦
QΣs ∗̸= ∅.
Remark 8.5.18 This last conjecture is a consequence of the Pisot substitution
conjecture. But it should be easier to solve.
Remark 8.5.19 We cannot assume in this last conjectures that the interior always
contains 0, since we can only get the positive part of the hyperplane P with Pisot
numbers whose conjugates are positive reals numbers. Nevertheless, if we have only
◦
QΣ′∗̸= ∅, then the set Lint computed in the proof of the Theorem 8.5.11 satisfy
◦
QL ⊆QLint ⊆
◦
QL,
so we have
◦
QL = ∅⇐⇒Lint = ∅. Hence we can decide if QL has empty interior
or not by computing Lint with this alphabet Σ′.

422
P. Mercat and S. Akiyama
The following theorem is also useful to compute the interior. It is a variant of the
main theorem of [16].
Theorem 8.5.20 Consider two alphabets Σ and Σ′ in ZA, and a matrix M ∈
MA(Z) without eigenvalue of modulus one. Then the language
Lrel := 
(u, v) ∈(Σ′ × Σ)∗Qu = Qv

is regular.
Remark 8.5.21 This language Lrel is related to what is usually called the zero
automaton. See [7] and [8] for more details.
Proof of the Theorem 8.5.11 Consider the language
Lint := Z(S(Z(p1(Σ′∗× L0∗∩Lrel)))),
where
•
Σ′ is an alphabet given by the Lemma 8.5.15 and containing 0,
•
p1 : (Σ′ × Σ)∗→Σ′∗is the word morphism such that ∀(x, y) ∈Σ′ ×
Σ, p1((x, y)) = x,
•
Lrel is the language deﬁned in Theorem 8.5.20,
•
for any language L over the alphabet Σ′, S(L) :=

u ∈Σ′∗uΣ′∗⊆L

,
•
for any language L ⊆Σ′∗, Z(L) := 
u ∈Σ′∗∃n ∈N, u0n ∈L
.
Then, we have
QLint =
◦
QL,
and we have that the language Lint is “complete”, that is:
Lint =

u ∈Σ′∗Qu ∈QLint

.
Indeed, for all u ∈Σ′∗we have
u ∈Lint ⇐⇒∃n ∈N, u0n ∈S(Z(p1(Σ′∗× L0∗∩Lrel))),
⇐⇒∃n ∈N, u0nΣ′∗⊆Z(p1(Σ′∗× L0∗∩Lrel)),
⇐⇒∃n ∈N, ∀v ∈Σ′∗, ∃k ∈N, u0nv0k ∈p1(Σ′∗× L0∗∩Lrel),
⇐⇒∃n ∈N, ∀v ∈Σ′∗, ∃k ∈N, ∃w ∈L0∗, (u0nv0k, w) ∈Lrel,
⇐⇒∃n ∈N, ∀v ∈Σ′∗, Qu0nv ∈QL,
⇐⇒∃n ∈N, Qu + Mn+|u|QΣ′∗⊆QL,
⇐⇒Qu ∈
◦
QL.

8
Yet Another Characterization of the Pisot Substitution Conjecture
423
This last equivalence is true, if we assume that the alphabet Σ′ is positive (which
is not always possible). This problem disappears if we consider the bi-inﬁnite
topology, where open subsets of ZA are π−1(U) for U open subset of P. Or one
could replace Σ′∗by Σ′Σ∗
s , and it computes the interior up to a ﬁnite number of
points.
And we can assume that Σ ⊆Σ′ up to replace Σ′ by Σ ∪Σ′. Then, we get the
language
◦
L by taking the intersection with L:
◦
L = L ∩Lint.
This language verify what we want because QLint ⊆QL and because Lint is
complete.
Remark 8.5.22 If we just want to test the non-emptiness of the language
◦
L, it is not
necessary to compute all what is done in this proof. For example, the computation
of the language Lint is enough (and we do not need that Σ ⊆Σ′). And we don’t
even need to compute completely Lint if we only want to test if it is non-empty. And
it is enough to have Σ′ such that QΣ′∗has non-empty interior.
8.5.5
Examples
Example 8.5.23 For the Fibonacci and for the Tribonacci substitutions, we get
t ◦
Lsa,b = tLs
a,b, for a the ﬁrst letter of the ﬁxed point u, and any letter b. Therefore
the sets Du,b are open:
◦
Du,b = Du,b (and we can check that they are also closed).
Example 8.5.24 For the “ﬂipped” Tribonacci substitution:
a →ab
b →ca
c →a
the minimal automaton of the language
◦
tLs
a,a has 79 states (80 states for
◦
tLs
a,b, 81
for
◦
tLs
a,c). This automaton is plotted in Fig. 8.4, and the sets π(Du,a) and π(
◦
Du,a)
for the ﬁxed point u are drawn in Fig. 8.5.

424
P. Mercat and S. Akiyama
Fig. 8.4 Minimal automaton of the language
◦
tLs
a,a of the Example 8.5.24. The labels 0 correspond
to the null vector, the labels 1 correspond to the vector ea, and the labels b2 −b −1 correspond to
the vector ec. Final states are the double circles, and the initial state is the bold circle
Fig. 8.5 The sets π(Du,a) (in gray and blue) and π(
◦
Du,a) (in blue) for the Example 8.5.24
Example 8.5.25 For the following substitution associated to the smallest Pisot
number:
a →b
b →c
c →ab
the minimal automaton of the language
◦
tLs
a,a has 1578 states (1576 states for
◦
tLs
a,b,
1577 for
◦
tLs
a,c). The sets π(Du,a) and π(
◦
Du,a) are plotted on Fig. 8.6, where u is
the periodic point starting by letter a.
Remark 8.5.26 The ﬁrst author have implemented the computing of the interior in
the Sage mathematical software. The above examples has been computed using this
implementation which is partially available here: https://pypi.org/project/badic or
https://gitlab.com/mercatp/badic.

8
Yet Another Characterization of the Pisot Substitution Conjecture
425
Fig. 8.6 The sets π(Du,a) (in gray and blue) and π(
◦
Du,a) (in blue) for the Example 8.5.25. Whole
set at the left, and a zoom on it at the right
Remark 8.5.27 To prove the Pisot substitution conjecture, it is enough for each
irreducible Pisot substitution s and for any letter a, to ﬁnd one particular “canonical”
word in the language
◦
tLs
a,a in order to prove it is non-empty.
8.6
Pure Discreteness for Various Inﬁnite Family
of Substitutions
8.6.1
Proof of Pure Discreteness Using a Geometrical
Argument
Using the Theorem 8.3.3, we can prove the Pisot substitution conjecture for a new
inﬁnite family of substitutions:
Theorem 8.6.1 Let k ∈N, and let
sk :
⎧
⎨
⎩
a →akbc
b →c
c →a
where ak means that the letter a is repeated k times. The subshift generated by the
substitution sk is measurably conjugate to a translation on the torus T2 (Fig. 8.7).

426
P. Mercat and S. Akiyama
Fig. 8.7 Rauzy fractal of s20
Proof The strategy of the proof is to use the Theorem 8.3.3. We identify P with the
complex plane C. For k ≥1, let u be the ﬁxed point of sk starting with letter a. We
show that π(
◦
Du,a) ̸= ∅by showing that the point
tk := k
2 −
√
k
2 I
is not in the closure of π(ZA\Da):
tk ̸∈

l∈A\{a}
π(Du,l) ∪

t∈Γ0\{0}
π(Du + t),
where A = {a, b, c} is the alphabet of the substitution sk, Γ0 is the group generated
by (ei −ej)i,j∈A, where (ei)i∈A is the canonical basis of RA, I denotes a complex
number such that I 2 = −1, and π is the projection along the eigenspace for the
maximal eigenvalue of the incidence matrix
M =
⎛
⎝
k 0 1
1 0 0
1 1 0
⎞
⎠
of the substitution sk, such that π(ea) = 1, π(eb) = −β2 + (k + 1)β −(k −1) and
π(ec) = β2−kβ −1, where β is the complex eigenvalue of M such that Im(β) < 0.
In order to do that, we approximate the sets Du,l by union of balls (Fig. 8.8):
Lemma 8.6.2 For all k ≥3 and for every l ∈A, we have the inclusion
π(Du,l) ⊆

t∈Sl
B(t,
1
1 −
1
√
k
),
Fig. 8.8 Strategy to prove
that tk ̸∈π(Zd\Du,a).
Approximation of the sets
π(Du,l) and their translated
copies, by disks, for k = 20

8
Yet Another Characterization of the Pisot Substitution Conjecture
427
where
Sa = {γβ} ∪

i + βj (i, j) ∈{0, 1, . . ., k −1}2
,
Sb =

k + βi i ∈{0, 1, . . . , k −1}

,
Sc = {kβ} ∪
γ + βi i ∈{0, 1, . . ., k −1}
 ,
where γ = −β2 + (k + 1)β + 1 = β −1
β .
Proof For every l ∈A, we have the equality
π(Du,l) =
|u|−1
k=0 uiβi u ∈tLl

where Ll is the language of the automaton of Fig. 8.9 where we replace the set of
ﬁnal states by {l}.
We get the proof of the lemma by considering words of length two, and by the
inequality

|u|−1

k=2
uiβi

≤
|u|−1

k=2
max

|t| t ∈Σ
 |β|i ≤
1
1 −
1
√
k
for any word u over the alphabet Σ, where Σ = {0, 1, . . . , k −1, k, γ } is the
alphabet of the languages Ll. Indeed, we have max

|t| t ∈Σ

= k and |β| ≤
1
√
k
for k ≥3.
Lemma 8.6.3 For every k ≥1, we have the inequalities
1
E
k + 2
k
< |β| <
1
√
k
√
k −1
√
k
< |γ | <
F
k + 2
k + 1
√
k
Fig. 8.9 Automaton
describing π(Du)
a
start
b
c
0, 1, ..., k
1
k
γ
0
0

428
P. Mercat and S. Akiyama
−1
k < Re(β) < −
1
k + 2
k
−1
√
k
< Im(β) < −
1
E
k + 2
k
+ 1
k
where Re(β) is the real part of β, and Im(β) is the imaginary part.
Proof Let β+ be the real conjugate of β. We have β+ = k +
1
β+ +
1
β2
+ > 0, so
k ≤β+ ≤k + 2
k .
And we have |β|2 =
1
β+ , hence we get the wanted inequalities for |β|. The
inequalities for γ = β −1
β follow. To get the real part, remarks that we have
k = β+ + β + β = β+ + 2 Re(β), and this gives Re(β) = −1
2β+ −
1
2β2
+ . The
inequalities for the imaginary part follow.
Lemma 8.6.4 For all k ≥14, we have tk ̸∈π(Du,b)
Proof For all i ∈{0, 1, . . ., k −1}, we have |k + iβ −tk| =
 k
2 + iβ +
√
k
2 I
 ≥
k
2 −|iβ| −
√
k
2 ≥k
2 −3
√
k
2 . This is greater than
1
1−1
√
k
for k ≥14.
Lemma 8.6.5 For all k ≥31, we have tk ̸∈π(Du,c)
Proof We have |γ + iβ −tk| =
−k
2 + γ + iβ +
√
k
2 I
 ≥k
2 −|iβ| −|γ | −
√
k
2 ≥
k
2 −3
√
k
2
−
E
k + 2
k −
1
√
k. This is greater than
1
1−1
√
k
for k ≥31.
We have |kβ −tk| ≥k
2 −3
√
k
2 . This is greater than
1
1−1
√
k
for k ≥14.
Let us show now that the point tk is not in the translated copies of π(Du) by the
group π(Γ0). The group π(Γ0) is
π(Γ0) =

c(β −k −2) + d(β2 −kβ −2) (c, d) ∈Z2
.
Let tc,d := c(β −k −2) + d(β2 −kβ −2).
Lemma 8.6.6 For all k ≥8 and for all (c, d) ∈Z2 such that |c| ≥1 and 2 |c| ≥
|d|, we have
tc,d
 ≥k −3
√
k.

8
Yet Another Characterization of the Pisot Substitution Conjecture
429
Proof We have
tc,d
 ≥|c| (k + 2) −|c|
√
k
−|d| (1
k +
√
k + 2) ≥|c| (k −1
√
k
−2
k −2
√
k −2).
This is greater than k −3
√
k for k ≥8.
Lemma 8.6.7 For all k ≥9 and for all (c, d) ∈Z2 such that |c| ≤|d| and 2 ≤|d|,
we have
Im(tc,d)
 ≥2
√
k −3.
And if moreover |d| ≥3, then we have
Im(tc,d)
 ≥3
√
k −5.
Proof We have
Im(β2 −kβ −2)
 ≥k |Im(β)| −|β|2 ≥
k
E
k+ 2
k
−1 −1
k. And we
have |Im(β −k −2)| = |Im(β)| ≤
1
√
k. Hence,
Im(tc,d)
 ≥|d|
⎛
⎝
k
E
k + 2
k
−1 −1
k
⎞
⎠−|c|
√
k
≥2
⎛
⎝
k
E
k + 2
k
−1 −1
k −1
√
k
⎞
⎠.
This is greater than 2
√
k −3 for k ≥9. If moreover |d| ≥3, then we have
Im(tc,d)
 ≥3
⎛
⎝
k
E
k + 2
k
−1 −1
k −1
√
k
⎞
⎠,
and this is greater than 3
√
k −5 for k ≥6 (Fig. 8.10).
Fig. 8.10 Zone covered by
the Lemma 8.6.6 (in green),
and by the Lemma 8.6.7 (in
blue), and remaining points
(the red points are remaining
only for l = c)
c
d

430
P. Mercat and S. Akiyama
Lemma 8.6.8 For all k ≥8, l ∈A and t ∈Sl, we have
|t −tk| ≤k
2 + 2
√
k
and
|Im(t −tk)| ≤
 3
2
√
k
if t ̸∈
γ + βi i ∈{0, 1, . . ., k −1}

2
√
k
otherwise.
Proof For every (i, j) ∈{0, 1, . . . , k −1}2, we have |i + βj −tk| ≤k
2 + 3
2
√
k,
|k + βi −tk| ≤k
2 + 3
2
√
k, |γ + βi −tk| ≤
E
k + 2
k +
1
√
k + 1 + k
2 +
√
k
2 (because
the imaginary part of β is negative), |kβ −tk| ≤
k
2 + 3
2
√
k and |γβ −tk| =
β2 −1 −k
2 +
√
k
2 I
 ≤
1
k + 1 + k
2 +
√
k
2 . Hence, the ﬁrst inequality is true for
k ≥8.
We have |Im(i + βj −tk)| = |Im(k + βj −tk)| =
j Im(β) −
√
k
2
 ≤
3
2
√
k,
|Im(γ + βi −tk)|
≤
Im(γ ) +
√
k
2
 + i |β|
≤
E
k + 2
k +
1
√
k −
√
k
2
+
√
k,
|Im(kβ −tk)| ≤k |β| +
√
k
2 ≤3
2
√
k, |Im(γβ −tk)| ≤|γβ| +
√
k
2
≤
√
k
2 + 1 + 1
k .
Hence, we get the wanted inequality for k ≥3.
Lemma 8.6.9 For all k ≥69, we have tk ̸∈(π(Du) + t0,1) ∪(π(Du) + t0,−1), and
we have tk ̸∈
d∈{−2,−1,0,1,2}(π(Du,c) + t0,d).
Proof For all (i, j) ∈{0, 1, . . ., k}, we have
i + βj + t0,±1 −tk
 ≥
Im(βj + t0,±1 −tk)

=
Im(β)(j ∓k) ± Im(β2) +
√
k
2
 .
If ± = +, we have
i + βj + t0,1 −tk
 ≥
√
k
2 −1
k because Im(β) < 0. This is
greater than
1
1−1
√
k
for k ≥10.
If ± = −, we have
i + βj + t0,−1 −tk
 ≥
k
E
k+ 2
k
−
√
k
2 −1 −1
k . This is greater
than
1
1−1
√
k
for k ≥22.
For |d| ≤1, we have
γβ + t0,±1 −tk
 ≥k
2 −
√
k
2 −
β2 −1
 −(1
k +
√
k + 2) ≥k
2 −3
√
k
2 −3 −2
k .
This is greater than
1
1−1
√
k
for k ≥24.

8
Yet Another Characterization of the Pisot Substitution Conjecture
431
For all i ∈{0, 1, . . ., k −1}, and |d| ≤2, we have
γ + βi + t0,d −tk
 ≥k
2 −
F
k + 2
k −1
√
k
−
√
k −
t0,d
 −
√
k
2
≥k
2 −1
√
k
−3
2
√
k −|d| 1
k −|d|
√
k −2 |d|
= k
2 −1
√
k
−7
2
√
k −2
k −4.
This is greater than
1
1 −
1
√
k
for k ≥69.
For |d| ≤2, we have
kβ + t0,d −tk
 ≥
k
2 −3
2
√
k −|d| ( 1
k +
√
k + 2) ≥
k
2 −7
2
√
k −2
k −4. This is greater than
1
1 −
1
√
k
for k ≥69.
Using the Lemmas 8.6.6 and 8.6.7, we have that for all the cases not covered by
the Lemma 8.6.9
tc,d
 ≥k −3
√
k
or
Im(tc,d)
 ≥3
√
k −5
or
Im(tc,d)
 ≥2
√
k −3.
Hence, for all l ∈A and all t ∈Sl, we have
t + tc,d −tk
 ≥k −3
√
k −
√
k
2 −
t −k
2
 ≥k
2 −9
2
√
k −
F
k + 2
k −1
k
or
t + tc,d −tk
 ≥3
√
k −5 −
√
k
2 −|Im(t)| ≥3
2
√
k −5 −
F
k + 2
k −1
k
or
t + tc,d −tk
 ≥2
√
k −3 −
√
k
2 −|Im(t)| ≥1
2
√
k −3,
if t ̸∈
γ + iβ i ∈{0, 1, . . ., k −1}
.
This is greater than
1
1 −
1
√
k
for k ≥126 in the ﬁrst case, for k ≥149 in the
second case and for k ≥69 in the third case.
Consequently, we have proven that for every k ≥149, we have π(
◦
Du,a) ̸= ∅
because tk is not in the closure of π(ZA\Du,a). By the Theorem 8.3.3, we obtain
the conclusion.
For 0 ≤k < 149, we can check by computer, using what is done in the Sect. 8.5,
that the interior of Du,a is non-empty, by computing explicitly a regular language
describing this interior and checking that this language is non-empty.

432
P. Mercat and S. Akiyama
Fig. 8.11 π(Du,a\
◦
Du,a) for s20
When we compute the interior of Du,a for these substitutions sk, it appears that
we get automata of the same shape for k large enough.
Conjecture 8.6.10 For all k ≥4, the minimal automaton of the regular language
◦
L :=

u ∈tLska,a Qu ∈
◦
Du,a

has 45 states (Fig. 8.11).
8.6.2
Proof of Pure Discreteness Using Automata
In this subsection, we prove the pure discreteness using completely different
technics but still as a corollary of Theorem 8.3.3, for an another inﬁnite family
of substitutions:
sl,k :
⎧
⎨
⎩
a →albak−l
b →c
c →a
∀0 ≤l ≤k,
using the pure discreteness for the substitution
sk :
⎧
⎨
⎩
a →akb
b →c
c →a
∀k ∈N≥1.
This last substitution is a β-substitution, and the associated symbolic system is pure
discrete after [4] (but a similar argument as the one of the previous subsection can
also be used to prove the pure discreteness for this family). We use this fact to prove
the pure discreteness for the other family of substitutions.
The idea is to show that the part corresponding to letter a of the discrete line
associated to sl,k contains a homothetic copy of the one for sk. More precisely,
we prove that M2Du,a ⊆Dv,a, where M is the incidence matrix of sl,k (it doesn’t
depends on l and k), v is the inﬁnite ﬁxed point of sl,k and u is the inﬁnite ﬁxed point
of sk. Hence, we have
◦
Du,a ̸= ∅7⇒
◦
Dv,a ̸= ∅, and we can use the Theorem 8.3.3.

8
Yet Another Characterization of the Pisot Substitution Conjecture
433
Remark 8.6.11 The symbolic system associated to sl,k is conjugate to the one
associated to sk−l,k by word-reversal. Therefore, we can assume without loss of
generality that 1 ≤l ≤
G
k
2
H
.
8.6.2.1
Description of Du,a and Dv,a
In all the following, u is the inﬁnite ﬁxed point of sk, and v is the inﬁnite ﬁxed point
of sl,k, for integers l, k ∈N, with k ≥l ≥1. We consider the following map
ϕ :

ZA
→
Q(β)
(vl)l∈A →va + (β −k)vb + (β2 −βk)vc. ,
where A = {a, b, c}. This linear map is one-to-one and has the property that the
multiplication by the incidence matrix M in RA becomes a multiplication by β in
Q(β), because (1, β −k, β2 −βk) is a left eigenvector of M for the eigenvalue β.
For a language over an alphabet Σ ⊆Q(β), we denote
QL := ϕ(Qϕ−1(L)) =
|u|
i=0 uiβi u ∈L

.
Using the Proposition 8.5.5, we have ϕ(Du,a) = QLk and ϕ(Dv,a) = QLl,k where
Lk is deﬁned in Fig. 8.12 and Ll,k is the regular language deﬁned on Fig. 8.13, for
β root of the polynomial X3 −kX2 −1.
Fig. 8.12 Automaton deﬁning a language Lk such that ϕ(Du,a) = QLk, where a transition labeled
by e means that there are k −1 transitions labeled by 1, 2, . . . , k −1
Fig. 8.13 Automaton deﬁning a language Ll,k such that ϕ(Dv,a) = QLl,k, where a transition
labeled by f means that there are l −1 transitions labeled by 1, 2, . . . , l −1 and k −l transitions
labeled by β −k + l, β −k + l + 1, . . . , β −2, β −1

434
P. Mercat and S. Akiyama
8.6.2.2
Zero-Automaton
In order to show that M2Du,a ⊆Dv,a, we need a way to go from the language
Ll,k to the language Lk. The following proposition permits to do it by describing
algebraic relations between a word over the alphabet of Lk and a word over the
alphabet of Ll,k. It works for 1 ≤l ≤k −2, but by the Remark 8.6.11 we can
assume it without loss of generality as soon as k ≥4.
Proposition 8.6.12 Let L0 be the language deﬁned in Fig. 8.15. We have
L0 ⊆

u ∈(Σk −Σl,k)∗|u|
i=0 uiβi = 0

,
if 1 ≤l ≤k −2, where
•
Σk = {0, 1, . . . , k} is the alphabet of the language Lk,
•
Σl,k = {0, 1, . . . , l, β −k + l, β −k + l + 1, . . . , β −1} is the alphabet of the
language Ll,k, and
Proof Let L′
0 be the language of the automaton depicted in the Fig. 8.14. We verify
easily that L′
0 is the transposed (i.e. the word reversal) of the language L0. And we
easily check that the transitions of the automaton of Fig. 8.14, satisfy the following.
x
t−→y
7⇒
y = βx + t,
t ∈Σk −Σl,k.
Hence, if we have a word u0u1u2 . . . un ∈L′
0, it corresponds to a path from 0 to 0,
so we have
0
u0
−→u0
u1
−→βu0 + u1
u2
−→. . .
un−1
−−→
n−1

i=0
βn−1−iui
un
−→
n

i=0
βn−iui = 0.
⊓⊔
Fig. 8.14 Automaton recognizing the language L′
0

8
Yet Another Characterization of the Pisot Substitution Conjecture
435
Fig. 8.15 Automaton recognizing the language L0
8.6.2.3
Proof That M2Du,a ⊆Dv,a
We deﬁne a language L by the automaton A of Fig. 8.16.
Lemma 8.6.13 The transitions of the automaton A of Fig. 8.16 satisfy
X
b
−→Y
7⇒
Y ⊆

y ∈Q0 ∃x ∈X, ∃c ∈Σl,k, x
b−c
−−−→y ∈A0

where Q0 = {0, 1, 2, 3, 4, 5, 6} is the set of states of the automaton A0 of Fig. 8.15.
Proof We can check that using the following array: a star or a letter l means that
we have a ∈b −Σl,k for a given (a, b) ∈Σ0 × Σk (the converse is false, but we
don’t need it), where Σ0 = {0, 1, 2, 1 −β, 2 −β, k −β, k + 1 −β, k + 2 −β} is
the alphabet of A0.
Σ0
Σk 0 1 2 . . .l −1 l l + 1 l + 2 . . .k −1 k
0
∗∗
∗
l
1
∗
∗
∗
l
2
∗
∗
∗
1 −β
∗
2 −β
∗∗
k −β
∗
∗
∗
k + 1 −β
∗
∗
∗
k + 2 −β
∗
∗
⊓⊔

436
P. Mercat and S. Akiyama
Fig. 8.16 The automaton A, recognizing a language L. {0} is the initial state and every state is
ﬁnal
We remark that every state of the automaton A of Fig. 8.16 contains 0. Hence, if
we have a path {0}
b1
−→X1
b2
−→. . .
bn
−→Xn in this automaton, we have 0 ∈Xn, and
by the Lemma 8.6.13, we can ﬁnd (ci)n
i=1 ∈Σn
l,k such that we have the following
path in A0:
0
b1−c1
−−−→x1
b2−c2
−−−→. . .
bn−cn
−−−→0.
Then, by deﬁnition of the automaton A0, we have
Qb =
n

i=1
biβi =
n

i=1
ciβi = Qc.
And we have the following.
Lemma 8.6.14 The sequence (ci)n
i=1 ∈Σ∗
l,k can be chosen such that the word
c1c2 . . . cn is in Ll,k.
Proof The language Ll,k is the set of words over the alphabet Σ∗
l,k such that every
letter l is preceded by two letters 0. And we can check that in the proof of the
Lemma 8.6.13, the only place where we need to take ci = l is when we follow a
transition of A labeled by l or by l + 1. And this occurs only when we follow an
transition labeled by 0 or 1 in the automaton A0.

8
Yet Another Characterization of the Pisot Substitution Conjecture
437
The only transitions of A that needs to take ci = l are {0, 2, 5, 6}
l−→{0, 1, 3, 4},
{0, 2, 5, 6}
l+1
−−→{0, 1, 3, 4} and {0, 1, 3, 6}
l+1
−−→{0, 1, 3, 4}. But we can check that
when we reach the state {0, 2, 5, 6}, we have read at least two zeroes, so we can
assume that the 0 of the state {0, 2, 5, 6} has been reached by following the path
0
0−0
−−→0
0−0
−−→0
in A0. This allows us to consider the transitions 0
l−l
−−→0 and 0
(l+1)−l
−−−−→1 of A0 and
getting a word c1c2 . . . cn that stays in the language Ll,k. In the same way, we reach
the state {0, 1, 3, 6} after reading a 0 and then a 1, so we can assume that the 1 in
the state {0, 1, 3, 6} has been reached by following the path
0
0−0
−−→0
1−0
−−→1
in A0. This allows us to consider the transition 1
(l+1)−l
−−−−→4 of A0 and getting a
word c1c2 . . . cn that stays in the language Ll,k.
We deduce from this lemma and from the equality Qb = Qc that we have Qb ∈
QLs,k for every word b in the language L. Hence, we have the inclusion β2QLk =
Q02Lk ⊆QL ⊆QLs,k. So we have M2Du,a ⊆Dv,a.
By the Theorem 8.3.3, we have for every 1 ≤l ≤k −2,
sk satisfy the Pisot substitution conjecture
7⇒
◦
Du,a ̸= ∅
7⇒
◦
Dv,a ̸= ∅
(becauseM2Du,a ⊆Dv,a)
7⇒sl,k satisfy the Pisot substitution conjecture.
And it implies that sl,k satisfy the Pisot conjecture for every 0 ≤l ≤k, k ≥4, up to
take the mirror. For 1 ≤k < 4, there is a ﬁnite number of possibilities, and we can
check that it also works, for example by computing the interior of the discrete line.
8.7
Pure Discreteness for a S-adic System
Let
σ :
⎧
⎨
⎩
a →aab
b →
c
c →
a
and
τ :
⎧
⎨
⎩
a →aba
b →
c
c →
a

438
P. Mercat and S. Akiyama
be two substitutions over the alphabet A = {a, b, c} having the same incidence
matrix M =
⎛
⎝
2 0 1
1 0 0
0 1 0
⎞
⎠.
Given an inﬁnite word s0s1 . . . ∈SN, where S = {σ, τ}, we deﬁne a word
u ∈AN by
u = lim
n→∞s0s1 . . . sn(a).
Remark that s0s1 . . . sn(a) is a strict preﬁx of s0s1 . . . snsn+1(a), so the limit exists.
We have the following
Theorem 8.7.1 For every word s0s1 . . . ∈SN, the subshift (SNu, S) is measurably
isomorphic to a translation on a torus.
The idea of the proof is similar to the one of the previous subsection: we prove
that for every sequence s0s1 . . . ∈SN we have an inclusion of the form
t + MkDuσ ,a ⊆Du,a,
for some t ∈Z3 and k ∈N, where uσ is the inﬁnite ﬁxed point of the substitution
σ, and we use the Theorem 8.2.3.
8.7.1
Representation of Du,a by an Automaton
Like for ﬁxed points of substitutions, we can represent Du,a by a ﬁnite automaton.
For simplicity, we will consider rather ψ(Du,a) ⊆Q(β), where β is the highest
eigenvalue of M, and ψ : RA →R is the linear map such that ψ(ea) = 1, ψ(eb) =
β −2 and ψ(ec) = β2 −2β. This map is such that ψ(MX) = βψ(X) for every
X ∈R3.
Proposition 8.7.2 We have
ψ(Du,a) = n
i=0 uiβi n ∈N, (u0, s0)(u1, s1) . . . (un, sn) ∈L
 ,
ψ(Duσ ,a) =
n
i=0 uiβi n ∈N, (u0, σ)(u1, σ) . . . (un, σ) ∈L

,
where L is the regular language recognized by the automaton of Fig. 8.17.
Proof The proof is very similar to the proof of the Proposition 8.5.5. We start by
constructing a natural map between the preﬁxes of the word s0s1 . . . sn(a) ∈A∗
that are followed by a letter d, and the words v0v1 . . . vn ∈Σ∗of length n + 1 such
that (vn, sn)(vn−1, sn−1) . . . (v1, s1)(v0, s0) is in a regular language Ld coming from
preﬁx automata, where Σ = {0, 1, 2, β −1}.

8
Yet Another Characterization of the Pisot Substitution Conjecture
439
Fig. 8.17 Automaton A,
recognizing a language L
Fig. 8.18 Automaton A′
By combining preﬁx automata of the substitution σ and τ, we deﬁne the
automaton A′ of the Fig. 8.18. The following lemma give a direct deﬁnition of A′.
Lemma 8.7.3 The automaton A′ of the Fig.8.18 has set of states A, and has a
transition d
(x,t)
−−→e if and only if t ∈S = {σ, τ}, and there exists words v′, v′′ ∈A∗
such that t(d) = v′ev′′ with ψ(Ab(v′)) = x.
Proof Easy veriﬁcation.
Lemma 8.7.4 For every n ∈N, there exists a natural map
ϕs0s1...sn :

d∈A

v ∈A∗vd preﬁx of s0s1 . . . sn(a)

→

d∈A
p1(Ln+1
d
),
such that
∀d ∈A, ϕs0s1...sn

v ∈A∗vd preﬁx of s0s1 . . . sn(a)
	
= p1(Ln+1
d
)
where
p1(Ln+1
d
) =

wn . . . w1w0 ∈Σ∗(wn, sn)(wn−1, sn−1) . . . (w1, s1)(w0, s0) ∈Ld

,
where Ld is the regular language of the automaton A′ of the Fig. 8.18, with initial
state a and ﬁnal state d ∈A.
Proof By induction on the length of the word s0s1 . . . sn ∈S∗. The map ϕϵ is
uniquely deﬁned. Let s0s1 . . . sn ∈S∗be a word of length at least one, d ∈A,
and v ∈A∗such that vd is a preﬁx of s0s1 . . . sn(a). Then, there exists an unique

440
P. Mercat and S. Akiyama
uplet (v′, v′′, v′′′) ∈A∗and an unique letter e ∈A such that vdv′′′ = s0(v′e), and
hence we have s0(e) = v′′dv′′′. We deﬁne ϕs0s1...sn(v) := ϕs1s2...sn(v′)ψ(Ab(v′′)).
From the induction hypothesis, we deduce that (ϕs1s2...sn(v′), snsn−1 . . . s2s1) ∈Le,
and by the Lemma 8.7.3 there exists a transition from state e to state d labeled by
(ψ(Ab(v′′)), s0) in the automaton A′, so we get that
(ϕs0s1...sn(v), snsn−1 . . . s1s0) ∈Ld
(we identify Σ∗× S∗with (Σ × S)∗).
Lemma 8.7.5 For every word v ∈A∗and every letter d ∈A such that vd is a
preﬁx of s0s1 . . . sn(a), we have
ψ(Ab(v)) =
n

i=0
wiβi,
where wnwn−1 . . . w1w0 = ϕs0s1...sn(v).
Proof By
construction of ϕs0s1...sn(v), there exists a sequence of letters
d0d1 . . . dndn+1 ∈An+2 and two sequences of words v0v1 . . . vn and w0w1 . . . wn ∈
(A∗)n+1 such that ∀0 ≤k ≤n, sk(dk+1) = vkdkwk, with dn+1 = a and d0 = d.
Then, we have
s0s1 . . . sn(a) = (s0s1 . . . sn−1)(vn)(s0s1 . . . sn−2)(vn−1) . . . s0(v1)v0d0w0s0(w1) . . .
. . . (s0s1 . . . sn−2)(wn−1)(s0s1 . . . sn−1)(wn),
and
v = (s0s1 . . . sn−1)(vn)(s0s1 . . . sn−2)(vn−1) . . . s0(v1)v0.
Hence, we get
Ab(v) = (M0M1 . . . Mn−1) Ab(vn) + (M0M1 . . . Mn−2) Ab(vn−1) + . . . + Ab(v0),
where Mi = Msi is the matrix of the substitution si. But, here we have Mi = M for
all i ∈N, because Mσ = Mτ = M, so we get
ψ(Ab(v)) = βnwn + βn−1wn−1 + . . . + βw1 + w0,
where wi
= ψ(Ab(vi)). And we have ϕs0s1...sn(v) = wnwn−1 . . . w1w0 by
deﬁnition of ϕs0s1...sn.
Lemma 8.7.6 The language L is the mirror of the language La.

8
Yet Another Characterization of the Pisot Substitution Conjecture
441
Proof Easy veriﬁcation. We get the automaton A from the automaton A′ with
initial state a and ﬁnal state a, by reversing the transitions, and then using an usual
algorithm, called power set construction, to compute a deterministic automaton from
it. With this construction, the state 0 of A corresponds to {a}, the state 1 corresponds
to {a, b}, and the state 2 corresponds to {a, b, c}.
These lemma give a proof of the Proposition 8.7.2, because we have
ψ(Du,a) = ψ(Ab(

n∈N

v ∈A∗va preﬁx of s0s1 . . . sn(a)

))
=

n∈N
n
i=0 wiβi ∃v ∈Σ∗, w0w1 . . . wn = ϕs0s1...sn(v),
with va preﬁx of s0s1 . . . sn(a)

= n
i=0 wiβi (wn, sn)(wn−1, sn−1) . . . (w1, s1)(w0, s0) ∈La

=
n
i=0 wiβi (w0, s0)(w1, s1) . . .(wn−1, sn−1)(wn, sn) ∈L

.
And the second equality of the proposition is a particular case of the ﬁrst one, where
we take for all i ∈N, si = σ.
Now that we have a description of the discrete lines Du,a and Duσ ,a, we use it to
show that for every word s0s1 . . . ∈SN we have an inclusion of the form
MkDuσ ,a + t ⊆Du,a,
for some t ∈Z3.
8.7.2
Proof of the Inclusion
Let Σσ = {0, 1, 2} and Στ = {0, 1, β −1}. We deﬁne a regular language L∗over
the alphabet Σσ × S by
L∗= (Σσ × S)∗∩m(L0 × Lσ × L),
where
Lσ =

u0u1 . . . un ∈Σ∗
σ n ∈N, (u0, σ)(u1, σ) . . . (un, σ) ∈L

L0 =

u0u1 . . . un ∈Σ′∗n ∈N, n
i=0 uiβi = 0

Σ′ = Σσ −Στ = {−1, 0, 1, 2, 1 −β, 2 −β, 3 −β}

442
P. Mercat and S. Akiyama
and m is the word morphism deﬁned by
m :
Σ′ × Σσ × ΣL →
Σσ × S ∪{∗}
(t, x, (y, i))
→
 (x, i) if x −y = t
∗
otherwise
where ΣL = (Σσ ∪Στ) × S is the alphabet of the language L.
Lemma 8.7.7 We have
ψ(Du,a) ⊇
n
i=0 uiβi n ∈N, (u0, s0)(u1, s1) . . . (un, sn) ∈L∗

.
Proof For all n ∈N, we have
(x0, s0)(x1, s1) . . . (xn, sn) ∈L∗
7⇒∃(y0, s0)(y1, s1) . . . (yn, sn) ∈L,
n

i=0
(xi −yi)βi = 0
7⇒
n

i=0
xiβi ∈ψ(Du,a).
⊓⊔
Lemma 8.7.8 We have
L∗⊇Lu,
where Lu is the language deﬁned in Fig. 8.19.
Proof Computation done by computer. The language L0 is regular thanks to [16],
and its minimal automaton has 62 states. The minimal automaton of the language
L∗has 210 states.
We deduce from these two lemma that for every sequence s0s1 . . . ∈SN, we have
an inclusion of the form ψ(Du,a) ⊇t + βkψ(Duσ ,a), for some t ∈Z[β] and some
k ∈N. Thus we have
t′ + MkDuσ ,a ⊆Du,a
for some t′ ∈Z3.
For example, if s0 = σ, s1 = σ, s2 = τ and s3 = τ, then we have the inclusion
ea + Mea + M3ea + M4Duσ ,a ⊆Du,a.

8
Yet Another Characterization of the Pisot Substitution Conjecture
443
Fig. 8.19 Automaton recognizing a language Lu
8.7.3
Pure Discreteness of the Spectrum
In order to use the Theorem 8.2.3, we need the following property.
Lemma 8.7.9 The subshift (SNu, S) is minimal for every sequence s0s1 . . . ∈SN.
Proof In the word u, there are at most ﬁve letters between two consecutive letters
a. Indeed, u = s0s1(v) for an inﬁnite word v ∈AN, and we have that s0s1(a) is a
word of length 7 with four letters a, s0s1(b) = a and s0s1(c) is a word of length 3
with two letters a.
Thus, there exists a constant C such that every factor of u of length ≥Cβn
contains s0s1 . . . sn(a). Indeed, it sufﬁces to see that u = s0s1 . . . sn(w) with a word
w that satisﬁes the above property.
If a word is in SNu, then it contains arbitrarily large factors of u, so it contains
s0s1 . . . sn(a) for every n ∈N. Therefore this word is dense in SNu.
A projection π along the eigenspace for the eigenvalue β of M onto some plane
P is such that the restriction of π to Z3 is injective and has a dense image in P.
It is not difﬁcult to see that the set π(Du) is bounded, by using for example the
description of ψ(Du) given in the Proposition 8.7.2.
In order to prove the disjointness in measure of the translated copies of π(Du)
by π(Γ0), we use the same strategy than in the proof of the Theorem 8.3.3: we show
that the interior of Du,a is non-empty, and we show that the interior of Du is dense.

444
P. Mercat and S. Akiyama
It is known that we have
◦
Dus1,a ̸= ∅for the topology deﬁned on the Sect. 8.3.2 (we
can prove it by computing this interior explicitly thanks to the Theorem 8.5.11). And
the matrix M is in GL(3, Z), so if we have an inclusion of the form t +MkDus1,a ⊆
Du,a, t ∈Z3, k ∈N given by the previous subsection, then it implies that
◦
Du,a ̸= ∅,
and this is true for every sequence s0s1 . . . ∈SN. Then, we have the following result.
Lemma 8.7.10 ∀l ∈{a, b, c},
◦
Du,l is dense in Du,l.
Proof Let un = limk→∞snsn+1 . . . sn+k(a). We have just proven that for every
n ∈N, Dun,a has non-empty interior. And we have u = s0s1 . . . sn−1(un), so we get
the equality
ψ(Du,i) =

i
(t0,s0)
−−−→...
(tn−1,sn−1)
−−−−−−→j∈A
βnψ(Dun,j) +
n−1

k=0
tkβk
for all i, j ∈{a, b, c}. But the automaton A is such that we can reach any state
from any state, even if we impose the right coefﬁcients of labels read. Hence, we
can approach (for our topology) any point of Du,i by subsets of Du,i of the form
MkDuk,a + t, t ∈Z3, k ∈N. Such subsets have non-empty interior since M ∈
GL(3, Z). This ends the proof.
Lemma 8.7.11 The boundary of π(Du) has zero Lebesgue measure.
In order to prove this lemma, let introduce some notations. For all n ∈N, let
un = limk→∞snsn+1 . . . sn+k(a), and for all a ∈A, Rn
a = π(Dun,a). We have the
following
Lemma 8.7.12 For every a ∈A, the sequence (λ(Rn
a))n∈N is increasing and
bounded.
Proof By the Proposition 8.7.2, we have the following equality
ψ(Dun,a) =

b
(t,sn+1)
−−−−→a∈A
βψ(Dun+1,b) + t,
where A is the automaton of the Fig. 8.17. Without loss of generality, we can assume
that π = σ−◦ψ : ZA →C, where σ−is the Galois morphism
σ−: Q(β) →Q(γ )
β
→
γ
,

8
Yet Another Characterization of the Pisot Substitution Conjecture
445
where γ is a complex conjugate of β. Thus, we have the equality
Rn
a =

b
(t,sn+1)
−−−−→a∈A′′
γ Rn+1
b
+ t,
where A′′ is the automaton A where we apply the Galois morphism σ−.
Then, we have
λ(Rn
a) ≤

b
(t,sn+1)
−−−−→a∈A′′
1
β λ(Rn+1
b
).
If we take the vector Xn = (λ(Rn
a))a∈A ∈RA, the previous inequality becomes
Xn ≤1
β MXn+1.
But by the Perron-Frobenius theorem, we have the inequality MX ≤βX for every
X ∈RA
+, so we get that Xn is increasing. The coefﬁcient of Xn are also bounded by
maxt∈Σ′′ |t|
1 −|γ |
, where Σ′′ is the alphabet of the automaton A′′.
This lemma give the existence of the limit λ∞
a
= limn→∞λ(Rn
a). We have the
following lemma.
Lemma 8.7.13 There exists ϵ > 0 and η > 0 such that for every n ∈N and every
a ∈A, there exists t ∈C and r > 0 such that the ball B(t, r + ϵ) is included in Ra,
and such that λ(B(t, r)) ≥ηλ∞
a .
Proof It is an immediate consequence of the inclusions proven in the Sect. 8.7.2.
Lemma 8.7.14 There exists n0 ∈N such that for every n ≥n0 and every a ∈A,
we have λ(∂Rn
a) = 0.
Proof Let n0 ∈N such that
∀a ∈A, λ∞
a ≤(1 + η)λ(Rn0
a ),
and let k ∈N such that for every a ∈A, every (t, t′) ∈C2, every r > 0, and every
n ∈N,
γ kRn
a + t ∩B(t′, r) ̸= ∅7⇒γ kRn
a + t ⊆B(t′, r + ϵ).
Let us show that for every n ≥n0 we have
∀a ∈A, λ(∂Rn+k
a
) ≤cλ(Rn+k
a
) 7⇒∀a ∈A, λ(∂Rn
a) ≤c(1 −η2)λ(Rn
a).

446
P. Mercat and S. Akiyama
Let a ∈A and n ≥n0. Let t ∈C and r > 0 such that B(t, r + ϵ) ⊆Rn
a and
λ(B(t, r)) ≥ηλ∞
a . Let
Tb =
n+k−1
j=n
γ n+k−j−1tj b
(tn,sn)
−−−→. . .
(tn+k−1,sn+k−1)
−−−−−−−−−→a ∈A′

,
T ′
b =
⎧
⎨
⎩
n+k−1
j=n
γ n+k−j−1tj
b
(tn,sn)
−−−→. . .
(tn+k−1,sn+k−1)
−−−−−−−−−→a ∈A′
and (γ k∂Rn+k
b
+ t) ∩B(t, r) = ∅
⎫
⎬
⎭.
Then we have
λ(∂Rn
a) ≤λ
⎛
⎝
b∈A

t∈T ′
b
(γ k∂Rn+k
b
+ t)
⎞
⎠
≤

b∈A, t∈T ′
b
1
βk λ(∂Rn+k
b
)
≤c
βk

b∈A, t∈T ′
b
λ(Rn+k
b
)
≤c
βk
⎡
⎣
⎛
⎝

b∈A, t∈Tb
λ(Rn+k
b
)
⎞
⎠−βkλ(B(t, r))
⎤
⎦
≤c
βk

βkλ(Rn+k
a
) −βkηλ∞
a

≤c(1 −η)λ∞
a
≤c(1 −η2)λ(Rn
a).
We deduce from these equalities that we have
λ(∂Rn
a) ≤(1 −η2)kλ(Rn
a) −−−→
k→∞0.
⊓⊔
Proof of the Lemma 8.7.11 We have the inclusion
∂Ra ⊆

b
(t0,s0)
−−−→...
(tn−1,sn−1)
−−−−−−→a∈A′
γ n∂Rn
b +
n−1

j=0
γ n−1−jtj.
And by the Lemma 8.7.14, we have λ(∂Rn
b) = 0 for n ≥n0 and b ∈A. Thus the
boundary of Ra has zero Lebesgue measure.

8
Yet Another Characterization of the Pisot Substitution Conjecture
447
Thanks to the Lemma 8.7.10, for every t ∈Γ0\{0}, the empty intersection
◦
Du ∩
◦
Du + t is a dense open subset of
◦
Du ∩
◦
Du + t. Hence, the interior of π(Du) and
π(Du + t) are disjoint. By the Lemma 8.7.11, it proves that the Lebesgue measure
of the intersection is zero.
Every hypothesis of the Theorem 8.2.3 is satisﬁed, thus the subshift (SNu, S, μ)
is uniquely ergodic and measurably conjugate to the translation on the torus
(P/π(Γ0), T, λ). This ends the proof of the Theorem 8.7.1.
References
1. S. Akiyama, M. Barge, V. Berthé, J.-Y. Lee, A. Siegel, On the Pisot substitution conjecture.
Mathematics of Aperiodic Order. Progr. Math., vol. 309 (Birkhäuser/Springer, Basel, 2015),
pp. 33–72. MR 3381478
2. P. Arnoux, S. Ito, Pisot substitutions and Rauzy fractals. Bull. Belg. Math. Soc. 8, 181–207
(2001), http://iml.univ-mrs.fr/~arnoux/ArnouxIto.pdf
3. M. Barge, B. Diamond, Coincidence for substitutions of Pisot type. Bull. Soc. Math. France
130(4), 619–626 (2002). MR 1947456
4. M. Barge, J. Kwapisz, Geometric theory of unimodular Pisot substitutions. Am. J. Math.
128(5), 1219–1282 (2006)
5. O. Carton, Langages formels, Calculabilité et Complexité (Vuibert, Paris, 2014), https://gaati.
org/bisson/tea/lfcc.pdf. ISBN 978-2-311-01400-6
6. A. Clark, L. Sadun, When size matters: subshifts and their related tiling spaces. Ergodic Theory
Dyn. Syst. 23(4), 1043–1057 (2003)
7. Ch. Frougny, E. Pelantová, Beta-representations of 0 and Pisot numbers, JTNB, 2017, https://
arxiv.org/pdf/1512.04234.pdf
8. Ch. Frougny, J. Sakarovitch, Number representation and ﬁnite automata, Chapter 2, in
Combinatorics, Automata and Number Theory, ed. by V. Berthé, M. Rigo. Encyclopedia of
Mathematics and its Applications, vol. 135 (Cambridge University Press, Cambridge, 2010),
https://www.irif.fr/~cf/publications/cant-ch1.pdf
9. J.E. Hopfcroft, J.D.Ullman, Introduction to Automata Theory, Languages and Computation
(Addison-Wesley, Boston, 1979)
10. Sh. Ito, H. Rao, Atomic surfaces, tilings and coincidence. I. Irreducible case. Israel J. Math.
153, 129–155 (2006)
11. B. Khoussainov, A. Nerode, Automata Theory and its Applications (Springer, Berlin, 2012),
ISBN 978-1-4612-0171-7
12. J.C. Lagarias, Y. Wang, Substitution Delone sets. Discrete Comput. Geom. 29, 175–209 (2003)
13. J.C. Lagarias, Meyer’s concept of quasicrystal and quasiregular sets. Commun. Math. Phys.
179(2), 365–376 (1996)
14. J.-Y. Lee, Substitution Delone sets with pure point spectrum are inter-model sets. J. Geom.
Phys. 57(11), 2263–2285 (2007)
15. J.-Y. Lee, R.V. Moody, B. Solomyak, Consequences of pure point diffraction spectra for
multiset substitution systems. Discrete Comput. Geom. 29(4), 525–560 (2003)
16. P. Mercat, Semi-groupes fortement automatiques. Bull. Soc. Math. France 141, fascicule 3,
Paris (2013)
17. M. Queffélec, Substitution Dynamical Systems - Spectral Analysis. Lecture Notes in Maths
(Springer, Cham, 2010), ISBN 978-3-642-11212-6

448
P. Mercat and S. Akiyama
18. G. Rauzy, Nombres algébriques et substitutions, Bull. Soc. Math. France 110, 147–178 (1982),
http://www.numdam.org/article/BSMF_1982__110__147_0.pdf
19. J. Sakarovitch, Elements of Automata Theory (Cambridge University Press, Cambridge, 2009)
20. B. Sing, Pisot substitutions and beyond, PhD Thesis, 2006
21. B. Solomyak, Dynamics of self-similar tilings. Ergodic Theory Dyn. Syst. 17(3), 695–738
(1997)

Index
abelianisation, 400
absorbing set, 232
abstract numeration system, 276
additively periodic, 266
address map, 3
algebraic irreducibility, 149
almost periodic, 201
Bohr, 370
uniformly, 370
alphabet, 228
ANS, 276
Arnoux-Rauzy sequence, 122
autocorrelation, 83
measure, 85
automatic sequence, 238, 240, 243, 278
automaton, 229, 416
adjacency matrix, 416
associated with a morphism, 241
deterministic, 229
deterministic with output, 229
minimal, 416
non-deterministic, 230
weighted, 247
balance, 100, 148
balanced representation, 338
base-k expansion, 229
Beatty sequence, 250
boundary map, 214, 215, 219
exponential, 219
index, 219
bounded remainder set, 175
Bouton’s theorem, 234
Brun continued fraction algorithm,
133
Brun substitutions, 142
bulk boundary correspondence, 218
canonical alphabet, 255
characteristic polynomial, 255
chiral symmetry, 200
classical Rauzy fractal, 144
Cobham’s theorem, 245
cocycle, 382
cocyle, 381, 387
coding, 238, 240
coloring, 294
complete automaton, 241
concatenation, 267
continued fraction algorithm
Brun, 133
generalized, 132
continuous spectrum, 127
control point, 19
convergence
strong, 150
weak, 138
convolution, 363
Conway code, 285
cut & project, 200
cut & project set, 5
irreducible, 5
nondegenerate, 5
cylinder, 42
© The Editor(s) (if applicable) and The Author(s), under exclusive license
to Springer Nature Switzerland AG 2020
S. Akiyama, P. Arnoux (eds.), Substitution and Tiling Dynamics: Introduction
to Self-inducing Structures, Lecture Notes in Mathematics 2273,
https://doi.org/10.1007/978-3-030-57666-0
449

450
Index
decimation, 243
Delone m-set, 13
primitive, 13
representable, 17
substitution, 13, 411
Delone set, 2, 411
ﬁnitely generated, 2
of ﬁnite type, 2
multi-color, 411
relatively dense, 2
repetitive, 7
uniformly discrete, 2
DFA, 229
DFAO, 229
diffraction, 84, 360, 376
absolutely continuous, 376
measure, 85
singular, 379, 381, 383
Dirac
comb, 363, 392
measure, 363
direct product, 274
discrete hyperplane, 146
discrete line, 400, 408
disjunctive sum, 235
displacement matrix, 372
distribution function, 392
double patch, 199
dual geometric realization, 155
eigenfunction, 127
eigenvalue
measurable, 127
topological, 127
expansion, 229
expansive map, 364
factor, 267
Fibonacci word, 249, 275, 283
ﬁnite local complexity (FLC), 3, 39, 194, 360,
386, 387, 390
ﬁnite word, 228
Fourier
matrix, 373, 380, 390
transform, 365, 381
Frank–Robinson tiling, 389
full shift, 37
function
almost periodic, 370
mean, 370
fusion, 55
fusion rule, 56
not strongly mixing, 71
primitive, 66
prototile regular, 60
transition matrix, 66
transition regular, 60
van Hove, 64
game
ﬁnite subtraction, 230, 284
graph, 231
invariant, 287
Nim, 231
octal, 284
subtraction, 230
sum, 235
Wythoff, 231, 234, 237, 250
gap labelling, 216
Gauss map, 106
genealogical order, 251
generalized continued fraction algorithm,
132
generalized left eigenvector, 161
generalized right eigenvector, 138
geometric coincidence condition, 169
graph kernel, 232
group cohomology, 215
Grundy function, 235, 236, 266, 284
hull
augmented, 203
continuous, 195
symbolic, 196, 372
tiling, 372
incidence matrix, 380, 407
inﬁnite word, 228
inﬂation
map, 51
matrix, 380, 390
multiplier, 372, 373, 375
rule, 48, 51, 372, 373, 375
stone, 379, 381, 389
integrated density of states, 203
kernel
graph, 232
k-kernel, 243, 263
K-group, 211, 212
Kleene ﬁxed point theorem, 349
Koopman operator, 73

Index
451
language, 416
preﬁx-closed, 277
regular, 229, 416
left special factor, 122
limit sequence, 130
Lind number, 7
linear
numeration system, 255
representation, 246
set, 285
local indistinguishability (LI), 372
locally derivable, 20
mutually, 20
Lucas’s theorem, 262
Lyapunov exponent, 375, 381, 387, 390
Mahler measure, 362, 386
mean, 370
measurable eigenvalue, 127
measure
absolutely continuous, 374
bounded, 363
continuous, 374
convolution, 363
Dirac, 363
ergodic, 45
ﬁnite, 363
invariant, 45
Mahler, 362
positive, 363
positive deﬁnite, 363
pure point, 374
Radon, 362
singular continuous, 374
translation-bounded, 363
Meyer set, 5, 411
minimality, 135
model set, 5
morphic word, 240
morphism
constant length, 240
Fibonacci, 249, 251, 275
multidimensional, 260
non-erasing, 239
projection, 270
prolongable, 239, 260, 270
shape-symmetric, 271, 272, 275, 281
Thue–Morse, 245, 275
uniform, 240
multiple tiling, 146
mutual local derivability (MLD), 44, 372
natural coding, 111, 175
NFA, 230
Nim game, 231
Nim-sum, 234
normalization, 255
normal play, 230, 284
numeration system, 255
abstract, 276
combinatorial, 277
Dumont–Thomas, 287
Pisot, 255
positional, 255
unambiguous, 276
numerical value, 229, 276
octal game, 284
option, 231
pair correlation, 372, 373, 380
partial function, 251
Pascal triangle, 263
patch, 14, 39
pattern equivariant, 196, 204
strongly, 196
weakly, 197
Peano enumeration, 277
Perron–Frobenius (PF), 372, 389
Perron number, 7
complex, 18
phason ﬂip, 202
picture, 267
concatenation, 267
shape, 267
Pisot
condition, 179
family, 25
number, 255, 275, 287
substitution, 130, 408
substitution conjecture, 28, 78, 132, 376,
398
unit, 408
Pisot–Vijayaraghavan number (PV), 7, 360
polynomial
cyclotomic, 362
trigonometric, 370, 387, 390
unimodular, 387
position, 231
losing, 233
winning, 233
positional numeration system, 255

452
Index
Presburger arithmetic, 285
primitivity, 135
prolongable morphism, 239, 270
prototile, 15, 39, 379
pure discrete spectrum, 175
pure morphic word, 240
pushforward, 363
radix order, 251
Radon measure, 362
rank, 276
Rauzy fractal
classical, 144
S-adic, 143
set equation, 154
recognisability, 380
recognizable, 64
recognizable set, 276
recurrence, 137
regular language, 229, 416
regular sequence, 246
renormalisation, 373, 380
representation
abstract numeration system, 276
multidimensional base-k, 260
normal, 255
Riesz product, 360, 366, 385, 392
right special factor, 122
S-adic
Rauzy fractal, 143
sequence, 130
system, 62, 131
Salem number, 7
semilinear set, 285
sequence
Arnoux-Rauzy, 122
limit, 130
S-adic, 130
Sturmian, 100
set
absorbing, 232
linear, 285
stable, 232
shape, 267
shape-symmetry, 271, 272, 275, 281
shift
distance, 323
dynamical system, 37
full, 37
map, 37
space, 37
sink, 232
sliding block code, 43
special factor
left, 122
right, 122
spectrum
continuous, 80, 127
diffraction, 82
pure discrete, 77, 79, 175
Sprague–Grundy function, 235, 236, 266, 284
stable set, 232
state, 229
strategy, 233
strong convergence, 150
strong coincidence condition, 78, 168
Sturmian sequence, 100
subshift, 37, 322, 400
substitution, 46, 313, 372
block, 49, 382, 384
constant length, 376
Fibonacci, 47
irreducible, 408
matrix, 372, 377
Pisot, 408
primitive, 408
substitutive word, 240
subtraction game, 230
sum-of-digits, 248
sum of games, 235
supertile, 49, 51
synchronized word, 249
Thue–Morse word, 245, 275
tight binding operator, 198
tile, 39, 379
equivalent, 39
tileset, 294
intrinsically substitutive, 314
simulation, 347
tile substitution, 15
tiling, 15, 39, 146, 294
fully periodic, 39
inﬂation rule, 51
linearly repetitive, 45
nonperiodic, 39
pseudo-self-afﬁne, 20
pseudo-self-similar, 53
repetitive, 44
self-afﬁne, 15, 50, 51
self-similar, 15, 48, 51
space, 41
tiling algebra, 204
continuous, 205

Index
453
discrete, 206
tiling groupoid
continuous, 207
discrete, 207
topological eigenvalue, 127
topological phase, 212
topology
local rubber, 379, 386, 390
torus rotation, 111
torus translation, 111
transition function, 229
transition monoid, 244
transversal, 197
canonical, 197
trie, 278
Turing machine, 304
conﬁguration, 306
unambiguous numeration system, 276
uniform distribution, 368
uniform letter frequencies, 139
uniform morphism, 240
uniform word frequencies, 139
unique ergodicity, 45, 138
value, 229
Wang tile, 294
decorated, 322
one-dimensional, 321
weak convergence, 138
weakly mixing, 127
weighted automaton, 247
window, 200
winning strategy, 233
word
Fibonacci, 249, 275, 283
ﬁnite, 228
inﬁnite, 228
morphic, 240
purely morphic, 240
purely substitutive, 240
S-automatic, 278
shape-symmetric, 271, 272, 275, 281
substitutive, 240
synchronized, 249
Thue–Morse, 245, 275
Wythoff’s game, 231, 234, 237, 250
Wythoff’s theorem, 234

LECTURE NOTES IN MATHEMATICS
123
Editors in Chief: J.-M. Morel, B. Teissier;
Editorial Policy
1. Lecture Notes aim to report new developments in all areas of mathematics and their
applications – quickly, informally and at a high level. Mathematical texts analysing new
developments in modelling and numerical simulation are welcome.
Manuscripts should be reasonably self-contained and rounded off. Thus they may, and
often will, present not only results of the author but also related work by other people. They
may be based on specialised lecture courses. Furthermore, the manuscripts should provide
sufﬁcient motivation, examples and applications. This clearly distinguishes Lecture Notes
from journal articles or technical reports which normally are very concise. Articles
intended for a journal but too long to be accepted by most journals, usually do not have
this “lecture notes” character. For similar reasons it is unusual for doctoral theses to be
accepted for the Lecture Notes series, though habilitation theses may be appropriate.
2. Besides monographs, multi-author manuscripts resulting from SUMMER SCHOOLS or
similar INTENSIVE COURSES are welcome, provided their objective was held to present
an active mathematical topic to an audience at the beginning or intermediate graduate level
(a list of participants should be provided).
The resulting manuscript should not be just a collection of course notes, but should require
advance planning and coordination among the main lecturers. The subject matter should
dictate the structure of the book. This structure should be motivated and explained in
a scientiﬁc introduction, and the notation, references, index and formulation of results
should be, if possible, uniﬁed by the editors. Each contribution should have an abstract
and an introduction referring to the other contributions. In other words, more preparatory
work must go into a multi-authored volume than simply assembling a disparate collection
of papers, communicated at the event.
3. Manuscripts should be submitted either online at www.editorialmanager.com/lnm to
Springer’s mathematics editorial in Heidelberg, or electronically to one of the series edi-
tors. Authors should be aware that incomplete or insufﬁciently close-to-ﬁnal manuscripts
almost always result in longer refereeing times and nevertheless unclear referees’ rec-
ommendations, making further refereeing of a ﬁnal draft necessary. The strict minimum
amount of material that will be considered should include a detailed outline describing
the planned contents of each chapter, a bibliography and several sample chapters. Parallel
submission of a manuscript to another publisher while under consideration for LNM is not
acceptable and can lead to rejection.
4. In general, monographs will be sent out to at least 2 external referees for evaluation.
A ﬁnal decision to publish can be made only on the basis of the complete manuscript,
however a refereeing process leading to a preliminary decision can be based on a pre-ﬁnal
or incomplete manuscript.
Volume Editors of multi-author works are expected to arrange for the refereeing, to the
usual scientiﬁc standards, of the individual contributions. If the resulting reports can be

forwarded to the LNM Editorial Board, this is very helpful. If no reports are forwarded
or if other questions remain unclear in respect of homogeneity etc, the series editors may
wish to consult external referees for an overall evaluation of the volume.
5. Manuscripts should in general be submitted in English. Final manuscripts should contain
at least 100 pages of mathematical text and should always include
–
a table of contents;
–
an informative introduction, with adequate motivation and perhaps some historical
remarks: it should be accessible to a reader not intimately familiar with the topic
treated;
–
a subject index: as a rule this is genuinely helpful for the reader.
–
For evaluation purposes, manuscripts should be submitted as pdf ﬁles.
6. Careful preparation of the manuscripts will help keep production time short besides
ensuring satisfactory appearance of the ﬁnished book in print and online. After accep-
tance of the manuscript authors will be asked to prepare the ﬁnal LaTeX source ﬁles
(see LaTeX templates online: https://www.springer.com/gb/authors-editors/book-authors-
editors/manuscriptpreparation/5636) plus the corresponding pdf- or zipped ps-ﬁle. The
LaTeX source ﬁles are essential for producing the full-text online version of the book,
see http://link.springer.com/bookseries/304 for the existing online volumes of LNM). The
technical production of a Lecture Notes volume takes approximately 12 weeks. Additional
instructions, if necessary, are available on request from lnm@springer.com.
7. Authors receive a total of 30 free copies of their volume and free access to their book on
SpringerLink, but no royalties. They are entitled to a discount of 33.3 % on the price of
Springer books purchased for their personal use, if ordering directly from Springer.
8. Commitment to publish is made by a Publishing Agreement; contributing authors of
multiauthor books are requested to sign a Consent to Publish form. Springer-Verlag
registers the copyright for each volume. Authors are free to reuse material contained in
their LNM volumes in later publications: a brief written (or e-mail) request for formal
permission is sufﬁcient.
Addresses:
Professor Jean-Michel Morel, CMLA, École Normale Supérieure de Cachan, France
E-mail: moreljeanmichel@gmail.com
Professor Bernard Teissier, Equipe Géométrie et Dynamique,
Institut de Mathématiques de Jussieu – Paris Rive Gauche, Paris, France
E-mail: bernard.teissier@imj-prg.fr
Springer: Ute McCrory, Mathematics, Heidelberg, Germany,
E-mail: lnm@springer.com

