Viral 
Metagenomics
Vitantonio Pantaleo 
Laura Miozzi  Editors
Methods and Protocols
Second Edition
Methods in 
Molecular Biology   2732

M E T H O D S  I N  M O L E C U L A R  B I O  L O  G Y  
Series Editor 
John M. Walker 
School of Life and Medical Sciences 
University of Hertfordshire 
Hatfield, Hertfordshire, UK 
For further volumes: 
http://www.springer.com/series/7651

For over 35 years, biological scientists have come to rely on the research protocols and 
methodologies in the critically acclaimed Methods in Molecular Biology series. The series was 
the ﬁrst to introduce the step-by-step protocols approach that has become the standard in all 
biomedical protocol publishing. Each protocol is provided in readily-reproducible step-by-
step fashion, opening with an introductory overview, a list of the materials and reagents 
needed to complete the experiment, and followed by a detailed procedure that is supported 
with a helpful notes section offering tips and tricks of the trade as well as troubleshooting 
advice. These hallmark features were introduced by series editor Dr. John Walker and 
constitute the key ingredient in each and every volume of the Methods in Molecular Biology 
series. Tested and trusted, comprehensive and reliable, all protocols from the series are 
indexed in PubMed.

Viral Metagenomics
Methods and Protocols 
Edited by 
Vitantonio Pantaleo 
Institute for Sustainable Plant Protection, National Research Council, Bari, Italy 
Laura Miozzi 
Institute for Sustainable Plant Protection, National Research Council, Torino, Italy

Editors 
Vitantonio Pantaleo 
Institute for Sustainable Plant 
Protection 
National Research Council 
Bari, Italy 
Laura Miozzi 
Institute for Sustainable Plant Protection 
National Research Council 
Torino, Italy 
ISSN 1064-3745
ISSN 1940-6029 
(electronic) 
Methods in Molecular Biology 
ISBN 978-1-0716-3514-8
ISBN 978-1-0716-3515-5 
(eBook) 
https://doi.org/10.1007/978-1-0716-3515-5 
© The Editor(s) (if applicable) and The Author(s), under exclusive license to Springer Science+Business Media, LLC, part 
of Springer Nature 2024 
This work is subject to copyright. All rights are solely and exclusively licensed by the Publisher, whether the whole or part 
of the material is concerned, speciﬁcally the rights of translation, reprinting, reuse of illustrations, recitation, 
broadcasting, reproduction on microﬁlms or in any other physical way, and transmission or information storage and 
retrieval, electronic adaptation, computer software, or by similar or dissimilar methodology now known or hereafter 
developed. 
The use of general descriptive names, registered names, trademarks, service marks, etc. in this publication does not imply, 
even in the absence of a speciﬁc statement, that such names are exempt from the relevant protective laws and regulations 
and therefore free for general use. 
The publisher, the authors, and the editors are safe to assume that the advice and information in this book are believed to 
be true and accurate at the date of publication. Neither the publisher nor the authors or the editors give a warranty, 
expressed or implied, with respect to the material contained herein or for any errors or omissions that may have been 
made. The publisher remains neutral with regard to jurisdictional claims in published maps and institutional afﬁliations. 
This Humana imprint is published by the registered company Springer Science+Business Media, LLC, part of Springer 
Nature. 
The registered company address is: 1 New York Plaza, New York, NY 10004, U.S.A. 
Paper in this product is recyclable.

Preface 
Viruses occupy all biomes and can infect all living organisms, i.e., animals, plants, protists, 
fungi, bacteria, and archaea. By sequencing, viral metagenomics examines the viral genetic 
material recovered directly from either environmental or clinical nucleic acid samples. By 
means of viral metagenomics, it is possible to monitor and diagnose known viruses relevant 
for human and animal health as well as for plant protection, certiﬁcation, or food produc-
tion. Viral metagenomics has expanded our knowledge of the ecology of viruses, within 
both environmental (e.g., terrestrial and aquatic, including glacial masses) and host-
associated contexts. 
Through the infection of host cells, spread within the population and even through 
spillover phenomena and the establishment in new hosts, viruses are ubiquitous and increas-
ingly recognized for their important ecological roles. While the full extent of viral diversity 
and the inﬂuence they exert on their environment are poorly understood, viruses have been 
broadly recognized as critical agents of health and disease, as well as key regulators of 
microbiomes. The concept is now well established, and we are also familiar with the 
molecular mechanisms by which viruses play a role in the diversity and evolution of their 
hosts through a multitude of processes such as horizontal gene transfer, selection for 
resistance, and reprogramming of host metabolism through the expression of auxiliary 
metabolic genes. 
Given this backdrop, the extensive use of viral metagenomics is becoming increasingly 
important to better describe natural phenomena, including those associated with climate 
change. The extensive use of viral metagenomics requires a dynamic innovation in sequenc-
ing technologies. In the previous edition of the book Viral Metagenomics in the series 
Methods in Molecular Biology, nanopore sequencing (Oxford Nanopore Technologies) 
was only mentioned as being of “future hope,: but in this edition it ﬁnds a very wide range of 
applications. Although technologies rapidly improve, viral metagenomics still consists of 
three major steps: (i) sample collection and processing; (ii) library preparation and sequenc-
ing; and (iii) bioinformatic analysis. Samples of interest, clinical or environmental, are at ﬁrst 
collected through a series of ﬁltering processes to prevent contamination or artifacts. 
Afterward, nucleic acids are extracted, and speciﬁc DNA or cDNA libraries are generated 
and sequenced, mainly by means of high-throughput sequencing technologies. Finally, 
sequencing data are elaborated by a plethora of ad hoc bioinformatics pipelines mainly 
based on de novo assembly and similarity search. Alongside the routinely used second-
generation sequencing (SGS) technologies, based on the need of a clonal ampliﬁcation step 
for sequencing signal detection, third-generation sequencing (TGS) technologies, such as 
single molecule real-time sequencing (PacBio) and nanopore sequencing (Oxford Nano-
pore Technologies), have gained importance among virus experts. We are now entering the 
beginning of a new phase where the combined use of SGS and TGS technologies, novel 
imaging techniques, and advancements in data analysis tools will further revolutionize viral 
metagenomics.
v

vi
Preface
The 19 chapters presented in this second edition report or update protocols developed 
within a research framework supported by cutting-edge and driven funding. In detail, 
funding sources include the European Union’s Horizon 2020 Research and Innovation 
Programme, Japan Society for the Promotion of Science, the Consejo Nacional de Ciencia y 
Tecnologı´a (Mexico), Instituto Polite´cnico Nacional (Mexico), the Spanish Ministerio de 
Economı´a, Industria y Competitividad, the National Research, Development and Innova-
tion Ofﬁce (Hungary), Hungarian Ministry of Foreign Affairs and Trade, Citrus Research 
International (South Africa), Muse´um National d’Histoire Naturelle de Paris (France), 
National Natural Science Foundation of China, and the Italian National Research Council 
(CNR). 
This edition seeks to cover a wide range of viral metagenomics aspects, with protocols 
targeting a range of different specimens such as soil, freshwater, wastewater, fecal samples, 
blood plasma, clinical tissues, oomycetes, fungi, herbaceous and woody plants, and herbar-
ium samples, as well as different viral groups including archaeal viruses, eukaryotic viruses, 
phages, mycoviruses, and circular DNA viruses. Space is also devoted to the techniques that 
are required for undertaking the three viral metagenomic steps of sample processing, library 
construction, and analysis of data. 
We wish to thank professor emeritus John M. Walker for his guidance and the editorial 
team in ﬁnalizing this book. We are also grateful to all the authors for their valuable 
contributions. 
Bari, Italy
Vitantonio Pantaleo 
Torino, Italy
Laura Miozzi

Contents 
Preface . . . . . . . . .  . . . . . . . .  . . . . . . .  . . . . . . . .  . . . . . . .  . . . . . . .  . . . . . . . .  . . . . . . .  . . . . . . . .
v  
Contributors. . . . .  . . . . . . . .  . . . . . . .  . . . . . . . .  . . . . . . .  . . . . . . .  . . . . . . . .  . . . . . . .  . . . . . . . .
ix  
1 
Exploring the Archaeal Virosphere by Metagenomics. .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .
1  
Yifan Zhou, Yongjie Wang, David Prangishvili, and Mart Krupovic 
2 
From Whole Genome Shotgun Sequencing to Viral Community 
Proﬁling: The ViromeScan Tool .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  
23  
Simone Rampelli, Silvia Turroni, and Marco Candela 
3 
Freshwater Viral Metagenome Analyses Targeting dsDNA Viruses .  .  .  .  .  .  .  .  .  .  .  .  
29  
Kira Moon and Jang-Cheon Cho 
4 
Discovery and Identiﬁcation of Viruses Infecting Oomycetes. . .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  
45  
Anna Poimala and Eeva Vainio 
5 
Metagenomic Analyses of Viruses in the Orchid Mycorrhizal 
Interaction Using Improved Assemble Tools . .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  
67  
Kota Kambara, Hanako Shimura, Kaien Fujino, and Chikara Masuta 
6 
Determination of the Mycovirome of a Necrotrophic Fungus . .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  
83  
Ana Ruiz-Padilla, Julio L. Rodrı´guez-Romero, Davide Paciﬁco, 
Marco Chiapello, and Marı´a A. Ayllon 
7 
From Metagenomics to Ecogenomics: NGS-Based Approaches 
for Discovery of New Circular DNA Single-Stranded Viral Species .  .  .  .  .  .  .  .  .  .  .  .  103  
Enrique A. Guevara-Rivera, Edgar A. Rodrı´guez-Negrete, 
Rosa Lozano-Dura´n, Eduardo R. Bejarano, Alan M. Torres-Calderon, 
A´ ngela P. Arce-Leal, Norma E. Leyva-Lopez, and Jesu´ s Me´ndez-Lozano 
8 
SARS-CoV-2 Detection and Genome Sequencing in Urban Wastewaters .  .  .  .  .  .  119  
Enric Cuevas-Ferrando, Gloria Sa´nchez, and Alba Pe´rez-Catalun˜a 
9 
Enrichment, Sequencing, and Identiﬁcation of DNA Bacteriophages 
from Fecal Samples. . .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  133  
Quentin Lamy-Besnier and Julian R. Garneau 
10 
Exploration and Retrieval of Virus-Related Molecular Data 
Using ExTaxsI: The Monkeypox Use Case. . . .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  145  
Alberto Brusati, Giulia Agostinetto, Antonia Bruno, Maurizio Casiraghi, 
Dario Pescini, Anna Sandionigi, and Bachir Balech 
11 
Optimized Recovery of Viral DNA and RNA from Blood Plasma 
for Viral Metagenomics.  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  155  
Marı´a Cebria´-Mendoza, Wladimiro Dı´az, Rafael Sanjua´n, 
and Jose´ M. Cuevas 
12 
Targeted Whole Genome Sequencing of the Capripoxvirus 
Genome from Clinical Tissue Samples and Lyophilized Vaccine Batches .  .  .  .  .  .  .  165  
Elisabeth Mathijs and Frank Vandenbussche
vii

viii
Contents
13 
Viromes of Plants Determined by High-Throughput Sequencing 
of Virus-Derived siRNAs . . . .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  179  
Nikoletta Jaksa-Czotter, Zsuzsanna Nagyne´ Galba´cs, Almash Jahan, 
Emese Demia´n, and E´ va Va´rallyay 
14 
Validation of High-Throughput Sequencing (HTS) for Routine 
Detection of Citrus Viruses and Viroids .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  199  
Rachelle Bester and Hans J. Maree 
15 
Identiﬁcation of DNA Viruses in Ancient DNA from Herbarium Samples .  .  .  .  .  221  
Gianluca Grasso, Silvia Rotunno, Re´gis Debruyne, Lucie Bittner, 
Laura Miozzi, Roland Marmeisse, and Valeria Bianciotto 
16 
The Oxford Nanopore MinION as a Versatile Technology 
for the Diagnosis and Characterization of Emerging Plant Viruses .  .  .  .  .  .  .  .  .  .  .  .  235  
Giulia Tarquini, Simone Maestri, Paolo Ermacora, and Marta Martini 
17 
Detection of Plant Viruses Using Nanopore Sequencing Based 
Metagenomic Approach .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  251  
Anja Pecman, Natasˇa Mehle, and Denis Kutnjak 
18 
Application of Nanopore-Based Sequencing to Identify Virus Infections 
in Woody Plants .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  267  
Seraﬁna Serena Amoia, Michela Chiumenti, and Angelantonio Minafra 
19 
Distribution of Small RNAs Along Transposable Elements 
in Vitis vinifera During Somatic Embryogenesis.  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  279  
Silvia Rotunno, Paola Leonetti, Gyorgy Szittya, and Vitantonio Pantaleo 
Index . . . .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  
287

Contributors 
GIULIA AGOSTINETTO 
• University of Milano-Bicocca, Department of Biotechnology and 
Biosciences, Milan, Italy 
SERAFINA SERENA AMOIA 
• Institute for Sustainable Plant Protection-National Research 
Council, Bari, Italy; Department of Soil, Plant and Food Sciences, University of Bari Aldo 
Moro, Bari, Italy 
A´ NGELA P. ARCE-LEAL 
• Departamento de Biotecnologı´a Agrı´cola, Instituto Polite´cnico 
Nacional, CIIDIR Unidad Sinaloa, Guasave, Sinaloa, Mexico 
MARI´A A. AYLLO´ N 
• Centro de Biotecnologı´a y Genomica de Plantas, Universidad Polite´cnica 
de Madrid (UPM)-Instituto Nacional de Investigacion y Tecnologı´a Agraria y 
Alimentaria (INIA), Madrid, Spain; Departamento de Biotecnologı´a-Biologı´a Vegetal, 
Escuela Te´cnica Superior de Ingenierı´a Agronomica, Alimentaria y de Biosistemas, 
Universidad Polite´cnica de Madrid (UPM), Madrid, Spain 
BACHIR BALECH 
• Institute of Biomembranes, Bioenergetics and Molecular Biotechnologies 
(CNR), Bari, Italy 
EDUARDO R. BEJARANO 
• Instituto de Hortofruticultura Subtropical y Mediterra´nea “La 
Mayora”, Universidad de Ma´laga-Consejo Superior de Investigaciones Cientı´ﬁcas (IHSM-
UMA-CSIC), Ma´laga, Spain 
RACHELLE BESTER 
• Citrus Research International, Stellenbosch, South Africa; Department 
of Genetics, Stellenbosch University, Stellenbosch, South Africa 
VALERIA BIANCIOTTO 
• Institute for Sustainable Plant Protection (IPSP), National Research 
Council (CNR), Turin, Italy 
LUCIE BITTNER 
• Muse´um National d’Histoire Naturelle, Institut Syste´matique Evolution, 
Biodiversite´, (ISYEB: UMR7205 CNRS-MNHN-Sorbonne Universite´-EPHE-UA), Paris, 
France; Institut Universitaire de France, Paris, France 
ANTONIA BRUNO 
• University of Milano-Bicocca, Department of Biotechnology and 
Biosciences, Milan, Italy 
ALBERTO BRUSATI 
• University of Pavia, Department of Brain and Behavioral Sciences, 
Pavia, Italy 
MARCO CANDELA 
• Unit of Microbiome Science and Biotechnology, Department of Pharmacy 
and Biotechnology, University of Bologna, Bologna, Italy 
MAURIZIO CASIRAGHI 
• University of Milano-Bicocca, Department of Biotechnology and 
Biosciences, Milan, Italy 
MARI´A CEBRIA´-MENDOZA 
• Institute for Integrative Systems Biology (I2SysBio), Universitat 
de Vale`ncia-CSIC, Vale`ncia, Spain 
MARCO CHIAPELLO 
• Institute for Sustainable Plant Protection, National Research Council 
of Italy, Turin, Italy 
MICHELA CHIUMENTI 
• Institute for Sustainable Plant Protection-National Research 
Council, Bari, Italy 
JANG-CHEON CHO 
• Department of Biological Sciences and Bioengineering, Inha University, 
Incheon, Republic of Korea 
JOSE´ M. CUEVAS 
• Institute for Integrative Systems Biology (I2SysBio), Universitat de 
Vale`ncia-CSIC, Vale`ncia, Spain
ix

x
Contributors
ENRIC CUEVAS-FERRANDO 
• VISAFELab, Department of Preservation and Food Safety 
Technologies, Institute of Agrochemistry and Food Technology, IATA-CSIC, Valencia, 
Paterna, Spain 
RE´ GIS DEBRUYNE 
• Muse´um National d’Histoire Naturelle, Arche´ozoologie, Arche´ 
obotanique: Socie´te´s, Pratiques et Environnements (AASPE: UMR 7209 CNRS-MNHN), 
Paris, France 
EMESE DEMIA´ N 
• Genomics Research Group, Department of Plant Pathology, Institute of 
Plant Protection, MATE, Go¨do¨llo˝, Hungary 
WLADIMIRO DI´AZ 
• Institute for Integrative Systems Biology (I2SysBio), Universitat de 
Vale`ncia-CSIC, Vale`ncia, Spain 
PAOLO ERMACORA 
• Department of Agriculture, Food, Environmental and Animal Sciences, 
University of Udine, Udine, Italy 
KAIEN FUJINO 
• Research Faculty of Agriculture, Hokkaido University, Sapporo, Hokkaido, 
Japan 
JULIAN R. GARNEAU 
• Institut Pasteur, Universite´ Paris Cite´, Plate-forme Technologique 
Biomics, Paris, France; Department of Fundamental Microbiology, University of 
Lausanne, Lausanne, Switzerland 
GIANLUCA GRASSO 
• Dipartimento di Scienze della Vita e Biologia dei Sistemi, Universita` 
degli Studi of Turin, Turin, Italy; Muse´um National d’Histoire Naturelle, Institut Syste´ 
matique Evolution, Biodiversite´, (ISYEB: UMR7205 CNRS-MNHN-Sorbonne 
Universite´-EPHE-UA), Paris, France; Institute for Sustainable Plant Protection (IPSP), 
National Research Council (CNR), Turin, Italy 
ENRIQUE A. GUEVARA-RIVERA 
• Departamento de Biotecnologı´a Agrı´cola, Instituto Polite´ 
cnico Nacional, CIIDIR Unidad Sinaloa, Guasave, Sinaloa, Mexico 
ALMASH JAHAN 
• Genomics Research Group, Department of Plant Pathology, Institute of 
Plant Protection, MATE, Go¨do¨llo˝, Hungary 
NIKOLETTA JAKSA-CZOTTER 
• Genomics Research Group, Department of Plant Pathology, 
Institute of Plant Protection, MATE, Go¨do¨llo˝, Hungary 
KOTA KAMBARA 
• Research Faculty of Agriculture, Hokkaido University, Sapporo, Hokkaido, 
Japan; Asian Natural Environmental Science Center (ANESC), The University of Tokyo, 
Tokyo, Japan 
MART KRUPOVIC 
• Institut Pasteur, Universite´ Paris Cite´, Archaeal Virology Unit, Paris, 
France 
DENIS KUTNJAK 
• Department of Biotechnology and Systems Biology, National Institute of 
Biology, Ljubljana, Slovenia 
QUENTIN LAMY-BESNIER 
• Institut Pasteur, Universite´ Paris Cite´, CNRS UMR6047, 
Bacteriophage Bacterium Host, Paris, France; Institut Pasteur, Universite´ Paris Cite´, 
Spatial Regulation of Genomes Group, CNRS UMR 3525, Paris, France 
PAOLA LEONETTI 
• Institute for Sustainable Plant Protection, National Research Council, 
Bari, Italy 
NORMA E. LEYVA-LO´ PEZ 
• Departamento de Biotecnologı´a Agrı´cola, Instituto Polite´cnico 
Nacional, CIIDIR Unidad Sinaloa, Guasave, Sinaloa, Mexico 
ROSA LOZANO-DURA´ N 
• Department of Plant Biochemistry, Center for Plant Molecular 
Biology (ZMBP), Eberhard Karls University, Tu¨bingen, Germany 
SIMONE MAESTRI 
• Center for Genomic Science of IIT@SEMM, Fondazione Istituto Italiano 
di Tecnologia, Milano, Italy 
HANS J. MAREE 
• Citrus Research International, Stellenbosch, South Africa; Department of 
Genetics, Stellenbosch University, Stellenbosch, South Africa

Contributors
xi
ROLAND MARMEISSE 
• Muse´um National d’Histoire Naturelle, Institut Syste´matique 
Evolution, Biodiversite´, (ISYEB: UMR7205 CNRS-MNHN-Sorbonne Universite´-EPHE-
UA), Paris, France; Institute for Sustainable Plant Protection (IPSP), National Research 
Council (CNR), Turin, Italy 
MARTA MARTINI 
• Department of Agriculture, Food, Environmental and Animal Sciences, 
University of Udine, Udine, Italy 
CHIKARA MASUTA 
• Research Faculty of Agriculture, Hokkaido University, Sapporo, 
Hokkaido, Japan 
ELISABETH MATHIJS 
• EURL for Diseases Caused by Capripoxviruses, Scientiﬁc Directorate 
Infectious Diseases in Animals, Sciensano, Brussels, Belgium 
NATASˇA MEHLE 
• Department of Biotechnology and Systems Biology, National Institute of 
Biology, Ljubljana, Slovenia; School for Viticulture and Enology, University of Nova 
Gorica, Vipava, Slovenia 
JESU´ S ME´ NDEZ-LOZANO 
• Departamento de Biotecnologı´a Agrı´cola, Instituto Polite´cnico 
Nacional, CIIDIR Unidad Sinaloa, Guasave, Sinaloa, Mexico 
ANGELANTONIO MINAFRA 
• Institute for Sustainable Plant Protection-National Research 
Council, Bari, Italy 
LAURA MIOZZI 
• Institute for Sustainable Plant Protection (IPSP), National Research 
Council (CNR), Turin, Italy 
KIRA MOON 
• Division of Environmental Materials, Honam National Institute of Biological 
Resources, Mokpo, Republic of Korea 
ZSUZSANNA NAGYNE´ GALBA´ CS 
• Genomics Research Group, Department of Plant Pathology, 
Institute of Plant Protection, MATE, Go¨do¨llo˝, Hungary 
DAVIDE PACIFICO 
• Institute of Bioscience and Bioresources, National Research Council of 
Italy, Palermo, Italy 
VITANTONIO PANTALEO 
• Institute for Sustainable Plant Protection, National Research 
Council, Bari, Italy 
ANJA PECMAN 
• Department of Biotechnology and Systems Biology, National Institute of 
Biology, Ljubljana, Slovenia 
ALBA PE´ REZ-CATALUN˜A 
• VISAFELab, Department of Preservation and Food Safety 
Technologies, Institute of Agrochemistry and Food Technology, IATA-CSIC, Valencia, 
Paterna, Spain 
DARIO PESCINI 
• University of Milano-Bicocca, Department of Statistics and Quantitative 
Methods, Milan, Italy 
ANNA POIMALA 
• Natural Resources Institute Finland (Luke), Helsinki, Finland 
DAVID PRANGISHVILI 
• Institut Pasteur, Universite´ Paris Cite´, Archaeal Virology Unit, Paris, 
France; Ivane Javakhishvili Tbilisi State University, Tbilisi, Georgia 
SIMONE RAMPELLI 
• Unit of Microbiome Science and Biotechnology, Department of Pharmacy 
and Biotechnology, University of Bologna, Bologna, Italy 
EDGAR A. RODRI´GUEZ-NEGRETE 
• Departamento de Biotecnologı´a Agrı´cola, Instituto Polite´ 
cnico Nacional, CIIDIR Unidad Sinaloa, Guasave, Sinaloa, Mexico 
JULIO L. RODRI´GUEZ-ROMERO 
• Centro de Biotecnologı´a y Genomica de Plantas, 
Universidad Polite´cnica de Madrid (UPM)-Instituto Nacional de Investigacion y 
Tecnologı´a Agraria y Alimentaria (INIA), Madrid, Spain; Departamento de 
Biotecnologı´a-Biologı´a Vegetal, Escuela Te´cnica Superior de Ingenierı´a Agronomica, 
Alimentaria y de Biosistemas, Universidad Polite´cnica de Madrid (UPM), Madrid, Spain

xii
Contributors
SILVIA ROTUNNO 
• Institute for Sustainable Plant Protection (IPSP), National Research 
Council (CNR), Turin, Italy; Institute for Sustainable Plant Protection, National 
Research Council, Torino, Italy 
ANA RUIZ-PADILLA 
• Centro de Biotecnologı´a y Genomica de Plantas, Universidad Polite´ 
cnica de Madrid (UPM)-Instituto Nacional de Investigacion y Tecnologı´a Agraria y 
Alimentaria (INIA), Madrid, Spain 
GLORIA SA´ NCHEZ 
• VISAFELab, Department of Preservation and Food Safety Technologies, 
Institute of Agrochemistry and Food Technology, IATA-CSIC, Valencia, Paterna, Spain 
ANNA SANDIONIGI 
• University of Milano-Bicocca, Department of Biotechnology and 
Biosciences, Milan, Italy; Quantia Consulting srl, Department of Data Science and 
Education, Remote Company, Milan, Italy 
RAFAEL SANJUA´ N 
• Institute for Integrative Systems Biology (I2SysBio), Universitat de 
Vale`ncia-CSIC, Vale`ncia, Spain 
HANAKO SHIMURA 
• Research Faculty of Agriculture, Hokkaido University, Sapporo, 
Hokkaido, Japan 
GYO¨ RGY SZITTYA 
• Institute of Genetics and Biotechnology, Hungarian University of 
Agricultural and Life Sciences, Go¨do¨llo˝, Hungary 
GIULIA TARQUINI 
• Department of Agriculture, Food, Environmental and Animal Sciences, 
University of Udine, Udine, Italy 
ALAN M. TORRES-CALDERO´ N 
• Forschungszentrum Ju¨lich, IBG-4: Bioinformatics, Ju¨lich, 
Germany 
SILVIA TURRONI 
• Unit of Microbiome Science and Biotechnology, Department of Pharmacy 
and Biotechnology, University of Bologna, Bologna, Italy 
EEVA VAINIO 
• Natural Resources Institute Finland (Luke), Helsinki, Finland 
FRANK VANDENBUSSCHE 
• EURL for Diseases Caused by Capripoxviruses, Scientiﬁc 
Directorate Infectious Diseases in Animals, Sciensano, Brussels, Belgium 
E´ VA VA´ RALLYAY 
• Genomics Research Group, Department of Plant Pathology, Institute of 
Plant Protection, MATE, Go¨do¨llo˝, Hungary 
YONGJIE WANG 
• College of Food Science and Technology, Shanghai Ocean University, 
Shanghai, China; Laboratory for Marine Biology and Biotechnology, Qingdao National 
Laboratory for Marine Science and Technology, Qingdao, China; Laboratory of Quality 
and Safety Risk Assessment for Aquatic Products on Storage and Preservation (Shanghai), 
Ministry of Agriculture, Shanghai, China 
YIFAN ZHOU 
• Institut Pasteur, Universite´ Paris Cite´, Archaeal Virology Unit, Paris, France; 
Sorbonne Universite´, Colle`ge Doctoral, Paris, France

Chapter 1 
Exploring the Archaeal Virosphere by Metagenomics 
Yifan Zhou, Yongjie Wang, David Prangishvili, and Mart Krupovic 
Abstract 
During the past decade, environmental research has demonstrated that archaea are abundant and wide-
spread in nature and play important ecological roles at a global scale. Currently, however, the majority of 
archaeal lineages cannot be cultivated under laboratory conditions and are known exclusively or nearly 
exclusively through metagenomics. A similar trend extends to the archaeal virosphere, where isolated 
representatives are available for a handful of model archaeal virus-host systems. Viral metagenomics 
provides an alternative way to circumvent the limitations of culture-based virus discovery and offers insight 
into the diversity, distribution, and environmental impact of uncultured archaeal viruses. Presently, meta-
genomics approaches have been successfully applied to explore the viromes associated with various lineages 
of extremophilic and mesophilic archaea, including Asgard archaea (Asgardarchaeota), ANME-1 archaea 
(Methanophagales), thaumarchaea (Nitrososphaeria), altiarchaea (Altiarchaeota), and marine group II 
archaea (Poseidoniales). Here, we provide an overview of methods widely used in archaeal virus metage-
nomics, covering metavirome preparation, genome annotation, phylogenetic and phylogenomic analyses, 
and archaeal host assignment. We hope that this summary will contribute to further exploration and 
characterization of the enigmatic archaeal virome lurking in diverse environments. 
Key words Archaeal viruses, Archaea, Metagenomics, Major capsid protein, CRISPR spacers, Host 
prediction, Virome 
1 
Introduction 
Recent advances in high-throughput genome sequencing and 
computational approaches have transformed our appreciation of 
the diversity, ubiquity, and importance of archaea in natural envir-
onments [1–9]. Similar to bacteriophages [10–15], archaeal viruses 
represent one of the major factors controlling the diversity and 
metabolic activity of archaeal populations [16, 17]. Although 
culture-based approaches are revealing extraordinary morphologi-
cal and genomic diversity of archaeal viruses isolated from extreme 
geothermal and hypersaline environments [18–23], only a handful 
of virus isolates infecting mesophilic archaea have been described 
thus far [24, 25], limiting our appreciation of their diversity and
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_1, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
1

ecological impacts. Nevertheless, the culture-based virus discovery 
efforts are increasingly complemented by culture-independent 
metagenomic approaches. For instance, metagenomics has uncov-
ered a number of family-level groups of viruses and mobile genetic 
elements associated with Asgard archaea [26–29], a prominent 
phylum Asgardarchaeota widely considered to represent the ances-
tors of eukaryotes [1, 2]; ANME-1 clade (order Methanophagales), 
a group of methane oxidizing archaea implicated in the modulation 
of greenhouse gas emission [30]; methanogenic archaea [31, 32, 
131]; ubiquitous marine archaea of the order Poseidoniales [34– 
36], and ammonia oxidizing thaumarchaea [33, 37–39]; as well as 
Altiarchaeota, abundant primary producers in subsurface ecosys-
tems [39]. These studies have provided precious insights into the 
parts of the archaeal virosphere that are currently inaccessible 
through classical culture-based techniques. In this chapter, we 
provide an overview of protocols and practices used in archaeal 
virus metagenomics, covering metavirome preparation, genome 
annotation, phylogenetic and phylogenomic analyses, abundance 
proﬁling, and archaeal host assignment.
2
Yifan Zhou et al.
2 
Materials 
2.1 
Bioinformatics 
Tools 
Software packages and bioinformatic tools commonly used for the 
analysis of archaeal virus genomes and proteins are listed in Table 1. 
3 
Methods 
Archaea typically represent an abundant or even dominant compo-
nent of the microbial communities in geothermal (e.g., terrestrial 
hot spring), hypersaline (e.g., crystallizer pond), and certain marine 
(e.g., estuary, sediments) environments [83–87]. Not surprisingly, 
archaeal viruses are also prevalent in such archaea-dominated eco-
systems. Thus, to exemplify the protocols for exploration of the 
archaeal virome, in this chapter, we focus on samples originating 
from hot springs, hypersaline ponds, and marine environments. 
Generally, the preparation of the viral DNA for archaeal virus 
metagenomics is not different from that used for other prokaryotic 
DNA viruses and given that there are many excellent dedicated 
studies on this topic (e.g., [88–93]), this part will be discussed 
only brieﬂy. Notably, all currently known archaeal viruses contain 
DNA genomes [92]; thus, protocols for RNA virus discovery will 
not be considered. For environmental samples with low archaeal 
abundance, whenever possible, an archaeal enrichment step [93] 
might be considered prior to collecting the viral DNA for the 
downstream metagenomics studies.

(continued)
Exploring the Archaeal Virosphere by Metagenomics
3
Table 1 
Software and web servers 
Tool
Available at
Function
References 
Fastp
github.com/OpenGene/fastp
Reads quality control
[40] 
Trimmomatic
github.com/usadellab/Trimmomatic 
Reads quality control
[41] 
Megahit
github.com/voutcn/megahit
Sequence assembly
[42] 
metaSPAdes
cab.spbu.ru/software/spades
Sequence assembly
[43] 
Blast+
ftp.ncbi.nlm.nih.gov/blast/ 
executables 
Sequence homology search
[44] 
VirSorter2
github.com/jiarong/VirSorter2
Viral sequence identiﬁcation 
[45] 
VIBRANT
github.com/AnantharamanLab/ 
VIBRANT 
Viral sequence identiﬁcation 
[46] 
DeepVirFinder
github.com/jessieren/DeepVirFinder 
Viral sequence identiﬁcation 
[47] 
Cenote-Taker 2
github.com/mtisza1/Cenote-Taker2 
Viral sequence identiﬁcation 
[48] 
Geneious Prime
Biomatters, Inc.
Sequence extension and 
reads mapping 
N/A 
ContigExtender
github.com/dengzac/contig-
extender 
Sequence extension
[49] 
CheckV
bitbucket.org/berkeleylab/CheckV
Virus genome completeness 
assessment 
[50] 
CRISPRCasFinder crisprcas.i2bc.paris-saclay.fr/ 
CrisprCasFinder/Index 
CRISPR spacer extraction
[51] 
CRISPRDetect
github.com/davidchyou/ 
CRISPRDetect_2.4 
CRISPR spacer extraction
[52] 
CD-HIT
cd-hit.org
Sequence redundancy 
removal 
[53] 
tRNAscan-SE
github.com/UCSC-LoweLab/ 
tRNAscan-SE 
tRNA gene detection
[54] 
Batch CD-Search 
www.ncbi.nlm.nih.gov
Protein annotation
[55] 
eggNOG-mapper 
eggnog-mapper.embl.de
Protein annotation
[56, 57] 
DRAM-v
github.com/WrightonLabCSU/ 
DRAM 
Viral AMGs detection
[58] 
HostG
github.com/KennthShang/HostG
Host prediction
[59] 
MArVD2
bitbucket.org/MAVERICLab/ 
marvd2 
Archaeal virus identiﬁcation 
[130] 
WIsH
github.com/soedinglab/wish
Host prediction
[60] 
PHISDetector
github.com/HIT-ImmunologyLab/ 
PHISDetector 
Host prediction
[61] 
RaFAH
sourceforge.net/projects/rafah
Host prediction
[62]

Table 1
4
Yifan Zhou et al.
(continued)
Tool
Available at
Function
References 
iPHoP
bitbucket.org/srouxjgi/iphop
Host prediction
N/A 
Pharokka
github.com/gbouras13/pharokka
Genome annotation
[63] 
HHsearch
github.com/soedinglab/hh-suite
Genome annotation
[64] 
VIRFAM
biodev.cea.fr/virfam
Genome annotation
[65] 
T-Coffee
tcoffee.crg.eu
Sequence alignment
[66] 
MUSCLE
www.drive5.com/muscle
Sequence alignment
[67] 
PROMALS3D
prodata.swmed.edu/promals3d
Sequence alignment
[68] 
trimAl
trimal.cgenomics.org/
Alignment trimming
[69] 
PhyML
www.atgc-montpellier.fr/phyml
Phylogeny construction
[70] 
FastTree
www.microbesonline.org/fasttree
Phylogeny construction
[71] 
IQ-TREE
www.iqtree.org
Phylogeny construction
[72] 
iTOL
itol.embl.de
Tree visualization
[73] 
Evolview
www.evolgenius.info/evolview
Tree visualization
[74] 
vConTACT2
bitbucket.org/MAVERICLab/ 
vcontact2 
Gene-sharing network 
construction 
[75] 
compareM
github.com/dparks1134/CompareM 
Comparative genomic 
analyses 
N/A 
Easyﬁg
easyﬁg.sourceforge.net
Genome map construction
[76] 
Clinker
github.com/gamcil/clinker
Genome map construction
[77] 
Cytoscape
cytoscape.org
Network visualization
[78] 
ViPTree
www.genome.jp/viptree/
Comparative genomic 
analyses 
[79] 
R package
www.r-project.org/
Heatmap construction
N/A 
Bowtie2
bowtie-bio.sourceforge.net/bowtie2 
Reads mapping
[80] 
3.1 
Concentration of 
Viral Particles and DNA 
Puriﬁcation (Adapted 
from [90–95]) 
For environmental samples with low cellular (and viral) density, 
large initial volumes, in the range of tens or hundreds of liters, are 
typically processed. For instance, in the case of marine samples, 
~100 L of the water sample can be ﬁltered through a 5 μm pore 
size ﬁlter to remove large inorganic particles and eukaryotic cells 
(Fig. 1). Next, the preﬁltered water sample is further passed 
through two successive 0.45 μm and 0.22 μm pore size ﬁlter-
columns to remove the remaining cells, mainly archaea and bacte-
ria. The virus particles can be concentrated by passing the cell-free 
water through a 50 kDa cutoff tangential-ﬂow ﬁltration (TFF) 
cassette until the retentate reaches a volume of ~500 mL (see

Notes 1 and 2). Finally, the viral preparation can be further con-
centrated to ~20 mL using 30 kDa cutoff ultraﬁltration cups or 
ultracentrifugation. 
Exploring the Archaeal Virosphere by Metagenomics
5
Fig. 1 A workﬂow for the virus metagenome preparation 
Chemical ﬂocculation is an alternative approach that has been 
successfully applied for the concentration of viruses from seawater 
samples. This method depends on iron(III) chloride to precipitate 
viruses that are recovered by ﬁltration onto large-pore size mem-
branes and then resuspended using a buffer containing magnesium 
and a reductant (ascorbic acid or oxalic acid) at slightly acidic pH 
[87, 96]. 
Next, total nucleic acids are extracted from the virus concen-
trate and prepared for metagenomic sequencing (see Notes 3 and 
4). Generally, libraries are subjected to 150-bp, 250-bp, or 300-bp 
paired-end sequencing on Illumina platforms such as HiSeq X Ten, 
NovaSeq 6000, and MiSeq, respectively. Furthermore, the long-
read sequencing, for example, provided by PacBio (Paciﬁc Bios-
ciences) or Nanopore (Oxford Nanopore Technologies), is becom-
ing increasingly popular and affordable, providing single-molecule 
long-read sequences that can cover the entire virus genomes or 
considerably facilitate the assembly of large virus genomes [97]. 
3.2 
Quality Control of 
Sequencing Reads 
Sequencing adapters and low-quality reads (<Q20) are trimmed off 
by using quality control tools such as Fastp and Trimmomatic to 
obtain a clean metagenomic dataset (see Note 5). 
Example: 
’fastp -i input_R1.fastq.gz -o clean_R1.fastq.gz -I input_R2.fastq.gz
-O clean_R2.fastq.gz’

6
Yifan Zhou et al.
3.3 
Sequence 
Assembly 
In the next step, clean reads are assembled to generate metage-
nomic contigs. The assembly is one of the most memory-
consuming steps. A server with at least 200 GB of RAM is required. 
It is advisable to use more than one sequence assembler, as they 
produce slightly different results. Tools such as Megahit and metaS-
pades are applied to assemble the clean reads into metagenomic 
contigs. Contigs with sequence length over 1 kb are retained for 
the subsequent analyses. 
Examples: 
’megahit -1 clean_R1.fastq.gz -2 clean_R2.fastq.gz -o output_assem-
bly -t 48’ 
’spades.py --meta -1 clean_R1.fastq.gz -2 clean_R2.fastq.gz -t 48 -m 
360 -o output_assembly’ 
3.4 
Identiﬁcation of 
Viral Contigs 
It is not possible to completely eliminate prokaryotic DNA from 
environmental metaviromes, because cellular DNA can be pack-
aged into virus capsids and be transferred from one host to another 
by a process known as genetic transduction [98]. Alternatively, 
cellular DNA can be protected from DNase digestion within 
virus-sized extracellular membrane vesicles, which are known to 
be produced by many archaeal species [101–104]. To assess the 
extent of contamination with prokaryotic DNA, the 16S ribosomal 
RNA gene sequences can be downloaded from the SILVA database 
(latest release, www.arb-silva.de/) and used as queries to search 
against the assembled metagenomic sequences. Depending on the 
results, instead of using all sequences derived from the “virus 
metagenome,” it is recommended to implement a step of viral 
sequence sorting. 
Tools such as VirSorter2, VIBRANT, DeepVirFinder, or 
Cenote-Taker 2 (here and elsewhere, see Table 1 for references) 
can be used to identify and extract viral sequences from the assem-
bled contigs (see Note 6). 
Examples: 
’virsorter run -w vir_outputVS2 -i Assembly_contigs.fasta --include-
groups dsDNAphage --high-conﬁdence-only’ 
’python run_cenote-taker2.py -c Assembly_contigs.fasta -r vir_out-
putCT2 -p True -m 256 -t 48 --exact_dtrs True’ 
3.5 
Sequences 
Extension and 
Sequence Quality 
Check 
The viral contigs can be extended by recruiting the sequencing 
reads that overlap with the edges of the de novo assembled contigs 
[103, 104]. To this end, all identiﬁed viral sequences can be pooled 
together and used as seed sequences to perform the reference 
assembly. Geneious Prime “map to reference” function can be 
used to compare all the metagenomic reads to the seed sequences. 
If there are signiﬁcant matches (i.e., ≥30 bp overlap and ≥95% 
overlap identity), the reads will be assembled to the corresponding

seed sequence, yielding longer viral contigs. This procedure can be 
repeated until the seed sequence ceases to extend (see Note 7). 
Alternatively, 
sequence 
extension 
can 
be 
performed 
using 
ContigExtender. 
Exploring the Archaeal Virosphere by Metagenomics
7
Example: 
’extender_wrapper.py --m1 clean_R1.fastq --m2 clean_R2.fastq --out 
VirContigExtension --min-overlap-length 30 --stop-length 55 --
threads 48 vir_contigs.fasta’ 
“Repeat Finder” (Geneious Prime plugin) can be used to 
detect direct terminal repeats (DTR) and inverted terminal repeats 
(ITR) on the extended viral contigs. If the contig contains either 
DTR or ITR regions, the sequence can be considered to represent a 
complete circular or linear virus genome, respectively. Note that for 
formal classiﬁcation, the International Committee on Taxonomy of 
Viruses (ICTV) only considers viruses with complete genome 
sequences [105] (see Note 8). 
CheckV can also be used to estimate genome completeness by 
examining the terminal repeats and similarity of the viral contigs to 
related viral genomes. 
Example: 
’checkv end_to_end viral_contigs.fasta checkv_output -t 48 -d ~/ 
checkv_database’ 
Note that due to its inherent dependency on viral reference 
genomes, CheckV shows inadequate performance when assessing 
the completeness of truly novel viral genomes that have only distant 
relatives or no relatives in the reference database. 
3.6 
Assignment of 
Archaeal Hosts 
Arguably, the most challenging step in archaeal virus metagenomics 
is the differentiation between viruses infecting bacteria and archaea 
and accurate assignment of viruses to their archaeal hosts. Below we 
introduce several host assignment approaches that have been previ-
ously applied to identify archaeal viruses in metagenomic datasets. 
3.6.1 
CRISPR Spacer 
Targeting 
CRISPR-Cas is an adaptive immune system encoded by most 
archaeal species [106]. The spacer sequences stored in CRISPR 
arrays represent the immune memory of past encounters with 
foreign mobile genetic elements. Therefore, by matching CRISPR 
spacers to the corresponding protospacer sequences in the viral 
genomes, it is possible to identify archaeal virus-host pairs in meta-
genomic dataset. See an example of archaeal CRISPR spacers 
matching an archaeal virus genome in Fig. 2. This method is 
currently the most reliable among host-prediction approaches. 
However, it should be noted that in the case of archaeal viruses, 
the accuracy of host prediction is typically limited to the level of 
family [107] or even order [30]. For instance, in the case of

rudiviruses, viruses infecting Saccharolobus and Metallosphaera spe-
cies were targeted by spacers from CRISPR arrays of Metallosphaera 
and Saccharolobus, respectively [107]. 
8
Yifan Zhou et al.
Fig. 2 Seven CRISPR spacers from two Haloarcula species match the genome of Haloarcula sinaiiensis tailed 
virus 1 (HSTV-1) 
To assemble the database of CRISPR spacers, all archaeal geno-
mic sequences can be downloaded from the Genome Taxonomy 
Database (GTDB) or any other genome database. The retrieved 
archaeal genomes can then be analyzed using CRISPRDetect or 
CRISPRCasFinder to detect CRISPR arrays and extract the 
archaeal CRISPR spacer sequences. 
Example: 
’CRISPRCasFinder -in archaeal_seqs.fasta -out CRISPR_results
-md 10 -t 15 -mr 25 -xr 55 -ms 25 -xs 55 -pm 0.7 -px 2.5 -s 
55 -ﬂ 120 -cpuM 48’ 
CD-HIT can be used to remove redundant spacers with 100% 
sequence identity cutoff. To maintain the targeting speciﬁcity, it is 
recommended to discard spacers with a sequence length shorter 
than 25 bp. 
Example: 
’cd-hit -i archaeal_spacer.fasta -o unique_archaeal_spacers.fasta -c 
1 -M 36000 -T 12 -d 0’ 
Next, a BLASTn database should be prepared from the 
extracted viral contigs: 
’makeblastdb -i viral_contigs.fasta -out nt_db/viral_contigs -dbtype 
nucl’ 
The archaeal spacers can then be used as queries to search 
against the viral contig database (see Notes 9 and 10). Hits with 
at least 95% coverage and 95% identity are considered valid proto-
spacers, and the protospacer-containing viral contigs can then be 
linked to the corresponding archaeal hosts.

’blastn -query unique_archaeal_spacers.fasta -db nt_db/viral_con-
tigs -out ArSpacers_vs_VirContigs.xls -outfmt 6 -word_size 
7 -dust no -qcov_hsp_perc 95 -perc_identity 95 -num_threads 48’ 
Exploring the Archaeal Virosphere by Metagenomics
9
More than one spacer hit increases the reliability of the host 
prediction. The sequences of the CRISPR-targeted viral contigs 
should be retrieved for the subsequent analyses. 
3.6.2 
tRNA Gene 
Matching 
tRNAs are an integral part of the cellular protein translation system. 
Certain archaeal viruses occasionally also encode host-derived 
tRNA genes [18, 108]. Therefore, the tRNA gene match between 
a virus and an archaeal genome is highly suggestive of a virus-host 
relationship. See an example of tRNA gene match between an 
archaeal virus and its host in Fig. 3. 
The tRNA genes encoded by viral contigs can be predicted 
using tRNAscan-SE 2.0 with “-A” option (archaeal mode): 
’tRNAscan-SE viral_contigs.fasta -A -o viral_tRNA.results -a vir-
al_tRNA.fasta’ 
The viral tRNA gene sequences should then be extracted and 
used as queries in BLASTn search against the GTDB archaeal 
sequences (or other archaeal sequence database with available tax-
onomy information). 
’makeblastdb
-in 
archaeal_seqs.fasta
-out 
nt_db/archaeal_seqs
-dbtype nucl’ 
’blastn -query viral_tRNA.fasta -db nt_db/archaeal_seqs -out 
Vir_tRNA_vs_ArSeqs.xls -outfmt 6 -word_size 16 -dust no
-qcov_hsp_perc 95 -perc_identity 95 -num_threads 48’ 
Hits with at least 95% coverage and 95% identity can be consid-
ered genuine matches, providing host assignments for the tRNA-
encoding viral contigs (see Note 11). 
3.6.3 
Matching of the 
Viral and Host Attachment 
Site(s) 
Many archaeal viruses with circular dsDNA genomes encode inte-
grases of the tyrosine recombinase superfamily and are commonly 
found as integrated proviruses within archaeal genomes [111– 
116]. The integration involves integrase-mediated homologous 
recombination between identical sequences of variable lengths on 
the viral and cellular genomes, known as the viral and archaeal 
attachment sites, attV and attA, respectively [115]. In the viral 
genome, the attV is typically located in the vicinity of or within 
the integrase gene, whereas the most common attA site occupies 
the 3′-proximal regions of the tRNA genes, although cases of 
integration into 5′-distal regions of tRNA genes, intergenic regions 
as 
well 
as 
protein-coding 
genes 
have 
been 
also 
described 
[112, 113]. The identity between the viral and archaeal attachment 
sites can be used for the host assignment for temperate viruses that 
integrate into the genome of their host [116]. See two examples of

attachment site sharing between archaeal viruses and their respec-
tive hosts in Fig. 4. 
10
Yifan Zhou et al.
Fig. 3 The tRNA-Lys gene encoded by the genome of Acidianus ﬁlamentous virus 2 shares 95% identity with a 
counterpart from the genome of Acidianus brierleyi strain DSM 1651 
Fig. 4 Examples of attachment sites located next to (a) and within (b) the integrase genes. (a) The attachment 
site of Methanocaldococcus fervens tailed virus 1 is located next to the gene encoding the λ-type integrase of 
the tyrosine recombinase superfamily (green) and is identical to the 3′-proximal region of the host’s tRNA-Ser 
gene (red). (b) The attachment site of Sulfolobus spindle-shaped virus 19 (SSV19) is located within its 
integrase gene (orange) and is identical to the 3′-proximal region of the host’s tRNA-Gly gene (red) 
To identify the attachment sites within the viral genomes, the 
integrase genes have to be identiﬁed ﬁrst. This can be done using 
batch protein annotation tools, such as Batch CD-Search or 
eggNOG-mapper v2. Once identiﬁed, the sequences of the viral

integrase genes along with the upstream and downstream noncod-
ing regions (≤ 500 bp) can be extracted and used as queries in 
BLASTn searches against archaeal sequences to detect the potential 
attachment sites. 
’blastn -query integrase_region.fasta -db nt_db/archaeal_seqs -out 
Vir_integrase_vs_ArSeqs.xls -outfmt 6 -word_size 6 -dust no -per-
c_identity 95 -num_threads 48’ 
Exploring the Archaeal Virosphere by Metagenomics
11
Hits with at least 95% coverage and 95% identity can be consid-
ered genuine matches (see Note 12). 
3.6.4 
MCP Homology 
Searches 
The ability to form virions distinguishes viruses from other types of 
mobile genetic elements and cellular organisms [117]. The major 
capsid proteins (MCP) are highly diverse, with some structurally 
related MCPs being widespread in viruses infecting hosts from 
different domains of life and others being speciﬁc to particular 
domains, including archaea [118]. Regardless, at the sequence 
level, MCPs are typically virus family or order speciﬁc. Therefore, 
homology searches using MCP as a signature protein has become 
one of the most commonly used approaches for the identiﬁcation of 
new prokaryotic viruses in metagenomic dataset [33, 36, 37, 109, 
119]. 
To assemble a database of archaeal virus MCPs, all archaeal 
virus protein sequences can be downloaded from the NCBI virus 
database 
(www.ncbi.nlm.nih.gov/labs/virus/vssi/#/) 
and 
the 
MCP sequences extracted. Once the MCP database is assembled, 
open reading frames in the metagenomic viral contigs can be pre-
dicted using the software Prodigal with “-p meta” option. The 
corresponding in silico translated protein sequences can then be 
used as BLASTp queries to search against the archaeal virus refer-
ence MCP database. 
’prodigal -i viral_contigs.fasta -a ORFs_viral_contigs.fasta -p meta’ 
’makeblastdb -in Ref_ArVir_MCPs.fasta -out prot_db/Ref_Ar-
Vir_MCPs -dbtype prot’ 
’blastp
-query 
ORFs_viral_contigs.fasta
-db 
prot_db/Ref_Ar-
Vir_MCPs -out viral_contigs_vs_Ref_ArVir_MCPs.blastp -eva-
lue 1e-5 -num_threads 48’ 
BLASTp hits with E-value <10-5 , ≥30% identity, ≥50% cover-
age, and ≥100 bit score can be considered signiﬁcant. The 
corresponding viral contigs should be extracted for further ana-
lyses. More accurate host assignment can be inferred from phylo-
genetic analysis of the MCP sequences from the reference viruses 
and viruses assembled from metagenomes.

12
Yifan Zhou et al.
3.6.5 
Host-Speciﬁc 
AMGs 
It is increasingly recognized that viruses can modulate the meta-
bolic processes within the infected prokaryotes by expressing auxil-
iary metabolic genes (AMGs) [12]. To efﬁciently tinker with the 
host metabolism, the virus-encoded versions of the metabolic genes 
are usually recognizably similar to the host homologs [37, 38]. This 
property offers a possibility to trace potential virus-host pairs from 
environmental samples by analyzing the virus-encoded AMGs. Fig-
ure 5 shows an example of high sequence similarity between the 
ammonia monooxygenase subunit C (AmoC) encoded by a virus 
and an archaeon, Nitrosopumilus maritimus. 
Viral AMGs can be predicted using the software DRAM-v, the 
mode of DRAM for viral sequences (see Note 13). 
’DRAM-v.py annotate -i viral-combined-for-dramv.fa -v viral-afﬁ-
contigs-for-dramv.tab -o dramv_annotate --skip_trnascan --
threads 48’ 
’DRAM-v.py distill -i dramv_annotate/annotations.tsv -o dramv-
distill’ 
Viral AMGs should then be extracted and used as BLASTp 
queries to search against the archaeal proteome. The archaeal pro-
teome database can be constructed using the following commands: 
’prodigal -i archaeal_seqs.fasta -a ORFs_archaeal_seqs.fasta -p meta’ 
’makeblastdb
-in 
ORFs_archaeal_seqs.fasta
-out 
prot_db/ 
archaeal_proteome’ 
Next, the viral AMGs should be assigned to speciﬁc archaeal 
species using the following command: 
’blastp -query viral_AMGs.fasta -db prot_db/archaeal_proteome -out 
Vir_AMGs_vs_ archaeal_proteome.blastp -evalue 1e-5 -num_th-
reads 48’ 
Hits with at least 90% identity and 90% coverage are considered 
particularly indicative of a virus-host relationship, whereas hits with 
lower sequence identity should be evaluated more cautiously. 
3.6.6 
Host-Prediction 
Tools (See Note 14) 
A number of host-prediction tools have been recently developed for 
prokaryotic viruses, e.g., HostG, WiSH, PHISDetector, RaFAH, 
iPHoP, and others. These tools rely on certain databases and yield 
results with host prediction with associated conﬁdence scores. 
Example (HostG): 
’python run_Speed_up.py --contigs viral_contigs.fasta --len 1000 --
t 0’  
Example (iPHoP): 
’iphop predict --fa_ﬁle viral_contigs.fasta --db_dir ~/iPHoP_db --
out_dir iphop_prediction --num_threads 48’

Exploring the Archaeal Virosphere by Metagenomics
13
Fig. 5 The ammonia monooxygenase subunit C encoded by the Nitrososphaeria virus YSH_124187 [33] shares 
97% protein sequence identity with the counterpart encoded by Nitrosopumilus maritimus SCM1 
In addition, the tool MArVD2 [130] has been speciﬁcally 
developed for the identiﬁcation of archaeal viruses from a set of 
viral contigs. 
’MArVD2.py -i viral_contigs.fasta -o marvd_prediction --db-pvog ~/ 
AllvogHMMproﬁles.hmm --db-nr ~/nr.faa --db-accession2tax ~/ 
prot.accession2taxid --marine-jackhmmer-db ~/pVOG_prots_-
ref_marine_pVOG.faa --viral-refseq-txt ~/viruses.txt --pvog-dir 
~/pVOGs --cpu-count 48 --load-model ~/rf_model.pkl’ 
3.7 
Genome 
Annotation 
All viral contigs can be automatically annotated using such tools as 
Batch CD-Search, eggNOG-mapper, or Pharokka. However, for 
comprehensive functional annotation of the complete or near-
complete archaeal virus genomes, it is advisable to use sensitive 
hidden Markov model (HMM) proﬁle–proﬁle comparisons with 
HHsearch v3.3.0 against the publicly available databases: CDD, 
Pfam, 
Protein 
Data 
Bank 
(PDB), 
uniprot_sprot_vir70, 
and 
PHROG. In the case of Caudoviricetes, viral structural proteins 
can be also predicted using VIRFAM. 
3.8 
Phylogenetic and 
Phylogenomic 
Analyses 
Relationships between related viruses can be assessed using differ-
ent methods, including single gene phylogenies, network, or phy-
logenomic analyses as brieﬂy detailed below. 
3.8.1 
Phylogenetic 
Analysis 
For the purpose of understanding the relationship between evolu-
tionarily related viruses, a protein conserved in a given group of 
viruses has to be selected. The commonly used viral hallmark 
proteins include MCP, portal protein, or large subunit of the 
terminase and other genome packaging ATPases. The protein 
sequences 
can 
be 
aligned 
using 
tools 
such 
as 
MUSCLE, 
T-COFFEE, or PROMALS3D, followed by removal of highly 
divergent, uninformative positions, e.g., using trimAl. Maximum

likelihood phylogenetic trees can be constructed using IQ-tree or 
PhyML. Both IQ-tree and PhyML can select the amino acid sub-
stitution model best ﬁtting the given dataset. In the case of very 
large datasets, approximate maximum likelihood trees can be calcu-
lated using FastTree. The phylogenies can be annotated and visua-
lized using iTOL v5 or Evolview v3. 
14
Yifan Zhou et al.
3.8.2 
Gene-Sharing 
Networks 
The relationships between the identiﬁed archaeal and other known 
prokaryotic viruses can be assessed using network analysis. vCon-
TACT2 can be used to generate the gene-sharing networks with the 
latest prokaryotic virus database. Given that nodes (viral genomes) 
are connected only when they share three gene families, ideally, the 
length of input viral sequences should exceed 10 kb. Alternatively, 
the relationships between the viral genomes can be explored using 
bipartite networks, which include two types of nodes, viral gen-
omes (type 1 nodes) connected through shared gene families (type 
2 nodes) [120]. The resulting networks can be visualized using 
Cytoscape. 
3.8.3 
Viral Proteomic 
Tree 
A virus proteomic tree is a dendrogram that represents global 
genomic relationships between viral sequences calculated from a 
comparison of all protein sequences encoded by a given set of 
viruses. The viral proteomic tree generally corresponds well with 
the established virus taxonomy [33, 35]. The virus proteomic tree 
can be calculated for any given dataset using ViPTree, which can be 
either locally installed or run through the web server (see Note 15). 
3.8.4 
Estimation of the 
Orthologous Protein 
Fraction 
For classiﬁcation purposes, it is useful to know the fraction of genes 
shared with other viruses (i.e., the degree of relatedness between 
viruses). For example, members of head-tailed archaeal viruses of 
the same family in the class Caudoviricetes generally share ~20–50% 
of orthologous genes, while viruses from different families share 
less than 10% [18]. The fraction of orthologous proteins can be 
estimated using the CompareM software toolkit with the following 
command: 
’comparem aai_wf -e 0.0001 -p 30 -a 50 -c 4 ~/seqs output_results’ 
Based on the results (see Note 16), taxonomic classiﬁcation can 
be tentatively assigned to the sequenced viruses according to the 
established taxon-speciﬁc demarcation criteria. It is important to 
note that depending on the virus group, different parameters can 
be adopted, resulting in different estimates of the orthologous 
fractions. 
3.9 
Abundance and 
Distribution 
To gain ecological and evolutionary insights into how archaeal 
viruses interact with their hosts and environments, it is important 
to explore the distribution and abundance of these viruses in

different ecosystems. This information can be obtained by recruit-
ing sequencing reads from metagenomes to the identiﬁed archaeal 
virus genomes, using read mappers, such as Bowtie2 or Geneious. 
Exploring the Archaeal Virosphere by Metagenomics
15
Example (Bowtie2): 
’bowtie2-build ref_virus.fasta ref_virus’ 
’bowtie2 -x ref_virus -1 clean_R1.fastq -2 clean_R2.fastq -S results. 
sam’ 
The relative abundance of viruses in any particular sample or 
environment can be estimated by mapping the sequence reads from 
a metavirome to the reference genomes and expressed as Reads 
recruited Per Kb of genome per Gb of metagenome (RPKG). This 
way, the sequencing depth is normalized and is comparable to the 
distribution 
and 
abundance 
of 
the 
viruses 
in 
different 
environments. 
4 
Notes 
1. The sample is passed through the TFF system by using a 
peristaltic pump and the pressure of the ﬂow within the system 
should always be kept below 10 p.s.i. (62 kPa) to avoid the 
disruption of the viral particles [89]. 
2. One should consider the pH of the water sample to choose the 
corresponding ﬁlters. Ideally, all ﬁltration operations should be 
conducted in a cold room to minimize the enzymatic degrada-
tion of virus particles and/or nucleic acids. Reservoirs, e.g., 
500 mL ﬂasks or bottles and 10-, 25-, and 100-liter plastic 
containers, should be sterilized before use. 
3. Filter the obtained viral concentrate through a 0.22 μm pore 
size ﬁlter to remove any potentially remaining prokaryotes. The 
absence of cells in the virus concentrate and the number of 
puriﬁed virus particles can be veriﬁed by ﬂuorescence micros-
copy after staining of an aliquot of the sample with nucleic-
acid-staining ﬂuorescent dyes, such SYBR Green or DAPI 
(4′,6-diamidino-2-phenylindole), 
as 
described 
previously 
[123–125]. 
4. The majority of “free” DNA should be ﬁltered out during the 
process of virus concentration. Nevertheless, an additional step 
of DNase treatment prior to the extraction of the viral DNA 
from the virus particles can be performed to further reduce the 
contamination of the preparation with cellular DNA [124]. 
5. The result of reads quality control can be visualized as graphical 
and statistical reports by FastQC (www.bioinformatics. 
babraham.ac.uk/projects/fastqc/).

16
Yifan Zhou et al.
6. For tools that are reference-based, it is necessary to apply the 
most updated databases. For more reliable identiﬁcation of 
viral contigs, at least two different tools can be used in parallel. 
7. It is advisable to manually check the mapping of assembled 
reads to avoid the possible mis-assembly. 
8. For reporting sequences of uncultivated virus genomes, the 
genome quality is one of the requirements by the Minimum 
Information about an uncultivated virus genome (MIUViG), 
with other qualiﬁers being information about virus origin, 
assembly tool, virus identiﬁcation software, genome type, tax-
onomic classiﬁcation, biogeographic distribution, and in silico 
host prediction [125]. For recommendations on ofﬁcial classi-
ﬁcation of uncultivated viruses, see [126]. 
9. Since the default BLASTn parameters are not optimal for short 
sequences (e.g., 30 bp), it is recommended to use a word size of 
7 and dust ﬁltering turned off to identify the targets of CRISPR 
spacers [127, 128]. 
10. Although highly reliable, the CRISPR-targeting host assign-
ment approach is dependent on the richness of the CRISPR 
spacer database available for a particular host organism. To 
further enrich the spacer database, one may consider extracting 
spacers from taxonomically unclassiﬁed sequences by identify-
ing group-speciﬁc CRISPRs (e.g., Asgard-archaea-speciﬁc 
CRISPRs [26]). In parallel or alternatively, additional CRISPR 
spacers for the archaeal groups of interest can be recovered by 
amplifying CRISPR arrays with CRISPR-speciﬁc PCR primers 
from the environmental sample from which viral metagenome 
is being prepared (e.g., [129]). 
11. The tRNA genes of unknown viruses (here, the extracted viral 
contigs) can be also searched against the tRNA genes of viruses 
for which the hosts have been assigned. The shared tRNA 
genes could indicate that the two viruses infected the 
same host. 
12. Some attachment sites are as short as 8 bp [112], but such hits 
can hardly be considered signiﬁcant without further validation. 
Thus, to avoid short random matches and to improve the 
speciﬁcity of this host assignment method, we recommend 
using matches with nucleotide alignment length not shorter 
than 25 bp. 
13. Follow this Standard Operating Procedure www.protocols.io/ 
view/viral-sequence-identiﬁcation-sop-with-virsorter2-
5qpvoyqebg4o/v3. 
14. The performance of these host-prediction tools depends on the 
representation of the actual host organism within the initial 
training and reference dataset. Thus, it is important to make

Exploring the Archaeal Virosphere by Metagenomics
17
sure that the suspected host species are included in the training 
dataset. Otherwise, reasonable results are hardly to be 
expected. We recommend using these predictions in combina-
tion with other methods. 
15. ViPTree web server also provides an informative genome map 
visualization useful for comparative genomics. Genome maps 
can be also compared using Easyﬁg or Clinker. 
16. The output ﬁle of compareM can be converted into a matrix 
using tidyr (R package) and visualized using pheatmap 
(R package). 
Acknowledgments 
YW was supported by the National Natural Science Foundation of 
China (41376135, 31570112, and 41876195). The preparation of 
this chapter was supported by the Emergence(s) project MEM-
REMA from Ville de Paris to MK. 
References 
1. Zaremba-Niedzwiedzka K, Caceres EF, Saw 
JH et al (2017) Asgard archaea illuminate the 
origin 
of 
eukaryotic 
cellular 
complexity. 
Nature 541:353–358 
2. Liu Y, Makarova KS, Huang WC et al (2021) 
Expanded diversity of Asgard archaea and 
their relationships with eukaryotes. Nature 
593:553–557 
3. Baker BJ, De Anda V, Seitz KW et al (2020) 
Diversity, ecology and evolution of Archaea. 
Nat Microbiol 5:887–900 
4. Arbab S, Ullah H, Khan MIU et al (2022) 
Diversity and distribution of thermophilic 
microorganisms and their applications in bio-
technology. J Basic Microbiol 62:95–108 
5. Danovaro R, Rastelli E, Corinaldesi C et al 
(2017) Marine archaea and archaeal viruses 
under global change. F1000Res 6:1241 
6. Offre P, Spang A, Schleper C (2013) Archaea 
in biogeochemical cycles. Annu Rev Micro-
biol 67:437–457 
7. Zou D, Liu H, Li M (2020) Community, 
distribution, and ecological roles of estuarine 
archaea. Front Microbiol 11:2060 
8. Adam PS, Borrel G, Brochier-Armanet C et al 
(2017) The growing tree of Archaea: new 
perspectives on their diversity, evolution and 
ecology. ISME J 11:2407–2425 
9. Ogunrinola GA, Oyewale JO, Oshamika OO 
et al (2020) The human microbiome and its 
impacts on health. Int J Microbiol 2020: 
8045646 
10. Wigington CH, Sonderegger D, Brussaard 
CP et al (2016) Re-examination of the rela-
tionship between marine virus and microbial 
cell abundances. Nat Microbiol 1:15024 
11. Suttle 
CA 
(2007) 
Marine 
viruses–major 
players in the global ecosystem. Nat Rev 
Microbiol 5:801–812 
12. Breitbart M, Bonnain C, Malki K et al (2018) 
Phage puppet masters of the marine microbial 
realm. Nat Microbiol 3:754–766 
13. Jurgensen SK, Roux S, Schwenck SM et al 
(2022) Viral community analysis in a marine 
oxygen minimum zone indicates increased 
potential for viral manipulation of microbial 
physiological state. ISME J 16:972–982 
14. Kieft K, Zhou Z, Anderson RE et al (2021) 
Ecology of inorganic sulfur auxiliary metabo-
lism in widespread bacteriophages. Nat Com-
mun 12:3503 
15. Jacobson 
TB, 
Callaghan 
MM, 
Amador-
Noguez D (2021) Hostile takeover: how 
viruses reprogram prokaryotic metabolism. 
Annu Rev Microbiol 75:515–539 
16. Danovaro R, Dell’Anno A, Corinaldesi C et al 
(2016) Virus-mediated archaeal hecatomb in 
the deep seaﬂoor. Sci Adv 2:e1600492 
17. Lee S, Sieradzki ET, Nicol GW et al (2023) 
Propagation of viral genomes by replicating

l
18
Yifan Zhou et al.
ammonia-oxidising archaea during soil nitriﬁ-
cation. ISME J 17:309–314 
18. Liu Y, Demina TA, Roux S et al (2021) Diver-
sity, taxonomy, and evolution of archaeal 
viruses of the class Caudoviricetes. PLoS Biol 
19:e3001442 
19. Baquero DP, Liu Y, Wang F et al (2020) 
Structure and assembly of archaeal viruses. 
Adv Virus Res 108:127–164 
20. Munson-McGee JH, Snyder JC, Young MJ 
(2018) 
Archaeal 
viruses 
from 
high-
temperature environments. Genes 9(3):128 
21. Demina TA, Pietil€a MK, Svirskaite˙ J et a  
(2017) HCIV-1 and other tailless icosahedral 
internal membrane-containing viruses of the 
family Sphaerolipoviridae. Viruses 9(2):32 
22. Aulitto M, Martinez-Alvarez L, Fusco S et al 
(2022) Genomics, transcriptomics, and pro-
teomics of SSV1 and related fusellovirus: a 
minireview. Viruses 14(10):2082 
23. Luk AW, Williams TJ, Erdmann S et al (2014) 
Viruses of haloarchaea. Life (Basel) 4:681– 
715 
24. Kim JG, Kim SJ, Cvirkaite-Krupovic V et al 
(2019) Spindle-shaped viruses infect marine 
ammonia-oxidizing thaumarchaea. Proc Natl 
Acad Sci U S A 116:15645–15650 
25. Weidenbach K, Nickel L, Neve H et al (2017) 
Methanosarcina 
spherical 
virus, 
a 
novel 
archaeal lytic virus targeting methanosarcina 
strains. J Virol 91:e00955-17 
26. Medvedeva S, Sun J, Yutin N et al (2022) 
Three families of Asgard archaeal viruses iden-
tiﬁed in metagenome-assembled genomes. 
Nat Microbiol 7:962–973 
27. Rambo IM, Langwig MV, Lea˜o P et al (2022) 
Genomes of six viruses that infect Asgard 
archaea from deep-sea sediments. Nat Micro-
biol 7:953–961 
28. Tamarit D, Caceres EF, Krupovic M et al 
(2022) A closed Candidatus Odinarchaeum 
chromosome exposes Asgard archaeal viruses. 
Nat Microbiol 7:948–952 
29. Wu F, Speth DR, Philosof A et al (2022) 
Unique mobile elements and scalable gene 
ﬂow at the prokaryote-eukaryote boundary 
revealed by circularized Asgard archaea gen-
omes. Nat Microbiol 7:200–212 
30. Laso-Pe´rez R, Wu F, Cre´mie`re A et al (2023) 
Evolutionary 
diversiﬁcation 
of 
methano-
trophic 
Ca. 
Methanophagales 
(ANME-1) 
and their expansive virome. Nat Microbiol 8: 
231–245 
31. Li R, Wang Y, Hu H et al (2022) Metage-
nomic analysis reveals unexplored diversity of 
archaeal virome in the human gut. Nat Com-
mun 13:7978 
32. Ngo VQH, Enault F, Midoux C et al (2022) 
Diversity of novel archaeal viruses infecting 
methanogens discovered through coupling 
of stable isotope probing and metagenomics. 
Environ Microbiol 24:4853–4868 
33. Medvedeva S, Borrel G, Krupovic M et al 
(2023) A compendium of viruses from metha-
nogenic archaea reveals their diversity and 
adaptations to the gut environment. Nat 
Microbiol
doi:
10.1038/s41564-023-
01485-w 
34. Zhou Y, Zhou L, Yan S et al (2023) Diverse 
viruses of marine archaea discovered using 
metagenomics. Environ Microbiol 25:367– 
382 
35. Philosof A, Yutin N, Flores-Uribe J et al 
(2017) Novel abundant oceanic viruses of 
uncultured marine group II euryarchaeota. 
Curr Biol 27:1362–1368 
36. Nishimura Y, Watai H, Honda T et al (2017) 
Environmental viral genomes shed new light 
on 
virus-host 
interactions 
in 
the 
ocean. 
mSphere 2:e00359–16 
37. Lo´pez-Pe´rez M, Haro-Moreno JM, de la 
Torre JR et al (2019) Novel Caudovirales 
associated with Marine Group I Thaumarch-
aeota assembled from metagenomes. Environ 
Microbiol 21:1980–1988 
38. Ahlgren NA, Fuchsman CA, Rocap G et al 
(2019) Discovery of several novel, wide-
spread, and ecologically distinct marine Thau-
marchaeota 
viruses 
that 
encode 
amoC 
nitriﬁcation genes. ISME J 13:618–631 
39. Roux S, Brum JR, Dutilh BE et al (2016) 
Ecogenomics and potential biogeochemical 
impacts of globally abundant ocean viruses. 
Nature 537:689–693 
40. Rahlff J, Turzynski V, Esser SP et al (2021) 
Lytic archaeal viruses infect abundant primary 
producers in Earth’s crust. Nat Commun 12: 
4642 
41. Chen S, Zhou Y, Chen Y et al (2018) fastp: an 
ultra-fast 
all-in-one 
FASTQ 
preprocessor. 
Bioinformatics 34:i884–i890 
42. Bolger AM, Lohse M, Usadel B (2014) Trim-
momatic: a ﬂexible trimmer for Illumina 
sequence data. Bioinformatics 30:2114–2120 
43. Li D, Liu CM, Luo R et al (2015) MEGA-
HIT: an ultra-fast single-node solution for 
large and complex metagenomics assembly 
via succinct de Bruijn graph. Bioinformatics 
31:1674–1676 
44. Nurk S, Meleshko D, Korobeynikov A et al 
(2017) metaSPAdes: a new versatile metage-
nomic assembler. Genome Res 27:824–834

Exploring the Archaeal Virosphere by Metagenomics
19
45. Camacho C, Coulouris G, Avagyan V et al 
(2009) BLAST+: architecture and applica-
tions. BMC Bioinformatics 10:421 
46. Guo J, Bolduc B, Zayed AA et al (2021) 
VirSorter2: a multi-classiﬁer, expert-guided 
approach to detect diverse DNA and RNA 
viruses. Microbiome 9:37 
47. Kieft K, Zhou Z, Anantharaman K (2020) 
VIBRANT: automated recovery, annotation 
and curation of microbial viruses, and evalua-
tion of viral community function from geno-
mic sequences. Microbiome 8:90 
48. Ren J, Song K, Deng C et al (2020) Identify-
ing viruses from metagenomic data using 
deep learning. Quant Biol 8:64–77 
49. Tisza MJ, Belford AK, Domı´nguez-Huerta G 
et al (2021) Cenote-Taker 2 democratizes 
virus discovery and sequence annotation. 
Virus Evol 7:veaa100 
50. Deng Z, Delwart E (2021) ContigExtender: a 
new approach to improving de novo sequence 
assembly for viral metagenomics data. BMC 
Bioinformatics 22:119 
51. Nayfach S, Camargo AP, Schulz F et al (2021) 
CheckV assesses the quality and completeness 
of metagenome-assembled viral genomes. Nat 
Biotechnol 39:578–585 
52. Couvin D, Bernheim A, Toffano-Nioche C 
et al (2018) CRISPRCasFinder, an update of 
CRISRFinder, includes a portable version, 
enhanced performance and integrates search 
for Cas proteins. Nucleic Acids Res 46:W246– 
W251 
53. Biswas A, Staals RH, Morales SE et al (2016) 
CRISPRDetect: a ﬂexible algorithm to deﬁne 
CRISPR arrays. BMC Genomics 17:356 
54. Fu L, Niu B, Zhu Z et al (2012) CD-HIT: 
accelerated for clustering the next-generation 
sequencing data. Bioinformatics 28:3150– 
3152 
55. Chan Patricia P, Lin Brian Y, Mak Allysia J 
et al (2021) tRNAscan-SE 2.0: improved 
detection 
and 
functional 
classiﬁcation 
of 
transfer RNA genes. Nucleic Acids Res 49: 
9077–9096 
56. Lu S, Wang J, Chitsaz F et al (2020) 
CDD/SPARCLE: 
the 
conserved 
domain 
database in 2020. Nucleic Acids Res 48: 
D265–d268 
57. Cantalapiedra CP, Herna´ndez-Plaza A, Letu-
nic I et al (2021) eggNOG-mapper v2: func-
tional annotation, orthology assignments, 
and domain prediction at the metagenomic 
scale. Mol Biol Evol 38:5825–5829 
58. Huerta-Cepas J, Szklarczyk D, Heller D et al 
(2019) eggNOG 5.0: a hierarchical, function-
ally and phylogenetically annotated orthology 
resource based on 5090 organisms and 2502 
viruses. Nucleic Acids Res 47:D309–D314 
59. Shaffer M, Borton MA, McGivern BB et al 
(2020) DRAM for distilling microbial metab-
olism to automate the curation of microbiome 
function. Nucleic Acids Res 48:8883–8900 
60. Shang J, Sun Y (2021) Predicting the hosts of 
prokaryotic viruses using GCN-based semi-
supervised learning. BMC Biol 19:250 
61. Vik D, Bolduc B, Roux S et al (2023) 
MArVD2: a machine learning enhanced tool 
to discriminate between archaeal and bacterial 
viruses in viral datasets. ISME Commun 3(1): 
87 
62. Galiez 
C, 
Siebert 
M, 
Enault 
F 
et 
al 
(2017) WIsH: who is the host? Predicting 
prokaryotic hosts from metagenomic phage 
contigs. Bioinformatics 33:3113–3114 
63. Zhou F, Gan R, Zhang F et al (2022) PHIS-
Detector: a tool to detect diverse in silico 
phage-host interaction signals for virome 
studies. Genomics Proteomics Bioinformatics 
20:508–523 
64. Coutinho FH, Zaragoza-Solas A, Lo´pez-
Pe´rez M et al (2021) RaFAH: Host prediction 
for viruses of bacteria and archaea based on 
protein content. Patterns 2:100274 
65. Bouras G, Nepal R, Houtak G et al (2023) 
Pharokka: a fast scalable bacteriophage anno-
tation tool. Bioinformatics 39:btac776 
66. Steinegger M, Meier M, Mirdita M et al 
(2019) HH-suite3 for fast remote homology 
detection and deep protein annotation. BMC 
Bioinformatics 20:473 
67. Lopes A, Tavares P, Petit MA et al (2014) 
Automated classiﬁcation of tailed bacterio-
phages according to their neck organization. 
BMC Genomics 15:1027 
68. Di Tommaso P, Moretti S, Xenarios I et al 
(2011) T-Coffee: a web server for the multi-
ple sequence alignment of protein and RNA 
sequences using structural information and 
homology extension. Nucleic Acids Res 39: 
W13–W17 
69. Edgar RC (2004) MUSCLE: a multiple 
sequence alignment method with reduced 
time and space complexity. BMC Bioinfor-
matics 5:113 
70. Pei J, Kim BH, Grishin NV (2008) PRO-
MALS3D: 
a 
tool 
for 
multiple 
protein 
sequence and structure alignments. Nucleic 
Acids Res 36:2295–2300 
71. Capella-Gutie´rrez 
S, 
Silla-Martı´nez 
JM, 
Gabaldo´n T (2009) trimAl: a tool for auto-
mated alignment trimming in large-scale phy-
logenetic analyses. Bioinformatics 25:1972– 
1973

20
Yifan Zhou et al.
72. Guindon S, Dufayard JF, Lefort Vet al (2010) 
New algorithms and methods to estimate 
maximum-likelihood phylogenies: assessing 
the performance of PhyML 3.0. Syst Biol 59: 
307–321 
73. Price MN, Dehal PS, Arkin AP (2010) Fas-
tTree 2--approximately maximum-likelihood 
trees for large alignments. PLoS One 5:e9490 
74. Nguyen LT, Schmidt HA, von Haeseler A 
et al (2015) IQ-TREE: a fast and effective 
stochastic
algorithm
for
estimating 
maximum-likelihood phylogenies. Mol Biol 
Evol 32:268–274 
75. Letunic I, Bork P (2021) Interactive tree of 
life (iTOL) v5: an online tool for phylogenetic 
tree display and annotation. Nucleic Acids Res 
49:W293–W296 
76. Subramanian B, Gao S, Lercher MJ et al 
(2019) Evolview v3: a webserver for visualiza-
tion, annotation, and management of phylo-
genetic trees. Nucleic Acids Res 47:W270– 
W275 
77. Bin Jang H, Bolduc B, Zablocki O et al 
(2019) Taxonomic assignment of unculti-
vated prokaryotic virus genomes is enabled 
by gene-sharing networks. Nat Biotechnol 
37:632–639 
78. Sullivan MJ, Petty NK, Beatson SA (2011) 
Easyﬁg: a genome comparison visualizer. Bio-
informatics 27:1009–1010 
79. Gilchrist CLM, Chooi YH (2021) Clinker & 
clustermap.js: automatic generation of gene 
cluster comparison ﬁgures. Bioinformatics 
37(16):2473–2475 
80. Shannon P, Markiel A, Ozier O et al (2003) 
Cytoscape: 
a 
software 
environment 
for 
integrated models of biomolecular interaction 
networks. Genome Res 13:2498–2504 
81. Nishimura Y, Yoshida T, Kuronishi M et al 
(2017) ViPTree: the viral proteomic tree 
server. Bioinformatics 33:2379–2380 
82. Langmead 
B, 
Salzberg 
SL 
(2012) 
Fast 
gapped-read alignment with Bowtie 2. Nat 
Methods 9:357–359 
83. Belilla J, Moreira D, Jardillier L et al (2019) 
Hyperdiverse archaea near life limits at the 
polyextreme geothermal Dallol area. Nat 
Ecol Evol 3:1552–1561 
84. Xie W, Luo H, Murugapiran SK et al (2018) 
Localized high abundance of Marine Group II 
archaea in the subtropical Pearl River Estuary: 
implications for their niche adaptation. Envi-
ron Microbiol 20:734–754 
85. Inskeep WP, Rusch DB, Jay ZJ et al (2010) 
Metagenomes from high-temperature che-
motrophic 
systems 
reveal 
geochemical 
controls on microbial community structure 
and function. PLoS One 5:e9773 
86. Kambourova M, Tomova I, Boyadzhieva I 
et al (2016) Unusually high archaeal diversity 
in a crystallizer pond, pomorie salterns, 
Bulgaria, revealed by phylogenetic analysis. 
Archaea 2016:7459679 
87. Oren A (2020) The microbiology of red 
brines. Adv Appl Microbiol 113:57–110 
88. Hurwitz BL, Deng L, Poulos BT et al (2013) 
Evaluation of methods to concentrate and 
purify ocean virus communities through com-
parative, replicated metagenomics. Environ 
Microbiol 15:1428–1440 
89. John SG, Mendez CB, Deng L et al (2011) A 
simple and efﬁcient method for concentration 
of ocean viruses by chemical ﬂocculation. 
Environ Microbiol Rep 3:195–202 
90. Santos F, Yarza P, Parro V et al (2010) The 
metavirome of a hypersaline environment. 
Environ Microbiol 12:2965–2976 
91. Thurber RV, Haynes M, Breitbart M et al 
(2009) Laboratory procedures to generate 
viral metagenomes. Nat Protoc 4:470–483 
92. Zablocki O, van Zyl LJ, Kirby B et al (2017) 
Diversity of dsDNA viruses in a South African 
hot spring assessed by metagenomics and 
microscopy. Viruses 9(11):348 
93. Wu S, Zhou L, Zhou Y et al (2020) Diverse 
and unique viruses discovered in the surface 
water of the East China Sea. BMC Genomics 
21:441 
94. Koonin EV, Krupovic M, Agol VI (2021) The 
Baltimore classiﬁcation of viruses 50 years 
later: how does it stand in the light of virus 
evolution? 
Microbiol 
Mol 
Biol 
Rev 
85: 
e0005321 
95. Liu Y, Brandt D, Ishino S et al (2019) New 
archaeal viruses discovered by metagenomic 
analysis of viral communities in enrichment 
cultures. Environ Microbiol 21:2002–2014 
96. Adriaenssens EM, van Zyl LJ, Cowan DA et al 
(2016) 
Metaviromics 
of 
Namib 
Desert 
salt pans: a novel lineage of haloarchaeal salt-
erproviruses and a rich source of ssDNA 
viruses. Viruses 8(1):14 
97. Schoenfeld T, Patterson M, Richardson PM 
et al (2008) Assembly of viral metagenomes 
from yellowstone hot springs. Appl Environ 
Microbiol 74:4164–4174 
98. Poulos BT, John SG, Sullivan MB (2018) 
Iron chloride ﬂocculation of bacteriophages 
from seawater. Methods Mol Biol 1681:49– 
57 
99. Rhoads A, Au KF (2015) PacBio sequencing 
and its applications. Genomics Proteomics 
Bioinformatics 13:278–289

Exploring the Archaeal Virosphere by Metagenomics
21
100. Chiang YN, Penade´s JR, Chen J (2019) 
Genetic transduction by phages and chromo-
somal islands: the new and noncanonical. 
PLoS Pathog 15:e1007878 
101. Liu J, Soler N, Gorlas A et al (2021) Extracel-
lular membrane vesicles and nanotubes in 
Archaea. Microlife 2:uqab007 
102. Gaudin M, Krupovic M, Marguet E et al 
(2014) Extracellular membrane vesicles har-
bouring viral genomes. Environ Microbiol 
16:1167–1175 
103. Choi DH, Kwon YM, Chiura HX et al (2015) 
Extracellular vesicles of the hyperthermo-
philic archaeon “thermococcus onnurineus” 
NA1T. Appl Environ Microbiol 81:4591– 
4599 
104. Liu J, Cvirkaite-Krupovic V, Commere PH 
et al (2021) Archaeal extracellular vesicles 
are produced in an ESCRT-dependent man-
ner and promote gene transfer and nutrient 
cycling in extreme environments. ISME J 15: 
2892–2905 
105. Simpson JT, Pop M (2015) The theory and 
practice of genome sequence assembly. Annu 
Rev Genomics Hum Genet 16:153–172 
106. Li Z, Chen Y, Mu D et al (2012) Comparison 
of the two major classes of assembly algo-
rithms: overlap-layout-consensus and de-b-
ruijn-graph. Brief Funct Genomics 11:25–37 
107. Simmonds P, Adams MJ, Benko M et al 
(2017) Consensus statement: virus taxonomy 
in the age of metagenomics. Nat Rev Micro-
biol 15:161–168 
108. Makarova KS, Wolf YI, Iranzo J et al (2020) 
Evolutionary classiﬁcation of CRISPR-Cas 
systems: a burst of class 2 and derived variants. 
Nat Rev Microbiol 18:67–83 
109. Baquero DP, Contursi P, Piochi M et al 
(2020) New virus isolates from Italian hydro-
thermal environments underscore the bio-
geographic 
pattern 
in 
archaeal 
virus 
communities. ISME J 14:1821–1833 
110. Sencilo A, Jacobs-Sera D, Russell DA et al 
(2013) Snapshot of haloarchaeal tailed virus 
genomes. RNA Biol 10:803–816 
111. Krupovic M, Forterre P, Bamford DH (2010) 
Comparative analysis of the mosaic genomes 
of tailed archaeal viruses and proviruses sug-
gests common themes for virion architecture 
and assembly with tailed viruses of bacteria. J 
Mol Biol 397:144–160 
112. Held NL, Whitaker RJ (2009) Viral biogeog-
raphy revealed by signatures in Sulfolobus 
islandicus genomes. Environ Microbiol 11: 
457–466 
113. Medvedeva S, Brandt D, Cvirkaite-Krupovic 
V et al (2021) New insights into the diversity 
and evolution of the archaeal mobilome from 
three complete genomes of Saccharolobus 
shibatae. Environ Microbiol 23:4612–4630 
114. Krupovic M, Makarova KS, Wolf YI et al 
(2019) Integrated mobile genetic elements 
in Thaumarchaeota. Environ Microbiol 21: 
2056–2078 
115. Krupovic M, Bamford DH (2008) Archaeal 
proviruses 
TKV4 
and 
MVV extend 
the 
PRD1-adenovirus lineage to the phylum Eur-
yarchaeota. Virology 375:292–300 
116. Wang J, Liu Y, Liu Y et al (2018) A novel 
family of tyrosine integrases encoded by the 
temperate pleolipovirus SNJ2. Nucleic Acids 
Res 46:2521–2536 
117. Badel C, Da Cunha V, Oberto J (2021) 
Archaeal 
tyrosine 
recombinases. 
FEMS 
Microbiol Rev 45:fuab004 
118. Mizuno CM, Rodriguez-Valera F, Kimes NE 
et al (2013) Expanding the marine virosphere 
using 
metagenomics. 
PLoS 
Genet 
9: 
e1003987 
119. Koonin EV, Dolja VV, Krupovic M et al 
(2021) Viruses deﬁned by the position of 
the virosphere within the replicator space. 
Microbiol Mol Biol Rev 85:e0019320 
120. Krupovic M, Koonin EV (2017) Multiple ori-
gins of viral capsid proteins from cellular 
ancestors. Proc Natl Acad Sci U S A 114: 
E2401–e2410 
121. Zhou J, Zhang W, Yan S et al (2013) Diversity 
of virophages in metagenomic data sets. J 
Virol 87:4225–4236 
122. Iranzo J, Koonin EV, Prangishvili D et al 
(2016) Bipartite network analysis of the 
archaeal virosphere: evolutionary connections 
between viruses and capsidless mobile ele-
ments. J Virol 90:11043–11055 
123. Patel A, Noble RT, Steele JA et al (2007) 
Virus 
and 
prokaryote 
enumeration 
from 
planktonic aquatic environments by epiﬂuor-
escence microscopy with SYBR green I. Nat 
Protoc 2:269–276 
124. Anto´n J, Llobet-Brossa E, Rodrı´guez-Valera 
F et al (1999) Fluorescence in situ hybridiza-
tion analysis of the prokaryotic community 
inhabiting crystallizer ponds. Environ Micro-
biol 1:517–523 
125. Rachel TN, Jed AF (1998) Use of SYBR 
Green I for rapid epiﬂuorescence counts of 
marine viruses and bacteria. Aquat Microb 
Ecol 14:113–118 
126. Allander T, Emerson SU, Engle RE et al 
(2001) A virus discovery method incorporat-
ing DNase treatment and its application to 
the identiﬁcation of two bovine parvovirus

22
Yifan Zhou et al.
species. Proc Natl Acad Sci U S A 98:11609– 
11614 
127. Roux S, Adriaenssens EM, Dutilh BE et al 
(2019) 
Minimum 
Information 
about 
an 
Uncultivated Virus Genome (MIUViG). Nat 
Biotechnol 37:29–37 
128. Dutilh BE, Varsani A, Tong Y et al (2021) 
Perspective on taxonomic classiﬁcation of 
uncultivated viruses. Curr Opin Virol 51: 
207–215 
129. Biswas A, Gagnon JN, Brouns SJ et al (2013) 
CRISPRTarget: bioinformatic prediction and 
analysis of crRNA targets. RNA Biol 10:817– 
827 
130. Edwards RA, McNair K, Faust K et al (2016) 
Computational 
approaches 
to 
predict 
bacteriophage-host 
relationships. 
FEMS 
Microbiol Rev 40:258–272 
131. Medvedeva S, Liu Y, Koonin EV et al (2019) 
Virus-borne mini-CRISPR arrays are involved 
in interviral conﬂicts. Nat Commun 10:5204

Chapter 2 
From Whole Genome Shotgun Sequencing to Viral 
Community Proﬁling: The ViromeScan Tool 
Simone Rampelli, Silvia Turroni, and Marco Candela 
Abstract 
ViromeScan is an innovative metagenomic analysis tool that allows characterizing the taxonomy of viral 
communities from raw data of metagenomics sequencing, efﬁciently denoising samples from reads of other 
microorganisms. This means that users can use the same shotgun metagenomic sequencing data to fully 
characterize complex microbial ecosystems, including bacteria and viruses. Here we describe the analysis 
procedure with some examples, illustrating the processes computed by ViromeScan from raw data to the 
ﬁnal output. 
Key words Virome, Shotgun metagenomics, Sequencing, Bioinformatics, Pipeline 
1 
Introduction 
The most advanced experimental procedures for proﬁling the vir-
ome include isolation and extraction of the encapsidated viral frac-
tion [1–3] and only at a later stage, sequencing and characterization 
of the viral community by assembled or read-mapping strategies 
[4–7]. An emerging possibility is to detect the viral reads directly 
from shotgun metagenomic sequence data, without the need for 
preparative procedures. In particular, sequencing unprocessed sam-
ples and directly assigning the taxonomy to the obtained reads 
allow for a faster and more reliable proﬁling of the virome, in the 
context of the microbiome of origin, without the risk of missing 
information during the extraction step, as already demonstrated for 
giant viruses [8]. However, metagenomic reads contain nucleic acid 
fragments from several microorganisms, including bacteria, archae-
bacteria, eukaryotes, phages, and eukaryotic viruses, moving the 
experimental challenge on how to discriminate viral reads when 
mixed with sequences belonging to other organisms. ViromeScan 
is an innovative bioinformatics tool that accurately proﬁles viral 
communities directly from data of metagenomic sequencing,
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_2, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
23

responding to the previous issue through a set of consecutive 
bioinformatic ﬁlters, which select and discard the metagenomic 
reads of human and bacterial origin [9]. ViromeScan works with 
shotgun reads and detects the presence of DNA and/or RNA 
viruses, depending on the input sequences to be processed. By 
default, ViromeScan proﬁles the eukaryotic viral community within 
the microbiome, but it could be implemented and/or personalized, 
by supplying a customized hierarchical reference database. A new 
module has been recently developed for speciﬁcally detecting reads 
belonging to the SARS-CoV-2 virus. ViromeScan is available at the 
website http://sourceforge.net/projects/viromescan/and 
https://github.com/simonerampelli/viromescan.
24
Simone Rampelli et al.
2 
Materials 
ViromeScan needs a PC or work-station with Linux or OS X as 
operating system and Bash version 4.1.2 or later. The machine has 
to read also the programming languages R, Perl, and Java. Other 
required softwares are Bowtie2 [10], BMTagger [11], and Picard 
tools [12]. 
3 
Methods 
3.1 
Input Files and 
Database 
1. Input ﬁles should be single- or paired-end reads in fastq format 
(for paired-end reads compressed ﬁles in gzip, bzip2, and zip 
formats are also accepted) retrieved from shotgun sequencing 
or RNA-seq. 
2. Based on the research strategy, ViromeScan offers users the 
ability to choose from different in-house built reference data-
bases, 
including 
human 
DNA 
virus 
database, 
human 
DNA/RNA virus database, eukaryotic DNA virus database, 
and eukaryotic DNA/RNA virus database. The human virus 
databases are made up only of viruses that have the human 
being as a natural host; on the other hand, the eukaryotic 
virus databases also include viruses for vertebrates, inverte-
brates, fungi, algae, and plants, while excluding bacterio-
phages. All databases are built using the complete viral 
genomes available on the NCBI website [13] (see Note 1). 
3.2 
Workﬂow of 
ViromeScan 
1. The ﬁrst step consists of accurate screening of the reads, to 
select candidate viral sequences. Performing this procedure 
before ﬁltering steps allows a remarkable gain of time in the 
other pipeline steps, due to the reduction of the dataset to less 
than 1% of the total amount of metagenomic reads (Fig. 1).

Viral Community Proﬁling through ViromeScan
25
Fig. 1 Workﬂow of ViromeScan. Candidate viral reads are identiﬁed by mapping the sequences to a references 
database and then ﬁltered using three subsequent steps to trim low quality reads and completely remove any 
human and bacterial contaminants 
Fig. 2 Standard output of the ViromeScan software. The results of the ViromeScan pipeline are tabulated as 
both read count and relative abundance and visualized as histograms at different phylogenetic levels. An 
example at the family level is shown
2. The subsequent quality ﬁltering step of the candidate viral 
reads has been implemented as described in the processing 
procedure 
of 
the 
Human 
Microbiome 
Project 
(HMP) 
[14]. In brief, sequences are trimmed for low quality score 
using the script trimBWAstyle.pl [15]. The script is speciﬁcally 
utilized to trim bases off the ends of sequences, which show a 
quality value of two or lower. This threshold is taken to delete 
all the bases with uncertain quality as deﬁned by Illumina’s 
EAMMS (End Anchored Max Scoring Segments) ﬁlter. In 
addition, reads trimmed to less than 60 bp are also discarded. 
3. In the light of the fact that the sequences to be analyzed derive 
from whole genome or RNA sequencing, it is possible that the 
candidate viral reads contain a small percentage of human

26
Simone Rampelli et al.
sequences. To eliminate these possible contaminants, an addi-
tional screening step for human contamination has been imple-
mented. As reported in the HMP procedures [16], Human 
Best Match Tagger (BMTagger) [11] is an efﬁcient tool that 
allows discriminating among human, microbial, and viral reads. 
First, BMTagger attempts to discriminate between human 
reads and the other reads by comparing the 18mers produced 
from the input ﬁle with those contained in the reference human 
database. If this ﬁrst attempt fails, an additional alignment step 
is performed to ensure the detection of all possible matches 
with up to two errors. 
4. It is plausible that the human-ﬁltered reads also contain a 
certain amount of bacterial sequences. For this reason, it is 
advisable to check the sequences for bacterial contamination. 
Similar to the human sequence removal procedure, bacterial 
reads are identiﬁed and removed using BMTagger [11]. By 
default, human-ﬁltered reads are screened against the genomic 
DNA of a representative group of bacterial taxa that are known 
to be common in human body niches, but this bacterial data-
base can be implemented and/or customized with sequences 
of interest (see Note 2). 
5. Filtered reads are ﬁnally compared to the viral genomes of the 
selected hierarchical viral database using bowtie2 [10]. This 
step performs the deﬁnitive association of each virome read to 
a viral genome. 
6. The ﬁnal output consists of a table with the total amount of 
reads for each detected viral taxon, expressed as number of hits 
and relative abundance, and additional graphs showing the 
abundances at family, genus, and species level. These graphs 
are provided using the “graphics” and “base” R packages 
(Fig. 2 and see Note 3). 
7. A new module, namely, “viromescan_covid19” is available, and 
it allows detecting candidate reads for the SARS-CoV-2 virus 
directly from shotgun sequencing data [17] (Fig. 1 and see 
Note 4). In particular, reads assigned to Coronaviridae during 
the canonical analysis of ViromeScan are picked and aligned to 
a second database containing genomes for SARS-CoV-2 and 
genomes for other coronaviruses, including viruses from other 
hosts, for allowing the deﬁnitive assignment of the sequences 
to the SARS-CoV-2 genome.
4 
Notes 
1. In addition to the reference databases built within ViromeScan, 
users can build a customized nucleotide database with the

Viral Community Proﬁling through ViromeScan
27
preferred genomes or genes. First, they have to type the com-
mand “bowtie2-build database.fa database” for obtaining a 
bowtie2 database to be integrated with the viral sequences of 
interest. This database should be put within the directory 
“$PWD/viromescan/database/bowtie2/” and used as input in 
the command line after the “-d” option. 
2. Users can customize the ﬁltering procedure by implementing 
or replacing the bacterial database built within the ViromeScan 
folder
(“$PWD/viromescan/database/Bacteria_custom.fa”) 
with the bacterial sequences of interest, associated with envir-
onments other than the human body (e.g., animal, soil, or 
water microbiome). Please note that the ﬁles containing the 
bacterial sequences of interest must have the same names as the 
original ﬁles. To perform this procedure, users have to create 
the new indexed database for running BMTagger [11]. Please 
also note that BMTagger and the other bmtools necessary to 
run ViromeScan are already present in the “$PWD/viromes-
can/tools” folder. The procedure consists of three steps: (1) to 
create the indexes for bmﬁlter with the command “bmtool –d 
Bacterial_custom.fa –o Bacterial_custom.bitmask –A 0  –w 18”; 
(2) to create the indexes for srprism with the command 
“srprism mkindex –i Bacterial_custom.fa –o Bacterial_custom. 
srprism –M 7168”; 
(3) to create the blast database with the command 
“makeblastdb –in Bacterial_custom.fa –dbtype nucl.” 
3. To get a clean output, the original script foresees an “rm” 
procedure at the end of the computation. This prevents the 
elaboration of intermediate data, such as the retrieving of the 
hit sequences from the .sam output. Users can choose to 
remove this step of the script to use data for further analysis. 
4. Users can customize the SARS-CoV-2 database by implement-
ing the ﬁle within the ViromeScan folder (“$PWD/viromescan/ 
database/bowtie2/coronavirus.fa”) with the last SARS-CoV-
2 genomes, and then rebuilding the bowtie2 indexes. 
References 
1. Thurber RV, Haynes M, Breitbart M et al 
(2009) Laboratory procedures to generate 
viral metagenomes. Nat Protoc 4(4):470–483 
2. Duhaime MB, Sullivan MB (2012) Ocean 
viruses: rigorously evaluating the metagenomic 
sample-to-sequence pipeline. Virology 434(2): 
181–186 
3. Willner D, Hugenholtz P (2013) From deep 
sequencing to viral tagging: recent advances in 
viral metagenomics. Bioessays 35(5):436–442 
4. Lorenzi HA, Hoover J, Inman J et al (2011) 
theviral 
metagenome 
annotation 
pipeline 
(VMGAP):an automated tool for the func-
tional annotation of viral Metagenomic shot-
gun sequencing data. Stand Genomic Sci 4(3): 
418–429 
5. Fancello L, Raoult D, Desnues C (2012) 
Computational tools for viral metagenomics 
and their application in clinical research. Virol-
ogy 434(2):162–174 
6. Wommack KE, Bhavsar J, Polson SW et al 
(2012) 
VIROME: 
a 
standard 
operating

28
Simone Rampelli et al.
procedure for analysis of viral metagenome 
sequences. Stand Genomic Sci 6(3):427–439 
7. Roux S, Tournayre J, Mahul A et al (2014) 
Metavir 2: new tools for viral metagenome 
comparison and assembled virome analysis. 
BMC Bioinformatics 15:76 
8. Colson P, Fancello L, Gimenez G et al (2013) 
Evidence of the megavirome in humans. J Clin 
Virol 57(3):191–200 
9. Rampelli S, Soverini M, Turroni S et al (2016) 
ViromeScan: a new tool for metagenomic viral 
community proﬁling. BMC Genomics 17:165 
10. Langmead B, Salzberg SL (2012) Fast gapped-
read alignment with Bowtie 2. Nat Methods 
9(4):357–359 
11. BMTagger (2011). ftp://ftp.ncbi.nlm.nih. 
gov/pub/agarwala/bmtagger/.
Accessed 
30 Aug 2012 
12. Picard tools website. https://broadinstitute. 
github.io/picard/. Accessed 30 Aug 2012 
13. The NCBI viral genome database. http:// 
w w w. n c b i . n l m . n i  h . g o v / g e n o m e s /  
GenomesGroup.cgi?opt=virus&taxid=10239. 
Accessed 2 Jun 2015 
14. Turnbaugh PJ, Ley RE, Hamady M et al 
(2007) 
The 
human 
microbiome 
project. 
Nature 449(7164):804–810 
15. TrimBWAstyle.usingBam.pl (2010). https:// 
github.com/genome/genome/blob/master/ 
lib/perl/Genome/Site/TGI/Hmp/ 
HmpSraProcess/trimBWAstyle.usingBam.pl. 
Accessed 9 Sept 2012 
16. NIH Human Microbiome Project website. 
http://www.hmpdacc.org.
Accessed 
17 Jun 2015 
17. Rampelli S, Biagi E, Turroni S, Candela M 
(2020) Retrospective search for SARS-CoV-
2 
in 
human 
faecal 
metagenomes. 
SSRN: 
https://ssrn.com/abstract=3557962
or 
https://doi.org/10.2139/ssrn.3557962

Chapter 3 
Freshwater Viral Metagenome Analyses Targeting dsDNA 
Viruses 
Kira Moon and Jang-Cheon Cho 
Abstract 
Viral metagenomics is one of the most widely used approaches to study viral population genomics. With the 
recent development of bioinformatic tools, the number of molecular biological methods, programs, and 
software to analyze viral metagenome data have greatly increased. Here, we describe the basic analysis 
workﬂow along with bioinformatic tools that can be used to analyze viral metagenome data. Although this 
chapter assumes that the viral metagenome data are prepared from the freshwater samples and are subjected 
to dsDNA sequencing, the protocol can be applied and modiﬁed for other types of metagenome data 
collected from a variety of sources. 
Key words Bacteriophage, dsDNA phage, Freshwater, Viral metagenome, Virome 
1 
Introduction 
Viruses are generally recognized as the most abundant and widely 
found biological entities on Earth. Bacteriophages (phages), viruses 
that infect bacteria, have tremendous genetic diversity and account 
for the largest proportion of the entire virosphere. Due to their 
extremely small size and limitations in laboratory cultivation of each 
viral particle, a large number of phages in the environment remain 
unidentiﬁed. Therefore, the virome (viral metagenome) analysis, 
which allows observation of all viral genomes in collected samples, 
has been performed by many researchers in attempts to unravel 
environmental phage genomes. As the number of studies and 
researchers increases, various tools and programs for analyzing 
virome data have been developed [1–3]. With the ﬂourishing num-
ber of analysis tools, it is difﬁcult to choose appropriate software for 
analysis, and users have the ﬂexibility to modify and select their own 
protocols. Therefore, this protocol will provide minimum guide-
lines for researchers to choose and follow for virome data analysis. 
The protocol uses freshly collected freshwater samples to extract
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_3, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
29

and concentrate viral particles based on the ferric chloride ﬂoccula-
tion method [4], which preferably collects dsDNA viral particles. 
Also, the protocol assumes that the viromes are sequenced using 
pairwise Illumina HiSeq or MiSeq platform. From quality control 
of raw metagenome data to metagenome binning of viral contigs, 
this protocol presents guidelines for basic analysis of virome data 
(Fig. 1). This protocol can be fundamentally applied to any virome 
data retrieved from marine, soil, or samples collected from any 
environment. The protocol is divided into two parts: a wet lab 
part that collects and concentrates viral particles from environmen-
tal water samples in preparation for metagenome sequencing and a 
dry lab part that involves processing and analysis of viral metagen-
ome data after sequencing (Table 1)  (see Note 1).
30
Kira Moon and Jang-Cheon Cho
Fig. 1 Overall workﬂow of freshwater dsDNA phage virome data preparation. Virome data preparation consists 
of two parts: metagenome data preparation from raw samples and bioinformatic analysis 
2 
Materials 
2.1 
Materials for 
Virome Sample 
Preparation 
1. Sterile water bottle. 
2. 0.2-μm and 0.8-μm pore size high ﬂow rate membrane, 
142 mm in diameter (e.g., Supor® Membrane Disc Filter). 
3. 0.8-μm 
pore 
size 
hydrophilic 
polycarbonate 
membrane, 
142 mm in diameter (e.g., Isopore™ membrane ﬁlter). 
4. In-line acrylic ﬁlter holders, 142 mm in diameter (e.g., Geo-
tech, US). 
5. Peristaltic pump.

Viral Metagenome Analyses in Freshwater
31
Table 1 
List of suggested bioinformatic tools for virome data analysis 
Analysis step
Program
Features
References 
SPAdes
Fast, most concrete, and widely used. 
Provides various options for different data type 
[5] 
MEGAHIT
Generates long contigs
[6] 
IDBA-UD
One of the oldest assembler tools 
Fast assembly 
[7] 
metaFlye
Assembler for long reads generated by Oxford 
Nanopore sequencing 
[8] 
Kaiju
Taxonomic annotation of metagenome reads 
with database of one’s choice 
[9] 
MG-RAST
Web-based analysis tool with easy access
[10] 
VirSorter
Predicts viral sequences based on public database 
and metagenome data 
[11] 
VirFinder/ 
DeepVirFinder 
Predicts viral sequences based on k-mer 
frequency proﬁles 
[12] 
VIBRANT
Utilizes both machine-learning and protein 
sequence homology 
[13] 
Viral protein 
prediction 
Prokka
Standalone gene prediction and annotation tool 
[14] 
RAST
Web-based gene prediction and annotation tool 
[15] 
ViPTree
Phage phylogenetic tree construction using all 
available viral genomes 
[16] 
VICTOR
Viral phylogenetic tree construction based on 
dice coefﬁcient 
[17] 
VConTACT2
Monopartite network construction of viral 
genomes to predict viral taxonomy 
[18] 
BLAST
Direct sequence similarity comparison
[19] 
Crass
CRISPR-Cas sequence search-based host 
prediction 
[20] 
VirHostMatcher 
k-mer frequency based host prediction
[21] 
vHULK
Neural network based host prediction
[22] 
DIAMOND
Sequence alignment program
[23] 
BLAST
Direct sequence similarity comparison
[19] 
HMM search
Sequence search tool based on hidden Markov 
models 
[24] 
6. 0.18 M FeCl3–6H2O solution: the solution must be freshly 
made and stored in dark and 4 °C before usage. 
7. 0.1 M EDTA–0.2 M MgCl2–0.2 M ascorbate buffer, pH 6.0: 
0.125 M Tris-base (FW=121.14), 0.1 M Na2–EDTA–2H2O, 
0.2 M MgCl2–6H2O, 0.2 M ascorbic acid. 
8. 1 mg/mL DNase I, grade II (from bovine pancreas).

[
32
Kira Moon and Jang-Cheon Cho
9. DNase I storage buffer: 10 mM Tris–HCl pH 7.5, 2 mM CaCl2 
in 50% glycerol. 
10. 10× DNase I reaction buffer: 100 mM Tris–HCl pH 7.6, 
25 mM MgCl2, 5 mM CaCl2. 
11. 7,000 units/mL RNase A. 
12. 1 M EDTA. 
13. 1 M EGTA. 
14. CsCl with buoyant densities of 1.2 g mL-1 , 1.35 g mL-1 , 
1.5 g mL-1 , 1.7 g mL-1 
. 
15. Ultracentrifuge tubes compatible with SW 28 rotor or SW 
40 rotor. 
16. 30 K MWCO ultraﬁltration device (Amicon UFC8030 or 
identical speciﬁcations). 
17. SM (sodium–magnesium) buffer. 
18. 0.2-μm pore size, 25 mm diameter syringe ﬁlter. 
19. QIAGEN DNeasy® Blood & Tissue Kit. 
2.2 
Bioinformatic 
Tools (See Note 2) 
1. FastQC
(bioinformatics.babraham.ac.uk/projects/fastqc/) 
Program for sequence quality check. 
2. BBMap [25]: Sequence aligner to screen for contaminating 
sequences. 
3. Trimmomatic [26]: Tool for trimming metagenome sequences 
based on quality. 
4. MG-RAST [10] (www.mg-rast.org): Automated taxonomic 
and protein function assignment of metagenomic reads. 
5. Kaiju [9]: Taxonomic prediction for metagenome reads and 
contigs. 
6. KronaTools 2.7.1 [27]: Hierarchical and interactive data 
expression in HTML format. 
7. SPAdes [5, 28]: Metagenome contig assembly tool. 
8. RAST webserver (rast.nmpder.org/rast.cgi) [15]: Automated 
annotation and analysis of microbial genome sequences. 
9. vConTACT2 [18, 29]: Distance-based network analysis of 
sequences for taxonomic classiﬁcation. 
10. Cytoscape [30]: Network visualization program. 
11. Prokka [14]: Protein sequence prediction and annotation tool. 
12. DIAMOND [23]: Binning metagenome contigs to sequence 
reads. 
13. BLAST [19]: Local BLAST tool. 
14. VICTOR
(https://ggdc.dsmz.de/victor.php)
17]: 
Web-based tool for classiﬁcation and construction of phyloge-
netic trees for viral genomes.

Viral Metagenome Analyses in Freshwater
33
2.3 
Database
1. Most recent version of RefSeq bacterial and viral databases 
are available at https://ftp.ncbi.nlm.nih.gov/refseq/release/. 
2. The nr database is available at https://ftp.ncbi.nlm.nih.gov/ 
blast/db/. 
3 
Methods 
Most of the data analysis steps below are carried out in a Linux 
environment, with a few exceptions providing web-based or 
Windows-based 
graphical 
user 
interfaces. 
The 
procedures 
described assume that each program is already installed on the 
users’ system. For installation, please refer to the instructions of 
each program. Command-line examples are always followed by a 
bracket sign (>). 
3.1 
Sample 
Preparation for Viral 
Metagenome 
Sequencing 
1. Water sample collection: Collect 20 L of surface water in a 
sterile water bottle using a plastic beaker. Keep samples at 4 ° 
C (or as low as possible) when transported to the laboratory. 
2. Removal of bacteria-sized particles (Fig. 2): Load a 142 mm 
diameter, 0.2-μm pore size ﬁlter onto an acrylic ﬁlter tower. 
Flow the surface water sample through the ﬁlter using a peri-
staltic pump and collect the ﬁltrate in a sterile water bottle. 
3. Flocculation of viral particles: Add 1 mL of 0.18 M FeCl3 
solution to 20 L of 0.2-μm ﬁltrate and shake vigorously for 
1 min. Then add another 1 mL of FeCl3 solution to the sample 
and shake for 1 min. Samples are then incubated for 1 h at 
room temperature for viral particle ﬂocculation [4].
Fig. 2 Representation of a ﬁlter tower holder set up using a peristaltic pump. Place one end of the silicon 
tubing into a container with the collected water sample and place the other end on top of the ﬁlter holder. 
Place a peristaltic pump between the ends so that the water sample can ﬂow into the ﬁlter holder with pump 
power. Place another silicon tube at the bottom of the ﬁlter holder to collect ﬁltrate into a sterilized water 
container

34
Kira Moon and Jang-Cheon Cho
4. Concentration of viral particles: Load a 0.8-μm pore size mem-
brane ﬁlter on top of 0.8-μm pore size support ﬁlter onto an 
acrylic ﬁlter tower. Using a peristaltic pump, ﬂow the FeCl3-
added water sample through the ﬁlters. The ﬂocculated viral 
particles are collected onto the membrane ﬁlter and the ﬂow-
through can be discarded. As viral particles are collected onto 
the membrane ﬁlter, the ﬁlter may be clogged and water ﬂow 
can be restricted. Therefore, it is recommended to replace the 
membrane ﬁlter per 5–10 L of water sample. After passing all 
the samples, carefully collect only the membrane ﬁlter without 
disturbing the FeCl3 ﬂocculates on the ﬁlter, and place it into a 
sterile conical tube. When collecting the membrane ﬁlter, care-
fully fold it inward to protect the ﬁltrate. The ﬁlters should be 
stored in the dark at 4 °C until further steps [4]. 
5. Resuspension of viral particles: Prepare 0.1 M EDTA–0.2 M 
MgCl2 buffer solution freshly before use. Add 1 mL of 0.1 M 
EDTA–0.2 M MgCl2 buffer per 1 L of ﬁltered water sample to 
the conical tube that contains ﬂocculated viral particles-ﬁltered 
membrane. Make sure that the surface of the ﬁlter loaded with 
viral particles is completely submerged in the buffer and then 
place the sample on a rotator at 4 °C and in the dark. After 
overnight incubation, collect the sample into a fresh conical 
tube and every drop of buffer remaining on the membrane 
ﬁlter. 
6. DNase and RNase treatment: To remove extracellular nucleic 
acids, samples must be treated with DNase and RNase. Com-
mercial DNase I (grade II) should be resuspended in 5 mL of 
DNase I storage buffer. Then dilute the DNase in the storage 
buffer using 10× DNase I Reaction buffer to a 10-1 dilution. 
Add diluted DNase solution to the sample at a 1:10 dilution 
and RNase solution at a 1:100 ratio. Incubate the sample at 
37 °C for 1 hour or at room temperature for 2 h. To stop the 
enzyme activity after incubation, add EDTA and EGTA to a 
ﬁnal concentration of 100 mM each. 
7. Puriﬁcation of viral particles: The enzyme-treated sample 
should be loaded onto CsCl density gradients for concentra-
tion and puriﬁcation [31]. Although this step is efﬁcient for 
extracting viral particles of speciﬁc density, it can be skipped 
and moved on to the next step. Prepare CsCl with buoyant 
densities of 1.2 g mL-1 , 1.35 g mL-1 , 1.5 g mL-1 , and 
1.7 g mL-1 . In the ultracentrifuge tube compatible with the 
SW 28 rotor, carefully load the CsCl solution starting with 
3 mL of 1.7 g ml-1 density, followed by 9 mL of 1.5 g mL-1 , 
8 mL of 1.35 g mL-1 , and 5 mL of 1.2 g mL-1 , attempting not 
to disturb each layer. For the ultracentrifuge tubes compatible 
with SW 40 rotor, add an equal proportion of CsCl solution 
adjusted to tube volume. When loading each layer of CsCl

Viral Metagenome Analyses in Freshwater
35
solution, mark each solution’s level on the outer wall of the 
tube. Gently load 13 mL of the sample onto the top layer 
without disturbing the CsCl layers. Centrifuge the prepared 
CsCl-layered tubes at 76,000 × g for 4 h at 4 °C. After centri-
fugation, carefully remove the tubes from the rotor bucket to 
ensure that CsCl layers are well preserved. A visible layer of viral 
particles will be noticeable between 1.35 g mL-1 and 
1.5 g mL-1 CsCl layers. Using a sterile syringe, punch a needle 
into the bottom of the viral particle layer and carefully collect 
the sample. 
8. Chelation of CsCl solution and viral particle concentration: For 
the chelation of CsCl solution and buffer exchange, load the 
collected sample onto a 30 kDa Amicon® Ultra-4 centrifugal 
ﬁlter device and centrifuge at 950 × g until approximately 
500 μl of sample remained. Then add 5 mL of SM buffer to 
the ﬁlter device and repeat centrifugation until the ﬁnal volume 
reaches at least 500 μl. After retrieving the sample, ﬁlter the 
sample using a 0.2-μm pore sized membrane syringe ﬁlter to 
ﬁnally remove possible remaining contaminants. 
9. Viral DNA extraction: Using the QIAGEN DNeasy® Blood & 
Tissue Kit, extract metaviral DNA following the protocol for 
Gram-negative bacteria. Prepare DNA at a minimum amount 
of 200 ng per μl and externalize to a service company the 
preparation of the library and sequencing (we have experience 
with TruSeq® Nano DNA Library Prep kit for sequencing 
library production followed by Illumina MiSeq or HiSeq 
sequencing).
3.2 
Quality Control of 
Sequence Reads 
1. Prior to performing the analysis, the quality of the raw 
sequence reads should be checked using the FastQC program 
requiring the Java Runtime Environment. The program pro-
vides statistical sequence quality data that can be used to deter-
mine whether a ﬁle is suitable for further analyses. This 
program is available at https://www.bioinformatics. 
babraham.ac.uk/projects/fastqc/. 
2. Input ﬁles: Zipped or unzipped raw sequence ﬁles can be used. 
3. In the directory with the raw sequence ﬁles, type in the follow-
ing command and press enter: 
>fastqc forward_input.fastq.gz reverse_input.fastgz 
4. After the program is ﬁnished, it will create one result folder per 
data. Open the ﬁle ending in .html within the folder to see the 
results. 
5. On the results page, basic statistics and graphs showing the 
sequence quality can be found.

36
Kira Moon and Jang-Cheon Cho
3.3 
Quality Trimming 
of Metagenome Reads 
1. For Illumina HiSeq or MiSeq sequencing platforms, phiX174 
sequences are often included as the control sequences. There-
fore, those sequences must be removed from the data before 
further manipulation of the metagenome data. The Perl script-
based program bbduck can be found at https://github.com/ 
BioInfoTools/BBMap/blob/master/sh/bbduk.sh. 
2. Input ﬁles: Raw forward and reverse sequence ﬁles in fastq 
format and phiX174 phage genome (NC_001422.1). 
3. In the directory containing both input raw sequences and 
phiX174 sequence, run the following command: 
>bbmap/bbduk.sh in=input_forward.fastq out=input_-
forward_clean.fastq ref=PhiX174.fa k=31 hdist=1 
>bbmap/bbduk.sh in=input_reverse.fastq out=input_re-
verse_clean.fastq ref=PhiX174.fa k=31 hdist=1 
4. After control sequences have been removed, proceed to the 
next step. 
3.4 
Quality Trimming 
of Metagenome Reads 
1. Before proceeding with the sequence analysis, metagenome 
reads with low quality or length should be removed. With the 
help of Trimmomatic [26], a Perl script-based program, meta-
genome read quality trimming can be performed conveniently. 
The Trimmomatic program can be found at http://www. 
usadellab.org/cms/?page=trimmomatic. 
2. Before running Trimmomatic, users must check the adapter 
sequences that are included in the metagenome data so that 
these sequences can be clipped during the quality trimming 
step. The adapter sequences can be found in the FastQC results 
under the “adapter content” section. Based on the result, users 
should select an adapter sequence ﬁle from the “adapter” folder 
created when Trimmomatic had been installed. For most Illu-
mina sequencing results, adapter sequences named “TruSeq2” 
and “TruSeq3” are suggested for both single- and paired-end 
read data sets. 
3. Input ﬁles: Forward and reverse reads of the raw sequencing 
ﬁles in fastq format. Compressed ﬁles can also be used. 
4. In the directory containing the raw sequences ﬁles and the 
selected adapter sequences, type in the following command: 
>java -jar trimmomatic-0.39.jar PE input_forward.fastq. 
gz input_reverse.fastq.gz output_forward_paired.fastq.gz out-
put_forward_unpaired.fastq.gz output_reverse_paired.fastq.gz 
output_reverse_unpaired.fastq.gz
ILLUMINACLIP:Tru-
Seq3-PE.fa:2:30:10;2:True 
LEADING:10 
TRAILING:10 
SLIDINGWINDOW:4:16 MINLEN:100 
A breakdown of the command line can be found in Fig. 3.

Viral Metagenome Analyses in Freshwater
37
Fig. 3 Breakdown of Perl script for the Trimmomatic program. Each option in the program is separated by a 
space and the order is subject to change. The values for options, such as the minimum length of reads to be 
saved (MINLEN:100), can be adjusted as needed 
5. When the program completes, quality trimmed results are dis-
played on the screen showing the percentage of saved or 
dropped reads. In the working directory, four quality trimmed 
metagenome data ﬁles are created. 
3.5 
Metagenome 
Read Annotation 
1. For overall and brief quantitative observation of the virome 
data, each read can be used for taxonomic annotation. Since 
each read is too short for an accurate taxonomic prediction 
(150 ~ 300 bp), users must interpret the data with care. 
2. One of the simplest methods to analyze metagenome reads is 
to utilize a pipeline called MG-RAST [10]. Raw forward and 
reverse sequences must be interleaved into one ﬁle for input to 
the MG-RAST pipeline. After submission, MG-RAST will 
return taxonomic assignments and protein function predictions 
of each submitted read, allowing for a quantitative overview of 
the data. 
3. For customized taxonomic assignment of metagenome reads, 
Kaiju [9] based on Perl script is suggested. The Kaiju program 
is also available online for more convenient usage (kaiju.bing. 
ku.dk/submit). 
4. Input ﬁles: Quality trimmed forward and reverse sequence ﬁles 
in fastq format. 
5. Prior to analysis, a reference database must be selected and 
downloaded. Desired databases such as RefSeq or nr can be 
downloaded from http://ftp.ncbi.nlm.nih.gov/. For an analy-
sis of virome data, combined use of bacterial and viral RefSeq 
databases is suggested. After downloading the databases, run 
the following command to build a usable database: 
>kaiju-makedb -s database.ﬁle

38
Kira Moon and Jang-Cheon Cho
The command will provide three ﬁles needed to run the 
Kaiju program: database.fmi, nodes.dmp, and name.dmp. 
6. In the directory containing both reference database and meta-
genome data, run the following command for read annotation: 
>kaiju -t nodes.dmp -f database.fmi -i forward_input.fastq
-j reverse_input.fastq -o output.kaiju -z 24 
The -t and -f options designate the database to be used 
while -i and -j direct to the metagenome input data. The -o 
option assigns a name to the result ﬁles, while -z speciﬁes the 
number of CPUs to be used for analysis. 
7. For the visualization of the results, the data must be converted 
to a Krona chart or tabular format. The following steps will 
help visualization of the data as an interactive Krona chart. 
>kaiju2krona -t nodes.dmp -n names.dmp -j kaiju.out -o 
kaiju.out.krona 
>ktImportText -o kaiju.out.html kaiju.out.krona 
The ﬁnal output ﬁle, kaiju.out.html can be opened in 
Chrome or Microsoft Edge programs for interactive pie charts. 
8. To transform Kaiju annotation results into a summary table 
format, follow the below steps: 
>kaijuReport -t nodes.dmp -n names.dmp -i kaiju.out -r 
genus -o kaiju.out.summary 
The ﬁnal output ﬁle, kaiju.out.summary, can be opened in 
Notepad or Microsoft Excel for analysis. 
3.6 
Contig Assembly
1. Metagenome reads are short fragments of nucleic acid 
sequences that are insufﬁcient to represent a biological entity. 
Therefore, fragmented reads must be assembled to construct a 
contig that potentially represents a genome, also called 
metagenome-assembled genome (MAG). There are numerous 
programs available for metagenome read assembly, each with 
their own advantages [3]. Here we present the usage of an 
assembler called SPAdes (https://cab.spbu.ru/software/ 
spades/) [5], which utilizes de Bruijn graphs and k-mer dis-
tance calculations to construct contigs. SPAdes provides a vari-
ety of options for users to choose from depending on the types 
of data to be assembled. For virome assembly, spades.py, metas-
pades.py, and metaviralspades.py options can be used. Users are 
suggested to run all three options and select the best results 
with the highest number of high-quality contigs for further 
analysis. 
2. Input ﬁles: Quality trimmed forward and reverse sequence ﬁles 
in fastq format. 
3. Within the directory where the input ﬁles are located, run the 
following commands:

Viral Metagenome Analyses in Freshwater
39
>spades.py -k 21,33,55,77,99,127 -1 forward_input.fastq
-2 reverse_input.fastq -o output_directory 
>metaspades.py -k 21,33,55,77,99,127 -1 forward_input. 
fastq -2 reverse_input.fastq –meta -o output_directory 
>metaviralspades.py -k 21,33,55,77,99,127 -1 forwar-
d_input.fastq -2 reverse_input.fastq -o output_directory 
The -k option specifying k-mer length must be odd 
integers. 
4. After running the program, the output directory with many 
ﬁles will be created. Within the output directory, a ﬁle named 
“contigs.fasta” contains all the constructed contigs and their 
sequences. 
3.7 
Viral Contig 
Identiﬁcation 
1. Although bacterial contamination is removed as much as pos-
sible before DNA extraction, bacterial sequences often remain 
in the sequenced data. For this reason, after assembling contigs 
using metagenome reads, nonviral contigs may have been con-
structed. Therefore, viral contigs must be screened and selected 
for further analyses. Among the metagenome assembled con-
tigs, viral genomes can be identiﬁed through two methods: 
homologous sequence search and deep learning prediction of 
viral genes based on the calculation of each viral sequence 
feature [2]. Numerous tools are publicly available that use 
either or a combination of the two approaches (Table 1). 
Here is how to use VirSorter version 1.0.3, one of the widely 
used and constantly updated tools. 
2. Input ﬁles: Metagenome assembled contigs in fasta format. 
3. The VirSorter program is available at the de.cyverse.org/apps/ 
webpage. Before running the VirSorter program, input data 
must be uploaded to the cyverse webserver. The data can be 
uploaded from the “data” tab within the cyverse webpage. 
When the upload is complete, the ﬁle can be called into the 
VirSorter program. Once the input data is selected, a database 
to compare and screen viral sequences must be selected. The 
RefSeqABVir database consists of phage whole genome 
sequences, allowing the identiﬁcation of genuine phage or 
prophage sequences. The Viromes database in the VirSorter 
program includes unidentiﬁed viral MAGs, which are also 
called as UViGs, unidentiﬁed viral genomes. Therefore, the 
selection of the Viromes database may result in a less conserva-
tive screening of phage genomes but a larger number of phage 
candidate sequences. 
4. After the program closes, a results folder will be created on the 
“data” tab of the Cyverse website. The csv ﬁle in the folder 
provides a list of contig names classiﬁed into six categories: 
Category 1 (pretty sure to be phage genome), 2 (quite sure

40
Kira Moon and Jang-Cheon Cho
to be phage genome), 3 (uncertain phage genomes), 4 (pretty 
sure to be prophage sequences), 5 (quite sure to be prophage 
sequences), and 6 (uncertain prophage sequences). Classiﬁed 
contig sequences in fasta ﬁle format can be found in the “Pre-
dicted viral sequences” folder. 
3.8 
Viral Protein 
Prediction 
1. After screening and selecting viral contigs, the open reading 
frame (ORF) of each contig sequence must be predicted for 
further analysis. One of the easiest and most straightforward 
methods to predict and annotate the protein function of each 
ORF is using the RAST webserver [15]. The fasta format of the 
contigs can be used as input. Under the “Your Jobs” tab, click 
the “Upload New Job” button and then enter the sequence 
information as requested. 
2. After the analysis is complete, numerous ﬁles are created 
including amino acid sequence ﬁles. The results can be viewed 
from the “Seed Viewer” link on the results page. 
3. Another program to perform protein prediction and annota-
tion is to use Prokka, a Perl-script-based program [14]. 
4. Input ﬁles: Viral contig ﬁles in fasta format. 
5. Within the directory where the input ﬁle is located, type in the 
following commands to run the Prokka program: 
>prokka --kingdom Viruses --compliant --outdir output_-
directory --preﬁx set_preﬁx input.fasta 
6. After the program is ﬁnished, a ﬁle with .faa extension will 
contain amino acid sequences predicted from the virome contig 
sequences. 
3.9 
Viral Contig 
Taxonomy 
Classiﬁcation 
1. Unlike bacteria, which have universally conserved 16S rRNA 
gene sequences for taxonomic classiﬁcation, even of uncultured 
strains, viruses do not have signature genes for taxonomic 
identiﬁcation. Therefore, taxonomic classiﬁcation of viruses 
requires whole genome sequences to ﬁnd their closely related 
taxa. One of the most straightforward methods to ﬁnd the 
most similar match to the UViGs is BLAST [19]. ViPTree 
[16] is a web-based tool that performs tBLASTx to compute 
sequence similarity of contigs submitted to the phage genome 
database. On the ViPTree Website (genome.jp/viptree/), 
users can upload up to 200 sequences for analysis. After simi-
larity calculations, ViPTree provides the phylogenetic position 
of uploaded sequences by generating a phylogenetic tree of 
submitted sequences and all reported phage genomes. 
2. Another web-based tool for generating phage phylogenetic 
trees is called VICTOR (Virus Classiﬁcation and Tree Building 
Online Resource) [17]. VICTOR constructs phylogenetic 
trees based on the Genome-BLAST Distance Phylogeny

Viral Metagenome Analyses in Freshwater
41
method (GBDP). Up to 100 sequences can be submitted for 
analysis, and only the submitted sequences are used to generate 
phylogenetic trees. 
3. BLAST-based taxonomic assignments rely heavily on reference 
genome databases. Since most virome contigs are UViGs, most 
contigs may be classiﬁed as “unknown” when BLAST is per-
formed against the reference databases. Therefore, vConTACT 
v.2.0 [18, 29], a distance-based network analysis program, is 
suggested as a database-independent method for predicting 
and assigning viral taxonomy to virome contigs. The vCon-
TACT program is available at https://bitbucket.org/ 
MAVERICLab/vcontact2/src/master/. 
4. Input ﬁles: Two input ﬁles are required. 
(1) Amino acid protein ﬁle: This ﬁle can be provided by the 
VirSorter program. After VirSorter analysis, which screens and 
sorts viral contigs, an output folder named “Fasta_ﬁles” is 
created. Within the folder, a ﬁle called “VIRSorter_prots. 
fasta” containing amino acid sequence ﬁles of selected viral 
contigs is used as input for vConTACT analysis. 
(2) Gene-to-genome mapping ﬁle: This ﬁle can be gener-
ated from the following command, using the same amino acid 
protein ﬁle from above: 
>vcontact2_gene2genome –p input_amino_acid_ﬁle.faa
-o output_g2g.csv -s “Prodigal-FAA.” 
The “vcontact2_gene2gnome” program can be found 
within the vConTACT program. The output ﬁle “out-
put_g2g.csv” will be used for the following steps. 
5. In the vConTACT2 directory, place both input ﬁles and run 
the following command: 
>vcontact2 --raw-proteins input_amino_acid_ﬁle.faa --
proteins-fp output_g2g.csv -db “PrkoaryoticViralRefSeq211-
Merged” --output-dir output_directory 
6. When the program completes, the “c1.ntw” output ﬁle is used 
for data visualization. Open the output ﬁle in the Cytoscape 
program through the “import” option. 
3.10 
Host Prediction 
of Viral Contigs 
1. Bacterial hosts have developed CRISPR systems that can pro-
tect themselves from phage infection. The CRISPR locus con-
tains fragments of the phage genomes that have infected the 
cell, allowing the bacterium to trigger the immune system 
when the matching phage enters cytoplasm. Therefore, 
phage-host pairs can be traced through CRISPR loci sequence 
analysis. A program called CRASS [20], which can be found at 
https://github.com/ctSkennerton/crass/,
searches
for 
CRISPR sequences within metagenome ﬁles to predict pre-
sumptive bacterial hosts.

42
Kira Moon and Jang-Cheon Cho
2. Input ﬁle: Both fastq and fasta format sequences can be used as 
input. Viral contig sequences in fasta format can be used for 
host prediction of each contig. 
3. In the directory where the input ﬁles are located, type in the 
below command to run the program: 
>crass viral_contig.fasta 
3.11 
Binning of Viral 
Contigs to Virome 
Reads 
1. Once individual viral contigs have been identiﬁed, their distri-
bution and abundance within environmental virome data can 
be analyzed. The DIAMOND program [23] can be used to 
perform pairwise alignment of target sequences to the virome 
data of choice. 
2. Input ﬁles: Viral contig ﬁles in protein sequence (faa) format 
and quality trimmed virome data in fasta format. 
3. Before analysis, the target viral contig must be converted to the 
DIAMOND input format. In the directory containing viral 
contig protein sequence ﬁles, type in the following command: 
>diamond
makedb
--in
viral_contigs.faa
-d 
output_directory 
This will create a ﬁle with the .dmnd extension. 
After the ﬁle is reformatted, run the DIAMOND analysis 
using the following command: 
>diamond blastx -d viral_contigs.dmnd -q input_virome. 
fasta -a results_ﬁle --sensitive -k 1 --min-score 40 ./ --log 
4. After the program completes, the resulting output ﬁle with the 
.daa extension must be reformatted as a readable ﬁle. 
>diamond view -a output.daa -o output.txt 
The output.txt ﬁle can be opened in Notepad or Microsoft 
Excel program for user analysis. 
4 
Notes 
1. Although this protocol is aimed at freshwater virome analysis, it 
can always be adjusted and modiﬁed to other virome data sets 
such as marine, soil, or gut. 
2. Bioinformatic tools are constantly being updated and devel-
oped. Therefore, users should regularly check updates of each 
program. Also, when new programs are developed, users have 
to choose a better program compared to currently used 
programs.

Viral Metagenome Analyses in Freshwater
43
Acknowledgments 
This research was supported by National Research Foundation of 
Korea (NRF) grants (NRF-2022R1A2C3008502 and NRF-
2021M3A9I4021431) funded by the Ministry of Sciences and 
Information and Communications Technology, Korea. 
References 
1. Moon K, Cho JC (2021) Metaviromics cou-
pled with phage-host identiﬁcation to open the 
viral ‘black box’. J Microbiol 59(3):311–323. 
https://doi.org/10.1007/s12275-021-
1016-9 
2. Andrade-Martı´nez JS, Valera LCC, Ca´rdenas 
LAC et al (2022) Computational tools for the 
analysis 
of 
uncultivated 
phage 
genomes. 
Microbiol 
Mol 
Biol 
Rev 
86(2):e00004– 
e00021. https://doi.org/10.1128/mmbr. 
00004-21 
3. Sutton TDS, Clooney AG, Ryan FJ et al 
(2019) Choice of assembly software has a criti-
cal impact on virome characterisation. Micro-
biome 7(1):12. https://doi.org/10.1186/ 
s40168-019-0626-5 
4. John SG, Mendez CB, Deng L et al (2011) A 
simple and efﬁcient method for concentration 
of ocean viruses by chemical ﬂocculation. Envi-
ron Microbiol Rep 3(2):195–202. https://doi. 
org/10.1111/j.1758-2229.2010.00208.x 
5. Bankevich A, Nurk S, Antipov D et al (2012) 
SPAdes: a new genome assembly algorithm and 
its applications to single-cell sequencing. J 
Comput Biol 19(5):455–477 
6. Li D, Liu C-M, Luo R et al (2015) MEGA-
HIT: an ultra-fast single-node solution for 
large and complex metagenomics assembly via 
succinct 
de 
Bruijn 
graph. 
Bioinformatics 
31(10):1674–1676 
7. Peng Y, Leung HC, Yiu SM et al (2012) 
IDBA-UD: a de novo assembler for single-cell 
and metagenomic sequencing data with highly 
uneven
depth.
Bioinformatics 
28(11):1420–1428. https://doi.org/10. 
1093/bioinformatics/bts174 
8. Kolmogorov M, Bickhart DM, Behsaz B et al 
(2020) metaFlye: scalable long-read metagen-
ome assembly using repeat graphs. Nat Meth-
ods 17(11):1103–1110 
9. Menzel P, Ng KL, Krogh A (2016) Fast and 
sensitive taxonomic classiﬁcation for metage-
nomics with Kaiju. Nat Commun 7:11257. 
https://doi.org/10.1038/ncomms11257 
10. Glass EM, Wilkening J, Wilke A et al (2010) 
Using 
the 
metagenomics 
RAST 
server 
(MG-RAST) for analyzing shotgun metagen-
omes. Cold Spring Harb Protoc 2010(1):pdb. 
prot5368 
11. Roux S, Enault F, Hurwitz BL et al (2015) 
VirSorter: mining viral signal from microbial 
genomic data. PeerJ 3:e985 
12. Ren J, Ahlgren NA, Lu YY et al (2017) VirFin-
der: a novel k-mer based tool for identifying 
viral sequences from assembled metagenomic 
data. Microbiome 5(1):69 
13. Kieft K, Zhou Z, Anantharaman K (2020) 
VIBRANT: automated recovery, annotation 
and curation of microbial viruses, and evalua-
tion of viral community function from genomic 
sequences. Microbiome 8(1):1–23 
14. Seemann T (2014) Prokka: rapid prokaryotic 
genome
annotation.
Bioinformatics 
30(14):2068–2069 
15. Aziz RK, Bartels D, Best AA et al (2008) The 
RAST server: rapid annotations using subsys-
tems technology. BMC Genomics 9(1):75 
16. Nishimura Y, Yoshida T, Kuronishi M et al 
(2017) ViPTree: the viral proteomic tree 
server. 
Bioinformatics 
33(15):2379–2380. 
https://doi.org/10.1093/bioinformatics/ 
btx157 
17. Meier-Kolthoff JP, Go¨ker M (2017) VICTOR: 
genome-based phylogeny and classiﬁcation of 
prokaryotic
viruses.
Bioinformatics 
33(21):3396–3404. https://doi.org/10. 
1093/bioinformatics/btx440 
18. Bolduc B, Jang HB, Doulcier G et al (2017) 
vConTACT: an iVirus tool to classify double-
stranded DNA viruses that infect archaea and 
bacteria. PeerJ 5:e3243. https://doi.org/10. 
7717/peerj.3243 
19. Camacho C, Coulouris G, Avagyan V et al 
(2009) BLAST+: architecture and applications. 
BMC Bioinform 10(1):421. https://doi.org/ 
10.1186/1471-2105-10-421 
20. Skennerton 
CT, 
Imelfort 
M, 
Tyson 
GW 
(2013) Crass: identiﬁcation and reconstruction 
of CRISPR from unassembled metagenomic 
data. Nucleic Acids Res 41(10):e105–e105 
21. Ahlgren NA, Ren J, Lu YY et al (2017) 
Alignment-free d2* oligonucleotide frequency

44
Kira Moon and Jang-Cheon Cho
dissimilarity measure improves prediction of 
hosts 
from 
metagenomically-derived 
viral 
sequences. Nucleic Acids Res 45(1):39–53. 
https://doi.org/10.1093/nar/gkw1002 
22. Amgarten D, Iha BK, Piroupo CM et al (2020) 
vHULK, a new tool for bacteriophage host 
prediction based on annotated genomic fea-
tures and deep neural networks. PHAGE 
3(4):204–212. https://doi.org/10.1089/ 
phage.2021.0016 
23. Buchﬁnk B, Xie C, Huson DH (2015) Fast and 
sensitive protein alignment using DIAMOND. 
Nat Methods 12(1):59–60 
24. Lukashin 
AV, 
Borodovsky 
M 
(1998) 
GeneMark. hmm: new solutions for gene 
ﬁnding. Nucleic Acids Res 26(4):1107–1115 
25. Bushnell B (2014). BBMap: a fast, accurate, 
splice-aware 
aligner. 
Lawrence 
Berkeley 
National Laboratory. LBNL report #: LBNL-
7065E 
26. Bolger AM, Lohse M, Usadel B (2014) Trim-
momatic: 
a 
ﬂexible 
trimmer 
for 
Illumina 
sequence
data.
Bioinformatics 
30(15):2114–2120 
27. Ondov BD, Bergman NH, Phillippy AM 
(2011) Interactive metagenomic visualization 
in a web browser. BMC Bioinform 12:385. 
https://doi.org/10.1186/1471-2105-
12-385 
28. Antipov D, Raiko M, Lapidus A et al (2020) 
metaviralSPAdes: assembly of viruses from 
metagenomic data. Bioinformatics. https:// 
doi.org/10.1093/bioinformatics/btaa490 
29. Jang HB, Bolduc B, Zablocki O et al (2019) 
Taxonomic assignment of uncultivated pro-
karyotic virus genomes is enabled by gene-
sharing
networks.
Nat
Biotechnol 
37(6):632–639. https://doi.org/10.1038/ 
s41587-019-0100-8 
30. Smoot ME, Ono K, Ruscheinski J et al (2011) 
Cytoscape 2.8: new features for data integra-
tion and network visualization. Bioinformatics 
27(3):431–432 
31. Hurwitz BL, Deng L, Poulos BT et al (2013) 
Evaluation of methods to concentrate and 
purify ocean virus communities through com-
parative, replicated metagenomics. Environ 
Microbiol 15(5):1428–1440. https://doi. 
org/10.1111/j.1462-2920.2012.02836.x

Chapter 4 
Discovery and Identiﬁcation of Viruses Infecting Oomycetes 
Anna Poimala and Eeva Vainio 
Abstract 
This chapter describes protocols suitable for the detection and identiﬁcation of RNA viruses infecting 
oomycetes (so-called water molds of Kingdom Heterokonta, Stramenopila), focusing on species of Phy-
tophthora and exempliﬁed by P. fragariae. The protocol includes laboratory procedures for oomycete 
cultivation and total RNA extraction from harvested mycelia, followed by instructions on suitable para-
meters given for sequencing companies on ribosomal RNA depletion, cDNA library preparation, and total 
RNA-sequencing (RNA-Seq). We also describe the bioinformatics steps needed for de novo assembly of raw 
reads into contigs, removal of host-associated contigs, and virus identiﬁcation by database searches, as well 
as host validation by RT-PCR. All steps are described using an exemplar RNA-Seq library containing a yet 
undescribed fusagravirus hosted by a P. fragariae isolate. 
Key words RNA-sequencing, Oomycetes, Phytophthora, Mycovirus, Viral genome assembly, Read 
mapping, Viral genome characterization 
1 
Introduction 
Oomycetes are related to brown algae and belong to the Kingdom 
Heterokonta (Stramenopila). They have similar lifestyles as fungi 
and many of them are plant pathogens of important crop species 
[1–3]. The most notorious oomycetes causing diseases on crop 
plants are among the genus Phytophthora infecting numerous agri-
cultural, ornamental, and forest species, as well as the so-called 
downy mildews (including genera Plasmopara, Peronospora, and 
Pseudoperonospora) that cause problems in e.g., grapevine cultiva-
tion. Oomycetes do not produce macroscopic fruiting bodies, their 
vegetative mycelium is coenocytic and aseptate, and their cell walls 
consist mainly of cellulose instead of chitin. Some oomycete species 
(particularly downy mildews) are obligate biotrophic pathogens 
and practically uncultivable outside their host plant. 
High-throughput sequencing (HTS) methods have recently 
revealed very diverse communities of RNA viruses in oomycetes. 
So far, most of the oomycetes subjected to RNA-Seq have been
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_4, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
45

plant pathogens, such as Plasmopara viticola, Globisporangium 
splendens, 
Phytophthora 
infestans, 
P. 
ramorum, 
P. 
cactorum, 
P. condilina, and P. castaneae [4–10]. All the viruses found to 
date belong to the realm Riboviria, except for a giant virus found 
integrated in the Phytophthora parasitica genome [11]. The major-
ity of oomycete viruses are awaiting ofﬁcial virus classiﬁcation. The 
double-stranded RNA (dsRNA), positive-sense RNA ((+) ssRNA), 
and negative-sense RNA ((-) ssRNA) viruses described thus far in 
oomycetes as well as their closest afﬁliations are listed in Table 1.
46
Anna Poimala and Eeva Vainio
Natural isolates of oomycetes often harbor mixed virus infec-
tions. This is the case with e.g. Phytophthora cactorum [8] and 
Pythium polare [12]. Multiple virus infections with up to 6, 11, 
and 15 viral species were recently discovered in single isolates of 
Phytophthora castaneae, P. palustris, and P. condilina, respectively 
[9, 10, 13]. Also, asexual sporangia and zoospores contain viruses 
in P. infestans [14, 15]. Oomycete viruses lack an extracellular 
phase in their replication cycle, and they are likely transmitted by 
(zoo)spores or hyphal contacts between individuals. 
Stranded RNA-sequencing (RNA-seq) of total RNA has been 
found as a suitable method for the detection of dsRNA, (+) ssRNA, 
and (-) ssRNA viruses in plants, fungi, arthropods, and oomycetes 
[8, 16–18]. It has been demonstrated in both fungi and oomycetes 
that RNA-Seq is superior to small RNA deep sequencing for 
obtaining continuous sequences (contigs) representing coding 
complete viral genome segments [10, 19]. Small RNA-seq, despite 
being more practical as it produces smaller amounts of data, may 
not always provide enough information for building full-length 
viral genomes [10]. This chapter describes how viruses are 
“mined” from HTS data produced from oomycetes, beginning 
with laboratory practices (cultivation and total RNA extraction) 
and completed by the bioinformatics steps and host validation. 
All these steps are described for an exemplar RNA-Seq library 
including a yet undescribed fusagravirus infection in one of the 
Phytophthora isolates. Many technical details of the protocol are 
similar to those described earlier for marine fungi by Nerva et al. 
[20], but here we focus mainly on Phytophthora species, particularly 
on the practicalities of analyzing P. cactorum and P. fragariae vir-
omes. We give an idea of the problems that can be encountered 
when mining and analyzing Phytophthora viruses and how these 
challenges can be identiﬁed and overcome. 
2 
Materials 
2.1 
Oomycete 
Maintenance 
1. Malt medium for P. cactorum, 2% w/v malt extract, 1.5% w/v 
Bacto-Agar. 
2. Red bean agar medium for P. fragariae, 3% w/v bean ﬂour 
(ground red beans), 1.5% w/v Bacto-Agar.

Table 1
(continued)
Oomycete Virus Discovery
47
RNA viruses detected from oomycetes. The taxa with closest affinities to the detected viruses are given in the table 
Genome
Phylum
Class
Order
Family
Genus
Host
References 
dsRNA
Duplornaviricota Chrymotiviricetes Ghabrivirales
Megabirnaviridae 
Megabirnavirus
P. castaneae
[10] 
“Fusagraviridae”
Phytophthora infestans, 
P. castaneae, 
P. fragariae 
[10, 27], This 
study 
n.d.
Toti-like viruses
P. cactorum, P. condilina, 
P. palustris, 
P. castaneae, 
Globisporangium 
splendens, G. ultimum, 
Plasmopara viticola 
[4, 5, 8–10, 
13, 24, 28] 
dsRNA
Pisuviricota
Duplopiviricetes 
Durnavirales
Amalgaviridae
n.d.
Plasmopara viticolaa 
[4] 
Curvulaviridae
Bipartite’ viruses
Plasmopara viticolaa 
[4] 
“Ustivirus”
P. cactorum
[8] 
Partitiviridae
Gammapartitivirus
Pythium nunn
[29] 
n.d.
Plasmopara viticolaa 
[4] 
n.d.
Partiti-like viruses
Plasmopara viticolaa 
[4] 
Pisoniviricetes
Picornavirales
n.d.
Picorna-, iﬂa-, and 
dicistro-like viruses 
Plasmopara viticolaa 
[4] 
dsRNA
n.d.
n.d.
n.d.
Polymycoviridae
n.d.
Plasmopara viticolaa 
[4] 
dsRNA
n.d.
n.d.
n.d.
n.d.
Botybirnavirus
P. palustris, Plasmopara 
viticolaa 
[4, 13] 
(+) ssRNA 
Pisuviricota
Duplopiviricetes 
Durnavirales
Fusariviridae
Alphafusarivirusb 
Plasmopara viticolaa , 
Globisporangium 
ultimum 
[4, 28] 
Pisoniviricetes
Sobelivirales
Solemoviridae
Sobemo-like
Plasmopara viticolaa 
[4] 
n.d.
Yadokarivirales 
Yadokariviridae
Alphayadokarivirusb 
Plasmopara viticolaa 
[4] 
n.d.
n.d.
Astro-like 1
P. infestans
[30] 
n.d.
n.d.
Astro-like 2
P. infestans
[6] 
Stelpaviricetes
Patatavirales
Potyviridae
n.d.
Plasmopara viticolaa 
[4]

(continued)
Genome
Phylum
Class
Order
Family
Genus
Host
References
(+) ssRNA 
Kitrinoviricota
Alsuviricetes
Martellivirales 
Endornaviridae
Alphaendornavirusb 
P. ramorum, P. taxon 
Douglas ﬁr, 
P. cactorum, 
Phytophthora sp. from 
Asparagus 
[7, 8, 31, 32] 
Virgaviridae
Tobamo-like
Plasmopara viticolaa 
[4] 
n.d.
“Mycovirgavirus”
Plasmopara viticolaa 
[4] 
n.d.
“Viviviruses”
Plasmopara viticolaa 
[4] 
n.d.
Alpha-like
Plasmopara viticolaa 
[4] 
n.d.
Ilar-like
Plasmopara viticolaa 
[4] 
Togaviridae
Alphavirus
Plasmopara viticolaa 
[4] 
Flasuviricetes
Amarillovirales 
n.d.
Flavi- and Jingmen-like 
viruses 
Plasmopara viticolaa 
[4] 
Tolucaviricetes
Tolivirales
Tombusviridae
n.d.
P. palustris, Plasmopara 
viticolaa 
[4, 13] 
“Ambiguiviridae”
Plasmopara viticolaa 
[4] 
Noda/Tombus-
like 
Sclerophthora macrospora 
[33] 
(+) ssRNA 
Lenarviricota
Amabiliviricetes 
Wolframvirales 
Narnaviridae
Narnavirus
Plasmopara viticolaa 
[4] 
“Mycoambinarnavirus” Plasmopara viticolaa 
[4] 
“Splipalmiviruses”
Plasmopara viticolaa 
[4] 
n.d.
P. infestans, P. palustris
[13, 34] 
Leviviricetes
Norzivirales
Fiersviridae
Emesvirus
Plasmopara viticolaa 
[4] 
Miaviricetes
Ourlivirales
Botourmiaviridae 
Betabotoulivirusb 
Plasmopara viticolaa 
[4] 
Betascleroulivirusb 
Plasmopara viticolaa 
[4] 
Botoulivirusb 
Plasmopara viticolaa 
[4] 
Deltascleroulivirusb 
Plasmopara viticolaa 
[4] 
Epsilonscleroulivirusb 
Plasmopara viticolaa 
[4] 
Gammascleroulivirusb 
Plasmopara viticolaa 
[4] 
Magoulivirusb 
Plasmopara viticolaa 
[4] 
n.d.
Plasmopara viticolaa 
[4] 
Howeltoviricetes 
Cryppavirales
Mitoviridae
n.d.
Plasmopara viticolaa 
[4]
48
Anna Poimala and Eeva Vainio
Table 1

(-) ssRNA 
Negarnaviricota 
Monjiviricetes
Mononegavirales Mymonaviridae
Penicillimonavirusb 
Plasmopara viticolaa 
[4] 
Plasmopamonavirusb 
Plasmopara viticolaa 
[4] 
Sclerotimonavirusb 
Plasmopara viticolaa 
[4] 
Milneviricetes
Serpentovirales 
“Mycoaspiviridae”
Plasmopara viticolaa 
[4] 
Ellioviricetes
Bunyavirales
Discoviridae
Orthodiscovirusb 
Plasmopara viticolaa 
[4] 
Tulasviridae
P. condilina
[10] 
“Mybuviridae”
P. cactorum, P. condilina, 
P. castaneae, 
P. palustris, 
Halophytophthora spp., 
Globisporangium 
splendens, Plasmopara 
viticola 
[4, 5, 8–10, 
13, 35] 
“Mycobunyaviridae”
Plasmopara viticolaa 
[4] 
n.d.
P. condilina, P. palustris, 
Plasmopara viticolaa 
[4, 10, 13] 
Yue-like viruses
Plasmopara viticolaa 
[4] 
n.d. not determined 
a Viruses obtained from uncultured metagenomic samples 
b Genera include also classiﬁed oomycete virus species
Oomycete Virus Discovery
49

50
Anna Poimala and Eeva Vainio
3. Modiﬁed orange serum agar, 3% w/v Orange serum Agar, 0.8% 
w/v malt extract, 0.8% w/v Dextrose, 1% w/v Bacto-Agar. 
4. Cellophane membranes cut to circles to ﬁt a Petri dish. 
5. Thermostatic incubators. 
2.2 
RNA Extraction 
and RT-PCR Validation 
1. 15 mL Falcon tubes. 
2. Freeze dryer apparatus. 
3. Liquid
nitrogen
(LN
protocol)
OR
FastPrep24 
(MP Biomedicals) (FastPrep protocol). 
4. Sterile mortar, pestle, and spatels (LN protocol) OR two millili-
ter sterile tubes with screw caps as well as circa 0.5 mM sand/ 
beads (FastPrep protocol). 
5. Total RNA extraction kit. 
6. Microcentrifuge (12,000×g or higher). 
7. RNase free 1.5 mL tubes. 
8. Sterile tips (1000, 100, and 10 μL). 
9. Absolute ethanol. 
10. Agarose. 
11. TE-buffer (10 mM Tris-HCl pH 8, 1 mM EDTA, pH 8). 
12. Ethidium bromide. 
13. DNA gel loading dye. 
14. Nanodrop spectrophotometer. 
15. Nucleic acid analyzer. 
16. Reverse transcriptase. 
17. Taq and high-ﬁdelity DNA polymerase. 
2.3 
RNA-Seq Read 
Assembly and Analysis 
1. High memory multicore server, at least 1GB of RAM per 
million of paired-end reads. 
2. BLASTX 2.10.0 +. 
3. Trinity 2.8.5. 
4. Geneious (Prime or R10, Biomatters Ltd.). 
5. MEGA X 10.0.5 or newer. 
3 
Methods 
3.1 
Oomycete 
Maintenance and RNA-
Seq Sample 
Preparation 
There are multiple choices for a suitable cultivation medium for 
Phytophthora spp. [1]  (see Note 1). Some species, such as 
P. cactorum grow relatively fast on several growth media, but 
some phytopathogenic Phytophthora species, such as P. fragariae, 
are very difﬁcult to maintain for a long time in culture, and they 
may be very slow-growing. We advise maintaining P. fragariae 
cultures on red bean agar at 18–22 °C.

Oomycete Virus Discovery
51
Before RNA extraction, oomycete hyphae are grown on mod-
iﬁed orange serum (MOS) or red bean agar plates supplemented 
with cellophane membranes to enable the collection of the mycelia. 
Mycelia are harvested from the top of the cellophane membranes to 
15 mL Falcon tubes (see Note 2). The mycelia containing tubes are 
ﬁrst frozen at -80 °C (-20 °C for a short period of 1–5 days) and 
then freeze-dried for 1–2 days. 
Earlier, we have successfully analyzed samples of P. cactorum 
in sample libraries including samples of only one species or mixed 
with other species of Phytophthora and various fungal species 
[8, 21]. The sample preparation is relatively easy for P. cactorum 
because of its speedy growth. Ten days cultivation on 2–3 plates 
would typically produce over 1 g mycelia, where it is convenient to 
obtain 20–30 mg of lyophilized sample after freeze drying (see 
Note 3). 
In 
our 
exemplar 
RNA-Seq 
library, 
we 
included 
three 
P. fragariae isolates (BBAL1, BBAL½, and BBA11/94-KO18) 
obtained from Julius Ku¨hn Institute culture collection in Braunsch-
weig, Germany. Each isolate was grown on six red bean agar plates 
(with three agar plugs per plate) covered with cellophane mem-
branes for 2 weeks at 22 °C temperature, but growth was still rather 
scarce. All mycelium was collected and freeze-dried, after which the 
total mycelia dry weights for the three isolates were measured as 
18.1, 9.0, and 4.0 mg (see Note 4). 
3.2 
Total RNA 
Extraction 
There are many possibilities available for total RNA extraction 
(see Note 5). The protocol described here is based on using the 
Spectrum™ Plant Total RNA Kit, which typically gives high con-
centrations of good-quality RNA. The cell disruption step of the 
RNA extraction protocol may be carried out using liquid nitrogen 
(LN protocol) or homogenization with FastPrep (FastPrep protocol). 
The extraction protocol is described below. 
A quantity of 20–30 mg of lyophilized P. cactorum mycelial 
powder usually yields very good RNA concentrations, over 
2000 ng/μL on average. For our exemplar RNA-Seq library, the 
RNA extractions from much lower amounts (18.1, 9.0, and 
4.0 mg) of P. fragariae mycelia still yielded 1137, 1841, and 
764 ng/μL of total RNA demonstrating that even low amounts 
of starting material can result in good concentrations of Phy-
tophthora RNA. Typically, several RNA samples can be included in 
the same RNA-Seq library, using one ug total RNA of each sample 
(see Subheading 3.3). 
3.2.1 
Sample 
Homogenization 
In the case of FastPrep protocol: 
1. Weigh 30 mg of lyophilized mycelia in a 2 mL screw-cap tube 
with 0.5 mM beads. 
2. Add 900 μL lysis solution (supplemented with β-ME).

52
Anna Poimala and Eeva Vainio
3. Refreeze sample by 15 min incubation in -80 °C. 
4. Warm the tube slightly and homogenize in Fast Prep at 
6.5 m/s for 30 s twice. 
5. Repeat steps 3 and 4. 
In the case of LN protocol (keep sample in LN at all times to 
avoid thawing. Use sterile mortar, pestle, and spatel): 
1. Weigh 30 mg of ground powder into a 1.5 mL tube. 
2. Add 800 μL lysis solution (supplemented with β-ME). 
3. Vortex immediately for at least 30 s. 
4. Refreeze sample with LN or 15 min incubation in -80 °C. 
5. Warm the tube slightly, vortex 30 s, and proceed immediately 
to the centrifugation step while keeping the sample on ice. 
The following steps of binding RNA to the column, washing 
with two wash solutions, column drying and RNA elution are in 
accordance with the kit protocol. Amounts of wash solutions may 
optionally be lowered to 400 μL. 
6. Centrifuge for 30 s at 13,000 g. 
7. Add equal volume of “binding solution” to the ﬁltered liquid 
and transfer to the binding column (red ring). 
8. Centrifuge for 30 s at 13,000 g and discard the ﬂow-through. 
9. Add 400 μL of wash solution 1. 
10. Centrifuge for 30 s at 13,000 g and discard the ﬂow-through. 
11. Add 400 μL of wash solution 2. 
12. Centrifuge for 30 s at 13,000 g and discard the ﬂow-through. 
Repeat the last washing step. 
13. Centrifuge the empty column for 60 s at 13,000 g to remove 
traces of ethanol. 
14. Elute RNA with 40 μL elution buffer to sterile 1.5 mL tube. 
15. Quantify RNA with a Nanodrop spectrophotometer. 
16. Check RNA abundance and integrity by electrophoresis in 1% 
agarose gel 1× TE buffer. 
3.3 
RNA Sequencing
After total RNA extraction, multiple RNA samples may be pooled 
to be sequenced in the same RNA library (1 μg RNA from each 
sample is recommended). In our experience, many Phytophthora 
isolates host mixed infections by related viruses, and thus pooling 
more than 12 isolates into one RNA-seq library is not advised. This 
is because pooling too many isolates will increase the probability 
that several similar viral strains or variants exist in a single library, 
which in turn may cause the formation of artiﬁcial, chimeric contigs 
at the Trinity de novo assembly step [8] (Fig. 1). These chimeric

contigs do not represent true biological entities and cannot be used 
for taxonomic assignment of the viruses. In case many similar 
viruses exist in a single pool, their true genome sequences need to 
be veriﬁed by RT-PCR and Sanger sequencing. 
Oomycete Virus Discovery
53
Fig. 1 Part of an alignment between a Sanger-validated alphaendornavirus sequence (MW329899.1) from 
P. cactorum and the most similar de novo assembled contig sequence (TRINITY_DN319_c0_g1_i6) from the 
corresponding RNA-Seq library [8]. White gaps in the green identity bar indicate mismatches between the 
sequences. The 5′ end of the most similar contig sequence matches exactly the Sanger-veriﬁed sequence, 
whereas the 3′ end of the sequence contains several mismatches (SNPs) indicating that it represents another 
variant of the virus 
The ﬁnal RNA quality check (RNA integrity, i.e., RIN values), 
the depletion of ribosomal RNA, RNA-seq library construction, 
and RNA sequencing steps are usually outsourced to commercial 
companies. RNA quality should be determined before sending the 
samples for library construction and HTS. This is usually con-
ducted by checking RNA integrity by agarose gel electrophoresis 
and/or observing the rRNA quality and ratio by, for example, 
LabChip GX Touch HT Nucleic Acid Analyzer (PerkinElmer). In 
our experience, both sample homogenization steps detailed above 
result in good Phytophthora RNA integrity; in case of libraries 
including P. cactorum samples [8], the LN method has given 
RIN-values 7.3–9.2, and the FastPrep method RIN 7.7 (Fig. 2). 
The Ribo-Zero Gold rRNA Removal Kit for Human/Mouse/Rat 
(Illumina) is suitable for removing cytoplasmic and mitochondrial 
rRNA also from oomycetes. In our examples here, we used TruSeq 
total RNA sample kit (Illumina) for library preparation. The 
sequencing was performed using an Illumina NovaSeq6000 system 
generating stranded paired-end sequences (2 × 100 nt) generating 
100 M reads (see Note 6). 
With this method, RNA-seq libraries, including 10–22 Phy-
tophthora isolates, have yielded 122–165 M paired-end reads of 
100 nt [8]. For our exemplar RNA-Seq library, we pooled three 
P. fragariae isolates with RNA from nine different fungal isolates. 
In this case, the RNA RIN-value was 6.3, and 115 M reads were 
obtained. 
3.4 
Bioinformatics
The bioinformatic steps start with the assembly of raw reads with 
Trinity [22], which is a command-line-based program and requires 
a multicore server with high memory, or access to a high-
performance supercomputer. We have used Puhti supercluster 
(puhti.csc.ﬁ) whose theoretical computing capacity is 1.8 petaﬂops 
and is provided for Finnish research organizations by IT Center for 
Science (csc.ﬁ). Trinity run takes about 3 h in Puhti (but varies

depending on queue time). For our runs, we have requested one 
node (containing two Cascade Lake Intel Xeon processors) and 
22 gigabytes of memory (see command below). The resulting 
Trinity contigs are then compared against a custom viral protein 
database to identify contigs resembling known viral sequences. 
Characterization of these putative viral genomes can be subse-
quently conducted, for example, using Geneious, which is a graphic 
software tool for bioinformatics and molecular biology. Many freely 
available sequence analysis programs can also be used for sequence 
alignment, read mapping, and Open Reading Frame (ORF) analysis 
(see details below). 
54
Anna Poimala and Eeva Vainio
Fig. 2 Sample quality graphs and RIN-values obtained from RNA-seq library 1 from P. cactorum [8], where 
samples were prepared with LN method (a), and RNA-seq library 2 from P. cactorum [8], where cells were 
disrupted by FastPrep (b). The well-deﬁned 18S and 28S ribosomal RNA and the low molecular weight RNA 
peaks should be visible in the graph, and low amount of “noise” between the peaks is also desirable. In intact 
rRNA, the 28S and 18S peak ratio is 2:1

Oomycete Virus Discovery
55
3.4.1 
Transcriptome 
Assembly 
1. For de novo assembly of raw reads to obtain putative contigu-
ous sequences (contigs), we suggest using Trinity. For paired-
end sequences, both ﬁles (“readsleft.fq” and “readsright.fq”) 
have to be supplied in fastq (.fq) or fasta (.fa, .fasta) format. 
Prior to de novo assembly, it is advisable to use Trimmomatic 
[23] for trimming low-quality score reads and removing 
adapter remnants from the reads, improving the results. Trim-
momatic is included in Trinity. 
2. The command line for paired-end data (RF) (ﬁles in .fq format) 
should be: 
Trinity --seqType fq --max_memory 22G --left readsleft.fq --
right readsright.fq --trimmomatic --SS_lib_type RF --CPU 6 --
output trinity_run_out. 
3. After the assembly is ﬁnished, a result ﬁle Trinity.fasta will be 
found in the trinity_run_out folder. The ﬁle includes all contigs 
assembled from the raw reads. Our exemplar RNA-seq library 
of 115 M reads was assembled into 227,582 contigs. 
3.4.2 
Virus Identiﬁcation
1. A database containing viral RefSeq protein sequences can be 
downloaded from NCBI Taxonomy browser (https://www. 
ncbi.nlm.nih.gov/). The database including all Riboviria pro-
teins may be downloaded, but since it will contain more than 
40 million sequences, we suggest making a custom database 
prior to download excluding the most common (human/ani-
mal) virus sequences and nucleocytoplasmic large DNA viruses 
(NCLDVs; Nucleocytoviricota) as they generally harbor host 
sequences, commonly leading to the misidentiﬁcation of 
host-derived contigs. 
2. Viral sequence homologs for the obtained Trinity contigs 
(Trinity.fasta) can be identiﬁed by comparing them against 
the viral database (virus_database.fasta) using the BLAST 
search program. The exemplar command below will report 
ﬁve closest matches for each contig, which should be enough 
for virus identiﬁcation: 
blastx -query Trinity.fasta -dbprot virus_database.fasta
-evalue 10e-5 -num_alignments 5 -num_descriptions 5 -out blas-
tx_result.fasta. 
Next, contigs that show signiﬁcant similarity to viral 
sequences can be retrieved by narrowing down the result ﬁle 
grep ‘signiﬁcant’ -A 100 -B 100 blastx_result.fasta > grep_-
signiﬁcant.fasta. 
It is now possible to open the grep_signiﬁcant.fasta ﬁle 
(due to its smaller size) to check the alignments one by one. 
Once the list of contig names with similarities to viral sequences 
is obtained, the next step is to retrieve their sequences (one by 
one) from the Trinity.fasta ﬁle, using command:

56
Anna Poimala and Eeva Vainio
Fig. 3 Part of the BlastX result ﬁle showing the best matches for the query contig TRINITY_DN56944_c1_g1_i1 
representing the Phytophthora fragariae fusagravirus 1 
grep -A 100 contig_name Trinity-fasta > contig_name. 
fasta (see Note 7). 
As an example, we identiﬁed a contig sequence of 8321 nt, 
the closest relative of which is identiﬁed by BLASTx as Phy-
tophthora infestans RNA virus 3, which represents the unclassi-
ﬁed 
virus 
group 
provisionally 
named 
“Fusagraviridae” 
(Fig. 3). Based on this, we named the virus represented by 
the contig as Phytophthora fragariae fusagravirus 1 (PfFGV1). 
3. If the genome of the host species (or closely related species) is 
available, it is advisable to remove host reads from the list of 
contigs resembling viruses. 
For removal of host reads, you need to have a list of contigs 
resembling viruses including contig name and sequence (e.g., 
cleaned_contigs.fasta; see Note 7). Next, the contigs that origi-
nate from the host DNA can be removed from the list by 
BLASTing them against the host proteome. This will generally 
clean 90% of contigs from the list in case of a P. cactorum pool. 
For this, you need to have the proteome of the host oomycete 
(Oomycete_genome.faa). 
blastx -query cleaned_contigs.fasta -dbprot Oomycete_gen-
ome.faa -evalue 10e-5 -num_alignments 1 -num_descriptions 
1 -out cleaned_contigs.fasta. 
Only contigs that did not match the host proteome should 
be kept from now on: 
grep ‘No hits found’ -A 0 -B 20 cleaned_contigs.fasta > 
grep_cleaned_contigs.fasta. 
grep ‘Query’ -A 0 -B 0 grep_cleaned_contigs.fasta > ﬁnal_-
viral_contigs.fasta. 
Then a list containing contig names and sequences should 
be made again by selecting them from the BLASTx-ﬁle one by 
one or with FaSomeRecords as done before. Then it is neces-
sary to repeat the BLASTx analysis with the ﬁnal contigs (see 
Note 8).

Oomycete Virus Discovery
57
3.5 
Host Validation
For the identiﬁcation of host isolates of the detected viruses, the 
RNA of each isolate should be reverse transcribed to cDNA. The 
RNAs that were previously pooled in the RNA-Seq library can be 
used for cDNA synthesis; however, the RNA may be extracted 
again from freshly cultivated mycelia if there are indications of 
possible cross contamination that may occur during sample 
homogenization. For P. fragariae, Spectrum™ Plant Total RNA 
Kit may be used to reisolate the RNA (see Note 9). For cDNA 
synthesis, any reverse transcriptase can be used, following manu-
facturer’s instructions (see Note 10). 
PCR screening primers should be designed for each virus 
sequence type observed during the virus identiﬁcation step. The 
alignments of all contigs representing a distinct virus as well as the 
information on SNPs detected by mapping (see next section) 
should be considered in the primer design, targeting conserved 
sequence regions and avoiding sequence positions with poly-
morphisms. Primers can be designed to be viral species or strain 
speciﬁc. We suggest using around 500 nt of the putative 
RNA-dependent RNA polymerase (RdRP) sequence as a template, 
which allows efﬁcient ampliﬁcation. PCR may be conducted with 
the polymerase of choice (see Note 11). 
Ampliﬁcation of the viral sequence should also be attempted 
using the DNA of the host isolate as a template. If the distinct PCR 
product is obtained also from the DNA, the virus is also present in 
DNA form (likely integrated into the host genome). 
For our three P. fragariae isolates chosen for the exemplary 
RNA-seq library, Spectrum™ Plant Total RNA Kit was used for 
RNA extraction, random hexamer priming was conducted with 
Revert Aid reverse transcriptase (Thermo Scientiﬁc) following the 
manufacturer’s recommendations for cDNA synthesis, and Dream-
Taq DNA Polymerase was used for the PCR ampliﬁcation. Only 
one of the three isolates (BBA11/94-KO18) gave a positive PCR 
result and thus was identiﬁed as the only isolate hosting the virus. 
3.6 
Virus Variants 
and Mapping 
Virus sequences are often represented by more than one contig in 
the Trinity assembly (see Subheading 3.4.1), which indicates some 
inter- and intraspeciﬁc variations in the virus pool. As mentioned in 
Subheading 3.3, aligning similar contigs are necessary for investi-
gating the possibility of chimeric contigs and the level of sequence 
polymorphism. Such an alignment will allow single nucleotide 
polymorphism (SNP) calling and give an idea about the intraspe-
ciﬁc variation. To avoid the presence of many similar variants in an 
RNA-library, a solution would be to include only distantly related 
oomycetes in the same library (see Subheading 3.1). However, this 
option leads to a higher number of host-speciﬁc contigs (e.g., our 
multiple-host library yielded at least four times the number of 
contigs than pure P. cactorum libraries [8]), and the necessity to 
remove multiple-host genomes. Moreover, the genomes of many

oomycete species are not yet available for public research, and host 
contig removal is not possible for these species. In that case, a 
genome of a closely related oomycete species can be used. In our 
exemplar RNA-Seq library, only one contig representing PfFGV1 
was detected. 
58
Anna Poimala and Eeva Vainio
There are many programs available for mapping RNA-seq raw 
reads against viral contigs (e.g., BWA and samtools software exe-
cuted from command line [20]). For our exemplar library, we 
conducted mapping with Geneious. Another commonly used pro-
gram with a graphical user interface is CLC Genomics Workbench 
(Qiagen). 
1. The raw reads are ﬁrst imported into Geneious. 
2. A single raw read ﬁle is generated by the “Set paired reads” 
command. 
3. The obtained raw read ﬁle with paired reads is mapped against 
the viral contig used as reference using the command “Map to 
reference” (see Note 12). 
In our example, the contig representing PfFGV1 was 8321 nt 
long and 10,103 reads (out of 115 M reads of the entire library) 
mapped to it (i.e., 88 reads per million). When observing the 
mapping results, the 5′ and 3′ termini of the mapped contig should 
be visually inspected. The termini may have very low coverage (e.g., 
less than ﬁve reads), or “extra” reads not belonging to the virus 
sequence may map to these regions with very low overlap. These 
unreliable sequences are then trimmed. After the trimming, our 
ﬁnal PfFGV1 sequence was still coding complete (i.e., included 
complete ORFs) and 8259 nt in length. It was subsequently sub-
mitted to GenBank (accession OK484986). Only nine SNPs were 
detected using the ﬁnd variations/SNPs operation in Geneious 
with a variant frequency set at min. 10% (Fig. 4a,b). 
During read mapping, a high level of viral sequence variability 
in the RNA-seq library may sometimes be detected. Multiple map-
pings using different Maximum Mismatches per read levels (rang-
ing, e.g., from 0 to 30%) may be needed to decipher the individual 
viral sequences. 
If the mapping result shows conserved regions and very variable 
regions following each other sequentially (Fig. 4c), one should be 
wary of the obtained contig sequences possibly being artiﬁcially 
chimeric (see Subheading 3.3). 
3.7 
Characterization 
of Viral ORFs and 
Putative Proteins 
Encoded by the 
Sequence 
The putative ORFs as well as the GC-content of a sequence can also 
be visualized in Geneious (Fig. 5a, Table 2)  (see Note 13). To get 
an idea of the ORF’s function, conserved protein domains can be 
identiﬁed in the protein sequence using NCBI conserved domain 
ﬁnder (https://www.ncbi.nlm.nih.gov/Structure/cdd/wrpsb. 
cgi).

Oomycete Virus Discovery
59
Fig. 4 Visualization of mapping RNA-seq reads against viral contigs in Geneious. (a) A mapping view of the 
8259 nt Phytophthora fragariae fusagravirus 1 contig sequence. (b) Smaller view of the same alignment 
showing 23 nt of the contig sequence including an SNP site. Alternative base (A) is colored red and is present 
in 13.9% of the reads. (c) A 700 nt long view of Phytophthora cactorum alphaendornavirus 1 (PcAEV1; Poimala 
et al. [8]), where reads originate from a library containing ten P. cactorum isolates. Colors indicate alternative 
bases (SNPs) that differ from the contig sequence 
It should be noted that simple ORF analysis does not always 
reveal the true ORFs, e.g., when they are delimited by slippery 
motifs. In this case, their interpretation requires further alignments 
with similar viruses derived from public repositories with annotated 
sequences, and /or the use of speciﬁc programs designed for 
ﬁnding slippery motifs [24]. For example, it is typical for members 
of Totiviridae to have slippery motifs between ORFs encoding the 
putative capsid protein and RdRP; we observed this phenomenon 
in our exemplar virus contig representing a putative new fusagra-
virus (Fig. 5b).

BLASTp identity
60
Anna Poimala and Eeva Vainio
Fig. 5 (a) Visualization of putative Open Reading Frame (ORF) detection and GC-content variation in 
Phytophthora fragariae fusagravirus 1 (PfFGV1) sequence of 8259 b in Geneious. (b) Schematic representation 
of PfFGV1, where the slippery motif (so-called shifty heptamer UUUAAAC), which may facilitate the -1 
programmed ribosomal frameshifting in virus transcripts, is found at the end of ORF1 [26]. This results in the 
putative change in the start codon of ORF2 to begin with leucine (CTA) starting at the end of the shifty 
heptamer and overlapping ORF1 
Table 2 
Characteristics of PfFGV1. The nucleotide (nt) and amino acid (aa) lengths of ORF2 (putative RdRp) 
are given as ORFs detected by Geneious ORF finder and as predicted based on the putative slippery 
motif 
Length 
(nt) 
GC-content 
(%) 
Length 
(aa) 
Conserved 
domains 
Reads 
mapped 
PfFGV1 
ORF1 
3987
58.5%
1315
–
Phytophthora infestans 
RNA virus 3 (45.90%) 
3963 
PfFGV1 
ORF2 
3321/ 
3369 
50.7%
1105/ 
1121 
RT_like 
superfamily 
Phytophthora infestans 
RNA virus 3 (51.85%) 
3738 
3.8 
Phylogenetics
Aligning the obtained viral sequences with those of related viruses 
identiﬁed by BLAST searches allows both the estimation on 
whether the coding sequence is complete (i.e., the predicted 
ORFs resemble those of related viruses in length, sequence homol-
ogy, and possible conserved motifs) and subsequent phylogenetic 
analysis. The universal protein present in all RNA viruses and 
typically used for phylogenetics is the RdRP. The amino acid 
sequences of related viruses are ﬁrst downloaded from GenBank. 
Aligning multiple sequences can be done in Geneious using, for 
example, MAFFT or MUSCLE (tools-multiple align), in the 
MAFFT server available online (https://mafft.cbrc.jp/alignment/ 
server/), or in Mega X (MUSCLE). In our exemplar viral contig, 
based on global protein sequence alignments with similar viruses, 
the coding sequences in the genome were complete. 
For phylogenetic analysis of viral protein sequences, there are 
many free software programs available. We recommend the newest 
version of the MEGA software [25] or IQLTree available as a web

version 
(iqtree.org) 
for 
estimating 
maximum 
likelihood 
(ML) phylogenies (Fig. 6). The alignment is ﬁrst imported to 
MEGA from Geneious or another program in fasta or MEGA 
alignment format. The phylogeny option “Maximum likelihood” 
gives options to select, e.g., the desired number of bootstrap repli-
cations and the substitutions model to be used. In our phylogenetic 
analysis of PfFGV1, we used the LG substitution model, 1000 
bootstrap replicates and 95% partial deletion (Fig. 6). The plugin 
program MrBayes (https://github.com/NBISweden/MrBayes), 
which is available for Geneious, is also a good option for construct-
ing ML phylogenies. The neighbor joining method (available, e.g., 
in MEGA X) is a fast tree building method suitable for preliminary 
phylogenetic assessment and for the analysis of closely related viral 
sequences. 
Oomycete Virus Discovery
61
Fig. 6 Phylogenetic analysis of PfFGV1 based on MAFFT alignment of 23 viral RdRp sequences in Geneious 
using scoring matrix BLOSUM45. Phylogenetic analysis was conducted in MEGA v. 10.0.5 [25] by using the 
maximum likelihood method, with LG substitution model, 1000 bootstrap replicates, and 95% partial deletion

62
Anna Poimala and Eeva Vainio
4 
Notes 
1. Vegetable juice (V8) agar is the most widely used growth 
medium for Phytophthora, but some species may prefer carrot 
agar or rye seed agar. Many useful recipes are given in [1]. 
2. In the absence of cellophane membranes, the mycelia can be 
grown in a liquid medium, e.g., clariﬁed 10% Campbell’s V8 
juice and incubated at 25 °C for most Phytophthora species. 
After about 1 week, the mycelia can be harvested either by 
ﬁltration or centrifugation. 
3. The cultivation time depends on the species. For slow-growing 
species, it is advisable to grow them on multiple membrane-
covered plates to obtain enough mycelia while not allowing 
hyphae age more than a few weeks. 
4. Many of the cultivation steps are applicable to other oomycetes 
also; however, some of them are biotrophic pathogens, mean-
ing that they cannot be cultivated outside the host plant. 
However, their viromes have successfully been analyzed by 
Chiapello et al. [4] by scraping their mycelia directly from 
plant leaves. 
5. RNeasy Plant Mini Kit (Qiagen), SPLIT RNA extraction kit 
(Lexogen), and RNAzol® RT Column Kit (MRC) have been 
successfully used for obtaining high-quality Phytophthora RNA 
for HTS [10, 13, 15]. 
6. For optimal contig production, read lengths up to 250 nt may 
be used. Also, Illumina NextSeq 500 system (2 × 75 nt) has 
been used for oomycete virome metagenomics [9]; however, 
longer reads are advisable for the correct viral genome assembly, 
especially in libraries containing multiple samples. 
7. For a quick, alternative way to obtain a list of contigs that have 
signiﬁcant similarity to viral sequences, you can ﬁrst make a list 
of names of the contigs by 
grep ‘signiﬁcant’ -A 0 -B 20 grep_signiﬁcant.fasta > grep_-
signiﬁcant2.fasta. 
grep ‘Query=‘-A 0 -B 0 grep_signiﬁcant2.fasta > grep_-
signiﬁcant3.fasta. 
The resulting ﬁle can be opened and ﬁxed to Excel columns 
to remove “Query=” from in front of each contig name. The 
ﬁnal list (cleaned_contigs_names.txt) should contain the con-
tig 
names 
in 
full, 
e.g., 
TRINITY_DN7241_c0_g1_i1 
len = 299 path = [0:0–298].

Oomycete Virus Discovery
63
If you have python installed, you can download the faSo-
meRecords script, which extracts records from a fasta ﬁle based 
on 
a 
list 
of 
fasta 
headers. 
To 
derive 
the 
sequences 
corresponding to the contig names in the list, use the following 
commands. 
wget https://raw.githubusercontent.com/santiagosnchez/ 
faSomeRecords/master/faSomeRecords.py 
faSomeRecords -f Trinity.fasta -l cleaned_contig_names.txt
-o cleaned_contigs.fasta 
8. In our experience, the ﬁnal contig list in the case of RNA-Seq 
libraries including only one species with low genetic variation 
(e.g., only isolates representing the strawberry genotype of 
P. cactorum) typically includes 45–85 viral contigs, which can 
also be BLASTed individually in the NCBI BLASTx suite 
against a nonredundant protein database. 
9. Also other commercial kits, such as RNeasy Plant Mini Kit 
(Qiagen) or RNAzol® RT (Sigma-Aldrich) [10, 15], will likely 
result in good-quality RNA from several Phytophthora species 
when following manufacturers’ recommendations. 
10. For viral RNA templates containing secondary structures or a 
high GC content, we recommend using RT enzymes allowing 
the use of elevated cDNA synthesis temperatures, such as 
Maxima H minus reverse transcriptase (Thermo Scientiﬁc) of 
SuperScript IV reverse transcriptase (Thermo Scientiﬁc), which 
are capable of producing long cDNA molecules and have a 
high processivity. 
11. If the viral sequence needs to be conﬁrmed by Sanger sequenc-
ing, it is advisable to choose a high-ﬁdelity polymerase with 
proofreading capacity, such as Phusion High-Fidelity DNA 
Polymerase (Thermo Scientiﬁc). 
12. Selecting higher sensitivity is likely to result in more reads 
being assembled. If the corresponding reads are expected to 
be very variable, the minimum overlap identity and maximum 
mismatches per read may be further decreased, and maximum 
gaps allowed per read increased in the Custom Sensitivity 
section. 
13. ORFs can alternatively be analyzed by the ORFﬁnder in NCBI 
(https://www.ncbi.nlm.nih.gov/orfﬁnder/). 
Acknowledgments 
This work was supported by the European Union’s Horizon 2020 
Research and Innovation Program under Grant Agreement 
No. 773567. We thank Tuija Hyto¨nen, Kirsi Rosenberg, and Juha 
Puranen for assisting with the laboratory work and Dr. Suvi Sutela 
for preliminary data analysis of the exemplar RNA-Seq pool.

64
Anna Poimala and Eeva Vainio
References 
1. Erwin DC, Ribeiro OK (1996) Phytophthora 
diseases worldwide. American Phytopathologi-
cal Society (APS Press), St Paul, p 592 
2. Bonants 
PJM, 
van 
Gent-Pelzer 
MPE, 
Hagenaar-de Weerdt M (2008) Characteriza-
tion and detection of Phytophthora fragariae in 
plant, water and soil by molecular methods. 
EPPO Bullet 30:525–531 
3. Yuen J (2020) Pathogens which threaten food 
security: Phytophthora infestans, the potato late 
blight pathogen. Food Security 13:247–253 
4. Chiapello M, Rodrı´guez-Romero J, Ayllon MA 
et al (2020) Analysis of the virome associated to 
grapevine downy mildew lesions reveals new 
mycovirus lineages. Virus Evol 6:veaa058 
5. Shiba K, Hatta C, Sasai S et al (2019) A novel 
toti-like virus from a plantpathogenic oomy-
cete Globisporangium splendens. Virology 537: 
165–171 
6. Cai G, Myers K, Fry W et al (2019) Phy-
tophthora infestans RNA virus 2, a novel 
RNA virus from Phytophthora infestans, does 
not belong to any known virus group. Arch 
Virol 164:567–572 
7. Kozlakidis Z, Brown NA, Jamal A et al (2010) 
Incidence of endornaviruses in Phytophthora 
taxon douglasﬁr and Phytophthora ramorum. 
Virus Genes 40:130–134 
8. Poimala A, Parikka P, Hantula J et al (2021) 
Viral diversity in Phytophthora cactorum popu-
lation infecting strawberry. Environ Microbiol 
23:5200–5221 
9. Botella L, Jung T (2021) Multiple viral infec-
tions detected in Phytophthora condilina by 
total and small RNA sequencing. Viruses 13: 
620 
10. Raco M, Vainio E, Sutela S et al (2022) High 
diversity of novel viruses in the tree pathogen 
Phytophthora 
castaneae 
revealed 
by 
high-
throughput sequencing of total and small 
RNA. Front Microbiol 13:911474 
11. Hannat S, Pontarotti P, Colson P et al (2021) 
Diverse trajectories drive the expression of a 
giant virus in the oomycete plant pathogen 
Phytophthora parasitica. Front Microbiol 12: 
1–13 
12. Sasai S, Tamura K, Tojo M et al (2018) A novel 
non-segmented doublestranded RNA virus 
from an Arctic isolate of Pythium polare. Virol-
ogy 522:234–243 
13. Botella L, Horta Jung M, Rost M et al (2022) 
Natural populations from the Phytophthora 
palustris complex show a high diversity and 
abundance of ssRNA and dsRNA viruses. J 
Fungi 8:1118 
14. Cai G, Hillman BI (2013) Phytophthora viruses. 
Adv Virus Res 86:327–350 
15. Cai G, Fry WE, Hillman BI (2019) PiRV-2-
stimulates sporulation in Phytophthora infes-
tans. Virus Res 271:197674 
16. Li J, Gu H, Liu Y et al (2021) RNA-seq reveals 
plant virus composition and diversity in alfalfa, 
thrips, and aphids in Beijing, China. Arch Virol 
166:1711–1722 
17. Liu S, Vijayendran D, Bonning BC (2011) 
Next generation sequencing technologies for 
insect virus discovery. Viruses 3:1849–1869 
18. Sutela S, Forgia M, Vainio EJ et al (2020) The 
virome from a collection of endomycorrhizal 
fungi reveals new viral taxa with unprecedented 
genome organization. Virus Evol 6:veaa076 
19. Nerva L, Forgia M, Ciuffo M et al (2019) The 
mycovirome of a fungal collection from the sea 
cucumber Holothuria polii. Virus Res 273: 
197737 
20. Nerva L, Varese GC, Turina M (2018) Differ-
ent approaches to discover mycovirus asso-
ciated to marine organisms. Methods Mol 
Biol 1746:97–114 
21. Poimala A, Raco M, Haikonen T et al (2022) 
Bunyaviruses affect growth, sporulation and 
elicitin production in Phytophthora cactorum. 
Viruses 14:2596 
22. Grabherr MG, Haas BJ, Yassour M et al (2011) 
Full-length 
transcriptome 
assembly 
from 
RNA-Seq data without a reference genome. 
Nat Biotechnol 29:644–652 
23. Bolger AM, Lohse M, Usadel B (2014) Trim-
momatic: 
a 
ﬂexibe 
trimmer 
for 
Illumina 
sequence data. Bioinformatics 30:2114–2120 
24. Poimala A, Vainio E (2020) Complete genome 
sequence of a novel toti-like virus from the 
plant pathogenic oomycete Phytophthora cac-
torum. Arch Virol 165:1679–1682 
25. Kumar S, Nei M, Dudley J et al (2008) MEGA: 
a biologist-centric software for evolutionary 
analysis of DNA and protein sequences. Brief 
Bioinform 9:299–306 
26. Daniel S, Abdoulaye AH, Deng Y et al (2022) 
Molecular characterization of a novel fusagra-
virus in the phytopathogenic fungus Streptobo-
trys caulophylli. Arch Virol 167:619–623 
27. Cai G, Krychiw JF, Myers K et al (2013) A new 
virus from the plant pathogenic oomycete Phy-
tophthora infestans with an 8 kb dsRNA 
genome: the sixth member of a proposed new 
virus genus. Virology 435:341–349 
28. Fukunishi M, Sasai S, Tojo M et al (2021) 
Novel Fusari- and Toti-like viruses, with prob-
able different origins, in the plant pathogenic

32. 
Oomycete Virus Discovery
65
oomycete Globisporangium ultimum. Viruses 
13:1931 
29. Shiba K, Hatta C, Sasai S et al (2018) Genome 
sequence of a novel partitivirus identiﬁed from 
the oomycete Pythium nunn. Arch Virol 163: 
2561–2563 
30. Cai G, Myers K, Hillman BI et al (2009) A 
novel virus of the late bligt pathogen, Phy-
tophthora infestans, with two RNA segments 
and a supergroup 1 RNA-dependent RNA 
polymerase. Virology 392:52–61 
31. Hacker CV, Brasier CM, Buck KW (2005) A 
doublestranded RNA from a Phytophthora spe-
cies is related to the plant endornaviruses and 
contains a putative UDP glycosyltransferase 
gene. J Gen Virol 86:1561–1570 
Uchida K, Sakuta K, Ito A et al (2021) Two 
novel
endornaviruses
co-infecting
a 
Phytophthora pathogen of Asparagus ofﬁcina-
lis modulate the developmental stages and fun-
gicide sensitivities of the host oomycete. Front 
Microbiol 12:633502 
33. Grasse W, Spring O (2017) SsRNA viruses 
from biotrophic oomycetes form a new phyloge-
netic group between Nodaviridae and Tombus-
viridae. Arch Virol 162:1319–1324 
34. Cai G, Myers K, Fry WE et al (2012) A mem-
ber of the virus family Narnaviridae from the 
plant 
pathogenic 
oomycete 
Phytophthora 
infestans. Arch Virol 157:165–1699 
35. Botella L, Janousˇek J, Maia C et al (2020) 
Marine oomycetes of the genus Halophy-
tophthora harbor viruses related to Bunya-
viruses. Front Microbiol 11:1467

Chapter 5 
Metagenomic Analyses of Viruses in the Orchid Mycorrhizal 
Interaction Using Improved Assemble Tools 
Kota Kambara, Hanako Shimura, Kaien Fujino, and Chikara Masuta 
Abstract 
In nature, mycorrhizal association with soil-borne fungi is indispensable for orchid species. Compatible 
mycorrhizal fungi form endo-mycorrhizal structures in orchid cells, and the fungal structures are digested 
in orchid cells to be supplied to orchids as nutrition. Because orchid seeds lack the reserves for germination, 
they keep receiving nutrition through mycorrhizal formation from seed germination until nonphotosyn-
thetic young seedlings develop leaves and become photoautotrophic. Seeds of all orchids germinate with 
the help of their own fungal partners, and therefore, speciﬁc partnership has been acquired in a long 
evolutionary history between orchids and fungi. Assuming that horizontal transmission of viruses may 
occur in such a close relationship, we are focusing on viruses that infect orchids and their mycorrhizal fungi. 
We prepared aseptically germinated orchid plants (i.e., fungi-free plants) together with pure-cultured 
fungal isolates and conducted transcriptome analyses (RNA-seq) by next-generation sequencing (NGS) 
approach. To reconstruct virus-related sequences that would have been present in the RNA sample of 
interest, de novo assembly process is required using short read sequences obtained from RNA-seq. In the 
previous version of our protocol (see Viral Metagenomics, ﬁrst edition 2018), virus searches were con-
ducted using contig sets constructed by a single assembler, but this time we devised a method to construct 
more reliable contigs using multiple assemblers and again reinvestigated that viruses could be detected. 
Because the virus detection efﬁciency and number of detected virus species clearly differed depending on 
the assembly pipeline and the number of the input data, multiple methods should be used to identify viral 
infection, if possible. 
Key words De novo assembly, In vitro tissue culture, Mycorrhizal fungi, Mycovirus, Orchid 
1 
Introduction 
Viruses are found throughout the major taxonomic group of fungi. 
In the study of viruses infecting fungi (i.e., mycoviruses), previously 
unknown viruses with unique genomic structures and lifestyles have 
been revealed, and there is much interest and attention in the 
ecological characteristics and diversity of mycoviruses [1]. Mycov-
iruses in pathogenic fungi sometimes cause phenotypic alterations 
such as debilitation, and the mycovirus-mediated attenuation of
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_5, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
67

fungal virulence is called hypovirulence [2]. Some phytopathogenic 
fungi, such as chestnut blight Cryphonectria parasitica and white 
root rot Rosellinia necatrix, have been well-studied on the hypo-
virulence effects by virus infection [3–5]. The hypovirulence of 
fungi by mycoviruses suggests that viruses change the various traits 
of fungi and further affect the interaction between fungi and fungi-
infected plants. On the other hand, mycoviruses infecting non-
pathogenic fungi such as endophytic fungi and mycorrhizal fungi, 
which have a mutualistic relationship with the plant, have been little 
studied. Arbuscular mycorrhizal (AM) fungi that belong to the 
phylum Glomeromycota are ubiquitous in terrestrial ecosystems 
and form mutualistic associations with most land plants [6]. Previ-
ously, our research group found that there were four distinct 
dsRNA viruses in an AM fungus, and one of the dsRNA was a 
biologically 
active 
component 
in 
the 
symbiotic 
interaction 
[7]. Now, we are studying mycoviruses in the orchid mycorrhizal 
(OM) fungi that associate with the largest plant family, Orchida-
ceae. All orchids need compatible OM fungi for seed germination 
because tiny seeds lack the reserves for germination. The interac-
tion between orchids and OM fungi is unique in that fungal mycor-
rhizal structures are digested in orchid cells, and then carbon 
nutrition derived from fungi is transferred to orchids, although 
the beneﬁcial aspect for fungi is not well understood. To know 
whether any viruses can infect OM fungi and affect the physiologi-
cal characteristics of the host fungi, we have studied dsRNAs 
infected in OM fungi. We recently reported that several mycov-
iruses were in OM fungi; one of the mycoviruses belonged to the 
family Partitiviridae [8]. Viruses in the Partitiviridae have been 
shown to infect plants, fungi, and protozoa, and horizontal transfer 
of partitivirus beyond the kingdom has been suggested [9, 10]. The 
partitivirus we identiﬁed from OM fungi showed RNA silencing 
suppressor activity in both fungi and plants, suggesting that such 
viruses may also be capable of horizontal transmission [8]. Mean-
while, there are few reports on viral transmission between plants 
and other hosts because a rigorous experimental system that avoids 
contamination concerns is necessary, and such experiments are 
difﬁcult for samples from natural systems in which diverse organ-
isms exist.
68
Kota Kambara et al.
To avoid contamination derived from fungal sources, in the 
ﬁrst edition of our chapter in this book [11], we proposed protocols 
for the preparation of dsRNAs from orchid seedlings generated 
from in vitro culture because the aseptically cultured orchid should 
not have any fungal viruses. In addition, we conducted metage-
nomic analyses of the dsRNAs extracted from in vitro orchid tissues 
and OM fungi and found that partitivirus in the OM fungi was 
located in the same clade as that for the partitivirus-like sequences 
derived from orchid tissues by a phylogenetic analysis. In a compre-
hensive search for viral sequences, we need to collect sequence

information by de novo assembly from transcriptome data and then 
ﬁnd virus-related sequences. There are various tools for de novo 
assembly, and the quality of constructed contig sets depends on the 
assembler tools used. In this second edition, we performed de novo 
assembly again using different tools (Trinity, IBDA-Tran, and their 
combined pipeline) to reanalyze virus-related sequences in the 
previously obtained RNA-seq data. In this study, we also prepared 
newly obtained RNA-seq data from the same OM fungi and in vitro 
cultures to detect viral sequences and compare them with the 
previous results. The virus detection efﬁciency and number of 
detected virus species differed depending on the assembly pipeline 
and the number of input data. Using multiple assembly tools and 
detecting viruses that are as common as possible among those tools 
will increase the possibility that the specimens are indeed infected 
with those viruses. 
Virus Detection with Improved de novo Assembly Pipeline
69
2 
Material 
2.1 
In Vitro Tissue 
Culture of Orchid 
Plants 
1. Orchid seed: We use Cypripedium macranthos var. rebunense, 
which was derived from a wild population in Rebun Island, 
Hokkaido, Japan. Mature capsules of C. macranthos var. rebu-
nense were collected in September (about 90 days after pollina-
tion) at Rebun Island with the permission of the Ministry of 
Environment, Japan. 
2. Culture medium for orchid: We used modiﬁed T-medium 
[12]; KH2PO4 545 mg/L, Ca(NO3)2•4H2O 470 mg/L, 
MgSO4•7H2O 245 mg/L, KNO3 200 mg/L, NH4NO3 
120 mg/L, Na2-EDTA 37.3 mg/L, FeSO4•7H2O 27.8 mg/ 
L, 
MnSO4•4H2O 
3 
mg/L, 
ZnSO4•7H2O 
0.5 
mg/L, 
CuSO4•5H2O 0.025 mg/L, Na2MoO4•2H2O 0.025 mg/L, 
H3BO3 0.5 mg/L, CoCl2•6H2O 0.025 mg/L, KI 0.025 mg/ 
L, sucrose 20 g/L, 1 μM 6-benzylaminopurine (BA), and agar 
6 g/L. Adjust pH to 5.5 with KOH. Autoclave for 7 min. 
3. 10% sodium hypochlorite. 
4. Tween-20. 
5. Sterilized water. 
6. Bag (30 × 30 mm) made from Nylon mesh (50 μm opening). 
7. Scissors (sterilized). 
8. Tweezers (sterilized). 
9. 9-cm Petri dish (sterilized). 
2.2 
In Vitro Culture of 
Mycorrhizal Fungi 
1. Orchid mycorrhizal fungi: Those were isolated from roots of C. 
macranthos var. rebunense or other orchid species. Some iso-
lates (e.g., WO97 isolate) were conﬁrmed to induce symbiotic

70
Kota Kambara et al.
germination of C. macranthos var. rebunense [13, 14]. All iso-
lates are kept on OMA1, 2 g/L ﬁne oatmeal powder 
(40 mesh), and 15 g/L agar, in dark at 20 °C. 
2. Fungal culture medium for RNA preparation: Oatmeal broth 
medium; 2 g/L ﬁne oatmeal powder without agar. 
3. 9-cm Petri dish (sterilized). 
2.3 
Preparation of 
Plant and Fungal RNAs 
1. DsRNA extraction buffer: 100 mM Tris–HCl pH 8.0, 200 mM 
NaCl, 2 mM EDTA, 1% SDS, 0.1% 2-Mercaptoethanol. 
2-Mercaptoethanol is added to the buffer just before use. 
2. TE-saturated phenol. 
3. TE-saturated phenol–chloroform (w/w = 1:1). 
4. Chloroform. 
5. 3 M sodium acetate pH 5.2. 
6. 99.5% ethanol. 
7. 100 ~ 200 U/μl S1 nuclease: We use Takara S1 nuclease. 
2.4 
Bioinformatics
1. Trimmomatic v3.3 [15] https://github.com/usadellab/ 
Trimmomatic. 
2. Cutadapt [16] https://cutadapt.readthedocs.io/en/stable/. 
3. Rcorrector v1.0.5 [17] https://github.com/mourisl/ 
Rcorrector. 
4. Trinity v2.13.2 [18] https://github.com/trinityrnaseq/ 
trinityrnaseq/wiki. 
5. IDBA-Tran v1.1.3 [19] https://github.com/loneknightpy/ 
idba. 
6. CD-HIT v4.8.1 [20] https://github.com/weizhongli/cdhit. 
7. EvidentialGene tr2aacds [21] http://arthropods.eugenes.org/ 
genes2/about/EvidentialGene_trassembly_pipe.html. 
8. TransDecoder v 5.5.0 https://github.com/TransDecoder/ 
TransDecoder. 
9. Bowtie2 v2.4.4 [22] https://github.com/BenLangmead/ 
bowtie2. 
10. DIAMOND v2.0.7 https://github.com/bbuchﬁnk/ 
diamond. 
11. RefSeq release viral, NCBI [23] https://www.ncbi.nlm.nih. 
gov/refseq/ (see Note 1).

Virus Detection with Improved de novo Assembly Pipeline
71
3 
Methods 
We previously developed in vitro propagation for Cypripedium 
macranthos var. rebunense, which is a Japanese wild orchid 
[24]. We also maintain several mycorrhizal fungi isolated from C. 
macranthos and other orchids by pure culture [13]. In the ﬁrst 
edition of the book, we isolated orchid RNAs derived from 
in vitro-cultures in addition to pure-cultured fungal mycelia and 
conducted a metagenomic analysis to detect any viruses from an 
orchid and mycorrhizal fungi. We found that partitivirus-related 
sequences derived from both orchid cultures and OM fungi, but 
the detection of viral sequences from in vitro orchid tissues was 
ambiguous in repetitive experiments. We here used a more robust 
de novo assembly process to recheck the presence of virus-related 
sequences. 
3.1 
In Vitro Tissue 
Culture of Orchid 
Plants 
1. Dissect the mature capsule longitudinally and scrape off seeds 
from a capsule. Transfer seeds (ca. 5 mg) into a bag of nylon 
mesh. Sterilize the nylon mesh bags with 10% sodium hypo-
chlorite supplemented with a few drops of Tween-20 for 
30 min and then wash thoroughly with sterilized water. 
2. Nylon mesh bags are transferred to a sterilized Petri dish. Open 
the bag with scissors and tweezers. Sow seeds on 20-mL cul-
ture medium in a 9-cm Petri dish. 
3. Keep the plates at 4 °C in the dark to break seed dormancy for 
9–12 weeks and then incubate at 20 °C in the dark. 
4. After 10–16 weeks of incubation at 20 °C, seeds usually germi-
nate and grow into protocorm (protocorm is an orchid-
speciﬁc, young seedling form before organ development). 
When seedlings have roots and grow to a large size, transfer 
seedlings to the same fresh medium in the 100-mL conical ﬂask 
or 300-mL culture bottle (see Note 2). 
3.2 
In Vitro Culture of 
Mycorrhizal Fungi 
1. To prepare an inoculum, incubate fungi isolated from roots of 
C. macranthos var. rebunense or other orchid roots in OMA1. 
For RNA extraction, we used WO97 isolate [13] and its deriv-
ative subcultures. 
2. When extracting RNAs from fungal mycelium, incubate fungi 
in a liquid oatmeal medium for 9 weeks (20 °C, in dark). After 
incubation, remove the excess medium by ﬁltration. Freeze the 
harvested mycelium with liquid N2 and keep it at -80 °C until 
use (see Note 3). 
3.3 
Preparation of 
Double-Stranded RNA 
1. Homogenize 0.1 g tissues in liquid N2 using a mortar and 
pestle and immediately transfer the frozen powder into a 
1.5 mL microtube containing 500 μl of TE-saturated phenol 
and 500 μl of the dsRNA extraction buffer (see Note 4).

f
72
Kota Kambara et al.
2. Vortex for 15 s and centrifuge for 3 min at 12,000 rpm at room 
temperature. 
3. Transfer the aqueous phase to a new tube and add an equal 
volume of TE-saturated phenol–chloroform. Vortex the mix-
ture for 15 s and then centrifuge for 5 min at 14,000 rpm at 
room temperature (approximately 450 μl of aqueous phase can 
be recovered). 
4. Repeat 
TE-saturated 
phenol–chloroform 
extraction 
(see 
Note 5). 
5. Collect the aqueous phase in a new tube and add 1/10 volume 
of 3 M sodium acetate pH 5.2 and three volumes of 100% 
ethanol and then mix and turn over the tube gently. 
6. Centrifuge for 15 min at 14,000 rpm at 4 °C. Carefully remove 
the supernatant and wash the pellet with 500 μl of 70% ethanol 
followed by a spin at 14,000 rpm for 5 min at 4 °C. 
7. Discard the supernatant and spin again at 14,000 rpm for 1 min 
to remove the residual supernatant. 
8. Vacuum-dry or let it stand until it dries (for 5 min at room 
temperature). Then, resuspend the pellet in 30 ~ 50 μl o  
RNase-free water. 
9. Quantify the extracted nucleic acids by spectrophotometer and 
check 
a 
normal 
band 
pattern 
by 
1.2% 
agarose 
gel 
electrophoresis. 
10. Process extracted nucleic acids to DNase I treatment as follows: 
Incubate reaction mixture (5 μl of 10X TURBO DNase buffer, 
5 μg of total nucleic acids, 2 μl of TURBO DNase, and RNase-
free water up to 50 μl) at 37 °C for 30 min. Add RNase-free 
water up to 100 μl and extract RNAs by phenol–chloroform 
(see Note 5). Transfer the aqueous phase (ca. 100 μl) to a new 
tube and add 1/10 volume of 3 M sodium acetate pH 5.2 and 
three volumes of 100% ethanol and then mix and turn over 
gently. Keep the mixtures at -30 °C overnight. For precipita-
tion of RNAs, centrifuge a tube at 14,000 rpm for 20 min (4 ° 
C) and resuspend the pellet in 20 ~ 30 μl of RNase-free water. 
Quantify and check RNAs by spectrophotometer and 1.2% 
agarose gel electrophoresis. 
11. Process extracted total RNA to S1 nuclease treatment as fol-
lows: Incubate a reaction mixture (5 μl of 10X S1 Nuclease 
buffer, 5 μg of RNA, 2 μl of S1 Nuclease, and RNase-free water 
up to 50 μl) at 37 °C for 30 min. Add RNase-free water up to 
100 μl and extract RNAs by phenol–chloroform (see Note 6). 
Transfer the aqueous phase (ca. 100 μl) to a new tube and add 
1/10 volume of 3 M sodium acetate pH 5.2 and three volumes 
of 100% ethanol. Mix and invert the tube gently. After cooling 
at -30 °C overnight, precipitate dsRNAs by centrifugation

Virus Detection with Improved de novo Assembly Pipeline
73
Table 1 
Sequence data used in this report 
Sample name
Data yield (Mb) 
Reads (bases) 
% of Q30 
Fungi-I dsRNA 2013
4727
46,798,910
96.3 
Fungi-I dsRNA 2019
4657
46,109,922
96.1 
Fungi-II dsRNA 2019
4709
46,621,450
96.2 
Orchid-I dsRNA 2013
4089
40,486,758
95.9 
Orchid-I dsRNA 2019
4126
40,852,958
96.0 
Orchid-II dsRNA 2019
4554
45,088,132
94.6 
(14,000 rpm, 20 min, 4 °C) and resuspend the pellet in RNase-
free water. Quantify and check dsRNAs by spectrophotometer 
and 1.2% agarose gel electrophoresis (see Note 7). 
3.4 
RNA Sequencing 
(Our Example) 
1. As new dsRNA samples for RNA-seq, we prepared two kinds of 
dsRNA from in vitro-cultured orchid tissue; one is tissues 
derived from the same in vitro seedling of C. macranthos var. 
rebunense used in a previous analysis [11] and had been stored 
in -80 °C. The other is the tissue of in vitro seedlings obtained 
by aseptic germination of seeds collected in 2019. Two 
dsRNAs sampled from in vitro orchids were designated as 
“Orchid-I dsRNA 2019” and “Orchid-II dsRNA 2019” 
(Table 1). For dsRNA samples from fungi, we prepared two 
kinds of dsRNA for this second edition. One is dsRNA 
extracted from the mycelium of WO97 isolate maintained by 
annual subculture. We have a derivative strain of WO97 that 
has the capability to induce germination of C. macranthos var. 
rebunense. dsRNAs were also extracted from the derivative 
strain of WO97 and subjected to RNA-seq. Two dsRNAs 
sampled from the fungus were designated as “Fungi-I dsRNA 
2019” and “Fungi-II dsRNA 2019” (Table 1). 
2. These dsRNAs are processed for RNA-seq analysis by a stan-
dard protocol depending on which high-throughput sequenc-
ing provider is used (e.g., we use Hokkaido System Science, 
Japan). 
3. Process RNA samples for library preparation using TruSeq 
RNA sample Prep Kit (Illumina) according to standard proto-
cols. Fractionate RNAs by divalent cation treatments and then 
conduct reverse transcription, adaptor ligation, and PCR 
ampliﬁcation (see Note 8). After puriﬁcation and elimination 
of small molecules (< 200 bp) by AMPure XP beads, apply the 
prepared library samples to 100-bp paired-end sequencing 
using Illumina Hiseq 2000 (see Note 9).

74
Kota Kambara et al.
4. In our example, we obtained the numbers of sequence reads 
between 40 and 50 million for each library. In addition to 
newly obtained RNA-seq data, two RNA-seq data already 
described in the ﬁrst edition [11] are also used for further de 
novo assembly and virus search analysis. Here, “Orchid 
(in vitro) dsRNA” in ﬁrst edition is shown as “Orchid-I 
dsRNA 2013,” and “Fungi (cultured) dsRNA” in ﬁrst edition 
is shown as “Fungi-I dsRNA 2013” (Table 1). 
3.5 
Raw Read 
Processing and De 
Novo Assembly 
1. Raw reads were processed by Trimmomatic v3.3 and Cutadapt 
to remove adapter sequences and low-quality reads. Rcorrector 
v1.0.5 is used for error correction. When using multiple tran-
scriptomes as input for de novo assembly, merge all reads and 
then process the mixed raw reads (see Note 10). 
2. Run de novo assembly. In our example, two assemblers 
are used: Trinity v2.13.2 and IDBA-Tran v1.1.3 (see Note 11). 
3. For assembly by IDBA-Tran, minimize the effect of k-mer 
length by making assemblies using eight patterns of k-mer 
setting (from k-mer = 25 to k-mer = 95 with 10 steps) and 
combine them by CD-HIT-EST v4.8.1 (parameter -c is set to 
0.99, [20]) (see Note 12). 
4. To combine assemblies from Trinity and IDBA-Tran using 
EvidentialGene tr2aacds pipeline. 
3.6 
Evaluation of 
Assemblies 
1. Evaluate contigs obtained by de novo assembly, for example, by 
the total number of contigs, max/min contig length, N50 (the 
sequence length of the shortest contig at 50% of the total 
assembly length), mapping rate or percentage of BLAST hit 
contig. To estimate the completeness of assembly, use BUSCO 
search for evaluating the rate of universal single-copy orthologs 
in the assembly. 
2. To count reads mapped to the contigs, run Bowtie2 using the 
obtained contig as a reference (see Note 13). 
3. For the BLAST search, we use DIAMOND v2.0.13 against the 
RefSeq viral database with the e-value setting to 1e-20. 
4. For the prediction of coding sequence (CDS) regions in the 
contigs, run TransDecoder v 5.5.0 using the results from the 
DIAMOND blastp search against the RefSeq viral data and 
hammer v3.3.2 (see Note 14). 
5. Using these methods, we checked virus-related sequences in 
the contigs constructed based on the transcriptome data from 
in vitro orchid- or fungi-derived dsRNA. The transcriptome 
data used in this analysis are shown in Table 1. For the three 
sets of transcriptome data from fungal dsRNA (Fungi-I dsRNA 
2013, Fungi-I dsRNA 2019, and Fungi-II dsRNA 2019), the 
total number of contigs, total length, percentage (%) of the

mapped reads, maximum/minimum contig length with Trinity 
or IDBA-Tran as an assembler, or with the integrated pipeline 
using both assemblers are summarized in Table 
Virus detec-
tion in the fungal dsRNA-derived contigs constructed using 
different assemble pipelines is summarized in Table 
The use 
of TransDecoder greatly reduced the total number of the con-
tigs resulting in efﬁcient virus detection. In contrast, the 
mapping efﬁciency showed high values without TransDecoder. 
3. 
2. 
name
Assembler contigs
length
reads (%)
Virus Detection with Improved de novo Assembly Pipeline
75
Table 2 
Summary of the assemble results of fungi dsRNA-derived contigs using different assemble pipelines 
Sample
No. of
Total
Mapped 
Max 
length 
(bp) 
Min 
length 
(bp) 
Fungi-I 
dsRNA 
2013 
Trinity
5841
1,916,834 93.2
16,298
198 
IDBA-
Tran 
4894
1,822,758 93.1
18,253
200 
Integrated 
1350
672,959
91.8
18,253
200 
Fungi-I 
dsRNA 
2019 
Trinity
6758
2,575,297 99.4
22,321
180 
IDBA-
Tran 
5713
2,555,081 99.2
28,731
200 
Integrated 
2436
1,323,081 78.1
28,731
201 
Fungi-II 
dsRNA 
2019 
Trinity
1150
489,431
99.3
15,529
201 
IDBA-
Tran 
1047
499,992
99.2
15,536
200 
Integrated 
341
234,621
95.4
15,536
201 
Fungi-I 
dsRNA 
2013 
Trinity
719
434,628
80.3
14,487
258 
IDBA-
Tran 
822
431,697
80.2
9150
261 
Integrated 
658
332,832
79.9
14,487
258 
Fungi-I 
dsRNA 
2019 
Trinity
1792
888,888
3.7
4713
258 
IDBA-
Tran 
2008
1,030,947 
2.6
4713
267 
Integrated 
1687
853,539
5.4
4713
279 
Fungi-II 
dsRNA 
2019 
Trinity
273
151,560
31.4
9300
276 
IDBA-
Tran 
314
165,585
36.3
10,590
264 
Integrated 
238
137,193
35.0
12,021
276

When TransDecoder was not used but the two assemblies were 
integrated, the virus detection efﬁciency was higher than that 
by a single assembler (Table ). The results of de novo assembly 
and virus detection using in vitro orchid-derived data (Orchid-
I dsRNA 2013, Orchid-I dsRNA 2019, and Orchid-II dsRNA 
2019) were shown in Tables 
and 
. Similar to the results of 
the analysis of fungal dsRNA, the total number of contigs was 
greatly reduced, and the detection efﬁciency of virus-hit-con-
tigs was higher when TransDecoder was applied. For the virus 
detection in orchid-derived dsRNA, the integration of assem-
blies did not largely enhance the virus detection efﬁciency. 
When we performed de novo assembly using a mixture of the 
5
4 
3
name
Assembler Contigs hit-contigs
%
76
Kota Kambara et al.
Table 3 
Virus detection in fungi dsRNA-derived contigs using different assemble pipelines 
Virus Bacteriophage 
Fungi-I dsRNA 
2013 
Trinity
5841
488
8.4 75
162 
IDBA-
Tran 
4894
514
10.5 59
133 
Integrated 
1350
186
13.8 41
71 
Fungi-I dsRNA 
2019 
Trinity
6758
422
6.2 88
34 
IDBA-
Tran 
5713
443
7.8 89
31 
Integrated 
2436
240
9.9 73
25 
Fungi-II dsRNA 
2019 
Trinity
1150
88
7.7 43
8 
IDBA-
Tran 
1047
96
9.2 35
8 
Integrated 
341
43
12.6 24
5 
Fungi-I dsRNA 
2013 
Trinity
719
187
26.0 32
68 
IDBA-
Tran 
822
206
25.1 31
70 
Integrated 
658
165
25.1 34
70 
Fungi-I dsRNA 
2019 
Trinity
1792
266
14.8 71
27 
IDBA-
Tran 
2008
328
16.3 74
25 
Integrated 
1687
247
14.6 73
29 
Fungi-II dsRNA 
2019 
Trinity
273
44
16.1 22
5 
IDBA-
Tran 
314
42
13.4 20
5 
Integrated 
238
38
16.0 21
5

name
Assembler contigs
Total length
reads (%)
Virus Detection with Improved de novo Assembly Pipeline
77
Table 4 
Summary of the assemble results of in vitro orchid dsRNA-derived contigs using different assemble 
pipelines 
Sample
No. of
Mapped 
Max 
length 
(bp) 
Min 
length 
(bp) 
Orchid-I 
dsRNA 
2013 
Trinity
43,787 
19,083,570
95.5
8643
177 
IDBA-
Tran 
51,882 
28,305,635
96.3
12,486 
200 
Integrated 
16,815 
9,310,175
87.9
12,486 
177 
Orchid-I 
dsRNA 
2019 
Trinity
44,092 
18,942,424
97.7
18,560 
181 
IDBA-
Tran 
59,253 
28,666,832
98.1
18,600 
200 
Integrated 
18,427 
9,550,121
91.2
18,600 
200 
Orchid-II 
dsRNA 
2019 
Trinity
51,569 
22,274,068
97.7
11,922 
177 
IDBA-
Tran 
67,838 
34,194,174
98.3
10,712 
200 
Integrated 
21,528 
11,559,630
90.9
11,922 
184 
All reads 
mixed 
Trinity
88,936 
36,297,755
97.4
18,982 
178 
IDBA-
Tran 
103,788 50,728,576
97.1
34,805 
200 
Integrated 
33,679 
17,795,832
93.2
34,805 
189 
Orchid-I 
dsRNA 
2013 
Trinity
8530
3,975,723
22.6
4470
255 
IDBA-
Tran 
13,253 
6,684,456
23.2
5340
255 
Integrated 
6351
3,089,607
24.5
5340
261 
Orchid-I 
dsRNA 
2019 
Trinity
9055
4,449,741
32.8
6933
255 
IDBA-
Tran 
14,318 
6,987,069
34.2
6933
255 
Integrated 
6838
3,326,172
33.8
6933
255 
Orchid-II 
dsRNA 
2019 
Trinity
10,140 
4,766,799
20.6
5031
258 
IDBA-
Tran 
16,328 
7,931,517
23.0
4743
255 
Integrated 
7783
3,763,254
22.7
5031
255 
All reads 
mixed 
Trinity
16,789 
7,695,276
20.5
6678
255 
IDBA-
Tran 
24,330 
11,697,726
28.9
6933
255 
Integrated 
12,961 
6,132,612
29.7
6933
255

Sample name
Assembler Contigs
hit-contigs
%
78
Kota Kambara et al.
Table 5 
Virus detection in in vitro orchid dsRNA-derived contigs using different assemble pipelines 
Virus Bacteriophage 
Orchid-I 
dsRNA 
2013 
Trinity
43,787 
3629
8.3 189 
212 
IDBA-
Tran 
51,882 
4635
8.9 174 
140 
Integrated 
16,815 
1671
9.9 142
94 
Orchid-I 
dsRNA 
2019 
Trinity
44,092 
4306
9.8 175
19 
IDBA-
Tran 
59,253 
5930
10.0 170
23 
Integrated 
18,427 
2054
11.1 124
14 
Orchid-II 
dsRNA 
2019 
Trinity
51,569 
4525
8.8 175
18 
IDBA-
Tran 
67,838 
6206
9.1 179
21 
Integrated 
21,528 
2215
10.3 140
16 
All reads 
mixed 
Trinity
88,936 
7752
8.7 237 
228 
IDBA-
Tran 
103,788 
9766
9.4 232 
151 
Integrated 
33,679 
3562
10.6 194 
108 
Orchid-I 
dsRNA 
2013 
Trinity
8530
1664
19.5 132
99 
IDBA-
Tran 
13,253 
2898
21.9 135
92 
Integrated 
6351
1291
20.3 129
98 
Orchid-I 
dsRNA 
2019 
Trinity
9055
1931
21.3 113
16 
IDBA-
Tran 
14,318 
3077
21.5 118
15 
Integrated 
6838
1490
21.8 104
14 
Orchid-II 
dsRNA 
2019 
Trinity
10,140 
2016
19.9 128
14 
IDBA-
Tran 
16,328 
3364
20.6 138
15 
Integrated 
7783
1606
20.6 120
14 
All reads 
mixed 
Trinity
16,789 
3059
18.2 178 
110 
IDBA-
Tran 
24,330 
4949
20.3 189 
101 
Integrated 
12,961 
2588
20.0 178 
110

Virus Detection with Improved de novo Assembly Pipeline
79
three transcriptome data sets (all derived from in vitro cultured 
C. macranthos var. rebunense), we found that the percentages of 
virus-hit-contigs decreased probably due to the increased total 
number of the contigs, but the number of virus species 
detected was greater than that by a single data set (Table 5). 
At present, there is no de novo assembly pipeline that is optimal 
for any and all downstream analyses. This approach where 
multiple assembly tools are used for a mixture of multiple 
transcriptome data sets will be useful for comprehensive virus 
detection. 
6. In the ﬁrst edition [11], the virus sequences closely related to 
the partitiviruses in the OM fungi were also detected in in vitro 
cultured C. macranthos var. rebunense. However, in this analysis 
where different methods were used, no such virus-related 
sequence was detected in the orchid dsRNAs. In addition, the 
transcriptome data from the mycelium of subcultured strains 
showed a different virus proﬁle from those of the previously 
subcultured ones, suggesting the possibility that mycoviruses 
infect heterogeneously in host fungus, and that subculturing 
may affect the diversity of infected mycoviruses (see Note 15).
4 
Notes 
1. For the bioinformatics analysis, it is recommended to use the 
latest version of the tools to avoid errors. 
2. Please refer to the ﬁrst edition [11] for images of orchid seeds 
and in vitro cultures used as materials. To avoid excessive 
browning that causes negative effects on normal tissue devel-
opment, it is better that protocorm and seedlings are trans-
ferred to a fresh medium every 3 months. 
3. Depending on the fungal isolate, obtaining enough volume of 
mycelium for RNA preparation takes more than 3 months. 
However, a prolonged culture may cause lower efﬁciency for 
RNA extraction. 
4. As appropriate, the buffer volume should be scaled up. 
5. TE-saturated 
phenol–chloroform 
extraction 
should 
be 
repeated until the middle phase almost disappears. 
6. Instead of TE-saturated phenol, the use of acid phenol is better. 
7. When mycoviruses abundantly accumulate in a fungal isolate, 
we can see some bands of dsRNA (derived from mycoviruses) 
in this electrophoresis. 
8. This PCR ampliﬁcation step is conducted in all samples to 
increase the library concentration to an appropriate level for 
sequencing. The number of the ampliﬁcation cycle is generally 
less than 4.

80
Kota Kambara et al.
9. About the construction of cDNA libraries: First-strand cDNA 
synthesis is performed using random hexamers as a primer to 
ensure that we capture all the viral RNAs in the sample. We can 
give RNAs directly to a provider but recommend that ﬁrst-
strand cDNA synthesis should be performed with our own 
hands because dsRNAs are normally very small in quantity 
and must be well-denatured before ﬁrst-strand synthesis. The 
RNA-DNA hybrids can be given to a provider to eventually 
generate dsDNA libraries; the provider adds an adapter to the 
dsDNAs. 
10. For preprocessing the FASTQ ﬁle, fastp v0.23.2 [25] is also 
recommended. 
11. In our preliminary study using another transcriptome data set, 
we evaluated the efﬁcacy of contig construction using ﬁve 
assemblers (Trinity, IDBA-Tran, velvet, rnaSpades and transA-
byss) and integration of multiple assemblies and judged that 
integration of assemblies from Trinity and IDBA-Tran was the 
best based on the rates of BLAST hit contigs and complete 
BUSCO (Benchmarking Universal Single-Copy Orthologs). 
12. Because the k-mer length cannot be speciﬁed in Trinity (25 k-
mer), the process is not applied to Trinity. 
13. Salmon v1.7.0 [26] is also fast and easy to use for mapping the 
processed reads to the contig set. 
14. The use of TransDecoder reduces the number of contigs and 
thus may drop necessary information, so it is better to run both 
with and without using TransDecoder and compare the 
validity. 
15. To verify that the viral sequences found by high-throughput 
sequencing existed in the plants and fungi, perform RT-PCR to 
detect the same sequences designing the primers according to 
the high-throughput sequencing results. 
Acknowledgments 
We appreciate Ms. Chieko Hirata for her technical help and Botan-
ical Garden, Hokkaido University for giving us orchid materials. We 
would like to thank Dr. Tetsuo Takano and Dr. Daisuke Tsugama 
(The University of Tokyo, Japan) for allowing us to use their 
computer. Computational analysis was partially performed on the 
NIG supercomputer at the Research Organization of Information 
and Systems (ROIS), National Institute of Genetics (NIG) (Shi-
zuoka, Japan). This work was partly supported by JSPS KAKENHI 
Grant Number JP17K19253.

Virus Detection with Improved de novo Assembly Pipeline
81
References 
1. Kondo H, Bottela L, Suzuki N (2022) Mycov-
irus diversity and evolution revealed/inferred 
from recent studies. Annu Rev Phytopathol 60: 
307–336 
2. Nuss DL (2005) Hypovirulence: mycoviruses 
at the fungal-plant interface. Nat Rev Micro-
biol 8:632–642 
3. Anagnostakis SL (1982) Biological control of 
chestnut blight. Science 215:466–471 
4. Wei CZ, Osaki H, Iwanami T et al (2004) 
Complete nucleotide sequences of genome 
segments 1 and 3 of Rosellinia antirot virus in 
the family Reoviridae. Arch Virol 149:773–777 
5. Chiba S, Salaipeth L, Lin YH et al (2009) A 
novel bipartite double-stranded RNA Mycov-
irus from the white root rot fungus Rosellinia 
necatrix: molecular and biological characteriza-
tion, taxonomic considerations, and potential 
for biological control. J Virol 83:12801– 
12812 
6. Smith SE, Read DJ (2008) Mycorrhizal symbi-
osis, 3rd edn. Academic Press, London, p 800 
7. Ikeda Y, Shimura H, Kitahara R et al (2012) A 
novel virus-like double-stranded RNA in an 
obligate biotroph arbuscular mycorrhizal fun-
gus: a hidden player in mycorrhizal symbiosis. 
Mol Plant-Microbe Interact 25:1005–1012 
8. Shimura H, Kim H, Matsuzawa A et al (2022) 
Coat protein of partitiviruses isolated from 
mycorrhizal fungi functions as an RNA silenc-
ing suppressor in plants and fungi. Sci Rep 12: 
7855 
9. Nibert ML, Ghabrial SA, Maiss E et al (2014) 
Taxonomic reorganization of family Partitivir-
idae and other recent progress in partitivirus 
research. Virus Res 188:128–141 
10. Szego A, Enu¨nlu¨ N, Deshmukh SD et al 
(2010) The genome of beet cryptic virus 
1 shows high homology to certain crypto-
viruses 
present 
in 
phylogenetically 
distant 
hosts. Virus Genes 40:267–276 
11. Shimura H., Masuta C., Koda Y (2018) Meta-
genomic analyses of the viruses detected in 
mycorrhizal fungi and their host orchid. In: 
Pantaleo V., Chiumenti M. (eds) Viral Metage-
nomics. Methods molecular biology vol. 1746. 
Humana Press, New York, pp. 161-172 
12. Tsutsui K, Tomita M (1990) Suitability of sev-
eral carbohydrates as the carbon sources for 
symbiotic seedling growth of two orchid spe-
cies. Lindleyana 5:134–139 
13. Shimura H, Koda Y (2005) Enhanced symbi-
otic 
seed 
germination 
of 
Cypripedium 
macranthos
var.
rebunense
following 
inoculation after cold treatment. Physiol Plant 
123:281–287 
14. Shimura H, Sadamoto M, Matsuura M et al 
(2009) Characterization of mycorrhizal fungi 
isolated from the threatened Cypripedium 
macranthos in a northern Island of Japan: two 
phylogenetically distinct fungi associated with 
the orchid. Mycorrhiza 19:525–534 
15. Bolger AM, Lohse M, Usadel B (2014) Trim-
momatic: 
a 
ﬂexible 
trimmer 
for 
Illumina 
sequence data. Bioinformatics 30:2114–2120 
16. Martin M (2011) Cutadapt removes adapter 
sequences from high- throughput sequencing 
reads. EMBnet J 17:10. https://cutadapt. 
readthedocs.io/en/stable/ 
17. Song L, Florea L (2015) Rcorrector: efﬁcient 
and accurate error correction for Illumina 
RNA-seq reads. GigaScience 4:48z 
18. Grabherr MG, Haas BJ, Yassour M et al (2011) 
Full-length 
transcriptome 
assembly 
from 
RNA-seq data without a reference genome. 
Nat Biotechnol 29:644–652 
19. Peng Y, Leung HC, Yiu SM et al (2013) 
IDBA-Tran: a more robust de novo de Bruijn 
graph 
assembler 
for 
transcriptomes 
with 
uneven expression levels. Bioinformatics 29: 
i326–i334 
20. Li W, Godzik A (2006) Cd-hit: a fast program 
for clustering and comparing large sets of pro-
tein or nucleotide sequences. Bioinformatics 
22:1658–1659 
21. Gilbert DG (2013) Gene-omes built from 
mRNA-seq not genome DNA. In: 7th Annual 
arthropod genomics symposium, p 47405 
22. Langmead B, Salzberg S (2012) Fast gapped-
read alignment with bowtie 2. Nat Methods 9: 
357–359 
23. O’Leary NA, Wright MW, Brister JR et al 
(2016) Reference sequence (RefSeq) database 
at NCBI: current status, taxonomic expansion, 
and functional annotation. Nucleic Acids Res 
44:D733–D745 
24. Shimura H, Koda Y (2004) Micropropagation 
of Cypripedium macranthos var. rebunense 
through protocorm-like bodies derived from 
mature seeds. Plant Cell Tissue Organ Cult 
78:273–276 
25. Chen S, Zhou Y, Chen Y et al (2018) Fastp: an 
ultra-fast all-in-one FASTQ preprocessor. Bio-
informatics 34:i884–i890 
26. Patro R, Duggal G, Love MI et al (2017) 
Salmon provides fast and bias-aware quantiﬁca-
tion of transcript expression. Nat Methods 14: 
417–419

Chapter 6 
Determination of the Mycovirome of a Necrotrophic Fungus 
Ana Ruiz-Padilla, Julio L. Rodrı´guez-Romero, Davide Paciﬁco, 
Marco Chiapello, and Marı´a A. Ayllo´n 
Abstract 
Next-generation sequencing (NGS) of total RNA has allowed the detection of novel viruses infecting 
different hosts, such as fungi, increasing our knowledge on virus horizontal transfer events among different 
hosts, virus diversity, and virus evolution. Here, we describe the detailed protocols for the isolation of the 
plant pathogenic fungus Botrytis cinerea, from grapevine plants showing symptoms of the mold gray 
disease, the culture and maintenance of the isolated B. cinerea strains, the extraction of total RNA from 
B. cinerea strains for NGS, the bioinformatics pipeline designed and followed to detect mycoviruses in the 
sequenced samples, and the validation of the in silico detected mycoviruses by different approaches. 
Key words Next-generation sequencing (NGS), Virome, Viral metagenomics, Bioinformatic pipe-
line, Necrotrophic fungi, Botrytis cinerea 
1 
Introduction 
Mycoviruses are viruses that infect fungi. The ﬁrst described 
mycovirus causes a disease in edible mushrooms (Agaricus bisporus) 
called La France disease [1]. Occasionally, beside causing disease in 
the fungus [1, 2], mycoviral infection can decrease the virulence of 
the fungus in its plant hosts; therefore, these mycoviruses can be 
used as biological control agents in management strategies for plant 
diseases caused by fungi [3–5]. In other few cases, mycoviral infec-
tion can increase the virulence of the host [6–8]. It has also been 
described as a triple beneﬁcial interaction among a mycovirus, a 
fungus, and a plant host [9]. Most promising is the change in the 
lifestyle of Sclerotinia sclerotiorum due to a mycoviral infection, 
turning from a pathogen to a beneﬁcial endophyte for Brassica 
protection and production enhancement [10]. And last, mycoviral 
infection may have no impact on its fungal host [11], and in these 
cases, these mycoviruses can be used as viral expression vectors or as 
viral induced gene silencing vectors [12]. The use of viruses for
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_6, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
83

control of different plant pests or pathogens has been extensively 
reviewed by Wagemans and coworkers [13]. To understand the 
relation between a certain mycovirus and its host, ﬁrst we need to 
get knowledge on the mycovirome of the fungal host. Next-
generation sequencing (NGS) of the total RNA has allowed to 
get this knowledge, it is a practical method for novel virus discovery 
from samples of different origins, and hosts, but, additionally per-
mit to increase our understanding on viral horizontal transfer 
among different hosts, cross-kingdom events, virus diversity, and 
virus evolution. NGS has been used to discover new mycoviruses 
that infect fungi and oomycetes [14–24]. Most mycoviruses possess 
a genome of positive single-stranded RNA ((+)ssRNA) or double-
stranded RNA (dsRNA), and there is also a great variety and 
abundance of negative single-stranded RNA ((-)ssRNA) mycov-
iruses, and only few single-stranded DNA viruses [19, 25–28].
84
Ana Ruiz-Padilla et al.
Botrytis cinerea is a necrotrophic ascomycete and one of the 
most important plant pathogenic fungi infecting more than 
200 crops, which causes enormous economic losses during the 
year worldwide [29]. Gray mold is one of the most important 
diseases in grapevine, and it is present in all global viticulture 
regions. One of the main strategies for disease control is the use 
of fungicides, which frequently increase the number of B. cinerea 
resistant strains [30, 31], besides being harmful to the environ-
ment. Indeed, fungicidal applications also have adverse effects on 
human health and a negative impact on the environment. Due to 
these concerns, it is imperative to develop novel strategies to man-
age this pathogen in an environment-friendly manner. The use of 
alternative control measures, such as biological strategies, would 
decrease the recurrent use of chemical compounds and be more 
friendly with the environment. In this chapter, we detailed the 
procedure to obtain the mycovirome of the fungus, from the ﬁeld 
sampling to the detection of the mycoviruses by NGS in total RNA 
from B. cinerea pools of ﬁeld strains, as was described in the work of 
Ruiz-Padilla and coworkers [19]. 
2 
Materials 
Prepare all solutions using nuclease-free water and analytical grade 
reagents. Prepare and store all reagents at room temperature 
(unless otherwise indicated). 
2.1 
Isolation, 
Cultivation, and 
Maintenance of 
Botrytis cinerea 
Strains 
1. Potato Dextrose Broth (PBD) from Commercial Powder (e.g., 
Condalab). Add 26.5 g of commercial PDB powder to 1000 
mL of distilled water. Autoclave 15 min at 121 °C. Add the 
required volume into sterile 90 mm diameter plates or sterile 
ﬂasks (see Note 1).

Mycovirome of Necrotrophic Fungi
85
2. Potato Dextrose Agar (PDA) from commercial powder (e.g., 
Condalab). Add 39 g of commercial PDA powder to 1000 mL 
of distilled water. Alternatively, add 15 g of bacteriological agar, 
20 g of dextrose, and 4 g of potato starch to 1000 mL distilled 
water. Alternatively, PDB can be mixed with 2% bacteriological 
agar. Heat to dissolve the medium completely. Autoclave 
15 min at 121 °C. Distribute 20–25 mL into sterile 
15 × 100 mm Petri dishes or 20 mL into sterile 90 mm diame-
ter plates (see Note 2). 
3. PDA from potato infusion. Boil 200 g of sliced potatoes in 1 L 
of distilled water for 30 min. Separate the infusion by ﬁltering 
the entire content with a sterile gauze. Add 1 L of water, 20 g of 
dextrose, and 20 g of agar and then boil to dissolve. Autoclave 
15 min at 121 °C. Adjust to ﬁnal pH 5.6 ± 0.2. Distribute 
20–25 mL into 15 × 100 mm sterile Petri dishes. 
4. PDB from potato infusion. Add 20 g of dextrose and 6.5 g of 
potato infusion to 1000 mL of distilled water. Autoclave 
15 min at 121 °C. Add the required volume into sterile 
90 mm diameter plates or sterile ﬂasks. 
5. Preparation of Botrytis cinerea Selective Medium (BSM). Add 
2 g of glucose, 0.1 g of NaNO3, 0.1 g of K2HPO2, 0.2 g of 
MgSO4.7H2O, 0.1 g of KCl, 0.2 g of chloramphenicol, 0.02 g 
of pentachloronitrobenzene, 0.02 g of Maneb 80*, 0.05 g of 
Rose bengal, 5 g of tannic acid, 20 g of Agar, and add distilled 
water to 1000 mL. Adjust the pH to 4.5 with 1 mol L-1 
NaOH before adding the agar. Heat to dissolve the medium 
completely. Autoclave for 15 min at 121 °C or bring to a boil 
with constant stirring. Due to its high selectivity, the BSM 
medium does not necessarily require autoclaving. Distribute 
20–25 mL into 15 × 100 mm sterile Petri dishes. 
2.2 
Collection and 
Drying of Botrytis 
cinerea Cultures 
1. Miracloth paper or cheesecloth paper (see Note 3). 
2. Filter paper (see Note 4). 
3. Spatula. 
4. Liquid nitrogen. 
2.3 
Total RNA 
Extraction 
1. External thread tubes or safe-lock tubes. 
2. Glass beads (0.1 mm). 
3. Beat beater (Qiagen TissueLyser) or vortex. 
4. Spectrum Plant Total RNA kit (Sigma-Aldrich) (see Note 5). 
2.4 
Determination of 
RNA Quality 
1. Nanodrop or UV spectrophotometer (see Note 6). 
2. Agarose Low EEO. 
3. Electrophoresis apparatus.

86
Ana Ruiz-Padilla et al.
4. 6X Gel Loading Purple Dye. 
5. DEPC water. Dissolve 1 mL of Diethyl pyrocarbonate (DEPC) 
in 1 L of ultrapure water. Agitate at room temperature on a 
chemical extraction hood O/N (see Note 7). 
6. 0.5 M EDTA pH 8. Dissolve EDTA in water and adjust pH to 
8 using NaOH pellets. 
7. 50× TAE pH 8.2–8.4. Dissolve 24.2 g of Tris base in 700 mL 
of DEPC water. Add 10 mL of 0.5 M EDTA and 5.71 mL of 
100% glacial acetic acid. Adjust pH to 8.2–8.4. Adjust the 
volume to 1 L with DEPC water and autoclave for 20 min at 
121–124 °C. Store at room temperature. 
2.5 
Detection by 
Quantitative RT-PCR 
1. High-capacity cDNA reverse transcription kit (Applied Biosys-
tems) (see Note 8). 
2. Speciﬁc primers for viral genomes. 
3. Universal SYBR green Master Mix. 
4. LightCycler® 480 Multiwell Plate 384. 
5. LightCycler® 480. 
2.6 
Detection of RNA 
Mycoviruses by 
Conventional RT-PCR 
1. Reverse Transcriptase (we suggest SuperScript IV Reverse 
Transcriptase, Thermo Fisher Scientiﬁc). 
2. Taq Polymerase (we suggest Taq CloneAmp HiFi PCR, 
TaKaRa). 
3. Thermal cycler. 
2.7 
Detection of 
Single-Stranded DNA 
Mycovirus by 
Conventional PCR 
1. DNeasy plant minikit (Qiagen). 
2. Templiphi ampliﬁcation kit (Illustra). 
3. Thermal cycler. 
2.8 
Speciﬁc 
Detection of Botrytis 
cinerea 
1. Thermal block. 
2. Heavy iron sheet or similar. 
3. Speciﬁc primers for the detection of Botrytis cinerea [32]. 
Bc3F (5′– GCTGTAATTTCAATGTGCAGAATCC – 3′) 
Bc3R (5′ – GGAGCAACAATTAATCGCATTTC – 3′). 
2.9 
Software 
Requirements for 
Bioinformatic Analysis 
1. R software https://www.r-project.org/. RStudio Desktop 
https://posit.co/ (optional) and R libraries: tidyverse; DT; fs; 
Biostrings; ggthemes; cowplot; network; tidygraph; ggraph. 
2. Trinity (Version: 2.8.4) [33]. 
3. BBTOOLS (Version: 38.22–0) [34]. 
4. DIAMOND (Version: 0.9.22) [35]. 
5. Samtools (Version: 1.9) [36].

Mycovirome of Necrotrophic Fungi
87
6. Bwa (Version: 0.7.17) [37]. 
7. CAP3 (Version: https://github.com/brewsci/homebrew-
bio/blob/master/Formula/cap3.rb [38]. 
8. Basic Local Alignment Search Tool (Blast) [39]. 
3 
Methods 
3.1 
Isolation of 
Botrytis cinerea 
Strains 
B. cinerea can be present as a latent infection for a long time in the 
ﬁeld: Depending on environmental conditions, both conidia and 
sclerotia can remain viable from days to months. B. cinerea infec-
tions are usually more frequent on ripe grapevine fruits; neverthe-
less, the fungus can be isolated from different organs (leaves, 
shoots, branches, ﬂowers, and fruits) showing the following 
symptoms: 
1. Leaves and shoots: Symptoms on grape leaves and shoots are 
less frequent, occurring especially in spring, in very rainy peri-
ods. Leaf infections are associated with green spots that are 
located mainly at the edges, turning reddish-brown and 
necrotic. Infections of shoots appear as soft rot, which tend 
to become covered with gray mold and to dry up. 
2. Branches: Browning and widespread necrosis can appear fol-
lowing the infection on the herbaceous branches. On the 
affected part, the fungus sclerotia are visible to the naked eye 
as a blackish dot. 
3. Flowers: B. cinerea infections are frequently latent on grapevine 
ﬂowers; nevertheless, the typical gray mold appears in case of 
favorable environmental conditions. 
4. Berries: Grape fruits are affected mostly after the veraison and 
during the ripening phase. Once infected, the berries begin to 
turn dark, with different shades depending on the phenological 
stage and grape variety. Later, they became soft and covered 
with gray mold. If the environmental conditions turn toward a 
“dry” condition, the affected bunches tend to dry out, forming 
extended necrosis. 
3.1.1 
Sampling 
Procedure 
1. Single leaves, berries as well as fragments of infected tissues can 
be gently detached from the plant using a sterile blade and then 
placed in a Petri dish or in a sterile 50 mL Falcon (see Notes 9 
and 10). 
2. Store the collected plant material immediately at 4 °C in moist 
conditions to allow the mycelium development. 
3. The mycelium of each fungal sample should be isolated from 
the stored material with a sterile tip and then plated on a PDA, 
or alternative medium, plate (see Notes 11–13).

88
Ana Ruiz-Padilla et al.
4. Incubate the plates at 23 °C in darkness, until the complete 
development of the mycelium. 
5. Check the plates at regular intervals to exclude bacterial or 
fungal contaminations (see Notes 14 and 15). 
6. In case of contamination, re-isolate B. cinerea isolates on new 
PDA plates by excising mycelium fragments external to con-
tamination (see Note 16). 
7. Store isolates on plates at 4 °C or/and in 20% glycerol, at
-80 °C, for longer periods of time. 
3.2 
Total RNA 
Extraction of Botrytis 
cinerea Isolates 
1. Scratch a 7-day fungal isolate cultured in PDA plates with a 
yellow sterile tip in various parts of the plate and suspend it in 
PDB ensuring mycelia and/or spores are being inoculated (see 
Note 17). 
3.2.1 
Mycelia 
Preparation 
2. Collect a 3-day liquid culture with a spatula, place it on Mira-
cloth, and dry with ﬁlter paper. Freeze mycelia immediately in 
liquid nitrogen and maintain at -80 °C until total RNA extrac-
tion (see Note 18). 
3.2.2 
Total RNA 
Extraction 
1. Collect approximately 100 mg of frozen mycelia and introduce 
them in a thread tube containing 2–3 glass beads. Add 500 μL 
of lysis solution to each tube and mix the samples in a beat 
beater (Qiagen TissueLyser II) at maximum speed for 20–30 s 
(see Note 19). 
2. Incubate for 3–5 min at 56 ° C and centrifuge 13,000 rpm for 
3 min. Pipette the supernatant in the ﬁltration column (blue) 
seated in a 2 mL collection tube. 
3. Follow the instructions of the Spectrum Plant Total RNA kit 
and elute total RNA in a total volume of 30 μL of elution buffer 
(see Note 20). Store RNA at -80 °C and avoid multiple cycles 
of freezing and thawing to ensure its quality (see Note 21). 
3.3 
RNA Quality Test
1. Measure RNA concentration using a UV spectrophotometer or 
Nanodrop (see Note 22). 
2. Prepare a 1% agarose gel with TAE 1X (diluted with DEPC 
water) with ethidium bromide or SYBR Safe. Fill the electro-
phoresis cuvettes with TAE 1X (diluted with ultrapure water). 
3. Prepare 200 ng of RNA to a ﬁnal concentration of gel loading 
dye and load them on the gel. Electrophorese for 45 min at 
90 V. 
The complete procedure is schematized in Fig. 1. 
3.4 
NGS Sequencing
To search for mycoviruses, with genomes of dsRNA, (+)ssRNA, 
(-)ssRNA, or DNA, it is convenient to sequence RNA libraries 
from which the ribosomal RNA (rRNA) has been removed.

Ribosomal depletion is critical since it allows an efﬁcient detection 
of
functionally
relevant
polyadenylated
as
well
as 
non-polyadenylated mycoviruses through the removal of highly 
abundant rRNA species. Not all viral RNAs can be puriﬁed by the 
polyA enrichment selection method. 
Mycovirome of Necrotrophic Fungi
89
Potato Dextrose 
Agar 
(PDA) 
Potato Dextrose 
Broth 
(PDB) 
3 d 
Dry 
Freezing in N2 
RNA total extraction 
Quality measurements 
Nanodrop 
Ratio260/280 
Electrophoresis 
in RNAse-free 
agarose gel 
Fig. 1 Representative scheme of the isolation of B. cinerea ﬁeld strains, culture in different media to remove 
microorganism contaminants, total RNA extraction, and quality measure 
To construct the library, total RNA is extracted from a sample. 
After performing quality control (QC), the qualiﬁed samples will 
proceed to library construction (see Notes 23 and 24). 
3.5 
Bioinformatics 
Pipeline 
The bioinformatics pipeline to assemble and identify viruses in 
silico developed by Chiapello and coworkers [21] was divided 
into six steps (Fig. 2): (1) Preprocessing reads, (2) prepare a custom 
viral database, (3) de novo assembly using the cleaned reads, 
(4) identiﬁcation of viral sequences by a high-performance 
sequence aligner, (5) mapping reads, (6) selection of “Univirus,” 
and (7) ﬁnal molecular characterization. 
3.5.1 
Clean Reads and 
Prepare a Custom Viral 
Database 
After NGS sequencing, a Fastq ﬁle containing paired-end reads will 
be generated per sample. Clean reads will be performed using 
BBTools [34], by sequentially removing adapters, artifacts, short 
reads, and residual ribosomal sequences. Be sure that the read ﬁle 
name has this format ‘sampleID_1.fastq.gz’ and ‘sampleID_2. 
fastq.gz’ for paired ends (these are input ﬁles). 
The cleaning process can be automated by running a single 
script. 
$ bash clean_sample.sh sampleID 
sendsketch.sh --> clumpify.sh --> bbduk.sh (adapter 
removal-->artefacts
removal-->short
removal--> 
ribosomal removal)

bbmerge.sh --> reformat.sh (Output file: 
sampleID 
_map.fastq.gz) 
90
Ana Ruiz-Padilla et al.
Fig. 2 Bioinformatic pipeline designed and used to analyze NGS data and the 
programs required in each step 
All results will be loaded into the sampleID folder (see 
Note 25). 
3.5.2 
Prepare a Custom 
Viral Database 
A custom or complete viral database will be queried to ﬁnd viral 
sequences. To get a custom viral database in the FASTA ﬁle: 
1. Go to the Web https://www.ncbi.nlm.nih.gov/genome/ 
viruses 
2. Select ‘Accession list of all viral genomes’ and a taxid10239.txt 
ﬁle will be automatically downloaded. 
3. Go to the webpage “Batch Entrez NCBI”: https://www.ncbi. 
nlm.nih.gov/sites/batchentrez 
4. “Select ﬁle” and select the ﬁle created by “download the list of 
accessions,” and select “Retrieve.” 
5. In the new webpage select “Sent to”: Complete the record and 
in “File” select “FASTA” and “Create ﬁle.” 
Alternatively, download full viral database by accessing to Index 
of /refseq/release/viral (nih.gov) or by using Ubuntu command 
line wget https://ftp.ncbi.nlm.nih.gov/refseq/release/viral/ 
viral.1.protein.faa.gz. This new FASTA ﬁle can be used for blast 
(output ﬁle: ViralDB.fasta). To use this fasta ﬁle in DIAMOND 
software, a database must be constructed by run makedb from 
Diamond software. 
$diamond makedb --in ViralDB.fasta -d ./viraldb. A database 
named ViralDB will be generated (see Note 26).

Mycovirome of Necrotrophic Fungi
91
3.5.3 
RNA De Novo 
Assembly 
The output of the cleaning step will be used as input for the de novo 
assembly (Output ﬁle step1: sampleID _map.fastq.gz). For this 
step, Trinity software [33] will be used. This software requires 
high processing power (CPU). We recommend using a powerful 
cluster or using the Galaxy server (https://usegalaxy.org/) for this 
achievement. 
– Galaxy --> ﬁles ’sampleID_1_clean.fastq.gz’ and ’sampleID_2_-
clean.fastq.gz’ are loaded into Galaxy.eu. Then run Trinity with 
standard parameters. It takes a few hours to ﬁnish. 
When the process is over, you have to download the fasta 
ﬁle. It must be stored in the /results/sampleID folder. Rename 
ﬁle as ’Trinity_sampleID.fasta’ 
– Cluster or PC --> After adapting your CPU or Max_memory 
requirements 
to 
your 
machine, 
run 
Trinity 
with 
these 
parameters: 
#RNA Assembly by Trinity 
$Trinity
--max_memory 
120G
--seqType 
fq
--left 
/  
s  a m  p l e  I D  _ 1 _  c l  e a n  . f  a s t  q .  g z
- - r  i g h  t  
./ 
sampleID_1_2_clean.fastq.gz
--CPU 
24
--output 
./Trinity_sampleID.fasta
--no_normalize_reads
--
no_version_check --jaccard_clip --full_cleanup 
Output ﬁle from Step 2: Trinity_sampleID.fasta 
This Fasta ﬁle contains a complete “de novo’‘RNA scaffolds 
generated by read assembly; however, a longer and probably more 
precise assembly can be performed by Cap3 Contig software 
[38]. This tool merges two overlapping scaffold sequences from 
Trinity_sampleID.fasta, and a collection of new Contigs will be 
created. 
3.5.4 
Viral Sequences 
Identiﬁcation 
In this crucial step, an identiﬁcation of viral sequences will be 
achieved by comparing the custom viral database (Subheading 
3.5.2) against all scaffolds and contigs generated by de novo assem-
bly (Subheading 3.5.3). For this proposal, DIAMOND software 
will be used. A ViralDB (Subheading 3.5.2) will be compared with 
our de novo assembled transcriptome (ﬁle: Trinity_sampleID.fasta) 
(see Note 25). 
Run Diamond blastx with these parameters: 
#Diamond blast viraldb 
$diamond blastx -p24 -d ./viraldb -q ./Trinity_sam-
pleID.fasta
-o 
./sampleID-ViralDB.blast
-f 
0
-k 
2 -e 0.00001 --unal 0 --more-sensitive 
The ﬁle sampleID-ViralDB.blast can be opened in a text pro-
cessor. The results were manually inspected, and reliable viral

sequences, based on identity percentage, alignment length, and 
query length, were selected for the following analysis steps. 
92
Ana Ruiz-Padilla et al.
Then we manually selected all scaffolds that fulﬁll our require-
ments. This list is stored in a text ﬁle (/results/sampleID/sam-
pleID-list.txt). 
To extract sequence, you can run ﬁrst grep to extract Query 
names and cat to unify IDs to a list. 
#Extract Contigs IDs list 
$grep -e "Query=" $results/$1-ViralaliNEWafterCAP. 
blast > 
./results/sampleID/sampleID-list.txt 
$cat ./results/sampleID/sampleID-list.txt | sort | 
uniq > 
./results/sampleID/sampleID-listuniq.txt 
$cut -d " " -f 2 ./results/sampleID/sampleID-listu-
niq.txt > 
./results/sampleID/sampleID-list.txt 
Using this list, scaffold sequences have to be extracted from the 
original ﬁle Trinity_sampleID.fasta. Commands awk and grep can 
be used to extract fasta from the original Trinity fasta ﬁle. 
#Extract fasta from Trinity_sampleID.fasta 
$awk ’{if($0 ~ /^>/){print $0} else {printf $0}}’ 
Trinity_sampleID.fasta 
| 
perl
-
pe 
"s/>/\n>/g" 
> 
Trinity_sampleIDoneline.fasta 
$grep -A1 --no-group-separator -f 
./results/sampleID/sampleID-list.txt 
Trinity_sampleIDoneline.fasta > sampleID-
significant1.fasta 
Output ﬁle sampleID-signiﬁcant1.fasta 
A second blast results will be used to discriminate between real 
and integrated viruses or host sequences. Download full NCBI nr 
database directly in https://ftp.ncbi.nlm.nih.gov/blast/db/ 
FASTA/nr.gz or using “wget https://ftp.ncbi.nlm.nih.gov/ 
blast/db/FASTA/nr.gz -c” in the Unix command line. 
# Download NCBI nr database and make a diamond data 
base 
$wget 
https://ftp.ncbi.nlm.nih.gov/blast/db/FAS-
TA/nr.gz -c 
$diamond makedb --in ./nr.gz -d ./nr 
This blast will continue by comparing the sampleID-signiﬁ-
cant1.fasta versus NCBInr database. This sh script can be used:

# Diamond blast using NCBI nr database 
$diamond 
blastx
-d 
./nr
-q 
sampleID-significant1. 
fasta
-o 
sampleID-NCBInrblast.blast
-f 
0
-k 
2
-e 
0.00001 --unal 0 --more-sensitive 
$diamond 
blastx
--d 
nr
-q 
sampleID-significant1. 
fasta
-o 
sampleID-NCBInrtable.blast
-f 
6 
qseqid 
sseqid pident length qlen mismatch 
gapopen qstart 
qend sstart send evalue bitscore -k 2 -e 0.00001 --
unal 0 --more-sensitive 
#Table of results 
filename="sampleID-NCBInrblast.blast" 
$cut -d "[" -f 2 $filename | sed ’s/]/ /g’ > list1. 
txt 
$cut -d "[" -f 1 $filename | sed ’s/>//g’ > list2. 
txt 
$paste 
sampleID-NCBInrtable.blast 
list2.txt 
| 
paste - list1.txt > NCBItable2.blast 
$echo 
"qseqid 
sseqid 
pident 
length 
qlen 
mismatch 
gapopen 
qstart 
qend 
sstart 
send 
evalue 
bitscore 
protein organism" 
> header 
$cat <(head -1 header) NCBItable2.blast > sampleID-
NCBInr.blast 
Output ﬁle sampleID-NCBInr.blast 
Mycovirome of Necrotrophic Fungi
93
Manually selection of all scaffolds that match our requirements 
is required. This list must be stored in a text ﬁle (/results/sam-
pleID/sampleID-list2.txt). To extract sequence, you can run ﬁrst 
grep to extract Query names and cat to unify IDs to a list as above. 
With this list, a Fasta ﬁle with signiﬁcant scaffolds sequences 
will be extracted from the ﬁle sampleID-signiﬁcant1.fasta. Com-
mands awk and grep can be used to extract fasta from the original 
Trinity fasta ﬁle as above. 
Output ﬁle sampleID-signiﬁcant2.fasta 
3.5.5 
Mapping
Selected virus sequences will be mapped with clean reads using bwa, 
transformed with SAMtools, and then visualized with Tablet soft-
ware. This sh script can be used: 
# Mapping with bwa 
$bwa index sampleID-significant2.fasta 
$bwa mem -t 40 sampleID-significant2.fasta sampleID 
_map.fastq.gz > 
sampleID-significant2.sam 
$samtools 
view
-bS 
sampleID-significant2.sam
-o 
sampleID-significant2.bam

$samtools 
sort
-@ 
40 
sampleID-significant2.bam
-o 
sampleID-significant2.sort.bam 
$samtools index sampleID-significant2.sort.bam 
$samtools 
idxstats 
sampleID-significant2.sort.bam 
> sampleID_idxstats.txt 
94
Ana Ruiz-Padilla et al.
The ﬁle sampleID_idxstats.txt will give a list of contigs and 
scaffolds with the number of reads that are mapped in each sample. 
3.5.6 
Univirus
The goal of this step is to identify viruses in all samples or pools. 
A list of viruses that are common in all datasets will be created 
using an R software (see Note 27). 
1. Read data in .csv ﬁles. The following columns will be created: 
Contig name, viral name, length, and number of reads mapped. 
2. Combine virus names to set pool/sample name to the names. 
All samples/pools will be combined in a single ﬁle. 
3. Read Fasta sequences by Biostrings. A Fasta ﬁle with all scaf-
folds and contigs will be used to blast it with itself. Output ﬁle 
allVOI.fasta. 
4. Create a database to be used for blastn analysis. 
$makeblastdb -in allVOI.fasta -dbtype nucl 
5. Use blastn tool to compare allVOI.fasta sequences in allVOI. 
fasta database 
$blastn
-query 
allVOI.fasta
-db 
allVOI.fasta
-outfmt 6 -out allVOI_nucl.tab 
6. The selection of unique viruses will be done by R using the 
identity threshold. Compare the length of the contig and the 
length of the alignment should be achieved by in-house R 
scripting. The alignment length should cover at least 90% of 
the contig length and 90% of the identity. 
7. Remove all duplicate viruses. 
8. Finally, a list/table and Fasta ﬁle of unique viruses will be 
generated. 
3.5.7 
Molecular 
Analyses—ORF Predictions 
and Final BLASTP Again 
NCBI Database 
In this last step, a molecular analysis with all viruses detected in our 
samples will be performed. For ORF prediction of the selected viral 
sequences, Expasy Translator and Open Reading Frame Finder 
NCBI will be used with default parameters. BLASTP was used to 
conﬁrm the identity of the translated proteins by again searching 
the NCBI database (see Note 28). 
All viral sequences with a length of >1000 nt, close to the size 
of the viral reference genome, and with a complete coding 
sequence, mainly proteins required for viral replications, would be 
used in phylogenetic analyses 
and for 
further 
mycovirome

characterization. All these data should be uploaded to a database 
such as Genbank-NCBI. 
Mycovirome of Necrotrophic Fungi
95
3.6 
Viral Detection 
by Quantitative PCR 
To validate the presence of the mycoviruses found by NGS in silico, 
those mycoviruses should be also detected by other methods such 
as retrotranscription (RT) followed by ampliﬁcation by PCR for 
RNA viruses, or only by PCR detection in case of DNA viruses. 
3.6.1 
Complementary 
DNA (cDNA) Synthesis with 
Random Primers 
1. Use approximately 500 ng of total RNA to synthesize cDNA 
with random primers by high-capacity cDNA reverse transcrip-
tion kit in a total reaction volume of 20 μL (see Note 29). 
Prepare 2 solutions. Solution 1: Mix 2 μL of 10X RT Buffer, 
0.8 μL of 25X dNTP mix (100 mm), 1 μL of RT Random 
Primers, 1 μL of MultiScribe Reverse Transcriptase, 4.2 μL of  
nuclease-free H2O. Solution 2: Dissolve 500 ng of total RNA 
in a total volume of 10 μL of nuclease-free water (see Note 30). 
Mix solutions 1 and 2 and incubate samples in a thermal cycler 
at 25 °C for 10 min, 37 °C for 120 min, 85 °C for 5 min. Store 
samples at 4 °C for short-periods and -20 °C for extended 
periods (see Note 31). 
3.6.2 
Primer Design
1. Introduce CDS regions of full-genome sequences in Primer3 
software [40] to optimize primer design according to next 
parameters: Optimal Primer Tm (60 ºC), Primer GC % 
(50%), Primer Size (20), and Product Size Ranges (70–90) 
(see Note 32). 
3.6.3 
Quantitative PCR 
Detection of Individual 
Mycoviruses 
1. Use a 1/3 dilution of the synthetized cDNA as template in a 
qPCR using FastStart Universal SYBR green Master Rox 
(Roche) with speciﬁc primers designed for the detection of 
each viral segment. 
2. Prepare 10 μL total volume reactions with a ﬁnal concentration 
of 1X Master Mix, 20 μM of speciﬁc primers Forward and 
Reverse, and nuclease-free water. 
3. Load samples in a LightCycler® 480 Multiwell Plate 384 and 
seal the plate with self-adhesive foil (see Notes 33 and 34). 
4. Centrifuge the plate at 5000 rcf and place it in the LightCycler® 
480. Use the following conditions. Preincubation: 1 cycle at 
95 °C for 5 min. Ampliﬁcation: 45 cycles (95 °C for 10 s, 53 °C 
for 20 s, and 72 °C for 30 s in single acquisition mode). 
Melting curve: 1 cycle (95 °C for 5 s, 65 °C for 1 min and 
97 °C in continuous acquisition mode. Cooling: 1 cycle at 40 ° 
C for 10 s (see Note 35).

96
Ana Ruiz-Padilla et al.
3.7 
Conventional RT-
PCR Detection 
1. Retrotranscribe 200 ng of total RNA using SuperScript IV 
(Thermo Fisher Scientiﬁc), using 0.2 μM of reverse speciﬁc 
primer in a total volume of 10 μL. 
3.7.1 
Retrotranscription 
with SuperScript IV 
2. Continue
retrotranscription
following
manufacturer’s 
instructions. 
3.7.2 
PCR Ampliﬁcation 
of Viral Genomes Using 
CloneAmp Polymerase 
1. Perform a PCR using Taq CloneAmp HiFi PCR (TaKaRa) with 
a ﬁnal concentration of CloneAmp Master Mix 1X, 0.2 μM of  
forward and reverse primers, 1 μL of previously prepared 
cDNA, and nuclease-free water. 
2. Place samples in a thermal cycler and use the following condi-
tions. Preincubation: 1 cycle of 98 °C for 15 s. Ampliﬁcation: 
35 cycles (98 °C for 10 s, 55 °C for 15 s, and 72 °C for 1 min 
per 1 kb). Final elongation: 1 cycle of 72 °C for 7 min. Cooling: 
4 °C. 
3.7.3 
Electrophoresis of 
PCR Products in Agarose 
Gel 
1. Prepare an agarose gel using an appropriate concentration 
according to the amplicon size. 
2. Load 10 μL of the PCR reaction as a ﬁnal concentration of 
loading buffer 1X. 
3.8 
PCR Detection of 
Single-Strand DNA 
Genomes 
1. Homogenate 100 mg of frozen mycelia in 400 μL Buffer AP1 
using 2–3 beads in a bead beater. 
3.8.1 
Homogenization of 
Mycelia 
3.8.2 
Total DNA 
Extraction with DNeasy 
Plant Minikit 
1. Continue the total DNA extraction extract protocol following 
manufacturer’s instructions. 
3.8.3 
Rolling-Circle 
Ampliﬁcation to Enrich 
Circular Viral DNA 
1. Prepare dilutions of 20 ng of total DNA in 0.5 μL of nuclease-
free water (see Note 36). 
2. Prepare reagents for rolling-circle ampliﬁcation assay reactions 
using TempliPhi ampliﬁcation kit following manufacturer’s 
instructions (see Note 37). 
3.8.4 
Detection of DNA 
Viral Genomes by 
Quantitative PCR 
1. Prepare dilutions 1/5 of resulting circular ampliﬁcation 
products. 
2. Use 1 μL of the dilution as template in a qPCR and in a 
conventional PCR with speciﬁc primers as explained before 
(Subheading 3.6.2).

Mycovirome of Necrotrophic Fungi
97
3.9 
Determination of 
Fungal Species 
1. Obtain total fungal DNA by scratching the surfaces of myce-
lium of 2-day plates with a toothpick a 10-μL tip in 20 μL of  
sterile water (see Note 38). 
3.9.1 
Fungal DNA 
Isolation 
2. Boil samples at 100 °C for 60 s (see Note 39). 
3.9.2 
Quantitative PCR 
Using Speciﬁc Primers of B. 
Cinerea 
1. Use 1 μL of total fungal DNA as a template in 10 μL total 
volume reaction of FastStart Universal SYBR green Master Rox 
(Roche) following previous instructions and speciﬁc primers 
Bc3F and Bc3R for B. cinerea [32]. 
Carry out all PCRs, quantitative PCRs, and RT reactions 
on ice. 
4 
Notes 
1. Other PDB brands can be used to culture fungi, but Condalab 
assures a ﬁnal well-homogenized solution. 
2. It is important to pour media at no more than 60 °C. Cool 
media at room temperature or/and use a 50-mL Falcon to 
pour PDA. 
3. Miracloth is easier to cut, manipulate, and mycelia drying is 
more efﬁcient as mycelia get separated from it better than 
cheesecloth does. 
4. It is recommended to sterilize ﬁlter paper at 80 °C for at least 
6 h.  
5. Storage temperatures over 25 °C or lower than 15 °C may 
affect to correct conservation of buffers and extractions quality. 
6. It is important to use calibrated nanodrops to avoid quantiﬁca-
tion errors. 
7. Non-diluted DEPC reactives are toxic. Use gloves and avoid 
touching your skin or inhaling it. 
8. Other complementary DNA synthesis kits based on random 
primers may substitute the indicated one. For mycovirus detec-
tion, the random hexamers included in the kit are very efﬁcient 
for synthesizing different viral RNAs. 
9. For collecting isolates, it is preferable to use symptomatic 
tissues hosting the mycelium in active proliferation visible 
from late spring to autumn, although the typical gray mold 
can be also observed on the residues of vegetation as well as on 
shriveling berries during the winter, particularly in warm 
climates. 
10. When collecting and handling the plant material wear dispos-
able gloves to avoid sample contamination.

98
Ana Ruiz-Padilla et al.
11. B. cinerea isolates can easily be propagated on PDA without 
acid or https://microbiologyinfo.com/antibiotics/addiction. 
12. The use of B. cinerea selective medium (BSM) has the advan-
tage of reducing the contamination risk by other fungal spe-
cies. This aspect could be helpful especially for practical 
purposes when it is necessary to collect a large number of 
isolates from complex matrices. 
13. Although the traditional PDA preparation method based on 
potato infusion can also be suitable for fungal growth, it is 
recommended the use of standard commercially available PDA 
media powders, preparing the mixture as indicated by the 
manufacturer. 
14. Since PDA is not a selective medium, each plate should be 
frequently checked, at least every 48–72 h, to exclude contam-
inations with other fungal or bacterial species possibly derived 
from the original ﬁeld sample. In alternative, a selective 
medium can be used. 
15. Working under the hood ensures a lower risk of contamination 
when transferring B. cinerea isolates. Use sterile glassware and 
single-use disposable devices or sterilized with a Bunsen 
burner. 
16. Several re-isolation steps may be required to eliminate 
contaminations. 
17. In case mycoviruses are not well-dispersed in the plate, scratch 
in as many different parts of the plate and take mycelia, spores, 
and sclerotia, if possible, simultaneously. 
18. Mycelia can be frozen directly at -80 °C without passing by 
liquid nitrogen. Nevertheless, rapid freezing improves mycelia 
conservation. 
19. Improve yield and quality in RNA extractions by grinding 
mycelia in a mortar and a pestle in presence of liquid nitrogen. 
20. Repeat elution buffer by passing eluted RNA through the 
column again, incubate at room temperature for 2–3 min and 
centrifuge again. 
21. To avoid freezing and defreezing cycles, aliquot total RNA in 
smaller volumes. 
22. An A260/A280 ratio of ~2.1 means high pure RNA. In case of 
ratios higher than 1.8, purity can be considered acceptable. In 
case of a ratio of <1.8 indicates potential DNA or protein 
contamination. 
23. 150 nucleotides paired-ends from the Illumina TruSeq 
Stranded Total RNA protocol with Ribo-Zero Gold and simi-
lar protocols will be a good starting point to select a suitable 
sequencing protocol.

Mycovirome of Necrotrophic Fungi
99
24. Not less than 10 Gb will be a good initial sequencing perfor-
mance selection for mycovirus detection; however, the depth 
should be adjusted to your number of samples per pool. 
25. This process can run on a standard PC; however, a powerful 
cluster would be convenient. 
26. This process can run on a standard PC. 
27. This step can be modiﬁed at your convenience. A series of 
tables or lists can be created using R or R studio. 
28. This step can be done on a standard PC, and all these tools 
would be used online. 
29. Use ﬁlter tips and clean pipettes (previously exposed in ultravi-
olet lamps) to avoid contamination or RNA degradation 
(Subheading 3.6.2). 
30. Before dissolving RNA, it is recommended to spin down sam-
ples at 4 °C. 
31. Prepare complementary DNA reactions immediately prior to 
its incubation. 
32. Different conditions may work successfully for quantitative 
PCR, but it is recommended to evaluate primers efﬁciency 
ﬁrst, in a control PCR. 
33. Use ﬁlter tips and clean pipettes (previously exposed in ultravi-
olet lamps) to avoid contamination or RNA degradation. 
34. Prepare all reactions and load samples in the 384-plate in ice to 
avoid reagents degradation. 
35. It is important to turn the Light Cycler 480 on and set the 
quantitative PCR program before beginning preparation of 
reactions. 
36. Concentrations higher than 100 ng may inhibit ampliﬁcation. 
37. Improve yield and quality in DNA and RNA extractions by 
grinding mycelia in a mortar and a pestle in presence of liquid 
nitrogen. 
38. It is important not to take agar in the tip nor spores. Mycelia 
must be young and sterile to ensure efﬁcient determination of 
B. cinerea species. 
39. Due to the elevated temperature, tubes tend to open sharply. 
Use a heavy metal sheet on the tubes while incubating. This 
will ensure that caps keep closed, and samples are not lost or 
provoke contaminations to other samples.

100
Ana Ruiz-Padilla et al.
Acknowledgments 
This study was ﬁnancially supported by VIROPLANT, a project 
that received funding from the European Union’s Horizon 2020 
Research and Innovation Program (grant agreement number 
773567). M. A. Ayllo´n and J.L.R-R research is currently funded 
by the Project I+D+i PID2020-120106RB-I00 supported by 
MCIN/AEI/10.13039/501100011033/ 
References 
1. Hollings M (1962) Viruses associated with a 
die-back 
disease 
of 
cultivated 
mushroom. 
Nature 196:962–965 
2. Rodrı´guez-Garcı´a C, Medina V, Alonso A, Ayl-
lo´n MA (2014) Mycoviruses of Botrytis cinerea 
isolates from different hosts. Ann Appl Biol 
164:46–61 
3. Dawe AL, Nuss DL (2013) Hypovirus molec-
ular biology. From Koch’s postulates to host 
self-recognition 
genes 
that 
restrict 
virus 
transmission. In: Advances in virus research, 
pp 109–147 
4. Rigling D, Prospero S (2018) Cryphonectria 
parasitica, the causal agent of chestnut blight: 
invasion history, population biology and dis-
ease control. Mol Plant Pathol 19:7–20 
5. Garcı´a-Pedrajas
MD,
Can˜izares
MC, 
Sarmiento-Villamil JL et al (2019) Mycov-
iruses in biological control: from basic research 
to ﬁeld implementation. Phytopathology 109: 
1828–1839 
6. Kotta-Loizou I, Coutts RHA (2017) Studies 
on the virome of the entomopathogenic fun-
gus Beauveria bassiana reveal novel dsRNA ele-
ments and mild hypervirulence. PLoS Pathog 
13:e1006183 
7. Kanhayuwa L, Kotta-Loizou I, O¨ zkan S et al 
(2015) A novel mycovirus from aspergillus 
fumigatus contains four unique dsRNAs as its 
genome and is infectious as dsRNA. Proc Natl 
Acad Sci U S A 112:9100–9105 
8. Olive´ M, Campo S (2021) The dsRNA mycov-
irus ChNRV1 causes mild hypervirulence in 
the fungal phytopathogen Colletotrichum hig-
ginsianum. Arch Microbiol 203:241–249 
9. Ma´rquez LM, Redman RS, Rodriguez RJ, 
Roossinck MJ (2007) A virus in a fungus in a 
plant: three-way Symbiosis required for ther-
mal tolerance. Science 315(80-):513–515 
10. Zhang H, Xie J, Fu Y et al (2020) A 2-kb 
mycovirus converts a pathogenic fungus into a 
beneﬁcial endophyte for Brassica protection 
and yield enhancement. Mol Plant 13:1420– 
1433 
11. Khan HA, Sato Y, Kondo H et al (2021) A 
second 
capsidless 
hadakavirus 
strain 
with 
10 positive-sense single-stranded RNA geno-
mic segments from Fusarium nygamai. Arch 
Virol 166:2711–2722 
12. Co´rdoba 
L, 
Ruiz-Padilla 
A, 
Rodrı´guez-
Romero J, Ayllo´n MA (2022) Construction 
and characterization of a Botrytis virus F infec-
tious clone. J Fungi 8:459 
13. Wagemans J, Holtappels D, Vainio E et al 
(2022) Going viral: virus-based biological con-
trol agents for plant protection. Annu Rev Phy-
topathol 60:21–42 
14. Donaire L, Rozas J, Ayllo´n MA (2016) Molec-
ular characterization of Botrytis ourmia-like 
virus, a mycovirus close to the plant pathogenic 
genus Ourmiavirus. Virology 489:158–164 
15. Donaire L, Paga´n I, Ayllo´n MA (2016) Char-
acterization 
of 
Botrytis 
cinerea 
negative-
stranded RNA virus 1, a new mycovirus related 
to plant viruses, and a reconstruction of host 
pattern evolution in negative-sense ssRNA 
viruses. Virology 499:212–218 
16. Forgia M, Chiapello M, Daghino S et al (2022) 
Three 
new 
clades 
of 
putative 
viral 
RNA-dependent RNA polymerases with rare 
or unique catalytic triads discovered in libraries 
of ORFans from powdery mildews and the 
yeast of oenological interest Starmerella bacil-
laris. Virus Evol 8(1):veac038 
17. Donaire L, Ayllo´n MA (2017) Deep sequenc-
ing of mycovirus-derived small RNAs from 
Botrytis species. Mol Plant Pathol 18:1127– 
1137 
18. Illana A, Marconi M, Rodrı´guez-Romero J et al 
(2017) Molecular characterization of a novel 
ssRNA ourmia-like virus from the rice blast 
fungus Magnaporthe oryzae. Arch Virol 162: 
891–895 
19. Ruiz-Padilla A, Rodrı´guez-Romero J, Go´mez-
Cid I et al (2021) Novel mycoviruses discov-
ered in the mycovirome of a necrotrophic fun-
gus. MBio 12:e03705–e03720

Mycovirome of Necrotrophic Fungi
101
20. Crucitti D, Chiapello M, Oliva D et al (2021) 
Identiﬁcation and molecular characterization 
of novel mycoviruses in saccharomyces and 
non-saccharomyces yeasts of oenological inter-
est. Viruses 14:52 
21. Chiapello M, Rodrı´guez-Romero J, Ayllo´n 
MA, Turina M (2020) Analysis of the virome 
associated to grapevine downy mildew lesions 
reveals new mycovirus lineages. Virus Evol 
6(2):veaa058 
22. Sutela S, Forgia M, Vainio EJ et al (2020) The 
virome from a collection of endomycorrhizal 
fungi reveals new viral taxa with unprecedented 
genome organization. Virus Evol 6(2):veaa076 
23. Botella L, Jung T (2021) Multiple viral infec-
tions detected in Phytophthora condilina by 
Total and small RNA sequencing. Viruses 13: 
620 
24. Gala´n-Cubero 
R, Co´rdoba 
L, Rodrı´guez-
Romero J et al (2022) Molecular data of a 
Novel Penoulivirus associated with the plant-
pathogenic fungus Erysiphe necator. Phytopa-
thology 112:1587–1591 
25. Khalifa 
ME, 
MacDiarmid 
RM 
(2021) 
A 
mechanically transmitted DNA mycovirus is 
targeted by the defence machinery of its host, 
Botrytis cinerea. Viruses 13:1315 
26. Hao F, Wu M, Li G (2021) Characterization of 
a novel genomovirus in the phytopathogenic 
fungus Botrytis cinerea. Virology 553:111– 
116 
27. Yu X, Li B, Fu Y et al (2010) A geminivirus-
related DNA mycovirus that confers hypoviru-
lence to a plant pathogenic fungus. Proc Natl 
Acad Sci 107:8387–8392 
28. Li P, Wang S, Zhang L et al (2020) A tripartite 
ssDNA mycovirus from a plant pathogenic fun-
gus is infectious as cloned DNA and puriﬁed 
virions. Sci Adv 6:eaay9634 
29. Dean R, Jal VK, Pretor ZA et al (2012) The top 
10 fungal pathogens in molecular plant pathol-
ogy. Mol Plant Pathol 13:414–430 
30. Ferna´ndez-Ortun˜o D, Grabke A, Li X, Schna-
bel G (2015) Independent emergence of resis-
tance to seven chemical classes of fungicides in 
Botrytis cinerea. Phytopathology 105:424– 
432 
31. Ferna´ndez-Ortun˜o D, Pe´rez-Garcı´a A, Cha-
morro M et al (2017) Resistance to the SDHI 
fungicides boscalid, ﬂuopyram, ﬂuxapyroxad, 
and penthiopyrad in Botrytis cinerea from 
commercial strawberry ﬁelds in Spain. Plant 
Dis 101:1306–1313 
32. Diguta CF, Rousseaux S, Weidmann S et al 
(2010) Development of a qPCR assay for spe-
ciﬁc quantiﬁcation of Botrytis cinerea on 
grapes. FEMS Microbiol Lett 313:81–87 
33. Haas BJ, Papanicolaou A, Yassour M et al 
(2013) De novo transcript sequence recon-
struction from RNA-seq using the trinity plat-
form for reference generation and analysis. Nat 
Protoc 8:1494–1512 
34. Bushnell 
B, 
Rood 
J, 
Singer 
E 
(2017) 
BBMerge – accurate paired shotgun read merg-
ing via overlap. PLoS One 12:e0185056 
35. Buchﬁnk B, Reuter K, Drost H-G (2021) Sen-
sitive protein alignments at tree-of-life scale 
using DIAMOND. Nat Methods 18:366–368 
36. Danecek P, Bonﬁeld JK, Liddle J et al (2021) 
Twelve years of SAMtools and BCFtools. Giga-
science 10(2):giab008 
37. Li H, Durbin R (2009) Fast and accurate short 
read alignment with Burrows-Wheeler trans-
form. Bioinformatics 25:1754–1760 
38. Huang X, Madan A (1999) CAP3: a DNA 
sequence assembly program. Genome Res 9: 
868–877 
39. Altschul SF, Gish W, Miller W et al (1990) 
Basic local alignment search tool. J Mol Biol 
215:403–410 
40. Untergasser A, Cutcutache I, Koressaar T et al 
(2012) Primer3—new capabilities and inter-
faces. Nucleic Acids Res 40:e115–e115

Chapter 7 
From Metagenomics to Ecogenomics: NGS-Based 
Approaches for Discovery of New Circular DNA 
Single-Stranded Viral Species 
Enrique A. Guevara-Rivera, Edgar A. Rodrı´guez-Negrete, 
Rosa Lozano-Dura´n, Eduardo R. Bejarano, Alan M. Torres-Caldero´n, 
A´ ngela P. Arce-Leal, Norma E. Leyva-Lo´pez, and Jesu´s Me´ndez-Lozano 
Abstract 
Viruses comprise the most abundant genetic material in the biosphere; however, global viral genomic 
population (virome) has been largely underestimated. Recently, high-throughput sequencing (HTS) has 
provided a powerful tool for the detection of known viruses and the discovery of novel viral species from 
environmental and individual samples using metagenomics and ecogenomics approaches, respectively. 
Viruses with circular DNA single-stranded (ssDNA) genomes belonging to the begomovirus genera (family 
Geminiviridae) constitute the largest group of emerging plant viruses worldwide. The knowledge of 
begomoviruses viromes is mostly restricted to crop plant systems; nevertheless, it has been described that 
noncultivated plants speciﬁcally at the interface between wild and cultivated plants are important reservoirs 
leading to viral evolution and the emergence of new diseases. Here we present a protocol that allows the 
identiﬁcation and isolation of known and novel begomoviruses species infecting cultivated and nonculti-
vated plant species. The method consists of circular viral molecules enrichment by rolling circle ampliﬁca-
tion (RCA) from begomovirus-positive total plant DNA, followed by NGS-based metagenomic 
sequencing. Subsequently, metagenomic reads are processed for taxonomic classiﬁcation using Viromescan 
software and a customized Geminiviridae family database, and begomovirus-related reads are used for 
contigs assembly and annotation using Spades software and Blastn algorithm, respectively. Then, the 
obtained begomovirus-related signatures are used as templates for speciﬁc primers design and implemented 
for PCR-based ecogenomic identiﬁcation of individual samples harboring the corresponding viral species. 
Lastly, full-length begomovirus genomes are obtained by RCA-based ampliﬁcation from total plant DNA of 
selected individual samples, cloning, and viral molecular identity corroborated by Sanger sequencing. 
Conclusively, the identiﬁcation and isolation of a novel monopartite begomovirus species native to the 
New World (NW) named Gallium leaf deformation virus (GLDV) is shown. 
Key words Circular DNA single-stranded viruses, Begomoviruses, Rolling circle ampliﬁcation 
(RCA), High-throughput sequencing (HTS), Metagenomics, Ecogenomics 
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_7, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
103

104
Enrique A. Guevara-Rivera et al.
1 
Introduction 
Viruses comprise the most abundant genetic material in the bio-
sphere. Furthermore, viruses are a group of pathogens with one of 
the most recurrent emergence rates globally [1]. However, the 
quantity of identiﬁed viruses is minor in comparison to those exist-
ing in the environments [2, 3]. This also applies to the virus content 
in plants [4, 5] especially in noncultivated plants, as their study is 
more focused on the virus diseases in cultivated plants [6–9]. Cur-
rently, it is widely documented that noncultivated plants are niches 
of native, novel, and reemerging viral pathogens that later could be 
transmitted to cultivated plants [10, 11]. Additionally, virus inter-
action through the agroecological interfaces in nature (plants, vec-
tors, physical contact, etc.) facilitates the emergence of viral diseases 
[12, 13]. Presently, sequencing platforms (i.e., Illumina) used for 
high-throughput sequencing (HTS) have provided a powerful tool 
for the detection of viruses from natural environments [14, 15] and 
individual samples in the form of metagenomics [16–20], focusing 
toward exploring the diversity of viruses [21, 22]. Meanwhile, eco-
genomics provides the advantage of identifying the speciﬁc host of a 
virus [23, 24], an indispensable steppingstone in the management 
of viral diseases [25]. Plant DNA viruses, such as the Geminiviridae 
family, are recurrent etiological agents of emergent plant diseases 
worldwide [26–28]. This family is currently divided into 14 genera: 
Topilevirus, Opunvirus, Mulcrilevirus, Maldovirus, Citlodavirus, 
Turncurtovirus, Topocuvirus, Mastrevirus, Grablovirus, Eragro-
virus, Curtovirus, Capulavirus, Begomovirus, and Becurtovirus,  by  
the International Committee of Taxonomy Virus (ICTV). Their 
genomes consist of single-stranded DNA (ssDNA), with one or 
two components (mono or bipartite) [29–32]. The genomic struc-
ture of ssDNA viruses is compatible with a series of methods 
denominated as circomics (circular DNA genomics). In this sense, 
rolling circle ampliﬁcation (RCA) has been used to improve the 
recovery of the full-length circular genome sequence of gemini-
viruses infecting a single plant [33, 34]. Since the whole genome 
sequence of a particular virus could be not accurate because of the 
essence of the Illumina-HTS method (with sequencing reads of 
≥200 bp of length) [35], the lengths of geminivirus genomes range 
from 2500 to 3000 bp [36]. In this chapter, we describe a com-
bined methodology to carry out the study of ssDNA viruses from 
samples collected in the natural ecosystem, through the application 
of ecogenomics [37]. Thus, plant DNA samples from Colima 
agroregion of the Northern-Paciﬁc Mexico are used for RCA 
enrichment and sequenced by Illumina-HTS approach [37], data 
are analyzed using ViromeScan [38], and SPAdes [39] assemble the 
viral genomes and determine the geminivirus diversity. To validate 
the obtained begomovirus-signature reads of potential novel

geminivirus species in Mexico, speciﬁc PCR detections in single 
samples, followed by complete genome cloning and sequencing, 
are performed [40]. Interestingly, we conﬁrm and isolate a com-
plete genomic sequence of a novel monopartite begomovirus native 
of the New World (NW) designated as Galium leaf distortion virus 
(GLDV) in the endemic noncultivated plant species Galium mex-
icanum [40]. Finally, the methodology presented has been vali-
dated to discover novel circular ssDNA viral species in an efﬁcient 
and precise manner that could be applied to explore and discover 
the unidentiﬁed viral world. 
NGS-Based Discovery of New Circular ssDNA Viral Species
105
2 
Materials 
All solutions are prepared with ultrapure deionized nuclease-free 
H2O (see Note 1) and analytical grade reagents. Where indicated, 
solutions are sterilized by autoclaving (120 °C, 1 bar, 20 min) or 
ﬁltration (0.2 μm membranes). Prepare and store reagents accord-
ing to their individual speciﬁcations. 
This protocol is speciﬁcally focusing on DNA extracts from 
plant samples using CTAB method (see Note 2) previously vali-
dated as begomovirus PCR-positive using degenerate universal 
primers (see Note 3). As an example, a total of 49 begomovirus 
PCR-positive noncultivated plants are used for NGS-based discov-
ery of a new begomovirus species. 
2.1 
Circular Viral 
DNA RCA-Based 
Enrichment and 
Preparation of Material 
for HTS Sequencing 
1. Rolling circle ampliﬁcation (RCA) DNA Ampliﬁcation Kit (see 
Note 4). 
2. Phenol:chloroform:isoamyl alcohol 25:24:1 solution (see Note 
5). Store the mixture in a clean brown glass bottle in a fume 
hood at room temperature. 
3. 3 M Sodium acetate (CH3COONa) pH 5.2 (see Note 6). Store 
at room temperature. 
4. 100% absolute ethanol. Store at -20 °C. 
5. 70% ethanol. Store at -20 °C. 
6. Agarose gel electrophoresis equipment: 1% agarose gel in TAE 
buffer stained with EtBr or red safe, electrophoresis horizontal 
chamber, molecular weight DNA ladder (100 bp -10 kb). Gel 
loading dye: 50% glycerol, 40 mM EDTA pH 8.0, 0.1% bro-
mophenol blue w/v, 0.1% xylene cyanol w/v (see Note 7). 
2.2 
Bioinformatics
1. FastQC software (http://www.bioinformatics.babraham.ac. 
uk/projects/fastqc). 
2. Trimmomatic software (http://www.usadellab.org/cms/? 
page=trimmomatic).

106
Enrique A. Guevara-Rivera et al.
3. Viromescan software (https://github.com/simonerampelli/ 
viromescan). 
4. R software (https://www.r-project.org/). 
5. SPAdes software (https://cab.spbu.ru/software/spades/). 
6. BLAST software (https://ftp.ncbi.nlm.nih.gov/blast/ 
executables/blast+/LATEST/). 
2.3 
Ecogenomic-
Based-Speciﬁc Virus 
Detection 
1. Primers for SPLCV-like begomovirus-signature detection (see 
Note 8). 
SP-Like-F: TCGAACTGCACAAGCACATG 
SPLike-R: AGCTCAGAGTTGGTGACATCC 
2. Total DNA from 49 begomovirus PCR-positive noncultivated 
plants putatively containing the SPLCV-like begomovirus 
signature. 
3. Taq DNA polymerase kit. 
4. Agarose gel electrophoresis equipment. 
2.4 
RCA-Based Full-
Length Begomovirus 
Genome Cloning and 
Molecular Identity 
Validation 
1. Rolling circle ampliﬁcation (RCA) DNA Ampliﬁcation Kit. 
2. Total 
DNA 
from 
SPLCV-like 
begomovirus 
signature 
PCR-positive noncultivated plant sample. 
3. BamHI restriction DNA endonucleases. 
4. Plasmidic DNA cloning vector (see Note 9). 
5. Agarose gel electrophoresis equipment. 
6. Silica-based agarose gel DNA extraction kit (see Note 10). 
7. DNA sequence assembly and analysis software, SeqMan 
(DNASTAR Inc.), and SnapGene (GLS Biotech, LLC) soft-
ware, respectively (see Note 11). 
3 
Methods 
The general workﬂow of protocol can be divided into the following 
steps: (1) Sample preparation and HTS metagenomic sequencing. 
This step consists in viral molecules enrichment by RCA from 
begomovirus-positive total plant DNA, followed by HTS-based 
metagenomic sequencing, (2) bioinformatics metagenomic data 
processing. This step comprehends metagenomic reads processing 
for begomovirus-related reads taxonomic classiﬁcation, followed by 
contigs assembly and annotation. (3) Ecogenomic virus detection 
and RCA-guided cloning and sequencing. This step consists in 
ecogenomic-speciﬁc virus detection, RCA-based full-length viral 
genome cloning, sequencing, and molecular viral identity valida-
tion (Fig. 1).

NGS-Based Discovery of New Circular ssDNA Viral Species
107
Fig. 1 Workﬂow of protocol for NGS-based discovery of new circular DNA single-stranded viral species. 
Protocol consists of three main steps: (1) sample preparation and HTS metagenomic sequencing, (2) bioinfor-
matics metagenomic data processing, (3) ecogenomic virus detection and RCA-guided cloning. (Created with 
BioRender.com) 
3.1 
Circular Viral 
DNA RCA-Based 
Enrichment and 
Preparation of 
Samples for HTS 
Sequencing 
DNA extracts from a total of 49 begomovirus PCR-positive noncul-
tivated plants belonging to 27 different species from our laboratory 
Colima state, Mexico sample collection are used as starting biological 
material for circular viral DNA RCA-based enrichment and HTS 
sequencing (Fig. 2) according to the next protocol. The collected 
plant species are as follows: Amaranthus hybridus (n = 1), Amar-
anthus retroﬂexus (n = 1), Amaranthus spinosus (n = 2), Cosmos 
sulphureus (n = 2), Melampodium rosei (n = 1), Erigeron longipes 
(n = 1), Commelina diffusa (n = 1), Ipomoea hederacea (n = 1), 
Ipomoea spp. (n = 2), Merremia quinquefolia (n = 1), Momordica 
charantia (n = 5), Acalypha setosa (n = 1), Euphorbia hypericifolia 
(n = 1), Rhynchosia spp. (n = 1), Nama hispida (n = 1), Sida Collina 
(n = 1), Herissantia crispa (n = 8), Malvastrum coromandelianum 
(n = 3), Sida acuta (n = 1), Boerhavia coccinea (n = 5), Portulaca 
oleracea (n = 2), Galium mexicanum (n = 1), Richardia scabra 
(n = 1), Solanum nigrescens (n = 2), Verbenacea spp (n = 1), Priva 
lappulacea (n = 1), and Cissus sicyoides (n = 1). 
1. Mix in equimolar concentration total DNA from begomovirus 
PCR-positive plants belonging to the same plant species (i.e., 
100 ng each sample belonging to the same species). 
2. Mix 5 μL of RCA kit sample buffer (see Note 12) with 1 μL 
(100 ng/μL) of each DNA sample. 
3. Incubate at 95 °C for 3 min. 
4. Cool the samples in ice for 5 min and combine with 5 μL  of  
reaction buffer (see Note 13) and 0.2 μL  of  ϕ29 DNA poly-
merase enzyme mix.

108
Enrique A. Guevara-Rivera et al.
Fig. 2 Circular viral DNA RCA-based enrichment and preparation of samples for NGS sequencing. (a) DNA 
extracts from a total of 49 begomovirus PCR-positive noncultivated plants from our laboratory Colima state, 
Mexico sample collection are pooled in equimolar concentrations per species (27 different species) and used 
as template for circular viral DNA RCA-based enrichment. (b) Resulting RCA products (27) are mixed and used 
for HTS procedure. (Created with BioRender.com) 
5. Incubate samples at 30 °C for 18 h. 
6. Inactivate the DNA polymerase by heating at 65 °C for 10 min 
(see Note 14). 
7. Evaluate the purity and yield of the RCA products by spectro-
photometric assay according to the A260/A280 ratio (see 
Note 15). 
8. Pool all RCA products (a total of 27) in equimolar concentra-
tions (see Note 16). 
9. Add nuclease-free deionized H2O up to 400 μL. 
10. Add 400 μL of phenol:chloroform:isoamylic alcohol (25:24:1) 
solution. 
11. Mix vigorously by vortexing. 
12. Centrifuge the mixture at 13,000 rpm for 10 min. 
13. Carefully transfer the upper aqueous phase to a new tube. 
14. Add to the aqueous phase (400 μL) 40 μL  of  3  M  CH3COONa 
and 1 mL of absolute ethanol.

NGS-Based Discovery of New Circular ssDNA Viral Species
109
15. Mix gently by inversion and centrifuge the mixture at 
13,000 rpm for 10 min to precipitate the DNA. 
16. Discard the supernatant, wash the pellet with 1 mL of 70% 
ethanol. 
17. Centrifuge the mixture at 13,000 rpm for 5 min. 
18. Discard the supernatant and air dry the pellet. 
19. Resuspend in 50 μL of nuclease-free deionized H2O. 
20. Assess the integrity of the RCA-derived ampliﬁcation products 
by 1% agarose gel electrophoresis (see Note 17). 
21. Use cleaned RCA products for HTS library construction. In 
our case, we outsourced this step. Library preparation is per-
formed using Illumina Nextera XT protocol on a MiSeq500 
machine (see Note 18). Data ﬁles are provided in FASTQ 
format and paired-end of 150 bp. 
3.2 
Bioinformatic 
Analysis of 
Metagenomic Reads 
Metagenomic reads are processed to obtain begomovirus-related 
reads taxonomic classiﬁcation, followed by contigs assembly and 
annotation using a customized pipeline (Fig. 3) according to the 
next protocol. 
1. Sequencing quality check is performed for all Illumina reads 
samples using FASTQC software with default settings. Based 
on the quality report produced by FASTQC (html format), 
information about quality threshold and trimming parameters 
is identiﬁed among all samples. 
2. Trimming process on raw reads is performed using Trimmo-
matic [41] software, in which ﬁrst 5 and last 25 nucleotides are 
trimmed off and a 28 Phred-score quality ﬁlter applied along 
with ﬁltering out Illumina sequencing adapters. 
3. Taxonomic classiﬁcation is performed using Viromescan [38] 
with a customized database prepare based on the NCBI taxon-
omy browser (https://www.ncbi.nlm.nih.gov/Taxonomy/ 
Browser/wwwtax.cgi) in which the term Geminiviridae was 
used as a search criteria with “Genome” and “Gene” boxes 
marked as speciﬁc ﬁlter for all nucleotide information related 
with that lineage, this allowed the manual download of 3207 
virus references available at that moment (genomes and genes) 
along with its genomic annotation, then this multifasta ﬁle is 
combined with original Viromescan database of 1646 DNA 
viruses in bash terminal using “cat” command, and the ﬁnal 
database used for this analysis contains 4853 virus sequences. 
This method allows to map, identify, and isolate those reads 
closely related to Geminiviridae taxon. In-house R (https:// 
www.r-project.org/) scripts are produced to generate heat-
maps and diversity percentage barplots for all the samples 
(Fig. 4a).

110
Enrique A. Guevara-Rivera et al.
Fig. 3 Bioinformatic pipeline for metagenomic reads analysis. (Created with BioRender.com) 
Fig. 4 ViromeScan software output and viral-related contigs annotation. (a) The results of the ViromeScan 
analysis of Colima, Mexico library, are visualized as histograms at different phylogenetic levels. An example at 
the species level (Family Geminiviridae, genera Begomovirus), is shown. Relative abundances of different 
begomovirus species are indicated in horizontal colored bars. (b) Examples of annotated contigs ranging from 
100% to 79% identity with homologous genomes available in the NCBI databank are shown. In red is 
highlighted the Node_17 of 465 bp showing 80% identity with SPLCV (Accession number KJ1358.1), 
putatively corresponding to a novel begomovirus species according to current taxonomic criteria (≤89% 
identity, [42])

f
NGS-Based Discovery of New Circular ssDNA Viral Species
111
4. Assemblies for isolated reads by Viromescan classiﬁcation are 
performed using Spades [39] software using default parameters 
with the exception of allocated ram memory (100 GB) and 
threads number (16). 
5. Assembled contigs are annotated using NCBI—Blastn [43] 
algorithm, this allows to classify each contig within each ana-
lyzed sample. For this, local blastn using an up-to-date nucleo-
tide database is downloaded, output format 6 (tabular), e-value 
1E-06 , and 16 threads per sample are applied (Fig. 4b). 
3.3 
Ecogenomic-
Speciﬁc Virus 
Detection, RCA-Guided 
Full-Length 
Begomovirus Genome 
Cloning, and Molecular 
Identity Validation 
The assembly of metagenomic data from Colima, Mexico library 
reveals a subset of begomovirus-related signatures showing ≤80% 
nucleotide identity with reported begomovirus; hence, according 
to current begomovirus species demarcation criteria (≤89% iden-
tity) [42], these signatures could be related to novel begomovirus 
species. A contig of 465 bp and a begomovirus-related signature 
showing an 80% identity with the begomovirus SPLCV is used for 
further ecogenomic and RCA-based cloning approaches. 
1. Perform PCR-detection using 100 ng of total DNA of each 
individual sample (n = 49) from Colima, Mexico sample col-
lection (used for NGS library construction) using SP-like-F/ 
SP-like-R primer set following Taq DNA polymerase kit man-
ufacturer’s recommendations. Analyze PCR products by 1% 
agarose gel electrophoresis to identify positive SPLCV-like 
begomovirus-signature associated samples. In this example, a 
specimen of G. mexicanum is positive to SPLCV-like begomo-
virus-signature (Fig. 5a). 
2. Amplify viral circular molecules by RCA method following the 
protocol described in Subheading 3.1 (steps 2–5) using 
100 ng of DNA from begomovirus-signature (SPLCV-like) 
positive G. mexicanum sample as template. Digest 1 μg o  
RCA product with BamHI endonuclease (see Note 19) follow-
ing the manufacturer’s instructions. Analyze digestion product 
by 1% agarose gel electrophoresis and purify the ~2.7 kb band 
corresponding to full-length linearized begomovirus genome 
using a silica-based agarose gel DNA extraction kit following 
manufacturer’s instructions. Clone puriﬁed ~2.7 kb band into 
plasmid cloning vector previously linearized with BamHI 
enzyme by using standard ligation, E. coli transformation and 
antibiotic/h-complementation (see Note 20) selection proto-
cols (Fig. 5b). 
3. Select positive clones by enzymatic restriction of corresponding 
DNA plasmidic extractions and fully sequence two positive 
clones by primer walking strategy (see Note 21).

112
Enrique A. Guevara-Rivera et al.
Fig. 5 Ecogenomic-speciﬁc virus detection and RCA-guided full-length begomovirus genome cloning. (a) 
PCR-based searching of samples containing SPLCV-like signature. Total DNA of each individual sample 
(n = 49) from Colima, Mexico sample collection is used as template with SP-like-F/SP-like-R primer set. A 
specimen of Galium mexicanum is positive for SPLCV-like signature (232 bp amplicon). (b) Total DNA from 
SPLCV-like signature Galium mexicanum sample is used as template for RCA ampliﬁcation. RCA product is 
digested with BamHI endonuclease for full-length begomovirus genome linearization (~2.7 kb band), followed 
by band cleaning and cloning in plasmid vector. (c) Assembly of circular full-length begomovirus genome. A 
novel begomovirus species (showing 85% identity with its closest relative, Papaya begomovirus 2 available in 
the NCBI databank) native to the New World (NW) named Galium leaf distortion virus (GLDV) is obtained. Viral 
open reading frames (ORFs), intergenic region (IR) AV1, AC1, AC2, AC3, AC4, and AC1 are shown. (Created 
with BioRender.com) 
4. Assembly the full-length begomovirus genome using the 
obtained sequences and DNA sequence assembly and analysis 
software. 
5. Determinate 
phylogenetic 
classiﬁcation 
of 
the 
obtained 
genome by comparison with viral genome homologues avail-
able in the NCBI database following the current begomovirus 
species demarcation criteria (≤89% identity) [42]. 
6. A novel begomovirus species (showing 85% identity with its 
closest relative) native to the New World (NW) named Galium 
leaf distortion virus (GLDV) is obtained (Fig. 5c).

NGS-Based Discovery of New Circular ssDNA Viral Species
113
4 
Notes 
1. To prepare nuclease-free deionized H2O, add 0.1% diethylpyr-
ocarbonate (DEPC) in deionized water, mix, and let sit at room 
temperature overnight and autoclave. Store at room tempera-
ture. 
Commercial 
nuclease-free 
deionized 
H2O 
is 
also 
available. 
2. Total DNA extraction protocol using hexadecyltrimethylam-
monium bromide (CTAB) [44] is a suitable method that allows 
high-quality nucleic acids extractions from plant tissue includ-
ing noncultivated plants. 
3. Degenerate universal primers for PCR-based molecular detec-
tion of a wide range of DNA viruses belonging to begomovirus 
genera have been previously described [45]. 
4. Rolling circle ampliﬁcation (RCA) method utilizes bacterio-
phage ϕ29 DNA polymerase to exponentially amplify single-
or double-stranded circular DNA templates by RCA mecha-
nism. The proofreading and strand-displacement activities of 
ϕ29 DNA polymerase ensure high ﬁdelity DNA replication and 
high yields of nucleic acids production, respectively. The RCA 
product is high molecular weight, double-stranded concate-
mers of the circular template. 
5. Mix phenol (equilibrated with 10 mM Tris–HCl, pH 8, 1 mM 
EDTA), chloroform, and isoamyl alcohol (25:24:1 v/v/v). 
Store the mixture in a clean brown glass bottle in a fume 
hood at room temperature. 
6. Add about 80 mL of deionized water to a 250 mL glass beaker 
and dissolve 24.6 g of sodium acetate. Adjust the pH to 5.2 
with glacial acetic acid and make up to 100 mL with deionized 
water. Filter the solution through a 0.22 μm pore ﬁlter to 
sterilize it and store it in a glass bottle at room temperature. 
7. To prepare the 1% agarose gel, mix 1 g of ultrapure agarose and 
100 mL of 1× TAE buffer (40 mM Tris-acetate, 1 mM EDTA, 
pH 8.3) in a glass bottle. Melt the agarose in a microwave oven 
using 60-s pulses, stop, and swirl until complete dissolution of 
the agarose. Allow the agarose solution to cool to about 50 °C 
and add ethidium bromide (EtBr, 5 mg/mL stock solution) to 
a ﬁnal concentration of 0.5 mg/mL or 10 μL Red safe 
(10,000×) to 1×. Pour the agarose into a gel tray with the 
comb in place and allow to cool until the gel has completely 
solidiﬁed. For sample loading, use 2–3 μL of 10× DNA 
gel-loading dye. 
8. For ecogenomic virus-speciﬁc detection, a contig of 465 bp 
from Colima, Mexico library containing a begomovirus-related 
signature showing an 80% identity with Sweet potato leaf curl

114
Enrique A. Guevara-Rivera et al.
virus (SPLCV) (accession number: MH602265) was used as 
template for SP-like-F/SP-like-r primer set design. Expected 
amplicon is 232 bp. 
9. Plasmid DNA vectors are used to propagate DNA. They repli-
cate in E. coli to high copy numbers and contain a multiple 
cloning site with restriction sites used for inserting a DNA 
fragment. Additionally, plasmid vectors allow identiﬁcation of 
positive recombinant molecules by using antibiotic selectable 
markers. 
10. After DNA digestion, a cleanup step is necessary to completely 
remove enzymes and salts. For this, it is important to use a 
silica-based spin column that allows recovery of pure DNA 
fragments suitable for following cloning steps. 
11. DNA sequence assembly and analysis software allow in silico 
reconstruction of viral genomes and the graphical representa-
tion of viral genetic features (i.e., open reading frames, replica-
tion, origins, promoters, and others). 
12. Sample buffer contains random hexamers that prime DNA 
synthesis nonspeciﬁcally. 
13. Reaction buffer contains salts and deoxynucleotides and is 
adjusted to a pH that supports DNA synthesis. 
14. Heat treatment of RCA products allows the ϕ29 DNA poly-
merase proofreading exonuclease activity inactivation, prevent-
ing degradation of DNA during storage. 
15. Photometric quantiﬁcation of DNA is based on absorption 
properties of nucleic acids. DNA absorbs at 260 nm, whereas 
contaminants, including phenolic compounds and proteins, 
absorb at 280 nm. The ratio of the readings at 260 nm and 
280 nm (A260/A280) provides an estimation of DNA purity 
(pure DNA has an A260/A280 ratio of 1.7–1.9). On the other 
hand, the DNA concentration is determined by measuring the 
absorbance at 260 nm (A260) according to Beer-Lambert’s law 
(an absorbance of 1 unit at 260 nm corresponds to 50 μg DNA 
per mL). 
16. Since RCA ampliﬁcation yields, a high molecular weight prod-
uct is assumed that in saturating conditions, all RCA reactions 
render similar DNA lengths; therefore, equimolar mixed are 
obtained by mixing equal mass DNA quantities (i.e., same 
micrograms of each product). 
17. Appropriate RCA ampliﬁcation products resolved in 1% aga-
rose gel are visualized as a smeared band of high molecular 
weight product (>20 kb). 
18. Additionally to MiSeq500, other Illumina platforms, including 
MiniSeq, MiSeq, NextSeq, HiSeq, NovaSeq, are also commer-
cially available.

NGS-Based Discovery of New Circular ssDNA Viral Species
115
19. In the case of begomovirus-signature (SPLCV-like) associated 
sample, RCA product digested with BamHI yields the ~2.7 kb 
band corresponding to full-length linearized begomovirus 
genome; however, for other begomovirus species, the suitable 
restriction enzyme should be determined experimentally. 
20. Alpha-complementation is the most common form of inser-
tional inactivation. During processes of genetic engineering, 
the so-called Blue-White-Selection is used for the evaluation of 
recombinant bacteria. 
21. Primer walking is a quicker and easier method of sequencing of 
long stretches of DNA. In a ﬁrst step, cloned DNA is 
sequenced as far as possible using primers belonging to plasmid 
vector. Next, the newly obtained sequence information is used 
to design other sequencing primers to complete the desired 
DNA sequence. 
Acknowledgments 
This research was funded by Consejo Nacional de Ciencia y Tecno-
logı´a (CONACyT-PDCPN No. 214950) and Instituto Polite´cnico 
Nacional (SIP 20131613, SIP20141282, SIP20151969, and 
SIP20164812). EAG-R was supported by a fellowship from the 
CONACyT and BEIFI programs of IPN. 
References 
1. Elena SF, Fraile A, Garcı´a-Arenal F (2014) 
Evolution and emergence of plant viruses. 
Adv Virus Res 88:161–191 
2. Stobbe AH, Roossinck MJ (2014) Plant virus 
metagenomics: what we know and why we 
need to know more. Front Plant Sci 5:1–4 
3. Tas¸ N, de Jong AE, Li Y et al (2021) Metage-
nomic tools in microbial ecology research. 
Curr Opin Biotechnol 67:184–191 
4. Roossinck MJ (2012) Plant virus metage-
nomics: biodiversity and ecology. Annu Rev 
Genet 46:359–369 
5. Roossinck MJ, Garcı´a-Arenal F (2015) Ecosys-
tem simpliﬁcation, biodiversity loss and plant 
virus emergence. Curr Opin Virol 10:56–62 
6. Cooper I, Jones RAC (2006) Wild plants and 
viruses: under-investigated ecosystems. Adv 
Virus Res 67:1–47 
7. Prajapat R, Marwal A, Gaur RK (2014) Bego-
movirus associated with alternative host weeds: 
a critical appraisal. Arch Phytopathol Plant Pro-
tect 47:157–170 
8. Keesing F, Belden LK, Daszak P et al (2010) 
Impacts of biodiversity on the emergence and 
transmission of infectious diseases. Nature 468: 
647–652 
9. Paga´n I, Gonza´lez-Jara P, Moreno-Letelier A 
et al (2012) Effect of biodiversity changes in 
disease risk: exploring disease emergence in a 
plant-virus system. PLoS Pathog 8:47 
10. Hasio´w-Jaroszewska B, Boezen D, Zwart MP 
(2021) Metagenomic studies of viruses in 
weeds and wild plants: a powerful approach to 
characterize 
variable 
virus 
communities. 
Viruses 13:1939 
11. Ng TFF, Duffy S, Polston JE et al (2011) 
Exploring the diversity of plant DNA viruses 
and their satellites using vector-enabled meta-
genomics on whiteﬂies. PLoS One 6:e19050 
12. Alexander HM, Mauck KE, Whitﬁeld AE et al 
(2014) Plant-virus interactions and the agro-
ecological interface. Eur J Plant Pathol 138: 
529–547

13 .
116
Enrique A. Guevara-Rivera et al.
Burdon JJ, Thrall PH (2008) Pathogen evolu-
tion across the agro-ecological interface: impli-
cations for disease management. Evol Appl 1: 
57–65 
14. Bacˇnik K, Kutnjak D, Pecman A et al (2020) 
Viromics and infectivity analysis reveal the 
release of infective plant viruses from wastewa-
ter into the environment. Water Res 177: 
115628 
15. Muthukumar V, Melcher U, Pierce M et al 
(2009) Non-cultivated plants of the Tallgrass 
Prairie Preserve of northeastern Oklahoma fre-
quently contain virus-like sequences in particu-
late fractions. Virus Res 141:169–173 
16. Roossinck MJ (2011) The big unknown: plant 
virus biodiversity. Curr Opin Virol 1:63–67 
17. Galbraith DA, Fuller ZL, Ray AM et al (2018) 
Investigating the viral ecology of global bee 
communities with high-throughput metage-
nomics. Sci Rep 8:8879 
18. Lappe RR, Elmore MG, Lozier ZR et al (2022) 
Metagenomic identiﬁcation of novel viruses of 
maize and teosinte in North America. BMC 
Genomics 23:767 
19. Kyrychenko AN, Shcherbatenko IS, Kovalenko 
AG (2021) Viruses of wild plants and current 
metagenomic methods for their investigation. 
Cytol Genet 55:248–255 
20. Susi H, Filloux D, Frilander MJ et al (2019) 
Diverse and variable virus communities in wild 
plant populations revealed by metagenomic 
tools. PeerJ 7:e6140 
21. Idris A, Al-Saleh M, Piatek M et al (2014) Viral 
metagenomics: analysis of Begomoviruses by 
illumina high-throughput sequencing. Viruses 
6:1219–1236 
22. Rosario K, Seah Y, Marr C et al (2015) Vector-
enabled metagenomic (VEM) surveys using 
whiteﬂies (Aleyrodidae) reveal novel Begomo-
virus species in the new and oldworlds. Viruses 
7:5553–5570 
23. Akinyemi IA, Wang F, Zhou B et al (2016) 
Ecogenomic survey of plant viruses infecting 
tobacco by next generation sequencing. Virol 
J 13:181 
24. Roossinck MJ, Saha P, Wiley GB et al (2010) 
Ecogenomics: using massively parallel pyrose-
quencing to understand virus ecology. Mol 
Ecol 19:81–88 
25. Haydon DT, Cleaveland S, Taylor LH et al 
(2002) Identifying reservoirs of infection: a 
conceptual and practical challenge. Emerg 
Infect Dis 8:1468–1473 
26. Padidam M, Sawyer S, Fauquet CM (1999) 
Possible emergence of new geminiviruses by 
frequent recombination. Virology 265:218– 
225 
27. Qadir R, Khan ZA, Monga D et al (2019) 
Diversity and recombination analysis of Cotton 
leaf curl Multan virus: a highly emerging bego-
movirus in northern India. BMC Genomics 20: 
274 
28. Saeed ST, Samad A (2017) Emerging threats of 
begomoviruses to the cultivation of medicinal 
and aromatic crops and their management stra-
tegies. VirusDisease 28:1–17 
29. Fiallo-Olive´ E, Lett J-M, Martin DP et al 
(2021) ICTV virus taxonomy proﬁle: Gemini-
viridae 2021. J Gen Virol 102:1–2 
30. Muhire B, Martin DP, Brown JK et al (2013) A 
genome-wide pairwise-identity-based proposal 
for the classiﬁcation of viruses in the genus 
Mastrevirus 
(family 
Geminiviridae). 
Arch 
Virol 158:1411–1424 
31. Varsani A, Navas-Castillo J, Moriones E et al 
(2014) Establishment of three new genera in 
the family Geminiviridae: Becurtovirus, Era-
grovirus and Turncurtovirus. Arch Virol 159: 
2193–2203 
32. Varsani A, Roumagnac P, Fuchs M et al (2017) 
Capulavirus and Grablovirus: two new genera 
in the family Geminiviridae. Arch Virol 162: 
1819–1831 
33. Jeske H (2018) Barcoding of plant viruses with 
circular single-stranded DNA based on rolling 
circle ampliﬁcation. Viruses 10:469 
34. Wyant PS, Strohmeier S, Sch€afer B et al (2012) 
Circular DNA genomics (circomics) exempli-
ﬁed for geminiviruses in bean crops and weeds 
of northeastern Brazil. Virology 427:151–157 
35. Buermans HPJ, den Dunnen JT (2014) Next 
generation sequencing technology: advances 
and applications. Biochim Biophys Acta Mol 
basis Dis 1842:1932–1941 
36. Hanley-bowdoin L, Settlage SB, Orozco BM 
et al (1999) Geminiviruses: models for plant 
DNA replication, transcription, and cell cycle 
regulation. Crit Rev Plant Sci 2689:37–41 
37. Rodrı´guez-Negrete EA, Morales-Aguilar JJ, 
Domı´nguez-Duran G et al (2019) High-
throughput 
sequencing 
reveals 
differential 
Begomovirus
species
diversity
in 
non-cultivated plants in Northern-Paciﬁc Mex-
ico. Viruses 11:594 
38. Rampelli S, Soverini M, Turroni S et al (2016) 
ViromeScan: a new tool for metagenomic viral 
community proﬁling. BMC Genomics 17:165 
39. Bankevich A, Nurk S, Antipov D et al (2012) 
SPAdes: a new genome assembly algorithm and 
its applications to single-cell sequencing. J 
Comput Biol 19:455–477 
40. Guevara-Rivera EA, Rodrı´guez-Negrete EA, 
Are´chiga-Carvajal ET et al (2022) From meta-
genomics to discovery of new viral species:

NGS-Based Discovery of New Circular ssDNA Viral Species
117
galium leaf distortion virus, a monopartite 
Begomovirus 
endemic 
in 
Mexico. 
Front 
Microbiol 13:1–15 
41. Bolger AM, Lohse M, Usadel B (2014) Trim-
momatic: 
a 
ﬂexible 
trimmer 
for 
Illumina 
sequence data. Bioinformatics 30:2114–2120 
42. Brown JK, Zerbini FM, Navas-Castillo J et al 
(2015) Revision of Begomovirus taxonomy 
based 
on 
pairwise 
sequence 
comparisons. 
Arch Virol 160:1593–1619 
43. Altschul SF, Gish W, Miller W et al (1990) 
Basic local alignment search tool. J Mol Biol 
215:403–410 
44. Doyle JJ, Doyle JL (1987) A rapid DNA isola-
tion procedure for small quantities of fresh leaf 
tissue. Phytochem Bull 19:11–15 
45. Mauricio-Castillo JA, Argu¨ello-Astorga GR, 
Ambriz-Granados S et al (2007) First report 
of Tomato golden mottle virus on Lycopersi-
con esculentum and Solanum rostratum in 
Mexico. Plant Dis 91:1513–1513

Chapter 8 
SARS-CoV-2 Detection and Genome Sequencing in Urban 
Wastewaters 
Enric Cuevas-Ferrando, Gloria Sa´nchez, and Alba Pe´rez-Catalun˜a 
Abstract 
Due to the excretion of SARS-CoV-2 in faeces, the use of wastewater-based epidemiology (WBE) is a useful 
tool for virus surveillance in large populations. The analysis of this virus includes a concentration step prior 
to virus detection by RT-qPCR. In addition, the use of massive sequencing allows the detection of speciﬁc 
mutations of clinical importance, as well as the detection of the introduction of new lineages in a speciﬁc 
population. In this chapter, we describe the analysis of SARS-CoV-2 in urban wastewater by the concentra-
tion of the samples by precipitation with aluminum chloride, the detection, and quantiﬁcation of SARS-
CoV-2 RNA by RT-qPCR and the genomic sequencing using two different sequencing platforms. 
Key words SARS-CoV-2, Wastewater, RT-qPCR, Genome sequencing, Illumina sequencing, Nano-
pore sequencing 
1 
Introduction 
Transmission of SARS-CoV-2 occurs mainly through aerosols and 
respiratory secretions [1], but it has also been seen to be excreted in 
feces and urine due to its replication capacity in the gastrointestinal 
tract [2]. For this reason, it has been possible to detect genetic 
material of the virus in the feces of symptomatic people, but also of 
asymptomatic ones [3]. These ﬁndings have led to the use of 
wastewater for SARS-CoV-2 monitoring. The use of wastewater-
based epidemiology (WBE) is a very useful tool for large-scale 
epidemiological surveillance [3] and has been previously used for 
monitoring other pathogenic viruses [4–6]. The combination of 
WBE with genome sequencing techniques has been proved to be 
useful for the analysis of SARS-CoV-2 viral diversity present in 
wastewater samples [7–11]. However, the presence of viruses in 
wastewater is very low as compared with other microorganisms. 
Thus, concentration steps previous to nucleic acid extraction must 
be performed [12]. There are several methodologies described to
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_8, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
119

perform virus concentration [13–15]. In this chapter, precipitation 
mediated by aluminum chloride is presented [16]. After sample 
concentration, detection and quantiﬁcation of SARS-CoV-2 RNA 
are performed by RT-qPCR. During the COVID-19 pandemic, 
several targets and PCR primer sets have been published, with 
different levels of sensitivity [16]. In this chapter, a RT-qPCR 
targeting the N1 region of the nucleocapsid gene is used, as 
described by CDC (2020) [17]. Positive samples for SARS-CoV-
2 with cycling threshold (Ct) values lower than 32 are used for 
genomic sequencing. For this step, two different protocols are 
presented, depending on the sequencing platform used (Illumina 
or Nanopore) (Fig.1).
120
Enric Cuevas-Ferrando et al.
Fig. 1 Graphical abstract representing the procedure described in this chapter 
2 
Material 
2.1 
Sample 
Concentration 
1. Orbital shaker. 
2. Centrifuge (capable of centrifuging 200 mL water samples). 
3. Centrifuge bottle. 
4. 0.9 N AlCl3 pH 7.4. 
5. 1 N HCl solution. 
6. 1 N NaOH solution. 
7. Phosphate-buffered saline (PBS) pH 7.4. 
8. 3% Beef extract solution in dH2O.

SARS-CoV-2 in Wastewater
121
9. 1.5 mL tubes. 
10. pH indicator strips/pH test papers. 
11. Laboratory scale. 
12. Falcon tubes. 
2.2 
Nucleic Acid 
Extraction 
1. Maxwell® RSC 16 Instrument (Promega). 
2. Heating thermoblock (60 °C). 
3. Centrifuge. 
4. Maxwell RSC Pure Food GMO and authentication kit 
(Promega). 
2.3 
RT-qPCR 
Detection 
1. Thermal 
cycler 
instrument 
(here 
we 
use 
LightCycler 
480 instrument (Roche Diagnostics)). 
2. 96-well plates with plastic seals. 
3. 1.5 mL DNA low-binding tubes. 
4. One Step PrimeScript™ RT-PCR Kit (Perfect Real Time) 
(Takara Bio). 
5. SARS-CoV-2 genomic RNA (ATCC VR-1986D) or Synthetic 
SARS-CoV-2 RNA Control 2 (MN908947.3, Twist Biosci-
ence HQ). 
6. SARS-CoV-2 N1 region of the nucleocapsid gene speciﬁc pri-
mers (CDC, 2020): Primers at 400 nM ﬁnal concentration; 
Probes at 200 nM ﬁnal concentration. Primers and probes 
premixed in commercial kits from IDT Technologies. 
7. Nuclease-free water. 
2.4 
Genome 
Ampliﬁcation for 
Sequencing 
1. Thermal cycler instrument. 
2. 96-well PCR plates with plastic seals or PCR tubes. 
3. Nuclease-free water. 
4. LunaScript™ RT SuperMix Kit (New England Biolabs). 
5. Q5® Hot Start High-Fidelity 2X Master Mix (New England 
Biolabs). 
6. 100 μM SARS-CoV-2 Artic primer scheme (see Note 1). 
2.5 
PCR Amplicons 
Cleanup 
1. Qubit ﬂuorometer and reagents (or equivalent). 
2. Agilent TapeStation 4150 and reagents (or equivalent). 
3. Rotator mixer. 
4. Magnetic separator for 96-well PCR plates or 0.2 mL PCR 
tubes. 
5. 96-well PCR plates with plastic seals or 0.2 mL PCR tubes. 
6. 1.5 mL low binding tubes.

122
Enric Cuevas-Ferrando et al.
7. Agencourt AMPure XP beads or similar. 
8. Freshly-prepared 80% ethanol in nuclease-free water (total vol-
ume depends on the number of samples). 
2.6 
Nanopore Library 
Preparation 
1. Thermal cycler instrument. 
2. Qubit ﬂuorometer and reagents (or equivalent). 
3. Rotator mixer. 
4. Magnetic separator for 96-well PCR plates or 0.2 mL PCR 
tubes. 
5. 96-well PCR plates with plastic seals or 0.2 mL PCR tubes. 
6. 1.5 mL low binding tubes. 
7. Nuclease-free water. 
8. Freshly-prepared 80% ethanol in nuclease-free water (total vol-
ume depends on the number of samples). 
9. Agencourt AMPure XP beads. 
10. NEBNext Ultra II End repair/dA-tailing Module (New Eng-
land Biolabs). 
11. NEB Blunt/TA Ligase Master Mix (New England Biolabs). 
12. NEBNext Quick Ligation Module (New England Biolabs). 
13. Native barcoding kit (Oxford Nanopore) (see Note 2). 
14. Ligation sequencing kit (Oxford Nanopore) (see Note 2). 
2.7 
Illumina Library 
Preparation 
1. Thermal cycler instrument. 
2. Qubit ﬂuorometer and reagents (or equivalent). 
3. Magnetic separator for 96-well PCR plates or 0.2 mL PCR 
tubes. 
4. 96-well PCR plates with plastic seals or 0.2 mL PCR tubes. 
5. 1.5 mL low-binding tubes. 
6. Nuclease-free water. 
7. Freshly prepared 80% ethanol in nuclease-free water (total 
volume depends on the number of samples). 
8. Illumina DNA Prep kit. 
9. Index adapters. 
3 
Methods 
3.1 
Sample 
Concentration 
This protocol has been adapted from [18]. 
1. Add 100 uL of mengovirus (vMCO CECT 10000) diluted 
1/10 or 1/100 (depending on starting concentration) to 
200 mL of wastewater sample as process control.

SARS-CoV-2 in Wastewater
123
2. Adjust sample to pH 6 with 1 N or 0.1 N HCl while mixing 
vigorously. 
3. Add 1 part 0.9 N AlCl3 solution (2 mL) to 100 parts sample 
(200 mL) to give a ﬁnal 0.009 N Al+3 concentration. Add to 
each of the centrifuge tubes 2 mL of a 4% (w/V) AlCl3 solution 
(0.4 g AlCl3 in 10 mL of distilled water, this stock solution 
must be prepared beforehand in the laboratory fume hood). 
Once the AlCl3 has been added, the centrifuge tubes are man-
ually shaken to ensure good mixing of the AlCl3. 
4. Re-adjust sample to pH 6 with 1 N or 0.1 N HCL or 1 N or 
0.1 N NaOH. 
5. Mix samples slowly in a shaker (150 rpm) for 15 min at room 
temperature. 
6. Centrifuge at 1700 × g for 20 min. 
7. Discard supernatant and resuspend sediment in 10 mL 3% beef 
extract (1/20 of the volume of the original sample) at pH 7.4. 
8. Mix the suspension (if necessary, adjust pH to 7.4 with 0.1 N 
HCL or 0.1 N NaOH) for 10 min. 
9. Centrifuge at 1900 × g for 30 min. 
10. Decant supernatant and resuspend into 1 mL PBS. 
3.2 
Nucleic Acid 
Extraction 
Nucleic acid extraction is performed with the bench top Maxwell® 
RSC Instrument using the Maxwell RSC Pure Food GMO and 
authentication kit. 
Manufacturer’s recommended protocol is modiﬁed according 
to laboratory sample-based method optimization assays [1]: 
1. Add 400 μL of cetyltrimethyl ammonium bromide (CTAB) 
and 40 μL of proteinase K solution to 300 μL of sample, vortex, 
and incubate the mix at 60 °C for 10 min. 
2. Centrifuge the mix at 16,000 × g for 10 min and discard the 
pellet. 
3. Transfer the supernatant to the loading cartridge along with 
300 μL of lysis buffer. 
4. Add 50 μL of elution buffer to the elution tubes and place the 
RSC plungers in the cartridge. 
5. Place the cartridge in the Maxwell® RSC Instrument and start 
the extraction by selecting the “Maxwell RSC Viral total 
Nucleic Acid” program incorporated in the instrument 
software. 
3.3 
RT-qPCR 
Detection 
Viral detection of SARS-CoV-2 is performed by RT-qPCR using 
One Step PrimeScript™ RT-PCR Kit (Perfect Real Time) and 
targeting the N1 region of the nucleocapsid gene (CDC, 2020) 
(Tables 1 and 2).

124
Enric Cuevas-Ferrando et al.
Table 1 
Thermal amplification conditions for the RT-qPCR 
Retrotranscription
Activation
Denaturation
Annealing
Cycles 
50 °C, 15 min
95 °C, 2 min
95 °C, 3 s
55 °C, 30 s
45 
Table 2 
Primers and probes used for the detection of SARS-CoV-2 
Virus
Target
Name
Sequences (5′–3′) 
USCDC_N1_F
GACCCCAAAATCAGCGAAAT 
USCDC_N1_R
TCTGGTTACTGCCAGTTGAATCTG 
USCDC_N1_P
FAM-ACCCCGCATTACGTTTGGTGGACC-BHQ1 
RT-qPCR assays are performed in duplicate on a thermal cycler. 
Positive (genomic RNA or synthetic SARS-CoV-2 RNA Con-
trol 2) and negative (nuclease-free water) controls must be always 
included. 
Standard curves for SARS-CoV-2 quantiﬁcations need to be 
performed using the genomic RNA or synthetic SARS-CoV-
2 RNA Control 2 with serial tenfold dilutions in triplicate. 
1. Prepare a master mix for the RT-qPCR detection of SARS-
CoV-2 by adding to an 1.5 mL tube the following reactive 
volumes per sample: 5 μL of Buffer, 2X One Step RT-PCR 
Buffer III, 0.2 μL of Takara Ex Taq HS (5u/μL), 0.2 μL of  
PrimeScript RT enzyme Mix II, 0.75 μL of Mix containing 
Forward primer, Reverse primer, Probe. Add water to a ﬁnal 
reaction volume of 10 μL. 
2. Add 7.5 μL of mix to each well in the PCR plate together with 
2.5 μL of sample RNA. 
3. Place the PCR plate in the thermal cycler and start the run by 
applying the ampliﬁcation conditions from Table 1. 
3.4 
Genome 
Ampliﬁcation 
1. Perform the retrotranscription reaction in 96-well PCR plates 
or 0.2 mL PCR tubes by mixing 4 μL of LunaScript™ RT 
SuperMix Kit with 16 μL of sample and mix by pipetting. 
2. Spin down the tubes or plates. 
3. Incubate the samples in a thermal cycler as follows: 25 °C for 
2 min, 55 °C for 10 min., and 95 °C for 1 min. 
4. After incubation, maintain the samples at 4 °C until the next 
steps. 
5. For genome ampliﬁcation, each sample will be ampliﬁed in two 
separated reactions, corresponding to the primer pools A and

f
SARS-CoV-2 in Wastewater
125
B. For each reaction mix 3.8 μL of nuclease-free water, 3.7 μL 
of the corresponding primer pool (A or B) at 10 μM, 12.5 μL of  
Q5® Hot Start High-Fidelity 2X Master Mix, and 5 μL o  
retrotranscribed sample. Perform the reactions in 96-well 
plates or 0.2 mL PCR tubes. 
6. Spin down the tubes or plates. 
7. Incubate the samples in a thermal cycler as follows: 98 °C for 
30 s, 35 cycles of 98 °C for 15 s and 65 °C for 5 min. 
8. Once the PCR reaction ﬁnishes, for each sample, mix the total 
volume of pools A and B reactions in a single tube or well and 
mix by pipetting. 
9. Maintain the samples at 4 °C until the next steps. 
3.5 
PCR Amplicons 
Cleanup 
1. Resuspend the AMPure XP beads or similar by vortexing, add 
50 μL of resuspended AMPure XP beads to each tube or well, 
and mix gently by pipetting. 
2. Incubate on a rotator mixer 10 min at room temperature. 
3. Spin down the tubes or the 96-well plate and pellet the beads 
on a magnet for 5 min. 
4. Pipette off the supernatant once the eluate is clear and 
colorless. 
5. Maintaining the tubes or the plate on the magnet, wash the 
beads with 200 μL of 80%. Be careful to not disturb the pellet. 
6. Discard the ethanol and repeat step 5. 
7. Spin down and place the tubes or the plate back on the magnet. 
Pipette off any residual ethanol and allow it to dry avoiding the 
point of cracking of the pellet. 
8. Remove the tubes or the plate from the magnetic rack and 
resuspend each pellet in 15 μL nuclease-free water. 
9. Incubate for 2 min at room temperature. 
10. Pellet the beads on a magnet. 
11. Remove and retain 15 μL of eluate in a new tube or 96-well 
plate. 
12. Quantify the obtained DNA with a Qubit ﬂuorometer and 
check the presence of ≈400 bp in a TapeStation system or 
similar. 
3.6 
Nanopore Library 
Preparation 
This protocol has been adapted from https://community. 
nanoporetech.com/docs/prepare/library_prep_protocols/classic-
pcr-tiling-SARS-CoV-2/v/ptc_9096_v109_revy_06feb2020. 
The starting material corresponds to the DNA quantiﬁed in 
step 12 of Subheading 3.5.

f
126
Enric Cuevas-Ferrando et al.
If using 96-well plates, seal the plates before spin down and 
incubation steps. 
1. In a new tube or 96-well plate, prepare the samples to reach 
200 fmol (50 ng) of PCR product in a ﬁnal volume of 12.5 μL. 
Perform the dilutions with nuclease-free water to reach the 
ﬁnal volume. 
2. Prepare a master mix in a 1.5 mL low-binding tube using 
1.75 μL of NEBNext Ultra II End Prep Reaction Buffer and 
0.75 μL of NEBNext Ultra II End Prep Enzyme Mix per 
sample. 
3. Add 2.5 μL of the NEBNext Ultra II End Prep master mix 
prepared in the previous step to each tube or well and 
spin down. 
4. Incubate at 20 °C for 5 min and 65 °C for 5 min. 
5. Using a unique barcode for each sample, add to each tube or 
well and in this order 6 μL of nuclease-free water, 1.5 μL of  
sample, 2.5 μL of the corresponding barcode, and 10 μL o  
blunt/TA Ligation Master Mix. Mix by pipetting and 
spin down. 
6. Incubate at 20 °C for 20 min and 65 °C for 10 min. 
7. Mix all the barcoded samples in a 1.5 mL low-binding tube 
(Tube 1). 
8. Add 4 μL per number of samples of AMPure XP beads or 
similar to the Tube 1 and mix by pipetting. 
9. Incubate on a rotator mixer for 10 min at room temperature. 
10. Spin down the Tube 1 and pellet the beads on a magnet for 
5 min. 
11. Pipette off the supernatant once the eluate is clear. 
12. Wash the beads with 7.3 μL× n° samples of Short Fragment 
Buffer (SFB). 
13. Resuspend the beads and place the Tube 1 in the magnet. 
14. Remove the supernatant and repeat the steps 12 and 13. 
15. Wash the beads with 100 μL of 80% ethanol. 
16. Remove the ethanol. 
17. Spin down and place the Tube 1 on the magnet. Pipette off any 
residual ethanol. Allow to dry avoiding the point of cracking of 
the pellet. 
18. Remove the tube from the magnetic rack and resuspend the 
pellet in 35 μL nuclease-free water. 
19. Incubate for 2 min at room temperature. 
20. Pellet the beads on the magnet.

SARS-CoV-2 in Wastewater
127
21. Retain 35 μL of eluate into a clean 1.5 mL low-binding tube 
(Tube 2). 
22. Add in a clean 1.5 mL low-binding tube the following reagent 
as follows and mix with slight ﬁnger shakes between reagents: 
30 μL of pooled barcoded samples (from Tube 2), 5 μL 
Adapter Mix II, 10 μL of NEBNext quick ligation reaction 
buffer (5X), and 5 μL of Quick T4 DNA Ligase. Finally, mix by 
pipetting and spin down the tube (Tube 3). 
23. Incubate for 10 min at room temperature. 
24. Add 20 μL of resuspended AMPure XP beads or similar in 
Tube 3 and mix by pipetting. 
25. Incubate on a rotator mixer for 10 min at room temperature. 
26. Spin down the tube and put the tube in a magnet until the 
beads are pelletized. Remove the supernatant. 
27. Add 125 μL of Short Fragment Buffer and resuspend the 
beads. Place the Tube 3 in the magnet until the beads’ pellet 
and the supernatant are colorless. Remove the supernatant. 
28. Repeat step 27. 
29. Spin down and, with the Tube 3 in the magnet, remove the 
remaining supernatant, and allow it to dry without cracking the 
pellet. 
30. Resuspend the pellet with the Tube 3 off the magnet, spin 
down, and incubate for 5 min at room temperature. 
31. Pellet the beads in the magnet and retain 15 μL of eluate in a 
new 1.5 mL low-binding tube (Tube 4). 
32. Quantify 1 μL of the DNA library of the Tube 4 with a Qubit 
ﬂuorometer. 
33. Load between 70 and 130 ng of DNA library into the ﬂow cell. 
Follow manufacturer’s instructions for priming and loading 
the ﬂow cell (https://community.nanoporetech.com/ 
nanopore_learning/lessons/priming-and-loading-your-ﬂow-
cell). 
3.7 
Illumina Library 
Preparation 
This protocol has been adapted from https://support.illumina. 
com/downloads/illumina-dna-prep-reference-guide-100000002 
5416.html. 
The starting material corresponds to the DNA quantiﬁed in 
step 12 of Subheading 3.5. 
If using 96-well plates, seal the plates before spin down and 
incubation steps. 
1. In a new tube or 96-well plate, prepare the samples to reach 
100–500 ng using up to 30 μL of PCR product in a ﬁnal 
volume of 30 μL. Perform the dilutions with nuclease-free 
water to reach the ﬁnal volume.

9
12
128
Enric Cuevas-Ferrando et al.
Table 3 
Number of cycles needed for the amplification of the tagmented DNA in 
the Illumina library preparation step 20 (Subheading 3.7) 
Total DNA input (ng)
PCR cycles 
1– 
10–24
8 
25–49
6 
50–500
5 
2. Prepare a master mix in a 1.5 mL low-binding tube using 11 μL 
of bead-linked transposomes (BLT) and 11 μL of Tagment 
buffer 1 (TB1) per sample and vortex. 
3. Add 20 μL of the Tagmentation master mix prepared in the 
previous step to each tube or well, mix by pipetting ten times, 
and spin down. 
4. Incubate in a thermal cycler at 55 °C for 15 min (activate the 
preheat lid option at 100 °C). Hold the samples at 10 °C. 
5. Add 10 μL Tagment Stop Buffer (TSB) to each tube or well 
and pipette ten times to resuspend the beads. 
6. Incubate in a thermal cycler at 37 °C for 15 min (activate the 
preheat lid option at 100 °C). Hold the samples at 10 °C. 
7. Place the plate or tubes on the magnet until the beads pellet 
and the supernatant are colorless and remove the supernatant. 
8. Remove the plate or tubes from the magnet and add 100 μL 
Tagment Wash Buffer (TWB) by pipetting slowly until beads 
are fully resuspended. 
9. Place the plate or tubes on the magnet until the beads pellet 
and the supernatant is colorless and remove the supernatant. 
10. Repeat step 8. 
11. Place the tubes or plate on the magnet. 
12. Prepare a PCR master mix with 22 μL of Enhanced PCR Mix 
(EPM) and 22 μL of nuclease-free water per sample. 
13. Vortex the PCR master mix and centrifuge at 280 × g for 10 s. 
14. Discard the supernatant of the tubes or plate, while they are in 
the magnet. 
15. Remove tubes or plate from the magnet and add 40 μL of the 
PCR master mix in each tube or well and mix by pipetting. 
16. Shake the tubes or the sealed plate at 1600 rpm for 1 min and 
centrifuge at 280 × g for 3 s.

SARS-CoV-2 in Wastewater
129
17. Add the corresponding volume of the index adapter. Each 
sample will carry a different adapter. For more information 
about adapters, see Illumina webpage. The volume to add 
will depend on the index kit type used: 
(a) 
24-plex kit (in tubes): Add 5 μL of adapter i5 and 5 μL of  
adapter i7 to each sample tube or well. 
(b) 
96-plex kit (in plates): Add 10 μL of pre-paired i5 and i7 
adapters. 
18. Mix each tube or well by pipetting 10 times. 
19. Centrifuge the tubes or the sealed plate at 280 × g for 30 s. 
20. Using a thermocycler, run the following PCR program: 68 °C 
for 3 min, 98 °C for 3 min, X cycles of 98 °C for 45 s, 62 °C for 
30 s and 60 °C for 2 min; a ﬁnal elongation at 68 °C for 1 min 
and hold at 10 °C. The number of cycles will depend on the 
total DNA input as shown in Table 3. 
21. Samples can be stored at this point between 2 °C and 8 °C up  
to 30 days or continue with the following steps of the protocol. 
22. Centrifuge the tubes or plate at 280 × g for 1 min. 
23. Place the tubes or plate in the magnet until the beads are 
pelletized and the supernatant is colorless. 
24. Transfer 45 μL of the supernatant to a new tube or well. 
25. Add 81 μL of Illumina Puriﬁcation Beads (IPB) to each tube or 
well and mix by pipetting ten times. 
26. Shake the tubes or sealed plate at 1600 rpm for 1 min and 
incubate at room temperature for 5 min. 
27. Place the tubes or plate on the magnet until the beads pellet 
and the supernatant is colorless. 
28. Discard the supernatant. 
29. Wash with 200 μL of 80% ethanol without mixing and incubate 
for 30 s. 
30. Remove and discard the supernatant totally. 
31. Let dry at room temperature for 5 min. 
32. Remove the tubes or plate from the magnet and add 32 μL of  
resuspension buffer (RSB) and pipet to resuspend the beads. 
33. Incubate at room temperature for 2 min. 
34. Place the tubes or plate on the magnet until the beads pellet 
and the supernatant is colorless. 
35. Transfer 30 μL of the supernatant to a new tube or well. 
36. Samples can be stored at this point between -25 °C and - 15 ° 
C up to 30 days or continue with the following steps of the 
protocol.

130
Enric Cuevas-Ferrando et al.
37. Quantify the samples in a Qubit ﬂuorometer or similar. 
38. Pool equal library concentrations. Following steps depend on 
the Illumina system used. See Illumina webpage for more 
information about how to proceed with your libraries. 
4 
Notes 
1. This primer scheme has been developed to restore the func-
tionality of some primers against the Omicron variant. In 
https://github.com/artic-network/artic-ncov2019/tree/mas 
ter/primer_schemes/nCoV-2019 can be found the previous 
and the newest versions of the primer schemes. Primer schemes 
for SARS-CoV-2 are in continuous development check the 
newest primer scheme for your ampliﬁcations. 
2. Nanopore sequencing kits depend on the ﬂow cell used; see the 
latest updates in ﬂowcell chemistry and reagents in https:// 
nanoporetech.com/. 
Acknowledgments 
This research was supported by project MCEC WATER (PID 2020 
116789 RB C 42 AEI/FEDER, UE), PTI Salud Global CSIC, the 
VATar COVID 19 and the Lagoon project (PROMETEO/2021/ 
044). IATA-CSIC is a Centre of Excellence Severo Ochoa 
(CEX2021-001189-S MCIN/AEI/10.13039/501100011033). 
EC-F is recipient of a postdoctoral contract from the MICINN 
Call 2018 (PRE2018-083753), and AP-C was supported by a 
postdoctoral fellowship IJC2020-045382-I ﬁnanced by MCIN/ 
AEI/10.13039/501100011033 and by the European Union 
“NextGenerationEU/PRTR”. 
References 
1. Chan JFW, Kok KH, Zhu Z et al (2020) Geno-
mic characterization of the 2019 novel human-
pathogenic coronavirus isolated from a patient 
with atypical pneumonia after visiting Wuhan. 
Emerg Microbes Infect 9:221–236. https:// 
doi.org/10.1080/22221751.2020.1719902 
2. Xiao F, Tang M, Zheng X et al (2020) Evi-
dence for gastrointestinal infection of SARS-
CoV-2. Gastroenterology 158:1831–1833.e3. 
https://doi.org/10.1053/j.gastro.2020. 
02.055 
3. Polo DD, Quintela-Baluja M, Corbishley A 
et al (2020) Making waves: wastewater-based 
epidemiology for SARS-CoV-2 – developing 
robust approaches for surveillance and predic-
tion is harder than it looks. Water Res 186: 
116404. https://doi.org/10.1016/j.watres. 
2020.116404 
4. Heijnen L, Medema G (2011) Surveillance of 
inﬂuenza a and the pandemic inﬂuenza a 
(H1N1) 2009 in sewage and surface water in 
The Netherlands. J Water Health 9:434–442. 
https://doi.org/10.2166/wh.2011.019 
5. Hellme´r M, Paxe´us N, Magnius L et al (2014) 
Detection of pathogenic viruses in sewage 
provided early warnings of hepatitis a virus 
and 
norovirus 
outbreaks. 
Appl 
Environ

SARS-CoV-2 in Wastewater
131
Microbiol 80:6771–6781. https://doi.org/ 
10.1128/AEM.01981-14 
6. Santiso-Bello´n C, Randazzo W, Pe´rez-Cata-
lun˜a A et al (2020) Epidemiological surveil-
lance of norovirus and rotavirus in sewage 
(2016–2017) in Valencia (Spain). Microorgan-
isms 8:458. https://doi.org/10.3390/ 
microorganisms8030458 
7. Crits-Christoph A, Kantor RS, Olm MR et al 
(2021) Genome sequencing of sewage detects 
regionally 
prevalent 
SARS-CoV-2 
variants. 
MBio 12. https://doi.org/10.1128/mbio. 
02703-20 
8. Izquierdo-Lara R, Elsinga G, Heijnen L et al 
(2021) Monitoring SARS-CoV-2 circulation 
and diversity through community wastewater 
sequencing, The Netherlands and Belgium. 
Emerg Infect Dis 27:1405–1415. https://doi. 
org/10.3201/eid2705.204410 
9. Nemudryi A, Nemudraia A, Wiegand T et al 
(2020) Temporal detection and phylogenetic 
assessment of SARS-CoV-2 in municipal waste-
water. Cell Reports Med 1:100098. https:// 
doi.org/10.1016/j.xcrm.2020.100098 
10. Pe´rez-Catalun˜a A, Chiner-Oms A´ , Cuevas-
Ferrando E et al (2021) Spatial and temporal 
distribution of SARS-CoV-2 diversity circulat-
ing in wastewater. Water Res 118007. https:// 
doi.org/10.1016/J.WATRES.2021.118007 
11. De Llanos R, Cejudo-marı´n R, Barneo M et al 
(2022) Monitoring the evolution of SARS-
CoV-2 on a Spanish university campus through 
wastewater analysis: a pilot project for the 
reopening strategy. Sci Total Environ 845: 
157370. https://doi.org/10.1016/j. 
scitotenv.2022.157370 
12. Haramoto E, Kitajima M, Hata A et al (2018) 
A review on recent progress in the detection 
methods and prevalence of human enteric 
viruses in water. Water Res 135:168–186. 
https://doi.org/10.1016/j.watres.2018. 
02.004 
13. Rusin˜ol M, Martı´nez-Puchol S, Fore´s E et al 
(2020) Concentration methods for the quanti-
ﬁcation of coronavirus and other potentially 
pandemic enveloped virus from wastewater. 
Curr Opin Environ Sci Heal. https://doi. 
org/10.1016/j.coesh.2020.08.002 
14. Torii S, Oishi W, Zhu Y et al (2022) Compari-
son of ﬁve polyethylene glycol precipitation 
procedures for the RT-qPCR based recovery 
of murine hepatitis virus, bacteriophage phi6, 
and pepper mild mottle virus as a surrogate for 
SARS-CoV-2 from wastewater. Sci Total Envi-
ron 807:150722. https://doi.org/10.1016/j. 
scitotenv.2021.150722 
15. Giro´n-guzma´n
I,
Dı´az-reolid 
A, 
Cuevas-
ferrando E et al (2023) Evaluation of two dif-
ferent concentration methods for surveillance 
of human viruses in sewage and their effects on 
SARS-CoV-2 sequencing. Sci Total Environ 
862:160914. https://doi.org/10.1016/j. 
scitotenv.2022.160914 
16. Pe´rez-Catalun˜a A, Cuevas-Ferrando E, Ran-
dazzo W et al (2021) Comparing analytical 
methods to detect SARS-CoV-2 in wastewater. 
Sci Total Environ 758:143870. https://doi. 
org/10.1016/j.scitotenv.2020.143870 
17. Centers for Disease Control and Prevention A 
CDC 2019-Novel Coronavirus (2019-nCoV) 
Real-Time RT-PCR Diagnostic Panel. https:// 
www.fda.gov/media/134922/download 
18. AAVV (2018) Section 9510 D. Virus concen-
tration by aluminum hydroxide adsorption-
precipitation, 
chapter 
detection 
of 
enteric 
viruses. In: Rice EW, Baird RB, ADE (eds) 
Standard methods for the examination of 
water and wastewater, 23rd edn. Amer ican 
Water Works Association, Denver, CO

Chapter 9 
Enrichment, Sequencing, and Identiﬁcation of DNA 
Bacteriophages from Fecal Samples 
Quentin Lamy-Besnier and Julian R. Garneau 
Abstract 
Research on individual viruses and phages, as well as viral populations (viromes), is greatly expanding. 
Phages and viromes are increasingly suspected to have numerous impacts on the ecosystem in which they 
reside by interacting directly or indirectly with the other organisms present in their environment. In 
particular, phage communities of the gut microbiota have been associated with a wide range of diseases. 
However, properly investigating intestinal viromes is still very challenging, both experimentally and 
analytically. This chapter proposes a simple and reproducible protocol to separate and enrich DNA phage 
particles from fecal samples, to sequence them, and ﬁnally obtain a basic but robust bioinformatic 
characterization and classiﬁcation of the global bacteriophage community. 
Key words Virome, Shotgun metagenomics, ssDNA phage, dsDNA phage, Protocol phage sequenc-
ing, Virome sequencing, Phage identiﬁcation 
1 
Introduction 
The contribution of gut bacterial populations in general health 
homeostasis is now widely recognized and still under intense inves-
tigation. The gut microbiota composition has been linked to 
numerous noncommunicable diseases such as inﬂammatory bowel 
disease (IBD) [1, 2], obesity [3], and diabetes [4, 5]. Furthermore, 
the realization that the microbiota can affect human cognition and 
brain disorders has led to the inclusion of the microbiota in the 
gut-brain axis [6]. For more than a decade now, the gut microbiota 
is also suspected to be at play in the development of cancer, possibly 
by destabilizing the homeostasis of immunoregulatory pathways of 
the host [7, 8]. 
Viral communities of the gut microbiota are dominated by 
bacteriophages (phages). While most of the previous studies have 
focused on dsDNA phages (mainly Caudoviricetes), an increasing 
amount 
of 
evidence 
shows 
that 
ssDNA 
phages 
(such 
as
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_9, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
133

Microviridae or Inoviridae) are abundant, diverse, and can repre-
sent an important component of the gut ecosystem [9, 10]. Phages 
are thought to have the capacity to modify abundances of key 
bacterial species (i.e., by infection and lysis of their sensitive preys) 
and modulate gene expression of infected bacteria (e.g., when 
present and expressing genes as prophages in bacterial cells). Phages 
have been linked to IBD, and variations in their abundance and 
composition are suspected to contribute to bacterial dysbiosis and 
intestinal inﬂammation [9]. Studies also showed that the human 
virome is involved in colorectal cancer and could be linked to 
survival outcomes in this disease [11]. Besides, viromes also appear 
to have the capacity to modulate gut bacterial communities, leading 
to an unfavorable increase in taxa known to be pathogenic in 
stunted children [12]. Phages are thus suspected to be an increas-
ingly important element that could have major impacts on health 
and disease development. However, in many cases, it is still unclear 
if virome perturbations can be considered the cause of bacterial 
dysbiosis and related health disorders. Another possibility is that 
modulations in viral composition are just a natural consequence of 
changes in bacterial composition.
134
Quentin Lamy-Besnier and Julian R. Garneau
Although the existence of phages has been known for more 
than a century, studies concerning the virome and the interaction 
with bacterial populations as two complex interconnected commu-
nities are still overall very scarce. General interest toward this ﬁeld 
appears to be increasing, but the study of viromes is daunting for 
many researchers because it is limited by technical and analytical 
aspects such as difﬁcult protocols for efﬁcient virome separation, 
enrichment, and identiﬁcation. More precisely, bottlenecks or 
caveats often encountered during the execution of these protocols 
can be (1) low DNA yields not falling within library preparation 
requirements, (2) necessity for PCR ampliﬁcation of viral DNA 
leading to abundance biases, (3) the diversity of genetic material 
of phages (e.g., dsDNA, ssDNA, ssRNA and dsRNA) complicating 
the extraction and sequencing of this genetic information and often 
creating biases, (4) bacterial DNA contaminants in the viral frac-
tions, (5) frequent contig breaks in phage genome assemblies 
caused by micro-diversity and the mosaic nature of their genomes, 
(6) difﬁcult bioinformatic identiﬁcation and classiﬁcation of phage 
contigs in a sample is further limited by the combination of huge 
phage diversity and the scarce reference databases. As is the case for 
bacterial populations, as more phages are discovered and described, 
the easier it will be to identify and characterize phage populations in 
samples. Multiple databases of gut viral sequences have already 
been developed and made available [13–17]. This will ultimately 
lead to a better capacity to understand the implication of speciﬁc 
phages and viromes in health maintenance or disease progression. 
Even if a total metagenomic sequencing can contain dsDNA 
from phage particles, the high and dominating amount of bacterial

DNA in those samples usually complicates the analysis of phages in 
the sample (especially because of prophages present in bacterial 
cells). For this reason, sequencing and characterizing the viral 
fraction separately from the bacterial fraction are more suitable to 
precisely describe the viral composition of a sample. To further 
facilitate and democratize research on mammalian gut viral com-
munities, we propose here an end-to-end protocol starting from 
fecal samples to the identiﬁcation of both ssDNA and dsDNA 
phages present in a human or mouse fecal sample, using tools 
available in December 2022. The global steps of the proposed 
procedure are summarized in Fig. 1. This protocol was inspired 
by recent studies in the ﬁeld [18–20]. As research in this area is 
rapidly expanding, it is expected that additional relevant tools will 
continue to emerge in the near future. 
Identiﬁcation of DNA Bacteriophages from Fecal Samples
135
Fig. 1 Proposed workﬂow for the identiﬁcation of DNA phages present in fecal samples 
Sequencing the viral fraction will inform on the presence and 
relative quantity of phage particles present in the sample including 
temperate phages that can be auto-induced from bacterial cells 
(if auto-induction rate is high enough to allow the detection of 
phage particles). This protocol does not capture the noninduced 
latent prophage sequences that are obtainable only if we sequence 
the host bacterial cell genetic content, which is in theory absent 
from a pure viral fraction of the sample. Ideally, whenever possible,

it is always recommended to sequence both the viral and bacterial 
fractions in parallel. When the bacterial fraction is sequenced along 
the viral fraction, it becomes possible to match the induced pro-
phages to their respective bacterial genomes and get a better idea of 
the active prophages present in bacterial genomes. The second part 
of the protocol focuses on the bioinformatics analysis and identiﬁ-
cation of phage contigs. It has been thought to be executable by 
scientists with minimal bioinformatics experience but ideally 
requires at least a minimal knowledge of command-line usage 
(e.g., bash language and UNIX terminal). 
136
Quentin Lamy-Besnier and Julian R. Garneau
In a laboratory with access to sequencing machines, and being 
somewhat conservative, the whole process can be expected to be 
completed in around 2 weeks: About 2 days for the puriﬁcation of 
the viral fraction and DNA extraction, 4 days for library preparation 
and sequencing (if done in-house), and less than a week for the 
bioinformatic analysis. Library preparation and sequencing gener-
ally take around 4 weeks or less when outsourced to a sequencing 
platform. 
2 
Materials 
2.1 
Sample 
Collection and Storage 
1. Collected samples (human or mouse fecal matter, in 15 mL 
tubes). 
2. 15 mL tubes. 
3. Analytical balance. 
4. Ice. 
2.2 
Filtration
1. 10 mM Tris-HCl buffer pH 7.5. 
2. Vortex. 
3. Benchtop centrifuge reaching 5200 g, 4 °C. 
4. Syringes. 
5. 0.45 μm diameter polyethersulfone (PES) ﬁlters. 
2.3 
Concentration
1. 13.2 mL UltraClear Tube 9/16 × 3–1/2″. 
2. Sterile water for equilibration. 
3. Beckman SW41 Ti rotor. 
4. Ultracentrifuge reaching 40,000 RPM (273,620 g). 
5. TN buffer: 50 mM Tris-HCl pH 7.5, 100 mM NaCl, 10 mM 
MgSO4. 
6. .1.5 mL tubes.

Identiﬁcation of DNA Bacteriophages from Fecal Samples
137
2.4 
DNAse Treatment
1. 2 
U/μL 
DNAse 
I 
(ThermoFisher 
DNase 
TURBO™ 
recommended). 
2. 10X DNAse buffer. 
3. 2 mg/mL RNAse A—5000 U/mL RNAse T1 (RNAse A/T1 
mix recommended). 
4. 0.5 M EDTA. 
5. Dry bath reaching 75 °C. 
2.5 
Protease 
Treatment 
1. 20 mg/mL Proteinase K. 
2. 10% SDS. 
3. Dry bath reaching 55 °C. 
2.6 
DNA Extraction
1. 25:24:1 vol/vol phenol–chloroform–isoamyl alcohol. 
2. Vortex. 
3. Benchtop centrifuge reaching 16,000 g. 
4. 1.5 mL tubes. 
5. 24:1 vol/vol Chloroform-isoamyl alcohol. 
2.7 
DNA 
Precipitation 
1. 3 M Sodium acetate pH 4.8. 
2. Glycogen. 
3. Ethanol stored at -20 °C. 
4. Benchtop centrifuge reaching 15,000 g, 4 °C. 
5. 10 mM Tris-HCl buffer pH 7.5. 
6. Fluorometer (Qubit™) or similar input DNA quantiﬁcation 
instrument. 
7. Qubit dsDNA HS kit. 
8. NanoDrop™ Spectrophotometer. 
2.8 
Library 
Preparation 
1. xGen™ ssDNA & Low-Input DNA Library Prep Kit. 
2. Indexing Kit (e.g., xGen UDI primer pairs). 
3. Covaris® ultrasonicator. 
4. 0.2 mL magnets for individual tubes and plates. 
5. Fluorometer (Qubit™) or similar input DNA quantiﬁcation 
instrument. 
6. 2100 Bioanalyzer™ instrument or equivalent for library size 
determination. 
7. Quantitative PCR instrument. 
8. Microcentrifuge. 
9. Programmable thermal cycler. 
10. Vortex.

f
138
Quentin Lamy-Besnier and Julian R. Garneau
2.9 
Sequencing
1. Illumina-technology sequencing apparatus. 
2.10 
Bioinformatic 
Analysis 
1. UNIX-based operating system with Bash version release 4.1.2 
or later. 
2. Fastp (https://github.com/OpenGene/fastp). 
3. Bowtie2 (http://bowtie-bio.sourceforge.net/bowtie2). 
4. SPAdes (https://github.com/ablab/spades). 
5. VirSorter2 (https://github.com/jiarong/VirSorter2). 
6. CheckV (https://bitbucket.org/berkeleylab/checkv). 
7. CD-HIT (https://sites.google.com/view/cd-hit/download). 
8. Pharokka (https://github.com/gbouras13/pharokka). 
While not mandatory, installing Conda and each software as a 
Conda package or in a dedicated Conda environment is highly 
recommended, whenever possible for the user (https://conda.io/ 
projects/conda/en/latest/user-guide/install/index.html). 
3 
Methods 
3.1 
Sample 
Collection and Storage 
1. Collect samples as fresh as possible into 15 mL tubes on ice. 
The necessary quantity can vary depending on the origin of 
the sample, but a minimum of 100 mg (see Note 1) usually 
ensures 
sufﬁcient 
DNA 
concentration 
for 
downstream 
sequencing. Higher quantities (up to 1 g) will usually yield 
higher DNA concentrations. 
2. Keep samples at 4 °C (ice) after recovery. Keep at 4 °C i  
processing the same day or store directly at -80 °C if proces-
sing later (see Note 2). 
3. To verify the quantity of starting material, weigh the fecal 
sample (see Note 3). 
3.2 
Filtration of the 
Supernatant 
1. Homogenize the fecal sample in 14 mL of 10 mM Tris-HCl 
buffer pH 7.5 by shaking and vortexing. We recommend add-
ing the Tris-HCl buffer and letting it sit for 15 min to facilitate 
resuspension and homogenization. Using sterilized 1 mL cut 
pipet tips will also facilitate homogenization. Make sure no 
large clump remains. 
2. Centrifuge the homogenate for 10 min at 5200 g, 4 °C. 
3. Filter the supernatant with a syringe through a 0.45 μm diam-
eter ﬁlter (see Note 4). 
3.3 
Concentration of 
Viral Particles 
1. Pour the ﬁltrate to completely ﬁll a 13.2 mL UltraClear Tube 
9/16 × 3–1/2″. 
If necessary, complete with sterile water to completely ﬁll 
the tubes.

Identiﬁcation of DNA Bacteriophages from Fecal Samples
139
2. Balance the tubes carefully and load them in an SW41 Ti rotor. 
3. Ultracentrifuge at 270,000 g for 3 h, 16 °C, and discard the 
supernatant rapidly (see Note 5). Other centrifugation options 
are discussed in (see Note 6). 
4. Resuspend the viral pellet by adding 483 μL of TN buffer in the 
ultracentrifuge tube and wait for 30 min. 
5. Pipet to ﬁnish resuspending and transfer into a 1.5 mL tube. 
3.4 
DNAse Treatment
1. Add 2 μL DNAse I (4 U), 55 μL of 10X DNAse buffer, and 
10 μL of RNAse (20 μg RNase A and 50 U RNase T1) (see 
Note 7). 
2. Incubate in a dry bath for 30 min at 37 °C. 
3. Inactivate DNAse by adding 17 μL of 0.5 M EDTA (15 mM 
ﬁnal). 
4. Incubate in a dry bath for 10 min at 75 °C. 
3.5 
Protease 
Treatment 
1. Add 3 μL 20 mg/mL proteinase K (100 μg/mL ﬁnal) and 
29 μL 10% SDS (0.5% ﬁnal). 
2. Incubate in a dry bath for 30 min at 55 °C. 
3.6 
DNA Extraction
1. Add 
600 
μL 
(1 
volume) 
of 
25:24:1 
vol/vol 
phenol– 
chloroform–isoamyl alcohol (see Note 8). Vortex for 30 s. 
2. Centrifuge for 5 min at 16,000 g. 
3. Carefully transfer the supernatant (aqueous phase) in a new 
1.5 mL tube. 
4. Repeat steps 1–3. 
5. Add 600 μL (1 volume) of 24:1 vol/vol chloroform–isoamyl 
alcohol. Vortex for 30 s. 
6. Centrifuge for 5 min at 16,000 g. 
7. Carefully extract the aqueous phase (phase at the top) in a new 
1.5 mL tube (you should collect ~500 μL). 
3.7 
DNA 
Precipitation 
1. Add 50 μL 3 M sodium acetate pH 4.8 (300 mM ﬁnal), 1 μL 
glycogen (see Note 9), and 1 mL (2 volumes) -20 °C ethanol. 
2. Mix by inversion and incubate >30 min at -80 °C (see 
Note 10). 
3. Centrifuge for 20 min at 15,000 g, 4 °C. 
4. Discard supernatant and air dry the pellet (5–20 min). Be 
careful not to overdry the pellet. 
5. Resuspend the pellet in 40 μL 10 mM Tris-HCl pH 7.5. 
6. Quantify the DNA with Qubit dsDNA HS kit. Around 1 ng/μ
L for 100 mg of feces is expected. Checking the 280/260 and 
260/230 ratios is also recommended (see Note 11).

140
Quentin Lamy-Besnier and Julian R. Garneau
3.8 
Library 
Preparation 
1. Prepare (or outsource) libraries using the xGen™ ssDNA & 
Low-Input DNA Library Prep Kit (see Note 12), following the 
manufacturer’s instructions. Alternatives are discussed in Note 
13. We generally aim to perform the minimum number of PCR 
cycles in the process of library preparation, as more PCR cycles 
can result in additional biases and make the quantitative analy-
sis of downstream data less reliable. 
3.9 
Sequencing
1. Sequence the libraries using any Illumina sequencer. We rec-
ommend paired-end sequencing, with 150 nucleotide-long 
reads. A minimum of 10 million reads per sample is recom-
mended (see Note 14). 
3.10 
Read Quality 
Control 
1. Use Fastp [21] to assess the number and quality of reads, while 
simultaneously deduplicating (--dup_calc_accuracy 6) and 
cleaning them. If using the xGen™ ssDNA & Low-Input 
DNA Library Prep Kit, remove the adaptase tail at this step: 
$ fastp -i forward_reads.fastq.gz -I reverse_reads.fastq.gz -o 
forward_reads_fastp.fastq.gz -O reverse_reads_fastp.fastq.gz --
dup_calc_accuracy 6 -t 20 -F 20 
2. Verify the fastp report and adjust the parameters if necessary. 
3.11 
Reads 
Decontamination 
(Exclusion of Host-
Associated Reads) 
1. Use Bowtie2 [22] to map the reads on the human (e.g., homo 
sapiens genome assembly GRCh38.p14) or mice (Mus muscu-
lus genome assembly GRCm38) host reference genome, and 
extract the reads that do not map (--un-conc-gz option). 
$ bowtie2-build reference_genome.fasta reference_genome 
$ bowtie2 --very-sensitive-local -x reference_genome --un-
conc-gz non_host_reads_R%.fastq.gz -1 forward_reads_fastp. 
fastq.gz -2 reverse_reads_fastp.fastq.gz -S output.sam 2> map-
ping_stats.txt 
2. Forward reads are named “non_host_reads_R1.fastq.gz” and 
reverse reads “non_host_reads_R2.fastq.gz.” 
Check the number of reads remaining (nonhost reads) as 
well as the percentage of contamination (host reads) inside the 
“mapping_stats.txt” ﬁle. 
3.12 
Assembly of 
Contigs Using Cleaned 
Reads 
1. Use metagenomic SPAdes [23] with the ﬁltered nonhost reads 
to perform an assembly. Example command: 
$ spades.py --only-assembler --meta -1 non_host_reads_R1. 
fastq.gz -2 non_host_reads_R2.fastq.gz -o metaspades_output 
(see Note 15). 
3.13 
Filtering 
(Selection of Phage 
Contigs) 
1. Use VirSorter2 [24] to check the viral nature of the assembled 
contigs. 
Example command to keep only the contigs for which the 
VirSorter2 score is >0.3

Identiﬁcation of DNA Bacteriophages from Fecal Samples
141
$ virsorter run -w virsorter.out -i contigs.fasta --min-length 
2400 all 
2. Use CheckV[25] to further check the viral nature of the assem-
bled contigs. 
$ checkv end_to_end virsorter_contigs.fasta output_directory 
3. Example command to keep only contigs declared as “high-
conﬁdence" by CheckV (see Note 16) 
$ awk ’NR > 1 && ($6 == "high") {print $1}’ complete-
ness.tsv > checkv_contigs.txt 
$ grep -A1 -f checkv_contigs.txt viruses.fna | grep -v -- "--" > 
checkv_contigs.fasta 
3.14 
Clustering 
(Dereplication) of 
Phage Contigs 
1. Use CD-HIT [26] to cluster the viral contigs at 95% identity 
and 90% coverage (viral species criterion). Example command: 
$ cd-hit-est -i checkv_contigs.fasta -o clustered_contigs.fasta
-c 0.95 -aS 0.9 -g 1 -G 0 
3.15 
Protein 
Annotation of Phage 
Contigs 
1. Use Pharokka [27] to perform the annotation of the retained 
viral contigs. Example command: 
$ pharokka.py -g prodigal -m -i clustered_contigs.fasta -o 
output_folder -d path/to/database_dir -p preﬁx 
2. Finally, use ViPTree [28] (https://www.genome.jp/viptree/) 
to classify and ﬁnd closest homologs to each phage contigs (see 
Note 17). 
4 
Notes 
1. 100 mg is equivalent to around 2 fecal pellets for mice. 
2. It has been shown that fresh samples and samples stored at -
80 °C lead to comparable results [20]. Avoid thaw/freezing 
cycles as this can degrade viral particles, resulting in less DNA 
after extraction. 
3. Note that weighing “wet” samples as suggested here might 
lead to differences in DNA yields even for comparable wet 
weights. 
4. The remaining pellet can be used for sequencing the cellular 
fraction of the same sample. 
5. If possible, let the centrifuge run for >3 h and stop manually at 
3 h to make sure to waste as little time as possible between the 
end of the run and the following step (a fraction of the viral 
particles could be lost as they tend to resuspend quickly after 
the centrifuge stops). 
6. See http://www.sciencegateway.org/tools/rotor.htm to adapt 
RPM to achieve 270,000 g. If no ultracentrifuge is available, a

142
Quentin Lamy-Besnier and Julian R. Garneau
centrifugation in a benchtop centrifuge in 1.5 mL tubes at 
20,000 g for 16 h, 4 °C is possible. In this case, you need to 
adapt the volume for resuspending the sample to ﬁt in the 
1.5 mL tube. Note that working with lower volumes will lead 
to lower DNA yields. 
7. Although the suggested DNAse usually works with fecal sam-
ples, setting up a control to verify the activity of the DNAse in 
the sample is recommended. For example, a plasmid can be 
spiked in the sample right before the DNAse step, and this 
control can then be run on an agarose gel to conﬁrm full DNA 
degradation. 
8. To facilitate this step, it is possible to use special tubes such as 
phase lock gel tubes (https://us.vwr.com/store/product/1 
7942399/phase-lock-geltm-quantabio). 
9. Glycogen is optional. It is a carrier that facilitates DNA precipi-
tation and the visualization of the pellet after centrifugation. 
10. The incubation time is ﬂexible: While 30 min is a minimum, 
1–2 hours is recommended. It is also possible to leave the 
samples overnight at -80 °C until the next step. 
11. Expected 
ratio 
for DNA: 
260/280 
= 
about 
1,8 
and 
260/230 = about 2,0. If the DNA concentration is low or 
too high, these ratios might be off using the NanoDrop. 
However, in most cases, sequencing is still possible. Measure-
ment of DNA concentration (especially if low) is often unreli-
able with NanoDrop and should be conﬁrmed with a 
ﬂuorometer (Qubit™) or similar input DNA quantiﬁcation 
instrument. 
12. This kit was previously named “Accel-NGS 1S Plus DNA 
Library kit.” 
13. The xGen™ ssDNA & Low-Input DNA Library Prep kit 
allows the sequencing of both ssDNA and dsDNA and works 
well with our typically low DNA concentrations. If this kit is 
unavailable, we recommend using kits such as TruSeq Nano 
DNA Low Throughput Library Prep Kit™ from Illumina 
(note that ssDNA will not be recovered, unless a speciﬁc pre-
treatment is executed [29] (refer to the “T7pol pretreatment” 
section of the Methods for the speciﬁc procedure). Even if 
DNA library preparation kits using a tagmentation approach 
(e.g., Nextera) can be more cost-effective, we usually do not 
recommend using such kits for phage and virome sequencing, 
as genome ends (termini) can be lost because of a speciﬁc 
sequencing bias arising from tagmentation approaches [30] 
that impede the use of the PhageTerm and PhageTermVirome 
software for termini detection and the characterization of pack-
aging mechanisms [30, 31].

Acknowledgments
We are grateful to Marie-Agne`s Petit, Thania Sbaghdi, and Youz-
Ref
1.
from pig fecal samples reveals that phages and
2. Bouras G, Nepal R, Houtak G et al (2022)
3. Camarillo-Guerrero LF, Almeida A, Rangel-
4.
an ultra-fast all-in-one FASTQ preprocessor.
5.
Identiﬁcation of DNA Bacteriophages from Fecal Samples
143
14. The number of reads required depends on the complexity of 
the sample (e.g., less reads are needed for simpliﬁed microbiota 
or virome such as in gnotobiotic mice). For the read length, 
the rule of thumb is as follows: The longer, the better, as it 
usually improves the quality of the assembly. 
15. This step can be considerably faster, if multiple threads are used 
(option -t). 
16. This step can be adjusted to be more or less stringent (e.g., to 
also accept “medium conﬁdence” contigs). Typically, virome 
sequences from understudied environments can contain several 
novel phage contigs having very low homology with phage 
contigs or phage proteins included in reference databases. 
This can greatly reduce the number of “high-conﬁdence” con-
tigs and raise the number of “medium-conﬁdence” and “low-
conﬁdence” contigs after the CheckV analysis. In such situa-
tions, users can ﬁlter the phage contigs using a lower conﬁ-
dence threshold to explore these more challenging datasets. 
Example of sequential commands that would include both 
“high-conﬁdence” contigs and “medium-conﬁdence” contigs 
(using the information located in the sixth column of the 
completeness.tsv ﬁle from CheckV output): 
$ awk ’NR > 1 && ($6 == “high”) {print $1}’ complete-
ness.tsv > checkv_contigs.txt 
$ awk ’NR > 1 && ($6 == “medium”) {print $1}’ 
completeness.tsv >> checkv_contigs.txt 
$ grep -A1 -f checkv_contigs.txt viruses.fna | grep -v -- “--” > 
checkv_contigs.fasta 
17. If you have a large number of contigs, instead of using the web 
server, you can install ViPTreeGen locally to generate the trees 
(https://github.com/yosuken/ViPTreeGen). 
heng Teo for critical reading and review of the manuscript. 
erences 
Billaud M, Lamy-Besnier Q, Lossouarn J et al 
(2021) Analysis of viromes and microbiomes 
prophages rarely carry antibiotic resistance 
genes. ISME Commun 1:1–10 
Pharokka: a fast scalable bacteriophage annota-
tion tool. Bioinformatics 39:btac776 
Pineros G et al (2021) Massive expansion of 
human gut bacteriophage diversity. Cell 184: 
1098–1109.e9 
Chen S, Zhou Y, Chen Y, Gu J (2018) Fastp: 
Bioinformatics 34:i884–i890 
Garneau JR, Depardieu F, Fortier L-C et al 
(2017) PhageTerm: a tool for fast and accurate

6.
7.
(
8.
9.
10.
11.
12.
13.
14.
15.
16.
17.
19.
20.
21.
22.
23.
24.
25.
26.
27.
28.
29.
30.
diseases. Proc Natl Acad Sci U S A 118:
e2023202118
144
Quentin Lamy-Besnier and Julian R. Garneau
determination of phage termini and packaging 
mechanism using next-generation sequencing 
data. Sci Rep 7:8292 
Garneau JR, Legrand V, Marbouty M et al 
(2021) 
High-throughput 
identiﬁcation 
of 
viral termini and packaging mechanisms in vir-
ome datasets using PhageTermVirome. Sci Rep 
11:18319 
Glassner KL, Abraham BP, Quigley EMM 
2020) The microbiome and inﬂammatory 
bowel disease. J Allergy Clin Immunol 145: 
16–27 
Gregory AC, Zablocki O, Zayed AA et al 
(2020) 
The 
gut 
Virome 
database 
reveals 
age-dependent patterns of virome diversity in 
the human gut. Cell Host Microbe 28:724– 
740.e8 
Guo J, Bolduc B, Zayed AA et al (2021) Vir-
Sorter2: 
a 
multi-classiﬁer, 
expert-guided 
approach to detect diverse DNA and RNA 
viruses. Microbiome 9:37 
Han J-L, Lin H-L (2014) Intestinal microbiota 
and type 2 diabetes: from mechanism insights 
to therapeutic perspective. World J Gastroen-
terol 20:17737–17745 
Jain T, Sharma P, Are AC et al (2021) New 
insights
into
the
cancer-microbiome-
immune axis: decrypting a decade of discov-
eries. Front Immunol 12:622064 
Khan Mirzaei M, Khan MAA, Ghosh P et al 
(2020) Bacteriophages isolated from stunted 
children can regulate gut bacterial commu-
nities in an age-speciﬁc manner. Cell Host 
Microbe 27:199–212.e5 
Lamy-Besnier Q, Bignaud A, Garneau JR, et al 
(2023) Chromosome folding and prophage 
activation reveal speciﬁc genomic architecture 
for intestinal bacteria. Microbiome 11:111 
Langmead B, Salzberg SL (2012) Fast gapped-
read alignment with Bowtie 2. Nat Methods 9: 
357–359 
Li W, Godzik A (2006) Cd-hit: a fast program 
for clustering and comparing large sets of pro-
tein or nucleotide sequences. Bioinformatics 
22:1658–1659 
Lim ES, Zhou Y, Zhao G et al (2015) Early life 
dynamics of the human gut virome and bacte-
rial microbiome in infants. Nat Med 21:1228– 
1234 
Liu B-N, Liu X-T, Liang Z-H, Wang J-H 
(2021) Gut microbiota in obesity. World J Gas-
troenterol 27:3837–3850 
18. Morais LH, Schreiber HL, Mazmanian SK 
(2021) The gut microbiota-brain axis in beha-
viour and brain disorders. Nat Rev Microbiol 
19:241–255 
Nakatsu G, Zhou H, Wu WKK et al (2018) 
Alterations in enteric virome are associated 
with colorectal cancer and survival outcomes. 
Gastroenterology 155:529–541.e5 
Nayfach S, Pa´ez-Espino D, Call L et al (2021) 
Metagenomic compendium of 189,680 DNA 
viruses from the human gut microbiome. Nat 
Microbiol 6:960–970 
Nishimura Y, Yoshida T, Kuronishi M et al 
(2017) ViPTree: the viral proteomic tree 
server. Bioinformatics 33:2379–2380 
Norman JM, Handley SA, Baldridge MT et al 
(2015) 
Disease-speciﬁc 
alterations 
in 
the 
enteric virome in inﬂammatory bowel disease. 
Cell 160:447–460 
Nurk S, Meleshko D, Korobeynikov A, Pevz-
ner PA (2017) metaSPAdes: a new versatile 
metagenomic assembler. Genome Res 27: 
824–834 
Patterson E, Ryan PM, Cryan JF et al (2016) 
Gut microbiota, obesity and diabetes. Postgrad 
Med J 92:286–300 
Nayfach S, Camargo AP, Schulz F et al (2021) 
CheckV assesses the quality and completeness 
of metagenome-assembled viral genomes. Nat 
Biotechnol 39(5):578–585 
Schaubeck M, Clavel T, Calasan J et al (2016) 
Dysbiotic gut microbiota causes transmissible 
Crohn’s disease-like ileitis independent of fail-
ure in antimicrobial defence. Gut 65:225–237 
Sepich-Poore GD, Zitvogel L, Straussman R 
et al (2021) The microbiome and human can-
cer. Science 371:eabc4552 
Shah SA, Deng L, Thorsen J, et al (2021) 
Hundreds of viral families in the healthy infant 
gut bioRxiv 2021.07.02.450849 
Shkoporov AN, Ryan FJ, Draper LA et al 
(2018) Reproducible protocols for metage-
nomic analysis of human faecal phageomes. 
Microbiome 6:68 
Tisza MJ, Buck CB (2021) A catalog of tens of 
thousands of viruses from human metagen-
omes reveals hidden associations with chronic

Chapter 10 
Exploration and Retrieval of Virus-Related Molecular Data 
Using ExTaxsI: The Monkeypox Use Case 
Alberto Brusati, Giulia Agostinetto, Antonia Bruno, Maurizio Casiraghi, 
Dario Pescini, Anna Sandionigi, and Bachir Balech 
Abstract 
Retrieval and visualization of biological data are essential for understanding complex systems. With the 
increasing volume of data generated from high-throughput sequencing technologies, effective and opti-
mized data visualization tools have become indispensable. This is particularly relevant in the COVID-19 
postpandemic period, where understanding the diversity and interactions of microbial communities (i.e., 
viral and bacterial) constitutes an important asset to develop and plan suitable interventions. 
In this chapter, we show the usage and the potentials of ExTaxsI (Exploring Taxonomy Information) tool 
to retrieve viral biodiversity data stored in National Center for Biotechnology Information (NCBI) 
databases and create the related visualization. In addition, by integrating different functions and modules, 
the tool generates relevant types of visualization plots to facilitate the exploration of microbial biodiversity 
communities useful to deep dive into ecological and taxonomic relationships among different species and 
identify potential signiﬁcant targets. 
Using the Monkeypox virus as a case study, this work points out signiﬁcant perspectives on biological data 
visualization, which can be used to gain insights into the ecology, evolution, and pathogenesis of viruses. 
Accordingly, we show the potentiality of ExTaxsI to organize and describe the available/downloaded data 
in an easy, simple, and interpretable way allowing the user to interact dynamically with the visualization 
plots through speciﬁc ﬁlters, zoom, and explore functions. 
Key words Viral biodiversity, Data visualization, Molecular data, Database, Data integration, 
Taxonomy 
1 
Introduction 
Large-scale studies of molecular biodiversity and genomics have 
recently begun to populate biological databases with a considerable 
amount of data. Particularly, the availability of genomics and meta-
genomics data (i.e., DNA metabarcoding) has grown exponentially, 
mainly with the advent of High Throughput Sequencing (HTS) 
technologies. In many areas of research, from macro-ecology and 
ecosystem monitoring to food safety control, forensics applications,
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_10, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
145

and microbiome identiﬁcation [1–3], it is now possible to increase 
our knowledge and strengthen our scientiﬁc investigation capacity 
as a result of this large amount of new information [1]. To increase 
the usefulness and reusability of such data, various research teams 
have highlighted the importance of accessing the vast amount of 
data deposited in biological and molecular databases [4–6]. Build-
ing experimental designs that take into account all of such data 
would therefore improve the effectiveness of these investigations 
and produce more reliable results [7, 8]. As the amount of 
biological data in public repositories continues to increase, the 
need for effective visualization tools has become more and more 
apparent. However, the sheer volume and complexity of biological 
data present a concrete difﬁculty for researchers to identify embed-
ded patterns and relationships that might be important to under-
stand biological processes. Visualization tools can help to address 
this problem by providing a way to represent complex data in a 
more intuitive and accessible way. Data accessibility of preexisting 
data stored in online databases (e.g., European Nucleotide 
Archive—ENA [www.ebi.ac.uk/ena] and National Center for Bio-
technology Information—NCBI [https://www.ncbi.nlm.nih.gov/ 
]) is strongly linked to the interpretation of results derived from 
genomic/metagenomic experiments. In this situation, a simple 
data retrieval and visualization routine provides an efﬁcient strategy 
for both guiding cutting-edge scientiﬁc inquiries as well as 
gathering and exposing the study ﬁndings [9]. Currently, only a 
few molecular markers have speciﬁc curated and regularly updated 
reference databases, such as SILVA for 16S and 18S rRNA genes 
[10], BOLD for animals and plants [11], or UNITE for the fungi 
domain [12], where molecular and taxonomic data can be openly 
and easily explored. On the other hand, although NCBI continues 
to collect the majority of genetic data and their associated metadata 
that are currently available [13–15], the access to such data in an 
aggregated and descriptive way is not always straightforward with-
out 
specialized 
bioinformatics 
and 
information 
technology 
(IT) skills. In this chapter, we present the usage and potentials of 
the ExTaxsI (Exploring Taxonomy Information [16]) tool devel-
oped to assist users in biological data exploration and exploitation 
throughout their experimental design establishment. The tool has 
the main characteristic to associate molecular data and metadata 
with their related taxonomy, retrieved from various data sources 
available either remotely or locally.
146
Alberto Brusati et al.
Through the connection with the NCBI taxonomy database 
[17] and the ETE toolkit [18], ExTaxsI employs a retrieval routine 
from NCBI databases (i.e., nucleotide and taxonomy) to readily 
explore taxonomic and molecular data and to provide structured 
data sets in standard formats suitable for DNA-based analysis meth-
ods [19–24] (i.e., taxonomy assignment, phylogeny inference, and 
gene annotation) in a genomic or metagenomic study framework

(e.g., QIIME2 [19]). Additionally, ExTaxsI offers the possibility to 
rearrange either local or retrieved data sets related to any molecular 
marker, gene name, or taxonomic group, making this tool viable to 
build a nonstandard marker genes database useful for metage-
nomic/metabarcoding taxonomic assignment methods. 
Viral Molecular Data Discovery with ExTaxsI
147
In summary, ExTaxsI boasts the uniqueness of being able to 
promptly represent, in a methodical and visually appealing way 
through an HTML graphical interface, the aggregated statistics of 
molecular data, as well as the corresponding taxonomy and geo-
graphical origin, allowing for a dynamic data exploration of viral 
biodiversity. If you decide to use ExTaxsI, please cite also the 
original paper entitled “ExTaxsI: an exploration tool of biodiversity 
molecular data” [16]. 
2 
Materials 
A detailed install procedure of ExTaxsI, including hardware and 
software requirements, is provided in the following subsections. All 
the elements needed to successfully use the tool as a standalone 
version or as a built-in library are also speciﬁed. This information is 
also available on the ExTaxsI project development GitHub page, 
where it is possible to have the latest edits and bug ﬁxes. 
2.1 
Requirements
ExTaxsI is a platform-independent tool. It has been installed and 
tested on the three main operating systems: Windows, mac-OS X, 
and Linux (see Note 1). To successfully run the tool, the following 
Python libraries must be installed: Biopython [25], NumPy [26], 
SciPy [27], Matplotlib [28], ipython [29], Pandas [30], SymPy 
(https://www.sympy.org/en/index.html), nose (https://nose. 
readthedocs.io/en/latest/), genutils (https://pypi.org/project/ 
genutils/), requests [31], Plotly (https://plotly.com/), Plotly-Orca, 
and ETE toolkit [18]. All the dependency-compatible versions are 
provided as a requirement list on the GitHub page (https://github. 
com/qLSLab/ExTaxsI), with a detailed guideline to directly set up 
a 
conda 
(https://docs.conda.io/projects/conda/en/stable/) 
environment. 
2.2 
Python Library
ExTaxsI can also be used as a separate python library with the 
advantage to be incorporated into a speciﬁc bioinformatic pipeline 
according to the user’s needs (see Notes 2 and 3). The Python 
library of ExTaxsI is available both on the Github development 
page (https://github.com/qLSLab/ExTaxsI/tree/master/ 
library) and in the PyPI repository (https://pypi.org/project/ 
ExTaxsI/) under the open-source license GNU GPL version 3.

148
Alberto Brusati et al.
2.3 
Software 
Availability 
Snapshots of the python code and the related data supporting this 
work are openly available in the GigaScience repository, GigaDB 
[32]. In addition, the GitHub repository (https://github.com/ 
qLSLab/ExTaxsI) supplies all the operating instructions, tutorials, 
and examples, including the data of the case study presented here, 
to run the tool in standalone or python library mode correctly. 
2.4 
Data Availability
All the data related to this case study are available on the ExTaxsI 
github page (https://github.com/qLSLab/ExTaxsI/tree/mas 
ter/ChapterViralMetagenomics/monkeypox). 
3 
Methods 
3.1 
The Monkeypox 
Virus Case Study 
Monkeypox virus (MPV) is a double-stranded DNA virus belong-
ing to the orthopoxvirus genus of the Poxviridae family, the same 
family as smallpox (Variola) and cowpox viruses [33]. It was ﬁrst 
discovered in 1958 in Denmark (Copenhagen), where it was initi-
ally isolated from monkeys [34]. The ﬁrst case of animal-to-human 
zoonotic transmission occurred in 1970 in the Democratic Repub-
lic of Congo (DRC) in a nine-month-old child [35]. Since then, the 
outbreaks have been mainly contained in the African continent. In 
May 2022, new infections were reported from many parts of the 
world, including Europe, Australia, and the American continent 
[36]. This has raised serious warnings at the international level, 
mainly after the concerns provoked by the viral pandemics caused 
by SARS-CoV-2. 
In this context, we used ExTaxsI to retrieve the genetic, molec-
ular, 
and 
taxonomic 
data 
related 
to 
virus 
MPV and 
the 
corresponding orthopoxvirus genus, using as queries “txid10242 
[ORGN]” and “txid10244[ORGN]” for the orthopoxvirus genus 
and MPV, respectively. At the collection date (March 2023), we 
retrieved 9577 unique records from “txid10242[ORGN]” query 
and 5143 for “txid10244[ORGN].” 
The software was executed through its user-friendly command 
line interface (refer to Fig. 1), which comes with a comprehensive 
documentation for each script (see Notes 4 and 5). This eliminates 
the need for customized Python code (see Notes 2 and 3). In 
general, ExTaxsI comprises three distinct modules, which may be 
utilized either sequentially as a workﬂow or independently, depend-
ing on the user’s speciﬁc requirements. The main modules are 
outlined as follows: (1) database creation, (2) visualization, and 
(3) taxonomy IDs converter. All six python library functions offer 
identical functionalities.

Viral Molecular Data Discovery with ExTaxsI
149
Fig. 1 ExTaxsI user-friendly command line interface 
3.2 
The Database 
Creation 
The module “Database“allows the user to create multi-FASTA ﬁles 
composed of nucleotide sequences, together with taxonomic and 
gene names lists with their related accessions, starting from either a 
single or a batch query mode using CSV/TSV input ﬁles (see Notes 
6 and 7). After selecting the input format, it is possible to integrate 
the query with one or more gene names (see Note 6). The default 
output ﬁles of this module are (1) a multi-FASTA ﬁle (widely used 
format for molecular sequences) and (2) a text ﬁle in TSV format 
with two columns, composed of the accessions code followed by 
their corresponding taxonomy path at the six main levels separated 
by semicolons: Phylum, class, order, family, genus, and species. On 
user’s request (available in the interface), it is also possible to 
produce an additional output ﬁle of gene names in TSV format. 
This consists of a table with two columns, the ﬁrst composed of a 
list of genes, and the second, the frequency values of the respective 
genes found in the retrieved records. The tool also provides a 
summary table containing the most popular genes from a list of 
NCBI txids (taxon unique identiﬁers), accessions, or organisms. In 
addition, it is possible to create a bar plot with the top 10 (most 
frequent genes) of the summary table, downloadable as a graph in 
PNG format.

150
Alberto Brusati et al.
In our case, according to the gene-based frequency analysis, the 
virion core protein P4aOPG gene family (OPG) appeared as the 
most investigated of MPV in more than ~3000 occurrences out of 
5143 retrieved records. These ﬁndings are consistent with the 
literature where the OPG genes are mainly studied due to their 
crucial function in virion replication and viral structural compo-
nents, such as DNA or RNA polymerase subunits [37]. 
3.3 
Visualize 
Information 
The “Visualization” module allows users to create interactive plots 
as results summaries (see Note 8). This can be done using the 
output from the “Database“module or by importing external 
sources such as local ﬁles with taxonomic path lists. When produc-
ing plots, the user is prompted to select a ﬁltering value based on 
taxon frequency. If the selected ﬁlter value is 0, all retrieved data are 
processed. However, if the minimum chosen value is not reached, 
all taxonomic units are included in an additional text ﬁle with a 
name that includes the ﬁlter used. 
ExTaxsI offers three types of plots: Scatter plot (Fig. 2), sun-
burst plot, and world map plot (Fig. 3). These plots can be down-
loaded as HTML ﬁles and viewed in a web browser. 
3.3.1 
Taxonomical and 
Molecular Plot: Scatter 
Plots and Sunburst 
The scatter plot utilizes taxonomy as input to create a graph 
showing the quantity of each taxonomic unit. Being interactive, 
the plot allows the user to select the taxonomic level to display and 
to hover over data points to show speciﬁc details such as the 
number of records within taxa, names of selected taxa, and the 
name of the parent taxon (Fig. 2). 
The scatter plot also offers additional features that allow users 
to compare more data by highlighting an area of interest with the 
zoom function, viewing speciﬁc groups, or removing speciﬁc taxa 
from the graph. 
Fig. 2 Scatter plot of orthopoxvirus genus accessions representing sequence abundances among species

Viral Molecular Data Discovery with ExTaxsI
151
Fig. 3 Geographical distribution of MPV sequences obtained from ExTaxsI 
In contrast, the sunburst plot starts with taxonomy input. It 
creates an expansion pie that enables the user to explore taxonomy 
by clicking on the group of interest and showing its underlying taxa 
within a nested sunburst plot. Hovering over points in this plot 
displays the number of records within each taxon. 
The graphical output generated by the queries on MPV and 
orthopoxvirus genus demonstrates the full potential of this tool, not 
just in identifying the target species but also in accurately placing its 
information within a broader taxonomic category. By utilizing this 
approach, we can showcase how the tool provides a comprehensive 
view of the target species, representing it within the larger context of a 
macro taxa category. This added level of insight is crucial to under-
stand the ecological and evolutionary implications of the target taxa. 
3.3.2 
Geographical Plot: 
The World Map of 
Monkeypox Virus 
To create the world map plot, ExTaxsI processes the initial input to 
extract geographic data. It uses the “Country” metadata stored in 
the NCBI records to indicate the geographical location of each 
entry on the map. Based on the geographic data type obtained, 
ExTaxsI divides the results into two different arrays: (1) A speciﬁc 
array of coordinates (if the numerical coordinates are present in the 
record) or (2) a speciﬁc array of country names (if the coordinates 
are absent). In each created map, the coordinates are marked by 
green crosses, while red circles mark countries. In our case study, 
the geographical information related to the “country” tag was 
found for 4959 accessions related to the MPV, while the coordi-
nates were available for only 847 records. As shown in Fig. 3, this 
analysis has revealed a worldwide distribution of the virus with an 
overrepresentation in African and European countries. However, 
the USA appeared also among the major contributors with 2646 
entries. When plotting multiple taxa, each symbol can have a legend 
summarizing the data downloaded with the same country name or 
coordinate description. Additionally, users can view both genes and 
accession counts available among the represented accessions.

152
Alberto Brusati et al.
3.4 
Taxonomy ID 
Converter 
Using this module, it is possible to transform NCBI taxids into the 
six principal levels of taxonomy, namely, Phylum, Class, Order, 
Family, Genus, and Species (see Note 5). More speciﬁcally, the 
resulting taxonomic classiﬁcation of the virus, from phylum to 
species, was as follows: “Nucleocytoviricota; Pokkesviricetes; Chito-
virales; Poxviridae; Orthopoxvirus; Monkeypox virus.” In general, 
the module enables the conversion of both single manual entries 
and multiple entries from a TSV/CSV ﬁle that contains a taxid list 
(see Notes 6 and 7). To be correctly interpreted by ExTaxsI, each 
taxid should be written on a separate line. The outputs of this 
module are in TSV ﬁle format, which can also be used as inputs 
for the visualization module to produce an interactive graphical 
results representation. 
4 
Notes 
1. No speciﬁc hardware requirements are needed for ExTaxsI 
installation. However, for its correct functioning and for the 
retrieval of big data sets, it is suggested the availability of at least 
4GB of RAM and a quad-core CPU. 
2. ExTaxsI can be included in standard or ad hoc bioinformatic 
workﬂows as a python built-in library. Python environment and 
library conﬁgurations can be set up using the requirements ﬁles 
available in the online repository (https://github.com/ 
qLSLab/ExTaxsI). 
3. If ExTaxsI is employed as a library in a personal script, it is 
mandatory to compile the load_conﬁgurations() function with 
the Entrez-email and API_KEY (see also Note 4) before using 
the subsequent functions (https://github.com/qLSLab/ 
ExTaxsI/blob/master/library/functions_installation_and_ 
tutorial.ipynb). 
4. Before running ExTaxsI it is suggested to compile the ﬁle 
“settings.ini” with the user email address registered beforehand 
on 
NCBI 
website 
(Entrez-email) 
and 
the 
generated 
corresponding API_KEY following the GitHub repository 
instructions. 
5. When ExTaxsI is executed for the ﬁrst time, the complete 
taxonomy database will be downloaded. In the subsequent 
analysis, the user can check the last update date and decide to 
perform a new upgrade. Therefore, it is important to take note 
of the database version number when starting a new research 
project. 
6. A query can be performed either in manual (single value) or ﬁle 
mode (batch or multiple queries). The manual query might be 
a scientiﬁc name txid (taxon unique identiﬁer according to 
NCBI taxonomy reference database) or might be composed

Viral Molecular Data Discovery with ExTaxsI
153
following the Entrez conventions including the boolean alge-
bra operators (AND, OR, and NOT). For example, in the case 
study above, the Monkeypox virus was searched using the 
query “txid10244[ORGN],” where 10244 is the speciﬁc txid 
of the virus. Another example of a query could be: “txid10244 
[ORGN] AND OPG136[GENE],” where “OPG136” is the 
symbol of the “Virion core protein P4a” gene name. This 
restricts the analysis only to the entries having speciﬁcally the 
“OPG136” gene information. 
7. In batch query mode, when organism names lists, Ids, or 
accessions are less than 2500, the search key is composed of a 
single query; otherwise, the search will be split into groups of 
2500 generating temporary ﬁles, which will be deleted at the 
end of the process. The results of the queries will be joined 
automatically into a ﬁnal output. However, to speed up the 
download, we recommend splitting large ﬁles into smaller 
multiple ﬁles of queries. Alternatively, the ExTaxsI python 
library could be useful as it allows the user to iterate over 
every query ﬁle using the “db_creation” function. 
8. Users can generate graphical plots using their own local ﬁles 
containing taxonomy paths at the main six levels (phylum, 
class, order, family, genus, and species). Otherwise, starting 
from (1) a list of accessions, (2) a list of TaxIDs, or (3) a list 
of organisms names, the query ﬁles should be processed with 
the database creation module or with the taxonomy ID con-
verter module (only for TaxIDs list) to obtain the required 
taxonomy paths. The preferred ﬁle extension of these ﬁles is 
“.tsv,” with tab-separated columns, where each accession, 
taxid, or organism name should be written on a new line. 
References 
1. Porter TM, Hajibabaei M (2018) Scaling up: a 
guide to high-throughput genomic approaches 
for biodiversity analysis. Mol Ecol 27:313–338 
2. Ruppert KM, Kline RJ, Rahman MS (2019) 
Past, present, and future perspectives of envi-
ronmental DNA (eDNA) metabarcoding: a 
systematic review in methods, monitoring, 
and applications of global eDNA. Glob Ecol 
Conserv 17:e00547 
3. Deiner K, Bik HM, M€achler E et al (2017) 
Environmental DNA metabarcoding: trans-
forming how we survey animal and plant com-
munities. Mol Ecol 26:5872–5895 
4. Hampton SE, Jones MB, Wasser LA et al 
(2017) Skills and knowledge for data-intensive 
environmental research. Bioscience 67:546– 
557 
5. Michener WK, Jones MB (2012) Ecoinfor-
matics: supporting ecology as a data-intensive 
science. Trends Ecol Evol 27:85–93 
6. White EP, Baldridge E, Brym ZT et al (2013) 
Nine simple ways to make it easier to (re)use 
your data. Ideas in Ecology and Evolution 6: 
1–3 
7. Mitchell AL, Almeida A, Beracochea M et al 
(2020) 
MGnify: 
the 
microbiome 
analysis 
resource in 2020. Nucleic Acids Res 48: 
D570–D578 
8. Almeida A, Mitchell AL, Boland M et al (2019) 
A new genomic blueprint of the human gut 
microbiota. Nature 568:499–504 
9. Hardisty A, Roberts D (2013) Biodiversity 
informatics community. A decadal view of

154
Alberto Brusati et al.
biodiversity informatics: challenges and priori-
ties. BMC Ecol 13(1):16 
10. Pruesse E, Quast C, Knittel K et al (2007) 
SILVA: a comprehensive online resource for 
quality checked and aligned ribosomal RNA 
sequence data compatible with ARB. Nucleic 
Acids Res 35(21):7188–7196 
11. Ratnasingham S, Hebert PD (2007) BOLD: 
the barcode of life data system (http://www. 
barcodinglife.org). 
Mol 
Ecol 
Notes 
7(3): 
355–364 
12. Nilsson RH, Larsson KH, Taylor AFS et al 
(2019) The UNITE database for molecular 
identiﬁcation of fungi: handling dark taxa and 
parallel taxonomic classiﬁcations. Nucleic Acids 
Res 47(D1):D259–D264 
13. Keller A, Hohlfeld S, Kolter A et al (2020) 
BCdatabaser: on-the-ﬂy reference database cre-
ation for (meta-) barcoding. Bioinformatics 
36(8):2630–2631 
14. Ankenbrand MJ, Keller A, Wolf M et al (2015) 
ITS2 database V: twice as much. Mol Biol Evol 
32(11):3030–3032 
15. Benson D, Karsch-Mizrachi I, Lipman D et al 
(2008) GenBank. Nucleic Acids Res 1:33 
16. Agostinetto G, Brusati A, Sandionigi A, et al 
(2022) ExTaxsI: an exploration tool of biodi-
versity molecular data. GigaScience Jan 25;11 
17. Federhen S (2012) The NCBI taxonomy data-
base. Nucleic Acids Res 40(D1):D136–D143 
18. Huerta-Cepas J, Serra F, Bork P (2016) ETE 3: 
reconstruction, analysis, and visualization of 
phylogenomic data. Mol Biol Evol 33(6): 
1635–1638 
19. Bolyen E, Rideout JR, Dillon MR et al (2019) 
Reproducible, interactive, scalable and extensi-
ble microbiome data science using QIIME 
2. Nat Biotechnol 37(8):852–857 
20. Rognes T, Flouri T, Nichols B et al (2016) 
VSEARCH: a versatile open source tool for 
metagenomics. PeerJ 4:e2584 
21. Bengtsson-Palme J, Hartmann M, Eriksson 
KM et al (2015) METAXA2: improved identi-
ﬁcation and taxonomic classiﬁcation of small 
and large subunit rRNA in metagenomic data. 
Mol Ecol Resour 15(6):1403–1414 
22. Mahe´ F, Rognes T, Quince C et al (2015) 
Swarm v2: highly-scalable and high-resolution 
amplicon clustering. PeerJ 3:e1420 
23. Camacho C, Coulouris G, Avagyan V et al 
(2009) BLAST+: architecture and applications. 
BMC Bioinform 10(1):421 
24. Wang Q, Garrity GM, Tiedje JM et al (2007) 
Naive Bayesian classiﬁer for rapid assignment of 
rRNA sequences into the new bacterial taxon-
omy. 
Appl 
Environ 
Microbiol 
73(16): 
5261–5267 
25. Cock PJ, Antao T, Chang JT et al (2009) Bio-
python: 
freely 
available 
Python 
tools 
for 
computational molecular biology and bioinfor-
matics. Bioinformatics 25(11):1422–1423 
26. Harris CR, Millman KJ, van der Walt SJ et al 
(2020) 
Array 
programming 
with 
NumPy. 
Nature 585(7825):357–362 
27. Virtanen P, Gommers R, Oliphant TE et al 
(2020) SciPy 1.0: fundamental algorithms for 
scientiﬁc computing in Python. Nat Methods 
17(3):261–272 
28. Hunter JD (2007) Matplotlib: a 2D graphics 
environment. Comput Sci Eng 9(3):90–95 
29. Pe´rez F, Granger BE (2007) IPython: a system 
for interactive scientiﬁc computing. Comput 
Sci Eng. 9(3):21–29 
30. McKinney W (2011) Pandas: a foundational 
Python 
library 
for 
data 
analysis 
and 
statistics. In: Python for high performance 
and scientiﬁc computing, Seattle, pp 1–9 
31. Chandra RV, Varanasi BS (2015) Python 
requests essentials. Packt Publishing 
32. Agostinetto G, Brusati A, Sandionigi A, et al 
(2021) Supporting data for “ExTaxsI: an 
exploration 
tool 
of 
biodiversity 
molecular 
data”. GigaScience Database 
33. Jarosz D, Grudzin´ska A, Dudzin´ska P et al 
(2023) 
Monkeypox-new 
epidemiological 
threat? Review of the current literature. J 
Educ Health Sport 13(3):128–133 
34. Paniz-Mondolﬁ A, Guerra S, Mun˜oz M et al 
(2023) 
Evaluation 
and 
validation 
of 
an 
RT-PCR assay for speciﬁc detection of mon-
keypox virus (MPXV). J Med Virol 95(1): 
e28247 
35. Vaughan A, Aarons E, Astbury J et al (2018) 
Two cases of monkeypox imported to the 
United Kingdom. Eur Secur 23(38):1800509 
36. Kumar N, Acharya A, Gendelman HE et al 
(2022) The 2022 outbreak and the pathobiol-
ogy of the monkeypox virus. J Autoimmun 25: 
102855 
37. Senkevich TG, Yutin N, Wolf YI et al (2021) 
Ancient gene capture and recent gene loss 
shape the evolution of orthopoxvirus-host 
interaction 
genes. 
MBio 
12(4):e01495– 
e01421

Chapter 11 
Optimized Recovery of Viral DNA and RNA from Blood 
Plasma for Viral Metagenomics 
Marı´a Cebria´-Mendoza, Wladimiro Dı´az, Rafael Sanjua´n, 
and Jose´ M. Cuevas 
Abstract 
Metagenomics is vastly improving our ability to discover new viruses, as well as their possible associations 
with disease. However, metagenomics has also changed our understanding of viruses in general. This is 
because we can ﬁnd viruses in healthy hosts in the absence of disease, which changes the perspective of 
viruses as mere pathogens and offers a new perspective in which viruses function as important components 
of ecosystems. In concrete, human blood metagenomics has revealed the presence of different types of 
viruses in apparently healthy subjects. These viruses are human anelloviruses and, to a lower extent, human 
pegiviruses. Viral metagenomics’ major challenge is the correct isolation of the viral nucleic acids from a 
speciﬁc sample. For the protocol to be successful, all steps must be carefully chosen, in particular those that 
optimize the recovery of viral nucleic acids. Here, we present a procedure that allows the recovery of both 
DNA and RNA viruses from plasma samples. 
Key words High throughput sequencing, Blood virome, Viral metagenomics, Virus discovery, 
Emerging viruses 
1 
Introduction 
Viruses are ubiquitous in all natural environments and can be 
considered the largest source of nucleic acids on Earth, represent-
ing the largest source of biomass and genetic diversity on the planet 
[1]. Viruses are naturally integrated into ecosystems and interac-
tions between them and their hosts impact not only their own 
abundance, diversity, and evolution, but also that of their host 
populations and communities [2]. Viruses lack a universal marker, 
such as 16S ribosomal RNA genes in bacteria [3]. Therefore, there 
are multiple techniques for virus detection: Those based on virus 
culture in tissues, by ampliﬁcation and subsequent characterization, 
those based on serological methods [4] or those using molecular 
methods, such as PCR or microarrays. However, metagenomics has
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_11, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
155

led to the discovery of unprecedented viral diversity and revolutio-
nized the ﬁeld of virology. Metagenomics circumvents the limita-
tions presented by traditional methods of characterizing new 
viruses, due to targeting the total viral nucleic acids in the sample, 
so that no a priori knowledge of the viruses present in the sample is 
required [3, 5].
156
Marı´a Cebria´ -Mendoza et al.
The steps involved in the metagenomics analysis of the virome, 
which is the set of viruses present in a sample, have a clear impact on 
the detection of viral sequences, so the workﬂow must be appropri-
ate to the type of sample, origin, and volume [6]. The protocol for a 
metagenomics study typically includes sample collection, sample 
processing, extraction of the nucleic acids, sequencing, and bioin-
formatics analyses on the sequencing results. The choice of steps in 
the protocol for obtaining the virome from a sample will determine 
its success. Even so, these procedures can alter the composition of 
the virome because, at each step, there is a risk of biasing the 
information present. Therefore, it is necessary to implement certain 
practices to avoid these issues when analyzing metagenomics data. 
An example of this is the use of appropriate controls [7], i.e., 
negative controls (water or sterile medium that follows the entire 
workﬂow) to be able to detect sporadic contaminants [8] and even 
certain positive controls, such as the addition of a known amount of 
different control viruses that present different structural and geno-
mic characteristics to determine the reliability of the protocol [9]. 
The human virome is deﬁned as the set of all viruses found on 
the surface and inside the body in the absence of clinically signiﬁ-
cant symptoms of infection [10]. The human virome is character-
ized by considerable heterogeneity, as the different body regions 
have a great variability of environments, which is also reﬂected in 
the microbial communities that populate each of them [11]. Specif-
ically, metagenomics studies of plasma samples from human blood 
have determined the sporadic presence of viral sequences from 
multiple families. In some of them, bacteriophages from the Myo-
viridae, Siphoviridae, Podoviridae, Microviridae, and Inoviridae 
families have been found [10, 12, 13]. Regarding eukaryotic 
viruses, members of the Anelloviridae, Herpesviridae, Picornavir-
idae, Poxviridae, Flaviviridae, Marseilleviridae, Mimiviridae, and 
Phycodnaviridae families have been identiﬁed [12, 14–18]. How-
ever, there are two viral groups that cause chronic and/or asymp-
tomatic infections and are commonly present in plasma, members 
of the Anelloviridae family belonging to the Alphatorquevirus, 
Betatorquevirus, and Gammatorquevirus genera, and the human 
pegivirus species, which belongs to the Pegivirus genus from the 
Flaviviridae family. 
The description of viruses present in blood has direct implica-
tions for public health in addition to contributing to the growing 
evidence that mutualistic/commensal interactions between viruses 
and their hosts appear to be the rule rather than the exception.

Viral Metagenomics from Blood Plasma
157
2 
Materials 
2.1 
Recovery of Viral 
Particles 
1. Ultracentrifuge. 
2. High speed centrifuge tubes. 
3. 1x phosphate buffer saline (PBS). 
4. 1 mL extended length pipettes tips. 
2.2 
Nuclease 
Treatment 
1. TURBO DNA Free Kit (Ambion), including 10× TURBO 
DNase Buffer, TURBO™ DNase 2 U/μL, and DNase Inacti-
vation Reagent. 
2. Diethylpyrocarbonate (DEPC) treated water. 
3. 250 U/μL Benzonase. 
4. 2000 U/μL micrococcal nuclease. 
5. Incubator at 37 °C. 
6. Bench centrifuge. 
7. 0.5 mL microfuge tubes. 
Keep all reagents at -20 °C, except DEPC water. 
2.3 
RNA Enrichment
1. TRIzol reagent. 
2. Chloroform–isoamyl alcohol. 
3. Fume hood. 
4. Bench centrifuge. 
2.4 
DNA/RNA 
Extraction 
1. QIAamp Viral RNA Mini Kit (Qiagen). 
2. Linear acrylamide carrier. 
3. 96% ethanol. 
4. DEPC water. 
5. RNase-Free DNase Set (Qiagen) (exclusive reagent for RNA 
extraction), including DNase I and RDD Buffer. 
6. 1.5 mL and 2 mL microfuge tubes. 
2.5 
RNA 
Ampliﬁcation 
1. 10 mM dNTP mix. 
2. 50 μM random hexamers. 
3. 40 U/μL RNase inhibitor. 
4. 200 U/μL SuperScript III Reverse Transcriptase. 
5. 10x SuperScript III Buffer. 
6. 0.1 M dithiothreitol (DTT). 
7. Dimethyl sulfoxide (DMSO).

158
Marı´a Cebria´ -Mendoza et al.
8. Thermal cycler. 
9. QuantiTect Whole Transcriptome kit (Qiagen). 
Keep all reagents at -20 °C. 
2.6 
DNA 
Ampliﬁcation 
1. TruePrime® WGA kit. 
Keep all reagents at -20 °C. 
2.7 
Massive 
Sequencing 
1. Nextera XT DNA library preparation kit (Illumina). 
2. NextSeq device (Illumina). 
2.8 
Sequence 
Analysis 
1. FastQC v0.11.9 http://www.bioinformatics.babraham.ac.uk/ 
projects/fastqc software. 
2. MultiQC v1.8 software [19]. 
3. BBTools suite v38.82 [20]. 
4. Centrifuge package version 1.0.4 [21]. 
5. Recentrifuge software version 1.3.2 [22]. 
6. metaSPAdes version 3.15.0 [23]. 
7. BLASTn v2.10.0. 
8. ORF Finder (https://www.ncbi. nlm.nih.gov/orfﬁnder/). 
3 
Methods 
3.1 
Recovery of Viral 
Particles 
1. Addition of control viruses: 103 PFU of ΦX174 and 104 PFU 
of vesicular stomatitis virus (see Note 1). 
2. Filter 12 mL of plasma with ﬁlters with 1 μm pore size (see 
Notes 2 and 3). 
3. Centrifuge 10 mL of plasma at 87,000 × g for 2 h at 4 °C (see 
Notes 4 and 5). Remember to precool centrifuges to 4 °C 
prior to the experimental steps. 
4. Remove the supernatant with a serological pipette from the 
opposite side to the pellet. To prevent the pellet from detach-
ing, it is recommended to remove the ﬁnal volume (approxi-
mately 1 mL) with a 1 mL tip. 
5. Add carefully 10 mL of 1x PBS to each tube. 
6. Centrifuge 10 mL of 1x PBS at 87,000 × g for 1 h at 4 °C. 
7. Remove the supernatant with a serological pipette from the 
opposite side to the pellet. To prevent the pellet from detach-
ing, it is recommended to remove the ﬁnal volume (approxi-
mately 1 mL) with a 1 mL tip.

Viral Metagenomics from Blood Plasma
159
3.2 
Nuclease 
Treatment 
1. Resuspend the pellet in 245 μL of 1x TURBO DNase buffer 
(see Note 6). 
2. Add 5 μL of TURBO DNase, 2 μL of benzonase, and 2 μL 
micrococcal nuclease. Mix thoroughly and incubate the mix at 
37 °C for 1 h. 
3. To stop nuclease activity, add 20 μL of DNase Inactivation 
Reagent (see Note 7). Incubate the mix for 3 min at room 
temperature (RT), shaking manually a couple of times, and 
centrifuge at 10,000 × g for 3 min at RT. 
4. Transfer the supernatant to two new tubes (containing 200 and 
40 μL for subsequent RNA and DNA extractions, respectively) 
without disturbing the pellet of DNase Inactivation Reagent 
(see Note 8). 
3.3 
RNA Enrichment
1. The 200 μL fraction obtained from the nuclease treatment will 
be used for RNA enrichment. For this purpose, add 600 μL of  
TRIzol to 200 μL of the digested sample (see Note 9). Mix 
them by pipetting up and down several times and incubate the 
sample for 5 min at RT (see Note 10). 
2. Centrifuge 12,000 × g for 10 min at 4 °C. 
3. Transfer supernatants to phase-lock gel tubes (see Note 11) and 
incubate 3 min at RT. 
4. Add 200 μL of chloroform–isoamyl alcohol and mix by invert-
ing the tube vigorously. 
5. Incubate 15 min at RT and centrifuge at 12,000 × g for 15 min 
at 4 °C. 
6. Pick 280 μL of supernatant and put it on ice. This volume is 
used for RNA extraction. 
3.4 
DNA/RNA 
Extraction 
Independently, for the remaining 40 μL fraction of the digestion 
and the fraction in which RNA has been enriched, DNA and RNA 
extractions are carried out, respectively. The extraction is per-
formed with the QIAmp Viral RNA Mini kit (Qiagen) following 
the steps indicated by the manufacturer (see Notes 12–14). 
1. First, pipette 560 μL of AVL buffer into a 2 mL tube and add 
the carrier (1 μL/sample) (see Note 15). 
2. Add 140 μL of the sample. Mix well by inverting the tubes 
several times. 
3. Incubate 10 min at RT. 
4. Spin to remove liquid from the lid of the tube. 
5. Add 560 μL of 96% ethanol to the sample, vortex for 15 s, and 
spin to remove liquid from the lid of the tube. 
6. Add carefully to a column (avoid touching the edge of the 
column) 630 μL of the previous step solution. Close the lid 
and centrifuge at 3500 × g for 1 min.

f
160
Marı´a Cebria´ -Mendoza et al.
7. Remove the elute from the collecting tube, replace the column, 
and repeat the previous step as many times as necessary to pass 
the entire sample volume. 
8. Add 500 μL of 70% ethanol (see Note 16) and centrifuge at 
5000 × g for 3 min. 
9. Add a mixture of 10 μL of DNase I (see Note 17) and 70 μL of  
RDD Buffer to the column and incubate 15 min at RT (see 
Note 18). 
10. Add 500 μL of AW1 buffer and centrifuge at 5000 × g for 
1 min. 
11. Place the column in a new collector tube, add 500 μL of AW2  
buffer, and centrifuge at max speed for 3 min. 
12. Discard the buffer from the collection tube and centrifuge the 
column again for 1 min at maximum speed to dry the column. 
13. Place the column into a new tube and add 30 μL of Elution 
Buffer, incubate 5 min at RT, and centrifuge at 6000 × g for 
1 min. 
3.5 
RNA 
Ampliﬁcation 
1. For cDNA synthesis, mix 8 μL of RNA, 1 μL of random 
hexamers, and 1 μL of dNTPs. Incubate the sample in the 
thermal cycler at 75 °C for 5 min and then 5 min on ice. 
2. Add 10 μL of the following mix: 2 μL of 10x RT Buffer for 
SSIII, 4 μL of 25 mM MgCl2, 2  μL of 0.1 M DTT, 1 μL of  
40 U/μL RNase inhibitor, 0.5 μL of DMSO, and 1 μL o  
SuperScript III. 
3. Incubate in the Thermal Cycler at 25 °C for 10 min, 45 °C for 
90 min, and 95 °C for 5 min (see Note 19). 
4. Place 10 μL of cDNA into a new tube. 
5. Prepare ligation mix, following the recommendation of the 
Quantitect Whole Transcriptome Kit (Qiagen): 6 μL of Liga-
tion Buffer, 2 μL of Ligation Reagent, 1 μL of Ligation 
Enzyme 1, and 1 μL of Ligation Enzyme 2 and mix thoroughly 
(see Note 20). Add 10 μL of this mix to cDNA, mix well, and 
incubate at 22 °C for 2 h. 
6. Prepare ampliﬁcation mix following the recommendation of 
the Quantitect Whole Transcriptome Kit (Qiagen): 29 μL of  
REPLI-g Midi Reaction Buffer and 1 μL of REPLI-g Midi 
DNA Polymerase. 
7. This volume is added to the product of the ligation reaction 
and incubated in the Thermal Cycler at 30 °C for 2 h, followed 
by 95 °C for 5 min. 
8. The ampliﬁcation product is stored at -20 °C until library 
construction.

Viral Metagenomics from Blood Plasma
161
3.6 
DNA 
Ampliﬁcation 
1. DNA obtained after extraction is subject to ampliﬁcation with 
the TruePrime WGA kit. 
2. Mix 2.5 μL of sample and 2.5 μL of buffer D, vortex, and 
spin it. 
3. Incubate at RT for 3 min. 
4. Neutralize the reaction adding 2.5 μL of buffer N. 
5. Mix 26.8 μL of DEPC water, 5 μL of reaction buffer, 5 μL of  
dNTPs, 5 μL of Enzyme 1, and 0.7 μL of Enzyme 2 (see Note 
21). Combine both mixes and incubate at 30 °C for 3 h and 
then 10 min at 65 °C to inactivate the enzymes. 
3.7 
Massive Parallel 
Sequencing 
1. For each sample, DNA and RNA ampliﬁcation products are 
mixed in equimolar concentration before library preparation. 
2. Library is carried out using Nextera XT DNA library prepara-
tion kit with 15 ampliﬁcation cycles. 
3. Libraries are subjected to pair-end sequencing in a NextSeq 
device. 
3.8 
Sequence 
Analysis 
1. Sequence data are quality-checked using FastQC v0.11.9 
(http://www.bioinformatics.babraham.ac.uk/projects/fas 
tqc/) and MultiQC v1.8 [19]. 
2. Reads are quality-ﬁltered using bbduk.sh from BBTools suite 
v38.82 [20] (see Note 22). 
3. Sequence identiﬁcation is carried out with Centrifuge software 
package [21] version 1.0.4 using a minimum exact match of 
18. A customized database is generated from the NCBI nt 
database. The centrifuge download tool is used for incorporat-
ing archaea, viruses, bacteria, and fungi genomes from the 
RefSeq database at the “Complete Genome” and “Chromo-
some” assembly levels. 
4. Centrifuge results are postprocessed for contaminant removal 
and analyzed with Recentrifuge [22] version 1.3.2 using a 
minscore of 22. 
5. Assembly is individually performed for each pool with metaS-
PAdes [23] version 3.15.0 using default parameters. 
6. Homology analysis of the contigs is performed against a local 
copy of the NCBI nt database using BLASTn v2.10.0 with an 
E-value cutoff of 10-5 . 
7. Contigs identiﬁed as viral are analyzed for putative open 
reading frames (ORF). ORFs are identiﬁed using ORF Finder 
(https://www.ncbi. nlm.nih.gov/orfﬁnder/).

162
Marı´a Cebria´ -Mendoza et al.
4 
Notes 
1. Control viruses are added to check that the process works 
correctly. Low biohazard viruses, both DNA and RNA, as 
well as enveloped and nonenveloped, can be used for this 
purpose. 
2. Filtering with pore sizes smaller than 1 μm may compromise 
the recovery of large viruses. 
3. Because molecular biology kits and library preparation are 
quite expensive, plasma mixtures from different donors/ 
patients can be used, when there is no speciﬁc interest in 
characterizing the virome at the individual level, but the ulti-
mate goal involves an epidemiological approach. 
4. Balancing of the tubes is done by adding 1x PBS. 
5. As negative controls, samples are also processed starting initi-
ally from 1x PBS and following the steps of the protocol in an 
equivalent way to the rest of the samples. 
6. Dilute 1/10 10x TURBO DNase Buffer with DEPC water. 
7. Resuspend well before adding DNase Inactivation Reagent. 
8. Split this fraction in two. 200 μL and 40 μL are used for RNA 
and DNA extraction, respectively. The volume difference in 
favor of the RNA fraction is due to the fact that it is technically 
much more complicated to recover RNA viruses. 
9. If starting from a volume of less than 200 μL, this is adjusted 
using DEPC water. 
10. The process can be stopped by storing the tubes with TRIzol at 
4 °C, even overnight. 
11. It is recommended to work in a fume hood. The hood surface 
and all necessary equipment, e.g., pipettes and centrifuge 
should be cleaned with RNase decontamination solution. It is 
recommended to change gloves frequently and work on ice to 
preserve RNA integrity. 
12. Before starting, equilibrate the AVE buffer at RT, check that 
buffers AW1 and AW2 have been prepared correctly and equil-
ibrate the samples at RT. 
13. The optimum working volume is 140 μL. If the volume is 
lower, adjust with DEPC water and if it is higher, divide into 
two fractions. 
14. To avoid nucleases that could degrade nucleic acids, we recom-
mend the use of ultraclean tubes. 
15. Linear acrylamide is used as a carrier due to its inert nature. 
16. Prepare with DEPC water.

Viral Metagenomics from Blood Plasma
163
17. Thawed aliquots can be stored at 2–8 °C for up to 6 weeks. Do 
not refreeze once thawed. 
18. Steps 9 and 10 are exclusive for RNA extraction, not for DNA 
extraction. 
19. The cDNAs are stored at -20 °C or used for the next step. 
20. Enzymes should be thawed on ice just prior to use, while 
buffers are thawed at RT and vortexed. 
21. dNTPs, Enzyme 1, and Enzyme 2 should be thawed on ice just 
prior to use. 
22. A quality trimming threshold of 20 is used, and reads below 
70 nucleotides in length are removed from the dataset. 
Acknowledgments 
This work was funded by the Spanish Ministerio de Economı´a, 
Industria y Competitividad (MINECO) coﬁnanced by FEDER 
funds, 
grant 
numbers 
SAF2017-82287-R 
and 
PID2020-
118602RB-I00, and the Generalitat Valenciana, grant number 
AICO/2021/085. 
References 
1. Holmes EC (2011) What does virus evolution 
tell 
us 
about 
virus 
origins? 
J 
Virol 
85(11):5247–5251. https://doi.org/10. 
1128/2FJVI.02203-10 
2. French RK, Holmes EC (2020) An ecosystems 
perspective on virus evolution and emergence. 
Trends Microbiol 28(3):165–175. https://doi. 
org/10.1016/j.tim.2019.10.010 
3. Khan Mirzaei M, Xue J, Costa R et al (2021) 
Challenges of studying the human Virome – 
relevant emerging technologies. Trends Micro-
biol 29(2):171–181. https://doi.org/10. 
1016/j.tim.2020.05.021 
4. Lipkin WI, Firth C (2013) Viral surveillance 
and
discovery.
Curr
Opin
Virol 
3(2):199–204. https://doi.org/10.1016/j. 
coviro.2013.03.010 
5. Rosario K, Breitbart M (2011) Exploring the 
viral world through metagenomics. Curr Opin 
Virol 1(4):289–297. https://doi.org/10. 
1016/j.coviro.2011.06.004 
6. Sathiamoorthy S, Malott RJ, Gisonni-Lex L, 
Ng SHS (2018) Selection and evaluation of 
an efﬁcient method for the recovery of viral 
nucleic acids from complex biologicals. NPJ 
Vaccines 3(1):31. https://doi.org/10.1038/ 
s41541-018-0067-3 
7. Porter AF, Cobbin J, Li CX et al (2011) Meta-
genomic identiﬁcation of viral sequences in 
laboratory 
reagents. 
Viruses 
13(11):1–13. 
https://doi.org/10.3390/v13112122 
8. Asplund M, Kjartansdo´ttir KR, Mollerup S et al 
(2019) Contaminating viral sequences in high-
throughput sequencing viromics: a linkage 
study of 700 sequencing libraries. Clin Micro-
biol Infect 25(10):1277–1285. https://doi. 
org/10.1016/j.cmi.2019.04.028 
9. Santiago-Rodriguez TM, Hollister EB (2020) 
Potential applications of human viral metage-
nomics and reference materials: considerations 
for current and future viruses. Appl Environ 
Microbiol 86(22):1–12. https://doi.org/10. 
1128/AEM.01794-20 
10. Rascovan N, Duraisamy R, Desnues C (2016) 
Metagenomics and the human Virome in 
asymptomatic individuals. Annu Rev Microbiol 
70:125–141. https://doi.org/10.1146/ 
annurev-micro-102215-095431 
11. Human 
Microbiome 
Project 
Consortium 
(2012) Structure, function and diversity of 
the healthy human microbiome. Nature 486: 
207–214. https://doi.org/10.1038/ 
nature11234

18.
164
Marı´a Cebria´ -Mendoza et al.
12. Liang G, Bushman FD (2021) The human 
virome: assembly, composition and host inter-
actions. Nat Rev Microbiol 19(8):514–527. 
https://doi.org/10.1038/s41579-021-
00536-5 
13. Za´rate S, Taboada B, Yocupicio-Monroy M, 
Arias CF (2017) Human Virome. Arch Med 
Res 48(8):701–716. https://doi.org/10. 
1016/j.arcmed.2018.01.005 
14. Briese T, Kapoor A, Mishra N et al (2015) 
Virome capture sequencing enables sensitive 
viral diagnosis and comprehensive virome anal-
ysis. MBio 6(5). https://doi.org/10.1128/ 
mBio.01491-15 
15. Furuta RA, Sakamoto H, Kuroishi A et al 
(2015) Metagenomic proﬁling of the viromes 
of plasma collected from blood donors with 
elevated serum alanine aminotransferase levels. 
Transfusion 55(8):1889–1899. https://doi. 
org/10.1111/trf.13057 
16. Law J, Jovel J, Patterson J et al (2013) Identiﬁ-
cation of Hepatotropic viruses from plasma 
using deep sequencing: a next generation diag-
nostic tool. PLoS One 8(4):e60595. https:// 
doi.org/10.1371/journal.pone.0060595 
17. Popgeorgiev N, Boyer M, Fancello L et al 
(2013) 
Marseillevirus-like 
virus 
recovered 
from blood donated by asymptomatic humans. 
J Infect Dis 208(7):1042–1050. https://doi. 
org/10.1093/infdis/jit292 
Stremlau MH, Andersen KG, Folarin OA et al 
(2015) Discovery of novel Rhabdoviruses in 
the blood of healthy individuals from West 
Africa. PLoS Negl Trop Dis 9(3):e0003631. 
https://doi.org/10.1371/journal.pntd. 
0003631 
19. Ewels P, Magnusson M, Lundin S, K€aller M 
(2016) MultiQC: summarize analysis results 
for multiple tools and samples in a single 
report. 
Bioinformatics 
32(19):3047–3048. 
https://doi.org/10.1093/bioinformatics/ 
btw354 
20. Bushnell 
B, 
Rood 
J, 
Singer 
E 
(2017) 
BBMerge – accurate paired shotgun read merg-
ing via overlap. PLoS One 12(10):e0185056. 
https://doi.org/10.1371/journal.pone. 
0185056 
21. Kim D, Song L, Breitwieser FP, Salzberg SL 
(2016) Centrifuge: rapid and accurate classiﬁ-
caton of metagenomic sequences. Genome Res 
26(12):054965. https://doi.org/10.1101/gr. 
210641.116 
22. Martı´ JM (2019) Recentrifuge: robust compar-
ative analysis and contamination removal for 
metagenomics. PLoS Comput Biol 15(4): 
e1006967. https://doi.org/10.1371/journal. 
pcbi.1006967 
23. Nurk S, Meleshko D, Korobeynikov A, Pevz-
ner PA (2017) MetaSPAdes: a new versatile 
metagenomic
assembler.
Genome
Res 
27(5):824–834. https://doi.org/10.1101/gr. 
213959.116

Chapter 12 
Targeted Whole Genome Sequencing of the Capripoxvirus 
Genome from Clinical Tissue Samples and Lyophilized 
Vaccine Batches 
Elisabeth Mathijs and Frank Vandenbussche 
Abstract 
Diseases caused by Capripoxviruses (CaPVs) are of great economic importance in sheep, goats, and cattle. 
Since CaPV strains are serologically indistinguishable and genetically highly homologous, typing of closely 
related strains can only be achieved by whole-genome sequencing. In this chapter, we describe a robust, 
cost-effective, and widely applicable protocol for reconstructing (nearly) complete CaPV genomes directly 
from clinical samples or commercial vaccine batches in less than a week. Taking advantage of the genetic 
similarity of CaPVs, a set of pan-CaPVs long-range PCRs was developed that covers the entire genome with 
only a limited number of tiled amplicons. The resulting amplicons can be sequenced on all currently 
available high-throughput sequencing platforms. As an example, we have included a detailed protocol for 
performing nanopore sequencing and a pipeline for assembling the resulting tiled amplicon data. 
Key words Capripoxvirus, Targeted sequencing, Whole-genome sequencing, Tiled PCR 
1 
Introduction 
Capripoxviruses (CaPV) are one of the nine currently recognized 
genera within the subfamily Chordopoxvirinae of the family Pox-
viridae. The genus Capripoxvirus consists of the Lumpy Skin Dis-
ease Virus (LSDV), the Goatpox Virus (GTPV), and the Sheeppox 
Virus (SPPV). All CaPVs are responsible for economically impor-
tant diseases in domestic ruminants that threaten the livelihoods of 
smallholders and poor rural communities in endemic regions [1, 2] 
and, more recently, farming communities in free regions [3]. Due 
to their potential to spread rapidly and their signiﬁcant economic 
impact, the World Organisation for Animal Health (OIE) has clas-
siﬁed all CaPV diseases as notiﬁable. 
Since the different CaPV species cannot be distinguished either 
morphologically or serologically, CaPVs were originally classiﬁed 
according to the host species from which they were isolated.
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_12, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
165

However, reliable differentiation between the three CaPV species is 
only possible at the molecular level. Several real-time PCR (qPCR) 
tests have been developed for the detection and differentiation of 
CaPV species. Although these qPCR tests allow the identiﬁcation 
of the different CaPV species, they lack the discriminatory power to 
differentiate closely related strains [4]. Differentiation at the strain 
level requires much higher resolution, which can only be achieved 
by comparing whole-genome sequence data.
166
Elisabeth Mathijs and Frank Vandenbussche
Unfortunately, CaPVs are difﬁcult to sequence due to their 
large genome size, skewed nucleotide composition and the pres-
ence 
of 
multiple 
homopolymeric 
and 
repetitive 
sequences. 
Although clinical samples may have a high viral load, viral DNA 
makes up only a small portion of the total DNA in these samples. 
To increase the ratio of signal (viral genome) to noise (host 
genome), most CaPV sequencing protocols require high concen-
trations and relatively large amounts of viral DNA, which can only 
be obtained by virus isolation. However, virus isolation is time-
consuming and requires appropriate cell culture and biocontain-
ment facilities, which are not available to all laboratories. 
In this chapter, we describe a robust, cost-effective, and widely 
applicable method for obtaining (nearly) complete CaPV genomes 
directly from clinical samples or commercial vaccine batches. Tak-
ing advantage of the genetic similarity of CaPVs, a set of pan-CaPVs 
long-range PCRs (LR-PCRs) was developed that covers the entire 
genome with only a limited number of tiled amplicons. The result-
ing PCR amplicons can be sequenced on all currently available 
high-throughput sequencing platforms to reconstruct (nearly) 
complete genomes in less than a week. As an example, we have 
included a detailed protocol for performing nanopore sequencing 
and a pipeline for assembling the resulting tiled amplicon data. 
2 
Materials 
Perform procedures with clinical samples in a class II microbiolo-
gical safety cabinet. Once the DNA is extracted, all subsequent 
steps can be performed in PCR cabinets to avoid laboratory 
contamination. 
2.1 
For All Steps
1. Microfuge tube thermal mixer. 
2. Ice bucket or cool elements. 
3. Vortex. 
4. DNase/RNase free plastics. 
5. Benchtop centrifuge. 
6. Pipets and ﬁlter tips.

Capripoxviruses Targeted Whole Genome Sequencing
167
2.2 
Sample 
Homogenization and 
Cellular Debris 
Sedimentation 
1. Scalpel. 
2. Petri dishes. 
3. Laboratory scale. 
4. 1X Phosphate-Buffered Saline, pH 7.4 (PBS). 
5. 2 mL sterile plastic tubes. 
6. Micro-pestles for microfuge tubes. 
2.3 
DNase Treatment 
for Free-DNA Removal 
1. 2 U/μL DNase enzyme. 
2. 10X DNase reaction buffer. 
2.4 
Viral Nucleic Acid 
Extraction 
1. Waterbaths and/or microfuge tube thermal mixer. 
2. 2 mL sterile plastic tubes. 
3. Absorbent paper. 
4. Gentra Puregene Tissue Kit (Qiagen) including Puregene Cell 
Lysis Solution, Puregene Proteinase K, Puregene RNase A 
Solution, Puregene Protein Precipitation Solution, and Pure-
gene DNA Hydration Solution (see Note 1). 
5. Glycogen solution. 
6. Isopropanol. 
7. 70% (v:v) ethanol, freshly prepared. 
2.5 
Real-Time qPCR 
for DNA Quality 
Evaluation 
1. Real-time PCR instrument. 
2. Quantitative PCR SuperMix (2X). 
3. 10 μM Primers: 5′-CATTAGAAGGAGGATATTTTAGATG-
3′ (forward primer) and 5′-AAACGAGGATTGATGCCAG-3′
(reverse primer). 
4. 10
μM
Probe:
FAM-CACAATGAA-ZEN-
GGCCCTCATCTCTACTAATAAGTTCG-BHQ1. 
5. PCR-grade water. 
6. Multiwell plates or strips for real-time PCR analysis. 
2.6 
Long-Range PCR 
Ampliﬁcation 
1. Thermocycler preheated at 98 °C. 
2. Microfuge tube thermal mixer preheated at 95 °C. 
3. 8-well PCR strips. 
4. PCR-grade water. 
5. Q5 Hot Start High-Fidelity DNA Polymerase (New England 
BioLabs). 
6. Q5 Reaction Buffer, 5X (New England BioLabs). 
7. 5X 5 M Betaine PCR Enhancer. 
8. CleanAmp dNTP Mix (TriLink Biotechnologies).

(continued)
168
Elisabeth Mathijs and Frank Vandenbussche
Table 1 
Primer sequences for 23 long-range PCR amplicons covering the genome 
of species comprising the Capripoxvirus genus 
Primer name
Primer sequence (5′–3′) 
fp CaPV-F1
AAACCTGTAAATGGATACTTTTTTCATTC 
rp CaPV-F1
ATTTGGAAATATAATTGTGTTAACTGTTCT 
fp CaPV-F2
TGTGAAAAATTAATCCATTCTTCTAAACAG 
rp CaPV-F2
TACATACATTTCAAGTACTAAAGAGAAGGAA 
fp CaPV-F3
ATGTCAACAACATTTTTGCTATTCAATG 
rp CaPV-F3
TTTTGGCCAGATATTTACAATGCTATCA 
fp CaPV-F4
GATGGACCTAATGGAGTTATTATTGAG 
rp CaPV-F4
GAAAAATCAAATGTAAACAAACAGCTGT 
fp CaPV-F5
ATTCCATCATTGTTTGGTATTATTCCA 
rp CaPV-F5
ACATATCATGTAAATAATAATAACGGAACAAC 
fp CaPV-F6
GCTGAAGAATATGAATACAATACGCTAT 
rp CaPV-F6
AAAAAACAAAATTTGAAGAACCTAAATCAG 
fp CaPV-F7
GTATTGTTCTCCAAGTTTTACATCCTT 
rp CaPV-F7
CACATTTCTATTTTTAATAAATACGATTCCTTTC 
fp CaPV-F8
ATCTCCGTTTGCTAAAAAAGATAAAGC 
rp CaPV-F8
CATCTATGATAAATCGCACTATGGGTTTTA 
fp CaPV-F9
TGGGACCCAAATTGTTCAGAATCTAA 
rp CaPV-F9
TTTCTAACAATGGCCAAAAACGTTTATAA 
fp CaPV-F10
ATCCCACTTAAGATAATAAGATTTTTTAGAAAC 
rp CaPV-F10
TTCCTCAGATTATCCGCTAATTTATTTGA 
fp CaPV-F11
CTCTCTAATTTTAGTTATGTTTTCATCTATCCA 
rp CaPV-F11
AGAAAGGAATATTATATGCCCTATAGATATAGA 
fp CaPV-F12
CCCAGATAAAGACGCAATAAGTAGAT 
rp CaPV-F12
AACGAGTTGTTAGTCATTTGAGATAC 
fp CaPV-F13
ACCATTCCAGAATTAAGTTTGATAATAAAC 
rp CaPV-F13
GGGGGAAATTATTTCAGAGTTATTAGAT 
fp CaPV-F14
TATTATCATCGTTTCCAATTAATGAATTAATTAC 
rp CaPV-F14
CAACGAAAAACATTGATAAAATCTGATG 
fp CaPV-F15
CTTTGATGTTGTTACCACCTTTCC 
rp CaPV-F15
TTAAAAGAACAAAGTGGAATGGTAAGATAG 
fp CaPV-F16
GAGTAAGATTTGATTTTTGAGATGCTTG

Table 1
Capripoxviruses Targeted Whole Genome Sequencing
169
(continued)
Primer name
Primer sequence (5′–3′) 
rp CaPV-F16
TTTTCAAACCCGTATTCATTTTTTACTG 
fp CaPV-F17
ACTAAGGTTTGTTTTAGATAAATGGGAT 
rp CaPV-F17
GTTTACAATTCTGCATATGATAGTTATATATGG 
fp CaPV-F18
GCCATCTAACTCTATTGTTAAATCCA 
rp CaPV-F18
CCTTTGCCTAAATCATCATTTTTCTC 
fp CaPV-F19a
CCRTCTATAGATATTAGAATTGTTAGTAAACC 
fp CaPV-F19b
CCGTCTATAGATATTAGAATTATTAGTAAACC 
rp CaPV-F19
GTATACATGATATTAGTGCAACATTGTTATG 
fp CaPV-F20
GTTTGTATGATGCCAGATTCAGATATTAC 
rp CaPV-F20
TAAACATAGACTCTTCTTTCGGTAGAC 
fp CaPV-F21
GTTCGGTTTCATATTTTTAGCATATTCAC 
rp CaPV-F21
TGATATAAGTTTCATCCAAAAATCATATGTTG 
fp CaPV-F22
GATTTACMCCACTTTTATCTTCTGTATATG 
rp CaPV-F22
GACATATTAGATTTTGGAAATATAAGAGGTG 
fp CaPV-F23
CCAAAAACGATTTCATTGTATAAAGAAC 
rp CaPV-F23
AAACCTGTAAATGGATACTTTTTTCATTCAATC 
F fragment; fp, forward primer, rp reverse primer, CaPV capripoxvirus 
9. 100 μM CaPV speciﬁc primers (Table 1). 
10. Equipment and reagents for agarose gel electrophoresis. 
2.7 
Amplicon 
Puriﬁcation and 
Quantiﬁcation 
1. 1.5 mL low binding microcentrifuge tubes. 
2. Magnetic separator for 1.5 mL tubes. 
3. SPRI magnetic beads. 
4. 80% (v:v) Ethanol, freshly prepared. 
5. 5 mM Tris/HCl, pH 8.5 (Elution Buffer). 
6. Qubit 4 Fluorometer (ThermoFisher Scientiﬁc) (see Note 2). 
7. Qubit 1X dsDNA HS Assay Kit (ThermoFisher Scientiﬁc). 
8. Qubit Assay Tubes (ThermoFisher Scientiﬁc). 
2.8 
Amplicon Pooling 
and DNA Sequencing 
(See Note 3) 
1. 1.5 mL low binding microcentrifuge tubes. 
2. 0.2 mL thin-walled PCR tubes. 
3. HulaMixer Sample Mixer (ThermoFisher Scientiﬁc).

170
Elisabeth Mathijs and Frank Vandenbussche
2. MinION 
Sequencing 
Device 
Mk1C 
(Oxford 
Nanopore 
Technologies). 
3. Flongle Flow Cell Adapter (ADP-FLG001, Oxford Nanopore 
Technologies). 
4. Ligation Sequencing kit (SQK-LSK109, Oxford Nanopore 
Technologies). 
5. Flongle 
Flow 
Cell 
(FLO-FLG001, 
Oxford 
Nanopore 
Technologies). 
6. Flongle Sequencing Expansion (EXP-FSE001, Oxford Nano-
pore Technologies). 
7. NEBNext Companion Module for Oxford Nanopore Technol-
ogies Ligation Sequencing (New England BioLabs). 
8. SPRI magnetic beads. 
9. Magnetic separator for 1.5 mL microtubes. 
10. Qubit 4 Fluorometer (ThermoFisher Scientiﬁc). 
11. Qubit 1X dsDNA HS Assay Kit (ThermoFisher Scientiﬁc). 
12. DEPC water. 
2.9 
Sequencing Data 
Analysis 
1. Linux operating computer (see Note 4). 
2. LILO fork available at https://github.com/el-mat/LILO-
CaPV (see Note 5). 
3 
Methods 
Homogenization and the steps prior to virus inactivation must be 
carried out in a class II microbiological safety cabinet in a biosafety 
level 3 laboratory. All disposable materials (e.g., tips, tubes, and 
pipettes) must be decontaminated before being placed in an appro-
priate waste container. After virus inactivation (30 min at 65 °C), all 
manipulations can be performed at biosafety level 2. 
3.1 
Sample 
Homogenization and 
Cellular Debris 
Sedimentation (See 
Note 6) 
1. Cut a 40 mg piece of clinical tissue and crush it with a pestle in a 
2 mL tube containing 300 μL PBS. 
2. Incubate overnight at 56 °C and shake at 1000 rpm. 
3. Centrifuge the tubes at 1000 × g and 4 °C for 15 min and 
transfer 250 μL of the supernatant into a clean 2 mL tube. 
3.2 
DNase Treatment 
for Free-DNA Removal 
1. Add 30 μL 10X DNase buffer and 20 μL DNase enzyme to the 
250 μL supernatant. Mix gently by pipetting up and down. 
2. Incubate at 37 °C for 15 min and spin down the tubes brieﬂy.

Capripoxviruses Targeted Whole Genome Sequencing
171
3.3 
Viral Nucleic Acid 
Extraction (See Note 7) 
1. In a 2 mL tube, add 500 μL Puregene Cell Lysis Solution to 
100 μL of DNase treated sample. Mix gently by pipetting up 
and down. 
2. Incubate for 30 min at 65 °C and spin down the tubes brieﬂy. 
3. Add 3 μL Puregene Proteinase K. Mix gently by ﬂicking the 
tubes. 
4. Incubate for 1 h at 55 °C and spin down the tubes brieﬂy. 
5. Add 3 μL RNase A and mix gently by inverting the tubes 
25 times. 
6. Incubate for 15 min at 37 °C and spin down the tubes brieﬂy. 
7. Cool the tubes on ice for 1 min. 
8. Add 200 μL Puregene Precipitation Solution and vortex at 
maximum speed for 20 s. 
9. Place the tubes on ice for 5 min. 
10. Centrifuge the tubes at 13,000 × g and 4 °C for 3 min. The 
resulting pellets should be ﬁrm. Repeat the procedure if 
necessary. 
11. Add 600 μL isopropanol to clean 2 mL tubes and gently pour 
the supernatants into the tubes. 
12. Add 1 μL Glycogen Solution and mix gently by inverting the 
tubes 50 times. 
13. Incubate for 5 min at room temperature. 
14. Centrifuge the tubes at 13,000 × g and 4 °C for 5 min. 
15. Carefully discard the supernatants and drain the tubes on 
paper. 
16. Add 600 μL of freshly prepared 70% (v:v) ethanol and gently 
invert the tubes to wash the pellets without disturbing their 
integrity. 
17. Allow the pellets to settle back to the bottom of the tubes (spin 
down brieﬂy if necessary). 
18. Aspirate and discard the supernatants with a pipet without 
touching the pellets. 
19. Allow the pellets to air dry until they are invisible (approxi-
mately 5 min). 
20. Add 80–100 μL Puregene DNA Hydration Solution and vor-
tex at medium speed for 5 s. 
21. Incubate for 1 h at 65 °C to dissolve the DNA pellets. 
22. Incubate overnight at room temperature with gentle shaking. 
23. Spin down the tubes and store them at -20 °C until further 
analysis.

172
Elisabeth Mathijs and Frank Vandenbussche
3.4 
Real-Time PCR
Ideally, the crossing point (Cp) value for successful LR-PCR ampli-
ﬁcation should be between 20 and 27. If the Cp values are below 
20, the puriﬁed DNA should be diluted at least 1:10 (v:v). At Cp 
values above 27, the LR-PCRs are less robust, and some ampliﬁca-
tions may fail. 
1. Prepare the following premix per sample (see Note 8): 10 μL 
Quantitative PCR SuperMix (2X), 1.4 μL forward primer 
(10 μM), 1.4 μL reverse primer (10 μM), 0.5 μL probe 
(10 μM), 4.7 μL PCR-grade water, and 2 μL puriﬁed DNA. 
2. Perform the qPCR reaction using the following program: 50 ° 
C for 2 min, 95 °C for 2 min, 45 cycles of 95 °C for 15 s, and 
60 °C for 30 s. 
3.5 
Long-Range PCR 
Ampliﬁcation 
PCRs should be performed in batches of no more than eight 
reactions, as the steps of the protocol should be performed as 
quickly as possible. Before each ampliﬁcation, 10 μM primer stocks 
should be freshly prepared from 100 μM primer stocks. 
1. Heat 100 μM primer aliquots for 5 min at 95 °C. 
2. Spin down quickly. 
3. Prepare forward/reverse 10 μM primer stocks in PCR tubes by 
mixing: 2 μL forward primer (100 μM), 2 μL reverse primer 
(100 μM), 16 μL PCR-grade water. 
4. Place 10 μM primer stocks on a preheated thermocycler at 98 ° 
C. 
5. Prepare the following premix per amplicon: (see Note 8): 
17.5 μL PCR-grade water, 10 μL Q5 reaction buffer (5X), 
10 μL 5 M Betaine (5X) PCR Enhancer, 2 μL CleanAMP 
dNTP mix, and 0.5 μL Q5 Hot Start High-Fidelity DNA 
Polymerase. 
6. Add 5 μL of DNA template to each mix. 
7. Spin down the preheated 10 μM primers. 
8. Add 5 μM of preheated 10 μM primers and mix gently by 
pipetting up and down. 
9. Immediately start the LR-PCR using the following program: 
98 °C for 3 min, 35 cycles of 98 °C for 10 s, 63 °C for 30 s, 72 ° 
C for 7 min, 72 °C for 2 min, and hold at 4 °C. 
10. The ampliﬁcation products should appear as a single 7.5 kb 
band when 5 μL of the PCR product is visualized by agarose gel 
electrophoresis (Fig. 1). 
11. The ampliﬁcation products can be stored at -20 °C prior to 
further analysis.

Capripoxviruses Targeted Whole Genome Sequencing
173
Fig. 1 Agarose gel (1%) electrophoresis analysis of the 23 long-range CaPV PCR 
amplicons. M molecular weight marker range 250–10,000 bp 
3.6 
Amplicon 
Puriﬁcation and 
Quantiﬁcation (See 
Note 9) 
1. Transfer 40 μL of the PCR product into a clean 1.5 mL DNA 
low binding tube. 
2. Vortex the SPRI beads until they are completely suspended. 
3. Add 72 μL of SPRI beads. Mix by pipetting up and down 
10 times. 
4. Incubate for 5 min at room temperature. 
5. Spin down the tubes and place them on the magnetic separator 
to separate the beads from the solution. Wait until the solution 
is clear (up to 3–4 min). 
6. Remove the supernatant with a pipet while leaving the tube on 
the magnetic separator. 
7. Wash with 200 μL of freshly prepared 70% (v:v) ethanol with-
out disturbing the beads pellet. Pipette off the ethanol and 
discard. Repeat this step one more time. 
8. Spin down the tube brieﬂy, place it back on the magnetic 
separator and pipette off any residual ethanol. 
9. Let the pellet dry for about 30 s. 
10. Remove the tube from the magnetic separator and add 32.5 μL 
elution buffer. Mix by pipetting up and down until the pellet is 
completely resuspended. 
11. Incubate at room temperature for 2 min. 
12. Place the tube on the magnetic separator for 1 min and transfer 
30 μL of the supernatant into a new DNA low binding tube.

174
Elisabeth Mathijs and Frank Vandenbussche
13. The puriﬁed amplicons can be stored at -20 °C prior to 
further analysis. 
14. Prepare the required number of 0.5 mL Qubit tubes for the 
two standards and samples. 
15. Add 190 μL of the ready-to-use working solution to the stan-
dard tubes, and 198 μL to the sample tubes. 
16. Add 10 μL of standard 1 or 2 to the respective standard tubes 
and 2 μL sample to each sample tube. 
17. Vortex the tubes and incubate them for 2 min at room temper-
ature protected from light. 
18. Read the sample concentrations on the Qubit 4 Fluorometer 
after performing a new calibration with standards 1 and 2. 
19. Each amplicon should have a concentration of at least 20 ng/μ
L. 
3.7 
Amplicon Pooling 
and DNA Sequencing 
1. All 23 amplicons must be pooled equimolarly (e.g., 100 ng of 
each amplicon) (see Note 10). 
2. Quantify the pooled amplicons using the Qubit 4 Fluorometer 
(see Subheadings 3.8.14–3.8.18). 
3. Dilute the pooled amplicons to 20 ng/μL in DEPC water in a 
volume of 50 μL. 
4. Add 23.5 μL pooled amplicons, 1.75 μL FFPE DNA Repair 
Buffer, 1.75 μL Ultra II End-Prep Reaction Buffer, 1 μL FFPE 
DNA Repair Mix, and 1.5 μL Ultra II End-Prep Enzyme Mix 
to a 0.2 mL PCR tube. Mix by gently ﬂicking the tube. 
5. Incubate for 5 min at 20 °C and for another 5 min at 65 °C. 
Spin down the tubes quickly. 
6. Perform a 1:1 (v:v) SPRI bead puriﬁcation. Transfer the reac-
tion volume to a clean 1.5 mL DNA low binding tube. 
7. Add 30 μL of resuspended SPRI beads and mix by ﬂicking 
the tube. 
8. Incubate for 5 min at room temperature on a HulaMixer. 
9. Spin down the tube and place it on the magnetic separator to 
separate the beads from the solution. Wait until the solution is 
clear (up to 3–4 min). 
10. Remove the supernatant with a pipet while leaving the tube on 
the magnetic separator. 
11. Wash the bead pellet with 200 μL of freshly prepared 70% (v:v) 
ethanol without disturbing the bead pellet. Pipette off the 
ethanol and discard. Repeat this step one more time. 
12. Spin down the tube quickly, replace it on the magnetic separa-
tor and pipette off any residual ethanol. 
13. Let the pellet dry for about 30 s but avoid cracking the pellet.

f
Capripoxviruses Targeted Whole Genome Sequencing
175
14. Remove the tube from the magnetic separator and add 30 μL 
of elution buffer. Mix by pipetting up and down until the pellet 
is completely resuspended. 
15. Incubate for 2 min at room temperature. 
16. Place the tube back on the magnetic separator for 1 min and 
transfer 30 μL of the supernatant to a new DNA low 
binding tube. 
17. Add to the sample tube: 12.5 μL Ligation Buffer (LNB), 5 μL 
NEBNext Quick T4 DNA ligase, and 2.5 μL Adapter Mix 
(AMX) (see Note 11). 
18. Mix by gently ﬂicking the tube, spin down and incubate the 
reaction for 10 min at room temperature. 
19. Perform a 1:0.4 (v:v) SPRI bead puriﬁcation. Add 20 μL o  
resuspended SPRI beads and mix by ﬂicking the tube. 
20. Incubate for 5 min at room temperature on a HulaMixer. 
21. Spin down the tube and place it on the magnetic separator to 
separate the beads from the solution. Wait until the solution is 
clear (up to 3–4 min). 
22. Remove the supernatant with a pipet while leaving the tube on 
the magnetic separator. 
23. Wash the bead pellet with 125 μL of Long Fragment Buffer 
(LFB). Flick the tube to resuspend the beads and then place it 
back on the magnetic separator. Once the beads are pelleted, 
discard the supernatant with a pipette. Repeat this step one 
more time. 
24. Spin down the tube quickly, place it back on the magnetic 
separator and pipette off any residual ethanol. 
25. Allow the pellet to dry for about 30 s but avoid cracking the 
pellet. 
26. Remove the tube from the magnetic separator and add 7 μL of  
elution buffer. Mix by pipetting up and down until the pellet is 
completely resuspended. 
27. Incubate for 10 min at room temperature. 
28. Place the tube back on the magnetic separator for 1 min and 
transfer 7 μL of supernatant to a new DNA low binding tube. 
29. Quantify the eluted library using the Qubit 4 Fluorometer (see 
Subheadings 3.8.14–3.8.18). 
30. The concentration of the library should be at least 3 ng/μL  to  
load the required minimum of 3 fmol onto the Flongle ﬂow 
cell. If the concentration is ≥10 ng/μL, 50 ng of library (in a 
volume of 5 μL) should be loaded onto the ﬂongle ﬂow cell (see 
Note 12).

176
Elisabeth Mathijs and Frank Vandenbussche
31. Load the Flongle ﬂow cell according to the instructions 
provided by Oxford Nanopore Technologies. 
32. Set the sequencing run to 24 h and perform HAC basecalling 
in the MinKNOW software. 
33. Compressed fastq ﬁles (*.fastq.gz) containing sequences that 
have passed quality ﬁltering should be used for genome 
assembly. 
3.8 
Assembling the 
Sequencing Data 
1. Clone the GitHub repository (see Note 5) and follow the 
instructions in the README ﬁle to install the LILO-CaPV 
pipeline. 
2. In the current working directory, create a folder named “raw/” 
that contains the compressed fastq ﬁles to be analyzed (see 
Notes 13 and 14). 
3. Activate the LILO-CaPV environment. 
4. Edit the supplied conﬁg.ﬁle with the correct paths to the CaPV 
scheme ﬁles. 
5. Launch the genome assembly as follows: “snakemake -k -s / 
path/to/LILO-CaPV --conﬁgﬁle /path/to/conﬁg.ﬁle --cores 
8” (see Note 15). 
6. Check the length of the contig created by LILO-CaPV as 
follows: “bioawk -c fastx ’{ print $name, length($seq) }’ sam-
ple/polished_trimmed.fa.cap.contigs.” It should be about 
150 kbp (see Note 16). 
4 
Notes 
1. The protocol was optimized using the Gentra Puregene Tissue 
Kit from Qiagen. Other extraction kits allowing the puriﬁca-
tion of high-molecular-weight (100–200 kb) DNA can be used 
according to the manufacturer’s instructions. 
2. For accurate dsDNA quantiﬁcation, the use of a ﬂuorescent 
nucleic acid dye is preferable. Alternatives to Invitrogen Qubit 
are available. 
3. Ligation sequencing kits and ﬂow cells for nanopore sequenc-
ing should be adapted to the most recent available reagents as 
the technology keeps evolving. 
4. The LILO-CaPV pipeline has been tested successfully on a 
Windows computer running Windows Subsystem for Linux. 
5. The LILO-CaPV pipeline was adapted from the Lilo pipeline 
https://github.com/amandawarr/Lilo. 
6. If the starting material is a lyophilized vaccine, resuspend the 
freeze-dried vaccine pellet in 2 mL PBS and start the protocol 
immediately at Subheading 3.2, step 1).

Capripoxviruses Targeted Whole Genome Sequencing
177
7. The extraction should be performed in triplicate to obtain 
sufﬁcient DNA to perform the downstream PCRs. 
8. For multiple samples, we recommend preparing 10% extra 
premix. 
9. Allow the SPRI beads and the Qubit 1X dsDNA HS Assay kit 
to equilibrate at room temperature for 30 min before use. Keep 
the Qubit dye away from light. 
10. If you want to perform short-read sequencing, amplicons F1 
and F23, which contain the inverted terminal repeats (ITR), 
should not be pooled together. Two separate pools (e.g., pool1 
containing F1 to F12 and pool2 containing F12 to F23) must 
be sequenced separately. 
11. Multiple samples can be sequenced simultaneously on the same 
Flongle ﬂow cell. A barcoding step using the EXP-NBD104 or 
EXP-NBD114 kit followed by an adapter ligation step using 
the alternative Adaptor Mix (AMII) must be performed 
instead. 
12. To determine the amount of library that should be loaded 
according to the required 3–10 fmol, use the “dsDNA: Mass 
to/from Moles Convertor” from https://nebiocalculator.neb. 
com/. 
13. All fastq ﬁles from a sample should be combined into a single 
ﬁle. Use the cat command to combine the different fastq ﬁles. 
14. Each sample to be analyzed should have a unique sample name 
(e.g., sample.fastq.gz). All output ﬁles will be written to a 
folder named after this unique sample ﬁle. 
15. The number of cores should be adjusted to the number of 
threads available on your machine. 
16. If you have mixed samples or insufﬁcient coverage, you may get 
a shorter contig or multiple short contigs. To visualize this, the 
reads can be mapped against a reference genome using 
minimap2. 
References 
1. Tuppurainen ES, Alexandrov S, Beltran-Alcrudo 
et al (2017) Skin disease – a manual for veter-
inarians; FAO animal production and health 
manual. FAO, Rome, Italy. ISBN 978-92-5-
109776-2 
2. Tuppurainen ES, Oura CA (2012) Review: 
lumpy skin disease: an emerging threat to Eur-
ope, the Middle East and Asia. Transbound 
Emerg Dis 59:40–48 
3. Tuppurainen ES, Venter EH, Shisler JL et al 
(2017) Review. Capripoxvirus diseases: current 
status and opportunities for control. Trans-
bound Emerg Dis 64:729–745 
4. Mathijs E, Vandenbussche F, Van Borm S 
(2016) Using genomics for surveillance of vet-
erinary infectious agents. Revue Scientiﬁque Et 
Technique (International Ofﬁce of Epizootics) 
35:143–157

Chapter 13 
Viromes of Plants Determined by High-Throughput 
Sequencing of Virus-Derived siRNAs 
Nikoletta Jaksa-Czotter, Zsuzsanna Nagyne´ Galba´cs, Almash Jahan, 
Emese Demia´n, and E´va Va´rallyay 
Abstract 
Plants growing in open airﬁelds can be infected by several viruses even as a multiple infection. Virus 
infection in crops can lead to a serious damage to the harvest. In addition, virus presence in grapevine, 
fruit trees, and tuberous vegetables, propagated vegetatively affects the phytosanitary status of the propa-
gation material (both the rootstock and the variety) having profound effect on the lifetime and health of the 
new plantations. The fast evolution of sequencing techniques provides a new opportunity for 
metagenomics-based viral diagnostics. Small interfering (si) RNAs produced by the RNA silencing-based 
host immune system during viral infection can be sequenced by high-throughput techniques and analyzed 
for the presence of viruses, revealing the presence of all known viral pathogens in the sample and therefore 
opening new avenues in virus diagnostics. This method is based on Illumina sequencing and bioinformatics 
analysis of virus-derived siRNAs in the host. Here we describe a protocol for this challenging technique step 
by step with notes, to ensure success for every user. 
Key words Small RNA library, RNA, Virus diagnostics, High-throughput sequencing (HTS) 
1 
Introduction 
High-throughput sequencing (HTS) methods and the discovery of 
RNA interference opened new possibilities in virus diagnostics [1– 
4]. During virus infection, plant RNA silencing-based antiviral 
response promotes the accumulation of small (s)RNAs, including 
small interfering (si)RNAs of viral origin (21–25 nt long). These 
siRNAs mirror the sequences of the infecting viruses [5]. Deep 
sequencing and bioinformatics analysis of the sRNA population 
extracted directly from ﬁeld-grown plants offer a unique opportu-
nity to unveil the presence of any virus or viroid present in the 
sample [6–8]. Although sRNA HTS can be used to describe new 
viruses and for regulated plant pest diagnostics [9–11], RNA HTS 
sequencing is preferred for these purposes. In our experience,
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_13, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
179

sRNA HTS is also successful in virome description of a wide variety 
of plants, including grapevine and fruit trees [12–17]. Moreover, 
sRNA HTS can be used to characterize changes in the small non-
coding RNA proﬁle of the plant during viral infection. Indeed, 
monitoring the changes in the siRNA and miRNA proﬁles during 
multiple infections can add information about the host-virus cross-
talk during these complex processes, which is why usage of sRNA 
HTS for characterizing multiple infection processes in plants will 
probably increase in the future.
180
Nikoletta Jaksa-Czotter et al.
As a ﬁrst step, total RNA is extracted from the collected sample, 
and the sRNA fraction is puriﬁed. To make the sRNAs ready for 
sequencing, adapters must be ligated to both 5′- and 3′-ends. 
Afterward, reverse transcription and ampliﬁcation by RT-PCR are 
carried out. After sRNA sequencing, quality control of raw 
sequencing data is carried out, and cleaned reads are aligned to 
viral reference genomes by bioinformatics methods, revealing the 
presence of viral entities in the sample. Pipeline for bioinformatics 
analysis of sRNA reads changes greatly between laboratories; this 
could result in different outputs for the same dataset [18]. Here we 
describe the pipeline which we routinely use; however, we would 
like to emphasize the importance of veriﬁcation of the sRNA HTS 
results by an unbiased, preferentially wet-lab method. 
2 
Materials 
1. 40% acrylamide:bis-acrylamide (19:1). 
2. 10% ammonium persulfate; store aliquots at -20 °C. 
3. Chloroform:isoamyl alcohol (24:1 v/v); store at 4 °C. 
4. 100% ethanol, 70% ethanol; store at -20 °C. 
5. Ethidium bromide. 
6. Extraction 
buffer 
(phenol–chloroform 
method) 
10×, 
pH = 9,5: 1 M glycine, 100 mM EDTA, 1 M NaCl; sterilize, 
keep at room temperature in a dark bottle. Working solution of 
extraction buffer has to be prepared from this concentrated 
solution (see Subheading 3.2.1, step 1). It should be protected 
from light. 
7. Extraction 
buffer: 
2% 
cetyltrimethylammonium 
bromide 
(CTAB), 2.5% polyvinyl pyrrolidone-40 (PVP-40), 100 mM 
Tris–HCl, pH 8.0, 25 mM EDTA (pH 8.0), 2 M NaCl; store at 
room temperature. 
8. 1× TE resuspension buffer, pH 8.0: 10 mM Tris–HCl, 
1 mM EDTA.

Virus Derived siRNAs for Plant Viromes
181
9. FDE loading dye: Dissolve 10 mg bromophenol blue, 10 mg 
xylene cyanol in 10 mL formamide and add 200 μL 0.5 M 
EDTA, pH 8.0; store in aliquots at -20 °C. 
10. 15 mg/mL GlycoBlue coprecipitant; store at -20 °C. 
11. Illumina TruSeq Small RNA Library Prep Kit: Ligation Buffer 
(HML), Stop Solution (STP), 10 mM ATP, 25 mM dNTP Mix 
(dilute 12.5 mM dNTP Mix), ultrapure water, RNA RT Primer 
(RTP), RNA 3′ Adapter (RA3), RNA 5′ Adapter (RA5), RNA 
PCR Primer (RP1), RNA PCR Primer Index (RPI1-RPI48). 
12. 9 M LiCl; store at 4 °C. 
13. Low Molecular Weight DNA Ladder. 
14. 99.7% isopropanol; store at room temperature. 
15. 2% β-mercaptoethanol; distribute aliquots in 1.5 mL micro-
tubes; store at 4 °C. 
16. MilliQ pure water; store at room temperature in aliquots for 
single use. 
17. 4 M sodium acetate, pH 5.2; store at room temperature. 
18. 0.3 M sodium chloride; store at room temperature. 
19. 6× Orange G, Xylene Cyanol Loading Dye. 
20. 20 bp DNA Ladder. 
21. 50 bp low molecular weight ladder. 
22. UV transilluminator 
23. 500 U/μL Phusion High-Fidelity DNA Polymerase. 
24. 8% polyacrylamide gel (PAGE): 8% acrylamide:bis-acrylamide, 
8 M Urea, 1× TBE buffer, 0.06% APS, 0.16‰ TEMED; make 
fresh every time. 
25. 10,000 U RevertAid H Reverse Transcriptase. 
26. 40 U/μL RNase Inhibitor. 
27. SDS: 10% sodium dodecyl sulfate can be stored at room tem-
perature. If it precipitates, warm slightly and mix until clear 
before use. 
28. Software: CLC Genomic Workbench (Qiagen). 
29. SSTE buffer: 0.5% SDS, 10 mM Tris–HCl, pH 8.0, 1 mM 
EDTA (pH 8.0), 1 M NaCl; store at room temperature. 
30. 5 U/μL T4 RNA Ligase (cloned). 
31. T4 RNA Ligase 2 truncated. 
32. 10× TBE buffer: 0.9 M Tris, 0.9 M boric acid, 0.02 M EDTA, 
pH 8.3; store at room temperature; dilute 1× TBE buffer from 
10× TBE buffer with sterilized water. 
33. TEMED: N,N,N′,N′-tetramethylethylene-1,2-diamine; store 
at 4 °C.

182
Nikoletta Jaksa-Czotter et al.
3 
Methods 
The working environment should be clean; nuclease-free tubes, 
bottles, glassware, and consumables should be used. The water 
and all aqueous solutions should be autoclaved and preferably 
aliquoted for single usage. 
3.1 
Sample 
Collection 
HTS gives detailed information about the DNA or RNA content of 
even a very small amount of sample. To avoid misleading or false 
conclusions, sample collection must be designed and carried out 
very precisely. The presence of viruses in perennial woody plants can 
vary during the vegetation period and can be different in different 
organs. Phloem-limited viruses further complicate this question. 
Our experience showed that combining RNAs from different 
organs of the same plant and several plants from the same planta-
tion gives a good solution for this problem. Samples are best to 
collect in the fast-growing vegetation period. Plant and plantation 
pools can be produced from the puriﬁed RNAs, but it is also 
advisable to keep individual RNA extracts for validation. 
1. Collect fresh leaf samples into labeled plastic bags in the ﬁeld 
(see Note 1). 
2. Keep the collected samples in a cooler during sample collection 
and in the fridge at 4 °C upon arrival to the lab. Samples can be 
stored at 4 °C for max. 2 days. 
3. Pack enough material for RNA extraction individually using 
aluminum foil, mark it and freeze it at -70 °C. Samples can be 
stored at -70 °C for a long period of time (years) without any 
damage to their RNA content (see Note 2). 
3.2 
RNA Extraction
High-quality RNA is a prerequisite for RNA sequencing. Our 
experience has shown that we need to use different nucleic acid 
puriﬁcation methods for each type of plant to extract high-quality 
and high-purity nucleic acid. For herbaceous plant samples, 
phenol–chloroform total nucleic extraction [19] works well. With 
this fast method, RNA together with DNA is puriﬁed from the 
sample. As before the library preparation, the sRNA fraction is 
puriﬁed from polyacrylamide gel, there is no need to get rid of 
the DNA present since it is removed during this size-based separa-
tion. In addition to herbaceous model plants (Arabidopsis thaliana, 
Nicotiana benthamiana), we have successfully used this simple 
nucleic acid puriﬁcation for sRNA HTS library preparation in case 
of maize, millet, barley, sweet potato, alfalfa, and pea. It also 
worked well in a series of annual and perennial weeds: Clematis 
vitalba, Asclepias syriaca, Erigeron annuus, Erigeron canadensis, 
Solidago canadensis, Echinochloa crus-galli, Setaria viridis, Cynodon 
dactylon, and Sorghum halepense. It is interesting to note that

although Corylus avellana is a woody plant, the phenol–chloroform 
method worked more efﬁciently in its case. This is why we suggest 
experiencing both methods and choose the more effective for 
your work. 
Virus Derived siRNAs for Plant Viromes
183
Table 1 
Steps and timing of total nucleic acid extraction using phenol–chloroform method 
Process
Time 
Leaf homogenization (150–200 mg) in extraction buffer
2–3 min/sample 
Extraction with phenol + centrifugation at RT (15,000 rpm)
5–10 min 
Extraction with phenol–chloroform:isoamyl alcohol + centrifugation at RT(15,000 rpm)
5–10 min 
Extraction with chloroform:isoamyl alcohol + centrifugation at RT (15,000 rpm)
5–10 min 
Precipitation with ethanol + incubation on ice
10 min 
Centrifugationa (15,000 rpm)
10–30 min 
Wash with 70% ethanol 
Centrifugationa (13,000 rpm) 
5 min 
Drying and resuspension in MilliQ pure water
10 min 
a Perform all centrifugation at 4 °C in a cooled centrifuge. 
3.2.1 
RNA Extraction 
with Phenol–Chloroform 
Method 
To protect RNA from ubiquitous RNA-degrading enzymes, gloves 
must be worn, samples must be kept on ice, and the sterile mortars 
should be cooled on ice. Timing of the processing is reported in 
Table 1. 
1. Prepare 1× extraction buffer freshly before use. For 10 mL, mix 
7 mL sterile water, 1 mL 10× Extraction Buffer and 2 mL 
10% SDS. 
2. Pipette 600 μL phenol into the clean 1.5 mL microtubes and 
place them on ice. 
3. Take out samples from the freezer and store in liquid nitrogen 
until starting their extraction (see Note 3). Place the leaf mate-
rial immediately into a sterile mortar on ice, grind the leaf 
material, and add 650 μL extraction buffer. Continue homog-
enization and transfer the material into a tube on ice containing 
600 μL phenol. 
4. Mix thoroughly by vortexing and centrifuge for 5 min at room 
temperature at maximum speed (15,000 rpm). 
5. Add 300 μL phenol and 300 μL chloroform:isoamyl alcohol 
into a clean 1.5 mL microtube and put on the ice. 
6. Pipette the supernatant from step 4 into the tube on ice 
(step 5).

184
Nikoletta Jaksa-Czotter et al.
7. Mix thoroughly by vortexing and centrifuge for 5 min at room 
temperature at maximum speed. 
8. Add 600 μL chloroform:isoamyl alcohol into a fresh tube and 
put on ice. 
9. Pipette the supernatant from step 7 into the tube on ice 
(step 8). 
10. Mix thoroughly by vortexing and centrifuge for 5 min at room 
temperature at maximum speed. 
11. Add 20 μL 4 M sodium acetate and 1 mL 100% ethanol into a 
clean microtube and put on ice. 
12. Pipette the supernatant from step 10 into the tube on ice 
(step 11). 
13. Invert the tube several times carefully. Do not vortex and 
incubate on ice for 10 min. 
14. Centrifuge the samples 10–30 min, at 4 °C at maximum speed. 
15. Discard ethanol. Total nucleic acid is a white precipitate at the 
bottom of the microtube. 
16. Add 1 mL 70% ethanol to the precipitate. 
17. Centrifuge the tube for 3 min, at room temperature at maxi-
mum speed. 
18. Pour and wipe out any beads of ethanol and air-dry the pellet. 
19. Dissolve the nucleic acid in 30 μL MilliQ pure water and vortex 
the solution carefully to completely dissolve the precipitate. 
20. Store the total nucleic acid solution at -70 °C. 
3.2.2 
RNA Extraction 
with CTAB Method 
In spite of herbaceous plants, RNA extraction from woody plants is 
very challenging, because of the high amount of polysaccharides 
and polyphenols present, which can produce high molecular weight 
complexes via nucleic acid binding and inhibit successful extraction 
processes. From these samples, RNA can be extracted using the 
CTAB method [20] (Table 2). In our hands, this method worked 
efﬁciently in woody plants: Grapevine, apple, cherry, sour cherry, 
apricot, peach, raspberry, Crataegus sp., Vaccinium sp., Sambucus 
sp., Rosa canina, Ailanthus sp., and Fraxinus sp. 
To protect RNA from ubiquitous RNA-degrading enzymes, 
gloves must be worn, and samples must be kept on ice, homoge-
nized in liquid nitrogen, centrifuged at 4 °C except when otherwise 
stated. For further protection a detergent, CTAB preheated to 65 ° 
C, and a reducing agent (β-mercaptoethanol) is applied to destroy 
the disulphide bridges of the RNases and other proteins. A mixture 
of chloroform and isoamyl alcohol is used to eliminate phenolic 
compounds, while LiCl selectively precipitates RNA. As contami-
nants react differentially with chemically different agents, precipita-
tion by isopropanol and washing with ethanol is included to further 
purify the extracted RNA.

Virus Derived siRNAs for Plant Viromes
185
Table 2 
Steps and timing of RNA extraction with CTAB method 
Process
Time 
Leaf homogenization (150–200 mg)
2–3 min/sample 
Incubation at 65 °C
10 min 
Extraction with chloroform:isoamyl alcohol + centrifugationa (10,000 rpm)
15 min 
Extraction with chloroform:isoamyl alcohol + centrifugationa (10,000 rpm)
15 min 
Precipitation with LiCl + incubation on ice
30 min 
Centrifugationa (13,000 rpm)
20 min 
Resuspension of the precipitate in SSTE (65 °C) 
and extraction with chloroform:isoamyl alcohol + centrifugationa (10,000 rpm) 
10 min 
Precipitation with isopropanol 
Incubation at room temperature 
10 min 
Centrifugationa (13,000 rpm)
20 min 
Wash with 70% ethanol 
Centrifugationa (13,000 rpm) 
5 min 
Drying and resuspension in MilliQ pure water
10 min 
a Perform all centrifugation at 4 °C in a cooled centrifuge. 
Before starting the procedure make sure that you have a 65 °C 
thermo block and water bath heated and the centrifuge is cooled to 
4 °C. Heat the CTAB extraction buffer to 65 °C in a water bath. 
1. Take out samples from the freezer and store in liquid nitrogen 
until starting their extraction (see Note 3). 
2. Powder the sample (150–200 mg) in liquid nitrogen in a sterile 
mortar and then add 850 μL preheated CTAB extraction buffer 
and 17 μL 2%  β-mercaptoethanol (see Notes 4 and 5). 
3. Pour the homogenized sample into labeled 2 mL microtubes, 
mix thoroughly by vortexing, and place it into the warm (65 ° 
C) water bath. 
4. Incubate the tubes at 65 °C for 10 min, repeat vortexing after 
5 min. 
5. After 10 min, add 850 μL ice-cold chloroform:isoamyl alcohol 
and mix it thoroughly by inverting the tube several times very 
gently. 
6. Centrifuge at 10,000 rpm for 10 min at 4 °C. 
7. Label new 2 mL microtubes, pipette 800 μL chloroform:iso-
amyl alcohol into them, and store them on ice.

186
Nikoletta Jaksa-Czotter et al.
8. Pipette the upper phase from step 5 into the prepared micro-
tubes as a second extraction and mix gently but thoroughly by 
inverting the tubes several times (see Note 6). 
9. Centrifuge at 10,000 rpm for 10 min at 4 °C. 
10. Label new 1.5 mL microtubes, pipette 250 μL 9 M LiCl into 
them, and store them on ice. 
11. Transfer the upper phase from step 9 to the LiCl-containing 
microtubes and mix gently but thoroughly by inverting the 
tubes several times. 
12. Incubate the mixture on ice for 30 min. 
13. Centrifuge at 13,000 rpm for 20 min at 4 °C. 
14. Discard the supernatant and pipette 450 μL 65  °C preheated 
SSTE buffer into each tube. 
15. Dissolve the precipitate by vortexing vigorously. Add 450 μL 
chloroform:isoamyl alcohol and mix gently but thoroughly by 
inverting the tubes several times. 
16. Centrifuge at 10,000 rpm for 10 min at 4 °C. 
17. Label new 1.5 mL microtubes and add 280 μL isopropanol and 
30 μL 4 M sodium acetate into them. 
18. Transfer the upper phase from step 16 into the labeled tubes 
and mix gently but thoroughly by inverting the tubes several 
times. 
19. Incubate the mixture for 10 min at room temperature. 
20. Centrifuge at 13,000 rpm for 20 min at 4 °C and discard the 
supernatant. 
21. Wash the pellet with 1 mL ice-cold 70% ethanol and centrifuge 
at 13,000 rpm for 5 min at 4 °C. 
22. Pour off the ethanol and dry the tubes for 10 min and then 
suspend the isolated RNA in 25 μL MilliQ pure water. 
3.3 
sRNA Library 
Preparation 
Library preparation for Illumina sequencing is based on the use of 
the Truseq small RNA kit of Illumina. Enzymes and reagents not 
included in the kit are listed in Subheading 2. According to the kit 
description, libraries can be prepared from 1 μg total RNA; how-
ever, more reads with higher quality can be gained, if the library is 
prepared from gel-puriﬁed sRNA fraction [21] and 10–30 μg total 
RNA. While the quality of the reads depends on the quality of 
RNA, the number of reads (depth of the sequencing) correlates 
with the sequencing equipment used and the number of combined 
libraries. On average, HiSeq produces 240 million reads/cartridge, 
which allows to combine several libraries in a single sequencing unit 
(since there are 48 different indexes available, theoretically a maxi-
mum of 48 samples can be combined). As the number of virus-
derived siRNAs in woody plants is usually low, we do not

recommend combining more than 20–24 libraries in a single car-
tridge. During library preparation 5′ and 3′, adapters are ligated to 
the initial sRNAs. Indexes are positioned on the reverse PCR 
primers as a stretch of six different bases. During sequencing, the 
sequence of this index is determined, and reads are sorted on this 
basis. 
Virus Derived siRNAs for Plant Viromes
187
Table 3 
Steps and timing of sRNA library preparation 
Process
Time 
Puriﬁcation of sRNA fraction from extracted RNA 
PAGE
5–6 h  
Elution with NaCl
Overnight 
Precipitation
2–3 h  
Library preparation 
3′ adapter ligation
2–3 h  
5′ adapter ligation
2–3 h  
Reverse transcription
1–2 h  
PCR ampliﬁcation
1–2 h  
Puriﬁcation of the sRNA library 
PAGE
5–6 h  
Elution with NaCl
Overnight 
Precipitation
2–3 h  
Quality check 
Timing of the processing is reported in Table 3. 
3.3.1 
Puriﬁcation of 
sRNA Fraction from 
Extracted RNA 
1. Prepare 8% TBE denaturing polyacrylamide gel containing 
urea (see Note 7). 
2. Prerun the gel at 100 V for 20–30 min. After prerunning, but 
before loading, wash the wells with 1× TBE buffer. 
3. Mix 10–30 μg of extracted total RNA with an equal volume of 
FDE in a microcentrifuge tube. 
4. Denature the sample at 65 °C for 20 min and then chill on ice 
and spin down brieﬂy. 
5. Load the samples (up to 20 μL/well) and run the gel at 50 V 
until the samples enter into the gel. After that, run the gel at a 
constant voltage of 100 V for 1–1.5 h, until the bromophenol 
blue dye migrates to the bottom of the gel (see Note 8). 
6. Disassemble the gel apparatus and stain the entire gel by soak-
ing in 60 mL 1× TBE buffer containing 3 μL ethidium bromide 
for 5 min. Use a separate container for every single gel to avoid 
cross-contamination. 
7. Visualize the gel on a UV transilluminator.

188
Nikoletta Jaksa-Czotter et al.
8. With a sterile blade, excise the piece of the gel that corresponds 
to the desired size of sRNAs (15–30 nt, usually immediately 
above the bromophenol blue). 
9. Puncture the bottom of a sterile, 0.5 mL microcentrifuge tube 
3–4 times with a 21-gauge needle. Place the 0.5 mL punctured 
tube into a 2 mL microcentrifuge tube. 
10. Place the excised gel slice into the prepared 0.5 mL 
punctured tube. 
11. Centrifuge the microtubes containing the gel slices at full speed 
for 2 min at room temperature. Make sure that all of the gel has 
been passed through the holes into the bottom 2 mL tube. 
12. Remove and discard the 0.5 mL tube and add 350–400 μL 
sterile 0.3 M NaCl to the gel debris. 
13. Shake the tube gently overnight at 4 °C to elute RNAs. 
14. Transfer the eluate and gel debris to a Spin X cellulose acetate 
ﬁlter tube and centrifuge at 6000 rpm for 2 min. Repeat this 
step once more. Remove and discard the Spin X column con-
taining gel debris. 
15. Add an equal volume (approximately 400–500 μL) of 100% 
isopropanol and 1 μL of GlycoBlue to the eluate. Do not 
vortex, mix thoroughly by inverting. 
16. Incubate at -70 °C for at least 2–2.5 h (see Note 9). 
17. Centrifuge the precipitated RNA at full speed at 4 °C for 
20 min. Carefully discard the supernatant and wash the intact 
pellet twice with 1 mL 70% ice cold ethanol (see Note 10). 
18. Allow the RNA pellet to air dry or dry the pellet in a speed vac 
machine for 2–3 min at room temperature. 
19. Resuspend the pellet in 12 μL MilliQ pure water (see Note 11). 
3.3.2 
3′ Adapter Ligation
1. Preheat a thermocycler to 70 °C (see Note 12). 
2. Pipette 2.5 μL puriﬁed sRNAs into a sterile PCR tube on ice 
and add 0.5 μL RNA 3′ adapter (RA3), mix thoroughly, and 
then centrifuge brieﬂy. 
3. Denature the reaction mixture for 2 min at 70 °C in the 
thermocycler and then immediately place the tube on ice. 
4. Preheat a thermocycler to 28 °C. 
5. Pipette 1 μL ligation buffer (HML), 0.5 μL RNase inhibitor, 
and 0.5 μL T4 RNA ligase 2 (truncated) in a sterile PCR tube 
on ice, mix by pipetting up and down several times, and then 
centrifuge brieﬂy.

Virus Derived siRNAs for Plant Viromes
189
6. Add the 2 μL ligation mix (step 5) to the reaction tube from 
step 3. Gently mix the entire volume by pipetting and incubate 
at 28 °C for 1 h. 
7. Terminate the 3′ adapter ligation reaction by adding 0.5 μL 
ice-cold stop solution (STP) and mix by pipetting up and down 
several times. 
8. Continue the incubation at 28 °C for 15 min and ﬁnally place 
the tube on ice. 
3.3.3 
5′ Adapter Ligation
1. Preheat a thermocycler to 70 °C. 
2. Pipette 0.5 μL RNA 5′ adapter (RA5) into a sterile PCR tube 
on ice. Incubate the tube at 70 °C for 2 min and then immedi-
ately place it on ice. 
3. Preheat a thermocycler to 28 °C. 
4. Add 0.5 μL 10 mM ATP and 0.5 μL T4 RNA ligase to the 
denatured 5′ adapter tube from step 2. Total volume is 1.5 μL. 
5. Add 1.5 μL of the 5′ adapter mixture from step 4 to the 3′
adapter reaction tube from Subheading 3.3.2, step 8. 
6. Mix thoroughly by pipetting. The total volume of the reaction 
is now 7 μL. 
7. Place the tube into the preheated thermocycler and incubate at 
28 °C for 1 h and then place the 3′–5′ adapter-ligated reaction 
on ice. 
3.3.4 
Reverse 
Transcription 
1. Preheat a thermocycler to 70 °C. 
2. Combine 1 μL RNA RT Primer (RTP) and 7 μL 3′–5′ adapter-
ligated reaction (Subheading 3.3.3, step 7). 
3. Gently pipette the entire volume up and down to mix thor-
oughly, place it to 70 °C for 2 min, and then place the tube 
on ice. 
4. Preheat a thermocycler to 50 °C. 
5. Set up the RT reaction mixture by pipetting 1 μL ultrapure 
water, 2 μL 5× reaction buffer, 0.5 μL 12.5 mM dNTP mix, 
1 μL RNase inhibitor and 1 μL Revert Aid H- reverse transcrip-
tase into a sterile PCR tube on ice, mix by pipetting up and 
down several times, and then centrifuge brieﬂy. 
6. Add this 5.5 μL RT reaction mixture to the 3′–5′ adapter-
ligated/primer reaction mix from step 3, mix by pipetting up 
and down several times, and then centrifuge brieﬂy. The total 
volume of RT reaction is now 12.5 μL. 
7. Incubate the RT reaction at 50 °C for 1 h and then place the 
cDNA-containing tube on ice (see Note 13).

190
Nikoletta Jaksa-Czotter et al.
3.3.5 
PCR Ampliﬁcation
1. Set up the PCR reaction mixture in a separate, sterile PCR tube 
on ice by pipetting 4.25 μL MilliQ pure water, 12.5 μL PCR 
mix (PML), 1 μL RNA PCR primer (RP1), and 1 μL RNA PCR 
primer index (RPIX) (see Note 14). 
2. Mix the reaction by pipetting up and down several times, 
centrifuge brieﬂy, and then place the tube on ice. 
3. Add 6.25 μL cDNA from Subheading 3.3.4, step 7 into the 
PCR reaction mixture. The total volume is now 25 μL. 
4. Pipette the entire volume up and down gently to mix thor-
oughly, centrifuge brieﬂy, and then place the tube on ice. 
5. Denature the reaction in a thermocycler for 30 s at 98 °C, then 
in 16 cycles amplify the libraries applying 10 s at 98 °C for 
denaturation, 30 s at 60 °C for annealing and 15 s at 72 °C for 
elongation. Finalize the reaction by incubating the reaction 
mixture for 10 s at 72 °C. 
6. The ampliﬁed sRNA library is now ready for puriﬁcation (see 
Note 15). If you do not plan to proceed to the puriﬁcation of 
sRNA library immediately, the protocol can be safely stopped 
here. Store the samples at -15 to -25 °C. 
3.3.6 
Puriﬁcation of 
sRNA Library 
1. Prepare 8% TBE polyacrylamide gel (see Note 16). 
2. Prerun the gel at 100 V for 20–30 min. After prerunning but 
before loading, wash the wells with 1× TBE buffer. 
3. Mix the 25 μL PCR ampliﬁcation product with 5 μL 6× Orange 
DNA loading dye. The total volume is now 30 μL. 
4. Load two different size markers, a 20 bp DNA ladder and a 
50 bp low molecular weight ladder in the two outermost wells 
(one on each side of the gel). 
5. Load the ampliﬁed PCR product from Subheading 3.3.5, step 
6. in the middle of the gel into two consecutive wells (15 μL/ 
well). 
6. Run at 50 V until the samples enter into the gel from the wells. 
After that, run the gel at a constant voltage of 100 V for 
1.5–2 h, until the xylene cyanol dye migrates to the bottom 
of the gel. 
7. Disassemble the gel apparatus and stain the entire gel by soak-
ing in 60 mL 1× TBE buffer containing 3 μL ethidium bromide 
for 5 min (see Note 17). 
8. Puncture the bottom of a sterile, 0.5 mL microcentrifuge tube 
3–4 times with a 21-gauge needle. Place the 0.5 mL punctured 
tube into a 2 mL microcentrifuge tube. 
9. Visualize the size marker and the ampliﬁed sRNA library on a 
UV transilluminator.

Virus Derived siRNAs for Plant Viromes
191
10. Excise the piece of the gel that corresponds to the desired size 
(140–145 bp) of sRNA library (see Note 18). 
11. Place the gel slice into the prepared 0.5 mL tube from step 8. 
12. Centrifuge at full speed for 4 min at room temperature. Make 
sure that all the gel has moved through the holes into the 
bottom 2 mL tube. 
13. Remove and discard the 0.5 mL punctured tube and add 
350–400 μL sterile 0.3 M NaCl to the gel debris. 
14. Shake the tube gently overnight at 4 °C to elute DNA. 
15. Transfer the eluate and gel debris to a Spin X cellulose acetate 
ﬁlter tube and centrifuge at 6000 rpm for 2 min. Repeat this 
step once more. Remove and discard the Spin X column con-
taining gel debris. 
16. Add 1 μL GlycoBlue and 1 mL 100% ethanol to the eluate. Do 
not vortex, mix thoroughly by inverting. 
17. Precipitate the library by incubating at -70 °C for at least 
2–2.5 h (see Note 19). 
18. Centrifuge the precipitate at full speed at 4 °C for 20 min. 
Carefully discard the supernatant and wash the intact pellet 
twice with 1 mL 70% cold ethanol (see Note 20). 
19. Allow the RNA pellet to air dry or dry the pellet in a speed vac 
machine for 2–3 min at room temperature. 
20. Resuspend the pellet in 12 μL sterile 1× TE resuspension 
buffer. 
21. The pure sRNA library is now ready for sequencing but can be 
stored at -20 °C or -70 °C for a longer period of time. 
3.4 
Sequence the 
Prepared Libraries 
Using Illumina 
Platform 
Sequencing service can be ordered from different companies (see 
Note 21). A volume of 50 nt long sequencing is enough for sRNA 
library sequencing. As a result, you can expect a compressed fastq. 
gz ﬁle. When unzipped, it contains all of the sequenced reads 
together with information of their sequencing quality. When you 
order the sequencing service of several different libraries using 
different indexes, the company directly demultiplexes the reads 
and sends the fastq ﬁles separately for each single library. 
3.5 
Bioinformatics 
Analysis of sRNA 
Reads 
For bioinformatics analysis, different options can be used. For users 
without previous practice, analyses using CLC Genomic Work-
bench (Qiagen) and Geneious Prime are the best options. In the 
protocol, here, we will detail the steps of the pipeline based on CLC 
Genomic workbench (Fig. 1, Table 4).
3.5.1 
Bioinformatics 
Analysis of Sequenced 
sRNA Reads
1. Import the fastq ﬁle into the CLC program. Trim the adapters 
and the reads with low quality using the Trim reads tool (tool-
box/prepare sequencing data). It ﬁnds and cuts adapters from

the ends of the reads and discards the reads with low quality (see
Note 22).
192
Nikoletta Jaksa-Czotter et al.
Fig. 1 Schematic diagram of the bioinformatics pipeline 
2. Check the size of the trimmed reads using the QC report 
option during trimming. Export the resulting Trim report ﬁle 
into excel format. This ﬁle will contain all data for size distribu-
tion analysis (see Note 23). 
3. Prepare list of nonredundant reads using Extract and count 
(legacy) tool (toolbox/microarray and small RNA analysis). 
Keep all reads (set minimum count to 1) and create a report 
for each sample. As a result, you will get two ﬁles, one contain-
ing a list of unique sequence together with their expression 
(count number) and a quality report including size distribution 
data of the nonredundant reads (see Note 24). 
4. Assemble the nonredundant reads into contigs, using the CLC 
inbuilt algorithm: De Novo Assembly tool (toolbox/de novo 
sequencing) (see Note 25). Use default parameters but keep 
only contigs longer than 35 nt. 
5. Annotate the resulting contigs with blastn algorithm with 
default options (thread 1, word size 11, match 2, mismatch 
3, gap cost existence 5, and extension 2) using BLAST tool

(toolbox/BLAST) and reference genomes of plant viruses
obtained from NCBI (see Note 26). Consider virus hits with
E-value lower than 10-5. This table can be exported as an
CLC tool
Program description
Information gained
Virus Derived siRNAs for Plant Viromes
193
Table 4 
Bioinformatics tools of CLC genomic workbench used in the pipeline of bioinformatic analysis of 
sRNA reads 
Pipeline 
step 
1
Trim reads
Cuts adapters and remove low 
quality reads 
Number of reads before and after 
trimming 
2
QC report
Statistical analysis of the trimmed 
reads 
Basic statistics and size distribution 
of the sequenced reads 
3
Extract and 
count (legacy) 
Removes duplicates, keeps only one 
read with the same sequence 
List of all unique small RNA reads 
with their hit number and size 
distribution of the nonredundant 
reads 
4
De novo 
assembly 
De novo assembly of reads into 
longer contigs 
List of contigs which can be used for 
the further analysis 
5
BLAST
Annotation of the contigs to the 
database chosen (Reference 
Genome of the Plant hosted 
viruses) downloaded from the 
NCBI 
List of viral hits in a table format, 
containing the E value referring 
the validity of the hit 
6
Map reads to 
Reference 
Map the reads to viral reference 
genomes 
Number and position of the reads 
mapped to the reference genomes 
Number of mapped redundant and 
nonredundant reads 
7
Extract 
consensus 
sequence 
Consensus sequences are prepared 
Consensus sequence of the viruses 
containing N where no 
information could be gained from 
the sequenced sRNAs 
8
Sequence 
statistics 
(of the 
consensus 
sequence) 
Basic statistics of any investigated 
sequence 
Coverage of the detected virus in % 
excel ﬁle. 
Arrange the contig hits according to virus names and count 
all of the contigs blasted to the same reference/virus (see 
Note 27). 
6. Map the trimmed reads with and without redundancy (redun-
dant and nonredundant reads) to all the virus genomes for 
which you got any hit during contig blast, using the Map 
reads 
to 
Reference 
tool 
(toolbox/resequencing 
analysis)

194
Nikoletta Jaksa-Czotter et al.
Fig. 2 Arrangement of a virus diagnostics result table with hypothetical values 
allowing 1 mismatch (see Note 28). Calculate the number of 
normalized virus speciﬁc reads (read/1 million reads—RPM) 
as a ratio of mapped redundant reads and the numbers 
(in million) of total sequenced reads. 
7. Create a consensus sequence of every detected virus using 
Extract the Consensus Sequence (toolbox/resequencing analy-
sis) from the reads mapped to the reference genome. As an 
output, you will get a nucleotide sequence in the same length as 
the viral reference genome was, with sequence information 
only for positions from which sRNAs were generated (see 
Note 29). 
8. Calculate the coverage of the viral genome by sRNA reads in %. 
This can be calculated from the consensus sequences prepared 
at the previous step. Analyze the consensus sequence using the 
Create Sequence Statistics tool (toolbox/classical sequence anal-
ysis/general sequence analysis). Divide the number of posi-
tions with sequence information by the number of nucleotide 
length of the genome and multiply it with 100 to get the 
coverage in %. 
3.5.2 
Summarizing 
Bioinformatics Results for 
Virus Diagnostics 
1. Arrange results from bioinformatics analysis in a score table 
(Fig. 2). 
For the highest probability of virus presence, three para-
meters have to reach the threshold: Presence of at least one 
assembled contig (to any segment of the virus), high amount of 
redundant normalized reads >200 and genome coverage 
>20%. If any of these parameters is below threshold, the prob-
ability of virus presence and the possibility to verify its presence 
by RT-PCR decrease. 
2. For ﬁnal diagnostics, it is recommended to verify the virus 
presence by RT-PCR using diagnostic primers (see Note 30). 
3. If veriﬁcation by RT-PCR fails, design new primers based on 
comparison of the available viral genomes in the database and 
the consensus sequence generated at Subheading 3.5.1, step 7. 
(the most probable sequence of the strain present in the 
sample).

Virus Derived siRNAs for Plant Viromes
195
4 
Notes 
1. It is advisable to take photos of each sampled plant, because it 
can give important information later. 
2. If you pack leaves, pack each leaf individually and do not cut 
them in half, because this damage can activate RNases and 
other degrading processes. 
3. If a relatively large (more than 100 mg) leaf was packed, use 
only a small part of it for RNA extraction. 
4. CTAB powder could cause irritation and therefore make the 
solution under a fume hood. 
5. β-mercaptoethanol is not only malodorous but also can cause 
irritations; therefore, it is strongly advisable to use it under the 
fume hood. 
6. If working with lots of samples, labeling microtubes and pipet-
ting everything needed for the consecutive step can be done in 
advance to shorten the time of sample handling and further 
minimizing the possibility of the degradation of the sample. 
7. It is recommended to prepare a separate gel for each library to 
avoid cross-contamination. 
8. If the concentration of the extracted RNA is low, to avoid using 
more wells, concentrate the sample by an additional ethanol 
precipitation of RNA. 
9. Precipitated RNA can also be kept at -20 °C overnight. 
10. Use of GlycoBlue can help not to discard the pellet accidentally. 
11. The isolated sRNA sample should be stored at -70 °C. 
12. Using a PCR machine as a thermoblock ensures precise main-
tenance of the desired temperature. 
13. The cDNA prepared here can be stored at -20 °C, if it is not 
directly processed further. 
14. Take special care using different indexes for libraries which are 
planned to be sequenced combined in a single sequencing unit. 
15. The number of cycles can be increased up to 21, if a very small 
amount of starting material was used. 
16. It is recommended to prepare a separate gel for each library to 
avoid cross-contamination. 
17. Use a separate container for staining each gel to avoid cross-
contamination. 
18. The exact size of the PCR product depends on the length of 
the cloned sRNA and the Illumina adapters used. 
19. Precipitation can also take place overnight at -20 °C. 
20. Use of GlycoBlue can help not to discard the pellet accidentally.

196
Nikoletta Jaksa-Czotter et al.
21. Not only the price and the deadline of sequencing, but also the 
resulting quality and the number of sequenced reads can be 
different for different companies. It depends on the type of 
sequencing machine used and also on experience. 
22. Compare the lengths of the reads before and after trimming 
and note that before trimming, it reﬂects the ordered sequenc-
ing length, while after trimming, it shows the distribution of 
the cloned sRNAs. 
23. Size of the sequenced reads should be 20–25 nt long. Size 
distribution can vary but usually shows peaks at 21 nt and 
24 nt, as these are the main DICER products [8]. Reads 
showing no peaks in the size distribution and smaller size 
indicate RNA degradation before library preparation. In this 
case, use the results with precautions. 
24. In contrast to miRNAs, which are produced in high (even 
million) copies, viral siRNAs are produced as a population of 
different reads originating from different parts of the viral 
genome, so even one count can add information that can be 
used later in the analysis. This list exported as a text ﬁle can be 
uploaded to the GEO (Gene Expression Omnibus database) 
during the deposition process. 
25. In trimmed sRNA libraries, one read can be present several 
times. Before contig building, it is advisable to remove dupli-
cates to minimize the number of reads, which reduces 
processing time. 
26. To have the most up to date results, download the reference 
genome database just before the analysis and keep it updated. 
Please note the date when the database was downloaded from 
NCBI. Keep this record and cite when needed. 
27. For viruses having fragmented genomes, represented by differ-
ent reference genomes at NCBI GenBank, contigs hits will be 
found to any or to all of their genomes. Blast hits of the contig 
to only one segment should be taken into consideration as well. 
28. You can map your reads to any sequences that you deﬁne to see 
which reads match the given (genome) sequences. It is advis-
able to do this map to the reference for viruses which are 
known to infect the investigated plant species, but because 
described recently, having no ICTV approved reference. 
29. The prepared consensus sequences can be used later during 
virus variant speciﬁc PCR primer design to ensure that the 
primers will perfectly be complementary to the variant present 
in the sample. 
30. If one of the three parameters is below the requirements, the 
probability of the presence of the virus drops, but the thresh-
olds depend on both the particular virus and the host.

Virus Derived siRNAs for Plant Viromes
197
Acknowledgments 
Our work was supported by the National Research, Development, 
and Innovation Ofﬁce: K 127951, K134895, and PD137621. 
Almash Jahan is supported by Stipendium Hungaricum of Tempus. 
Almash Jahan and Emese Demia´n are PhD students at MATE, of 
the Doctoral School of Plant Sciences and Biological Sciences, 
respectively. 
The authors acknowledge the contribution of the COST Action FA 
1407—DIVAS 
(Deep 
Investigation 
of 
Virus 
Associated 
Sequences). 
References 
1. Navarro B, Pantaleo V, Gisel A et al (2009) 
Deep 
sequencing 
of 
viroid-derived 
small 
RNAs from grapevine provides new insights 
on the role of RNA silencing in plant-viroid 
interaction. PLoS ONE 4(11):e7686. https:// 
doi.org/10.1371/journal.pone.0007686 
2. Pantaleo V, Saldarelli P, Miozzi L et al (2010) 
Deep sequencing analysis of viral short RNAs 
from an infected Pinot Noir grapevine. Virol-
ogy 408(1):49–56. https://doi.org/10.1016/ 
j.virol.2010.09.001 
3. Giampetruzzi A, Roumi V, Roberto R et al 
(2012) A new grapevine virus discovered by 
deep sequencing of virus- and viroid-derived 
small RNAs in Cv Pinot gris. Virus Res 
163(1):262–268. https://doi.org/10.1016/j. 
virusres.2011.10.010 
4. Massart S, Olmos A, Jijakli H, Candresse T 
(2014) Current impact and future directions 
of high throughput sequencing in plant virus 
diagnostics. Virus Res 188:90–96. https://doi. 
org/10.1016/j.virusres.2014.03.029 
5. Baulcombe D (2004) RNA silencing in plants. 
Nature 431(7006):356–363. https://doi.org/ 
10.1038/nature02874 
6. Pecman A, Kutnjak D, Gutie´rrez-Aguirre I et al 
(2017) Next generation sequencing for detec-
tion and discovery of plant viruses and viroids: 
comparison of two approaches. Front Micro-
biol 8. https://doi.org/10.3389/fmicb.2017. 
01998 
7. Santala J, Valkonen JPT (2018) Sensitivity of 
small RNA-based detection of plant viruses. 
Front Microbiol 9 
8. Pooggin MM (2018) Small RNA-omics for 
plant virus identiﬁcation, virome reconstruc-
tion, and antiviral defense characterization. 
Front Microbiol 9. https://doi.org/10. 
3389/fmicb.2018.02779 
9. Velasco 
L, 
Padilla 
CV 
(2021) 
High-
throughput sequencing of small RNAs for the 
sanitary certiﬁcation of viruses in grapevine. 
Front Plant Sci 12. https://doi.org/10. 
3389/fpls.2021.682879 
10. Lebas B, Adams I, Al Rwahnih M et al (2022) 
Facilitating the adoption of high-throughput 
sequencing technologies as a plant pest diag-
nostic 
test 
in 
laboratories: 
a 
step-by-step 
description. 
EPPO 
Bull 
52(2):394–418. 
https://doi.org/10.1111/epp.12863 
11. Massart S, Adams I, Al Rwahnih M et al (2022) 
Guidelines for the reliable use of high through-
put sequencing technologies to detect plant 
pathogens 
and 
pests. 
Peer 
Commun 
J 
2. https://doi.org/10.24072/pcjournal.181 
12. Czotter N, Molnar J, Szabo´ E et al (2018) 
NGS of virus-derived small RNAs as a diagnos-
tic method used to determine viromes of Hun-
garian vineyards. Front Microbiol 9. https:// 
doi.org/10.3389/fmicb.2018.00122 
13. Demian E, Jaksa-Czotter N, Molnar J et al 
(2020) Grapevine rootstocks can be a source 
of infection with non-regulated viruses. Eur J 
Plant Pathol 156(3):897–912. https://doi. 
org/10.1007/s10658-020-01942-w 
14. Barath D, Jaksa-Czotter N, Varga T, Varallyay 
E (2022) Viromes of Hungarian peach trees 
identiﬁed by high-throughput sequencing of 
small RNAs. Plants 11(12):1591 
15. Va´rallyay E, Prˇibylova´ J, Galbacs ZN et al 
(2022) 
Detection 
of 
Apple 
hammerhead 
viroid, Apple Luteovirus 1 and Citrus Concave 
gum-associated virus in apple propagation 
materials and orchards in the Czech Republic 
and Hungary. Viruses 14(11):2347 
16. Szabo´ A-K, Va´rallyay E´ , Demian E et al (2020) 
Local aphid species infestation on invasive 
weeds affects virus infection of nearest crops 
under 
different 
management 
systems 
– 
a

198
Nikoletta Jaksa-Czotter et al.
preliminary study. Front Plant Sci 11. https:// 
doi.org/10.3389/fpls.2020.00684 
17. Pasztor G, Galbacs NZ, Kossuth T et al (2020) 
Millet could be both a weed and serve as a virus 
reservoir in crop ﬁelds. Plants 9(8):954 
18. Massart S, Chiumenti M, De Jonghe K et al 
(2019) Virus detection by high-throughput 
sequencing of small RNAs: large-scale perfor-
mance testing of sequence analysis strategies. 
Phytopathology 109(3):488–497. https://doi. 
org/10.1094/phyto-02-18-0067-r 
19. White JL, Kaper JM (1989) A simple method 
for detection of viral satellite RNAs in small 
plant 
tissue 
samples. 
J 
Virol 
Methods 
23(2):83–93. https://doi.org/10.1016/ 
0166-0934(89)90122-5 
20. Gambino G, Perrone I, Gribaudo I (2008) A 
rapid and effective method for RNA extraction 
from different tissues of grapevine and other 
woody
plants.
Phytochem
Anal 
19(6):520–525. https://doi.org/10.1002/ 
pca.1078 
21. Nagy T, Kis A, Poliska S et al (2016) [Letter to 
the Editor] Comparison of small RNA next-
generation sequencing with and without isola-
tion of small RNA fraction. BioTechniques 
60(6):273–278. https://doi.org/10.2144/ 
000114423

Chapter 14 
Validation of High-Throughput Sequencing (HTS) for Routine 
Detection of Citrus Viruses and Viroids 
Rachelle Bester and Hans J. Maree 
Abstract 
The management of plant diseases relies on the accurate identiﬁcation of pathogens that requires a robust 
and validated tool in terms of speciﬁcity, sensitivity, repeatability, and reproducibility. High-throughput 
sequencing (HTS) has become the method of choice for virus detection when either a complete viral status 
of a plant is required in a single assay or if an unknown viral agent is expected. To ensure that the most 
accurate diagnosis is made from an HTS data analysis, a standardized protocol per pathosystem is required. 
This chapter presents a detailed protocol for the detection of viruses and viroids infecting citrus using HTS. 
The protocol describes all the steps from sample processing, nucleic acid extraction, and bioinformatic 
analyses validated to be an efﬁcient method for detection in this pathosystem. The protocol also includes a 
section on citrus tristeza virus (CTV) genotype differentiation using HTS data. 
Key words Next-generation sequencing (NGS), Bioinformatics, Citrus tristeza virus (CTV), Hop 
stunt viroid, Citrus dwarﬁng viroid, Citrus exocortis viroid, Citrus virus A 
1 
Introduction 
High-throughput sequencing (HTS) has been increasingly used for 
the construction of virome proﬁles of many different plant species. 
This led to the detection and discovery of many new viruses and 
viroids or the identiﬁcation of new virus hosts or geographical 
regions [1–16]. These previous studies highlight the main advan-
tage of HTS, which is that it enables the simultaneous detection 
and identiﬁcation of any organisms present in a sample including 
diverse variants and unknown pathogens. The success of HTS in 
detecting all these new pathogens, the decrease in sequencing cost, 
and the accessibility of bioinformatic tools to analyze the HTS data 
facilitated the movement to also use HTS for routine diagnostics. 
This growing interest sparked the realization that guidelines are 
needed to ensure the successful implementation of HTS including 
all the steps from sample processing to the bioinformatic analyses
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_14, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
199

[17, 18]. The need to validate HTS as a robust assay to the same 
level as any other molecular assay remains one of the leading 
challenges for any plant health laboratory [19–23]. For HTS to 
be an effective routine detection tool, it needs to be validated as a 
sensitive, speciﬁc, repeatable, and reliable assay for a speciﬁc host-
pathogen system. Many countries are also investigating how to best 
apply HTS in certiﬁcation programs to allow the early propagation 
of uninfected plant material without adding risk [21, 24–27]. In a 
previous study, HTS was evaluated as a routine detection tool for 
viruses and viroids infecting citrus [21, 26, 28]. The ability of HTS 
to meet all the validation criteria was assessed by using multiple 
RNA extractions methods, biological and technical replicates, dif-
ferent HTS platforms, and multiple data analysis strategies.
200
Rachelle Bester and Hans J. Maree
Here a detailed protocol is provided for the detection of viruses 
and viroids infecting citrus using HTS. The protocol describes all 
the steps from sample processing, nucleic acid extraction, and 
bioinformatic analyses validated to be an efﬁcient method for detec-
tion in these pathosystems. The protocol also includes a section on 
citrus 
tristeza 
virus 
(CTV) 
genotype 
differentiation 
using 
HTS data. 
2 
Materials 
2.1 
Total RNA 
Extractions 
1. Bioreba universal extraction bag. 
2. CTAB buffer: 2% CTAB, 2.5% PVP-40, 100 mM Tris–HCL 
pH8, 2 M NaCl, and 25 mM EDTA pH 8. 
3. β-mercaptoethanol. 
4. Bioreba homogenizer. 
5. Aluminum block. 
6. Paperclips. 
7. 65 °C water bath. 
8. 2 mL sterile microcentrifuge tubes. 
9. Chloroform:isoamyl alcohol (C:I) (premixed in a 24:1 ratio). 
10. 8 M LiCl. 
11. 70% ethanol. 
12. Milli-Q water (18.2 MΩ·cm). 
13. 4 °C Benchtop centrifuge. 
14. Agarose. 
15. 1X TAE: 40 mM Tris–HCl, 20 mM acetic acid, 1 mM EDTA. 
16. DNA molecular marker (GeneRuler 1 kb ladder). 
17. 6X DNA loading dye.

HTS Detection of Citrus Viruses and Viroids
201
18. NanoDrop spectrophotometer. 
19. Quick-RNA Plant Miniprep Kit (see Note 1). 
20. Optional: Bioanalyzer. 
2.2 
Library 
Construction and 
Sequencing 
1. Illumina TruSeq Stranded Total RNA Ribo-Zero Plant kit 
(Reagents and materials required are listed in the manufac-
turer’s instructions) (see Note 2). 
2. Illumina sequencing platform (HiSeq, NextSeq, and NovaSeq) 
(see Note 3). 
2.3 
Bioinformatics
1. Hardware: Access to a high-performance computer (HPC) is 
recommended for all command line tools (see Note 4). Other-
wise refer to speciﬁc software performance recommendations. 
2. Software: Data quality viewing tool (FastQC), data quality 
ﬁltering/trimming tool (Trimmomatic), de novo assembler 
(SPAdes), contig identiﬁcation tool (BLAST+ standalone), 
read mapping tool (BWA), and a sam format editing tool 
(Samtools). 
3. Databases: A local copy of the NCBI GenBank nucleotide 
database (see Note 5), a citrus virus and viroid nucleotide 
database (see Note 6), a citrus reference gene nucleotide data-
base (in this case Citrus sinensis), and a database containing 
different CTV genotype sequences. 
3 
Methods 
3.1 
Sample 
Preparation 
Collect green shoots or leaves from a potentially infected citrus tree 
(see Note 7). The plant material can be stored at 4 °C for up to a 
week. The bark containing the phloem layer can be sampled by 
peeling it from the shoot, and the leaf petiole and main vein can be 
sampled from the leaves for the detection of phloem-limited RNA 
viruses like CTV. Once the bark layer has been removed, the sample 
must be stored at -20 °C until required for the RNA extraction. 
3.2 
Total RNA 
Extraction 
Total RNA is extracted using a CTAB protocol [29] with some 
modiﬁcations listed below or using the Quick-RNA Plant Miniprep 
Kit (see Note 1). High-quality RNA is needed for HTS, and RNA 
integrity should be analyzed using gel electrophoresis and a bioa-
nalyzer. Spectrophotometry (NanoDrop) can be used to determine 
the RNA purity and concentration. A260/A280 and A260/A230 
ratios above 1.9 will ensure successful library construction. 
1. Prepare the CTAB buffer and add 3% β-mercaptoethanol to the 
CTAB buffer before use. 
2. Add 1 g of plant material to a Bioreba universal extraction bag.

202
Rachelle Bester and Hans J. Maree
3. Add 15 mL CTAB buffer (with 3% β-mercaptoethanol) to the 
extraction bag. 
4. Grind plant material with homogenizer on aluminum block. 
5. Close bag by folding twice and secure with paperclip. 
6. Incubate at 65 °C for 30 min. 
7. Add 500 μL C:I (premixed in a 24:1 ratio) to a 2 mL 
microcentrifuge tube. 
8. Decant liquid from the Bioreba extraction bag into the 2 mL 
microcentrifuge tube containing the C:I to maximum capacity. 
9. Mix the microcentrifuge tube contents with vigorous shaking. 
10. Centrifuge at 4 °C at 16,000× g for 10 min and transfer +/-
1300 μL supernatant to a new 2 mL microcentrifuge tube (see 
Note 8). 
11. Add 500 μL C:I to the 
aqueous phase, mix with vigorous 
shaking, and spin down for 10 min at 4 °C at 16,000× g. 
12. Transfer 1000 μL of the aqueous phase to a new 2 mL 
microcentrifuge. 
13. Add 333 μL, 8 M LiCl (Final concentration 2 M). 
14. Incubate at 4 °C for 60 min. 
15. Centrifuge at 4 °C at 16,000× g for 60 min. 
16. Discard supernatant and add 500 μL 70% ethanol to wash the 
pellet. 
17. Centrifuge at 4 °C at 16,000× g for 10 min. 
18. Aspirate ethanol and air-dry the pellet for 10 min. 
19. Resuspend the pellet in 30 μL Milli-Q water (18.2 MΩ·cm). 
20. Determine purity and concentration of RNA using a Nano-
Drop spectrophotometer. 
21. Use gel electrophoresis to assess integrity of RNA: Load 1 μg of  
RNA with 6X DNA loading dye on a 1% agarose-TAE gel and 
run at 100 V for 60 min. Visualize the gel on a UV transillu-
minator. The 18S and 28S ribosomal RNA bands should be 
clearly visible without signs of degradation. 
22. Optional: BioAnalyzer can be used to assess the RNA quality 
(see Note 9). 
23. Store RNA at -80 °C until preparations for shipping are made 
(see Note 3). 
3.3 
HTS Library 
Construction and 
Sequencing 
The Illumina platform and the TruSeq Stranded Total RNA Ribo-
Zero Plant kit perform satisfactory for the detection of citrus 
viruses and viroids. The methods for library construction are listed 
in the TruSeq Stranded Total RNA Ribo-Zero Plant kit (Illumina) 
instruction manual (https://support.illumina.com/content/dam/

illumina-support/documents/documentation/chemistry_docu 
mentation/samplepreps_truseq/truseq-stranded-total-rna-
workﬂow/truseq-stranded-total-rna-workﬂow-reference-
1000000040499-00.pdf). 
HTS Detection of Citrus Viruses and Viroids
203
For the accurate detection of citrus virus and viroids, at least 
ﬁve million reads per sample are required [21] (see Note 10). 
3.4 
Bioinformatic 
Data Analyses 
The bioinformatic analyses need to commence with data quality 
assessment to ensure that only data with a low error rate are used for 
downstream analyses. FastQC is a tool to assess the data quality and 
the presence of contaminating sequences. Even if the sequencing 
service provider provides basic sequence quality control, it is 
recommended to visualize the data in FastQC. 
3.4.1 
Data Quality 
Control 
Important modules to evaluate include: 
1. Per base sequence quality: Visualize where the mean quality 
drops off to determine if a hard trim (deletion of a speciﬁc 
number of nucleotides from the 5′ or 3′ end of all reads) from a 
speciﬁc nucleotide is required. 
2. Per base sequence content: Indicate whether an imbalance in 
nucleotide compositions is present in the reads to determine if 
a hard trim is required. 
3. Overrepresented sequences: Useful to identify sequences that 
are overexpressed like the presence of adapter sequences at the 
end of reads. 
4. Adapter content: The Illumina adapter sequences are included 
in the FastQC framework, and if any universal adapter 
sequences are present in the reads, this module will indicate it 
automatically. 
After the visualization of the data in FastQC, Trimmomatic is 
used to ﬁlter and/or trim data to retain the higher quality bases. 
Trimmomatic retains the paired-end nature of the reads and pro-
vides, as output, paired-end ﬁles and the single end read ﬁles for the 
reads that lost its pair due to low quality. Trimmomatic performs 
the options speciﬁed in the command line from left to right, and 
therefore, it is important to follow the following order: 
1. Trimming of adapters is performed using the ILLUMINA-
CLIP option with default parameters. 
2. A quality trim is performed using the SLIDINGWINDOW 
option with a window size of 3 and an average quality of 20. 
3. Only reads longer than 20 nucleotides are retained using the 
MINLEN option. 
Trimmomatic is run in command line on an HPC with 
20 threads and 48 Gb memory availability (see Note 11). The

input ﬁles for the Trimmomatic run are the raw fastq ﬁles provided 
by the sequencing service provider. 
204
Rachelle Bester and Hans J. Maree
An example of the recommend Trimmomatic run command is 
provided in the following: 
java
-jar 
trimmomatic-0.36.jar 
PE 
file1.fastq 
file2.fastq 
file1_trim_paired.fastq 
file1_ 
unpaired.fastq 
file2_trim_paired.fastq 
file2_ 
unpaired.fastq 
ILLUMINACLIP:TruSeq3-PE.fa:2:30:10 
SLIDINGWINDOW:3:20 MINLEN:20 
3.4.2 
De Novo Assembly
The recommended program for de novo assembly is SPAdes with 
default parameters. SPAdes is run in command line on an HPC with 
40 threads and 100 Gb availability (see Note 11). The input ﬁles for 
the SPAdes run are the Trimmomatic paired output ﬁles. 
An example of the recommend SPAdes run command is 
provided in the following: 
spades.py
-1 
file1_trim_paired.fastq
-2 
file2_ 
trim_paired.fastq -o SPAdes_output_folder 
3.4.3 
Contig or Scaffold 
Annotation 
The BLAST+ standalone version is used to annotate the SPAdes 
assembled contigs or scaffolds depending if single or paired-end 
data were used. The BLASTn algorithm can be used for the ﬁrst 
round of contig/scaffold identiﬁcation using a local copy of 
NCBI’s nucleotide database as subject to search against (see Note 
5). 
It is recommended that the BLAST hits that will be written to 
the results ﬁle have a cut-off e-value of 0.001 and the number of 
aligned sequences to keep is 1. The standard tabular output, includ-
ing query length, subject title, and query coverage, produces a 
result that is easy to interpret. 
BLASTn is run in command line on an HPC with 40 threads 
availability (see Note 11). The input ﬁle for the BLASTn run is in 
the SPAdes output folder (contigs.fasta or scaffolds.fasta). 
An example of the recommended BLASTn run command is 
provided in the following: 
blastn
-db 
nt
-query 
SPAdes_output_folder/ 
scaffolds.fasta
-out 
blastn_results.txt
-evalue 
0.001 -max_target_seqs 1 -outfmt "6 std qlen stitle 
qcovs" 
The tab-delimited BLASTn output ﬁle will have the following 
columns: qseqid, sseqid, pident, length, mismatch, gapopen, 
qstart, qend, sstart, send, evalue, bitscore, qlen, stitle, and qcovs 
(see 
https://www.ncbi.nlm.nih.gov/books/NBK279684/ 
for

more detail). The title column will contain the sequence descrip-
tion with which virus and viroid contigs can be identiﬁed (see Note 
12) 
HTS Detection of Citrus Viruses and Viroids
205
The next step will include ﬁltering the SPAdes “scaffolds.fasta” 
ﬁle for all the contigs that had a BLASTn hit to obtain a new fasta 
ﬁle with the contig sequences that were not annotated in the ﬁrst 
analysis. 
1. Convert the original 60 character per line “scaffolds.fasta” ﬁle 
to a fasta ﬁle with the whole sequence string in one line using 
the following linux command: 
awk ’!/^>/ { printf "%s", $0; n = "\n" } /^>/ { print 
n $0; n = "" } END { printf "%s", n }’ scaffolds. 
fasta > contigs_oneline.fasta 
2. Create a tabular ﬁle from the original “scaffolds.fasta” ﬁle 
(column 1 has contig name/header and column 2 has the 
sequence string) using the following linux command: 
awk 
’BEGIN{RS=">";OFS="\t"}NR>1{print 
$1,$2}’ 
contigs_oneline.fasta > contigs_online_tab.txt 
3. Create a list of only the contig names using the following linux 
command: 
cut -f 1 contigs_online_tab.txt > contigs_names.txt 
4. Create a list of the contig names that had a BLASTn hit, sort 
the list, and only retain the unique names using the following 
linux command: 
cut
-f 
1 
blastn_results.txt 
| 
sort 
| 
uniq 
> 
blastn_results_name_list.txt 
5. Compare the BLASTn contig name list to the original contig 
name list and retain only the contig names that are not in both 
list (i.e., the contig names without a BLASTn annotation) 
using the following linux command:

206
Rachelle Bester and Hans J. Maree
cat 
blastn_results_name_list.txt 
| 
comm
-31
-
contigs_names.txt > no_blastn_hit_name_list.txt 
6. Create a new fasta ﬁle with only the contig sequences with no 
BLASTn hit using the following linux command: 
grep
-w
-F
-A 
1
-f 
no_blastn_hit_name_list.txt 
contigs_oneline.fasta 
>> 
Contigs_nohits_blastn. 
fasta 
7. Remove the lines with the “--” using the following linux 
command: 
sed ’/--/d’ Contigs_nohits_blastn.fasta > Contigs_ 
nohits_blastn2.fasta 
The contigs that had no BLASTn in the ﬁrst round can now be 
subjected to a second BLASTn analyses against a local database 
(https://www.ncbi.nlm.nih.gov/books/NBK569856/) 
created 
using the latest virus nucleotide sequences in the NCBI viral 
Browser (https://www.ncbi.nlm.nih.gov/labs/virus/vssi/#/ 
virus?SeqType_s=Nucleotide) (see Note 13). This will potentially 
identify more viral contigs but should also be curated for validity 
(see Note 14). 
To create a blast database, use the following BLAST+ 
command: 
makeblastdb
-in 
NCBI_viruses.fasta
-dbtype 
nucl
-out Virusdb 
To annotate additional viral contigs that had no hit in the ﬁrst 
BLASTn analyses use the following BLAST+ command: 
blastn
-db 
Virusdb
-query 
Contigs_nohits_blastn2. 
fasta -out blastn_results2.txt -evalue 0.001 -max_ 
target_seqs 1 -outfmt "6 std qlen stitle qcovs" 
To ﬁlter the BLASTn ﬁle to obtain only the virus and viroid 
hits, the following linux commands can be used (see Note 15): 
grep -i "virus" blastn_results2.txt > 
Blastn_results_virus.txt 
grep -i "viroid" blastn_results2.txt > 
Blastn_results_viroid.txt

HTS Detection of Citrus Viruses and Viroids
207
3.4.4 
Read Mapping 
Against Virus and Viroid 
Reference Sequences of 
Interest 
Read mapping is used to identify known viruses and viroids in HTS 
data sets. To accurately identify citrus virus and viroid infections 
using HTS data, a complete reference database is required includ-
ing all sequences of the viruses and viroids known to infect citrus 
(see Note 16). The presence of a virus or viroid will then be 
identiﬁed when a high number of reads map to the speciﬁc refer-
ence sequence with a high genome coverage percentage. 
A recommended list of reference sequence of known citrus 
viruses and viroids (see Note 17) important in the South African 
context [21, 26] are as follows:
•
Citrus tristeza virus T30 (AF260651)
•
Citrus tristeza virus T36 (NC_001661)
•
Citrus tristeza virus VT (EU937519)
•
Citrus tristeza virus S1 (KU589212)
•
Citrus tristeza virus HA16-5 (KU883267)
•
Citrus tristeza virus RB (KU883265)
•
Citrus tristeza virus T3 (MH051719)
•
Citrus tristeza virus T68 (MK033511)
•
Citrus tristeza virus A18 (JQ798289)
•
Citrus tristeza virus M1 (MH323442)
•
Citrus tristeza virus L1 (MH323441)
•
Citrus tatter leaf virus isolate TL101 (MH108976.1)
•
Citrus virus A RNA1 isolate 1.8 (MT720885)
•
Citrus virus A RNA2 isolate 1.8 (MT720886)
•
Hop stunt viroid strain R140902-7 (KY110716.1)
•
Hop stunt viroid strain R120621-2 (KY110717.1, Cachexia 
causing variant)
•
Citrus dwarﬁng viroid strain R140910-12 (KY110718.1)
•
Citrus exocortis viroid strain R140902-18 (KY110721.1) 
1. To perform the read mapping analyses, a multifasta ﬁle needs to 
be created containing all the sequences of interest by down-
loading the fasta sequences from GenBank and adding them to 
the same ﬁle. 
The BWA mapping and Samtools analyses are run in command 
line on an HPC with 12 threads and 40 Gb availability (see Note 
11).

208
Rachelle Bester and Hans J. Maree
2. A BWA index needs to be created using the following BWA 
command: 
bwa index All_accessions.fasta 
3. After creating the index BWA is run using the paired-end 
trimmed fastq ﬁles: 
bwa 
mem
-t 
20 
All_accessions.fasta 
file1_trim_ 
paired.fastq file2_trim_paired.fastq > Output.sam 
4. Convert the sam formatted ﬁle to a bam formatted ﬁle for 
further analyses using Samtools: 
samtools view -@ 20 -S -b Output.sam > Output.bam 
5. Filter the bam ﬁle to only contain the mapped reads: 
samtools 
view
-@ 
7
-b
-F 
4 
Output.bam 
> 
Output_ 
mapped.bam 
6. Filter mapped bam ﬁle for only mapped reads with an 80% 
identity over 50% of the read: 
samtools view -@ 7 -h Output_mapped.bam\ 
| awk -v maxpct=0.20 -v fracpct=0.5 -v OFS=’\t’ -v 
FS=’\t’ ’{ 
if($0 ~ /^@/){ 
print $0 
} else { 
xnm=gensub(/.*\tNM:i:/, "", "g", $0); 
nm=gensub(/\t.*/, "", "g", xnm); 
ln=length($10) 
lnfrac=ln*fracpct 
pct=nm/lnfrac; 
if(pct <= maxpct) { 
print $0, "XP:f:"pct 
} 
} 
}’ > Output_mapped_pct.sam

HTS Detection of Citrus Viruses and Viroids
209
7. Convert the new sam ﬁle to a bam ﬁle: 
samtools 
view
-@ 
7
-S
-b 
Output_mapped_pct.sam 
> 
Output_mapped_pct.bam 
8. Sort the bam ﬁle according to coordinates: 
samtools sort -@ 7 Output_mapped_pct.bam > Output_ 
mapped_pct_sorted.bam 
9. Create a text ﬁle with each base position of the reference that 
was covered with at least one read (column one: Accession 
name, column two: Base position, column 3: Number of 
reads): 
samtools 
depth 
Output_mapped_pct_sorted.bam 
> 
Output_mapped_pct_sorted_depth.txt 
10. Create a text ﬁle with the total read count per accession that 
was included in the read mapping (column one: Read count, 
column two: Accession name): 
samtools view -@ 7 Output_mapped_pct.sam | cut -f3 | 
sort | uniq -c | sed -e ’s/^[ \t]*//’ | tr ’ ’ \crt > 
Output_mapped_names_reads.txt 
11. Create a list of the accession names used in the read mapping: 
cut
-f2 
Output_mapped_names_reads.txt 
> 
Output_ 
Accession_list.txt 
12. Split the text ﬁle containing the depth of all the bases covered 
with reads per accession to create one ﬁle per accession: 
while read line 
do 
grep -w "$line" Output_mapped_pct_sorted_depth.txt

>> Output_$line\.txt 
done < Output_Accession_list.txt 
210
Rachelle Bester and Hans J. Maree
13. Create a list of only the total read counts per accession 
(remove accession names): 
cut
-f1 
Output_mapped_names_reads.txt 
> 
Output_ 
Readcounts.txt 
14. Paste together two ﬁles to create a ﬁle with accession name in 
column 1 and the read count per accession in column 2: 
paste Output_Accession_list.txt Output_Readcounts. 
txt >> Output_Mapping_results.txt 
15. Create a text ﬁle with accession length (column 1), number of 
bases covered (column 2), and genome coverage (%) (column 
3) for each accession that had reads that mapped to it: 
cat 
Output_Accession_list.txt 
| 
while 
read 
accession; do 
genome_covered=$(cat 
Output_$accession\.txt 
| 
wc
-l | awk ’{print $1}’) 
genome_length=$(grep
-m1 
$accession 
Output_ 
mapped_pct.sam | cut -d ":" -f3) 
genome_cov=$(echo 
"($genome_covered/$genome_ 
length)*100" | bc -l) 
printf 
$genome_length’\t’$genome_covered’\t’ 
$genome_cov’\n’ >> Output_Mapping_results2.txt 
done 
16. Paste together the accession name and read count ﬁle to the 
ﬁle containing the genome coverage data: 
paste 
Output_Mapping_results.txt 
Output_Mapping_ 
results2.txt >> Output_Mapping_results3.txt

HTS Detection of Citrus Viruses and Viroids
211
17. Use the ﬁnal output ﬁle “Output_Mapping_results3.txt” to 
assess the likelihood of a viral agent’s presence in a sample. 
The tab-delimited ﬁle has ﬁve columns, namely, accession 
number, read count, number of accession bases covered, 
length of accession, and genome coverage. A high genome 
coverage and a high read count are indicative of the presence 
of a virus or viroid (see Note 18). 
3.4.5 
Reference Gene 
Read Mapping 
The investigation into the expression proﬁle of reference genes can 
allow for the comparison between samples to potentially answer 
questions relating to the suitability of the sequencing depth to 
allow for accurate pathogen detection. The expression pattern of 
these genes is hypothesized to be stable, and even if the gene 
expression is modulated in response to biotic stress, the variation 
between infected samples should be reﬂected in the read counts 
associated with the reference genes. By identifying low and high 
expressing genes, gene expression proﬁles can be used as internal 
controls for RNA extraction efﬁciency, library construction and to 
determine the number of reads required for accurate pathogen 
detection. Using the host reference gene mapping ratios, outlier 
samples can be identiﬁed [21, 30]. 
1. A similar pipeline as for the “Read mapping against virus and 
viroid reference sequences” analyses can be followed by down-
loading the reference sequences of 12 Citrus sinensis reference 
genes [21, 30] from NCBI GenBank and creating a multifasta 
ﬁle for read mapping.
•
XM_006488024.3: Vacuolar fusion protein MON1 homo-
log (LOC102625488)
•
XM_006484464.3: 
Thioredoxin-like 
protein 
YLS8 
(LOC102629695)
•
XM_006481276.3: 
Carnosine 
N-methyltransferase-like 
(LOC102617870)
•
XM_006482390.2:
F-box/kelch-repeat
protein 
At5g15710 (LOC102621205)
•
XM_025099888.1: 
E3 
ubiquitin-protein 
ligase 
UPL7 
(LOC102621690)
•
XM_006476013.2:
Protein
PEROXIN-4 
(LOC102618324)
•
XM_025099846.1: Polypyrimidine tract-binding protein 
homolog 1 (LOC102618721)
•
XM_006476919.3: Glyceraldehyde-3-phosphate dehydro-
genase GAPC1, cytosolic (LOC102624117)
•
XM_006490521.3: 
Ubiquitin-conjugating 
enzyme 
E2 
10 (LOC102614401)

First, the read count per kilobase of sequence (RPK) is
calculated for each gene sequence.
212
Rachelle Bester and Hans J. Maree
•
XM_006464503.3: Actin-7 (LOC102577980)
•
XM_006485840.3:
Elongation
factor
1-alpha 
(LOC102613486)
•
XM_006473602.3:
Tubulin
beta-6
chain 
(LOC102631140) 
2. Follow steps 2–16 from “Read mapping against virus and 
viroid reference sequences of interest” by replacing the “All_ac-
cessions.fasta” ﬁle with the multifasta ﬁle containing the refer-
ence gene sequences to create the BWA index. 
3. The ﬁnal output ﬁle “Output_Mapping_results3.txt” can be 
used to identify biological and technical variation between 
samples. 
The read count of each reference gene can be normalized 
for comparisons by calculating the transcripts per million 
(TPM) count.
•
•
After which the sums of all the RPKs are divided by a million 
to calculate the denominator for the transcripts per million 
(TPM) count for the reference genes.
•
Each sequence’s RPK is divided by the reference genes’ 
denominator to normalize the read count for biological 
and technical variation between samples.
•
The TPM count for each reference gene sequence is used to 
compare the proportion of reads that mapped to a speciﬁc 
reference in each sample (see Note 19). 
3.4.6 
CTV Variant 
Detection 
The use of HTS data to differentiate CTV variants was previously 
investigated [28]. Since a single CTV genome region is not infor-
mative enough to differentiate all genotypes, multiple target 
regions need to be selected for differentiating reverse transcription 
polymerase chain reaction (RT-PCR) assays. These assays need to 
be reevaluated as new genotypes or variants are identiﬁed. The 
determination of full genomes and the utilization of high-
throughput 
sequencing 
can 
potentially 
circumvent 
these 
limitations. 
Currently, there are 11 identiﬁed CTV genotype groups with a 
maximum diversity based on nucleotide identity of 78.5% between 
genotype T36 and L1 [28]. Genotypes VT and T68 are the most 
similar, sharing a 91.9% nucleotide identity. Genomic regions with 
high similarity between genotypes can result in potential nontarget 
read mapping if the genotypes occur in mixed infections. When 
selecting only a single genotype as a reference for read mapping of a 
data set consisting of reads from a different genotype can increase 
the nontarget read mapping signiﬁcantly resulting in a genome

coverage of 90%. The presence of CTV in the data set is evident 
with a genome coverage of 90%, but not much can be deduced 
regarding the speciﬁc genotype present. The recommendation is to 
use multiple sequences representing the full diversity of the CTV 
species (see Note 20). 
HTS Detection of Citrus Viruses and Viroids
213
For CTV genotype differentiation in HTS data, a similar strat-
egy to the abovementioned “read mapping against virus and viroid 
reference sequences” is followed with more stringent mapping 
criteria. 
1. To perform the read mapping analyses, a multifasta ﬁle needs to 
be created containing all the CTV sequences of interest by 
downloading the fasta sequences from GenBank and adding 
them to the same ﬁle. The CTV genotypes identiﬁed to 
date (December 2022) are represented by the following 
sequences:
•
Citrus tristeza virus T30 (AF260651)
•
Citrus tristeza virus T36 (NC_001661)
•
Citrus tristeza virus VT (EU937519)
•
Citrus tristeza virus S1 (KU589212)
•
Citrus tristeza virus HA16-5 (KU883267)
•
Citrus tristeza virus RB (KU883265)
•
Citrus tristeza virus T3 (MH051719)
•
Citrus tristeza virus T68 (MK033511)
•
Citrus tristeza virus A18 (JQ798289)
•
Citrus tristeza virus M1 (MH323442)
•
Citrus tristeza virus L1 (MH323441) 
The BWA mapping and Samtools analyses are run in com-
mand line on an HPC with seven threads and 40 Gb availability 
(see Note 11). 
2. Follow steps 2–7 from “Read mapping against virus and viroid 
reference sequences of interest” by replacing the “All_acces-
sions.fasta” ﬁle with the multifasta ﬁle containing the different 
CTV genotype sequences to create the BWA index. 
3. Filter mapped bam ﬁle for only mapped reads with an 95% 
identity over 90% of the read: 
samtools view -@ 7 -h Output_mapped.bam\ 
| awk -v maxpct=0.05 -v fracpct=0.9 -v OFS=’\t’ -v 
FS=’\t’ ’{ 
if($0 ~ /^@/){ 
print $0 
} else { 
xnm=gensub(/.*\tNM:i:/, "", "g", $0);

nm=gensub(/\t.*/, "", "g", xnm); 
ln=length($10) 
lnfrac=ln*fracpct 
pct=nm/lnfrac; 
if(pct <= maxpct) { 
print $0, "XP:f:"pct 
} 
} 
}’ > Output_mapped_pct.sam 
214
Rachelle Bester and Hans J. Maree
4. Follow steps 9–16 from “Read mapping against virus and 
viroid reference sequences of interest” using the ﬁle from the 
abovementioned stricter mapping criteria (see Note 21). 
5. Using the ﬁnal output ﬁle from this read mapping pipeline 
(Output_Mapping_results3.txt), genome coverage below 50% 
is regarded as the result of nontarget read mappings. A genome 
coverage above 90% is indicative of the presence of a speciﬁc 
genotype, and genome coverage between 50% and 90% sug-
gests the presence of genotype variants not represented in the 
read mapping reference list (see Note 22). 
4 
Notes 
1. The Quick-RNA Plant Miniprep Kit is an alternative RNA 
extraction method to the CTAB extraction. Additionally for 
the kit extraction, a mortar, pestle and liquid nitrogen is 
required to powder the plant material. The plant material 
input for the kit extraction is lower than for the CTAB extrac-
tion (0.2 g vs. 1 g) making it difﬁcult to obtain a representative 
sample from a plant with this extraction method. This can 
potentially lead to the generation of false negative results if 
the virome includes pathogens that are unevenly distributed 
in the plant [21]. To compensate for this, multiple extractions 
from the same plant can be performed and the RNA pooled 
before library construction. 
2. We recommend the use of ribo-depleted RNA for the detection 
of citrus viruses and viroids as this approach has been shown to 
provide consistent results irrespective of the bioinformatic 
pipeline selected [21, 31]. 
3. We elect to ship total RNA to a service provider for both library 
preparation and sequencing. We ship at least 10 μg in 100 μL 
Milli-Q water with 0.1× volume 3 M sodium acetate (pH 5.2) 
and 2× volume 100% ethanol added.

HTS Detection of Citrus Viruses and Viroids
215
4. De novo assembly and BLAST analyses have high resource 
demands, and their runtime is greatly reduced when an HPC 
is used. For analyses on a desktop/laptop refer to the program-
speciﬁc performance parameters. 
5. We recommend creating a local database of GenBank’s nucleo-
tide database and using BLASTn for a ﬁrst round of contig 
identiﬁcation (https://www.ncbi.nlm.nih.gov/books/NBK52 
640/). If the latest version of GenBank is not used as the local 
copy, potential unknown or newly identiﬁed viruses can remain 
unidentiﬁed. 
6. It is recommended to create a citrus-speciﬁc database contain-
ing representative sequences of viruses and viroids known to 
infect citrus. This database can be used for either BLAST or 
read mapping analyses. 
7. It is recommended to include a sample from a plant species 
other than your species of interest in the analyses pipeline 
(sample preparation, RNA extraction, and HTS analyses) to 
assess the level of cross contamination between samples. This 
is referred to as an alien control [18]. Reads or contigs identi-
ﬁed in this nontarget positive control related to the species of 
interest host’s genome or virome are indicative of cross con-
tamination between samples. Reads from the nontarget posi-
tive control in the samples of interest data will indicate the 
same, and the level of contamination can be determined. It 
will be useful to use a species not in the host range of your 
viruses and viroids of interest as this nontarget positive control. 
8. The supernatant should be clear, and no debris should be 
transferred. 
9. The average RIN value expected for RNA extracted with the 
CTAB method is 8.1 (±0.1 standard deviation) and the average 
ribosomal RNA (rRNA) ratio 5.5 (±1.3 standard deviation). 
The average expected RIN value for the RNA extracted with 
the Quick-RNA Plant Miniprep Kit is 7.9 (±0.5 standard devi-
ation), and the average ribosomal RNA (rRNA) ratio is 1.9 
(±0.3 standard deviation). An abnormal 5S peak obtained with 
RNA extracted using the Quick-RNA Plant Miniprep Kit 
extracted RNA can be ﬂagged by HTS service providers and, 
however, should not prevent library preparation. 
10. To obtain a more than 90% genome coverage for known citrus 
viruses and viroids ﬁve million reads were needed with the 
CTAB extraction protocol. However, for the Quick-RNA 
Plant Miniprep Kit extracted RNA, it is recommended to 
obtain at least ten million reads per sample. As a standard 
operating procedure and if multiple RNA extracts from the 
same plant will not be pooled, 40 million reads per sample

216
Rachelle Bester and Hans J. Maree
are recommended to consistently detect the presence of the 
current known citrus viruses and viroids with high conﬁdence. 
11. The software does not necessarily require these resources to 
run. The speciﬁed command was tested to work with these 
speciﬁcations. Access to an HPC allows the use of more 
resources to potentially accelerate the command run time. 
12. Due to the potential lower representation of viroid RNA 
obtained with certain extraction methods [21, 26, 32, 33] 
and the small genome size of viroids, it is possible that a viroid 
infection may be missed with only a de novo assembly 
approach. For routine citrus virus and viroid detection, a com-
bined de novo and read mapping analyses strategy is recom-
mended. De novo assembly is not critical for routine detection 
of known pathogens. However, this step provides an extra layer 
of security to ensure the detection of unsuspected or unknown 
pathogens. The detection of these unknown pathogens will 
require additional validation with a second independent 
method like RT-PCR. 
13. NCBI GenBank is updated every second month, and therefore, 
the 
viral 
database 
should 
also 
be 
updated 
to 
ensure 
completeness. 
14. Identiﬁcation of viral contigs using NCBI BLAST is bioinfor-
matically challenging due to the abundant nonviral sequences 
included in the GenBank nucleotide or nonredundant data-
bases, which extend runtime and obscure viral hits. By using, a 
smaller database can potentially identify more viral hits but also 
increase the false positive detection rate. Each BLASTn viral hit 
should be evaluated simultaneously for query coverage and 
percentage identity. A BLASTn hit with a high percentage 
identity and a low query coverage are probably a false positive 
result. 
15. The ﬁrst round of BLASTn results can also be ﬁltered for virus 
and viroid hits using these commands. The order of the ana-
lyses can also be changed, and the ﬁrst BLASTn analyses can be 
against the virus database and the second analyses, of the con-
tigs with no hits, against the GenBank nucleotide database to 
identify additional pathogens of interest. 
16. Read mapping and BLAST analyses are only as effective as the 
completeness of the reference database used for the analyses. If 
a similar or closely related sequence is not included in the 
database, the suspected virus sequence in the data set will not 
be detected or annotated using either of these methods. 
17. The contents of the reference sequence list depend on the 
viruses and viroids that are known to be present in a speciﬁc 
geographical region or that are of interest to search for. This list

HTS Detection of Citrus Viruses and Viroids
217
can be extended to include all citrus infecting viruses and 
viroids or even viruses and viroids infecting other fruit trees. 
18. Genome coverage refers to the percentage of the virus or viroid 
genome that is covered by at least one read, and read depth is 
the number of times; a given nucleotide of the genome is 
covered by independent reads. The thresholds to make a posi-
tive identiﬁcation of a virus based on genome coverage and 
read depth have not been determined, and these thresholds will 
depend on multiple factors including the host/virus combina-
tion, virus species, mix variant infections, virus concentration, 
and sequencing depth of the library. For example, mapping 
+/- 40 million reads from a sample positive for CTV will result 
in a genome coverage of >99% with more than one million 
reads mapped to a CTV accession using the BWA pipeline. For 
citrus virus A >99%, genome coverage can be expected in a 
positive sample, but with a signiﬁcantly lower number of reads 
mapping to the reference sequences (>10,000). Citrus tatter 
leaf virus positive samples will also yield a genome coverage 
>99% with even less reads mapping to the genome (>4000). 
For hop stunt viroid, citrus dwarﬁng viroid and citrus exocortis 
viroid variable results should be expected with read counts as 
low as 400 resulting in 100% genome coverage. Citrus dwarf-
ing viroid will only reach 97–99% genome coverage using the 
recommended reference sequence. 
19. In infected C. sinensis cv. “Madam Vinous,” sweet orange trees, 
it was found that the genes with the highest TPM count across 
all samples were GAPC2, EF-1a, and ACT2, and the genes 
with the lowest TPM count across all samples were FBOX and 
the carnosine N-methyltransferase-like gene [21, 26]. The 
gene ratios can be used to identify outlier samples that may 
impact on the accuracy of virus and viroid detection. However, 
these gene ratios can be inﬂuenced by variables such as cultivar, 
citrus species, or even plant growth stage and should be ree-
valuated for different test scenarios. 
20. There is a need to continuously investigate the diversity of 
CTV and develop accurate reference databases to deﬁne geno-
type group boundaries. Therefore, it is important to add rep-
resentative CTV sequences to the read mapping reference list 
when new genotypes or divergent CTV variants are identiﬁed. 
21. The sequence identity between the known complete genomes 
of CTV within a genotype can differ by 2–9%. For the differ-
entiation of CTV genotypes, it is recommended to make the 
mapping more stringent, increasing the similarity fraction to 
95% over at least 90% of the total alignment length. 
22. The thresholds are dependent on at least 1000 read pairs of 
CTV mapping to a genotype sequence. These thresholds will

218
Rachelle Bester and Hans J. Maree
also be inﬂuenced by genotype concentration and sequencing 
depth of the library, which was not necessarily investigated to 
the extremes. 
Acknowledgments 
The authors would like to acknowledge Citrus Research Interna-
tional (CRI) for funding project 1241. Computations were per-
formed using Stellenbosch University’s HPC2: http://www. sun. 
ac.za/hpc. 
References 
1. Al Rwahnih M, Daubert S, Golino D, Rowhani 
A (2009) Deep sequencing analysis of RNAs 
from a grapevine showing Syrah decline symp-
toms reveals a multiple virus infection that 
includes a novel virus. Virology 387:395–401. 
https://doi.org/10.1016/j.virol.2009. 
02.028 
2. Kreuze JF, Perez A, Untiveros M et al (2009) 
Complete viral genome sequence and discov-
ery of novel viruses by deep sequencing of 
small RNAs: a generic method for diagnosis, 
discovery and sequencing of viruses. Virology 
388:1–7. https://doi.org/10.1016/j.virol. 
2009.03.024 
3. Al Rwahnih M, Sudarshana MR, Uyemoto JK, 
Rowhani 
A 
(2012) 
Complete 
genome 
sequence of a novel vitivirus isolated from 
grapevine. J Virol 86:9545–9545. https:// 
doi.org/10.1128/JVI.01444-12 
4. Espach Y, Maree HJ, Burger JT (2012) Com-
plete genome of a novel endornavirus assem-
bled from next-generation sequence data. J 
Virol 86:13142–13142. https://doi.org/10. 
1128/JVI.02538-12 
5. Villamor DEV, Mekuria TA, Pillai SS, Eastwell 
KC (2016) High-throughput sequencing iden-
tiﬁes novel viruses in nectarine: insights to the 
etiology of stem-pitting disease. Phytopathol-
ogy 106:519–527. https://doi.org/10.1094/ 
PHYTO-07-15-0168-R 
6. Navarro B, Minutolo M, De Stradis A et al 
(2018) The ﬁrst phlebo-like virus infecting 
plants: a case study on the adaptation of 
negative-stranded RNA viruses to new hosts: 
citrus concave gum-associated virus. Mol Plant 
Pathol 19:1075–1089. https://doi.org/10. 
1111/mpp.12587 
7. Navarro B, Zicca S, Minutolo M et al (2018) A 
negative-stranded RNA virus infecting citrus 
trees: the second member of a new genus 
within 
the 
order 
Bunyavirales. 
Front 
Microbiol:9. https://doi.org/10.3389/ 
fmicb.2018.02340 
8. Rott ME, Kesanakurti P, Berwarth C et al 
(2018) 
Discovery 
of 
negative-sense 
RNA 
viruses in trees infected with apple rubbery 
wood disease by next-generation sequencing. 
Plant Dis 102:1254–1263. https://doi.org/ 
10.1094/PDIS-06-17-0851-RE 
9. Diaz-Lara A, Navarro B, Di Serio F et al (2019) 
Two novel negative-sense RNA viruses infect-
ing grapevine are members of a newly proposed 
genus within the family Phenuiviridae. Viruses 
11:685. 
https://doi.org/10.3390/ 
v11080685 
10. Bougard K, Maree HJ, Pietersen G et al (2021) 
First report of Coguvirus eburi infecting pear 
(Pyrus communis) in South Africa. Plant Dis. 
https://doi.org/10.1094/PDIS-08-21-
1630-PDN 
11. Bougard K, Maree HJ, Pietersen G et al (2021) 
First report of Apple rubodvirus 2 infecting 
pear 
(Pyrus 
communis) 
in 
South 
Africa. 
Plant Dis:PDIS-08-21-1631-PDN. https:// 
doi.org/10.1094/PDIS-08-21-1631-PDN 
12. Bester R, Maree HJ (2020) First report of 
plum bark necrosis stem pitting-associated 
virus in Japanese plums in South Africa. 
Plant Dis:PDIS-04-20-0710-PDN. https:// 
doi.org/10.1094/PDIS-04-20-0710-PDN 
13. Bester R, Malan SS, Maree HJ (2020) A plum 
marbling conundrum: identiﬁcation of a new 
viroid associated with marbling and corky ﬂesh 
in Japanese plums. Phytopathology 110:1476– 
1482. https://doi.org/10.1094/PHYTO-12-
19-0474-R 
14. Bester R, Burger JT, Maree HJ (2020) Geno-
mic characterisation of a newly identiﬁed bad-
navirus infecting ivy (Hedera helix). Arch Virol 
165:1511–1514. https://doi.org/10.1007/ 
s00705-020-04627-1

n
HTS Detection of Citrus Viruses and Viroids
219
15. Bester R, Maree HJ (2022) First report of the 
plum marbling disease associated agent, plum 
viroid I, in apricots (Prunus armeniaca) i  
South
Africa.
Plant
Dis:PDIS-10-22-
2321-PDN. https://doi.org/10.1094/PDIS-
10-22-2321-PDN 
16. Bester R, Bougard K, Maree HJ (2022) First 
report of apple rubodvirus 2 infecting apples 
(Malus domestica) in South Africa. J Plant 
Pathol 104:1199–1200. https://doi.org/10. 
1007/s42161-022-01167-2 
17. Lebas B, Adams I, Al Rwahnih M et al (2022) 
Facilitating the adoption of high-throughput 
sequencing technologies as a plant pest diag-
nostic 
test 
in 
laboratories: 
a 
step-by-step 
description. EPPO Bull:epp.12863. https:// 
doi.org/10.1111/epp.12863 
18. Massart S, Adams I, Al Rwahnih M et al (2022) 
Guidelines for the reliable use of high through-
put sequencing technologies to detect plant 
pathogens and pests. Peer Commun J 2:e62. 
https://doi.org/10.24072/pcjournal.181 
19. Adams IP, Fox A, Boonham N et al (2018) The 
impact of high throughput sequencing on 
plant health diagnostics. Eur J Plant Pathol 
152:909–919. https://doi.org/10.1007/ 
s10658-018-1570-0 
20. Olmos A, Boonham N, Candresse T et al 
(2018) High-throughput sequencing technol-
ogies for plant pest diagnosis: challenges and 
opportunities. 
EPPO 
Bull 
48:219–224. 
https://doi.org/10.1111/epp.12472 
21. Bester R, Cook G, Breytenbach JHJ et al 
(2021) 
Towards 
the 
validation 
of 
high-
throughput sequencing (HTS) for routine 
plant virus diagnostics: measurement of varia-
tion linked to HTS detection of citrus viruses 
and viroids. Virol J 18:61. https://doi.org/10. 
1186/s12985-021-01523-1 
22. Maree HJ, Fox A, Al Rwahnih M et al (2018) 
Application of HTS for routine plant virus 
diagnostics: state of the art and challenges. 
Front Plant Sci 9. https://doi.org/10.3389/ 
fpls.2018.01082 
23. Massart S, Chiumenti M, De Jonghe K et al 
(2019) Virus detection by high-throughput 
sequencing of small RNAs: large-scale perfor-
mance testing of sequence analysis strategies. 
Phytopathology 109:488–497. https://doi. 
org/10.1094/PHYTO-02-18-0067-R 
24. Villamor DEV, Ho T, Al Rwahnih M et al 
(2019) High throughput sequencing for plant 
virus detection and discovery. Phytopathology 
109:716–725. https://doi.org/10.1094/ 
PHYTO-07-18-0257-RVW 
25. Soltani N, Stevens KA, Klaassen V et al (2021) 
Quality assessment and validation of high-
throughput sequencing for grapevine virus 
diagnostics. Viruses 13:1130. https://doi. 
org/10.3390/v13061130 
26. Bester R, Steyn C, Breytenbach JHJ et al 
(2022) 
Reproducibility 
and 
sensitivity 
of 
high-throughput 
sequencing 
(HTS)-based 
detection of citrus tristeza virus and three citrus 
viroids. Plants 11:1939. https://doi.org/10. 
3390/plants11151939 
27. Saldarelli P, Giampetruzzi A, Maree HJ, Rwah-
nih MA (2017) High-throughput sequencing: 
advantages beyond virus identiﬁcation. In: 
Grapevine viruses: molecular biology, diagnos-
tics and management. Springer, Cham, pp 
625–642 
28. Bester R, Cook G, Maree HJ (2021) Citrus 
tristeza virus genotype detection using high-
throughput 
sequencing. 
Viruses 
13:17. 
https://doi.org/10.3390/v13020168 
29. White EJ, Venter M, Hiten NF, Burger JT 
(2008) 
Modiﬁed 
Cetyltrimethylammonium 
bromide method improves robustness and ver-
satility: the benchmark for plant RNA extrac-
tion. Biotechnol J 3:1424–1428. https://doi. 
org/10.1002/biot.200800207 
30. Mafra V, Kubo KS, Alves-Ferreira M et al 
(2012) Reference genes for accurate transcript 
normalization in citrus genotypes under differ-
ent experimental conditions. PLoS ONE 7: 
e31263. https://doi.org/10.1371/journal. 
pone.0031263 
31. Visser M, Bester R, Burger JT, Maree HJ 
(2016) Next-generation sequencing for virus 
detection: covering all the bases. Virol J 13: 
85. https://doi.org/10.1186/s12985-016-
0539-x 
32. Semancik JS, Szychowski J (1983) Enhanced 
detection of viroid-RNA after selective divalent 
cation fractionation. Anal Biochem 135:275– 
279. https://doi.org/10.1016/0003-2697 
(83)90683-8 
33. Navarro B, Flores R (1997) Chrysanthemum 
chlorotic mottle viroid: unusual structural 
properties of a subgroup of self-cleaving viroids 
with hammerhead ribozymes. Proc Natl Acad 
Sci USA 94:11262–11267. https://doi.org/ 
10.1073/pnas.94.21.11262

Chapter 15 
Identiﬁcation of DNA Viruses in Ancient DNA from 
Herbarium Samples 
Gianluca Grasso, Silvia Rotunno, Re´gis Debruyne, Lucie Bittner, 
Laura Miozzi, Roland Marmeisse, and Valeria Bianciotto 
Abstract 
Herbaria encompass millions of plant specimens, mostly collected in the nineteenth and twentieth centuries 
that can represent a key resource for investigating the history and evolution of phytopathogens. In the last 
years, the application of high-throughput sequencing technologies for the analysis of ancient nucleic acids 
has revolutionized the study of ancient pathogens including viruses, allowing the reconstruction of 
historical genomic viral sequences, improving phylogenetic based molecular dating, and providing essential 
insight into plant virus ecology. In this chapter, we describe a protocol to reconstruct ancient plant and soil 
viral sequences starting from highly fragmented ancient DNA extracted from herbarium plants and their 
associated rhizospheric soil. Following Illumina high-throughput sequencing, sequence data are de novo 
assembled, and DNA viral sequences are selected, according to their similarity with known viruses. 
Key words Ancient DNA, DNA viruses, Herbaria, Museomics 
1 
Introduction 
Plants host numerous viruses belonging to different families, caus-
ing, for several of them, important threats to crop plants. Since the 
causal association between speciﬁc disease symptoms and viruses is 
rather recent in the history of phytopathology, little is known 
regarding the origin, spread, and prevalence of these pathogens in 
a recent past. 
Natural history collections, and more speciﬁcally herbaria, 
encompass millions of plant specimens, mostly collected in the 
nineteenth and twentieth centuries that can be searched for the 
presence and prevalence of speciﬁc pathogens and pests. Straight-
forward visual observation of herbarium plants has been carried out 
in the case of pathogens producing unambiguous symptoms as in 
the case of anther smut fungi infecting Silene ﬂowers [1] or of the 
Horse-chestnut leaf miner [2]. Alternatively, plant pathogens can
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_15, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
221

be identiﬁed among degraded (ancient) aDNA molecules extracted 
from infected collection specimens (i.e. museomics approaches). 
This approach has been reported for fungal [3] or oomycete [4] 
eukaryotic pathogens and has led to the reconstruction of an entire 
historical genomic sequence of the citrus canker bacterial agent [5].
222
Gianluca Grasso et al.
A similar approach has been reported to investigate DNA virus 
evolution and prevalence in past human populations. For example, 
the systematic search for Hepatitis B virus sequences in ancient 
human DNA sequences has highlighted the temporal and spatial 
dispersal of different virus genotypes during the last ca. 10,000 years 
[6]. Alternatively, the systematic search for any known pathogen 
sequences in the DNA extracted from ﬁfth to eighth century 
human remains from a common settlement in Germany identiﬁed 
several cases of coinfection by hepatitis B, smallpox viruses, and 
Parvovirus B, highlighting the poor health status of this local 
human population [7]. 
In the case of plants, small RNA extracted from 90-year-old 
Cassava herbarium specimens allowed identiﬁcation of a cassava 
mosaic geminivirus sequence that was used to estimate its evolu-
tionary rate [8], showing how analyses of ancient viral genomic 
sequence data obtained from historical samples can substantially 
improve phylogenetic based molecular dating studies. Historical 
data on viral sequences can also provide essential insight into 
plant virus ecology, as demonstrated by the analysis of Barley yellow 
dwarf luteovirus sequences obtained from RNA extracted from 
herbarium specimens dating from the end of nineteenth century 
to the ﬁrst half of the twentieth century [9]. 
In this chapter, we describe a protocol for the extraction of 
DNA from herbarium plants and their associated rhizospheric soil. 
Following Illumina high-throughput sequencing of the highly frag-
mented ancient DNA and its de novo assembly, assembled DNA 
viral 
sequences 
are 
identiﬁed 
allowing 
to 
reconstruct 
the 
corresponding ancient plant and soil viromes. 
2 
Materials 
2.1 
Herbarium Plant 
and Soil Sampling 
1. 2 mL sterile centrifuge tubes. 
2. Tweezers. 
3. Sterile razor blades. 
2.2 
DNA Extraction
All experiments are performed in dedicated spaces within a clean-
room with positive pressure to prevent contamination from the 
outside environment, wearing laboratory coveralls and with speciﬁc 
cleaning procedures of equipment and spaces (with 2.6% bleach 
and/or 20 min UV-cross-linking at 256 nm).

Identiﬁcation of DNA Viruses in Ancient DNA
223
1. High 
Pure 
Viral 
Large 
Volume 
extraction 
kit 
(Roche 
Diagnostics). 
2. DNEasy Powersoil Pro kit (QIAGEN). 
3. DNA low-binding 1.5 and 2 mL microtubes. 
4. Sediment Lysis Buffer (SLBconc): 20 mM Tris–HCl pH 9.0, 
10 mM calcium chloride, 100 mM DTT, 0.5% w/v SDS, 6.25% 
w/v polyvinylpyrrolidone. 
5. 20 mg/mL proteinase k solution. 
6. Binding buffer (BB): 5 M guanidinium HCl, 120 mM sodium 
acetate pH 5.2, 0.05% v/v Tween-20, 40% v/v isopropanol (see 
Note 1). 
7. Elution buffer (EBT): EB buffer (from QIAGEN DNEasy 
Powersoil Pro kit) supplemented with 0.05% v/v Tween-20. 
8. Molecular biology grade ethanol. 
9. Nuclease-free water. 
10. Qubit dsDNA high sensitivity kit (Invitrogen). 
11. Mixer Mill (with microtube accessories). 
12. Hybridization oven or other heating device. 
13. Rotary mixer/shaker. 
14. Large volume refrigerated centrifuge (up to at least 3000 g). 
15. Microcentrifuge (up to at least 15,000 g). 
16. Fluorometer (Invitrogen Qubit or equivalent). 
17. 15 mL falcon tubes. 
2.3 
Library 
Preparation and 
Sequencing 
1. Oligonucleotides IS1, IS2, and IS3 to make up truncated P5 
and P7 adapters [10]. 
2. Custom (seven nucleotides) indexed Illumina P5 and P7 
Primers [11]. 
3. NEBNext End-Repair module (New England Biolabs). 
4. NEBNext Quick Ligation Module (New England Biolabs). 
5. Bst polymerase large fragment (New England Biolabs). 
6. Minelute PCR puriﬁcation kit (QIAGEN). 
7. PBacidic: PB buffer (from Minelute PCR puriﬁcation kit) sup-
plemented with 60 mM sodium acetate pH 5.3. 
8. SsoAdvanced Universal SYBR supermix (Bio-Rad). 
9. Qubit dsDNA High Sensitivity kit (Invitrogen). 
10. NucleoMag cleanup and size selection beads kit (Macherey-
Nagel).

224
Gianluca Grasso et al.
11. Magnet for Solid Reversible Phase Immobilization (SPRI) 
puriﬁcation using 1.5 mL microtubes (Invitrogen Dynamag 
or equivalent). 
12. Microcentrifuge (up to at least 15,000 g). 
13. Incubation block with heated lid (Eppendorf ThermoMixer or 
equivalent). 
14. Real-time PCR thermocycler. 
15. Fluorometer (Invitrogen Qubit or equivalent). 
16. Device for capillary electrophoresis of DNA fragments (Lab-
chip HT Perkin-Elmer with dedicated consumables/reagents 
or equivalent). 
17. Illumina sequencer and dedicated consumables and chemistry. 
2.4 
Bioinformatics 
Analyses 
1. FastQC (v. 0.12.0) (https://www.bioinformatics.babraham.ac. 
uk/projects/fastqc/). 
2. Fastp (v. 0.23.1) (https://github.com/OpenGene/fastp). 
3. BWA (v. 0.7.17) (https://bio-bwa.sourceforge.net/). 
4. Samtools (v. 1.14) (http://www.htslib.org/). 
5. SPAdes (v. 3.15.1) (https://github.com/ablab/spades). 
6. QUAST (v. 5.2.0) (https://quast.sourceforge.net/). 
7. CAP3 (Version Date: 02/10/15) (https://doua.prabi.fr/ 
software/cap3). 
8. DIAMOND (v. 2.0.15) (https://github.com/bbuchﬁnk/ 
diamond). 
9. MEGAN6 Community Edition (v. 6.24.23) (https://software-
ab.cs.uni-tuebingen.de/download/megan6/welcome.html). 
3 
Methods 
3.1 
Herbarium Plant 
and Soil Sampling 
The protocol was successfully implemented on DNA extracted 
from roots and associated rhizospheric soil (Fig. 1) of different 
plant species stored in herbaria for 115–120 years. For each plant 
specimen, about 20 ca. 0.5 cm-long root fragments are collected 
using sterile ﬁne tweezers and scalpel blades. Soil particles aggre-
gated around the roots (between 10 and 100 mg per plant speci-
men (Fig. 1)) are detached from the roots and collected using 
tweezers. Root and soil samples are transferred into sterile tubes 
and stored at room temperature before DNA extraction.

Identiﬁcation of DNA Viruses in Ancient DNA
225
Fig. 1 Root system of herbarium specimen of Triticum aestivum collected in 
1856 before (a) and after (b) the sampling of fragments of root and 
rhizospheric soil 
3.2 
DNA Extraction
This protocol is a modiﬁed version of [12]’s “Cold Spin Extrac-
tion” method (see Note 2). 
1. Preheat the SLBconc buffer at 50 °C. 
2. For each sample, weigh up to 250 mg of soil, or up to 50 mg of 
root in a 2 mL microtube. Prepare one extraction blank (no soil 
or root sample) for every series of extractions (i.e., for a total of 
16 extractions, consider 15 samples and 1 extraction blank). 
3. Transfer each sample in a single PowerBead tube provided in 
the DNEasy Powersoil Pro kit (already containing garnet beads 
and 750 μL of 181 mM NaPO4 and 121 mM of guanidinium 
isothiocyanate). 
4. Rinse each sample tube with 500 μL of SLBconc solution to 
collect the leftover of soil/root samples attached to the tube 
walls. Transfer the suspension to the corresponding Power-
Bead tube (making up a ﬁnal volume of 1250 μL of digestion 
solution). 
5. Homogenize the samples by a 5 min agitation of the Power-
Bead tubes in a mixer mill at a 25 beats/s mixing frequency. If 
necessary, repeat this step once or twice to obtain a homoge-
neous suspension. 
6. Add 16 μL of 20 mg/mL proteinase K solution (for a ﬁnal 
concentration of approx. 0.25 mg/mL in the digestion 
solution).

226
Gianluca Grasso et al.
7. Set the PowerBead tubes in a rotating shaker (speed 16–-
18 rotations/min) for an overnight digestion (20–24 h) in a 
hybridization oven at 35 °C in the dark. Ensure that the diges-
tion solution, sample, and PowerBeads are moving at each 
oscillation. 
8. Remove PowerBead tubes from the oven and centrifuge 5 min 
at 10,000 g (the maximum speed recommended for Power-
Bead tubes). 
9. Transfer supernatants to a DNA low-binding 2 mL tube and 
freeze them at -20 °C. Recover as much digest solution as 
possible at this step. Tiny portions of the pellet can be pipetted 
without consequences (they will be eliminated on step 13). 
The extraction protocol can be stopped after this step (usually 
until the next day). 
10. Preheat the EBT buffer at 30 °C. 
11. Thaw the digested supernatants and centrifuge them brieﬂy. 
Pipet each of them into a 15 mL Falcon tube ﬁlled with 13 mL 
of BB. 
12. Spin the Falcon tubes at 3000 g for a minimum of 3 h (up to 
overnight) in a refrigerated centrifuge at 4 °C. 
13. Decant the supernatant after centrifugation, not disturbing the 
dark pellet at the bottom of the tube and add it to a high-
volume silica column (high pure extender assembly). 
14. Centrifuge the high-volume silica columns at 1000 g for 2 min. 
In case the entire volume has not passed through, renew the 
centrifugation step. 
15. Detach the silica column from the assembly and put it in a 2 mL 
collection tube. 
16. Add 500 μL of the inhibitor removal buffer of the high pure 
viral nucleic acid large volume to the column and centrifuge at 
3000 g for 1 min at room temperature. 
17. After centrifugation, transfer the column to a new collection 
tube and add 450 μL of the wash buffer (high pure viral nucleic 
acid large volume) to the column. Centrifuge at 6500 g for 
1 min at room temperature. 
18. Repeat step 17 for a second wash. 
19. Transfer the column to a new collection tube and centrifuge to 
dry the silica columns at 15,000 g for 1 min. 
20. Elute the DNA off the silica column with 25 μL EBT. Centri-
fuge at 15,000 g for 1 min. 
21. Repeat step 20 for a total elution volume of 50 μL. 
22. Total DNA estimate is performed via ﬂuorometric quantitation 
of 1 μL of each extract.

f
Identiﬁcation of DNA Viruses in Ancient DNA
227
23. Store the extracted DNA at -20 °C until processed into 
libraries and at -80 °C for long-term storage. 
3.3 
Library 
Preparation and 
Sequencing 
This protocol is a modiﬁed version of the dsDNA library prepara-
tion method by [11], implementing the double indexing strategy 
of [12]. All specimen extracts and blank extractions are to be 
processed in the same way. 
3.3.1 
Truncated Adapter 
Preparation 
1. Incubate the 200 μM truncated P5 and P7 mixes 10 min at 95 ° 
C and let them cool down to 12 °C slowly at -0.1 °C/s. 
2. Mix equal amounts of truncated P5 and P7 to obtain a 100 μM 
P5+P7 adapter mix. Vortex mix and centrifuge brieﬂy. 
3. Aliquot the adapter mix and freeze. Use each aliquot only once 
and then discard. 
3.3.2 
Universal Library 
Preparation 
1. Prepare an End-Repair reaction premix containing: 5 μL o  
10X NEBNext End-Repair buffer, 2.5 μL of NEBNext 
End-Repair Enzyme mix, and 27.5 μL of nuclease-free water 
per library. 
2. Use 35 μL of the premix for each individual library. Add 15 μL 
of DNA extract (it is not necessary to use a speciﬁc quantity of 
DNA for library construction) for a ﬁnal reaction volume of 
50 μL. 
3. Incubate 15 min at 25 °C. Transfer at least 5 min at 4 °C. 
4. Proceed with a Minelute puriﬁcation using 6 volumes (300 μL) 
of PBacidic for one volume of repaired DNA. Elute the DNA off 
the silica column twice with 15 μL of EBT for a ﬁnal volume of 
approximately 29 μL. 
5. Dilute a P5+P7 adapter mix aliquot to 20 μM. Make up a 
ligation premix containing: 10 μL of 5X NEBNext T4 quick 
ligation buffer, 7.5 μL of nuclease-free water, and 2.5 μL of the 
diluted adapter mix. 
6. Add 20 μL of that premix to each library. Vortex mix and 
centrifuge brieﬂy. 
7. Add 1.5 μL of NEBNext T4 ligase to each individual library for 
a reaction volume of 50 μL (ﬁnal concentration of 12 U of 
ligase/μL and 1 μM of P5+P7 adapter mix). 
8. Incubate 90 min at 22 °C. 
9. Proceed with a Minelute puriﬁcation using 5 volumes (250 μL) 
of PBacidic for binding DNA. Elute each library twice with 
15 μL of EBT for a ﬁnal volume of approximately 29 μL.

228
Gianluca Grasso et al.
10. Prepare a ﬁll-in reaction premix with the following reagents: 
4 μL of nuclease-free water 4 μL of 10X Thermopol buffer, 
1 μL of 10 mM dNTPs, and 2 μL of  Bst polymerase large 
fragment (16 U per reaction). 
11. Dispense 11 μL of the ﬁll-in premix into each library tube (for a 
total reaction volume of 40 μL containing 1X Thermopol 
buffer and 250 μM of each dNTP). Vortex and quick spin. 
12. Incubate 20 min at 37 °C and then transfer at 80 °C for 
another 20 min incubation. Store libraries at -20 °C. 
3.3.3 
Library Indexing 
and Characterization 
1. Amplify 10 μL of each library using a unique pair of custom P5 
and P7 indexing primer in a PCR reaction using 1X SsoAd-
vanced Supermix and 500 nM of each primer. Due to various 
levels of inhibitions between samples, the total reaction volume 
can be adjusted from 40 (by default) up to 100 μL. 
2. Perform the PCR ampliﬁcation of the libraries in real-time with 
the following conditions: 2 min of hot start denaturation at 
98 °C, followed by 20 cycles of 10 s at 98 °C, 20 s at 60 °C, and 
20 s at 72 °C. 
3. Address the level of ﬂuorescence for each library separately at 
each cycle: Remove individual libraries from the thermocycler 
when they show a start in the plateau phase of the ampliﬁcation. 
4. Quantify each ampliﬁed library via ﬂuorometric quantiﬁcation. 
5. Dilute the library according to the requirements of your capil-
lary electrophoresis equipment. For a Labchip HT characteri-
zation, libraries are diluted to a 0.2–2.0 ng/μL range and 
evaluated with the NGS 3k chip and consumables. 
6. Based on both ﬂuorometric quantiﬁcation and electrophoretic 
size distribution of the fragments, calculate the molarity of each 
individual library. 
3.3.4 
Pooling and 
Sequencing 
1. Make an equimolar pool of the libraries to sequence, based on 
their estimated molarity. 
2. Make an SPRI puriﬁcation of the pool using 1.25× volume of 
NucleoMag puriﬁcation beads. 
3. Estimate the molarity of this ﬁnal pool (via ﬂuorometric and 
electrophoretic analyses) and prepare the Illumina sequencing 
accordingly. 
4. Perform the shotgun sequencing of the pooled libraries on the 
relevant 
Illumina 
platform/chemistry. 
In 
our 
case, 
we 
sequenced the pool of DNA libraries made from either the 
roots or the soils herbarium samples on a NovaSeq 6000 
platform in paired-end sequencing (2*50 bp). We aimed at 
generating approximately 20 million reads for each library.

o
Identiﬁcation of DNA Viruses in Ancient DNA
229
3.4 
Bioinformatics 
Analyses 
1. Check quality of the reads using FastQC [13] and visualize the 
HTML reports generated by FastQC using a web browser. 
>fastqc path_to_sample_name.fq.gz 
3.4.1 
Preprocessing 
(Quality Control, Trimming 
and Merging) 
2. Trim the reads to remove primer sequences and short reads and 
merge paired reads with Fastp [14] using the following com-
mand. For the trimming, use the default commands except for 
the -l option (length of reads to trim) which has to be set to 
25 nucleotides and the --overlap_len_require option (overlap 
needed between different pair reads, default value 30) which is 
here lowered to 10 nucleotides. These parameters are here 
adapted to the short length of the reads, i.e., usually less than 
100 bp for ancient/historical DNA obtained from herbarium 
samples. As -l value was chosen 25 nucleotides to facilitate 
merging, mapping, and assembly, to achieve high accuracy, 
since the trimmed sequences are longer than the default param-
eter of fastp (15 nucleotides) (see Note 3). 
>fastp -h -g -l 25 --adapter_fasta list_adapter.fasta --over-
lap_len_require 10
-m -I sample_name_R1.fq -I sample_name_R2.fq -o sam-
ple_name_R1_trim.fastq.gz -O sample_name_R2_trim.fastq.gz
--merged_out sample_name_trim_merge.fastq.gz --unpaired1 
sample_name_R1_trim_unpaired.fastq.gz
--unpaired2 
sam-
ple_name_R2_trim_unpaired.fastq.gz 
3.4.2 
Removal of Reads 
Mapping to Reference Plant 
Genomes 
Sequences are then mapped to the corresponding plant reference 
genome (using available genomes present in the NCBI genomes 
database, 
https://www.ncbi.nlm.nih.gov/home/genomes/)
t
 
remove the plant nuclear, mitochondrial, and plastid genomes 
from the metagenomic datasets. The tool BWA aln [15], appropri-
ate for processing short sequences, is used for mapping Illumina 
reads to the plant genomes. Sequences that do not map to plants 
are then extracted using Samtools [16]. The hypothesis is that they 
correspond to the host plant microbiome (i.e., eubacteria, archaea, 
fungi, and viruses). 
1. Index the reference plant genome downloaded from the NCBI 
genomes database. 
>bwa index -a bwtsw reference_genome.fasta 
2. Align the merged sequences to the plant reference genome. 
>bwa 
aln 
reference_genome.fasta 
sample_name_trim_-
merge.fastq.gz> sample_name_trim_merge.sai 
3. Convert alignment in SAM format. 
>bwa samse reference_genome.fasta sample_name_trim_-
merge.sai sample_name_trim_merge.fastq.gz >sample_name_-
trim_merge.sam 
4. Convert SAM ﬁle into BAM ﬁle.

230
Gianluca Grasso et al.
>samtools view -b -S sample_name_trim_merge.sam >sam-
ple_name_trim_merge.bam 
5. Sort the BAM ﬁle. 
>samtools sort sample_name_trim_merge.bam -o sample_-
name_trim_merge_sort.bam 
6. Index the BAM ﬁle. 
>samtools index sample_name_trim_merge_sort.bam 
7. Calculate ﬁnal statistics. 
>samtools ﬂagstat sample_name_trim_merge_sort.bam > 
sample_name_statistic_mapping.txt 
8. Select unmapped sequences. 
>samtools view -b -f 4 sample_name_trim_merge_sort.bam 
> sample_name_trim_merge_sort_unmapped.bam 
9. Recovery fastq ﬁles for the unmapped sequences. 
>samtools fastq sample_name_trim_merge_sort_unmapped. 
bam > sample_name_unmapped.fq 
10. To exclude any contamination from sample manipulation in 
the herbaria, during sampling and analysis, repeat the same 
alignment procedure on the unmapped reads using the most 
recent version of the human genome (GCF_000001405.26) as 
reference genome. 
3.4.3 
De novo Assembly
1. Perform the de novo assembly of the reads using the software 
SPAdes with default parameters (see Note 4). 
>
spades.py
-s
sample_name_unmapped.fq.gz
-o 
spades_results_sample_name/ 
2. Evaluate the assembly (i.e., number of assembled scaffolds, 
N50, 
N90, 
scaffold 
length 
distribution) 
with 
the 
tool 
QUAST, using default parameters (see Note 5). 
> quast.py -k spades_results_sample_name/contigs.fasta spa-
des_results_sample_name/scaffolds.fasta --single clean_reads.fq. 
gz -o quast_results_sample_name/ 
3. Collapse 
redundant 
scaffolds 
with 
CAP3 
using 
default 
parameters. 
> 
cap3 
spades_results_sample_name/scaffolds.fasta
-x 
sample_name 
4. Concatenate in one ﬁle the obtained contigs and singlets 
sequences. 
> cat spades_results_sample_name/scaffolds.fasta.sample_-
name.contigs 
spades_results_sample_name/scaffolds.fasta.sam-
ple_name.singlets > sample_name_cap3.fasta 
3.4.4 
Identiﬁcation of 
Viral Sequences 
To identify viral sequences, contigs are aligned against a protein 
reference database using the DIAMOND tool. A nonredundant 
protein database needs to be downloaded and formatted according 
to the following steps.

Identiﬁcation of DNA Viruses in Ancient DNA
231
1. Download the nonredundant (nr) protein database from the 
NCBI website. 
> wget ftp://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/nr.gz 
2. Download the ﬁle that maps NCBI protein accession numbers 
to taxon ids form the NCBI website. 
> wget ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy/accession2 
taxid/prot.accession2taxid.FULL.gz 
3. Download the nodes.dmp and names.dmp ﬁles from the NCBI 
taxonomy website. 
> wget ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy/taxdmp. 
zip 
4. Create a DIAMOND-formatted database ﬁle (see Note 6). 
> diamond makedb --in nr.gz -d nr.dmnd --taxonmap prot. 
accession2taxid.FULL.gz --taxonnodes nodes.dmp --taxonnames 
names.dmp 
5. Run DIAMOND in blastx-mode and save the output in a 
tabular ﬁle (see Note 7). 
> diamond blastx -f 6 –sensitive –quiet -d nr.dmnd -q 
sample_name_cap3.fasta -o sample_name.csv 
6. Run DIAMOND in blastx-mode and save the output into 
DIAMOND alignment archive (DAA) supported by MEGAN. 
> diamond blastx -d nr.dmnd -q sample_name_cap3.fasta
-a sample_name.daa 
3.4.5 
Visualize DIAMOND 
Results 
The taxonomic distribution of the contigs annotated with DIA-
MOND can be then visualized with the tool MEGAN6. 
1. Download the ﬁle mapping NCBI-nr accessions “megan-map-
Feb2022.db.zip” to taxonomic and functional classes (NCBI, 
GTDB, EC, eggNOG, InterPro2GO, and SEED) from https:// 
software-ab.cs.uni-tuebingen.de/download/megan6/welcome. 
html and unzip it. 
2. Open MEGAN6, click on the “File” menu, and select “Import 
From BLAST.” In the tab “Files,” at the point n.1, import your 
DAA ﬁle, and in the tab “Taxonomy,” click on “Load Mega-
nMapDB mapping ﬁle” and load the ﬁle “megan-map-
Feb2022.db.” Click on “Apply” to visualize your data (Fig. 2). 
3. To extract viral contig sequences, select the node of interest, 
open the drop-down menu by clicking the right mouse button 
and select the “Extract reads” option.

232
Gianluca Grasso et al.
Fig. 2 Visualization of DIAMOND results using MEGAN6. The red square indicates viral taxonomic nodes 
4 
Notes 
1. When preparing the BB buffer, note that the reaction is endo-
thermic and that Guanidinium will only go into solution once 
the nuclease-free water is added to the mix. 
2. DNA extraction was performed using the former PowerBead 
tubes from the DNA Powersoil kit (QIAGEN). It can readily 
be applied using the current version of the DNEasy Powersoil 
Pro kit (QIAGEN) by modifying step 3 in Subheading 3.2. 
The tubes in the new kit contain only the beads; it is thus 
necessary to add, before step 4, 750 μL of the CD1 solution 
(from the same kit).

Identiﬁcation of DNA Viruses in Ancient DNA
233
3. Use -h option for obtaining result report on HTML, -g for 
removing polyG, -m for merging the reads, -adapter_fasta for 
indicating the fasta list of adapters (that contained adapters and 
their reverse complement). As indicated in the main text, the -
overlap_len_require option was also introduced to reduce the 
overlap length during merging (from 30, default, to 10 nucleo-
tides). Finally, with -q option, it is also possible to eliminate all 
the reads below a certain quality threshold. In our case, the raw 
data (in the FastQC reports) showed high quality, and the -q 
option was not used. 
4. Use -t option for setting the number of threads and -m option 
to set memory limit in Gb, according to the characteristics of 
your IT infrastructure. 
5. Use -t option for setting the number of threads and -m option 
to set memory limit in Gb, according to the characteristics of 
your IT infrastructure. Use -silent option if you do not want 
printed on screen detailed information about each step; the 
information will be stored anyway in the log ﬁle. 
6. Use -p option for setting the number of threads according to 
the characteristics of your IT infrastructure. By default, DIA-
MOND uses all available threads. 
7. Use -p option for setting the number of threads according to 
the characteristics of your IT infrastructure. By default, DIA-
MOND uses all available threads. Use -e option to set the 
e-value threshold to report an alignment. Use -f option to 
format the output ﬁle. Use –sensitive option to enable the 
sensitive mode designed for full sensitivity for hits of >40% 
identity. Use -k option to set the maximum number of target 
sequences per query to report alignments for. Use –quiet 
option to disable all terminal output. 
Acknowledgments 
Work on ancient plant-associated microbiota was supported by the 
Muse´um National d’Histoire Naturelle grant ATM 2021 (Holo-
Herbier). GG was supported by a PhD grant from the University of 
Turin and a mobility grant from the franco-italienne University 
(Programma Vinci 2022). We would like to thank the curators 
and staff of the herbaria of the Muse´um National d’Histoire Nat-
urelle in Paris, of the Lyon botanical garden and of the Universities 
of Montpellier, Lyon, and Clermont-Auvergne to give us access to 
herbarium 
specimens 
for 
implementation 
of 
the 
protocols 
described in this chapter. We thank the “Plateau de Pale´oge´nomi-
que et Ge´ne´tique Mole´culaire” (P2GM, MNHN, Paris), for grant-
ing access to their resources and facility.

234
Gianluca Grasso et al.
References 
1. Antonovics J, Hood ME, Thrall PH et al 
(2003) Herbarium studies on the distribution 
of anther-smut fungus (Microbotryum viola-
ceum) and Silene species (Caryophyllaceae) in 
the eastern United States. Am J Bot Oct 
90(10):1522–1531 
2. Lees DC, Lack HW, Rougerie R et al (2011) 
Tracking origins of invasive herbivores through 
herbaria and archival DNA: the case of the 
horse-chestnut leaf miner. Front Ecol Environ 
9:322–328 
3. Bradshaw M, Tobin PC (2020) Sequencing 
herbarium specimens of a common detrimental 
plant disease (Powdery Mildew). Phytopathol-
ogy 110(7):1248–1254 
4. Yoshida K, Schuenemann VJ, Cano LM et al 
(2013) The rise and fall of the Phytophthora 
infestans lineage that triggered the Irish potato 
famine. elife 2:e00731 
5. Campos PE, Groot Crego C, Boyer K et al 
(2021) First historical genome of a crop bacte-
rial 
pathogen 
from 
herbarium 
specimen: 
insights into citrus canker emergence. PLoS 
Pathog 17(7):e1009714 
6. Kocher A, Papac L, Barquera R et al (2021) 
Ten millennia of hepatitis B virus evolution. 
Science 374(6564):182–188 
7. Bonczarowska JH, Susat J, Mu¨hlemann B et al 
(2022) Pathogen genomics study of an early 
medieval 
community 
in 
Germany 
reveals 
extensive co-infections. Genome Biol 23(1): 
250 
8. Rieux A, Campos P, Duvermy A et al (2021) 
Contribution of historical herbarium small 
RNAs to the reconstruction of a cassava mosaic 
geminivirus 
evolutionary 
history. 
Sci 
Rep 
11(1):21280 
9. Malmstrom CM, Shu R, Linton EW et al 
(2007) Barley yellow dwarf viruses (BYDVs) 
preserved in herbarium specimens illuminate 
historical disease ecology of invasive and native 
grasses. J Ecol 95:1153–1166 
10. Meyer M, Kircher M (2010) Illumina sequenc-
ing library preparation for highly multiplexed 
target capture and sequencing. Cold Spring 
Harb Protoc 2010(6):pdb.prot5448 
11. Kircher M, Sawyer S, Meyer M (2012) Double 
indexing overcomes inaccuracies in multiplex 
sequencing on the Illumina platform. Nucleic 
Acids Res 40(1):e3 
12. Murchie TJ, Kuch M, Duggan AT et al (2021) 
Optimizing extraction and targeted capture of 
ancient environmental DNA for reconstructing 
past 
environments 
using 
the 
PalaeoChip 
Arctic-1.0 bait-set. Quat Res 99:305–328 
13. Andrews S (2010) FastQC: a quality control 
tool for high throughput sequence data. Avail-
able online at: http://www.bioinformatics. 
babraham.ac.uk/projects/fastqc/ 
14. Chen S, Zhou Y, Chen Y, Gu J (2018) fastp: an 
ultra-fast all-in-one FASTQ preprocessor. Bio-
informatics 34(17):i884–i890 
15. Li H, Durbin R (2009) Fast and accurate short 
read alignment with Burrows-Wheeler trans-
form. Bioinformatics 25:1754–1760 
16. Danecek P, Bonﬁeld JK, Liddle J et al (2021) 
Twelve years of SAMtools and BCFtools. Giga-
science 10(2):giab008

Chapter 16 
The Oxford Nanopore MinION as a Versatile Technology 
for the Diagnosis and Characterization of Emerging Plant 
Viruses 
Giulia Tarquini, Simone Maestri, Paolo Ermacora, and Marta Martini 
Abstract 
The emergence of novel viral epidemics that could affect major crops represents a serious threat to global 
food security. The early and accurate identiﬁcation of the causative viral agent is the most important step for 
a rapid and effective response to disease outbreaks. Over the last years, the Oxford Nanopore Technologies 
(ONT) MinION sequencer has been proposed as an effective diagnostic tool for the early detection and 
identiﬁcation of emerging viruses in plants, providing many advantages compared with different high-
throughput sequencing (HTS) technologies. Here, we provide a step-by-step protocol that we optimized 
to obtain the virome of “Lamon bean” plants (Phaseolus vulgaris L.), an agricultural product with Protected 
Geographical Indication (PGI) in North–East of Italy, which is frequently subjected to multiple infections 
caused by different RNA viruses. The conversion of viral RNA in ds-cDNA enabled the use of Genomic 
DNA Ligation Sequencing Kit and Native Barcoding DNA Kit, which have been originally developed for 
DNA sequencing. This allowed the simultaneous diagnosis of both DNA- and RNA-based pathogens, 
providing a more versatile alternative to the use of direct RNA and/or direct cDNA sequencing kits. 
Key words Plant virology, Emerging pathogens, High-Throughput Sequencing (HTS), Oxford 
Nanopore Technologies (ONT), Third-generation sequencing technology, Long reads 
1 
Introduction 
Emerging pathogens, also referred to as “alien pathogens,” repre-
sent a major issue for agricultural crops, seriously threatening the 
global food industry [1, 2]. Devastating epidemics have already 
occurred in the past [3–6], mostly due to the lack of effective 
diagnostic techniques, and appropriate disease control strategies. 
Thus, early detection of novel and yet unknown pathogens is of 
paramount importance for plant disease management, mostly for 
viral infections. For the latter, a timely diagnosis is also crucial to 
limit the spread of the insect vector(s), providing an efﬁcient tool 
particularly relevant for high-value perennial crops [4]. 
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_16, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
235

236
Giulia Tarquini et al.
The diagnostic procedures commonly used in plant virology to 
detect plant viruses, such as PCR and DAS-ELISA, have several 
limitations, including the need for a-priori knowledge of the 
genome sequence, low sensitivity especially when referring to sero-
logical techniques, and a limited ability to detect several pathogens 
simultaneously [7]. 
Over the last decade, the advent of high-throughput sequenc-
ing (HTS) technologies has provided a successful alternative to the 
conventional diagnostic assays [8, 9]. The MinION, a third-
generation sequencing platform by Oxford Nanopore Technolo-
gies (ONT), has been proposed as an effective diagnostic tool for 
routine laboratory diagnosis [10, 11]. MinION shows many advan-
tages over the widely used HTS approaches. In particular, (1) it 
produces long reads, that are easier to map to a reference genome 
or to perform de novo assembly (2) it has faster turnaround times, 
allowing to monitor the data production in real time, stopping the 
sequencing upon reaching the desired throughput; (3) it requires 
small amount of nucleic acids; and (4) it is portable and does not 
require an expensive infrastructure [7, 11]. Accordingly, the 
sequencing run can be easily performed in every laboratory, requir-
ing only minimal training. 
Nanopore sequencers identify nucleotides by measuring the 
changes in electrical conductivity generated, while DNA or RNA 
strands pass through a biological pore and record the magnitude of 
the current in the nanopore in fast5 format. A MinION ﬂow-cell 
includes 2048 pores, connected to 512 channels, which are capable 
of sequencing in parallel [12]. 
Apart from the sequencing chemistry, the base-caller, namely, 
the software converting raw electric signal to a sequence of nucleo-
tides, has a great impact on the sequencing accuracy [13]. Despite 
the great improvements that occurred in the last years, MinION 
reads still suffer from an error rate in the range of 2–10%, consis-
tently higher than those produced by PacBio CCS and Illumina 
platforms [14]. Recently, new kits and base-callers are being devel-
oped, which claim to reduce the error rate below 1% [15, 16]. Com-
pared with Illumina short-reads platform, few bioinformatic 
approaches have been speciﬁcally developed for the analysis of 
data 
generated 
with 
Oxford 
Nanopore 
platform 
to 
date 
[13, 17]. However, some of the available approaches can be 
adapted to work with Nanopore reads, by adjusting software para-
meters [18]. The choice of the most suitable and best performing 
bioinformatic approach should consider many aspects, such as the 
complexity of the sample under study, the quality of sequencing 
reads, the availability of a priori knowledge and the requested 
computational resources. 
Under the term “metagenomics,” two main groups of experi-
mental approaches can be identiﬁed: Metabarcoding and shotgun 
metagenomics. We refer to meta-barcoding when a speciﬁc gene

(e.g., 16S for bacteria and Internal transcribed spacer (ITS) regions 
for fungi) shared by all organisms of interest present in a sample is 
PCR ampliﬁed using universal primer sets and sequenced. Con-
versely, we refer to shotgun metagenomics when the whole genome 
of all organisms present in a sample is sequenced [19, 20]; thus, for 
viruses that do not possess a marker gene, shotgun metagenomics 
has been widely used for their detection and characterization. 
MinION Technology as a Diagnostic Tool for Emerging Viruses
237
Metagenomic approaches generally aim to obtain a taxonomic 
characterization of complex samples, resulting in a list of taxa 
detected in the sample and their relative abundance estimates and, 
potentially, in a set of new genome assemblies. As a ﬁrst step, reads 
are usually either mapped or aligned to a reference database. 
Although the two terms are frequently used in an interchangeable 
way, mapping of sequences to taxa does not necessarily provide a 
base-to-base alignment and can be achieved using k-mer- or 
FM-based indexing schemes [18, 20]. These strategies are imple-
mented in tools such as Centrifuge [21] and Kraken 2 [22], which 
rely on indexed databases. Although usually quicker, these methods 
do not provide alignment identities, and their output may be less 
intuitive for an effective interpretation of the results. 
Conversely, aligners such as Blast [23], Minimap2 [24], LAST 
[25], and VSEARCH [26] may be used to align each sequence to a 
reference database, and the alignment ﬁle may be postprocessed to 
retain alignments with a minimum length and percentage identity 
or to deal with multimapping reads. For more in-depth analyses 
aimed at studying novel viral strains or for comparative genomics 
projects, sequencing reads may be de novo assembled into 
metagenome-assembled genomes (MAGs, [27]) with tools like 
Canu [28] or metaFlye [29]. The obtained genome assemblies 
may also be used for compiling custom databases which, in turn, 
may be used as a reference for subsequent analyses. Shotgun meta-
genomics approaches are suitable to obtain an unbiased characteri-
zation of the sample, as relative abundances are not biased by PCR 
primers efﬁciency [20, 29]. 
Finally, the composition of the reference database is another 
critical aspect, since it strongly inﬂuences the percentage of 
sequences 
correctly 
assigned 
to 
different 
taxonomic 
levels 
[18]. The difference in size of the adopted database may largely 
affect both computational processing time and classiﬁcation accu-
racy. In fact, the classiﬁcation of a taxon not yet reported in the 
database represents a challenging scenario for the taxonomic classi-
ﬁer; ideally, the classiﬁer should be able to identify the nearest 
taxonomic lineage to which this taxon belongs, but no further [30]. 
We recently exploited a metagenomics approach based on Min-
ION platform to investigate the virome of Lamon bean (Phaseolus 
vulgaris L.), an agricultural product with Protected Geographical 
Indication (PGI), grown in a speciﬁc area of production, which is 
located in the Belluno district, Veneto region (North–East of Italy)

[10]. Several library construction methods, which have been 
recently reviewed [31], are available nowadays to achieve sequenc-
ing of all types of plant viruses (DNA viruses, RNA viruses with or 
without Poly(A) tails) using nanopore sequencing technology. 
Thus, researchers should choose a suitable strategy according to 
the characteristics of target viruses. In our study, we performed the 
conversion of viral RNA in ds-cDNA enabling the use of Genomic 
DNA Ligation Sequencing Kit and Native Barcoding DNA Kit, 
which have been originally developed for DNA sequencing. This 
allowed, toward proper modiﬁcations of the original protocol 
provided by ONT, the simultaneous sequencing, and thus diagno-
sis, of both DNA- and RNA-based pathogens, providing a more 
versatile alternative to the use of direct RNA and/or direct cDNA 
sequencing kits. A single sequencing run allowed a high-
throughput screening of infection status of the plants, at both 
qualitative and quantitative levels. In fact, since the barcodes were 
ligated without the use of PCR, the number of viral reads assigned 
to each Lamon bean plant could be directly linked to the viral 
load [10]. 
238
Giulia Tarquini et al.
Moreover, in our study, MinION sequencing allowed us to 
generate the partial genome sequence of Bean yellow mosaic virus 
(BYMV). BYMV contigs were aligned to the genome sequence 
available in NCBI database and showed only approximately 90% 
sequence identity, suggesting the emergence of a new BYMV strain 
[10, 32, 33]. 
In conclusion, our work clearly demonstrated that MinION 
platform could be used as a robust and highly versatile diagnostic 
tool for laboratory routine diagnosis, allowing early and unbiased 
detection of emerging viruses at the species and strain level. A 
graphical overview of the protocol established for the detection 
and characterization of emerging plant viruses through the use of 
ONT, as reported in Fig. 1. 
2 
Materials 
Use RNAse-free equipment and consumables, such as mortars, 
pestles, pipettes dedicated for RNA work, safe-seal Eppendorf 
tubes, and pipette ﬁlter-tips. 
2.1 
RNA Extraction
1. Spectrum™ Plant Total RNA-Kit (Sigma-Aldrich), according 
to the protocol “A” provided by the manufacturer with minor 
modiﬁcations. All the components included in the kit can be 
stored at room temperature. Follow all safety and waste dis-
posal regulations diligently during the experiment (see Note 1). 
2. RNAse-free mortars and pestles. 
3. Liquid nitrogen.

MinION Technology as a Diagnostic Tool for Emerging Viruses
239
Fig. 1 Graphical overview of the protocol applied for the diagnosis and characterization of emerging plant 
viruses through the Oxford Nanopore Technology (ONT) 
4. 2.0 and 1.5 mL microcentrifuge tubes. 
5. Pipette ﬁlter-tips (1000 μL; 200 μL; 10 μL). 
6. Scale for weighing tissue. 
7. Microcentrifuge. 
8. Heat block or water bath. 
9. 100% ethanol. 
2.2 
cDNA Synthesis
1. MaximaTM H-Minus Double-Stranded cDNA Synthesis Kit 
(Thermo Fisher Scientiﬁc) according to the manufactures pro-
cedure. The components included in the kit should be stored at
-20 °C (see Note 2). 
2. Pipette ﬁlter-tips (1000 μL; 200 μL; 10 μL). 
3. 0.2 mL thin-walled PCR tubes. 
4. PCR thermocyclers. 
5. 1.5 mL microcentrifuge tubes. 
6. GeneJET PCR Puriﬁcation Kit (Thermo Fisher Scientiﬁc). 
7. Spectrophotometer. 
2.3 
Library 
Construction 
1. Genomic DNA Ligation Sequencing Kit (SQK-LSK109; latest 
version SQK-LSK114) (see Note 3). 
2. Native Barcoding DNA Kit (EXP-NBD104; latest version 
SQK-NBD114.24). All the components included in the kits 
should be stored at -20 °C and kept on ice during the experi-
ment (see Note 3).

240
Giulia Tarquini et al.
2.3.1 
DNA Repair and 
End-Prep 
1. Pipette ﬁlter-tips (1000 μL; 200 μL; 10 μL). 
2. 1.5 mL microcentrifuge tubes. 
3. 0.2 mL thin-walled PCR tubes. 
4. Nuclease-free water. 
5. NEBNext FFPE DNA Repair Mix (New England Biolabs) (see 
Note 4). 
6. NEBNext Ultra II End repair/dA-tailing Module (New Eng-
land Biolabs) (see Note 4). 
7. Thermal cycler at 20 °C and 65 °C. 
2.3.2 
Puriﬁcation Steps
1. Pipette ﬁlter-tips (1000 μL; 200 μL; 10 μL). 
2. 1.5 mL Eppendorf tubes. 
3. PCR puriﬁcation kit for NGS (we use here Agencourt AMPure 
XP beads) (see Note 4). 
4. Nuclease-free water. 
5. Freshly prepared 70% ethanol in nuclease-free water. 
6. Rotator mixer. 
7. Magnetic rack. 
2.3.3 
Native Barcode 
Ligation 
1. Pipette ﬁlter-tips (1000 μL; 200 μL; 10 μL). 
2. 1.5 mL Eppendorf tubes. 
3. NEB Blunt/TA Ligase Master Mix (New England Biolabs) (see 
Note 4). 
4. Vortex mixer. 
5. Qubit ﬂuorometer (Thermo Fisher Scientiﬁc). 
2.3.4 
Adapter Ligation 
and Cleanup 
1. Pipette ﬁlter-tips (1000 μL; 200 μL; 10 μL). 
2. 1.5 mL Eppendorf tubes. 
3. NEBNext® Quick T4 DNA Ligase (New England Biolabs) (see 
Note 4). 
4. NEBNext® Quick Ligation Reaction Buffer (New England 
Biolabs) (see Note 4). 
5. Vortex mixer. 
6. Qubit ﬂuorometer. 
2.4 
Data Analysis
1. Laptop (i7 processor, 16 GB RAM, 500 GB SSD). 
2. Ubuntu v20.04.4 LTS operating system. 
3. MinKNOWN software. 
4. Guppy (Oxford proprietary software). 
5. NanoFilt software [34].

of
MinION Technology as a Diagnostic Tool for Emerging Viruses
241
6. Seqtk seq (https://github.com/lh3/seqtk). 
7. Parallel [35]. 
8. BLAST + [23]. 
9. R package taxize [36]. 
10. Krona [37]. 
11. Kraken 2 [22]. 
12. Canu v2.1.1 [28]. 
3 
Methods 
3.1 
RNA Extraction
Carry out all procedures at room temperature, unless otherwise 
speciﬁed. 
3.1.1 
Collect Plant Tissue
1. Collect leaf tissue and freeze immediately in liquid nitrogen to 
prevent RNA degradation. Prior to RNA extraction, samples 
are stored at -80 °C. 
2. Weigh approximately 50–80 mg of leaf tissue and grind to a 
ﬁne powder in liquid nitrogen, using a mortar and pestle. RNA 
yield often relies on how ﬁne the plant tissue has been ground, 
especially for high-demanding tissues that are difﬁcult to grind. 
For best practice, keep the plant material frozen all the time. 
3.1.2 
Tissue Lysing and 
Filtering 
1. An appropriate amount of Lysis Solution (500 μL per sample) 
is transferred to a clean conical tube, and 10 μL  
2-mercaptoethanol (2-ME) is added for every 1 mL of Lysis 
Solution. Some extra volume of solution will be needed when 
working with multiple samples. For best results, prepare the 
mixture immediately before use. Add 500 μL of the mixture 
(Lysis Solution and 2-ME) to tissue powder and grind until a 
homogenous solution is obtained. Transfer the entire homo-
geneous solution to a 2-mL microcentrifuge tube and vortex 
immediately and vigorously for at least 30 s. Incubate the 
samples at 56 °C for 3 min and cool at room temperature for 
additional 3–5 min. Centrifuge the tubes at maximum speed 
(14,000 rpm) for 3 min, to pellet cellular debris. 
2. Pipette the lysate supernatant (up to 700 μL) into a Filtration 
Column (blue retainer ring) seated in a 2-mL collection tube 
without disturbing the pellet and centrifuge at 14,000 rpm for 
1 min to remove residual debris. 
3.1.3 
RNA Binding to 
Column (Protocol A) 
1. Save the clariﬁed ﬂow-through lysate and add 750 μL of Bind-
ing Solution (see Note 1). Pipette up to 700 μL of the mixture 
into a binding column (red retainer ring) previously seated in a 
2-mL collection tube. Close the cap and centrifuge at

f
242
Giulia Tarquini et al.
14,000 rpm for 1 min to bind RNA. Decant the ﬂow-through 
liquid and tap the collection tube (upside down) brieﬂy on a 
clean absorbent paper to drain the residual liquid. Return the 
column to the collection tube and pipette the remaining mix-
ture to the binding column, repeating the centrifugation and 
decanting steps. 
3.1.4 
Column Washing
1. Wash the samples twice with 500 μL of Wash Solution 1, cen-
trifuge the tubes at 14,000 rpm for 1 min after washing step, 
and discard the ﬂow-through. 
2. Wash the samples once using wash solution 2 (previously 
diluted 
with 
100% 
ethanol), 
centrifuge 
the 
tubes 
at 
14,000 rpm for 30 s after washing step and discard the ﬂow-
through. 
3.1.5 
Column Drying
1. Centrifuge the empty tubes at 14,000 rpm for 1 min to dry the 
column, avoiding the presence of ethanol residues. 
3.1.6 
RNA Elution
1. Transfer the column to a clean 1.5-mL eppendorf tube and 
pipette 50 μL of elution solution directly onto the center of the 
binding matrix inside the column. Close the cap and let the 
tube sit for 2 min. Centrifuge at 14,000 rpm for 1 min to elute. 
Puriﬁed RNA is ready for immediate use or storage at -20 °C 
(short term) or -70 °C (long term). 
3.2 
cDNA Synthesis
1. Thaw reaction components, mix, brieﬂy centrifuge, and place 
on ice. 
3.2.1 
First Strand cDNA 
Synthesis
2. Add 2.5 μg of total RNA (see Note 5), 100 pmol of random 
hexamer primers, and nuclease-free water up to 14 μL, into a 
sterile, RNase-free tube. 
3. Mix gently, centrifuge brieﬂy and incubate at 65 °C for 5 min. 
4. In the same tube, and in the indicated order, pipette 5 μL of 4X  
First 
Strand 
Reaction 
Mix 
and 
1 
μL 
of 
First 
Strand 
Enzyme Mix. 
5. Mix gently, centrifuge and incubate for 10 min at 25 °C fol-
lowed by 30 min at 50 °C. 
6. Stop the reaction by heating tubes at 85 °C for 5 min. 
3.2.2 
Second Strand 
cDNA Synthesis 
1. In the same tube, and in the indicated order, pipette 20 μL of  
First Strand cDNA Synthesis Reaction Mixture, 55 μL o  
nuclease-free water, 20 μL of 5X Second Strand Reaction 
Mix, and 5 μL of Second Strand Enzyme Mix. 
2. Mix gently, centrifuge brieﬂy and incubate at 16 °C for 60 min. 
3. Stop the reaction by adding 6 μL of 0.5 M EDTA, pH 8.0 and 
mixing gently.

MinION Technology as a Diagnostic Tool for Emerging Viruses
243
3.2.3 
Removal of RNA 
and Puriﬁcation of ds-cDNA 
Since total RNA is used as a starting material, residual RNA should 
be removed from the ds-cDNA preparation. 
1. Pipette 10 μL of 100 U RNase-I to the second strand synthesis 
reaction tube and incubate for 5 min at room temperature. 
2. Purify blunt-end, ds-cDNA using the GeneJETTM PCR Puriﬁ-
cation Kit, to remove unincorporated dNTPs. 
3.2.4 
Analysis of ds-
cDNA Products 
1. The quantity and size distribution of the synthesized ds-cDNA 
can be estimated spectrophotometrically by measuring the 
absorbance at 260 nm and by gel analysis. 
3.3 
Library 
Construction 
1. Resuspend 300 ng of puriﬁed ds-cDNA in 49 μL of nuclease-
free water into a 0.2 mL thin-walled PCR tube. 
3.3.1 
DNA Repair and 
End-Prep 
2. Mix thoroughly by ﬂicking the tube and spin down brieﬂy. 
3. In the same tube, pipette 1 μL of DNA CS, 47 μL of DNA, 
3.5 μL of NEBNext FFPE DNA Repair buffer, 2 μL of NEB-
Next FFPE DNA Repair Mix, 3.5 μL of Ultra II End-prep 
reaction buffer, and 3 μL of Ultra II End-prep enzyme mix. 
4. Mix gently by ﬂicking the tube, spin down, and incubate at 20 ° 
C for 5 min followed by 65 °C for 5 min. 
3.3.2 
Puriﬁcation with 
AMPure XP Beads 
1. Transfer the end-prep reaction to a clean 1.5 mL Eppendorf 
tube, add 60 μL of resuspended AMPure XP beads, and mix by 
ﬂicking. 
2. Incubate the tubes on a rotator mixer for 5 min at room 
temperature, spin down the samples, and pellet on a magnet. 
3. Keep the tubes on the magnet, pipette off the supernatant, and 
wash the beads with 200 μL of freshly prepared 70% ethanol 
without disturbing the pellet. Discard the ethanol and repeat 
the previous step. 
4. Spin down, place the tube back on the magnet, and pipette off 
any residual ethanol. 
5. Dry the tubes for up to 30 s, without completely dry the pellet. 
6. Remove the tube from the magnetic rack and resuspend the 
pellet in 61 μL of nuclease-free water. Incubate the tubes for 
2 min at room temperature. 
7. Pellet the beads on a magnet until the eluate is clear and 
colorless. 
8. Remove and retain 61 μL of eluate into a clean 1.5 mL 
Eppendorf tube. 
3.3.3 
Native Barcode 
Ligation 
1. Thaw the Native Barcodes (one barcode per sample) at room 
temperature, mix by pipetting, and place them on ice. Select a 
unique barcode for every sample to be run together on the 
same ﬂow cell, from the provided 12 or 24 barcodes.

n
f
f
244
Giulia Tarquini et al.
2. Dilute 500 ng of each end-prepped sample to 22.5 μL i  
nuclease-free water. 
3. Combine 22.5 μl of the mixture with 2.5 μL of Native Barcode 
and 25 μL of Blunt/TA Ligase Master Mix. 
4. Mix well the tubes by pipetting and spin down. 
5. Incubate the reactions for 10 min at room temperature. 
6. Purify the barcoded ligated samples as described in the para-
graph “Puriﬁcation with AMPure XP beads” with the follow-
ing modiﬁcations. Use 50 μL of AMPure XP beads, instead of 
60 μL, wash the beads twice with 500 μL of fresh 70% ethanol, 
instead of 200 μL, and resuspend the pellet in 26 μL o  
nuclease-free water instead of 61 μL. 
7. Quantify 1 μL of eluted sample using Qubit ﬂuorometer. 
8. Pool equimolar amounts of each barcoded sample into a 
1.5 mL Eppendorf tube, ensuring that sufﬁcient sample is 
combined to produce a pooled sample of 700 ng total. 
9. Quantify 1 μL of pooled and barcoded DNA using a Qubit 
ﬂuorometer. 
10. Dilute 700 ng pooled sample to 65 μL in nuclease-free water. 
3.3.4 
Adapter Ligation 
and Cleanup 
1. Thaw Elution Buffer (EB) and NEBNext Quick Ligation Reac-
tion Buffer (5×) at room temperature, mix by vortexing, spin 
down, and place on ice. 
2. Spin down the T4 Ligase and the Adapter Mix II (AMII) and 
place on ice. 
3. To retain DNA fragments of all sizes, thaw one tube of Short 
Fragment Buffer (SFB) at room temperature, mix by vortexing, 
spin down, and place on ice. 
4. Pipette to 65 μL of pooled and barcoded DNA, 5 μL o  
Adapter Mix II (AMII), 20 μL of NEBNext Quick Ligation 
Reaction Buffer, and 10 μL of Quick T4 DNA ligase. 
5. Mix gently by ﬂicking the tubes, spin down, and incubate the 
reactions for 10 minutes at room temperature. 
6. Purify the ﬁnal library as described in the paragraph “Puriﬁca-
tion with AMPure XP beads,” using 50 μL of AMPure XP 
beads instead of 60 μL. 
7. Wash the beads twice with 250 μL of Short Fragment Buffer 
(SFB), instead of using 500 μL of fresh 70% ethanol. 
8. Resuspend the pellet in 15 μL of elution buffer and incubate for 
10 min at room temperature. 
9. Quantify 1 μL of adapter ligated DNA, using a Qubit 
ﬂuorometer. 
10. Before sequencing run, prime, and load the spotON ﬂow cell, 
according to the speciﬁc protocol provided with the ﬂow cell.

MinION Technology as a Diagnostic Tool for Emerging Viruses
245
3.4 
MinION 
Sequencing 
1. Pipette 12 μL of the ﬁnal DNA library, 37.5 μL of sequencing 
buffer (SB) and 25.5 μL of loading beads (LB) in a clean 
1.5 mL Eppendorf tube. 
2. Mix gently by pipetting just prior to loading. 
3. Load 75 μL of sample onto the SpotON port of the ﬂow cell. 
Ensure each drop ﬂows into the port before adding additional 
drops. 
4. Start the sequencing process. 
3.5 
Data Analysis
Data are collected by MinKNOW software in fast5 format. These 
ﬁles need to be base-called, to convert signal information in the 
sequence of nucleotides. Base-calling of raw fast5 ﬁles is carried out 
using 
Oxford 
Nanopore 
proprietary 
software 
Guppy, 
with 
command: 
guppy_basecaller -r -i <fast5_dir> -s <basecalled_dir> --ﬂowcell 
<ﬂow_cell> --kit <kit> 
3.5.1 
Data Acquisition 
and Preprocessing 
Reads are then demultiplexed, namely, sorted into different 
ﬁles based on the sample of origin, using Guppy with command: 
> guppy_barcoder -i <basecalled_dir> -s <demultiplexed_dir> --
trim_barcodes
--barcode_kits
<barcoding_kit>
--
require_barcodes_both_ends 
Afterward, reads are ﬁltered by quality with NanoFilt, required 
a minimum quality score of 7, and converted to fasta format with 
seqtk seq with command: 
> cat <ﬁle.fastq> | NanoFilt -q 7 | seqtk seq -A - > <ﬁle_ﬁltered. 
fasta> 
Scripts for reads preprocessing are reported in https://github. 
com/MaestSi/ONT_preprocessing repository. 
3.5.2 
Metagenomic 
Sequencing Data Analysis 
After reads from each sample have been preprocessed and sorted 
into different ﬁles, multiple bioinformatic strategies are available for 
taxonomic classiﬁcation. In case, the user is interested in obtaining 
the taxonomic composition of a sample, an aligner may be used to 
align each read to a database, providing alignment identity and 
query coverage for each read. The following strategy was adopted 
for studying the Lamon bean virome [10]. 
For this analysis, reads from each sample were split into smaller 
subsets and processed using Parallel, to reduce RAM memory 
usage. 
Reads from each subset were then aligned to a database of 
interest using Nucleotide–Nucleotide BLAST + [23]. To study 
the viral population of samples, the NCBI RefSeq Viral genome 
sequence database (ftp://ftp.ncbi.nlm.nih.gov/genomes/refseq/ 
viral) was used as the reference database [10]. Up to one top hit for

each read was retained in case the alignment identity and query 
coverage were higher than user-deﬁned thresholds. Filtered blast 
hits from each ﬁle were then merged, and a summary ﬁle was 
created containing the number of reads assigned to each taxon, 
together with the average alignment identity and query coverage; R 
package taxize was then used to retrieve the full taxonomy for each 
taxon [36]. Finally, the composition of each sample was plotted in 
the form of interactive pie charts using Krona [37]. Scripts for blast 
analysis are reported in https://github.com/MaestSi/MetaBlast 
repository. 
246
Giulia Tarquini et al.
Conversely, in case the user is interested in mapping each read 
to the most likely taxa while keeping the computational processing 
time smaller, Kraken 2 [22] may represent a good alternative to 
Blast analysis. Although this tool does not provide alignment iden-
tity and query coverage, it provides a conﬁdence score, which can 
be used for ﬁltering each read to taxa mappings. Again, the compo-
sition of each sample may be represented as an interactive pie chart 
with Krona [37]. Scripts for Kraken2 analysis are reported in 
https://github.com/MaestSi/MetaKraken2 repository. 
Moreover, we exploited a reference-guided genome assembly 
strategy to obtain metagenome-assembled genomes (MAGs) for 
BYMV virus (see Note 6). In particular, reads assigned to BYMV by 
blast analysis were extracted and aligned to BYMV genome 
sequence from NCBI (NC003492) with command: 
> minimap2 -ax map-ont BYMV_NC003492.fasta NB11_BYMV. 
fastq | samtools view -hSb | samtools sort -o BYMV_reads_map-
ped_to_BYMV_NC003492.bam 
Moreover, reads were de novo assembled with Canu v2.1.1 
[28] with command: 
> canu -p BYMV -d BYMV_Canu -genomeSize = 1k -minInput-
Coverage = 1 -stopOnLowCoverage = 1 -nanopore-raw BYMV. 
fastq 
The resulting contig was aligned to BYMV genome sequence as 
described above. The same procedure was followed for reads 
assigned to BCMV, CMV, and PSV viruses, but using the 
corresponding Sanger sequence as a reference. 
4 
Notes 
1. RNA was extracted according to the “Protocol A” included in 
the manufacturer’s instructions. “Protocol A” is recommended 
for tissues with high water content, which usually produce a 
very dilute cellular extract, as well as for tissues that contain low 
levels of RNA. Moreover, “protocol A” allows to recover the 
small-sized RNA molecules, such as microRNA, tRNA, or 5S

MinION Technology as a Diagnostic Tool for Emerging Viruses
247
rRNA. As compared to the “standard procedure,” the protocol 
A involves the use of a greater volume of Binding Solution, 
which allows to obtain an increased concentration of good 
quality RNA. Plants contain a great amount of diverse second-
ary metabolites, including polyphenolic compounds, tannins, 
and polysaccharides. To avoid contamination by these second-
ary metabolites, which often interfere with RNA extraction and 
its use in downstream applications, laborious procedures, and 
hazardous organic solvents are often required to obtain high-
quality RNA. Sigma’s Spectrum Plant Total RNA Kit employs a 
novel puriﬁcation chemistry to overcome the challenges of 
these interfering materials in a simple and streamlined manner, 
without using hazardous organic solvents such as phenol and 
chloroform, providing an efﬁcient method to purify total RNA 
from different tissues of both experimental model plants and 
high-demanding plant species, such as pine, grape, potato 
tuber, corn seed, and bean. 
2. The MaximaTM H-Minus Double-Stranded cDNA Synthesis 
Kit allows to obtain ds-cDNA from either total RNA or 
messenger (m)-RNA. Synthesis reactions of ﬁrst- and second-
strand cDNA are carried out in the same tube, avoiding inter-
mediate organic extraction or ethanol precipitation steps. This 
convenient one-tube format speeds up the synthesis procedure, 
maximizing cDNA recovery. Moreover, to reduce the number 
of pipetting steps, the kit contains premixed components. 
3. Several kits have been developed by ONT to accurately 
sequence DNA, RNA, or cDNA; thus, several library construc-
tion methods are available nowadays to achieve sequencing of 
all types of plant viruses (DNA viruses, RNA viruses with or 
without Poly(A) tails) using nanopore sequencing technology 
[31]. However, the choice of which kit is more appropriate for 
a speciﬁc experiment is not always trivial. In our case, the 
efﬁcient synthesis of double-stranded cDNA (ds-cDNA) from 
total RNA, including viral RNA, by the use of speciﬁc retro-
transcriptase 
enzymes 
(i.e., 
Maxima-H 
Minus 
Double-
Stranded cDNA Synthesis Kit) allowed to sequence, in a single 
run, both DNA and RNA, using Genomic DNA Ligation 
Sequencing Kit (SQK-LSK109) in combination with a Native 
Barcoding DNA Kit (EXP-NBD104). This aspect represents a 
great advantage for laboratories that investigate different 
pathogens, providing a valuable strategy for the simultaneous 
diagnosis of both DNA- and RNA-based pathogens, reducing 
costs, and simplifying experimental procedures. 
4. The puriﬁcation steps were carried out using Agencourt 
AMPure 
XP 
beads 
(A63880, 
Beckman 
Coulter, 
Inc. 
250 S. Kraemer Blvd. Brea, CA 92821 U.S), that should be 
stored at 4 °C. The NEBNextR products, such as NEBNext

248
Giulia Tarquini et al.
FFPE Repair Mix (M6630), NEBNext End repair/dA-tailing 
Module (E7546), and NEBNext Quick Ligation Module 
(E6056), as well as the NEB Blunt/TA Ligase Master Mix, 
should be stored at -20 °C and chilled in ice during the 
experiment. 
5. The amount of total RNA used for the synthesis of ds-cDNA 
strongly affects library preparation which, in turn, greatly 
impacts on the success of the sequencing run. In our previous 
work [29], preliminary experiments revealed that an excess of 
total RNA, ranging from 3 to 5 μg, negatively affected 
ds-cDNA 
synthesis, 
producing 
scarce 
quantities 
of 
low-quality ds-cDNA, and resulting in a low throughput 
sequencing. 
6. When the average alignment identity for reads assigned to a 
particular species is lower than the average alignment identity 
for reads assigned to other species (i. e., the average sequencing 
accuracy), it may be interesting to perform further bioinfor-
matic analyses aimed at characterizing a novel viral strain. In 
particular, reads of interest may be realigned to the viral 
genome sequence available in the database and visually 
inspected in a genome browser to assess the presence of sys-
tematic differences in the reads compared to the available 
sequence. Moreover, such reads could be de novo assembled 
to obtain the whole-genome sequence of the variant strain. 
References 
1. Anderson PK, Cunningham AA, Patel NG et al 
(2004) Emerging infectious diseases of plants: 
pathogen pollution, climate change and agro-
technology drivers. Trends Ecol Evol 19:535– 
544 
2. Strange RN, Scott PR (2005) Plant disease: a 
threat to global food security. Annu Rev Phy-
topathol 43:83–116 
3. Burbank LP, Roper MC (2021) Microbe pro-
ﬁle: Xylella fastidiosa – a devastating agricul-
tural pathogen with an endophytic lifestyle. 
Microbiology 167(10):001091 
4. Jones RAC (2021) Global plant virus disease 
pandemics and epidemics. Plants 10:233 
5. Jones RAC (2020) Disease pandemics and 
major epidemics arising from new encounters 
between indigenous viruses and introduced 
crops. Viruses 12:1388 
6. Vurro M, Bonciani B, Vannacci G (2010) 
Emerging infectious diseases of crop plants in 
developing countries: impact on agriculture 
and 
socio-economic 
consequences. 
Food 
Secur 2:113–132 
7. Chalupowicz L, Dombrovsky A, Gaba V et al 
(2019) Diagnosis of plant diseases using the 
Nanopore sequencing platform. Plant Pathol 
68:229–238 
8. Marcolungo L, Passera A, Maestri S et al 
(2022) Real-time on-site diagnosis of quaran-
tine pathogens in plant tissues by nanopore-
based sequencing. Pathogens 11(2):199 
9. Villamor DEV, Ho T, Al Rwahnih M et al 
(2019) High throughput sequencing for plant 
virus detection and discovery. Phytopathology 
109:716–725 
10. Tarquini G, Martini M, Maestri SF et al (2022) 
The virome of ‘Lamon Bean’: application of 
MinION sequencing to investigate the virus 
population associated with symptomatic beans 
in the Lamon Area, Italy. Plants 11:779 
11. Liefting LW, Waite DW, Thompson JR (2021) 
Application of Oxford nanopore technology to 
plant virus detection. Viruses 13:1424 
12. Lu H, Giordano F, Ning Z (2016) Oxford 
nanopore MinION sequencing and genome 
assembly. Genomics Proteomics Bioinf 14: 
265–279

24.
MinION Technology as a Diagnostic Tool for Emerging Viruses
249
13. Maestri S, Maturo MG, Cosentino E et al 
(2020) A long-read sequencing approach for 
direct haplotype phasing in clinical settings. Int 
J Mol Sci 21:9177 
14. Maestri S, Cosentino E, Paterno M et al (2019) 
A rapid and accurate MinION-based workﬂow 
for tracking species biodiversity in the ﬁeld. 
Genes 10:468 
15. Lopatriello G, Maestri S, Alfano M et al (2023) 
CRISPR/Cas9-mediated enrichment coupled 
to nanopore sequencing provides a valuable 
tool for the precise reconstruction of large 
genomic target regions. Int J Mol Sci 24:1076 
16. Alfano M, De Antoni L, Centofanti F et al 
(2022) Characterization of full-length CNBP 
expanded alleles in myotonic dystrophy type 
2 patients by Cas9-mediated enrichment and 
nanopore sequencing. elife 11:e80229 
17. Grosso V, Marcolungo L, Maestri S et al 
(2021) 
Characterization 
of 
FMR1 
repeat 
expansion and intragenic variants by indirect 
sequence capture. Front Genet 12:743230 
18. Santos A, van Aerle R, Barrientos L et al (2020) 
Computational methods for 16S metabarcod-
ing studies using Nanopore sequencing data. 
Comput Struct Biotechnol J 18:296–305 
19. Zepeda Mendoza ML, Sicheritz-Ponten T, Gil-
bert MTP (2015) Environmental genes and 
genomes: understanding the differences and 
challenges in the approaches and software for 
their analyses. Brief Bioinform 16:745–758 
20. Ciuffreda L, Rodrı´guez-Pe´rez H, Flores C 
(2021) Nanopore sequencing and its applica-
tion to the study of microbial communities. 
Comput Struct Biotechnol J 19:1497–1511 
21. Mitsuhashi S, Kryukov K, Nakagawa S et al 
(2017) A portable system for rapid bacterial 
composition analysis using a nanopore-based 
sequencer and laptop computer. Sci Rep 7:1–9 
22. Wood 
DE, 
Lu 
J, 
Langmead 
B 
(2019) 
Improved metagenomic analysis with Kraken 
2. Genome Biol 20:1–13 
23. Altschul SF, Gish W, Miller, et al. (1990) Basic 
local alignment search tool. J Mol Biol 215: 
403–410 
Li H (2018) Minimap2: pairwise alignment for 
nucleotide 
sequences. 
Bioinformatics 
34: 
3094–3100 
25. Kiełbasa SM, Wan R, Sato K et al (2011) Adap-
tive seeds tame genomic sequence comparison. 
Genome Res 21:487–493 
26. Rognes T, Flouri T, Nichols B et al (2016) 
VSEARCH: a versatile open source tool for 
metagenomics. PeerJ 4:e2584 
27. Castanera R (2022) A ﬂexible and reproducible 
pipeline for long-read assembly and evaluation. 
Peer Commun Genom 1:100018 
28. Koren 
S, 
Walenz 
BP, 
Berlin 
K 
et 
al 
(2017) Canu: scalable and accurate long-read 
assembly via adaptive k-mer weighting and 
repeat separation. Genome Res 27:722–736 
29. Kolmogorov M, Bickhart DM, Behsaz B et al 
(2020) metaFlye: scalable long-read metagen-
ome assembly using repeat graphs. Nat Meth-
ods 17:1103–1110 
30. Bokulich NA, Kaehler BD, Rideout JR et al 
(2018) Optimizing taxonomic classiﬁcation of 
marker-gene amplicon sequences with QIIME 
2’s q2-feature-classiﬁer plugin. Microbiome 6: 
1–17 
31. Sun K, Liu Y, Zhou X et al (2022) Nanopore 
sequencing technology and its application in 
plant virus diagnostics. Front Microbiol 13: 
939666 
32. Czotter N, Molnar J, Szabo´ E et al (2018) 
NGS of virus-derived small rnas as a diagnostic 
method used to determine viromes of Hungar-
ian vineyards. Front Microbiol 9:122 
33. Minicka J, Zarzyn´ska-Nowak A, Budzyn´ska D 
et al (2020) High-throughput sequencing 
facilitates discovery of new plant viruses in 
Poland. Plants 9:820 
34. De Coster W, D’Hert S, Schultz DT et al 
(2018) NanoPack: visualizing and processing 
long-read sequencing data. Bioinformatics 34: 
2666–2669 
35. Tange O (2011) Gnu parallel-the command-
line power tool. USENIX Magaz 36:42–47 
36. Chamberlain SA, Szo¨cs E (2013) taxize: taxo-
nomic
search
and
retrieval
in 
R. F1000Research 2:191 
37. Ondov BD, Bergman NH, Phillippy AM 
(2011) Interactive metagenomic visualization 
in a Web browser. BMC Bioinf 12:1–10

Chapter 17 
Detection of Plant Viruses Using Nanopore Sequencing 
Based Metagenomic Approach 
Anja Pecman, Natasˇa Mehle, and Denis Kutnjak 
Abstract 
Nanopore sequencing has proven to be a useful tool for the generic detection of plant viruses, especially in 
laboratories working with small number of samples. In this chapter, we describe the steps prior to library 
preparation as well as the library preparation itself, which we found provides comparable results to Illumina 
sequencing. 
Key 
words Plant 
viruses, 
High-throughput 
sequencing, 
Nanopore 
sequencing, 
Detection, 
Metagenomics 
1 
Introduction 
The possibilities for generic detection of (plant) viruses were greatly 
improved with the introduction of high-throughput sequencing 
technologies over a decade ago. Different platforms and sample 
preparation protocols can now be used to achieve this aim. Nano-
pore sequencing became widely available in 2014, when Oxford 
Nanopore Technologies entered the market [1]. Since then, this 
sequencing platform is constantly developing, improving, becom-
ing cost-effective and user friendly. In past years, it was used for 
surveillance and detection of different human, animal, and plant 
viruses [2–6]. The technology offers scalable solutions, enables 
sequencing in lower scale in smaller laboratories, and is a promising 
method for on-site sequencing in the future. Recently, two differ-
ent nanopore sequencing protocols and two different sample prep-
aration protocols were compared with Illumina sequencing, with 
the aim of plant virus detection. Results showed that when appro-
priate sample preparation protocol and nanopore sequencing 
library preparation protocol are selected, nanopore sequencing 
gave comparable results as Illumina sequencing, considering plant 
virus 
detection 
[6]. 
The 
best 
performing 
nanopore
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_17, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
251

sequencing-based protocol from this comparison (cDNA-PCR 
sequencing of ribosomal RNA-depleted total RNA) is presented 
in this chapter. The described protocol includes the use of barcodes 
to enable multiplexing of several samples in one run (see Note 1).
252
Anja Pecman et al.
The process starts with RNA extraction and DNase digestion, 
which can be performed using different protocols. In the next step, 
ribosomal RNA depletion is performed, followed by polyA tailing. 
This step adds a polyA tail to every RNA, allowing all RNAs to be 
sequenced. This is because the Oxford Nanopore Technologies 
sequencing kit, used in this protocol, relies on the presence of a 3’ 
polyadenylated (poly(A)) tail on template molecules to successfully 
generate sequencing libraries [7]. 
The PCR-cDNA barcoding protocol described below can be 
employed using relatively low RNA input concentration while aim-
ing for high sequencing output. Nanopore sequencing has been 
found to provide comparable results to Illumina sequencing, while 
being faster and better suited for small laboratories. 
2 
Materials 
2.1 
Samples and 
Controls 
1. Samples (extracted RNA, treated with DNase enzyme). 
2. Alien control (see Note 2). 
3. ERCC RNA Spike-In Control Mixes (from now on named 
ERCC control), Invitrogen™, (see Note 3). 
2.2 
Reagents
1. Chemicals or kit for RNA extraction and DNase digestion (e.g., 
RNeasy Plant Mini Kit (Qiagen, US)). 
2. Kit for ribosomal RNA depletion (see Note 4). 
3. Reagents needed for polyadenylation. 
4. Chemicals or kits for nucleic acid concentration (see Note 5). 
5. PCR-cDNA Barcoding kit (SQK-PCB109, Oxford Nanopore 
Technologies). 
6. Flow Cell Priming Kit (EXP-FLP002, Oxford Nanopore 
Technologies). 
7. 10 mM dNTP solution. 
8. LongAmp Taq 2X Master Mix (New England Biolabs). 
9. 200 U/μL Maxima H Minus Reverse Transcriptase with 5× RT 
Buffer (ThermoFisher). 
10. 40 U/μL RNase inhibitor (RNaseOUT™, Life Technologies, 
#10777019). 
11. 20 U/μL Exonuclease I (New England Bioloabs, #M0293).

Detection of Plant Viruses using Nanopore
253
12. Consumables for Bioanalyzer (Agilent Technologies) or similar 
equipment for measuring size, quantity, and quality of nucleic 
acids. 
13. Consumables (for high sensitivity RNA and high sensitivity 
dsDNA measurements) for selected ﬂuorimeter (e.g., Qubit, 
Thermo Fisher Scientiﬁc). 
14. Flowcell 
R9.4.1 
FLO-MIN106D 
(Oxford 
Nanopore 
Technologies). 
15. Absolute ethanol. 
16. Nuclease-free water. 
17. DNA, RNA, DNase, and RNase decontamination wipes (e.g., 
PCR clean™ wipes, Bio Consult). 
2.3 
Equipment and 
Plastic Ware 
1. MinION Mk1B sequencer (Oxford Nanopore Technologies) 
and computer with speciﬁed IT requirements [8] or MinION 
Mk1C sequencer. 
2. Bioanalyzer (Agilent Technologies) or similar equipment for 
measuring size, quantity and quality of nucleic acids. 
3. Nanodrop (Thermo Fisher Scientiﬁc) or similar spectropho-
tometer for measuring nucleic acids concentration and purity. 
4. Qubit (Thermo Fisher Scientiﬁc) or similar ﬂuorimeter for 
measuring nucleic acids concentration. 
5. PCR thermocycler. 
6. Hula mixer. 
7. Microcentrifuge (for spin down). 
8. Timer. 
9. Vortex mixer. 
10. Ice bucket with ice or cooling blocks. 
11. Magnetic rack suitable for 1.5 or 2 mL tubes. 
12. Pipettes and tips/ﬁlter tips. 
13. Low binding 1.5 and 2 mL tubes. 
14. 1.5 and 2 mL tubes. 
15. PCR-tubes. 
3 
Method 
General precautions should be taken during all steps described 
below to avoid contamination of samples and reagents (see Note 6).

f
254
Anja Pecman et al.
3.1 
Preparation of 
Samples and Controls 
1. Design the experiment: Select desirable number of samples (see 
Note 1) and controls (see Notes 2 and 3). For each sequencing 
run, the alien control should be included as an additional 
sample and processed in parallel with the entire procedure. 
2. Perform RNA extraction of selected samples and controls with 
included, or followed by, DNase digestion. 
3. Measure the RNA concentration and RNA quality of all 
included samples and controls using a spectrophotometer or 
ﬂuorimeter (see Note 7). 
4. Calculate the volume and concentration of ERCC control that 
should be added to each sample/alien control (see Note 8). 
Add the calculated volume of ERCC control to isolated RNA 
of each sample. 
3.2 
Ribosomal RNA 
Depletion 
1. To perform plant ribosomal RNA depletion, the RiboMinus™ 
Plant Kit for RNA-Seq (Invitrogen) can be used according to 
the manufacturer’s instructions; however, other protocols with 
similar outputs can be used. 
2. Transfer the supernatant (~ 320 μL) containing RiboMinus™ 
RNA to a new 1.5 or 2 mL low binding tube. Proceed with the 
RNA concentration step. 
3.3 
RNA 
Concentration 
1. Different chemicals (see Note 5) can be used for RNA concen-
tration. The ﬁnal elution volume of concentrated RNA should 
be ~20 μL (see Note 9). 
2. Measure the concentration of ribosomal RNA-depleted total 
RNA by ﬂuorimeter or spectrophotometer (see Note 7). 
3.4 
Polyadenylation 
Using NEB kit with 
Concentration 
Here we refer to Mag-Bind® TotalPure NGS beads (Omega 
Bio-tek) (see Note 5). 
1. Prepare Mag-Bind® TotalPure NGS beads. 
2. Pipette 57.6 μL of resuspended Mag-Bind® TotalPure NGS 
beads into a new 1.5 mL low binding tube for each sample and 
alien control. 
3. For each sample and alien control, the components listed in 
Table 1 should be added in separate PCR tubes in the order 
indicated. 
4. Incubate the mixture from step 2 in the PCR thermocycler at 
37 °C for 1.5 min. 
5. After incubation, pipette the mixture into tubes containing 
Mag-Bind® TotalPure NGS beads (from step 1) and mix gently 
(by pipetting). 
6. Incubate the tubes containing the mixture in a hula mixer for 
5 min at room temperature. Meanwhile, prepare 500 μL  o

L
1 X
L
1 mM
L
5 U
Detection of Plant Viruses using Nanopore
255
Table 1 
Components needed for RNA polyadenylation 
Component
Volume [μL] for 1 reaction
Concentration 
Ribosomal RNA-depleted total RNA
X μLa 
≤10 μg 
10X E. coli poly-A+ polymerase buffer (#M0276L)
2 μ
ATP (10 mM) (#M0276L)
2 μ
Nuclease-free water
15-X μL 
E. coli poly-A+ polymerase (5 U/μL) (#M0276L)
1 μ
a The protocol is tested for the use of 10 μL of ribosomal RNA-depleted total RNA with concentration between 10 and 
100 ng/μL 
fresh 70% ethanol in nuclease-free water for each sample and 
the alien control. 
7. After incubation in the hula mixer, spin down the tubes and 
pelletize the magnetic beads by placing the tubes on a 
magnetic rack. 
8. Leave the tubes on the magnetic rack, pipette off the superna-
tant and discard it. 
9. Leave the tubes on the magnetic rack and wash the beads with 
200 μL of freshly prepared 70% ethanol. 
10. Pipette off the supernatant and discard it (see Note 10). 
11. Repeat the previous step for a total of two washes. 
12. Spin down brieﬂy and place the tubes back on the magnetic 
rack. Pipette off any remaining ethanol. Allow the pellet to dry 
for 30–60 s, but not to the point of cracking (see Note 11). 
13. Remove the tubes from the magnetic rack and resuspend the 
pellet in 12 μL of nuclease-free water. 
14. Incubate the tubes for 5 min at room temperature. 
15. Pellet magnetic beads by placing the tubes on a magnetic rack 
until the eluate is clear and colorless. 
16. Remove and retain 12 μL of the eluate containing the 3′-
-polyadenylated RNA in a clean 1.5 mL low binding tube. 
17. Measure the RNA concentrations for all samples with a 
ﬂuorimeter. 
18. Store the ﬁnal product at -80 °C or proceed immediately with 
library preparation (keep samples on ice).

256
Anja Pecman et al.
3.5 
Library 
Preparation for 
Sequencing Using 
PCR-cDNA Barcoding 
Kit 
Here we refer to the protocol using the PCR-cDNA barcoding kit 
SQK-PCB109 v109_revJ_10Oct2019-minion [9]. 
3.5.1 
Reverse 
Transcription and Strand-
Switching 
1. In the ﬁrst step of library preparation, a reverse transcription 
and strand-switching is performed. To do this, the listed com-
ponents (Table 2) for each sample are added to the PCR tube in 
the order indicated. Hereafter, if more than one reaction is to 
be performed, calculate: Volume [μl] for 1 reaction multiplied 
by the number of reactions and add 10% more because of losses 
during pipetting. 
2. Mix gently by ﬂicking the PCR-tubes and spin them down. 
3. Place the PCR-tubes into the PCR thermocycler and incubate 
at 65 °C for 5 min. 
4. After incubation, cool immediately on a precooled freezing 
block/ice for 1 min. After ice incubation, the mixture can be 
stored at room temperature until further use. 
5. In a separate 1.5 mL tube, mix the components listed in 
Table 3. Mix them gently by ﬂicking the tube and spin down. 
Add 8 μL of the strand-switching buffer to each sample (PCR 
tube) from step 4. 
Table 2 
Components needed for VN primer annealing 
Component
Volume [μL] for 1 reaction
Concentration 
PolyA RNA
x
1 ng 
VN primer (VNP) (SQK-PCB109)
1
2 μM 
dNTPs (#N0447)
1
10 mM 
RNase-free water
9-x 
Table 3 
Components needed for strand-switching buffer 
Component
Volume [μL] for one reaction 
5X RT Buffer (#EP0751)
4 
RNaseOUT™ (#10777019)
1 
Nuclease-free water
1 
Strand-switching primer (SSP) (SQK-PCB109)
2

1
Component
Detection of Plant Viruses using Nanopore
257
Table 4 
Condition for reverse transcription and strand switching 
Step
T (°C)
Time 
Reverse transcription and strand-switching
42
90 min 
Heat inactivation
85
5 min 
Hold
4 
Table 5 
Components for PCR and barcoding step 
Volume [uL] 
for one reaction 
Reverse-transcribed RNA sample
5 
Barcode primers (BP01-BP12) (SQK-PCB109)
1.5 
Nuclease-free water
18.5 
LongAmp Taq 2X Master Mix (#M0287)
25 
6. Mix gently by ﬂicking the PCR-tubes and spin down. 
7. Incubate the PCR-tubes at 42 °C for 2 min in a PCR 
thermocycler. 
8. Add 1 μL Maxima H Minus Reverse Transcriptase to each 
sample (PCR tube). 
9. Mix gently by ﬂicking the PCR-tubes and spin down. 
10. Transfer PCR-tubes to PCR thermocycler and incubate as 
shown in Table 4. 
3.5.2 
PCR and Barcoding
1. For each sample and alien control, mix the components as 
listed in Table 5 in a new PCR-tube. The kit allows you to 
barcode up to 12 samples. However, the protocol suggests that 
when multiplexing two, three, or more samples, two separate 
PCR reactions should be performed per sample; for only one 
sample, four separate PCR reactions should be performed. Do 
not use all 20 μL of reverse transcribed RNA (cDNA) in a single 
PCR reaction. 
2. Run the PCR thermocycler under the conditions listed in 
Table 6. 
3. Add 1 μL Exonuclease I to each PCR-tube (the ﬁnal volume of 
each sample is 51 μL). 
4. Mix gently by ﬂicking the PCR-tubes and spin down.

1
258
Anja Pecman et al.
Table 6 
Conditions for PCR and barcoding step 
Step
T (°C)
Time
Number of cycles 
Initial denaturation
95
30s
1 
Denaturation
95
15s
11–18a 
Annealing
62
15s 
Extension
65
50 s per kb 
Final extension
65
6
1 
Hold
4 
a It is recommended to start with 14 cycles. Decrease the number of cycles (up to 11) if 
you need to avoid PCR bias/artifacts and increase it (up to 18) if you get too few 
barcoded PCR products for further steps 
5. In PCR thermocycler, incubate the reaction at 37 °C for 
15 min, followed by 80 °C for 15 min. 
6. For each sample, prepare 500 μL of fresh 70% ethanol in 
nuclease-free water. 
7. Resuspend the Mag-Bind® TotalPure NGS beads by vortexing. 
8. Pipette 0.8 volumes of Mag-Bind® TotalPure NGS beads into a 
new low binding 1.5 mL tube for each pooled barcode. (e.g., if 
you have two separate reactions for one sample/barcode, your 
pooled volume for each barcode would be 102 μL (2  × 51 μL, 
see step 3). In the new low binding tube, pipet 81.6 μL 
(=0.8 × 102 μL) of Mag-Bind® TotalPure NGS beads.) Pre-
pare this in advance for each sample/barcode. 
9. Merge the PCR reactions containing the same barcoded sample 
by pipetting and transfer the merged volume into prepared low 
binding tubes containing Mag-Bind® TotalPure NGS beads 
from point 8. 
10. Incubate tubes on a Hula mixer for 5 min at room 
temperature. 
11. After incubation on a Hula mixer, spin down the samples and 
pellet the magnetic beads by placing the tubes on a magnetic 
rack. Hold the tube on the magnetic rack and pipette off the 
supernatant. 
12. Leave the tubes on the magnetic rack and wash the beads with 
200 μL of freshly prepared 70% ethanol without disturbing the 
pellet. Remove and discard the ethanol with a pipette (see Note 
10). 
13. Repeat step 12. 
14. Spin down the tubes and place them back on the magnetic rack. 
Pipette off the residual 70% ethanol.

Detection of Plant Viruses using Nanopore
259
15. Open the caps and dry the pellets (~1 min) (see Note 11). 
16. Remove the tubes from the magnetic rack and resuspend the 
pellets in 12 μL of elution buffer (EB). 
17. Incubate the tubes on a hula mixer for 10 min at room 
temperature. 
18. Place the tubes on the magnetic rack and pellet the beads until 
the eluate is clear and colorless. 
19. Remove and retain 12 μL of eluate containing the cDNA 
library from the tubes placed on the magnetic rack in a clean 
1.5 mL low binding tube. Discard the pelleted beads. 
20. Analyze ampliﬁed cDNA for size, quantity, and quality with 
ﬂuorimeter and Bioanalyzer/TapeStation (see Note 12). 
21. Pool barcoded samples in the ﬁnal volume of 11 μL to obtain 
pooled cDNA library (see Note 12). 
3.5.3 
Adapter Ligation 
and Library Loading onto 
Flowcell 
Here we refer to the protocol using the Flow Cell Priming Kit 
(EXP-FLP002, Oxford Nanopore Technologies). 
1. Add 1 μl Rapid Adapter (RAP) to the pooled cDNA library. 
2. Mix well by pipetting and spin down. 
3. Incubate the reaction for 5 min at room temperature and 
spin down. 
4. Use the prepared cDNA library for loading onto the ﬂowcell. 
Store the library on ice until it can be loaded. 
5. Thaw the sequencing buffer (SQB), loading beads (LB), ﬂush 
tether (FLT), and one tube of ﬂush buffer (FB) at room tem-
perature 
before 
mixing 
the 
reagents 
by 
vortexing 
and 
spin down. 
6. Prepare the ﬂowcell priming mix: Add 30 μL of thawed and 
mixed ﬂush tether (FLT) directly into the tube containing 
thawed and mixed ﬂush buffer (FB). Mix by vortexing and 
spin down. 
7. Open the lid of the MinION and slide the ﬂowcell under the 
clip. Now run the MinKNOW and check the ﬂowcell. The 
ﬂowcell should have > 800 pores. 
8. Slide the priming port cover of the ﬂowcell clockwise to open 
the priming port. 
9. Check if there is a small air bubble under the lid. Draw off a 
small volume (20–30 μL) with P1000 pipette to remove any air 
bubbles. To do this, set the P1000 to 200 μL, insert the tip into 
the priming port, and turn the pipette wheel until the scale 
indicates 220–230 μL or until you see a small volume of buffer 
enter the pipette tip.

260
Anja Pecman et al.
Table 7 
Listed component for library for loading 
Component
Volume [μL] 
Sequencing buffer (SQB) (SQK-PCB109)
37.5 
Loading beads (LB) (SQK-PCB109), 
mixed immediately before use 
25.5 
Pooled cDNA library
12 
10. Load 800 μL of priming mixture (step 6) to the ﬂowcell via the 
priming port, avoiding the introduction of air bubbles. Wait 
for 5 min. During this time, prepare the library for loading. 
11. Prepare the library for loading in a new low binding tube 
(Table 7). 
12. Carefully lift the SpotON sample port cover to make the 
SpotON sample port accessible. 
13. Load 200 μL of priming mixture (step 6) to the ﬂowcell via the 
priming port (not the SpotON sample port), avoiding the 
introduction of air bubbles and load the library as soon as 
possible. 
14. Mix the prepared library by carefully pipetting up and down 
just before loading (see Note 13). 
15. Add 75 μL of prepared library for loading to the ﬂowcell via the 
SpotON sample port. Ensure that each drop ﬂows into the port 
before adding the next one. 
16. Carefully replace the SpotON sample port cover, making sure 
the bung enters the SpotON port, close the priming port and 
replace the MinION device lid. 
17. Follow the MinKNOW wizard to start the sequencing run (see 
Note 14). 
18. Analyze the sequencing data (see Note 15). 
4 
Notes 
1. Using the PCR-cDNA Barcoding Kit up to 12 samples can be 
multiplexed, while each barcode tube includes enough volume 
for 6 reactions. However, when multiplexing, at least two 
reactions of sample barcoding should be performed. Thus, 
when designing the experiment, calculate the number of sam-
ples which you would like to sequence to have manageable (not 
too many samples) but also cost-effective (more than one 
sample) run. For example, if you start one run with six samples,

Detection of Plant Viruses using Nanopore
261
i.e., six barcodes, and perform two barcoding reactions for 
each sample, this means that one kit can be used for six 
individual runs. 
2. The use of various controls is recommended to verify the 
validity and robustness of the test. We recommend including 
an alien control in each sequencing run. The alien control may 
be a well-characterized sample that contains a virus not 
expected to be present in the analyzed samples. Extraction of 
the alien control, followed by all further steps, should be per-
formed together/in parallel with the samples. Brieﬂy, the alien 
control is an external control, processed alongside the samples 
to monitor detection of the contained virus (role of positive 
control) and to check cross-contamination or crosstalk from 
other barcodes/samples (role of negative control) [10]. An 
example of such control is RNA extracted and treated with 
DNase from Phaseolus vulgaris, cv. Black Turtle infected with 
endornavirus [11]. 
3. ERCC 
RNA 
Spike-In 
Control 
Mixes 
(Invitrogen™, 
#4456740) is a commercially available mixture of synthetic 
RNA molecules with known sequences and concentrations. It 
can be added to any sample as a spike at various stages of the 
procedure. This control is used to monitor the successful per-
formance of the test for each sample. To monitor as many steps 
as possible, we recommend spiking it into the extracted and 
DNase-treated RNA of each sample and the alien control. 
4. The Invitrogen RiboMinus™ Plant Kit for RNA-Seq #A10838 
is recommended for wheat, maize, rice, barley, soybean, sugar 
cane, sorghum, potato, cassava, Arabidopsis, tomato, tobacco, 
poplar, legume, and moss. We have found that this kit can also 
be used for RNA extracted from pepper, squash, cucumber, 
and watermelon. 
5. Some alternatives that can be used for RNA concentration: 
Mag-Bind® TotalPure NGS (Omega Bio-tek, US), Agencourt 
RNAClean XP beads (Beckman Coulter, US), Zymo Research 
RNA Clean & Concentrator-5 (Zymo Research, US), RNeasy 
Mini Kit (Qiagen, US). 
6. To prevent contamination, the steps before PCR and barcod-
ing should be performed in different locations/UV chambers 
(including special equipment, pipettes, lab coats, etc.) than the 
steps after PCR and barcoding. Use only ﬁlter tips (aerosol 
barrier tips) and use a new tip for each pipetting step. Normal 
tips should be used (according to the manufacture instruction) 
when working with Bioanalyzer (Agilent Technologies). Dur-
ing work, close the reagent/sample tubes after the desired 
volume has been aspirated into the tip. Always wear gloves 
and change them if you suspect contamination. Use only

262
Anja Pecman et al.
clean, sterile plasticware. All tubes should be opened with a 
microtube opener. After ﬁnishing work in the UV chamber, 
turn on the UV light for at least 15 min. When working outside 
the UV chamber, clean the worktable, pipettes, racks, and tube 
opener with RNase/DNase decontamination wipes (e.g., PCR 
clean™ wipes, Bio Consult, #15-2001), then wipe three times 
with H2O-moistened wipes (to remove RNase and DNase), 
and dry the surfaces. 
7. Various protocols and kits can be used for RNA extraction and 
DNase digestion. Before proceeding to further steps, it is 
important to check RNA concentration and RNA quality. 
Note that depletion of ribosomal RNA could remove a large 
amount of RNA. The quantity of RNA can be checked using a 
spectrophotometer, e.g., Nanodrop (Thermo Fisher Scientiﬁc) 
or a ﬂuorimeter, e.g., Qubit (Thermo Fisher Scientiﬁc). The 
spectrophotometer may only be used if the expected RNA 
concentration is >20 ng/μL [12]. In addition, the spectropho-
tometer can be used to evaluate RNA quality. It is recom-
mended that the RNA sample has a 260/280 ratio of ~2.0 
and a 260/230 ratio of ~2.0–2.2. If the 260/230 ratio is 
signiﬁcantly lower (below ~1.8), the RNA may require addi-
tional puriﬁcation as residues of various components may inter-
fere with further procedures. 
8. The equation for calculation of ERCC control to be added into 
samples/controls is described in the user manual of ERCC 
RNA Spike-In Control Mixes (publication number 4455352, 
revision D). The amount of ERCC control added is calculated 
according to the amount of RNA in the sample. Volume (μL, 
ERCC) = 0.00002 × amount (ng) of RNA. For example, if the 
amount of RNA in your sample is 5000 ng, you should add 
0.1 μL ERCC (or 1 μL of 10× diluted ERCC). 
9. We recommend using 20 μL so that you can use 10–15 μL for 
further steps and retain enough volume for measuring RNA 
quantity and quality. The elution volume can also be higher, 
but you must keep in mind that the RNA concentration in this 
step can be up to ten times lower than the input RNA concen-
tration before the ribosomal RNA depletion step. 
10. If you are working with more than one sample, we recommend 
washing each tube individually: Open the tube, wash the pellet 
with 200 μL of 70% ethanol, pipette off the ethanol, and close 
the tube. This procedure is the best for treating the samples 
evenly, i.e., each sample is washed with ethanol for the same 
amount of time and air dried. 
11. When drying the pellet, we recommend visually observing its 
surface. When the surface becomes matt in appearance, the

Detection of Plant Viruses using Nanopore
263
pellet is almost dry and the tube should be closed. If you 
continue drying, the pellet may start cracking. 
12. For each sample measure the quantity with ﬂuorimeter and 
based on Bioanalyzer results, estimate the average length. In 
the next step, calculate the samples molarity and according to 
the measured concentration, pool samples to the ﬁnal volume 
of 11 μL. The cumulative input library molarity should be 
around 100 fmol. However, we have experienced that lower 
molarities (the minimum tested in our lab was ~30 fmol) can be 
used with desirable outputs. If 50 fmol or less is used, we 
recommend reloading library (check Oxford Nanopore Tech-
nologies site, community section) to the ﬂowcell after approxi-
mately 6–12 h. The maximum molarity used successfully in our 
laboratory so far was ~ 210 fmol. 
13. The sequencing beads are heavy and settle quickly. Therefore, 
mix the prepared library before loading by pipetting with 
200-μL ﬁlter tips, and when the library looks homogeneous 
in the ﬁlter tip, load it into the ﬂowcell. 
14. When following the MinKNOW wizard, it is recommended to 
select the sequencing of all reads and make no length or quality 
trimming at this point. Regarding the basecalling option, if the 
sequencing is performed using MinION Mk1B connected to a 
laptop, it is recommended to disable this option, if there is a 
possibility to do it later on a more powerful server with the 
Graphics Processing Unit (GPU) option. 
15. First, perform basecalling. The reads will be demultiplexed and 
if using Guppy v6.3.2 or later versions the barcodes will be 
already trimmed. Further analysis can be done for each barcode 
by following the steps described in [6]. While analyzing the 
controls, check if they were detected in acceptable ranges or 
concentrations. Regarding the ERCC control, check the man-
ual of ERCC RNA Spike-In Control Mixes (publication num-
ber 4455352, revision D). Regarding the alien control, you 
should set up the acceptable detection threshold, e.g., fraction 
of reference covered by reads for selected alien control should 
reach >50%. 
References 
1. Branton D, Deamer D (2018) Nanopore 
sequencing. Nanopore Seq 1:1–16. https:// 
doi.org/10.1142/10995 
2. Quick J, Loman NJ, Duraffour S et al (2016) 
Ebola surveillance. Nature. https://doi.org/ 
10.1038/nature16996 
3. Meredith LW, Hamilton WL, Warne B et al 
(2020) Rapid implementation of SARS-CoV-
2 sequencing to investigate cases of health-care 
associated COVID-19: a prospective genomic 
surveillance study. Lancet Infect Dis 20:1263– 
1272. https://doi.org/10.1016/S1473-3099 
(20)30562-4 
4. Tan S, Dvorak CMT, Murtaugh MP (2019) 
Rapid, unbiased PRRSV strain detection using 
MinION direct RNA sequencing and bioinfor-
matics tools. Viruses 11. https://doi.org/10. 
3390/v11121132

264
Anja Pecman et al.
5. Filloux D, Fernandez E, Loire E et al (2018) 
Nanopore-based detection and characteriza-
tion of yam viruses. Sci Rep 8:17879. https:// 
doi.org/10.1038/s41598-018-36042-7 
6. Pecman A, Adams I, Gutie´rrez-Aguirre I et al 
(2022) Systematic comparison of nanopore 
and illumina sequencing for the detection of 
plant viruses and viroids using total RNA 
sequencing approach. Front Microbiol 13:1– 
14. https://doi.org/10.3389/fmicb.2022. 
883921 
7. Oxford 
Nanopore 
Technologies 
(2022) 
Polyadenylation 
of 
non-poly(A) 
transcripts 
using E. coli poly(A) polymerase, v3, April 
2022. https://nanoporetech.com/. Accessed 
31 Jan 2023 
8. Oxford Nanopore Technologies (2022) Min-
ION Mk1B IT requirements. https:// 
nanoporetech.com/products/minion. 
Accessed 14 Feb 2023 
9. Oxford Nanopore Technologies PCR-cDNA 
sequencing 
– 
barcoding 
(SQK-PCB109). 
https://nanoporetech.com/.
Accessed 
1 Mar 2023 
10. Massart S, Adams I, Rwahnih MA et al (2022) 
Guidelines for the reliable use of high through-
put sequencing technologies to detect plant 
pathogens 
and 
pests. 
Peer 
Commun 
J 
10.24072/pcjournal.181 
11. Kesanakurti P, Belton M, Saeed H et al (2016) 
Screening for plant viruses by next generation 
sequencing using a modiﬁed double strand 
RNA extraction protocol with an internal 
ampliﬁcation control. J Virol Methods 236: 
35–40. https://doi.org/10.1016/j.jviromet. 
2016.07.001 
12. Oxford Nanopore Technologies (2022) Input 
DNA/RNA QC. https://nanoporetech.com/. 
Accessed 31 Jan 2023

Chapter 18 
Application of Nanopore-Based Sequencing to Identify Virus 
Infections in Woody Plants 
Seraﬁna Serena Amoia, Michela Chiumenti, and Angelantonio Minafra 
Abstract 
Plant viruses threaten the yield and quality of crops. Efﬁcient and affordable pathogen diagnosis is crucial to 
regulate the trade of plant materials and for disease management and control. Sequencing technology based 
on Illumina platform is a powerful tool for the identiﬁcation of plant viruses, but it requires long and 
expensive protocols, cumbersome equipment, and signiﬁcant cost per library. Nanopore sequencing 
technology, developed by Oxford Nanopore Technologies (ONT), is a recent sequencing system very 
easy to use, suitable for onsite-ﬁeld detection, and associated with low costs. Coupled with its portability, 
nanopore technology has great application prospects in the ﬁeld of quick detection of plant viruses. In this 
protocol, we expose in detail the application of cDNA-PCR nanopore-based sequencing for the detection 
of plant viruses. 
Key words High-throughput sequencing (HTS), MinION, RNA, Diagnostics, Plant virus discovery 
1 
Introduction 
Plant viruses pose a threat to agricultural productions worldwide, 
causing relevant diseases and signiﬁcant economic yield losses. 
Furthermore, trade globalization of agricultural products speeded 
up the emergence and the spread of plant pathogens. Hence, a 
rapid, efﬁcient, and low-cost detection method of plant viruses is 
the key to prevent and control infections. Virus diseases are often 
characterized by the expression of nonspeciﬁc symptoms, such as 
mosaic, ringspot, leaf yellowing, and reduced growth, while mixed 
infections make the identiﬁcation of viral entities difﬁcult. Applica-
tion of high-throughput sequencing (HTS) platforms for plant pest 
diagnosis is established for the detection and identiﬁcation of 
known pathogens, as well as previously unknown organisms, thus 
overcoming the traditional diagnostic methods (microscope obser-
vation, biological indexing, immunological, and molecular analysis) 
[1, 2]. 
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_18, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
265

266
Seraﬁna Serena Amoia et al.
Several nucleic acid templates could be puriﬁed and enriched 
from plant matrices (leaves, phloem, fruit, and root tissues). For the 
identiﬁcation of viruses with genomic RNA or DNA, the most 
suitable template is the total RNA, to be used after the depletion 
of ribosomal RNA (rRNA), since it could contain full RNA viral 
genomes, 
viral 
transcripts, 
replicative 
or 
defective 
forms, 
sub-genomic segments, and it is easily represented in a random-
primed cDNA library [3, 4]. 
Nevertheless, an approach based on Illumina sequencing is 
time-consuming and requires designated laboratory facilities and 
highly qualiﬁed personnel. Oxford Nanopore Technologies (ONT) 
MinION device, which represents the third-generation sequencing 
technology, is portable (10 cm × 2 cm  × 3.3 cm, 90 g) and allows a 
rapid and on-site application of high-throughput sequencing of 
different nucleic acid templates. ONT MinION also allows users 
to monitor instantly sequencing data and to perform a real-time 
bioinformatics analysis through the Epi2me platform available 
online. Therefore, nanopore sequencing is suitable for the point-
of-care surveillance and the unbiased detection and potential de 
novo identiﬁcation of plant pathogens [5–8]. Nanopore sequenc-
ing and its application in plant virus diagnostics have been recently 
reviewed [9] and successful application to diagnose case-studies 
described [10]. 
The intrinsic error rate of the direct read is supposed to be 
higher than that of sequencing-by-synthesis [2]. However, this 
aspect can be alleviated by database interrogation with longer 
reads obtained by ONT MinION sequencing and by the conse-
quent reference mapping for taxonomic attribution. 
Here, we describe an ONT-based diagnostic workﬂow and 
applied for the detection of viruses (including virus genomic 
RNAs without polyA termination) infecting woody plants. 
2 
Materials 
All solutions are prepared with ultrapure sterile water (double-
distilled molecular grade, ddH2O) and analytical grade reagents. 
Particular care should be devoted to avoiding RNase contamina-
tions using gloves and surface RNase-decontaminating reagents. 
2.1 
Total RNA 
Extraction with 
Capture on Silica 
Particles 
1. 100 mg plant tissue (leaves, stem slices, and phloem scrapings). 
2. 10% Na-lauroylsarcosine (NLS). 
3. Trizol: Use in a chemical hood. 
4. Chloroform: Use in a chemical hood.

Nanopore Technology to Identify Virus Infections in Woody Plants
267
5. Grinding buffer: 4.0 M guanidine thiocyanate, 0.2 M NaOAc 
pH 5.2, 25 mM EDTA, 1.0 M KOAc, 2.5% wt/vol PVP40, and 
2% sodium metabisulﬁte [11]. 
6. Washing solution: 10 mM Tris–HCl pH 7.5, 0.5 mM EDTA, 
50 mM NaCl, and 50% ethanol. 
7. NaI preparation: Dissolve 0.75 Na2SO3 g in 40 mL H2O; add 
36 g NaI; stir until completely dissolved and store in a dark 
bottle at 4 °C. 
8. Silica particle solution: In a measuring cylinder, add 60 g silica 
particles to 500 mL H2O, mix; let settle for 24 h; discard the 
upper 470 mL supernatant; add H2O to 500 mL and mix well; 
let settle for 5 h; discard 440 mL; adjust the remaining 60 mL 
slurry to a pH = 2.0 with HCl; autoclave at 120 °C for 20 min 
and store in a dark bottle at room temperature. 
9. Benchtop microcentrifuge. 
10. 2–20 μL/20–200 μL/1000 μL single channel pipette and 
ﬁlter tips. 
11. Vortex mixer. 
12. Sterilized mortars and pestles. 
13. Liquid nitrogen. 
14. Heat block or water bath at 70 °C. 
15. RNase-free water. 
16. 1.2% agarose gel: Weigh 1.2 g agarose electrophoresis grade 
and add to 100 mL 1× TBE (Tris–borate EDTA) in a 250 mL 
ﬂask; dissolve completely the agarose by heating in a micro-
wave; add GelRed at 1X ﬁnal concentration; pour the gel into a 
tray with combs, and wait until it solidiﬁes; load a fraction 
(at least 500 ng amount) of the puriﬁed total RNA and run 
the gel at 100 Volts constant voltage. 
2.2 
Total RNA 
Extraction with 
Maxwell® RSC Plant 
RNA Kit 
1. Maxwell® RSC Cartridges. 
2. CTAB Buffer (supplied in the kit). 
3. Lysis Buffer (supplied in the kit). 
4. DNase I (lyophilized; supplied in the kit). 
5. Cold 1-thioglycerol. 
6. Maxwell® RSC Plunger Pack. 
7. Elution Tubes, 0.5 mL. 
8. Nuclease – free water. 
9. Tissue Homogenizer. 
10. Vortex mixer. 
11. Benchtop microcentrifuge.

268
Seraﬁna Serena Amoia et al.
12. Microcentrifuge tube 1.5 mL. 
13. 2–20 μL/20–200 μL/1000 μL single channel pipette and 
ﬁlter tips. 
14. Sample extraction bags. 
2.3 
Ribosomal RNA 
Depletion 
1. High-quality total plant RNA. 
2. RiboMinus™ Plant Kit for RNA-Seq. 
3. RiboMinus™ Probe (15 pmol/μL). 
4. Hybridization Buffer. 
5. RiboMinus™ Magnetic Beads. 
6. Modiﬁed RiboMinus™ Concentration Module. 
7. Magna-Sep™ Magnetic Particle Separator or equivalent. 
8. Sterile, RNase-free microcentrifuge tubes and water baths or 
heat blocks set to 70–75 °C and 37 °C. 
9. Glycogen, 20 μg/μL. 
10. 3 M NaOAc pH 5.2 in RNAse-free water. 
11. 96–100% and 70% cold ethanol. 
12. RNase-free water. 
13. Benchtop microcentrifuge. 
14. 1.2% TBE agarose gel electrophoresis. 
2.4 
Minion Library 
Preparation 
1. Total RNA (~100 ng) or ribo-depleted RNA (see Note 1). 
2. Agencourt AMPure XP beads. 
3. Nuclease-free water. 
4. Freshly prepared 70% ethanol in nuclease-free water. 
5. 10 mM dNTP solution. 
6. LongAmp Taq 2X Master Mix. 
7. 200 U/μL Maxima H Minus Reverse Transcriptase with 5× RT 
Buffer. 
8. 40 U/μL RNase Inhibitor. 
9. 20,000 U/ml Exonuclease I. 
10. Random-anchored Primer (Rp). 
11. Nanopore PCR-cDNA barcoding kit: VN Primer (VNP, 
2 μM), strand-switching primer (SSP, 10 μM), barcode primers 
(BP01-BP12), elution buffer (EB), rapid adapter (RAP), 
sequencing buffer (SQB), loading beads (LB), ﬂush tether 
(FT), and ﬂush buffer (FB). 
12. Nanopore Flow Cell Priming Kit. Nanopore Flow Cell 
Wash Kit. 
13. 1.5 mL microcentrifuge DNA tubes.

Component
Nanopore Technology to Identify Virus Infections in Woody Plants
269
14. 0.2 mL thin-walled PCR tubes. 
15. Gentle rotator mixer. 
16. Magnetic separator, suitable for 1.5 mL microcentrifuge tubes. 
17. Microfuge. 
18. Vortex mixer. 
19. Thermal cycler. 
20. 2–20 μL/20–200 μL/1000 μL single channel pipette and ﬁlter 
tips 
21. Timer. 
22. Prechilled freezer block at -20 ° C for 200 μL tubes. 
23. Qubit ﬂuorometer (or equivalent for QC check). 
24. MinION Mk1B. 
25. Flow cell (FLO-MIN106D, R9.4.1). 
2.5 
Bioinformatics
1. Linux-based server. 
2. Personal computer minimum speciﬁcations required are indi-
cated (Table 1). 
3. MinKNOW software version suitable for your MinION device. 
4. Docker for windows (https://docs.docker.com/desktop/ 
install/windows-install/). 
5. EPI2ME (https://epi2me.nanoporetech.com/). 
6. Conda package manager (i.e. bioconda, https://anaconda. 
org/bioconda). 
7. pycoQC (https://hpc.nih.gov/apps/pycoQC.html). 
Table 1 
Table modified from nanoporetech.com 
Microsoft
Macintosh
Ubuntu 
Operating system
Windows 7, 8.1 and 10 64 
bit 
Yosemite or El Capitan 
64 bit 
Ubuntu 14.04 
LTS 
Memory/RAM
CPU
Storage/hard drive
User account privilege 
level 
Ports
a Further details and suggestions may be found at https://nanoporetech.com/sites/default/ﬁles/s3/201610/ 
Computer%20requirements%20v4.2%20Sep2016.pdf

270
Seraﬁna Serena Amoia et al.
8. fastx toolkit (http://hannonlab.cshl.edu/fastx_toolkit/). 
9. BLAST+ executables (https://blast.ncbi.nlm.nih.gov/Blast. 
cgi?CMD=Web&PAGE_TYPE=BlastDocs&DOC_TYPE= 
Download). 
10. Minimap2 (https://github.com/lh3/minimap2). 
3 
Methods 
3.1 
Total RNA 
Extraction 
1. Crush sample (100 mg tissue) in 1 mL grinding buffer. 
2. Transfer 500 μL to the 1.5 mL microcentrifuge tube and add 
100 μL 10% NLS.
3.1.1 
RNA Extraction 
with Silica Particles
3. Incubate at 70 °C for 15 min with intermittent shaking. Then, 
incubate on ice for 5 min. 
4. Centrifuge 13,000 rpm for 3 min (see Note 2). 
5. Transfer 300 μL to a new tube. 
6. Add 500 μL EtOH, 300 μL 6 M NaI and 25 μL silica particles 
resuspended in water pH 2.0. 
7. Incubate at room temperature for 10 min with intermittent 
shaking. 
8. Centrifuge at 6000 rpm for 1 min. Remove supernatant. 
9. Wash the pellet with 500 μL washing buffer (see Note 3). 
10. Centrifuge 6000 rpm for 1 min. 
11. Repeat the wash step. Let dry the pellet for a few min at room 
temperature upside down on paper. 
12. Resuspend pellet in 150 μL nuclease-free water. 
13. Incubate at 70 °C for 4 min. 
14. Centrifuge 13,000 rpm for 3 min and transfer supernatant to a 
new tube. 
15. Check the yield and quality (ng/μL) with nanodrop or equiva-
lent (see Note 4). 
16. Store at -20 °C until use. 
3.1.2 
RNA Extraction 
with Maxwell® RSC Plant 
RNA Kit 
1. Weigh fresh plant material (500 mg) and put it into a sample 
extraction bag. 
2. Add 5 mL of CTAB buffer and homogenize with a mechanical 
device. 
3. Wait 10 min to decant rough tissue residues. Transfer 1 mL of 
sap into a 2 mL microcentrifuge tube. 
4. Add 2% of the chilled 1-Thioglycerol to the CTAB extract. 
5. Vortex for 30–60 s, then place on ice. If foaming occurs, let the 
sample settle on ice.

Nanopore Technology to Identify Virus Infections in Woody Plants
271
6. Heat samples at 65 °C for 15 min. 
7. Centrifuge samples at 10,000 rpm for 5 min and transfer 
400 μL to a new 1.5 mL microcentrifuge tube, being careful 
not to transfer any of the plant tissue debris. 
8. Shortly before processing samples on the Maxwell® RSC 
Instrument, add 200 μL of Lysis Buffer to 400 μL of the 
homogenate. Vortex vigorously for 15 secs to mix. 
9. Incubate at room temperature for 10 min. 
10. Set up the deck tray and cartridges. 
11. Transfer the supernatant to well #1 of the Maxwell® RSC 
Cartridge. Well #1 is closest to the cartridge label and farthest 
from the elution tube (50 μL nuclease-free water). 
12. Add 5 μL of reconstituted DNase to well #4. 
13. Check the yield (ng/μL) and the quality with Nanodrop (see 
Note 4). 
3.2 
Minion Library 
Preparation 
The library synthesis and preparation protocol are essentially 
adapted 
from 
the 
kit 
PCR-cDNA 
sequencing—barcoding 
(SQK-PCB109); 
Version: 
PCB_9092_v109_revF_10Oct2019; 
Last update: 05/07/2022 (Oxford Nanopore Technologies, 
Oxford, UK). 
3.2.1 
Reverse 
Transcription and Strand-
Switching 
1. Prepare the following reaction in a 1.5 mL microcentrifuge 
tube, per sample: x μL total RNA (~100 ng) or PolyA+RNA 
(1 ng) or dsRNA (~100 ng), 1 μL 2  μM VNP or RP (see Note 
5), 1 μL 10 mM dNTPs, RNase-free water to 11 μL total 
volume. 
2. Mix gently by ﬂicking the tube and spin down. 
3. Incubate at 65 ° C for 5 min (see Note 6) and then snap cool on 
a pre-chilled freezer block (-20 °C). 
4. In a separate tube, mix the following, per sample: 1 μL 5× RT 
Buffer, 1 μL 40 U/μL RNase inhibitor, 2 μL 10  μM SSP, 4 μL 
RNase-free water. 
5. Mix gently by ﬂicking the tube and spin down. 
6. Add the strand-switching buffer to the snap-cooled, annealed 
mRNA, mix by ﬂicking the tube, and spin down. 
7. Add 1 μL of Maxima H Minus Reverse Transcriptase. The total 
volume is now 20 μL. 
8. Mix gently by ﬂicking the tube and spin down. 
9. Incubate using the following protocol [12]: 23 °C for 10 min 
(only for random hexamers), 50 °C for 10 min, 55 °C for 
10 min, 42 °C for 10 min, inactivate by heating at 85 °C for 
5 min, hold at 4 °C.

272
Seraﬁna Serena Amoia et al.
3.2.2 
Selecting for Full-
Length Transcripts by PCR 
and Barcoding Samples 
(See Note 7) 
1. For each sample (up to 12), prepare the following reaction at 
room temperature, per sample: 5 μL reverse-transcribed RNA 
sample, 1.5 μL barcode primers (BP01-BP12) (see Note 8), 
25 μL 2× LongAmp Taq Master Mix, 18.5 μL Nuclease-free 
water. 
2. Amplify using the following cycling conditions: 95 °C for 30 s, 
95 °C for 15 s, (11–18* cycles), 62 °C for 15 s (11–18* cycles), 
65 °C for 50 s per kb (11–18* cycles), 65 °C for 6 min, 4° for 
1. *The recommended starting point is 14 cycles—adjust this 
depending on experimental needs. 
3. Add 1 μL of exonuclease I directly to each PCR tube. Mix by 
pipetting. 
4. Incubate the reaction at 37 °C for 15 min, followed by 80 °C 
for 15 min in the thermal cycler. 
5. Pool any PCR reactions containing the same barcoded sample 
in a clean 1.5 mL microcentrifuge DNA tube. 
6. Resuspend the AMPure XP beads by vortexing. 
7. Add 0.8X equivalents of resuspended AMPure XP beads to the 
reaction and mix by pipetting. 
8. Incubate for 5 min at room temperature ﬂicking the tube. 
9. Prepare 500 μL of fresh 70% ethanol in nuclease-free water. 
10. Spin down the sample and pellet on a magnet. Keep the tube 
on the magnet and pipette off the supernatant. 
11. Keep the tube on the magnet and wash the beads with 200 μL 
of freshly prepared 70% ethanol without disturbing the pellet. 
Remove the ethanol using a pipette and discard. 
12. Repeat the previous step. 
13. Spin down and place the tube back on the magnet. Pipette off 
any residual 70% ethanol. Brieﬂy allow to dry. 
14. Remove the tube from the magnetic rack and resuspend the 
pellet in 14 μL of EB. 
15. Incubate the tube for 10 min at room temperature (see 
Note 9). 
16. Pellet the beads on magnet until the eluate is clear and 
colorless. 
17. Remove and retain 14 μL of eluate which contains the DNA 
library in a clean 1.5 mL microcentrifuge tube. Dispose of the 
pelleted beads. 
18. Analyze 1 μL of the ampliﬁed cDNA for size, quantity, and 
quality (see Note 10).

Mass
Nanopore Technology to Identify Virus Infections in Woody Plants
273
Table 2 
Table of molar conversion of nanogram amounts of synthesized libraries (from cDNA-PCR sequencing 
(SQK-PCS109)—Introduction to the protocol; Version: PCS_9085_v109_revK_14Aug2019, Oxford 
Nanopore Technologies) 
Molarity if fragment 
length = 0.5 kb 
Molarity if fragment 
length = 1.5 kb 
Molarity if fragment 
length = 3 kb  
50 ng
154 fmol
51 fmol
26 fmol 
100 ng
308 fmol
103 fmol
51 fmol 
200 ng
616 fmol
205 fmol
103 fmol 
300 ng
925 fmol
308 fmol
154 fmol 
19. In a 1.5 mL microcentrifuge tube, pool together a total of 
100 fmol of the ampliﬁed cDNA barcoded samples to a ﬁnal 
volume of 11 μL in EB. 
20. If the quantity of ampliﬁed cDNA is above 100 fmol (Table 2), 
the remaining cDNA can be frozen and stored for another 
sequencing experiment (in this case, library preparation 
would start from Subheading 3.2, step 3 adapter addition). 
We recommend avoiding multiple freeze/thaw cycles to pre-
vent DNA degradation. 
3.2.3 
Adapter Addition
1. Add 1 μL of RAP to the ampliﬁed cDNA library (Fig. 1). Mix 
by pipetting and spin down. 
2. Incubate the reaction for 5 min at room temperature. Spin 
down brieﬂy. 
3.2.4 
Priming and 
Loading the SpotON Flow 
Cell 
1. Thaw the SQB, LB, FLT, and one tube of FB at room temper-
ature. Mix by vortexing and spin down. 
2. Open the MinION Mk1B lid and slide the ﬂow cell under the 
clip. Press down ﬁrmly on the ﬂow cell to ensure correct 
thermal and electrical contact. 
3. Slide 
the 
priming 
port 
cover 
clockwise 
to 
open 
the 
priming port. 
4. After opening the priming port, check for a small air bubble 
under the cover. Draw back a small volume to remove any 
bubbles (i.e., a few μL). 
5. Set a 1000 μL single channel pipette to 200 μL. 
6. Insert the tip into the priming port. 
7. Turn the wheel until the dial shows 220–230 μL, or until you 
can see a small volume of buffer entering the pipette tip (see 
Note 10).

274
Seraﬁna Serena Amoia et al.
Fig. 1 Summary of MinION library preparation. Main steps: (1) Use the strand-
switching protocol, prepare full-length cDNAs from polyA+ RNA or total RNA. 
(2) Amplify the cDNAs produced by PCR, adding barcodes during the PCR step. 
(3) Pool the PCR products and attach sequencing adapters. (4) Prime the ﬂow cell 
and load your cDNA library into the ﬂow cell. (From https://community. 
nanoporetech.com/docs/prepare/library_prep_protocols/pcr-cdna-barcoding_ 
sqk-pcb109/v/pcb_9092_v109_revj_10oct2019; 
2023 
Image 
courtesy 
of 
Oxford Nanopore Technologies plc) 
8. Prepare the ﬂow cell priming mix: Add 30 μL of thawed and 
mixed FLT directly to the tube of thawed and mixed FB and 
mix by vortexing. 
9. Load 800 μL of the priming mix into the ﬂow cell via the 
priming port, avoiding the introduction of air bubbles. Wait 
for 5 min. During this time, prepare the library for loading by 
following the steps below. 
10. Thoroughly mix the contents of the LB by pipetting. 
11. In a new tube, prepare the library for loading as follows, per 
sample: 37.5 μL SQB, 25.5 μL LB*, 12 μL DNA library. *LB 
must be mixed immediately before use. 
12. Complete the ﬂow cell priming; gently lift the SpotON sample 
port cover to make the SpotON sample port accessible. 
13. Load 200 μL of the priming mix into the ﬂow cell via the 
priming port (not the SpotON sample port), avoiding the 
introduction of air bubbles.

Nanopore Technology to Identify Virus Infections in Woody Plants
275
Fig. 2 Overview of ﬂow cell operational components. (From https://community.nanoporetech.com/docs/ 
prepare/library_prep_protocols/pcr-cdna-barcoding_sqk-pcb109/v/pcb_9092_v109_revj_10oct2019, 2023 
Image courtesy of Oxford Nanopore Technologies plc) 
14. Mix the prepared library gently by pipetting up and down just 
prior to loading. Add 75 μL of sample to the ﬂow cell via the 
SpotON sample port in a dropwise fashion. Ensure each drop 
ﬂows into the port before adding the next (see Note 11). 
15. Gently replace the SpotON sample port cover, making sure the 
bung enters the SpotON port, close the priming port, and 
replace the MinION Mk1B lid (Fig. 2). 
3.2.5 
Start the 
Sequencing Run 
1. After having loaded the ﬂowcell, the sequencing run could be 
started following the manufactures’ instructions available at: 
https://community.nanoporetech.com/guides/minion/ 
rna002/5/start-your-run?os=windows. 
2. Once the sequencing experiment is complete, if you would like 
to reuse the ﬂow cell, wash the ﬂow cell as soon as possible after 
you stop the run following the wash kit instructions. 
3. Store the washed ﬂow cell at 2–8 °C. 
3.3 
Bioinformatic 
Analysis for 
Metagenomic 
Detection and 
Identiﬁcation 
The basecalling (transformation of the electric signal in the nucleo-
tide base) can be launched during the sequencing or at the end of 
the run via the MinKNOW program, as follows: 
1. Select the “Analysis” button from the “Start” screen of the 
MinKNOWSelect. 
3.3.1 
Basecalling
2. Select “Basecalling” button to open the basecalling settings 
options. 
3. Select the folder where the .fast5 ﬁles are stored. 
4. Select the output folder and the ﬁle type for the output.

276
Seraﬁna Serena Amoia et al.
In the latest release of the MinKNOW program, the basecalling 
step starts together with the sequencing. Furthermore, before 
starting the sequencing run, it is possible to select a Phred score 
threshold and the minimum length of reads to be retained. 
3.3.2 
Quality Check of 
Sequencing 
In addition to the quality controls produced through the Min-
KNOW program, it is possible to use the ﬁle produced during the 
sequencing named sequencing_summary_*.txt to perform an 
additional quality control step of the sequencing with the pycoQC 
program. Such program produces an html interactive datasheet. 
The program could be launched as follows. The use of Conda is 
suggested for the correct installation of this tool. 
> pycoQC -f sequencing_summary_*.txt -o pycoQC_output. 
html. 
3.3.3 
Launching EPI2me
EPI2ME is a cloud-based analysis platform supplied by Oxford 
Nanopore, for a user-friendly analysis of ONT sequencing data. 
Such platform contains a number of preset bioinformatics pipelines 
for different purposes. In the case of viral metagenomics studies, it 
is possible to use the FASTQ WIMP (What’s In My Pot) pipeline 
for a ﬁrst rough overview and identiﬁcation of viruses eventually 
present in the sample. Since, in the case of high-throughput 
sequencing, the detection and identiﬁcation of viruses are not 
targeted, the outcome and the success of the search of such agents 
are strongly database-dependent. Consequently, the use of the 
FASTQ WIMP tool might not be exhaustive or conclusive. There-
fore, we suggest using the EPI2ME for demultiplexing and a 
further quality ﬁltering of reads using the pipeline FASTQ barcod-
ing and, thereafter, run on the ﬁles obtained from this step a further 
search for the identiﬁcation of viral reads as described below. 
3.3.4 
Identiﬁcation of 
Virus-Derived Reads 
All the reads having passed the QC ﬁlters applied by the EPI2ME 
tool in the previous step will be joined in one ﬁle and analyzed for 
the identiﬁcation of viral reads. 
1. Join all the ﬁle obtained from the EPI2ME quality ﬁlter in one 
fastq ﬁle, using the cat command 
> cat barcode0n*.fastq > barcode0n.fastq 
2. convert .fastq ﬁle in .fasta ﬁle, through the fastx toolkit 
> fastq_to_fasta -i barcode0n.fastq -o barcode0n. 
fasta -Q33 -v 
3. Launch BLASTN analysis vs. “nt database” for identiﬁcation of 
known viruses, applying an evalue threshold of 10-6 
> blastn -db nt_db -query barcode0n.fasta -out blas-
tn_out.xml
-max_target_seqs 
5
-outfmt 
5
-evalue 
0.000001

Nanopore Technology to Identify Virus Infections in Woody Plants
277
4. Launch BLASTX analysis vs. “viral protein” database for the 
identiﬁcation of known and possible new viruses, applying an 
e-value threshold of 10-4 
> blastx -db viral_protein_db -query barcode0n.fasta
-out 
blastx_out.xml
-max_target_seqs 
5
-outfmt 
5 -evalue 0.0001 
3.3.5 
Minimap2 
Alignment on a Reference 
Sequence 
In the case of identiﬁcation of reads belonging to known viruses, it 
is possible to map the reads on the respective reference genome 
using the aligner minimap2, as follows: 
minimap2 -a reference_genome query.fa > output.sam 
The .sam output could be graphically visualized using GUI 
program (i.e., Geneious or CLC genomics workbench) and used 
for further analysis, such as primer design for molecular validation 
(s). 
4 
Notes 
1. Similar amount of puriﬁed double-stranded RNA from plant 
extracts [13] could be alternatively used as starting template for 
the de novo discovery of plant virus genomes. 
2. Optional step: Wash supernatant by vortexing with 350 μL 
trizol or neutralized phenol; then, add 300 μL chloroform. 
Vortex extensively and centrifuge to separate phases. 
3. At this point, the pellet may be difﬁcult to resuspend. 
4. Check the integrity of the extracts by electrophoresis in 1.2% 
agarose gel in 1× TBE. 
5. Random-anchored primer sequence: 5′- ACTTGCCTGTCG 
CTCTATCTTCNNNNNNNNN-3′ [12]. 
6. A more intensive preliminary heating step (i.e., 98 °C for 
3–5 min, then immediately chill on ice) should be applied 
before reverse transcription of double-stranded RNA extracts, 
to allow a complete denaturation of the two complementary 
strands and the base matching in any complex secondary 
structures. 
7. 2 × 50 μL PCR reactions and 5 μL of reverse transcription 
reaction in each PCR reaction are enough for ﬁnal library 
preparation. Do NOT use all 20 μL of the reverse transcription 
reaction in a single PCR reaction. 
8. The barcode primers, supplied in the kit SQKPCB-109, match 
with 5′ and 3′ homologous sequences that are different each 
other.

278
Seraﬁna Serena Amoia et al.
9. An incubation period up to 20 min at 37 °C may increase the 
eluted yield. 
10. Sometimes a high-molecular weight product is visible in the 
wells of the gel when the PCR products are run, instead of the 
expected smear. These libraries are typically associated with 
poor sequencing performance. Repeating the PCR with other 
fewer cycles can solve this problem. 
11. Check the library concentration with Qubit™ dsDNA High 
Sensitivity (HS) assay kit and library quality with 1.2% TBE 
agarose gel electrophoresis. 
12. Do not remove more than 20–30 μL and make sure that the 
loading chamber (array of pores) is always covered by buffer. 
Introducing air bubbles into the array can irreversibly damage 
pores. 
13. Load the library as soon as possible after this step. Keep the 
library on ice until use. 
References 
1. Maliogka VI, Minafra A, Saldarelli P et al 
(2018) Recent advances on detection and char-
acterization of fruit tree viruses using high-
throughput sequencing technologies. Viruses 
10:436 
2. Lebas B, Adams I, Al Rwahnih M et al (2022) 
Facilitating the adoption of high-throughput 
sequencing technologies as a plant pest diag-
nostic 
test 
in 
laboratories: 
a 
step-by-step 
description. EPPO Bull 52:394–418 
3. Barba M, Czosnek H, Hadidi A (2014) Histor-
ical perspective, development and applications 
of next-generation sequencing in plant virol-
ogy. Viruses 6:106–136 
4. Gaafar YZA, Ziebell H (2020) Comparative 
study on three viral enrichment approaches 
based on RNA extraction for plant virus/viroid 
detection using high-throughput sequencing. 
PLoS One 15:e0237951 
5. Filloux D, Fernandez E, Loire E et al (2018) 
Nanopore-based detection and characteriza-
tion of yam viruses. Sci Rep 8:1–11 
6. Boykin LM, Sseruwagi P, Alicai T et al (2019) 
Tree lab: portable genomics for early detection 
of plant viruses and pests in sub-Saharan Africa. 
Genes 10:632 
7. Lee HJ, Cho IS, Jeong RD (2022) Nanopore 
metagenomics sequencing for rapid diagnosis 
and characterization of lily viruses. Plant Pathol 
J 38:503–512 
8. Amoia SS, Minafra A, Nicoloso V et al (2022) 
A new jasmine virus C isolate identiﬁed by 
nanopore sequencing is associated to yellow 
mosaic symptoms of Jasminum ofﬁcinale in 
Italy. Plan Theory 11:309 
9. Sun K, Liu Y, Zhou X et al (2022) Nanopore 
sequencing technology and its application in 
plant virus diagnostics. Front Microbiol 13 
10. Liefting LW, Waite DW, Thompson JR (2021) 
Application of Oxford nanopore technology to 
plant virus detection. Viruses 13:1424 
11. Foissac X, Svanella-Dumas L, Gentit P et al 
(2005) Polyvalent degenerate oligonucleotides 
reverse transcription-polymerase chain reac-
tion: a polyvalent detection and characteriza-
tion tool for trichoviruses, capilloviruses, and 
foveaviruses. Phytopathology 95:617–625 
12. Della Bartola M, Byrne S, Mullins E (2020) 
Characterization of potato virus Y isolates and 
assessment of nanopore sequencing to detect 
and genotype potato viruses. Viruses 12:E478 
13. Marais A, Faure C, Bergey B, Candresse T 
(2018) Viral double-stranded RNAs (dsRNAs) 
from plants: alternative nucleic acid substrates 
for 
high-throughput 
sequencing. 
Methods 
Mol Biol Clifton NJ 1746:45–53

Chapter 19 
Distribution of Small RNAs Along Transposable Elements 
in Vitis vinifera During Somatic Embryogenesis 
Silvia Rotunno, Paola Leonetti, Gyo¨rgy Szittya, and Vitantonio Pantaleo 
Abstract 
Metaviridae is a family of reverse-transcribing viruses, closely related to retroviruses; they exist within their 
host’s DNA as transposable elements. Transposable element study requires the use of specialized tools, in 
part because of their repetitive nature. By combining data from transcript RNA-Seq, small RNA-Seq, and 
parallel analysis of RNA ends-Seq from grapevine somatic embryos, we set up a bioinformatics ﬂowchart 
that could be able to assemble and identify transposable elements. 
Key words Small RNAs, Degradome, Transposable elements, Somatic embryos, Vitis vinifera 
1 
Introduction 
Reverse transcription is a process by which viruses generate com-
plementary DNA (cDNA) from an RNA template, using enzymes 
called reverse transcriptases. Metaviridae [1] is a family of reverse-
transcribing viruses, closely related to retroviruses; they exist within 
their host’s DNA as transposable elements (hereafter TEs) of 
genetic material, meaning that they can move to different locations 
within the host’s genome. 
TEs are not randomly distributed in genomes, are an extensive 
source of genetic polymorphism, are associated with genome rear-
rangements, contribute to regulating the transcriptional network, 
and, when activated, they are known to produce coding and 
non-coding RNAs [2], including short RNAs [3]. 
Somatic embryogenesis (SE) is a process where somatic cells 
undergo processes of dedifferentiation, i.e., increasing “potency,” 
and reprogram themselves to differentiate again. In grapevine, this 
process is genotype-dependent, and different cultivars show differ-
ent efﬁciency in SE [4]. 
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5_19, 
© The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer Nature 2024
279

280
Silvia Rotunno et al.
TEs study poses a number of analytical challenges and often 
requires the use of specialized tools, in part because of their repeti-
tive nature. By sequencing, viral metagenomics studies the viral 
genetic material recovered directly from cellular nucleic acid sam-
ples, including somatic embryos. Combining data from transcript 
RNA-Seq, small RNA-Seq, and parallel analysis of RNA ends 
(PARE)-Seq (hereafter degradome) [5–9], from different grape-
vine cultivars, we set up a bioinformatics ﬂowchart that could be 
able to assemble and identify a different expression of TEs. 
2 
Materials 
2.1 
Transposable 
Elements of Vitis 
vinifera and Raw Data 
from Transcript RNA-
Seq, Small RNA-Seq 
and Degradome 
1. Vitis vinifera TEs fasta ﬁle and gff3 available at https://urgi. 
versailles.inra.fr/Species/Vitis/Annotations [10]. 
2. Raw data of small RNA-Seq and degradome of “Brachetto” 
cultivar available in Gene Expression Omnibus database (GEO, 
https://www.ncbi.nlm.nih.gov/geo/) 
with 
accession 
ID 
GSE150881. 
3. Raw data of small RNA-Seq of “Cabernet Sauvignon” 
(CS) and “Sangiovese” (SG) cultivars available in GEO with 
accession ID GSE152337 [4]. 
4. Raw data of transcript RNA-Seq of CS and SG cultivars are 
available in GEO with accession ID GSE133761 [4]. 
2.2 
Bioinformatics 
Tools and Software 
1. fastp (v. 0.21.0) (https://github.com/OpenGene/fastp) [11]. 
2. fastx_toolkit (v. 0.0.13) (http://hannonlab.cshl.edu/fastx_ 
toolkit/commandline.html). 
3. awk (v. 4.1.3). 
4. fasta2tab and tab2fasta (https://github.com/nylander/fasta-
tab.git) 
5. bowtie2 (v. 2.2.9) (https://bowtie-bio.sourceforge.net/ 
bowtie2/index.shtml) [12, 13]. 
6. samtools (v. 1.3.1) (http://www.htslib.org/) [14]. 
7. UEA Workbench (v. 4.7_update) (https://github.com/ 
sRNAworkbenchuea/UEA_sRNA_Workbench) [15, 16]. 
8. R (v > 3.3.0) (https://cran.rstudio.com/). 
9. Rstudio (https://posit.co/download/rstudio-desktop/). 
10. edgeR (v. 3.36.0) (https://bioconductor.org/packages/ 
release/bioc/html/edgeR.html) [17–19]. 
11. Venny (v. 2.1) (https://bioinfogp.cnb.csic.es/tools/ 
venny/) [20]. 
12. STAR (v. 2.6.1c) (https://github.com/alexdobin/ 
STAR)  [21].

Metaviridae TEs in Somatic Embryos
281
13. featureCounts (v. 1.6.3) (https://subread.sourceforge. 
net/) [22]. 
14. ViRome (v. 0.10) (https://github.com/mw55309/viRome_ 
legacy) [23]. 
15. bedtools (v. 2.25.0) (https://bedtools.readthedocs.io/en/ 
latest/) [24]. 
3 
Methods 
3.1 
Retrieve of Raw 
Data from Repositories 
1. Search for TEs annotation of 12X.v2 grapevine reference 
genome in the website https://urgi.versailles.inra.fr/Species/ 
Vitis/Annotations. 
2. Download the fasta ﬁle of “2473 consensus libraries obtained 
with TEdenovo pipeline and manually curated” and the gff3 
ﬁle corresponding to the genome copies annotation of this 
library. 
3. Download small RNA-Seq data GSE152337 at the website 
https://www.ncbi.nlm.nih.gov/geo/. Runs of interest can be 
collected through the SRA Run Selector, selecting runs 
corresponding to CS undifferentiated callus tissues at 40d of 
culture (SRR12002900, SRR12002901, SRR12002902), CS 
embryogenic callus tissue (SRR12002894, SRR12002895, 
SRR12002896), SG undifferentiated callus tissues at 40d of 
culture (SRR12002909, SRR12002910, SRR12002911), and 
SG embryogenic callus tissue (SRR12002903, SRR12002904, 
SRR12002905). Samples are renamed to be self-explanatory, 
e.g., SRR12002900 will be EC1_UC_smallRNA, and so on. 
4. Download transcript RNA-Seq data GSE133761 at the website 
https://www.ncbi.nlm.nih.gov/geo/. Runs of interest can be 
collected through the SRA Run Selector, selecting runs 
corresponding to CS undifferentiated callus tissues at 40d of 
culture (SRR9640380, SRR9640381, SRR9640382), CS 
embryogenic 
callus 
tissue 
(SRR9640392, 
SRR9640393, 
SRR9640394), SG undifferentiated callus tissues at 40d of 
culture (SRR9640383, SRR9640384, SRR9640385), and SG 
embryogenic 
callus 
tissue 
(SRR9640395, 
SRR9640396, 
SRR9640397). Samples are renamed to be self-explanatory, 
e.g., SRR9640380 will be EC1_UC_RNA, and so on. 
5. Download degradome data GSE150881 at the website 
https://www.ncbi.nlm.nih.gov/geo/. 
3.2 
Bioinformatics 
Analysis 
From now on, general identiﬁers smallRNA and RNA are used to 
indicate small RNA-Seq and transcript RNA-Seq data, respectively.

282
Silvia Rotunno et al.
1. Check the quality and trim adapter sequences of raw data (see 
Note 1). 
> fastp -i smallRNA.fq.gz -o smallRNA_clean.fastq.gz -h 
smallRNA.html -j smallRNA.json 
> fastp -i degradome.fq.gz -o degradome_clean.fastq.gz -h degra-
dome.html -j degradome.json 
> fastp -i RNA_1.fq.gz -I RNA_2.fq.gz -o RNA_clean_1.fastq. 
gz -O RNA_clean_2.fastq.gz -h RNA.html -j RNA.json 
2. Convert the fastq clean data into fasta ﬁles. 
> fastq_to_fasta -i smallRNA_clean.fastq.gz -o smallRNA_-
clean.fasta 
> fastq_to_fasta -i degradome_clean.fastq.gz -o degradome_-
clean.fasta 
3. Select small RNAs longer than 18-nt and smaller than 25-nt. 
> 
fasta2tab 
smallRNA_clean.fasta 
| 
awk 
’OFS="\t" 
{if 
$2>=18 && $2<=25 print $0}’ | tab2fasta > smallRNA_-
clean_18-25.fasta 
4. To map small RNAs to V. vinifera TEs using bowtie2, create 
the index for the reference. 
> 
bowtie2-build
-f 
curated_PAST12Xv2Man2_2_refTEs.fa 
refTEs 
5. Map the reads to the reference (see Note 2). 
> bowtie2 -x refTEs -f -U smallRNA_clean_18-25.fasta -S 
smallRNA_clean_18-25_TEs.sam 
> samtools view –bS smallRNA_clean_18-25_TEs.sam | samtools 
sort > smallRNA_clean_18-25_TEs.bam 
> samtools index smallRNA_clean_18-25_TEs.bam 
6. To identify small RNAs mediated cleavage sites, by integrating 
small RNAs-Seq, degradome and V. vinifera TEs data, use 
PAREsnip2 tool using ﬂexible parameters and Allen’s score 
(see Note 3): 
> java -jar -Xmx8g Workbench.jar -tool paresnip2 -parameters 
parenisp2_ﬂexible_params.cfg -targeting_rules -paresnip2_al-
len.cfg
-srna_ﬁles 
smallRNA_clean_18-25.fasta
-pare_ﬁles 
degradome_clean.fa -reference curated_PAST12Xv2Man2_2_-
refTEs.fa -output_dir paresnip2_results 
The output is reported in Table 1. 
7. Map the reads to the reference. 
> bowtie2 -x refTEs -q -1 <(gunzip -c RNA_clean_1.fastq.gz) -2 
(gunzip -c RNA_clean_2.fastq.gz) -S RNA_clean_TEs.sam 
> samtools view -bS RNA_clean_TEs.sam | samtools sort > 
RNA_clean_TEs.bam 
> samtools index RNA_clean_TEs.bam 
8. Count reads mapping to the reference with bedtools. 
> bedtools groupby -I RNA_clean_Tes.bam -c 1 -g 3 -o count > 
RNA_count_matrix.txt

> STAR --runMode genomeGenerate --genomeDir genome_in-
dex/ --genomeFastaFiles curated_PAST12Xv2Man2_2_refTEs.
Metaviridae TEs in Somatic Embryos
283
Table 1 
Possible cleavage sites on TEs identified by PAREsnip2 
TE ID
Category Cleavage 
Position
Duplex 
Duplex 
MFE
MFE Ratio
p-value
            5'-AATTTGGGCCGAAACGGAGATCGT-'3
            ||||||||||||||||||||||||||| 
3'-GGAGGCTTAAACCCGGCTTTGCCTCTAGCAAA-'5
            5'-AATTTGGGCCGAAACGGAGATCGT-'3
            ||||||||||||||||||||||||||| 
3'-GGAGGCTTAAACCCGGCTTTACCTCCAGCAAA-'5
            5'-AATTTGGGCCGAAACGGAGATCGT-'3
            ||||||||||||||||||||||||||| 
3'-GGAGGCTTAAACCCGGCTTTGCCTCTAGCAAA-'5
             5'-AATTTGGGCCGAAACGGAGATCGT-'3
            ||||||||||||||||||||||||||| 
3'-GGAGGCTTAAACCCGGCTTTGCCTCTAGCAAA-'5
            5'-AATTTGGGCCGAAACGGAGATCGT-'3
            ||||||||||||||||||||||||||| 
3'-GGAGGCTTAAACCCGGCTTTGCCTCTAGCAAA-'5
             5'-AATTTGGGCCGAAACGGAGATCGT-'3
            ||||||||||||||||||||||||||| 
3'-GGAGGCTTAAACCCGGCTTTGCCTCCAGCAAA-'5 
0.019086002 
RLX-incomp_VvTEdenovoV2-B-G387-Map11
2
2020
-43.6
1
0.045859996 
RLX-incomp_VvTEdenovoV2-B-G4985-Map7
3
723
-33.1
0.759174312 
0.014080156 
RLX-incomp_VvTEdenovoV2-B-G5021-Map7
2
805
-43.6
1
0.025888594 
RLX-incomp_VvTEdenovoV2-B-G6277-Map9
2
208
-43.6
1 
0.004452353 
RLX-incomp_VvTEdenovoV2-B-R3959-
Map12
2
765
-43.6
1
0.014179736 
RLX_VvTEdenovoV2-B-R1164-Map6
1
776
-38.9
0.892201835 
MFE is the minimum free energy associated to the secondary RNA structure 
9. Perform the differential expression analysis with edgeR, using 
the exact test. Undifferentiated callus tissues (UC) are com-
pared with Embryogenic callus tissues (EC) for each cultivar, 
and TEs were considered signiﬁcantly differentially expressed 
with p-value ≤ 0.05 and logFC ≥ 2 or logFC ≤-2. 
> library(edgeR) 
> x <- read.table("counts_matrix.txt", sep = "\t", header = T) 
> y <- DGEList(counts=x[,2:13], group=rep(1:4,each=3)) 
> rownames(y) <- x$X 
> y <- calcNormFactors(y) 
> plotMDS(y) 
> y <- estimateDisp(y) 
> y <- estimateTagwiseDisp(y) 
10. Use edgeR to make pairwise comparisons between the groups: 
(1) Differentiated callus tissue vs. undifferentiated callus tissue 
in CS; (2) differentiated callus tissue vs. undifferentiated callus 
tissue in SG. 
> et_CS <- exactTest(y, pair=c("1","2")) 
> deg_CS <- et_CS$table[which(et$table$PValue<=0.05),] 
> up_CS <- et$table[which(et$table$logFC>=2),] 
> down_CS <- et_CS$table[which(et$table$logFC<=-2),] 
> et_SG <- exactTest(y, pair=c("3","4")) 
> deg_SG <- et_SG$table[which(et$table$PValue<=0.05),] 
> up_SG <- et_SG$table[which(et$table$logFC>=2),] 
> down_SG <- et_SG$table[which(et$table$logFC<=-2),] 
11. Highlight common differentially expressed TEs with the 
online tool Venny. 
12. To annotate TEs, generate genome indexes ﬁles (see Note 4).

fa --sjdbGTFﬁle curated_allChr_PAST12Xv2Man2_2.gff3 --
sjdbGTFtagExonParentTranscript Parent --sjdbOverhang 100
284
Silvia Rotunno et al.
13. Align reads to TEs (see Note 5). 
> 
STAR
--genomeDir 
genome_index/
--readFilesIn 
smallRNA1_clean_18-25.fasta --outSAMtype BAM SortedBy-
Coordinate --outFileNamePreﬁx smallRNA 
> STAR --genomeDir genome_index/ --readFilesIn RNA_-
clean_1.fastq.gz RNA_clean_2.fastq.gz --readFilesCommand 
gunzip -c --outSAMtype BAM SortedByCoordinate --outFileNa-
mePreﬁx RNA 
14. Count reads mapping to TEs (see Note 6). 
> 
featureCounts
-t 
ID
-g 
Parent
-a 
curated_allChr_-
PAST12Xv2Man2_2.gff3 -o small_RNA_counts.txt smallR-
NA_TEs.bam 
> featureCounts -p --countReadPairs -t ID -g Parent -a cur-
ated_allChr_PAST12Xv2Man2_2.gff3
-o 
RNA_counts.txt 
RNA_TEs.bam 
15. Identify TEs belonging to Metaviridae family using the anno-
tation contained in gff3 and used for plotting. 
16. Plot small RNAs and transcript RNAs distribution along TEs, 
and sRNA length frequencies using functions from ViRome 
package (Fig. 1). 
Fig. 1 Small RNAs distribution along two TEs Ty3/Gypsy differentially expressed and belonging to the family of 
Metaviridae and length distribution of the small RNAs in “Brachetto” cultivar (BR). Yellow and purple bars 
indicate sense and antisense strand, respectively

Metaviridae TEs in Somatic Embryos
285
4 
Notes 
1. Use --qualiﬁed_quality_phred to set up a different quality 
threshold (default is 15). Use --unqualiﬁed_percent_limit 
how many percents of bases are allowed to be unqualiﬁed 
(default is 40). Use --average_qual to set the average quality 
score for one read. Use --low_complexity_ﬁlter to enable the 
low complexity ﬁlter and --complexity_threshold to set the 
threshold. Use --thread to set cores to be used for the analysis 
according to your IT infrastructure (max value is 16). Use --
length_required to discard reads shorter than the value indi-
cated. Use --overrepresentation_analysis to enable overrepre-
sented sequence analysis. Use --detect_adapter_for_pe to 
enable the adapter sequence auto-detection for paired-end 
sequences. 
2. Use –p option to set cores to be used for the analysis according 
to your IT infrastructure. 
3. The parameter -Xmx speciﬁes the maximum memory allocation 
pool for a Java Virtual Machine (JVM). The conﬁguration ﬁle 
parenisp2_ﬂexible_params.cfg can be modiﬁed: For example, 
you can ﬁlter out cleavage sites of category 4, modify the 
minimum smallRNA abundance (3 in the pipeline described 
here) and fragments length (between 19-nt and 24-nt in the 
pipeline described here). 
4. The option --genomeDir is used to set the directory where 
genome indexes will be stored. The option –sjdbGTFﬁle spe-
ciﬁes the path to annotation ﬁle in the GTF format. Gff3 
format could be also used; in this case, you need to specify – 
sjdbGTFtagExonParentTranscript. The option --sjdbOver-
hang speciﬁes the length of the genomic sequence around the 
annotated junction to be used in constructing the splice junc-
tions database. Use --runThreadN to set cores according to 
your IT infrastructure. 
5. Use --readFilesCommand if you have zipped input reads ﬁle. 
6. You can input more than one ﬁle simply writing their name 
separated by comma. 
References 
1. Llorens C, Soriano B, Krupovic M, Ictv Report 
Consortium (2020) ICTV virus taxonomy 
proﬁle: Metaviridae. J Gen Virol 101(11): 
1131–1132 
2. Bourque G, Burns KH, Gehring M et al (2018) 
Ten things you should know about transposa-
ble elements. Genome Biol 19:199 
3. Leonetti P, Consiglio A, Arendt D et al (2023) 
Exogenous and endogenous dsRNAs perceived 
by plant Dicer-like 4 protein in the RNAi-
depleted cellular context. Cell Mol Biol Lett 
28:64 
4. Dal Santo S, De Paoli E, Pagliarani C et al 
(2022) Stress responses and epigenomic insta-
bility mark the loss of somatic embryogenesis

286
Silvia Rotunno et al.
competence 
in 
grapevine. 
Plant 
Physiol 
188(1):490–508 
5. Rotunno S, Cocozza C, Pantaleo Vet al (2022) 
Identiﬁcation of known and novel Arundo 
donax L. microRNAs and their targets using 
high-throughput sequencing and degradome 
analysis. Life 12(5):651 
6. Miozzi L, Gambino G, Burgyan J, Pantaleo V 
(2013) Genome-wide identiﬁcation of viral 
and host transcripts targeted by viral siRNAs 
in Vitis vinifera. Mol Plant Pathol 14(1):30–43 
7. Pantaleo V, Szittya G, Moxon S et al (2010) 
Identiﬁcation of grapevine microRNAs and 
their targets using high-throughput sequenc-
ing and degradome analysis. Plant J 62(6): 
960–976 
8. German MA, Pillay M, Jeong DH et al (2008) 
Global 
identiﬁcation 
of 
microRNA-target 
RNA pairs by parallel analysis of RNA ends. 
Nat Biotechnol 26:941–946 
9. Chiumenti M, Catacchio CR, Miozzi L et al 
(2018) A short indel-lacking-resistance gene 
triggers 
silencing 
of 
the 
photosynthetic 
machinery 
components 
through 
TYLCSV-
associated endogenous siRNAs in tomato. 
Front Plant Sci 11(9):1470 
10. Canaguier A, Grimplet J, Di Gaspero G et al 
(2017) A new version of the grapevine reference 
genome assembly (12X.v2) and of its annotation 
(VCost.v3). Genom Data 14:56–62 
11. Chen S, Zhou Y, Chen Y, Gu J (2018) Fastp: 
an ultra-fast all-in-one FASTQ preprocessor. 
Bioinformatics 34(17):i884–i890 
12. Langmead B, Wilks C, Antonescu V, Charles R 
(2018) Scaling read aligners to hundreds of 
threads on general-purpose processors. Bioin-
formatics 35(3):421–432 
13. Langmead B, Salzberg SL (2012) Fast gapped-
read alignment with bowtie 2. Nat Methods 
9(4):357–359 
14. Li H, Handsaker B, Wysoker A et al (2009) 
The sequence alignment/map (SAM) format 
and 
SAMtools. 
Bioinformatics 
25(16): 
2078–2079 
15. Thody J, Folkes L, Medina-Calzada Z et al 
(2018) PAREsnip2: a tool for high-throughput 
prediction of small RNA targets from degra-
dome sequencing data using conﬁgurable tar-
geting 
rules. 
Nucleic 
Acids 
Res 
46(17): 
8730–8739 
16. Mohorianu I, Stocks MB, Applegate CS et al 
(2017) The UEA small RNA workbench: a 
suite of computational tools for small RNA 
analysis. In: Methods in molecular biology 
(Clifton, N.J.), vol 1580, pp 193–224 
17. Robinson MD, McCarthy DJ, Smyth GK 
(2010) edgeR: a Bioconductor package for dif-
ferential expression analysis of digital gene 
expression 
data. 
Bioinformatics 
26(1): 
139–140 
18. McCarthy DJ, Chen Y, Smyth GK (2012) Dif-
ferential 
expression 
analysis 
of 
multifactor 
RNA-Seq 
experiments 
with 
respect 
to 
biological 
variation. 
Nucleic 
Acids 
Res 
40(10):4288–4297 
19. Chen Y, Lun AAT, Smyth GK (2016) From 
reads to genes to pathways: differential expres-
sion analysis of RNA-Seq experiments using 
Rsubread and the edgeR quasi-likelihood pipe-
line. F1000Research 5:1438 
20. Oliveros JC. 2007–2015. Venny. An interactive 
tool for comparing lists with Venn’s diagrams 
21. Dobin A, Davis CA, Schlesinger F et al 
(2013) STAR: ultrafast universal RNA-seq 
aligner. Bioinformatics 29(1):15–21 
22. Liao Y, Smyth GK, Shi W (2014) feature-
Counts: an efﬁcient general-purpose program 
for assigning sequence reads to genomic fea-
tures. Bioinformatics 30(7):923–930 
23. Watson M, Schnettler E, Kohl A (2013) viR-
ome: an R package for the visualization and 
analysis of viral small RNA sequence datasets. 
Bioinformatics 29(15):1902–1903 
24. Quinlan AR, Hall IM (2010) BEDTools: a 
ﬂexible suite of utilities for comparing genomic 
features. Bioinformatics 26(6):841–842

INDEX
A 
Ancient DNA ................................................................222 
Archaea ..................................................1, 2, 4, 7, 10, 161 
Archaeal viruses .................................1–3, 7, 8, 10, 13–15 
B 
Bacteriophage.......................................1, 29, 76, 78, 113, 
133–143, 156 
Begomoviruses .................................................... 104–108, 
110–113, 115 
Bioinformatic pipeline ..........................90, 110, 147, 213 
Bioinformatics ........................................2, 23, 24, 30, 31, 
42, 46, 53–56, 70, 75, 86, 89–95, 105–108, 134, 
136, 138, 146, 152, 156, 179, 180, 191–193, 
199–201, 203–213, 224, 229–231, 236, 245, 
248, 266, 269, 274–277, 280, 281 
Blood virome.................................................................156 
Botrytis cinerea ..........................................................84–88 
C 
Capripoxvirus ....................................................... 165–177 
Circular DNA single stranded viruses 
(ssDNA).......................................... 104, 105, 134, 
135, 137, 140, 142 
Citrus dwarﬁng viroid.......................................... 205, 217 
Citrus exocortis viroid ......................................... 205, 217 
Citrus tristeza virus (CTV).................................200, 201, 
205, 212, 213, 217 
Citrus virus A ....................................................... 205, 217 
CRISPR spacers..................................................3, 7, 8, 16 
D 
Database ................................6–8, 10, 12–14, 16, 24–27, 
31, 33, 37–41, 54, 55, 63, 74, 89–92, 94, 95, 108, 
111, 112, 134, 143, 145–150, 152, 153, 161, 
192, 193, 196, 201, 204–206, 215–217, 
229–231, 237, 238, 245, 248, 266, 276, 277, 
280, 285 
Data integration ............................................................149 
Data visualization............................................................ 41 
Degradome........................................................... 280–282 
Vitantonio Pantaleo and Laura Miozzi (eds.), Viral Metagenomics: Methods and Protocols, Methods in Molecular Biology, vol. 2732, 
https://doi.org/10.1007/978-1-0716-3515-5, 
© The Editor(s) (if applicable) and The Author(s), under exclusive license to Springer Science+Business Media, LLC, part of Springer 
Nature 2024 
287
De novo assembly..................................52, 55, 69, 71, 74, 
76, 79, 89, 91, 192, 193, 204, 215, 216, 222, 
230, 236 
Detection...................................................... 3, 26, 46, 60, 
69, 71, 75, 76, 78, 79, 84, 86, 89, 95–97, 99, 
104–107, 111–113, 119–128, 135, 142, 155, 
156, 166, 199–218, 235, 237, 238, 251, 261, 
263, 265, 266, 274–277 
Diagnostics ................................................. 121, 179, 192, 
199, 235, 236, 238, 265, 266 
DNA viruses ............................................... 2, 84, 95, 104, 
108, 113, 148, 229–231, 238, 247 
dsDNA phage.................................................30, 133, 135 
E 
Ecogenomics ..............................104, 106, 107, 111, 113 
Emerging pathogens.....................................................235 
Emerging viruses...........................................................238 
F 
Freshwater ..........................................................29, 30, 42 
G 
Genome sequencing ........................................1, 119–128 
H 
Herbaria....................................................... 221, 224, 230 
High-throughput sequencing (HTS) .................... 45, 46, 
53, 62, 72, 80, 104–109, 145, 166, 179–196, 
199–218, 222, 236, 251, 265, 266, 276 
Hop stunt viroid .................................................. 205, 217 
Host prediction ...................................................3, 4, 7, 9, 
12, 16, 31, 41, 42 
I 
Illumina sequencing................................... 109, 186, 201, 
228, 251, 252, 266 
In vitro tissue culture................................................69, 71 
L 
Long reads..........................................................5, 31, 236

288 VIRAL METAGENOMICS: METHODS AND PROTOCOLS
Index
M 
Major capsid protein....................................................... 10 
Metagenomics ...............................................1–17, 23, 24, 
49, 62, 68, 71, 104, 106–108, 110, 111, 134, 
140, 145–147, 155, 156, 229, 236, 237, 245, 
251–263, 274–277 
MinION ..................................................... 170, 235–248, 
253, 258, 260, 263, 266, 268, 269, 271–275 
Molecular data...................................................... 145–153 
Museomics.....................................................................222 
Mycorrhizal fungi...............................................68, 69, 71 
Mycovirus ..............................................83, 84, 86, 97, 99 
N 
Nanopore sequencing........................................... 31, 128, 
166, 175, 238, 247, 251–263, 266 
Necrotrophic fungi ...................................................83–99 
Next generation sequencing (NGS) ................84, 88–90, 
95, 108, 111, 240, 254, 258, 261 
O 
Oomycetes................................................. 45–63, 84, 222 
Orchid........................................................................67–80 
Oxford nanopore technologies (ONT) ................. 5, 170, 
176, 236, 238, 239, 247, 251–253, 258, 263, 
266, 271, 273–276 
P 
Phage identiﬁcation ............................................. 133–143 
Phytophthora.................................................45–48, 50–53, 
56, 59, 60, 62, 63 
Pipeline .......................................... 24, 25, 37, 69, 74–79, 
89–95, 108, 166, 175, 180, 191–193, 208, 214, 
215, 217, 276, 281, 285 
Plant virology ................................................................236 
Plant virus discovery .....................................................277 
Plant viruses........................................193, 222, 235–248, 
251–263, 265, 266, 277 
Protocol phage sequencing ..........................................135 
R 
Read mapping ..........................................23, 54, 58, 201, 
205, 208, 209, 212–217 
RNA...............................................2, 24, 45, 68, 84, 120, 
150, 159, 179, 200, 236, 252, 266, 279 
RNA-sequencing..........................25, 46, 52, 53, 72, 182 
Rolling circle ampliﬁcation (RCA)..................... 104–109, 
111–115 
RT-qPCR.............................................120, 121, 123, 124 
S 
SARS-CoV-2 ..................................................................24, 
26, 27, 119–121, 123, 124, 128, 148 
Sequencing ............................................... 5, 6, 15, 23–27, 
30, 33, 35, 36, 46, 53, 63, 72, 75, 88, 89, 98, 99, 
104–108, 115, 120–122, 133–143, 156, 158, 
161, 166, 169, 170, 174–177, 179, 180, 185, 
187, 191, 192, 195, 196, 199, 201–204, 208, 
213, 217, 218, 223, 226–228, 236–239, 244, 
245, 247, 248, 251, 252, 254, 256–261, 263, 
265–278, 280 
Shotgun metagenomics .................................23, 236, 237 
Small RNA library.........................................................181 
Small RNAs .................46, 185, 192, 193, 222, 279–285 
ssDNA phage.................................................................133 
T 
Targeted sequencing............................................ 165–177 
Taxonomy..................................................... 9, 14, 23, 31, 
40–41, 146–153, 231, 246 
Third-generation sequencing technology ...................266 
Tiled PCR......................................................................166 
Transposable elements ......................................... 279–285 
V 
Viral biodiversity ...........................................................147 
Viral genome assembly ................................................... 62 
Viral genome characterization........................................ 54 
Viral metagenome....................................... 16, 29, 30, 33 
Viral metagenomics.............................155–163, 276, 280 
Virome....................................................2, 23, 26, 46, 62, 
134, 143, 156, 162, 179–196, 199, 213, 215, 
237, 245 
Virome sequencing .......................................................142 
Virus diagnostics .................................179, 192, 194, 266 
Virus discovery ............................................................2, 84 
Vitis vinifera......................................................... 279–285 
W 
Wastewater............................................................ 119–128 
Whole-genome sequencing ................................. 165–177

