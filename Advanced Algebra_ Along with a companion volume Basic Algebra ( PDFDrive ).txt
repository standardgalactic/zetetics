

Cornerstones
Series Editors
Charles L. Epstein, University of Pennsylvania, Philadelphia
Steven G. Krantz, Washington University, St. Louis
Advisory Board
Anthony W. Knapp, State University of New York at Stony Brook, Emeritus

Anthony W. Knapp
Advanced Algebra
Along with a companion volume
Basic Algebra
Birkh¨auser
Boston • Basel • Berlin

Anthony W. Knapp
81 Upper Sheep Pasture Road
East Setauket, NY 11733-1729
U.S.A.
e-mail to: aknapp@math.sunysb.edu
http://www.math.sunysb.edu/˜ aknapp/books/a-alg.html
Cover design by Mary Burgess.
Mathematics Subject Classiciﬁcation (2000): 11-01, 13-01, 14-01, 16-01, 18G99, 55U99, 11R04, 11S15,
12F99, 14A05, 14H05, 12Y05, 14A10, 14Q99
Library of Congress Control Number: 2007936880
ISBN-13: 978-0-8176-4522-9
eISBN-13: 978-0-8176-4613-4
Basic Algebra
ISBN-13: 978-0-8176-3248-9
Basic Algebra and Advanced Algebra (Set)
ISBN-13: 978-0-8176-4533-5
Printed on acid-free paper.
c⃝2007 Anthony W. Knapp
All rights reserved. This work may not be translated or copied in whole or in part without the written
permission of the publisher (Birkh¨auser Boston, c/o Springer Science+Business Media LLC, 233 Spring
Street, New York, NY 10013, USA) and the author, except for brief excerpts in connection with reviews
or scholarly analysis. Use in connection with any form of information storage and retrieval, electronic
adaptation, computer software, or by similar or dissimilar methodology now known or hereafter developed
is forbidden.
The use in this publication of trade names, trademarks, service marks and similar terms, even if they are
not identiﬁed as such, is not to be taken as an expression of opinion as to whether or not they are subject to
proprietary rights.
9 8 7 6 5 4 3 2 1
www.birkhauser.com
(MP)

To Susan
and
To My Algebra Teachers:
Ralph Fox, John Fraleigh, Robert Gunning,
John Kemeny, Bertram Kostant, Robert Langlands,
Goro Shimura, Hale Trotter, Richard Williamson

CONTENTS
Contents of Basic Algebra
x
Preface
xi
List of Figures
xv
Dependence among Chapters
xvi
Guide for the Reader
xvii
Notation and Terminology
xxi
I.
TRANSITION TO MODERN NUMBER THEORY
1
1.
Historical Background
1
2.
Quadratic Reciprocity
8
3.
Equivalence and Reduction of Quadratic Forms
12
4.
Composition of Forms, Class Group
24
5.
Genera
31
6.
Quadratic Number Fields and Their Units
35
7.
Relationship of Quadratic Forms to Ideals
38
8.
Primes in the Progressions 4n + 1 and 4n + 3
50
9.
Dirichlet Series and Euler Products
56
10.
Dirichlet’s Theorem on Primes in Arithmetic Progressions
61
11.
Problems
67
II.
WEDDERBURN–ARTIN RING THEORY
76
1.
Historical Motivation
77
2.
Semisimple Rings and Wedderburn’s Theorem
81
3.
Rings with Chain Condition and Artin’s Theorem
87
4.
Wedderburn–Artin Radical
89
5.
Wedderburn’s Main Theorem
94
6.
Semisimplicity and Tensor Products
104
7.
Skolem–Noether Theorem
111
8.
Double Centralizer Theorem
114
9.
Wedderburn’s Theorem about Finite Division Rings
117
10.
Frobenius’s Theorem about Division Algebras over the Reals
118
11.
Problems
120
vii

viii
Contents
III.
BRAUER GROUP
123
1.
Deﬁnition and Examples, Relative Brauer Group
124
2.
Factor Sets
132
3.
Crossed Products
135
4.
Hilbert’s Theorem 90
145
5.
Digression on Cohomology of Groups
147
6.
Relative Brauer Group when the Galois Group Is Cyclic
158
7.
Problems
162
IV.
HOMOLOGICAL ALGEBRA
166
1.
Overview
167
2.
Complexes and Additive Functors
171
3.
Long Exact Sequences
184
4.
Projectives and Injectives
192
5.
Derived Functors
202
6.
Long Exact Sequences of Derived Functors
210
7.
Ext and Tor
223
8.
Abelian Categories
232
9.
Problems
250
V.
THREE THEOREMS IN ALGEBRAIC NUMBER THEORY
262
1.
Setting
262
2.
Discriminant
266
3.
Dedekind Discriminant Theorem
274
4.
Cubic Number Fields as Examples
279
5.
Dirichlet Unit Theorem
288
6.
Finiteness of the Class Number
298
7.
Problems
307
VI.
REINTERPRETATION WITH ADELES AND IDELES
313
1.
p-adic Numbers
314
2.
Discrete Valuations
320
3.
Absolute Values
331
4.
Completions
342
5.
Hensel’s Lemma
349
6.
Ramiﬁcation Indices and Residue Class Degrees
353
7.
Special Features of Galois Extensions
368
8.
Different and Discriminant
371
9.
Global and Local Fields
382
10.
Adeles and Ideles
388
11.
Problems
397

Contents
ix
VII. INFINITE FIELD EXTENSIONS
403
1.
Nullstellensatz
404
2.
Transcendence Degree
408
3.
Separable and Purely Inseparable Extensions
414
4.
Krull Dimension
423
5.
Nonsingular and Singular Points
428
6.
Inﬁnite Galois Groups
434
7.
Problems
445
VIII. BACKGROUND FOR ALGEBRAIC GEOMETRY
447
1.
Historical Origins and Overview
448
2.
Resultant and Bezout’s Theorem
451
3.
Projective Plane Curves
456
4.
Intersection Multiplicity for a Line with a Curve
466
5.
Intersection Multiplicity for Two Curves
473
6.
General Form of Bezout’s Theorem for Plane Curves
488
7.
Gr¨obner Bases
491
8.
Constructive Existence
499
9.
Uniqueness of Reduced Gr¨obner Bases
508
10.
Simultaneous Systems of Polynomial Equations
510
11.
Problems
516
IX.
THE NUMBER THEORY OF ALGEBRAIC CURVES
520
1.
Historical Origins and Overview
520
2.
Divisors
531
3.
Genus
534
4.
Riemann–Roch Theorem
540
5.
Applications of the Riemann–Roch Theorem
552
6.
Problems
554
X.
METHODS OF ALGEBRAIC GEOMETRY
558
1.
Afﬁne Algebraic Sets and Afﬁne Varieties
559
2.
Geometric Dimension
563
3.
Projective Algebraic Sets and Projective Varieties
570
4.
Rational Functions and Regular Functions
579
5.
Morphisms
590
6.
Rational Maps
595
7.
Zariski’s Theorem about Nonsingular Points
600
8.
Classiﬁcation Questions about Irreducible Curves
604
9.
Afﬁne Algebraic Sets for Monomial Ideals
618
10.
Hilbert Polynomial in the Afﬁne Case
626

x
Contents
X.
METHODS OF ALGEBRAIC GEOMETRY (Continued)
11.
Hilbert Polynomial in the Projective Case
633
12.
Intersections in Projective Space
635
13.
Schemes
638
14.
Problems
644
Hints for Solutions of Problems
649
Selected References
713
Index of Notation
717
Index
721
CONTENTS OF BASIC ALGEBRA
I.
Preliminaries about the Integers, Polynomials, and Matrices
II.
Vector Spaces over Q, R, and C
III.
Inner-Product Spaces
IV.
Groups and Group Actions
V.
Theory of a Single Linear Transformation
VI.
Multilinear Algebra
VII.
Advanced Group Theory
VIII. Commutative Rings and Their Modules
IX.
Fields and Galois Theory
X.
Modules over Noncommutative Rings

PREFACE
Advanced Algebra and its companion volume Basic Algebra systematically de-
velop concepts and tools in algebra that are vital to every mathematician, whether
pure or applied, aspiring or established. The two books together aim to give the
reader a global view of algebra, its use, and its role in mathematics as a whole.
The idea is to explain what the young mathematician needs to know about algebra
in order to communicate well with colleagues in all branches of mathematics.
The books are written as textbooks, and their primary audience is students
who are learning the material for the ﬁrst time and who are planning a career in
which they will use advanced mathematics professionally. Much of the material
in the two books, including nearly all of Basic Algebra and some of Advanced
Algebra, corresponds to normal course work, with the proportions depending on
the university. The books include further topics that may be skipped in required
courses but that the professional mathematician will ultimately want to learn by
self-study. The test of each topic for inclusion is whether it is something that a
plenary lecturer at a broad international or national meeting is likely to take as
known by the audience.
Key topics and features of Advanced Algebra are as follows:
• Topics build on the linear algebra, group theory, factorization of ideals, struc-
ture of ﬁelds, Galois theory, and elementary theory of modules developed in
Basic Algebra.
• Individual chapters treat various topics in commutative and noncommutative
algebra, together providing introductions to the theory of associative algebras,
homological algebra, algebraic number theory, and algebraic geometry.
• The text emphasizes connections between algebra and other branches of math-
ematics, particularly topology and complex analysis. All the while, it carries
along two themes from Basic Algebra: the analogy between integers and
polynomials in one variable over a ﬁeld, and the relationship between number
theory and geometry.
• Several sections in two chapters introduce the subject of Gr¨obner bases, which
is the modern gateway toward handling simultaneous polynomial equations in
applications.
• The development proceeds from the particular to the general, often introducing
examples well before a theory that incorporates them.
xi

xii
Preface
• More than 250 problems at the ends of chapters illuminate aspects of the text,
develop related topics, and point to additional applications. A separate section
“Hints for Solutions of Problems” at the end of the book gives detailed hints
for most of the problems, complete solutions for many.
It is assumed that the reader is already familiar with linear algebra, group
theory, rings and modules, unique factorization domains, Dedekind domains,
ﬁelds and algebraic extension ﬁelds, and Galois theory at the level discussed in
Basic Algebra. Not all of this material is needed for each chapter of Advanced
Algebra, and chapter-by-chapter information about prerequisites appears in the
Guide for the Reader beginning on page xvii.
Historically the subjects of algebraic number theory and algebraic geometry
have inﬂuenced each other as they have developed, and the present book tries to
bring out this interaction to some extent. It is easy to see that there must be a close
connection. In fact, one number-theory problem already solved by Fermat and
Euler was to ﬁnd all pairs (x, y) of integers satisfying x2 + y2 = n, where n is a
given positive integer. More generally one can consider higher-order equations
of this kind, such as y2 = x3 +8x. Even this simple change of degree has a great
effect on the difﬁculty, so much so that one is inclined ﬁrst to solve an easier
problem: ﬁnd the rational pairs satisfying the equation. Is the search for rational
solutions a problem in number theory or a problem about a curve in the plane? The
answer is that really it is both. We can carry this kind of question further. Instead
of considering solutions of a single polynomial equation in two variables, we
can consider solutions of a system of polynomial equations in several variables.
Within the system no individual equation is an intrinsic feature of the problem
because one of the equations can always be replaced by its sum with another of
the equations; if we regard each equation as an expression set equal to 0, then
the intrinsic problem is to study the locus of common zeros of the equations.
This formulation of the problem sounds much more like algebraic geometry than
number theory.
A doubter might draw a distinction between integer solutions and rational
solutions, saying that ﬁnding integer solutions is number theory while ﬁnding
rational solutions is algebraic geometry. Experience shows that this is an artiﬁcial
distinction. Although algebraic geometry was initially developed as a subject that
studies solutions for which the variables take values in a ﬁeld, particularly in an
algebraically closed ﬁeld, the insistence on working only with ﬁelds imposed
artiﬁcial limitations on how problems could be approached. In the late 1950s and
early 1960s the foundations of the subject were transformed by allowing variables
to take values in an arbitrary commutative ring with identity. The very end of this
book aims to give some idea of what those new foundations are.
Along the way we shall observe parallels between number theory and algebraic
geometry, even as we nominally study one subject at a time. The book begins with

Preface
xiii
a chapter on those aspects of number theory that mark the historical transition
from classical number theory to modern algebraic number theory. Chapter I deals
with three celebrated advances of Gauss and Dirichlet in classical number theory
that one might wish to generalize by means of algebraic number theory. The
detailed level of knowledge that one gains about those topics can be regarded as
a goal for the desired level of understanding about more complicated problems.
Chapter I thus establishes a framework for the whole book.
Associative algebras are the topic of Chapters II and III. The tools for studying
such algebras provide methods for classifying noncommutative division rings.
One such tool, known as the Brauer group, has a cohomological interpretation
that ties the subject to algebraic number theory.
Because of other work done in the 1950s, homology and cohomology can be
abstracted in such a way that the theory impacts several ﬁelds simultaneously,
including topology and complex analysis. The resulting subject is called homo-
logical algebra and is the topic of Chapter IV. Having cohomology available at this
point of the present book means that one is prepared to use it both in algebraic
number theory and in situations in algebraic geometry that have grown out of
complex analysis.
The last six chapters are about algebraic number theory, algebraic geometry,
and the relationship between them.
Chapters V–VI concern the three main
foundational theorems in algebraic number theory.
Chapter V goes at these
results in a direct fashion but falls short of giving a complete proof in one case.
Chapter VI goes at matters more indirectly. It explores the parallel between
number theory and the theory of algebraic curves, makes use of tools from analysis
concerning compactness and completeness, succeeds in giving full proofs of the
three theorems of Chapter V, and introduces the modern approach via adeles and
ideles to deeper questions in these subject areas.
Chapters VII–X are about algebraic geometry.
Chapter VII ﬁlls in some
prerequisites from the theories of ﬁelds and commutative rings that are needed to
set up the foundations of algebraic geometry. Chapters VIII–X concern algebraic
geometry itself.
They come at the subject successively from three points of
view—from the algebraic point of view of simultaneous systems of polynomial
equations in several variables, from the number-theoretic point of view suggested
by the classical theory of Riemann surfaces, and from the geometric point of view.
The topics most likely to be included in normal course work include the
Wedderburn theory of semisimple algebras in Chapter II, homological algebra
in Chapter IV, and some of the advanced material on ﬁelds in Chapter VII. A
chart on page xvi tells the dependence of chapters on earlier chapters, and, as
mentioned above, the section Guide for the Reader tells what knowledge of Basic
Algebra is assumed for each chapter.
The problems at the ends of chapters are intended to play a more important

xiv
Preface
role than is normal for problems in a mathematics book. Almost all problems are
solved in the section of hints at the end of the book. This being so, some blocks of
problems form additional topics that could have been included in the text but were
not; these blocks may be regarded as optional topics, or they may be treated as
challenges for the reader. The optional topics of this kind usually either carry out
further development of the theory or introduce signiﬁcant applications to other
branches of mathematics. For example a number of applications to topology are
treated in this way.
Not all problems are of this kind, of course.
Some of the problems are
really pure or applied theorems, some are examples showing the degree to which
hypotheses can be stretched, and a few are just exercises. The reader gets no
indication which problems are of which type, nor of which ones are relatively
easy. Each problem can be solved with tools developed up to that point in the
book, plus any additional prerequisites that are noted.
The theorems, propositions, lemmas, and corollaries within each chapter are
indexed by a single number stream. Figures have their own number stream, and
one can ﬁnd the page reference for each ﬁgure from the table on page xv. Labels
on displayed lines occur only within proofs and examples, and they are local to the
particular proof or example in progress. Each occurrence of the word “PROOF”
or “PROOF” is matched by an occurrence at the right margin of the symbol □to
mark the end of that proof.
I am grateful to Ann Kostant and Steven Krantz for encouraging this project
and for making many suggestions about pursuing it, and I am indebted to David
Kramer, who did the copyediting. The typesetting was by AMS-TEX, and the
ﬁgures were drawn with Mathematica.
I invite corrections and other comments from readers. I plan to maintain a list
of known corrections on my own Web page.
A. W. KNAPP
August 2007

LIST OF FIGURES
3.1.
A cochain map
154
4.1.
Snake diagram
185
4.2.
Enlarged snake diagram
185
4.3.
Deﬁning property of a projective
192
4.4.
Deﬁning property of an injective
195
4.5.
Formation of derived functors
205
4.6.
Universal mapping property of a kernel of a morphism
235
4.7.
Universal mapping property of a cokernel of a morphism
236
4.8.
The pullback of a pair of morphisms
243
6.1.
Commutativity of completion and extension as ﬁeld mappings
356
6.2.
Commutativity of completion and extension as homomorphisms
of valued ﬁelds
360
xv

DEPENDENCE AMONG CHAPTERS
Below is a chart of the main lines of dependence of chapters on prior chapters.
The dashed lines indicate helpful motivation but no logical dependence. Apart
from that, particular examples may make use of information from earlier chapters
that is not indicated by the chart.
I
II.1–II.3
III.5
VII.1
II.4
to
II.10
VII.2
to
VII.5
VIII.1
to
VIII.3
V.1–V.2
Lemma
7.21
III.1
to
III.4
V.3
IV
VII.6
VIII.7
to
VIII.10
VIII.4
to
VIII.6
V.4–V.6
VI.1–VI.2
III.6
Prop. 2.29
to
Prop. 2.33′
IX.1–IX.3
VI.3–VI.8
VI.9–VI.10
X
IX.4
to
IX.5
xvi

GUIDE FOR THE READER
This section is intended to help the reader ﬁnd out what parts of each chapter are
most important and how the chapters are interrelated. Further information of this
kind is contained in the abstracts that begin each of the chapters.
The book treats its subject material as pointing toward algebraic number
theory and algebraic geometry, with emphasis on aspects of these subjects that
impact ﬁelds of mathematics other than algebra. Two chapters treat the theory
of associative algebras, not necessarily commutative, and one chapter treats
homological algebra; both these topics play a role in algebraic number theory and
algebraic geometry, and homological algebra plays an important role in topology
and complex analysis. The constant theme is a relationship between number
theory and geometry, and this theme recurs throughout the book on different
levels.
The book assumes knowledge of most of the content of Basic Algebra, either
from that book itself or from some comparable source. Some of the less standard
results that are needed from Basic Algebra are summarized in the section Notation
and Terminology beginning on page xxi. The assumed knowledge of algebra
includes facility with using the Axiom of Choice, Zorn’s Lemma, and elementary
properties of cardinality. All chapters of the present book but the ﬁrst assume
knowledge of Chapters I–IV of Basic Algebra other than the Sylow Theorems,
facts from Chapter V about determinants and characteristic polynomials and
minimal polynomials, simple properties of multilinear forms from Chapter VI,
thedeﬁnitionsandelementarypropertiesofidealsandmodulesfromChapterVIII,
the Chinese Remainder Theorem and the theory of unique factorization domains
from Chapter VIII, and the theory of algebraic ﬁeld extensions and separability
and Galois groups from Chapter IX. Additional knowledge of parts of Basic
Algebra that is needed for particular chapters is discussed below. In addition,
some sections of the book, as indicated below, make use of some real or complex
analysis. The real analysis in question generally consists in the use of inﬁnite
series, uniform convergence, differential calculus in several variables, and some
point-set topology. The complex analysis generally consists in the fundamentals
of the one-variable theory of analytic functions, including the Cauchy Integral
Formula, expansions in convergent power series, and analytic continuation.
The remainder of this section is an overview of individual chapters and groups
of chapters.
xvii

xviii
Guide for the Reader
Chapter I concerns three results of Gauss and Dirichlet that marked a transition
from the classical number theory of Fermat, Euler, and Lagrange to the algebraic
numbertheoryofKummer, Dedekind, Kronecker, Hermite, andEisenstein. These
results are Gauss’s Law of Quadratic Reciprocity, the theory of binary quadratic
forms begun by Gauss and continued by Dirichlet, and Dirichlet’s Theorem on
primes in arithmetic progressions. Quadratic reciprocity was a necessary prelimi-
nary for the theory of binary quadratic forms. When viewed as giving information
about a certain class of Diophantine equations, the theory of binary quadratic
forms gives a gauge of what to hope for more generally. The theory anticipates
the deﬁnition of abstract abelian groups, which occurred later historically, and
it anticipates the deﬁnition of the class number of an algebraic number ﬁeld, at
least in the quadratic case. Dirichlet obtained formulas for the class numbers
that arise from binary quadratic forms, and these formulas led to the method by
which he proved his theorem on primes in arithmetic progressions. Much of the
chapter uses only elementary results from Basic Algebra. However, Sections 6–7
use facts about quadratic number ﬁelds, including the multiplication of ideals
in their rings of integers, and Section 10 uses the Fourier inversion formula for
ﬁnite abelian groups, which is in Section VII.4 of Basic Algebra. Sections 8–10
make use of a certain amount of real and complex analysis concerning uniform
convergence and properties of analytic functions.
Chapters II–III introduce the theory of associative algebras over ﬁelds. Chap-
ter II includes the original theory of Wedderburn, including an ampliﬁcation by
E. Artin, while Chapter III introduces the Brauer group and connects the theory
with the cohomology of groups. The basic material on simple and semisimple
associative algebras is in Sections 1–3 of Chapter II, which assumes familiarity
with commutative Noetherian rings as in Chapter VIII of Basic Algebra, plus the
material in Chapter X on semisimple modules, chain conditions for modules, and
the Jordan–H¨older Theorem. Sections 4–6 contain the statement and proof of
Wedderburn’s Main Theorem, telling the structure of general ﬁnite-dimensional
associative algebras in characteristic 0. These sections include a relatively self-
contained segment from Proposition 2.29 through Proposition 2.33′ on the role
of separability in the structure of tensor products of algebras. This material is the
part of Sections 4–6 that is used in the remainder of the chapter to analyze ﬁnite-
dimensional associative division algebras over ﬁelds. Two easy consequences of
this analysis are Wedderburn’s Theorem that every ﬁnite division ring is com-
mutative and Frobenius’s Theorem that the only ﬁnite-dimensional associative
division algebras over R are R, C, and the algebra H of quaternions, up to R
isomorphism.
Chapter III introduces the Brauer group to parametrize the isomorphism classes
of ﬁnite-dimensional associative division algebras whose center is a given ﬁeld.
Sections 2–3 exhibit an isomorphism of a relative Brauer group with what turns

Guide for the Reader
xix
out to be a cohomology group in degree 2. This development runs parallel to
the theory of factor sets for groups as in Chapter VII of Basic Algebra, and
some familiarity with that theory can be helpful as motivation. The case that the
relative Brauer group is cyclic is of special importance, and the theory is used in
the problems to construct examples of division rings that would not have been
otherwise available. The chapter makes use of material from Chapter X of Basic
Algebra on the tensor product of algebras and on complexes and exact sequences.
Chapter IV is about homological algebra, with emphasis on connecting homo-
morphisms, long exact sequences, and derived functors. All but the last section is
done in the context of “good” categories of unital left R modules, R being a ring
with identity, where it is possible to work with individual elements in each object.
The reader is expected to be familiar with some example for motivation; this can
be knowledge of cohomology of groups at the level of Section III.5, or it can be
some experience from topology or from the cohomology of Lie algebras as treated
in other books. Knowledge of complexes and exact sequences from Chapter X
of Basic Algebra is prerequisite. Homological algebra properly belongs in this
book because it is fundamental in topology and complex analysis; in algebra
its role becomes signiﬁcant just beyond the level of the current book. Important
applications are not limited in practice to “good” categories; “sheaf” cohomology
is an example with signiﬁcant applications that does not ﬁt this mold. Section 8
sketches the theory of homological algebra in the context of “abelian” categories.
In this case one does not have individual elements at hand, but some substitute is
still possible; sheaf cohomology can be treated in this context.
Chapters V and VI are an introduction to algebraic number theory. The theory
of Dedekind domains from Chapters VIII and IX of Basic Algebra is taken as
known, along with knowledge of the ingredients of the theory—Noetherian rings,
integral closure, and localization. Both chapters deal with three theorems—the
Dedekind Discriminant Theorem, the Dirichlet Unit Theorem, and the ﬁniteness
of the class number. Chapter V attacks these directly, using no additional tools,
and it comes up a little short in the case of the Dedekind Discriminant Theorem.
Chapter VI introduces tools to get around the weakness of the development in
Chapter V. These tools are valuations, completions, and decompositions of tensor
products of ﬁelds with complete ﬁelds. Chapter VI makes extensive use of metric
spaces and completeness, and compactness plays an important role in Sections
9–10. As noted in remarks with Proposition 6.7, Section VI.2 takes for granted
that Theorem 8.54 of Basic Algebra about extensions of Dedekind domains does
not need separability as a hypothesis; the actual proof of the improved theorem
without a hypothesis of separability is deferred to Section VII.3.
Chapter VII supplies additional background needed for algebraic geometry,
partly from ﬁeld theory and partly from the theory of commutative rings. Knowl-
edge of Noetherian rings is needed throughout the chapter. Sections 4–5 assume

xx
Guide for the Reader
knowledge of localizations, and the indispensable Corollary 7.14 in Section 3
concerns Dedekind domains. The most important result is the Nullstellensatz
in Section 1. Transcendence degree and Krull dimension in Sections 2 and 4
are tied to the notion of dimension in algebraic geometry. Zariski’s Theorem
in Section 5 is tied to the notion of singularities; part of its proof is deferred to
Chapter X. The material on inﬁnite Galois groups in Section 6 has applications
to algebraic number theory and algebraic geometry but is not used in this book
after Chapter VII.
Chapters VIII–X introduce algebraic geometry from three points of view.
Chapter VIII approaches it as an attempt to understand solutions of simulta-
neous polynomial equations in several variables using module-theoretic tools.
Chapter IX approaches the subject of curves as an outgrowth of the complex-
analysis theory of compact Riemann surfaces and uses number-theoretic methods.
Chapter X approaches its subject matter geometrically, using the ﬁeld-theoretic
and ring-theoretic tools developed in Chapter VII. All three chapters assume
knowledge of Section VII.1 on the Nullstellensatz.
Chapter VIII is in three parts. Sections 1–4 are relatively elementary and
concern the resultant and preliminary forms of Bezout’s Theorem.
Sections
5–6 concern intersection multiplicity for curves and make extensive use of lo-
calizations; the goal is a better form of Bezout’s Theorem.
Sections 7–10
are independent of Sections 5–6 and introduce the theory of Gr¨obner bases.
This subject was developed comparatively recently and lies behind many of the
symbolic manipulations of polynomials that are possible with computers.
Chapter IX concerns irreducible curves and is in two parts. Sections 1–3 deﬁne
divisors and the genus of such a curve, while Sections 4–5 prove the Riemann–
Roch Theorem and give applications of it. The tool for the development is discrete
valuations as in Section VI.2, and the parallel between the theory in Chapter VI
for algebraic number ﬁelds and the theory in Chapter IX for curves becomes more
evident than ever. Some complex analysis is needed to understand the motivation
in Sections 1 and 4.
Chapter X largely concerns algebraic sets deﬁned as zero loci over an alge-
braically closed ﬁeld. The irreducible such sets are called varieties. Sections 1–3
are concerned with algebraic sets and their dimension, Sections 4–6 treat maps
between varieties, and Sections 7–8 deal with ﬁner questions. Sections 9–12
are independent of Sections 6–8 and do two things simultaneously: they tie the
theoretical work on dimension to the theory of Gr¨obner bases in Chapter VIII,
making dimension computable, and they show how the dimension of a zero locus
is affected by adding one equation to the deﬁning system. The chapter concludes
with an introductory section about schemes, in which the underlying algebraically
closed ﬁeld is replaced by a commutative ring with identity. The entire chapter
assumes knowledge of elementary point-set topology.

NOTATION AND TERMINOLOGY
This section contains some items of notation and terminology from Basic Algebra
that are not necessarily reviewed when they occur in the present book. A few
results are mentioned as well. The items are grouped by topic.
Set theory
∈
membership symbol
#S or |S|
number of elements in S
∅
empty set
{x ∈E | P}
the set of x in E such that P holds
Ec
complement of the set E
E ∪F, E ∩F, E −F
union, intersection, difference of sets

α Eα, 
α Eα
union, intersection of the sets Eα
E ⊆F, E ⊇F
containment
E ⫋F, E ⫌F
proper containment
(a1, . . . , an)
ordered n-tuple
{a1, . . . , an}
unordered n-tuple
f : E →F, x 	→f (x)
function, effect of function
f ◦g or f g, f

E
composition of f following g, restriction to E
f ( · , y)
the function x 	→f (x, y)
f (E), f −1(E)
direct and inverse image of a set
in one-one correspondence
matched by a one-one onto function
countable
ﬁnite or in one-one correspondence with integers
2A
set of all subsets of A
Number systems
δi j
Kronecker delta: 1 if i = j, 0 if i ̸= j
n
k

binomial coefﬁcient
n positive, n negative
n > 0, n < 0
Z, Q, R, C
integers, rationals, reals, complex numbers
max, min
maximum/minimum of ﬁnite subset of reals
[x]
greatest integer ≤x if x is real
Re z, Im z
real and imaginary parts of complex z
¯z
complex conjugate of z
|z|
absolute value of z
xxi

xxii
Notation and Terminology
Linear algebra and elementary number theory
Fn
space of n-dimensional column vectors
ej
jth standard basis vector of Fn
V ′
dual vector space of vector space V
dimF V or dim V
dimension of vector space V over ﬁeld F
0
zero vector, matrix, or linear mapping
1 or I
identity matrix or linear mapping
At
transpose of A
det A
determinant of A
[Mi j]
matrix with (i, j)th entry Mi j
 L
 

matrix of L relative to domain ordered basis 
and range ordered basis 
x · y
dot product
∼=
is isomorphic to, is equivalent to
Fp
integers modulo a prime p, as a ﬁeld
GCD
greatest common divisor
≡
is congruent to
ϕ
Euler’s ϕ function
Groups, rings, modules, and categories
0
additive identity in an abelian group
1
multiplicative identity in a group or ring
∼=
is isomorphic to, is equivalent to
Cm
cyclic group of order m
unit
invertible element in ring R with identity
R×
group of units in ring R with identity
Rn
space of column vectors with entries in ring R
Ro
opposite ring to R with a ◦b = ba
Mmn(R)
m-by-n matrices with entries in R
Mn(R)
n-by-n matrices with entries in R
unital left R module
left R module M with 1m = m for all m ∈M
HomR(M, N)
group of R homomorphisms from M into N
EndR(M)
ring of R homomorphisms from M into M
ker ϕ, image ϕ
kernel and image of ϕ
H n(G, N)
nth cohomology of group G with coefﬁcients
in abelian group N
simple left R module
nonzero unital left R module with no proper
nonzero R submodules
semisimple left R module
sum (= direct sum) of simple left R modules
Obj(C )
class of objects for category C
MorphC(A, B)
set of morphisms from object A to object B

Notation and Terminology
xxiii
Groups, rings, modules, and categories, continued
1A
identity morphism on A
C S
category of S-tuples of objects from Obj(C)
product of {Xs}s∈S
(X, {ps}s∈S) such that if A in Obj(C ) and
{ϕs ∈MorphC(A, Xs)} are given, then there
exists a unique ϕ ∈MorphC(A, X) with
psϕ = ϕs for all s
coproduct of {Xs}s∈S
(X, {is}s∈S) such that if A in Obj(C ) and
{ϕs ∈MorphC(Xs, A)} are given, then there
exists a unique ϕ ∈MorphC(X, A) with
ϕis = ϕs for all s
C opp
category opposite to C
Commutative rings R with identity and factorization of elements
identity
denoted by 1, allowed to equal 0
ideal I = (r1, . . . ,rn)
ideal generated by r1, . . . ,rn
prime ideal I
proper ideal with ab ∈I implying a ∈I or b ∈I
integral domain
R with no zero divisors and with 1 ̸= 0
R/I with I prime
always an integral domain
GL(n, R)
group of invertible n-by-n matrices, entries in R
Chinese Remainder Theorem I1, . . . , In given ideals with Ii +Ij = R for i ̸= j.
Then the natural map ϕ : R →n
j=1 R/Ij yields
isomorphism R
 n
j=1 Ij ∼= R/I1 × · · · × R/In
of rings. Also n
j=1 Ij = I1 · · · In.
Nakayama’s Lemma
If I is an ideal contained in all maximal ideals
and M is a ﬁnitely generated unital R module
with I M = M, then M = 0.
algebra A over R
unital R module with an R bilinear multiplication
A × A →A. In this book nonassociative
algebras appear only in Chapter II, and each
associative algebra has an identity.
RG
group algebra over R for group G
R[X1, . . . , Xn]
polynomial algebra over R with n indeterminates
R[x1, . . . , xn]
R algebra generated by x1, . . . , xn
irreducible element r ̸= 0
r /∈R× such that r =ab implies a ∈R× or b∈R×
prime element r ̸= 0
r /∈R× such that whenever r divides ab, then
r divides a or r divides b
irreducible vs. prime
prime implies irreducible; in any unique
factorization domain, irreducible implies prime
GCD
greatest common divisor in unique factorization
domain

xxiv
Notation and Terminology
Fields
Fq
a ﬁnite ﬁeld with q = pn elements, p prime
K/F
an extension ﬁeld K of a ﬁeld F
[K : F]
degree of extension K/F, i.e., dimF K
K(X1, . . . , Xn)
ﬁeld of fractions of K[X1, . . . , Xn]
K(x1, . . . , xn)
ﬁeld generated by K and x1, . . . , xn
number ﬁeld
ﬁnite-dimensional ﬁeld extension of Q
Gal(K/F)
Galois group, automorphisms of K ﬁxing F
NK/F( · ) and TrK/F( · )
norm and trace functions from K to F
Tools for algebraic number theory and algebraic geometry
Noetherian R
commutative ring with identity whose ideals
satisfy the ascending chain condition; has the
property that any R submodule of a ﬁnitely
generated unital R module is ﬁnitely generated.
Hilbert Basis Theorem
R nonzero Noetherian implies R[X] Noetherian
Integral closure
Situation: R = integral domain, F = ﬁeld of fractions, K/F = extension ﬁeld.
x ∈K integral over R
x is a root of a monic polynomial in R[X]
integral closure of R in K
set of x ∈K integral over R, is a ring
R integrally closed
R equals its integral closure in F
Localization
Situation: R = commutative ring with identity, S = multiplicative system in R.
S−1R
localization, pairs (r, s) with r ∈R and s ∈S,
modulo (r, s) ∼(r′, s′) if t(rs′ −sr′) = 0
for some t ∈S
property of S−1R
I 	→S−1I is one-one from set of ideals I in R
of form I = R ∩J onto set of ideals in S−1R
local ring
commutative ring with identity having a unique
maximal ideal
RP for prime ideal P
localization with S = complement of P in R
Dedekind domain
Noetherian integrally closed integral domain in
which every nonzero prime ideal is maximal, has
unique factorization of nonzero ideals as product
of prime ideals
Dedekind domain extension
R Dedekind, F ﬁeld of fractions, K/F ﬁnite
separable extension, T integral closure of R in K.
Then T is Dedekind, and any nonzero prime ideal
℘in R has ℘R = g
i=1 Pei
i
for distinct prime
ideals Pi with Pi ∩R = ℘. These have 	g
i=1 ei fi
= [K : F], where fi = [T/Pi : R/℘].

CHAPTER I
Transition to Modern Number Theory
Abstract.
This chapter establishes Gauss’s Law of Quadratic Reciprocity, the theory of binary
quadratic forms, and Dirichlet’s Theorem on primes in arithmetic progressions.
Section 1 outlines how the three topics of the chapter occurred in natural sequence and marked
a transition as the subject of number theory developed a coherence and moved toward the kind of
algebraic number theory that is studied today.
Section 2 establishes quadratic reciprocity, which is a reduction formula providing a rapid method
for deciding solvability of congruences x2 ≡m mod p for the unknown x when p is prime.
Sections 3–5 develop the theory of binary quadratic forms ax2 + bxy + cy2, where a, b, c are
integers. The basic tool is that of proper equivalence of two such forms, which occurs when the two
forms are related by an invertible linear substitution with integer coefﬁcients and determinant 1. The
theorems establish the ﬁniteness of the number of proper equivalence classes for given discriminant,
conditions for the representability of primes by forms of a given discriminant, canonical representa-
tives of the ﬁnitely many proper equivalence classes of a given discriminant, a group law for proper
equivalence classes of forms of the same discriminant that respects representability of integers by
the classes, and a theory of genera that takes into account inequivalent forms whose values cannot
be distinguished by linear congruences.
Sections6–7digresstoleapforwardhistoricallyandinterpretthegrouplawforproperequivalence
classes of binary quadratic forms in terms of an equivalence relation on the nonzero ideals in the
ring of integers of an associated quadratic number ﬁeld.
Sections 8–10 concern Dirichlet’s Theorem on primes in arithmetic progressions. Section 8
discusses Euler’s product formula for ∞
n=1 n−s and shows how Euler was able to modify it to
prove that there are inﬁnitely many primes 4k + 1 and inﬁnitely many primes 4k + 3. Section 9
develops Dirichlet series as a tool to be used in the generalization, and Section 10 contains the proof
of Dirichlet’s Theorem. Section 8 uses some elementary real analysis, and Sections 9–10 use both
elementary real analysis and elementary complex analysis.
1. Historical Background
The period 1800 to 1840 saw great advances in number theory as the subject
developed a coherence and moved toward the kind of algebraic number theory that
is studied today. The groundwork had been laid chieﬂy by Euclid, Diophantus,
Fermat, Euler, Lagrange, and Legendre. Some of what those people did was
remarkably insightful for its time, but what collectively had come out of their
labors was more a collection of miscellaneous results than an organized theory.
It was Gauss who ﬁrst gave direction and depth to the subject, beginning with
1

2
I. Transition to Modern Number Theory
his book Disquisitiones Arithmeticae in 1801. Dirichlet built on Gauss’s work,
clarifying the deeper parts and adding analytic techniques that pointed toward
the integrated subject of the future. This chapter concentrates on three jewels of
classical number theory—largely the work of Gauss and Dirichlet—that seem on
the surface to be only peripherally related but are actually a natural succession
of developments leading from earlier results toward modern algebraic number
theory. To understand the context, it is necessary to back up for a moment.
Diophantine equations in two or more variables have always lain at the heart of
number theory. Fundamental examples that have played an important role in the
development of the subject areax2+bxy+cy2 = m for unknown integers x and y;
x2
1 +x2
2 + x2
3 + x2
4 = m for unknown integers x1, x2, x3, x4; y2 = x(x −1)(x +1)
for unknown integers x and y; and xn + yn = zn for unknown integers x, y, z.
In every case one can get an immediate necessary condition on a solution by
writing the equation modulo some integer n. The necessary condition is that
the corresponding congruence modulo n have a solution. For example take the
equation x2 + y2 = p, where p is a prime, and let us allow ourselves to use
the more elementary results of Basic Algebra. Writing the equation modulo
p leads to x2 + y2 ≡0 mod p. Certainly x cannot be divisible by p, since
otherwise y would be divisible by p, x2 and y2 would be divisible by p2, and
x2 + y2 = p would be divisible by p2, contradiction. Thus we can divide,
obtaining 1 + (yx−1)2 ≡0 mod p. Hence z2 ≡−1 mod p for z ≡xy−1. If p
is an odd prime, then −1 has order 2, and the necessary condition is that there
exist some z in F×
p whose order is exactly 4. Since F×
p is cyclic of order p −1,
the necessary condition is that 4 divide p −1.
Using a slightly more complicated argument, we can establish conversely that
the divisibility of p −1 by 4 implies that x2 + y2 = p is solvable for integers
x and y. In fact, we know from the solvability of z2 ≡−1 mod p that there
exists an integer r such that p divides r2 + 1. Consider the possibilities in the
integral domain Z[i] of Gaussian integers, where i = √−1. It was shown in
Chapter VIII of Basic Algebra that Z[i] is Euclidean. Hence Z[i] is a principal
ideal domain, and its elements have unique factorization. If p remains prime in
Z[i], then the fact that p divides (r + i)(r −i) implies that p divides r + i or
r −i in Z[i]. Then at least one of r
p + i 1
p and r
p −i 1
p would have to be in Z[i].
Since i 1
p is not in Z[i], this divisibility does not hold, and we conclude that p
does not remain prime in Z[i]. If we write p = (a + bi)(c + di) nontrivially,
then p2 = |a + bi|2|c + di|2 = (a2 + b2)(c2 + d2) as an equality in Z, and we
readily conclude that a2 + b2 = p.
This much argument solves the Diophantine equation x2+y2 = p for p prime.
For p replaced by a general integer m, we use the identity
(x2
1 + y2
1)(x2
2 + y2
2) = (x1x2 −y1y2)2 + (x1y2 + x2y1)2,

1. Historical Background
3
which has been known since antiquity, and we see that x2 + y2 = m is solvable
if m is a product of odd primes of the form 4k + 1. It is solvable also if m = 2
and if m = p2 for any prime p. Thus x2 + y2 = m is solvable whenever m is a
positive integer such that each prime of the form 4k + 3 dividing m divides m an
even number of times. Using congruences modulo prime powers, we see that this
condition is also necessary, and we arrive at the following result; historically it
had already been asserted as a theorem by Fermat and was subsequently proved
by Euler, albeit by more classical methods than we have used.
Proposition 1.1. The Diophantine equation x2+y2 = m is solvable in integers
x and y for a given positive integer m if and only if every prime number p = 4k+3
dividing m occurs an even number of times in the prime factorization of m.
The ﬁrst step in the above argument used congruence information; we had
to know the primes p for which z2 ≡−1 mod p is solvable. The second step
was in two parts—both rather special. First we used speciﬁc information about
the nature of factorization in a particular ring of algebraic integers, namely Z[i].
Second we used that the norm of a product is the product of the norms in that
same ring of algebraic integers.
It is too much to hope that some recognizable generalization of these steps with
x2 + y2 = m can handle all or most Diophantine equations. At least the ﬁrst step
is available in complete generality, and indeed number theory—both classical and
modern—deduces many helpful conclusions by passing to congruences. There
is the matter of deducing something useful from a given congruence, but doing
so is a ﬁnite problem for each prime. Like some others before him, Gauss set
about studying congruences systematically. Linear congruences are easy and had
been handled before. Quadratic congruences are logically the next step. The
ﬁrst jewel of classical number theory to be discussed in this chapter is the Law
of Quadratic Reciprocity of Gauss, which appears below as Theorem 1.2 and
which makes useful deductions possible in the case of quadratic congruences. In
effect quadratic reciprocity allows one to decide easily which integers are squares
modulo a prime p. Euler had earlier come close to ﬁnding the statement of this
result, and Legendre had found the exact statement without ﬁnding a complete
proof. Gauss was the one who gave the ﬁrst complete proof.
Part of the utility of quadratic reciprocity is that it helps one to attack quadratic
Diophantineequationsmoresystematically. Thesecondjewelofclassicalnumber
theory to be discussed in this chapter is the body of results concerning representing
integers by binary quadratic forms ax2+bxy+cy2 = m that do not degenerate in
some way. Lagrange and Legendre had already made advances in this theory, but
Gauss’s own discoveries were decisive. Dirichlet simpliﬁed the more advanced
parts of the theory and investigated an aspect of it that Gauss had not addressed

4
I. Transition to Modern Number Theory
and that would lead Dirichlet to his celebrated theorem on primes in arithmetic
progressions.1
Lagrange had introduced the notion of the discriminant of a quadratic form
and a notion of equivalence of such forms—two forms of the same discriminant
being equivalent if one can be obtained from the other by a linear invertible
substitution with integer entries. Equivalence is important because equivalent
forms represent the same numbers. He established also a theory of reduced forms
that speciﬁes representatives of each equivalence class. For an odd prime p,
ax2 + bxy + cy2 = p is solvable only if the discriminant b2 −4ac is a square
modulo p, and Lagrange was hampered by not knowing quadratic reciprocity.
But he did know some special cases, such as when 5 is a square modulo p, and he
was able to deal completely with discriminant −20. For this discriminant, there
are two equivalence classes, represented by x2 + 5y2 and 2x2 + 2xy + 3y2, and
Lagrange showed for primes p other than 2 and 5 that
x2 + 5y2 = p
is solvable if and only if
p ≡1 or 9 mod 20,
2x2 + 2xy + 3y2 = p
is solvable if and only if
p ≡3 or 7 mod 20;
the fact about x2 + 5y2 = p had been conjectured earlier by Euler. Lagrange
observed further that
(2x2
1 + 2x1y1 + 3y2
1)(2x2
2 + 2x2y2 + 3y2
2)
= (2x1x2 + x1y2 + y1x2 + 3y1y2)2 + 5(x1x2 −y1y2)2,
from which it follows that the product of two primes congruent to 3 or 7 modulo
20 is representable as x2 + 5y2; this fact had been conjectured by Fermat.
Legendre added to this investigation the correct formula for quadratic reci-
procity, which he incorrectly believed he had proved, and many of its conse-
quences for representability of primes by binary quadratic forms. In addition,
he tried to develop a theory of composition of forms that generalizes Lagrange’s
identity above, but he had only limited success.
In addition to establishing quadratic reciprocity, Gauss introduced the vital no-
tionof “properequivalence” forformsax2+bxy+cy2 ofthesamediscriminant—
two forms of the same discriminant being properly equivalent if one can be
obtained from the other by a linear invertible substitution with integer entries
and determinant +1. In terms of this deﬁnition, he settled the representability
of primes by binary quadratic forms, he showed that there are only ﬁnitely many
proper equivalences classes for each discriminant, and he gave an algorithm for
1These matters are afﬁrmed in Dirichlet’s Lectures on Number Theory. The aspect that Gauss
had not addressed and that provided motivation for Dirichlet is the value of the “Dirichlet class
number” h(D) deﬁned below.

1. Historical Background
5
deciding whether two forms are properly equivalent. The main results of Gauss in
this direction appear as Theorems 1.6 and 1.8 below. In addition, Gauss showed,
without the beneﬁt of having a deﬁnition of “group,” in effect that the set of
proper equivalence classes of forms with a given discriminant becomes a ﬁnite
abelian group in a way that controls representability of nonprime integers; by
contrast, Lagrange’s deﬁnition of equivalence does not lead to a group structure.
Gauss’s main results in this direction, as recast by Dirichlet, appear as Theorem
1.12 below.
The story does not stop here, but let us pause for a moment to say what La-
grange’stheory, asamended by Gauss, saysfor the above example, ﬁrst rephrasing
the context in more modern terminology. We saw earlier that unique factorization
in the ring Z[i] of Gaussian integers is the key to the representation of integers
by the quadratic form x2 + y2. For a general quadratic form ax2 + bxy + cy2
with discriminant D = b2 −4ac, properties of the ring R of algebraic integers in
the ﬁeld Q(
√
D ) are relevant for the questions that Gauss investigated. It turns
out that R is a principal ideal domain if Gauss’s ﬁnite abelian group of proper
equivalence classes is trivial and that when D is “fundamental,” there is a suitable
converse.2
With the context rephrased we come back to the example.
Consider the
equation x2+5y2 = p for primes p. The discriminant of x2+5y2 is −20, and the
relevant ring of algebraic integers is Z[√−5 ], which is not a unique factorization
domain. Thus the argument used with x2 + y2 = p does not apply, and we
have no reason to expect that solvability of x2 + 5y2 ≡0 mod p is sufﬁcient for
solvability of x2 +5y2 = p. Let us look more closely. The congruence condition
is that −20 is a square modulo p. Thus −5 is to be a square modulo p. If we
leave aside the primes p = 2 and p = 5 that divide 20, the Law of Quadratic
Reciprocity will tell us that the necessary congruence resulting from solvability
of x2 + 5y2 = p is that p be congruent to 1, 3, 7, or 9 modulo 20. However, we
can compute all residues n of x2 + 5y2 modulo 20 for n with GCD(n, 20) = 1 to
see that
x2 + 5y2 ≡1 or 9 mod 20
if GCD(x2 + 5y2, 20) = 1.
Meanwhile, the form 2x2 + 2xy + 3y2 has discriminant −20, and we can check
that solvability of 2x2 + 2xy + 3y2 = p leads to the conclusion that
2x2 + 2xy + 3y2 ≡3 or 7 mod 20
if GCD(2x2 + 2xy + 3y2, 20) = 1.
Lagrange’s theory easily shows that representability of integers by a form depends
only on the equivalence class of the form and that all primes congruent to 1, 3,
2In each of the situations (a) and (b) of Proposition 1.17 below, R is a principal ideal domain
only if Gauss’s group is trivial. In all other cases, Gauss’s group is nontrivial, and R is a principal
ideal domain only if the group has order 2.

6
I. Transition to Modern Number Theory
7, or 9 modulo 20 are representable by some form. This example is special
in that equivalence and proper equivalence come to the same thing. Gauss’s
multiplication rule for proper equivalence classes of forms with discriminant
−20 produces a group of order 2, with x2 + 5y2 representing the identity class
and 2x2 + 2xy + 3y2 representing the other class. Consequently
p ≡1 or 9 mod 20
implies
x2 + 5y2 = p
solvable,
p ≡3 or 7 mod 20
implies
2x2 + 2xy + 3y2 = p
solvable.
In addition, the multiplication rule has the property that if m is representable by
all forms in the class of a1x2 + b1xy + c1y2 and n is representable by all forms
in the class of a2x2 + b2xy + c2y2, then mn is representable by all forms in the
class of the product form. It is not necessary to have an explicit identity for the
multiplication. Thus, for example, it follows without further argument that if p
and q are primes congruent to 3 or 7 modulo 20, then x2 + 5y2 = pq is solvable.
Let us elaborate a little about the rephrased context for Gauss’s theory. We let
D be the discriminant of the binary quadratic forms in question, and we assume
that D is “fundamental.” Let R be the ring of algebraic integers that lie in the
ﬁeld Q(
√
D ). It turns out to be possible to deﬁne a notion of “strict equivalence”
on the set of ideals of R in such a way that multiplication of ideals descends to a
multiplicationofstrictequivalenceclasses. Thestrictequivalenceclassesofideals
then form a group, and this group is isomorphic to Gauss’s group. In particular,
one obtains the nonobvious conclusion that the set of strict equivalence classes
of ideals is ﬁnite. The main result giving this isomorphism is Theorem 1.20.
This rephrasing of the theory points to a generalization to algebraic number ﬁelds
of degree higher than 2 and is a starting point for modern algebraic number theory.
Now we return to the work of Gauss. Even the example with D = −20 that was
described above does not give an idea of how complicated matters can become.
For discriminant −56, for example, the two forms x2+14y2 and 2x2+7y2 take on
the same residues modulo 56 that are prime to 56, but no prime can be represented
by both forms. These two forms and the forms 3x2 ± 2xy + 5y2 represent the
four proper equivalence classes. By contrast, there are only three equivalence
classes in Lagrange’s sense, and we thus get some insight into why Legendre
encountered difﬁculties in deﬁning a useful multiplication even for D = −56.
Gauss’s theory goes on to address the problem that x2 +14y2 and 2x2 +7y2 take
on one set of residues modulo 56 and prime to 56 while 3x2 ± 2xy + 5y2 take
on a disjoint set of such residues. Gauss deﬁned a “genus” (plural: “genera”)
to consist of proper equivalence classes like these that cannot be distinguished
by linear congruences, and he obtained some results about this notion. Gauss’s
set of genera inherits a group structure from the group structure on the proper
equivalence classes of forms, and the group structure for the genera enables one
to work with genera easily.

1. Historical Background
7
The third jewel of classical number theory to be discussed in this chapter is
Dirichlet’s celebrated theorem on primes in arithmetic progressions, given below
as Theorem 1.21. The statement is that if m and b are positive relatively prime
integers, then there are inﬁnitely many primes of the form km+b with k a positive
integer. The proof mixes algebra, a little real analysis, and some complex analysis.
What is not immediately apparent is how this theorem ﬁts into a natural
historical sequence with Gauss’s theory of binary quadratic forms. In fact, the
statement about primes in arithmetic progressions was thrust upon Dirichlet in at
least two ways. Dirichlet thoroughly studied the work of those who came before
him. One aspect of that work was Legendre’s progress toward obtaining quadratic
reciprocity; in fact, Legendre actually had a proof of quadratic reciprocity except
that he assumed the unproved result about primes in arithmetic progressions for
part of it and argued in circular fashion for another part of it. Another aspect
of the work Dirichlet studied was Gauss’s theory of multiplication of proper
equivalence classes of forms, which Dirichlet saw a need to simplify and explain;
indeed, a complete answer to the representability of composite numbers requires
establishing theorems about genera beyond what Gauss obtained and has to make
use of the theorem about primes in arithmetic progressions.
In addition, Dirichlet asked and settled a question about proper equivalence
classes for which Gauss had published nothing and for which Jacobi had conjec-
tured an answer: How many such classes are there for each discriminant D? Let
us call this number the “Dirichlet class number,” denoting it by h(D). Dirichlet’s
answer has several cases to it. When D is fundamental, even, negative, and not
equal to −4, the answer is
h(D) = 2√|D/4|
π

n≥1,
GCD(n,D)=1
D/4
n
 1
n ,
with the sum taken over positive integers prime to D. Here when p is a prime
not dividing D,
D/4
p

is +1 if D/4 is a square modulo p and is −1 if not. For
general n =  pk prime to D,
D/4
n

is the product of the expressions
D/4
p
k
corresponding to the factorization3 of n. When D = −4, the quantity on the right
side has to be doubled to give the correct result, and thus the formula becomes
h(−4) = 4
π

n odd ≥1
−1
n
1
n = 4
π

n odd ≥1
(−1)(n−1)/2
n
.
The adjusted formula correctly gives h(−4) = −1, since Leibniz had shown
more than a century earlier that 1 −1
3 + 1
5 −1
7 + · · · = π
4 . Dirichlet was able to
3The expression D/4
n
 is called a “Jacobi symbol.” See Problems 9–11 at the end of the chapter.

8
I. Transition to Modern Number Theory
evaluate the displayed inﬁnite series for general D as a ﬁnite sum, but that further
step does not concern us here. The important thing to observe is that the inﬁnite
series is always an instance of a series 	∞
n=1 χ(n)/n with χ a periodic function
on the positive integers satisfying χ(m + n) = χ(m)χ(n). Dirichlet’s derivation
of a series expansion for his class numbers required care because the series is only
conditionally convergent. To be able to work with absolutely convergent series,
he initially replaced 1
n by 1
ns for s > 1, thus initially treating series he denoted by
L(s, χ) = 	∞
n=1 χ(n)/ns.
As a consequence of this work, Dirichlet was familiar with series L(s, χ) and
was aware of the importance of expressions L(1, χ), knowing that at least when
χ(n) =
D
n

, L(1, χ) is not 0 because it is essentially a class number. This
nonvanishing turns out to be the core of the proof of the theorem on primes in
arithmetic progressions. Dirichlet would have known about Euler’s proof that
the progressions 4n + 1 and 4n + 3 contain inﬁnitely many primes, a proof
that we give in Section 8, and he would have recognized Euler’s expression
	∞
n=1 (−1)n/(2n + 1) as something that occurs in his formula for h(−4). Thus
he was well equipped with tools and motivation for a proof of his theorem on
primes in arithmetic progressions.
2. Quadratic Reciprocity
If p is an odd prime number and a is an integer with a ̸≡0 mod p, the Legendre
symbol
a
p

is deﬁned by
a
p

=
 +1
if a is a square modulo p,
−1
if a is not a square modulo p.
Since F×
p is a cyclic group of even order, the squares form a subgroup of index 2.
Therefore a 	→
a
p

is a group homomorphism of F×
p into {±1}, and we have
a
p
b
p

=
ab
p

whenever a and b are not divisible by p.
Theorem 1.2 (Law of Quadratic Reciprocity). If p and q are distinct odd
prime numbers, then
(a)
−1
p

= (−1)
1
2 (p−1),
(b)
2
p

= (−1)
1
8 (p2−1),
(c)
p
q
q
p

= (−1)[ 1
2 (p−1)][ 1
2 (q−1)].

2. Quadratic Reciprocity
9
REMARKS. Conclusion (a) is due to Fermat and says that −1 is a square modulo
p if and only if p = 4n + 1. We proved this result already in Section 1 and will
not re-prove it here. Conclusion (b) is due to Euler and says that 2 is a square
modulo p if and only if p = 8n ± 1. Conclusion (c) is due to Gauss and says
that if p or q is 4n + 1, then
p
q

=
q
p

and otherwise
p
q

= −
q
p

. The proofs of
(b) and (c) will occupy the remainder of this section.
EXAMPLES.
(1) This example illustrates how quickly iterated use of the theorem decides
whether a given integer is a square. We compute
17
79

. We have
17
79

=
79
17

=
11
17

=
17
11

=
 6
11

= −
 3
11

= +
11
3

=
2
3

= −1,
the successive equalities being justiﬁed by using (c), the formula
a+kp
p

=
a
p

,
(c) again,
a+kp
p

=
a
p

again, the formula
a
p
b
p

=
ab
p

and (b), (c) once more,
a+kp
p

=
a
p

once more, and an explicit evaluation of
2
3

.
(2) Lemma 9.46 of Basic Algebra asserts that 3 is a generator of the cyclic
group F×
n when n is prime of the form 22N + 1 with N > 0, and Theorem 1.2
enables us to give a proof. In fact, this n has n ≡2 mod 3 and n ≡1 mod 4.
Thus
3
n

=
n
3

=
2
3

= −1. Since F×
n is a cyclic group whose order is a power
of 2, every nonsquare is a generator. Thus 3 is a generator.
We prove two lemmas, give the proof of (b), prove a third lemma, and then
give the proof of (c).
Lemma 1.3. If p is an odd prime and a is any integer such that p does not
divide a, then a
1
2 (p−1) ≡
a
p

mod p.
PROOF. The multiplicative group F×
p being cyclic, let b be a generator. Write
a ≡br mod p forsomeintegerr. Since
a
p

= (−1)r anda
1
2 (p−1) ≡(br)
1
2 (p−1) =
(b
1
2 (p−1))r ≡(−1)r mod p, the lemma follows.
□
Lemma 1.4 (Gauss). Let p be an odd prime, and let a be any integer such that
p does not divide a. Among the least positive residues modulo p of the integers
a, 2a, 3a, . . . , 1
2(p −1)a, let n denote the number of residues that exceed p/2.
Then
a
p

= (−1)n.

10
I. Transition to Modern Number Theory
PROOF. Let r1, . . . ,rn be the least positive residues exceeding p/2, and let
s1, . . . , sk be those less than p/2, so that n + k =
1
2(p −1). The residues
r1, . . . ,rn, s1, . . . , sk are distinct, since no two of a, 2a, 3a, . . . , 1
2(p −1)a differ
by a multiple of p. Each integer p −ri is strictly between 0 and p/2, and we
cannot have any equality p −ri = sj, since ri +sj = p would mean that (u +v)a
is divisible by p for some integers u and v with 1 ≤u, v ≤1
2(p −1). Hence
p −r1, . . . , p −rn, s1, . . . , sk
is a permutation of 1, . . . , 1
2(p −1). Modulo p, we therefore have
1 · 2 · · · 1
2(p −1) ≡(−1)nr1 · · ·rns1 · · · sk
≡(−1)na · 2a · · · 1
2(p −1)a
≡(−1)na
1
2 (p−1)1 · 2 · · · 1
2(p −1),
and cancellation yields a
1
2 (p−1) ≡(−1)n mod p. The result follows by combin-
ing this congruence with the conclusion of Lemma 1.3.
□
PROOF OF (b) IN THEOREM 1.2. We shall apply Lemma 1.4 with a = 2 after
investigating the least positive residues of 2, 4, 6, . . . , p−1. We can list explicitly
those residues that exceed p/2 for each odd value of p mod 8 as follows:
p = 8k + 1,
4k + 2, 4k + 4, . . . , 8k,
p = 8k + 3,
4k + 2, 4k + 4, . . . , 8k + 2,
p = 8k + 5,
4k + 4, . . . , 8k + 2, 8k + 4,
p = 8k + 7,
4k + 4, . . . , 8k + 4, 8k + 6.
If n denotes the number of such residues for a given p, a count of each line of the
above table shows that
n = 2k
and
(−1)n = +1
for
p = 8k + 1,
n = 2k + 1
and
(−1)n = −1
for
p = 8k + 3,
n = 2k + 1
and
(−1)n = −1
for
p = 8k + 5,
n = 2k + 2
and
(−1)n = +1
for
p = 8k + 7.
Thus Lemma 1.4 shows that
2
p

= +1 for p = 8k ± 1 and
2
p

= −1 for
p = 8k ± 3. This completes the proof of (b).
□

2. Quadratic Reciprocity
11
Lemma 1.5. If p is an odd prime and a is a positive odd integer such that p
does not divide a, then
a
p

= (−1)t, where t =
1
2 (p−1)
	
u=1
[ua/p]. Here [ · ] denotes
the greatest-integer function.
REMARKS. When a = 2, the equality
a
p

= (−1)t fails for p = 3, since
t = [2/3] = 0.
PROOF. With notation as in Lemma 1.4 and its proof, we form each ua for 1 ≤
u ≤1
2(p−1) and reduce modulo p, obtaining as least positive residue either some
ri for i ≤n or some sj for j ≤k. Then ua/p = [ua/p] + p−1(some ri or sj).
Hence
1
2 (p−1)
	
u=1
ua =
1
2 (p−1)
	
u=1
p[ua/p] +
n	
i=1
ri +
k	
j=1
sj.
(∗)
TheproofofLemma1.4showedthat p−r1, . . . , p−rn, s1, . . . , sk isapermutation
of 1, . . . , 1
2(p −1), and thus the sum is the same in the two cases:
1
2 (p−1)
	
u=1
u =
n	
i=1
(p −ri) +
k	
j=1
sj = np −
n	
i=1
ri +
k	
j=1
sj.
Subtracting this equation from (∗), we obtain
(a −1)
1
2 (p−1)
	
u=1
u = p
 1
2 (p−1)
	
u=1
[ua/p] −n

+ 2
n	
i=1
ri.
Replacing 	 1
2 (p−1)
u=1
u on the left side by its value 1
8(p2−1) and taking into account
that p is odd, we obtain the following congruence modulo 2:
(a −1) 1
8(p2 −1) ≡
1
2 (p−1)
	
u=1
[ua/p] −n
mod 2.
Since a is odd, the left side is congruent to 0 modulo 2.
Therefore n ≡
	 1
2 (p−1)
u=1
[ua/p] ≡t mod 2, and Lemma 1.4 allows us to conclude that (−1)t =
(−1)n =
a
p

.
□
PROOF OF (c) IN THEOREM 1.2. Let
S =

(x, y) ∈Z × Z
 1 ≤x ≤1
2(p −1) and 1 ≤y ≤1
2(q −1)

,

12
I. Transition to Modern Number Theory
the number of elements in question being |S| = 1
4(p −1)(q −1). We can write
S = S1 ∪S2 disjointly with
S1 = {(x, y) | qx > py}
and
S2 = {(x, y) | qx < py};
the exhaustion of S by S1 and S2 follows because qx = py would imply that
p divides qx and hence that p divides x, contradiction. We can describe S1
alternatively as
S1 =

(x, y)
 1 ≤x ≤1
2(p −1) and 1 ≤y < qx/p

,
and therefore |S1| = 	 1
2 (p−1)
x=1
[qx/p], which is the integer t in Lemma 1.5 such
that (−1)t =
q
p

. Similarly we have |S2| = 	 1
2 (q−1)
y=1
[py/q], which is the integer
t in Lemma 1.5 such that (−1)t =
p
q

. Therefore
(−1)
1
4 (p−1)(q−1) = (−1)|S| = (−1)|S1|(−1)|S2| =
q
p
p
q

,
and the proof is complete.
□
3. Equivalence and Reduction of Quadratic Forms
A binary quadratic form over Z is a function F(x, y) = ax2 + bxy + cy2 from
Z×Z to Z with a, b, c in Z. Following Gauss,4 we abbreviate this F as (a, b, c).
We shall always assume, without explicitly saying so, that the discriminant
D = b2 −4ac is not the square of an integer and that F is primitive in the sense
that GCD(a, b, c) = 1. When there is no possible ambiguity, we may say “form”
or “quadratic form” in place of “binary quadratic form.”
Let
 α β
γ δ

be a member of the group GL(2, Z) of integer matrices whose
inverse is an integer matrix. The determinant of such a matrix is ±1. We can use
this matrix to change variables, writing

x
y

=

α
β
γ
δ
 
x′
y′

=

αx′ + βy′
γ x′ + δy′

.
Then ax2 + bxy + cy2 becomes
a(αx′ + βy′)2 + b(αx′ + βy′)(γ x′ + δy′) + c(γ x′ + δy′)2
= (aα2+bαγ +cγ 2)x′2+(2aαβ+bαδ+bβγ +2cγ δ)x′y′+(aβ2+bβδ+cδ2)y′2.
4Disquisitiones Arithmeticae, Article 153. Actually, Gauss always assumed that the coefﬁcient
of xy is even and consequently wrote (a, b, c) for ax2 + 2bxy + cy2. To study x2 + xy + y2, for
example, he took a = 2, b = 1, c = 2. The convention of working with ax2 + bxy + cy2 is due to
Eisenstein.

3. Equivalence and Reduction of Quadratic Forms
13
If we associate the triple (a, b, c) of F(x, y) to the matrix

2a b
b 2c

, then this
formula shows that the triple (a′, b′, c′) of the new form F′(x′, y′) is associated
to the matrix

2a′
b′
b′
2c′

=

α
γ
β
δ
 
2a
b
b
2c
 
α
β
γ
δ

.
From this equality of matrices, we see that
(i) the member

1 0
0 1

of GL(2, Z) has the effect of the identity transforma-
tion,
(ii) the member
 α β
γ δ
 
α′ β′
γ ′ δ′

of GL(2, Z) has the effect of applying ﬁrst
 α β
γ δ

and then

α′ β′
γ ′ δ′

.
These two facts say that we do not quite have the expected group action on forms
on the left. Instead, we can say either that we have a group action on the right
or that gF is obtained from F by operating by gt. Anyway, there are orbits,
and they are what we really need. The discriminant D = b2 −4ac of the form
F is evidently minus the determinant of the associated matrix

2a b
b 2c

, and the
displayed equality of matrices thus implies that the discriminant of the form F′
is D(αδ −βγ )2. Since (αδ −βγ )2 = 1 for matrices in GL(2, Z), we conclude
that
(iii) each member of GL(2, Z) preserves the discriminant of the form.
Hence the group GL(2, Z) acts on the forms of discriminant D.
Forms in the same orbit under GL(2, Z) are said to be equivalent. Forms in
the same orbit under the subgroup SL(2, Z) are said to be properly equivalent.
A proper equivalence class of forms will refer to the latter relation. This notion
is due to Gauss. Equivalence under GL(2, Z) is an earlier notion due to Lagrange,
and we shall refer to its classes as ordinary equivalence classes on the infrequent
occasions when the notion arises. Proper equivalence is necessary later in order
to get a group operation on classes of forms. If one form can be carried to another
form by a member of GL(2, Z) of determinant −1, we say that the two forms are
improperly equivalent. Use of the matrix

1
0
0 −1

shows that the form (a, b, c) is
improperly equivalent to the form (a, −b, c). In particular, (a, 0, c) is improperly
equivalent to itself.
The discriminant D is congruent to b2 modulo 4 and hence is congruent to 0
or 1 modulo 4. All nonsquare integers D that are congruent to 0 or 1 modulo 4
arise as discriminants; in fact, we can always achieve such a D with a = 1 and
with b equal either to 0 or to 1.
The discriminant is minus the determinant of the matrix

2a b
b 2c

associated to

14
I. Transition to Modern Number Theory
(a, b, c), and this matrix is real symmetric with trace 2(a+c). Since D = b2−4ac
is assumed not to be the square of an integer, neither a nor c can be 0.
If D > 0, the symmetric matrix

2a b
b 2c

is indeﬁnite, having eigenvalues
of opposite sign. In this case the Dirichlet class number of D, denoted by
h(D), is deﬁned to be the number5 of all proper equivalence classes of forms of
discriminant D.
If D < 0, then a and c have the same sign. The matrix

2a b
b 2c

is positive
deﬁnite if a and c are positive, and it is negative deﬁnite if a and c are negative.
Correspondingly we refer to the form (a, b, c) as positive deﬁnite or negative
deﬁnite in the two cases. Since gt 
2a b
b 2c

g is positive deﬁnite whenever

2a b
b 2c

is positive deﬁnite, any form equivalent to a positive deﬁnite form is again positive
deﬁnite. A similar remark applies to negative deﬁnite forms. Thus “positive
deﬁnite” and “negative deﬁnite” are class properties. For any given discriminant
D < 0, the Dirichlet class number of D, denoted by h(D), is the number6 of
proper equivalence classes of positive deﬁnite forms of discriminant D.
The form (a, b, c) represents an integer m if ax2 +bxy +cy2 = m is solvable
for some integers x and y. The form primitively represents m if the x and
y with ax2 + bxy + cy2 = m can be chosen to be relatively prime. In any
event, GCD(x, y) divides m, and thus whenever a form represents a prime p, it
primitively represents p.
Theorem 1.6. Fix a nonsquare discriminant D.
(a) The Dirichlet class number h(D) is ﬁnite. In fact, any form of discriminant
D is properly equivalent to a form (a, b, c) with |b| ≤|a| ≤|c| and therefore
has 3|ac| ≤|D|, and the number of forms of discriminant D satisfying all these
inequalities is ﬁnite.
(b) An odd prime p with GCD(D, p) = 1 is primitively representable by some
form (a, b, c) of discriminant D if and only if
D
p

= +1. In this case the number
of proper equivalence classes of forms primitively representing p is either 1 or 2,
and these classes are carried to one another by GL(2, Z). In fact, if
D
p

= +1,
then b2 ≡D mod 4p for some integer b, and representatives of these classes may
be taken to be

p, ±b, b2−D
4p

.
5This number was studied by Dirichlet. According to Theorem 1.20 below, it counts the “strict
equivalence classes” of ideals in a sense that is introduced in Section 7. This number either equals or
is twice the number of equivalence classes of ideals in the other sense that is introduced in Section 7.
The latter is what is generalized in Chapter V in the subject of algebraic number theory, and the latter
is how “class number” is usually deﬁned in modern books in algebraic number theory. Consequently
Dirichlet class numbers sometimes are twice what modern class numbers are. We use “Dirichlet
class numbers” in this chapter and change to the modern “class numbers” in Chapter V.
6This number was studied by Dirichlet. See the previous footnote for further information.

3. Equivalence and Reduction of Quadratic Forms
15
We come to the proof after some preliminary remarks and examples. The
argument for (a) is constructive, and thus the forms given explicitly in (b) can
be transformed constructively into properly equivalent forms satisfying the con-
ditions of (a). Hence we are led to explicit forms as in (a) representing p. A
generalization of (b) concerning how a composite integer m can be represented if
GCD(D, m) = 1 appears in Problem 2 at the end of the chapter. What is missing
in all this is a description of proper equivalences among the forms as in (a). We
shall solve this question readily in Proposition 1.7 when D < 0. For D > 0, the
answer is more complicated; we shall say what it is in Theorem 1.8, but we shall
omit some of the proof of that theorem.
EXAMPLES.
(1) D = −4. Theorem 1.2a shows that the odd primes with
D
p

= +1 are
those of the form 4k + 1. Theorem 1.6a says that each proper equivalence class
of forms of discriminant −4 has a representative (a, b, c) with 3|ac| ≤4. Since
D < 0, we are interested only in positive deﬁnite forms, which necessarily have
a and c positive. Thus a = c = 1, and we must have b = 0. So there is only
one class of (positive deﬁnite) forms of discriminant −4, namely x2 + y2, and
Theorem 1.6b allows us to conclude that x2 + y2 = p is solvable for each prime
p = 4k + 1. In other words, we recover the conclusion of Proposition 1.1 as far
as representability of primes is concerned.
(2) D = −20. To have
D
p

= +1 for an odd prime p, we must have either
−1
p

=
5
p

= +1 or
−1
p

=
5
p

= −1. Theorem 1.2 shows in the ﬁrst case
that p ≡1 mod 4 and p ≡±1 mod 5, while in the second case p ≡3 mod 4
and p ≡±3 mod 5. That is, p is congruent to one of 1 and 9 modulo 20 in the
ﬁrst case and to one of 3 and 7 modulo 20 in the second case. Let us consider
the forms as in Theorem 1.6a. We know that a > 0 and c > 0. The inequality
3ac ≤|D| forces ac ≤6. Since |b| ≤a ≤c, we obtain a2 ≤6 and a ≤2.
Since 4 divides D, b is even. Then b = 0 or b = ±2. So the only possibilities
are (1, 0, 5) and (2, ±2, 3). Because of Theorem 1.6b, any prime congruent to
one of 1, 3, 7, 9 modulo 20 is representable either by (1, 0, 5) and not (2, ±2, 3),
or by (2, ±2, 3) and not (1, 0, 5). We can write down all residues modulo 20 for
x2 + 5y2 and 2x2 ± 2xy + 3y2, and we ﬁnd that the possible residues prime to
20 are 1 and 9 in the ﬁrst case, and they are 3 and 7 in the second case. The
conclusion for odd primes p with GCD(20, p) = 1 is that
p ≡1 or 9 mod 20
implies
p is representable as x2 + 5y2,
p ≡3 or 7 mod 20
implies
p is representable as 2x2 ± 2xy + 3y2.
The residues modulo 20 have shown that x2 + 5y2 is not equivalent to either of
2x2 ± 2xy + 3y2, but they do not show whether 2x2 ± 2xy + 3y2 are properly

16
I. Transition to Modern Number Theory
equivalent to one another. Hence the Dirichlet class number h(−20) is either 2
or 3. It will turn out to be 2.
(3) D = −56. To have
D
p

= +1 for an odd prime p, we must have an
odd number of the Legendre symbols
−1
p

,
2
p

, and
7
p

equal to +1 and the
rest equal to −1. We readily ﬁnd from Theorem 1.2 that the possibilities with
GCD(56, p) = 1 are
p ≡1, 3, 5, 9, 13, 15, 19, 23, 25, 27, 39, 45 mod 56.
Applying Theorem 1.6a as in the previous example, we ﬁnd that x2 + 14y2,
2x2 + 7y2, and 3x2 ± 2xy + 5y2 are representatives of all proper equivalence
classes of forms of discriminant −56. Taking into account Theorem 1.6b and the
residue classes of these forms modulo 56, we conclude for odd primes p that
if p ≡any of 1, 9, 15, 23, 25, 39 mod 56, then
p is representable as x2 + 14y2 or 2x2 + 7y2,
if p ≡any of 3, 5, 13, 19, 27, 45 mod 56, then
p is representable as both of 3x2 ± 2xy + 5y2.
The question left unsettled by the argument so far is whether x2+14y2 is properly
equivalent to 2x2 + 7y2. Equivalent forms represent the same integers, and the
integer 1 is representable by x2+14y2 but not by 2x2+7y2. Hence the two forms
are not equivalent and cannot be properly equivalent. According to Theorem
1.6b, the primes of the ﬁrst line are therefore representable by either x2 +14y2 or
2x2 + 7y2 but never by both. Hence the Dirichlet class number h(−56) is either
3 or 4. It will turn out to be 4.
(4) D = 5. The forms of discriminant 5 are indeﬁnite. Applying Theorem
1.6a, we obtain 3|ac| ≤5. Hence |a| = |c| = 1. Since D is odd, b is odd. The
inequality |b| ≤|a| thus forces |b| = 1. Then D = 1 −4ac shows that ac < 0.
The possibilities are therefore (1, ±1, −1) and (−1, ±1, 1). The Dirichlet class
number h(5) is at most 4. It will turn out to be 1. Let us take this fact as known.
The odd primes p with
D
p

= +1 are p = 5k ± 1. Under the assumption that the
class number is 1, Theorem 1.6b shows that every such prime is representable as
x2 + xy −y2.
PROOF OF THEOREM 1.6a. We consider the effect of two transformations in
SL(2, Z), one via

0 −1
1
0

and the other via

1 n
0 1

.
Under these, the matrix
associated to (a, b, c) becomes

0
1
−1
0
 
2a
b
b
2c
 
0
−1
1
0

=

2c
−b
−b
2a


3. Equivalence and Reduction of Quadratic Forms
17
and

1
0
n
1
 
2a
b
b
2c
 
1
n
0
1

=

2a
2an + b
2an + b
2an2 + 2bn + 2c

,
respectively. Thus the transformations are
(a, b, c) 	−→(c, −b, a),
(∗)
(a, b, c) 	−→(a, 2an + b, c′).
(∗∗)
Possibly applying (∗) allows us to make |a| ≤|c| while leaving |b| alone. Since
a ̸= 0, we can apply (∗∗) with n the closest integer to −b
2a to make |b| ≤|a|.
This step possibly changes c. Thus after this step, we again apply (∗) if necessary
to make |a| ≤|c|, and we apply (∗∗) again. In each pair of steps, we may assume
that |b| strictly decreases or else that n = 0. We cannot always be in the former
case, since |b| is bounded below by 0. Thus at some point we obtain n = 0. At
this point, c does not change, and thus we have |b| ≤|a| ≤|c|, as required.
The inequalities |b| ≤|a| ≤|c| imply that
4|ac| = |D −b2| ≤|D| + |b|2 ≤|D| + |ac|,
and hence 3|ac| ≤|D|. Since neither a nor c is 0, it follows that the inequalities
|b| ≤|a| ≤|c| imply that |a|, |b|, |c| are all bounded by |D|. Therefore the
Dirichlet class number h(D) is ﬁnite.
□
PROOF OF NECESSITY IN THEOREM 1.6b. Suppose x and y are integers with
GCD(x, y) = 1 and ax2 + bxy + cy2 = p. Then ax2 + bxy + cy2 ≡0 mod p.
Choose u and v with ux + vy = 1. Routine computation shows that
4(ax2+bxy + cy2)(av2 −buv + cu2)
= [u(xb + 2yc) −v(2xa + yb)]2 −(b2 −4ac)(xu + yv)2
= [u(xb + 2yc) −v(2xa + yb)]2 −(b2 −4ac),
and hence
0 ≡[u(xb + 2yc) −v(2xa + yb)]2 −(b2 −4ac) mod p.
Consequently D ≡[u(xb + 2yc) −v(2xa + yb)]2 mod p, and D is exhibited as
a square modulo p.
□
PROOF OF SUFFICIENCY IN THEOREM 1.6b. Choose an integer solution b of
b2 ≡D mod p. Since b + p is another solution and has the opposite parity,
we may assume that b and D have the same parity. Then b2 ≡D mod p and
b2 ≡D mod 4, so that b2 ≡D mod 4p. Since GCD(D, p) = 1, p does not

18
I. Transition to Modern Number Theory
divide b, and the forms

p, ±b, b2−D
4p

are primitive. They have discriminant
b2 −4p b2−D
4p
= D, they take the value p for (x, y) = (1, 0), and they are
improperly equivalent via

1
0
0 −1

. Thus the forms in the statement of the theorem
exist.
For the uniqueness suppose that a form (a, b, c) of discriminant D represents
p, say with ax2
0 +bx0y0 +cy2
0 = p. Since this representation has to be primitive,
we know that GCD(x0, y0) = 1. Put
 α
γ

=
 x0
y0

, and choose integers β
and δ such that αδ −βγ = 1. Then
 α β
γ δ

has determinant 1 and satisﬁes
 α β
γ δ
 
1
0

=
 x0
y0

. The equality ax2
0 + bx0y0 + cy2
0 = 1
2(x0 y0)

2a b
b 2c
  x0
y0

therefore yields
p = 1
2 ( 1
0 )

α
γ
β
δ
 
2a
b
b
2c
 
α
β
γ
δ
 
1
0

.
Consequently the form (a′, b′, c′) associated to the matrix
 α γ
β δ
 
2a b
b 2c
  α β
γ δ

takes on the value p at (x, y) = (1, 0) and is properly equivalent to (a, b, c). In
particular, it is a form (p, b′, c′) for some b′ and c′ such that b′2 −4pc′ = D.
Thus in the proof of uniqueness, we may assume that we have two forms
(p, b′, c′) and (p, b′′, c′′) of discriminant D. Then b′′2 ≡D ≡b′2 mod 4p. The
conditions b′′2 ≡b′2 mod p and b′′2 ≡b′2 mod 4 imply that b′′ ≡±b′ mod p
and b′′ ≡b′ mod 2 for one of the choices of sign. Thus b′′ ≡±b′ mod 2p for
that choice of sign. Let us write b′′ = ±b′ + 2np for some integer n. The matrix
equality

1
0
n
1
 
2p
±b′
±b′
2c′
 
1
n
0
1

=

2p
2pn ± b′
2pn ± b′
2(∗)

shows that (p, ±b′, c′) is properly equivalent to (p, b′′, ∗). Since the discriminant
has to be D, we conclude that ∗= c′′. That is, (p, b′′, c′′) is properly equivalent to
(p, ±b′, c′) for that same choice of sign. Since (p, b′, c′) is improperly equivalent
to (p, −b′, c′), the proof of the theorem is complete.
□
Our discussion of representability of primes p by binary quadratic forms
of discriminant D when GCD(D, p) = 1 will be complete once we have a
set of representatives of proper equivalence classes with no redundancy. For
discriminant D < 0, this step is not difﬁcult and amounts, according to Theorem
1.6a, to sorting out proper equivalences among forms (a, b, c) with b2−4ac = D
and |b| ≤|a| ≤|c|. Let us call a form with D < 0 reduced when it satisﬁes
these conditions.

3. Equivalence and Reduction of Quadratic Forms
19
There are two redundancies that are easy to spot, namely
(a, b, a) is properly equivalent to (a, −b, a)
via

0 1
−1 0

,
(a, a, c) is properly equivalent to (a, −a, c)
via
 1 −1
0
1

.
The result for D < 0 is that there are no other redundancies among reduced
forms.
Proposition 1.7. Fix a negative discriminant D. With the exception of the
proper equivalences of
(a, b, a)
to
(a, −b, a)
(a, a, c)
to
(a, −a, c),
and
no two distinct reduced positive deﬁnite forms of discriminant D are properly
equivalent.
PROOF. Suppose that (a, b, c) is properly equivalent to (a′, b′, c′), that both
are reduced, and that a ≥a′ > 0.
For some
 α β
γ δ

in SL(2, Z), we have
a′ = aα2 + bαγ + cγ 2. Hence the inequalities c ≥a and |b| ≥−a imply that
a ≥aα2+bαγ +cγ 2 ≥a(α2+γ 2)+bαγ ≥a(α2+γ 2)−a|αγ | ≥a|αγ |, (∗)
and αγ equals 0 or ±1. Thus the ordered pair (α, γ ) is one of (0, ±1), (±1, 0),
(±1, 1), (±1, −1). Multiplying
 α β
γ δ

if necessary by

−1
0
0 −1

, which acts
trivially on quadratic forms, we may assume that (α, γ ) is one of (0, 1), (1, 0),
(1, ±1). We treat these three cases separately.
Case 1. (α, γ ) = (0, 1). The condition αδ−βγ = 1 forces βγ = −1, and the
formula b′ = 2aαβ + bαδ + bβγ + 2cγ δ gives (a′, b′, c′) = (c, −b + 2cδ, ∗).
Since |b| ≤c and |b −2cδ| ≤c, we must have |δ| ≤1. If δ = 0, we are
led to (a′, b′, c′) = (c, −b, a), which is reduced only if c = a, and this is the
ﬁrst of the two allowable exceptions. If |δ| = 1, the triangle inequality gives
2c = |2cδ| ≤|b| + |2cδ −b| ≤c + c = 2c, and therefore |b| = c = |b −2cδ|.
Then b = −(b −2cδ), and b = cδ = ±c. Since |b| ≤a ≤c, b = ±a also.
Hence (a′, b′, c′) = (a, −b, a), and this is again the ﬁrst of the two allowable
exceptions.
Case 2. (α, γ ) = (1, 0). The condition αδ −βγ = 1 forces αδ = 1, and thus
(a′, b′, c′) = (a, b + 2aβ, ∗). Since |b| ≤a and |b + 2aβ| ≤a, we must have
|β| ≤1. If β = 0, then (a′, b′, c′) = (a, b, c), and there is nothing to prove.
If |β| = 1, the triangle inequality gives 2a = |2aβ| ≤| −b| + |2aβ + b|, and

20
I. Transition to Modern Number Theory
therefore |b| = a = |b + 2βa|. Then b = −(b + 2βa), and we conclude that
b = −aβ = ±a and b + 2βa = ∓a. Hence the proper equivalence in question
is of (a, a, c) to (a, −a, c), which is the second of the two allowable exceptions.
Case 3. (α, γ ) = (1, ±1). From (∗) and the assumption that a ≥a′, we
have a ≥a′ ≥a|αγ | = a. Thus a = a′, and the deﬁnition of a′ shows that
a = a + bγ + c. Hence c = −bγ , and c = |b|. Since |b| ≤a ≤c, we obtain
−bγ = a = c. The formula b′ = 2aαβ + bαδ + bβγ + 2cγ δ then simpliﬁes to
b′ = 2aβ + bδ + bβγ + 2aγ δ = (2a + bγ )(β + γ δ). From αδ −βγ = 1, we
have δ −βγ = 1 and thus also γ δ = γ + β. Therefore β + γ δ = 2β + γ , and
this cannot be 0. So |b′| ≥|2a + bγ | = |2a −a| = a = a′. Since (a′, b′, c′)
is reduced, |b′| = a′ = a = c = |b|, and the proper equivalence is of (a, a, a)
to (a, −a, a). This is an instance of both allowable exceptions, and the proof is
complete.
□
EXAMPLES, CONTINUED.
(2) D = −20. We saw earlier that the reduced positive deﬁnite forms with
D = −20 are x2 + 5y2 and 2x2 ± 2xy + 3y2, i.e., (1, 0, 5) and (2, ±2, 3). The
remarks preceding Proposition 1.7 show that (2, 2, 3) is properly equivalent to
(2, −2, 3), and the proposition shows that (1, 0, 5) is not properly equivalent to
(2, 2, 3). (We saw this latter conclusion for this example earlier by considering
residues.) Consequently h(−20) = 2.
(3) D = −56. We saw earlier that the reduced positive deﬁnite forms with
D = −56 are x2+14y2, 2x2+7y2, and 3x2±2xy+5y2, i.e., (1, 0, 14), (2, 0, 7),
(3, 2, 5), and (3, −2, 5). Proposition 1.7 shows that no two of these four forms
are properly equivalent. Consequently h(−56) = 4.
Let us turn our attention to D > 0. We still have the proper equivalences
of (a, b, a) to (a, −b, a) and (a, a, c) to (a, −a, c) as in the remarks before
Proposition 1.7. But there can be others, and the question is subtle. Here are
some simple examples.
EXAMPLES WITH POSITIVE DISCRIMINANT.
(1) D = 5. The forms with D = 5 satisfying the inequalities |b| ≤|a| ≤|c| of
Theorem 1.6a are (1, ±1, −1) and (−1, ±1, 1). The second standard equivalence
allows us to discard one form from each pair, and we are left with (1, 1, −1) and
(−1, −1, 1). The ﬁrst of these two is equivalent to the second via
 α β
γ δ

=

0 1
−1 0

. Thus h(5) = 1, as was announced without proof in Example 4 earlier in
this section.
(2) D = 13. The forms with D = 13 satisfying the inequalities |b| ≤|a| ≤
|c| of Theorem 1.6a are (1, ±1, −3) and (−1, ±1, 3).
The second standard

3. Equivalence and Reduction of Quadratic Forms
21
equivalence allows us to discard one form from each pair, and we are left with
(1, 1, −3) and (−1, −1, 3). The ﬁrst of these two is equivalent to the second via
 α β
γ δ

=

1 −2
1 −1

. Thus h(13) = 1.
(3) D = 21. The forms with D = 21 satisfying the inequalities |b| ≤|a| ≤
|c| of Theorem 1.6a are (1, ±1, −5) and (−1, ±1, 5).
The second standard
equivalence allows us to discard one form from each pair, and we are left with
(1, 1, −5) and (−1, −1, 5). These are not properly equivalent. In fact, the form
−x2 −xy + 5y2 is −1 for (x, y) = (1, 0), but x2 + xy −5y2 = −1 is not even
solvable modulo 3. Thus h(21) = 2.
Although the starting data for these three examples are similar, the outcomes
are strikingly different. The idea for what to do involves starting afresh with the
reduction question that was addressed in Theorem 1.6a. For discriminant D > 0,
a different reduction is to be used. The reduction in question appears in Theorem
1.8a below, but some preliminary remarks are needed to explain the proof.
Two forms (a, b, c) and (a′, b′, c′) of discriminant D > 0 will be said to be
neighbors if c = a′ and b + b′ ≡0 mod 2c. More precisely we say in this
case that (a′, b′, c′) is a neighbor on the right of (a, b, c) and that (a, b, c) is
a neighbor on the left of (a′, b′, c′). A key observation is that neighbors are
properly equivalent to one another. In fact, if (a′, b′, c′) is a neighbor on the right
of (a, b, c), deﬁne
 α β
γ δ

=
 0
−1
1 (b+b′)/(2c)

. Then computation gives

α
γ
β
δ
 
2a
b
b
2c
 
α
β
γ
δ

=

2c
b′
b′
(b −b′) b+b′
2c

.
The lower right entry of this matrix is an even integer, since b + b′ ≡0 mod 2c
and since, as a consequence, b + b′ ≡0 mod 2. Hence (a, b, c) is transformed
into (c, b′, c′), where c′ = 1
2(b −b′) b+b′
2c .
Let us call a primitive form (a, b, c) of discriminant D > 0 reduced when it
satisﬁes the conditions
0 < b <
√
D
and
√
D −b < 2|a| <
√
D + b.
The ﬁrst inequality shows that b is bounded if D is ﬁxed, and the equality
−4ac = D2 −b2 shows that there are only ﬁnitely many possibilities for a
and c. Consequently there are only ﬁnitely many reduced forms for given D.
From |b| <
√
D, we see that b2 < D = b2−4ac and ac < 0; thus any reduced
form has a and c of opposite sign. Then D −b2 = −4ac = (2|a|)(2|c|), and it
follows that 2|a| >
√
D −b implies 2|c| <
√
D + b and that 2|a| <
√
D + b
implies 2|c| <
√
D −b. Consequently
√
D −b < 2|c| <
√
D + b.

22
I. Transition to Modern Number Theory
Theorem 1.8. Fix a positive nonsquare discriminant D.
(a) Each form of discriminant D is properly equivalent to some reduced form
of discriminant D.
(b) Each reduced form of discriminant D is a neighbor on the left of one and
only one reduced form of discriminant D and is a neighbor on the right of one
and only one reduced form of discriminant D.
(c) The reduced forms of discriminant D occur in uniquely determined cycles,
each one of even length, such that each member of a cycle is an iterated neighbor
on the right to all members of the cycle and consequently is properly equivalent
to all other members of the cycle.
(d) Two reduced forms of discriminant D are properly equivalent if and only
if they lie in the same cycle in the sense of (c).
REMARKS. Conclusion (d) is the deepest part of the theorem, involving a subtle
argument that in essence uses the periodic continued-fraction expansion of the
roots z of the polynomial az2 + bz + c if (a, b, c) is a form under consideration.
We shall prove (a) through (c), omitting the proof of (d), and then we shall return
to the three examples D = 5, 13, 29 begun just above.
PROOF OF THEOREM 1.8a. If (a, b, c) is given and is not reduced, let m be the
unique integer such that
√
D −2|c| < −b + 2cm <
√
D,
(∗)
and deﬁne (a′, b′, c′) = (c, −b + 2cm, a −bm + cm2). Then
b′2 −4a′c′ = (−b + 2cm)2 −4c(a −bm + cm2)
= b2 −4bcm + 4c2m2 −4ac + 4bcm −4c2m2 = b2 −4ac = D,
and we observe that a′ = c and that b + b′ = 2cm ≡0 mod 2c. Consequently
(a′, b′, c′) is a form of discriminant D and is a right neighbor to (a, b, c). By the
remarks before the theorem, (a, b, c) is properly equivalent to (a′, b′, c′).
We repeat this process at least once, obtaining (a′′, b′′, c′′). If |a′′| < |a′|, we
repeat it again, obtaining (a′′′, b′′′, c′′′), and we continue in this way. Eventually
the strict decrease of the magnitude of the ﬁrst entry must stop. To keep the
notation simple, we may assume without loss of generality that |a′′| ≥|a′|. The
claim is that (a′, b′, c′) is then reduced.
Put u =
√
D −b′ and v = b′ −(
√
D −2|a′|). The inequalities (∗) show that
u > 0 and v > 0. Therefore
0 < v2 + 2uv + 2u
√
D = (u + v)2 −u2 + 2u
√
D
= 4a′2 −(D −2b′√
D + b′2) + 2D −2b′√
D
= 4a′2 + D −b′2 = 4a′2 −4a′c′.

3. Equivalence and Reduction of Quadratic Forms
23
Since |c′| = |a′′| ≥|a′|, this inequality shows that a′c′ < 0. Therefore b′2 =
D + 4a′c′ < D, and |b′| <
√
D.
From a′c′ < 0 and |a′| ≤|c′|, we see that 4|a′|2 ≤4|a′c′| = −4a′c′ =
D −b′2 ≤D. Therefore 2|a′| <
√
D. The inequality
√
D −2|c| < b′ implies
that
√
D −b′ < 2|c| = 2|a′|. The right side has just been shown to be <
√
D,
and therefore b′ > 0. Hence
√
D −b′ < 2|a′| <
√
D <
√
D + b′.
□
PROOF OF THEOREM 1.8b. Suppose that (a, b, c) is reduced and that (a′, b′, c′)
is a reduced neighbor on the right of (a, b, c). Then we must have a′ = c and
b + b′ ≡0 mod 2c. Since D −b′ < 2|a′| and b′ <
√
D, we have
√
D −2|a′| <
b′ <
√
D. That is,
√
D −2|c| < b′ <
√
D. These inequalities in combination
with the congruence b + b′ ≡0 mod 2c show that (a, b, c) uniquely determines
b′. Since (a′, b′, c′) is to have discriminant D, c′ is uniquely determined also.
We turn this construction around to prove existence of a right neighbor. Deﬁne
(a′, b′, c′) in terms of (a, b, c) as in the proof of Theorem 1.8a. Then a′ = c, and
b′ is the unique integer such that b + b′ ≡0 mod 2c and
√
D −2|c| < b′ <
√
D.
The form (a′, b′, c′) is a right neighbor of (a, b, c), and we are to show that
(a′, b′, c′) is reduced.
Since (a, b, c) is reduced, we have
√
D −b < 2|c| <
√
D + b and b <
√
D.
Let m be the integer such that b + b′ = 2m|c|. Addition of the inequalities
b′ −(
√
D −2|c|) > 0 and
√
D + b −2|c| > 0 gives 2m|c| = b + b′ > 0,
and thus m > 0. Hence m −1 ≥0. Addition of the inequalities
√
D −b > 0
and b′ −(
√
D −2|c|) > 0 gives 0 < b′ −b + 2|c| = 2b′ −(b + b′) + 2|c| =
2b′ −2(m −1)|c|. Hence 2b′ > 2(m −1)|c| ≥0, and we see that b′ > 0.
Therefore 0 < b′ <
√
D.
The deﬁnition of b′ gives
√
D−b′ < 2|c| = 2|a′|. Addition of the inequalities
2(m −1)|c| ≥0 and
√
D −b > 0 gives b + b′ −2|c| +
√
D −b > 0, which
says that 2|a′| <
√
D + b′. Therefore (a′, b′, c′) is reduced.
Let R be the operation of passing from a reduced form (a, b, c) to its unique
reduced right neighbor (a′, b′, c′). What we have just shown implies that R acts
as a permutation of the ﬁnite set of reduced forms of discriminant D. This set
being ﬁnite, let n be the order of R. Then the set {Rk | 0 ≤k ≤n −1} is a
cyclic group of permutations of the set of reduced forms of discriminant D. The
existence of a two-sided inverse of R as a permutation implies that each reduced
form of discriminant D has exactly one left neighbor. Thus the existence and
uniqueness of neighbors on one side for reduced forms, in the presence of the
ﬁniteness of the set, implies existence and uniqueness on the other side.
□

24
I. Transition to Modern Number Theory
PROOF OF THEOREM 1.8c. We continue with R as the operation of passing from
a reduced form to its unique reduced right neighbor, letting {Rk | 0 ≤k ≤n −1}
be the ﬁnite cyclic group of powers of R. This group acts on the set of reduced
forms of discriminant D, and the cycles in question are the orbits under this action.
To see that each orbit has an even number of members, we recall that a reduced
form (a, b, c) has a and c of opposite sign. Thus if, for example, a is positive,
then Rl(a, b, c) = (a′, b′, c′) has (−1)la′ positive. If the orbit of (a, b, c) has
k members, then Rk(a, b, c) = (a, b, c). Consequently (−1)ka has to have the
same sign as a, and k has to be even. Finally the members of each orbit are
properly equivalent to one another because, as we observed before the statement
of the theorem, a form is properly equivalent to each of its neighbors.
□
EXAMPLES WITH POSITIVE DISCRIMINANT, CONTINUED.
(1) D = 5. The forms with D = 5 satisfying the inequalities of Theorem
1.8a are (1, 1, −1) and (−1, 1, 1), and these consequently represent all proper
equivalence classes. They form a single cycle and are properly equivalent by
Theorem 1.8c. Thus again we obtain the easy conclusion that h(5) = 1.
(2) D = 13. The forms with D = 13 satisfying the inequalities of Theorem
1.8a are (1, 3, −1) and (−1, 3, 1), which make up a single cycle. Thus h(13) = 1.
(3) D = 21. The forms with D = 21 satisfying the inequalities of Theorem
1.8a are (1, 3, −2) and (−2, 3, 1), which make up one cycle, and (−1, 3, 2) and
(2, 3, −1), which make up another cycle. Thus h(21) = 2.
4. Composition of Forms, Class Group
The identity (x2
1 + y2
1)(x2
2 + y2
2) = (x1x2 −y1y2)2 +(x1y2 +x2y1)2, which can be
derived by factoring the left side in Q(√−1 )[x1, y1, x2, y2] and rearranging the
factors, readily generalizes to an identity involving any form x2 + bxy + cy2 of
nonsquare discriminant D = b2 −4c. We complete the square, writing the form
as (x −1
2by)2−1
4 y2D and factoring it as

x −1
2by+ 1
2 y
√
D

x −1
2by−1
2 y
√
D

,
and we obtain
(x2
1 + bx1y1 + cy2
1)(x2
2 + bx2y2 + cy2
2)
= (x1x2 −cy1y2)2 + b(x1x2 −cy1y2)(x1y2 + x2y1 + by1y2)
+ c(x1y2 + x2y1 + by1y2)2.
Improving on an earlier attempt by Legendre, Gauss made a thorough inves-
tigation of how one might multiply two distinct forms of the same nonsquare
discriminant, not necessarily with ﬁrst coefﬁcient 1, and Dirichlet reworked the
theory and simpliﬁed it. Out of this work comes the following composition
formula, of which the above formula is manifestly a special case.

4. Composition of Forms, Class Group
25
Proposition 1.9. Let (a1, b, c1) and (a2, b, c2) be two primitive forms with the
same middle coefﬁcient b and with the same nonsquare discriminant D, hence
with a1c1 = a2c2 ̸= 0. Suppose that j = c1a−1
2
= c2a−1
1
is an integer. Then the
form (a1a2, b, j) is primitive of discriminant D, and it has the property that
(a1x2
1 + bx1y1 + cy2
1)(a2x2
2 + bx2y2 + cy2
2)
= a1a2(x1x2 −jy1y2)2 + b(x1x2 −jy1y2)(a1x1y2 + a2x2y1 + by1y2)
+ j(a1x1y2 + a2x2y1 + by1y2)2.
REMARKS. Consequently if an integer m is represented by the form (a1, b, c1)
and an integer n is represented by the form (a2, b, c2), then mn is represented by
the form (a1a2, b, j). For example we saw in an example with D = −20 imme-
diately following the statement of Theorem 1.6 that any prime that is congruent to
3 or 7 modulo 20 is representable as 2x2 +2xy +3y2. If we have two such primes
p and q, then p is representable by (2, 2, 3) and q is representable by (3, 2, 2).
The proposition is applicable with j = 1 and shows that pq is representable by
(6, 2, 1). In turn, substitution using
 α β
γ δ

=

1 0
−1 1

changes this form to the
properly equivalent form (5, 0, 1). Thus pq is representable as x2 + 5y2.
PROOF. The form (a1a2, b, j) is primitive because any prime that divides
GCD(a1a2, b, j) has to divide either GCD(a1, b, j) or GCD(a2, b, j) and then
certainly has to divide GCD(a1, b, c1) or GCD(a2, b, c2). No such prime ex-
ists, and hence (a1a2, b, j) is primitive.
The discriminant of (a1a2, b, j) is
b2 −4 ja1a2 = D + 4a1c1 −4 ja1a2 = D + 4a1c1 −4(c1a−1
2 )a1a2 = D,
as asserted, and the veriﬁcation of the displayed identity is a routine computation.
□
Let us say that two primitive forms (a1, b1, c1) and (a2, b2, c2) of the same
nonsquare discriminant are aligned if b1 = b2 and if j = c1a−1
2
= c2a−1
1
is an
integer. In the presence of equal nonsquare discriminants D and the equal middle
entries b, the rational number j is automatically an integer if GCD(a1, a2) = 1.
In fact, the equality D −b2 = −4a1c1 = −4a2c2 shows that D −b2 is divisible
by 4a1 and by 4a2; since GCD(a1, a2) = 1, D −b2 is divisible by 4a1a2, and the
quotient −j is an integer.
The idea is that each pair of classes of properly equivalent primitive forms
of discriminant D has a pair of aligned representatives, and a multiplication of
proper equivalence classes is well deﬁned if the product is deﬁned as the class of
the composition of these aligned representatives in the sense of Proposition 1.9.
This multiplication for proper equivalence classes will make the set of classes
into a ﬁnite abelian group. This group will be deﬁned as the “form class group”
for the discriminant D, except that we use only the positive deﬁnite classes in the

26
I. Transition to Modern Number Theory
case that D < 0. Before phrasing these statements as a theorem, we make some
remarks and then state and prove two lemmas.
Let (a, b, c) be a form of nonsquare discriminant D, and let b′ be an integer
with b′ ≡b mod 2a. In this case the number c′ = (b′2 −D)/(4a) is an integer;
in fact, we certainly have the congruences b′2 ≡b2 mod 2a and b′2 ≡b2 mod 4,
and thus we obtain the automatic7 consequence b′2 ≡b2 mod 4a, the rewritten
congruence b′2 ≡D + 4ac mod 4a, and the desired result b′2 −D ≡0 mod 4a.
Hence (a, b′, c′) is another form of discriminant D. We call (a, b′, c′) a translate
of (a, b, c). The key observation about translates is that the translate (a, b′, c′) is
properly equivalent to (a, b, c). This fact follows from the computation

1
0
l
1
 
2a
b
b
2c
 
1
l
0
1

=

2a
b + 2al
b + 2al
2(al2 + bl + c)

=

2a
b′
b′
2c′

,
valid for any integer l.
Lemma 1.10. If (a, b, c) is a primitive form of nonsquare discriminant and if
m ̸= 0 is an integer, then (a, b, c) primitively represents some integer relatively
prime to m.
PROOF. Let
w0 = product of all primes dividing a, c, and m,
x0 = product of all primes dividing a and m but not c,
y0 = product of all primes dividing m but not a.
Referring to the deﬁnitions, we see that any prime dividing m divides exactly
one of w0, x0, and y0. In particular, GCD(x0, y0) = 1. We shall show that
GCD(m, ax2
0 + bx0y0 + cy2
0) = 1, and the proof will be complete. Arguing by
contradiction, suppose that a prime p divides GCD(m, ax2
0 +bx0y0+cy2
0). There
are three cases for p, as follows.
Case 1. If p divides x0, then the fact that p divides ax2
0 + bx0y0 + cy2
0 implies
that p divides cy2
0. Since p does not divide y0, p divides c, in contradiction to
the deﬁnition of x0.
Case 2. If p divides y0, then similarly p divides ax2
0. Since p does not divide
x0, p divides a, in contradiction to the deﬁnition of y0.
Case 3. If p divides w0, then the fact that p divides a and c implies that p
divides bx0y0. Since p divides neither x0 nor y0, p divides b, in contradiction to
the fact that (a, b, c) is primitive.
□
7The argument being used here—that a congruence modulo 2a implies the congruence of the
squares modulo 4a—will be used again later in this section without detailed comment.

4. Composition of Forms, Class Group
27
Lemma 1.11. Suppose that (a1, b, c1) and (a2, b, c2) are properly equivalent
forms of nonsquare discriminant. If l is an integer such that GCD(a1, a2,l) = 1
and such that l divides GCD(c1, c2), then (la1, b,l−1c1) and (la2, b,l−1c2) are
properly equivalent forms.
REMARK. Even if (a1, b, c1) and (a2, b, c2) are primitive, it does not follow
that (la1, b,l−1c1) and (la2, b,l−1c2) are primitive. In fact, one need only take
l = 2 and (a1, b, c1) = (a2, b, c2) = (1, 2, 4).
PROOF. Since (a1, b, c1) and (a2, b, c2) are properly equivalent, there exists
 α β
γ δ

with

α
γ
β
δ
 
2a1
b
b
2c1
 
α
β
γ
δ

=

2a2
b
b
2c2

.
We multiply both sides on the right by
 α β
γ δ
−1
, and the result is the system of
four scalar equations
2a1α + bγ = 2a2δ −bγ,
2a1β + bδ = bδ −2c2γ,
bα + 2c1γ = −2a2β + bα,
bβ + 2c1δ = −bβ + 2c2α.
The second and third equations simplify to a1β + c2γ = 0 and a2β + c1γ = 0.
Since l divides c1 and c2, these two simpliﬁed equations show that l divides a1β
and a2β. Since GCD(a1, a2,l) = 1, it follows that l divides β.
Therefore the matrix

α l−1β
lγ
δ

of determinant 1 has integer entries. Direct
computation shows that

α
lγ
l−1β
δ
 
2la1
b
b
2l−1c1
 
α
l−1β
lγ
δ

=

2la2
b
b
2l−1c2

.
Consequently the forms(la1, b,l−1c1) and (la2, b,l−1c2) are properly equivalent.
□
Theorem 1.12. Let D be a nonsquare discriminant, and let C1 and C2 be proper
equivalence classes of primitive forms of discriminant D.
(a) There exist aligned forms (a1, b, c1) ∈C1 and (a2, b, c2) ∈C2, and these
may be chosen in such a way that a1 and a2 are relatively prime to each other and
to any integer m ̸= 0 given in advance.

28
I. Transition to Modern Number Theory
(b) If the product of C1 and C2 is deﬁned to be the proper equivalence class
of the composition of any aligned representatives of C1 and C2, as for example
the ones in (a), then the resulting product operation is well deﬁned on proper
equivalence classes of primitive forms of discriminant D.
(c) Under the product operation in (b), the set of proper equivalence classes
of primitive forms of discriminant D is a ﬁnite abelian group. The identity is the
class of (1, 0, −D/4) if D ≡0 mod 4 and is the class of (1, 1, −(D −1)/4) if
D ≡1 mod 4. The group inverse of the class of (a, b, c) is the class of (a, −b, c).
REMARK. When D < 0, the proper equivalence classes of positive deﬁnite
forms are a subgroup. In fact, if (a1, b, c1) and (a2, b, c2) are positive deﬁnite
and are aligned, then a1 and a2 are positive, and therefore their composition
(a1a2, b, j) has a1a2 positive and is positive deﬁnite. As was indicated in the
discussionbeforeLemma1.10, theformclassgroupfordiscriminant D isdeﬁned
to be the group in (c) if D > 0, and it is deﬁned to be the subgroup of classes of
positive deﬁnite forms if D < 0.
PROOF OF THEOREM 1.12a. By two applications of Lemma 1.10, C1 primitively
represents some integer a1 prime to m, and C2 primitively represents some integer
a2 prime to a1m. Arguing as in the last part of the proof of Theorem 1.6b, we may
assume without loss of generality that (x, y) = (1, 0) yields these values in each
case. Then C1 contains a form (a1, b1, ∗) for some b1, and C2 contains a form
(a2, b2, ∗) for some b2. By the remarks before Lemma 1.10, C1 contains every
translate (a1, b1 + 2a1l1, ∗), and C2 contains every translate (a2, b2 + 2a2l2, ∗).
Let us make speciﬁc choices of l1 and l2. We know that b1 ≡D ≡b2 mod 2,
so that b2 −b1 is even. The construction of a1 and a2 was arranged to make
GCD(a1, a2) = 1, and therefore GCD(2a1, 2a2) = 2. Since b2 −b1 is even,
we can choose l1 and l2 such that 2a1l1 −2a2l2 = b2 −b1. Then b1 + 2a1l1 =
b2 + 2a2l2, and we take the common value as b.
For this b, C1 contains the form (a1, b, ∗), and C2 contains the form (a2, b, ∗).
Since we have arranged that GCD(a1, a2) = 1, the remark immediately following
the deﬁnition of “aligned” shows that these forms are aligned.
□
PROOF OF THEOREM 1.12b. Suppose that
(a′
1, b′, ∗)
is properly equivalent to
(a′′
1, b′′, ∗),
(a′
2, b′, ∗)
is properly equivalent to
(a′′
2, b′′, ∗),
with the vertical pairs aligned. We are to show that
(a′
1a′
2, b′, ∗)
is properly equivalent to
(a′′
1a′′
2, b′′, ∗).
(∗)
Theorem 1.12a applied to the integer m = a′
1a′
2a′′
1a′′
2 gives us an aligned pair of
forms (a1, b, ∗) and (a2, b, ∗) in the respective proper equivalence classes such

4. Composition of Forms, Class Group
29
that GCD(a1, a2) = 1 and GCD(a1a2, m) = 1. If we can show that
(a′
1a′
2, b′, ∗)
is properly equivalent to
(a1a2, b, ∗),
(∗∗)
then we will have symmetrically that
(a′′
1a′′
2, b′′, ∗)
is properly equivalent to
(a1a2, b, ∗),
and (∗) will follow from this fact and (∗∗) by transitivity of proper equivalence.
We can now argue as in the proof of Theorem 1.12a. We know that b ≡D ≡
b′ mod 2, so that b′ −b is even. The construction of a1 and a2 was arranged
to make GCD(a1a2, a′
1a′
2) = 1, and therefore GCD(2a1a2, 2a′
1a′
2) = 2. Since
b2 −b1 is even, we can choose l and l′ such that 2a1a2l −2a′
1a′
2l′ = b′ −b. Then
b + 2a1a2l = b′ + 2a′
1a′
2l′, and we take the common value as B. This B has
B ≡b mod 2a1a2
and
B ≡b′ mod 2a′
1a′
2.
Thus
(a1, b, ∗)
is properly equivalent to
(a1, B, ∗),
(a2, b, ∗)
is properly equivalent to
(a2, B, ∗),
(a1a2, b, ∗)
is properly equivalent to
(a1a2, B, ∗),
(†)
and similarly
(a′
1, b′, ∗)
is properly equivalent to
(a′
1, B, ∗),
(a′
2, b′, ∗)
is properly equivalent to
(a′
2, B, ∗),
(a′
1a′
2, b′, ∗)
is properly equivalent to
(a′
1a′
2, B, ∗).
(††)
By construction of b, (a1, b, ∗) is properly equivalent to (a′
1, b′, ∗). This equiv-
alence, in combination with the ﬁrst line of (†) and the ﬁrst line of (††), shows
that
(a1, B, ∗)
is properly equivalent to
(a′
1, B, ∗).
(‡)
Let us check that Lemma 1.11 is applicable to the two properly equivalent
forms of (‡) and to the integer l = a′
2. In fact, GCD(a1, a2,l) = 1 follows
from GCD(a1a2, a′
1a′
2) = 1, and the problem is to show that l = a′
2 divides
(D −B2)/(4a1) and (D −B2)/(4a′
1). To see this divisibility, we observe that
D −b′2 is divisible by 4a′
1a′
2 because (a′
1, b′, ∗) and (a′
2, b′, ∗) are given as
aligned; the congruence b′ ≡B mod 2a′
1a′
2 implies that b′2 ≡B2 mod 4a′
1a′
2,
and addition gives D −B2 ≡0 mod 4a′
1a′
2. Meanwhile, D −B2 is divisible
by 4a1 because the third member of (a1, B, ∗) is an integer. Since D −B2 is
divisible also by 4a′
1a′
2 and since GCD(a1, a′
1a′
2) = 1, D −B2 is divisible by

30
I. Transition to Modern Number Theory
4a1a′
1a′
2. Therefore (D −B2)/(4a1) and (D −B2)/(4a′
1) are divisible by a′
2, and
Lemma 1.11 is indeed applicable.
The application of Lemma 1.11 to (‡) with l = a′
2 shows that
(a1a′
2, B, ∗)
is properly equivalent to
(a′
1a′
2, B, ∗).
Similarly (a2, B, ∗) is properly equivalent to (a′
2, B, ∗), and an application of
Lemma 1.11 to this equivalence with l = a1 shows that
(a1a2, B, ∗)
is properly equivalent to
(a1a′
2, B, ∗).
The two results together show that
(a1a2, B, ∗)
is properly equivalent to
(a′
1a′
2, B, ∗).
Combining this equivalence with the third line of (†) and the third line of (††),
we obtain (∗∗), and the proof of (b) is complete.
□
PROOF OF THEOREM 1.12c. The set of proper equivalence classes is ﬁnite by
Theorem 1.6a, and commutativity of multiplication is clear. Deﬁne δ to be 0 if
D ≡0 mod 4 and to be 1 if D ≡1 mod 4. Let us see that the class of (1, δ, ∗)
is the identity. If (a, b, c) has discriminant D, then b ≡δ mod 2, and hence
(1, b, ∗) = (1, δ + 2 · 1 · 1
2(b −δ)) is a translate of (1, δ, ∗). Consequently
(1, b, ∗) and (1, δ, ∗) are properly equivalent. Since Proposition 1.9 shows that
the composition of (a, b, c) and (1, b, ∗) is (a, b, ∗), Theorem 1.12b allows us to
conclude that the class of (1, δ, ∗) is the identity.
For inverses Theorem 1.12b shows that the product of the classes of (a, b, c)
and (a, −b, c) is the product of the classes of (a, b, c) and (c, b, a), which is
the class of the composition (a, b, c)(c, b, a). Proposition 1.9 shows that this
composition is (ac, b, 1). Since (ac, b, 1) is properly equivalent to (1, −b, ac)
and since the latter is properly equivalent to (1, δ, ∗), the class of the composition
(a, b, c)(c, b, a) is the identity.
To complete the proof, we need to verify associativity. Let C1, C2, and C3
be three proper equivalence classes of primitive forms of discriminant D. Let
(a1, b1, c1) be a form in the class C1. Lemma 1.10 shows that C2 represents an
integera2 prime toa1, and then it follows that the form(a2, b2, c2) is in C2 for some
integers b2 and c2. A second application of Lemma 1.10 shows that C3 represents
an integer a3 prime to a1a2, and then it follows that the form (a3, b3, c3) is in C3 for
some integers b3 and c3. The middle components have b1 ≡b2 ≡b3 ≡δ mod 2,
and thus 1
2(bj −δ) is an integer for j = 1, 2, 3. Since a1, a2, a3 are relatively
prime in pairs, the Chinese Remainder Theorem shows that the congruences
x ≡1
2(bj −δ) mod aj have a common integer solution x for j = 1, 2, 3. Deﬁne

5. Genera
31
b = 2x + δ. Then b is a solution of b ≡bj mod 2aj for j = 1, 2, 3. Write
b = bj + 2ajnj for suitable integers nj. Then (aj, b, ∗) = (aj, bj + 2ajnj, ∗)
is a translate of (aj, bj, cj) and consequently is properly equivalent to it. Thus
(aj, b, ∗) lies in Cj. Taking into account Theorem 1.12b and using Proposition 1.9,
we see that C1(C2C3) and (C1C2)C3 are both represented by the form (a1a2a3, b, ∗)
and hence are equal.
□
5. Genera
The theory of genera lumps proper equivalence classes of forms of a given dis-
criminant according to their values in some way. There are at least two possible
deﬁnitions of “genus,” and it is a deep result that they lead to the same thing
in all cases of interest. By way of background, we saw in Sections 2 and 3 for
discriminant D = −56 that the number of proper equivalence classes of binary
quadratic forms is exactly 4, representatives being x2 + 14y2, 2x2 + 7y2, and
3x2±2xy+5y2. The last two are improperly equivalent and take the same values
at integer points (x, y), and there are no other improper equivalences. Thus the
ﬁrst two take on a disjoint set of prime values from the values of 3x2 ±2xy +5y2
for integer points (x, y), and the sets of prime values taken on by x2 + 14y2 and
2x2 + 7y2 at integer points are disjoint from one another.
Twopossiblelumpingsofproperequivalenceclassesariseforthisdiscriminant.
One is to identify forms when their values modulo 56 include the same residues
prime to 56. It is just a ﬁnite computation to see that
x2 + 14y2 and 2x2 + 7y2
take on the residues
1, 9, 15, 23, 25, 39,
3x2 ± 2xy + 5y2
take on the residues
3, 5, 13, 19, 27, 45.
Thus the ﬁrst kind of lumping treats x2 + 14y2 and 2x2 + 7y2 together because
of the residues they take on, and it treats 3x2 + 2xy + 5y2 and 3x2 −2xy + 5y2
together. Gauss proceeded by using this kind of lumping to deﬁne “genus.”
The other lumping is to identify integer forms that take on the same rational
values at rational points. Here 2x2 + 7y2 = 1 for (x, y) = ( 1
3, 1
3), and of course
x2 + 14y2 = 1 for (x, y) = (1, 0). Hence the sets of values of x2 + 14y2
and 2x2 + 7y2 for x and y rational have a nonzero value in common. Lemma
1.13 below implies that the sets of rational values taken on by the two forms are
identical. The second kind of lumping treats x2 + 14y2 and 2x2 + 7y2 together
because they take on the same rational values. We shall use this latter kind of
lumping because, as Theorem 1.14 below shows, this is the deﬁnition that more
quickly identiﬁes the genus group once the form class group is known.

32
I. Transition to Modern Number Theory
Problems 25–40 at the end of the chapter show that the two deﬁnitions of genus
lead to the same thing for discriminants that are “fundamental” in a sense that we
deﬁne in a moment.
We have deﬁned two forms (a, b, c) and (a′, b′, c′) with integer entries to be
“properly equivalent” if there is a matrix
 α β
γ δ

in SL(2, Z) with

α
γ
β
δ
 
2a
b
b
2c
 
α
β
γ
δ

=

2a′
b′
b′
2c′

.
We say that two forms (a, b, c) and (a′, b′, c′) with rational entries are properly
equivalent over Q if there is a matrix
 α β
γ δ

in SL(2, Q) such that the displayed
equality holds.
For emphasis we can refer to the original notion as “proper
equivalence over Z” when it is advisable to be more speciﬁc. It is evident that if
two forms with rational entries are properly equivalent over Q, then their sets of
values at points (x, y) in Q × Q are the same.
Lemma 1.13. If (a, b, c) is a form with rational coefﬁcients and with non-
square discriminant D that takes on a nonzero value q ∈Q for some (x0, y0)
in Q × Q, then (a, b, c) is properly equivalent over Q to (q, 0, −D/(4q)).
Consequently two forms over Q of the same discriminant that take on a nonzero
value in common over Q are properly equivalent over Q.
PROOF. Suppose that ax2
0 + bx0y0 + cy2
0 = q. Put
 α
γ

=
 x0
y0

. Since x0
and y0 cannot both be 0, we can choose rationals β and δ such that αδ −βγ = 1.
Then
 α β
γ δ

has determinant 1 and satisﬁes
 α β
γ δ
 
1
0

=
 x0
y0

. The equality
ax2
0 + bx0y0 + cy2
0 = 1
2(x0 y0)

2a b
b 2c
  x0
y0

therefore yields
q = 1
2 ( 1
0 )

α
γ
β
δ
 
2a
b
b
2c
 
α
β
γ
δ
 
1
0

.
It follows that (a, b, c) is properly equivalent over Q to some form (q, b′, c′)
with b′ and c′ rational. Using a translation with a rational parameter, we see that
(q, b′, c′) is properly equivalent over Q to a form (q, 0, ∗). Inspection of the
discriminant shows that this last form must be (q, 0, −D/(4q)).
□
Two primitive integer forms having the same discriminant are said to be in
the same genus (plural: genera) if they are properly equivalent over Q. In view
of Lemma 1.13 the condition is that they are primitive and take on a common
nonzero value over Q, or equivalently that they are primitive and take on the same
set of values over Q. Thus x2 + 14y2 and 2x2 + 7y2 furnish an example of two

5. Genera
33
forms in distinct classes that are in the same genus. Two primitive integer forms
that are in the same proper equivalence class over Z are in the same genus. The
genus of the class C will be denoted by [C ]. The identity class will be denoted
by E, and P = [E ] is called the principal genus. If (a, b, c) is an integer form
representing a class C, then Theorem 1.12c shows that (a, −b, c) represents C−1.
On the other hand, C and C−1 take on the same values over Z, as we see by
replacing (x, y) by (x, −y), and it follows that [C ] = [C−1].
For the main theorem about genera, we shall introduce an extra hypothesis on
the discriminant D. A nonsquare integer D will be said to be a fundamental
discriminant if D is not divisible by the square of any odd prime and if when
D is even, D/4 is congruent to 2 or 3 modulo 4. It will be seen later that this
condition is equivalent to the requirement that D be the “ﬁeld discriminant” of
some quadratic number ﬁeld. Examples of discriminants that are not fundamental
are D = −12, −44, −108.
With this condition imposed on D, any integer form (a, b, c) of discriminant D
is automatically primitive. In fact, no odd prime p can divide GCD(a, b, c), since
then p2 would divide D. If 2 were to divide GCD(a, b, c), then (a/2, b/2, c/2)
would be an integer form, and D/4 = (b/2)2 −4(a/2)(c/2) would be an integer
congruent to 1 or 4 modulo 4.
Theorem 1.14. For a fundamental discriminant D, the principal genus P of
primitive integer forms8 is a subgroup of the form class group H, and the cosets
of P are the various genera. Thus the set G of genera is exactly the set of cosets
H/P and inherits a group structure from class multiplication. The subgroup P
coincides with the subgroup of squares in H, and consequently every nontrivial
element of G has order 2.
REMARKS. The group G is called the genus group of discriminant D. The
hypothesis that D is fundamental is needed only for the conclusion that every
member of P is a square in H. Since every nontrivial element of G has order
2 when D is fundamental, application of the Fundamental Theorem of Finitely
Generated Abelian Groups or use of vector-space theory over a 2-element ﬁeld
shows that G is the direct sum of cyclic groups of order 2; in particular, the order
of G is a power of 2. Problems 25–29 at the end of the chapter show that the
order of G is 2g, where g + 1 is the number of distinct prime factors of D.
PROOF. Let V (C ) denote the set of Q values assumed by forms in the class C
at points (x, y) in Q × Q. If S and S′ are two genera and if C is a class in S and
C′ is a class in S′, we deﬁne S · S′ = [CC′].
8As usual, we exclude the negative deﬁnite classes in the discussion.

34
I. Transition to Modern Number Theory
To see that this product operation is well deﬁned on the set G of genera, let C′′
be in S′ also. Then V (C′) = V (C′′). If q is in V (C ) and q′ is in V (C′) = V (C′′),
then the prescription for multiplying classes shows that qq′ is in V (CC′) and
V (CC′′). Hence V (CC′) = V (CC′′), and [CC′] = [CC′′]. Therefore multiplication
of genera is well deﬁned. Deﬁne a function ϕ : H →G by ϕ(C ) = [C ]. Then
the computation
ϕ(CC′) = [CC′] = [C][C′] = ϕ(C )ϕ(C′)
shows that ϕ is a homomorphism of H onto G. The kernel of ϕ is [C] = P, which
is therefore a subgroup, and the image of ϕ, which is the set G of genera with its
product operation, has to be a group.
For any class C, the equality [C ] = [C−1] implies that [C2] = [C ][C ] =
[C ][C−1] = [CC−1] = [E] = P. Hence P contains all squares. Conversely let C
be in P. Then C takes on the value 1 over Q. If (a, b, c) is a form in the class C,
then there exist rationals r and s with ar2 + brs + cs2 = 1. Clearing fractions,
we see that there exist integers x and y such that ax2 + bxy + cy2 = n2 for some
integer n ̸= 0. Without loss of generality, we may assume that n is positive.
Since (a, b, c) is primitive, a familiar argument allows us to make a substitution
for which the value n2 is taken on at (x, y) = (1, 0). In other words, (a, b, c)
is properly equivalent over Z to a form (n2, b′, c′) for suitable integers b′ and
c′. The composition formula in Proposition 1.9 shows that the composition of
(n, b′, c′n) with itself is (n2, b′, c′), and hence C is exhibited as the square of the
class of (n, b′, c′n). Since (n, b′, c′n) has the same discriminant D as (n2, b′, c′)
and therefore as (a, b, c) and since D is fundamental, (n, b′, c′n) is primitive.
Therefore C is the square of a class of primitive forms. If C is positive deﬁnite,
then the above choice of the sign of n as positive makes (n, b′, c′n) positive
deﬁnite. Hence the class of (n, b′, c′n) is in H.
□
EXAMPLE. The discriminant D = −56 is fundamental, and we have seen that
the form class group is of order 4 with representatives x2 + 14y2, 2x2 + 7y2, and
3x2 ± 2xy + 5y2. We have seen also that x2 + 14y2 and 2x2 + 7y2 both lie in the
principal genus P. A group of order 4 must be isomorphic to the cyclic group
C4 or to C2 × C2. In the ﬁrst case the subgroup of squares has order 2, and in the
second case the subgroup of squares has order 1. Since we have already found
two elements in P, P has order exactly 2. By the theorem we must be in the ﬁrst
case. Hence H is of type C4, and the genus group G is of type C2. It is possible to
check directly that 3x2 + 2xy + 5y2 has order 4 by making computations similar
to those for Problem 4d at the end of the chapter.

6. Quadratic Number Fields and Their Units
35
6. Quadratic Number Fields and Their Units
In this section we review material about quadratic number ﬁelds that appears in
various places in Basic Algebra, and we determine the units in the ring of integers
of such a number ﬁeld.
Quadratic number ﬁelds are extension ﬁelds K of Q with [K : Q] = 2. Such a
ﬁeld is necessarily of the form K = Q(√m ), where m is a uniquely determined
square-free integer not equal to 0 or 1. The set {1, √m } is a vector-space basis
of K over Q.
The extension K/Q is a Galois extension, and the Galois group Gal(K/Q)
of automorphisms of K ﬁxing Q has two elements. We denote the nontrivial
element of the Galois group by σ; its values on the members of the vector-space
basis are σ(1) = 1 and σ(√m ) = −√m.
The norm N = NK/Q and trace Tr = TrK/Q are given by N(α) = α ·σ(α) and
Tr(α) = α + σ(α). Thus N(a + b√m ) = a2 −mb2 and Tr(a + b√m ) = 2a.
These values are members of Q. The norm is multiplicative in the sense that
N(αβ) = N(α)N(β), and N(1) = 1.
The ring R of algebraic integers in K is the integral closure of Z in K. It works
out to be
R =
 Z[√m ]
if m ≡2 or 3 mod 4,
Z[ 1
2(√m −1)]
if m ≡1 mod 4
and is therefore a free abelian group of rank 2. The automorphism σ carries R to
itself. The norm and trace of any member of R are in Z; conversely any member
of K whose norm and trace are in Z is in R. We deﬁne the algebraic integer δ to
be given by
δ =
 −√m
if m ≡2 or 3 mod 4,
1
2(1 −√m )
if m ≡1 mod 4.
Then {1, δ} is a Z basis of R. The norm and trace of δ are given by
N(δ) = δ · σ(δ) =
 −m
if m ≡2 or 3 mod 4,
1
4(1 −m)
if m ≡1 mod 4,
Tr(δ) = δ + σ(δ) =
 0
if m ≡2 or 3 mod 4,
1
if m ≡1 mod 4.
There is a general notion of ﬁeld discriminant D, or absolute discriminant,
for an algebraic number ﬁeld, whose deﬁnition will be given in Chapter V. We
shall not give that deﬁnition in general now but will be content to give the formula
for D in the quadratic number ﬁeld Q(√m ), namely
D =
 4m
if m ≡2 or 3 mod 4,
m
if m ≡1 mod 4.

36
I. Transition to Modern Number Theory
The units of K are understood to be the members of the group R× of units in
the ring R. These are the members ε of R with N(ε) = ±1. In fact, if ε is a unit,
then the equality εε−1 = 1 implies that 1 = N(1) = N(εε−1) = N(ε)N(ε−1)
and shows that N(ε) is a unit in Z. Thus N(ε) = ±1. Conversely if N(ε) = ±1,
then ±εσ(ε) = 1 shows that σ(ε) = ±ε−1; since σ(ε) is in R, ε is exhibited as
in R× and is therefore a unit.
For m < 0, the units of Q(√m ) are easily determined. In fact, if ε = a + bδ
with a and b in Z, then N(ε) = (a + bδ)(a + bσ(δ)) = a2 + b Tr δ + b2N(δ)
with each term equal to an integer and with the end terms ≥0. Sorting out the
possibilities, we see that
R× =
⎧
⎪⎨
⎪⎩

± 1, ±√−1

if m = −1,

± 1, 1
2(±1 ±
√
−3 )

if m = −3,

± 1

for all other m < 0.
The respective orders of R× are 4, 6, and 2.
Determination of the units when m > 0 is more delicate. We require a lemma.
Lemma 1.15. If α is a real irrational number and if N > 0 is an integer, then
there exist integers A and B with
|Bα −A| < 1
N
and
0 < B ≤N.
For this A and this B,
α −A
B
 < 1
B2 .
PROOF. Put αn = nα −[nα], where [ · ] denotes the greatest-integer function.
Then 0 ≤αn < 1. We partition the half-open interval [0, 1) into N subintervals
 t−1
N , t
N

with 1 ≤t ≤N. For 0 ≤n ≤N, the expression αn takes on N + 1
distinct values because αn = αm would imply that (n −m)α is in Z. Hence
there exist αn and αm with n > m that lie in the same subinterval
 t−1
N , t
N

.
Then |αn −αm| <
1
N . If we take B = n −m and A = [nα] −[mα], then
|Bα −A| = |αn −αm|, and the inequality |Bα −A| < 1
N follows. Dividing this
inequality by B gives |α −A
B | <
1
BN , and this is ≤
1
B2 because N ≥B.
□
Proposition 1.16. For K = Q(√m ) with m > 0, the units are the members
of the inﬁnite group
R× =

(±1)εn
1 | n ∈Z
 ∼= Z × C2,
where ε1 is the fundamental unit, deﬁned as the least unit > 1.

6. Quadratic Number Fields and Their Units
37
REMARK. For example, when m = 2, the fundamental unit is ε1 = 1 +
√
2.
PROOF. The units ω with |ω| = 1 are ±1, since the members of K are real
numbers. We shall show shortly that there exists a unit ω with |ω| ̸= 1. Then ω or
ω−1 has absolute value> 1. Let us say that |ω| > 1. Then one of ω and −ω is > 1.
Let us say that ω > 1. Write ω = a + b√m, so that σ(ω) = a −b√m = ±ω−1
has |σ(ω)| < 1. Then
|2a| = |ω + σ(ω)| ≤|ω| + |σ(ω)| ≤|ω| + 1
|2b√m| = |ω −σ(ω)| ≤|ω| + |σ(ω)| ≤|ω| + 1
and
together show that there are only ﬁnitely many units ω′ with 1 < |ω′| < |ω|.
Hencetheexistenceofaunitω with|ω| ̸= 1impliestheexistenceofafundamental
unit ε1.
If ω′ is any unit > 1, then we can choose a power εn
1 of ε1 with εn+1
1
> ω′ ≥εn
1,
by the archimedean property of R. Then ω′ε−n
1
is a unit ≥1 with |ω′ε−n
1 | < ε1.
Since ε1 is fundamental, ω′ε−n
1
is 1, and thus ω′ = εn
1. Then it follows that the
group of units has the asserted form.
Thus we need to exhibit some unit ω with |ω| ̸= 1. We apply Lemma 1.15
with α = √m and with N arbitrary. Then we obtain inﬁnitely many pairs (A, B)
of integers with
√m −A
B
 <
1
B2 ≤1, hence with |A/B| < 1 + √m. For each
such pair (A, B), the member r = A −B√m of R has
|N(r)| =
(A + B√m)(A −B√m)
 =
 A
B −√m
 B2  A
B + √m

≤
1
B2 B2(1 + 2√m) = 1 + 2√m.
Thus there are inﬁnitely many r in R with |N(r)| ≤1 + 2√m. Since the norm
of an algebraic integer is in Z, there is some integer n such that inﬁnitely many
r ∈R have N(r) = n. Among the elements r ∈R with N(r) = n, which
we write as r = A + B√m with A and B in 1
2Z, we consider the ﬁnitely many
congruence classes of (A, B) modulo n, saying that two such (A, B) and (A′, B′)
are congruent if A −A′ and B −B′ are integers divisible by n. Since inﬁnitely
many r ∈R have N(r) = n, there must be inﬁnitely many of these in some
particular congruence class. Take three such, say α1, α2, and α3. Then
N(α1) = N(α2) = N(α3) = n
with
α1 −α2
n
in R
and
α1 −α3
n
in R.
Since n = N(α2) = α2σ(α2), we see that
α1
α2
= 1 +
α1 −α2
n

σ(α2).

38
I. Transition to Modern Number Theory
Thus α1/α2 is exhibited as in R, and it has N(α1/α2) = N(α1)/N(α2) = n/n =
1. Hence α1/α2 is a unit different from +1. Arguing similarly with α1/α3, we
see that α1/α3 is a unit different from +1 and not equal to α1/α2. Hence one of
α1/α2 and α1/α3 is a unit whose absolute value is not 1.
□
7. Relationship of Quadratic Forms to Ideals
We continue with K as the quadratic number ﬁeld Q(√m ) and R as the ring of
algebraic integers in K. Here R = Z[δ], where δ = −√m if m ≡2 or 3 mod 4
and δ = 1
2(1−√m ) if m ≡1 mod 4. Let D be the ﬁeld discriminant of Q(√m )
as deﬁned in Section 6.
The topic of this section is a relationship between nonzero ideals in R and
binary quadratic forms with discriminant D. Binary quadratic forms with D as
discriminant are automatically primitive.
The relationship is not a one-one correspondence of ideals to forms but a one-
one correspondence of a certain kind of equivalence class of ideals to proper
equivalence classes of forms. We saw in Theorem 1.12 that the latter collection
has the structure of a ﬁnite abelian group, and we shall see in this section that the
former collection has the natural structure of a ﬁnite abelian group as well. The
correspondence is a group isomorphism, according to Theorem 1.20 below.
Consider nonzero ideals I in R. The ﬁrst observation is that I is additively a
free abelian group of rank 2. In fact, R itself is additively a free abelian group of
rank 2, and the additive subgroup I has to be free abelian of rank ≤2. If r is a
nonzero element in I, then N(r) = rσ(r) is in I, and thus I contains a nonzero
integer. If n is an integer in I, then n√m is in I, and thus I contains a noninteger.
Therefore I is a free abelian group of rank exactly 2, as asserted.
Certainly I can then be generated as an ideal by two elements, and our cus-
tomary notation has been to write I = (r1,r2) in this case. However, without an
extra condition on them, the two ideal generators need not together be a Z basis
for I because they need not generate all of I additively. It will be helpful to have
separate notation when the generators are known to give a Z basis. Accordingly
we shall write I = ⟨r1,r2⟩when r1,r2 give a Z basis of I. In this case it will
be helpful also to regard the set {r1,r2} as ordered with r1 preceding r2, and we
shall often do so.
Now suppose that I = ⟨r1,r2⟩is a nonzero ideal, and consider the expression
r1σ(r2) −σ(r1)r2 = det

r1
σ(r1)
r2
σ(r2)

.
If I is written in terms of a second ordered Z basis as I = ⟨s1, s2⟩, then the two

7. Relationship of Quadratic Forms to Ideals
39
ordered bases are related by a matrix
 α β
γ δ

in GL(2, Z), the relationship being

r1
r2

=

α
β
γ
δ
 
s1
s2

.
Hence

r1
σ(r1)
r2
σ(r2)

=

α
β
γ
δ
 
s1
σ(s1)
s2
σ(s2)

,
and therefore
det

r1
σ(r1)
r2
σ(r2)

= ± det

s1
σ(s1)
s2
σ(s2)

,
where ±1 is the determinant of
 α β
γ δ

. Consequently the expression
N(I) = |r1σ(r2) −σ(r1)r2|
|
√
D |
,
where D is the ﬁeld discriminant of K, is independent of the choice of Z basis.
It is called the norm of the ideal I. The factor of
√
D in the denominator is a
normalization factor that arranges for the norm of the ideal I = R to be 1; in fact,
we can write R = ⟨1, δ⟩with δ as in the ﬁrst paragraph of this section, and then
N(R) = |σ(δ) −δ|
|
√
D |
=
 |√m+√m |
|
√
4m |
if m ≡2 or 3 mod 4
| 1
2 (1+√m )−1
2 (1−√m )|
|√m |
if m ≡1 mod 4

= 1.
Since the norm of an element of R is given by N(r) = rσ(r), it is immediate
from the deﬁnition that
N(r I) = |N(r)|N(I)
for r ∈R.
Consequently the norm of the principal ideal (r) is given by
N((r)) = |N(r)|N(R) = |N(r)|1 = |N(r)|
for r ∈R.
Still with I = ⟨r1,r2⟩, let us observe that
σ

r1σ(r2) −σ(r1)r2

= −

r1σ(r2) −σ(r1)r2

.
It follows that
r1σ(r2) −σ(r1)r2
is
 real
if m > 0,
imaginary
if m < 0.

40
I. Transition to Modern Number Theory
Since r1σ(r2) −σ(r1)r2 changes sign when r1 and r2 are interchanged, let us say
that the expression I = ⟨r1,r2⟩for I is positively oriented if r1σ(r2) −σ(r1)r2
is positive or positive imaginary,9 negatively oriented if r1σ(r2) −σ(r1)r2 is
negative or negative imaginary. If I = ⟨r1,r2⟩, then exactly one of the expressions
I = ⟨r1,r2⟩and I = ⟨r2,r1⟩is positively oriented. The notion of orientation will
be critical to setting up the correspondence between classes of ideals and classes
of forms.
The set of nonzero ideals of R has a commutative associative multiplication
that was introduced in Basic Algebra: if I and J are nonzero ideals, then I J is
deﬁned to be the set of sums of products from the two ideals, the product I J
again being an ideal. Later in this section we shall recall some properties of this
multiplication that were proved in Basic Algebra.
We deﬁne two equivalence relations on the set of nonzero ideals of I. We say
that I and J are equivalent if there exist nonzero r and s in R with (r)I = (s)J.
Here (r) and (s) are understood to be principal ideals. The ideals I and J are
strictly equivalent, or narrowly equivalent, if equivalence occurs and if r and
s can be chosen with N(rs−1) > 0. Both relations are certainly reﬂexive and
symmetric. To see transitivity, let (r1)I1 = (r2)I2 and (s2)I2 = (s3)I3. Then
(r1s2)I1 = (r2s2)I2 = (r2s3)I3, and I1 is equivalent to I3. If also N(r1r−1
2 ) > 0
and N(s2s−1
3 ) > 0, then the product N((r1s2)(r2s3)−1) is positive, and I1 is
strictly equivalent to I3. In other words, “equivalent” and “strictly equivalent”
are equivalence relations.
The principal ideals form one full equivalence class under “equivalent.” First
of all, (r) is equivalent to (s) because (s)(r) = (rs) = (r)(s). In the reverse
direction, if I and (1) are equivalent, let (r)I = (s). Then there exists x ∈I with
rx = s. Hence sr−1 is in I, and (sr−1) ⊆I. In fact, equality holds: if y is in I,
then the equality ry = sz with z in R says that y = (sr−1)z, and y is in (sr−1).
In other words, I = (sr−1).
In a sense, therefore, equivalence of ideals measures the extent to which
nonprincipal ideals exist.
Multiplication is a class property of ideals relative to equivalence and to
strict equivalence. In fact, if (r)I = (r′)I ′ and (s)J = (s′)J ′, then (rs)I J =
(r′s′)I ′J ′, and the assertion follows.
The theorem will be that multiplication of strict equivalence classes of ideals
of R makes the set of such classes into an abelian group that is isomorphic to the
ﬁnite abelian form class group of discriminant D. This result is not as beautiful as
one might hope, since the identity class of ideals under strict equivalence need not
match the set of all principal ideals. However, we can quantify the discrepancy.
The relevant result is as follows.
9If m < 0, we adopt the convention that √m is positive imaginary.

7. Relationship of Quadratic Forms to Ideals
41
Proposition 1.17. Equivalence and strict equivalence are the same for ideals
of R if and only if either
(a) m > 0 and the fundamental unit ε1 has N(ε1) = −1 or
(b) m < 0.
In the contrary case when m > 0 and the fundamental unit ε1 has N(ε) = +1, a
nonzero principal ideal (r) is strictly equivalent to (1) if and only if N(r) > 0;
in particular, the principal ideal (√m ) is not strictly equivalent to (1).
REMARKS. When m > 0, there are examples with N(ε1) = +1 and examples
with N(ε1) = −1.
Speciﬁcally when m = 2, ε1 = 1 +
√
2, and this has
N(ε1) = −1. When m > 0 and m has any odd prime divisor p with p ≡
3 mod 4, then N(ε1) = +1; in fact, otherwise ε1 = x + y√m would imply that
−1 = N(ε1) = x2−my2 and therefore that −1 ≡x2 mod p, but this congruence
has no solutions by Theorem 1.2a.
PROOF. Suppose that m > 0 and N(ε1) = −1. If (r)I = (s)J with N(rs−1) <
0, then (ε1r)I = (s)J with N(ε1rs−1) > 0. Thus equivalence implies strict
equivalence in this case.
Suppose that m < 0. Then all norms of nonzero elements are > 0. Hence
N(rs−1) > 0 is an empty condition, and equivalence implies strict equivalence.
Conversely suppose that m > 0 and N(ε1) = +1. Proposition 1.16 shows that
the most general unit is ε = ±εn
1, and consequently N(ε) = N(±1)N(ε1)n = +1
for every unit. The element √m is in R, and N(√m ) = −m < 0. We know
that the principal ideals (1) and (√m ) are equivalent. Arguing by contradiction,
suppose that they are strictly equivalent. Then (r) = (r)(1) = (s)(√m ) =
(s√m ) for some r and s with N(rs−1) > 0. Since the principal ideals generated
byr and s√m are the same, these elements must be related byr = εs√m for some
unit ε. Then N(rs−1) = N(ε√m ) = N(ε)N(√m ) = −m < 0, contradiction.
The proposition follows.
□
Once we have introduced group structures on the set of equivalence classes of
ideals and the set of strict equivalence classes of ideals, it follows that the map that
carries a strict equivalence class to the equivalence class containing it is a group
homomorphism onto. If either of the conditions (a) and (b) in Proposition 1.17
is satisﬁed, then this homomorphism is one-one. Otherwise its kernel consists of
the two strict equivalence classes of principal ideals—those whose generator has
positive norm and those whose generator has negative norm.
At this point we could establish that the set of strict equivalence classes of ideals
is a ﬁnite abelian group. The ﬁniteness of the set of strict equivalence classes
could be established directly by a geometric argument we give in Chapter V,
and the group structure could be derived from the group structure on the set of
“fractional ideals” of K that were introduced in Problems 48–53 at the end of
Chapter VIII of Basic Algebra.

42
I. Transition to Modern Number Theory
Although we could proceed with proofs along these lines, it is instructive to
proceed in a different way. Rather than give a stand-alone proof of the ﬁniteness
of the number of strict equivalence classes of ideals, we prefer to derive this
ﬁniteness as part of the correspondence with proper equivalence classes of binary
quadratic forms, since the number of such classes of binary quadratic forms has
already been proved to be ﬁnite in Theorem 1.6a. The group structure then readily
follows from this ﬁniteness and the fact that R is a Dedekind domain.
Let us pause for a moment, therefore, to use results we already know in order
to show how the group structure on the set of strict equivalence classes follows
once it is known that there are only ﬁnitely many such classes. We know from
Theorems 8.54 and 8.55 of Basic Algebra that R is a Dedekind domain and that
R has unique factorization for its nonzero ideals. In other words, in terms of the
already-deﬁned multiplication of ideals, each nonzero ideal I in R is of the form
I = k
j=1 P
nj
j , where the Pj are distinct nonzero prime ideals, the nj are positive
integers, and k is ≥0; moreover, this product expansion is unique up to the order
of the factors.
Lemma 1.18. Let H be the set of strict equivalence classes of nonzero ideals
in R, with its inherited commutative associative multiplication. If H is ﬁnite,
then H is a group under this multiplication.
REMARKS. The group H will be seen in Theorem 1.20 to be isomorphic to the
form class group of D. The set of ordinary equivalence classes is a quotient and
is called the ideal class group of K. It will be generalized in Chapter V.
PROOF. The identity element of H is the strict equivalence class of the ideal
R = (1), and we are to prove the existence of inverses. Thus let I be given. For
the sequence of ideals I, I 2, I 3, . . . , the ﬁniteness of H shows that two of these
ideals must be strictly equivalent. Suppose that I k is equivalent to I k+l for some
k > 0 and l > 0. Then there exist nonzero principal ideals (r) and (s) such that
(r)I k = (s)I k+l. The uniqueness of factorization of ideals implies that we can
cancel I k from both sides of this equality, thereby obtaining (r) = (s)I l. Let us
deﬁne an element t in R. If N(rs−1) > 0, we take t to be 1. Otherwise m must
be positive, and we let t = √m, so that N(t) < 0. In both cases we then have
(rt)(1) = (s)(t)I l with N(rts−1) > 0, and the ideal (t)I l is strictly equivalent
to (1). Hence the strict equivalence class of (t)I l−1 is an inverse to the strict
equivalence class of I, and H is a group.
□
Now we deﬁne the mappings F and I that we shall use to establish the main
result of this section. Let I be a nonzero ideal in R, and suppose that I is given
by an expression I = ⟨r1,r2⟩that is positively oriented. We regard x and y as
integer variables. To I, we associate the binary quadratic form
F(I,r1,r2) = N(I)−1N(r1x + r2y) = N(I)−1(r1x + r2y)(σ(r1)x + σ(r2)y).

7. Relationship of Quadratic Forms to Ideals
43
The associated 2-by-2 matrix for this form is
1
N(I)

2r1σ(r1)
r1σ(r2) + r2σ(r1)
r1σ(r2) + r2σ(r1)
2r2σ(r2)

=
1
N(I)

r1
σ(r1)
r2
σ(r2)
 
σ(r1)
σ(r2)
r1
r2

,
and the discriminant of the quadratic form is therefore
−det

1
N(I)

r1
σ(r1)
r2
σ(r2)
 
σ(r1)
σ(r2)
r1
r2
 
= N(I)−2
r1σ(r2) −σ(r1)r2
2
= |D|

r1σ(r2) −σ(r1)r2
2
r1σ(r2) −σ(r1)r2
2
= |D|(sgn m) = D.
Thus we have associated a quadratic form F(I,r1,r2) of discriminant D to an
ideal I when I is given by a positively oriented expression I = ⟨r1,r2⟩. If
m < 0, this quadratic form is positive deﬁnite because the coefﬁcient of x2,
namely N(I)−1r1σ(r1) = N(I)−1N(r1), is positive when m < 0.
In the reverse direction we associate to an arbitrary form (a, b, c) of dis-
criminant D an ideal I = I(a, b, c) given by a positively oriented expression
⟨r1,r2⟩. To begin with, if b is an integer with b ≡D mod 2, let us deﬁne b′
to be 1
2b if D ≡0 mod 4 and to be 1
2(b −1) if D ≡1 mod 4; in other words,
b′ = 1
2(b −Tr(δ)) in both cases. The deﬁnition of I is to be
I(a, b, c) =
 ⟨a, b′ + δ⟩
if a > 0,
⟨δa, δ(b′ + δ)⟩
if a < 0.
The right sides in the above display make sense as ideals if the angular brackets
are replaced by parentheses. To see that the deﬁnitions make sense, we thus need
to check that (a, b′ + δ) = ⟨a, b′ + δ⟩for all a and that the orientations are
positive. Lemma 1.19a below shows that (a, b′ + δ) = ⟨a, b′ + δ⟩if it is proved
that a divides N(b′ + δ), and the computation that veriﬁes this equality is
N(b′ + δ) = b′2 + b′(δ + σ(δ)) + δσ(δ)
=
 b′2 + b′ + 1
4(1 −m)
if D ≡1 mod 4,
b′2 −m
if D ≡0 mod 4,
=
 1
4(b −1)2 + 1
2(b −1) + 1
4(1 −D)
if D ≡1 mod 4,
1
4b2 −1
4 D
if D ≡0 mod 4,
= 1
4(b2 −D)
= ac.

44
I. Transition to Modern Number Theory
From the deﬁnitions near the beginning of this section, the orientation of ⟨r1,r2⟩
is given by the sign of (√m )−1
r1σ(r2) −σ(r1)r2

. Thus
orientation⟨a, b′ + δ⟩= sgn

(√m )−1a(σ(δ) −δ)

= sgn a,
orientation⟨δa, δ(b′ + δ)⟩= sgn

(√m )−1
δaσ(δb′ + δ2) −σ(δ)aδ(b′ + δ)

= sgn

(√m )−1N(δ)a(σ(δ) −δ)

= −sgn a,
and the orientations are positive in both cases.
Lemma 1.19.
(a) If a ̸= 0 and b′ are integers such that a divides N(b′ + δ) in Z, then
(a, b′ +δ) = ⟨a, b′ +δ⟩in the sense that the free abelian subgroup of R generated
by a and b′ + δ coincides with the ideal generated by a and b′ + δ.
(b) If I is any nonzero ideal in R, then I is of the form I = ⟨a,r⟩for some
integer a > 0 and some r in R.
PROOF. For (a), we are to show that I ′ = Za + Z(b′ + δ) is closed under
multiplication by the generators 1 and δ of R. Closure of I ′ under multiplication
by 1 is evident, and the formula δa = −b′a + a(b′ + δ) shows that δ(Za) ⊆I ′.
Addition of δb′ to the sum of the two formulas δ2 = δ(δ + σ(δ)) −δσ(δ) =
δ Tr(δ) −N(δ) and N(b′ + δ) = b′2 + b′ Tr(δ) + N(δ) yields
δ(b′ + δ) = −N(b′ + δ) + (b′ + Tr(δ))(b′ + δ),
which shows that δ(b′ + δ) ⊆I ′ because N(b′ + δ) is by assumption an integer
multiple of a.
For (b), we start from any Z basis {r1,r2} of I, say with r1 = a1 + b1δ and
r2 = a2 + b2δ, and let d = GCD(b1, b2). Choose integers n1 and n2 with
n1b1 + n2b2 = d. Then GCD(n1, n2) = 1, and we can therefore ﬁnd integers
k1 and k2 with det
 k1 k2
n1 n2

= 1. Consequently
 s1
s2

=
 k1 k2
n1 n2
  r1
r2

is a new Z
basis of I of the form
s1 = c1 + kdδ,
s2 = c2 + dδ.
If we put a = s1 −ks2 and possibly replace a by its negative, then {a, s2} is a Z
basis of I of the required form.
□
Theorem 1.20. The set H of strict equivalence classes of nonzero ideals
relative to the ﬁeld K = Q(√m ) is a ﬁnite abelian group. Moreover, the mapping
F that carries a positively oriented expression I = ⟨r1,r2⟩for a nonzero ideal
of R to a binary quadratic form depends only on I, not the ordered Z basis, and

7. Relationship of Quadratic Forms to Ideals
45
descends to an isomorphism of the group H onto the form class group H for
the discriminant D of the ﬁeld K, i.e., the group of proper equivalence classes of
binary quadratic forms of discriminant D, subject to the remark below. Moreover,
the mapping I with domain all binary quadratic forms whose discriminant equals
the ﬁeld discriminant of K, sending such a form to a positively oriented expression
for a nonzero ideal of R, descends to be deﬁned from H to H, and the descended
map is the two-sided inverse of the isomorphism induced by F.
REMARK. If m < 0, H is understood as usual to include only the classes of
the positive deﬁnite forms.
PROOF. The proof proceeds in six steps.
Step 1.
We show that the proper equivalence class of the quadratic form
F(I,r1,r2) depends only on the ideal I, not the positively oriented expression
I = ⟨r1,r2⟩for it. Thus the class of the form can be abbreviated as F(I).
Suppose that I = ⟨s1, s2⟩is another positively oriented expression for I. Then
we can write
 r1
r2

=
 α β
γ δ
  s1
s2

for a matrix
 α β
γ δ

in GL(2, Z), and we have
seen that
 r1 σ(r1)
r2 σ(r2)

=
 α β
γ δ
  s1 σ(s1)
s2 σ(s2)

,
(∗)
and that
det
 r1 σ(r1)
r2 σ(r2)

= ± det
 s1 σ(s1)
s2 σ(s2)

,
where ±1 is the determinant of
 α β
γ δ

. Since both expressions I = ⟨r1,r2⟩and
I = ⟨s1, s2⟩are positively oriented, it follows that the sign in the determinant
equation is plus, hence that
 α β
γ δ

is in SL(2, Z). Substituting from (∗) into the
formula for the matrix associated to the binary quadratic form F(I,r1,r2), we
obtain the matrix
N(I)−1  α β
γ δ
  s1 σ(s1)
s2 σ(s2)
 
σ(s1) σ(s2)
s1
s2
  α γ
β δ

.
(∗∗)
The product of the coefﬁcient N(I)−1 and the middle two matrices is the matrix
associated to the quadratic form F(I, s1, s2), and (∗∗) therefore exhibits the two
quadratic forms as properly equivalent.
Step 2. We show that the proper equivalence class F(I) does not change when
we replace I by a strictly equivalent ideal.
Thus let I = ⟨r1,r2⟩and J = ⟨s1, s2⟩be expressions for I and J, and
suppose that (r) and (s) are nonzero principal ideals such that (r)I = (s)J
and N(s/r) > 0. The formula
det
 rr1 σ(rr1)
rr2 σ(rr2)

= rσ(r) det
 r1 σ(r1)
r2 σ(r2)

= N(r) det
 r1 σ(r1)
r2 σ(r2)


46
I. Transition to Modern Number Theory
shows that the expression (r)I = ⟨rr1,rr2⟩is positively oriented if N(r) > 0
and is negatively oriented if N(r) < 0. Similarly (s)J = ⟨ss1, ss2⟩is positively
oriented if N(s) > 0 and is negatively oriented if N(s) < 0. Since N(r/s) > 0,
N(r) and N(s) are both positive or both negative. Possibly replacing r and s by
r√m and s√m, we may assume that N(r) and N(s) are both positive. Then the
matrix associated to the quadratic form F((r)I,rr1,rr2) is
N(r I)−1 
rr1 σ(rr1)
rr2 σ(rr2)
 
σ(rr1) σ(rr2)
rr1
rr2

= N(r I)−1 
r1 σ(r1)
r2 σ(r2)
  r
0
0 σ(r)
  σ(r) 0
0
r
 
σ(r1) σ(r2)
r1
r2

= N(r I)−1N(r)

r1 σ(r1)
r2 σ(r2)
 
σ(r1) σ(r2)
r1
r2

= |N(r)|−1N(I)−1N(r)

r1 σ(r1)
r2 σ(r2)
 
σ(r1) σ(r2)
r1
r2

= N(I)−1 
r1 σ(r1)
r2 σ(r2)
 
σ(r1) σ(r2)
r1
r2

,
while the matrix associated to F((s)J, ss1, ss2), by a similar computation, is
N(J)−1  s1 σ(s1)
s2 σ(s2)
 
σ(s1) σ(s2)
s1
s2

.
Since (r)I = (s)J, Step 1 shows that F((r)I,rr1,rr2) is properly equivalent to
F((s)J, ss1, ss2).
Step 3. We show that I(a, b, c) depends only on the proper equivalence class
of the binary quadratic form (a, b, c).
Problem 37 at the end of Chapter VII of Basic Algebra shows that SL(2, Z)
is generated by α =

0 −1
1
0

and β =

0
1
−1 −1

, hence by αβ =

1 1
0 1

and
α−1 =

0 1
−1 0

. Thus it is enough to handle αβ and α−1.
The operation of αβ =

1 1
0 1

on forms sends (a, b, c) into the translate
(a, b +2a, ∗). Deﬁne b′ = 1
2(b −Tr(δ)) in the same way as when I was deﬁned.
If a > 0, then I(a, b, c) = (a, b′ +δ), and I(a, b+2a, ∗) = (a, (b+2a)′ +δ) =
(a, b′+a+δ); thus the two image ideals are the same. Ifa < 0, then the respective
images are (δ)(a, b′ + δ) and (δ)(a, b′ + a + δ), and again the image ideals are
the same.
To handle α−1 =

0 1
−1 0

, we are to show that the ideals I(a, b, c) and
I(c, −b, a) are strictly equivalent. We saw just after the deﬁnition of I that
N(b′ + δ) = ac. There are four cases to the proof of the strict equivalence
according to the signs of a and c. Let us use the symbol ∼to denote “is strictly
equivalent to.”

7. Relationship of Quadratic Forms to Ideals
47
Suppose that a > 0 and c > 0, so that N(b′ + δ) > 0. Then
I(a, b, c) = (a, b′ + δ) ∼(b′ + σ(δ))(a, b′ + δ) = (a(b′ + σ(δ)), N(b′ + δ))
= (a(b′ + σ(δ)), ac) = (a)(b′ + σ(δ), c)
∼(c, b′ + σ(δ)) = (c, −b′ −σ(δ)) = (c, (−b)′ + δ),
the last equality holding because b′ + (−b)′ = −Tr δ = −δ −σ(δ). The right
side equals I(c, −b, a), and the strict equivalence is proved in this case.
Suppose that a < 0 and c < 0, so that N(b′ + δ) > 0. Then
I(a, b, c) = (δ)(a, b′ + δ) ∼(b′ + σ(δ))(δ)(a, b′ + δ)
= (δ)(a(b′ + σ(δ)), N(b′ + δ)) = (δ)(a(b′ + σ(δ)), ac)
= (a)(δ)(b′ + σ(δ), c) ∼(δ)(c, b′ + σ(δ))
= (δ)(c, −b′ −σ(δ)) = (δ)(c, (−b)′ + δ) = I(c, −b, a),
and the strict equivalence is proved in this case.
Suppose that a > 0 and c < 0, so that N(b′ + δ) < 0. Then N(δ)N(b′ + δ)
is positive, and
I(a, b, c) = (a, b′ + δ) ∼(δ)(b′ + σ(δ))(a, b′ + δ)
= (δ)(a(b′ + σ(δ)), N(b′ + δ)) = (δ)(a(b′ + σ(δ)), ac)
= (a)(δ)(b′ + σ(δ), c) ∼(δ)(c, b′ + σ(δ)) = (δ)(c, −b′ −σ(δ))
= (δ)(c, (−b)′ + δ) = I(c, −b, a),
and the strict equivalence is proved in this case.
Suppose that a < 0 and c > 0, so that N(b′ + δ) < 0. Then N(δ)−1N(b′ + δ)
is positive, and
I(a, b, c) = (δ)(a, b′ + δ) ∼(b′ + σ(δ))(a, b′ + δ)
= (a(b′ + σ(δ)), N(b′ + δ))=(a(b′ + σ(δ)), ac)=(a)(b′ + σ(δ), c)
∼(c, −b′ −σ(δ)) = (c, (−b)′ + δ) = I(c, −b, a),
and the strict equivalence is proved in this case.
Step 4. We show that the mapping of the set H of proper equivalence classes
of forms to itself induced by F I is the identity.
Let the given form be (a, b, c). With b′ deﬁned to be 1
2(b −Tr(δ)) as usual,
we have seen that N(b′ + δ) = ac. Therefore a divides N(b′ + δ), and Lemma
1.19a shows that (a, b′ + δ) = ⟨a, b′ + δ⟩in the sense that the ideal generated by
a and b′ + δ matches the free abelian group generated by these two elements.

48
I. Transition to Modern Number Theory
First suppose that a > 0. Then I(a, b, c) = (a, b′ + δ) = ⟨a, b′ + δ⟩, and we
know that this expression is positively oriented. Calculation gives
N(I) = |
√
D |
−1 det

a
a
b′+δ b′+σ(δ)
 
= a|
√
D |
−1|σ(δ) −δ)|
= a ×
 |√m |

|√m |
if D ≡1 mod 4,
2|√m |

|
√
4m |
if D ≡0 mod 4,
= a.
(†)
Therefore the quadratic form F I(a, b, c) is
N(I)−1(ax + (b′ + δ)y)(ax + (b′ + σ(δ))y)
= a−1
a2x2 + a

2b′ + (δ + σ(δ))

xy + N(b′ + δ)y2
= ax2 +

2b′ + Tr(δ)

xy + cy2
= ax2 + bxy + cy2,
and we see that F I(a, b, c) = (a, b, c) when a > 0.
Next suppose that a < 0. Then I(a, b, c) = (δa, δ(b′ +δ)) = ⟨δa, δ(b′ +δ)⟩,
and we know that this expression is positively oriented. Since a < 0 cannot occur
for m < 0, N(δ) is negative. Thus calculation gives
N(I) = N((δ)(a, b′ + δ)) = N((δ)(−a, b′ + δ)) = |N(δ)|N((−a, b′ + δ))
= |N(δ)||a| = N(δ)a,
the next-to-last equality following from the calculation that gives (†). Therefore
the quadratic form F I(a, b, c) is
N(I)−1(aδx + (b′ + δ)δy)(aσ(δ)x + (b′ + σ(δ))σ(δ)y)
= N(I)−1N(δ)(ax + (b′ + δ)y)(ax + (b′ + σ(δ))y)
= a−1
a2x2 + a

2b′ + (δ + σ(δ))

xy + N(b′ + δ)y2
= ax2 +

2b′ + Tr(δ)

xy + cy2
= ax2 + bxy + cy2,
and we see that F I(a, b, c) = (a, b, c) when a < 0.

7. Relationship of Quadratic Forms to Ideals
49
Step 5. We show that the mapping of the set H of strict equivalence classes of
ideals to itself induced by I F is the identity. In view of Step 4, it follows that F
and I are both one-one onto. Since Theorem 1.6a shows H to be ﬁnite, H has to
be ﬁnite, and Lemma 1.18 shows that the multiplication on H makes H into an
abelian group.
Let an ideal I be given, and apply Lemma 1.19b to write I = ⟨a,r⟩witha > 0
an integer. The expression deciding orientation isaσ(r)−σ(a)r = a(σ(r)−r),
and this is multiplied by −1 if r is replaced by −r. Possibly changing r to −r in
the expression for I, we may therefore assume that the expression I = ⟨a,r⟩is
positively oriented. Write r = c + dδ. Then
σ(r) −r = d(σ(δ) −δ) =

2d√m
if m ≡2 or 3 mod 4
d√m
if m ≡1 mod 4

= d
√
D.
The orientation of I is given bya(σ(r)−r) = ad
√
D, and we deduce that d > 0
and that
N(I) = |
√
D |−1a|σ(r) −r| = ad.
The deﬁnition ofF gives F(I,a,r) = N(I)−1N(ax+ry), which is a quadratic
form whose x2 coefﬁcient is a = N(I)−1a 2 = d−1a and whose xy coefﬁcient is
b = N(I)−1a Tr(r) = d−1 Tr(r) = d−1(2c + d Tr(δ)) = 2d−1c + Tr(δ).
With b′ deﬁned as usual to be b′ =
1
2(b −Tr(δ)), we see that b′ = d−1c.
Consequently I F(I,a,r) = (a, b′ + δ) = (d−1a, d−1c + δ). The product of
this ideal with (d) is (a, c + dδ) = (a,r) = I, and thus I F(I,a,r) is strictly
equivalent to I.
Step 6. We show that the mapping induced by I from the set H of proper
equivalence classes of forms to the set H of strict equivalence classes of ideals
respects the group operations in H and H and hence is an isomorphism.
Let two proper equivalence classes of forms with discriminant D be given,
and use Theorem 1.12a to choose representatives (a, b, c) and (a, b,c ) with
GCD(a,a) = 1. The composition of the forms is well deﬁned and is (aa, b, ∗)
for a suitable third entry in Z. Let b′ be 1
2(b −Tr(δ)) as usual. We divide matters
into cases according to the signs of a and a.
Suppose that a > 0 and a > 0. The deﬁnition of I shows that the ideals
corresponding to the three quadratic forms in question are
(a, b′ + δ),
(a, b′ + δ),
and
(aa, b′ + δ).
The product of the ﬁrst two ideals is

aa, a(b′ + δ),a(b′ + δ), (b′ + δ)2
, and we
are to show that this equals (aa, b′ + δ). In fact, the inclusion

aa, a(b′ + δ),a(b′ + δ), (b′ + δ)2
⊆(aa, b′ + δ)

50
I. Transition to Modern Number Theory
is clear. For the reverse inclusion we use the fact that GCD(a,a ) = 1 to write
k1a + k2a = 1 for suitable integers k1 and k2. Then we see that b′ + δ =
k1(a(b′ + δ)) + k2(a(b′ + δ)), and the reverse inclusion follows.
Suppose that a and a are of opposite sign. By symmetry we may assume that
a > 0 and a < 0. The three ideals are then
(a, b′ + δ),
(aδ, (b′ + δ)δ),
and
(aaδ, (b′ + δ)δ),
whiletheproductoftheﬁrsttwoidealsis

aaδ, a(b′+δ)δ,a(b′+δ)δ, (b′+δ)2δ

=
(δ)

aa, a(b′ + δ),a(b′ + δ), (b′ + δ)2
. From the previous paragraph this last
ideal equals (δ)(aa, b′ + δ) = (aaδ, (b′ + δ)δ), and we have the required match.
Suppose that a < 0 and a < 0. This time the product ideal is given by
(aδ, (b′ + δ)δ)(aδ, (b′ + δ)δ) = (δ2)

aa, a(b′ + δ),a(b′ + δ), (b′ + δ)2
=
(δ2)(aa, b′ + δ), the second equality following from the computation in the
paragraph fora anda both positive. The ideal(δ2)(aa, b′+δ) is strictly equivalent
to (aa, b′ + δ) because N(δ2) = N(δ)2 is positive. Thus we have the required
match on the level of strict equivalence classes. We conclude that the mapping
of H to H is a group isomorphism.
□
8. Primes in the Progressions 4n + 1 and 4n + 3
This section is the ﬁrst of three sections about Dirichlet’s Theorem on primes in
arithmetic progressions, whose statement is as follows.
Theorem 1.21 (Dirichlet’s Theorem). If m and b are relatively prime integers
with m > 0, then there exist inﬁnitely many primes of the form km + b with k a
positive integer.
We begin with the earlier treatment of the arithmetic progressions 4n + 1 and
4n + 3 by Euler. In 1737 Euler made the stunning discovery of the formula
∞

n=1
1
ns =

p prime
1
1 −p−s ,
valid for s > 1. Actually, the formula is valid for complex s with Re s > 1, but
Euler had not considered powers ns with s complex by this time and did not need
them for his purpose. Euler’s formula is a consequence of unique factorization
of integers. In fact, the product for p ≤N is

p≤N
1
1 −p−s =

p≤N

1 + 1
ps + 1
p2s + · · ·

=

n with
no prime
divisors >N
1
ns .

8. Primes in the Progressions 4n + 1 and 4n + 3
51
Letting N →∞, we obtain the desired formula.
Built into the formula is the result of Euclid’s that there are inﬁnitely many
primes, i.e., inﬁnitely many primes in the arithmetic progression n. There are
two ways to see this. In both cases one starts from the observation that the sum
	∞
n=1 1/ns is ≥
 ∞
1 (1/xs) dx = 1/(s −1), from which it follows that the sum
tends to inﬁnity as s decreases to 1. In one case the argument continues with the
observationthatiftherewereonlyﬁnitelymanyprimes, then
p prime
1
1−p−s would
certainly have ﬁnite limit as s decreases to 1, and we arrive at a contradiction.
In the other case the argument continues with the observation that the logarithm
of
1
1−p−s is comparable in size to 1/ps, hence that log 	∞
n=1 1/ns is comparable
to 	
p prime 1/ps. Since 	∞
n=1 1/ns tends to inﬁnity, 	
p prime 1/ps must tend to
inﬁnity, and we conclude that there are inﬁnitely many primes. We shall return
to this observation shortly in order to justify it more rigorously.10
Euclid’s proof was much simpler: if there were only ﬁnitely many primes,
then the sum of 1 and the product of all the primes would be divisible by none of
the primes and would give a contradiction. The difﬁculty with Euclid’s argument
is that there is no apparent way to adapt it to treat primes of the form 4n + 1.
Euler’s argument, by contrast, does adapt to treat primes 4n + 1.
Before continuing, let us make rigorous the notion of comparing sizes of factors
of an inﬁnite product with terms of an inﬁnite series. An inﬁnite product ∞
n=1 cn
with cn ∈C and with no factor 0 is said to converge if the sequence of partial
products converges to a ﬁnite limit and the limit is not 0. A necessary condition
for convergence is that cn tend to 1.
Proposition 1.22. If |an| < 1 for all n, then the following conditions are
equivalent:
(a) ∞
n=1(1 + |an|) converges,
(b) 	∞
n=1 |an| converges,
(c) ∞
n=1(1 −|an|) converges.
In this case, ∞
n=1(1 + an) converges.
PROOF. Condition (c) is equivalent to
(c′) ∞
n=1(1 −|an|)−1 converges.
For each of (a), (b), and (c′), convergence is equivalent to boundedness above.
Since
1 +
N	
n=1
|an| ≤
N
n=1
(1 + |an|) ≤
N
n=1
1
1−|an|,
10In fact, this argument is showing that  1/p diverges, which says something more than just
that there are inﬁnitely many primes.

52
I. Transition to Modern Number Theory
we see that (c′) implies (a) and that (a) implies (b). To see that (b) implies (c′),
we may assume, without loss of generality, that |an| ≤1
2 for all n. Since |x| ≤1
2
implies that
log
1
1−x ≤|x|
sup
|t|≤|x|≤1
2
 d
dt log
1
1−t
 = |x|
sup
|t|≤|x|≤1
2
 1
1−t

≤2|x|,
we have
log
 N
n=1
1
1−|an|

=
N	
n=1
log

1
1−|an|

≤2
N	
n=1
|an|.
Thus (b) implies (c′).
Now suppose that (a) holds. To prove that ∞
n=1(1+an) converges, it is enough
to show that N
n=M(1 + an) tends to 1 as M and N tend to ∞. In the expression

N
n=M
(1 + an) −1
 ,
we expand out the product, move the absolute values in for each term, and
reassemble the product. The result is the inequality

N
n=M
(1 + an) −1
 ≤
N
n=M
(1 + |an|) −1.
By (a), the right side tends to 0 as M and N tend to ∞. Therefore so does the
left side. This proves the proposition.
□
Using this proposition and its proof, we can give a more rigorous justiﬁcation
for the comparison of log 	∞
n=1 n−s and 	
p prime p−s in Euler’s argument. An-
ticipating the notation that Riemann was to use for the function a century later,
we introduce
ζ(s) =
∞

n=1
1
ns ,
at the moment just for real s with s > 1.
(This function subsequently was
named the Riemann zeta function and is deﬁned and analytic for complex s
with Re s > 1. We postpone a more serious discussion of ζ(s) to Proposition
1.24 below.) We begin from the formula
log ζ(s) =
	
p prime
log
1
1−p−s =
	
p prime

1
ps +
1
2p2s +
1
3p3s + · · ·

.
Let us see that this expression equals
	
p prime
1
ps + bounded term
as s ↓1.

8. Primes in the Progressions 4n + 1 and 4n + 3
53
Going over the second displayed line in the proof of Proposition 1.22, which
applied when |x| ≤1
2, we have
log
1
1−x −x
 ≤|x|
sup
|t|≤|x|≤1
2
 d
dt

log
1
1−t −t

= |x|
sup
|t|≤|x|≤1
2
 1
1−t −1
 = |x|
sup
|t|≤|x|≤1
2
 t
1−t
 ≤2|x|2.
For x = p−s with s > 1, this inequality becomes
log
1
1−p−s −1
ps
 ≤2p−2s.
Consequently
 log ζ(s) −
	
p prime
1
ps
 =
 	
p prime

log
1
1−p−s −1
ps

≤
	
p prime
 log
1
1−p−s −1
ps
 ≤2 	
p prime
p−2s.
The right side is ≤2 	∞
n=1 n−2 for all s > 1, and we arrive at the desired formula
log ζ(s) =

p prime
1
ps + bounded term
as s ↓1.
Since we know that log ζ(s) increases without bound as s decreases to 1, we
can immediately conclude that there are inﬁnitely many primes in the arithmetic
progression n.
With this argument well understood as a prototype, let us modify it to treat
primes 4k + 1 separately from primes 4k + 3. Euler needed one further key idea
to succeed. It is tempting to replace the sum over all primes of p−s in the above
argument by

p prime,
p≡1 mod 4
1
ps
or

p prime,
p≡3 mod 4
1
ps ,
trace backward, and see what happens. What happens is that the expansion of
the corresponding product of (1 −p−s)−1 as a sum does not yield anything very
manageable. For example, with the ﬁrst of the two sums, we are led to the
logarithm of the series 	∞
n=1 c(n)n−s, where c(n) is 1 if n is a product of primes
4k + 1 and is 0 otherwise, and we have no direct way of deciding whether this
diverges or converges as s decreases to 1.

54
I. Transition to Modern Number Theory
Euler’s key additional idea was to work with the sum and difference of the
displayed series, rather than the two terms separately, and then to recover the two
displayed series at the end. Let us see what this idea accomplishes. Tracing back-
ward in the derivation of the formula log ζ(s) = 	
p prime p−s + bounded term,
we want to obtain a series 	
p prime ap p−s from the logarithm of a product

p (1−ap p−s)−1 and be able to recognize this product as equal to a manageable
series 	∞
n=1 bnn−s. Guided by what happens for ζ(s), we can hope that bn will be
readily computable from the ap’s and the unique factorization of n. The relevant
identities, which we shall verify below, are as follows:

n odd
1
ns =

p prime,
p odd
1
1 −p−s ,

n odd
(−1)
1
2 (n−1)
ns
=


p prime,
p=4k+1
1
1 −p−s


p prime,
p=4k+3
1
1 + p−s

.
In more detail let us write
χ0(n) =

0
if n ≡0 mod 2,
1
if n ≡1 mod 2,
χ1(n) =

0
if n ≡0 mod 2,
1
if n ≡1 mod 4,
−1
if n ≡3 mod 4.
With χ equal to χ0 or χ1, we have χ(mn) = χ(m)χ(n) for all m and n.
Consequently the two expressions 	
n odd
1
ns and 	
n odd
(−1)
1
2 (n−1)
ns
are both of
the form
L(s, χ) =
∞

n=1
χ(n)
ns ,
the function χ being χ0 for the ﬁrst series and being χ1 for the second series. As
we shall verify rigorously in the next section, the same argument via unique
factorization that yields Euler’s identity 	∞
n=1 n−s = 	
p prime
1
1−p−s gives a
factorization
L(s, χ) =
∞

n=1
χ(n)
ns
=

p prime
1
1 −χ(p)p−s
because of the identity χ(mn) = χ(m)χ(n). Going over the argument that
log ζ(s) is the sum of 	
p prime p−s and a bounded term, we ﬁnd that
log L(s, χ) =

p prime
χ(p)
ps
+ g(s, χ)

8. Primes in the Progressions 4n + 1 and 4n + 3
55
with g(s, χ) bounded as s ↓1. The sum and difference for the two choices of
χ(n) gives
and
log(L(s, χ0)L(s, χ1)) = 2

p prime
p=4k+1
1
ps + (g(s, χ0) + g(s, χ1))
log(L(s, χ0)L(s, χ1)−1) = 2

p prime
p=4k+3
1
ps + (g(s, χ0) −g(s, χ1)) .
The function L(s, χ0) is the product of ζ(s) and an elementary factor. In fact,
a change of index of summation in the formula deﬁning ζ(s) gives 2−sζ(s) =
	
n even n−s. Subtracting this formula from the deﬁnition of ζ(s) gives
L(s, χ0) =

n odd
1
ns = (1 −2−s)ζ(s).
Therefore
lim
s↓1 L(s, χ0) = +∞.
Meanwhile, the series L(s, χ1) = 	
n odd
(−1)
1
2 (n−1)
ns
is alternating and converges
for s > 0 by the Leibniz test. The convergence is uniform on compact sets, and
the sum L(s, χ1) is continuous for s > 0. Grouping the terms of this series in
pairs, we see that L(1, χ1) is positive.11 Hence we have
0 < lim
s↓1 L(s, χ1) < +∞.
Putting together the two limit relations for L(s, χ0) and L(s, χ1) as s decreases
to 1, we see that
log

L(s, χ0)L(s, χ1)

and
log

L(s, χ0)L(s, χ1)−1
both tend to +∞as s ↓1. Referring to the values computed above for these
expressions and taking into account that 	 1/p exceeds 	 1/ps when s > 1,
we see that

p prime
p=4k+1
1
p
and

p prime
p=4k+3
1
p
11We can even recognize the value of L(1, χ1) as π/4 from the Taylor series of arctan x, but the
explicit value is not needed in the argument.

56
I. Transition to Modern Number Theory
are both inﬁnite. Hence there are inﬁnitely many primes 4k + 1, and there are
inﬁnitely many primes 4k + 3.
The proof of the general case of Dirichlet’s Theorem (Theorem 1.21) will
proceed in similar fashion. We return to it in Section 10 after a brief but systematic
investigation of the kinds of series and products that we have encountered in the
present section.
9. Dirichlet Series and Euler Products
A series 	∞
n=1 ann−s with an and s complex is called a Dirichlet series. The
ﬁrst result below shows that the region of convergence and the region of absolute
convergence for such a series are each right half-planes in C unless they are equal
to the empty set or to all of C. These half-planes may not be the same: for
example, 	∞
n=1(−1)nn−s is convergent for Re s > 0 and absolutely convergent
for Re s > 1.
Proposition 1.23. Let 	∞
n=1 ann−s be a Dirichlet series.
(a) If the series is convergent for s = s0, then it is convergent uniformly on
compact sets for Re s > Re s0, and the sum of the series is analytic in this region.
(b) If the series is absolutely convergent for s = s0, then it is uniformly
absolutely convergent for Re s ≥Re s0.
(c) If the series is convergent for s = s0, then it is absolutely convergent for
Re s > Re s0 + 1.
(d) If the series is convergent at some s0 and sums to 0 in a right half-plane,
then all the coefﬁcients are 0.
REMARK. The proof of (a) will use the summation by parts formula. Namely
if {un} and {vn} are sequences and if Un = 	n
k=1 uk for n ≥0, then 1 ≤M ≤N
implies
N	
n=M
unvn =
N−1
	
n=M
Un(vn −vn+1) + UNvN −UM−1vM.
(∗)
PROOF. For (a), we write ann−s = ann−s0 ·n−(s−s0) = unvn and then apply the
summation by parts formula (∗). The given convergence means that the sequence
{Un} is convergent, and certainly vn tends to 0 uniformly on any proper half-plane
of Re s > Re s0. Thus the second and third terms on the right side of (∗) tend
to 0 with the required uniformity as M and N tend to ∞. For the ﬁrst term, the
sequence {Un} is bounded, and we shall show that
∞
	
n=1
|vn −vn+1| =
∞
	
n=1

1
ns−s0 −
1
(n+1)s−s0


9. Dirichlet Series and Euler Products
57
is convergent uniformly on compact sets for which Re s > Re s0. Use of (∗) and
the Cauchy criterion will complete the proof of convergence. For n ≤t ≤n + 1,
we have
|n−(s−s0) −t−(s−s0)| ≤
sup
n≤t≤n+1
 d
dt (n−(s−s0) −t−(s−s0))

=
sup
n≤t≤n+1
 s−s0
ts−s0+1
 ≤
|s−s0|
n1+Re(s−s0) .
Thus
|vn −vn+1| = |n−(s−s0) −(n + 1)−(s−s0)| ≤
|s−s0|
n1+Re(s−s0) ,
and 	∞
n=1 |vn −vn+1| is uniformly convergent on compact sets with Re s > Re s0,
by the Weierstrass M-test. It follows that the given Dirichlet series is uniformly
convergent on compact sets for which Re s > Re s0. Since each term is analytic
in this region, the sum is analytic.
For (b), we have
 an
ns
 =
 an
ns0
 ·

1
ns−s0
 ≤
 an
ns0
 .
Since the sum of the right side is convergent, the desired uniform convergence
follows from the Weierstrass M-test.
For (c), let ϵ > 0 be given. Then

an
ns0+1+ϵ
 =
 an
ns0
 n−(1+ϵ)
with the ﬁrst factor on the right bounded and the second factor contributing to a
ﬁnite sum. Therefore we have absolute convergence at s0 +1+ϵ, and (c) follows
from (b).
For (d), we may assume by (c) that there is absolute convergence ats0. Suppose
that a1 = · · · = aN−1 = 0. By (b), 	∞
n=N ann−s = 0 for Re s > Re s0. The
series
∞
	
n=N
an(n/N)−s
(∗∗)
is by assumption absolutely convergent at s0, and Re s > Re s0 implies
an(n/N)−s ≤
an(n/N)−s0 .
Bydominatedconvergencewecantakethelimitof(∗∗)termbytermass →+∞.
The only term that survives is aN. Since (∗∗) has sum 0 for all s, we conclude
that aN = 0. This completes the proof.
□

58
I. Transition to Modern Number Theory
Proposition 1.24. The Riemann zeta function ζ(s) = 	∞
n=1 n−s, initially
deﬁned and analytic for Re s > 1, extends to be meromorphic for Re s > 0. Its
only pole is at s = 1, and the pole is simple.
REMARK. Actually, ζ(s) extends to be meromorphic in C with no additional
poles, but we do not need this additional information.
PROOF. For Re s > 1, we have
1
s−1 =
 ∞
1 t−s dt =
∞
	
n=1
 n+1
n
t−s dt.
Thus Re s > 1 implies
ζ(s) =
1
s−1 +
∞
	
n=1

1
ns −
 n+1
n
t−s dt

=
1
s−1 +
∞
	
n=1
 n+1
n
(n−s −t−s) dt.
It is enough to show that the series on the right side converges uniformly on
compact sets for Re s > 0. Thus suppose that Re s ≥σ > 0 and |s| ≤C. The
proof of Proposition 1.23a showed that |n−s −t−s| ≤|s| n−(1+Re s). Hence

 n+1
n
(n−s −t−s) dt
 ≤
 n+1
n
|n−s −t−s| dt ≤|s| n−(1+Re s) ≤Cn−(1+σ).
Since 	∞
n=1 n−(1+σ) < ∞, the desired uniform convergence follows from the
Weierstrass M-test.
□
Proposition 1.25. Let Z(s) = 	∞
n=1 ann−s be a Dirichlet series with all
an ≥0. Suppose that the series is convergent in some half-plane and that the sum
extends to be analytic for Re s > 0. Then the series converges for Re s > 0.
PROOF. By assumption the series converges somewhere, and therefore s0 =
inf

s ≥0
 	∞
n=1 ann−s converges

is a well-deﬁned real number ≥0. Arguing
by contradiction, suppose that s0 > 0. Since 	 ann−s converges uniformly on
compact sets for Re s > s0 by Proposition 1.23a and since the terms of the series
are analytic, we can compute the derivatives of the series term by term. Thus
Z(N)(s0 + 1) =
∞
	
n=1
an(−log n)N
ns0+1
.
(∗)
The Taylor series of Z(s) about s0 + 1 is
Z(s) =
∞
	
N=0
1
N!(s −s0 −1)N Z(N)(s0 + 1)

9. Dirichlet Series and Euler Products
59
and is convergent at s = 1
2s0, since Z(s) is analytic in the open disk centered at
s0 + 1 and having radius s0 + 1. Thus
Z( 1
2s0) =
∞
	
N=0
1
N!(1 + 1
2s0)N(−1)N Z(N)(s0 + 1),
with the series convergent. Substituting from (∗), we have
Z( 1
2s0) =
∞
	
N=0
∞
	
n=1
an(log n)N
N! ns0+1 (1 + 1
2s0)N.
This is a series with terms ≥0, and Fubini’s Theorem allows us to interchange
the order of summation and obtain
Z( 1
2s0) =
∞
	
n=1
∞
	
N=0
an
ns0+1
(log n)N (1+ 1
2 s0)N
N!
=
∞
	
n=1
an
ns0+1 e(log n)(1+ 1
2 s0) =
∞
	
n=1
ann−1
2 s0.
In other words, the assumption s0 > 0 led to a point between 0 and s0 (namely 1
2s0)
for which there is convergence. This contradiction proves that s0 = 0. Therefore
	∞
n=1 ann−s converges for Re s > 0.
□
We shall now examine special features of Dirichlet series that allow the
series to have product expansions like the one for ζ(s), namely 	∞
n=1 n−s =

p prime
1
1−p−s . Consider a formal product

p prime
(1 + ap p−s + · · · + apm p−ms + · · · ).
Ifthisproductisexpandedwithoutregardtoconvergence, theresultistheDirichlet
series 	∞
n=1 ann−s, where a1 = 1 and an is given by
an = ap
r1
1 · · · ap
rk
k
if n = pr1
1 · · · prk
k .
Suppose that the Dirichlet series 	∞
n=1 ann−s is in fact absolutely convergent in
some right half-plane. Then every rearrangement is absolutely convergent to the
same sum, and the same conclusion is valid for subseries. If E is a ﬁnite set of
primes and if N(E) denotes the set of positive integers requiring only members
of E for their factorization, then we have

p∈E
(1 + ap p−s + · · · + apm p−ms + · · · ) =
	
n∈N(E)
ann−s.
Letting E swell to the whole set of positive integers, we see that the inﬁnite
product has a limit in the half-plane of absolute convergence of the Dirichlet

60
I. Transition to Modern Number Theory
series, and the limit of the inﬁnite product equals the sum of the series. The sum
of the series is 0 only if one of the factors on the left side is 0. In particular, the
sum of the series cannot be identically 0, by Proposition 1.23d. Thus the limit of
the inﬁnite product can can be given by only this one Dirichlet series.
Conversely if an absolutely convergent Dirichlet series 	∞
n=1 ann−s has the
property that its coefﬁcients are multiplicative, i.e.,
a1 = 1
and
amn = aman
whenever GCD(m, n) = 1,
then we can form the above inﬁnite product and recover the given series by ex-
pandingtheproductandusingtheformulaan = ap
r1
1 · · · ap
rk
k whenn = pr1
1 · · · prk
k .
In this case we say that the Dirichlet series 	∞
n=1 ann−s has the inﬁnite product
as an Euler product. Many functions in elementary number theory give rise
to multiplicative sequences; an example is an = ϕ(n), where ϕ is the Euler ϕ
function.
If the coefﬁcients are strictly multiplicative, i.e., if
a1 = 1
and
amn = aman
for all m and n,
then the pth factor of the inﬁnite product simpliﬁes to
1 + ap p−s + · · · + (ap p−s)m + · · · =
1
1 −ap p−s .
As a consequence we obtain the following proposition.
Proposition 1.26. If the coefﬁcients of the Dirichlet series 	∞
n=1 ann−s are
strictly multiplicative, then the Dirichlet series has an Euler product of the form
∞

n=1
an
ns =

p prime
1
1 −ap p−s ,
valid in its region of absolute convergence.
REMARK. We refer to the kind of Euler product in this proposition as a ﬁrst-
degree Euler product.
This is what happens with ζ(s), for which all the coefﬁcients are 1, and with
an = χ0(n) and an = χ1(n) as in the previous section. Conversely an Euler
product expansion of the form in the proposition forces the coefﬁcients of the
Dirichlet series to be strictly multiplicative.
A Dirichlet series 	∞
n=1 ann−s with |an| ≤nc for some real c is absolutely
convergent for Re s > c + 1. This fact leads us to a convergence criterion for
ﬁrst-degree Euler products.

10. Dirichlet's Theorem on Primes in Arithmetic Progressions
61
Proposition 1.27.
A ﬁrst-degree Euler product  (1 −ap p−s)−1 with
|ap| ≤pc for some real c and all primes p deﬁnes an absolutely convergent
Dirichlet series for Re s > c + 1 and hence a valid identity 	∞
n=1 ann−s =

p prime (1 −ap p−s)−1 in that region.
PROOF. The coefﬁcients an are strictly multiplicative, and thus |an| ≤nc for
all n. The absolute convergence follows.
□
10. Dirichlet’s Theorem on Primes in Arithmetic Progressions
In this section we shall prove Dirichlet’s Theorem as stated in Theorem 1.21.
Recall from Section 8 that the proof of Dirichlet’s Theorem for the progressions
4n + 1 and 4n + 3 required taking the sum and difference of two expressions,
working with them, and then passing back to the original expressions. Generaliz-
ing this step involves recognizing this process as Fourier analysis on the 2-element
group (Z/4Z)×. This kind of Fourier analysis was discussed in Section VII.4
of Basic Algebra. Let us begin by reviewing what is needed from that section
of Basic Algebra and then pinpoint the Fourier analysis that was the key to the
argument in Section 8.
Let G be a ﬁnite abelian group, such as (Z/mZ)×. A multiplicative character
of G is a homomorphism of G into the circle group S1 ⊆C×. The multiplicative
characters of G form a ﬁnite abelian group  
G under pointwise multiplication:
(χχ′)(g) = χ(g)χ′(g).
In this setting we recall the statement of the Fourier inversion formula.
THEOREM 7.17 OF Basic Algebra (Fourier inversion formula). Let G be a
ﬁnite abelian group, and introduce an inner product on the complex vector space
C(G, C) of all functions from G to C by the formula
⟨F, F′⟩=

g∈G
F(g)F′(g),
the corresponding norm being ∥F∥= ⟨F, F⟩1/2. Then the members of  
G form an
orthogonal basis of C(G, C), each χ in  
G satisfying ∥χ∥2 = |G|. Consequently
| 
G| = |G|, and any function F : G →C is given by the “sum of its Fourier
series”:
F(g) =
1
|G|

χ∈G
 
h∈G
F(h)χ(h)

χ(g).

62
I. Transition to Modern Number Theory
EXAMPLE. With the two-element group G = {±1}, there are two multiplicative
characters, with χ0(+1) = χ0(−1) = 1, χ1(+1) = 1, and χ1(−1) = −1. We
can think of the Fourier-coefﬁcient mapping as carrying any complex-valued
function F on G to the function  F on  
G given by  F(χ) = 	
h∈G F(h)χ(h).
The inversion formula says that F is recovered as F = 1
2
 F(χ0)χ0 +  F(χ1)χ1

.
A basis for the 2-dimensional space of complex-valued functions on G consists
of the two functions F+ and F−, with F+ equal to 1 at +1 and 0 at −1 and
with F−equal to 0 at +1 and 1 at −1. The multiplicative characters are given
by χ0 = F+ + F−and χ1 = F+ −F−. For these two functions the inversion
formula reads F+ = 1
2(χ0 + χ1) and F−= 1
2(χ0 −χ1). In Section 8 the roles of
F+ and F−are played by functions of s, not by scalars, with F+ corresponding
to 	
p≡1 mod 4 p−s and F−corresponding to 	
p≡3 mod 4 p−s. We are to consider
the functions of s corresponding to their sum χ0 and to their difference χ1. The
results of Section 9 show that these are the series that come from Euler products.
The role of the Fourier inversion formula is to ensure that we can reconstruct
	
p≡1 mod 4 p−s and 	
p≡3 mod 4 p−s from the sum and difference. The general
proof of Dirichlet’s Theorem is a direct generalization of this argument form = 4.
Fix an integer m > 1.
A Dirichlet character modulo m is a function
χ : Z →S1 ∪{0} such that
(i) χ( j) = 0 if and only if GCD( j, m) > 1,
(ii) χ( j) depends only on the residue class j mod m,
(iii) when regarded as a function on the residue classes modulo m, χ is a
multiplicative character of (Z/mZ)×.
In particular, a Dirichlet character modulom determines a multiplicative character
of (Z/mZ)×. Conversely each multiplicative character of (Z/mZ)× deﬁnes a
unique Dirichlet character modulo m as the lift of the multiplicative character on
the set { j ∈Z | GCD( j, m) = 1} and as 0 on the rest of Z. For example the
multiplicative character on (Z/4Z)× that is 1 at 1 mod 4 and is −1 at 3 mod 4
lifts to the Dirichlet character that is 1 at integers congruent to 1 modulo 4,
is −1 at integers congruent to 3 modulo 4, and is 0 at even integers. It will
often be notationally helpful to use the same symbol for the Dirichlet character
and the multiplicative character of (Z/mZ)×. Because of this correspondence,
the number of Dirichlet characters modulo m matches the order of  
G for G =
(Z/mZ)×, which matches the order of G and is ϕ(m), where ϕ is the Euler ϕ
function. The principal Dirichlet character modulo m, denoted by χ0, is the one
built from the trivial character of (Z/mZ)×:
χ0( j) =
 1
if GCD( j, m) = 1,
0
if GCD( j, m) > 1.

10. Dirichlet's Theorem on Primes in Arithmetic Progressions
63
Each Dirichlet character modulo m is strictly multiplicative, in the sense of
the previous section. We assemble each as the coefﬁcients of a Dirichlet series,
the associated Dirichlet L function, by the deﬁnition
L(s, χ) =
∞

n=1
χ(n)
ns .
Proposition 1.28. Fix m, and let χ be a Dirichlet character modulo m.
(a) The Dirichlet series L(s, χ) is absolutely convergent for Re s > 1 and is
given in that region by a ﬁrst-degree Euler product
L(s, χ) =

p prime
1
1 −χ(p)p−s .
(b) If χ is not principal, then the series for L(s, χ) is convergent for Re s > 0,
and the sum is analytic for Re s > 0.
(c) For the principal Dirichlet character χ0 modulo m, L(s, χ0) extends to be
meromorphic for Re s > 0. Its only pole for Re s > 0 is at s = 1, and the pole is
simple. It is given in terms of the Riemann zeta function by
L(s, χ0) = ζ(s)

p prime,
p dividing m
(1 −p−s).
PROOF. For (a), the boundedness of χ implies that the series is absolutely
convergent for Re s > 1. Since χ is strictly multiplicative, L(s, χ) has a ﬁrst-
degree Euler product by Proposition 1.26, and the product is convergent in the
same region.
For (b), let us notice that χ ̸= χ0 implies the equality
m	
n=1
χ(n + b) = 0
for any b,
(∗)
since the member of (Z/mZ)× that corresponds to χ is orthogonal to the trivial
character, by the Fourier inversion formula as quoted above from Basic Algebra.
For s real and positive, let us write
χ(n)
ns
= χ(n) · 1
ns = unvn
in the notation of the summation by parts formula that follows the statement of
Proposition 1.23, and let us put Un = 	n
k=1 uk. Equation (∗) implies that {Un}
is bounded, say with |Un| ≤C. Summation by parts then gives

N	
n=M
χ(n)
ns
 ≤
N−1
	
n=M
C

1
ns −
1
(n+1)s

+ C
N s + C
Ms = 2C
Ms .

64
I. Transition to Modern Number Theory
This expression tends to 0 as M and N tend to ∞. Therefore the series L(s, χ) =
	∞
n=1
χ(n)
ns
is convergent for s real and positive. By Proposition 1.23a the series
is convergent for Re s > 0, and the sum is analytic in this region.
For (c), let Re s > 1. From the product formula in (a) with χ set equal to χ0,
we have
L(s, χ0) =

p prime,
p not dividing m
1
1−p−s .
Using the Euler product expansion of ζ(s), we obtain the displayed formula of (c).
The remaining statements in (c) follow from Proposition 1.24, since the product
over primes p not dividing m is a ﬁnite product.
□
By Proposition 1.28b, L(s, χ) is well deﬁned and ﬁnite at s = 1 if χ is not
principal. The main step in the proof of Dirichlet’s Theorem is the following
lemma.
Lemma 1.29. L(1, χ) ̸= 0 if χ is not principal.
PROOF. Let Z(s) = 
χ L(s, χ). Exactly one factor of Z(s) has a pole at
s = 1, according to Proposition 1.28. If any factor has a zero at s = 1, then Z(s)
is analytic for Re s > 0. Assuming that Z(s) is indeed analytic, we shall derive
a contradiction.
Being the ﬁnite product of absolutely convergent Dirichlet series for Res > 1,
Z(s) is given by an absolutely convergent Dirichlet series. We shall prove that
the coefﬁcients of this series are ≥0. More precisely we shall prove for Re s > 1
that
Z(s) =

p with GCD(p,m)=1
1

1 −p−f (p)sg(p) ,
(∗)
where f (p) is the order of p in (Z/mZ)× and where g(p) = ϕ(m)/f (p), ϕ being
Euler’s ϕ function. The factor (1 −p−f (p)s)−1 is given by a Dirichlet series with
all coefﬁcients ≥0. Hence so is the g(p)th power, and so is the product over p
of the result. Thus (∗) will prove that all coefﬁcients of Z(s) are ≥0.
To prove (∗), we write, for Re s > 1,
Z(s) =

χ
L(s, χ) =

p
 
χ
1
1 −χ(p)p−s

=

p with
GCD(p,m)=1
 
χ
1
1 −χ(p)p−s

.
Fix p not dividing m. We shall show that

χ

1 −χ(p)p−s
=

1 −p−f sg ,
(∗∗)

10. Dirichlet's Theorem on Primes in Arithmetic Progressions
65
where f is the order of p in (Z/mZ)× and where g = ϕ(m)/f ; then (∗) will
follow.
The function χ →χ(p) is a homomorphism of (Z/mZ)× into the subgroup
{e2πik/f } of S1 and is onto some cyclic subgroup {e2πik/f ′} with f ′ dividing
f . Let us see that f ′ = f . In fact, if f ′ < f , then p f ′ ̸≡1 mod m, while
χ(p f ′) = χ(p) f ′ = 1 for all χ; since χ(p f ′) = χ(1) for all χ, the χ’s cannot
span all functions on (Z/mZ)×, in contradiction to the Fourier inversion formula
(Theorem 7.17 of Basic Algebra).
Thus χ →χ(p) is onto {e2πik/f }. In other words, χ(p) takes on all f th roots
of unity as values, and the homomorphism property ensures that each is taken on
the same number of times, namely g = ϕ(m)/f times. If X is an indeterminate,
we then have

χ
(1 −χ(p)X) =
 f −1

k=0
(1 −e2πik/f X)
g
= (1 −X f )g.
Then (∗∗) follows and so does (∗). Hence all the coefﬁcients of the Dirichlet
series of Z(s) are ≥0. We have already observed that this series, as the ﬁnite
product of absolutely convergent series for Re s > 1, is absolutely convergent for
Re s > 1. Thus Proposition 1.25 applies and shows that the Dirichlet series of
Z(s) converges for Re s > 0.
Since the coefﬁcients of the series are positive, the convergence is absolute
for s real and positive. By Proposition 1.23b the convergence is absolute for
Re s > 0. Therefore the Euler product expansion (∗) is valid for Re s > 0.
For primes p not dividing m and for real s > 0, we have
1

1 −p−f sg = (1 + p−f s + p−2 f s + · · · )g ≥1 + p−f gs + p−2 f gs + · · ·
= 1 + p−ϕ(m)s + p−2ϕ(m)s + · · · =
1
1 −p−ϕ(m)s .
In combination with (∗), this inequality gives
Z(s)


p dividing m
1
1 −p−ϕ(m)s

=


p with GCD(p,m)=1
1
(1 −p−f s)g


p dividing m
1
1 −p−ϕ(m)s

≥

p prime
1
1 −p−ϕ(m)s =
∞

n=1
1
nϕ(m)s .
The sum on the right is +∞for s = 1/ϕ(m), while the left side is ﬁnite for that
s. This contradiction completes the proof of the lemma.
□

66
I. Transition to Modern Number Theory
PROOF OF THEOREM 1.21. First we show for each Dirichlet characterχ modulo
m that
log L(s, χ) =
	
p prime
χ(p)
ps + g(s, χ)
(∗)
for real numbers s > 1, with g(s, χ) remaining bounded as s ↓1. In this
statement we have not yet speciﬁed a branch of the logarithm, and we shall
choose it presently. Fix p and deﬁne, for s ≥1, a value of the logarithm of the
pth factor of the Euler product of L(s, χ) in Proposition 1.28a by
log

1
1−χ(p)p−s

= χ(p)
ps + 1
2
χ(p2)
p2s
+ 1
3
χ(p3)
p3s
+ · · · = χ(p)
ps + g(s, p, χ).
(∗∗)
In Section 8 we obtained the inequality | log(1 −x)−1 −x| ≤2|x|2 for real x
with |x| ≤1
2, but the proof remains valid for complex x with |x| ≤1
2. Since
x = χ(p)p−s is complex with |χ(p)p−s| ≤1
2, we obtain
|g(s, p, χ)| = | log

1
1−χ(p)p−s

−χ(p)p−s ≤2|χ(p)p−s|2 ≤2p−2.
Since 	
p prime p−2 ≤	∞
n=1 n−2 < ∞, the series 	
p g(s, p, χ) is uniformly
convergent for s ≥1. Let g(s, χ) be the continuous function 	
p g(s, p, χ).
Summing (∗∗) over primes p, we obtain
	
p
log

1
1−χ(p)p−s

= 	
p
χ(p)
ps + g(s, χ).
Because of the validity of the Euler product expansion of L(s, χ) in Proposition
1.28a, the left side represents a branch of log L(s, χ). This proves (∗).
For each b prime to m, deﬁne a function Fb on the positive integers by
Fb(n) =

1
if n ≡b mod m,
0
otherwise.
The Fourier inversion formula (Theorem 7.17 of Basic Algebra) gives
	
χ
χ(b)χ(n) = ϕ(m)Fb(n).
(†)
Multiplying (∗) by χ(b), summing on χ, and using (†) to handle the term that is
summed over p prime, we obtain
ϕ(m)
	
p prime,
p=km+b
p−s = 	
χ
χ(b) log L(s, χ) −	
χ
χ(b)g(s, χ).
(††)
The term 	
χ χ(b)g(s, χ) is bounded as s ↓1, according to (∗). The term
χ0(b) log L(s, χ0) is unbounded as s ↓1, by Proposition 1.28c. For χ nonprin-
cipal, the term χ(b) log L(s, χ) is bounded as s ↓1, by Proposition 1.28b and
Lemma 1.29. Therefore the left side of (††) is unbounded as s ↓1. Hence the
number of primes contributing to the sum is inﬁnite.
□

11. Problems
67
11. Problems
1.
Fix an odd integer m > 1. Let P be the set of odd primes p > 0 such that
x2 ≡m mod p is solvable and such that p does not divide m. Show that P is
nonempty and that there is a ﬁnite set S of arithmetic progressions such that the
members of P are the odd primes > 0 that lie in at least one member of S.
2.
Let D be a nonsquare integer, and let m be an odd integer with GCD(D, m) = 1.
By suitably adapting the proof of Theorem 1.6,
(a) prove that if m is primitively representable by some binary quadratic form
of discriminant D, then x2 ≡D mod m is solvable,
(b) prove that if x2 ≡D mod m is solvable and m is odd, then m is primitively
representable by some binary quadratic form of discriminant D.
3.
For a ﬁxed discriminant D, let H be the group of proper equivalence classes
of binary quadratic forms of discriminant D, and let H ′ be the set of ordinary
equivalence classes of discriminant D. Inclusion of a proper equivalence class
into the ordinary equivalence class that contains it gives a map f of H onto H ′.
Give an example in which H ′ can admit no group structure for which f is a group
homomorphism.
4.
(a) Show that if (a, b, c) has order 3 in the form class group, then the product
of any two integers of the form ax2 + bxy + cy2 is again of that form.
(b) Show that h(−23) = 3.
(c) Using the general theory, show that the class of 2x2 + xy + 3y2 has order 3.
(d) Find an explicit formula for (X, Y) in terms of (x1, y1) and (x2, y2) such
that (2x2
1 + x1y1 + 3y2
1)(2x2
2 + x2y2 + 3y2
2) = 2X2 + XY + 3Y 2.
5.
If two integer forms are improperly equivalent overZ, prove that they are properly
equivalent over Q.
6.
Verify for the fundamental discriminant D = −67 that h(D) = 1.
(Edu-
cational note: It is known that the only negative fundamental discriminants
D with h(D) = 1 are −3, −4, −7, −8, −11, −19, −43, −67, −163.
It is
known also that the only other nonsquare D < 0 for which h(D) = 1 are
−12, −16, −28, −27.)
7.
This problem carries out the algorithm suggested by Theorem 1.8 to ﬁnd repre-
sentatives of all proper equivalence classes of binary quadratic forms (a, b, c) of
discriminant 316 = 4 · 79. For each of these, b will be even.
(a) For each even positive b with b <
√
4 · 79, factor (b2−4·79)/4 as a product
ac in all possible ways such that a > 0 and such that both |a| and |c| lie
between
√
79 −b/2 and
√
79 + b/2, obtaining 16 forms (a, b, c). Expand
the list by adjoining each form (−a, b, −c), so that the expanded list has 32
members.

68
I. Transition to Modern Number Theory
(b) Arrange the 32 members of the expanded list of (a) into 6 cycles, obtaining
2 cycles of length 4 and 4 cycles of length 6.
(c) Conclude that h(4 · 79) = 6.
8.
For discriminant D = −47, the class number is h(−47) = 5, and the reduced
binary quadratic forms are (1, 1, 12), (2, 1, 6), (2, −1, 6), (3, 1, 4), (3, −1, 4).
Show what the multiplication table is for the proper equivalence classes of these
forms.
Problems 9–11 concern the Jacobi symbol, which is a generalization of the Legendre
symbol. Let m and n be integers with n > 0 odd, and let n = pk1
1 · · · pkrr be the prime
factorization of n. The Jacobi symbol
m
n

is deﬁned to be 0 if GCD(m, n) > 1 and
is deﬁned to be r
j=1
m
pj
kj if GCD(m, n) = 1, where
m
pj

is a Legendre symbol. The
Jacobi symbol therefore extends the domain of the Legendre symbol, and it depends
only on the residue m mod n. Even when GCD(m, n) = 1, the Jacobi symbol does
not encode whether m is a square modulo n, however, since
−1
21

= +1 and since the
residue −1 is not a square modulo 21.
9.
Suppose that n and n′ are odd positive integers and that m and m′ are integers.
Verify that
(a)
mm′
nn′

=
m
n
m′
n′

,
(b)
m2
n

=
m
n2

= 1 if GCD(m, n) = 1.
10. Prove for all odd positive integers n that
(a)
−1
n

= (−1)
1
2 (n−1),
(b)
2
n

= (−1)
1
8 (n2−1).
11. (Quadratic reciprocity) Prove for all odd positive integers m and n satisfying
GCD(m, n) = 1 that
m
n

= (−1)[ 1
2 (m−1)][ 1
2 (n−1)]n
m

.
Problems 12–13 indicate, without spelling out what the group G is, two uses of
Dirichlet’s Theorem in the subject of “elliptic curves.” No knowledge of the subject
of elliptic curves is assumed, however.
12. Suppose that G is a ﬁnite abelian group whose order |G| divides p + 1 for all
sufﬁciently large primes p with p ≡3 mod 4. It is to be shown that |G| divides
4 by means of multiple applications of Dirichlet’s Theorem.
(a) Deduce that 8 does not divide |G| by considering the arithmetic progression
8k + 3.
(b) Deduce that 3 does not divide |G| by considering the arithmetic progression
12k + 7.
(c) Deduce that no odd prime q > 3 divides |G| by considering the arithmetic
progression 4qk + 3.

11. Problems
69
13. Suppose that G is a ﬁnite abelian group whose order |G| divides p + 1 for all
sufﬁciently large primes p with p ≡2 mod 3. It is to be shown that |G| divides
6 by means of multiple applications of Dirichlet’s Theorem.
(a) Deduce that 4 does not divide |G| by considering the arithmetic progression
12k + 5.
(b) Deduce that 9 does not divide |G| by considering the arithmetic progression
9k + 2.
(c) Deduce that no odd prime q > 3 divides |G| by considering the arithmetic
progression 3qk + 2.
Problems 14–19 develop some elementary properties of ideals and their norms in
quadratic number ﬁelds. Notation is as in Sections 6–7. In particular, the number
ﬁeld is K = Q(√m), the ring R of algebraic integers in it has Z basis {1, δ}, and σ
is the nontrivial automorphism of K ﬁxing Q.
14. Prove that if I = ⟨a,r⟩is a nonzero ideal in R with a ∈Z and r ∈R, then a
divides N(s) for every s in I.
15. Prove that any nonzero ideal I in R can be written as I = ⟨a, b + gδ⟩with a,
b, and g in Z and with a > 0, 0 ≤b < a, and 0 < g ≤a. Prove also that the
Z basis with these properties is unique, and it has the properties that g divides a
and b and that ag divides N(b + gδ).
16. Let a, b, and g be integers satisfying a > 0, 0 ≤b < a, and 0 < g ≤a
with g dividing a and b and with ag dividing N(b + gδ). Prove that the ideal
I = (a, b + gδ) in R has {a, b + gδ} as a Z basis.
17. Prove that if I = ⟨a,r⟩is a nonzero ideal in R with a ∈Z, r ∈R, and r = c+dδ
for integers c and d, then N(I) = |ad|.
18. (a) Prove that if I is a nonzero ideal in R, then N(I) is the number of elements
in R/I.
(b) Deduce that if I ⊆J are nonzero ideals in R, then N(J) divides N(I), and
I = J if and only if N(J) = N(I).
19. (a) Using the Chinese Remainder Theorem, prove that if I and J are nonzero
ideals in R with I + J = R, then N(I J) = N(I)N(J).
(b) Let P be a nonzero prime ideal in R, and let p > 0 be the prime number
such that P ∩Z = (p)Z. Then R/P is a vector space over Z/pZ, and its
order is of the form p f for some integer f > 0. Show by induction on the
integer e > 0 that R/Pe has order pef .
(c) Using unique factorization of ideals, deduce that if I and J are any two
nonzero ideals in R, then N(I J) = N(I)N(J).
(d) Prove that any nonzero ideal I of R has Iσ(I) = (N(I)).
Problems 20–24 concern the splitting of prime ideals when extended to quadratic
number ﬁelds. Fix a quadratic number ﬁeld Q(√m ), and let R, D, δ, and σ be as

70
I. Transition to Modern Number Theory
in Sections 6–7. Let p > 0 be a prime in Z. According to Theorem 9.62 of Basic
Algebra, the unique factorization of the ideal (p)R in R is one of the following:
(p)R = (p) is already prime in R, (p)R = P1P2 is the product of two distinct prime
ideals, or (p)R = P2 is the square of a prime ideal.
20. Deduce from the formula N((p)R) = p2 that if P is a nontrivial factor in the
unique factorization of the ideal (p)R, then N(P) = p.
21. This problem concerns the prime p = 2.
(a) Use Problem 15 to prove that if D ≡5 mod 8, then (2)R is a prime ideal
in R.
(b) Prove that if D ≡1 mod 8, then (2)R factors into the product of two distinct
prime factors as (2)R = ⟨2, δ⟩⟨2, 1 + δ⟩.
(c) Prove that if D is even and D/4 ≡3 mod 4, then (2)R = (2, 1+δ)2 exhibits
(2)R as the square of a prime ideal.
(d) Prove that if D is even and D/4 ≡2 mod 4, then (2)R = (2, δ)2 exhibits
(2)R as the square of a prime ideal.
22. Let p be an odd prime.
(a) Prove that if D is odd, then (p)R has a nontrivial factorization into prime
ideals if and only if x2 + x + 1
4(1 −D) ≡0 mod p has a solution, and in
this case a factorization of (p)R is as (p)R = (p, x + δ)(p, x + σ(δ)).
(b) Prove that if D is even, then (p)R has a nontrivial factorization into prime
ideals if and only if x2 ≡0 mod (D/4) has a solution, and in this case a
factorization of (p)R is as (p)R = (p, x + δ)(p, x + σ(δ)).
(c) Deduce from (a) and (b) that (p)R has a nontrivial factorization into prime
ideals if and only if D is a square modulo p.
23. Let p be an odd prime such that D is a square modulo p, so that Problem 22c
gives a nontrivial factorization of (p)R into prime ideals of the form (p)R =
(p, x + δ)(p, x + σ(δ)) for some integer x. Let I = (p, x + δ).
(a) Prove that if D is odd, then σ(I) = I if and only if the integer x is 1
2(p −1).
(b) Prove that if D is even, then σ(I) = I if and only if the integer x is 0.
24. Let p be an odd prime such that D is a square modulo p, so that Problem 22c
gives a nontrivial factorization of (p)R into prime ideals of the form (p)R =
(p, x + δ)(p, x + σ(δ)) for some integer x. Using the previous problem, show
that the two factors on the right are the same ideal if and only if p divides D.
Problems 25–29 seek to identify the genus group explicitly for fundamental discrim-
inants D. Let K = Q(√m ) be the corresponding quadratic number ﬁeld, let R be
the ring of algebraic integers in K, and let σ be the nontrivial automorphism of K
ﬁxing Q. Let E = {p1, . . . , pg+1} with g ≥0 be the set of distinct prime divisors
of D. The goal of this set of problems is to prove that the order of the genus group
is 2g and to exhibit ideals in R representing each genus. Recall from Theorem 1.20

11. Problems
71
that strict equivalence classes of ideals correspond to proper equivalence classes of
binary quadratic forms and therefore that each genus corresponds to a set of proper
equivalence classes of binary quadratic forms.
25. Lettheformclassgroup H fordiscriminant D beisomorphictoaproductofcyclic
groups of orders 2k1, . . . , 2kr , ql1
1 , . . . , qlss , where k1, . . . , kr and l1, . . . ,ls are
positive integers and q1, . . . , qs are odd primes that are not necessarily distinct.
Prove that the genus group has order 2r and is abstractly isomorphic to the
subgroup of H of elements whose order divides 2. (Educational note: Thus a
goal of the present set of problems is to show that r = g.)
26. According to Problems 20–24, the nonzero prime ideals of R are of three kinds:
(i) unique distinct ideals I = (p, b+δ) and σ(I) = (p, b+σ(δ)) with prod-
uct (p)R if p is an odd prime not dividing D such that x2 ≡D mod p
is solvable, or if p = 2 and D ≡1 mod 8,
(ii) the ideal (p)R if p is an odd prime not dividing D such that x2 ≡
D mod p is not solvable, or if p = 2 and D ≡5 mod 8,
(iii) a unique ideal Ip with I 2
p = (p)R if p divides D.
For each subset S ⊆E of the g + 1 distinct prime divisors of D, deﬁne Js =

p∈S Ip.
(a) Using unique factorization of ideals in R, show that any nonzero proper ideal
I in R with σ(I) = I is of the form (a)JS for some a ∈Z and some subset
S ⊆E.
(b) By considering norms of ideals, show that I uniquely determines S in (a).
27. (a) The element x = −1 of K has N(x) = 1 and factors as x = σ(y)y−1 for
the element y = √m of K. For all other elements x of K with norm 1,
verify the formula
1 + x
1 + σ(x) =
(1 + x)x
(1 + σ(x))x = (1 + x)x
x + xσ(x) = (1 + x)x
1 + x
= x,
and explain why it shows that x is of the form σ(y)y−1 for some y ̸= 0 in K.
(Educational note: This result is a special case of Hilbert’s Theorem 90,
which is a theorem in the cohomology of groups and appears in Chapter III.
The general theorem says for a ﬁnite Galois extension K/k with Galois
group  that the cohomology H1 of the group  with coefﬁcients in the
abelian group K × is 0.)
(b) Show that the element y in (a) can be taken to be in R and that all such y’s
in R are Z multiples of one of them y0, which is unique up to a factor of −1.
28. Let I be a nonzero ideal in R whose class in the ideal class group H has order 2,
i.e., an ideal I such that I 2 = (x) for some element x ∈R.
(a) Show that the element x N(I)−1 of K has norm 1.

72
I. Transition to Modern Number Theory
(b) Show that the corresponding element y0 of R from the previous problem has
the property that σ((y0)I) = (y0)I.
(c) Using either y0 or y0
√m from (b), deduce that for any nonzero ideal I in
R with I 2 principal, there is a strictly equivalent ideal JS for some subset
S ⊆E of the g+1 prime divisors of E. Consequently the order of the genus
group is a power of 2 equal to at most 2g+1.
29. This problem shows that the number of ideals JS in the previous problem that
are mutually strictly inequivalent is exactly 2g. To get at this fact, the problem
investigates properties of principal ideals I = (x) in R with the properties that
σ(I) = I and N(x) > 0. Since σ(I) = I, it must be true that σ(x) = εx for
some unit ε in R, and then N(σ(x)) = N(x) implies that N(ε) = +1. Matters
now split into cases along the lines of the hypotheses of Proposition 1.17.
(a) Under the assumption that m < 0 and that m is neither −1 nor −3, show that
if a principal ideal I = (x) in R has σ(I) = I, then x is in Z or in Z√m.
(b) Under the assumption that m < 0, show that the only subsets S of E for
which the ideal JS is principal are S = ∅and S equal to the set of all
prime divisors of m, i.e., S equal to E for D odd and for D even with
D/4 ≡2 mod 4 and S equal to E −{2} for D even with D/4 ≡2 mod 4.
(c) Under the assumption that m < 0, Proposition 1.17 says that strict equiv-
alence for ideals coincides with equivalence. Show how to conclude from
this fact and the results of (a) and (b) that the order of the genus group is 2g
when m < 0.
(d) Under the assumption that m > 0 and that the fundamental unit ε1 has norm
−1, Proposition 1.17 says that strict equivalence for ideals coincides with
equivalence. With I, x, and ε as in the statement of the problem, show that
ε = ±ε2n
1 for some integer n ≥0. Deduce that σ(εn
1x) = sεn
1x for a suitable
choice of sign s, and show as a consequence that JS is principal for the same
S’s as in (b) and that the order of the genus group is 2g.
(e) Under the assumption that m > 0 and that the fundamental unit ε1 has
norm +1, Proposition 1.17 says that strict equivalence for ideals is distinct
from equivalence; in particular, there are two strict equivalence classes of
principal ideals: those with a generator of positive norm and those with a
generator of negative norm. Let y+
0 and y−
0 be the elements produced by
Problem 27 that satisfy ε1 = σ(y+
0 )(y+
0 )−1 and −ε1 = σ(y−
0 )(y−
0 )−1. Prove
that exactly one of y+
0 and y−
0 has positive norm, so that two of the principal
ideals (1), (y+
0 ), (y−
0 ), (√m ) are strictly equivalent to (1), and two are not.
Prove that all four of these principal ideals are of the form JS and that they
are distinct. By expressing elements arising from Problem 27 for the most
general unit in R in terms of y0 and ε1, show that no other JS is a principal
ideal. Show as a consequence that the number of strict equivalence classes
of ideals among the JS’s is 2g.

11. Problems
73
Problems 30–34 show that proper equivalence over Q for two integer forms of
fundamental discriminant D implies proper equivalence over Z/DZ. Consequently
the order of the genus group is at most the number of classes of integer forms of
discriminant D under proper equivalence over Z/DZ. It will follow from the next
set of problems, concerning “genus characters,” that the number of such classes is at
least 2g, where g + 1 is the number of distinct prime divisors of D. In combination
with Problem 29, this result shows that the number of genera equals 2g. Throughout
this set of problems, let D be a fundamental discriminant.
30. Let (a1, b1, c1) be a binary quadratic form over Z of discriminant D. Using
Lemma 1.10, prove that (a1, b1, c1) is properly equivalent over Z to a form
(a, b, c) of discriminant D such that GCD(a, D) = 1.
31. Suppose that (a, b, c) is a binary quadratic form over Z of discriminant D such
that GCD(a, D) = 1.
(a) Prove that if D is odd, then (a, b, c) is properly equivalent over Z to a form
(a, kD,lD) for some integers k and l.
(b) Prove that if D is even, then (a, b, c) is properly equivalent over Z to a form
(a, 2kD, −a(D/4) + lD) for some integers k and l.
32. Suppose that (a, kD,lD) is a form over Z having odd discriminant D, satisfying
GCD(a, D) = 1, and taking on an integer value r relatively prime to D for some
rational (x, y). Write x and y as fractions with a positive common denominator
as small as possible: x = u/w and y = v/w.
(a) Prove that GCD(w, D) = 1, and conclude that a ≡d2r mod D for some
integer d relatively prime to D.
(b) Suppose that (a′, k′D,l′D) is a second form over Z having discriminant D,
satisfying GCD(a′, D) = 1, and taking on the value r at some rational point.
Prove that a′ ≡as2 mod D for some s relatively prime to D.
(c) Suppose that (a, b, c) and (a′, b′, c′) are forms over Z of the same odd
discriminant with GCD(a, D) = GCD(a′, D) = 1, and suppose that these
forms are properly equivalent over Q. Deduce that (a, b, c) and (a′, b′, c′)
are properly equivalent over Z/DZ in the sense that there exists a matrix
 α β
γ δ

in SL(2, Z/DZ) such that substitution of x = αx′ + βy′ and y =
γ x′ + δy′ leads from ax2 + bxy + cy2 modulo D to a′x′2 + b′x′y′ + c′y′2
modulo D.
33. Suppose that (a, 2kD, −a(D/4)+lD) is a form over Z having even discriminant
D, satisfying GCD(a, D) = 1, and taking on an integer value r relatively prime
to D for some rational (x, y). Write x and y as fractions with a positive common
denominator as small as possible: x = u/w and y = v/w.
(a) Prove that GCD(w, D) = 1, and obtain a congruence relating a and r
modulo D.

74
I. Transition to Modern Number Theory
(b) Suppose that (a′, 2k′D, −a′(D/4) + l′D) is a second form over Z hav-
ing discriminant D, satisfying GCD(a′, D) = 1, and taking on the value
r at some rational point.
Prove that
a
p

=
a′
p

for every odd prime p
dividing D.
(c) In the setting of (b), suppose in addition that D/4 ≡3 mod 4. Prove that
a ≡a′ mod 4.
(d) In the setting of (b), suppose in addition that D/4 ≡2 mod 4. Prove for
D/4 ≡2 mod 8 that a′ ≡±a mod 8, and prove for D/4 ≡6 mod 8 that
either a′ ≡a mod 8 or a′ ≡3a mod 8.
(e) Suppose that (a, b, c) and (a′, b′, c′) are forms over Z of the same even
discriminant with GCD(a, D) = GCD(a′, D) = 1, and suppose that these
forms are properly equivalent over Q. Deduce that (a, b, c) and (a′, b′, c′)
are properly equivalent over Z/DZ.
34. Why does it follow from Problems 30–33 that the order of the genus group for
discriminant D is at least as large as the number of proper equivalence classes
under SL(2, Z/DZ) of integer forms of discriminant D?
Problems 35–40 introduce “genus characters.” In fact, genus characters are already
implicit in Problems 32 and 33. Throughout this set of problems, let D be a fun-
damental discriminant, and suppose that D has exactly g + 1 distinct prime factors.
The content of these problems will be summarized in Problem 40. Call two binary
quadratic forms over Z of discriminant D similar modulo D if they take on the same
residues r modulo D that are relatively prime to D. Proper equivalence over Z via
SL(2, Z) implies proper equivalence modulo D via SL(2, Z/DZ), and this in turn
implies similarity modulo D in the sense that was just deﬁned. Problems 30–31 show
that it is enough to study forms ax2 mod D for D odd, where GCD(a, D) = 1, and
to study forms a(x2 −(D/4)y2) for D even, again where GCD(a, D) = 1. Initially
the genus characters are functions of pairs (similarity class,r), where r is a residue
modulo D with GCD(r, D) = 1 such that r is represented by the form modulo D.
The values of these functions are
r
p

for each odd prime p > 0 dividing D, as well
as the indicated one of the following for p = 2 if D is even:
ξ(r) =
−1
r

= (−1)
1
2 (r−1)
if D is even and D/4 ≡3 mod 4,
η(r) =
2
r

= (−1)
1
8 (r2−1)
if D is even and D/4 ≡2 mod 8,
ξ(r)η(r) =
−2
r

= (−1)
1
2 (r−1)+ 1
8 (r2−1)
if D is even and D/4 ≡6 mod 8.
Thus g + 1 expressions have been deﬁned for each ordered pair (similarity class,r).
35. Using Problems 32 and 33, show that the genus characters are independent of the
residue r modulo D with GCD(r, D) = 1 such that r is represented by the form
modulo D. Therefore the residue a in the quadratic form, either ax2 mod D for
D odd or a(x2 −(D/4)y2) for D even, can be used as r, and the genus characters
are g + 1 functions deﬁned on the set of similarity classes modulo D.

11. Problems
75
36. Prove that the genus characters respect the operation of multiplication of proper
equivalence classes of forms over Z.
37. The product of all g + 1 genus characters is 1 in every case. A sketch of the
argument for D odd is as follows: Since D ≡1 mod 4, D has an even number
2t of prime factors 4k + 3. Use of the Jacobi symbol with a odd and p varying
over the (odd) prime divisors of D gives

p
a
p

=

p=4k+1
a
p


p=4k+3
a
p

= ξ(a)2t

p=4k+1
p
a


p=4k+3
p
a

=
D
a

,
and the right side is +1 by Problem 2a. Using this sketch as a guide, show that
the product of all g + 1 genus characters is 1 for the cases that D is even and
(a) D/4 ≡3 mod 4,
(b) D/4 ≡2 mod 8,
(c) D/4 ≡6 mod 8.
38. If D is even, let α be ξ if D/4 ≡3 mod 4, η if D/4 ≡2 mod 8, and ξη
if D/4 ≡6 mod 8.
Let p 	→sp be any function to {±1} from the set of
distinct prime divisors of D. Using Dirichlet’s Theorem on primes in arithmetic
progressions, prove that there exists a prime q such that
q
p

= sp for each odd
prime divisor p of D and α(q) = s2 in case D is even.
39. With α as in the previous problem, let p 	→sp be any function to {±1} from the
set of distinct prime divisors of D such that 
p sp = +1, and choose a prime
q as in the previous problem. Prove that q is primitively representable by some
integer binary quadratic form of discriminant D and that the values of the genus
characters on this form are the numbers sp. Conclude that the number of distinct
similarity classes modulo D is at least 2g.
40. For the quadratic number ﬁeld K = Q(√m ) with discriminant D, suppose that
D has g + 1 distinct prime divisors. Conclude that the following equivalence
classes of binary quadratic forms over Z of discriminant D coincide and that the
number of such classes is 2g:
(i) classes relative to proper equivalence over Q, i.e., genera,
(ii) classes relative to proper equivalence over Z/DZ,
(iii) classes relative to similarity modulo D.

CHAPTER II
Wedderburn–Artin Ring Theory
Abstract.
This chapter studies ﬁnite-dimensional associative division algebras, as well as other
ﬁnite-dimensional associative algebras and closely related rings. The chapter is in two parts that
overlap slightly in Section 6. The ﬁrst part gives the structure theory of the rings in question, and
the second part aims at understanding limitations imposed by the structure of a division ring.
Section 1 brieﬂy summarizes the structure theory for ﬁnite-dimensional (nonassociative) Lie
algebras that was the primary historical motivation for structure theory in the associative case. All
the algebras in this chapter except those explicitly called Lie algebras are understood to be associative.
Section 2 introduces left semisimple rings, deﬁned as rings R with identity such that the left
R module R is semisimple. Wedderburn’s Theorem says that such a ring is the ﬁnite product of
full matrix rings over division rings. The number of factors, the size of each matrix ring, and the
isomorphism class of each division ring are uniquely determined. It follows that left semisimple
and right semisimple are the same. If the ring is a ﬁnite-dimensional algebra over a ﬁeld F, then the
various division rings are ﬁnite-dimensional division algebras over F. The factors of semisimple
rings are simple, i.e., are nonzero and have no nontrivial two-sided ideals, but an example is given
to show that a simple ring need not be semisimple. Every ﬁnite-dimensional simple algebra is
semisimple.
Section 3 introduces chain conditions into the discussion as a useful generalization of ﬁnite
dimensionality.
A ring R with identity is left Artinian if the left ideals of the ring satisfy the
descending chain condition. Artin’s Theorem for simple rings is that left Artinian is equivalent to
semisimplicity, hence to the condition that the given ring be a full matrix ring over a division ring.
Sections 4–6 concern what happens when the assumption of semisimplicity is dropped but some
ﬁniteness condition is maintained. Section 4 introduces the Wedderburn–Artin radical rad R of a
left Artinian ring R as the sum of all nilpotent left ideals. The radical is a two-sided nilpotent ideal.
It is 0 if and only if the ring is semisimple. More generally R/ rad R is always semisimple if R is
left Artinian. Sections 5–6 state and prove Wedderburn’s Main Theorem—that a ﬁnite-dimensional
algebra R with identity over a ﬁeld F of characteristic 0 has a semisimple subalgebra S such that R
is isomorphic as a vector space to S ⊕rad R. The semisimple algebra S is isomorphic to R/ rad R.
Section 5 gives the hard part of the proof, which handles the special case that R/ rad R is isomorphic
to a product of full matrix algebras over F. The remainder of the proof, which appears in Section 6,
follows relatively quickly from the special case in Section 5 and an investigation of circumstances
under which the tensor product over F of two semisimple algebras is semisimple. Such a tensor
product is not always semisimple, but it is semisimple in characteristic 0.
The results about tensor products in Section 6, but with other hypotheses in place of the condition
of characteristic 0, play a role in the remainder of the chapter, which is aimed at identifying certain
division rings. Sections 7–8 provide general tools. Section 7 begins with further results about tensor
products. Then the Skolem–Noether Theorem gives a relationship between any two homomorphisms
of a simple subalgebra into a simple algebra whose center coincides with the underlying ﬁeld of
76

1. Historical Motivation
77
scalars. Section 8 proves the Double Centralizer Theorem, which says for this situation that the
centralizer of the simple subalgebra in the whole algebra is simple and that the product of the
dimensions of the subalgebra and the centralizer is the dimension of the whole algebra.
Sections 9–10 apply the results of Sections 6–8 to obtain two celebrated theorems—Wedderburn’s
Theorem about ﬁnite division rings and Frobenius’s Theorem classifying the ﬁnite-dimensional
associative division algebras over the reals.
1. Historical Motivation
Elementary ring theory came from several sources historically and was already in
place by 1880. Some of the sources are ﬁeld theory (studied by Galois and others),
rings of algebraic integers (studied by Gauss, Dirichlet, Kummer, Kronecker,
Dedekind, and others), and matrices (studied by Cayley, Hamilton, and others).
More advanced general ring theory arose initially not on its own but as an effort
to imitate the theory of “Lie algebras,” which began about 1880.
A brief summary of some early theorems about Lie algebras will put matters
in perspective. The term “algebra” in connection with a ﬁeld F refers at least to
an F vector space with a multiplication that is F bilinear. This chapter will deal
only with two kinds of such algebras, the Lie algebras and those algebras whose
multiplication is associative. If the modiﬁer “Lie” is absent, the understanding is
that the algebra is associative.
Lie algebras arose originally from “Lie groups”—which we can regard for
current purposes as connected groups with ﬁnitely many smooth parameters—
by a process of taking derivatives along curves at the identity element of the
group. Precise knowledge of that process will be unnecessary in our treatment,
but we describe one example: The vector space Mn(R) of all n-by-n matrices over
R becomes a Lie algebra with multiplication deﬁned by the “bracket product”
[X, Y] = XY −Y X. If G is a closed subgroup of the matrix group GL(n, R)
and g is the set of all members of Mn(R) of the form X = c′(0), where c is a
smooth curve in G with c(0) equal to the identity, then it turns out that the vector
space g is closed under the bracket product and is a Lie algebra. Although one
might expect the Lie algebra g to give information about the Lie group G only
inﬁnitesimally at the identity, it turns out that g determines the multiplication rule
for G in a whole open neighborhood of the identity. Thus the Lie group and Lie
algebra are much more closely related than one might at ﬁrst expect.
We turn to the underlying deﬁnitions and early main theorems about Lie alge-
bras. Let F be a ﬁeld. A vector space A over F with an F bilinear multiplication
(X, Y) 	→[X, Y] is a Lie algebra if the multiplication has the two properties
(i) [X, X] = 0 for all X ∈A,
(ii) (Jacobi identity) [X, [Y, Z]] + [Y, [Z, X]] + [Z, [X, Y]] = 0 for all
X, Y, Z ∈A.

78
Multiplication is often referred to as bracket. It is usually not associative. The
vector space Mn(F) with [X, Y] = XY −Y X is a Lie algebra, as one easily
checks by expanding out the various brackets that are involved; it is denoted by
gl(n, F).
The elementary structural deﬁnitions with Lie algebras run parallel to those
with rings. A Lie subalgebra S of A is a vector subspace closed under brackets,
an ideal I of A is a vector subspace such that [X, Y] is in I for X ∈I and Y ∈A,
a homomorphism ϕ : A1 →A2 of Lie algebras is a linear mapping respecting
brackets in the sense that ϕ[X, Y] = [ϕ(X), ϕ(Y)] for all X, Y ∈A1, and an
isomorphism is an invertible homomorphism. Every ideal is a Lie subalgebra.
In contrast to the case of rings, there is no distinction between “left ideals” and
“right ideals” because the bracket product is skew symmetric. Under the passage
from Lie groups to Lie algebras, abelian Lie groups yield Lie algebras with all
brackets 0, and thus one says that a Lie algebra is abelian if all its brackets are 0.
Examples of Lie subalgebras of gl(n, F) are the subalgebra sl(n, F) of all
matrices of trace 0, the subalgebra so(n, F) of all skew-symmetric matrices, and
the subalgebra of all upper-triangular matrices.
The elementary properties of subalgebras, homomorphisms, and so on for Lie
algebras mimic what is true for rings: The kernel of a homomorphism is an
ideal. Any ideal is the kernel of a quotient homomorphism. If I is an ideal in
A, then the ideals of A/I correspond to the ideals of A containing I, just as
in the First Isomorphism Theorem for rings. If I and J are ideals in A, then
(I + J)/I ∼= J/(I ∩J), just as in the Second Isomorphism Theorem for rings.
The connection of Lie algebras to Lie groups makes one want to introduce
deﬁnitions that lead toward classifying all Lie algebras that are ﬁnite-dimensional.
We therefore assume for the remainder of this section that all Lie algebras under
discussion are ﬁnite-dimensional over F. Some of the steps require conditions
on F, and we shall assume that F has characteristic 0.
Group theory already had a notion of “solvable group” from Galois, and this
leads to the notion of solvable Lie algebra. In A, let [A, A] denote the linear span
of all [X, Y] with X, Y ∈A; [A, A] is called the commutator ideal of A, and
A/[A, A] is abelian. In fact, [A, A] is the smallest ideal I in A such that A/I
is abelian. Starting from A, let us form successive commutator ideals. Thus put
A0 = A, A1 = [A0, A0], . . . , An = [An−1, An−1], so that
A = A0 ⊇A1 ⊇· · · ⊇An ⊇· · · .
The terms of this sequence are all the same from some point on, by ﬁnite dimen-
sionality, and we say that A is solvable if the terms are ultimately 0. One easily
checks that the sum I + J of two solvable ideals in A, i.e., the set of sums, is
a solvable ideal. By ﬁnite dimensionality, there exists a unique largest solvable
ideal. This is called the radical of A and is denoted by rad A. The Lie algebra
II. Wedderburn–Artin Ring Theory

1. Historical Motivation
79
A is said to be semisimple if rad A = 0. It is easy to use the First Isomorphism
Theorem to check that A/ rad A is always semisimple.
In the direction of classifying Lie algebras, one might therefore want to see how
all solvable Lie algebras can be constructed by successive extensions, identify
all semisimple Lie algebras, and determine how a general Lie algebra can be
constructed from a semisimple Lie algebra and a solvable Lie algebra by an
extension.
The ﬁrst step in this direction historically concerned identifying semisimple
Lie algebras. We say that the Lie algebra A is simple if dim A > 1 and if A
contains no nonzero proper ideals.
Working with the ﬁeld C but in a way that applies to other ﬁelds of
characteristic 0, W. Killing proved in 1888 that A is semisimple if and only
if A is the (internal) direct sum of simple ideals. In this case the direct summands
are unique, and the only ideals in A are the partial direct sums.
This result is strikingly different from what happens for abelian Lie algebras,
for which the theory reduces to the theory of vector spaces. A 2-dimensional
vector space is the internal direct sum of two 1-dimensional subspaces in many
ways.
But Killing’s theorem says that the decomposition of semisimple Lie
algebras into simple ideals is unique, not just unique up to some isomorphism.
´E. Cartan in his 1894 thesis classiﬁed the simple Lie algebras, up to isomor-
phism, for the case that the ﬁeld is C. The Lie algebras sl(n, C) for n ≥2 and
so(n, C) for n = 3 and n ≥5 were in his list, and there were others. Killing had
come close to this classiﬁcation in his 1888 work, but he had made a number of
errors in both his statements and his proofs.
E. E. Levi in 1905 addressed the extension problem for obtaining all ﬁnite-
dimensional Lie algebras over C from semisimple ones and solvable ones. His
theorem is that for any Lie algebra A, there exists a subalgebra S isomorphic to
A/ rad A such that A = S ⊕rad A as vector spaces. In essence, this result says
that the extension deﬁning A is given by a semidirect product.
The ﬁnal theorem in this vein at this time in history was a 1914 result of Cartan
classifying the simple Lie algebras when the ﬁeld F is R. This classiﬁcation is a
good bit more complicated than the classiﬁcation when F is C.
With this background in mind, we can put into context the corresponding
developments for associative algebras. Although others had done some earlier
work, J. H. M. Wedderburn made the ﬁrst big advance for associative algebras in
1905. Wedderburn’s theory in a certain sense is more complicated than the theory
for Lie algebras because left ideals in the associative case are not necessarily two-
sided ideals. Let us sketch this theory.
For the remainder of this section until the last paragraph, A will denote a ﬁnite-
dimensional associative algebra over a ﬁeld F of characteristic 0, possibly the 0

80
algebra. We shall always assume that A has an identity. Although we shall make
some deﬁnitions here, we shall repeat them later in the chapter at the appropriate
times. For many results later in the chapter, the ﬁeld F will not be assumed to be
of characteristic 0.
As in Chapter X of Basic Algebra, a unital left A module M is said to be simple
if it is nonzero and it has no proper nonzero A submodules, semisimple if it is the
sum (or equivalently the direct sum) of simple A submodules. The algebra A is
semisimple if the left A module A is a semisimple module, i.e., if A is the direct
sum of simple left ideals; A is simple if it is nonzero and has no nontrivial two-
sided ideals. In contrast to the setting of Lie algebras, we make no exception for
the 1-dimensional case; this distinction is necessary and is continually responsible
for subtle differences between the two theories.
Wedderburn’sﬁrsttheoremhastwopartstoit, theﬁrstonemodeledonKilling’s
theorem for Lie algebras and the second one modeled on Cartan’s thesis:
(i) The algebra A is semisimple if and only if it is the (internal) direct sum
of simple two-sided ideals. In this case the direct summands are unique,
and the only two-sided ideals of A are the partial direct sums.
(ii) The algebra A is simple if and only if A ∼= Mn(D) for some integer n ≥1
and some division algebra D over F. In particular, if F is algebraically
closed, then A ∼= Mn(F) for some n.
E. Artin generalized the Wedderburn theory to a suitable kind of “semisimple
ring.” For part of the theory, he introduced a notion of “radical” for the associative
case—the radical of a ﬁnite-dimensional associative algebra A being the sum of
the “nilpotent” left ideals of A. Here a left ideal I is called nilpotent if I k = 0
for some k. The radical rad A is a two-sided ideal, and A/ rad A is a semisimple
ring.
Wedderburn’s Main Theorem, proved later in time and deﬁnitely assuming
characteristic 0, is an analog for associative algebras of Levi’s result about Lie
algebras. The result for associative algebras is that A decomposes as a vector-
space direct sum A = S ⊕rad A, where S is a semisimple subalgebra isomorphic
to A/ rad A.
The remaining structural question for ﬁnite-dimensional associative algebras
is to say something about simple algebras when the ﬁeld is not algebraically
closed. Such a result may be regarded as an analog of the 1914 work by Cartan.
In the associative case one then wants to know what the F isomorphism classes of
ﬁnite-dimensional associative division algebras D are for a given ﬁeld F. We now
drop the assumption that the ﬁeld F has characteristic 0. In asking this question,
one does not want to repeat the theory of ﬁeld extensions. Consequently one
looks only for classes of division algebras whose center is F. If F is algebraically
closed, the only such D is F itself, as we shall observe in more detail in Section 2.
II. Wedderburn–Artin Ring Theory

2. Semisimple Rings and Wedderburn's Theorem
81
If F is a ﬁnite ﬁeld, one is led to another theorem of Wedderburn’s, saying that D
has to be commutative and hence that D = F; this theorem appears in Section 9.
If F is R, one is led to a theorem of Frobenius saying that there are just two such
D’s up to R isomorphism, namely R itself and the quaternions H; this theorem
appears in Section 10. For a general ﬁeld F, it turns out that the set of classes
of ﬁnite-dimensional division algebras with center F forms an abelian group.
The group is called the “Brauer group” of F. Its multiplication is deﬁned by the
condition that the class of D1 times D2 is the class of a division algebra D3 such
that D1 ⊗F D2 ∼= Mn(D3) for some n; the inverse of the class of D is the class
of the opposite algebra Do, and the identity is the class of F. The study of the
Brauer group is postponed to Chapter III. This group has an interpretation in terms
of cohomology of groups, and it has applications to algebraic number theory.
2. Semisimple Rings and Wedderburn’s Theorem
We now begin our detailed investigation of associative algebras over a ﬁeld. In
this section we shall address the ﬁrst theorem of Wedderburn’s that is mentioned
in the previous section. It has two parts, one dealing with semisimple algebras
and one dealing with ﬁnite-dimensional simple algebras. The ﬁrst part does not
need the ﬁnite dimensionality as a hypothesis, and we begin with that one.
Let R be a ring with identity. The ring R is left semisimple if the left R
module R is a semisimple module, i.e., if R is the direct sum of minimal left
ideals.1
In this case R = !
i∈S Ii for some set S and suitable minimal left
ideals Ii. Since R has an identity, we can decompose the identity according to
the direct sum as 1 = 1i1 + · · · + 1in for some ﬁnite subset {i1, . . . , in} of S,
where 1ik is the component of 1 in Iik. Multiplying by r ∈R on the left, we
see that R ⊆!n
k=1 Iik. Consequently R has to be a ﬁnite sum of minimal left
ideals. A ring R with identity is right semisimple if the right R module R is a
semisimple module. We shall see later in this section that left semisimple and
right semisimple are equivalent.
EXAMPLES OF SEMISIMPLE RINGS.
(1) If D is a division ring, then we saw in Example 4 in Section X.1 of Basic
Algebra that the ring R = Mn(D) is left semisimple in the sense of the above
deﬁnition. Actually, that example showed more. It showed that R as a left R
module is given by Mn(D) ∼= Dn ⊕· · · ⊕Dn, where each Dn is a simple left R
module and the jth summand Dn corresponds to the matrices whose only nonzero
entries are in the jth column. The left R module Mn(D) has a composition series
whose terms are the partial sums of the n summands Dn. If M is any simple
left Mn(D) module and if x ̸= 0 is in M, then M = Mn(D)x.
If we set
I = {r ∈Mn(D) | rx = 0}, then I is a left ideal in Mn(D) and M ∼= Mn(D)/I
1By convention, a “minimal left ideal” always means a “minimal nonzero left ideal.”

82
as a left Mn(D) module. In other words, M is an irreducible quotient module
of the left Mn(D) module Mn(D). By the Jordan–H¨older Theorem (Corollary
10.7 of Basic Algebra), M occurs as a composition factor. Hence M ∼= Dn as
a left Mn(D) module. Hence every simple left Mn(D) module is isomorphic to
Dn. We shall use this style of argument repeatedly but will ordinarily include
less detail.
(2) If R1, . . . , Rn are left semisimple rings, then the direct product R =
n
i=1 Ri is left semisimple.2 In fact, each minimal left ideal of Ri, when included
into R, is a minimal left ideal of R. Hence R is the sum of minimal left ideals
and is left semisimple. By the same kind of argument as for Example 1, every
simple left R module is isomorphic to one of these minimal left ideals.
Lemma 2.1. Let D be a division ring, let R = Mn(D), and let Dn be the
simple left R module of column vectors. Each member of D acts on Dn by
scalar multiplication on the right side, yielding a member of EndR(Dn). In turn,
EndR(Dn) is a ring, and this identiﬁcation therefore is an inclusion of the members
of D into the right D module EndR(Dn). The inclusion is in fact an isomorphism
of rings: Do ∼= EndR(Dn), where Do is the opposite ring of D.
PROOF. Let ϕ : D →EndR(Dn) be the function given by ϕ(d)(v) = vd.
Then ϕ(dd′)(v) = v(dd′) = (vd)d′ = ϕ(d′)(vd) = ϕ(d′)(ϕ(d)(v)). Since the
order of multiplication in D is reversed by ϕ, ϕ is a ring homomorphism of Do
into EndR(Dn). It is one-one because Do is a division ring and has no nontrivial
two-sided ideals. To see that it is onto EndR(Dn), let f be in EndR(Dn). Put
f
⎛
⎝
1
0...
0
⎞
⎠=
⎛
⎜⎝
d
d2...
dn
⎞
⎟⎠. Since f is an R module homomorphism,
f
⎛
⎝
a1
a2...
an
⎞
⎠= f
⎛
⎝
⎛
⎝
a1 0 ··· 0
a2 0 ··· 0
...
an 0 ··· 0
⎞
⎠
⎛
⎝
1
0...
0
⎞
⎠
⎞
⎠=
⎛
⎝
a1 0 ··· 0
a2 0 ··· 0
...
an 0 ··· 0
⎞
⎠f
⎛
⎝
1
0...
0
⎞
⎠
=
⎛
⎝
a1 0 ··· 0
a2 0 ··· 0
...
an 0 ··· 0
⎞
⎠
⎛
⎜⎝
d
d2...
dn
⎞
⎟⎠=
⎛
⎝
a1d
a2d
...
and
⎞
⎠= ϕ(d)
⎛
⎝
a1
a2...
an
⎞
⎠.
Therefore ϕ(d) = f , and ϕ is onto.
□
2Some comment is appropriate about the notation R = n
i=1 Ri and the terminology “direct
product.” Indeed, n
i=1 Ri is a product in the sense of category theory within the category of rings
or the category of rings with identity. Sometimes one views R alternatively as built from n two-sided
ideals, each corresponding to one of the n coordinates; in this case, one may say that R is the “direct
sum” of these ideals. This direct sum is to be regarded as a direct sum of abelian groups, or perhaps
vector spaces or R modules, but it is not a coproduct within the category of rings with identity.
II. Wedderburn–Artin Ring Theory

2. Semisimple Rings and Wedderburn's Theorem
83
Theorem 2.2 (Wedderburn). If R is any left semisimple ring, then
R ∼= Mn1(D1) × · · · × Mnr(Dr)
for suitable division rings D1, . . . , Dn and positive integers n1, . . . , nr. The num-
ber r is uniquely determined by R, and the ordered pairs (n1, D1), . . . , (nr, Dr)
are determined up to a permutation of {1, . . . ,r} and an isomorphism of each
Dj. There are exactly r mutually nonisomorphic simple left R modules, namely
(D1)n1, . . . , (Dr)nr.
PROOF. Write R as the direct sum of minimal left ideals, and then regroup
the summands according to their R isomorphism type as R ∼= !r
j=1 njVj, where
njVj is the direct sum of nj submodules R isomorphic to Vj and where Vi ≇Vj
for i ̸= j. The isomorphism is one of unital left R modules. Put Do
i = EndR(Vi).
This is a division ring by Schur’s Lemma (Proposition 10.4b of Basic Algebra).
Using Proposition 10.14 of Basic Algebra, we obtain an isomorphism of rings
Ro ∼= EndR R ∼= HomR

r!
i=1
niVi,
r!
j=1
njVj

.
(∗)
Deﬁne pi : !r
j=1 njVj →niVi to be the ith projection and qi : niVi →
!r
j=1 njVj to be the ith inclusion. Let us see that the right side of (∗) is iso-
morphic as a ring to 
i EndR(niVi) via the mapping f 	→(p1 f q1, . . . , pr f qr).
What is to be shown is that pj f qi = 0 for i ̸= j. Here pj f qi is a member
of HomR(niVi, njVj). The abelian group HomR(niVi, njVj) is the direct sum
of abelian groups isomorphic to HomR(Vi, Vj) by Proposition 10.12, and each
HomR(Vi, Vj) is 0 by Schur’s Lemma (Proposition 10.4a).
Referring to (∗), we therefore obtain ring isomorphisms
Ro ∼=
r
i=1
HomR(niVi, niVi) =
r
i=1
EndR(niVi)
∼=
r
i=1
Mni(EndR(Vi))
by Corollary 10.13
∼=
r
i=1
Mni(Do
i )
by deﬁnition of Do
i .
Reversing the order of multiplication in Ro and using the transpose map to
reverse the order of multiplication in each Mni(Do
i ), we conclude that R ∼=
r
i=1 Mni(Di). This proves existence of the decomposition in the theorem.
We still have to identify the simple left R modules and prove an appropriate
uniqueness statement. As we recalled in Example 1, we have a decomposition

84
Mni(Di) ∼= Dni
i ⊕· · · ⊕Dni
i
of left Mni(Di) modules, and each term Dni
i
is a
simple left Mni(Di) module. The decomposition just proved allows us to regard
each term Dni
i
as a simple left R module, 1 ≤i ≤r. Each of these modules
is acted upon by a different coordinate of R, and hence we have produced at
least r nonisomorphic simple left R modules. Any simple left R module must
be a quotient of R by a maximal left ideal, as we observed in Example 2, hence
a composition factor as a consequence of the Jordan–H¨older Theorem. Thus
it must be one of the Vj’s in the previous part of the proof. There are only
r nonisomorphic such Vj’s, and we conclude that the number of simple left R
modules, up to isomorphism, is exactly r.
For uniqueness suppose that R ∼= Mn′
1(D′
1) × · · · × Mn′s(D′
s) as rings. Let
V ′
j = (D′
j)n′
j be the unique simple left Mn′
j(D′
j) module up to isomorphism, and
regard V ′
j as a simple left R module. Then we have R ∼= !s
j=1 n′
jV ′
j as left
R modules. By the Jordan–H¨older Theorem we must have r = s and, after a
suitable renumbering, ni = n′
i and Vi ∼= V ′
i for 1 ≤i ≤r. Thus we have ring
isomorphisms
(D′
i)o ∼= EndMn′
i (D′
i)(V ′
i )
by Lemma 2.1
∼= EndR(V ′
i )
∼= EndR(Vi)
since Vi ∼= V ′
i
∼= Do
i .
Reversing the order of multiplication gives D′
i ∼= Di, and the proof is complete.
□
Corollary 2.3. For a ring R, left semisimple coincides with right semisimple.
REMARK. Therefore we can henceforth refer to left semisimple rings unam-
biguously as semisimple.
PROOF. The theorem gives the form of any left semisimple ring, and each ring
of this form is certainly right semisimple.
□
Wedderburn’s original formulation of Theorem 2.2 was for algebras over a
ﬁeld F, and he assumed ﬁnite dimensionality. The theorem in this case gives
R ∼= Mn1(D1) × · · · × Mnr(Dr),
and the proof shows that Do
i ∼= EndR(Vi), where Vi is a minimal left ideal of
R of the ith isomorphism type. The ﬁeld F lies inside EndR(Vi), each member
of F yielding a scalar mapping, and hence each Di is a division algebra over
F. Each Di is necessarily ﬁnite-dimensional over F, since R was assumed to be
ﬁnite-dimensional.
II. Wedderburn–Artin Ring Theory

2. Semisimple Rings and Wedderburn's Theorem
85
We shall make occasional use in this chapter of the fact that if D is a ﬁnite-
dimensional division algebra over an algebraically closed ﬁeld F, then D = F.
To see this equality, suppose that x is a member of D but not of F, i.e., is not an
F multiple of the identity. Then x and F together generate a subﬁeld F(x) of D
that is a nontrivial algebraic extension of F, contradiction. Consequently every
ﬁnite-dimensional semisimple algebra R over an algebraically closed ﬁeld F is
of the form
R ∼= Mn1(F) × · · · × Mnr(F),
for suitable integers n1, . . . , nr.
As we saw, the ﬁnite dimensionality plays no role in decomposing semisim-
ple rings as the ﬁnite product of rings that we shall call “simple.” The place
where ﬁnite dimensionality enters the discussion is in identifying simple rings
as semisimple, hence in establishing a converse theorem that every ﬁnite direct
product of simple rings, each equal to an ideal of the given ring, is necessarily
semisimple. We say that a nonzero ring R with identity is simple if its only
two-sided ideals are 0 and R.
EXAMPLES OF SIMPLE RINGS.
(1) If D is a division ring, then Mn(D) is a simple ring. In fact, let J be a
two-sided ideal in Mn(D), ﬁx an ordered pair (i, j) of indices, and let
I = {x ∈D | some member X of J has Xi j = x}.
Multiplying X in this deﬁnition on each side by scalar matrices with entries in
D, we see that I is a two-sided ideal in D. If I = 0 for all (i, j), then J = 0.
So assume for some (i, j) that I ̸= 0. Then I = D for that (i, j), and we may
suppose that some X in J has Xi j = 1. If Ekl denotes the matrix that is 1 in
the (k,l)th place and is 0 elsewhere, then Eii X Ej j = Ei j has to be in J. Hence
Ekl = Eki Ei j Ejl has to be in J, and J = Mn(D).
(2) Let R be the Weyl algebra over C in one variable, namely
R =
( 
n≥0
Pn(x)
 d
dx
n  each Pn is in C[x], and the sum is ﬁnite
)
.
To give a more abstract construction of R, we can view R as C

x, d
dx

subject to
the relation d
dx x = x d
dx + 1; this is not to be a quotient of a polynomial algebra
in two variables but a quotient of a tensor algebra in two variables. We omit the
details. We shall now prove that the ring R is simple but not semisimple.
To see that R is a simple ring, we easily check the two identities
(i)
d
dx

xm dn
dxn

= mxm−1 dn
dxn + xm dn+1
dxn+1 by the product rule,
(ii)
dn
dxn x = n dn−1
dxn−1 +x dn
dxn by induction when applied to a polynomial f (x).

86
Let I be a nonzero two-sided ideal in R, and ﬁx an element X ̸= 0 in I. Let xm
be the highest power of x appearing in X, and let dn
dxn be the highest power of d
dx
appearing in terms of X involving xm. Let l and r denote “left multiplication by”
and “right multiplication by,” and apply

l
 d
dx

−r
 d
dx
m to X. Since (i) shows
that

l
 d
dx

−r
 d
dx

xk d
dx
l = kxk−1 d
dx
l,
the result of computing

l
 d
dx

−r
 d
dx
m X is a polynomial in
d
dx of degree
exactly n with no x’s. Application of (r(x) −l(x))n to the result, using (ii),
yields a nonzero constant. We conclude that 1 is in I and therefore that I = R.
Hence R is simple.
To show that R is not semisimple, ﬁrst note that C[x] is a natural unital left R
module. We shall show that R has inﬁnite length as a left R module, in the sense
of the length of ﬁnite ﬁltrations. In fact,
R ⊇R
 d
dx

⊇R
 d
dx
2 ⊇· · · ⊇R
 d
dx
n
(∗)
is a ﬁnite ﬁltration of left R submodules of R. If R
 d
dx
k = R
 d
dx
k+1, then
 d
dx
k = r
 d
dx
k+1 for some r ∈R. Applying these two equal expressions for
a member of R to the member xk of the left R module C[x], we arrive at a
contradiction and conclude that every inclusion in (∗) is strict. Therefore R has
inﬁnite length and is not semisimple.
The extra hypothesis that Wedderburn imposed so that simple rings would
turn out to be semisimple is ﬁnite dimensionality. Wedderburn’s result in this
direction is Theorem 2.4 below. This hypothesis is quite natural to the extent
that the subject was originally motivated by the theory of Lie algebras. E. Artin
found a substitute for the assumption of ﬁnite dimensionality that takes the result
beyond the realm of algebras, and we take up Artin’s idea in the next section.
Theorem 2.4 (Wedderburn).
Let R be a ﬁnite-dimensional algebra with
identity over a ﬁeld F. If R is a simple ring, then R is semisimple and hence
is isomorphic to Mn(D) for some integer n ≥1 and some ﬁnite-dimensional
division algebra D over F. The integer n is uniquely determined by R, and D is
unique up to isomorphism.
PROOF. By ﬁnite dimensionality, R has a minimal left ideal V . For r in R,
form the set Vr. This is a left ideal, and we claim that it is minimal or is 0. In
fact, the function v 	→vr is R linear from V onto Vr. Since V is simple as a
left R module, Vr is simple or 0. The sum I = 	
r with Vr̸=0 Vr is a two-sided
ideal in R, and it is not 0 because V 1 ̸= 0. Since R is simple, I = R. Then the
left R module R is exhibited as the sum of simple left R modules and is therefore
semisimple. The isomorphism with Mn(D) and the uniqueness now follow from
Theorem 2.2.
□
II. Wedderburn–Artin Ring Theory

3. Rings with Chain Condition and Artin's Theorem
87
3. Rings with Chain Condition and Artin’s Theorem
Parts of Chapters VIII and IX of Basic Algebra made considerable use of a
hypothesis that certain commutative rings are “Noetherian,” and we now extend
this notion to noncommutative rings. A ring R with identity is left Noetherian if
the left R module R satisﬁes the ascending chain condition for its left ideals. It is
left Artinian if the left R module R satisﬁes the descending chain condition for
its left ideals. The notions of right Noetherian and right Artinian are deﬁned
similarly.
We saw many examples of Noetherian rings in the commutative case in Basic
Algebra. The ring of integers Z is Noetherian, and so is the ring of polynomials
R[X] in an indeterminate over a nonzero Noetherian ring R. It follows from the
latter example that the ring F[X1, . . . , Xn] in ﬁnitely many indeterminates over
a ﬁeld is a Noetherian ring. Other examples arose in connection with extensions
of Dedekind domains.
Any ﬁnite direct product of ﬁelds is Noetherian and Artinian because it has a
composition series and because its ideals therefore satisfy both chain conditions.
If p is any prime, the ring Z/p2Z is Noetherian and Artinian for the same reason,
and it is not a direct product of ﬁelds.
In the noncommutative setting, any semisimple ring is necessarily left Noe-
therian and left Artinian because it has a composition series for its left ideals and
the left ideals therefore satisfy both chain conditions.
Proposition 2.5. Let R be a ring with identity, and let M be a ﬁnitely generated
unital left R module. If R is left Noetherian, then M satisﬁes the ascending
chain condition for its R submodules; if R is left Artinian, then M satisﬁes the
descending chain condition for its R submodules.
PROOF. We prove the ﬁrst conclusion by induction on the number of generators,
and the proof of the second conclusion is completely similar. The result is trivial
if M has 0 generators. If M = Rx, then M is a quotient of the left R module
R and satisﬁes the ascending chain condition for its R submodules, according to
Proposition 10.10 of Basic Algebra. For the inductive step with ≥2 generators,
write M = Rx1 + · · · + Rxn and N = Rx1 + · · · + Rxn−1. Then N satisﬁes
the ascending chain condition for its R submodules by the inductive hypothesis,
and M/N is isomorphic to Rxn/(N ∩Rxn), which satisﬁes the ascending chain
condition for its R submodules by the inductive hypothesis. Therefore M satisﬁes
the ascending chain condition for its R submodules by application of the converse
direction of Proposition 10.10.
□
Artin’s theorem (Theorem 2.6 below) will make use of the hypothesis “left
Artinian” in identifying those simple rings that are semisimple. The hypothesis

88
left Artinian may therefore be regarded as a useful generalization of ﬁnite dimen-
sionality. Before we come to that theorem, we give a construction that produces
large numbers of nontrivial examples of such rings.
EXAMPLE (triangular rings). Let R and S be nonzero rings with identity, and
let M be an (R, S) bimodule.3 Deﬁne a set A and operations of addition and
multiplication symbolically by
A =

R
M
0
S

=

r
m
0
s
  r ∈R, m ∈M, s ∈S

with

r
m
0
s
 
r′
m′
0
s′

=

rr′
rm′ + ms′
0
ss′

.
Then A is a ring with identity, the bimodule property entering the proof of
associativity of multiplication in A.
We can identify R, M, and S with the
additive subgroups of A given by

R 0
0 0

,

0 M
0 0

, and

0 0
0 S

. Problems 8–11 at
the end of the chapter ask one to check the following facts:
(i) The left ideals in A are of the form I1 ⊕I2, where I2 is a left ideal in S
and I1 is a left R submodule of R ⊕M containing M I2.
(ii) The right ideals in A are of the form J1 ⊕J2, where J1 is a right ideal in
R and J2 is a right S submodule of M ⊕S containing J1M.
(iii) The ring A is left Noetherian if and only if R and S are left Noetherian
and M satisﬁes the ascending chain condition for its left R submodules.
The ring A is right Noetherian if and only if R and S are right Noetherian
and M satisﬁes the ascending chain condition for its right S submodules.
(iv) The previous item remains valid if “Noetherian” is replaced by
“Artinian” and “ascending” is replaced by “descending.”
(v) If A =

R R
0 S

is a ring such as

Q Q
0 Z

in which S is a (commutative)
Noetherian integral domain with ﬁeld of fractions R and if S ̸= R, then
A is left Noetherian and not right Noetherian, and A is neither left nor
right Artinian.
(vi) If A =

R R
0 S

isaringsuchas
 Q(x) Q(x)
0
Q

inwhich R and S areﬁeldswith
S ⊆R and dimS R inﬁnite, then A is left Noetherian and left Artinian,
and A is neither right Noetherian nor right Artinian.
From these examples we see, among other things, that “left” and “right” are
somewhat independent for both the Noetherian and the Artinian conditions. We
3This means that M is an abelian group with the structure of a unital left R module and the
structure of a unital right S module in such a way that (rm)s = r(ms) for all r ∈R, m ∈M, and
s ∈S.
II. Wedderburn–Artin Ring Theory

4. Wedderburn–Artin Radical
89
already know from the commutative case that Noetherian does not imply Artinian,
Z being a counterexample. We shall see in Theorem 2.15 later that left Artinian
implies left Noetherian and that right Artinian implies right Noetherian.
Theorem 2.6 (E. Artin). If R is a simple ring, then the following conditions
are equivalent:
(a) R is left Artinian,
(b) R is semisimple,
(c) R has a minimal left ideal,
(d) R ∼= Mn(D) for some integer n ≥1 and some division ring D.
In particular, a left Artinian simple ring is right Artinian.
REMARK.
Theorem 2.4 is a special case of the assertion that (a) implies
(d). In fact, if R is a ﬁnite-dimensional algebra over a ﬁeld F, then the ﬁnite
dimensionality forces R to be left Artinian.
PROOF. It is evident from Wedderburn’s Theorem (Theorem 2.2) that (b) and
(d) are equivalent. For the rest we prove that (a) implies (c), that (c) implies (b),
and that (b) implies (a).
Suppose that (a) holds. Applying the minimum condition for left ideals in R,
we obtain a minimal left ideal. Thus (c) holds.
Suppose that (c) holds. Let V be a minimal left ideal. Then the sum I =
	
r∈R Vr is a two-sided ideal in R, and it is nonzero because the term for r = 1
is nonzero. Since R is simple, I = R. Then the left R module R is spanned by
the simple left R modules Vr, and R is semisimple. Thus (b) holds.
Suppose that (b) holds. Since R is semisimple, the left R module R has a
composition series. Then the left ideals in R satisfy both chain conditions, and it
follows that R is left Artinian. Thus (a) holds.
□
4. Wedderburn–Artin Radical
In this section we introduce one notion of “radical” for certain rings with identity,
and we show how it is related to semisimplicity. This notion, the “Wedderburn–
Artin radical,” is deﬁned under the hypothesis that the ring is left Artinian. It is
not the only notion of radical studied by ring theorists, however. There is a useful
generalization, known as the “Jacobson radical,” that is deﬁned for arbitrary rings
with identity. We shall not deﬁne and use the Jacobson radical in this text.
Fix a ring R with identity. A nilpotent element in R is an element a with
an = 0 for some integer n ≥1. A nil left ideal is a left ideal in which every
element is nilpotent; nil right ideals and nil two-sided ideals are deﬁned similarly.

90
A nilpotent left ideal is a left ideal I such that I n = 0 for some integer n ≥1,
i.e., for which a1 · · · an = 0 for all n-fold products of elements from I; nilpotent
right ideals and nilpotent two-sided ideals are deﬁned similarly.
Lemma 2.7. If I1 and I2 are nilpotent left ideals in a ring R with identity, then
I1 + I2 is nilpotent.
PROOF. Let I r
1 = 0 and I s
2 = 0. Expand (I1 + I2)k as 	 Ii1 Ii2 · · · Iik with each
ij equal to 1 or 2. Take k = r + s. In any term of the sum, there are ≥r indices 1
or ≥s indices 2. In the ﬁrst case let there be t indices 2 at the right end. Since
I2I1 ⊆I1, we can absorb all other indices 2, and the term of the sum is contained
in I r
1 I t
2 = 0. Similarly in the second case if there are t′ indices 1 at the right end,
then the term is contained in I s
2 I t′
1 = 0.
□
Lemma 2.8. If I is a nilpotent left ideal in a ring R with identity, then I is
contained in a nilpotent two-sided ideal J.
PROOF. Put J = 	
r∈R Ir. This is a two-sided ideal. For any integer k ≥0,
J k =
 	
r∈R Ir
k ⊆	
r1,...,rk Ir1Ir2 · · · Irk ⊆	
rk I krk.
If I k = 0, then
J k = 0.
□
Lemma 2.9. If R is a ring with identity, then the sum of all nilpotent left ideals
in a nil two-sided ideal.
PROOF. Let K be the sum of all nilpotent left ideals in R, and let a be a member
of K. Write a = a1 + · · · + an with ai ∈Ii for a nilpotent left ideal Ii. Lemma
2.7 shows that I = 	n
i=1 Ii is a nilpotent left ideal. Since a is in I, a is a nilpotent
element.
The set K is certainly a left ideal, and we need to see that aR is in K in order to
see that K is a two-sided ideal. Lemma 2.8 shows that I ⊆J for some nilpotent
two-sided ideal J. Then J ⊆K because J is one of the nilpotent left ideals
whose sum is K. Since a is in I and therefore in J and since J is a two-sided
ideal, aR is contained in J. Therefore aR is contained in K, and K is a two-sided
ideal.
□
Theorem 2.10. If R is a left Artinian ring, then any nil left ideal in R is
nilpotent.
REMARK. Readers familiar with a little structure theory for ﬁnite-dimensional
Lie algebras will recognize this theorem as an analog for associative algebras of
Engel’s Theorem.
PROOF. Let I be a nil left ideal of R, and form the ﬁltration
I ⊇I 2 ⊇I 3 ⊇· · · .
II. Wedderburn–Artin Ring Theory

91
Since R is left Artinian, this ﬁltration is constant from some point on, and we
have I k = I k+1 = I k+2 = · · · for some k ≥1. Put J = I k. We shall show that
J = 0, and then we shall have proved that I is a nilpotent ideal.
Suppose that J ̸= 0. Since J 2 = I 2k = I k = J, we have J 2 = J. Thus the
left ideal J has the property that J J ̸= 0. Since R is left Artinian, the set of left
ideals K ⊆J with J K ̸= 0 has a minimal element K0. Choose a ∈K0 with
Ja ̸= 0. Since Ja ⊆J K0 ⊆K0 and J(Ja) = J 2a = Ja ̸= 0, the minimality
of K0 implies that Ja = K0. Thus there exists x ∈J with xa = a. Applying
powers of x, we obtain xna = a for every integer n ≥1. But x is a nilpotent
element, being in I, and thus we have a contradiction.
□
Corollary 2.11. If R is a left Artinian ring, then there exists a unique largest
nilpotent two-sided ideal I in R. This ideal is the sum of all nilpotent left ideals
and also is the sum of all nilpotent right ideals.
REMARKS. The two-sided ideal I of the corollary is called the Wedderburn–
Artin radical of R and will be denoted by rad R. This exists under the hypothesis
that R is left Artinian.
PROOF. By Lemma 2.9 and Theorem 2.10 the sum of all nilpotent left ideals in
R is a two-sided nilpotent ideal I. Lemma 2.8 shows that any nilpotent right ideal
is contained in a nilpotent two-sided ideal J. Since J is in particular a nilpotent
left ideal, the deﬁnition of I forces J ⊆I. Hence the sum of all nilpotent right
ideals is contained in I. But I itself is a nilpotent right ideal and hence equals
the sum of all the nilpotent right ideals.
□
Lemma 2.12 (Brauer’s Lemma). If R is any ring with identity and if V is a
minimal left ideal in R, then either V 2 = 0 or V = Re for some element e of V
with e2 = e.
REMARK. An element e with the property that e2 = e is said to be idempotent.
PROOF. Being a minimal left ideal, V is a simple left R module. Schur’s
Lemma (Proposition 10.4b of Basic Algebra) shows that EndR V is a division
ring. If a is in V , then the map v 	→va of V into itself lies in EndR V and hence
is the 0 map or is one-one onto. If it is the 0 map for all a ∈V , then V 2 = 0.
Otherwise suppose that a is an element for which v 	→va is one-one onto. Then
there exists e ∈V with ea = a. Multiplying on the left by e gives e2a = ea and
therefore (e2 −e)a = 0. Since the map v 	→va is assumed to be one-one onto,
we must have e2 −e = 0 and e2 = e.
□
Theorem 2.13. If R is a left Artinian ring and if the Wedderburn–Artin radical
of R is 0, then R is a semisimple ring.
4. Wedderburn–Artin Radical

92
REMARKS. Conversely semisimple rings are left Artinian and have radical 0.
In fact, we already know that semisimple rings have a composition series for
their left ideals and hence are left Artinian. To see that the radical is 0, apply
Theorem 2.2 and write the ring as R = Mn1(D1)×· · ·× Mnr(Dr). The two-sided
ideals of R are the various subproducts, with 0 in the missing coordinates. Such a
subproduct cannot be nilpotent as an ideal unless it is 0, since the identity element
in any factor is not a nilpotent element in R.
PROOF. Let us see that any minimal left ideal I of R is a direct summand as a
left R submodule. Since rad R = 0, I is not nilpotent. Thus I 2 ̸= 0, and Lemma
2.12 shows that I contains an idempotent e. This element satisﬁes I = Re. Put
I ′ = {r ∈R | re = 0}. Then I ′ is a left ideal in R. Since I ′ ∩I ⊆I and e is
not in I ′, the minimality of I forces I ′ ∩I = 0. Writing r = re + (r −re) with
re ∈I and r −re ∈I ′, we see that R = I + I ′. Therefore R = I ⊕I ′.
Now put I1 = I. If I ′ is not 0, choose a minimal left ideal I2 ⊆I ′ by the
minimum condition for left ideals in R. Arguing as in the previous paragraph, we
have I2 = Re2 for some element e2 with e2
2 = e2. The argument in the previous
paragraph shows that R = I2 ⊕I ′
2, where I ′
2 = {r ∈R | re2 = 0}. Deﬁne I ′′ =
{r ∈R | re1 = re2 = 0} = I ′ ∩I ′
2. Since I2 is contained in I ′, we can intersect
R = I2 ⊕I ′
2 with I ′ and obtain I ′ = I2 ⊕I ′′. Then R = I1 ⊕I ′ = I1 ⊕I2 ⊕I ′′.
Continuing in this way, we obtain R = I1⊕I2⊕I3⊕I ′′′, etc. As this construction
continues, we have I ′ ⊇I ′′ ⊇I ′′′ ⊇· · · . Since R is left Artinian, this sequence
must terminate, evidently in 0. Then R is exhibited as the sum of simple left R
modules and is semisimple.
□
Corollary 2.14. If R is a left Artinian ring, then R/ rad R is a semisimple ring.
PROOF. Let I = rad R, and let ϕ : R →R/I be the quotient homomorphism.
Arguing by contradiction, let J be a nonzero nilpotent left ideal in R/I, and let
J = ϕ−1(J) ⊆R. Since J is nilpotent, J k ⊆I for some integer k ≥1. But
I, being the radical, is nilpotent, say with I l = 0, and hence J k+l ⊆I l = 0.
Therefore J is a nilpotent left ideal in R strictly containing I, in contradiction to
the maximality of I. We conclude that no such J exists. Then rad(R/ rad R) = 0.
Since R/ rad R is left Artinian as a quotient of a left Artinian ring, Theorem 2.13
shows that R/ rad R is a semisimple ring.
□
We shall use this corollary to prove that left Artinian rings are left Noetherian.
We state the theorem, state and prove a lemma, and then prove the theorem.
Theorem 2.15 (Hopkins). If R is a left Artinian ring, then R is left Noetherian.
Lemma 2.16. If R is a semisimple ring, then every unital left R module M
is semisimple. Consequently any unital left R module satisfying the descending
II. Wedderburn–Artin Ring Theory

93
chain condition has a composition series and therefore satisﬁes the ascending
chain condition.
PROOF. For each m ∈M, let Rm be a copy of the left R module R, and
deﬁne 
M = !
m∈M Rm as a left R module. Since each Rm is semisimple, 
M is
semisimple. Deﬁne a function ϕ : 
M →M as follows: if rm1 +· · ·+rmk is given
with rmj in Rmj for each j, let ϕ(rm1 + · · · + rmk) = 	k
j=1 rmjmj. Then ϕ is an
R module map with the property that ϕ(1m) = m, and consequently ϕ carries 
M
onto M. As the image of a semisimple R module under an R module map, M is
semisimple.
Now suppose that M is a unital left R module satisfying the descending chain
condition.
We have just seen that M is semisimple, and thus we can write
M = !
i∈S Mi as a direct sum over a set S of simple left R modules Mi. Let us
see that S is a ﬁnite set. If S were not a ﬁnite set, then we could choose an inﬁnite
sequence i1, i2, . . . of distinct members of S, and we would obtain
M ⫌!
i̸=i1
Mi ⫌!
i̸=i1,i2
Mi ⫌· · · ,
in contradiction to the fact that the R submodules of M satisfy the descending
chain condition.
□
PROOF OF THEOREM 2.15. Let I = rad R. Since I is nilpotent, I n = 0 for
some n. Each I k for k ≥0 is a left R submodule of R. Since R is left Artinian,
its left R submodules satisfy the descending chain condition, and the same thing
is true of the R submodules of each I k. Consequently the R submodules of each
I k/I k+1 satisfy the descending chain condition.
In the action of R on I k/I k+1 on the left, I acts as 0. Hence I k/I k+1 becomes
a left R/I module, and the R/I submodules of this left R/I module must satisfy
the descending chain condition. Corollary 2.14 shows that R/I = R/ rad R is
a semisimple ring. Since the R/I submodules of I k/I k+1 satisfy the descend-
ing chain condition, Lemma 2.16 shows that these R/I submodules satisfy the
ascending chain condition. Therefore the R submodules of each left R module
I k/I k+1 satisfy the ascending chain condition.
We shall show inductively for k ≥0 that the R submodules of R/I k+1 satisfy
the ascending chain condition. Since I n = 0, this conclusion will establish that
R is left Noetherian, as required. The case k = 0 was shown in the previous
paragraph.
Assume inductively that the R submodules of R/I k satisfy the
ascending chain condition. Since R/I k ∼= (R/I k+1)

(I k/I k+1) and since the
R submodules of R/I k and of I k/I k+1 satisfy the ascending chain condition, the
same is true for R/I k+1. This completes the proof.
□
4. Wedderburn–Artin Radical

94
5. Wedderburn’s Main Theorem
Wedderburn’s Main Theorem is an analog for ﬁnite-dimensional associative
algebras over a ﬁeld of characteristic 0 of the Levi decomposition of a ﬁnite-
dimensional Lie algebra over a ﬁeld of characteristic 0. Each of these results says
that the given algebra is a “semidirect product” of the radical and a semisimple
subalgebra isomorphic to the quotient of the given algebra by the radical. In other
words, the whole algebra, as a vector space, is the direct sum of the radical and a
vector subspace that is closed under multiplication.
An example of this phenomenon occurs with a block upper-triangular subal-
gebra A of Mn(D) whenever D is a ﬁnite-dimensional division algebra over the
given ﬁeld. Let the diagonal blocks be of sizes n1, . . . , nr with n1 +· · ·+nr = n.
The radical rad A is the nilpotent ideal of all matrices whose only nonzero entries
are above and to the right of the diagonal blocks, and the semisimple subalgebra
consists of all matrices whose only nonzero entries lie within the diagonal blocks.
Theorem 2.17 (Wedderburn’s Main Theorem). Let A be a ﬁnite-dimensional
associative algebra with identity over a ﬁeld F of characteristic 0, and let rad A be
the Wedderburn–Artin radical. Then there exists a subalgebra S of A isomorphic
as an F algebra to A/ rad A such that A = S ⊕rad A as vector spaces.
REMARKS.
The ﬁnite dimensionality implies that A is left Artinian, and
Corollary 2.14 shows that A/ rad A is a semisimple algebra. The decomposition
A = S ⊕rad A is different in nature from the one in Theorem 2.2, which involves
complementary ideals. When there are complementary ideals, the identity of A
decomposes as the sum of the identities for each summand. Here the identity of
A is the identity of S and has 0 component in rad A. To see this, write 1 = a + b
with a ∈S and b ∈rad A. Multiplying 1 = a + b on the left and right by s ∈S,
we see that as = s = sa and that bs = sb = 0. Hence a = 1S is the identity of
S. Then b2 = (1 −1S)2 = 1 −2 · 1S + 12
S = 1 −2 · 1S + 1S = 1 −1S = b, and
bn = b for all n ≥1. Since rad A is nilpotent, bn = 0 for some n. Thus b = 0,
and 1 = 1S as asserted.
Theorem 2.17 is a deep result, and the proof will occupy all of the present
section and the next. The key special case to understand occurs when A/ rad A ∼=
Mn1(F) × · · · × Mnr(F). We shall handle this case by means of Theorem 2.18
below, whose proof will be the main goal of the present section. Corollary 2.27 (of
Theorem 2.18) near the end of this section will show that Theorem 2.18 implies
this special case of Theorem 2.17 for r = 1, and Corollary 2.28 will deduce this
special case of Theorem 2.17 for general r from Corollary 2.27.
II. Wedderburn–Artin Ring Theory

5. Wedderburn's Main Theorem
95
Theorem 2.18. Let A be a left Artinian ring with Wedderburn–Artin radical
rad A, and suppose that A/ rad A is simple, i.e., is of the form A/ rad A ∼= Mn(D)
for some division ring D. Then A is isomorphic as a ring to Mn(R) for some left
Artinian ring R such that R/ rad R ∼= D.
The idea behind the proof of Theorem 2.18 is to give an abstract characteri-
zation of a ring of matrices in terms of the elements Ei j that are 1 in the (i, j)th
place and are 0 elsewhere. In turn, these elements arise from the diagonal such
elements Eii, which are idempotents, i.e., have E2
ii = Eii. The critical issue in
the proof of Theorem 2.18 is to show that each idempotent of A/ rad A, which is
assumed to be a full matrix ring Mn(D), has an idempotent in its preimage in A.
The lifted idempotents then point to Mn(R) for a certain R.
Thus we begin with some discussion of idempotents. We shall intersperse
facts about general rings with facts about left Artinian rings as we go along. For
the moment let R be any ring with identity, and let e be an idempotent. Then
1 −e is an idempotent, and we have the three Peirce4 decompositions
R = Re ⊕R(1 −e),
R = eR ⊕(1 −e)R,
R = eRe ⊕eR(1 −e) ⊕(1 −e)Re ⊕(1 −e)R(1 −e).
All the direct sums may be regarded as direct sums of abelian groups. The two
members of the right side in the ﬁrst case are left ideals, and the two members of
the right side in the second case are right ideals. If r ∈R is given, then the ﬁrst
decomposition is as r = re + r(1 −e); the decomposition is direct because if
r1e = r2(1 −e), then right multiplication by e gives r1e = 0 since e2 = e. The
second decomposition is proved similarly, and the third decomposition follows
by combining the ﬁrst two. In the third decomposition, eRe is a ring with e as
identity, and (1 −e)R(1 −e) is a ring with 1 −e as identity.
EXAMPLE. Let R = Mn(F), and let
e =
⎛
⎜⎜⎜⎜⎝
1
...
1
0
...
0
⎞
⎟⎟⎟⎟⎠
,
so that
1 −e =
⎛
⎜⎜⎜⎜⎝
0
...
0
1
...
1
⎞
⎟⎟⎟⎟⎠
.
4Pronounced “purse.” Charles Sanders Peirce (1839–1914).

96
In block form we then have
eRe =

∗
0
0
0

,
eR(1 −e) =

0
∗
0
0

,
(1 −e)Re =

0
0
∗
0

,
(1 −e)R(1 −e) =

0
0
0
∗

.
Proposition 2.19. In a ring R with identity, let e be an element of R with
e2 = e.
(a) If I is a left ideal in eRe, then eRI = I. Hence I 	→RI is a one-one
inclusion-preserving map of the left ideals of eRe to those of R.
(b) If J is a two-sided ideal of eRe, then e(RJ R)e = J. Hence J 	→RJ R
is a one-one inclusion-preserving map of the two-sided ideals of eRe to those of
R. This map respects multiplication of ideals.
(c) If J is a two-sided ideal of R, then eJe is a two-sided ideal of eRe, and
eRe ∩J = eJe.
PROOF. For (a), we have eRI = eR(eI) = (eRe)I = I, the ﬁrst equality
holding because e is the identity in eRe and the third equality holding because
eRe contains its identity e. The rest of (a) then follows.
For (b), J satisﬁes J = eJe, since ej = je = j for every j ∈eRe, and
therefore eRJ Re = eReJeRe = (eRe)J(eRe) = J, the last equality holding
because eRe contains its identity e. To see that J 	→RJ R respects multi-
plication, we compute that (RJ R)(RJ ′R) = RJ RJ ′R = R(Je)R(eJ ′)R =
RJ(eRe)J ′R = RJ J ′R.
For (c), eRe ∩J ⊇eJe certainly. In the reverse direction, let j be in eRe ∩J.
Then j = ere for some r ∈R, and hence eje = e2re2 = ere = j shows that j
is in eJe.
□
Corollary 2.20. In a left Artinian ring R, let e be an element with e2 = e.
Then the ring eRe is left Artinian, and
rad(eRe) = eRe ∩rad R = e(rad R)e.
If R denotes the quotient ring R/ rad R and ¯e denotes the element e+rad R of the
quotient, then the quotient map carries eRe onto ¯eR ¯e and has kernel rad(eRe).
Consequently
eRe/ rad(eRe) ∼= ¯eR ¯e.
PROOF. The ring eRe is left Artinian as an immediate consequence of Propo-
sition 2.19a. For the ﬁrst display we may assume that R and eRe are both left
Artinian. Then eRe ∩rad R is a two-sided ideal of eRe, and (eRe ∩rad R)n ⊆
II. Wedderburn–Artin Ring Theory

5. Wedderburn's Main Theorem
97
(rad R)n for every n. Since (rad R)N = 0 for some N, eRe ∩rad R is nilpotent,
and eRe ∩rad R ⊆rad(eRe). Since the reverse inclusion is evident, we obtain
rad(eRe) = eRe ∩rad R. The equality eRe ∩rad R = e(rad R)e is the special
case of Proposition 2.19c in which J = rad R. This proves the equalities in the
ﬁrst display.
For the isomorphism in the second display, the quotient mapping carries ere
to ere + rad R = (e + rad R)(r + rad R)(e + rad R) = ¯e(r + rad R)¯e. Thus
the quotient map R →R carries eRe onto ¯eR ¯e. The kernel is eRe ∩rad R,
which we have just proved is rad(eRe). Therefore the quotient map exhibits an
isomorphism of rings eRe/ rad(eRe) ∼= ¯eR ¯e.
□
Proposition 2.21. In a ring R with identity, let e1 and e2 be idempotents. Then
the unital left R modules Re1 and Re2 are isomorphic as left R modules if and
only if there exist elements e12 and e21 in R such that
e1e12e2 = e12,
e2e21e1 = e21,
e12e21 = e1,
e21e12 = e2.
REMARK. In this case we shall say that e1 and e2 are isomorphic idempotents,
and we shall write e1 ∼= e2.
PROOF. Let ϕ : Re1 →Re2 be an R isomorphism. Deﬁne e12 = ϕ(e1)
and e21 = ϕ−1(e2). Every element s of Re2 has the property that se2 = s
because e2
2 = e2; since e12 lies in Re2, e12e2 = e12. Meanwhile, e12 = ϕ(e1) =
ϕ(e2
1) = e1ϕ(e1) = e1e12. Putting these two facts together gives e12 = e12e2 =
e1e12e2. This proves the ﬁrst equality in the display, and the equality e21 =
e2e21e1 is proved similarly. Also, e1 = ϕ−1(ϕ(e1)) = ϕ−1(e12) = ϕ−1(e12e2) =
e12ϕ−1(e2) = e12e21, and similarly e21e12 = e2. This completes the proof that
an R isomorphism Re1 ∼= Re2 leads to elements e12 and e21 such that the four
displayed identities hold.
For the converse, suppose that e12 and e21 exist and satisfy the four displayed
identities. Deﬁne ϕ : Re1 →R by ϕ(re1) = re12. To see that this map is well
deﬁned, suppose that re1 = 0; then re12 = r(e1e12e2) = (re1)e12e2 = 0, as
required. Similarly we can deﬁne ψ : Re2 →R by ψ(re2) = re21. Then
ψϕ(e1) = ψ(e12) = ψ(e12e2) = e12ψ(e2) = e12e21 = e1,
and similarly ϕψ(e2) = e2. Since ψϕ and ϕψ are R module homomorphisms,
each is the identity on its domain.
□
Corollary 2.22. Let R be a left Artinian ring. For each r in R, let ¯r be the coset
r + rad R in R/ rad R. If e1 and e2 are idempotents in R, then e1 and e2 are
isomorphic if and only if ¯e1 and ¯e2 are isomorphic.

98
PROOF. If e1 and e2 are given as isomorphic in R, let e12 and e21 be as in
Proposition 2.21, and pass to R/ rad R by the quotient homomorphism to obtain
elements ¯e12 and ¯e21 that exhibit ¯e1 and ¯e2 as isomorphic idempotents.
Conversely let ¯e1 and ¯e2 be isomorphic idempotents in R/ rad R, and use
Proposition 2.21 to produce elements ¯u12 and ¯u21 in R/ rad R such that
¯e1 ¯u12 ¯e2 = ¯u12,
¯e2 ¯u21 ¯e1 = ¯u21,
¯u12 ¯u21 = ¯e1,
¯u21 ¯u12 = ¯e2.
Letu12 andu21 bepreimagesof ¯u12 and ¯u21 in R. Possiblyreplacingu12 bye1u12e2
and u21 by e2u21e1, we may assume that e1u12e2 = u12 and e2u21e1 = u21. Our
construction is such that u12u21 = e1 −z1 with z1 in rad R and e1z1 = z1 = z1e1.
Since z1 is a nilpotent element,
(e1 −z1)(e1 + z1 + z2
1 + · · · + zn
1) = e1
as soon as zn+1
1
= 0. Thus we have u12u21(e1 + z1 + z2
1 + · · · + zn
1) = e1.
Deﬁne e12 = u12 and e21 = u21(e1 + z1 + z2
1 + · · · + zn
1). Then it is immediate
that ¯e12 = ¯u12, ¯e21 = ¯u21, and e12e21 = e1. Also, the equality e1u12e2 = u12
implies that e1e12e2 = e12, and the equality e2u21e1(e1 + z1 + z2
1 + · · · + zn
1) =
u21(e1 + z1 + z2
1 + · · · + zn
1) implies that e2e21e1 = e21 since e1z1 = z1 = z1e1.
In view of Proposition 2.21, we are left with checking the value of e21e12. We
know that ¯e21 ¯e12 = ¯u21 ¯u12 = ¯e2, and hence e21e12 = e2 −z2 for some z2 in rad R.
Multiplying by e2 on both sides, we see that
e2z2 = z2 = z2e2.
(∗)
Now (e21e12)(e21e12) = e21e1e12 = e21e12, and thus (e2 −z2)2 = e2 −z2.
Expanding out this equality and using (∗) gives e2 −2z2 + z2
2 = e2 −z2 and
therefore gives z2
2 = z2. Hence zn
2 = z2 for every n ≥1. But z2 is in rad R, and
every element of rad R is nilpotent. Thus z2 = 0, and e12e21 = e1 as required. □
The proof of Corollary 2.22 shows a little more than the statement asserts,
and we shall use this little extra conclusion when we ﬁnally get to the proof of
Theorem 2.18. The extra fact is that any elements ¯u12 and ¯u21 exhibiting ¯e1 and
¯e2 have lifts to elements e12 and e21 exhibiting e1 and e2 as isomorphic.
The critical step of lifting a single idempotent from A/ rad A to A is accom-
plished by the following proposition.
Proposition 2.23. Let R be a left Artinian ring. For each r in R, let ¯r be the
element r + rad R of R/ rad R. If a is an element of R such that ¯a is idempotent
in R/ rad R, then there exists an idempotent e in R such that ¯e = ¯a.
II. Wedderburn–Artin Ring Theory

5. Wedderburn's Main Theorem
99
PROOF. Set b = 1 −a. The elements a and b commute, and ab = a(1 −a)
maps to ¯a −¯a2 = 0 in R/ rad R, since ¯a is idempotent. Therefore ab lies in rad R
and must satisfy (ab)n = 0 for some n. Since a and b commute, we can apply
the Binomial Theorem to obtain
1 = (a + b)2n =
2n
	
k=0
2n
k

a2n−kbk.
Deﬁne
e =
n	
k=0
2n
k

a2n−kbk
and
f =
2n
	
k=n+1
2n
k

a2n−kbk.
Each term of e contains at least the nth power of a, and each term of b contains at
least the nth power of b. Thus each term of ef contains at least a factor anbn =
(ab)n = 0, and we see that ef = 0. Therefore e = e1 = e(e+ f ) = e2 +0 = e2,
and e is an idempotent. Each term of e except the one for k = 0 contains a factor
ab, and thus e ≡a2n mod rad R. Since ¯a is idempotent, a2n ≡a mod rad R, and
therefore ¯e = ¯a.
□
For the proof of Theorem 2.18, we need to lift an entire matrix ring to obtain a
matrix ring, and this involves lifting more than a single idempotent. In effect, we
have to lift compatibly an entire system ¯ei j that behaves like the usual system of
Ei j for matrices. The idea is that if R/ rad R is a matrix ring Mn(K) with some
ring of coefﬁcients K, then the ith and jth columns of Mn(K) may be described
compatibly as Mn(K)¯eii and Mn(K)¯ej j. Proposition 2.23 allows us to lift ¯eii
and ¯ej j to idempotents eii and ej j, and Corollary 2.22 shows that an isomorphism
¯eii ∼= ¯ej j implies an isomorphism eii ∼= ej j. The isomorphism gives us elements
ei j and eji, and then we can piece these together to form matrices.
Two idempotents e and f in a ring R with identity are said to be orthogonal
if ef = 0 = f e. Suppose that e1, . . . , en are mutually orthogonal idempotents
such that 	n
i=1 ei = 1. Let us see in this case that
R = Re1 ⊕· · · ⊕Ren
as left R modules. In fact, the condition 	n
i=1 ei = 1 shows that r = 	n
i=1 rei
for each r ∈R, and thus R = Re1 + · · · + Ren. If r lies in Rej ∩	
i̸= j Rei, then
r = sej and r = 	
i̸= j riei. Multiplying the ﬁrst of these equalities on the right
by ej gives rej = se2
j = sej = r. Hence the second of these equalities, upon
multiplication by ej, yields r = rej = 	
i̸= j rieiej = 0. In other words, the sum
is direct, as asserted.
Corollary 2.24. Let R be a left Artinian ring. For each r in R, let ¯r be the coset
r + rad R in R/ rad R. If x and y are orthogonal idempotents in R = R/ rad R
and if e is an idempotent in R with ¯e = x, then there exists an idempotent f in
R with ¯f = y and ef = f e = 0.

100
PROOF. By Proposition 2.23 choose an idempotent f0 in R with ¯f0 = y. Then
f0e has f0e = yx = 0. Hence f0e is in rad R, and ( f0e)n+1 = 0 for some n.
Consequently 1 + f0e + ( f0e)2 + · · · + ( f0e)n is a two-sided inverse to 1 −f0e.
Deﬁne
f = (1 −e)

1 + f0e + ( f0e)2 + · · · + ( f0e)n
f0(1 −f0e).
Then ¯f = (1−x)(y +0+· · ·+0)y(1−0) = (1−x)y = y −xy = y. Moreover,
f e = (1 −e)

1 + f0e + ( f0e)2 + · · · + ( f0e)n
( f0e −f 2
0 e2) = 0
since f0e −f 2
0 e2 = f0e −f0e = 0, and
ef = e(1 −e)

1 + f0e + ( f0e)2 + · · · + ( f0e)n
f0(1 −f0e) = 0
since e(1 −e) = 0.
We still need to see that f 2 = 0. Since f0(1 −f0e) = f0(1 −e), we can write
f = (1 −e)(1 + f0e + · · · ) f0(1 −e) and
f 2 = (1 −e)(1 + f0e + · · · ) f0(1 −e)(1 + f0e + · · · ) f0(1 −e)
= (1 −e)(1 + f0e + · · · ) f0(1 −f0e)(1 + f0e + · · · ) f0(1 −e)
= (1 −e)(1 + f0e + · · · ) f0 · 1 · f0(1 −e)
= (1 −e)(1 + f0e + · · · ) f0(1 −f0e)
= f,
as required.
□
Corollary 2.25. Let R be a left Artinian ring. For each r in R, let ¯r be the coset
r + rad R in R/ rad R. If {x1, . . . , xN} is a ﬁnite set of mutually orthogonal
idempotents in R = R/ rad R, then there exists a set of mutually orthogonal
idempotents {e1, . . . , eN} in R such that ¯ei = xi for all i. If 	N
i=1 xi = 1, then
	N
i=1 ei = 1.
PROOF. For the existence of {x1, . . . , xN}, we proceed by induction on N, the
case N = 1 being Proposition 2.23. Suppose we have found e1, . . . , en and we
want to ﬁnd en+1. Let e be the idempotent e1 + · · · + en, and apply Corollary
2.24 to the idempotent e in R and the idempotent xn+1 in R/ rad R. The corollary
gives us en+1 orthogonal to e with ¯en+1 = xn+1. Since ei = eie = eei for i ≤n,
we obtain en+1ei = en+1(eei) = (en+1e)ei = 0 and similarly eien+1 = 0 for
those i’s, and the induction is complete.
Finally 	
i xi = 1 implies that 	
i ei = 1 + r for some r in rad R. Then
the idempotent 1 −	
i ei is exhibited as in rad R and must be 0 because every
element of rad R is nilpotent.
□
II. Wedderburn–Artin Ring Theory

5. Wedderburn's Main Theorem
101
In a nonzero ring R with identity, a ﬁnite subset

ei j | i, j ∈{1, . . . , n}

is
called a set of matrix units in R if 	n
i=1 eii = 1 and ei jekl = δjkeil for all
i, j, k,l. It follows from these conditions that the eii are mutually orthogonal
idempotents with sum 1, since eiiej j = δi jei j = δi jeii. In view of the remarks
before Corollary 2.24, we automatically have R = !n
i=1 Reii. In addition, the
product rule gives eiiei jej j = ei j, ej jejieii = eji, ei jeji = eii, and ejiei j = ej j;
by Proposition 2.21 the idempotents eii and ej j are isomorphic in the sense that
there is a left R module isomorphism Reii ∼= Rej j.
If A = Mn(R), deﬁne Ei j to be the matrix that is 1 in the (i, j)th place and
is 0 elsewhere. Then it is immediate that {Ei j} is a set of matrix units in A. To
recognize matrix rings, we prove the following converse.
Proposition 2.26. For a nonzero ring A with identity, suppose that

ei j | i, j ∈{1, . . . , n}

is a set of matrix units in A. Let R be the subring of A of all elements of A
commuting with all ei j. Then every element of A can be written in one and only
one way as 	
i, j ri jei j with ri j ∈R for all i and j, and the map A →Mn(R)
given by a 	→[ri j] is a ring isomorphism. The ring R can be recovered from A
by means of the isomorphism R ∼= e11Ae11.
PROOF. To each a ∈A, associate the matrix [ri j] in Mn(A) whose entries are
given by ri j = 	
k ekiaejk. Then
ri jelm = 	
k
ekiaejkelm = 	
k
ekiaδklejm = eliaejm,
(∗)
and
elmri j = 	
k
elmekiaejk = 	
k
δmkeliaejk = eliaejm.
Thus ri jelm = eliaejm = elmri j. Because of the deﬁnition of R, this equality
shows that ri j is in R. In particular, [ri j] is in Mn(R). A special case of (∗) is
that ri jei j = eiiaej j. Hence
	
i, j
ri jei j = 	
i, j
eiiaej j = 1a1 = a.
This proves that a can be expanded as a = 	
i, j ri j.
For uniqueness, suppose that a = 	
i, j si jei j is given with each si j in R.
Multiplication on the left by ekp and right by eqk, followed by addition, gives
rpq = 	
k
ekpaeqk = 	
k
ekp
 	
i, j
si jei j

eqk = 	
i, j,k
si jekpei jeqk = 	
k
spqekk = spq.

102
This proves that the map A →Mn(R) is one-one onto.
To see that the map A →Mn(R) respects multiplication, let a and a′ be in
A, and let the effect of the map on a, a′, and aa′ be a 	→[ri j], a′ 	→[r′
i j], and
aa′ 	→[si j]. Then we have
	
l
rilr′
lj = 	
l,k,k′ ekiaelkek′la′ejk′ = 	
l,k
ekiaella′ejk = 	
k
ekiaa′ejk = si j,
and the matrix product of the images of a and a′ coincides with the image of aa′.
Finally consider the image E11 = [ri j] of the element a = e11 of A. It has
ri j = 	
k ekie11ejk = δi1δ1 j
	
k ekk = δi1δ1 j. If a is a general element of A and
its image is [ri j], then the result of the previous paragraph shows that e11ae11
maps to E11[ri j]E11 = r11E11. Hence the map e11ae11 	→r11 is an isomorphism
of e11Ae11 with R.
□
PROOF OF THEOREM 2.18. Let

xi j | i, j ∈{1, . . . , n}

be a set of matrix
units for the matrix ring A/ rad A ∼= Mn(D). Then x11, . . . , xnn are mutually
orthogonal idempotents in A/ rad A with sum 1.
By Corollary 2.25 we can
choose mutually orthogonal idempotents e11, . . . , enn in A with 	n
i=1 eii = 1
and with ¯eii = xii.
We observed at the time of deﬁning matrix units that x11, . . . , xnn are isomor-
phic as idempotents. Corollary 2.22 shows as a consequence that e11, . . . , enn
are isomorphic as idempotents. The remarks following Corollary 2.22 show that
the isomorphism of Re11 with Reii can be exhibited by elements e1i and ei1 in A
satisfying the usual properties
e11e1ieii = e1i,
eiiei1e11 = ei1,
e1iei1 = e11,
ei1e1i = eii
and also the properties ¯e1i = x1i and ¯ei1 = xi1. Here ¯a is shorthand for a +rad A.
Deﬁne ei j = ei1e1 j. Then ¯ei j = ¯ei1 ¯e1 j = xi1x1 j = xi j, and we readily check that
{ei j} is a set of matrix units for A.
By Proposition 2.26, A ∼= Mn(R) with R ∼= e11Ae11. From Corollary 2.20
we know that e11Ae11/ rad(e11Ae11) ∼= ¯e11(A/ rad A)¯e11, where ¯e11 denotes the
element e11 + rad A of A/ rad A. Hence
R/ rad R ∼= ¯e11(A/ rad A)¯e11 ∼= ¯e11Mn(D)¯e11 ∼= D,
and the proof is complete.
□
Corollary 2.27. If A is a ﬁnite-dimensional algebra with identity over a ﬁeld
F and if A/ rad A ∼= Mn(F) as algebras, then there is a subalgebra S isomorphic
to Mn(F) such that A ∼= S ⊕rad A as vector spaces.
II. Wedderburn–Artin Ring Theory

5. Wedderburn's Main Theorem
103
REMARKS. This corollary shows that Theorem 2.18 implies Theorem 2.17
under the additional assumption that the algebra A of Theorem 2.17 satisﬁes
A/ rad A ∼= Mn(F). It is not necessary to assume characteristic 0.
PROOF.
Suppose that A is a ﬁnite-dimensional algebra with identity over
F such that A/ rad A ∼= Mn(F). Then A is left Artinian, and Theorem 2.18
produces a certain ring R with A ∼= Mn(R).
Here Proposition 2.26 shows
that R is isomorphic as a ring to e11Ae11 for a certain idempotent e11 in A. It
follows that R is an algebra with identity over F, necessarily ﬁnite-dimensional
because A is ﬁnite-dimensional. The algebra R, according to Theorem 2.18, has
R/ rad R ∼= F. Therefore R ∼= F ⊕rad R as F vector spaces. If we allow
Mn( · ) to be deﬁned even for rings without identity, then we have F algebra
isomorphisms
A ∼= Mn(R) ∼= Mn(F ⊕rad R) ∼= Mn(F) ⊕Mn(rad R)
in which the direct sums are understood to be direct sums of vector spaces. We
shall show that
rad(Mn(R)) = Mn(rad R),
(∗)
and then the decomposition A = S ⊕rad A will have been proved with S ∼=
Mn(F).
To prove (∗), let Ei j be the member of Mn(R) that is 1 in the (i, j)th place
and is 0 elsewhere. Suppose that J is a two-sided ideal in Mn(R). Let I ⊆R
be the set of all elements x11 for x ∈J. If r is in R, then r E11 is a member of
Mn(R), and the (1, 1)th entry of the element (r E11)x of J is rx11. Thus rx11 is
in I. Similarly x11r is in I, and I is a two-sided ideal in R. Let us see that
J = Mn(I).
(∗∗)
If x is in J, then so is Ei1x E1 j = x11Ei j, and hence I Ei j is in J; taking sums
over i and j shows that Mn(I) ⊆J. In the reverse direction if x is in J, then so
is E1ix Ej1 = xi j E11, and hence xi j is in I; therefore J ⊆Mn(I). This proves
(∗∗). Let us apply (∗∗) with J = rad(Mn(R)). The corresponding ideal I of R
consists of all entries x11 of members x of J. Using Corollary 2.20, we obtain
I E11 = E11J E11 = E11 rad(Mn(R))E11 = rad(E11Mn(R)E11) = rad(RE11).
Thus I = rad R. Taking Mn( · ) of both sides and applying (∗∗), we arrive at (∗).
This completes the proof.
□
Corollary 2.28. If A is a ﬁnite-dimensional associative algebra with identity
over a ﬁeld F and if A/ rad A ∼= Mn1(F)×· · ·×Mnr(F), then there is a subalgebra
S of A isomorphic as an algebra to A/ rad A such that A ∼= S ⊕rad A as vector
spaces.

104
REMARKS. This corollary gives the conclusion of Theorem 2.17 under the
additional assumption that the semisimple algebra A/ rad A over F is of the form
A/ rad A ∼= Mn1(F) × · · · × Mnr(F). If F is algebraically closed, then the
division rings Dk in Theorem 2.2 are ﬁnite-dimensional division algebras over
F and necessarily equal F, as was observed in the discussion after Corollary
2.3. Thus Theorem 2.2 shows that the additional assumption about the form of
A/ rad A is automatically satisﬁed if F is algebraically closed. In other words,
Corollary 2.28 completes the proof of Theorem 2.17 if F is algebraically closed.
PROOF.
For 1 ≤j ≤r, let xj be the identity matrix of Mnj(F) when
Mnj(F) is regarded as a subalgebra of A/ rad A. The elements xj are orthogonal
idempotents in A/ rad A with sum 1, and Corollary 2.25 shows that they lift to
orthogonal idempotents ej of A with sum 1. For each j, Corollary 2.20 shows that
ej Aej/ rad(ej Aej) = xj(A/ rad A)xj ∼= Mnj(F). By Corollary 2.27, ej Aej has
a subalgebra Sj ∼= Mnj(F) with ej Aej = Sj ⊕rad(ej Aej) as vector spaces. Put
S = !r
j=1 Sj, the direct sum being understood in the sense of vector spaces. The
subalgebra Sj has identity ej, and the product of ej with any other Si is 0 because
eiej = ejei = 0 when i ̸= j. If s = 	
j sj and s′ = 	
j s′
j are two elements of S,
then ss′ =
 	
i siei
 	
j ejs′
j

= 	
i, j sieiejs′
j = 	
j sjejs′
j = 	
j sjs′
j. Hence
S is a subalgebra. The element 	r
j=1 ej is a two-sided identity in S.
Let us prove that S ∩rad A = 0. If s = 	
j sj is in S ∩rad A, then sj = ejsej is
in Sj = ej Sej and is in ej(rad A)ej, which equals rad(ej Aej) by Corollary 2.20.
Since Sj ∩rad(ej Aej) = 0 by construction, sj = 0. Thus s = 	
j sj = 0.
Consequently S∩rad A = 0. A count of dimensions gives dim S = 	
j dim Sj
= 	
j n2
j = dim(A/ rad A). Thus dim A = dim S+dim(rad A), and we conclude
that A = S ⊕rad A as vector spaces.
□
6. Semisimplicity and Tensor Products
In this section we shall complete the proof of Wedderburn’s Main Theorem
(Theorem 2.17). In the previous section we proved in Corollary 2.28 the special
case in which A/ rad A is isomorphic to a product of full matrix rings over the
base ﬁeld F. This special case includes all cases of Theorem 2.17 in which F is
algebraically closed.
The idea for the general case is to make a change of rings by tensoring A with
the algebraic closure of the underlying ﬁeld F, or at least with a large enough
ﬁnite extension K of F for Corollary 2.28 to be applicable. That is, we ﬁrst
consider AK = A ⊗F K and (A/ rad A)⊗F K in place of A and A/ rad A. Inside
AK we can recognize (rad A) ⊗F K as a subalgebra deﬁned over K, and we
expect that it is rad AK and that we can ﬁnd a complementary subalgebra S over
II. Wedderburn–Artin Ring Theory

6. Semisimplicity and Tensor Products
105
K; then the question is one of showing that S is of the form S0 ⊗F K for some
semisimple subalgebra S0 of A deﬁned over F. The trouble with this style of
argument is that the tensor product (A/ rad A) ⊗F K need not be semisimple and
there need not be a candidate for S. Some question about separability of ﬁeld
extensions plays a role, as the following example shows, and the assumption of
characteristic 0 will ensure this separability.
EXAMPLE. We exhibit two extension ﬁelds K and L of a base ﬁeld F such that
K ⊗F L is not a semisimple algebra over F. The ﬁeld extensions are each 1-by-1
matrix algebras over an extension ﬁeld of F and hence are simple algebras, yet
the tensor product is not semisimple. Fix a prime ﬁeld Fp, and let F = Fp(x p) be
a simple transcendental extension of Fp. Deﬁne K = L = Fp(x) = F(
p√
x p ).
Both K and L are ﬁeld extensions of F of degree p. Thus K ⊗F L is a ﬁnite-
dimensional commutative algebra with identity over F, by the construction in
Proposition 10.24 of Basic Algebra. The element z = x ⊗1 −1 ⊗x in K ⊗F L
is nonzero but has z p = x p ⊗1−1⊗x p = x p ⊗1−x p ⊗1 = 0, the next-to-last
equality following because x p lies in the base ﬁeld F. Consequently K ⊗F L has
a nonzero nilpotent element. If K ⊗F L were semisimple, Theorem 2.2 would
show that it was the direct product of ﬁelds, and it could not have any nonzero
nilpotent elements. We conclude that K ⊗F L is not a semisimple algebra.
Proposition 2.29. Let F be a ﬁeld, let K = F(α) be a simple algebraic
extension, let g(X) be the minimal polynomial of α over F, and let L be another
ﬁeld extension of F. Then
(a) K ⊗F L ∼= L[X]/(g(X)) as associative algebras over L,
(b) K ⊗F L is a semisimple algebra if the polynomial g(X) is separable.
REMARKS. Proposition 10.24 of Basic Algebra shows that the tensor product
A ⊗F B of two associative algebras with identity over F has a unique associative
algebra structure such that (a1 ⊗b1)(a2 ⊗b2) = a1a2 ⊗b1b2. Problem 8 at the
end of Chapter X shows that if B is an extension ﬁeld of F, then A⊗F B is in fact
an associative algebra with identity over B, the multiplication by b ∈B being
given by the mapping 1 ⊗(left by b).
PROOF. For(a), letn = [K : F]. Formthe F bilinearmappingof F[X]×L into
L[X] given by (P(X), ℓ) 	→ℓP(X). Corresponding to this F bilinear mapping
is a unique F linear map ϕ : F[X] ⊗F L →L[X] carrying P(X) ⊗ℓto ℓP(X)
for P(X) ∈F[X] and ℓ∈L. The F vector space F[X]⊗F L is an L vector space
with multiplication by ℓ0 ∈L given by the linear mapping 1⊗(left by ℓ0). Since
ϕ

(1⊗(left by ℓ0))(P(X)⊗ℓ)

= ℓ0ℓP(X) = ℓ0ϕ(P(X)⊗ℓ)), ϕ is L linear. In
addition, ϕ((P(X)⊗ℓ)(Q(X)⊗ℓ′)) = ϕ(P(X)Q(X)⊗ℓℓ′) = ℓℓ′P(X)Q(X) =
ϕ(P(X) ⊗ℓ)ϕ(Q(X) ⊗ℓ′), and therefore ϕ is an algebra homomorphism.

106
We follow ϕ with the quotient homomorphism ψ : L[X] →L[X]/(g(X)),
and the composition ψϕ is 0 on the ideal (g(x)) ⊗F L of F[X] ⊗F L. Therefore
ψϕ descends to a homomorphism (F[X]/(g(X)))⊗F L →L[X]/(g(X)), hence
to a homomorphism η : K ⊗F L →L[X]/(g(X)). Since ϕ and ψ are onto, so
is η.
It is enough to prove that η is one-one. Thus suppose that η
 	
i ki ⊗ℓi

= 0
with all ki in K, all ℓi in L, and the ℓi linearly independent over F. Write
ki = Pi(X)+(g(X)) with deg Pi(X) < n whenever Pi ̸= 0. Then 	
i ℓi Pi(X) ≡
0 mod g(X). Since g(X) has degree n and each nonzero Pi(X) has degree at
most n, 	
i ℓi Pi(X) = 0. Write Pi(X) = 	
j ci j X j with each ci j in F. Then
	
j
 	
i ℓici j

X j = 0, and 	
i ℓici j = 0 for all j. Since the ℓi are linearly
independent over F, ci j = 0 for all i and j. Thus ki = 0 for all i, 	
i ki ⊗ℓi = 0,
and η is one-one. This proves (a).
For (b), factor g(X) over L as g1(X) · · · gm(X) for polynomials gj(X) irre-
ducible over L. Since the separability of g forces g1, . . . , gm to be relatively
prime in pairs, the Chinese Remainder Theorem implies that
L[X]/(g1(X) · · · gm(X)) ∼= L[X]/(g1(X)) × · · · × L[X]/(gm(X)).
Each L[X]/(gj(X)) is a ﬁeld, and thus L[X]/(g(X)) is exhibited as a product of
ﬁelds and is semisimple.
□
Corollary 2.30. Let F be a ﬁeld, let K be a ﬁnite separable algebraic extension
of F, and let L be another ﬁeld extension of F. Then the algebra K ⊗F L is
semisimple.
REMARKS. The condition of separability of the extension K/F is automatic
in characteristic 0. The two ﬁeld extensions K and L in the example before
Proposition 2.29 both failed to be separable extensions of the base ﬁeld F.
PROOF. The Theorem of the Primitive Element (Theorem 9.34 of Basic Al-
gebra) shows that K/F is a simple extension, say with K = F(α). Since this
extension is assumed separable, the minimal polynomial over F of any element of
K is a separable polynomial. The hypotheses of Proposition 2.29b are therefore
satisﬁed, and K ⊗F L is semisimple.
□
Proposition 2.31. Suppose that A and B are algebras with identity over a ﬁeld
F, that B is simple, and that B has center F. Then the two-sided ideals of the
tensor-product algebra A ⊗F B are all subsets I ⊗F B such that I is a two-sided
ideal of A.
PROOF. The set I ⊗F B is a two-sided ideal of A⊗F B, since (a ⊗b)(i ⊗b′) =
ai ⊗bb′ and since a similar identity applies to multiplication in the other order.
II. Wedderburn–Artin Ring Theory

6. Semisimplicity and Tensor Products
107
Conversely suppose that J is an ideal in A ⊗F B. Let 1B be the identity of B,
and deﬁne I = {a ∈A | a ⊗1B ∈J}. Then I is a two-sided ideal of A, and we
shall prove that J = I ⊗F B. The easy inclusion is I ⊗F B ⊆J. For this, let
i be in I and b be in B. Then i ⊗1B is in J and 1A ⊗b is in A ⊗F B. Their
product i ⊗b has to be in J, and thus I ⊗F B ⊆J.
For the reverse inclusion, take a basis {xi} of I over F and extend it to a basis
of A by adjoining some vectors {yj}. It is enough to show that any ﬁnite sum
	
j yj ⊗bj in J necessarily has all bj equal to 0. Arguing by contradiction,
suppose that 	m
k=1 yjk ⊗bjk is a nonzero sum in J with m as small as possible
and in particular with all bjk nonzero. Let H be the subset of B deﬁned by
H =
(
cj1

m	
k=1
yjk ⊗cjk ∈J for some m-tuple {cjk} ⊆B
)
.
The set H is a two-sided ideal of B containing the nonzero element bj1 of B.
Since B is simple by assumption, H = B. Thus 1B is in H. Therefore some
element
yj1 ⊗1B +
m	
k=2
yjk ⊗cjk
is in J. Let b ∈B be arbitrary. Multiplying the displayed element on the left and
right by 1A ⊗b and subtracting the results shows that
yj2 ⊗(bcj2 −cj2b) + · · · + yjm ⊗(bcjm −cjmb)
is in J. Since m was chosen to be minimal, this element must be 0 for all choices
of b. Then all coefﬁcients are 0, and the conclusion is that all coefﬁcients cjk are
in the center of B, which is F by assumption. Consequently we can rewrite our
element of J as
yj1⊗1B+
m	
k=2
yjk⊗cjk = yj1⊗1B+
m	
k=2
cjk yjk⊗1B =

yj1+cj2 yj2+· · ·+cjm yjm

⊗1B.
The deﬁnition of I shows that the factor yj1 +cj2 yj2 +· · ·+cjm yjm in the pure tensor
on the right is in I. Since the yj’s form a basis of a vector-space complement to
I, this vector must be 0. The linear independence of the yj’s over F forces each
coefﬁcient to be 0, and we have arrived at a contradiction because the coefﬁcient
of yj1 is 1, not 0.
□
Lemma 2.32. The center of a ﬁnite-dimensional simple algebra A over a ﬁeld
F is a ﬁeld that is a ﬁnite extension of F.
PROOF. By Theorem 2.4, A ∼= Mn(D) for some ﬁnite-dimensional division
algebra D over F. Let Z be the center of A. By inspection this consists of the
scalar matrices whose entries lie in the center of D. The center of D is a ﬁeld.
Hence Z is a ﬁeld, necessarily a ﬁnite extension of F.
□

108
Proposition 2.33. Let A be a ﬁnite-dimensional semisimple algebra over a
ﬁeld F of characteristic 0, and suppose that K is a ﬁeld containing F. Then the
algebra A ⊗F K over K is semisimple.
PROOF. Since the tensor product of a ﬁnite direct sum is the direct sum of tensor
products, we may assume without loss of generality that A is simple. Lemma 2.32
shows that the center Z of A is a ﬁnite extension ﬁeld of F. By Corollary 2.30
and the assumption that F has characteristic 0, the algebra Z ⊗F K is semisimple.
Being commutative, it must be of the form K1 ⊕· · · ⊕Ks with each ideal Ki
equal to a ﬁeld, by Theorem 2.2.
Each ideal Ki is a unital Z ⊗F K module, hence is both a unital Z module and
a unital K module. Thus we can regard each Ki as an extension ﬁeld of Z or of
K, whichever we choose. First let us regard Ki as an extension ﬁeld of Z. Since
Ki has no nontrivial ideals and A has center Z, Proposition 2.31 shows that the
Z algebra A ⊗Z Ki is simple as a ring.
Next let us regard Ki as an extension ﬁeld of K; since A is ﬁnite-dimensional
over F, so is Z. Therefore Z ⊗F K is ﬁnite-dimensional over K, and Ki is a
ﬁnite extension of K. Hence A ⊗Z Ki is a ﬁnite-dimensional algebra over K,
and it is left Artinian as a ring.
By Theorem 2.6, any left Artinian simple ring such as A ⊗Z Ki is neces-
sarily semisimple. Using the associativity formula for tensor products given in
Proposition 10.22 of Basic Algebra, we obtain an isomorphism of rings
A ⊗F K ∼= (A ⊗Z Z) ⊗F K ∼= A ⊗Z (Z ⊗F K)
∼= A ⊗Z (K1 ⊕· · · ⊕Ks) ∼=
s!
j=1
(A ⊗Z Kj),
the summands being two-sided ideals in each case. Since each A ⊗Z Kj is a
ﬁnite-dimensional simple algebra over K, A ⊗F K is a semisimple algebra over
K by Theorem 2.4.
□
Let us digress for a moment, returning in Lemma 2.34 to the argument that
leads to the proof of Theorem 2.17. In the next section we shall want to know
circumstances under which we can draw the same conclusion as in Proposition
2.33 without assuming that the characteristic is 0. Write the ﬁnite-dimensional
semisimple algebra A as A = Mn1(D1) × · · · × Mnr(Dr), where each Dr is a
division algebra over F. Let Z1, . . . , Zr be the respective centers of the simple
factors of A. Lemma 2.32 observes that each Zj is a ﬁnite extension ﬁeld of F.
The proof of Proposition 2.33 appealed to Corollary 2.30 to conclude from the
condition characteristic 0 that Zj ⊗F K is semisimple. Instead, by rereading the
statement of Corollary 2.30, we see that it would have been enough for each Zj to
be a ﬁnite separable ﬁeld extension of F, even if F did not have characteristic 0.
II. Wedderburn–Artin Ring Theory

6. Semisimplicity and Tensor Products
109
Then the rest of the above proof goes through without change. Accordingly we
deﬁne a ﬁnite-dimensional semisimple algebra A over a ﬁeld F to be a separable
semisimple algebra if the center of each simple component of A is a separable
extension ﬁeld of F. In terms of this deﬁnition, we obtain the following improved
version of Proposition 2.33.
Proposition 2.33′. Let A be a ﬁnite-dimensional separable semisimple algebra
overa ﬁeld F, andsuppose that K isa ﬁeldcontaining F. Thenthe algebra A⊗F K
over K is semisimple.
Lemma 2.34. Suppose that A is a ﬁnite-dimensional algebra with identity
over a ﬁeld F, and suppose that N is a nilpotent two-sided ideal of A such that
the algebra A/N is semisimple. Then N = rad A.
PROOF. The algebra A is left Artinian, being ﬁnite-dimensional. Since N
is nilpotent, we must have N ⊆rad A. The two-sided ideal (rad A)/N of the
semisimple algebra A/N is nilpotent and hence must be 0. Therefore N = rad A.
□
PROOF OF THEOREM 2.17. Let A be the given ﬁnite-dimensional algebra of the
ﬁeld F ofcharacteristic 0, andwrite N forrad A and A for A/N. Foranyextension
ﬁeld K of F, we write AK = A ⊗F K, NK = N ⊗F K, and AK = A ⊗F K.
For most of the proof, we shall treat the special case that N 2 = 0.
Let
F be an algebraic closure of F. Then AF = A ⊗F F = (A/N) ⊗F F ∼=
(A ⊗F F)/(N ⊗F F) = AF/NF. Proposition 2.33 shows that AF = A ⊗F F is
a semisimple algebra over F, and the claim is that the two-sided ideal NF of AF
is nilpotent. In fact, any element of NF is a ﬁnite sum of the form 	
i (ai ⊗ci)
with each ai in N and each ci in F. The product of this element with 	
j (a′
j ⊗c′
j)
is 	
i, j (aia′
j ⊗cic′
j), and this is 0 because the assumption N 2 = 0 implies that
aia′
j = 0 for all i and j. Thus N 2
F = 0, and NF is nilpotent.
Since AF/NF is semisimple and NF is nilpotent, Lemma 2.34 shows that
NF = rad(AF). Corollary 2.28 (a special case of Theorem 2.17) is applicable to
AF because F is algebraically closed, and it follows that there exists a subalgebra
S of AF such that AF = S ⊕NF as vector spaces. Here S is a product of ﬁnitely
many algebras Mnj(F). The embedded matrix units ei j of S obtained from each
Mnj(F) are members of AF = A ⊗F F and hence are of the form 	
l xl ⊗cl,
where {xl}n
l=1 is a vector-space basis of A over F and each cl is in F. Only ﬁnitely
many such cl’s are needed to handle all ei j’s, and we let K be a ﬁnite extension
of F within F containing all of them. Let ρ0 = 1, ρ1, . . . , ρs be a vector-space
basis of K over F.

110
Relative to this K, we form AK, NK, and AK as in the ﬁrst paragraph of the
proof. The same argument as with F shows that AK ∼= AK/NK is semisimple
and that NK is nilpotent. By Lemma 2.34, NK = rad AK. The formulas for the
ei j’s in the previous paragraph are valid in AK and give us a system of matrix
units. As in the previous paragraph, Corollary 2.28 produces a subalgebra S of
AK isomorphic to some Mn1(K) × · · · × Mnr(K) such that AK = S ⊕NK as
vector spaces.
In the basis {xi}n
i=1 of A over F, we may assume that the ﬁrst t vectors form
a basis of N = rad A and the remaining vectors form a basis of a vector-space
complement to N. We identify members a of A with members a ⊗1 of AK.
With this identiﬁcation in force, we decompose each basis vector xi for i > t
according to AK = S ⊕NK as xi = yi −zi with yi ∈S and zi ∈NK. Since the
xi’s for i ≤t are in N ⊆NK, the vectors yi with i > t form a vector-space basis
of S over K. For i > t, write zi = 	s
j=0 zi j ⊗ρj with zi j in N. Then we have
yi = xi + zi = (xi + zi0) +
s	
j=1
zi j ⊗ρj
for i > t.
Put
x′
i = xi + zi0
and
z′
i =
s	
j=1
zi j ⊗ρj
for i > t.
Then {xi}t
i=1 ∪{x′
i}n
i=t+1 is a basis of A over F.
We shall show that S0 =
	n
i=t+1 Fx′
i is a subalgebra of A, and then A = S0 ⊕N will be the required
decomposition.
Let x′
i and x′
j be given with i > t and j > t, and write
x′
ix′
j = 	
k γki jx′
k + vi j
with γki j ∈F and vi j ∈N.
Substituting x′
i = yi −z′
i and taking into account that NK is an ideal in AK, we
have
yi yj ≡	
k
γki jx′
k mod NK ≡	
k
γki j yk mod NK.
Then yi yj = 	
k γki j yk + ui j with each ui j ∈NK. Since the yi are in S and S
is a subalgebra, ui j = 0. Thus yi yj = 	
k γki j yk. Let us resubstitute into this
equality from yi = x′
i + z′
i. Taking into account that z′
iz′
j = 0 because N 2
K = 0,
we obtain
x′
ix′
j + x′
iz′
j + z′
ix′
j = 	
k
γki jx′
k + 	
k
γki jz′
k.
Substituting from z′
i = 	s
j=1 zi j ⊗ρj gives
x′
ix′
j ⊗1 +
s	
l=1
x′
izjl ⊗ρl +
s	
l=1
zilx′
j ⊗ρl = 	
k
γki jx′
k ⊗1 + 	
k
s	
l=1
γki jzkl ⊗ρl.
II. Wedderburn–Artin Ring Theory

7. Skolem–Noether Theorem
111
The coefﬁcients of ρ0 = 1 must be equal, and therefore
x′
ix′
j = 	
k
γki jx′
k.
This equation shows that S0 is a subalgebra and completes the proof under the
hypothesis that N 2 = 0.
Now we drop the assumption that N 2 = 0.
We shall prove the theorem
by induction on dimF A, the base cases of the induction being dimF A = 0
and dimF A = 1, for which the theorem is immediate by inspection. For the
inductive case, let A be given, and assume the theorem to be known for algebras of
dimension < dimF A. If N 2 = 0, then we are done. Thus we may assume that the
product ideal N 2 is nonzero and therefore that dimF(A/N 2) < dimF A. The First
Isomorphism Theorem shows that (A/N 2)

(N/N 2) ∼= A/N = A. The quotient
A/N is semisimple, and N/N 2 is a nilpotent ideal in A/N 2. By Lemma 2.34,
N/N 2 = rad(A/N 2). The inductive hypothesis gives A/N = S1/N 2 ⊕N/N 2
for a subalgebra S1 of A with S1 ⊇N 2. This means that A = S1 + N and
S1 ∩N = N 2. Here
dimF A = dimF(S1 + N) = dimF S1 + dimF N −dimF(S1 ∩N)
= dimF S1 + dimF N −dimF N 2 = dimF S1 + dimF(N/N 2),
and N/N 2 ̸= 0 implies dimF S1 < dimF A. The Second Isomorphism Theorem
gives A/N = (S1 + N)/N ∼= S1/(S1 ∩N) = S1/N 2. Thus S1/N 2 is semisimple.
Since N 2 is nilpotent, Lemma 2.34 shows that N 2 = rad S1. The inductive
hypothesis gives S1 = S ⊕N 2 for a semisimple subalgebra S. Substituting
into A = S1 + N, we obtain A = (S ⊕N 2) + N = S + N. Meanwhile,
S ∩N = (S ∩S1) ∩N = S ∩(S1 ∩N) = S ∩N 2 = 0. Therefore A = S ⊕N,
and the induction is complete.
□
7. Skolem–Noether Theorem
In this section we begin an investigation of division algebras that are ﬁnite-
dimensional over a given ﬁeld F. A nonzero algebra A with identity over a ﬁeld
F will be called central if the center of A consists exactly of the scalar multiples
of the identity, i.e., if center(A) = F. Of special interest will be algebras with
identity that are central simple, i.e., are both central and simple.
Lemma 2.35. Let A and B be algebras with identity over a ﬁeld F, and
suppose that B is central. Then
(a) the members of A⊗F B commuting with 1⊗B are the members of A⊗1,
(b) center(A ⊗F B) = (center A) ⊗F 1.

112
PROOF. For (a), suppose that z = 	
i ai ⊗bi commutes with 1 ⊗B and that
the ai are linearly independent over F. If b is in B, then
0 = (1 ⊗b)z −z(1 ⊗b) = 	
i
ai ⊗(bbi −bib),
from which it follows that bbi −bib = 0 for all b and all i. Since B is central,
each bi is in F, and we can write z as
z = 	
i
ai ⊗bi = 	
i
(aibi ⊗1) =
 	
i
aibi

⊗1.
In other words, z is of the form z = a ⊗1.
For (b), we need to prove the inclusion ⊆. Thus let z be in center(A ⊗F B).
By (a), z is of the form z = a ⊗1 for some a ∈A. Now suppose that a′ is in A.
Then 0 = (a′ ⊗1)z −z(a′ ⊗1) = (a′a −aa′) ⊗1. Hence a′a = aa′, and we
conclude that a is in center(A).
□
Proposition 2.36. Let A and B be algebras with identity over a ﬁeld F, and
suppose that B is central simple. Then
(a) A simple implies A ⊗F B simple,
(b) A central simple implies A ⊗F B central simple.
PROOF. For (a), Proposition 2.31 shows that any two-sided ideal of A ⊗F B is
of the form I ⊗F B for some two-sided ideal I of A. Since A is assumed simple,
the only I’s are 0 and A. Thus the only ideals in A ⊗F B are 0 and A ⊗F B, and
A ⊗F B is simple.
For (b), conclusion (a) shows that A ⊗F B is simple. By Lemma 2.35b the
center of A ⊗F B is (center A) ⊗1 = F1 ⊗1 = F(1 ⊗1), and hence A ⊗F B
is central.
□
Corollary 2.37. If A and B are ﬁnite-dimensional semisimple algebras over a
ﬁeld F and at least one of them is separable over F, then A ⊗F B is semisimple.
REMARK. The deﬁnition of separability of A or B appears between Proposition
2.33 and Proposition 2.33′.
PROOF. Without loss of generality, we may assume that A and B are simple.
For deﬁniteness let us say that A is the given separable algebra over F. Let
K = center(B). Lemma 2.32 shows that K is a ﬁeld, and associativity of tensor
products allows us to write
A ⊗F B ∼= A ⊗F (K ⊗K B) ∼= (A ⊗F K) ⊗K B.
Here A ⊗F K is semisimple by Proposition 2.33′, and B is central simple over
K. Thus Proposition 2.36a applies and shows that (A ⊗F K) ⊗K B is simple. □
II. Wedderburn–Artin Ring Theory

113
Corollary 2.38. Let A be a central simple algebra of ﬁnite dimension n over
a ﬁeld F, and let Ao be the opposite algebra. Then A ⊗F Ao ∼= Mn(F).
EXAMPLE.
Take F = R and A = H, the algebra of quaternions.
Then
conjugation, with 1 	→1 and i, j, k 	→−i, −j, −k, is an antiautomorphism of
H. Consequently H o ∼= H. The corollary says in this case that H⊗RH ∼= M4(R).
PROOF. Let V be A considered as a vector space. For eacha0 ∈A, we associate
the members l(a0) and r(a0) of EndF(V ) given by l(a0)a = a0a and r(a0)a =
aa0.
Then l(a0a′
0) = l(a0)l(a′
0) and r(a0a′
0) = r(a′
0)r(a0), and it follows
that l : A →EndF(V ) and r : Ao →EndF(V ) are algebra homomorphisms
sending 1 to 1.
Meanwhile, the map A × Ao →EndF(V ) given by (a, a′) 	→l(a)r(a′) is F
bilinear and extends to an F linear map ϕ : A⊗F Ao →EndF(V ). Because of the
homomorphism properties ofl and r, the mapping ϕ is an algebra homomorphism
sending 1 to 1. Proposition 2.36 shows that A ⊗F Ao is simple, and it follows
that ϕ is one-one. Since dimF(A ⊗F Ao) = (dimF A)2 = dimF EndF(V ), ϕ is
onto.
□
Corollary 2.39. Let A be a central simple algebra of ﬁnite dimension d over
a ﬁeld F. Then d is the square of an integer.
PROOF. Let F be an algebraic closure of F. Proposition 2.36a shows that
the algebra F ⊗F A is simple, and its dimension over F is d. A simple ﬁnite-
dimensional algebra over an algebraically closed ﬁeld is a full matrix algebra over
that ﬁeld, and thus F ⊗F A ∼= Mn(F). Comparing dimensions over F, we see
that d = n2.
□
Corollary 2.40. If D is a division algebra ﬁnite-dimensional over its center
F, then dimF D is the square of an integer.
PROOF. The algebra D is central simple over its center F, and the result is
immediate from Corollary 2.39.
□
Theorem 2.41 (Skolem–Noether Theorem). Let A be a ﬁnite-dimensional
central simple algebra over the ﬁeld F, and let B be any simple algebra over F.
Suppose that f and g are F algebra homomorphisms of B into A carrying the
identity to the identity. Then there exists an x ∈A with f (b) = xg(b)x−1 for all
b in B.
PROOF. Let us observe that the homomorphisms f and g are one-one because
B is simple, and the ﬁnite dimensionality of A therefore forces B to be ﬁnite-
dimensional.
7. Skolem–Noether Theorem

114
We consider ﬁrst the special case that A = Mn(F) for some n. The homomor-
phism f makes the space Fn of column vectors into a unital left B module by
the deﬁnition bv = f (b)v, and similarly the homomorphism g makes Fn into a
unital left B module. Since B is ﬁnite-dimensional and simple, an argument given
with Example 1 of semisimple rings in Section 2 shows that there is only one
simple left B module up to isomorphism and that every unital left B module is a
direct sum of copies of this simple left B module. Consequently the isomorphism
classes of the B modules determined by f and g depend only on their dimension.
The dimension is n in both cases, and hence there exists an invertible F linear
map L : Fn →Fn such that L f (b)v = g(b)Lv for all v ∈Fn. If L is given by
the matrix x−1 in Mn(F), then x−1 f (b) = g(b)x−1, and the theorem is therefore
proved in this special case.
For the general case we form the tensor products B ⊗F Ao and A ⊗F Ao. The
maps f ⊗1 and g ⊗1 are F algebra homomorphisms between these algebras,
B ⊗F Ao is simple by Proposition 2.36a, and Corollary 2.38 shows that A ⊗F Ao
is isomorphic to Mn(F) for the integer n = dim A. The special case is applicable,
and we obtain an invertible element X of A ⊗F Ao such that
( f ⊗1)(b ⊗ao) = X(g ⊗1)(b ⊗ao)X−1
for all b ∈B and ao ∈Ao.
(∗)
Taking b = 1, we see that 1 ⊗ao = X(1 ⊗ao)X−1 for all ao ∈Ao. By Lemma
2.35a, X lies in A⊗1, hence is of the form X = x⊗1 for some x in A. Substituting
for X in (∗), we obtain f (b) = xg(b)x−1 as required.
□
Corollary 2.42. If A is a ﬁnite-dimensional central simple algebra over the
ﬁeld F, then every F automorphism of A is inner in the sense of being given by
conjugation by an invertible element of A.
PROOF. This is the special cse of Theorem 2.41 in which B = A and g is the
identity map on B.
□
8. Double Centralizer Theorem
We saw in Corollary 2.40 that if D is a division algebra ﬁnite-dimensional over
its center F, then dimF D is the square of an integer. In this section we shall
prove a theorem from which we can conclude that the positive integer of which
dimF D is the square is the dimension of any maximal subﬁeld of D. We state the
theorem, establish two lemmas, prove the theorem, and then derive two corollaries
concerning maximal subﬁelds of division algebras.
If A is an algebra with identity and B is a subalgebra containing the identity,
then the centralizer of B in A is the subalgebra of all members of A commuting
with every element of B.
II. Wedderburn–Artin Ring Theory

8. Double Centralizer Theorem
115
Theorem 2.43 (Double Centralizer Theorem). Let A be a ﬁnite-dimensional
central simple algebra over a ﬁeld F, let B be a simple subalgebra of A, and let
C be the centralizer of B in A. Then C is simple, B is the centralizer of C in A,
and (dimF B)(dimF C) = dimF A.
Lemma 2.44. Let A and A′ be algebras with identity over a ﬁeld F, let B and
B′ be subalgebras of them, and let C and C′ be the centralizers of B and B′ in A
and A′, respectively. Then the centralizer of B ⊗F B′ in A ⊗F A′ is C ⊗F C′.
PROOF. Expand an element of A⊗F A′ for the moment as x = 	
i ai ⊗a′
i with
the elements a′
i linearly independent over F. If x satisﬁes x(b ⊗1) = (b ⊗1)x
for all b in B, then 	
i (aib −bai) ⊗a′
i = 0. Since the a′
i’s are independent,
aib −bai = 0 for all i, and each ai is in C. Thus the centralizer of B ⊗F 1 is
C ⊗F A′.
Rewriting x with the ai’s assumed independent, we see similarly that the
centralizer of 1⊗F B′ is A ⊗F C′. Putting these conclusions together, we see that
centralizer(B ⊗F B′) ⊆centralizer(B ⊗F 1) ∩centralizer(1 ⊗F B′)
= (C ⊗F A′) ∩(A ⊗F C′) = C ⊗F C′.
The reverse inclusion, namely centralizer(B ⊗F B′) ⊇C ⊗F C′, is immediate,
and the lemma follows.
□
Lemma 2.45. Let B be a ﬁnite-dimensional simple algebra over a ﬁeld F, and
write V for the algebra B considered as a vector space. For b in B and v in V ,
deﬁne members l(b) and r(b) of EndF(V ) by l(b)v = bv and r(b)v = vb. Then
the centralizer in EndF(V ) of l(B) is r(B).
PROOF. Let K be the center of B. This is an extension ﬁeld of F by Lemma
2.32, and B is central simple over K. Let us see that any member a of EndF(V )
that centralizes l(B) is actually in EndK(V ). If c is in K, then c is in particular
in B, and therefore al(c) = l(c)a. Applying this equality to v ∈V yields
a(cv) = ca(v), and this equality for all c ∈K says that a is in EndK(V ).
Thus it is enough to show that the centralizer of l(B) in EndK(V ) is r(B).
We argue as in the proof of Corollary 2.38: The deﬁnitions of l and r make V
into a unital left B module and a unital right B module, and the members of K
operate consistently on either side of V because K lies in the center of B. The
function (b, b′) 	→l(b)r(b′) is therefore K bilinear, and it extends to the tensor
product B ⊗K Bo as an algebra homomorphism ϕ : B ⊗K Bo 	→EndK(V ). The
homomorphismϕ isone-one, sinceProposition2.36ashows B⊗K Bo tobesimple.
The dimensional equality dimK(B ⊗K Bo) = (dimK B)2 = dimK(EndK(V ))
allows us to conclude that ϕ is onto, hence is an isomorphism.

116
Lemma 2.35a shows that the centralizer of B ⊗K 1 in B ⊗K Bo is 1 ⊗K Bo.
If this statement is translated from the context of B ⊗K Bo into the isomorphic
context of EndK(V ), then the centralizer of l(B) in EndK(V ) is r(B), and we
saw that this fact is sufﬁcient to imply the lemma.
□
PROOF OF THEOREM 2.43. Let V be the algebra B considered as a vector
space over F, and let l(B) and r(B) be the sets of those members of EndF(V )
that are given by left multiplication and right multiplication by members of B.
The algebra A is central simple by assumption, and EndF(V ) is central simple,
being isomorphic to Mn(F) for the integer n = dimF(V ). By Proposition 2.36b,
A ⊗F EndF(V ) is central simple. We deﬁne two algebra homomorphisms f and
g of B into A ⊗F EndF(V ) by f (b) = l(b) ⊗1 and g(b) = 1 ⊗l(b).
The Skolem–Noether Theorem (Theorem 2.41) produces an element x of
A ⊗F EndF(V ) with f (b) = xg(b)x−1 for all b ∈B. Hence
B ⊗F 1 = x(1 ⊗F l(B))x−1.
(∗)
Lemma 2.44 shows that the centralizer of B ⊗F 1 in A ⊗F EndF(V ) is
C ⊗F EndF(V ) and that the centralizer of 1 ⊗F l(B) is A ⊗F r(B).
From
the latter identiﬁcation the centralizer of x(1 ⊗F l(B))x−1 is x(A ⊗F r(B))x−1.
Combining (∗) with these computations of centralizers, we see that
C ⊗F EndF(V ) = x(A ⊗F r(B))x−1.
(∗∗)
The algebra A⊗F r(B) is isomorphic to A⊗F Bo, which is simple by Proposition
2.36a. Therefore C ⊗F EndF(V ) is simple, and C has to be simple.
Equating the dimensions of the two sides of (∗∗) gives
(dimF C)(dimF B)2 = (dimF C)(dimF EndF(V )) = dimF(C ⊗F EndF(V ))
= dimF(A ⊗F r(B)) = (dimF A)(dimF B),
and hence
(dimF C)(dimF B) = dimF A.
Finally the centralizer D of C contains B, and two applications of the dimensional
equality gives
(dimF D)(dimF C) = dimF A = (dimF C)(dimF B).
Thus dimF D = dimF B, and we must have D = B. In other words, B is the
centralizer of C.
□
II. Wedderburn–Artin Ring Theory

9. Wedderburn's Theorem about Finite Division Rings
117
Corollary 2.46. Let D be a central ﬁnite-dimensional division algebra over
the ﬁeld F. If K is any maximal subﬁeld of D, then dimF D = (dimF K)2.
PROOF. Apply the Double Centralizer Theorem (Theorem 2.43) with A =
D. Let Z(K) be the centralizer of the simple subalgebra K in D. Since K is
commutative, K ⊆Z(K). If a is in Z(K) but not K, then K(a) is a ﬁeld in D
properly containing K, in contradiction to the assumption that K is a maximal
subﬁeld of D. Hence K = Z(K). The dimensional equality in the theorem
therefore gives dimF D = (dimF K)(dimF Z(K)) = (dimF K)2.
□
Corollary 2.47. Let A be a ﬁnite-dimensional central simple algebra over a
ﬁeld F, and let K be a subﬁeld of A. Then the following are equivalent:
(a) K is its own centralizer,
(b) dimF A = (dimF K)2,
(c) K is a maximal commutative subalgebra of A.
PROOF. Let Z(K) be the centralizer of K in A. The Double Centralizer
Theorem (Theorem 2.43) gives the equality
dimF A = (dimF K)(dimF Z(K)).
(∗)
If (a) holds, then Z(K) = K, and (∗) yields (b).
If (b) holds, then (∗) and the equality dimF A = (dimF K)2 together imply
that dimF Z(K) = dimF K. Since K is commutative, Z(K) ⊇K. The equality
of dimensions implies that Z(K) = K, and then (c) follows.
If (c) holds, we start from the inclusion K ⊆Z(K). If x is in Z(K) but
not K, then K(x) is a ﬁeld strictly larger than K, in contradiction to (c). Thus
K = Z(K), and (a) holds.
□
9. Wedderburn’s Theorem about Finite Division Rings
The theorem of this section is as follows.
Theorem 2.48 (Wedderburn). Every ﬁnite division ring is a ﬁeld.
The proof will be preceded by a lemma.
Lemma 2.49.
If G is a ﬁnite group and H is a proper subgroup, then

g∈G gHg−1 does not exhaust G.

118
PROOF. In the union 
g∈G gHg−1, the terms corresponding to g and to gh, for
h in H, are the same because (gh)H(gh)−1 = g(hHh−1)g−1 = gHg−1. Thus
the union can be rewritten as 
gH gHg−1, it being understood that only one g is
used from each coset gH. From this rewritten form of the union, we see that the
number of elements other than the identity in the union is
≤[G : H](|H| −1) = [G : H]|H| −[G : H] = |G| −[G : H] < |G| −1,
and the lemma follows.
□
PROOF OF THEOREM 2.48. Let D be a ﬁnite division ring, and let F be the
center. Then F is a ﬁeld, say of q elements. Maximal subﬁelds of D certainly
exist. Any such subﬁeld K has dimF D = (dimF K)2 by Corollary 2.46, and
hence any two such subﬁelds K and K ′ are isomorphic. The Skolem–Noether
Theorem (Theorem 2.41) shows that K ′ = x K x−1 for some invertible x in the
group D× of invertible elements of D.
On the other hand, F and any element of D generate a subﬁeld of D, and this
subﬁeld is contained in a maximal subﬁeld. Consequently any element of D is
contained in some such K ′, and D = 
x∈D× x K x−1. Discarding the element 0
from both sides, we obtain D× = 
x∈D× x K ×x−1. Applying Lemma 2.49 to the
group G = D× and the subgroup H = K ×, we see that K × cannot be a proper
subgroup of D×. Therefore D = K, and D is commutative.
□
10. Frobenius’s Theorem about Division Algebras over the Reals
We conclude this chapter by bringing together our results to prove the following
celebrated theorem of Frobenius.
Theorem 2.50 (Frobenius). Up to R isomorphism the only ﬁnite-dimensional
associative division algebras over R are the algebras R of reals, C of complex
numbers, and H of quaternions.
REMARKS. The text of this chapter has not produced any concrete examples
of noncommutative division rings other than the quaternions. Problems 12–16 at
the end of the chapter produce generalized quaternion algebras in which R can
be replaced by many other ﬁelds; there are inﬁnitely many nonisomorphic such
examples when the ﬁeld is Q. In addition, Problems 17–19 produce examples
of central division algebras of dimension 9 over suitable base ﬁelds. The next
chapter will give further insight into the construction of division algebras.
II. Wedderburn–Artin Ring Theory

10. Frobenius's Theorem about Division Algebras over the Reals
119
PROOF. Let D be such a division algebra, and let F be the center. Then
F is a ﬁnite extension ﬁeld of R and must be R or C, since C is algebraically
closed. If F = C, then we have seen that D = C. Thus we may assume that
center(D) = R.
Let K be a maximal subﬁeld of D (existence by ﬁnite dimensionality), and let
n = dimR K. Corollary 2.46 shows that dimR D = n2. Since K has to be R or
C, n has to be 1 or 2. If n = 1, we obtain D ∼= R. Thus we may assume that
n = 2, K = C, and dimR D = 4.
The map f : K →D given by f (a + bi) = a −bi, where i is the member
of K corresponding to √−1 in C, is an algebra homomorphism into a central
simple algebra over R, and so is the map g : K →D given by g(a+bi) = a+bi.
By the Skolem–Noether Theorem (Theorem 2.41), there exists some x in D with
x(a + bi)x−1 = a −bi for all a and b in R.
This element x has the property that x2 commutes with every element of K
and must lie in K, by Corollary 2.47. Let us see that x2 lies in center(D) = R.
In fact, otherwise 1 and x2 would generate K as an R algebra, and every member
of D commuting with 1 and x2 would commute with all of K; since x commutes
with 1 and x2, x would have to commute with K, contradiction. Thus x2 lies
in R.
If x2 > 0, then x2 = r2 for some r ∈R. The elements x and r together lie in
some subﬁeld K ′ of D, and K ′ has no zero divisors. Since (x −r)(x + r) = 0
within K ′, we conclude that x = ±r. Then x commutes with the maximal
subﬁeld K above, and we arrive at a contradiction.
Thus x2 < 0. Write x2 = −y2 for some y ∈R, and put j = y−1x. The
equation x(a+bi)x−1 = a−bi says that j(a+bi) j−1 = a−bi and in particular
that ji j−1 = −i. Deﬁne k = i j.
We have j2 = y−2x2 = −1. Hence k2 = i ji j = i( ji j−1) j2 = i(−i)(−1) =
i2 = −1. Then i jk = −1, and k = −1( j−1)(i−1) = −1(−j)(−i) = −ji;
hence i j + ji = 0.
Let us show that {1, i, j, k} is a linearly independent set over R. Certainly j is
not an R linear combination of 1 and i. If k = a + bi + cj for some a, b, c ∈R,
then squaring gives
−1 = k2 = a2 + b2i2 + c2 j2 + 2abi + 2acj + bc(i j + ji)
= a2 −b2 −c2 + 2abi + 2acj.
Equating coefﬁcients of 1, i, and j, we obtain −1 = a2 −b2 −c2, ab = 0,
and ac = 0. We cannot have −1 = a2, and thus at least one of b and c is
nonzero. Then a = 0, and i j = k = bi + cj. Left multiplication by i gives
−j = −b + ci j = −b + c(bi + cj); equating coefﬁcients shows that b = 0.
Hence i j = cj, and we arrive at the contradiction i = c ∈R. We conclude that
{1, i, j, k} is linearly independent over R.

120
To complete the proof that D is isomorphic to H, we have only to verify that
{1, i, j, k} satisﬁes the usual multiplication table for H. We know that i2 = j2 =
k2 = −1, that k = i j, and that k = −ji. The last of these says that ji = −k.
The other veriﬁcations are
jk = ji j = ( ji j−1) j2 = (−i)(−1) = i,
kj = i j j = i(−1) = −i,
ki = i ji = i( ji j−1) j = i(−i) j = j,
ik = ii j = (−1) j = −j,
and the proof is complete.
□
11. Problems
In all the problems below, all algebras are assumed to be associative.
1.
Let G be a ﬁnite group, and let CG be its complex group algebra. Prove that
CG is a semisimple ring, and identify the constituent matrix algebras that arise
for CG in Theorem 2.2 in terms of the irreducible representations of G.
2.
Wedderburn’s Main Theorem (Theorem 2.17) decomposes ﬁnite-dimensional
algebras A in characteristic 0 as A = S ⊕rad A for some subalgebra S.
(a) What explicitly is a decomposition A = S ⊕rad A for the complex algebra
C[X]/(X2 + 1)2 ?
(b) Is the subalgebra S in (a) unique? Prove that it is, or give a counterexample.
(c) Answer the same questions as for (a) and (b) in the case of the real algebra
R[X]/(X2 + 1)2.
3.
Let A and B be ﬁnite-dimensional algebras with identity over a ﬁeld F, and
suppose that B is central simple. Prove that rad(A ⊗F B) = (rad A) ⊗F B.
Problems 4–7 concern commutative Artinian rings. Let R be such a ring.
4.
Prove that
(a) R has only ﬁnitely many maximal ideals,
(b) rad R is the set of all nilpotent elements in R,
(c) R is semisimple if and only if it has no nonzero nilpotent elements,
(d) R semisimple implies that R is the direct product of ﬁelds.
5.
Let ¯e be an idempotent in R/ rad R.
Prove that the idempotent e ∈R in
Proposition 2.23 with ¯e = e + rad R is unique.
6.
Problem 4a shows that R has only ﬁnitely many maximal ideals. Let N be their
product. Use Nakayama’s Lemma (Lemma 8.51 of Basic Algebra, restated in
the present book on page xxiii) to prove that N is a nilpotent ideal in R.
7.
Deduce from the previous problem that any prime ideal in R contains one of the
ﬁnitely many maximal ideals, hence that every prime ideal in R is maximal.
II. Wedderburn–Artin Ring Theory

11. Problems
121
Problems 8–11 concern triangular rings, which were introduced in an example after
Proposition 2.5. The problems ask for veriﬁcations for some assertions that were
made in that example without proof. The notation is as follows: R and S are rings
with identity, and M is a unital (R, S) bimodule. Deﬁne a set A and operations of
addition and multiplication symbolically by
A =

R
M
0
S

=

r
m
0
s
  r ∈R, m ∈M, s ∈S

with

r
m
0
s
 
r′
m′
0
s′

=

rr′
rm′ + ms′
0
ss′

.
8.
Prove that the left ideals in A are of the form I1 ⊕I2, where I2 is a left ideal in
S and I1 is a left R submodule of R ⊕M containing M I2. (Educational note:
Then similarly the right ideals in A are of the form J1 ⊕J2, where J1 is a right
ideal in R and J2 is a right S submodule of M ⊕S containing J1M.)
9.
(a) Prove that the ring A is left Noetherian if and only if R and S are left
Noetherian and M satisﬁes the ascending chain condition for its left R
submodules.
(b) Prove that the ring A is right Noetherian if and only if R and S are right
Noetherian and M satisﬁes the ascending chain condition for its right S
submodules.
(Educational note: By similar arguments the conclusions
of (a) and (b) remain valid if “Noetherian” is replaced by “Artinian” and
“ascending” is replaced by “descending.”)
10. If A =

R R
0 S

isanyringsuchas

Q Q
0 Z

inwhich S isa(commutative)Noetherian
integral domain with ﬁeld of fractions R and if S ̸= R, prove that A is left
Noetherian and not right Noetherian, and A is neither left nor right Artinian.
11. If A =

R R
0 S

is a ring such as

Q(x) Q(x)
0
Q

in which R and S are ﬁelds with
S ⊆R and dimS R is inﬁnite, prove that A is left Noetherian and left Artinian,
and A is neither right Noetherian nor right Artinian.
Problems 12–16 concern generalized quaternion algebras. Let F be a ﬁeld of
characteristic other than 2, let K be a quadratic extension ﬁeld, and let σ be the
nontrivial element in the Galois group. The ﬁeld K is necessarily of the form K =
F(√m ) for some nonsquare m ∈F, and the elements c of K for which σ(c) = −c
are the F multiples of √m. Fix an element r ̸= 0 of F, and let A be the subset of
M2(K) given by

a
b
rσ(b) σ(a)

.
12. (a) Prove that A is a 4-dimensional algebra over F.
(b) Prove that A is central simple by examining cx −xc for c =
 √m
0
0
−√m

when x ̸= 0 is in a two-sided ideal I and is not in K ∼=
(
a
0
0 σ(a)
)
.

122
13. Prove that A is a division algebra if and only if r is not of the form NK/F(c) for
some c ∈K. Why must A be isomorphic to M2(F) when A is not a division
algebra?
14. Prove that if r and r′ are two members of F such that r = r′NK/F(c) for some c
in K, then the algebra A associated to r is isomorphic to the algebra associated
to r′.
15. Let {1, i, j, k} be the F basis of A consisting of the matrices
1 =

1 0
0 1

,
i =
 √m
0
0
−√m

,
j =

0 1
r 0

,
k =

0
√m
−r√m
0

.
Prove that these satisfy i2 = m1, j2 = r1, k2 = −rm1, i j = k = −ji,
jk = −ri = −kj, and ki = −mj = −ik.
16. By going over the proof of Theorem 2.50 and using the relations of the previous
problem, prove that every central simple algebra of dimension 4 over F is of the
same kind as A for some quadratic extension K = F(√m ) and some member
r ̸= 0 of F.
Problems 17–19 concern cyclic algebras, which were introduced by L. E. Dickson.
These extend the theory of generalized quaternion algebras to other sizes of matrices.
The analogy with the theory in Problems 12–16 is tightest when the size is a prime.
For notational simplicity this set of problems asks about size 3. Let F be any ﬁeld, and
let K be a ﬁnite Galois extension of F with cyclic Galois group. It is assumed in these
problems that K has degree 3 over F and that {1, σ, σ 2} is the Galois group. Fix an
element r ̸= 0 of F, and let A be the subset of M3(K) given by

a
b
c
rσ(c)
σ(a)
σ(b)
rσ 2(b) rσ 2(c) σ 2(a)

.
Identifying a ∈K with the member
 a
0
0
0 σ(a)
0
0
0
σ 2(a)

of A and letting j be the member
 0 1 0
0 0 1
r 0 0

of A allows one to view A as the set of all matrices a + bj + cj2 with
a, b, c ∈K. The element j satisﬁes jaj−1 = σ(a) for a ∈K and j3 = r.
17. Arguing as for Problem 12, show that A is an algebra over F and that it is central
simple of dimension 9.
18. Using the general theory, prove that A either is a division algebra over F or is
isomorphic to M3(F), and that A ∼= M3(F) if and only if there is a 3-dimensional
vector subspace of A that is a left A submodule of A. (Educational note: This
problem makes crucial use of the fact that the size 3 is a prime.)
19. (a) Prove that if r = NK/F(d) for some d ∈K, then the 3-dimensional vector
subspace K(1 + d−1 j + d−1σ(d)−1 j2) of A is a left A submodule.
(b) Prove that any 3-dimensional left K submodule of A is necessarily of the
form K(a0 + b0 j + c0 j2) for some nonzero a0 + b0 j + c0 j2 in A and that
this left K submodule is a left A submodule only if there exists an element
d ∈K with NK/F(d) = r, da0 = rσ(c0), db0 = σ(a0), and dc0 = σ(b0).
II. Wedderburn–Artin Ring Theory

CHAPTER III
Brauer Group
Abstract. This chapter continues the study of ﬁnite-dimensional associative division algebras over
a ﬁeld F, with particular attention to those that are simple and have center F. Section 5 is a self-
contained digression on cohomology of groups that is preparation for an application in Section 6
and for a general treatment of homological algebra in Chapter IV.
Section 1 introduces the Brauer group of F and the relative Brauer group of K/F, K being
any ﬁnite extension ﬁeld. The Brauer group B(F) is the abelian group of equivalence classes of
ﬁnite-dimensional central simple algebras over F under a relation called Brauer equivalence. The
inclusion F ⊆K induces a group homomorphism B(F) →B(K), and the relative Brauer group
B(K/F) is the kernel of this homomorphism. The members of the kernel are those classes such
that the tensor product with K of any member of the class is isomorphic to some full matrix algebra
Mn(K); such a class always has a representative A with dimF A = (dimF K)2. One proves that
B(F) is the union of all B(K/F) as K ranges over all ﬁnite Galois extensions of F.
Sections 2–3 establish a group isomorphism B(K/F) ∼= H2(Gal(K/F), K ×) when K is a ﬁnite
Galois extension of F. With these hypotheses on K and F, Section 2 introduces data called a
factor set for each member of B(K/F). The data depend on some choices, and the effect of making
different choices is to multiply the factor set by a “trivial factor set.” Passage to factor sets thereby
yields a function from B(K/F) to the cohomology group H2(Gal(K/F), K ×). Section 3 shows
how to construct a concrete central simple algebra over F from a factor set, and this construction
is used to show that the function from B(K/F) to H2(Gal(K/F), K ×) constructed in Section 2 is
one-one onto. An additional argument shows that this function in fact is a group isomorphism.
Section 4 proves under the same hypotheses that H1(Gal(K/F), K ×) = 0, and a corollary
makes this result concrete when the Galois group is cyclic. This result and the corollary are known
as Hilbert’s Theorem 90.
Section 5 is a self-contained digression on the cohomology of groups. If G is a group and ZG is
its integral group ring, a standard resolution of Z by free ZG modules is constructed in the category
of all unital left ZG modules. This has the property that if M is an abelian group on which G acts
by automorphisms, then the groups Hn(G, M) result from applying the functor HomZG( · , M) to
the members of this resolution, dropping the term HomZG(Z, M), and taking the cohomology of
the resulting complex. Section 5 goes on to show that the groups Hn(G, M) arise whenever this
construction is applied to any free resolution of Z, not necessarily the standard one. This section
serves as a prerequisite for Section 6 and as motivational background for Chapter IV.
Section 6 applies the result of Section 5 in the case that G is ﬁnite cyclic, producing a nonstandard
free resolution of Z in this case. From this alternative free resolution, one obtains a rather explicit
formula for H2(G, M) whenever G is ﬁnite cyclic. Application to the case that G is the Galois group
Gal(K/F) for a ﬁnite Galois extension gives the explicit formula B(K/F) ∼= F×NK/F(K ×) for
the relative Brauer group when the Galois group is cyclic.
123

124
III. Brauer Group
1. Deﬁnition and Examples, Relative Brauer Group
The “Brauer group” of a ﬁeld allows one to work with the set of all isomorphism
classes of ﬁnite-dimensional central division algebras over the ﬁeld. The basic
theory in principle reduces the study of all such division algebras to questions in
the cohomology theory of groups. The latter theory was introduced in Chapter VII
of Basic Algebra and will be developed further in the present chapter and the next.
Let F be a ﬁeld. Theorem 2.4 shows that every ﬁnite-dimensional central
simple algebra A over F is of the form A ∼= Mn(D) for some uniquely determined
integer n ≥1 and some ﬁnite-dimensional central division algebra D over F that
is uniquely determined up to F isomorphism. We can introduce an equivalence
relation for ﬁnite-dimensional central division algebras over F that exactly mir-
rors the relation of F isomorphism of the underlying ﬁnite-dimensional central
division algebras. Speciﬁcally if A ∼= Mn(D) and A′ ∼= Mn′(D′) are two such
central simple algebras for the same F such that D ∼= D′, then we say that A
is Brauer equivalent to A′, and we write A ∼A′. It is immediate from the
deﬁnition that “Brauer equivalent” is an equivalence relation. We shall introduce
an abelian-group structure into the set of Brauer equivalence classes, hence into
the set of isomorphism classes of central ﬁnite-dimensional division algebras
over F.
Proposition 10.24 of Basic Algebra gives the deﬁnition of the tensor product
of two F algebras1 over F, and this operation is associative, up to canonical
isomorphism, by Proposition 10.22.
It is also commutative, up to canonical
isomorphism. In fact, if A and B are given algebras over F, then the canonical
vector-space isomorphism ϕ : A ⊗F B →B ⊗F A is given by ϕ(a ⊗b) = b ⊗a.
If a1 ⊗b1 and a2 ⊗b2 are given, then the computation
ϕ(a1 ⊗b1)ϕ(a2 ⊗b2) = (b1 ⊗a1)(b2 ⊗a2) = b1b2 ⊗a1a2
= ϕ(a1a2 ⊗b1b2) = ϕ

(a1 ⊗b1)(a2 ⊗b2)

shows that ϕ respects multiplication. Hence tensor product is commutative for
algebras, up to canonical isomorphism.
Lemma 3.1. If F is a ﬁeld, then
(a) Mn(R) ∼= R ⊗F Mn(F) for any algebra R with identity over F,
(b) Mm(F) ⊗F Mn(F) ∼= M(mn)(F).
PROOF. For (a), the F bilinear map (r, [ai j]) 	→[rai j] of R × Mn(F) into
1All algebras in this chapter are understood to be associative.

1. Definition and Examples, Relative Brauer Group
125
Mn(R) has a unique linear extension ϕ to an F linear map of R ⊗F Mn(F) into
Mn(R). The map ϕ has
ϕ

(r ⊗[ai j])(r′ ⊗[a′
i j])

= ϕ(rr′ ⊗[ai j][a′
i j])
= rr′[ai j][a′
i j]
= r[ai j]r′[a′
i j]
since each ai j is in F
= ϕ(r ⊗F [ai j])ϕ(r′ ⊗[a′
i j]),
and hence ϕ is an F algebra homomorphism. If {rk} is a vector-space basis of R
over F and if {Ei j} is the usual basis of Mn(F), then ϕ(rk ⊗Ei j) = rk Ei j, and it
follows that ϕ carries a vector-space basis onto a vector-space basis. Hence ϕ is
one-one and onto.
For (b), the result of (a) gives Mm(F) ⊗F Mn(F) ∼= Mn(Mm(F)), and the
algebra on the right is isomorphic to the algebra M(mn)(F) of matrices of size mn
by the multiplication-in-blocks isomorphism.
□
Proposition 3.2. For the ﬁeld F, the operation of tensor product on ﬁnite-
dimensional central simple algebras over F descends to an operation on the set
of Brauer equivalence classes of such algebras and makes this set into an abelian
group.
PROOF. The tensor product of two ﬁnite-dimensional algebras over F is again
a ﬁnite-dimensional algebra, and Proposition 2.36 shows that the tensor product
of two central simple algebras is again central simple. Hence tensor product is
well deﬁned as an operation on ﬁnite-dimensional central simple algebras over
F. Let us see that tensor product is a Brauer class property. Thus suppose that
A ∼A′ and B ∼B′, say with A = Mm(D), A′ ∼= Mm′(D), B = Mn(E), and
B′ = Mn′(E). Since the tensor product of some Mr(F) with an algebra over F,
up to isomorphism, does not depend on the order of the two factors and since
tensor product is associative up to isomorphism, Lemma 3.1 gives
A ⊗F B = Mm(D) ⊗F Mn(E) ∼= D ⊗F Mm(F) ⊗F Mn(F) ⊗F E
∼= D ⊗F M(mn)(F) ⊗F E ∼= M(mn)(F) ⊗F D ⊗F E
∼= M(mn)(D ⊗F E).
Similarly A′ ⊗F B′ ∼= M(m′n′)(D ⊗F E). Thus A ⊗F B ∼A′ ⊗F B′.
We have observed that the tensor product operation on algebras over F is
associative and commutative, up to canonical isomorphisms, and hence so is the
product operation on Brauer equivalence classes. The class of the 1-dimensional
algebra F is the identity, and the class of the opposite algebra Ao is an inverse to
the class of A because of the isomorphism A ⊗F Ao ∼= Mn(F) given in Corollary
2.38.
□

126
III. Brauer Group
The abelian group of Brauer equivalence classes of ﬁnite-dimensional central
simple algebras over F is called the Brauer group of F and is denoted by B(F).
We use additive notation for its product operation.
EXAMPLES ALREADY SETTLED IN CHAPTER II.
(1) If F is algebraically closed, then B(F) = 0.
(2) If F = R, then B(F) = Z/2Z by Frobenius’s Theorem (Theorem 2.50).
(3) If F is a ﬁnite ﬁeld, then B(F) = 0 by Wedderburn’s Theorem about ﬁnite
division rings (Theorem 2.48).
The group structure for B(F) given in Proposition 3.2 offers little help by
itself in identifying the ﬁnite-dimensional division algebras over a particular ﬁeld.
Instead, the usual procedure for understanding B(F) is to isolate certain special
subgroups of B(F), known as “relative Brauer groups” and denoted by B(K/F),
K being any ﬁnite extension of F. Under the assumption that K is a ﬁnite Galois
extension of F, Theorem 3.14 below says that B(K/F) is isomorphic to the
cohomology group H 2(G, N), where G is the ﬁnite group G = Gal(K/F) and
N is the (abelian) multiplicative group K × of the ﬁeld K. This cohomology group
is in principle manageable. Corollary 3.9 below says that B(F) is the union over
all ﬁnite Galois extensions K/F of B(K/F), and we therefore obtain a handle
on B(F).
If A is any ﬁnite-dimensional central simple algebra over F and if K/F is any
ﬁeld extension, then Proposition 2.36a shows that A⊗F K is simple as a ring, and
Lemma 2.35b shows that A ⊗F K has center K. Therefore A ⊗F K is a central
simple algebra over K, and its Brauer equivalence class is a member of B(K).
Let us see that this map of algebras A into B(K) depends only on the Brauer
equivalence class of A in B(F). Thus suppose that A = Mm(D) and A′ = Mn(D)
for some ﬁnite-dimensional central division algebra D over F. Lemma 3.1a gives
us isomorphisms of F algebras
A ⊗F K ∼= Mm(D) ⊗F K ∼= (Mm(F) ⊗F D) ⊗F K
∼= Mm(F) ⊗F (D ⊗F K) ∼= Mm(D ⊗F K),
and similarly A′ ⊗F K ∼= Mn(D ⊗F K).
In each case the left member of
the isomorphism is a K algebra, with K contained in the center. Thus we can
view each of our isomorphisms as isomorphisms of central simple K algebras.
Since D ⊗F K is a ﬁnite-dimensional central simple K algebra, we know that
D ⊗F K ∼= Mr(E) for some ﬁnite-dimensional central division algebra E over
K. Application of Lemma 3.1b allows us to continue the displayed isomorphisms
as
A ⊗F K ∼= Mm(D ⊗F K) ∼= Mm(Mr(E)) ∼= M(mr)(E).

1. Definition and Examples, Relative Brauer Group
127
Similarly we have A′ ⊗F K ∼= M(nr)(E). Thus A ⊗F K and A′ ⊗F K yield the
same member of B(K), and ( · )⊗F K induces a well-deﬁned function from B(F)
into B(K).
The function from B(F) into B(K) is a group homomorphism. In fact, if A and
B are ﬁnite-dimensional central simple over F, then we have K isomorphisms
(A ⊗F K) ⊗K (B ⊗F K) ∼= A ⊗F (K ⊗K (B ⊗F K))
∼= A ⊗F (B ⊗F K) ∼= (A ⊗F B) ⊗F K,
and the map is indeed a group homomorphism.
In addition, the resulting homomorphism satisﬁes the expected compatibility
condition with respect to compositions. In more detail, if we have nested ﬁelds
F ⊆K ⊆L, then the L isomorphisms
(A ⊗F K) ⊗K L ∼= A ⊗F (K ⊗K L) ∼= A ⊗F L
show that the composition of tensoring with K over F, followed by tensoring
with L over K, yields the same result as tensoring directly with L over F.
We deﬁne the relative Brauer group B(K/F) to be the kernel of the homo-
morphism of B(F) into B(K). The members of the group B(K/F) are the Brauer
equivalence classes of ﬁnite-dimensional central simple F algebras A such that
A ⊗F K is F isomorphic to Mn(K) for some n. We say that such algebras are
split over K, that K splits such algebras, and that K is a splitting ﬁeld for these
algebras and their Brauer equivalence classes.
Theorem 3.3. Let K/F be a ﬁnite extension of ﬁelds. Then K is a splitting
ﬁeld for a given member X of B(K/F) if and only if there exists an algebra A
over F in the Brauer equivalence class X containing a subﬁeld K ′ isomorphic to
K such that dimF A = (dimF K ′)2.
REMARKS.
(1) The theory of the Brauer group makes repeated use of this result. Corollary
2.47 shows that the subﬁeld K ′ of A is a maximal commutative subalgebra of A
and in particular is a maximal subﬁeld of A.
(2) Observe that the ﬁeld K is given in the theorem, and hence the integer n =
dimF K is known. Then A must have dimension n2. The equality dimF A = n2
determines A up to F isomorphism. In fact, Theorem 2.4 shows that A ∼= Mr(D)
for a central division algebra whose isomorphism class is determined by the class
X. Then n2 = dimF A = r2 dimF D, and r2 = n2/ dimF(D). So A is indeed
determined up to F isomorphism.
(3) In view of the previous remark, any class X in B(K/F) has a distinguished
representative that is unique up to F isomorphism; the distinguished representa-
tives of the members of B(K/F) for ﬁxed K all have the same dimension.

128
III. Brauer Group
PROOF. Suppose that A is a central simple algebra in the Brauer equivalence
class X containingasubﬁeld K ′ isomorphic to K suchthat dimF A = (dimF K ′)2.
We are to prove that K ′ splits A.
Write n for dimF K ′, so that dimF A =
n2.
Regard A as an n-dimensional K ′ vector space with K ′ acting by right
multiplication on A. Deﬁne an F bilinear mapping f : A × K ′ →EndK ′(A) by
f (a, c)(a′) = aa′c; the image f (a, c) is in EndK ′(A) because
f (a, c)(a′c′) = aa′c′c = (aa′c)c′ =

f (a, c)(a′)

c′.
Extend f without changing its name to an F linear mapping f : A ⊗F K ′ →
EndK ′(A) such that f (a ⊗c)(a′) = aa′c. The mapping f is actually K ′ linear
because
f ((a ⊗c)c′)(a′) = f (a ⊗cc′)(a′) = aa′cc′ =

f (a ⊗c)(a′)

c′.
Also, it respects multiplication, since
f (a ⊗c)

f (a′ ⊗c′)(a′′)

= f (a ⊗c)(a′a′′c′) = aa′a′′c′c = aa′a′′cc′
= f (aa′ ⊗cc′)(a′′) = f

(a ⊗c)(a′ ⊗c′)

(a′′).
Thus f is a homomorphism of K ′ algebras. The domain A ⊗F K ′ is central
simple over K ′, as we saw when setting up the homomorphism B(F) →B(K),
and therefore f is one-one. Since A⊗F K ′ and EndK ′(A) both have K ′ dimension
n2, f has to be onto. Thus f exhibits A ⊗F K ′ as isomorphic to a full matrix
ring over K ′, and K ′ splits A.
Conversely suppose that K is a splitting ﬁeld for the members of the class X
in B(F). Let D be a division algebra in the class X. Since B(K/F) is a group
and therefore contains the inverse class Do, we must have Do ⊗F K ∼= Mm(K)
for the integer m such that dimF Do = m2. Let us rewrite this K isomorphism as
Do ⊗F K ∼= EndK(K m). The algebra EndF(K m) is central simple over F, and
up to an isomorphism, it contains the K algebra Do ⊗F K and hence also the F
algebra Do ⊗F F ∼= Do. Let A be the centralizer of Do in EndF(K m). We shall
prove that A has the required properties.
The algebra A contains (center Do) ⊗F K, which is a subﬁeld K ′ isomorphic
to K because Do is central over F, and A is simple by the Double Centralizer
Theorem (Theorem 2.43). The center of A matches the center of the centralizer
of A, which is the center of Do by Theorem 2.43, which in turn is F. Thus A is
central simple over F. Yet another application of Theorem 2.43 gives
(dimF A)(dimF Do) = dimF EndF(K m) = m2(dimF K)2.
(∗)
Since dimF Do = m2, we see that dimF A = (dimF K)2. Thus the subﬁeld K ′
of A isomorphic to K has the required dimension.

1. Definition and Examples, Relative Brauer Group
129
To see that A is in the Brauer equivalence class X, start from the F bilinear
map A × (Do ⊗F F) →EndF(K m) given by (a, d ⊗1) 	→ad, and form its
F linear extension ϕ : A ⊗F (Do ⊗F F) →EndF(K m). The map ϕ respects
multiplication because the members of A commute with the members of Do⊗F F:
ϕ(a ⊗(d ⊗1))

ϕ(a′ ⊗(d′ ⊗1))(v)

= ϕ(a ⊗(d ⊗1))(a′d′v) = ada′d′v
= aa′dd′v = ϕ(aa′ ⊗(dd′ ⊗1))(v).
Since A ⊗F (Do ⊗F F) is simple by Proposition 2.36, ϕ is one-one. A look at
(∗) shows that
dimF(A ⊗F (Do ⊗F F)) = (dimF A)(dimF Do) = dimF EndF(K m)
and allows us to conclude that ϕ is onto. Therefore A ⊗F Do ∼= EndF(K m).
Since EndF(K m) is Brauer equivalent to F, the Brauer equivalence class of A is
the inverse of the class of Do. Hence the class of A equals the class of D, which
is X.
□
Corollary 3.4. If D is a ﬁnite-dimensional central division algebra over the
ﬁeld F, then any maximal subﬁeld K of D splits D.
PROOF. This is the special case of Theorem 3.3 in which A = D. The formula
for the dimensions holds by Corollary 2.47.
□
Corollary 3.5. If F is a ﬁeld, then the Brauer group B(F) is the union of all
relative Brauer groups B(K/F) as K ranges over all ﬁnite extensions of F.
REMARKS. This result is all very tidy but is not very useful, since we have no
indication how to identify B(K/F) for a general ﬁnite extension F. In Corollary
3.9 below, we sharpen this result to make K range only over the ﬁnite Galois
extensions of F, and we shall see in Section 3 that B(K/F) can be realized for
such ﬁelds K in terms of the cohomology of groups.
PROOF.
Any member of B(F) has some central division algebra D as a
representative, and Corollary 3.4 identiﬁes an extension ﬁeld K of F that splits
D, namely any maximal subﬁeld of D.
□
Corollary 3.6. Let D be a ﬁnite-dimensional central division algebra over a
ﬁeld F, and let dimF D = n2. If K is a splitting ﬁeld for D, then dimF K is a
multiple of n.
PROOF.
If K is a splitting ﬁeld for D, then Theorem 3.3 says that there
exists an integer r such that Mr(D) contains a subﬁeld K ′ isomorphic to K with
dimF Mr(D) = (dimF K ′)2. Thus r2n2 = (dimF K)2, and rn = dimF K.
□

130
III. Brauer Group
Theorem 3.7 (Noether–Jacobson Theorem). If D is a noncommutative ﬁnite-
dimensional central division algebra over the ﬁeld F, then there exists a member
of D that is not in F and is separable over F.
REMARKS. Within a ﬁeld extension K/F, we know from Corollary 9.31 of
Basic Algebra that the subset of all elements of K that are separable over F is
a subﬁeld of K containing F. Consequently an equivalent formulation of the
theorem is that D contains a nontrivial separable extension ﬁeld of F.
PROOF (Herstein). Arguing by contradiction, suppose that no element of D
outside F is separable over F. Let the characteristic of F be p, necessarily
nonzero. If a is any element of D not in F, then the assumed nonseparability
implies that the minimal polynomial f (X) of a over F has f ′(X) = 0, according
to Proposition 9.27 of Basic Algebra. Hence f (X) = f1(X p) for some polyno-
mial f1(X) in F[X]. In turn, the minimal polynomial of a p is f1(X), and if a p is
not in F, then f1(X) = f2(X p) for some polynomial f2(X) in F[X]. Since the
degree decreases at each step as we pass from f to f1, from f1 to f2, and so on,
we conclude that a pe is in F for some e. In short, each a in D has the property
that there is some integer e ≥0 depending on a such that a pe is in F.
In view of the assumption that D ̸= F and the argument that we have just
seen, there exists an element a in D outside F such that a p is in F. Deﬁne a
function d : D →D by d(x) = xa −ax. The function d is F linear, and it is
not identically 0 because a is not in the center F of D. If r and l denote right
and left multiplication, we can rewrite d as d(x) = (r(a) −l(a))(x). The linear
maps r(a) and l(a) commute with each other, and thus the Binomial Theorem is
applicable in computing d p(x) as
d p(x) = (r(a) −l(a))p(x) = (r(a)p −l(a)p)(x) = xa p −pax = 0,
the last equality holding becausea p is in F and is therefore central. Since d p is the
zero function and d is not, there exist an integer s with 2 ≤s ≤p and an element
y in D with ds−1y ̸= 0 and ds y = 0. Put x = ds−1y. Since x = d(ds−2y), the
element w = ds−2y has the property that x = wa −aw. The condition dx = 0
says that xa = ax. Put x = au. The elements a and u commute because a and
x commute. If we set c = wu−1, then x = wa −aw = cua −acu, and hence
a = xu−1 = cuau−1−ac. Since a and u commute, we obtain a = ca−ac. Right
multiplying by a−1 gives 1 = c −aca−1 and therefore c = 1 + aca−1. Raising
both sides to the pe′ power gives cpe′
= 1 + acpe′
a−1. The ﬁrst paragraph of the
proof shows that there is some e′ ≥0 for which cpe′
is in F, and for this integer
e′, we obtain the contradictory equation cpe′
= 1 + cpe′
from the commutativity
of a with F. This completes the proof.
□

1. Definition and Examples, Relative Brauer Group
131
Corollary 3.8. If D is a noncommutative ﬁnite-dimensional central division
algebra over the ﬁeld F and if K is a subﬁeld of D that is separable over F, then
there exists a maximal subﬁeld L of D containing K such that L is separable
over F.
PROOF. Because of the ﬁnite dimensionality, we may assume without loss
of generality that K is not properly contained in any larger subﬁeld of D that
is separable over F. Arguing by contradiction, we may assume that K is not a
maximal subﬁeld of D. Let E be the centralizer of K in D. This is a division
algebra over F. It is simple by the Double Centralizer Theorem (Theorem 2.43),
and it contains K because K is commutative. Moreover, we know from Theorem
2.43 that
dimF D = (dimF K)(dimF E)
and that K is the centralizer of E. The latter condition shows that the division
algebra E is central simple over K. Since K is not a maximal subﬁeld of D,
Corollary 2.46 gives dimF D > (dimF K)2. Thus dimF K < dimF E. Since E
is central over K, E is noncommutative.
Application of Theorem 3.7 produces an element x in E outside K that is
separable over K. Let L be the subﬁeld K(x) of E. Since K is a separable
extension of F, the Theorem of the Primitive Element gives an element α of K
such that K = F(α). Then L = F(α, x). The implication (b) implies (c) in
Corollary 9.29 of Basic Algebra shows that if α is separable over F and x is
separable over F(α), then α and x are both separable over F. The elements of L
that are separable over F form a subﬁeld of L, and we have just proved that this
subﬁeld properly contains K. This conclusion contradicts the assumption that K
is a maximal separable extension of F within D, and the proof is complete.
□
Corollary 3.9. If F is a ﬁeld, then the Brauer group B(F) is the union of
all relative Brauer groups B(K/F) as K ranges over all ﬁnite Galois extensions
of F.
REMARKS. This is the result of interest. Each B(K/F) with K as in the
corollary will be seen to be given as an H 2 in the cohomology of groups, and this
group is in principle manageable. Thus we obtain a handle on B(F).
PROOF. If D is a central division algebra over F, then Corollaries 3.4 and 3.8
together show that some ﬁnite separable extension K ′ of F splits D. That is, the
Brauer equivalence class of D lies in B(K ′/F). Let us write K ′ = F(α) by the
TheoremofthePrimitiveElement. If f (X)istheminimalpolynomialofα over F,
then every root of f (X) in an algebraic closure F of F containing K ′ is separable
over F. Let K be the subﬁeld of F generated by all the roots. This is a ﬁnite
normal extension, and Corollary 9.30 of Basic Algebra shows that it is a separable

132
III. Brauer Group
extension. We have seen that the composition of the homomorphisms B(F) →
B(K ′) and B(K ′) →B(K) is B(F) →B(K), and consequently B(K ′/F) ⊆
B(K/F). Therefore the Brauer equivalence class of D lies in B(K/F).
□
2. Factor Sets
Throughout this section let K/F be a ﬁnite Galois extension of ﬁelds.
Our
objective is to construct a function from the relative Brauer group B(K/F) into
the cohomology group H 2(Gal(K/F), K ×). In Section 3 we shall prove that this
function is a group isomorphism.
We take as known the material in Chapter VII of Basic Algebra on cohomology
of groups. For convenient reference we list the relevant formulas for cohomology
in degree 2. If G is a group and N is an abelian group on which G acts by
automorphisms, the group C2(G, N) of 2-cochains is the group of all functions
a : G × G →N, the group Z2(G, N) of 2-cocycles is the set of members f of
C2(G, N) such that
u( f (v, w)) + f (u, vw) = f (uv, w) + f (u, v)
for all u, v, w ∈G,
the group B2(G, N) of 2-coboundaries is the set of members f of C2(G, N) of
the form
f (u, v) = u(α(v)) −α(uv) + α(u)
for some α : G →N,
and the cohomology group H 2(G, N) is the quotient
H 2(G, N) = Z2(G, N)/B2(G, N).
Here it is understood that we are using additive notation for the group operation
in N and that the action of u ∈G on a member n of N is denoted by u(n).
In constructing the function from B(K/F) into H 2(Gal(K/F), K ×), we shall
proceed in somewhat the same fashion as for the identiﬁcation of group extensions
with an H 2 that was carried out in Chapter VII of Basic Algebra. Namely we shall
associate a “factor set” to some choices concerning a given ﬁnite-dimensional
central simple algebra and see that this factor set is a cocyle. Then we shall show
that the factor set for any set of choices for any Brauer-equivalent central simple
algebra differs from this cocyle by a coboundary. The result will be the desired
function from B(K/F) into H 2(Gal(K/F), K ×).
Thus write G for Gal(K/F), ﬁx a Brauer equivalence class X in B(K/F), and
let A be a central simple algebra in the class X meeting the conditions of Theorem
3.3: A contains a subﬁeld K ′ isomorphic to K, and dimF A = (dimF K ′)2. Write
c 	→c′ for the isomorphism K →K ′.

2. Factor Sets
133
Let σ be an element of the Galois group G. Then c 	→c′ and c 	→σ(c)′
are two algebra homomorphisms of the simple algebra K into the central simple
algebra A, and the Skolem–Noether Theorem (Theorem 2.41) says that they are
related by an inner automorphism:
σ(c)′ = xσc′x−1
σ
for some xσ ∈A.
Some choice is involved in selecting xσ, but the element xσ is unique up to a
factor from K ′ on the right. In fact, if xσ and yσ both behave as in the boxed
formula, then y−1
σ xσ commutes with K ′ and hence is in K ′. Thus xσ = yσc′
0 with
c′
0 in K ′.
The nonuniqueness can be expressed also in terms of a factor from K ′ on the
left. In fact, the boxed formula for c = c0 implies that xσ = (xσc′
0x−1
σ )(xσc−1
0 ) =
σ(c0)′yσ.
At any rate, ﬁx a choice of xσ for all σ ∈G, and let us examine the effect of
composition. If σ and τ are in G, then
xστc′x−1
στ = (στ)(c)′ = σ(τ(c))′ = xστ(c)′x−1
σ
= xσ xτc′x−1
τ x−1
σ .
Using the result of the previous paragraph, we see that xστ and xσ xτ are related
by a factor from K ′ on the left. Hence we can write
xσ xτ = a(σ, τ)′xστ
with a(σ, τ) ∈K ×.
If we examine the effect of composing three elements of G, we obtain a
consistency condition that the function a : G × G →K × must satisfy. Namely,
let ρ, σ, and τ be in G, and let us compute xρxσ xτ in two ways, taking advantage
of the associativity in A. With one grouping, we obtain
xρxσ xτ = (xρxσ)xτ = a(ρ, σ)′xρσ xτ = a(ρ, σ)′a(ρσ, τ)′xρστ,
and with the other grouping, we have
xρxσ xτ = xρ(xσ xτ) = xρa(σ, τ)′xστ
= ρ(a(σ, τ))′xρxστ = ρ(a(σ, τ))′a(ρ, στ)′xρστ.
Therefore the function a : G × G →K × satisﬁes
ρ(a(σ, τ))a(ρ, στ) = a(ρ, σ)a(ρσ, τ).
A function a : G × G →K × satisfying the above boxed formula is called a
factor set. From A, an isomorphism K →K ′, and a choice of the elements xσ
for σ ∈G, we have obtained a factor set.

134
III. Brauer Group
Comparing this boxed formula with the formulas in the second paragraph of
this section, we see that a factor set is exactly a member of Z2(Gal(K/F), K ×)
except that the boxed formula uses multiplicative notation for K × and the deﬁ-
nition of 2-cocyle uses additive notation. Thus we have associated a member of
Z2(Gal(K/F), K ×) to the triple consisting of A, an isomorphism K →K ′, and
a choice of the elements xσ for σ ∈G.
With the extension K/F and the class X ∈B(K/F) ﬁxed, let us see the effect
on the factor set of making different choices. The algebra A lies in the Brauer
equivalence class X and has dimF A = (dimF K)2. As we saw in the remarks
with Theorem 3.3, A is determined up to isomorphism by these properties.
Thus let us start from a different system of choices: an algebra B in the
class X, an isomorphism K →K ′′, and elements yσ for σ ∈G such that
σ(c)′′ = yσc′′y−1
σ . Deﬁne the corresponding factor set b : G × G →K × by
yσ yτ = b(σ, τ)′′yστ.
We wish to relate a(σ, τ) and b(σ, τ). We have just seen that A and B are
isomorphic as algebras. Let ϕ : A →B be an isomorphism. Then c 	→c′ 	→
ϕ(c′) and c 	→c′′ are two algebra homomorphisms of K into B, and the Skolem–
Noether Theorem (Theorem 2.41) produces an element t ∈B with
c′′ = tϕ(c′)t−1
for all c ∈K.
Starting from the formula σ(c)′ = xσc′x−1
σ , apply ϕ and conjugate by t to obtain
σ(c)′′ = tϕ(σ(c)′)t−1 =

tϕ(xσ)t−1
c′′
tϕ(xσ)t−1−1.
This equation says that tϕ(xσ)t−1 serves the same purpose as yσ, and therefore
yσ = c′′
σtϕ(xσ)t−1
for some member c′′
σ of K ′′ placed on the left. Substitution into the formula
yσ yτ = b(σ, τ)′′yστ gives
c′′
σtϕ(xσ)t−1c′′
τtϕ(xτ)t−1 = b(σ, τ)′′c′′
στtϕ(xστ)t−1.
If we substitute from the formula c′′ = tϕ(c′)t−1 for all members of K ′′ and then
conjugate by t−1 and apply ϕ−1, we obtain
c′
σ xσc′
τ xτ = b(σ, τ)′c′
στ xστ.
The left side equals
c′
σσ(cτ)′xσ xτ = c′
σσ(cτ)′a(σ, τ)′xστ,

3. Crossed Products
135
and comparison of this expression with the right side gives
b(σ, τ)′c′
στ = c′
σσ(cτ)′a(σ, τ)′.
Passing from K ′ back to K, we conclude that
b(σ, τ)cστ = cσσ(cτ)a(σ, τ).
This formula says that b is the product of a and the trivial factor set c : G ×G →
K × given by
c(σ, τ) = cσσ(cτ)c−1
στ ,
where σ 	→cσ is some function from G to K ×. Again referring to the second
paragraph of this section and remembering that we are using multiplicative no-
tation for K ×, we see that the trivial factor sets are the 2-coboundaries, lying
in B2(Gal(K/F), K ×), in the same way that the general factor sets are the
2-cocycles, lying in Z2(Gal(K/F), K ×). We have thus proved the following
proposition.
Proposition 3.10. Let K be a ﬁnite Galois extension of the ﬁeld F. For
X in B(K/F), let A be an algebra in the Brauer equivalence class X with
dimF A = (dimF K)2, let K →K ′ be an isomorphism of K into A, and let
{xσ | σ ∈Gal(K/F)} ⊆A× be a set of elements such that σ(c)′ = xσc′x−1
σ .
Then the passage from X to the factor set determined by the triple of data
(A, K→K ′, {xσ}) descends to a well-deﬁned function from the abelian group
B(K/F) to the abelian group H 2(Gal(K/F), K ×).
3. Crossed Products
In this section we continue to assume that K/F is a ﬁnite Galois extension of
ﬁelds. We are going to show that the function B(K/F) →H 2(Gal(K/F), K ×)
given in Proposition 3.10 is an isomorphism of groups. The homomorphism
property comes last and is the hard part of the argument.
In the meantime,
we construct the inverse function by associating an algebra to each member of
Z2(Gal(K/F), K ×) and showing in Corollary 3.13 that the resulting function on
Z2(Gal(K/F), K ×) descends to an inverse function from H 2(Gal(K/F), K ×)
into B(K/F). The algebra is called a “crossed product” and is produced in
Proposition 3.12 below. Before either of these steps, we establish one more
property of the system {xσ | σ ∈Gal(K/F)} of the previous section that has not
needed mentioning until now.

136
III. Brauer Group
Thus let a central simple algebra A be given with dimF A = (dimF K)2, along
with an isomorphism K →K ′ denoted by c 	→c′. As in the previous section
we choose xσ ∈A× with
σ(c)′ = xσc′x−1
σ
for all c ∈K.
The corresponding factor set a(σ, τ) has
xσ xτ = a(σ, τ)′xστ.
We regard A as a vector space over K ′ with K ′ acting by multiplication on the
left.
Lemma 3.11. With hypotheses as above, the set {xσ | σ ∈Gal(K/F)} is a
vector-space basis of A over K ′.
PROOF. Let G = Gal(K/F). Since |G| = dimF K = dimF K ′ = dimK ′ A, it
is enough to prove linear independence. Arguing by contradiction, assume that
the set {xσ | σ ∈G} is linearly dependent. Choose a maximal subset J of G
such that {xτ | τ ∈J} is linearly independent. For σ not in J, we then have
xσ = 	
τ∈J
a′
τ xτ
with aτ ∈K.
(∗)
Every c in K satisﬁes
σ(c)′xσ = xσc′ = 	
τ∈J
a′
τ xτc′ = 	
τ∈J
a′
ττ(c)′xτ,
and thus xσ = 	
τ∈J σ(c)′−1a′
ττ(c)′xτ.
Comparing this expansion with (∗)
shows that
σ(c)′−1a′
ττ(c)′ = a′
τ
for τ ∈J.
(∗∗)
Since xσ ̸= 0, some a′
τ in the expansion (∗) is nonzero. For this τ, we can cancel
a′
τ in (∗∗) and obtain σ(c)′ = τ(c)′ for all c ∈K. Then σ = τ, in contradiction
to the fact that σ is not in J.
□
The linear independence in Lemma 3.11 allows us to read off the structure of
A: as a K ′ vector space, the algebra A is given by A = !
σ∈Gal(K/F) K ′xσ, and
the elements xσ have the properties that
xσc′ = σ(c)′xσ for c ∈K
and
xσ xτ = a(σ, τ)′xστ.
Proposition 3.12 is motivated by these formulas, saying that we can reconstruct
A from a given 2-cocycle a(σ, τ) in such a way that these formulas hold.

3. Crossed Products
137
Proposition 3.12. Let K/F be a ﬁnite Galois extension, and let a = a(σ, τ)
be in Z2(Gal(K/F), K ×). Then there exist a central simple algebra A over F
with dimF A = (dimF K)2, an isomorphism K →K ′ of K onto a subﬁeld K ′ of
A, and a subset {xσ ∈A | σ ∈Gal(K/F)} such that
(a) A = !
σ∈Gal(K/F) K ′xσ,
(b) xσc′x−1
σ
= σ(c)′ for all c in K, with c 	→c′ denoting the isomorphism
of K onto K ′,
(c) xσ xτ = a(σ, τ)′xστ.
REMARKS.
We write A = A(K, Gal(K/F), a) and call A the crossed-
product algebra corresponding to the factor set a. The algebra A is completely
determined by the given conditions, up to canonical isomorphism, since (a), (b),
and (c) determine the entire multiplication table of A.
PROOF. Let G = Gal(K/F), form a set {xσ | σ ∈G}, and let A be the K
vector space (free K module) with basis {xσ}. Then A = !
σ∈G K xσ. Deﬁne a
multiplication on K basis vectors in A by
(cxσ)(dxτ) = cσ(d)a(σ, τ)xστ,
(∗)
and extend it to a multiplication on A by additivity.
First we shall check that A is an associative F algebra with a(1, 1)−1x1 as
identity by making use of the cocycle property
ρ(a(σ, τ))a(ρ, στ) = a(ρ, σ)a(ρσ, τ).
(∗∗)
For associativity, (∗) gives
(bxρ)

(cxσ(dxτ)

= (bxρ)(cσ(d)a(σ, τ)xστ)
= bρ(c)(ρσ(d))ρ(a(σ, τ))a(ρ, στ)xρστ
and

(bxρ)(cxσ

(dxτ) = (bρ(c)a(ρ, σ)xρσ)(dxτ)
= bρ(c)a(ρ, σ)ρσ(d))a(ρσ, τ)xρστ,
and the right sides are equal by (∗∗). To see that a(1, 1)−1x1 is a two-sided
identity, take ρ = σ = 1 in (∗∗) to get 1(a(1, τ))a(1, τ) = a(1, 1)a(1, τ). Since
a takes values in K ×, we can cancel and obtain
a(1, τ) = a(1, 1).
(†)
Thus (∗) gives

a(1, 1)−1x1

(dxτ) = a(1, 1)−11(d)a(1, τ)xτ = dxτ.

138
III. Brauer Group
Similarly another specialization of (∗∗) is σ(a(1, 1))a(σ, 1) = a(σ, 1)a(σ, 1),
from which we obtain
σ(a(1, 1)) = a(σ, 1).
(††)
Thus (∗) gives
(cxσ)

a(1, 1)−1x1

= cσ(a(1, 1))−1a(σ, 1)xσ = cxσ,
and a(1, 1)−1x1 is indeed a two-sided identity. We denote it by 1. Scalar multi-
plication by r ∈F is understood to be the additive extension of r(cxσ) = (rc)xσ
for c ∈K, and the identities

r(cxσ)

(dxτ) = rcσ(d)a(σ, τ)xστ,
(cxσ)

r(dxτ)

= cσ(rd)a(σ, τ)xστ = rcσ(d)a(σ, τ)xστ,
r

(cxσ)(dxτ)

= rcσ(d)a(σ, τ)xστ
show that multiplication in A is F linear with respect to scalars, hence show that
A is an algebra over F.
Second we deﬁne K ′ ⊆A and an isomorphism K →K ′. For b ∈K, we let
b′ be the member of A given by b′ = b1 = b(a(1, 1)−1x1), and we let K ′ be the
image of K under b 	→b′. The map b 	→b′ certainly respects addition, and it
respects multiplication because the identity
(b1a(1, 1)−1x1)(b2a(1, 1)−1x1) = b1b2a(1, 1)−1x1
is immediate from (∗). Hence K ′ is a subﬁeld of A.
Third we prove properties (a), (b), and (c). For (a), we use (∗) and (†) to obtain
the identity
b′xσ = (ba(1, 1)−1x1)xσ = ba(1, 1)−1a(1, σ)xσ = bxσ.
(‡)
This identity shows that K ′xσ = K xσ, and (a) follows.
From (‡), we see
also that xσ(bxσ −1) = (1xσ)(bxσ −1) = 1σ(b)a(σ, σ −1)x1 and that (bxσ −1)xσ =
bσ(1)a(σ −1, σ)x1; thus xσ has a right inverse in A and also a left inverse, hence a
two-sided inverse. Consequently the statement of (b) is meaningful; for its proof
we have only to observe that
xσc′x−1
σ
=

xσ(ca(1, 1)−1x1)

x−1
σ
=

σ(c)σ(a(1, 1))−1a(σ, 1)xσ

· x−1
σ
= σ(c)xσ · x−1
σ
= σ(c)′xσ x−1
σ
= σ(c)′,
the last three equalities following from (††), (‡), and the identity xσ x−1
σ
= 1.
For (c), we have
xσ xτ = a(σ, τ)xστ = a(σ, τ)′xστ,

3. Crossed Products
139
the second equality following from (‡).
Fourth we show that A is simple. Let I be a proper two-sided ideal in A, and
let ϕ : A →A/I be the quotient homomorphism. Since 1 is not in I and since
K ′ is a subﬁeld of A, we know that ker(ϕ

K ′) = 0 and that ϕ(K ′) is a subﬁeld of
A/I. The ﬁeld ϕ(K ′) acts on A/I by left multiplication and makes A/I into a
ϕ(K ′) vector space. The members ϕ(xσ) of A/I certainly span A/I over ϕ(K ′)
because of (a), and the claim is that they are linearly independent. If so, then ϕ
is one-one, I equals 0, and A is simple. For the linear independence, we argue
by contradiction in the same way as for Lemma 3.11. Suppose that J ⊆G is a
maximal subset such that {ϕ(xτ) | τ ∈J} is linearly independent over ϕ(K ′).
For σ not in J, we then have
ϕ(xσ) = 	
τ∈J
ϕ(a′
τ)ϕ(xτ)
with aτ ∈K.
(‡‡)
Every c in K satisﬁes
ϕ(σ(c)′)ϕ(xσ) = ϕ(xσ)ϕ(c′) = 	
τ∈J
ϕ(a′
τ)ϕ(xτ)ϕ(c′) = 	
τ∈J
ϕ(a′
τ)ϕ(τ(c)′)ϕ(xτ),
and thus
ϕ(xσ) = 	
τ∈J ϕ(σ(c)′)−1ϕ(a′
τ)ϕ(τ(c)′)ϕ(xτ).
Comparing this expansion with (‡‡) shows that
ϕ(σ(c)′)−1ϕ(a′
τ)ϕ(τ(c)′) = ϕ(a′
τ)
for τ ∈J.
(§)
Since xσ is invertible in A, ϕ(xσ) is invertible in A/I and cannot be 0. Therefore
some ϕ(a′
τ) in the expansion (‡‡) is nonzero. For this τ, we can cancel ϕ(a′
τ) in
(§) and obtain ϕ(σ(c)′) = ϕ(τ(c)′) for all c ∈K. Since ϕ is one-one on K ′, we
conclude that σ = τ, in contradiction to the fact that σ is not in J. Therefore A
is simple.
Fifth we show that A has center F. Thus suppose that 	
σ c′
σ xσ is central.
Commutativity with d′xτ forces the two expressions
 	
σ
c′
σ xσ

d′xτ = 	
σ
c′
σσ(d)′xσ xτ = 	
σ
c′
σσ(d)′a(σ, τ)′xστ
and
d′xτ
 	
σ
c′
σ xσ

= 	
σ
(d′xτ)(c′
σ xσ) = 	
σ
d′τ(cσ)′a(τ, σ)′xτσ
= 	
σ
d′τ(cτ −1στ)′a(τ, τ −1στ)′xστ
to be equal. Hence
dτ(cτ −1στ)a(τ, τ −1στ) = cσσ(d)a(σ, τ)
for all d, σ, τ.
(§§)

140
III. Brauer Group
Putting d = 1 in (§§) shows that τ(cτ −1στ)a(τ, τ −1στ) = cσa(σ, τ). Substitut-
ing from this equation into the left side of (§§) gives
dcσa(σ, τ) = cσσ(d)a(σ, τ)
for all d, σ, τ.
If cσ ̸= 0, we see that σ(d) = d for all d ∈K; thus cσ ̸= 0 only for σ = 1. For
σ = 1 and d = 1, (§§) reduces to
τ(c1)a(τ, 1) = c1a(1, τ).
Taking into account (†) and (††), we obtain
τ(c1a(1, 1)) = c1a(1, 1).
Since τ is arbitrary, this says that c1a(1, 1) is in F. Thus the central element is
c′
1x1 = c1x1 = c1a(1, 1)a(1, 1)−1x1 = (c1a(1, 1))1 and is an F multiple of the
identity.
Since {xσ} by deﬁnition is a basis of A over K, we have dimK A = |G| =
dimF K. Multiplying this equation by dimF K yields dimF A = (dimF K)2.
This completes the proof.
□
Corollary 3.13. If K is a ﬁnite Galois extension of the ﬁeld F, then the map
B(K/F) →H 2(Gal(K/F), K ×) deﬁned via factor sets is one-one onto.
PROOF. Put G = Gal(K/F). If a : G × G →K × is in Z2(G, K ×), then
we can construct an algebra A via Proposition 3.12, and the claim is that the
map a 	→A descends to H 2(G, K ×) and is a two-sided inverse to the map from
B(K/F) into H 2(G, K ×) given in Proposition 3.10.
First we show that a 	→A descends to H 2(G, K ×). Thus suppose that b is a
second cocycle and is of the form b(σ, τ) = a(σ, τ)cσσ(cτ)c−1
στ , i.e., represents
the same member of H 2(G, K ×). Let B be the algebra constructed from b by
Proposition 3.12, say with K mapping to K ′′ ⊆B via c 	→c′′ and with
(a′) B = !
σ∈G K ′′yσ for a subset {yσ} of B,
(b′) yσc′′y−1
σ
= σ(c)′′,
(c′) yσ yτ = b(σ, τ)′′yστ.
Deﬁne ϕ : A →B to be the additive extension of the function with ϕ(c′xσ) =
c′′c′′
σ
−1yσ.
To check that ϕ is an algebra homomorphism, we start from the
formula (c′xσ)(d′xτ) = c′σ(d)′a(σ, τ)′xστ and apply ϕ to obtain
ϕ

(c′xσ)(d′xτ)

= c′′σ(d)′′a(σ, τ)′′c′′
στ
−1yστ.

3. Crossed Products
141
Meanwhile,
ϕ(c′xσ)ϕ(d′xτ) = (c′′c′′
σ
−1yσ)(d′′c′′
τ
−1yτ)
= c′′c′′
σ
−1σ(d)′′σ(cτ)′′−1b(σ, τ)′′yστ
= c′′c′′
σ
−1σ(d)′′σ(cτ)′′−1a(σ, τ)′′c′′
σσ(cτ)′′c′′
στ
−1yστ.
Hence ϕ

(c′xσ)(d′xτ)

= ϕ(c′xσ)ϕ(d′xτ), and ϕ is an algebra homomorphism.
Since ϕ carries K basis to K basis, ϕ is an algebra isomorphism.
Thus the map a 	→A descends to a map from H 2(G, K ×) into B(K/F).
Starting from a cocycle a in Z2(G, K ×), we can construct A and elements xσ by
Proposition 3.12, we can apply Propositions 3.12b and 3.10 to the xσ’s to obtain
another cocycle ¯a in Z2(G, K ×), and we can use Proposition 3.12c to see that
¯a = a. In the reverse direction if we start from an algebra A, make a set of
choices, and form a factor set a by means of Proposition 3.10, then Proposition
3.12 constructs an algebra A that has to be isomorphic to A because conditions
(a) through (c) in Proposition 3.12 determine the same multiplication table for an
algebra as was used in constructing the cocycle a.
□
Theorem 3.14. If K is a ﬁnite Galois extension of the ﬁeld F, then the map
B(K/F) →H 2(Gal(K/F), K ×) deﬁned via factor sets is a group isomorphism.
REMARKS. Put G = Gal(K/F). In view of Corollary 3.13, is enough to
prove that the mapping Z2(G, K ×) →B(K/F) of Proposition 3.12 is a group
homomorphism. Thus let A, B, and C be the crossed-product algebras A =
A(K, G, a), B = A(K, G, b), and C = A(K, G, ab). We are to prove that
A ⊗F B is Brauer equivalent to C. Each of A, B, and C has F dimension
(dimF K)2, and hence A ⊗F B will not be isomorphic to C. Consequently we
need to prove Brauer equivalence of two speciﬁc nonisomorphic algebras. This
is the circumstance that makes the proof complicated.
PROOF (Chase). Let G, a, b, A, B, and C be as in the remarks. We can regard
A and B as vector spaces over K with K acting on the left in each case. We deﬁne
an F vector space M to be the quotient of A ⊗F B by the F vector subspace I
generated by all vectors ca ⊗b −a ⊗cb with a ∈A, b ∈B, and c ∈K. We
write M = A ⊗K B for this quotient, even though more standard notation for it
might be Ao ⊗K B with Ao as a right K module and B as a left K module.
The subspace I is carried to itself by right multiplication by any member of
the algebra A ⊗F B and hence is a right ideal. The quotient M is therefore a
unital right A ⊗F B module with (a ⊗K b)(a′ ⊗F b′) = aa′ ⊗K bb′ for a ⊗K b
in M and a′ ⊗F b′ in A ⊗F B.
We shall make the unital right A ⊗F B module M into a unital (C, A ⊗F B)
bimodule by introducing an action byC on the left. For this purpose let {uσ}, {vσ},

142
III. Brauer Group
and {wσ} be the distinguished K bases of the algebras A, B, and C indexed by G
and used to form A, B, and C from the 2-cocycles a, b, and ab. Given an element
xwσ in C with x ∈K, deﬁne xwσ on A ⊗F B to be (left by xuσ) ⊗(left by vσ).
Let us see that this operation carries the generators of I into I. We have
(xwσ)(ca ⊗F b)−(xwσ)(a ⊗F cb) = xuσca ⊗F vσb −xuσa ⊗F vσcb
= xσ(c)uσa ⊗F vσb−xuσa ⊗F σ(c)vσb
= σ(c)(xuσa) ⊗F (vσb)
−(xuσa) ⊗F σ(c)(vσb),
and the right side is indeed in I. Thus we obtain an operation of xwσ on the left
for A ⊗K B such that
(xwσ)(a ⊗K b) = xuσa ⊗K vσb
for x ∈K, σ ∈G, a ∈A, b ∈B.
(∗)
We extend this deﬁnition by additivity in such a way that all of C operates on the
left for A ⊗K B.
The claim is that the additive extension (∗) to C makes M = A ⊗K B into a
unital left C module. What needs proof is that 1 acts as 1 and that

(xwσ)(ywτ)

(a ⊗K b) = (xwσ)

(ywτ)(a ⊗K b)

.
(∗∗)
The element 1 in C is a(1, 1)−1b(1, 1)−1w1, and we have

a(1, 1)−1b(1, 1)−1w1

(a ⊗K b) = a(1, 1)−1b(1, 1)−1u1a ⊗K v1b
= a(1, 1)−1u1a ⊗K b(1, 1)−1v1b = a ⊗K b.
Thus 1 acts as 1. For (∗∗), the left side is
(xσ(y)a(σ, τ)b(σ, τ)wστ)(a ⊗K b) = xσ(y)a(σ, τ)b(σ, τ)uστa ⊗K vστb,
while the right side is
(xwσ)(yuτa ⊗K vτb) = xuσ yuτa ⊗K vσvτb = xσ(y)uσuτa ⊗K vσvτb
= xσ(y)a(σ, τ)uστa ⊗K b(σ, τ)vστb.
These are equal, since b(σ, τ) is in K and therefore moves across the tensor-
product sign.
Thus M is a unital left C module. The left action by C certainly commutes
with the right action by A ⊗F B, and M is consequently a unital (C, A ⊗F B)
bimodule. Each member of A ⊗F B therefore yields by its right action a member
of the ring EndC(M), and we obtain a ring homomorphism of (A ⊗F B)o into
EndC(M). Since A ⊗F B is a simple ring, this homomorphism is one-one. If we

3. Crossed Products
143
can prove that this homomorphism is onto, then we will have a ring isomorphism
(A ⊗F B)o ∼= EndC(M), and the rest will be easy.
To see that the homomorphism is onto, we shall calculate dimensions. Let
n = dimF K. Then each of A, B, and C has F dimension n2, and we have
dimF M = (dimF A)(dimF B)/(dimF K) = n2n2/n = n3 = (dimF C)n.
Since the algebra C is simple, every unital left C module is semisimple and is in
fact isomorphic to a multiple of a simple left C module V . The above dimensional
equality says that if r is the integer such that C is isomorphic to rV as a left C
module, then M is isomorphic to nrV .
Let Do be the division algebra EndC(V ). As in the proof of Wedderburn’s
Theorem (Theorem 2.2), we know for each integer m that
EndC(mV ) ∼= Mm(EndC(V )) ∼= Mm(Do).
(†)
Taking m = r in (†) gives Co ∼= EndC(rV ) ∼= Mr(Do). Hence
C ∼= Mr(D),
(††)
and dimF C = r2 dimF D.
Since dimF C = (dimF K)2 = n2, we obtain
dimF D = n2/r2. Taking m = nr in (†) gives
EndC(M) ∼= EndC(nrV ) ∼= Mnr(Do),
(‡)
and we therefore obtain
dimF EndC(M) = n2r2 dimF D = (n2r2)(n2/r2) = n4.
Since dimF(A ⊗F B) = n4, we obtain dimF(A ⊗F B)o = dimF EndC(M), and
we conclude that the algebra homomorphism (A ⊗F B)o →EndC(M) is onto.
Thus it is an isomorphism, and A ⊗F B ∼= (EndC(M))o.
Combining this isomorphism with (‡) shows that A⊗F B ∼= Mnr(D). In view
of (††), A ⊗F B is therefore Brauer equivalent to C.
□
Corollary 3.15. If D is a ﬁnite-dimensional central division algebra of dimen-
sion m2 over a ﬁeld F, then the m-fold tensor product of D with itself over F is
a full matrix algebra over F.
PROOF. Corollary 3.9 produces a ﬁnite Galois extension K of F such that
K splits D. Write G for Gal(K/F). In view of Theorems 3.3 and 2.4, there
exists an integer l such that A = Ml(D) contains a subﬁeld K ′ isomorphic to K
with dimF A = (dimF K ′)2. Changing notation, we may redeﬁne K = K ′. Let

144
III. Brauer Group
n = dimF K. Then n2 = dimF A = l2 dimF D = (lm)2, and n = lm. Following
the construction of factor sets in Section 2 and using Lemma 3.11, we form a
vector-space basis {xσ | σ ∈G} of A over K and a factor set {a(σ, τ)} such that
xσ xτ = a(σ, τ)xστ and σ(c) = xσcx−1
σ
for all c in K.
Example 1 of semisimple rings in Section II.2 shows that the left A module A
is the direct sum of l isomorphic simple left A modules. Let V be one of these.
Restricting the module structure of V from A to K makes V into a unital left K
module, hence into a vector space over K. Then we have
n2 = dimF A = l dimF V = l(dimK V )(dimF K) = ln dimK V,
and dimK V = m. Let v1, . . . , vm be a K basis of V . For each x ∈A, deﬁne a
matrix C(x) in Mm(K) by
xvj =
m	
i=1
C(x)i jvi.
For σ and τ in G, we compute xσ xτvi in two ways as
xσ xτvj = a(σ, τ)xστvj = a(σ, τ)
m	
i=1
C(xστ)i jvi
(∗)
and as
xσ xτvj = xσ
m	
k=1
C(xτ)kjvk =
m	
k=1
σ(C(xτ)kj)xσvk =
m	
i,k=1
σ(C(xτ)kj)C(xσ)ikvi.
If we write σ(C(xτ)) for the result of applying σ to each entry of C(xτ), then we
obtain
xσ xτvj =
m	
i=1
(C(xσ)σ(C(xτ))i jvi.
(∗∗)
Comparing (∗) and (∗∗) leads to the matrix equation in Mm(K) given by
a(σ, τ)C(xστ) = C(xσ)σ(C(xτ)).
Putting cσ = det C(xσ) and taking the determinant of both sides yields
a(σ, τ)mcστ = cσσ(cτ).
This equation shows that a(σ, τ)m is a trivial factor set. Applying Theorem 3.14,
we see that the mth power of the Brauer equivalence class of A is trivial. Since A
is Brauer equivalent to D, the corollary follows.
□

4. Hilbert's Theorem 90
145
Corollary 3.16. If F is any ﬁeld, then every element of B(F) has ﬁnite order.
PROOF. If A is any central simple algebra over F, then Theorem 2.4 shows
that A ∼= Ml(D) for some integer l ≥1 and some central division algebra D over
F. Corollary 3.15 shows that the Brauer equivalence class of D has ﬁnite order
in B(F). Since A is Brauer equivalent to D, the same thing is true for A.
□
4. Hilbert’s Theorem 90
Let K/F be a ﬁnite Galois extension of ﬁelds. Our interest in this section will be
in the cohomology groups Hq(Gal(K/F), K ×) with q possibly different from 2.
For q = 0, H 0(G, N) is always the subgroup of elements of N ﬁxed by every
element of G. In the case of a Galois extension, the members of K × ﬁxed by the
Galois group are the nonzero elements of the base ﬁeld F. Thus we have
H 0(Gal(K/F), K ×) ∼= F×.
In addition, Theorem 3.14 has established an isomorphism
H 2(Gal(K/F), K ×) ∼= B(K/F),
and thus we have already obtained some understanding of this group for q = 2.
We shall examine H 1 in a moment, but ﬁrst we take note of another fact about
H 2. Problem 16b at the end of Chapter VII of Basic Algebra shows that if G
is a ﬁnite group and N is an abelian group on which G acts by automorphisms,
then every element of Hq(G, N) for q > 0 has order dividing |G|. In particular,
every element of H 2(Gal(K/F), K ×) has order dividing dimF K whenever K is
a ﬁnite Galois extension of F. Applying Theorem 3.14, we see that every member
of B(K/F) has order dividing dimF K. In view of Corollary 3.9, this argument
gives a new and shorter proof of the result of Corollary 3.16 that every member
of B(F) has ﬁnite order. The estimate of the order via Corollary 3.15, however,
is sharper than the estimate obtained via the shorter proof, and this distinction
makes all the difference in Problem 12 at the end of the chapter.
The result concerning H 1 and its important special case given as Corollary
3.18 below are known as Hilbert’s Theorem 90.
Theorem 3.17.
If K/F is any ﬁnite Galois extension of ﬁelds, then
H 1(Gal(K/F), K ×) = 0.
PROOF. Let G = Gal(K/F), put n = dimF K, and enumerate G as σ1, . . . , σn.
By the Theorem of the Primitive Element, we can write K = F(α) for some α in
K, andthen{1, α, α2, . . . , αn−1}isabasisof K over F. Formthen-by-n matrix M

146
III. Brauer Group
with entries in K whose (i, j)th entry is σj(αi−1). This is a Vandermonde matrix,
and Corollary 5.3 of Basic Algebra gives its determinant as 
j>i [σj(α)−σi(α)].
This determinant cannot be 0, since σj(α) = σi(α) implies σj(αk) = σj(α)k =
σi(α)k = σi(αk) for all k and then σj(x) = σi(x) for all x. Hence the matrix M
is nonsingular.
Let f be a nonzero element in Z1(G, K ×). Such a function f : G →K is
nowhere vanishing and has f (στ) = f (σ)σ( f (τ)) for all σ and τ in G. Since
the matrix M is nonsingular, the nontrivial linear combination 	
σ∈G f (σ)σ
cannot be 0 on all members of the basis {1, α, α2, . . . , αn−1}. Choose k with
	
σ∈G f (σ)σ(αk) = y ̸= 0. Applying τ ∈G to this equation, we obtain
τ(y) = 	
σ∈G
τ( f (σ))τσ(αk) = 	
σ∈G
f (τσ) f (τ)−1τσ(αk)
= f (τ −1) 	
σ∈G
f (σ)σ(αk) = f (τ)−1y.
The equation f (τ)−1 = τ(y)y−1 shows that f −1 is a coboundary, hence that f
is a coboundary.
□
Corollary 3.18. If K/F is a ﬁnite Galois extension with cyclic Galois group
and if σ is a generator of the Galois group, then every member x of K with
NK/F(x) = 1 is of the form x = σ(y)y−1 for some y ∈K ×.
REMARKS. The instance of this corollary in which K is a quadratic number
ﬁeld and F is the ﬁeld Q appears as Problem 27 at the end of Chapter I. In
subsequent problems at the end of that chapter, Problem 27 plays a crucial role
in showing that various possible deﬁnitions of genera are equivalent.
PROOF.
Let G = {1, σ, σ 2, . . . , σ n−1} be the Galois group, and deﬁne a
function F : Z →K × by F(0) = 1 and
F(k) = xσ(x)σ 2(x) · · · σ k−1(x)
for k ≥1.
Then we have
F(k + l) = xσ(x)σ 2(x) · · · σ k+l−1(x)
=

xσ(x)σ 2(x) · · · σ k−1(x)

σ k
xσ(x)σ 2(x) · · · σ l−1(x)

= F(k)σ k(F(l)),
(∗)
The condition that NK/F(x) = 1 is exactly the condition that F(n) = 1. Then
F(k + n) = F(k)σ n(F(1)) = F(k) for all k, and it is meaningful to deﬁne
a 1-cochain f : G →K × in C1(G, K ×) by f (σ k) = F(k). Condition (∗)
impliesthat f (σ kσ l) = f (σ k)σ k( f (σ l)), andhence f isacocyclein Z1(G, K ×).
Theorem 3.17 shows that f is a coboundary in B1(G, K ×), necessarily satisfying
f (τ) = τ(y)y−1 for some y ∈K × and all τ ∈G. Taking τ = σ, we obtain
x = f (σ) = σ(y)y−1, as required.
□

5. Digression on Cohomology of Groups
147
Our ﬁnal result concerning Hq(Gal(K/F), K ×) for this chapter gives further
information about the special case in which Gal(K/F) is cyclic, but now for gen-
eral q. In combination with the study of crossed-product algebras, the case q = 2
of this result provides a way of constructing new examples of noncommutative
division algebras. A key step in the proof makes use of a fundamental general
property concerning cohomology of groups, and we therefore digress in Section 5
to establish this property.
5. Digression on Cohomology of Groups
This section develops general material about cohomology of groups. Although
the earlier sections of this chapter are helpful for motivation, the results that we
discuss in this section do not rely on any previous material in this volume. It
will be assumed that the reader is familiar with the deﬁnitions of complexes and
exact sequences in Chapter X of Basic Algebra, as well as with the application
of tensor-product functors and Hom functors to exact sequences and complexes.
The material in Chapter VII of Basic Algebra on cohomology of groups will be
helpful as background, but it is unnecessary from a logical point of view. If R is
a ring with identity, we denote by CR the category of all unital left R modules.
Let G be a group, not necessarily ﬁnite. We shall work with the integral group
ring ZG of G. It has the universal mapping property that whenever G acts by
automorphisms on an abelian group M, then the action by G on M extends to
ZG in a unique way that makes M into a unital left ZG module.
Here is a brief overview of what is to happen in this section: If G acts on
the abelian group M by automorphisms, then the abelian group Cn(G, M) of
n-cochains is the set of functions into M from the n-fold product of G with itself,
the operation being given by addition of the values of the functions. To deﬁne the
cohomology group H n(G, M), one introduces suitable homomorphisms known
as “coboundary maps” δn : Cn(G, M) →Cn+1(G, M) and shows that the
sequence
0 −−→C0(G, M)
δ0
−−→· · ·
δn−1
−−→Cn(G, M)
δn
−−→Cn+1(G, M) −−→· · ·
of abelian groups and homomorphisms is a complex in the category CZ. Then
it is meaningful to deﬁne H n(G, M) = (ker δn)/(image δn−1) for n ≥0 if we
adopt the convention that image δ−1 = 0. The ﬁrst thing that we shall do in this
section is to exhibit a certain exact sequence in the category CZG such that the
above complex is obtained from it by application of the functor HomZG( · , M)
and the dropping of one term of the form HomZG(Z, M). Except for a single
term Z, the members of this exact sequence will all be free ZG modules, and the

148
III. Brauer Group
exact sequence will be called the “standard resolution of Z in the category CZG.”
The exactness is proved in Theorem 3.20, and the application of HomZG( · , M)
to it appears after the proof of the theorem.
The next thing that we shall do is show that if the standard resolution of Z is
changed to any exact sequence in CZG in such a way that the free ZG modules
are replaced by other free ZG modules and the module Z is left unchanged,
then application of HomZG( · , M) to the new exact sequence leads to canonically
isomorphic cohomology groups. This result appears below as Theorem 3.31.
In brief, the cohomology groups H n(G, M) can be computed starting from any
“free resolution of Z” in the category CZG in place of the standard resolution.
We begin by constructing the “standard resolution of Z.” For n ≥0, let Fn
be the free abelian group with Z basis the set of all (n+1)-tuples (g0, . . . , gn)
with all gj ∈G. The group G acts on Fn by automorphisms, the action on the
members of the Z basis being
g(g0, . . . , gn) = (gg0, . . . , ggn).
The universal mapping property of ZG then allows us to regard each Fn as a
unital left ZG module.
Lemma 3.19. For n ≥0, the left ZG module Fn is a free ZG module with
ZG basis consisting of all (n+1)-tuples (1, g1, . . . , gn), i.e., all Z basis elements
with g0 = 1.
PROOF. The formula g0(1, g−1
0 g1, . . . , g−1
0 gn) = (g0, g1, . . . , gn) shows that
all members of the Z basis deﬁning Fn are ZG images of the asserted ZG basis;
hence the asserted ZG basis is a spanning set of Fn relative to ZG. Suppose
that there are ﬁnitely many distinct members hj of G and ﬁnitely many distinct
(n+1)-tuples (1, gi,1, . . . , gi,n), and members 	
j ni jhj of ZG such that
	
i
 	
j
ni jhj

(1, gi,1, . . . , gi,n) = 0.
Then
	
i, j
ni j(hj, hjgi,1, . . . , hjgi,n) = 0.
Since the hj’s are distinct as j varies and the n-tuples (gi,1, . . . , gi,n) are distinct
as i varies, the (n+1)-tuples (hj, hjgi,1, . . . , hjgi,n) are distinct as the pair (i, j)
varies. Thus the Z independence implies that ni j = 0 for all i and j. This proves
the lemma.
□

5. Digression on Cohomology of Groups
149
For n ≥1, we deﬁne ∂n−1 : Fn →Fn−1 as a function from the Z basis into
Fn−1 by
∂n−1(g0, . . . , gn) =
n

i=0
(−1)i(g0, . . . , gi, . . . , gn),
where the symbol  indicates an expression to be omitted. We extend ∂n−1 to all
of Fn by the universal mapping property of free abelian groups. For g in G and for
any Z generator x of Fn, it is evident that ∂n−1(gx) = g(∂n−1(x)). Since ∂n−1 is
a homomorphism of abelian groups, the formula ∂n−1(gx) = g(∂n−1(x)) extends
to all x’s in Fn. Since G and Z generate ZG, we obtain ∂n−1(rx) = r(∂n−1(x))
for all r ∈ZG and all x ∈Fn. In other words, each ∂n−1 is a ZG homomorphism.
WeshallmakeuseofoneadditionalZG homomorphism. AccordingtoLemma
3.19, the ZG module F0 is free on the ZG basis {(1)}. Let us think of the group G
as acting trivially by automorphisms on the abelian group Z. Under this action,
Z becomes a ZG module. Deﬁne ε : F0 →Z to be the ZG homomorphism with
ε((1)) = 1. Then ε((g0)) = g0(ε((1)) = g0 · 1 = 1 for all g0 ∈G. The ZG
homomorphism ε is called the augmentation map.
Theorem 3.20. If G is any group, then the sequence
· · ·
∂n+1
−−→Fn+1
∂n
−−→Fn
∂n−1
−−→· · ·
∂0
−−→F0
ε
−−→Z −−→0
of left unital ZG modules and ZG homomorphisms is exact.
REMARKS. The displayed sequence is called the standard resolution of Z in
the category CZG. The proof will be preceded by two lemmas.
Lemma 3.21. The sequence
· · ·
∂n+1
−−→Fn+1
∂n
−−→Fn
∂n−1
−−→· · ·
∂0
−−→F0
ε
−−→Z −−→0
in CZG is a complex, i.e., ∂n−1∂n = 0 for n ≥1 and also ε∂0 = 0.
PROOF. With the understanding that the symbol  indicates an expression to
be omitted, we have

150
III. Brauer Group
∂n−1∂n(g0, . . . , gn) =
n	
i=0
(−1)i∂n−1(g0, . . . , gi, . . . , gn)
=
n	
i=0
(−1)i
i−1
	
j=0
(−1) j(g0, . . . , gj, . . . , gi, . . . , gn)
+
n	
i=0
(−1)i
n	
j=i+1
(−1) j+1(g0, . . . , gi, . . . , gj, . . . , gn)
=
n	
i=0
i−1
	
j=0
(−1)i+ j(g0, . . . , gj, . . . , gi, . . . , gn)
−
n	
i=0
n	
j=i+1
(−1)i+ j(g0, . . . , gi, . . . , gj, . . . , gn).
If we interchange the order of summation in the second double sum on the right,
we see that the result equals the ﬁrst double sum on the right. Thus the difference
is 0.
This handles all the consecutive compositions except for ε∂0. For this we have
ε∂0(g0, g1) = ε(g1) −ε(g0) = 1 −1 = 0.
□
Lemma 3.22. Fix s in G. For n ≥0, deﬁne a homomorphism hn : Fn →Fn+1
of abelian groups to be the additive extension of the function with
hn(g0, . . . , gn) = (s, g0, . . . , gn),
and deﬁne h−1 : Z →F0 by h−1(k) = k(s). Then ∂nhn + hn−1∂n−1 = 1 for
n ≥1, and also ∂0h0 + h−1ε = 1.
PROOF. On the Z basis of (n+1)-tuples in Fn, we have
∂nhn(g0, . . . , gn) = ∂n(s, g0, . . . , gn)
= (g0, . . . , gn) +
n	
i=0
(−1)i+1(s, g0, . . . , gi, . . . , gn)
and also
hn−1∂n−1(g0, . . . , gn) =
n	
i=0
(−1)i(s, g0, . . . , gi, . . . , gn).
The sum of these is (g0, . . . , gn), as required. Also,
∂0h0(g0) = ∂0(s, g0) = (g0) −(s)
and
h−1ε(g0) = h−11 = (s).
Thus ∂0h0(g0) + h−1ε(g0) = (g0), and ∂0h0 + h−1ε = 1.
□

5. Digression on Cohomology of Groups
151
PROOF OF THEOREM 3.20.
Lemma 3.21 gives image ∂n ⊆ker ∂n−1 and
image ∂0 ⊆ker ε. For the reverse of the ﬁrst inclusion, let x ∈Fn be given
with ∂n−1x = 0 and n ≥1. Then Lemma 3.22 gives x = ∂nhnx + hn−1∂n−1x.
The second term on the right side is 0, and therefore x = ∂n(hnx) is in image ∂n.
For the reverse of the inclusion image ∂0 ⊆ker ε, let x ∈F0 be given with
εx = 0. Then Lemma 3.22 gives x = ∂0h0x + h−1εx. The second term on the
right side is 0, and therefore x = ∂0(h0x) is in image ∂0.
□
WiththestandardresolutionofZinCZG nowknowntobeexact, weexaminethe
effect of applying the functor HomZG( · , M) to it. This functor is contravariant
and carries CZG to the category CZ of all abelian groups. On a unital left ZG
module F, this functor yields the abelian group HomZG(F, M). On a Z module
homomorphism ϕ : F →F′, it yields the homomorphism
Hom(ϕ, 1) : HomZG(F′, M) →HomZG(F, M)
of abelian groups given by Hom(ϕ, 1)(ψ) = ψ ◦ϕ for ψ ∈HomZG(F′, M).
We know from Chapter X of Basic Algebra that this functor carries complexes to
complexes but does not necessarily preserve exactness.
Before applying HomZG( · , M) to the standard resolution of Z, it is customary
to drop the term Z and the augmentation map, obtaining a modiﬁed sequence
· · ·
∂n+1
−−→Fn+1
∂n
−−→Fn
∂n−1
−−→· · ·
∂0
−−→F0 −→0
that is still a complex in CZG. Let us deﬁne dn = Hom(∂n, 1). Then the result of
applying HomZG( · , M) to the modiﬁed complex is the complex
0 −→HomZG(F0, M)
d0
−−→· · · HomZG(Fn, M)
dn
−−→HomZG(Fn+1, M)
dn+1
−−→
in CZ. To each ϕ in HomZG(Fn, M), we associate f = (ϕ) in Cn(G, M) by
the deﬁnition
f (g1, . . . , gn) = ϕ(1, g1, g1g2, . . . , g1 · · · gn).
Any member ϕ of HomZG(Fn, M) is determined by its values on (n+1)-tuples
(1, g1, . . . , gn), since we can factor out the ﬁrst entry of the argument of ϕ and
commute it past ϕ, and it follows that the system of group homomorphisms
n : HomZG(Fn, M) →Cn(G, M)
is a system of isomorphisms of abelian groups. Let

152
III. Brauer Group
δn : Cn(G, M) →Cn+1(G, M)
be the map corresponding to dn : HomG(Fn, M) →HomG(Fn+1, M) under
this system of isomorphisms, namely δn = n+1 ◦dn ◦−1
n . We can calculate
δn explicitly as follows: If f = n(ϕ), then δn f = (n+1dn−1
n )(n)(ϕ) =
n+1dnϕ, and therefore
(δn f )(g1, . . . , gn+1) = (dnϕ)(1, g1, g1g2, . . . , g1 · · · gn+1)
= ϕ(∂n(1, g1, g1g2, . . . , g1 · · · gn+1))
= ϕ(g1, g1g2, . . . , g1 · · · gn+1)
+
n	
i=1
(−1)iϕ(1, g1, . . . , 
g1 · · · gi, . . . , g1 · · · gn+1)
+ (−1)n+1ϕ(1, g1, . . . , g1 · · · gn)
= g1( f (g2, g3, . . . , gn+1))
+
n	
i=1
(−1)i f (g1, . . . , gi, . . . , gn+1)
+ (−1)n+1 f (g1, . . . , gn).
Comparing this formula with the original formula deﬁning δn in Chapter VII of
Basic Algebra, we get a match. That is, we have obtained the complex in CZ
deﬁning the usual groups H n(G, M) by applying HomZG( · , M) to the standard
resolution of Z in CZG and implementing the system of isomorphisms n. In
particular, we obtain a more conceptual proof than in Basic Algebra of the fact
that the sequence
0 −−→C0(G, M)
δ0
−−→· · ·
δn−1
−−→Cn(G, M)
δn
−−→Cn+1(G, M) −−→· · ·
is a complex and that cohomology groups are therefore well deﬁned.
This completes the discussion of the ﬁrst main point of the section as outlined
in the overview at the beginning. Next, any exact sequence
· · ·
∂′
n+1
−−→F′
n+1
∂′
n
−−→F′
n
∂′
n−1
−−→· · ·
∂′
0
−−→F′
0
ε′
−−→Z −−→0
in the category CZG in which all ZG modules F′
n for n ≥0 are free ZG modules
is called a free resolution of Z in the category CZG. The second main point
of the section is that if we apply the functor HomZG( · , M) to this sequence
with Z dropped, then the consecutive quotients of kernels modulo images are
canonically isomorphic to the cohomology groups H n(G, M) obtained above.
Thus H n(G, M) can be computed from any free resolution of Z, and we are

5. Digression on Cohomology of Groups
153
not obliged to use the standard free resolution. This result is stated precisely as
Theorem 3.3l below.
By way of preparation, let us establish a slightly more general setting and work
with it for a moment. Let CR be the category of all unital left R modules, where R
is any ring with identity. According to circumstances, a complex X in CR might
be written with decreasing indices as
X :
· · ·
∂n+1
−−→Xn+1
∂n
−−→Xn
∂n−1
−−→Xn−1
∂n−2
−−→· · ·
or with increasing indices as
X :
· · ·
dn−2
−−→Xn−1
dn−1
−−→Xn
dn
−−→Xn+1
dn+1
−−→· · · .
Mathematically these complexes amount to the same thing: if we rename each
Xk in the second complex as X−k and rename each dk as ∂−k−1, then we obtain
the ﬁrst complex. However, it is convenient to allow both systems of indexing
because of applications.
Fortheﬁrstcomplex, whichhasdecreasingindices, wedeﬁnethenth homology
of X, written Hn(X), by
Hn(X) = (ker ∂n−1)/(image ∂n).
For the second complex, which has increasing indices, we deﬁne the nth coho-
mology of X, written H n(X), by
H n(X) = (ker dn)/(image dn−1).
In both cases the integer n is called the degree. In either case the homology
or cohomology is again a module in CR. The condition that X be a complex is
equivalent to the condition that the image of each incoming map be contained in
the kernel of the corresponding outgoing map, and this is precisely the condition
that the homology or cohomology be meaningful.
Exactness at a particular
module in one of the complexes is the statement that the image of the incoming
map equals the kernel of the outgoing map. Thus the homology or cohomology
of X measures the extent to which the complex X fails to be exact.
Because the nature of the indexing of a complex is not mathematically sig-
niﬁcant, we will treat only the case of increasing indices for a while, and the
modules associated to our complexes will therefore be cohomology modules. A

154
III. Brauer Group
cochain map2 between two complexes X and Y in the same category CR is a
system f = { fn} of R homomorphisms fn : Xn →Yn such that the various
squares commute in Figure 3.1.
X :
· · ·
dn−2
−−−→Xn−1
dn−1
−−−→Xn
dn
−−−→Xn+1
dn+1
−−−→· · ·
⏐⏐+ fn−1
⏐⏐+ fn
⏐⏐+ fn+1
Y :
· · ·
d′
n−2
−−−→Yn−1
d′
n−1
−−−→Yn
d′
n
−−−→Yn+1
d′
n+1
−−−→· · ·
FIGURE 3.1. A cochain map f : X →Y.
Proposition 3.23. A cochain map f : X →Y as in Figure 3.1 induces an R
homomorphism on cohomology H n(X) →H n(Y) in each degree.
PROOF. Suppose that xn is in ker dn, i.e., that dn(xn) = 0. The commutativity
of the right square gives d′
n( fn(xn)) = fn+1(dn(xn)) = 0, and hence f (xn) is
in ker d′
n. Suppose that xn is in image dn−1, i.e., that xn = dn−1(xn−1) for some
xn−1. The commutativity of the left square gives fn(xn) = fndn−1(xn−1) =
d′
n−1( fn−1(xn−1)), and hence fn(xn) is in image d′
n−1. Then it follows that fn

ker dn
descends to the quotient (ker dn)/(image dn−1), yielding a map of H n(X) into
H n(Y).
□
Suppose in the situation of Figure 3.1 that g = {gn} is a second cochain map
of X into Y. We say that f is homotopic3 to g, written f ≃g, if there is a system
h = {hn} of maps hn : Xn →Yn−1 in CR such that d′h + hd = f −g, i.e., if
d′
n−1hn + hn+1dn = fn −gn for all n.
Proposition 3.24. In the situation of Figure 3.1 if f = { fn} and g = {gn} are
two cochain maps of X into Y and if f and g are homotopic, then f and g induce
identical maps H n(X) →H n(Y) in each degree.
PROOF. Suppose that dn(xn) = 0. Then fn(xn) −gn(xn) = d′
n−1(hn(xn)) +
hn+1(dn(xn)) = d′
n−1(hn(xn)) + 0 shows that the images of xn under fn and gn
in Yn differ by a member of image d′
n−1.
□
Now we bring free R modules into the discussion.
2The analogous kind of system in which the complexes have decreasing indices is called a chain
map.
3An analogous deﬁnition is to be made in the case of two chain maps. If the maps of X are
∂n : Xn+1 →Xn and the maps of Y are ∂′
n : Yn+1 →Yn, then we are to have hn : Xn →Yn+1 with
∂′
nhn + hn−1∂n−1 = fn −gn.

5. Digression on Cohomology of Groups
155
Proposition 3.25. For the diagram
F
∂
−−−→M
∂1
−−−→N
⏐⏐+ f
⏐⏐+ f1
F′
∂′
−−−→M′
∂′
1
−−−→N ′
f
in CR, suppose that the top and bottom rows are exact at M and M′, suppose
that the square on the right commutes, and suppose that F is a free R module.
Then there exists an R homomorphism f : F →F′ that makes the left square
commute.
PROOF. If x is a free generator of F, then 0 = f1∂1∂(x) = ∂′
1( f ∂x). By
exactness at M′, f ∂x lies in image(∂′). Choose any y ∈F′ with ∂′y = f ∂x, and
deﬁne f (x) to be this y. Then f ∂x = ∂′ f x, and the left square commutes at x.
The universal mapping property of free R modules says that f extends to an R
homomorphism of F into F′, and the extension has f ∂= ∂′ f , as required.
□
Corollary 3.26. In the category CZG, if the rows of the diagram
∂′
n+1
−−−→Xn+1
∂′
n
−−−→Xn
∂′
n−1
−−−→· · ·
∂′
0
−−−→X0
ε′
−−−→Z −−−→0
⏐⏐+ fn+1
⏐⏐+ fn
⏐⏐+ f0
⏐⏐+1
∂′′
n+1
−−−→Yn+1
∂′′
n
−−−→Yn
∂′′
n−1
−−−→· · ·
∂′′
0
−−−→Y0
ε′
−−−→Z −−−→0
are free resolutions and the vertical identity map 1 : Z →Z is given, then the
remaining vertical maps,
f0 : X0 →Y0,
. . . ,
fn : Xn →Yn,
fn+1 : Xn+1 →Yn+1,
. . . ,
can be constructed inductively from the right to make all the squares commute.
REMARK. The resulting system f = { fn} is called a chain map over the
identity map 1 : Z →Z.
PROOF. There is no harm in including a vertical 0 map at the right between
the two 0 modules. Certainly the square whose verticals are the identity map
1 : Z →Z and the 0 map commutes. Proposition 3.25 is to be applied ﬁrst to this
square and the second square from the right (with vertical f0 to be constructed and
vertical 1 : Z →Z given) to construct f0, then to the second and third squares
from the right to construct f1, and so on, inductively.
□

156
III. Brauer Group
Proposition 3.27. For the diagram
F
∂
−−−→F
∂1
−−−→N
⏐⏐+ f
⏐⏐+ f
⏐⏐+ f1
F −−−→
∂
F −−−→
∂1
N
h
h1
in CR, suppose that the top and bottom rows are exact at F, that the left and right
squares commute, that F and F are free R modules, and that h1 : N →F exists
with f1 −∂1h1 vanishing on image(∂1). Then there exists h : F →F such that
∂h + h1∂1 = f , and this property implies that f −∂h vanishes on image(∂).
PROOF. If x is a free generator of F, then f (x)−h1(∂1(x)) is in ker(∂1) because
∂1( f x −h1∂1x) = f1∂1x −∂1h1∂1x = ( f1 −∂1h1)(∂1x) and because f1 −∂1h1
vanishes on image(∂1) by assumption. Therefore f (x)−h1(∂1(x)) is in image(∂),
and we can write f (x) −h1(∂1(x)) = ∂a for some a ∈F. Put h(x) = a. Then
∂hx = ∂a = f x −h1∂1x, and h has the required property on the generator x.
The universal mapping property of the free R module F allows us to extend h to
an R homomorphism h : F →F, and the extension satisﬁes ∂h = f −h1∂1.
Once h has this property, then necessarily ( f −∂h)∂= (h1∂1)∂= h1(∂1∂) = 0.
□
Corollary 3.28. In the category CZG, if a free resolution X = {Xn} of Z and a
chain map f = { fn} of X with itself are given such that the map from Z to itself
is 0, then the chain map f is homotopic to the zero chain map g = {gn} with
gn = 0 for all n.
PROOF. We are given the diagram
−−−→Xn −−−→· · ·
∂′
1
−−−→X1
∂′
0
−−−→X0
ε′
−−−→Z −−−→0
⏐⏐+ fn
⏐⏐+ f1
⏐⏐+ f0
⏐⏐+0
−−−→Xn −−−→· · ·
∂′
1
−−−→X1
∂′
0
−−−→X0
ε′
−−−→Z −−−→0
h1
h0
h−1
in the category CZG with the two rows as free resolutions and all squares com-
muting. We are to construct maps hn : Xn →Xn+1 with ∂′
nhn + hn−1∂′
n−1 = fn.
Let h−2 be the 0 map from the top 0 module to the bottom Z, and let h−1 be the 0
map from the top Z to the bottom X0. Then ∂′
nhn + hn−1∂′
n−1 = fn is satisﬁed
for n = −1 because the map f−1 is the 0 map from Z to itself. Proposition 3.27
then allows us to construct inductively ﬁrst h0, then h1, then h2, and so on.
□

5. Digression on Cohomology of Groups
157
Corollary 3.29. In the category CZG, if a free resolution X = {Xn} of Z and a
chain map f = { fn} of X with itself are given such that the map from Z to itself
is the identity 1, then the chain map f is homotopic to the identity chain map
g = {gn} with gn = 1 for all n.
PROOF. Apply Corollary 3.28 to f −1.
□
Corollary 3.30. In the category CZG, if two free resolutions X = {Xn} of Z
and Y = {Yn} of Z are given and if two chain maps f : X →Y and g : Y →X
are given such that the map from Z to itself in each case is the identity 1, then g f
is homotopic to 1 and f g is homotopic to 1.
PROOF. Apply Corollary 3.29 to f g and then to g f .
□
Theorem 3.31. If
· · ·
∂′
n+1
−−→F′
n+1
∂′
n
−−→F′
n
∂′
n−1
−−→· · ·
∂′
0
−−→F′
0
ε
−−→Z −−→0
is any free resolution of Z in the category CZG and M is a unital left ZG module,
then H n(G, M) is canonically isomorphic to the nth cohomology group of the
complex in CZ given by
0 −→HomZG(F′
0, M)
d0
−−→· · · HomZG(F′
n, M)
dn
−−→HomZG(F′
n+1, M)
dn+1
−−→
with dn = Hom(∂′
n, 1) for n ≥0.
PROOF. Let the resolution in the statement of the theorem be Y, and let X be the
standard free resolution of Z in the category CZG. Two applications of Corollary
3.26 produce chain maps f : X →Y and g : Y →X over 1 : Z →Z. Corollary
3.30 shows that g f is homotopic to 1 = 1X and f g is homotopic to 1 = 1Y.
Apply the functor HomZG( · , M) throughout, including to the members of the
homotopies. Then we obtain chain maps
HomZG( f, 1) : HomZG(Y, M) →HomZG(X, M)
HomZG(g, 1) : HomZG(X, M) →HomZG(Y, M)
and
with
HomZG( f, 1) ◦HomZG(g, 1)
homotopic to 1
HomZG(g, 1) ◦HomZG( f, 1)
homotopic to 1.
and
Proposition 3.24 allows us to conclude that
HomZG( f, 1) ◦HomZG(g, 1) induces the identity on H ∗(HomZG(X, M))
and
HomZG(g, 1) ◦HomZG( f, 1) induces the identity on H ∗(HomZG(Y, M)).
Thus HomZG(g, 1) induces an isomorphism of each group H n(HomZG(X, M))
onto H n(HomZG(Y, M)).
□

158
III. Brauer Group
6. Relative Brauer Group when the Galois Group Is Cyclic
This section has two parts to it. The ﬁrst part specializes Theorem 3.31 to compute
group cohomology when the group in question is cyclic of ﬁnite order. The second
part applies this computation to H 2(Gal(K/F), K ×) and obtains information
about Brauer groups. As a consequence we obtain new information about the
classiﬁcation of noncommutative division algebras.
Let G be a ﬁnite cyclic group of order n. Theorem 3.31 says that if G acts by
automorphisms on an abelian group M, then H 2(G, M) can be computed from
any free resolution of Z in the category CZG. The standard resolution of Z is one
such resolution. We shall construct another such resolution that is special to the
case of G cyclic and that makes the cohomology more transparent.
Let G = {1, s, s2, . . . , sn−1}. Lemma 3.19 notes that the free abelian group
on the 1-tuples (1), (s), (s2), . . . , (sn−1) is a free ZG module with ZG basis (1).
In other words, the elements of the left ZG module ZG may be identiﬁed with
the integer linear combinations of these 1-tuples. Deﬁne two operators T and N
from the left ZG module ZG into itself by
T = multiplication by (s) −(1),
N = multiplication by (1) + (s) + · · · + (sn−1).
Each of these respects addition and commutes with multiplication by (s), hence
is a ZG module homomorphism. We shall compute the kernel and image of each.
The kernel of T consists of all elements for which left multiplication by (s)
ﬁxes the element. The elements of ZG are of the form 	n−1
j=0 cj(s j), and (s) times
this gives cn−1(1) + 	n−1
j=1 cj−1(s j). Since (1), (s), . . . , (sn−1) form a Z basis,
the condition to be in the kernel of T is that cn−1 = c0 = c1 = · · · = cn−2. Thus
ker T =

c

(1) + (s) + · · · + (sn−1)
  c ∈Z

.
Also,
image T = {integer polynomials in (s) divisible by (s) −(1)}
= {integer polynomials equal to 0 when s is set equal to 1}
=
( n−1
	
j=0
cj(s j)

n−1
	
j=0
cj = 0
)
.
In the case of the operator N, we have N(s j) = (1) + (s) + · · · + (sn−1), and
therefore N
 	
j cj(s j)

= 	
j cj

(1) + (s) + · · · + (sn−1)

. Hence
ker N =
( n−1
	
j=0
cj(s j)

n−1
	
j=0
cj = 0
)
= image T,
image N =

c

(1) + (s) + · · · + (sn−1)
  c ∈Z

= ker T.

6. Relative Brauer Group when the Galois Group Is Cyclic
159
An immediate consequence of this and a supplementary argument concerning the
augmentation map is the following proposition.
Proposition 3.32. If G is a ﬁnite cyclic group, then the sequence
· · ·
T
−−→ZG
N
−−→ZG
T
−−→· · ·
T
−−→ZG
N
−−→ZG
T
−−→ZG
ε
−−→Z −−→0
is a free resolution of Z in the category CZG.
PROOF. We still need to check exactness at the ﬁrst ZG from the right. The
map ε is the ZG homomorphism with ε((1)) = 1. Hence ε((s j)) = 1 for all j,
and ε
 	n−1
j=0 cj(s j)

= 	n−1
j=0 cj. Thus ker ε = ker N = image T , and exactness
is proved.
□
Corollary 3.33. If G is a ﬁnite cyclic group and M is an abelian group on
which G acts by automorphisms, then
H 2(G, M) ∼= MG
(1) + (s) + · · · + (sn−1)

M,
where MG is the subgroup of all elements of M ﬁxed by G.
PROOF. Let us number the terms ZG in the resolution of Proposition 3.32
starting with index 0 from the right. Combining Proposition 3.32 with Theorem
3.31, we see that we may compute H 2(G, M) as the cohomology of the complex
obtained by applying the functor HomZG( · , M) to the terms with indices 1, 2, 3
in the resolution in Proposition 3.32. Thus H 2(G, M) is the cohomology at the
middle of the complex
HomZG(ZG, M)
(·)◦N
−−−→HomZG(ZG, M)
(·)◦T
−−−→HomZG(ZG, M).
The mapping α 	→α((1)) of HomZG(ZG, M) into M is one-one and onto, and
we can identify members α of HomZG(ZG, M) with the corresponding elements
α((1)) accordingly. If α is in ker

(·)◦T

, then α(T ((1))) = 0, and we thus have
α((s)) = α((1)) and (s)α((1)) = α((1)). Hence α((1)) is in MG. These steps
can be reversed, and thus ker

(·) ◦T

= MG. If β is in image

(·) ◦N

, then
β = α ◦N for some α ∈HomZG(ZG, M), and thus
β((1)) = α

(1)+(s)+· · ·+(sn−1)

= α((1))+(s)α((1))+· · ·+(sn−1)α((1)).
Since α((1)) is a completely arbitrary element of M, we see that image

(·)◦N

=

(1) + (s) + · · · + (sn−1)

M, and the result follows.
□

160
III. Brauer Group
Now we specialize to the Galois case that has occupied our attention in this
chapter. Let K/F be a ﬁnite Galois extension of ﬁelds. We are going to set G =
Gal(K/F), n = dimF K, and M = K ×. To take advantage of Corollary 3.33, we
suppose that Gal(K/F) is cyclic. Then MG = (K ×)G = F×. If x is an element
of K ×, then the orbit Gx is {x, sx, s2x, . . . , sn−1x}. Remembering that we are
using additive notation in working with cohomology of groups and multiplicative
notation in working with K ×, we see that the element

(1) + (s) + · · · + (sn−1)

of ZG is to be regarded as operating by giving the product of the members of an
orbit in K ×. This product for the orbit of x ∈K × is NK/F(x), and Corollary
3.33 thus specializes to the following result.
Corollary 3.34.
If K/F is a ﬁnite Galois extension of ﬁelds such that
Gal(K/F) is cyclic, then
H 2(Gal(K/F), K ×) ∼= F×
NK/F(K ×).
Corollary 3.34 considerably simpliﬁes the proofs of Frobenius’s Theorem
about division algebras over the reals (Theorem 2.50) and Wedderburn’s Theorem
about ﬁnite division rings (Theorem 2.48), and thus the theory in Chapter III has
added something to the theory of Chapter II even in these very special situations.
In the case of the Frobenius theorem, the only nontrivial algebraic extension of
R is C, and thus Theorem 3.14 and Corollary 3.34 give
B(R) = B(C/R) ∼= H 2(Gal(C/R), R×)
∼= R×
NC/R(C×) = R×/(R×)+ ∼= Z/2Z.
Hence the reals and the quaternions are the only ﬁnite-dimensional central simple
division algebras over R.
In the case of the Wedderburn theorem, suppose that a ﬁnite ﬁeld K splits a
central division algebra over a ﬁeld F with q elements. Say that |K| = qn. For
ﬁnite ﬁelds the Galois groups are always cyclic, and thus Gal(K/F) is cyclic of
order n, generated by the map x 	→xq. In view of Corollary 3.34, the Wedderburn
theorem follows if F×
NK/F(K ×) is shown to be trivial, i.e., if the norm map
NK/F : K × →F× is onto. The group K × is cyclic, say with a generator x0 of
order qn −1. Since the norm of an element is the product of the images under
the Galois group, the norm of x0 is given by
NK/F(x0) = x0xq
0 xq2
0 · · · xqn−1
0
= x1+q+···+qn−1
0
= x
qn−1
q−1
0
.
This has order q −1, not less, and thus is a generator of F×. Thus the norm map
is onto F×.

6. Relative Brauer Group when the Galois Group Is Cyclic
161
For a more difﬁcult example that we can settle completely, consider the case
that F = Q and K = Q(√m ) for a square-free integer m other than 1. The
Galois group in this case is a 2-element group and is in particular cyclic. Thus
Corollary 3.34 applies.
The norm of the member x + y√m of K, where x
and y are in Q, is x2 −my2. The problem of determining the quotient group
F×
NK/Q(K ×) may be rephrased in terms of genera as in Section I.5. Speciﬁ-
cally the ﬁeld discriminant D is deﬁned to be m if m ≡1 mod 4 and to be 4m if
m ̸≡1 mod 4. A genus for Q(√m ) is an equivalence class of primitive quadratic
forms ax2 + bxy + cy2 whose discriminant matches the ﬁeld discriminant D,
except that the theory of Chapter I discards all negative deﬁnite forms. Equiv-
alence is determined by the action of SL(2, Q). Lemma 1.13 shows for D > 0
that each nonzero rational number is a value taken on by the members of one and
only one genus at points (x, y) ̸= (0, 0) with x and y both rational; for D < 0,
Lemma 1.13 applies to positive deﬁnite forms and positive rational numbers. Let
us now enlarge the deﬁnition of genera to include negative deﬁnite forms and
negative rational numbers when D < 0.
The deﬁnition of the multiplication of classes of forms is set up so as to
be compatible with multiplication of the values of the quadratic forms, and the
genera deﬁne a group, the identity element being the principal genus. Since
a representative of the principal genus is x2 −my2, the nonzero rational val-
ues corresponding to the principal genus are exactly the members of the group
NK/Q(K ×). Consequently the quotient group F×
NK/Q(K ×) is isomorphic to
the group of genera.4 The easy result concerning the group of genera is Theorem
1.14, which says that this group is ﬁnite abelian and that every nontrivial element
has order 2; since B(K/F) ∼= F×
NK/Q(K ×), Corollary 3.15 gives another way
of seeing that every nontrivial element has order 2. The hard result, which appears
in Problems 25–29 at the end of Chapter I, identiﬁes the order of the group of
genera explicitly.5 If D > 0, then the order of the group of genera is 2g′, where
g′ + 1 is the number of distinct prime divisors of D; if D < 0, then the order of
the group of genera is 2g′+1.
Consequently if m has g + 1 distinct prime divisors, then the relative Brauer
group is a product of 2-element groups whose order is given by
B(Q(√m )/Q)
 =
⎧
⎪⎪⎪⎨
⎪⎪⎪⎩
2g
if m > 0 and m ̸≡3 mod 4,
2g+1
if m > 0 and m ≡3 mod 4,
2g+1
if m < 0 and m ̸≡3 mod 4,
2g+2
if m < 0 and m ≡3 mod 4.
4With the understanding that genera from negative deﬁnite forms are to be allowed if D < 0.
5In quoting this result, we are now making allowances for genera corresponding to negative
deﬁnite forms.

162
III. Brauer Group
The example with K/Q quadratic shows the kind of information that has to go
into a complete determination of the relative Brauer group when K/Q is Galois.
Showing that a relative Brauer group is nontrivial in a case with Gal(K/Q) cyclic
is considerably easier. According to Corollary 3.34, all one needs to know is that
the norm function does not carry K × onto Q×, and congruence conditions can
be used as a ﬁrst step in addressing this question; Problem 4 at the end of the
chapter illustrates this principle. Problems 15–17 at the end of Chapter II give
a construction in this situation of nontrivial central simple algebras over Q that
are split by K, and such algebras whose dimension is the square of a prime are
necessarily division algebras. Problems 6–12 at the end of the present chapter
give a sufﬁcient condition for obtaining a division algebra when the dimension is
not the square of a prime.
7. Problems
1.
Let A be a ﬁnite-dimensional central simple algebra over a ﬁeld F, let K be a
subﬁeld of A, and let B be the centralizer of K in A.
(a) Arguing as in the proof of Theorem 3.3, exhibit a one-one algebra homo-
morphism A ⊗F K →EndBo A.
(b) Referring to the proof of Theorem 2.2 and counting dimensions with the aid
of the Double Centralizer Theorem, prove that the mapping in (a) is onto
EndBo A.
(c) Deduce that A ⊗F K and B yield the same member of B(K).
2.
Let a = a(σ, τ) be a 2-cocycle in Z2(Gal(K/F), K ×), where K/F is a ﬁnite
Galois extension of ﬁelds. Prove for each τ that 
σ∈Gal(K/F) a(σ, τ) lies in F×.
3.
Let K/F be a ﬁnite Galois extension of ﬁelds with Gal(K/F) cyclic. Corollary
3.34 identiﬁes H q(Gal(K/F), K ×) for q = 2. Identify this group for all other
values of q ≥0.
Problems 4–5 amplify the discussion of cyclic algebras that was begun in Problems
17–19 at the end of Chapter II. Problem 4 in effect produces an explicit division
algebra of dimension 9 over Q, and Problem 5 hints at the existence of an explicit
division algebra of dimension n2 over Q for each integer n ≥1.
4.
Let ζ = e2πi/7, and let K = Q(ζ) ∩R.
(a) Show that K/Q is a Galois extension of degree 3, that a basis for K over
Q consists of τ1 = ζ + ζ −1, τ2 = ζ 2 + ζ −2, τ3 = ζ 3 + ζ −3, and that the
Galois group permutes τ1, τ2, τ3 cyclically.
(b) Show that if a, b, c are in Q, then

7. Problems
163
NK/Q(aτ1 + bτ2 + cτ3) = abc(τ 3
1 + τ 3
2 + τ 3
3 )
+ (a3 + b3 + c3 + 3abc)τ1τ2τ3
+ (a2b + ac2 + b2c)(τ 2
1 τ2 + τ 2
2 τ3 + τ 2
3 τ1)
+ (a2c + ab2 + bc2)(τ1τ 2
2 + τ2τ 2
3 + τ3τ 2
1 ).
(c) Verify the following identities:
τ1 + τ2 + τ3 = −1,
τ1τ2 = τ1 + τ3,
τ1τ3 = τ2 + τ3,
τ2τ3 = τ1 + τ2,
τ 2
1 = τ2 + 2,
τ 2
2 = τ3 + 2,
τ 2
3 = τ1 + 2.
(d) Combine (b) and (c) to show that
NK/Q(aτ1 + bτ2 + cτ3) = (a3 + b3 + c3) −abc
+ 3(a2b + ac2 + b2c) −4(a2c + ab2 + bc2).
(e) Under the assumption that a, b, c are integers with GCD(a, b, c) = 1, show
that NK/Q(aτ1 + bτ2 + cτ3) ̸≡0 mod 3.
(f)
Deduce from (e) that r = 3 is not in NK/Q(K ×). (Educational note: Conse-
quently Problems 18–19 at the end of Chapter II produce an explicit division
algebra over Q of dimension 9.)
5.
(a) Show for each integer n ≥1 that there exists a prime p such that n divides
p −1.
(b) Deduce for this p that there exists a ﬁeld L with Q ⊆L ⊆Q(e2πi/p) such
that the ﬁeld extension L/Q is a Galois extension whose Galois group is
cyclic of order n.
Problems 6–12 continue the discussion of cyclic algebras that was begun in Problems
17–19 at the end of Chapter II and continued in Problems 4–5 above. Let F be any
ﬁeld, and let K be a ﬁnite Galois extension of F whose Galois group G = Gal(K/F)
is cyclic of order n. Let σ be a generator of G, ﬁx an element r ̸= 0 in F, and let A
be the subset of matrices in Mn(K) of the form
⎛
⎜⎜⎜⎝
c1
c2
c3
· · ·
cn
rσ(cn)
σ(c1)
σ(c2)
· · · σ(cn−1)
rσ 2(cn−1)
rσ 2(cn)
σ 2(c1)
· · · σ 2(cn−2)
...
...
...
...
...
rσ n−1(c2) rσ n−1(c3) rσ n−1(c4) · · · σ n−1(c1)
⎞
⎟⎟⎟⎠.
Identify c ∈K with the diagonal member of A for which c1 = c and c2 = · · · = cn =
0, and let j be the member of A for which c1 = 0, c2 = 1, and c3 = · · · = cn = 0.
Under this identiﬁcation every member of A has a unique expansion as 	n
k=1 ck jk−1
with all ck in K, and the element j satisﬁes jn = r and jcj−1 = σ(c) for c ∈K.
Take it as known that A is a central simple algebra over F of dimension n2. This

164
III. Brauer Group
series of problems leads in part to another theorem due to Wedderburn. (However, a
more direct proof of the theorem of Wedderburn without the other results is possible.)
6.
In the construction of factor sets in Section 2, use xσ k = jk for 0 ≤k ≤n −1.
Show that the algebra A above corresponds to the 2-cocycle a with
a(σ k, σ l) =
 1
if k + l < n,
r
if k + l ≥n.
7.
Under the assumption that r = NK/F(x) with x ∈K ×, show that the choice
cσ k = xσ(x)σ 2(x) · · · σ k−1(x) exhibits the factor set of the previous problem as
a trivial factor set and hence shows that A ∼= Mn(F).
8.
Let F = {Fk} be the standard free resolution of Z in CZG, and let X = {Xk}
be the free resolution of Proposition 3.32. The latter has Xk = ZG for every
k ≥0. Trace through the proof of Corollary 3.26, and show that the proof allows
a chain map f = { fk} to be deﬁned in such a way that the values of f0, f1, f2
on standard ZG basis elements of F0, F1, F2 are f0(1) = 1, f1(1, σ k) =
−(1 + σ + · · · + σ k−1) for 0 ≤k < n, and
f2(1, σ k, σ l) =
 0
if 0 ≤k ≤l < n,
−σ l
if 0 ≤l < k < n.
9.
Let 2 : HomZG(F2, K ×) →C2(G, K ×) be the isomorphism of Section 5,
and let ψ be in HomZG(ZG, K ×). Show that the member of C2(G, K ×) that
corresponds to ψ is 2(ψ ◦f2) and that
2(ψ ◦f2)(σ k, σ l) =
 ψ(0)
if k + l < n,
ψ(σ k+l−n)−1
if k + l ≥n.
10. Let y be a member of K ×, and let ψ be the unique element of HomZG(ZG, K ×)
with ψ(1) = y. Why in the context of Proposition 3.32 is ψ a 2-cocycle if and
only if y is in F×?
11. Take ψ as in the previous problem with ψ(1) = r−1, and show that the member of
C2(G, K ×) that corresponds to it under Problem 9 is the factor seta of Problem 6.
12. Deduce from the previous problem that the order of the Brauer equivalence class
in B(K/F) is the order of the coset of r in F×
NK/F(K ×). Why does it follow
that A is a division algebra over F if the coset of r in F×
NK/F(K ×) has exact
order n? (Educational note: This result is a theorem of Wedderburn except that
it is here dressed in more modern language. The special case that n is prime
was already handled by Problems 18–19 at the end of Chapter II. Although the
converse was seen in those problems to be valid for n prime, the converse is
known to fail for n = 4.)
Problems 13–20 introduce the reduced norm of a central simple algebra and give an
application. Let A be a central simple algebra over a ﬁeld F with dimF A = n2. For
a in A, the algebra polynomial of a is deﬁned to be the characteristic polynomial

7. Problems
165
det(X1 −A) of the F linear mapping L(a) : A →A given by the left multiplication
x 	→ax. This monic polynomial lies in F[X] and has degree n2. The ordinary
norm NA/F(a) is deﬁned to be (−1)n2 times the constant term, and the ordinary
trace TrA/F(a) is deﬁned to be minus the coefﬁcient of Xn2−1; these functions of a
take values in F. Choose a ﬁnite Galois extension K of F that splits A, and ﬁx an
isomorphism ϕ : A ⊗F K →Mn(K). The reduced polynomial of a is deﬁned to be
the monic polynomial det

ϕ(X1 −a ⊗1)

. This polynomial lies in K[X] and has
degree n. The reduced norm NrdA/F(a) is deﬁned to be (−1)n times the constant
term, and the reduced trace TrrdA/F(a) is deﬁned to be minus the coefﬁcient of
Xn−1; these functions of a initially take values in K.
13. Prove that the reduced polynomial of a does not depend on the choice of the
isomorphism ϕ.
14. Prove that det(X1 −a) = det

ϕ(X1 −a ⊗1)
n.
15. Using Galois theory and unique factorization, prove that any monic polynomial
P(X) in K[X] such that P(X)n lies in F[X] already lies in F[X]. Conclude that
the reduced polynomial of any element of A is in F[X].
16. Prove that det

ϕ(X1 −a ⊗1)

does not depend on the choice of the Galois
extension K of F that splits A.
17. Deduce that NrdA/F is a function from A to F such that NrdA/F(ab) =
NrdA/F(a)NrdA/F(b) for all a and b in A, NrdA/F(1) = 1, and NrdA/F(a)n =
NA/F(a) for all a in A. How does it follow that
(a) an element a ∈A is invertible if and only if NrdA/F(a) ̸= 0 and
(b) A is a division algebra if and only if NrdA/F(a) = 0 only for a = 0?
18. Let K/F be a ﬁnite Galois extension of ﬁelds, put G = Gal(K/F), and suppose
that a crossed-product algebra A = A(K, G, a) is given as in Proposition 3.12
with K ⊆A and with dimF A = (dimF K)2 = n2. Let {xσ | σ ∈G} be the
system in the proposition such that A = !
σ∈G K xσ. Associate a matrix m(v)
in Mn(K) to each v ∈A as follows. The rows and columns of the matrices are
indexed by G, and Eσ,τ denotes the matrix that is 1 in the (σ, τ) entry and is 0
elsewhere. Letm(cxτ) = 	
σ σ(c)a(σ, τ)Eσ,στ for c ∈K, and extend additively
to handle allv ∈A. Check thatv 	→m(v) is a one-one F algebra homomorphism
of A into Mn(K), and prove that NrdA/F(v) = det m(v). (Educational note: Thus
by Proposition 3.12 the matrix algebra in Problems 6–12 is central simple.)
19. Identify the norm and the reduced norm for the real algebra H of quaternions.
20. A ﬁeld F is said to satisfy condition (C1) if every homogeneous polynomial
of degree d in n variables with d < n has a nontrivial zero. Using the reduced
norm for a central division algebra over F, prove that condition (C1) implies
that B(F) = 0. (Educational note: Algebraically closed ﬁelds and ﬁnite ﬁelds
satisfy (C1), the latter by a theorem of Chevalley. A deeper fact is that a simple
transcendental extension of an algebraically closed ﬁeld satisﬁes (C1).)

CHAPTER IV
Homological Algebra
Abstract. This chapter develops the rudiments of the subject of homological algebra, which is an
abstraction of various ideas concerning manipulations with homology and cohomology. Sections
1–7 work in the context of good categories of modules for a ring, and Section 8 extends the discussion
to abelian categories.
Section 1 gives a historical overview, deﬁnes the good categories and additive functors used in
most of the chapter, and gives a more detailed outline than appears in this abstract.
Section 2 introduces some notions that recur throughout the chapter—complexes, chain maps,
homotopies, induced maps on homology and cohomology, exact sequences, and additive functors.
Additive functors that are exact or left exact or right exact play a special role in the theory.
Section 3 contains the ﬁrst main theorem, saying that a short exact sequence of chain or cochain
complexes leads to a long exact sequence in homology or cohomology. This theorem sees repeated
use throughout the chapter. Its proof is based on the Snake Lemma, which associates a connecting
homomorphism to a certain kind of diagram of modules and maps and which establishes the exactness
of a certain 6-term sequence of modules and maps. The section concludes with proofs of the crucial
fact that the Snake Lemma and the ﬁrst main theorem are functorial.
Section 4 introduces projectives and injectives and proves the second main theorem, which
concerns extensions of partial chain and cochain maps and also construction of homotopies for
them when the complexes in question satisfy appropriate hypotheses concerning exactness and the
presence of projectives or injectives. The notion of a resolution is deﬁned in this section, and the
section concludes with a discussion of split exact sequences.
Section 5 introduces derived functors, which are the basic mathematical tool that takes advantage
of the theory of homological algebra. Derived functors of all integer orders ≥0 are deﬁned for any
left exact or right exact additive functor when enough projectives or injectives are present, and they
generalize homology and cohomology functors in topology, group theory, and Lie algebra theory.
Section 6 implements the two theorems of Section 3 in the situation in which a left exact or right
exact additive functor is applied to an exact sequence. The result is a long exact sequence of derived
functor modules. It is proved that the passage from short exact sequences to long exact sequences
of derived functor modules is functorial.
Section 7 studies the derived functors of Hom and tensor product in each variable. These are
called Ext and Tor, and the theorem is that one obtains the same result by using the derived functor
mechanism in the ﬁrst variable as by using the derived functor mechanism in the second variable.
Section 8 discusses the generalization of the preceding sections to abelian categories, which are
abstract categories satisfying some strong axioms about the structure of morphisms and the presence
of kernels and cokernels. Some generalization is needed because the theory for good categories is
insufﬁcient for the theory for sheaves, which is an essential tool in the theory of several complex
variables and in algebraic geometry. Two-thirds of the section concerns the foundations, which
involve unfamiliar manipulations that need to be internalized. The remaining one-third introduces an
166

1. Overview
167
artiﬁcial deﬁnition of “member” for each object and shows that familiar manipulations with members
can be used to verify equality of morphisms, commutativity of square diagrams, and exactness of
sequences of objects and morphisms. The consequence is that general results for categories of
modules in homological algebra requiring such veriﬁcations can readily be translated into results for
general abelian categories. The method with members, however, does not provide for constructions
of morphisms member by member. Thus the construction of the connecting homomorphism in the
Snake Lemma needs a new proof, and that is given in a concluding example.
1. Overview
This chapter develops the rudiments of the subject of homological algebra. The
only prerequisite within the present volume is the self-contained Section III.5
entitled “Digression on Cohomology of Groups,” which is helpful primarily as
motivation. The deﬁnitions of category, functor, object, morphism, natural trans-
formation, product, and coproduct as in Chapters IV and VI of Basic Algebra will
be taken as known, and it will be helpful as motivation to know also the material
from Chapter VII of Basic Algebra on group extensions and cohomology of
groups. The present chapter will make some allusions to notions from algebraic
topology, particularly in this ﬁrst section, and the reader is encouraged to skip
lightly over anything of this kind that might be an impediment to continuing with
the remainder of the chapter.
Homology and cohomology have their origins in attempts to assign algebraic
invariants to topological obstructions. One example historically was the holes
in a domain of the Euclidean plane that can make line integrals that are locally
independent of the path fail to be globally independent of the path. Another was
the handles on 2-dimensional closed surfaces. These obstructions were originally
viewed as numbers (Betti numbers for example) and later viewed as algebraic
objects such as abelian groups or vector spaces. A big advance was to regard
them not just as objects attached to geometric conﬁgurations but as functors that
attach objects to geometric conﬁgurations and also attach functions between such
objects to reﬂect the behavior of functions between geometric conﬁgurations.
Hintsof connections with algebra on a deeper level and hints that homology and
cohomology could be computed quite ﬂexibly began with work of W. Hurewicz
in 1936 and H. Hopf in 1942. Hurewicz considered the following situation: M
is a ﬁnite connected simplicial complex, U is its universal cover, and G is the
fundamental group of M. Suppose that U is contractible. The group G acts freely
on the group C∗(U) of simplicial chains of U (with integer coefﬁcients). The
boundary operator then gives us an exact sequence
0 ←−Z ←−C0(U) ←−C1(U) ←−C2(U) ←−· · ·
of abelian groups with an action of G on each Cj(U) by automorphisms in such
a way that each Cj(U) in effect is a free ZG module. Applying ( · ) ⊗ZG Z, we

168
IV. Homological Algebra
obtain the complex
0 ←−C0(M) ←−C1(M) ←−C2(M) ←−· · · .
The homology H0(M) is just Z because M is connected, and H1(M) is just the
quotient of G by its commutator subgroup; thus H0(M) and H1(M) depend only
on G. What Hurewicz showed is that all higher Hi(M) depend only on G; he did
not address existence of such spaces M and U for G.
Hopf clariﬁed the situation and drew attention to it by making an explicit
calculation: Dropping all assumptions on U other than its simple connectivity,
he gave a formula for the quotient of H2(M) modulo the subgroup of “spherical
homology classes” in terms of G. Later he obtained a result for higher-degree
homology. In effect, Hopf was giving formulas for Hn(G, Z) by discovering and
applying the homology analog of the cohomology result given as Theorem 3.31
in Section III.5.
Meanwhile, S. Eilenberg in 1944 made an adjustment to Lefschetz’s singular
homology theory and showed for locally ﬁnite polyhedra that his adjusted theory
gives the same groups as the more traditional simplicial theory. His method
was to introduce a third complex, to exhibit chain maps from this to each of
the complexes under study, and show that the chain maps possess inverses in a
suitable sense.
In addition to the people mentioned above, some others who pursued these mat-
ters in the mid 1940s were R. Baer, B. Eckmann, H. Freudenthal, and S. Mac Lane.
One thing that mathematicians gradually realized was that homology and coho-
mology in various situations can be calculated from suitable kinds of abstract
resolutions, a fact that lies at the heart of the subject of homological algebra.
Another was that the subject of cohomology of groups made sense on an abstract
level without any reference to topology and that the theory of factor sets for group
extensions, as had been introduced by O. Schreier in the 1920s, was actually one
aspect of this theory.
With a great leap of generality, H. Cartan and Eilenberg set down such a theory
in their celebrated book Homological Algebra, whose publication was delayed
until 1956. Homology and cohomology became things attached to complexes,
no longer dependent on topology, and the book developed enormous machinery
for working with such complexes and homology/cohomology. By the time that
Cartan and Eilenberg had published their book, other special cases of homological
algebra had already arisen. One was the cohomology theory of Lie algebras,
developed by C. Chevalley in the 1940s and by J.-L. Koszul in 1950. Another was
thecohomologytheoryofsheaves, usedinthesubjectofseveralcomplexvariables
starting about 1950 by K. Oka and H. Cartan; sheaves themselves had been
introduced in 1946 by J. Leray in connection with partial differential equations.
In the eventual theory the fundamental notion is that of a “derived functor”:
homology or cohomology is obtained by starting from some kind of resolution,

1. Overview
169
or exact complex, passing to another complex by means of a functor with some
special properties, and then extracting the homology or cohomology of the image
complex. Two categories are thus involved, one for the resolution and one for
the values of the functor. From an expository point of view, it seems wise to start
with concrete categories and not to try to identify the most general categories for
which the theory makes sense. For much of the chapter, we shall work with a
category not much more general than the category CR of all unital left R modules,
where R is a ring with identity, and our functors will pass from one such category
to another. Use of categories CR subsumes the following applications:
(i) manipulations with basic homology and cohomology in topology, in
which one begins with the ring R = Z of integers. For more advanced
applications in topology, one moves from Z to more general rings.
(ii) homology and cohomology of groups, in which one initially uses group
rings of the form ZG, where G is any group and Z is the ring of integers.
(iii) homology and cohomology of Lie algebras. If g is a Lie algebra over
a ﬁeld such as C, then g has a “universal enveloping algebra” U(g)
and a canonical mapping ι : g →U(g).
Here U(g) is a complex
associative algebra with identity, ι is a Lie algebra homomorphism, and
the pair (U(g), ι) has the following universal mapping property: when-
ever ϕ : g →A is a Lie algebra homomorphism into a complex asso-
ciative algebra A with identity, then there is a unique homomorphism
 : U(g) →A of associative algebras with identity such that ϕ =  ◦ι.
Lie algebra homology and cohomology are the theory for the set-up in
which the initial underlying rings are U(g) and C.
In other words, in each of the three applications above, many derived functors of
importance pass from the category CR for a ring R with identity to the category
CS for another ring S with identity.
The slight generalization of categories CR that we shall use for much of the
chapter is as follows: Let R be a ring with identity. A good category C of R
modules consists of
(i) some nonempty class of unital left R modules closed under passage
to submodules, quotients, and ﬁnite direct sums (the modules of the
category),
(ii) the full sets HomR(A, B) of all R linear homomorphisms from A to B
for each A and B as in (i) (the morphisms, or maps, of the category).
For example the collection of all ﬁnitely generated abelian groups, as a subcate-
gory of CZ, is a good category.1 So is the collection of all torsion abelian groups,
1One reason for working with this slight generalization is to emphasize that a certain property
of categories CR, namely that they have “enough projectives” and “enough injectives” in a sense to
be made precise below in Section 5, does not necessarily persist for slight variants of CR.

170
IV. Homological Algebra
i.e., abelian groups whose elements all have ﬁnite order, as a subcategory of CZ.
The deﬁnition of “good category” speciﬁes left R modules that are unital.
However, the theory applies equally well to right R modules that are unital, since
a unital right R module becomes a unital left module for the opposite ring Ro,
i.e., the ring whose underlying abelian group is the same as for R and whose
multiplication is given by a ◦b = ba.
The special property of a functor F : C →C ′ used for passing from a complex
in one good category to a complex in another good category is that it is additive,
namely that F(ϕ1 + ϕ2) = F(ϕ1) + F(ϕ2) whenever ϕ1 and ϕ2 are in the
same HomR(A, B). The initial examples of additive functors are tensor product
M ⊗R ( · ), which passes from CR to CZ if M is a right R module, and Hom in
each variable: HomR( · , M) and HomR(M, · ), both of which pass from CR to
CZ if M is a left R module. In Section 2 we shall consider additive functors in
more detail.
The set-up with good categories does not subsume the cohomology of sheaves,
nor some other applications of interest, such as the cohomology of vector bundles
with a ﬁxed base. The cohomology of sheaves is an important tool in algebraic
geometry and several complex variables, and it cannot be ignored. Consequently
one ultimately wants the theory to extend to other categories than good categories
of modules. In addition, it is quite useful to have the theory work for the categories
opposite to two given categories if it works for two given categories, and this
feature means that the general theory should not insist that the objects be sets
of elements and the morphisms be functions on such elements. Accordingly the
abstract theory is carried out for “abelian categories,” which will be deﬁned in
Section 8. The idea for creating the abstract theory is to take the theory for good
categories of modules and rephrase all of the results for all abelian categories. In
many instances the proofs will translate easily to the general setting, but in other
instances it will be necessary to eliminate individual elements from arguments
and obtain new arguments that rely only on complexes, exact sequences, and
commutative diagrams. Some of this detail will be carried out in Section 8.
Sections 2–3 establish the framework of homology and cohomology in the
context of good categories of modules. Section 2 discusses complexes and exact
sequences at length, and Section 3 shows how a short exact sequence of complexes
leads to a long exact sequence in homology or cohomology. This is the ﬁrst main
result of the theory and ﬁnds multiple uses later in the chapter.
Section 4 contains a discussion of “projectives and injectives” that expands and
systematizes Theorem 3.31, which concerned the ﬂexible role of resolutions in
computing the cohomology of groups. Once that ﬂexibility is in place in the more
general setting of good categories, Sections 5–6 introduce derived functors and
some of their properties. The main examples of derived functors at this stage are
functors Ext( · , · ) and Tor( · , · ) obtained from Hom and tensor product; these

2. Complexes and Additive Functors
171
are examined more closely in Section 7. The example given in Section III.5 and
now being used as motivation requires some subtlety to be regarded as a derived
functor. That example was the system of functors H n(G, · ) yielding cohomology
of the group G with coefﬁcients in the module ( · ); these were obtained in Section
III.5 by applying the functor HomZG( · , M) to any free resolution of Z in the
category CZG. It is seen in examples in Section 5 that the effect of using the free
resolution was to compute H n(G, M) as Extn
ZG( · , M) when the variable is set
equal to Z; realizing this result as a derived functor in the M variable requires
knowing that one gets the same result from Extn
ZG(Z, · ) when its variable is set
equal to M. This conclusion is part of Theorem 4.31, which is proved in Section 7.
The ﬁrst seven sections complete the treatment of the rudiments of homological
algebra in the setting of good categories. One more central technique beyond that
of derived functors is the mechanism of spectral sequences, but we shall omit this
topic to save space.2
The chapter concludes with some discussion of abelian categories in Section 8.
The foundations of homological algebra have to be redone completely when
objects are no longer necessarily sets of elements. After this step, one introduces
a substitute notion of “member” for elements, establishes its properties, and
immediately obtains extensions of much of the theory to all abelian categories. A
supplementary argument is needed whenever the theory for good categories uses
an element-by-element construction of a homomorphism.
Sheaves are introduced in the last section of text in Chapter X, and their
cohomology is mentioned very brieﬂy there.
2. Complexes and Additive Functors
Let C be a good category of R modules in the sense of Section 1. A complex in C
is a ﬁnite or inﬁnite sequence of modules and maps in C such that the consecutive
compositions are all 0.
There is no harm in assuming that the indexing for
the sequence is done by all of Z, since we can always adjoin 0 modules and 0
maps as necessary to ﬁll out the indexing. The indices may be increasing or
decreasing, and, as we saw in Section III.5, this distinction is only a formality.
However, the distinction is very convenient when it comes to applications, since
homology is normally associated with decreasing indices and cohomology is
normally associated with increasing indices.
Thus let us be more precise about the indexing. A chain complex in C is
a sequence of pairs X = {(Xn, ∂n)}∞
n=−∞in which each Xn is a module in C,
2For the reader who is interested in learning about spectral sequences, this author is partial to the
explanation of the topic in Appendix D of the book by Knapp and Vogan in the Selected References.
The setting in that appendix is limited to good categories of modules, and some important applications
are included.

172
IV. Homological Algebra
each ∂n is a map in HomR(Xn+1, Xn), and ∂n∂n+1 = 0 for all n. The maps
∂n are sometimes called boundary maps, or boundary operators. We deﬁne
the homology of X, written H∗(X) = {Hn(X)}∞
n=−∞with subscripts, to be the
sequence of modules in C given by
Hn(X) = (ker ∂n−1)/(image ∂n).
The members of the space ker ∂n−1 are called n-cycles, and the members of the
space image ∂n are called n-boundaries.
EXAMPLES OF CHAIN COMPLEXES.
(1) Simplicial homology. Let S be a simplicial complex of dimension N, and
number its vertices. For each integer n, the group Cn(S) of simplicial n-chains
is the free abelian group on the set of simplices of dimension n. This is 0 for
n < 0 and n > N. In elementary topology one deﬁnes the boundary of each
n-simplex to be the member of Cn−1(S) equal to an integer combination of its
faces, the coefﬁcient of the face being (−1)i if the missing vertex for the face is
the ith of the n + 1 vertices of the given n-simplex. This deﬁnition is extended
additively to the boundary map ∂n−1 : Cn(S) →Cn−1(S), and a combinatorial
argument gives ∂n∂n−1 = 0 for all n. Thus X = {(Cn(S), ∂n−1)} is a complex.
The associated homology Hn(X) is the nth (integral simplicial) homology of the
simplicial complex S and is usually denoted by Hn(S).
(2) Cubical singular homology. Let S be a topological space. For n ≥0, a
singular n-cube in S is a continuous function T : I n →S, where I n denotes the
n-fold product of the closed interval [0, 1] with itself. The free abelian group on
the set of n-cubes is denoted by Qn(S). A singular n-cube T is degenerate if
its values are independent of one of the n variables. The subgroup of Qn(S)
generated by the degenerate singular n-cubes is denoted by Dn(S), and the
quotient Cn(S) = Qn(S)/Dn(S) is the group of cubical singular n-chains.
One deﬁnes a boundary operator from Qn(S) to Qn−1(S) for each n in analogy
with the deﬁnition in the previous example and shows that it carries Dn(S) into
Dn−1(S). Consequently the boundary operator descends to a homomorphism of
abelian groups ∂n−1 : Cn(S) →Cn−1(S). A combinatorial argument shows that
∂n∂n−1 = 0; thus we get a complex. The associated homology is the nth (integral
singular) homology of S and is usually denoted by Hn(S).
(3) Free resolution of Z in CZG. Let G be a group. Then the standard resolution
of Z in the category CZG, as given in Theorem 3.20, is a chain complex in that
category.
LetusmaketheclassofchaincomplexesforthegoodcategoryCintoacategory.
Each chain complex is to be an object. If X = {(Xn, ∂n}) and X′ = {(X′
n, ∂′
n)}

2. Complexes and Additive Functors
173
are two chain complexes in C, a morphism in Morph(X, X′) is any chain map
f = { fn}, deﬁned as a sequence of maps fn ∈HomR(Xn, X′
n) such that the
diagram
Xn
∂n−1
−−−→Xn−1
fn
⏐⏐+
⏐⏐+ fn−1
X′
n
∂′
n−1
−−−→X′
n−1
commutes for all n.
Brieﬂy f ∂= ∂′ f .
Since the fn’s are functions, it is
customary to use function notation f : X →X′ for chain maps. The system {1Xn}
of identity maps serves as an identity morphism, and coordinate-by-coordinate
composition is associative. Thus the result is a category.
The next step is to observe that homology H∗, as applied to chain maps for
the category C, is a covariant functor from the category of chain maps to itself.
The effect of the functor on objects is to send X to H∗(X) = {(Hn(X), 0)}. If
f : X →X′ is a chain map, then the formula ∂′
n−1( fn(xn)) = fn−1(∂n−1(xn))
shows that
fn(ker ∂n−1)
⊆
ker ∂′
n−1, and the formula ∂′
n( fn+1(xn+1))
=
fn(∂n(xn+1)) shows that fn(image ∂n) ⊆image ∂′
n.
Therefore fn descends
to the quotient, giving a map H( fn) : Hn(X) →Hn(X′).
The assembled
collection of maps H∗( f ) : H∗(X) →H∗(X′) is manifestly a chain map. Instead
of writing H( fn) for the map induced by fn on the nth homology, we shall often
write ( fn)∗or ¯fn, especially in diagrams, to make the notation less cumbersome.
Since the identity chain map yields the identity on H∗(X) and since compositions
go to compositions in the same order, homology H∗is a covariant functor.
If f : X →X′ and g : X →X′ are two chain maps, then a homotopy h
of f to g is a system of maps h = {hn} increasing degrees by 1, i.e., having
hn carry Xn into X′
n+1, such that hn−1∂n−1 + ∂′
nhn = fn −gn for all n. Brieﬂy
h∂+ ∂′h = f −g. When such an h exists, we say that f and g are homotopic,
and we write f ≃g. This relation is an equivalence relation.
Proposition 4.1. If f : X →X′ and g : X →X′ are homotopic chain maps
in the good category C, then f and g induce the same maps H∗( f ) and H∗(g)
on homology, i.e., Hn( f ) and Hn(g) are the same map of Hn(X) into Hn(X′) for
each n.
PROOF. Let h be a homotopy, and suppose that ∂n−1(xn) = 0. Then the
computation fn(xn)−gn(xn) = hn−1∂n−1(xn)+∂′
nhn(xn) = 0+∂′
nhn(xn) shows
that the images of xn under fn and gn in X′
n differ by a member of image ∂′
n. □
Brieﬂy let us translate all of these deﬁnitions and conclusions into statements
when the complexes have increasing indices.
A cochain complex in C is a

174
IV. Homological Algebra
sequence of pairs X = {(Xn, dn)}∞
n=−∞in which each Xn is a module in C,
each dn is a map in HomR(Xn, Xn+1), and dn+1dn = 0 for all n. The maps dn
are sometimes called coboundary maps, or coboundary operators. We deﬁne
the cohomology of X, written H ∗(X) = {H n(X)}∞
n=−∞with superscripts, to
be the sequence of modules in C given by H n(X) = (ker dn)/(image dn−1). The
members of the space ker dn are calledn-cocycles, and the members of image dn−1
are called n-coboundaries.
EXAMPLES OF COCHAIN COMPLEXES.
(1) Singular cohomology. Let S be a topological space, let X ={(Cn(S), ∂n−1)}
be its complex of cubical singular n-chains, and let M be any abelian group. If
Cn(S, M) = HomZ(Cn(S), M) and if dn : Cn(S, M) →Cn+1(S, M) is the
map dn = Hom(∂n+1, 1), then Y = {(Cn(S, M)), dn)} is a cochain complex,
and its cohomology, written H ∗(Y) = {H n(S, M)}, is the (integral singular)
cohomology of S with coefﬁcients in M.
(2) Cohomology of groups. Let G be a group, and let M be an abelian group
on which G acts by automorphisms. Let Cn(G, M) be the abelian group of
functions from the n-fold product of G with itself into M, the functions being
added pointwise. Deﬁne δn : Cn(G, M) →Cn+1(G, M) as in Section III.5.
Then X = {(Cn(G, M), δn)} is a cochain complex, and its cohomology H ∗(X) =
{H n(G, M)} is the cohomology of G with coefﬁcients in M.
The cochain complexes for the good category C form a category for which the
morphisms from X = {(Xn, dn)} to X′ = {(X′
n, d′
n)} are cochain maps f = { fn};
the latter are deﬁned by the conditions that fn carry Xn to X′
n and f d = d f , i.e.,
fn+1dn = dn fn for all n. Cohomology H ∗, as applied to cochain maps for the
category C, is a covariant functor from the category of cochain maps to itself.
The effect of the functor on objects is to send X to H ∗(X) = {(H n(X), 0)}, and
the argument that a cochain map f : X →X′ carries H ∗(X) to H ∗(X′) via a
cochain map H ∗( f ) is the same as for chain maps. Instead of writing H( fn) for
the map induced by fn on the nth cohomology, we shall often write ( fn)∗or ¯fn,
especially in diagrams, to make the notation less cumbersome.3
If f : X →X′ and g : X →X′ are two cochain maps, then a homotopy
h of f to g is a system of maps h = {hn} decreasing degrees by 1, i.e., having
hn carry Xn into X′
n−1, such that hn+1dn + d′
n−1hn = fn −gn for all n. Brieﬂy
hd + d′h = f −g. When such an h exists, we say that f and g are homotopic,
and we write f ≃g. This relation is an equivalence relation.
3The notation with the bar is to be avoided when there might be some ambiguity about which of
homology and cohomology is involved.

2. Complexes and Additive Functors
175
Proposition 4.1′. If f : X →X′ and g : X →X′ are homotopic cochain
maps in the good category C, then f and g induce the same maps H ∗( f ) and
H ∗(g) on cohomology, i.e., H n( f ) and H n(g) are the same map of H n(X) into
H n(X′) for each n.
PROOF. Let h be a homotopy, and suppose that dn(xn) = 0. Then the com-
putation fn(xn) −gn(xn) = hn+1dn(xn) + d′
n−1hn(xn) = 0 + d′
n−1hn(xn) shows
that the images of xn under fn and gn in X′
n differ by a member of image d′
n−1.
□
A chain or cochain complex written neutrally as X = {X(n)} is exact at X(n)
if the kernel of the outgoing map at X(n) equals the image of the incoming map
at X(n) (as opposed to merely containing the image). The complex is exact, or
is an exact sequence, if it is exact at every X(n). A short exact sequence is an
exact sequence of the form
0 −→A
ϕ
−→B
ψ
−→C −→0,
understood to have 0’s at all positions beyond each end. The conditions on the
5-term complex above for it to be exact are that ϕ be one-one, ψ be onto C, and
that ψ exhibit C as isomorphic to B/ image ϕ. To make the terminology more
symmetric, it is customary to introduce a name for the quotient of the range of a
homomorphism η by the image of η; this quotient is deﬁned to be the cokernel
of the homomorphism and is denoted by coker η. The conditions for exactness
above can then be restated more symmetrically as
ker ϕ = coker ψ = 0
and
image ϕ = ker ψ.
An exact sequence can always be broken into short exact sequences by stretch-
ing each link
· · · −→A
ϕ
−→B
ψ
−→· · ·
into
· · · −→A
ϕ
−→image ϕ −→0 −→0 −→ker ψ
inc
−→B
ψ
−→· · ·
and breaking it between the 0’s; here “inc” denotes the inclusion mapping of
ker ψ into B. This stretching process does not take us outside our good category,
since good categories are assumed to be closed under passage to submodules and
quotients. Conversely if we have two exact sequences
· · · −→A
ϕ
−→C −→0
and
0 −→C
i
−→B
ψ
−→· · · ,

176
IV. Homological Algebra
then we can combine them into an exact sequence
· · · −→A
iϕ
−→B
ψ
−→· · · .
Exactness at A of the merged sequence follows because ker(iϕ) = ker ϕ, and
exactness at B follows because ker ψ = image i = image(iϕ).
Any map ϕ : A →B in our good category can be expressed in terms of an
exact sequence by including the kernel and cokernel:
0 −→ker ϕ
i−→A
ϕ
−→B
q
−→coker ϕ −→0;
here i : ker ϕ →A is the inclusion, and q : B →coker ϕ is the quotient mapping.
All the modules and maps in the exact sequence are in the category, since good
categories are assumed to be closed under passage to submodules and quotients.
We shall use the following special case of this observation in Section 3.
Proposition 4.2. Let X = {(Xn, ∂n)}∞
n=−∞be a chain complex in a good
category with ∂n in HomR(Xn+1, Xn) for each n. Then the boundary operator
∂n−1 on Xn descends to the quotient as a mapping ¯∂n−1 : coker ∂n →ker ∂n−2
and yields an exact sequence
0 −→Hn(X)
i
−→coker ∂n
¯∂n−1
−−→ker ∂n−2
q
−→Hn−1(X) −→0.
Here i is the inclusion i : ker ∂n−1/ image ∂n →Xn/ image ∂n, and q is the quo-
tient q : ker ∂n−2 →ker ∂n−2/ image ∂n−1. This association of a six-term exact
sequence to X for each n is functorial in the sense that if X′ = {(X′
n, ∂′
n)}∞
n=−∞is
a second chain complex and if f : X →X′ is a chain complex, then the diagram
Hn(X)
i
−−−→coker ∂n
¯∂n−1
−−−→ker ∂n−2
q
−−−→Hn−1(X)
⏐⏐+
⏐⏐+
⏐⏐+
⏐⏐+
Hn(X′)
i′
−−−→coker ∂′
n
¯∂′
n−1
−−−→ker ∂′
n−2
q′
−−−→Hn−1(X′)
commutes; here the vertical maps are those induced by fn−1 and fn.
REMARKS.
(1) The term “functorial” in the statement has a precise meaning in this and
other contexts. Each chain complex is being carried to a 6-term exact sequence
for each n. The chain complexes and the 6-term exact sequences both form
categories, the morphisms in each case being chain maps. To say that the passage

2. Complexes and Additive Functors
177
from the objects of one category to the other is functorial is to say that the
passage between the categories is actually a functor, i.e., chain maps for the chain
complexes are sent to chain maps for the 6-term exact sequences, the identity goes
to the identity, and compositions go to compositions. The latter two conditions
are evident, and what needs proof is that chain maps are carried to chain maps.4
(2) For a cochain complex X = {(Xn, dn)}∞
n=−∞with dn in HomR(Xn, Xn+1),
the corresponding exact sequence is
0 −→Hn−1(X)
i
−→coker dn−2
¯dn−1
−−→ker dn
q
−→Hn(X) −→0,
and it is functorial with respect to cochain maps.
PROOF. To see that the map ¯∂n−1 carries coker ∂n to ker ∂n−2, we write it as a
composition
coker ∂n = Xn/ image ∂n →Xn/ ker ∂n−1 ∼= image ∂n−1 ⊆ker ∂n−2,
with the arrow induced by the inclusion image ∂n ⊆ker ∂n−1 and with the iso-
morphism induced by applying ∂n−1 to Xn and passing to the quotient. Then we
have ker ¯∂n−1 = ker ∂n−1/ image ∂n = Hn(X) and
coker ¯∂n−1 = ker ∂n−2
¯∂n−1(Xn/ image ∂n) = ker ∂n−2

∂n−1Xn
= ker ∂n−2/ image ∂n−1 = Hn−1(X),
and the exactness of the sequence is a special case of the exactness noted in the
paragraph before the proposition.
For the assertion that the association is functorial, the left square commutes
because the verticals are both induced by the same map fn, and the right square
commutes because the verticals are both induced by the same map fn−1. For the
middle square the commutativity follows from the fact that fn−1∂n−1 = ∂′
n−1 fn.
□
4Some authors use the word “natural” instead of the word “functorial” in this situation. Authors
who do this may have the notion of “natural transformation” between two functors in mind, or they
may not. For those who do not, it seems advisable to use a different term like “functorial” to avoid
confusion. For those who do, the allusion to a natural transformation is at best tortured in this
instance. A natural transformation refers to two categories C and C′, and the most intuitive choice
for C here is the category of chain complexes X. There are to be two functors from C to C′ and the
natural transformation relates the values of those functors on X, for each X; no second complex X′
enters into matters. To have X′ involved in a natural transformation would mean including at least
two chain complexes in each object of C. In other instances, however, some additional structure
may be present. Then the distinction between “functorial” and “natural” may be one of emphasis
concerning the data. The statements of Propositions 4.29 and 4.30 below provide examples.

178
IV. Homological Algebra
As was mentioned in Section 1, our interest will be in functors F : C →C ′
between two good categories, not necessarily involving the same ring, with the
property of being additive. This means that F(ϕ1 + ϕ2) = F(ϕ1) + F(ϕ2) when
ϕ1 and ϕ2 are in the same HomR(A, B).
An additive functor sends any 0 map to the corresponding 0 map. Consequently
it always sends complexes to complexes. Moreover, since any functor carries the
identity map of each HomR(A, A) to an identity map, an additive functor has to
send any module A for which the 0 map and the identity coincide to another such
module. The 0 module is the unique module A with this property, and thus an
additive functor has to send the 0 module to a 0 module.
Moreover, additive functors carry ﬁnite direct sums to ﬁnite direct sums. (Re-
call that good categories are closed under ﬁnite direct sums.) This fact needs
proper formulation, and we need ﬁrst to express direct sums in terms of modules
and maps. From the point of view of category theory, we shall take advantage
of the fact that for left R modules, product and coproduct coincide and are given
by direct sum. If C ∼= A ⊕B, then there are thus projections pA : C →A and
pB : C →B and injections ιA : A →C and ιB : B →C such that
pAιA = 1A
and
pBιB = 1B,
pBιA = 0
and
pAιB = 0,
and
ιA pA + ιB pB = 1C.
Conversely if we have maps pA, ιA, pB, and ιB with these properties, then the
modules A = image pA and B = image pB have the property thatC is the internal
direct sum C = ιA A ⊕ιB B, and ιA and ιB are one-one. In fact, the equation
ιA pA + ιB pB = 1C shows that ιA A + ιB B = C. To see that ιA A ∩ιB B = 0,
let x be in the intersection. Then pBx lies in pBιA A, which is 0, and pAx lies in
pAιB B, which is 0. Thus ιA pA + ιB pB = 1C gives 0 = ιA pAx + ιB pBx = x.
Hence ιA A ∩ιB B = 0 and C = ιA A ⊕ιB B. Finally the equations pAιA = 1A
and pBιB = 1B imply that ιA and ιB are one-one.
With direct sum now expressed in terms of modules and maps, let us return to
the effect of additive functors on direct sums. Let C ∼= A⊕B, and let pA, pB, ιA,
and ιB be as above. Suppose that the additive functor F is covariant. Applying F
to the displayed identities in the previous paragraph and using that F is additive,
we see that F(pA), F(pB), F(ιA), and F(ιB) have the properties that allow us to
recognize a direct sum. Hence
F(C) = F(ιA)F(A) ⊕F(ιB)F(B)
with F(ιA) and F(ιB) one-one. Thus
F(C) ∼= F(A) ⊕F(B).

2. Complexes and Additive Functors
179
If instead F is contravariant, then the roles of the projections and the injections
get interchanged, but we still obtain F(C) ∼= F(A) ⊕F(B).
An additive functor F : C →C ′ between two good categories is exact if it
transforms exact sequences into exact sequences. Proposition 4.3 below will show
that exact covariant functors preserve kernels, images, cokernels, submodules,
quotients, and more. However, exact functors occur only infrequently; we shall
see a few examples of them in Section 4. For examples of failures at exactness,
it was shown in Section X.6 of Basic Algebra that if
0 −→M
ϕ
−→N
ψ
−→P −→0
is a short exact sequence in the category CR, if E is a unital left R module, and if
E′ is a unital right R module, then the following sequences in CZ are exact:
E′ ⊗R M
1⊗ϕ
−−−→E′ ⊗R N
1⊗ψ
−−−→E′ ⊗R P −−−→0,
0 −−−→HomR(E, M)
Hom(1,ϕ)
−−−−−→HomR(E, N)
Hom(1,ψ)
−−−−−→HomR(E, P),
HomR(M, E)
Hom(ϕ,1)
←−−−−−HomR(N, E)
Hom(ψ,1)
←−−−−−HomR(P, E) ←−−−0;
on the other hand, the extensions of these complexes to 5-term complexes by the
adjoining of a 0 need not be exact, and thus the functors E′ ⊗R ( · ), HomR(E, · ),
and HomR( · , E) are not exact for suitable choices of R, E, and E′.
Proposition 4.3. An additive functor F : C →C ′ between two good categories
is exact if and only if it carries all short exact sequences into short exact sequences.
REMARK. This proposition makes it a little easier to test concrete additive
functors for exactness than it would be from the deﬁnition.
PROOF. Necessity is obvious. For sufﬁciency, let
A
ϕ
−→B
ψ
−→C
be exact, and let the additive functor F be covariant, the contravariant case being
completely analogous. Put A1 = ker ϕ, B1 = ker ψ, and C1 = image ψ. Since
ψϕ = 0, we can factor ϕ as ϕ = ϕ2ϕ1, where ϕ1 : A →B1 is ϕ with its range
space reduced and where ϕ2 : B1 →B is the inclusion. Similarly we can factor
ψ as ψ = ψ2ψ1, where ψ1 : B →C1 is ψ with its range space reduced and
where ψ2 : C1 →C is the inclusion. Of the sequences
0 −→A1 −−→A
ϕ1
−−→B1 −→0,
0 −−→B1
ϕ2
−→B
ψ1
−−→C1 −→0,
0 −−→C1
ψ2
−→C −→C/C1 −→0,

180
IV. Homological Algebra
the ﬁrst and the third are trivially exact, and the second is exact because kerψ1 =
ker ψ = image ϕ = image ϕ2. The hypothesis that F carries short exact se-
quences to short exact sequences thus implies that the three sequences
F(A)
F(ϕ1)
−−−→F(B1) −−−→0,
F(B1)
F(ϕ2)
−−−→F(B)
F(ψ1)
−−−→F(C1),
0 −−−→F(C1)
F(ψ2)
−−−→F(C)
are exact. From these, ker F(ψ1) = image F(ϕ2). Also, F(ψ2) is one-one, so
that
ker F(ψ1) = ker

F(ψ2)F(ψ1)

= ker F(ψ),
and F(ϕ1) is onto, so that
image F(ϕ2) = image

F(ϕ2)F(ϕ1)

= image F(ϕ).
Hence ker F(ψ) = image F(ϕ), and
F(A)
F(ϕ)
−−−→F(B)
F(ψ)
−−−→F(C)
is exact, as required.
□
Proposition 4.4.
Let F : C →C ′ be an additive functor between good
categories, let X be a complex in C, and let F(X) be the corresponding complex
in C ′. If F is exact, then F carries the homology or cohomology of X to the
homology or cohomology of F(X).
REMARKS. Our convention is to refer to homology when the indexing goes
down and cohomology when the indexing goes up. If F is covariant, it preserves
the indexing, while if F is contravariant, it reverses it. For the proof we shall use
notation A, B, C for modules that is neutral with respect to the indexing. The
arguments are qualitatively different in the covariant and contravariant cases, and
we shall give both of them.
PROOF IN THE COVARIANT CASE. Let
A
ϕ
−→B
ψ
−→C
be a given complex, thus having ψϕ = 0, and form the image complex
F(A)
F(ϕ)
−−−→F(B)
F(ψ)
−−−→F(C).

2. Complexes and Additive Functors
181
We are to exhibit an isomorphism
F(ker ψ/ image ϕ) ∼= ker F(ψ)/ image F(ϕ).
(∗)
Let i : image ϕ →ker ψ and j : ker ψ →B be the inclusions, and let
q : ker ψ →ker ψ/ image ϕ be the quotient map. Applying F to the exact
sequence
0 −→image ϕ
i
−−→ker ψ
q
−−→ker ψ/ image ϕ −→0
and using exactness, we obtain an isomorphism via F(q):
F(ker ψ/ image ϕ) ∼= F(ker ψ)

F(i)F(image ϕ).
(∗∗)
Since j is one-one and F is exact, F( j) is one-one. Thus application of F( j) to
the right side of (∗∗) gives
F(ker ψ/ image ϕ) ∼= F( j)F(ker ψ)

F( ji)F(image ϕ).
(†)
If ϕ denotes ϕ with its range reduced to its image, then ϕ = jiϕ. Applying F to
the two exact sequences
ker ψ
j−→B
ψ
−→C,
A
ϕ
−→image ϕ −→0
gives us F( j)F(ker ψ) = ker F(ψ) and F(image ϕ) = F(ϕ)F(A). Applying
F( ji) to the second of these and substituting both into the right side of (†)
transforms (†) into (∗) and gives the required isomorphism.
□
PROOF IN THE CONTRAVARIANT CASE. Let
A
ϕ
−→B
ψ
−→C
be given with ψϕ = 0, and form the image complex
F(A)
F(ϕ)
←−−−F(B)
F(ψ)
←−−−F(C).
We are to exhibit an isomorphism
F(ker ψ/ image ϕ) ∼= ker F(ϕ)/ image F(ψ).
(∗)
Let j : ker ψ →B be the inclusion, let ¯j : ker ψ/ image ϕ →B/ image ψ be
the induced map between quotients, and let q, q′, q′′ be the quotient maps
q : B →B/ ker ψ,
q′ : B →B/ image ϕ,
q′′ : B/ image ϕ →B/ ker ψ.

182
IV. Homological Algebra
These satisfy q = q′′q′. Applying F to the exact sequence
0 −→ker ψ/ image ϕ
¯j
−−→B/ image ϕ
q′′
−−→B/ ker ψ −→0
and using exactness, we obtain an isomorphism via F( ¯j):
F(ker ψ/ image ϕ) ∼= F(B/ image ϕ)

F(q′′)F(B/ ker ψ).
(∗∗)
Since q′ is onto and F is exact, F(q′) is one-one. Thus application of F(q′) to
the right side of (∗∗) gives
F(ker ψ/ image ϕ) ∼= F(q′)F(B/ image ϕ)

F(q)F(B/ ker ψ).
(†)
Applying F to the three exact sequences
A
ϕ
−→B
q′
−→B/ image ϕ,
ker ψ
j−→B
ψ
−→C,
ker ψ
j−→B
q
−→B/ ker ψ
gives us F(q′)F(B/ image ϕ) = ker F(ϕ) and F(q)F(B/ ker ψ) = ker F( j) =
image F(ψ). Substituting both these equalities into the right side of (†) trans-
forms (†) into (∗) and gives the required isomorphism.
□
We were reminded before Proposition 4.3 that HomR and ⊗R need not yield
exact functors. The partial exactness that they exhibit, as opposed to exactness
itself, is more typical of additive functors, and we incorporate this behavior into
two deﬁnitions. We shall deﬁne left and right exactness in such a way that HomR
is left exact in each variable and ⊗R is right exact. An additive functor F is left
exact if the exactness of
0 −→A
ϕ
−→B
ψ
−→C −→0
implies the exactness of
0 −→F(A)
F(ϕ)
−−−→F(B)
F(ψ)
−−−→F(C)
(F covariant),
0 −→F(C)
F(ψ)
−−−→F(B)
F(ϕ)
−−−→F(A)
(F contravariant).

2. Complexes and Additive Functors
183
We say that F is right exact if the exactness of the sequence with 0, A, B, C, 0
above implies the exactness of
F(A)
F(ϕ)
−−−→F(B)
F(ψ)
−−−→F(C) −→0
(F covariant),
F(C)
F(ψ)
−−−→F(B)
F(ϕ)
−−−→F(A) −→0
(F contravariant).
The words “left” and “right” refer to the part of the target sequence that is exact
when the arrows are arranged to point to the right. A consequence (but not the
full content) of these deﬁnitions in each case is an assertion about one-one or
onto maps. For example a left exact covariant F carries one-one maps to one-
one maps; we have only to start from a one-one map ϕ : A →B and set up a
short exact sequence with C = B/ image ϕ, and the deﬁnition shows that F(ϕ)
is one-one.
Proposition 4.5. If F is a covariant left exact functor, then F carries an exact
sequence
0 −→A
ϕ
−→B
ψ
−→C
into an exact sequence
0 −→F(A)
F(ϕ)
−−−→F(B)
F(ψ)
−−−→F(C).
REMARK. The expected analogs of this result are valid if F is contravariant or
if F is right exact or both.
PROOF. Starting from the given exact sequence, let i : image ψ →C be the
inclusion, and let ψ : B →image ψ be ψ with its range space reduced. Then
ψ = iψ, and the sequences
0 −−→A
ϕ
−−→B
ψ
−−→image ψ −−→0
0 −−→image ψ
i
−−→C −−→C/ image ψ −−→0
and
are exact. Applying F and using its left exactness, we see that
0 −−→F(A)
F(ϕ)
−−−→F(B)
F(ψ)
−−−→F(image ψ)
0 −−→F(image ψ)
F(i)
−−→F(C)
and
are exact. Thus F(i) is one-one, and F(ψ) = F(iψ) = F(i)F(ψ) has the
same kernel as F(ψ).
The exactness of the ﬁrst image complex shows that
ker F(ψ) = image F(ϕ), and the proof of the required exactness is complete. □

184
IV. Homological Algebra
3. Long Exact Sequences
As in Section 2, let C be a good category. We have seen that chain complexes
in C themselves form a category whose morphisms are chain maps. If we have
several chain maps in succession, each with an index n ∈Z, we can say that
they form an “exact sequence” of chain maps if for each n, the sequences of
modules and maps having index n form an exact sequence in C. Our objective
in this section is to show that any short exact sequence of complexes of this kind
yields a “long exact sequence” of modules and maps in C involving all the indices.
More precisely we are able to construct for each n a “connecting homomorphism”
relating5 what happens with each index n to what happens for index n+1 or n −1
and incorporating modules and maps for all indices into a single exact sequence
of inﬁnite length.
By way of preparation for the construction of connecting homomorphisms, let
us be more explicit about the discussion in Section 2 of how a chain map carries
the homology of one complex to the homology of another complex. Let
A
ϕ
−−−→B
⏐⏐+α
⏐⏐+β
A′
ϕ′
−−−→B′
be a commutative diagram in the good category C. Let us observe that ϕ(ker α) ⊆
ker β; in fact, any a ∈ker α has 0 = ϕ′α(a) = βϕ(a), and thus ϕ(a) is in ker β.
Let us observe further that ϕ′(α(A)) = β(ϕ(A)) ⊆β(B); since ϕ′ carries A′ into
B′, it follows that ϕ′ descends to a mapping ϕ′ deﬁned on A′/α(A) = coker α
and taking values in B′/β(B) = coker β. We can summarize these remarks by
the inclusions
ϕ(ker α) ⊆ker β
and
ϕ′(coker α) ⊆coker β.
Using these remarks, we can now construct a “connecting homomorphism” when-
ever we have a diagram as in Figure 4.1 below.
5For readers familiar with the use of homology in topology, connecting homomorphisms arise
when one works with the homology of a topological space, the homology of a subspace, and the
relative homology of the space and the subspace; the construction in this section may be regarded
as an abstract version of that construction.

3. Long Exact Sequences
185
A
ϕ
−−−→B
ψ
−−−→C −−−→0
⏐⏐α
⏐⏐β
⏐⏐γ
0 −−−→A′
ϕ′
−−−→B′
ψ′
−−−→C′
FIGURE 4.1. Snake diagram. The rows are assumed exact, and the squares
commute. In this situation the Snake Lemma constructs
a connecting homomorphism ω : ker γ →coker α.
Lemma 4.6 (Snake Lemma). In a good category C, a snake diagram as in
Figure 4.1 induces a homomorphism ω : ker γ →coker α with
ker ω = ψ(ker β)
and
image ω = ϕ′−1(image β)/ image α,
and with ω(c) = ϕ′−1(β(ψ−1(c))) + image α for c ∈ker γ , and then
ker α
ϕ
−→ker β
ψ
−→ker γ
ω
−→coker α
ϕ′
−→coker β
ψ
′
−→coker γ
is an exact sequence. Here ϕ and ψ are restrictions of ϕ and ψ, and ϕ′ and ψ
′
are descended versions of ϕ and ψ. If ϕ is one-one, then ϕ is one-one. If ψ′ is
onto C′, then ψ
′ is onto coker γ .
REMARKS. The homomorphism ω is called a connecting homomorphism.
The name “Snake Lemma” comes from the pattern that the six-term exact se-
quence makes when superimposed on the enlarged version of Figure 4.1 shown
in Figure 4.2.
ker α
−−−→
ker β
−−−→
ker γ
⏐⏐
⏐⏐
⏐⏐
A
−−−→
B
−−−→
C
−−−→0
⏐⏐
⏐⏐
⏐⏐
0 −−−→
A′
−−−→
B′
−−−→
C′
⏐⏐
⏐⏐
⏐⏐
coker α −−−→coker β −−−→coker γ
FIGURE 4.2. Enlarged snake diagram.

186
IV. Homological Algebra
PROOF. First let us construct ω and see that it is well deﬁned. Let c be in
ker γ . Since ψ is onto C, write c = ψ(b) for some b ∈B. The commutativity of
the second square in Figure 4.1 gives 0 = γ (c) = γ ψ(b) = ψ′(βb). Thus β(b)
is in ker ψ′ = image ϕ′, and β(b) = ϕ′(a′) for some a′ ∈A′; the element a′ is
uniquely determined, since ϕ′ is one-one. Deﬁne ω(c) = a′ + α(A).
The only choice in this deﬁnition is that of b, and we are to show that any
other choice leads to the same member of cokerα. If ¯b is another choice and if
β(¯b) = ϕ′(¯a′) with a′ ∈A′, then ψ(¯b −b) = c −c = 0 shows that ¯b −b = ϕ(a)
for some a ∈A. Thus ϕ′(¯a′ −a′) = β(¯b −b) = βϕ(a) = ϕ′(α(a)). Since ϕ′ is
one-one, ¯a′ −a′ = α(a), and ¯a′ and a′ are exhibited as in the same coset of A′
modulo α(A).
Let us compute ker ω. Suppose that ω(c) = 0, i.e., that ω(c) is in α(A).
Say ω(c) = α(a). By construction of ω, ω(c) = a′ + α(A) for an element
a′ ∈A′ such that β(b) = ϕ′(a′) and c = ψ(b).
In this case, a′ = α(a).
So β(b) = ϕ′α(a) = βϕ(a), and thus b −ϕ(a) is in ker β.
Consequently
c = ψ(b) = ψ(b) −ψϕ(a) is in ψ(ker β), and ker ω ⊆ψ(ker β). For the
reverse inclusion, if c is in ψ(ker β), choose b ∈ker β with ψ(b) = c. Then
γ (c) = γ ψ(b) = ψ′β(b) = 0 shows that ω(c) is deﬁned. Since c = ψ(b), the
construction of ω shows that β(b) = ϕ′(a′) for some a′ ∈A′. Since b is in ker β
and since ϕ′ is one-one, this a′ must be 0. Then ω(c) = a′ + α(A) = 0 + α(A),
c is in ker ω, and ψ(ker β) ⊆ker ω.
Now we compute image ω.
Our step-by-step deﬁnition of ω shows that
image ω ⊆ϕ′−1(image β)/α(A). For the reverse inclusion, suppose that a′ ∈A′
is in ϕ′−1(image β), i.e., has ϕ′(a′) = β(b) for some b ∈B. Then the element
c = ϕ(b) of C has γ (c) = γ ψ(b) = ψ′β(b) = ψ′ϕ′(a′) = 0, and ω(c)
is therefore deﬁned. Our deﬁnition of ω makes ω(c) = a′ + α(A), and thus
ϕ′−1(image β)/α(A) ⊆image ω.
We are left with establishing the exactness of the displayed sequence of six
terms at the four positions other than the ends and with proving the two assertions
in the last sentence of the lemma.
The condition of exactness at ker β is that ϕ(ker α) = ker ψ ∩ker β. The
inclusion⊆followsfromtheequalities0 = ψϕ andβϕ(ker α) = ϕ′α(ker α) = 0.
For the inclusion ⊇, let b ∈B satisfy ψ(b) = β(b) = 0. Exactness at B gives
b = ϕ(a) with a ∈A. Then 0 = β(b) = βϕ(a) = ϕ′α(a) with ϕ′ one-one
implies that α(a) = 0, and a is in ker α. Thus b is in ϕ(ker α), and exactness at
ker β is proved. If ϕ is one-one, then certainly its restriction ϕ is one-one.
The condition of exactness at ker γ is that ker ω = ψ(ker β), and this was
proved in the third paragraph of the proof.
By the result of the fourth paragraph, the condition of exactness at cokerα
is that ϕ′−1(β(B))/α(A) equal ker ϕ′, where ϕ′ : A′/α(A) →B′/β(B) is the
map induced by ϕ′. The members of ker ϕ′ are those cosets a′ + α(A) with

3. Long Exact Sequences
187
ϕ′(a′ + α(A)) ⊆β(B). Since ϕ′α(A) = βϕ(A) ⊆β(B), the condition on
a′ + α(A) is that ϕ′(a′) be in β(B), hence that a′ be in ϕ′−1(β(B)), hence that
the coset a′ + α(A) be in ϕ′−1(β(B))/α(A). Thus we have exactness at coker α.
At coker β, we know that the descended map ϕ′ maps coker α into coker β, and
we are to show that ϕ′(coker α) = ker ψ
′. Inclusion ⊆follows because ψ′ϕ′ = 0
implies ψ
′ϕ′(a′ + α(A)) = ψ
′(ϕ′(a′) + β(B)) = ψ′ϕ′(a′) + γ (C) = γ (C). For
the reverse inclusion let b′ ∈B′ have ψ
′(b′ + β(B)) = γ (C). Then ψ′(b′) is in
γ (C). Since ψ : B →C is onto, we can ﬁnd b ∈B with ψ′(b′) = γ ψ(b) =
ψ′β(b). Hence b′−β(b) is in ker ψ′ = image ϕ′, and b′−β(b) = ϕ′(a′) for some
a′ ∈A′. Consequently b′ + β(B) = ϕ′(a′) + β(b) + β(B) = ϕ′(a′) + β(B) =
(ϕ′)∗(a′ + α(A)), and b′ + β(B) is exhibited as in (ϕ′)∗(a′ + α(A)), i.e., in
(ϕ′)∗(coker α). Thus we have exactness at coker β. Finally if ψ′ is onto C′, then
certainly its descended map ψ
′ is onto coker γ . This completes the proof.
□
Theorem 4.7. Let A = {(An, αn)}, B = {(Bn, βn)}, and C = {(Cn, γn)} be
chain complexes in a good category C, and suppose that ϕ = {ϕn} : A →B and
ψ = {ψn} : B →C are chain maps such that the sequence
0 −→A
ϕ
−→B
ψ
−→C −→0
of chain complexes is exact. Then this exact sequence of chain complexes induces
an exact sequence in homology of the form
· · ·−→Hn+1(C)
ωn
−→Hn(A)
ϕn
−−−→Hn(B)
ψn
−−−→Hn(C)
ωn−1
−−−→Hn−1(A)−→· · · .
Here the map ωn : Hn+1(C) →Hn(A) has descended from the connecting
homomorphism ωn deﬁned on ker γn in Cn+1 and having range coker αn =
An/ image αn.
REMARKS.
(1) The exact sequence in homology is called the long exact sequence in
homology corresponding to the short exact sequence of chain complexes, and the
maps ωn are called connecting homomorphisms. As the proof will show, these
connecting homomorphisms arise by two applications of the Snake Lemma, not
just one.
(2) In more detail the diagram of the short exact sequence of chain complexes
is of the form

188
IV. Homological Algebra
...
...
...
⏐+
⏐+
⏐+
0 −→An+1
ϕn+1
−−−→Bn+1
ψn+1
−−−→Cn+1 −→0
⏐⏐+αn
⏐⏐+βn
⏐⏐+γn
0 −→
An
ϕn
−−−→
Bn
ψn
−−−→
Cn
−→0
⏐⏐+αn−1
⏐⏐+βn−1
⏐⏐+γn−1
0 −→An−1
ϕn−1
−−−→Bn−1
ψn−1
−−−→Cn−1 −→0
⏐+
⏐+
⏐+
...
...
...
The rows are exact, the columns are chain complexes, and the squares commute.
(3) The corresponding result for cochain complexes involves the diagram
...
...
...
,⏐
,⏐
,⏐
0 −→An+1
ϕn+1
−−−→Bn+1
ψn+1
−−−→Cn+1 −→0
,⏐⏐αn
,⏐⏐βn
,⏐⏐γn
0 −→
An
ϕn
−−−→
Bn
ψn
−−−→
Cn
−→0
,⏐⏐αn−1
,⏐⏐βn−1
,⏐⏐γn−1
0 −→An−1
ϕn−1
−−−→Bn−1
ψn−1
−−−→Cn−1 −→0
,⏐
,⏐
,⏐
...
...
...
and the corresponding long exact sequence in cohomology is
· · ·−→H n−1(C)
ωn
−→H n(A)
ϕn
−−→H n(B)
ψn
−−→H n(C)
ωn+1
−−−→H n+1(A)−→· · · .
The result for cochain complexes is a consequence of the result for chain com-
plexes and follows by making adjustments in the notation.

3. Long Exact Sequences
189
PROOF. We regard the top two displayed rows of the diagram in Remark 2 as a
snake diagram. Applying the Snake Lemma (Lemma 4.6), we obtain a connecting
homomorphism ωn and an exact sequence
ker αn
ϕn+1
−−−→ker βn
ψn+1
−−−→ker γn
ωn
−→coker αn
ϕ′
n
−→coker βn
ψ
′
n
−→coker γn.
Using Proposition 4.2 for each of the chain complexes A = {(An, αn)}, B =
{(Bn, βn)}, and C = {(Cn, γn)}, we see that we obtain a diagram
0
0
0
⏐+
⏐+
⏐+
Hn(A)
Hn(B)
Hn(C)
⏐+
⏐+
⏐+
coker αn
ϕn
−−→
coker βn
ψn
−−→
coker γn −→0
⏐⏐+αn−1
⏐⏐+βn−1
⏐⏐+γ n−1
0 −→ker αn−2
ϕn−1
−−−→ker βn−2
ψn−1
−−−→ker γn−2
⏐+
⏐+
⏐+
Hn−1(A)
Hn−1(B)
Hn−1(C)
⏐+
⏐+
⏐+
0
0
0
in which the rows and columns are exact and the squares commute. The third
and fourth rows form a snake diagram, and the second and ﬁfth rows identify the
kernels and cokernels. Thus the Snake Lemma gives us an exact sequence
Hn(A)
ϕn
−→Hn(B)
ψn
−→Hn(C)

−→Hn−1(A)
ϕ′
n−1
−−−→Hn−1(B)
ψ
′
n−1
−−−→Hn−1(C)
for a suitable connecting homomorphism . Repeating this argument for all n
proves exactness at all modules of the long exact sequence.
To complete the proof, we have only to identify . Reference to the statement
of the Snake Lemma shows that the formula for  is
(¯c) = (ϕ′
n−1)−1(βn−1(ψ
−1
n (¯c))) + image αn−1
for ¯c ∈Hn(C). Meanwhile, the connecting homomorphism from the ﬁrst appli-
cation of the Snake Lemma is ωn−1(c) = (ϕ′
n−1)−1(βn−1(ψ−1
n (c)))+image αn−1
for c ∈ker γn−1. Thus (c + image γn) = ωn−1(c) + image αn−1 as asserted. □

190
IV. Homological Algebra
Corollary 4.8. If
0 −→A
ϕ
−→B
ψ
−→C −→0
is an exact sequence of chain complexes in a good category and if A is exact,
then Hn(B) ∼= Hn(C) for all n; if instead C is exact, then Hn(A) ∼= Hn(B) for
all n. Consequently if any two of the three chain complexes are exact, then the
third one is exact.
PROOF. Theorem 4.7 gives the long exact sequence
· · ·−→Hn+1(C)−→Hn(A)−→Hn(B)−→Hn(C)−→Hn−1(A)−→· · · .
If Hn(A) = 0and Hn−1(A) = 0, thenweseethat Hn(B) ∼= Hn(C). If Hn+1(C) =
0 and Hn(C) = 0, then we see that Hn(A) ∼= Hn(B).
If two of the three chain complexes are exact, then one of the two is A or C,
and the result in the previous paragraph applies. Then the other two complexes
(B and C, or A and B) have isomorphic homology. The hypothesis says that one
of these two sequences of homology groups is 0. Therefore the other one is 0. □
To conclude the discussion, we shall prove results saying that the exact se-
quences produced by Lemma 4.6 and Theorem 4.7 are functorial.
Lemma 4.9. In a good category C, the six-term exact sequence that is obtained
from a snake diagram as in Figure 4.1 is functorial in the following sense: If there
are two horizontal planar snake diagrams, one with tildes (∼) over all modules
and maps and the other as is, and if there are vertical maps f A, etc., in three
dimensions from the tilde version of the snake diagram to the original version
such that all vertical squares commute, then the squares of the diagram
kerα
ϕ
−→ker β
ψ
−→ker γ
ω
−→cokerα
ϕ′
−→coker β
ψ′
−→coker γ
⏐⏐+ ¯f A
⏐⏐+ ¯fB
⏐⏐+ ¯fC
⏐⏐+ ¯f A′
⏐⏐+ ¯fB′
⏐⏐+ ¯fC′
ker α
ϕ
−→ker β
ψ
−→ker γ
ω
−→coker α
ϕ′
−→coker β
ψ
′
−→coker γ
all commute.
PROOF. For the ﬁrst square from the left, the assumed commutativity shows
that f A′α = αf A, and thus x ∈kerα implies f A(x) ∈ker α; similarly x ∈ker β
implies fB(x) ∈ker β. Thus the maps of the square are well deﬁned. We are
given also that ϕf A = fBϕ, and this proves that the square commutes. The second
square from the left is handled similarly.

3. Long Exact Sequences
191
For the fourth square from the left, the equation f A′α = αf A shows that
y = α(x) implies f A′(y) = α( f A(x)), and thus y ∈imageα implies f A′(y) ∈
image α; thismeansthat f A′ descendstoamap ¯f A′ ofcokerα tocoker α. Similarly
fB′ descends to a map ¯fB′ of coker β to coker β. Thus the maps of the square
are well deﬁned. We are given also that ϕ′ f A′ = fB′ϕ′, and this proves that the
square commutes. The ﬁfth square from the left is handled similarly.
We are left with the third square from the left. The map at the left side of this
square was shown to be well deﬁned in the ﬁrst paragraph of the proof, and the
map at the right side of this square was shown to be meaningful in the second
paragraph of the proof. We are to prove that the square commutes. Referring to
the construction of ω, let c be in ker γ , choose b in B with 
ψ(b) = c, and write
β(b) = ϕ′(a′). Then ω(c) is deﬁned to be the coset of a′. Using the assumed
commutativity, we compute that ψ fB(b) = fC 
ψ(b) = fC(c) and that
ϕ′ f A′(a′) = fB′ϕ′(a′) = fB′β(b) = β fB(b).
Thus fB(b) is an element whose image under ψ is fC(c), and β of this element
is ϕ′ f A′(a′). Consequently the coset of ω( fC(c)) is to be the coset of f A′(a′) =
f A′ω(c). This proves the desired commutativity.
□
Theorem 4.10. In a good category C, the long exact sequence that is obtained
from a short exact sequence of chain complexes as in Theorem 4.7 is functorial
in the following sense: if there are two short exact sequences of chain complexes
as in the theorem, one with tildes (∼) over all modules and maps and the other
as is, each viewed as lying in a horizontal plane, and if there are vertical maps
f An, etc., from the tilde version of the exact sequence of chain complexes to the
original version such that all vertical squares commute, then the squares of the
diagram
−→Hn+1(
C)
ωn
−→Hn(A)
ϕn
−−→Hn(B)
ψn
−−→Hn(
C)
ωn−1
−−−→Hn−1(A) −→
⏐⏐+ fCn+1
⏐⏐+ f An
⏐⏐+ fBn
⏐⏐+ fCn
⏐⏐+ f An−1
−→Hn+1(C)
ωn
−→Hn(A)
ϕn
−−→Hn(B)
ψn
−−→Hn(C)
ωn−1
−−−→Hn−1(A) −→
all commute.
PROOF. Theorem 4.7 was proved by three applications of Proposition 4.2,
which includes its own assertion of functoriality, and two applications of Lemma
4.6, whose functoriality is addressed in Lemma 4.9. The argument involved only
manipulations with diagrams, and functoriality is in place for every step. Hence
functoriality is in place for the end result, and passage to the long exact sequence
is functorial.
□

192
IV. Homological Algebra
4. Projectives and Injectives
In Section III.5 we exploited the fact that certain complexes were exact and
involved free modules in order to obtain chain maps and homotopies.
The
hypothesis “free” entered the arguments through Propositions 3.25 and 3.27;
in both cases an R homomorphism was to be constructed from a free R module
to some other R module, and a computation revealed how the R homomorphism
should be deﬁned on free generators. The universal mapping property of free
modules allowed the R homomorphism to be extended from the generators to the
whole free module. Examination of those arguments shows that it is enough to
assume that the domain on which this R homomorphism is to be constructed is a
“projective” R module, in the sense to be deﬁned below, and we begin with that
notion.
Let C be a good category of unital left R modules. We say that a module P in
this category is projective in C or is a projective in C if whenever a diagram in
the category is given as in Figure 4.3 with ψ mapping onto B, then there exists
σ : P →C in C such that the diagram commutes.
P
⏐⏐+τ
0 ←−−−B
ψ
←−−−C
σ
FIGURE 4.3. Deﬁning property of a projective.
If P is a free R module in C, then P is projective in C. In fact, for each free
generator x of P, we choose an element cx in C with ψ(cx) = τ(x). Then we
deﬁne σ(x) = cx and extend σ to a homomorphism. We give further examples
of projectives shortly. First let us establish in Lemma 4.11 an ostensibly stronger
property that projectives automatically satisfy.
Lemma 4.11. If P is projective in the good category C and if the diagram
P
⏐⏐+τ
A′
ϕ
←−−−A
ψ
←−−−A′′
σ
in C has ker ϕ = image ψ and ϕτ = 0, then there exists a map σ : P →A′′ in C
such that the diagram commutes.
PROOF. The hypotheses force image τ ⊆ker ϕ = image ψ. Thus if we put
B = image ψ and C = A′′, then the above diagram leads to the diagram in Figure

4. Projectives and Injectives
193
4.3. The hypothesis “projective” therefore gives us the map σ in Figure 4.3 with
τ = ψσ, and the same σ is the required map here.
□
EXAMPLES OF PROJECTIVES.
(1) If R is a ﬁeld F and if C is the category of all vector spaces over F, then
every module is free, hence projective, since every vector space has a basis.
(2) For general R, if C = CR is the category of all unital left R modules,
then the projectives are the direct summands of free modules. This fact is easily
veriﬁed from Figure 4.3 as follows: In one direction if F = P ⊕P′ is a free
R module and the diagram in Figure 4.3 is given, extend τ to F as 0 on P′,
ﬁnd σ from the fact that the free module F is projective, and restrict σ to P.
In the other direction if P is projective, ﬁnd a free R module F mapping onto
P by a map ψ, and put B = P, C = F, and τ = 1 in Figure 4.3. Then the
equality 1P = τ = ψσ forces σ to be one-one, and it follows that P ∼= image σ.
Consequently F = image σ ⊕ker ψ.
(3) For R = Z, the category C = CZ of all unital R modules is the category
of all abelian groups. Then the projective modules are the free abelian groups by
(2), since any subgroup of a free abelian group is free abelian.
(4) For R equal to any (commutative) principal ideal domain, the projective
modules in the category CR of all unital R modules are the free modules, by
the same argument as in (3) in combination with the Fundamental Theorem of
Finitely Generated Modules (Theorem 8.25 of Basic Algebra).
(5) For R = Z, two good categories that were listed in Section 2 were the
category of all ﬁnitely generated abelian groups and the category of all torsion
abelian groups. With the ﬁrst of these, the projectives are the free abelian groups
of ﬁnite rank, by the same argument as in (3). With the second of these, Problem 1
at the end of the chapter asks for a veriﬁcation that some module in the category
fails to be the image of any projective in the category.
Wecometothemainresultconcerningﬂexibilityinsettingupchaincomplexes.
This result generalizes Proposition 3.25 through Corollary 3.30 in Section III.5.
Theorem 4.12. Let X = {(Xn, ∂n)}∞
n=−∞and X′ = {(X′
n, ∂′
n)}∞
n=−∞be chain
complexes in the good category C, and let r be an integer. Let { fn : Xn →X′
n}n≤r
beafamilyofmapsinCsuchthat∂′
n−1 fn = fn−1∂n−1 forn ≤r. If Xn isprojective
for n > r and X′ is exact at each X′
n with n ≥r, then { fn : Xn →X′
n}n≤r extends
to a chain map f : X →X′, and f is unique up to homotopy. More precisely
any two extensions are homotopic by a homotopy h such that hn = 0 for n ≤r.
REMARKS. The diagrams in question are

194
IV. Homological Algebra
· · ·
∂n+1
−−−→Xn+1
∂n
−−−→Xn
∂n−1
−−−→Xn−1
∂n−2
−−−→
· · ·
⏐⏐+ fn
⏐⏐+ fn−1
· · ·
∂′
n+1
−−−→X′
n+1
∂′
n
−−−→X′
n
∂′
n−1
−−−→X′
n−1
∂′
n−2
−−−→· · · · · ·
fn+1
for the construction of the chain map and
· · · −−−→Xn+2
∂n+1
−−−→Xn+1
∂n
−−−→Xn
∂n−1
−−−→Xn−1 −−−→· · ·
⏐⏐+ fn+2
⏐⏐+ fn+1
⏐⏐+ fn
⏐⏐+ fn−1
· · · −−−→X′
n+2
∂′
n+1
−−−→X′
n+1
∂′
n
−−−→X′
n
∂′
n−1
−−−→X′
n−1 −−−→· · ·
hn+1
hn
hn−1
for the construction of the homotopy.
PROOF.
For the existence of the chain map, it is enough by induction to
construct fr+1. Matters are therefore as in the ﬁrst of the above diagrams with
n = r. Since X′ is exact at X′
r and Xr+1 is projective, we are in the situation
of Lemma 4.11 with P = Xr+1, A′′ = X′
r+1, A = X′
r, A′ = X′
r−1, ψ = ∂′
r,
ϕ = ∂′
r−1, and τ = fr∂r. The lemma gives a map σ : P →A′′ with ψσ = τ.
If we take fr+1 = σ, then ψσ = τ says that ∂′
r fr+1 = fr∂r, and the inductive
construction of the chain map is complete.
For the uniqueness up to homotopy, let f : X →X′ and g : X →X′
be two chain maps such that fn = gn for n ≤r. Deﬁne hn : Xn →X′
n+1
to be 0 for n ≤r, and observe that the system of functions {hn}n≤r satisﬁes
hn−1∂n−1 + ∂′
nhn = fn −gn for n ≤r because fn = gn for n ≤r. Proceeding
inductively, supposethats ≥r andthathn hasbeenconstructedforn ≤s suchthat
hn−1∂n−1 +∂′
nhn = fn −gn for n ≤s. We are to construct hs+1 : Xs+1 →X′
s+2.
This is the situation of the second diagram above with n = s. Since s ≥r, X′
is exact at X′
s+1 and Xs+1 is projective. Thus we are in the situation of Lemma
4.11 with P = Xs+1, A′′ = X′
s+2, A = X′
s+1, A′ = X′
s, ψ = ∂′
s+1, ϕ = ∂′
s, and
τ = ( fs+1 −gs+1) −hs∂s. The lemma gives a map σ : P →A′′ with ψσ = τ.
If we take hs+1 = σ, then ψσ = τ says that ∂′
s+1hs+1 = ( fs+1 −gs+1) −hs∂s,
and the inductive construction of the homotopy is complete.
□
A resolution in the category C is an exact chain complex X = {(Xn, ∂n)}∞
n=−∞
or cochain complex X = {(Xn, dn)}∞
n=−∞such that Xn = 0 for n ≤−2. We say
that the complex is a resolution of X−1, and we abbreviate it as
X = (X+
∂−1
−−−→X−1)
or
X = (X+
d−1
←−−−X−1),

4. Projectives and Injectives
195
with X+ referring to
X+ :
· · ·
∂2
−−→X2
∂1
−−→X1
∂0
−−→X0
X+ :
· · ·
d2
←−−X2
d1
←−−X1
d0
←−−X0
or
in the respective cases.
A chain complex X = (X+
ε
−→M) that forms a
resolution is called a free resolution of M if every Xn for n ≥0 is a free module.
It is called a projective resolution of M if every Xn for n ≥0 is projective.
Corollary 4.13. Let M be a module in a good category C and let
X = (X+
ε
−→M)
and
X′ = (X′+
ε′
−→M)
be two projective resolutions of M. Then there exist chain maps f : X →X′
and g : X′ →X with f−1 = 1M and g−1 = 1M, and any two such chain maps f
and g have the property that g f : X →X is homotopic to 1X and f g : X′ →X′
is homotopic to 1X′.
PROOF. The existence of f extending f−1 = 1M is immediate by applying
the ﬁrst part of Theorem 4.12 with r = −1. The hypotheses apply because Xn
is projective for n > −1 and X′ is exact at X′
n for n ≥−1. A similar argument
shows the existence of g.
If we have f and g, then g f : X →X and 1X : X →X are chain maps
that extend the partial chain map given for n ≤−1 by 1M for n = −1 and by 0
for n ≤−2. Since again Xn is projective for n > −1 and X′ is exact at X′
n for
n ≥−1, the second part of the theorem shows that g f and 1X are homotopic. A
similar argument shows that f g and 1X′ are homotopic.
□
There is an analogous sequence of results that ends with resolutions that are
cochain maps. They will be equally as useful as the above results when we
introduce derived functors in the next section. For the results below, the notion
of a projective is replaced by that of an injective. We say that a module I in the
good category C is injective in C or is an injective in C if whenever a diagram in
the category is given as in Figure 4.4 with ϕ mapping one-one from B into C,
then there exists σ : B →I in C such that the diagram commutes.
I
,⏐⏐τ
0 −−−→B
ϕ
−−−→C,
σ
FIGURE 4.4. Deﬁning property of an injective.

196
IV. Homological Algebra
We can think of the condition as saying that we can always extend such a τ from
B to C, the extension being σ. In any event, we give some examples after proving
an analog of Lemma 4.11.
Lemma 4.14. If I is injective in the good category C and if the diagram
I
,⏐⏐τ
A′
ψ
−−−→A
ϕ
−−−→A′′,
σ
in C has ker ϕ = image ψ and τψ = 0, then there exists a map σ : A′′ →I in C
such that the diagram commutes.
PROOF. The hypotheses force ker τ ⊇image ψ = ker ϕ. Thus τ : A →I and
ϕ : A →A′′ descend to maps τ : A/ ker ϕ →I and ϕ : A/ ker ϕ →A′′. If we
put B = A/ ker ϕ and C = A′′, then the above diagram leads to Figure 4.4 with
τ and ϕ in place of τ and ϕ. The hypothesis “injective” gives us σ in Figure 4.4
with τ = σϕ, and the same σ is the required map in the diagram above.
□
EXAMPLES OF INJECTIVES.
(1) If R is a ﬁeld F and if C is the category of all vector spaces over F, then
every module is injective. In fact, in Figure 4.4 we write C = image ϕ ⊕B′, and
we let η : image ϕ →B be the inverse of ϕ : B →image ϕ. Then we can deﬁne
σ to be 0 on B′ and to be τη on image ϕ.
(2) Let C be the category of all abelian groups (unital Z modules). An abelian
group G is said to be divisible if for each integer n ̸= 0 and each x ∈G, there
exists y ∈G with ny = x. Two examples of divisible abelian groups are the
additive group of rationals and the additive group of rationals modulo 1. It is
easy to see that any quotient of a divisible group is divisible and that direct sums
of divisible groups are divisible. Let us see for abelian groups that injective is
equivalent to divisible.
The argument that injective implies divisible is easy: Let I be injective. Given
x ∈I and n ̸= 0, let B = C = Z, let τ : Z →I have τ(k) = kx, and let
ϕ : Z →Z have ϕ(k) = kn. Setting up Figure 4.4, we obtain σ : Z →I
with τ = σϕ. If we put y = σ(1) and evaluate both sides at 1, then we obtain
x = τ(1) = σ(ϕ(1)) = σ(n) = nσ(1) = ny, as required.
The argument that divisible implies injective uses Zorn’s Lemma. Let I be
injective, and suppose that B, C, ϕ, and τ are given as in Figure 4.4. Consider
the set S of abelian-group homomorphisms σ ′ having domain a subgroup of
C containing ϕ(B), having range I, and having σ ′ϕ = τ. Order S by inclusion
upward of the corresponding sets of ordered pairs. The set S is nonempty because

4. Projectives and Injectives
197
the homomorphism σ ′ with domain ϕ(B) and values σ ′(ϕ(b)) = τ(b) lies in
S; σ ′ is well deﬁned because ϕ is assumed one-one. Zorn’s Lemma yields a
maximal element σ in S, say with domain C. We show that C = C. Arguing
by contradiction, suppose that C is a proper subgroup. Let c be in C but not C.
The set of integers k with kc in C is an ideal in Z, and we let n be a generator.
Since I is divisible, there exists an element a in I with na = σ(nc). Deﬁne σ on
the subgroup generated by c and C by the formula σ(kc + ¯c) = ka + σ(¯c) for
k ∈Z and ¯c ∈C. We need to check that σ is well deﬁned. If kc + ¯c = k′c + ¯c′,
then (k −k′)c = ¯c′ −¯c is in C, and thus k −k′ = qn for some integer q.
Hence σ(kc + ¯c) −σ(k′c + ¯c) = (k −k′)a + σ(¯c −¯c′) = qna + σ(¯c −¯c′) =
qσ(nc)+σ(¯c−¯c′) = qσ(nc)−σ((k−k′)c) = qσ(nc)−qσ(nc) = 0. Therefore
σ is a nontrivial additive extension of σ, in contradiction to maximality of σ, and
the proof is complete.
(3) For R = Z, two good categories that were listed in Section 2 were the
category of all ﬁnitely generated abelian groups and the category of all torsion
abelian groups. With the ﬁrst of these, Problem 1 at the end of the chapter asks
for a veriﬁcation that some module in the category fails to be a submodule of any
injective. With the second of these, the injectives are the torsion divisible groups.
The next proposition extends Example 2 and its proof to general R. Although
the condition in the proposition is not very intuitive for general R, it has a simple
interpretation for (commutative) principal ideal domains; see Problem 4 at the
end of the chapter.
Proposition 4.15. A unital left R module I is injective for the good category
of all unital left R modules if and only if every R homomorphism of a left ideal
J of R into I extends to an R homomorphism R →I.
PROOF. The necessity is immediate from Figure 4.4 and the deﬁnition of
“injective” if we take B = J, C = R and write τ for the given R homomorphism
of J into I.
For the sufﬁciency, suppose that I and a diagram as in Figure 4.4 are given.
Consider the set S of R module homomorphisms σ ′ having domain an R sub-
module of C containing ϕ(B) and having range I such that σ ′ϕ = τ, and
order S by inclusion upward of the corresponding sets of ordered pairs. The
set S is nonempty because the homomorphism σ ′ with domain ϕ(B) and values
σ ′(ϕ(b)) = τ(b) lies in S; σ ′ is well deﬁned because ϕ is assumed one-one.
Zorn’s Lemma yields a maximal element σ in S, say with domain C.
We
show that C = C. Arguing by contradiction, suppose that C is a proper R
submodule of C. Let c be in C but not C. The set of elements r ∈R with rc
in C is a left ideal J in R, and the mapping ψ(r) = σ(rc) is a well-deﬁned R
homomorphism of J into I. By hypothesis, ψ extends to an R homomorphism

198
IV. Homological Algebra
 : R →I. Deﬁne σ on the subgroup generated by c and C by the formula
σ(rc + ¯c) = (r) + σ(¯c) for r ∈R and ¯c ∈C. We need to check that σ is
well deﬁned. If rc + ¯c = r′c + ¯c′, then (r −r′)c = ¯c′ −¯c is in C, and thus
r −r′ is in J. Consequently (r) −(r′) = ψ(r −r′) = σ((r −r′)c). Hence
σ(rc+ ¯c)−σ(r′c+ ¯c) = ((r)−(r′))+σ(¯c−¯c′) = σ((r −r′)c)+σ(¯c−¯c′) =
σ((r −r′)c) −σ((r −r′)c) = 0. Therefore σ is a nontrivial extension of σ, in
contradiction to maximality of σ, and the proof is complete.
□
Now we can prove an analog of Theorem 4.12 for cochain complexes. This
result had no counterpart in Chapter III.
Theorem 4.16.
Let X = {(Xn, dn)}∞
n=−∞and X′ = {(X′
n, d′
n)}∞
n=−∞be
cochain complexes in the good category C, and let r be an integer.
Let
{ fn : Xn →X′
n}n≤r be a family of maps in C such that d′
n−1 fn−1 = fndn−1
for n ≤r. If X is exact at each Xn with n ≥r and X′
n is injective for n > r, then
{ fn : Xn →X′
n}n≤r extends to a cochain map f : X →X′, and f is unique up
to homotopy. More precisely any two extensions are homotopic by a homotopy
h such that hn = 0 for n ≤r.
REMARKS. The diagrams in question are
· · ·
dn−2
−−−→Xn−1
dn−1
−−−→Xn
dn
−−−→Xn+1
dn+1
−−−→· · ·
⏐⏐+ fn−1
⏐⏐+ fn
· · ·
d′
n−2
−−−→X′
n−1
d′
n−1
−−−→X′
n
d′
n
−−−→X′
n+1
d′
n+1
−−−→· · ·
fn+1
for the construction of the cochain map and
· · · −−−→Xn−1
dn−1
−−−→Xn
dn
−−−→Xn+1
dn+1
−−−→Xn+2 −−−→· · ·
⏐⏐+ fn−1
⏐⏐+ fn
⏐⏐+ fn+1
⏐⏐+ fn+2
· · · −−−→X′
n−1
d′
n−1
−−−→X′
n
d′
n
−−−→X′
n+1
d′
n+1
−−−→X′
n+2 −−−→· · ·
hn
hn+1
hn+2
for the construction of the homotopy.
PROOF. For the existence of the cochain map, it is enough by induction to
construct fr+1. Matters are therefore as in the ﬁrst of the above diagrams with
n = r. Since X is exact at Xr and X′
r+1 is injective, we are in the situation of
Lemma 4.14 with I = X′
r+1, A′′ = Xr+1, A = Xr, A′ = Xr−1, ψ = dr−1,
ϕ = dr, and τ = d′
r fr. The lemma gives a map σ : A′′ →I with σϕ = τ.
If we take fr+1 = σ, then σϕ = τ says that fr+1dr = d′
r fr, and the inductive
construction of the cochain map is complete.

4. Projectives and Injectives
199
For the uniqueness up to homotopy, let f : X →X′ and g : X →X′ be
two cochain maps such that fn = gn for n ≤r. Deﬁne hn : Xn →X′
n−1 to
be 0 for n ≤r + 1, and observe that the system of functions {hn}n≤r satisﬁes
hn+1dn + d′
n−1hn = fn −gn for n ≤r because fn = gn for n ≤r. Proceeding
inductively, suppose that s ≥r and that hn has been constructed for n ≤s+1 such
that hn+1dn + d′
n−1hn = fn −gn for n ≤s. We are to construct hs+2 : Xs+2 →
X′
s+1. This is the situation of the second diagram with n = s. Since s ≥r, X
is exact at Xs+1 and X′
s+1 is injective. Thus we are in the situation of Lemma
4.14 with I = X′
s+1, A′′ = Xs+2, A = Xs+1, A′ = Xs, ψ = ds, ϕ = ds+1, and
τ = ( fs+1 −gs+1) −d′
shs+1. The lemma gives a map σ : A′′ →I with σϕ = τ.
If we take hs+2 = σ, then σϕ = τ says that hs+2ds+1 = ( fs+1 −gs+1) −d′
shs+1,
and the inductive construction of the homotopy is complete.
□
A cochain complex X = (X+
ε
←−M) that forms a resolution is called an
injective resolution of M if every Xn for n ≥0 is an injective.
Corollary 4.17. Let M be a module in a good category C and let
X = (X+
ε
←−M)
and
X′ = (X′+
ε′
←−M)
be two injective resolutions of M. Then there exist cochain maps f : X →X′
and g : X′ →X with f−1 = 1M and g−1 = 1M, and any two such cochain
maps f and g have the property that g f : X →X is homotopic to 1X and
f g : X′ →X′ is homotopic to 1X′.
PROOF. The existence of f extending f−1 = 1M is immediate by applying
the ﬁrst part of Theorem 4.16 with r = −1. The hypotheses apply because X
is exact at Xn for n ≥−1 and X′
n is injective for n > −1. A similar argument
shows the existence of g.
If we have f and g, then g f : X →X and 1X : X →X are cochain maps
that extend the partial cochain map given for n ≤−1 by 1M for n = −1 and by 0
for n ≤−2. Since again X is exact at Xn for n ≥−1 and X′
n is injective for
n > −1, the second part of the theorem shows that g f and 1X are homotopic. A
similar argument shows that f g and 1X′ are homotopic.
□
We conclude with elementary characterizations of projectives and injectives
that will turn out to be quite useful in the next two sections. We begin with a
lemma6 that will be useful now and will be helpful as motivation in the next
section.
6The lemma is a slight variant of Problem 5 at the end of Chapter X of Basic Algebra.

200
IV. Homological Algebra
Lemma 4.18. Let C be a good category of unital left R modules, and let
0 −→A
ϕ
−→B
ψ
−−→C −→0
be an exact sequence in C. Then the following conditions are equivalent:
(a) B is a direct sum B = B′ ⊕ker ψ of modules in C,
(b) there exists an R homomorphism σ : C →B such that ψσ = 1C,
(c) there exists an R homomorphism τ : B →A such that τϕ = 1A.
REMARK. When the equivalent conditions of this lemma are satisﬁed, one says
that the exact sequence is split.
PROOF. If (a) holds, then ψ

B′ is one-one from B′ onto C. Let σ be its inverse.
Then σ : C →B′ is one-one with ψσ = 1C. So (b) holds.
If(b)holds, thenanyb in B hasthepropertythatb−σψ(b)hasψ(b−σψ(b)) =
ψ(b) −1Cψ(b) = 0 and is therefore in image ϕ. Write b −σψ(b) = ϕ(a) for
some a depending on b; a is unique because ϕ is one-one. If τ : B →A is deﬁned
by τ(b) = a, then τ is an R homomorphism by the uniqueness of a. Consider
τ(ϕ(a)) for a in A. The element b = ϕ(a) has b −σψ(b) = ϕ(a) −σψϕ(a) =
ϕ(a) −σ(0) = ϕ(a), and the deﬁnition of τ therefore says that τ(ϕ(a)) = a.
Hence τϕ = 1A, and (c) holds.
If (c) holds, then B′ = ker τ is an R submodule of B. If b is in B′ ∩image ϕ,
then b = ϕ(a) for some a ∈A and also 0 = τ(b) = τϕ(a) = 1A(a) = a. So
b = 0, and B′ ∩image ϕ = 0. If b ∈B is given, write b = (b −ϕτ(b)) + ϕτ(b).
Then ϕτ(b) is certainly in image ϕ, and τ(b−ϕτ(b)) = τ(b)−1Aτ(b) = 0 shows
that b −ϕτ(b) is in B′. Therefore B = B′ ⊕image ϕ. Since image ϕ = ker ψ,
we see that B = B′ ⊕ker ψ and that (a) holds.
□
Proposition 4.19. If C is a good category of unital left R modules, then
(a) a module P in C is projective if and only if HomR(P, · ) is an exact functor
from C into CZ, if and only if every exact sequence
0 −→A
ϕ
−→B
ψ
−→C −→0
in C splits when its third nonzero member C equals P, and
(b) a module I in C is injective if and only if HomR( · , I) is an exact functor
from C into CZ, if and only if every exact sequence
0 −→A
ϕ
−→B
ψ
−→C −→0
in C splits when its ﬁrst nonzero member A equals I.

4. Projectives and Injectives
201
PROOF. For (a), suppose that P is given. The functor HomR(P, · ) is covariant
and left exact, no matter what P is. Proposition 4.3 shows it is exact if and only if
it carries short exact sequences into short exact sequences, and the left exactness
means that the functor is exact if and only if it carries onto maps from B to C
to onto maps from HomR(P, B) to HomR(P, C). If ψ : B →C is given, then
Hom(1, ψ) : HomR(P, B) →HomR(P, C) operates on a mapσ in HomR(P, B)
by Hom(1, ψ)(σ) = ψσ. The statement that the equation ψσ = τ is solvable
for σ for each τ in HomR(P, C) whenever ψ is onto is precisely the statement
that Figure 4.3 is solvable for σ for all possible τ’s whenever B −→C −→0 is
exact, and thus P is projective if and only if the functor is exact.
If P is projective and an exact sequence with C = P is given, take τ = 1P
in Figure 4.3. The projective property yields a map σ : P →B with ψσ = 1P,
and Lemma 4.18b shows that the exact sequence splits.
Conversely suppose that every short exact sequence with P as its third nonzero
member splits. Suppose that a diagram as in Figure 4.3 is given with ψ : C →B
onto and with τ mapping P into B.
Let S = C ⊕P, and let T be the R
submodule {(c, x) ∈C ⊕P | ψ(c) = τ(x)} of S. Denote the projections
of S to C and P by pC and pP, and let j : T →S be the inclusion. The
map7 pP j carries T onto P; in fact, if x ∈P is given, then ψ : C →B
onto implies that there exists cx ∈C with ψ(cx) = τ(x). Then (cx, x) lies in
T , and pP j(cx, x) = pP(cx, x) = x. Consequently we have a 5-term exact
sequence with terms 0, ker(pP j), T , P, 0, and this must split by hypothesis.
Thus there exists a map q : P →T with pP jq = 1P. Deﬁne σ = pC jq.
For x ∈P, jq(x) is some member of S of the form (c, x) with ψ(c) = τ(x).
Hence ψσ(x) = ψpC jq(x) = ψpC(c, x) = ψ(c) = τ(x). Thus ψσ = τ, and
σ : P →C is the required map that exhibits P as projective.
For (b), suppose that I is given. The functor HomR( · , I) is contravariant and
left exact, no matter what I is. It is exact if and only if it carries one-one maps
from A to B to onto maps from HomR(B, I) to HomR(A, I). If ϕ : A →B is
given, then Hom(ϕ, 1) : HomR(B, I) →HomR(A, I) operates on a map σ in
HomR(B, I) by Hom(ϕ, 1)(σ) = σϕ. The statement that the equation σϕ = τ
is solvable for σ for each τ in HomR(A, I) whenever ϕ is one-one is precisely
the statement that Figure 4.4 is solvable for σ for all possible τ’s whenever
0 −→A −→B is exact, and thus I is injective if and only if the functor is exact.
If I is injective and an exact sequence with A = I is given, take τ = 1I in
Figure 4.4. The injective property yields a map σ : B →I with σϕ = 1I, and
Lemma 4.18c shows that the exact sequence splits.
Conversely suppose that every short exact sequence with I as its ﬁrst nonzero
member splits. Suppose that a diagram as in Figure 4.4 is given with ϕ : A →B
one-one and with τ mapping A into I. Let S = B ⊕I, and let T be the quotient of
7The pair (pC j, pP j) is called the pullback of (τ, ψ). See Problem 35 at the end of the chapter.

202
IV. Homological Algebra
S by the R submodule {(ϕ(a), −τ(a)) | a ∈A}. Denote the inclusions of B and I
into S by iB and iI, and let k : S →T be the quotient mapping. The composition8
kiI is one-one from I into T . In fact, if kiI(x) = 0 for some x ∈I, then (0, x)
is a member of S of the form (ϕ(a), −τ(a)) for some a ∈A; thus ϕ(a) = 0, and
the fact that ϕ is one-one implies that a = 0 and hence that x = −τ(a) = 0.
Consequently we have a 5-term exact sequence with terms 0, I, T , T/I, 0, and
this must split by hypothesis. Thus there exists a map r : T →I with rkiI = 1I.
Deﬁne σ = rkiB. For a ∈A, iBϕ(a)−iIτ(a) = (ϕ(a), −τ(a)) is in ker k. Thus
kiBϕ(a) = kiIτ(a), and σϕ(a) = rkiBϕ(a) = rkiIτ(a) = 1Iτ(a) = τ(a) for
a ∈A. Therefore σϕ = τ, and σ : A →I is the required map that exhibits I as
injective.
□
5. Derived Functors
Now we shall undertake the main construction of the chapter, that of “derived
functors.” Let C be a good category of unital left R modules. Arranging for
derived functors to be deﬁned on every module in C requires that each module M
in C have either a projective resolution or an injective resolution, and thus C must
have either many projectives or many injectives in a suitable sense. Let us make
the condition precise.
We say that C has enough projectives if every module in C is a quotient of a
projective in C. Suppose that this condition is satisﬁed. Let M be a module in C,
and let X0 be a projective that maps onto M, say by a map ε. Then ker ε is in C,
since good categories are closed under the passage to submodules, and we let X1
be a projective in C that maps onto ker ε, say by a map ∂0. Similarly let X2 be a
projective that maps onto ker ∂0 in X1, say by a map ∂1, and so on. The result is
that we obtain a projective resolution of the form X+
ε
−→M with X+ given by
X+ :
· · · −−→X2
∂1
−−→X1
∂0
−−→X0.
Consequently the condition “enough projectives” implies that every module in C
has a projective resolution in C.
Similarly we say that C has enough injectives if every module in C is a
submodule of an injective in C. Suppose that this condition is satisﬁed. Let
M be a module in C, and let X0 be an injective into which M embeds, say by
a map ε. Then X0/ image ε is in C, since good categories are closed under the
passage to quotient modules, and we let X1 be an injective into which X0/ image ε
embeds, say by a map d#
0. Let d0 be the composition of the quotient map from X0
to X0/ image ε, followed by d#
0; then d0 maps X0 into X1 with ker d0 = image ε.
8The pair (kiB, kiI ) is called the pushout of (τ, ϕ). See Problem 35 at the end of the chapter.

5. Derived Functors
203
We let X2 be an injective into which X1/ image d0 embeds, say by d#
1, and we let
d1 be the composition of the quotient map from X1 to X1/ image d0, followed by
d#
1; then d1 maps X1 into X2 with ker d1 = image d0. Continuing in this way, we
obtain an injective resolution of the form X+
ε
←−M with X+ given by
X+ :
· · ·
d2
←−−X2
d1
←−−X1
d0
←−−X0.
Consequently the condition “enough injectives” implies that every module in C
has an injective resolution in C.
The category CR of all unital left R modules certainly has enough projectives.
In fact, every module in CR is the quotient of a free R module, and free R modules
are projective in CR. It is less trivial but still true that CR has enough injectives.
Let us pause for a moment to prove this result in Proposition 4.20 below.
As is shown in Problems 1–2 at the end of the chapter, other good categories
of unital left R modules may or may not have enough projectives or enough
injectives, and a good category may have the one without the other.
Proposition 4.20. If R is any ring with identity, then the category of all unital
left R modules has enough injectives.
PROOF. We treat ﬁrst the case that R = Z. In view of Example 2 of injectives,
we are to exhibit an arbitrary abelian group A as isomorphic to a subgroup of a
divisible group. We know that A is isomorphic to a quotient of some free abelian
group. Write A ∼= F/S with F a direct sum of copies of Z and S equal to some
subgroup of F. Taking a Z basis for F and forming a Q vector space with that
same basis, we can regard F as a subgroup of the additive group D of a rational
vector space. The group D is divisible, and A is isomorphic to a subgroup of
D/S. Any quotient of a divisible group is divisible, and thus D/S is divisible.
Now we allow R to be any ring with identity. We shall make use of various
results from Chapter X of Basic Algebra. If M is any unital left R module, let us
denote by FM the underlying abelian group9 of M. If we regard R as an (Z, R)
bimodule, then Proposition 10.17 makes HomZ(R, FM) into a left R module,
with rϕ(r′) = ϕ(r′r) for r and r′ in R. The mapping m 	→ϕm with ϕm(r) = rm
is a one-one R homomorphism of M into HomZ(R, FM). From the previous
paragraph we can ﬁnd a divisible abelian group with FM ⊆D, and we can then
regard the left R module HomZ(R, FM) as an R submodule of HomZ(R, D).
Consequently we can regard M as an R submodule of HomZ(R, D). We are
going to prove that I = HomZ(R, D) is injective in CR.
We digress for a moment to make a side calculation. With D ﬁxed and N equal
to any unital left R module, we make use of the isomorphism
HomR(N, HomZ(R, D)) ∼= HomZ(R ⊗R N, D)
9F is called the forgetful functor from CR to CZ.

204
IV. Homological Algebra
given in Proposition 10.23 of Basic Algebra; in the expression R ⊗R N, the left
factor of R is to be regarded as a right R module (and not also a left R module),
and then R ⊗R N is really F(R ⊗R N) in the sense that the tensor product retains
only the structure of an abelian group. Meanwhile, Corollary 10.19a gives us
HomZ(R ⊗R N, D) ∼= HomZ(N, D);
here the R on the left is an (R, R) bimodule, and the isomorphism is one of left
R modules. However, there is no harm in applying F to both sides and obtaining
HomZ(F(R ⊗R N, D)) ∼= HomZ(FN, D).
Thus
HomR(N, HomZ(R, D)) ∼= HomZ(FN, D).
(∗)
If we track down the isomorphisms in the results of Chapter X, we see that
the map from left to right sends ϕ ∈HomR(N, HomZ(R, D)) to the map
 ∈HomZ(FN, D) with (x) = ϕ(x)(1) for x ∈N, and the inverse sends
 to ϕ with ϕ(x)(r) = (rn).
Now we return to I = HomZ(R, D). By Proposition 4.19b, I will be injective
if and only if HomR( · , I) is an exact functor. Since this functor is contravariant
and left exact, it is enough to prove that if 0 −→A
ψ
−→B is exact in CR, then
HomR(B, I)
Hom(ψ,1)
−−−−−→HomR(A, I) −→0
(∗∗)
is exact in CZ. Let us reinterpret (∗∗) in the light of the isomorphism (∗) when
N = B and N = A. If ϕ is in HomR(B, HomZ(R, D)), then Hom(ψ, 1)(ϕ)
is the member ϕψ of HomR(A, HomZ(R, D)). The corresponding members of
HomZ(FB, D) and HomZ(FA, D) are  with (b) = ϕ(b)(1) and a member
′ of HomZ(FA, D) with ′(a) = ϕψ(a)(1). Thus ′ = (Fψ), and the map-
ping Hom(ψ, 1) in (∗∗) translates under the isomorphisms (∗) into the mapping
Hom(Fψ, 1) of HomZ(FB, D) into HomZ(FA, D). The group D is divisible,
hence injective in CZ. Since Fψ : FA →FB is one-one and D is injective
in CZ, Proposition 4.19b shows that Hom(Fψ, 1) carries HomZ(FB, D) onto
HomZ(FA, D). Therefore (∗∗) is exact, and we conclude that I is injective
in CR.
□
Derived functors of an additive functor F from one good category to another
will be useful when F is left exact or right exact, and there will be one derived
functor for each integer n ≥0. The value of the nth derived functor on a module
M is obtained by taking a projective or injective resolution of M according to
the rule in Figure 4.5, applying F to the resolution, dropping the term F(M)

5. Derived Functors
205
that occurs in degree −1, and forming the nth homology or cohomology of the
resulting complex. The full traditional notation for the derived functor in question
appears in Figure 4.5, along with an abbreviated notation that we shall tend to
use.
The choice of projective or injective resolution at the start is made in such a
way that the 0th derived functor is naturally isomorphic to F; this condition will
be clariﬁed in Proposition 4.21 below. If a projective resolution is to be used,
one makes the assumption that the domain category has enough projectives; if
an injective resolution is to be used, one makes the assumption that the domain
category has enough injectives.
If the resulting complex obtained by applying F to the resolution is a chain
complex, the abbreviated notation is Fn for the nth derived functor; otherwise it
is Fn. The full traditional notation involves using an L or R in front of F to
denote the one-sided exactness, left or right, that F is not assumed to have, and
the subscript or superscript n is moved from F to the L or R.
Exactness
—variant
Resolution
—ology
Notation
Example
right
co—
projective
hom—
Fn, Ln F
M ⊗R ( · )
right
contra—
injective
hom—
Fn, Ln F
M ⊗Z HomZ( · , I),
I injective
left
co—
injective
cohom—
Fn, Rn F
HomR(M, · )
left
contra—
projective
cohom—
Fn, Rn F
HomR( · , M)
FIGURE 4.5. Formation of derived functors.
There are several things that need elaboration in this deﬁnition, and we take
them up right away.
First there is the fact that Fn(M) or Fn(M) is well deﬁned. Suppose that we
start with two resolutions X and X′ of M (projective or injective by the rules in
Figure 4.5). Corollary 4.13 or 4.17 gives us chain or cochain maps f : X →X′
and g : X′ →X with f−1 = 1M and g−1 = 1M and shows that g f : X →X is
homotopic to 1X and that f g : X′ →X′ is homotopic to 1X′. For deﬁniteness
let us suppose that F is covariant and right exact; then chain maps are involved
and the derived functors of F are to be denoted by Fn. Applying F to our chain
maps, we obtain chain maps F( f ) : F(X) →F(X′), F(g) : F(X′) →F(X),
F(g f ) : F(X) →F(X), and F( f g) : F(X′) →F(X′). The last two of these
are homotopic to 1F(X) : F(X) →F(X) and to 1F(X′) : F(X′) →F(X′),
respectively, by F of the respective homotopies.
Proposition 4.1 shows that
F(g)F( f ) = F(g f ) induces the identity on H∗(F(X)) and that F( f )F(g) =
F( f g) induces the identity on H∗(F(X′)). Consequently the mappings induced

206
IV. Homological Algebra
on homology by F( f ) and F(g) are two-sided inverses of one another. Thus
Fn(M) as computed from X is isomorphic to Fn(M) as computed from X′.
Moreover, this isomorphism is canonical. If f ′ : X →X′ is another chain
map, then the same calculation shows that F( f ′) and F(g) induce two-sided
inverses of each other on homology, and hence F( f ) = F( f ′) on homology.
Thus Fn(M) is well deﬁned up to canonical isomorphism when F is covariant
and right exact. The other three situations in Figure 4.5 are handled in similar
fashion and lead to analogous conclusions.
Next we make Fn or Fn into a functor. To do do, let ϕ : M →M′ be given. For
deﬁniteness, again let us suppose that F is covariant and right exact. Let X and X′
be projective resolutions of M and M′, respectively, and apply Theorem 4.12 to
produce a chain map  : X →X′ with −1 = ϕ. Then F() : F(X) →F(X′)
is a chain map and induces maps on homology that we denote by Fn(ϕ). Here
Fn(ϕ) maps Fn(M) into Fn(M′).
Let us see that Fn(ϕ) is well deﬁned. If X is replaced by X, Corollary 4.13
produces chain maps f : X →X and g : X →X with f−1 = 1M and g−1 = 1M,
and Theorem 4.12 produces a chain map  : X →X′ with −1 = ϕ. Since ◦f
and  are both chain maps from X to X′ that equal ϕ in degree −1, Theorem
4.12 shows that  ◦f is homotopic to . Similarly  ◦g and  are chain
maps from X to X′ and are homotopic. By Proposition 4.1, F( ◦f ) = F()
on homology, and F( ◦g) = F() on homology. Thus on homology F()
corresponds to F() under the canonical isomorphism F( f ), whose inverse on
homology is F(g). In short, Fn(ϕ) is well deﬁned up to the previously obtained
canonical isomorphisms. The other three situations in Figure 4.5 are handled in
similar fashion and lead to analogous conclusions.
Tracing through the deﬁnition of how derived functors affect maps, we see
that the map 1 goes to the map 1 and that compositions go to compositions, in
the same order as for F. Thus the derived functors are indeed functors. The
derived functors of a covariant functor are covariant, and the derived functors of
a contravariant functor are contravariant.
We need to check that the derived functors are additive. If ϕ : M →M′ and
ϕ′ : M →M′ are given, then we can proceed as above and use a single resolution
of M and a single resolution of M′ to investigate ϕ, ϕ′, and ϕ + ϕ′. Then it
is apparent that the chain or cochain maps built from maps of M to M′ add in
the same way as the maps, and the result is that each Fn or Fn is additive with
particular choices of the resolutions in place. Allowing the resolutions to vary
means that we have to take canonical isomorphisms into account, and after doing
so, we still get additivity.
If two functors F and G from C to C ′ of the same type in Figure 4.5 are naturally
isomorphic, then Fn and Gn (or else Fn and Gn) are naturally isomorphic for all
n. In fact, if T is the natural isomorphism, then T associates a member TA

5. Derived Functors
207
of Hom(F(A), G(A)) to each module A in C. Take a projective or injective
resolution X = {Xn} of A, as appropriate, and form the two complexes F(X) and
G(X). The system {TXn} is then a chain map from F(X) to G(X), with inverse
{T −1
Xn }, and the homology or cohomology of F(X) is exhibited as isomorphic to
the homology or cohomology of G(X). This much shows that Fn(A) ∼= Gn(A)
(or Fn(A) ∼= Gn(A)) for all n. We omit the details of verifying the naturality of
this isomorphism in the A variable for each n.
Proposition 4.21. In the four situations of derived functors in Figure 4.5, under
the assumption that the domain category for F has enough projectives or enough
injectives as appropriate, the 0th derived functor of F is naturally isomorphic to F.
PROOF IF F IS COVARIANT AND RIGHT EXACT. Let
X1
∂0
−−→X0
ε
−−→M −−→0
bethetermsindegree1, 0, −1, −2ofaprojectiveresolutionof M. ByProposition
4.5 and its remark, the right exactness and covariance of F imply that
F(X1)
F(∂0)
−−−→F(X0)
F(ε)
−−−→F(M) −−→0
is exact. The derived-functor module F0(M) is computed as the 0th homology of
F(X1)
F(∂0)
−−−→F(X0) −−→0.
Thus
F0(M) = F(X0)/ image F(∂0) = F(X0)/ ker F(ε).
Since F(ε) is onto F(M), the right side here is ∼= F(M) via F(ε).
This establishes the isomorphism. Let us prove that it is natural in the variable
M. If ϕ : M →M′ is given, we are to prove that the diagram
F0(M)
via F(ε)
−−−−−→F(M)
F0(ϕ)
⏐⏐+
⏐⏐+F(ϕ)
F0(M′)
via F(ε′)
−−−−−→F(M′)
(∗)
commutes. Using Theorem 4.12, we form the part of a chain map that is indicated:
X1
∂0
−−−→X0
ε
−−−→M −−−→0
f1
⏐⏐+
f0
⏐⏐+
ϕ
⏐⏐+
X′
1
∂′
0
−−−→X′
0
ε′
−−−→M′ −−−→0

208
IV. Homological Algebra
Application of F gives a commutative diagram
F(X0)
F(ε)
−−−→F(M)
F( f0)
⏐⏐+
F(ϕ)
⏐⏐+
F(X′
0)
F(ε′)
−−−→F(M′)
and this becomes (∗) upon passage to the quotients F(X0)/ ker F(ε) and
F(X′
0)/ ker F(ε′). This completes the proof.
□
EXAMPLES.
(1) The invariants functor F(M) = MG for a group G. Suppose that a group
G acts on an abelian group M by automorphisms. This situation is completely
equivalent to considering M as a unital left ZG module, where ZG is the integer
group ring of G. The subgroup of invariants of M is
MG = {m ∈M | gm = m for all g ∈G}.
The formulas F(M) = MG for such a module M and F(h) = h

MG for h in
HomZG(M, M′) deﬁne a covariant additive functor called theinvariants functor;
we can think of F as carrying CZG into itself, but it is preferable to think of it as
carrying CZG into the category CZ of abelian groups. The functor F is naturally
isomorphic to the functor H = HomZG(Z, · ), where Z is made into a ZG
module with trivial G action; as with F, we consider H as a functor from CZG
to CZ. To see the isomorphism, we associate to each module M the abelian-
group homomorphism TM : MG →HomZ(Z, M) deﬁned by TM(m) = ϕm with
ϕm(k) = m for all k ∈Z. If h is in HomZG(M, M′), then the two maps TM′ ◦F(h)
and H(h) ◦TM of F(M) into H(M′) are equal, since at each m ∈MG we have
H(h)TM(m) = H(h)(ϕm) = Hom(1, h)(ϕm) = hϕm = ϕh(m) = TM′ F(h)(m).
This identity means that {TM} is a natural transformation; we readily check for
each M that TM carries MG one-one onto HomZ(Z, M), and thus {TM} is a natural
isomorphism.
Because of this natural isomorphism, the invariants functor is covariant and left
exact. Its derived functors Fn or H n are obtained by using an injective resolution
I ←M ←0, applying the functor ( · )G or HomZG(Z, · ), dropping the term in
degree −1, and forming cohomology. Brieﬂy
Fn(M) ∼= H n(I G) ∼= H n(HomZG(Z, I))
for an injective resolution I ←M ←0.

5. Derived Functors
209
It turns out that the result is given also by the cohomology-of-groups functors
H n(G, M) even though this was not the procedure by which we obtained group
cohomology in Section III.5. In fact, what Section III.5 said to do was to start
from a free resolution (a projective resolution would have been good enough)
such as P −→M −→0 of Z in CZ, apply the contravariant left exact functor
HomZG( · , M), drop the term in degree −1, and form cohomology. Brieﬂy then,
Section III.5 said that
H n(G, M) ∼= H n(HomZG(P, M))
for a projective resolution P →Z →0.
The fact that H n(G, M) can be computed in either of these ways is not particularly
obvious from what we have done so far, but it will be a special case of the natural
isomorphism of functors Extn and extn that is proved as Theorem 4.31 in Section 7.
With either formula for H n(G, M), we obtain H 0(G, M) ∼= MG in agreement
with Proposition 4.21.
(2) The co-invariants functor F(M) = MG for a group G. In the same setting
as in Example 1, the subgroup of co-invariants of M is
MG = M

(subgroup generated by all gm −m for g ∈G, m ∈M).
The functor F can be seen to be naturally isomorphic to the functor H with
H(M) = Z ⊗ZG M. It is therefore covariant and right exact. Its derived functors
are given by
Fn(M) ∼= Hn(PG) ∼= Hn(Z ⊗ZG P)
for a projective resolution P →M →0.
These are by deﬁnition the homology-of-groups functors Hn(G, M). Although
the equality is not particularly obvious, Hn(G, M) can be computed also from
Hn(G, M) ∼= Hn(P ⊗ZG M)
for a projective resolution P →Z →0.
This isomorphism is a special case of the natural isomorphism of functors Torn
and torn that is mentioned just before Proposition 4.29 in Section 7; the proof
is completely analogous to the proof of Theorem 4.31. With either formula for
Hn(G, M), we obtain H0(G, M) ∼= MG in agreement with Proposition 4.21.
(3) Derived functors with R = Z. For the ring Z and the category CZ (or more
generally for CR for any principal ideal domain R), projective resolutions and
injective resolutions can be fairly short, and derived functors in degree ≥2 are
all 0. Let M be a given unital Z module, i.e., an abelian group. We know that
M is the quotient of some free abelian group X0, say with a quotient map ε, and
then X1 = ker ε is a subgroup of a free abelian group and hence is free abelian.
Thus a projective resolution of M is
0 −−→X1
inc
−−→X0
ε
−−→M −−→0.

210
IV. Homological Algebra
The kinds of derived functors that make use of projective resolutions are the
covariant right exact ones and the contravariant left exact ones. If F is such a
functor, then we are led to the complexes
0 −−−→F(X1)
F(inc)
−−−→F(X0)
F(ε)
−−−→0
0 ←−−−F(X1)
F(inc)
←−−−F(X0)
F(ε)
←−−−0
and
in the two cases. Thus the values of the derived functors are F0(M) ∼= M and
F1(M) = ker F(ε) in the ﬁrst case, and F0(M) ∼= M and F1(M) = coker F(ε)
in the second case. Higher derived functors are 0. Similar remarks apply to
injective resolutions and the remaining two cases for derived functors in Figure
4.5. Every abelian group is a subgroup of a divisible group, which is injective in
CZ, and the quotient of the divisible group by the given abelian group is divisible,
hence injective. Thus we can arrange for all terms of an injective resolution to
be 0 beyond the X1 term, and an analysis of the results similar to the one above
is possible.
6. Long Exact Sequences of Derived Functors
The ﬁrst four theorems of this section say that a short exact sequence of modules
leads to a long exact sequence of derived functor modules and that it does so in
a functorial way. Let us suppose that F : C →C ′ is an additive functor between
good categories. For the ﬁrst of the theorems, suppose further that C has enough
projectives and that F is one of the types of functors in Figure 4.5 making use of
projective resolutions in the deﬁnition of its derived functors. The last of these
conditions means that F is to be covariant right exact or contravariant left exact.
To prove such a theorem, we shall want to apply Theorem 4.7, which produces
a long exact sequence from a short exact sequence of complexes. To each of the
modules in the given short exact sequence, we attach a projective resolution. If
these projective resolutions can somehow be related by chain maps so as to give
a short exact sequence of projectives in each degree, then we can apply F to the
entire diagram, invoke Theorem 4.7, and obtain the desired long exact sequence.
Application of Theorem 4.10, in combination with some further checking, will
show that the passage from the given short exact sequence of modules to the long
exact sequence of derived functor modules is functorial in the modules of the
short exact sequence.
Thus the problem is to obtain the compatible projective resolutions. Propo-
sition 4.19a gives us a clue about what to look for: any short exact sequence of
projectives has to be split. Here is the statement of the ﬁrst theorem.

6. Long Exact Sequences of Derived Functors
211
Theorem 4.22. Let F : C →C ′ be an additive functor between two good
categories. Suppose that F either is covariant right exact or is contravariant
left exact, and suppose that C has enough projectives. Whenever there are three
modules and two maps in C forming a short exact sequence
0 −→A
ϕ
−→B
ψ
−→C −→0,
then the derived functors of F on the three modules form a long exact sequence
in C ′ as follows:
(a) If F is covariant and right exact, then the long exact sequence is
0 ←−F(C) ←−F(B) ←−F(A) ←−F1(C) ←−F1(B) ←−F1(A)
←−F2(C) ←−F2(B) ←−F2(A) ←−F3(C) ←−· · · .
(b) If F is contravariant and left exact, then the long exact sequence is
0 −→F(C) −→F(B) −→F(A) −→F1(C) −→F1(B) −→F1(A)
−→F2(C) −→F2(B) −→F2(A) −→F3(C) −→· · · .
We begin with a lemma.
Lemma 4.23. In the good category C, suppose that the diagram
0
0
0
⏐+
⏐+
⏐+
0 ←−−−A
εA
←−−−
PA
ψA
←−−−MA ←−−−0
ϕ
⏐⏐+
iA
⏐⏐+
0 ←−−−B
PA ⊕PC
MB
0
ψ
⏐⏐+
pC
⏐⏐+
0 ←−−−C
εC
←−−−
PC
ψC
←−−−MC ←−−−0
⏐+
⏐+
⏐+
0
0
0
ϕ1
ψ1
εB
ψB
has the ﬁrst two columns and the two rows with solid arrows exact and has PA
and PC projective. Here i A is the inclusion into the ﬁrst component of PA ⊕PC,
and pC is the projection onto the second component. Then there exist a module
MB and maps εB, ψB, ϕ1, and ψ1 such that the whole diagram, including the
dashed arrows, has exact rows and columns and has all squares commuting.

212
IV. Homological Algebra
PROOF. The module PA ⊕PC is in C because C is good, and it is easy to see
that PA ⊕PC is projective. Let us deﬁne εB. Since PC is projective, there exists
h : PC →B such that ψh = εC, and we put εB(xA, xC) = ϕεAxA + hxC. Then
the equation
ϕεAxA = εB(xA, 0) = εBi AxA
says that the upper left square commutes, and the equation
ψεB(xA, xC) = ψϕεAxA + ψhxC = 0 + εCxC = εC pC(xA, xC)
says that the lower left square commutes.
To see that εB is onto B, let b ∈B be given. Since pC and εC are onto,
so is εC pC = ψεB. Thus we can choose (xA, xC) in PA ⊕PC with ψ(b) =
ψεB(xA, xC). Hence b −εB(xa, xC) lies in ker ψ = image ϕ, and we can write
b −εB(xA, xC) = ϕ(a) = ϕεA(x′
A) = εBi A(x′
A) = εB(x′
A, 0)
for some x′
A ∈PA. Then b = εB(xA + x′
A, xC), and εB is onto.
Let MB = ker εB, and let ψB : MB →PA ⊕PC be the inclusion. For m A in
MA, let ϕ1(m A) = (ψAm A, 0). Then ϕ1(m A) is in MB because
εB(ψAm A, 0) = ϕεAψAm A + h0 = ϕ0 + h0 = 0.
Moreover, this deﬁnition of ϕ1 makes the upper right square commute.
To deﬁne ψ1, let (xA, xC) be in MB, so that εB(xA, xC) = 0. Then 0 =
ψεB(xA, xC) = εC pC(xA, xC) = εC(xC), xC lies in ker εC = image ψC, and
xC = ψC(mC) for a unique mC in MC. We put ψ1(xA, xC) = mC. Then the
equation
ψCψ1(xA, xC) = ψC(mC) = xC = pC(xA, xC) = pCψB(xA, xC)
shows that the lower right square commutes.
Now all the squares commute, and all the rows and columns are exact except
possibly the third column. Corollary 4.8 allows us to conclude that the third
column is exact, and the proof of the lemma is complete.
□
PROOF OF THEOREM 4.22. The main step is to construct projective resolutions
of A, B, and C by an inductive process in such a way that the three resolutions to-
gether form an exact sequence of chain complexes. We start by forming projective
resolutions
0 ←−A
εA
←−X0
α0
←−X1
α1
←−· · ·
0 ←−C
εC
←−Z0
γ0
←−Z1
γ1
←−· · · .
and

6. Long Exact Sequences of Derived Functors
213
Replacing X1 by MA = ker α0 and Z1 by MC = ker γ0, we are led to the
starting diagram in Lemma 4.23. Application of the lemma produces a short
exact sequence
0 ←−B
εB
←−X0 ⊕Z0
inc
←−MB ←−0
and the vertical maps ϕ1 and ψ1 that make the squares commute in the lemma.
Next we move everything one step to the right, applying the lemma to a diagram
as in the lemma with ﬁrst and third rows
0 ←−ker εA
α0
←−X1
inc
←−ker α1 ←−0
0 ←−ker εC
γ0
←−Z1
inc
←−ker γ1 ←−0
and
and with an exact sequence in the ﬁrst column involving the maps ϕ1 and ψ1.
Application of the lemma produces a short exact sequence
0 ←−ker εB
β0
←−X1 ⊕Z1
inc
←−ker β0 ←−0
and the vertical maps ϕ2 and ψ2 that make the squares commute in the lemma.
We can put these steps together to form the following diagram with exact rows
and columns and with commuting squares:
0
0
0
0
⏐+
⏐+
⏐+
⏐+
0 ←−−−A
εA
←−−−
X0
α0
←−−−
X1
inc
←−−−ker α1 ←−−−0
ϕ
⏐⏐+
iX0
⏐⏐+
iX1
⏐⏐+
ϕ2
⏐⏐+
0 ←−−−B
εB
←−−−X0 ⊕Z0
β0
←−−−X1 ⊕Z1
inc
←−−−ker β1 ←−−−0
ψ
⏐⏐+
pZ0
⏐⏐+
pZ1
⏐⏐+
ψ2
⏐⏐+
0 ←−−−C
εC
←−−−
Z0
γ0
←−−−
Z1
inc
←−−−ker γ1 ←−−−0
⏐+
⏐+
⏐+
⏐+
0
0
0
0
We can repeat the use of Lemma 4.23, starting from the last column of the above
diagram and more of the projective resolutions of A and C, and then we can merge
the new result with the diagram above to obtain a diagram with one additional
column. Continuing in this way, we arrive at three projective resolutions and
vertical maps that together form an exact sequence of chain complexes.

214
IV. Homological Algebra
To obtain a long exact sequence for our derived functors, we apply the functor
F to the ﬁnal diagram above, except that we drop the left column of 0’s and the
column containing A, B, C. After the application of F, the remaining columns
are still exact because the columns in C are split and because F sends split
exact sequences to split exact sequences.10 Then we apply Theorem 4.7, taking
Proposition 4.21 into account, and the long exact sequence results except for the
one detail of the 0 at the end. In other words, we still have to prove exactness
at F(C). But exactness at this point is immediate from the assumed one-sided
exactness of F. This completes the proof.
□
Before addressing the functoriality of the association in Theorem 4.22, let us
record the corresponding result when the derived functor makes use of injective
resolutions.
Theorem 4.24. Let F : C →C ′ be an additive functor between two good
categories. Suppose that F either is contravariant right exact or is covariant
left exact, and suppose that C has enough injectives. Whenever there are three
modules and two maps in C forming a short exact sequence
0 −→A
ϕ
−→B
ψ
−→C −→0,
then the derived functors of F on the three modules form a long exact sequence
in C ′ as follows:
(a) If F is contravariant and right exact, then the long exact sequence is
0 ←−F(A) ←−F(B) ←−F(C) ←−F1(A) ←−F1(B) ←−F1(C)
←−F2(A) ←−F2(B) ←−F2(C) ←−F3(A) ←−· · · .
(b) If F is covariant and left exact, then the long exact sequence is
0 −→F(A) −→F(B) −→F(C) −→F1(A) −→F1(B) −→F1(C)
−→F2(A) −→F2(B) −→F2(C) −→F3(A) −→· · · .
PROOF. The necessary modiﬁcations to the proof of Theorem 4.22 are fairly
straightforward, but some comments are in order concerning how Lemma 4.23 is
to be modiﬁed. In the diagram in the statement of Lemma 4.23, all the horizontal
arrowsaretobereversed, theprojectives PA and PC aretobereplacedbyinjectives
10A split exact sequence is the union of two four-term exact sequences from each end, and F is
exact on each of these. In addition, we saw in Section 2 that F respects direct sums. It follows that
F carries split exact sequences to split exact sequences.

6. Long Exact Sequences of Derived Functors
215
IA and IC, and MA and MC are the quotients MA = IA/εA(A) and MC =
IC/εC(C). Let us deﬁne εB. Since IA is injective, choose h : B →IA with
hϕ = εA, and put εB(b) = (h(b), εCψ(b)). Then the equation
εBϕ(a) = (hϕa, εCψϕa) = (εA(a), 0) = i AεA(a)
says that the upper left square commutes, and the equation
εCψ(b) = pC(h(b), εCψ(b)) = pCεB(b)
says that the lower left square commutes.
To see that εB is one-one, let εB(b) = 0. Then 0 = pCεB(b) = εCψ(b).
Since εC is one-one, ψ(b) = 0, b lies in ker ψ = image ϕ, and b = ϕ(a). Then
0 = εB(b) = εBϕ(a) = i AεA(a), and a = 0 because i A and εA are one-one.
Hence b = ϕ(a) = 0, and εB is one-one.
Let MB = (IA ⊕IC)/εB(B), and let ψB : IA ⊕IC →MB be the quotient
map. To deﬁne ϕ1, we let ϕ1(m A) = ψB(xA, 0) if m A = ψAxA with xA ∈IA.
If x′
A is another preimage of m A under ψ−1
A , then x′
A −xA = εA(a) for some
a ∈A, and ψB(xA, 0) −ψB(x′
A, 0) = ψBi AεA(a) = ψBεBϕ(a) = 0; hence
ϕ1 is well deﬁned.
Since ψBi AxA = ψB(xA, 0) = ϕ1m A = ϕ1ψAxA, the
upper right square commutes. To deﬁne ψ1, let m B ∈MB be ψB(xA, xC), and
deﬁne ψ1(m B) = ψC(xC). If (x′
A, x′
C) is another preimage of m B under ψ−1
B ,
then (x′
A, x′
C) −(xA, xC) = εB(b) for some b ∈B, and ψC(x′
C) −ψC(xC) =
ψC pC(x′
A, x′
C) −ψC pC(xA, xC) = ψC pCεB(b) = ψCεCψ(b) = 0; hence ψ1 is
well deﬁned. Since ψC pC(xA, xC) = ψC(xC) = ψ1(m B) = ψ1ψB(xA, xC), the
lower right square commutes.
Now all the squares commute, and all the rows and columns are exact except
possibly the third column. Corollary 4.8 allows us to conclude that the third
column is exact, and the proof of the analog of Lemma 4.23 for injectives is
complete. Theorem 4.24 then follows routinely.
□
Theorem 4.25. Let F : C →C ′ be an additive functor between two good
categories. Suppose that F either is covariant right exact or is contravariant left
exact, and suppose that C has enough projectives. Then the passage as in Theorem
4.22 from short exact sequences in C to long exact sequences of derived functor
modules in C ′ is functorial in the following sense: whenever
0 −→A
ϕ
−→B
ψ
−→
C −→0
f A
⏐⏐+
fB
⏐⏐+
fC
⏐⏐+
0 −→A
ϕ
−→B
ψ
−→C −→0

216
IV. Homological Algebra
is a diagram in C with exact rows and commuting squares, then the long exact
sequences of derived functors of F on A, B, 
C and A, B, C make commutative
squares with the maps induced by the derived functors on f A, fB, fC.
PROOF. The proof of Theorem 4.22 involved constructing a diagram
0
0
0
0
⏐+
⏐+
⏐+
⏐+
0 ←−−A
εA
←−−
X0
α0
←−−
X1
α1
←−−
X2
←−−· · ·
ϕ
⏐⏐+
iX0
⏐⏐+
iX1
⏐⏐+
iX2
⏐⏐+
0 ←−−B
εB
←−−X0 ⊕Z0
β0
←−−X1 ⊕Z1
β1
←−−X2 ⊕Z2 ←−−· · ·
ψ
⏐⏐+
pZ0
⏐⏐+
pZ1
⏐⏐+
pZ2
⏐⏐+
0 ←−−C
εC
←−−
Z0
γ0
←−−
Z1
γ1
←−−
Z2
←−−· · ·
⏐+
⏐+
⏐+
⏐+
0
0
0
0
with exact rows and commuting squares in which each Xn and Zn is projective,
and a similar diagram corresponds to the given short exact sequence with tildes
on it. The present theorem will follow from the functoriality in Theorem 4.10
if we can arrange that these two diagrams can be embedded in a 3-dimensional
diagram with each of these diagrams in a horizontal plane and with vertical maps
from the one diagram to the other such that all vertical squares commute.
We are given vertical maps f A, fB, and fC, which we can regard as extending
from the diagram with tildes to the other diagram. In addition, Theorem 4.12
gives us chain maps { fXn} and { fZn} with fX−1 = f A and fX−1 = fC, and all the
completed vertical squares in the 3-dimensional diagram commute. To complete
the proof, we construct by induction for n ≥0 a map fn : Xn ⊕Zn →Xn ⊕Zn
such that
pZn fn = fZn pZn,
fni Xn = iXn fXn,
βn−1 fn = fn−1βn−1,
(∗)
with the understanding that β−1 = εB. To make it possible for the inductive step
to include the starting step of the induction, let us write X−1 = A, Z−1 = B,
iX−1 = ϕ, pZ−1 = ψ, α−1 = εA, γ−1 = εC, and f−1 = fB. Also, let us
understand any module or map with subscript −2 to be 0.

6. Long Exact Sequences of Derived Functors
217
We shall construct fn.
For z ∈Zn, we apply pZn−1 to the difference
βn−1(0, fZnz) −fn−1βn−1(0,z) and get
pZn−1βn−1(0, fZnz) −pZn−1 fn−1βn−1(0,z)
= γn−1 pZn(0, fZnz) −fZn−1 pZn−1βn−1(0,z)
= γn−1 fZnz −fZn−1γn−1 pZn(0,z)
= fZn−1γn−1z −fZn−1γn−1z = 0.
Thus βn−1(0, fZnz) −fn−1βn−1(0,z) = iXn−1(x) for a unique x ∈Xn−1, and we
deﬁne τ : Zn →Xn−1 by saying that τ(z) should be this x. This makes
iXn−1τ(z) = βn−1(0, fZnz) −fn−1βn−1(0,z).
Setting up the diagram
Zn⏐⏐+τ
Xn−2
αn−2
←−−−Xn−1
αn−1
←−−−Xn
σ
we prepare to invoke Lemma 4.11. We have
iXn−2αn−2τ(z) = βn−2iXn−1τ(z) = βn−2βn−1(0, fZnz) −βn−2 fn−1βn−1(0,z)
= 0 −fn−2βn−2βn−1(0,z) = 0.
Since iXn−2 is one-one, αn−2τ = 0, and Lemma 4.11 applies. Thus we obtain
σ : Zn →Xn with αn−1σ = τ, and σ satisﬁes
iXn−1αn−1σ(z) = βn−1(0, fZnz) −fn−1βn−1(0,z).
(∗∗)
Deﬁne
fn(x,z) = ( fXn(x) −σ(z), fZn(z)).
(†)
With fn deﬁned, we are to prove the three formulas (∗). For the ﬁrst formula
in (∗), we apply pZn to both sides of (†) and obtain pZn fn(x,z) = fZn(z) =
fZn pZn(x,z), which is the desired formula. The second formula in (∗) atx is just
(†) withz = 0.
We are left with proving the third formula in (∗). Using the second formula in
(∗), we have
βn−1 fn(x, 0) = βn−1 fni Xn(x) = βn−1iXn fXn(x)
= iXn−1αn−1 fXn(x) = iXn−1 fXn−1αn−1(x)
= fn−1i Xn−1αn−1(x) = fn−1βn−1i Xn(x)
= fn−1βn−1(x, 0).
(††)

218
IV. Homological Algebra
Also,
βn−1 fn(0,z) = −βn−1iXnσ(z) + βn−1(0, fZn(z))
by (†)
= −iXn−1αn−1σ(z) + βn−1(0, fZn(z))
by commutativity
= fn−1βn−1(0,z)
by (∗∗).
Adding this equality and (††), we obtain the third formula of (∗). This completes
the proof.
□
The version of Theorem 4.25 appropriate for Theorem 4.24 is the following,
and its proof is similar.
Theorem 4.26. Let F : C →C ′ be an additive functor between two good
categories. Suppose that F either is contravariant right exact or is covariant left
exact, and suppose that C has enough injectives. Then the passage as in Theorem
4.24 from short exact sequences in C to long exact sequences of derived functor
modules in C ′ is functorial in the following sense: whenever
0 −→A
ϕ
−→B
ψ
−→
C −→0
f A
⏐⏐+
fB
⏐⏐+
fC
⏐⏐+
0 −→A
ϕ
−→B
ψ
−→C −→0
is a diagram in C with exact rows and commuting squares, then the long exact
sequences of derived functors of F on A, B, 
C and A, B, C make commutative
squares with the maps induced by the derived functors on f A, fB, fC.
We come to an important application of the long exact sequences in Theorems
4.22 and 4.24. Projective and injective resolutions make it easy to work with de-
rived functors theoretically, but in practice any computations with them are likely
to be difﬁcult. It is therefore convenient to be able to compute derived functors
from other resolutions than projective and injective ones.11 For deﬁniteness let
us work with the case of a covariant left exact functor in a good category with
11The case of sheaf cohomology illustrates this point well. The present theory extends from
good categories of modules to arbitrary abelian categories along the lines of Section 8 below, and
the cohomology theory of sheaves ﬁts into this more general framework. One additive functor
of interest with sheaves is the “global-sections” functor. Its derived functors can be formed with
injective resolutions, built from “ﬂabby” sheaves, but ﬂabby sheaves as a practical matter are too
big to be useful in computations. In the theory of several complex variables for example, one
approach is to substitute “ﬁne” sheaves in resolutions; these permit computations and fall under the
abelian-category generalization of Theorem 4.27 below.

6. Long Exact Sequences of Derived Functors
219
enough injectives; this is the most important case in applications, and the other
three cases in Figure 4.5 can be handled in similar fashion. Let F : C →C ′ be an
additive functor between good categories that is covariant left exact. A module
M in C is said to be F-acyclic if Fn(M) = 0 for all n ≥1. Every module M
that is injective in C is F-acyclic, since 0 −→M −→M −→0 is an injective
resolution of M from which we can see that Fn(M) = 0 for n ≥1. An F-acyclic
resolution of a module A in C is a resolution X = (A −→X+) in which Xn is
an F-acyclic module for all n ≥0.
Theorem 4.27. Let C and C ′ be two good categories, let F be an additive
functor from C to C ′ that is covariant and left exact, and suppose that C has enough
injectives. If a module A in C has an F-acyclic resolution X = (A −→X+)
and if I = (A −→I +) is any injective resolution of A, then any cochain map
f : X →I with f−1 = 1A induces an isomorphism Fn(A) ∼= H n(F(X)) for
each n ≥0.
REMARKS. Such a cochain map always exists and is unique up to homotopy,
according to Theorem 4.16.
Theorem 4.27 says that the derived functors of
F on any module A can be computed from any F-acyclic resolution of A; it
is not necessary to work only with injective resolutions. The same result as
in the theorem holds with Fn(A) ∼= Hn(F(A)) if F is contravariant and right
exact.
If F is covariant right exact or contravariant left exact and if C has
enough projectives, then any chain map from a projective resolution of A to
an F-acyclic resolution12 induces an isomorphism of the derived functors of A
with the homology or cohomology of F of the F-acyclic resolution.
PROOF. The injective resolution is at our disposal, according to Corollary
4.17. Using the hypothesis that C has enough injectives, choose for each n an
injective Jn containing Xn, let gn : Xn →Jn be the inclusion, and make {Jn}
into an injective resolution of 0 with coboundary maps 0. Then replace I in the
assumptions by I ⊕J and f by ( f, g). The result is that we have reduced the
theorem to the case that f is one-one. Changing notation, we may assume from
the outset that the injective resolution is I = (A −→I +) and that the chain map
f : X →I is one-one in each degree.
Put Yn = In/fn(Xn) = coker fn. The sequence
0 −→Xn
fn
−→In −−→Yn −→0
(∗)
is exact, and Theorem 4.24a shows that the sequence
Fk(In) −→Fk(Yn) −−→Fk+1(Xn)
12For this situation, F-acyclic resolutions are understood to be chain complexes rather than
cochain complexes.

220
IV. Homological Algebra
is exact for every k ≥0. Since In and Xn are F-acyclic for n ≥0, the end terms
are 0 for all k ≥1. Consequently Yn is F-acyclic for all n ≥0.
Referring to (∗) for n and for n + 1, we see that the coboundary map from In
to In+1 induces a compatible coboundary map from Yn to Yn+1. Thus we may
consider Y = (0 −→Y +) as a cochain complex with Y + = {Yn}n≥0. Then the
equations (∗) for all n ≥0, together with the coboundary maps, make
0 −→X
f
−→I −−→Y −→0
(∗∗)
into a short exact sequence of complexes. Since X and I are exact, Corollary 4.8
shows that Y is exact.
If we apply F to the short exact sequence of complexes (∗∗), we obtain a
planar diagram
0 −→F(X)
F( f )
−−−→F(I) −−→F(Y) −→0
(†)
whose rows are the result of applying F to (∗), whose columns are complexes,
and whose squares commutes. As usual we drop the row for n = −1, replacing
it with a row of 0’s. Let us prove that (†) is in fact a short exact sequence of
complexes. In fact, the result of applying F to (∗) is the long exact sequence that
begins
0 −→F(Xn) −→F(In) −→F(Yn) −→F1(Xn).
For n ≥0, Xn is F-acyclic. Thus F1(Xn) = 0, and the exactness for n ≥0
follows. For n ≤−1, the rows of the diagram (†) are 0 and hence are exact. Thus
(†) is a short exact sequence of complexes.
We shall now prove that F(Y) = (0 −→F(Y +)) is exact. Combining this
fact with the exactness of the rows of (†) and applying Corollary 4.8 will then
yield H n(F(X)) ∼= H n(F(I)) for all n ≥0. Since H n(F(I)) = Fn(A), this
step will complete the proof.
To prove that F(Y) = (0 −→F(Y +)) is exact, deﬁne Z0 = Y0 and Zn =
coker(Yn−1 →Yn) for n ≥1. Let dn : Yn →Yn+1 be the coboundary map. For
each n ≥0, the complex
0 −→Yn/ ker dn −→Yn+1 −−→Zn+1 −→0
is exact. Since ker dn = image dn−1 by exactness of Y, we have Yn/ ker dn =
Yn/ image dn−1 = Zn, and thus
0 −→Zn −→Yn+1 −−→Zn+1 −→0
(††)
is exact for all n ≥0.
Let us use (††) to prove the preliminary result that Zn is F-acyclic for all
n ≥0. For n = 0, Z0 = Y0, and Y0 is known to be F-acyclic. Proceeding

6. Long Exact Sequences of Derived Functors
221
inductively, suppose that Zn is known to be F-acyclic. Applying Theorem 4.24a
to (††), we see that
Fk(Yn+1) −→Fk(Zn+1) −−→Fk+1(Zn)
is exact for all n ≥0 and all k ≥0. For n ≥0 and k ≥1, the left end is 0 because
Yn+1 is F-acyclic, and the right end is 0 because Zn is F-acyclic by the inductive
hypothesis. Therefore the middle term is 0, Zn+1 is F-acyclic, and the induction
is complete.
Theorem 4.24a when applied to (††) shows that
0 −→F(Zn) −→F(Yn+1) −−→F(Zn+1) −→F1(Zn)
is exact for all n ≥0, and we now know that the term at the right end is 0.
Therefore
0 −→F(Zn) −→F(Yn+1) −−→F(Zn+1) −→0
(‡)
is exact for all n ≥0.
Now we can prove that the complex
0 −→F(Y0) −→F(Y1) −−→F(Y2) −→F(Y3) −→· · ·
(‡‡)
is exact at each module F(Yn). We know from Section 2 that we can merge two
exact sequences
· · · →F(Yn+1) →F(Zn+1) →0
and
0 →F(Zn+1) →F(Yn+2) →· · ·
into a single exact sequence
· · · −→F(Yn+1) −→F(Yn+2) −→· · · .
Consequently inductive application of (‡) shows that the sequence
0 −→F(Z0) −→F(Y1) −−→F(Y2) −→· · · −→F(Yn+1) −→F(Zn+1) −→0
is exact for each n ≥0. In addition, we know that Z0 = Y0 by deﬁnition.
Therefore (‡‡) is exact at F(Yn) for each n ≥0, and the proof is complete.
□
Theorems 4.22 and 4.24 produce a long exact sequence from one additive
functor and a short exact sequence of modules. Although it may at ﬁrst seem odd
to do so, we can obtain a different long exact sequence by varying the functor
and ﬁxing the module. This result, given as Proposition 4.28 below, will be used
in the next section in analyzing the Ext and Tor functors.

222
IV. Homological Algebra
Let C and C ′ be two good categories, and let F, G, H be three additive functors
from C to C ′. For deﬁniteness, suppose that F, G, H are covariant and right exact.
Suppose that there is a natural transformation S of F into G and there is a natural
transformation T of G into H. We say that the sequence
F
S
−→G
T
−→H
is exact on projectives if for every projective P in C, the sequence
0 −→F(P)
SP
−→G(P)
TP
−→H(P) −→0
is exact. Analogous deﬁnitions are to be made with projectives or injectives for
the three other kinds of derived functors as in Figure 4.5.
Proposition 4.28. Let C and C ′ be two good categories, let F, G, H be three
additive functors from C to C ′, suppose that F, G, H are covariant and right exact,
and suppose that C has enough projectives. If there are natural transformations
S : F →G and T : G →H such that the sequence F
S
−→G
T
−→H is exact
on projectives, then the derived functors of F, G, H on each module A in C form
a long exact sequence
0 ←−H(A) ←−G(A) ←−F(A) ←−H1(A) ←−G1(A) ←−F1(A)
←−H2(A) ←−G2(A) ←−F2(A) ←−H3(A) ←−· · · .
The passage from A to the long exact sequence is functorial in A.
REMARKS. The same long exact sequence and functoriality hold with the
arrows reversed and F and H interchanged if the three functors are contravariant
and left exact. If F, G, H are contravariant and right exact or are covariant and
left exact, then analogous conclusions are valid provided C has enough injectives
and the natural transformations S and T are exact on injectives.
PROOF. If P = (P+ −→A) is a projective resolution of A, then the natural
transformations S and T give us a planar diagram
0
0
0
,⏐
,⏐
,⏐
0 −−→F(P0)
SP0
−−→G(P0)
TP0
−−→H(P0) −−→0
,⏐
,⏐
,⏐
0 −−→F(P1)
SP1
−−→G(P1)
TP1
−−→H(P1) −−→0
,⏐
,⏐
,⏐
...
...
...

7. Ext and Tor
223
in which the columns are complexes, the rows are exact because the sequence
F
S
−→G
T
−→H is exact on projectives, and the squares commute because S
and T are natural transformations. The construction of the long exact sequence
then follows from Theorem 4.7.
For the functoriality, suppose that ϕ : A →A′ is a map between two modules
of C. Let P = (P+ −→A) and P′ = (P′+ −→A) be projective resolutions
of A and A′, and use Theorem 4.12 to extend ϕ to a chain map {ϕn} of P to
P′. Then the planar diagrams as above for P and P′ can be embedded in a
3-dimensional diagram in such a way that the various maps F(ϕn), G(ϕn), and
H(ϕn) connecting the diagram for P to the diagram for P′ make all squares
commute. The functoriality now follows immediately from Theorem 4.10.
□
7. Ext and Tor
In this section we study the derived functors of Hom and tensor product. Although
weshalltreateachascarryingunitalleft R modules, where R isaringwithidentity,
to abelian groups, the theory applies also to more complicated versions of Hom
and tensor product, such as when one of the R modules in question is actually
a bimodule for the rings R and S and the result of Hom or tensor product is an
S module. Problems 9–11 at the end of the chapter address the situation with
bimodules.
WeknowthatHomR(A, B)isacontravariantleftexactfunctorofthe A variable
and a left exact covariant functor of the B variable. Thus we have two initial
choices for inserting resolutions and creating derived functors, namely
Extn
R(A, B) = H n
HomR(P, B)

,
with P = (A ←P+) projective,
and
extn
R(A, B) = H n
HomR(A, I)

,
with I = (B →I +) injective.
Existence of the ﬁrst one depends on having enough projectives in the category
of the A variable, and existence of the second one depends on having enough
injectives in the category of the B variable. Each of these, just as with Hom,
depends on two variables, one in contravariant fashion and the other in covariant
fashion. Thus Ext and ext are not functors of two variables in the strict sense of
our deﬁnitions. Instead, they are examples of “bifunctors,” of which HomR( · , · )
is the prototype, and the main result, Theorem 4.31 below, in essence says that
Ext and ext are naturally isomorphic as bifunctors, provided the ﬁrst domain
category has enough projectives and the second has enough injectives. Among

224
IV. Homological Algebra
other things this natural isomorphism will justify and explain how we were able
to deﬁne cohomology of groups in more than one way.13
In the case of tensor product A ⊗R B, similar remarks apply. Here A is a
unital right R module, and B is a unital left R module. The module A in a natural
way is a unital left Ro module, where Ro is the opposite ring of R, and thus
tensor product is to be regarded as deﬁned on the product of two categories of
left modules just as Hom is. We can regard tensor product as an actual functor in
either variable, and the functor is covariant right exact in both cases. Again we
have two initial choices for inserting resolutions and creating derived functors,
namely
TorR
n (A, B) = H n
P ⊗R B

,
with P = (A ←P+) projective,
and
torR
n (A, B) = H n
A ⊗R P

,
with P′ = (B ←P′+) projective.
These exist if the domain categories have enough projectives. Both Tor and tor
can be considered as covariant functors of two variables, or else as “bifunctors,”
and one can show in the same way as for Ext and ext that Tor and tor are naturally
isomorphic. There is no need to write out the details. It is customary to write Tor
for the common value.
Proposition 4.29. Let C and C ′ be good categories of unital left R modules,
and suppose that C has enough projectives. Then the contravariant left exact
functors HomR( · , B) from C to CZ and their derived functors Extn
R( · , B) have
the following properties:
(a) Whenever 0 →A′ →A →A′′ →0 is a short exact sequence in C, then
there is a corresponding long exact sequence
0 −→HomR(A′′, B) −→HomR(A, B) −→HomR(A′, B)
−→Ext1
R(A′′, B) −→Ext1
R(A, B) −→Ext1
R(A′, B)
−→Ext2
R(A′′, B) −→Ext2
R(A, B) −→Ext2
R(A′, B) →Ext3
R(A′′, B) →· · ·
in CZ for each module B in C ′. The passage from short exact sequences inC to long
exact sequences of derived functor modules in CZ is functorial in its dependence
on the exact sequence in the ﬁrst variable in the sense of Theorem 4.25 and is
natural in the second variable in the sense that if a map η : B →B is given, then
Hom(1, η) deﬁnes a chain map from the long exact sequence for B to the long
exact sequence for B.
13It would add only deﬁnitions to our discussion to say precisely what a general bifunctor is and
what a general natural transformation between bifunctors is, and we shall skip that detail, in effect
incorporating the deﬁnitions into the theorem.

7. Ext and Tor
225
(b) If P is a projective in C and I is an injective in C ′, then Extn
R(P, B) = 0 =
Extn
R(A, I) for all n ≥1 and all modules A in C and B in C ′.
(c) Whenever 0 →B′ →B →B′′ →0 is a short exact sequence in C ′, then
there is a corresponding long exact sequence
0 −→HomR(A, B′) −→HomR(A, B) −→HomR(A, B′′)
−→Ext1
R(A, B′) −→Ext1
R(A, B) −→Ext1
R(A, B′′)
−→Ext2
R(A, B′) −→Ext2
R(A, B) −→Ext2
R(A, B′′) →Ext3
R(A, B′) →· · ·
in CZ for each module A in C. The passage from short exact sequences in C ′ to
long exact sequences of derived functor modules in CZ is functorial in the exact
sequence in the second variable and is natural in the ﬁrst variable in the sense that
if a map η : A →A is given, then Hom(η, 1) deﬁnes a chain map from the long
exact sequence for A to the long exact sequence for A.
REMARKS. The naturality in the B parameter of the construction of the long
exact sequence in (a) implies that Extn
R is a covariant functor of the second variable
for ﬁxed argument of the ﬁrst variable. It implies also that all maps Extn
R(α, 1)
commute with all maps Extn
R(1, β).
PROOF. For (a), Theorem 4.22b gives the exact sequence, and Theorem 4.25
proves the functoriality in the ﬁrst variable. For the naturality in the second
variable, let η : B →B be given. The proof of Theorem 4.22 produces a
short exact sequence of projective resolutions of A′, A, A′′ to which the functor
in that theorem is then applied. We now have two such functors HomR( · , B)
and HomR( · , B), and the maps within each image diagram are all of the form
Hom(α, 1). The two diagrams ﬁt into a 3-dimensional diagram, and the maps
between the two diagrams are of the form Hom(1, η). Since all maps Hom(α, 1)
commute with all maps Hom(1, β), the 3-dimensional diagram is commutative.
The corresponding long exact sequences are then related by a cochain map ac-
cording to Theorem 4.10.
For (b), 0 ←P ←P ←0 is a projective resolution of P, and hence any
derived functor that is deﬁned by projective resolutions is 0 in degree ≥1. In
addition, Proposition 4.19b shows that HomR( · , I) is an exact functor, and hence
its derived functors are 0 in degree ≥1.
For (c), we shall apply Proposition 4.28 in its version for contravariant left exact
functors. Let ϕ : B′ →B and ψ : B →B′′ be the maps in the given short exact
sequence, and let F, G, H be the functors with F(A) = HomR(A, B′), G(A) =
HomR(A, B), H(A) = HomR(A, B′′). Then we have a natural transformation S
of F into G given by SA = Hom(1, ϕ) and a natural transformation T of G into
H given by TA = Hom(1, ψ). Since
0 −→HomR(P, B′)
SP
−→HomR(P, B)
TP
−→HomR(P, B′′) −→0

226
IV. Homological Algebra
is exact by Proposition 4.19a, the sequence
F
S
−→G
T
−→H
is exact on projectives. Proposition 4.28 in its version for contravariant left exact
functors then says that there is a long exact sequence
0 −→F(A) −→G(A) −→H(A) −→F1(A) −→G1(A) −→H1(A)
−→F2(A) −→G2(A) −→H2(A) −→F3(A) −→· · ·
and that the passage to this long exact sequence is functorial in A. This much es-
tablishes the long exact sequence in (c) and the naturality in the A variable. For the
behavior in the second variable with A ﬁxed, suppose that we have a second exact
sequence 0 →B′ →B →B′′ →0 that maps to the given one by a chain map f .
Let F′, G′, H ′ be the functors HomR( · , B′), HomR( · , B), HomR( · , B′′). We
then get two horizontal planar diagrams of the kind in the proof of Proposition
4.28, one for F′, G′, H ′ and one for F, G, H. The maps within each of the
two diagrams are maps in the A variable. The two diagrams embed in a 3-
dimensional diagram with vertical maps HomR(1, f ), and the 3-dimensional
diagram is commutative because all maps Hom(α, 1) commute with all maps
Hom(1, β). Application of Theorem 4.10 then completes the proof of functori-
ality in the exact sequence in the second variable.
□
Proposition 4.30. Let C and C ′ be good categories of unital left R modules,
and suppose that C ′ has enough injectives. Then the covariant left exact func-
tors HomR(A, · ) from C ′ to CZ and their derived functors extn
R(A, · ) have the
following properties:
(a) Whenever 0 →A′ →A →A′′ →0 is a short exact sequence in C, then
there is a corresponding long exact sequence
0 −→HomR(A′′, B) −→HomR(A, B) −→HomR(A′, B)
−→ext1
R(A′′, B) −→ext1
R(A, B) −→ext1
R(A′, B)
−→ext2
R(A′′, B) −→ext2
R(A, B) −→ext2
R(A′, B) →ext3
R(A′′, B) →· · ·
in CZ for each module B in C ′. The passage from short exact sequences inC to long
exact sequences of derived functor modules in CZ is functorial in its dependence
on the exact sequence in the ﬁrst variable and is natural in the second variable in
the sense that if a map η : B →B is given, then Hom(1, η) deﬁnes a chain map
from the long exact sequence for B to the long exact sequence for B.

7. Ext and Tor
227
(b) If P is a projective in C and I is an injective in C ′, then extn
R(P, B) = 0 =
extn
R(A, I) for all n ≥1 and all modules A in C and B in C ′.
(c) Whenever 0 →B′ →B →B′′ →0 is a short exact sequence in C ′, then
there is a corresponding long exact sequence
0 −→HomR(A, B′) −→HomR(A, B) −→HomR(A, B′′)
−→ext1
R(A, B′) −→ext1
R(A, B) −→ext1
R(A, B′′)
−→ext2
R(A, B′) −→ext2
R(A, B) −→ext2
R(A, B′′) →ext3
R(A, B′) →· · ·
in CZ for each module A in C. The passage from short exact sequences in C ′ to
long exact sequences of derived functor modules in CZ is functorial in the exact
sequence in the second variable and is natural in the ﬁrst variable in the sense that
if a map η : A →A is given, then Hom(η, 1) deﬁnes a chain map from the long
exact sequence for A to the long exact sequence for A.
REMARKS. The naturality in the A parameter of the construction of the long
exact sequence in(c)impliesthat extn
R isacontravariant functorofthe ﬁrstvariable
for ﬁxed argument of the second variable. It implies also that all maps extn
R(α, 1)
commute with all maps extn
R(1, β).
PROOF. The proof of (c) is a simple variant of the proof of Proposition 4.29a,
the proof of (b) is a simple variant of the proof of Proposition 4.29b, and the proof
of (a) is a simple variant of the proof of Proposition 4.29c.
□
Propositions4.29and 4.30showthat Ext and ext, asfunctorsofthe ﬁrst variable
and as functors of the second variable, generate the same long exact sequences,
the ﬁrst under the assumption that C has enough projectives and the second under
the assumption that C ′ has enough injectives. Theorem 4.31 will show that Ext
and ext may be treated as equal if both assumptions are satisﬁed. It is customary
therefore to use Ext as the notation in both cases; thus Ext exists if either C has
enough projectives or C ′ has enough injectives. In both cases, Ext has a long
exact sequence in the ﬁrst variable and another long exact sequence in the second
variable.
Theorem 4.31. Let C and C ′ be good categories of unital left R modules,
and suppose that C has enough projectives and C ′ has enough injectives. Then
Extn
R( · , · ) and extn
R( · , · ) are naturally isomorphic from C × C ′ to CZ in the
sense that for each n ≥0 and each pair of modules (A, B) in C × C ′, there exists
an isomorphism T(n,A,B) in HomZ(Extn
R(A, B), extn
R(A, B)) such that if ϕ is in

228
IV. Homological Algebra
HomR(A, A′) and ψ is in HomR(B, B′), then the diagrams
Extn
R(A, B)
T(n,A,B)
−−−−→extn
R(A, B)
Extn(ϕ,1)
,⏐⏐
,⏐⏐extn(ϕ,1)
Extn
R(A′, B)
T(n,A′,B)
−−−−→extn
R(A′, B)
and
Extn
R(A, B)
T(n,A,B)
−−−−→extn
R(A, B)
Extn(1,ψ)
⏐⏐+
⏐⏐+extn(1,ψ)
Extn
R(A, B′)
T(n,A,B′)
−−−−→extn
R(A, B′)
commute.
REMARKS. The reader will be able to observe that a certain part of this proof
amounts to showing that 3-dimensional diagrams in the shape of a cube having
5 faces equal to commuting squares and having suitable hypotheses on the maps
automatically have their sixth face equal to a commuting square. The hypotheses
concerning the faces and the maps come from Propositions 4.29 and 4.30, as well
as induction. We shall not try to abstract a general result of this kind, however.
PROOF. We induct on n for n ≥0. Several steps are involved in the proof, and
we complete all of them for a particular n before going on to n + 1. The steps for
a particular n are
(i) to deﬁne T(n,A,B) in the presence of an injective I and a one-one map
μ : B →I and to observe that T(n,A,B) is an isomorphism,
(ii) to show that the same T(n,A,B) results independently of the choice of I,
(iii) to prove the commutativity of the second diagram in the statement of the
theorem, and
(iv) to prove the commutativity of the ﬁrst diagram in the statement of the
theorem.
The ﬁrst base case of the induction is n = 0, for which we take T(0,A,B) to be the
identity on HomR(A, B). Then (i) through (iv) are immediate.
The other base case of the induction is n = 1. Let (A, B) be given. An
injective I and a one-one map μ : B →I exist as in (i) because C ′ has enough
injectives. Then we have an exact sequence
0 −→B
μ
−→I
ν
−→C −→0
(∗)
in which C = I/μ(B) and ν is the quotient map. We know from Propositions
4.29b and 4.30b that Ext1
R(A, I) = 0 = ext1
R(A, I). Therefore Propositions

7. Ext and Tor
229
4.29c and 4.30c give us exact sequences
HomR(A, I)
Hom(1,ν)
−−−−−→HomR(A, C)
ωE,0
−−−−→Ext1
R(A, B) −−−−→0
and
HomR(A, I)
Hom(1,ν)
−−−−−→HomR(A, C)
ωe,0
−−−−→ext1
R(A, B) −−−−→0
in which ωE,0 and ωe,0 are suitable connecting homomorphisms.
We deﬁne
T(1,A,B) = ωe,0(ωE,0)−1. This deﬁnition is meaningful, since the exactness of the
two sequences gives
(ωE,0)−1(0) = ker ωE,0 = Hom(1, ν)(HomR(A, I)) = ker ωe,0;
by an analogous computation, ωE,0(ωe,0)−1 is a well-deﬁned function, and it is
evidently a two-sided inverse. Thus T(1,A,B) is an isomorphism. This completes
step (i).
In order to be able to handle steps (ii) and (iii) without being repetitive, let a
map ψ : B →B′ be given. For (ii), B′ will be B, and ψ will be the identity on
B. For (iii), B′ and ψ will be general. Given ψ and one-one maps μ : B →I
and μ′ : B′ →I ′, we can form the exact rows and the ﬁrst column of the diagram
0 −−→B
μ
−−→I
ν
−−→C −−→0
ψ
⏐⏐+
f
⏐⏐+
¯f
⏐⏐+
0 −−→B′
μ′
−−→I ′
ν′
−−→C′ −−→0.
(∗∗)
If we think of I and I ′ as extended to injective resolutions, Theorem 4.16 allows
us to ﬁll in a cochain map from the one extension to the other, and the ﬁrst new
step of that cochain map is f . If we deﬁne ¯f = ν′ f ν−1, then ¯f is well deﬁned
because
ν′ f ν−1(0) = ν′ f ker ν = ν′ f image μ
= ν′ f μ(B) = ν′μ′ψ(B) = 0(ψ(B)) = 0,
and the squares of the diagram (∗∗) now commute. Continuing with the effort
to cut down on repetitive arguments, let k ≥1 be an integer that will be 1 when
n = 1 and will be different later in the proof. Applying Proposition 4.29c to (∗∗)
gives us a commuting square
Extk−1
R
(A, C)
ωE,k−1
−−−−→Extk
R(A, B)
Extk−1(1, ¯f )
⏐⏐+
⏐⏐+Extk(1,ψ)
Extk−1
R
(A, C′)
ω′
E,k−1
−−−−→Extk
R(A, B′)
(†)

230
IV. Homological Algebra
for k ≥1, and Proposition 4.30c gives us a similar commuting square for ext for
k ≥1.
For each module in the diagram with Ext when k = 1, there is a map to the
corresponding module in the diagram with ext. These maps are T(k−1,A,C) for
the upper left and T(k−1,A,C′) for the lower left. The maps for the upper right and
lower right depend on the step of the argument.
For step (ii), we are taking B′ = B, and the maps at the right are the two
versions of T(k,A,B), one for the injective I and one for the injective I ′. Let
us call them T(k,A,B) and T ′
(k,A,B). We are to prove that T ′
(k,A,B) Extk(1, ψ) =
extk(1, ψ)T(k,A,B) for ψ = 1. The relevant deﬁnitions are
T(k,A,B) = ω(e,k−1)T(k−1,A,C)ω−1
(E,k−1)
T ′
(k,A,B) = ω′
(e,k−1)T(k−1,A,C′)(ω′
(E,k−1))−1,
and
or equivalently
T(k,A,B)ω(E,k−1) = ω(e,k−1)T(k−1,A,C)
T ′
(k,A,B)ω′
(E,k−1) = ω′
(e,k−1)T(k−1,A,C′).
and
Since T(k−1,A,C) and T(k−1,A,C′) are known inductively to be well deﬁned and to
satisfy (iii), we have extk−1(1, ¯f )T(k−1,A,C) = T(k−1,A,C′) Extk−1(1, ¯f ). Thus
extk(1, ψ)T(k,A,B)ω(E,k−1) = extk(1, ψ)ω(e,k−1)T(k−1,A,C)
= ω′
(e,k−1) extk−1(1, ¯f )T(k−1,A,C) = ω′
(e,k−1)T(k−1,A,C′) Extk−1(1, ¯f )
= T ′
(k,A,B)ω′
(E,k−1) Extk−1(1, ¯f ) = T ′
(k,A,B) Extk(1, ψ)ω(E,k−1).
Since Extk(1, ψ) = 1 and extk(1, ψ) = 1 when ψ = 1, step (ii) follows for
n = 1, i.e., T(k,A,B) is well deﬁned.
For step (iii), we are allowing general B′, and the maps at the right between
the two versions of (†) are the well-deﬁned isomorphisms T(k,A,B) and T(k,A,B′).
We are to prove that T(k,A,B′) Extk(1, ψ) = extk(1, ψ)T(k,A,B). The argument in
the previous paragraph applies if we change T ′
(k,A,B) systematically to T(k,A,B′)
and take into account that ω(E,k−1) is onto, and step (iii) follows for n = 1.
For step (iv), let ϕ : A →A′ be given. The conclusion of Proposition 4.29c
that the dependence is natural in the ﬁrst variable gives us a commuting square
Extk−1
R
(A, C)
ωE,k−1
−−−−→Extk
R(A, B)
Extk−1(ϕ,1)
,⏐⏐
,⏐⏐Extk(ϕ,1)
Extk−1
R
(A′, C)
ω′
E,k−1
−−−−→Extk
R(A′, B)
(††)

7. Ext and Tor
231
for k ≥1 and for suitable connecting homomorphisms ωE,k−1 and ω′
E,k−1, and
Proposition 4.30c gives a similar commuting square for ext for k ≥1. For each
module in the diagram with Ext when k = 1, there is a map to the corresponding
module in the diagram with ext. These maps are T(k−1,A,C) for the upper left,
T(k−1,A′,C) for the lower left, T(k,A,B) for the upper right, and T(k,A′,B) for the lower
right. We are to prove that T(k,A,B) Extk(ϕ, 1) = extk(ϕ, 1)T(k,A′,B). The relevant
deﬁnitions are
T(k,A,B)ω(E,k−1) = ω(e,k−1)T(k−1,A,C)
T(k,A′,B)ω′
(E,k−1) = ω′
(e,k−1)T(k−1,A′,C).
and
Since T(k−1,A,C) and T(k−1,A′,C) are known inductively to satisfy (iv), we have
extk−1(ϕ, 1)T(k−1,A′,C) = T(k−1,A,C) Extk−1(ϕ, 1). Thus
extk(ϕ, 1)T(k,A′,B)ω′
(E,k−1) = extk(ϕ, 1)ω′
(e,k−1)T(k−1,A′,C)
= ω(e,k−1) extk−1(ϕ, 1)T(k−1,A′,C) = ω(e,k−1)T(k−1,A,C) Extk−1(ϕ, 1)
= T(k,A,B)ω(E,k−1) Extk−1(ϕ, 1) = T(k,A,B) Extk(ϕ, 1)ω′
(E,k−1).
Since ω′
(E,k−1) is onto, step (iv) follows for n = 1. This completes the proof for
n = 1.
For the inductive step, suppose that steps (i) through (iv) have been carried out
for some n ≥1. Let us carry out step (i) for stage n + 1. For a given B, we know
from Propositions 4.29b and 4.30b that Extn
R(A, I) = 0 = extn
R(A, I). Hence
Propositions 4.29c and 4.30c give us exact sequences
0 −−−→Extn
R(A, C)
ωE,n
−−−−→Extn+1
R
(A, B) −−−→0
and
0 −−−→extn
R(A, C)
ωe,n
−−−−→extn+1
R
(A, B) −−−→0.
In other words, ωE,n and ωe,n are isomorphisms. If we put
T(n+1,A,B) = ωe,nT(n,A,C)ω−1
E,n,
then T(n+1,A,B) is an isomorphism of Extn+1
R
(A, B) onto extn+1
R
(A, B).
This
completes step (i) for stage n + 1.
We now refer back to our argument for n = 1 and put k = n + 1 throughout.
Tracing matters through, we see that the argument carries out steps (ii) through
(iv) for stage n + 1. This completes the induction and the proof.
□

232
IV. Homological Algebra
8. Abelian Categories
Not all situations in which one wants to apply homological algebra are limited to
good categories of unital left R modules for some ring R. We have mentioned
sheaves as one example, and we shall develop some properties of sheaves in Chap-
ter X. Implicitly we have carried along a second example: all chain complexes
within a good category, with chain maps as morphisms, form a category in which
short exact sequences have remarkable properties, such as those in Theorems 4.7
and 4.10.
A setting to which one can generalize well such basic parts of homological
algebra is that of “abelian categories,” which we deﬁne in this section. It is
advisable not to require that the objects in an abelian category actually be sets
of individual elements; otherwise there is little chance that the notion of abelian
category could be self dual. The morphisms of the category are then effectively
all we have to work with, since a morphism already determines its “domain” and
“range.” If X and Y are objects, then a morphism in Morph(X, Y) need not be a
function, but at least Morph(X, Y) is a set with elements to it. Since objects no
longer have elements, books usually suppress the objects in the discussion to the
point of referring to things like kernels and cokernels as morphisms rather than
objects. It is perhaps more comfortable to think of a kernel as a pair, consisting of
an object and a morphism into another object, rather than just as the embedding
morphism, and we shall follow the more comfortable convention temporarily.
We introduce the notion of “abelian category” in stages. We begin with some
deﬁnitions and remarks that make sense in a general category. First of all, let
us have names for X and Y when referring to morphisms in Morph(X, Y) that
do not require us to think in terms of functions. The convention is that if u is
in Morph(X, Y), then X is the domain of u and Y is the codomain. We allow
ourselves to write compositions of morphisms as g f or as g ◦f .
Next, it is possible to generalize usefully the notions of “one-one” and “onto” to
make them applicable in any category. The deﬁnitions are in terms of cancellation
laws. In the category C, a morphism u ∈Morph(X, Y) is a monomorphism14 if
for any f and g in the same set Morph(W, X) such that u f = ug, it follows that
f = g. Any isomorphism is certainly a monomorphism. The composition of two
monomorphisms is a monomorphism. In fact, if u and v are monomorphisms
with vu f = vug, then u f = ug because v is a monomorphism, and f = g
because u is a monomorphism. If m is a monomorphism in Morph(X, Y) and u
is any morphism in Morph(Y, X) such that mu = 1Y, then m is an isomorphism.
In fact, mu = 1Y implies mum = 1Ym = m, which implies um = 1X, since m
is a monomorphism; therefore u is a two-sided inverse to m.
14Some authors use the word “monic” or the word “mono” as an adjectival form of this noun.

8. Abelian Categories
233
The morphism u ∈Morph(X, Y) is an epimorphism15 if for any f ′ and g′
in the same set Morph(Y, Z) such that f ′u = g′u, it follows that f ′ = g′. Any
isomorphism is an epimorphism. The composition of two epimorphisms is an
epimorphism. If e is an epimorphism in Morph(X, Y) and u is any morphism in
Morph(Y, X) such that ue = 1X, then e is an isomorphism.
Finally a zero object 0 in a category C is an object such that for each X in
Obj(C ), each of Morph(X, 0) and Morph(0, X) has exactly one member. It is
immediate that any two zero objects are isomorphic: if 0 and 0′ are zero objects,
then Morph(0, 0) and Morph(0′, 0′) each have just one member, which must be 10
and 10′ in the two cases; the composition of the member of Morph(0, 0′) followed
by the member of Morph(0′, 0) must be 10, and the composition in the other order
must be 10′, and the isomorphism of 0 with 0′ has been exhibited.
Suppose that a zero object exists. Since the composition law for morphisms
in C insists that the composite of a member of Morph(X, 0) and a member
of Morph(0, Y) be in Morph(X, Y), it follows that Morph(X, Y) has a distin-
guished member, which we denote by 0XY. This is called the zero morphism of
Morph(X, Y). By associativity it satisﬁes f 0XY = 0X Z for all f ∈Morph(Y, Z)
and 0XY g = 0WY for all g ∈Hom(W, X). Since Morph(0, 0) has just one
element, we have 000 = 10. If X is any other object such that Morph(X, X) has
0X X = 1X, then X is a zero object; in fact, the equalities 0X000X = 000 = 10 and
00X0X0 = 0X X = 1X show that X and 0 are isomorphic.
An additive category C is a category with the following three properties:
(i) C has a zero object,
(ii) the product and the coproduct16 of any two objects in C exists in C,
(iii) each set Morph(X, Y) is an abelian group with the property that the
operation is Z bilinear in the sense that if the operation is + and if f, f ′
are arbitrary in Morph(X, Y) and g, g′ are arbitrary in Morph(Y, Z), then
(g + g′) ◦( f + f ′) = g ◦f + g′ ◦f + g ◦f ′ + g′ ◦f ′
g ◦(−f ) = (−g) ◦f = −(g ◦f ).
and
If C is an additive category, then so is the opposite category C opp; this fact
will enable us to use duality arguments occasionally. We shall henceforth write
Hom(X, Y) in place of Morph(X, Y) for additive categories.
The zero morphism 0XY of Hom(X, Y) is the additive identity 0 of the abelian
group Hom(X, Y).
In fact, 00Y is the additive identity of Hom(0, Y), since
Hom(0, Y) has just one element. Therefore 0XY = 00Y0X0 = (00Y + 00Y)0X0 =
00Y0X0 + 00Y0X0 = 0XY + 0XY, and we obtain 0 = 0XY.
15Some authors use the word “epi” as an adjectival form of this noun.
16These are deﬁned in Section IV.11 of Basic Algebra. They are always unique up to canonical
isomorphism when they exist.

234
IV. Homological Algebra
In an additive category a morphism u in Hom(X, Y) is a monomorphism if
whenever u f = 0 with f in some Hom(W, X), then f = 0; a morphism u in
Hom(X, Y) is an epimorphism if whenever f ′u = 0 with f ′ in some Hom(Y, Z),
then f ′ = 0.
This much structure forces products and coproducts to amount to the same
thing in an additive category. The precise result is as follows.
Proposition 4.32. In an additive category, let (C, pA, pB) be a product of two
objects A and B. Then there exist unique i A ∈Hom(A, C) and iB ∈Hom(B, C)
such that
pAi A = 1A,
pBiB = 1B,
i A pA + iB pB = 1C.
These satisfy pAiB = 0 and pBi A = 0, and (C, i A, iB) is a coproduct of A and B.
REMARKS.
(1) Since the deﬁning properties of an additive category are self dual, any
coproduct has a similar structure and becomes a product. The proof in effect will
show more—that whenever there are data A, B, C, i A, iB, pA, pB satisfying the
displayed identities, then (C, pA, pB) is a product of A and B, and (C, i A, iB) is
a coproduct. Thus a product/coproduct can be recognized without reference to
other objects in the category.
(2) To emphasize the analogy with modules or vector spaces, we write A ⊕B
for a product or coproduct of A and B in C and call it the direct sum of A and
B. The notation is understood to carry the morphisms i A, iB, pA, pB along with
it. The direct sum is unique up to an isomorphism that carries the one set of
morphisms i A, iB, pA, pB to the other.
PROOF. To the pair 1A ∈Hom(A, A) and 0 ∈Hom(A, B), the product C
associates a unique i A ∈Hom(A, C) with pAi A = 1A and pBi A = 0. Similarly
the coproduct associates a unique iB ∈Hom(B, C) with pAiB = 0 and pBiB =
1B. Computing with the aid of the Z bilinearity and associativity, we have
pA(i A pA + iB pB) = 1A pA + 0pB = pA
pB(i A pA + iB pB) = 0pA + 1B pB = pB.
and
Therefore h = i A pA + iB pB is a member of Hom(C, C) with the property that
pAh = pA and pBh = pB. Since 1C is another member of Hom(C, C) with this
property, the assumed uniqueness shows that h = 1C. This proves the displayed
formulas in the proposition and the formulas pAiB = 0 and pBi A = 0.
For uniqueness of i A and iB, suppose that i′
A and i′
B satisfy i′
A pA +i′
B pB = 1C.
Right multiplication by i A gives i A = 1Ci A = (i′
A pA +i′
B pB)i A = i′
A1A +i′
B0 =
i′
A, and similarly iB = i′
B.

8. Abelian Categories
235
To see that (C, i A, iB) is a coproduct of A and B, let f ∈Hom(A, X) and
g ∈Hom(B, X) be given, and deﬁne h = f pA +gpB. This is in Hom(C, X), has
hi A = f pAi A + gpBi A = f 1A = f , and similarly has hiB = g. For uniqueness
suppose that k is in Hom(C, X) with ki A = f and kiB = g. Then kiA pA = f pA
and kiB pB = gpB. Addition gives
k = k1C = k(i A pA + iB pB) = f pA + gpB = h,
and uniqueness is proved.
□
For an additive categoryC, the notions of the kernel and cokernel of a morphism
are deﬁned by universal mapping properties.
Problems 18–22 at the end of
Chapter VI of Basic Algebra discussed universal mapping properties abstractly,
saying what they are in a general context. For current purposes it is enough to
know that what a universal mapping property produces (if it produces anything
at all) is a pair consisting of an object and a morphism, and moreover the pair is
automatically unique (if it exists) up to canonical isomorphism.
We allow ourselves to write morphisms as arrows in any of the customary ways
for functions. Thus a member u of Hom(A, B) may be written as A
u
−→B, and
a composition of u followed by a morphism v ∈Hom(B, C), which has been
written as v ◦u or as vu, may be written as A
u
−→B
v
−→C.
If A
u
−→B is a morphism in the additive category C, then the kernel of u,
denoted by ker u, is a pair (K, i) with i ∈Hom(K, A) such that the composition
K
i
−→A
u
−→B has ui = 0 and such that for any pair (K ′, i′) with i′ in
Hom(K ′, A) for which ui′ = 0, there exists a unique ϕ ∈Hom(K ′, K) with
iϕ = i′. See Figure 4.6. It is customary to drop all mention of K in the deﬁnition
of kernel, saying that the kernel is i, since any mention of i carries along K as the
domain of i; we shall adopt this abbreviated terminology shortly but shall refer
to the pair (K, i) as the kernel for the time being.
K
i
−−−→A
u
−−−→B
K ′
ϕ
i′
FIGURE 4.6. Universal mapping property of a kernel (K, i) of u.
The brief form of the deﬁnition of kernel is that u ◦(ker u) = 0 and
ui′ = 0
implies
i′ = (ker u) ◦ϕ uniquely.
The kernel of u is determined only up to an isomorphism applied to K; that is, i
is determined only up to right multiplication by an isomorphism. The condition

236
IV. Homological Algebra
for (K, i) to be a kernel is equivalent to the exactness of the sequence of abelian
groups
0 −−−→Hom(K ′, K)
i◦( · )
−−−→Hom(K ′, A)
u◦( · )
−−−→Hom(K ′, B).
In fact, ui = 0 makes the sequence a complex, the existence of ϕ produces exact-
ness at Hom(K ′, A), and the uniqueness of ϕ produces exactness at Hom(K ′, K).
Similarly the cokernel of u, denoted by coker u, is a pair (C, p) with p in
Hom(B, C) such that the composition A
u
−→B
p
−→C has pu = 0 and such
that for any pair (C′, p′) with p′ in Hom(B, C′) for which p′u = 0, there exists
a unique ψ ∈Hom(C, C′) with ψp = p′. See Figure 4.7. It is customary to
drop all mention of the object C in the deﬁnition of cokernel, saying that the
cokernel is p, since any mention of p carries along C as the codomain of p; we
shall adopt this abbreviated terminology shortly but shall refer to the pair (C, p)
as the cokernel for the time being.
C
p
←−−−B
u
←−−−A
C′
ψ
p′
FIGURE 4.7. Universal mapping property of a cokernel (C, p) of u.
The brief form of the deﬁnition of cokernel is that (coker u) ◦u = 0 and
p′u = 0
implies
p′ = ψ ◦(coker u) uniquely.
The cokernel of u is determined only up to an isomorphism applied to C; that is, p
is determined only up to left multiplication by an isomorphism. The condition for
(C, p) to be a cokernel is equivalent to the exactness of the sequence of abelian
groups
0 −−−→Hom(C, C′)
( · )◦p
−−−→Hom(B, C′)
( · )◦u
−−−→Hom(A, C′).
In fact, pu = 0 makes the sequence a complex, the existence of ψ produces exact-
ness at Hom(B, C′), and the uniqueness of ψ produces exactness at Hom(C, C′).
Proposition 4.33. Let C be an additive category. If an elementu of Hom(A, B)
has a kernel (K, i) and if m ∈Hom(B, B′) is a monomorphism, then (K, i) is
also a kernel of mu. If u has a cokernel (C, p) and if e ∈Hom(A′, A) is an
epimorphism, then (C, p) is also a cokernel of ue. Brieﬂy
ker(mu) = ker u
and
coker(ue) = coker u.
REMARK. We can safely omit the proof of any dual statement about addi-
tive categories, since the dual follows by expressing the original argument as a
diagram, reversing all the arrows, and writing down the argument that the new
diagram represents.

8. Abelian Categories
237
PROOF. We test whether i = ker u is a kernel of mu. We know that (mu)i =
m(ui) = 0. Suppose that mui′ = 0 with i′ ∈Morph(K ′, A). Since m is a
monomorphism, ui′ = 0. Because i is a kernel of u, we obtain i′ = iϕ for a
unique ϕ ∈Morph(K ′, K). Hence i is a kernel of mu. The statement about
cokernels is dual.
□
Proposition 4.34. Let C be an additive category. If an element u of Hom(A, B)
has a kernel (K, i), then i is a monomorphism. Dually if u has a cokernel (C, p),
then p is an epimorphism.
PROOF.
Suppose that u has a kernel (K, i).
For any object K ′, the zero
morphism i′ = 0 of Hom(K ′, A) has the property that ui′ = 0. The uniqueness
property of the kernel says that the ϕ in Hom(K ′, K) with iϕ = i′ is unique.
Evidently ϕ = 0 is one such choice and hence is the only such choice. Thus if f
in Hom(K ′, K) has i f = 0, then f = 0. Therefore i is a monomorphism.
□
Propositions4.33and 4.34give a ﬁrst hint that the notation(K, i)forthe kernel,
which we know is redundant, may also be inconvenient; it would be far simpler
to refer to the kernel as i, and analogously for cokernels. Then Proposition 4.33
could truly be stated as the displayed formulas in its statement, and Proposition
4.34 would have the tidier statement that every kernel is a monomorphism and
every cokernel is an epimorphism. Let us therefore now allow ourselves to regard
kernels and cokernels as morphisms, rather than pairs consisting of an object and
a morphism. With this convention in place, we always have u ◦(ker u) = 0 and
(coker u) ◦u = 0.
Proposition 4.35. Let C be an additive category, and let u be in Hom(A, B). If
u has a kernel and ker u has a cokernel, then coker(ker u) is a kernel of u. Brieﬂy
ker(coker(ker u)) = ker u.
Dually if u has a cokernel and coker u has a kernel, then
coker(ker(coker u)) = coker u.
PROOF. Let (K, i) be a kernel of u, and let (C, p) be a cokernel of i. We are to
show that i is a kernel of p. For the existence step, suppose that i′ in Hom(K ′, A)
has pi′ = 0. We are to show that i′ factors as i′ = iϕ for some unique ϕ in
Hom(K ′, K). We know that ui = 0. Since p = coker i, u factors as u = ψp for
some ψ in Hom(C, B). Then ui′ = (ψp)i′ = ψ(pi′) = 0. Since i = ker u, i′
factors as i′ = iϕ as required. This proves existence of ϕ.
For the uniqueness step, suppose that pi′ = 0 for some i′ in some Hom(K ′, A).
If i′ were to have two distinct factorizations, say as i′ = iϕ = iϕ, then i could
not be a monomorphism, in contradiction to Proposition 4.34 and the fact that
i = ker u. This proves uniqueness of ϕ.
□

238
IV. Homological Algebra
An abelian category C is an additive category with the following two proper-
ties:
(iv) every morphism has a kernel and a cokernel,
(v) every monomorphism is a kernel, and every epimorphism is a cokernel.
It is evident that the opposite category of any abelian category is abelian. Thus
we can continue to use duality arguments.
Property (iv) is certainly desirable if one wants to have a theory involving ho-
mology and cohomology. Property (v) may be viewed as a converse to Proposition
4.34; some other authors use a different but equivalent formulation of this axiom.
The objective is to have a generalization of the kind of factorization that one has
with homomorphisms of abelian groups: any homomorphism factors canonically
as the product of the canonical passage to the quotient by the kernel, followed by
an isomorphism of this quotient onto the image of the homomorphism, followed
by the inclusion of the image into the range.
Proposition 4.36. In any abelian category, every morphism that is both a
monomorphism and an epimorphism is an isomorphism.
PROOF. If f ∈Hom(K, A) is a monomorphism, then f = ker g for some g
in some Hom(A, B) by (v). This fact implies that g f = g ◦(ker g) = 0. If f
is also an epimorphism, then the equality g f = 0 implies that g = 0. Hence
f = ker 0AB. Taking K ′ = A and i′ = 1A in Figure 4.6, we have 0i′ = 0 and
thus have 1A = f ϕ for some ϕ in Hom(A, K). Thus the monomorphism f has
a right inverse and must be an isomorphism.
□
Lemma 4.37. In an abelian category C, every monomorphism is the kernel of
its cokernel, and every epimorphism is the cokernel of its kernel.
PROOF. If m is a monomorphism, then (v) says that m = ker u for some u. Sub-
stituting into the ﬁrst conclusion of Proposition 4.35, we obtain ker(coker m) =
m. If e is an epimorphism, then (v) says that e = coker u for some u. Substituting
into the second conclusion of Proposition 4.35, we obtain coker(ker e) = e.
□
Proposition 4.38. In an abelian categoryC, any morphism f factors as f = me
for a monomorphism m and an epimorphism e. Here one such factorization is
given by
m = ker(coker f )
and
e = coker(ker f ).
Any other such factorization f = m′e′ has the property that there is some
isomorphism x with e′ = xe and m′x = m.

8. Abelian Categories
239
PROOF. Put m = ker(coker f ). Since (coker f ) f = 0, the brief form of the
deﬁnition of kernel gives f = me for some e. We are going to prove that e is an
epimorphism. Thus suppose that re = 0 for some morphism r. The brief form
of the deﬁnition of kernel shows that e = (kerr)e′ for some morphism e′. Then
we have
f = me = m(kerr)e′ = m′e′,
where m′ = m kerr.
Being a kernel, kerr is a monomorphism. As the composition of two monomor-
phisms, m′ is a monomorphism. Lemma 4.37 shows that m′ = ker p′, where
p′ = coker m′.
Put p = coker m. The deﬁnition of m and the second identity of Proposition
4.35 gives p = coker(ker(coker f )) = coker f . Since m′ = ker p′, we have
p′m′ = 0. Hence p′ f = p′m′e′ = 0. Since p = coker f , the brief form of the
deﬁnition of cokernel shows that p′ = sp for some s. Thus p′m = spm = 0, the
latter equality holding because p = coker m. Since m′ = ker p′, the brief form
of the deﬁnition of kernel gives m = m′t for some t.
Resubstituting for m′ gives m = m′t = m(kerr)t. Since m is a monomor-
phism, we can cancel and obtain 1X = (kerr)t, where X is the codomain of kerr.
In other words, kerr has a right inverse. Being a monomorphism, it must be an
isomorphism. Since any morphism v has v ker v = 0, we obtain r kerr = 0 and
conclude that r = 0. Therefore e is an epimorphism, as asserted.
Since e is an epimorphism, Lemma 4.37 gives e = coker(ker e), and Propo-
sition 4.33 gives ker e = ker(me) = ker f . Therefore e = coker(ker f ). This
completes the proof of existence of the decomposition.
For uniqueness, suppose that f = m′e′ for a monomorphism m′ and an
epimorphism e′. Proposition 4.33 gives ker f = ker(m′e′) = ker e′, as well
as ker f = ker(me) = ker e, the understanding being that these equalities hold
up to an isomorphism on the right. Set u = ker e and u′ = ker e′; then u = u′w
for some isomorphism w. Since e and e′ are epimorphisms, Lemma 4.37 gives
e = coker u and e′ = coker u′. Since m′ is a monomorphism, the equality
0 = f (ker f ) = f u = m′e′u implies that e′u = 0; by the brief form of the
deﬁnition of coker u as a cokernel, e′ factors as e′ = xe for a unique x. Similarly
the equality 0 = f ker f = f u′ = meu implies that eu = 0; by the brief form of
the deﬁnition of coker u′ as a cokernel, e factors as e = x′e′ for a unique x′. Then
e = x′e′ = x′xe; since e is an epimorphism, x′x is the identity on its domain.
Similarly e′ = xe = xx′e′, and it follows that xx′ is the identity on its domain.
Consequently x is an isomorphism. Multiplying e′ = xe by m′ on the left gives
me = f = m′e′ = m′xe; since e is an epimorphism, m = m′x. This completes
the proof.
□
With this canonical factorization in hand, we introduce two terms that will

240
IV. Homological Algebra
simplify the deﬁnition of “exact sequence.” We deﬁne the image and coimage
of f = me in Hom(A, B) by
m = image f
and
e = coimage f.
Inwords, theimageofanymorphismisitsmonomorphismfactor, andthecoimage
is its epimorphism factor; in particular, a monomorphism is its own image, and
an epimorphism is its own coimage.17 Let us see what the factorization and these
formulas say in terms of diagrams. We write (K, i) for the kernel of f and (C, p)
for the cokernel of f . Let I be the codomain of e, which equals the domain of
m. In terms of a diagram, the situation for f is then given by
K
i = ker e
−−−−−→
= ker f
A
e = coker i
−−−−−−−→
= coimage f
I
m = ker p
−−−−−−→
= image f
B
p = coker m
−−−−−−−→
= coker f
C.
The top row of labels explains the relationships among i, e, m, p, and the bottom
row of labels relates i, e, m, p to f . The morphism f itself is the composition of
the two morphisms in the center.
In a good category of modules, we can interpret this diagram in terms of the
two short exact sequences
0 −−−→
K
i
−−−→A
e
−−−→A/ image i −−−→0,
0 −−−→A/ image i
m
−−−→B
p
−−−→
C
−−−→0,
which we can merge into a single 6-term exact sequence
0 −−−→K
i
−−−→A
me= f
−−−→B
p
−−−→C −−−→0.
Now we can deﬁne complexes and exact sequences for abelian categories, and
we can readily check that the new deﬁnitions are consistent with the deﬁnitions
for good categories of modules. A chain complex is a doubly inﬁnite sequence of
morphisms with decreasing indexing such that the consecutive compositions are
deﬁned and are 0. If f ∈Hom(A, B) and g ∈Hom(B, C) are given morphisms,
then the sequence
A
f
−−−→B
g
−−−→C
is exact at B if image f = ker g, or equivalently if coker f = coimage g. As
usual in the subject of abelian categories, the equality sign here means “can be
taken as.” In more detail if f and g decompose as f = me and g = m′e′, image f
is deﬁned to be m, and ker g equals ker e′. Thus the condition for exactness is
17The term “coimage” is not really needed for recognizing exact sequences, but it makes any
implementation of duality more symmetric.

8. Abelian Categories
241
that m be a kernel of e′. Since u(ker u) = 0 for any morphism u, exactness at
B implies that e′m = 0. Then g f = m′e′me = 0, and we see that the given
sequence (when extended by 0’s at each end) is a complex.
Exactness of any ﬁnite or inﬁnite sequence of morphisms whose consecutive
compositions are deﬁned means exactness at every object X in the sequence
for which there is an incoming morphism in some Hom(W, X) and there is an
outgoing morphism in some Hom(X, Y). With the kind of indexing used for a
chain complex, a sequence
· · · −−−→Xn+1
mnen
−−−→Xn
mn−1en−1
−−−−−→Xn−1 −−−→· · ·
is exact if mn = ker en−1, or equivalently if en−1 = coker mn, for all n.
For a sequence of four morphisms of the form
0 −−−→K
m
−−−→A
e
−−−→C −−−→0,
exactness means exactness at K, A, and C.
The conditions are that m is a
monomorphism, e is an epimorphism, and m = ker e (or equivalently that e =
coker m). In this case the sequence is called a short exact sequence.
One can now proceed to deﬁne projectives and injectives for any abelian
category as certain objects in the same way as in Figures 4.3 and 4.4, and extend
all the results of earlier sections of this chapter to all abelian categories. We shall
not carry out this detail.18
Instead, we shall indicate an approach to carrying out this detail that takes most
of the difﬁculty out of translating results from the context of good categories to
the context of abelian categories. It is to use the notion of “members.” The
word “members” in the present setting refers to something that substitutes for
elements in situations in which objects need not necessarily be sets of elements.
The idea is to recast elements, when they exist, in terms of morphisms and then
to generalize the resulting deﬁnition. For orientation, consider the category CR
of all unital left R modules, R being a ring with identity. Let us write R0 for
the left R module R. The elements of a unital left R module X are then in
one-one correspondence with the R homomorphisms of R0 into X, the element
x corresponding to the homomorphism that carries r to rx. Thus the category
CR has a distinguished object R0 such that the elements of any object X are in
one-one correspondence with Hom(R0, X). Hence any argument about elements
for this category immediately translates into an argument about morphisms.
The trouble is that a general abelian category has no distinguished object to play
the role of R0. The idea for getting around this difﬁculty is to take all possible
18The entire theory for abelian categories is carried out in detail in Freyd’s book Abelian Cate-
gories: An Introduction to the Theory of Functors.

242
IV. Homological Algebra
objects X0 in place of R0, consider the union on X0 of all sets Hom(X0, X),
introduce an equivalence relation, and hope for the best.
The deﬁnition is as follows. Let C be an abelian category, ﬁx X in Obj(C ),
and consider all morphisms with codomain X. Two such morphisms x and y are
said to be equivalent morphisms for current purposes, written x ≡y, if there
exist epimorphisms u and v such that xu = yv. It is evident that “equivalent”
is reﬂexive and symmetric. Transitivity requires proof, and we return to this
matter in a moment. Once ≡has been shown to be an equivalence relation, an
equivalence class of such morphisms is called a member of X. We write x ∈m X
to indicate that x is a morphism with codomain X, hence to indicate that x is a
morphism whose equivalence class is a member of X. To avoid clumsy wording
when there is really no possibility of confusion, we often simply say that x is
a member of X. The question arises whether this deﬁnition presents any set-
theoretic difﬁculties. As usual in category theory, one can answer the question
painlessly by working when necessary only with subcategories for which the
objects actually form a set; in this case, the union over all objects X and Y in the
subcategory of all the groups Hom(X, Y) of morphisms is a set, and there is no
problem. Let us return to a special case of our example.
EXAMPLE OF MEMBERS. Let C = CZ be the category of all abelian groups, and
ﬁx an abelian group X. If x is an abelian-group homomorphism with codomain
X, let us use Proposition 4.38 to write x = me for a monomorphism m and
an epimorphism e. Then x ≡m, and thus we might just as well consider only
one-one homomorphisms into X. If H is the image of x, then we can view
x as a composition x = iH y of a homomorphism y carrying the domain of x
onto H, followed by the inclusion iH : H →X. The homomorphism y is an
isomorphism, hence is an epimorphism. Thus x ≡iH. It is apparent that no
two inclusions of subgroups of X into X are equivalent morphisms. Since every
inclusion of a subgroup of X into X yields a member of X, the members of
X are exactly the subgroups of X. Thus for example the set of members of Z
corresponds to the set of integers ≥0, in which addition is lost, and does not
correspond exactly to the set of elements of Z. This fact is a little discouraging,
but it turns out not to be as bad an omen as one might expect.
Returning to the setting of a general abelian category, we work toward a proof
that ≡is an equivalence relation. We need the notion of the “pullback” of two
morphisms, which we deﬁne by a universal mapping property momentarily. The
appropriate construction establishing existence appears in the next proposition.
Then we prove a proposition for using pullback as a tool, and afterward we prove
the transitivity.
In an abelian category C, let X, Y, Z be objects, and let f ∈Hom(Y, Z)
and g ∈Hom(X, Z) be morphisms. A pullback of the pair ( f, g) is a triple

8. Abelian Categories
243
(W, f ,g) in which W is an object in C, in which f and g are morphisms with
f ∈Hom(W, Y) and g ∈Hom(W, X), and in which the following universal
mapping property holds: whenever (W ′, f ′,g′) is a triple such that W ′ is an object
in C and f ′ and g′ are morphisms with f ′ ∈Hom(W ′, Y) and g′ ∈Hom(W ′, X)
and with f g′ = g f ′, then there exists a unique ϕ ∈Hom(W ′, W) such that
f ′ = f ϕ and g′ = gϕ. See Figure 4.8.
W
Y
⏐⏐+g
X
f
−−−→Z
g
f
FIGURE 4.8. The pullback of a pair ( f, g) of morphisms.
Proposition 4.39. In an abelian category C, let X, Y, Z be objects, and let
f ∈Hom(X, Z) and g ∈Hom(Y, Z) be morphisms. Let X ⊕Y be the direct
sum, let pX and pY be the projections on the two factors, deﬁne h = f pX −gpY
in Hom(X ⊕Y, Z), and let m = ker h. Then a pullback (W, f ,g) of ( f, g) is
given by W = domain m, f = pYm, and g = pXm.
REMARKS. The dual statement asserts the existence of a pushout of a pair
of morphisms, and it is a consequence of Proposition 4.39. Problem 35 at the
end of the chapter points out that the proof of Proposition 4.19a made use of a
concretely constructed pullback, while the proof of Proposition 4.19b made use
of a concretely constructed pushout.
PROOF. From hm = h ker h = 0, we obtain 0 = f pXm −gpYm = f g −g f ,
and thus f g = g f . Now suppose that W ′, f ′, and g′ are given with f g′ =
g f ′. Then m′ = (g′, f ′) is a morphism in Hom(W ′, X ⊕Y) such that hm′ =
f pXm′ −gpYm′ = f g′ −g f ′ = 0. Therefore m′ factors through m = ker h as
(g′, f ′) = mϕ for a unique ϕ ∈Hom(W ′, W). Application of pX and pY to this
equality gives g′ = pXmϕ = gϕ and f ′ = pYmϕ = f ϕ.
□
Proposition 4.40. In the notation of Figure 4.8 and Proposition 4.39 if f is a
monomorphism, then so is f . If f is an epimorphism, then so is f ; in the case
of an epimorphism, ker f factors as ker f = g(ker f ).
PROOF. Throughout the proof let iX and iY be the injections associated with the
direct sum X ⊕Y. Suppose that f is a monomorphism, and suppose that f w = 0
for some morphism with codomain W. Since f = pYm, pYmw = 0. Then
0 = ( f pX −gpY)mw = f pXmw −0 = f pXmw. Since f is a monomorphism,
pXmw = 0. Sincealso f w = pYmw = 0, mw = (iX pX+iY pY)mw = 0. Butm
is a monomorphism, and therefore w = 0. Consequently f is a monomorphism.
For the remainder of the proof, assume that f is an epimorphism. Let us

244
IV. Homological Algebra
see that h = f pX −gpY is an epimorphism. In fact, if zh = 0, then 0 =
z( f pX −gpY)iX = zf pXiX = zf . Since f is an epimorphism, z = 0. Thus h is
an epimorphism.
It follows from Lemma 4.37 that h = coker(ker h) = coker m. To prove that
f is an epimorphism, suppose that v f = 0 for some morphism v with domain
Y. This means that vpYm = 0. Since h is the cokernel of m, vpY factors as
vpY = v′h for some morphism v′. Applying iX on the right end of both sides
gives 0 = vpYiX = v′hiX = v′( f pX −gpY)iX = v′ f pXiX = v′ f . Since f is
an epimorphism, v′ = 0. Hence vpY = v′h = 0. Since pY is an epimorphism,
v = 0. Therefore f is an epimorphism.
Now set k = ker f , and let K be its domain. The morphisms k ∈Hom(K, X)
and 0 ∈Hom(K, Y) have f k = 0 = g0. If we set W ′ = K, f ′ = 0, and g′ = k,
then f g′ = g f ′, and Proposition 4.39 produces a unique ϕ in Hom(K, W) with
0 = f ϕ and k = gϕ. We shall show that ϕ is a kernel of f , and then the equation
k = gϕ completes the proof.
We know that f ϕ = 0. Thus suppose that f v = 0 for some morphism v in
some Hom(K ′, W). Since f g = g f , we have f gv = g f v = 0. Thus gv factors
through k = ker f as gv = kv′ for some v′ in Hom(K ′, K).
Put  = v −ϕv′. Then f  = f v −f ϕv′ = 0 −0 = 0, and g =
gv −gϕv′ = kv′ −kv′ = 0. Consequently if we put W ′′ = K ′, f ′′ = 0, and
g′′ = 0, then  and 0 are two morphisms in Hom(K ′, W) with f ′′ = f  = f 0
and g′′ = g = f 0. By uniqueness of the morphism in the universal mapping
property for pullbacks,  = 0. Therefore v = ϕv′, and v has been exhibited as
factoring through ϕ.
If v factors through ϕ also as v = ϕv′′, then 0 = ϕ(v′ −v′′), and we have
k(v′ −v′′) = gϕ(v′ −v′′) = 0. Since k = ker f is a monomorphism, v′ = v′′.
Thus the factorization of v through ϕ is unique, and ϕ is a kernel of f . This
completes the proof.
□
Proposition 4.41.
Let C be an abelian category, let X be an object in C,
and deﬁne x ≡y for two morphisms x and y with codomain X if there exist
epimorphisms u and v with xu = yv. Then the relation ≡on the morphisms
with codomain X is transitive and hence is an equivalence relation.
REMARK. A nontrivial special case is that the obvious equivalences xu ≡x
and x ≡xv imply the nonobvious equivalence xu ≡xv when u and v are
epimorphisms.
PROOF. Assuming that x ≡y and y ≡z, write xu = yv and yr = zs
for epimorphisms u, v,r, s. Since v and r have the same codomain, namely
domain(y), the pullback (v,r) of (v,r) as in Proposition 4.39 is well deﬁned,
and Proposition 4.40 shows that v and r are epimorphisms. Since rv = vr, we

8. Abelian Categories
245
obtain xur = yvr = yrv = zsv. The morphisms ur and sv are epimorphisms
as compositions of epimorphisms, and therefore x ≡z.
□
Fix an object X. Then 00X is a member of X called the zero member, denoted
by 0. Every zero morphism 0Y X with codomain X is equivalent to 00X; in fact,
0Y X = 00X0Y0. The morphism 0Y0 is an epimorphism because if f ∈Hom(0, Z)
has f 0Y0 = 0Y Z, then f is the unique element 00Z of Hom(0, Z). Conversely
any nonzero morphism r in Hom(Y, X) is inequivalent to 0Y X. In fact, an equality
ru = 0Y Xv for epimorphisms u and v would imply that r = 0Y X, since we can
cancel in the equality ru = 0Y Xv = 0Y Xu.
Each x ∈m X has a “negative,” namely the class of the negative of the repre-
sentative x of the member; i.e., taking the negative of a morphism is respected
in passing to classes. We write −x ∈m X for the negative. (Warning:
As
the example with the category of abelian groups shows, one should use care in
inferring any relationship between “negatives” and zero members.)
If f is a morphism in Hom(X, Y), then each member x ∈m X yields by
composition a well-deﬁned member f x ∈m Y. To see that this notion is indeed
well deﬁned, suppose that x ≡x′, and choose epimorphisms u and v with
xu = x′v. Then ( f x)u = f (xu) = f (x′v) = ( f x′)v shows that f x ≡f x′.
The main result is Theorem 4.42 below, which gives a calculus for diagram
chases using members in general abelian categories. After the proof we shall be
content with one example of how the theorem allows all the diagram chases in
earlier sections of this chapter to be extended to general abelian categories. The
example is the proof of the part of the Snake Lemma that involves an explicit
construction.19
More examples appear in Problems 34–35 at the end of the
chapter.
Theorem 4.42. The members of an abelian category satisfy the following
properties:
(a) a morphism f ∈Hom(X, Y) is a monomorphism if and only if every
x ∈m X with f x ≡0 has x ≡0,
(b) a morphism f ∈Hom(X, Y) is a monomorphism if and only if every pair
of members x ∈m X and x′ ∈m X with f x ≡f x′ has x ≡x′,
(c) a morphism g ∈Hom(X, Y) is an epimorphism if and only if for each
y ∈m Y, there exists some x ∈m X with gx ≡y,
(d) a morphism h ∈Hom(X, Y) is the 0 morphism if and only if every
x ∈m X has hx ≡0,
(e) a sequence X
f
−→Y
g
−→Z is exact at Y if and only if g f = 0 and also
each y ∈m Y with gy ≡0 has some x ∈m X with f x ≡y,
19For more detail about this example and for further examples, see Mac Lane’s Categories for
the Working Mathematician.

246
IV. Homological Algebra
(f) whenever x, y, z are members of an object X and x ≡yu + zv for some
epimorphisms u and v, then xu′ −yv′ ≡z for some epimorphisms u′
and v′.
REMARKS.
(1) The interpretations of (a) through (e) are straightforward enough and
already give an indication that the notion of a member may be of some help
in translating proofs for good categories into proofs for abelian categories. Ap-
plication of (d) to the difference f1 −f2 of two morphisms in Hom(X, Y) shows
that f1x ≡f2x for all x ∈m X implies f1 = f2.
(2) The interpretation of (f) is more subtle. As the example with the Snake
Lemma below will show, conclusion (f) makes it possible to mirror in the theory
of members the kind of subtraction that takes place with elements of a module to
get their difference to be in the kernel of some homomorphism.
PROOF. For (a) and (b), if f is a monomorphism and f x ≡f x′, then f xu =
f x′v for suitable epimorphisms u and v, and cancellation yields xu = x′v and
hence x ≡x′. Conversely suppose f x ≡0 only for x ≡0. If f has f x′ = 0AY
for some x′ in some Hom(A, X), then f x′ ≡0 and so x′ ≡0 by hypothesis. In
this case, x′ = 0AX because we know that nonzero morphisms are not equivalent
to 0.
For (c), suppose that g is an epimorphism. If y ∈m Y is given, let y be
in Hom(X′, Y), and let (g,y) be the pullback of (g, y), satisfying yg = gy.
Proposition 4.40 shows that g is an epimorphism, and then y ≡gx for x = y.
Conversely if g fails to be an epimorphism, then there exists r ̸= 0 in some
Hom(Y, Z) withrg = 0X Z. If there is some x in some Hom(A, X) with gx ≡1Y,
we can compose with r on the left of both sides and obtain rgx ≡r1Y = r. Since
the left side equals 0AZ, which is equivalent to 0Y Z, we obtain 0Y Z ≡0AZ ≡r,
which we know not to be true for nonzero members r of Hom(Y, Z).
For (d), if h = 0XY and if x is in Hom(Z, X), then hx = 0XY x = 0ZY ≡00Y.
Conversely if every x in every Hom(Z, X) has hx ≡00Y, we take Z = X and
x = 1X. Then hu = hxu = 00Yv for some epimorphisms u ∈Hom(A, X) and
v ∈Hom(A, 0). This says that hu = 0AY = 0XYu. Since u is an epimorphism,
h = 0XY.
For (e), let f = me be the decomposition of f as in Proposition 4.38. Then
m = image f , and we deﬁne k = ker g. If the sequence is exact at Y, then
g f = 0 as part of the deﬁnition. Suppose y ∈m Y has gy ≡0, i.e., gy = 0. Since
m = ker g by exactness, the equality gy = 0 and the deﬁnition of kernel together
imply that y = my′ for some y′. Using Proposition 4.39, let (e, y′) have (e,y′)
as pullback, satisfying ey′ = y′e. Since e by construction is an epimorphism,
Proposition 4.40 shows that e is an epimorphism. From the computation f y′ =
mey′ = my′e = ye, we obtain f y′ ≡y. Then x = y′ has x ∈m X and f x ≡y.

8. Abelian Categories
247
Conversely suppose that g f = 0 and that the other condition holds. Since e
is an epimorphism, the equality g f = 0 implies that gm = 0. The deﬁnition of
k = ker g thus gives m = kϕ for some morphism ϕ. Meanwhile, the morphism
k = ker g has k ∈m Y and gk = 0. Thus gk ≡0. The hypothesis produces
x ∈m X with f x ≡k, i.e., with mexu = kv for suitable epimorphisms u and
v. Write ex = m′e′ according to Proposition 4.38. Then mm′e′u = kv, and the
uniqueness in Proposition 4.38 shows that k = mm′ψ for some isomorphism ψ.
Putting the results together gives m = kϕ = mm′ψϕ and k = mm′ψ = kϕm′ψ.
Since m and k are monomorphisms, 1 = m′ψϕ and 1 = ϕm′ψ. These show that
ϕ has a left inverse and a right inverse, hence is an isomorphism. Then m′ too is
an isomorphism, and k = m except for a factor of an isomorphism on the right
side. This means that we can take ker g = image f and that the given sequence
is exact at Y.
For (f), let x ≡yu + zv. Then xu1 = (yu + zv)v1, and xu1 −y(uv1) = zvv1.
Consequently xu1 −y(uv1) ≡zvv1 ≡z, and (f) follows with u′ = u1 and
v′ = uv1.
□
Theorem 4.42 enables us to use members to verify properties of morphisms in
diagrams, but it does not by itself construct any morphisms. That is, just because
we know what the equivalence class of f x should be for every x ∈m X does not
mean that we have a construction of f ; it means only that we know how to work
with f once f is known to exist. Speciﬁcally we know from Remark 1 with
the theorem that there cannot be a different morphism g with f x ≡gx for all
x ∈m X. Sometoolsthatwehaveforconstructingmorphismsforageneralabelian
category are the existence of kernels and cokernels via Axiom (iv), Proposition
4.39 asserting the existence of pullbacks of pairs of morphisms, and the dual of
Proposition 4.39 asserting the existence of pushouts of pairs of morphisms. For
particular categories of interest, the hypotheses “enough projectives” and “enough
injectives” provide additional constructions of morphisms.
The most complicated example of a constructed mapping that we encountered
in the theory for good categories was the connecting homomorphism in the Snake
Lemma.
In the generalization to abelian categories, the construction of the
connecting morphism has to go outside the usual diagram given in Figure 4.2.
Problem 33 at the end of the chapter will compare the actual construction and
Figure 4.2 for the chain map of exact sequences of abelian groups given below
and observe that the two diagrams are different:
0 −−−→Z
×8
−−−→Z
1	→1mod8
−−−−−→Z/8Z −−−→0
⏐⏐+×4
⏐⏐+×2
⏐⏐+ 1mod8
	→2mod4
0 −−−→Z
×4
−−−→Z
1	→1mod4
−−−−−→Z/4Z −−−→0

248
IV. Homological Algebra
The domain of the connecting homomorphism for this situation is the set of even
members of Z/8Z, and the mapping carries 2 + 8Z to 1 + 4Z in Z/4Z.
EXAMPLE OF DIAGRAM CHASE. In the setting of the Snake Lemma (Lemma
4.6), we shall construct the connecting morphism ω and verify that its value on
each member of its domain corresponds to what we expect on the basis of Lemma
4.6. The given snake diagram, partially enlarged toward Figure 4.2, is
C0⏐⏐+k
A
ϕ
−−−→B
ψ
−−−→C −−−→0
⏐⏐+α
⏐⏐+β
⏐⏐+γ
0 −−−→A′
ϕ′
−−−→B′
ψ′
−−−→C′
p
⏐⏐+
A′
0
(∗)
with the rows exact and the squares commuting. The added parts at the top
and bottom are the kernel (C0, k) of γ and the cokernel (A′
0, p) of α. Once
the connecting homomorphism has been constructed, the proof of exactness will
involve a diagram chase that makes rather straightforward use of Theorem 4.42,
including conclusion (f).
By contrast, the initial construction will involve a
different sort of diagram, namely
B0
C0⏐⏐+k
0
A
ϕ
−−−→B
ψ
−−−→C −−−→0
⏐⏐+α
⏐⏐+β
⏐⏐+γ
0 −−−→A′
ϕ′
−−−→B′
ψ
′
−−−→C
′
0
⏐⏐+p
A′
0
B′
0
ψ
ϕ
k
p
ψ′
ϕ′

8. Abelian Categories
249
In the construction we adjust the ﬁrst row of (∗) to make it exact when a
0 is included at the left end. To do so, we factor ϕ according to Proposition
4.38 as ϕ = me, we let A = domain m = codomain e, and we write ϕ for
m.
The commutativity of the left square of (∗) implies that ϕ′α(ker ϕ) =
βϕ(ker ϕ) = 0. Since ϕ′ is a monomorphism, α(ker ϕ) = 0. Then the fact
e = coker(ker ϕ) implies that α factors through e as α = αe for some α with
domain A. Consequently the left square in the adjusted diagram commutes, and
the ﬁrst row is exact with the 0 inserted at the left. Since e is an epimorphism,
p = coker α = coker(αe) = coker α, and the vertical line at the left is exact.
By a dual argument starting from a factorization of ψ′, we can replace the
triple (C′, ψ′, γ ) in similar fashion by (C
′, ψ
′, γ ), see that k = ker γ , and add
a 0 at the end of the second row to obtain an exact sequence.
Next, let (B0, 
ψ,k) be a pullback of (ψ, k). Proposition 4.40 shows that 
ψ
is an epimorphism and that ker ψ = k ker 
ψ. Since the ﬁrst row is a short exact
sequence, we know that ϕ = ker ψ, and the condition ker ψ = k ker 
ψ shows
that ϕ = ker 
ψ satisﬁes ϕ = kϕ. This completes the dashed arrows in the top
part of the diagram. By a dual argument using p = coker α, we complete the
dashed arrows in the bottom part of the diagram, deducing from ψ
′ = coker ϕ′
the fact that 
ψ′ = coker ϕ′ satisﬁes ψ
′ = 
ψ′p.
Lemma 4.37 shows from ϕ = ker 
ψ that 
ψ = coker ϕ, and it shows from

ψ′ = coker ϕ′ that ϕ′ = ker 
ψ′. With these formulas in hand, we can construct
the connecting homomorphism. Deﬁne ω0 = pβk in Hom(B0, B′
0) to be the
composition down the center.
Then ω0ϕ = pβkϕ = ϕ′ pα = 0, the last
equality holding because pα = 0. Therefore ω0 factors through 
ψ = coker ϕ as
ω0 = ω1
ψ for some ω1 ∈Hom(C0, B′
0). The morphism ω1 satisﬁes 
ψ′ω1
ψ =

ψ′pβk = γ k
ψ = 0, the last equality holding because γ k = 0. Since 
ψ is
an epimorphism, we can cancel it, obtaining 
ψ′ω1 = 0. Therefore ω1 factors
through ϕ′ = ker 
ψ′ as ω1 = ϕ′ω for some morphism ω ∈Hom(C0, A′
0).
The construction of ω is now complete, and the assertion is that the value of ω
on members corresponds to what we expect from the proof of Lemma 4.6. Since
equivalences ωx ≡ω′x for some other candidate ω′ for the connecting morphism
and for all x ∈m C0 would imply that ω = ω′, the argument will show that we
have found the unique morphism taking the prescribed values on members.
During the veriﬁcation we refer to (∗) to do the diagram chase. The member of
C corresponding to x ∈m C0 is kx ∈m C. Since ψ is an epimorphism, Theorem
4.42c produces b ∈m B with ψb ≡kx. Then ψ′βb ≡γ ψb ≡γ kx ≡0, since
γ k = 0. Theorem 4.42e and exactness at B′ imply that ϕ′a′ ≡βb for some
a′ ∈A′, and the class of a′ is unique (for the b under consideration) by Theorem
4.42b because ϕ′ is a monomorphism. We shall verify that ωx ≡pa′, and then
the class of ωx matches what we expect from the proof of Lemma 4.6.

250
IV. Homological Algebra
First let us show that a different choice of b, say b1, leads to the same class
pa′. We are given that ψb ≡ψb1. Let a′ and a′
1 be the corresponding members
of A′ with ϕ′a′ ≡βb and ϕ′a′
1 ≡βb1. We shall make repeated use of Theorem
4.42f, letting subscripted u’s and v’s denote suitable epimorphisms. From ψb ≡
ψb1, Theorem 4.42f gives ψbu1 −ψb1v1 ≡0, i.e., ψ(bu1 −b1v1) ≡0. By
Theorem 4.42e and exactness at B, bu1 −b1v1 ≡ϕa for some a ∈m A. Hence
βbu1 −βb1v1 ≡βϕa ≡ϕ′αa. Two applications of Theorem 4.42f starting from
βbu1 −βb1v1 ≡ϕ′αa give
ϕ′a′ ≡βb ≡ϕ′αau2 + βb1v2,
ϕ′a′u3 −ϕ′αav3 ≡βb1 ≡ϕ′a′
1.
and then
Since ϕ′ is a monomorphism, Theorem 4.42b says that
a′u3 −αav3 ≡a′
1.
Applying p, we obtain pa′u3 −pαav3 ≡pa′
1. Since pα = 0, we can drop the
term pαv3, and we conclude that pa′ ≡pa′u3 ≡pa′
1.
We can now return to the veriﬁcation thatωx ≡pa′, making use of the adjusted
diagram as necessary.20 Since 
ψ is an epimorphism, Theorem 4.42c produces
b0 ∈m B0 with 
ψb0 ≡x. Then kb0 ∈m B has ψkb0 ≡k
ψb0 ≡kx. Hence kb0
is a member of B like b and b1 in the previous paragraph. The above argument
shows that βkb0 ∈m B′ has βkb0 ≡ϕ′a′ for some a′ ∈m A′ and that pa′ ∈m A′
0
is what we should hope for as the value of ωx. So we compute that
ϕ′ωx ≡ω1x ≡ω1
ψb0 ≡ω0b0 ≡pβkb0 ≡pϕ′a′ ≡ϕ′ pa′.
Since ϕ′ is a monomorphism by the dual of Proposition 4.40, Theorem 4.42b
shows that ωx ≡ϕ′a′, which is the formula we were seeking.
9. Problems
1.
(a) Prove that the good category of all ﬁnitely generated abelian groups has
enough projectives but not enough injectives.
(b) Prove that the good category of all torsion abelian groups has enough injec-
tives but not enough projectives.
2.
Let CZ be the category of all abelian groups. Give an example of a nonzero good
category C of abelian groups that has enough projectives and enough injectives
but for which no nonzero projective for CZ lies in C and no nonzero injective for
C lies in CZ.
20Warning: The construction of ω involves B0 and B′
0, which are in the adjusted diagram but
are not in (∗). These objects do not necessarily coincide with the domain of kerβ and the codomain
of coker β.

9. Problems
251
3.
Let R be a semisimple ring in the sense of Chapter II, and let CR be the category
of all unital left R modules. Prove that every module in CR is projective and
injective.
4.
Let R be a (commutative) principal ideal domain, and let CR be the category of
all unital R modules. A module M in CR is divisible if for each a ̸= 0 in R and
x ∈M, there exists y ∈M with ay = x.
(a) Referring to Example 2 of injectives in Section 4, prove that injective for CR
implies divisible.
(b) Deduce from Proposition 4.15 that divisible implies injective for CR.
5.
Let R be a (commutative) principal ideal domain, and let CR be the category of all
unital R modules. Prove that every module M in CR has an injective resolution
of the form 0 →M →I0 →I1 →0 with I0 and I1 injective.
6.
Let C, C ′, C ′′ be good categories of modules with enough projectives and enough
injectives, let G : C →C ′ be a one-sided exact functor with derived functors Gn
or Gn, and let F : C ′ →C ′′ be an exact functor.
(a) Prove that if F is covariant, then F ◦G is one-sided exact, and its derived
functors satisfy (F ◦G)n = F ◦Gn or (F ◦G)n = F ◦Gn.
(b) Prove that if F is contravariant, then F ◦G is one-sided exact, and its derived
functors satisfy (F ◦G)n = F ◦Gn or (F ◦G)n = F ◦Gn.
7.
Let C, C ′, C ′′ be good categories of modules with enough projectives and enough
injectives, let F : C →C ′ be an exact functor, and let G : C ′ →C ′′ be a
one-sided exact functor with derived functors Gn or Gn.
(a) Suppose that F is covariant, that Gn or Gn is deﬁned from projective res-
olutions, and that F carries projectives to projectives. Prove that G ◦F is
one-sided exact and that its derived functors satisfy (G ◦F)n = Gn ◦F or
(G ◦F)n = Gn ◦F.
(b) Suppose that F is covariant, that Gn or Gn is deﬁned from injective res-
olutions, and that F carries injectives to injectives. Prove that G ◦F is
one-sided exact and that its derived functors satisfy (G ◦F)n = Gn ◦F or
(G ◦F)n = Gn ◦F.
(c) Suppose that F is contravariant, that Gn or Gn is deﬁned from projective
resolutions, and that F carries injectives to projectives. Prove that G ◦F is
one-sided exact and that its derived functors satisfy (G ◦F)n = Gn ◦F or
(G ◦F)n = Gn ◦F.
(d) Suppose that F is contravariant, that Gn or Gn is deﬁned from injective
resolutions, and that F carries projectives to injectives. Prove that G ◦F is
one-sided exact and that its derived functors satisfy (G ◦F)n = Gn ◦F or
(G ◦F)n = Gn ◦F.

252
IV. Homological Algebra
8.
Let G be a group, and let F = (F+ →Z) be a free resolution of the trivial
ZG module Z in the category ZG. If M is an abelian group on which G acts by
automorphisms, then we know that the cohomology H n(G, M) is deﬁned to be
the nth cohomology of the cochain complex HomZG(F+, M) and the homology
Hn(G, M) is deﬁned to be the nth homology of the chain complex F+ ⊗ZG M.
Take for granted the result of Proposition 3.32 that if G is a ﬁnite cyclic group
with generator s, then
· · ·
T
−−→ZG
N
−−→ZG
T
−−→· · ·
N
−−→ZG
T
−−→ZG
ε
−−→Z −−→0
isafreeresolutionofZG, where T and N aretheleftZG modulehomomorphisms
deﬁned by
T = multiplication by (s) −(1),
N = multiplication by (1) + (s) + · · · + (sn−1).
Prove that H n(G, M) ∼= H n+2(G, M) and Hn(G, M) ∼= Hn+2(G, M) for all
n ≥1 and all M when G is a ﬁnite cyclic group.
Problems 9–11 concern changes of rings. Fix a homomorphism ρ : R →S of rings
with identity. This homomorphism determines three functors of interest, denoted by
FR
S : CS →CR, P S
R : CR →CS, and I S
R : CR →CS. The ﬁrst takes an S module M
and makes it into an R module FR
S (M) by the deﬁnition rm = ρ(r)m for r ∈R and
m ∈M; the effect on an S homomorphism is to leave the function unchanged and to
regard it as an R homomorphism; this functor is manifestly exact. For the second,
regard S as an (S, R) bimodule with right R action given by sr = sρ(r), and deﬁne
P S
R(M) = S ⊗R M for M in Obj(CR) and P S
R(ϕ) = 1S ⊗ϕ for ϕ in HomR(M, N);
this functor is covariant and right exact. For the third, regard S as an (R, S) bimodule
with left R action given by rs = ρ(r)s, and deﬁne I S
R(M) = HomR(S, M) for M in
Obj(CR) and I S
R(ϕ) = Hom(1S, ϕ) for ϕ in HomR(M, N); this functor is covariant
and left exact.
9.
If C and D are good categories of modules and if F : C →D and G : D →C are
covariant additive functors such that there exist isomorphisms of abelian groups
Hom(F(A), B) ∼= Hom(A, G(B))
natural for A in Obj(C ) and for B in Obj(D), then F is said to be left adjoint to
G and G is said to be right adjoint to F.
(a) Prove that if G carries onto maps in D to onto maps in C, then F carries
projectives in C to projectives in D.
(b) Prove that if F carries one-one maps in C to one-one maps in D, then G
carries injectives in D to injectives in C. (Educational note: The conclusions
in this problem extend to any abelian categories C and D, and in this enlarged
setting, (b) follows from (a) by duality.)

9. Problems
253
10. (a) Prove that P S
R is left adjoint to FR
S .
(b) Deduce from the previous problem that P S
R sends projectives in CR to pro-
jectives in CS.
(c) Prove that if the right R module S is projective, then P S
R is exact. (Ed-
ucational note: In the subject of Lie algebra homology and cohomology,
this hypothesis is satisﬁed when S is the universal enveloping algebra of a
Lie algebra g over a ﬁeld K, R is the universal enveloping algebra of a Lie
subalgebra h of g, and ρ : R →S is the inclusion. It is satisﬁed also in the
subject of homology and cohomology of groups if S is the group algebra KG
of a group G over a ﬁeld K and if R is the group algebra KH of a subgroup
H. See Problem 13c below.)
(d) Using Problem 7, prove that if the right R module S is projective, then
Extk
S(P S
R M, N) ∼= Extk
R(M, FR
S N) naturally in each variable (M being in
Obj(CR) and N being in Obj(CS)).
(e) Even without the assumption that the right R module S is projective, let
X = (X+ →M) be a projective resolution of a module M in CR, and let
Y = (Y + →P S
R M) be a projective resolution of P S
R M in CS. Construct a
chain map from P S
R X to Y extending the identity map on P S
R M, and use it to
obtain the associated homomorphism Extk
S(P S
R M, N) →Extk
R(M, FR
S N)
natural in each variable.
11. (a) Prove that I S
R is right adjoint to FR
S .
(b) Deduce from Problem 9 that I S
R sends injectives in CR to injectives in CS.
(c) Prove that if the right R module S is projective, then I S
R is exact.
(d) Using Problem 7, prove that if the right R module S is projective, then
Extk
S(M, I S
R N) ∼= Extk
R(FR
S M, N) naturally in each variable (M being in
Obj(CS) and N being in Obj(CR)).
(e) Even without the assumption that the right R module S is projective, let
X = (X+ →N) be an injective resolution of a module N in CR, and let
Y = (Y + →I S
R N) be an injective resolution of I S
R N in CS. Construct a
chain map from Y to I S
R N extending the identity map on I S
R N, and use it
to obtain the associated homomorphism Extk
S(M, I S
R N) →Extk
R(FR
S M, N)
natural in each variable.
Problems 12–13 concern the effect on cohomology of groups of changing the group.
The main result is the exactness of the “inﬂation-restriction sequence”; this is applied
particularly in algebraic number theory to relate Brauer groups (see Chapter III) for
different ﬁeld extensions. Let J and K be groups, and let ρ : J →K be a group
homomorphism. By the universal mapping property of group rings, ρ extends to
a ring homomorphism, also denoted by ρ, from ZJ into ZK. For any group G,
we make use of the standard free resolution F(G) = (F(G)+
ε
−→Z) of Z in the
category CZG, as described before Theorem 3.20. A Z basis of Fn(G) consists of all
tuples (g0, . . . , gn), and a ZG basis consists of those members of the Z basis with

254
IV. Homological Algebra
g0 = 1. In the context of the groups J and K, any ZK module M becomes a ZJ
module by the formula xm = ρ(x)m for x ∈ZJ and m ∈M. In particular, each free
ZK module Fn(K) can be regarded as a ZJ module. Meanwhile, the homomorphism
ρ : J →K induces a function from the ZJ basis of Fn(J) into Fn(K) by the formula
ρ(1, j1, . . . , jn) = (1, ρ( j1), . . . , ρ( jn)) for j1, . . . , jn ∈J, and this extends to a
ZJ homomorphism, still called ρ, of Fn(J) into Fn(K). A look at the formula for
the boundary operators ∂J and ∂K in Section III.5 shows that ρ is a chain map in
the sense that ∂Kρ = ρ∂J. If M is any unital left ZK module, then it follows that
Hom(ρ, 1) : Hom(F(K), M) →Hom(F(J), M) is a cochain map. Consequently
wegetmapsoncohomologyforeachn oftheform H n(ρ) : H n(K, M) →H n(J, M).
There are two cases of special interest:
(i) If ρ : H →G is the inclusion of a subgroup into a group, then the mapping
on cohomology is called the restriction homomorphism
Res : H n(G, M) →H n(H, M).
(ii) If H is a normal subgroup of G, let ρ : G →G/H be the quotient
homomorphism. For any ZG module M, let M H be the subgroup of H
invariants. Then G/H acts on M H. The above construction is applicable
to the module M H for the group ring Z(G/H) of G/H, and we form the
mapping on cohomology H n(G/H, M H) →H n(G, M H). The inclusion of
the ZG module M H in M induces a mapping H n(G, M H) →H n(G, M),
and the composition is called the inﬂation homomorphism
Inf : H n(G/H, M H) →H n(G, M).
When H is a normal subgroup of G and M is a ZG module and q ≥1 is an integer
such that H k(H, M) = 0 for 1 ≤k ≤q −1, the inﬂation-restriction sequence is
the sequence of abelian groups and homomorphisms
0 −→H q(G/H, M H)
Inf
−→H q(G, M)
Res
−→H q(H, M).
12. For q = 1, use direct arguments to prove the exactness of the inﬂation-restriction
sequence by carrying out the following steps:
(a) By sorting out the isomorphism q : HomZG(Fq, M) →Cq(G, M) of
Section III.5, show that the effect of a homomorphism ρ : G →G′ on
Cq(G′, M) is given by (ρ∗f )(g1, . . . , gq) = f (ρ(g1), . . . , ρ(gq)).
(b) Verify that Res ◦Inf = 0 by looking at cocycles.
(c) Show that Inf is one-one on H q(G/H, M H) by showing that any cocycle
f : G/H →M H that is a coboundary when viewed as a function on G is
itself a coboundary for G/H.
(d) Show that every member of ker(Res) lies in image(Inf) by showing that any
cocycle f : G →M whose restriction to H is a coboundary may be adjusted
to be 0 on H and that an examination of the equation f (st) = f (s) + s f (t)
in this case shows f to be a cocycle of G/H with values in M H.

9. Problems
255
13. Assume inductively that q > 1, that H k(H, M) = 0 for 1 ≤k ≤q −1, and that
the inﬂation-restriction sequence is exact for all N for degree q −1 whenever
H k(H, N) = 0 for 1 ≤k < q −1. Form B = I ZG
Z F Z
ZG M = HomZ(ZG, M) as
in Problems 9–11. Elements of B can be identiﬁed with functions ϕ on G with
values in M, and G acts by (g0ϕ)(g) = ϕ(gg0).
(a) For m ∈M, show that the function ϕm(t) = tm is a one-one ZG homomor-
phism of M into B. If N = B/M, then the sequence 0 →M →B →
N →0 is therefore exact in CZG.
(b) Use Problem 11 to verify that H k(G, B) ∼= Extk
Z(Z, F Z
ZG M), and deduce
that H k(G, B) = 0 for k ≥1.
(c) Verify the equality of right ZH modules ZG = A ⊗Z ZH for some free
abelian group A.
(d) Using (c), show that F ZH
ZG B ∼= HomZ(ZH, HomZ(A, M)), and deduce that
H k(H, B) = 0 for k ≥1.
(e) Using the hypothesis that H1(H, M) = 0 and a long exact sequence asso-
ciated to the short exact sequence in (a), show that 0 →M H →B H →
N H →0 is exact.
(f)
Prove that Z ⊗ZH ZG ∼= Z(G/H) as right ZG modules, where Z(G/H) is
the integral group ring of G/H.
(g) Show that B H = I Z(G/H)
Z
M, and deduce that H k(G/H, B H) = 0 for k ≥1.
(h) Using the long exact sequences for G and for H associated to the short exact
sequence of (a), as well as the long exact sequence for G/H associated to
the short exact sequence of (e), establish isomorphisms of abelian groups
H q−1(G/H, N H) ∼= H q(G/H, M H),
H q−1(G, N) ∼= H q(G, M),
H q−1(H, N) ∼= H q(H, M).
(i)
Set up the diagram
0 −−−−→H q−1(G/H, N H) −−−−→H q−1(G, N) −−−−→H q−1(H, N)
⏐+
⏐+
⏐+
0 −−−−→
H q(G/H, M H)
−−−−→
H q(G, M)
−−−−→
H q(H, M)
show that it is commutative, and deduce from the foregoing that the
inﬂation-restriction sequence is exact for M in degree q. (Educational note:
For an application to Brauer groups, let F ⊆K ⊆L be ﬁelds, and assume
that K/F, L/F, and L/K are all ﬁnite Galois extensions. The groups in
question are G = Gal(L/F), H = Gal(L/K), and G/H = Gal(K/F), and
the modules in question are M = L× and M H = K ×. The index q is to
be 2, and the vanishing of H1 is by Hilbert’s Theorem 90. The conclusion
is that the sequence 0 →B(K/F) →B(L/F) →B(L/K) is exact.)

256
IV. Homological Algebra
Problems 14–16 introduce the cup product in the cohomology of groups. This is a
construction having applications to topology and algebraic number theory. Let G
be a group, and form the standard free resolution F = (F+
ε
−→Z) of Z in the
category CZG, as described before Theorem 3.20. A Z basis of Fn consists of all
tuples (g0, . . . , gn), and a ZG basis consists of those members of the Z basis with
g0 = 1. Let ∂denote the boundary operator, with the subscript dropped that indicates
the degree. Deﬁne ϕp,q : Fp+q →Fp ⊗Z Fq by
ϕp,q(g0, . . . , gp+q) = (g0, . . . , gp) ⊗(gp, . . . , gq).
14. Check that (ε ⊗ε) ◦ϕ0,0 = ε and that each ϕp,q with p ≥0 and q ≥0 is a ZG
homomorphism satisfying
ϕp,q ◦∂= (∂⊗1) ◦ϕp+1,q + (−1)p(1 ⊗∂) ◦ϕp,q+1.
15. If A and B are abelian groups on which G acts by automorphisms, show that G
acts by automorphisms on A ⊗Z B in such a way that g(a ⊗b) = ga ⊗gb for
all a ∈A, b ∈B, g ∈G. Thus whenever A and B are unital left ZG modules,
then so is A ⊗Z B.
16. For any unital left ZG module M, we work with HomZG(Fn, M) as the space of
n-cochains. (Here it is not necessary to unravel the isomorphism given in Section
III.5 that relates HomZG(Fn, M) to the space Cn(G, M) of cochains deﬁned in
Chapter VII of Basic Algebra.) Deﬁne the coboundary operator on the complex
HomZG(F+, M) to be d = Hom(∂, 1). For any unital left ZG modules A and
B, let f ∈Hom(Fp, A) and g ∈Hom(Fq, B) be given. The product cochain
f · g is the member of HomZG(Fp+q, A ⊗Z B) given by f · g = ( f ⊗g) ◦ϕp,q.
(a) Check that f · g = (d f ) · g + (−1)p f · (dg).
(b) How does it follow that this product descends to a homomorphism of abelian
groups a ⊗b 	→a ∪b carrying the space H p(G, A) ⊗Z H q(G, B) to
H p+q(G, A ⊗Z B)? The descended mapping is called the cup product.
(c) Explain why the cup product is functorial in each variable A and B.
(d) Explain why the cup product for p = 0 and q = 0 may be identiﬁed with
the mapping on invariants given by AG ⊗BG →(A ⊗Z B)G.
Problems17–20introduceﬂat R modules, R beingaringwithidentity. Thesemodules
are of interest in topology and algebraic geometry. Let Ro be the opposite ring of
R; right R modules may be identiﬁed with left Ro modules. Let CR be the category
of all unital left R modules; tensor product over R can be regarded as a functor in
the second variable, carrying CR to CZ, or as a functor in the ﬁrst variable, carrying
CRo to CZ. A unital right R module M (i.e., a unital left Ro module) is called ﬂat if
M ⊗R ( · ) is an exact functor from CR to CZ. Since this functor is anyway right exact,
M is ﬂat if and only if tensoring with M carries one-one maps to one-one maps, i.e.,
if and only if whenever f : A →B is one-one, then 1M ⊗f : M ⊗R A →M ⊗R B
is one-one. Take as known the analog for the functor Tor of all the facts about Ext
proved in Section 7.

9. Problems
257
17. Prove for unital right R modules that
(a) the right R module R is ﬂat,
(b) a direct sum F = !
s∈S Fs is ﬂat if and only if each Fs is ﬂat,
(c) any projective in CRo is ﬂat.
18. Let M be a unital right R module. For each ﬁnite subset F of M, let MF be the
right R submodule of M generated by the members of F. Prove that M is ﬂat if
and only if each MF is ﬂat.
19. Let B be in CR, write B as the R homomorphic image of a free left R module F,
and form the exact sequence 0 →K →F →B →0 in which K is the kernel
of F →B. Prove for each unital right R module A that the sequence
0 →TorR
1 (A, B) →A ⊗R K →A ⊗R F →A ⊗R B →0
is exact. Deduce that A is ﬂat if and only if TorR
1 (A, B) = 0 for all B.
20. Suppose that R is a (commutative) principal ideal domain, so that in particular
R = Ro. The torsion submodule T (M) of a module M in CR consists of all
m ∈M with rm = 0 for some r ̸= 0 in R.
(a) Suppose that M is of the form M = F ⊕T (M), where F is a free R
module. Using the exact sequence 0 →F →M →T (M) →0, prove
that TorR
1 (M, B) = TorR
1 (T (M), B) for all modules B in CR.
(b) Deduce from (a) and Problem 18 that a module M in CR is ﬂat if and only if
T (M) is ﬂat. (Note that M is not assumed to be of the form F ⊕T (M).)
(c) By comparing the one-one inclusion (a) ⊆R for a nonzero a ∈R with the
induced map from (a) ⊗R M to R ⊗R M, prove that T (M) ̸= 0 implies M
not ﬂat.
(d) Deduce that a module M in CR is ﬂat if and only if M has 0 torsion, i.e., if
and only if M is torsion free. (Educational note: In combination with the
result of Problem 19, this condition explains the use of the notation “Tor”
for the ﬁrst derived functor of tensor product.)
Problems 21–25 deal with double chain complexes of abelian groups. A double
chain complex is a system {Ep,q} of abelian groups deﬁned for all integers p and q
and having boundary homomorphisms ∂′
p : Ep,q →Ep−1,q and ∂′′
q : Ep,q →Ep,q−1
such that ∂′
p−1,q∂′
p,q = 0, ∂′′
p,q−1∂′′
p,q = 0, and ∂′
p,q−1∂′′
p,q + ∂′′
p−1,q∂′
p,q = 0. This set
of problems will assume that Ep,q = 0 if either p or q is sufﬁciently negative.
21. Let{Ep,q} be a double complex of abelian groupswith boundary homomorphisms
as above, let En = !
p+q=n Ep,q, and deﬁne ∂n : En →En−1 by ∂n

Ep,q =
∂′
p,q + ∂′′
p,q. Show that the maps ∂n make the system {En} into a chain complex.
(Note: The indexing on the boundary maps has been changed by 1 from earlier in
the chapter in order to simplify the notation that occurs later in these problems.)

258
IV. Homological Algebra
22. Let Cl be a good category of unital left R modules, and let Cr be a good category
of unital left Ro modules; the latter modules are to be regarded as unital right
R modules. Let C = {Cp}p≥−∞and D = {Dq}q≥−∞be chain complexes with
boundary maps αp : Cp →Cp−1 in Cr and βq : Dq →Dq−1 in Cl. It is assumed
that Cp = 0 for p sufﬁciently negative and that Dq = 0 for q sufﬁciently
negative. Deﬁne Ep,q = Cp ⊗R Dq, ∂′
p,q = αp ⊗1, and ∂′′
p,q = (−1)p(1 ⊗βq).
Prove that {Ep,q} with these mappings is a double complex of abelian groups.
(Educational note: Therefore the previous problem creates a chain complex
{En} with boundary maps ∂n : En →En−1 from this set of data. One writes
E = C ⊗R D for this chain complex and calls it the tensor product of the two
chain complexes.)
23. In the notation of the previous problem, suppose that Cp = 0 if p < 0 and
Dq = 0 if q < 0. Let Z p = ker αp and Zq = ker βq. Prove that if c is in Z p
and d is in Zq, then c ⊗d is in the subgroup ker(∂′
p,q + ∂′′
p,q) of Ep,q and that as
a consequence, there is a canonical homomorphism of H p(C) ⊗R H q(D) into
H p+q(C ⊗R D).
24. Suppose that a double complex Epq of abelian groups has Epq = 0 if p < −1 or
q < −1 or p = q = −1. Suppose further that E·,q is exact for each q ≥0 and
Ep,· is exact for each p ≥0. Prove that the rth homology of E−1,q as q varies
matches the rth homology of Ep,−1 as p varies. To do so, start from a cycle a
under ∂′′ in E−1,k with k ≥0. It is mapped to 0 by ∂′, hence has a preimage a′
under ∂′ in E0,k. The element ∂′′a′ in E0,k−1 is mapped to 0 by ∂′, hence has a
preimage a′′ in E1,k−1. Continue in this way, and arrive at a cycle in Ek,0. Then
sort out the details.
25. With notation as in Problem 22, let A be in Cr, and let B be in Cl. Let C =
(C+ →A) be a projective resolution of A, and let D = (D+ →B) be a
projective resolution of B. Form E = C ⊗R D as in Problem 22, and apply
Problem 24 to give a direct proof (without the machinery of Section 7) that one
gets the same result for TorR
n (A, B) by using a projective resolution in the ﬁrst
variable as by using a projective resolution in the second variable.
Problems 26–31 concern the K¨unneth Theorem for homology and the Universal
Coefﬁcient Theorem for homology. Both these results have applications to topology.
It will be assumed throughout that R is a (commutative) principal ideal domain.
STATEMENT OF K¨UNNETH THEOREM. Let C and D be chain complexes
over the principal ideal domain R, and assume that all modules in negative
degrees are 0 and thatC is ﬂat. Then there is a natural short exact sequence
0 →!
p+q=n

Hp(C) ⊗R Hq(D)

αn
−→Hn(C ⊗R D)
βn−1
−→
!
p+q=n−1
TorR
1 (Hp(C), Hq(D)) →0.
Moreover, the exact sequence splits, but not naturally.

9. Problems
259
The point of the theorem is to give circumstances under which the homology of
each of two chain complexes C and D determines the homology of the tensor product
E = C⊗R D, the tensor product complex being deﬁned as in Problem 22. Problem 26
below shows that some further hypothesis is needed beyond the limitation on R. A
sufﬁcient condition is that one of C and D, say C, be ﬂat in the sense that all
the modules in it satisfy the condition of ﬂatness deﬁned in Problems 17–20. The
problems in the set carry out some of the steps in proving the K¨unneth Theorem, and
then they derive the Universal Coefﬁcient Theorem for homology as a consequence.
To keep the ideas in focus, the problems will suppress certain isomorphisms, writing
them as equalities.
26. With R = Z, let C = D be the chain complex with C0 = Z/2Z and with Cp = 0
for p ̸= 0. Let C′ be the chain complex with C′
0 = Z, with C′
1 = Z, and with
C′
p = 0 for p > 1 and for p < 0. Let the boundary map from C′
1 to C′
0 be
×2. Compute the homology of C, C′, D, C ⊗Z D, and C′ ⊗Z D, and justify the
conclusion that the homology of each of two chain complexes does not determine
the homology of their tensor product.
27. Let ∂′ be the boundary map for C. Show how to set up an exact sequence
0 −→Z
ι
−→C
∂′
−→B′ −→0
of complexes in which each module in Z is the submodule of cycles of the
corresponding module in C, ι is the inclusion, B is the complex of boundaries,
and B′ is B with its indices shifted by 1. Why does it follow from the fact that
C is ﬂat that Z, B, and B′ are ﬂat?
28. Explain why
0 −→Z ⊗R D
ι⊗1
−→C ⊗R D
∂′⊗1
−→B′ ⊗R D −→0
is exact even though D is not assumed to be ﬂat.
29. The long exact sequence in homology corresponding to the short exact sequence
in the previous problem has segments of the form
Hn+1(B′ ⊗R D)
ωn
−−−→Hn(Z ⊗R D)
ιn⊗1
−−−→Hn(C ⊗R D)
∂′
n⊗1
−−−→Hn(B′ ⊗R D)
ωn−1
−−−→Hn−1(Z ⊗R D).
Let ∂′′ be the boundary map for D, and let Z, B, and B
′ be the counterparts for
D of the complexes Z, B, and B′ for C. Show that
(a) the boundary map in B′ ⊗R D may be regarded as 1 ⊗∂′′ because the
boundary map in B′ is 0.

260
IV. Homological Algebra
(b) ker(1 ⊗∂′′)n = (B′ ⊗R Z)n and image(1 ⊗∂′′)n+1 = (B′ ⊗R B)n because
B′ is ﬂat.
(c) Hn(B′ ⊗R D) ∼= (B ⊗R H(D))n−1 because B′ is ﬂat. (This isomorphism
will be treated as an equality below.)
(d) similarly Hn(Z ⊗R D) ∼= (Z ⊗R H(D))n. (This isomorphism will be treated
as an equality below.)
30. Form an exact sequence
0 −→B −→Z −→H(C) −→0
of complexes, form the low-degree part of the long exact sequence corresponding
to applying the functor ( · ) ⊗R H(D), namely
0 →TorR
1 (H(C), H(D))n →(B ⊗R H(D))n
→(Z ⊗R H(D))n →(H(C) ⊗R H(D))n →0,
and rewrite it by (c) and (d) of Problem 29 as
0 →TorR
1 (H(C), H(D))n
β′
n
−→Hn+1(B′ ⊗R D)
ωn−1
−→Hn(Z ⊗R D)
α′
n
−→(H(C) ⊗R H(D))n →0.
(a) Why is the term TorR
1 (Z, H(D)) in the long exact sequence equal to 0?
(b) In the 5-term exact sequence of Problem 29, rewrite the part of the sequence
centered at the map ∂′
n ⊗1 in such a way that two exact sequences
ιn⊗1
−−−→Hn(C ⊗R D)
q
−−−→coker(ιn ⊗1) −−−→0
and
0 −−−→ker ωn−1
i
−−−→Hn(B′ ⊗R D)
ωn−1
−−−→Hn−1(Z ⊗R D)
result. Why can the group ker ωn−1 and the homomorphism i be taken to be
TorR
1 (H(C), H(D))n−1 and β′
n−1?
(c) Why in (b) can coker(ιn ⊗1) and q be taken to be TorR
1 (H(C), H(D))n−1
and some one-one homomorphism βn−1 such that β′
n−1βn−1 = ∂′
n ⊗1?
(d) Arguing similarly with the map ιn ⊗1 in Problem 29, obtain a factorization
ιn ⊗1 = αnα′
n in which α′
n : (Z ⊗R H(D))n →(H(C) ⊗R H(D))n is onto
and αn : (H(C) ⊗R H(D))n →Hn(C ⊗R D) is one-one.

9. Problems
261
(e) The maps αn and βn−1 having now been deﬁned in the sequence in the
statement of the K¨unneth Theorem, prove that the sequence is exact.
31. (Universal Coefﬁcient Theorem) By specializing D in the statement of the
K¨unneth Formula to a chain complex that is a module M in dimension 0 and is 0
in all other dimensions, obtain the natural short exact sequence
0 −→Hn(C) ⊗R M −→Hn(C ⊗R M) −→TorR
1 (Hn−1(C), M) −→0,
valid whenever R is a principal ideal domain and C is a chain complex whose
modules are all 0 in dimension < 0. (Educational note: The exact sequence
splits, but not naturally.)
Problems 32–35 concern abelian categories.
32. Let C be an abelian category. Let D be the category for which Obj(D) consists of
all chain complexes of objects and morphisms in C and for which Morph(X, Y)
for any two objects X and Y in D consists of all chain maps from X to Y. Prove
that D is an abelian category.
33. Consider the snake diagram in the category of all abelian groups consisting of the
four rightmost groups in the ﬁrst row and the four leftmost groups in the second
row of the following commutative diagram:
0 −−−−→Z
×8
−−−−→Z
1	→1mod8
−−−−−→Z/8Z −−−−→0
⏐⏐+×4
⏐⏐+×2
⏐⏐+ 1mod8
	→2mod4
0 −−−−→Z
×4
−−−−→Z
1	→1mod4
−−−−−→Z/4Z −−−−→0
Adjoin the 0’s to make the diagram become what is displayed. Following the
steps in the example of a diagram chase in Section 8, extend this diagram to the
auxiliary diagram that appears in that discussion, and show that (B0,k) for the
extended diagram is not a kernel of β.
34. For a general abelian category C and any M in Obj(C ), verify that Hom( · , M)
is a left exact contravariant functor from C to CZ and Hom(M, · ) is a left exact
covariant functor from C to CZ.
35. Proposition 4.19 shows for any good category C of unital left R modules that a
module P in C is projective for C if and only if Hom(P, · ) is an exact functor,
if and only if every short exact sequence 0 →X →Y →P →0 splits.
Rewrite this proof in such a way that it applies to arbitrary abelian categories
C. For the step in the argument that the splitting of every short exact sequence
0 →X →Y →P →0 implies that P is projective, use the notion of pullback
that is developed in Section 8.

CHAPTER V
Three Theorems in Algebraic Number Theory
Abstract. This chapter establishes some essential foundational results in the subject of algebraic
number theory beyond what was already in Basic Algebra.
Section 1 puts matters in perspective by examining what was proved in Chapter I for quadratic
number ﬁelds and picking out questions that need to be addressed before one can hope to develop a
comparable theory for number ﬁelds of degree greater than 2.
Sections 2–4 concern the ﬁeld discriminant of a number ﬁeld. Section 2 contains the deﬁnition of
discriminant, as well as some formulas and examples. The main result of Section 3 is the Dedekind
Discriminant Theorem. This concerns how prime ideals (p) in Z split when extended to the ideal
(p)R in the ring of integers R of a number ﬁeld. The theorem says that ramiﬁcation, i.e, the
occurrence of some prime ideal factor in R to a power greater than 1, occurs if and only if p divides
the ﬁeld discriminant. The theorem is proved only in a very useful special case, the general case
being deferred to Chapter VI. The useful special case is obtained as a consequence of Kummer’s
criterion, which relates the factorization modulo p of irreducible monic polynomials in Z[X] to the
question of the splitting of the ideal (p)R. Section 4 gives a number of examples of the theory for
number ﬁelds of degree 3.
Section 5 establishes the Dirichlet Unit Theorem, which describes the group of units in the ring
of algebraic integers in a number ﬁeld. The torsion subgroup is the subgroup of roots of unity, and
it is ﬁnite. The quotient of the group of units by the torsion subgroup is a free abelian group of a
certain ﬁnite rank. The proof is an application of the Minkowski Lattice-Point Theorem.
Section 6 concerns class numbers of algebraic number ﬁelds. Two nonzero ideals I and J in the
ring of algebraic integers of a number ﬁeld are equivalent if there are nonzero principal ideals (a)
and (b) with (a)I = (b)J. It is relatively easy to prove that the set of equivalence classes has a group
structure and that the order of this group, which is called the class number, is ﬁnite. The class number
is 1 if and only if the ring is a principal ideal domain. One wants to be able to compute class numbers,
and this easy proof of ﬁniteness of class numbers is not helpful toward this end. Instead, one applies
the Minkowski Lattice-Point Theorem a second time, obtaining a second proof of ﬁniteness, one that
has a sharp estimate for a ﬁnite set of ideals that need to be tested for equivalence. Some examples
are provided. A by-product of the sharp estimate is Minkowski’s theorem that the ﬁeld discriminant
of any number ﬁeld other than Q is greater than 1. In combination with the Dedekind Discriminant
Theorem, this result shows that there always exist ramiﬁed primes over Q.
1. Setting
It is worth stepping back from the results of Chapter I to put matters into perspec-
tive. Chapter I studied three problems, all of which could be stated in terms of
262

1. Setting
263
elementary number theory. These were the questions of solvability of quadratic
congruences, of representability of integers or rational numbers by primitive
binary quadratic forms, and of the inﬁnitude of primes in arithmetic progressions.
We had started from the more general problem of studying Diophantine equa-
tions, beginning with the observation that solvability in integers implies solvabil-
ity modulo each prime.1 Linear congruences being no problem, we began with
quadratic congruences and were led to quadratic reciprocity. Then we sought
to apply quadratic reciprocity to address representability of integers or rational
numbers by binary quadratic forms. The reasons for studying the inﬁnitude of
primes in arithmetic progressions were more subtle; what we saw was that at
various stages in dealing with binary quadratic forms, this question of inﬁnitude
kept arising, along with techniques that might be helpful in addressing it.
Work on at least the ﬁrst two of the problems was helped to some extent by the
use of algebraic integers, and we shall see momentarily that algebraic integers
illuminate work on the third problem as well. In any event, it is apparent where
to look for a natural generalization. We are to study higher-degree congruences,
perhaps in more than one variable, and we are to use algebraic extensions of the
rationals of degree greater than 2 to help in the study.
The situation studied in Section IX.17 of Basic Algebra will be general enough
for now. Thus let F(X) be a monic irreducible polynomial inZ[X]. Section IX.17
began to look at the question of how F(X) reduces modulo each prime p. We
begin by reviewing the case of degree 2, the main results in this case having been
obtained in Chapter I in the present volume. For the polynomial F(X) = X2 −m
with m ∈Z, the assumed irreducibility means that m is not the square of an
integer. For ﬁxed m and most primes p, either F(X) remains irreducible modulo
p or F(X) splits as the product of two distinct linear factors. The exceptional
primes have the property that F(X) modulo p is the square of a linear factor;
these are the prime divisors of m and sometimes the prime 2. In short, they occur
among the prime divisors of the discriminant 4m of F(X). In terms of quadratic
residues, the irreducibility of F(X) modulo p means that m is not a quadratic
residue modulo p, and the splitting into two distinct linear factors means that it
is. The odd primes for which F(X) modulo p is the square of a linear factor are
the odd primes that divide m. Modulo 2, every integer is a square, and reduction
modulo 2 was not helpful.
The number theory of quadratic number ﬁelds sheds additional light on this
factorization. The relevant ﬁeld is of course Q(√m ); this is a nontrivial extension
of Q, since m is not square. In working with this ﬁeld in Chapter I, we imposed
the additional condition that m be square free. Promising a general deﬁnition for
1Solvability modulo each prime power is also of interest but played a role in Chapter I only for
powers of 2.

264
V. Three Theorems in Algebraic Number Theory
later, we deﬁned the ﬁeld discriminant of Q(√m ) in that chapter to be
D =
 4m
if m ≡2 mod 4 or m ≡3 mod 4,
m
if m ≡1 mod 4.
Problems 20–24 in Chapter I implicitly related the splitting of F(X) modulo p
to the factorization of ideals. Let R be the ring of algebraic integers in Q(√m ).
If p is an odd prime, those problems observed that (p)R is a prime ideal in R if
D is a nonsquare modulo p, is the product of two distinct prime ideals if D is a
square modulo p but is not divisible by p, and is the square of a prime ideal if D
is divisible by p. The factorization of (2)R was more subtle and was addressed
in Problem 21.
In any event, the pattern of reducibility modulo p of X2 −m, at least when
the prime p is odd, mirrors the pattern of factorization of the ideal generated
by p in the ring of algebraic integers in the number ﬁeld Q(√m ). The role
of quadratic reciprocity was to explain this pattern. Problem 1 at the end of
Chapter I showed that one qualitative consequence of quadratic reciprocity is that
the odd primes p for which X2 −m remains irreducible are the ones in certain
arithmetic progressions, and similarly for the odd primes not dividing p for which
a factorization into two linear factors occurs.
One objective of a generalization is to produce a corresponding theory for an
arbitrary monic irreducible polynomial F(X) in Z[X], say of degree n. Let K be
the extension of Q generated by a root of F(X), and let R be the ring of algebraic
integers in K. Theorem 9.60 of Basic Algebra shows for each prime number p
that the decomposition of the ideal (p)R in R as a product of powers of distinct
prime ideals takes the form (p)R = g
i=1 Pei
i
with fi = [R/Pi : Z/(p)] and
	g
i=1 ei fi = n. Meanwhile, F(X) factors modulo p as a product of powers of
irreducible polynomials modulo p. Sections 2–3 will describe a theory begun
by Kummer and Dedekind for how the factorization of the ideal (p)R and the
factorization of the polynomial F(X) modulo p are related. One introduces a ﬁeld
discriminant for K that is closely related to the discriminant of the polynomial
F(X), and a key result, the Dedekind Discriminant Theorem, says that some ei
is > 1 if and only if p divides the ﬁeld discriminant. The primes p for which
some ei is greater than 1 are said to ramify in the extension ﬁeld K. These primes
are not as well behaved as the others, and one’s ﬁrst inclination might be to try
to ignore them. However, Problems 25–40 at the end of Chapter I show that the
ramiﬁed primes encode a great deal of information; in particular, they explain the
theory of genera and the relationship between exact representability of rational
numbers and representability of integers modulo the ﬁeld discriminant.
Generalizations of quadratic reciprocity lie much deeper and are central results
of the subject of class ﬁeld theory, a subject that is beyond the scope of the present
book. Sufﬁce it to say that class ﬁeld theory in its established form seeks to

1. Setting
265
parametrize all ﬁnite Galois extensions of any number ﬁeld having abelian Galois
group; the parametrization is to refer only to data within the given number ﬁeld.
The reciprocity theorem in this setting goes under the name “Artin reciprocity,”
which includes quadratic reciprocity as a very special case. Class ﬁeld theory
for nonabelian ﬁnite Galois extensions is at present largely conjectural, and the
conjectural reciprocity statement goes under the name “Langlands reciprocity.”
Beginning in Section I.6, we translated some of the theory of binary quadratic
forms into facts about quadratic number ﬁelds. One tool we needed was a de-
scription of the units in the ring of algebraic integers within the quadratic number
ﬁeld. It is to be expected that a similar description for an arbitrary number ﬁeld
will play a foundational role in number theory beyond the quadratic case. The
description in question is captured in the Dirichlet Unit Theorem, which appears
as Theorem 5.13 in Section 5.
The translation of the notion of proper equivalence class of binary quadratic
forms into the language of quadratic ﬁeld extensions led to a notion of strict
equivalence of ideals, as well as a notion of ordinary equivalence. Because there
are only ﬁnitely many proper equivalence classes of forms, there could be only
ﬁnitely many strict equivalence classes of ideals, and this set of classes of ideals
acquired the structure of a ﬁnite abelian group. Dirichlet studied the order of this
group, which ﬁgures into formulas for the value of certain Dirichlet L functions
L(s, χ) at s = 1. The ideal class group for ordinary equivalence is a quotient of
this group by a subgroup of order at most 2.
Although we shall not be concerned with representability of integers by forms
of degree greater than 2, the ideal class group and its order (the “class number”
of the ﬁeld) are of interest for general number ﬁelds when deﬁned in terms of
ordinary equivalence, not strict equivalence. Section 6 is devoted to proving that
the class number is ﬁnite for any number ﬁeld and to developing some tools
for computing class numbers. Class number 1 is equivalent to having the ring
of algebraic integers in question be a principal ideal domain. Apart from the
appearance of class numbers in various limit formulas, here is one other indicator
of the importance of the ideal class group: It is possible to extend the above theory
of ramiﬁcation in such a way that it applies to any extension K/F of number ﬁelds,
not just to ﬁnite extensions of Q. Hilbert proved that for any F, there is a ﬁnite
Galois extension K/F with abelian Galois group that is small enough for the
extension to be unramiﬁed at every prime ideal of F and that is large enough for
any unramiﬁed abelian extension of F to lie in K. Artin reciprocity can be used
to show that Gal(K/F) is isomorphic to the ideal class group2 of F and thus gives
some control over the nature of K. In particular, K = F if and only if every
ideal in the ring of integers of F is principal. When F is quadratic over Q, the
2The ﬁeld K is called the Hilbert class ﬁeld of F. The name “class ﬁeld” is meant to be a
reminder of this isomorphism.

266
V. Three Theorems in Algebraic Number Theory
ﬁeld K can be used to give more deﬁnitive results than in Chapter I concerning
representability of integers by binary quadratic forms.
2. Discriminant
Let us recall some material about Dedekind domains from Chapters VIII and IX
of Basic Algebra. A Dedekind domain is a Noetherian integral domain that is
integrally closed and has the property that every nonzero prime ideal is maximal.
Any principal ideal domain is an example. Any Dedekind domain has unique
factorization for its ideals. Theorem 8.54 of the book gave a construction for
extending certain Dedekind domains to larger Dedekind domains: if D is a
Dedekind domain with ﬁeld of fractions F and if K is a ﬁnite separable extension
of F, then the integral closure of D in K is a Dedekind domain R. The hard
step in the proof, which was not carried out until Section IX.15, was to deduce
from the separability that R is ﬁnitely generated over D. The role of separability
was to force the bilinear form (a, b) 	→TrK/F(ab) to be nondegenerate, and this
nondegeneracy in turn implied the desired result about ﬁnite generation.
In this section we introduce a tool that captures this last implication in quan-
titative fashion—that nondegeneracy of the trace form implies that the extended
domain is ﬁnitely generated over the given domain. In a full-ﬂedged treatment of
algebraic number theory, one might well want to work in this full generality,3 but
we need less for our purposes: Throughout this section we assume that the given
Dedekind domain is the ring Z of integers, that K is a number ﬁeld, and that R is
the integral closure of Z in K, i.e., R is the ring of algebraic integers within K.
Let n = [K : Q] be the degree of the ﬁeld extension. Since C is algebraically
closed, we can regard K as a subﬁeld of C.
The separability of K/Q in combination with the fact that C is algebraically
closed implies that there exist exactly n distinct ﬁeld maps σ1, . . . , σn of K into
C; one of them is the identity. Recall how σ1, . . . , σn can be constructed: if ξ is a
primitive element for K/Q, if F(X) is the minimal polynomial of ξ over Q, and
if ξ1 = ξ, ξ2, . . . , ξn are the n distinct roots of F(X) in C, then σj can be deﬁned
by σj
 	n−1
i=0 ciξi
= 	n−1
i=0 ciξi
j on any Q linear combination of powers of ξ. For
any η = 	n−1
i=0 ciξi in K, primitive or not, the n elements σi(η) of C are called
the conjugates of η relative to K. They are the roots of the ﬁeld polynomial of η
over K, and each occurs with multiplicity [K : Q(η)].4
3For example this full level of generality would be appropriate if one planned ultimately to study
class ﬁeld theory.
4The ﬁeld polynomial of an element of K is the characteristic polynomial of left multiplication
on K by the element. This notion is discussed in Section IX.15 of Basic Algebra.

2. Discriminant
267
Let  = (v1, . . . , vn) be an ordered basis of K over Q.
The symmetric
bilinear form (u, v) 	→TrK/Q(uv) determines an n-by-n symmetric matrix Bi j =
TrK/Q(vivj), and we can recover the form from the matrix B by the formula
TrK/Q(uv) = at Bb if a =
 u


and b =
 v


are the column vectors of u and v in
the ordered basis , i.e., if u = 	n
i=1 aivi and v = 	n
j=1 bjvj. From Section VI.1
of Basic Algebra, we know that the bilinear form determines a canonical Q linear
map L from K to its vector space dual by the formula L(u)(v) = TrK/Q(uv) and
that the nondegeneracy of the form5 implies that this linear map is one-one onto.
Moreover, the matrix of L with respect to  and the dual basis of  is B. Thus
the nondegeneracy implies that the matrix B is nonsingular. The discriminant
D() of the ordered basis  is given by
D() = det B,
where B is the matrix of (u, v) 	→TrL/K(uv) in the basis .
Because of the nonsingularity of B, this is a nonzero member of Q.
Proposition 6.1 of Basic Algebra shows the effect on the matrix B of changing
the basis. Speciﬁcally let  = (w1, . . . , wn) be a second ordered basis, and let C
be the matrix of the form in this basis, namely Ci j = TrK/Q(wiwj). Let the two
bases be related by wj = 	n
i=1 ai jvi, i.e., let [ai j] =

I


. Then the proposition
gives
C =

I

t
B

I


.
Taking determinants and using the fact that a matrix and its transpose have the
same determinant, we obtain
D() = D()

det

I

2
.
One consequence of this formula is that the sign of D() is independent of .
Another is that the value of D() does not depend on the ordering of the n
members of ; it depends only on  as an unordered set.
Now suppose that the members of the ordered basis  are in the subring R
of algebraic integers within K. Bases of K over Q consisting of members of R
always exist, since we can always multiply the members of a basis of K over Q by
a suitable integer to get them to be in R. In this case the entries Bi j = TrK/Q(vivj)
of the matrix of the bilinear form are inZ, and D() is therefore a nonzero member
of Z.
The ﬁeld discriminant, or absolute discriminant, of K, denoted by DK, is
the value of D() that minimizes |D()| for all bases of K consisting of members
5The nondegeneracy of the trace form for a number ﬁeld is a transparent result, not requiring
anything deep from Section IX.15 of Basic Algebra, since any u ̸= 0 in K has TrK/Q(uu−1) =
TrK/Q(1) = n ̸= 0.

268
V. Three Theorems in Algebraic Number Theory
of R. This is a nonzero integer. The sign of DK is well deﬁned, since all values
of D() have the same sign.6
Fix an ordered basis  = (v1, . . . , vn) of K, and consider the abelian group
consisting of the Z span Z() of the members of . This is evidently a free
abelian group of rank n. If an ordered basis  = (w1, . . . , wn) has the property
that Z() ⊆Z(), then the theory in Section IV.9 of Basic Algebra that leads
to the Fundamental Theorem of Finitely Generated Abelian Groups shows that if
we write formally
- w1...
wn
.
= C
- v1...
vn
.
,
then there exist n-by-n integer matrices M1 and M2 of determinant ±1 such that
D = M1C M2 is diagonal, and moreover the order of Z()/Z() is | det D| =
| det C|. Examining the deﬁnition of C, we see that C =

I

t
. Consequently
we obtain
|Z()/Z()| =
 det

I

 ,
a formula we shall use repeatedly in this chapter without speciﬁc reference.
Proposition 5.1. If  is a basis of K over Q whose members all lie in R,
then |R

Z()|2 = D()/DK. In particular,  is a Z basis of R if and only if
D() = DK.
REMARKS. We already know from Basic Algebra that R is a free abelian
group of rank n. The second conclusion of this proposition, in combination with
the transparent observation that the trace form is nonsingular for a number ﬁeld,
gives a more direct proof of this fact. Introductory treatments of algebraic number
theory sometimes give this more direct proof, whose details are spelled out in the
second paragraph below.
PROOF. Let  and  be two bases of K over Q whose members all lie in R,
and suppose that Z() ⊆Z(). Then the above discussion shows that
|D()| = |D()|

det

I

2
and that
Z()/Z()
2 =

det

I

2
.
Since D() and D() are nonzero and have the same sign, we obtain
D()/D() =
Z()/Z()
2.
(∗)
6As was observed above, any D() is the product of D() and the square of a rational number.
Hence D() and D() have the same sign.

2. Discriminant
269
To prove the proposition, we prove the “if” part of the second conclusion
ﬁrst—without using the known fact that R is free abelian. Choose  such that
D() = DK and such that  has all its members in R. Arguing by contradiction,
suppose that  fails to be a Z basis of R. Let r be an element of R not in Z().
Then the Z span of Z() ∪{r} is a ﬁnitely generated additive subgroup of K and
must be free abelian of rank ≥n. Being a subgroup of the additive group of K,
it cannot have rank greater than n and hence has rank exactly n. Let  be an
ordered Z basis of this subgroup. Since Z() ⫋Z(), the right side of (∗) is
> 1, and thus DK > D(). But this is a contradiction because the members of
 lie in R, and hence  is a Z basis of R. In particular, a Z basis of R exists.
To prove the rest of the proposition, take  in (∗) to be a Z basis of R,
and let  =  be any given basis of K over Q that lies in R. Then (∗) gives
|R/Z()|2 = D()/D(). Since |R/Z()| cannot be less than 1, |D()| cannot
be less than |D()|. Thus DK = D(), and |R/Z()|2 = D()/DK. This
proves the ﬁrst conclusion of the proposition, and the “only if” part of the second
conclusion is immediate.
□
EXAMPLE. Field discriminant of a quadratic number ﬁeld. Let K = Q(√m ),
where m is a square-free integer other than 1. From Section I.6 a Z ordered basis
 of R is given by
 =
 {1, √m }
if m ≡2 or 3 mod 4,
{1, 1
2(√m −1)}
if m ≡1 mod 4.
Proposition5.1allowsustocompute DK fromthisinformation. Thematrixwhose
determinant is DK in the two cases is

2 0
0 2m

and
 2
−1
−1 1
2 (m+1)

, respectively, and
thus
DK =
 4m
if m ≡2 or 3 mod 4,
m
if m ≡1 mod 4.
This is the formula that we took as a deﬁnition of ﬁeld discriminant in Section
I.6.
For a general number ﬁeld K of degree n over Q, there is no easy way to obtain
a Z basis of R. Instead, one tries to compute DK and ﬁnd such a basis at the same
time by successive reﬁnements.
The ﬁrst step is to use the special kind of Q basis of K whose existence is
guaranteed by the Theorem of the Primitive Element. Speciﬁcally one can write
K = Q(ξ) for some ξ in K, since K/Q is a separable extension. Possibly after
multiplying ξ by a suitably large integer, we may assume that ξ is in R. Then
(ξ) = {1, ξ, ξ 2, . . . , ξ n−1} is a Q basis of K lying in R. We normally write
D(ξ) instead of D((ξ)) for the discriminant of (ξ). Write ξi = σi(ξ) for the

270
V. Three Theorems in Algebraic Number Theory
ith conjugate of ξ. Let B = [Bi j] be the matrix whose determinant is D(ξ). Since
the trace of an element is the sum of its conjugates, Bi j is given by
Bi j = TrK/Q(ξi−1ξ j−1) =
n	
k=1
σk(ξi−1ξ j−1) =
n	
k=1
ξi−1
k
ξ j−1
k
,
and this is of the form 	n
k=1 VikV t
jk, where Vik = ξi−1
k
is an entry of a Vander-
monde matrix. Therefore
D(ξ) = det B = (det V )2 =
 
i< j
(ξj −ξi)
2 = 
i< j
(ξj −ξi)2,
which coincides with the discriminant of the ﬁeld polynomial of ξ over Q.
EXAMPLES OF D(ξ).
(1) K = Q(ξ), where ξ 5 −ξ −1 = 0. This ﬁeld was studied in Example 1 of
Section IX.17 of Basic Algebra. The discriminant of the polynomial X5 −X −1
is 2869 = 19 · 151, and thus D(ξ) = 2869. Proposition 5.1 shows that D(ξ) =
DKk2 for some nonzero integer k. Since 2869 is square free, we conclude that
DK = 2869.
(2) K = Q(
3√
2 ). The minimal polynomial of ξ =
3√
2 is X3 −2, and its roots
are ξ, ξω, and ξω2, where ω = e2πi/3. Then
D(ξ) = (ξ −ξω)2(ξ −ξω2)2(ξω −ξω2)2 = ξ 6(1 −ω)2(1 −ω2)2(ω −ω2)2,
and this simpliﬁes to D(ξ) = −2233. This quantity is the product of DK by the
square of an integer. Thus DK is one of −3, −12, −27, and −108.
What happens with Example 2 is typical: a second step is needed to decide
among ﬁnitely many possibilities for DK. In the general case an induction is
involved, and Proposition 5.2 below says what is to be done at each step. At the
end of this section, we shall return to Example 2 and use the proposition to see
that DK = −108 is the correct choice.
Before stating Proposition 5.2, let us interpolate a generalization of the compu-
tation of D(ξ) that preceded the above examples. Suppose that  = (α1, . . . , αn)
is any ordered Q basis of K lying in R. Let B = [Bi j] be the matrix whose
determinant is the discriminant of . Then we have
Bi j = TrK/Q(αiαj) =
n	
k=1
σk(αiαj) =
n	
k=1
σk(αi)σk(αj) =
n	
k=1
Aik(At)kj,
where A = [Ai j] is the matrix with Ai j = σj(αi), and it follows that
D() =

det[σj(αi)]
2.
This formula can be useful for computing D() when the conjugates of the αi
are readily available.

2. Discriminant
271
Proposition 5.2. Let  = (v1, . . . , vn) be an ordered Q basis of K lying in
R. If the Z span Z() of  is a proper subgroup of R, then there exists a prime
number p such that p2 divides D() and such that some member
v′
k = p−1(c1v1 + c2v2 + · · · + ck−1vk−1 + vk)
of K lies in R with 1 ≤k ≤n and 0 ≤cj ≤p −1 for j ≤k −1. If such
an element v′
k is found, then  = (v1, . . . , vk−1, v′
k, vk+1, . . . , vn) has Z()
properly containing Z() with D() = p−2D().
REMARKS. A ﬁnite computation is involved in ﬁnding p and k. On the one
hand, for given p, at most 1+ p+ p2+· · ·+ pn−1 elements have to be checked for
integrality. On the other hand, we in principle have to ﬁnd the ﬁeld polynomial
of a certain element of K in each case and decide whether the coefﬁcients are
integers, and this computation may be lengthy. See Problem 2 at the end of the
chapter for an easy example, Problem 16 for a harder example, and Problem 4b
for a related computation.
PROOF. Let Z() be a proper subgroup of R, and put m = |R/Z()|. Choose
a Z basis (w1, . . . , wn) of R, and write vi = 	n
j=1 ci jwj with all ci j ∈Z. We
know that | det[ci j]| = m, and we let p be any prime divisor of m. Reducing the
ci j modulo p, we see that the matrix [ci j] is singular modulo p, and thus there
exist integers a1, . . . , an not all divisible by p such that
n	
i=1
aici j ≡0 mod p
for 1 ≤j ≤n.
Find k with 1 ≤k ≤n for which p divides all of ak+1, . . . , an but not ak, and
write 	n
i=1 aici j = plj for integers lj. Then
k	
i=1
aivi =
n	
j=1
k	
i=1
aici jwj =
n	
j=1

plj −
n	
i=k+1
aici j

wj,
and the integer in parentheses on the right side is a multiple of p. Therefore
r = 	k
i=1 aivi is exhibited as ps for some s ∈R. Choose a′ and dk in Z with
a′ak −dk p = 1, and choose ci and di in Z for each i with i ≤k −1 such that
0 ≤ci ≤p −1 and a′ai −pdi = ci. Then the computation
pa′s =a′r =
k	
i=1
a′aivi =
k−1
	
i=1
(ci + pdi)vi +(1+ pdk)vk =
k−1
	
i=1
civi +vk+ p
k	
i=1
divi
shows that p−1 	k−1
i=1 civi + vk

= a′s −	k
i=1 divi lies in R.
□

272
V. Three Theorems in Algebraic Number Theory
Proposition 5.1 shows that any primitive element ξ of K that lies in R has
the property that D(ξ)/DK is the square of a nonzero integer, and we write this
quotient as J(ξ)2 with J(ξ) > 0. One might hope that although some particular
choice of ξ fails to have J(ξ) = 1, some other choice may be found for which
equality holds. We shall see in Section 4 that for a class of integers m, Q( 3√m )
has such an element ξ if and only if a certain nontrivial Diophantine equation in
two variables has a solution. Both cases arise: for m = 2, such a ξ exists, while
for m = 175, no such ξ exists.
But matters can be worse than this for a general K. The quotient J(ξ)2 =
D(ξ)/DK for a primitive element ξ of K lying in R is sometimes called the
index of ξ. One might hope at least that each prime not dividing DK fails to
divide the index J(ξ)2 for some ξ. However, Dedekind showed that there exist
number ﬁelds K and primes p that are common index divisors7 in the sense that
p divides J(ξ) for every primitive element ξ of K lying in R. Speciﬁcally he
showed that p = 2 is such a prime when K is obtained by adjoining to Q a root
of X3 + X2 −2X + 8; here DK = −503. We shall study this example further in
Section 4.
Let us now specialize our considerations from general additive subgroups of
the form Z() to those that are ideals in R.
Proposition 5.3. If I is a nonzero ideal in R, then
(a) I contains a positive k in Z and
(b) I additively is of the form I = Z() for some Q basis  of K whose
members lie in R.
Consequently R/I is a ﬁnite ring and satisﬁes |R/I|2 = D()/DK.
PROOF. Letr beanonzeromemberof I, andlet P(X)betheﬁeldpolynomialof
r. Then P(X)isoftheform P(X) = Xn+an−1Xn−1+· · ·+a1X+(−1)nNK/Q(r),
has integers for coefﬁcients, and has r as one of its roots. Consequently the
formula
(−1)n+1NK/Q(r) = r(rn−1 + an−1rn−2 + · · · + a1)
shows that the nonzero integer NK/Q(r) is the product of r by a member of R and
hence lies in I. This proves (a) with k = |NK/Q(r)|.
The ideal I additively is a subgroup of R and is thus free abelian of rank at
most n. By (a), the integer k = |NK/Q(r)| has the property that kR ⊆I ⊆R.
Since R/kR has kn elements, R/I is ﬁnite. Therefore I has rank n as an additive
group and must be of the asserted form Z(). This proves (b). The formula
|R/I|2 = D()/DK is immediate from Proposition 5.1.
□
7Terminology varies for this notion. Such primes p are more usually called common inessential
discriminant divisors or essential discriminant divisors. The very fact that these two more usual
names appear to contradict each other is sufﬁcient reason to avoid using either name.

2. Discriminant
273
The absolute norm N(I) of a nonzero ideal I of R is deﬁned to be N(I) =
|R/I|. This is necessarily a positive integer by Proposition 5.3. To be able to
work with this notion, we shall make use of the unique factorization of ideals of
R as given in Theorem 8.55 of Basic Algebra. That theorem says that such an
ideal I has a factorization of the form l
j=1 P
ej
j , where the Pj are distinct prime
ideals of R, and that this factorization is unique except for the order of the factors.
Proposition 5.4. The absolute norms of nonzero ideals of R have the following
properties:
(a) N(R) = 1.
(b) If I ⊆J are nonzero ideals in R, then N(J) divides N(I), and I = J if
and only if N(J) = N(I).
(c) If I and J are nonzero ideals in R, then N(I J) = N(I)N(J).
(d) If (α) is a nonzero principal ideal in R, then N((α)) = |NK/Q(α)|.
PROOF. Conclusion (a) is immediate, and so is most of (b). If I ⊆J and
N(J) = N(I), then the First Isomorphism Theorem for abelian groups yields
(R/I)

(J/I) ∼= R/J, and it follows that N(I)

|J/I| = N(J). Since N(I) and
N(J) are ﬁnite, N(I) = N(J) if and only if |J/I| = 1, i.e., if and only if I = J.
For (c), we begin with the special case that I and J are powers of a nonzero
prime ideal P. Inductively it is enough to show that N(Pk) = N(P)N(Pk−1)
for k ≥1. Since (R/Pk)

(Pk−1/Pk) ∼= R/Pk−1 as abelian groups, it is enough
to show that
|Pk−1/Pk| = |R/P|.
(∗)
The ring R operates on the ideal Pk−1, carrying Pk into itself, and P carries Pk−1
into Pk. Thus Pk−1/Pk is a unital module for the ring R/P, which is a ﬁeld
because P is maximal. Hence Pk−1/Pk is a vector space over R/P. Corollary
8.60 of Basic Algebra shows that this vector space is 1-dimensional, and then (∗)
is immediate.
For the general case in (c), Corollary 8.63 of Basic Algebra shows that if
I = l
j=1 P
ej
j
is the unique factorization of the nonzero ideal I as the product
of positive powers of distinct prime ideals Pj, then R/I ∼= l
j=1 R/P
ej
j . Hence
N(I) = l
j=1 N(P
ej
j ). Because of the special case that is already proved, N(I) =
l
j=1 N(Pj)ej. Then (c) follows in the general case.
For (d), if  = (u1, . . . , un) is an ordered Z basis of R, then the tuple
α = (αu1, . . . , αun) is an ordered Z basis of (α), and we know that N((α)) =
|R/(α)| = |Z()/Z(α)| =
 det

I
,α
 . But

I
,α

is just the matrix of the
Q linear map left-by-α in the Q basis , and the determinant of this linear map
is NK/Q(α) by deﬁnition of the norm of an element.
□

274
V. Three Theorems in Algebraic Number Theory
EXAMPLE 2 OF D(ξ), CONTINUED. For K = Q(
3√
2 ), we have seen that
the discriminant of the K basis (
3√
2 ) is D(
3√
2 ) = −3322. We are going
to show that (1,
3√
2,
3√
4 ) is a Z basis of R, and then it follows that the ﬁeld
discriminant of K is DK = −3322. We apply Proposition 5.2. The only primes
that need testing in that proposition are the ones dividing D(
3√
2 ), and thus
we consider p = 2 and p = 3. We want to see that no expression p−1(1)
or p−1(c1 +
3√
2 ) or p−1(c1 + c2
3√
2 +
3√
4 ) is an algebraic integer for some
coefﬁcients c0 and c1 between 0 and p −1. We can discard p−1(1) because the
only rational numbers that are algebraic integers are the members of Z. If the
ﬁeld polynomial over Q of some ξ in K is X3 + a2X2 + a1X + a0, then the
ﬁeld polynomial of p−1ξ is X3 + p−1a2X2 + p−2a1X + p−3a0. So the question
of integrality is one of divisibility of the coefﬁcients of the ﬁeld polynomials of
certain algebraic integers ξ by suitable powers of p. These coefﬁcients, up to sign,
are the values of the elementary symmetric polynomials on the three conjugates
of ξ.
In the case at hand, only the coefﬁcient a0 is needed. That is, it is enough to
see that the norm of ξ is never divisible by 8 or 27 for ξ equal to c1 +
3√
2 or
c1 + c2
3√
2 +
3√
4 as above. Let us write ξ = c1 + c2θ + c3θ2 with θ =
3√
2 and
with c1, c2, c3 in Z. Then a0 = −NK/Q(ξ), and the norm is the product of the
three conjugates of ξ. If ω = e2πi/3, we compute that
NK/Q(ξ) = (c1 + c2θ + c3θ2)(c1 + c2θω + c3θ2ω2)(c1 + c2θω2 + c3θ2ω)
= (c3
1 + 2c3
2 + 4c3
3) + 2c1c2c3(2ω + 3ω2 + ω4)
= (c3
1 + 2c3
2 + 4c3
3) −6c1c2c3.
For p = 2, we consider this expression when c1, c2, c3 are chosen from {0, 1}.
To get divisibility by 8, we check this expression modulo 8. Each c3
i is ci for
ci ∈{0, 1}. Looking at the expression modulo 2, we see that c1 must be even,
i.e., c1 = 0. Then 8 must divide 2c3
2 + 4c3
3, and we obtain c2 = c3 = 0, in
contradiction to the formulas for the ξ’s under consideration.
For p = 3, it is enough to consider this expression when c1, c2, c3 are chosen
from {−1, 0, +1}. Since each ci has |ci| ≤1, we see that |NK/Q(ξ)| ≤13,
and divisibility by 27 can occur only if NK/Q(ξ) = 0, which we know entails
ξ = 0. Thus no ξ meets the test of Proposition 5.2, and the conclusion is that
(1,
2√
3,
3√
4 ) is a Z basis of R in Q(
3√
2 ).
3. Dedekind Discriminant Theorem
The ﬁeld discriminant plays a role in determining how a prime ideal (p) in Z,
p being a prime number, splits when one extends (p) to an ideal (p)R in the
ring R of algebraic integers in a number ﬁeld K of degree n over Q. In this

3. Dedekind Discriminant Theorem
275
situation, recall from Theorem 9.60 of Basic Algebra that the prime factorization
of the ideal (p)R in R is of the form (p)R = g
i=1 Pei
i with 	g
i=1 ei fi = n; here
n = [K : Q], the Pi are distinct, and fi = dimFp(R/Pi). The integers ei are
called ramiﬁcation indices, and the integers fi are called residue class degrees.
The extension K/Q is said to be ramiﬁed at p, and the prime p of Z is said to
ramify in K, if some ei is > 1 in this decomposition.8
Theorem 5.5 (Dedekind Discriminant Theorem). The prime p of Z ramiﬁes
in a number ﬁeld K if and only if p divides the ﬁeld discriminant DK of K.
In this chapter we shall prove this theorem only in a useful special case, namely
in the case that p is not a common index divisor. Only ﬁnitely many primes can
divide the index J(ξ) = (D(ξ)/DK)1/2 for a single primitive element ξ of K lying
in R, and thus there are only ﬁnitely many common index divisors.9 Consequently
the special case that we are proving implies that only ﬁnitely many primes of Z
ramify in K.
The difﬁculty in proving Theorem 5.5 in full generality is that we lack sufﬁcient
tools for addressing questions by localization. At the end of this section, we shall
make some comments about how one can proceed with further tools.
As we shall see later in this section, Theorem 5.5 for primes that are not
common index divisors is an easy consequence of the following theorem.
Theorem 5.6 (Kummer’s criterion). Let K be a number ﬁeld, and let R be its
ring of algebraic integers. Suppose that F(X) is a monic irreducible polynomial
in Z[X], that ξ is a root of F(X) in C, and that p is a prime number that does
not divide the integer J(ξ) such that J(ξ)2 = D(ξ)/DK. Write F(X) for the
reduction of F(X) modulo p, let
F(X) = F1(X)e1 · · · Fg(X)eg
be the unique factorization of F(X) in Fp[X] into a product of powers of distinct
irreducible monic polynomials, and let fi = deg(Fi). For each i with 1 ≤i ≤g,
select a monic polynomial Fi(X) in Z[X] whose reduction modulo p is Fi(X),
and let Pi be the ideal in R deﬁned by
Pi = pR + Fi(ξ)R.
Then the Pi’s are distinct prime ideals of R with dimFp(R/Pi) = fi, and the
unique factorization of (p)R into prime ideals is
(p)R = Pe1
1 · · · P
eg
g .
8More generally “relative discriminants,” which we have not deﬁned, play a role in the splitting
of prime ideals in passing from a general number ﬁeld to a ﬁnite extension. The cited Theorem 9.60
applies in this more general situation as well. This more general topic will be discussed further in
Problems 5–9 at the end of this chapter and very brieﬂy in Chapter VI.
9In fact, it can be shown that every common index divisor is less than [K : Q].

276
V. Three Theorems in Algebraic Number Theory
REMARKS. The additive group Z((ξ)) generated by the powers of ξ through
ξ n−1 is a ring, since ξ n is an integral combination of the lower powers of ξ, and
this ring has index J(ξ) as a subring of R. We divide the proof into two parts. The
ﬁrst part will give a complete proof in the special case that the subring Z((ξ)) is
all of R, but we shall retain notation that distinguishes the subring from the whole
ring in order to see how much of the proof works for the general case. After the
ﬁrst part we pause for a lemma that will be used to tie results for the subring to
results for all of R, and then we return to apply the lemma and complete the proof
of Theorem 5.6.
FIRST PART OF PROOF. Let P′
i be the ideal pZ[X] + Fi(X)Z[X] in Z[X]. The
passage from Z[X] to the quotient Z[X]/P′
i can be achieved in two steps, ﬁrst
using the substitution homomorphism carrying Z to Fp and X to itself and then
taking the quotient by the principal ideal (Fi(X)). Since Fi(X) is irreducible in
Fp[X], the quotient is a ﬁeld and P′
i has to be prime. The number of elements in
Z[X]/P′
i is p fi because deg(Fi(X)) = fi. The ideals P′
i are distinct because the
polynomials Fi(X) are distinct.
Meanwhile, the substitution homomorphism of Z[X] leaving Z ﬁxed and
carrying X to ξ is a ring homomorphism of Z[X] onto Z((ξ)). Let P′′
i be the
image of P′
i under this homomorphism, i.e., let P′′
i = pZ((ξ))+ Fi(ξ)Z((ξ)).
This is an ideal. The composite ring homomorphism of Z[X] onto Z((ξ))/P′′
i
factors through to a ring homomorphism of Z[X]/P′
i onto Z((ξ))/P′′
i . Since the
domain is a ﬁeld and the identity maps to the identity, the homomorphism is one-
one and the image is a ﬁeld. Thus P′′
i is a prime ideal, the order of Z((ξ))/P′′
i
is p fi, and and P′
i is the complete inverse image of P′′
i . Since the ideals P′
i can
be recovered from the P′′
i and since the P′
i are distinct, the P′′
i are distinct.
The next step is to compare the ideals g
i=1 Pei
i
and (p)R. We shall use the
fact that the polynomial g
i=1 Fi(X)ei −F(X) in Z[X] has coefﬁcients divisible
by p and therefore lies in pZ[X]. The computation
g
i=1
Pei
i
=
g
i=1
(pR + Fi(ξ)R)ei
⊆pR +
g
i=1
Fi(ξ)ei R
⊆pR +
 g
i=1
Fei
i −F

(ξ)
since F(ξ) = 0
⊆pR + pZ((ξ))
since g
i=1 Fi(X)ei −F(X) lies in pZ[X]
= pR
shows that g
i=1 Pei
i
⊆(p)R. If we can show that N
 g
i=1 Pei
i

= N((p)R),
then Proposition 5.4b will allow us to conclude that g
i=1 Pei
i
= (p)R.

3. Dedekind Discriminant Theorem
277
At this point let us specialize to the case that Z((ξ)) = R and see how to
complete the proof. Under this assumption the deﬁnitions of Pi and P′′
i exactly
match. What we have shown about the P′′
i thus says that the Pi are distinct prime
ideals in R with |R/Pi| = p fi, hence with dimFp(R/Pi) = fi. Use of Proposition
5.4 and the fact that |Z((ξ))/P′′
i | = p fi gives N
 g
i=1 Pei
i

= g
i=1 N(Pi)ei =
g
i=1 pei fi = p
g
i=1 ei fi = pn, the last equality holding because deg F(X) =
	g
i=1 ei deg Fi(X). Since pn equals N((p)R), the desired equality of norms has
been proved. This completes the proof of the theorem when Z((ξ)) = R.
□
We interrupt the general proof for the promised lemma.
When we apply
the lemma to ﬁnish the proof of Theorem 5.6, we shall take A = Z((ξ)),
J = J(ξ), and m = p. The hypotheses of Theorem 5.6 show that the condition
GCD(p, J(ξ)) = 1 is satisﬁed.
Lemma 5.7. Suppose that A is an additive subgroup of ﬁnite index J in R and
that m ≥1 is an integer relatively prime to J. Then for each r ∈R, there exists
a ∈A with r −a in mR.
PROOF. Let {u1, . . . , un} be a Z basis of R, and let {v1, . . . , vn} be a Z basis of
A. We can write vj = 	n
i=1 ci jui for an integer matrix [ci j] with | det[ci j]| = J.
Let r = 	n
i=1 biui be given, and let the unknown a ∈A be expanded as a =
	n
i=1 ajvj. Then a = 	
i, j ajci jui, and we are to arrange that the element
r −a =
n	
i=1

bi −
n	
j=1
ci jaj

ui
is in mR. Thus we are to arrange that each coefﬁcient of a ui is divisible by m.
Since | det[ci j]| = J is relatively prime to m, the system of linear equations
n	
j=1
ci jaj ≡bi mod m
with unknowns a1, . . . , an has a nonsingular coefﬁcient matrix modulo m and
therefore has a solution.
□
SECOND PART OF PROOF OF THEOREM 5.6. TheringhomomorphismofZ((ξ))
into R/(pR + Fi(ξ)R) given by the composition of the inclusion followed by the
quotient map descends to a ring homomorphism
Z((ξ))

(pZ((ξ)) + Fi(ξ)Z((ξ))) −→R/(pR + Fi(ξ)R).
(∗)
To see that (∗) is onto, let r ∈R be given. Take A = pR in Lemma 5.7. Choose
z ∈Z((ξ)) by the lemma in such a way that z −r is in pR. Under the mapping

278
V. Three Theorems in Algebraic Number Theory
(∗), the coset of z goes to r +(z −r)+ pR + Fi(ξ)R = r + pR + Fi(ξ)R, which
is the coset of r. Hence (∗) is onto.
To see that (∗) is one-one, suppose that z maps to the 0 coset in the image.
Then z = pr1 + Fi(ξ)r2 with r1 and r2 in R. Lemma 5.7 produces z2 in Z((ξ))
with r2 −z2 in pR. Hence the decomposition z = pr1 + Fi(ξ)(r2 −z2)+ Fi(ξ)z2
exhibits z as in pR + Fi(ξ)Z((ξ)). The product Fi(ξ)Z((ξ)) is in Z((ξ)),
since Z((ξ)) is a ring, and (∗) will be one-one if we show that pR ∩Z((ξ)) ⊆
pZ((ξ)). Let {ui} be a Z basis of R, let {vj} be a Z basis of Z((ξ)), and
write vj = 	
i ci jui for integers ci j. If z′ is in pR ∩Z((ξ)), let us write
z′ = 	
j ajvj. Substitution gives z′ = 	
i
 	
j ajci j

ui. Since z′ is in pR, we
see that 	
j ci jaj ≡0 mod p for all i. The determinant of [ci j] is the index J(ξ),
up to sign, and this by assumption is not divisible by p. Therefore aj ≡0 mod p
for all j, and it follows that z′ is in pZ((ξ)). Hence (∗) is one-one.
We have thus proved that (∗) is a ring isomorphism, i.e., that Z((ξ))/P′′
i ∼=
R/Pi for all i. The left side is a ﬁeld, and hence Pi is a prime ideal. From
the isomorphism we obtain N(Pi) = |Z((ξ))/P′′
i | = p fi. The computation
N
 g
i=1 Pei
i

= g
i=1 N(Pi)ei = g
i=1 pei fi = p
g
i=1 ei fi = pn in the last
paragraph of the ﬁrst part of the proof is now fully justiﬁed, and we can therefore
conclude as in the special case that g
i=1 Pei
i
= (p)R.
Finally we have to prove that the ideals Pi are distinct. If indices i ̸= j are
given, we know that P′′
i
̸= P′′
j . Choose z in P′′
i but not P′′
j . Then z is in Pi
because P′′
i ⊆Pi, and z is not in Pj because the proof above that (∗) is one-one
showed that Z((ξ)) ∩Pj ⊆P′′
j . This completes the proof of Theorem 5.6.
□
PROOF OF THEOREM 5.5 WHEN p IS NOT A COMMON INDEX DIVISOR. If p is not
a common index divisor, we can choose a primitive ξ for K/Q such that ξ is in
R and p does not divide J(ξ) = |R/Z((ξ))|. Let F(X) be the ﬁeld polynomial
of ξ over Q. Since D(ξ) = J(ξ)2DK, p divides DK if and only if p divides
D(ξ). Thus p divides DK if and only if p divides the discriminant of F(X).
This happens if and only if the discriminant of F(X) is ≡0 mod p, if and only
if F(X) has a root of multiplicity > 1 in an algebraic closure of Fp, if and only if
the factorization over Fp of F(X) as a product of powers of distinct irreducible
monic polynomials has some factor with exponent > 1. Applying Theorem 5.6,
we see that this last condition is satisﬁed if and only if the unique factorization
of the ideal (p)R in R as g
i=1 Pei
i
has some ei > 1.
□
As was mentioned earlier in this section, the difﬁculty in proving Theorem 5.5
in complete generality is that we lack sufﬁcient tools for addressing questions by
localization. The different prime numbers are interacting in some fashion, and the
above proofs were unable to separate them. The usual technique of localization

4. Cubic Number Fields as Examples
279
in our situation10 suggests enlarging one or the other of the rings Z and R by
adjoining inverses for all elements not in some prime ideal of interest. Then we
piece together the results. If the localizing is done with respect to a prime ideal
(p) of Z, then Z gets replaced by the subring S−1Z of all members of Q with no
factors of p in the denominators, and R gets replaced by S−1R. One advantage
of this procedure is that S−1R is a principal ideal domain, whereas R is typically
not such a domain.
Localization in that formulation does not by itself reveal a clear path to a proof
of Theorem 5.5. Two additional ideas enter the argument to make a path seem
natural; Dedekind succeeded without the second of them, and historically it is
only with hindsight that one sees the beneﬁt of the second idea. The ﬁrst idea is
to use a more fundamental object than the discriminant of K, called the “relative
different” of K/Q; this makes it possible to aim for a more precise description
of the ramiﬁcation indices when they are not equal to 1. The second idea is due
to K. Hensel and involves forming a kind of completion of the localized rings;
the ring Z gets replaced by the ring Zp of “p-adic integers,” and the ﬁeld Q
gets replaced by the ﬁeld Qp of “p-adic numbers.” We return to these ideas in
Chapter VI.
4. Cubic Number Fields as Examples
In treating examples of cubic ﬁelds, it will be convenient to have one further
tool available for computing discriminants. Let K be a number ﬁeld, let ξ be
a primitive element of K/Q, and let F(X) be its ﬁeld polynomial over Q. Let
ξi = σi(ξ) be the conjugates of ξ, and assume that ξ1 = ξ. The conjugates are
the roots of F(X) in C, and hence
F(X) =
n
i=1
(X −ξi).
The derivative is F′(X) = 	n
i=1

j̸=i (X −ξj), and therefore
F′(ξ) =
n
j=2
(ξ −ξj).
Observe that the form of the left side shows that this element lies in K, and it
lies in R if ξ lies in R. The different D(ξ) of the element ξ is deﬁned to be this
element of K, namely11
10Localization was introduced in Section VIII.10 of Basic Algebra.
11The different of an element is related to the notion of relative different mentioned at the end of
Section 3, but the nature of that relationship will not concern us at this time.

280
V. Three Theorems in Algebraic Number Theory
D(ξ) = F′(ξ) =
n
j=2
(ξ −ξj).
Since F′(X) has coefﬁcients in Q, the conjugates σi(F′(ξ)) of F′(ξ) are the
elements F′(σi(ξ)) = F′(ξi) for 1 ≤i ≤n. The formula for F′(X) shows that
F′(ξi) = 
j̸=i (ξi −ξj). Therefore the norm of D(ξ) is
NK/Q(D(ξ)) = NK/Q(F′(ξ)) =
n
i=1
F′(ξi) =
n
i=1

j̸=i
(ξi −ξj)
= (−1)n(n−1)/2 
i< j
(ξi −ξj)2 = (−1)n(n−1)/2D(ξ).
Inotherwords, thenormofthedifferentofξ is, uptosign, equaltothediscriminant
of (ξ), which in turn equals the discriminant of the ﬁeld polynomial of the
primitive elementξ. The deﬁnitionsofD(ξ)and D(ξ)andthe formula connecting
them make sense if ξ is allowed to be any element of K, primitive or not. Both
D(ξ) and D(ξ) have the property of being nonzero if and only if ξ is primitive.
EXAMPLE. For the ﬁeld K = Q(
3√
2 ), the different of ξ =
3√
2 is 3X2
X= 3√
2 =
3
3√
4, and the discriminant of X3 −2, up to the sign (−1)3·2/2, is the norm of this,
i.e.,
D(
3√
2 ) = −(3
3√
4)(3
3√
4 ω)(3
3√
4 ω2),
where ω = e2πi/3,
= −3322.
Alternatively, the norm can be computed from a ﬁeld polynomial. Speciﬁcally
the norm of 3
3√
4 is the determinant of left multiplication by this element when
considered as a Q linear mapping of K into itself.
We saw already in Example 2 of Section 2 that D(
3√
2 ) = −3322, but the
earlier method of computation was longer. At the end of Section 2, we saw in
addition that {1,
3√
2,
3√
4 } is a Z basis of the ring of algebraic integers in the ﬁeld
K = Q(
3√
2 ). The use of differents does not simplify the proof of this latter fact.
In this section we consider further examples of cubic extensions of Q. The
ﬁrst such ﬁelds that we study are the pure cubic extensions K = Q( 3√m ), where
m is any cube-free positive integer > 1. Already with these ﬁelds K, we shall see
that DK is not necessarily equal to D(ξ) for some algebraic integer ξ. However,
all these ﬁelds have no common index divisors. Then we examine Dedekind’s
example of a cubic number ﬁeld for which 2 is a common index divisor.

4. Cubic Number Fields as Examples
281
The correspondence of cube-free integers m > 1 to ﬁelds Q( 3√m ) is many-
to-one: if m is given and p is a prime dividing m, let m′ = m/p if p2 divides m
and m′ = mp if p2 does not divide m; then Q( 3√m ) = Q(
3√
m′ ). In analyzing
Q( 3√m ), it will be convenient to normalize matters so as to resolve this ambiguity.
We can write m uniquely as a product m = ab2 for positive square-free integers
a and b; these have GCD(a, b) = 1, b2 is the largest square dividing m, and a is
given by a = m/b2. Then m and m′ = a2b lead to the same ﬁeld.
Proposition 5.8. For a cube-free integer m > 1, let K = Q( 3√m ), and let R
be the ring of algebraic integers in K. Write m = ab2 for positive square-free
integers a and b with GCD(a, b) = 1, and deﬁne two members of R to be the
real cube roots θ1 =
3√
ab2 and θ2 =
3√
a2b. Then a Z basis of R consists of
(a) {1, θ1, θ2} if a ̸≡±b mod 9, i.e., if m is of Type I,
(b) { 1
3(1 ± θ1 ± θ2), θ1, θ2} for exactly one choice of the pair of signs if
a ≡±b mod 9, i.e., if m is of Type II.
In the respective cases the ﬁeld discriminant is given by
DK =
 −27a2b2
if m is of Type I,
−3a2b2
if m is of Type II.
REMARKS. More precisely in Type II, the congruence a ≡±b mod 9 implies
that a and b are prime to 3.
Choose signs s = ±1 and t = ±1 such that
sa ≡1 mod 3 and tb ≡1 mod 3. Then the ﬁrst member of the Z basis is to be
1
3(1 + sθ1 + tθ2). The smallest m leading to Type I is m = 2, and this case was
examined in Example 2 in Section 2. The smallest m leading to Type II is m = 10,
and then the ﬁrst member of the asserted Z basis of R is 1
3(1 +
3√
10 +
3√
100 ).
PROOF. Let ω = e2πi/3. The conjugates of θ1 can be taken to be σ1(θ1) = θ1,
σ2(θ1) = ωθ1, and σ3(θ1) = ω2θ1. Since θ2
1 = bθ2, we have σi(θ2) = b−1σi(θ1)2,
and therefore σ1(θ2) = θ2, σ2(θ2) = ω2θ2, and σ3(θ2) = ωθ2. In view of the
formula before Proposition 5.2, D((1, θ1, θ2)) is the square of
det
- 1
1
1
θ1
ωθ1
ω2θ1
θ2
ω2θ2
ωθ2
.
,
and we calculate that D((1, θ1, θ2)) = −27a2b2.
Let us apply Proposition 5.2 to the triple {1, θ1, θ2} of members of R. For each
prime p dividing 27a2b2, we are to check whether certain elements are integral.
First suppose that p divides a but p ̸= 3. It is enough to check the elements
p−1(a0 + θ1) or p−1(a0 + a1θ1 + θ2) for integrality when a0 and a1 are integers
from 0 to p −1. Form the extension L = K( 3√p ) = Q( 3√m,
3√p ) of K, and

282
V. Three Theorems in Algebraic Number Theory
let T be its ring of algebraic integers. The degree [L : Q] equals 9 if L ̸= K and
equals 3 if L = K. If p−1(a0 + θ1) is integral, then a0 + p1/3((a/p)b2)1/3 = pr
with r ∈R, and hence a0 = p1/3c with c ∈T . Applying NL/Q to both sides, we
obtain a9
0 = p3NL/Q(c) if L ̸= K, and we obtain a3
0 = pNK/Q(c) if L = K. In
either case, p divides a0, and a0 = 0. So p−1θ1 is integral, in contradiction to
the facts that the ﬁeld polynomial for K of p−1θ1 is X3 −p−3ab2 and that ab2
contains p as a factor only once. We conclude that p−1(a0 + θ1) is not integral.
Similarly if the element p−1(a0 + a1θ1 + θ2) is integral, then we see that
a0 + a1 p1/3((a/p)b2)1/3 + p2/3((a/p)2b)1/3 = pr with r ∈R. So a0 = p1/3c
with c ∈T , and the same argument as above shows that a0 = 0.
Hence
a1((a/p)b2)1/3 + p1/3((a/p)2b)1/3 = p2/3r, and a1((a/p)b2)1/3 = p1/3c′ with
c′ ∈T . Taking the norm gives a9
1((a/p)b2)3 = p3NL/Q(c′) if L ̸= K and
a3
1(a/p)b2 = pNK/Q(c′) if L = K. Since a/p and b are prime to p, we conclude
that p divides a1 in both cases. Therefore a1 = 0, and p−1θ2 is integral. The
ﬁeld polynomial for K of p−1θ2 is X3 −p−3a2b, and a2b contains p as a factor
only twice. We conclude that p−1(a0 + a1θ1 + θ2) is not integral.
This disposes of the prime divisors of a other than p = 3, and we handle
the prime divisors of b other than p = 3 in the same way, except that we start
from the ordered triple (1, θ2, θ1) and therefore need check only p−1(a0 + θ2)
and p−1(a0 + a1θ2 + θ1).
Now let us apply Proposition 5.2 to the ordered triple (1, θ1, θ2) for the prime
p = 3, except that we allow coefﬁcients 0 and ±1 instead of 0, 1, 2. We check
integrality for the elements 1
3(1 ± θ1), 1
3(1 ± θ2), 1
3(θ1 ± θ2), and 1
3(1 ± θ1 ± θ2)
by checking whether the coefﬁcients of their ﬁeld polynomials are in Z. For the
ﬁrst two, let ϕ be ±θ1 or ±θ2. The coefﬁcient of the ﬁrst-degree term in the ﬁeld
polynomial of 1
3(1 + ϕ) is 1
9 times
(1 + ϕ)(1 + ωϕ) + (1 + ϕ)(1 + ω2ϕ) + (1 + ωϕ)(1 + ω2ϕ)
= (1 + ϕ)(2 + ωϕ + ω2ϕ) + (1 + ωϕ)(1 + ω2ϕ)
= (1 + ϕ)(2 −ϕ) + (1 −ϕ + ϕ2) = 2 + ϕ −ϕ2 + 1 −ϕ + ϕ2 = 3,
hence is 1
3. This is not an integer, and thus 1
3(1 + ϕ) is not in R. If ϕ = ±θ1 and
ψ = ±θ2, then the corresponding computation for ϕ + ψ is
(ϕ + ψ)(ωϕ + ω2ψ) + (ϕ + ψ)(ω2ϕ + ωψ) + (ωϕ + ω2ψ)(ω2ϕ + ωψ)
= −(ϕ + ψ)(ϕ + ψ) + (ϕ2 −ϕψ + ψ2)
= −3ϕψ = −3ab(sgn ϕ)(sgn ψ),
(∗)
and 1
9 of this is an integer only if 3 divides ab. In this case our hypotheses show

4. Cubic Number Fields as Examples
283
that 9 does not divide ab. The constant term in the ﬁeld polynomial of 1
3(ϕ + ψ)
is −1
27 times
(ϕ + ψ)(ωϕ + ω2ψ)(ω2ϕ + ωψ) = ϕ3 + ψ3
= (sgn ϕ)ab2 + (sgn ψ)a2b
= ab(b sgn ϕ + a sgn ψ).
(∗∗)
When 3 divides ab exactly once, 3 divides (∗∗) exactly once, and hence −1
27 of
(∗∗) is not an integer. Thus 1
3(ϕ + ψ) is not in R.
It remains to check 1
3(1+ϕ +ψ) with ϕ = ±θ1 and ψ = ±θ2. The coefﬁcient
of the second-degree term in the ﬁeld polynomial of 1
3(1 + ϕ + ψ) is equal to
−1
3 Tr(1 + ϕ + ψ) = −1 and is an integer; thus it imposes no restrictions. The
ﬁrst-degree term of the ﬁeld polynomial is 1
9 of
(1 + ϕ + ψ)(1 + ωϕ + ω2ψ) + (1 + ϕ + ψ)(1 + ω2ϕ + ωψ)
+ (1 + ωϕ + ω2ψ)(1 + ω2ϕ + ωψ)
= (1 + ϕ + ψ)(2 −ϕ −ψ) + (1 −ϕ −ψ + ϕ2 −ϕψ + ψ2)
= 3 −3ϕψ = 3(1 −ab(sgn ϕ)(sgn ψ)),
(†)
and 1
9 of (†) is an integer if and only if ab ≡(sgn ϕ)(sgn ψ) mod 3. In particular,
the proof is now complete unless ab ≡(sgn ϕ)(sgn ψ) mod 3. Thus we may
assume from now on that neither a nor b is divisible by 3.
The constant term of the ﬁeld polynomial of 1
3(1 + ϕ + ψ) is −1
27 times
(1 + ϕ + ψ)(1 + ωϕ + ω2ψ)(1 + ω2ϕ + ωψ)
= 1 + TrK/Q(ϕ + ψ) + (∗) + (∗∗)
= 1 + 0 −3ab(sgn ϕ)(sgn ψ) + ab(b sgn ϕ + a sgn ψ).
Put α = a sgn ϕ and β = b sgn ψ, so that 1 −3αβ + αβ(α + β) is to be divisible
by 27. Since neither β nor α is divisible by 3, we can deﬁne l mod 27 by the
congruence β = lα mod 27. Substituting shows that 1 −3lα2 + lα2(α + lα) ≡
0 mod 27, hence that l(l + 1)α3 ≡3lα2 −1 mod 27, which we can rewrite as
α3l2 + (α3 −3α2)l + 1 ≡0 mod 27.
Completing the square in l allows us to write this congruence as
(l + 1
2(1 −3α−1))2 ≡1
4(1 −3α−1)2 −α−3 mod 27.
Factoring the right side, we obtain
(l + 1
2(1 −3α−1))2 ≡1
4α−4[α(α −1)2(α −4)] mod 27.
(††)

284
V. Three Theorems in Algebraic Number Theory
If α ≡1 mod 3, the expression in square brackets on the right side is ≡0 mod 27,
and 0 is the square of 0 and ±9. If α ≡2 mod 3, then the expression in square
brackets is a square if and only if α(α −4) ≡c2 mod 27. Considering the
congruence only modulo 3 gives 2(−2) ≡c2 mod 3 and therefore c2 ≡2 mod 3,
which has no solutions. Thus α ≡2 mod 3 leads to no solutions of (††). We can
summarize by saying that the solutions of (††) are given by α ≡1 mod 3 and
l + 1
2(1 −3α−1) ≡0 mod 9.
One checks that the values α ≡1, 4, 7 mod 9 all lead to l = 1.
Let us summarize. Let s and t be signs ±. Then 1
3(1 + sθ1 + tθ2) is integral
if and only if both of the following conditions are satisﬁed:
(i) sa ≡tb ≡1 mod 3,
(ii) sa ≡tb mod 9.
When these conditions are satisﬁed, we are in Type II; otherwise we are in Type I.
This completes the proof.
□
In the setting of Type I in Proposition 5.8, let us form the discriminants of
(θ1) = (1, θ1, θ2
1) and (θ2) = (1, θ2, θ2
2). Using the method of computation
at the beginning of this section, we see that the differents in the two cases are
3θ2
1 and 3θ2
2. Therefore the discriminant of (θ1) is D(θ1) = −NK/Q(3θ2
1) =
−33(θ2
1)3 = −33(ab2)2 = −33a2b4, and the discriminant of (θ2) similarly is
D(θ2) = −33a4b2. The absolute value of the greatest common divisor of these
two expressions is 33a2b2 = |DK|, and therefore there are never any common
index divisors in Type I.
On the other hand, there exist situations in Type I in which no primitive element
ξ of Q( 3√m ) lying in R has (ξ) as a Z basis. To prove this fact, we make use
of the following proposition.
Proposition 5.9. For a pure cubic extension K = Q(
3√
ab2 ) of Type I, an
element ξ = x + yθ1 + zθ2 with Z coefﬁcients has D(ξ) = DK if and only if
y3b −z3a = ±1.
PROOF. The matrix whose determinant is D((ξ)) is given by
M =
-
3
Tr(ξ)
Tr(ξ 2)
Tr(ξ)
Tr(ξ 2)
Tr(ξ 3)
Tr(ξ 2)
Tr(ξ 3)
Tr(ξ 4)
.
,
where Tr is short for TrK/Q. The element θi
1θ j
2 has conjugates θi
1θ j
2 , ωi+2 jθi
1θ j
2 ,
and ω2i+ jθi
1θ j
2 , where ω = e2πi/3. Thus
Tr(θi
1θ j
2 ) = (1 + ωi+2 j + ω2i+ j)θi
1θ j
2 = (1 + ωi+2 j + ω2(i+2 j))θi
1θ j
2 .

4. Cubic Number Fields as Examples
285
This is 0 if i + 2 j is not divisible by 3 and is 3θi
1θ j
2 otherwise. We compute the
trace of each power of ξ by applying the formula
Tr(ξl) =
n	
k=0
l
k

xl−k Tr((yθ1 + zθ2)k),
which comes from treating ξ as a binomial. The traces of the powers of yθ1 +zθ2
work out to be
1
3 Tr(yθ1 + zθ2) = 0,
1
3 Tr((yθ1 + zθ2)2) = 2yzθ1θ2 = ab(2yz),
1
3 Tr((yθ1 + zθ2)3) = ab(y3b + z3a),
1
3 Tr((yθ1 + zθ2)4) = (ab)26y2z2.
Substituting, we ﬁnd the following formulas for the trace of each power of ξ:
1
3 Tr(ξ) = x,
1
3 Tr(ξ 2) = x2 + 2(ab)yz,
1
3 Tr(ξ 3) = x3 + 3x(ab)2yz + (ab)(y3b + z3a),
1
3 Tr(ξ 4) = x4 + 6x2(ab)2yz + 4x(ab)(y3b + z3a) + (ab)26y2z2.
The matrix M is therefore of the form
1
3 M =
-
1
x
x2 + A
x
x2 + A
x3 + B
x2 + A
x3 + B
x4 + C
.
,
where
A = 2(ab)yz,
B = 3x(ab)2yz + (ab)(y3b + z3a),
C = 6x2(ab)2yz + 4x(ab)(y3b + z3a) + (ab)26y2z2.
Expansion of det 1
3 M results in an expression that simpliﬁes to
det 1
3 M = AC + 2x AB −3x2A2 −A3 −B2.
Thus we have only to substitute. The resulting expression simpliﬁes greatly, and
we obtain det 1
3 M = −(ab)2(y3b −z3a)2. Consequently
D(ξ) = −33(ab)2(y3b −z3a)2.
Since Proposition 5.8 has shown that DK = −33(ab)2, the result follows.
□

286
V. Three Theorems in Algebraic Number Theory
Thus in order to give an example of an m for which no ξ has D(ξ) = DK, we
have only to select a and b for which the Diophantine equation y3b −z3a = 1
in y, z has no solution. Choose a = 7 and b = 5, so that m = ab2 = 175. To
verify that the Diophantine equation has no solution, take the equation modulo
7 and then modulo 5, obtaining 5y3 ≡1 mod 7 and −7z3 ≡1 mod 5. These
congruences say that y3 ≡3 mod 7 and z3 ≡2 mod 5. The only cubes modulo
7 are ±1, and thus the congruence for y has no solution.
We turn to the question of the splitting of prime ideals in pure cubic extensions
K = Q( 3√m ). In the notation of Proposition 5.8, we again write m = ab2, and
we shall assume that the extension is of Type I. We saw in Proposition 5.8 and
the remarks afterward that DK equals the greatest common divisor of D(
3√
ab2 )
and D(
3√
a2b ). Therefore the splitting of every prime ideal (p) in Z is described
by Theorem 5.6. We have only to sort out the details.
Proposition 5.10. Let K = Q( 3√m ) be a pure cubic extension of Type I, and
let R be its ring of algebraic integers. If p is a prime number, then the ideal (p)R
of R splits into prime ideals as follows:
(a) (p)R = P1P2 with N(P1) = p and N(P2) = p2 if p ≡−1 mod 3 and
p does not divide DK,
(b) (p)R = P1P2P3 with P1, P2, P3 distinct of norm p if p ≡1 mod 3,
x3 ≡m mod p is solvable in Fp, and p does not divide DK,
(c) (p)R is prime of norm p3 if p ≡1 mod 3, x3 ≡m mod p is not solvable
in Fp, and p does not divide DK,
(d) (p)R = P3 with N(P) = p if p divides DK.
PROOF. The prime divisors of DK are 3 and the prime divisors of a and b.
For all other primes Theorem 5.6 shows that all ramiﬁcation indices are 1. Let
p be a prime of the form 6k ± 1 not dividing DK. The multiplicative group F×
p
of Fp is cyclic of order p −1 and hence has order divisible by 3 if and only if
p = 6k + 1. Thus there are three cube roots of 1 when p = 6k + 1 but only 1
when p = 6k −1. In the latter case the cubing map is one-one onto from F×
p
to itself. Thus X3 −m factors modulo p as the product of a ﬁrst-degree factor
and an irreducible second-degree factor if p = 6k −1, and (a) follows for such
primes from Theorem 5.6. If p = 6k + 1, then X3 −m either factors modulo p
as the product of three ﬁrst-degree factors or is irreducible, since 1 has three cube
roots. Thus (b) and (c) follow for such primes from Theorem 5.6.
For p = 2 if m is odd, then X3 −m ≡X3 −1 ≡(X −1)(X2 + X +1) mod 2,
and we are in the situation of (a). This completes the discussion of primes that
do not divide DK. If p divides m, then X3 −m ≡X3 mod p is the cube of a
ﬁrst-degree factor, and (d) follows in these cases. For p = 3 whether or not p
divides m, we have X3 −m ≡X3 −m3 ≡(X −m)3 mod 3, and (d) follows in
this case.
□

4. Cubic Number Fields as Examples
287
We conclude this section by discussing Dedekind’s example of a common
index divisor. The ﬁeld in question is again of degree 3 over Q but is not of the
form Q( 3√m ). Instead, the ﬁeld is K = Q(ξ), where ξ is a root of F(X) =
X3 + X2 −2X + 8. The polynomial F(X) is irreducible over Q because Gauss’s
Lemma shows that its only possible linear factors are X −k with k dividing 8
and because routine computation rules out each such linear factor. As usual, let
R be the ring of algebraic integers in K.
The different of ξ is D(ξ) = F′(ξ) = 3ξ 2 +2ξ −2, and the discriminant D(ξ)
therefore is given by D(ξ) = −NK/Q(3ξ 2+2ξ −2). We calculate this norm as the
determinant of left multiplication by 3ξ 2 + 2ξ −2 on K, using the ordered basis
(1, ξ, ξ 2). Since ξ 3 = −ξ 2 +2ξ −8 and ξ 4 = −ξ 3 +2ξ 2 −8ξ = 3ξ 2 −10ξ +8,
we have
(3ξ 2 + 2ξ −2)(1) = −2 + 2ξ + 3ξ 2,
(3ξ 2 + 2ξ −2)(ξ) = −2ξ + 2ξ 2 + 3ξ 3 = −24 + 4ξ −ξ 2,
(3ξ 2 + 2ξ −2)(ξ 2) = −2ξ 2 + 2ξ 3 + 3ξ 4 = 8 −26ξ + 5ξ 2.
Thus
NK/Q(3ξ 2 + 2ξ −2) = det
- −2
−24
8
2
4
−26
3
−1
5
.
= 22 · 503,
and D(ξ) = −22 · 503. Thus either the index J(ξ) of Z((ξ)) in R is 1 with
DK = −22 · 503, or J(ξ) = 2 with DK −503.
Problems 24–25 at the end of the chapter show that 1
2(ξ 2 + ξ) is in R and
that consequently the correct choice is J(ξ) = 2 with DK = −503 and with
{1, ξ, 1
2(ξ 2 + ξ)} as a Z basis of R. In fact, 2 divides J(η) for every primitive
element of K lying in R, and therefore 2 is a common index divisor in the sense
of Section 2. One way to check this assertion would be to calculate D(η) for
every such η. The computation would be feasible because we can express η as a
Z linear combination of the members of {1, ξ, 1
2(ξ 2 + ξ)} and calculate the ﬁeld
polynomial of η in the same way that NK/Q(ξ) was calculated above.
However, there is an easier way. Problem 28 at the end of the chapter shows
that (2)R splits as the product of three distinct prime ideals of R. If there were
some η for which 2 did not divide J(η), then Theorem 5.6 would show that the
minimal polynomial of η when reduced modulo 2 splits as the product of three
distinct ﬁrst-degree factors. But F2 has only 2 elements, hence only two possible
distinct linear factors to offer. Thus Theorem 5.6 must not be applicable to η and
the prime 2, and we conclude that 2 divides J(η). Going over this argument, we
see that we have established the following more general result.

288
V. Three Theorems in Algebraic Number Theory
Proposition 5.11. Let K/Q be a ﬁeld extension of degree n, and let R be the
ring of algebraic integers in K. If p is a prime number with 2 ≤p ≤n −1 such
that (p)R splits as the product of n distinct prime ideals of R, then p is a common
index divisor for K.
5. Dirichlet Unit Theorem
Let K be a number ﬁeld of degree n over Q, and let R be its ring of algebraic
integers. We regard K as a subﬁeld of C. The units of K are understood to
be the members of the group R× of units of the ring R. As was observed in
Section 2, there exist exactly n ﬁeld mappings of K into C, and we denote them
by σ1, . . . , σn; one of these is the inclusion of K into C. If x is in K, then the
images σ1(x), . . . , σn(x) are called the conjugates of x.
In Section I.6 we studied the group of units in the quadratic case n = 2,
and we found, particularly in the problems at the end of that chapter, that an
understanding of this group was essential to working successfully on the number-
theoretic problems studied in that chapter. When n = 2, we found that the
qualitative nature of the group R× depends on the sign of the ﬁeld discriminant.
The group turned out to be the ﬁnite subgroup of roots of unity in K if DK < 0,
and it turned out to be isomorphic to the product of a copy of Z and a cyclic group
of order 2 if DK > 0. The hard step in this analysis was constructing an element
in the subgroup Z in the latter case.
Because of the importance of R× in the quadratic case, we can expect that an
understanding of R× for our general number ﬁeldK is important for higher-degree
number-theoretic questions. In this section we shall obtain a structure theorem
for R× for general n analogous to the structure theorem for n = 2 mentioned in
the previous paragraph. Such a theorem may not answer all important questions
about R×, but it will be a good start.12 The main theorem is Theorem 5.13 below,
the Dirichlet Unit Theorem.
The units of R are the members ε of R with NK/Q(ε) = ±1. This simple fact
is veriﬁed for general K in the same way that it was veriﬁed for quadratic K in
Section I.6.
Any element ε of ﬁnite order in R× is a complex number with εk = 1 for
some k and hence lies on the unit circle of C. Since such an element ε is a root
of Xk −1, all its conjugates σj(ε) lie on the unit circle of C. We shall prove the
following proposition about these elements.
12For example, when n = 2, we deﬁned the fundamental unit ε1 for the case DK > 0 to be the
least unit > 1, and the sign of NK/Q(ε1) was a thorny question that we did not answer fully but that
affected results in the problems at the end of the chapter.

5. Dirichlet Unit Theorem
289
Proposition 5.12. The subgroup of R× of elements of ﬁnite order consists of
all lth roots of unity in C, where l is an integer depending on K that is bounded
when the degree n = [K : Q] is bounded.
PROOF. We are to bound the integers k for which primitive kth roots of unity
occur in K. Let k have prime decomposition k = pm1
1 · · · pmr
r . From Section
IX.9 of Basic Algebra, we know that the cyclotomic polynomial k(X) is a
monic irreducible member of Z[X] whose roots in C are exactly all primitive kth
roots of unity; moreover, the degree of k(X) is given by the Euler ϕ function:
ϕ(k) = k

p divides k

1 −1
p

.
If primitive kth roots of unity occur in K, then ϕ(k) ≤n because k(X) is
irreducible over Q, and hence (p1 −1) · · · (pr −1) ≤n. Allowing p1 = 2
possibly, we see that each factor pj −1 with j > 1 is at least 2, and thus
2r−1 ≤n. So r is bounded as a function of n by log2 2n, and we obtain
ϕ(k) ≥k

ﬁrst log2 2n
primes

1 −1
2

= 2−log2 2nk =
k
2n.
Consequently k ≤2nϕ(k) ≤2n2, as required. If R× contains one primitive kth
root of unity in C, then it contains them all, since the kth roots of unity form a
cyclic group and any primitive such root is a generator. The result follows.
□
We shall use the ﬁeld mappings σj : K →C for 1 ≤j ≤n to introduce useful
“absolute values” on K. The mappings σj are of two types:
(i) those carrying K into R,
(ii) those carrying K into C but not into R; these come in pairs σ and σ,
where σ denotes the composition of σ followed by complex conjugation.
Suppose that there are r1 mappings σj of the ﬁrst kind and that there are r2 pairs
of the second kind. Then r1 + 2r2 = n. Renumbering σ1, . . . , σn if necessary,
let us arrange that σ1, . . . , σr1 are of the ﬁrst kind, that σr1+1, . . . , σn are of the
second kind, and that σr1+r2+i = σ r1+i for 1 ≤i ≤r2. We introduce r1 + r2
absolute values13 on K by the deﬁnition
∥x∥s = |σs(x)|
for 1 ≤s ≤r1 + r2,
where | · | denotes the usual absolute value function on C. Then the function
Log : K× →Rr1+r2 given by
Log(ε) = (log ∥ε∥1, . . . , log ∥ε∥r1+r2)
13These are called archimedean absolute values of K in the general theory. Some authors refer
to them as archimedean valuations.

290
V. Three Theorems in Algebraic Number Theory
is evidently a group homomorphism.
A lattice in a Euclidean space Rl is an additive subgroup Zu1 ⊕· · ·⊕Zul such
that {u1, . . . , ul} is linearly independent over R. Such a subgroup is discrete,14
and the quotient is compact, by the Heine–Borel Theorem.
Theorem 5.13 (Dirichlet Unit Theorem). Let K be a number ﬁeld of degree n
with r1 +r2 absolute values, and let R be the ring of algebraic integers in K. The
kernel of the restriction to R× of the function Log is the ﬁnite subgroup of roots
of unity in K×, and the image of this restriction of Log is a lattice in the vector
subspace of elements (x1, . . . , xr1+r2) in Rr1+r2 satisfying
x1 + · · · + xr1 + 2xr1+1 + · · · + 2xr1+r2 = 0.
Consequently R× is a ﬁnitely generated abelian group of rank r1 + r2 −1.
EXAMPLES.
(1) The theorem reduces when n = 2 to results known from Chapter I.
Speciﬁcally if K = Q(√m ), then m > 0 makes r1 = 2 and r2 = 0, while
m < 0 makes r1 = 0 and r2 = 1.
(2) For K = Q(
3√
2 ), let ω = e2πi/3. The ﬁeld mappings of K into C carry K
into R or Rω or Rω2. Thus r1 = 1 and r2 = 1.
(3) The polynomial F(X) = X5−5X +1 in Q[X] was studied as an example in
connection with Galois theory in Section IX.11 of Basic Algebra. The polynomial
was shown to be irreducible over Q and to have three real roots and one pair of
complex conjugate roots. For K = Q[X]/(X5 −5X + 1), we therefore have
r1 = 3 and r2 = 1. The primitive element ξ of K with ξ 5 −5ξ + 1 = 0 lies in
R; it is a nontrivial example of a member of R× because ξ(ξ 4 −5) = −1.
The proof of Theorem 5.13 will occupy the remainder of this section. We
begin by clarifying in Lemma 5.14 the relationship between discrete subgroups
and lattices in Euclidean space and by proving in Proposition 5.15 a weak version
of Theorem 5.13 that addresses everything except the existence questions.
Lemma 5.14. A discrete subgroup of Rl is a free abelian group of rank ≤l
and is necessarily of the form Zu1 ⊕· · · ⊕Zum for some set {u1, . . . , um} that is
linearly independent over R. The discrete subgroup is a lattice if and only if the
rank is l.
14A discrete subset of Rl is a subset S such that every one-point subset of S is open when S is
given the relative topology. See Lemma 5.14 below for a converse assertion.

5. Dirichlet Unit Theorem
291
PROOF. We begin by proving that any discrete subgroup of Rl is topologi-
cally closed. Let G be the subgroup, and choose by discreteness an open ball
V = {x ∈Rl  |x| < ϵ} V about 0 with V ∩G = {0}. The open ball U =
{x ∈Rl  |x| < ϵ/2} has the property that U + U ⊆V . If G is not closed, let
x0 be a limit point of G that is not in G. Then the open ball x0 −U about x0
must contain a member g of G, and g cannot equal x0. Write x0 −u = g with
u ∈U. Then u = x0 −g is a limit point of G that is not in G, and we can ﬁnd
g′ ̸= 1 in G such that g′ is in u + U. But u + U ⊆U + U ⊆V , and so g′ is in
G ∩V = {0}, contradiction. We conclude that G contains all its limit points and
is therefore closed.
From the fact that any discrete subgroup G of Rl is closed, let us see that any
bounded subset of G is ﬁnite. It is enough to see that the intersection X of G with
any (ﬁnite-radius) closed ball is ﬁnite. The set X is closed because G is closed,
and it is therefore compact by the Heine–Borel Theorem. By discreteness, ﬁnd
for each g ∈G an open ball Ux centered at x that contains no member of G other
than x. These open sets form an open cover of the compact set X, and a ﬁnite
subcollection of them covers X. Each such open set contains only one member
of X, and hence X is ﬁnite.
Returning to the statement of the lemma, we induct on the dimension of the
R linear span of the discrete subgroup, the base case being that the R linear span
is 0. Let G be the discrete subgroup, and let {v1, . . . , vm} in G be a maximal set
that is linearly independent over R. Let G0 = G ∩
 	m−1
j=0 Rvj

. By induction
we may assume that every u ∈G0 is a Z linear combination of v1, . . . , vm−1. Let
S be the set of R linear combinations of {v1, . . . , vm} of the form
S =
(
v = c1v1 + · · · + cmvm ∈G
 0 ≤ci < 1 for 1 ≤i ≤m −1,
0 ≤cm ≤1
)
.
The set S is bounded, and we saw in the previous paragraph that any bounded
subset of G is ﬁnite. So S is ﬁnite. Let v′ be a member of S with the smallest
positive coefﬁcient for vm, say
v′ = a1v1 + · · · + amvm.
If v is any member of S and its coefﬁcient cm is not a multiple of am, then v −jv′
for a suitable integer j has mth coefﬁcient positive but less than am; by subtracting
from v −jv′ a suitable Z linear combination v′′ of v1, . . . , vm−1, we can make
v −jv′ −v′′ be in S, and then we have a contradiction to the minimality of
am. We conclude that cm is always a multiple of am. Then v −jv′ is in G0 for
some integer j, and it follows that the Z linear combinations of v1, . . . , vm−1, v′
span G. This completes the induction and the proof of the ﬁrst conclusion of the
lemma. The second conclusion is an immediate consequence of the ﬁrst.
□

292
V. Three Theorems in Algebraic Number Theory
For the remainder of the section, we adopt the notation in the statement of
Theorem 5.13, and we shall not repeat it in the statement of every intermediate
result.
Proposition 5.15 (weak form of Dirichlet Unit Theorem). The kernel of the
restriction to R× of Log is the ﬁnite subgroup of roots of unity in K×, and the
image of this restriction of Log is a discrete additive subgroup in the vector
subspace of elements (x1, . . . , xr1+r2) in Rr1+r2 satisfying
x1 + · · · + xr1 + 2xr1+1 + · · · + 2xr1+r2 = 0.
Consequently R× is a ﬁnitely generated abelian group of rank ≤r1 + r2 −1.
PROOF. For α in R×, we calculate that
log ∥α∥1 + · · · + log ∥α∥r1 + 2 log ∥α∥r1+1 + · · · + 2 log ∥α∥r1+r2
= log

|σ1(α)| · · · |σr1(α)||σr1+1(α)|2 · · · |σr1+r2(α)|2
= log

n
j=1
σj(α)

= log |NK/Q(α)| = log 1 = 0.
Hence the image lies in the vector subspace in the statement of the proposition.
Fix a (large) positive number M, and consider the set EM of all members α
of R× for which all coordinates of Log(α) are ≤M in absolute value. Then the
ﬁeld polynomials
det

X I −(left by α)

=
n
j=1
(X −σj(α))
of such elements α have all coefﬁcients bounded by some M′ depending on M,
since each |σj(α)| is of the form ∥α∥j and is ≤eM. Such a ﬁeld polynomial is
equal to g(X)r, where g(X) is the minimal polynomial of α and r is given by
r deg(g(X)) = n. Since α is in R, the coefﬁcients of g(X) are integers, and
hence so are the coefﬁcients of the corresponding ﬁeld polynomial. There are
only ﬁnitely many members of Z[X] of degree n whose coefﬁcients are in a given
bounded set, and hence there are only ﬁnitely many α’s in EM.
It follows that the image subgroup is discrete. Taking M = 0, we see also that
the kernel of the restriction of Log to R× is ﬁnite. Hence every element of this
kernel has ﬁnite order and is therefore a root of unity.
□

5. Dirichlet Unit Theorem
293
We come to the proof of Theorem 5.13. For quadratic extensions of Q, which
were handled in Section I.6, the crucial question of existence was addressed by
means of an approximation result (Lemma 1.15) for irrational numbers. That
result did not immediately establish the existence of units of inﬁnite order, but it
was applied inﬁnitely many times in the course of proving Proposition 1.16, and
the total effect was to produce a unit of inﬁnite order.
We do something similar in general. In place of the approximation result
in Lemma 1.15, we shall use a result known as the Minkowski Lattice-Point
Theorem, which asserts the existence of lattice points in certain compact convex
sets in Euclidean space. This result appears as Theorem 5.16 below. As was true
in the quadratic case, it is not just a single application of this theorem that produces
the desired units, but an inﬁnite sequence of applications of it. The details will
be more complicated here than in the quadratic case. Before describing how the
argument is to proceed, let us establish the Minkowski theorem.
Let {v1, . . . , vm} be an R basis of Rm, and let L = Zv1 ⊕· · · ⊕Zvm be the
corresponding lattice. The fundamental parallelotope for L corresponding to
this basis is the set

c1v1 + · · · + cmvm
 0 ≤cj ≤1 for 1 ≤j ≤m

.
The volume of this fundamental parallelotope is independent of the choice of the
Z basis for L. In fact, any two such Z bases are carried from one to the other by an
integer matrix of determinant ±1, and any linear transformation from Rm to itself
of determinant ±1 is volume preserving. The one fundamental parallelotope is
mapped to the other when the one basis is carried to the other, and hence the two
fundamental parallelotopes have the same volume.
Theorem 5.16 (Minkowski Lattice-Point Theorem).15 Let L be a lattice in
Rm, and let V0 be the volume of a fundamental parallelotope. If E is any compact
convex set in Rm containing 0, closed under negatives, and having volume(E) ≥
2mV0, then E contains a nonzero point of L.
REMARK. The constant 2m in the statement is best possible, as is shown by
taking L to be the standard lattice and E to be a cube oriented consistently with
L, centered at 0, and having each side slightly less than 2. We need merely some
constant, not the best possible one, in the application to Theorem 5.13, and the
proof can be simpliﬁed a little for that purpose.16 But the present theorem will be
applied again in the next section, and this time the best possible constant yields
the most useful information.
15The simple proof given here is due to H. Blichfeldt and is the standard one, so standard that
Blichfeldt’s name is sometimes attached to the theorem.
16In particular, the ﬁnal paragraph of the proof can be omitted, and we can ﬁx a value of M
proportional to s in making the argument.

294
V. Three Theorems in Algebraic Number Theory
PROOF. Without loss of generality, L is the standard lattice of points with all
coordinates in Z, and V0 is 1. Fix an arbitrarily small positive constant ϵ, and
ﬁrst assume that the given set E has volume(E) ≥(2 + ϵ)mV0. Arguing by
contradiction, suppose that the only lattice point in E is 0. Since E is bounded,
we can choose a number s > 0 in such a way that E is contained in the cube
Cs centered at 0, oriented consistently with the lattice, and having side 2s. Let
us see that the sets l + 1
2 E for l ∈L are disjoint. In fact, in obvious notation if
l1 + 1
2e1 = l2 + 1
2e2 with l1 ̸= l2, then l1 −l2 = 1
2(e2 −e1), and this is in E
because e2 and −e1 are in E and E is convex. Thus the sets l + 1
2 E are indeed
disjoint.
Choose an integer M large enough to have s/M < ϵ. Any lattice point l whose
coordinates are all ≤M in absolute value has l + 1
2 E ⊆CM+ 1
2 s. Since the sets
l + 1
2 E for these l’s are disjoint,
(2(M + 1
2s))m = volume(CM+ 1
2 s) ≥
	
all l∈L with
all coordinates ≤M
volume(l + 1
2 E)
≥(2M)mvolume( 1
2 E) = Mmvolume(E),
and therefore volume(E) ≤(2+s/M)m, in contradiction to our extra assumption
that volume(E) ≥(2 + ϵ)m.
Now suppose that volume(E) = 2m. For each ϵ > 0, let Eϵ be the dilate
(1 + 1
2ϵ)E. The sets Eϵ satisfy the extra assumption made in the previous part of
the proof, and therefore Eϵ contains a nonzero lattice point. Since E1 is bounded,
there are only ﬁnitely many possibilities for this nonzero lattice point for each
ϵ ≤1. Thus we can ﬁnd a sequence of ϵ’s tending to 0 for which this lattice point
is the same. The convexity of the sets Eϵ, in combination with the fact that the
sets contain 0, implies that the sets are nested, and therefore this lattice point lies
in Eϵ for all ϵ > 0. Since E is compact, E = 
ϵ>0 Eϵ, and therefore this lattice
point lies in E.
□
Let us describe the lattice to be used when the Minkowski Lattice-Point The-
orem is applied to obtain the Dirichlet Unit Theorem. Let  be the real vector
space  = Rr1 × Cr2 ∼= Rn, and let |ω|s be the magnitude of the sth component
of ω ∈ for 1 ≤s ≤r1 + r2. We introduce a homomorphism  of the additive
group of K into the additive group of  given by
(x) =

σ1(x), . . . , σr1(x), σr1+1(x), . . . , σr1+r2(x)

for x ∈K. We shall be mostly interested in the restriction of  to R, but the
values on K will help a little with motivation when the Minkowski Lattice-Point
Theorem is applied once again in the next section. Observe that our deﬁnitions
make ∥x∥s = |σs(x)| = |(x)|s for x ∈K and 1 ≤s ≤r1 + r2.

5. Dirichlet Unit Theorem
295
Lemma 5.17. The image (R) is a lattice in .
PROOF. The homomorphism  is one-one on R because σ1, being a ﬁeld map,
is one-one. Since R is a free abelian group of rank n and  is one-one, (R) is
free abelian of rank n. Lemma 5.14 therefore shows that it is sufﬁcient to show
that (R) is discrete as an additive subgroup of . It is enough to show that a
bounded region of  contains only ﬁnitely many points of (R).
The veriﬁcation of this fact is similar to an argument in the proof of Proposition
5.15: A bound by some M on all |σj(α)| for certain elements α ∈R implies that
each ﬁeld polynomial
det

X I −(left by α)

=
n
j=1
(X −σj(α))
has all its coefﬁcients bounded by some M′ depending on M. These coefﬁcients
areintegerswhenα isin R, andthusthereareonlyﬁnitelymanysuchpolynomials.
Each polynomial has at most n distinct roots, and consequently only ﬁnitely many
α’s satisfy such a bound.
□
We are now ready to prove Theorem 5.13, but we precede the proof by an
outline. The proof has three steps to it:
(1) We apply the Minkowski Lattice-Point Theorem to the set (R) ⊆,
which we know is a lattice because of Lemma 5.17. For each s0 with 1 ≤s0 ≤
r1 + r2, let Es0 be a set of ω’s in  deﬁned by the conditions that |ω|s is to be
small for s ̸= s0 and |ω|s0 is allowed to be large—with the understanding that
Es0 is a bounded set and that Es0 has volume ≥2nV0, where V0 is the volume
of a fundamental parallelotope of (R). Using a nonzero lattice point in (R)
obtained from applying Theorem 5.16 to Es0 and squeezing Es0 even more, we
can obtain an inﬁnite sequence of points α in R such that |NK/Q(α)| remains
bounded and such that the size of this norm is contributed to mostly by ∥α∥s0.
(2) Applying the same argument that was used for quadratic extensions of Q in
the proof of Proposition 1.16, we obtain inﬁnite sequences of units whose norm
is contributed to mostly by ∥· ∥s0. We can do this for 1 ≤s0 ≤r1 + r2.
(3) We pass to the Log map, proving and applying the following result from lin-
ear algebra: a real square matrix [ai j] with the property that |aii| > 	
j̸=i |ai j| for
alli is nonsingular. In the application of this result, we have log∥εs0∥s0 > 0 for the
s0th constructed unit, log ∥εs0∥s < 0 for s ̸= s0, and an equality that we can write
either as 	n
s=1 log ∥εs0∥s = 0 or as 	r1
s=1 log ∥εs0∥s + 2 	r1+r2
s=r1+1 log ∥εs0∥s = 0.
If we drop all terms corresponding to the (r1 +r2)th unit, then we are in a situation
for which the result from linear algebra immediately implies the theorem.

296
V. Three Theorems in Algebraic Number Theory
PROOF OF THEOREM 5.13. The proof is carried out in three steps.
Step 1. For ﬁxed s0 with 1 ≤s0 ≤r1 + r2, we construct an inﬁnite sequence
α(s0)
j
in R with
(i) |NK/Q(α(s0)
j
)| ≤2nV0,
(ii) ∥α(s0)
j
∥s tends to 0 for each s ̸= s0 as j tends to inﬁnity,
(iii) ∥α(s0)
j
∥s0 tends to inﬁnity as j tends to inﬁnity.
For the construction, form for each j > 0 the compact convex set in  closed
under multiplication by −1 consisting of all ω such that
|ω|s ≤j−1
for s ̸= s0,
|ω|s0 ≤
 2n jn−12−r1π−r2V0
if 1 ≤s0 ≤r1,
(2n jn−22−r1π−r2V0)1/2
if r1 + 1 ≤s0 ≤r1 + r2.
This set has volume
 (2 j−1)r1−1 · 2(2n jn−12−r1π−r2V0)(π j−2)r2 = 2nV0
if s0 ≤r1,
(2 j−1)r1(π j−2)r2−1π(2n jn−22−r1π−r2V0) = 2nV0
if s0 > r1.
Theorem 5.16 shows that the set contains a nonzero lattice point α(s0)
j
. Let us
check that this point satisﬁes (i), (ii), and (iii). For (i), we have
|NK/Q(α(s0)
j
)| =
 r1
j=1
∥α(s0)
j
∥s
 r1+r2

s=r1+1
∥α(s0)
j
∥s
2
≤
 ( j−1)r1−1(2n jn−12−r1π−r2V0) j−2r2
if s0 ≤r1
( j−1)r1( j−2)r2−1(2n jn−22−r1π−r2V0)
if s0 > r1
= 2nV02−r1π−r2
≤2nV0.
Property (ii) is immediate from the inequality ∥α(s0)
j
∥s ≤j−1 for s ̸= s0. For
(iii), we have
1 ≤|NK/Q(α(s0)
j
)| =
 r1
j=1
∥α(s0)
j
∥s
 r1+r2

s=r1+1
∥α(s0)
j
∥s
2;
thus (ii) implies (iii).
Step 2. For ﬁxed s0 with 1 ≤s0 ≤r1 + r2, we construct an inﬁnite sequence
of units ε(s0)
j
such that
(ii′) ∥ε(s0)
j
∥s tends to 0 for each s ̸= s0 as j tends to inﬁnity,
(iii′) ∥ε(s0)
j
∥s0 tends to inﬁnity as j tends to inﬁnity.

5. Dirichlet Unit Theorem
297
For the construction, we pass to a subsequence from Step 1, still denoting it by
α(s0)
j
, such that NK/Q(α(s0)
j
) is a constant integer, say M. Since R/(M) is ﬁnite,
we can pass to a further subsequence, still with no change in notation, such that
all α(s0)
j
lie in the same residue class17 modulo the principal ideal (M) of R. Put
ε(s0)
j
= α(s0)
j

α(s0)
1
.
Then NK/Q(α(s0)
j
) = NK/Q(α(s0)
1
), since NK/Q(α(s0)
j
) is a constant integer, and
1
M (α(s0)
j
−α(s0)
1
) is in R, since all α(s0)
j
lie in the same residue class modulo (M).
The computation
ε(s0)
j
= 1 +
α(s0)
j
−α(s0)
1
α(s0)
1
= 1 +
α(s0)
j
−α(s0)
1
M

σ̸=1
σ(α(s0)
1
)
shows that ε(s0)
j
is an algebraic integer. Hence it is in R. We certainly have
NK/Q(ε(s0)
j
) =
NK/Q(α(s0)
j
)
NK/Q(α(s0)
1
)
= M
M = 1.
Therefore ε(s0)
j
is a unit. Also, the computation
∥ε(s0)
j
∥s =
∥α(s0)
j
∥s
∥α(s0)
1
∥s
shows that (ii) and (iii) in Step 1 imply (ii′) and (iii′) here.
Step 3. For each s0 with 1 ≤s0 ≤r1 + r2, choose j large enough for the unit
ε(s0) = ε(s0)
j
in Step 2 to satisfy
(ii′′) ∥ε(s0)∥s < 1 if s ̸= s0,
(iii′′) ∥ε(s0)∥s0 > 1.
We assert that the vectors Log(ε(s0)) for 1 ≤s0 ≤r1 + r2 −1 are linearly
independent over R. Hence Log(R×) has rank ≥r1 + r2 −1, and Proposition
5.15 therefore implies that Log(R×) has rank equal to r1 + r2 −1.
To verify this assertion, form the square matrix [ai j] of size r1 + r2 given by
ai j =
 log ∥ε(i)∥j
if 1 ≤j ≤r1,
2 log ∥ε(i)∥j
if r1 + 1 ≤j ≤r1 + r2.
17This conclusion uses a result known as the Dirichlet pigeonhole principle or the Dirichlet
box principle.

298
V. Three Theorems in Algebraic Number Theory
Then aii > 0 for each i by (iii′′), ai j < 0 for i ̸= j by (ii′′), and 	
j ai j = 0 for
each i because NK/Q(ε(i)) = 1. Let [bi j] be the upper left block of [ai j] of size
r1 + r2 −1. For each i, we then have bii > 0 and 	
j with j̸=i |bi j| < bii. Let
us prove that the matrix [bi j] is nonsingular. Assuming the contrary, let [cj] be a
nonzero column vector with
	
j
bi jcj = 0
for all i.
(∗)
If i0 is an index such that |ci0| ≥|cj| for all j, then setting i = i0 leads to the
strict inequality
|ci0bi0i0| = |ci0|bi0i0 > |ci0| 	
j̸=i0
|bi0 j| ≥	
j̸=i0
|bi0 jcj| ≥
 	
j̸=i0
bi0 jcj
,
which contradicts (∗). Thus [bi j] is nonsingular.
We conclude that [bi j] has rank r1 + r2 −1.
Thus its rows are linearly
independent, and the ﬁrst r1 + r2 −1 rows of [ai j] must be linearly independent.
Therefore the vectors

log ∥ε(s0)∥1, . . . , log ∥ε(s0)∥r1, 2 log ∥ε(s0)∥r1+1, . . . , 2 log ∥ε(s0)∥r1+r2

,
indexed by s0 for 1 ≤s0 ≤r1+r2−1, are linearly independent in Rr1+r2. In other
words, the vectors Log(ε(s0)) are linearly independent for 1 ≤s0 ≤r1 + r2 −1.
□
6. Finiteness of the Class Number
As in Section 5, let K be a number ﬁeld of degree n over Q, and let R be its ring
of algebraic integers. Let σ1, . . . , σn be the distinct ﬁeld maps of K into C, and
assume that the ﬁrst r1 of them have image in R and the remaining ones come in
conjugate pairs with σr1+r2+k = σ r1+k for 1 ≤k ≤r2.
As in Section I.7, where we treated the case of quadratic extensions, we deﬁne
two nonzero ideals I and J of R to be equivalent if (r)I = (s)J for suitable
nonzero elements r and s of R. The same argument as given in that section
shows that the result is an equivalence relation. The principal ideals form a single
equivalence class.18
18Section I.7 worked also with a notion of strict equivalence of ideals, but we shall not attempt
to extend strict equivalence to the present setting.

6. Finiteness of the Class Number
299
Proposition 5.18. Multiplication of nonzero ideals in R descends to a well-
deﬁned multiplication of equivalence classes of ideals, and the resulting multi-
plication makes the set of equivalence classes into an abelian group. The identity
element of this group is the class of principal ideals.
REMARKS. The proofs of this result and of Theorem 5.19 below will use the
following fact proved in Problems 48–53 of Chapter VIII of Basic Algebra: if I
is any nonzero ideal in R and if I −1 is deﬁned by I −1 = {x ∈K | x I ⊆R}, then
I −1I = R and there exists r ∈R with r I −1 equal to an ideal of R. This fact can
be made to look more beautiful by introducing the notion of “fractional ideal,”
but we shall not carry out that step at this time.19
PROOF. If I is a nonzero ideal, let [I] denote its equivalence class, and deﬁne
[I][J] = [I J]. Suppose that (r)I = (s)I ′ exhibits an equivalence. Then the
equality (s)I ′J = (r)I J shows that [I ′J] = [I J]. A similar argument applies
in the J variable, and therefore multiplication of classes is well deﬁned. It is
immediate that multiplication of classes is associative and commutative and also
that the class of principal ideals is an identity. If a class [I] is given, let I −1 be
as in the remarks above, and choose a nonzero r ∈R such that r I −1 = J is an
ideal in R. Multiplying by J gives (r) = r(I −1I) = (r I −1)I = J I, and thus
[J][I] is the class of the principal ideals. So [I] has an inverse.
□
The group of equivalence classes of nonzero ideals as in Proposition 5.18 is
called the ideal class group of K. Its order is called the class number of K and
will be denoted by hK. The main theorem of this section is as follows.
Theorem 5.19. The class number hK of any number ﬁeld is ﬁnite.
As we shall see in a moment, it is not too difﬁcult at this stage to prove this
ﬁniteness. However, hK is an important invariant of a number ﬁeld that determines
whether R is a principal ideal domain, that occurs in various limit formulas in
the subject, and that occurs also in dimension formulas connected with “Hilbert
class ﬁelds.” It is therefore of considerable interest to be able to compute hK in
speciﬁc examples. For quadratic ﬁelds this computation can be carried out by
the techniques of Chapter I because of the close connection between ideal classes
and proper equivalence classes of binary quadratic forms. But no comparable
theory is available as an aid in computation for number ﬁelds of degree greater
than 2. As we shall see, the relatively easy proof of Theorem 5.19 that we give
in a moment does not offer any helpful clues about the value of hK. The main
19The result of the beautiﬁcation is that the fractional ideals form a group generated by the ideals,
and the group of equivalence classes is a homomorphic image of the group of fractional ideals.

300
V. Three Theorems in Algebraic Number Theory
task of this section will therefore be to provide a better proof of Theorem 5.19
that helps us ﬁnd the value of hK in speciﬁc examples.
The two proofs have the following lemma in common. The lemma eliminates
the notion of equivalence of ideals from the investigation and shows that the
problem is really that of ﬁnding elements in each ideal of relatively small norm.
Lemma 5.20. For a particular number ﬁeld K, if there exists a real constant C
with the property that each nonzero ideal J of R contains an element s ̸= 0 with
|NK/Q(s)| ≤C N(J),
then each equivalence class of ideals contains a member L whose absolute norm
satisﬁes N(L) ≤C. Consequently the class number hK is at most the number of
nonzero ideals I in R with N(I) ≤C. This is a ﬁnite number.
PROOF. Let a nonzero ideal I in R be given. By the remarks with Proposition
5.18, choose a nonzero element r in R and an ideal J such that r I −1 = J.
Multiplication by I and use of the remarks shows that (r) = J I. By hypothesis
for the lemma, choose a nonzero s ∈J with |NK/Q(s)| ≤C N(J). Since s is in
J, (s) is contained in J, and therefore (s) = J L for some ideal L. Multiplying
both sides of (r) = J I by L gives (r)L = L J I = (s)I, and L is therefore
equivalent to I. Applying Proposition 5.4, we obtain N(J)N(L) = N(J L) =
N((s)) = |NK/Q(s)| ≤C N(J). Therefore N(L) ≤C as required.
Let us now count the ideals I with N(I) ≤C.
In terms of the unique
factorization I = l
i=1 Pei
i
of I, we have N(I) ≥l
i=1 pei
i , where pi is the
prime number such that Pi ∩Z = (pi). In each case, N(Pi) ≥pi. There are
only ﬁnitely many primes p with p ≤C, each is associated with only ﬁnitely
many prime ideals P of R with P ∩Z = (p), and Pe contributes at least 2e
toward N(I). The inequality N(I) ≤C shows that these p’s and their associated
P’s are the only possible contributors to I and that each exponent is bounded by
log2 N(I). Hence there are only ﬁnitely many possibilities for I.
□
Here is the relatively easy proof of Theorem 5.19.
FIRST PROOF OF THEOREM 5.19. Let x1, . . . , xn be a Z basis of R, and express
members of R in terms of this basis as r = 	n
i=1 cixi with all ci ∈Z. The
value of NK/Q(r) is the value of the determinant of left multiplication by r on
K, and this value, as a function of c1, . . . , cn, is a homogeneous polynomial of
degree n. Consequently we can ﬁnd a constant C such that
NK/Q
 	n
i=1 cixi
 ≤
C max1≤i≤n |ci|n.
It is enough to show that the condition of Lemma 5.20 is satisﬁed for this C.
Thus let an ideal J be given. As each ci runs through the integers from 0 to

6. Finiteness of the Class Number
301
N(J)1/n, we obtain more than N(J) members r = 	n
i=1 cixi of R. Since there
are only N(J) cosets modulo J, at least two of these members of r, say r1 and
r2, must lie in the same coset.20 Then r1 −r2 is a nonzero member of J, it has all
coefﬁcients between −N(J)1/n and +N(J)1/n, and our construction of C forces
|NK/Q(r1 −r2)| ≤C

N(J)1/nn = C N(J).
□
The second proof of Theorem 5.19 is to combine Lemma 5.20 with the deeper
and more quantitative estimate given in the following theorem.
Theorem 5.21 (Minkowski). For any number ﬁeldK of degree n, each nonzero
ideal J of R contains an element s ̸= 0 with
|NK/Q(s)| ≤
 4
π
r2 n!
nn |DK|1/2N(J).
Here r2 is half the number of nonreal embeddings of K in C, and DK is the ﬁeld
discriminant. Therefore every equivalence class of ideals contains a member L
whose absolute norm satisﬁes
N(L) ≤
 4
π
r2 n!
nn |DK|1/2.
We shall prove Theorem 5.21 shortly by applying Minkowski’s Lattice-Point
Theorem to the lattice (J) in  = Rr1 ×Cr2, where  is the mapping described
after the proof of Theorem 5.16.
The particular compact convex set in the
application takes some time to describe, and we return to that matter shortly.
Meanwhile, let us see a little of the utility of Theorem 5.21. The techniques of
Chapter I are more useful for computing class numbers for n = 2 than Theorem
5.21 is, and we therefore consider only n ≥3.
For n = 3, we must have
r2 ≤1. Theorem 5.21 shows that every equivalence class of ideals in R has a
representative L with
N(L) ≤4
π
3!
33 |DK|1/2 = 8
9π |DK|1/2 < (0.283) |DK|1/2.
Problems 1–2 at the end of the chapter give examples of cubic extensions of Q
whose discriminants are −23, −31, and −44. Since these have (0.283)|DK|1/2 ≤
(0.283)7 < 2, the representative ideal in each case must have norm 1 and must
be R. Thus for all three of these cubic ﬁelds, R is a principal ideal domain.
20Again we are applying the Dirichlet pigeonhole principle.

302
V. Three Theorems in Algebraic Number Theory
For the cubic ﬁeld K = Q(
3√
2 ), we know from Section 2 that the discriminant
is DK = −108. Consequently the estimate shows that every class of ideals has
a representative with norm ≤2. If an ideal J has N(J) = 2, then 2 has to be a
member, and J divides (2)R. Proposition 5.10d shows that the factorization of
(2)R is as P3 for a certain unique prime ideal P. Thus R and P represent all
equivalence classes, and hK is 1 or 2. If there is some r ∈R with NK/Q(r) = 2,
then P = (r), and the class number is 1; otherwise it is 2. The element
3√
2 has
|NK/Q(
3√
2 )| = 2, and thus P = (
3√
2). Therefore R is a principal ideal domain
when K = Q(
3√
2 ).
For Dedekind’s example, namely the cubic number ﬁeld K built from
X3 + X2 −2X + 8, we saw in Section 4 that the discriminant is DK = −503.
Then the constant in the estimate is < (0.283)
√
503 < 6.35. So the interest is in
ideals of norm ≤6. In ruling out ideals that are principal, we need consider only
prime ideals with norm ≤6. Problems 24–32 at the end of the chapter identify
all the prime ideals of this form and show that they are all principal ideals! We
conclude that hK = 1, i.e., that the R in Dedekind’s example is a principal ideal
domain. Not every cubic number ﬁeld has class number 1, however; Problem 4
gives an example.
Before turning to the proof of Theorem 5.21, let us observe the following
striking consequence.
Corollary 5.22 (Minkowski). For any number ﬁeld K of degree n,
|DK|1/2 ≥
π
4
r2 nn
n! .
Therefore DK > 1 if n ≥2, and there exists at least one prime number that
ramiﬁes in K.
REMARKS. With a more general number ﬁeld F than Q as base ﬁeld, it can
happen that no prime ideal ramiﬁes in a certain nontrivial extension ﬁeld K/F.
See Problems 5–9 at the end of the chapter.
PROOF. Set J = R in Theorem 5.21, so that N(J) = 1. The nonzero element
s must have |NK/Q(s)| ≥1. The theorem says that (4/π)r2(n!/nn)|DK|1/2 ≥1,
and this is the displayed inequality of the corollary. Since r2 ≤1
2n, (π/4)r2 ≥
(π/4)n/2, and thus |DK|1/2 ≥2−nπn/2nn/n!.
Denote the right side of this
inequality by an.
For n = 2, we have a2 = π/2 > 1.
Also, an+1/an =
1
2π1/2(1 + 1
n)n ≥π1/2, since (1 + 1
n)n is monotone increasing21 with n and is
≥2 for n = 2. Hence an > 1 for all n ≥2. By Theorem 5.5 some prime number
ramiﬁes in K.
□
21To see this monotonicity, expand an+1 = (1 +
1
n+1)n+1 and an = (1 + 1
n )n by the Binomial
Theorem, and observe that the asserted inequality holds term by term.

6. Finiteness of the Class Number
303
We turn to the proof of Theorem 5.21.
We again make use of the map
 : K → = Rr1 × Cr2 ∼= Rn of the previous section. Lemma 5.17 shows that
(R) is a lattice in , and our interest will be in the sublattice (J), J being the
nonzero ideal under study. The idea is to consider the set of ω ∈ for which the
function
N(ω) =
 r1
i=1
|ω|i
 r1+r2

i=r1+1
|ω|2
i

has N(ω) ≤c, c being a positive number. Since N((x)) = |NK/Q(x)| for
x ∈K, the question of ﬁnding a member s of J with |NK/Q(s)| ≤c is the same
as the question of ﬁnding a nonzero lattice point in the set for which N(ω) ≤c.
Once we sort out how large c has to be for the answer to be afﬁrmative, then
the inequality of the theorem will result. The tool will again be the Minkowski
Lattice-Point Theorem (Theorem 5.16), but the difﬁculty is that the set for which
N(ω) ≤c is not necessarily convex.
The nature of the set for which N(ω) ≤c becomes clearer by considering the
case of K = Q(√m ) with m > 0. The map  carries x + y√m for x and y in
Q to the pair (x + y√m, x −y√m) in R2, and if we parametrize ω by the pair
(x, y), then the set for which N(ω) ≤c is the part of the (x, y) plane containing
the origin and bounded by the two hyperbolas x2 −my2 = c and x2 −my2 = −c.
This set is not convex, and it is not even bounded.
Brieﬂy, an individual coordinate of our  = Rr1 × Cr2, whether a factor of
type R or a factor of type C, contributes something compact convex to the set
for which N(ω) ≤c as long as the other coordinates are ﬁxed, but as soon as
we allow more than one coordinate to vary, then the product formula deﬁning
N(ω) produces sets that are neither convex nor bounded. To use Theorem 5.16,
we want to inscribe a compact convex set within the set for which N(ω) ≤c,
making the inscribed set contain the origin, be closed under negatives, and have
volume as large as possible.
If we were trying to inscribe such a compact convex set in a region cut out by
two hyperbolas as above, then the best possible set to use would be a rectangle
with sides parallel to the axes. However, the description above in terms of those
two hyperbolas used a noncanonical parametrization of elements of Q(√m ) as
all rational combinations x + y√m.
Let us proceed for the general case by using only the structure that is given to
us, without using any noncanonical parametrization. The things that are canonical
are the factorsR and C, the functions∥· ∥i deﬁned on them, and functions of these.
For the example above, the function N(ω) is given by N(ω) = |ω|1|ω|2. The
geometric set in R2 = {(ω1, ω2)} to consider is changed from above; it is still the
set toward the origin from two hyperbolas, but the hyperbolas are changed to be
ω1ω2 = ±c, having the axes as asymptotes. The inscribed convex set becomes the
set with |ω1| + |ω2| ≤2c1/2. The containment of the latter set in the set toward

304
V. Three Theorems in Algebraic Number Theory
the origin from the two hyperbolas follows from the inequality |ω1ω2|1/2 ≤
1
2(|ω1| + |ω2|), which is a consequence of the inequality 1
4(|ω1| −|ω2|)2 ≥0.
In the general case the inscribed convex set is described in terms of the function
T (ω) =
r1	
i=1
|ω|i + 2
r1+r2
	
i=r1+1
|ω|i.
The set of ω with T (ω) ≤t, t being a positive constant, is evidently a compact
convex set containing 0 and closed under negatives, and the functions T (ω) and
N(ω) are connected by the arithmetic–geometric mean inequality, which says
that
N(ω)1/n ≤1
n T (ω).
Because of this inequality the set with T (ω) ≤t is contained in the set with
N(ω) ≤tn/nn.
Since the absolute value in each R or C coordinate is canonical, so is the
notion of volume, given on rectangular sets by taking products; as usual the
understanding is that the set in a factor of R on which the absolute value is
≤k contributes a factor of 2k to the volume, and the comparable set in a factor
of C contributes a factor of πk2. If V0 denotes the volume of a fundamental
parallelotope for the lattice (J) in the n-dimensional Euclidean space , then
the Minkowski Lattice-Point Theorem says that the set with T (ω) ≤t, and
therefore also the set with N(ω) ≤tn/nn, contains a nonzero lattice point as
soon as the volume of the set with T (ω) ≤t is ≥2nV0. In other words, as soon
as the volume of the set with T (ω) ≤t is ≥2nV0, there exists an s ̸= 0 in J with
|NK/Q(s)| ≤tn/nn.
To prove Theorem 5.21, we therefore need to know two things—the volume V0
of a fundamental parallelotope for (J) and the volume of the set with T (ω) ≤t.
Then we can ﬁnd the smallest t for which the set with T (ω) ≤t has volume
≥2nV0, and we can sort out the details.
Let us compute the volume V0. Let  = (α1, . . . , αn) be an ordered Z basis
of the ideal J. The easy case in which to compute V0 is that r1 = n, i.e., that all
the ﬁeld embeddings of K into C are real. In this case the discriminant D() is
the determinant of the n-by-n matrix [Bi j] with
Bi j = TrK/Q(αiαj) =
n	
k=1
σk(αiαj) =
n	
k=1
σk(αi)σk(αj) =
n	
k=1
Aik At
jk,
where [Ai j] is the matrix with Ai j = σj(αi). We recognize | det[Ai j]| as the
volume of a fundamental parallelotope for (J), and therefore |D()| = V 2
0 .
By Proposition 5.1, D() = N(J)2DK, and therefore V0 = N(J)|DK|1/2.

6. Finiteness of the Class Number
305
This answer for the value of V0 is not correct if some of the embeddings of K
into C are nonreal, since | det[σj(αi)]| no longer equals V0. To see how to adjust
matters, suppose that σ is a nonreal ﬁeld mapping of K into C. Then the n-by-n
matrix [σj(αi)] contains one column z =
- z1...
zn
.
corresponding to σ and another
column ¯z =
- ¯z1...
¯zn
.
corresponding to σ. The entries in the kth row tell how αk is
embedded in , namely at some point zk = xk + iyk for σ and at ¯zk = xk −iyk.
To compute V0 properly, we should have xk in one column and yk in the other,
instead of zk and ¯zk. We can transform from the matrix with columns containing
zk and ¯zk to one containing xk and yk by ﬁrst replacing the ﬁrst column by the
sum of the two, which is 2xk = zk + ¯zk, and by then replacing the second column
by the difference of the second column and half the new ﬁrst column, which is
1
2(¯zk −zk) = −iyk. These operations do not change the determinant. Repeating
these steps for each of the r2 pairs of nonreal ﬁeld mappings, we obtain a matrix
for which the absolute value of the determinant, apart from factors of 2 inr2 of the
columns, is V0. Consequently V0 = 2−r2| det[σj(αi)]|. Then V 2
0 = 2−2r2|D()|,
and we obtain
V0 = 2−r2 N(J)|DK|1/2.
Now let us compute the volume of the set of ω in  for which T (ω) ≤t. Write
ω = (x1, . . . , xr1, zr1+1, . . . , zr1+r2). The volume is the integral of 1 over the set
on which |x1| + · · · + |xr1| + 2|zr1+1| + 2|zr1+r2| ≤t. The set for the integration
is invariant under xi 	→−xi and under rotation in any variable zi, and hence the
volume equals
2r1(2π)r2
/
E
ρr1+1 · · · ρr1+r2 dx1 · · · dxr1 dρr1+1 · · · dρr1+r2,
where E is the set on which all variables are ≥0 and
r1	
i=1
xi + 2
r1+r2
	
i=r1+1
ρi ≤t.
For r1 + 1 ≤i ≤r1 + r2, introduce xi = 2ρi, and make the change of variables.
Then the volume becomes
2r1−r2πr2
/
E′ xr1+1 · · · xr1+r2 dx1 · · · dxr1+r2,
where E′ is the set of (x1, . . . , xn) in Rr1+r2 with all xi ≥0 and with 	r1+r2
i=1 xi ≤t.
Finally we make a change of variables that replaces each xi by tyi, and the result
is that

306
V. Three Theorems in Algebraic Number Theory
volume({T (ω) ≤t}) = 2r1−r2πr2tn
/
S
yr1+1 · · · yr1+r2 dy1 · · · dyr1+r2,
where S is the standard simplex in Rr1+r2 with all yi ≥0 and with 	r1+r2
i=1
yi ≤1.
This deﬁnite integral is of a standard type that is evaluated by the following
lemma.
Lemma 5.23. In Rm, let S be the standard simplex with all xi ≥0 and with
	m
i=1 xi ≤1. If a1, . . . , am are positive real numbers, then
/
S
xa1−1
1
xa2−1
2
· · · xam−1
m
dx1 · · · dxm = (a1)(a2) · · · (am)
(a1 + · · · + am + 1).
REMARKS. The expression ( · ) is understood to be the usual gamma function,
whose value at positive integers is given by (n + 1) = n!. We merely sketch
the proof; the details can be found in many books that treat changes of variables
for multiple integrals.22
SKETCH OF PROOF. Let I be the unit cube, given by 0 ≤ui ≤1 for 1 ≤i ≤m.
We make the change of variables x = ϕ(u) that carries the points u of the cube
I one-one onto the points x of the simplex S and that is given by
x1 = u1,
x2 = (1 −u1)u2,
...
xm = (1 −u1) · · · (1 −um−1)um.
The volume element transforms by the absolute value of the Jacobian determinant,
speciﬁcally by
dx = |ϕ′(u)| du = (1 −u1)m−1(1 −u2)m−2 · · · (1 −um−1) du,
and the result of the change of variables is that the given integral equals
m

i=1
/ 1
0
uai−1
i
(1 −ui)
m
k=i+1 ak dui.
The factors here can be evaluated by means of Euler’s formula
/ 1
0
ua−1(1 −u)b−1 = (a)(b)
(a + b) ,
and the lemma follows.
□
22One such is the author’s Basic Real Analysis; the details appear in the problems at the end of
Chapter VI of that book. Another such book is Rudin’s Principles of Mathematical Analysis.

7. Problems
307
For the integral of interest to us, we have m = r1 + r2, a1 = · · · = ar1 = 1,
and ar1+1 = · · · = ar1+r2 = 2. Thus a1 +· · ·+am = r1 +2r2 = n, and we obtain
volume({T (ω) ≤t}) = 2r1−r2πr2tn (1)r1(2)r1+r2
(n + 1)
= 2r1−r2πr2tn
n!
.
Finally we can put everything together. We are to solve for t such that this
expression is equal to 2nV0, and then there exists an element s ̸= 0 in J with
|NK/Q(s)| ≤tn/nn. Since V0 = 2−r2 N(J)|DK|1/2, the equation to solve for t is
2r1−r2πr2tn
n!
= 2n2−r2 N(J)|DK|1/2.
Thus tn =

4
π
r2n!N(J)|DK|1/2, and the element s ̸= 0 in J satisﬁes
|NK/Q(s)| ≤
 4
π
r2 n!
nn |DK|1/2N(J).
This completes the proof of Theorem 5.21.
7. Problems
1.
Take as known that the discriminant of a cubic polynomial F(X) = X3+ pX +q
is −(4p3 + 27q2). In each of the following cases, let K = Q[X]/(F(X)) with
F(X) as indicated, and verify that the ﬁeld discriminant DK is as indicated:
(a) F(X) = X3 −X −1, DK = −23.
(b) F(X) = X3 + X + 1, DK = −31.
2.
Let K = Q[X]/(F(X)), where F(X) = X3 −2X2 + 2.
(a) Use the formula of the previous problem to show that the discriminant of
the polynomial F(X) is −44.
(b) Using Proposition 5.2, show that DK cannot be −11, and conclude that
DK = −44.
3.
This problem computes the class number of K = Q(
3√
3 ).
(a) Show that every equivalence class of nonzero ideals contains an ideal with
norm ≤4.
(b) Show that the prime ideals whose norm is a power of 2 are P1 = (2,
3√
3−1),
whose norm is 2, and P2 = (2,
3√
9 +
3√
3 + 1), whose norm is 4.
(c) Show for P1 that 2 is a multiple of
3√
3 −1, and show for P2 that 2 is a
multiple of
3√
9 +
3√
3 + 1.
(d) Show that the only prime ideal whose norm is 3 is (
3√
3 ).
(e) Deduce that the class number of K is 1.

308
V. Three Theorems in Algebraic Number Theory
4.
Let R be the ring of algebraic integers in the number ﬁeld K = Q(
3√
7 ), and let
I be the doubly generated ideal I = (2, 1 +
3√
7) in R.
(a) Prove that N(I) = 2.
(b) Prove that I is not a principal ideal.
Problems 5–9 give an example of a nontrivial ﬁnite extension L/K of number ﬁelds
in which no prime ideal for K ramiﬁes in passing to L. By contrast, Corollary 5.22
says that there always exists a prime that ramiﬁes in passing from Q to a nontrivial
ﬁnite extension. The example has L = Q(
√−5,
√
−1 ) and K = Q(
√
−5 ). Let
K′ = Q(
√
5 ) and K′′ = Q(√−1 ). Observe that L/Q is a Galois extension, and so
are all the various quadratic extensions of L over K, K′, and K′′, as well as of K, K′,
and K′′ over Q. The problems make use of the fact that ramiﬁcation indices multiply
in passing to an extension in stages, and so do residue class degrees.
5.
Show that the minimal polynomial of √
−1 +
√
−5 over Q is X4 + 12X2 + 16,
and deduce that the elements 1
2(±
√
−1 ±
√
−5 ) are algebraic integers in L.
6.
By making use the formula for D(ξ) in terms of D(ξ), where ξ is an element in
L, prove that |D( 1
2(
√
−1 +
√
−5))| = 2452. Consequently DL divides 2452.
7.
Verify the following decompositions of the ideals (2) and (5) when extended
from Z to the rings R, R′, and R′′ of algebraic integers in K, K′, and K′′:
(a) (2)R = ℘2 with f = 1, and (5)R = ℘2 with f = 1.
(b) (2)R′ = ℘with f = 2, and (5)R′ = ℘2 with f = 1.
(c) (2)R′′ = ℘2 with f = 1, and (5)R′′ = ℘1℘2 with f = 1.
8.
Let T be the ring of algebraic integers in L. Since L/Q is a Galois extension, the
only possible decompositions of (p)T , when p is a prime number, have (e, f, g)
equal to (4, 1, 1) or (2, 2, 1) or (2, 1, 2) or (1, 4, 1) or (1, 2, 2) or (1, 1, 4). Here
e is the ramiﬁcation index, f is the residue class degree, and g is the number of
distinct prime factors. Using the product formulas for ramiﬁcation degrees and
comparing what happens for the passage Q ⊆K′ ⊆L with what happens for
the passage Q ⊆K′′ ⊆L, show that the only possibilities for (p)T with p = 2
and p = 5 are
(a) (e, f, g) = (2, 2, 1) for (2)T , i.e., (2)T = P2 with dimF2(T/P) = 2.
(b) (e, f, g) = (2, 1, 2) for (5)T , i.e., (5)T = P2
1 P2
2 with dimF5(T/P1) =
dimF5(T/P2) = 1.
9.
Return to the situation with Q ⊆K ⊆L, where K = Q(√
−5 ). According to
Problem 7a, the prime decompositions of (2)R and (5)R are (2)R = ℘2
2 and
(5)R = ℘2
5.
(a) Using the results of Problem 8, show that ℘2T = P and ℘5T = P1P2, i.e.,
℘2T is prime, and ℘5T is the product of two distinct prime ideals.

7. Problems
309
(b) Show how to conclude from these facts and from Theorem 5.6 that no prime
ideal in R ramiﬁes in T . (Educational note: The ﬁeld L is the “Hilbert class
ﬁeld” of K in the sense of Section 1; the order of the Galois group Gal(L/K)
matches the class number of K.)
Problems 10–16 concern the cyclotomic ﬁeld K = Q(e2πi/p), where p > 2 is a
prime number. They show that the discriminant is given by DK = p p−2 and that a Z
basis of the ring R of algebraic integers in K consists of {1, ζ, ζ 2, . . . , ζ p−2}, where
ζ = e2πi/p.
10. Show that K has no real-valued ﬁeld mappings into C, and deduce that NK/Q(x)
is positive for every x ̸= 0 in K.
11. Let F(X) = X p−1 + X p−2 + · · · + 1 be the minimal polynomial of ζ over Q,
and let G(X) = F(X + 1). Suppose that k is an integer with GCD(k, p) = 1.
(a) Prove that G(X) is the minimal polynomial of ζ k −1, and deduce that the
norm of ζ k −1 is given by F(1) = p.
(b) Why does it follow that NK/Q(1 −ζ k) = p?
(c) Prove that (1 −ζ k)/(1 −ζ) is a unit of R.
12. With notation as in the previous problem, prove that the different D(ζ k) of ζ k
has |D(ζ k)| = p

|ζ k −1|.
13. Deduce from the previous problem that D(ζ) = (−1)(p−1)(p−2)/2 p p−2.
14. Let λ = 1 −ζ. Problem 11b shows that NK/Q(λ) = p. Prove that
(a) the Z span of {1, ζ, ζ 2, . . . , ζ p−2} equals the Z span of {1, λ, λ2, . . . , λp−2}.
(b) an equality p = p−1
k=1 (1 −ζ k) holds.
(c) there exists a unit ε of R such that p = ε(1 −ζ)p−1 = ελp−1.
15. Using Problem 14c, prove that the principal ideals (p)R and (λ) in R are related
by (p)R = (λ)p−1, and deduce from this fact that (λ) is a prime ideal.
16. Apply Proposition 5.2 to the Q basis {1, λ, λ2, . . . , λp−2} of K lying in R to show
that no factor of p2 can be eliminated from D(λ) = D(ζ); take into account the
highest powers of λ that divide each term. Conclude that DK = D(ζ) and that
{1, ζ, ζ 2, . . . , ζ p−2} is a Z basis of R.
Problems 17–18 use the same notation as in the text of the chapter: K is a number
ﬁeld of degree n over Q, R is its ring of algebraic integers, DK is its ﬁeld discriminant,
the ﬁeld mappings of K into C are denoted by σi for 1 ≤i ≤n, r1 of the σi’s are
real-valued, and r2 complex-conjugate pairs of the σi’s are nonreal.
17. Prove that the sign of DK is (−1)r2.
18. (Stickelberger’s condition) Let  = (α1, . . . , αn) be an ordered n-tuple of
members of R linearly independent over Q, and suppose that K/Q is a Galois
extension.
Write det[σj(αi)] = P −N, where P is the sum of all the terms of

310
V. Three Theorems in Algebraic Number Theory
the determinant corresponding to even permutations and N is the sum corre-
sponding to even permutations. Using Galois theory, prove that P + N and P N
are in Z. Then write D() = (det[σj(αi)])2 = (P+N)2−4P N, and deduce that
the integer D() is congruent to 1 or 0 modulo 4. (Educational note: A variant
of this argument proves the same conclusion about D() without the assumption
that K/Q is a Galois extension. One makes use of the smallest normal extension
of Q containing K; this is the splitting ﬁeld of the minimal polynomial of any
primitive element of K.)
Problems 19–23 continue with the notation of Problems 17–18. It is to be proved that
a suitable localization S−1R of R is a principal ideal domain for which the group of
units is ﬁnitely generated as an abelian group. Let h be the class number of K.
19. Let I1, . . . , Ih be ideals representing all the equivalence classes of ideals in R.
For each Ij, let uj be a nonzero element of Ij, and put u = u1 · · · uh. Deﬁne
S = {1, u, u2, . . . }. Prove that S−1R is a principal ideal domain.
20. (a) Prove that if a member a of R divides uk within R for some k ≥0, then a
is a unit in S−1R, i.e., a−1 is in S−1R.
(b) Prove conversely that if a member a of R has the property that au−m is a
unit in S−1R for some m ≥0, then a divides uk within R for some integer
k ≥0.
21. Let P1, . . . , Pl be the distinct prime ideals appearing in the unique factorization
of (u), and suppose that Ph
j = (bj) for 1 ≤j ≤l. Let au−m and k be as in
Problem 20b, and write uk = ab with b ∈R.
(a) Why must each bj necessarily be a unit in S−1R?
(b) Prove that there exist integers nj ≥0 for 1 ≤j ≤l such that the element
d = 
j b
nj
j has (a) = (d)Pt1
1 · · · Ptl
l for some integers tj with 0 ≤tj ≤h−1.
(c) In this case, why must Pe1
1 · · · Pel
l be a principal ideal?
22. Suppose that there are N tuples (e1, . . . , el) with 0 ≤ej ≤h −1 for all j such
that Pe1
1 · · · Pel
l
is a principal ideal. For the ith such tuple, let the principal ideal
be denoted by (ci), 1 ≤i ≤N. Prove that if k, a, and b are as in the previous
problem and if the principal ideal in (c) of that problem is (ci), then a = bciε
for some ε in R×.
23. Conclude from the three previous problems that the group of units of S−1R is
ﬁnitely generated as an abelian group.
Problems 24–32 complete the discussion in Section 4 of Dedekind’s example of a
cubic extension of Q with a common index divisor. The ﬁeld is K = Q(ξ), where
ξ is a root of F(X) = X3 + X2 −2X + 8, and it was shown in Section 4 that
D(ξ) = −22 · 503. Let R be the ring of algebraic integers in K. It will be shown that
R is a principal ideal domain.

7. Problems
311
24. Show that η = 4/ξ is a root of the polynomial G(X) = X3 −X2 + 2X + 8, and
conclude that η is in R.
25. (a) By rewriting F(ξ)/ξ in terms of ξ and η, show that ξ2 + ξ −2 + 2η = 0.
(b) By rewriting G(η)/η in terms of ξ and η, show that 2ξ + 2 −η + η2 = 0.
Conclude from thisformula and(a)that productsofξ andη maybe simpliﬁed
according to the table
ξ2 = −ξ + 2 −2η,
η2 = −2ξ −2 + η,
ξη = 4.
(c) Using the ﬁrst formula in (b), deduce the containment of abelian groups
given by Z({1, ξ, ξ2}) ⊆Z({1, ξ, η}).
(d) Using the ﬁrst formula in (b), deduce that η does not lie in Z({1, ξ, ξ2}).
(e) Conclude from the above facts that {1, ξ, η} and

1, ξ, 1
2(ξ2 + ξ)

are Z
bases of R.
26. Let P be a prime ideal in R containing (2)R, write F for the ﬁeld R/P, let
ϕ : R →F be the quotient homomorphism, and let ξ = ϕ(ξ) and η = ϕ(η). By
applying ϕ to the table in Problem 25b and using the fact that the additive group
generated by {1, ξ, η} is all of R, prove that F has only two elements, i.e., that
the residue class degree is f = 1, and that the only possibilities for ϕ are the
following:
ϕ = ϕ0,0
with
ϕ0,0(ξ) = 0,
ϕ0,0(η) = 0,
ϕ = ϕ1,0
with
ϕ1,0(ξ) = 1,
ϕ1,0(η) = 0,
ϕ = ϕ0,1
with
ϕ0,1(ξ) = 0,
ϕ0,1(η) = 1.
27. Conversely show that the three functions ϕ0,0, ϕ1,0, ϕ0,1 deﬁned on ξ and η in
the previous problem extend to well-deﬁned ring homomorphisms of R onto F2.
28. Let P0,0, P1,0, and P0,1 be the kernels of the ring homomorphisms in the previous
problem. Prove that these ideals all have norm 2 and that (2)R = P0,0P1,0P0,1.
29. (a) Prove that P0,0 = (2, ξ, η), P1,0 = (2, ξ + 1, η), and P0,1 = (2, ξ, η + 1).
(b) Exhibit η as a member of the ideal (2, ξ + 1), and show therefore that
P1,0 = (2, ξ + 1).
(c) Similarly show that P0,1 = (2, η + 1) and that P0,0 = (2, ξ −η).
30. The previous problem exhibited P0,0, P1,0, and P0,1 explicitly as doubly gener-
ated. In fact, use of the norm map NK/Q will ultimately show them to be principal
ideals.
(a) Show that if H(X) is the ﬁeld polynomial over Q of an element θ in K, then
NK/Q(θ) = −H(0) and NK/Q(θ −q) = −H(q) for every q ∈Q.
(b) Prove that NK/Q(ξ) = NK/Q(η) = −8 = −23, that |NK/Q(ξ + 3)| = 22,
that |NK/Q(ξ −1)| = |NK/Q(ξ + 2)| = 23, and that |NK/Q(ξ −2)| = 24.

312
V. Three Theorems in Algebraic Number Theory
(c) Prove that (ξ) = Pa
0,0Pb
1,0Pc
0,1 for unique exponents ≥0 whose sum is 3,
and that (η) = Pα
0,0Pβ
1,0Pγ
0,1 for unique exponents ≥0 whose sum is 3.
(d) Using the fact that ξη = 4, prove that a + α = b + β = c + γ = 2.
(e) Using the deﬁnitions of P0,0, P1,0, and P0,1 as kernels, prove that b = 0 and
γ = 0.
(f)
Conclude that (ξ) = P0,0P2
0,1 and that (η) = P0,0P2
1,0.
31. This problem uses the norm computations in Problem 30b.
(a) Using the deﬁning homomorphisms, show that if l is an odd integer, then
P1,0 contains (ξ + l), but P0,0 and P0,1 do not.
(b) Show that (ξ + 3) = P2
1,0 and that (ξ −1) = P3
1,0.
(c) Using the deﬁning homomorphisms, show that if l is an even integer, then
P0,1 contains (ξ + l), but P1,0 does not.
(d) Show that (2, ξ) = P0,0P0,1.
(e) Show that if l is an even integer not divisible by 4, then P2
0,1 does not contain
(ξ + l).
(f)
Show that (ξ + 2) = P2
0,0P0,1 and that (ξ −2) = P3
0,0P0,1.
32. (a) From the identity (ξ + 2)P0,0 = (ξ −2) that results from Problem 31f,
deduce that r0,0 = ξ−2
ξ+2 is in R and that P0,0 = (r0,0).
(b) Deduce similarly that P1,0 and P0,1 are principal ideals.
(c) Using Theorem 5.6, show that R contains no ideals of norm 3.
(d) Using Theorem 5.6, show that the only ideal in R of norm 5 is (5, 1 + ξ).
(e) Show that |NK/Q(1 + ξ)| = 10, and deduce that (1 + ξ) = (5, 1 + ξ)P,
where P is one of the three ideals P0,0, P1,0, and P0,1.
(f)
Why does it follow that (5, 1 + ξ) is a principal ideal?
(g) Prove that R is a principal ideal domain.

CHAPTER VI
Reinterpretation with Adeles and Ideles
Abstract. This chapter develops tools for a more penetrating study of algebraic number theory than
was possible in Chapter V and concludes by formulating two of the main three theorems of Chapter
V in the modern setting of “adeles” and “ideles” commonly used in the subject.
Sections 1–5 introduce discrete valuations, absolute values, and completions for ﬁelds, always
paying attention to implications for number ﬁelds and for certain kinds of function ﬁelds. Section 1
contains a prototype for all these notions in the construction of the ﬁeld Qp of p-adic numbers formed
out of the rationals. Discrete valuations in Section 2 are a generalization of the order-of-vanishing
function about a point in the theory of one complex variable. Absolute values in Section 3 are
real-valued multiplicative functions that give a metric on a ﬁeld, and the pair consisting of a ﬁeld and
an absolute value is called a valued ﬁeld. Inequivalent absolute values have a certain independence
property that is captured by the Weak Approximation Theorem. Completions in Section 4 are
functions mapping valued ﬁelds into their metric-space completions. Section 5 concerns Hensel’s
Lemma, which in its simplest form allows one to lift roots of polynomials over ﬁnite prime ﬁelds
Fp to roots of corresponding polynomials over p-adic ﬁelds Qp.
Section 6 contains the main theorem for investigating the fundamental question of how prime
ideals split in extensions. Let K be a ﬁnite separable extension of a ﬁeld F, let R be a Dedekind
domain with ﬁeld of fractions F, and let T be the integral closure of R in K. The question concerns
the factorization of an ideal pT in T when p is a nonzero prime ideal in R. If Fp denotes the
completion of F with respect to p, the theorem explains how the tensor product K ⊗F Fp splits
uniquely as a direct sum of completions of valued ﬁelds. The theorem in effect reduces the question
of the splitting of pT in T to the splitting of Fp in a complete ﬁeld in which only one of the prime
factors of pT plays a role.
Section 7 is a brief aside mentioning additional conclusions one can draw when the extension
K/F is a Galois extension.
Section 8 applies the main theorem of Section 6 to an analysis of the different of K/F and
ultimately to the absolute discriminant of a number ﬁeld. With the new sharp tools developed in the
present chapter, including a Strong Approximation Theorem that is proved in Section 8, a complete
proof is given for the Dedekind Discriminant Theorem; only a partial proof had been accessible in
Chapter V.
Sections 9–10 specialize to the case of number ﬁelds and to function ﬁelds that are ﬁnite separable
extensions of Fq(X), where Fq is a ﬁnite ﬁeld. The adele ring and the idele group are introduced
for each of these kinds of ﬁelds, and it is shown how the original ﬁeld embeds discretely in the
adeles and how the multiplicative group embeds discretely in the ideles. The main theorems are
compactness theorems about the quotient of the adeles by the embedded ﬁeld and about the quotient
of the normalized ideles by the embedded multiplicative group. Proofs are given only for number
ﬁelds. In the ﬁrst case the compactness encodes the Strong Approximation Theorem of Section 8
and the Artin product formula of Section 9. In the second case the compactness encodes both the
ﬁniteness of the class number and the Dirichlet Unit Theorem.
313

314
VI. Reinterpretation with Adeles and Ideles
1. p-adic Numbers
This chapter will sharpen some of the number-theoretic techniques used in
Chapter V, ﬁnally arriving at the setting of “adeles” and “ideles” in which many
of the more recent results in number theory have tidy formulations. Although
Chapter V dealt only with number ﬁelds, the present chapter will allow a greater
degree of generality that includes results in the algebraic geometry of curves.
This greater degree of generality will not require much extra effort, and it will
allow us to use each of the subjects of number theory and algebraic geometry to
motivate the other.
The ﬁrst section of Chapter V returned to the idea that one can get some
information about the integer solutions of a Diophantine equation by considering
the equation as a system of congruences modulo each prime number. However,
we lose information by considering only primes for the modulus, and this fact
lies behind the failure of Chapter V to give a complete proof of the Dedekind
Discriminant Theorem (Theorem 5.5). The proof that we did give was of a related
result, Kummer’s criterion (Theorem 5.6), which concerns a ﬁeld Q(ξ), where
ξ is a root of an irreducible monic polynomial F(X) in Z[X]. The statement of
Theorem 5.6 involves the reduction of F(X) modulo certain prime numbers p
and no other congruences.
The Chinese Remainder Theorem tells us that a congruence modulo any integer
canbesolvedbymeansofcongruencesmoduloprimepowers, andtheformulation
of Theorem 5.6 uses only congruences modulo primes raised to the ﬁrst power.
Let us strip away the complicated setting from such congruences and see some
examples of how the use of prime powers can make a difference.
EXAMPLES.
(1) Consider the problem of ﬁnding a square root of 5 modulo powers of 2.
For the ﬁrst power, we have
x2 −5 = (x −1)2 + 2x −6 ≡(x −1)2 mod 2,
i.e., x2 −5 is the square of a linear factor modulo 2. For the second power, the
computation is
x2 −5 = (x −1)(x + 1) −4 ≡(x −1)(x + 1) mod 4,
and x2 −5 is the product of two distinct linear factors modulo 4. For the third
power, x2 −5 is irreducible modulo 8 because the only odd squares modulo 8 are
±1. Thus the polynomial x2−5 exhibits a third kind of behavior when considered
modulo 8. For higher powers of 2, the irreducibility persists because a nontriv-
ial factorization modulo 2k with k > 3 would imply a nontrivial factorization
modulo 8.

1. p-adic Numbers
315
(2) Consider the problem of ﬁnding a square root of 17 modulo powers of 2.
We readily compute that
x2 −17 = (x −1)2 + 2x −18
≡(x −1)2 mod 2,
x2 −17 = (x −1)(x + 1) −16 ≡(x −1)(x + 1) mod 4,
x2 −17 = (x −1)(x + 1) −16 ≡(x −1)(x + 1) mod 8,
x2 −17 = (x −1)(x + 1) −16 ≡(x −1)(x + 1) mod 16,
x2 −17 = (x −7)(x + 7) + 32 ≡(x −7)(x + 7) mod 32,
x2 −17 = (x −9)(x + 9) + 64 ≡(x −9)(x + 9) mod 64,
i.e., that the factorization of x2 −17 begins in the same way as for x2 −5 but that
x2 −17 continues to factor as the product of two distinct linear factors modulo
23, 24, 25, and 26. We can argue inductively that this pattern persists through all
higher powers. In fact, suppose that x2 −17 = (x −m)(x + m) mod 2k for an
integer k ≥3. Then
x2 −17 = x2 −m2 + a2k,
and m must be odd. Then we can write
x2 −17 = x2 −(m −a2k−1)2 + a2k(1 −m + a2k−2).
The factor (1 −m + a2k−2) is even, and this equality shows that x2 −17 is the
product of two distinct linear factors modulo 2k+1. This completes the induction.
One immediate observation from the two examples is that the factorizations
of x2 −5 and x2 −17 are the same modulo 2 and modulo 22 but are qualitatively
distinct modulo higher powers of 2. Another observation is the nature of the data
produced by the inductive argument in Example 2: For each k, we obtain an odd
integer mk such that m2
k ≡17 mod 2k, and the mk’s are constructed in such a
way that mk+1 = mk −ak2k−1 if m2
k = 17 + ak2k. It follows that if l ≥k, then
mk −ml is divisible by 2k−1, i.e., by higher and higher powers of 2 as k increases.
A ﬁrst conclusion is that we get additional information by using congruences
modulo prime powers. A second and more subtle conclusion is that it would be
desirable to regard the sequence {mk} as stabilizing in some sense; then we could
regard the system of congruences modulo all powers 2k as having a single pair
of solutions that we can consider as square roots of 17. In this case we would
not have to think about inﬁnitely many solutions to inﬁnitely many unrelated
congruences.
The construction that is to follow in this section, which is due to K. Hensel,
will capture this information as a single “2-adic number.” Conversely the 2-adic
number carries with it the congruence information modulo 2k for all positive
integers k.

316
VI. Reinterpretation with Adeles and Ideles
Thus the revised method of considering congruences prime by prime will be
a two-step process, ﬁrst a step of “localization” and then a step of “completion.”
In our application in Chapter V, we did not explicitly make use of localization
in the sense of Chapter VIII of Basic Algebra, but it was there implicitly—in
Proposition 5.2 for example and in the proof of Theorem 5.6. Carrying out the
details of setting up the theory behind the two-stage process will take some work
and will occupy the ﬁrst four sections of this chapter. Let us get started.
Let p be a prime number. We deﬁne a real-valued function | · |p on the ﬁeld
Q of rationals as follows: we take |0|p = 0, and for any rational r = pmab−1
with a and b equal to integers relatively prime to p, we deﬁne |r|p = p−m. The
function | · |p is called the p-adic absolute value on Q. It has the following
properties:
(i) |x|p ≥0 with equality if and only if x = 0,
(ii) |x + y|p ≤max(|x|p, |y|p),
(iii) |xy|p = |x|p|y|p,
(iv) | −1|p = |1|p = 1, and
(v) | −x|p = |x|p.
In fact, with (ii), equality holds if |x|p ̸= |y|p, and the case with |x|p = |y|p
comes down to the observation that a
b + c
d = ad+bc
bd
has no factor of p in its
denominator if b and d are relatively prime to p. Property (iii) comes down to the
fact that if a, b, c, d are relatively prime to p, then so are ac and bd. The other
properties follow from the ﬁrst three: To see that |1|p = 1 in (iv), we observe
from (iii) that |1|p is a nonzero solution of x2 = x and thus has to be 1. This
conclusion and (iii) together show that |−1|p is a positive solution of x2 = 1 and
thus has to be 1. Property (v) follows immediately by combining (iii) and (iv).
Inequality (ii) is called the ultrametric inequality. It implies that |x + y|p ≤
|x|p +|y|p, and consequently the function d(x, y) = |x −y|p satisﬁes the triangle
inequality
d(x, y) ≤d(x, z) + d(z, y).
Since (i) shows that d(x, y) ≥0 with equality exactly when x = y and since (v)
implies that d(x, y) = |x −y|p = d(y, x), the function d on Q × Q is a metric.
It is called the p-adic metric on Q.
The ﬁeld Qp of p-adic numbers will be obtained by completing this metric and
extending the ﬁeld operations to the completion. Let us see to the details. Regard
the space ∞
j=1 Q of sequences {qj}∞
j=1 of rational numbers as the direct product
of copies of the ring Q, the operations being taken coordinate by coordinate.
Then ∞
j=1 Q is a commutative ring with identity, the identity being the sequence
whose terms are all equal to 1.

1. p-adic Numbers
317
As is usual for metric spaces, we say that a sequence of rationals, i.e., a member
{qj} of ∞
j=1 Q, is convergent to q ∈Q in the p-adic metric if for any real ϵ > 0,
there exists an integer N such that |qn −q|p < ϵ for all n ≥N. Convergence
in this metric is quite different from what one might expect; for example the
sequence {2 j}∞
j=1 is convergent to 0 when p = 2. The sequence {qj} is a Cauchy
sequence in the p-adic metric if for any real ϵ > 0, there exists an integer N
such that |qm −qn|p < ϵ for all m ≥N and all n ≥N. Convergent sequences
are Cauchy, as follows from the inequality |qm −qn|p ≤|qm −q|p + |q −qn|p.
Cauchy sequences need not be convergent, but every Cauchy sequence {qn} is
bounded in the sense that there is some real C with |qn|p ≤C for all n.
EXAMPLE 2, CONTINUED. We obtained a sequence {mk} of odd integers such
that l ≥k implies that mk −ml is divisible by 2k−1 and m2
k −17 is divisible by 2k.
In terms of the 2-adic absolute value, |mk −ml|p ≤2−(k−1) and |m2
k −17|p ≤2−k.
The sequence {mk} is therefore a Cauchy sequence in the 2-adic metric, and the
sequence {m2
k} is convergent in the 2-adic metric to 17.
It follows from the ultrametric inequality that the sum and difference of Cauchy
sequences is bounded, and (ii) and the boundedness of Cauchy sequences implies
that the product of two Cauchy sequences is Cauchy. Therefore the subset R of
Cauchy sequences is a subring with identity within ∞
j=1 Q.
In the theory of metric spaces, one deﬁnes a suitable notion of equivalence of
Cauchy sequences, and the set of equivalence classes becomes a complete metric
space,1 any member q of Q being identiﬁed with the constant Cauchy sequence
whose terms all equal q. With the p-adic metric, one can then prove that the ﬁeld
operations extend to the completion, and the completion is the ﬁeld of p-adic
numbers. This veriﬁcation is a little tedious when done directly, and we can
proceed more expeditiously by using some elementary ring theory.
Since convergent sequences are Cauchy, the set I of sequences convergent to 0
is a subset of the ring R. The sum or difference of two such sequences is again
convergent to 0, and I is an additive subgroup. We shall show that I is in fact
an ideal in R. Thus let {zn} be convergent to 0, and let {qn} be Cauchy. Since
{qn} is Cauchy, it is bounded, say with |qn|p ≤M for all n. If ϵ > 0 is given,
choose N such that n ≥N implies |zn|p ≤ϵ/M. Then n ≥N implies that
|znqn|p = |zn|p|qn|p ≤(ϵ/M)M = ϵ. Hence {znqn} is convergent to 0, and I is
an ideal in R.
Proposition 6.1. With the p-adic absolute value imposed on Q, let R be the
subring of ∞
j=1 Q consisting of all Cauchy sequences, and let I be the ideal in
1This construction is carried out in detail in Section II.11 of the author’s Basic Real Analysis.

318
VI. Reinterpretation with Adeles and Ideles
R consisting of all sequences convergent to 0. Then I is a maximal ideal in R,
and the quotient R/I is a ﬁeld. Consequently the Cauchy completion of Q in the
p-adic metric is a topological ﬁeld Qp into which Q embeds via a ﬁeld mapping.
If | · |p denotes the function d( · , 0) on Qp, then | · |p is a continuous extension
of the p-adic absolute value from Q to Qp, and it satisﬁes
(a) |x|p ≥0 with equality if and only if x = 0,
(b) |x + y|p ≤max(|x|p, |y|p), and
(c) |xy|p = |x|p|y|p.
The subset Zp =

x ∈Qp
 |x|p ≤1

is an open closed subring of Qp in which
Z is dense, and Zp is compact. Consequently the topological ﬁeld Qp is locally
compact.
REMARKS. The ﬁeld Qp is called the ﬁeld of p-adic numbers, and the ring
Zp is called the ring of p-adic integers. The ring Zp contains the identity of Qp.
PROOF. First let us prove that I is a maximal ideal. Arguing by contradiction,
let {qn} be a Cauchy sequence that is not in I, i.e., is not convergent to 0. Then
there exists an ϵ0 > 0 such that |qn|p ≥ϵ0 for inﬁnitely many n. Choose N such
that |qn −qm| < ϵ0/2 whenever n ≥N and m ≥N, and ﬁnd some n0 ≥N with
|qn0|p ≥ϵ0. Then n ≥N implies that |qn|p ≥ϵ0/2 because otherwise we would
have ϵ0 ≤|qn0|p ≤|qn −qn0|p + |qn|p < ϵ0/2 + ϵ0/2 = ϵ0, contradiction. Let
{rn} be the sequence with rn = 0 for n < N and rn = q−1
n
for n ≥N. For n ≥N
and m ≥N, we have
|rn −rm|p = |q−1
n
−q−1
m |p = |(qm −qn)/(qmqn)|p
= |qm −qn|p|qm|−1
p |qn|−1
p
≤4ϵ−2
0 |qm −qn|p,
and it follows that {rn}p is Cauchy and hence lies in R. Since I is an ideal in R,
{rnqn} is Cauchy. The terms of the sequence {rnqn} are all equal to 1 for n ≥N,
and hence {rnqn} differs from the identity of R by a member of I. Consequently
the identity is in I. This is a contradiction, since the members of the constant
sequence {1} are at distance |1 −0|p = 1 from 0. Hence I is a maximal ideal,
and R/I is necessarily a ﬁeld.
Meanwhile, the Cauchy completion Qp of Q is the set of equivalence classes
from R, two members of R being equivalent if they differ by a sequence conver-
gent to 0. Consequently the Cauchy completion Qp is precisely R/I as a set. The
mapping Q →R →R/I carrying a member q of Q to the constant sequence
{qn} with all qn = q and then from R to the quotient R/I = Qp evidently respects
the operations and hence is a ﬁeld mapping. This mapping identiﬁes Q with a
subset of Qp. The metric d on Q extends uniquely to a continuous function on

1. p-adic Numbers
319
the completion Qp ×Qp, and therefore the p-adic absolute value | · |p = d( · , 0)
extends to a continuous function on Qp.
Property (a) for the function | · |p on Qp follows from the fact that the
continuous extension of d is a metric on Qp. To see that (b) and (c) hold on
Qp, let x and y be members of Qp = R/I, and let {qn} and {rn} be respective
coset representatives of them in R. Then {qn +rn} and {qnrn} are representatives
of x + y and xy by deﬁnition, and the continuity of the p-adic absolute value on
Qp implies that limn |qn + rn|p = |x + y|p and limn |qnrn|p = |xy|p. From the
ﬁrst of these limit formulas and from (b) on Q, we obtain
|x + y|p = lim sup
n
|qn + rn|p ≤lim sup
n
max(|qn|p, |rn|p) = max(|x|p, |y|p),
since limn |qn|p = |x|p and limn |rn|p = |y|p. This proves (b) on Qp. Similarly
|xy|p = lim
n |qnrn|p = lim
n |qn|p|rn|p = (lim
n |qn|p)(lim
n |rn|p) = |x|p|y|p,
and this proves (c) on Qp.
To see that addition, subtraction, and multiplication are continuous onQp×Qp,
let {xn} and {yn} be convergent sequences in Qp with respective limits x and y.
Use of (b) on Qp gives
|(xn + yn) −(x + y)|p = |(xn −x) + (yn −y)|p ≤max(|xn −x|p, |yn −y|p).
The right side has limit 0 in R, and therefore xn + yn has limit x + y in Qp. A
completely analogous argument, making use also of the equality | −1|p = |1|p,
shows that subtraction is continuous. Consider multiplication. If M is an upper
bound for the absolute values |xn|p and |yn|p, then use of (c) on Qp gives
|xnyn −xy|p = |xn(yn −y) + y(xn −x)|p
≤max(|xn(yn −y)|p, |y(xn −x)|p)
= max(|xn|p|yn −y|p, |y|p|xn −x|p)
≤max(M|yn −y|p, |y|p|xn −x|p).
The right side has limit 0 in R, and therefore xnyn has limit xy in Qp.
To see that inversion x 	→x−1 is continuous on Q×
p , let {xn} be a sequence in
Q×
p with limit x in Q×
p . Since limn |xn|p = |x|p, we can ﬁnd an integer N such
that |xn|p ≥1
2|x|p for n ≥N. The computation
|x−1
n
−x−1|p = |(x −xn)/(xnx)|p = |x −xn|p/(|xn|p|x|p) ≤2|x|−1
p |x −xn|p,

320
VI. Reinterpretation with Adeles and Ideles
valid for n ≥N, shows that lim x−1
n
= x−1, and inversion is continuous. Conse-
quently Qp is a topological ﬁeld.
It follows immediately from properties (b) and (c) and from the equality
| −x|p = |x|p that Zp is a subring of Qp. Since Zp is deﬁned in terms of a
continuous function and an inequality, it is closed. It can also be deﬁned as
the subset with |x|p < p because the p-adic absolute value takes no values
between 1 and p, and therefore Zp is open. The most general nonzero member
of Q ∩Zp is of the form q = a/b, where a and b are relatively prime nonzero
integers with |a/b|p ≤1. Here |b|p = 1, and p cannot divide b. If k > 0 is
given, then it follows that there exists n with bn −a ≡0 mod pk. This n has
|n −a
b|p = |bn −a|p ≤p−k. So q is in the closure of Z in Qp. In other words,
the closure of Z contains Q ∩Zp. Since Q is dense in Qp, Z is dense in Zp.
For each integer n ≥0, the set Zp is covered by the closed balls of radius
p−n centered at the integers 0, 1, 2, . . . , pn −1. In fact, every integer z has z ≡
k mod pn for some integer k ∈{0, 1, 2, . . . , pn −1}. For this k, |z −k|p ≤p−n.
Thus Z is contained in the union of the closed balls of radius p−n centered at
0, 1, 2, . . . , pn −1. This union is closed; since Z is dense in Zp, Zp is contained
in this union. In turn, these closed balls are contained in the open balls of radius
p−n+1 centered at the integers 0, 1, 2, . . . , pn −1. Thus for any positive radius,
there exists a ﬁnite collection of open balls of that radius or less such that the
union of the open balls covers Zp. This means that Zp is totally bounded in the
metric space Qp. A totally bounded closed subset of a complete metric space is
compact, and consequently Zp is compact.
Thus the 0 element of Qp has Zp as a compact neighborhood. Since addition
is continuous, x +Zp is a compact neighborhood of x, and therefore Qp is locally
compact.
□
2. Discrete Valuations
The construction of the p-adic absolute value on Q seemingly made use of unique
factorization of the members of Z, but actually the unique factorization of the
ideals in Z would have been sufﬁcient. Thus we shall see in a moment that the
construction extends to apply to any number ﬁeld F as soon as we specify a
nonzero prime ideal P in the ring R of algebraic integers of F. In fact, there
is nothing special about a number ﬁeld. If R is any Dedekind domain and F is
its ﬁeld of fractions, then the construction extends to F as soon as we specify a
nonzero prime ideal P in R.
Before describing the extended construction, let us look at the deﬁnition of
the p-adic absolute value on Q more closely. Recall that if x = pmab−1 for
integers a and b relatively prime to p, then |x|p = p−m. Actually, the base p
in this exponential is not very important at this point, and we could have used

2. Discrete Valuations
321
any real number r > 1 in place of p in p−m. With this adjustment the p-adic
absolute value would have been given by |x|p = r−vp(x), where vp(x) is the exact
net power of p that occurs when the prime factorizations of the numerator and
denominator of x are used. The exponent vp(x) is what is important; the base r
is unimportant.
The expression vp(x) for Q is analogous to the order of vanishing of a poly-
nomial in one complex variable at a point, and Hensel was led to the p-adic
absolute value by carrying the notion for C[X] to the setting with Q. In setting
up a generalization, we shall work ﬁrst with the generalization of the order of
vanishing vp(x), since it is the more primitive notion, and in Section 3 we shall
exponentiate to obtain a generalization of the absolute value for which we can
form a completion.
To make the deﬁnitions, it is convenient to make use of fractional ideals, which
were the subject of a set of problems in Chapter VIII of Basic Algebra. Let us
recall the deﬁnition and the relevant properties.
Again let R be a Dedekind
domain, and let F be its ﬁeld of fractions. A fractional ideal of F is any ﬁnitely
generated R module M. For such an R module, there exists some a ∈R with
aM ⊆R, and then aM is an ideal of R. If M is any nonzero fractional ideal,
then M−1 = {x ∈F | x M ∈R} is a nonzero fractional ideal, and M M−1 = R.
With this deﬁnition and property, it readily follows from the unique factorization
of ideals in R that any nonzero fractional ideal M of F is of the form
M =
l
j=1
P
kj
j ,
for a suitable set {P1, . . . , Pl} of distinct nonzero prime ideals of R and for suitable
nonzero integer exponents kj. This expansion is unique up to the order of the
factors, and every such expression is a fractional ideal. It follows that the nonzero
fractional ideals form a group under multiplication. At the end of this section, we
shall mention how this group is related to the ideal class group of F as deﬁned in
Section V.6.
If x ̸= 0 is in F, then the principal fractional ideal (x) = x R has a
factorization as above. If P is a nonzero prime ideal of R, we let vP(x) be
the negative of the integer exponent of P in the prime factorization of (x). For
example, if x is a nonzero element of R, then vP(x) is a nonnegative integer. To
make vP( · ) be everywhere deﬁned on F, we deﬁne vP(0) = +∞. Then vP( · )
is function from F onto Z ∪{+∞} such that
(i) vP(x) = +∞if and only if x = 0,
(ii) vP(x + y) ≥min(vP(x), vP(y)) for all x and y, and
(iii) vP(xy) = vP(x) + vP(y) for all x and y.
We shall see in Proposition 6.4 below that the effect of vP( · ) is to pick out from
F the localization of R at P.

322
VI. Reinterpretation with Adeles and Ideles
To proceed further, we abstract the above construction and see what informa-
tion we can recover from it. Let F be any ﬁeld. A discrete valuation of F is a
function v( · ) from F onto Z ∪{∞} such that
(i) v(x) = +∞if and only if x = 0,
(ii) v(x + y) ≥min(v(x), v(y)) for all x and y, and
(iii) v(xy) = v(x) + v(y) for all x and y.
Observe as a consequence that
(iv) v(−1) = v(1) = 0,
(v) v(−x) = v(x) for all x, and
(vi) v(x + y) = v(x) if v(y) > v(x).
In fact, v(1) = 0 follows by taking x = y = 1 in (iii), and then v(−1) = 0
follows by taking x = y = −1 in (iii). This proves (iv), and (v) follows by
combining (iv) with (iii) for x = −1. For (vi), we have v(x + y) ≥v(x) by
(ii). In the reverse direction, v(x) ≥min(v(x + y), v(y)) by (ii) and (v); since
v(y) > v(x), the minimum must be the ﬁrst of the two, and thus v(x) ≥v(x + y).
Deﬁne Rv = {x ∈F | v(x) ≥0}. Property (i) shows that 0 is in Rv, (ii) and
(v) show that Rv is closed under addition and subtraction, (iii) shows that Rv is
closed under multiplication, and (iv) shows that 1 is in Rv. Consequently Rv is
an integral domain. The ring Rv is called the valuation ring of v in F.
If x is in F but is not in Rv, then v(x) < 0. This inequality forces v(x−1) > 0,
and x−1 is in Rv. As a consequence, F can be regarded as the ﬁeld of fractions
of Rv.
Let Pv = {x ∈F | v(x) > 0}. Arguing in similar fashion, we see that Pv is
an ideal in Rv. Any x in Rv that is not in Pv has v(x) = v(x−1) = 0 and is thus
a unit in Rv. In other words, Rv is a local ring with Pv as its unique maximal
ideal. The ideal Pv is called the valuation ideal of v in F. We write kv for the
ﬁeld Rv/Pv; it is called the residue class ﬁeld of v.
Proposition 6.2. Let v be a discrete valuation of a ﬁeld F, let Rv be the
valuation ring, and let Pv be the valuation ideal. Then
(a) Rv is a principal ideal domain,
(b) there exists an element π in Pv with v(π) = 1, and any such π has
Pv = (π),
(c) the nonzero ideals of Rv are exactly the nonnegative integer powers of Pv
and are given by Pn
v = (πn) = {x ∈Rv | v(x) ≥n} for n ≥0,
(d) the nonzero fractional ideals of Rv are exactly the integer powers of Pv
and are given by Pn
v = (πn) = {x ∈Rv | v(x) ≥n} for n ∈Z.
REMARKS. When F equals Q and v counts the net power of a prime number
p dividing a rational number, we see by inspection that the ring Rv is the local-
ization of Z at p, consisting of all rational numbers with no factor of p in their

2. Discrete Valuations
323
denominators. The choices2 for π in (b) are the elements rp, where r is any
nonzero rational whose numerator and denominator are both prime to p, and the
nonzero ideals are of the form (pn) with n ≥0.
PROOF. The ideal Pv contains an element π with v(π) = 1 because v( · ) is
assumed to be onto Z ∪{+∞}. Suppose that x is a nonzero member of Pv and
that v(x) = n > 0. Then v(π−nx) = 0, and the elements π−nx and x−1πn lie in
Rv. Hence x = πn(π−nx) exhibits x as a member of (πn), and πn = x(x−1πn)
exhibits πn as a member of (x). Consequently (x) = (πn). If I is a nonzero
proper ideal in Rv, then it follows that I = πn0 Rv, where n0 is the smallest integer
such that some element x0 of I has v(x0) = n0. This proves (a), (b), and (c).
Since Rv is a principal ideal domain, it is a Dedekind domain, and the theory of
fractional ideals is applicable. Since (c) shows the nonzero ideals to be all Pn
v with
n ≥0, it follows that the fractional ideals are all Pn
v with n an arbitrary integer.
For any integer n > 0, we have (π−n)Pn
v = π−n Rvπn Rv = Rv = P−n
v
Pn
v , and
thus P−n
v
= (π−n). The latter ideal equals π−n Rv = {x ∈Rv | v(x) ≥−n}, and
this proves (d).
□
From property (vi) it follows for n > 0 that the members x of the set 1+ Pn
v all
have v(x) = 0. The product of two such elements is again in the set because Pn
v
is an ideal. Let us see that the multiplicative inverse x−1 of a member x of the set
is in the set. We calculate that v(x−1 −1) = v(x−1)+v(1−x) = 0+v(1−x) =
v(1−x) ≥n. Hence x−1 is in 1+ Pn
v , and 1+ Pn
v is a group under multiplication.
It is a subgroup of the group R×
v of units in Rv.
EXAMPLE. When F = Q and v counts the net power of a prime number
p dividing a rational number, the residue class ﬁeld kv has p elements, with
the integers 0, 1, . . . , p −1 being coset representatives. The group R×
v is the
multiplicative group of rationals having numerators and denominators prime to
p. The members of 1 + Pn
v are rationals of the form 1 + pnab−1, where a and b
are integers and b is prime to p. If we write this as b−1(b + pna), we see that the
condition on a rational to be in 1 + Pn
v is that its numerator and denominator be
prime to p and be congruent to each other modulo pn.
Now we return to our ﬁrst example of a discrete valuation, which was con-
structed from a nonzero prime ideal P in a Dedekind domain R. We called the
valuation vP( · ). We asserted earlier that the construction via vP( · ) picks out
the localization of R at P and the associated data. This assertion will be proved
in Proposition 6.4 below. We begin with a handy lemma.
2Some books use the term “uniformizer” or “uniformizing element” for any generator π of the
principal ideal Pv. The generators are exactly the prime elements of the ring Rv.

324
VI. Reinterpretation with Adeles and Ideles
Lemma 6.3. Let R be a Dedekind domain regarded as a subring of its ﬁeld of
fractions F, let P be a nonzero prime ideal in R, and let vP be the valuation of F
deﬁned by P. Then any element x of F with vP(x) = 0 is of the form x = ab−1
with a and b in R and vP(a) = vP(b) = 0.
PROOF. If x is an element of F with vP(x) = 0, write x = a′b′−1 with a′ ∈R
and b′ ∈R. Then vP(a′) = vP(b′) = n for some integer n ≥0. Since a′ and b′
are in R, (a′) and (b′) are ordinary ideals, and their prime factorizations are into
ordinary ideals. Let the factorizations be (a′) = Pn Q1 and (b′) = Pn Q2, where
Q1 and Q2 are products of prime ideals not involving P. Since we are dealing
with ordinary ideals, a′ and b′ lie in Pn. Choose an element z in the fractional
ideal P−n that is not in P−n+1. By deﬁnition of P−n, zPn is contained in R.
Hence za′ and zb′ lie in R. Write (za′) = Pm Q3 and (zb′) = Pm′ Q4, where
m ≥0 and where Q3 and Q4 are ordinary ideals whose prime factorizations do
not involve P. Substituting for (a′), we obtain (z)Pn Q1 = Pm Q3 and hence
(z)Pn = Pm Q3Q−1
1 . From this expression we see that Q3Q−1
1
is an ordinary
ideal. By deﬁnition of P−n+1, (z)Pn−1 is not contained in R. Since (z)Pn−1 =
Pm−1Q3Q−1
1 , it follows that m = 0. Similarly m′ = 0. Consequently vP(za′) =
vP(zb′) = 0, and the lemma follows with a = za′ and b = zb′.
□
Proposition 6.4. Let R be a Dedekind domain regarded as a subring of its
ﬁeld of fractions F, let P be a nonzero prime ideal in R, and let vP( · ) be
the corresponding valuation of F. If S denotes the multiplicative system in R
consisting of the complement of P and if the localization S−1R is regarded as a
subring of F, then the valuation ring RvP coincides with S−1R and the valuation
ideal PvP coincides with S−1P.
PROOF. The set S consists exactly of the members x of R with vP(x) ≤0.
Since vP is nonnegative on R, these are the members x of R with vP(x) = 0.
Thus each x in S−1R has vP(x) ≥0, and S−1R is a subset of RvP.
For the reverse inclusion, ﬁx a member π of P that is not in P2. This element
has vP(π) = 1. If x is given in RvP with vP(x) = n ≥0, then we can write
x = πnu for some member u of F with vP(u) = 0. By Lemma 6.3 we can
decompose u as u = ab−1 with a and b in R and vP(a) = vP(b) = 0. The
members of R on which vP takes the value 0 are exactly the members of S. Thus
u is exhibited as the quotient of two members of S, and u is in S−1R. Since π is
in the ideal P of R, x = πnu is in S−1R. Hence RvP = S−1R.
The ideal S−1P is a maximal ideal of S−1R = RvP, and we observed just
before Proposition 6.2 that PvP is the unique maximal ideal of RvP. Therefore
S−1P = PvP.
□
Let us investigate the nature of an arbitrary discrete valuation in various settings
involvingaDedekinddomain. Themaingeneralresultofthissectionisasfollows.

2. Discrete Valuations
325
Theorem 6.5. Let R be a Dedekind domain regarded as a subring of its ﬁeld
of fractions F, and let v be a discrete valuation of F such that R ⊆Rv. Then
(a) P = R ∩Pv is a nonzero prime ideal of R,
(b) the associated discrete valuation vP deﬁned by P coincides with v,
(c) P Rv = Pv,
(d) R + Pv = Rv, and in fact R + Pn
v = Rv for every integer n ≥1, and
(e) the inclusion of R into Rv induces a ﬁeld isomorphism R/P ∼= Rv/Pv.
PROOF. Since 1 is not in Pv, the ideal P in (a) is proper. If a and b are members
of R such that ab is in P, then ab is in Pv, one of a and b is in Pv as well as R,
and P = R ∩Pv is a prime ideal. The ideal P cannot be 0 because otherwise
every nonzero element x of R would have v(x) = 0, in contradiction to the fact
that F is the ﬁeld of fractions of R. Thus P is a nonzero prime ideal of R. This
proves (a).
For (b) and (c), let us begin by showing that vP(x) = 0 implies v(x) = 0. By
Lemma6.3wecanwrite x = ab−1 witha andb in R andwithvP(a) = vP(b) = 0.
The values of vP show that the members a and b of R are not in P. Since
P = R ∩Pv, neither a nor b is in Pv. Therefore v(a) ≤0 and v(b) ≤0.
Since R ⊆Rv by assumption, v(a) ≥0 and v(b) ≥0. We conclude that
v(a) = v(b) = 0 and that v(x) = v(ab−1) = v(a) −v(b) = 0.
Now we can show that v = vP and that P Rv = Pv. The ideal P Rv of Rv has
to be of the form Pe
v for some integer e ≥0 by Proposition 6.2c, and the integer
e has to be > 0 because 1 is not in P Rv. If a nonzero x ∈R has vP(x) = n for
some integer n ≥0, then x R = Pn Q, where Q is an ideal of R whose prime
factorization does not involve P. The function vP is 0 on Q, and the result of the
previous paragraph shows that v is 0 on Q. Hence the members of Q are units in
Rv, and QRv = Rv. Therefore x Rv = x RRv = Pn QRv = Pn Rv = (P Rv)n =
Pen
v , and v(x) = en = evP(x). Since F is the ﬁeld of fractions of R, v = evP
everywhere. The image of vP is Z∪{+∞}, and we conclude that e = 1. In other
words, v = vP and P Rv = Pv. This proves (b) and (c).
For the ﬁrst conclusion in (d), we certainly have R + Pv ⊆Rv. In the reverse
direction, let x ∈Rv be given. If v(x) > 0, then x is in Pv, and there is nothing
to prove. If v(x) = 0, then (b) and Lemma 6.3 together show that we can write
x = ab−1, where a and b are members of R but not P. Since R/P is a ﬁeld, we
can choose c in R with bc in 1 + P. Then
x −ac = a(b−1 −c) = ab−1(1 −bc) = x(1 −bc).
The right side is a member of Rv P, and (c) showed that Rv P = Pv. Therefore x
is exhibited as the sum of the member ac of R and the member x(1 −bc) of Pv,
and we conclude that R + Pv = Rv. This proves the ﬁrst conclusion in (d).

326
VI. Reinterpretation with Adeles and Ideles
For the second conclusion in (d), we show inductively for n ≥1 that Pn−1+Pn
v
= Pn−1
v
, the case n = 1 being what has already been proved in (d). Assume that
case n has been proved. Multiplying the equality by P and using (c), we obtain
Pn + P Pn
v = (P Rv)Pn−1
v
= Pv Pn−1
v
= Pn
v . Since P ⊆Pv, the term P Pn
v is
contained in Pn+1
v
, but increasing the left side in this way does not increase the
right side. Thus Pn + Pn+1
v
= Pn
v . This completes the induction. Using a second
induction, we show that R + Pn
v = Rv. We have already proved this equality for
n = 1. If we assume it for n and substitute from what has just been proved, we
obtain R + (Pn + Pn+1
v
) = Rv, and this proves case n + 1 since Pn ⊆R. The
second conclusion of (d) thus follows by induction.
For (e), we are assuming that R ⊆Rv, and we have deﬁned P = R ∩Pv. Thus
the inclusion R →Rv, when followed by the passage to the quotient Rv/Pv,
descends to the quotient as a ﬁeld map R/P →Rv/Pv. By (d), any member x of
Rv is the sum of a member y of R and a member z of Pv; then y+ P is the member
of R/P that maps to x + Pv in Rv/Pv. Thus the ﬁeld map R/P →Rv/Pv is
onto, and (e) is proved.
□
Corollary 6.6. Let R be a Dedekind domain regarded as a subring of its ﬁeld
of fractions F. If x is a member of F such that v(x) ≥0 for every discrete
valuation v of F satisfying R ⊆Rv, then x lies in R.
PROOF.
We may assume that x ̸= 0.
Write x = ab−1 with a and b in
R. Theorem 6.5 shows that the valuations in question are the ones determined
by the nonzero prime ideals of R. If the principal ideals (a) and (b) factor as
(a) = P j1
1 · · · P jr
r and (b) = Pk1
1 · · · Pkr
r , then 0 ≤vPi(x) = vPi(ab−1) = ji −ki
for 1 ≤i ≤r. Thus ji ≥ki for all i, and the fractional ideal (ab−1) equals the
product P j1−k1
1
· · · P jr−kr
r
, which is contained in R. Hence x = ab−1 lies in R. □
A ﬁnite ﬁeld has no discrete valuations because of the requirement that the
image of a discrete valuation be Z ∪{+∞}. If we drop this requirement in the
deﬁnition and let a be a multiplicative generator of a ﬁnite ﬁeld, then any discrete
valuation v would have v(ak) = kv(a) by property (ii). Taking k equal to the
order of a and using that v(1) = 0, we obtain v(a) = 0. Thus if we drop
the requirement about the image of a discrete valuation, the only possibility has
v(0) = +∞and v(x) = 0 for all x ̸= 0. Thus this setting is not very interesting.
The settings in which discrete valuations v are of most interest to us are the
following:
(i) number ﬁelds,
(ii) “function ﬁelds in one variable” over a base ﬁeld,3
3This notion has not been deﬁned thus far in the book but will be treated in Chapter VII. The
ﬁelds in question are ﬁnite algebraic extensions of a ﬁeld k(X), where X is an indeterminate and k

2. Discrete Valuations
327
(iii) ﬁelds obtained from (i) or (ii) by a process of completion similar to that
used in forming the ﬁeld of p-adic numbers.
The ﬁrst of these are the initial subject matter of algebraic number theory, and the
second of these are the initial subject matter of algebraic geometry—the geometry
of curves. The third of these are used as a tool in studying the other two. Section
VIII.7 of Basic Algebra explained parts of the analogy between the ﬁrst two kinds
of ﬁelds, and that is why we treat them together. We shall use Proposition 6.7
below to determine their discrete valuations. In the case of (ii), the members of
the base ﬁeld k are regarded as constants, and the interest is only in valuations
that are 0 on k×.
Proposition 6.7. Let R be a Dedekind domain, let F be its ﬁeld of fractions,
let K be a ﬁnite algebraic extension of F, and let T be the integral closure of R
in K. If a discrete valuation v of K is ≥0 on R, then it is ≥0 on T .
REMARKS. We make repeated use in this chapter of the fact that T is a Dedekind
domain in this situation. This fact was proved as Theorem 8.54 of Basic Algebra
for the case that K is a ﬁnite separable extension of F, but it is valid without
the hypothesis of separability. The result without the hypothesis of separability
will be proved in Chapter VII as part of an investigation of separable and “purely
inseparable” extensions.
PROOF. If x ̸= 0 is in T , then the minimal polynomial of x over R is a monic
polynomial in T [X], and thus there exist an integern and coefﬁcientsan−1, . . . , a0
in R such that
xn = an−1xn−1 + · · · + a1x + a0.
Properties (ii) and (iii) of discrete valuations show from this equation that
nv(x) ≥
min
0≤j≤n−1

v(aj) + jv(x)

.
Since v(aj) ≥0, we obtain nv(x) ≥min0≤j≤n−1 jv(x), and it follows that
v(x) ≥0. Thus v is nonnegative on T .
□
Corollary 6.8. The only discrete valuations of the ﬁeld Q of rationals are the
ones leading to the p-adic absolute value for each prime number p. If K is a
number ﬁeld and T is its the ring of algebraic integers, then the only discrete
valuations of K are the valuations vP corresponding to each nonzero prime ideal
P of T .
is a ﬁeld called the base ﬁeld. At times later in the chapter, we shall be interested only in the case
that the algebraic extension is separable. It will be proved in Chapter VII that for perfect ﬁelds k,
this separability can always be arranged by adjusting the indeterminate X suitably.

328
VI. Reinterpretation with Adeles and Ideles
PROOF. If v is an arbitrary discrete valuation of Q, then property (iv) of discrete
valuations shows that v(−1) = v(1) = 0, and property (ii) allows us to conclude
that v is nonnegative on all of Z. Thus Z is contained in the valuation ring of v,
and Theorem 6.5 applies. By (a) in the theorem, the intersection of Z with the
valuation ideal is a nonzero prime ideal of Z, hence is pZ for some prime number
p. Part (b) in the theorem then identiﬁes v as the valuation corresponding to pZ.
This proves the ﬁrst conclusion.
For the second conclusion, let v be a discrete valuation of K. The restriction
to Q has to be a positive integral multiple of a discrete valuation of Q or else a
function that is identically 0 on Q×. In either case, v is ≥0 on Z, and Proposition
6.7 shows that v is ≥0 on T . If Rv denotes the valuation ring of v and Pv denotes
the valuation ideal, then this says that T ⊆Rv. We can therefore apply Theorem
6.5. If P is deﬁned by P = T ∩Pv, then (a) in the theorem shows that P is a
nonzero prime ideal, and (b) shows that v = vP.
□
Let us now consider the ﬁeld C(X), regarding it as having some properties in
common with the number ﬁeld Q. We want to know whether some analog of
Corollary 6.8 is valid for C(X). The ring C[X] of polynomials is a principal ideal
domain with C(X) as ﬁeld of fractions, and the prime ideals of C[X] are all of
the form (X −c) with c ∈C because C is algebraically closed. For each such
c, we therefore obtain a discrete valuation v(X−c). Are there any other discrete
valuations? If we think geometrically about this question, we can regard C(X)
as the rational functions on the Riemann sphere, and each discrete valuation
addresses the order of vanishing of rational functions at some point of the sphere.
For the points of the sphere that correspond to points c of C, such a valuation
picks out the power of (X −c) by which the rational function should be divided
in order to be regular and nonvanishing at c. The point ∞on the Riemann sphere
behaves differently. The usual technique in complex-variable theory is to replace
X by 1/X and examine the behavior at 0. Following that prescription, we are led
to a discrete valuation v∞that is not of the form vP for some prime ideal P of
C[X]. The deﬁnition of v∞on the quotient f (X)/g(X) of nonzero polynomials
is
v∞( f (X)/g(X)) = deg g −deg f
with v∞(0) = +∞as usual.
The next proposition, which extends one of
Liouville’s theorems in complex-variable theory4 from C to a general ﬁeld k,
says that there are no other discrete valuations of interest for this example.
Proposition 6.9. Let k be any ﬁeld, and let F = k(X) be the ﬁeld of rational
expressions in one indeterminate over k. Regard F as the ﬁeld of fractions of
4For a meromorphic function on the Riemann sphere, the sum of the orders of the poles equals
the sum of the orders of the zeros.

2. Discrete Valuations
329
the principal ideal domain k[X]. Then the only discrete valuations of F that
are 0 on the multiplicative group k× of nonzero constant polynomials are the
various valuations v(p), where p(X) is a monic prime polynomial in k[X], and
the valuation v∞that is deﬁned on nonzero elements of F by
v∞( f (X)/g(X)) = deg g −deg f
if f and g are polynomials. Moreover, any nonzero h(X) in F has
v∞(h) +

p(X) monic
prime in R
(deg p)v(p)(h) = 0.
PROOF. Let v be a discrete valuation of F that is 0 on k×. First suppose that
v(X) ≥0. Being 0 on the coefﬁcients, v is nonnegative on all polynomials. Thus
k[X] is contained in the valuation ring of v, and Theorem 6.5 applies. By (a) in
the theorem, the intersection of k[X] with the valuation ideal is a nonzero prime
ideal of k[X], hence is (p(X)) for some monic prime polynomial p(X). Part (b)
in the theorem then identiﬁes v as the valuation corresponding to (p(X)).
Next suppose that v(X) < 0. Since k[X−1] has k(X) as ﬁeld of fractions, the
argumentinthepreviousparagraphisapplicable, andweﬁndthatv isthevaluation
determined by the prime ideal (X−1) in k[X−1]. In particular, v(X) = −1. To
ﬁnd v( f ) for a general polynomial f (X) = an Xn +· · ·+a1X +a0 in k[X] under
the assumption that an ̸= 0, we write f as Xn(an + · · · + a1X1−n + a0X−n).
The member an + · · · + a1X1−n + a0X−n of k[X−1] is not divisible by X−1, and
thus v is 0 on it. Consequently v( f ) = v(Xn) = nv(X) = −n = −deg f . If
f and g are both nonzero in k[X], then it follows that v( f/g) = v( f ) −v(g) =
−deg f + deg g = v∞( f/g). That is, v = v∞.
To prove the displayed formula, write a given nonzero member h(X) of F as
the quotient of two relatively prime polynomials, thus as h(X) = f (X)/g(X).
Factor the numerator as f (X) = c m
i=1 pi(X)ki with c ∈k×, and factor the
denominator similarly. If p(X) is a monic prime polynomial, then inspection of
the formula for f (X) shows that v(p)( f ) is ki if p = pi and is 0 otherwise. Hence
	
p (deg p)v(p)( f ) = 	m
i=1 ki deg pi = deg f . Subtracting this formula and a
corresponding formula for g, we obtain
	
p
(deg p)v(p)( f/g) = deg f −deg g = −v∞(h),
and the result follows.
□
Corollary 6.10.
Let k be a ﬁeld, let F = k(X) be the ﬁeld of rational
expressions in one indeterminate over k, let K be a ﬁnite algebraic extension of

330
VI. Reinterpretation with Adeles and Ideles
k[X], let T be the integral closure of k[X] in K, and let v be a discrete valuation
of K that is 0 on the multiplicative group k×. Then the only possibilities for v
are as follows:
(a) v(X) ≥0, and there exists a unique nonzero prime ideal P in T such that
v = vP,
(b) v(X) < 0, and there exists a prime ideal P in the integral closure T ′ of
k[X−1] in K such that P ∩k[X−1] = X−1k[X−1] and such that v is the
valuation of K determined by P.
REMARK. The ideals P that occur in (b) are the ones in the prime factorization
of the ideal X−1T ′ in T ′. There is at least one, and there are only ﬁnitely many.
PROOF. The argument is similar to the one for Corollary 6.8, except that
we have to take into account what Proposition 6.9 says when v(X) < 0. The
conclusion is that either v is ≥0 on k[X], and then Proposition 6.7 and Theorem
6.5 show that v is as in (a), or else v(X) < 0, and then Proposition 6.7 and
Theorem 6.5 show that v is as in (b).
□
To conclude, let us complete the remarks about fractional ideals begun early
in this section. In the context that R is a Dedekind domain and F is its ﬁeld of
fractions, we mentioned that the nonzero fractional ideals of F form a group. We
denote this group by I. The nonzero principal fractional ideals form a subgroup
P, and P is isomorphic to the multiplicative group F×.
The point of the present discussion is that the group I/P is isomorphic to
the ideal class group of F as deﬁned in the number-ﬁeld setting in Section V.6.
Recall the nature of this group. Two nonzero ideals I and J of R are equivalent
if there exist nonzero members a and b of R with aI = bJ. Proposition 5.18
showed in the number-ﬁeld setting that multiplication of such ideals descends to
a multiplication on the set of equivalence classes and that the result is a group.
This result holds for any Dedekind domain. The group is called the ideal class
group of F; we denote it here by C.
To verify that C ∼= I/P, we map each ideal I of R to its coset in I/P. If I and
J are equivalent ideals of R and aI = bJ, then (ab−1)I = J, and I and J map
to the same coset. Thus C maps homomorphically into I/P. If I maps into the
identity coset, then x I = R for some x ∈F×. Writing x as ab−1 with a and b in
R shows that aI = bR = (b), hence that I is equivalent to a principal ideal. Thus
the homomorphism C →I/P is one-one. Finally if M is any nonzero fractional
ideal of F, then we can ﬁnd some x ∈F× with x M ⊆R. Here x M is an ideal
of R, and the equivalence of M and x M exhibits the class of M in I/P as in the
image of C. Consequently C = I/P, as asserted.

3. Absolute Values
331
3. Absolute Values
The next step in analyzing and generalizing the construction of the p-adic absolute
value is to pass from the valuation, which appears in the exponent, to the absolute
value itself. If F is a ﬁeld, an absolute value on F is a function | · | from F to
R such that
(i) |x| ≥0 with equality if and only if x = 0,
(ii) |x + y| ≤|x| + |y| for all x and y in F,
(iii) |xy| = |x||y| for all x and y in F.
It follows directly that
(iv) | −1| = |1| = 1 and that
(v) | −x| = |x| for all x in F.
In fact, (iv) follows by combining (i) with (iii) for x = y = 1 and then with
(iii) for x = y = −1; then (v) follows by combining (iii) and (iv). The absolute
value | · | on F is said to be nonarchimedean if the following strong form of (ii)
holds:5
(ii′) |x + y| ≤max(|x|, |y|) for all x and y in F.
Otherwise it is called archimedean. The inequality in (ii′) is called the ultra-
metric inequality. When the ultrametric inequality holds, then the following
additional condition holds:
(vi) |x + y| = |x| whenever x and y in F have |y| < |x|.
In fact, when |y| < |x|, (ii′) immediately gives |x + y| ≤|x|. But also (ii′) and
(v) give |x| ≤max(|x + y|, | −y|) = max(|x + y|, |y|). On the right side, the
maximum cannot be |y| because |x| ≤|y| is false. Thus |x| ≤|x + y|, and (vi)
holds.
Although it might seem counterintuitive, it turns out that the archimedean
absolute values are easier to understand than the nonarchimedean ones in the
number ﬁelds and function ﬁelds of interest to us.
Because of (iii), any absolute value of F when restricted to F× is a multiplica-
tive homomorphism into the positive real numbers. The image in the positive
reals is therefore a group.
EXAMPLES OF NONARCHIMEDEAN ABSOLUTE VALUES.
(1) Let F be any ﬁeld, and deﬁne |x| = 0 for x = 0 and |x| = 1 for x ̸= 0. The
result is a nonarchimedean absolute value called the trivial absolute value. It is
of no interest, and we shall tend to exclude consideration of it from our results.
5Some authors refer to a nonarchimedean absolute value as a “valuation,” using the same term
as for the functions v( · ) in Section 2. There is little danger of confusing the two notions, but we
shall use the two distinct names anyway.

332
VI. Reinterpretation with Adeles and Ideles
Any other absolute value will be said to be nontrivial. Observe for a ﬁnite ﬁeld
F that the fact that x 	→|x| is a homomorphism from F× to the positive reals
implies that the only absolute value on a ﬁnite ﬁeld is the trivial one.
(2) Let F be any ﬁeld, let v be a discrete valuation on F, and ﬁx a real
number r > 1. Then |x| = r−v(x) deﬁnes a nonarchimedean absolute value
on F.
Property (i) of absolute values follows because v(x) takes values in
Z ∪{+∞} and is inﬁnite if and only if x = 0, property (ii′) follows be-
cause v(x + y) ≥min(v(x), v(y)), and property (iii) follows because v(xy) =
v(x)+v(y). In particular, the p-adic absolute value is obtained in this way when
we take r = p, and we obtain corresponding examples for any number ﬁeld F
by taking v = vP and ﬁxing r > 1, where P is any nonzero prime ideal in the
ring of algebraic integers in F. For the function ﬁeld F = k(X), we obtain
corresponding examples by taking v = v(p) and ﬁxing r > 1, where p(X) is any
monic prime polynomial in k(X). The choice v = v∞gives us another example.
In all of these cases, the image of F× in R× under the absolute value is discrete
in the sense that each one-point set of the image is open in the relative topology
from the positive reals. Corollary 6.17 will show conversely that any absolute
value for which the image in R× of the nonzero elements is discrete and nontrivial
is obtained in this way from a discrete valuation. It is worth pausing to interpret
some of the conclusions of Theorem 6.5 in terms of absolute values and metrics.
Proposition 6.11. Let R be a Dedekind domain regarded as a subring of its
ﬁeld of fractions F, suppose that | · | is an absolute value on F deﬁned by means
of a discrete valuation v, and suppose that the subset Rv of F for which |x| ≤1
contains R. If Pv denotes the subset of F with |x| < 1, then P = R ∩Pv is a
nonzero prime ideal of R, and also
(a) R is dense in Rv,
(b) Pn is dense in Pn
v for every n ≥1,
(c) R/P ∼= Rv/Pv.
PROOF. In terms of v, the set Rv is the valuation ring, and the set Pv is the
valuation ideal. The hypothesis R ⊆Rv is the hypothesis of Theorem 6.5. Part (a)
of that theorem shows that P = R ∩Pv is a prime ideal in R. Conclusions (a) and
(b) here follow from Theorem 6.5d. In fact, let |x| = r−v(x) with r > 1. Suppose
that x is given in Pn
v with n ≥0 and that a positive number r−N is speciﬁed.
We may assume that N ≥n. The condition for x to be in Pn
v is that |x| ≤r−n.
Theorem 6.5d shows that we can ﬁnd an x0 in R such that x0 + y = x with y in
P N
v , hence with |y| ≤r−N. Then x0 is in R and has |x0 −x| = |y| ≤r−N. Hence
x0 is within r−N of x. Since |x0| ≤max(|x|, |y|) = max(r−n,r−N) = r−n, x0 is
in R ∩Pn
v = Pn. Conclusion (c) is immediate from Theorem 6.5e.
□

3. Absolute Values
333
EXAMPLES OF ARCHIMEDEAN ABSOLUTE VALUES. If F is any subﬁeld of R
or C and if | · | is deﬁned as the restriction to F of the ordinary absolute value
function, then | · | is an archimedean absolute value. Remarkably it turns out that
there are no other archimedean absolute values, apart from “equivalent” ones in
the sense to be deﬁned below. We return to this matter at the end of Section 4.
Actually, we shall be interested in archimedean absolute values only when F is
a number ﬁeld or is all of R or all of C, and we will not need to invoke any deep
theorem for the cases of interest to us.
Properties (i), (ii), and (v) of absolute values show that the function d with
d(x, y) = |x−y| is a metric on F, and the next section will examine what happens
when this metric is completed. The resulting ﬁelds will be generalizations of the
ﬁeld of p-adic numbers and will useful as tools in investigating number ﬁelds
and function ﬁelds in one variable.
Two absolute values | · |1 and | · |2 on the same ﬁeld are said to be equivalent
if there is a positive number α such that | · |1 = (| · |2)α. In our passage from
a discrete valuation v to a nonarchimedean absolute value | · |, we ﬁxed r > 1
and deﬁned |x| = r−v(x). Changing r changes the absolute value to an equivalent
absolute value. In the archimedean case a positive power of an absolute value
need not be an absolute value, since the triangle inequality may fail. For example
the ordinary absolute value on R satisﬁes the triangle inequality; so does its αth
power for α < 1 but not for α > 1.
Equivalent absolute values yield the same topology on F and in fact the same
Cauchy sequences.6 Conversely two absolute values that yield the same topology
are equivalent, according to the following proposition.
Proposition 6.12. Two nontrivial absolute values on a ﬁeld F are equivalent
if and only if

x ∈F
 |x|1 > 1

⊆

x ∈F
 |x|2 > 1

,
if and only if they induce the same topology on F.
REMARKS. If | · |1 is the trivial absolute value, then the stated inclusion holds
for all | · |2, but the equivalence may fail; that is why the statement has to exclude
this case. The statement of the proposition remains true if the inequalities|x|1 > 1
and |x|2 > 1 are replaced by |x|1 < 1 and |x|2 < 1, as we see by replacing x by
x−1.
PROOF. If the two absolute values are equivalent, then it is immediate from
the deﬁnition of equivalent that equality holds in the stated inclusion. Conversely
6In many books an equivalence class of absolute values on a ﬁeld is called a “place” of the ﬁeld.
We shall use this term in Sections 9 and 10 of this chapter,

334
VI. Reinterpretation with Adeles and Ideles
suppose that the inclusion holds. Fix x ∈F with |x|1 > 1. Such an x exists
because | · |1 is nontrivial. Since |x|2 > 1, there exists a real s > 0 with
|x|1 = |x|s
2. We shall show that | · |1 = | · |s
2.
Let y ∈F be arbitrary with |y|1 ≥1. Find the number r ≥0 depending on
y such that |y|1 = |x|r
1. Let {an/bn} be a sequence of positive rationals strictly
decreasing to r such that an and bn are both positive. Then |y|1 = |x|r
1 < |x|an/bn
1
,
from which we obtain |ybn|1 < |xan|1 and |xan y−bn|1 > 1. By assumption,
|xan y−bn|2 > 1, and therefore |y|2 < |x|an/bn
2
. Passing to the limit, we obtain
|y|2 ≤|x|r
2.
Now suppose that |y|1 > 1. Arguing similarly with a sequence of positive
rationals strictly increasing to r, we obtain |y|2 ≥|x|r
2. Thus |y|2 = |x|r
2. Then
we have
|y|1 = |x|r
1 = |x|rs
2 = |y|s
2
whenever |y|1 > 1.
(∗)
If instead |y|1 = 1, then the number r in the second paragraph of the proof
is 0, and we obtain |y|2 ≤|x|r
2 = 1. Replacing y by y−1 shows also that |y|2 ≥1.
Thus |y|1 = 1 implies |y|2 = 1.
The remaining case is that |y|1 < 1. Then we apply (∗) to y−1 and conclude
that|y|1 = |y|s
2 inthiscaseaswell. Thiscompletestheproofoftheﬁrstconclusion
of the proposition.
For the ﬁnal statement we know that equivalent absolute values lead to the
same topology. Conversely suppose that the absolute values are not equivalent.
By what we have just shown, there exists x ∈F with |x|1 > 1 and |x|2 ≤1. Then
{x−n} is a sequence convergent to 0 in the topology from | · |1 but not convergent
to 0 in the topology from | · |2. Therefore the topologies are different.
□
Proposition 6.13. If | · | is an absolute value on the ﬁeld F, then the topology
on F induced by the associated metric makes F into a topological ﬁeld.
REMARK. The proof is similar to part of the argument that proves Proposition
6.1 except that the general triangle inequality has to be used in place of the
ultrametric inequality.
PROOF. To see that addition, subtraction, and multiplication are continuous on
F, let {xn} and {yn} be convergent sequences in F with respective limits x and y.
Use of the triangle inequality on F gives
|(xn + yn) −(x + y)| = |(xn −x) + (yn −y)| ≤|xn −x| + |yn −y|.
The right side has limit 0 in R, and therefore xn + yn has limit x + y in F. A
completely analogous argument, making use also of the equality | −1| = |1|,
shows that subtraction is continuous. Consider multiplication. If M is an upper

3. Absolute Values
335
bound for the absolute values |xn|, then use of the multiplicative property of the
absolute value on F gives
|xnyn −xy| = |xn(yn −y) + y(xn −x)| ≤|xn(yn −y)| + |y(xn −x)|
= |xn||yn −y| + |y||xn −x| ≤M|yn −y| + |y||xn −x|.
The right side has limit 0 in R, and therefore xnyn has limit xy in F.
To see that inversion x 	→x−1 is continuous on F×, let {xn} be a sequence in
F× with limit x in F×. Since limn |xn| = |x|, we can ﬁnd an integer N such that
|xn| ≥1
2|x| for n ≥N. The computation
|x−1
n
−x−1| = |(x −xn)/(xnx)| = |x −xn|/(|xn||x|) ≤2|x|−1|x −xn|,
valid for n ≥N, then shows that lim x−1
n
= x−1, and inversion is continuous.
Consequently F is a topological ﬁeld.
□
We now give a few results that limit the kinds of absolute values that can arise
in particular situations.
Proposition 6.14. If | · | is an absolute value on the ﬁeld F for which there
is some c with |n| ≤c for all integers n ∈Z, i.e., for all additive multiples of 1,
then | · | is nonarchimedean. In particular, | · | is necessarily nonarchimedean if
F has characteristic different from 0.
REMARK. When c exists, then c can be taken to be 1, since the image of F×
under the absolute value is a subgroup of the positive reals and the only bounded
such subgroup is {1}.
PROOF. If x and y are in F and if n is any positive integer, then the Binomial
Theorem gives (x + y)n = 	n
j=0
n
j

xn−j y j. Therefore
|x + y|n =
n	
j=0
n
j
|x|n−j|y| j
≤c
n	
j=0
max(|x|, |y|)n−j max(|x|, |y|) j
= c(n + 1) max(|x|, |y|)n.
Extraction of the nth root gives |x + y| ≤c1/n(n + 1)1/n max(|x|, |y|). Passing
to the limit, we obtain |x + y| ≤max(|x|, |y|).
□

336
VI. Reinterpretation with Adeles and Ideles
Theorem 6.15 (Ostrowski’s Theorem). If | · | is a nontrivial absolute value
on the ﬁeld Q, then | · | is equivalent either to the p-adic absolute value | · |p for
some prime number p or to the ordinary absolute value | · |R.
REMARKS. No two of these are equivalent because {pn} tends to 0 relative to
the p-adic absolute value, {p−n} tends to 0 relative to the ordinary absolute value,
and pn has absolute value 1 relative to the ℓ-adic absolute value for all prime
numbers ℓ̸= p.
PROOF. First suppose that every integer n has |n| ≤1. Proposition 6.14 shows
that | · | is nonarchimedean. Since | · | is nontrivial, we must have |n| < 1 for
some n, and we may take n to be positive. Since |n| is the product of |p| over
all primes dividing n, multiplicities included, some prime number p has |p| < 1.
Let us see that p is unique. If, on the contrary, |q| < 1 for a second prime number
q, choose integers a and b with ap + bq = 1. Then 1 = |1| = |ap + bq| ≤
max(|ap|, |bq|) = max(|a||p|, |b||q|) ≤max(|p|, |q|) < 1, contradiction. If we
now deﬁne a positive real α by |p| = p−α, then it follows that |n| = (|n|p)α for
all integers n. Therefore | · | = (| · |p)α on all of Q.
Now suppose that n is some integer with |n| > 1. We may assume that n is
positive. For any positive integer m, the triangle inequality gives
|m| = |1 + · · · + 1| ≤|1| + · · · + |1| = m.
In particular we have |n| = nα for some real α with 0 < α ≤1.
We shall prove that
|m| ≤mα
(∗)
for all positive integers m. We start by expanding m to the base n, writing
m = c0 + c1n + c2n2 + · · · + ck−1nk−1,
where k is the integer such that nk−1 ≤m < nk and where each cj satisﬁes
0 ≤cj < n. The triangle inequality gives
|m| ≤|c0| + |c1||n| + |c2||n|2 + · · · + |ck−1||n|k−1
≤(n −1)(1 + nα + n2α + · · · + nα(k−1))
by deﬁnition of α
= (n −1)nαk
nα −1
= (n −1)nα
nα −1
nα(k−1)
≤(n −1)nα
nα −1
mα
since nk−1 ≤m.
In other words, there is a positive number C independent of m such that |m| ≤
Cmα for every positive integer m. For every positive integer N, we then have

3. Absolute Values
337
|m|N = |m N| ≤CmαN, and thus |m| ≤C1/Nmα. Letting N tend to inﬁnity, we
obtain (∗).
Let us now improve (∗) to the equality
|m| = mα
for every positive integer m.
(∗∗)
The integer k above has nk−1 ≤m < nk.
Put d = nk −m; this satisﬁes
0 < d ≤nk −nk−1. Then
nαk = |n|k = |nk| ≤|m| + |d| ≤|m| + dα ≤|m| + (nk −nk−1)α,
and consequently
|m| ≥nαk −(nk −nk−1)α = nαk
1 −

1 −1
n
α
≥mα
1 −

1 −1
n
α
.
Thus |m| ≥C′mα for some positive constant C′ independent of m. For every
positive integer N, we then have |m|N = |m N| ≥C′mαN and hence |m| ≥
C′1/Nmα. Letting N tend to inﬁnity, we obtain |m| ≥mα. In combination with
(∗), this proves (∗∗).
Since | −m| = |m|, the equality (∗∗) implies |m| = (|m|R)α for every integer
m. Taking quotients, we obtain |q| = (|q|R)α for every rational q.
□
Corollary 6.16. If | · | is a nontrivial absolute value on a number ﬁeld F, then
the restriction of | · | to Q is nontrivial.
REMARK. In view of Ostrowski’s Theorem (Theorem 6.15), the restriction to
Q therefore has to be equivalent to the p-adic absolute value for some p or to the
ordinary absolute value.
PROOF. Since | · | is nontrivial, there exists x with |x| > 1. Raising x to
a power if necessary, we may assume that |x| ≥2. Arguing by contradiction,
suppose that |q| = 1 for all nonzero q in Q. Since x is algebraic over Q, there
exist an integer n ≥1 and rational coefﬁcients qn−1, . . . , q0 such that
xn = qn−1xn−1 + · · · + q1x + q0.
Applying | · | to both sides and using that |qj| ≤1 for all j gives
|x|n ≤|x|n−1 + · · · + |x| + 1 = |x|n −1
|x| −1 ≤|x|n −1,
the right-hand inequality holding because |x| ≥2. We have thus obtained |x|n ≤
|x|n −1 and have arrived at a contradiction.
□

338
VI. Reinterpretation with Adeles and Ideles
An absolute value | · | on a ﬁeld F such that the image of F× is discrete is
called a discrete absolute value. The p-adic absolute values on Q and on Qp
furnish examples.
Corollary 6.17. If | · | is a nontrivial discrete absolute value on the ﬁeld F,
then | · | is nonarchimedean, and |x| = r−v(x) for some discrete valuation of F.
REMARKS. Example 1 of nonarchimedean absolute values shows that discrete
valuations always lead to discrete absolute values. This corollary is a converse.
The trivial absolute value is of course nonarchimedean, but it does not arise from
a discrete valuation. We shall not be interested in any nonarchimedean absolute
values that do not arise from discrete valuations.
PROOF. First we show that | · | is nonarchimedean. Proposition 6.14 imme-
diately handles the case that F has nonzero characteristic, and we may therefore
take the characteristic to be 0. Let D be the discrete image subgroup of F×. This
D in particular must contain the image of Q×. Meanwhile, Theorem 6.15 says
that the restriction of | · | to Q has to be trivial, or equivalent to the p-adic absolute
value for some p, or equivalent to the ordinary absolute value. Under the ordinary
absolute value, the image of Q× cannot be contained in D, and the restriction
must be one of the other kinds. For all of the other kinds, the image of Z is
bounded, and Proposition 6.14 allows us to conclude that | · | is nonarchimedean.
Now that | · | is nonarchimedean, we set v(0) = +∞and v(x) = −logr |x|
for x ̸= 0.
Properties (i), (ii′), and (iii) of nonarchimedean absolute values
immediately imply the three deﬁning properties of a discrete valuation.
□
Corollary 6.18. If | · | is a nontrivial discrete absolute value on a ﬁeld F, then
the corresponding valuation ring R =

x ∈F
 |x| ≤1

and the valuation ideal
P =

x ∈F
 |x| < 1

are open and closed in F.
REMARK. Corollary 6.17 shows that | · | is deﬁned by a discrete valuation.
PROOF. The deﬁnitions of R and P in the statement show that R is closed
and P is open. Let D be the image of F× under | · |. A discrete subgroup
of positive reals has to be equal7 to {1} or to the subgroup rZ for a unique real
r > 1. The nontriviality of | · | implies that the correct alternative is rZ. Then
the equality R =

x ∈F
 |x| < r

shows that R is open, and the equality
P =

x ∈F
 |x| ≤r−1
shows that P is closed.
□
Next we prove a general result applicable to number ﬁelds and to function
ﬁelds in one variable that yields the conclusion that nonarchimedean absolute
values in these cases are automatically discrete. The general result is obtained in
two parts, stated as Lemma 6.19 and Proposition 6.20.
7One can invoke Lemma 5.14, for example.

3. Absolute Values
339
Lemma 6.19. If R is a Dedekind domain regarded as a subring of its ﬁeld of
fractions F, and if | · | is a nonarchimedean absolute value on F that is ≤1 on
R, then | · | is discrete. Hence either | · | is trivial or else it is deﬁned by the
valuation relative to a nonzero prime ideal of R.
PROOF. The subset of x ∈R for which |x| < 1 is a proper ideal I in R, and
we let P be a prime ideal containing I. Since R is a Dedekind domain, P deﬁnes
a corresponding discrete valuation vP. Let |x|P = 2−vP(x). Then

x ∈R
 |x| < 1

= I ⊆P =

x ∈R
 |x|P < 1

,
and hence

x ∈R
 |x|P = 1

⊆

x ∈R
 |x| = 1

.
(∗)
Let π be an element of R with |π|P = 1
2. If x is an arbitrary nonzero member of
F with |x|P < 1, then Proposition 6.4 shows that we can write x = πkx′ with
k > 0, x′ in R, and |x′|P = 1. Then |x′| = 1 by (∗), and it follows that |x| = |π|k.
Since |x|P = |π|k
P also, there are only two possibilities. One possibility is that
|x| = |π| = 1 for all x ̸= 0, and then | · | is trivial. The other possibility is that
the subsets of F for which |x| < 1 and for which |x|P < 1 coincide. In this case
we apply Proposition 6.12 and conclude that | · | and | · |P are equivalent.
□
Proposition 6.20. Let R be a Dedekind domain regarded as a subring of its
ﬁeld of fractions F, let K be a ﬁnite algebraic extension of F, and let T be the
integral closure of R in K. If | · | is a nonarchimedean absolute value on K that
is ≤1 on R, then it is ≤1 on T . Hence | · | is discrete, and either | · | is trivial
or else it is deﬁned by the valuation relative to a nonzero prime ideal of T .
PROOF. As with Proposition 6.7, T is a Dedekind domain. If x ̸= 0 is in T ,
then the minimal polynomial of x over R is a monic polynomial in R[X], and
thus there exist an integer n and coefﬁcients an−1, . . . , a0 in R such that
xn = an−1xn−1 + · · · + a1x + a0.
Taking the absolute value of both sides and using the nonarchimedean property,
we obtain
|x|n ≤
max
0≤j≤n−1(|aj||x| j) ≤
max
0≤j≤n−1(|x| j) = max(1, |x|n−1),
the inequality holding because | · | is assumed to be ≤1 on R. If we could have
|x| > 1, then this inequality would read |x|n ≤|x|n−1, which is a contradiction.
We conclude that |x| ≤1 for all x ∈T . The conclusions in the last sentence of
the proposition now follow from Lemma 6.19.
□

340
VI. Reinterpretation with Adeles and Ideles
Corollary 6.21. If K is a number ﬁeld, then every nontrivial nonarchimedean
absolute value | · | on K comes from the valuation vP relative to some nonzero
prime ideal P in the ring of algebraic integers in K.
REMARK. Proposition6.27belowwillclassifythearchimedeanabsolutevalues
on a number ﬁeld.
PROOF. Since | · | is nonarchimedean, its restriction to Q is nonarchimedean.
By Ostrowski’s Theorem (or by inspection), it is ≤1 on Z. The result now
follows from Proposition 6.20 if we take R to be Z and F to be Q.
□
Corollary 6.22.
Let k be a ﬁeld, let F = k(X) be the ﬁeld of rational
expressions in one indeterminate over k, let K be a ﬁnite algebraic extension of
k[X], let T be the integral closure of k[X] in K, and let | · | be a nontrivial
nonarchimedean absolute value on K that is 1 on the multiplicative group k×.
Then | · | is discrete, and the only possibilities for it are as follows:
(a) |X| ≤1, and there exists a unique nonzero prime ideal P in T such that
| · | comes from the valuation determined by P,
(b) |X| > 1, and there exists a prime ideal P in the integral closure T ′ of
k[X−1] in K such that P ∩k[X−1] = X−1k[X−1] and such that | · |
comes from the valuation of K determined by P.
REMARKS. As with Proposition 6.7, T and T ′ are Dedekind domains. If
k has nonzero characteristic, then Proposition 6.14 shows that every absolute
value is nonarchimedean. For the case that k has characteristic zero, remarks at
the end of Section 4 will indicate why every absolute value that is 1 on k× is
nonarchimedean; we shall not need to make use of this fact, however. In any
event, just as with Corollary 6.10, the ideals P that occur in (b) are the ones in
the prime factorization of the ideal X−1T ′ in T ′; there is at least one, and there
are only ﬁnitely many.
PROOF. The argument is similar to the one for Corollary 6.21, except that we
have to take into account what happens when |X| > 1. We apply Proposition
6.20 either with R = k[X] or with R = k[X−1].
Since | · | is 1 on k×, an inequality |X| ≤1 implies that | · | is ≤1 on k[X],
| · | being assumed to be nonarchimedean. Then Proposition 6.20 and Corollary
6.10 show that (a) holds. Similarly an inequality |X| > 1 implies that | · | is ≤1
on k[X−1] because | · | is assumed nonarchimedean. Then Proposition 6.20 and
Corollary 6.10 show that (b) holds.
□
Theorem 6.23 (Weak Approximation Theorem).
Let | · |1, . . . , | · |n be
inequivalent nontrivial absolute values on a ﬁeld F. If ϵ > 0 is a real number
and x1, . . . , xn are elements of F, then there exists y in F such that
|y −xj|j < ϵ
for 1 ≤j ≤n.

3. Absolute Values
341
REMARKS. The special case of this theorem in which F is a number ﬁeld and
the absolute values are deﬁned by n distinct nonzero prime ideals in the ring of
algebraic integers follows from the Chinese Remainder Theorem (Theorem 8.27
of Basic Algebra, restated in the present book on page xxiii). In fact, it is enough
to handle the case that all the xj’s are algebraic integers in F. Let the prime ideals
be P1, . . . , Pn, and let | · |j = r
−vPj ( · )
j
with rj > 1. If we specify any positive
integers k1, . . . , kn, then the Chinese Remainder Theorem produces an algebraic
integer y in F such that y ≡xj mod P
kj
j
for 1 ≤j ≤n. These congruences say
that vPj(y −xj) ≥kj, hence that |y −xj|j ≤r
−kj
j
. Thus we have only to choose
k1, . . . , kn large enough to make r
−kj
j
< ϵ for all j, and the inequalities of the
theorem will hold.
PROOF. First let us prove that we can ﬁnd an element z in F with
|z|1 > 1
and
|z|j < 1 for 2 ≤j ≤n.
(∗)
We do so by induction on n, the case n = 2 being Proposition 6.12. Assuming
the result for n −1, ﬁnd u with |u|1 > 1 and |u|j < 1 for 2 ≤j ≤n −1. Then by
the result for n = 2, ﬁnd v with |v|1 > 1 and |v|n < 1. Let k > 0 be an integer
to be speciﬁed, and put
z =
⎧
⎪⎨
⎪⎩
v
if |u|n < 1,
ukv
if |u|n = 1,
ukv
1+uk
if |u|n > 1.
In the second case, k is to be chosen large enough to make |u|k
j |v|j < 1 for
2 ≤j ≤n −1. In the third case, k is to be chosen large enough to make
|u|k
1(1 + |u|k
1)−1|v|1 > 1, |u|k
j (1 −|u|k
j )−1|v|j < 1 for 2 ≤j ≤n −1, and
|u|k
n(|u|k
n −1)−1|v|n < 1. Then z satisﬁes the conditions in (∗), and the inductive
proof of (∗) is complete.
Applying (∗), ﬁnd zj such that |zj|j > 1 and |zj|i < 1 for i ̸= j. Let l be a
positive integer to be speciﬁed, and put
y =
n	
i=0
xi zl
i
1+zl
i .
Since y −xj = −xj(1 + zl
j)−1 + 	
i̸= j xizl
i(1 + zl
i)−1, we obtain
|y −xj|j ≤|xj|j

|zj|l
j −1
−1 + 	
i̸= j
|xi|j

|zi|l
j(1 −|zi|l
j)−1
.
(∗∗)
For l large enough, the coefﬁcients (|zj|l
j −1)−1 and |zi|l
j(1 −|zi|l
j)−1 for i ̸= j
can be made as small as we please, and thus the right side of (∗∗) can be made to
be < ϵ.
□

342
VI. Reinterpretation with Adeles and Ideles
4. Completions
In this section we ﬁnish our project of establishing an abstract theory that gener-
alizes the construction of the ﬁeld of p-adic numbers. A little care is appropriate
in stating the results. Here is an example of the cost of imprecision: We know
that the ﬁeld Qp is obtained by completing Q with respect to the p-adic absolute
value. We shall see in Section 5 that Qp for p = 5 is obtained also by completing
the ﬁeld Q(i) with respect to a certain absolute value and that in fact there are
two distinct equivalence classes of absolute values on Q(i) for which Q5 results
in this way. Thus a completion process is not well speciﬁed unless we include all
the data—the original ﬁeld, the absolute value on it (or at least the equivalence
class of absolute values), and the mapping into the completed space.
For this reason we introduce the notions of a valued ﬁeld, namely a pair
(F, | · |F) consisting of a ﬁeld and an absolute value on it, and a homomorphism
of valued ﬁelds. If (F, | · |F) and (K, | · |K) are the two valued ﬁelds in question,
a homomorphism from the ﬁrst to the second is a ﬁeld map ϕ : F →K such
that |x|F = |ϕ(x)|K for all x in F. We write ϕ∗for the corresponding operation
of restriction: ϕ∗(| · |K) = | · |F. If ϕ carries F onto K, then ϕ is called an
isomorphism of valued ﬁelds.
A completion of a valued ﬁeld (F, | · |F) is deﬁned to be a homomorphism
of valued ﬁelds ϕ : (F, | · |F) →(K, | · |K) such that (K, | · |K) is complete as
a metric space and ϕ(F) is dense in K. The ﬁrst theorem establishes existence.
Theorem 6.24. Let F be a ﬁeld with a nontrivial absolute value | · |F, let
d be the associated metric on F, let R be the subring of ∞
j=1 F consisting of
all Cauchy sequences relative to d, and let I be the ideal in R consisting of all
sequences convergent to 0. Then I is a maximal ideal in R, and the quotient R/I
is a ﬁeld. Consequently the Cauchy completion of F relative to d is a topological
ﬁeld F = R/I. Let i : F →F be the natural map F →R →R/I of F into the
Cauchy completion given by carrying members of F into constant sequences inR,
followed by passage to the quotient. The metric ¯d on the Cauchy completion is the
unique continuous function d : F × F →R such that ¯d(i(x), i(y)) = d(x, y). If
a real-valued function| · |F is deﬁned on F by |x|F = ¯d(x, 0) for x ∈F, then | · |F
is an absolute value on F, and i : (F, | · |F) →(F, | · |F) is a homomorphism
of valued ﬁelds. Moreover, the absolute value on F is nonarchimedean if the
absolute value on F is nonarchimedean.
REMARKS.
The usual construction of the Cauchy completion embeds the
original metric subspace as a dense subset of a complete metric space, and
therefore this theorem is showing that i : (F, | · |F) →(F, | · |F) is a completion
of (F, | · |F).

4. Completions
343
PROOF. The proof of this theorem is almost the same as the ﬁrst part of the
proof of Proposition 6.1, apart from notational changes. The differences occur in
spots where the ultrametric inequality was invoked in the proof of Proposition 6.1
and only the triangle inequality is available here. The main such difference is the
argument that the validity of the triangle inequality on F implies the validity of the
triangleinequalityon F, andwegivethatargumentinamoment. Correspondingly
it is unnecessary for us to prove that the validity of the ultrametric inequality on
F implies the validity of the ultrametric inequality on F, because that argument
does occur in the proof of Proposition 6.1.
The other places in the proof of Proposition 6.1 where the ultrametric inequality
was used are in the proof that the completion is a topological ﬁeld. It is not
necessary to modify that proof here, however, since we can invoke Proposition
6.13.
Thus let us see that the validity of the triangle inequality on F implies the
validity of the triangle inequality on F. To proceed, let x and y be members of
F = R/I, and let {qn} and {rn} be respective coset representatives of them in R.
Then {qn + rn} is a representative of x + y, by deﬁnition, and the continuity of
| · |F on F implies that limn |qn + rn|p = |x + y|p. From this limit formula and
the triangle inequality for F, we obtain
|x + y|F = lim
n |qn + rn|F ≤lim sup
n
(|qn|F + |rn|F)
≤lim sup
n
|qn|F + lim sup
n
|rn|F = |x|F + |y|F ,
since limn |qn|F = |x|F and limn |rn|F = |y|F. This proves the triangle inequality
on F.
□
A valued ﬁeld (L, | · |L) is said to be complete if L is Cauchy complete in
the metric deﬁned by | · |L. In Section 6 we shall make crucial use of a universal
mapping property of the completion of a valued ﬁeld.
Theorem 6.25. If ι : (F, | · |F) →(K, | · |K) is a completion of the valued
ﬁeld (F, | · |F) and if ϕ : (F, | · |F) →(L, | · |L) is a homomorphism of valued
ﬁelds with (L, | · |L) complete, then there exists a unique homomorphism of
valued ﬁelds  : (K, | · |K) →(L, | · |L) such that ϕ =  ◦ι.
REMARKS. As usual with universal mapping properties, this theorem implies
a uniqueness result: any two completions of a valued ﬁeld are canonically iso-
morphic. It is not necessary to write out the details. Making a small adjustment
to the proof below, we see also that if a ﬁeld has two equivalent absolute values
on it, then the corresponding two completions are canonically isomorphic by a
ﬁeld map that respects the topologies.

344
VI. Reinterpretation with Adeles and Ideles
PROOF. The theory of completion of a metric space produces a unique con-
tinuous function  : K →L such that ϕ =  ◦ι, and this continuous function
respects the metrics. It is necessary to check only that  respects addition and
multiplication.
The argument is the same for the two operations, and we check only addition.
Let x and y be given in K, and choose sequences {xn} and {yn} in F with
lim ι(xn) = x, lim ι(yn) = y. Since addition is continuous in K, lim ι(xn + yn) =
x + y. Since  is a continuous function with ϕ =  ◦ι,
(x) + (y) = (lim ι(xn)) + (lim ι(yn))
= lim((ι(xn))) + lim((ι(yn))) = lim(ϕ(xn)) + lim(ϕ(yn))
= lim(ϕ(xn) + ϕ(yn)) = lim(ϕ(xn + yn))
= lim(ι(xn + yn)) = (lim ι(xn + yn)) = (x + y),
and  respects addition.
□
Theorem 6.24 generalizes the parts of Proposition 6.1 concerning Qp but not
those concerning Zp. The arguments concerning Zp transparently made use of
the ultrametric inequality, and they used a little more. The extra fact used is
that the p-adic absolute value is deﬁned from a discrete valuation. In view of
Corollary 6.17 and Example 1 of nonarchimedean absolute values in the previous
section, a necessary and sufﬁcient condition for a nontrivial absolute value on a
ﬁeld F to be obtained from a discrete valuation is that the image of F× under
the valuation be a discrete subset of the positive reals. Such an absolute value is
automatically nonarchimedean.
Theorem 6.26. Let ι : (F, | · |F) →(F, | · |F) be a completion of a valued
ﬁeld, and suppose that | · |F is nontrivial and discrete. Let v( · ) be the discrete
valuation that deﬁnes | · | on F. Then
(a) the image |F
×|F equals the image |F×|F, and | · |F on F is therefore
deﬁned by a discrete valuation ¯v( · ) on F such that ¯v ◦ι = v,
(b) the image ι(R) of the valuation ring R of v is dense in the valuation ring
R of ¯v,
(c) for every integer n > 0, the image ι(Pn) of the nth power Pn of the
valuation ideal P of v is dense in the nth power P
n of the valuation ideal
P of ¯v,
(d) the residue class ﬁelds of F and F coincide in the sense that the mapping
ι : R →R descends to a ﬁeld isomorphism of R/P onto R/P,
(e) for every integer n > 0, the mapping ι : R →R descends to a ring
isomorphism of R/Pn onto R/P
n,
(f) R is compact if R/P is ﬁnite, and in this case the topological ﬁeld F is
locally compact.

4. Completions
345
REMARK. No assertion is made in (d) and (e) about whether the topologies
match under the constructed isomorphisms. Our interest will be mostly in the case
that R/P is ﬁnite, in which case the topologies match because they are discrete.
PROOF. Write |F×|F in the form rZ for a unique real number r > 1. For
(a), since |ι(x)|F = |x|F and since ι(F) is dense in F, the continuity of the
absolute value | · |F implies that the image of F
× is contained in the closure of
rZ within the positive reals, which is rZ. The formula ¯v ◦ι = v follows from the
computation r−v(x) = |x|F = |ι(x)|F = r−¯v(ι(x)) by taking the logarithm to the
base r.
For (b) and (c), we use that ι(F) is dense in F, and we treat (b) as the case n = 0
of (c). Fix n ≥0 and consider P
n. Choose a sequence {xk} in F with {ι(xk)}
converging to a point x in P
n. Since |x|F ≤r−n, we must have |xk|F < r−n+1
for all sufﬁciently large k. The elements xk satisfying this condition are in Pn,
and thus ι(Pn) is dense in P
n.
For (d) and (e), the mapping R →R/P
n descends to R/Pn, since ι(P) ⊆P.
The descended map is one-one, since if x ∈R maps to the 0 coset, then x is in
ι−1(P
n) = Pn. To see that the descended map is onto, let a coset ¯x + P
n be
given. Since ι(R) is dense in R, we can choose x ∈R with |ι(x) −¯x|F < r−n.
Since P
n =

y ∈F
|y| < r−n+1
, ι(x) −¯x is in P
n. Hence ι(x) is exhibited
as in ¯x + P
n, and the coset x + Pn maps to the coset ¯x + P
n.
In (f), Corollary 8.60 of Basic Algebra shows that Pn/Pn+1 is a 1-dimensional
vector space over R/P. The First Isomorphism Theorem gives an R module
isomorphism (R/Pn+1)

(R/Pn) ∼= Pn/Pn+1, and it follows by induction on n
that the ﬁniteness of R/P implies the ﬁniteness of R/Pn. In view of (e), R/P
n
is ﬁnite for every n > 0.
For each n > 0, the set R is covered by the cosets of P
n, which are closed
balls in F of radius r−n and open balls of radius r−n+1. Thus for any positive
radius, there exists a ﬁnite collection of open balls of that radius or less such that
the union of the open balls covers R. This means that R is totally bounded in the
metric space F. A totally bounded closed subset of a complete metric space is
compact, and consequently R is compact.
Thus the 0 element of F has R as a compact neighborhood. Since addition is
continuous, each member x of F has x + R as a compact neighborhood of x, and
therefore F is locally compact.
□
Let us review brieﬂy. We start with an absolute value on a ﬁeld F. The
cases of initial interest are that F is a number ﬁeld or is a function ﬁeld in one
variable, namely a ﬁnite algebraic extension of a ﬁeld k(X), where k is a given
base ﬁeld; in the latter case we assume that the absolute value is identically 1
on k×. A number ﬁeld can have archimedean absolute values, and we come

346
VI. Reinterpretation with Adeles and Ideles
to them in a moment. In the function-ﬁeld case we know that every absolute
value is nonarchimedean if k has nonzero characteristic; this remains true for
characteristic zero but we did not prove it. For our cases of interest the nonar-
chimedean nontrivial absolute values are always given by a discrete valuation.
Thus let us summarize what happens for a nonarchimedean nontrivial absolute
value that is given by a discrete valuation. Within the given ﬁeld F we have
singled out a Dedekind domain R for which F is the ﬁeld of fractions,8 and the
absolute value is ≤1 on R. For example, in the number-ﬁeld case R is the ring
of algebraic integers in F. In all cases the discrete valuation v is determined by a
nonzero prime ideal p of R, and the absolute value on F is given by |x|F = r−v(x)
for some number r > 1. Our two-step process consists in a step of localization
and a step of completion. The step of localization passes to the principal ideal
domain S−1R with maximal ideal S−1p, where S is the complement of p in R.
The domain S−1R coincides with the valuation ring of v, and the ideal S−1p
coincides with the valuation ideal of v. The absolute value on F does not change
during this process of localization. The ideal S−1p is principal in S−1R, say with
π as a generator. The element π can be chosen to be in p, and it has v(π) = 1.
Theorem 6.5 and Proposition 6.11 govern relationships between R and S−1R.
Brieﬂy the powers of p are dense in the powers of S−1p, and the natural map of
residue class ﬁelds R/p →S−1R/S−1p is a ﬁeld isomorphism onto.
The second step is a step of completion with respect to the absolute value.
The completion of a valued ﬁeld (F, | · |F) is a homomorphism of valued ﬁelds
ι : (F, | · |F) →(L, | · |L) such that (L, | · |L) is complete as a metric space
and ι carries F onto a dense subﬁeld of L. This exists by Theorem 6.24. In
the situation with a nonarchimedean nontrivial absolute value that is given by a
discrete valuation, one often writes Fp for the completed ﬁeld L. The eventual
interest is partly in what happens to R and p, but we ﬁrst consider S−1R and
S−1p. The completed absolute value | · |Fp is given by a discrete valuation ¯v
with ¯v ◦ι = v. Let us write Rp for its valuation ring and pp for its valuation
ideal. Theorem 6.26 governs the relationships between S−1R and Rp. Brieﬂy
the images under ι of the powers of S−1p are dense in the powers of pp, and the
natural map of residue class ﬁelds S−1R/S−1p →Rp/pp induced by ι is a ﬁeld
isomorphism onto.
The case of most interest for number theory is the case of a number ﬁeld F and
the absolute value determined by a nonzero prime ideal p in the ring of algebraic
integers of F. The ﬁeld Fp is called the ﬁeld of p-adic numbers, and the ring
Rp is called the ring of p-adic integers. When F = Q and p = pZ for a prime
number p, the element π can be taken to be p.
8The case R = F is excluded; this is the case that produces the trivial absolute value, which
does not interest us.

4. Completions
347
In the case of a function ﬁeld in one variable that is most analogous to a
number ﬁeld, one starts from a ﬁeld F that is a ﬁnite algebraic extension of
Fq(X), where Fq is a ﬁnite ﬁeld with q elements. According to Corollary 6.22,
all but ﬁnitely many of the nonarchimedean absolute values are deﬁned in terms
of nonzero prime ideals in the integral closure of Fq[X] in F; the others are
the prime constituents of the ideal X−1Fq[X−1] in Fq[X−1]. One can show that
the ring in the completion analogous to Rp is always a ring of formal power
series Fq′[[X]] in one indeterminate X and with coefﬁcients in a ﬁnite extension
Fq′ of Fq. Elements of this ring are arbitrary formal power series of the form
	∞
k=0 ck Xk with all ck in Fq′. The ﬁeld of fractions analogous to Fp is always a
ﬁeld of formal Laurent series Fq((X)) in one indeterminate; nonzero elements
of this ﬁeld are arbitrary expressions of the form 	∞
k=−N ck Xk with all ck in Fq′,
with c−N ̸= 0, and with N depending on the element.
Let us now examine archimedean completions. We shall discuss what happens
when we start from a number ﬁeld, and then we make some remarks without proof
about the general case. Thus let F be a number ﬁeld, and let an archimedean
absolute value be given on it. To have notation parallel to the nonarchimedean
case, it is customary to index the absolute value9 by a symbol like v, writing | · |v
for it. Corollary 6.16 shows that the restriction of | · |v to Q is nontrivial, and the
combination of Proposition 6.14 and Ostrowski’s Theorem (Theorem 6.15) shows
that the restriction to Q is equivalent to the ordinary absolute value. Adjusting
| · |v within its equivalence class, we may assume that its restriction to Q matches
the ordinary absolute value. Using Theorem 6.24, we form the completion of F
with respect to | · |v, writing Fv for the completed space. The limits of Cauchy
sequences from Q itself show that R lies in the completed space, since | · |v
matches the ordinary absolute value on Q. Thus we can regard R as a subﬁeld
of Fv, and F is a subﬁeld as well. Consequently the set RF of sums of products
is a subring of Fv. The multiplication mapping of R × F into Fv is Q bilinear
and has a linear extension R ⊗Q F →Fv whose image is RF. The R dimension
of R ⊗Q F is [F : Q], and consequently the R dimension of RF is ≤[F : Q],
hence ﬁnite. Being a ﬁnite-dimensional R algebra embedded in a ﬁeld, RF is a
subﬁeld10 of Fv. It is therefore a ﬁnite algebraic extension of R and must be R
or C. Thus F lies in R or C. The ﬁelds R and C are complete relative to the
ordinary absolute value, and hence RF is a closed subset of Fv. Since F is dense,
we conclude that Fv is R or C.
Visualize having a standard copy of C available, with R embedded in it. From
the above remarks, any archimedean absolute value of the number ﬁeld F, after
9Or the equivalence class of the absolute value.
10Withinaﬁeldifanonzeroelementisalgebraicoverabaseﬁeld, thenthesmallestringcontaining
the base ﬁeld and the element contains also the inverse of the element.

348
VI. Reinterpretation with Adeles and Ideles
adjustment within its equivalence class, yields a completion that takes one of the
two forms
σ : (F, | · |v) →(R, | · |)
and
σ : (F, | · |v) →(C, | · |),
where | · | is ordinary absolute value on R or C. Conversely any ﬁeld mapping σ
of F into R or C has dense image either in R or in C and deﬁnes an archimedean
absolute value on F by | · |v = σ ∗(| · |). Then σ : (F, | · |v) →(R or C, | · |)
is a completion by Theorem 6.25.
To classify the archimedean absolute values up to equivalence, we recall from
Section V.2 that the number of distinct ﬁeld maps σ into C of a number ﬁeld
F of degree [F : Q] = n is exactly n, with a certain number r1 of them having
image in R and with the remainder 2r2 having image in C but not R and occurring
in complex conjugate pairs. Each such ﬁeld map σ gives us a completion. The
members of a complex conjugate pair result in the same absolute value on F when
the ordinary absolute value of C is restricted to F. We shall show that there are
no other equivalences.
Proposition 6.27. Let F be a number ﬁeld with [F : Q] = n, and let there
be r1 distinct ﬁeld maps of F into R and r2 complex conjugate pairs of distinct
ﬁeld maps of F into C, with r1 + 2r2 = n. Each such ﬁeld map σ induces an
archimedean absolute value on F by restriction fromR or C, the only equivalences
are the ones from pairs of ﬁeld maps related by complex conjugation, and the
resulting collection of r1 + r2 absolute values exhausts the archimedean absolute
values on F, up to equivalence.
PROOF. The remarks above show everything except that these r1 +r2 absolute
values are mutually inequivalent. To prove this fact, suppose that σ and σ ′ are two
ﬁeld maps of F into the same ﬁeld, R or C, such that x 	→|σ(x)| is equivalent
to x 	→|σ ′(x)|. Then ϕ = σ ′σ −1 is a ﬁeld isomorphism from image σ onto
image σ ′ that respects the absolute value, up to a power. It is therefore uniformly
continuous from image σ onto image σ ′. Consequently ϕ extends to all of R or C,
and the continuous extension respects the ﬁeld operations. On Q, ϕ is the identity,
and hence its continuous extension to R must be the identity. Thus the continuous
extension is an automorphism of R or C that ﬁxes R, and consequently it must
be the identity or complex conjugation.
□
It is of some interest to know what archimedean absolute values can occur in
other situations, besides number ﬁelds, and Theorem 6.24 shows that it is enough
to classify the complete ones. Ostrowski did so, and the result is that R and C,
with their ordinary absolute values, are the only complete archimedean ﬁelds up
to equivalence.11
11A proof of the Ostrowski result may be found in Hasse’s Number Theory, pp. 191–194. Gelfand

5. Hensel's Lemma
349
5. Hensel’s Lemma
Hensel’s Lemma is a device that in its simplest forms allows one to solve polyno-
mial equations in the ﬁeld Qp of p-adic numbers by using congruence information
modulo some power of p. It has a number of distinct formulations, all of which
work within any complete nonarchimedean valued ﬁeld, not limited to Qp. We
shallgiveafairlysimpleformulationandobtainahandyspecialcaseasacorollary,
using an adaptation of Newton’s method of iterations in calculus for ﬁnding roots
of polynomials. At the end of the section, we shall state without proof a version of
Hensel’s Lemma that works to factor polynomials rather than to ﬁnd their roots.
Yet another formulation of Hensel’s Lemma, whose precise statement we omit,
applies to systems of polynomial equations in several variables.
No overarching result of this chapter actually makes use of any version of
Hensel’s Lemma.
Instead, versions of Hensel’s Lemma are indispensable in
analyzing the ﬁne structure of complete valued ﬁelds and in handling examples.
ThustheapplicationsofHensel’sLemmainthisbookwilloccurintheexamplesof
this section and the next and also in problems at the end of the chapter. Problem 16
is one such problem.
Theorem 6.28 (Hensel’s Lemma). Let F be a ﬁeld with a nontrivial discrete
absolute value | · |, necessarily nonarchimedean, and assume that F is complete.
Let R be the valuation ring, and let f (X) be a polynomial in R[X]. Suppose that
a0 is a member of R such that
| f (a0)| < | f ′(a0)|2.
Then the sequence {an} recursively given by
an+1 = an −f (an)
f ′(an)
is well deﬁned in R and converges to a root a of f (X) that satisﬁes |a −a0| < 1.
PROOF.
Put c = | f (a0)|/| f ′(a0)|2 < 1.
We prove the following three
statements together by induction on n:
(i) an is well deﬁned and is in R,
(ii) | f ′(an)| = | f ′(a0)| ̸= 0, and
(iii) | f (an)|/| f ′(an)| ≤c2n| f ′(a0)|.
and Tornheim proved a more general result, with the same conclusion, that allows the multiplicative
property of absolute values to be relaxed somewhat. A proof of this result appears in Artin’s Theory
of Algebraic Numbers, pp. 45–51.

350
VI. Reinterpretation with Adeles and Ideles
The base case for the induction is the case n = 0, and the three statements are
true by hypothesis in this case.
Assume that the three statements hold for n. From (ii), an+1 is deﬁned, and
then (iii) shows that an+1 satisﬁes
(iii′) |an+1 −an| = | f (an)|/| f ′(an)| ≤c2n| f ′(a0)|.
The fact that an and f ′(a0) are in R, in combination with (iii′), shows that an+1
is in R. This proves (i) for n + 1.
For (ii) and (iii), we make use of the following Taylor expansions of f (X) and
f ′(X) about b:
f (X) = f (b) + (X −b) f ′(b) + (X −b)2g(X)
with g(X) ∈R[X]
and
f ′(X) = f ′(b) + (X −b)h(X)
with h(X) ∈R[X].
To check that these expansions are valid in any characteristic, it is enough to
check the ﬁrst one, since the second one follows by differentiation. For the ﬁrst
one, it is enough to treat the special case Xk. Dividing Xk −bk by X −b, we see
that we are to produce g(X) such that
(X −b)g(X) =
k−1
	
j=0
bk−1−j X j −kbk−1 =
k−1
	
j=0
bk−1−j(X j −b j).
Every term on the right side is divisible by X −b, and thus the quotient g(X) is
in R[X].
Put Qn = an+1 −an = −f (an)/f ′(an). By (iii) for n, |Qn| ≤| f ′(an)|c2n;
in particular, |Qn| < | f ′(an)|. In the expansion of f ′(X), we take b = an and
evaluate at X = an+1 to obtain
f ′(an+1) = f ′(an) + Qnh(an+1).
Since |Qn| < | f ′(an)| and |h(an+1)| ≤1, we see that | f ′(an+1)| = | f ′(an)|.
This proves (ii) for n + 1.
In the expansion of f (X), we take b = an and evaluate at X = an+1 to obtain
f (an+1) = f (an) + (an+1 −an) f ′(an) + (an+1 −an)2g(an+1).
But (an+1 −an) f ′(an) = −f (an), and hence this equation simpliﬁes to
f (an+1) = Q2
ng(an+1).

5. Hensel's Lemma
351
Since g(an+1) is in R, application of (iii) for n and (ii) for n + 1 gives
| f (an+1)|
| f ′(an+1)|2 = |Qn|2|g(an+1)|
| f ′(an)|2
≤
 | f (an)|
| f ′(an)|2
2
≤(c2n)2 = c2n+1,
and this proves (iii) for n + 1. This completes the induction.
Now we can prove the theorem. If n < m, then (iii′) and the ultrametric
inequality imply that
|am −an| ≤max
n≤k<m |ak+1 −ak| ≤| f ′(a0)| max
n≤k<m c2k ≤| f ′(a0)|c2n.
(∗)
Consequently {an} is a Cauchy sequence.
Let a be its limit.
Substituting
into the deﬁnition of an+1, using (ii), and passing to the limit, we obtain a =
a −f (a)/f ′(a). Thus f (a) = 0. Taking n = 0 in (∗) and letting m tend to
inﬁnity gives |a −a0| ≤| f ′(a0)|c, and this is ≤c < 1 because f ′(a0) is in R. □
Corollary 6.29 (Hensel’s Lemma). Let F be a ﬁeld with a nontrivial discrete
absolute value, necessarily nonarchimedean, and assume that F is complete. Let
R be the valuation ring, let p be the unique maximal ideal, and let f (X) be a
polynomial in R[X]. If f (X) is the reduced polynomial with coefﬁcients in R/p
and if ¯a is a simple root of f (X), then f (X) has a simple root a ∈R whose
image in R/p is ¯a.
PROOF. Let a0 be any member of R whose image in R/p is ¯a. The assumptions
imply that f (a0) is in p and that f ′(a0) is in R but not p. Thus the hypotheses
of Theorem 6.28 are satisﬁed, and the theorem produces a root a of f (X) with
a −a0 in p.
□
EXAMPLES WITH F = Qp AND R = Zp.
(1) Suppose that p is an odd prime and that n is an integer for which the
Legendre symbol
n
p

is +1, i.e., for which GCD(n, p) = 1 and n has a square
root modulo p. Then n has a square root in Zp. This is immediate from Corollary
6.29 with f (X) = X2 −n.
(2) Suppose that p = 2 and that n is an integer12 having the form 8k + 1. The
maximal ideal in Z2 is (2). Corollary 6.29 is not applicable to f (X) = X2 −n,
since evaluation of the derivative f ′(X) = 2X at any point of Z2 leads to a
member of the ideal (2). However, we can apply Theorem 6.28. Let a0 = 1,
so that f (a0) = 1 −n and f ′(a0) = 2. The theorem produces a root a in Z2 if
|1 −n|2/|2|2
2 < 1, i.e., if |1 −n|2 < 1
4. Since |1 −n|2 = | −8k|2 = 1
8|k|2 < 1
4,
the theorem indeed applies. The resulting root a in Z2 has a ≡1 mod (2).
12In fact, n could be a 2-adic integer in this argument.

352
VI. Reinterpretation with Adeles and Ideles
(3) Suppose that p > 3. Every nonzero residue ¯a in Z/pZ has ¯a p−1 ≡
1 mod p. Corollary 6.29 shows immediately that the polynomial X p−1 −1 has
a root a whose image in Zp/pZp is ¯a. Since the elements ¯a are distinct, we
conclude that Zp contains all p −1 of the (p −1)st root of unity.
(4) As promised at the beginning of Section 4, we show that Qp for p = 5
is obtained also by completing the ﬁeld Q(i) with respect to a certain absolute
value and that in fact there are two distinct equivalence classes of absolute values
on Q(i) for which Q5 results. Thus let F = Q, K = Q(i), and p = (5). The
prime factorization of (5)Z[i] is as (2 + i)(2 −i). If we put P1 = (2 + i) and
P2 = (2 −i), then K P1 and K P2 are both equal to Q5 because Example 1 above
shows that the square roots of −1 already appear in Q5. If a is one of the square
roots, then
2+a

5
2−a

5 =
(2+a)(2−a)

5 = |5|5 = 1
5. Thus one of
2+a

5
and
2 −a

5 equals 1
5 and the other equals 1. What is happening is that there are
two ﬁeld mappings Q(i) →Q5. For each of them, the effect on the base ﬁeld Q
is the same; however, one ﬁeld mapping sends i in Q(i) to a in Q5, and the other
sends i to −a. For deﬁniteness, let us say that
2 + a

5 = 1
5. Then the valuation
of Q(i) with respect to P1 = (2+i) is consistent with the 5-adic valuation of Q5,
but the valuation of P2 = (2 −i) is not. This example shows why the deﬁnition
of completion insists on a mapping of valued ﬁelds (respecting absolute values),
not merely a mapping of ﬁelds.
(5) Suppose that p = 2. The question is the prime factorization of f (X) =
X3 + X2 −2X +8 in Z2. This polynomial was studied at length toward the end of
Section V.4 in connection with common index divisors. It is irreducible over Q,
but we are to factor it over Q2. We shall show that it splits into ﬁrst-degree factors.
Considering the polynomial modulo 2, we ﬁnd that f (X) ≡(X −1)X2 mod 2.
Since 1 is a simple root modulo 2, Corollary 6.29 says that there exists an element
θ1 in Z2 such that f (θ1) = 0 and θ1 ≡1 mod 2. Dividing f (X) by X −θ1, we
obtain
f (X) = (X −θ1)

X2 + (θ1 + 1)X + (θ1(θ1 + 1) −2)

.
To show that the quadratic factor splits over Q2, it is necessary and sufﬁcient
to show that its discriminant is a square, since Q2 has characteristic 0. The
discriminant is
(θ1 + 1)2 −4(θ1(θ1 + 1) −2) = 4

( 1
2(θ1 + 1))2 −(θ1(θ1 + 1) −2)

,
and we can ignore the square factor of 4. We know that θ1 ≡1 mod 2. Let us
compute θ1 modulo 8Z2 by writing θ1 = 8ϕ + c with ϕ ∈Z2 and with c = ±1
or ±3. Substituting into f (X) and computing modulo 8Z2, we have
0 = f (θ1) ≡c3 + c2 −2c mod 8Z2.

6. Ramification Indices and Residue Class Degrees
353
Since c is odd, c3 ≡c and c2 ≡1 mod 8. Thus 0 ≡c + 1 −2c mod 8 and
c ≡1 mod 8. Consequently
( 1
2(θ1 + 1))2 −(θ1(θ1 + 1) −2) ≡1 mod 8.
By Example 2 any 2-adic integer that is ≡1 mod 8Z2 is a square in Z2, and thus
f (X) indeed factors over Z2 as the product of three ﬁrst-degree factors.
We conclude this section with a version of Hensel’s Lemma that we state
without proof.13 This version deals with factorizations rather than roots. Brieﬂy
it says that we can lift a relatively prime factorization modulo p to a factorization
in R[X] if at least one of the two factors modulo p has leading coefﬁcient 1. This
theorem certainly implies Corollary 6.29.
Theorem 6.30 (Hensel’s Lemma). Let F be a ﬁeld with a nontrivial discrete
absolute value, necessarily nonarchimedean, and assume that F is complete. Let
R be the valuation ring, let p be the unique maximal ideal, let k be the residue
class ﬁeld, and let f (X) be a polynomial in R[X]. Suppose that there exist
polynomials g0(X) and h0(X) in R[X] such that g0(X) mod p and h0(X) mod p
are relatively prime ink[X], g0 has leading coefﬁcient 1, and f (X) factors modulo
p as f (X) ≡g0(X)h0(X) mod p. Then there exist polynomials g(X) and h(X)
in R[X] such that g(X) has leading coefﬁcient 1, g(X) ≡g0(X) mod p, h(X) ≡
h0(X) mod p, and f (X) factors in R(X) as f (X) = g(X)h(X).
6. Ramiﬁcation Indices and Residue Class Degrees
Sections 1–4 have presented the ingredients of a two-stage process for analyzing
congruence information, and now it is time to use everything together. The goal
is to have techniques for extracting information about a global number-theoretic
problem by seeing what the problem says about ideals, for reducing the questions
about ideals to questions about powers of prime ideals, and for then assembling
the results.
We give one illustration of the utility of our constructions: With the techniques
we had in Chapter V, we gave only a partial proof of the Dedekind Discriminant
Theorem (Theorem 5.5). By contrast, we shall see in Section 8 that the present
techniques lead naturally to a complete proof.
Although we might want to work just within one number ﬁeld, it is helpful to
change the context so that we are comparing a number ﬁeld with a ﬁnite extension.
There is no loss of generality in doing so; we can always take the base ﬁeld to
13A proof may be found in Hasse’s Number Theory, pp. 169–172.

354
VI. Reinterpretation with Adeles and Ideles
be the rationals Q, and the effect is that we consider only the ﬁnite set of prime
ideals for the extension ﬁeld that contain a given prime number p.
As long as we are going to consider ﬁnite extensions of ﬁelds in addressing
number theory, we might as well treat also the case of function ﬁelds in one
variable, at least to the extent that the two theories are quite analogous. Thus we
are led to the following set-up.
Let R be a Dedekind domain considered as a subring of its ﬁeld of fractions
F, let K be a ﬁnite separable14 extension of F with [K : F] = n, and let T be
the integral closure of R in K. We shall work with F and K as valued ﬁelds,
having some absolute value on them. The case of interest in this section will be
that the absolute value is nonarchimedean and arises from a discrete valuation
whose valuation ring contains R or T , respectively. Theorem 6.5 shows that the
valuation is deﬁned by means of some prime ideal ℘of R or T , and the associated
absolute value may thus be denoted by an expression15 like | · |℘.
We start from a prime ideal p in R and form the corresponding absolute value
on F as in Section 3, obtaining a valued ﬁeld (F, | · |p). Then we complete as in
Section 4, writing the completion as
ψ0 : (F, | · |p) →(Fp, | · |p).
We know that the ideal pT in T has a prime factorization of the form pT =
Pe1
1 · · · P
eg
g , where P1, . . . , Pg are distinct prime ideals in T . The integers ei are
called ramiﬁcation indices and the dimensions fi = dimR/p(T/Pi) are called
residue class degrees. We are interested in saying everything we can about
P1, . . . , Pg and about the indices ei and fi. The fundamental relationship is
given by Theorem 9.60 of Basic Algebra, namely
g

i=1
ei fi = n.
We know that each Pi gives us a nonarchimedean absolute value | · |Pi on K,
unique up to equivalence, and then a completion
ψi : (K, | · |Pi) →(K Pi, | · |Pi).
14The role of separability will become apparent before the statement of Theorem 6.31 below.
15The number-theory case ultimately requires also a limited amount of analysis of archimedean
absolute values, and that will be carried out in Section 9. In the context of passing from a Diophantine
equation to congruence information, part of the role that archimedean absolute values play is in
analyzing signs. Thus for example the simple-minded equation x2 + y2 = −1 has no solutions in
integers; the reason for the absence of solutions is a constraint on signs, not some limitation from
congruences with respect to powers of primes. Archimedean absolute values control signs.

6. Ramification Indices and Residue Class Degrees
355
The ﬁrst important step is to establish an isomorphism involving ﬁelds such
that the identity 	g
i=1 ei fi = n is a dimension formula that follows from the
isomorphism. The identity in question concerns the ring K ⊗F Fp, which is
a commutative algebra over K or over Fp, whichever we like, and which is
semisimple by Corollary 2.30 under our assumption that K is a ﬁnite separable
extension of F.
The Wedderburn theory (Theorems 2.2 and 2.4) shows that
K ⊗F Fp is isomorphic to a ﬁnite direct product of ﬁelds,16 each of which is a
ﬁnite extension of Fp. What we shall prove later in this section is the following
theorem.
Theorem 6.31. Let R be a Dedekind domain considered as a subring of its
ﬁeld of fractions F, let K be a ﬁnite separable extension of F with [K : F] = n,
and let T be the integral closure of R in K. If p is a nonzero prime ideal of R
and if the ideal pT in T has a prime factorization of the form pT = Pe1
1 · · · P
eg
g ,
where P1, . . . , Pg are distinct prime ideals in T and the ej are positive integers,
then
K ⊗F Fp ∼=
g

j=1
K Pj.
When the formula 	g
j=1 ej fj = n is specialized to the ﬁeld extension K Pj/Fp,
it becomes e∗
j f ∗
j = [K Pj : Fp], where e∗
j and f ∗
j are the ramiﬁcation index and
residue class degree associated to K Pj/Fp. If we accept for the moment the result
of Lemma 6.36 below that e∗
j and f ∗
j coincide with the corresponding indices ej
and fj for K/F, then n = 	g
j=1 ej fj = 	n
j=1 e∗
j f ∗
j = 	g
j=1[K Pj : Fp] indeed
counts the Fp dimensions of both sides of the formula K ⊗F Fp ∼= g
j=1 K Pj
in the theorem. The theorem says much more than this, and we shall mine its
consequences after giving the proof of the theorem.
For orientation, let us recall Example 4 from Section 5. In that example, we had
R = Z, F = Q, K = Q(i), T = Z[i], p = 5Z, and Fp = Q5. The factorization
pT =  P
ej
j is 5Z[i] = (2 + i)(2 −i), and the two completed versions of K are
K(2+i) ∼= Q5 and K(2−i) ∼= Q5. Thus the identity in the theorem specializes to
Q(i) ⊗Q Q5 ∼= Q5 × Q5.
Proving the identity on this level would be more challenging than necessary
because the isomorphism cannot be unique; it can always be composed with
the interchange of the two factors on the right side. For this reason the proof
makes use of valued ﬁelds, and then in effect the desired isomorphism becomes
a constructive one that we can write down rather explicitly.
16The words “direct product” in connection with ﬁnitely many ﬁelds refer to the direct sum of
the additive structures, with multiplication given coordinate by coordinate.

356
VI. Reinterpretation with Adeles and Ideles
Let us now work toward proving Theorem 6.31. Above, we mentioned the
completion mapping ψ0 for F relative to an absolute value in the equivalence
class determined by p, as well as ψj for K relative to some absolute value in the
class determined by Pj. In addition, we have inclusion mappings corresponding
to the ﬁeld extensions K/F and K Pj/Fp. Figure 6.1 below is a square diagram
that assigns the names ϕ0 and ϕj to these as well.
F
ψ0
−−−→Fp
ϕ0
⏐⏐+
⏐⏐+ϕj
K
ψj
−−−→K Pj
FIGURE 6.1. Commutativity of completion and extension as ﬁeld mappings.
The diagram in Figure 6.1 commutes. In fact, ψjϕ0 and ϕjψ0 are both F
homomorphisms, being compositions of F homomorphisms, and hence x ∈F
implies ψjϕ(x) = x(ψjϕ(1)) = x(1) = x(ϕjψ0(1)) = ϕjψ0(x).
But more is true: we are going to impose absolute values on the four ﬁelds in the
diagram in such a way that the four ﬁeld mappings are homomorphisms of valued
ﬁelds. We have already deﬁned | · |p on F as any absolute value corresponding
to p, and then | · |p is deﬁned on Fp in such a way that the completion mapping
ψ0 preserves absolute values. Theorem 6.33 below will enable us to deﬁne an
absolute value in a unique fashion on K Pj such that ϕj preserves absolute values.
Proposition 6.34 will give us the deﬁnition of an absolute value on K, and we
shall check in Lemma 6.35 that Figure 6.1 with these absolute values in place is
a commutative diagram of valued ﬁelds. Finally we use this commutativity to
prove in Lemma 6.36 that the ramiﬁcation index e∗
j and residue class degree f ∗
j
for K Pj/Fp match the corresponding parameters ej and fj for K/F, and then we
are ready for the main part of the proof of the theorem.
We begin our preliminary work by limiting the possibilities for a ﬁnite exten-
sion of a complete valued ﬁeld (F, | · |F). If K is a ﬁnite extension of F, a norm
on the F vector space K relative to | · |F is a function ∥· ∥from K to R having
(i) ∥x∥≥0 on K with equality if and only if x = 0,
(ii) ∥cx∥= |c|F∥x∥for c ∈F and x ∈K,
(iii) ∥x + y∥≤∥x∥+ ∥y∥for all x and y in K.
Lemma 6.32. If (F, | · |F) is a complete valued ﬁeld, if K is a ﬁnite extension
of F, and if ∥· ∥1 and ∥· ∥2 are any two norms on K relative to | · |F, then there
exist real constants C and C′ such that
∥x∥1 ≤C∥x∥2
and
∥x∥2 ≤C′∥x∥1
for all x ∈K.
Consequently K is Cauchy complete in the metric induced by either norm.

6. Ramification Indices and Residue Class Degrees
357
REMARK. It is not important that K be a ﬁeld in this lemma, only that it be a
ﬁnite-dimensional vector space over F.
PROOF. Let n = dimF K. Fixing an ordered basis (x1, . . . , xn) of K over F,
we may express any member x of K in the form x = 	n
i=1 cixi with all ci in F.
With the ci’s deﬁned this way, we deﬁne ∥x∥sup = max1≤i≤n |ci|F. To prove the
displayed inequalities, it is enough to prove them for ∥· ∥sup and any other norm
∥· ∥. For one direction of the inequality, we have
∥x∥=
00 	
i cixi
00 ≤	
i ∥cixi∥= 	
i |ci|F∥xi∥≤
 	
i ∥xi∥

∥x∥sup.
This proves that ∥x∥≤C∥x∥sup with C = 	
i ∥xi∥.
For the reverse inequality we shall prove by induction on k that an inequality
∥x∥sup ≤C′
k∥x∥holds for all x in the F linear span of at most k of the vec-
tors x1, . . . , xn. The base case for the induction is k = 1, and then ∥x∥sup =
∥xi∥−1∥x∥whenever x is a multiple of xi. So C′
1 = max1≤i≤n(∥xi∥−1).
Assume that C′
1, . . . , C′
k exist and that we are to produce C′
k+1. Arguing by
contradiction, we may assume that there is some sequence {x(m)} in K, each term
having at most k + 1 nonzero coefﬁcients, such that ∥x(m)∥= 1 for all m and
∥x(m)∥sup tends to inﬁnity. Possibly by passing to a subsequence, we may assume
that the nonzero coefﬁcients of x(m) all lie in a particular subset of k + 1 of the
coefﬁcients, and there is no harm in assuming that this subset is {1, . . . , k + 1}.
Passing to a further subsequence, we may assume that there is some index j such
that the largest coefﬁcient of each x(m), when measured by | · |F, is the jth, and
there is no harm in assuming that j = k + 1.
Let c(m)
1
, . . . , c(m)
k+1 be the coefﬁcients of x(m), so that x(m) = 	k+1
i=1 c(m)
i
xi. Put
y(m) = (c(m)
k+1)−1x(m) = 	k
i=1 d(m)
i
xi + xk+1, where d(m)
i
= (c(m)
k+1)−1c(m)
i
. Here
|d(m)
i
|F ≤1 for 1 ≤i ≤k and for all m, and also ∥y(m)∥= |c(m)
k+1|−1
F ∥x(m)∥=
|c(m)
k+1|−1
F tends to 0.
For each vector y(m)−xk+1, only the ﬁrst k coefﬁcients can be nonzero, and the
same thing is true of differences y(m) −y(m′) of two such vectors. The inductive
hypothesis tells us that ∥y(m) −y(m′)∥sup ≤C′
k∥y(m) −y(m′)∥, and the right
side tends to 0 as m and m′ tend to inﬁnity because ∥y(m)∥and ∥y(m′)∥tend to 0.
Therefore the ith coordinate of y(m) forms a Cauchy sequence. Since F is given as
complete, {y(m)} is convergent in the norm ∥· ∥sup to some y = 	k
i=1 dixi +xk+1
in K.
By the easy direction of our inequality, ∥y(m)−y∥≤C∥y(m)−y∥sup. The right
side tends to 0, and hence so does the left. We know that ∥y(m)∥tends to 0, and
hence y = 0. But this conclusion contradicts the form of y as 	k
i=1 dixi + xk+1
with coefﬁcient 1 for xk+1. We conclude that C′
k+1 exists as asserted, and the
lemma follows.
□

358
VI. Reinterpretation with Adeles and Ideles
Theorem 6.33. If (F, | · |F) is a complete valued ﬁeld relative to a nontrivial
nonarchimedean discrete absolute value and if K is a ﬁnite separable extension
of F with [K : F] = n, then K has a unique absolute value | · |K extending
| · |F, K is complete and nonarchimedean, and the integral closure T in K of
the valuation ring R of F is the valuation ring of K. The extension is given by
|x|K = |NK/F(x)|1/n
F .
REMARKS. Since T is the valuation ring, Proposition 6.2 shows that T has a
unique nonzero prime ideal. It follows that if p is a nonzero prime ideal of R,
then pT = Pe for a single prime ideal P of T . We shall make frequent use of
this fact in applications without explicit mention.
PROOF. For uniqueness, suppose that | · |1 and | · |2 are two absolute values on
K that extend | · |F. Let us see that each of these is a norm on K relative to | · |F.
In fact, what needs checking for | · |1 is that the function respects scalars from
F appropriately. If c is in F and x0 is in K, then |cx0|1 = |c|1|x0|1 = |c|F|x0|1,
the second equality following because | · |1 restricts to | · |F on F. A similar
argument applies to | · |2, and thus we are dealing with two norms.
If the two given absolute values are inequivalent, then Proposition 6.12 shows
in the presence of the nontriviality of | · |F that we can ﬁnd an x ∈K with
|x|1 > 1 and |x|2 ≤1. Then limk |x−k|1 = 0 while |x−k|2 ≥1 for all k.
Consequently there cannot exist a constant C such that |y|2 ≤C|y|1 for all
y ∈F, in contradiction to Lemma 6.32.
We conclude that | · |1 and | · |2 are equivalent, say that |x|1 = |x|s
2 for all
x ∈K and some s > 0. Since | · |F is nontrivial, there exists some x0 ∈F
with |x0|1 > 1. The equality |x0|1 = |x0|s
2 then implies that s = 1. This proves
uniqueness.
We turn to existence. Proposition 6.2 shows that the valuation ring R in F for
the discrete valuation vF corresponding to | · |F on F is a local principal ideal
domain and that the valuation ideal p is the unique maximal ideal of R. Theorem
6.5 shows that the valuation vp determined by p is the same as the given valuation
vF. Hence | · |F is given for all a ∈F by |a|F = r−vp(a) for some r > 1. Let π
be a generator of the principal ideal p of R.
Since K/F is ﬁnite and separable, Theorem 8.54 of Basic Algebra shows that
the integral closure T of R in K is a Dedekind domain. Let pT = Pe1
1 · · · P
eg
g
be the factorization of the ideal pT of T into the product of powers of distinct
prime ideals of T . Each Pj deﬁnes a nonarchimedean valuation vPj of K. If a
is any element of F, then we can write a = πku for some u ∈R× and some
integer k. The computation aT = aRT = πkuRT = πk RT = πkT = pkT =
Pke1
1
· · · P
keg
g
shows that vp(a) = k and that vPj(a) = kej. Hence vPj = ejvp on
F, and therefore the formula |x|Pj = (re−1
j )−vPj (x) for x ∈K deﬁnes an absolute

6. Ramification Indices and Residue Class Degrees
359
value on K that has |a|F = r−vp(a) = r−e−1
j vPj (a) = (re−1
j )−vPj (a) = |a|Pj for all
a in F. This proves existence. The absolute value | · |Pj on K is complete by
Lemma 6.32 and is nonarchimedean because it is given by a discrete valuation.
Let us show that g = 1. Arguing by contradiction, suppose that there are at
least two distinct prime ideals P1 and P2 of T that contain p. Since P1 + P2 = T ,
we can choose x1 ∈P1 and x2 ∈P2 with x1 + x2 = 1. Then vP1(x1) > 0 and
vP1(1) = 0, from which we see that vP1(x2) = 0. Since vP2(x2) > 0, we obtain
a contradiction to the uniqueness part of the theorem. Thus the prime ideal of T
is unique. Let us write P for this ideal.
We know that vP(T ) ≥0, i.e., that T is contained in the valuation ring of vP.
Proposition 6.4 shows that the valuation ring of vP equals S−1T , where S is the
complement of P in T . The uniqueness of P means that T is local, and hence
every member of S is a unit in T . Thus S−1T = T , and T is the valuation ring.
Write | · |K in place of | · |Pj. To prove the explicit formula for | · |K in
the statement of the proposition, choose a ﬁnite Galois extension L of F that
contains K; such a ﬁeld L exists because K/F is separable.17 By the existence
just proved, let | · |L be an extension of | · |K to L. If σ is in Gal(L/F), then
x 	→|σ(x)|L and x 	→|x|L are both absolute values on L that extend | · |F. By
the uniqueness just proved, |σ(x)|L = |x|L. Applying | · |L to both sides of the
formula NL/F(x) = 
σ∈Gal(L/F) σ(x) gives
|NL/F(x)|F = |NL/F(x)|L =

σ∈Gal(L/F)
|σ(x)|L = |x|[L:F]
L
.
(∗)
If x is in K, then the left side equals (|NK/F(x)|F)[L:K], and the right side equals
(|x|K)[L:K][K:F] = (|x|[K:F]
K
)[L:K]. Thus the desired formula follows by extracting
the positive [L : K]th root of both sides of (∗).
□
Proposition 6.34.
Under the hypotheses of Theorem 6.31, let vp be the
valuation of F deﬁned by p, and let vPj be the valuation of K deﬁned by Pj,
1 ≤j ≤g. Then ejvp = vPj

F. Consequently if | · |p is an absolute value on
F deﬁned by p, then for each j some member | · |Pj of the equivalence class
of absolute values deﬁned on K by Pj is an extension of | · |p. In this case the
inclusion of (F, | · |p) into (K, | · |Pj) is a homomorphism of valued ﬁelds.
PROOF. Let S be the multiplicative system in R given as the set-theoretic
complement of p in R. For the ﬁrst conclusion Proposition 6.4 and Theorem 6.5
together show that it is enough to prove that
ejvS−1p = vS−1 Pj

F.
(∗)
17The ﬁeld L can be taken to be a splitting ﬁeld of the minimal polynomial over F of an element
ξ such that K = F(ξ). The extension L/F is separable by Corollary 9.30 of Basic Algebra.

360
VI. Reinterpretation with Adeles and Ideles
From the identity
pT = Pe1
1 · · · P
eg
g ,
we have
S−1pT = (S−1P1)e1 · · · (S−1Pg)eg.
(∗∗)
Since S is the complement of p in R, vp is 0 on S. Hence vS−1p is 0 on S. From
R ∩Pj = p, we have S ∩Pj ⊆S ∩p = ∅. Thus the members of S lie in R ⊆T
but in no Pj, and vPj is 0 on S. Hence vS−1 Pj is 0 on S.
Let π be a generator of the principal ideal S−1p in S−1R, so that vS−1p(π) = 1.
Since π S−1T = S−1pT , equation (∗∗) shows that vS−1 Pj(π) = ej. Each element
y of F is of the form y = πku for some integer k and some u ∈F with
vS−1p(u) = 0. The element u must be in S−1R but not S−1p and hence is in
S−1. Thus vS−1 Pj(u) = 0. We have now seen that vS−1 Pj(x) = ejvS−1p(x) for the
element x = u above and also for x = π. Therefore vS−1 Pj(x) = ejvS−1p(x) for
all x ∈F, and (∗) is proved.
Now that ejvp = vPj

F, choose r > 1 such that |x|p = r−vp(x) for x ∈F.
If r′ is deﬁned by r = (r′)ej, then the deﬁnition |x|Pj = (r′)−vPj (x) for x ∈K
restricts for x ∈F to |x|Pj = (r′)−vPj (x) = (r′)−ejvp(x) = r−vp(x) = |x|p, and the
inclusion is indeed a homomorphism of valued ﬁelds.
□
With these facts in place, let us make Figure 6.1 into a commutative diagram
of valued ﬁelds. From p, we use any corresponding choice of | · |p on F, and
this uniquely determines an absolute value by the same name on Fp. Next we
apply Theorem 6.33 to the inclusion ϕj : Fp →K Pj to obtain a unique extension
of | · |p from Fp to an absolute value | · |Pj on K Pj.
Meanwhile, with the index j speciﬁed, Proposition 6.34 gives us a unique
absolute value | · |Pj on K such that the inclusionϕ0 : F →K is a homomorphism
of valued ﬁelds. The completion mapping ψj : K →K Pj in turn gives us a
second determination of | · |Pj on K Pj, and Lemma 6.35 below says that these
two determinations match, i.e., that Figure 6.2 is a commutative diagram of
homomorphisms of valued ﬁelds.
(F, | · |p)
ψ0
−−−→
(Fp, | · |p)
ϕ0
⏐⏐+
⏐⏐+ϕj
(K, | · |Pj)
ψj
−−−→(K Pj, | · |Pj)
FIGURE 6.2. Commutativity of completion and extension
as homomorphisms of valued ﬁelds.

6. Ramification Indices and Residue Class Degrees
361
Lemma 6.35. In the above notation the two determinations of | · |Pj on K Pj
coincide—one by using Theorem 6.33 to insist that ϕjψ0 in Figure 6.2 be the
composition of homomorphisms of valued ﬁelds, and the other by using Proposi-
tion 6.34 to insist that ψjϕ0 in Figure 6.2 be the composition of homomorphisms
of valued ﬁelds.
REMARKS. The commutativity formula ψjϕ0 = ϕjψ0 for ﬁeld mappings is
known from the discussion concerning Figure 6.1.
PROOF. Let us give two different names to the two possible absolute values on
K Pj, writing | · |′ for the one that makes |ψj(k)|′ = |k|Pj for k ∈K and writing
| · |′′ for the other, which makes |ϕj(x)|′′ = |x|p for x ∈Fp. Let y be in F. Then
the equality ϕjψ0 = ψjϕ0 implies that
|ϕjψ0(y)|′ = |ψjϕ0(y)|′ = |ϕ0(y)|Pj = |y|p = |ψ0(y)|p.
(∗)
If x0 is given in Fp, then we can choose a sequence {xn} in F with {ψ0(xn)}
convergent to x0 in Fp.
Then {ψ0(xn)} is Cauchy in the metric on Fp, and
it follows from (∗) applied with y = xn −xn′ that {ϕjψ0(xn)} is Cauchy in
the metric from | · |′ on K Pj. If we have a second such sequence {x′
n} in F
with ψ0(x′
n) convergent to x0 and if we alternate the terms of {xn} and {x′
n} to
produce a sequence {zn}, then {ϕjψ0(zn)} remains Cauchy in the metric from | · |′.
Since | · |′ is complete, it follows that |ϕj(x0)|′ is given by a well-deﬁned limit
independently of the sequence in ψ0(F) used to approximate x0. The formula
(∗) shows that |ϕj(x0)|′ = |x0|p, and the deﬁnition of | · |′′ shows that this equals
|ϕj(x0)|′′. By the uniqueness in Theorem 6.33, | · |′ = | · |′′ on K Pj.
□
Lemma 6.36. In the above notation and that of Theorem 6.31, the ramiﬁcation
index e∗
j corresponding to K Pj/Fp for the closure of the ideal ψj(Pj) coincides
with the ramiﬁcation index ej corresponding to K/F for the ideal Pj.
REMARK. In addition, the residue class degree f ∗
j for K Pj/Fp coincides with
the residue class degree fj for K/F. In fact, the ﬁve paragraphs of review that
follow Theorem 6.26 mention that residue class ﬁelds change neither during the
localization step nor in the completion step of our two-step process. Thus R/p
remains the same during the two steps, and so does T/Pj. Hence the dimension
of T/Pj as a vector space over R/p remains the same.
PROOF. Let vp,F, vPj,K, vp,Fp, and vPj,K Pj be the valuations corresponding to
the absolute values on F, K, Fp, and K Pj, respectively. The last of these is well
deﬁned by Lemma 6.35. Proposition 6.34 shows that
ejvp,F = vPj,Kϕ0
and
e∗
j vp,Fp = vPj,K Pj ϕj.
(∗)

362
VI. Reinterpretation with Adeles and Ideles
Meanwhile, the completion mappings ψ0 and ψj satisfy
vp,Fpψ0 = vp,F
and
vPj,K Pj ψj = vPj,K.
(∗∗)
Multiplying the second equation of (∗) on the right by ψ0 and substituting from
the ﬁrst equation of (∗∗), we obtain
e∗
j vp,F = e∗
j vp,Fpψ0 = vPj,K Pj ϕjψ0.
We substitute from the commutativity formula ϕjψ0 = ψjϕ0 and unwind the right
side as
vPj,K Pj ψjϕ0 = vPj,Kϕ0 = ejvp,F.
Thus e∗
j vp,F = ejvp,F. Since vp,F is not identically 0, we obtain e∗
j = ej.
□
PROOF OF THEOREM 6.31. As was mentioned before the statement of the
theorem, itfollowsfromProposition2.29andtheWedderburntheorythat K⊗F Fp
is isomorphic to a product g′
i=1 Li of ﬁelds, each of which is a ﬁnite extension
of Fp and each of which has K embedded in it. The subﬁelds Li are uniquely
determined within K ⊗F Fp, and we let ηi be the projection of K ⊗F Fp onto
Li. Each ηi is a ring homomorphism and is given by multiplication by a speciﬁc
element of K ⊗F Fp, namely the element that is 1 in the ith position and is 0 in
the other positions. When restricted to K ⊗1, ηi gives a ﬁeld map αi : K →Li;
when restricted to 1 ⊗Fp, it gives a ﬁeld map βi : Fp →Li.
We shall develop a small abstract theory about these ﬁeld maps αi and βi.
Suppose that M is a ﬁeld containing F, that α : K →M and β : Fp →M are
F algebra homomorphisms, and that M is a ﬁnite separable extension of β(Fp).
Theorem 6.33 says that M has a unique absolute value | · |p,β extending | · |p
and that the valued ﬁeld (M, | · |p,β) is complete. The extension property means
that β : (Fp, | · |p) →(M, | · |p,β) is a homomorphism of valued ﬁelds. The
restriction α∗(| · |p,β) to K makes (K, α∗(| · |p,β)) into a valued ﬁeld in such a
way that
α : (K, α∗(| · |p,β)) →(M, | · |p,β)
(∗)
is a homomorphism of valued ﬁelds. Let us see that
α∗(| · |p,β) is one (and only one) of the absolute values | · |Pj on K
(∗∗)
and that α in (∗) factors as the composition of the completion mapping
ψj : (K, | · |Pj) →(K Pj, | · |Pj)

6. Ramification Indices and Residue Class Degrees
363
followed by some other homomorphism of valued ﬁelds
ι : (K Pj, | · |Pj) →(M, | · |p,β).
To get at (∗∗) and the factorization of α, let us show that the ﬁeld mapping
ϕ0 : (F, | · |p) →(K, α∗(| · |p,β))
(†)
is a homomorphism of valued ﬁelds, i.e., that ϕ∗
0α∗(| · |p,β) = | · |p. The ﬁeld
mappings αϕ0 and βψ0, which carry F into M via K and Fp, respectively, are
compositions of F homomorphisms and hence are F homomorphisms. Therefore
x ∈F implies that αϕ0(x) = x(αϕ0(1)) = x(1) = x(βψ0(1)) = βψ0(x), and
we see that αϕ0 = βψ0 on F. For x ∈F, this identity accounts for the third
equality in the following computation proving (†):
|x|p = |ψ0x|p = |βψ0x|p,β
= |αϕ0x|p,β = α∗(| · |p,β)(ϕ0x) = ϕ∗
0α∗(| · |p,β)(x).
Returning to (∗∗) and applying (†), we see that α∗(| · |p,β) is ≤1 on R. Since
T is the integral closure of R, Proposition 6.20 shows that α∗(| · |p,β) is ≤1
on T and that it arises from some nonzero prime ideal of T , necessarily one of
the ideals P1, . . . , Pg. This proves (∗∗). Then the factorization (∗) follows from
(∗∗) and the universal mapping property of completions as given in Theorem
6.25, since (M, | · |p,β) is complete.
Now let us specialize by taking M = Li with i ﬁxed.
As in the ﬁrst
paragraph of the proof, the projection ηi : K ⊗F Fp →Li gives us ﬁeld mappings
αi : K →Li and βi : Fp →Li by composing ηi with K →K ⊗1 and
with Fp →1 ⊗Fp. If u1, . . . , un is a vector-space basis of K over F, then
u1 ⊗1, . . . , un ⊗1 is a vector-space basis of K ⊗F Fp over Fp, and it follows
that Li is ﬁnite-dimensional over Fp. Let us check that Li is separable over Fp.
We are given that K is separable over F, hence that K = F(ξ) for an element
ξ whose minimal polynomial g(X) over F is separable. Then ξ ⊗1 is a root of
g(X) regarded as in Fp[X], and so is ηi(ξ ⊗1). Therefore Li/Fp is separable,
and the above theory is applicable. In the theory, Li acquires an absolute value
| · |p,βi such that βi : (Fp, | · |p) →(Li, | · |p,βi) is a homomorphism of valued
ﬁelds, and then (Li, | · |p,βi) is complete. The theory produces a unique index
j = j(i) making αi : (K, | · |Pj) →(Li, | · |p,βi) into a homomorphism of
valued ﬁelds.
Let us see that αi(K) is dense in Li. Every member of Li is the image under ηi
of some member 	n
l=1 ul ⊗cl of K ⊗F Fp with each cl in Fp. The computation
ηi(ul ⊗cl) = ηi(ul ⊗1)ηi(1 ⊗cl) = αi(ul)βi(cl)

364
VI. Reinterpretation with Adeles and Ideles
shows that every member of Li is of the form 	n
l=1 αi(ul)βi(cl). Since F is dense
in Fp, we can choose members c′
l of F as close as we please to cl. Since βi is
isometric, 	n
l=1 αi(ul)βi(cl) is then close to 	n
l=1 αi(ul)βi(c′
l) = 	n
l=1 αi(c′
lul).
Consequently αi(K) is indeed dense in Li.
Recall in connection with (∗) that αi : K →Li factors as a composition of
homomorphisms of valued ﬁelds, namely as ψj : (K, | · |Pj) →(K Pj, | · |Pj)
followed by ι : (K Pj, | · |Pj) →(Li, | · |p,βi). Since K Pj is complete, ι(K Pj)
is closed in Li. The dense image αi(K) = ι(ψj(K)) in Li is contained in the
closed subset ι(K Pj), and it follows that ι is onto Li. That is, the homomorphism
of valued ﬁelds
ι : (K Pj, | · |Pj) →(Li, | · |p,βi)
is an isomorphism. This identiﬁes the valued ﬁeld (Li, | · |p,βi) as isomorphic to
(K Pj, | · |Pj).
As a consequence of the argument thus far, we have constructed a choice-free
function i 	→j(i) carrying {1, . . . , g′} into {1, . . . , g}. The function has the
property that K Pj(i) is isomorphic as a valued ﬁeld to Li for each i. We are going
to show that i 	→j(i) is onto {1, . . . , g}. Thus let the completion homomorphism
ψj : (K, | · |Pj) →(K Pj, | · |Pj) be given.
The F bilinear mapping (ψj, ϕj) : K × Fp →K Pj given by multiplication
has a linear extension
ψj ⊗ϕj : K ⊗F Fp →K Pj
that is a ring homomorphism. The range K Pj is a ﬁeld that is ﬁnite-dimensional
over ϕj(Fp), and the image of ψj ⊗ϕj is a ϕj(Fp) vector subspace of K Pj that is
closed under multiplication. Consequently the image of ψj ⊗ϕj is closed under
inverses18 and is a ﬁeld. The kernel of ψj ⊗ϕj is therefore a maximal ideal, and
it follows that there exists some i such that ψj ⊗ϕj factors as a composition of
ηi : K ⊗F Fp →Li followed by a ﬁeld map γ : Li →K Pj.
Having constructed a particular Li, let us form αi, βi, and Pj(i) as in the abstract
theory with M. The map βi : (Fp, | · |p) →(Li, | · |p,βi) is a homomorphism of
valued ﬁelds such that γβi = ϕj, and the map αi : (K, |, · |Pj(i)) →(Li, | · |p,βi)
is a homomorphism of valued ﬁelds such that γ αi = ψj. The existence part of
Theorem 6.33 shows that there exists an absolute value | · |γ on K Pj such that
γ : (Li, | · |p,βi) →(K Pj, | · |γ ) is a homomorphism of valued ﬁelds. Since
ϕ∗
j (| · |Pj)) = | · |p = β∗
i (| · |p,βi) = β∗
i γ ∗(| · |γ ) = ϕ∗
j (| · |γ )), the uniqueness
18The same argument applies here with Fp as was used in Section 4 with R: within a ﬁeld if a
nonzero element is algebraic over a base ﬁeld, then the smallest ring containing the base ﬁeld and
the element contains also the inverse of the element.

6. Ramification Indices and Residue Class Degrees
365
part of Theorem 6.33 shows that | · |γ = | · |Pj on K Pj. Meanwhile, the equality
ψj = γ αi implies that ψ∗
j = α∗
i γ ∗. Then we have

| · |Pj on K

= ψ∗
j

| · |Pj on K Pj

= α∗
i γ ∗
| · |Pj on K Pj

since ψ∗
j = α∗
i γ ∗
= α∗
i γ ∗
| · |γ on K Pj

since | · |γ = | · |Pj
= α∗
i

| · |p,βi on Li

=

|, · |Pj(i)) on K

.
Therefore j = j(i), and the map i 	→j(i) is onto.
To complete the proof, let us compute dimensions relative to Fp, starting
from the decomposition into ﬁelds Li. The ramiﬁcation index e∗
j and the residue
class degree f ∗
j for the valuation ring and ideal of K Pj equal the corresponding
parameters ej and fj for T and Pj, by Lemma 6.36. Thus we have
n =
g′	
i=1
dimFp Li =
g′	
i=1
dimFp K Pj(i) =
g	
j=1
	
j(i)= j
dimFp K Pj(i)
=
g	
j=1
	
j(i)= j
e∗
j(i) f ∗
j(i) =
g	
j=1
	
j(i)= j
ej(i) fj(i) =
g	
j=1
|{i | j(i)= j}| ej fj.
On the other hand, we know that n = 	
j ej fj, and we have just proved that
|{i | j(i) = j}| ≥1 for each j. It follows that |{i | j(i) = j}| = 1 for each
j, i.e., that the function i 	→j(i) is one-one onto. In particular, g′ = g. The
theorem follows.
□
Notationally what is happening in the proof of the theorem is that a function
i 	→j(i) is constructed such that αi : K →Li factors as αi = ιψj(i) for some
canonical isomorphism ι : K Pj(i) →Li of complete valued ﬁelds. Renumbering
the factors and ignoring canonical isomorphisms, we ﬁnd that K ⊗F Fp is the
direct product of the factors K Pi and that αi = ψi carries K to K ⊗1 and then
to the ith factor K Pi. Any linear mapping of the form A ⊗1 in effect is therefore
block diagonal with each block corresponding to the effect on some K Pi.
Let us apply these considerations to operations “left-multiplication-by,” which
we write as l( · ). If ξ is a member of K, the characteristic polynomial of l(ξ)
over F is det(X1 −l(ξ)), and the characteristic polynomial of l(ξ) ⊗1 over Fp
is still det(X1 −l(ξ)), but now with its coefﬁcients from F regarded as members
of Fp via the inclusion ψ0 : F →Fp.
The linear function X(1 ⊗1) −l(ξ) ⊗1 is block diagonal, equal to
X1 −l(ψi(ξ)) on the ith block for 1 ≤i ≤g. The characteristic polynomial

366
VI. Reinterpretation with Adeles and Ideles
det(X1 −l(ξ)), regarded as having coefﬁcients in Fp, is therefore the product
of the g characteristic polynomials X1 −l(ψi(ξ)), each with coefﬁcients in Fp.
In turn, this product formula yields a sum formula for the trace TrK/F(ξ) and
a product formula for the norm NK/F(ξ). If ξ is a primitive element for the
extension K/F, then we can say even more. Let us write all these consequences
as a corollary.
Corollary 6.37. Let R be a Dedekind domain regarded as a subring of its ﬁeld
of fractions F, let K be a ﬁnite separable extension of F with [K : F] = n, and
let T be the integral closure of R in K. Let p be a nonzero prime ideal of R, and
let the ideal pT in T have a prime factorization of the form pT = Pe1
1 · · · P
eg
g ,
where P1, . . . , Pg are distinct prime ideals in T and e1, . . . , eg are positive. For
1 ≤i ≤g, let fi = [T/Pi : R/p]. If ξ is any element of K, then
(a) the F linear map l(ξ) on K given by left multiplication by ξ has the
property that its ﬁeld polynomial det(X−l(ξ)) over F, when reinterpreted
as having coefﬁcients in Fp, factors over Fp as the product
det(X −l(ξ)) =
g

i=1
det(X −l(ξi))
of the g ﬁeld polynomials of the images ξi = ψi(ξ) under the completion
map ψi : K →K Pi,
(b) NK/F(ξ) = g
i=1 NK Pi /Fp(ξi),
(c) TrK/F(ξ) = 	g
i=1 TrK Pi /Fp(ξi).
Furthermore, if ξ and F together generate K, if m(X) is the minimal polynomial
of ξ over F, and if m(X) = g′
j=1 mj(X) expresses m(X) as the product of
distinct monic irreducible polynomials in Fp[X], then
(d) g′ = g ,
(e) there is a one-one onto function i 	→k(i) on the set {1, . . . , g} such that
K Pi is isomorphic as a ﬁeld to Fp[X]/(mk(i)(X)),
(f) deg mk(i)(X) = ei fi.
PROOF. Conclusion (a) was proved in the paragraph before the statement of
the corollary, and (b) and (c) follow immediately from (a).
Under the assumption that K = F(ξ), the minimal polynomial m(X) of
ξ and the characteristic polynomial det(X1 −l(ξ)) are equal; thus m(X) =
det(X −l(ξ)) is irreducible over F. Applying Proposition 2.29a, we see that
K ⊗F Fp ∼= Fp[X]/(m(X)) as an Fp algebra. The assumed separability of K/F
means that m(X) is a separable polynomial, and m(X) therefore factors over the
extension ﬁeld Fp of F as a product of distinct monic irreducible polynomials

6. Ramification Indices and Residue Class Degrees
367
in Fp[X], say as m(X) = m1(X) · · · mg′(X). The Chinese Remainder Theorem
implies that
K ⊗F Fp ∼=
g′

i=1
Fp[X]/(mi(X)),
and each Fp[X]/(mi(X)) is a ﬁeld. The factors on the right must coincide with
the factors in Theorem 6.31, and it follows that g′ = g and that each K Pi is of
the form Fp[X]/(mk(X)) for some k = k(i). This proves (d) and (e). For (f),
deg mk(i)(X) is the product of the ramiﬁcation index and the residue class degree
for K Pi/Fp, and this product equals ei fi as a consequence of Lemma 6.36 and
its remark.
□
A by-product of (d) is that we obtain a way of computing g for the extension:
it is the number of irreducible factors into which m(X) splits when it is factored
over Fp instead of F. Hensel’s Lemma in the form of Theorem 6.30 can help
with carrying out this factorization in favorable cases if ξ is chosen to be integral
over R, i.e., to be in T . Namely we reduce the coefﬁcients of m(X) modulo
p, obtaining a monic polynomial in (R/p)[X], and we factor this polynomial19
as a product of powers of distinct primes in (R/p)[X]. Since the powers of
distinct primes are relatively prime and since everything is monic, Theorem 6.30
is applicable and allows us to lift the factorization to Fp[X]. The resulting monic
factors in Fp[X] may not be irreducible in unfavorable circumstances,20 but we
have at least made progress.
Theorem 6.31 has accomplished even more than is stated in Corollary 6.37.
For each i, it has identiﬁed a ﬁeld extension, namely K Pi/Fp, in which the indices
ei and fi are isolated from the other ej’s and fj’s. Under an additional hypothesis
on the residue class ﬁeld (it is enough to assume that the residue class ﬁeld is
ﬁnite), Proposition 6.38 below shows that it is possible to interpolate a unique
intermediate ﬁeld L with Fp ⊆L ⊆K Pi such that the residue class degree (the
parameter f ) of K Pi/L is 1 and the ramiﬁcation index (the parameter e) of K/Fp
is 1. Thus the proposition says that we can separate ei and fi from each other.
One says that K Pi/L is totally ramiﬁed and L/Fp is unramiﬁed.
Proposition 6.38. Let F be a complete valued ﬁeld under a nonarchimedean
discrete valuation v, let R and p be the valuation ring and valuation ideal for v, let
K be a ﬁnite separable extension of F of degree n, let T be the integral closure of
R in K, and let P be the unique maximal ideal in T as in Theorem 6.33. Suppose
19On a computer, for example, if R/p is ﬁnite.
20InExample5intheprevioussection, thegivenpolynomialinZ[X]ism(X) = X3+X2−2X+8,
and the reduced polynomial in F2[X] is X2(X + 1). Theorem 6.30 exhibits a factorization of m(X)
over Z2[X] as the product of a linear factor and a quadratic factor, and we saw in Example 5 of
Section 5 that the quadratic factor is reducible over Z2[X].

368
VI. Reinterpretation with Adeles and Ideles
that R/p is a ﬁnite ﬁeld. Let e be the integer such that pT = Pe, and let f be
the dimension of T/P over R/p. Then there exists a unique intermediate ﬁeld L
for which the integral closure U of R in L and the unique maximal ideal ℘in U
have the following properties:
(a) pU = ℘and ℘T = Pe,
(b) [U/℘: R/p] = f and [T/P : U/℘] = 1.
The proof is carried out in Problems 15–16 at the end of the chapter. We shall
apply Proposition 6.38 in Section 8. The intermediate ﬁeld L in the proposition
is called the inertia subﬁeld of K/F.
Once this separation of an extension of a complete valued ﬁeld into a totally
ramiﬁed extension and an unramiﬁed extension has been accomplished, one can
go on to study each kind of extension separately, in order to ﬁnd out what kind
of ramiﬁcation is possible. The results are stated as Lemmas 6.47 and 6.48, and
proofs are carried out in Problems 17–19 at the end of the chapter.
7. Special Features of Galois Extensions
In this section we analyze what happens in the setting of Theorem 6.31 when
the extension of ﬁelds is a Galois extension. For simplicity for the moment, let
us work with the number-ﬁeld setting, even though analogous results hold for
function ﬁelds in one variable as well. Thus let K/F be a ﬁnite Galois extension
of number ﬁelds, let T and R be the rings of algebraic integers in K and F
respectively, and let p be a nonzero prime ideal in R. Since the extension K/F
is Galois, the Galois group Gal(K/F) permutes transitively the nonzero prime
ideals containing pT , and the factorization of pT into powers of distinct prime
ideals of T takes the special form pT = Pe
1 · · · Pe
g with all the exponents the
same.21
In addition, the dimension of each ﬁnite ﬁeld T/Pi over R/p is an
integer f independent of i, and we have ef g = [K : F].
Let us review Theorem 9.64 and its surrounding discussion in Basic Alge-
bra. If we write P for one of the ideals Pi, then the subgroup G P of G =
Gal(K/F) is called the decomposition group at P. Each σ ∈G P descends
to an automorphism σ of T/P that ﬁxes R/p, thereby yielding a member of
G = Gal((T/P)/(R/p)). The map G →G is certainly a homomorphism,
and Theorem 9.64 of Basic Algebra says that it is onto. It follows that this
homomorphism is e-to-1. In Basic Algebra this homomorphism was of interest
when F = Q and e = 1, since it ensures the presence of certain kinds of
permutations in G and makes it possible to determine G completely in certain
circumstances.
21Lemma 9.61 and Theorem 9.62 of Basic Algebra.

7. Special Features of Galois Extensions
369
Theorem 6.31 allows us to isolate each prime ideal P in such an analysis,
reinterpreting everything in the context of a particular p-adic ﬁeld. Carrying
through this process gives insights into the decomposition group and the nature
of the homomorphism G P →G. The point of this section is to explain some of
these insights.
We work within the setting of Theorem 6.31 except that we assume that the
residue class ﬁelds are ﬁnite ﬁelds, as they are in the number-theory context. Thus
let R be a Dedekind domain regarded as a subring of its ﬁeld of fractions F, let
K be a ﬁnite Galois extension of F with [K : F] = n, and let T be the integral
closure of R in K. We suppose that p is a nonzero prime ideal of R and that R/p
is a ﬁnite ﬁeld. Let pT = Pe
1 · · · Pe
g be the prime factorization of the ideal pT
in T ; here P1, . . . , Pg are assumed to be distinct prime ideals in T . Let f be the
common value of the dimension of T/Pi over R/P.
In the decomposition K ⊗F Fp ∼= g
i=1 K Pi of Theorem 6.31, the projection
ηi to the ith factor on the right side is a member of K ⊗F Fp; speciﬁcally it is the
member of the direct product whose ith coordinate is the multiplicative identity
of K Pi and whose other coordinates are 0. The element ηi is an idempotent in
the sense that η2
i = ηi, and the ηi’s are orthogonal in the sense that ηiηj = 0 for
i ̸= j. The only idempotents of K ⊗F Fp are the sums of distinct elements ηi,
and the ηi’s are distinguished from the other idempotents in being primitive: ηi
is not the sum of two nonzero orthogonal idempotents.
Recall the relationship derived in the proof of Theorem 6.31 between Pi and
the element ηi: the mapping βi : Fp →K Pi given by βi(x) = (1 ⊗x)ηi for
x ∈Fp is a homomorphism of valued ﬁelds, and so is the mapping αi : K →K Pi
given by αi(k) = (k ⊗1)ηi for k ∈K. These facts uniquely determine Pi from
among the ideals P1, . . . , Pg.
We extend the action by each member σ of G = Gal(K/F) to K ⊗F Fp as the
transformation σ ⊗1. Then G acts on K ⊗F Fp, manifestly keeping each element
of Fp ﬁxed. Since the members of G respect multiplication and addition, they
map idempotents to idempotents in K ⊗F Fp, sending primitive idempotents to
primitive idempotents. Thus G permutes the elements ηi. The elements x with
ηix = x are exactly the members of K Pi, and hence G permutes the ﬁelds K Pi.
Lemma 6.39. In the above setting with K/F Galois, let Pi be one of the ideals
P1, . . . , Pg. Then a member σ of the Galois group G = Gal(K/F) extends to a
ﬁeld automorphism of K Pi ﬁxing Fp if and only if it is an isometry of (K, | · |Pi),
i.e., if and only if σ satisﬁes |σ x|Pi = |x|Pi for all x ∈K.
PROOF. If σ is an isometry from K into itself in the metric determined by | · |Pi,
then σ is uniformly continuous as a function from K into the complete space K Pi
and therefore extends to a continuous function from the completion K Pi into K Pi.

370
VI. Reinterpretation with Adeles and Ideles
It follows from the continuity of the extension and the fact that σ respects the
operations on K that σ respects the operations on K Pi. These remarks apply also
to the extension of σ −1, and the extension of σ −1 is a two-sided inverse to the
extension of σ. Since σ is the identity on F, the continuity forces the extension
of σ to be the identity on Fp.
Conversely suppose that σ extends to an automorphism of K Pi ﬁxing Fp. Let
us use the name σ also for the extension. On K Pi, the functions x 	→|x|Pi and
x 	→|σ(x)|Pi are absolute values that extend | · |p on Fp. Theorem 6.33 shows
that they must be equal, and therefore σ is an isometry.
□
Proposition 6.40. In the above setting with K/F Galois, let P be one of
the ideals P1, . . . , Pg, let G = Gal(K/F) be the Galois group, and let G P
be the decomposition group at P. Then K P is a Galois extension of Fp, the
members of G P extend to be isometries of K P that ﬁx Fp, and the resulting map
ϕ : G P →Gal(K P/Fp) exhibits G P as isomorphic to Gal(K P/Fp).
PROOF. Since K P is generated by Fp and K, it is obtained by adjoining to
Fp the same roots of the same polynomials over F that are used to generate K.
Therefore K P/Fp is a Galois extension.
Lemma 6.39 gives us the map of G P into Gal(K P/Fp). The map ϕ is a
homomorphism because the extension of each member of G P is unique. It is
one-one because the inclusion K ⊆K P is one-one.
To see that it is onto, let σ be in Gal(K P/Fp), and choose an element ξ ∈K
such that K = F(ξ). If m(X) is the minimal polynomial of ξ over F, then σ(ξ)
is an element of K P with m(σ(ξ)) = 0. Consequently σ(ξ) is a root of m(X).
Since K/F is Galois and m(X) has one root in K, all its roots are in K. Thus
σ(ξ) is in K. The most general member of K is of the form q(ξ), where q(X)
is a polynomial of degree less than deg m(X), and q(σ(ξ)) has to be in K also.
Thus σ is an automorphism of K ﬁxing F. As such, σ must send T into itself
and must send P into some ideal Pi of T containing pT . Meanwhile, Lemma
6.39 shows that σ is an isometry of K relative to | · |P. Thus σ must send P into
itself. In other words, the restriction of σ to K is in the decomposition group G P.
□
We know from Theorem 9.64 of Basic Algebra that every member σ of the
decomposition group G P yields a member σ of Gal((T/P)/(R/p)) and that
the resulting map σ 	→σ is a homomorphism onto. Proposition 6.40 allows
us to reinterpret this homomorphism as carrying the Galois group of K P onto
the Galois group of T/P. The order of Gal(K P/Fp) is ef , and the order of
Gal((T/P)/(R/p)) is f .
Thus the kernel of this homomorphism, which is
called the inertia group of K P/Fp, has order e. By Galois theory the ﬁxed
ﬁeld L of the inertia group has [K P : L] = e, L/Fp is a Galois extension,

8. Different and Discriminant
371
and Gal(L/Fp) has order f .
This construction has been arranged to make
Gal(L/Fp) ∼= Gal((T/P)/(R/Fp)). As the Galois group of a ﬁnite extension
of ﬁnite ﬁelds, the Galois group on the right is cyclic of order f . Therefore
Gal(L/Fp) is cyclic of order f .
Referring back to the statement of Proposition 6.38, we might guess that the
ﬁxed ﬁeld L of the inertia group is the unique intermediate ﬁeld such that K/L
is totally ramiﬁed and L/F is unramiﬁed. This guess is completely correct, but
we omit the proof.
8. Different and Discriminant
Theorem 6.31 is the key to a “local/global” approach to handling certain kinds
of problems in algebraic number theory and in its analog in algebraic geometry.
To illustrate the approach and its power, we shall give in this section and in the
problems at the end of the chapter a full proof for the Dedekind Discriminant
Theorem (Theorem 5.5), which was left only partially proved in Chapter V.
That theorem as stated in Chapter V says that the prime numbers p for which
ramiﬁcation occurs in passing from Q to a number ﬁeld K are exactly the primes
dividing the ﬁeld discriminant. The result we obtain now22 will in fact generalize
Theorem 5.5 signiﬁcantly. In giving the details, we leave the proofs of Proposition
6.38 and Lemmas 6.47 and 6.48 to Problems 15–19 at the end of the chapter.
In the approach used in Chapter V, we were unable to handle primes that are
“common index divisors” in the sense of Section V.2. Section V.4 exhibited
an example of a common index divisor. The difﬁculty with the approach in
Chapter V is that localization by itself does not ostensibly separate the primes
from one another sufﬁciently for us fully to handle them one at a time. The
completion step is a tool powerful enough to complete the separation.
For part of this section, we shall work in the setting of Theorem 6.31, in
which we compare two Dedekind domains whose ﬁelds of fractions are related
by a separable ﬁeld extension. The situation of eventual interest is that the two
Dedekind domains are the rings of algebraic integers within two number ﬁelds,
but we shall encounter also p-adic versions of this situation. Thus let R be a
Dedekind domain regarded as a subring of its ﬁeld of fractions F, let K be a ﬁnite
separable extension of F with [K : F] = n, and let T be the integral closure
of R in K. In this setting we shall introduce an ideal D(K/F) of T known as
the “relative different” of the two ﬁelds, and we shall establish conditions under
which the relative different captures fairly precisely what ramiﬁcation occurs in
passing from R to T . This is the generalized version of the Dedekind Discriminant
Theorem and appears as Theorem 6.45 below.
22Dedekind’s Theorem on Differents, given as Theorem 6.45.

372
VI. Reinterpretation with Adeles and Ideles
In the special case that F = Q, we shall see that the ﬁeld discriminant DK
satisﬁes |DK| = N(D(K/Q)). In words, the ﬁeld discriminant is the absolute
norm of the relative different D(K/Q) except possibly for a sign. Using the
properties of N( · ) listed in Proposition 5.4, we can read off the version of
the Dedekind Discriminant Theorem stated in Theorem 5.5 from the results we
establish about the relative different.
We work with fractional ideals in F and in K. If M is any nonzero fractional
ideal of K, we deﬁne its (relative) dual as
 
M = {x ∈K | TrK/F(xy) is in R for all y ∈M}.
Lemma 6.41. In the above setting, if M is a nonzero fractional ideal of K,
then so is its dual  
M.
PROOF. Since T has K as its ﬁeld of fractions, there exists an F vector space
basis {t1, . . . , tn} of K consisting of members of T . If m0 is a nonzero member
of M and mj = tjm0, then {m1, . . . , mn} is an F vector space basis of K lying in
M. Form the R submodule M1 = 	n
j=1 Rmj of M, and let {x1, . . . , xn} be the
F vector space basis of K such that TrK/F(xjmj) = δi j. Let
 
M1 = {x ∈K | TrK/F(xm) is in R for all m ∈M1}.
If we expand a general element x of K as x = 	n
j=1 cixi, then a necessary
condition for x to be in  
M1 is that cj = TrK/F(xmj) be in R for all j. On the
other hand, this condition is also sufﬁcient because an element x with all cj ∈R
has TrK/F(xm) = 	n
j=1 cjrj if m = 	n
j=1 rjmj. Thus  
M1 is a ﬁnitely generated
R module with x1, . . . , xn as generators. Let S be the T submodule of K given by
S = 	n
j=1 T xj. This is a ﬁnitely generated T submodule of K that contains  
M1.
The inclusion M ⊇M1 evidently implies that  
M ⊆ 
M1, and hence  
M ⊆S. In
this way,  
M is exhibited as a T submodule of the ﬁnitely generated T submodule
S of K, and  
M must itself be ﬁnitely generated because T is a Noetherian ring.
□
Proposition 6.42. In the above setting, the dual  T of T is of the form  T =
D(K/F)−1 for an ideal D(K/F) of T . This ideal D(K/F) has the property that
 
M = M−1D(K/F)−1
for every nonzero fractional ideal M of K.
REMARK. The ideal D(K/F) in T is called the relative different of K with
respect to F.

8. Different and Discriminant
373
PROOF. From the deﬁnition,  T consists of all x in K for which TrK/F(xt) is
in R; any member x of T has this property, and thus T ⊆ T . Lemma 6.41 shows
that  T is a fractional ideal of K. Since  T contains T , it is the inverse of an ideal
of T . This ideal we deﬁne as D(K/F).
Let M be an arbitrary nonzero fractional ideal of K. Since M−1M = T , we
have TrK/F(M−1D(K/F)−1 · M) = TrK/F(D(K/F)−1) = TrK/F( T T ) ⊆R,
and it follows that M−1D(K/F)−1 ⊆ 
M. For the reverse inclusion, let x be in
 
M. Then TrK/F(x M · t) ⊆TrK/F(x M) ⊆R for all t ∈T , and hence x M ⊆
 T = D(K/F)−1. This being true for all x ∈ 
M, we obtain  
M M ⊆D(K/F)−1.
Therefore  
M ⊆M−1D(K/F)−1.
□
Proposition 6.43. In the above setting, if L is a ﬁeld with F ⊆L ⊆K, then
D(K/F) = D(K/L)D(L/F)
as an equality of fractional ideals in K.
REMARKS. Let U be the integral closure of R in L. In the displayed line of the
proposition, D(L/F) is an ideal in U, and the right side amounts to the product
in T given by D(K/L) · D(L/F)T .
PROOF.
We use the fact that traces can be computed in stages.
An ele-
ment x of K is in D(K/F)−1 if and only if TrK/F(xT ) ⊆R, if and only if
TrL/F

TrK/L(xT )

⊆R, if and only if TrK/L(xT ) ⊆ 
U = D(L/F)−1, if and
only if TrK/L(xT D(L/F)) ⊆U, if and only if xT D(L/F) ⊆D(K/L)−1. Thus
D(K/F)−1D(L/F) = D(K/L)−1, and the result follows.
□
The main result of this section, from which the Dedekind Discriminant The-
orem will be derived as Corollary 6.49, is Theorem 6.45 below, Dedekind’s
Theorem on Differents. The proof requires some preparation. Two results will be
used to reduce Theorem 6.45 to a statement about complete ﬁelds, for which only a
single prime ideal is involved, both for R and for T . The ﬁrst of these is Theorem
6.31, or more particularly its consequence for traces given in Corollary 6.37c.
The other is the following strengthening of the Weak Approximation Theorem in
the presence of additional hypotheses. The reduction step to a statement about
complete ﬁelds then appears as Corollary 6.46.
Theorem 6.44 (Strong Approximation Theorem). Let F be a number ﬁeld,
let R be its ring of algebraic integers, let P1, . . . , Pr be distinct nonzero prime
ideals in R, and let vPj for each j be the valuation of F and of its completion that
corresponds to Pj. If l1, . . . ,lr are integers and if xj for 1 ≤j ≤r is a member
of the completed ﬁeld FPj, then there exists y in F such that
vPj(y −xj) ≥lj
for 1 ≤j ≤r
and such that vQ(y) ≥0 for all other nonzero prime ideals Q of R.

374
VI. Reinterpretation with Adeles and Ideles
REMARKS.
(1) It will be helpful to have a name for the property in the conclusion of
Theorem 6.44. Thus let T be a Dedekind domain regarded as a subring of its
ﬁeld of fractions K. We say that T has the strong approximation property if
whenever distinct nonzero prime ideals P1, . . . , Pr of T are given, along with
integers l1, . . . ,lr and members xj of the completed ﬁeld K Pj for 1 ≤j ≤r,
then there exists y in K such that vPj(y −xj) ≥lj for 1 ≤j ≤r and such that
vQ(y) ≥0 for all other nonzero prime ideals Q of T . The content of Theorem
6.44 is that the ring of algebraic integers in any number ﬁeld has the strong
approximation property.
(2) More generally any principal ideal domain has the strong approximation
property. In fact, if R is a principal ideal domain with ﬁeld of fractions F, if K
is a ﬁnite extension of F, and if T is the integral closure of R in K, then K is
a Dedekind domain (according to the remarks with Proposition 6.7), and K has
the strong approximation property. The proof is an easy adaptation of the proof
below, with the principal ideal domain substituting for the ring Z of integers. As
a consequence if k is a ﬁeld and if T is the integral closure of k[X] in a ﬁnite
extension of k(X), then T has the strong approximation property.
(3) Any Dedekind domain with only ﬁnitely many prime ideals has the strong
approximationpropertyasanimmediateconsequenceoftheWeakApproximation
Theorem (Theorem 6.23). One does not need to make use of the fact that such a
domain is always a principal ideal domain.
(4) For a number ﬁeld the conclusion of the theorem as stated imposes a
limitation on all the nonarchimedean absolute values. The conclusion cannot be
strengthened to impose a limitation on all equivalence classes of absolute values,
since the Artin product formula (Theorem 6.51 below) imposes a constraint on
the set of all of them.
PROOF.23 We may assume that each lj satisﬁes lj ≥0. Recall that for each
prime number p, there are only ﬁnitely many prime ideals P in R with P ∩Z =
pZ. Possibly by moving some of the conditions vQ(y) ≥0 into the displayed
hypothesis concerning the Pj’s, we may assume that there is some ﬁnite set
{p1, . . . , pq} of primes such that {P1, . . . , Pr} consists exactly of all prime ideals
P such that P ∩Z = piZ for some i with 1 ≤i ≤q.
Application of the Weak Approximation Theorem (Theorem 6.23) to the ab-
solute values corresponding to P1, . . . , Pr produces an element z ∈F with
23This proof is from Hasse’s Number Theory, pp. 379–380. The argument for R = Z and all
lj = 0 is the key. After an application of the Weak Approximation Theorem, what has to be shown
is that if Pj = pjZ for 1 ≤j ≤r and if a rational ab−1 is given, then there exists a rational mn−1
with l prime to p1, . . . , pr such that the denominator of ab−1 −mn−1 is divisible only by the primes
p1, . . . , pr. Another proof of Theorem 6.44, which appears in other books, uses the theory of adeles
and ideles to be developed in the next two sections, and again the argument for Z is the key.

8. Different and Discriminant
375
vPj(z −xj) ≥lj
for 1 ≤j ≤r.
Form the fractional ideal zR in F, and let its unique factorization be zR =
Pa1
1 · · · Par
r Q1Q−1
2 , where the aj are in Z and where Q1 and Q2 are ideals of R
whose prime factorizations involve no Pj. Let us see that Q2 divides a nonzero
principal ideal (N) of R whose generator N is in Z and that N can be chosen to
be relatively prime to p1, . . . , pq. In fact, it is enough to treat each prime factor
of Q2 separately and multiply the results. For a prime factor P, we know that
P ∩Z = pZ for some prime p in Z, and we know that pR is the product of P and
another ideal of R. This prime p is nonassociate to each of p1, . . . , pq because
the only prime ideals whose intersection with Z is some piZ are P1, . . . , Pr and
because no such prime ideal divides Q2. Therefore the prime factorization of
(N) contains no factor P1, . . . , Pr.
Let b be a positive integer to be speciﬁed, and choose an integer l such that
lN ≡1 mod pb
i for 1 ≤i ≤q. If pi R factors as 
k P
mik
ik
with each Pik in
{P1, . . . , Pr}, then l has the property that lN −1 lies in
 
k P
mik
ik
b, hence in
each Pb
ik. Consequently lN −1 lies in Pb
j for 1 ≤j ≤r.
We show that if b is sufﬁciently large, then the element y = lNz is the
element we seek. First consider nonzero prime ideals Q not in {P1, . . . , Pr}. Our
factorizations of zR and (N) show that yR = lQ3Q1Pa1
1 · · · Par
r . The power of
Q on the right side is ≥0 because Q1 and Q3 are ideals of R, and thus
vQ(y) ≥0.
(∗)
Now write y −xj = (lN −1)z + (z −xj), and apply the valuation vPj. Then
we have
vPj(y −xj) ≥min

vPj((lN −1)z), vPj(z −xj)

,
and it follows from vPj(z −xj)) ≥lj that
vPj(y −xj) ≥lj
(∗∗)
if we can arrange that
vPj((lN −1)z) ≥lj.
(†)
Since lN −1 lies in Pb
j and since vPj(z) = aj, a sufﬁcient condition for (†) is that
b + aj ≥lj. As j varies, we impose only ﬁnitely many conditions on b to get (†)
to hold for all j, and then the result is that (∗∗) holds for all j. In combination
with (∗), this inequality shows that y has the required properties.
□
The preparation is all in place to prove Dedekind’s Theorem on Differents,
from which we shall easily derive the Dedekind Discriminant Theorem. The
statement is as follows.

376
VI. Reinterpretation with Adeles and Ideles
Theorem 6.45 (Dedekind’s Theorem on Differents). Let R be a Dedekind
domain regarded as a subring of its ﬁeld of fractions F, let K be a ﬁnite separable
extension of F with [K : F] = n, and let T be the integral closure of R in
K. Suppose that T has the strong approximation property. Let p > 0 be the
characteristic of the residue class ﬁeld of R/p, let p be a nonzero prime ideal
in R, let pT = Pe1
1 · · · P
eg
g be the factorization of pT as the product of positive
powers of distinct prime ideals in T , and let the relative different of K/F split as
D(K/F) = P
e′
1
1 · · · P
e′
g
g Q for an ideal Q relatively prime to all Pj. Then for each
j with 1 ≤j ≤g, e′
j is given by
e′
j =
 ej −1
if p does not divide ej,
¯ej
with ¯ej ≥ej if p divides ej.
Consequently D(K/F) has all e′
j = 0 if and only if ej = 1 for all j.
The idea is to reduce Theorem 6.45 to the case of complete ﬁelds. In the
notation in the statement of the theorem, the prime ideals P1, . . . , Pg are exactly
the prime ideals of T that divide pT , and it is customary to write Pj | p for these
prime ideals of T and only these. If M is a nonzero fractional ideal of K and if
M = Pk1
1 · · · P
kg
g Q with Q a fractional ideal whose factorization involves no Pj,
we deﬁne the pth component of M to be
Mp = Pk1
1 · · · P
kg
g .
The understanding in the special case that allkj are 0 is that Mp is taken to be T . In
all cases, M is then the product over all p of its pth component, since the complete
factorization of M has nonzero exponents for only ﬁnitely many nonzero prime
ideals of T . For the two examples that appear in the statement of Theorem 6.45,
(pT )p = 
Pj|p
P
ej
j
and
D(K/F)p = 
Pj|p
P
e′
j
j .
The reduction of Theorem 6.45 to the case of complete ﬁelds results from the fol-
lowing proposition, which combines Theorem 6.31 and the strong approximation
property (Theorem 6.44 in the case of number ﬁelds).
Proposition 6.46. Let R be a Dedekind domain regarded as a subring of its
ﬁeld of fractions F, let K be a ﬁnite separable extension of F with [K : F] = n,
and let T be the integral closure of R in K. Suppose that T has the strong
approximation property. If p is any nonzero prime ideal in R, then the different
D(K/F) has the property that
D(K/F) =

p

P|p
D(K P/Fp),

8. Different and Discriminant
377
the outer product being taken over all nonzero prime ideals p of R and the inner
product being taken over all prime ideals P of T containing pT . Here the ﬁelds
K P and Fp are the completions of K and F corresponding to P and p, respectively.
PROOF. We actually will show equality of the inverses of the two sides of the
displayed formula. By the ﬁrst conclusion of Proposition 6.42, we are to show
that a member x of K has
TrK/F(xT ) ⊆R
if and only if
TrK P/Fp((xT )i) ⊆Rp
(∗)
for all p and all P with P | p. Here ( · )i refers to the embedding K →K Pi in
Theorem 6.31 given by ξ 	→ξi = ηi(1 ⊗ξ), where ηi is the ith projection. To
prove (∗), we use the formula of Corollary 6.37c, namely
TrK/F(ξ) =
g	
i=1
TrK Pi /Fp(ξi)
for all ξ ∈K.
(∗∗)
This formula is valid for every p.
First suppose that TrK P/Fp((xT )i) ⊆Rp for all p and all P with P | p. Fix p,
and put ξ = xt with t ∈T . Summing the traces over P with P | p and applying
(∗∗), we see that the valuation with respect to p of the member TrK/F(ξ) of F
is ≥0. That is, the factor pk that appears in the factorization of the principal
fractional ideal TrK/F(ξ)R of F has k ≥0. This being true for all p means that
TrK/F(ξ)R is an ordinary ideal. Hence TrK/F(ξ) is in R.
In the reverse direction, suppose that TrK/F(xT ) ⊆R. For each nonzero prime
ideal P in T , let vP be the corresponding valuation. Fix p. Let {P1, . . . , Pg} be the
set of P’s with P | p. Now ﬁx i. By the assumed strong approximation property
of K, there exists an element y in K with
vPi(y −x) ≥max(vPi(x), 0),
vPj(y) ≥max(vPj(x), 0)
for j ̸= i,
vQ(y) ≥0
for all prime ideals Q /∈{P1, . . . , Pg}.
Let us see that vPj(yx−1) ≥0 for all j. For j ̸= i, this is immediate because
vPj(y) ≥vPj(x). For j = i, we compute that
vPi(yx−1 −1) = vPi(y −x) −vPi(x) ≥max(vPi(x), 0) −vPi(x)
= max(0, −vPi(x)) ≥0,
and then we see that vPi(yx−1) ≥min(vPi(yx−1 −1), vPi(1)) ≥0.

378
VI. Reinterpretation with Adeles and Ideles
With y now ﬁxed, we make use of the strong approximation property of K a
second time, obtaining an element z in K with
vPj(z −yx−1) ≥max(vPj(x−1), 0)
for 1 ≤j ≤g,
vQ(z) ≥0
for all prime ideals Q /∈{P1, . . . , Pg}.
Since vPj(yx−1) ≥0 and vPj(z −yx−1) ≥0 for all j, we ﬁnd that vPj(z) ≥0
for all j. From vQ(z) ≥0 for all other Q, we conclude that z is in T . Since
TrK/F(xT ) ⊆R, TrK/F(xz) lies in R. The trace formula (∗∗) therefore shows
that
g	
j=1
TrK Pj /Fp(xjzj)
lies in Rp.
(†)
Meanwhile, we have
TrK Pj /Fp(xjzj) = TrK Pj /Fp(xj(zj −yjx−1
j )) + TrK Pj /Fp(yj)
(††)
for 1 ≤j ≤g. For all j, the ﬁrst term on the right side of (††) lies in Rp because
the deﬁnition of z makes vPj(x(z −yx−1)) ≥0. For j ̸= i, the second term
on the right side lies in Rp because of the deﬁnition of y. Thus (††) shows that
TrK Pj /Fp(xjzj) lies in Rp for j ̸= i. Comparing this conclusion with (†), we see
that TrK Pi /Fp(xizi) lies in Rp. Resubstituting into (††), we ﬁnd that
TrK Pi /Fp(yi)
lies in Rp.
(‡)
Finally the deﬁnition of y shows that vPi(y −x) ≥0. Hence TrK Pi /Fp(yi −xi)
is in Rp. Combining this fact with (‡), we conclude that TrK Pi /Fp(xi) is in Rp.
Since i is arbitrary, TrK Pj /Fp(xj) is in Rp for 1 ≤j ≤g.
□
With the proof of Theorem 6.45 reduced to the case of complete valued ﬁelds
by Proposition 6.46, we need to make use of Lemmas 6.47 and 6.48 below, whose
proofs are carried out in Problems 17–19 at the end of the chapter.
Lemma 6.47. Let F be a complete valued ﬁeld with respect to a discrete
nonarchimedean valuation, let R be its valuation ring, let p be its valuation ideal,
let K be a ﬁnite separable extension of F with [K : F] = n, let T be the integral
closure of R in K, and let P be the unique nonzero prime ideal in T . Suppose
that K/F is totally ramiﬁed with pT = Pe for an integer e ≥1, and suppose that
the isomorphic residue class ﬁelds R/p and T/P are ﬁnite ﬁelds of characteristic
p. Then the different D(K/F) is given by D(K/F) = Pe′, where
e′ =
 e −1
if p does not divide e,
¯e
with ¯e ≥e if p divides e.

8. Different and Discriminant
379
Lemma 6.48. Let F be a complete valued ﬁeld with respect to a discrete
nonarchimedean valuation, let R be its valuation ring, let p be its valuation ideal,
let K be a ﬁnite separable extension of F with [K : F] = n, let T be the integral
closure of R in K, and let P be the unique nonzero prime ideal in T . Suppose that
K/F is unramiﬁed, i.e., has pT = P, and suppose that the residue class ﬁelds
R/p and T/P are ﬁnite ﬁelds of characteristic p. Then the different D(K/F)
equals T .
PROOF OF THEOREM 6.45. Proposition 6.46 shows that
D(K/F)p =

P|p
D(K P/Fp).
(∗)
Thus consider an extension K P/Fp of complete valued ﬁelds. Let L be the inertia
subﬁeld of K P/Fp as given by Proposition 6.38. The intermediate ﬁeld L has the
properties that K P/L is totally ramiﬁed and that L/Fp is unramiﬁed.
Let U be the integral closure of R in L, and let ℘be the unique nonzero
prime ideal in U. The properties of L make ℘T = Pe for a suitable integer
e = e(P | ℘), T/P ∼= U/℘, and pU = ℘. Lemmas 6.47 and 6.48 tell us that
D(L/Fp) = U and that D(K P/L) = Pe′, where
e′ =
 e −1
if p does not divide e,
¯e
with ¯e ≥e if p divides e.
(∗∗)
Problem 33 at the end of Chapter IX of Basic Algebra shows that ramiﬁcation
indices multiply for successive extensions. Thus e(P | p) = e(P | ℘)e(℘| p) =
e·1 = e. Proposition6.43showsthatdifferentsmultiplyincorrespondingfashion.
Therefore D(K P/Fp) = D(K P/L)D(L/Fp) = Pe′U = Pe′. Substituting into
(∗), we obtain
D(K/F)p =
1
P|p
D(K P/Fp) =
1
P|p
Pe′(P|p),
where e′(P | p) is the integer e′ of (∗∗) when e = e(P | p). This proves Theorem
6.45 for the pth component of D(K/F). Since p is arbitrary and only ﬁnitely
many components can be unequal to T , the theorem follows.
□
Corollary 6.49 ( = THEOREM 5.5, Dedekind Discriminant Theorem). Let K
be a number ﬁeld, let T be its ring of algebraic integers, let p be a prime number,
and let (p)T = Pe1
1 · · · P
eg
g be the factorization of (p)T as the product of powers
of distinct prime ideals in T . Then ej is greater than 1 for some j if and only if
p divides the ﬁeld discriminant DK.

380
VI. Reinterpretation with Adeles and Ideles
PROOF. Let us observe ﬁrst that the discriminant DK is given up to sign by the
index| T /T |. In fact, T is a torsion-free ﬁnitely generated abelian group and hence
is free abelian of rank n = [K : Q], say with an ordered Z basis  = (x1, . . . , xn).
SincetheQbilinearform(x, y) 	→TrK/Q(xy)isnondegenerateon K, thereexists
an ordered basis  = (y1, . . . , yn) of K with TrK/Q(xi yj) = δi j. Let us write
xj = 	
i ai j yi with all ai j in Q. According to Proposition 5.1, DK equals the
discriminant D() of , deﬁned in Section V.2 by D() = det[TrK/Q(xixj)]i j.
Substituting xj = 	
i ai j yi, we obtain
DK = det
 	
k
akj TrK/Q(xi yk)

i j = det
 	
k
akjδik

i j = det[ai j]i j.
Thus |DK| = | T /T | =
D(K/Q)−1
T
, as asserted.
In a moment we shall show that
D(K/Q)−1
T
 = |T/D(K/Q)|,
(∗)
from which we conclude that |DK| = N(D(K/Q)). Assuming (∗), we continue.
Unique factorization of ideals allows us to write D(K/Q) = P
e′
1
1 · · · P
e′
g
g Q, where
Q is an ideal relatively prime to (p). Combining the equality DK = N(D(K/Q))
with Proposition 5.4 shows that
DK = N(D(K/Q)) = N(Q)
g
j=1
N(P
e′
j
j ) = N(Q)
g
j=1
pe′
j fj,
where N(Q) is an integer not divisible by p and where fj = dimFp(T/Pj) for
1 ≤j ≤g. Consequently DK is prime to p if and only if e′
j = 0 for all j. If we
take into account that T has the strong approximation property as a consequence
of Theorem 6.44, then application of Theorem 6.45 completes the proof of the
present corollary except for the veriﬁcation of (∗).
Thus we are left with proving that
D(K/Q)−1
T
 = |T/D(K/Q)|. More
generally we shall show that
|I −1/T | = |T/I|
(∗∗)
for every nonzero ideal I in T . In turn, we shall deduce (∗∗) after showing that
|M/PM| = N(P)
(†)
whenever M is a nonzero fractional ideal in K and P is a nonzero prime ideal
in T . We do so by showing that M/PM is a vector space over the ﬁeld T/P of
dimension 1. It is evident that T carries M to itself and PM to itself, and that

8. Different and Discriminant
381
P carries M to PM. Thus the action of T on M/PM descends to an action of
T/P on M/PM. The vector space M/PM is not 0 because M ̸= PM by unique
factorization of fractional ideals. To see that M/PM has dimension at most 1,
ﬁx an element x of M that does not lie in PM. Then xT + PM is a fractional
ideal of K that is contained in M + PM = M and contains PM and a member
of M that is not in PM. Hence it equals M. Accordingly, if y ∈M is given, we
can choose t ∈T such that xt −y is in PM. Then (t + P)(x + PM) = y + PM,
and T/P carries x + PM onto M/PM. So M/PM is 1-dimensional over T/P,
and (†) follows.
Returning to (∗∗), let I = Q1 · · · Qk express I as the product of nonzero prime
ideals. Iterated application of (∗∗) and the First Isomorphism Theorem gives
|I −1/T | = |I −1/Q1 · · · Qk I −1| = |I −1/Q1 · · · Qk−1I −1|N(Qk)
= |I −1/Q1 · · · Qk−2I −1|N(Qk)N(Qk−1)
= · · · = |I −1/I −1|
k
j=1
N(Qj) = N(I).
This proves (∗∗) and therefore also (∗).
□
One more point needs explanation. The discussion in Section IX.17 of Basic
Algebra concerned a monic irreducible polynomial F(X) in Z[X] and its reduc-
tion F(X) modulo p, and the interest was in the Galois group G of the splitting
ﬁeld K′ of F(X) over Q. Theorem 9.64 of that book dealt with the natural
homomorphism from a decomposition subgroup G P of G onto the Galois group
G of the splitting ﬁeld over Fp of F(X), and it was asserted without proof that
this homomorphism is one-one if p does not divide the discriminant of F(X).
The order of the kernel of the homomorphism was identiﬁed as the common
ramiﬁcation index of the prime ideals P′ containing (p)R′, R′ being the ring
of algebraic integers in K′. Let K = Q[X]/(F(X)). Except in the quadratic
case, the ﬁeld K typically has much lower dimension over Q than K′ does. The
Dedekind Discriminant Theorem relates DK to ramiﬁcation relative to K, as well
as DK′ to ramiﬁcation relative to K′. We know that primes not dividing the
discriminant of F(X) do not divide DK, but we need a proof that primes not
dividing the discriminant of F(X) do not divide DK′.
To approach this question, one needs the notion of “relative discriminant” anal-
ogous to that of “relative different” for an extension K/F of number ﬁelds. The
relative different is deﬁned so as to be an ideal for K, and the relative discriminant
is an ideal for F. (The ﬁeld discriminant is the generator of the relative discrimi-
nant for K/Q with the appropriate sign attached.) One proves that the behavior
of the relative discriminant under successive extension is reasonable, just as it is
for degree of extension, ramiﬁcation indices, residue class degrees, and relative

382
VI. Reinterpretation with Adeles and Ideles
differents. These results show that if Q ⊆K ⊆L, then the ﬁeld discriminant for
K divides the ﬁeld discriminant for L. The next step is to extend the notion of
ﬁeld discriminant so that it applies to commutative semisimple algebras and to
show that the discriminant of a tensor product over Q of ﬁnitely many number
ﬁelds is a certain function of the ﬁeld discriminants and dimensions of the factors.
Finally we return to F(X) and its splitting ﬁeld K′. Let ξ be a root of F(X) in
K′, and let σ1(ξ), . . . , σn(ξ) be the distinct conjugates of ξ. Then K′ is generated
by the subﬁelds Q(ξ1), . . . , Q(ξn), and the (Q multilinear) multiplication map
extends to an algebra homomorphism of Q(ξ1) ⊗Q · · · ⊗Q Q(ξn) onto K′. As
the tensor product of commutative semisimple algebras in characteristic 0, this is
commutative semisimple (Corollary 2.37) and is therefore a direct sum of ﬁelds
(Theorem 2.2). Thus we can regard K′ as a subﬁeld of the tensor product of ﬁelds
isomorphic to Q[X]/(F(X)), and the discriminant of K′ divides the discriminant
of the tensor product. Putting everything together, we see that the only possible
primes dividing DK′ are the primes that divide DK. Therefore the primes that fail
to divide the discriminant of F(X) do not ramify in K′.
9. Global and Local Fields
A global ﬁeld K is either a number ﬁeld, i.e., a ﬁnite extension of Q, or a function
ﬁeld in one variable over a ﬁnite ﬁeld, i.e., a ﬁnite extension of someFq(X), where
Fq is a ﬁnite ﬁeld.24 An example of the latter is
K = Fp(x)[y]/(y2 −(x3 −x)) ∼= Fp(x)
2
x3 −x

.
In this section we shall develop some machinery for working with global ﬁelds.
Our interest at present is in number ﬁelds, but function ﬁelds in one variable are
the object of study in Chapter IX. Consequently the results will be stated for
all global ﬁelds as long as all global ﬁelds can readily be treated together, and
thereafter we shall specialize to number ﬁelds.
The virtue of global ﬁelds for current purposes is that their completions with
respect to nontrivial absolute values are always locally compact with a nontrivial
topology. In the case of number ﬁelds, we know this for archimedean absolute
values by Proposition 6.27, and it follows for nonarchimedean absolute values
by Corollary 6.21 and Theorem 6.26. In the function-ﬁeld case as above, the
completions have to be nonarchimedean by Proposition 6.14, and their absolute
valueshavetobediscretebyCorollary6.22; thentheresidueclassﬁeldsarealways
24It will be shown in Chapter VII that a function ﬁeld in one variable over a ﬁnite ﬁeld is always
a ﬁnite separable extension of Fq(Y) for a suitable indeterminate Y.

9. Global and Local Fields
383
ﬁnite, and Theorem 6.26 shows that the completions are all locally compact with
a nontrivial topology.
To study a global ﬁeld K in the style of this chapter, one studies simultaneously
the completions25 of K with respect to one absolute value from each equivalence
class.26 Two completions are said to be equivalent completions if the absolute
values on the domains of the completion maps are equivalent in the sense of Sec-
tion 3. An equivalence class of completions of nontrivial absolute values is called
a place of K. A place is called archimedean or nonarchimedean according as
the corresponding absolute values are archimedean or nonarchimedean; in the
archimedean case it is called real or complex according as the locally compact
completed ﬁeld is R or C.
Because of the special hypotheses for the situation with global ﬁelds, we shall
see that to each place corresponds a distinguished choice of an absolute value
on K from the equivalence class, called the normalized absolute value in the
class.27 These normalized completions are glued together28 in a fashion to be
described in the next section to form the ring of “adeles” of K and the group of
“ideles” of K. Historically ideles preceded adeles, and ideles were introduced in
order to reinterpret class ﬁeld theory and improve upon it; convincing motivation
is therefore not readily at hand without knowledge that extends beyond this book.
However, we can get some advance insight into how adeles and ideles might be
useful from the ﬁrst part of the classical proof of the Dirichlet Unit Theorem
(Theorem 5.13) as given in Section V.5.
That proof in effect handles archimedean places in a way similar to the way
that adeles handle all places. In more detail let K be a number ﬁeld of degree
n over Q, and let R be its ring of algebraic integers. In Chapter V we usually
regarded K as a subﬁeld of C, but we shall not do so here. As was observed
in Section V.2, there exist exactly n ﬁeld mappings of K into C, and we denote
them by σ1, . . . , σn. If x is in K, then the images σ1(x), . . . , σn(x) are called
the conjugates of x. Among σ1, . . . , σn are r1 real-valued mappings and r2
complex conjugate pairs, with r1 + 2r2 = n. Let us number the mappings so that
σ1, . . . , σr1 are real-valued and so that σr1+1, . . . , σr1+r2 pick out one from each
complex conjugate pair. Proposition 6.27 shows that the functions x 	→|σ1(x)|,
25It is important not to lose sight of the fact that a “completion” is a certain kind of homomorphism
of valued ﬁelds and does not consist merely of the range space.
26The completion of the trivial absolute value is excluded.
27The range of each completion is a locally compact ﬁeld whose topology is not the discrete
topology. Such a ﬁeld is often called a local ﬁeld in books. Examples are R, C, p-adic ﬁelds, and
ﬁelds Fq((X)) of formal Laurent series. One can show that there are no other locally compact ﬁelds
whose topology is not discrete. The deﬁnition of “local ﬁeld” in some books is arranged to exclude
R and C.
28It is tempting to think in terms of the gluing as involving just the locally compact ﬁelds, but
the completion mappings play a role and that description is thus an oversimpliﬁcation.

384
VI. Reinterpretation with Adeles and Ideles
. . . , x 	→|σr1+r2(x)| are a complete set of representatives for the archimedean
places of K; the ﬁrst r1 are real, and the last r2 are complex.
Just before Lemma 5.17 we introduced the mapping  : K →Rr1 ×Cr2 given
by
(x) =

σ1(x), . . . , σr1(x), σr1+1(x), . . . , σr1+r2(x)

for x ∈K.
Lemma 5.17 observed that the image (R) of R is a lattice in Rr1 × Cr2 ∼= Rn.
The starting point for proving the Dirichlet Unit Theorem in Section V.5 was to
apply the Minkowski Lattice-Point Theorem to this lattice (R). Proposition
6.27 allows us to interpret the mapping  as the natural embedding of K into the
product of its completions at all archimedean places.
The ring of adeles of K will be a corresponding space for dealing with com-
pletions with respect to all nontrivial absolute values, archimedean and nonar-
chimedean.
While we have the archimedean places of the number ﬁeld K at hand, let us
address the question of their normalized representatives. Since the ﬁeld maps
from K into C given by σr1+1,...,r1+r2 are equal to the complex conjugates of
σr1+r2+1, . . . , σn, every member x of K has
NF/Q(x) =
n
j=1
σj(x) =
 r1
j=1
σj(x)
 r1+r2

j=r1+1
|σj(x)|2
.
This formula can be viewed as an archimedean analog of the formula in Corollary
6.37b. The number ﬁeld Q has one archimedean place, and ordinary absolute
value is taken as its normalized representative. We denote this representative by
| · |∞. With | · | denoting ordinary absolute value on R and C, we obtain
|NK/Q(x)|∞=
 r1
j=1
|σj(x)|
 r1+r2

j=r1+1
|σj(x)|2
.
It is customary to use letters like v and w as indices for places. The real places
are the completions x 	→σj(x), 1 ≤j ≤r1, of K into R, and the normalized
absolute value on K for a real place is the pullback from ordinary absolute
value on R. Thus if | · |R denotes ordinary absolute value on R and if v is a
real place corresponding to σj, then we deﬁne |x|v = |σj(x)|R for x ∈K. The
normalization to use for the complex places is motivated by the formula above.
If r1 + 1 ≤j ≤r1 + r2, then σj in effect contributes twice to the above formula,
once from j and once from j +r2, and the notion of normalized absolute value is
to take this double contribution into account. Thus we write | · |C for the square
of the ordinary absolute value on C; this quantity is not really an absolute value,
since the triangle inequality fails for it, but it has too many desirable features to

9. Global and Local Fields
385
be ignored. We deﬁne the normalized absolute value on K for a complex place
to be the pullback from this function | · |C on C even though the result fails to
satisfy the triangle inequality. Thus if v is a complex place corresponding to σj
with r1 + 1 ≤j ≤r1 + r2, then we deﬁne |x|v = |σj(x)|C = |σj(x)|2 for x ∈K.
With these deﬁnitions of normalized absolute values for archimedean places, the
formula above for |NF/Q(x)|∞can be rewritten as
|NK/Q(x)|∞=
 r1
j=1
|σj(x)|R
 r1+r2

j=r1+1
|σj(x)|C

=
 
v real
|x|v


v complex
|x|v

.
We summarize matters in the following proposition.
Proposition 6.50. If K is a number ﬁeld, then
|NF/Q(x)|∞=

v archimedean
|x|v
for x ∈K,
where | · |v is the pullback of | · |R , the ordinary absolute value, for real places
and where | · |v is the pullback of | · |C , the ordinary absolute value squared, for
complex places.
At this point we could give a deﬁnition of normalized absolute value corre-
sponding to nonarchimedean places. But we shall digress in order to motivate
the deﬁnition using concepts from measure theory that may be known to some
readers and not to others. These concepts play a role within the text only in the
next paragraph and in Example 4 of normalized discrete absolute values below,
and the reader will not miss any results or proofs by skipping this material.
The digression begins. Any locally compact group has a nonzero measure
on it that is invariant under left translation,29 and this measure is unique up to
multiplication by a scalar. Let a locally compact ﬁeld L be given, and let μ be
an invariant measure of this kind with respect to the additive group of L. Each
nonzero element c of L has the property that μ(cE) is a multiple of μ(E) that
is independent of E. If we write |c|L for this multiple and put |0|L = 0, then it
turns out that some power | · |α
L with 0 < α ≤1 is necessarily an absolute value
and that this power α can be taken to be 1 in all cases except when L = C. In the
case of C, it is easy to check that |c|C = |c|2, and the triangle inequality therefore
29Although the details will not be important for us, let us be more precise: The measure is on
the σ-algebra of “Baire sets” on the group—the smallest σ-algebra containing those compact sets
that are intersections of countably many open sets. The measure is not the 0 measure, it is ﬁnite on
all the generating compact sets, and it takes the same value on a set as it does on any left translate
of the set. It is called a left Haar measure. For more information, see the author’s Advanced Real
Analysis, Chapter VI.

386
VI. Reinterpretation with Adeles and Ideles
fails for α = 1. But in all other cases, | · |L is a canonical choice for an absolute
value on L. Now suppose that ψ : K →L is a ﬁeld map of a global ﬁeld K onto
a dense subﬁeld of a locally compact ﬁeld. We impose this special absolute value
| · |L on L. Then a necessary and sufﬁcient condition on an absolute value | · |K
for ψ : (K, | · |K) →(L, | · |L) to be a completion is that | · |K = ψ∗(| · |L).
In other words, the pullback of the special normalization of the absolute value on
the locally compact ﬁeld is the natural normalization to use for the absolute value
on the global ﬁeld.
With the digression now over, we want to associate to each nonarchimedean
place of a global ﬁeld a special normalization of an absolute value. (We handled
the question of normalization at archimedean places earlier in the section.) We can
be a bit more general. Suppose that F is an arbitrary ﬁeld with a discrete valuation
v and with corresponding nontrivial absolute value given by |x|v = r−v(x) for
some r > 0. Let R be the valuation ring and p the valuation ideal; p is a principal
ideal of the form (π) for some π ∈R. Suppose that the residue class ﬁeld R/p is
ﬁnite. Then we say that | · |v is normalized if |π|v = |R/p|−1. This deﬁnition
is independent of the choice of π.
EXAMPLES OF NORMALIZED DISCRETE ABSOLUTE VALUES.
(1) The ﬁeld Q and the p-adic absolute value given by |ab−1 pk|p = p−k when
a and b are integers prime to p. The valuation ring R consists of all ab−1 with
a ∈Z, b ∈Z, and b prime to p. The valuation ideal consists of all such ab−1
with a divisible by p, and the quotient R/p is isomorphic to Fp. The element
π may be taken to be p, and |p|p equals p−1, which equals |R/p|−1. Thus the
p-adic absolute value on Q is normalized.
(2) Let K be a number ﬁeld of degree n over Q, and let T be its ring of algebraic
integers. Let p be a nonzero prime ideal in T , and let v be the corresponding
valuation of K.
Let q = |T/p|, and deﬁne |x|p = q−v(x).
Then | · |p is
normalized because Theorem 6.5e shows that the residue class ﬁeld obtained
from the valuation is isomorphic to T/p.
(3) Let K = Fq(X), ﬁx a prime polynomial c(X) in Fq[X], and consider
the absolute value on K deﬁned by |a(X)b(X)−1c(X)k| = q−k deg c(X) whenever
a(X) and b(X) are polynomials relatively prime to c(X). This example runs
completely parallel to the two previous examples, and π may be taken to be
c(X). The residue class ﬁeld has as representatives all polynomials h(X) with
deg h(X) < deg c(X) and thus has order qdeg c(X). This order matches |c(X)|−1,
and hence | · | is normalized.
(4) If F is a locally compact ﬁeld whose topology comes from some nontrivial
discrete absolute value with ﬁnite residue class ﬁeld, then the canonical absolute
value | · |F described in the digression above and obtained from an invariant

9. Global and Local Fields
387
measure μ on the additive group of F is normalized. To see this, let R and
p be the valuation ring and valuation ideal, and write p = (π).
Put m =
|R/p|, and let x1, . . . , xm be representatives of the m cosets of R/p in R. Then
μ(xj + p) = μ(p) for 1 ≤j ≤m by translation invariance of μ, and hence
μ(R) = 	m
j=1 μ(xj +p) = mμ(p). Substituting and using the deﬁnition of | · |F
gives μ(p) = μ(π R) = |π|Fμ(R) = |π|Fmμ(p). The number μ(p) is positive,
since p is a nonempty open subset of F, and we can cancel to get |π|Fm = 1.
Thus |π|F = |R/p|−1, and | · |F is normalized.
Theorem6.51(Artinproductformula). If F isanumberﬁeldandifnormalized
absolute values are used, then

v
|x|v = 1
for all nonzero x ∈F,
the product being taken over all places v. In this product, only ﬁnitely many of
the factors can be different from 1.
REMARKS. A version of this theorem is valid for function ﬁelds in one variable.
As Corollary 6.22 permits, one can state this analogous theorem in terms of
discrete valuations that are trivial on the base ﬁeld, and absolute values need play
no role. The precise statement and proof appear in Chapter IX. Corollary 6.9 in
the present chapter is a special case.
PROOF. First we prove the result for Q. Let a rational y = ±pk1
1 · · · pkrr be
given; here p1, . . . , pr are distinct primes. The product 
v |y|v is taken over
all places, hence over all primes and the one archimedean place ∞. For this
y ∈Q, we have |y|pj = p
−kj
j
for 1 ≤j ≤r and |y|p′ = 1 for all other
primes p′. So 
p prime |y|p = p−k1
1
· · · p−kr
r
. Since |y|∞= pk1
1 · · · pkrr , we obtain

all v |y|v = 1.
Let R be the ring of algebraic integers in F. Given x in F, factor the fractional
ideal x R. The nonarchimedean places correspond to the nonzero prime ideals
in R, and |x|v is 1 except for the v’s corresponding to those prime ideals in the
factorization. There are only ﬁnitely many of these. Since also there are only
ﬁnitely many archimedean places, we see that |x|v = 1 for all but ﬁnitely many v.
Let us consider the nonarchimedean places separately from the archimedean
ones. The nonarchimedean places correspond to nonzero prime ideals ℘, and we
group these according to the prime number p such that ℘∩Z = pZ, writing
℘| pZ for this correspondence. For ﬁxed p and for each ℘with ℘| pZ, let
x℘be the image of x under the local embedding in F℘. Corollary 6.37b gives
NF/Q(x) = 
℘|pZ NF℘/Qp(xp). Theorem 6.33 shows that |x℘|F℘is a power
of |NF℘/Qp(x℘)|Qp. To determine the power, we observe from Example 2 that

388
VI. Reinterpretation with Adeles and Ideles
the canonical absolute values on Qp and F℘are normalized, and we specialize
|x℘|F℘and |NF℘/Qp(x℘)|Qp to x℘in Qp. Making the comparison, we ﬁnd that
|NF℘/Qp(x℘)|Qp = |x℘|F℘. We know that each local embedding respects absolute
values; since Theorems 6.5e and 6.26e together show that the residue class ﬁelds
of F℘and Qp have orders |R/℘| and |Z/pZ|, it follows that |x℘|F℘= |x|℘.
Therefore
|NF/Q(x)|p = |NF/Q(x)|Qp = 
℘|pZ
|NF℘/Qp(x℘)|Qp
= 
℘|pZ
|x℘|F℘= 
℘|pZ
|x|℘.
(∗)
Fortheﬁnitelymanyarchimedeanplaces, Proposition6.50givesustheformula
|NF/Q(x)|∞=

v archimedean
|x|v,
(∗∗)
where | · |∞is the ordinary absolute value on Q. Multiplying (∗) and (∗∗) and
using the known identity 
v |y|v = 1 for the element y = NF/Q(x) of Q, we
obtain the theorem.
□
10. Adeles and Ideles
In this section we do the gluing that creates the adeles and the ideles out of the
places of a global ﬁeld. We begin with a topological construction, and then we
superimpose the algebraic structure. The general constructions and the two main
theorems will be valid for all global ﬁelds, but we shall discuss proofs of the
theorems only for number ﬁelds.
Suppose that {Xi | i ∈I} is a nonempty family of locally compact Hausdorff
spaces. Assume that for all but ﬁnitely many i ∈I we are given a compact open
subset Zi of Xi. The restricted direct product of the Xi’s relative to the Zi’s is
the subset

i∈I
′Xi ⊆

i∈I
Xi
deﬁned by
(xi)i∈I ∈

i∈I
′Xi
if and only if
xi ∈Zi for all but ﬁnitely many i.
The restricted direct product is topologized as follows. Suppose that S ⊆I is a
ﬁnite subset and that Zi is deﬁned for i /∈S. Put
X(S) =

i∈S
Xi ×

i /∈S
Zi.

10. Adeles and Ideles
389
In their respective product topologies the ﬁrst factor is locally compact, and the
second factor is compact. Certainly X(S) is a subset of the restricted direct
product, and evidently the restricted direct product is the union of the subsets
X(S) over all ﬁnite subsets S for which Zi is deﬁned when i /∈S. We topologize
′
i∈I Xi by insisting that each X(S) be an open subset.30 The resulting topology
is locally compact Hausdorff. In fact, any two members of ′
i∈I Xi lie in a
common X(S), and the open sets that separate them in X(S) separate them in
′
i∈I Xi. Also, any (xi)i∈I is in some X(S), which is locally compact, and a
compact neighborhood within X(S) will be a compact neighborhood in ′
i∈I Xi.
Now we superimpose the algebraic structure. Let K be a global ﬁeld. To each
place v of K, we have associated a normalized absolute value | · |v on K and a
completion ιv : (K, | · |v) →(Kv, | · |Kv). Each of the complete valued ﬁelds
Kv is locally compact. Except at the ﬁnitely many archimedean places, which
occur only in the number-ﬁeld case, | · |Kv arises from a discrete valuation. We
take Rv to be the corresponding valuation ring, i.e., Rv =

x ∈Kv
 |x|v ≤1

.
This is a compact open additive subgroup of Kv. Thus we can form a restricted
direct product in which the index set I is the set of places of K, the vth locally
compact Hausdorff space is Kv, and the vth compact open subset is Rv. This
restricted direct product carries the structure of a commutative ring with identity,
with its addition and multiplication deﬁned in coordinate-by-coordinate fashion,
and the operations are continuous. Thus we obtain a topological ring, known as
the ring of adeles of K and denoted by AK or simply by A when no ambiguity is
possible.
If for each x ∈Kv0, we send x into the tuple (av)v that has av0 = x and av = 0
for v ̸= v0, then the result is a one-one continuous ring homomorphism of Kv
into A. This homomorphism of course does not send the multiplicative identity
of Kv to the multiplicative identity of A.
The completion mappings ιv : K →Kv embed K into each Kv, and we can
form a corresponding diagonal map ι : K →
v Kv into the full product of Kv’s
by deﬁning ι(x) = (ιv(x))v. Actually, we shall check for x ̸= 0 that only ﬁnitely
many places have |ιv(x)|v = |x|v unequal to 1, and therefore the image of the
diagonal map is in the adeles. Thus we have a diagonal ring homomorphism
ι : K →A
given by
ι(x) = (ιv(x))v for x ∈K.
The fact that in the number-ﬁeld case, |x|v is unequal to 1 for only ﬁnitely many
places appears as part of Theorem 6.51. For the function-ﬁeld case, the ﬁeld K is
a ﬁnite separable extension of some ﬁeld Fq(X), and all but ﬁnitely many places
come from nonzero prime ideals in the integral closure R of Fq[X] in K. At the
30In other words, a set in ′
i∈I Xi is open if and only if its intersection with each X(S) is open
in X(S).

390
VI. Reinterpretation with Adeles and Ideles
unexceptional such places the value of |x|v comes by treating x R as a fractional
ideal and factoring it; only ﬁnitely many ideals are involved in the factorization,
and only those among all the unexceptional places can have |x|v ̸= 1. The main
structural theorem about the adeles is as follows.
Theorem 6.52. If K is a global ﬁeld, then the image of K in the adeles A
under the diagonal mapping ι : K →A is discrete, and the quotient A/ι(K) of
additive groups is compact.
For a number ﬁeld the compactness in Theorem 6.52 encodes Lemma 5.17
and the Strong Approximation Theorem. The proof of the theorem is not hard,
and we return to it in a moment. In the current discussion Theorem 6.52 is
not something to appreciate for its own consequences but instead is a prototype
for a corresponding theorem about “ideles” that encodes for number ﬁelds the
ﬁniteness of the class number and the Dirichlet Unit Theorem.
The construction of the “ideles” of K proceeds similarly to the construction
of the adeles. Again we use a restricted direct product, with the set of places as
index set. The locally compact Hausdorff space associated to the place v is the
multiplicative group K ×
v . For v nonarchimedean, we again let Rv be the valuation
ring in Kv, and take the compact open subset of K ×
v to be the group R×
v of units
in Rv, i.e., R×
v =

x ∈Kv
 |x|v = 1

. The group of ideles is the restricted direct
product of the groups K ×
v relative to the compact subgroups R×
v . The result is a
locally compact abelian group, known as the group of ideles of K and denoted
by IK or simply by I.
Warning:
As a set, I coincides with the group of units A×. However, the
topologies do not match. The topology for I is ﬁner than the relative topology on
A×. See Problems 7–8 at the end of the chapter.
If for each x ∈Kv0, we send x into the tuple (av)v that has av0 = x and av = 1
for v ̸= v0, then the result is a one-one continuous group homomorphism of K ×
v
into I. As with the ideles we also have a diagonal mapping ι : K × →I given by
ι(x) = (ιv(x))v; the image is contained in I, since for a nonzero x ∈K, |x|v can
be unequal to 1 for only ﬁnitely many v.
The Artin product formula (Theorem 6.51) and the corresponding result for
function ﬁelds in one variable over a ﬁnite ﬁeld put a constraint on the image. We
deﬁne the absolute value |(av)v| of an idele (av)v to be the product of the absolute
values of the components: |(av)v| = 
v |av|v. This is well deﬁned because only
ﬁnitely many factors are allowed to be different from 1. If I1 denotes the group
of ideles of absolute value 1, then I1 is a closed subgroup of I. The Artin product
formula and its function-ﬁeld analog imply that the image of the diagonal mapping
is contained in I1. The main structural theorem about the ideles is as follows.

10. Adeles and Ideles
391
Theorem 6.53. If K is a global ﬁeld, then the image of K × in the subgroup
I1 of the ideles I under the diagonal mapping ι : K × →I is discrete, and the
quotient group I1/ι(K ×) is compact.
From now on, we suppose that the global ﬁeld K is a number ﬁeld. Let
S∞be the set of archimedean places.
We begin by supplying direct proofs
of the discreteness in Theorems 6.52 and 6.53 and of the compactness of the
quotient in Theorem 6.52. After some additional discussion we return to prove
the compactness of the quotient in Theorem 6.53.
PROOF OF DISCRETENESS OF ι(K) IN THEOREM 6.52. It is enough to produce
a neighborhood U of 0 in A such that U ∩ι(K) = {0}.
The set U of all
(xv)v ∈A such that |xv|v < 1 for all archimedean places and |xv|v ≤1 for all
nonarchimedean places is an open product set in A(S∞) and hence is an open
neighborhood of 0 in A. Since Theorem 6.51 shows that 
v |ιv(y)|v = 1 for all
y ̸= 0 in K and since 
v |xv|v < 1 for all (xv)v in U, U ∩ι(K) = {0}.
□
PROOF OF DISCRETENESS OF ι(K ×) IN THEOREM 6.53.
The set U of all
(xv)v ∈Isuchthat|xv−1|v < 1forallarchimedeanplacesand|xv−1|v ≤1forall
nonarchimedeanplacesisanopenproductsetinI(S∞)andhenceisanopenneigh-
borhood of 1 in I. If (xv)v = ι(y) with y ∈K × and y ̸= 1, then xv−1 = ιv(y−1)
with y−1 ̸= 0, andTheorem6.51showsthat
v |ιv(y)−1|v =
v |ιv(y−1)|v =1.
The members (xv)v of U all have 
v |xv −1|v < 1, and thus U ∩ι(K ×) = {1}.
□
PROOF OF COMPACTNESS OF A/ι(K) IN THEOREM 6.52. We begin by observing
that
A = ι(K) + A(S∞),
(∗)
i.e., that the set of sums of a member of ι(K) and a member of A(S∞) exhausts A.
In fact, given (xv)v in A, we let v1, . . . , vr be the ﬁnitely many nonarchimedean
places for which |xvj|vj > 1. The Strong Approximation Theorem (Theorem
6.44) applied to the elements xv1, . . . , xvr produces a member y of K such that
|ιvj(y) −xvj|vj < 1 for 1 ≤j ≤r and such that |ιv(y)|v ≤1 for all other
nonarchimedean placesv. Consequently|ιv(y)−xv|v ≤1 for all nonarchimedean
v. This inequality means exactly that (xv)v −ι(y) is in A(S∞). Hence
x = ι(y) + ((xv)v −ι(y))
is the required decomposition, and (∗) is proved.
In addition, we have
ι(R) = ι(K) ∩A(S∞).
(∗∗)

392
VI. Reinterpretation with Adeles and Ideles
In fact, the inclusion ⊆is clear. For the inclusion ⊇, let y be a member of K such
that ι(y) is in A(S∞). Then |ιv(y)|v ≤1 for all nonarchimedean v, and it follows
that y is in R.
Toprovethecompactness, weusetheidentity(M+N)/M ∼= N/(M∩N)given
by the Second Isomorphism Theorem in the category of locally compact abelian
groups, taking M = ι(K) and N = A(S∞). Then (∗) shows that M + N = A,
and (∗∗) shows that M ∩N = ι(R). Hence
A/ι(K) ∼= A(S∞)/ι(R).
(†)
Let us write A(S∞) =  × , where  = Rr1 × Cr2 = 
v archimedean Kv and
 = 
v nonarchimedean Rv. The mapping  : K → deﬁned near the beginning
of Section 9 has the property that
ι(R) + ({0} × ) = (R) × .
From this equality we obtain
A(S∞)/(ι(R) + ({0} × ) ∼= ( × )/((R) × ) ∼= /(R),
and Lemma 5.17 shows that this is compact. Since ({0} × ) ∩ι(R) = {0},
application of the First Isomorphism Theorem and then the Second Isomorphism
Theorem gives

A(S∞)/ι(R)

A(S∞)/(ι(R) + ({0} × )
 ∼=

ι(R) + ({0} × )

ι(R)
∼= ({0} × )/

({0} × ) ∩ι(R)

= {0} × ,
and this is compact also. So the closed subgroup A(S∞)/(ι(R) + ({0} × ) of
A(S∞)/ι(R) and the quotient by this subgroup are both exhibited as compact, and
it follows that A(S∞)/ι(R) is compact. Application of (†) shows that A/ι(K) is
compact.
□
A ﬁrst approach to proving the compactness of I1/ι(K ×) in Theorem 6.53 is to
pursue an analogy with the above proof for A/ι(K) by showing that multiplicative
analogs of (∗) and (∗∗) from that proof are valid here:
I
?= ι(K ×) I(S∞),
ι(R×) = ι(K ×) ∩I(S∞).
The second of these formulas is ﬁne and is easily proved: The inclusion ι(R×) ⊆
ι(K ×)∩I(S∞) is clear. For the inclusion ι(R×) ⊇ι(K ×)∩I(S∞), let y be a mem-
ber of K × such that ι(y) is in I(S∞). Then |ιv(y)|v = 1 for all nonarchimedean
v, and it follows that y and y−1 are in R, hence that y is in R×.

10. Adeles and Ideles
393
The difﬁculty is that an equality I
?= ι(K ×) I(S∞) holds if and only if the ring
R of algebraic integers in K is a principal ideal domain. Let us elaborate on this
point, since we will be led by it to the relationship between ideles and the ideal
class group that makes ideles useful.
Let us enumerate the nonzero prime ideals of R as P1, P2, . . . in some fashion.
As was mentioned in Section 2, each nonzero fractional ideal I in K has a ﬁnite
unique factorization of the form I = P
ki1
i1 · · · Pkim
im , where ki1, . . . , kim are integers.
The mapping that carries I to the tuple (aj)j≥1 with aj = kil when j = il and
aj = 0 when j is not in {ki1, . . . , kim} is a group isomorphism  from the group I
of fractional ideals onto a free abelian group !∞
j=1 Z of countably inﬁnite rank.
Some of these fractional ideals are of the form x R for some x ∈K ×, and they are
the principal fractional ideals. They form a subgroup P of I that is isomorphic
to K ×, and the quotient I/P is isomorphic to the ideal class group of K, as was
shown at the end of Section 2. Theorem 5.19 says that the group I/P is a ﬁnite
group; its order is the class number of K.
Meanwhile, suppose that (xv)v is a member of the group I of ideles.
To
each nonarchimedean place v, Corollary 6.8 associates a unique nonzero prime
ideal, which we write as Pi(v) for a function i( · ). If qv = |R/Pi(v)|, then the
relationship between the valuation ordv( · ) and the normalized absolute value
associated to Pi(v) is |xv|v = q−ordv(xv)
v
. Since (xv)v is an idele, there are only
ﬁnitely many nonarchimedean v’s for which ordv(xv) is not 0. We can therefore
map (xv)v into the tuple of integers (ordv(xv))v and compose with −1 to obtain
a homomorphism of the group I into the group I of fractional ideals. In more
detail, the mapping from I to !∞
j=1 Z is given by (xv)v 	→(aj)j≥1 with ai(v) =
ordv(xv), and then −1 interprets this sequence of integers as the exponents of
the appropriate prime ideals. Since any association of members of K ×
v at ﬁnitely
many nonarchimedean places can be extended to an idele by making the idele
be 1 at the remaining places, this homomorphism of I into I is onto I.
Now suppose that the given idele (xv)v is of form ι(x) for some x in K ×.
Then the procedure for mapping this idele to a product of powers of the nonzero
prime ideals of R is the same as the procedure for decomposing the fractional
ideal x R as a product of powers of nonzero prime ideals of R. Consequently our
homomorphism descends to a homomorphism
I

ι(K ×) −→I/P
of the idele class group I

ι(K ×) onto the (ﬁnite) ideal class group I/P. This
is the fundamental fact about the ideles; the displayed homomorphism in effect
says that the idele class group reﬁnes the information in the ideal class group.
The subject of class ﬁeld theory shows that this reﬁned information is useful.
Under the homomorphism of I onto I, the kernel consists exactly of I(S∞),
the ideles whose components at each nonarchimedean place v are in R×
v . Thus

394
VI. Reinterpretation with Adeles and Ideles
I/I(S∞) →I is an isomorphism. Taking into account the effect on ι(K ×), we
obtain an isomorphism
I

ι(K ×) I(S∞)
 ∼= I/P.
Returning to our hoped-for equality I
?= ι(K ×) I(S∞) and comparing with the
displayed isomorphism, we see that I equals ι(K ×) I(S∞) if and only if I = P.
Equality I = P holds if and only if every fractional ideal of K is principal, if and
only if every ordinary ideal of R is principal.
Thus we see why a direct analog of the proof of Theorem 6.52 does not work
for Theorem 6.53. But at the same time we obtain information about how to give
a correct proof. We saw that factoring I/ι(K ×) by I(S∞) leads to the ﬁnite group
I/P. We shall see that if we factor I/ι(K ×) by a suitably larger group I(S) with
S still ﬁnite, then the quotient is the trivial group. An indication of this fact was
in Problems 19–23 at the end of Chapter V, which showed that if we localize R
at a large enough ﬁnite set of nonzero prime ideals, then the result is a principal
ideal domain. In adelic/idelic terms the corresponding procedure is to enlarge
S∞to a suitable ﬁnite set S containing S∞and to replace I(S∞) by I(S); this
enlargement has the effect of replacing R×
v by K ×
v at ﬁnitely many places v in
considering what happens to ideals, and this is exactly what the localization in
those problems accomplishes. Thus for a suitable ﬁnite set S containing S∞, we
will have an isomorphism
I

ι(K ×) I(S)
 ∼= {1};
in other words,
I = ι(K ×) I(S)
for a suitable ﬁnite set S containing S∞.
One ﬁnal remark is needed, and then we are ready to carry out the proof of
the compactness of I1/ι(K ×). The remark is that we always have at least one
archimedean place, and adjusting an idele suitably at one archimedean place
can change it from being in I to being in the subgroup I1 of ideles for which

v |xv|v = 1. The members of ι(K ×) are already in this subgroup, but the
members of I(S) need not be. Thus we replace I(S) by I(S) ∩I1 = I1(S), and
the above equality becomes
I1 = ι(K ×) I1(S)
for a suitable ﬁnite set S.
PROOF OF COMPACTNESS OF I1/ι(K ×) IN THEOREM 6.53. Let S be as above.
Since I1 = ι(K ×) I1(S), the Second Isomorphism Theorem gives
I1/ι(K ×) ∼= I1(S)/(ι(K ×) I1(S)).
(∗)
We shall prove that the right side is compact.

10. Adeles and Ideles
395
Let T be the complement of S∞in S, and deﬁne
×
1 = 
v∈S∞
K ×
v ,
×
2 = 
v∈T
K ×
v ,
×
2 = 
v∈T
R×
v ,
×
3 = 
v/∈S
R×
v .
If E is any subset of I(S), E1 will denote the set of members of E of total
absolute value 1. Thus for example, (×
1 )1 is the set of tuples (xv)v∈S∞with

v∈S∞|xv|v = 1.
Let  : K × →×
1 be the mapping given in Section 9. Each member u of the
group of units R× has the property that |u|v = 1 for every nonarchimedean place
v. Then it follows from the Artin product formula (Theorem 6.51) that  carries
R× into (×
1 )1. One of the two key ingredients in the proof of Theorem 6.51 is
the observation that
(×
1 )1/(R×)
is compact.
(∗∗)
In fact, ×
1 is a product of r1 copies of R× and r2 copies of C×. The function
Log : ×
1 →Rr1+r2 given by
Log(x1, . . . , xr, xr1+1, . . . , xr1+r2+1)
= (log |x1|R, . . . , log |xr1|R, log |xr1+1|C, . . . , log |xr1+r2|C)
is a continuous homomorphism of ×
1 onto Rr1+r2, and its kernel is compact,
being the product of r1 two-element groups and r2 circles. The image of (×
1 )1 is
a hyperplane, and the proof of the Dirichlet Unit Theorem (Theorem 5.13) shows
that Log(×
1 )1/Log(R×) is compact. Then (∗∗) follows.
The other key ingredient is the ﬁniteness of the class number of K, which was
proved as Theorem 5.19. Let h be this class number. For each v in T = (S∞)c, let
Pv be the corresponding nonzero prime ideal in R. The ideal Ph
v in R is principal,
and we let πv be a generator. This element has the properties that K ×
v /ιv(πv)ZRv
is compact and that |ιv′(πv)|v′ = |πv|v′ = 1 for all nonarchimedean v′ with
v′ ̸= v. Let
2 = 
v∈T
ιv(πv)ZRv;
this is a subgroup between 2 and 2 such that 2/2 is compact. Let  be the
subgroup of K × given by  = 
v∈T πZ
v .
The group ι( ) is certainly a subgroup of ι(K ×), and the fact that |πv|v′ = 1
for v′ /∈S implies that ι( ) is contained in I1(S). Each member of ι(R×) has
all nonarchimedean absolute values equal to 1, and consequently we have an
inclusion ι(R×)ι( ) ⊆ι(K ×)I1(S). In view of (∗), I1(S)/(ι(K ×) I1(S)) is a
homomorphic image of
I1(S)

ι(R×)ι( )({1} × ×
2 × ×
3 )

,
(†)

396
VI. Reinterpretation with Adeles and Ideles
and it is therefore enough to prove that (†) is compact.
The members of ι(R×) have all nonarchimedean absolute values equal to 1
and consequently
ι(R×)({1} × ×
2 × ×
3 ) = (R×) × ×
2 × ×
3 .
Therefore the quotient of (†) by
I1(S)

ι( )((×
1 )1 × ×
2 × ×
3 )

(††)
is isomorphic to
I1(S)

ι( )((R×) × ×
2 × ×
3 )
3
I1(S)

ι( )((×
1 )1 × ×
2 × ×
3 )

,
which in turn is isomorphic to

ι( )((×
1 )1 × ×
2 × ×
3 )

ι( )((R×) × ×
2 × ×
3 )

,
which is a homomorphic image of
((×
1 )1 × ×
2 × ×
3 )

((R×) × ×
2 × ×
3 ) ∼= (×
1 )1/(R×).
The right side is compact by (∗∗), and therefore it is enough to prove that (††) is
compact.
Let us check that
ι( )((×
1 )1 × ×
2 × ×
3 ) = (×
1 × 2 × 3)1.
(‡)
The inclusion ⊆is immediate. Thus suppose that ((ωv)v∈S∞, (σv)v∈T , (δv)v/∈S)
lies in the right side of (‡).
Since (σv)v∈T lies in 2, there exists an ele-
ment π0 in  such that rv = ιv(π0)−1σv lies in Rv for all v ∈T .
De-
ﬁne (ω′
v)v∈S∞in ×
1 by ω′
v = ιv(π0)−1ωv.
For a suitable (δ′
v)v/∈S, we then
have ι(π0)((ω′
v)v∈S∞, (rv)v∈T , (δ′
v)v/∈S) = ((ωv)v∈S∞, (σv)v∈T , (δv)v/∈S), and (‡)
is proved.
Combining (‡) and (††), we see that it is enough to prove that
I1(S)

(×
1 × 2 × 3)1
(‡‡)
is compact. The inclusion of I1(S) into I(S) induces a homomorphism
I1(S)

(×
1 × 2 × 3)1 →I(S)

(×
1 × 2 × 3)
(§)
that is evidently one-one. But it is also onto because if v0 is an archimedean
place and if (xv)v is given in I(S), then we can adjust (xv0) in such a way that
the replacement (xv)v has absolute value 1. The adjustment is by a member of
×
1 × {1} × {1}, and thus (§) is onto. The right side of (§) is
(×
1 × 2 × 3)/(×
1 × 2 × 3) ∼= 2/2,
and we have arranged that this is compact. Consequently (‡‡) is compact, and
the proof is complete.
□

11. Problems
397
11. Problems
1.
If F is a complete ﬁeld with a nonarchimedean absolute value and if 	∞
n=1 an is
an inﬁnite series whose terms an are in F, prove that the series converges in F if
and only if limn an = 0.
2.
Let the 2-adic absolute value be imposed on Q. Theorem 6.5 shows that Z is
dense in the subring of Q consisting of all rationals with odd denominator.
(a) Find a sequence of integers converging in this metric to 1
3.
(b) Generalize the result of (a) by ﬁnding an explicit sequence of integers
converging in this metric to any given rational ab−1, where a and b are
nonzero integers with b odd.
3.
For the Dedekind domain R = Z and its ﬁeld of fractions K = Q, the ring of
units R× is just {±1}, and the set of archimedean places is just S∞= {∞}. The
formula ι(R×) = ι(K ×) ∩I(S∞) of Section 10 therefore becomes {ι(±1)} =
ι(Q×) ∩

R× × 
p Z×
p

.
(a) Verify this formula directly.
(b) Since Z is a principal ideal domain, the theory of Section 10 and the above
remarks show that I = ι(Q×)

R× × 
p Z×
p

. Prove this formula by an
explicit construction whose only allowable choice, in view of (a), is a certain
sign.
4.
Let R be the Dedekind domain Z[
√
−5 ].
(a) Verify for each choice of sign that the ideals (1±√
−5 , 3) and (1±
√
−5 , 2)
are prime and that (1 + √
−5 , 2) = (1 −
√
−5 , 2).
(b) Find the prime factorizations of the principal ideals (1 + √
−5 ) and (3).
(c) Let P be the prime ideal P = (1 +
√
−5 , 3), and let vP be the valuation of
R determined by P. Prove that vP

(1 +
√
−5 )/3

= 0.
(d) Lemma 6.3 shows that (1 +
√
−5 )/3 can be written as the quotient of two
members a and b of R with vP(a) = vP(b) = 0. Find such a choice of a
and b.
5.
Let v be a discrete valuation of a ﬁeld F, let Rv be the valuation ring, and let
Pv be the valuation ideal. It was observed after Proposition 6.2 that 1 + Pn
v is a
group under multiplication for any n ≥1. Prove for n ≥1 that the multiplicative
group (1 + Pn
v )/(1 + Pn+1
v
) is isomorphic to the additive group Pn
v /Pn+1
v
under
the mapping induced by 1 + x 	→x + Pn+1
v
.
6.
Derive the ﬁniteness of the class number of a number ﬁeld K from the compact-
ness of I1
K/ι(K ×) given as Theorem 6.53.
Problems 7–8 compare the topology on the ideles I = IK of a number ﬁeld K with
the topology of the adeles A = AK. The notation is as in Section 10.

398
VI. Reinterpretation with Adeles and Ideles
7.
For each ﬁnite set S of places containing the archimedean places, exhibit the
mappings I(S) →Kv for v ∈S and I(S) →Rv for v /∈S as continuous, and
deduce that the inclusion I →A is continuous.
8.
Let pn be the nth positive prime in Z, and let xn = (xn,v)v be the adele in AQ
with xn,v = pn if v = pn and xn,v = 1 if v ̸= pn. The result is a sequence {xn} of
ideles in IQ. Show that this sequence converges to the idele (1)v in the topology
of the adeles but does not converge in the topology of the ideles.
Problems 9–10 below assume knowledge from measure theory of elementary prop-
erties of measures and of the existence–uniqueness theorem for translation-invariant
measures (Haar measures) on locally compact abelian groups. The continuity in
Problem 10a requires making estimates of integrals.
9.
Let G be a locally compact abelian topological group with a Haar measure
written as dx, and let  be an automorphism of G as a topological group, i.e., an
automorphism of the group structure that is also a homeomorphism of G. Prove
that there is a positive constant a() such that d((x)) = a() dx.
10. Let F be a locally compact topological ﬁeld, and let F× be the group of nonzero
elements, the group operation being multiplication.
(a) Let c be in F×, and deﬁne |c|F to be the constant a() from the previous
problem when the measure is an additive Haar measure and  is multipli-
cation by c. Deﬁne |0|F = 0. Prove that c 	→|c|F is a continuous function
from F into [0, +∞) such that |c1c2|F = |c1|F|c2|F.
(b) If dx is a Haar measure for F as an additive locally compact group, prove
that dx/|x|F is a Haar measure for F× as a multiplicative locally compact
group.
(c) Let F = R be the locally compact ﬁeld of real numbers. Compute the
function x 	→|x|F. Do the same thing for the locally compact ﬁeld F = C
of complex numbers.
(d) Let F = Qp be the locally compact ﬁeld of p-adic numbers, where p is a
prime. Compute the function x 	→|x|F.
(e) For the ﬁeld F = Qp of p-adic numbers, suppose that the ring Zp of p-adic
integers has additive Haar measure 1. What is the additive Haar measure of
the maximal ideal I of Zp?
Problems 11–14 analyze the structure of complete valued ﬁelds whose residue class
ﬁelds are ﬁnite, showing that the only kinds are p-adic ﬁelds and ﬁelds of formal
Laurent series over a ﬁnite ﬁeld. Let F be a complete valued ﬁeld with a discrete
nonarchimedean valuation, let v be the valuation, let R be the valuation ring, and let
p be the maximal ideal of R. Suppose that the residue class ﬁeld R/p is ﬁnite of order
q = pm for a prime number p. Theorem 6.26 shows that the topology on F is locally
compact. The normalized absolute value on F corresponding to v is | · |F = q−v( · ).
For some purposes it is convenient to separate the equal-characteristic case for F
and R/p from the unequal-characteristic case.

11. Problems
399
11. Show in the unequal-characteristic case that F has characteristic 0.
12. (a) In both cases, use Hensel’s Lemma to show that F has a full set of (q −1)st
roots of unity and that coset representatives in F for R/p can be taken to
be these elements and 0. Denote this subset of q elements of F by E. The
subset E is of course closed under multiplication.
(b) Show in the equal-characteristic case that E is closed under addition and
subtraction and is therefore a subﬁeld of F isomorphic to Fq.
13. In the equal-characteristic case, write Fq for the subﬁeld of F constructed in
Problem 12b, and let t be a generator of the principal ideal p, so that v(t) = 1.
(a) Show that each nonzero element of R has a convergent inﬁnite-series ex-
pansion of the form 	∞
k=0 aktk with all ak in Fq and that the value of v on
such an element is the smallest k ≥0 such that ak ̸= 0.
(b) Show conversely that every series 	∞
k=0 aktk with all ak in Fq lies in R, and
conclude that R ∼= Fq[[t]].
(c) Deduce that F is isomorphic to the ﬁeld Fq((t)) of formal Laurent series
over Fq, the understanding being that each such series involves only ﬁnitely
many negative powers of t.
14. Let F be an arbitrary complete valued ﬁeld in the unequal-characteristic case.
Since Problem 11 shows F to be of characteristic 0, F contains a subgroup Q′
isomorphic as a ﬁeld to Q.
(a) Show that the integer q = pm in Q′ lies in p.
(b) Deduce that the number v0 = v(p) is positive.
(c) For each nonzero member ab−1 pk of Q′ for which a and b are integers
relatively prime to p, show that v(ab−1 pk) = kv0.
(d) Deduce that (Q′, | · |1/(mv0)
F
) is isomorphic as a valued ﬁeld to (Q, | · |p).
(e) Let Q′ be the closure of Q′ in F, and explain why (Q′, | · |1/m
F
) is isomorphic
as a valued ﬁeld to (Qp, | · |p).
(f)
Let t be a generator of p. With E as in Problem 12a, show that each member
of F has a unique series expansion 	∞
k=−N aktk with each ak in E and with
N depending on the element, and show furthermore that every such series
expansion converges to an element of F.
(g) Let c1, . . . , cl with l = qv0 be an enumeration of the elements 	v0−1
k=0 aktk
with all ak in E. Show that to each element x in R corresponds some cj such
that p−1(x −cj) lies in R. Deduce that every element of R is the sum of a
convergent series of the form 	∞
k=0 cjk pk.
(h) Explain how it follows from the previous part that F is a ﬁnite-dimensional
vector space over Q′, hence that F is a ﬁnite extension of the ﬁeld Qp.
Problems 15–19 continue the analysis in Problems 11–14 by examining ﬁnite sepa-
rable extensions of complete valued ﬁelds whose residue class ﬁelds are ﬁnite. The

400
VI. Reinterpretation with Adeles and Ideles
goal is to prove Proposition 6.38 and Lemmas 6.47 and 6.48. Let F be a complete
valued ﬁeld with a discrete nonarchimedean valuation, let R be the valuation ring, and
let p be the maximal ideal of R. Suppose that the residue class ﬁeld R/p is ﬁnite of
order q = pm for a prime number p. Let K be a ﬁnite separable extension of F, put
n = [K : F], and let T be the integral closure of R in K. Theorem 6.33 shows that
K is a valued ﬁeld, that it has a unique nonzero prime ideal P, that the valuation ring
of K is T , and that the valuation ideal is P. Write f for the dimension of T/P over
R/p, so that T/P has order q f . Also, write e for the power such that pT = Pe. It
is known from Chapter IX of Basic Algebra that n = ef . In the equal-characteristic
case, there is an especially transparent argument for proving Proposition 6.38, and
Problem 15 gives that. Problem 16 gives a less transparent argument that handles
both cases at once. The remaining problems address Lemmas 6.47 and 6.48.
15. In the equal-characteristic case, let E be the subset of q elements of F described
in Problem 12, and let E be the corresponding subset of q f elements of K.
Problem 13 shows that E is a ﬁeld isomorphic to Fq and that E is an extension
ﬁeld isomorphic to Fq f . Let t be a generator in R of p, and lett be a generator
in T of P. Problem 13 shows that F = Fq((t)) and that K = Fq f ((t )).
(a) Show that the set L of formal Laurent series in t with coefﬁcients from Fq f
is an intermediate ﬁeld between F and K, so that L = Fq f ((t)).
(b) Why does it follow that the integral closure of R in L is U = Fq f [[t]] and
that the maximal ideal of U is ℘= tU ?
(c) Deduce that the residue class ﬁeld of L is Fq f of order q f and that ℘T = Pe,
so that the residue class degree of L/F is f and the ramiﬁcation index of
K/L is e.
(d) How can one conclude that L/F is unramiﬁed and that K/L is totally
ramiﬁed?
16. In this problem no distinction is made between the equal-characteristic case and
the unequal-characteristic case. LetkF and kK be the residue class ﬁelds of F and
K, and write kK = kF(α), where α is a root of a monic irreducible polynomial
g(X) in kF[X]. Let g(X) be a monic polynomial in R[X] that reduces modulo
p to g(X).
(a) Prove that there exists α ∈T with α + P = α and with g(α) = 0.
(b) With α as in (a), let L be the intermediate ﬁeld between F and K given by
L = F(α), let U be the integral closure of R in L, let ℘be the maximal
ideal of U, and let kL = U/℘. Show that α lies in U and that the member
α of kK is in the image of the natural ﬁeld map kL →kK.
(c) Conclude from (b) that kL = kK.
(d) By comparing [L : K], the degrees of g(X) and g(X), and the indices e and
f for K/F and L/F, prove that L has the properties required by Proposition
6.38.

11. Problems
401
17. This problem applies to both the equal-characteristic case and the unequal-
characteristic case.
Let ξ be a member of T such that K = F(ξ), and let
g(X) = Xn + c1Xn−1 + · · · + cn be its minimal polynomial over F.
(a) Let N = 	n−1
k=0 Rξ k. This is a free R submodule of T of rank n with
{1, ξ, . . . , ξ n−1} as an R basis. Deﬁne
 N = {y ∈K | TrK/F(xy) is in R for all x ∈M}.
Put xi = ξ i−1 for 1 ≤i ≤n.
Why is there a unique yj in K with
TrK/F(xi yj) = δi j? Show that  N is a free R module with {y1, . . . , yn}
as R basis.
(b) If A is a matrix in Mn(R) with det A = ±1 and if zk = 	
j Ajk yj, why is
	n
k=1 Rzk = 	n
k=1 Ryk?
(c) Let K ′ be a splitting ﬁeld of g(X) over F, and let ξ1, . . . , ξn be the roots of
g(X) in K ′, with ξ1 = ξ. It is known from Basic Algebra that ξ1, . . . , ξn are
distinct. Prove that
n

i=1
g(X)
g′(ξi)(X −ξi) = 1
by observing that the difference of the two sides is a polynomial in X of
degree at most n −1 and all of ξ1, . . . , ξn are roots.
(d) Let σj be the ﬁeld map that ﬁxes F and carries F(ξ) into K ′ in such a way that
σj(ξ) = ξj. These mappings have the property that TrK/F(ξ) = 	n
j=1 σj(ξ)
for all ξ ∈K. If h(X) is in the ring K[[X]] of formal power series over K,
let hσj(X) be the polynomial obtained by applying σj to each coefﬁcient,
and extend TrK/F : K →F to a mapping of K[[X]] to F[[X]] by letting
TrK/F h(X) = 	n
j=1 hσj(X). By making the substitution X 	→1/X in (c)
and using the extended trace function just deﬁned, show that
Xn
1 + c1X + · · · + cn Xn = TrK/F

X
g′(ξ)(1 −ξ X)

.
(e) Write the identity in (d) out with power series, equate the coefﬁcients
of X, X2, . . . , Xn on the two sides, and deduce that TrK/F

ξ k−1g′(ξ)−1
equals 0 for 1 ≤k < n and equals 1 for k = n.
(f)
Form the n-by-n matrix A with Ai j = TrK/F

(ξ i−1g′(ξ)−1)(ξ j−1)

. The
result of (e) shows that this matrix has all entries equal to 0 that lie above
the off-diagonal i + j = n + 1 and all entries equal to 1 that lie on the
off-diagonal. By writing ξ i+ j−2 = ξ nξ i+ j−(n+1)−1 and by substituting for
ξ n, show that the remaining entries Ai j lie in R.
(g) Combine the conclusions of (a), (b), and (f) to prove that  N = g′(ξ)−1N.
18. This problem continues with the notation of Problem 17 and assumes in addition
that K/F is unramiﬁed, i.e., that f = n and e = 1. The objective is to prove the
assertion of Lemma 6.48 that D(K/F) = T .

402
VI. Reinterpretation with Adeles and Ideles
(a) Prove that the intermediate ﬁeld L constructed in Problem 16 is K itself,
that the polynomial g(X) is the minimal polynomial of α over F, and that
K = F(α).
(b) Let N = 	n−1
k=0 Rαk. Apply Problem 17 to obtain  N = g′(α)−1N. Using
the inclusion N ⊆T , deduce that  N ⊇ T , and conclude that D(K/F)−1 ⊆
g′(α)−1T .
(c) Prove that g′(α) is a unit in T , and deduce that D(K/F) = T .
19. This problem continues with the notation of Problem 17 and assumes in addition
that K/F is totally ramiﬁed, i.e., that e = n and f = 1. The objective is to prove
the assertion of Lemma 6.47 that D(K/F) = Pe′ with e′ equal to e −1 if p does
not divide e and with e′ ≥e if p divides e. Let E be the set of representatives in
R of the members of R/p as constructed in Problem 12. Since f = 1, the set E
is also a set of representatives in T of the members of T/P. Let vK and vF be the
respective discrete valuations of K and F, so that vF = nvK

F by Proposition
6.34. Let π and λ be respective generators of P and p.
(a) Prove that if M is a ﬁeld with a discrete valuation w and if x1, . . . , xm are
elements of M with x1 + · · · + xm = 0 and m ≥2, then the number of j’s
for which w(xj) = min1≤i≤m w(xi) is at least 2.
(b) Let g(X) = c0Xn + c1Xn−1 + · · · + cn with c0 = 1 be the ﬁeld polynomial
of π over F. Why are all the coefﬁcients cj in R, and why is vK(cj) divisible
by n for each j?
(c) Taking into account that π is a root of its ﬁeld polynomial and applying
(a), show that there exist integers i and j with 0 ≤i < j ≤n such that
j −i = vK(cj) −vK(ci) and that all other integers k with 0 ≤k ≤n have
vK(ckπn−k) ≥n.
(d) Using the divisibility conclusion of (b), show that g(X) is an Eisenstein
polynomial relative to p in the sense that c0 = 1, that all of c1, . . . , cn lie in
p, and that cn does not lie in p2.
(e) Conclude from (d) that g(X) is irreducible over F, that g(X) is the minimal
polynomial of π over F, and that K = F(π).
(f)
For each k ≥0, apply the division algorithm to write k = ni + j with
0 ≤j < n = e, and deﬁne yk = λiπ j. Show that every member of T has
a unique convergent series expansion as 	∞
k=0 ak yk and that all such series
expansions have sum in T .
(g) By rewriting the expansion in (f) suitably, show that {1, π, . . . , πn−1} is an
R basis for the free R module T .
(h) By applying Problem 17 with N = 	n−1
k=0 Rπk, prove that  T = g′(π)−1T ,
and deduce that D(K/F) = (g′(π)).
(i)
Computing g′(π) and applying the valuation v to it, show that v(g′(π)) =
e −1 if v(e) = 0 and that v(g′(π)) ≥e if v(e) > 0. Explain how this
conclusion proves Lemma 6.47.

CHAPTER VII
Inﬁnite Field Extensions
Abstract. Thischapterprovidesalgebraicbackgroundfordirectlyaddressingsomesimple-sounding
yet fundamental questions in algebraic geometry. All the questions relate to the set of simultaneous
zeros of ﬁnitely many polynomials in n variables over a ﬁeld.
Section 1 concerns existence of zeros. The main theorem is the Nullstellensatz, which in part
says that there is always a zero if the ﬁnitely many polynomials generate a proper ideal and if the
underlying ﬁeld is algebraically closed.
Section 2 introduces the transcendence degree of a ﬁeld extension. If L/K is a ﬁeld extension,
a subset of L is algebraically independent over K if no nonzero polynomial in ﬁnitely many of
the members of the subset vanishes. A transcendence basis is a maximal subset of algebraically
independent elements; a transcendence basis exists, and its cardinality is independent of the particular
basis in question. This cardinality is the transcendence degree of the extension. Then L is algebraic
over the subﬁeld generated by a transcendence basis. Brieﬂy any ﬁeld extension can be obtained by
a purely transcendental extension followed by an algebraic extension. The dimension of the set of
common zeros of a prime ideal of polynomials over an algebraically closed ﬁeld is deﬁned to be the
transcendence degree of the ﬁeld of fractions of the quotient of the polynomial ring by the ideal.
Section 3 elaborates on the notion of separability of ﬁeld extensions in characteristic p. Every
algebraic extension L/K can be obtained by a separable extension followed by an extension that is
purely inseparable in the sense that every element x of L has a power x pe for some integer e ≥0
with x pe separable over K.
Section 4 introduces the Krull dimension of a commutative ring with identity. This number is
one more than the maximum number of ideals occurring in a strictly increasing chain of prime ideals
in the ring. For K[X1, . . . , Xn] when K is a ﬁeld, the Krull dimension in n. If P is a prime ideal in
K[X1, . . . , Xn], then the Krull dimension of the integral domain R = K[X1, . . . , Xn]/P matches
the transcendence degree over K of the ﬁeld of fractions of R. Thus Krull dimension extends the
notion of dimension that was deﬁned in Section 2.
Section 5 concerns nonsingular and singular points of the set of common zeros of a prime ideal
of polynomials in n variables over an algebraically closed ﬁeld. According to Zariski’s Theorem,
nonsingularity of a point may be deﬁned in either of two equivalent ways—in terms of the rank of a
Jacobian matrix obtained from generators of the ideal, or in terms of the dimension of the quotient of
the maximal ideal at the point in question factored by the square of this ideal. The point is nonsingular
if the rank of the Jacobian matrix is n minus the dimension of the zero locus, or equivalently if the
dimension of the quotient of the maximal ideal by its square equals the dimension of the zero locus.
Nonsingular points always exist.
Section 6 extends Galois theory to certain inﬁnite ﬁeld extensions. In the algebraic case inverse
limit topologies are imposed on Galois groups, and the generalization of the Fundamental Theorem
of Galois Theory to an arbitrary separable normal extension L/K gives a one-one correspondence
between the ﬁelds F with K ⊆F ⊆L and the closed subgroups of Gal(L/K).
403

404
VII. Infinite Field Extensions
1. Nullstellensatz
Algebraic geometry studies the geometric properties of sets deﬁned by algebraic
equations.
In the simplest case some ﬁeld K is speciﬁed, the equations are
polynomial equations in several variables with coefﬁcients in K, and one seeks
solutions to the system of equations with the variables taking values in K or some
larger ﬁeld.
The nature of the subject is that even fairly simple-sounding geometric ques-
tions require algebraic background beyond what is in Basic Algebra and the
ﬁrst six chapters of the present book.
This chapter addresses the necessary
background, largely from the theory of ﬁelds, for addressing fundamental ques-
tions concerning existence of solutions, the dimension of the space of solutions,
singularity of the solution set at a particular point, and effects of changing ﬁelds.
The present section supplies background for the question of existence. We
have a system of polynomial equations in n variables with coefﬁcients in K, and
we are interested in simultaneous solutions in a given extension ﬁeld L of K. A
solution can be regarded as a column vector in Ln. Think of the equations as of the
form Fi(X1, . . . , Xn) = 0 with each Fi a polynomial, and then the set of solutions
is the locus of common zeros of the Fi’s in Ln. The locus of common zeros is
unaffected by enlarging the system of equations by allowing all equations of the
form 	
i Gi Fi = 0 with each Gi is arbitrary in K[X1, . . . , Xn]; thus we may as
well regard the left sides as all members of some ideal I in K[X1, . . . , Xn]. The
Hilbert Basis Theorem says that any ideal in K[X1, . . . , Xn] is ﬁnitely generated,
and hence studying the common zero locus for an ideal is always the same as
studying the common zero locus for a ﬁnite set of polynomials.
A proper ideal need not have a nonempty locus of common zeros. For example,
if K = R, then the single equation X2 + Y 2 + 1 = 0 has no solutions in R2.
Hilbert’s Nullstellensatz1 is partly the afﬁrmative statement that any proper ideal
has a nonzero locus of common zeros under the additional assumption that K is
algebraically closed.
Theorem 7.1 (Nullstellensatz). Let K be a ﬁeld, let K be an algebraic closure,
and let n be a positive integer. Then every maximal ideal J of K[X1, . . . , Xn]
has the property that K[X1, . . . , Xn]/J is a ﬁnite algebraic extension of K, and
in particular the maximal ideals of K[X1, . . . , Xn] are of the form
(X1 −a1, . . . , Xn −an),
where (a1, . . . , an) is an arbitrary member of K n. Consequently if I is any proper
ideal in K[X1, . . . , Xn], then
(a) the locus of common zeros of I in K n is nonempty,
1German for “zero-locus theorem.”

1. Nullstellensatz
405
(b) any f in K[X1, . . . , Xn] that vanishes on the locus of common zeros of
I in K n has the property that f k is in I for some integer k > 0.
Before coming to the proof, we mention an important corollary.
Corollary 7.2. Let K be a ﬁeld, let K be an algebraic closure, let n be a
positive integer, and let I be a prime ideal in K[X1, . . . , Xn]. Then I contains
every polynomial in K[X1, . . . , Xn] that vanishes on the locus of common zeros
of I in K[X1, . . . , Xn].
PROOF. If f is a member of K[X1, . . . , Xn] that vanishes on the locus of
common zeros of I, then (b) in the theorem shows that f k is in I for some k.
Since I is prime, one of the factors of f k = f · · · f lies in I.
□
EXAMPLE FOR COROLLARY. Let K = L = C, and let I be the principal ideal in
C[X, Y] generated by Y 2 −X(X + 1)(X −1). Consider C[X, Y] as isomorphic
to C[X][Y]. As a polynomial in Y over C[X], p(X, Y) = Y 2 −X(X +1)(X −1)
is irreducible because X(X + 1)(X −1) is not the square of a polynomial in X.
Since C[X, Y] is a unique factorization domain, p(X, Y) is prime. Therefore I =
(p(X, Y)) is a prime ideal. The corollary says that every polynomial vanishing
on the locus of points (x, y) ∈C2 for which y2 = x(x + 1)(x −1) is the product
of Y 2 −X(X + 1)(X −1) and a polynomial in (X, Y). Consequently the ring
of restrictions of polynomials to the locus for which y2 = x(x + 1)(x −1) is
isomorphic to C[X, Y]/

Y 2 −X(X + 1)(X −1)

.
Theorem 7.1b has a tidy formulation in terms of the “radical” of an ideal. If
R is a commutative ring with identity and I is an ideal in R, then the radical of
I, denoted by
√
I , is the set of all r in R such that rk is in I for some k ≥1. It is
immediate that the radical of I is an ideal containing I and that
√
I is proper if I
is proper. If I is an ideal in K[X1, . . . , Xn] and if f is in
√
I , then f k is in I for
some k > 0, and hence f vanishes on the locus of common zeros of I. Theorem
7.1b says conversely that any f vanishing on the locus of common zeros of I has
f k in I for some k > 0. This means that f is in
√
I . We can therefore rewrite
(b) in the theorem as follows:
(b′) the ideal of all f in K[X1, . . . , Xn] that vanish on the locus of common
zeros of I in K n is exactly
√
I .
The proof of Theorem 7.1 will follow comparatively easily from the following
two lemmas.
Lemma 7.3. If K is a ﬁeld and L is an extension ﬁeld that is generated as a
K algebra by n elements x1, . . . , xn, i.e., if L = K[x1, . . . , xn], then every xj is
algebraic over K.

406
VII. Infinite Field Extensions
REMARKS. Conversely if x1, . . . , xn are elements of an extension ﬁeld L that
are algebraic over K, then K(x1, . . . , xn) = K[x1, . . . , xn]. The reason is that
K(x1, . . . , xn) = K(x1, . . . , xn−1)(xn) = K(x1, . . . , xn−1)[xn]
= K(x1, . . . , xn−2)(xn−1)[xn] = K(x1, . . . , xn−2)[xn−1][xn]
= · · · = K[x1] · · · [xn−1][xn] = K[x1, . . . , xn].
PROOF. We proceed by induction on n. For n = 1, if L = K[x1], then we
know from the elementary theory of ﬁelds that x1 is algebraic over K.
For the inductive step, suppose that L = K[x1, . . . , xn]. Since L is a ﬁeld,
K(x1) ⊆L, and hence L = K(x1)[x2, . . . , xn]. By the inductive hypothesis
applied to L and K(x1), the elements x2, . . . , xn are algebraic over K(x1). To
complete the proof, it is enough to show that x1 is algebraic over K.
Fix j ≥2. The element xj, being algebraic over K(x1), satisﬁes a polynomial
equation
Xm + am−1Xm−1 + · · · + a0 = 0
witham−1, . . . , a0 in K(x1). Clearingfractions, weseethat xj satisﬁesanequation
bm Xm + bm−1Xm−1 + · · · + b0 = 0
with bm, . . . , b0 in K[x1] and bm ̸= 0. Multiplying through by bm−1
m
shows that
xj satisﬁes
(bm X)m + bm−1(bm X)m−1 + · · · + b0(bm)m−1 = 0,
and we see that bmxj is integral over the ring K[x1]. Let us write cj for the
element bm ∈K[x1] that we have just produced for this j.
In the case of j = 1, we can use m = 1 and a0 = −x1 in the above argument,
and we are then led to c1 = x1. If xl1
1 · · · xlnn is any monomial in K[x1, . . . , xn] and
if l is deﬁned as l = max(l1, . . . ,ln), then the fact that the integral elements over
K[x1] form a ring implies that (c1 · · · cn)lxl1
1 · · · xlnn is integral over K[x1]. Hence
for any f in K[x1, . . . , xn], (c1 · · · cn)l f is integral over K[x1] for a suitable
integer l = l( f ). Since K(x1) ⊆K[x1, . . . , xn], this conclusion applies in
particular to any member f of K(x1).
The ring K[x1] is a principal ideal domain and is therefore integrally closed
in its ﬁeld of fractions K(x1). For f in K(x1), we have seen that (c1 · · · cn)l f
is integral over K[x1] for some l = l( f ). The element (c1 · · · cn)l f is in K(x1),
and the integral-closure property therefore implies that (c1 · · · cn)l f is in K[x1].
Consequently there exists a ﬁxed element h of K[x1] such that every element f
of K(x1)isofthe form g/hl forsome g in K[x1]andsome integerl ≥0. We apply
this observation to f = q(x1)−1 for each irreducible polynomial q(X) in K[X],
and we obtain q(x1)g = hl with g and l depending on q(X). If x1 is transcen-
dental over K, this equality implies the polynomial identity q(X)g(X) = h(X)l.

1. Nullstellensatz
407
Consequently every irreducible polynomial q(X) divides h(X). If K is inﬁnite,
this is a contradiction because there are inﬁnitely many distinct polynomials X −a
in K[X]; if K is ﬁnite, this is a contradiction because there exists at least one
irreducible polynomial of each degree ≥1. We arrive at a contradiction in either
case, and therefore x1 is algebraic over K. This completes the induction and the
proof.
□
Lemma 7.4. Let K be a ﬁeld, and let L be an algebraic extension of K. If
I is a proper ideal in K[X1, . . . , Xn], then I L[X1, . . . , Xn] is a proper ideal in
L[X1, . . . , Xn].
REMARK. As usual, the notation I L[X1, . . . , Xn] refers to the set of sums of
products of elements of I and elements of L[X1, . . . , Xn].
PROOF. First let us identify the integral closure of K[X1, . . . , Xn] in the ﬁeld
L(X1, . . . , Xn) as L[X1, . . . , Xn]. The ring L[X1, . . . , Xn] is a unique factor-
ization domain, and Proposition 8.41 of Basic Algebra shows that it is integrally
closed. Consequently the integral closure of K[X1, . . . , Xn] in L(X1, . . . , Xn) is
contained in L[X1, . . . , Xn].
On the other hand, the integral closure of
K[X1, . . . , Xn] in L(X1, . . . , Xn) contains L because L/K is algebraic, and
it contains each X j.
Therefore it contains L[X1, . . . , Xn] and must equal
L[X1, . . . , Xn].
Now we apply Proposition 8.53 of Basic Algebra to the ring K[X1, . . . , Xn],
its ﬁeld of fractions K(X1, . . . , Xn), the extension ﬁeld L(X1, . . . , Xn), and
the integral closure L[X1, . . . , Xn] of K[X1, . . . , Xn] in L(X1, . . . , Xn). The
proposition says that if P is any maximal ideal of K[X1, . . . , Xn], then the ideal
PL[X1, . . . , Xn] is proper in L[X1, . . . , Xn]. This result is to be applied to any
maximal ideal P of K[X1, . . . , Xn] that contains I.
□
PROOF OF THEOREM 7.1. Let J be a maximal ideal in K[X1, . . . , Xn]. Then
L = K[X1, . . . , Xn]/J is a ﬁeld. Hence L = K[x1, . . . , xn] is a ﬁeld if the xi’s
are deﬁned by xi = Xi + J. Lemma 7.3 shows that each xj is algebraic over K,
and the ﬁrst conclusion of the theorem follows.
When this conclusion is applied to K instead of K, then the fact that K is
algebraicallyclosedimpliesthateachxj liesinthecosetsdeterminedby K, i.e., the
cosets of the constant polynomials. Consequently for each j, there is an element
aj in K such that xj −aj lies in J. Then it follows that (X1 −a1, . . . , Xn −an)
is contained in J. Since the ideal (X1 −a1, . . . , Xn −an) is maximal, J =
(X1 −a1, . . . , Xn −an).
This proves that the maximal ideals are as in the
displayed expression in the theorem.
To prove (a), we apply Lemma 7.4 to the ideal I in K[X1, . . . , Xn] and to the al-
gebraic extension K of K. The lemma produces a proper ideal of K[X1, . . . , Xn]

408
VII. Infinite Field Extensions
containing I, and we extend it to a maximal ideal J of K[X1, . . . , Xn]. From the
previous paragraph of the proof, J is of the form J = (X1 −a1, . . . , Xn −an) for
some (a1, . . . , an) in K n. The ideal J is therefore identiﬁed as the kernel of the
evaluation homomorphism of K[X1, . . . , Xn] at the point (a1, . . . , an). Every
member of J thus vanishes at (a1, . . . , an), and the same thing is true of every
member of I. This proves (a).
For (b), let I be a proper ideal in K[X1, . . . , Xn], and let f be as in (b). Intro-
duce an additional indeterminate Y, and let J be the ideal in K[X1, . . . , Xn, Y]
generated by I and f Y −1. If some point (x1, . . . , xn, y) lies on the locus of
common zeros of J in K n+1, then (x1, . . . , xn) lies on the locus of common zeros
of I in K n, since I ⊆J; thus f (x1, . . . , xn) = 0, since f is assumed to vanish
on all common zeros of I in K n. Consequently f (x1, . . . , xn)y −1 = −1 ̸= 0,
and we ﬁnd that f (X1, . . . , Xn)Y −1 does not vanish on the locus of common
zeros of J in K n+1, contradiction. We conclude that no point (x1, . . . , xn, y) lies
on the locus of common zeros of J in K n+1. By (a), we see that
J = K[X1, . . . , Xn, Y].
(∗)
Let us write X for the expression X1, . . . , Xn. Then (∗) implies that
1 =
r	
i=1
pi(X, Y)gi(X) + q(X, Y)( f (X)Y −1)
(∗∗)
for some g1, . . . , gr in I and some p1, . . . , pr and q in K[X, Y]. Let ψ be the
substitution homomorphism of K[X, Y] into K(X) that carries K into itself, X
into itself, and Y into f (X)−1. Application of ψ to (∗∗) gives
1 =
r	
i=1
pi(X, f (X)−1)gi(X),
(†)
since ψ

f (X)Y −1

= 0. If Y k is the largest power of Y that appears in any of
the polynomials pi(X, Y), then we can rewrite (†) as
f (X)k =
r	
i=1

f (X)k pi(X, f (X)−1)

gi(X)
and exhibit f (X)k as the sum of products of the members gi of I by members of
K[X]. Thus f (X)k is in I, and (b) is proved.
□
2. Transcendence Degree
Let K be a ﬁeld, and let L be an extension ﬁeld. The algebraic construction in
this section will show that L can be obtained from K in two steps, by a “purely
transcendental” extension followed by an algebraic extension. The number of

2. Transcendence Degree
409
indeterminates in the ﬁrst step (or the cardinality if the number is inﬁnite) will be
seen to be an invariant of the construction and will be called the “transcendence
degree” of L/K.
Before coming to the details, let us mention what transcendence degree will
mean geometrically. Suppose that the ﬁeld K is algebraically closed, suppose
that I is a prime ideal in K[X1, . . . , Xn], and suppose that V is the locus of
common zeros of I. Corollary 7.2 shows that I is the set of all polynomials
vanishing on V , and thus the integral domain K[X1, . . . , Xn]/I may be regarded
as the set of all restrictions to V of polynomials. If L is the ﬁeld of fractions of
K[X1, . . . , Xn]/I, then the transcendence degree of L/K will be interpreted as
the “number of independent variables” or “dimension” of the locus V .
Now we can make the precise deﬁnitions. Let K be a ﬁeld, and let L be
an extension ﬁeld. A ﬁnite subset x1, . . . , xn of L is said to be algebraically
independent over K if the ring homomorphism K[X1, . . . , Xn] →L given by
f 	→f (x1, . . . , xn) is one-one.2 Otherwise it is algebraically dependent.
EXAMPLE. Let K = C, and let p(X, Y) = Y 2 −X(X + 1)(X −1). The
principal ideal I = (p(X, Y)) was shown to be prime in C[X, Y] in the example
with Corollary 7.2. Therefore C[X, Y]/I is an integral domain. Let x and y be
the cosets x = X + I and y = Y + I. If L denotes the ﬁeld of fractions of
C[X, Y]/I, then we may regard x and y as members of L. The subset {x, y} of L
is algebraically dependent because the polynomial p(X, Y) maps to 0 under the
substitution homomorphism of C[X, Y] into L with X 	→x and Y 	→y.
A subset S of L is called a transcendence set over K if each ﬁnite subset of
S is algebraically independent over K. A maximal transcendence set over K is
called a transcendence basis of L over K. For each transcendence set S of L
over K, we write K(S) for the smallest subﬁeld of L containing K and S. If some
transcendence basis S has the property that K(S) = L, then L is said to be a
purely transcendental extension of K; in this case it follows from the deﬁnitions
that S is a transcendence basis of L over K.
EXAMPLE, CONTINUED. With K and L asintheexampleabove, thesets S = {x}
and S = {y} are transcendence sets over K = C. It is not hard to see that {x} is a
transcendence basis of L over K. Actually, if z is any member of L that is not in C,
then {z} is a transcendence set over C. The reason is that C is algebraically closed;
hence either z is transcendental over C or else z lies in C. Lemma 7.6 below shows
that any transcendence set of L over C can be extended to a transcendence basis,
and Theorem 7.9 shows that all transcendence bases of L over C have the same
cardinality. It follows that if z is any member of L that is not in C, then {z} is a
2By convention the empty set is algebraically independent over K.

410
VII. Infinite Field Extensions
transcendence basis of L over C and that every transcendence basis of L over C
is of this form. The two-element set {x, y} cannot be a transcendence set by this
reasoning, but we can see this conclusion more directly just by observing that
{x, y} was shown in the example above to be algebraically dependent.
Shortly we shall establish the existence of transcendence bases in general. If
S is a transcendence basis and if K ′ is deﬁned to be K(S), then we shall show
that L is algebraic over K ′. The subﬁeld K ′ of L depends on the choice of S, but
there is a uniqueness theorem: the cardinality of a transcendence basis of L/K
is independent of the particular transcendence basis.
Lemma 7.5. Let L/K be a ﬁeld extension, let S be a transcendence set of
L over K, let K(S) be the subﬁeld of L generated by K and S, and let x be an
element of L not in S. Then S′ = S ∪{x} is a transcendence set of L over K if
and only if x is transcendental over K(S).
PROOF. Suppose that x is transcendental over K(S) and is not in S. Let n
distinct elements x1, . . . , xn of S′ be given. If these are all in S, then f 	→
f (x1, . . . , xn) is one-one because S is a transcendence set. Suppose that one of
the n elements is x; say xn = x. If f is in the kernel of the homomorphism
f 	→f (x1, . . . , xn), i.e., if f (x1, . . . , xn) = 0, then x is a root of the polynomial
g(X) = f (x1, . . . , xn−1, X) in K(x1, . . . , xn−1)[X].
Since x is assumed to
be transcendental over K(S), the polynomial g must be 0. If we expand the
polynomial f in powers of X as
f (X1, . . . , Xn−1, X) = cl(X1, . . . , Xn−1)Xl + · · · + c0(X1, . . . , Xn−1),
the condition that g be 0 says that cj(x1, . . . , xn−1) = 0 for all j. Since the set
{x1, . . . , xn−1} is algebraically independent, we see thatcj = 0. Therefore f = 0.
Hence {x1, . . . , xn} is algebraically independent, and S′ is a transcendence set.
Conversely suppose that S′ is a transcendence set of L over K. We are to
show that the only polynomial F(X) in K(S)[X] such that F(x) = 0 is the 0
polynomial. Since only ﬁnitely many coefﬁcients of F are in question, we may
view F asin K({x1, . . . , xn})[X]forsomeﬁnitesubset{x1, . . . , xn}of S. Clearing
fractions, we can write F as
F(X) = d(x1, . . . , xn)−1
cl(x1, . . . , xn)Xl + · · · + c0(x1, . . . , xn)

for suitable polynomials d, c0, . . . , cl in K[X1, . . . , Xn] with d(x1, . . . , xn) ̸= 0.
Deﬁne
F(X1, . . . , Xn, X) = cl(X1, . . . , Xn)Xl + · · · + c0(X1, . . . , Xn).
The condition F(x) = 0 yields F(x1, . . . , xn, x) = 0. Since {x1, . . . , xn, x}
is by assumption algebraically independent over K, we see that F = 0. Thus
cj(X1, . . . , Xn) = 0 for all j, and consequently cj(x1, . . . , xn) = 0 for all j.
Therefore F = 0, as required.
□

2. Transcendence Degree
411
Lemma 7.6. If L/K is a ﬁeld extension, then
(a) any transcendence set of L over K can be extended to a transcendence
basis of L over K,
(b) any subset of L that generates L as a ﬁeld over K has a subset that is a
transcendence basis of L over K.
In particular, there exists a transcendence basis of L over K.
PROOF. For (a), order by inclusion upward the transcendence sets containing
the given one. To apply Zorn’s Lemma, we need only show that the union of a
chain of transcendence sets in L over K is again a transcendence set. Thus let
ﬁnitely many elements of the union of the sets in the chain be given. Since the sets
in the chain are nested, all these elements lie in one member of the chain. Hence
they are algebraically independent over K, and it follows from the deﬁnition that
the union of the sets in the chain is a transcendence set. By Zorn’s Lemma there
exists a maximal transcendence set, and this is a transcendence basis by deﬁnition.
For (b), we argue in the same way as for (a). Let the given generating set
be G. Order by inclusion upward the transcendence sets that are subsets of G.
The empty set is such a transcendence set. As with (a), the union of a chain of
transcendence sets in L over K is again a transcendence set, and the union is
contained in G if each individual set is. By Zorn’s Lemma there exists a maximal
transcendence subset S of G. To complete the proof, it is enough to show that
every member of G is algebraic over K(S). Let x be in G. We may assume that
x is not in S. By maximality, S ∪{x} is not a transcendence set. Then Lemma
7.5 shows that x is algebraic over K(S). Hence S is the required transcendence
basis.
For the ﬁnal conclusion we apply (a) to the empty set, which is a transcendence
set of L over K.
□
Theorem 7.7. If L/K is a ﬁeld extension, then there exists an intermediate
ﬁeld K ′ such that K ′/K is purely transcendental and L/K ′ is algebraic.
PROOF. Lemma 7.6 produces a transcendence basis S for L/K. Deﬁne K ′
to be the intermediate ﬁeld K(S) generated by K and S. Then K ′ is purely
transcendental over K by deﬁnition. If x is a member of L that is not in K ′, then
S ∪{x} is not a transcendence set of L over K by maximality of S, and Lemma
7.5 shows that x is algebraic over K(S) = K ′. Hence L is algebraic over K ′. □
As was mentioned earlier in the section, the intermediate ﬁeld K ′ with the
properties stated in the theorem is not unique. In the example above with K = C
and with L equal to the ﬁeld of fractions of C[X, Y]/

Y 2 −X(X + 1)(X −1)

,
K ′ can be any subﬁeld C(z) with z not in the subﬁeld C. For an even simpler
example, let K be arbitrary, and let L = K(x) be any purely transcendental

412
VII. Infinite Field Extensions
extension. Use of the transcendence basis {x} of L over K leads to K ′ = L in
the proof of Theorem 7.7. But {x2} is another transcendence basis, and for it we
have K ′ = K(x2). The extension L/K ′ is algebraic because x is a root of the
polynomial X2 −x2 in K(x2)[X].
We turn to the matter of showing that any two transcendence bases of L over
K have the same cardinality. We shall make use of the following result, which
was proved at the end of the appendix of Basic Algebra:
Let S and E be nonempty sets with S inﬁnite, and suppose that to
each element s of S is associated a countable subset Ex of E in such
a way that E = 
s∈S Es. Then card E ≤card S.
In our application of this result, the sets Ex will all be ﬁnite sets.
Lemma 7.8 (Exchange Lemma). Let L/K be a ﬁeld extension. If E is any
subset of L, let K(E) be the subﬁeld of L generated by K and E, and let K(E)
be the subﬁeld of all elements in L that are algebraic over K(E). If E ∪{x} and
E ∪{y} are ﬁnite transcendence sets of L over K and if x lies in K(E ∪{y}) but
not K(E), then y lies in K(E ∪{x}).
PROOF. The condition that x lie in K(E ∪{y}) implies that there exist a ﬁnite
subset {x1, . . . , xn} of E and a member f of K(X1, . . . , Xn, Y)[Z] such that
f (x1, . . . , xn, y, Z) ̸= 0
but
f (x1, . . . , xn, y, x) = 0.
(∗)
Clearing fractions, we may assume that f lies in K[X1, . . . , Xn, Y, Z]. Expand
f in powers of Y as
f (X1, . . . , Xn, Y, Z) =
l	
j=0
cj(X1, . . . , Xn, Z)Y j.
Since f (x1, . . . , xn, y, Z) ̸= 0 by (∗), at least one of the coefﬁcients, say
ci, has to satisfy ci(x1, . . . , xn, Z) ̸= 0.
Lemma 7.5 shows that x is tran-
scendental over K(E), and therefore ci(x1, . . . , xn, x) ̸= 0.
Consequently
f (x1, . . . , xn, Y, x) is nonzero.
Since f (x1, . . . , xn, y, x) = 0 by (∗), y is
algebraic over K({x1, . . . , xn, x}). Therefore y lies in K(E ∪{x}).
□
The statement of Lemma 7.8 deﬁnes an operation E 	→K(E) on subsets of L.
Because an algebraic extension of an algebraic extension is algebraic, applying
this operation a second time does nothing new: K

K(E)

= K(E). We shall
make use of this fact in the proof of Theorem 7.9 below.
Theorem 7.9. If L/K is a ﬁeld extension, then any two transcendence bases
of L over K have the same cardinality.

2. Transcendence Degree
413
REMARKS. The cardinality is called the transcendence degree of L/K. For
applications to algebraic geometry, the situation of interest is that this cardinality
is ﬁnite, but we give a complete proof of the theorem anyway.
PROOF. Firstsupposethat L/K hasaﬁnitetranscendencebasis B. Let|B| = n.
Let B′ be another transcendence basis, and let m = |B ∩B′|. We prove that
|B′| = |B| by induction downward on m. The base case of the induction is that
m = n. Then B ⊆B′, and we must have B = B′ by maximality of B.
For the inductive step, suppose that m < n and that |B′| = |B| whenever
|B ∩B′| ≥m + 1. We write the elements of B in an order such that B =
{x1, . . . , xn} and B ∩B′ = {x1, . . . , xm}. Lemma 7.5 shows that xm+1 is tran-
scendental over K(B −{xm+1}). Hence xm+1 does not lie in K(B −{xm+1}).
A second application of Lemma 7.5 shows that L = K(B′). The inclusion
B′ ⊆K(B −{xm+1}) is impossible because otherwise we would have
L = K(B′) ⊆K

K(B −{xm+1})

= K(B −{xm+1}).
Hence there exists an element y of B′ that does not lie in K(B −{xm+1}). A
third application of Lemma 7.5 shows that (B −{xm+1}) ∪{y} is a transcendence
set for L/K. Since y lies in L = K(B), the Exchange Lemma (Lemma 7.8)
shows that xm+1 lies in K

(B −{xm+1}) ∪{y}

. Consequently B is contained in
K

(B −{xm+1}) ∪{y}

, and L = K

(B −{xm+1}) ∪{y}

. A fourth application
of Lemma 7.5 shows that the transcendence set B1 = (B −{xm+1}) ∪{y} is a
transcendence basis. The set B1 has n elements, and the inclusion B1 ∩B′ ⊇
{x1, . . . , xm, y} shows that |B1 ∩B′| ≥m + 1. The inductive hypothesis shows
that |B′| = |B1|, and therefore |B′| = |B|. This completes the proof under the
assumption that L/K has a ﬁnite transcendence basis.
We may now suppose that L/K has no ﬁnite transcendence basis. Let B be a
transcendence basis of L/K; existence is by Lemma 7.6. To each element x of
L, we shall associate a canonical ﬁnite subset Ex of L.
Since the element x is algebraic over K(B), use of the ﬁeld polynomial of x
over K(B) shows that x is algebraic over K(E) for some ﬁnite subset E of B.
Let E0 be such a ﬁnite set E with the smallest cardinality; the set E0 will be
the canonical ﬁnite subset Ex that we seek. To show that E0 is canonical, we
show that whenever x lies in K(E) for some ﬁnite subset E of B, then E0 ⊆E.
Arguing by contradiction, suppose that y is a member of E0 that is not in E, and
deﬁne E1 = E0 −{y}. By minimality of |E0|, x does not lie in K(E1). However,
x does lie in K(E1 ∪{y}). Application of the Exchange Lemma shows that y
lies in K(E1 ∪{x}). Since
K(E1 ∪{x}) ⊆K

E1 ∪K(E)

⊆K

K(E1 ∪E)

= K(E1 ∪E),

414
VII. Infinite Field Extensions
y lies in K(E1 ∪E). Since y is in B but is not in E1 ∪E, Lemma 7.5 shows
that y is not algebraic over K(E1 ∪E), and we arrive at a contradiction. This
completes the proof that whenever x lies in K(E) for some ﬁnite subset E of B,
then E0 ⊆E. Hence E0 is canonical.
For each element x of L, we let Ex be the ﬁnite subset of B constructed in the
previous paragraph. Then we have a well-deﬁned map of L to the set of all ﬁnite
subsets of B given by x 	→Ex ⊆B. Now let B′ be a second transcendence basis
of L/K, and restrict the map from L to B′. Taking S = B′ and E = 
x∈B′ Ex
in the indented result quoted just before Lemma 7.8, we ﬁnd that
card
 
x∈B′ Ex

≤card(B′).
(∗)
On the other hand, any x in B′ lies in K(Ex) by deﬁnition of Ex. Hence B′ ⊆
K
 
x∈B′ Ex

. Applying the operation K( · ) to both sides gives
L = K(B′) ⊆K

K
 
x∈B′ Ex
 
= K
 
x∈B′ Ex

.
Since 
x∈B′ Ex is a subset of B and since a proper subset of B cannot be a
transcendence basis of L/K, we conclude that
B = 
x∈B′ Ex.
Consequently
card B = card
 
x∈B′ Ex

.
In combination with (∗), this equality implies that card B ≤card B′. Reversing
the roles of B and B′ gives card B′ ≤card B. Therefore card B = card B′ by the
Schroeder–Bernstein Theorem.3
□
3. Separable and Purely Inseparable Extensions
Thus far in this book, we have been interested in the detailed structure of algebraic
ﬁeld extensions only when they are separable.
For applications to algebraic
geometry, however, algebraic extensions that are not separable arise and even
play a special role. Thus it is essential to have some understanding of their
nature.
Let us review the material on separability in Section IX.6 of Basic Algebra.
Let K be a ﬁeld. A polynomial in K[X] is deﬁned to be separable if it splits
into distinct ﬁrst-degree factors in its splitting ﬁeld over K. Let L/K be an
algebraic extension of ﬁelds. An element of L is deﬁned to be separable over
K if its minimal polynomial over K is separable. Elements of L that fail to be
separable over K are called inseparable over K. The prototype of an inseparable
3A proof of the Schroeder–Bernstein Theorem appears in the appendix of Basic Algebra.

3. Separable and Purely Inseparable Extensions
415
element is the element a1/p in the extension k(a1/p), where k = Fp(a) is a simple
transcendental extension of the ﬁnite ﬁeld Fp. Corollary 9.31 of Basic Algebra
shows that the separable elements of L over K form a subﬁeld, and L/K is
deﬁned to be separable if every every member of L is separable over K. As
a consequence of Corollary 9.29 of Basic Algebra, we know that a separable
extension of a separable extension is separable.
One further tool from Basic Algebra is needed in order to handle the failure of
separability. This is Proposition 9.27, which says that an irreducible polynomial
f (X) in K[X] is separable if and only if f ′(X) is not the zero polynomial. It is
immediate that every irreducible polynomial is separable if K has characteristic 0.
Thus we need discuss only characteristic p in the remainder of this section.
The consequence of Proposition 9.27 for characteristic p is that an irreducible
polynomial f (X) fails to be separable over K if and only if the only powers of
X that appear with nonzero coefﬁcient in f (X) are the powers Xkp, i.e., if and
only if f (X) = g(X p) for some g in K[X].
In this case the polynomial g(X) is certainly irreducible in K[X], and we can
repeat this process. The polynomial g(X) fails to be separable over K[X] if and
only if g(X) = h(X p) for some h in K[X]. Then f (X) = h(X p2). Repeating
this process as many times as possible, we see that to each irreducible polynomial
f (X) in K[X] correspond a unique nonnegative integer e and a unique separable
irreducible polynomial g(X) such that f (X) = g(X pe). We call pe the degree of
inseparability of f (X) over K. From the deﬁnitions an element of an algebraic
extension of K is inseparable if and only if the degree of inseparability of its
minimal polynomial over K is greater than 1.
If L/K is an algebraic ﬁeld extension, then an element α of L is said to be
purely inseparable4 over K if α pμ lies in K for some integer μ ≥0. Let us see
in this case that the minimal polynomial of α over K is of the form X pe −α pe
for some e ≥0.
Proposition 7.10. If K is a ﬁeld of characteristic p and if α is a member of K
such that
p√α is not in K, then X pμ −α is irreducible in K[X] for every μ ≥0.
PROOF. Let L be a splitting ﬁeld of X pμ −α over K. If β is a root of X pμ −α,
then β pμ = α, and hence X pμ −α = X pμ −β pμ = (X −β)pμ.
Let f (X) be a monic irreducible factor of X pμ −α in K[X]. Let us see that
X pμ −α = f (X)n for some n. In fact, if the contrary were true, then there
would be a second monic irreducible factor g(X) of X pμ −α in K[X] relatively
prime to f (X). Then we can write u(X) f (X) + v(X)g(X) = 1 for suitable
4Warning: Not every element of L that is purely inseparable over K is inseparable over K. The
elements of K are counterexamples. Corollary 7.12 below shows that the elements of K are the only
counterexamples.

416
VII. Infinite Field Extensions
polynomials u(X) and v(X) in K[X]. As members of L[X], both f (X) and
g(X) have to be powers of X −β by unique factorization, and thus they both
vanish at β. Substitution of β into u f + vg = 1 therefore yields a contradiction.
Hence X pμ −α = f (X)n.
Since f (X) has to be (X −β)m for some m, we obtain X pμ −α = f (X)n =
(X −β)mn. The integers m and n must divide pμ. Thus m = pν, and f (X) =
(X −β)pν = X pν −β pν. Since f (X) is assumed to be in K[X], β pν lies in K. An
inequality ν < μ would imply that γ = (β pν)pμ−ν−1 lies in K; the pth power of
γ is α, however, and the hypothesis of the proposition says that such an element
γ cannot be in K. We conclude that ν = μ, and thus f (X) = X pμ −α. In other
words, X pμ −α is irreducible in K[X].
□
Corollary 7.11. If L/K is an algebraic extension in characteristic p, if α is
a purely inseparable element of L over K, and if e is the smallest nonnegative
integer such that α pe lies in K, then the minimal polynomial of α over K is
X pe −α pe.
PROOF. This is immediate from Proposition 7.10.
□
Corollary 7.12. If L/K is an algebraic extension in characteristic p and if α
is an element of L that is separable and purely inseparable over K, then α lies
in K.
PROOF. Since α is purely inseparable over K, Corollary 7.11 says that the
minimal polynomial of α over K is X pe −α pe, where e is the smallest nonnegative
integer such that α pe lies in K. The separability of α says that this polynomial
is separable. Unless pe = 1, the polynomial has derivative 0 and thus repeated
roots. Therefore pe = 1 and e = 0, and we conclude that α lies in K.
□
An algebraic ﬁeld extension L/K in characteristic p is said to be purely
inseparable if every element of L is purely inseparable over K. Since purely
inseparable elements α have minimal polynomials of the form X pe −α pe, the
degree of a purely inseparable extension has to be a power of p.
Theorem 7.13. If L/K is an algebraic ﬁeld extension in characteristic p and
if Ks is the subﬁeld of all elements of L that are separable over K, then L/Ks is
a purely inseparable extension.
PROOF. Let α be an element of L, and let f (X) be the minimal polynomial
of α over K.
Then we can write f (X) = g(X pe), where pe is the degree
of inseparability of f . The polynomial g(X) is irreducible over K, and it is
separable. Since α pe is a root, α pe is a separable element. Therefore α pe lies in
Ks. By deﬁnition of pure inseparability, α is purely inseparable over Ks. Since
α is arbitrary in L, L is purely inseparable over Ks.
□

3. Separable and Purely Inseparable Extensions
417
Corollary 7.14. Let R be a Dedekind domain, let F be its ﬁeld of fractions,
let K be a ﬁnite algebraic extension of F, and let T be the integral closure of R
in K. Then T is a Dedekind domain.
REMARKS. Thisresultisquiteimportant. ItwasusedextensivelyinChapterVI,
as was explained in the remarks with Proposition 6.7, and it plays a foundational
role in the theory of algebraic curves as presented in Chapters IX and X. Theorem
8.54 of Basic Algebra proved this result under the assumption that K is a ﬁnite
separable extension of F, and we are now dropping the hypothesis of separability.
Since K/F is automatically a separable extension in characteristic 0, we may
assume that the characteristic is not 0.
PROOF. Theorem 7.13 shows that K can be obtained in two steps from F,
a separable extension followed by a purely inseparable extension. The integral
closure of F in the separable extension ﬁeld is a Dedekind domain D by Theorem
8.54 of Basic Algebra, and the integral closure of D in K equals T by the
transitivity of integral closure. Consequently it is enough to prove the corollary
under the additional hypothesis that K is a purely inseparable extension of F.
What needs proof (in view of the statement of Theorem 8.54 of Basic Algebra)
is that T is Noetherian, i.e., that each ideal of T is ﬁnitely generated.
Let p be the characteristic. Since K/F is ﬁnite and purely inseparable, there
exists some power q = pm of p such that the ﬁeld K q is contained in F;
speciﬁcally, the integer q is to be large enough for the qth power of each element
of a vector-space basis of K over F to lie in F. We begin by proving that
T =

b ∈K | bq ∈R

.
(∗)
The inclusion ⊆follows, since b ∈T implies that bq is in T ∩F = R. For the
inclusion ⊇, let b ̸= 0 be in K. Corollary 7.11 shows that the minimal polynomial
of b over F is X pe −bpe, where e is the smallest integer ≥0 such that bpe lies in
F. Since K pm ⊆F, e ≤m. Thus b is a root of a polynomial X pm −a, where
a = bpm is a member of R. Consequently b is integral over R and must lie in T .
This proves (∗).
Fix an algebraic closure Kalg of K, and let H = Fq−1 denote the inverse image
of F under the qth power isomorphism of Kalg onto itself. This is a subﬁeld of
Kalg, and it contains K because K q ⊆F. Let S ⊆H be the ring of all b in H
with bq in R. Since x 	→xq is a ﬁeld isomorphism of H onto F, x 	→xq is a
ring isomorphism of S onto R. Therefore S is a Dedekind domain. It contains T
by (∗).
Let I be a nonzero ideal in T , and form the ideal J = SI in S generated by
I. Since S is Dedekind, J is invertible as a fractional ideal of H relative to S. If
J −1 denotes the inverse, then J −1 is a ﬁnitely generated S module in H such that

418
VII. Infinite Field Extensions
J −1J = S. Thus S = J −1J = J −1SI = J −1I. Accordingly, choose ﬁnite sets
{xi} in J −1 and {ai} in I such that 	 xiai = 1.
We shall show that {ai} is a set of generators of I as an ideal in T .
We
apply the qth power mapping to 	 xiai = 1, obtaining 	 xq
i aq
i = 1 with xq
i in
Hq = F ⊆K and with aq
i in Sq = R. Put bi = aq−1
i
xq
i . Then 	 xq
i aq
i = 1
implies that 	 aibi = 1; here ai is in I and bi is in I q−1K ⊆K. If a is in I, then
	 (bia)ai = a, and it is enough to show that bia is in T for each i, i.e., to show
that bi I ⊆T for each i.
The q-fold product (xi I) · · · (xi I) is contained in S because xi I ⊆J −1J = S.
Thus bi I = xq
i aq−1
i
I ⊆S. So bi I ⊆S ∩K. If s is any element in S ∩K, then
we know that r = sq is a member of R because Sq = R. Hence s is a root of
Xq −r with r in R. That is, s is integral over R. Since s also is in K, s lies in the
integral closure of R in K, which is T . Thus bi I ⊆T , and the proof is complete.
□
A ﬁeld K is perfect if either it has characteristic 0 or else it has characteristic
p and the ﬁeld map x 	→x p of K into itself is onto. Examples of perfect ﬁelds
include all ﬁnite ﬁelds, all algebraically closed ﬁelds, and of course all ﬁelds of
characteristic 0.
Proposition 7.15. A ﬁeld K is perfect if and only if every algebraic extension
of K is separable.
PROOF. We need to consider only the case that K has characteristic p. Suppose
that x 	→x p fails to be onto K. Choose β in K such that X p −β has no root
in K. Proposition 7.10 shows that X p −β is irreducible over K. Since this
polynomial has derivative 0, it is not separable. Thus X p −β is a polynomial that
is irreducible but not separable, and adjunction of a root of X p −β to K produces
an extension L of K that is not separable.
Conversely suppose that the ﬁeld map x 	→x p of K to itself is onto. Then
x 	→x pe is onto K for every e ≥0. Let L be an algebraic extension of K,
and let Ks be the subﬁeld of elements separable over K. If α is given in L,
then Theorem 7.13 shows that there exists a nonnegative integer e such that α pe
is in Ks. Let g(X) be the minimal polynomial of α pe over K, and write g(X) =
Xm + c1Xm−1 + · · · + cm. Since K is perfect, there exists bj for each j with
1 ≤j ≤m such that bpe
j
= cj. Put f (X) = Xm + b1Xm−1 + · · · + bm. Then
f (α)pe = (α pe)m + bpe
1 (α pe)m−1 + · · · + bpe
m = g(α pe) = 0,
and therefore f (α) = 0. Consequently f (X) divides the minimal polynomial of
α over K, and the fact that α pe lies in K(α) implies that
[K(α) : K] ≤deg f (X) = deg g(X) = [K(α pe) : K] ≤[K(α) : K].

3. Separable and Purely Inseparable Extensions
419
Equality must hold throughout, and therefore K(α) = K(α pe). Since K(α pe) is
contained in Ks, α lies in Ks. Therefore every member of L lies in Ks, and L is
separable over K.
□
A function ﬁeld in r variables over a ﬁeld K is a ﬁeld L that is ﬁnitely
generated over K and has transcendence degree r over K. A transcendence basis
{x1, . . . , xr} of such an extension L/K is called a separating transcendence
basis of L/K if L is a separable algebraic extension of K(x1, . . . , xr). If the
function ﬁeld L in r variables over K has a separating transcendence basis, we
say that L is separably generated over K.
The two kinds of ﬁelds of continual interest in Chapter VI were number ﬁelds
and function ﬁelds in one variable over a base ﬁeld. In the latter case some results
beginning in Section VI.6 assumed in effect that the function ﬁeld is separably
generated over the base ﬁeld. It was asserted at the beginning of Section VI.9 that
function ﬁelds in one variable over ﬁnite ﬁelds are always separably generated;
this assertion is a special case of Theorem 7.20 below.
Proposition 4.28 of Basic Algebra gave a version of the Factor Theorem valid
for all commutative rings with identity. For the present investigation we need a
version of the division algorithm that is valid in this wider context.
Lemma 7.16. Let R be a commutative ring with identity, let f (X) and g(X)
be members of R[X] of respective degrees m and n, and let a be the leading
coefﬁcient of g(X). For the integer k = max(m −n + 1, 0), there exist q(X) and
r(X) in R[X] such that
ak f (X) = g(X)q(X) + r(X)
with degr < n or r = 0.
PROOF. If m < n, then k = 0, and the displayed formula holds with q(X) = 0
and r(X) = f (X). For m ≥n −1, we proceed by induction on m. The base
case of the induction is m = n −1, which we have already handled. For the
inductive step, suppose that m ≥n. The integer k is m −n +1. If b is the leading
coefﬁcient of f (X), then af (X) −bXm−ng(X) is a polynomial that either is 0
or has degree less than m. The inductive hypothesis allows us to write
a(m−1)−n+1
af (X) −bXm−ng(X)

= g(X)q1(X) + r1(X)
with degr1 < n or r1 = 0. If we set q(X) = bam−n Xm−n + q1(X) and r(X) =
r1(X), then we obtain ak f (X) = g(X)q(X) + r(X), and the lemma follows. □
Lemma 7.17. Let L/K be a ﬁeld extension, let x1, . . . , xn, xn+1 be elements
of L, and suppose that x1, . . . , xn are algebraically independent over K but
that x1, . . . , xn, xn+1 are not algebraically independent. Then the ideal I of all
polynomials in K[X1, . . . , Xn+1] that vanish at (x1, . . . , xn+1) is principal with a
generator that is irreducible in K[X1, . . . , Xn+1] and involves Xn+1 nontrivially.

420
VII. Infinite Field Extensions
PROOF. The algebraic dependence implies that I contains nonzero polyno-
mials. Let g(X1, . . . , Xn, Xn+1) be one whose degree in Xn+1 is as small as
possible, say l. Expand g as
g = c0(X1, . . . , Xn)Xl
n+1 + c1(X1, . . . , Xn)Xl−1
n+1 + · · · + cl(X1, . . . , Xn).
The algebraic independence of X1, . . . , Xn implies that at least one ofc0, . . . , cl−1
is nonzero. Since K[X1, . . . , Xn] is a unique factorization domain, we can factor
out and discard the greatest common divisor of the coefﬁcients c0, . . . , cl. Thus
we may assume that g is primitive as a polynomial in Xn+1. If f is any element
in I, then Lemma 7.16 applied to the ring K[X1, . . . , Xn] allows us to write
ak f = gq + r with r = 0 or degr < k. Substituting (x1, . . . , xn+1), we see that
r is in I. The minimality of l implies that r = 0, and thus ak f = gq. Write c(h)
for the greatest common divisor of the coefﬁcients of a polynomial h. Taking
the greatest common divisor of the coefﬁcients on each side of ak f = gq and
applying Gauss’s Lemma, we obtain akc( f ) = c(q). Therefore ak divides q,
and we obtain f = gq0 for some q0. Consequently I is principal. If g = g1g2,
then the deﬁnition of I shows that at least one of g1 and g2 is in I, say g1. The
minimality of l implies that the degree of g1 in Xn+1 is l. Therefore g2 is in
K[X1, . . . , Xn]. Since g is primitive, g2 divides 1. Hence g2 lies in K.
□
Theorem 7.18 (Mac Lane). If L/K is a ﬁeld extension that is ﬁnitely generated
and separably generated, then any set of generators contains a subset that is a
separating transcendence basis of L/K.
PROOF. Let the characteristic be p. The proof is by induction on the tran-
scendence degree of the extension. For transcendence degree 0, the required set
is the empty set, and there is nothing to prove. The main step is transcendence
degree 1.
Thus let L = K(x1, . . . , xn), and suppose that {z} is a transcendence basis of
L over K such that L is separable over K(z). Since z is transcendental, z does not
lie in K(z p). Thus Proposition 7.10 shows that X p−z p is irreducible over K(z p),
and z is inseparable over K(z p). The ﬁeld L is algebraic over K(z p), and the
subset of separable elements over K(z p) is a subﬁeld. Since L = K(x1, . . . , xn)
and since z is a member of L that is not separable over K(z p), it follows that some
xi, say x1, is inseparable over K(z p). It will be proved that {x1} is a separating
transcendence basis of L over K, i.e., that x1 is transcendental over K and that L
is separable algebraic over K(x1).
We apply Lemma 7.17 with n = 2 to the elements z, x1. The lemma pro-
duces an irreducible polynomial f (Z, X) in K[Z, X] such that f (z, x1) = 0.
Gauss’s Lemma shows that this polynomial remains irreducible when considered
in K(Z)[X], and we have a ring isomorphism K(Z)[X] ∼= K(z)[X] because z is

3. Separable and Purely Inseparable Extensions
421
transcendental over K. Up to a nonzero factor from K(z), f (z, X) is the minimal
polynomial of x1 over K(z). Since L is separable over K(z), the element x1 is
separable over K(z), and its minimal polynomial over K(z) involves some power
of X that is not a power of X p.
Let us prove that x1 is transcendental over K. In the contrary case, let g(X)
be its minimal polynomial over K. Since g vanishes when X = x1 and Z = z,
g(X) satisﬁes an identity g(X) = q(Z, X) f (Z, X) in K[Z, X]. It therefore
satisﬁes the same identity in K(X)[Z]. Since g(X) is a unit in K(X)[Z], so is
f (Z, X). Therefore f (Z, X) is independent of Z. Since g(X) is the minimal
polynomial for x1 over K, g(X) = cf (Z, X) for some c in K. Since f (Z, X)
involves a power of X that is not a power of X p, the same thing is true of g(X),
and consequently x1 is separable over K. Therefore x1 is separable over the larger
ﬁeld K(z p), in contradiction to the deﬁning condition on x1. We conclude that
x1 is transcendental over K.
Since L has transcendence degree 1 over K, it follows that z is algebraic over
K(x1). Let us see that z is separable over K(x1). In fact, Gauss’s Lemma shows
that f (Z, X) remains irreducible when considered in K(X)[Z], and we have a
ring isomorphism K(X)[Z] ∼= K(x1)[Z] because x1 is transcendental over K.
Therefore f (Z, x1) is the product of a nonzero member of K(x1) and the minimal
polynomial m(Z) of z over K(x1). If z were inseparable over K(x1), then m(Z)
would be a polynomial in Z p, and we would have f (Z, X) = h(Z p, X) with
h in K[Z, X]. We know that f (Z, X) involves some power of X that is not a
power of X p, and hence the same thing is true of h(Z p, X). Since h(z p, X) is
irreducible in K[X], x1 is separable over K(z p), in contradiction to the deﬁning
property of x1. Therefore z is separable over K(x1).
The deﬁning property of z is that all xj are separable over K(z). Since z is
separable over K(x1), all of x2, . . . , xn are separable over K(x1). Therefore L
is separable over x1, and {x1} is a separable transcendence basis of L/K. This
completes the proof of the theorem for transcendence degree 1.
The inductive step is somewhat a formal consequence of what has just been
proved. To see this, suppose that the theorem is known for transcendence de-
grees 1 and r −1, and let L = K(x1, . . . , xn) have transcendence degree r.
The assumption is that L has a transcendence basis {z1, . . . , zr} such that L
is separable over K(z1, . . . , zr). Put K1 = K(z1). Then the set {z2, . . . , zr}
is a transcendence basis of L over K1 consisting of r −1 elements, and L is
separable over K1(z2, . . . , zr) = K(z1, . . . , zr) by assumption. By the inductive
hypothesis for the case of transcendence degree r −1, some subset of r −1
elements from among x1, . . . , xn forms a separating transcendence basis of L
over K1; let us say that this basis is {x1, . . . , xr−1}.
This implies that L is
separable over K1(x1, . . . , xr−1) = K(z1, x1, . . . , xr−1).
In other words, if
K ′ = K(x1, . . . , xr−1), then L = K ′(xr, . . . , xn) is separable over K ′(z1). Since

422
VII. Infinite Field Extensions
L/K ′ has transcendence degree 1, {z} is a separating transcendence basis of L/K ′.
By the inductive hypothesis for transcendence degree 1, some xj for r ≤j ≤n
forms a separating transcendence basis of L/K ′. For this j, {x1, . . . , xr−1, xj} is
then a separating transcendence basis of L/K.
□
Lemma 7.19. Suppose that L is a ﬁeld extension of transcendence degree r
over a ﬁeld K and that L is not separably generated over K. If x1, . . . , xn are
elements of L such that L = K(x1, . . . , xn), then for a suitable relabeling of the
xi’s, the subﬁeld K(x1, . . . , xr+1) of L is of transcendence degree r and is not
separably generated over K.
PROOF. We ﬁx K and r, and we proceed by induction on n. The base case is
that n = r +1, and then there is nothing to prove. For the inductive step, suppose
that the lemma has been proved for n −1 when n > r + 1. We prove the lemma
for n. Since r < n, we can renumber the xi’s and assume that K(x2, . . . , xn)
has transcendence degree r over K. If this ﬁeld is not separably generated over
K, then we are in a situation with n −1 elements. The inductive hypothesis is
applicable, and the lemma follows in this case.
Thus suppose that K(x2, . . . , xn) is separably generated over K. Theorem 7.18
shows that after a renumbering of the indices, we may assume that {x2, . . . , xr+1}
is a separating transcendence basis of K(x2, . . . , xn) over K. This implies that
K(x2, . . . , xn) is a separable extension of K(x2, . . . , xr+1). Since by assumption
L = K(x1, . . . , xn) is not separably generated over K, K(x1, . . . , xn) is not
separable over K(x2, . . . , xr+1). A separable extension of a separable extension is
separable, and we deduce that K(x1, . . . , xn) is not separable over K(x2, . . . , xn).
Thus x1 is inseparable over K(x2, . . . , xn) and is consequently inseparable over
the subﬁeld K(x2, . . . , xr+1). Hence K(x1, . . . , xr+1) is not separably generated
over K.
□
Theorem 7.20 (F. K. Schmidt). If K is a perfect ﬁeld, then every ﬁnitely
generated ﬁeld extension of K is separably generated over K.
REMARK. In particular, the theorem applies if K is a ﬁnite ﬁeld or is alge-
braically closed or has characteristic 0.
PROOF. Let K have characteristic p. We induct on the transcendence degree
of the ﬁeld extension of K. The base case of the induction is transcendence
degree 0, and then the theorem is handled by Proposition 7.15. For the inductive
step, assume that the theorem holds for all ﬁnitely generated ﬁeld extensions of
K having transcendence degree r −1 over K. Let L = K(x1, . . . , xn) have
transcendence degree r over K. Arguing by contradiction, suppose that L is not
separably generated over K. Lemma 7.19 shows for a suitable renumbering of the

4. Krull Dimension
423
xi’s that K ′ = K(x1, . . . , xr+1) has transcendence degree r and is not separably
generated over K.
We divide matters into two cases. First suppose that the transcendence degree
of K ′′ = K(x1, . . . , xr) is r −1. The inductive hypothesis shows that K ′′ is
separably generated over K, and then Theorem 7.18 shows that we may renumber
the variables in such a way that {x1, . . . , xr−1} is a transcendence basis of K ′′ over
K and K ′′ is separable algebraic over K(x1, . . . , xr−1). Then {x1, . . . , xr−1, xr+1}
is a transcendence basis of K ′, and xr is algebraic over K(x1, . . . , xr−1, xr+1).
Since xr is separable over K(x1, . . . , xr−1), it is separable over the larger ﬁeld
K(x1, . . . , xr−1, xr+1). Therefore K ′ is separably generated over K, contradic-
tion.
The remaining case is that every subset of r members of {x1, . . . , xr+1} is a
transcendence basis of K ′ over K. Lemma 7.17 produces an irreducible polyno-
mial f in K[X1, . . . , Xr+1] such that f (x1, . . . , xr+1) = 0. Since {x1, . . . , xr}
is a transcendence basis of K ′, application of Gauss’s Lemma shows that f is
irreducible in K(X1, . . . , Xr)[Xr+1] ∼= K(x1, . . . , xr)[Xr+1]. Hence up to a
nonzero factor from K, f (x1, . . . , xr, Xr+1) is the minimal polynomial of xr+1
over K(x1, . . . , xr). The failure of K ′ to be separably generated over K implies
that xr+1 is inseparable over K(x1, . . . , xr), and thus the only powers of Xr+1 that
appear in its minimal polynomial over K(x1, . . . , xr) are powers X pk
r+1. In other
words, f is in K[X1, . . . , Xr, X p
r+1]. Since we are assuming that any r of the
elements x1, . . . , xr+1 form a transcendence basis of K ′ over K, there is nothing
special about Xr+1 in this argument. Consequently f is in K[X p
1 , . . . , X p
r , X p
r+1].
Since K is perfect, any polynomial involving only pth powers of each indeter-
minate is the pth power of some polynomial. Consequently f is reducible in
K[X1, . . . , Xr+1], in contradiction to the irreducibility guaranteed by Lemma
7.17. All cases thus lead to a contradiction, and the proof is complete.
□
4. Krull Dimension
In this section we develop the algebraic background necessary for a discussion
of dimension. Suppose that K is an algebraically closed ﬁeld, suppose that I is
a prime ideal in K[X1, . . . , Xn], and suppose that V (I) is the locus of common
zeros of I. Corollary 7.2 shows that I is the set of all polynomials vanishing on
V (I), and thus the integral domain R = K[X1, . . . , Xn]/I may be regarded as
the set of all restrictions to V (I) of polynomials. If L is the ﬁeld of fractions
of R, then the transcendence degree of L/K is interpreted as the “number of
independent variables” on the locus V (I). We deﬁne it to be the dimension of
V (I). The elements X j + I of R for 1 ≤j ≤n generate R as a K algebra,
and therefore they generate L over K as a ﬁeld. We shall make critical use of

424
VII. Infinite Field Extensions
the fact implied by Lemma 7.6b that some subset of {X1 + I, . . . , Xn + I} is a
transcendence basis of L. We shall speak of such a subset as a transcendence
basis of R for economy of words. We denote its cardinality by tr. deg R.
EXAMPLE. We continue with the example from Sections 1–2. Let K = C,
let I be the principal ideal

Y 2 −X(X + 1)(X −1)

in C[X, Y], and let L
be the ﬁeld of fractions of the integral domain R = C[X, Y]/I.
Corollary
7.2 shows that the ring R is the ring of restrictions of polynomials to the locus
V (I) = {(x, y) ∈C2 | y2 = x(x +1)(x −1)}. According to the above deﬁnition,
the dimension of V (I) is the transcendence degree of L, which we have seen is 1.
This is in accord with the intuition that the locus V (I) is a “curve” in the sense
of having one independent complex parameter.
The goal of this section is to produce an equivalent deﬁnition of dimension
that does not depend on the fact that K[X1, . . . , Xn]/I is an integral domain.
The rephrased deﬁnition will extend to any commutative ring with identity and
is essential for modern algebraic geometry.
Let R be any commutative ring with identity. The Krull dimension of R,
denoted by dim R, is the supremum of the indices d of all strictly increasing
chains
P0 ⫋P1 ⫋· · · ⫋Pd
of prime ideals in R. We deﬁne dim R = ∞if there is no ﬁnite supremum.
EXAMPLES OF KRULL DIMENSION.
(1) R equal to a ﬁeld. The only prime ideal is 0. Thus the Krull dimension of
any ﬁeld is 0.
(2) R = Z. The prime ideals are of the form pZ for each prime number p,
together with 0. Each nonzero prime ideal is maximal. Consequently there is a
strictly increasing chain 0 ⫋pZ of prime ideals for each prime number p, but
there are no longer such chains. Thus dim Z = 1. More generally any principal
ideal domain R that is not a ﬁeld, or even any Dedekind domain R that is not a
ﬁeld, has dim R = 1 because every nonzero prime ideal is maximal.
(3) R commutative Artinian. In Chapter II a ring with identity was deﬁned to be
Artinian if its two-sided ideals satisfy the descending chain condition. Problem 8
at the end of that chapter showed that every prime ideal in such a ring is maximal.
In other words, every commutative Artinian ring has Krull dimension 0.
(4) Polynomial ring R = K[X1, . . . , Xn], where K is a ﬁeld. In geometric
terms for the case that K is algebraically closed, the relevant zero locus for this
R is K n, which we certainly want to have dimension equal to n, and the ﬁeld of
fractions of R is K(X1, . . . , Xn), which indeed has transcendence degree n. Let

4. Krull Dimension
425
us examine the Krull dimension of R. If 0 ≤k ≤n and if we form the ideal
(X1, . . . , Xk), then the ring isomorphism
R ∼= K[Xk+1, . . . , Xn][X1, . . . , Xk]
shows that the quotient R/(X1, . . . , Xk) is isomorphic to K[Xk+1, . . . , Xn],
which is an integral domain. Therefore (X1, . . . , Xk) is prime, and we have
a strictly increasing chain
0 ⫋(X1) ⫋· · · ⫋(X1, . . . , Xn−1) ⫋(X1, . . . , Xn).
So dim K[X1, . . . , Xn] ≥n. Actually, equality holds, as Theorem 7.22 will
show.
Lemma 7.21. Let R be a commutative ring with identity, let S−1R be the
localization relative to a multiplicative system S in R, let I be an ideal in R, and
let S be the image of S in R/I. Then
S−1R

S−1I ∼= S −1(R/I)
via the mapping s−1r + S−1I 	→(s + I)−1(r + I).
PROOF. Let q : R →R/I and ¯q : S−1R →S−1R/S−1I be the quotient
homomorphisms, and let η : R →S−1R and ¯η : R/I →S −1(R/I) be the
canonical homomorphisms of R and R/I into their localizations. To each of the
rings X1 = S−1R

S−1I and X2 = S −1(R/I) is associated a canonical map,
namely η1 : R →X1 and η2 : R →X2 with η1 = ¯qη and η2 = ¯ηq. Let
us see that the pairs (Xi, ηi) for i = 1, 2 have the following universal mapping
property with respect to ring homomorphisms ϕ of R into a commutative ring
T with identity such that ϕ(1) = 1, ϕ(I) = 0, and ϕ(S) ⊆T ×: there exists a
unique homomorphism ϕi : Xi →T such that ϕ = ϕiηi.
For i = 1, we ﬁrst apply the universal mapping property of the localization
S−1R to write ϕ = ϕ1η and then apply the universal mapping property of the
quotient to write ϕ = ϕ1 ¯qη. For i = 2, we ﬁrst apply the universal mapping
property of the quotient R/I to write ϕ = ϕ2q and then apply the universal map-
ping property of the localization to write ϕ = ϕ2 ¯ηq. From these constructions we
deduce existence and uniqueness of ϕi in both cases. The asserted isomorphism
then follows from the general fact that objects satisfying a universal mapping
property are unique up to isomorphism; tracking down that isomorphism gives
the explicit formula in the lemma.
□

426
VII. Infinite Field Extensions
Theorem 7.22. Let K be a ﬁeld, let R be an integral domain that is ﬁnitely
generated as a K algebra, and let L be the ﬁeld of fractions of R. Then the Krull
dimension of R equals the transcendence degree of L over K.
PROOF.
If x1, . . . , xn are generators of R as a K algebra, then R ∼=
K[X1, . . . , Xn]/I, where I is the ideal of all polynomials in K[X1, . . . , Xn]
that vanish at (x1, . . . , xn). The ideal I is prime, since R is assumed to be an
integral domain. Let r be the transcendence degree of L over K. We know from
Lemma 7.6b that some subset of {x1, . . . , xn} is a transcendence basis of L over
K; therefore r ≤n. To prove the theorem, we shall prove that r ≥dim R and
that r ≤dim R.
Suppose that P and Q are prime ideals of R with P ⊆Q. Then the identity
map on R descends to a K algebra homomorphism ϕ : R/P →R/Q.
If
αj = xj + P and βj = xj + Q are the images of xj under the respective quotient
maps R →R/P and R →R/Q, then {α1, . . . , αn} is a set of generators of R/P,
{β1, . . . , βn} is a set of generators of R/Q, and ϕ(αj) = βj for 1 ≤j ≤n. If r′ =
tr. deg R/Q, we may assume that {β1, . . . , βr′} is a transcendence basis of R/Q.
Then {α1, . . . , αr′} is an algebraically independent subset of R/P over K because
if f is a nonzero polynomial in K[X1, . . . , Xr′] such that f (α1, . . . , αr′) = 0,
then application of ϕ and use of the fact that ϕ ﬁxes each coefﬁcient of f yields
f (β1, . . . , βr′) = 0; the latter equation contradicts the algebraic independence of
{β1, . . . , βr′}. We conclude that
P ⊆Q
implies
tr. deg(R/P) ≥tr. deg(R/Q).
(∗)
To prove the inequality r ≥dim R, let a chain of prime ideals
0 ⊆P0 ⫋P1 ⫋· · · ⫋Pd
of R be given. We are to show that r ≥d. Abbreviate K[X1, . . . , Xn] as A, so
that R = A/I. Pull the chain of ideals of R back to a chain of ideals in A as
I ⊆P′
0 ⫋P′
1 ⫋· · · ⫋P′
d.
(∗∗)
Inequality (∗) shows that
tr. deg(A/P′
0) ≥tr. deg(A/P′
1) ≥· · · ≥tr. deg(A/P′
d).
(†)
Since taking P′
0 = I shows that tr. deg(A/I) = tr. deg(R) = r, every member of
(†) is ≤r. It will follow from (†) that r ≥d if we show that each inequality in
(†) is strict, i.e., that for prime ideals P and Q in A,
P ⫋Q
implies
tr. deg(A/P) > tr. deg(A/Q).
(††)

4. Krull Dimension
427
Since dim R is the supremum of the integers d as in (∗∗) and (†), proving (††)
will prove that r ≥dim R.
Thus let P and Q be prime ideals in A = K[X1, . . . , Xn] with P ⫋Q. Put
αj = X j + P and βj = X j + Q, so that the mappings of A to A/P and A/Q
are f (X1, . . . , Xn) 	→f (α1, . . . , αn) and f (X1, . . . , Xn) 	→f (β1, . . . , βn).
Then A/P = K[α1, . . . , αn] and A/Q = K[β1, . . . , βn]. As above, if r′ =
tr. deg A/Q, then we may assume that {β1, . . . , βr′} is a transcendence basis of
A/Q. Arguing by contradiction, we may assume that tr. deg A/P = tr. deg A/Q.
Then it follows that {α1, . . . , αr′} is a transcendence basis of A/P. We localize A
with respect to the multiplicative system S consisting of the complement of 0 in
K[X1, . . . , Xr′]. Then S−1A = K(X1, . . . , Xr′)[Xr′+1, . . . , Xn]. To understand
S−1P, we apply Lemma 7.21 to write
S−1A/S−1P ∼= S −1(A/P),
(‡)
where S is the image of S in A/P. The restriction to K[X1, . . . , Xr′] of the
map A →A/P carries f (X1, . . . , Xr′) to f (α1, . . . , αr′) and is one-one because
{α1, . . . , αr′} is a transcendence set. Therefore S ∩P = ∅, and S →S is
one-one. Corollary 8.48d of Basic Algebra shows from S ∩P = ∅that S−1P
is a proper ideal of S−1A. Since S →S is one-one, let us view S as S =
{ f (α1, . . . , αr′) | f ̸= 0}. Then
S −1(A/P) = K(α1, . . . , αr′)[αr′+1, . . . , αn].
(‡‡)
Since αr′+1, . . . , αn are algebraic over K(α1, . . . , αr′) because of the assumption
tr. deg A/P = tr. deg A/Q = r′, the remark with Lemma 7.3 shows that (‡‡) is
a ﬁeld. By (‡), S−1P is a maximal ideal. Arguing similarly with Q, we see that
S ∩Q = ∅and that S−1Q is a maximal ideal. From P ⊆Q, we have S−1P ⊆
S−1Q. Because S−1P and S−1Q are maximal, S−1P = S−1Q. Therefore Q ⊆
S−1P. Since Q properly contains P, we can choose g in Q that is not in P. This g
isanelementof K[X1, . . . , Xn]suchthat g(α1, . . . , αn) ̸= 0and g(β1, . . . , βn) =
0. From the inclusion Q ⊆S−1P, there exist an f in P and a nonzero s in
K[X1, . . . , Xr] with g = s−1 f . Then f = sg. Since f (α1, . . . , αn) = 0 and
s(α1, . . . , αr′)g(α1, . . . , αn) ̸= 0, we obtain a contradiction. This contradiction
proves (††) and shows that r ≥dim R.
The argument that r ≤dim R will proceed by induction on r. If r = 0, then
R = K[x1, . . . , xn] is a ﬁeld by the remark with Lemma 7.3, and dim R = 0 by
Example 1 of Krull dimension. Now suppose inductively that r > 0 and that the
inequality is known when tr. deg R < r. Put A = K[X1, . . . , Xn], and suppose
that R = A/I = K[x1, . . . , xn] with x1 transcendental over K. We localize A
with respect to the multiplicative system S consisting of the complement of 0

428
VII. Infinite Field Extensions
in K[X1]. Then S−1A = K(X1)[X2, . . . , Xn]. To understand S−1I, we apply
Lemma 7.21 to write
S−1A/S−1I ∼= S −1(A/I),
where S is the image of S in A/I. Arguing as in the previous paragraph, we see
that
S −1(A/I) ∼= K(x1)[x2, . . . , xn].
Combining these two isomorphisms, we see that S−1A/S−1I has transcendence
degree r −1 over K(x1). By the inductive hypothesis, S−1A/S−1I has Krull
dimension ≥r −1. Thus there exists a strictly increasing chain
S−1I = Q0 ⫋Q1 ⫋· · · ⫋Qr−1
of prime ideals in S−1A. If we put Pi = A ∩Qi for each i, then each Pi is prime
in A. From the theory of localization, we know that Qi is recovered from Pi by
Qi = S−1Pi, and thus we have a strictly increasing chain
I = P0 ⫋P1 ⫋· · · ⫋Pr−1
(§)
of prime ideals in A. The fact that Pr−1 is proper implies that S∩Pr−1 = ∅. That
is, no nonzero member of K[X1] lies in Pr−1. Consequently the image of X1
in A/Pr−1 is transcendental over K. The Nullstellensatz (Theorem 7.1) shows
that Pr−1 is not maximal in A. Hence the chain (§) can be extended by a strict
inclusion in a maximal ideal Pr, and r ≤dim A/I = dim R. This completes the
induction and the proof.
□
5. Nonsingular and Singular Points
In this section we develop the initial algebraic background necessary for a dis-
cussion of nonsingular and singular points. Unlike what happened in previous
sections, we shall not try to separate completely the algebra from the geometric
setting, because the points to be investigated are the actual points of a zero locus.
The motivation comes from the Implicit Function Theorem in the calculus of
several variables. In that setting, suppose that we havel numerical-valued smooth
functions f1, . . . , fl of n variables. Let k be an integer with 1 < k < n, and ab-
breviate (x1, . . . , xn) as (x, y), where x = (x1, . . . , xk) and y = (xk+1, . . . , xn).
Suppose that (x0, y0) has the property that fi(x0, y0) = 0 for 1 ≤i ≤l. The hope
is that there is a smooth vector-valued function y = g(x) deﬁned near x = x0
such that y0 = g(x0) and such that fi(x, y) = 0 for 1 ≤i ≤l with (x, y) near
(x0, y0) if and only if y = g(x), i.e., that the locus of common zeros of f1, . . . , fl
is locally the graph of a smooth function of k variables. According to the Implicit

5. Nonsingular and Singular Points
429
Function Theorem, a sufﬁcient condition for this to happen is that k + l = n and
that the (square) matrix of the ﬁrst partial derivatives at (x0, y0) of the fi’s for
1 ≤i ≤l with respect to the yj’s for k + 1 ≤j ≤n be invertible. A little more
generally but still with k + l = n, the locus of common zeros is locally the graph
of a smooth function of l of the variables in terms of the remaining k variables if
the matrix of all the ﬁrst partial derivatives of the fi’s has the maximum possible
rank, namely l.
Let us describe the setting for a comparable situation in algebraic geome-
try. Throughout this section we assume that K is an algebraically closed ﬁeld.
Suppose that I is a prime ideal in K[X1, . . . , Xn], and let V (I) be the locus of
common zeros5 of I in K n. The Hilbert Basis Theorem shows that I is ﬁnitely
generated over K as an ideal, and we let { f1, . . . , fl} be a set of generators.
Corollary 7.2 shows that I is the set of all polynomials vanishing on V (I), and
thus the integral domain R = K[X1, . . . , Xn]/I may be regarded as the set of all
restrictions to V (I) of polynomials in the following sense: if x = (x1, . . . , xn) is
a member of V (I) and f (X1, . . . , Xn) is in K[X1, . . . , Xn], then every member
of the coset f + I has the same value at x, and it is consequently meaningful to
write f (x) for f in R.
From Theorem 7.22 the transcendence degree over K of the ﬁeld of fractions
of R equals the Krull dimension of the ring R, and these numbers are what is
taken as the dimension of V (I) over K. We write dim V (I) for this dimension.
In this setting, a point x of V (I) is called a nonsingular point, or regular point,
if the matrix
 ∂fi
∂X j (x)

has rank equal to n −dim V (I). Otherwise x is a singular
point.
It is important to observe that these deﬁnitions do not depend on the choice of
the set { f1, . . . , fl} of generators of I. In fact, it is enough to show that the row
space of the matrix
 ∂fi
∂X j (x)

is exactly the space of all row vectors
 ∂f
∂X1
(x)
· · ·
∂f
∂Xn
(x)

for f ∈I,
since the latter space is manifestly independent of the choice of generators. To see
that the displayed space equals the row space of the matrix whose rank appears
in the deﬁnition of singular point, let g1, . . . , gn be arbitrary polynomials. Then
f = 	
i gi fi is the most general member of I. Use of the product rule and the
fact that fi(x) = 0 for each i shows that
∂f
∂X j (x) = 	
i gi(x) ∂fi
∂X j (x). Since the
gi are arbitrary, we can arrange for (g1(x), . . . , gn(x)) to be any given member
of K n. Thus the space of all row vectors
 ∂f
∂X1 (x)
· · ·
∂f
∂Xn (x) 
for f ∈I is
the set of all K linear combinations of row vectors
 ∂fi
∂X1 (x)
· · ·
∂fi
∂Xn (x) 
for
1 ≤i ≤l, as asserted.
5In terminology to be used in later chapters, one says that V (I) is the afﬁne variety corresponding
to I.

430
VII. Infinite Field Extensions
EXAMPLES.
(1) Irreducible afﬁne curve6 in K 2. Suppose that n = 2 in the notation
above and that I is nonzero and is generated by a single nonconstant polynomial
f (X, Y). The condition that I be prime is exactly the condition that f (X, Y)
be a prime polynomial. In turn, since K[X, Y] is a unique factorization domain,
the condition that f (X, Y) be prime is exactly the condition that f (X, Y) be
irreducible. Let us specialize to a case for which the ﬁrst partial derivatives take
an especially simple form: suppose that
f (X, Y) = Y 2 −h(X).
The only possible factorization is f (X, Y) = (Y + √h(X) )(Y −√h(X) ), and
thus f (X, Y) is irreducible in K[X, Y] if h(X) is not the square of a member
of K[X]. The relevant integral domain is R = K[X, Y]/( f (X, Y)), and we let
x = X + ( f (X, Y)) and y = Y + ( f (X, Y)). Then x is transcendental over
K, and the equation y2 = h(x) shows that y is algebraic over K(x). Hence
tr. deg R = 1, and the corresponding V (I) has dim V (I) = 1. If (x0, y0) is a
point of V (I), then the matrix of ﬁrst partial derivatives is
 ∂f
∂X
∂f
∂Y

(x0,y0) = ( −h′(X)
2Y )(x0,y0) .
The rank of this matrix is ≤1, and nonsingularity of (x0, y0) means that the
matrix has rank equal to 1. If the characteristic is ̸= 2, then the condition for a
singularity is that y2
0 = h(x0), y0 = 0, and h′(x0) = 0 simultaneously. Hence
V (I) is everywhere nonsingular7 if and only if h has no multiple roots in K.
(2) Irreducible afﬁne hypersurface8 in K n. For general n, again suppose that
I is a prime ideal generated by a single nonconstant polynomial f (X1, . . . , Xn).
The condition on f for I to be prime is that f be irreducible in K[X1, . . . , Xn].
The relevant ring is R = K[X1, . . . , Xn]/( f (X1, . . . , Xn)), and the image in R
of a polynomial g(X1, . . . , Xn) is 0 only if g is divisible by f , by Corollary
7.2.
The polynomial f is nonconstant in some X j, say for j = n.
Then
no nonzero polynomial g(X1, . . . , Xn−1) maps to 0 in R.
Consequently the
elements xi = Xi + ( f (X1, . . . , Xn)) have the property that {x1, . . . , xn−1} is
a transcendence set in R. The equation f (x1, . . . , xn) = 0 shows that xn is
algebraic over K(X1, . . . , Xn−1). Hence the corresponding V (I)hasdim V (I) =
tr. deg R = n −1. The nonsingular points of V (I) are the points of V (I) for
which some ﬁrst partial derivative of f is nonzero.
6Some authors include irreducibility in the deﬁnition of “afﬁne curve.” This book does not.
7If K has characteristic 2 and if x0 has the property that h′(x0) = 0, then we can choose y0 with
y2
0 = h(x0) because K is algebraically closed, and (x0, y0) will be a singular point. Hence V (I) is
everywhere nonsingular if and only if h has degree exactly 1.
8Some authors include irreducibility in the deﬁnition of “afﬁne hypersurface.” This book does
not.

5. Nonsingular and Singular Points
431
Theorem 7.23 (Zariski’s Theorem). With K algebraically closed, let I be a
prime ideal in K[X1, . . . , Xn], let R = K[X1, . . . , Xn]/I, and let V (I) be the
locus of common zeros of I in K n. If x = (x1, . . . , xn) is a point of V (I), deﬁne
mx to be the maximal ideal
mx = { f ∈R | f (x) = 0}
of R, let Rx be the localization of R with respect to mx, and let Mx be the maximal
ideal of Rx. Then
dimK(Mx/M2
x) = dimK(mx/m2
x) ≥dim V (I),
and x is nonsingular if and only if equality holds. The set of nonsingular points
of V (I) is nonempty.
REMARKS. We are going to prove for each point x of V (I) that
dimK(Mx/M2
x) = dimK(mx/m2
x)
and that
dimK(mx/m2
x) + rank
 ∂fi
∂X j

= n,
where { fi} is a ﬁnite set of generators of I. Since by deﬁnition x is nonsingular if
and only if rank
 ∂fi
∂X j

= n −dim V (I), it will follow that x is a nonsingular point
if and only if dimK(mx/m2
x) = dim V (I). Only for the special case that V (I) is an
irreducible afﬁne hypersurface do we prove that the inequality dimK(mx/m2
x) ≥
dim V (I) always holds for all x and that equality always holds for some x. The
general case will ultimately be reduced to the special case; we return to this matter
in Chapter X. The partial proof that we give in the present section will be preceded
by an example.
EXAMPLE 1, CONTINUED. Suppose that an afﬁne variety V in K 2 is obtained
from the irreducible polynomial f (X, Y) = Y 2 −h(X). Let us assume that K
has characteristic ̸= 2 and that (0, 0) lies in V . The latter condition means that
h(0) = 0. Let x = X + ( f (X, Y)) and y = Y + ( f (X, Y)). Since y2 = h(x),
any polynomial in (x, y) can be rewritten in such a way that the only powers of
y that occur are 0 and 1. Thus R = {p(x) + yq(x) | p ∈K[x], q ∈K[x]}, and
m(0,0) =

xp(x) + yq(x) | p ∈K[x], q ∈K[x]

.
The ideal m2
(0,0) consists of all sums of products of two elements of this kind.
From two polynomials xp(x), we can get any polynomial x2a(x); from xp(x)

432
VII. Infinite Field Extensions
and yq(x), we can get any xyb(x); and from two polynomials yq(x), we can get
any y2c(x) = h(x)c(x). Thus
m2
(0,0) =

x2a(x) + h(x)c(x) + yxb(x)

.
What happens depends on the ﬁrst-degree term in h(x). Examining the possibil-
ities, we see that
m2
(0,0) =
 {xa(x) + yxb(x)}
if h′(0) ̸= 0,
{x2a(x) + yxb(x)}
if h′(0) = 0.
Hence
m(0,0)/m2
(0,0) ∼=
 K y
if h′(0) ̸= 0,
K x + KY
if h′(0) = 0.
In other words, dimK m(0,0)/m2
(0,0) equals 1 if (0, 0) is nonsingular and equals 2 if
(0, 0) is singular. Since dim V (I) = 1, this result is consistent with the statement
of Theorem 7.23.
PARTIAL PROOF OF THEOREM 7.23. As mentioned in the remarks, one thing
that we are going to prove for each point x of V (I) is that
dimK(mx/m2
x) + rank
 ∂fi
∂X j

= n,
(∗)
where { f1, . . . , fl} is a ﬁnite set of generators of I.
Let Ix be the pullback to K[X1, . . . , Xn] of the ideal mx, i.e., let
Ix =

f | f + I ∈mx

=

f ∈K[X1, . . . , Xn] | f (x1, . . . , xn) = 0

.
The K linear mapping f 	→f + I carries Ix onto mx; composing with the
quotient mapping mx →mx/m2
x gives a K linear mapping ϕ of Ix onto mx/m2
x.
If f maps under ϕ to the 0 coset, then f + I = 	
j (gj + I)(hj + I) for suitable
polynomials gj and hj with gj + I and hj + I in mx. Then f −	
j gjhj lies in I,
and f is exhibited as a member of I 2
x + I. Conversely ϕ does carry I 2
x and I to
the 0 coset. Thus the kernel of ϕ is exactly I 2
x + I, and ϕ descends to a K linear
isomorphism Ix

(I 2
x + I) ∼= mx/m2
x. Therefore
dimK

Ix

(I 2
x + I)
 ∼= dimK(mx/m2
x).
(∗∗)
We deﬁne a K linear map θ of K[X1, . . . , Xn] to the space M1n(K) of all
n-dimensional row vectors over K by
θ( f ) =
 ∂f
∂X1 (x)
· · ·
∂f
∂Xn (x)

.

5. Nonsingular and Singular Points
433
Theproductrulefordifferentiationshowsthatθ(I 2
x ) = 0. Theideal Ix, considered
as a K vector space, is spanned by I 2
x and the various polynomials X j −xj. Since
θ(X j −xj) is the jth standard basis vector of M1n(K), the vectors θ(X j −xj)
form a basis of M1n(K).
Therefore θ descends to a K linear isomorphism
¯θ : Ix/I 2
x →M1n(K).
We observed just before Examples 1 and 2 that the vector space of all row
vectors θ( f ) for f ∈I equals the row space for the matrix
 ∂fi
∂X j

. Hence
dimK θ(I) = rank
 ∂fi
∂X j

.
Since θ(I) = ¯θ

(I + I 2
x )/I 2
x

and since ¯θ is one-one, this equality shows that
dimK

(I + I 2
x )/I 2
x

= rank
 ∂fi
∂X j

.
(†)
Adding (∗∗) and (†) gives
dimK(Ix/I 2
x ) = dimK(mx/m2
x) + rank
 ∂fi
∂X j

.
Since, as we have seen, Ix/I 2
x is isomorphic to M1n(K) via ¯θ, the left side is n,
and (∗) is proved.
The second thing that we are going to prove now is that
dimK(mx/m2
x) = dimK(Mx/M2
x).
(††)
If L is the ﬁeld of fractions of the integral domain R, then the localization Rx is the
subring of L of all quotients g/h with g and h in R and h(x) ̸= 0. The inclusion
mx ⊆Mx induces a K linear ring homomorphism ϕ : mx/m2
x →Mx/M2
x, and
(††) will follow if ϕ is shown to be one-one onto.
If g/h is given in Mx with g ∈mx and with h ∈R having h(x) ̸= 0, then the
decomposition
h(x)−1g = g
h +
 g
h
 h(x)−1h−1
1

exhibits h(x)−1g in mx as mapping to g/h + M2
x. Therefore ϕ is onto.
If g in mx maps to 	
i
 gi
hi
 g′
i
h′
i

in M2
x, then we can clear fractions and write
hg = 	
i gig′
ih′′
i for an element h of R with h(x) ̸= 0. Here 	
i gig′
ih′′
i is in m2
x.
The set of elements f in R such that f g is in m2
x is an ideal in R that contains mx
and that contains h. Since h is not in mx and since mx is maximal, this ideal in R
contains f = 1, and it follows that g is in m2
x. Consequently ϕ is an isomorphism,
and (††) is proved.
□

434
VII. Infinite Field Extensions
PROOF OF REMAINDER OF THEOREM 7.23 FOR IRREDUCIBLE AFFINE HYPER-
SURFACES. Let I be the principal ideal ( f (X1, . . . , Xn)), where f is irreducible.
We saw in Example 2 above that dim V (I) = n −1. The matrix that appears
in (∗) has only one row, corresponding to f , and hence it has rank 1 or rank 0.
Substituting this fact into (∗), we see that dimK(mx/m2
x) ≥n −1 = dim V (I).
Arguing by contradiction, suppose that strict inequality holds for every x in
V (I). Then
∂f
∂X j (x) = 0 for all x ∈V (I) and for all j. By Corollary 7.2, each
∂f
∂X j is the product of f and a polynomial. Since the degree of
∂f
∂X j in X j is less
than the degree of f in X j, it follows that
∂f
∂X j = 0 for all j. In characteristic 0,
this condition forces f to be constant and contradicts the assumption that f is
an irreducible polynomial (and in particular the assumption that f is not a unit).
In characteristic p, this condition forces each power of each X j that occurs in
f to be a multiple of p. That is, it says that f (X1, . . . , Xn) = g(X p
1 , . . . , X p
n ).
Let Fr : K →K be the ﬁeld map given by a 	→a p. This is onto K, since
K is algebraically closed. Hence there exists a polynomial h(X1, . . . , Xn) such
that hFr = g. Then f (X1, . . . , Xn) = g(X p
1 , . . . , X p
n ) =

h(X1, . . . , Xn)
p
exhibits f as reducible, contradiction. Hence strict inequality cannot hold for all
x ∈V (I), and some point of V (I) is nonsingular.
□
6. Inﬁnite Galois Groups
In this section, K denotes a ﬁeld, and Kalg denotes a ﬁxed algebraic closure of
K. We deﬁne Ksep to be the subﬁeld of all elements of Kalg that are separable
over K. The ﬁeld Ksep is called a separable algebraic closure of K. Theorem
7.13 shows that Kalg is a purely inseparable extension of Ksep. If F1 and F2 are
any ﬁelds with F1 ⊆F2, then the group of all ﬁeld automorphisms of F2 ﬁxing
F1 is denoted by Gal(F2/F1) and is called the Galois group of F2 over F1.
The purpose of this section is to extend the theory of Galois groups to handle
inﬁnite extensions. Such an extended theory has at least two important applica-
tions in the current context. A ﬁrst application is to developments in algebraic
number theory beyond what appears in Chapters V and VI. For example one way
of viewing traditional class ﬁeld theory for a number ﬁeld F is that one forms
Gal(Falg/F), deﬁnes the maximal abelian extension Fab of F to be the ﬁxed
ﬁeld of the closure of the commutator subgroup of Gal(Falg/F), and asks for a
description of Fab in terms of F. A second application is to the study of varieties
over ﬁelds that are not algebraically closed. If a ﬁeld K is given and a prime ideal
I in Kalg[X1, . . . , Xn] is speciﬁed by giving a ﬁnite set of generators, we can ask
whether the same ideal can be deﬁned via generators that lie in K. The given
generators have coefﬁcients in Kalg, and it is usually not obvious whether they

6. Infinite Galois Groups
435
can be adjusted to have coefﬁcients in K. However, if Galois theory is available,
then the question becomes whether the operation of each element of the Galois
group Gal(Kalg/K) carries each generator into a member of the ideal,9 and this
question is decidable by methods to be discussed in Chapter VIII. More generally
algebraic geometry from before 1960 frequently worked with a ﬁeld K and an
algebraically closed ﬁeld L that is larger than Kalg, for example with K = Q and
L = C. Under the assumption that K is perfect and L is algebraically closed,
Theorem 7.34 below shows that Gal(L/K) ﬁxes only the elements of K, and thus
Galois theory can still be used to decide in this situation whether a prime ideal in
L[X1, . . . , Xn] is generated by members of K[X1, . . . , Xn].
The deﬁnition of “normal ﬁeld extension” in Basic Algebra was limited to
suitable ﬁnite separable algebraic extensions. We now drop both the ﬁniteness
assumption and the separability assumption: A ﬁeld L with K ⊆L ⊆Kalg is
said to be a normal extension of K if there exists some nonempty family { fi}i∈S
of nonconstant polynomials in K[X] such that L is generated by K and all the
roots in Kalg of all the polynomials fi. More speciﬁcally all the polynomials fi
split in Kalg, say as fi(X) = ci
d(i)
j=1 (X −αi j), and L is to be the subﬁeld of
Kalg generated by K and all the roots αi j.
Proposition 7.24. The following conditions on a ﬁeld L with K ⊆L ⊆Kalg
are equivalent:
(a) L is a normal extension of K,
(b) Gal(Kalg/K) carries L to itself,
(c) any K isomorphism of L into Kalg carries L to itself,
(d) any polynomial f in K[X] that is irreducible over K and has one root in
L necessarily splits in L.
PROOF. If (a) holds, let L be generated by K and elements αi j as in the
paragraph before the proposition. If ϕ is in Gal(Kalg/K), then ϕ(αi j) is a root of
f ϕ
i = fi because fi has coefﬁcients in K. Hence αi j equals some αi j′. Thus ϕ
permutes the generators of L over K, and ϕ(L) = L. Therefore (b) holds.
If (b) holds, then any K ﬁeld map of L into Kalg extends to a K automorphism
of Kalg, by Theorem 9.23 of Basic Algebra. By (b), the extended mapping carries
L into itself. Thus (c) holds.
If (c) holds, let f in K[X] be irreducible over K, and suppose that x0 is a
root of f in L. Let x1 be another root of f in Kalg. By the uniqueness of
simple extensions, we know that there exists a K isomorphism ϕ0 : K(x0) →
K(x1) ⊆Kalg, and we can regard ϕ0 as a K ﬁeld map of K(x0) into Kalg. The
map ϕ0 extends to a K ﬁeld automorphism of Kalg, and we restrict the extension
9This condition is always necessary. For it to be sufﬁcient, one has to show that the only members
of Kalg ﬁxed by all elements of Gal(Kalg/K) are the members of K.

436
VII. Infinite Field Extensions
to a map ϕ : L →Kalg. By (c), ϕ(L) ⊆L. Since K(x0) ⊆L, we obtain
K(x1) = ϕ(K(x0)) ⊆ϕ(L) ⊆L. Thus x1 is in L, and (d) holds.
If (d) holds, then for each element xi of L, let fi be the minimal polynomial of
xi over K. Then certainly L is generated by K and the elements xi. By (d), each
fi splits in L. Therefore L is generated over K by all the roots of the polynomials
fi and is normal. Thus (a) holds.
□
Proposition 7.25. Every member of Gal(Kalg/K) carries Ksep into itself, any
two members of Gal(Kalg/K) that agree on Ksep are equal on Kalg, and any ﬁeld
map of Ksep into Kalg extends to an automorphism of Kalg. Consequently the
operation of restriction from Kalg to Ksep deﬁnes an isomorphism
Gal(Kalg/K) ∼= Gal(Ksep/K).
PROOF. The ﬁrst statement has three conclusions to it. For the ﬁrst conclusion,
if ϕ is in Gal(Kalg/K) and if x0 is in Ksep, let f be the minimal polynomial of x0
over K. By separability, f is a separable polynomial over K. Since ϕ ﬁxes f ,
ϕ carries x0 to some root x1 of f , and hence f is the minimal polynomial of x1
over K. Since f is a separable polynomial over K, x1 is separable over K and
lies in Ksep.
For the second conclusion, let ϕ be a member of Gal(Kalg/K) that is 1 on Ksep.
If x is in Kalg, then the pure inseparability of Kalg/Ksep implies that x pe = a for
some a ∈Ksep and some integer e ≥0. The element x has (X −x)pe =
X pe −x pe = X pe −a and hence is the unique root of X pe −a. Since ϕ(x) has
to be a root of this polynomial, ϕ(x) = x.
The third conclusion is a special case of the extendability to all of Kalg of any
ﬁeld mapping of a subﬁeld of Kalg into Kalg. For the displayed isomorphism
the ﬁrst conclusion shows that restriction carries Gal(Kalg/K) into Gal(Ksep/K),
the second conclusion shows that restriction is one-one, and the third conclusion
shows that restriction is onto.
□
Corollary 7.26. Let L be a ﬁeld with K ⊆L ⊆Ksep, form Gal(L/K), and
let LGal(L/K) be the ﬁxed ﬁeld
LGal(L/K) = {x ∈L | γ x = x for all x ∈Gal(L/K)}.
Then L is normal over K if and only if LGal(L/K) = K.
PROOF. Let L be normal over K, let x be in LGal(L/K), and let f be the minimal
polynomial of x over K. Since L is normal, f splits in L. Since L ⊆Ksep, the
roots of f in L all have multiplicity one. Arguing by contradiction, suppose
that x is not in K.
Then deg f > 1, and f has another root x1 besides x.

6. Infinite Galois Groups
437
Hence we can ﬁnd a K isomorphism ϕ : K(x) →K(x1) with ϕ(x) = x1. The
mapping ϕ extends to a ﬁeld automorphism of Kalg, and Proposition 7.24 shows
that ϕ(L) = L, since L is normal. Thus ϕ deﬁnes by restriction a member of
Gal(L/K). Since ϕ(x) = x1, we have a contradiction to the assumption that x is
in LGal(L/K) = K.
Conversely let LGal(L/K) = K.
Let x be in L, and let f be its minimal
polynomial over K. Let x1 = x and x2, . . . , xr be the distinct images of x in
L under members of Gal(L/K). These are all roots of f , and the roots of f
have multiplicity 1 because x lies in Ksep. Each member of Gal(L/K) permutes
x1, . . . , xr and hence acts via a permutation in the symmetric group Sr. Put
g(X) = r
i=1 (X −xi). Expanding g gives
g(X) = Xr −
 	
i
xi

Xr−1 +
 	
i< j
xixj

Xr−2 −· · · ±
 
i
xi

.
Each permutation of {x1, . . . , xr} ﬁxes the coefﬁcients of g(X), which are mem-
bers of L, and hence the coefﬁcients are in LGal(L/K) = K. Therefore g(X) is
in K[X]. Since g(x) = 0, f (X) divides g(X). Over L, g(X) splits. By unique
factorization in L[X], f (X) must split, too. By Proposition 7.24, L is normal
over K.
□
To obtain a version of the Fundamental Theorem of Galois Theory in the
present context, it is necessary to introduce a topology on each Galois group. An
example will illustrate.
EXAMPLE. Let K be the ﬁnite ﬁeld Fq, where q = pr for a prime p. If Ln
is a ﬁnite extension of K of degree n, then Proposition 9.40 of Basic Algebra
shows that Gal(Ln/K) is cyclic of order n, a generator being the Frobenius
element Frq deﬁned by Frq(x) = xq. The thing about the Frobenius element is
that it really makes sense on all Ln’s simultaneously. We know (from Proposition
7.15 for example) that every algebraic extension of K is separable, and hence
Ksep = Kalg. Here we can view Ksep as an aligned union of the ﬁelds Ln for
n ≥1, and Frq really makes sense as a member of Gal(Ksep/K) under the same
deﬁnition: Frq(x) = xq. On each Ln, some nonzero power of Frq is the identity,
but this is no longer true on the inﬁnite ﬁeld Ksep. Thus the mapping 1 	→Frq
extends to a one-one homomorphism of Z into Gal(Ksep/K). However, it is not
onto. Any element γ of Gal(Ksep/K) has the property that for each n, there is
a unique integer kn with 0 ≤kn < n such that γ

Ln = Frkn
q , and the sequence
{kn} determines γ ; nevertheless Problem 3 at the end of the chapter shows that
the sequence need not ultimately be constant, and therefore γ need not be in
the image of Z. The Galois group Gal(Ksep/K) is instead a certain topological
completion of Z that is usually denoted by  Z. Taking the topology into account

438
VII. Infinite Field Extensions
will be essential to extending the Fundamental Theorem of Galois Theory, since
Z and  Z are distinct subgroups of Gal(Ksep/K) that have the same ﬁxed ﬁeld,
namely K itself.
If L is a normal extension of K with L ⊆Ksep, we shall introduce a topology on
Gal(L/K) to make “close” mean “equal on a large ﬁnite-dimensional subspace.”
With this intuition as a guide, we could deﬁne a basic neighborhood of an element
γ0 of Gal(L/K) by taking ﬁnitely many elements α1, . . . , αn in K and forming
{γ ∈Gal(L/K) | γ αi = γ0αi for 1 ≤i ≤n}.
It is more useful, however, to deﬁne the topology in another way, and then it will
turn out that we indeed would have obtained a neighborhood basis by the above
deﬁnition. In any event, the topology turns out to be compact Hausdorff and to
make Gal(L/K) into a topological group.
The method we use will be to deﬁne the topology as an “inverse limit.” In-
verse limit is a general notion in category theory deﬁned by a universal mapping
property. As usual it consists of an object and a morphism; it need not exist in a
general category, but when it does exist, it is unique up to canonical isomorphism.
For the category of interest, the objects are the compact (Hausdorff) topological
groups, and the morphisms are continuous group homomorphisms. If we wanted
to emphasize the category-theory aspects of the construction, we would also need
products of this category with itself, but we shall not belabor this point.
Let I be a directed set, i.e., a nonempty partially ordered set under an ordering
≤such that for any a and b in I, there is an element c in I with a ≤c and b ≤c.
We allow ourselves to write b ≥a in place of a ≤b whenever convenient. Two
examples of directed sets of particular interest both have I = {1, 2, 3, . . . }; in
one case the ordering is given by a ≤b if a divides b, and in the other case the
ordering is given by the usual notion of inequality.
An inverse system (I, {Gi}, { fi j}) in the category of compact topological
groups consists of a directed set I, a system of compact topological groups Gi,
one for each i ∈I, and a system of continuous homomorphisms fi j : Gj →Gi,
deﬁned whenever i and j are in I with i ≤j, such that
• fii = 1 for all i ∈I,
• fi j ◦fjk = fik whenever i ≤j ≤k.
EXAMPLES.
(1) Let I = {1, 2, 3, . . . } with a ≤b meaning that a divides b. Let Ga be the
cyclic group Z/aZ of order a. Deﬁne fab : Gb →Ga to be the homomorphism
such that fab(1 + bZ) = 1 + aZ.
(2) Let I = {1, 2, 3, . . . } with the usual ordering. Fix a prime number p, and
deﬁne Ga to be the cyclic group Z/paZ of order pa. Deﬁne fab : Gb →Ga to
be the homomorphism such that fab(1 + pbZ) = 1 + paZ.

6. Infinite Galois Groups
439
An inverse limit (G, { fi}i∈I) of the inverse system (I, {Gi}, { fi j}), often
written G = lim
←Gi and sometimes also called the projective limit, consists
of a compact topological group G and continuous homomorphisms fi : G →Gi
such that
(i) fi j ◦fj = fi whenever i ≤j,
(ii) whenever (G′, { f ′
i }i∈I) is a pair consisting of a compact topological group
G′ andcontinuoushomomorphisms f ′
i : G′ →Gi suchthati ≤j implies
fi j ◦f ′
j = f ′
i , then there exists a unique continuous homomorphism
F : G′ →G such that fi ◦F = f ′
i for all i.
In the two examples the inverse limit group in the ﬁrst case is  Z; in the second
case the inverse limit is isomorphic to the additive group Zp of p-adic integers.
In the ﬁrst case we omit a description of the homomorphisms fa :  Z →Z/aZ. In
the second case the homomorphisms fa are easy to describe: fa : Zp →Z/paZ
is given by the composition of the quotient homomorphism Zp →Zp/paZp and
the isomorphism Zp/paZp →Z/paZ asserted by Theorem 6.26e.
Proposition 7.27. In the category of compact topological groups, an inverse
system (I, {Gi}, { fi j}) has at least one inverse limit, namely (G, { fi}i∈I) with
G =
(
(gi)i∈I ∈
i∈I
Gi
 fi j(gj) = gi whenever i ≤j
)
,
fi = restriction to G of the ith projection 
j
Gj →Gi.
REMARKS. It is to be understood from the statement that G gets the relative
topology from 
i∈I Gi. We refer to this (G, { fi}i∈I) as the standard inverse
limit of (I, {Gi}, { fi j}).
PROOF. If (gi)i∈I and (g′
i)i∈I are in G, then the fact that each fi j is a homomor-
phism implies that fi j(gjg′
j) = gig′
i and that fi j(g−1
j ) = g−1
i
. Therefore (gig′
i)i∈I
and (g−1
i
)i∈I are in G, and G is a group. The subset of Gi × Gj with fi j(xj) = xi
is topologically closed, and it follows that G is the intersection of closed sets and
hence is closed. Since 
j∈I Gj is compact Hausdorff, G is compact Hausdorff.
The continuity of the multiplication and inversion is a consequence of those
properties for 
j∈I Gj. The ith projection of 
j∈I Gj onto Gi is a continuous
homomorphism, and hence so is the restriction of this projection to G.
Condition (i) in the deﬁnition of inverse limit is immediate, and we have to
prove (ii).
Let (G′, { f ′
i }i∈I) be given with each f ′
i : G′ →Gi having the
property that i ≤j implies fi j ◦f ′
j = f ′
i .
For each g′ in G′, the I-tuple
( f ′
i (g′))i∈I is a member of 
i Gi, and the map g′ 	→( f ′
i (g′))i∈I is continuous
into the product topology because each entry is continuous.
If i ≤j, then

440
VII. Infinite Field Extensions
the tuple ( f ′
i (g′))i∈I has the property that fi j( f ′
j (g′)) = f ′
i (g′) because of the
given compatibility condition for the f ′
i ’s. Therefore the map F given by g′ 	→
( f ′
i (g′))i∈I has its image in the subset G of 
i Gi, and it is evidently a continuous
group homomorphism. The map F proves the existence assertion in (ii) because
fi ◦F(g′) = fi

( f ′
j (g′))j∈I

= f ′
i (g′).
For uniqueness, suppose that H : G′ →G is a continuous homomorphism
such that fi ◦H = f ′
i for all i. For each g′ ∈G′, we have fi(H(g′)) = f ′
i (g′).
Thus H(g′) is the member (gi)i∈I of 
i∈I Gi for which gi = f ′
i (g′) for all i.
Hence H is uniquely determined.
□
Proposition 7.28. In the category of compact topological groups, any two
inverse limits for an inverse system (I, {Gi}, { fi j}) are canonically isomorphic.
PROOF. This is a special case of the uniqueness in category theory of objects
having a speciﬁc universal mapping property, as established in Basic Algebra. □
It is important in applications that the inverse limit of an inverse system of
compact groups depend only on what happens far out in the directed set. We have
not yet used that the indexing set is a directed set, rather than merely a partially
ordered set, and we shall use this property now.
Corollary 7.29. Let I be a directed set, let j0 be in I, and let I ′ be the set of
members of I that are ≥j0. If (I, {Gi}, { fi j}) is an inverse system of compact
groups, then the two inverse systems (I, {Gi}, { fi j}) and (I ′, {Gi}, { fi j}) have
canonically isomorphic inverse limits, the isomorphism of the standard inverse
limit G ⊆
i∈I Gi onto the standard inverse limit G′ ⊆
i≥j0 Gi being given
by projection to the coordinates ≥j0.
PROOF. Let P : G →G′ be the projection, and let f ′
i : G′ →Gi for i ≥j0
be the associated maps. Certainly f ′
i ◦P = fi for i ≥j0. We shall extend the
deﬁnition of f ′
i to apply to all i ∈I. If i ∈I is given, we use the fact that I is
directed to choose i′ with i′ ≥i and i′ ≥j0. Deﬁne f ′
i = fii′ ◦f ′
i′. Let us see
that f ′
i is well deﬁned. Let i′′ have i′′ ≥i and i′′ ≥j0. Choose i′′′ with i′′′ ≥i′
and i′′′ ≥i′′. The computation
fii′′′ ◦f ′
i′′′ = fii′ ◦fi′i′′′ ◦f ′
i′′′ = fii′ ◦f ′
i′
shows that i′ and i′′′ yield the same deﬁnition of f ′
i , and a similar argument
shows that i′′ and i′′′ yield the same deﬁnition. Therefore i′ and i′′ yield the same
deﬁnition. Thus f ′
i is now deﬁned for all i in I.
We shall show that (G′, { f ′
i }i∈I) is an inverse limit of (I, {Gi}, { fi j}), and then
the corollary follows from Proposition 7.28. Property (i) of inverse limits is built
into the deﬁnition of the homomorphisms f ′
i . For property (ii) of G′, suppose that

6. Infinite Galois Groups
441
(
G, { fi}i∈I) is a pair consisting of a compact topological group 
G and continuous
homomorphisms fi : 
G →Gi such that i ≤j implies fi j ◦fj = fi. By (ii) for
existence with G, ﬁnd a continuous homomorphism F : 
G →G with fi ◦F = fi
for all i. Substituting from f ′
i ◦P = fi, we obtain f ′
i ◦(P ◦F) = fi, and this
says that P ◦F : 
G →G′ is the map we seek for the existence in (ii) for G′. For
uniqueness in (ii), suppose that F′ : 
G →G′ satisﬁes f ′
i ◦F′ = fi for all i. Then
f ′
i ◦F′ = f ′
i ◦(P ◦F) for i ≥j0. By (ii) for uniqueness with G′, F′ = P ◦F.
This says that the map from 
G to G′ in (ii) is unique.
□
Let us now apply these considerations to topologize Galois groups of inﬁnite
separable normal algebraic extensions. The topologized Galois group will be the
inverse limit of ﬁnite Galois groups, each with the discrete topology.10
We return to our ﬁeld K, its algebraic closure Kalg, and its separable algebraic
closure Ksep within Kalg. Let L be a ﬁeld with K ⊆L ⊆Ksep, and assume that
L/K is a normal extension, not necessarily ﬁnite. We shall topologize Gal(L/K).
Let x be any element of L, and let F be the ﬁnite extension F = K(x) of K. If
f is the minimal polynomial of x over K, then f has a root in L and must split in
L because L/K is normal. Let x1, . . . , xn be the roots of f , with x1 = x. Then
E = K(x1, . . . , xn) is a ﬁnite normal extension of K with K ⊆F ⊆E ⊆L.
Since x is arbitrary in L, L is the union of all the ﬁnite normal extensions of K
lying within L.
For each pair (E, E′) of normal extensions of K with K ⊆E ⊆E′ ⊆L,
Proposition 7.24 gives us restriction homomorphisms ϕE E′ : Gal(E′/K) →
Gal(E/K). We write ϕE for the special case that E′ = L, so that ϕEL = ϕE.
If K ⊆E ⊆E′ ⊆E′′ ⊆L, then ϕE E′ ◦ϕE′E′′ = ϕE E′′, and consequently the
system
-E ﬁnite normal
extension of K
in L

, {Gal(E/K)}, {ϕE E′}
.
is an inverse system of (discrete ﬁnite) topological groups. Meanwhile, we can
form the group Gal(L/K) and the system {ϕE} of homomorphisms with ϕE =
ϕEL.
Proposition 7.30.
With the above notation, the group Gal(L/K) may be
identiﬁed with the underlying abstract group of the inverse limit lim
L←E Gal(E/K),
taken over ﬁnite normal extensions E/K with E ⊆L, in such a way that the
homomorphisms ϕE become the homomorphisms of the inverse limit.
10The inverse limit of a ﬁnite group is called a proﬁnite group. Proﬁnite groups have special
properties by comparison with general compact groups, but it will not be necessary for us to undertake
a study of them.

442
VII. Infinite Field Extensions
PROOF. Let G = lim
L←E Gal(E/K), put G E = Gal(E/K), and regard G as the
standard inverse limit given as in Proposition 7.27:
G =

(γE)E ∈
E G E
 ϕE E′(γE′) = γE whenever E ⊆E′
.
For each E, we have a homomorphism ϕE : Gal(L/K) →G E, and the product
of the values of these deﬁnes a homomorphism  : Gal(L/K) →
E G E. The
relations ϕE E′ ◦ϕE′E′′ = ϕE E′′ show that the image of  is contained in the
subgroup G of 
E G E. We shall show that  : Gal(L/K) →G is one-one
onto.
Let us see that  is one-one. If γ ̸= 1 is in Gal(L/K), then there exists x ∈K
with γ (x) ̸= x. Let E be a ﬁnite normal extension of K within L containing x.
Then γ

E ̸= 1, and thus ϕE(γ ) ̸= 1. Hence (γ ) ̸= 1, and  is one-one.
Let us see that  is onto G. Let (γE)E ∈G be given. For x in L, choose a
ﬁnite normal E with x ∈E and E ⊆L, and deﬁne γ (x) = γE(x). The relations
among the ϕE E′ show that this deﬁnition of γ (x) is independent of the choice of
E, and γ is therefore a ﬁeld map of L into itself. Certainly γ ﬁxes K, and we
can construct an inverse to γ from the mappings γ −1
E . Thus γ is in Gal(L/K).
Application of  gives (γ ) = (ϕE(γ ))E = (γE)E, and  is onto.
□
Using Proposition 7.30, we transfer the topology from lim
L←E Gal(E/K) to
Gal(L/K), and we can now regard Gal(L/K) as a compact topological group.
For any ﬁnite normal extension F of K with F ⊆L, consider the group
Gal(L/F).
The inverse-limit topology identiﬁes Gal(L/K) with a subgroup
of 
E⊇K Gal(E/K), the product being taken over all ﬁnite normal extensions E
of K contained in L, and Corollary 7.29 allows us to identify Gal(L/K) with a
subgroup of

E⊇F
Gal(E/K),
the product being taken over all ﬁnite normal extensions E of F contained in L.
Under this identiﬁcation Gal(L/F) is identiﬁed with the subgroup of elements γ
of the image of Gal(L/K) for which ϕF(γ ) = 1. Since ϕF is continuous, this is
a closed set. In turn, this set equals the image of Gal(L/F) in the subset

E⊇F
Gal(E/F).
The latter gives the standard inverse limit topology on Gal(L/F). Except for
some details, the conclusion is as follows.

6. Infinite Galois Groups
443
Corollary 7.31. With the notation of Proposition 7.30, give Gal(L/K) the
inverse-limit topology. If F is a ﬁnite normal extension of K contained in L,
then Gal(L/F) is a closed subgroup of Gal(L/K), and the relative topology on
Gal(L/F) coincides with the inverse-limit topology of Gal(L/F). The subgroup
Gal(L/F) of Gal(L/K) is a normal subgroup of ﬁnite index in Gal(L/K). Being
a closed subgroup of ﬁnite index, it is an open subgroup.
PROOF. We still need to prove that Gal(L/F) has ﬁnite index in Gal(L/K).
Proposition 7.24 shows that the restriction to F of any member of Gal(L/K) is
an automorphism of F. Since F is a ﬁnite extension of K, there are only ﬁnitely
many possibilities for this automorphism. If two elements γ and γ ′ of Gal(L/K)
restrict to the same automorphism of F, then γ −1γ ′ is a member of Gal(L/K)
ﬁxing F, i.e., a member of Gal(L/F). Thus γ ′ lies in the coset γ Gal(L/F),
and we conclude that there are only ﬁnitely many cosets. Since every member of
Gal(L/K) restricts on F to an automorphism of F, the subgroup of members of
Gal(L/K) restricting to the identity on F is a normal subgroup. Thus Gal(L/F)
is normal in Gal(L/K).
□
Corollary 7.32. With the notation of Proposition 7.30, Gal(L/K) has a system
of open normal subgroups with intersection {1}. Hence the same thing is true of
any closed subgroup of T of Gal(L/K). Moreover, ifU is any open neighborhood
of 1 in T , then some open normal subgroup lies in U; consequently the open
normal subgroups of T form a neighborhood base about the identity.
PROOF. The open normal subgroups in the ﬁrst conclusion are the subgroups
Gal(L/F) as in Corollary 7.31. Since every member of L lies in some ﬁnite
normal extension of K within L, a member of Gal(L/K) cannot lie in every
Gal(L/F) unless it is the identity on L.
Let U be an open neighborhood of 1 in the closed subgroup T of Gal(L/K).
The set-theoretic complementU c ofU in T is a compact set, and the complements
of the open normal subgroups of T are open sets whose union covers U c, by the
result of the previous paragraph. By compactness ﬁnitely many complements of
open normal subgroups of T together cover U c. The intersection of these open
normal subgroups is then an open normal subgroup contained in U.
□
Theorem 7.33 (Fundamental Theorem of Galois Theory). Let K be a ﬁeld,
and let Kalg be an algebraic closure, so that K ⊆Ksep ⊆Kalg. Let L be a
normal extension of K lying in Ksep. Let S be the set of all closed subgroups of
Gal(L/K), and let F be the set of all intermediate ﬁelds between K and L. Then
F 	→Gal(L/F) is a one-one mapping of F onto S with inverse S 	→L S, L S
being the ﬁxed ﬁeld within L of the group S.
PROOF. First we show that Gal(L/F) is closed; Corollary 7.31 shows this only
when F is a normal extension of K. Let {Fα} be the set of all ﬁnite extensions

444
VII. Infinite Field Extensions
of K contained in F. Then F = 
α Fα, and thus Gal(L/F) = 
α Gal(L/Fα).
Each Fα is contained in a ﬁnite normal extension Eα of K lying in L, and hence
Gal(L/Fα) ⊇Gal(L/Eα). Corollary 7.31 shows that Gal(L/Eα) is an open
subgroup of Gal(L/K), and hence the larger subgroup Gal(L/Fα) is open (as
a union of cosets, each of which is open). Open subgroups are closed. Thus
Gal(L/Fα) is closed, and so is Gal(L/F) = 
α Gal(L/Fα).
Next if F is in F, then the inclusion L ⊇F and the fact that L is normal over
K together imply that L is normal over F. By Corollary 7.26, F = LGal(L/F).
Hence F 	→Gal(L/F) is one-one, and S 	→L S is a left inverse of it.
Finallyweshowthat S 	→L S isarightinversebyshowingthatGal(L/L S) = S
for any closed subgroup S of Gal(L/K). Deﬁne T = Gal(L/L S). Certainly
S ⊆T . The previous step shows that F = LGal(L/F) for all F ∈F. Taking
F = L S gives L S = LGal(L/L S) = LT . Let V be an arbitrary open normal
subgroup of T , and put E = LV .
The members of T/V give well-deﬁned
automorphisms of E, and
ET/V = (LV )T/V = LT = L S = (LV )SV/V = E SV/V .
(∗)
The group T/V is a ﬁnite group of automorphisms of E ﬁxing K, and Corollary
9.37 of Basic Algebra, when applied to the group T/V and the separable extension
E/ET/V , shows that T/V = Gal(E/ET/V ). Similarly it shows that SV/V =
Gal(E/E SV/V ). By (∗), T/V = SV/V , i.e., T = SV . Corollary 7.32 shows
that the open normal subgroups of T form a neighborhood base about the identity
of T . From the equality T = SV for arbitrary V , let us see that
S is dense in T .
(∗∗)
Arguing by contradiction, let g be in T but not in the closure of S. Find V small
enough so that gV −1 ∩S = ∅. From T = SV , we can write g = sv with s ∈S
and v ∈V . Then svV −1 ∩S = ∅, and hence vV −1 ∩S = ∅. This last equality
is a contradiction, since the identity lies in vV −1, and (∗∗) is proved. Since S
is closed, it follows from (∗∗) that S = T . But T = Gal(L/L S) by deﬁnition.
Therefore Gal(L/L S) = S, and the proof of the theorem is complete.
□
Theorem 7.34. Let K be a perfect ﬁeld, and L be an algebraically closed ﬁeld
containing K. Then the only members of L ﬁxed by every element of Gal(L/K)
are the members of K.
PROOF. Proposition 7.15 shows that Ksep = Kalg, and Corollary 7.26 implies
that the only members of Kalg ﬁxed by Gal(Kalg/K) are the members of K. Thus
we are done unless L contains elements not in Kalg.
Let x and y be any two members of L not in Kalg, and let ψ be in Gal(Kalg/K).
The singleton sets {x} and {y} are transcendence sets over Kalg, and Lemma 7.6

7. Problems
445
shows that they can be extended to transcendence bases of L over Kalg. Call
these transcendence bases E and F, respectively. Theorem 7.9 shows that E and
F have the same cardinality. Therefore there exists a one-one function ϕ of E
onto F such that ϕ(x) = y. This function ϕ extends uniquely to a ﬁeld map
 of Kalg(E) onto Kalg(F) that restricts to ψ on Kalg. Theorem 7.7 shows that
L is an algebraic extension of Kalg(E) and of Kalg(F); hence L is an algebraic
closure of Kalg(E) and of Kalg(F). The composition of  followed by inclusion
is a ﬁeld map of Kalg(E) into L, and Theorem 9.23 of Basic Algebra shows that
it can be extended to a ﬁeld map  of L into L. Since (L) is an algebraic
closure of Kalg(F), (L) = L. Thus there exists a member  of Gal(L/Kalg)
with (x) = y such that 

Kalg = ψ.
Taking ψ to be the identity shows that no element of L transcendental over K
is ﬁxed by Gal(L/K). If an element z of Kalg is given that is not in K, then the
ﬁrst paragraph of the proof produces a member ψ of Gal(Kalg/K) that moves z.
Applying the result of the second paragraph to this ψ with x arbitrary and with
y = x shows that ψ extends to a member of Gal(L/K) that moves z.
□
7. Problems
1.
Let L/K be a ﬁeld extension in characteristic p. Prove that the set of elements
of L that are purely inseparable over K is a subﬁeld of L.
2.
In characteristic p, let K(α) be an algebraic extension of a ﬁeld K, and form the
inclusions K ⊆K(α pe) ⊆K(α), where α pe is the smallest power of α that is
separable over K. Prove that the subﬁeld of separable elements in the extension
K(α)/K consists exactly of K(α pe), i.e., that no separable elements of K(α)
over K lie outside K(α pe).
3.
Partially order the positive integers by saying that a ≤b if a divides b. Let
( Z, { fa}a≥1) be the inverse limit of the cyclic groups Z/aZ, with the homomor-
phism fab from Z/bZ to Z/aZ being given by fab(1 + bZ) = 1 + aZ when a
dividesb. Eachmemberc ofZdeﬁnesamember zc of Zsuchthat fa(zc) = c+aZ
for all a. Exhibit some other explicit member of  Z.
4.
Prove that the only members of C ﬁxed by all members of Gal(C/Q) are the
members of Q. What members of R are ﬁxed by Gal(R/Q)?
5.
By making use of the ﬁeld K = Q(
√
2,
√
3,
√
5,
√
7, . . . ), show that there exist
subgroups of Gal(Qalg/Q) of index 2 that are not open.
Problems 6–14 concern primary ideals and make use of the notion of the radical
√
I
of an ideal I as deﬁned in Section 1. Throughout, R will denote a commutative ring
with identity. A proper ideal I of R is primary if whenever a and b are in R, ab is

446
VII. Infinite Field Extensions
in I, and a is not in I, then bm is in I for some integer m > 0. It is immediate that
every prime ideal is primary.
6.
Prove that an ideal I of R is primary if and only if every zero divisor in R/I is
nilpotent (in the sense that some power of it is 0), if and only if 0 is primary in
R/I.
7.
(a) Prove that if I is a primary ideal, then
√
I is a prime ideal. (Educational
note: In this case the prime ideal
√
I is called the associated prime ideal
to I.)
(b) Prove that if I is any ideal and if I ⊆J for a prime ideal J, then
√
I ⊆J.
8.
(a) Show that the primary ideals in Z are 0 and (pn) for p prime and n > 0.
(b) Let R = C[x, y] and I = (x, y2). Use Problem 6 to show that I is primary.
Show that P =
√
I is given by P = (x, y). Deduce that P2 ⫋I ⫋P and
that a primary ideal is not necessarily a power of a prime ideal.
(c) Let K be a ﬁeld, let R = K[X, Y, Z]/(XY −Z2), and let x, y, z be the
images of X, Y, Z in R. Show that P = (x, z) is prime by showing that
R/P is an integral domain. Show that P2 is not primary by starting from
the fact that xy = z2 lies in P2.
9.
Prove that if I is an ideal such that
√
I is maximal, then I is primary. Deduce
that the powers of a maximal ideal are primary.
10. An ideal is reducible if it is the ﬁnite intersection of ideals strictly containing it;
otherwise it is irreducible.
(a) Show that every prime ideal is irreducible.
(b) Let R = C[x, y], and let I be the maximal ideal (x, y). Show that I 2 is
primary and that the equality I 2 = (Rx + I 2) ∩(Ry + I 2) exhibits I 2 as
reducible.
11. Prove that if R is Noetherian, then every ideal is a ﬁnite intersection of proper
irreducible ideals. (The ideal R is understood to be an empty intersection.)
12. Suppose that R is Noetherian and that Q is a proper irreducible ideal in R. Prove
that 0 is primary in R/Q, and deduce that Q is primary in R.
13. Prove that if Q1, . . . , Qn are primary ideals in R that all have √Qi = P, then
Q = n
i=1 Qi is primary with √Q = P.
14. (Lasker–Noether Decomposition Theorem) The expression I = n
i=1 Qi of
an ideal I as an intersection of primary ideals Qi is said to be irredundant if
(i) no Qi contains the intersection of the other ones, and
(ii) the Qi have distinct associated prime ideals.
Prove that if R is Noetherian, then every ideal is the irredundant intersection of
ﬁnitely many primary ideals.

CHAPTER VIII
Background for Algebraic Geometry
Abstract. This chapter introduces aspects of the algebraic theory of systems of polynomial equations
in several variables.
Section 1 gives a brief history of the subject, treating it as one of two early sources of questions
to be addressed in algebraic geometry.
Section 2 introduces the resultant as a tool for eliminating one of the variables in a system of
two such equations. A ﬁrst form of Bezout’s Theorem is an application, saying that if f (X, Y) and
g(X, Y) are polynomials of respective degrees m and n whose locus of common zeros has more
than mn points, then f and g have a nontrivial common factor. This version of the theorem may be
regarded as pertaining to a pair of afﬁne plane curves.
Section 3 passes to projective plane curves, which are nonconstant homogeneous polynomials in
three variables, two such being regarded as the same if they are multiples of one another. Versions of
the resultant and Bezout’s Theorem are valid in this context, and two projective plane curves deﬁned
over an algebraically closed ﬁeld always have a common zero.
Sections 4–5 introduce intersection multiplicity for projective plane curves. Section 4 treats a
line and a curve, and Section 5 treats the general case of two curves. The theory in Section 4 is
completely elementary, and a version of Bezout’s Theorem is proved that says that a line and a curve
of degree d have exactly d common zeros, provided the underlying ﬁeld is algebraically closed,
the zeros are counted as often as their intersection multiplicities, and the line does not divide the
curve. Section 5 makes more serious use of algebraic background, particularly localizations and the
Nullstellensatz. It gives an indication that ostensibly simple phenomena in the subject can require
sophisticated tools to analyze.
Section 6 proves a version of Bezout’s Theorem appropriate for the context of Section 5: if F
and G are two projective plane curves of respective degrees m and n over an algebraically closed
ﬁeld, then either they have a nontrivial common factor or they have exactly mn common zeros when
the intersection multiplicities of the zeros are taken into account.
Sections 7–10 concern Gr¨obner bases, which are ﬁnite generating sets of a special kind for ideals
in a polynomial algebra over a ﬁeld. Section 7 sets the stage, introducing monomial orders and
deﬁning Gr¨obner bases. Section 8 establishes a several-variable analog of the division algorithm for
polynomials in one variable and derives from it a usable criterion for a ﬁnite set of generators to be a
Gr¨obner basis. From this it is easy to give a constructive proof of the existence of Gr¨obner bases and
to obtain as consequences solutions of the ideal-membership problem and the proper-ideal problem.
Section 9 obtains a uniqueness theorem under the condition that the Gr¨obner basis be reduced.
Adjusting a Gr¨obner basis to make it reduced is an easy matter. A consequence of the uniqueness
result is a solution of the ideal-equality problem. Section 10 gives two theorems concerning solutions
of systems of polynomial equations. The Elimination Theorem identiﬁes in terms of Gr¨obner bases
those members of the ideal that depend only on a certain subset of the variables. The Extension
Theorem, proved under the additional assumption that the underlying ﬁeld is algebraically closed,
447

448
VIII. Background for Algebraic Geometry
gives conditions under which a solution to the subsystem of equations that depend on all but one
variable can be extended to a solution of the whole system. The latter theorem makes use of the
theory of resultants.
1. Historical Origins and Overview
Modern algebraic geometry grew out of early attempts to solve simultaneous
polynomial equations in several variables and out of the theory of Riemann
surfaces. We shall discuss the ﬁrst of these sources in the present chapter and the
second of the sources in Chapter IX.
Serious consideration of simultaneous polynomial equations of degree > 2
dates to a 1750 book1 by Gabriel Cramer (1704–1752), who may be better
known for Cramer’s rule in connection with determinants. Cramer was interested
in various aspects of the zero loci of polynomials in two variables with real
coefﬁcients. Thinking of the zero locus, we refer to a nonconstant polynomial in
two variables as a plane curve.
One of the problems of interest to Cramer was to ﬁnd the number of points in
the plane that would uniquely determine a plane curve of degree n up to a constant
multiple. Cramer gave the answer 1
2n(n +3) to this problem. For example, when
n = 2, if we normalize matters by taking the coefﬁcient of x2 to be 1, then the
possible quadratic polynomials
f (x, y) = x2 + bxy + cy2 + dx + ey + f
involve ﬁve unknown coefﬁcients. Each condition f (xi, yi) = 0 gives a linear
condition on the coefﬁcients, and Cramer was able to write down explicitly a
plane curve through the given points in question by introducing determinants and
applying his rule to solve the problem.
Already with this much description the reader will see a certain subtlety—that
there will be special choices of the ﬁve points for which existence or uniqueness
will fail. We could also ask about the effect of multiplicities: what does it mean
geometrically to take two or more of the points to be equal, and how does such
an occurrence affect the number of points that can be speciﬁed?
Cramer noticed a subtlety that is less easy to resolve, even in hindsight. If we
are given any two plane curves of degree 3, then Cardan’s formula says that we
can solve one equation for y in terms of x, obtaining three expressions in x; then
we can substitute for y in the other equation each of the three expressions in x and
obtain a cubic equation in x each time. In other words, we should expect up to 9
points of intersection for two cubics, and 9 should sometimes occur. (The various
1G. Cramer, Introduction `a l’Analyse des Lignes courbes alg´ebriques, Chez les Fr`eres Cramer
& Cl. Philibert, Geneva, 1750.

1. Historical Origins and Overview
449
forms of Bezout’s Theorem, which came a little later, conﬁrm this argument.) The
number of points that determine a cubic completely is 1
2n(n + 3) for n = 3, i.e.,
is 9. Thus we have 9 points determining a unique cubic, and yet the second cubic
goes through these 9 points as well. What is happening? This question has come
to be known as Cramer’s paradox.
Explaining this kind of mystery became an early impetus for the development
of algebraic geometry.
The question of the number of points of intersection had been the subject of
conjecture for some time earlier, and it was expected that two plane curves of
respective total degrees m and n in some sense had mn points of intersection.
´Etienne Bezout (1730–1783) took up this question and dealt with parts of it
rigorously. The quadratic case can be solved by ﬁnding one variable in terms of
the other and by substituting, but let us handle it by the method that Bezout used.
If we view each polynomial as quadratic in y and having coefﬁcients that depend
on x, then we have a system
a0 + a1y + a2y2 = 0,
b0 + b1y + b2y2 = 0.
Instead of regarding this as a system of two equations for y, we regard it as
a system of two homogeneous linear equations for variables x0, x1, x2, where
x0 = 1, x1 = y, x2 = y2. We can get two further equations by multiplying each
equation by y:
a0y + a1y2 + a2y3 = 0,
b0y + b1y2 + b2y3 = 0,
and then we have four homogeneous linear equations for x0 = 1, x1 = y, x2 =
y2, x3 = y3. Since the system has the nonzero solution (1, y, y2, y3), the deter-
minant of the coefﬁcient matrix must be 0. Remembering that the coefﬁcients
depend on x, we see that we have eliminated the variable y and obtained a poly-
nomial equation for x without using any solution formula for polynomials in one
variable. The device that Bezout introduced for this purpose—the determinant of
the coefﬁcient matrix—is called the resultant of the system and is a fundamental
tool in handling simultaneous polynomial equations. With it Bezout went on in
1779 to give a rigorous proof that when two polynomials in (x, y) are set equal
to 0 simultaneously, one of degree m and the other of degree n, then there cannot
be more than mn solutions unless the two polynomials have a common factor.
This is a ﬁrst form of Bezout’s Theorem and is proved in Section 2.
In order to have a chance of obtaining a full complement of mn solutions, we
make three adjustments—allow complex solutions instead of just real solutions
(even in the case (m, n) = (2, 1) ), consider “projective plane curves” instead of
ordinary plane curves to allow for solutions at inﬁnity (even in the case (m, n) =

450
VIII. Background for Algebraic Geometry
(1, 1) ), and introduce a suitable notion of intersection number of two plane curves
at a point in order to take multiplicities into account (even in the case (m, n) =
(2, 1) ). We shall allow complex solutions already in Section 2, and we shall make
an adjustment for projective plane curves in Section 3. The issue of intersection
multiplicity is more complicated. The beginnings of a classical approach to it
are indicated in Section 4, and a somewhat more modern approach appears in
Section 5. With the full theory of intersection multiplicities of projective plane
curves in place, we obtain a general form of Bezout’s Theorem2 in Section 6.
The theory of the resultant can be extended in various ways, but we shall
largely not pursue this matter. Studies of zero loci of systems of equations took
a more geometric turn in the ﬁrst part of the nineteenth century through the work
of Julius Pl¨ucker (1801–1858) and others, but these matters will be left for an
implicit discussion in Chapter X. Instead, we skip to a development that began
with the doctoral thesis of Bruno Buchberger in 1965. Buchberger was interested
in being able to decide when a polynomial is a member of an ideal that is speciﬁed
by a ﬁnite list of generators. For this purpose he learned that each ideal has a
special ﬁnite set of generators that is unique once certain declarations are made.
He devised an algorithm for determining such a set of generators,3 and he gave
the name “Gr¨obner basis” to the set, in honor of his thesis advisor.4 The special
unique such basis is called a “reduced Gr¨obner basis.”
An unfortunate feature of the algorithm (and even of later improved algorithms)
is that Gr¨obner bases are extraordinarily complicated to calculate. The timing
of Buchberger’s discovery was therefore especially fortuitous, coming when
computers were becoming more common, more economical, and more powerful.
Buchberger was able to give a test for membership in an ideal in terms of
a multivariable division algorithm involving any Gr¨obner basis. Other general
problems involving ideals were solvable as well. Because of the uniqueness of the
reduced Gr¨obner basis, two ideals are identical if and only if their reduced Gr¨obner
bases are equal. When some of the theory of resultants was incorporated into
the theory of Gr¨obner bases, these bases could also be used to address various
questions of identifying zero loci. Other problems involving ideals could be
addressed by similar methods. The theory has ﬂowered tremendously since its
initial discovery and by the present day has found many imaginative applications
to applied problems. Sections 7–10 give an introductory account of this important
theory.
2A correct proof of the general form of the theorem seems to have been published for the ﬁrst
time by Georges-Henri Halphen (1844–1889) in 1873.
3Devising the algorithm was Buchberger’s real contribution, since the abstract existence of the
special set of generators is an easy consequence of the Hilbert Basis Theorem and had already been
used in papers of H. Hironaka in 1964.
4Wolfgang Gr¨obner (1899–1980). The name is often spelled out as “Groebner,” particularly
when it is used in connection with computer algorithms.

2. Resultant and Bezout's Theorem
451
2. Resultant and Bezout’s Theorem
Let A be a unique factorization domain. The case that A = K[X1, . . . , Xr] for
a ﬁeld K will be the main case of interest for us. If f and g are polynomials in
A[X] of the form
f (X) = f0 + f1X + · · · + fm Xm,
g(X) = g0 + g1X + · · · + gn Xn,
with m and n both positive, then we let R( f, g) be the (m +n)-by-(m +n) matrix
⎛
⎜⎜⎜⎜⎜⎜⎜⎜⎜⎜⎜⎝
f0
f1
· · ·
fm−1
fm
0
0
0
· · ·
0
0
f0
· · ·
fm−2
fm−1
fm
0
0
· · ·
0
...
...
...
...
0
· · ·
f0
· · ·
fm
g0
g1
· · ·
gn−1
gn
0
· · ·
0
0
g0
· · ·
gn−2
gn−1
gn
· · ·
0
...
...
...
...
0
· · ·
g0
g1
· · ·
gn
⎞
⎟⎟⎟⎟⎟⎟⎟⎟⎟⎟⎟⎠
,
inwhichthere aren rowsabove the g0 inthe ﬁrstcolumnandthere arem remaining
rows. The resultant of f and g is the determinant
R( f, g) = det R( f, g).
Theorem 8.1. If A is a unique factorization domain and if f and g are nonzero
members of A[X] of the form f (X) = 	m
i=0 fi Xi and g(X) = 	n
j=0 gj X j with
m > 0 and n > 0 and with at least one of fm and gn nonzero, then the following
are equivalent:
(a) f and g have a common factor of degree > 0 in X,
(b) af + bg = 0 for some nonzero a and b in A[X] with deg a < n and
deg b < m.
(c) R( f, g) = 0.
Regard R( f, g) as a constant polynomial in X.
When R( f, g) ̸= 0, there
exist unique a and b in A[X] such that a(X) f (X) + b(X)g(X) = R( f, g) with
deg a < n and deg b < m. Both the polynomials a and b are nonzero if both
f (X) and g(X) are nonconstant.
REMARKS. The theorem says that af + bg = R( f, g) holds in every case
for which at least one of the coefﬁcients fm and gn is nonzero. Sometimes the
theorem appears in texts with the assumption that both coefﬁcients are nonzero;
in this connection, see Problem 5 at the end of the chapter. When R( f, g) = 0,
the theorem does not point to a useful way to identify a common factor; the
division algorithm can be used for this purpose in some circumstances, but the
use of Gr¨obner bases as in Section 7 will be more helpful.

452
VIII. Background for Algebraic Geometry
PROOF. Let us prove the equivalence of (a) and (b). Suppose that (a) holds.
If u is a nonconstant polynomial in X that divides both f and g, let us write
f = bu and g = −au. Then af + bg = 0. Also, deg a + deg u = deg g;
since deg u > 0, deg a < deg g ≤n. Similarly deg b < m. Thus (b) holds.
Conversely suppose that (b) holds, so that af = −bg with a and b nonzero and
with deg a < n and deg b < m. Suppose that fm ̸= 0. The equality af = −bg
shows that f divides bg. Since deg b < m = deg f , f cannot divide b. But
A[X] is a unique factorization domain, and thus there is some prime factor p of
f of positive degree such that pk for some k divides f but not b. Then p divides
both f and g, and (a) holds. A similar argument works if gn ̸= 0.
Now we prove the equivalence of (b) and (c). Let F be the ﬁeld of fractions
of A. We set up a one-one correspondence between polynomials a(X) in A[X]
of degree at most n −1 and n-dimensional row vectors ( α0
α1
· · ·
αn−1 )
with entries in A by the formula
a(X) = α0 + α1X + · · · + αn−1Xn−1,
and similarly we set up one-one correspondences for degrees at most m −1 and
at most m + n −1 by the formulas
b(X) = β0 + β1X + · · · + βm−1Xm−1,
c(X) = γ0 + γ1X + · · · + γm+n−1Xm+n−1.
Examining the form of R( f, g), we see that the matrix equality
( α0
α1
· · ·
αn−1
β0
· · ·
βm−1 ) R( f, g)
= ( γ0
γ1
· · ·
γm+n−1 )
(∗)
holds if and only if the polynomial equality
a(X) f (X) + b(X)g(X) = c(X).
(∗∗)
holds. If (b) holds, then af = −bg, and (∗∗) shows that c = 0. That is,
( γ0
γ1
· · ·
γm+n−1 ) is the 0 row vector. Interpreting (∗) as a matrix equality
over F and assuming that a and b are not both 0, we see that the transpose
of R( f, g) has a nontrivial null space. Therefore R( f, g) = det R( f, g) =
0.
This proves (c).
Conversely if (c) holds, then we can ﬁnd row vectors
( α0
α1
· · ·
αn−1 ) and ( β0
β1
· · ·
βm−1 ) not both 0, having entries
in F, such that the left side of (∗) equals the 0 row vector. Clearing fractions, we
may assume that ( α0
α1
· · ·
αn−1 ) and ( β0
β1
· · ·
βm−1 ) have entries
in A. Referring to (∗), we obtain af +bg = 0 with deg a at most n −1 and deg b
at most m −1. We know that at least one of a and b is nonzero, and we have to

2. Resultant and Bezout's Theorem
453
see that both are nonzero. The situation is symmetric in a and b. If a were to
equal 0, then we would have bg = 0 and we could conclude that b = 0 because
g ̸= 0. So we would obtain the contradiction a = b = 0. This proves (b).
Forthelaststatementofthetheorem, supposethat R( f, g) ̸= 0. ThenCramer’s
rule applied over the ﬁeld of fractions F of A shows that the matrix inverse of
R( f, g) is of the form
R( f, g)−1 = R( f, g)−1S( f, g),
where S( f, g) is a matrix with entries in A. Consequently the row vector
( R( f, g)
0
· · ·
0 ) R( f, g)−1
has entries in A, and we can deﬁne members α0, . . . , αn−1, β0, . . . , βm−1 of A by
( α0
α1
· · ·
αn−1
β0
· · ·
βm−1 )
= ( R( f, g)
0
· · ·
0 ) R( f, g)−1.
Then (∗) holds with ( γ0
γ1
· · ·
γm+n−1 ) = ( R( f, g)
0
· · ·
0 ), and
the equality (∗∗) shows that a(X) f (X) + b(X)g(X) = R( f, g). If both f and
g are nonconstant, then neither a(X) nor b(X) can be 0, since otherwise the
equation would show that R( f, g) is a nonconstant polynomial.
□
Theorem 8.2 (Bezout’s Theorem). Let K be any ﬁeld, and let f (X, Y) and
g(X, Y) be nonconstant polynomials in K[X, Y], of exact respective degrees m
and n. If the locus of common zeros of f and g in K 2 has more than mn points,
then f and g have a nonconstant common factor in K[X, Y].
PROOF. For most of the proof, we assume that K is inﬁnite. Arguing by
contradiction, suppose that f and g both vanish at distinct points (xi, yi) for
1 ≤i ≤mn + 1, and suppose that f and g have no nonconstant common factor.
Since there are only ﬁnitely many members c of K such that yi −yj = c(xi −xj)
for some i and j with i ̸= j and since K is assumed to be inﬁnite, we can ﬁnd
c in K such that yi −yj ̸= c(xi −xj) for all i and j with i ̸= j. For this c,
yi −cxi ̸= yj −cxj when i ̸= j, and therefore the second coordinates of the
points (xi, yi −cxi) are distinct. The common zeros of f (X, Y) and g(X, Y)
include the points (xi, yi), and thus the common zeros of f (X, Y + cX) and
g(X, Y + cX) include the mn + 1 points (xi, yi −cxi) whose second coordinates
are distinct.
In other words, there is no loss of generality in assuming that the given
polynomials f and g vanish at mn + 1 points whose second coordinates are

454
VIII. Background for Algebraic Geometry
distinct. Regard f (X, Y) and g(X, Y) as members f (X) and g(X) of A[X],
where A = K[Y], and write
f (X) = f0 + f1X + · · · + fm′ Xm′,
g(X) = g0 + g1X + · · · + gn′ Xn′,
with each fi and gi in A and with fm′ ̸= 0 and gn′ ̸= 0. Here m′ ≤m and n′ ≤n.
Let us rule out the possibility that m′ = 0 or n′ = 0. Indeed, if we had m′ = 0,
then the polynomial f would be nonzero and would depend on Y alone. Since
f is nonzero and has degree m ≥1, it has at most m roots. But we are assuming
that f and g vanish at mn + 1 points whose Y coordinates are distinct, and the
inequalities m ≤mn < mn + 1 therefore give a contradiction. Thus m′ ̸= 0.
Similarly n′ ̸= 0. So Theorem 8.1 is applicable.
Form the square matrix R( f, g) of size m′ + n′ and its determinant R( f, g).
The latter is a member of K[Y], and Theorem 8.1 shows that it cannot be 0, since
f and g are assumed to have no nonconstant common factor in K[X, Y].
Let us bound the degree of the member R( f, g) = det R( f, g) of K[Y]. Each
term in the expansion of the determinant is of the form
±

1≤i≤m′+n′ R( f, g)i,σ(i)
(∗)
for some permutation σ of {1, . . . , m′ + n′}. Here R( f, g)i j is given by
R( f, g)i j =
⎧
⎪⎪⎪⎪⎪⎨
⎪⎪⎪⎪⎪⎩
fj−i
for 1 ≤i ≤n′ and for j with i ≤j ≤m′ + i,
0
for 1 ≤i ≤n′ and for all other j,
gj+n′−i
for n′ + 1 ≤i ≤n′ + m′ and for j
with i ≤n′ + j ≤m′ + i,
0
for n′ + 1 ≤i ≤n′ + m′ and for all other j.
In addition, the degree of fj−i as a member of K[Y] is at most m′ −( j −i), and
the degree of gj+n′−i is at most n′ −( j + n′ −i) = i −j. Setting j = σ(i), we
see that the degree of (∗) is at most
	
1≤i≤n′ (m′ −σ(i) + i) +
	
n′+1≤i≤m′+n′ (i −σ(i))
= m′n′ −
	
1≤i≤m′+n′ σ(i) +
	
1≤i≤m′+n′ i = m′n′ ≤mn.
Thus R( f, g) is a nonzero polynomial in K[Y] of degree at most mn. Conse-
quently it has at most mn roots.
Theorem 8.1 shows that af + bg = R( f, g) for suitable members a and b of
K[X, Y]. Recalling that f and g are assumed to vanish at mn + 1 points whose
second coordinates are distinct, we see that R( f, g) vanishes at each of these
second coordinates, and we arrive at a contradiction.

2. Resultant and Bezout's Theorem
455
Now we can allow K to be ﬁnite. Let K ′ be an inﬁnite extension. We have
just seen that f and g have a nonconstant factor in K ′[X, Y].
Without loss
of generality, this factor depends nontrivially on X. Theorem 8.1 applied with
A = K ′[Y] shows that R[ f, g] = 0.
The same theorem with A = K[Y]
then shows that f and g have a common factor in A[X] = K[X, Y] depending
nontrivially on X.
□
Let us introduce some geometric language for the situation in Theorem 8.2.
Afﬁne n-space over a ﬁeld K is the set of n-dimensional column vectors
An = An
Kalg =

(x1, . . . , xn) ∈K n
alg

with entries in a ﬁxed algebraic closure Kalg of K. The set of K rational points,
or K points, in An is the subset
An
K =

(x1, . . . , xn) ∈K n
.
We shall comment on the appearance of Kalg in these deﬁnitions shortly.
Members of An are called points in n-dimensional afﬁne space, and the func-
tions P 	→xj(P) give the coordinates of the points. If L is any ﬁeld between
K and Kalg, then any polynomial f in K[X1, . . . , Xn] deﬁnes a corresponding
polynomial function from An
L into L.
For algebraic geometry the case of interest for Sections 1–6 of this chapter is
the case n = 2. The way of viewing a curve is inﬂuenced by Cramer’s thinking as
discussed in Section 1: the particular polynomial that deﬁnes a curve is important,
not just the zero locus in the afﬁne plane, but two curves are to be regarded as the
same if each is a nonzero multiple of the other. We can incorporate this viewpoint
into algebraic language by deﬁning an afﬁne plane curve C over the ﬁeld K to
be any nonzero proper principal ideal5 in K[X, Y]. The curve is an afﬁne plane
line if the degree of any generator is 1.
In practice in studying afﬁne plane curves, there is ordinarily no need to
distinguish between a polynomial and the principal ideal that it generates, and
we shall feel free to refer to an afﬁne plane curve C = ( f ) as f when there is no
possibility of confusion.
The zero locus of a curve is the corresponding geometric notion, but it can
readily be empty, as is the case with X2 + Y 2 + 1 when K = R.
On the
other hand, the Nullstellensatz (Theorem 7.1) ensures that the zero locus will be
nonempty if the underlying ﬁeld is algebraically closed. Thus we deﬁne the zero
locus V (C) = V (( f )) of the curve C = ( f (X, Y)) by6
5Warning:
This deﬁnition will be changed slightly in Chapter IX and again in Chapter X to
reﬂect changed emphasis in those chapters.
6The letter “V ” is the letter that is commonly used in the notation for a zero locus. It stands for
“variety,” a notion that we have not yet deﬁned. But beware: not all objects labeled with a “V ” are
actually varieties the way the term is normally deﬁned. An afﬁne plane curve will turn out to be a
variety exactly when the generating polynomial f is prime in Kalg[X, Y].

456
VIII. Background for Algebraic Geometry
V (C) = VKalg(C) =

(x, y) ∈K 2
alg | f (x, y) = 0

.
This is the same as the set of all (x, y) such that every member of the ideal C
vanishes at (x, y). The set of K rational points, or K points, of C is
VK(C) = VK(( f )) =

(x, y) ∈K | f (x, y) = 0

.
When we are content to refer to an afﬁne curve C = ( f ) as f , we are content
also to write V ( f ) in place of V (C) = V (( f )).
In Chapter X, under the assumption that K is algebraically closed, we shall
extend these deﬁnitions from the case n = 2 and C as above to the case that
n is general and C is replaced by any ideal I in K[x1, . . . , Xn]. The set V (I)
of common zeros of the members of I in K n = K n
alg will be called an “afﬁne
algebraic set.” The case of afﬁne n-space itself arises when the ideal is 0.
For general K, not necessarily algebraically closed, it is meaningful to consider
the set VK(I) of K rational points, i.e., the subset of common zeros lying in K n.
For I = 0 and V (I) = An, the distinction between VK(I) and VKalg(I) is hardly
worth mentioning, but the distinction is well worth making for general I and is
made for the case V (I) = An for consistency. Although the study of sets VK(I)
is of importance in number theory, in geometry over R, and in other areas, we
shall not pursue it in Chapter X for lack of space.
Returning to Theorem 8.2, we see that the statement concerns VK(C)∩VK(D),
where C and D are the principal ideals C = ( f ) and D = (g) in K[X, Y]. The
theorem says that if VK(C) ∩VK(D) contains more than mn points, then there is
a nonzero principal ideal h with (h) ⊆( f ) ∩(g).
3. Projective Plane Curves
Section 2 dealt with intersections of afﬁne plane curves. Even over an alge-
braically closed ﬁeld, two afﬁne plane curves need not intersect. An example is
the pair of straight lines X +Y −1 and X +Y −2, whose locus of common zeros
is empty. To get these lines to intersect, we have to introduce “points at inﬁnity.”
The projective plane is the device for including such points.
Let K be a ﬁeld, and let Kalg be an algebraic closure. The projective plane
over K is deﬁned set theoretically as the quotient of K 3
alg −{0} by an equivalence
relation:
P2 = P2
Kalg =

(x, y, w) ∈K 3
alg −{0}

∼,
where (x′, y′, w′) ∼(x, y, w) if (x′, y′, w′) = λ(x, y, w) for some λ ∈K ×
alg.
The set of K rational points, or K points, of P2 is the quotient
P2
K =

(x, y, w) ∈K 3 −{0}

∼,

3. Projective Plane Curves
457
where (x′, y′, w′) ∼(x, y, w) if (x′, y′, w′) = λ(x, y, w) for some λ ∈K.
When there is a need to be careful, we shall write [x, y, w] for the member of P2
K
corresponding to (x, y, w) in K 3 −{0}. But often there will not be such a need,
and we shall simply refer to (x, y, w) as a member of P2
K. Both P2 and P2
K have
additional structure on them, given by “afﬁne local coordinates,” and we come to
that matter later in this section.
Let us record brieﬂy the obvious generalization of the projective plane to other
dimensions: Projective n-space over K is deﬁned set theoretically as the quotient
Pn = Pn
Kalg =

(x1, . . . , xn+1) ∈K n+1
alg −{0}

∼,
where (x′
1, . . . , x′
n+1) ∼(x1, . . . , xn+1) if (x′
1, . . . , x′
n+1) = λ(x1, . . . , xn+1) for
some λ ∈K ×
alg. The set Pn
K of K rational points of Pn is the set deﬁned in similar
fashion using just nonzero vectors in K n+1 and scalars in K ×.
Scalar-valued functions on Pn
K are of little interest because they amount to
scalar-valued functions of K n −{0} that are unchanged when (x1, . . . , xn) is
replaced by a multiple of itself.
A polynomial of this kind, for example, is
necessarily constant. Instead, the polynomials of interest that are related toPn
K are
“homogeneous polynomials.” A monomial in K[X1, . . . , Xn+1] is a polynomial
of the form X j1
1 · · · X jn+1
n+1; its total degree is 	n+1
i=1 ji. We say that a nonzero
F in K[X1, . . . , Xn+1] is homogeneous of degree d ≥0 if every monomial
appearing in F with nonzero coefﬁcient has total degree d. By convention the 0
polynomial is homogeneous of every degree. We write K[X1, . . . , Xn+1]d for
the set of homogeneous polynomials of degree d. Each such F satisﬁes
F(λx1, . . . , λxn+1) = λd F(x1, . . . , xn+1)
for all (x1, . . . , xn+1) ∈K n+1 and λ ∈K ×. Conversely the fact that the mapping
of polynomials into polynomial functions is one-one for an inﬁnite ﬁeld implies
that homogeneous polynomials over an inﬁnite ﬁeld can be detected by this
property.
Let us assemble some further properties of homogeneous polynomials: The
monomialsoftotaldegreed forma K basisofthevectorspace K[X1, . . . , Xn+1]d;
this fact follows from the deﬁnition of polynomials over K. To calculate the
dimension of K[X1, . . . , Xn+1]d, consider the problem of taking d factors X on
which to place subscripts and using n dividers to separate the X1’s from the X2’s
and so on. The number of monomials in question is just the number of ways of
selecting the n dividers from among the d + n symbols and dividers. Thus we
obtain the important formula
dimK K[X1, . . . , Xn+1]d =
d + n
n

.
Lemma 8.3. Any polynomial factor of a homogeneous polynomial over a ﬁeld
K is homogeneous.

458
VIII. Background for Algebraic Geometry
PROOF. Write F = F1F2 nontrivially. Let d1 and e1 be the highest and lowest
total degrees of terms in F1, and let d2 and e2 be the highest and lowest total
degrees of terms in F2. The product of the terms of total degree d1 in F1 and
the terms of total degree d2 in F2 is nonzero and is the d1d2 total-degree part
of F. The product of the terms of total degree e1 in F1 and the terms of total
degree e2 in F2 is nonzero and is the e1e2 total-degree part of F. Since F is
homogeneous, d1d2 = e1e2. It follows that d1 = e1 and d2 = e2; thus F1 and F2
are homogeneous.
□
An ideal I in K[X1, . . . , Xn+1] is called a homogeneous ideal if it is the sum
over d ≥0 of its intersections with K[X1, . . . , Xn+1]d:
I =
∞
1
d=0
(I ∩K[X1, . . . , Xn+1]d).
The sum is to be regarded as a direct sum of vector spaces. For such an ideal, we
can compute the quotient K[X1, . . . , Xn+1]/I term by term:
K[X1, . . . , Xn+1]/I =
∞
1
d=0
K[X1, . . . , Xn+1]d

(I ∩K[X1, . . . , Xn+1]d).
We can often recognize a homogeneous ideal from its generators: an ideal with a
set of generators that are all homogeneous is necessarily a homogeneous ideal. In
fact, if an ideal I has homogeneous generators Fj, then the most general member
of I is a ﬁnite sum of terms Aj Fj. The terms of total degree d in Aj Fj are the
product of Fj with the terms in Aj of total degree d −deg Fj, and each such term
is in I. Hence each member of I is a sum of homogeneous polynomials that lie
in I, and the assertion follows.
In the setting of P2, projective plane curves over K are initially deﬁned to be
nonconstant homogeneous polynomials in K[X, Y, W]. Although such polyno-
mials are not well deﬁned on the projective plane, their zero loci are well deﬁned
subsets of P2. As in the afﬁne case, the particular polynomial that deﬁnes a curve
is important, not just the zero locus, but two curves are to be regarded as the same
if each is a nonzero multiple of the other. We can incorporate this viewpoint into
algebraic language by deﬁning a projective plane curve of degree d > 0 over
the ﬁeld K to be any nonzero proper principal ideal in K[X, Y, W] generated by a
homogeneous polynomial of degreed. Such an ideal is necessarily homogeneous.
In the special cases that d = 1, 2, 3, or 4, the curve is called a projective line,
conic, cubic, or quartic respectively.
Just as in the afﬁne case, in practice in studying projective plane curves,
there is often no need to distinguish between a homogeneous polynomial and
the homogeneous principal ideal that it generates, and we shall feel free to refer
to a projective plane curve C = (F) ⊆K[X, Y, W] as F when there is no
possibility of confusion.

3. Projective Plane Curves
459
If (F) is a projective plane curve of degree d, then its zero locus is denoted by
V ((F)) = VKalg((F)) =

[x, y, w] ∈P2  F(x, y, w) = 0

.
The locus
VK((F)) =

[x, y, w] ∈P2
K
 F(x, y, w) = 0

is called the set of K rational points, or K points, of the curve. When we allow
ourselves to refer to the curve simply as F, then we can write V (F) in place of
V ((F)).
The afﬁne plane A2
K = {(x, y)} has a standard one-one embedding into the
projective plane P2
K. Namely we map (x, y) into [x, y, 1]. The set that is missed
by the image is the set with w = 0, which is the set of K rational points of the line
L with L(X, Y, W) = W, a line called the line at inﬁnity. We shall denote this
line by W. The points of VK(W), i.e., those with w = 0, are called the points at
inﬁnity.
Except for the line at inﬁnity, lines in P2
K correspond under restriction exactly
to lines in K 2.
Namely the projective line L(X, Y, W) = aX + bY + cW
corresponds to the afﬁne line l(x, y) = aX + bY + c, and vice versa. In certain
ways the geometry of P2
K is simpler than the geometry of A2
K:
(i) Two distinct lines in P2
K intersect in a unique point. In fact, we set up the
system of equations

a
b
c
a′
b′
c′
 - x
y
w
.
=

0
0

.
Since the lines are distinct, the coefﬁcient matrix has rank 2.
Thus
the kernel has dimension 1, and there is just one point [x, y, w] in the
intersection.
(ii) Two distinct points in P2
K lie on a unique line. In fact, we set up the
system of equations

x
y
w
x′
y′
w′
 - a
b
c
.
=

0
0

and argue in similar fashion.
Along with the embedding of A2
K into P2
K is a correspondence between pro-
jective curves and afﬁne curves. Let us work with the polynomials themselves,
without identifying each polynomial with every nonzero scalar multiple of itself.
The passage from a nonzero homogeneous polynomial F(X, Y, W) of degree

460
VIII. Background for Algebraic Geometry
d > 0 to a polynomial f (X, Y) is given by f (X, Y) = F(X, Y, 1). The mapping
F 	→f is a substitution homomorphism, and it therefore respects products.
However, the degree may drop in the process, and in particular f (X, Y) is a
constant if and only if F(X, Y, W) is a multiple of W d.
In the reverse direction if f (X, Y) is a polynomial of degree e, then f (X, Y)
arises from a polynomial F(X, Y, W), but we have to specify the degree d of F
and we must have d ≥e. Operationally we obtain F by inserting a power of W
into each term of f to make the total degree of the term become d. For example,
with f (X, Y) = Y 2 + XY + X3 if the desired degree is 3, then F(X, Y, W) =
Y 2W +XY W +X3. On the other hand, if the desired degree is 4, then F(X, Y, W)
= Y 2W 2 + XY W 2 + X3W.
The formula for this reverse process is F(X, Y, W) = W d f (XW −1, Y W −1).
That is, F is given by a substitution homomorphism, followed by multiplication
by a power of W. From this fact, we can read off conclusions of the following
kind:
If polynomials f (X, Y) and g(X, Y) are obtained from homoge-
neous polynomials F(X, Y, W) and G(X, Y, W) by taking W = 1,
then there exist integers r
and s such that the polynomial
W r F(X, Y, W) + W sG(X, Y, W) is homogeneous and such that
f (X, Y) + g(X, Y) is obtained from it by taking W = 1.
As we mentioned above, P2
K has more structure than simply the structure of
a set. About any point in P2
K we can introduce various systems of “afﬁne local
coordinates.” The idea is to imitate what happens in the deﬁnition of a manifold:
the whole manifold is covered by charts, each giving an invertible mapping of a
set in the manifold to an open subset of Euclidean space. Here a single system
of afﬁne local coordinates plays the role of a chart; it puts A2
K into one-one
correspondence with the complement of the zero locus of a line in P2
K.
Let  be a member of the matrix group GL(3, K). Then  maps the set K 3
of column vectors in one-one fashion onto K 3 and passes to a one-one map of
P2
K onto P2
K called the projective transformation corresponding to . Two ’s
give the same map of P2
K if and only if they are multiples of one another. The
group action of GL(3, K) on P2
K is transitive because GL(3, K) acts transitively
on K 3 −{(0, 0, 0)}.
If L is the projective line whose coefﬁcients are given by the row vector
( a
b
c ) and if  is is in GL(3, K), then the row vector ( a
b
c ) −1
deﬁnes a new projective line L, and the K rational points of L are given by
VK(L) = (VK(L)).
In fact, let
 x
y
w

be in VK(L). Then
 x′
y′
w′

= 
 x
y
w

is in (VK(L)) and
satisﬁes

3. Projective Plane Curves
461
( a
b
c ) −1
- x′
y′
w′
.
= 0;
henceitisin VK(L). Converselyif
 x′
y′
w′

isin VK(L), then
 x
y
w

= −1
 x′
y′
w′

satisﬁes
( a
b
c )
- x
y
w
.
= ( a
b
c ) −1
- x′
y′
w′
.
= 0,
and thus
 x′
y′
w′

is  of something in VK(L).
To form the analog of a chart, ﬁx [x0, y0, w0] in P2
K. Choose (by transitivity)
some  in GL(3, K) with (x0, y0, w0) = (0, 0, 1). Then we can deﬁne afﬁne
local coordinates on −1(K × K × {1}) to K 2 by the one-one map
ϕ(−1(x, y, 1)) = (x, y).
This deﬁnition generalizes the standard embedding of the afﬁne plane K 2 into
P2
K earlier; that embedding was the case  = 1.
EXAMPLES OF AFFINE LOCAL COORDINATES FOR P2
K.
(1) Suppose (x0, y0, w0) = (x0, y0, 1). We can choose  =
 1 0 −x0
0 1 −y0
0 0
1

. Then

- x
y
1
.
=
- 1
0
−x0
0
1
−y0
0
0
1
. - x
y
1
.
=
- x −x0
y −y0
1
.
.
In this case, the local coordinates are deﬁned on
−1(K × K × 1) = K × K × 1
and are given by
ϕ(x, y, 1) = ϕ(−1((x, y, 1)))
= ϕ(−1(x −x0, y −y0, 1)) = (x −x0, y −y0).
This  is handy for reducing behavior about (x0, y0, 1) in P2
K to behavior about
(0, 0) in K 2.

462
VIII. Background for Algebraic Geometry
(2) Suppose (x0, y0, w0) = (0, 1, 0). We can choose  =
 0 0 1
1 0 0
0 1 0

. Then

- x
1
w
.
=
- 0
0
1
1
0
0
0
1
0
. - x
1
w
.
=
- w
x
1
.
and
ϕ(x, 1, w) = ϕ(−1((x, 1, w))) = ϕ(−1(w, x, 1)) = (w, x).
This  is handy for studying behavior near one of the points at inﬁnity in P2
K.
We can use afﬁne local coordinates to examine the behavior of a projective
plane curve “near a particular point,” by which is meant “with that point as the
center point in the analysis.” To examine behavior near (0, 0, 1), we use the
correspondence f (X, Y) = F(X, Y, 1) that we discussed earlier. For a general
point, we make use of the fact that whenever F is a homogeneous polynomial of
degreed, thensois F◦−1. Toexaminethebehaviorof F nearapoint(x0, y0, w0)
in K 3 −{(0, 0, 0)}, we choose  in GL(3, K) with (x0, y0, w0) = (0, 0, 1),
and we deﬁne
f (X, Y) = F(−1(X, Y, 1)).
Under this correspondence the behavior of F at (x0, y0, w0) is reﬂected in the
behavior of f at (0, 0). We call f (X, Y) the local expression for F in the afﬁne
local coordinates determined by . This local expression is a polynomial in
K[X, Y], and it is nonconstant unless F is a scalar multiple of (W ◦)d for
some d.
EXAMPLES, CONTINUED.
(1) Suppose that (x0, y0, w0) = (x0, y0, 1) and that  =
 1 0 −x0
0 1 −y0
0 0
1

. Compu-
tation gives
−1
- x
y
1
.
=
- x + x0
y + y0
1
.
,
and the corresponding local expression for a projective plane curve F is
f (X, Y) = F(X + x0, Y + y0, 1).
For the projective plane curve
F(X, Y, W) = X2Y + XY W + W 3
and the same , the local expression f (X, Y) splits into homogeneous terms as

3. Projective Plane Curves
463
f (X, Y) = (x2
0 y0 + x0y0 + 1) + (x2
0Y + 2x0y0X + x0Y + y0X)
+ (y0X2 + 2x0XY + XY) + (X2Y).
We shall use this splitting in the next section in the ﬁrst example of intersection
multiplicity.
(2) Suppose that (x0, y0, w0) = (0, 1, 0) and that  =
 0 0 1
1 0 0
0 1 0

. Then
−1
- x
y
1
.
=
- y
1
x
.
,
and the local expression for a projective plane curve F relative to this  is
f (X, Y) = F(Y, 1, X).
For the same projective plane curve F as in Example 1, namely
F(X, Y, W) = X2Y + XY W + W 3,
we obtain
f (X, Y) = (Y 2 + XY) + (X3).
We shall examine this example further in the next section.
In this way we have associated to each projective plane curve F and to the
system of afﬁne local coordinates determined by a member  of GL(3, K) a local
expression that is a nonzero polynomial in K[X, Y]. Conversely if the degree
d and the member  of GL(3, K) are given and if f in K[X, Y] is nonzero of
degree at most d, then we can reconstruct a projective plane curve F of degree
d whose local expression relative to  is f . We have only to form the unique
homogeneous polynomial G of degree d with f (X, Y) = G(X, Y, 1) and then
put F = G ◦.
With these preparations in place, we return to a consideration of resultants and
Bezout’s Theorem. Our objective is to rephrase Theorem 8.2 to take advantage
of properties of the projective plane.
Lemma 8.4. Let K be a ﬁeld, let A be the polynomial ring A = K[x1, . . . , xr],
and let f and g be members of A[X] of the form
f (X) = f0 + f1X + · · · + fm Xm,
g(X) = g0 + g1X + · · · + gn Xn,
where fj is a member of A homogeneous of degree m′ −j and gj is a member of
A homogeneous of degree n′ −j. Then the resultant R( f, g) is a homogeneous
member of A of degree mn′ + m′n −mn.

464
VIII. Background for Algebraic Geometry
REMARKS. In the application to proving Theorem 8.5, we will have m′ = m
and n′ = n, and then R( f, g) is homogeneous of degree mn. Problem 8 at the
end of the chapter concerns a situation for which m′ ̸= m and n′ ̸= n.
PROOF. Thereisnolossofgeneralityinassumingthat K isalgebraicallyclosed,
hence in particular is inﬁnite. Each nonzero entry R( f, g)i j of R( f, g) is a coefﬁ-
cient of f or of g. For each entry, deﬁne p(i, j) such that R( f, g)i j(tx1, . . . , txr)
= t p(i, j)R( f, g)i j(x1, . . . , xr). The assembled matrix R with powers of t in place
is
⎛
⎜⎜⎜⎜⎝
tm′ f0
tm′−1 f1
· · ·
tm′−m fm
· · ·
0
tm′ f0
· · ·
...
...
tn′g0
tn′−1g1
· · ·
tn′−ngn
· · ·
0
tn′g0
· · ·
⎞
⎟⎟⎟⎟⎠
.
(∗)
It turns out that there is a function q(i) such that r( j) = q(i) + p(i, j) depends
only on j. Here tq(i) is the ith entry of
(tn′, tn′−1, . . . , tn′−n+1; tm′, tm′−1, . . . , tm′−m+1).
The matrix (∗) with tq(i) multiplying every entry of the ith row is
⎛
⎜⎜⎜⎜⎝
tn′tm′ f0
tn′tm′−1 f1
· · ·
tn′tm′−m fm
· · ·
0
tn′−1tm′ f0
· · ·
...
...
tm′tn′g0
tm′tn′−1g1
· · ·
tm′tn′−ngn
· · ·
0
tm′−1tn′g0
· · ·
⎞
⎟⎟⎟⎟⎠
.
(∗∗)
In (∗∗), tr( j) is the jth entry of (tm′+n′, tm′+n′−1, . . . , tm′+n′−m−n+1). Then we
have
tu R( f, g)(tx1, . . . , txr) = tv R( f, g)(x1, . . . , xr),
where u = 	
i q(i) and v = 	
j r( j). So
R( f, g)(tx1, . . . , txr) = tv−u R( f, g)(x1, . . . , xr).
In other words, R( f, g) is a homogeneous function. Since K is inﬁnite, R( f, g)
is homogeneous as a member of A.
Computing u and v, we ﬁnd that u =
mm′+nn′−1
2m(m−1)−1
2n(n−1)andv = (m+n)(m′+n′)−1
2(m+n)(m+n−1).
Therefore v −u = mn′ + m′n −mn, and the degree of homogeneity of R( f, g)
is mn′ + m′n −mn.
□

3. Projective Plane Curves
465
Theorem 8.5 (Bezout’s Theorem). Let K be a ﬁeld, let Kalg be an algebraic
closure, and suppose that F in K[X, Y, W]m and G in K[X, Y, W]n are projective
plane curves.
Then their locus V (F) ∩V (G) of common zeros in P2
Kalg is
nonempty. If this zero locus has more than mn points, then F and G have as a
common factor some homogeneous polynomial in (X, Y, W) of positive degree.
REMARKS. For two polynomials f (X, Y) and g(X, Y) in afﬁne space, applica-
tion of Theorem 8.1 concerning the resultant in the Y variable involves checking
that at least one of the polynomials has the expected degree in the Y variable, and
doing so may not be so easy. In the projective setting, this problem disappears
if we apply a projective transformation and arrange that [0, 0, 1] not be on the
zero locus of one of the given polynomials, say F(X, Y, W). In fact, if F is in
K[X, Y, W]m, then the coefﬁcient of W m has to be a constant, and this term is
the only term of F that contributes to the value of F at (0, 0, 1). With the above
adjustment the coefﬁcient must be nonzero, and Theorem 8.1 is applicable.
PROOF.
Without loss of generality, we may assume throughout that K is
algebraically closed. Write F and G in the form
F(X, Y, W) = f0 + f1W + · · · + fmW m
with fj ∈K[X, Y]m−j,
G(X, Y, W) = g0 + g1W + · · · + gnW n
with gj ∈K[X, Y]n−j.
(∗)
Picka point(x, y, w)at which F isnonzero, andmove it to(0, 0, 1)bya projective
transformation, so that F(0, 0, 1) ̸= 0. Regarding F and G as polynomials in W,
with coefﬁcients in A = K[X, Y], we form R(F, G), which Lemma 8.4 identiﬁes
as a member of K[X, Y]mn.
Since R(F, G) is homogeneous as a member of K[X, Y] and since K is alge-
braically closed, we can choose a point (x0, y0) ̸= (0, 0) with R(F, G)(x0, y0)
= 0.
Then the resultant of F(x0, y0, W) and G(x0, y0, W) is 0, and Theo-
rem 8.1 applies because F(x0, y0, W) has degree m in W. The theorem says
that these two polynomials in W have a common factor.
Since K is alge-
braically closed, this common factor vanishes at some w0, and then we must
have F(x0, y0, w0) = G(x0, y0, w0) = 0. This proves the ﬁrst conclusion.
For the second conclusion, suppose that V (F)∩V (G) contains mn +1 points.
Join these points by lines, and pick a point of P2
K that is not on any of the lines.
We can do so because K, being algebraically closed, is inﬁnite. Applying a
projective transformation, we may assume that the point is [0, 0, 1]. Write F and
G in the form (∗). Regarding F and G as polynomials in W, with coefﬁcients in
A = K[X, Y], we again form R(F, G), which Lemma 8.4 identiﬁes as a member
of K[X, Y]mn. For ﬁxed (x0, y0), Theorem 8.1 says that R(F, G)(x0, y0) = 0 if
and only if F(x0, y0, W) and G(x0, y0, W) have a common factor (necessarily a
common factor of the form W −w0 because K is algebraically closed), if and
only if F(x0, y0, w0) = G(x0, y0, w0) = 0 for some w0. So at each of our mn+1

466
VIII. Background for Algebraic Geometry
points, say (xi, yi, wi), we have R(F, G)(cxi, cyi) = 0 for all scalars c. Since
(xi, yi) ̸= (0, 0), R(F, G) vanishes on the line yi X −xiY = 0. Consequently
yi X −xiY divides R(F, G) in K[X, Y].
Suppose that (xi, yi) is a multiple of (xj, yj) with i ̸= j. Then (xi, yi, wi) and
(xj, yj, wj) both satisfy yi X −xiY = 0. Since (0, 0, 1) satisﬁes this also and since
(0, 0, 1) is not to be on any of the connecting lines, we obtain a contradiction.
Thus the mn+1 factors yi X−xiY are nonassociate primes in K[X, Y] dividing
R(F, G). By unique factorization for K[X, Y], their product divides R(F, G).
Since deg R(F, G) = mn, we conclude that R(F, G) = 0.
Then Theorem
8.1 shows that F and G have a nonconstant common factor in K[X, Y][W] =
K[X, Y, W]. The common factor is homogeneous by Lemma 8.3, and the second
conclusion is proved.
□
4. Intersection Multiplicity for a Line with a Curve
In this section we begin the topic of “intersection multiplicity” for projective plane
curves. The idea is that the number of points in the intersection V (F) ∩V (G) in
Bezout’s Theorem as formulated in Theorem 8.5 should actually equal mn, not
merely be bounded above by mn, if the ﬁeld is algebraically closed and the points
are counted according to their “multiplicities,” whatever that might mean.
The prototype is the factorization of a polynomial of degree n in one variable.
The polynomial has at most n roots, and it has exactly n if the ﬁeld is algebraically
closed and each root is counted according to its multiplicity. In this case, as we
well know, a root z0 of f (z) has multiplicity k if (z −z0)k is the largest power of
z −z0 that divides f (z).
Our objective in this section is to develop a notion of intersection multiplicity
for the case of a line and a curve at a point; the case of two curves is less
intuitive and is postponed to the next section. The main result is to be that the
sum of the intersection multiplicities at all points for a line and a projective
plane curve equals the degree of the curve, provided that the underlying ﬁeld is
algebraically closed and that the line does not divide the curve. The statement
in the previous paragraph about polynomials in one variable will amount to a
special case; for this special case the projective line is Y, the projective curve is
of the form W d−1Y −F(X, W), where F is homogeneous of degree d and where
f (X) = F(X, 1), and the divisibility proviso is that F not be the 0 polynomial,
i.e., that f (z) not be identically 0.
Let K be a ﬁeld, let L be in K[X, Y, W]1, and let F be in K[X, Y, W]d.
The notation for intersection multiplicity will be I (P, L ∩F), where P =
(x0, y0, w0) is in VK(F) ∩VK(L). To make the deﬁnition, we introduce afﬁne

4. Intersection Multiplicity for a Line with a Curve
467
local coordinates. Choose  in GL(3, K) with (x0, y0, w0) = (0, 0, 1), and
form the corresponding local expressions
f (X, Y) = F(−1(X, Y, 1)) = f1(X, Y) + · · · + fd(X, Y),
l(X, Y) = L(−1(X, Y, 1)).
Here fj is the part of f that is homogeneous of degree j. Since l(0, 0) = 0,
we see that l(X, Y) = bX −aY for some constants a and b not both 0. Then
ϕ(t) =

at
bt

, for t ∈K, is a parametrization of the locus in A2
K on which
l(x, y) = 0. The composition f (ϕ(t)) is a polynomial in t with f (ϕ(0)) = 0. In
fact,
f (ϕ(t)) = f1(at, bt) + f2(at, bt) + · · · + fd(at, bt)
= t f1(a, b) + t2 f2(a, b) + · · · + td fd(a, b).
There are two possibilities.
If f ◦ϕ is not the 0 polynomial, then f (ϕ(t))
has a zero of some ﬁnite order at t = 0, and this order is deﬁned to be the
intersection multiplicity, or intersection number, I (P, L ∩F). If f ◦ϕ is the
0 polynomial, then we say that I (P, L ∩F) = +∞. It will be convenient to
deﬁne I (P, L ∩F) = 0 if P is not in VK(L) ∩VK(F). We need to check that
I (P, L ∩F) does not depend on the choice of , but we postpone this veriﬁcation
until after we consider two examples.
EXAMPLES OF INTERSECTION MULTIPLICITY.
(1) Example 1 in the previous section showed that relative to a suitable  in
GL(3, K), the projective plane curve
F(X, Y, W) = X2Y + XY W + W 3
has local expression f (X, Y) about P = (x0, y0, 1) given by
f (X, Y) = (x2
0 y0 + x0y0 + 1) + (x2
0Y + 2x0y0X + x0Y + y0X)
+ (y0X2 + 2x0XY + XY) + (X2Y)
= f0 + f1(X, Y) + f2(X, Y) + f3(X, Y).
For a line L, the intersection multiplicity I (P, L ∩F) is 0 unless P lies in VK(F),
i.e., unless f0 = x2
0 y0 + x0y0 + 1 = 0. Suppose that the line L is given by
L(X, Y, W) = αX + βY + γ W,
with local expression
l(X, Y) = L(X + x0, Y + y0, 1) = (αx0 + βy0 + γ ) + (αX + βY).

468
VIII. Background for Algebraic Geometry
Here α and β are not both 0. The intersection multiplicity I (P, L ∩F) is 0 unless
P lies also in VK(L), i.e., unless αx0 + βy0 + γ = 0. Thus suppose that P lies
in VK(L) ∩VK(F). Then we can parametrize the locus for which l(x, y) = 0 by
 x
y

= ϕ(t) =

−βt
αt

, and we obtain
f1(ϕ(t)) = f1(−βt, αt) = t(x2
0α −2x0y0β + x0α −y0β),
f2(ϕ(t)) = f2(−βt, αt) = t2(y0β2 −2x0αβ + αβ).
One point lying in VK(F) is P = (x0, y0, 1) =

1, −1
2, 1

, and P lies also
in VK(L) if α −1
2β + γ = 0, i.e., if γ satisﬁes γ =
1
2β −α.
Then we
have f1(ϕ(t)) = t(2α + 3
2β) and f2(ϕ(t)) = t2(−1
2β2 −αβ). Consequently,
I (P, L ∩F) is ≥1 if and only if γ = 1
2β −α. In this case, I (P, L ∩F) is ≥2 if
and only if 2α + 3
2β = 0, i.e., if α = −3
4β. When both conditions are satisﬁed,
we have f2(ϕ(t)) = t2(−1
2β2 −αβ) = t2( 1
4β2), and this is not the 0 function
because under these conditions, β = 0 would imply that (α, β, γ ) = (0, 0, 0);
hence I (P, L ∩F) = 2.
(2) Example 2 in the previous section considered the point P = (x0, y0, w0) =
(0, 1, 0) for the same F, namely F(X, Y, W) = X2Y + XY W + W 3. This P
lies in VK(F). For a suitable , the earlier computations showed that the local
expression for F is
f (X, Y) = (Y 2 + XY) + (X3).
The most general line L for which P lies in VK(L) is αX + γ W = 0, and the
corresponding local expression is
l(X, Y) = L(Y, 1, X) = αY + γ X.
We use the parametrization ϕ(t) = (−αt, γ t) for L and obtain
f (ϕ(t)) = t2(γ 2 −αγ ) + t3(−α3).
By inspection we see that I (P, L ∩F) ≥2 for all choices of α and γ , and that
I (P, L ∩F) ≥3 if and only if γ = 0 or γ = α. If γ = 0 or γ = α, then α3
cannot be 0, and thus I (P, L ∩F) = 3.
Let us return to the veriﬁcation that I (P, L ∩F) does not depend on the choice
of . Thus suppose that  is another member of GL(3, K) with (x0, y0, w0) =
(0, 0, 1). Write
 ◦−1 =
- α
β
0
γ
δ
0
r
s
1
.
,

4. Intersection Multiplicity for a Line with a Curve
469
form the local expressions
f ′(X, Y) = F(−1(X, Y, 1)) = f ′
1(X, Y) + · · · + f ′
d(X, Y),
l′(X, Y) = L(−1(X, Y, 1)) = b′X −a′Y,
and parametrize the locus in A2
K with l′(x, y) = 0 by

x
y

= ϕ′(t) =

a′t
b′t

.
We need a lemma.
Lemma 8.6. In the above notation, f (X, Y) equals
(r X + sY + 1)d−1 f ′
1(αX + βY, γ X + δY)
+ (r X + sY + 1)d−2 f ′
2(αX + βY, γ X + δY)
+ · · · + f ′
d(αX + βY, γ X + δY),
and therefore
f1(X, Y) = f ′
1(αX + βY, γ X + δY).
PROOF. For the ﬁrst conclusion, let us justify the following computation:
f (X, Y) = (F ◦−1)( ◦−1)(X, Y, 1)
= (F ◦−1)(αX + βY, γ X + δY,r X + sY + 1)
= (F ◦−1)

(r X + sY + 1)
 αX+βY
r X+sY+1,
γ X+δY
r X+sY+1, 1

= (r X + sY + 1)d f ′ αX+βY
r X+sY+1,
γ X+δY
r X+sY+1

= (r X + sY + 1)d( f ′
1 + · · · + f ′
d)
 αX+βY
r X+sY+1,
γ X+δY
r X+sY+1

= (r X + sY + 1)d−1 f ′
1(αX + βY, γ X + δY)
+ (r X + sY + 1)d−2 f ′
2(αX + βY, γ X + δY)
+ · · · + f ′
d(αX + βY, γ X + δY).
In fact, the ﬁrst three lines are valid if we make the computation in the ﬁeld of
fractions K(X, Y), the fourth line uses the homogeneity of F and a substitution
homomorphism that evaluates members of K[X, Y, W] at points of K(X, Y, W),
and the remaining lines use the homogeneity of f ′
1, . . . , f ′
d and a substitution
homomorphism that evaluates their arguments at points of K(X, Y).

470
VIII. Background for Algebraic Geometry
This proves the ﬁrst conclusion. To derive the second conclusion from it, we
expand each of the coefﬁcients on the right side and group terms of the same
degree of homogeneity under (X, Y) 	→(λX, λY). The only term whose degree
of homogeneity is 1 is f ′
1(αX+βY, γ X+δY) with a coefﬁcient 1 coming from the
expansion of (r X+sY +1)d−1; all other terms have higher degree of homogeneity.
When f (X, Y) on the left side is expanded as a sum of homogeneous polynomials,
the term of degree 1 is f1(X, Y). The second conclusion follows.
□
Continuing with the veriﬁcation that I (P, L ∩F) does not depend on the
choice of , we apply Lemma 8.6 to L in place of F, and we obtain
l(X, Y) = l′(αX + βY, γ X + δY).
Since l(X, Y) = bX −aY and l′(X, Y) = b′X −a′Y, this equation shows that
b = b′α −a′γ
and
−a = b′β −a′δ.
Putting  = αδ −βγ , we solve for a′ and b′ and obtain
αa + βb = a′
and
γ a + δb = b′.
When x = at and y = bt, we thus have
αx + βy = αat + βbt = ta′
and
γ x + δy = γ at + δbt = tb′.
Substituting these formulas into the ﬁrst conclusion of Lemma 8.6 and using the
homogeneity of each f ′
j gives
f (ϕ(t)) = (art + bst + 1)d−1tf ′
1(a′, b′)
+ (art + bst + 1)d−2t22 f ′
2(a′, b′) + · · · + tdd f ′
d(a′, b′).
If j is the smallest index for which f ′
j (a′, b′) ̸= 0, then the lowest power of
t remaining on the right side after expansion of the coefﬁcients is t j, and its
coefﬁcient is  j f ′
j (a′, b′). Thus we can conclude that the lowest power of t with
nonzero coefﬁcient on the left side is t j, and its coefﬁcient fj(a, b) must equal
 j f ′
j (a′, b′). The equality of the lowest power of t remaining on each side shows
that I (P, L ∩F) is the same when computed from f as when computed from f ′,
and we obtain as a bonus the formula fj(a, b) =  j f ′
j (a′, b′) if t j is that power.
This completes the veriﬁcation that I (P, L ∩F) does not depend on the choice
of .
Now we come back to the circle of ideas around Bezout’s Theorem. The ﬁrst
task is to clarify the meaning of inﬁnite intersection multiplicity.

4. Intersection Multiplicity for a Line with a Curve
471
Proposition 8.7. Over the ﬁeld K if a projective line L and a projective plane
curve F meet at a point P in P2
K, then I (P, L ∩F) = +∞if and only if L
divides F.
PROOF. If L divides F, then in the above notation the local expression l(X, Y)
divides f (X, Y). Since l(ϕ(t)) is the 0 polynomial, so is f (ϕ(t)).
Conversely suppose that f (ϕ(t)) is the 0 polynomial, so that fr(a, b) = 0 for
all r with 1 ≤r ≤d = deg F. Without loss of generality, suppose b ̸= 0. The
equality
0 = fr(a, b) = c0ar + c1ar−1b + · · · + crbr
= br
c0(ab−1)r + c1(ab−1)r−1 + · · · + cr

says that Z −ab−1 is a factor of br(c0Zr + c1Zr−1 + · · · + cr). If we write
br(c0Zr + c1Zr−1 + · · · + cr) = (Z −ab−1)u(Z)
and take Z = XY −1, then
br fr(X, Y) = brY r
c0(XY −1)r + c1(XY −1)r−1 + · · · + cr

= Y r(XY −1 −ab−1)u(XY −1) = b−1l(X, Y)

Y r−1u(XY −1)

.
Hence l(X, Y) divides fr(X, Y) for all r. It follows that l(X, Y) divides f (X, Y)
and then that L divides F.
□
The full-strength version of Bezout’s Theorem says that two projective plane
curves F and G of degrees m and n meet in at most mn points even when
multiplicities are counted, and that the number is equal to mn if K is algebraically
closed and multiplicities are counted. This theorem will be proved in Section 6.
For the time being, we shall limit ourselves to the special case of the full-strength
theorem in which one of the curves is a line.
Theorem 8.8 (Bezout’s Theorem). Let K be an algebraically closed ﬁeld. If
F is a projective plane curve over K of degree d and if L is a projective line such
that L does not divide F, then 	
P I (P, L ∩F) = d.
PROOF. First we show that
	
P
I (P, L ∩F) < +∞.
(∗)
Since L is assumed not to divide F, Proposition 8.7 shows that I (P, L ∩F)
is ﬁnite at every point of VK(L) ∩VK(F). Thus 	
P I (P, L ∩F) is ﬁnite if

472
VIII. Background for Algebraic Geometry
there are only ﬁnitely many points in VK(L) ∩VK(F). Bezout’s Theorem in the
form of Theorem 8.5 shows that either VK(L) ∩VK(F) is ﬁnite or else L and
F have as a common factor some homogeneous polynomial of positive degree.
Since L has degree 1, L is prime, and thus L and F can have a common factor of
positive degree only if L divides F. We are assuming the contrary, and therefore
VK(L) ∩VK(F) is ﬁnite. This proves (∗).
Possibly by applying a projective transformation, we may assume7 that the
given line L is the line at inﬁnity W. Then the points Pj with I (Pj, W ∩F) > 0
are of the form [xj, yj, 0]. Taking into account that the algebraically closed ﬁeld
K is necessarily inﬁnite, we can apply a second projective transformation, one
that translates the Y variable, and assume that no yj is 0. Then we can write
Pj = [rj, 1, 0] with rj in K. Let us see that
H(X) = F(X, 1, 0)
is a nonzero polynomial of degree exactly d.
(∗∗)
In fact, F(X, Y, W) is homogeneous of degree d, and we have arranged that
[1, 0, 0], which certainly lies in VK(W), is not in VK(F). Consequently the Xd
term in F(X, Y, W) has nonzero coefﬁcient, and (∗∗) follows.
Next let us prove that
I

(r, 1, 0), W ∩F

= multiplicity of r as a root of H(X) = F(X, 1, 0).
(†)
Then it will follow that 	
P I (P, W ∩F) equals the number of roots of
H(X) = F(X, 1, 0), each counted as many times as its multiplicity. In view
of (∗∗) and the fact that K is algebraically closed, we will then have proved that
	
P I (P, W ∩F) = d, as required.
To prove (†), we introduce afﬁne local coordinates about(r, 1, 0), using −1 =
 1 0 r
0 0 1
0 1 0

, so that (r, 1, 0) = (0, 0, 1). The local versions f of F and l of W
relative to this  are
f (X, Y) = F(−1(X, Y, 1)) = F(X + r, 1, Y),
l(X, Y) = W(−1(X, Y, 1)) = Y.
Hence l(X, Y) is of the form bX −aY with a = −1 and b = 0. If we parametrize
l by ϕ(t) = (at, bt) = (−t, 0), then
f (ϕ(t)) = f (−t, 0) = F(−t + r, 1, 0).
7If P and P′ are distinct points in P2
K , then there exists a projective transformation carrying P
to [1, 0, 0] and P′ to [0, 1, 0]. This transformation carries the unique line through P and P′ to the
line at inﬁnity.

5. Intersection Multiplicity for Two Curves
473
The order of vanishing of f (ϕ(t)) at t = 0, which is I

[r, 1, 0], W ∩F

, thus
equals the order of the zero of F(−t + r, 1, 0) at t = 0, which equals the
multiplicity of r as a root of H(X) = F(X, 1, 0). This proves (†), and the
theorem follows.
□
5. Intersection Multiplicity for Two Curves
In this section we continue the topic of “intersection multiplicity” begun in Sec-
tion 4. That section dealt with intersection multiplicity for the special case of a
projective line and a projective plane curve, and the present section deals with
the general case of two projective plane curves. The next section will use the
general notion to address Bezout’s Theorem in full generality. In this section and
the next we shall make occasional use of material from Chapter VII, especially
Lemma 7.21 and the results in Section VII.1.
It is worth reviewing qualitatively what happened in Section 4. What we
did was refer the given line and curve to afﬁne space, parametrize the line in a
natural way, and substitute the parametrization into the formula for the curve to
obtain a scalar-valued function of one variable. The order of vanishing of the
resulting scalar-valued function of one variable was deﬁned to be the intersection
multiplicity. The classical approach8 for handling two curves proceeds by trying
to generalize this construction, in effect parametrizing one curve and substituting
into the other. The fact that there need be no natural parametrization of either
of the curves leads to a number of complications, and ultimately the argument
involves a complicated ring of power series.
We shall follow a somewhat more modern approach9 based on localizations.10
The deﬁnition is not particularly intuitive, and it is necessary to study some
examples to see its virtues. We give the deﬁnition, show that the deﬁnition is
consistent with the deﬁnition in the special case of Section 4, check that the
deﬁnition makes sense in general, state some properties that are useful in making
computations, work out an example, and then verify the properties. Thus let F
and G be homogeneous polynomials in (X, Y, W) of respective degrees m and n,
and let P = [x0, y0, w0] be a point of the projective plane P2
K over a ﬁeld K. We
refer matters back to afﬁne space in the usual way by letting  be any member
of GL(3, K) such that (x0, y0, w0) = (0, 0, 1). The local expressions from 
8An account appears in Walker, Chapter IV.
9See Fulton, Chapter 3, for the present section and Fulton, Chapter 5, for the next section.
10For a still more modern and more general approach, see Serre’sAlg`ebre Locale. Serre’s opening
sentence summarizes matters by saying, “Intersection multiplicities in algebraic geometry are equal
to certain ‘Euler–Poincar´e characteristics’ formed by means of the Tor functors of Cartan–Eilenberg.”

474
VIII. Background for Algebraic Geometry
about (0, 0) corresponding to F and G are the polynomials f and g with
f (X, Y) = F(−1(X, Y, 1)),
g(X, Y) = G(−1(X, Y, 1)).
These polynomials break into homogeneous parts as
f (X, Y) = f0 + f1(X, Y) + · · · + fm(X, Y),
g(X, Y) = g0 + g1(X, Y) + · · · + gn(X, Y),
with fj and gj homogeneous of degree j in the pair (X, Y). We assume that P
lies on the locus VK(F)∩VK(G) of common zeros of F and G, and the condition
for this to happen is that f0 = g0 = 0. The order of vanishing m P(F) of F at
P is the ﬁrst j for which fj is not the zero polynomial; we saw as a consequence
of Lemma 8.6 that this quantity is well deﬁned independently of the choice of .
The intersection multiplicity I (P, F ∩G) of F and G at P can be deﬁned in
either of two equivalent ways. The equivalence of the two deﬁnitions will be used
repeatedly in the discussion and follows from the fact that localization commutes
with passage to the quotient by an ideal, a fact that was proved as Lemma 7.21.
One deﬁnition is
I (P, F ∩G) = dimK

K[X, Y]/( f, g)

(0,0)

,
where

K[X, Y]/( f, g)

(0,0) is the localization at (0, 0) of the K algebra
K[X, Y]/( f, g). That is, we form the quotient ring of K[X, Y] by the ideal
generated over K by f and g, localize with respect to the maximal ideal of all
members of the quotient vanishing at (0, 0), and compute the dimension of this
localization over K. The other deﬁnition is
I (P, F ∩G) = dimK

S−1K[X, Y]

S−1( f, g)

,
where S is the multiplicative system in K[X, Y] consisting of the complement of
the maximal ideal (X, Y), i.e., consisting of all polynomials that are nonvanishing
at (0, 0). In either case all elements of the ring being localized have interpretations
as functions, and the multiplicative system consists of all the functions that are
nonzero at a certain point. Nevertheless, the matter is a little subtle because
some members of the multiplicative system in the ﬁrst case may be zero divisors.
Here is a lower-dimensional example of that phenomenon that can also serve as
a guiding example for Theorem 8.12 below.

5. Intersection Multiplicity for Two Curves
475
EXAMPLE OF GEOMETRIC LOCALIZATION. R =

K[X]/((X2(X −1)2))

(0),
with the subscript indicating localization at 0. Before passage to the localization,
the quotient Q = K[X]/((X2(X −1)2)) has dimension 4, with a basis consisting
of the cosets of 1, X, X2, X3. The multiplicative system S for localization at 0
consists of all members of the quotient that are nonzero at 0. The localization as a
set consists of equivalence classes of pairs (r, s) with r in Q and s in S, two pairs
(r, s) and (r′, s′) being equivalent if t(rs′−r′s) = 0 for some t in S. Localization
is a ring homomorphism, and we therefore consider the pairs (r, s) in the class of
the additive identity. These have t(r1 −0s) = 0 for some t. Then t and r have
representatives t(X) and r(X) in K[X] such that t(X)r(X) = p(X)X2(X −1)2
for some p(X). Furthermore, t(0) ̸= 0. Then X2 must divide r(X), and this
condition is also sufﬁcient for the choice t(X) = (X −1)2. Thus the members
X2q(X) of K[X] give 0 in the localization, and the localization is isomorphic to
the 2-dimensional algebra K[X]/(X2).
Proposition 8.9 below will show that I (P, F ∩G) is independent of the func-
tion  used to introduce afﬁne local coordinates. Assuming this independence,
we begin with an example that shows that the deﬁnition is consistent with the
deﬁnition in Section 4.
EXAMPLE 1 OF INTERSECTION MULTIPLICITY. Case of a line L and a curve
F homogeneous of degree d. Assuming that P lies in VK(L) ∩VK(F), we
introduce afﬁne local coordinates by means of a member  of GL(3, K) that
carries a representative of P to (0, 0, 1), and we let l(X, Y) and f (X, Y) be
the corresponding local expressions for L and F.
Let f = f1 + · · · + fd
be the decomposition of f into its homogeneous parts. Since the intersection
multiplicity is being assumed to be independent of the choice of  and since for
any second point on a line through (0, 0, 1), there exists a  that ﬁxes (0, 0, 1)
and carries that second point to (1, 0, 1), we may assume that l(X, Y) = Y. We
introduce the parametrization (x, y) = ϕ(t) = (t, 0) for the line l(X, Y) and
substitute into f (X, Y), obtaining f (ϕ(t)) = f1(t, 0) + · · · + fd(t, 0). In the
deﬁnition of Section 4, the intersection multiplicity is the leastr such that fr(t, 0)
is not identically 0, or else it is +∞if f (ϕ(t)) is identically 0. With the new
deﬁnition we observe from the deﬁnition of r that f is of the form
f (X, Y) = (cr Xr + · · · + cd Xd) + Yg(X, Y) = cr Xr(1 + Xh(X)) + Yg(X, Y)
with cr ̸= 0, g(X, Y) ∈K[X, Y], and h(X) ∈K[X]. The ideal in K[X, Y]
generated by Y and f is the same as the ideal generated by Y and Xr(1+ Xh(X)).
Hence
K[X, Y]/(Y, f ) ∼= K[X, Y]/(Y, Xr(1 + Xh)) ∼= K[X]/(Xr(1 + Xh)).

476
VIII. Background for Algebraic Geometry
The polynomial 1 + Xh(X) takes a nonzero value at 0 and hence is a member of
the multiplicative system that we use to form the localization. Thus

K[X, Y]/(Y, f )

(0,0) ∼=

K[X]/(Xr(1 + Xh))

(0) ∼=

K[X]/(Xr)

(0).
The dimension of the right side is r, and thus the new deﬁnition of intersection
multiplicity matches the old one.
Proposition 8.9. The intersection multiplicity of two projective plane curves
F and G at P is well deﬁned independently of the member of  that moves a
representative of P to (0, 0, 1).
PROOF. It is enough to take P = [0, 0, 1] and to compare the effect of passing
to afﬁne local coordinates determined by the identity with the effect of passing
to the coordinates determined by a general element  of GL(3, K) of the form
 =
 α β 0
γ δ 0
r s 1

. Let deg F = m and deg G = n. If f (X, Y) = F(X, Y, 1) and
f (X, Y) = F(−1(X, Y, 1)), then the computation in the proof of Lemma 8.6
shows that
f (X, Y) = (1 + r X + sY)m f
 αX+βY
1+r X+sY ,
γ X+δY
1+r X+sY

.
(∗)
Similarly if g(X, Y) = G(X, Y, 1) and g(X, Y) = G(−1(X, Y, 1)), then
g(X, Y) = (1 + r X + sY)n g
 αX+βY
1+r X+sY ,
γ X+δY
1+r X+sY

.
Let
X′ =
αX+βY
1+r X+sY ,
Y ′ =
γ X+δY
1+r X+sY ,
and
−1 =
 α′ β′ 0
γ ′ δ′ 0
r′ s′ 1

.
Itispurelyaformalmatterthatthemapping T deﬁnedby(T h)(X, Y) = h(X′, Y ′)
is a ﬁeld isomorphism of K(X, Y) onto K(X′, Y ′).
It sends K[X, Y] onto
K[X′, Y ′] and sends

K[X, Y]

(0,0) onto

K[X′, Y ′]

(0,0). Referring to the formu-
las for X′ and Y ′, we see that the image of K[X, Y] is contained in the localization

K[X, Y]

(0,0); by the universal mapping property of localizations, the image of

K[X, Y]

(0,0) is contained in

K[X, Y]

(0,0). Comparing these two conclusions,
we see that

K[X′, Y ′]

(0,0) ⊆

K[X, Y]

(0,0).
Meanwhile, we can solve the equations deﬁning X′ and Y ′ for X and Y. If we
compare the results with the formula for −1, we ﬁnd that
X =
α′X′+β′Y ′
1+r′X′+s′Y ′
and
Y =
γ ′X′+δ′Y ′
1+r′X′+s′Y ′ .

5. Intersection Multiplicity for Two Curves
477
Thus the situation is symmetric, and we have

K[X, Y]

(0,0) ⊆

K[X′, Y ′]

(0,0).
Consequently the mapping
(T h)(X, Y) = h
 αX+βY
1+r X+sY ,
γ X+δY
1+r X+sY

is an algebra automorphism of

K[X, Y]

(0,0).
To prove the proposition, recall that localization commutes with passage to the
quotient by an ideal. In view of (∗), it is therefore enough to show that
dimK

K[X, Y]

(0,0)

( f, g)

?= dimK

K[X, Y]

(0,0)

((1 + r X + sY)mT f, (1 + r X + sY)nTg)

.
(∗∗)
The factor (1 + r X + sY) is a unit in

K[X, Y]

(0,0), and we can simplify the
quotient algebra on the right side of (∗∗) to

K[X, Y]

(0,0)

(T f, Tg).
In turn, this algebra is K isomorphic to

K[X, Y]

(0,0)

( f, g) because T is an
automorphism of

K[X, Y]

(0,0). The dimensional equality in (∗∗) follows.
□
Let us extend the deﬁnition of intersection multiplicity to include the case
that the point of interest does not lie in the locus of common zeros. We deﬁne
I (P, F ∩G) = 0 if P is not in VK(F) ∩VK(G).
Assume now that K is
algebraically closed. Below we compute a fairly typical example of intersection
multiplicity. To do so, we shall make use of certain properties of I (P, F ∩G)
that we list in Theorem 8.10 below. In fact, there is an algorithm for computing
I (P, F ∩G) using only these properties,11 but we shall not give it.
Before stating the properties, we need to make some deﬁnitions. Recall from
earlierinthesectionthattheorderofvanishingm P(G)of G at P iscomputedusing
a suitable  in GL(3, K) to refer G to afﬁne local coordinates about P, deﬁning
g(X, Y) = G(−1(X, Y, 1)), expanding g(X, Y) as a sum of homogeneous terms
g(X, Y) = g0 + g1(X, Y)+· · ·+ gn(X, Y), and deﬁning m P(G) to be the least j
such that gj is not the 0 polynomial. The homogeneous polynomial gj(X, Y) is X j
times a polynomial in the one variable Y X−1, and the fact that K is algebraically
closed implies that gj has a factorization of the form
gj(X, Y) = c

i
(αi X + βiY)mi
11Fulton, p. 76.

478
VIII. Background for Algebraic Geometry
with c in K. Here j = 	
i mi, and the pairs (αi, βi) correspond to distinct
members of P1
K that are uniquely determined up to indexing if c ̸= 0.
Let
li(X, Y) = αi X + βiY, and let Li be the corresponding projective line. We
refer to all the lines Li as the tangent lines to G at P, and we say that mi is the
multiplicity of Li. The geometry of the situation is indicated in Problem 12 at
the end of the chapter.
Theorem 8.10. Let K be an algebraically closed ﬁeld, let P be in P2
K, and let
F and G be projective plane curves over K. Then the intersection multiplicity
I (P, F ∩G) has the following properties:
(a) I (P, F ∩G) = I (P, G ∩F),
(b) I (P, F ∩G) = I (P, F ∩(G + H F)) for any projective plane curve H
with deg H F = deg G such that G + H F ̸= 0,
(c) I (P, F ∩G) > 0 if and only if P lies in VK(F) ∩VK(G),
(d) I (P, F ∩G) ≤I (P, AF ∩BG) for any projective plane curves A and
B, with equality if A and B are nonvanishing at P,
(e) I (P, F ∩G) is ﬁnite if and only if F and G have no common factor of
degree ≥1 having P on its zero locus,
(f) I (P, F ∩GH) = I (P, F ∩G) + I (P, F ∩H) and consequently if F =

i Fri
i and G = 
j G
sj
j , then I (P, F ∩G) = 	
i, j risj I (P, Fi ∩Gj),
(g) I (P, F ∩G) ≥m P(F)m P(G), with equality if F and G have no tangent
lines in common at P.
REMARKS.
Properties (a) and (b) are evident.
Properties (c) and (d) are
conversational and will be proved in these remarks. Properties (e), (f), and (g)
require proofs, and we give those proofs after computing an example. For (c), if
P lies in VK(F)∩VK(G), then the local expressions f (X, Y) and g(X, Y) vanish
at 0, and so does every member of the ideal ( f, g); therefore ( f, g) is a proper ideal
in

K[X, Y]

(0,0), and the dimension of the quotient is positive. Conversely if P is
not in VK(F), say, then f (X, Y) lies in the multiplicative system S of nonvanish-
ing polynomials at (0, 0), and S−1( f, g) = (1); hence S−1K[X, Y]/S−1( f, g) =
0, and I (P, F ∩G) = 0. For (d), S−1(af, bg) ⊆S−1( f, g) with equality if a and
b are nonvanishing at (0, 0), and hence S−1K[X, Y]/S−1( f, g) is a homomorphic
image of S−1K[X, Y]/S−1(af, bg) and is a one-one homomorphic image if a and
b are nonvanishing at (0, 0).
EXAMPLE 2 OF INTERSECTION MULTIPLICITY. Let K = C, and let the two
projective curves be the homogeneous versions of Y 2 = X3 and Y 2 = X5. In
other words, let
F(X, Y, W) = Y 2W −X3
and
G(X, Y, W) = Y 2W 3 −X5.

5. Intersection Multiplicity for Two Curves
479
We compute I (P, F ∩G) for all points P in VK(F) ∩VK(G). In the afﬁne
plane the intersections (x, y) may be found by substituting the one equation into
the other (or, with more effort in this case, by using the resultant). We obtain
x5 −x3 = 0. This gives x3(x2 −1) = 0. The factor x2 −1 has two distinct
roots, and each gives two distinct y’s. Thus we obtain the ﬁve afﬁne solutions
(+1, ±1), (−1, ±i), (0, 0). The fact that the ﬁrst four occurred routinely with
multiplicity 1 translates into intersection multiplicity 1 for each: In fact, (b) shows
that I (P, F ∩G) = I (P, F ∩(W 2F −G)), and W 2F −G restricts at (X, Y, 1)
to X5 −X3 = X3(X2 −1). At each of the points (+1, ±1), X5 −X3 when
viewed as equal to 0 has a vertical tangent X −1 of multiplicity 1, while Y 2 −X3
has a tangent that is not vertical. A similar argument applies at each of the points
(−1, ±i). By (g), the intersection multiplicity is 1 at each of the four points
(+1, ±1) and (−1, ±i).
Next let us consider (0, 0). The order of X5 −X3 is 3, and the homogeneous
term of degree 3, namely −X3, factors as the cube of a linear factor that gives
the vertical line X. Meanwhile, Y 2 −X3 has order 2 at (0, 0), and Y 2 factors
as the square of a linear factor that gives the horizontal line Y. The two curves
have no tangents in common. Hence equality holds in (g), and the intersection
multiplicity is 6 at (0, 0).
Finally let us check points (x, y, w) on the line at inﬁnity, i.e., those with
w = 0. Putting w = 0 in the formula F = G = 0 shows that x = 0. Thus
the only point of VK(F) ∩VK(G) on the line at inﬁnity is P = [x0, y0, w0] =
[0, 1, 0]. The local versions of F and G may be given in the variables X and
W by restricting (X, Y, W) to (X, 1, W) and considering the polynomials about
(x, w) = (0, 0). As above, (b) gives I (P, F ∩G) = I (P, F ∩(W 2F −G)), but
F = Y 2W −X3 restricts to W −X3 and W 2F −G = −W 2X3 + X5 remains
unchanged upon restriction. The respective lowest-order terms, in factored form,
are W and −X3(X + W)(X −W). None of the factors of the ﬁrst polynomial
matches a factor of the second polynomial, and (g) says that the intersection
multiplicity is 1 · 5 = 5.
The upshot is that we get multiplicity 6 from (0, 0), multiplicity 1 apiece from
four other points in the afﬁne plane, and multiplicity 5 from P = [0, 1, 0]. The
total is 15, the product of the degrees of the given curves, as it must be if we are
to have any chance of obtaining the desired generalization of Bezout’s Theorem.
To get at Theorem 8.10, we make use of a structure theorem about ideals I in
K[X1, . . . , Xn] for which V (I) is a ﬁnite set. To prove the structure theorem,
which appears as Theorem 8.12 below, we ﬁrst prove a lemma about the radical
√
I of an ideal I, a notion deﬁned in Section VII.1.
Lemma 8.11. If R is a commutative Noetherian ring and I is an ideal in R,
then (
√
I )m ⊆I for some integer m ≥1.

480
VIII. Background for Algebraic Geometry
PROOF.
Since R is Noetherian, the ideal
√
I is ﬁnitely generated.
Let
{a1, . . . , an} be a set of generators for it. By deﬁnition of radical, choose integers
k1, . . . , kn such that a
kj
j is in I for 1 ≤j ≤n, and put m = 	n
j=1 kj. The most
general element of
√
I is of the form 	n
j=1 rjaj with all rj in R. The mth power
of this element is a sum of terms of the form ral1
1 · · · alnn with 	n
j=1 lj = m. In
view of the deﬁnition of m, we must have lj ≥kj for some j. Then the factor a
lj
j
is in I, and hence the whole term ral1
1 · · · alnn is in I.
□
Theorem 8.12. Let K be an algebraically closed ﬁeld, and let I be an ideal
in the polynomial ring K[X1, . . . , Xn] whose locus of common zeros in K n is
a ﬁnite set {P1, . . . , Pk}. Then K[X1, . . . , Xn]/I is isomorphic as a ring to the
product of its localizations at the points Pj:
K[X1, . . . , Xn]/I ∼=
k
j=1

K[X1, . . . , Xn]/I

(Pj).
Consequently
dimK(K[X1, . . . , Xn]/I) =
k

j=1
dimK

K[X1, . . . , Xn]/I

(Pj).
REMARKS. The one-variable case is a guide: The ideal I is principal, and we
can write K[X]/I as K[X]/(k
j=1 (X −cj)mj). The points Pj of the theorem are
the members cj of K, and the same argument as for the ﬁrst example of the section
shows that

K[X]/(
j (X−cj)mj)

(cj) ∼= K[X]/(X−cj)mj. The isomorphism of
the theorem therefore reduces to an instance of the Chinese Remainder Theorem.
PROOF. Let ϕj : K[X1, . . . , Xn]/I →

K[X1, . . . , Xn]/I

(Pj) be the canoni-
cal homomorphism, and let ϕ = (ϕ1, . . . , ϕk). The mapping ϕ is a ring homomor-
phism into k
j=1

K[X1, . . . , Xn]/I

(Pj), and we shall prove that ϕ is one-one
onto. Doing so requires some preparation.
Let Ij be the maximal ideal of all polynomials vanishing at Pj. The Null-
stellensatz (Theorem 7.1) shows that
√
I consists of all f ∈K[X, Y] such
that f vanishes at each Pi, i.e., that
√
I = k
j=1 Ij. Lemma 8.11 shows that
(
√
I )m ⊆I for some m, and thus
 k
j=1 Ij
m ⊆I. For i ̸= j, I m
i + I m
j is an
ideal whose locus of common zeros is empty, and the Nullstellensatz shows that
I m
i + I m
j
= K[X1, . . . , Xn]. The Chinese Remainder Theorem (Theorem 8.27
of Basic Algebra) therefore applies and shows that the intersection k
j=1 I m
j and

5. Intersection Multiplicity for Two Curves
481
the product k
j=1 I m
j coincide. Similarly Ii + Ij = K[X1, . . . , Xn], and hence
k
j=1 Ij = k
j=1 Ij. Putting these facts together, we conclude that
k
j=1
I m
j =
k
j=1
I m
j =

k
j=1
Ij
m =

k
j=1
Ij
m ⊆I.
(∗)
Let us now denote members of K[X1, . . . , Xn] by uppercase letters and their
cosets modulo I by the corresponding lowercase letters.
Let us observe for
1 ≤i ≤k that there exists Fi ∈K[X1, . . . , Xn] with Fi(Pj) = δi j. In fact, we
start from the special case that if P ̸= Q, then there exists F with F(P) = 1
and F(Q) = 0. For the special case, P and Q differ in some coordinate; say that
xl(P) ̸= xl(Q). Then the polynomial
F(X1, . . . , Xn) = (Xl −xl(Q))(xl(P) −xl(Q))−1
has the required properties. To construct F1 with F1(Pj) = δ1 j, choose Gj
with Gj(P1) = 1 and Gj(Pj) = 0. Then F1 = 
i̸=1 Gi has F1(P1) = 1 and
F1(Pj) = 0 for j ̸= 1. The polynomials F2, . . . , Fk are constructed similarly.
With m as in the second paragraph of the proof, ﬁx j and deﬁne Ei =
1 −(1 −Fm
i )m. This is divisible by Fm
i
and hence lies in I m
j
if i ̸= j. In
addition, 1 −Fm
j lies in Ij, and hence 1 −Ej = (1 −Fm
j )m is in I m
j . Therefore
1 −	k
i=1 Ei = (1 −Ej) −	
i̸= j Ei lies in I m
j . Since the left side is independent
of j, 1 −	k
i=1 Ei lies in k
j=1 I m
j , and we conclude from (∗) that
1 −
k	
i=1
Ei
lies in I.
(∗∗)
We just saw that Ei lies in 
j̸=i I m
j . Hence if i ̸= j, then Ei Ej lies in k
l=1 I m
l
⊆
I. Passing to cosets modulo I, we ﬁnd from this fact and from (∗∗) that
eiej = 0 for i ̸= j,
and that
k	
i=1
ei = 1.
(†)
Multiplying the second equation by ej and substituting from the ﬁrst equation,
we obtain
e2
i = ei
for all i.
(††)
Using (†) and (††), let us prove for each i that
to each G ∈K[X1, . . . , Xn] with G(Pi) ̸= 0
corresponds a polynomial H with hg = ei.
(‡)

482
VIII. Background for Algebraic Geometry
In fact, we may assume that G(Pi) = 1. Let Q be the member of Ii given by
Q = 1 −G. The element Qm Ei is in I m
i
because Q is in Ii, and it is in I m
j
for j ̸= i because Ei is in I m
j for j ̸= i. Thus Qm Ei is in k
j=1 I m
j
⊆I, and
qmei = 0. Consequently
g(ei +qei + · · · +qm−1ei) = (1 −q)ei(1 +q + · · · +qm−1) = ei(1 −qm) = ei,
and H = Ei(1 + Q + · · · + Qm−1) is a polynomial as in (‡).
Now we can prove that ϕ is one-one. If f is a member of K[X1, . . . , Xn]/I
such that ϕ( f ) = 0, then ϕi( f ) = 0 for all i. This means that there exists a
member gi of the multiplicative system for localization at Pi such that gi f = 0.
Any corresponding polynomial Gi has Gi(Pi) ̸= 0. By (‡), there exists hi with
higi = ei. Then (†) gives f = 	k
i=1 ei f = 	k
i=1 higi f = 0. Thus ϕ is
one-one.
For the proof that ϕ is onto, we recall that the multiplicative system used to
obtain

K[X1, . . . , Xn]/I

(Pj) consists of the elements K[X1, . . . , Xn]/I that
are nonzero at Pj, and ϕj carries these to units in

K[X1, . . . , Xn]/I

(Pj). Since
Ej(Pj) = 1, ϕj(ej) is a unit. For i ̸= j, we have ϕj(ei)ϕj(ej) = ϕj(eiej) = 0,
and therefore ϕj(ei) = 0. Consequently
ϕj(ej) =
k	
l=1
ϕj(el) = ϕj
 k	
l=1
el

= ϕj(1) = 1,
and ϕj(ej) is the identity of

K[X1, . . . , Xn]/I

(Pj).
The localization at
Pj consists of the equivalence classes of all pairs (rj, sj) with rj and sj in
K[X1, . . . , Xn]/I and sj in the multiplicative system for index j.
Thus let
such pairs (rj, sj) be given for 1 ≤j ≤k. We are to produce an element a
of K[X1, . . . , Xn]/I such that ϕj(a) = ϕj(rj)(ϕj(sj))−1 for all j. Use of (‡)
produces hj with hjsj = ej for all j, and this element has the property that
ϕj(hj)ϕj(sj) = ϕj(ej) = 1, hence that ϕj(hj) = ϕj(sj)−1. Consequently the
element a = 	
j rjhjej has the property that
ϕj(a) = ϕj
 	
i
rihiei

= 	
i
ϕj(ri)ϕj(hi)ϕj(ei) = ϕj(rj)(ϕj(sj))−1
and exhibits ϕ as onto.
□
Corollary 8.13. Let K be an algebraically closed ﬁeld, and let I be an ideal
in the polynomial ring K[X1, . . . , Xn] whose locus of common zeros in K n is a
ﬁnite set {P1, . . . , Pk}. Then K[X1, . . . , Xn]/I is ﬁnite-dimensional, and so is
the localization

K[X1, . . . , Xn]/I

(Pj) for each j.

5. Intersection Multiplicity for Two Curves
483
PROOF. This is a corollary partly of the statement of Theorem 8.12 and partly
of the proof. Let m be as in the proof. If I0 is the maximal ideal (X1, . . . , Xn)
of K[X1, . . . , Xn], then I m
0 is the ideal generated by all monomials of degree m,
and K[X1, . . . , Xn]/I m
0 is ﬁnite-dimensional. Consequently the maximal ideal
Ij = (X1 −x1(Pj), . . . , Xn −xn(Pj)) has the property that K[X1, . . . , Xn]/I m
j
is ﬁnite-dimensional. Since I m
i + I m
j
= K[X1, . . . , Xn] for i ̸= j, the Chinese
Remainder Theorem shows that
K[X1, . . . , Xn]

k
j=1
I m
j ∼=
k
j=1
K[X1, . . . , Xn]/I m
j ,
and the left side is therefore ﬁnite-dimensional. By (∗) in the proof of Theorem
8.12, k
j+1 I m
j
⊆I, and hence K[X1, . . . , Xn]/I is ﬁnite-dimensional. Then

K[X1, . . . , Xn]/I

(Pj) is ﬁnite-dimensional as a consequence of the statement
of Theorem 8.12.
□
PROOF OF THEOREM 8.10e. If F and G have a common factor H of degree
≥1 such that H(P) = 0, we may assume that H is irreducible. Introduce afﬁne
local coordinates about P. If f, g, h denote the local versions of F, G, H, then
the ideal ( f, g) of K[X, Y] is contained in the principal ideal (h). The latter
ideal is proper because h(0, 0) = 0, and the irreducibility of H thus implies that
(h) is prime. If S denotes the multiplicative system in K[X, Y] of polynomials
that are nonvanishing at (0, 0), then S−1( f, g) ⊆S−1(h), and we have a natural
quotient homomorphism of S−1K[X, Y]/S−1( f, g) onto S−1K[X, Y]/S−1(h).
The latter is isomorphic as a K algebra to (K[X, Y]/(h))(0,0), and the dimension
of this localization is a lower bound for I (P, F ∩G). Since K[X, Y]/(h) is an
integral domain, K[X, Y]/(h) maps one-one into any localization of itself, and
dimK(K[X, Y]/(h)) is a lower bound for I (P, F ∩G). Since h is nonconstant,
either X or Y actually occurs in it, say Y. Then h divides no member of K[X], and
the mapping of K[X] into cosets modulo (h) is one-one. Therefore K[X, Y]/(h)
contains a subalgebra isomorphic to K[X] and must be inﬁnite-dimensional.
Conversely if F and G have no common factor of degree ≥1 with P on its
locus, then (d) shows that we may assume F and G to have no common factor of
degree ≥1 of any kind. In this case Theorem 8.5 shows that the locus of common
zeros of F and G is ﬁnite, and Corollary 8.13 shows that I (P, F ∩G) is ﬁnite. □
PROOF OF THEOREM 8.10f. We are to prove that
I (P, F ∩GH) = I (P, F ∩G) + I (P, F ∩H).
(∗)
If F and GH have a common factor of degree ≥1 that vanishes at P, then F and
one of G and H have such a factor. By symmetry we may assume that F and G

484
VIII. Background for Algebraic Geometry
have that common factor. Then the left side of (∗) and the ﬁrst term on the right
are inﬁnite by (e), and (∗) is veriﬁed.
Thus we may assume that F and GH have no common factor that vanishes
at P. If F has a prime factor that does not vanish at P, then (d) shows that we
can drop that factor from all three appearances of F in (∗). In other words, it is
enough to prove (f) under the assumption that F and GH have no common factor
of degree ≥1 of any kind.
With this assumption in place, introduce afﬁne local coordinates about P, let S
denote the multiplicative system in K[X, Y] of polynomials that are nonvanishing
at (0, 0), and let f, g, h be the local versions of the given curves F, G, H. The
inclusion of ideals ( f, gh) ⊆( f, g) induces an inclusion S−1( f, gh) ⊆S−1( f, g)
and then an onto algebra homomorphism
ϕ : S−1K[X, Y]/S−1( f, gh) →S−1K[X, Y]/S−1( f, g).
We shall exhibit a K vector-space isomorphism ψ of S−1K[X, Y]/S−1( f, h) onto
ker ϕ, and the resulting dimensional equality
dimK

S−1K[X, Y]/S−1( f, gh)

= dimK

S−1K[X, Y]/S−1( f, g)

+ dimK

S−1K[X, Y]/S−1( f, h)

(∗∗)
will prove (∗) and hence (f). We deﬁne
 : S−1K[X, Y] →S−1K[X, Y]/S−1( f, gh)
as a K linear map by (u) = gu + S−1( f, gh). If af + bh is in S−1( f, h), then
(af + bh) = af g + bgh + S−1( f, gh) = S−1( f, gh). Thus  descends to a
K linear map ψ of S−1K[X, Y]/S−1( f, h) into S−1K[X, Y]/S−1( f, gh). It is
evident that ϕ = 0 and hence that ϕψ = 0, i.e., image ψ ⊆ker ϕ.
If any member u+S−1( f, gh) of ker ϕ is given, then 0 = ϕ(u+S−1( f, gh)) =
u + S−1( f, g) shows that u is in S−1( f, g). Say that u = af + bg. Then
ψ(b+S−1( f, h)) = bg+S−1( f, gh) = bg+af +S−1( f, gh) = u+S−1( f, gh)
shows that image ψ ⊇ker ϕ. Hence image ψ = ker ϕ, i.e., ψ is onto.
To see that ψ is one-one, suppose that ψ(u + S−1( f, h)) is the 0 coset, i.e.,
that gu + S−1( f, gh) = S−1( f, gh). Then gu = af + bgh with u, a, b in
S−1K[X, Y]. Clearing fractions, we may assume that u, a, b are in K[X, Y].
The formula g(u −bh) = af in K[X, Y], in the presence of the assumption that
F and G have no common factor of degree ≥1, implies that f divides u −bh.
Write u −bh = cf with c in K[X, Y]. Then u = cf + bh, and u lies in the ideal
( f, h). In other words, u + S−1( f, h) is the trivial coset, and ψ has been shown
to be one-one. This proves (∗∗) and hence (f).
□

5. Intersection Multiplicity for Two Curves
485
Lemma 8.14. For any ﬁeld K, let{Li}i≥1 be a system of nonzero homogeneous
polynomials in K[X, Y] of the form Li = ai X + biY, let {Mj}j≥1 be another
such system with Mj = cj X +djY, and suppose that no Li is a scalar multiple of
some Mj. For n ≥1, let B0, . . . , Bn be the system of homogeneous polynomials
Bk = L1 · · · Lk M1 · · · Mn−k
for 0 ≤k ≤n.
Then {B0, . . . , Bn} is a vector-space basis of the space K[X, Y]n of all homoge-
neous polynomials in (X, Y) of degree n.
PROOF. The set {B0, . . . , Bn} has n + 1 elements, and n + 1 is the dimension
of K[X, Y]n because {Xn, Xn−1Y, . . . , Y n} is a basis. Thus it is enough to show
that {B0, . . . , Bn} is linearly independent. If we have a relation 	n
k=0 ck Bk = 0
for scalars ck, then we observe that L1 divides each Bk for k ≥0, and L1 does
not divide B0 because by assumption L1 does not divide any factor Mj. Thus
c0 = 0. In effect, case n of the lemma has now been reduced to case n −1, and
the result readily follows by induction.
□
PROOF OF THEOREM 8.10g. Put p = m P(F) and q = m P(G). We pass
to afﬁne local coordinates about P, letting f and g be the members of K[X, Y]
corresponding to F and G. If I denotes the maximal ideal I = (X, Y) in K[X, Y],
then f lies in I p and g lies in I q. We form the following sequence of K vector
spaces and K linear mappings:
K[X,Y]/I q⊕K[X,Y]/I p
ψ
−→K[X,Y]/I p+q
ϕ
−→K[X,Y]/(I p+q+( f, g)) −→0.
Here the mapping ϕ is the algebra homomorphism induced by the inclusion
I p+q ⊆I p+q + ( f, g), and it is onto K[X, Y]/(I p+q + ( f, g)). The mapping ψ
is deﬁned by
ψ(a + I q, b + I p) = af + bg + I p+q
and is merely K linear.
Let us see that the sequence is exact at K[X, Y]/I p+q. Since
ϕψ(a + I q, b + I p) = ϕ(af + bg + I p+q) = I p+q + ( f, g),
we obtain image ψ ⊆ker ϕ. If h + I p+q is in ker ϕ, then h is in I p+q + ( f, g),
hence is of the form u + af + bg with u in I p+q. Then h −u = af + bg, and
ψ(a + I q, b + I p) = h −u + I p+q = h + I p+q. So image ψ ⊇ker ϕ, and we
have image ψ = ker ϕ.
The mapping ψ descends to a one-one linear map of
M = (K[X, Y]/I q ⊕K[X, Y]/I p)

ker ψ

486
VIII. Background for Algebraic Geometry
into K[X, Y]/I p+q. The vector space K[X, Y]/I q may be identiﬁed with the
space of all polynomials of degree less thanq, and that space is ﬁnite-dimensional.
Similarly K[X, Y]/I p is ﬁnite-dimensional, and therefore
dimK M = dimK K[X, Y]/I q + dimK K[X, Y]/I p −dimK ker ψ.
(∗)
Meanwhile, ϕ exhibits K[X, Y]/(I p+q + ( f, g)) as isomorphic as a vector space
to (K[X, Y]/I p+q)/M. Consequently
dimK K[X, Y]/I p+q = dimK M + dimK K[X, Y]/(I p+q + ( f, g)).
(∗∗)
Combining(∗)and(∗∗)withthesimplevector-spaceisomorphism K[X, Y]/I d ∼=
K[X, Y, W]d−1 and with the fact from Section 3 that dimK K[X, Y, W]d−1 =
d+1
2

gives
dimK K[X, Y]/(I p+q + ( f, g))
= dimK K[X, Y]/I p+q −dimK K[X, Y]/I q
−dimK K[X, Y]/I p + dimK ker ψ
≥dimK K[X, Y]/I p+q −dimK K[X, Y]/I q −dimK K[X, Y]/I p
=
p+q+1
2

−
q+1
2

−
p+1
2

= pq,
(†)
with equality on the fourth line if and only if kerψ = 0.
The locus of common zeros of I p+q + ( f, g) is just {0}, and Theorem 8.12
therefore shows that
dimK

K[X, Y]/(I p+q + ( f, g))

(0,0) = dimK K[X, Y]/(I p+q + ( f, g)). (††)
The inclusion ( f, g) ⊆I p+q + ( f, g) induces an algebra homomorphism of

K[X, Y]/( f, g)

(0,0) onto

K[X, Y]/(I p+q + ( f, g))

(0,0). Therefore
dimK

K[X, Y]/( f, g)

(0,0) ≥dimK

K[X, Y]/(I p+q + ( f, g))

(0,0).
(‡)
Let S be the set-theoretic complement of I = (X, Y) in K[X, Y]. Because of the
isomorphism S−1K[X, Y]/S−1J ∼=

K[X, Y]/J

(0,0) for any ideal J, equality
will hold in (‡) if S−1( f, g) = S−1(I p+q + ( f, g)). Combining (†), (††), and
(‡), we ﬁnd that
I (P, F ∩G) ≥pq,
(‡‡)

5. Intersection Multiplicity for Two Curves
487
with equality if
I p+q ⊆S−1( f, g)
and
ψ is one-one.
(§)
Inequality (‡‡) completes the proof of the inequality in (g) of the theorem.
Because equality holds in (‡‡) if (§) holds, we can complete the proof of all
of (g) by showing that (§) holds if F and G have no tangent line in common.
Thus for the remainder of the proof, we assume that F and G have no tangent
line in common. Let the tangent lines of F, repeated according to their multiplic-
ities, be L1, . . . , L p, and let the tangent lines of G be M1, . . . , Mq. Deﬁne Li for
i > p to be L p, and deﬁne Mj for j > q to be Mq.
In order to prove that the ﬁrst conclusion of (§), namely that I p+q ⊆S−1( f, g),
we shall prove that I t ⊆S−1( f, g) for t sufﬁciently large, and then we shall prove
by induction downward on t that I t ⊆S−1( f, g) as long as t ≥p + q. If f
and g were to have a nonconstant common factor, then a tangent line for that
common factor would be a tangent line for both f and g, and no such tangent
line exists according to our assumption. Therefore Bezout’s Theorem (Theorem
8.2) applies to f and g and shows that their locus of common zeros is ﬁnite. Let
it be {(0, 0), Q1, . . . , Ql}. The third paragraph of the proof of Theorem 8.12
shows that there exists a polynomial h in K[X, Y] such that h(0, 0) = 1 and
h(Qi) = 0 for 1 ≤i ≤l. Then Xh and Yh vanish on {(0, 0), Q1, . . . , Ql}, and
the Nullstellensatz (Theorem 7.1) shows that there exists N such that (Xh)N and
(Yh)N lie in ( f, g). Since h is in the multiplicative system S, X N and Y N lie in
S−1( f, g). Any monomial of degree ≥2N contains either a factor X N or a factor
Y N, and consequently I 2N ⊆S−1( f, g).
Proceeding inductively downward on t, suppose that I t ⊆S−1( f, g) and
that t −1 ≥p + q. As in Lemma 8.14, the polynomials deﬁned by Bk =
L1 · · · Lk M1 · · · Mt−1−k for0≤k ≤t−1formavector-spacebasisof K[X, Y]t−1.
We show that each of these lies in S−1( f, g); then we can conclude that I t−1 ⊆
S−1( f, g), and our induction will be complete. Let f = fp + fp+1 + · · · and
g = gq + gq+1 + · · · be the expansions of f and g as sums of homogeneous
polynomials in (X, Y). If Bk is given, then an inequality k ≥p would imply that
Bk contains a factor L1 · · · L p; this is fp up to a constant factor. An inequality
t −1 −k ≥q would imply that Bk contains a factor M1 · · · Mq; this is gq up to a
constant factor. Sincek < p and t−1−k < q would together imply the inequality
t −1 < p + q that we are assuming not to be the case, one of the alternatives
k ≥p and t −1 −k ≥q must occur. Say the ﬁrst occurs. Except for a constant
factor, we then have Bk = fpC for some homogeneous polynomial C(X, Y) of
degree t −1 −p. Substituting for fp gives Bk = ( f −fp+1 −· · · )C. Each term
fp+rC with r > 0 is of degree (p +r) + (t −1 −p) > t −1 and therefore lies in
I t ⊆S−1( f, g). Also, the term f C lies in S−1( f, g). Hence Bk lies in S−1( f, g).
This completes the induction, and we conclude that I p+q ⊆S−1( f, g).

488
VIII. Background for Algebraic Geometry
In order to prove the second conclusion of (§), namely that ψ is one-one,
suppose that 0 = ψ(a + I q, b + I p) = af + bg + I p+q, i.e., that all terms of
af + bg are of order ≥p + q. Write a = ar + ar+1 + · · · with ar ̸= 0 if a is not
in I q, and write b = bs + bs+1 + · · · with bs ̸= 0 if b is not in I p, so that
af + bg = ar fp + bsgq + (higher-order terms).
The right side is assumed to be in I p+q, which means that one of the following
two conditions is satisﬁed:
(i) r + p = s + q < p + q and ar fp + bsgq = 0,
(ii) ar fp is in I p+q, and bsgq is in I p+q.
If (i) holds, then the facts that ar fp = −bsgq and that f and g have no tangent
lines in common imply that fp divides bs. Since s < p, we must have bs = 0.
Therefore ar = 0, and the conditions on ar and bs imply that a is in I q and b is
in I p, which we are trying to show. If (ii) holds, then the fact that ar fp is in I p+q
implies that ar = 0 or r ≥q; in either case, a is in I q. Similarly the fact that
bsgq = 0 implies that bs = 0 or s ≥p; in either case, b is in I p. We conclude
that ψ is one-one, as was to be shown.
□
6. General Form of Bezout’s Theorem for Plane Curves
With the discussion complete concerning intersection multiplicity for general
projective plane curves, we arrive at the general form of Bezout’s Theorem for
plane curves.
Theorem 8.15 (Bezout’s Theorem). Let K be an algebraically closed ﬁeld,
and let F and G be projective plane curves over K of respective degrees m and
n. If F and G have no common factor of positive degree, then

P∈P2
K
I (P, F ∩G) = mn.
REMARKS. The sum over P has only ﬁnitely many nonzero terms by Theorem
8.5, and each intersection multiplicity in the sum is ﬁnite by Theorem 8.10e.
PROOF. Theorem 8.5 shows that the locus of common zeros of F and G is a
ﬁnite set. By applying a suitable  in GL(3, K), we may assume that none of
these zeros lies on the line at inﬁnity, namely W. To do so, we choose a point P
not in the ﬁnite set of common zeros. There are only ﬁnitely many lines passing
through P and some member of the set of common zeros, and we choose a line
through P different from all these. If  is chosen so as to move this line to the
line at inﬁnity W, then none of the common zeros will lie on the line W.

6. General Form of Bezout's Theorem for Plane Curves
489
With this normalization in place, let {P1, . . . , Pk} be the set of common zeros
of F and G. We introduce local versions f and g of F and G by the deﬁnitions
f (X, Y) = F(X, Y, 1) and g(X, Y) = G(X, Y, 1). Application of Theorem 8.12
to the ideal I = ( f, g) in K[X, Y] gives
dimK K[X, Y]/( f, g) =
k	
j=1
dimK

K[X, Y]/( f, g)

(Pj) =
k	
j=1
I (Pj, F ∩G).
The theorem will therefore follow if we prove that
dimK K[X, Y]/( f, g) = mn.
(∗)
To prove (∗), we shall ﬁrst prove a related equality concerning K[X, Y, W] and
the ideal (F, G) in it, and then we shall use the fact that F and G have no common
zeros with W to transfer the conclusion to K[X, Y].
Deﬁne K linear mappings ϕ : K[X, Y, W]⊕K[X, Y, W] →K[X, Y, W] and
ψ : K[X, Y, W] →K[X, Y, W] ⊕K[X, Y, W] by
ϕ(A, B) = AF + BG
and
ψ(C) = (CG, −C F),
and form the sequence of K vector spaces and K linear maps given by
0 −→K[X, Y, W]
ψ
−→K[X, Y, W] ⊕K[X, Y, W]
ϕ
−→K[X, Y, W].
(∗∗)
It is evident that ψ is one-one, that ϕψ = 0, and that image ϕ = (F, G). If
(A, B) is in ker ϕ, then AF + BG = 0. Since F and G have no common factor
of positive degree, F divides B and G divides A. Setting C = AG−1 therefore
gives A = CG and B = −AG−1F = −C F. Hence (A, B) lies in image ψ. In
other words, (∗∗) is exact, and image ϕ = (F, G).
Let d ≥m + n. If we denote by ψd and ϕd the restrictions of ψ and ϕ to
K[X, Y, W]d−m−n and K[X, Y, W]d−n ⊕K[X, Y, W]d−m, respectively, and if
we go over the argument in the previous paragraph, then we see that the sequence
0 −→K[X,Y,W]d−m−n
ψd
−→K[X,Y,W]d−n ⊕K[X,Y,W]d−m
ϕd
−→K[X,Y,W]d
is exact and that image ϕd = (F, G)d. The vector spaces in question here are all
ﬁnite-dimensional, and thus we obtain
dimK(F, G)d
= dimK K[X, Y, W]d−n + dimK K[X, Y, W]d−m −dimK K[X, Y, W]d−m−n
=
d−n+2
2

+
d−m+2
2

−
d−m−n+2
2

= −mn +
d+2
2

= −mn + dimK K[X, Y, W]d.
(†)

490
VIII. Background for Algebraic Geometry
The ideal (F, G) is homogeneous, and thus we know from Section 3 that the image
of K[X, Y, W]d in K[X, Y, W]/(F, G) is K[X, Y, W]d/(F, G)d. If we write

K[X, Y, W]/(F, G)

d for this quotient, then (†) shows that
dimK

K[X, Y, W]/(F, G)

d = mn
(††)
for all d ≥m + n.
To prove (∗) and the theorem, we shall translate (††) into a conclusion about
K[X, Y]/( f, g). Fix d ≥m + n, and let {V1 + (F, G), . . . , Vmn + (F, G)} be
a K basis of

K[X, Y, W]/(F, G)

d. Deﬁne vj(X, Y) = Vj(X, Y, 1) for each j.
We shall prove that the vectors
v1 + ( f, g), . . . , vmn + ( f, g)
(‡)
form a K basis of K[X, Y]/( f, g).
We need to make use of the fact that F and G have no common zeros on the
line at inﬁnity. Since W(F, G) ⊆(F, G), the K linear mapping of multiplication
by W on K[X, Y, W] descends to a K linear mapping L of K[X, Y, W]/(F, G)
to itself deﬁned by L(H + (F, G)) = W H + (F, G). Let us see that
L : K[X, Y, W]/(F, G) →K[X, Y, W]/(F, G)
is one-one.
(‡‡)
In fact, suppose that W H = AF + BG for some H in K[X, Y, W]. For any
U in K[X, Y, W], let U0(X, Y) = U(X, Y, 0). If U is homogeneous, then so
is U0. In this notation we can write F = F0 + W M and G = G0 + W N for
homogeneous members M and N of K[X, Y, W]. The polynomials F0 and G0
are relatively prime: in fact, if F0 and G0 have a nontrivial common factor D0,
then we can regard D0 as a projective plane curve, and it must have a common
zero Q with W, by Theorem 8.5; but then F, G, and W have Q as a common zero,
in contradiction to the normalization in the ﬁrst paragraph of the proof. Since
W H = AF + BG implies A0F0 = −B0G0, it follows that F0 divides B0 and
that G0 divides A0. In other words, B0 = C0F0 and A0 = −C0G0 for some C0
in K[X, Y]. If we deﬁne A′ = A + C0G and B′ = B −C0F, then the formulas
for A0 and B0 show that A′
0 = B′
0 = 0. Hence A′ = W A′′ and B′ = W B′′
for some homogeneous polynomials A′′ and B′′. Then W H = AF + BG =
(A′ −C0G)F +(B′ +C0F)G = A′F + B′G = W(A′′F + B′′G), and we obtain
H = A′′F + B′′G. Thus H lies in (F, G), and (‡‡) is proved.
Left multiplication L by W carries K[X, Y, W]d into K[X, Y, W]d+1 and
carries (F, G)d into (F, G)d+1. Therefore L is well deﬁned as a mapping from

K[X, Y, W]/(F, G)

d into

K[X, Y, W]/(F, G)

d+1. Since it is one-one by
(‡‡) and since the spaces are ﬁnite-dimensional, it is onto. Therefore
{W rV1 + (F, G), . . . , W rVmn + (F, G)}
is a basis
(§)

491
of

K[X, Y, W]/(F, G)

d+r for every r ≥0.
To prove that (‡) spans K[X, Y]/( f, g), let h be in K[X, Y].
Let H be
a homogeneous polynomial in K[X, Y, W] with h(X, Y) = H(X, Y, 1), and
choose an integer s such that W s H lies in K[X, Y, W]d+r for some r ≥0. Then
we can write W s H = 	mn
j=1 cjW rVj + AF + BG for suitable scalars cj and
homogeneous polynomials A and B. Restricting the domain to points (X, Y, 1)
gives h = 	mn
j=1 cjvj + af + bg, and therefore h + ( f, g) = 	mn
j=1 cjvj + ( f, g).
This proves that (‡) spans K[X, Y]/( f, g).
To prove that (‡) is linearly independent, suppose that 	mn
j=1 cjvj = af + bg
with a and b in K[X, Y].
If A and B are homogeneous polynomials such
that a(X, Y) = A(X, Y, 1) and b(X, Y) = B(X, Y, 1), then W r 	mn
j=1 cjVj =
W s AF + W t BG, provided the exponents r, s, t are chosen to make the de-
grees of the terms W r 	mn
j=1 cjVj, W s AF, and W t BG match. Consequently
W r 	mn
j=1 cjVj lies in (F, G)d+r, and (§) shows that the coefﬁcients are all 0.
This proves that (‡) is linearly independent.
□
7. Gr¨obner Bases
The remainder of the chapter returns to the main question introduced in Section 1,
that of how to get information about the set of simultaneous solutions of polyno-
mial equations in several variables. The resultant introduced in Section 2 gave us
one tool, but the tool is of most use when there are only two equations. Beyond
two equations the number of cases to check quickly grows, and the resultant is of
limited usefulness.12
The tool to be introduced in this section is of a completely different nature.
Historically it was introduced in order to have a way of deciding whether an ideal
in K[X1, . . . , Xn] contains a given polynomial. We know from the Hilbert Basis
Theorem that every such ideal is ﬁnitely generated, and it is assumed that the
ideal to be tested is speciﬁed by such a set of generators.
The proof of the Hilbert Basis Theorem gives a clue how to start studying an
ideal of polynomials. In the statement of the theorem, R is a Noetherian integral
domain, and I is a nonzero ideal in R[X]. It is to be proved that I is ﬁnitely
generated. The proof by Hilbert is longer than the proof given in Basic Algebra,
but the idea is clearer. To each nonzero member f (X) of I, we associate the
coefﬁcient of the highest power of X appearing in f (X). These coefﬁcients,
together with 0, form an ideal L(I) in R, and L(I) is ﬁnitely generated because
R is Noetherian. Let a1, . . . , ar be generators, let f1(X), . . . , fr(X) be members
12The nature of the extended theory can be found in Van der Waerden, Volume II, Chapter XI.
Theorem 8.31 below in effect reproduces some of this extended theory in a context that is manageable
because of the theory of Gr¨obner bases.
7. Gröbner Bases

492
VIII. Background for Algebraic Geometry
of I with respective highest coefﬁcients a1, . . . , ar, and let q be the largest of the
degrees of f1(X), . . . , fr(X). If a general g(X) in I is given and if a ∈R is its
highest coefﬁcient, then we know that a = 	
i ciai with ci ∈R. The polynomial
h(X) given by h(X) = g(X) −	
i ci fi(X)Xdeg g−deg fi has degree lower than
deg g, and g(X) will be in ( f1, . . . , fr) if h(X) is in ( f1, . . . , fr). Iterating this
construction, we see that it is enough to account for all the members of I of degree
≤q −1. To handle these, one way to proceed is to enlarge the set { f1, . . . , fr} a
little. For each k with 0 ≤k ≤q −1, let Lk(I) be the union of {0} and the set of
coefﬁcients of Xk in members of I of degree k. Each of these is an ideal of R and
hence is ﬁnitely generated, and we adjoin to { f1, . . . , fr} a ﬁnite set of generators
for each Lk(I) with 0 ≤k ≤q −1. The result is a ﬁnite set {g1, . . . , gs} of
generators of I, as one easily checks.
In fact, the set {g1, . . . , gs} is a special set of generators. For any member f
of R[X], let LT( f ) be the complete term of f (X) containing the highest power
of X. What the argument shows is that {g1, . . . , gs} is a subset of I such that
LT(I) =

LT(g1), . . . , LT(gs)

, where LT(I) denotes the ideal given as the linear
span of all polynomials LT(g) for g in I. One can show that this property of
{g1, . . . , gs} implies that {g1, . . . , gs} generates I. In essence this property will
be the deﬁning property of a “Gr¨obner basis” of I. It is not automatically satisﬁed
for just any ﬁnite generating set { f1, . . . , fr}, as the example below shows. We
shall see that it iseasy to use such a set of generators to test any polynomial in R[X]
for membership in I. Thus the original problem historically for introducing such
sets is solved except for one little detail: the proof of the Hilbert Basis Theorem is
not constructive, and we are left with no idea how actually to construct a Gr¨obner
basis.13
EXAMPLE.
Treat K[X, Y] as an instance of the above setting by letting
R = K[Y] and regarding K[X, Y] as R[X]. Consider the ideal I = ( f1, f2)
in R[X] with f1(X, Y) = X2 + 2XY 2 and f2(X, Y) = XY + 2Y 3 −1. Then

LT( f1), LT( f2)

= (X2, XY), and every monomial appearing with nonzero
coefﬁcient in a member of the latter ideal has total degree at least 2. On the
other hand, I contains the polynomial
Y f1(X, Y) −X f2(X, Y) = Y(X2 + 2XY) −X(XY + 2Y 3 −1) = X,
and its leading term is X, whose total degree is 1. Thus LT(I) properly contains

LT( f1), LT( f2)

.
Because of the nonconstructive nature of the proof of the Hilbert Basis Theo-
rem, it is necessary to start afresh. One message to glean from the abstract proof
13The exposition in this section and the next three is based partly on the book of Cox–Little–
O’Shea and the Web tutorial of Fabrizio listed in the Selected References.

493
is that the leading terms of the members of I are important and somewhat control
the nature of I. To handle K[X1, . . . , Xn] when K is a ﬁeld, it is of course
necessary to use an additional induction that enumerates the variables. In the
example above, we treated X as more signiﬁcant than Y. For the inductive step
for general K[X1, . . . , Xn], the ring R in the above argument is K with some
number m of the indeterminates included, and X is the (m + 1)st indeterminate.
Putting all the steps of the induction together, we see that the order in which the
variables are processed appears to be important.
The theory of Gr¨obner bases as it has evolved allows a healthy extra measure
of generality. Instead of deﬁning leading terms by insisting on an ordering of the
indeterminates, it deﬁnes them by using a suitable kind of ordering of monomials,
and that is where we begin. Let K[X1, . . . , Xn] be given, K being a ﬁeld. Let
M be the set of all monomials in K[X1, . . . , Xn]. A monomial ordering ≤on
M is a total ordering14 with the two additional properties that
(i) M1 ≤M2 implies M1M3 ≤M2M3 for all M1, M2, M3 in M,
(ii) 1 ≤M for all M in M.
We write M2 ≥M1 to mean M1 ≤M2. Also, M1 < M2 means M1 ≤M2 with
M1 ̸= M2, and M1 > M2 means M1 ≥M2 with M1 ̸= M2.
EXAMPLES OF MONOMIAL ORDERINGS. Each ordering assumes that the vari-
ables are enumerated in some way. In these examples we take this enumeration
to be X1, . . . , Xn. The ﬁrst four examples all have the property that the largest
X j is X1 and the smallest is Xn.
(1) Lexicographic ordering, abbreviated as “lex” by many authors and written
as ≤LEX in this list of examples. This, the most important monomial ordering, is
already suggested by the proof of the Hilbert Basis Theorem. In principle it can
be used for all purposes in Sections 7–10, but one application in Chapter X will
require a different monomial ordering. Its disadvantage is that it sometimes makes
lengthy computations take longer than necessary; this matter will be discussed
more in Section 9. The deﬁnition is that Xi1
1 · · · Xinn ≤LEX X j1
1 · · · X jn
n if either
the two monomials are equal or else the ﬁrst k for which ik ̸= jk has ik < jk.
Thus for example, X1X2
2 X3
3 ≤LEX X2
1. The word “lexicographic” refers to the
dictionary system for alphabetizing in which a ﬁrst word comes before a second
word if for the ﬁrst position in which the two words differ, the letter of the ﬁrst
word in that position precedes alphabetically the letter of the second word in that
position.
(2) Graded lexicographic ordering, abbreviated as “glex” or “grlex” by
many authors. As in Section 3 the total degree of a monomial Xi1
1 · · · Xinn is
14This means a partial ordering with the properties that each pair a, b has a ≤b or b ≤a and
that both hold only if a = b.
7. Gröbner Bases

494
VIII. Background for Algebraic Geometry
deg(Xi1
1 · · · Xinn ) = 	n
k=1 ik. The deﬁnition of the ordering is that M ≤GLEX N
if either deg M < deg N or else if deg M = deg N and M ≤LEX N. Thus for
example, X2
1 ≤GLEX X1X2
2 X3
3 because the total degree 2 of the ﬁrst monomial is
less than the total degree 6 of the second monomial. But X1X2
2 X3
3 ≤GLEX X2
1 X4
3
because both monomials have the same total degree 6 and the second monomial
involves a higher power of X1 than does the ﬁrst. This monomial ordering is not
much used; more common is the variant of it in the next example.
(3) Graded reverse lexicographic ordering, abbreviated as “grevlex” by
many authors. The deﬁnition is that M ≤GREVLEX N if either deg M < deg N or
else if deg M = deg N and N t ≤LEX Mt, where Mt is M but with the exponents
of X j and Xn−j interchanged for each j, and where N t is deﬁned similarly. This
ordering takes some getting used to. For example, X2
1 X4
3 ≤GREVLEX X1X2
2 X3
3
when n = 3 because both monomials have the same total degree and X3
1 X2
2 X3 =
(X1X2
2 X3
3)t ≤LEX (X2
1 X4
3)t = X4
1 X2
3. By contrast, X1X2
2 X3
3 ≤GLEX X2
1 X4
3.
(4) Orderings of k-elimination type, where 1 ≤k ≤n −1.
These are
orderings such that any monomial containing one of X1, . . . , Xk to a positive
power exceeds any monomial in Xk+1, . . . , Xn alone. These will be discussed
in Section 10. Of them, one of particular importance is the Bayer–Stillman
ordering of k-elimination type. Here a monomial M is ≤a monomial N if the
sum of the exponents of X1, . . . , Xk for M is less than the corresponding sum
for N or else the two sums are equal and M ≤GREVLEX N. This ordering is
commonly used for making computations in the context of Section 10.
(5) Ordering from a tuple of weight vectors. For 1 ≤i ≤n, let w(i) be a
vector in Rn of the form w(i) = (w(i)
1 , . . . , w(i)
n ), and assume that w(1), . . . , w(n)
are linearly independent over R. Identify the monomial Xα with the vector of
individual exponents α = (α1, . . . , αn). The ordering given by the weight vectors
w(i)
j
is deﬁned by saying that Xα ≤Xβ if Xα = Xβ or if the ﬁrst i such that
w(i) · α ̸= w(i) · β has w(i) · α < w(i) · β. Here the dot refers to the ordinary dot
product. A condition is needed on the w(i)’s to ensure that 1 ≤Xα for all α. (See
Problem 14 at the end of the chapter.) Here are two speciﬁc examples for which
the condition is satisﬁed. Let e(i) be the ith standard basis vector of Rn. The
lexicographic ordering in Example 1 is determined by the tuple of weight vectors
(e(1), . . . , e(n)). The Bayer–Stillman ordering in Example 4 is determined by the
tuple of weight vectors

e(1) + · · · + e(k), e(k+1) + · · · + e(n), −e(n), . . . , −e(k+2), −e(k), . . . , −e(2)
.
Further discussion of monomial orderings determined by weight vectors occurs
in Problems 14–15 at the end of the chapter.
Property (i) of monomial orderings insists that the ordering respect multipli-

495
cation of monomials in the natural way. Property (ii), according to the next
proposition, is a well-ordering property. The proof of the proposition will be
preceded by a lemma.
Proposition 8.16. In any monomial ordering for K[X1, . . . , Xn], any decreas-
ing sequence M1 ≥M2 ≥M3 ≥· · · is eventually constant. Consequently each
nonempty subset of M has a smallest element in the ordering.
Lemma 8.17. If I is an ideal in K[X1, . . . , Xn] generated by monomials and
if f (X1, . . . , Xn) is in I, then each monomial appearing in the expansion of f
with nonzero coefﬁcient lies in I. Consequently I has a ﬁnite set of monomials
as generators. Moreover, if {M1, . . . , Ms} is a set of monomials that generate I
and if M is any monomial in I, then some Mj divides M.
PROOF. Let {Mα} be the set of monomials that generates I. If f is in I, then
we can write f = 	k
j=1 hj Mαj for polynomials hj. Let hj = 	lj
i=1 ci j Mi j be
the expansion of hj in terms of monomials. If M0 is a monomial appearing in f
with nonzero coefﬁcient c, then the only possible monomial Mi j in hj that can
contribute toward c is one with Mi j Mαj = M0 if such a monomial exists. For
some j, such a monomial must exist, or c would be 0; thus M0 lies in I.
For the second conclusion, write { f1, . . . , fl} by the Hilbert Basis Theorem.
The ﬁrst conclusion shows that each monomial contributing to each fj lies in
I, and the set of all these monomials, as j varies, is therefore a ﬁnite set of
monomials generating I.
For the third conclusion, write M = 	s
i=1 ai Mi for polynomials ai. Expand-
ing each ai in terms of monomials, we see that some ai contains with nonzero
coefﬁcient a monomial M′ such that M = M′Mi. The divisibility follows.
□
PROOF OF PROPOSITION 8.16. Let M be a monomial, and let I be the linear
span of all monomials M′ with M′ ≥M. If M′ is a such a monomial and N is
any monomial, then N M′ ≥N M by (i), and N M ≥1M = M by (i) and (ii).
Therefore N M′ lies in I, and I is an ideal.
From such an ideal I, we can recover M as the unique monomial M0 in I such
that M0 ≤M′ for every monomial M′ in I, since any such M0 has M0 ≤M as
well as M ≤M0.
With M1, M2, . . . given as in the proposition, let Ik be the linear span of all
monomials M′ ≥Mk. We have just seen that Ik is an ideal, and the Ik’s are
increasing in k. Then I = ∞
k=1 Ik is an ideal generated by monomials, and
Lemma 8.17 shows that it has a ﬁnite set of monomials as a set of generators.
Each such monomial generator lies in some Ik. Since the Ik’s are nested, all the
generators lie in some Ik0, and we conclude that I = Ik0. The previous paragraph
of the proof shows that Ik0 determines Mk0, and therefore Mk = Mk0 for all
k ≥k0.
7. Gröbner Bases

496
VIII. Background for Algebraic Geometry
For the last statement of the proposition, if there were no least element, then for
any element in the subset, we could always ﬁnd a smaller element in the subset.
In this way, we would be able to construct a strictly decreasing inﬁnite sequence
in M, in contradiction to what has just been proved.
□
Fix a monomial ordering for K[X1, . . . , Xn]. If f is any nonzero member of
K[X1, . . . , Xn] and if f is expanded as a K linear combination of monomials,
then we deﬁne the leading monomial, leading coefﬁcient, and leading term of f
by
LM( f ) = largest monomial with nonzero coefﬁcient in expansion of f,
LC( f ) = coefﬁcient of LM( f ) in f,
LT( f ) = LC( f ) LM( f ).
It will be convenient to be able to use these deﬁnitions without having to dis-
tinguish the cases f ̸= 0 and f = 0. Accordingly, let us adjoin 0 to the set
M, agreeing that 0 < M and 0M = 0 for every monomial M. We adopt the
convention that LM(0) = 0, LT(0) = 0, and LC(0) = 0.
Since any monomial that occurs in a sum of two polynomials occurs in one or
the other of them, it is immediate from the deﬁnition that
LM( f1 + f2) ≤max(LM( f1), LM( f2))
if f1, f2, and f1 + f2 are nonzero. Checking the various cases, we see that this
inequality persists if one or more of f1, f2, and f1 + f2 are 0.
The comparable results concerning multiplication are contained in the next
proposition.
Proposition 8.18. If f1 and f2 are two nonzero members of K[X1, . . . , Xn],
then
LM( f1 f2) = LM( f1) LM( f2)
and
LC( f1 f2) = LC( f1) LC( f2);
hence
LT( f1 f2) = LT( f1) LT( f2).
These equalities persist if one or both of f1 and f2 are 0. Moreover, if f1 and f2
are nonzero and have LT( f1) = LT( f2), then LM( f1 −f2) < LM( f1).
PROOF.
For the ﬁrst statement, let the expansions of f1 and f2 as linear
combinations of distinct monomials be f1 = a1 LM( f1) + 	
i ci Mi and f2 =
a2 LM( f2) + 	
j dj Nj with Mi < LM( f1) for all i and Nj < LM( f2) for all j.
Then f1 f2 equals
a1a2 LM( f1) LM( f2) + a2
	
i
ci Mi LM( f2) + a1
	
j
dj LM( f1)Nj + 	
i, j
cidj Mi Nj,

497
and the conclusions in the ﬁrst sentence of the proposition will follow if it is
shown that Mi LM( f2) < LM( f1) LM( f2), that LM( f1)Nj < LM( f1) LM( f2), and
that Mi Nj < LM( f1) LM( f2). The ﬁrst inequality follows from (i) because Mi <
LM( f1), and the second inequality is similar. For the third we apply (i) twice to
obtain Mi Nj ≤Mi LM( f2) ≤LM( f1) LM( f2)andobservethattheendexpressions
can be equal only if equality holds in both instances. The latter is impossible
because K[X1, . . . , Xn] is an integral domain, and thus Mi Nj < LM( f1) LM( f2).
The three displayed equalities persist if one or both of f1 and f2 are 0 because
LM( f ), LT( f ), and LC( f ) can be 0 only if f = 0.
Finally if f1 and f2 are nonzero and have expansions as in the ﬁrst paragraph of
theproofwith LT( f1) = LT( f2), then LC( f1) = a1 and LC( f2) = a2. Hence f1−f2
has an expansion involving only the monomials Mi and Nj. Consequently if
f1−f2 ̸= 0, thenthelargestofthe Mi’sand Nj’sis< LM( f1). Thus LM( f1−f2) <
LM( f1). This inequality holds also if f1 −f2 = 0.
□
If I is a nonzero ideal in K[X1, . . . , Xn], we deﬁne LT(I) to be the vector
space of all K linear combinations of polynomials LT( f ) with f in I. It fol-
lows from Proposition 8.18 that K[X1, . . . , Xn] LT(I) ⊆LT(I), and therefore
LT(I) is an ideal in K[X1, . . . , Xn].
A ﬁnite unordered subset {g1, . . . , gk}
of nonzero elements of the ideal I is called a Gr¨obner basis of I if LT(I) =

LT(g1), . . . , LT(gk)

.
The inclusion ⊇follows from the deﬁnition, and the
question is whether LT(g1), . . . , LT(gk) generate LT(I).
Among the examples below, Example 3 is particularly suggestive of the utility
of a Gr¨obner basis. The idea is that an ordinary set of generators may have
the property that certain “small” elements of I can be expanded in terms of the
generators only using “large” coefﬁcients and that this property is reﬂected in the
failure of (LT(g1), . . . , LT(gk)) to exhaust LT(I).
EXAMPLES WITH LEXICOGRAPHIC ORDERING.
(1) Principal ideal. If I = ( f (X1, . . . , Xn)), then { f } is a Gr¨obner basis. In
fact, the most general member of I is of the form h f with h in K[X1, . . . , Xn],
and Proposition 8.18 gives LT(h f ) = LT(h) LT( f ). Therefore LT(I) = (LT( f )),
as required.
(2) Ideal generated by members of K[X1, . . . , Xn]1.
Suppose that I =
(L1, . . . , Lk), where each L j is a homogeneous linear polynomial of degree 1. For
example, I could be (X1 + X2 + X3, X1 −X3). Let us form the corresponding
k-by-n coefﬁcient matrix, speciﬁcally

1 1
1
1 0 −1

in the 3-variable example. If
we perform row operations to transform this matrix into reduced row-echelon
form and let L′
1, . . . , L′
k′ be the members of K[X1, . . . , Xn]1 corresponding to
the reduced matrix, speciﬁcally X1 −X3 and X2 + 2X3 for the reduced form
7. Gröbner Bases

498
VIII. Background for Algebraic Geometry

1 0 −1
0 1
2

of

1 1
1
1 0 −1

, then I = (L′
1, . . . , L′
k′) and moreover {L′
1, . . . , L′
k′} is a
Gr¨obner basis of I. This fact is not particularly obvious in the full generality of
this example, but it will be shown to be an easy consequence of Theorem 8.23 in
the next section.
(3) Earlier example in this section. In K[X, Y], let I = ( f1, f2) with f1(X, Y)
= X2 + 2XY 2 and f2(X, Y) = XY + 2Y 3 −1.
Then

LT( f1), LT( f2)

=
(X2, XY). We saw that X is a member of I and that LT(X) = X is not in

LT( f1), LT( f2)

.
So { f1, f2} is not a Gr¨obner basis.
If we enlarge the set
of generators of I to { f1, f2, X}, then we still do not have a Gr¨obner basis
because f2 −Y X = 2Y 3 −1 is in I and LT( f2 −Y X) = 2Y 3 does not lie
in

LT( f1), LT( f2), LT(X)

= (X2, XY, X) = (X). We can enlarge the set of
generators still further to { f1, f2, X, 2Y 3 −1}. Is this a Gr¨obner basis? Here
we have

LT( f1), LT( f2), LT(X), LT(2Y 3 −1)

= (X, Y 3), and it seems as if this
equals LT(I). But we need a way of checking easily. We shall obtain a way of
checking in Theorem 8.23 in the next section.
The question of existence–uniqueness of a Gr¨obner basis will be addressed
constructively in Sections 8–9; however, we did observe at the beginning of this
section that Hilbert’s proof of the Hilbert Basis Theorem essentially handles exis-
tence when the monomial ordering is the usual lexicographic ordering. Actually,
the argument at the beginning of the section had two parts to it—a nonconstructive
argument producing a certain ﬁnite set of leading terms and a veriﬁcation that
those leading terms lead to a set of generators of the ideal. The ﬁrst part, being
a nonconstructive existence proof, does not help us in our current efforts, and
we defer to Problem 13 at the end of the chapter the question of adapting it to
a general monomial order. The second part, on the other hand, is a useful kind
of veriﬁcation in our current efforts. It shows that a certain kind of ﬁnite subset
of an ideal is necessarily a set of generators, and it generalizes as follows. The
generalization will play a role in Section 9.
Proposition 8.19. If K is a ﬁeld, if a monomial ordering is speciﬁed for
K[X1, . . . , Xn], and if {g1, . . . , gk} is a Gr¨obner basis for a nonzero ideal I of
K[X1, . . . , Xn], then {g1, . . . , gk} generates I.
PROOF. First we prove that if f ̸= 0 is in I, then there exist a gj, a monomial
M0, and a nonzero scalar c such that LM( f −cM0gj) < LM( f ). To see this, we use
the hypothesis that {g1, . . . , gk} is a Gr¨obner basis to ﬁnd polynomials h1, . . . , hk
such that LM( f ) = 	k
i=1 hi LM(gi). Then it must be true for i equal to some
index j that LM( f ) = M0 LM(gj) for one of the monomials M0 that appears in
hj with nonzero coefﬁcient. Since M0 LM(gj) = LM(M0) LM(gj) = LM(M0gj),
we can rewrite this equality as LT( f ) = c LT(M0gj) for some scalar c ̸= 0. Then

8. Constructive Existence
499
LT( f ) = LT(cM0gj), and Proposition 8.18 shows that LM( f −cM0gj) < LM( f ),
as asserted.
Iterating this construction and assuming that we never get 0, we can ﬁnd
successively nonzero scalars ci, monomials Mi, and members gji of the Gr¨obner
basis such that the sequence LM

f −	l
i=1 cj Mjgji

indexed by l is strictly
decreasing, in contradiction to Proposition 8.16. To avoid the contradiction, we
must have f −	l
i=1 cj Mjgji = 0 for some l, and then f is exhibited as in the
ideal (g1, . . . , gk). Hence the Gr¨obner basis generates I.
□
8. Constructive Existence
Throughout this section, K denotes a ﬁeld, and we work with a ﬁxed monomial
ordering on K[X1, . . . , Xn]. Ideals in K[X1, . . . , Xn] will always be speciﬁed by
giving ﬁnite sets of generators. Our objective is to obtain a constructive proof of
the existence of a Gr¨obner basis for each nonzero ideal in K[X1, . . . , Xn], along
with a useful test procedure for deciding whether a given ﬁnite set of generators of
I is a Gr¨obner basis. As is often the case with existence proofs, the motivation for
the proof comes from a certain amount of deduction of properties that a Gr¨obner
basis must satisfy if its exists. It was mentioned in the previous section that the
failure of a set of generators to be a Gr¨obner basis has something to do with
its failure to be able to represent all “small” elements of the ideal by means of
expansions in terms of the generators that use “small” coefﬁcients. The ﬁrst part
of this section will explore this idea, seeking to make it precise. The main step
will be a checkable text for a set to be a Gr¨obner basis; this is Theorem 8.23.
The existence argument will be an easy corollary. A by-product of the existence
argument will be a way of testing a polynomial for membership in I.
In the one-variable case any ideal is principal, necessarily of the form (g(X)),
and the test for membership of a polynomial f in the ideal is to apply the division
algorithm, writing f (X) = q(X)g(X) + r(X) with r = 0 or degr < deg g.
Then f is a member of the ideal if and only if r = 0. The starting point for the
several-variable theory is to do the best we can to generalize the division algorithm
to several variables, recognizing that we cannot expect too much because of the
complicated ideal structure in several variables.
Proposition 8.20 (generalized division algorithm). Let ( f1, . . . , fs) be a ﬁxed
enumeration of a set of nonzero members of K[X1, . . . , Xn], and let f be an
arbitrary nonzero member of K[X1, . . . , Xn].
Then there exist polynomials
a1, . . . , as and r such that
f = a1 f1 + · · · + as fs + r,

500
VIII. Background for Algebraic Geometry
such that LM(aj fj) ≤LM( f ) for all j, and such that no monomial appearing in r
with nonzero coefﬁcient is divisible by LM( fj) for any j.
REMARK. The proof below will stop short of giving an algorithm, because
omitting the details of the algorithm will make the invariant of the construction
clearer. To make the proof into an algorithm, one merely needs to be systematic
about the choices in the proof. There is no claim of any uniqueness of a1, . . . , as
or r in the statement; in fact, Problem 16 at the end of the chapter shows that
more than one kind of nonuniqueness is possible. Corollary 8.21 below, however,
will show that if the given f1, . . . , fs form a Gr¨obner basis of an ideal I, then
r is independent of the enumeration of the Gr¨obner basis, even without the
requirement that LM(aj fj) ≤LM( f ) for all j.
PROOF. We shall do a kind of induction involving decompositions of f of the
form
f = (a1 f1 + · · · + as fs) + p + r,
(∗)
where a1, . . . , as, p,r are polynomials with the properties that
(i) LM(p) ≤LM( f ),
(ii) LM(ai fi) ≤LM( f ) for all i,
(iii) no monomial M appearing in r with nonzero coefﬁcient has M divisible
by any LM( fi),
and we shall demonstrate that LM(p) decreases at every step of the induction as
long as p ̸= 0. Initially we take all ai = 0, p = f , and r = 0. Then (∗) and the
three properties hold at the start. Let us describe the inductive step.
If LT( fj) divides LT(p) for some j, then we replace aj by aj + LT(p)/ LT( fj),
we change p to p −

LT(p)/ LT( fj)

fj, and we leave r alone. The equality (∗)
is maintained, and (iii) continues to hold. Since
LT

LT(p)/ LT( fj)

fj

= LT

LT(p)/ LT( fj)

LT( fj)
=

LT(p)/ LT( fj)

LT( fj) = LT(p),
(∗∗)
Proposition 8.18 shows that LM(p) strictly decreases. Consequently (i) continues
to hold. By the same kind of computation as for (∗∗),
LM

aj + LT(p)/ LT( fj)

fj

≤max

LM(aj fj), LM

LT(p)/ LT( fj)

fj

≤max(LM( f ), LM(p)) = LM( f ),
and therefore (ii) continues to hold. This completes the inductive step if LT( fj)
divides LT(p) for some j.
The contrary case is that LT(p) is divisible by LT( fi) for no i. Then we replace
p by p −LT(p), we change r to r + LT(p), and we leave all ai alone. The

8. Constructive Existence
501
equality (∗) is maintained, and (ii) continues to hold. Since LM(p) = LM(LT(p)),
Proposition 8.18 shows that LM(p) strictly decreases. Consequently (i) continues
to hold. Also, (iii) continues to hold because of the assumption that LT(p) is
divisible by LT( fi) for no i. This completes the inductive step if LT(p) is divisible
by LT( fi) for no i.
Proposition 8.16 shows that the induction can continue for only ﬁnitely many
steps. Since it must continue as long as p ̸= 0, the conclusion is that p = 0 after
some stage, and then the decomposition of the proposition has been proved.
□
Corollary 8.21. If {g1, . . . , gs} is a Gr¨obner basis of a nonzero ideal I of
K[X1, . . . , Xn] and if f is any nonzero member of K[X1, . . . , Xn], then there
exist polynomials g and r such that f = g+r, g is in I, and no monomial appear-
ing in r with nonzero coefﬁcient is divisible by LM(gj) for any j. Moreover, r is
uniquely determined by these properties, and g has an expansion g = 	s
i=1 aigi
with LM(aigi) ≤LM( f ) for all i.
REMARKS. The uniqueness statement implies in particular thatr is independent
of the enumeration of the set {g1, . . . , gs}. This corollary will give us some insight
into the way a Gr¨obner basis can resolve cancellation. Shortly we shall introduce
speciﬁc members of I that have cancellation built into their deﬁnition. Being in
I, they have expansions with remainder term 0, according to this corollary. Since
the remainder is unique, the corollary says that they can be rewritten in terms of
the Gr¨obner basis in a way that eliminates the cancellation.
PROOF. For existence, let {g1, . . . , gs} be a Gr¨obner basis of I, and apply
Proposition 8.20 to f and the ordered set (g1, . . . , gs). Then the existence follows
immediately.
For uniqueness, suppose that f = g1 + r1 = g2 + r2. Then r1 −r2 = g2 −g1
exhibits r1 −r2 as in I. Arguing by contradiction, suppose that r1 ̸= r2. The
hypothesis on r1 and r2 shows that no monomial with nonzero coefﬁcient in
r1 −r2 is divisible by any LM(gj), and in particular LM(r1 −r2) is not divisible
by any of the generators of the monomial ideal

LM(g1), . . . , LM(gs)

= LM(I).
Since LM(r1 −r2) is a monomial in this ideal, this conclusion contradicts the last
conclusion of Lemma 8.17.
□
Suppose that Xα = Xα1
1 · · · Xαn
n and Xβ = Xβ1
1 · · · Xβn
n are two monomials in
K[X1, . . . , Xn]. Then we deﬁne their least common multiple LCM(Xα, Xβ) to
be
LCM(Xα, Xβ) = Xγ = Xγ1
1 · · · Xγn
n
with γj = max(αj, βj) for all j.
This notion does not depend on the choice of a monomial ordering. Observe
for any two monomials M and N that LCM(M, N)/M and LCM(M, N)/N are
monomials.

502
VIII. Background for Algebraic Geometry
If f1 and f2 are nonzero polynomials, then the expression
LCM

LM( f1), LM( f2)

LT( f1)
f1 = LCM

LM( f1), LM( f2)

LM( f1)
f1
LC( f1)
is a polynomial whose leading monomial is LCM

LM( f1), LM( f2)

and whose
leading coefﬁcient is 1. We deﬁne the S-polynomial of f1 and f2 to be
S( f1, f2) = LCM

LM( f1), LM( f2)

LT( f1)
f1 −LCM

LM( f1), LM( f2)

LT( f2)
f2.
This is the difference of two polynomials with the same leading monomial
LCM

LM( f1), LM( f2)

and with the same leading coefﬁcient 1. Accordingly,
Proposition 8.18 shows that
LM(S( f1, f2)) < LCM

LM( f1), LM( f2)

.
The elements S( f1, f2) are the elements mentioned in the remarks with Corollary
8.21; the above inequality is a precise formulation of their built-in cancellation.
Lemma 8.22 below says that whenever cancellation of this kind occurs in
any sum of products with functions f1, . . . , fs, then the sum of products can be
rewritten in terms of the S-polynomials S( fj, fk). In this way the nature of the
cancellation has been made more transparent, partly being accounted for by the
deﬁnitions of the individual polynomials S( fj, fk).
Lemma 8.22. Let M and M1, . . . , Ms be monomials, let f1, . . . , fs be nonzero
polynomials, andsupposethat Mi LM( fi) = M foralli. Ifc1, . . . , cs areconstants
such that LM
 	s
i=1 ci Mi fi

< M, then the sum 	s
i=1 ci Mi fi can be rewritten
in the form
s

i=1
ci Mi fi =

j<k
djk M
LCM

LM( fj), LM( fk)
 S( fj, fk)
for suitable constants djk. In the sum on the right side, each nonzero term has
leading monomial < M.
PROOF. Let us write Li j = LCM

LM( fi), LM( fj)

for i ̸= j. We may assume
that all the ci are nonzero, and we proceed by induction on s. There is nothing to
prove for s = 1. The key step is s = 2, for which we are given that the M term
of c1M1 f1 + c2M2 f2 is 0, i.e., that
c1 LC( f1) + c2 LC( f2) = 0.
(∗)

8. Constructive Existence
503
Substituting for LC( f2) from (∗) gives
ML−1
12 S( f1, f2) = M f1/ LT( f1) −M f2/ LT( f2)
= M1 f1/ LC( f1) −M2 f2/ LC( f2)
= c−1
1
LC( f1)−1(c1M1 f1 + c2M2 f2),
and this proves the displayed formula of the lemma with d12 = c1 LC( f1).
Assume the result for s −1 ≥2. We are given that 	s
i=1 ci LC( fi) = 0, which
we break into two parts as
c1 LC( f1) −c1 LC( f1)
LC( f2)
LC( f2) = 0,

c2 + c1 LC( f1)
LC( f2)

LC( f2) +
s	
i=3
ci LC( fi) = 0.
The inductive hypothesis gives
c1M1 f1 −c1 LC( f1)
LC( f2) M2 f2 = d12ML−1
12 S( f1, f2),

c2 + c1 LC( f1)
LC( f2)

M2 f2 +
s	
i=3
ci Mi fi =
	
2≤j<k
djk ML−1
jk S( fj, fk).
Adding these two formulas, we obtain the displayed formula of the lemma for
the case s, and the induction is complete.
□
Theorem 8.23. Let {g1, . . . , gs} be a set of generators of a nonzero ideal I of
K[X1, . . . , Xn], and assume that gi ̸= 0 for all i. Then the following conditions
on {g1, . . . , gs} are equivalent:
(a) {g1, . . . , gs} is a Gr¨obner basis of I,
(b) for each pair (gj, gk) with S(gj, gk) ̸= 0, every expansion of S(gj, gk) as
S(gj, gk) = 	s
i=1 ai jkgi + r with the two properties that
(i) LM(ai jkgi) ≤LM(S(gj, gk)) and
(ii) no monomial appearing in r with nonzero coefﬁcient is divisible
by LM(gj) for any j
has r = 0,
(c) for each pair (gj, gk) with S(gj, gk) ̸= 0, there is an expansion of the
form S(gj, gk) = 	s
i=1 ai jkgi with LM(ai jkgi) ≤LM(S(gj, gk)).
REMARKS. Because of the equivalence of (b) and (c), the generalized divi-
sion algorithm (Proposition 8.20) gives us a procedure for testing whether these
conditions are satisﬁed by {g1, . . . , gs}. Namely we follow through the steps in
the proof of Proposition 8.20 in whatever fashion we please for each nonzero

504
VIII. Background for Algebraic Geometry
S(gj, gk). If we get remainder r = 0 for each pair ( j, k), then the conditions are
satisﬁed. If we get a nonzero remainder r for some pair, then the conditions are
not satisﬁed. In view of the equivalence of (a) with these conditions, we have an
effective (though somewhat tedious) way of checking whether {g1, . . . , gs} is a
Gr¨obner basis.
PROOF. We prove that (a) implies (b) and that (c) implies (a). Since (b)
certainly implies (c), the proof will be complete.
Let (a) hold, i.e., let {g1, . . . , gs} be a Gr¨obner basis. If S(gj, gk) ̸= 0, then
S(gj, gk) is a nonzero member of I because each gi lies in I, and S(gj, gk)
consequently has an expansion as 	s
i=1 aigi +r with r = 0. By Corollary 8.21 it
has a possibly different expansion withr = 0 and with LM(aigi) ≤LM(S(gj, gk))
for each i. On the other hand, in any expansion of S(gj, gk) as 	s
i=1 aigi + r
such that (ii) holds, whether or not LM(aigi) ≤LM(S(gj, gk)), r must be 0 by
Corollary 8.21. This proves (b).
To prove that (c) implies (a), we argue by contradiction. Among all expan-
sions of members of I as 	s
i=1 bigi such that LT
 	s
i=1 bigi

is not in the ideal

LT(g1), . . . , LT(gs)

, choose one for which
M = max
1≤i≤s
LM(bigi)
is as small as possible; this choice exists by Proposition 8.16. For this choice, let
f =
s	
i=1
bigi.
(∗)
Deﬁne Mi = LM(bi) for each i with bi ̸= 0.
If i0 is an index with M =
LM(bi0gi0), then M = Mi0 LM(gi0) by Proposition 8.18, and hence M lies in

LT(g1), . . . , LT(gs)

. Since LT
 	s
i=1 bigi

is not in

LT(g1), . . . , LT(gs)

, it
follows that LT
 	
i bigi

< M. Within the set {1, . . . , s}, deﬁne a subset E to
consist of those i for which Mi LM(gi) = M. This set contains i0, and it has the
property that all i not in E have LM(bigi) < M. We regroup f as
f = 	
i∈E
bigi + 	
i /∈E
bigi = 	
i∈E
LC(bi)Migi + 	
i∈E
(bi −LT(bi))gi + 	
i /∈E
bigi.
Every term in the second and third sums on the right side has leading monomial
< M, and so does f . Therefore LM
 	
i∈E LC(bi)Migi

< M. It follows that
the expression 	
i∈E LC(bi)Migi is of the form considered in Lemma 8.22 with
ci = LC(bi) for i ∈E (and ci = 0 for i /∈E). The lemma tells us that
	
i∈E
LC(bi)Migi = 	
j,k
djk(M/L jk)S(gj, gk)

8. Constructive Existence
505
for suitable scalars djk, where L jk = LCM

LM(gj), LM(gk)

.
Now we apply the hypothesis (c), expanding each S(gj, gk) in some way as
S(gj, gk) = 	s
i=1 ai jkgi with the ai jk equal to polynomials such that
LM(ai jkgi) ≤LM(S(gj, gk)).
(∗∗)
Substituting for S(gj, gk), we obtain
f = 	
i, j,k
djk(M/L jk)ai jkgi + 	
i∈E
(bi −LT(bi))gi + 	
i /∈E
bigi.
(†)
We know that every term in the second and third sums on the right side of (†)
has leading monomial < M, and we shall estimate the leading monomial of each
term in the ﬁrst sum. Multiplying the inequality
LM(S(gj, gk)) < LCM

LM(gj), LM(gk)

= L jk
by the monomial M/L jk yields
(M/L jk) LM(S(gj, gk)) < M
(††)
for every pair ( j, k). Combining (∗∗) and (††) gives
LM

(M/L jk)ai jkgi

= (M/L jk) LM(ai jkgi) ≤(M/L jk) LM(S(gj, gk)) < M.
Since each djk is a scalar, every term in the ﬁrst sum on the right side of (†)
has leading monomial < M. Thus (†) is an expansion of a member of I that
contradicts the minimality of maxi LM(bigi) in the expansion (∗). From this
contradiction we conclude that (a) holds.
□
EXAMPLE OF A VERIFICATION THAT A SET IS A GR¨OBNER BASIS. This example
continues Example 2 of “Examples with lexicographic ordering” in the previous
section. A nonzero ideal I is generated by members of K[X1, . . . , Xn]1 of the
form (L1, . . . , Ls), where each L j is a linear combination of X1, . . . , Xn. After
initial manipulations we assume that the matrix of coefﬁcients of L1, . . . , Ls is in
reduced row-echelon form. The assertion is that {L1, . . . , Ls} is then a Gr¨obner
basis of I. To prove this, we write L j = Xnj + lj, where Xnj is the associated
corner variable and lj is a linear combination of Xnj+1, . . . , Xn such that the
coefﬁcient of each corner variable is 0. If j < k, then
S(L j, Lk) = −lk Xnj + lj Xnk = −lk(Xnj + lj) + lj(Xnk + lk) = −lkL j + lj Lk.
The second term on the right side contains no variable X1, . . . , Xnj, but the ﬁrst
term on the right side contains Xnj.
Therefore, relative to the lexicographic
ordering, we have LM

S(L j, Lk)

= LM(−lkL j) = LM(lk)Xnj. Consequently
LM(lj Lk) ≤LM

S(L j, Lk)

(and actually strict inequality must hold). Thus the
displayed formula shows that S(L j, Lk) = a1L j + a2Lk in the form demanded
by (c) of Theorem 8.23. Since (c) implies (a) in the theorem, {L1, . . . , Ls} is a
Gr¨obner basis of I.

506
VIII. Background for Algebraic Geometry
Corollary 8.24 (Buchberger’s algorithm).15 Each nonzero ideal in the poly-
nomial ring K[X1, . . . , Xn] has a Gr¨obner basis. Such a basis can be obtained by
the following procedure: Start from any set { f1, . . . , ft} of nonzero generators,
apply the generalized division algorithm in some fashion to each S( fj, fk) and
to the generating set { f1, . . . , ft}, and adjoin to the set of generators any nonzero
remainders obtained from this process. Iterate this process for enlarging a set
{ f ′
1, . . . , f ′
t′} of generators as long as a nonzero remainder is obtained for some
S( f ′
j , f ′
k). This process must terminate at some point with all remainders equal
to 0, and the resulting generating set is a Gr¨obner basis.
PROOF. At the stage of the iteration that works with the set { f ′
1, . . . , f ′
t′} of
generators, any nonzero remainderr that arises has the property that no monomial
occurring in r is divisible by any LM( f ′
j ). By Lemma 8.17, LT(r) is not a member
of

LT( f ′
1), . . . , LT( f ′
t )

. However, at the next stage when r has been designated
as one of the generators of I, LT(r) has become one of the generators of this
ideal. Therefore the ideal

LT( f ′
1), . . . , LT( f ′
t )

strictly increases as we pass from
one stage to the next. Since K[X1, . . . , Xn] is Noetherian, its ideals satisfy the
ascending chain condition, and this chain of ideals must stabilize. Consequently
all the remainders must be 0 at some point, and then Theorem 8.23 shows that
the set of generators is a Gr¨obner basis.
□
EXAMPLE OF THE COMPUTATION OF A GR¨OBNER BASIS. We return to Example
3 of “Examples with lexicographic ordering” in the previous section. In K[X, Y],
we let f1(X, Y) = X2 + 2XY 2 and f2(X, Y) = XY + 2Y 3 −1, and we deﬁne
I = ( f1, f2). We seek a Gr¨obner basis of I, using the lexicographic ordering.
Direct computation gives S( f1, f2) = Y(X2 +2XY 2)−X(XY +2Y 3 −1) = X.
Since X is not divisible by LM( f1) or by LM( f2), S( f1, f2) = 0 f1 + 0 f2 + X
is an expansion of S( f1, f2) as in Theorem 8.23c with r = X. The procedure
of Corollary 8.24 says to adjoin f3 = X to the generating set and test again.
Direct computation gives S( f1, f3) = 1(X2 + 2XY 2) −X · X = 2XY, and
S( f1, f3) = 0 f1 + 0F2 + (2Y) f3 + 0 is an expansion of S( f1, f3) as in (c),
since LM(2Y f3) ≤LM

S( f1, f3)

. Thus S( f1, f3) gives us a 0 remainder, hence
nothing new to process. In addition, we have S( f2, f3) = 1(XY + 2Y 3 −1) −
Y · X = 2Y 3 −1. No term of this is divisible by any of the leading monomials of
f1, f2, f3, namely X2, XY, X. Hence2Y 3−1isanonzeroremainder.16 Therefore
we are to adjoin f4 = 2Y 3 −1 to our set. Computation gives S( f1, f4) =
2XY 4 + X2 = (2Y 4 + X) f3, S( f2, f4) = 2Y 5 −Y 2 + 1
2 X =
1
2 f3 + Y 2 f4,
15Computer programs typically use an improved version of this algorithm to compute Gr¨obner
bases.
16It was not a bad choice of decomposition that led to a nonzero remainder when some other
decomposition might have given us 0; the equivalence of (b) and (c) in Theorem 8.23 assures us of
that fact.

8. Constructive Existence
507
and S( f3, f4) = 1
2 X = 1
2 f3. In every case each term has leading monomial at
most the leading monomial of the S-polynomial. Hence all remainders are 0, and
Corollary 8.24 says that { f1, f2, f3, f4} is a Gr¨obner basis of I.
Corollary 8.25 (solution of the ideal-membership problem). If I is a nonzero
ideal in K[X1, . . . , Xn] and f is a polynomial, then a procedure for deciding
whether f lies in I is as follows: introduce a monomial ordering, construct
a Gr¨obner basis {g1, . . . , gs} of I by means of Corollary 8.24, and apply the
generalized division algorithm to write f = 	s
i=1 aigi + r for polynomials
a1, . . . , ar,r such that no monomial appearing in r with nonzero coefﬁcient is
divisible by LM(gj) for any j. Then f lies in I if and only if r = 0.
PROOF. Corollary 8.24 produces the Gr¨obner basis, and Corollary 8.21 afﬁrms
that this procedure decides whether f lies in I.
□
Corollary 8.26 (solution of the proper-ideal problem). If I is a nonzero ideal
in K[X1, . . . , Xn], then a procedure for deciding whether I = K[X1, . . . , Xn]
is to compute a Gr¨obner basis for I and to see whether one of its members is a
nonzero scalar c.
PROOF. If I has a nonzero scalar as one of its generators, then 1 lies in I,
and hence I certainly equals K[X1, . . . , Xn]. Conversely if I is given, then
Corollary 8.24 produces a Gr¨obner basis {g1, . . . , gs}. Since LT(1) = 1 and since
LT(I) =

LT(g1), . . . , LT(gs)

, the monomial 1 must lie in

LT(g1), . . . , LT(gs)

.
Since 1 is a monomial, Lemma 8.17 shows that it must be divisible by LM(gj)
for some j. Therefore LM(gj) = 1. Since 1 is the smallest monomial in any
monomial ordering, it is the only monomial appearing with a nonzero coefﬁcient
in gj. Therefore gj is a nonzero scalar.
□
In many applications of Gr¨obner bases, there is some ﬂexibility in what mono-
mial ordering to impose in obtaining the Gr¨obner basis. In Corollaries 8.25 and
8.26, for example, absolutely any monomial ordering works ﬁne. The actual
calculation of Gr¨obner bases is often computationally demanding, and thus it
is worthwhile to use such a basis that takes relatively little time to compute.
According to computer scientists,17 Gr¨obner bases are the most widely useful
when computed relative to the lexicographic ordering, but they are then also
the most time-consuming to compute. The monomial orderings that make the
computation of Gr¨obner bases proceed quickly tend to be ones that ﬁrst bound
17The Web essay “Representation and monomial orders,” http://www.umich.edu/
∼gpcc/scs/magma/text835.htm, within the publication of the Statistics and Computation
Service listed in the Selected References contains a discussion of various monomial orders and their
uses and advantages.

508
VIII. Background for Algebraic Geometry
the total degree in one or two steps. One of the reasons that this kind of monomial
ordering works so efﬁciently is that once the total degree is bounded, there are
only ﬁnitely many monomials less than any given monomial M.
9. Uniqueness of Reduced Gr¨obner Bases
In this section, K continues to denote a ﬁeld, and we work with a ﬁxed monomial
ordering on K[X1, . . . , Xn]. Ideals in K[X1, . . . , Xn] will always be speciﬁed
by giving ﬁnite sets of generators. Our objective in this section is to show how
any Gr¨obner basis can be “reduced” and that a “reduced” Gr¨obner basis for an
ideal is unique. A by-product of the uniqueness argument will be a way of testing
two ideals for equality.
Any ﬁnite set of generators of I that contains a Gr¨obner basis is again a Gr¨obner
basis. Thus a constructed Gr¨obner basis will often be unnecessarily large. One
simple kind of redundance is addressed by Lemma 8.27 below.
Lemma 8.27. If {g1, . . . , gs} is a Gr¨obner basis for a nonzero ideal I in
K[X1, . . . , Xn] and if LM(g1) lies in the ideal

LT(g2), . . . , LT(gs)

, then
{g2, . . . , gs} is a Gr¨obner basis of I.
REMARK. Lemma 8.17 shows how to check whether LM(g1) lies in the ideal

LT(g2), . . . , LT(gs)

; all we have to do is see whether some LM(gj) for j ≥1
divides LM(g1).
PROOF. By hypothesis,

LT(g2), . . . , LT(gs)

=

LT(g1), . . . , LT(gs)

= LT(I).
Therefore {g2, . . . , gs} is a Gr¨obner basis of I. (Recall that the deﬁnition of
Gr¨obner basis does not assume that the set generates the ideal; Proposition 8.19
deduces that it generates.)
□
A Gr¨obner basis {g1, . . . , gs} of a nonzero ideal I is said to be minimal if
LC(gj) = 1 for all j and if no LM(gi) is divisible by LM(gj) for some j ̸= i.
Lemma 8.27 shows that in trying to transform a Gr¨obner basis into a form for
which a uniqueness result will apply, there is no loss of generality in assuming
that the given Gr¨obner basis is minimal.
EXAMPLE. As in the example following Corollary 8.24, let I be the ideal in
K[X, Y] given by I = ( f1, f2) with f1(X, Y) = X2 + 2XY 2 and f2(X, Y) =
XY + 2Y 3 −1. Then we saw that { f1, f2, f3, f4} is a Gr¨obner basis of I in
the lexicographic ordering, where f3(X, Y) = X and f4(X, Y) = 2Y 3 −1.
The leading monomials are LM( f1) = X2, LM( f2) = XY, LM( f3) = X, and
LM( f4) = Y 3. The ﬁrst two are divisible by the third. Therefore {X, Y 3 −1
2} is
the corresponding minimal Gr¨obner basis.

9. Uniqueness of Reduced
509
Unfortunately an ideal can have more than one minimal Gr¨obner basis, as is
shown in Problem 17 at the end of the chapter. A Gr¨obner basis {g1, . . . , gs} of
an ideal I is said to be reduced if it is minimal and if for each i, no monomial
appearing in gi with nonzero coefﬁcient is divisible by LM(gj) for some j ̸= i.
Theorem 8.28 (uniqueness of reduced Gr¨obner basis). If I is a nonzero ideal
in K[X1, . . . , Xn], then I has a unique reduced Gr¨obner basis, and this can be
obtained algorithmically starting from any minimal Gr¨obner basis.
PROOF OF UNIQUENESS. Let {g1, . . . , gs} be any Gr¨obner basis. Since LT(I) =

LT(g1), . . . , LT(gs)

, Lemma 8.17 shows that any LM( f ) for f ∈I is divisible by
LM(gj) for some j. If {h1, . . . , ht} is a second Gr¨obner basis, then this argument
shows that each LM(hi) is divisible by some LM(gj). Turned around, the argument
shows that LM(gj) is divisible by some LM(hk). Since {h1, . . . , ht} is assumed
minimal, LM(hk) cannot be divisible by LM(hi) if i ̸= k. Thus LM(hi) = LM(hk),
and these equal LM(gj). Then it follows that s = t and that we may enumerate
any two minimal Gr¨obner bases in such a way that the leading monomial of the
ith member of each basis is the same for each i with 1 ≤i ≤s.
With this normalization in place, let us show that gi = hi. To do so, we expand
gi −hi as gi −hi = 	s
j=1 ajhj with LM(gi −hi) = maxj LM(ajhj) in accordance
with (b) of Theorem 8.23. Choose k such that the maximum on the right side is
attained at k, i.e., such that
LM(ak) LM(hk) = LM(gi −hi).
(∗)
Arguing by contradiction, suppose that the right side of (∗) is nonzero. Then it
must be a monomial occurring in either gi or hi. Since the two Gr¨obner bases are
reduced, no monomial occurring in gi is divisible by LM(gk) = LM(hk) if k ̸= i,
and similarly for monomials occurring in hi. We conclude that k = i and that
LM(hi) = LM(gi −hi). But this is impossible by Proposition 8.18 if gi −hi ̸= 0,
since LM(gi) = LM(hi) and LC(gi) = LC(hi) = 1. Therefore the right side of (∗)
is 0, and gi = hi.
□
PROOF OF EXISTENCE. Let {g1, . . . , gs} be a minimal Gr¨obner basis of I. As
was shown in the proof of uniqueness, the leading monomials LM(g1), . . . , LM(gs)
areindependentofthechoiceoftheactualminimalbasis. Lookingatthedeﬁnition
of “reduced,” we see therefore that the property of being reduced is a property of
each member gi of the basis separately. That is, it is meaningful to say that gi
is reduced if no monomial appearing in gi with nonzero coefﬁcient is divisible
by LM(gj) for some j ̸= i. We shall show how to replace gi by an element g′
i
with the same leading monomial in such a way that the new set is still a Gr¨obner
basis and g′
i is reduced, and then the proof will be complete. There is no loss of
generality in taking i = 1.
Gröbner Bases

510
VIII. Background for Algebraic Geometry
Applying the generalized division algorithm (Proposition 8.20), we write
g1 =
s	
j=2
ajgj + r
(∗∗)
in such a way that
LM(g1) = max
2≤j≤s
LM(ajgj)
(†)
and that no monomial appearing in r with nonzero coefﬁcient is divisible by
LM(gj) for any j ≥2. If we deﬁne g′
1 to be this element r, then the element g′
1
is reduced in the above sense, and the only question is whether {g′
1, g2, . . . , gs}
is a Gr¨obner basis. Since {g1, . . . , gs} is minimal, LM(g1) is not divisible by any
LM(gj) for j ≥2. Consequently LM(g1) appears with nonzero coefﬁcient on the
left side of (∗∗), and it does not appear in any of the terms ajgj with nonzero
coefﬁcient on the right side. Consequently it appears in r = g′
1, and LM(g1) ≤
LM(g′
1). On the other hand, the equality (†) implies that LM(g′
1) ≤LM(g1).
Therefore LM(g1) =
LM(g′
1), and LT(I) =

LT(g1), LT(g2) . . . , LT(gs)

=

LT(g′
1), LT(g2) . . . , LT(gs)

. Consequently {g′
1, g2, . . . , gs} is a Gr¨obner basis
by deﬁnition.
□
Corollary 8.29 (solution of the ideal-equality problem). Let I and J be two
nonzero ideals in K[X1, . . . , Xn] speciﬁed in terms of ﬁnite sets of generators.
Then I = J if and only if the reduced Gr¨obner bases of I and J relative to a
single monomial ordering are the same.
REMARK. As with the solution of problems listed in Corollaries 8.25 and 8.26,
the desired end is independent of the monomial ordering, and in practice one
might just as well start from a monomial ordering for which the computation of
Gr¨obner bases is relatively easy.
PROOF. This result is immediate from Corollary 8.24 (constructive existence
of Gr¨obner bases) and Theorem 8.28.
□
10. Simultaneous Systems of Polynomial Equations
In this section we combine our techniques concerning the resultant and Gr¨obner
bases to attack the original problem discussed in Section 1, that of solving systems
of simultaneous polynomial equations in several variables. Our interest ultimately
will be in the case that the underlying ﬁeld is algebraically closed.
Corollary 8.26 and the Nullstellensatz already combine to give a criterion for
such a system to have no solutions: We regard the system as the zero locus of
an ideal, and we calculate a Gr¨obner basis for the ideal. Then the system has no

10. Simultaneous Systems of Polynomial Equations
511
solutions if and only if the Gr¨obner basis contains a constant polynomial, i.e., if
and only if the reduced Gr¨obner basis is {1}.
Let us now consider the problem of ﬁnding the solutions when solutions exist.
We begin with the case of two equations in two unknowns over the ﬁeld C,
recalling what we know from the theory of the resultant. Consider the system
X2Y + Y 2 = 5,
XY = 2.
Set f (X, Y) = X2Y +Y 2 −5 and g(X, Y) = XY −2. To ﬁnd points (x, y) with
f (x, y) = g(x, y) = 0, using the style of Sections 1–3, we compute the resultant
of f and g in the X variable, say, and obtain the polynomial Y 4 −5Y 2 + 4Y.
Setting this equal to 0 gives us y = 0, y = 1, and y = 1
2(−1 ±
√
17 ). We can
then substitute each such y into x2y + y2 = 5 and get candidates (x, y). Doing so
for y = 0 gives us no candidates, and doing so for each of the other three values
of y gives us two values of x, differing only in a sign. So we get six pairs (x, y).
However, only three of these satisfy the second given equation, xy = 2, one for
each nonzero value of y. Thus the resultant gives us a handle on the problem of
ﬁnding solutions, but it has two shortcomings: it produced a value of y yielding
no solution pairs (x, y), and it produced extraneous x values.
To ﬁnd points (x, y) with f (x, y) = g(x, y) = 0, using the style of Sec-
tions 7–10, we consider ( f, g) as an ideal in C[X, Y], and we are interested
in the locus of common zeros VC(( f, g)) of the ideal. We start by ﬁnding a
reduced Gr¨obner basiswith respect to a suitable ordering. The usual lexicographic
ordering will do ﬁne here, and the result is {X + 1
2Y 2 −5
2, Y 3 −5Y + 4}. By
what may seem to be good fortune, the second element depends on Y alone, and
the roots are y = 1 and y = 1
2(−1 ±
√
17 ). If we substitute these values into
the equation x + 1
2 y2 −5
2 = 0, we get one value of x for each y. We can solve
because the coefﬁcient 1 of x is nonzero for each y in question. No pair (x, y)
that we obtain is superﬂuous because the locus of common zeros of f and g is
identical with the locus of common zeros of the members of the Gr¨obner basis.
This approach raises several questions about a possible generalization:
(i) Under what conditions can we expect that a Gr¨obner basis for an ideal I
in K[X, Y] will contain a member that depends just on Y?
(ii) If the Gr¨obner basis contains no element that depends just on Y, then
what can we expect?
(iii) If we are able to solve for values of y, under what conditions can we use
the remaining member(s) of the Gr¨obner basis to solve for x?
Part of the answer to (i) is contained in the Elimination Theorem proved as
Theorem 8.30 below. This theorem says for the lexicographic ordering that the
members of a Gr¨obner basis that depend just on Y generate I ∩K[Y]; in fact,

512
VIII. Background for Algebraic Geometry
they form a Gr¨obner basis of this ideal of K[Y]. For the case that I = ( f, g), the
resultant is a member of I ∩K[Y]. Thus a nonzero resultant ensures that some
member of the Gr¨obner basis will depend just on Y; on the other hand, I ∩K[Y]
has to be a principal ideal in K[Y], and any Gr¨obner basis of that principal ideal
has to contain the ideal’s generator (up to a scalar factor). By contrast, a zero
resultant leads us to question (ii) because it says, by Theorem 8.1, that f and
g have a common factor h(X, Y) of positive degree in X as long as both f and
g have positive degree in X. The largest power of X in h has as coefﬁcient
a polynomial in Y that has only ﬁnitely many roots, and if K is algebraically
closed, then every y unequal to one of these roots will produce an x such that
h(x, y) = 0 and therefore such that f (x, y) = g(x, y) = 0. In other words,
except in degenerate cases a zero resultant implies that there cannot be a member
of the Gr¨obner basis that depends just on Y. Finally the answer to (iii) lies deeper
and is contained in the Extension Theorem, which is proved as Theorem 8.31
below.
Let I be a nonzero ideal in K[X1, . . . , Xn], K being any ﬁeld for now. If
0
≤
k
≤
n −1, then the kth elimination ideal of I is the ideal
I ∩K[Xk+1, . . . , Xn] in K[Xk+1, . . . , Xn].
A monomial ordering on
K[X1, . . . , Xn] will be said to be of k-elimination type if any monomial con-
taining any of X1, . . . , Xk to a positive power is greater than any monomial in
Xk+1, . . . , Xn alone. The usual lexicographic ordering is of k-elimination type
for every k. An example of a monomial ordering of k-elimination type that is of
great interest in applications is the one of Bayer–Stillman described in Example 4
of monomial orderings in Section 7.
Theorem 8.30 (Elimination Theorem).
Let K be any ﬁeld, let I be a
nonzero ideal in K[X1, . . . , Xn], let 0 ≤k ≤n, and ﬁx a monomial ordering
of k-elimination type. If {g1, . . . , gs} is a Gr¨obner basis of I, then the subset of
members of {g1, . . . , gs} depending only on Xk+1, . . . , Xn is a Gr¨obner basis of
the kth elimination ideal J = I ∩K[Xk+1, . . . , Xn].
PROOF. Relabeling the members of {g1, . . . , gs}, we may assume that the gj’s
lying in J are g1, . . . , gt. The ﬁrst step is to show that J = (g1, . . . , gt). If
f ∈J is given, we apply the generalized division algorithm (Proposition 8.20)
and write f = 	s
i=1 aigi + r with LM(aigi) ≤LM( f ) for all i and with no
monomial appearing in r with nonzero coefﬁcient divisible by LM(gj) for any
j. Corollary 8.21 shows that r = 0. If ai ̸= 0 and i is not ≤t, then LM(aigi)
involves at least one of X1, . . . , Xk, and the deﬁnition of monomial ordering of
k-elimination type implies that LM(ai fi) > LM( f ). It follows that ai = 0 for
i > t, and thus J = (g1, . . . , gt).
To see that {g1, . . . , gt} is a Gr¨obner basis of J, we apply Theorem 8.23. We
are to show for each pair (gj, gk) with S(gj, gk) ̸= 0 and { j, k} ⊆{1, . . . , t} that

10. Simultaneous Systems of Polynomial Equations
513
there is an expansion S(gj, gk) = 	t
i=1 aigi with LM(aigi) ≤LM

S(gj, gk)

. In
view of the argument with f in the previous paragraph, it is enough to show that
S(gj, gk) lies in J. The formula is
S(gj, gk) = LCM

LM(gj), LM(gk)

LT(gj)
gj −LCM

LM(gk), LM(gk)

LT(gk)
gk.
The coefﬁcient fractions are members of K[Xk+1, . . . , Xn], since the monomial
ordering is of k-elimination type, and thus S(gj, gk) is indeed in J.
□
EXAMPLE. Formula for discriminant of a polynomial in one variable. This
example is one that we have addressed before by specialized methods. We include
it anyway because the use of Gr¨obner bases allows one to solve many similar
problems that the specialized methods do not address. By way of illustration,
let (X −r)(X −s)(X −t) be a cubic polynomial. The discriminant is D =
(r −s)2(s −t)2(r −t)2. This is a polynomial that is symmetric in r, s, t, and the
general theory of symmetric polynomials (in the problems for Chapter VIII in
Basic Algebra) shows that it has to be a polynomial in the elementary symmetric
polynomials a = r + s + t, b = rs + rt + st, c = rst. We seek a formula for D
in terms of a, b, c. We form the ideal I in K[r, s, t, D, a, b, c] given by
I =

D −(r −s)2(s −t)2(r −t)2, a −(r + s + t), b −(rs + rt + st), c −rst

.
With the variables enumerated as r, s, t, D, a, b, c, we use any monomial order-
ing of 4-elimination type, the lexicographic ordering for example, and form the
reduced Gr¨obner basis of I. Calculation best done with the aid of a computer
gives D −a2b2 + 4b3 + 4a3c −18abc + 27c2 and three other members of I that
involve r, s, or t. Theorem 8.30 shows that the 4th elimination ideal is principal
with generator D −a2b2 +4b3 +4a3c−18abc+27c2. Thus the desired formula
is D = a2b2 −4b3 −4a3c + 18abc −27c2.
LetuscometotheExtensionTheorem. Thestatementandproofofthistheorem
do not make use of Gr¨obner bases, but they do refer to the kth elimination ideal,
which is identiﬁed explicitly in Theorem 8.30 with the aid of a Gr¨obner basis.
The intention is that the theorem be applied inductively in any application, taking
into account one additional variable at each step of an induction.
Theorem 8.31 (Extension Theorem). Let K be an algebraically closed ﬁeld, let
I = ( f1, . . . , fs) be an ideal in K[X1, . . . , Xn], and let J be the ﬁrst elimination
ideal of I in K[X2, . . . , Xn]. For each fi, expand fi in powers of X1 as
fi(X1, . . . , Xn) = gi(X2, . . . , Xn)Xl1
1 + (lower powers of X1)
with gi in K[X2, . . . , Xn]and gi nonzerounless fi = 0. Supposethat(c2, . . . , cn)
lies in the zero locus VK(J) ⊆K n−1. If gi(c2, . . . , cn) ̸= 0 for some i, then there
exists c1 in K such that (c1, . . . , cn) is in the zero locus VK(I) ⊆K n.

514
VIII. Background for Algebraic Geometry
Before giving the proof, we need to extend the theory of the resultant slightly
in such a way that it applies to s polynomials f1, . . . , fs rather than just to two.
To do so, we introduce new indeterminates U2, . . . , Us and regard
F = U2 f2 + · · · + Us fs
as a member of K[U2, . . . , Us, X1, . . . , Xn] whose degree deg1 F in X1 is the
maximum of the degrees of f2, . . . , fs in X1. We can then view f1 as a member of
the same polynomial ring K[U2, . . . , Us, X1, . . . , Xn] of degree deg1 f1 and form
the resultant of f1 and F in the X1 variable. This is computed as the determinant
of some square matrix of size deg1 f1 + deg1 F, and we are interested only in
the case that deg1 f1 ≥1 and deg1 F ≥1.
When expanded in monomials
U α = U α2
2 · · · U αs
s , the determinant is of the form
R( f1, F) =

α
hα(X2, . . . , Xn)U α
with each hα in K[X2, . . . , Xn]. The polynomials hα will be called the general-
ized resultants in the X1 variable of the ordered pair ( f1, { f2, . . . , fs}).
PROOF OF THEOREM 8.31. Let us abbreviate X = (X2, . . . , Xn) and ¯c =
(c2, . . . , cn); we shall write
(X1, X) = (X1, . . . , Xn)
and
(X1, ¯c) = (X1, c2, . . . , cn).
We seek c1 ∈K with fj(c1, c) = 0 for all j. The assumption is that gi(¯c) ̸= 0
for some i, and we may as well assume that this i is i = 1. If deg1 f1 = 0, then
f1 is in J, and the conditions that f1 = 0 on VK(J) and that g1(¯c) ̸= 0 contradict
one another; hence deg1 f1 ≥1.
Asintheparagraphbeforetheproof, put F = U2 f2+· · ·+Us fs. Ifdeg1 F = 0,
then fj is independent of X1 for all j ≥2, and hence fj is in J for j ≥2. In this
case it is enough to ﬁnd c1 with f1(c1, ¯c) = 0. Since g1(¯c) ̸= 0, f1(X1, ¯c) is a
one-variable polynomial of degree l1 ≥1, and it is 0 for some value c1. Thus the
proof is complete if deg1 F = 0.
We may therefore assume that deg1 F ≥1. Form the resultant in X1 given by
R( f1, F) = 	
α
hα(X)U α,
where the hα’s are the generalized resultants mentioned above. The main step is
to prove that each hα lies in the ﬁrst elimination ideal J. Since hα depends only
on X, it is enough to prove that each hα is in I. We have arranged that each of f1

10. Simultaneous Systems of Polynomial Equations
515
and F has positive degree and has nonzero leading coefﬁcient in X1, and hence
Theorem 8.1 shows that
af1 + bF = R( f1, F)
for some nonzero polynomials a and b in K[U2, . . . , Us, X1, X]. Let the mono-
mial expansions of a and b in terms of the U α’s be a = 	
α aαU α and b =
	
α bαU α. Then we have
	
α
aα f1U α +
 	
β
bβU β
s	
i=2
fiUi

= 	
α
hαU α.
(∗)
Let ei be the multi-index that is 1 in the ith place and 0 elsewhere. This has the
property that U ei = Ui for 2 ≤i ≤s. We can rewrite (∗) as
	
α
hαU α = 	
α
aα f1U α + 	
α

	
(β,i) with
2≤i≤s,
β+ei=α
bβ fi

U α.
Equating the coefﬁcients of U α on both sides gives
hα = aα f1 +
	
(β,i) with
2≤i≤s,
β+ei=α
bβ fi
and exhibits hα as in I. Therefore hα is in the elimination ideal J.
Since ¯c lies in VK(J), hα(¯c) = 0 for all α. Consequently
R( f1, F)(U2, . . . , Us, ¯c) = 0.
Theorem 8.1 shows that f1(X1, ¯c) and F(U2, . . . , Us, X1, ¯c) have a common
factor of positive degree in X1 provided either or both of two speciﬁc coefﬁcients
are nonzero. These are the coefﬁcients of Xdeg1 f1
1
in f1(X1, ¯c) and of Xdeg1 F
1
in
F(U2, . . . , Us, X1, ¯c). The coefﬁcient of Xdeg1 f1
1
in f1(X1, X) is g1(X); thus
the coefﬁcient of Xdeg1 f1
1
in f1(X1, ¯c) is g1(¯c) and is nonzero by assumption.
Therefore Theorem 8.1 is applicable.
The common factor of f1(X1, ¯c) and F(U2, . . . , Us, X1, ¯c) may be taken to
be prime, and then it has to be a nonzero scalar multiple of X1 −c1 for some
c1 ∈K, since that is the only kind of prime factor that divides f1(X1, ¯c), K being
algebraically closed. Thus the element c1 of K satisﬁes
f1(c1, ¯c) = 0
and
F(U2, . . . , Us, c1, ¯c) = 0.
(∗∗)

516
VIII. Background for Algebraic Geometry
Writing out F, we have
0 = F(U2, . . . , Us, c1, ¯c) = U2 f2(c1, ¯c) + · · · + Us fs(c1, ¯c).
This is an identity in K[U2, . . . , Us], and each coefﬁcient must be 0 on the right
side. Thus 0 = f2(c1, ¯c) = · · · = fs(c1, ¯c). Since (∗∗) shows that f1(c1, ¯c) = 0,
this proves the theorem.
□
11. Problems
1.
How many points are in Pn
K if K is a ﬁnite ﬁeld with q elements?
2.
Resolve Cramer’s paradox as formulated in Section 1.
3.
(Euler’s Theorem) Prove that if F(X1, . . . , Xn) is any homogeneous polyno-
mial of degree d, then 	n
j=1 X j ∂F
∂X j = dF.
4.
Let A and B be unique factorization domains, and let ι : A →B be a one-one
homomorphism of commutative rings with identity. For each h(X) in A[X], let
hι(X) be the member of B[X] obtained by applying the substitution homomor-
phism that acts by ι on the coefﬁcients and ﬁxes X. Using resultants, prove that
if f (X) and g(X) are two members of A[X] such that f ι(X) and gι(X) have a
common factor in B[X] that is not in B, then f and g have a common factor in
A[X] that is not in A.
5.
Theorem 8.1 assumes that at least one of the coefﬁcients fm and gn is nonzero.
Sometimes this theorem is phrased with the stronger hypothesis that fm and gn
are both nonzero. By comparing the resultants that are involved, show that all
parts of the theorem with at least one of fm and gn nonzero are consequences of
the theorem with both fm and gn nonzero.
6.
Let K be an algebraically closed ﬁeld, let f and g be members of K[X1, . . . , Xn]
with f irreducible, and suppose that g(a1, . . . , an) = 0 whenever f (a1, . . . , an)
= 0. Give two proofs, one using the Nullstellensatz and one using resultants,
that f divides g.
7.
Factor the member Y 3 −2XY 2 + 2X2Y −4X3 of C[X, Y]3 into ﬁrst-degree
factors.
8.
Find the intersections in P2
C of the zero loci of the projective plane curves
F(X, Y, W) = X(Y 2 −XW)2 −Y 5 and G(X, Y, W) = Y 4 + Y 3W −X2W 2.
9.
Let A be a unique factorization domain, let B = A[Y1, . . . , Ym, Z1, . . . , Zn], let
F and G be the polynomials in B[X] given by
F(X) =
m
i=1
(X −Yi)
and
G(X) =
n
j=1
(X −Zj),
and let R(Y1, . . . , Ym, Z1, . . . , Zn) be the resultant R(F, G) with respect to X.
(a) Show that R(Y1, . . . , Ym, Z1, . . . , Zn) equals 0 if Yi is set equal to Zj.

11. Problems
517
(b) Deduce from (a) that Yi −Zj divides R(Y1, . . . , Ym, Z1, . . . , Zn).
(c) Deduce from (b) that R(Y1, . . . , Ym, Z1, . . . , Zn) = c 
i, j (Yi −Zj) for
some c ̸= 0 in A depending on m and n.
10. Let f (X) be in K[X], K being a ﬁeld, and let f ′(X) be the derivative of f (X).
Using the result of the previous problem and the computation at the beginning
of Section V.4, prove that R( f, f ′) is a nonzero multiple of the discriminant of
f , the multiple depending only on deg f .
11. Let F and G be the homogeneous polynomials given by F(X, Y, W) =
(X2 + Y 2)2 + 3X2Y W −Y 3W and G(X, Y, W) = (X2 + Y 2)3 −4X2Y 2W 2.
Calculate I (P, F ∩G) for P = [0, 0, 1].
12. Let G be a nonconstant homogeneous polynomial in K[X, Y, W]d vanishing at
a point P of P2
K, let m = m P(G) be the order of vanishing of G at P, and let L
be a projective line through P. Show from the deﬁnitions that L is a tangent line
to G at P in the sense of Section 5 if and only if i(P, L ∩G) ≥m + 1 in the
sense of Section 4.
13. Deduce relative to an arbitrary monomial ordering the (nonconstructive) exis-
tence of a Gr¨obner basis for a nonzero ideal I in K[X1, . . . , Xn] from the form
of a set of generators of the ideal LT(I).
14. For 1 ≤i ≤n, let w(i) be the weight vector w(i) = (w(i)
1 , . . . , w(i)
n ) in Rn, and
suppose that these vectors are linearly independent. Show that the w(i) deﬁne a
monomial ordering as in Example 5 of Section 7 if and only if for each j, the
ﬁrst i with w(i)
j
̸= 0 has w(i)
j
> 0.
15. This problem shows for two variables that every monomial ordering arises from a
system of two independent weight vectors satisfying the condition in the previous
problem. Let a monomial ordering be imposed on K[X, Y].
(a) If X > Y q for all q > 0, show that the ordering is lexicographic and is
determined by the system of two weight vectors {(1, 0), (0, 1)}.
(b) If X < Y q for some q > 0, show that there exists a unique real number
r ≥0 such that for all ordered pairs of integers u ≥0 and v ≥0, Xu > Y v
if ru > v and Xu < Y v if ru < v.
(c) If X < Y q for some q > 0 and if r is deﬁned as in (b), prove that the
monomial ordering is determined by the system of two weight vectors
{(r, 1), (s, t)} for a suitable (s, t).
16. In K[X, Y], deﬁne f (X, Y) = X2Y + XY 2 + Y 2, f1(X, Y) = XY −1, and
f2(X, Y) = Y 2 −1. Show that
f (X, Y) = (X + Y) f1 + 1 f2 + r1 = X f1 + (X + 1) f2 + r2
with r1(X, Y) = X + Y + 1 and r2 = 2X + 1 gives two decompositions in the
lexicographic ordering of f relative to { f1, f2} satisfying the conditions of the

518
VIII. Background for Algebraic Geometry
generalized division algorithm of Proposition 8.20. Conclude that the remainder
term need not be unique, nor need the coefﬁcients of f1 and f2.
17. Observe for any scalar a that the ideal I = (X2 + cXY, XY) in K[X, Y] is
independent of c.
(a) Verify that {X2 + cXY, XY} is a minimal Gr¨obner basis of I relative to the
lexicographic ordering for any choice of c.
(b) Show that {X2, XY} is the reduced Gr¨obner basis for I.
Problems 18–20 characterize ideals in K[X1, . . . , Xn] whose locus of common zeros
is a ﬁnite set under the assumption that K is an algebraically closed ﬁeld. Thus let
K be an algebraically closed ﬁeld, and let I be a nonzero ideal in K[X1, . . . , Xn].
18. Under the assumption for each j with 1 ≤j ≤n that I contains a nonconstant
polynomial Pj(X j), prove that VK(I) is a ﬁnite set.
19. Converselyundertheassumptionthat VK(I))isaﬁniteset, usetheNullstellensatz
to produce for each j, a nonconstant polynomial Pj(X j) lying in I.
20. Impose the usual lexicographic ordering on monomials. Prove that LT(I) con-
tains some X
lj
j for each j with 1 ≤j ≤n if and only if VK(I) is a ﬁnite
set. (Educational note: The advantage of this characterization over the one in
Problems 18–19 is that checking this one is easy by inspection once a Gr¨obner
basis of I has been computed.)
Problems 21–23 relate solutions of simultaneous systems of polynomial equations to
the theory of the Brauer group in Chapter III. A ﬁeld L is said to satisfy condition
(C1) if every homogeneous polynomial of degree d in n variables with d < n has a
nontrivial zero. The signiﬁcance of this condition was shown in Problem 20 at the
end of Chapter III: the Brauer group B(L) of such a ﬁeld is necessarily 0. The present
set of problems establishes that a simple transcendental extension of an algebraically
closed ﬁeld satisﬁes condition (C1). No knowledge of Chapter III is needed for these
problems, but Problem 23 will take for granted a certain theorem to be proved in
Chapter X.
21. Let K beanalgebraicallyclosedﬁeld, andlet L = K(X)beasimpletranscenden-
tal extension. It is to be shown that any member F(T1, . . . , Tn) of L[T1, . . . , Tn]d
of the form F(T1, . . . , Tn) = 	
i1,...,in ai1···inT i1
1 · · · T in
n has a nontrivial zero if
d < n and each ai1,...,in lies in the ﬁeld L = K(X).
(a) Why is it enough to consider such polynomials with each ai1,...,in in the
polynomial ring K[X]?
(b) With the simpliﬁcation from (a) in place, let δ be the maximum degree in
X of the coefﬁcients ai1···in. Let N be a positive integer to be speciﬁed. By
looking for a solution of the form Ti = 	N
j=0 bi j X j with each bi j in K, show
that substitution of this formula into the formula F(T1, . . . , Tn) = 0 leads
to a system of homogeneous polynomial equations over K in the unknowns
bi j, one of each degree from 0 to δ + Nd.

11. Problems
519
22. (a) In the setting of the previous problem, show that the number of unknowns
is (N + 1)n and that the number of equations is at most Nd + δ + 1.
(b) Show for N sufﬁciently large that the number of equations is less than the
number of unknowns.
23. The following theorem will be discussed in Chapter X: if K is algebraically
closed and if m ≤n, then the locus of common zeros in Pn
K of m nonconstant
homogeneous polynomials in K[X1, . . . , Xn+1] is nonempty. Assuming this
theorem, deduce from the previous two problems the conclusion that the ﬁeld
L = K(X) satisﬁes condition (C1) if K is algebraically closed.

CHAPTER IX
The Number Theory of Algebraic Curves
Abstract. This chapter investigates algebraic curves from the point of view of their function ﬁelds,
using methods analogous to those used in studying algebraic number ﬁelds.
Section 1 gives an overview, explaining how Riemann’s theory of Riemann surfaces of functions
ties in with the notion of an algebraic curve and explaining how such curves can be investigated
through the discrete valuations of their function ﬁelds. It is shown that what needs to be studied is
arbitrary function ﬁelds in one variable over a base ﬁeld. It is known that every compact Riemann
surface can be viewed as an algebraic curve irreducible over C, and thus the function ﬁelds of
compact Riemann surfaces are to be viewed as informative examples of the theory in the chapter.
Section 2 introduces the notion of a divisor, which is any formal ﬁnite Z linear combination of
the discrete valuations of the function ﬁeld that are trivial on the base ﬁeld, and the notion of the
degree of a divisor, which is the sum of its coefﬁcients weighted suitably. Each nonzero member
x of the function ﬁeld gives rise to a principal divisor (x), and the main result of the section is that
the degree of every principal divisor is 0. This is an analog for function ﬁelds of the Artin product
formula for number ﬁelds.
Section 3 contains the deﬁnition of the genus of the function ﬁeld under study. The main object
of study is the vector space L(A) for a divisor A; this consists of 0 and all nonzero members x of
the function ﬁeld such that (x) + A is a divisor ≥0. Roughly speaking, it may be viewed as the
space of functions on the zero locus of the curve whose poles are limited to ﬁnitely many points and
to a certain order depending on the point. The genus is deﬁned in terms of dim L(A) −deg A when
A is a divisor that is a large multiple of the pole part of any ﬁxed principal divisor. The main result
of the section is Riemann’s inequality, which says that dim L(A) ≥deg A + 1 −g for all divisors
A, where g ≥0 is the genus, and that g is the smallest integer that works in this inequality for all
divisors A.
Sections 4–5 concern the Riemann–Roch Theorem, which gives an interpretation of the difference
of the two sides of Riemann’s inequality as dim L(B) for a suitable divisor B that can be deﬁned in
terms of A. Section 4 gives the statement and proof of the theorem, and Section 5 gives a number
of simple applications.
1. Historical Origins and Overview
As was mentioned in Chapter VIII, modern algebraic geometry grew out of early
attempts to solve simultaneous polynomial equations in several variables and out
of the theory of Riemann surfaces. Chapter VIII discussed the impact of the ﬁrst
of these sources, and the present chapter discusses the impact of the second.
520

1. Historical Origins and Overview
521
The theory of Riemann surfaces was begun by Riemann and continued by
Liouville, Abel, Jacobi, Weierstrass, and others. This section discusses brieﬂy
the point of view in these studies, which began as an effort to solve a problem in
real analysis, moved into complex analysis, and ﬁnally arrived at investigations of
afﬁne plane curves over C, but from a point of view quite different from the one in
ChapterVIII.Theendresult isastudyofthe curvethroughthefunctionsonitszero
locus, and the approach has something in common with the approach to algebraic
number theory in Chapter VI. It is not necessary to understand the background in
maximum generality, and we shall be content with suitable examples.
Riemannwasinterestedinsayingsomethingusefulaboutseeminglyintractable
integrals like the one arising from the arc length of an ellipse; let us take
y = y(x) =
/ x
dt
√(t −a)(t −b)(t −c),
where a, b, c are distinct constants, as a speciﬁc example. The lower limit of
integration is unimportant, since it affects the value of the integral only by an
additive constant. We sketch an analysis of the integral,1 proceeding formally for
the moment. Although y as a function of x seems intractable, any sort of inverse
function has nice properties. The formula for y gives us
dy =
dx
√(x −a)(x −b)(x −c),
and an inverse function x = x(y) thus has derivative
dx
dy =
2
(x −a)(x −b)(x −c).
Consequently we should expect that
dx
dy
2
= (x −a)(x −b)(x −c).
Of course, the singularities at a, b, c are problematic, and the square root might
have a negative argument, depending on the location of x.
Riemann’s starting point for a rigorous investigation was to let x be complex,
rather than real, and to let the integral be taken over paths in C. The result is
then not an ordinary function y(x), since the square root in the integrand is not
a well-deﬁned function for t in C −{a, b, c}. We can make a choice for which
the square root is well deﬁned, however, as long as we restrict attention to a
small neighborhood of a particular t. Thus we can visualize small overlapping
disks each centered at a point along an arbitrary path of integration with t in
C −{a, b, c} with the property that the integrand is well deﬁned on each such
1For more details one can consult the author’s book Elliptic Curves, pp. 165–183.

522
IX. The Number Theory of Algebraic Curves
disk. The interpretation of the square root may be assumed to match on the
intersection of any two disks. When a path goes around one or more of the
singularities and we return to the same t, we view the new disk as the same as
the old one if the values of the square root match, but as different if the values do
not match. The union of the disks with this convention becomes a new domain
of interest, and the function F(t) = √(t −a)(t −b)(t −c) on C −{a, b, c}
becomes a well-deﬁned function F(ζ) on this new domain. This new domain is a
relatively simple example of a Riemann surface, i.e., a connected 1-dimensional
complex manifold.
In more modern language the new domain is a twofold covering of the three-
times punctured plane C −{a, b, c}, obtained as follows. We ﬁx a base point z0
in C −{a, b, c} and deﬁne a winding number for each of the points a, b, c as
usual. The subset of the fundamental group of C −{a, b, c} for which the sum of
the three winding numbers is even is a subgroup and corresponds, via standard
covering-space theory, to a certain twofold covering space R of C −{a, b, c},
the covering map being called e. This covering space is a new domain on which
the integrand is well deﬁned. On each ﬁber of the covering, e is two-to-one. Let
ζ0 be one of the two preimages of z0. Let us adjoin points a∗, b∗, c∗, ∞∗to the
covering space R and extend e by the deﬁnitions e(a∗) = a, e(b∗) = b, e(c∗) = c,
e(∞∗) = ∞. One can show that the complex structure extends from R to the
enlarged space R∗in such a way that the extended e is a holomorphic function
from R∗onto C ∪{∞}. The enlarged space R∗becomes a compact Riemann
surface, and the extended e is a branched covering of the Riemann sphereC∪{∞}.
Topologically R∗turns out to be a torus, as we shall see in a moment.
Riemann in his own investigations went on to study the function theory of
compact Riemann surfaces. The interest is in deciding whether there is a globally
deﬁned meromorphic function with poles/zeros only at chosen points and with
poles/zeros at most/least of some speciﬁed order. If there is such a function,
one wants to know the dimension of the space of such functions. The basic tool
for addressing this question is the Riemann–Roch Theorem. In the context of
Riemannsurfaces, theRiemann–RochTheorem hasbothananalysisaspectandan
algebraic aspect. The analysis aspect may be viewed as using the theory of elliptic
differential operators to prove existence of enough nonconstant meromorphic
functions for the Riemann surface to acquire an algebraic structure. For the
purposes of this book, we can just accept this circumstance and not try to extend
it in any way; however, we will sketch in a moment how the algebraic structure
can be obtained concretely for our example. The algebraic aspect may be viewed
as mining this algebraic structure to deduce as many dimensionality relations
as possible among the function spaces of interest. This is the theory that we
shall want to extend; we return to our method for carrying out this project after
producing the algebraic structure for our example by elementary means.

1. Historical Origins and Overview
523
To introduce the algebraic structure in our example, we use our knowledge of
R∗to make sense out of the expression
w(C) =
/
C
F(ζ)−1 dζ
for any piecewise smooth curve C on R∗that starts from the base point ζ0.
If C is given by C(t) for t in an interval I, then this integral is to be equal to
w(C) =

t∈I F(C(t))(e◦C)′(t) dt. Let a, b, c be small loops in C−{a, b, c}
respectively about a, b, c based at z0, each having winding number 1, and deﬁne
1 = ab and 2 = bc. Lift 1 and 2 to curves 1 and 2 in R∗based at
ζ0, and deﬁne
ω1 =
/
1
F(ζ)−1 dζ
and
ω2 =
/
2
F(ζ)−1 dζ.
It turns out that ! = Zω1 + Zω2 is a lattice in C and that there is a well-deﬁned
function w : R∗→C/! such that whenever ζ is in R∗and C is a piecewise
smooth curve from ζ0 to ζ, then w(ζ) ≡w(C) mod !. The function w(ζ) is one-
one onto and is biholomorphic. In particular, R∗is exhibited as homeomorphic
to a torus.
Let w−1 : C/! →R∗be the inverse function of w, and let μ : C →C/! be
the quotient map. Then the composition P = e◦w−1◦μ carries C to C∪{∞} and
can be seen to satisfy P′2 = (P −a)(P −b)(P −c). In other words, P has been
constructed rigorously as an inverse function to the original integral. Except for
small details, P is the Weierstrass ℘function for the lattice ! in C. It is almost
true that z 	→(P(z), P′(z)) is a parametrization of the zero locus of the afﬁne
plane curve y2 −(x −a)(x −b)(x −c) deﬁned over C. The sense in which this
parametrization fails is that P(z) takes on the value ∞at certain points. What
happens more precisely is that z 	→[P(z), P′(z), 1] is a parametrization of the
zero locus of the projective plane curve Y 2W −(X −aW)(X −bW)(X −cW).
Our initial focus in this chapter is in mining this kind of algebraic-curve
structure over C to deduce as many dimensionality relations as possible among
interesting ﬁnite-dimensional subspaces of scalar-valued functions on the zero
locus of the curve.
For instance in the example above, one can ask for the
dimension of the space of meromorphic functions on R∗with at worst simple
poles at two speciﬁed points and with no other poles. The main theorem of this
chapter, the Riemann–Roch Theorem, gives quantitative information about the
dimension of this space and of similar spaces. The goal for this introduction is
to frame this question as an algebra question about the algebraic structure and
to see that some basic tools introduced in Chapter VI in the context of algebraic
number theory are the appropriate tools to use here.

524
IX. The Number Theory of Algebraic Curves
The primary object of study is the “function ﬁeld” of the curve in question.
Let us construct this function ﬁeld for our example. The ideal
I =

Y 2 −(X −a)(X −b)(X −c)

in C[X, Y] is prime, and the restrictions of all polynomial functions to its zero
locus V (I) may be identiﬁed with the integral domain R = C[X, Y]/I by the
Nullstellensatz. It takes a little argument, which we omit, to justify saying that the
meromorphic functions on the zero locus may be viewed as the ﬁeld of fractions
F of C[X, Y]/I; sufﬁce it to say for the moment that we insist that the behavior at
all points of the locus, including any points on the line at inﬁnity in the projective
plane, be limited to poles and zeros, and that is why nonrational functions of
(X, Y) do not appear. At any rate, F is what is taken as the function ﬁeld of the
curve. To have obtained a ﬁeld by this construction, we could have started with
any afﬁne plane curve f (X, Y) over C as in Chapter VIII, except that the principal
ideal ( f (X, Y)) in C[X, Y] has to be assumed to be prime to yield an integral
domain as quotient. That is, f (X, Y) has to be an irreducible polynomial; we say
that the afﬁne plane curve f (X, Y) has to be assumed to be irreducible over C.
The study of members of the function ﬁeld F from the point of view of their
poles and zeros is analogous to the problem of studying factorizations in the
number-theoretic setting. This point was already made in Section VIII.7 of Basic
Algebra, where the case of the afﬁne plane curve above in which (a, b, c) =
(0, +1, −1) was studied in detail. For this one choice of (a, b, c), the integral
domain R = C[X, Y]/I was observed to be the integral closure of C[X] in a
ﬁnite separable extension of C(X), and it is a Dedekind domain by Theorem 8.54
of Basic Algebra; in fact, the same argument works for any choice of (a, b, c) as
long as a, b, c are distinct complex numbers.
Unique factorization of elements into prime elements fails in this R, but we
saw that a geometrically meaningful factorization instead is the factorization of
nonzero ideals into prime ideals. This latter factorization is unique because R is a
Dedekind domain. Meanwhile, since nonzero prime ideals are maximal in R, the
Nullstellensatz shows2 that the nonzero prime ideals in R correspond exactly
to the points of the zero locus V (I). Consequently the unique factorization of
nonzero ideals in R has the geometric interpretation of associating orders of zeros
and poles to members of R. This all seems very tidy, but there are at least three
awkward matters that we need to take into account:
2Let ϕ : C[X, Y] →R be the quotient homomorphism. If M is a maximal ideal in R, then
ϕ−1(M) is a maximal ideal in C[X, Y] and hence is the set of all polynomials vanishing at some
(x0, y0). To show that (x0, y0) is in V (I), assume the contrary. Then there exists g ∈I with
g(x0, y0) ̸= 0. This g is not in the maximal ideal ϕ−1(M), and thus there exist f ∈ϕ−1(M) and
h ∈C[X, Y] with f + gh = 1. Applying ϕ, we obtain ϕ( f ) = 1, in contradiction to the fact that
ϕ( f ) lies in the proper ideal M of R.

1. Historical Origins and Overview
525
(i) we have not included information about zeros and poles at the points at
inﬁnity when the curve is viewed projectively, and that information surely
plays some role,
(ii) the analysis of the function ﬁeld F seems to rely on a subﬁeld C(X) for
which there is surely no canonical description,
(iii) the ring R no longer need be integrally closed if a, b, c are not assumed
distinct, if for example (a, b, c) = (0, 0, 1).
Point (ii) turns out to be an advantage, allowing us to work with the given curve
from multiple perspectives. The “key observation” at the end of this section will
make clear how we can take advantage of (ii).
Point (iii) is quite signiﬁcant. The trouble with the curve Y 2−X2(X −1) is that
the curve has a singularity at (0, 0) in the sense of Section VII.5. The maximal
ideals of the ring C[X, Y]

Y 2 −X2(X −1)

correspond to points on the zero
locus of the curve; but the ring is not a Dedekind domain, and we have few tools
for working with it. To handle matters properly, we have to form the function
ﬁeld directly as F = C(X)[Y]

Y 2 −X2(X −1)

and deﬁne R to be the integral
closure of C[X] in F. This ring R is bigger than C[X, Y]

Y 2−X2(X −1)

and is
a Dedekind domain. Unfortunately its nonzero prime ideals no longer correspond
exactly to points of the zero locus. Example 1 below will illustrate. What happens
is that F readily provides information about the behavior of nonsingular points
of the zero locus but not about singular points. Problems 5–11 at the end of the
chapter address this matter for nonsingular points for afﬁne plane curves more
generally. The tool for making the connection for curves in higher dimension is
Zariski’s Theorem (Theorem 7.23), and we shall carry out the details in Chapter X
when we treat the geometry of curves, as opposed to the number theory.
Point (i) is relevant and is easily handled. When we form the function ﬁeld
of the curve and take R to be the integral closure of C[X] in it, we can associate
C[X] with the polynomials of C and think of them as embedded in the ﬁeld C(X)
of rational functions. The rational functions are all meaningful on the Riemann
sphere C ∪{∞}, and we study behavior of rational functions near ∞by writing
them in terms of X−1 and regarding X−1 as a new variable that is near 0. In
studying our curve, the points in the projective plane that we miss by considering
just the afﬁne curve are the ones that lie over ∞in the Riemann sphere. We
study them by considering the integral closure R′ of C[X−1] in F. If the curve is
nonsingular at all points lying over ∞, then these points correspond to the prime
ideals of R′ whose intersection with C[X−1] is the prime ideal X−1C[X−1] of
C[X−1].
EXAMPLES.
(1) Afﬁne plane curve f (X, Y) = Y 2 −X2(X −1). This polynomial is
irreducible over C but is singular at (0, 0) in the sense that
∂f
∂X and
∂f
∂X both

526
IX. The Number Theory of Algebraic Curves
vanish there. Let F = C(X)[Y]/( f (X, Y)), and let x and y be the images of
X and Y in F. These elements lie in the ring S = C[X, Y]/( f (X, Y)), whose
maximal ideals correspond to points on the zero locus by the Nullstellensatz.
All members of S are of the form a(x) + yb(x), where a and b are arbitrary
polynomials in one variable. Any proper ideal in S containing x has to be of the
form (x, yc1(x), . . . , ycn(x)) for some polynomials c1, . . . , cn. A little argument
using the fact that C[x] is a principal ideal domain shows that the ideal is of the
form (x, yc(x)). Using products of x and polynomials, we see that we can discard
all terms of c(x) but the constant term. Hence the ideal is either (x) itself or is
(x, y). The ideal (x) is not prime, since y · y is in it and y is not in it. The ideal
(x, y) is maximal and hence prime. Since (x, y)2 = (x2, xy, y2) = (x2, xy) is
properly contained in (x), (x) is not the product of prime ideals in S. Thus S is
not a suitable ring for investigating poles and zeros of members of the ﬁeld F.
By contrast, a little computation shows that the integral closure R of C[x] in F
is generated as a C algebra by x and x−1y. This is a Dedekind domain, and the
decomposition of the ideal (x) in R as a product of prime ideals can be checked to
be (x) = (x, x−1y + i)(x, x−1y −i). A factor on the right does not consist of all
functions vanishing at some (0, y0) lying on the zero locus. The only point (0, y0)
on the zero locus is (0, 0), and the two prime factors of (x) say something about
derivatives at that point. This example will be considered further in Problems
21–22 at the end of the chapter.
(2) Afﬁne plane curve f (X, Y) = Y 2 −X4 +1. This polynomial is irreducible
over C and is nonsingular at every point of its zero locus in C2. Again we form the
function ﬁeld F, the members x and y of it, and the ring C[X, Y]/( f (X, Y)). Us-
ing the fact that X4−1 is square free, we can check that this ring is the full integral
closure R of C[x] in F. The ring R is a Dedekind domain, and its elements are all
expressions a(x) and yb(x), where a(x) and b(x) are polynomials. Moreover,
we have (y + x2)(y −x2) = y2 −x4 = (x4 −1) −x4 = −1. Consequently
the elements y ± x2 are nonconstant units in R, and they cannot have zeros or
poles on the zero locus of f (X, Y) in C2. Thus knowledge of the orders of zeros
and poles at every point of the zero locus of f (X, Y) in C2 does not determine
a member of R up to a constant factor. Instead, we have to take into account
the behavior at any points at inﬁnity on the zero locus in the projective plane P2
C.
To see what this set is, we convert f (X, Y) into a homogeneous polynomial of
degree 4, speciﬁcally into F(X, Y, W) = Y 2W 2 −X4 + W 4, and then we look
for points [x, y, w] with F(x, y, w) = 0 and w = 0. These have x = 0 and thus
come down to [0, y, 0]. In other words, there is only one point at inﬁnity on the
zero locus of the curve. It is singular because all three partial derivatives of F
are 0 there. The fact that it is singular means that we should not expect the
prime ideals lying over x−1C[x−1] in the integral closure R′ of C[x−1] in F to
correspond to the points at inﬁnity on the curve. We return to this example shortly.

1. Historical Origins and Overview
527
All these matters begin to sound quite complicated to sort out, but magically
there is a simple way of handling them: for an afﬁne plane curve irreducible
over C, we work with the ﬁeld F of rational functions for the curve, ignoring
the geometry of the curve, and we consider all discrete valuations on this ﬁeld
that are 0 on C×. Discrete valuations were discussed at length in Section VI.2.
They depend only on F, not on the choice of a subring for which F is the ﬁeld
of fractions. As will be seen in Chapter X, the full set of discrete valuations of
F gives information about all potential nonsingular points for any afﬁne curve
with function ﬁeld F, not necessarily planar; there will even be such a curve
whose extension to be deﬁned projectively is everywhere nonsingular, and then
the points on the zero locus of the curve in projective space will be in one-one
correspondence with the discrete valuations of F.
Let us review what Chapter VI tells us about discrete valuations in our set-
ting. Let f (X, Y) be an irreducible polynomial in C[X, Y], let F be the ﬁeld
C(X)[Y]/( f (X, Y)), let x and y be the images of X and Y in F, and let R be the
integral closure of C[x] in F. This is a Dedekind domain by Theorem 8.54 of
Basic Algebra. Corollary 6.10 classiﬁes the discrete valuations of F that are 0 on
C×. It shows that all but ﬁnitely many correspond to prime ideals in R. There
are only ﬁnitely many others. Corollary 6.10 tells us that these other discrete
valuations can be described in terms of the integral closure R′ of C[x−1] in F;
this is another Dedekind domain whose ﬁeld of fractions is F. The exceptional
discrete valuations of F arise from those prime ideals of R′ that occur in the
decomposition of the ideal x−1R′ into prime ideals of R′. Geometrically we may
view these additional discrete valuations as associated in some way with points at
inﬁnity in a projective space, but we can proceed with algebraic manipulations of
these discrete valuations without invoking the geometric interpretation or using
projective space.
EXAMPLE 2, CONTINUED. We continue with the afﬁne plane curve Y 2−X4+1,
the prime ideal I = (Y 2 −X4 +1), and the ring R given as the integral closure of
C[X] in the ﬁeld F = C(X)[Y]/I. Corollary 6.10 divides the discrete valuations
of F that are 0 on C× into two kinds. The ones of the ﬁrst kind are built from the
nonzero prime ideals of R. Since y ± x2 are units in R, all of these valuations
take the value 0 on y ± x2. The discrete valuations of the second kind are those
appearing in the decomposition of the ideal x−1R′ in the integral closure R′ of
C[x−1] in F. The element x−2y is in R′ because it is a root of the polynomial
Y 2 −(1 −x−4) in C[x−1][Y]. Hence R′ contains x−1 and x−2y. On the other
hand, the most general element of F is of the form a(x−1)x−2y +b(x−1), where a
and b are rational expressions in one variable, and this is a root of the polynomial
Y 2 −2b(x−1)Y +

b(x−1)2 −a(x−1)2(1 −x−4)

.

528
IX. The Number Theory of Algebraic Curves
For this element to be in R′, the coefﬁcients must be in C[x−1]. This means that
b(X) is a polynomial and that a(X)2(1 −X4) is a polynomial. Since 1 −X4 has
no repeated roots, the latter condition forces a(X) to be a polynomial. Thus x−1
and x−2y generate R′ as a C algebra. Deﬁne ideals in R′ by
P1 = (x−1, x−2y + 1)
and
P2 = (x−1, x−2y −1).
Then it is straightforward to check the decompositions
(x−1) = P1P2,
(x−2y + 1) = P4
1 ,
and
(x−2y −1) = P4
2 .
Since [F : C(x−1)] = 2 and since x−1 is prime in C[x−1], the ideal (x−1) in R′ is
the product of at most two prime ideals, and it follows that P1 and P2 are prime
ideals in R′. They are distinct because the difference of the respective second gen-
erators is a nonzero scalar. In viewof Corollary 6.10, there are exactly two discrete
valuations of F that are 0 on C× other than the ones coming from prime ideals of
R, and these are the ones coming from the prime ideals P1 and P2 of R′. Let us call
them v1 and v2. The above decompositions of principal ideals give v1(y + x2) =
v1(x−1)−2 + v1(x−2y + 1) = (−2) + (+4) = +2, whereas v1(y −x2) =
(−2) + (0) = −2. Thus v1 takes the distinct values 0, +2, and −2 on 1, y + x2,
and y −x2. Similarly v2 takes the values 0, −2, and +2 on these elements.
We shall work with those discrete valuations of the ﬁeld of rational functions
for the curve under study that are 0 on the base ﬁeld.
These are canonical,
independent of our choice of some Dedekind domain whose ﬁeld of fractions is
the given ﬁeld. However, making a choice of Dedekind domain is convenient
for making calculations. Then we can consider the discrete valuations as of two
kinds, and which discrete valuations are of which kind will depend on our choice
of Dedekind domain.
Context for the study in this chapter. Having concluded that the object to
investigate is the ﬁeld of rational functions of our curve and that the tools include
the discrete valuations, we can now consider the context in which we should
work. Let k be any ﬁeld, not necessarily algebraically closed. We want to work
with the “function ﬁeld” of a suitable kind of curve deﬁned over k. If I is an ideal
in k[X1, . . . , Xn], then the ring R = k[X1, . . . , Xn]/I is an integral domain if
and only if the ideal I is prime, and in this case the ﬁeld of fractions F of R can
be taken to be the associated function ﬁeld. Thus we restrict attention to the case
that I is prime. To bring in the notion that the curve is to be 1-dimensional, we
recall from Theorem 7.22 that the integral domain R has Krull dimension 1 in
the sense of Section VII.4 if and only if the ﬁeld of fractions F has transcendence
degree 1 over k. In this case, F is ﬁnitely generated as a ﬁeld over k, with a ﬁnite
set of generators consisting of the elements xj = X j + I for 1 ≤j ≤n. That is,
F is a function ﬁeld in one variable over k.

1. Historical Origins and Overview
529
Conversely if F is a function ﬁeld in one variable over k, then F is a ﬁnite
algebraic extension of a simple transcendental extension k(x1). Let us write it as
F = k(x1)[x2, . . . , xn] for some n. Form the polynomial ring k[X1, . . . , Xn] and
the ring homomorphism of this ring into F that ﬁxes k and sends X j into xj. The
image of this homomorphism is an integral domain R whose ﬁeld of fractions is
F, and the kernel is a prime ideal I such that R ∼= k[X1, . . . , Xn]/I. Theorem
7.22 tells us that R has Krull dimension 1.
We are led to the following deﬁnition. For any ﬁeld k and any integer n ≥1,
an ideal I in k[X1, . . . , Xn] is called an afﬁne curve irreducible3 over k if I is
prime and the integral domain R = k[X1, . . . , Xn]/I has Krull dimension 1. An
afﬁne plane curve ( f (X, Y)) in the sense of Chapter VIII will be an object of this
kind if f (X, Y) is an irreducible polynomial.4
The geometry of the zero loci of the curves we study will not play a role in the
mathematics of this chapter; only the ﬁeld of fractions F and the base ﬁeld k will.
We postpone to Chapter X any discussion of the geometry.5 For any function
ﬁeld F in one variable over an arbitrary ﬁeld k, we shall study in detail those
discrete valuations of F that are 0 on k. We refer to such discrete valuations as
the discrete valuations of F deﬁned over k. It will be helpful as motivation to
remember for the special case in which k is algebraically closed
• that the members of F may be viewed as all rational functions on the zero
locus of an afﬁne curve irreducible over k,
• that the order-of-a-zero function at any nonsingular point of this zero
locus gives an example of a discrete valuation of F deﬁned over k, and
• that all discrete valuations of F deﬁned over k arise in this way if the
zero locus is nonsingular at every point and we take into account points
at inﬁnity in projective space.
However, the formal development will not make use of these interpretations.
3Beware of assuming too much irreducibility about such a curve. Just because I is prime does
not mean that I remains prime when we extend the scalars and work with an algebraic closure kalg
of k. For example, X2 + Y 2 is an afﬁne curve irreducible over R, but it factors as (X + iY)(X −iY)
over C and is therefore not irreducible over C.
4This change of context for the word “curve” from the deﬁnition in Chapter VIII is appropriate
because of a change of emphasis: we shall now be studying an associated function ﬁeld rather than the
deﬁning ideal. The word “curve” will undergo a genuine change in meaning in Chapter X: because
of the Nullstellensatz, classical algebraic geometry in the form to be discussed in much of Chapter X
places emphasis on zero loci deﬁned by prime ideals of polynomials over an algebraically closed
ﬁeld, and it will be convenient to deﬁne the curve to be the zero locus rather than the deﬁning ideal.
5In Chapter X we shall introduce two distinct notions of sameness for the zero loci under the
assumption that the ﬁeld is algebraically closed, namely “isomorphism” and “birational equivalence.”
The ﬁrst is a reﬁnement of the second. Birational equivalence will turn out to mean that the function
ﬁelds are isomorphic. An important theorem says that each birational equivalence class of irreducible
curves contains one and only one isomorphism class of curves that are everywhere nonsingular in
the sense of Section VII.5.

530
IX. The Number Theory of Algebraic Curves
What to expect from the study. When k is not necessarily algebraically closed,
these interpretations break down, at least to some extent. Yet the main theorem of
the chapter, the Riemann–Roch Theorem, is still geared to the geometric interpre-
tation of discrete valuations in terms of poles and zeros. One may reasonably ask
why one goes to the trouble of working in such a general context that the theory no
longer has its geometric interpretation. The answer is that the investigation is to
be regarded as one in number theory, not in geometry. For example, studying an
afﬁne plane curve over a ﬁeld Fp is the same as studying solutions of congruences
in two variables modulo a prime. Studying such a curve over the p-adic ﬁeld Qp
is the same as studying solutions of such congruences modulo arbitrary powers
of p. The Riemann–Roch Theorem is actually the ﬁrst serious aid in making this
study. The present chapter therefore does not constitute such a study; it merely
prepares one for such a study. In addition, there is a side beneﬁt to understanding
the number theory that arises this way: the methods and results of this subject
and of algebraic number theory have enough in common that the methods and
results for each suggest methods and results for the other.
An especially tantalizing example of this phenomenon concerns zeta functions.
The zeros with 0 < Re s ≤1 for the Riemann zeta function, which is the
meromorphic continuation to C of ζ(s) = 	∞
n=1 n−s = 
p prime (1 −p−s)−1,
inﬂuence the error term in the distribution of the primes as asserted by the Prime
Number Theorem. The classical Riemann hypothesis is the statement that the
only such zeros occur on the line Re s = 1
2; it implies a high level of control of
this error term. There is a corresponding zeta function for any algebraic number
ﬁeld, and to it corresponds a version of the Riemann hypothesis appropriate for
prime ideals for the number ﬁeld. Proofs or counterexamples for these versions
of the Riemann hypothesis have been sought for more than a century.
Meanwhile, one can formulate a Riemann hypothesis for any function ﬁeld
in one variable over any ﬁnite ﬁeld, and again the statement has consequences
for the distribution of prime ideals. This time, however, the Riemann hypothesis
is a theorem, stated and proved by A. Weil in 1940. One might hope that the
methodsusedforWeil’stheoremcouldshedenoughlightontheclassicalRiemann
hypothesis to lead to a proof, but to date this has not happened.
Key observation to be used during the study. In the next section we shall
make systematic use of the following construction for any function ﬁeld F in
one variable over the ﬁeld k. If x is any element of F transcendental over k,
then the only discrete valuations of F deﬁned over k that take a nonzero value
on x may be described as follows. Let R be the integral closure of k[x] in F,
and let R′ be the integral closure of k[x−1] in F. Then R and R′ are Dedekind
domains by Corollary 7.14, whether or not F is a separable extension of k(x).
Both have F as ﬁeld of fractions. Let the ideals x R of R and x−1R′ of R′ have

2. Divisors
531
prime decompositions x R = Pe1
1 · · · P
eg
g
and x−1R′ = Q
e′
1
1 · · · Q
e′
g′
g′ . Then the
valuations vPi for 1 ≤i ≤g and vQj for 1 ≤j ≤g′ deﬁned by Pi and Qj have
vPi(x) = ei and vQj(x) = −e′
j, and no other discrete valuation of F that is deﬁned
over k takes a nonzero value on x. This observation follows from Corollary 6.10
and the deﬁnition of the discrete valuation associated with a nonzero prime ideal
in a Dedekind domain.
2. Divisors
Let k be a ﬁeld, and let F be a function ﬁeld in one variable over k. The ﬁrst step
is one of normalization: there is no loss of generality in replacing k by the larger
ﬁeld k′ of all elements F that are algebraic over k.6
Proposition 9.1. Let F be a function ﬁeld in one variable over k, and let k′ be
the subﬁeld of all elements in F algebraic over k. If x is in F×, then every discrete
valuation of F deﬁned over k vanishes on x if and only if x is in k′. Consequently
F is automatically a function ﬁeld in one variable over k′, and as such, its discrete
valuations deﬁned over k′ coincide with its discrete valuations deﬁned over k.
PROOF. If x ∈F is transcendental over k, then the observation at the end
of Section 1 produces discrete valuations of F deﬁned over k that take nonzero
values on x. Conversely if x ∈F× is algebraic over k, we argue by contradiction.
We may assume that x ̸= 0. Suppose that v is a discrete valuation of F deﬁned
over k such that v(x) ̸= 0. Possibly replacing x by x−1, we may assume that
v(x) > 0. Being nonzero algebraic over k, x satisﬁes a polynomial equation
amxm + am−1xm−1 + · · · + a1x + a0 = 0
with all aj ∈k and with a0 ̸= 0. For each j with aj ̸= 0, we have v(ajx j) =
v(aj) + jv(x) = jv(x) > 0.
If aj = 0, then v(ajx j) = ∞> 0.
Thus
v(amxm +am−1xm−1 +· · ·+a1x) > 0. Since v(a0) = 0, property (vi) of discrete
valuations in Section VI.2 shows that
v

(amxm + am−1xm−1 + · · · + a1x) + a0

= v(a0) = 0 ̸= ∞= v(0),
contradiction.
The conclusions in the last sentence of the proposition now follow: Since F
is generated over F by ﬁnitely many elements x1, . . . , xn, it is generated over
k′ by the same elements. Moreover, any element of F transcendental over k is
transcendental over k′, since k′ is algebraic over k. Thus F is a function ﬁeld in
one variable over k′. The ﬁrst paragraph of the proof shows that every discrete
valuation of F deﬁned over k is deﬁned over k′, and the converse statement is
immediate from the deﬁnition.
□
6The ﬁeld k′ is called the ﬁeld of constants by some authors.

532
IX. The Number Theory of Algebraic Curves
In accordance with Proposition 9.1, there is no loss of generality in replacing
k by k′ throughout. Changing notation, we assume henceforth that F is a function
ﬁeld in one variable deﬁned over k and that every element of F not in k is
transcendental over k. These hypotheses will not be repeated for each result.
Suppressing k in the notation, we denote by VF the set of all discrete valuations
of F deﬁned over k. A divisor is any member of the free abelian group DF on
VF. Elements of DF will be written additively,7 and thus a typical member of DF
is
A =

v∈VF
nvv
with only ﬁnitely many of the integers nv nonzero. We write ordv A for the integer
nv, calling it the order of A at v. The identity element of DF is called zero and
is denoted by 0.
Each x in F× deﬁnes a principal divisor (x) by the formula
(x) =

v∈VF
v(x)v.
We verify that (x) is indeed a divisor by showing that v(x) is nonzero for only
ﬁnitely many v in VF. For x in k, v(x) = 0 for all v. All other x are transcendental
over k, and the observation at the end of Section 1 shows that exactly g + g′
members of VF are nonzero on x, where g and g′ are certain positive integers
depending on x.
It is sometimes convenient to decompose (x) as a particular difference of two
divisors, writing (x) = (x)0 −(x)∞with
(x)0 =

v∈VF,
v(x)>0
v(x)v
and
(x)∞=

v∈VF,
v(x)<0
(−v(x))v.
This notation is motivated by the interpretation of (x) for the case k = C, which
is discussed in an example below.
Because of the formula v(xy) = v(x) + v(y), the set of principal divisors is a
subgroup PF of DF, and the mapping x 	→(x) is a group homomorphism of F×
onto PF. The quotient CF = DF/PF is called the group of divisor classes of F
over k.
EXAMPLE. k = C. This is the setting of a compact Riemann surface, provided
we take for granted that every compact Riemann surface can be realized as a
nonsingularprojectivecurveoverC. TheﬁeldFistheﬁeldofglobalmeromorphic
7Some authors use a multiplicative notation.

2. Divisors
533
functions on the surface. A principal divisor can be viewed as a compilation of
the orders of the zeros and poles of a nonzero global meromorphic function: each
member of VF corresponds to a point of the surface, and the order of a principal
divisor (x) with x ∈F× at a point is positive if the meromorphic function x has
a zero at the point, negative if x has a pole there. It is known that the sum of the
orders of all the zeros of a nonzero global meromorphic function equals the sum
of the orders of all the poles. In the current framework the statement is that the
sum over v(x) is 0 for every x ∈F× when k = C.
Theorem 9.3 will generalize the fact about compact Riemann surfaces that
	
v∈VF v(x) = 0 for every x ∈F× when k = C. When C is replaced by a more
general ﬁeld that is not necessarily algebraically closed, Proposition 6.9 already
shows that the terms v(x) in the corresponding sum have to be weighted by certain
integers in order to yield sum 0. These integers are dimensions that are shown to
be ﬁnite in the next proposition.
Proposition 9.2. Let v be any discrete valuation of F deﬁned over k, let Rv be
the valuation ring, and let Pv be the valuation ideal. Then Rv and Pv are k vector
spaces, and dimk Rv/Pv is ﬁnite.
REMARKS. The integer fv = dimk Rv/Pv is called the residue class degree of
the valuation v. The proof gives a method for computing fv, and we shall make
use of this method shortly in proving Theorem 9.3.
PROOF.
The fact that Rv and Pv are k vector spaces is immediate from
Proposition 9.1. Since v is not identically zero, there exists some x ∈F with
v(x) ̸= 0, and x is transcendental by Proposition 9.1. Possibly replacing x by
x−1, we may assume that v(x) > 0. The observation at the end of Section 1
classiﬁes those members of VF taking positive values on x. In that notation we
decompose (x)R as Pe1
1 · · · P
eg
g , and v is the valuation deﬁned by Pj for some j.
Theorem 6.5e shows that Rv/Pv ∼= R/Pj. Since x is prime in k[x], the general
theory of extensions of Dedekind domains shows that Pj ∩k[x] = xk[x] and that
fj = dimk[x]/(x)(R/Pj) is ﬁnite. The ﬁeld k[x]/(x) is isomorphic to k, and thus
the dimension over k of Rv/Pv ∼= R/Pj is fj.
□
The degree of a divisor A is the integer deg A = 	
v∈VF fv ordv(A), where
fv is the residue class degree of v as deﬁned in the remarks with Proposition
9.2. Degree is a homomorphism of DF into Z. We shall prove in Theorem
9.3 that principal divisors have degree 0. This result extends Proposition 6.9,
which handles the special case of the function ﬁeld k(x). Theorem 9.3 may be
regarded as a function-ﬁeld analog of the Artin product formula (Theorem 6.51)
for number ﬁelds, but the proof is much easier for function ﬁelds because we can
take advantage of the observation at the end of Section 1.

534
IX. The Number Theory of Algebraic Curves
Theorem 9.3. The degree of every principal divisor is 0. In more detail, if (x)
is a principal divisor with x not in k, then deg(x)0 = deg(x)∞= dimk(x) F, and
hence deg(x) = deg(x)0 −deg(x)∞= 0.
PROOF. If x is in k×, then Proposition 9.1 shows that v(x) = 0 for every
v ∈VF, and hence deg(x) = 0. Thus we may assume that x is transcendental
over k. Applying the observation at the end of Section 1 and using the notation
from there, we know that the only v’s for which v(x) ̸= 0 are the ones relative to
the prime ideals Pi of R and the prime ideals Qj of R′ such that
x R = Pe1
1 · · · P
eg
g
and
x−1R′ = Q
e′
1
1 · · · Q
e′
g′
g .
(∗)
Moreover, vPi(x) = ei and vQj(x) = −e′
j. In addition, the proof of Proposition
9.2 showed that the respective residue class degrees are the usual indices fi and
f ′
j associated to the decompositions (∗). Thus
deg(x)0 =
g	
i=1
fiei
and
deg(x)∞=
g′	
j=1
f ′
j e′
j.
Two applications of Theorem 9.60 of Basic Algebra show that
g	
i=1
fiei = dimk(x) F
and
g′	
j=1
f ′
j e′
j = dimk(x−1) F.
Thus deg(x)0 = dimk(x) F, and deg(x)∞= dimk(x−1) F. The theorem therefore
follows from the fact that k(x) = k(x−1).
□
Let DF,0 be the subgroup of all divisors of degree 0. Theorem 9.3 shows
that PF ⊆DF,0.
The quotient CF,0 = DF,0/PF is therefore a subgroup of
CF = DF/PF and is the group of all divisor classes of degree 0.
This is a
function-ﬁeld analog of the class group for an algebraic number ﬁeld; it can be
shown to be ﬁnite if k is a ﬁnite ﬁeld but it not if k is an arbitrary ﬁeld.
3. Genus
In this section, F denotes a function ﬁeld in one variable over a ﬁeld k, and we
assume that every element of F outside k is transcendental over k. We continue
with the notationVF, DF, fv, ordv A, deg A, and (x) for x ∈F×, all as in Section 2.
If we were studying only what happens with k = C, we would be interested
in the vector space of all meromorphic functions whose poles are limited to a
certain ﬁnite set of points and are limited to some particular order at each of those

3. Genus
535
points. The underlying compact Riemann surface is an ordinary closed orientable
2-dimensional manifold, and the dimensions of these spaces of meromorphic
functions turn out to control the genus of this manifold. For general k, we study
the natural generalization of this situation.8 The vector spaces of interest are
deﬁned in terms of divisors, and we will be led to a natural deﬁnition of genus of
the curve under study.
We introduce a partial ordering on DF by saying that two divisors A and B
have A ≤B if ordv A ≤ordv B for all v ∈VF. The inequality B ≥A is to
mean the same thing as A ≤B. If A ≤B and A′ ≤B′, then A + A′ ≤B + B′
because ordv(A + A′) = ordv A + ordv A′ ≤ordv B + ordv B′ = ordv(B + B′).
If A ≤B, then −A ≥−B.
For each divisor A, we shall study the k vector space
L(A) = {0} ∪

x ∈F× | (x) ≥−A

=

x ∈F | v(x) ≥−ordv A

.
For x ̸= 0, we can think of v(x) as telling the order of the zero of x at a point
corresponding to v. In that spirit, if A ≥0, then L(A) consists of all functions
whose poles are limited to the set of v’s for which ordv A ̸= 0, with the order of the
pole bounded above by the number ordv A. For general A, a similar interpretation
is valid, except that the members of L(A) are required also to vanish at certain
points at least to certain orders.
We shall suppress any name for the function that embeds VF in DF. Thus
for example if v0 is in VF, then L(v0) refers to L(A) for the divisor A such that
ordv0 A = 1 and ordv A = 0 when v ̸= v0.
Corollary 9.4. L(0) = k, and L(A) = 0 if A is a nonzero divisor with A ≤0.
PROOF. If A ≤0 is nontrivial and if x ∈F× were to have (x) ≥−A, then we
would have deg(x) ≥−deg A > 0, in contradiction to the conclusion deg(x) = 0
of Theorem 9.3. Thus L(A) = 0. Next, we have
L(0) =

x ∈F× | v(x) = 0 for all x

∪
v∈VF
L(−v).
The ﬁrst term on the right side is k×, and the second term gives 0 by what we
have just proved. Hence L(0) = k.
□
If A ≤B, then it follows from the deﬁnition that L(A) ⊆L(B). We shall
be interested in how much L(B) increases when B increases. This change is
measured by what happens to the quotient space L(B)/L(A). The key case is
that B = A + v0 for some v0 ∈VF, and we treat that in the following lemma.
8In doing so, we follow the approach in the book by Villa Salvador, Chapter 3, but with different
notation.

536
IX. The Number Theory of Algebraic Curves
Lemma 9.5. If A is a divisor and v0 is in VF, then
dimk L(A + v0)/L(A) ≤fv0 = deg v0.
PROOF. Put f = fv0, let Rv0 be the valuation ring of v0, and let Pv0 be the
valuation ideal of v0. Since v0 carries F× onto Z, we can choose an element
y ∈F× with v0(y) = ordv0(A + v0).
Let f + 1 members x1, . . . , xf +1 of L(A + v0) be given. We shall produce an
equation of linear dependence among the cosets xi + L(A), and this will prove
the lemma. Computation gives
v0(xi y) = v0(xi) + v0(y) = v0(xi) + ordv0(A + v0) ≥0
for 1 ≤i ≤f + 1, since xi is in L(A + v0). Hence xi y is in Rv0. Since
dimk(Rv0/Pv0) = f , there exist members c1, . . . , cf +1 of k not all 0 such that
	 f +1
i=1 ci(xi y+Pv0) = Pv0, i.e., such that 	 f +1
i=1 cixi y lies in Pv0. Then 	 f +1
i=1 cixi
lies in y−1Pv0, and
v0
 f +1
	
i=1
cixi

≥−v0(y) + 1 = −ordv0(A + v0) + 1 = −ordv0 A.
(∗)
Since each xi is in L(A + v0), so is 	 f +1
i=1 cixi. This fact and (∗) together show
that 	 f +1
i=1 cixi is in L(A), i.e., that 	 f +1
i=1 cixi + L(A) is the 0 coset. This proves
the desired linear dependence and shows that dimk L(A + v0)/L(A) ≤f .
□
Theorem 9.6. If A and B are divisors such that A ≤B, then L(B)/L(A) is
ﬁnite-dimensional over k with
dimk L(B)/L(A) ≤deg B −deg A.
Moreover, L(A) and L(B) are separately ﬁnite-dimensional over k, and conse-
quently
dimk L(B) −deg B ≤dimk L(A) −deg A.
REMARKS. We deﬁne ℓ(A) = dimk L(A). This is ﬁnite by the theorem, and
the resulting inequality of the theorem is that
ℓ(B) −deg B ≤ℓ(A) −deg A.
PROOF.
The ﬁrst conclusion is immediate from Lemma 9.5 by induction
on 	
v (ordv B −ordv A). Fixing a reference point v0 in VF and taking A =

3. Genus
537
	
ordv B≤0(ordv B)v −v0 and applying Corollary 9.4 to A, we see that L(A) = 0.
Therefore the ﬁrst conclusion specializes to
dimk L(B) −deg B ≤−deg A.
Since dimk L(B) is certainly nonnegative, this inequality implies that L(B) is
ﬁnite-dimensional. Then we can expand the left side of the ﬁrst conclusion of the
theorem to obtain
dimk L(B) −dimk L(A) = deg B −deg A,
and the proof is complete.
□
The theorem identiﬁesℓ(B)−deg B as a quantity of interest when we are trying
to understand a divisor B. We shall undertake a study of this quantity, beginning
ﬁrst with the case of a divisor B equal to a multiple of the pole part (x)∞of a
principal divisor (x). Recall that the signs are arranged to have (x)∞≥0.
Lemma 9.7. For each x in F that is not in k, there exists a constant Cx such
that the multiple p(x)∞of (x)∞satisﬁes
ℓ

p(x)∞

−deg

p(x)∞

≥Cx
for every integer p.
PROOF. Applying the observation at the end of Section 1, we form the integral
closure R of k[x] in F and the integral closure R′ of k[x−1] in F. The discrete
valuations v for which v(x) < 0 are exactly those arising from prime ideals in
the prime decomposition of x−1k[x−1], according to Corollary 6.10. Speciﬁ-
cally the ideal x−1k[x−1] in R′ decomposes as a product Q
e′
1
1 · · · Q
e′
g′
g′ , and the
corresponding discrete valuations have vQk(x−1) = e′
k. Theorem 9.3 shows that
deg(x)∞= dimk(x) F.
Let n = dimk(x) F. Choose a basis y1, . . . , yn of F over k(x) consisting of
members of R.
Each v arising from a prime ideal of R has v(yj) ≥0 for
1 ≤j ≤n by Proposition 6.7. The remaining v’s all have v(x) < 0, and
therefore there exists an integer k ≥0 such that v(yj) ≥kv(x) for 1 ≤j ≤n and
for all these remaining v’s. For this value of the integer k, the elements y1, . . . , yn
all lie in L(k(x)∞).
Let m ≥0 be arbitrary. The v’s coming from some Qk, i.e., those with
v(x) < 0, have v(xi) ≥v(xm) whenever 0 ≤i ≤m, and the remaining v’s,
i.e., those with v(x) ≥0, all have v(xi) ≥0 for 0 ≤i ≤m.
Therefore
1, x, x2, . . . , xm all lie in L((xm)∞) = L(m(x)∞).

538
IX. The Number Theory of Algebraic Curves
Multiplying, we see that xi yj lies in L

(k + m)(x)∞

for 0 ≤i ≤m and
1 ≤j ≤n. These elements xi yj are linearly independent over k, and therefore
ℓ

(k + m)(x)∞

≥(m + 1)n = (m + 1) deg(x)∞.
Since deg is a homomorphism from DF into Z,
deg

(k + m)(x)∞

= (k + m) deg(x)∞.
Therefore each m ≥0 has
ℓ

(k + m)(x)∞

−deg

(k + m)(x)∞

≥(m + 1 −k −m) deg(x)∞
= (1 −k) deg(x)∞.
We have therefore proved that
ℓ(q(x)∞) −deg(q(x)∞) ≥(1 −k) deg(x)∞
for all integers q that are sufﬁciently positive. If p is any integer, we can ﬁnd q
as above with p ≤q. Then p(x)∞≤q(x)∞, and Theorem 9.6 shows that
(1 −k) deg(x)∞≤ℓ(q(x)∞) −deg(q(x)∞) ≤ℓ(p(x)∞) −deg(p(x)∞).
This proves the lemma with Cx = (1 −k) deg(x)∞.
□
Lemma 9.8. If A is any divisor and x is any member of F×, then L((x)+ A) ∼=
L(A) canonically. Therefore ℓ((x) + A) = ℓ(A). In addition, deg((x) + A) =
deg A.
PROOF. Deﬁne a k linear mapping ϕ : L(A) →F by ϕ(y) = x−1y. This is
certainly one-one, and its image is contained in L((x)+ A) because any nonzero z
in L(A) has (z) ≥−A and then also (x−1z) = −(x)+(z) ≥−(x)−A. Similarly
ψ(y) = xy is one-one and carries L((x)+ A) into L(A). By inspection, ψϕ = 1
and ϕψ = 1.
Therefore L((x) + A) and L(A) are canonically isomorphic
and have the same dimension over k. For the last conclusion, deg((x) + A) =
deg(x) + deg A = deg A by Theorem 9.3.
□
Theorem 9.9 (Riemann’s inequality). For each x in F that is not in k, let gx
be the integer such that 1 −gx is the largest possible Cx with
ℓ

p(x)∞

−deg

p(x)∞

≥Cx
for every integer p. Then
(a) the integer g = gx is independent of x,
(b) g is ≥0,
(c) ℓ(A) −deg A ≥1 −g for every divisor A.

3. Genus
539
REMARKS. The integer gx in the theorem exists by Lemma 9.7. Once it has
been proved to be an integer g independent of x, it is called the genus of the
function ﬁeld F over k.
PROOF. We begin by proving (c) with g replaced by gx. Let Cx be any integer
with the property that ℓ(p(x)∞) −deg(p(x)∞) ≥Cx for all p. If a divisor A
is given, we can write A = A0 −A∞, where A0 = 	
ordv A>0 (ordv A)v and
A∞= 	
ordv A<0 (−ordv A)v. Then A ≤A0, and Theorem 9.6 shows that
ℓ(A) −deg A ≥ℓ(A0) −deg A0. Thus it is enough to prove (c) for A0. Let p be
any integer ≥0. Since A0 ≥0, we have p(x)∞−A0 ≤p(x)∞. Hence a second
application of Theorem 9.6 shows that
ℓ

p(x)∞−A0

−deg

p(x)∞−A0

≥ℓ

p(x)∞

−deg

p(x)∞

≥Cx.
Since deg is a homomorphism, this inequality implies that
ℓ

p(x)∞−A0

≥Cx + p deg(x)∞−deg A0.
Fix an integer p large enough for the right side to be positive. For this p, the
vector space L(p(x)∞−A0) is nonzero; let y be a nonzero member of it. This
y has (y) ≥−(p(x)∞−A0), and hence p(x)∞≥A0 −(y). A third application
of Theorem 9.6, in combination with Lemma 9.8, shows that
ℓ

p(x)∞

−deg

p(x)∞

≤ℓ(A0 −(y)) −deg(A0 −(y))
= ℓ(A0) −deg A0.
The left side is ≥Cx, and hence ℓ(A0) −deg A0 ≥Cx. Therefore
ℓ(A) −deg A ≥Cx
(∗)
for every divisor A. Since one choice of Cx is 1 −gx, this proves (c).
Taking A = p(y)∞, we see that the best Cy has Cy ≥Cx. Since the roles of
x and y can be interchanged, this proves (a). Finally if we take A = 0 in (c) and
apply Corollary 9.4, we see that 1 −0 ≥1 −g. Thus g ≥0. This proves (b). □
EXAMPLES OF GENUS.
(1) F = k(x) for a transcendental x. In the proof of Lemma 9.7, we have
n = 1 and can take y1 = 1. Then k = 0, and the proof of the lemma shows that
the inequality of the lemma holds with Cx = (1 −0) deg(x)∞= 1. Therefore
1 −g ≥Cx = 1, and g ≤0. So g = 0 by Theorem 9.9b.

540
IX. The Number Theory of Algebraic Curves
(2) F = C[x, y]/(y2 −x4 + 1). This example was discussed in Section 1, and
we have x−1R′ = P1P2 with P1 = (x−1, x−2y + 1) and P2 = (x−1, x−2y −1).
ThecorrespondingvaluationsthereforehavevP1(x) = vP2(x) = −1. Meanwhile,
the elements 1 and y form a basis of F over k(x). The element 1 has vP1(1) =
vP2(1) = 0; so 1 is in L(p(x)∞) for every p ≥0. Since x−2y is the sum of a
generator of P1 and a generator of P2, x−2y lies in R′. Write (x−2y) = I1 · · · Il,
where each Ij is a prime ideal in R′. Since x−2y and P1 together generate 1,
P1 is not one of the ideals Ij. Similarly P2 is not one of the Ij’s. Thus (y) =
(x−1)−2(x−2y) = (P1P2)−2I1 · · · Il, and we obtain vP1(y) = vP2(y) = −2.
Hence y lies in L(2(x)∞), and we can take k = 2 in the proof of Lemma 9.7. For
this k, we have Cx = (1 −2) deg(x)∞= −2. Therefore 1 −g ≥Cx = −2, and
g ≤3. In fact, g = 1 here, as a special case of the next example. Thus a routine
use of the estimate from Lemma 9.7 has its limitations.
(3) F = k[x, y]/(y2−p(x)), where p(x) is a square-free polynomial of degree
m and k has characteristic ̸= 2. Then g = 1
2m −1 if m is even and g = 1
2(m −1)
if m is odd. This computation will be carried out in Problems 12–20 at the end
of the chapter.
Theorem 9.9 gives the lower bound of 1 −g for ℓ(A) −deg A for all divisors
A. There is also an upper bound, with the proviso that L(A) ̸= 0.
Proposition 9.10. If A is any divisor such that L(A) ̸= 0, then
ℓ(A) −deg A ≤1.
Hence any divisor A with deg A ≤−1 has ℓ(A) = 0.
PROOF. Let y be a member of F× that lies in L(A). Then every v ∈VF has
v(y) ≥−ordv A and hence 0 ≥−ordv A −v(y) = −ordv(A + (y)). This
inequality says that A + (y) ≥0. Then Corollary 9.4 and Theorem 9.6 together
give
1 = ℓ(0) −deg 0 ≥ℓ(A + (y)) −deg(A + (y)),
and the right side equals ℓ(A) −deg A by Lemma 9.8.
Then 1 −deg A ≤
ℓ(A) −deg A ≤1, and we must have deg A ≥0 whenever ℓ(A) ≥1.
□
4. Riemann–Roch Theorem
Riemann’s inequality, proved in Section 3, shows that every divisor A satisﬁes
ℓ(A)−deg A ≥1−g, where g isthegenusofthecurveinquestion. TheRiemann–
Roch Theorem, to be proved in the present section, gives an interpretation for the
difference between the two sides of the inequality.

4. Riemann–Roch Theorem
541
In the classical setting of compact Riemann surfaces, the proof of the Riemann–
Roch Theorem makes use of meromorphic differential forms, sometimes called
abelian differentials by complex analysts. Meromorphic differential forms are
objects that locally look like f (z) dz, where z is a local coordinate and f (z)
is a meromorphic function, and that ﬁt together to be globally deﬁned on the
complex manifold. What the formula f (z) dz = g(w) dw for ﬁtting together
means that in the overlap of the regions for two local coordinates z and w,
f (z) dz = g(w(z)) dw
dz dz holds and hence f (z) = g(w(z)) dw
dz . In the language
of differential geometry, a meromorphic differential form is a meromorphic sec-
tion of the cotangent bundle of the complex manifold. An important step that
has to be carried out to make these differential forms useful is to prove a version
of the Residue Theorem. This theorem says that the sum over all points of the
manifold of the residues of the differential form is 0, the residue of f (z) dz at
the point corresponding to z = 0 being the coefﬁcient of z−1 in the Laurent
expansion9 of f (z) about 0. Once this theorem is in hand, one can begin to prove
the Riemann–Roch Theorem.
In our present setting with the function ﬁeld F in one variable over k, it is not
too hard to deﬁne an analog of meromorphic differential forms and to establish
that they behave the way one would expect from differential calculus. In order
to make use of these forms, one has to prove an analog of the Residue Theorem,
and doing so requires some hard work. A. Weil discovered that this construction
could be bypassed and that one could prove the theorem directly. The idea is to
introduce the tool that differential forms make available and to skip the differential
forms themselves.
It is worth understanding this background in a little more detail because oth-
erwise the proof below may seem very strange indeed. To ﬁx the ideas for this
background only, suppose that the base ﬁeld k is algebraically closed. Let us
recall that elements of VF are meant to correspond to points of a zero locus in
projective space, at least when the curve is everywhere nonsingular. We write
this correspondence as v 	→p(v). A local coordinate about p(v) is denoted
by a symbol like z classically, and in the setup with valuations, it is simply a
member of the valuation ideal of v with v(z) = 1. A differential form that is
given locally by classical expressions like f (z) dz attaches to each v in VF the
function gv 	→Residuep(v)(gv f dz), where gv is any Laurent expansion about
p(v).
Classically this Laurent expansion is to be convergent in some deleted neigh-
borhood of p(v), and it involves only ﬁnitely many negative powers of the
local coordinate.
The assumption that it converges is not important because
if v( f ) = n, then the only powers of z whose coefﬁcients in gv affect the residue
at p(v) are the kth powers for k + n ≤−1. Thus the assumption on gv is that it is
9One has to show that this coefﬁcient is independent of the choice of the local coordinate.

542
IX. The Number Theory of Algebraic Curves
a member of the Laurent series ﬁeld k((z)). To compute the residue for gv f dz,
we need to know how to interpret f (z) as a Laurent series about p(v). Let Rv
be the valuation ring of v, and let Pv be the valuation ideal. The ﬁeld Rv/Pv is
a ﬁnite extension of k and must be isomorphic to k because k is algebraically
closed. For each c ∈k, choose a member ac ∈Rv such that the coset a + Pv
corresponds to c; we may assume that a0 = 0. Denote the set of these elements
ac by Rk. If v( f ) = n, then h = z−n f is in Rv, and thus some unique a0 in
Rk has the property that h −a0 is in Pv. Hence z−1(h −a0) is in Rv, and some
unique a1 in Rk has the property that z−1(h −a0) −a1 is in Pv. From this,
z−1(z−1(h −a0) −a1) is in Rv, and we can continue to subtract members of
Rk and divide by z in this way. The result is that h = a0 + a1z + a2z2 + · · ·
in the sense that v(h −a0 −a1z −· · · −akzk) ≥k + 1 for every k. Therefore
f = znh = zn(a0+a1z+a2z2+· · · ). If we replace each ak by the corresponding
member ck of k, then zn(c0 + c1z + c2z2 + · · · ) is the member of k((z)) that we
associate to f .
With this identiﬁcation in place, we can regard the given differential form as
yielding a k linear function
Residue :

v∈VF
k((z)) →

v∈VF
k.
We want to cut down the domain of this mapping so the sum of the residues is
meaningful for every member of the image. The local expressions f (z) dz involve
only ﬁnitely many polesin a neighborhood of each point, and compactness implies
that there are only ﬁnitely many such points globally. Except at these points the
residue of gv f dz can be nonzero only if gv has a pole at p(v). Thus we can
ensure that the sum of the residues is meaningful if we assume that v(gv) ≥0
except for ﬁnitely many v.
For algebraic purposes the domain is still unnecessarily large. Since each
local coordinate in the algebraic realization is actually a member of F, the only
members of k((z)) that we need to handle at each point are the members of F.
So let A∗
F = 
v∈VF F, and let AF be the k subspace of all members {gv} of the
product such that v(gv) < 0 only ﬁnitely often. Then the differential form gives
us a k linear functional
Sum of Residues : AF →k.
We have seen that if the differential form is given by f (z) dz locally near p(v) and
if v(gv) ≥−v( f ), then the residue is 0 at p(v). Hence there is some divisor A,
depending on the differential form, such that if v(gv) ≥−ordv A for all v ∈VF,
then all residues are 0 and the sum of the residues is 0. Consequently the kernel
of the sum-of-residues map associated to the differential form contains all tuples
{gv} of AF such that v(gv) ≥−ordv A for this divisor A and all v.

543
Finally there is one more classical fact to bring into play. This is the Residue
Theorem itself, saying that the sum of the residues is zero for any meromorphic
differential form. If {gv} is actually a constant tuple with gv = h for some h ∈F,
then the sum-of-residues map as deﬁned above is giving us the classical sum of
residues for the product of h and the given differential form. This sum is zero. In
other words, every member of the diagonally embedded F in AF lies in the kernel
of the sum-of-residues map associated to the differential form.
Weil’sideainanutshellisthatinsteadofdevelopingdifferentialforms, working
with residues, and proving the consequence of the Residue Theorem, one should
just start with any abstract linear functional on AF that satisﬁes the conditions
that we noted above. Then the Riemann–Roch Theorem drops out fairly easily.
This is the approach we shall follow. The abstract kind of linear functional on
AF will be called a “differential” in what follows, as a reminder of the classical
object that lies behind it.10
Without further ado, we proceed with the Riemann–Roch Theorem. In this
section, F denotes a function ﬁeld in one variable over a ﬁeld k, and we assume
that every element of F outside k is transcendental over k. We continue with the
notation VF, DF, fv, ordv A, deg A, and (x) for x ∈F×, all as in Sections 2–3,
and with the notation L(A) and ℓ(A) as in Section 3. If A is a divisor, we let
δ(A) = ℓ(A) −deg A −(1 −g).
Riemann’s inequality (Theorem 9.9) implies that δ(A) ≥0 for all A’s and that
δ(A) = 0 for some A’s. We seek an interpretation of δ(A).
Let A∗
F be the ring of all functions from VF into F, with the operations taken
pointwise. It is customary to write such a function ξ as v 	→ξv rather than as
v 	→ξ(v). Let AF be the subring11 of all members ξ of A∗
F such that v(ξv) < 0
for only ﬁnitely many v in VF. We shall treat AF as an inﬁnite-dimensional
associative k algebra with identity.
Consider the diagonal map  : F →AF deﬁned by the formula (x)v = x for
all x ∈F. Under this map, the member x of F goes to the function whose value
at each v is x. The reason that (x) is in AF and not just A∗
F is that v(x) < 0 for
only ﬁnitely many v ∈VF. The map  is a one-one k algebra homomorphism.
10Weil’s argument dates to 1935. It appears in book form in Weil’s Basic Number Theory, where
the details are carried out when k is a ﬁnite ﬁeld and where comments are made for general k. Lang
simpliﬁed Weil’s argument and wrote it down for algebraically closed ﬁelds k in his Introduction
to Algebraic and Abelian Functions. A version of this argument for general k appears in Villa
Salvador’s book. The present exposition beneﬁts from all three of these books.
11For readers familiar with Section VI.10, the notation is intended to hint at “adeles” of F.
However, completions and topologies will play no role in the construction.
4. Riemann–Roch Theorem

544
IX. The Number Theory of Algebraic Curves
For each divisor A, deﬁne
L(A) =

ξ ∈AF | v(ξv) ≥−ordv(A)

.
It is immediate from the deﬁnitions that
L(A) ∩(F) = (L(A)).
Let us see that
A ≤B
if and only if
L(A) ⊆L(B).
In fact, the “only if” part of the statement is evident. Conversely suppose that
L(A) ⊆L(B). Choose for each v ∈VF an element πv in F with v(πv) = 1. The
function ξA : VF →F deﬁned by (ξA)v = π−ordv A has v((ξA)v) = −ordv A
and lies in AF, since ordv A is nonzero for only ﬁnitely many v. The deﬁnitions
show that ξA lies in L(A), hence in L(B).
Thus −ordv(A) = v((ξA)v) ≥
−ordv B,
ordv A ≤ordv B, and A ≤B.
This proves the “if” part of the
displayed equivalence. If we apply the equivalence twice, we see that
A = B
if and only if
L(A) = L(B).
Let us take note of two operations on divisors A and the effect of these oper-
ations on the spaces L(A). If A and B are divisors, we deﬁne C = min(A, B)
pointwise by the formula ordv C = min(ordv A, ordv B). Then C is a divisor
with C ≤A and C ≤B. Thus L(C) ⊆L(A) and L(C) ⊆L(B), and we
consequently obtain
L(min(A, B)) ⊆L(A) ∩L(B).
Still with A and B as divisors, we deﬁne C = max(A, B) pointwise by the
formula ordv C = max(ordv A, ordv B). Then A ⊆C and B ⊆C, from which
we obtain L(A) ⊆L(C) and L(B) ⊆L(C). This proves the inclusion ⊆in the
identity
L(A) + L(B) = L(max(A, B)).
To prove ⊇, let ξ be in L(max(A, B)). We shall decompose ξ as a sum η + ζ in
L(A) + L(B) with one of ηv and ζv equal to 0 for each v. Let v be given. Since
ξ is in L(max(A, B)), v(ξv) ≥−ordv(max(A, B)) = −max(ordv A, ordv B).
That is, −v(ξv) ≤max(ordv A, ordv B). If −v(ξv) ≤ordv A, then deﬁne ηv = ξv
and ζv = 0; otherwise, we have −v(ξv) ≤ordv B, and we deﬁne ηv = 0 and
ζv = ξv. Then v(ηv) ≥−ordv A for all v, and v(ζv) ≥−ordv B for all v. This
proves ⊇in the displayed formula.

545
Lemma 9.11. If A and B are divisors with A ≤B, then
dimk

L(B)/L(A)

= deg B −deg A.
PROOF. Proceeding inductively, we see that it is enough to handle the case that
B = A + v0, where v0 is in VF. Thus we are to show that
dimk

L(A + v0)/L(A)

= fv0 = deg(v0).
(∗)
Put f = fv0, let Rv0 be the valuation ring of v0, and let Pv0 be the valuation ideal
of v0. To prove ≤in (∗), we argue as in the proof of Lemma 9.5. Since v0 carries
F× onto Z, we can choose an element y ∈F× with v0(y) = ordv0(A + v0).
Let f + 1 members ξ (1), . . . , ξ ( f +1) of L(A + v0) be given. We shall produce
an equation of linear dependence among the cosets ξ (i) + L(A), and this will
prove ≤in (∗). Computation gives
v0(ξ (i)
v0 y) = v0(ξ (i)
v0 ) + v0(y) = v0(ξ (i)
v0 ) + ordv0(A + v0) ≥0
for 1 ≤i ≤f + 1, with the inequality at the right holding because ξ (i) is
in L(A + v0). Hence ξ (i)
v0 y is in Rv0. Since dimk(Rv0/Pv0) = f , there exist
members c1, . . . , cf +1 of k not all 0 such that 	 f +1
i=1 ci(ξ (i)
v0 y + Pv0) = Pv0, i.e.,
such that 	 f +1
i=1 ciξ (i)
v0 y lies in Pv0. Then 	 f +1
i=1 ciξ (i)
v0 lies in y−1Pv0, and
v0
 f +1
	
i=1
ciξ (i)
v0

≥−v0(y) + 1 = −ordv0(A + v0) + 1 = −ordv0 A.
(∗∗)
Since each ξ (i) is in L(A + v0), so is 	 f +1
i=1 ciξ (i)
v0 . This fact and (∗∗) together
show that 	 f +1
i=1 ciξ (i)
v0 is in L(A), i.e., that 	 f +1
i=1 ciξ (i)+L(A) is the 0 coset. This
proves the desired linear dependence and shows that dimk L(A +v0)/L(A) ≤f .
To prove ≥in (∗), we shall produce f members ξ ( j) of L(A + v0) that are
linearly independent modulo L(A).
We begin by choosing η in L(A) with
v0(ηv0) = −ordv0 A. (For example take any member η′ of L(A), change η′
v0
to a new value on which v0 takes the value −ordv0 A, and leave η′ unchanged at
all other v.) Let x1, . . . , xf be a set of representatives in Rv0 of the f members of
a k basis of the quotient Rv0/Pv0, and let πv0 be a member of F with v0(πv0) = 1.
Deﬁne ξ ( j) for 1 ≤j ≤f by
ξ ( j)
v
=
 ηv
for v ̸= v0,
ηv0xjπ−1
v0
for v = v0.
For each j, we have
v0(ηv0xjπ−1) = v0(ηv0) + v(xj) −v0(πv0)
= −ordv0 A + v(xj) −1 ≥−ordv0 A −1,
4. Riemann–Roch Theorem

546
IX. The Number Theory of Algebraic Curves
and thus ξ ( j) is in L(A + v0). To prove the linear independence modulo L(A),
suppose that c1, . . . , cf are members of k such that 	 f
j=1 cjξ ( j) is in L(A). In
this case we have an inequality v0
 	 f
j=1 cjξ ( j)
≥−ordv0 A, which expands out
as
v0

f	
j=1
cjηv0xjπ−1
v0

≥v0(ηv0).
Sincev0(π−1
v0 ) = −1, subtraction ofv0(ηv0)from bothsidesyieldsv0
 	 f
j=1 cjxj

≥1. Therefore 	 f
j=1 cjxj lies in Pv0. By the assumed linear independence over
k of the xj’s modulo Pv0, all the cj’s are 0. Therefore the elements ξ ( j) are linearly
independent modulo L(A), and the proof of ≥in (∗) is complete.
□
Lemma 9.12. If A and B are divisors with A ≤B, then there is an exact
sequence in the category of k vector spaces given by
0 −−→L(B)/L(A)
ψ
−−→L(B)/L(A)
ϕ
−−→(L(B) + (F))

(L(A) + (F)) −−→0.
Consequently
dimk(L(B) + (F))

(L(A) + (F)) = (ℓ(A) −deg A) −(ℓ(B) −deg B)
= δ(A) −δ(B).
PROOF. The map ψ is induced by the map  : L(B) →L(B) followed by
passage to the quotient. It descends to L(B)/L(A) because (L(A)) ⊆L(A),
and it is one-one because (L(B)) ∩L(A) ⊆L(A). The map ϕ is induced
by the map x 	→x + (F) followed by passage to the quotient. It descends
to L(B)/L(A) because L(A) maps into L(A) + (F), and it is onto because
x 	→x + (F) carries L(B) onto L(B) + (F). The composition ϕψ is 0
because L(B) maps under  into (F), which lies in the 0 coset.
To prove the exactness, let ξ + L(A) be in ker ϕ. This condition means that ξ
is in L(B) and has ξ + (F) in L(A) + (F). Thus there exists η in L(A) with
ξ −η in (F). Since ξ and η are in L(B), ξ −η is in L(B) ∩(F) ⊆(L(B)).
Hence ξ + L(A) = (ξ −η) + L(A) lies in (L(B)) + L(A) = image ψ, and
exactness is proved.
From the exactness we obtain
dimk L(B)/L(A) = dimK L(B)/L(A) + dimk(L(B) + (F))

(L(A) + (F)).
The left side equals deg B −deg A by Lemma 9.11, and the ﬁrst term on the right
side equals ℓ(B) −ℓ(A) by the ﬁnite dimensionality of L(B) and L(A), which
was proved as part of Theorem 9.6. The result follows.
□

547
Theorem 9.13. There exists a divisor C such that AF = L(C) + (F). For
each divisor A,
δ(A) = dimk

AF

(L(A) + (F))

.
PROOF. Riemann’s inequality produces a divisor C, speciﬁcally any sufﬁ-
ciently large positive power of a divisor (x)∞, such that δ(C) = 0. If we can
show that AF = L(C) + (F), then the dimensional equality in Lemma 9.12
with B = C will complete the proof of the present theorem.
Suppose that there exists a member ξ of AF that is not in L(C) + (F). For
each v ∈VF, let av = min(v(ξv), −ordv C), and deﬁne C′ = −	
v∈VF avv.
Since ξ is in AF, only ﬁnitely many integers v(ξv) are negative. This fact and
the fact that C is a divisor together imply that only ﬁnitely many av are negative.
Since C is a divisor, only ﬁnitely many integers −ordv C can be positive, and
thus only ﬁnitely many av can be positive. Therefore C′ is a divisor.
The deﬁnition of C′ is arranged in such a way that C ≤C′. Also, every v has
v(ξv) ≥av = −ordv C′, and hence ξ lies in L(C′). Consequently
dimk(L(C′) + (F))

(L(C) + (F)) ≥1.
By Lemma 9.12, δ(C) −δ(C′) ≥1. Since C was assumed to have δ(C) = 0, we
obtain −δ(C′) ≥1, in contradiction to the fact that δ(A) ≥0 for every divisor
A. We conclude that every ξ in AF lies in L(C) + (F).
□
Theorem 9.13 gives a ﬁrst interpretation of the difference δ(A) between the
two sides of Riemann’s inequality (Theorem 9.9). We shall now apply Theorem
9.13 and reinterpret δ(A) as the dimension ℓ(B) of a suitable divisor B obtained
from A, and then we will have obtained the Riemann–Roch Theorem.
A differential of F is a k linear functional ω on AF with the property that ω
vanishes on L(A) for some divisor A and ω vanishes also on (F). The set of
all differentials of F will be denoted by Diff(F). Let us observe that Diff(F) is
a vector subspace of k linear functionals on AF. Scalar multiplication by k is
not an issue. To see that Diff(F) is closed under pointwise addition, let ω and
ω′ be differentials vanishing on L(A) and L(B), respectively. We have seen that
L(min(A, B)) ⊆L(A) ∩L(B). Thus ω + ω′ vanishes on L(min(A, B)). Since
ω + ω′ vanishes also on (F), ω + ω′ is a differential.
The k vector space of differentials vanishing onL(A)+(K) may be identiﬁed
with the vector space of k linear functionals on the quotient AF/(L(A) + (F)),
and the latter space is ﬁnite-dimensional of dimension δ(A) by Theorem 9.13.
Since a ﬁnite-dimensional vector space and its dual have the same dimension, the
k vector space of differentials vanishing on L(A)+(K) has k dimension δ(A).
In addition, Diff(F) carries a scalar multiplication by F that makes it into an
F vector space. What is required to verify this statement is a deﬁnition, and then
4. Riemann–Roch Theorem

548
IX. The Number Theory of Algebraic Curves
the veriﬁcation of the properties of an F vector space is routine. If y is in F and
ω is a differential, we deﬁne yω on AF by (yω)(ξ) = ω((y)ξ). The linear
functional yω vanishes on (F) because  is a homomorphism. It is enough to
check for y ̸= 0 that
if ω vanishes on L(A), then yω vanishes on L(A + (y)),
where (y) is the principal divisor corresponding to y. To prove this vanishing,
let ξ be in L(A + (y)). Then v(ξv) ≥−ordv(A + (y)) = −ordv A −ordv(y) =
−ordv A−v(y), whichimpliesthatv(ξvy) ≥−ordv A, whichimpliesthatξ(y)
lies in L(A), which implies that ω(ξ(y)) = 0, which implies that (yω)(ξ) = 0.
This proves the asserted vanishing, and it follows that Diff(F) carries a well-
deﬁned scalar multiplication by F.
Each set L(A), where A is a divisor, will be called a parallelotope of AF.
These sets are large subsets of AF, since dimk AF/(L(A) + (F)) is ﬁnite and
dimk AF/(F) is inﬁnite. We are going to associate a particular parallelotope
to each nonzero differential.
Since we have seen that distinct parallelotopes
correspond to distinct divisors, we shall obtain a way of associating a divisor to
each nonzero differential.
Corollary 9.14. If ω is a nonzero differential and L(A) is a parallelotope in
its kernel, then
ℓ(A) ≤δ(0)
and
deg A ≤δ(0) + g −1.
Consequently there exists a unique maximum parallelotope on which ω vanishes.
REMARKS. In view of the remarks before the corollary, we therefore obtain a
function ω 	→Div(ω) from the set Diff(F) −{0} of nonzero differentials into the
set DF of divisors.
PROOF. If we know that ℓ(A) ≤δ(0), then addition to this inequality of
Riemann’s inequality deg A −ℓ(A) ≤g −1 as given in Theorem 9.9 shows that
deg A ≤δ(0) + g −1
and proves the second inequality.
The inequality ℓ(A) ≤δ(0) is trivial if
L(A) = 0.
Therefore we may assume in the two inequalities that L(A) ̸= 0. Let y be
any nonzero member of L(A). Since the kernel of ω contains L(A), the kernel
of yω contains L(A + (y)), by a computation made above. Meanwhile, the
element y, being in L(A), has (y) ≥−A and hence 0 ≤A + (y). Therefore
L(0) ⊆L(A + (y)), and the kernel of yω contains L(0). Since the kernel of yω
contains (F), yω is well deﬁned on the quotient space AF/(L(0) + (F)).

549
Now suppose that y1, . . . , yn is a k basis of L(A). Let us use the fact that
ω ̸= 0 to prove that y1ω, . . . , ynω are linearly independent when viewed on
AF/(L(0)+(F)): If c1, . . . , cn are members of k not all 0, then z = 	n
j=1 cj yj
is a nonzero member of L(A), and we have just seen that zω is well deﬁned on
AF/(L(0) + (F)). Then we have 	n
j=1 cj(yjω) =
 	n
j=1 cj yj

ω = zω, and
this cannot act as 0 on AF/(L(0) + (F)) without being identically 0 on AF.
Since any ξ0 such that ω(ξ0) ̸= 0 has the property that zω((z)−1ξ0) ̸= 0, the
linear functionals y1ω, . . . , ynω on AF/(L(0) + (F)) are linearly independent.
We know that δ(0) = dimk AF/(L(0) + (F)) by Theorem 9.13, and hence
n = ℓ(A) ≤δ(0).
This completes the proof of the two inequalities.
We turn to the existence and uniqueness of the maximum parallelotope on
which ω vanishes.
We continue to assume that ω ̸= 0.
Now suppose that
A is a divisor such that ω vanishes on L(A). Suppose that B is a divisor for
which B ≤A fails and for which ω(L(B)) = 0. We know that the divisor
max(A, B) has the property that L(max(A, B)) = L(A) + L(B).
Since ω
vanishes on L(A) and L(B), it follows that it vanishes on L(max(A, B)). Since
B ≤A fails, there exists some v0 ∈VF with ordv0 B > ordv0 A, and this v0 has
ordv0 max(A, B) > ordv0 A. Thus deg max(A, B) > deg A.
The second inequality proved above shows that the degree is bounded on all
divisors whose parallelotopes are in ker ω. In ﬁnitely many steps we consequently
arrive at a divisorC withL(C) ⊆ker ω such that any divisor B withL(B) ⊆ker ω
has B ≤C. Then C is the unique maximum divisor on whose parallelotope ω
vanishes. The parallelotope determines the divisor, and the proof of the corollary
is complete.
□
Recall from Section 2 that the additive subgroup PF of principal divisors within
the group DF of all divisors breaks DF into equivalence classes known as divisor
classes. The group CF = DF/PF is the group of all divisor classes. The operation
of a principal divisor (y), for y ∈F×, on a divisor A is A 	→A + (y). On the
other hand, we have seen that if a nonzero differential ω vanishes on L(A), then
yω vanishes on L(A + (y)). In the notation of the remarks with Corollary 9.14,
we therefore have
Div(yω) = Div(ω) + (y).
A single orbit of nonzero differentials under the scalar-multiplication action on
Diff(F) by F× thus yields a single divisor class within DF. We shall show that
Diff(F) is 1-dimensional as an F vector space. Then the nonzero differentials
form a single orbit under F×, and the divisors that arise as Div(ω) for some
nonzero differential ω form a single divisor class.
4. Riemann–Roch Theorem

550
IX. The Number Theory of Algebraic Curves
Lemma 9.15. As a vector space over F, the space Diff(F) of differentials is
1-dimensional.
PROOF. First we prove that Diff(F) is nonzero. Referring to Theorem 9.13,
we know that δ(A) = dimk

AF

(L(A) + (F))

. If δ(A) > 0, then there exist
nonzero linear functionals on AF

(L(A) + (F)), and the lift of such a nonzero
linear functional to AF is a nonzero differential. Thus it is enough to produce a
divisor A with δ(A) > 0. Fix v0 in VF, and let A = −2v0. Proposition 9.10
shows that ℓ(A) = 0. Therefore
δ(A) = ℓ(A) −deg A −(1 −g) = 2 + g −1 = g + 1 > 0,
and this A has δ(A) > 0.
Now we shall prove that the F dimension of Diff(F) is at most 1. Arguing by
contradiction, suppose that ω and ω′ are differentials that are linearly independent
over F. If ω vanishes on L(A) and ω′ vanishes on L(A′), then ω + ω′ vanishes
on L(A)∩L(A′) ⊇L(C), where C = min(A, A′). Let B be an arbitrary divisor.
Suppose for the moment that L(B) ̸= 0. If y ̸= 0 is in L(B), then (y) ≥−B,
and C + (y) ≥C −B. So L(C + (y)) ⊇L(C −B). We have seen that the
vanishing of ω on L(C) implies the vanishing of yω on L(C + (y)). Therefore
yω vanishes on L(C −B). Similarly yω′ vanishes on L(C −B).
Still with L(B) ̸= 0, let n = ℓ(B), and let x1, . . . , xn and y1, . . . , yn be bases
of L(B) over k. Then x1ω, . . . , xnω, y1ω′, . . . , ynω′ are linearly independent
over k because a relation
n	
i=1
aixiω +
n	
j=1
bj yjω′ = 0
would mean that the members x = 	n
i=1 aixi and y = 	n
j=1 bj yj of F have
xω + yω′ = 0. Since ω and ω′ are assumed to be linearly independent over F,
x = y = 0. But then ai = 0 for all i and bj = 0 for all j. Consequently we
can generate 2n linearly independent differentials that all vanish on L(C −B).
These differentials may be regarded as linear functionals on the k vector space
AF/(L(C −B) + (F)), whose k dimension is δ(C −B) by Theorem 9.13.
Consequently
δ(C −B) ≥2ℓ(B),
and this inequality is true also if L(B) = 0, by Riemann’s inequality. Substituting
from the formula for δ( · ), we obtain
ℓ(C −B) −deg(C −B) −1 + g ≥2ℓ(B)
= 2

deg B + 1 −g) + δ(B)

≥2 deg B + 2 −2g

551
because Riemann’s inequality shows that δ(B) ≥0. Replacing deg(C −B) by
deg C −deg B gives
deg B ≤ℓ(C −B) −deg C −3 + 3g.
(∗)
Proposition 9.10 shows that ℓ(C −B) ≤1 + deg(C −B) if ℓ(C −B) ̸= 0. In
this case the two inequalities together give
2 deg B ≤−2 + 3g;
hence ℓ(C −B) = 0 if deg B is positive and sufﬁciently large. Choosing then a
divisor B with deg B positive and sufﬁciently large, we have ℓ(C −B) = 0, and
(∗) gives
deg B ≤−deg C −3 + 3g.
Since the right side is ﬁxed and the left side can be made arbitrarily large, we
have arrived at a contradiction.
□
As a result of Lemma 9.15, the divisors of the form Div(ω) for some nonzero
differential ω constitute a single class in the groupCF = DF/PF of divisor classes.
This class is called the canonical class of F, and any divisor in the class is called
a canonical divisor.
Theorem 9.16 (Riemann–Roch Theorem). Let F be a function ﬁeld in one
variable over a ﬁeld k, and suppose that every member of F not in k is transcen-
dental over k. If A is any divisor of F and C is any canonical divisor, then
ℓ(A) = deg A + (1 −g) + ℓ(C −A),
where g is the genus of F.
PROOF. Lemma 9.15 shows that there exists a nonzero differential ω0. Let
C0 = Div(ω0). Lemma 9.15 shows that C = C0 + (y0) for some y0 ∈F×. Then
ω = y0ω0 has
Div(ω) = Div(y0ω0) = Div(ω0) + (y0) = C0 + (y0) = C.
Let B be a divisor to be speciﬁed, and considerC−B. Any nonzero differential
ω′ vanishing on L(C −B) is of the form ω′ = zω for some z ∈F× by Lemma
9.15, and Div(ω′) = Div(zω) = C + (z). Therefore L(C + (z)) ⊇L(C −B),
C + (z) ≥C −B, and (z) ≥−B. This inequality means that z is in L(B).
Conversely if y is any nonzero element in L(B), then (y) ≥−B and C + (y) ≥
C −B. So L(C + (y)) ⊇L(C −B). We know that yω vanishes on L(C + (y)),
and hence yω vanishes on L(C −B).
4. Riemann–Roch Theorem

552
IX. The Number Theory of Algebraic Curves
Consequently the differentials vanishing on L(C −B) are exactly the dif-
ferentials yω with y in L(B). Such differentials vanish on (F) by deﬁnition,
and the space of them is k isomorphic to the space of k linear functionals on
AF

L(C −B) + (F))

. By Theorem 9.13 the latter space has k dimension
δ(C −B), and hence the space of differentials in question has k dimension
δ(C −B). In short,
δ(C −B) = ℓ(B).
Since B is arbitrary, we can specialize it to B = C −A. Then we obtain
ℓ(C −A) = δ(A) = ℓ(A) −deg A −(1 −g),
and the theorem follows.
□
5. Applications of the Riemann–Roch Theorem
We begin with some immediate applications of the Riemann–Roch Theorem, and
then we obtain some applications that require arguments that are a bit more subtle.
Another application appears in the problems at the end of Chapter X.
Corollary 9.17. If C is any canonical divisor, then ℓ(C) = g.
PROOF. Put A = 0 in Theorem 9.16, and use the fact given in Corollary 9.4
that ℓ(0) = 1.
□
Corollary 9.18. If C is any canonical divisor, then deg C = 2g −2.
PROOF. Put A = C in Theorem 9.16, and apply Corollary 9.17 and Corollary
9.4.
□
Corollary 9.19. Any divisor A with deg A > 2g −2 has δ(A) = 0, i.e.,
ℓ(A) = deg A + (1 −g).
PROOF.
If deg A > 2g −2, then it follows from Corollary 9.18 that
deg(C −A) < 0. By Proposition 9.10, ℓ(C −A) = 0. Then the corollary
is immediate from Theorem 9.16.
□
Corollary 9.20. If A is a divisor with deg A = 2g −2, then either A is a
canonical divisor and ℓ(A) = g, or A is not a canonical divisor and ℓ(A) = g−1.
PROOF. If A is a canonical divisor, then ℓ(A) = g by Corollary 9.17. Other-
wise, the divisor C −A, which has degree 0 by Corollary 9.18, is not a principal
divisor. Any nonzero y in L(C −A) then would have (y) ≥−(C −A) and
0 = deg(y) ≥−deg(C −A) = 0; hence v(y) = −ordv(C −A) for all v, and
(y) = C −A, contradiction. Consequently L(C −A) = 0 and ℓ(C −A) = 0.
Theorem 9.16 now gives ℓ(A) = deg A + (1 −g) = (2g −2) + (1 −g) = g −1.
□

5. Applications of the Riemann–Roch Theorem
553
EXAMPLES OF CANONICAL DIVISORS.
(1) Genus g = 0. In Corollary 9.20 with g = 0, the alternative ℓ(A) =
g −1 = −1 is impossible, and therefore every divisor with degree −2 is a
canonical divisor.
(2) Genus g = 1. In Corollary 9.20 with g = 1, take A = 0. Then ℓ(A) =
1 = g by Corollary 9.4. So Corollary 9.20 says that the divisor 0 is a canonical
divisor.
Corollary 9.21. If v0 is in VF and n > max(2g −1, 0), then there exists a
nonscalar x in F× with (x)∞≤nv0.
PROOF. Let A = nv0, and let fv0 be the residue class degree of v0. Then
deg A = nfv0 ≥n > max(2g −1, 0), and Corollary 9.19 gives
ℓ(A) = deg A + (1 −g) = nfv0 + (1 −g)
> max(2g −1, 0) + (1 −g) = max(g, 1 −g) ≥1.
Hence ℓ(A) ≥2, and L(A) contains a nonscalar element x. This x has
−n = −ordv0 A ≤ordv0(x) = ordv0(x)0 −ordv0(x)∞= −ordv0(x)∞,
and thus (x)∞≤nv0.
□
Doubly periodic meromorphic functions on C in the subject of complex analy-
sis may be viewed as meromorphic functions on some torus,12 which is a compact
Riemann surface of genus 1. The Weierstrass ℘function for the torus in question
hasa double pole at one point, two zeros, and noother polesorzeros. It istherefore
a function x with (x)∞= 2v0 if v0 is the discrete valuation corresponding to the
location of the pole. Hence this x provides an example with equality holding in
Corollary 9.21 when g = 1. A theorem of Liouville in this terminology says that
there is no meromorphic function on the torus having just one simple pole and no
other poles. The ﬁnal corollaries abstract this result to our setting, but they need
an additional hypothesis to ensure that fv0 = 1. Certainly fv0 will equal 1 if k is
algebraically closed. We consider g = 1 and g > 1 separately. These corollaries
will be generalized in Problems 23–25 at the end of the chapter.
Corollary 9.22. If k is algebraically closed, if v0 is in VF, and if g = 1, then
every x in F with (x)∞≤v0 is a scalar multiple of the identity.
PROOF. Put A = v0. We seek x ∈F with v0(x) ≥−1 = −ordv0 A and
with v(x) ≥0 = −ordv A for all other v. Thus we seek x in L(A). This A
has deg A = 1 = g = 2g −1. By Corollary 9.19, ℓ(A) = deg A + (1 −g) =
1 + (1 −1) = 1. Since L(A) already contains the multiples of the identity, it
contains nothing else.
□
12The particular torus is C/!, where ! is the lattice of periods.

554
IX. The Number Theory of Algebraic Curves
Corollary 9.23. If k is algebraically closed, if v0 is in VF, and if g > 1, then
every x in F with (x)∞≤v0 is a scalar multiple of the identity.
PROOF. We argue by contradiction. Suppose that x is a nonscalar element in
L(v0). Take r = 2g −1, and let c1, . . . , cr be distinct members of k. For each j
with 1 ≤j ≤r, x −cj is in L(v0). Since deg(x −cj) = 0, there exists a unique
vj ∈VF with vj(x −cj) = 1. The divisor of the element (x −cj)−1 is then v0−vj.
It follows that every k linear combination of the elements (x −cj)−1 lies in L(A)
for A = v1 +· · ·+vr. On the other hand, these elements are linearly independent
because vj
 	r
i=1 ai(x −cj)−1
< 0 if and only if aj ̸= 0. Thus ℓ(A) ≥2g −1
and deg A = 2g−1. Since deg A > 2g−2, Corollary 9.19 is applicable and gives
ℓ(A) = deg A+1−g. Thus 2g−1 ≤ℓ(A) = deg A+1−g = 2g−1+1−g = g,
and we obtain the contradiction g ≤1.
□
6. Problems
1.
Let F be a function ﬁeld in one variable over the ﬁeld k, and let k′ be the subﬁeld
of all members of F that are algebraic over k.
(a) Suppose that t1, . . . , tn are members of k′ that are linearly independent over
k, and suppose that x ∈F is transcendental over k. Prove that t1, . . . , tn are
linearly independent over k(x).
(b) Deduce from (a) that [k′ : k] ≤[k′(x) : k(x)].
(c) Deduce that [k′ : k] < ∞.
Problems 2–4 concern perfect ﬁelds, which were deﬁned in Section VII.3. The ﬁeld
k is perfect if either it has characteristic 0 or else it has characteristic p and the ﬁeld
map x 	→x p of k into itself is onto.
2.
Prove that an algebraic extension of a perfect ﬁeld is perfect.
3.
When k is perfect, reﬁne an argument in Section 1 by making use of Theorems
7.18, 7.20, 7.22, and the Theorem of the Primitive Element, and show that any
function ﬁeld in one variable is the function ﬁeld of some afﬁne plane curve
irreducible over k.
4.
Let k be a perfect ﬁeld. An afﬁne plane curve f (X, Y) irreducible over k is
nonsingular at a point (a, b) of its zero locus if at least one of ∂f
∂X (a, b) and
∂f
∂Y (a, b) is nonzero. Using Bezout’s Theorem and taking a cue from the proof of
Theorem 7.20, prove that the curve can be singular at only ﬁnitely many points
of its zero locus.
Problems 5–11 seek to attach a discrete valuation of the function ﬁeld of an irreducible
afﬁne plane curve to each point of the zero locus at which the curve is nonsingular.
Let k be a base ﬁeld, let f (X, Y) be an irreducible polynomial in k[X, Y], let R =

6. Problems
555
k[X, Y]/( f (X, Y)), let x and y be the images of X and Y in R, and let F be the ﬁeld
of fractions of R. Suppose that (a, b) ∈k2 has the property that f (a, b) = 0. The
condition of nonsingularity of f at (a, b) is that one of ∂f
∂X and ∂f
∂Y be nonvanishing at
(a, b), and it will be assumed that ∂f
∂X (a, b) ̸= 0. Observe from Lemma 7.16 that if S is
anyintegraldomain, ifs isin S, andifc(X)isin S[X], thenc(X)−c(s) = (X−s)d(X)
for some d(X) in S[X].
5.
Let f1(X) be the member of k[X] deﬁned as above to make f (X, b) =
(X −a) f1(X). Using the fact that ∂f
∂X (a, b) ̸= 0, prove that f1(a) ̸= 0 and
therefore also that f1(x) ̸= 0.
6.
Let g(X, Y) be a member of k[X, Y] with g(x, y) ̸= 0. Prove that if g(a, b) = 0,
then there exist g1(X) in k[X] and h1(X, Y) in k[X, Y] with
g(X, Y) f1(X) −f (X, Y)g1(X) = (Y −b)h1(X, Y),
and deduce that g(x, y) = (y −b)h1(x, y)/f1(x).
7.
Show that there is a discrete valuation v1 of F over k with v1(y −b) > 0.
8.
If h(a, b) = 0 in Problem 6, then the process can be repeated to give
g(x, y) = (y −b)2h2(x, y)/f1(x)2.
It can be repeated again if h2(a, b) = 0, and so on. By applying the valuation
v1 of the previous problem to g(a, y), show that there is an upper bound to the
integers k ≥0 such that a nonzero member g(x, y) in R can be written in the
form g(x, y) = (y −b)khk(x, y)/f1(x)k for some hk(x, y) in R.
9.
(a) Deduce that each nonzero g(x, y) in R is of the form
g(x, y) = (y −b)nh(x, y)/f1(x)n
with n ≥0, h(x, y) in R, and h(a, b) ̸= 0, and that the integer n and the
member h(x, y) of R are uniquely determined by g(x, y).
(b) Conclude that every nonzero member g(x, y) of the ﬁeld of fractions F is
of the form (y −b)nh1(x, y)/h2(x, y) with n in Z, h1(x, y) and h2(x, y)
nonzero in R, h1(a, b) ̸= 0, and h2(a, b) ̸= 0.
(c) Prove in (b) that g(x, y) uniquely determines n.
10. Write each nonzero g(x, y) in F as in (b) of the previous problem, and put
v(g) = n. Also, deﬁne v(0) = ∞. Show that the resulting function v is a
well-deﬁned valuation of F having R in its valuation ring, taking the value 0 on
all members of R that are nonvanishing at (a, b), and having all members of R
vanishing at (a, b) in its valuation ideal.

556
IX. The Number Theory of Algebraic Curves
11. Prove that there is only one valuation ofF over k taking the value 0 on all members
of R that are nonvanishing at (a, b) and having all members of R vanishing at
(a, b) in its valuation ideal.
Problems 12–20 compute the genus of certain function ﬁelds in one variable. Let k
be a ﬁeld of characteristic ̸= 2, let f (X) be a square-free nonconstant polynomial in
k[X], let F = k(X)[Y]/(Y 2 −f (X)), and let x and y be the images of X and Y in F.
In these problems, p denotes a positive integer.
12. Verify that
(a) the element x is transcendental over k, y is algebraic over k(x) with y2 =
f (x), and F is a function ﬁeld in one variable over k,
(b) every member of F is uniquely of the form a(x)+ yb(x) with a(x) and b(x)
in k(x),
(c) every member of F not in k is transcendental over k,
(d) F/k(x) is a Galois extension of degree 2, and the nontrivial element σ of
Gal(F/k(x)) satisﬁes σ(a(x) + yb(x)) = a(x) −yb(x) for a(x) and b(x)
in k(x).
13. Prove that the integral closure of k[x] in F is the ring R of all elements
a(x) + yb(x) such that a(x) and b(x) are in k(x).
14. (a) Deduce from the previous problem that R is the set of all members z of F
such that v(z) ≥0 for all v in DF that satisfy v(x) ≥0.
(b) Deduce from (a) that L(p(x)∞) ⊆R.
15. Let v be any member of DF with v(x) < 0.
(a) Prove that every nonzero c(x) in k[x] has v(c(x)) = (deg c)v(x).
(b) Prove that v(y) = 1
2(deg f )v(x).
(c) Prove that if a(x) and b(x) are in k[x] with deg b + 1
2 deg f ≤p and
deg a ≤p, then v(a(x) + yb(x)) ≥pv(x).
16. Prove that if a(x) and b(x) are in k[x] with deg b + 1
2 deg f ≤p and deg a ≤p,
then a(x) + yb(x) lies in L(p(x)∞).
17. (a) Prove that if v is in DF and if σ is in Gal(F/k(x)), then the function vσ
deﬁned by vσ(z) = v(σ(z)) for z ∈F is in DF.
(b) Why is v(x) < 0 if and only if vσ(x) < 0?
(c) Deduce that if z is in L(p(x)∞), then so is σ(z).
18. (a) Using the previous problem, show that if a(x) and b(x) are in k[x] with
a(x) + yb(x) in L(p(x)∞) and if v is a member of DF with v(x) < 0,
then v(a(x)) ≥pv(x) and v(a(x)2 −f (x)b(x)2) ≥2pv(x). Conclude that
deg a ≤p and deg(a2 −f b2) ≤2p.
(b) Deduce that L(p(x)∞) consists of all members a(x) + yb(x) of R such that
deg a ≤p and deg b + 1
2 deg f ≤p.

6. Problems
557
19. Calculate that ℓ(p(x)∞) = 2p + 2 −
 1
2(1 + deg f )

if p ≥
 1
2(1 + deg f )

.
Here [ · ] denotes the greatest integer function.
20. (a) Why is deg(x)∞= 2?
(b) Using Corollary 9.19 with A = p(x)∞for a suitable p, prove that the genus
of F is g =
 1
2(1 + deg f )

−1.
Problems 21–22 compute the genus of certain further function ﬁelds in one variable.
The notation is as in Problems 12–20 except that f (X) is allowed to have repeated
factors. Suppose that f (X) = g(X)2h(X), where h(X) is a square-free nonconstant
polynomial and g(X) is in k[X]. Let F = k(X)[Y]/(Y 2 −f (X)).
21. With F′ = k(X)[Z]/(Z2 −h(X)), exhibit a ﬁeld isomorphism F →F′ ﬁxing k.
22. Suppose that f (X) has degree 3.
(a) Prove that F has genus 1 if f (X) has no repeated root in k and that F has
genus 0 otherwise.
(b) Prove that the afﬁne plane curve Y 2 −f (X) over k has a singularity in k2
alg if
and only if f (X) has a repeated root in k2
alg. Here kalg denotes an algebraic
closure of k.
Problems 23–25 introduce Weierstrass points. Let k be an algebraically closed ﬁeld,
and let F be a function ﬁeld in one variable over k of genus g. Fix a discrete valuation
v in DF.
23. Why is it true that ℓ(0v) = 1, ℓ(1v) = 1 if g ≥1, ℓ((2g −1)v) = g, ℓ(2gv) =
g + 1, and ℓ(nv) ≤ℓ((n + 1)v) ≤ℓ(nv) + 1 for all integers n ≥0?
24. Deduce from the previous problem that there exist exactly g integers 0 < n1 <
n2 < · · · < ng < 2g such that there is no x in F with (x)∞= niv. (Educational
note: The integers ni are called the Weierstrass gaps of v, and (n1, . . . , ng) is
the gap sequence for v. Classically when F is viewed as the function ﬁeld of
an everywhere nonsingular projective curve, then the points of the zero locus in
projective space are in one-one correspondence with the members of DF; with
this understanding, the point corresponding to v is called a Weierstrass point if
the gap sequence for v is anything but (1, 2, . . . , g). Accordingly let us call v a
Weierstrass valuation in this case.)
25. Prove that
(a) v is a Weierstrass valuation if and only if ℓ(gv) > 1.
(b) 1 is a Weierstrass gap if g > 0.
(c) v is not a Weierstrass valuation if g = 0 or g = 1.
(d) if r and s are positive integers with sum < 2g that are not Weierstrass gaps
at v, then r + s is not a Weierstrass gap at v.
(e) if2isnotaWeierstrassgapatv, thenthegapsequenceis(1, 3, 5, . . . , 2g−1).

CHAPTER X
Methods of Algebraic Geometry
Abstract. This chapter investigates the objects and mappings of algebraic geometry from a geo-
metric point of view, making use especially of the algebraic tools of Chapter VII and of Sections
7–10 of Chapter VIII. In Sections 1–12, k denotes a ﬁxed algebraically closed ﬁeld.
Sections 1–6 establish the deﬁnitions and elementary properties of varieties, maps between
varieties, and dimension, all over k. Sections 1–3 concern varieties and dimension. Afﬁne algebraic
sets, afﬁne varieties, and the Zariski topology on afﬁne space are introduced in Section 1, and
projective algebraic sets and projective varieties are introduced in Section 3. Section 2 deﬁnes
the geometric dimension of an afﬁne algebraic set, relating the notion to Krull dimension and
transcendence degree. The actual context of Section 2 is a Noetherian topological space, the Zariski
topology on afﬁne space being an example. In such a space every closed subset is the ﬁnite union of
irreducible closed subsets, and the union can be written in a certain way that makes the decomposition
unique. Every nonempty closed set has a meaningful geometric dimension. In afﬁne space the
irreducible closed sets are the varieties, and each variety acquires a geometric dimension. The
discussion in Section 2 applies in the context of projective space as well, and thus each projective
variety acquires a geometric dimension. Moreover, any nonempty open subset of a Noetherian
space is Noetherian. A nonempty open subset of an afﬁne variety is called quasi-afﬁne, and a
nonempty open subset of a projective variety is called quasiprojective. Each quasi-afﬁne variety or
quasiprojective variety has a dimension equal to that of its closure, which is a variety.
Sections 4–6 take up maps between varieties. Section 4 introduces spaces of scalar-valued
functions on quasiprojective varieties—rational functions, functions regular at a point, and functions
regular on an open set. The section goes on to relate these notions for the different kinds of varieties.
Section 5 introduces morphisms, which are a restricted kind of function between varieties. The
tools of Sections 4–5 together show that for many purposes all the different kinds of varieties can be
treated as quasiprojective varieties. Section 6 introduces rational maps between varieties; these are
not everywhere-deﬁned functions, but each can be restricted to an open dense subset on which it is
a morphism. Rational maps with dense image correspond to ﬁeld mappings of the ﬁelds of rational
functions, with the order of the mappings reversed.
Section 7 concerns singularities at points of varieties, still over the ﬁeld k. Zariski’s Theorem
was stated in Chapter VII for afﬁne varieties and partly proved at that time. In the current context
it has a meaning for any point of any quasiprojective variety. The section proves the full theorem,
which characterizes singular points in a way that shows they remain singular under isomorphisms
of varieties.
Section 8 concerns classiﬁcation questions over k for irreducible curves, i.e., quasiprojective
varieties of dimension 1. From Section 6 it is known that two irreducible curves are equivalent under
rational maps if and only if their ﬁelds of rational functions are isomorphic. The main theorem of
Section 8 is that each such equivalence class of irreducible curves contains an everywhere nonsingular
projective curve, and this curve is unique up to isomorphism of varieties. The points of this curve
are parametrized by those discrete valuations of the underlying function ﬁeld that are deﬁned over k.
558

1. Affine Algebraic Sets and Affine Varieties
559
Sections 9–12 relate the general theory of Sections 1–6 to the topic of solutions of simultaneous
solutions of polynomial equations, as treated at length in Chapter VIII. Section 9 treats monomial
ideals in k[X1, . . . , Xn], identifying their zero loci concretely and computing their dimension. The
section goes on to introduce the afﬁne Hilbert function of this ideal, which measures the proportion of
polynomials of degree ≤s not in the ideal. In the way that this function is deﬁned, it is a polynomial
for large s called the afﬁne Hilbert polynomial of the ideal. Its degree equals the dimension of the
zero locus of the ideal. Section 10 extends this theory from monomial ideals to all ideals, again
concretely computing the dimension of the zero loci, obtaining an afﬁne Hilbert polynomial, and
showing that its degree equals the dimension of the zero locus of the ideal. Section 11 adapts the
theory to homogeneous ideals and projective algebraic sets by making use of the cone in afﬁne
space over the set in projective space. Section 12 applies the theory of Section 11 to address the
question how the dimension of a projective algebraic set is cut down when the set is intersected with
a projective hypersurface. A consequence of the theory is the result that a homogeneous system of
polynomial equations over an algebraically closed ﬁeld with more unknowns than equations has a
nonzero solution.
Section 13 is a brief introduction to the theory of schemes, which extends the theory of varieties
by replacing the underlying algebraically closed ﬁeld by an arbitrary commutative ring with identity.
1. Afﬁne Algebraic Sets and Afﬁne Varieties
We come now to the more geometric side of algebraic geometry. At least initially
this means that we are interested in the set of simultaneous solutions of a system
of polynomial equations in several variables. Because of the Nullstellensatz the
natural starting point for the investigation is the case that the underlying ﬁeld of
coefﬁcients is algebraically closed.
Accordingly, throughout Sections 1–6 of this chapter, k will denote an alge-
braically closed ﬁeld.1 We ﬁx a positive integer n and denote by A the polynomial
ring A = k[X1, . . . , Xn]. Typical ideals of A will be denoted by a, b, . . . . We
begin by expanding on some deﬁnitions made in Section VIII.2. The set
An =

(x1, . . . , xn) ∈kn
is called afﬁne n-space. Members of An are called points in afﬁne n-space, and
the functions P 	→xj(P) give the coordinates of the points.
To each subset S of polynomials in A, we associate the locus of common
zeros, or zero locus of the members of S:
V (S) =

P ∈An | f (P) = 0 for all f ∈S

.
Any such set V (S) is called an afﬁne algebraic set in An. If S is a ﬁnite set
{ f1, . . . , fk} of polynomials, we allow ourselves to abbreviate V ({ f1, . . . , fk})
1The exposition in these sections is based in part on Chapters 2, 4, and 6 of Fulton’s book,
Chapter I of Hartshorne’s book, and Chapter I of Volume 1 of Shafarevich’s books.

560
X. Methods of Algebraic Geometry
as V ( f1, . . . , fk). It is immediate from the deﬁnitions that V (S) is the same as
V (a) if a is the ideal in A generated by S. The Hilbert Basis Theorem shows that
every ideal of A is ﬁnitely generated, and it follows that every afﬁne algebraic set
is of the form V ( f1, . . . , fk) for some k and some polynomials f1, . . . , fk.
In Chapter VIII we worked extensively with examples of ideals of A and their
corresponding afﬁne algebraic sets, and it will not be necessary to give further
examples of that kind now.
Observe from the deﬁnition that V (S) = 
f ∈S V ( f ) for any subset S of A. It
follows immediately that S 	→V (S), as a function carrying each subset S of A
to a subset V (S) of An, is inclusion reversing: S1 ⊆S2 implies V (S1) ⊇V (S2).
Using this same identity, we obtain the following further properties of V .
Proposition 10.1. Afﬁne algebraic sets in An have the following properties:
(a) V (∅) = V (0) = An and V (A) = ∅,
(b) V
 
α Sα

= 
α V (Sα) if the Sα’s are arbitrary subsets of A,
(c) V (S) = V (S1) ∪V (S2) if S1 and S2 are subsets of A and if S is deﬁned
as the set of all products f1 f2 with f1 ∈S1 and f2 ∈S2.
PROOF. Property (a) is immediate. For (b), we have
V
 
α
Sα

=

f ∈	
α Sα
V ( f ) = 
α

f ∈Sα
V ( f ) = 
α
V (Sα).
For (c), we observe ﬁrst that V ( f1 f2) = V ( f1) ∪V ( f2) for any f1 and f2 in A.
Then
V (S) =

f1∈S1,
f2∈S2
V ( f1 f2) = 
f1∈S1

f2∈S2

V ( f1) ∪V ( f2)

=
 
f1∈S1
V ( f1)

∪
 
f2∈S2
V ( f2)

= V (S1) ∪V (S2).
□
Properties (a), (b), and (c) in the proposition are the axioms for the closed
sets in a topology on An. This topology is called the Zariski topology on afﬁne
n-space. Every one-point set is closed. The Zariski topology on An is never
Hausdorff; for example, if n = 1, then it is the topology on k1 = k in which the
nonempty open sets are the complements of the ﬁnite sets. Since one-point sets
are closed and the topology is not Hausdorff, the Zariski topology on An is never
regular. At ﬁrst glance it looks like a useless topology, but we shall see already
in Proposition 10.3b and again in Section 2 that it is quite helpful for handling
the bookkeeping used in passing back and forth between algebra and geometry.
Next we introduce a function E 	→I (E), carrying each subset E of An to an
ideal I (E) in A, by the deﬁnition
I (E) =

f ∈A | f (P) = 0 for all P ∈E

.

1. Affine Algebraic Sets and Affine Varieties
561
Then I (E) = 
P∈E I ({P}). It follows immediately that E 	→I (E) is inclusion
reversing: E1 ⊆E2 implies I (E1) ⊇I (E2). The result for I ( · ) that parallels
Proposition 10.1 is as follows.
Proposition 10.2. For ﬁxed n, the function I ( · ) has the following properties:
(a) I (∅) = A and I (A) = 0,
(b) I (E1 ∪E2) = I (E1) ∩I (E2) if E1 and E2 are subsets of An,
(c) I (E1 ∩E2) ⊇I (E1) + I (E2) if E1 and E2 are subsets of An.
REMARKS. Equality can fail in (c). For example, if E1 is the one-point set {0}
and E2 is its complement, then I (E1 ∩E2) = I (∅) = A, while I (E2) = 0 and
I (E1) consists of all members of A with 0 constant term.
PROOF. Property (a) is immediate. For (b), we have
I (E1 ∪E2) =

P∈E1∪E2
I ({P}) =
 
P∈E1
I ({P})

∩
 
P∈E2
I ({P})

= I (E1)∩I (E2).
In (c), the fact that I ( · ) is inclusion reversing implies that I (E1 ∩E2) ⊇I (E1)
and that I (E1 ∩E2) ⊇I (E2). Since I (E1 ∩E2) is closed under addition, (c)
follows.
□
This is all quite elementary. The less trivial question is the extent to which
V ( · ) and I ( · ) are inverse to one another. Proposition 10.3 gives the answer.
Proposition 10.3. For ﬁxed n,
(a) I (V (a)) = √a for each ideal a in A,
(b) V (I (E)) = E for each subset E of An, where E is the Zariski closure
of E,
(c) V (a) = V (√a ) for each ideal a in A,
(d) any two ideals a and b in A have ab ⊆a ∩b ⊆
√
ab and consequently
have V (a ∩b) = V (ab) = V (a) ∪V (b).
REMARKS. Recall from Section VII.1 that √a denotes the radical of a, con-
sisting of all f in A such that f k is in a for some integer k ≥1. The radical of a
equals a itself if a is prime.
PROOF. Conclusion (a) is the Nullstellensatz as formulated in Theorem 7.1b.
For (b), the deﬁnitions show that V (I (E)) ⊇E. Since any set V (S) is Zariski
closed, we must have V (I (E)) ⊇E. On the other hand, the fact that E is closed
means that E = V (S) for some S. Thus V (S) = E ⊇E, and the inclusion-
reversing property of I ( · ) gives I (V (S)) ⊆I (E). Since the deﬁnitions imply
that S ⊆I (V (S)), we obtain S ⊆I (E). From the inclusion-reversing property
of V ( · ), we conclude that E = V (S) ⊇V (I (E)).
For (c), (a) and (b) give V (√a ) = V (I (V (a))) = V (a) = V (a) because V (a)
is closed.

562
X. Methods of Algebraic Geometry
For (d), the inclusion ab ⊆a ∩b is immediate. If f is in a ∩b, then f is
in a and in b, and hence f 2 is in ab. Thus f is in
√
ab . Applying V ( · ) gives
V (ab) ⊇V (a ∩b) ⊇V (
√
ab ). Since V (ab) = V (
√
ab ) by (c), V (a ∩b) =
V (ab). Finally V (ab) = V (a) ∪V (b) by Proposition 10.1c.
□
An afﬁne variety is any afﬁne algebraic set of the form V (p), where p is a
prime ideal2 of A. That is, an afﬁne variety is the locus of common zeros of any
prime ideal of A.
For example, if f is an irreducible polynomial in A, then f is prime because A
isauniquefactorizationdomain, andconsequentlytheprincipalideal( f )isprime.
Thus the zero locus in A2 of an irreducible polynomial f in k[X, Y] is an example
of an afﬁne variety. This particular kind of afﬁne variety is called an irreducible
afﬁne plane curve.3,4 More generally, if f is irreducible in A = k[X1, . . . , Xn]
with n ≥2, then the zero locus of f in An is called an irreducible afﬁne
hypersurface.5 Another example of an afﬁne variety is any translate of any vector
subspace of An. Examples of afﬁne varieties other than irreducible hypersurfaces,
translates of vector subspaces, and varieties built from other varieties in simple
ways often take some work to establish. The reason is that it is usually not easy
to show that a particular nonprincipal ideal is prime. Here is one example that is
manageable.
EXAMPLE. The twisted cubic in A3 is the zero locus V (p) of the ideal p in
k[X, Y, Z] given by p = (Y −X2, Z −X3); that is, V (p) = {(x, x2, x3) | x ∈k}.
The substitution homomorphism ϕ that ﬁxes k and sends X to X, Y to X2, and
Z to X3 carries k[X, Y, Z] into k[X]. It is onto k[X] because any polynomial in
X alone is sent to itself by ϕ. The kernel of ϕ manifestly contains p. To see that
it equals p, we argue by contradiction. Choose a polynomial f in ker ϕ not in p
whose degree in Z is as small as possible and whose degree in Y is as small as
possible among those of minimal degree in Z. If Z occurs somewhere in f , then
by replacing all occurrences of Z in f with X3, we replace f by another member
of f + p of lower degree in Z, contradiction. Thus f has no Z in it. Arguing
2Warning:
The books by Fulton and Hartshorne in the Selected References use the narrow
deﬁnition of variety that is reproduced here. Some books by other authors allow all afﬁne algebraic
sets to be called varieties. Volume 1 of Shafarevich’s books does not use the word “variety.”
3Warning: This deﬁnition represents a change from Chapters VIII and IX, corresponding to a
change in point of view. Previously the word “curve” referred to the ideal, and now it is to refer to
the zero locus. From a mathematical standpoint Proposition 10.3 shows that this distinction is not
important in the presence of the irreducibility and the fact that k is algebraically closed. The change
thus represents only a matter of convenience for the exposition.
4Some authors build the condition of irreducibility into the deﬁnition of “curve,” but this book
does not.
5Some authors build the condition of irreducibility into the deﬁnition of “hypersurface,” but this
book does not.

2. Geometric Dimension
563
similarly, we see that f has no Y in it. So f is a polynomial in X. Since ϕ acts
as the identity on polynomials in X alone, f = 0. This contradiction shows that
ker ϕ = p. Since image ϕ = k[X] is an integral domain, p is prime. By the
Nullstellensatz, p may be described alternatively as the ideal of all polynomials
vanishing on V (p).
Every afﬁne variety is nonempty, as a consequence of the Nullstellensatz. In
fact, any prime ideal p of A is contained in a maximal ideal m, whose zero locus
is identiﬁed as some point P of An. The inclusion p ⊆m implies that V (p) ⊇
V (m) = {P}. Afﬁne varieties are characterized by a geometric irreducibility
property that is stated in Corollary 10.4.
Corollary 10.4. The afﬁne varieties in An are characterized as those nonempty
Zariski closed sets that cannot be written as the union of two proper closed subsets.
REMARKS. One says that the afﬁne varieties are those afﬁne algebraic sets that
are irreducible. Irreducible sets are nonempty by deﬁnition.
PROOF. Let V (p) be an afﬁne variety with p prime, and suppose that V (p) =
E1 ∪E2 with E1 and E2 both closed and properly contained in V (p). Application
of I ( · ) and use of Proposition 10.2b gives I (V (p)) = I (E1)∩I (E2). Proposition
10.3a allows us to rewrite this conclusion as p = b1 ∩b2 with b1 = I (E1) and
b2 = I (E2). By Problem 10a at the end of Chapter VII, p = b1 or p = b2. If
p = b1, then V (p) = V (b1) = V (I (E1)), and this equals E1 by Proposition
10.3b because E1 is closed. Similarly if p = b2, then V (p) = E2. Thus E1 and
E2 cannot both be proper subsets of V (p).
Conversely suppose that E is an irreducible closed subset of An. Let f and
g be members of A with f g in I (E). Then Propositions 10.3b and 10.1c give
E = V (I (E)) ⊆V ( f g) = V ( f ) ∪V (g). Therefore
E =

E ∩V ( f )

∪

E ∩V (g)

exhibits E as the union of two closed sets. By irreducibility one of the two closed
sets equals E. If E = E ∩V ( f ), then E ⊆V ( f ) and I (E) ⊇I (V ( f )) ⊇( f ).
If E = E ∩V (g), then similarly I (E) ⊇(g). Either way, one of f and g lies in
I (E). Since E is assumed nonempty, I (E) is proper. Therefore I (E) is prime.
□
2. Geometric Dimension
We continue to assume that k is an algebraically closed ﬁeld and to write A
for k[X1, . . . , Xn]. If p is a prime ideal in A, then the dimension of the afﬁne
variety V (p) was deﬁned in Section VII.2 to be the transcendence degree of the
ﬁeld of fractions of the integral domain A/p over k. This quantity depends only

564
X. Methods of Algebraic Geometry
on V (p) because p can be recovered from V (p) by the formula p = I (V (p))
given in Proposition 10.3a. The integral domain A/p is ﬁnitely generated as a
k algebra with generators X1 + p, . . . , Xn + p, and Theorem 7.22 shows that
this transcendence degree equals the Krull dimension of the ring A/p, which is
denoted by dim A/p. The latter quantity is the supremum of the indices d of all
strictly increasing chains p0 ⫋p1 ⫋· · · ⫋pd of prime ideals in A/p.
Because of this equality, it is natural to use the notion of Krull dimension in
order to generalize the deﬁnition of dimension from varieties to all nonempty
afﬁne algebraic sets.6 If a is an any proper ideal in A, not necessarily prime, and
V (a) is its locus of common zeros, we might ﬁrst try deﬁning dim V (a) to be the
Krull dimension of A/a. This approach is a bit cumbersome because two distinct
ideals a and a′ can have V (a) = V (a′); thus some argument would be needed to
see that dim V (a) is well deﬁned before it would be possible to proceed.
Instead, we shall give a direct geometric deﬁnition of dimension in terms of
the Zariski topology on An. Theorem 10.7 later in this section will show that the
geometric quantity dim V (a) equals the Krull dimension of A
√a , thus that the
dimension of an afﬁne algebraic set has an algebraic formulation. From this result
we shall deduce that dim V (a) equals the Krull dimension of A/a itself. This
algebraic formulation of a deﬁnition will not yet allow us to compute dimensions
concretely, but we shall introduce in Sections 9–11 an equivalent combinatorial
deﬁnition of dimension that is computable in terms of Gr¨obner bases.
A topological space X will be said to be Noetherian if every strictly decreasing
sequence of closed subsets is ﬁnite in length. An example is afﬁne n-space An.
In fact, if E1, E2, . . . are closed sets in An with E1 ⊇E2 ⊇· · · , then the
corresponding ideals have I (E1) ⊆I (E2) ⊆· · · . Since A is Noetherian, there
exists some integer k with I (Ek) = I (Ek+1) = · · · . Applying V ( · ) and using
Proposition 10.3b, we obtain Ek = Ek+1 = · · · .
We can generalize the deﬁnition of irreducibility for closed sets from An to
an arbitrary Noetherian topological space. Namely a nonempty closed set E is
irreducible if it is not the union of two proper closed subsets. An important ob-
servation about any Noetherian topological space is that any nonempty relatively
open subset U of an irreducible closed set V is dense in V ; in fact, if U denotes
the closure of U, then V = U ∪(V −U) exhibits V as the union of two closed
subsets, and the irreducibility forces U = V since V −U ̸= V .
Proposition 10.5. If X is a Noetherian topological space, then any closed
subset is the ﬁnite union of irreducible closed subsets. This decomposition of a
closed set as such a union may be chosen in such a way that none of the closed sets
in the union contains another set in the union, and in this case the decomposition
is unique.
6We shall leave the dimension of the empty set as undeﬁned for now.

2. Geometric Dimension
565
PROOF. For existence of some decomposition of each closed set as a ﬁnite
union of irreducible closed subsets, we argue by contradiction. Assuming that
there exists some closed subset E of X that is not the ﬁnite union of irreducible
closedsubsets, wemayassumebytheNoetherianconditionon X that E isminimal
among all such counterexamples. Since E cannot itself be irreducible, we can
write E = E1 ∪E2 with E1 and E2 closed and properly contained in E. Since
E is minimal among all closed subsets that are not the ﬁnite union of irreducible
closed subsets, E1 and E2 can be expressed as ﬁnite unions of irreducible closed
subsets. Substituting these expressions into the equality E = E1 ∪E2 gives a
contradiction to the fact that E is a counterexample.
This proves existence of a decomposition. By going through the sets in the
decomposition one at a time and by discarding any set that is contained in another
set, we obtain a decomposition as in the second sentence of the proposition.
For uniqueness, suppose that E = E1 ∪· · · ∪Ek = F1 ∪· · · ∪Fl gives two
decompositionsoftheassertedkind. Saythatk ≥l. Since Fi ⊆E1∪· · ·∪· · ·∪Ek,
we obtain Fi = (Fi ∩E1) ∪· · · ∪(Fi ∩Ek). Irreducibility of Fi implies that
Fi = Fi ∩Ej(i) for some j = j(i). Hence Fi ⊆Ej(i) for some function j(i)
from {1, . . . ,l} to {1, . . . , k}. Reversing the roles of the Ei’s and the Fj’s yields
a function i( j) such that Ej ⊆Fi( j). Then Fi ⊆Ej(i) ⊆Fi( j(i)). Since no Fi
contains some Fi′ with i′ ̸= i, we conclude that i( j(i)) = i for all i. Therefore
k = l, and i( · ) and j( · ) are inverse to each other.
□
Corollary 10.6. Every afﬁne algebraic set in An can be expressed uniquely as
the ﬁnite (possibly empty) union of afﬁne varieties in such a way that none of the
varieties contains another of the varieties.
REMARKS. For example,
V (X2 −Y 2) = V (X + Y) ∪V (X −Y)
by Proposition 10.1c, and the afﬁne algebraic set on the left side is expressed as
the union of the afﬁne varieties on the right.
PROOF. We saw before Proposition 10.5 that An is a Noetherian topological
space, andCorollary10.4showsthattheirreduciblesubsetsaretheafﬁnevarieties.
The closed sets are the afﬁne algebraic sets by deﬁnition, and hence the result is
a special case of Proposition 10.5.
□
The geometric dimension of a nonempty closed subset E of a Noetherian
topological space X is the supremum of the integers d ≥0 such that there exists
a strictly increasing chain E0 ⫋E1 ⫋· · · ⫋Ed of irreducible closed subsets
of E. This deﬁnition makes sense because a chain with d = 0 can always be
formed with E0 equal to one of the irreducible closed sets from Proposition 10.5;

566
X. Methods of Algebraic Geometry
however, there is no guarantee in this generality that the geometric dimension
will be ﬁnite. In any event, it is clear from the deﬁnition that if two closed sets
E and E′ have E ⊆E′, then the geometric dimension of E is ≤the geometric
dimension of E′.
In the case of a nonempty afﬁne algebraic set V (S), the geometric dimension
of V (S) is to refer to this kind of dimension relative to the Zariski topology.
EXAMPLES OF GEOMETRIC DIMENSION IN An.
(1) Any one-point set in An is closed and plainly has geometric dimension 0.
Any afﬁne variety V with more than one point has geometric dimension ≥1,
since {P} ⫋V is a strictly increasing chain of irreducible closed sets if P is
chosen as a point in V .
(2) An has geometric dimension n. This fact will follow from Theorem 10.7
below because A has Krull dimension n as a consequence of Theorem 7.22.
(3) Twisted cubic in A3, namely {(x, x2, x3) | x ∈k}. According to the
example in Section 1, this is V (p) for the prime ideal p = (Y −X2, Z −X3) ⊆
k[X, Y, Z]. The inclusions of prime ideals (X, Y, Z) ⫌(Y −X2, Z −X3) ⫌
(Y −X2) ⫌0 give the strictly increasing chain {0} ⫋V (p) ⫋{(x, x2, z)} ⫋A3,
which is of the kind described for A3. If another term could be included between
{0} and V (p), then we would obtain a sequence showing that A3 has geometric
dimension ≥4, in contradiction to Example 2. So V (p) has geometric dimension
≤1. In view of Example 1, V (p) has geometric dimension equal to 1.
Theorem 10.7. If a is any proper ideal of A, then the following four quantities
are equal:
(a) the geometric dimension of V (a),
(b) the Krull dimension of A
√a ,
(c) the maximum of the geometric dimension of Vj over all afﬁne varieties
Vj contained in V (a),
(d) the Krull dimension of A/a.
REMARKS. We take these equal quantities as the deﬁnition of the dimension
dim V (a) of the afﬁne algebraic set V (a).
Because of Theorem 7.22, these
quantities equal the transcendence degree over k of the ﬁeld of fractions of A/a
in the case that a is a prime ideal. For a = 0, we know that dim A = n; hence
the equal quantities in the theorem are ≤n.
PROOF. Let
E0 ⊆E1 ⊆· · · ⊆Ed
(∗)
be an increasing chain of irreducible closed subsets of V (a), and deﬁne pj to be
the ideal pj = I (Ej). Then each pj is a prime ideal by Corollary 10.4, and also
pd ⊆· · · ⊆p1 ⊆p0
(∗∗)

2. Geometric Dimension
567
because I ( · ) is inclusion reversing. If (∗) is strictly increasing, then so is (∗∗); in
fact, if pj were to equal pj−1 for some j, then we would have Ej = V (I (Ej)) =
V (pj) = V (pj−1) = V (I (Ej−1)) = Ej−1, contradiction. In (∗), we have Ed ⊆
V (a), and thus Proposition 10.3a gives √a = I (V (a)) ⊆I (Ed) = pd. In other
words, any strictly increasing sequence (∗) of irreducible closed subsets of V (a)
yields a strictly increasing sequence (∗∗) of prime ideals of A that contain √a .
Conversely if (∗∗) is a strictly increasing sequence of prime ideals of A con-
taining √a , and if we deﬁne Ej = V (pj) for 0 ≤j ≤d, then we obtain the
sequence (∗) of irreducible closed subsets of V (√a ) = V (a), and (∗) is strictly
increasing, since an equality Ej = Ej−1 would imply that pj = I (V (pj)) =
I (Ej) = I (Ej−1) = I (V (pj−1)) = pj−1 because of Proposition 10.3a.
Thus the strictly increasing sequences (∗) of irreducible closed subsets of V (a)
areinone-onecorrespondencewiththestrictlyincreasingsequences(∗∗)ofprime
ideals of A containing √a . Let ϕ : A →A
√a be the quotient homomorphism.
Application of ϕ to (∗∗) yields a strictly increasing sequence of ideals of A
√a
by the First Isomorphism Theorem, and prime ideals map to prime ideals under
this correspondence. Thus the existence of a strictly increasing sequence as in
(∗∗) implies that the Krull dimension of A
√a is ≥d. Meanwhile, the existence
of a strictly increasing sequence as in (∗) implies that the geometric dimension of
V (a) is ≥d. We have seen that these sequences are in one-one correspondence,
and therefore the equality of (a) and (b) in the theorem follows.
In (c) certainly the geometric dimension of any Vj is ≤the geometric dimension
of V (a). If d0 denotes the geometric dimension of V (a), then we can ﬁnd a strictly
increasing chain as in (∗) with d = d0 and with all the sets contained in V (a).
Corollary 10.4 shows that Ed0 is an afﬁne variety contained in V (a), and the
sequence (∗) shows that the geometric dimension of Ed0 is at least d0. Thus
Vj = Ed0 is an afﬁne variety contained in V (a) whose geometric dimension
equals that of V (a).
To complete the proof, we show the equality of (b) and (d), i.e., we show that
A/a and A
√a have the same Krull dimension. Since a ⊆√a , it is enough to
show that in any strictly increasing sequence of prime ideals as in (∗∗) such that
all the ideals contain a, all the ideals actually contain √a . (Then the sequences
(∗∗) for a will be in one-one correspondence with the sequences for √a , and we
can argue using the First Isomorphism Theorem as in the third paragraph of the
proof.) Thus let x be in √a . By deﬁnition of radical, xk lies in a for some k.
Since a ⊆pd, xk lies in pd. But pd is prime, and therefore x lies in pd. Thus
every ideal in the sequence (∗∗) for a occurs in the sequence (∗∗) for √a , and
the theorem follows.
□
The dimension of an irreducible hypersurface in A = k[X1, . . . , Xn] is n −1,
as was observed in Section VII.5. Proposition 10.9 below will prove a converse.

568
X. Methods of Algebraic Geometry
Lemma 10.8. Every minimal nonzero prime ideal in A is principal.
PROOF. Let p be a minimal nonzero prime ideal, let f ̸= 0 be a nonzero
member, and write f as the product of irreducible elements. Since p is prime,
one of the irreducible elements, say g, lies in p. Since A is a unique factorization
domain, g is prime. Consequently (g) is a prime ideal of A lying in p. By
minimality of p, p = (g).
□
Proposition 10.9.
Suppose that p is a prime ideal of A and V (p) is the
corresponding afﬁne variety. If dim V (p) = n −1, then p is principal, and hence
V (p) is an irreducible hypersurface.
PROOF. For any n ≥1, dim V (p) = n −1 < n = dim V (0) implies p ̸= 0.
Since dim V (p) = n −1, there exists a chain
0 = q0 ⫋q1 ⫋· · · ⫋qn−1
of prime ideals in A/p. If ϕ : A →A/p denotes the quotient homomorphism,
then this chain lifts to A as
0 ⫋p ⫋ϕ−1(q1) ⫋· · · ⫋ϕ−1(qn−1).
This chain has n members after the 0 at the left, and A has Krull dimension n.
Consequently the ﬁrst nonzero element, which is p, is a minimal nonzero prime
ideal of A. By Lemma 10.8, p is principal.
□
A quasi-afﬁne varietyisany nonempty Zariski open subset of an afﬁne variety.
These sets and their projective analogs, which will be deﬁned in Section 3, will be
the main objects of interest geometrically in Sections 1–6. If Y is a quasi-afﬁne
variety, then the closure Y is the afﬁne variety in question because any nonempty
relatively open subset of an afﬁne variety is dense in the variety.7
Let us see that the relative Zariski topology on a quasi-afﬁne variety Y makes
Y into a Noetherian topological space. In fact, if X is a Noetherian topological
space and Y is a topological subspace, then Y is Noetherian. To see this, we
argue by contradiction, letting E1 ⊇E2 ⊇· · · be a strictly decreasing sequence
of relatively closed sets in Y.
Then the sequence of closures in X forms a
decreasing sequence of closed sets in X with the property that Ej = Y ∩Ej for
each j because Ej is assumed to be relatively closed in Y. It follows that the
sequence of closures is strictly decreasing, contradiction.
Consequently any quasi-afﬁne variety Y is Noetherian in the relative Zariski
topology and has a meaningful geometric dimension. We write dimY for this
dimension.
7This important observation was made just before Proposition 10.5.

2. Geometric Dimension
569
Lemma 10.10. If Y is a quasi-afﬁne variety in An and if E is a nonempty
relatively closed subset of Y, then E is irreducible8 for Y if and only if E is
irreducible for An.
REMARKS. We shall actually prove the stronger result that if Y is a nonempty
open subset of a Noetherian topological space X (such as An) and if E is a
nonempty relatively closed subset of Y, then E is irreducible for Y if and only if
E is irreducible for X. This stronger result will be used in Section 3.
PROOF. First we check that E reducible implies E reducible. If E is reducible,
say is a union E = E1 ∪E2 with E1 and E2 relatively closed proper subsets of
E, then E = E1 ∪E2. Each of E1 and E2 is a closed subset of E. To see that
E1 is proper, we argue by contradiction. If E1 = E, then intersecting both sides
with Y gives the contradiction E1 = Y ∩E1 = Y ∩E = E because E1 and E
are both relatively closed. Similarly E2 is proper, and thus E is reducible.
Conversely suppose that E is reducible, say is a union E = F1 ∪F2 with F1
and F2 closed in X and properly contained in E. Intersecting both sides with
Y gives E = Y ∩E = Y ∩(F1 ∪F2) = (Y ∩F1) ∪(Y ∩F2) because E is
relatively closed. The sets Y ∩F1 and Y ∩F2 are relatively closed, and their
union is E. To see that E is reducible, we argue by contradiction. If Y ∩F1 = E,
then E ⊆F1. Since F1 is closed in X, E ⊆F1. Thus F1 is not a proper subset
of E, contradiction. Similarly we cannot have Y ∩F2 = E, and therefore E
is exhibited as the union of the two proper relatively closed subsets Y ∩F1 and
Y ∩F2.
□
Proposition 10.11. If Y is a quasi-afﬁne variety in An, then dim Y = dim Y.
Here dim Y refers to the dimension of the afﬁne variety Y in any of the senses of
Theorem 10.7.
REMARKS. This proposition is a formal consequence of Lemma 10.10. The
stronger statement that we actually prove is that if Y is a nonempty open subset
of a Noetherian topological space X, then the geometric dimension of Y as a
Noetherian space equals the geometric dimension of X as a Noetherian space.
PROOF. Let E0 ⊆E1 ⊆· · · ⊆Ed beastrictlyincreasingsequenceofrelatively
closed irreducible subsets of Y. Then E0 ⊆E1 ⊆· · · ⊆Ed is an increasing
sequence of closed subsets of An, each of which is irreducible by Lemma 10.10.
Since Ej = Y ∩Ej for each j, the sets Ej are strictly increasing. Since the given
sequence of sets Ej is arbitrary, it follows that dim Y ≤dim Y.
For the reverse inequality, let F0 ⊆F1 ⊆· · · ⊆Fd be a strictly increasing
sequence of irreducible closed subsets of Y. If Ej denotes Fj ∩Y, then E0 ⊆
8 . . . in the sense of not being the union of two relatively closed proper subsets.

570
X. Methods of Algebraic Geometry
E1 ⊆· · · ⊆Ed is an increasing sequence of relatively closed subsets of Y,
each of which is irreducible by Lemma 10.10. Since Fj = Ej, the sets Ej are
strictly increasing. Since the given sequence of sets Fj is arbitrary, it follows that
dim Y ≤dim Y.
□
3. Projective Algebraic Sets and Projective Varieties
We continue to assume that k is an algebraically closed ﬁeld and to write A
for k[X1, . . . , Xn]. In Section VIII.3 we studied the projective analogs of afﬁne
plane curves, and the task for the present section is to study similarly the projective
analogs of general afﬁne algebraic sets, afﬁne varieties, and quasi-afﬁne varieties.
As in Section VIII.3, projective n-space over k is deﬁned set theoretically as
the quotient
Pn =

(x0, . . . , xn) ∈kn+1 −{0}

∼,
where (x′
0, . . . , x′
n) ∼(x0, . . . , xn) if (x′
0, . . . , x′
n) = λ(x0, . . . , xn) for some
λ ∈k×. We write [x0, . . . , xn] for the class of (x0, . . . , xn) in Pn.
Put A = k[X0, . . . , Xn]. The polynomials of interest for algebraic geometry
relative to Pn are the homogeneous polynomials in A. The deﬁnitions of “mono-
mial,” “total degree” of a monomial, “homogeneous polynomial,” and “degree” of
a homogeneous polynomial all appear in Section VIII.3; monomials are deﬁned so
as to have coefﬁcient 1. By convention the 0 polynomial is homogeneous of every
degree. We write Ad = k[X0, . . . , Xn]d for the k vector space of homogeneous
polynomials of degree d. Each member F of Ad satisﬁes
F(λx0, . . . , λxn) = λd F(x0, . . . , xn)
for all (x0, . . . , xn) ∈kn+1 and λ ∈k×. Conversely the fact that the mapping of
polynomials into polynomial functions is one-one for an inﬁnite ﬁeld implies that
a member F of A is homogeneous of degree d if it satisﬁes the above displayed
property. Four further properties of Ad from Section VIII.3 are that
• the zero locus of a member of Ad is well deﬁned as a subset of Pn,
• the monomials of total degree d form a k basis of the vector space Ad,
• dimk Ad =
d+n
n

,
• any polynomial factor of a homogeneous polynomial over a ﬁeld k is
homogeneous.
An ideal a in A is called a homogeneous ideal if it is the vector-space
sum over d ≥0 of its intersections with Ad: a = !∞
d=0 (a ∩Ad). Any ideal
in A that is generated by homogeneous polynomials is a homogeneous ideal. A
special case of this fact is that if a k vector subspace ad of Ad is speciﬁed for each

3. Projective Algebraic Sets and Projective Varieties
571
integer d ≥0, then a = !∞
d=0 ad is a homogeneous ideal if and only if for each
d ≥0 and e ≥0, the inclusion F Ad ⊆Ad+e holds for each F in Ae.
We can now imitate some of the development of Sections 1 and 2 for the
present context as long as we stick to homogeneous polynomials in A and to
homogeneous ideals. For any homogeneous polynomial F in A, the set
V (F) =

P = [x0, . . . , xn] ∈Pn | F(x0, . . . , xn) = 0

is well deﬁned by the ﬁrst bulleted property above.
Thus if S is any set of
homogeneous elements in A, we can associate the locus of common zeros in Pn,
or zero locus, of the members of S by the formula
V (S) = 
F∈S
V (F).
If a is a homogeneous ideal, then V (a) by convention means V (S), where S is
the subset of all homogeneous members of a. Any such set V (S) is called a
projective algebraic set in Pn. The function S 	→V (S) is inclusion reversing.
The analog of Proposition 10.1 in the present context is that projective algebraic
sets have the following properties:
(i) V (∅) = V (0) = Pn and V (A) = ∅,
(ii) V
 
α Sα

= 
α V (Sα) if the Sα’s are arbitrary sets of homogeneous
elements in A,
(iii) V (S) = V (S1) ∪V (S2) if S1 and S2 are sets of homogeneous elements
in A and if S is deﬁned as the set of all products F1F2 with F1 ∈S1 and
F2 ∈S2.
Consequentlythe projective algebraic setsinPn form the closedsetsfora topology
on Pn called the Zariski topology on Pn.
Next we associate to each point P of Pn a homogeneous ideal I (P) in A by
the deﬁnition
I (P) =

F ∈A | F(x0, . . . , xn) = 0 whenever [x0, . . . , xn] = P

.
Problem 1 at the end of the chapter shows that I (P) is indeed a homogeneous
ideal. In terms of the ideals I (P), we deﬁne I (E) = 
P∈E I (P) for each
subset E of Pn. The result E 	→I (E) is a function carrying subsets E of Pn to
homogeneous ideals I (E) in An. The function E 	→I (E) is inclusion reversing,
and the same argument as for Proposition 10.2 shows that for each n it satisﬁes
(i) I (∅) = A and I (Pn) = 0,
(ii) I (E1 ∪E2) = I (E1) ∩I (E2) if E1 and E2 are subsets of Pn,
(iii) I (E1 ∩E2) ⊇I (E1) + I (E2) if E1 and E2 are subsets of Pn.

572
X. Methods of Algebraic Geometry
If S is any set of homogeneous elements in A and if V = V (S) is the
corresponding projective algebraic set in Pn, then we deﬁne the cone over V
to be the subset of An+1 given by
C(V ) = (0, . . . , 0) ∪

(x0, . . . , xn) ∈An+1 | [x0, . . . , xn] ∈V

.
This kind of set has the following two properties:
(i) V nonempty implies that the ideals I (C(V )) and I (V ) in A are equal,
(ii) any homogeneous ideal a in A with V (a) nonempty in Pn has C(V (a))
equal to the subset V (a) in afﬁne (n + 1)-space.
Use of this device reduces a number of questions about Pn to questions about
An+1. An example is a projective analog of Proposition 10.3, which appears as
the next proposition.
Proposition 10.12. For ﬁxed n,
(a) (homogeneous Nullstellensatz) a homogeneous ideal a in A has V (a)
empty in Pn if and only if there is an integer N such that a contains Ak
for k ≥N,
(b) I (V (a)) = √a for each homogeneous ideal a in A for which V (a) is
nonempty in Pn,
(c) V (I (E)) = E for each subset E of Pn, where E is the Zariski closure of
E in Pn.
REMARK. For clarity in the proof, let us write Va( · ) and Vp( · ) to distinguish
zero loci in An+1 from zero loci in Pn.
PROOF. For (a), Vp(a) is empty in Pn if and only if Va(a) is contained in
{0} in An+1, if and only if √a = I (Va(a)) contains (X0, . . . , Xn) by the afﬁne
Nullstellensatz. In this case if f1, . . . , fr are generators of √a , then the elements
f m
1 , . . . , f m
r
are in a for some m, and it follows that
 	r
j=1 cr fj
k lies in a for
all scalars cj whenever k ≥rm; hence Ak ⊆a for k ≥rm. Conversely if √a
fails to contain some X j, then Xk
j is not in a for any k ≥1, and Ak cannot be
contained in a.
For (b), Ip(Vp(a)) = Ia(C(Vp(a))) = Ia(Va(a)) = √a by (i) of cones, (ii) of
cones, and the afﬁne Nullstellensatz.
Conclusion (c) is proved by the same argument as for Proposition 10.3b.
□
A projective variety is any nonempty9 projective algebraic set of the form
V (p), where p is a prime homogeneous ideal in A. If the ideal p is the principal
9The prime homogeneous ideal p = (X0, . . . , Xn) has V (p) = ∅, but no other prime homoge-
neous ideal q has V (q) = ∅. In order to avoid trivial counterexamples to some results, we shall
often want to exclude this particular prime ideal p from consideration.

3. Projective Algebraic Sets and Projective Varieties
573
ideal generated by an irreducible homogeneous polynomial, then the ideal or the
variety is called an irreducible projective hypersurface.10
Corollary 10.13. The projective varieties in Pn are characterized as those
nonempty Zariski closed sets that cannot be written as the union of two proper
closed subsets.
REMARK. Such a subset of Pn is said to be irreducible. As in the afﬁne case,
irreducible sets are understood to be nonempty.
PROOF. If V (p) is a projective variety, then the union of {0} and the subset
of kn+1 whose equivalence classes are in V (p) is an afﬁne variety in An+1. It is
irreducibleinAn+1, andthisirreducibilityinAn+1 impliesirreducibilitywithinPn.
Conversely if E is an irreducible closed subset of Pn and if F and G are
homogeneous members of A with FG in I (E), then we can argue as in the proof
of Corollary 10.4 to see that one of F and G lies in I (E) and that I (E) is proper.
Since I (E) is a homogeneous ideal, this fact implies that I (E) is prime.
□
Since A is a Noetherian ring, it follows that Pn is a Noetherian topological
space in the sense of Section 2. Consequently Proposition 10.5 is applicable.
Combining this result with Corollary 10.13, we obtain the following corollary.
Corollary 10.14.
Every projective algebraic set in Pn can be expressed
uniquely as the ﬁnite (possibly empty) union of projective varieties in such a
way that none of the varieties contains another of the varieties.
Geometric dimension is therefore meaningful for nonempty projective alge-
braic sets, and each such set in Pn has geometric dimension ≤n.
A quasiprojective variety is any nonempty Zariski open subset of a projective
variety.
Quasi-afﬁne varieties and quasiprojective varieties will be the main
objects of interest geometrically in Sections 1–7. If Y is a quasiprojective variety,
then the relative Zariski topology on Y makes Y into a Noetherian topological
space, just as in the quasi-afﬁne case. ConsequentlyY has a meaningful geometric
dimension. The arguments in Lemma 10.10 and Proposition 10.11 concerning
quasi-afﬁne varieties are arguments in point-set topology and valid proofs of facts
about quasiprojective varieties. Therefore we obtain the following result.
Proposition 10.15. If Y is a quasiprojective variety in Pn, then the closure Y
in the Zariski topology of Pn is a projective variety, and the geometric dimensions
of Y and Y are equal.
10As in the afﬁne case, as long as the assumption of irreducibility is in force, the distinction
between the ideal and the variety is unimportant.

574
X. Methods of Algebraic Geometry
We can identify An as a subset of Pn by the formula
β0(x1, . . . , xn) = [1, x1, . . . , xn]
for (x1, . . . , xn) in An.
The complement of β0(An) in Pn is the zero locus
of the homogeneous polynomial X0, and consequently β0(An) is open in Pn.
Since the equality Pn = V (0) exhibits Pn as a projective variety, β0(An) is a
quasiprojective variety. We are going to show that β0 respects topologies in that
the Zariski topology of An is carried to the Zariski topology of the quasiprojective
variety β0(An). To do so, we make use of the corresponding transpose mapping
βt
0 : A →A on polynomials given by βt
0F = f with
f (X1, . . . , Xn) = F(β0(X1, . . . , Xn)) = F(1, X1, . . . , Xn).
This is the substitution homomorphism that ﬁxes k, ﬁxes X1, . . . , Xn, and carries
X0 to 1. Being an algebra homomorphism onto, βt
0 carries ideals of A to ideals
of A. In particular, it carries homogeneous ideals of A to ideals of A.
Lemma 10.16. If a is a homogeneous ideal in A and b = βt
0(a) is its image
under βt
0, then βt
0 carries the set of homogeneous elements of a onto b.
PROOF. Every member of b is the sum of the images under βt
0 of ﬁnitely many
homogeneous members of a. If F1, . . . , Fk are these homogeneous members,
then it is enough to produce G1, . . . , Gk in a all homogeneous of the same degree
such that βt
0(Fj) = βt
0(Gj) for all j. If d1, . . . , dk are the respective degrees of
F1, . . . , Fk and if d = max(d1, . . . , dk), then the elements Gj = X
d−dj
0
Fj have
the required properties.
□
Lemma 10.17. Let a be a homogeneous ideal of A, and let b be the ideal of A
given by b = βt
0(a). Then β0(V (b)) = V (a) ∩β0(An).
PROOF. If (x1, . . . , xn) is in V (b) and if F is a homogeneous member of a,
then f = βt
0(F) is in b with 0 = f (x1, . . . , xn) = F(β0(x1, . . . , xn)). Since F
is arbitrary, β0(x1, . . . , xn) is in V (a). Thus β0(V (b)) ⊆V (a) ∩β0(An).
For the reverse inclusion, let [1, x1, . . . , xn] be in V (a) ∩β0(An). If f is
in b, ﬁnd by Lemma 10.16 a homogeneous F in a with βt
0F = f .
Since
[1, x1, . . . , xn] is in V (a), F(1, x1, . . . , xn) = 0. Therefore f (x1, . . . , xn) =
F(β0(x1, . . . , xn)) = F(1, x1, . . . , xn) = 0. Since f is arbitrary in b, the point
(x1, . . . , xn) is in V (b), and β0(V (b)) ⊇V (a) ∩β0(An).
□
Proposition 10.18. Under the inclusion β0 : An →Pn, the Zariski topology
of afﬁne n-space An coincides with the relative topology from Pn.

3. Projective Algebraic Sets and Projective Varieties
575
PROOF. If we start from an afﬁne algebraic set V (b) in An, then Lemma 10.17
shows that β0(V (b)) = V (a)∩β0(An) for the homogeneous ideal a = (βt
0)−1(b)
in A. Since V (a) is Zariski closed in Pn, β0(V (b)) is exhibited as closed in the
relative topology on β0(An).
Conversely suppose that C is closed in the relative topology on β0(An). Then
it is of the form 
C ∩β0(An) for some projective algebraic set 
C. The set 
C is of
the form V (a) for some homogeneous ideal a. If b = βt
0(a), then Lemma 10.17
shows that
β0(V (b)) = V (a) ∩β0(An) = 
C ∩β0(An) = C,
and C is exhibited as βt
0 of an afﬁne algebraic set in An.
□
Corollary 10.19. If V is a quasi-afﬁne variety in An, then β0(V ) is a quasipro-
jective variety in Pn. Moreover, the geometric dimension of V as a quasi-afﬁne
variety equals the geometric dimension of β0(V ) as a quasiprojective variety.
REMARKS. In other words, the closure β0(V ) is a projective variety. It is called
the projective closure of the quasi-afﬁne variety V . If V is actually an afﬁne
variety, then it has an associated prime ideal in A, and the projective variety β0(V )
has an associated homogeneous prime ideal in A. The correspondence between
the prime ideal in A and the homogeneous prime ideal in A will be examined
shortly.
PROOF. Because of the homeomorphism given by Proposition 10.18, Lemma
10.10 as restated in the lemma’s remarks applies with Y = β0(An), X = Pn, and
E equal to the closure of V in An. The conclusion is that the closure of E in Pn
is a projective variety, and the ﬁrst conclusion of the corollary is proved. The
second conclusion is immediate from the version of Proposition 10.11 mentioned
in the remarks with that proposition.
□
To each index i with 0 ≤i ≤n, we can associate in a similar way a function
βi : An →Pn. The formula for βi is βi(x1, . . . , xn) = [y0, . . . , yn], where
yj = xj+1 for j < i, yi = 1, and yj = xj for j > i. Just as in Proposition 10.18,
under each βi, the Zariski topology of afﬁne n-space An coincides with the relative
topology from Pn. One consequence is that the notion of projective closure is
meaningful if formed relative to anyβi in place of β0. Another consequence is that
Pn has a covering by n + 1 open sets βi(An) that are each Zariski homeomorphic
to An. The functions βi may be viewed as playing a role similar to the inverses
of charts in the deﬁnition of a smooth manifold.
Having used β0 to associate a projective variety in Pn to each afﬁne variety in
An by passage to the topological closure, we turn to what happens with ideals.

576
X. Methods of Algebraic Geometry
Distinct homogeneous ideals in A can map under βt
0 to the same ideal in A; for
example the principal ideals (1) and (X0) in A both map to (1) in A. Theorem
10.20 will show that we can associate a particularly nice ideal of A to each ideal
of A in such a way that prime ideals of A correspond to those nice ideals of A
that are prime. Under this correspondence the ideals for an afﬁne variety and its
projective closure will match. It will be apparent from the construction in the
proof that the ideal of A is generated by all homogeneous polynomials F = F( f )
of the form
F(X0, . . . , Xn) = Xd
0 f (X1/X0, . . . , Xn/X0)
whenever f ̸= 0 is in the ideal of A and deg f = d.
Theorem 10.20. As a mapping of ideals in A to ideals in A, βt
0 is one-one
from the setI of all homogeneous ideals a of A such that X0F ∈a implies F ∈a
onto the set I of all ideals of A. Under this one-one correspondence prime ideals
correspond to prime ideals.
PROOF. We are going to construct a two-sided inverse to the mapping induced
by βt
0 from ideals inI to ideals in I.
Let A≤d be the k vector space of all members of A, including the 0 polynomial,
of degree ≤d. The homomorphism βt
0 carries Ad linearly into A≤d, and it carries
the basis of homogeneous monomials in A of total degree d onto the basis of all
monomials in A of total degree ≤d. Thus βt
0 : Ad →A≤d is one-one onto.
Observe for any f in A≤d that the formula
F(X0, . . . , Xn) = Xd
0 f (X1/X0, . . . , Xn/X0)
deﬁnes a member of Ad. If we write F = ϕd( f ) when f and F are related in this
way, then the function ϕd is a one-one k linear map from A≤d into Ad such that
ϕdβt
0 is the identity on Ad. Because of ﬁnite dimensionality, βt
0 : Ad →A≤d and
ϕd : A≤d →Ad are two-sided inverses of one another.
Suppose that an ideal b in A is given. Deﬁne ad = ϕd(b ∩A≤d), and put
a = !∞
d=0 ad. According to remarks in the paragraph with the deﬁnition of
homogeneous ideal, a is a homogeneous ideal if Gad ⊆ad+e whenever G is in
Ae. Deﬁne g = βt
0(G). This polynomial has deg g ≤e and ϕe(g) = G, since
ϕe : A≤e →Ae is a two-sided inverse of βt
0 : Ae →A≤e. If f is in b∩A≤d, then
g f is in b ∩A≤(d+e), and thus Gϕd( f ) = ϕe(g)ϕd( f ) = ϕd+e(g f ) is in ad+e.
This proves that a is a homogeneous ideal in A.
Under the construction b 	→a, let us see that a is in I.
If X0F is in
ad+1, then we can write X0F = ϕd+1(g) for some g in b ∩A≤d+1.
That
is, X0F(X0, . . . , Xn) = Xd+1
0
g(X1/X0, . . . , Xn/X0). Then F(X0, . . . , Xn) =
Xd
0 g(X1/X0, . . . , Xn/X0). This formula shows that g is in A≤d and that F =

3. Projective Algebraic Sets and Projective Varieties
577
ϕd(g). Hence F is in ad. In other words, the construction b 	→a carries members
of I to members ofI.
Under the construction b 	→a, the homogeneous ideal a has the property that
βt
0(a) = βt
0
 ∞
!
d=0
ad

=
∞
	
d=0
βt
0(ad) =
∞
	
d=0
(b ∩A≤d) = b.
Thus our construction starting from an ideal of A, passing to an ideal in the set
I, and passing back to an ideal of A recovers the original ideal of A.
Now suppose that a is inI. Put b = βt
0(a). To see that the above passage to a
member ofI recovers a from b, we are to show that
a ∩Ad = ϕd(b ∩A≤d).
(∗)
First we establish that
βt
0(a ∩Ad) = βt
0(a) ∩A≤d.
(∗∗)
The inclusion ⊆in (∗∗) is easy because βt
0(a ∩Ad) ⊆βt
0(a) and βt
0(Ad) ⊆A≤d.
For the reverse inclusion, let f be in βt
0(a ∩Ak) ∩A≤d for some k. This means
that deg f ≤d and that f = βt
0(G) with G ∈a ∩Ak. Without loss of generality,
we may assume that k ≥d. Let F be the element F = ϕdeg f ( f ) of Adeg f .
Then Xk−deg f
0
F = ϕk( f ), and βt
0(Xk−deg f
0
F) = βt
0ϕk( f ) = f = βt
0(G). Hence
Xk−deg f
0
F and G are members of Ak with the same value under βt
0. Since βt
0 is
one-one on Ak, G = Xk−deg f
0
F. Since G is in a and since the ideal a is inI, F is
in a. Hence the element Xd−deg f
0
F is in a ∩Ad, and it has βt
0(Xd−deg f
0
F) = f .
This proves the inclusion ⊇in (∗∗). Application of ϕd to both sides of (∗∗)
proves (∗) and completes the proof of the ﬁrst statement of the theorem.
We are to show that prime ideals correspond to prime ideals. Let b in I be
prime, and let a be the ideal inI with βt
0(a) = b. Let F and G be homogeneous
elements in A of respective degrees d and e with FG in a. Then f g lies in b,
where f = βt
0(F) and g = βt
0(G), and one of f and g lies in b because b is
prime. Say f is in b. Then F = ϕd( f ) lies in the right side of (∗) and hence lies
in the left side. Consequently F is in a, and a is prime.
Conversely let a in I be prime, and let b = βt
0(a). Suppose that f and g are
members of A with f g in b. Put d = deg f and e = deg g, and deﬁne F = ϕd( f )
and G = ϕe(g). Then FG = ϕd+e( f g) is in ϕd+e(b ∩A≤d+e), and (∗) shows
that FG is in a ∩Ad+e. Since a is prime, one of F and G is in a. Say that F is
in a. Then f = βt
0(F) is in b, and b is prime.
□

578
X. Methods of Algebraic Geometry
Corollary 10.21. The inclusion β0 : An →Pn sets up a one-one correspon-
dence between the prime ideals in A and those prime homogeneous ideals in A
that do not contain X0.
PROOF. If a is a prime homogeneous ideal in A and X0F is in a, then either
X0 or F is in a. If we can always exclude X0 from being in a, then F is in a, and
the condition in the proposition for a to be inI is satisﬁed. The rest follows from
Theorem 10.20.
□
Corollary 10.22. Let a be a prime homogeneous ideal of A not containing
X0, and let b = βt
0(a) be the corresponding prime ideal of A. Then the Zariski
closure in Pn of β0(V (b)) is V (a).
REMARKS. In other words, if an afﬁne variety V has b as its ideal in A, then
the projective closure of V has the corresponding a from Theorem 10.20 as its
ideal in A.
PROOF. Corollary 10.19 shows that β0(V (b)) = V (a′) for some prime homo-
geneous ideal of A. Since β0(V (b)) ⊆V (a) by Lemma 10.17 and since V (a) is
closed in Pn, V (a′) ⊆V (a). Arguing by contradiction, suppose that the inclusion
is strict. Applying I ( · ) and using Proposition 10.12b, we obtain a′ ⊇a. Since
application of V ( · ) to both sides of a′ ⊇a has to yield a strict inclusion, we must
have a′ ⫌a. Choose G homogeneous in a′ that is not in a, and put f = βt
0G. If
(x1, . . . , xn) is in V (b), then [1, x1, . . . , xn] is in β0(V (b)) ⊆V (a′), and hence
f (x1, . . . , xn) = G(1, x1, . . . , xn) = 0. Thus f is in I (V (b)) = b. Since
deg f ≤deg G, the construction of a from b in the proof of Theorem 10.20
shows that F = ϕdeg G( f ) is in a. Then G and F are members of Adeg G with
βt
0(G) = f = βt
0(F), and we obtain G = F, contradiction.
□
EXAMPLE. Twisted cubic from the example in Section 1 and Example 2 in
Section 2. The prime ideal b ⊆k[X, Y, Z] is (Y −X2, Z −X3), and we want
to ﬁnd the corresponding ideal a given by Corollary 10.21. Let the additional
indeterminate in A be W. Applying ϕ2 and ϕ3 to the respective generators Y −X2
and Z −X3 yields WY −X2 and W 2Z −X3. These must be in a. So must
(W 2Z −X3) −X(WY −X2) = W(W Z −XY)
X(W 2Z −X3) −(WY + X2)(WY −X2) = W 2(X Z −Y 2).
and
Since we seek a prime ideal for a and W is not to be in a, W Z −XY and X Z −Y 2
are in a. Thus a ⊇(WY −X2, W Z −XY, X Z −Y 2). If c denotes the ideal on
the right, then a ⊇c and
βt
0(c) = (Y −X2, Z −XY, X Z −Y 2)
= (Y −X2, Z −X3, X Z −X4) = (Y −X2, Z −X3) = βt
0(a).

4. Rational Functions and Regular Functions
579
To show that a = c, it is enough according to Theorem 10.20 to show that if F
is homogeneous and W F is in c, then F is in c. The three generators of c are all
in A2, and thus c ∩Ad = Ad−2(c ∩A2). Hence it is enough to show that c ∩A2
contains no nonzero element divisible by W. Since c ∩A2 consists of all linear
combinations of the three generators, we can check this fact by inspection. The
result is that a = c. Once we know a, we can compute the projective closure of the
twisted cubic from Corollary 10.22. We ﬁnd that it consists of all [w, x, y, z] of
the form [1, x, x2, x3] together with [0, 0, 0, 1]. We might have guessed this form
for the projective closure from the parametric realization of the twisted cubic inA3
and from a passage to the limit, but proceeding in that fashion requires operations
that we have certainly not justiﬁed.
4. Rational Functions and Regular Functions
We continue to assume that k is an algebraically closed ﬁeld and to write A for
k[X1, . . . , Xn] and A for k[X0, . . . , Xn]. In this section we investigate certain
classes of k-valued functions on quasiprojective varieties, speciﬁcally the “ra-
tional” functions, the “regular” functions, and the local ring of functions regular
at a particular point. For each kind of variety that we have introduced (afﬁne,
quasi-afﬁne, projective, and quasiprojective), there are simple global deﬁnitions
and there are complicated but equivalent local deﬁnitions for these notions. The
complicated deﬁnitions have three advantages over the simple ones: they are
virtually the same for all four kinds of varieties and therefore make it possible
to work with all kinds of varieties uniformly, they make it possible in practice to
construct a function by constructing only a local part of it, and they prepare the
way better for a deﬁnition of isomorphism of varieties that does not insist on a
particular dimension for the ambient afﬁne or projective space.
In this section we shall ﬁrst give the simple deﬁnitions in the afﬁne and
quasi-afﬁne cases and then prove results saying that certain more complicated
local-sounding versions of these deﬁnitions amount to the same thing as the
simple deﬁnitions. Then we shall give the simple deﬁnitions in the projective and
quasiprojective cases. Finally we shall relate the quasi-afﬁne and quasiprojective
cases and show that certain more complicated local-sounding deﬁnitions in the
quasiprojective case amount to the same thing as the simple deﬁnitions.
We begin with afﬁne varieties. Suppose that V = V (p) is an afﬁne variety in
An, p being a prime ideal in A. The afﬁne coordinate ring of V is A(V ) = A/p,
which is an integral domain. Let us write the quotient homomorphism A →A(V )
as a 	→¯a. Because of the Nullstellensatz, A(V ) can be identiﬁed with the ring of
all restrictions of polynomials to V ; in particular, ¯a(P) is meaningful for every
¯a ∈A(V ) and P ∈V .

580
X. Methods of Algebraic Geometry
Proposition 10.23. If V is an afﬁne variety in An, then the points P of V are
in one-one correspondence with the maximal ideals mP of the afﬁne coordinate
ring A(V ), the correspondence being that mP is the maximal ideal of all members
¯a of A(V ) with ¯a(P) = 0.
PROOF. Each mP is a maximal ideal, being the kernel of a multiplicative
linear functional. In the reverse direction, if m is a maximal ideal of A(V ),
then its inverse image in A under the homomorphism A →A/p = A(V ) is a
maximal ideal M of A containing p, by the First Isomorphism Theorem. The
Nullstellensatz shows that M consists of all polynomials vanishing at some point
P. Applying V ( · ) to the inclusion M ⊇p gives {P} = V (M) ⊆V (p) = V .
Thus P is in V .
□
Members of the ﬁeld of fractions k(V ) of A(V ) are called rational functions
on V , and k(V ) is called the function ﬁeld on V . Rational functions on V are
not really functions on V in the traditional sense, since their denominators can
vanish here and there. By way of compensation, an allowable denominator never
vanishes identically; the reason is that the construction of a ﬁeld of fractions
of an integral domain does not involve using the zero element of the integral
domain in a denominator. If f is a rational function on V and P is in V , one
says that f is regular at P, or deﬁned at P, if there exist ¯a and ¯b in A(V )
with ¯b(P) ̸= 0 such that f = ¯a/¯b.
In this case, an equality ¯a/¯b = ¯a′/¯b′
with ¯b(P) ̸= 0 and ¯b′(P) ̸= 0 implies that ¯a ¯b′ = ¯a′ ¯b, from which we see that
¯a(P)¯b′(P) = ¯a′(P)¯b(P) and that ¯a(P)/¯b(P) = ¯a′(P)/¯b′(P). Hence f (P) can
be deﬁned unambiguously as f (P) = ¯a(P)/¯b(P). For P in V , the set of rational
functions on V that are regular at P is a k algebra, as we see by carrying out the
usual manipulations to add or multiply fractions. This k algebra is denoted by
OP(V ). It has A(V ) ⊆OP(V ) ⊆k(V ).
As in Proposition 10.23, let mP be the maximal ideal of all members ¯a of A(V )
with ¯a(P) = 0. The localization of A(V ) with respect to this maximal ideal is
exactly OP(V ). In fact, the localization is a subring of k(V ) because A(V ) is an
integral domain. The members of OP(V ) are exactly the quotients f = ¯a/¯b with
¯a and ¯b in A(V ) and with ¯b not in mP. Hence OP(V ) = S−1A(V ), where S is
the set-theoretic complement of mP. Thus OP(V ) is the asserted localization. It
has a unique maximal ideal and is called the local ring of V at P.
A rational function is said to be regular on an open subset U of V if it is
regular at every point of U. The regular functions on U form a k algebra denoted
by O(U). In symbols the deﬁnition of O(U) is O(U) = 
P∈V OP(V ).
When A(V ) is a unique factorization domain, the deﬁnition of regular at a
point is simple enough to implement globally: we write f = ¯a/¯b in some
fashion, reduce the fraction to lowest terms, and then read off all the points P
for which f is deﬁned from the single expression of f as a quotient. Ordinarily,

4. Rational Functions and Regular Functions
581
however, A(V ) is not a unique factorization domain, and then the deﬁnition is
more subtle, as the following example shows.
EXAMPLE. V = V (p) with p = (XW −Y Z) and n = 4. The polynomial
XW −Y Z is irreducible, and thus V is an afﬁne variety in A4.
The afﬁne
coordinate ring is A(V ) = k[W, X, Y, Z]/(XW −Y Z). The quotient f = X/Y
is a rational function on V , since Y is not the 0 element of A(V ), and the deﬁnition
shows that f is regular at all points (w, x, y, z) of V having y ̸= 0. From
X W −Y Z = 0, we have X/Y = Z/W, and thus f is deﬁned also at all points
(w, x, y, z) of V having w ̸= 0. For example it is deﬁned at the additional point
(w, x, y, z)=(1, 0, 0, 0). Actually, there exist no members ¯a and ¯b of A(V ) with
f = ¯a/¯b and ¯b(w, x, y, z) ̸= 0 whenever xw = yz and one or both of w and y
are nonzero. The details are carried out in Problem 8 at the end of the chapter.
The set of points P in the afﬁne variety V at which a rational function f on V
fails to be regular is called the pole set of f .
Proposition 10.24. If f is a rational function on the afﬁne variety V = V (p),
then the pole set of f is the afﬁne algebraic set V (a) ⊆V (p) corresponding to
the ideal a ⊇p of all b ∈A such that ¯b f is in A(V ).
PROOF. The set a in the statement is an ideal in A that contains p. Hence
V (a) ⊆V (p). If P is in V (p) and f is deﬁned at P, then there are members ¯a
and ¯b of A(V ) with ¯b(P) ̸= 0 such that ¯b f = ¯a; any representative of this ¯b in A
lies in a, and consequently P is not in V (a). Conversely if f is not deﬁned at P,
then no ¯b such that ¯b f is in A(V ) has ¯b(P) ̸= 0. That is, no member b of a has
¯b(P) ̸= 0. So P is in V (a). This proves that the pole set of f is exactly V (a). □
Corollary 10.25. If V = V (p) is an afﬁne variety, then
A(V ) = 
P∈V
OP(V ).
REMARKS. In the notation introduced above, the corollary says that A(V ) =
O(V ).
PROOF. The inclusion ⊆follows from the fact that A(V ) ⊆OP(V ) for each
P. For the reverse inclusion, suppose that f lies in 
P∈V OP(V ). Then the
pole set of f in V is empty. The pole set for f is the set V (a) for the ideal a in
Proposition 10.24, and it follows from the Nullstellensatz that a = A. Then 1 is
in a, and the deﬁnition of a shows that f is in A(V ).
□
If we consider the complement of the pole set of f , then we see from Propo-
sition 10.24 that the subset of V at which f is regular is (relatively) open in V .
Hence it is empty or dense in V . On the set where f is regular, f is continuous
into A1, according to the following proposition.

582
X. Methods of Algebraic Geometry
Proposition 10.26. If a rational function f on the afﬁne variety V is regular
on the nonempty open set U of V , then it is continuous from U into A1 with the
Zariski topology (in which the proper closed sets are the ﬁnite sets).
PROOF. It is to be proved that f −1 of any ﬁnite subset of A1 is relatively closed
in U. Since the ﬁnite union of closed sets is closed, it is enough to consider
f −1({c}) for an element c of k. This is the intersection with U of the pole set of
1/( f −c), which is relatively closed in U by Proposition 10.24.
□
Now we can give the simple deﬁnitions in the quasi-afﬁne case. Let the quasi-
afﬁne variety U in An have closure the afﬁne variety V . If f is a rational function
on V , then Proposition 10.24 shows that f is regular on a nonempty open subset
of V . Since the intersection of any two nonempty open subsets is nonempty, f
is regular on a nonempty open subset of U. Therefore it is meaningful to view f
as a rational function on U. We deﬁne the function ﬁeld of rational functions
on U to be the same as the function ﬁeld of V : k(U) = k(V ). The deﬁnition of
regular function at P is the same for the quasi-afﬁne variety U as for its Zariski
closure V , and thus the local ring of U at P is given by OP(U) = OP(V ). A
rational function is said to be regular on the quasi-afﬁne variety U if it is regular
at every point of U. Since k(U) = k(V ), the set of regular functions on U is the
k algebra O(U) = 
P∈U OP(U).
The next step is to prove results saying that certain more complicated local-
sounding deﬁnitions of the above notions amount to the same thing.
Lemma 10.27. If V is an afﬁne variety, then any two members of the afﬁne
coordinate ring A(V ) that are equal on a nonempty open subset of V are the same.
PROOF. Subtracting, we may suppose that ¯a ∈A(V ) is 0 on the nonempty
open subset U of V . By Proposition 10.26, ¯a is continuous from V into A1. The
complement of ¯a−1({0}) has to be open in V and disjoint from U, and therefore
it is empty. So ¯a is everywhere 0 and is the 0 element of A(V ).
□
Proposition 10.28. Let U be a nonempty open subset of the afﬁne variety V
in An. Suppose that f0 : U →k is a function with the following property: for
each P in U, there exist an open subset W of U containing P and polynomials
a and b in A such that b is nowhere vanishing on W and f0 = a/b on W. Then
there exists one and only one member f of k(V ) such that f is regular on U and
agrees with f0 at every point of U.
REMARKS. For the quasi-afﬁne case the more complicated local-sounding
deﬁnition of “regular function” on U, mentioned in the ﬁrst paragraph of this
section, is what is assumed of f0 in the statement of this proposition.
The
proposition says that such an f0 necessarily comes from a global rational function
on V that is regular on U in the sense just above.

4. Rational Functions and Regular Functions
583
PROOF OF UNIQUENESS. If there are two such members of k(V ), then sub-
tracting them gives a member g of k(V ) that is 0 on U. By deﬁnition of k(V ),
g = ¯a/¯b with ¯a and ¯b in A(V ) with with ¯b ̸= 0. Then ¯a = g ¯b is a member of
A(V ) that is 0 on U. By Lemma 10.27, ¯a = 0 in A(V ). Thus g ¯b = 0 in k(V ).
Since k(V ) is a ﬁeld and ¯b ̸= 0, g = 0.
□
PROOF OF EXISTENCE. If P is in U, then the hypothesis supplies some open
subset W of U containing P and members a and b of A with b nowhere 0 on W
and with f0 = a/b on W. Let ¯a and ¯b be the images of a and b in A(V ). Since b
is not identically 0 on U, ¯b is not the 0 element of A(V ). Therefore f = ¯a/¯b is
a well-deﬁned member of k(V ), and it is regular on W and agrees with f0 there.
If we start with another point P′ and an open subset W ′ of U containing P′, then
we similarly obtain f ′ = ¯a′/¯b′ in k(V ) that is regular on W ′ and agrees with
f0 there. The open subset W ∩W ′ is nonempty, and ¯a/¯b = ¯a′/¯b′ on W ∩W ′.
Therefore ¯b′ ¯a = ¯b¯a′ on W ∩W ′. By Lemma 10.27, ¯b′ ¯a = ¯b¯a′ as members of
A(V ). Dividing, we obtain f = f ′. Since the member f of k(V ) is regular on
an open neighborhood of each point of U, it is regular on U.
□
Proposition 10.28 allows us also to give a local-sounding deﬁnition of rational
function and see that it reduces to the original deﬁnition. Speciﬁcally we consider
pairs (U0, f0) with U0 nonempty open in the quasi-afﬁne variety U and with f0
satisfying the regularity condition on U0 in the proposition.11 Say that the pair
(U0, f0) is equivalent to the pair (U1, f1) if f0 = f1 on U0 ∩U1. This relation is
reﬂexive and symmetric. Let us see from the proposition why it is transitive. If
(U0, f0) is equivalent to (U1, f1), then the existence part of the proposition yields
three members of k(V )—one for (U0, f0), one for (U0∩U1, f0) = (U0∩U1, f1),
and one for (U1, f1). The uniqueness part shows that the ﬁrst two members of
k(V ) are equal and the last two are equal. Hence they are all equal. Now if
(U0, f0) is equivalent to (U1, f1) and (U1, f1) is equivalent to (U2, f2), then we
routinely ﬁnd that (U0 ∩U1, f0) is equivalent to (U1 ∩U2, f2). From what we
have just seen, (U0, f0) is equivalent to (U2, f2), and the relation is therefore
transitive. We could take the union of all the sets U0 appearing in the pairs
within an equivalence class and obtain the largest domain within U on which
the rational function in question is regular. This notion for a rational function will
not be too useful for us, but an analogous notion for rational maps in Section 6
will be quite handy.
In similar fashion the local ring OP(U) can be formulated in terms of “germs”
of regular functions as follows. Fix P in U, and consider all pairs (U0, f0) such
that U0 is an open subset of U containing P and f0 is a scalar-valued function on
11That is, for each P in U0, there exist an open subset W of U0 containing P and polynomials a
and b in A such that b is nowhere vanishing on W and f0 = a/b on W.

584
X. Methods of Algebraic Geometry
U0 satisfying the regularity condition onU0 in the proposition.12 Say that (U0, f0)
is equivalent to (U1, f1) if f0 = f1 on some open neighborhood of U containing
P. It is easy to see that the result is an equivalence relation. An equivalence
class is called a germ of regular functions at P. Germs inherit a natural addition,
scalar multiplication, and multiplication, and the set of germs at P is therefore a
k algebra. The use of germs is the traditional device in mathematics for isolating
local behavior of functions in arbitrarily small neighborhoods of points.
Corollary 10.29.
Let U be a nonempty open subset of the afﬁne variety
V in An, and let P be in U.
To each germ {(U0, f0)} of regular functions
at P corresponds one and only one member f of k(V ) that is associated via
Proposition 10.28 to each pair (U0, f0). Moreover, this correspondence is a k
algebra isomorphism of the ring of germs onto the local ring OP(U).
PROOF. If (U0, f0) and (U ′
0, f ′
0) are two pairs in a germ at P, then the deﬁnition
of germ gives a pair (W, g0) such that W is a neighborhood of P contained in
U0 ∩U ′
0 and g agrees with f0 and f ′
0 on W. Proposition 10.28 supplies unique
members f , f ′, and g of k(V ) such that f is regular on U0 and agrees with f0
there, such that f ′ is regular on U ′
0 and agrees with f ′
0 there, and such that g is
regular on W and agrees with g0 there. The uniqueness in the proposition shows
that f = g and that g = f ′. Therefore f = f ′. So we have a well-deﬁned map
of germs into k(V ).
The image f of the pair (U0, f0) is a member of k(V ) that is regular on U0,
hence is deﬁned at P. Thus the map on germs is into OP(U). It is a k algebra
homomorphism because of the deﬁnitions of the operations on germs. If the germ
of (U0, f0) maps to 0, then f0 is the 0 function on U0, and any representative
(W, g0) of the germ with W ⊆U0 has g0 equal to the 0 function on W. Thus the
germ is the 0 germ, and the k algebra homomorphism is one-one. Finally if f is a
member of OP(U), then f = ¯a/¯b with ¯a and ¯b in A(V ) and with ¯b nonvanishing
at P. By Proposition 10.26, ¯b is nonvanishing on some open neighborhood U0
of P. Then the germ of (U0, f0) maps to f if f0 is deﬁned as the restriction of
¯a/¯b to U0. Therefore the k algebra homomorphism is onto OP(U).
□
This completes the discussion of the deﬁnitions in the cases of afﬁne and quasi-
afﬁne varieties. Next we consider projective varieties, beginning with the simple
deﬁnitions. Let V = V (p) be a projective variety, p being a prime homogeneous
ideal in A different from !
d≥1 Ad. The integral domain A(V ) = A/p is called
the homogeneous coordinate ring of V . Since p is homogeneous, we can write
A(V ) as
A(V ) =
∞
!
d=0
Ad

(Ad ∩p) =
∞
!
d=0
A(V )d.
12See the previous footnote.

4. Rational Functions and Regular Functions
585
Let us write the quotient homomorphism A →A(V ) as F 	→F. We say that F
is homogeneous of degree d if it lies in A(V )d = Ad

(Ad ∩p).
Despite Proposition 10.12, homogeneous members of A(V ) do not yield well-
deﬁned functions on V , and we cannot simply imitate the afﬁne case in deﬁning
the function ﬁeld of V . The function ﬁeld k(V ) of V is a certain proper subﬁeld
of the ﬁeld of fractions of A(V ), namely the set of all quotients F/G with F and G
homogeneous of the same degree and with G ̸= 0. If the common degree of F and
G is d, then the quotient F/G is homogeneous of degree 0 in (x0, . . . , xn) and is
therefore well-deﬁned on the equivalence class [x0, . . . , xn] in Pn. Such quotients
form a ﬁeld because if F1 and G1 are homogeneous of degree d and F2 and G2 are
homogeneous of degree e, then F1/G1 + F2/G2 = (F1 G2 + G1 F2)/(G1 G2)
and (F1 F2)/(G1 G2) are each the quotient of two members of A(V ) that are
homogeneous of degree d + e, the denominator not being the zero element, and
because the inverse of F/G is G/F.
Elements of k(V ) are called rational
functions on V .
Although the values of homogeneous members of A are not meaningful on
Pn, the zero locus of such a polynomial is well deﬁned. If F is a member of
the quotient A(V ) homogeneous of degree d, then its set of preimages in Ad
is F + (Ad ∩p). The members of Ad ∩p all vanish at every point of V , and
therefore whether F vanishes at a point P of V depends only on the coset of F in
A(V ). Accordingly, a member h of k(V ) is said to be regular at the point P =
[x0, . . . , xn] of V , or deﬁned at P, if h can be written as a quotient h = F/G of
homogeneous members of A(V ) of the same degree in such a way that G(P) ̸= 0.
In this case, h(P) is well deﬁned as the quotient F(x0, . . . , xn)/G(x0, . . . , xn)
for any (x0, . . . , xn) representing the point P = [x0, . . . , xn].
The set of points P in the projective variety V at which a rational function h
on V fails to be regular is called the pole set of h. The proof of the following
result is similar to the proof of Proposition 10.24 and is therefore omitted.
Proposition 10.30. If h is a rational function on the projective variety V =
V (p), then the pole set of h is the projective algebraic set V (a) ⊆V (p) corre-
sponding to the homogeneous ideal a ⊇p generated by all homogeneous G ∈A
such that Gh is in A(V ).
As in the case of afﬁne varieties, the set of members of k(V ) regular at P in V
is a k subalgebra of k(V ) called the local ring of V at P and denoted by OP(V ).
Corollary 10.31. If V = V (p) is a projective variety, then
k = 
P∈V
OP(V ).

586
X. Methods of Algebraic Geometry
REMARKS. The classical prototype of this corollary is that a rational function
without poles on the Riemann sphere is constant. A direct proof of this fact for the
Riemann sphere in the style of this book follows by applying Proposition 6.9 to
the sum of the given rational function and any constant function. A generalization
appears as Corollary 9.4.
PROOF. The inclusion ⊆is automatic. For the reverse inclusion, suppose that
the rational function h on V lies in 
P∈V OP(V ). Then the pole set of h in V
is empty. The pole set for h is the set V (a) for the ideal a in Proposition 10.30,
and it follows from the homogeneous Nullstellensatz (Proposition 10.12a) that
AN ⊆a for all N sufﬁciently large. For any such N, A(V )N h lies in A(V ). It is
homogeneous of degree N and hence is in A(V )N. Iterating this inclusion gives
A(V )N hk ⊆A(V )N
for all k ≥0.
(∗)
Since V is nonempty, some X j is not in p; to ﬁx the notation, let us suppose
that X0 is not in p. Then X0 ̸= 0. Inclusion (∗) shows that X0
Nhk lies in A(V )
for all k ≥0. Thus hk lies in the subset X0
−N A(V ) of the ﬁeld of fractions of
A(V ), and the ring A(V )[h], given by the substitution homomorphism X 	→h
applied to the polynomial ring A(V )[X], is exhibited as an A(V ) submodule of
the ﬁnitely generated A(V ) module X0
−N A(V ) of the ﬁeld of fractions of A(V ).
Since A(V ) is Noetherian as a homomorphic image of A, A(V )[h] is a ﬁnitely
generated A(V ) module. By Proposition 8.35 of Basic Algebra, h is a root of
some monic polynomial in A(V )[X]. Say that h satisﬁes
hl + cl−1hl−1 + · · · + c1h + c0 = 0
with each cj in A(V ). Decomposing each term into homogeneous parts and
equating to 0 the sum of the terms homogeneous of degree 0 shows that we can
assume each cj to be in A(V )0 = k. That is, we may assume that h is algebraic
over k. Since k is algebraically closed, h is in k.
□
Ifweconsiderthecomplementofthepolesetofh, thenweseefromProposition
10.30 that the subset of V at which h is regular is open in V . Hence it is empty
or dense in V . On the set where h is regular, h is continuous into A1, according
to the following proposition, whose proof is the same as for Proposition 10.26.
Proposition 10.32. If a rational function h on the projective variety V is
regular on the nonempty open set U of V , then it is continuous from U into A1
with the Zariski topology (in which the proper closed sets are the ﬁnite sets).

4. Rational Functions and Regular Functions
587
The procedure for extending the above remarks from projective varieties to
quasiprojective varieties is the same as for extending the earlier remarks from
afﬁne varieties to quasi-afﬁne varieties. Let the quasiprojective variety U in Pn
have closure the projective variety V . If h is a rational function on V , then
Proposition 10.32 shows that h is regular on a nonempty open subset of V . Since
the intersection of any two nonempty open subsets is nonempty, h is regular on
a nonempty open subset of U. Therefore it is meaningful to view h as a rational
function on U. Thus we deﬁne the function ﬁeld of U to be the same as the
function ﬁeld of V : k(U) = k(V ). The deﬁnition of regular function at P is
the same for the quasiprojective variety U as for its Zariski closure V , and thus
the local ring of U at P is given by OP(U) = OP(V ). A rational function is
said to be regular on the quasiprojective variety U if it is regular at every point
of U. The set of regular functions on U is a k algebra denoted by O(U). Thus
O(U) = 
P∈U
OP(U).
For the special case that U = V , Corollary 10.31 shows that O(V ) reduces to the
constants.
The next step is to check that the simple deﬁnitions in this section in the afﬁne
and quasi-afﬁne cases are consistent with the simple deﬁnitions in the projective
and quasi-projective cases. Proposition 10.18 and Corollary 10.19 tell us the
extent of the overlap—that any of the mappings βj : An →Pn with 0 ≤j ≤n
allows us to identify any quasi-afﬁne variety with a quasiprojective variety. Thus
what we need to show is that the deﬁnitions of function ﬁeld, functions regular at
a point, and functions regular on a variety amount to the same thing for a quasi-
afﬁne variety U and for the quasiprojective variety βj(U). For concreteness we
shall take j = 0.
Corollaries 10.21 and 10.22 tell us exactly what we are to compare. The prime
ideals a of A not containing X0 are in one-one correspondence with the prime
ideals b of A, the correspondence being b = βt
0(a), and the Zariski closure of
V (βt
0(b)) in Pn is V (a). The correspondence does not yield a natural map of b
into a. Instead, the system of linear mappings ϕd : A≤d →Ad given by
F(X0, . . . , Xn) = ϕd( f )(X0, . . . , Xn) = Xd
0 f (X1/X0, . . . , Xn/X0)
is a system of inverses to the system of restrictions βt
0
 Ad : Ad →A≤d of the
homomorphism βt
0 : A →A given by
f (X1, . . . , Xn) = βt
0(F)(X1, . . . , Xn) = F(1, X0, . . . , Xn),

588
X. Methods of Algebraic Geometry
and these systems have the properties that
a ∩Ad = ϕd(b ∩A≤d)
and
βt
0(a ∩Ad) = b ∩A≤d.
Proposition 10.33. Let a prime ideal a of A not containing X0 correspond to
the prime ideal b of A under the formula b = βt
0(a) as in Theorem 10.20, and let
U = V (b) and V = V (a) be the respective afﬁne and projective varieties for b
and a, V being the Zariski closure of β0(U) in Pn. Then βt
0 descends to a ring
homomorphism ψ of A(V ) onto A(U), and ψ in turn induces a canonical ﬁeld
isomorphism  : k(V ) →k(U). Under the ﬁeld isomorphism , the image of
the local ring Oβ0(P)(V ) is OP(U) for each P in U.
PROOF. Since βt
0 carries A onto A and carries a into b, βt
0 descends to a
homomorphism ψ of A/a = A(V ) onto A/b = A(U). If F and G are in
the same homogeneous summand A(V )d of A(V ), then we deﬁne (F/G) =
ψ(F)/ψ(G) as a member of the ﬁeld of fractions k(U) of A(U). If F/G =
F
′/G
′, then F G
′ = F
′ G. Applying ψ, using that ψ is a homomorphism, and
reinterpreting matters in k(U), we see that (F/G) = (F
′/G
′), i.e., that  is
well deﬁned. A similar argument that involves clearing fractions and applying ψ
shows that  respects addition and multiplication. Therefore  is a ﬁeld mapping
of k(V ) into k(U).
Let A(U)≤d be the image of A≤d in A/b = A(U). Since βt
0 carries Ad onto
A≤d and carries a ∩Ad onto b ∩A≤d, ψ carries A(V )d onto A(U)≤d. Any
member of k(U) is the quotient of two members of A(U)≤d for some d, and
it is consequently  of the quotient of the corresponding members of A(V )d.
Therefore  carries k(V ) onto k(U) and is a ﬁeld isomorphism.
Let F and G in A(V ) be the cosets F + a and G + a, let f = βt
0(F) and g =
βt
0(G), and let ¯f and ¯g in A(U) be the cosets of f +b and g+b. Then ψ(F) = ¯f
andψ(G) = ¯g, andhence(F/G) = ¯f / ¯g. Let P = (x1, . . . , xn)beinU, sothat
β0(P) = [1, x1, . . . , xn] is in β0(U). Deﬁne β#
0(P) = (1, x1, . . . , xn) in An+1,
so that the class of β#
0(P) in Pn is β0(P). Then ¯g(P) = g(P) = (βt
0G)(P) =
G(β#
0(P)) = G(β#
0(P)). Therefore ¯f / ¯g lies in OP(U) if and only if F/G lies
in Oβ0(P)(V ). So  carries Oβ0(P)(V ) onto OP(U).
□
Corollary 10.34. Let V be a projective variety, and let U be a nonempty open
subset of V . Then each member of O(U) ⊆k(V ) is determined as an element
in k(V ) by its restriction to U.
PROOF. Subtracting two such members, we may assume that their difference
h is 0 on U. We are to prove that h = 0 in k(V ). For some j with 0 ≤j ≤n,
βj(An) ∩V is nonempty, and we may assume that this is the case for j = 0.
The subset V0 = β−1
0 (V ) of An is an afﬁne variety. Since U and β0(An) ∩V are

4. Rational Functions and Regular Functions
589
nonempty open subsets of V , their intersection is nonempty, and U0 = β−1
0 (U) is
a nonempty open subset of V0. Let  : k(V ) →k(V0) be the ﬁeld isomorphism
in Proposition 10.33. By assumption, h is in Oβ0(P)(V ) for every P in U0. Since
the value of h at P is 0, h is actually in the maximal ideal of Oβ0(P)(V ) for P
in U0. Proposition 10.33 shows that (h) is in the maximal ideal of OP(V0) for
all P in U0. Fix P0 in U0. Then we can write the member (h) of k(V0) as
(h) = ¯a/¯b with ¯b(P0) ̸= 0. Since ¯b is continuous on V0 by Proposition 10.26,
¯b(P) is nonzero for all P in some neighborhood W of P0 contained in U0. Then
the formula (h) = ¯a/¯b shows explicitly that (h) is deﬁned at such points
P and satisﬁes (h)(P) = ¯a(P)/¯b(P). Since (h) is in the maximal ideal of
OP(V0) for all P in U0, (h)(P) = 0 for P in W. Hence ¯a(P) = 0 for P in
W. Consequently ¯a and 0 are two members of A(V ) that are equal on W, and
Lemma 10.27 allows us to conclude that ¯a = 0. Therefore h = 0.
□
Proposition 10.35. Let U be a nonempty open subset of the projective variety
V in Pn. Suppose that h0 : U →k is a function with the following property: for
each P in U, there exist an open subset W of U containing P and homogeneous
polynomials F and G in A of the same degree such that G is nowhere vanishing
on W and h0 = F/G on W. Then there exists one and only one member h of
k(V ) such that h is regular on U and agrees with h0 at every point of U.
REMARKS. For the quasiprojective case the more complicated local-sounding
deﬁnition of “regular function” on U, mentioned in the ﬁrst paragraph of this
section, is what is assumed of h0 in the statement of this proposition.
The
proposition says that such an h0 necessarily comes from a global rational function
on V that is regular on U in the sense just above.
PROOF. For each j with 0 ≤j ≤n such that Vj = βj(An) ∩V is nonempty,
β−1
j (Vj) is an afﬁne variety, and Uj = U ∩Vj is a nonempty open subset such that
hj,0 = h0

Uj is a function on Uj with the following property: for each P in Uj,
there exist an open subset W of Uj containing P and homogeneous polynomials
F and G in A of the same degree such that G is nowhere vanishing on W and
hj,0 = F/G on W. We pull back this situation by β−1
j , writing βt
jhj,0 for the
function on β−1
j (W) given by (βt
jhj,0)(Q) = hj,0(βj(Q)). The set β−1
j (Vj) is an
afﬁne variety, and the Zariski closure of Vj in Pn is V . The homomorphism βt
j on
A descends to a ring homomorphism ψj : A(V ) →A(β−1
j (Vj)), and ψj induces
a ﬁeld isomorphism j : k(V ) →k(β−1
j (Vj)), according to Proposition 10.33.
The set β−1
j (Uj) is a nonempty open subset of the afﬁne variety β−1
j (Vj),
and βt
jhj,0 is a function on β−1
j (Uj) with the following property: for each P in
β−1
j (Uj), there exist an open subset W of β−1
j (Uj) containing P and homogeneous

590
X. Methods of Algebraic Geometry
polynomials F and G in A of the same degree such that their images F and G
in A(V ) have G nowhere vanishing on W and have βt
jhj,0 = ψj(F)/ψj(G) =
(F/G) on W. Proposition 10.33 says that ψj(F) = ¯a and ψj(G) = ¯b for
members ¯a and ¯b of A(β−1
j (Vj)). We are in the situation of Proposition 10.28 with
f0 = βt
jhj,0, and that proposition produces a unique member hj of k(β−1
j (Vj))
that is regular on β−1
j (Uj) and agrees with βt
jhj,0 at every point of β−1
j (Uj).
The member h of k(V ) that we seek is h = −1
j (hj). To verify this assertion,
we are to show that −1
j (hj) is independent of j. Thus suppose that Vi ∩Vj ̸= ∅.
Fix P in Ui ∩Uj = U ∩Vi ∩Vj, and choose the above open neighborhood W
of P small enough for the above construction to apply for both indices i and j.
By the uniqueness in Proposition 10.28, hj is the unique member of k(β−1
j (Vj))
that is regular on β−1
j (W) and agrees with βt
jhj,0 = βt
j(h0

Uj) at every point of
β−1
j (W). Thus −1
j (hj) = F/G on W, where F and G are as in the previous
paragraph. By the same uniqueness argument, −1
i
(hi) = F/G on W. The
difference −1
i
(hi) −−1
j (hj) is a member of k(V ) that is regular on W and
vanishes there. By Corollary 10.34, the difference is 0 as an element of k(V ).
Therefore −1
j (hj) is independent of j, and we can take h to be this member of
k(V ).
□
Just as in the quasi-afﬁne case, it is possible in the quasiprojective case to give
a local-sounding deﬁnition of rational function and a formulation of OP(U) in
terms of germs. We shall not use these notions, and we omit any further discussion
of them.
5. Morphisms
The goal of this section and the next is to introduce maps that make the collection
of all quasiprojective varieties over an algebraically closed ﬁeld k into the objects
of a category in a way that does not depend on the ambient space An or Pn of
the variety. These maps will all be algebraic in nature, and there will be two
choices of which class of maps to use, one involving good denominators and
one allowing occasional bad denominators. The ﬁrst kind of map will be called
a “morphism,” and the second kind of map will be called a “dominant rational
map.” The relationships between these two kinds of maps and the interpretation
of these maps in terms of function ﬁelds will be of great importance in applying
this theory.
A variety over the algebraically closed ﬁeld k henceforth will be any afﬁne,
quasi-afﬁne, projective, or quasiprojective variety as in the previous sections. To

5. Morphisms
591
each such variety V , Section 4 associates a function ﬁeld k(V ), a local ring
OP(V ) ⊆k(V ) of regular functions at each point P, and a ring O(E) =

P∈E OP(V ) ⊆k(V ) of regular functions on each nonempty open subset E
of V . We have observed that each rational function on a variety V is regular on
some nonempty open subset of V , namely the complement of the pole set. One
further fact that we shall use about rational functions is the following.
Proposition 10.36. If P and Q are distinct points of a variety V , then there
exists a rational function h ∈k(V ) such that h is deﬁned at both P and Q, has
h(P) = 0, and has h(Q) ̸= 0.
PROOF. Without loss of generality, we may assume that V is projective. Say
that V ⊆Pn. Let p be the prime homogeneous ideal in A = k[X0, . . . , Xn] such
that A(V ) = A/p, and let F 	→F be the quotient homomorphism A 	→A(V ).
Let P = [x0, . . . , xn] and Q = [y0, . . . , yn]. Choose a homogeneous polynomial
F in A such that F(x0, . . . , xn) = 0 and F(y0, . . . , yn) ̸= 0, and choose a
homogeneous polynomial G with deg G = deg F such that G(x0, . . . , xn) ̸= 0
and G(y0, . . . , yn) ̸= 0.
Then G is not 0, and h = F/G has the required
properties.
□
If U and V are varieties, then a continuous function ϕ : U →V relative to the
Zariski topology is called a morphism if for each nonempty open subset E of V
and each regular function f on E, the composition f ◦ϕ is a regular function
on the open subset ϕ−1(E) of U. Thus ϕ is to be continuous and is to induce by
composition a function from O(E) into O(ϕ−1(E)) for each open subset E of V .
An isomorphism of varieties is a morphism having an inverse function that is a
morphism.
It is immediate that the composition of two morphisms is a morphism and that
the identity function is a morphism. Thus the varieties over k form a category if
morphisms are used as the maps.
EXAMPLES OF MORPHISMS. Suppose that k has characteristic different from 2.
Let U be P1, written as
P1 =

[s, t] | (s, t) ̸= (0, 0)

,
and let V be the projective variety in P2 deﬁned by the irreducible homogeneous
polynomial X2 + Y 2 −Z2, i.e.,
V =

[x, y, z] | x2 + y2 = z2 and (x, y, z) ̸= (0, 0, 0)

.
Let ϕ : U →V be the function given by
ϕ

[s, t]

= [s2 −t2, 2st, s2 + t2].

592
X. Methods of Algebraic Geometry
This is well deﬁned, and it is continuous because the Zariski closed proper subsets
of V are the ﬁnite sets, whose inverse images are ﬁnite sets. If F and G are
two homogeneous members of k[X, Y, Z] and if F and G are the images in
A(V ) = k[X, Y, Z]/(X2 + Y 2 −Z2), we are to assume that G is not 0, i.e., that
G is not divisible by X2 + Y 2 −Z2, and then h = F/G is a typical rational
function on V . We are to show that if h is regular on an open subset E of V , then
h ◦ϕ is regular on ϕ−1(E) ⊆P1. The expression h = F/G exhibits h as regular
on the open set E of points [x, y, z] of V with G(x, y, z) ̸= 0. The set ϕ−1(E)
is the set of points [s, t] in P1 with G(s2 −t2, 2st, s2 + t2) ̸= 0. At such points
the function h ◦ϕ is given by
(h ◦ϕ)(s, t) = F(s2 −t2, 2st, s2 + t2)/G(s2 −t2, 2st, s2 + t2),
and it is given by a rational expression with nonvanishing denominator. Thus ϕ
is a morphism.
Let us see that ψ : V →P1 given by
ψ[x, y, z] =
 [x + z, y]
if [x, y, z] ̸= [1, 0, −1],
[−y, x −z]
if [x, y, z] ̸= [1, 0, 1]
consistently deﬁnes another morphism.
For the consistency we observe that
x2 + y2 = z2 implies that (x + z)(x −z) = −y2; hence on the common domain
of the two expressions, [x + z, y] = [−y2/(x −z), y] = [−y/(x −z), 1] =
[−y, x −z]. Continuity of ψ follows because the inverse image of any ﬁnite set
is a ﬁnite set. For the regularity we observe that if F and G are homogeneous
members of the same degree in A(P1) = k[S, T ] with G ̸= 0 and if h = F/G,
then the expression h = F/G exhibits h as regular on the open set E of points
[s, t] in P1 with G(s, t) ̸= 0. The set ψ−1(E) is the set of points [x, y, z] on V
with G(x + z, y) ̸= 0. At such points the function h ◦ψ is given by
(h ◦ψ)[x, y, z] = F(x + z, y)/G(x + z, y),
and it is given by a rational expression with a nonvanishing denominator. Thus
ψ is a morphism. In other words, ϕ is an isomorphism.
Proposition 10.37. Let β0 : An →Pn be the usual inclusion. If U is a
quasi-afﬁne variety in An, then β0 is an isomorphism of the quasi-afﬁne variety
U onto the quasiprojective variety β0(U).
PROOF. Proposition 10.18 shows that β0 is a homeomorphism of U onto its
image. The last conclusion of Proposition 10.33 implies that the regular functions
for U match those for β0(U) under β0, and the result follows.
□

5. Morphisms
593
Theorem 10.38. Let U be any variety, let V be any afﬁne variety, and let
A(V ) be the afﬁne coordinate ring of V . Then the morphisms ϕ : U →V are in
one-one correspondence with the k algebra homomorphisms ϕ : A(V ) →O(U)
via the formula
ϕ( f ) = f ◦ϕ
for f ∈A(V ).
REMARKS. Members f of A(V ) lie in O(V ). The k algebra homomorphism
ϕ is meaningful because the fact that ϕ is a morphism implies that f ◦ϕ is in
O(ϕ−1(E)) for every open E in V ; here we take E = V and ϕ−1(E) = U. The
proof of Theorem 10.38 will be preceded by a lemma.
Lemma 10.39. If U is a variety and V is an afﬁne variety in An, then a function
ψ : U →V is a morphism if and only if Xi ◦ψ is a regular function on U for
the image Xi in A(V ) of each coordinate function Xi with 1 ≤i ≤n.
PROOF. If ψ is a morphism, then the deﬁnition of morphism forces Xi ◦ψ to
be a regular function.
Conversely suppose ψ has the property that each Xi ◦ψ is a regular function.
Then f ◦ψ is a regular function on U for each f in A(V ), since every member
of A(V ) is a polynomial in the elements Xi. If E is a closed set in V , then E is
the locus of common zeros of some set { fα} of polynomials, and ψ−1(E) is the
set of points P such that fα(ψ(P)) = 0 for all α. Hence ψ−1(E) is the locus of
common zeros of a subset { fα ◦ψ} of regular functions on U and is relatively
closed in U. Thus ψ is continuous.
If E is nonempty open in V , then k(E) = k(V ) shows that each regular
function h on E is locally the quotient of members of A(V ) with nonvanishing
denominator. Let us write h = f/g with g nonvanishing near a point of interest.
Then h ◦ψ = ( f ◦ψ)/(g ◦ψ) is exhibited locally as a rational function with
nonvanishing denominator.
□
PROOF OF THEOREM 10.38. Suppose that α : A(V ) →O(U) is a k algebra
homomorphism. Deﬁne ψ : U →V by ψ(P) = (α(X1)(P), . . . , α(Xn)(P)).
Then Xi ◦ψ = α(Xi) is in O(U) by deﬁnition of α, and Lemma 10.39 shows
that ψ is a morphism.
The k algebra homomorphism 
ψ deﬁned by 
ψ( f ) = f ◦ψ has 
ψ(Xi) =
Xi ◦ψ = α(Xi). Since the elements Xi generate A(V ), 
ψ = α. Thus starting
from α, forming ψ, and obtaining 
ψ recovers α. In the reverse direction if we
start from ϕ, form ϕ, and use the construction of the previous paragraph to obtain
ψ, then ψ(P) =

ϕ(X1)(P), . . . , ϕ(Xn)(P)

=

X1(ϕ(P)), . . . Xn(ϕ(P))

=
ϕ(P) for P in U. Hence ψ = ϕ. Thus the function α 	→ψ is a two-sided inverse
of the function ϕ 	→ϕ.
□

594
X. Methods of Algebraic Geometry
Corollary 10.40.
If U and V are afﬁne varieties, then the morphisms
ϕ : U →V are in one-one correspondence with the k algebra homomorphisms
ϕ : A(V ) →A(U) via the formula
ϕ( f ) = f ◦ϕ
for f ∈A(V ).
PROOF. This is immediate from Theorem 10.38, since Corollary 10.25 shows
that O(U) = A(U).
□
Proposition 10.41. IfU and V are varieties and ifϕ : U →V and ψ : U →V
are morphisms such that ϕ

E = ψ

E for some nonempty open set E in U, then
ϕ = ψ.
PROOF. Let h be a rational function on V , and let E′ be the nonempty open
subset of V on which h is regular. Since ϕ and ψ are morphisms, h ◦ϕ and h ◦ψ
are regular on the respective nonempty open subsets ϕ−1(E′) and ψ−1(E′) of U.
The equality ϕ

E = ψ

E shows that h ◦ϕ and h ◦ψ are equal on the nonempty
open subset E ∩ϕ−1(E′)∩ψ−1(E′) of U. The function h ◦ϕ −h ◦ψ is therefore
a rational extension from E ∩ϕ−1(E′) ∩ψ−1(E′) to U of the 0 function, and
Proposition 10.34 shows that h ◦ϕ −h ◦ψ = 0 on U. Therefore h ◦ϕ = h ◦ψ
as elements of k(U) for every h in k(V ).
Arguing by contradiction, suppose that P is a point in U for which ϕ(P) ̸=
ψ(P). Then Proposition 10.36 produces h in k(U) such that h is regular on
an open subset F of V containing ϕ(P) and ψ(P) and has h(ϕ(P)) = 0 and
h(ψ(P)) ̸= 0. Since ϕ and ψ are morphisms, h ◦ϕ and h ◦ψ are regular on the
open set ϕ−1(F) ∩ψ−1(F). Their respective values at P are h(ϕ(P)) = 0 and
h(ψ(P)) ̸= 0. Since h ◦ϕ = h ◦ψ as rational functions, this is a contradiction.
□
Proposition 10.42. Suppose that U and V are varieties and that ϕ : U →V
is a morphism.
If P is in U, then ϕ induces a k algebra homomorphism
ϕ∗
P : Oϕ(P)(V ) →OP(U). Composition of morphisms goes to composition
of these homomorphisms in the reverse order.
Proof. Propositions 10.33 and 10.37 together imply that we may assumeU and
V to be quasi-afﬁne. Let f in k(V ) be deﬁned at ϕ(P). Proposition 10.24 shows
that the set E on which f is regular is open in V . Since ϕ is a morphism and f is
regular on E, f ◦ϕ is regular on the open subset ϕ−1(E) of U. Proposition 10.28,
applied to ϕ−1(E) ⊆U, shows that there exists a unique member F of k(U) that
is regular on ϕ−1(E) and agrees with f ◦ϕ on ϕ−1(E). We put ϕ∗
P( f ) = F.
It is a routine matter to check that ϕ∗
P is a k algebra homomorphism and that
compositions go to compositions in the reverse order.
□

6. Rational Maps
595
6. Rational Maps
This section will introduce a second kind of map that makes the collection of all
(quasiprojective) varieties over the algebraically closed ﬁeld k into a category.
These maps will not be ordinary functions, and the deﬁnition requires some care.
If U and V are varieties over the algebraically closed ﬁeld k, then a rational
map ϕ : U →V is an equivalence class of pairs (E, ϕE), where E is a nonempty
open set of U and ϕE is a morphism of E into V . The equivalence relation on two
such pairs is that (E, ϕE) ∼(E′, ϕE′) if ϕE

E∩E′ = ϕE′
E∩E′. This is meaningful,
since the intersection of any two nonempty open sets is nonempty. The relation
∼is certainly reﬂexive and symmetric, and Proposition 10.41 shows that it is
transitive. We can therefore take the union of the open subsets E such that some
pair (E, ϕE) is in the equivalence class, and ϕ will be deﬁnable as a morphism on
this union. This union is called the largest domain on which ϕ is a morphism.
A morphism from U to V deﬁnes a rational map. But a rational map need not
be an everywhere-deﬁned function, and forming the composition of two rational
maps is problematic. For example, if E is the open subset ofU on which a rational
map ϕ : U →V is deﬁned and F is the open subset of V on which a rational
map ψ : V →W is deﬁned, then it may happen that ϕ(E) is disjoint from F. In
this case the composition ψ ◦ϕ makes no sense.
A rational map ϕ : U →V is said to be dominant if ϕE has dense image in
V for some (and hence every) pair (E, ϕE) in the equivalence class. It is evident
that the composition of two dominant rational maps makes sense as a rational
map. The identity mapping is a dominant rational map, and thus the collection
of all varieties over k becomes a category if the dominant rational maps are used
as the maps of the category.
A birational map is a dominant rational map ϕ : U →V that has a dominant
rational map ψ : V →U as a two-sided inverse. Two varieties admitting a
birational map from the one to the other are said to be birationally equivalent
varieties, or to be birational.
EXAMPLE. The irreducible afﬁne plane curves deﬁned by T 2 −(S4 + 1) and
Y 2−(X3−4X) are birationally equivalent if k has characteristic different from 2.
Birational mappings in the two directions are given by
S = Y
2X
T = Y 2 + 8X
4X2
⎫
⎪⎪⎬
⎪⎪⎭
and
⎧
⎪⎪⎨
⎪⎪⎩
X =
2
T −S2
Y =
4S
T −S2 .
The rational map from (X, Y) to (S, T ) is a morphism on the complement of
(0, 0) in the locus y2 = x3 −4x in A2. The rational map from (S, T ) to (X, Y)
is a morphism on the entire locus t2 = s4 + 1 in A2.

596
X. Methods of Algebraic Geometry
Let ϕ : U →V be a dominant rational map, and let (E, ϕE) be any pair in the
equivalence class ϕ. If f ∈k(V ) is a rational function on V , then the subset F of
V on which f is deﬁned is open and nonempty. So f

F is a regular function on F.
Since ϕE is continuous and has dense image, E′ = ϕ−1
E (F) is a nonempty open
set in E ⊆U. The function ϕE′ is a morphism from E′ into F, and thus f

F ◦ϕE′
is a regular function on E′. We can therefore regard it as a rational function on
U, i.e., a member of k(U). Consequently the dominant rational map ϕ : U →V
induces a function ϕ : k(V ) →k(U) that is easily seen to be a ﬁeld mapping
respecting k. Compositions of dominant rational maps lead to compositions of
such ﬁeld mappings in the reverse order.
EXAMPLE, CONTINUED. The two irreducible afﬁne plane curves in the example
earlier in this section have been observed to be birationally equivalent. In view
of the previous paragraph, their function ﬁelds must be isomorphic. Taking into
account that the genus of a curve, as deﬁned in Section IX.3, depends only on the
function ﬁeld, we see that the two curves must have the same genus. This equality
is conﬁrmed by Example 3 of genus in Section IX.3, which shows that the genus
of k[x, y]/(y2 −p(x)), where p(x) is a square-free polynomial of degree m in
characteristic different from 2, is 1
2m −1 if m is even and is 1
2(m −1) if m is odd.
The two curves under study have m = 4 and m = 3, and the genus is 1 in both
cases.
The main result of this section will be a converse to the construction just made,
showing how to pass from a k algebra homomorphism between function ﬁelds to
a dominant rational map in the reverse order. We require two lemmas.
Lemma 10.43. Let V = V ( f ) be the hypersurface13 in An deﬁned by a non-
constant polynomial f in k[X1, . . . , Xn]. Then the open set An −V is isomorphic
to an afﬁne variety, speciﬁcally to the hypersurface in An+1 corresponding to the
irreducible polynomial Xn+1 f (X1, . . . , Xn) −1 in k[X1, . . . , Xn+1].
REMARKS. Even though f is not assumed irreducible, Xn+1 f −1 is irreducible.
In fact, consideration of the degree in Xn+1 shows that the only possible nontrivial
factorization is of the form (Xn+1a −b)(c) with a, b, c in k[X1, . . . , Xn]. Then
bc = 1, and c has to be scalar. The open set An −V is a quasi-afﬁne variety
(having closure An), and the lemma therefore asserts that this quasi-afﬁne variety
is isomorphic to a certain afﬁne variety in An+1.
PROOF. Let W = V (Xn+1 f −1). Let ϕ : W →An be the map deﬁned by
ϕ(x1, . . . , xn+1) = (x1, . . . , xn)for(x1, . . . , xn+1)in W. Then X j◦ϕ isprojection
13In the application of Lemma 10.43 to Lemma 10.44, it is important that the polynomial f is
allowed to be reducible.

6. Rational Maps
597
to the jth coordinate for 1 ≤j ≤n, which is a regular function on W. Lemma
10.39 shows that ϕ is a morphism, and ϕ is one-one onto by inspection. The
inverse function is given by ϕ−1(x1, . . . , xn) =

x1, . . . , xn, 1/f (x1, . . . , xn)

.
Let X j be the image of X j in k[X1, . . . , Xn+1]/(Xn+1 f −1) for 1 ≤j ≤n + 1.
Then (X j ◦ϕ−1)(x1, . . . , xn) equals xj for j ≤n and equals 1/f (x1, . . . , xn) for
j = n + 1, and these are regular functions on the complement of V ( f ) in An.
By Lemma 10.39, ϕ−1 is a morphism.
□
Lemma 10.44. If V is a variety, then there is a base for the Zariski topology
on V consisting of open sets that are isomorphic to afﬁne varieties.
PROOF. Let P be in V , and let U be an open subset of V containing P.
We are to produce an open subset W of U containing P that is isomorphic to
an afﬁne variety. Since any nonempty open set of a quasiprojective variety is
a quasiprojective variety, U is a variety. Thus we may assume that U = V .
Since any projective variety in Pn is covered by the afﬁne varieties isomorphic
via Proposition 10.37 to nonempty intersections with βj(An), any quasiprojective
variety is covered by quasi-afﬁne varieties. Thus we may assume that U = V
is quasi-afﬁne in An. Let X be the closed subset X = V −V in An, and let
a = I (X). Since P is in V , it is not in X, and there exists some f in a with
f (P) ̸= 0. Let Y = V ( f ). The point P is not in Y, and thus W = V −V ( f ) is
relatively open in V and contains P.
Being relatively open in V , W is a quasi-afﬁne variety. Since f vanishes on X,
V ( f ) contains X = V −V . Thus the equality W = V −V ( f ) exhibits W as a
relatively closed subset of An −V ( f ), which Lemma 10.43 shows is isomorphic
to an afﬁne variety. Hence W itself is isomorphic to a quasi-afﬁne variety that is
closed in an afﬁne variety. That is, W is isomorphic to an afﬁne variety.
□
Theorem 10.45. Let U and V be varieties, and let ϕ 	→ϕ be the function
carrying dominant rational mapsϕ : U →V to ﬁeld mappingsϕ : k(V ) →k(U)
respecting the operations by k and given by
ϕ( f ) = (class of f

F ◦ϕE′),
where f is in k(V ), f is regular on F, (E, ϕE) is a pair in the class ϕ, and
E′ = ϕ−1
E (F). Then ϕ 	→ϕ is one-one onto the set of all ﬁeld mappings from
k(V ) into k(U) respecting k. Furthermore, if P ∈U and Q ∈V are points, then
the maximal ideal of ϕ(OQ(V )) is contained in the maximal ideal of OP(U) if and
only if P is in the largest domain on which ϕ is a morphism and has ϕ(P) = Q.
REMARK. The ring OP(U) is the k vector space sum of its maximal ideal
and the constants, since evaluation at P is a well-deﬁned multiplicative linear
functional on OP(U), and a similar comment applies to OQ(V ). Whatever ϕ

598
X. Methods of Algebraic Geometry
does, it certainly carries 1 to 1, and hence if ϕ carries the maximal ideal of
OQ(V ) to the maximal ideal of OP(U), then it carries OQ(V ) to OP(U) also.
PROOF. We begin by inverting ϕ 	→ϕ. Lemma 10.44 shows that any variety
is covered by open subvarieties isomorphic to afﬁne varieties, and the function
ﬁelds of the variety and the subvarieties may all be identiﬁed with one another.
Thus there is no loss in generality in assuming that V is an afﬁne variety in
An. Let X1, . . . , Xn be the images in A(V ) of X1, . . . , Xn, and suppose that a
k algebra homomorphism γ : k(V ) →k(U) is given. Then γ (X1), . . . , γ (Xn)
are rational functions on U, and we can ﬁnd a nonempty open subset E of U on
which all these functions are regular. Since γ is a homomorphism, γ yields by
restriction of the images a homomorphism γ : A(V ) →O(E). Moreover, this
version of γ is one-one on A(V ) because γ as a ﬁeld mapping is one-one and
because Proposition 10.34 shows that each member of O(E) extends in only one
way to a member of k(U). Theorem 10.38 produces a morphism ψ : E →V
such that 
ψ = γ for this restricted version of γ . Then the equivalence class ϕ of
the pair (ψ, E) is a rational map of U into V .
To see that ϕ is dominant, suppose on the contrary that ψ(E) is a proper
closed subset of V . Then we can ﬁnd a polynomial f that is 0 on ψ(E) but is not
identically 0 on V . The image ¯f of f in A(V ) is nonzero. Since the restricted
version of γ is one-one, γ ( ¯f ) is nonzero in O(E). However, γ ( ¯f ) = 
ψ( ¯f ) =
¯f ◦ψ, and the right side is 0 on E, contradiction.
The construction is arranged in such a way that if we start from ϕ, form ϕ,
and go through the construction to produce a rational map of U into V , then
the resulting rational map is ϕ. In the reverse direction, suppose that we start
from γ , produce ϕ, and then form ϕ, and suppose that ¯f in k(V ) is in A(V ). If
E ⊆U is as in the ﬁrst paragraph of the proof, then a representative of ϕ is the
pair (E, ϕE), where ϕE is the morphism such that (ϕE) = γ . Then γϕ( ¯f ) is the
class of ¯f ◦ϕE, which equals ϕ( f ) and hence γ ( ¯f ). In other words, γ and ϕ
agree on A(V ); being ﬁeld mappings, they agree on k(V ). This completes the
proof of the ﬁrst conclusion of the theorem.
Now suppose that ϕ is a dominant rational map from U to V and that ϕ is the
corresponding ﬁeld map of k(V ) to k(U). Let P ∈U and Q ∈V be points,
suppose that there is an open neighborhood E of P such that (E, ϕE) is in the
equivalence class ϕ, and suppose that ϕE(P) = Q. Lemma 10.44 shows that
there is a base of open neighborhoods of Q in V consisting of open sets that are
isomorphic to afﬁne varieties. Since ϕE is by assumption continuous, we can
select any such open neighborhood and assume that ϕE carries E into it. Thus
there is no loss of generality in assuming that V is isomorphic to an afﬁne variety.
We associate to ϕE the k algebra homomorphism (ϕE) : O(V ) →O(E) given
by (ϕE)( f ) = f ◦ϕE for f ∈O(V ). This formula shows that the members f
of O(V ) that vanish at Q are carried to members of O(E) that vanish at P and

6. Rational Maps
599
that members of O(V ) that do not vanish at Q go to members of O(E) that do
not vanish at P. Therefore (ϕE)carries OQ(V ) into OP(E) = OP(U).
Conversely suppose that the ﬁeld map ϕ has the property that the maximal
ideal of ϕ(OQ(V )) is contained in the maximal ideal of OP(U). Possibly by
passing to an open subneighborhood from the outset, we may assume by Lemma
10.44 that U and V are isomorphic to afﬁne varieties. Dropping the isomorphism
from the notation, we can write O(V ) = A(V ) = k[y1, . . . , ym] by Corollary
10.25. Each ϕ(yj) is a rational function on U, which we can write as ϕ(yj) =
aj/bj with aj and bj in O(U) = A(U).
The hypothesis on ϕ implies that
ϕ(OQ(V )) ⊆OP(U), hence that each ϕ(yj) is regular at P. Thus we may take
each denominator bj to have bj(P) ̸= 0. Choose an open neighborhood of P on
which all bj are nonvanishing and an open subneighborhood E that is isomorphic
to an afﬁne variety. Since ϕ respects the ﬁeld operations, it carries any polynomial
in y1, . . . , ym to a quotient c/d with c and d in O(E) and with d nowhere 0 on E.
Therefore c/d is in 
P′∈E OP′(E) = O(E). That is, ϕ carries O(V ) into O(E).
Since V is isomorphic to an afﬁne variety, Corollary 10.25 and Theorem 10.38
show that ϕ : O(V ) →O(E) is given by the formula
ϕ(h)(u) = h(ϕE(u))
(∗)
for some morphism ϕE : E →V and all h ∈O(V ) and u ∈E. The ﬁrst part
of the proof shows that the pair (E, ϕE) is in the equivalence class ϕ. Hence P
is in the largest domain on which ϕ is a morphism. Arguing by contradiction,
suppose that ϕE(P) = Q′ ̸= Q. Choose by Proposition 10.36 a rational function
h on V that is deﬁned at both Q and Q′ and has h(Q) = 0 and h(Q′) ̸= 0. Then
ϕ carries OQ(V ) and its maximal ideal into OP(U) and its maximal ideal, and
we obtain 0 = ϕ(h)(P) = h(ϕE(P)) = h(Q′) ̸= 0, contradiction. We therefore
conclude that ϕE(P) = Q, and the proof of the second conclusion of the theorem
is complete.
□
Corollary 10.46. If U and V are varieties, then the following conditions are
equivalent:
(a) U and V are birationally equivalent,
(b) k(U) and k(V ) are isomorphic as k algebras,
(c) there are nonempty open subsets E of U and F of V such that E and F
are isomorphic as varieties.
PROOF. The equivalence of (a) and (b) follows from Theorem 10.45 and the
fact that composition of dominant rational maps corresponds to composition of
homomorphisms of k algebras in the reverse order.
Let us check that (c) implies (a). If (c) holds, let ϕ : E →F and ψ : F →E
be morphisms that are inverse to each other. Then the equivalence classes of

600
X. Methods of Algebraic Geometry
(E, ϕ) and (F, ψ) are rational maps from U to V and from V to U, respectively.
The equivalence class of (E, ψ ◦ϕ) = (E, 1E) is the identity rational map on U,
and the equivalence class of (F, ϕ ◦ψ) = (F, 1F) is the identity rational map on
V . Hence the rational maps are inverses of one another. This proves (a).
Finally let us check that (a) implies (c). If (a) holds, let ϕ : U →V and
ψ : V →U be rational maps that are inverse to each other.
Let (E1, ϕ)
and (F1, ψ) be pairs representing ϕ and ψ. Then a pair representing ψ ◦ϕ
is (ϕ−1(F1), ψ ◦ϕ) because ϕ is a morphism on the open subset ϕ−1(F1) of E1
and ψ is a morphism on the open set F1 containing ϕ(ϕ−1(F1)). Since ψ ◦ϕ is
the identity on U as a rational map, ψ ◦ϕ is the identity morphism on ϕ−1(F1).
Put E = ϕ−1(F1) ⊆E1. Similarly ϕ ◦ψ is the identity morphism on ψ−1(E1),
and we put F = ψ−1(E1) ⊆F1. Let us see that ϕ(E) ⊆F. If e is in E, we are to
exhibit some e1 ∈E1 with ψ(ϕ(e)) in E1, and then ϕ(e) will be in F = ψ−1(E1);
for this purpose we can take e1 = e, since ψ ◦ϕ is the identity morphism on E.
Similarly ψ(F) ⊆E. Thus ϕ and ψ exhibit E and F as isomorphic varieties.
This proves (c).
□
7. Zariski’s Theorem about Nonsingular Points
Sections 1–6 have established the deﬁnitions and elementary properties of va-
rieties, maps between varieties, and dimension. The present section concerns
singularities, which are a fundamental topic of interest in algebraic geometry.14
This topic was introduced in Section VII.5 in a context that we now recognize as
afﬁne varieties.
The deﬁnition of “nonsingular” was motivated by the classical Implicit Func-
tion Theorem. Let k be an algebraically closed ﬁeld, let the afﬁne space in
question be An, and let p be the prime ideal such that the afﬁne variety to study
in An is V (p). If { fi} is a ﬁnite set of generators of p and if P is in V (p), then P
is said to be a nonsingular point of V (p) if rank
 ∂fi
∂X j (P)

= n −dim V (p), and
otherwise it is singular. Zariski’s Theorem, which was formulated as Theorem
7.23 but only partially proved in Chapter VII, addressed this situation. In order
to rephrase the theorem in our current notation, let A(V ) be the afﬁne coordinate
ring of V , and let k(V ) be the ﬁeld of fractions of A(V ), i.e., the function ﬁeld
of V . Let mP be the maximal ideal of all members of A(V ) vanishing at P, and
let OP(V ) be the local ring at P; this is the localization of A(V ) with respect to
the maximal ideal mP and is a subring of k(V ). The maximal ideal of OP(V ),
consisting of all members of k(V ) deﬁned and vanishing at P, will be denoted
by MP. Theorem 7.23, translated into this notation, is as follows.
14The exposition in this section is based in part on Chapter I of Hartshorne’s book, Chapter III
of Reid’s book, and Chapter II of Volume 1 of Shafarevich’s books.

7. Zariski's Theorem about Nonsingular Points
601
Theorem 10.47 (Zariski’s Theorem, rephrased). In the above notation,
dimk(MP/M2
P) = dimk(mP/m2
P) ≥dim V (p),
and P is nonsingular if and only if equality holds. The set of nonsingular points
of V (p) is nonempty and open.
Toward the proof of this theorem, we showed in Section VII.5 for all P ∈V (p)
that
dimk(MP/M2
P) = dimk(mP/m2
P),
(a)
dimk(mP/m2
P) + rank
 ∂fi
∂X j (P)

= n,
(b)
P is a nonsingular point if and only if dimk(mP/m2
P) = dim V (p).
(c)
In addition, we completed most of the proof in the special case that V (p) is an
irreducible afﬁne hypersurface by showing that
dimk(mP/m2
P) ≥dim V (p)
for all P ∈V (p),
(d)
dimk(mP/m2
P) = dim V (p)
for some P ∈V (p).
(e)
Our goal in this section is to complete the proof of Zariski’s Theorem in the general
case as stated by reducing (d) and (e) for the general case to what has already
been proved for the special case that V (p) is an irreducible afﬁne hypersurface.
We need also to see in all cases that the set of nonsingular points is Zariski open.
Before proceeding, let us mention the signiﬁcance of Theorem 10.47. The
deﬁnition above of nonsingular and singular points extends immediately to
quasi-afﬁne varieties, using the same deﬁning polynomials, and the theorem is
then applicable because the open set of nonsingular points in an afﬁne variety
meets any nonempty open subset of the variety. In the projective case we can pull
matters back to afﬁne space by means of one of the maps βi : An →Pn. In this
way we obtain deﬁnitions of nonsingular and singular point for quasiprojective
varieties, and the theorem remains valid.15 What is far from obvious with such
a deﬁnition is that the decision nonsingular vs. singular for a point is unaffected
by isomorphisms of varieties. On the other hand, the equivalent condition on
MP/M2
P as stated in Zariski’s Theorem is manifestly unaffected by isomorphisms
of varieties because of Proposition 10.42.
15Problems 13–16 at the end of the chapter show that the rank computation can alternatively be
made directly with the homogeneous polynomials deﬁning the projective variety in question.

602
X. Methods of Algebraic Geometry
Proposition 10.48. Any m-dimensional variety is birationally equivalent to
an irreducible afﬁne hypersurface H in Am+1.
PROOF. Let V be the variety in question. By deﬁnition of dim V , the function
ﬁeld k(V ) is a ﬁnitely generated extension ﬁeld of k of transcendence degree
m over k. Since algebraically closed ﬁelds are perfect, Theorem 7.20 shows
that k(V ) is “separably generated” over k, and Theorem 7.18 shows as a con-
sequence that k(V ) has a “separating transcendence basis,” i.e., a transcendence
basis {x1, . . . , xm} such that k(V ) is a ﬁnite separable algebraic extension of
k(x1, . . . , xm). By the Theorem of the Primitive Element, there exists an element
xm+1 of k(V ) such that k(V ) = k(x1, . . . , xm)[xm+1]. Let P(Xm+1) be the
minimal polynomial of xm+1 over k(x1, . . . , xm).
Writing out the equation
P(xm+1) = 0 and clearing fractions, we see that xm+1 satisﬁes a polynomial
equation
ar(x1, . . . , xm)xr
m+1 + · · · + a1(x1, . . . , xm)xm+1 + a0(x1, . . . , xm) = 0
in which the coefﬁcient polynomials aj(X1, . . . , Xm) ∈k[X1, . . . , Xm] have no
nontrivial common factor. In this case the polynomial f (X1, . . . , Xm+1) equal
to
ar(X1, . . . , Xm)Xr
m+1 + · · · + a1(X1, . . . , Xm)Xm+1 + a0(X1, . . . , Xm)
is irreducible in k[X1, . . . , Xm+1]. Thus the principal ideal ( f ) deﬁnes an irre-
ducible afﬁne hypersurface H = V ( f ) in Am+1 whose afﬁne coordinate ring is
k[X1, . . . , Xm+1]/( f ). The ﬁeld of fractions k(H) is isomorphic to k(V ), and
H is birationally equivalent to V by the equivalence of (a) and (b) in Corollary
10.46.
□
Lemma 10.49. Every point P in V (p) has 0 ≤dimk(MP/M2
P) ≤n, and the
set of points P in V (p) with dimk(MP/M2
P) ≥r is a Zariski closed subset for
each integer r.
PROOF. The entries of the matrix
 ∂fi
∂X j

are polynomials, and the set of points
P of V (p) for which the matrix
 ∂fi
∂X j (P)

has rank ≤s is a Zariski closed subset,
being the set on which all (s + 1)-by-(s + 1) minors of the matrix vanish. By
display formula (b) above, the set of points P for which dimk(mP/m2
P) ≥n −s
is closed, and (a) therefore shows that the set with dimk(MP/M2
P) ≥n −s is
closed.
□
PROOF OF THEOREM 10.47. Let m = dim V (p), and let a birational mapping
of V (p) to an afﬁne hypersurface H of Am+1 be given. By the equivalence of (a)

7. Zariski's Theorem about Nonsingular Points
603
and (c) in Corollary 10.46, there exist nonempty open subsets E of V (p) and F
of H that are isomorphic as varieties, say by an isomorphism ϕ : E →F. Since
m = dim V (p) = dim H, Proposition 10.11 shows that m = dim E = dim F
also. For each integer r ≥0, let
Sr =

P ∈V (p) | dimk(MP/M2
P) ≤r

,
Tr =

P ∈E | dimk(MP/M2
P) ≤r

,
Ur =

P ∈F ⊆H | dimk(MP/M2
P) ≤r

.
Lemma 10.49 shows that
Sr, Tr, Ur are relatively open in V (p), E, F, respectively, for each r.
(∗)
Application of Proposition 10.42 to ϕ and ϕ−1 gives
ϕ(Tr) = Ur
for all r ≥0,
(∗∗)
and the special case of Theorem 10.47 proved in Section VII.5 shows that
Um ̸= ∅
and
Um−1 = ∅.
(†)
Combining (∗∗) and (†) yields
Tm ̸= ∅
and
Tm−1 = ∅.
(††)
Since Sr ⊇Tr, the ﬁrst of these shows that
Sm ̸= ∅.
(‡)
If Sm−1 ̸= ∅, then E ∩Sm−1 ̸= ∅because any two nonempty open subsets of
V (p) have nonempty intersection; but Tm−1 = E ∩Sm−1 would then be nonempty,
in contradiction to (††). Thus
Sm−1 = ∅.
(‡‡)
In view of (a), (‡) proves (e) for V (p), and (‡‡) proves (d) for V (p). Because of
(‡‡), Lemma 10.49 implies that Sm is Zariski open; thus the set of nonsingular
points is open.
□

604
X. Methods of Algebraic Geometry
8. Classiﬁcation Questions about Irreducible Curves
Sections 1–7 give the fundamentals concerning (quasiprojective) varieties over
the algebraically closed ﬁeld k. The remainder of the chapter will address aspects
of three problems:
(i) What are all varieties, or in what senses can varieties be classiﬁed?
(ii) To what extent can one make computations in the subject?
(iii) What can be said when the algebraically closed ﬁeld k is replaced by a
general commutative ring with identity?
Algebraic geometry is an enormous subject, going well beyond these problems.
For example the investigation of the nature of singularities is in itself a large
subject, with striking applications to topology and differential equations. The
use of homological methods ties algebraic geometry closely to topology and to
number theory, and these methods have bearing on the extent to which compact
complexmanifoldsadmitthestructureofprojectivevarieties. Algebraicgeometry
is an ingredient in the subject of invariant theory, which studies classical varieties
using representation theory. It is an ingredient also in the subject of algebraic
groups, which concerns varieties with a group structure in which multiplication
and inversion are morphisms.
The present section concerns the ﬁrst of the three problems listed above, and
we limit our discussion to irreducible curves, i.e., to varieties of dimension 1.
We say that an irreducible curve is nonsingular if it is nonsingular at every
point. We are going to show in this section that each birational equivalence
class of irreducible curves over k contains a nonsingular projective curve and
that any two nonsingular projective curves in the birational equivalence class are
isomorphic as projective varieties.16 We also will get some information about
how this nonsingular curve in the class is related to the other curves in the class.
To a great extent the classiﬁcation of irreducible curves will therefore have been
reduced to the classiﬁcation of the birational equivalence classes, which Corollary
10.46 says is the same thing as a classiﬁcation of the function ﬁelds in one variable
over k. We will not have anything to say about classifying the function ﬁelds in
one variable except to say that each class has a genus, according to Section IX.3,
and that every nonnegative integer can arise as a genus, according to Example 3
of genus in Section IX.3.17
Chapter IX already contains clues about where to begin. Section IX.1 men-
tioned the relevance of Dedekind domains to the study, and Problems 5–11 at
the end of that chapter attached a discrete valuation to each nonsingular point of
any irreducible afﬁne plane curve. The notions of Dedekind domains, discrete
16The exposition in this section is based in part on Chapter 7 of Fulton’s book, Chapter I of
Hartshorne’s book, Chapter II of Reid’s book, and Volume I by Zariski–Samuel.
17The subject of Teichm¨uller theory in effect addresses this question when k = C.

8. Classification Questions about Irreducible Curves
605
valuations, and nonsingular points are very closely related, and we begin with
some equivalences concerning them. Recall from Sections 2 and 4 that the afﬁne
coordinate ring A(C) of any irreducible afﬁne curve C has Krull dimension 1.
That is, the Noetherian domain A(C) has the property that every nonzero prime
ideal is maximal. We have seen that the local ring OP(C) at any point is a
localization of A(C), namely the localization of A(C) with respect to the maximal
ideal mP of functions vanishing at P. Furthermore, the proper ideals of such a
localization are exactly the sets S−1a with a equal to an ideal disjoint from the
set-theoretic complement of mP in A(C). It follows that every nonzero prime
ideal in OP(C) is maximal. This conclusion extends to the quasiprojective case
as a consequence of Proposition 10.33. Zariski’s Theorem in Section 7 shows that
nonsingularity of the point P of C can be detected from OP(C). Consequently
the following proposition is relevant.
Proposition 10.50. Let R be a Noetherian local ring that is an integral domain
with the property that the only nonzero prime ideal is the maximal ideal. Let M
be the unique maximal ideal of R, let K be the ﬁeld of fractions of R, and let
F = R/M be the quotient ﬁeld. Under the assumption that M ̸= 0 and therefore
that R ̸= K, the following conditions on R are equivalent:
(a) R is integrally closed,
(b) R is a Dedekind domain,
(c) R is a principal ideal domain,
(d) R is the valuation ring relative to some discrete valuation of K,
(e) M is a principal ideal,
(f) dimF M/M2 = 1.
REMARKS. Consider (f). To see how M/M2 becomes an F vector space in a
natural way, let r + M be a member of F, and let m + M2 be a member of M/M2.
Then (r + M)(m + M2) = rm + M2 is a well-deﬁned scalar multiplication of
F on M/M2, and M/M2 becomes a vector space over F. Nakayama’s Lemma
(Lemma 8.51 of Basic Algebra, restated in the present book on page xxiii) shows
that an equality M N = N for a ﬁnitely generated R module N is possible only
if N = 0; since M itself is a ﬁnitely generated R module, being an ideal in a
Noetherian ring, and since M ̸= 0 by assumption, M2 = M is not possible.
Therefore dimF M/M2 ≥1.
PROOF. If (a) holds, then R satisﬁes the three conditions (Noetherian, integrally
closed, every nonzero prime ideal maximal) in the deﬁnition of Dedekind domain.
Thus (a) implies (b). A Dedekind domain with only ﬁnitely many maximal ideals
isaprincipalidealdomainbyCorollary8.62ofBasicAlgebra, andthus(b)implies
(c). A principal ideal domain is a unique factorization domain by Theorem 8.15
of Basic Algebra, and thus (c) implies (a) by Proposition 8.41 of Basic Algebra.

606
X. Methods of Algebraic Geometry
To see that (a) through (c) are equivalent to (d), ﬁrst suppose that (a) through
(c) hold. Then every fractional ideal in K relative to R is of the form Mk for
some integer k. If x ̸= 0 is in K, then the principal fractional ideal x R is of the
form x R = Mk for some k. Section VI.2 shows that the formula v(x) = k (with
v(0) = ∞) deﬁnes a discrete valuation on K, and the deﬁnition of v shows that
the valuation ring of v is R. Hence (d) holds. Conversely if (d) holds, then R is
a principal ideal domain by Proposition 6.2; thus (c) and necessarily (a) and (b)
hold.
Let us prove that (e) and (f) are equivalent. If (e) holds, then we can write
M = (π) for some π in R. If m + M2 is a given element of M/M2, then m is
of the form m = rπ for some r in R. Hence (r + M)(π + M2) = rπ + M2 =
m + M2, and dimF M/M2 ≤1. Since the remarks before the proof show that
dimF M/M2 ≥1, (f) holds.
If (f) holds, let {π + M2} be an F basis of M/M2. If m ∈M is given, then
m + M2 = (r + M)(π + M2) for some r ∈R. Therefore m = rπ + m′ with
m′ ∈M2, and we see that (π)+ M2 = M. We shall apply Nakayama’s Lemma in
the local ring R/(π) with maximal ideal M/(π) and with module N = M/(π):
Given m ∈M, we expand m = rπ + m′ with m′ ∈M2 as m = rπ + 	
i, j mimj.
Then the equality m+(π) = 	
i, j mimj in M/(π) shows that m ≡	
i mi
	
j mj,
hence that the coset m + (π) lies in 	
i (mi + (π))(M/(π)). In other words,
M/(π) = (M/(π))2. Nakayama’s Lemma shows that M/(π) = 0, and therefore
M = (π). Thus (e) holds.
Finally let us prove that (c) and (e) are equivalent. If (c) holds, then M has to be
principal, and hence (e) holds. Suppose that (e) holds, i.e., that M = (π). Let I
be a nonzero proper ideal in R. The ideal N = ∞
k=1 Mk is a ﬁnitely generated R
module because R is Noetherian, and it has M N = N. By Nakayama’s Lemma,
N = 0. Since I ⊆M and since I ̸= 0, there exists a largest integer k ≥1 such
that I ⊆Mk. Choose y ̸= 0 in I with y in Mk = (πk) but not in Mk+1 = (πk+1).
Let us write y = aπk for some a ∈R. Since y is not in Mk+1 and since R is
local, a is a unit in R. Hence a−1y = πk is in I, and therefore Mk = (πk) ⊆I.
Since we arranged that I ⊆Mk, we obtain I = Mk = (πk). Thus (c) holds.
□
Corollary 10.51. Let C be an irreducible quasiprojective curve over k, and
let k(C) be its function ﬁeld. If P is a point of C, then the following conditions
are equivalent:
(a) P is a nonsingular point,
(b) OP(C) is the valuation ring of some discrete valuation of k(C) deﬁned
over k,
(c) OP(C) is integrally closed.
PROOF. Let MP be the unique maximal ideal of OP(C). Zariski’s Theorem
(Theorem 10.47) shows that (a) holds if and only if dimk MP/M2
P = 1. The

8. Classification Questions about Irreducible Curves
607
corollary therefore follows from the equivalence of (f), (d), and (a) in Proposition
10.50, along with the observation that any discrete valuation produced by (d) has
to be 0 on k×.
□
Corollary 10.52. If C is an irreducible afﬁne curve over k with afﬁne coordi-
nate ring A(C), then the following conditions on C are equivalent:
(a) A(C) is integrally closed,
(b) OP(C) is integrally closed for each point P of the curve,
(c) C is nonsingular.
PROOF. If A(C) is integrally closed, then Corollary 8.48c of Basic Algebra
shows that each localization OP(C) is integrally closed.
Conversely if each
OP(C) is integrally closed and if a member f of the function ﬁeld k(C) is given
that is a root of a monic polynomial with coefﬁcients in A(C), then f is a root of
the same polynomial with coefﬁcients in OP(C) and is in OP(C) because OP(C)
is integrally closed. Corollary 10.25 shows that A(C) = 
P OP(C). Therefore
f lies in A(C), and A(C) is integrally closed. This proves that (a) and (b) are
equivalent. The equivalence of (b) and (c) follows from Corollary 10.51.
□
We turn our attention to constructing a nonsingular irreducible projective curve
whose ﬁeld of rational functions is a given function ﬁeld K in one variable over
k. If C is any irreducible quasiprojective curve with k(C) = K, then Corollary
10.51 associates a discrete valuation of K over k to each nonsingular point of C.
To get an idea what C must be like if it is to be nonsingular at every point, we
now prove a theorem in the converse direction, associating a point of the curve
to each discrete valuation of K over k.
Theorem 10.53. Let C be an irreducible projective curve with function ﬁeld
k(C) equal to K, and let v be a discrete valuation of K deﬁned over k. If Rv is the
valuation ring of v and pv is the valuation ideal, then there exists a unique point
P on the curve for which the maximal ideal MP of OP(C) has MP ⊆pv.
PROOF OF UNIQUENESS. Assume the contrary. If P and Q are distinct points
with MP ⊆pv and MQ ⊆pv, then Proposition 10.36 constructs a function h in
k(C) with h deﬁned at P and Q, h(P) = 0, and h(Q) ̸= 0. This function h
is in MP, and h −h(Q) is in MQ. The assumed inclusions of maximal ideals
imply that v(h) ≥1 and that v(h −h(Q)) ≥1. On the other hand, h(Q) ̸= 0
implies that v(h(Q)) = 0. Thus 0 = v(h(Q)) ≥min

v(h(Q) −h), v(h)

≥1,
contradiction.
□
PROOF OF EXISTENCE. It is shown in Problem 12 at the end of the chapter that
any projective variety in Pr is isomorphic to a projective variety V in some Pn
with n ≤r such that V is not contained in any subvariety

[x0, . . . , xn] | xj = 0


608
X. Methods of Algebraic Geometry
with 0 ≤j ≤n. That being so, we may assume that C is a projective variety
in Pn and that C ∩βj(An) ̸= ∅for 0 ≤j ≤n, where βj : An →Pn is the
embedding deﬁned after Proposition 10.18. Let A(C) = k[X0, . . . , Xn]/I (C)
be the homogeneous coordinate ring of C, and for each j, let xj be the image of
X j in A(C). Since I (C) does not contain X j, xj is not the 0 element of A(C).
Since Xi and X j are homogeneous of the same degree, each function xi/xj is a
well-deﬁned member of the function ﬁeld k(C).
Let N = maxi, j v(xi/xj). Possibly by renaming some coordinate xj0 as x0,
we may assume that v(xi0/x0) = N for some i0. Then we have v(xi/x0) =
v(xi0/x0)+v(xi/xi0) = N −v(xi0/xi) ≥0 for all i. Consequently each function
xi/x0 lies in the subring Rv of k(C).
Theorem 10.20 and Corollary 10.22 show that C0 = β−1
0 (C) is an irre-
ducible afﬁne curve and that its prime ideal is I (C0) = βt
0(I (C)).
Conse-
quently the substitution homomorphism βt
0 : k[X0, . . . , Xn] →k[X1, . . . , Xn]
descends to a homomorphism of A(C) = k[X0, . . . , Xn]/I (C) onto A(C0) =
k[X1, . . . , Xn]/I (C0) that carries x0 in A(C) to 1 and carries the members
x1, . . . , xn of A(C) to the generators of A(C0). The members xi/x0 of k(C)
therefore get identiﬁed with the generators of A(C0), and we conclude that
A(C0) ⊆Rv.
Deﬁne q = pv ∩A(C0). This is a prime ideal of A(C0), and it pulls back
under the quotient homomorphism k[X1, . . . , Xn] →A(C0) to a prime ideal q
containing I (C0). Then V (q) is an afﬁne subvariety of C0. Since dim C0 = 1,
there are only two possibilities. One is that dim V (q) = 1, in which case V (q) =
C0, q = I (C0), and q = 0. The other is that dim V (q) = 0, in which case
V (q) = {P} for some point P that necessarily lies on C0. In the ﬁrst case, v
is 0 on every nonzero member of A(C) and hence is 0 on k(C)×, contradiction.
Thus we are in the second case.
Then q is maximal in k[X1, . . . , Xn], q is
maximal in A(C0), q is the ideal mP of all members of A(C0) vanishing at P,
and A(C0)/q ∼= k. If S denotes the set-theoretic complement of q in A(C0), then
no member of S can be in pv because then q + k1 = A(C0) would be in pv,
contradiction. Thus v(s) = 0 for all s ∈S, and MP = S−1mP ⊆pv.
□
Corollary 10.54. If ϕ is a rational map from an irreducible curve C′ to an
irreducible projective curve C, then the largest domain on which ϕ is a morphism
contains every nonsingular point of C′. If C′ is nonsingular, then ϕ is a morphism
from C′ into C.
PROOF. If ϕ is not dominant, then Problem 6 at the end of the chapter shows that
ϕ is constant. Certainly the largest domain on which a constant ϕ is a morphism
is C′.
Thus suppose that ϕ is dominant.
Using the notation introduced early in
Section 6, let ϕ : k(C) →k(C′) be the associated ﬁeld map of function ﬁelds.

8. Classification Questions about Irreducible Curves
609
Since k(C) and k(C′) both have transcendence degree 1 over k and since k(C) is
ﬁnitely generated as a ﬁeld over k, the ﬁeld k(C′) is a ﬁnite algebraic extension
of the ﬁeld ϕ(k(C)). If v is any discrete valuation of k(C′), then it follows from
the ﬁniteness of this extension that v cannot be identically 0 on ϕ(k(C))×; in fact,
if it were identically 0, then the expansion x = 	m
j=1 cjxj of a general element
x of k(C′) in terms of a vector-space basis {x1, . . . , xm} of k(C′) over ϕ(k(C))
would yield the inequality v′(x) ≥minj v(xj), which cannot be true for all x.
Meanwhile, if P is a nonsingular point of C′, then Corollary 10.51 shows that
OP(C′)isthevaluationring Rv forsomevaluationv ofk(C′)overk. Themaximal
ideal MP of OP(C′) equals the valuation ideal pv of v. Since the restriction of v to
ϕ(k(C))× is not identically 0, the restriction comes from some positive multiple e
of a discrete valuation on ϕ(k(C)). Let v0 be the corresponding discrete valuation
of k(C); this is given by v0( f ) = e−1v(ϕ( f )). Let R0 be its valuation ring and
p0 be its valuation ideal in k(C); the latter is given by p0 = ϕ−1(pv). Theorem
10.53 shows that there exists a unique point Q on the curve C such that the
maximal ideal MQ of OQ(C) is contained in p0. That is, MQ ⊆p0 = ϕ−1(pv).
Application of ϕ gives ϕ(MQ) ⊆ϕϕ−1(pv) ⊆pv = MP. Theorem 10.45 shows
that consequently P is in the largest domain on which ϕ is a morphism and that
ϕ(P) = Q.
□
Corollary 10.55. If two nonsingular irreducible projective curves are bira-
tionally equivalent, then they are isomorphic as varieties.
PROOF. This follows by applying Corollary 10.54 twice.
□
Corollary 10.56.
If C is a nonsingular irreducible projective curve with
function ﬁeld K = k(C), then the points of C are in one-one correspondence
with the discrete valuations of K deﬁned over k.
PROOF. This is the correspondence given in one direction by Corollary 10.51
and in the reverse direction by Theorem 10.53.
□
Corollary 10.56 has a remarkable conclusion, but the corollary assumes the
existenceofanonsingularprojectivecurve, whichwehavenotyetproved. Inmore
detail we now know that a nonsingular point P of any irreducible projective curve
C picks out a unique discrete valuation v of the function ﬁeld K = k(C), namely
the one whose valuation ring is given by Rv = OP(C), and that conversely when
C is projective, any discrete valuation v′ deﬁned over k picks out a certain point P′
of C with the property that OP′(C) ⊆Rv′. If P is nonsingular and we go through
the ﬁrst step and then the second, using v′ = v, we obtain OP′(C) ⊆OP(C).
Proposition 10.36 shows that P′ = P, and hence the second process inverts the
ﬁrst. That is what Corollary 10.56 says. Also, we know from Theorem 10.47 that
many discrete valuations are involved in this process, since the set of nonsingular

610
X. Methods of Algebraic Geometry
points of a variety is Zariski open. What we do not know is that any given discrete
valuation over k ever yields a nonsingular point for any curve with the function
ﬁeld K. This missing piece of information will be supplied in Corollary 10.58
below. To prove Corollary 10.58, we shall make use of the following theorem,
which we need only in the case that the ﬁeld k is our algebraically closed ﬁeld k.
We postpone the proof of the theorem for a moment, and when we give the proof,
we shall give it only for the case that the ﬁeld k in the statement is algebraically
closed.
Theorem 10.57. Let k be a ﬁeld, let R = k[x1, . . . , xn] be a ﬁnitely generated
integral domain over k, let K be the ﬁeld of fractions of R, and let L be a ﬁnite
algebraic extension of K. Then the integral closure T of R in L is a ﬁnitely
generated R module.
Corollary 10.58. Let C be an irreducible projective curve with function ﬁeld
K = k(C), let P be a point of C, and let MP be the maximal ideal of OP(C).
Then there exists a discrete valuation v of K deﬁned over k whose valuation ideal
pv has MP ⊆pv.
REMARKS. This result is a supplement to Theorem 10.53. It says that the map
of that theorem, carrying discrete valuations of K deﬁned over k to points of C,
is onto.
PROOF. Without loss of generality, we may assume that C is afﬁne. Let mP be
the maximal ideal in the afﬁne coordinate ring A(C) consisting of all functions
vanishing at P, and let S be the set-theoretic complement of mP in A(C), so
that MP = S−1mP. Evaluation at P is a linear functional on A(C) with kernel
mP, and therefore A(C) = mP + k1. In other words, mP and any element of S
together generate A(C) as a k vector space.
If T denotes the integral closure of A(C) in K, then Theorem 10.57 implies that
T is Noetherian, and Proposition 8.45 of Basic Algebra shows that every nonzero
prime ideal of T is maximal.
Hence T is a Dedekind domain.
Proposition
8.53 of Basic Algebra shows that there exists a maximal ideal q of T such that
mP = A(C) ∩q. Since T is a Dedekind domain, q is contained in the valuation
ideal pv of a unique discrete valuation v of K, and T is contained in the valuation
ring Tv of v. Thus mP ⊆pv, and S ⊆T implies that v(s) ≥0 for all s ∈S. On the
other hand, 1 lies in mP + ks for any s in S, and hence 0 = v(1) ≥min(1, v(s)).
Therefore v(s) = 0 for all s ∈S, and MP = S−1mP ⊆pv.
□
Corollary 10.59. If K is a function ﬁeld in one variable over k and if v is a
discrete valuation of K deﬁned over k with valuation ring Rv, then there exists
an irreducible nonsingular afﬁne curve C over k with function ﬁeld K and with a
point P such that OP(C) = Rv.

8. Classification Questions about Irreducible Curves
611
PROOF. Choose an element x of K such that v(x) > 0. Deﬁne R = k[x].
Since v(x) ̸= 0, x is transcendental over k, and K is a ﬁnite algebraic extension
of the ﬁeld of fractions k(x) of R. Corollary 7.14 shows that the integral closure
T of R in K is a Dedekind domain, and Theorem 10.57 shows that T is a ﬁnitely
generated R module. Thus we can write T as T = k[x1, . . . , xn] with x1 = x.
The substitution homomorphism with X j 	→xj for all j carries k[X1, . . . , Xn]
onto T and has a prime ideal p as kernel, since T is an integral domain. Thus
V (p) is an afﬁne variety with T as its afﬁne coordinate ring. The dimension of
V (p) is the transcendence degree of K over k, which is 1 by assumption. Thus
C = V (p) is an irreducible curve. Since T is integrally closed by construction,
Corollary 10.52 shows that C is nonsingular.
Let Rv ⊆K be the valuation ring of v, and let pv be the valuation ideal. The
inequality v(x) > 0 shows that v is ≥0 on R = k[x], and Proposition 6.7 says
that v is consequently ≥0 on the integral closure T of R in K. In other words, T
is contained in Rv. Since T is a Dedekind domain and K is its ﬁeld of fractions,
Theorem 6.5 shows that q = pv ∩T is a nonzero prime (= maximal) ideal of T
and that the discrete valuation vq of K over k determined by q coincides with v.
The maximal ideals of the afﬁne coordinate ring of an afﬁne variety correspond
to the points of the variety by Proposition 10.23, and thus there exists a point P
of C such that q is the maximal ideal of T consisting of all functions vanishing
at P. The localization of T with respect to q is OP(C) by deﬁnition and is Rv by
Proposition 6.4. Therefore OP(C) = Rv.
□
Corollary 10.60. Let C be the irreducible nonsingular afﬁne curve constructed
in Corollary 10.59 and having function ﬁeld K = k(C), and regard C as a
subvariety of its projective closure C. Then there are only ﬁnitely many discrete
valuations v′ of K deﬁned over k such that the unique point P of C with MP ⊆pv′,
where MP is the maximal ideal of OP(C) and pv′ is the valuation ideal of v′, lies
outside C.
PROOF. We go over the argument in Corollary 10.59 with the same element
x and with any discrete valuation v′ deﬁned over k such that v′(x) ≥0. This
inequality implies that v′ is ≥0 on k[x], and Proposition 6.7 then shows that v′ is
≥0 on T = A(C). Thus A(C) is contained in the valuation ring Rv′ of v′. Deﬁne
q = pv′ ∩A(C). Arguing as in the existence proof for Theorem 10.53, we ﬁnd
that q equals the ideal mP of all members of A(C) vanishing at a certain point
P of C, and that proof then shows that MP ⊆pv′. By uniqueness in Theorem
10.53, this P is the one and only point produced by that theorem.
In other words, the only discrete valuations v′ of K deﬁned over k for which
the point P lies outside C are those with v′(x) < 0. Corollary 6.10 shows that
there are only ﬁnitely many of these.
□

612
X. Methods of Algebraic Geometry
We come to the proof of Theorem 10.57, but only under the assumption that k is algebraically
closed. The proof is rather technical, and the reader is encouraged to skip it on ﬁrst reading. To
underscore this point, the proof appears in small print. We need two lemmas.
Lemma 10.61. Let R be a Noetherian integrally closed domain with ﬁeld of fractions F, let K be
a ﬁnite separable extension of F, and let T be the integral closure of R in K. Then T is Noetherian
and is ﬁnitely generated as an R module.
Proof. In effect, this result was proved in Basic Algebra. In more detail: With the above
assumptions and also the assumption that every nonzero prime ideal of R is maximal (i.e., that R
is a Dedekind domain), the proof of Theorem 8.54 of Basic Algebra showed that T is a Dedekind
domain. The hard part of that proof appeared in Section IX.15; it showed from the separability that
T is ﬁnitely generated as an R module, and it did not make use of the assumption that every nonzero
prime ideal of R is maximal. Since T is ﬁnitely generated and R is Noetherian, every R submodule
of T is a ﬁnitely generated R module, by Proposition 8.34 of Basic Algebra. In particular, every
ideal of T is ﬁnitely generated as an R module and therefore is ﬁnitely generated as a T module.
Consequently T is Noetherian.
□
Lemma 10.62 (Noether Normalization Lemma). Let k be an inﬁnite ﬁeld, let R = k[x1, . . . , xn]
be a ﬁnitely generated integral domain over k, and let K = k(x1, . . . , xn) be the ﬁeld of fractions of
k. Then for a suitable d with 0 ≤d ≤n, there exist d linear combinations y1, . . . , yd of x1, . . . , xn
with coefﬁcients in k such that y1, . . . , yd are algebraically independent over k and such that every
element of R is integral over k[y1, . . . , yd]. If K is separably generated over k, then the yi may be
chosen in such a way that K is a separable extension of k(y1, . . . , yd).
Remarks. It is immediate from the conclusion that d is the transcendence degree of K over k.
The lemma is a result about the extension of rings that improves upon Theorem 7.7 for ﬁelds; the
latter says that every ﬁeld extension can be accomplished by a transcendental extension followed by
an algebraic extension. The present lemma says that the passage from a ﬁeld to a ﬁnitely generated
integral domain can be accomplished by a full polynomial extension followed by an extension in
which each generator is not merely algebraic but actually is a root of a monic polynomial with
coefﬁcients in the full polynomial ring.
Proof. Let I be the kernel of the quotient homomorphism k[X1, . . . , Xn] →k[x1, . . . , xn].
The core of the proof involves a single nonzero f in I. The idea is to replace X1, . . . , Xn−1 by new
indeterminates X′
1, . . . , X′
n−1 to make the equation f (x1, . . . , xn) = 0 become a monic polynomial
equation satisﬁed by xn over R′ = k[X′
1, . . . , X′
n−1]. With c1, . . . , cn−1 equal to members of k to be
speciﬁed later, deﬁne x′
j = xj −cj xn for 1 ≤j ≤n −1. The equation f (x1, . . . , xn) = 0 becomes
f (x′
1 + c1xn, . . . , x′
n−1 + cn−1xn, xn) = 0.
(∗)
For a suitable choice of c1, . . . , cn−1, we shall show in a moment that
the polynomial
f (X′
1 + c1Xn, . . . , X′
n−1 + cn−1Xn, Xn)
is monic in Xn
(∗∗)
after multiplication by a member of k×.
Assuming (∗∗), let us see how the ﬁrst conclusion of the lemma follows by induction on n. For
n = 1, there are two cases. One case is that K is a simple algebraic extension ﬁeld of k, and then
every element of the extension ﬁeld R = K is a root of its minimal polynomial over k. This is the
case d = 0. The other case is that K is a simple transcendental extension, and then we can take
y1 = x1. This is the case d = 1.
For the inductive step, assume the ﬁrst conclusion of the lemma for n −1 ≥1, d being an integer
with 0 ≤d ≤n −1. If I = 0, there is nothing to prove, since x1, . . . , xn are then algebraically

8. Classification Questions about Irreducible Curves
613
independent and the lemma follows with d = n and with yj = xj for 1 ≤j ≤n. If I ̸= 0, ﬁx f ̸= 0
in I, and choose c1, . . . , cn−1 in k to make (∗∗) hold. Then (∗) shows that xn is a root of a monic
polynomial with coefﬁcients in R′ = k[x′
1, . . . , x′
n−1]. By the inductive hypothesis we can choose
members y′
1, . . . , y′
d of R′ with 0 ≤d ≤n −1 such that y′
1, . . . , y′
d are algebraically independent
over k and such that every element of R′ is integral over k[y′
1, . . . , y′
d]. By transitivity of integral
dependence, every element of R′[xn] is integral over k[y′
1, . . . , y′
d]. Since the deﬁnition of x′
j in
terms of xj shows that R′[xn] = k[x′
1, . . . , x′
n−1, xn] = k[x1, . . . , xn−1, xn] = R, every element of
R is integral over k[y′
1, . . . , y′
d]. This completes the induction, and the ﬁrst sentence of conclusions
of the lemma is proved except for (∗∗).
To prove (∗∗), let r = deg f , and write f = hr + g with hr nonzero and homogeneous of degree
r and with deg g ≤r −1 (or g = 0). Then
f (X1, . . . , Xn) = f (X′
1 + c1Xn, . . . , X′
n−1 + cn−1Xn, Xn)
= hr(c1Xn, . . . , cn−1Xn) + (terms involving 1, Xn, X2
n, . . . , Xr−1
n
)
= hr(c1, . . . , cn−1, 1)Xr
n + (terms involving 1, Xn, X2
n, . . . , Xr−1
n
).
Thus (∗∗) is proved if c1, . . . , cn−1 can be chosen with the scalar hr(c1, . . . , cn−1, 1) not 0. Here the
fact that hr is nonzero and homogeneous implies that hr(X1, . . . , Xn−1, 1) is not the 0 polynomial
in k[X1, . . . , Xn−1]. Since k is an inﬁnite ﬁeld, Corollary 4.32 of Basic Algebra shows that the
evaluation mapping of k[X1, . . . , Xn−1] into the algebra of functions from kn−1 into k is one-one,
and therefore there exist c1, . . . , cn−1 with hr(c1, . . . , cn−1, 1) ̸= 0. This proves (∗∗).
We are left with proving that if K is separably generated over k, then the yi may be chosen with
K separable over k(y1, . . . , yd). We proceed as above but with an amended version of (∗∗) that we
mention in a moment. In the induction the extra hypothesis for n = 1 is that either x1 is separable
algebraic over k or x1 is transcendental, and in both cases K is a separable extension of k(y1).
For the inductive step when I ̸= 0, Theorem 7.18 shows that {x1, . . . , xn} contains a separating
transcendence basis; possibly by renumbering the variables, we may assume that this transcendence
basis is a subset of {x1, . . . , xn−1}. In particular, xn is separable algebraic over k(x1, . . . , xn−1). For
the polynomial f , we start from the minimal polynomial of xn over k(x1, . . . , xn−1), next multiply
by a common denominator to get all coefﬁcients of powers of Xn to be in k[x1, . . . , xn−1], and then
replace the occurrences of x1, . . . , xn−1 by X1, . . . , Xn−1. The result is f . We choose y′
1, . . . , y′
d
as above, and the inductive hypothesis shows that k(x′
1, . . . , x′
n−1) is separable over k(y′
1, . . . , y′
d).
If we can show that xn is separable over k(x′
1, . . . , x′
n−1), then we will have proved that K is a
separable extension of k(y′
1, . . . , y′
d) because of the transitivity of separability. So the induction will
be complete.
To get that xn is separable over k(x′
1, . . . , x′
n−1), it is enough to prove that we can arrange for
xn
to be a simple root of
f (x′
1 + c1Xn, . . . , x′
n−1 + cn−1Xn, Xn)
(†)
in addition to (∗∗). Indeed, then xn is a root of a separable polynomial over k(x′
1, . . . , x′
n−1) and
hence is a separable element over k(x′
1, . . . , x′
n−1). The condition (†) is the same as the condition
that the derivative of (†) with respect to Xn, when evaluated at xn, be nonzero. Thus we want to
arrange that
fn(x1, . . . , xn−1, xn) + c1 f1(x1, . . . , xn−1, xn) + · · · + cn−1 fn−1(x1, . . . , xn−1, xn) ̸= 0,
(††)
where the subscripts on f indicate ﬁrst partial derivatives in the indicated variables. The left side
of (††) is the sum of a constant and a linear functional on the vector space of all (c1, . . . , cn−1) in
kn−1. The constant term is fn(x1, . . . , xn−1, xn), which is nonzero because xn is separable over
k(x1, . . . , xn−1) and is therefore a simple root of its minimal polynomial over k(x1, . . . , xn−1). Thus
the left side of (††) is the value of a nonzero polynomial p(X1, . . . , Xn−1) = an + n−1
j=1 aj Xj
at (c1, . . . , cn−1).
Consequently (∗∗) and (††) will hold simultaneously if we choose a point
(c1, . . . , cn−1) in kn−1 at which the nonzero polynomial p(X1, . . . , Xn−1)hr(X1, . . . , Xn−1, 1) is
not zero.
□

614
X. Methods of Algebraic Geometry
Proof of Theorem 10.57 under the assumption that k is algebraically closed.
The ﬁrst step is to reduce to the case that L = K, i.e., that the ﬁeld of fractions of R coincides with
L. To do so, choose a vector-space basis {z1, . . . , zr} of L over K consisting of elements integral
over R; this is possible by Proposition 8.42 of Basic Algebra. Put S = R[z1, . . . , zr]. This is a
ﬁnitely generated integral domain over k, all of its elements are integral over k, and it has L as ﬁeld
of fractions. The integral closure of R in L equals the integral closure of S in L.
Thus we may assume that R = k[x1, . . . , xn] is an integral domain with ﬁeld of fractions K and
that we are to prove that the integral closure T of R in K is a ﬁnitely generated R module. Let d be
the transcendence degree of K over k. Since algebraically closed ﬁelds are perfect, Theorem 7.20
shows that K is separably generated over k. Lemma 10.62 is therefore applicable, and it produces
d linear combinations y1, . . . , yd of x1, . . . , xn over k such that the subring S = k[y1, . . . , yd] of
R is a full polynomial ring, every element of R is integral over S, and K is a separable extension
of the ﬁeld k(y1, . . . , yd). Since every element of T is integral over R, the transitivity of integral
dependence implies that every element of T is integral over S. Therefore T is the integral closure
of S in K. Being a full polynomial ring, S is Noetherian and is a unique factorization domain; the
latter property implies that S is integrally closed, according to Proposition 8.41 of Basic Algebra.
Taking S to be the Noetherian integrally closed domain in Lemma 10.61, we see that T is ﬁnitely
generated as an S module. Since S ⊆R, T is certainly ﬁnitely generated as an R module.
□
Now we come to the main theorem of this section.
Theorem 10.63. Every birational equivalence class of irreducible projective
curves contains a nonsingular such curve, and this curve is unique within the
equivalence class up to isomorphism of varieties. Any irreducible nonsingular
quasiprojective curve is isomorphic to an open subvariety of some irreducible
nonsingular projective curve.
REMARKS. The new content of the theorem is the existence of the nonsingu-
lar projective curve. The uniqueness is immediate from Corollary 10.55. The
statement about nonsingular quasiprojective curves is a formality: Such a curve
C0 is birational to the nonsingular projective curve C produced by the theorem
and also to the projective closure C0 of C0. The birational maps from C0 into
C and from C into C0 yield morphisms from C0 into C and from C into C0 by
Corollary 10.54; sorting out these morphisms shows that C0 is isomorphic to an
open subvariety of C.
The idea for proving the existence of the projective curve in the theorem is to
start with any function ﬁeld K in one variable over k, take any discrete valuation
v of K deﬁned over k (these exist as a consequence of Section VI.2), and use
Corollary 10.59 to obtain some irreducible nonsingular afﬁne curve having K as
functionﬁeldandhavingitslocalringatsomepointequaltothevaluationringofv.
Corollary 10.60 shows that except for ﬁnitely many discrete valuations, we have
associated a nonsingular point on some irreducible afﬁne curve in the birational
equivalence class to each discrete valuation of K deﬁned over k.
Applying
Corollary 10.59 to each of these exceptional discrete valuations, we end up with a
ﬁnite set of irreducible nonsingular afﬁne curves such that each discrete valuation

8. Classification Questions about Irreducible Curves
615
of K over k corresponds to some point of at least one of the curves. We shall
glue together these irreducible nonsingular afﬁne curves in a suitable fashion to
obtain the desired irreducible nonsingular projective curve.
The proof makes use of the fact that the product of two projective varieties
is a projective variety and that morphisms behave as one might expect. Let us
postpone the details of establishing a rigorous theory of product varieties, going
right to the proof of Theorem 10.63.
PROOF OF THEOREM 10.63. LetKbethegivenfunctionﬁeld, andletC1,. . ., Cm
be the irreducible nonsingular afﬁne curves described two paragraphs before this
paragraph. In each case the function ﬁeld of the curve is isomorphic to K by
some ﬁxed isomorphism, but we shall treat this ﬁxed isomorphism as if it were
the identity in order to avoid unnecessary complications in the notation. Let VK
be the set of discrete valuations of K deﬁned over k. For v ∈VK, we write
Rv ⊆K for the valuation ring of v and pv for the valuation ideal of v.
For deﬁniteness let Cj be an afﬁne variety in Akj, and let C1, . . . , Cn be the
respective projective closures of C1, . . . , Cm in Pkj. For any point P in Cj, let
MP be the maximal ideal of the local ring OP(C j).
Theorem 10.53 gives us for each j a well-deﬁned function γj : VK →C j, and
Corollary 10.58 says that γj is onto C j. The deﬁning property of γj(v) is that
Mγj(v) ⊆pv, and it follows that Oγj(v)(C j) ⊆Rv. Corollary 10.51 shows that the
inverse image under γj of any point in Cj is a singleton set, and Corollary 10.60
shows that the inverse image of any point of the complementary set C j −Cj
is a ﬁnite set.
Let F be the ﬁnite subset F = m
j=1 γ −1
j
(C j −Cj) of VK.
For v /∈F, γj(v) is a nonsingular point of Cj, and Corollary 10.51 shows that
Oγj(v)(Cj) = Rv. Hence also Mγj(v) = pv. The construction of the curves
C1, . . . , Cm was arranged in such a way that
each v ∈VK has γj(v) in Cj for some j.
(∗)
Let Uj be the open set of Cj given by Uj = γj(VK −F). The curves C j are
birationally equivalent because they all have K as function ﬁeld, and Corollary
10.54 shows that the largest domain on which the birational map from C j to C1
is a morphism includes all the nonsingular points of C j. In particular, it contains
Uj = γj(VK −F). If ϕj is the morphism from Uj into C1, then Proposition
10.42 shows that ϕj induces a homomorphism ϕ∗
j,P : Oϕj(P)(C1) →OP(Cj) for
P ∈Uj. By assumption, the isomorphism ϕj : k(C1) →k(Cj) is normalized to
be the identity. Since ϕj is the ﬁeld mapping corresponding to the birational map
ϕj, ϕj is an extension of ϕ∗
j,P. Thus ϕ∗
j,P is the identity under our identiﬁcations:
Oϕj(P)(C1) = OP(Cj) for P ∈Uj. Let P = γj(v) with v in VK −F, and let
ϕj(P) = γ1(v′) with v′ in VK. Then Rv = Oγj(v)(Cj) = Oϕj(P)(C1) ⊆Rv′, and

616
X. Methods of Algebraic Geometry
it follows that v′ = v. In particular, v′ is in VK −F, and γ1(v) = ϕj(γj(v)).
Hence
ϕj ◦γj : VK −F →U1
is independent of j,
ϕj : Uj →U1
is an isomorphism.
and
The product W = C1 × · · · × Cm is an m-dimensional closed subvariety of
Pk1 × · · · × Pkm, which in turn is a projective variety in PN for a suitably large N.
For 1 ≤j ≤m, let πj : W →C j be the jth projection map; this is a morphism.
The set U1 × · · · × Um is an open subvariety of W, and the “diagonal”
 =

δ(P) =

P, ϕ−1
2 (P), . . . , ϕ−1
m (P)
  P ∈U1

of U1 × · · · × Um is an irreducible curve isomorphic to U1. The closure C = 
is an irreducible projective curve. It is a closed subvariety of W, and it has  as
an open subvariety. The curve  may be identiﬁed with U1 via the projection π1,
and we may therefore identify the function ﬁeld of , which is the same as the
function ﬁeld of C, with K.
We shall show that C is nonsingular. For each j, the restriction πj : C →C j is
a morphism, and the image contains all points πj(δ(P)) = ϕ−1
j (P) with P ∈U1.
Hence it contains Uj, which is an open subset of C j. In other words, πj : C →
C j is a dominant morphism. For P ∈U1, we have πj(δ(P)) = ϕ−1
j (P). If
Q = δ(P), this says that πj(Q) = ϕ−1
j δ−1(Q), from which it follows that
δ ◦ϕj is a two-sided inverse of πj on . Consequently the dominant morphism
πj : C →C j is a birational map. Let (Vj, ψj) be a pair in the class of the rational
map π−1
j
; we may assume that Vj is the largest domain in C j on which π−1
j
is a
morphism.
Let P be any point of C, and let MP be the maximal ideal of OP(C). Corollary
10.58 shows that there is a memberv of VK such that MP ⊆pv. Choose j = j(P)
with 1 ≤j ≤m such that γj(v) is in Cj. Since every point of Cj is a nonsingular
point by construction, Corollary 10.54 shows that every point of Cj lies in the
domain Vj on which ψj is deﬁned as a morphism inverting πj. Consequently the
open subvariety π−1
j
(Cj) of C is isomorphic to the nonsingular irreducible afﬁne
curve Cj, and the point P of C has an open neighborhood of nonsingular points.
Since P is arbitrary, C is nonsingular.
□
The remainder of this section develops a small theory of products of varieties
in projective spaces. Most of the proofs are left to the problems at the end of the
chapter. It is enough to handle the product of two varieties because general ﬁnite
products of varieties can then be treated by induction.
We begin with the product of two projective spaces. Let m ≥1 and n ≥1 be
integers, and put N = (m + 1)(n + 1) −1 = mn + m + n. We shall exhibit

8. Classification Questions about Irreducible Curves
617
Pm × Pn as a projective variety in PN. To do so, we coordinatize Pm, Pn, and PN
by using xi, yj, and wi j for 0 ≤i ≤m and 0 ≤j ≤n. Then
Pm =

[x0, . . . , xm]

,
Pn =

[y0, . . . , yn]

,
and
PN =

[w00, w01, . . . , wm,n−1, wmn]

.
The Segre embedding is the function
σ

[x0, . . . , xm], [y0, . . . , yn]

= [x0y0, x0y1, . . . , xm yn−1, xm yn],
i.e., wi j = xi yj. Deﬁne a ⊆k[W00, . . . , Wmn] to be the homogeneous ideal
generated by all Wi jWkl −WilWkj. Problems 17–19 at the end of the chapter
show that σ is well deﬁned and one-one, that the image of σ is V (a), and that
V (a) is irreducible. Thus the Segre embedding exhibits Pm × Pn as a projective
variety in PN. This variety is known as a Segre variety.18
Let U ⊆Pm and V ⊆Pn be projective algebraic sets.
Then the Segre
embedding σ carries U ×V to a subset of PN, and we wish to see that σ(U ×V ) is
a projective algebraic set in PN. Let us use the abbreviation X = (X0, . . . , Xm).
If α = (α0, . . . , αm) is an (m + 1)-tuple of nonnegative integers, we deﬁne
|α| = α0+· · ·+αm and Xα = Xα0
0 · · · Xαm
m . We deﬁne Y, β, |β|, and Y β similarly.
Any monomial XαY β with |α| = d and |β| = e is said to be bihomogeneous of
bidegree (d, e). A bihomogeneous polynomial of bidegree (d, e) is any linear
combination of bihomogeneous monomials of bidegree (d, e).
Theﬁrstobservationisthatanyprojectivealgebraicset S inPm canbedescribed
as the locus of common zeros of a vector space of homogeneous polynomials in
X of a ﬁxed degree. In fact, we know that S is given by the locus of common
zeros of a ﬁnite set of homogeneous polynomials F1(X), . . . , Fr(X) of various
degrees d1, . . . , dr. Let us say that d = maxj dj. The point is that S is given
by the locus of common zeros of a ﬁnite set of homogeneous polynomials all of
degree d. The reason is that the locus of common zeros of Fj(X) is the same
as the locus of common zeros of X
d−dj
0
Fj(X), . . . , X
d−dj
m
Fj(X). The assertion
about describing S follows.
Now let U ⊆Pm be the locus of common zeros of homogeneous polynomials
F1(X), . . . , Fr(X) all of degree d, and let V ⊆Pn be the locus of common zeros
of homogeneous polynomials G1(Y), . . . , Gr(Y) all of degree e. Then U × V
is the locus of common zeros of the bihomogeneous polynomials Fa(X)Gb(Y),
all of bidegree (d, e). These cannot immediately be expressed in terms of the
polynomials Wi j of the Segre embedding. However, if we use the same trick
again, we can substitute the Wi j’s. Speciﬁcally suppose that d ≤e. Replace
18If we form the (m + 1)-by-(n + 1) matrix whose (i, j)th entry is Wi j, then an equivalent
description of the Segre variety is as the locus of common zeros of all 2-by-2 minors of this matrix.

618
X. Methods of Algebraic Geometry
F1(X), . . . , Fr(X) by a family of r(m + 1) polynomials F′
1(X), . . . , F′
r(m+1)(X)
homogeneous of degree e.
Then the polynomials F′
a(X)Gb(Y) are bihomo-
geneous of bidegree (e, e). When such a polynomial is expanded as a linear
combination of monomials, each monomial hase factors from among X0, . . . , Xm
and e factors from among Y0, . . . , Yn. We can pair the factors in whatever fashion
we want and replace XiYj by Wi j. In this way our system of bihomogeneous
polynomials can be rewritten as a system of polynomials Hab(W), together with
the convention that Wi j = XiYj. Then σ(U ×V ) is the locus of common zeros in
PN of the polynomials Hab(W) and the deﬁning polynomials of the Segre variety.
Conversely if we have a projective algebraic set in PN, then its intersection
with the Segre variety can be described as the locus of common zeros in Pm × Pn
of a family of bihomogeneous polynomials in (X, Y). We have only to take the
deﬁning homogeneous polynomials H(W) and substitute the deﬁnition Wi j =
XiYj for Wi j.
If H(W) is homogeneous of degree e, then the result of the
substitution is a polynomial bihomogeneous of bidegree (e, e).
Problems 20–21 at the end of the chapter show that if U and V are irreducible
closed sets in Pm and Pn, respectively, then σ(U × V ) is irreducible in PN. Thus
we can meaningfully speak of projective varieties in Pm × Pn. The same pair of
problems addresses what happens for quasiprojective varieties, showing that σ of
any relatively open subset of a projective variety in Pm × Pn is a quasiprojective
variety in PN.
Now that the notion of variety is meaningful in Pm ×Pn, with an interpretation
in PN, we can similarly translate deﬁnitions and facts about morphisms to make
them apply in Pm × Pn. In particular, the projection of a variety to either factor
Pm or Pn is a morphism on the variety. If U is a quasiprojective variety and if
ϕ1 : U →Pm and ϕ2 : U →Pn are isomorphisms of U onto quasiprojective
varieties in Pm and Pn, then the diagonal  = {(ϕ1(u), ϕ2(u)) | u ∈U} is a
quasiprojective variety in Pm × Pn, and the pair (ϕ1, ϕ2) is an isomorphism of
varieties. These matters are discussed in Problem 22 at the end of the chapter.
9. Afﬁne Algebraic Sets for Monomial Ideals
Sections 9–12 in part address aspects of the question of how much one can
make explicit computations with afﬁne and projective varieties. As a general
rule, the tool for such computations is the theory of Gr¨obner bases, which were
introduced in Sections VIII.7–VIII.10. The topic is an active area of continuing
research.19 One can think of immediate problems—such as ﬁnding the dimension
of an algebraic set, determining the radical of an ideal when the ideal is given,
19The book edited by Buchberger and Winkler contains a number of expository “tutorials” that
give an idea of the breadth of applications of the theory. The book contains also a certain number of
research papers.

9. Affine Algebraic Sets for Monomial Ideals
619
and deciding whether an ideal is prime. We shall concentrate on just one such
problem, that of ﬁnding the dimension.20
Part of the abstract theory in this case dates back to Hilbert, but in combination
with the theory of Gr¨obner bases it becomes easier to establish and relatively easy
to implement computationally.21 We shall prove in Section 12 as a consequence
of this investigation the deep theorem that a system of simultaneous homogeneous
polynomial equations having more equations than variables always has a nonzero
solution.22
Hilbert associated a polynomial in one variable, now known as the “Hilbert
polynomial,” to each ideal of polynomials over an algebraically closed ﬁeld.
This polynomial encodes certain algebraic information about the ideal, and some
features of this polynomial depend only on the geometry of the zero locus. In
particular, the degree of the polynomial turns out to equal the geometric dimension
of the zero locus, and that will be what interests us.
The theory behind Gr¨obner bases enables one to reduce the theory of the
Hilbert polynomial to the case of a monomial ideal, for which it is relatively easy
to understand.23 We begin with that case in this section.
Let k be an algebraically closed ﬁeld, consider afﬁne space An, and let a be
an ideal in A = k[X1, . . . , Xn]. In this section we shall be interested in the case
that a is generated by monomials, in which case it is called a monomial ideal.
The structure of monomial ideals is captured by Lemma 8.17, which says about
such an ideal a that
• for any polynomial f ̸= 0 in a, each monomial term contributing to f
lies in a,
• a has a ﬁnite set of monomials as generators,
• if {M1, . . . , Mk} is a set of monomials that generate a and if M is any
monomial in a, then some Mj divides M.
Let e1, . . . , en be the standard basis of An, and let ⟨ej1, . . . , ejk⟩be the lin-
ear span of ej1, . . . , ejk. The vector space ⟨ej1, . . . , ejk⟩is called a coordinate
subspace of An.
The ideal pk = (X1, . . . , Xk) in A is prime, and its va-
riety is V (pk) = ⟨ek+1, . . . , en⟩.
Since p0 ⊆p1 ⊆· · · ⊆pn is a strictly
increasing sequence of prime ideals in A and since A has Krull dimension n,
20Solutions to the other two problems are known as well. References may be found in Cox–
Little–O’Shea. For determining the radical, see p. 177. For deciding whether an ideal is prime, see
p. 207.
21The exposition in Sections 9–12 is based in part on Chapter 9 of the book by Cox–Little–O’Shea
and in part on Chapter I of Hartshorne’s book.
22For one equation with two variables, this amounts to the Fundamental Theorem of Algebra.
For two equations with three variables, it amounts to the existence part of Bezout’s Theorem as
formulated in Theorem 8.5.
23Similarly the computations associated with Gr¨obner bases make it possible to reduce the
computation of the Hilbert polynomial of a general ideal to the computation of the Hilbert polynomial
of a monomial ideal.

620
X. Methods of Algebraic Geometry
no strictly increasing sequence of prime ideals containing pk can be longer than
pk ⊆pk+1 ⊆· · · ⊆pn.
It follows that the images of these ideals in A/p
give a strictly increasing sequence of prime ideals of maximal length and that
A/p has Krull dimension n −k. By Theorem 10.7 the geometric dimension of
V (pk) = ⟨ek+1, . . . , en⟩is n −k. In other words, the geometric dimension of
the vector subspace ⟨ek+1, . . . , en⟩is the same as the vector-space dimension.
Relabeling indices in this computation, we see that the geometric dimension of
⟨ej1, . . . , ejk⟩is k if the indices j1, . . . , jk are distinct.
Let us compute the geometric dimension of the zero locus of a general proper
monomial ideal (M1, . . . , Mk). If α = (α1, . . . , αn) is a tuple of integers ≥0,
we write Xα for Xα1
1 · · · Xαn
n and |α| for α1 + · · · + αn. Let Hj = V (X j) be the
coordinate hyperplane of points in An with jth coordinate 0. This is the linear
span of all ei for i ̸= j, and it has geometric dimension n −1. If a monomial Xα
is given, then Proposition 10.1 shows that
V (Xα) = 
αj>0
V (X j) = 
αj>0
Hj
and then that
V (Xα, Xβ) =
 
αi>0
Hi

∩
 
βj>0
Hj

=

αi>0, βj>0
(Hi ∩Hj).
Similarly V (M1, . . . , Mk) is a ﬁnite union of k-fold intersections of coordinate
hyperplanes. By Theorem 10.7 the geometric dimension of V (M1, . . . , Mk) is the
maximum dimension of the subspaces Hi ∩Hj ∩· · · appearing in the appropriate
union for M1, . . . , Mk. To get the maximum dimension, we want as few distinct
indices to appear in an intersection Hi ∩Hj ∩· · · . If the smallest possible number
of distinct indices is m, then we see that V (M1, . . . , Mk) has geometric dimension
n −m.
The insight is that to study V (a), one studies A/a, and that to study the latter,
one considers what happens as a function of s to the part of A/a that corresponds
to degree at most s. In the case of a monomial ideal, this means that one is to study
the monomials outside the ideal in question, particularly how the number of these
monomials grows with s. Let M be the set of all monomials in k[X1, . . . , Xn].
For our monomial ideal a, let C(a) be the complementary subset to a in M given
by
C(a) =

Xα | Xα /∈a

.
Proposition 10.64. If a is a proper monomial ideal in k[X1, . . . , Xn], then
(a) the vector subspace V

Xi | i /∈{ j1, . . . , jk}

is contained in V (a) if
and only if

Xα ∈M | α ∈⟨ej1, . . . , ejk⟩

is contained in C(a),
(b) the geometric dimension of V (a) equals the largest vector-space dimen-
sion of a coordinate subspace that lies in C(a).

9. Affine Algebraic Sets for Monomial Ideals
621
REMARK. The hypothesis “proper” is needed for (b), not for (a).
PROOF. For (a), ﬁrst suppose that V

Xi | i /∈{ j1, . . . , jk}

is contained in
V (a), and suppose that α is in ⟨ej1, . . . , ejk⟩. Let P = (x1, . . . , xn) be the point
with
xi =
 1
for i ∈{ j1, . . . , jk},
0
for i /∈{ j1, . . . , jk}.
(∗)
Then P is on the zero locus of each Xi for i /∈{ j1, . . . , jk}, and hence P is in
V (a). On the other hand, the value of the monomial Xα at P is 1. Since the value
of every member of a at P is 0, Xα cannot be in a. Thus Xα is in C(a).
Next suppose that E = V

Xi | i /∈{ j1, . . . , jk}

is not contained in V (a).
Say that P = (x1, . . . , xn) is in E but not V (a). The condition for P to be in E
is that xi = 0 for all i /∈{ j1, . . . , jk}. Since P is not in V (a), some member of a
is nonzero at P. The ideal is generated by monomials, and thus some monomial
Xα0 in a is nonzero at P. Let α0 = (α1, . . . , αn). The (nonzero) value of α0 on
P is 
i with αi>0 xαi
i . Now xi = 0 for all i /∈{ j1, . . . , jk}, and consequently no i
outside { j1, . . . , jk} can have αi > 0. Thus α0 is in ⟨ej1, . . . , ejk⟩, and α0 exhibits

Xα ∈M | α ∈⟨ej1, . . . , ejk⟩

as failing to be contained in C(a).
For (b), we saw before the proof that V (a) is the union of ﬁnitely many vector
subspaces and that each vector subspace is an afﬁne variety whose geometric
dimension equals its vector-space dimension. By Theorem 10.7 the geometric
dimension of V (a), a being proper, is the maximum of the dimensions of these
subspaces. Taking (a) into account, we conclude that (b) holds.
□
We seek a formula for the number of monomials in C(a) of total degree ≤s
when s is large and positive. We begin with a lemma. For a monomial ideal
a, the function carrying each integer s ≥0 to the number of Xα in C(a) with
|α| ≤s is called the afﬁne Hilbert function of a and is denoted by Ha(s, a).
For a = k[X1, . . . , Xn], the afﬁne Hilbert function is identically 0, and we shall
usually not be interested in this case.
EXAMPLE. For n = 1 with one indeterminate X, the proper ideals of k[X] are 0
and (Xk) with k > 0. The monomials Xα with |α| ≤s are 1, X, X2, . . . , Xs. By
inspection, none of these is in a if a = 0, and thus Ha(s, 0) = s + 1. In the case
of (Xk) with k > 0, the monomials Xα in C((X)k) are 1, X, . . . , Xk−1, and thus
Ha(s, (Xk)) is s + 1 for s ≤k −1 and is k for s ≥k −1.
Theorem 10.65. If a is a proper monomial ideal in k[X1, . . . , Xn], then the
complementary set C(a) of monomials is a disjoint union
C(a) = C0 ∪· · · ∪Cn,
where Ck is a ﬁnite union of subsets of the form
E =

Xα ∈M | α ∈⟨ej1, . . . , ejk⟩+
	
i /∈{ j1,..., jk}
aiei

.

622
X. Methods of Algebraic Geometry
Here it is assumed that ⟨ej1, . . . , ejk⟩is a k-dimensional coordinate subspace and
the coefﬁcients ai are particular integers ≥0.
REMARKS. The subsets of M of which the above set E is an example will be
called standard subsets of M with k parameters. The member 	
i /∈{ j1,..., jk} aiei
of M is called the associated translation of E, and ⟨ej1, . . . , ejk⟩is called the
associated vector subspace of E. Standard subsets of M with 0 parameters are
singleton sets {Xα}. An example of a standard subset of M with 1 parameter
when n = 2 is {Xα1
1 Xα2
2
| α1 ≥0, α2 = 2} = {Xα | α ∈⟨e1⟩+ 2e2}. It
is apparent that the one and only circumstance in which Cn is nonempty is that
C(a) = M, in which case a = 0.
PROOF. We proceed by induction on n, and we may assume that a ̸= 0. The
example above shows for n = 1 that C(a) is a ﬁnite set if a is a nonzero proper
ideal. Thus C(a) = C0 in this case, and the base case of the induction is settled.
Assume inductively that the theorem has been proved for n−1 indeterminates,
and let a be a nonzero ideal in k[X1, . . . , Xn]. Let Mn−1 and Mn denote the
sets of monomials in X1, . . . , Xn−1 and X1, . . . , Xn, respectively. For j ≥0, let
aj be the ideal in k[X1, . . . , Xn−1] of all polynomials f (X1, . . . , Xn−1) such that
X j
n f (X1, . . . , Xn−1) is in a. The ideals aj are monomial ideals because a is a
monomial ideal, and aj ⊆aj+1 for all j. Since k[X1, . . . , Xn−1] is Noetherian,
there is some index l such that aj = al for all j ≥l. We apply the inductive
hypothesis to a0, a1, . . . , al, writing
C(aj) = C0, j ∪· · · ∪Cn−1, j
for 0 ≤j ≤l.
Here each Ck, j is a ﬁnite union of standard subsets with k parameters in the n −1
indeterminates X1, . . . , Xn−1.
Let Ck, j X j
n be the set of all products of members of Ck, j with X j
n. We shall
show that
C(a) = C0 ∪· · · ∪Cn,
(∗)
where C0, . . . , Cn are deﬁned by
Ck+1 =
∞

j=0
Ck,l X j
n ∪
l−1

j=0
Ck+1, j X j
n
for 0 ≤k ≤n −1
C0 = C(a) −
n
k=1
Ck.
and
But ﬁrst let us see that each Ck+1 for 0 ≤k ≤n −1 is a ﬁnite union of standard
subsets of Mn with k + 1 parameters. Each Ck+1, j is a ﬁnite union of standard
subsets of Mn−1 with some associated translation γ such that γn = 0 and with
an associated vector subspace ⟨ej1, . . . , ejk+1⟩such that j1 < · · · < jk+1 < n.
Then each Ck+1, j X j
n is a ﬁnite union of standard subsets of M of the form Xα

9. Affine Algebraic Sets for Monomial Ideals
623
with associated translation γ + jen and with the same associated vector space
⟨ej1, . . . , ejk+1⟩. Similarly the set ∞
j=0 Ck,l X j
n is a ﬁnite union of standard subsets
of M with associated translation γ + 0en and with associated vector space of
the form ⟨ej1, . . . , ejk, en⟩. Thus Ck+1 is a ﬁnite union of standard subsets of Mn
with k + 1 parameters.
Let us verify (∗). The most general monomial in k[X1, . . . , Xn] is Xβ X j
n with
Xβ in k[X1, . . . , Xn−1], and this monomial is in a if and only if Xβ is in aj.
Hence Xβ X j
n is in C(a) if and only if Xβ is in C(aj). Since aj = al for j ≥l,
C(aj) = C(al) for j ≥l. Thus
C(a) =
 ∞

j=l
C(al)X j
n

∪
 l−1

j=0
C(aj)X j
n

.
(∗∗)
If j ≤l, then Xβ Xl
n ∈C(a) implies Xβ X j
n ∈C(a), since Xl−j
n
a ⊆a. Therefore
C(aj) ⊇C(al) for all j ≤l, and we see that j ≤l implies that C(aj) =
C(aj) ∪C(al). Substituting into (∗∗) and rearranging terms gives
C(a) =
 ∞

j=0
C(al)X j
n

∪
 l−1

j=0
C(aj)X j
n

.
(†)
For j ≤l, Xβ is in C(aj) if and only if Xβ is in one of C0, j, . . . , Cn−1, j. Thus
we can rewrite (†) as
C(a) =
 ∞

j=l
n−1

k=0
Ck,l X j
n

∪
 l−1

j=0
n−1

k=0
Ck, j X j
n

=
 ∞

j=l
n−1

k=0
Ck,l X j
n

∪
 l−1

j=0
n−2

k=0
Ck+1, j X j
n

∪
 l−1

j=0
C0, j X j
n

.
The ﬁrst term on the right side contributes to Ck+1, with en to be adjoined to the
basis vectors of the associated vector subspace ⟨ej1, . . . , ejk⟩. Equating the terms
on the two sides that contribute to Ck+1 therefore yields (∗). The set C0 is the
last term on the right side. This is ﬁnite because each C0, j is ﬁnite, and therefore
C0 has the correct form.
□
Lemma 10.66. Let E be a standard subset of M with k parameters, and let
γ be its associated translation. Then the number of monomials Xα with |γ | ≤s
such that α is in E is equal to the binomial coefﬁcient
k + s −|γ |
s −|γ |

if s > |γ |. This expression is a polynomial function of s of degree k, and the
coefﬁcient of sk is 1/k!.

624
X. Methods of Algebraic Geometry
PROOF. Let ⟨ej1, . . . , ejk⟩be the associated vector subspace for E. The asso-
ciated translation γ is assumed to have γi = 0 for i in { j1, . . . , jk}. We are to
count monomials Xα = Xγ Xβ with β in ⟨ej1, . . . , ejk⟩and with |γ + β| ≤s.
Since |γ | + |β| = |γ + β| ≤s, the latter condition on β is that |β| ≤s −|γ |,
which by assumption is ≥0. The entries of β are allowed to be arbitrary nonzero
integers in the k entries j1, . . . , jk, subject only to the limitation that the sum of
the entries is to be ≤s −|γ |. The number of such β’s equals the number of
homogeneous monomials in k + 1 variables of total degree equal to s −|γ |. This
number is recalled in a bulleted list in Section 3 and is
s−|γ |+k
k

=
s−|γ |+k
s−|γ |

.
When expanded out, this binomial coefﬁcient equals
1
k! (s + k −|γ |)(s + k −1 −|γ |) · · · (s + 1 −|γ |),
which is a polynomial function of s of degree k with leading coefﬁcient 1/k!. □
Lemma 10.67. Let E and F be standard subsets of M with k and l parameters,
respectively. Then E ∩F either is empty or is a standard subset of M with m
parameters, where m ≤min(k,l). Moreover, the only way that m can equal
max(k,l) is for E to equal F.
PROOF. Denote the respective associated translations for E and F by γE and
γF, and let SE and SF be the subsets of {1, . . . , n} such that ⟨ei | i ∈SE⟩and
⟨ei | i ∈SF⟩are the associated vector spaces for E and F, respectively. Let TE
be the subset of indices
TE =

i ∈{1, . . . , n} | (γE)i > 0

,
and deﬁne TF similarly. We are given that |SE| = k and |SF| = l. Also, we are
given that SE ∩TE = ∅and SF ∩TF = ∅, i.e., that TE ⊆Sc
E and TF ⊆Sc
F. If
E ∩F ̸= ∅, then there exist x and y with
γE + x = γF + y
such that xi = 0 for i /∈SE and yj = 0 for j /∈SF. (∗)
Then xi = yi = 0 for i ∈Sc
E ∩Sc
F, and we see that a necessary condition to have
E ∩F ̸= ∅is that (γE)i = (γF)i for i ∈Sc
E ∩Sc
F. In this case the x and y in (∗)
must have xi = (γF)i for i ∈SE ∩Sc
F and yi = (γE)i for i ∈Sc
E ∩SF.
Conversely if (γE)i = (γF)i for i ∈Sc
E ∩Sc
F, then we can deﬁne xi = (γF)i
for i ∈SE ∩Sc
F, yi = (γE)i for i ∈Sc
E ∩SF, and xi = yi to be arbitrary for
i ∈SE ∩SF, and we obtain solutions of (∗). It is evident that all solutions of
(∗) are obtained this way. Consequently E ∩F is the standard subset of M with
|SE ∩SF| parameters; with associated translation γ having γi equal to γE on Sc
E,
equal to γF on Sc
F, and equal to 0 on SE ∩SF; and with associated vector space
⟨ei | i ∈S⟩, where S = SE ∩SF.
The inequality dimk(SE ∩SF) ≤min(dimk SE, dimk SF) is the inequality
m ≤min(k,l) of the lemma. If m = max(k,l), then we must have S = SE = SF
and an equality (γE)i = (γF)i for i ∈Sc
E ∩Sc
F, i.e., for i /∈S. The latter equality
implies that γE = γF. Hence E = F.
□

9. Affine Algebraic Sets for Monomial Ideals
625
Theorem 10.68. If a is a monomial ideal in k[X1, . . . , Xn] such that V (a) has
geometric dimension d, then there exists a polynomial Ha(s, a) in one variable
of degree d such that the afﬁne Hilbert function Ha(s, a) is equal to Ha(s, a) for
all positive s sufﬁciently large. The leading coefﬁcient of Ha(s, a) is positive.
REMARK. The polynomial Ha(s, a) is called the afﬁne Hilbert polynomial
of the monomial ideal a. It is of course uniquely determined.
PROOF. For s sufﬁciently large, we are to count the number of monomials
Xα with |α| ≤s lying in the complementary set C(a) to a. Proposition 10.64b
and Theorem 10.65 together show that C(a) = C0 ∪· · · ∪Cd disjointly, with Ck
equal to a ﬁnite union of standard subsets of M with k parameters and with Cd
nonempty. The sets Ck being disjoint, it is enough to show that the number of
such monomials in Ck is a function equal for large s to a polynomial of degree k,
provided Ck is nonempty.
According to Lemma 10.66, if E is a standard subset of M with k parameters,
if s > 0 is sufﬁciently large, and if γ is the translation parameter, then the number
of monomials Xα in E with |α| ≤s is
k+s−|γ |
s−|γ |

if s > |γ |, which is a polynomial
of degree k with positive leading coefﬁcient.
Because the sets E of this kind whose ﬁnite union is Ck may not be disjoint
and because we seek an exact answer for the cardinality |Ck| when s is large, we
cannot simply add ﬁnitely many such expressions to obtain a value for |Ck|. We
have to take into account the overlaps of the various sets E. Thus suppose that
Ck = E1 ∪· · · ∪Er for standard subsets E1, . . . , Er of M with k parameters.
Without loss of generality, we may assume that no two of the sets E1, . . . , Er are
equal to one another. Let E1(s), . . . , Er(s) be the respective subsets of elements
α with |α| ≤s. We use the inclusion–exclusion formula, namely

r
i=1
Ei(s)
 = 	
i
|Ei(s)|−	
i1<i2
|Ei1(s)∩Ei2(s)|+
r	
l=3
(−1)l+1
	
i1<···<il

l
j=1
Eij(s)
;
this is a formula in Boolean algebra that is readily proved by induction on r
starting from the formula |E ∪F| = |E| + |F| −|E ∩F|.
Lemma 10.66 shows that 	
i |Ei(s)| is a sum of functions equal for large s > 0
to polynomials of degree d with positive leading coefﬁcient. The leading coefﬁ-
cients cannot cancel, and thus the sum is for large s > 0 equal to a polynomial
of degree d with positive leading coefﬁcient. Each of the remaining terms on
the right side of the inclusion–exclusion formula, according to Lemma 10.67, is
plus or minus the number of monomials α with |α| ≤s in some standard subset
E of M whose number of parameters is < d. Hence the sum of all those terms
is a function equal for large s to a polynomial that is 0 or has degree < d. The
theorem follows.
□

626
X. Methods of Algebraic Geometry
Proposition 10.69. A polynomial P(s) in one variable of degree d takes
integer values for s sufﬁciently large and positive if and only if it is an integer
linear combination of the polynomials s 	→
s
j

for 0 ≤j ≤d.
PROOF. The sufﬁciency is immediate because
s
j

is an integer for each j and
s. For necessity, suppose that P(s) is integer-valued and has degree d. Since
s 	→
s
j

is integer-valued of degree j with leading coefﬁcient 1/j!, P(s) is
certainly a rational linear combination of the polynomials s 	→
s
j

. We prove
by induction on d that the coefﬁcients are integers. For deg P(s) = 0, we have
s
0

= 1, and there is nothing to prove. Given an integer-valued P(s) of degree
d, write P(s) = 	d
j=0 aj
s
j

. Form
P(s) = P(s + 1) −P(s) =
d	
j=0
aj
s+1
j

−
s
j

=
d	
j=1
aj
 s
j−1

=
d−1
	
j=0
aj+1
s
j

,
the third equality holding by Pascal’s triangle. Since P(s) is integer-valued
and has degree d −1, the inductive hypothesis shows that aj+1 is an integer for
0 ≤j ≤d −1; i.e., aj is an integer for 1 ≤j ≤d. Therefore Q(s) = 	d
j=1 aj
s
j

is integer-valued. Since P(s) −Q(s) = a0 is integer-valued and constant, a0 is
an integer.
□
Corollary 10.70. If a is a monomial ideal in k[X1, . . . , Xn] such that V (a)
has geometric dimension d, then the afﬁne Hilbert polynomial Ha(s, a) of a is of
the form Ha(s, a) = 	d
j=0 aj
 s
d−j

with integer coefﬁcients aj and with a0 > 0.
PROOF. This follows by combining Theorem 10.68 and Proposition 10.69. □
10. Hilbert Polynomial in the Afﬁne Case
We continue with an algebraically closed ﬁeld k and with the polynomial ring
A = k[X1, . . . , Xn]. Let a be an ideal in A. For each integer s ≥0, let A≤s be
the vector subspace of A consisting of 0 and all elements of degree at most s, and
put a≤s = a ∩A≤s. The inclusion of A≤s into A descends to a k linear mapping
A≤s/a≤s →A/a, and this is one-one because A≤s ∩a ⊆a≤s. Thus we can
regard A≤s/a≤s, as s varies, as a sequence of successively better approximations
to A/a. We deﬁne the afﬁne Hilbert function Ha(s, a) of a by
Ha(s, a) = dimk A≤s/a≤s
for s ≥0.
When a is a monomial ideal, this function is the one that was investigated in
the previous section. In fact, the monomials of degree ≤s form a vector-space

10. Hilbert Polynomial in the Affine Case
627
basis of A≤s, and the monomials in a of degree ≤s form a basis of a≤s because a
is spanned by monomials. If C(a) denotes the set of monomials not in a, then the
monomials of degree ≤s within C(a) descend to a basis of A≤s/a≤s. The number
of such monomials gives the value of the afﬁne Hilbert function as deﬁned in the
previous section, and thus the new deﬁnition is consistent with the old one in the
case of monomial ideals.
When a is a proper monomial ideal, we found in Theorem 10.68 that Ha(s, a)
equals a polynomial function of s for s sufﬁciently large and that the degree of
this polynomial function equals the geometric dimension of the zero locus V (a)
in the afﬁne space An. Our goal in this section is to show that these conclusions
remain valid for all proper ideals a. The polynomial function that results for such
an a will be called the afﬁne Hilbert polynomial of a.
We shall make the connection between general ideals a and monomial ideals
by means of the theory of Sections VIII.7–VIII.10. We recall the notion of a
monomial ordering as deﬁned in Section VIII.7. A monomial ordering ≤is said
to be a graded monomial ordering if |β| < |α| implies Xβ ≤Xα. The graded
lexicographic ordering and the graded reverse lexicographic ordering (Examples 2
and 3 in Section VIII.7) are examples of graded monomial orderings, but the
lexicographic ordering in Example 1 in that section is not a graded monomial
ordering.
Fix a graded monomial ordering. As in Section VIII.7, LT( f ) denotes the
leading monomial term of the polynomial f . By convention, LT(0) = 0. For our
ideal a, we let LT(a) be the vector space of all linear combinations of polynomials
LT( f ) for f ∈α. This is an ideal in A, and it is a monomial ideal. The connection
between the goal of this section and the results of the previous section rests on
the following remarkable theorem.
Theorem 10.71 (Macaulay). Let a graded monomial ordering be imposed
on k[X1, . . . , Xn]. If a is any ideal in k[X1, . . . , Xn], then the afﬁne Hilbert
functions of a and LT(a) coincide: Ha(s, a) = Ha(s, LT(a)).
PROOF. Fix s ≥0. It is enough to prove that a≤s and LT(a)≤s have the same k
dimension. Since there are only ﬁnitely many monomials of degree ≤s, we can
choose f1, . . . , fm in a such that their leading monomials LM( f1), . . . , LM( fk)
are distinct and form a vector-space basis of LT(a)≤s. Without loss of generality,
we may assume that LM( f1) > · · · > LM( fk). Certainly dim LT(a)≤s = k, and
thus it is enough to show that f1, . . . , fk lie in a≤s and form a vector-space basis
of a≤s.
For each j, LM( fj −LT( fj)) < LM( fj). Since the monomial ordering is
graded, this inequality implies that deg( fj −LT( fj)) ≤s. But we know that
deg(LT( fj)) ≤s, and therefore deg fj ≤s. Consequently fj lies in a≤s.
To prove that { f1, . . . , fk} is linearly independent, suppose that 	k
j=1 cj fj = 0
with all cj in k. Arguing by contradiction, suppose that not all cj are 0. Let i be the

628
X. Methods of Algebraic Geometry
least index j for which cj ̸= 0; then LM( fi) = LM(ci fi) = LM

−	
j>i cj fj

≤
maxj>i LM( fj), and we arrive at a contradiction. We conclude that { f1, . . . , fk}
is linearly independent.
To prove that { f1, . . . , fk} spans a≤s, we again argue by contradiction. Among
all g in a≤s with g not in the linear span of { f1, . . . , fk}, choose one for which
LM(g) is the smallest. Certainly LM(g) is one of LM( f1), . . . , LM( fk). Say that
LM(g) = LM( fi). For some scalar c ̸= 0, we must have LT(g) = LT(cfi). Then
LM(g −cfi) < LM(g), and the minimality of LM(g) forces g −cfi to be in the
linear span of { f1, . . . , fk}. Since cfi is in the linear span, so is g, contradiction.
Thus { f1, . . . , fk} is a spanning set of a≤s.
□
Corollary 10.72. If a is an ideal in k[X1, . . . , Xn], then for all s sufﬁciently
large, the afﬁne Hilbert function Ha(s, a) of a equals a polynomial in s of the
form 	d
j=0 aj
 s
d−j

with integer coefﬁcients aj and with a0 > 0.
REMARKS. The polynomial in the statement of the corollary is called the afﬁne
Hilbert polynomial of a and is denoted by Ha(s, a). It is the 0 polynomial if and
only if a = k[X1, . . . , Xn].
PROOF. Theorem 10.71 says that Ha(s, a) = Ha(s, LT(a)). Consequently the
result follows immediately by applying Corollary 10.70 to LT(a).
□
Corollary 10.73. If a graded monomial ordering is imposed on k[X1, . . . , Xn]
and if a is any ideal in k[X1, . . . , Xn], then the afﬁne Hilbert polynomials of a
and LT(a) coincide: Ha(s, a) = Ha(s, LT(a)).
PROOF. This is immediate from Theorem 10.71 and the deﬁnition of the afﬁne
Hilbert polynomial given in the remarks with Corollary 10.72.
□
Corollary 10.74. If a and b are proper ideals of k[X1, . . . , Xn] such that
a ⊆b, then deg Ha(s, a) ≥deg Ha(s, b).
PROOF. Introduce a graded monomial ordering. The inclusion a ⊆b implies
that LT(a) ⊆LT(b). Therefore C(LT(a)) ⊇C(LT(b)). Proposition 10.64b shows
that the geometric dimension of V (LT(a)) is the largest vector-space dimension
of a coordinate subspace that lies in C(LT(a)), and the same thing is true for
LT(b). Thus the geometric dimension of V (LT(a)) is ≥the geometric dimension
of V (LT(b)). By Theorem 10.68, deg Ha(s, LT(a)) ≥deg Ha(s, LT(b)). The
result now follows immediately from Corollary 10.73.
□
The afﬁne Hilbert polynomial Ha(s, a) of a depends on a, not just V (a), but
we shall be interested mainly in the degree of Ha(s, a). Proposition 10.76, as
ampliﬁed in Corollary 10.77, implies that the degree depends only on V (a). It
requires a lemma.

10. Hilbert Polynomial in the Affine Case
629
Lemma 10.75. If a is a monomial ideal in k[X1, . . . , Xn], then so is √a .
PROOF. The preliminary remarks in Section 9 show that V (a) is a ﬁnite union
of coordinate subspaces. Let us write V (a) = 
j Ej accordingly. By Proposition
10.2b, √a = I (V (a)) = I
 
j Ej

= 
j I (Ej). Since Ej is an afﬁne variety
and is equal to V (Xi1, . . . , Xik) for suitable Xi1, . . . , Xik, the Nullstellensatz
shows that I (Ej) is an ideal of the form I (E) = (Xi1, . . . , Xik).
This is a
monomial ideal, and it is therefore enough to show that the ﬁnite intersection of
monomial ideals is a monomial ideal. By induction it is enough to show that
b ∩c is a monomial ideal if b and c are monomial ideals. If an element of b ∩c is
given, then that element is a linear combination of the monomials in b and is also
a linear combination of the monomials in c. Since M is linearly independent, the
element is a linear combination of monomials lying in b ∩c. Therefore b ∩c is a
monomial ideal.
□
Proposition 10.76. If a is a proper ideal in k[X1, . . . , Xn], then the degrees
of the afﬁne Hilbert polynomials Ha(s, a) and Ha(s, √a ) are equal.
PROOF. Fix a graded monomial ordering. We begin by proving that
LT(a) ⊆LT(√a ) ⊆
2
LT(a) .
(∗)
The left-hand inclusion is immediate because a ⊆√a .
For the right-hand
inclusion, let f ̸= 0 be in √a, and let Xα = LM( f ) be the leading monomial of
f . Since f is in √a , f r is in a for some r > 0. Since the leading monomial of a
product is the product of the leading monomials, LM( f r) = Xrα. Thus a power
of Xα is exhibited as in LT(a), and Xα is in √
LT(a) . This proves (∗).
Applying Corollary 10.74 to (∗), we obtain
deg Ha(s, LT(a)) ≥deg Ha(s, LT(√a )) ≥deg Ha(s,
2
LT(a) ).
(∗∗)
The ideal LT(a) is a monomial ideal, and Lemma 10.75 shows that √
LT(a) is a
monomial ideal. Then LT(a) and √
LT(a) are monomial ideals with V (LT(a)) =
V (√
LT(a) ), and Theorem 10.68 shows that
deg Ha(s, LT(a)) = deg Ha(s,
2
LT(a) ).
Comparing this conclusion with (∗∗), we see that
deg Ha(s, LT(a)) = deg Ha(s, LT(√a )).
(†)
In combination with the equalities Ha(s, a) = Ha(s, LT(a)) and Ha(s, √a ) =
Ha(s, LT(√a )) given by Corollary 10.73, (†) completes the proof.
□

630
X. Methods of Algebraic Geometry
Corollary 10.77. If a and b are proper ideals in k[X1, . . . , Xn] with V (a) ⊆
V (b), then deg Ha(s, a) ≤deg Ha(s, b).
PROOF.
Application of I ( · ) to the inclusion V (a) ⊆V (b) gives √a =
I (V (a)) ⊇I (V (b)) =
√
b. Then Corollary 10.74 and Proposition 10.76 together
yield deg Ha(s, a) = deg Ha(s, √a ) ≤deg Ha(s,
√
b ) = deg Ha(s, b).
□
Theorem 10.78. If a is a prime ideal in k[X1, . . . , Xn], then the degree of the
afﬁne Hilbert polynomial Ha(s, a) equals the geometric dimension of the afﬁne
variety V (a).
PROOF. Deﬁne d = deg Ha(s, a) and V = V (a), and let A(V ) be the afﬁne
coordinate ring A(V ) = k[X1, . . . , Xn]/a. Theorem 10.7 shows that dim V
equals the Krull dimension of A(V ), and Theorem 7.22 shows that the latter
equals the transcendence degree over k of the ﬁeld of fractions k(V ) of A(V ).
Thus the theorem will follow if we show that k(V ) has transcendence degree d
over k.
Let ϕ : k[X1, . . . , Xn] →A(V ) be the quotient homomorphism, and put
xi = ϕ(Xi) for 1 ≤i ≤n. Introduce a graded monomial ordering on M.
Corollary 10.73 shows that Ha(s, a) = Ha(s, LT(a)), and Theorem 10.68 shows
that V (LT(a)) has geometric dimension d. We saw in Section 9 that the zero locus
of a monomial ideal is the ﬁnite union of coordinate subspaces, and it follows
that V (LT(a)) ⊆An contains a coordinate subspace E of dimension d. Let E
have as basis the standard vectors ej1, . . . , ejd, so that
E = V

Xi | i /∈{ j1, . . . , jd}

.
The set E is a variety, and thus I (E) =

Xi | i /∈{ j1, . . . , jd}

. Also, E ⊆
V (LT(a)), and hence I (E) ⊇I (V (LT(a))) ⊇LT(a). If Xα is a monomial in LT(a),
then it follows that Xα lies in the ideal generated by the Xi for i /∈{ j1, . . . , jd}.
We can summarize this fact as follows: if we write k[X j1, . . . , X jd] for the subring
of k[X1, . . . , Xn] of polynomials involving only X j1, . . . , X jd, then
LT(a) ∩k[X j1, . . . , X jd] = 0.
(∗)
If f is any nonzero member of k[X j1, . . . , X jd], then its leading monomial LM( f )
has to lie in k[X j1, . . . , X jd], and thus (∗) implies that
a ∩k[X j1, . . . , X jd] = 0.
(∗∗)
Using (∗∗) and notation introduced at the beginning of Section VII.4, we
shall show that xj1, . . . , xjd are algebraically independent over k, and then it
follows that d ≤tr. deg A(V ). Thus suppose that g(Y1, . . . , Yd) is a polynomial
in k[Y1, . . . , Yd] such that g(xj1, . . . , xjd) = 0. We can identify k[Y1, . . . , Yd]

10. Hilbert Polynomial in the Affine Case
631
with k[X j1, . . . , X jd] ⊆k[X1, . . . , Xn], and then the equality g(xj1, . . . , xjd) = 0
means that ϕ(g) = 0, i.e., g is in a. Hence g is a member of a ∩k[X j1, . . . , X jd],
and g = 0 by (∗∗). Therefore xj1, . . . , xjd are algebraically independent over k.
For the reverse inequality, we are to prove that d ≥tr. deg A(V ). Let r =
tr. deg A(V ).
The elements xj = ϕ(X j) generate A(V ) as a k algebra, and
therefore they generate k(V ) over k as a ﬁeld. By Lemma 7.6b some subset
{xj1, . . . , xjd} of {x1, . . . , xn} is algebraically independent. Consider the substi-
tution homomorphism
ψ(h) = h(xj1, . . . , xjr)
of k[Y1, . . . , Yr] into A(V ). This is one-one because the elements xj1, . . . , xjd by
assumption are algebraically independent. Fix s ≥0, and consider the restriction
of ψ to k[Y1, . . . , Yr]≤s. If h(Y1, . . . , Yr) is a monomial Y α in k[Y1, . . . , Yr]≤s
with α = (α1, . . . , αr) and |α| ≤s, then we see that
ψ(Y α) =
r
i=1
xji
αi = ϕ

r
i=1
X ji
αi
.
In other words, ψ(Y α) is the image under ϕ of a member of k[X1, . . . , Xn] of
degree ≤s. Taking linear combinations of such monomials, we see that ψ(h) is
a one-one k linear mapping
ψ : k[Y1, . . . , Yr]≤s →k[X1, . . . , Xn]≤s/a≤s ⊆A(V ).
Therefore
Ha(s, a) = dimk

k[X1, . . . , Xn]≤s/a≤s

≥dimk k[Y1, . . . , Yr]≤s =
r+s
r

.
The binomial coefﬁcient on the right side is a polynomial of degree r in s with
positive leading coefﬁcient. The left side is a polynomial in s of degree d. The
inequality forces d ≥r, and the proof is complete.
□
Proposition 10.79.
If a and b are proper ideals in k[X1, . . . , Xn], then
deg Ha(s, ab) = max

deg Ha(s, a), deg Ha(s, b)

.
REMARKS. Proposition 10.1 points out that V (ab) = V (a) ∪V (b). Since the
degree of the afﬁne Hilbert polynomial ofa dependsonly on V (a), thisproposition
says that the degree associated with the union of two afﬁne algebraic sets is the
larger of the degrees associated with each of the sets.
PROOF. Impose a graded monomial ordering on M. Let us check that

LT(a)

LT(b)

⊆LT(ab) ⊆LT(a ∩b) ⊆
7
LT(a)

LT(b)

.
(∗)
In fact, let f be in a and g be in b, and deﬁne Xα = LM( f ) and Xβ = LM(g)
to be the leading monomials of f and g. Then Xα+β = LM( f g), and hence
the product of any generator of LT(a) and any generator of LT(b) lies in LT(ab).

632
X. Methods of Algebraic Geometry
This proves the ﬁrst inclusion of (∗). The second inclusion is immediate because
ab ⊆a ∩b. If Xα = LM( f ) with f ∈a ∩b, then (Xα)2 = LM( f ) LM( f ) is in
LT(a) LT(b). Hence Xα is in
7
LT(a)

LT(b)

. Thus a generating set of LT(a∩b)
lies in
7
LT(a)

LT(b)

, and the third inclusion of (∗) follows.
In (∗), the values of V ( · ) on the end two members are the same, according to
Proposition 10.3c, and therefore
V

LT(a) LT(b)

= V (LT(ab)).
(∗∗)
The proposition now follows from the computation
max(degHa(s, a), deg Ha(s, b))
= max(deg Ha(s, LT(a)), deg Ha(s, LT(b)))
by Corollary 10.73
= max(dim V (LT(a)), dim V (LT(b)))
by Theorem 10.68
= dim

V (LT(a)) ∪V (LT(b))

by Theorem 10.7
= dim(V (LT(a) LT(b))
by Proposition 10.1c
= dim V (LT(ab))
by (∗∗)
= deg Ha(s, LT(ab))
by Theorem 10.68
= deg Ha(s, ab)
by Corollary 10.73. □
Corollary 10.80.
If a is any ideal in k[X1, . . . , Xn], then the geometric
dimension of the afﬁne algebraic set V (a) equals the degree of the afﬁne Hilbert
polynomial Ha(s, a).
PROOF. Write V (a) = k
j=1 Vj as a ﬁnite union of afﬁne varieties Vj, and de-
ﬁne pj = I (Vj). Since Vj is irreducible, pj is prime. Moreover, Vj = V (I (Vj)) =
V (pj).
Then Proposition 10.1c shows that V (p1p2 · · · pk) = k
j=1 V (pj) =
k
j=1 Vj = V (a). Proposition 10.79 and induction give
deg Ha(s, p1p2 · · · pk) = max
1≤j≤n deg Ha(s, pj),
and Theorem 10.78 shows that the right side equals max1≤j≤k dim V (pj) =
max1≤j≤k dim Vj, which equals dim V (a) by Theorem 10.7.
□
As a consequence of Corollary 10.80, we obtain an algorithm for computing
the dimension of an afﬁne algebraic set V when given an ideal a whose locus
of common zeros V (a) is V : We introduce any graded monomial ordering and
compute LT(a), using a Gr¨obner basis. Corollaries 10.73 and 10.80 together say
that dim V (a) = dim V (LT(a)). The remarks before Proposition 10.64 show how
to compute dim V (LT(a)), and Proposition 10.64b gives an alternative method of
computation.

11. Hilbert Polynomial in the Projective Case
633
11. Hilbert Polynomial in the Projective Case
In this section we consider the analog for projective space of the theory of
Section 10. We continue with k as an algebraically closed ﬁeld, and we let
A = k[X0, . . . , Xn]. Our interest is in the zero locus V (a) in Pn, as deﬁned in
Section 3, of a homogeneous ideal a in A. To relate matters to Section 10, we
shall make use of the cone C(V (a)) over V (a), which was deﬁned in Section 3
as
C(V (a)) = (0, . . . , 0) ∪

(x0, . . . , xn) ∈An+1 | [x0, . . . , xn] ∈V (a)

.
The homogeneous ideal a is in particular an ideal in n + 1 variables, and its
associated afﬁne algebraic set is the subset C(V (a)) of An+1. An afﬁne Hilbert
polynomial Ha(s, a) is therefore associated to C(V (a)), and its degree matches
the geometric dimension of C(V (a)).
To get something directly related to the projective algebraic set V (a) in pro-
jective space Pn, we make a new deﬁnition of Hilbert function.
Let As =
k[X0, . . . , Xn]s be the subspace A of all polynomials homogeneous of degree
s. If a is a homogeneous ideal in A, let as = a ∩As. The Hilbert function24 of
a is the integer-valued function of s ≥0 deﬁned by
H(s, a) = dimk As/as
for s ≥0.
We have A≤s = As ⊕A≤s−1, and the fact that a is homogeneous implies that
a≤s = as ⊕a≤s−1. Consequently A≤s/a≤s ∼= As/as ⊕A≤s−1/a≤s−1. Therefore
H(s, a) = Ha(s, a) −Ha(s −1, a).
This is the fundamental formula by which the algebraic part of the theory of the
Hilbert function in the projective case can be reduced to the corresponding theory
in the afﬁne case.
We know that the afﬁne Hilbert function is a polynomial for large s. Since
sd −(s −1)d = sd−1 −sd−2 + sd−3 −· · · + (−1)d+1
is a polynomial of one lower degree and with positive leading coefﬁcient, it
follows that the Hilbert function of a is a polynomial for large s, that its degree
is dim C(V (a)) −1, and that its leading coefﬁcient is positive. This polynomial
is called the Hilbert polynomial of a and is denoted by H(s, a). To connect the
geometric part of the theory of the Hilbert function in the projective case to the
corresponding theory in the afﬁne case, we use the following proposition.
24It is traditional not to include the word “projective” or any subscript, even though the termi-
nology is meant to refer to the projective case.

634
X. Methods of Algebraic Geometry
Proposition 10.81. If a is a homogeneous ideal in k[X0, . . . , Xn] and if the
corresponding projective algebraic set V (a) is nonempty, then
dim C(V (a)) = dim V (a) + 1.
PROOF. The proof of Corollary 10.13 shows that C(V (a)) is irreducible in
An+1 if and only if V (a) is irreducible in Pn. Since the dimension in both cases
for a general a is the maximum of the dimensions of irreducible closed subsets,
it is enough to prove the dimensional equality in the irreducible case.
If we have a strictly increasing sequence of irreducible closed subsets E0 ⫋
E1 ⫋· · · ⫋Ed in Pn, then each C(Ej) is irreducible in An+1, and the sequence
C(E0) ⫋C(E1) ⫋· · · ⫋C(Ed) in An+1 consists of Zariski closed sets that are
irreducible. Since the subset {0} of An+1 is irreducible and can be adjoined at the
beginning of the latter sequence, we conclude that dimC(V (a)) ≥dim V (a)+1.
Weneedtoprovethereverseinequalityintheirreduciblecase. SinceV (a)isas-
sumedirreducible(andhencenonempty), wemayassumethataisprimeandomits
at least one of X0, . . . , Xn. To ﬁx the notation, say that X0 is not in a. Recall from
Section 3 the substitution homomorphism βt
0 : k[X0, . . . , Xn] →k[X1, . . . , Xn]
formed by setting X0 = 1. Let b = βt
0(a). This is a prime ideal in k[X1, . . . , Xn],
according to Theorem 10.20. Let A(C(V (a))) = k[X0, . . . , Xn]/a and A(V (b))
= k[X1, . . . , Xn]/b. The homomorphism βt
0 descends to a homomorphism of
A(C(V (a)) onto A(V (b)), which we denote by ¯βt
0.
Let x0, . . . , xn be the images of X0, . . . , Xn in A(C(V (a))). The element x0
is transcendental over k. In fact, the only alternative is that it is a scalar c, since
k is algebraically closed; the equality x0 = c would imply that X0 −c is in a,
and the fact that a is homogeneous would imply that X0 and c are separately
in a, in contradiction to our choice of X0.
Consequently k(x0)(x1, . . . , xn)
has transcendence degree r = dim C(V (a)) −1 over k(x0). Since x1, . . . , xn
generate k(x0)(x1, . . . , xn) as a ﬁeld over k(x0), some subset {xj1, . . . , xjr} of
{x1, . . . , xn} is a transcendence basis of k(x0)(x1, . . . , xn) as a ﬁeld over k(x0).
Thus {x0, xj1, . . . , xjr} is a transcendence basis of k(x0, . . . , xn) over k.
The elements x0, xj1, . . . , xjr all lie in A(C(V (a))), and we consider their
images 1, ¯βt
0(xj1), . . . , ¯βt
0(xjr) in A(V (b)).
Suppose that h(Y1, . . . , Yr) is a
polynomial in r variables exhibiting the last r of these images as algebraically
dependent. That is, suppose that
h
 ¯βt
0(xj1), . . . , ¯βt
0(xjr)

= 0.
(∗)
Let h have degree d. We regard h as a member of k[X1, . . . , Xn]≤d that depends
only on X j1, . . . , X jn. With this notational change, (∗) reads
h(X1, . . . , Xn)
is in b.
(∗∗)

12. Intersections in Projective Space
635
We now refer to the details of the proof of Theorem 10.20 that are summarized
before Proposition 10.33. The linear mapping ϕd with ϕd( f )(X0, . . . , Xn) =
Xd
0 f (X1/X0, . . . , Xn/X0) is a two-sided inverse to βt
0 : k[X0, . . . , Xn]d →
k[X1, . . . , Xn]≤d. Put H = ϕd(h), so that h = βt
0(H). The detail in question is
that
a ∩k[X0, . . . , Xn]d = ϕd

b ∩k[X1, . . . , Xn]≤d

.
(†)
By (∗∗), ϕd(h) is in the right side of(†). Since (†) is a valid identity, ϕd(h) is in the
left side. So H is in a. This means that H(x0, . . . , xn) = 0. Remembering that H
depends only on X0, X j1, . . . , X jr and that {x0, xj1, . . . , xjr} is a transcendence set,
weseethat H = 0. Thereforeh = 0, and{ ¯βt
0(xj1), . . . , ¯βt
0(xjr)}isatranscendence
set in A(V (b)). Thus
dim V (b) = tr. deg A(V (b)) ≥r = tr. deg A(C(V (a)) −1 = dim C(V (a)) −1.
ByCorollary10.19, dim V (b) = dim V (a). Hencedim C(V (a)) ≤dim V (a)+1,
and the proof is complete.
□
Corollary 10.82. If a is a homogeneous ideal in k[X0, . . . , Xn] and if the
corresponding projective algebraic set V (a) is nonempty, then dim V (a) equals
the degree of the Hilbert polynomial H(s, a).
PROOF. This is immediate from Proposition 10.81 because dimC(V (a)) =
dim Ha(s, a) and because deg H(s, a) = deg Ha(s, a) −1.
□
We could also obtain a corollary relating H(s, V (a)) and H(s, V (LT(a))) when
a graded monomial ordering is imposed, and we could then give a geometric way
of visualizing the dimension in terms of the projective case. But we shall not
need these details, and we omit them.
12. Intersections in Projective Space
Hilbert polynomials are an appropriate tool for dealing with how a projective
algebraic set intersects a lower-dimensional projective space. In this section we
consider such intersections, and we obtain as a corollary the deep result that a
system of homogeneous polynomial equations over an algebraically closed ﬁeld
k always has a nonzero solution if there are more variables than equations.
It will be convenient in this section to adopt the convention that the empty
projective algebraic set has dimension −1 and that the 0 Hilbert polynomial has
degree −1. To make use of this convention, we recall from the homogeneous
Nullstellensatz (Proposition 10.12a) that a homogeneous ideala in k[X0, . . . , Xn]
has V (a) empty in Pn if and only if there is an integer N such that a contains
k[X0, . . . , Xn]k for k ≥N. In this case our deﬁnition makes C(V (a)) consist

636
X. Methods of Algebraic Geometry
of {0} alone.25 With the convention that such ideals have dim V (a) = −1 and
C(V (a)) = {0}, the formula of Proposition 10.81 remains valid, and we can
therefore drop the assumption that V (a) is nonempty. As to Corollary 10.82,
the deﬁnition of the Hilbert function when a contains k[X0, . . . , Xn]k for all
sufﬁcientlylargek makesH(k, a) = 0forsuchk; thereforetheHilbertpolynomial
in this case is the 0 polynomial, and Corollary 10.82 continues to be valid even
when V (a) is empty.
Theorem 10.83. If a is any homogeneous ideal in k[X0, . . . , Xn] and if F is
a homogeneous polynomial, then
dim V (a) ≥dim V (a + (F)) ≥dim V (a) −1.
In particular, V (a + (F)) is nonempty if dim V (a) ≥1.
PROOF. Since a ⊆a + (F) and since V ( · ) is inclusion reversing, we know
that
dim V (a) ≥dim V (a + (F)).
To obtain the second inequality of the theorem, we shall compare the Hilbert
polynomials H(s, a) and H(s, a + (F)), taking advantage of Corollary 10.82.
Let d = deg F, and suppose that s > d. The identity mapping on k[X0, . . . , Xn]s
descends to a k linear mapping
ϕ : k[X0, . . . , Xn]s/as →k[X0, . . . , Xn]s

(a + (F))s,
and ϕ is onto, being formed from an onto map. To understand kerϕ, we shall use
the k linear map
ψ : k[X0, . . . , Xn]s−d/as−d →k[X0, . . . , Xn]s/as
induced by multiplication by F, which we view as carrying k[X0, . . . , Xn]s−d
into k[X0, . . . , Xn]s/as. Observe that if G is in k[X0, . . . , Xn]s−d, then FG is
in (a + (F))s, and therefore ϕ ◦ψ = 0, i.e., image ψ ⊆ker ϕ.
We shall prove that equality holds. Thus suppose that G is a member of
k[X0, . . . , Xn]s such that G + as is in ker ϕ, i.e., that G is in (a + (F))s. Then
we can write G = G1 + H F with G1 in as and H in k[X0, . . . , Xn]s−d. So
G −G1 = H F, and the coset G + as = G −G1 + as is ψ of H + as−d. We
conclude that image ψ = ker ϕ.
Now we compute
dimkk[X0, . . . , Xn]s/as
= dimk(domain ϕ) = dimk(ker ϕ) + dimk(image ϕ)
= dimk(image ψ) + dimk k[X0, . . . , Xn]s

(a + (F))s
≤dimk k[X0, . . . , Xn]s−d/as−d + dimk k[X0, . . . , Xn]s

(a + (F))s.
25Admittedly the inclusion of {0} in the cone might seem unnatural if a = k[X0, . . . , Xn], but
that is the deﬁnition that makes this particular a behave like all other ideals.

12. Intersections in Projective Space
637
In terms of Hilbert functions, this says that
H(s, a) ≤H(s −d, a) + H(s, a + (F)).
For large s, this is an inequality of polynomials:
H(s, a) ≤H(s −d, a) + H(s, a + (F)).
Since H(s, a) −H(s −d, a) is a polynomial of one lower degree than H(s, a)
with leading coefﬁcient positive, we obtain
deg H(s, a) −1 ≤deg H(s, a + (F)).
The second inequality of the theorem now follows from Corollary 10.82. The
ﬁnal assertion in the theorem takes into account the remarks in the paragraph
preceding the statement of the theorem.
□
Corollary 10.84. If a is any homogeneous ideal in k[X0, . . . , Xn] and if
F1, . . . , Fr are homogeneous polynomials, then
dim V (a) ≥dim V (a + (F1, . . . , Fr)) ≥dim V (a) −r.
In particular, V (a + (F1, . . . , Fr)) is nonempty if dim V (a) ≥r.
PROOF. We use Theorem 10.83 inductively, ﬁrst applying it to the ideal a with
F = F1, then applying it to the ideal a + (F1) with F = F2, and so on. This
proves the ﬁrst conclusion, and the second conclusion follows because of the
convention that the empty set has dimension −1.
□
Corollary 10.85. Over an algebraically closed ﬁeld any system of homoge-
neous polynomial equations with more variables than equations has a nonzero
solution.
PROOF. Let there be r equations and n + 1 variables with n + 1 > r, the
equations being F1 = 0, . . . , Fr = 0. The zero locus for each equation is a subset
of Pn. Applying Corollary 10.84 with a = 0 shows that dim V (F1, . . . , Fr) ≥
n −r ≥0 and that V (F1, . . . , Fr) is not empty as long as n ≥r.
□
Corollary 10.85 is the result in the present chapter that was anticipated in
Problem 23 at the end of Chapter VIII.

638
X. Methods of Algebraic Geometry
13. Schemes
We conclude with some commentary about “schemes.” The subject of algebraic
geometry studied along the lines of Sections 1–12 suffers from at least two
shortcomings. One concerns the coefﬁcients that are involved. The original
impetus for the subject came from systems of polynomial equations in several
variables. These equations involve addition, subtraction, and multiplication, and
the requirement that division be allowable is unnatural and cuts down the scope
of the subject. It immediately cuts out Diophantine equations, for example, to
say nothing of congruences modulo prime powers. It would be more natural to
allow the coefﬁcients to lie in any commutative ring with identity. The other
shortcoming is that the deﬁnition of variety depends on an embedding whose
chief role is to get past the stage of making deﬁnitions; soon the embedding is
stripped away, and the interest is in varieties up to isomorphism. The situation
is similar to the historical treatment of groups and of manifolds. Groups were
for the most part originally conceived in terms of group actions, but eventually
the groups were separated from the actions. Manifolds at ﬁrst were deﬁned as
certain subsets of Euclidean space, but eventually they were given an intrinsic
deﬁnition. It would be more in keeping with the wisdom gained from other areas
of mathematics if varieties could be deﬁned intrinsically right away.
Schemes, introduced and developed by A. Grothendieck in the late 1950s and
early 1960s, accomplish both these objectives. The theory of schemes borrows
ideas and techniques from many areas of mathematics, as will be apparent shortly.
This section will brieﬂy present some of the deﬁnitions, offer some examples, and
show the sense in which varieties may be regarded as schemes.26 The interested
reader may want to read more, and this section will therefore conclude with some
bibliographical remarks.
1. Spectrum. One preliminary remark is necessary. To isolate an afﬁne
variety from its ambient space An, we can take advantage of Proposition 10.23,
which says that the points of the variety correspond exactly to the maximal ideals
of the afﬁne coordinate ring.27 The set of maximal ideals in a ring, however,
is usually not an object that lends itself to use with mappings. For example the
canonical inclusion of Z into Q is not reﬂected in any of the mappings of the
singleton set {(0)} of maximal ideals of Q into the set of maximal ideals of Z.
Instead, the theory of schemes works with prime ideals. These behave nicely
in that the inverse image of a prime ideal under a homomorphism of rings with
identity is a prime ideal.
26The material in this section is based in part on lectures by V. Schechtman given in 1991–92
and in part on the books by Gunning, Hartshorne, and Shafarevich in the Selected References.
27Readers familiar with some functional analysis will recognize that a similar thing happens with
compact Hausdorff spaces; by a theorem of M. Stone, the points of the space correspond exactly to
the maximal ideals of the algebra of continuous complex-valued functions on the space.

13. Schemes
639
Thus we work with the category of commutative rings with identity, the mo-
tivating example being the afﬁne coordinate ring of an afﬁne variety over an
algebraically closed ﬁeld. If A is a ring in this category, the spectrum of A is the
set Spec A of prime ideals of A. For example the spectrum of a ﬁeld consists of
the one element (0), that of a discrete valuation ring consists of 0 and the unique
maximal ideal, that of a principal ideal domain consists of 0 and the principal
ideals ( f ) such that f is an irreducible element, and that of C[X, Y] consists of
the ideal (0), the maximal ideals corresponding to one-point sets in C2, and all
prime ideals ( f (X, Y)) of irreducible afﬁne plane curves over C.
The spectrum of A is understood to carry along with it two additional pieces
of structure. The ﬁrst piece of structure is an analog for Spec A of the Zariski
topology.28 To each ideal a of A, we associate the subset V (a) ⊆Spec A of all
prime ideals p with a ⊆p. The sets V (a) are easily seen to have the deﬁning
properties of the closed sets of a topology, and this topology will always be
understood to be in place. It is immediate from the deﬁnition that V (a) = V (√a )
for every ideal a. One checks for any prime ideal p that V (p) = {p}; consequently
the one-point set {p} is closed if and only if p is a maximal ideal.
At least when A is Noetherian, Spec A is a Noetherian space, and a notion
of dimension (not necessarily ﬁnite) is deﬁned for each closed set in the usual
way29 as in Section 2; for A itself this coincides with the Krull dimension of
A. In this situation the irreducible closed sets are the sets V (p) with p prime.
The fact that such a set is irreducible follows from the identity V (p) = {p}; the
converse assertion follows from the identity V (a) = V (√a ) and the Lasker–
Noether Decomposition Theorem (Problem 14 at the end of Chapter VII). By
Proposition 10.5 every closed set is a ﬁnite union of irreducible closed sets, and
thus we have a complete description of the closed sets. For example, in a principal
ideal domain the closed sets consist of the ﬁnite sets of nonzero prime ideals, as
well as the set of all prime ideals. For the ring A = C[X, Y], every proper closed
set of Spec A is a ﬁnite union of singleton sets {(X −x0, Y −y0)} and of sets
{( f (X, Y))} ∪

f (x0,y0)=0
{(X −x0, Y −y0)}
with f (X, Y) irreducible.
If ϕ : A →B is a homomorphism in our category of rings (always assumed
to carry 1 to 1) and if p is a prime ideal in B, then ϕ−1(p) is a prime ideal in A.
Thus the deﬁnition aϕ(p) = ϕ−1(p) gives us a function aϕ : Spec B →Spec A.
If E is a subset of A, then we readily check that
(aϕ)−1(V (E)) = (aϕ)−1({p | p ⊇E}) = {q | aϕ(q) ⊇E} = V (ϕ(E)),
28A little care is needed with the deﬁnitions when A is the 0 ring, which has an identity but no
prime ideals. Then Spec A is empty, but we will want to allow it as part of the theory. So we need
to allow the empty set as a topological space.
29The general theory treats dimension as deﬁned even when A is not Noetherian, but it will be
enough in this section to consider only the Noetherian case.

640
X. Methods of Algebraic Geometry
from which it follows that aϕ is continuous. The function aϕ can be fairly subtle.
For example, if ϕ is the inclusion of Z into the ring R of algebraic integers in
a number ﬁeld and if P is a nonzero prime ideal in R, then aϕ(P) = P ∩Z is
the corresponding prime ideal (p) in Z; the continuity of aϕ implies that each
nonzero prime ideal (p) of Z arises in this way from only ﬁnitely many ideals P
in R.
2. Structure sheaf. The second piece of additional structure carried by the
spectrum of A is its “structure sheaf,” which is a certain speciﬁc sheaf with
base space Spec A. Sheaves were introduced by J. Leray in 1946 in connection
with partial differential equations and by K. Oka and H. Cartan about 1950 in
connection with the theory of several complex variables. As with vector bundles,
sheaves may be viewed as having a base space carrying some topological infor-
mation and ﬁbers carrying some algebraic information; local sections will be of
great interest. The initial example of a sheaf in several complex variables is the
“sheaf of germs of holomorphic functions” on an open set in Cn, germs being
deﬁned for holomorphic functions on an open set in the same way as they were
deﬁned in Section 4 for rational functions on a quasi-afﬁne variety.
We shall deﬁne two general notions, “sheaf” and “presheaf,” and compare
them. The prototype of a presheaf in several complex variables is the collection
of vector spaces of holomorphic functions on each nonempty open subset of the
given open set; the prototype in classical algebraic geometry is the collection of
regular functions on each nonempty open subset of a quasiprojective variety. In
the general case, ﬁx a category to describe the allowable structure on each ﬁber;
common choices for the objects in this category are abelian groups, commutative
rings with identity (called “rings” hereafter in this section), and unital R modules
for some ring. In deﬁning sheaves and presheaves, we shall write the deﬁnitions
using abelian groups, since it is a simple matter to adjoin the additional structure
when the ﬁbers are rings or modules.
Let X be a topological space. A presheaf of abelian groups on the base space
X is a collection {O(U), ρVU}, parametrized by the open subsets U of X and the
open subsets V of U, such that each O(U) is an abelian group, O(∅) is the 0
group, each ρVU : O(U) →O(V ) is a group homomorphism, each ρUU is the
identity, and ρW V ρVU = ρWU whenever W ⊆V ⊆U. We are to think of O(U)
as a space of sections of some kind over U and ρVU as a restriction map carrying
sections over U to sections over V . A sheaf of abelian groups on the base space
X is a topological space O with a mapping π : O →X such that π is a local
homeomorphism onto, π−1(P) is an abelian group for each P ∈X, and the group
operations on each π−1(P) are continuous in the relative topology from O. We
are to think of the elements of a sheaf as germs obtained starting from a presheaf.
The individual ﬁbers π−1(P) of a sheaf are called stalks. One writes (X, O) for
the sheaf, sometimes abbreviating the notation to O.
It is possible to construct a presheaf from a sheaf, and vice versa. If we are

13. Schemes
641
given a sheaf O, we deﬁne a section s of O over U to be a continuous function
s : U →O such that π ◦s = 1U. If O(U) denotes the abelian group of sections
of O over U and if ρVU is the restriction map for sections, then {O(U), ρVU} is
a presheaf. In the reverse direction if we start from a presheaf {O(U), ρVU} and
form the kind of direct limit of abelian groups at each point that is suggested by the
passage to germs, then it is possible to topologize the disjoint union of the abelian
groups of germs so as to produce a sheaf. Passing from a sheaf to a presheaf and
then back to a sheaf reproduces the original sheaf. But passing from a presheaf
to a sheaf and then back to a presheaf does not necessarily reproduce the original
presheaf. A necessary and sufﬁcient condition on the presheaf {O(U), ρVU} for
{O(U), ρVU} to result from passing to a sheaf and then back to a presheaf is that
the presheaf be complete in the sense that both the following conditions hold:
(i) Whenever {Uj} is an open covering of an open subset U of X and
f ∈O(U) is an element such that ρUj,U( f ) = 0 for all j, then f = 0.
(ii) Whenever {Uj} is an open covering of an open subset U of X and
fj is given in O(Uj) for each j in such a way that ρUj∩Uk,Uj( fj) =
ρUj∩Uk,Uk( fk) for all j and k, then there exists f ∈O(U) such that
ρUj,U( f ) = fj for all j.
The structure sheaf of the spectrum of A is a certain sheaf of rings(Spec A, O)
with base space Spec A. Just as in the case of regular (= polynomial) functions on
an afﬁne variety, this sheaf will have the property that the ring of global sections
is isomorphic to the original ring (cf. Corollary 10.25). We shall describe O by
describing the presheaf. For each prime ideal p of A, let Ap be the localization of
A at p, i.e., the localization of A relative to the multiplicative system consisting
of the set-theoretic complement of p. This kind of localization is always a local
ring. The idea is to deﬁne a ring O(U) of regular functions for each open subset
U of Spec A in such a way that the stalk Op at the point p ends up being Ap for
each p. With afﬁne varieties we were able to make the deﬁnition directly in terms
of the function ﬁeld of the variety, i.e., the ﬁeld of fractions of A; both O(U)
and the stalk OP(U) at each point P ended up being subrings of this function
ﬁeld. The complication for general A is that we do not have a convenient analog
of the function ﬁeld available in which all the localizations are subrings. Thus
we proceed by imitating the messier equivalent deﬁnition of regular function
given in Proposition 10.28. Namely, for U open in Spec A, let O(U) be the set of
functions s from U into the product 
p∈U Ap such that s(p) is in the pth factor Ap
for each p and such that s is locally a quotient of members of A in the following
sense: for each p in U, there is to be an open neighborhood V of p within U and
there are to be elements a and f in A such that for each q in V , the element f is
not in q and s(q) equals a/f in Aq. (Recall that any element of A not in q deﬁnes
an element in the multiplicative system leading to Aq; f is to be such an element
for each q in V .) The mappings ρVU are taken as ordinary restriction mappings,
and the result is a presheaf. This presheaf is complete, and the associated sheaf

642
X. Methods of Algebraic Geometry
is the structure sheaf (Spec A, O). An afﬁne scheme is any sheaf of rings that is
isomorphic in a suitable sense to the structure sheaf of some ring.
3. Scheme. To deﬁne “scheme” and the notion that a scheme is deﬁned over
some ring or some ﬁeld, we need to back up and say a few more words about map-
pings in connection with sheaves. A ringed space is a sheaf of rings, (Spec A, O)
being an example.
Let (X, OX) and (Y, OY) be two ringed spaces, and let
{ρV ∗U ∗} and {ρ′
VU} be their respective systems of restriction maps. A morphism
(σ, ψ) : (X, OX) →(Y, OY) of ringed spaces consists of a continuous function
σ : X →Y and a collection ψ of homomorphisms ψU : OY(U) →OX(σ −1(U))
such that
ψV ◦ρσ −1V,σ −1U = ρ′
VU ◦ψU
whenever U and V are open subsets of Y with V ⊆U. The collection ψ = {ψU}
yields homomorphisms of stalks ψP : OY,σ(P) →OX,P for each P in X.
One property of the deﬁnition is that ifϕ : A →B is a homomorphism of rings,
then there is an associated morphism (σ, ψ) : (Spec B, OB) →(Spec A, OA) of
ringed spaces. The continuous map σ : Spec B →Spec A is the map σ = aϕ
given by aϕ(p) = ϕ−1(p) for any prime ideal p of B.
The mapping ψ on
stalks carries OSpec A,σ(p) = OSpec A,ϕ−1(p) to OSpec B,p and is what is induced
on the stalk by composition with ϕ. It is not quite true that every morphism
(σ, ψ) : (Spec B, OB) →(Spec A, OA) of ringed spaces arises from a ring
homomorphism. The homomorphism (σ, ψ) of ringed spaces resulting from the
ring homomorphism ϕ has the property that ψ carries the maximal ideal Mϕ−1(p)
of the stalk Aϕ−1(p) into the maximal ideal Mp of the stalk Bp. A morphism
(σ, ψ) of ringed spaces whose stalks are local rings is called a local morphism if
it has this property. With this deﬁnition one can show that every local morphism
of ringed spaces (σ, ψ) : (Spec B, OB) →(Spec A, OA) arises from some ring
homomorphism ϕ : A →B. This result is to be compared with Corollary 10.40
for afﬁne varieties.
An isomorphism of ringed spaces is automatically local if all the stalks are
local rings. The reason is that an isomorphism of one local ring onto another
carries the maximal ideal of the ﬁrst onto the maximal ideal of the second. Thus
the earlier deﬁnition of afﬁne scheme as a ringed space that is isomorphic to
some (Spec A, O) concealed only the rather natural deﬁnition of isomorphism of
ringed spaces, not the more subtle condition “local.”
A morphism of afﬁne schemes is a local morphism of the afﬁne schemes as
ringed spaces. Then the classes of all afﬁne schemes and morphisms of afﬁne
schemes together form a category. A scheme is a ringed space (X, O) such that
each point of X has an open neighborhood for which the restriction of the ringed
space to that part of the base is isomorphic to an afﬁne scheme. One can deﬁne
a natural notion of morphism for schemes, and the classes of all schemes and
morphisms of schemes together form a category.

13. Schemes
643
4. Variety as a scheme. Let V be an afﬁne variety over an algebraically
closed ﬁeld, and let A(V ) be the afﬁne coordinate ring.
We have just seen
how Spec A(V ) has the natural structure of an afﬁne scheme. Since Spec A(V )
includes all prime ideals of A(V ), not just the maximal ideals, the continuous
inclusion V →Spec A(V ) is not onto. However, there is a natural relationship
between the two, and there is a natural relationship between their rings of regular
functions. The reason is that morphisms of afﬁne varieties correspond exactly (in
contravariant fashion) to homomorphisms of the afﬁne coordinate rings, which in
turncorrespondexactlytomorphismsofafﬁneschemes. Fromthepointofviewof
categories, therefore, the categories of afﬁne varieties and afﬁne schemes match
perfectly. This description blurs what happens to the underlying algebraically
closed ﬁeld of scalars, and one wants to be able to say that the categories of afﬁne
varieties over k and afﬁne schemes over k match perfectly. Making this statement
requires an additional construction, which will be sketched in the next subsection.
This correspondence can be extended suitably from afﬁne varieties to quasipro-
jective varieties, and the interested reader can ﬁnd details on page 30 of Volume 2
of Shafarevich’s books.
5. Scheme deﬁned over a ring. If A is a ring and (X, OX) is a scheme,
then a morphism of schemes (σ, ψ) : X →Spec A deﬁnes a homomorphism
A →OX(U) of rings for each open subset U of X. Speciﬁcally ψSpec A carries
OSpec A(Spec A) = A into OX(X), and hence ρU X ◦ψSpec A carries A into OX(U)
if {ρVU} is the system of restriction maps for (X, OX). The result is that OX
becomes a sheaf of A algebras.
Conversely if OX is a sheaf of A algebras, then one can construct a morphism
of schemes X →Spec A. In this case one says that (X, OX) is a scheme over
A. Every sheaf of abelian groups is a sheaf of Z algebras, and thus every scheme
is a scheme over Z. Schemes over Z are of special interest in number-theoretic
situations, among others. The schemes produced from varieties in the previous
subsection are schemes over the underlying ﬁeld k. The notion of a scheme over a
ﬁeld that is not algebraically closed is one way of extending the theory of varieties
to have it apply when the underlying ﬁeld is not algebraically closed.
6. Role of homological algebra. The sheaves of abelian groups over a ﬁxed
topological space X, with a natural deﬁnition of morphism, form a category, and
one can deﬁne kernels and cokernels in this category. The result turns out to
be an abelian category with enough injectives, and the homological algebra of
Chapter IV is applicable. If (X, O) is a sheaf over X, then formation of global
sections, given by (X, O) 	→O(X), is a covariant left exact functor. Since there
are enough injectives in the category, the derived functors make sense, and the kth
derived functor gives what is called the kth sheaf cohomology group H k(X, O)
with coefﬁcients in O. This kind of cohomology is easy to use abstractly and hard
touseconcretely, butitcanbeshowntobeisomorphictoothermoreconcretekinds
of cohomology. In this way the cohomology of sheaves leads to generalizations

644
X. Methods of Algebraic Geometry
of Euler characteristics and Betti numbers that have signiﬁcance in number theory
and geometry.
In applications, there tends to be a ringed space (X, R) (maybe a scheme)
in the picture, and the sheaves (X, O) often have the property that each stalk
of O is a module for the corresponding stalk of R. Then the above kind of
theory is applicable for sheaves that are R modules in this sense, not merely
sheaves of abelian groups. The interested reader can ﬁnd details in Chapter III of
Hartshorne’s book.
BIBLIOGRAPHICAL REMARKS. The topic of schemes assumes knowledge of a
certain core of algebraic geometry and commutative algebra, and it builds on more
commutative algebra as it goes along. Some books mentioned in the Selected
References that include algebraic geometry at the beginning level are those of
Hartshorne (Chapter I), Harris, Reid, and Shafarevich (Volume 1). All these
books have many geometric examples; this is particularly so for the book by
Harris. Some books on commutative algebra are the ones by Atiyah–Macdonald,
Eisenbud, Matsumura, and Zariski–Samuel. These lists are by no means exhaus-
tive. There are in fact hundreds of books on the two subjects. To get a list of many
of the ones in commutative algebra, one can search in the Library of Congress
catalog at http://catalog.loc.gov, using the call number QA251.3; a few
additional ones are sprinkled in among books with call number QA251. For
books on algebraic geometry, one can search using the call number QA564.
The book by Eisenbud–Harris on schemes is an introductory one written
in a style that makes it comparatively easy for the reader to get an overview
of the subject. Two older books on schemes are the ones by Macdonald and
Mumford. Hartshorne’s book introduces schemes in Chapter II, and Volume 2 of
Shafarevich’s books is on that topic. The end of Volume 2 of Shafarevich’s books
contains a 20-page historical sketch of algebraic geometry, including discussion
of some of the precursors of the subject of schemes.
14. Problems
In all problems, k is understood to be an algebraically closed ﬁeld.
1.
If P is in Pn, show that the ideal I (P) of members of k[X0, . . . , Xn] vanishing
at all points (x0, . . . , xn) in kn+1 −{0} with [x0, . . . , xn] = P is homogeneous.
2.
Let X be a Noetherian topological space.
(a) Prove that X is compact.
(b) Prove that every irreducible closed subset of X is connected.
3.
(a) Prove that the image of a quasiprojective variety V under a regular function
f : V →A1 is connected.
(b) Prove that if V is a projective variety and ϕ : V →An is a morphism, then
ϕ(V ) is a one-point set.

14. Problems
645
4.
Let U be the quasi-afﬁne variety U = A2 −{(0, 0)} in A2. Prove that O(U) =
k[X, Y].
5.
Deduce from the previous problem, Corollary 10.25, and Theorem 10.38 that U
is not isomorphic to an afﬁne variety.
6.
Prove that a rational map of an irreducible curve into an irreducible curve is
dominant or is constant.
7.
Let ϕ : U →V be a dominant morphism between quasiprojective varieties.
Prove that the induced mapping of local rings ϕ∗
P : Oϕ(P)(V ) →OP(U) given
in Proposition 10.42 is one-one.
8.
Let V be the afﬁne variety V = V (W X −Y Z) in A4, let A(V ) be the afﬁne
coordinate ring k[W, X, Y, Z]/(W X −Y Z), let X and Y be the images of X
and Y in A(V ), and let f = X/Y in the ﬁeld of fractions of A(V ). Prove that
there exist no members ¯a and ¯b of A(V ) with f = ¯a/¯b and ¯b(w, x, y, z) ̸= 0
whenever wx = yz and one or both of w and y are nonzero.
9.
Let U and V be quasiprojective varieties, and let ϕ : U →V be a function.
Suppose that U and V are unions of nonempty open subsets U = 
α∈I Uα and
V = 
α∈I Vα such that ϕ(Uα) ⊆Vα for all α. Prove that ϕ is a morphism if and
only if each ϕα : Uα →Vα is a morphism.
10. This problem concerns local extensions of regular functions from quasiprojective
varieties to open sets in the ambient afﬁne or projective space.
(a) Let V be an afﬁne variety in An, let U be a nonempty open subset of V , let
f be in O(U), and let P be a point in U. Prove that there exist an open
neighborhood U0 of U about P in V , an open set 
U0 in An, and a function
F in O(
U0) such that U0 = V ∩
U0 and such that F is an extension of f

U0.
(b) Extend the result of (a) to make it valid for any quasiprojective variety V in
Pn.
11. Suppose that X and Y are quasiprojective varieties, that U and V are irreducible
closed subsets of X and Y, respectively, and that ϕ : X →Y is a morphism such
that ϕ(U) ⊆V . Prove that ϕ : U →V is a morphism.
12. Prove that
(a) the mappingϕ : Pn−1 →Pn given by ϕ([x0, . . . , xn−1]) = [x0, . . . , xn−1, 0]
is an isomorphism of Pn−1 onto the projective hyperplane Hn corresponding
to the homogeneous ideal (Xn) of k[X0, . . . , Xn],
(b) any projective variety V in Pn that lies in Hn is isomorphic to a projective
variety in Pn−1,
(c) any projective variety V in Pn is isomorphic to a projective variety V ′ in some
Pr with r ≤n that is not contained in any projective hyperplane deﬁned by
a homogeneous ideal (X j) of k[X0, . . . , Xr].
Problems 13–16 relate the classical condition for detecting a singularity in the afﬁne

646
X. Methods of Algebraic Geometry
case to the corresponding condition in the projective case. The key is an identity
traditionally known as Euler’s Theorem that is proved as Problem 3 at the end of
Chapter VIII. In these problems it is assumed that F1, . . . , Fr are homogeneous
polynomials in k[X0, . . . , Xn], that P = [x0, . . . , xn] is a point in Pn in their common
locus of zeros, and that P is in the image of An under β0, i.e., that x0 ̸= 0. Deﬁne
f1, . . . , fr in k[X1, . . . , Xn] by fi(X1, . . . , Xn) = Fi(1, X1, . . . , Xn).
13. Deﬁne J(F)(x′
0, . . . , x′
n) to be the r-by-(n + 1) matrix whose (i, j)th entry is
∂Fi
∂X j (x′
0, . . . , x′
n) for 1 ≤i ≤r and 0 ≤j ≤n, and deﬁne J( f )(x′
1, . . . , x′
n) to
be the r-by-n matrix whose (i, j)th entry is ∂fi
∂X j (x′
1, . . . , x′
n) for 1 ≤i ≤r and
1 ≤j ≤n. Prove that rank J(F)(x′
0, . . . , x′
n) = rank J(F)(λx′
0, . . . , λx′
n) for
all λ ∈k×.
14. With notation as in Problem 13, prove that the r-by-n matrix J( f )(x′
1, . . . , x′
n)
equals the r-by-n matrix obtained by deleting the 0th column of the r-by-(n + 1)
matrix J(F)(1, x′
1, . . . , x′
n).
15. Using Euler’s Theorem (Problem 3 at the end of Chapter VIII), prove concerning
the point P on the locus of common zeros of F1, . . . , Fr that the 0th column of
the matrix J(F)(x0, . . . , xn) is a linear combination of the other columns of the
matrix.
16. Deduce for the point P on the locus of common zeros of F1, . . . , Fr that
rank J(F)(x0, x1, . . . , xn) = rank J( f )(x1/x0, . . . , xn/x0).
Problems 17–22 concern products of quasiprojective varieties.
The Segre map-
ping σ : Pm × Pn →PN with N = mn + m + n was deﬁned in Section 8 by
σ

[x0, . . . , xm], [y0, . . . , yn]

= [w00, . . . , wmn] with wi j = xi yj. Let us abbreviate
[w00, . . . , wmn] as [{wi j}] and k[W00, . . . , Wmn] as k[{Wi j}].
17. Prove that σ is well deﬁned and one-one.
18. Every member [{wi j}] of image σ has wi jwkl = wilwkj for all i, j, k,l. Prove
conversely that every member [{wi j}] of PN with wi jwkl = wilwkj for all i, j, k,l
is in image σ, and deduce that image σ = V (a), where a is the ideal in k[{Wi j}]
generated by all Wi jWkl −WilWkj.
19. This problem will prove that a is a prime ideal, and in particular it will follow
that V (a) is irreducible. Let ϕ : k[{Wi j}] →k[X0, . . . , Xm, Y0, . . . , Yn] be the
substitution homomorphism given by setting Wi j = XiYj. Then ker ϕ is an ideal
containing a.
(a) By introducing a suitable monomial ordering in k[{Wi j}], show that any
monomial in k[{Wi j}] of total degree d is congruent modulo a to a monomial
of total degree d of the form M = 
i, j W
ai j
i j having the property that ai j > 0
implies that akl = 0 for all (k,l) with l > j and k > i. Call a monomial of
this form reduced.

14. Problems
647
(b) Suppose that M = 
i, j W
ai j
i j and M′ = 
i, j W
bi j
i j are two distinct reduced
monomials. By considering the ﬁrst Wi j for which ai j ̸= bi j, prove that
ϕ(M) ̸= ϕ(M′).
(c) Deduce that ker ϕ = a, and show why it follows that a is prime.
20. Let p be a prime ideal in k[X0, . . . , Xm], and let R = k[X0, . . . , Xm]/p be the
quotient.
(a) Prove that the ideal p k[Y0, . . . , Yn] in k[X0, . . . , Xm, Y0, . . . , Yn] generated
by all products of members of p and polynomials in Y0, . . . , Yn is prime.
(b) By following the substitution homomorphism
k[{Wi j}] →k[X0, . . . , Xm, Y0, . . . , Yn]
with a substitution homomorphism k[X0, . . . , Xm, Y0, . . . , Yn] →R[Z],
prove that whenever U is a projective variety in Pm and P is a point in Pn,
then σ(U × {P}) is a projective variety in PN.
21. Let U and V be projective varieties in Pm and Pn, respectively. Problem 20
shows that σ(U × {v}) is a projective variety in PN for each v ∈V . Suppose
that σ(U × V ) is a union E1 ∪E2 of two closed sets in PN.
(a) For i equal to 1 or 2, deﬁne Vi = {v ∈V | σ(U × {v}) ⊈Ei}. Why is
V1 ∩V2 = ∅?
(b) Prove that V1 and V2 are open by using bihomogeneous polynomials to
exhibit each of V1 and V2 as a neighborhood of each of its points.
(c) Deduce from (b) that σ(U × V ) is a projective variety in PN.
(d) Show how to deduce from (c) that if U and V are quasiprojective varieties in
Pm and Pn, respectively, then σ(U × V ) is a quasiprojective variety in PN.
22. (a) Prove that if U and V are quasiprojective varieties, then the projections of
U × V to U and V are morphisms. Here the projection of U × V to U is
understood to be the map σ(u, v) 	→u of σ(U × V ) into U, and similarly
for the projection to V .
(b) If ϕ : U →X and ψ : U →Y are morphisms, prove that (ϕ, ψ) : U →
X × Y when deﬁned by (ϕ, ψ)(u) = (ϕ(u), ψ(u)) is a morphism.
(c) If ϕ : U →X and ψ : V →Y are morphisms, prove that ϕ ×ψ : U ×V →
X × Y when deﬁned by (ϕ × ψ)(u, v) = (ϕ(u), ψ(v)) is a morphism.
Problems 23–25 make some observations about prime ideals and irreducible
polynomials.
23. Let I = ( f1, . . . , fr) be an ideal in k[X, Y] such that the zero locus V (I) is
irreducible and such that f1, . . . , fr are irreducible polynomials.
(a) Prove that I is prime if dim V (I) = 1.
(b) Give an example to show that I need not be prime if dim V (I) = 0.

648
X. Methods of Algebraic Geometry
24. Fix a monomial ordering for k[X1, . . . , Xn], and let I be a nonzero ideal in
k[X1, . . . , Xn].
Prove that if I is prime, then the members of any minimal
Gr¨obner basis of I are irreducible polynomials.
25. Suppose that char(k) ̸= 2. Within k[X, Y, Z], let E be the homogeneous sub-
space k[X, Y, Z]2. The six monomials in E form a k basis of E and may be used
to identify E with k6. Under this identiﬁcation prove that the subset of reducible
polynomials in E, including the 0 polynomial, is an afﬁne hypersurface of k6.
Problems 26–35 concern elliptic curves. An elliptic curve over k is a pair (E, O)
consisting of a nonsingular irreducible projective curve E of genus 1 and a distin-
guished point O. These problems use the Riemann–Roch Theorem and its associated
notation in Chapter IX in order to exhibit a concrete realization of such a curve in
P2 with O on the line at inﬁnity and with all other points of E in A2. Such a curve
has a remarkable structure; for further information, including further applications of
the Riemann–Roch Theorem to these curves, see the book by Silverman. Corollary
10.56 identiﬁes the points of E with the discrete valuations of the function ﬁeld k(E)
over E. Let vO be the discrete valuation corresponding to O.
26. For n > 0, prove that ℓ(nvO) = n. Use this result to ﬁnd members x and y of
k(E) whose divisors satisfy (x)∞= 2vO and (y)∞= 3vO.
27. Prove that [k(E) : k(x)] = 2 and [k(E) : k(y)] = 3.
28. Why does it follow from the previous problem that k(E) = k(x, y)?
29. From the fact that ℓ(6vO) = 6, deduce a nontrivial linear dependence over k
among the members 1, x, y, x2, xy, y2, x3 of k(E). Show that the coefﬁcients
of y2 and x3 are necessarily nonzero, and then scale x and y appropriately to
show that the image of the function ϕ : E −{0} →P2 deﬁned by ϕ(P) =
[x(P), y(P), 1] is contained in the projective closure C of the zero locus of the
polynomial f (X, Y) = (Y 2 + a1XY + a3Y) −(X3 + a2X2 + a4X + a6).
30. Prove that f (X, Y) is irreducible and that C is therefore a projective curve.
31. Why is ϕ : E −{0} →C a morphism? Why does it follow that ϕ extends to a
morphism  : E →C ?
32. Deduce from Problem 28 that  is birational.
33. Show that C is nonsingular at its point at inﬁnity.
34. Show that if C is singular at (x0, y0) in A2, then the member of k(E) given by
z = (y −y0)(x −x0)−1 has vO(z) = −1 and vP(z) ≥0 for all P in E −{O}.
35. Deduce from Problems 33 and 34 that C is nonsingular, and explain why it
follows that  : E →Z is an isomorphism.

HINTS FOR SOLUTIONS OF PROBLEMS
Chapter I
1. We are interested in odd p’s such that
m
p

= +1. Factor m as 
j p
kj
j . Then qua-
dratic reciprocity gives
m
p

=
j
pj
p
kj = 
kj odd
pj
p

= 
kj odd(−1)
1
4 (p−1)(pj−1) p
pj

.
We consider p ≡1 mod 4 and p ≡3 mod 4 separately. For p ≡1 mod 4, the set in
question consists of those p’s for which
 p
pj

is −1 for an even number of those kj’s that
are odd. This is the union over all such systems of minus signs of the intersection over
j of the ﬁnitely many arithmetic progressions for which the residue
 p
pj

equals the
jth sign. For a single system of minus signs, the result is an arithmetic progression of
the form k 
kj odd pj +b by the Chinese Remainder Theorem. Each of these contains
a nonempty set of primes by Dirichlet’s Theorem, and hence P is nonempty.
For p ≡3 mod 4, if 
kj odd(−1)
1
2 (pj−1) is +1, then the set in question is of the
same form as above. If 
kj odd(−1)
1
2 (pj−1) is −1, then the set in question consists of
those p’s for which
 p
pj

is −1 for an odd number of those kj’s that are odd, and this
again is the ﬁnite union of arithmetic progressions.
2. For (a), the proof of necessity of Theorem 1.6b remains valid when the prime p
is replaced by the integer m. For (b), the ﬁrst paragraph of the proof of the sufﬁciency
of Theorem 1.6b handles matters if m is odd.
3. For D = −56, H has order 4, but H ′ has order 3 because 3x2 ± 2xy + 5y2
are improperly equivalent but not properly equivalent. A 3-element set has no group
structure such that a 4-element group maps homomorphically onto it.
4. For (a), the product of any two integers representable as ax2 + bxy + cy2 is
representable by the class of the square, which is the class of the inverse because the
class is assumed to have order 3. The class of the inverse is the class of (a, −b, c),
and this represents the same integers as (a, b, c).
For (b), we seek reduced triples. These are (a, b, c) with |b| ≤a ≤c and with
b2 −4ac = D = −23, and we know that 3ac ≤|D| and that b has the same
parity as D. Hence b is odd, and the inequalities 3b2 ≤3a2 ≤3ac ≤23 show
that |b| = 1. For |b| = 1, we have 1 −4ac = −23 and ac = 6. Since a ≤c, the
possibilities with |b| = 1 are (1, ±1, 6) and (2, ±1, 3). Since (1, 1, 6) and (1, −1, 6)
are properly equivalent by Proposition 1.7, |b| = 1 leads to just the three possibilities
(1, 1, 6), (2, 1, 3), and (2, −1, 3). Proposition 1.7 shows that these lie in distinct
proper equivalence classes, and thus h(−23) = 3.
649

650
Hints for Solutions of Problems
For (c), the general theory shows that (1, 1, 6) corresponds to the identity class,
and therefore the other two reduced forms are in classes of order 3.
For (d), we ﬁrst track down what happens to the forms. If we write ∼for proper
equivalence, then we have
(2, 1, 3)(2, 1, 3) ∼(2, 1, 3)(3, −1, 2) ∼(2, 5, 6)(3, 5, 4)
= (6, 5, 2) ∼(2, −5, 6) ∼(2, −1, 3),
and the last form is improperly equivalent to (2, 1, 3). The next step is to interpret this
chain with actual variables. If the initial variables are x1, y1, x2, y2, then the change
at the ﬁrst step from (2, 1, 3) to (3, −1, 2) comes from x2 = y′
2, y2 = −x′
2 while
leaving x1 and y1 unchanged as x1 = x′
1, y1 = y′
1. The change at the second step
from (2, 1, 3) to (2, 5, 6) and from (3, −1, 2) to (3, 5, 4) comes from the translations
x′
1 = x′′
1 + y′′
1, y′
1 = y′′
1, x′
2 = x′′
2 + y′′
2, y′
2 = y′′
2. The multiplication step comes from
Proposition 1.9 and is given by x3 = x′′
1x′′
2 −2y′′
1 y′′
2 and y3 = 2x′′
1 y′′
2 +3x′′
2 y′′
1 +5y′′
1 y′′
2.
And so on. The ﬁnal result is that
(2x2
1 + x1y1 + 3y2
1)(2x2
2 + x2y2 + 3y2
2) = 2X2 + XY + 3Y 2,
where X = x1(−x2 + y2) + y1(x2 + 2y2) and Y = y1(x2 −y2) + x1(x2 + y2).
5. The equality

1
0
−a−1b 1
 
2a b
b 2c
 
1 −a−1b
0
1

=

2a −b
−b 2c

shows this.
6. For reduced forms we seek (a, b, c) with a > 0, c > 0, |b| ≤a ≤c. We know
that 3ac ≤|D| = 67, and D odd implies b odd. From 3b2 ≤3a2 ≤3ac ≤67, we
obtain 3b2 ≤67 and |b| ≤4. So |b| is 1 or 3. For |b| = 1, 1
4(b2−D) = 1
4(b2+67) =
17; then 17 = ac, and a = 1 and c = 17. Since (1, 1, 17) is properly equivalent
to (1, −1, 17) by Proposition 1.7, we obtain only one proper equivalence class from
this pair. For |b| = 3, 1
4(b2 −D) = 1
4(9 + 67) = 19 forces ac = 19 and then a = 1
and c = 19. Then |b| ≤a is not satisﬁed. So |b| = 3 gives no proper equivalence
classes, and h(−67) = 1.
7. The 6 cycles are
(1, 8, −15), (−15, 7, 2), (2, 7, −15), (−15, 8, 1);
(−1, 8, 15), (15, 7, −2), (−2, 7, 15), (15, 8, −1);
(3, 8, −5), (−5, 7, 6), (6, 5, −9), (−9, 4, 7), (7, 3, −10), (−10, 7, 3);
(−3, 8, 5), (5, 7, −6), (−6, 5, 9), (9, 4, −7), (−7, 3, 10), (10, 7, −3);
(5, 8, −3), (−3, 7, 10), (10, 3, −7), (−7, 4, 9), (9, 5, −6), (−6, 7, 5);
(−5, 8, 3), (3, 7, −10), (−10, 3, 7), (7, 4, −9), (−9, 5, 6), (6, 7, −5).
8. The form (1, 1, 12) corresponds to the identity class, the classes of(2, ±1, 6) are
inverses of one another, and the classes of (3, ±1, 4) are inverses of one another. The

Chapter I
651
group structure has to be cyclic, and any element other than the identity can be taken as
a generator. Let us take a to be the class of (2, 1, 6). We are to identify a2. The form
(2, 1, 6) is aligned with itself (having the same b component), it has j = 6/2 = 3,
and the composition formula of Proposition 1.9 leads to (2 · 2, 1, j) = (4, 1, 3).
This is properly equivalent to (3, −1, 4), and we do not have to follow through the
algorithm of Theorem 1.6a to identify the product in our list. The result is that
a ↔(2, 1, 6), a2 ↔(3, −1, 4), a3 = (a2)−1 ↔(3, 1, 4), a4 = a−1 ↔(2, −1, 6),
and a5 = 1 ↔(1, 1, 12).
10. For (a), the result is known for n prime by Theorem 1.2. By induction and
the deﬁnition of the Jacobi symbol, it is enough to handle n = ab when a and
b can be handled.
We have 1
2(n −1) =
1
2(ab −1) =
1
2b(a −1) + 1
2(b −1)
≡1
2(a −1) + 1
2(b −1) mod 2, the last step following because b is odd. Therefore
(−1)
1
2 (n−1) = (−1)
1
2 (a−1)+ 1
2 (b−1) =
−1
a
−1
b

=
−1
n

, the last step following by
Problem 9a.
For (b), we argue similarly, and the key computation is 1
8(n2−1) = 1
8(a2b2−1) =
1
8b2(a2 −1) + 1
8(b2 −1) ≡1
8(a2 −1) + 1
8(b2 −1) mod 2, the last step following
because b2 is odd.
11. Allowing primes to appear more than once, write factorizations of m and n as
m = r
i=1 pi and n = s
j=1 qj. Then Theorem 1.2 gives
m
n

= s
j=1
r
i=1
pi
qj

=
s
j=1
r
i=1
qj
pi

(−1)
1
2 (pi−1) 1
2 (qj−1) =
n
m

(−1)
	s
j=1
	r
i=1
1
2 (pi−1) 1
2 (qj−1). Since
	s
j=1
	r
i=1
1
2(pi −1) 1
2(qj −1) =
 	s
j=1
1
2(qj −1)
 	r
i=1
1
2(pi −1)

and since 	s
j=1
1
2(qj −1) ≡1
2(n −1) mod 2 and 	r
i=1
1
2(pi −1) ≡1
2(m −1) mod 2
by the same argument as in Problem 10a, the required formula follows.
12. For (a), choose by Dirichlet’s Theorem a sufﬁciently large prime p that is
≡3 mod 8 and is in particular ≡3 mod 4. If 8 divides |G|, then the fact that |G|
divides p + 1 implies that 8 divides p + 1. So p ≡−1 mod 8. Since p was chosen
with p ≡3 mod 8, this is a contradiction. So 8 cannot divide |G|.
For (b), choose by Dirichlet’s Theorem a sufﬁciently large prime p that is ≡
7 mod 12 and is in particular ≡3 mod 4. If 3 divides |G|, then 3 divides p +1. Thus
p ≡−1 mod 3. Since also p ≡3 mod 4, p ≡11 mod 12. But p was chosen with
p ≡7 mod 12. This is a contradiction, and 3 cannot divide |G|.
For (c) with an odd primeq > 3 given, choose by Dirichlet’s Theorem a sufﬁciently
large prime p that is ≡3 mod 4q and is in particular ≡3 mod 4. If q divides |G|,
then q divides p + 1, and p + 1 ≡0 mod q. Meanwhile, p ≡3 mod 4q implies that
p + 1 ≡4 mod 4q and p + 1 ≡4 mod q, contradiction. So q cannot divide |G|.
13. For (a), choose by Dirichlet’s Theorem a sufﬁciently large prime p that is
≡5 mod 12 and is in particular ≡2 mod 3 and ≡1 mod 4. If 4 divides |G|, then 4
divides p + 1, which is ≡2 mod 4. So 4 cannot divide |G|.

652
Hints for Solutions of Problems
For (b), choose by Dirichlet’s Theorem a sufﬁciently large prime p that is ≡
2 mod 9 and is in particular ≡2 mod 3. If 9 divides |G|, then 9 divides p + 1, which
is ≡3 mod 9. So 9 cannot divide |G|.
For (c) with an odd primeq > 3 given, choose by Dirichlet’s Theorem a sufﬁciently
large prime p that is ≡2 mod 3q and is in particular ≡2 mod 3. If q divides |G|,
then q divides p + 1, which is ≡3 mod 3q and hence is ≡3 mod q. So q cannot
divide |G|.
14. The integers in ⟨a,r⟩are exactly the multiples of a, since such an integer n has
to be of the form n = ca + dr for integers c and d. This equation says that n = ca
and 0 = dr, since 1 and r are linearly independent over Q. The integer N(s) = sσ(s)
is in I because s is in I and σ(s) is in R, and thus N(s) has to be a multiple of a.
15. Write I = ⟨a,r⟩with a > 0 an integer and r in I by Lemma 1.19b. As in the
previous problem, the integer a is characterized uniquely in terms of I as the least
positive integer in I. Put r = b + gδ for suitable integers b and g. Without loss of
generality, we may assume that g > 0. Using the division algorithm and possibly
replacing b by b −na for some integer n, we may assume that 0 ≤b < a.
With these conventions in place, let us see that g necessarily divides a. The fact
that aδ has to be in I means that aδ has an expansion aδ = c1a + c2(b + gδ) with
integer coefﬁcients. Then aδ = c2gδ, and g must divide a.
In particular, 0 < g ≤a is forced. To see that b and g are uniquely determined,
let {a, b′ + g′δ} be another such Z basis. Since b′ + g′δ = c1a +c2(b + gδ) and since
symmetrically we have b + gδ = c′
1a + c′
2(b′ + g′δ), we obtain g′ = c2g = c2c′
2g′.
Therefore |c2| = 1. Meanwhile, we must have
c1a + c2b = b′
and
c2gδ = g′δ.
The second of these equations shows that c2 > 0. Thus c2 = 1. Finally c1a = b′ −b
with 0 ≤b < a and 0 ≤b′ < a forces b′ −b = 0. Therefore a, b, and g are uniquely
determined.
Tocomplete the proof, we needtosee that g dividesb andthatag divides N(b+gδ).
Since aδ is in I, aδ = c′′
1a + c′′
2(b + gδ). Hence c′′
2g = a and c′′
1a + c′′
2b = 0.
Substituting the ﬁrst of these equations into the second gives c′′
1c′′
2g + c′′
2b = 0. Since
c′′
2 ̸= 0 from the equality c′′
2g = a, c′′
1g + b = 0. Thus g divides b.
To see that ag divides N(b + gδ), we use the fact that gσ(δ)(b + gδ) is in I to
write bgσ(δ) + δσ(δ)g2 = d1ag + d2g(b + gδ) for some integers d1 and d2. Then
N(b + gδ) = b2 + bg(δ + σ(δ)) + δσ(δ)g2 = b2 + bgδ + d1ag + d2g(b + gδ).
Equating coefﬁcients of δ and 1 gives
0 = bg + d2g2
and
N(b + gδ) = b2 + d1ag + d2bg.
Since g > 0, the ﬁrst of these equations gives d2 = −bg−1. Substituting into the
second equation gives
N(b + gδ) = b2 + d1ag −(bg−1)bg = d1ag,
and we see that ag divides N(b + gδ).

Chapter I
653
16. We are to show that Za +Z(b+gδ) is closed under multiplication by arbitrary
members of R. It is enough to treat multiplication by 1 and by δ. There is no problem
for 1. Since δ+σ(δ) is in Z, it is enough to show that there exist integers c1, c2, d1, d2
with
δa = c1a + c2(b + gδ)
and
σ(δ)(b + gδ) = d1a + d2(b + gδ).
In view of the assumed divisibility, we can put c2 = ag−1, c1 = −bg−1, d2 = −bg−1,
and d1 = N(b + gδ)(ag)−1. Then the ﬁrst equation is certainly satisﬁed, and the
question concerning the second equation, once we have multiplied it by g, is whether
we have an equality
gσ(δ)(b + gδ) ?= N(b + gδ) −b2 −bgδ.
The left side is N(b + gδ) −b(b + gδ), and thus equality indeed holds.
17. From Section 7 the relevant formula is N(I) = |
√
D |−1|r1σ(r2) −σ(r1)r2|.
Here we can take r1 = a and r2 = c + dδ. Substitution gives
N(I) = |
√
D |−1|a||σ(c + dδ) −(c + dδ)|
= |
√
D |−1|a||c + dσ(δ) −c −dδ| = |
√
D |−1|ad||σ(δ) −δ|.
The expression |
√
D |−1|σ(δ)−δ| arose in Section 7 in the computation of N(R) and
was shown to be 1. Thus N(I) = |ad|.
18. For (a), the algorithm of Section IV.9 of Basic Algebra shows how to align
matters so as to compute the quotient of a free abelian group by a subgroup when
the subgroup is given by generators. The given relationship between the generators
a and b + gδ of Problem 15 with the Z basis of R is

a
b+gδ

=
 a 0
b g
 
1
δ

.
The procedure is to do row and column operations on the coefﬁcient matrix to bring
it into diagonal form. Since g divides b, a column operation replaces the b by 0.
We obtain a diagonal matrix with diagonal entries a and g, and the quotient group
is identiﬁed as (Z/aZ) ⊕(Z/gZ). Thus ag is identiﬁed as the number of elements
in the quotient group R/I. Problem 17 identiﬁed ag as N(I), and thus N(I) is the
number of elements in R/I.
For (b), the inclusion I ⊆J induces a quotient mapping of the ﬁnite group R/I
onto R/J. As a homomorphic image of R/I, R/J must have an order that divides
the order of R/I. In view of (a), N(J) divides N(I). The equality I = J holds if
and only if the quotient mapping is one-one, and this happens, because of the ﬁnite
cardinalities, if and only if N(J) = N(I).

654
Hints for Solutions of Problems
19. The relevant arguments for the ﬁrst three parts of this problem already appear
in Chapters VIII and IX of Basic Algebra, and thus we can be brief. For (a), the
Chinese Remainder Theorem (Theorem 8.27 of Basic Algebra) shows that R/I J ∼=
R/I × R/J, and then N(I J) = N(I)N(J) by Problem 18a.
For (b), the in-
ductive argument for (∗∗) in the proof of Theorem 9.60 of Basic Algebra shows
that dimZ/pZ R/Pe = ef , and thus |R/Pe| = pef .
For (c), Corollary 8.63 of
Basic Algebra and Problem 18a above together show that N(I) = n
j=1 N(P
kj
j )
if I = n
j=1 P
kj
j
is the unique factorization of the ideal I. Since N(Pkk
j ) = N(Pj)kj
by (b), N(I) = n
j=1 N(Pj)kj, and (c) follows immediately.
For (d), we use Problem 15 to write I = ⟨a, b + gδ⟩; then
Iσ(I) = (a2, a(b + gδ), a(b + gσ(δ)), N(b + gδ)).
Each of the generators on the right side lies in the principal ideal (ag). In fact, a2 is in
(ag) because g divides a, a(b + gδ) and a(b + gσ(δ)) are in (ag) because g divides
b, and N(b + gδ) is in (ag) because ag divides N(b + gδ). Therefore Iσ(I) ⊆(ag).
Since N(I) = ag by Problem 17, Problem 19c shows that N(Iσ(I)) = N((ag)).
Then Iσ(I) = (ag) = (N(I)) by Problem 18b.
20. The only ideal I with N(I) = 1 is I = R. Problem 19c therefore shows that a
nontrivial factorization of (p)R leads to a nontrivial factorization of its norm, which
is p2. This factorization must be p2 = p · p, and thus I factors nontrivially at most
into two factors, each with norm p.
21. For (a), we use Problem 15 to write a nontrivial factor I of (2)R as I =
⟨a, b + gδ⟩. Problem 17 shows that 2 = N(I) = ag with g dividing a. Therefore
a = 2 and g = 1. So the only possible factors are of the form I = ⟨2, b + δ⟩with
0 ≤b < a = 2. Thus b = 0 or b = 1. When D is odd, we have Tr(δ) = 1 and
N(δ) = 1
4(1 −m). Then N(b + δ) = b2 + b Tr(δ) + N(δ) = b2 + b + 1
4(1 −m) ≡
1
4(1 −m) mod 2. If m ≡5 mod 8, then we see that 2 does not divide N(b + δ), and
thus (2)R cannot have a nontrivial factor.
For (b), we again have N(b + δ) = b2 + b Tr(δ) + N(δ) = b2 + b + 1
4(1 −m) ≡
1
4(1 −m) mod 2, and the condition m ≡1 mod 8 makes the right side 0. Thus 2
divides N(b+δ), and ⟨2, δ⟩and ⟨2, 1+δ⟩are both ideals by Problem 16. The product
of these ideals is ⟨2, δ⟩⟨2, 1 + δ⟩= (4, 2δ, 2(1 + δ), δ2) and contains (2)R because
2 = 2(1 + δ) −2δ. Moreover, the product has norm 4 by Problems 17 and 19c, and
this matches the norm of (2)R. Thus Problem 18b shows that ⟨2, δ⟩⟨2, 1+δ⟩= (2)R.
For (c) and (d), δ = −√m. Thus N(b + δ) = b2 + b Tr(δ) + N(δ) = b2 −m =
b −1
4 D. If D/4 ≡3 mod 4, then b −1
4 D is divisible by 2 for b = 1. If D/4 ≡
2 mod 4, then b −1
4 D is divisible by 2 for b = 0. With b taking on the appropriate
value in the two cases, ⟨2, b + δ⟩is an ideal by Problem 16. The square of this ideal
is (4, 2(b + δ), (b −√m )2) = (4, 2(b + δ), b2 + m −2m
√
b ). The deﬁnition of b
makes b2 + m even in every case, and hence ⟨2, b + δ⟩2 ⊇(2)R. Since the norms of
the ideals on the two sides are both 4, the two ideals must be equal.

Chapter I
655
22. Arguing as in the previous problem, we see that any nontrivial factor of (p)R
must have norm p and therefore must be given by ⟨p, x + δ⟩for some x such that p
divides N(x + δ) = x2 + x Tr(δ) + N(δ).
For (a), Tr(δ) = 1 and N(δ) = 1
4(1 −m) = 1
4(1 −D), and the condition is that
p divide x2 + x + 1
4(1 −D). This means that x2 + x + 1
4(1 −D) ≡0 mod p
is to have a solution. When this happens, Problem 16 ensures that ⟨p, x + δ⟩is
an ideal. Then ⟨p, x + σ(δ)⟩is an ideal as well, and the product of the two is
(p2, p(x + δ), p(x + σ(δ)), N(x + δ)). Since p divides N(x + δ), this product ideal
is contained in (p)R. The product ideal and (p)R both have norm p2, and therefore
they are equal.
For (b), Tr(δ) = 0 and N(δ) = −m = −D/4, and the condition is that p divide
x2 −D/4. This means that x2 −D/4 ≡0 mod p is to have a solution. When this
happens, Problem 16 ensures that ⟨p, x + δ⟩is an ideal. Then ⟨p, x + σ(δ)⟩is an
ideal as well, and the product of the two is (p2, p(x + δ), p(x + σ(δ)), N(x + δ)).
Since p divides N(x + δ), this product ideal is contained in (p)R. The product ideal
and (p)R both have norm p2, and therefore they are equal.
For (c), the respective conditions for factorization in (a) and (b) are that
x2 + x + 1
4(1 −D) ≡0 mod p and x2 −D/4 ≡0 mod p be solvable. In both cases
the quadratic expression on the left side has discriminant D. Hence factorization
occurs if and only if D is a square modulo p.
23. In both cases we are assuming that (p)R has a factor I = ⟨p, x + δ⟩with
0 ≤x < p. Using Problem 15, let us write σ(I) = ⟨p, x + σ(δ)⟩= ⟨p, y + δ⟩
with 0 ≤y < p. Choose integers c and d with x + σ(δ) = cp + d(y + δ). Since
σ(δ) = Tr(δ) −δ, the equation is x + Tr(δ) −δ = cp + dy + dδ, and we obtain
x + Tr(δ) = cp + dy and −δ = dδ. Thus d = −1, x + Tr(δ) = cp −y, and
cp = x + y + Tr(δ). From 0 ≤x < p and 0 ≤y < p, we have 0 ≤x + y + Tr(δ) ≤
2(p −1) + Tr(δ) ≤2p −1. So c in the equation cp = x + y + Tr(δ) has to be 1
or 0, and the equation is x + y = p −Tr(δ) or x + y = −Tr(δ). The condition that
σ(I) = I is the condition that x = y, hence that 2x = p −Tr(δ) or 2x = −Tr(δ).
When D is odd, this says that x = 1
2(p −1); when D is even, it says that x = 0.
24. Since σ(⟨p, x + δ⟩) = ⟨p, x + σ(δ)⟩, the two factors are the same if and only
if σ(I) = I. Problem 23 says that the latter equality holds for D odd if and only if
x = 1
2(p −1) and that it holds for D even if and only if x = 0. In the two cases we
know from Problem 14 that p divides N(x + δ) = x2 + x Tr(δ) + N(δ).
When D is odd, this result says that p divides x2 + x + 1
4(1 −D), hence that it
divides 4x2 + 4x + (1 −D) = (2x + 1)2 −D. Then p divides D if and only if p
divides 2x + 1, if and only if x = 1
2(p −1).
When D is even, we know from Problem 14 that p divides x2 −m. Hence p
divides 4(x2 −m) = 4x2 −D = (2x)2 −D. Then p divides D if and only if p
divides 2x, if and only if x = 0.
25. Theorem 1.14 shows that the genus group G is the quotient of the abelian group
H modulo its subgroup of squares. The subgroup of squares consists of the elements

656
Hints for Solutions of Problems
in the product of the cyclic subgroups of orders 2k1−1, . . . , 2kr−1, ql1
1 , . . . , qlss , and the
quotient is the product of r copies of a cyclic group of order 2. Thus G has order 2r.
The subgroup of elements of H whose order divides 2 is the product of the 2-element
subgroups of the cyclic groups of orders 2k1, . . . , 2kr . It is a product of r copies of a
cyclic group of order 2 and hence is abstractly isomorphic to G.
26. If P is a nonzero prime ideal, then so is σ(P). Since σ 2 = 1, the mapping
P 	→σ(P) is a permutation of order 2 on the nonzero prime ideals. Evidently the
prime ideals of type (i) above are permuted in 2-cycles, and the prime ideals of types
(ii) and (iii) are left ﬁxed.
If a nonzero ideal I has prime factorization I = 
i Pki
i , then σ(I) = 
i σ(Pi)ki.
When σ(I) = I, we can match the factors and their exponents. We conclude that the
factorization of I is as
I =


pairs (Pi,σ(Pi))
of type (i)
(Piσ(Pi))ki


ideals Pi
of type (ii)
Pki
i


ideals Pi
of type (iii)
Pki
i

.
Each factor in the ﬁrst product is of the form (N(Pi))ki by Problem 19d, each factor
in the second product is of the form (p)ki for some prime p not dividing D, and each
P2
i contributing to the third factor is of the form (p) for some prime p dividing D.
The result follows.
27. For (a), the only nontrivial step in the displayed formula is the third equality,
which follows because xσ(x) = N(x) = 1 by hypothesis. If we take y = (1 + x)−1,
then the displayed formula gives x = (1 + x)(1 + σ(x))−1 = y−1σ(y) as required.
For (b), the equality σ(y)y−1 = x remains valid when y is replaced by ny with
n ∈Z, and thus we may take y to be in R. Now let y and z be in R with σ(z)z−1 =
x = σ(y)y−1. Then σ(zy−1) = zy−1, and zy−1 is in Q. Among all y ∈R with
σ(y)y−1 = x, let y0 be one with |N(y)| as small as possible; y0 exists because |N(y)|
is an integer in each case. If σ(z)z−1 = x, write z = u +vδ, y0 = a+bδ, and zy−1
0
=
p/q with GCD(p, q) = 1. Then qu + qvδ = qz = py0 = pa + pbδ, and we obtain
qu = pa and qv = pb. Therefore q divides a and b, and q−1y0 = q−1a + q−1bδ is
in R. Then y = q−1y0 is another element in R with σ(y)y−1 = x, and it contradicts
the minimal choice of |N(y0)| unless |q| = 1. We conclude that z = ±py0.
28. In (a), N(I 2) = N((x)) says that N(I)2 = |N(x)|N(R) = |N(x)|. Therefore
N(x−1N(I)) = |N(x)|−1N((N(I)) = |N(x)|−1N(I)2 = 1, and x N(I)−1 has
norm 1.
In (b), Problem 27b gives us y0 ∈R with σ(y0)y−1
0
= x N(I)−1. Then we
compute that σ((y0)I) = σ(y0)σ(I) = y0x N(I)−1σ(I) = y0N(I)−1(x)σ(I) =
y0N(I)−1I 2σ(I) = y0N(I)−1((N(I))I = y0I.
For (c), suppose N(y0) > 0. Then Problem 26a shows that (y0)I = (a)JS for
some a ∈Z, and this gives the required strict equivalence. If N(y0) < 0, then
N(y0
√m ) > 0, and σ((y0
√m )I) = (y0
√m )I; Problem 26a shows that (y0
√m )I
= (a)JS for some a ∈Z, and this gives the required strict equivalence.

Chapter I
657
29. For (a), since m < 0 and m is neither −1 nor −3, the possible units are
ε = ±1. The equality σ(x) = εx says that x is in Z if ε = +1, and it says that x is
in Z√m if ε = −1.
For (b), when m = −1 or m = −3, we have D = −4 or D = −3; thus
g = 0, and there is nothing to prove. For other values of m < 0, consider JS. Then
N(JS) = 
p∈S p, and this is some divisor D′ of D with no repeated factors. Let us
write JS = ⟨a, b + gδ⟩by Problem 15. Then ag = D′ and g divides a. Since D′ is
square free, a = D′ and g = 1. If JS is principal, then (a) shows that JS = (c) for an
integer c or JS = (d√m ) for an integer d.
Suppose JS = (c). Then b + δ = rc for some r ∈R. Write r = x + yδ for
integers x and y. Then b + δ = cx + cyδ shows that 1 = cy and hence that c divides
1. Thus JS = R, and the set S is empty.
Suppose JS = (d√m ). Then b+δ = dx√m +dyδ√m for some integers x and y.
If D is odd, then the equation reads b + 1
2(1 −√m ) = dx√m + dy 1
2(1 −√m )√m.
This implies that −1
2
√m = d(x + 1
2dy)√m, hence that −1 = d(2x + 1). Therefore
d = 1, JS = (√m ) = (
√
D ), N(JS) = |D|, and S = E. If D is even, then the
equation reads b −√m = dx√m −dym, and we obtain −1 = dx. So d = 1,
JS = (√m ), N(JS) = m = D/4 = D′. This is the product of all prime divisors of
D if D/4 ≡2 mod 4 and all of them but 2 if D/4 ≡3 mod 4.
For (c), let E′ be a subset of g members of E, and assume that the element of E
that is not in E′ is not 2 unless D = −4. If S and S′ are two subsets of E′, then
JS JS′ = (n)JT , where n = 
p∈S∩S′ p and T = (S −S′) ∪(S′ −S). If JS and JS′
represent the same genera, then JS JS′ is principal, and JT must be principal. The set
T can be empty only if S = S′, and it has to be a subset of E′ and thus cannot be all of
E. According to (b), the only way that JT can be principal is thus that S = S′ or that
all of the conditions D even, D/4 ≡2 mod 4, and T = E′ = E −{2} are satisﬁed.
In the latter case the construction of E′ shows that D = −4, T is empty, and S = S′.
Thus the ideals JS for S ⊆E′ represent distinct genera in every case.
For (d), the roots of unity are ±εk
1. Since N(ε1) = −1, the roots of unity of norm 1
are the ±ε2n
1 . So suppose that ε = ±ε2n
1 . Put ε0 = εn
1. Then ε0σ(ε0) = N(ε0) =
(−1)n, and σ(εn
1x) = σ(ε0)σ(x) = σ(ε0)εx = (−1)nε−1
0 εx = ±(−1)nε−n
1 ε2n
1 x =
±(−1)nεn
1x = sεn
1x with s = ±(−1)n. If s = +1, then εn
1x is in Z, while if s = −1,
then εn
1x is in Z√m. Then the same steps as in (b) and (c) ﬁnish the argument.
For (e), the four mentioned ideals are principal, and we have (1) = JS for S
empty and (√m ) = JS for S equal to the set of prime divisors of m. For these two
ideals, N(1) > 0 and N(√m ) < 0. Consider (y+
0 ) and (y−
0 ). The ideal (y+
0 ) has
σ((y+
0 )) = (σ(y+
0 )) = (y+
0 ε1) = (y+
0 ), and hence it is of the form (n)JS for some S.
Then y+
0 = nr for some r ∈R, and it follows that n−1y+
0 is in R. This contradicts
the minimality of |N(y+
0 )| unless |n| = 1. Hence (y+
0 ) = JS for some S. Similarly
(y−
0 ) = JS for some S. Thus all four principal ideals are of the form JS.
Let us see that the four principal ideals are distinct. Neither ideal (y+
0 ) nor (y−
0 )
can equal (1). In fact, if (y+
0 ) were to equal (1), then y+
0 would be a unit ε, and we

658
Hints for Solutions of Problems
would have ε1 = σ(y+
0 )(y+
0 )−1 = σ(ε)ε−1 = ε−2, in contradiction to the fact that ε1
is fundamental. Similarly (y−
0 ) cannot equal (1).
Since σ(y+
0
√m )(y+
0
√m )−1 = −σ(y+
0 )√m (y+
0 )−1(√m )−1 = −σ(y+
0 )(y+
0 )−1
= −ε1, the deﬁnition of y−
0 shows that y+
0
√m = ny−
0 for some integer n. Passing
to norms gives −mN(y+
0 ) = n2N(y−
0 ). Therefore N(y+
0 ) and N(y−
0 ) have opposite
sign.
We have seen that two of the four elements 1, y+
0 , y−
0 , √m have positive norm,
two have negative norm, and the two of positive norm generate distinct principal
ideals. To see that the two of negative norm generate distinct ideals, we consider
separately the cases N(y−
0 ) < 0 and N(y+
0 ) < 0. If N(y−
0 ) < 0, we use the equation
−mN(y+
0 ) = n2N(y−
0 ) proved in the previous paragraph. If (y−
0 ) = (√m ), then
cancellation gives N(y+
0 ) = +1; then y+
0 is a unit, and we have seen that it cannot
be. If N(y+
0 ) < 0, we use the deﬁnition of y+
0 in the same way as in the previous
paragraph to obtain −mN(y−
0 ) = n2N(y+
0 ) for some integer n. Cancellation shows
that N(y−
0 ) = +1; then y−
0 is a unit, and we have seen that it cannot be. Thus the
four principal ideals are distinct.
Now suppose that (x) is any principal ideal ﬁxed by σ. As in the statement of the
problem, we have σ(x) = εx for some unit ε. The most general unit is of the form
ε = ±εn
1. We shall produce constructively the element of Problem 27 corresponding
to ε. Put y0,n = εn/2
1
if n is even and y0,n = ε(n+1)/2
1
y0 if n is odd. For n even we
have
σ(y0,nx) = σ(y0,n)εx = ±σ(εn/2
1 )εn
1x = ±ε−n/2
1
εn
1x = ±y0,nx,
and for n odd we have
σ(y0,nx) = σ(y0,n)εx = ±σ(ε(n+1)/2
1
y0)εn
1x = ±ε−(n+1)/2
1
σ(y0)εn
1x
= ±ε(n−1)/2
1
σ(y0)x = ±ε(n−1)/2
1
y0ε1x = ±y0,nx.
Thus σ(y0,nx) = ±y0,nx for all n. Therefore y0,nx is in Z or in Z√m, depending
on the sign ±. Depending on the sign, |N(y0,nx)| = |N(y0,n)||N(x)| thus is either
the square of an integer or m times the square of an integer.
If n is even, then
|N(y0,n)| = 1, and |N(x)| is therefore either the square of an integer or m times the
square of an integer. Since |N(x)| is the value of the norm of (x), there are only two
possible S’s for which this can happen. If n is odd, then |N(y0,n)| = a for a certain
square-free integer > 1, as we have seen. Therefore |N(x)| has to be either a−1 times
the square of an integer or ma−1 times the square of an integer. So there are only two
possible S’s in this case. Thus there are only four possible S’s in all cases, and these
have been accounted for. So the number of principal ideals among the JS’s is exactly
four. To complete the proof, we now argue as in (c) but consider only possibilities
for which the product of two JS’s is n2 times one of the two JS’s given by a principal
ideal with a generator of positive norm.
30. Since D is fundamental, (a1, b1, c1) is automatically primitive. Then Lemma
1.10 produces a properly equivalent form that represents some integer a relatively

Chapter I
659
prime to D. The rest follows from the argument in the second paragraph of the proof
of sufﬁciency in Theorem 6b.
31. For (a), choose an integer r such that b + 2ar = kD for some integer k; this is
possible because GCD(D, 2a) = 1. Then the translation x = x′ + ry′, y = y′ leads
from ax2+bxy+cy2 to ax′2+kDx′y′+c′y′2 for some c′. The discriminant of the new
form is still D = k2D2 −4ac′, and thus 4ac′ ≡0 mod D. Since GCD(4a, D) = 1,
c′ ≡0 mod D.
For (b), b has to be even because D = b2 −4ac is even. Write b = 2¯b. Choose an
integer s such that ¯b+as = kD for some k; this is possible because GCD(a, D) = 1.
Then the translation x = x′ + sy′, y = y′ leads from ax2 + bxy + cy2 to
ax′2 + 2kDx′y′ + c′y′2 for some c′. The discriminant of the new form is D =
4k2D2 −4ac′, where c′ = (4a)−1D(4k2D −1) = a−1(D/4)(4k2D −1). Modulo
D, this expression is −¯a(D/4), where ¯a is an integer with ¯aa ≡1 mod D. Here
a is odd, and hence a2 ≡1 mod 8.
If 2u is the exact power of 2 dividing D,
then ¯aa ≡1 mod 2u, and hence ¯a ≡a mod 2u. If p is any odd prime dividing
D, then p divides D/4, and hence ¯a(D/4) ≡0 ≡a(D/4) mod p.
Therefore
¯a(D/4) ≡a(D/4) mod D, and we conclude that c′ ≡−a(D/4) mod D.
32. For (a), clearing fractions in the expression ax2 + kDxy + lDy2 = r yields
au2+kDuv+lDv2 = rw2. Suppose a prime p divides GCD(w, D). Then p divides
au2. Since GCD(a, D) = 1, p divides u. Referring back to the equation, we see that
p2 divides au2 and kDuv, hence divides lDv2. Thus p divides lv2. The discriminant
is D = k2D2 −4alD, and divisibility of l by p would force p2 to divide the left side
D. Hence p does not divide l, and p must divide v. Then p divides both u and v,
in contradiction to the minimality of the common denominator w. We conclude that
GCD(w, D) = 1. Taking the equation au2 + kDuv + lDv2 = rw2 modulo D gives
au2 ≡rw2 mod D. Since r and w are relatively prime to D, so is u. Thus we can
rewrite this congruence as a ≡d2r mod D for some integer d relatively prime to D.
For (b), the same argument gives a′ ≡d′2r mod D. Since d is relatively prime to
D, we can rewrite the congruence for a as r ≡d−2a mod D, and then a′ ≡d′2r ≡
(d−1d′)2a mod D.
For (c), the given forms are properly equivalent over Z to (a, kD,lD) and to
(a′, k′D,l′D), respectively, by Problem 31a. Proper equivalence over Q means that
the two forms take on the same rational values, one of which is the integer a′. Part
(b) therefore shows that a′ = as2 + nD for some integers s and n, necessarily with
GCD(s, D) = 1. Modulo D, the forms are given by ax2 and a′x′2, and the ﬁrst
can be transformed into the second by the substitution x = sx′, y = s−1y′, where
s−1 is the multiplicative inverse of s in Z/DZ. In fact, substitution into ax2 gives
a(sx′)2 = (as2)x′2 ≡a′x′2 mod D. This substitution is given by the matrix

s
0
0 s−1

in SL(2, Z/DZ).
33.
Part (a) is almost the same as Problem 32a.
Clearing fractions leads to
au2 + kDuv + (lD −a(D/4))v2 = rw2, and the argument that no odd prime p
divides GCD(w, D) is the same. Suppose that 2 divides w. The equation modulo 4

660
Hints for Solutions of Problems
is then au2 −a(D/4)v2 ≡0 mod 4 with D/4 congruent to 2 or 3 modulo 4. Since
2 divides w, at least one of u and v must be odd. If D/4 ≡3 mod 4, the congruence
becomes a(u2 + v2) ≡0 mod 4, which is impossible with at least one of u and v
odd. If D/4 ≡2 mod 4, the congruence becomes a(u2 + 2v2) ≡0 mod 4, which
again is impossible with at least one of u and v odd. Thus GCD(w, D) = 1. Taking
the equation modulo D and using the invertibility of r and w modulo D, we have
ar−1w−2(u2 −(D/4)v2) ≡1 mod D.
For (b), let p be an odd prime divisor of D. The above congruence then becomes
ar−1w−2u2 ≡1 mod p. Similarly with the second form, there is some w′ prime to
D such that a′r−1w′−2u′2 ≡1 mod p. Comparing the two expressions, we see that
a modulo p is the product of a′ and an invertible square.
For (c), the above congruence becomes ar−1w−2(u2+v2) ≡1 mod 4. This forces
u2 + v2 ≡1 mod 4. Since w has to be odd, w2 ≡1 mod 4. Hence ar−1 ≡1 mod 4.
Similarly a′r−1 ≡1 mod 4, and therefore a ≡a′ mod 4.
For (d), the above congruence becomes ar−1(u2 −(D/4)v2) ≡1 mod 8, since w
is odd. If D/4 ≡2 mod 8, we obtain ar−1(u2 −2v2) ≡1 mod 8. Here u has to be
odd, and thus ar−1(1 −2v2) ≡1 mod 8. If v is even, this says that a ≡r mod 8; if
v is odd, it says that a ≡−r mod 8. Putting this conclusion together with a similar
conclusion about the second form, we obtain a′ ≡±a mod 8.
If D/4 ≡6 mod 8, we obtain ar−1(u2 + 2v2) ≡1 mod 8. Here u has to be odd,
and thus ar−1(1 + 2v2) ≡1 mod 8. If v is even, this says that a ≡r mod 8; if v
is odd, it says that a ≡3r mod 8. Putting this conclusion together with a similar
conclusion about the second form, we obtain a′ ≡a mod 8 or a′ ≡3a mod 8.
For (e), we shall assemble a member of SL(2, Z/DZ) one prime at a time and
use the Chinese Remainder Theorem. For odd primes p dividing D, choose sp with
a′ ≡s2
pa mod p, and introduce the matrix Mp =
 sp
0
0 s−1
p

in SL(2, Z/pZ). If D/4 ≡
3 mod 4, introduce the matrix M2 =

1 0
0 1

in SL(2, Z/4Z). If D/4 ≡2 mod 4, let
M2 =

1 6
1 7

in SL(2, Z/8Z) if D/4 ≡6 mod 8, and let M2 =

1 2
1 3

in SL(2, Z/8Z)
if D/4 ≡2 mod 8. The Chinese Remainder Theorem produces a unique matrix with
entries in Z/DZ that is congruent to Mp modulo each odd prime divisor of D and is
congruent to M2 modulo the power of 2 dividing D. Call this matrix M =
 α β
γ δ

.
It has determinant 1 modulo D and hence lies in SL(2, Z/DZ). Then substitution of
x = αx′ + βy′ and y = γ x′ + δy′ into the form a(x2 −(D/4)y2) modulo D leads
to the form a′(x2 −(D/4)y2) modulo D.
34. These problems establish a function from the set of equivalence classes of
binary quadratic forms over Z with discriminant D, the equivalence relation being
proper equivalence over Q, onto the set of equivalence classes of binary quadratic
forms over Z with discriminant D, the equivalence relation being proper equivalence
over Z/DZ. The number of elements in the domain has to be ≥the number of
elements in the range.

Chapter I
661
35. The steps in solving Problems 32 and 33 involve relating a to r modulo
each prime power dividing D. These relationships are the same as the relationships
between a and r′ if the form modulo D represents r′ and GCD(r′, D) = 1, and the
relationships are transitive. Thus the genus characters take the same values at r as
they do at r′, and they take the same values at a as well.
36. Multiplication is the operation on proper equivalence classes of forms that
corresponds to composition of aligned representatives of the classes, and composition
is deﬁned in such a way that the set of values of the composition is the set of products
of a value of one form by a value of the other. The values are unaffected by proper
equivalence over Z.
37. For (a), D/4 has an odd number 2t + 1 of prime factors 4k + 3. Use of the
Jacobi symbol with a odd and p varying over the prime divisors of D/4 gives

p
a
p

=

p=4k+1
a
p


p=4k+3
a
p

= ξ(a)2t+1

p=4k+1
p
a


p=4k+3
p
a

= ξ(a)
D/4
a

.
Therefore
ξ(a) 
p
a
p

=
D/4
a

=
2
a
2D/4
a

=
D
a

.
For (b) and (c), say that the number of prime factors 4k + 3 of D/8 is t. With
p varying over the odd prime divisors of D, the same computation as above gives

p
a
p

= ξ(a)tD/8
a

. Then
D
a

=
2
a
D/8
a

= η(a)ξ(a)t 
p
a
p

. One easily checks
that t is even if D/4 ≡2 mod 8 and is odd if D/4 ≡6 mod 8, and the result follows.
38. For each odd prime divisor p of D, choose a residue rp modulo p such that
rp
p

= sp. If D is even, choose an odd residue r2 modulo 8 such that α(r2) = s2.
The Chinese Remainder Theorem produces an integer b prime to D such that b ≡
rp mod p for the odd p’s and b ≡r2 mod 8. For this integer b and every k ≥0, we
have
b+kD
p

= rp for each odd p and α(b + kD) = s2. Dirichlet’s Theorem says
that b + kD is a prime q for a suitable choice of k, and this prime q has the required
properties.
39. Problem 37 showed that the product of the genus characters for an odd integer
a such that GCD(a, D) = 1 is
D
a

. Using the genus characters at a = q, we see
that
D
q

= 1. Theorem 1.6b shows that q is primitively representable by some form
(q, b, c) of discriminant D. The values of the genus characters for this form are
their values on q, and we have arranged that these values are the various numbers
sp. Since there are g + 1 genus characters and the ﬁrst g of them can be speciﬁed
arbitrarily and still give a similarity class modulo D, there are at least 2g similarity
classes modulo D.
40. Problem 29 shows that the number of classes of type (i) is exactly 2g. Problems
30–33 show that equivalence of type (i) implies equivalence of type (ii), and they
therefore give a mapping of the set of classes of type (i) onto the set of classes of

662
Hints for Solutions of Problems
type (ii). The deﬁnition of “similar modulo D” immediately implies that equivalence
of type (ii) implies equivalence of type (iii), and therefore we obtain a mapping of
the set of classes of type (ii) onto the set of classes of type (iii). Finally Problem 39
shows that there are at least 2g classes of type (iii). The result follows.
Chapter II
1. The unital left CG modules correspond (via the universal mapping property of
a group algebra) to representations of G on complex vector spaces. The theory in
Chapter VII of Basic Algebra shows that every representation splits as the direct sum
of irreducible representations, which correspond to simple left CG modules. Hence
every unital left CG module is semisimple. The left regular representation of G,
which corresponds to the left CG module CG, decomposes as the sum of irreducible
representations, each irreducible representation occurring as many times as its degree.
The sum of all the irreducible subspaces of a given isomorphism type gives one of
the factors Mn(C) of CG, and every factor arises this way.
2. For (a), rad A = (C + CX)(X2 + 1), and S will be the sum of two copies
of C. Finding S requires some computation. We can identify A/(rad A) with the
quotient C[X]/(X2 + 1), and direct computation shows that the two idempotents in
this notation having sum 1 are 1
2i (X + i) and −1
2i (X −i). The proof of Proposition
2.23 shows how to lift these to idempotents in A. For the ﬁrst one, put a = 1
2i (X +i)
and b = 1 −a = −1
2i (X −i), and observe that (ab)2 = 0.
The proposition
gives the formula e = 	2
k=0
4
k

a4−kbk = a4 + 4a3b, the term for k = 2 being 0.
Then e = a3(a + 4b) =
1
16(X + i)3(−3X + 5i). So one contribution to S comes
from Ce; the other will come from the complex conjugate in the form of C f , where
f = 1
16(X −i)3(−3X −5i).
We can check directly that e is an idempotent. In fact,
e2 −e = e
 1
16(X + i)3(−3X + 5i) −1

.
The polynomial in square brackets vanishes at X = i, and so does its derivative.
Thus the polynomial is divisible by (X −i)2, and e2 −e = (X + i)3(−3X + 5i)×
[(X −i)2Q(X)] is divisible by (X2 + 1)2.
For (b), the answer is yes. This problem anticipates Problem 5 below. The algebra
S is spanned linearly by its idempotents, and Problem 5 shows that the idempotents
are determined uniquely in the commutative case.
For (c), rad A = (R + RX)(X2 + 1). Call the subalgebra S0. This subalgebra will
be a 2-dimensional real subalgebra isomorphic to C. To ﬁnd it, we can go through
the proof of Theorem 2.17 or we can use the Galois group. The latter method is a
good bit easier. Thus we seek those members of S as in (a) that are ﬁxed by complex
conjugation. Since S = Ce + C¯e, the result is that S0 = R(e + ¯e) + iR(e −¯e). This

Chapter II
663
is unique; in fact, any choice of S0 has the property that S0 ⊗R C is an S for (a), and
we know that the S for (a) is unique.
3. Since rad A is a nilpotent ideal of A, (rad A) ⊗F B is a nilpotent ideal of
A ⊗F B, and therefore (rad A) ⊗F B ⊆rad(A ⊗F B). For the reverse inclusion
Proposition 2.31 shows that rad(A ⊗F B) = I ⊗F B for some two-sided ideal of A.
If (rad(A ⊗F B))n = 0 and a1, . . . , an are in I, then (a1 ⊗1) · · · (an ⊗1) must be 0,
and hence a1 · · · an = 0. Therefore I ⊆rad A, and rad(A ⊗F B) ⊆(rad A) ⊗F B.
4. For (a), suppose on the contrary that there is an inﬁnite sequence M1, M2, . . .
of distinct maximal ideals. Then we obtain a decreasing sequence of ideals R ⊇
M1 ⊇M1M2 ⊇M1M2M3 ⊇· · · , and the Artinian property shows that M1 · · · Mn =
M1 · · · MnMn+1 for some n. Since Mn+1 is prime and Mn+1 ⊇M1 · · · Mn, Mn+1
contains Mj for some j with 1 ≤j ≤n. By maximality, Mn = Mj, and we have a
contradiction.
In (b), every element of rad R is nilpotent because rad R is nilpotent. Conversely
if x ∈R is nilpotent with xn = 0, then Rx is nilpotent with (Rx)n = 0, since
a1xa2x · · · anx = a1a2 · · · anxn = 0 for any a1, . . . , an ∈R. Thus Rx ⊆rad R, and
the nilpotent element x lies in rad R. This proves (b), and (c) follows because R is
semisimple if and only if rad R = 0.
For (d), R semisimple implies that R is a product of full matrix rings over division
rings. Commutativity implies that the matrices are all of size 1-by-1 and the division
rings are all ﬁelds.
5. If e′ is a second representative, then e′ = e + r with r ∈rad R. If n is an odd
integer large enough to have rn = 0, then
0 = rn = (e′ −e)n =
n	
k=0
(−1)kn
k

(e′)n−kek = e′ +
n−1
	
k=1
(−1)kn
k

e′e −e
= e′ +

n	
k=0
(−1)kn
k

e′e −e′e + e′e −e = e′ + 0 −e′e + e′e −e = e′ −e.
6. Let M1, . . . , Mn be the ﬁnitely many maximal ideals, and put N = M1 · · · Mn.
Nakayama’s Lemma says that if I is any ideal contained in all maximal ideals, then
the only ﬁnitely generated unital R module M having the property that I M = M is
M = 0. The Artinian property shows that N k+1 = N k for some k. We take I = N
and M = N k in Nakayama’s Lemma. The R module M is ﬁnitely generated because
Artinian implies Noetherian (Theorem 2.15), and hence Nakayama’s Lemma shows
that N k = 0.
7. Let the maximal ideals be M1, . . . , Mn, and let (M1 · · · Mn)k = 0. If P is a
prime ideal, then P ⊇0 = (M1 · · · Mn)k. Since P is prime, P contains one of the
factors. Thus P ⊇Mj for some j.
8. It helps to have a multiplication table available. If the rows index a factor on
the left and the columns index a factor on the right, then the resulting products are
given by
 R M 0
0 0 M
0 0
S

.

664
Hints for Solutions of Problems
If I2 is a left ideal of S and I1 is a left R submodule of R ⊕M containing M I2,
then RI2 = 0, M I2 ⊆I1, and SI2 ⊆I2. Also, RI1 ⊆I1, M I1 = 0, and SI1 = 0.
Thus AI1 ⊆I1 and AI2 ⊆I1 ⊕I2. Consequently I1 ⊕I2 is a left ideal of A.
In the reverse direction if J is a left ideal in A, then I1 =

1 0
0 0

J ⊆R ⊕M
and I2 =

0 0
0 1

J ⊆S are such that J = I1 ⊕I2. Also, r ∈R implies

r 0
0 0
 
1 0
0 0

J
=

1 0
0 0

r J ⊆I1, while (M ⊕S)I1 = 0; and s ∈S implies

0 0
0 s
 
0 0
0 1

J =

0 0
0 1

s J ⊆I2, while RI2 = 0 and m ∈M implies

0 m
0 0
 
0 0
0 1

J =

0 m
0 0

J ⊆

1 0
0 0
 
0 m
0 0

J ⊆

1 0
0 0

J = I1.
9. For (a), suppose A is left Noetherian. The table produced in the solution of
Problem 8 shows that M ⊕S and R ⊕M are two-sided ideals of A, and the respective
quotient rings are R and S. As quotients of a left Noetherian ring, R and S have to be
left Noetherian. If {Mi} is an ascending chain of R submodules of M, then
(
0 Mi
0 0
)
is an ascending chain of left ideals of A, by Problem 8. The latter must be constant
from some point on, and then the same thing is true for {Mi}.
Conversely suppose that R and S are left Noetherian and that the left R module M
satisﬁes the ascending chain condition. If {Ji} is an ascending chain of left ideals of A,
then the corresponding sequence {(I2)i} is an ascending chain of left ideals in S, and
{(I1)i} is an ascending chain of left R submodules of R ⊕M containing M I2. Since
S is left Noetherian, {(I2)i} is constant from some point on. Since R = (R ⊕M)/M
and M satisfy the ascending chain condition for their left R submodules, so does
R ⊕M, and therefore {(I1)i} is constant from some point on.
10. In view of Problem 9a, showing that A is left Noetherian amounts to showing
that R and S are (left) Noetherian and M satisﬁes the ascending chain condition for
its left R submodules. The ring S is Noetherian by assumption, and R is a ﬁeld,
hence is Noetherian. The action of R on M is the action of a ﬁeld on itself, and the
R submodules are trivial. In view of Problem 9b, A fails to be right Noetherian if the
ascending chain condition fails for the right S submodules of M = R. If the ascending
chain condition were to hold, then R would be a ﬁnitely generated S module, and
the only denominators needed for members of the full ﬁeld R of fractions would be
those dividing the product of the denominators of the generators; these fractions are
already in S, and hence S would equal R, contradiction.
The analogs of the results of Problem 9 for the Artinian case show that A fails to
be either left or right Artinian if S is not Artinian. If s is a nonunit in S, then the
chain of principal ideals {(sk)} is properly descending, since (sk) = (sk+1) implies
εsk = sk+1 for some unit ε and since the hypothesis that S is an integral domain
allows us to cancel and obtain ε = s, contradiction.
11. Since R and S are ﬁelds, they are left and right Noetherian and Artinian. In
view of Problem 9, we are to show that M = R satisﬁes both chain conditions for
its left R modules and neither chain condition for its right S modules. Since R is a

Chapter II
665
ﬁeld, M = R has only trivial R submodules and satisﬁes both chain conditions. For
the S action on R, we are to examine the S vector subspaces of S. Since dimS R
is inﬁnite, there exist both a properly increasing sequence of such subspaces and a
properly decreasing one. Hence neither chain condition is satisﬁed.
12. For (a), the vector-space dimension over F is certainly 4, and computation
shows that A is closed under products. The choices a = 1 and b = 0 show that A
has an identity.
For (b), let x ̸= 0 be in a two-sided ideal I. If x =

a
0
0 σ(a)

, then x is invertible,
and hence I = A. Otherwise suppose that some matrix x =

a
b
rσ(b) σ(a)

with b ̸= 0
is in I. With c as in the statement of the problem, cx −xc =

0
2b√m
−2rσ(b)√m
0

is in
I; this matrix is invertible since b ̸= 0, and thus I = A.
To see that A is central, let x be in the center. The computation 0 = cx −xc shows
that b = 0. Thus x is of the form

a
0
0 σ(a)

. Such an x does not commute with

0 1
r 0

unless a = σ(a), in which case x is in F.
13. The determinant is aσ(a) −rbσ(b) = NK/F(a) −r NK/F(b) and equals 0
for a given r if and only if some pair (a, b) ̸= (0, 0) has NK/F(a) = r NK/F(b).
Since r ̸= 0, both a and b are nonzero, and this equality then holds if and only if
r = NK/F(ab−1).
In other words, some nonzero member of A has determinant 0 if r is a norm, and
then A cannot be a division algebra. Conversely if r is not a norm, then every nonzero
member of A is invertible as a matrix. Computation of the inverse matrix shows that
it has the correct form to be in A. Hence A is a division algebra.
When A is not a division algebra, it is anyway ﬁnite-dimensional and central simple
and has to be of the form Mn(D) for some n and some division algebra D over F
such that dim Mn(D) = 4. The dimensional formula says that n2 dimF D = 4. Since
n ̸= 1, we must have n = 2 and D = F.
14. Theisomorphismfollowsfromthecomputation

c 0
0 1
 
a
b
rσ(b) σ(a)
 
c 0
0 1
−1
=

a
bc
rc−1σ(b) σ(a)

=

a
bc
r′σ(c)σ(b) σ(a)

=

a
bc
r′σ(bc) σ(a)

.
15. Direct computation.
16. If K is a maximal subﬁeld, then dimF K = 2. Since the characteristic is not 2,
K = F(√m ) for some nonsquare m ∈F. Deﬁne i ∈K be to √m.
The map f : K →D given by f (a + bi) = a −bi is an algebra homomorphism
into the central simple algebra D. So the Skolem–Noether Theorem produces j ∈D
with j(a + bi) j−1 = a −bi for all a + bi in K, necessarily with j invertible.
As in the proof of Theorem 2.50, j2 = r lies in F. Deﬁne k = i j. Then k2 =
i ji j = i( ji j−1) j2 = i(−i) j2 = −rm, and −rm = k2 = i jk implies that k =
−rm( j−1)(i−1) = −rm(r−1 j)(m−1i) = −ji.
Let us check the multiplication table for {1, i, j, k}. We know that i2 = m, j2 = r,

666
Hints for Solutions of Problems
k2 = −rm, i j = k, and ji = −k. In addition, we have
jk = ji j = ( ji j−1) j2 = (−i)r = −ri,
kj = i j j = i( j2) = ri,
ki = i ji = i( ji j−1) j = i(−i) j = −mj,
ik = ii j = (i2) j = mj.
Hence the F linear map ϕ from A into the given central simple algebra is an algebra
homomorphism sending 1 into 1. Since A is simple, ϕ is one-one. Since A and the
given algebra both have dimension 4, ϕ is onto. Thus ϕ is an algebra isomorphism.
(We did not have to check directly that {1, i, j, k} is linearly independent over F.)
17. A is an algebra by routinely checking that it is closed under multiplication.
Manifestly A has an identity and has dimension 9 over F. If I is a nonzero two-sided
ideal in A, let x = a +bj +cj2 be nonzero in I, and assume that x is chosen in I such
that as few of the coefﬁcients a, b, c are nonzero as possible. Possibly by multiplying
x by j or j2 on the right, we may assume that a ̸= 0. Choose d ∈K with d, σ(d), and
σ 2(d) distinct. Computation shows that dx −xd has one fewer nonzero coefﬁcient.
By minimality we must have dx −xd = 0; hence x must have had just one nonzero
coefﬁcient. Such an x is invertible, and thus 1 is in I and I = A. Hence A is simple.
To see that A has just F as center, we test a general element x = a + bj + cj2 for
commutativity with both d ∈K and the element j, and we ﬁnd that b = c = 0 and
a = σ(a) = σ 2(a).
18. Since A is ﬁnite-dimensional central simple, A ∼= Mn(D) for some n and
some central division algebra D over F. Then 9 = dim A = n2 dimF D, and the only
possibilities are that n = 3 and D = F, or that n = 1. In the ﬁrst case, A ∼= M3(F),
and in the second case, A is a division algebra. In the ﬁrst case any column of A
(when viewed as M3(F)) is a 3-dimensional left A module; in the second case A has
no proper nonzero left A modules.
19. Left multiplication by K makes A into a K vector space, and the left K
submodules of A are the K vector subspaces. The F dimension of such a subspace
is 3 times the F dimension. Hence the left K submodules of A are the subspaces of
K dimension 1, which consist of all left K multiples of any nonzero vector.
Let x = a0+b0 j +c0 j2 be nonzero in A. Then K x is a left A module if and only if
jx lies in K x. Here jx = σ(a0) j+σ(b0) j2+σ(c0) j3 = rσ(c0)+σ(a0) j+σ(b0) j2.
This equals dx for some d ∈K if and only if
rσ(c0) = da0,
σ(a0) = db0,
and
σ(b0) = dc0.
(∗)
Combining the second and third equations givesthe necessary condition thatσ 2(a0) =
σ(db0) = σ(d)σ(b0) = σ(d)dc0. Applying σ gives the necessary condition a0 =
σ 3(a0) = σ(σ(d)dc0) = σ 2(d)σ(d)σ(c0) = σ 2(d)σ(d)r−1da0 = NK/F(d)r−1a0.

Chapter III
667
Thus it is necessary that some d ∈K have NK/F(d) = r. Conversely if d ∈K has
NK/F(d) = r, then x0 = 1 + d−1 j + d−1σ(d)−1 j2 has a0 = 1, b0 = d−1, and
c0 = d−1σ(d)−1, and we observe that the conditions (∗) are satisﬁed; thus K x0 is a
left A submodule.
Chapter III
1. For (a), deﬁne f : A × K →EndBo A by f (a, c)(a′) = aa′c just as in the
proof of Theorem 3.3. The veriﬁcation that the action of right multiplication byb ∈B
commutes with f (a, c), i.e., that f (a, c) is in EndBo A, uses that B commutes with
K, and the veriﬁcation that the extended map f : A ⊗F K →EndBo A respects
multiplication uses that K is commutative; otherwise the argument is the same as
with Theorem 3.3. The algebra A ⊗F K is central simple over K, and B is an algebra
over K because B contains K. Since A ⊗F K is simple, f is one-one.
For (b), let V be the unique-up-to-isomorphism simple ﬁnite-dimensional left B
module. If the left B module B is the direct sum of m copies of V , then the proof
of Theorem 2.2 shows that Bo ∼= EndB B ∼= Mm(Do), where Do is the central
division algebra over K given by Do = EndB V .
Hence B ∼= Mm(D).
If V o
denotes the unique-up-to-isomorphism simple ﬁnite-dimensional left Bo module and
if D′o = EndBo(V o), then we have B ∼= EndBo(Bo) ∼= Mm′(D′o), and it follows that
m = m′ and D′ ∼= Do.
Since B ⊆A, A is a right B module, hence a left Bo module, and A has to
be the direct sum of some number n of copies of V o. Then the same argument
gives an isomorphism EndBo A ∼= Mn(D′o) ∼= Mn(D). The Double Centralizer
Theorem gives dimF A = (dimF B)(dimF K), and thus dimK A = dimF B =
(dimF K)(dimK B) = (dimF K)(m dimK V ).
Meanwhile, dimK A = n dimK V
and thus n dimK V = (dimF K)(m dimK V ). So n = m dimF K. Consequently
dimF EndBo A = n2 dimF D = m2(dimF D)(dimF K)2 = (dimF B)(dimF K)2 =
(dimF A)(dimF K) = dimF(A ⊗F K), and the map f in (a) is onto.
For (c), application of (b) and an isomorphism from above gives A ⊗F K ∼=
EndBo(A) ∼= Mn(D), and we have seen that B ∼= Mm(D). Thus A ⊗F K and B lie
in the same Brauer equivalence class in B(K).
2. Take the product over σ of the equality ρ(a(σ, τ))a(ρ, στ) = a(ρ, σ)a(ρσ, τ),
and get ρ
 
σ a(σ, τ)
 
σ a(ρ, σ) = 
σ a(ρ, σ) 
σ a(σ, τ).
Canceling gives
ρ
 
σ a(σ, τ)

= 
σ a(σ, τ). Thus 
σ a(σ, τ) is ﬁxed by every member of the
Galois group and is in F×.
3.
Proposition 3.32 and Theorem 3.31 show that H2k(Gal(K/F), K ×) ∼=
H2(Gal(K/F), K ×) for k ≥1 and H2k+1(Gal(K/F), K ×) ∼= H1(Gal(K/F), K ×)
for k ≥0. Then Corollary 3.34 gives H2k ∼= F×
NK/F(K ×) for all k ≥1, and
Theorem 3.17 gives H2k+1 = 0 for all k ≥0. Finally H0 is the subgroup of elements
in K × ﬁxed by Gal(K/F), and this is F×.

668
Hints for Solutions of Problems
4. For (a), it is shown in Chapter IX of Basic Algebra that Q(e2πi/p) is a Galois
extension of Q with cyclic Galois group of order p −1 whenever p is prime. Here
p = 7. Complex conjugation is a member of the Galois group of order 2, and K is the
subﬁeld ﬁxed by this subgroup. Hence K has degree 6/2 = 3 over Q, and its Galois
group is the quotient of a cyclic group of order 6 by the subgroup of order 2, hence is
cyclic of order 3. The powers ζ 1, . . . , ζ 6 form a basis of the Q vector space Q(ζ), and
the sums of them with their images under complex conjugation span K. These sums
are τ1, τ2, τ3. Since there are only 3 such sums, they must be linearly independent
over Q. Put τk = ζ k + ζ −k. Then τk depends only on k mod 7, and τk = τ−k.
Hence the only τk’s that are not any of τ1, τ2, τ3 are the ones with k ≡0 mod 7. The
members of the Galois group of Q(ζ) carry ζ to ζ k for 1 ≤k ≤6 and therefore carry
τ1 to τk, τ2 to τ2k, and τ3 to τ3k. None of k, 2k, 3k is divisible by 7, and the result
follows.
For (b), let σ ∈Gal(K/Q) have σ(τ1) = τ2, σ(τ2) = τ3, and σ(τ3) = τ1. For
x ∈K, we have NK/Q(x) = xσ(x)σ 2(x). With x = aτ1 + bτ2 + τ3, we get 27 terms
when everything is expanded out, and they are the ones listed.
For (c), τ1 + τ2 + τ3 = −1 because 	3
j=−3 ζ j = 0. Next, τ1τ2 = (ζ 1 + ζ −1)×
(ζ 2 + ζ −2) = ζ 3 + ζ −3 + ζ −1 + ζ 1 = τ1 + τ3, and the other two identities on the
second line are similar. Finally τ 2
1 = (ζ 1 + ζ −1)2 = ζ 2 + 2 + ζ −2 = τ2 + 2, and the
other two identities are similar.
For (d), let α, β, γ, δ be the expressions involving τ1, τ2, τ3 on the right side in
(b). First we have τ 3
1 = τ 2
1 τ1 = (τ2 + 2)τ1 = τ1τ2 + 2τ1 = 3τ1 + τ3. Summing this
expression and similar expressions for τ 3
2 and τ 3
3 gives α = 4(τ1 + τ2 + τ3) = −4.
Second β = τ1τ2τ3 = (τ1 + τ3)τ3 = τ2 + τ3 + τ1 + 2 = 1. In (d), the coefﬁcient
of abc is α + 3β = −4 + 3 = −1, and the coefﬁcient of a3 + b3 + c3 is β = 1.
Third τ 2
1 τ2 = τ1(τ1 + τ3) = (τ2 + 2) + (τ2 + τ3) = τ3 + 2τ2 + 2. Similarly
τ 2
2 τ3 = τ1+2τ3+2 and τ 2
3 τ1 = τ2+2τ1+2. The sum is γ = 3(τ1+τ2+τ3)+6 = 3.
Fourth τ1τ 2
2 = τ1(τ3 + 2) = τ2 + τ3 + 2τ1. Similarly τ2τ 2
3 = τ1 + τ3 + 2τ2 and
τ3τ 2
1 = τ1 + τ2 + 2τ3. The sum is δ = 4(τ1 + τ2 + τ3) = −4.
For (e), the norm modulo 3 is (a3 +b3 +c3)−abc−(a2c+ab2 +bc2), and this is
≡(a + b + c) −abc −(a2c + ab2 + bc2) mod 3. Any nonzero square is ≡1 mod 3,
and we consider cases. If 3 does not divide abc, then a2 ≡b2 ≡c2 ≡1 mod 3, and
the norm is ≡−abc ̸≡0 mod 3. If 3 divides a but not bc, then b2 ≡c2 ≡1 mod 3,
and the norm is ≡(b + c) −b ≡c ̸≡0 mod 3. If 3 divides a and b but not c, then
the norm is ≡c ̸≡0 mod 3, while if 3 divides a and c but not b, then the norm is
≡b ̸≡0 mod 3. The case that 3 divides all of a, b, c is excluded by the condition that
GCD(a, b, c) = 1, and all other cases are handled by symmetry. Thus in all cases
the norm is not divisible by 3.
For (f), let x, y, z be members of Q not all 0. Choose integers a, b, c and relatively
prime integers n and d such that x = n−1da, y = nd−1db, z = nd−1c, and
GCD(a, b, c) = 1. Then NK/Q(xτ1 + yτ2 + zτ3) = d−3n3NK/Q(aτ1 + bτ2 + cτ3).
Applying (e) and supposing that 3 is a norm, we obtain 3 = d−3n3(3k + (1 or 2))

Chapter III
669
for some integer k. Thus 3d3 = n3(3k + (1 or 2)). This equality forces n to divide
d, and we may therefore take n = 1. Thus 3d3 = 3k + (1 or 2). The left side is
divisible by 3, and the right side is not. Hence 3 is not a norm.
5. For (a), Dirichlet’s Theorem (Theorem 1.21) says that there are inﬁnitely many
primes of the form p = kn + 1. For any such p, n divides p −1. For (b) with this p,
the Galois group of Q(e2πi/p)/Q is cyclic of order p −1 and has a cyclic subgroup
of order (p −1)/n. The corresponding subﬁeld is a Galois extension of Q of degree
n with cyclic Galois group.
6. For 0 ≤k < n and 0 ≤l < n, we have xσ k xσ l = jk jl = jk+l. Meanwhile,
xσ k+l equals jk+l if k + l < n and equals jk+l−n if k + l ≥n. So xσ k xσ l = xσ k+l if
k + l < n and xσ k xσ l = jnxσ k+l−n = rxσ k+l−n if k + l ≥n. Thus a(σ k, σ l) has the
stated value.
7. It is just a question of checking that cσ kσ k(cσ l) = a(σ k, σ l)cσ k+l with a(σ k, σ l)
as in the previous problem.
8. We have ∂0(1, σ k) = 1 −σ k and thus
f0∂0(1, σ k) = 1 −σ k = (σ −1)(−(1 + σ + · · · + σ k−1)).
If we put f1(1, σ k) = −(1+σ +· · ·+σ k−1), then we have T f1(1, σ k) = f0∂0(1, σ k)
for all k.
Next, for k ≤l, we have ∂1(1, σ k, σ l) = (σ k, σ l) −(1, σ l) + (1, σ k) =
σ k(1, σ l−k) −(1, σ l) + (1, σ k). Then f1∂1(1, σ k, σ l) equals
−σ k(1 + σ + · · · + σ l−k−1) + (1 + σ + · · · + σ l−1) −(1 + σ + · · · + σ k−1) = 0.
For k > l, the term (σ k, σ l) is replaced by σ k(1, σ n+l−k). Thus ∂1(1, σ k, σ l) =
σ k(1, σ n+l−k) −(1, σ l) + (1, σ k). Then f1∂1(1, σ k, σ l) is
−σ k(1 + σ + · · · + σ n+l−k−1) + (1 + σ + · · · + σ l−1) −(1 + σ + · · · + σ k−1)
= −(1 + σ + · · · + σ n+l−1) + (1 + σ + · · · + σ l−1)
= σ l(−(1 + σ + · · · + σ n−1)).
If we deﬁne f2 as in the problem, then in the two cases we have
k ≤l :
N f2(1, σ k, σ l) = (1 + σ + · · · + σ n−1)(0) = 0 = f1∂1(1, σ k, σ l),
k > l :
N f2(1, σ k, σ l) = (1 + σ + · · · + σ n−1)(−σ l) = f1∂1(1, σ k, σ l).
9.
To ψ in HomZG(ZG, K ×), the chain map of the previous problem asso-
ciates ψ ◦f2 in HomZG(ZG({(1, g1, g2)}), K ×), and then the corresponding member
of C2(G, K ×) is 2(ψ f2) whose value at (g1, g2) is ψ f2(1, g2, g1g2).
That is,
2(ψ f2)(σ k, σ l) = ψ f2(1, σ k, σ k+l), and this by Problem 8 is ψ(0) if k + l < n
and is ψ(−σ k+l−n) = ψ(σ k+l−n)−1 if k + l ≥n.

670
Hints for Solutions of Problems
10. Taking Proposition 3.32 into account, we see that the mapping whose kernel
gives the cocycles is Hom(T, 1) : HomZG(ZG, K ×) →HomZG(ZG, K ×). Here
Hom(T, 1)ψ = ψ ◦T .
We are identifying ψ with ψ(1) and also ψ ◦T with
ψ(T (1)) = ψ(σ −1) = (σ −1)ψ(1) in additive notation. Hence the effect of
Hom(T, 1) is to carry y to σ(y)y−1 in multiplicative notation. A necessary and
sufﬁcient condition for σ(y)y−1 to be 1 is that y be in F×, since the subgroup of K ×
ﬁxed by G is F×.
11. Since ψ(0) = 1 and ψ(σ k+l−n) = σ k+l−nψ(1) = ψ(1) = r−1, the member a
of C2(G, K ×) that corresponds to ψ has
a(σ k, σ l) =
 1
if k + l < n,
r
if k + l ≥n,
and this is the 2-cocycle of Problem 6.
12. Corollary 3.34 and Theorem 3.14 combine to give us a group isomorphism
B(K/F) ∼= F×
NK/F(K ×), and the above problems show that the element r of F×
used in deﬁning A corresponds under this isomorphism to the coset of r−1. Hence
the order of the Brauer equivalence class of A equals the order of the coset of r, as
required.
If A is not a division algebra, then A ∼= Mm(D) for some central division algebra
D over F and for some integer m > 1. Here dimF D = (n/m)2 < n2. Corollary
3.15 then gives the contradiction that the order of the Brauer equivalence class of D,
which is the same as the order of the class of A, divides n/m, which in turn is < n.
13.
The Skolem–Noether Theorem shows that the image matrices under two
different isomorphisms ϕ and ψ have to be conjugate to one another, say with ϕ =
C−1ψC. Then
det(ϕ(X1 −a ⊗1)) = det(C−1ψ(C(X1 −a ⊗1)))
= (det C)−1 det(ψ(X1 −a ⊗1))(det C)
= det(ψ(X1 −a ⊗1)).
14. Let B = A ⊗F K. The left B module B is semisimple and is the direct sum
of n isomorphic simple modules of dimension n. On each the operation of a ⊗1 has
characteristic polynomial det(X1 −a ⊗1), and the characteristic polynomial for the
direct sum of the spaces is the product of the characteristic polynomials.
15.
Arguing by contradiction, we may assume that the statement is false for
some monic P = P(X) and that P has the lowest possible degree among all monic
polynomials for which the assertion is false. Factor P over K into powers of distinct
irreducible polynomials as P = Pd1
1 · · · Pdk
k .
The n-fold product of Pd1
1 · · · Pdk
k
with itself is in F[X] by assumption and is therefore invariant under Gal(K/F).
Consequently for each σ ∈Gal(K/F) and each Pi, there exists some Pj such that
Pj = σ(Pi). It follows that if H is the subgroup of G = Gal(K/F) ﬁxing P1, then

Chapter III
671
Q = 
σ H∈G/H σ P1 is the product of distinct irreducible factors of P and hence
divides P. The polynomial Q is ﬁxed by every member of G and hence is monic
in F[X]. Thus Q ̸= P. Then Qn is in F[X], and hence (P/Q)n is in F[X]. The
fact that P is not in F[X] implies that Q ̸= P. Therefore deg(P/Q) < deg P. By
the minimal choice of deg P, P/Q is in F[X]. Therefore P = (P/Q)Q is in F[X],
contradiction.
16. For a matrix m with entries in a ﬁeld, passing to a larger ﬁeld does not change
det(X1 −m). Suppose we start with two ﬁnite Galois extensions K1 and K2 of F
that split A. Let K1 be a splitting ﬁeld for a polynomial g1 ∈F[X], and let K2 be
a splitting ﬁeld for g2 ∈F[X]. Deﬁne K to be a splitting ﬁeld for g1g2. Then K is
a ﬁnite Galois extension of F, and we can regard it as containing both K1 and K2.
Applying the ﬁrst sentence of this paragraph ﬁrst to K1 and K and then to K2 and K,
we see that the reduced characteristic polynomial is the same over K1 as it is over K2.
17.
The formulas for NrdA/F(ab) and NrdA/F(1) follow from properties of
determinants.
From Problem 14 we observe that deta = (−1)n2 det(−a) and
det(−ϕ(a ⊗1)) = (−1)n det(ϕ(a ⊗1)).
Substituting X = 0 into the formula
therefore gives us NA/F(a) = det a = (−1)n2 det(−a) = (−1)n2 det(−ϕ(a ⊗1))n =
(−1)n2((−1)n)n det(ϕ(a ⊗1))n = det(ϕ(a ⊗1))n = NrdA/F(a)n. If a is invert-
ible, then 1 = NrdA/F(1) = NrdA/F(aa−1) = NrdA/F(a)Nrd(a−1) shows that
NrdA/F(a) is nonzero. Conversely if NrdA/F(a) ̸= 0, then NrdA/F(a) ̸= 0 and hence
det L(a) ̸= 0. If P(X) is the algebra polynomial of L(a), then the Cayley–Hamilton
Theorem shows that P(L(a)) = 0. Since det L(a) ̸= 0, P(X) has a nonzero constant
term. Therefore we can separate the constant term in the equation P(L(a)) = 0 to
exhibit an identity of the form L(a)Q(L(a)) = 1 for some polynomial Q(X), and
the element Q(a) is a 2-sided inverse to a in A. This proves (a), and the conclusion
about division algebras is immediate.
18. The deﬁnition gives
m(dxρ) = 	
μ
μ(d)a(μ, ρ)Eμ,μρ,
m(cxτ) = 	
σ
σ(c)a(σ, τ)Eσ,στ,
m

(dxρ)(cxτ)

= m

dρ(c)a(ρ, τ)xρτ

= 	
μ
μ

dρ(c)a(ρ, τ)

a(μ, ρτ)Eμ,μρτ.
Also we have
m(dxρ)m(dxρ) = 	
μ,σ
μ(d)a(μ, ρ)σ(c)a(σ, τ)Eμ,μρ Eσ,στ
= 	
μ
μ(d)μρ(c)a(μ, ρ)a(μρ, τ)Eμ,μρτ.
This matches m

(dxρ)(cxτ)

by the cocycle relation for a.

672
Hints for Solutions of Problems
For the reduced norm we have two one-one F algebra homomorphisms of A into
Mn(K), one via the mapping m above and one by the embedding A →A ⊗F 1 ⊆
A⊗F K ∼= Mn(K), and these are conjugate by the Skolem–Noether Theorem. Hence
the determinant gives the same result in the two cases. The determinant in the second
case gives the reduced norm, and hence it must give the reduced norm in the ﬁrst case.
19. The algebra H can be realized as all complex matrices x =

α β
−¯β ¯α

, and
NrdH/R(x) = |α|2+|β|2 and NH/R(x) = (|α|2+|β|2)2 asaspecialcaseofProblem18.
20.
Let D be a ﬁnite-dimensional central division algebra over F, say with
dimF D = n2.
Choose a basis {xk} of D over F, and expand elements of D
as x = 	n2
j=1 cjxj. The function P(c1, . . . , cn2) = NrdD/F
 	n2
j=1 cjxj

is easily
checked to be a homogeneous polynomial of degree n in n2 variables, and condition
(C1) says that it has a nontrivial zero if n < n2. In this case the corresponding member
x of D would be a nonzero element of D that fails to be invertible, and there is no such
element. We conclude that n < n2 is false, and that means that n = 1. Therefore F
is the only ﬁnite-dimensional central division algebra over F, and B(F) = 0.
Chapter IV
1. For (a), every free abelian group of ﬁnite rank is in the category, and such
groups provide enough projectives.
Let I = F ⊕T be a decomposition of an injective I as the direct sum of a free
abelian group F of rank k and a torsion group T . The sequence 0 →F ⊕T →
2F ⊕T →(Z/2Z)k →0 is exact but not split unless k = 0, and thus F = 0. Thus
every injective in the category is a ﬁnite group, and no inﬁnite group in the category
embeds into an injective.
For (b), every abelian group and in particular every torsion abelian group is a
subgroup of a divisible group. The torsion subgroup of the divisible group is still
divisible and is still an injective, and thus every group in the category embeds in an
injective in the category.
Let P be a projective in the category mapping onto Z/2Z = {0, 1} by a homo-
morphism τ, and let x be an element of P with τ(x) = 1. If g is a generator of a
cyclic group G of order 2k, then there is a homomorphism ϕ of G onto Z/2Z with
ϕ(g) = τ(x) = 1. Since P is projective, there exists a homomorphism σ : P →G
with ϕσ = τ, and then we have 1 = τ(x) = ϕσ(x). Then σ(x) = gm for some odd
integer m, and this has order 2k. Hence x has order at least 2k. Since k is arbitrary,
x must have inﬁnite order. But all groups in the category are torsion groups, and P
therefore cannot exist.
2. Let p be a prime, and let C be the category of all abelian groups that are the
underlying additive group of a vector space over the ﬁeld of p elements. This category
coincides with the category of all direct sums of copies of Z/pZ. Every such abelian

Chapter IV
673
group is projective and injective for the category.
3. Every unital left R module is the direct sum of simple R modules. Hence every
short exact sequence splits, and every module is both projective and injective for CR.
4. For (a), let I be injective. Given x ∈I and a ̸= 0 in R, let B = C = R, let
τ : R →I have τ(r) = rx, and let ϕ : R →R have ϕ(r) = ra. Setting up Figure
4.4, we obtain σ : R →I with τ = σϕ. If we put y = σ(1) and evaluate both sides
at 1, then we obtain x = τ(1) = σ(ϕ(1)) = σ(a) = aσ(1) = ay, as required.
For (b), suppose that the unital left R module I is divisible. Suppose that J is an
ideal of R, and write J = (a). Let ϕ : J →I be an R homomorphism. Since I is
divisible, there exists y in I with ay = ϕ(a). Then ϕ extends to the R homomorphism
 with (1) = y. By Proposition 4.15, I is injective.
5. Proposition 4.20 shows that there exists an injective I0 containing an isomorphic
copy M of M. Problem 4 shows that I0 is divisible, and hence I1 = I0/M is divisible.
ByProblem4, I1 isinjective. Then0 →M →I0 →I1 →0isaninjectiveresolution
of M.
6. If a module M in C is given, we form the appropriate kind of resolution X in C
needed to compute the derived functors of G, and the same X will be appropriate for
computing the derived functors of F ◦G. The derived functors of G come from the
homology or cohomology of G(X) with G(M) removed, and the derived functors of
F ◦G come similarly from F(G(X)). Thus the result follows from Proposition 4.4.
7. If a module M in C is given, we form the appropriate kind of resolution X in C
needed to compute the derived functors of G ◦F on M. Then F(X) is the appropriate
kind of resolution for computing the derived functors of G on F(M), and the result
follows.
8. For n odd, H n(G, M) is the cohomology of the complex
HomZG(ZG, M)
N
←−HomZG(ZG, M)
T
←−HomZG(ZG, M),
while for n even, H n(G, M) is the cohomology of the complex
HomZG(ZG, M)
T
←−HomZG(ZG, M)
N
←−HomZG(ZG, M).
This proves the isomorphisms concerning cohomology. For n odd Hn(G, M) is the
homology of the complex
ZG ⊗ZG M
N
−→ZG ⊗ZG M
T
−→ZG ⊗ZG M,
while for n even, Hn(G, M) is the homology of the complex
ZG ⊗ZG M
T
−→ZG ⊗ZG M
N
−→ZG ⊗ZG M.
This proves the isomorphisms concerning homology.

674
Hints for Solutions of Problems
9. For (a), let TAB : HomD(F(A), B) →HomC(A, G(B)) be the natural isomor-
phism. Naturality in B says for any ψ : B →B′ that we have
HomC(1A, G(ψ)) ◦TAB = TAB′ ◦HomD(1F(A), ψ)
on HomD(F(A), B).
Let P be projective in C.
We are to prove that F(P) is
projective in D, thus to prove that HomD(F(P), · ) is exact. We need to show that
whenever ψ : B →B′ is onto in D, then HomD(1F(P), ψ) is onto. By hypothesis,
G(ψ) : G(B) →G(B′) is onto in C. The displayed equation with A = P has
HomC(1P, G(ψ)) onto, and TP B and TP B′ are given as isomorphisms. Therefore
HomD(1F(P), ψ) is onto, as we were to show. The proof of (b) is similar.
10.
Conclusion (a) follows from the natural isomorphism HomS(P S
R A, B) =
HomS(S ⊗R A, B) ∼= HomR(A, FR
S B). Conclusion (b) follows from Problem 9a
with F = P S
R and G = FR
S , since FR
S is exact and therefore carries onto maps to onto
maps. For (c), P S
R A is given by the tensor product S ⊗R A, and this tensor product is
an exact functor of A if S is projective as a right R module, by Proposition 4.19a.
For (d), part (c) says that M 	→P S
R M is an exact functor. Taking it to be F in
Problem 7a and G to be HomS( · , N), we have Extk
S(P S
R M, N) = Gk(F(M)). Prob-
lem 7a says that this is equal to (G ◦F)k. Since (G ◦F)(M) = HomS(P S
R M, N) ∼=
HomR(M, FR
S N) has (G ◦F)k(M) = Extk
R(M, FR
S N), we obtain Extk
S(P S
R M, N) ∼=
Extk
R(M, FR
S N).
For (e), (b) shows that the chain complex P S
R X is projective over P S
R M, and we
are assuming that Y is exact (and projective) over P S
R M. Theorem 4.12 says that the
identity map on P S
R M extends to a chain map f : P S
R X →Y that is unique up to
homotopy. Dropping the terms in degree −1 and applying the functor HomS( · , N)
to the diagram gives us a cochain map from the complex HomS(Y, N) to the complex
HomS(P S
R X, N) ∼= HomR(X, FR
S N). Thus we get homomorphisms on cohomology
Ext∗
S(P R
S M, N) →Ext∗
R(M, FR
S N).
11. Conclusion (a) follows from the natural isomorphisms HomS(A, I S
R B) =
HomS(A, HomR(S, B)) ∼= HomR(S ⊗S A, B) ∼= HomR(FR
S A, B). Conclusion (b)
follows from Problem 9b because FR
S is exact and therefore carries one-one maps
to one-one maps. For (c), I S
R = HomR(S, · ) is exact if S is projective as a right R
module, by Proposition 4.19a.
For (d), part (c) says that M 	→I S
R M is an exact functor. Taking it to be F
in Problem 7b and G to be HomS(M, · ), we have Extk
S(M, I S
R N) = Gk(F(N)).
Problem 7b says that this is equal to(G◦F)k. Since (G◦F)(N) = HomS(M, I S
R N) ∼=
HomR(FR
S M, N) has (G ◦F)k(M) = Extk
R(FR
S M, N), we obtain Extk
S(N, I S
R N) ∼=
Extk
R(FR
S M, N).
For (e), (b) shows that the cochain complex I S
R X is injective over I S
R N, and we
are assuming that Y is exact (and injective) over I S
R N. Theorem 4.16 says that the
identity map on I S
R N extends to a cochain map f : Y →I S
R X that is unique up to
homotopy. Dropping the terms in degree −1 and applying the functor HomS(M, · )

Chapter IV
675
to the diagram gives us a cochain map from the complex HomS(M, Y) to the complex
HomS(M, I S
R X) ∼= HomR(FR
S M, X). Thus we get homomorphisms on cohomology
Ext∗
S(M, I R
S N) →Ext∗
R(FR
S M, N).
12. For (a), the deﬁnition of q is
(qϕ)(g1, . . . , gq) = ϕ(1, g1, g1g2, . . . , g1 · · · gq)
for ϕ ∈HomZG(Fq, M). Putting f = qϕ gives (ρ∗f )(g1, . . . , gq) = ρ∗(qϕ) =
q(ϕ ◦ρ) = (qϕ) ◦ρ, as asserted.
For inﬂation the groups are (G, G′) = (G, G/H), and the map ρ is the quo-
tient map; the effect is given by (Inf f )(g1, . . . , gq) = f (g1H, . . . , gq H) for f in
Cq(G/H, M H).
For restriction the groups are (G, G′) = (H, G), and the map
is the inclusion; the effect is given by (Resψ)(h1, . . . , hq) = ψ(h1, . . . , hq) for
ψ ∈Cq(G, M).
For (b), let f be in C1(G/H, M H).
Then Res(Inf( f ))(h) = Inf( f )(h) =
f (hH) = f (H). The condition for f to be a cocycle is that δ1 f = 0, i.e., that
f (uv) = f (u)+u( f (v)) for u and v in G/H. Taking u and v to be the identity coset
H shows that f (H) = 0.
For (c), let f ∈C1(G/H, M H) be a cocycle. Then Inf( f )(g) = f (gH). If this
is a coboundary in C1(G, M), then there exists ψ ∈M with δ0ψ = f , i.e., with
f (gH) = gψ −ψ for all g. The left side depends only on the coset gH, and hence
so must the right side. Then it follows that ghψ = gψ for all h ∈H and that
ψ is in M H. Then the formula f (gH) = gψ −ψ exhibits f as a coboundary in
C1(G/H, M H).
For (d), let f be a cocycle in C1(G, M) such that Res f is a coboundary in
C1(H, M). The formula is (Res f )(h) = f (h), and the coboundary condition shows
that there is some ψ ∈M H with f (h) = hψ −ψ for h ∈H. Since ψ is in M H,
f (h) = 0 for all h ∈H. The cocycle condition on f is that f (uv) = f (u)+u( f (v))
for all u and v in G. Taking v to be in H shows that f (gh) = f (g) for all h ∈H.
Taking instead u to be in H shows that f (hg) = h( f (g)) for all h ∈H. Since H is
normal, h( f (g)) = f (g) for all h ∈H. Therefore f takes values in M H and is Inf
of the cocycle ¯f in C1(G/H, M H) given by ¯f (gH) = f (g).
13. For (a), we have (g0ϕm)(g) = ϕm(gg0) = gg0m = ϕg0m(g), and m 	→ϕm is a
ZG homomorphism. Suppose that ϕm = 0. Then gm = 0 for all g and in particular
for g = 1. Therefore m = 0, and m 	→ϕm is one-one. Then it follows that the
sequence is exact.
For (b), we know that ZG as an abelian group is free abelian. Then Problem 11d
shows that H k(G, B)=Extk
ZG(Z, B)=Extk
ZG(Z, I ZG
Z (F Z
ZG M)) ∼= Extk
Z(Z, F Z
ZG M).
Since HomZ(Z, · ) is exact from CZ to itself, Extk
Z(Z, F Z
ZG M) = 0 for k ≥1.
For (c), a Z basis of ZG consists of all 1-tuples (g) with g ∈G, and a Z basis of
ZH consists of all (h) with h ∈H. Let {v} be a set of representatives of the cosets of
G/H, and let A be the free abelian group on {v}. The Z-bilinear map (v, (h)) 	→(vh)

676
Hints for Solutions of Problems
extends to a homomorphism of A ⊗Z ZH into ZG that is manifestly onto, and it is
one-one because 	 ni(vihi) = 0 implies ni = 0 for all i. Thus it is an isomorphism.
For (d), use of (c) gives F ZH
ZG B ∼= F ZH
ZG HomZ(ZG, M) ∼= HomZ(F ZH
ZG (ZG), M)
∼= HomZ(A⊗ZZH, M) ∼= HomZ(ZH, HomZ(A, M)), and then H k(H, F ZH
ZG B) = 0
for k ≥1 by the same argument as in (b).
For (e), the long exact sequence for Ext∗
H(Z, · ) that comes from the short exact
sequence in (a) shows that 0 →H0(H, M) →H0(H, B) →H0(H, N) →
H1(H, M) is exact. The right member is assumed to be 0, and the three middle
members are isomorphic to M H, B H, and N H.
For (f), consider the Z bilinear map (1, (g)) 	→(gH) of Z×ZG into Z(G/H), and
extend it to a Z linear map of Z ⊗Z ZG into Z(G/H). The group H acts trivially on
Z on the right, and it acts on Z(G/H) by left translation. Let h be in H. The passage
Z × ZG →Z(G/H) has (1h, (g)) 	→(gH) and (1, h(g)) 	→h(gH) = (gH);
thus the group homomorphism Z ⊗Z ZG →Z(G/H) descends to a homomorphism
of Z ⊗ZH ZG into Z(G/H). This is certainly onto. To see that it is one-one, let
	
i ni1 ⊗(gi) 	→0. Then 	
i ni(gi H) = 0, and for each coset representative v
in G, 	
gi∈vH ni(gi) = 0. So 	
i ni(h−1
i v) = 0, and
 	
i ni(h−1
i )

(v) = 0. Then
	
i ni(h−1
i ) = 0 in ZH because (v) is invertible in ZG, and it follows that the map
is one-one.
For (g), (f) gives B H = HomZH(Z, HomZ(ZG, M)) ∼= HomZ(Z ⊗ZH ZG, M) ∼=
HomZ(Z(G/H), M), and the same argument as in (b) shows that H k(G/H, B H) = 0
for k ≥1.
Conclusion (h) is immediate because q ≥2 and because all the cohomology
associated with B has been shown to be 0 in degrees ≥1.
The commutativity in conclusion (i) follows because the inﬂation and restriction
mappings are clearly functorial.
The vertical mappings have been shown to be
isomorphisms in (h). To see via induction that the top row is exact, we have to
verify that H k(H, N) = 0 for k ≤q −2; but H k(H, N) ∼= H k+1(H, M) for all
k ≥1, and H k+1(H, M) is assumed to be 0 for k + 1 ≤q −1. Therefore the bottom
row is exact, and the induction is complete.
14-16. These problems are routine veriﬁcations.
17. Part (a) follows because R ⊗R A is naturally isomorphic to A. For (b), F ⊗R A
∼=
!
s∈S (Fs ⊗R A) and 1F ⊗f corresponds to ! (1Fs ⊗f ). The values of the
various R homomorphisms are in the various spaces Fs ⊗R B, whose sum is direct,
and thus the kernel of 1F ⊗f is the direct sum of the kernels. Then (b) follows. For
(c), we see from (a) and (b) that free R modules are ﬂat. In CR, every projective is a
direct summand of a free module, and thus (c) follows by a second application of (b).
18. Consider 1 ⊗f : M ⊗R A →M ⊗R B. Any element of ker(1 ⊗f ) is a ﬁnite
sum 	 mi ⊗ai, and this lies in ker((1 ⊗f )

MF), where F is the ﬁnite set of indices
in question. Thus ker(1 ⊗f ) ̸= 0 implies ker((1 ⊗f )

MF) ̸= 0 for some F. The
converse is immediate because ker((1 ⊗f )

MF) ⊆ker(1 ⊗f ) for all F.

Chapter IV
677
19. The long exact sequence for tensor product over R is of the form
· · · →TorR
1 (A, F) →TorR
1 (A, B) →A ⊗R K →A ⊗R F →A ⊗R B →0,
and TorR
1 (A, F) = 0 because F is projective for CR. This establishes the exactness
of the sequence in the problem. If A is ﬂat, then
0 →TorR
1 (A, B) →A ⊗R K →A ⊗R F →A ⊗R B →0
is exact for each B, and TorR
1 (A, B) must be 0 for each B. Conversely if TorR
1 (A, B)
is 0 for each B, then A ⊗R ( · ) is an exact functor by Proposition 4.3. Hence A is ﬂat
by deﬁnition.
20. On the one hand, the long exact sequence associated to tensoring the short
exact sequence given in (a) by B is of the form
0 →TorR
1 (M, B) →TorR
1 (T (M), B) →F ⊗R B →M ⊗R B →T (M)⊗R B →0,
since F free implies TorR
1 (F, B) = 0. On the other hand, the given short exact
sequence splits, and tensoring it by B must directly produce a short exact sequence
0 →F ⊗R B →M ⊗R B →T (M) ⊗R B →0.
Thus ker(F ⊗R B →M ⊗R B) = 0, and we must therefore have
image(TorR
1 (T (M), B) →F ⊗R B) = ker(F ⊗R B →M ⊗R B) = 0.
Consequently 0 →TorR
1 (M, B) →TorR
1 (T (M), B) →0 is exact. This proves (a).
For (b), Problem 18 shows that M is ﬂat if and only if each MF is ﬂat, and
(a) in combination with Problem 19 shows that each MF is ﬂat if and only if each
T (MF) is ﬂat. Now suppose that M is ﬂat, so that T (MF) is ﬂat for each ﬁnite
subset F of M. This is true in particular for each ﬁnite subset F′ of T (M), and
T (MF′) = MF′ = (T (M))F′. Hence Problem 18 shows that T (M) is ﬂat. Conversely
suppose that T (M) is ﬂat. Then T (M)F′ is ﬂat for each ﬁnite subset F′ of T (M).
Let F be a ﬁnite subset of M. Then MF is a ﬁnitely generated R submodule, and
the structure theorem shows that T (MF) is ﬁnitely generated. Let F′ be a set of
generators for it. Then T (MF) = MF′ = T (M)F′. This is ﬂat by Problem 18, since
T (M) is ﬂat, and the ﬁrst sentence of this paragraph allows us to conclude that M is
ﬂat.
For (c), T (M) ̸= 0 means that am = 0 for some nonzero a ∈R and m ∈M.
Let i : (a) →R be the inclusion, which is one-one. Then i ⊗1 : (a) ⊗R M →
R ⊗R M ∼= M has (i ⊗1)(a ⊗m) = am = 0. Thus the one-one map i is carried to
the map i ⊗1 that is not one-one, and tensoring with M is not exact. So M is not ﬂat.
For (d), if M is ﬂat, then T (M) = 0 by (c). Conversely if T (M) = 0, then T (M)
is ﬂat, and (b) shows that M is ﬂat.

678
Hints for Solutions of Problems
21. Since ∂′
p,q and ∂′′
p,q both lower p + q by 1, they both carry Ep+q to Ep+q−1.
Also, the hypotheses give (∂′
p,q + ∂′′
p,q)2 = ∂′
p−1,q∂′
p,q + ∂′
p,q−1∂′′
p,q + ∂′′
p−1,q∂′
p,q +
∂′′
p,q−1∂′′
p,q = 0, and we have a chain complex.
22. We compute that ∂′
p−1,q∂′
p,q = (αp−1 ⊗1)(αp ⊗1) = αp−1αp ⊗1 = 0,
∂′
p,q−1∂′′
p,q + ∂′′
p−1,q∂′
p,q
=
(αp−1 ⊗1)(−1)p(1 ⊗βq) + (−1)p−1(1 ⊗βq)×
(αp ⊗1) = (−1)p(αp ⊗βq) −(−1)p(αp ⊗βq) = 0, and that ∂′′
p,q−1∂′′
p,q =
(−1)p(1 ⊗βq−1)(−1)p(1 ⊗βq) = 1 ⊗βq−1βq = 0.
23. The formulas for ∂′
p,q and ∂′′
p,q show that ker ∂′
p,q = ker αp ⊗R Dq and that
ker ∂′′
p,q = Cp ⊗R ker βq. Since ∂′
p,q Ep,q and ∂′′
p,q Ep,q lie in independent spaces,
ker(∂′
p,q +∂′′
p,q) = ker ∂′
p,q ∩ker ∂′′
p,q = ker αp ⊗R ker βq. Similarly ∂′
p+1,q(Ep+1,q) =
αp+1(Cp+1) ⊗R Dq and ∂′′
p,q+1(Ep,q+1) = Cp ⊗R βq+1(Dq+1), and hence
image(∂′
p+1,q + ∂′′
p,q+1) = αp+1(Cp+1) ⊗R Dq + Cp ⊗R βq+1(Dq+1).
Thus if c is in Cp, d is in Dq, c′ is in αp+1(Cp+1), and d′ is in βq+1(Dq+1), then
(∂′
p,q + ∂′′
p,q)

(c + c′) ⊗(d + d′)

is the sum of (∂′
p,q + ∂′′
p,q)(c ⊗d) and three
terms that are in image(∂′
p+1,q + ∂′′
p,q+1). Consequently we obtain a well-deﬁned
homomorphism of Hp(C) ⊗R Hq(D) into Hp+q(E).
24. Let ∂′ and ∂′′ be the boundary operators; these satisfy ∂′∂′′ = −∂′′∂′. Let a
be a cycle in E−1,k, i.e., let ∂′′a = 0. Since ∂′a = 0, the exactness for ∂′ produces
c0,k ∈E0,k with a = ∂′c0,k.
Since ∂′′a = 0, this has ∂′∂′′c0,k = −∂′′∂′c0,k =
−∂′′a = 0. Now suppose inductively on i ≥0 that j ≥0 is deﬁned by i + j = k and
that ci, j ∈Ei, j is given with ∂′∂′′ci, j = 0. By the assumed exactness, ∂′∂′′ci, j = 0
implies ∂′′ci, j = ∂′ci+1, j−1 for some ci+1, j−1 ∈Ei+1, j−1, and then ∂′∂′′ci+1, j−1 =
−∂′′∂′ci+1, j−1 = −∂′′∂′′ci, j = 0. The induction leads us nonuniquely to ck,0 ∈Ek,0
such that ∂′∂′′ck,0 = 0. Deﬁne b ∈Ek,−1 by b = ∂′′ck,0, and then ∂′b = 0. The result
of the construction is therefore that we pass nonuniquely from the cocycle a ∈E−1,k
for ∂′′ to a cocycle b ∈Ek,−1 for ∂′.
Inverting the stepsand the choices, we see that we can passfromb back toa. Thusif
we can address the nonuniqueness, then the isomorphism in homology will have been
established. We are to show that if a ∈E−1,k at the start is a boundary relative to ∂′′,
then any system of choices leads to a result b ∈Ek,−1 that is a boundary for ∂′. Since
a is assumed to be a boundary for ∂′′, a = ∂′′a′ with a′ ∈E−1,k+1. The element a′ has
∂′a′ = 0, and thus a′ = −∂′a0,k+1 for some a0,k+1 ∈E0,k+1. Meanwhile, the above
construction makes a = ∂′c0,k. So ∂′∂′′a0,k+1 = −∂′′∂′a0,k+1 = ∂′′a′ = a = ∂′c0,k.
By exactness, c0,k −∂′′a0,k+1 = ∂′b1,k for some b1,k ∈E1,k. This proves that c0,k is
of the form c0,k = ∂′′a0,k+1 + ∂′b1,k with a0,k+1 ∈E0,k+1 and b1,k ∈E1,k. (Note that
this form for c0,k already implies that ∂′∂′′c0,k = 0.)
Now suppose inductively on i ≥0 that j ≥0 is deﬁned by i + j = k and
that ci, j ∈Ei, j is given with ci, j = ∂′′ai, j+1 + ∂′bi+1, j. The constructed element
ci+1, j−1 ∈Ei+1, j−1 has ∂′′ci, j = ∂′ci+1, j−1 for some ci+1, j−1 ∈Ei+1, j−1. Thus

Chapter IV
679
∂′ci+1, j−1 = ∂′′∂′bi+1, j = −∂′∂′′bi+1, j, and ci+1, j−1 + ∂′′bi+1, j = ∂′bi+2, j−1. If
we put ai+1, j = −bi+1, j, then we have ci+1, j−1 = ∂′′ai+1, j + ∂′bi+2, j−1, and the
induction goes through to i = k. Consequently any choice of ck,0 obtained starting
from the boundary a is of the form ck,0 = ∂′′ak,1 +∂′bk+1,0. The ﬁnal step is to deﬁne
b = ∂′′ck,0, and then we have b = ∂′′∂′bk+1,0 = −∂′∂′′bk+1,0, and b is exhibited as a
boundary relative to ∂′.
25. Since each Cp is projective for p ≥0, Cp ⊗R D is exact. Similarly C ⊗R Dq is
exact for q ≥0. The hypotheses of Problem 24 are satisﬁed, and the two homologies
match.
26. H0(C) = H0(C′) = H0(D) = Z/2Z, and Hp(C) = Hp(C′) = Hp(D) =
0 for p ̸= 0.
H0(C ⊗Z D) = H0(C′ ⊗Z D) = Z/2Z, H1(C ⊗Z D) = 0 and
H1(C′ ⊗Z D) = Z/2Z, Hp(C ⊗Z D) = Hp(C′ ⊗Z D) = 0 for p /∈{0, 1}.
27. Let Zp = ker ∂′
p ⊆Cp, Bp = image ∂′
p+1 ⊆Cp, and B′
p = Bp−1. Since R
is a principal ideal domain, Problem 20 shows that ﬂat is equivalent to torsion free.
Modules of the complex C are ﬂat by assumption, hence torsion free. Modules of Z
and B′ are R submodules of these, hence are torsion free, hence are ﬂat.
28. The long exact sequence in homology shows that
TorR
1 (B′, D) →Z ⊗R D →C ⊗R D →B′ ⊗R D →0
is exact. Since B′ is ﬂat, Problem 19 shows that TorR
1 (B′, D) = 0.
29. For (a), the boundary map on B′
p ⊗R Dq in B′ ⊗R D is ∂′ ⊗1+(−1)p(1⊗∂′′),
and ∂′ = 0 on boundaries in B′
p.
For (b), tensoring with B′ is an exact functor, since B′ is ﬂat. Therefore the
exactness of 0 →Z →D
∂′′
→B
′ →0 implies the exactness of
0 →(B′ ⊗R Z)n →(B′ ⊗R D)n
(1⊗∂′′)n
−→(B′ ⊗R B
′)n →0
for each n. From the exactness of this sequence, we can read off that ker(1 ⊗∂′′)n
within (B′⊗R D)n is (B′⊗R Z)n and that image(1⊗∂′′)n on (B′⊗R D)n is (B′⊗R B
′)n,
which is the same thing as (B′ ⊗R B)n−1.
For (c), the results of (b) show that
Hn(B′ ⊗R D) ∼= ker(1 ⊗∂′′)n/ image(1 ⊗∂′′)n+1 = (B′ ⊗R Z)n/(B′ ⊗B)n.
Since tensoring with B′ is exact, the exactness of 0 →B →Z →H(D) →0
implies the exactness of
0 →B′ ⊗R B →B′ ⊗R Z →B′ ⊗R H(D) →0
in each degree. Thus B′ ⊗R H(D) = (B′ ⊗R Z)/(B′ ⊗R B), and Hn(B′ ⊗R D) ∼=
(B′ ⊗H(D))n = (B ⊗R H(D)n−1.
Part (d) is handled in a fashion similar to (c).

680
Hints for Solutions of Problems
30. For (a), TorR
1 (Z, H(D)) = 0 because Z is ﬂat.
In (b), comparison of the exact sequence with kerωn−1 with the exact sequence
displayed before part (a) (but with n replaced by n −1) shows that ker ωn−1 is
isomorphic to TorR
1 (H(C), H(D))n−1. Substituting for ker ωn−1 and incorporating
the isomorphism into the mapping into Hn(B′ ⊗R D) leads to β′
n−1 as the one-one
mapping.
In (c), we have
coker(ι ⊗1) = Hn(C ⊗R D)/ image(ιn ⊗1) = Hn(C ⊗R D)/ ker(∂′
n ⊗1)
∼= image(∂′
n ⊗1) = ker ωn−1 ∼= TorR
1 (H(C), H(D))n−1.
The composition of maps leading from Hn(C ⊗R D) to Hn(B′ ⊗R D) has to be
∂′
n ⊗1, and thus β′
n−1βn−1 = ∂′
n ⊗1. The map βn−1, apart from isomorphisms, is
onto because q was constructed as onto.
Part (d) is completely analogous, and the resulting map αn is one-one.
For (e), we know that α is one-one and that β is onto. Also, we have β′
n−1βn−1αnα′
n
= (∂′
n ⊗1)(ιn ⊗1) = 0.
Since β′
n−1 is one-one and α′
n is onto, βn−1αn = 0.
Finally suppose that x is in ker βn−1. Then x is in ker(β′
n−1βn−1) = ker(∂′
n ⊗1) =
image(ιn ⊗1) = image(αnα′
n) = image αn. This completes the proof of exactness.
31. This is immediate.
32.
Let X = {Xn} and Y = {Yn}.
Then Morph(X, Y) is the subgroup of
∞
n=−∞Hom(Xn, Yn) consisting of those elements in the product satisfying the chain
map conditions. A zero object is any tuple of 0’s, and certainly product and coproduct
make sense. One readily veriﬁes that the tuple of kernels of a chain map furnishes a
kernel for a chain map and that the tuple of cokernels furnishes a cokernel.
33. The additional objects and morphisms at the top of the extended diagram are
C0 = 2Z/8Z, B0 = Z, k given by 2 mod 8 	→2 mod 8, k given by × 2, 
ψ given by
1 	→2 mod 8, and ϕ given by × 4. Since the composition ofk followed by β = × 2
is not 0, (B0,k) cannot be the kernel of β.
The additional objects and morphisms at the bottom of the extended diagram are
A′
0 = Z/4Z, B′
0 = Z/16Z, p given by 1 	→1 mod 4, p given by 1 	→1 mod 16, ϕ′
given by 1 mod 4 	→4 mod 16, and 
ψ′ given by 1 mod 16 	→1 mod 4.
34. We give the argument only for Hom(M, · ). Let 0 →A
ϕ→B
ψ→C →0 be
a given exact sequence, and form the sequence
0 −−−→Hom(M, A)
Hom(1,ϕ)
−−−−−−→Hom(M, B)
Hom(1,ψ)
−−−−−−−→Hom(M, C).
We are to show that Hom(1, ϕ) is one-one and that exactness holds at Hom(M, B).
If σ is in Hom(M, A) with Hom(1, ϕ)(σ) = 0, then ϕσ = 0, and it follows that
σ = 0 because ϕ is a monomorphism.
For the exactness at Hom(M, B), we use Theorem 4.42e. We know immediately
that Hom(1, ψ) Hom(1, ϕ) = Hom(1, ψϕ) = Hom(1, 0) = 0. Thus suppose that

Chapter V
681
τ ∈m Hom(M, B) has Hom(1, ψ)τ ≡0. This condition means that ψτ ≡0. Since
the given sequence is exact, Theorem 4.42e produces some τ ′ ∈m A with ϕτ ′ ≡τ.
In turn, this says that Hom(1, ϕ)τ ′ ≡τ. By Theorem 4.42, we have exactness at
Hom(M, B).
35. We give the proof only that the splitting of exact sequences as indicated
implies that P is projective. Thus suppose that a morphism τ ∈Hom(P, B) and an
epimorphism ψ ∈Hom(C, B) are given. We are to produce σ ∈Hom(P, C) with
τ = ψσ. Let (W, 
ψ,τ) be a pullback of (ψ, τ). Then τ 
ψ = ψτ, and Proposition
4.40 shows that 
ψ is an epimorphism. Then it follows that
0 →domain(ker 
ψ)
ker
ψ
−→W

ψ
−→P →0
is exact, and it must split by assumption. Thus there exists ρ ∈Hom(P, W) with

ψρ = 1P. Put σ = τρ. Then ψσ = ψτρ = τ 
ψρ = τ1P = τ, as required.
Chapter V
1. If ξ is a root of F(X), then the given formula shows that D(ξ) is −23 and −31
in the two cases. These contain no square factor and therefore equal DK in the two
cases.
2. For (a), let G(X) = F(X + 2
3) = X3 −4
3 X + 22
27. Then F(X) and G(X)
have the same discriminant, and the discriminant for G(X) is given by the formula
of Problem 1. It is −44.
For (b), let x = a + bξ + cξ2 be given with a, b, c all in {0, 1}. The matrix of
left-by-x in the ordered basis (1, ξ, ξ2) works out to be
 a −2c
−2b−4c
b
a
−2c
c b+2c a+2b+4c

,
and the determinant of it is
a3 + 2a2(b + 4c) + 4c3 −2b(b + 2c)2 + 4ac(b + 2c) + 2bc(a + 2b + 4c).
For x to be twice an algebraic integer, this determinant, which is the norm of x, has
to be ≡0 mod 8. All the terms are even except possibly the ﬁrst, and thus a has to be
even. That is, a = 0. The determinant then reduces to 4c3−2b(b+2c)2+4bc(b+2c).
All terms here are divisible by 4 except possibly −2b2. Thus b must be even. That
is, b = 0. The determinant reduces in this case to 4c3. For this to be divisible by 8, c
must be even. That is, c = 0. Proposition 5.2 consequently says that a further factor
of 22 cannot be eliminated from the discriminant.

682
Hints for Solutions of Problems
3. For (a), Theorem 5.21 and the remarks after it show that every equivalence
class contains an ideal whose norm is < (0.283)D1/2
K . Proposition 5.8 shows that
DK = 35 = 243. Thus every equivalence class contains an ideal with norm ≤4.
Conclusion (b) is immediate from Theorem 5.6 with F(X) = X3 −3. Conclusion
(c) follows because (
3√
3−1)(
3√
9+
3√
3+1) = (
3√
3 )3 −1 = 3−1 = 2. Conclusion
(d) is immediate from Proposition 5.10d.
For (e), any nonzero ideal is the product of powers of prime ideals associated with
the various prime numbers. The ones corresponding to the prime numbers 2 and 3 are
principal ideals by (b), (c), and (d). These are the only ones that need to be checked,
according to (a). Thus every nonzero ideal is principal.
4. Conclusion (a) is immediate from Theorem 5.6, since X3 −7 factors modulo 2
as (X + 1)(X2 + X + 1). For (b), we show that no element x = a + b
3√
7 + c
3√
49
has norm ±2. Left multiplication by x carries 1 to a + b
3√
7 + c
3√
49, carries
3√
7 to
7c + a
3√
7 + b
3√
49, and carries
3√
49 to 7b + 7c
3√
7 + a
3√
49. Thus its matrix is
 a 7c 7b
b a 7c
c b
a

.
The determinant is a3 + 49c3 + 7b3 −21abc, which is congruent modulo 7 to a3.
Modulo 7, the cubes are 0 and ±1, and thus the congruence a3 ≡±2 mod 7 has no
solution.
5. Since the element
√−1 +
√
−5 has degree 4 over Q, the minimal polynomial
has degree 4. The product of (X −(+√
−1 +
√
−5 )) and the Galois transforms
(X −(+
√
−1 −√−5 )), (X −(−√−1 + √−5 )), and (X −(−√−1 −√−5 )) is
X4 + 12X2 + 16, which is in Z[X].
6. The minimal polynomial of ξ = 1
2(
√
−1+
√
−5 ) is H(X) = X4 +2−212X2 +
2−416 = X4 + 3X2 + 1 with |D(ξ)| = |NK/Q(H ′(ξ))|. Here H ′(X) = 4X3 +
6X = 2(2X2 + 3). Since ξ4 + 3ξ2 + 1 = 0, we have ξ2 = −3
2 ± 1
2
√
5; thus
2ξ2 + 3 = ±
√
5. So |D(ξ)| = |NL/Q(±2
√
5 )|. The four conjugates of
√
5 are
+
√
5 twice and −
√
5 twice, and the norm is the product of the four conjugates. Thus
|D(ξ)| = |NL/Q(±2
√
5 )| = 2452.
7. These follow immediately by applying Theorem 5.6 to the indicated prime, 2
or 5, and the respective polynomials: X2 + 5, X2 + X −1, and X2 + 1.
8. With Q ⊆K′ ⊆L, the (e, f, g) for L/Q has to be entry by entry ≥the triple for
K′/Q. The triple for K′/Q is given in Problem 7b as (1, 2, 1) for p = 2. Similarly
from Q ⊆K′′ ⊆L, the (e, f, g) for L/Q has to be ≥(2, 1, 1). Thus e ≥2, f ≥2,
and g ≥1. Since ef g = 4, equality must hold throughout: (e, f, g) = (2, 2, 1).
This proves (a). Similarly for (b), we must have (e, f, g) ≥(2, 1, 1) and (e, f, g)
≥(1, 1, 2). Thus (e, f, g) ≥(2, 1, 2). Since ef g = 4, (e, f, g) = (2, 1, 2).
9. In (a), Problem 8a shows that (2)T = P2, and we know that (2)R = ℘2
2. Then
P2 = (2)T = (2)RT = ℘2
2T = (℘2T )(℘2T ). Since P is prime, P divides ℘2T .
For the equality P2 = (℘2T )2 to hold, we must have P = ℘2T .

Chapter V
683
Similarly (5)T = P2
1 P2
2 and (5)R = ℘2
5. Then P2
1 P2
2 = (5)T = (5)RT =
℘2
5T = (℘5T )2. Since P1 and P2 are prime, P1 and P2 must divide ℘5T . Therefore
P1P2 = ℘5T .
In (b), conclusion (a) shows that no prime ideal of R that divides (2)R or (5)R
ramiﬁes in T . Since D(ξ) is divisible by no prime numbers other than 2 and 5,
Theorem 5.6 shows that no prime ideal (p) of Z ramiﬁes in T . Hence no prime ideal
of R containing such a prime (p) of Z ramiﬁes in T .
10. Roots of unity must map to roots of unity under the embedding, and there
are only two roots of unity within R. Hence there are no real-valued embeddings
when p > 2. Thus the embeddings come in complex-conjugate pairs. The product
σ(x)σ(x) is positive for x > 0, and NK/Q(x) is the product of these expressions over
all such pairs.
11. For (a), F(X) is the minimal polynomial of ζ k when GCD(k, p) = 1. Then
ζ k −1 is a root of G(X) = F(X + 1) of the correct degree, and therefore G(X) is
the minimal polynomial of ζ k −1. If H(X) is the ﬁeld polynomial of an element η,
then NK/Q(η) = (−1)[K:Q]H(0). In this instance [K : Q] = p −1 is even. Taking
η = ζ k −1, we obtain NK/Q(ζ k −1) = G(0) = F(1) = p.
For (b), ζ −1 divides ζ k −1, and hence the quotient is in R. If l is chosen with
lk ≡1 mod p, then ζ −1 = ζ lk −1, and ζ k −1 divides ζ lk −1. Therefore the
reciprocal of (ζ k −1)/(ζ −1) is in R.
12. With F(X) and G(X) as in the previous problem, F′(ζ k) = G′(ζ k −1).
Here F(X) = (X p −1)/(X −1) makes G(X) = X−1[(X + 1)p −1] and G′(X) =
X−2[pX(X + 1)p−1 −(X + 1)p + 1]. Since ζ kp = 1,
F′(ζ k) = G′(ζ k−1) = (ζ k−1)−2[p(ζ k−1)ζ k(p−1)−ζ kp+1] = (ζ k−1)−1 pζ k(p−1).
The result now follows from the formula D(ζ k) = F′(ζ k).
13. Continuing from the previous problem gives
NK/Q(F′(ζ k)) = NK/Q(ζ k −1)−1 p p−1NK/Q(ζ k(p−1)) = p p−2.
The result follows from the computation (−1)(p−1)(p−2)/2D(ζ k) = NK/Q(D(ζ k)) =
NK/Q(F′(ζ k)) = p p−2.
14. For (a), we have λk = (1 −ζ)k = 	k
j=0 (−1) jk
j

ζ j and ζ k = (1 −λ)k =
	k
j=0 (−1) jk
j

λ j. Conclusion (b) is a version of Problem 11b because the conjugates
of ζ are the powers ζ j for 1 ≤j ≤p −1. For (c), we have p = p−1
k=1 (1 −ζ k) =
p−1
k=1 (1−ζ)uk = (1−ζ)p−1 p−1
k=1 uk, where uk = (1−ζ k)/(1−ζ). Each element
uk is a unit by Problem 11c, and (c) follows.
15.
The identity (p)R = (1 −ζ)p−1 is immediate from Problem 14c.
The
extension K/Q being Galois, we know that the prime decomposition of the ideal
(p)R is of the form (p)R = Pe
1 · · · Pe
g , where p −1 = ef g and f is the common

684
Hints for Solutions of Problems
value of all dimFp(R/Pj). This latter fact says that no factorization of (p)R into
proper ideals can have more than p −1 factors, and p −1 factors occur only if all
factors are prime. In this case, (1 −ζ) is a proper ideal because NK/Q(1 −ζ) = p.
Thus each factor (1 −ζ) is prime.
16.
Following Proposition 5.2, suppose that aj is an integer for each j with
s ≤j ≤k such that 0 ≤aj ≤p −1, as ̸= 0, ak = 1, and
asλs + a1λs+1 + a2λs+2 + · · · + ak−1λk−1 + akλk = pr
with r in R.
Subtracting all terms from the left side but the ﬁrst and applying
Problem 15 shows that asλs lies in (λ)s+1. Thus (as)(λ)s ⊆(λ)s+1. Canceling gives
(as) ⊆(λ), and this inclusion is a contradiction because GCD(N((as)), N((λ))) = 1.
17. Each step toward a Z basis multiplies a discriminant by a square, and it is
enough to prove that a primitive element ξ for K/Q lying in R has sgn D(ξ) = (−1)r2.
We are thus to compute the sign of 
i< j (σi(ξ) −σj(ξ))2. For a given pair (i, j), the
factor (σi(ξ) −σj(ξ))2 is matched by its complex conjugate elsewhere in the product
unless σi and σj are both real or are complex conjugates of one another. The factor
and its mate have a positive product, and pair with σi and σj both real contributes a
positive square. If σj = σ i, then σi(ξ) −σj(ξ) is purely imaginary, and its square is
negative. Hence the sign is (−1)r2.
18. Let g be in Gal(K/Q) = {σ1, . . . , σn}. Replacing each σj by gσj has the
effect of permuting the columns of [σj(αi)]. If the permutation is even, then the terms
contributing to P are the same before and after the permutation; otherwise they are
interchanged. In either case, P + N and P N are ﬁxed. Since P + N and P N are
ﬁxed by the Galois group, they are in Q. The entries σj(αi) of the matrix are in R,
and thus P and N are in R. Consequently P + N and P N are in Z. The formula
D() = (P + N)2 −4P N shows that D() ≡(P + N)2 mod 4. Any square of a
member of Z is congruent to 0 or 1 modulo 4, and the result follows.
19. Let J be an ideal of S−1R. Proposition 8.47 of Basic Algebra shows that
I = R ∩J is an ideal in R and that J = S−1I. Since I1, . . . , Ih is a complete set
of representatives for the equivalence classes, aI = bIj for some j with 1 ≤j ≤h.
Let (a)S and (b)S be the principal ideals of S−1R generated by a and b. The fact that
u is in Ij ∩S means that S−1Ij = S−1R, and thus
(a)S J = S−1(a)S−1I = S−1(a)I = S−1(b)Ij
= S−1(b)S−1Ij = S−1(b)S−1R = (b)S.
(∗)
Hence J is principal. (In fact, the equality shows that aj = b for some j ∈J.
Hence ba−1 = j is an element of J ⊆S−1R, the principal ideal (ba−1)S of S−1R is
meaningful, and (ba−1)S ⊆J. For the reverse inclusion let j ∈J be given, and use
(∗) to write aj = bx with x ∈S−1R. Then j = (ba−1)x shows that j is in (ba−1)S,
and J ⊆(ba−1)S.)

Chapter V
685
20. For (a), write ab = uk. Then a−1 = u−kb exhibits a−1 as in S−1R. For (b),
if u−ma is a unit in S−1R, then u−ma−1 = u−lc for some c ∈R. Hence ac = ul−m.
Since ac is in R and u is not, l −m = k with k ≥0. Then a divides uk.
21. For (a), write (u)= Pe1
1 · · · Pel
l . Then (uh) = (Ph
1 )e1 · · · (Ph
l )el = (be1
1 · · · bel
l ).
Thus uh = be1
1 · · · bel
l ε for some unit ε in R, each bj divides uh, and the conclusion
follows from Problem 20a.
For (b), we have (a)(b) = (u)k = Pke1
1
· · · Pkel
l
. Since a and b are in R, this
equality implies that (a) = Pr1
1 · · · Prl
l . For each j, use the division algorithm to
write rj = njh + tj with 0 ≤tj < h. Then P
rj
j
= (Ph
j )nj P
tj
j
= (bj)nj P
tj
j , and
consequently (a) = (d)Pt1
1 · · · Ptl
l as required, where d = l
j=1 b
nj
j .
The argument for (c) was given in parentheses at the end of the solution of
Problem 19.
22. Because of Problem 21d, we now have (a) = (d)(ci). Thus a = dciε for
some unit ε in R. Since uk = ab = cidbε, ci divides uk and is a unit in S−1R by
Problem 20a.
23. Problem 22 shows that any unit of S−1R is a product of a power of u by a
product l
j=1 b
nj
j , an element ci, and a unit ε of R. Problem 21a shows that each bj is
a unit in S−1R, and Problem 22 shows that each ci is a unit in S−1R. Thus (S−1R)×
is generated by u, the ﬁnitely many elements bj and ci, and a ﬁnite set of generators
of R×. (The group R× is ﬁnitely generated by the Dirichlet Unit Theorem.)
24. G(4/ξ) = (64ξ −3 −16ξ −2 + 8ξ −1 + 8) = 8ξ −3(ξ3 + ξ −2 −2ξ + 8) =
8ξ −3F(ξ) = 0. The element η is in K, and it is exhibited as the root of a monic
polynomial in Z[X]; therefore it is in R.
25. For (a), 0 = F(ξ)/ξ = ξ2 + ξ −2 + 8ξ −1 = ξ2 + ξ −2 + 2η. For (b),
0 = G(η)/η = η2 −η +2+8/η = η2 −η +2+2ξ. Solving the ﬁrst equation for ξ2
gives the ﬁrst formula in the table, and solving the second equation for η2 gives the
second formula in the table. The formula ξη = 4 is immediate from the deﬁnition
η = 4/ξ. The formulas in the table together show that any integer polynomial in ξ
and η reduces to a Z combination of 1, ξ, and η.
Conclusion (c) is clear. For (d), we have η = 1 −1
2(ξ2 + ξ), and this is not in
Z({1, ξ, ξ2}). For (e), we have D((1, ξ, ξ2)) = −22·503. Since the only square factor
is 22, it follows that Z({1, ξ, ξ2}) has index 2 in Z({1, ξ, η}) and that D((1, ξ, η)) =
−503. This latter discriminant is square free and thus cannot be reduced further.
Therefore DK = −503, and {1, ξ, η} is a Z basis of R. Finally the formula η =
1 −1
2(ξ2 + ξ) shows that Z({1, ξ, η}) = Z({1, ξ, 1
2(ξ2 + ξ)}).
26. Application of ϕ to ξ2 = ξ + 2 −2η gives ξ
2 = ξ. Similarly η2 = η. The
elements of a ﬁnite ﬁeld of characteristic 2 ﬁxed by the squaring map are 0 and 1.
Hence ξ and η are in {0, 1}. Since F = ϕ(R) is generated by the values of ϕ on 1,
ξ, and η, F has two elements. From ξη = 4, it follows that ξη = 0. Thus ξ and η
cannot both be 1, and the only possibilities are the ones in the table.

686
Hints for Solutions of Problems
27. Deﬁne ϕ : R →F2 on ξ and η by one of the lines of the table of Problem 26,
and set ϕ(1) = 1. Then ϕ extends to a well-deﬁned additive homomorphism on
Z({1, ξ, η}). We have to check that ϕ respects multiplication. It is enough to do so
on additive generators. Thus we have to check that ϕ(ξ2) = (ϕ(ξ))2, that ϕ(η2) =
(ϕ(η))2, and that ϕ(ξη) = (ϕ(ξ))(ϕ(η)). Thus, for example, in the ﬁrst one we
want −ϕ(ξ) + 2ϕ(1) −2ϕ(η) = (ϕ(ξ))2. If we write the values of ϕ as triples
corresponding to the three possible ϕ’s, the left side is −(0, 1, 0) + 2(1, 1, 1) −
2(0, 0, 1) ≡(0, 1, 0) mod 2, while the right side is (0, 1, 0)2 ≡(0, 1, 0) mod 2.
These match, and this relation is veriﬁed. The other two relations are veriﬁed in
similar fashion.
28. The norm of a kernel equals the number of elements in the image of the
homomorphism, which is 2 in each case. Since each ideal has prime norm, the
ideal is prime. Moreover, these ideals contain (2)R and hence all ﬁgure into the
prime factorization of (2)R.
On the other hand, we must have 	 ei fi = 3 for
the decomposition, and we have seen that there are at least three terms. So there
are exactly three terms, and we must have ei = fi = 1 in each case. Therefore
(2)R = P0,0P1,0P0,1.
29. For (a), the elements listed are additive generators of the ideal in each case,
and hence they are also ideal generators. For (b), η = η(ξ + 1) −2 · 2 shows that
η is in the ideal (2, ξ + 1). Thus (2, ξ + 1, η) ⊆(2, ξ + 1). The reverse inclusion
is clear. In (c), the argument for (2, η + 1) is completely symmetric. Let us see that
(2, ξ, η) = (2, ξ −η). The inclusion ⊇is clear. For the inclusion ⊆, we use the two
formulas
(−1 −η)2 + (−ξ)(ξ −η) = −2 −2η −(−ξ + 2 −2η) + 4 = ξ,
(3 + ξ)2 + (−η)(ξ −η) = 6 + 2ξ −4 + (−2ξ −2 + η) = η.
30. For (a), the ﬁeld polynomial of θ −q is H(X +q), and so the norm of θ −q is
−H(0+q), as required. In (b), the ﬁrst two formulas come from the ﬁeld polynomials
F(X) and G(X) of ξ and η, and the other formulas follow from (a).
In (c), the fact that N((ξ)) = |NL/Q(ξ)| = 8 shows that the prime factorization
of (ξ) is into prime ideals whose norms are powers of two. Problem 28 shows that
all such ideals have been identiﬁed, and thus (ξ) = Pa
0,0Pb
1,0Pc
0,1 for some exponents
≥0. Comparing norms shows that a + b + c = 3. Similar remarks apply to (η).
In (d), use of Problem 28 shows that P2
0,0P2
1,0P2
0,1 = ((2)R)2 = (4)R = (ξ)(η) =
Pa+α
0,0 Pb+β
1,0 Pc+γ
0,1 . Then a +α = 2, b+β = 2, and c+γ = 2 by unique factorization.
For (e), we observe from the kernels, or else we see from Problem 29a, that ξ is not
in P1,0 andthatη isnotin P0,1. Hence P1,0 doesnotappearintheprimefactorizationof
(ξ), and P0,1 does not appear in the prime factorization of (η). Therefore b = γ = 0.
For (f), the results of (e) and (d) combine to show that a + α = 2, β = 2, and
c = 2. Since a + c = 3 and α + β = 3, a = α = 1.
31. For (a), we see immediately from Problem 29a that ξ + l lies in P1,0 but
not in P0,0 and not in P0,1. For (b), the formula |NK/Q(ξ + 3)| = 22 shows that

Chapter VI
687
(ξ + 3) is the product of exactly two of the prime ideals of norm 2; thus (a) implies
that (ξ + 3) = P2
1,0. Similarly |NK/Q(ξ −1)| = 23, and (a) gives (ξ −1) = P3
1,0.
Conclusion (c) is immediate from Problem 29a.
For (d), we have (2)R ⊆(2, ξ); thus (2, ξ) is of the form Pa
0,0Pb
1,0Pc
0,1 with
a + b + c ≤3. Since ξ is not in P1,0, b = 0. Since ξ is in P0,0 and P0,1, we must
have a > 0 and c > 0. Since the inclusion (2)R ⊆(2, ξ) is proper

because ξ is not
in (2)R = 2Z({1, ξ, η})

, N((2, ξ)) ≤4. Thus a = c = 1, and (2, ξ) = P0,0P0,1.
For (e), Problem 29a shows that P0,1 = (2, ξ, η + 1). Thus P2
0,1 contains 4 and
ξ(η + 1) = 4 + ξ, hence ξ. If P2
0,1 contains also ξ + l with l ≡2 mod 4, then it
contains ξ + 2, hence 2. This would mean that P2
0,1 ⊇(2, ξ) = P0,0P0,1. Since P2
0,1
and P0,0P0,1 both have norm 4, they would have to be equal, and we would obtain
P0,1 = P0,0, contradiction.
For (f), Problem 30b gives N((ξ + 2)) = 8. In view of (c), (ξ + 2) = Pa
0,0Pc
0,1
with a + c = 3 and c ≥1. Part (d) shows that c ≤1. Thus (ξ + 2) = P2
0,0P0,1. The
argument for (ξ −2) is similar.
32. For (a), this kind of argument is done in a parenthetical remark at the end of
the solution of Problem 19. For (b), we have (ξ +2) = r2
0,0P0,1 and (ξ −1) = P3
1,0 =
(ξ + 3)P1,0. Thus the same kind of argument shows that P0,1 and P1,0 are principal.
For (c), we factor X3 + X2 −2X + 8 modulo 3; there is no root in F3, and hence
the reduced polynomial is irreducible. By Theorem 5.6 the only prime ideal whose
norm is a power of 3 has norm 33.
For (d), we factor X3 + X2 −2X + 8 modulo 5 as (X + 1)(X2 −2), and Theorem
5.6 gives us one prime ideal of norm 5 and one of norm 52. The one of norm 5,
according to the theorem, is (2, 1 + ξ). For (e), the technique of Problem 30a shows
that N((1+ξ)) = 10. Thus the only possibility for the prime factorization of (1+ξ)
is as (2, 1 + ξ)P, where P is one of the three ideals of norm 2. For (f), since (1 + ξ)
and P are principal, (2, 1 + ξ) is principal, by the same technique as in earlier parts.
For (g), the prime factorization of nonzero ideals allows us to conclude that every
nonzero ideal of norm ≤6 is principal. Application of the technique after Theorem
5.21 shows that every ideal class has a representative with norm < 6.35, hence norm
≤6. All such ideals are principal, and therefore R is a principal ideal domain.
Chapter VI
1. Apply the Cauchy criterion. Since |an + an+1 + · · · + am|p ≤maxn≤k≤m |ak|p,
the series is Cauchy, hence convergent, if and only if the terms tend to 0.
2. In (a), the equality GCD(3, 2n) = 1 implies that there exist integers xn and yn
such that 3xn −2nyn = 1. Then xn −1
3 = 2n3−1yn. Applying the 2-adic absolute
value gives |xn −1
3|2 = 2−n|yn|2 ≤2−n, and this tends to 0. For example take
xn =
1
3(22n−1 + 1). In (b), the argument with a
b replacing 1
3 is similar: to get

688
Hints for Solutions of Problems
|x −a
b|2 ≤2−n, start by ﬁnding x and y with bx −2ny = a.
3. Write ideles as tuples indexed by ∞, 2, 3, 5, . . . . If q is in Q, then ι(q) =
(q, q, q, q, . . . ). If this is to be in R× × 
p Z×
p , then the only restriction on the ﬁrst
coordinate is that q ̸= 0, but the other coordinates are restricted by |q|p = 1 for all
primes p. This means that q in lowest terms has no p in either the numerator or the
denominator. So q = ±1. This proves (a).
In (b), let (x∞, x2, x3, . . . ) be in I. Since |xp|p ̸= 1 for only ﬁnitely many p, there
exists a unique positive rational q such that |q|p = |xp|p for all p. Deﬁne zp = xpq−1
as a member of Q×
p . Then |zp|p = |xp|p|q|−1
p
= 1 shows that |zp|p = 1 for all p.
Finally deﬁne r = x∞q−1 as a member of R×. Then (r, z2, z3, . . . ) is in I(S∞), and
(x∞, x2, x3, . . . ) = (q, q, q, . . . )(r, z2, z3, . . . ).
4.
In (a), the norm of the ideal divides the norm of any element, and if the
norm of the ideal is prime, then the ideal is prime. With K = Q(
√
−5 ), we have
NK/Q(1±
√
−5 ) = 6, NK/Q(3) = 9, and NK/Q(2) = 4. Therefore N((1±
√
−5, 3))
divides GCD(6, 9) = 3, and N((1 ±
√
−5, 2)) divides GCD(6, 4) = 2. One checks
that these ideals are not all of R, and then the respective norms are 3 and 2. So
the ideals are prime. In (b), (1 +
√
−5 ) = (1 +
√
−5, 2)(1 +
√
−5, 3), and (3) =
(1 +
√
−5, 3)(1 −
√
−5, 3).
In (c), 1
3(1+
√
−5 )R = (1+
√
−5, 2)(1+
√
−5, 3)(1+
√
−5, 3)−1(1−
√
−5, 3)−1
= (1 +
√
−5, 2)(1 −
√
−5, 3)−1, and (1 +
√
−5, 3) does not appear.
In (d), 1+
√
−5
3
= 2(1+
√
−5 )
2·3
=
2(1+
√
−5 )
(1+
√
−5 )(1−
√
−5 ) =
2
1−
√
−5.
5. The mapping ϕ : 1 + Pn
v →Pn
v /Pn+1
v
induced by 1 + x 	→x + Pn+1
v
is
a homomorphism from 1 + Pn
v under multiplication into Pn
v /Pn+1
v
under addition
because the equalities ϕ(1 + x) = x + Pn+1
v
, ϕ(1 + y) = y + Pn+1
v
, and
ϕ

(1 + x)(1 + y)

= ϕ(1 + x + y + xy)
= x + y + xy + Pn+1
v
= x + y + Pn+1
v
show that ϕ

(1 + x)(1 + y)

= ϕ(1 + x) + ϕ(1 + y). The kernel of ϕ is the set of
all 1 + x with x ∈Pn+1
v
, i.e., 1 + Pn+1
v
, and the image is certainly all of Pn
v /Pn+1
v
.
6. The composition I1/ι(K ×) →I/ι(K ×) →I/P induced by the inclusion
I1 →I and the passage from I to I discussed in Section 10 is onto I/P because the
composition is affected by only the nonarchimedean places and because any member
of I can be adjusted at the archimedean places so as to be in I1. In addition, the
composition is continuous if I/P is given the discrete topology. Since I1/ι(K ×) is
compact, the discrete space I/P has to be compact and must be ﬁnite.
7. Fix a ﬁnite subset S of places containing S∞. Then the projection of 
w∈S K ×
w
to K ×
v is continuous for each v ∈S. Since also the inclusion K ×
v →Kv is continuous,
the composition 
w∈S K ×
w →Kv is continuous. Thus the corresponding mapping

w∈S K ×
w →
w∈S Kw is continuous. In similar fashion 
w/∈S Z×
w →Zv is a

Chapter VI
689
continuous function as a composition of continuous functions. Thus 
w/∈S Z×
w →

w/∈S Zw is continuous. Putting these two compositions together shows thatIK(S) →
AK(S) is continuous, and therefore IK(S) →AK is continuous. Since this is true for
each S, it follows that IK →AK is continuous.
8. Each xn lies in AQ(S∞), which is an open set in AQ. For each prime p,
xn,p = 1 if n is large enough, and also xn,∞= 1 for all n. Since AQ(S∞) has the
product topology, {xn} converges to (1). On the other hand, if {xn} were to converge
to some limit x in IQ, then x would have to lie in some I(S), and the ideles xn would
have to be in I(S) for large n. But (xn,v) is not in I(S) as soon as v is outside S.
9. For ﬁxed g in G, we have d((gx)) = d((g)(x)) = d((x)), and hence
d(( · )) and d( · ) are Haar measures on G. Any two Haar measures are proportional,
and the result follows.
10. In (a) the equality is trivial if c1c2 = 0. When c1c2 ̸= 0, we have d(c1c2x) =
|c1c2|F dx and also d(c1c2x) = |c1|Fd(c2x) = |c1|F|c2|F dx, and it follows that
|c1c2|F = |c1|F|c2|F in this case as well.
The proof of continuity is harder (but is essential to make sense out of (b)). We ﬁrst
check continuity at each c0 ̸= 0. Let f be a continuous real-valued function vanishing
off a compact set S, and let N be a compact neighborhood of c0 not containing 0. If c
is in N, then f (c−1x) is nonzero only for x in the compact set N S. Let ϵ > 0 be given.
Continuity of(c, x) 	→f (c−1x) allows us to ﬁnd, for each x in N S, an open subneigh-
borhood Nx of c0 and an open neighborhoodUx of x such that | f (c−1y)−f (c−1
0 x)| <
ϵ for c ∈Nx and y ∈Ux. Then | f (c−1y) −f (c−1
0 y)| < 2ϵ for c ∈Nx and y ∈Ux.
The open sets Ux cover N S. Forming a ﬁnite subcover and intersecting the cor-
responding ﬁnitely many sets Nx, we obtain an open neighborhood N ′ of c0 such
that | f (c−1y) −f (c−1
0 y)| < 2ϵ for c ∈N ′ whenever y is in N S. As a result,
c 	→

V f (c−1x) dx is continuous at c = c0. Therefore c 	→|c|V

V f (x) dx is
continuous at c0, and so is c 	→|c|V .
To prove continuity at c = 0, we are to show that limc→0

V f (c−1x) dx = 0 for
f as above. Let U be any compact neighborhood of 0 in V . Find a sufﬁciently small
neighborhood N of 0 in V such that c ∈V implies that cS does not meet U c. Then
c−1U c ∩S = ∅. For such c’s, we have
 
V f (c−1x) dx
 =
 
U f (c−1x) dx
 ≤
∥f ∥sup (dx(U)), and the desired limit relation follows.
For (b), we have d(cx)/|cx|F = (|c|F dx)/(|c|F|x|F) = dx/|x|F. For (c), |x|F =
|x| if F = R, and |x|F = |x|2 if F = C. For (d), |x|F = |x|p if F = Qp. For (e),
we have I = pZp, and therefore the Haar measure of I is the product of |p|p = p−1
times the Haar measure of Zp. Hence the Haar measure of I is p−1.
11. If F has characteristic p′ ̸= 0, then the sum 1 + · · · + 1 with p′ terms is 0
in R, and it must be 0 in R/p. So R/p must have characteristic p′. Thus any such
p′ ̸= 0 must be p.
12. In (a), apply Corollary 6.29 with f (X) = Xq−1 −1 in R[X]. Every nonzero
¯a is a simple root of the reduced polynomial f (X) = Xq−1 −1 in Fq[X], simple

690
Hints for Solutions of Problems
because (q −1)(¯a)q−1 ̸= 0. The corollary produces a root a of f (X) whose image
in R/p is ¯a. In this way we obtain q −1 distinct roots of 1 in R, each corresponding
to a different coset in R/p. Together with 0, these exhaust the cosets of R/p.
In (b), if F has characteristic p, then raising to the pth power is a ﬁeld mapping
of F into itself. Since q = pm, raising to the qth power is the m-fold iterate of
a ﬁeld map and is a ﬁeld map. If a and b are two (q −1)st roots of 1 in R, then
(a ± b)q = aq + (±b)q = a + (±b), and so a ± b is a (q −1)st root of 1. Since the
nonzero elements of E are closed under inverses, E is a subﬁeld.
13. In (a) let x be in R. Problem 12 produces a unique a0 ∈E with x −a0 in p, i.e.,
with v(x −a0) ≥1. Then v

t−1(x −a0)

≥0, and Problem 12 produces a unique
a1 in E with t−1(x −a0) −a1 in p. Continuing in this way, we obtain a0, . . . , aN in
E with
t−1(t−1(· · · (t−1(x −a0) −a1) −· · · ) −aN−1) −aN
in p. Thus v

x −	N
k=0 aktk
≥N + 1. Since F is complete, 	∞
k=0 aktk converges
with sum x. The statement about the value of v is clear.
In (b), the part about the series giving an element in R is immediate from Problem 1,
since tk has limit 0. The operations on R now match those on Fq[[t]], and the isomor-
phism follows. For (c), let x be given with x /∈R. Set v(x) = −N. Then v(t N x) = 0,
and we can apply (a) to write t N x = 	∞
k=0 aktk. Then x = 	∞
k=0 aktk−N, as required.
14. In (a), the inclusion of the integers into R, followed by passage to the quotient
R/p, is an additive homomorphism. Since R/p has order q, q must map to the 0
coset, namely p.
Part (a) shows that v(q) ≥1. Since v(q) = v(pm) = mv(p), v(p) is positive, and
(b) is proved. The same argument as in the proof of Ostrowski’s Theorem shows that
v(p′) = 0 for all prime numbers other than p, and then (c) is immediate. For (d), it
is enough to check equality of the absolute values in question on the element p, and
for that we have |p|1/(mv0)
F
= q−v(p)/(mv0) = q−1/m = p−1.
For (e), the map of Q′ to Q, when composed with the completion Q →Qp, is a
homomorphism of valued ﬁelds into a complete ﬁeld. It therefore extends uniquely
as a homomorphism of the closure Q′ into Qp. The dense set Q′ maps to the dense
set Q, and hence the extended map is an isomorphism.
Part (f) is just a repetition of the argument in Problems 13a and 13c. In (g), let
x = 	∞
k=0 aktk be the expansion of f , and put cj0 = 	v0−1
k=0 aktk. Since v(t) = 1, we
obtain v(x −cj0) ≥v(tv0) = v0v(t) = v0. Therefore v(p−1(x −cj0)) ≥0. Iterating
this procedure as in Problem 13a, we obtain a convergent expansion x = 	∞
k=0 cjk pk.
For (h), we then have x = 	∞
k=0 cjk pk = 	l
j=1 cj
	
{k| jk= j} pk, and we see that x lies
in 	l
j=1 Q′cj. Therefore dim[F : Q′] ≤l.
15. Part (a) is immediate, and (b) follows from Theorem 6.33. For (c), R/p
corresponds to extracting the constant term from a power series in t, and thus L/℘∼=
Fq f is of dimension f over R/p ∼= Fq. The computation ℘T = tUT = tT = t RT =
pT = Pe shows that K/L has ramiﬁcation index e. For (d), each index (residue class

Chapter VI
691
degree and ramiﬁcation index) for K/F is the product of that index for K/L and that
index for L/F. So e for L/F is 1, and f for K/L is 1.
16. For (a), the irreducible polynomial g(X) has to be separable, and therefore all
of its roots in kK are simple. Application of Hensel’s Lemma in the form of Corollary
6.29 produces α. For (b), the polynomial g(X) is monic with coefﬁcients in R, and
its root α is therefore a member of L integral over R. Thus α lies in U. The natural
ﬁeld map U/℘→T/P takes u +℘to u + P, hence takes α +℘to α + P = α. Thus
we can regard α as a member of kL. Since kF and α generate kK by construction of
α, kL = kF.
For (d), let us use subscripts on the indices e and f to indicate the ﬁeld extension
in question.
Then we have eL/F fL/F = [L : F] = deg g(X) = deg g(X) =
[kK : kF] = fK/F on the one hand and fK/F = [kK : kF] = [kL : kF] = fL/F on
the other hand. The two chains of equalities together show that eL/F = 1, and the
second one in combination with fK/F = fK/L fL/F shows that fK/L = 1.
17. In (a), the element yj exists and is unique because of the nondegeneracy of the
trace form, which holds because K/F is separable (Theorem 8.54 and Section IX.15
of Basic Algebra).
In (b), the expression for the zk’s in terms of the yj’s shows that 	n
k=1 Rzk ⊆
	n
j=1 Ryj. The assumption det A = ±1 implies that B = A−1 lies in Mn(R). Since
yj = 	
k Bkjzk, we obtain 	n
j=1 Ryj ⊆	n
k=1 Rzk.
For (c), it is evident that the degree is at mostn−1. Write g(X) = 
j(X −ξj). The
opening computations of Section V.4 show that g′(ξi) = 
j̸=i(ξi −ξj). Therefore
the value of the left side at ξk for the identity in question is
n

i=1

j̸=i(ξk −ξj)

j̸=i(ξi −ξj) .
The numerator is 0 unless i = k. Thus only the ith term makes a contribution, and its
value, namely 1, matches the value of the right side. Then (d) is a routine computation.
For (e), the rational expression (1 + c1X + · · · + cn Xn)−1 on the left side is
expanded in series using (1 + Z)−1 = 1 −Z + Z2 −Z3 + · · · . Thus the left side
is the sum of Xn and a series beginning with a multiple of Xn+1. The right side is
	∞
k=0 TrK/F

g′(ξ)−1ξ k Xk+1
, and the conclusion of the problem results by equating
the indicated coefﬁcients.
For (f), the result of (e) handles the entries with i + j ≤n + 1. For those with
n + 2 ≤i + j ≤2n, we write ξi+ j−2g′(ξ)−1 as ξ nξ i+ j−n−2g′(ξ)−1, substitute for ξ n
recursively from the ﬁeld polynomial, and check that the traces are in R by applying
(e). Thus all Ai j are in R.
For (g), conclusion (f) shows that A is triangular with 1’s on the off diagonal, and
hence the determinant of A is ±1. Put zk = 	
j Ajk yj. Since xi = ξ i−1,
TrK/F(zkxi) = 	
j Ajk TrK/F(yjxi) = Aik
= TrK/F((g′(ξ)−1ξ k−1)ξ i−1) = TrK/F((g′(ξ)−1ξ k−1)xi).

692
Hints for Solutions of Problems
Therefore zk = g′(ξ)−1ξ k−1. Combining this equality with (b) shows that  N =
	
j Ryj = 	
k Rzk = 	
k Rg′(ξ)−1ξ k−1 = g′(ξ)−1N.
18. For (a), the assumption f = n makes dimkF(kK) = n. Thus deg g(X) =
deg g(X) = n. Since g(X) is irreducible, so is g(X). The root α of g(X) in K is
such that F(α) is an n-dimensional subspace of K, hence equals K.
For (b), the conclusion  N ⊇ T follows from the deﬁnition. Since  T = D(K/F)−1,
we obtain D(K/F)−1 ⊆ N = g′(α)−1N ⊆g′(α)−1T .
For (c), the polynomial g(X) was constructed as irreducible, and g(X) was con-
structed to reduce to g(X). Then g′(α) ̸= 0, and it follows that g′(α) is in T but not
P. Thus g′(α) is a unit in T , and g′(α)−1T = T . Then D(K/F)−1 ⊆T . Since
D(K/F)−1 ⊇T also, D(K/F)−1 = T , and D(K/F) = T .
19. For (a), we may assume that v(x1) ≤v(xj) for j > 1. If v(x1) < v(xj)
for all j > 1, then induction and use of property (vi) of discrete valuations shows
inductively that v(0) = v(x1 + · · · + xm) = v(x1), contradiction.
For (b), the element π is in T , and its minimal polynomial has coefﬁcients in R
because T is integral over R; in turn, the ﬁeld polynomial is a power of the minimal
polynomial. Since cj is in R, we have vK(cj) = nvF(cj), and therefore vK(cj) is
divisible by n.
For (c), apply (a) to the equality c0πn + c1πn−1 + · · · + cn = 0 to produce indices
i < j with v(ciπn−i) = v(cjπn−j) and with v(ckπn−k) ≥v(ciπn−i) for all k. The
equality involving i and j implies that j −i = vK(cj) −vK(ci). From i < j ≤n,
we have n −i > 0. Thus v(ciπn−i) ≥v(ciπ) > 0. By (b), v(ciπn−i) ≥n. So
v(ckπn−k) ≥n.
In (d), the right side of the equality j −i = vK(cj) −vK(ci) is divisible by n,
by (b), and the left side is between 1 and n. Hence the two sides equal n, and we
conclude that i = 0 and j = n. Thus the equality says that n = vK(cn). Since cn is
in F and since vK = nvF, vF(cn) = 1. Therefore cn is in p but not p2. The inequality
vK(ckπn−k) ≥n implies that vK(ck) ≥k. For 1 ≤k ≤n, this conclusion implies
that vK(ck) ≥1. Since cK is in F and since vK = nvF, vF(ck) > 0 for k ≥1. Thus
ck is in p for k ≥1.
In (e), the irreducibility is immediate from the Eisenstein irreducibility criterion, R
being a principal ideal domain. Since the ﬁeld polynomial is a power of the minimal
polynomial, the ﬁeld polynomial equals the minimal polynomial. Then the degree of
F(π) is n. Since F(π) is an n-dimensional subﬁeld of the n-dimensional ﬁeld K,
K = F(π).
Part (f) is proved in the same way as Problem 14g. For (g), the expansion can be
rewritten as 	∞
k=0 ak yk = 	∞
i=0
	
0≤j<e aei+ j yei+ j = 	
0≤j<e π j 	∞
i=0 aei+ jλi
.
The term in parentheses is the most general member of R, and the left side is the most
general member of T . Thus (g) follows.
In (h), conclusion (g) shows that N = 	n−1
k=0 Rπk equals T , and Problem 17 with
ξ = π shows that  N = g′(π)−1N. Thus D(K/F)−1 =  T = g′(π)−1T . Multiplying
by (g′(π))D(K/F), we obtain D(K/F) = (g′(π)).

Chapter VII
693
For (i), g′(π) = eπe−1 + 	n−1
k=1 cn−kkπk−1 = eπe−1 + b. In each term of b,
vK(kcn−k) ≥evF(cn−k) ≥e, and vK(πk−1) = k −1. Thus vK(b) ≥e. Meanwhile,
vK(eπe−1) = (e −1) + vK(e). Thus vK(g′(π)) ≥min

(e −1) + vK(e), vK(b)

,
and property (vi) of discrete valuations shows that equality holds if the two members
(e −1) + vK(e) and vK(b) of the minimum are unequal. If vK(e) = 0, then the
members are unequal, and we obtain vK(g′(π)) = e −1. Otherwise, we obtain
vK(g′(π)) ≥e. We know that D(K/F) = (g′(π)) = Pvk(g′(π)), and Lemma 6.47
follows.
Chapter VII
1. If x and y are members of L purely inseparable over K, then x pe and y pe′ are
in K for suitable e and e′. Without loss of generality, let e′ ≤e. Then x pe and y pe
are in K, and hence (x ± y)pe = x pe ± y pe are in K and so are (xy)pe = x pe y pe and
(xy−1)pe = x pe y−pe if y ̸= 0. So x ± y, xy, and xy−1 are purely inseparable over
K, the last of these if y ̸= 0.
2. In view of Proposition 7.10, the given conditions imply that [K(α) : K] =
pe[K(α pe) : K] and that X pμ −α pe is irreducible over K(α pe) for every μ ≥0.
Since α pe−μ is a root of this polynomial within K(α) for each μ ≤e, K(α) has a
chain of subﬁelds
K(α pe) ⫋K(α pe−1) ⫋· · · ⫋K(α p) ⫋K(α)
in which the consecutive degrees of the extensions are all p. Let β be separable over
K, and let K(α pr ) be the ﬁrst of these ﬁelds to contain β. Arguing by contradiction,
suppose that r < e. Then β and α pr+1 generate K(α pr ) because [K(α pr ) : K(α pr+1)]
is prime. The separability ofβ over K implies thatβ is separable over K(α pr+1), hence
that K(α pr ) is separable over K(α pr+1), hence that α pr is separable over K(α pr+1).
Since (α pr )p lies in K(α pr+1), α pr is also purely inseparable over K(α pr+1). By
Corollary 7.12, α pr lies in K(α pr+1). This contradicts the fact that the above chain
of subﬁelds is strictly increasing. We conclude that r = e. Hence all elements β
separable over K lie in K(α pe).
3. For suitable integers Ra, we form the tuple z = (Ra + aZ)a≥1, using the
realization of the inverse limit in Proposition 7.27. We have to specify the integers
Ra. The condition for z to lie in  Z, coming from the condition fab ◦fb = fa when a
divides b, works out to be that Rb −Ra is divisible by a whenever a divides b. After
the integers Ra have been deﬁned for all a, it is enough to check that Rpa −Ra is
divisible by a whenever p is prime.
For n odd, deﬁne R2cn = nk + 1, where k is the unique integer from 0 to 2c −1
such that nk + 1 is divisible by 2c. This k exists and is unique because −n has an
inverse modulo 2c. One checks that R2c+1n −R2cn is divisible by 2c and by n, and that
R2c pn −R2cn is divisible by 2c and by n if p is an odd prime. The deﬁnition makes
R2 = 0 and Rq = 1 for every odd prime q, and therefore z is not of the form zc for
any integer c.

694
Hints for Solutions of Problems
4. The ﬁrst part is immediate from Theorem 7.34. For the second part the group
Gal(R/Q) is trivial. In fact, any member of Gal(R/Q) must ﬁx Q and map squares in
R to squares. It therefore respects the ordering. For any r ∈R, it ﬁxes each rational
less than r, and hence it ﬁxes r.
5. Use Kn = Q(√p1, . . . , √pn ), where pn is the nth prime, and Proposition 7.30
to see that Gal(K/Q) is an inﬁnite product of groups of order 2. (A problem at the
end of Chapter IX of Basic Algebra can help with this step.) The open subgroups of
index 2 correspond to quadratic extensions of Q, of which there are countably many.
Since Gal(K/Q) has uncountably many subgroups of index 2, such a subgroup H
exists that is not open. The ﬁeld extension K/Q is normal, and thus Gal(K/Q) is a
homomorphic image of Gal(Qalg/Q), say by a homomorphism ϕ. Then ϕ−1(H) is
the required subgroup of Gal(Qalg/Q).
6. Suppose I is primary. If b + I is a zero divisor in R/I, then ab is in I for some
a not in I. Since I is primary, bm is in I for some m. Thus (b + I)m = bm + I = I,
and b + I is nilpotent in R/I.
If every zero divisor in R/I is nilpotent, then the ideal 0 in R/I is primary because
whenever (a + I)(b + I) = I and a + I ̸= I, then the nilpotence of b + I implies
that bm + I = I for some m. This says that the 0 ideal 0 + I in R/I is primary.
If the 0 ideal in R/I is primary and if ab is in I with a not in I, then (a+I)(b+I) =
I with a + I ̸= I, and hence (b + I)m = I for some m, 0 being primary in R/I. This
means that bm is in I, and I is primary.
7. In (a), if xy is in
√
I, then (xy)m is in I for some m, and therefore either xm is
in I or ymn is in I for some n, i.e., either x is in
√
I or y is in
√
I.
In (b), let x be in
√
I, and choose n such that xn is in I. Then xn is in J because
I ⊆J. Since J is prime, some factor of xn is in J, i.e., x is in J.
8. In (b), R/I ∼= C[y]/(y2). The zero divisors of R/I are cy with c ∈C, and
(cy)2 = 0 in R shows that cy is nilpotent in R. By Problem 6, I is primary. The
radical P =
√
I is (x, y) by inspection, and this is prime. Since P2 = (x2, xy, y2),
we have P2 ⫋I ⫋P. If I = Qn for some prime ideal Q, then I ⊆Q, and
Problem 7b shows that
√
I ⊆Q. Since
√
I is maximal in this case, Q has to be P.
In (c), R/P ∼= K[X, Y, Z]/(XY −Z2, X, Z) ∼= K[Y], and this is an integral
domain. Hence P is prime. Next, P2 = (x2, xz, z2). Thus xy = z2 lies in P2.
However, x is not in P2, and ym is not in P2 for any m > 0. So P2 is not primary.
9. Let a and b be in R with ab in I and a not in I. To show that I is primary,
we are to show that b is in
√
I. We do this by showing that (b) + I ⊆
√
I. The
ideal (b) + I is proper, since otherwise 1 = cb + x with x ∈I, which implies that
a = cba + xa is in I, contradiction. Let J be a maximal ideal with (b) + I ⊆J.
It is enough to show that
√
I ⊆J; in fact, then
√
I = J because
√
I is assumed
maximal, and (b) + I ⊆
√
I as asserted. So let u be in
√
I. Then um is in I ⊆J for
some m, and u is in J because J is prime.
This proves the ﬁrst part. The second part follows from the observation that if J

Chapter VIII
695
is maximal, then
√
J n = J. In fact, J n contains all elements an for a ∈J. So
√
J n
has to contain all elements a ∈J. Since J is maximal and
√
J n has to be proper,
√
J n = J.
10. In (a), let P be a prime ideal, and suppose that P = I ∩J nontrivially. If i is
in I but not J and if j is in J but not I, then i j is in P, but i is not in P because i is
not in J and similarly j is not in P because j is not in I.
In (b), I 2 = (x2, xy, y2) is primary by Problem 9.
The equality of I 2 with
(Rx + I 2) ∩(Ry + I 2) holds by inspection.
11. Arguing by contradiction, we can use the Noetherian property to obtain an
ideal I maximal with respect to the property of not being a ﬁnite intersection of proper
irreducible ideals. Since I is not irreducible, I = A ∩B nontrivially. By maximality,
A and B are intersections, and then so is I, contradiction.
12. Let Q be a proper irreducible ideal in R. Then 0 is a proper irreducible
ideal in R/Q. We show that 0 is primary in R/Q, and then Problem 6 shows that
Q is primary. Thus let xy = 0 in R/Q with y ̸= 0 in R/Q. We want to see
that some power of x is 0 in R/Q. In R/Q, we form the sequence of annihilators
Ann(x) ⊆Ann(x2) ⊆· · · and use the Noetherian property of R and its quotient R/Q
to obtain Ann(xl) = Ann(xl+1) for some l. Let us see that the intersection (xl) ∩(y)
is 0 in R/Q. In fact, if a is in (y), then xy = 0 implies ax = 0, and if a is in (xl), then
a = bxl and 0 = ax = bxl+1, from which we see that b is in Ann(xl+1) = Ann(xl).
Therefore a = bxl = 0 in R/Q. Thus indeed (xl) ∩(y) = 0. Since 0 is irreducible
in R/Q and (y) ̸= 0, we conclude that (xl) = 0 and xl = 0 in R/Q. This is what
we were to show.
13. If ab is in Q and a is not in Q, then ab is in Qi for all i and a is not in Qi0
for some i0. Since Qi0 is primary, bm is in Qi0 for some m, i.e., b is in
2
Qi0 = P.
Since √Qi = P for all i, bki is in Qi for some ki depending on i. Taking N to be
the maximum of the integers ki, we see that bN is in each Qi and hence is in their
intersection Q. Thus Q is primary.
Problem 7b shows that √Q ⊆P. On the other hand, if b is in P, we have just
seen that some power bN lies in Q. So b lies in √Q. Therefore √Q = P.
14. Problem 11 shows that every ideal is the ﬁnite intersection of proper irreducible
ideals, and Problem 12 shows that these are primary. Thus if I is given, we have
I =  Qi with each Qi primary. Group all Qi’s whose associated prime ideal is
the same Pj, and denote the intersection of these by Q′
j. The ideal Q′
j is primary
by Problem 13. Then I =  Q′
j, and the Q′
j have distinct associated prime ideals.
So condition (ii) is satisﬁed. Finally among all expressions for I as intersections
satisfying (ii), choose one that involves the smallest number of primary ideals. This
minimality forces (i) to hold.
Chapter VIII
1. (qn+1 −1)/(q −1) = 1 + q + q2 + · · · + qn.

696
Hints for Solutions of Problems
3.
It is enough to consider a monomial F(X1, . . . , Xn) = Xα1 · · · Xαn with
	n
j=1 αj = d. Then X j
∂
∂X j (Xα1 · · · Xαn) = αj Xα1 · · · Xαn, and the sum on j equals
d Xα1 · · · Xαn.
4. If f ι and gι have a nontrivial common factor in B[X], then 0 = R( f ι, gι) =
ι(R( f, g)). Since ι is one-one, R( f, g) = 0. Therefore f and g have a nontrivial
common factor in A[X].
5. Let us show that if gn ̸= 0 and fm = 0, then Theorem 8.1 for indices (m −1, n)
implies the theorem for indices (m, n), and vice versa. Assume for the moment that
m ≥2. Let R( f, g) be the resultant matrix of size m + n that takes into account all
coefﬁcients f0, . . . , fm of f , and let R( f, g) be its determinant. With fm = 0, let
R′( f, g) be the resultant matrix of size m +n −1, and let R′( f, g) be its determinant.
The matrixR′( f, g) is obtained by erasing themth row and last column ofR( f, g). On
the other hand, the only nonzero entry in the last column of R( f, g) is gn. Expansion
in cofactors therefore gives R′( f, g) = gn R( f, g). The hypotheses of Theorem 8.1
apply to f and g for either of these resultants, and we have just seen that the two
conditions (c) are equivalent. Certainly the two conditions (a) are equivalent. For the
two conditions (b), the resultant of size m + n −1 tells us that a′ f + b′g = R′( f, g)
with deg a′ < n and deg b′ < m −1. Certainly this implies that af + bg = R( f, g)
with a = a′gn and b = b′gn. Conversely if af + bg = R( f, g) with deg a < n and
deg b < m, we deﬁne a′ = ag−1
n
and b′ = bg−1
n . Then a′ f + b′g = R′( f, g) with
deg a′ < n, and we need to see that deg b′ = deg b < m −1. Since fm = 0, all the
powers of X in af are ≤(n −1) + (m −1), and the same must be true in bg. Since
g has degree n, we must have deg b ≤m −2 < m −1, as required.
Next we check what happens when m = 1 and we are comparing the resultant of
size n + 1 and a degenerate resultant whose matrix is of size n and contains only the
entries of g. The determinant formula is still valid, and we see that R′( f, g) = gn
0,
which is nonzero. Thus (a) and (c) are false for both sizes. For (b), we cannot have
af + bg = 0 with deg b < 0 and b ̸= 0. We need to check that af + bg = 0 cannot
happen with deg a < n and deg b < 1; in fact, then deg bg = deg g = n, while
f1 = 0 implies that deg af < n + deg f = n. So we cannot have af + bg = 0 in
this case either.
The result of these calculations is that Theorem 8.1 for (m, n) is equivalent to the
theorem for (m−1, n) if gn ̸= 0 and fm = 0. Using induction, we see that the theorem
for (m, n) is equivalent to the theorem for (k, n) if gn ̸= 0 and fk+1 = · · · = fm = 0.
Taking k = deg f gives the desired result.
6. Proof via Nullstellensatz: Since f is irreducible and K[X1, . . . , Xn] is a unique
factorization domain, the principal ideal ( f ) is prime. Corollary 7.2 shows that g lies
in ( f ): hence g = h f for some h.
Proof via resultants: The idea is to arrange to have
af + bg = R( f, g),
(∗)
with the resultant taken with respect to Xn. Proposition 8.1 shows that this happens
if f and g are of positive degree in Xn, and we shall show that either this is the case

Chapter VIII
697
or else f divides g for easy reasons. Since f is nonconstant, it depends nontrivially
on some X j, and renumbering the variables allows us to assume that f depends
nontrivially on Xn. Then f is of the form
f (X1, . . . , Xn)
= c0(X1, . . . , Xn−1) + c1(X1, . . . , Xn−1)Xn + · · · + cr(X1, . . . , Xn−1)Xr
n
with r > 0 and with cr nonzero in K[X1, . . . , Xn−1]. If g = 0, then certainly f
divides g. So we may assume that g ̸= 0. Choose a1, . . . , an−1 in K such that
g(a1, . . . , an−1, Xn)cr(a1, . . . , an−1) ̸= 0.
(∗∗)
Then f (a1, . . . , an−1, Xn) is a polynomial in Xn whose coefﬁcient of Xr
n is nonzero.
Since K is algebraically closed, this polynomial in Xn has a root, say an. Since
f (a1, . . . , an) = 0, the hypothesis shows that g(a1, . . . , an−1, an) = 0, and (∗∗)
allows us to conclude that g = g(X1, . . . , Xn) depends nontrivially on Xn. This
proves (∗).
To complete the proof, we show that cr R is 0 at every point (b1, . . . , br−1). Since
K is inﬁnite, it will follow that the polynomial cr R is 0; thus R = 0 because cr
is not the 0 polynomial. Then f and g will have a nontrivial common factor by
Proposition 8.1, and f will have to divide g because f is prime. Thus suppose that
cr(b1, . . . , br−1) ̸= 0. Then f (b1, . . . , br−1, Xn) is a nonconstant polynomial in Xn
and must have a root br, since K is algebraically closed. Hence f (b1, . . . , br) = 0,
and the hypothesis on g shows that g(b1, . . . , br) = 0. By (∗), R(b1, . . . , br−1) = 0.
This completes the proof.
7. Y 3 −2XY 2 + 2X2Y −4X3 = (Y −2X)(Y + i
√
2 X)(Y −i
√
2 X).
8. The resultant matrix in the W variable is
⎛
⎝
XY 4−Y 5 −2X2Y 2
X3
0
0
XY 4−Y 5 −2X2Y 2
X3
Y 4
Y 3
−X2
0
0
Y 4
Y 3
−X2
⎞
⎠,
and its determinant is −X3Y 9(Y −2X)2. Substituting into either of the equations
F = 0 and G = 0 gives the projective solutions (x, y, w) equal to (1, 0, 0), (0, 0, 1),
and (1, 2, 4 ± 4
√
2), up to nonzero scalar factors. (One has to check that both the
equations F = 0 and G = 0 are satisﬁed.)
9. Introduce a new indeterminate T = Yi −Zj, and remove Yi. Then R(F, G) =
R(Y1, . . . , T + Zj, . . . , Ym, Z1, . . . , Zn) is a polynomial in T , the Zj’s, and all the
Y’s except for Yi. Also, R(F, G) = 0 when T is set equal to 0. Hence R(F, G) is
divisible by T . Then (a) and (b) follow. For (c), the polynomials Yi −Zj are distinct
primes. Since each divides R(F, G), their product must divide. Their product has
the same degree as R(F, G), and the result follows.

698
Hints for Solutions of Problems
10. We may assume that K is algebraically closed and that f is monic, say with
f (X) = m
i=1 (X −ξi) and f ′(X) = m m−1
j=1 (X −ηj). Then the previous problem
gives f ′(ξi) = m m−1
j=1 (ξi −ηj), and
R( f, f ′) = mmcm,m−1

i, j
(ξi −ηj) = mmcm,m−1
m
i=1
f ′(ξi)
with cm,m−1 equal to the constant c from Problem 9c when n = m −1. According
to Section V.4, the product is (−1)n(n−1)/2) times the discriminant D( f ) of f . So the
result follows.
11. Replace G by G(X, Y, W) −(X2 + Y 2)F(X, Y, W) to get Y W H(X, Y, W),
where H(X, Y, W) = (X2 + Y 2)(X2 −3Y 2) −4X2Y W. Then
I (P, F ∩G) = I (P, F ∩Y W H) = I (P, F ∩Y) + I (P, F ∩W) + I (P, F ∩H).
For I (P, F ∩Y), we use the method of Section 4, looking at F(t, 0, 1), which is t4;
thus I (P, F ∩Y) = 4. Since P is not on W, I (P, F ∩W) = 0.
For I (P, F ∩H), replace H by H(X, Y, W) −F(X, Y, W) to get Y J(X, Y, W),
where J(X, Y, W) = −4X2Y −4Y 3 −7X2W + Y 2W. Then
I (P, F ∩H) = I (P, F ∩Y J) = I (P, F ∩Y) + I (P, F ∩J),
and again I (P, F ∩Y) = 4. If the local expressions of F and J are denoted by f
and j, then their lowest-order terms f3(x, y) and j2(x, y) are given by
f3(x, y) = 3x2y −y3 = y(
√
3 x + y)(
√
3 x −y),
j2(x, y) = −7x2 + y2 = −(
√
7 x + y)(
√
7 x −y).
Thus F and J have no tangent lines in common at P, and I (P, F ∩J) = 3 · 2 = 6.
Collecting the results, we ﬁnd that I (P, F ∩G) = 4 + 4 + 6 = 14.
12. Let P = [x0, y0, w0], and choose  ∈GL(3, K) with (x0, y0, w0) =
(0, 0, 1).
The local versions of G and L are g(X, Y) = G(−1(X, Y, 1)) and
l(X, Y) = L(−1(X, Y, 1)). The expansion of g as a sum of homogeneous poly-
nomials is g = gm + · · · + gd because m = m P(G) > 0, and l is of the form
l(X, Y) = aX +bY because P lies on L. We can parametrize l by ϕ(t) = (bt, −at),
and then the deﬁnition of intersection multiplicity is that I (P, L ∩G) is the least
integer k such that the expression gk(ϕ(t)) = tkgk(b, −a) is nonzero. The deﬁ-
nition of tangent line is any projective line Li whose local version li is one of the
factors of gm(X, Y) = c 
i (αi X + βiY)mi. Then gm(ϕ(t)) = tmgm(b, −a) =
c 
i (αib −βia)mi. If (a, b) is a multiple of some (αi, βi), then gm(ϕ(t)) = 0; hence
I (P, L ∩G) ≥m + 1. Otherwise gm(ϕ(t)) ̸= 0, and I (P, L ∩G) = m.

Chapter VIII
699
13. The linear span LT(I) of the members LT( f ) for f in I is a monomial ideal
and is of the form (M1, . . . , Mk) for suitable monomials Mj each of the form LM( fj)
for some fj in I. Then { f1, . . . , fk} is a subset of I such that

LT( f1), . . . , LT( fk)

=
LT(I), and { f1, . . . , fk} is a Gr¨obner basis of I by deﬁnition.
14. If α, β, γ are vectors of exponents in monomials such that the ﬁrst i with
w(i) · α ̸= w(i) · β has w(i) · α > w(i) · β, then it equally true that the ﬁrst i with
w(i) · (α + γ ) ̸= w(i) · (β + γ ) has w(i) · (α + γ ) > w(i) · (β + γ ). This proves that
property (i) of monomial orderings holds with no further conditions on the weights.
Property (ii) says for each vector α of nonnegative exponents not all 0 that the ﬁrst i
with w(i) · α ̸= 0 has w(i) · α > 0. Applying this condition as a necessary condition
to the jth standard basis vector α = ej, we see that the ﬁrst i such that w(i)
j
̸= 0 must
have w(i)
j
> 0 for (ii) to hold. On the other hand, if this condition holds for all j, then
a suitable positive linear combination of these conditions gives (ii) for any α.
15. In (a), a > a′ implies that Xa−a′ ≥X > Y b′ for all b′ ≥0. Multiplying
by Xa′ gives Xa > Xa′Y b′. Since Y b ≥1 implies XaY b ≥Xa, we conclude that
XaY b > Xa′Y b′ for all b and b′. For a = a′, we observe that b > b′ implies that
Y b−b′ > 1 and hence that Y b > Y b′. Multiplying by Xa gives XaY b > XaY b′. Hence
the ordering is lexicographic.
In(b), we observe that aninequality between Xa andY b impliesthe same inequality
between Xna and Y nb. Consequently the particular inequality for Xa and Y b depends
only on the rational number a/b. The assumption for (b) is that X < Y q, hence that
Xa ≤Y qa ≤Y b if qa ≤b, thus if a/b ≤q−1. Thus the set S of rationals a/b such
that Xa > Y b is bounded below by q−1. Let r−1 be the greatest lower bound of S. We
know then that q−1 ≤r−1, hence that r ≤q. So 0 ≤r < ∞, and r is a well-deﬁned
real number.
Suppose that u/v < r−1. Then u/v is not in S, and so Xu ≤Y v. In the reverse
direction, suppose that u/v > r−1.
Then there is some rational c/d in S with
u/v > c/d ≥r−1; this has Xc > Y d. Then Xud > Xvc > Y vd. Since d > 0,
Xu < Y v would imply Xud < Y vd, which is false. Thus we must have Xu > Y v.
This proves (b).
For (c), the only rational u/v for which the inequality between Xu and Y d is not
decided is u/v = r−1, and that only if r is rational. In this case a single weight vector
will decide the correct inequality. All other inequalities between monomials follow
from these. In fact, what needs deciding is the inequality between XaY b and Xa′Y b′
when a > a′ and b < b′, and this is the same as the inequality between Xa−a′ and
Y b′−b.
16. The formulas for f are a matter of computation. Both satisfy the conditions
of Proposition 8.20 because LM( f ) = X2Y is ≥each of LM((X + Y) f1) = X2Y,
LM(1 f2) = Y 2, LM(X f1) = X2Y, and LM((X + 1) f2) = XY 2 and because no term
of r1 or r2 is divisible by LM( f1) = XY or LM( f2) = Y 2.
17. In (a), we check that {X2 +cXY, XY} is a Gr¨obner basis using Theorem 8.23.
The leading monomials of the two generators are X2 and XY, and neither divides the

700
Hints for Solutions of Problems
other. Since the leading coefﬁcients are 1, this Gr¨obner basis is minimal.
In (b) when c ̸= 0, X2 + cXY has a nonzero term whose monomial is divisible by
the leading monomial of another generator; speciﬁcally the term cXY in X2 + cXY
is divisible by the XY from the other generator. Following the procedure in Theorem
8.28, we ﬁnd that {X2, XY} is the reduced Gr¨obner basis.
18. If (c1, . . . , cn) lies in VK(I), then cj is one of ﬁnitely many roots of Pj(X),
for each j. Hence |VK(I)| ≤n
j=1 deg Pj.
19. Fix j, and choose a polynomial Qj in X that vanishes at the jth coordinate of
every member of VK(I). Then Pj(X1, . . . , Xn) = Qj(X j) is a polynomial vanishing
on VK(I), and the Nullstellensatz shows that some power of it is in I. The result is a
polynomial in X j alone, as required.
20. If VK(I) is a ﬁnite set, then Problem 19 shows that I contains a nonconstant
polynomial in X j for each j. The leading monomial for the jth such polynomial has to
be a power of X j, and it lies in LT(I). Conversely suppose that a power X
lj
j lies in LT(I)
for each j. Form a reduced Gr¨obner basis of I. Since the only monomials dividing
X
lj
j are powers of X j, there exist members gj of the Gr¨obner basis for 1 ≤j ≤n
such that
gj(X1, . . . , Xn) = X
mj
j
+ X
mj−1
j
aj,mj−1 + · · · + X jaj,1 + aj,0
for suitable polynomials aj,mj−1, . . . , aj,0 in X j+1, . . . , Xn. Then VK(I) is contained
in VK((g1, . . . , gn)), and any member (c1, . . . , cn) of the latter has the property for
each j thatcj isarootofapolynomial ofdegreemj inonevariable, once(cj+1, . . . , cn)
is ﬁxed. Thus VK(I) is contained in a ﬁnite set and has to be ﬁnite.
21. For (a), the coefﬁcients ai1,...,in are given as in K(X), and we look for solutions
of F(T1, . . . , Tn) = 0. Clearing fractions in the coefﬁcients, we see that it is enough
to ﬁnd a solution when each ai1,...,in has denominator 1.
For (b), substitution of Ti = 	N
j=1 bi j X j, where each bi j is an unknown in K, into
the equation F(T1, . . . , Tn) = 0 gives
	
i1,...,in
ai1,...,in
 N	
j=1
bi j X ji1 · · ·
 N	
j=1
bi j X jin = 0.
We expand this out and set the coefﬁcient of each power of X equal to 0. The largest
possible power of X that can appear is the sum of the largest power of X in any ai1,...,in,
namely δ, and 	n
k=1 Nik. Since F is homogeneous of degree d, 	n
k=1 ik = d. Thus
the largest possible power of X is Nd + δ. We get one equation for each power of X
that appears, and the unknowns are the various bi j’s.
22. The number of equations is ≤Nd + δ + 1, since the powers of X go from 0 to
at most Nd +δ. The number of unknowns is one for each index i with 1 ≤i ≤n and
each possible power of X from 0 to N, hence exactly (N + 1)n. For N sufﬁciently
large we want to see that Nd + δ + 1 ≤(N + 1)n. Since d < n, the inequality in
question is δ + 1 −n ≤N(n −d), and this is satisﬁed by taking N large enough.

Chapter IX
701
23. In the context of Problem 22, we have a homogeneous system with more
unknowns than equations (for large N). If the number of unknowns is n + 1 and
the number of equations is m, then we are looking for solutions in Pn
K. Since the
inequality m ≤n is satisﬁed, the quoted theorem applies and produces a nonzero
solution for the bi j’s.
Chapter IX
1. For (a), we argue by contradiction. Suppose that c1(x), . . . , cn(x) are members
of k(x), not all 0, such that 	
j cj(x)tj = 0. Clearing fractions, we may assume that
each cj(x) lies in k[x]. If necessary, we can divide through by a power of x and
arrange that some cj(x), say cj0(x), has a nonzero constant term. The element x is
by assumption transcendental over k. Applying the substitution homomorphism of
k[x] into k given by evaluation at 0 yields 	
j cj(0)tj = 0. By the assumed linear
independence of t1, . . . , tn over k, cj(0) = 0 for all j. This contradicts the fact that
cj0(0) ̸= 0. Then (b) is immediate. For (c), we know that [F : k(x)] < ∞, and
therefore [k′(x) : k(x)] < ∞. By (b), [k′ : k] < ∞.
2. This is immediate from Proposition 7.15. Alternatively, here is a direct proof.
We may assume that the characteristic is p. It is enough to prove that if K is perfect
and L is a ﬁnite extension, then L is perfect. Arguing by contradiction, we may
assume that [L : K] is as small as possible among all counterexamples. The image
M of L under x 	→x p is a subﬁeld of L, and M contains K because K is perfect.
We cannot have M = L, since L is assumed not to be perfect. By construction of
L, M is perfect. Composing x 	→x p from L into M with x 	→x1/p from M into
itself, we obtain a ﬁeld map of L onto M that ﬁxes M. The result is a one-one M
linear transformation of the ﬁnite-dimensional M vector space L onto a proper vector
subspace, contradiction.
3. Let F be a function ﬁeld in one variable over k. Since k is perfect, Theorem
7.20 shows that F is separably generated. Let us write F = k(x1, . . . , xn). Theorem
7.18 shows that there is some xj such that F is a separable extension of k(xj). If we
write x for xj, then the Theorem of the Primitive Element shows that F = k(x)[y]
for some y algebraic over k(x). Put R = k[x][y] = k[x, y]; the ﬁeld of fractions of
R is F. Let g(x, Y) be the minimal polynomial of y over k(x). If d(x) is a common
denominator for the coefﬁcients of g(x, Y), then d(x) ̸= 0 because x is transcendental
over k. If we set f (X, Y) = d(X)g(X, Y), then f (x, y) = 0. Hence the substitution
homomorphism k[X, Y] →R given by replacing X by x and Y by y factors through
to a homomorphism ϕ carrying k[X, Y]/( f (X, Y)) onto R. The ring R is an integral
domain; hence the ideal ( f (X, Y)) is prime, and f (X, Y) is irreducible. We can ﬁnd
an ideal I in k[X, Y] containing ( f (X, Y)) such that ϕ descends to an isomorphism
of k[X, Y]/I onto R. This ideal I has to be prime, and we let J be a maximal ideal

702
Hints for Solutions of Problems
of k[X, Y] containing it. Then we have a chain of inclusions of prime ideals
0 ⫋( f (X, Y)) ⊆I ⊆J.
Theorem 7.22 shows that k[X, Y] has Krull dimension 2, and it follows that either
( f (X, Y)) = I in the above chain of inclusions, or I = J. The latter equality would
mean that I is maximal and therefore that R ∼= k[X, Y]/I is a ﬁeld; this is not the
case, and thus ( f (X, Y)) = I. Hence R ∼= k[X, Y]/( f (X, Y)). Here f (X, Y) is an
afﬁne plane curve irreducible over k, and the ﬁeld of fractions of R is by deﬁnition
the function ﬁeld of the curve; this ﬁeld is F, and the argument is complete.
4. The singular points are common zeros of f , ∂f
∂X , and ∂f
∂Y . If there are inﬁnitely
many, then Bezout’s Theorem says that f and ∂f
∂X have a nontrivial common factor,
and so do f and ∂f
∂Y . Since f is irreducible and the partial derivatives reduce degrees
in one or the other variable, we must have ∂f
∂X =
∂f
∂Y = 0 as polynomials. This is
impossible in characteristic 0. In characteristic p, the ﬁrst condition says that the
only powers of X that appear in f are powers of X p, and the second condition says
that the only powers of Y that appear are powers of Y p. The coefﬁcients of f are
powers of p because k is assumed perfect, and thus f is exhibited as a pth power, in
contradiction to its assumed irreducibility.
5.
Differentiate f (X, b) = (X −a) f1(X) and evaluate at (a, b) to obtain
∂f
∂X (a, b) = f1(a) + (a −a) f ′
1(a) = f1(a).
6. Multiplytheequation g(X, b) = (X−a)g1(X)by f1(X)andsubstitutetoobtain
g(X, b) f1(X) = f (X, b)g1(X). Then the function g(X, · ) f1(X) −f (X, · )g1(X)
is 0 at b and is of the form g(X, Y) f1(X) −f (X, Y)g1(X) = (Y −b)h1(X, Y),
where h1(X, Y) for each X is a polynomial in Y. Since (Y −b)h1(X, Y) is equal to a
polynomial in (X, Y), h1(X, Y) is a polynomial in (X, Y). To complete the problem,
evaluate both sides at (x, y), and use the facts that f (x, y) = 0 and that f1(x) ̸= 0.
7. Since F = k(x, y) is a function ﬁeld in one variable, it is enough to see that
y is transcendental over k. Arguing by contradiction, suppose that there is some
nonzero polynomial c(Y) in k[Y] having y as a root. As a polynomial in k[X, Y],
c(Y) maps to c(y) = 0 when we pass to the quotient in k[X, Y]/( f (X, Y)), and
therefore c(Y) is the product of f (X, Y) by a polynomial. On the other hand, ∂f
∂X is
not 0, and thus f (X, Y) depends nontrivially on X. Hence the product of f (X, Y)
and any nonzero polynomial in (X, Y) depends nontrivially on X, contradiction. The
result now follows from the observation at the end of Section 1.
8. Substituting a for x in the formula for g(x, y) gives
g(a, y) = (y −b)khk(a, y)/f1(a)k.
In this formula, hk(a, y) is a polynomial expression in y, hence also in y −b. Thus
v1 is ≥0 on it. The expression f1(a)k is a nonzero member of k, on which v1 takes
the value 0. Therefore
v1(g(a, y)) = kv1(y −b) + v1(hk(a, y)) ≥kv1(y −b).

Chapter IX
703
The left side is independent of k, and the right side is unbounded in k. Therefore
there is some upper bound to the values of k for which g(x, y) has an expansion of
the kind in question.
9. For (a), we cannot have hk(a, b) = 0 in Problem 8 for arbitrarily large k because
of the bound found in Problem 8. If k = n is the smallest k for which hk(a, b) ̸= 0,
then the displayed formula holds with h = hn. For uniqueness we substitute a for x
and see that g(a, y) = pn(y)(y−b)n for a polynomial pn with pn(b) ̸= 0. We cannot
have two such expressions involving distinct powers n because y is transcendental
over k.
For (b), we see from (a) that every nonzero member of R is of the required form
with n ≥0. Since F is the ﬁeld of fractions of R, the same thing is true for F as long
as we allow n to be arbitrary in Z.
For (c), if we have two such expressions, we set them equal, clear fractions, and
write the result as(y−b)k p(x, y) = q(x, y) for some k ≥0 and for some polynomials
p and q with p(a, b) ̸= 0 and q(a, b) ̸= 0. Substituting (a, b) for (x, y), we obtain 0
from (y −b)k p(x, y) unless k = 0, and we obtain something nonzero from q(x, y).
Therefore k = 0, and the required uniqueness follows.
10. From the deﬁnition we immediately have v(g) = +∞if and only if g = 0,
as well as v(gg′) = v(g) + v(g′) for all g and g′. We are to show that v(g + g′) ≥
min(v(g), v(g′)). Thus write g(x, y) = (y −b)nh1(x, y)/h2(x, y) and g′(x, y) =
(y −b)mh′
1(x, y)/h′
2(x, y) with n ≤m. Then min(v(g), v(g′)) = min(n, m) = n.
Also,
g + g′ = (y −b)n h1h′
2+(y−b)m−nh2h′
1
h2h′
2
.
The numerator of the displayed fraction is a polynomial and can be written in the
form of Problem 9a. Say that (y −b)k is the power of (y −b) that appears in it,
k being ≥0. Then v(g + g′) = n + k, and this is ≥n = min(v(g), v(g′)). The
assertions about the valuation ring and the valuation ideal are clear.
11. Let v′ be a second valuation having the stated properties. If g(x, y) is given
in F×, decompose g as in Problem 9b, and apply v′. Then we obtain v′(g(x, y)) =
nv′(y −b) + v′(h1(x, y)) −v′(h2(x, y)).
The assumptions on v′ show that
v′(h1(x, y)) = v′(h2(x, y)) = 0. Therefore
v′(g(x, y)) = nv′(y −b) = v′(y −b)v(g(x, y)),
and v′ = v′(y −b)v. By assumption, v′(y −b) is positive. Since v′ has to be onto
Z ∪{∞}, we must have v′(y −b) = 1.
12. For (a), the argument is the same as with Problem 7 except that the roles of
x and y are reversed. The partial derivative ∂(y2−f (x))
∂y
= 2y is not the 0 element
because the characteristic is not 2, and hence that earlier argument applies. Part (b)
is elementary ﬁeld theory, and (d) is a routine veriﬁcation.
For (c), let k′ be the subﬁeld of elements of F algebraic over k. Problem 1 shows
that [k′ : k] ≤[k′(x) : k(x)] ≤[F : k] = 2. Arguing by contradiction, suppose

704
Hints for Solutions of Problems
that {1, t} is a basis of k′ over k. let X2 + uX + v be the minimal polynomial of
t over k; t satisﬁes t2 + ut + v = 0. Problem 1a shows that t = a(x) + yb(x)
with b(x) ̸= 0, and then t satisﬁes t2 −2a(x)t + (a(x)2 −f (x)b(x)2) = 0. Hence
ut + v = −2a(x)t + (a(x)2 −f (x)b(x)2). If u ̸= −2a(x), then we can solve
for t and obtain the contradiction that t is in k(x). Thus u = −2a(x), and also
v = a(x)2 −f (x)b(x)2. Since x is transcendental over k, the ﬁrst of these shows that
a(x) does not involve x, i.e., a(x) lies in k. Then the second shows that f (x)b(x)2
lies in k, and unique factorization leads to the conclusion that f (x) and b(x) do not
depend on x. This contradicts the assumption that f (X) is nonconstant.
13. Let z = a(x) + yb(x) be in the integral closure. Then so is the image of z
under the nontrivial Galois group element σ, and so are z + σ(z) and zσ(z). The
latter elements are 2a(x) and a(x)2 −f (x)b(x)2. Thus a(x) is in the intersection of
the integral closure with k(x), which is k[x] because k[x] is a principal ideal domain
and is integrally closed. Then f (x)b(x)2 is in k[x] by the same argument. Since
f (x) is square free, it follows that b(x) is in k[x].
14. Part (a) is immediate from Corollary 6.6. Discrete valuations of F that are not
in DF play no role because of the inclusion k ⊆R: any discrete valuation that is ≥0
on R has to be 0 on k×, since the image of k× under the valuation is a subgroup of Z.
For (b), the condition for z ̸= 0 to be in p(x)∞is that v(z) ≥−p ordv(x)∞for all
v ∈DF. If a particular v has v(x) ≥0, then v does not contribute to (x)∞, and this
condition says that v(z) ≥0. By (a), z is in R.
15. For (a), let c(x) = cnxn + · · · + c0 = xn(cn + cn−1x−1 + · · · + c0x−n) with
cn ̸= 0. Then v(cn) = 0, and v(cjx j−n) > 0 for j < n. Hence
v

xn(cn + cn−1x−1 + · · · + c0x−n)

= nv(x) + v(cn + cn−1x−1 + · · · + c0x−n)
= nv(x) + v(cn) = nv(x).
For (b), 2v(y) = v(y2) = v( f (x)) = (deg f )v(x), the latter equality holding by (a).
In (c), we have
v(a(x) + yb(x)) ≥min

v(a(x)), v(yb(x))

= min

v(a(x)), v(y) + v(b(x))

= min

(deg a)v(x), ( 1
2 deg f + deg b)v(x)

= v(x) max

deg a, 1
2 deg f + deg b

≥pv(x).
16. Any v ∈DF with v(x) ≥0 has v(z) ≥0 = −ordv(x)∞on all elements
z = a(x) + yb(x) with a(x) and b(x) in k[x], by Problems 13 and 14a. Suppose
that v(x) < 0. Then Problem 15c and the assumptions on the degrees of a(x) and
b(x) shows that v(z) ≥pv(x) = −p ordv(x)∞. Hence (z) ≥−p(x)∞, and z lies in
L(p(x)∞).

Chapter IX
705
18. For (a), let σ be the nontrivial element of the Galois group. Problem 17c
shows that if z = a(x) + yb(x) is in L(p(x)∞), then so is σ(z) = a(x) −yb(x).
Hence any v ∈DF with v(x) < 0 has v(a(x) + yb(x)) ≥−p ordv(x)∞= pv(x)
and v(a(x) −yb(x)) ≥−p ordv(x)∞= pv(x). Consequently
v(a(x)) = v(2a(x)) ≥min

v(a(x) + yb(x)), v(a(x) −yb(x))

≥min

pv(x), pv(x)

= pv(x)
and
v

a(x)2 −f (x)b(x)2
= v(a(x) + yb(x)) + v(a(x) −yb(x)) ≥pv(x) + pv(x).
Using Problem 15a and the fact that v(x) < 0, we see from these two inequalities
that deg a ≤p and deg(a2 −f b2) ≤2p.
For (b), Problem 14b shows that L(p(x)∞) ⊆R, and Problem 13 shows that
R consists of all a(x) + yb(x) with a(x) and b(x) in k[x]. Part (a) thus shows that
deg a ≤p and deg(a2−f b2) ≤2p. Since deg a ≤p, the second of these inequalities
shows that deg f b2 ≤2p. Thus deg b + 1
2 deg f ≤p. In the reverse direction, if
a(x) and b(x) are polynomials satisfying the degree relations, then Problem 16 shows
that a(x) + yb(x) is in L(p(x)∞).
19. The polynomials a(x) and b(x) are limited only by the restrictions on their
degrees. From deg a ≤p, we get a space of dimension p+1. From deg b+ 1
2 deg f ≤
p, we have deg b ≤

p−1
2 deg f

, and we get a space of dimension

p−1
2 deg f

+1
if

p −1
2 deg f

≥0. Thus
ℓ(p(x)∞) = (p + 1) +

p −1
2 deg f

+ 1
= 2p + 2 +

−1
2 deg f

= 2p + 2 −
 1
2(1 + deg f )

if p ≥−

−1
2 deg f

= +
 1
2(1 + deg f

.
20. Part (a) is immediate from Theorem 9.3, since [F : k(x)] = 2. For (b), Theo-
rem 9.9 and Problem 19, in combination with the result of (a), show for sufﬁciently
large positive p that
1 −g = ℓ

p(x)∞

−p deg(x)∞= 2p + 2 −
 1
2(1 + deg f

−2p.
Hence g =
 1
2(1 + deg f

−1.
21. Let  : k(X)[Y] →k(X)[Z] be the substitution homomorphism that ﬁxes
k(X) and has (Y) = g(X)Z, and follow it with the quotient homomorphism to
k(X)[Z]/(Z2 −h(X)). Then
(Y 2 −f (X)) = g(X)2Z2 −f (X) = g(X)2(Z2 −h(X)),
which goes to 0 in the quotient. Thus the composition of  followed by the quotient
map descends to a ﬁeld map ϕ : k(X)[Y]/(Y 2 −f (X)) →k(X)[Z]/(Z2 −h(X)).
The inverse is constructed in the same way, starting from the formula (Z) =
g(X)−1Y.

706
Hints for Solutions of Problems
22. For (a), the conclusion genus 1 when there are no repeated roots is immediate
from Problem 20b with deg f = 3. If there are repeated roots, then we can write
f (X) = g(X)2h(X) with deg g = deg h = 1. Applying Problem 21, we see that the
genus is the same as for Problem 20b with deg f = 1, i.e., the genus is 0.
For (b), a singularity occurs only at points (x, y) of the zero locus in k2
alg at which
both ﬁrst partials are 0. Then 2Y = 0, which says that y = 0 because the characteristic
is not 2, and f ′(X) = 0, which says that x is a root in kalg of both f (X) and f ′(X).
This means that x is at least a double root in kalg of f (X).
23. The residue class degree fv is 1, since k is algebraically closed. Thus deg nv =
n. Corollary 9.4 gives ℓ(0v) = 1, Corollaries 9.22 and 9.23 together give ℓ(1v) = 1
if g ≥1, and Corollary 9.19 gives ℓ((2g −1)v) = deg((2g −1)v) + (1 −g) =
(2g −1) + (1 −g) = g and ℓ(2gv) = deg(2gv) + (1 −g) = g + 1. The inequality
ℓ(nv) ≤ℓ((n + 1)v) ≤ℓ(nv) + 1 follows by combining Theorem 9.6, the fact that
A ≤B implies L(A) ⊆L(B), and the fact that fv = 1.
24. For each n ≥0,
L(nv) = {0} ∪{x ∈F× | −(x)∞≥−nv} = {0} ∪{x ∈F× | (x)∞≤nv}.
Thus n ≥1 is a gap if and only if ℓ(nv) = ℓ((n −1)v), and otherwise ℓ(nv) =
ℓ((n −1)v) + 1 by the last fact in Problem 23.
Suppose that there are m gaps in passing from ℓ(0v) to ℓ(2gv). In the process we
take 2g steps from (n −1)v to nv, of which m are gaps and 2g −m are nongaps. (The
gaps are certain of these integersn, 1 ≤n ≤2g.) Since ℓ(0v) = 1 and ℓ(2gv) = g+1
by Problem 23, the total number of nongaps is (g + 1) −1 = g. Solving 2g −m = g
gives m = g. The formulas ℓ((2g −1)v) = g and ℓ(2gv) = g + 1 from Problem 23
show that 2g is not a gap.
25. For (a), if the gap sequence is (1, 2, . . . , g), then 1 = ℓ(0v) = ℓ(1v) =
ℓ(2v) = · · · = ℓ(gv). Conversely if the gap sequence is something else, let n with
1 ≤n ≤g be the ﬁrst nongap; then 1 = ℓ(0v) = · · · = ℓ((n−1)v) < ℓ(nv) ≤ℓ(gv).
For (b), Problem 23 gives ℓ(0v) = ℓ(1v) = 1 if g ≥1, and thus 1 is a gap.
For (c), there are no integers strictly between 0 and 2g if g = 1, and the only such
integer for g = 1 is 1. Part (b) shows that the gap sequence is indeed (1) if g = 1,
and thus the gap sequence is always the standard one.
For (d), we have some x and y in F× with (x)∞= rv and (y)∞= sv. Thus
(x) = (x)0 −rv and (y) = (y)0 −sv, and (xy) = (x)0 + (y0) −(r + s)v. Since v
does not contribute to (x)0 and (y)0, (xy)∞= (r + s)v, and thus r + s is a nongap.
For (e), if 2 is a nongap, then iteration of (d) shows that 2, 4, 6, . . . , 2g −2 are
nongaps. The only possible gaps are the remaining integers from 1 to 2g −1, namely
1, 3, 5, . . . , 2g −1. There are g of these, and so all of them must be gaps.

Chapter X
707
Chapter X
1. If F is in I (P), expand F as a sum of homogeneous terms F = 	∞
d=0 Fd.
Then 0 = F(tx0, . . . , txn) = 	∞
d=0 Fd(tx0, . . . , txn) = 	∞
d=0 Fd(x0, . . . , xn)td for
all t ∈k×. Since k is inﬁnite, every coefﬁcient of this polynomial in t is 0. Thus
each Fd is in I (P), and I (P) is generated by homogeneous elements.
2. In each part we argue by contradiction. For (a), if {Xα} is a system of nonempty
closed subsets of X with the ﬁnite intersection property such that 
α Xα = ∅, then
we can inductively deﬁne a strictly decreasing sequence of ﬁnite intersections of the
Xα’s, in contradiction to the Noetherian property. In (b), if E is a closed irreducible
subset that is not connected, then E = U ∪V with U and V nonempty, disjoint, and
relatively open. Then E = U c ∪V c contradicts the irreducibility of E.
3. For (a), the continuous image of a connected set is connected. Continuity is
by Proposition 10.32, and connectedness is by Problem 2b applied to the Noetherian
topological space V . For (b), if f is any polynomial function on An, then f ◦ϕ is
in O(V ) because ϕ is a morphism, and f ◦ϕ is constant by Corollary 10.31. Then
ϕ cannot have two distinct points in its image, since any two points in An can be
distinguished by some polynomial.
4. Certainly O(U) ⊇k[X, Y]. Also, the function ﬁeld k(U) consists of all
quotients of polynomials a/b with a and b in k[X, Y] and b ̸= 0. Thus suppose that
f = a/b lies in O(U). By unique factorization in k[X, Y], we may assume that a
and b are relatively prime. In the expression f = a/b, regularity at P implies that
b(P) ̸= 0 because an equality a/b = c/d of two such expressions implies that a = kc
and b = kd for some nonzero scalar k. Since f is regular everywhere in A2 except
possibly at the origin, b(X, Y) is nonvanishing away from the origin. However, if
b is nonconstant, then V (b) is a curve and has dimension 1, whereas the origin has
dimension 0. We conclude that b is constant, and f = a/b is in k[X, Y].
5. Arguing by contradiction, let ϕ : W →U be an isomorphism from an afﬁne
variety onto U. Then the map ϕ : O(U) →O(W) = A(W) given by ϕ( f ) = f ◦ϕ is
an isomorphism. Let ι : U →A2 be the inclusion. The corresponding map on regular
functions isι : A(A2) →O(U) given byι(h)(x, y) = h(x, y) for (x, y) ̸= (0, 0),
and it is an isomorphism by Problem 4. Then (ϕ ◦ι) = ι ◦ϕ is an isomorphism
of A(A2) onto A(W). Its inverse has to be of the form 
ψ with 
ψ(g) = g ◦ψ for
some isomorphism ψ : A2 →W, according to Theorem 10.38. Since 
ψ ◦ϕ ◦ι is the
identity map on A(A2), ι ◦ϕ ◦ψ is the identity map on A2. Using the deﬁnition of ι
shows that ϕ ◦ψ(x, y) = (x, y) for (x, y) ̸= (0, 0). Thus ϕ ◦ψ is an isomorphism of
A2 onto U that is the identity on U. This is a contradiction, since there is no possible
image for (0, 0) under ϕ ◦ψ that makes ϕ ◦ψ one-one.
6. Let ϕ be the rational map of the irreducible curve C into the irreducible curve
C′, and let (E, ϕE) be a morphism in the class ϕ. If ϕ is not dominant, then ϕE(E)
is a proper closed subset of C′ and must be ﬁnite. Hence ϕE(E) is ﬁnite. The set E
is connected by Problem 2b, and morphisms are continuous by deﬁnition. Therefore

708
Hints for Solutions of Problems
ϕE(E) is connected. Being connected and ﬁnite, it is a singleton set {y}. If ϕC is
deﬁned as everywhere equal to y on C, then (C, ϕC) is in the equivalence class ϕ. So
ϕ is constant.
7. Suppose that f is a member of Oϕ(P)(V ) with ϕ∗
P( f ) = 0. Since the set on
which f ∈k(V ) is regular is open, there exists an open neighborhood E of ϕ(P) on
which f is deﬁned. The morphism ϕ is continuous, and thus ϕ−1(E) is open in U.
Since ϕ is a morphism and f is regular on E, f ◦ϕ is regular on ϕ−1(E). According
to the proof of Proposition 10.42, ϕ∗
P( f ) is deﬁned to be the unique member of k(V )
that agrees with f ◦ϕ on ϕ−1(E). We are assuming ϕ∗
P( f ) to be 0, and thus f ◦ϕ
equals 0 on ϕ−1(E). By dominance of ϕ, ϕ(ϕ−1(E)) is a dense subset of E. Thus
the continuous function f is 0 on a dense subset of its domain E and is 0.
8. The inclusion (W X −Y Z) ⊆(X, Z) yields a homomorphism ϕ of A(V ) onto
k[W, X, Y, Z]/(X, Z) ∼= k[W, Y]. Let b′ = ϕ(¯b). Then b′(w, y) = ¯b(w, 0, y, 0)
is a polynomial in (w, y) nonzero in the complement of the origin. The solution
of Problem 4 shows that b′(0, 0) ̸= 0. Thus ¯b(0, 0, 0, 0) ̸= 0, and f is deﬁned at
(0, 0, 0, 0). In view of the discussion of this example in Section 4, f is everywhere
deﬁned. Therefore it is in O(V ), which equals A(V ) because V is an afﬁne variety.
Thus there is a polynomial g in k[W, X, Y, Z] whose image ¯g in A(V ) equals X/Y.
Then Y ¯g = X, and Yg = X +(W X −Y Z)h for some polynomial h. So Y(g+hZ) =
X(1 + Wh). This implies that Y divides 1 + Wh, which we see is impossible by
evaluating at the origin.
9. The equivalence of continuity of ϕ and continuity of all ϕα will be taken as
known. Suppose that ϕ : U →V is a morphism. Let an index α, an open set E ⊆Vα,
and a member f of O(E) be given. We are to show that f ◦ϕα is in O(ϕ−1
α (E)).
Since ϕ is a morphism and E is open in V , we know that f ◦ϕ is in O(ϕ−1(E)). By
restriction, f ◦ϕα is in O(Uα ∩ϕ−1(E)) = O(ϕ−1
α (E)). Thus ϕα is a morphism.
In the reverse direction suppose that all ϕα : Uα →Vα are morphisms. Let E
be open in V , and let f be in O(E). We are to show that f ◦ϕ is in O(ϕ−1(E)).
Since ϕ−1(E) = 
α (Uα ∩ϕ−1(E)), it is enough to prove regularity of f ◦ϕ on each
Uα ∩ϕ−1(E). On this open set, f ◦ϕ equals f ◦ϕα, which is regular because ϕα is
a morphism. Thus ϕ is a morphism.
10. For (a), we use the equivalence of regularity with the condition in Proposition
10.28. Thus regularity at P in U means that there is a subneighborhood U0 of U
within V about P such that f equals a quotient ¯a/¯b on U0 with ¯a and ¯b in A(V ) and
with ¯b nowhere vanishing on U0. Choose polynomials a and b in k[X1, . . . , Xn] that
restrict to ¯a and ¯b on V . Let U ′
0 be an open subset of An whose intersection with V
is U0. Since b is nowhere 0 on U0 and is continuous on U ′
0, the subset 
U0 of U1 on
which b is nonvanishing is open and contains U0. Then Proposition 10.28 shows that
F = a/b is a member of O(
U0) whose restriction to U0 equals f .
For (b), the result of (a) is local. Thus we can immediately allow V to be quasi-
afﬁne. UsingProposition10.37, wecanextend(a)tothe case that V isquasiprojective.

Chapter X
709
11. Continuity is no problem. For the condition involving regularity, we use
Problem 10. Let E be a relatively open set in V , and let f be in O(E). We are to
show that f ◦ϕ is in O(ϕ−1(E)). Thus let P be in ϕ−1(E) ⊆U; then ϕ(P) is in
E ⊆V . Since f is in O(E), Problem 10 produces a relatively open neighborhood E0
of ϕ(P), an open subset E0 of Y with E0 ∩V = E0, and a function F in O(E0) such
that F

E0 = f

E0. Since ϕ : X →Y is a morphism, F ◦ϕ is in O(ϕ−1(E0)). Since
ϕ(ϕ−1(E0) ∩U) ⊆E0 ∩V = E0, F ◦ϕ agrees with f ◦ϕ on ϕ−1(E0) ∩U. Thus
f ◦ϕ has an extension F ◦ϕ from ϕ−1(E0) ∩U to ϕ−1(E0) that is in O(E0). The
quotients that exhibit F ◦ϕ as deﬁned at points of ϕ−1(E0)∩U exhibit f ◦ϕ as deﬁned
there. The inclusion ϕ−1(E0) = ϕ−1(E0 ∩V ) = ϕ−1(E0)∩ϕ−1(V ) ⊆ϕ−1(E0)∩U
shows that f ◦ϕ is in O(ϕ−1(E0)). This being true for all P in ϕ−1(E), f ◦ϕ is in
O(ϕ−1(E)).
12. Part (a) follows by applying instances of Problem 11 to ϕ and ϕ−1. Then
(b) follows by another application of Problem 11.
Part (c) follows by inductive
application of (b).
13. Let di be the degree of homogeneity of Fi. Then the ith row of the right-hand
matrix is λdi−1 times the ith row of the left-hand matrix. Hence the dimension of the
span of the rows is the same for the two matrices, and this number is the rank.
14. This comes down to the fact that differentiating with respect to X j for j > 0 and
then setting X0 equal to 1 is the same as setting X0 equal to 1 and then differentiating
with respect to X j.
15. For any of the functions Fi, the right side of the formula in Euler’s Theorem is 0
at (x0, . . . , xn) by assumption. Hence Euler’s Theorem gives x0
∂Fi
∂X0 (x0, . . . , xn) =
−	n
j=1 xj
∂Fi
∂X j (x0, . . . , xn). This says that
x0 × 0th column of J(F)(x0, . . . , xn) = −
n	
j=1
xj × jth column of J(F)(x0, . . . , xn).
Since x0 ̸= 0, this is a relation of the required type.
16. Problem 13 shows that the left side equals rank J(F)(1, x1/x0, . . . , xn/x0),
which Problem 15 shows to be equal to the rank of the matrix formed from the last n
columns, which Problem 14 shows to be equal to the rank of J( f )(x1/x0, . . . , xn/x0).
18. Regard the elements wi j as the entries of a matrix. The given condition is
that every 2-by-2 subdeterminant of this matrix equals 0. The matrix is not 0, and
consequently its rank is 1. Every matrix over k of rank 1 is of the form xyt for column
vectors x and y, and then [{wi j}] is exhibited as σ

[{xi}], [{yj}]

.
19. For (a), one suitable monomial ordering is the lexicographic ordering that
takes the elements Wi j in the order W00, W01, . . . , Wmn with W00 largest. Given a
monomial M′ of total degree d, choose among all monomials of total degree d the
smallest one in the ordering that is congruent to M′ modulo a. Write M = 
i, j W
ai j
i j .
If ai j > 0 and if there exists (k,l) with l > j, k > i, and akl > 0, then Wi jWkl divides

710
Hints for Solutions of Problems
M. Write M0 = M/Wi jWkl. Put M′′ = M0WilWkj. Since Wi jWkl −WilWkj is in
a, M′′ is congruent to M modulo a. In the monomial ordering, all of the elements
Wkl, Wil, Wkj are smaller than Wi j. Therefore M′′ < M, in contradiction to the
minimality of M.
In (b), let the largest Wi j whose exponents in M and M′ are unequal be Wi0 j0. Let
the products of the powers of the strictly larger monomials be N and N ′, respectively.
It is enough to prove that ϕ(M/N) ̸= ϕ(M′/N ′). Then we have
M/N =

Wi j≤Wi0 j0
W
ai j
i j = W
ai0 j0
i0 j0

(i, j) with
i0<i or
(i0=i and j0< j)
W
ai j
i j
and a similar expression for M′/N ′. The minimality condition says that ai j = 0 if
i0 < i and j0 < j. Thus
M/N =


i0<i, j0≥j
W
ai j
i j


i0=i, j0≤j
W
ai j
i j

=
 
k>i0

l≤j0 W akl
kl
 
l≥j0 W
ai0l
i0l

,
and
ϕ(M/N) =
 
k>i0

l≤j0 Xakl
k Y akl
l
 
l≥j0 X
ai0l
i0 Y
ai0l
l

.
On the right side each pair of indices (k,l) occurs at most once. Thus an equality
ϕ(M/N) = ϕ(M′/N ′) would imply that akl = bkl for every (k,l). This proves (b).
In (c), we know that a ⊆ker ϕ. If equality fails, then there is a linear combination
	
r cr Mr of monomials in ker ϕ that is not in a. Applying (a), we may assume that
each Mr is reduced. Then 	
r crϕ(Mr) = 0. Each ϕ(Mr) is a monomial, and (b)
shows that the various monomials ϕ(Mr) are distinct. Since the set of monomials is
linearly independent, each cr is 0. Therefore 	
r cr Mr = 0, contradiction.
20. For (a), compute the kernel of the natural substitution homomorphism of
k[X0, . . . , Xm, Y0, . . . , Yn] into R[Y0, . . . , Yn]. For (b), let P = [y0, y1, . . . , yn],
p = I (U) ⊆k[X0, . . . , Xm], and q = I ({P} ⊆k[Y0, . . . , Yn]. The inside homo-
morphism has kernel a by Problem 19. The outside homomorphism takes X0, . . . , Xm
into R and takes each Yj to yj Z, where Z is an indeterminate; its kernel is isomorphic
to pq. The kernel of the composition is I (σ(U ×{P})), which is prime because R[Z]
is an integral domain.
21. See Fulton’s book, page 145.
22. See Fulton’s book, page 146.
23. For (a), Proposition 10.9 shows that I (V (I)) = (h(X, Y)) for an irreducible
polynomial h if dim V (I) = 1. The containment I ⊆I (V (I)) shows that each fj
has to be of the form fj = ajh for some aj in k[X, Y]. Since fj and h are irreducible,
aj has to be a scalar. Thus I = (h(X, Y)), and I is prime. For (b), one can take
I = (Y + X2, Y −X2), which has V (I) = {(0, 0)} and which is not prime because
it contains X2 but not X.

Chapter X
711
24. Let {g1, . . . , gs} be a minimal Gr¨obner basis, and suppose that gj = ab is a
nontrivialfactorizationofgj ink[X1, . . . , Xn]. Since I isprime, wemayassumethata
lies in I. Then LM(gj) = LM(a) LM(b), and LM(a) lies in LT(I). Since {g1, . . . , gs} is
a Gr¨obner basis, LM(a) lies in the monomial ideal (LM(g1), . . . , LM(gs)). By Lemma
8.17, LM(gi) divides LM(a) for some i. It follows that LM(gi) divides LM(gj). Since
the Gr¨obner basis is minimal, i = j. That is, LM(gi) = LM(a) = LM(gj). Thus
LM(b) = 1, in contradiction to the assumption that the factorization of gj is nontrivial.
25. Identify a11X2 + 2a12XY + a22Y 2 + 2a13X Z + 2a23Y Z + a33Z2 with the
symmetric matrix
A =
 a11 a12 a13
a12 a22 a23
a13 a23 a33

.
By the Principal Axis Theorem choose an invertible matrix M such that A′ = Mt AM
is diagonal.
Put
 X′
Y ′
Z′

= M−1
 X
Y
Z

and substitute.
Then the given quadratic
polynomial equals αX′ 2 + βY ′ 2 + γ Z′ 2, where α, β, γ are the diagonal entries of
A′. If αβγ = 0, this is reducible; it is readily checked to be irreducible if αβγ ̸= 0.
Since αβγ = det A′ = (det M)2 det A, the reducible polynomials correspond to the
afﬁne hypersurface on which det A = 0.
26. The ﬁrst conclusion is a special case of Corollary 9.19. Then take x to be
a nonconstant member of L(2vO), and take y to be a member of L(3vO) not in the
linear span of {1, x}. Corollary 9.22 shows that (x)∞= 2, and then the equality
(y)∞= 3 follows from the deﬁnitions.
27. These are special cases of Theorem 9.3.
28. Since 2 = [k(E) : k(x)] = [k(E) : k(x, y)] [k(x, y) : k(x)], the integer
[k(E) : k(x, y)] divides 2. The corresponding equality with 3 and k(y) shows that
[k(E) : k(x, y)] divides 3. Therefore [k(E) : k(x, y)] = 1.
29. The values of vO on the seven listed members of k(E) are 0, 2, 3, 4, 5, 6, 6,
respectively. The members are all in L(6vO), which has dimension 6 by Problem 28,
and thus the listed members are linearly dependent. If y2 or x3 does not contribute
to this dependence, then vO takes distinct values on the remaining six members of
L(6vO), and Problem 19a at the end of Chapter VI gives a contradiction. Hence the
coefﬁcients b and c of y2 and x3, respectively, are nonzero. If x and y are replaced by
−bcx and bc2y and if the linear combination of terms is then divided by b3c4, then
the linear dependence takes the form (y2+a1xy+a3x)−(x3+a2x2+a4x +a6) = 0,
as required. Hence ϕ carries E −{0} into C ∩A2.
30. Certainly f (X, Y) is not divisible by any nonconstant polynomial in X. Thus
the only possible reducibility is of the form f (X, Y) = (Y + p(X))(Y + q(X)).
Expanding out the right side shows that
p(X) + q(X) = a1X + a3,
p(X)q(X) = −(X3 + a2X2 + a4X + a6).

712
Hints for Solutions of Problems
The second equation shows that at least one of p(X) and q(X) has degree > 1, and
then the ﬁrst equation shows that deg p(X) = deg q(X). But this equality would
mean that deg p(X)q(X) is even, contradiction. Hence f (X, Y) is irreducible.
31. The function ϕ is a morphism of E −{O} into C ∩A2 by Lemma 10.39, and
the composition with β0 is a morphism into P2. Then ϕ is a morphism of E −{O}
into C by Problem 11. The class of (E −{O}, ϕ) is therefore a rational map of E
into C, and Corollary 10.54 shows that ϕ extends to a morphism  : E →C.
32. Let  : k(C) →k(E) be the ﬁeld mapping that corresponds to  under
Theorem 10.45. The ﬁeld k(C) is generated by the functions x0 and y0 that pick
out the coordinates of points of C ∩A2, and Theorem 10.45 shows that (x0) =
(class of x0 ◦ϕ). For P in E −{O}, this has (x0)(P) = x0(ϕ(P)) = x(P), i.e.,
(x0) = x. Similarly (y0) = y. Therefore (k(C)) = k(x, y). By Problem 28,
 is onto k(E). By Corollary 10.46,  is birational.
33. The homogeneous polynomial of degree 3 from which f (X, Y) arises is
F(X, Y, W) = (Y 2W + a1XY W + a3Y W 2) −(X3 + a2X2W + a4XW 2 + a6W 3).
The points of C on the line at inﬁnity arise by setting W = 0 and F(X, Y, W) =
0 simultaneously, and the only such point is [0, 1, 0].
Computation shows that
∂F
∂W (0, 1, 0) = 1. Consequently [0, 1, 0] is a nonsingular point of C.
34. A point (x0, y0) in A2 is a singular point of C if and only if f (x0, y0) =
∂f
∂X (x0, y0) = ∂f
∂Y (x0, y0) = 0. At (x0, y0), computation shows that
∂2 f
∂X2 = −6X −2a2,
∂2 f
∂X∂Y = a1,
∂2 f
∂Y 2 = 2,
∂3
∂X3 = −6.
All higher-order derivatives are 0. Application of Taylor’s formula about (x0, y0)
therefore gives
f (X, Y) = (−3x0 −a2)(X −x0)2 + a1(X −x0)(Y −y0) + (Y −y0)2 −(X −x0)3.
We put X = x and Y = y, taking into account that f (x, y) = 0. After division by
(x −x0)2, the result is that
((y −y0)(x −x0)−1)2 + a1(y −y0)(x −x0)−1 = (3x0 + a2) + (x −x0).
That is, z2 + a1z = (3x0 + a2) + (x −x0). Suppose that P is in E −{O} and that
vP(z) < 0. Then we have vP(z + a1) < 0 and
0 ≤vP

(3x0 + a2) + (x −x0)

= vP(z2 + a1z) = vP(z) + vP(z + a1) < 0,
contradiction. Therefore vP(z) ≥0. Meanwhile, vO(x −x0) = vO(x) = −2 and
vO(y −y0) = v0(y) = −3. Hence vO(z) = (−3) −(−2) = −1.
35. Corollary 9.22 shows that no member of k(E) has the properties of z found
in Problem 34. Thus C is nonsingular at every (x0, y0). In combination with Prob-
lem 33, this shows that C is everywhere nonsingular. By Corollary 10.55,  is an
isomorphism.

SELECTED REFERENCES
Artin, E., Theory of Algebraic Numbers, notes by Gerhard W¨urges, George Striker,
G¨ottingen, 1959.
Artin, E., C. J. Nesbitt, and R. M. Thrall, Rings with Minimum Condition, University
of Michigan Press, Ann Arbor, 1944.
Atiyah, M. F., and I. G. Macdonald, Introduction to Commutative Algebra, Addison-
Wesley Publishing Company, Reading, MA, 1969.
Borevich, Z. I., and I. R. Shafarevich, Number Theory, Academic Press, New York,
1966.
Brieskorn, E., and H. Kn¨orrer, Plane Algebraic Curves, Birkh¨auser, Basel, 1986.
Brown, K. S., Cohmology of Groups, Springer-Verlag, New York, 1982.
Buchberger, B. and F. Winkler (eds.), Gr¨obner Bases and Applications, Cambridge
University Press, Cambridge, 1998.
Buell, D. A., Binary Quadratic Forms, Springer-Verlag, New York, 1989.
Cartan, H., and S. Eilenberg, Homological Algebra, Princeton University Press,
Princeton, 1956.
Cassels, J. W. S., Rational Quadratic Forms, Academic Press, London, 1978.
Cassels, J. W. S., and A. Fr¨ohlich (eds.), Algebraic Number Theory, Academic Press,
London, 1967.
Cohn, H., A Classical Invitation to Algebraic Numbers and Class Fields, Springer-
Verlag, New York, 1978.
Cox, D. A., Primes of the Form x2 + ny2, John Wiley & Sons, New York, 1989.
Cox, D., J. Little, and D. O’Shea, Ideals, Varieties, and Algorithms, Springer-Verlag,
New York, 1992.
Dirichlet, P. G. L., Lectures on Number Theory, supplements by R. Dedekind, English
translation of the original German, American Mathematical Society, Provi-
dence, 1999.
Dummit, D. S., and R. M. Foote, Abstract Algebra, Prentice Hall, Englewood Cliffs,
NJ, 1991; second edition, Upper Saddle River, NJ, 1999; third edition, John
Wiley & Sons, Hoboken, NJ, 2004.
Eisenbud, D., Commutative Algebra with a View Toward Algebraic Geometry,
Springer-Verlag, New York, 1995.
Eisenbud, D., and J. Harris, The Geometry of Schemes, Springer-Verlag, New York,
2000.
Fabrizio, Tutorial on Groebner basis for a polynomial ideal, 2001, online as of 2007,
http://www.geocities.com/capecanaveral/hall/3131.
713

714
Selected References
Farb, B., and R. K. Dennis, Noncommutative Algebra, Springer-Verlag, New York,
1993.
Farkas, H. M., and I. Kra, Riemann Surfaces, Springer-Verlag, New York, 1980;
second edition, 1992.
Freyd, P., Abelian Categories: An Introduction to the Theory of Functors, Harper and
Row, New York, 1964.
Fr¨ohlich, A., and M. J. Taylor, Algebraic Number Theory, Cambridge University
Press, Cambridge, 1991.
Fulton, W., Algebraic Curves: An Introduction to Algebraic Geometry, Addison-
Wesley Publishing Company, Redwood City, CA, 1989; originally published
by W. A. Benjamin, Inc., New York, 1969, and reprinted in 1974.
Gauss, C. F., Disquisitiones Arithmeticae, English translation of the original Latin,
Springer-Verlag, New York, 1986.
Grifﬁths, P. A., Introduction to Algebraic Curves, American Mathematical Society,
Providence, 1989.
Gunning, R. C., Introduction to Holomorphic Functions of Several Variables, Vol-
ume III: Homological Theory, Wadsworth &Brooks/Cole, Paciﬁc Grove, CA,
1990.
Hall, M., The Theory of Groups, The Macmillan Company, New York, 1959.
Hardy, G. H., and E. M. Wright, An Introduction to the Theory of Numbers, Clarendon
Press, Oxford, 1938; second edition, 1945; third edition, 1954; fourth edition,
1960; ﬁfth edition, 1979.
Harris, J., Algebraic Geometry: A First Course, Springer-Verlag, New York, 1992;
reprinted with corrections, 1995.
Hartshorne, R., Algebraic Geometry, Springer-Verlag, New York, 1977.
Hasse, H., Number Theory, English translation of the original German, Springer-
Verlag, Berlin, 1980; reprinted, 2002.
Hecke, E., Lectures on the Theory of Algebraic Numbers, English translation of the
original German, Springer-Verlag, New York, 1981.
Hilton, P. J., and U. Stammbach, A Course in Homological Algebra, Springer-Verlag,
New York, 1971; second edition, 1997.
Hua, L.-K., Introduction to Number Theory, English translation of the original Chi-
nese, Springer-Verlag, Berlin, 1982.
Hungerford, T. W., Algebra, Holt, Rinehart and Winston, New York, 1974; reprinted,
Springer-Verlag, New York, 1980; reprinted with corrections, 1996.
Ireland, K., and M. Rosen A Classical Introduction to Modern Number Theory,
Springer-Verlag, New York, 1982; second edition, 1990.
Jacobson, N., Basic Algebra, Volume I, W. H. Freeman and Co., San Francisco,
1974; second edition, New York, 1985. Volume II, W. H. Freeman and Co.,
San Francisco, 1980; second edition, New York, 1989.
Jacobson, N., Lectures in Abstract Algebra, Volume I, D. Van Nostrand Company,
Inc., Princeton, 1951; reprinted, Springer-Verlag, New York, 1975. Volume II,
D. Van Nostrand Company, Inc., Princeton, 1953; reprinted, Springer-Verlag,

Selected References
715
New York, 1975. Volume III, D. Van Nostrand Company, Inc., Princeton,
1964; reprinted, Springer-Verlag, New York, 1975.
Jacobson, N., Structure of Rings, American Mathematical Society, Providence, 1956;
revised edition, 1964.
Jacobson, N., The Theory of Rings, American Mathematical Society, New York, 1943;
multiple reprintings, American Mathematical Society, Providence.
Knapp, A. W., Elliptic Curves, Princeton University Press, Princeton, 1992.
Knapp, A. W., Basic Real Analysis, Birkh¨auser, Boston, 2005.
Knapp, A. W., Advanced Real Analysis, Birkh¨auser, Boston, 2005.
Knapp, A. W., Basic Algebra, Birkh¨auser, Boston, 2006.
Knapp, A. W., and D. A. Vogan, Cohomological Induction and Unitary Representa-
tions, Princeton University Press, Princeton, 1995.
Lam, T. Y., A First Course in Noncommutative Rings, Springer-Verlag, New York,
1991; second edition, 2001.
Lang, S., Algebra, Addison-Wesley, Reading, MA, 1965; second edition, 1984; third
edition, 1993; revised third edition, Springer, New York, 2002.
Lang, S., Algebraic Number Theory, Addison-Wesley, Reading, MA, 1970; reprinted,
Springer-Verlag, New York, 1986; second edition, 1994.
Lang,S.,IntroductiontoAlgebraicandAbelianFunctions,Addison-Wesley,Reading,
MA, 1972; second edition, Springer-Verlag, New York, 1982; reprinted, 1995.
Mac Lane, S., Categories for the Working Mathematician, Springer, New York, 1971;
second edition, 1998.
Macdonald, I. G., Algebraic Geometry: Introduction to Schemes, W. A. Benjamin,
Inc., New York, 1968.
Massey, W. S., Singular Homology Theory, Springer-Verlag, New York, 1980.
Matsumura, H., Commutative Algebra, W. A. Benjamin, Inc., New York, 1970; second
edition, Benjamin-Cummings, Reading, MA, 1980.
Matsumura, H., Commutative Ring Theory, Cambridge University Press, Cambridge,
1986; reprinted with corrections, 1989.
Muir, T., The Theory of Determinants in the Historical Order of Development,
Volume I, Macmillan, London, 1906; Volume II, 1911; Volume III, 1920;
Volume IV, 1923; Volume V, 1929. Reprint of Volumes I–II, Dover Publica-
tions, New York, 1960; reprint of Volumes III–IV, 1960.
Mumford, D., The Red Book of Varieties and Schemes, Lecture Notes in Mathematics,
Volume 1358, Springer-Verlag, Berlin, 1988; second expanded edition, 1999.
Niven, I., and H. S. Zuckerman, An Introduction to the Theory of Numbers, John
Wiley & Sons, New York, 1960; second edition, 1966; third edition, 1972;
fourth edition, 1980; ﬁfth edition, with H. L. Montgomery, 1991.
Reid, M., Undergraduate Algebraic Geometry, Cambridge University Press, Cam-
bridge, 1988.
Rotman, J. J., Notes on Homological Algebras, Van Nostrand Reinhold Company,
New York, 1970.

716
Selected References
Rudin, W., Principles of Mathematical Analysis, McGraw–Hill Book Company, New
York, 1953; second edition, 1964; third edition 1976.
St. Andrews, School of Mathematics and Statistics, University of St. Andrews, Scot-
land, MacTutor History of Mathematics Archive, Biographies of Mathemati-
cians, http://www-groups.dcs.st-and.ac.uk
for
background,
http://www-history.mcs.st-and.ac.uk/history
for
entry
point,
http://www-history.mcs.st-and.ac.uk/history/
BiogIndex.html for indices of biographies of mathematicians, updated
as of 2007,
Serre, J.-P., Alg`ebre Locale, Multiplicit´es, second edition, Lecture Notes in Mathe-
matics, Volume 11, Springer-Verlag, Berlin, 1965.
Serre, J.-P., A Course in Arithmetic, Springer-Verlag, New York, 1973.
Serre, J.-P., Local Fields, Springer-Verlag, New York, 1979.
Shafarevich, I. R., Basic Algebraic Geometry, Springer-Verlag, Berlin, 1977; second
edition, published as two volumes, 1994.
Silverman, J. H., The Arithmetic of Elliptic Curves, Springer-Verlag, New York, 1986.
Statistics and Computation Service, Information Technology Central Services, Uni-
versity of Michigan, Ideal Theory and Gr¨obner Bases, updated as of 2007,
http://www.umich.edu/∼gpcc/scs/magma/text833.htm.
Ueno, K., An Introduction to Algebraic Geometry, American Mathematical Society,
Providence, 1997.
Van der Waerden, B. L., Modern Algebra, English translation of the original German,
Volume I, Frederick Ungar Publishing Co., New York, 1949. Volume II,
Frederick Ungar Publishing Co., New York, 1950.
Villa Salvador, G. D., Topics in the Theory of Algebraic Function Fields, Birkh¨auser,
Boston, 2006.
Walker, R. J., Algebraic Curves, Princeton University Press, Princeton, 1950;
reprinted, Dover Publications, New York, 1962; reprinted, Springer-Verlag,
New York, 1978.
Weil, A., Basic Number Theory, Springer-Verlag, New York, 1967; second edition,
1973; third edition, 1974; reprinted, 1995.
Weil, A., Number Theory: An Approach through History: From Hammurapi to
Legendre, Birkh¨auser, Boston, 1984; reprinted, 2007.
Zariski, O., and P. Samuel, Commutative Algebra, Volume I, D. Van Nostrand Co.,
Inc., Princeton, 1958; reprinted, Springer-Verlag, New York, 1975. Volume II,
D. Van Nostrand Co., Inc., Princeton, 1960; reprinted, Springer-Verlag, New
York, 1976.

INDEX OF NOTATION
This list indexes recurring symbols introduced in Chapters I through X (pages
1–648).
For recurring symbols introduced in Basic Algebra, see the list of
Notation and Terminology on pages xxi–xxiv. Some of the latter notation has
been repeated here for the reader’s convenience.
In the list below, each piece of notation is regarded as having a key symbol.
The ﬁrst group consists of those items for which the key symbol is a ﬁxed Latin
letter, and the items are arranged roughly alphabetically by that key symbol. The
next group consists of those items for which the key symbol is a Greek letter. The
ﬁnal group consists of those items for which the key symbol is a variable or a
nonletter, and these are arranged by type. To locate an item below, ﬁrst proceed
on the assumption that the key symbol is a Latin or Greek letter; if the item does
not appear to be in the list, then treat it as if its key symbol is a variable or a letter.
A, AK, 389, 559
An, An
K, 455, 559
A(K, Gal(K/F), a), 137
AF, 542, 543
A∗
F, 542, 543
A(V ), 579
A, 570
Ad, 570
A(V ), 584
A(V )d, 585
Kalg, 434
aϕ, 639
B(F), 126
B(K/F), 127
C, 330
C(a), 620
CR, 169
C(V (a)), 633
CF, 532, 549
CF,0, 534
Ec, complement, xxi
coimage f, 240
coker f, 175
D(ξ), 279
D(K/F), 372
DF, 532, 549
DF,0, 534
DK, 267
D(), 267
Diff(F), 547
Div(ω), 548
d−1, 194
dn, 153
X = {(Xn, dn)}∞
n=−∞, 174
dim R, 424
Extn
R(A, B), 223
ei, fi, g, 275, 354
⟨ej1, . . . , ejk⟩, 619
extn
R(A, B), 223
Fq[[X]], 347
Fq((X)), 347
Fp, 346
717

718
Index of Notation
Frq, 437
fv, 533
G P, 368
Gal(F2, F1), 434
≤GLEX, ≤GREVLEX, 494
g,
538
gx, 538
H(s, a), 633
Ha(s, a), 621, 626
H(s, a), 633
Ha(s, a), 625, 628
Hj, 620
Hn(X), 153, 172
H n(X), 153, 174
H∗(X), 172
H ∗(X), 174
Hn(G, M), 209
H n(G, M), 147
HomR(A, B), 169
h(D), 7, 14
hK, 299
I, IK, 390
I1, 390
I, 330, 393, 576
I, 576
I = (r1,r2), 38
I = ⟨r1,r1⟩, 38
I (E), 560, 571
I (P, F ∩G), 474
I (P, L ∩F), 467
image f, 240
J(ξ), 272
K(S), 409
K(E), 412
k, 528, 559
k(V ), 580, 585
k′, 531
L(A), 544
L(A), 535
L(s, χ), 63
LCM(Xα, Xβ), 501
Log, 289
LM( f ), LC( f ), LT( f ), 496
LT(I), 497
≤LEX, 493
ℓ(A), 536
lim←, 439
M, 493, 620
MP, 600
Mx, 431
mP, 600
mx, 431
m P(F), 474
N(I), 39, 273
NA/F( · ), 165
NK/F( · ), norm, xxiv
NrdA/F( · ), 165
O(U), 580, 582, 587, 641
OP(U), 582, 587
OP(V ), 580, 585
Ro, opposite ring, xxii
ordv(A), 532
P2, 456
Pn, 457, 570
Pn
K, 457
P, 330, 393
PF, 532, 549
Pv, 322, 533
Qp, 316, 318
R( f, g), 451
R( f, g), 451
R( f1, F), 514
Rp, 346
Rv, 322, 533
Rx, 431
Residue, 542
Residuep(v), 541
r1, r2, 348, 383
rad A, 79
S( f1, f2), 502

Index of Notation
719
S∞, 391
S−1R, localization, xxiv
Spec A, 639
(Spec A, O), 641
Ksep, 434
TorR
n (A, B), 224
TrA/F( · ), 165
TrK/F( · ), trace, xxiv
TrrdA/F( · ), 165
At, transpose, xxi
torR
n (A, B), 224
tr. deg R, 424
V (C), VK(C), 455–456
V (I), 429
V (S), 559, 571
V ( f1, . . . , fk), 559
VF, 532
vP( · ), 321
v∞, 328
X(S), 388
Xα, 494, 620
xj(P), 559
Z(), 268
Zp, 318
 Z, 437
ZG, integral group ring, xxiii
Greek
αi, 369
β0, 574
βt
0, 574
βi, 369, 575
δ(A), 543
δi j, Kronecker δ, xxi
ε, 149, 195
ηi, 369
ι, 390, 391
σ, 617, 646
σ1, . . . , σn, 283, 383
χ0, 62
ω, 185, 547
Functors given by subscripts
and superscripts
R×, units, xxiv
RP, localization, xxiv
X+, 194
MG, invariants, 208
MG, coinvariants, 208
 
M, dual fractional ideal, 372
Mp, 376
L, 460
Speciﬁc functions
α = (α1, . . . , αn), multi-index, 494
|α|, 620
a
p

, Legendre symbol, 8
m
n

, Jacobi sysmbol, 68
[K : F], degree, xxiv
| · |p, 316
| · |, absolute value, 331
∥· ∥, norm, 356
(x)0, (x)∞, 532
Isolated symbols
∼, Brauer equivalent, 124
≃, homotopic, 154
∂n, 153, 172
∂−1, 194
′, restricted direct product, 388
Operations on sets and classes
RG, group algebra, xxiii
√
I , radical, 405
K[X1, . . . , Xn+1]d, 458
A
u→B, morphism, 235
Miscellaneous
(x), principal divisor, 532
(xi)i∈I, 388

720
Index of Notation
I = (r1,r2), generated ideal, 38
I = ⟨r1,r2⟩, 38
[x, y, w], point in P2, 459
[x0, . . . , xn], point in Pn, 570
ϕ = {(E, ϕE)}, rational map, 595
X = {(Xn, ∂n)}∞
n=−∞, 171
(F, | · |F ), valued ﬁeld, 342
{O(U), ρVU}, presheaf, 640

INDEX
Abel, 521
abelian category, 238
abelian group
divisible, 196
torsion, 169
abelian Lie algebra, 78
absolute discriminant, 35, 267
absolute norm of ideal, 39, 273
absolute value, 289, 331
archimedean, 289
discrete, 338
of idele, 390
nontrivial, 332
normalized, 383, 384, 385, 386
trivial, 331
acyclic resolution, 219
additive category, 233
additive functor, 170, 178
adele, 389
adjoint, 252
afﬁne algebraic set, 559
dimension of, 566
irreducible, 563
afﬁne coordinate ring, 579
afﬁne curve, irreducible, 529
afﬁne Hilbert function, 621, 626
afﬁne Hilbert polynomial, 625, 628
afﬁne hypersurface, irreducible, 430, 562
afﬁne local coordinates, 461
afﬁne n-space, 455, 559
afﬁne plane curve, 455
irreducible, 430, 524, 562
afﬁne plane line, 455
afﬁne scheme, 642
afﬁne variety, 429, 562
algebra, xxiii
abelian Lie, 78
central, 111
central simple, 111
crossed-product, 137
cyclic, 122, 162, 163
generalized quaternion, 121
Lie, 77
polynomial, 164
semisimple, 80
semisimple Lie, 78
simple, 80
simple Lie, 79
solvable Lie, 78
Weyl, 85
algebraic closure, separable, 434
algebraic set
afﬁne, 559
irreducible afﬁne, 563
projective, 571
algebraically independent, 409
aligned primitive forms, 25
archimedean, 331, 333, 348
archimedean absolute value, 289
archimedean place, 383
archimedean valuation, 289
Artin product formula, 387, 390, 395
Artin reciprocity, 265
Artin’s Theorem, 89
Artinian ring, 87
associated prime ideal, 446
associated translation, 622
associated vector subspace, 622
associative algebra
semisimple, 80
simple, 80
augmentation map, 149
Baer, 168
base ﬁeld, 327
base space, 640
Bayer–Stillman ordering, 494
Bezout, 449
721

722
Index
Bezout’s Theorem, 453, 465, 471, 488
bidegree, 617
bifunctor, 223
bihomogeneous polynomial, 617
binary quadratic form, 3, 12
similar, 74
birational, 595
birational map, 595
birationally equivalent, 595
Blichfeldt, 293
boundary, 172
boundary map, 172
boundary operator, 172
bounded sequence, 317
bracket, 78
Brauer equivalent, 124
Brauer group, 126
relative, 127
Buchberger, 450
Buchberger’s algorithm, 506
canonical class, 551
canonical divisor, 551
Cartan, E., 79
Cartan, H., 168
category
abelian, 238
additive, 233
good, 169
Cauchy sequence, 317
Cayley, 77
central algebra, 111
central simple algebra, 111
centralizer, 114
chain complex, 171
in abelian category, 240
double, 257
tensor product for, 258
chain map, 154, 155, 173
character
Dirichlet, 62
genus, 74
multiplicative, 61
principal Dirichlet, 62
Chase, 141
Chevalley, 165, 168
Chinese Remainder Theorem, xxiii, 30, 69,
106, 314, 341, 367, 480, 483
class ﬁeld, Hilbert, 265
class ﬁeld theory, 265
class group
form, 28
ideal, 42, 265, 299, 330
idele, 393
class number, 299, 393
Dirichlet, 7, 14
co-invariant, 209
co-invariants functor, 209
coboundary, 174
coboundary map, 174
coboundary operator, 174
cochain complex, 173
cochain map, 154, 174
cocycle, 174
codomain of morphism, 232
cohomology, 153, 174
sheaf, 168, 171, 218, 643
coimage in abelian category, 239
cokernel, 175
of morphism, 236
universal mapping property, 236
common discriminant divisor, 272
common index divisor, 272, 287, 310, 371
commutator ideal, 78
complete presheaf, 641
complete valued ﬁeld, 343
equal-characteristic case, 398
unequal-characteristic case, 398
completion, 342
universal mapping property of, 343
complex, 171
in abelian category, 240
chain, 171
cochain, 173
double, 257
ﬂat, 259
complex place, 383
composition formula, 24
condition (C1), 165, 518
cone, 572, 633
conic, 458
conjugate, 266, 288, 383
connecting homomorphism, 185, 187
connecting morphism in abelian category, 248
convergent inﬁnite product, 51
convergent sequence, 317

Index
723
coordinate, 455, 559
afﬁne local, 461
coordinate hyperplane, 620
coordinate ring
afﬁne, 579
homogeneous, 584
coordinate subspace, 619
coproduct, xxiii
correspondence, one-one, xxi
countable, xxi
Cramer, 448
Cramer’s paradox, 449
Cramer’s rule, 448
crossed-product algebra, 137
cubic, 458
twisted, 562
cubic extension, pure, 280
cubic number ﬁeld, 279
cubical singular chain, 172
cubical singular homology, 172
cup product, 256
curve
afﬁne plane, 455
elliptic, 648
irreducible, 604
irreducible afﬁne, 529
irreducible afﬁne plane, 430, 524, 562
projective plane, 458
cycle, 172
cyclic algebra, 122, 162, 163
cyclotomic ﬁeld, 309
decomposition group, 368
Dedekind, 77
Dedekind Discriminant Theorem, 275, 371,
379, 381
Dedekind domain, xxiv, 266
extension of, xxiv, 327, 417
Dedekind example, 287, 310
Dedekind’s Theorem on Differents, 376
deﬁned at a point, 580, 585
degenerate, 172
degree, 153
of divisor, 533
of inseparability, 415
residue class, 275, 354, 533
total, 457
transcendence, 413
derived functor, 204
formation of, 205
long exact sequence, 209, 214
Dickson, 122
different, 279
relative, 279, 372
differential, 543, 547
differential form, 541
dimension
of afﬁne algebraic set, 566
of afﬁne variety, 563
geometric, 565
Krull, 424, 528, 529, 564
of zero locus, 423
Diophantus, 1
direct product, restricted, 388
direct sum in additive category, 233
directed set, 438
Dirichlet, 2, 24, 77
Dirichlet box principle, 297
Dirichlet character modulo m, 62
Dirichlet class number, 7, 14
Dirichlet L function, 63
Dirichlet pigeonhole principle, 297
Dirichlet series, 56
Dirichlet Unit Theorem, 290, 292, 384, 390,
395
Dirichlet’s Theorem, 7, 50
discrete, 290
discrete absolute value, 338
discrete valuation, 322
deﬁned over k, 529
discriminant, 12
absolute, 35, 267
of commutative semisimple algebra, 382
ﬁeld, 35, 264, 267
fundamental, 33
of ordered basis, 267
relative, 275, 381
discriminant divisor, 272
divisible abelian group, 196
divisible module, 251
division algorithm, generalized, 499
divisor, 532
principal, 532
divisor class, 532, 549
domain of morphism, 232
dominant rational map, 595

724
Index
Double Centralizer Theorem, 115
double chain complex, 257
dual of fractional ideal, 372
Eckmann, 168
Eilenberg, 168
Eisenstein, 12
Eisenstein polynomial, 402
elimination ideal, 512
Elimination Theorem, 512
elimination type ordering, 494, 512
elliptic curve, 648
enough injectives, 202
enough projectives, 202
epi, 233
epimorphism, 233
equal-characteristic case, 398
equivalence class of forms
ordinary, 13
proper, 13
equivalence of
absolute values, 333
completions, 383
forms, 13, 32
improper, 13
proper, 13, 32
ideals, 40, 298
narrow, 40
strict, 40, 298
morphisms, 242
Euler, 1, 3, 9, 50
Euler product, 50, 54, 60
ﬁrst-degree, 60
Euler’s Theorem, 516, 646
exact complex, 175
exact functor, 179
left, 182
right, 183
exact on injectives, 222
exact on projectives, 222
exact sequence, 175
in abelian category, 240
long, 187, 188
short, 175
split, 200
Exchange Lemma, 412
Ext functor, 223
extension normal 435
extension
of Dedekind domain, xxiv, 327, 417
of integrally closed domain, 610
purely transcendental, 409
of valued ﬁeld, 358
Extension Theorem, 512
factor set, 133
trivial, 135
Fermat, 1, 3, 9
ﬁeld discriminant, 35, 264, 267
ﬁeld of formal Laurent series, 347
ﬁeld of fractions, xxiv
ﬁeld polynomial, 266
ﬁne sheaf, 218
ﬁniteness of class number, 390
ﬁrst-degree Euler product, 60
ﬂabby sheaf, 218
ﬂat complex, 259
ﬂat module, 256
form
binary quadratic, 3, 12
class group, 28
negative deﬁnite, 14
positive deﬁnite, 14
reduced primitive, 18, 21
forms, primitive aligned, 25
Fourier inversion formula for ﬁnite abelian
groups, 61
fractional ideal, 321
principal, 321
relative dual, 372
free resolution, 152, 195
Freudenthal, 168
Frobenius element, 437
Frobenius’s Theorem about division algebras
over the reals, 118, 160
function ﬁeld, 419, 528, 580, 582, 585, 587
in one variable, 326, 382, 528, 529
in r variables, 419
functor
additive, 170, 178
co-invariants, 209
derived, 204
exact, 179
Ext, 223
global-sections, 218
homology-of-groups, 209

Index
725
invariants, 208
left exact, 182
right exact, 183
Tor, 224
functorial, 177
functoriality
with long exact sequence, 191
of long exact sequence of derived functors,
215, 218
with snake diagram, 190
fundamental discriminant, 33
fundamental parallelotope, 293
Fundamental Theorem of Galois Theory, 443
fundamental unit, 36, 288
Galois, 77
Galois group, 434
gap sequence, 557
Gauss, 1, 3, 9, 24, 77
Gauss’s group, 5, 28
Gelfand, 348
generalized division algorithm, 499
generalized quaternion algebra, 121
generalized resultant, 514
genus, 32, 539, 556, 557
principal, 33
genus character, 74
genus group, 33, 70, 73
geometric dimension, 565
germ, 584
global ﬁeld, 382
global-sections functor, 218
good category, 169
graded lexicographic ordering, 493
graded monomial ordering, 627
graded reverse lexicographic ordering, 494
Grothendieck, 638
Gr¨obner, 450
Gr¨obner basis, 450, 497, 564
minimal, 508
reduced, 509
Haar measure, 385
Halphen, 450
Hamilton, 77
Hensel, 279
Hensel’s Lemma, 349, 351, 353, 399
Herstein, 130
Hilbert, 404
Hilbert Basis Theorem, xxiv, 491, 560
Hilbert class ﬁeld, 265
Hilbert function, 633
afﬁne, 621, 626
Hilbert polynomial, 633
afﬁne, 625, 628
Hilbert’s Theorem 90, 71, 145
homogeneous coordinate ring, 584
homogeneous ideal, 458
homogeneous member of homogeneous
coordinate ring, 585
homogeneous Nullstellensatz, 572
homogeneous polynomial, 457
homology, 153, 172
cubical singular, 172
simplicial, 172
homology-of-groups functor, 209
homomorphism, 78
connecting, 185, 187
inﬂation, 254
restriction, 254
of valued ﬁeld, 342
homotopic, 154, 173, 174, 193, 198
homotopy, 173, 174, 193, 198
Hopf, H., 167
Hopkins, 92
Hurewicz, 167
hyperplane coordinate, 620
hypersurface, irreducible afﬁne, 430, 562
hypersurface, irreducible projective, 573
ideal
fractional, 321
in Lie algebra, 078
principal fractional, 321
valuation, 322
ideal class group, 42, 265, 299, 330
idele, 390
idele class group, 393
idempotent, 91, 369
primitive, 369
image in abelian category, 239
Implicit Function Theorem, 428, 600
improper equivalence of forms, 13
independent, algebraically, 409
index, 272
ramiﬁcation, 275, 354

726
Index
inertia group, 370
inertia subﬁeld, 368
inﬂation homomorphism, 254
inﬂation-restriction sequence, 254
injective, 195
in abelian category, 241
injective module, 195
injective resolution, 199, 205
inseparable element, 414
integral closure, xxiv, 610
integral domain, xxiii
integral element, xxiv
integrally closed, xxiv
intersection multiplicity, 467, 474
intersection number, 467
invariant, 208
invariants functor, 208
inverse limit, 439
standard, 439
inverse system, 438
irreducible afﬁne algebraic set, 563
irreducible afﬁne curve, 529
irreducible afﬁne hypersurface, 430, 562
irreducible afﬁne plane curve, 430, 524, 562
irreducible closed set, 564, 573
irreducible curve, 604
irreducible element, xxiii
irreducible ideal, 446
irreducible projective hypersurface, 573
irredundant, 446
isomorphic idempotents, 97
isomorphism, 78
of valued ﬁeld, 342
of varieties, 591
Jacobi, 521
Jacobi identity, 78
Jacobi symbol, 68
Jacobson radical, 89
kernel of morphism, 235
universal mapping property, 235
Koszul, 168
Kronecker, 77
Krull dimension, 424, 528, 529, 564
Kummer, 77
Kummer’s criterion, 275
K¨unneth Theorem, 258
Lagrange, 1, 4
Langlands reciprocity, 265
largest domain, 583, 595
Lasker–Noether Decomposition Theorem, 446,
639
lattice, 290
Law of Quadratic Reciprocity, 3, 8
least common multiple, 501
left adjoint, 252
left Artinian ring, 87
left exact functor, 182
left Noetherian ring, 87
left semisimple ring, 81
Legendre, 1, 4
Legendre symbol, 8
Leibniz, 7
Leray, 168
Levi, E. E., 79
lexicographic ordering, 493
Lie algebra, 77
abelian, 78
semisimple, 78
simple, 79
solvable, 78
Lie subalgebra, 78
line
afﬁne plane, 455
at inﬁnity, 459
projective, 458
Liouville, 521
local expression, 462
local morphism, 642
local ring, xxiv
local ring at a point, 580, 582, 585, 587
local/global approach, 371
localization, xxiv
locus of common zeros, 429, 559, 571
long exact sequence, 187, 188
functoriality with, 191
of derived functors, 209, 214
functoriality with, 215, 218
Mac Lane, 168, 420
Macaulay, 627
maps of a good category, 169
matrix units, 101
member in abelian category, 242
minimal Gr¨obner basis, 508

Index
727
Minkowski, 301, 302
Minkowski Lattice-Point Theorem, 293, 384
modules of a good category, 169
monic, 232
mono, 232
monomial, 457
reduced, 646
monomial ideal, 619
monomial ordering, 493
graded, 627
monomorphism, 232
morphism, 169
of afﬁne scheme, 642
local, 642
of ringed space, 642
of varieties, 591
multiplicative, 60
strictly, 60
multiplicative character, 61
multiplicity of a tangent line, 478
Nakayama’s Lemma, xxiii, 120, 605, 606
narrow equivalence of ideals, 40
natural, 177
negative, xxi
negatively oriented, 40
neighbor, 21
neighbor on the left, 21
neighbor on the right, 21
nil left ideal, 89
nilpotent element, 89, 446
nilpotent left ideal, 80, 90
Noether Normalization Lemma, 612
Noether–Jacobson Theorem, 130
Noetherian, xxiv
Noetherian ring, 87
Noetherian topological space, 564
nonarchimedean, 331, 335, 338
nonarchimedean place, 383
nonsingular curve, 604
nonsingular point, 429, 600, 601
nontrivial absolute value, 332
norm, 165, 356
of ideal, 39
absolute, 273
normal extension, 435
normalized absolute value, 383, 384, 385, 386
Nullstellensatz, 404, 561
homogeneous, 572
number ﬁeld, xxiv
cubic, 279
cyclotomic, 309
quadratic, 35, 69, 263, 269
Oka, 168
one-one correspondence, xxi
order, 532
order of vanishing, 474
ordering
Bayer–Stillman type, 494
graded lexicographic, 493
graded monomial, 627
graded reverse lexicographic, 494
k-elimination type, 494, 512
lexicographic, 493
monomial, 493
total, 493
from tuple of weight vectors, 494
ordinary equivalence class of forms, 13
oriented, 40
orthogonal idempotents, 97, 369
Ostrowski, 348
Ostrowski’s Theorem, 336
p-adic absolute value, 316
p-adic integer, 279, 318
p-adic integer, 346
p-adic metric, 316
p-adic number, 279, 316, 318
p-adic number, 346
parallelotope, 548
fundamental, 293
Peirce decomposition, 95
perfect ﬁeld, 418, 554
place, 383
plane, projective, 456
plane curve
afﬁne, 455
irreducible afﬁne, 430, 524, 562
projective, 458
plane line, afﬁne, 455
Pl¨ucker, 450
point, 455, 456, 459, 559
points at inﬁnity, 459
pole part, 537
pole set, 581, 585

728
Index
positive, xxi
positively oriented, 40
presheaf, 640
complete, 641
primary ideal, 445
prime element, xxiii
prime ideal, xxiii
associated, 446
primitive, 12
primitive form, reduced, 18, 21
primitive forms, aligned, 25
primitive idempotent, 369
primitively represent, 14
principal Dirichlet character, 62
principal divisor, 532
principal fractional ideal, 321
principal genus, 33
problem
ideal-equality, 510
ideal-membership, 507
proper-ideal, 507
product, xxiii
proﬁnite group, 441
projective, 192
projective algebraic set, 571
projective closure, 575
projective hypersurface, irreducible, 573
projective in abelian category, 241
projective limit, 439
projective line, 458
projective module, 192
projective n-space, 457, 570
projective plane, 456
projective plane curve, 458
projective resolution, 195, 205
projective transformation, 460
projective variety, 572
proper equivalence of
forms over Q, 32
forms over Z, 13
proper equivalence class of forms, 13
pullback, 242
pure cubic extension, 280
type of, 281
purely inseparable element, 415
purely inseparable extension, 416
purely transcendental extension, 409
pushout, 202, 243
quadratic form
binary, 3, 12
similar, 74
quadratic number ﬁeld, 35, 69, 263, 269
quadratic reciprocity, 3, 8, 68
quartic, 458
quasi-afﬁne variety, 568
quasiprojective variety, 573
quaternion algebra, 121
radical
of algebra, 80
of ideal, 405
Jacobson, 89
of Lie algebra, 78
Wedderburn–Artin, 89, 91
ramiﬁcation index, 275, 354
ramiﬁed, 367
ramify, 264, 275, 308
rational function, 580, 585
rational map, 595
dominant, 595
rational point, 455, 456, 457, 459
real place, 383
reciprocity
Artin, 265
Langlands, 265
quadratic, 3, 8, 68
reduced Gr¨obner basis, 509
reduced monomial, 646
reduced norm, 165
reduced polynomial, 165
reduced primitive form, 18, 21
reduced trace, 165
reducible ideal, 446
regular at a point, 580, 582, 585
regular function at a point, 587
regular function on an open set, 580, 582, 587,
641
regular point, 429
relative Brauer group, 127
relative different, 279, 372
relative discriminant, 275, 381
relative dual of fractional ideal, 372
represent, 14
primitively, 14
residue class degree, 275, 354, 533, 322
Residue Theorem, 543

Index
729
resolution, 194
acyclic, 219
free, 152, 195, 195
injective, 199, 205
projective, 205
standard, 149
restricted direct product, 388
restriction homomorphism, 254
resultant, 449, 451
generalized, 514
Riemann, 521
Riemann hypothesis, 530
Riemann sphere, 328
Riemann surface, 522
Riemann zeta function, 52, 58
Riemann’s inequality, 538
Riemann–Roch Theorem, 522, 551, 648
right adjoint, 252
right Artinian ring, 87
right exact functor, 183
right Noetherian ring, 87
right semisimple ring, 81
ring of formal power series, 347
ringed space, 642
S-polynomial, 502
scheme, 642
afﬁne, 642
deﬁned over a ring, 643
Schmidt, 422
Schreier, 168
Schur’s Lemma, 83
section, 640
Segre embedding, 617, 646
Segre variety, 617
semisimple associative algebra, 80
semisimple Lie algebra, 78
semisimple module, xxii
semisimple ring, 81, 84
separable algebraic closure, 434
separable element, 414
separable extension, 415
separable polynomial, 414
separable semisimple algebra over a ﬁeld, 109
separably generated extension, 419
separating transcendence basis, 419
sheaf, 168, 640
cohomology, 168, 171, 218, 643
ﬁne, 218
ﬂabby, 218
structure, 641
short exact sequence, 175
in abelian category, 241
similar binary quadratic forms, 74
simple associative algebra, 80
simple Lie algebra, 79
simple module, xxii, 80
simple ring, 85
simplicial homology, 172
singular cube, 172
singular homology, 172
singular point, 429, 600, 601
Skolem–Noether Theorem, 113
snake diagram, 185, 261
functoriality with, 190
Snake Lemma, 185, 248
solution of problem
ideal-equality, 510
ideal-membership, 507
proper-ideal, 507
solvable Lie algebra, 78
spectral sequence, 171
spectrum, 639
split, 127
split exact sequence, 200
splitting ﬁeld, 127
stalk, 640
standard inverse limit, 439
standard resolution, 149
standard subset, 622
Stickelberger’s condition, 309
Stone, 638
strict equivalence of ideals, 40, 298
strictly multiplicative, 60
strong approximation property, 374
Strong Approximation Theorem, 372, 390, 391
structure sheaf, 641
summation by parts, 56
tangent lines, 478
tensor product of
algebras, 104
chain complexes, 258
ﬁelds, 104
Theorem 90, Hilbert’s, 71, 145
Tor functor, 224

730
Index
Tornheim, 349
torsion abelian group, 169
torsion submodule, 257
total degree, 457
total ordering, 493
totally ramiﬁed, 367
trace, 165
transcendence basis, 409, 424
existence, 411
separating, 419
transcendence degree, 413
transcendence set, 409
translate of form, 26
triangular ring, 88
trivial absolute value, 331
trivial factor set, 135
twisted cubic, 562
type of pure cubic extension, 281
ultrametric inequality, 316, 331
unequal-characteristic case, 398
uniformizer, 323
uniformizing element, 323
unit, xxii, 36, 288
fundamental, 36, 288
unital, xxii
Universal Coefﬁcient Theorem, 261
universal mapping property of
completion of valued ﬁeld, 343
cokernel, 236
kernel, 235
unramiﬁed, 367
valuation, 322, 331
archimedean, 289
discrete, 322, 529
valuation ideal, 322
valuation ring, 322
valued ﬁeld, 342
complete, 343
extension of, 358
homomorphism of, 342
isomorphism of, 342
variety, 590
afﬁne, 429, 562
projective, 572
quasi-afﬁne, 568
quasiprojective, 573
as a scheme, 643
Segre, 617
Weak Approximation Theorem, 340, 374
Wedderburn, 79, 86, 164
Wedderburn’s Main Theorem, 94
Wedderburn’s Theorem about ﬁnite division
rings, 117, 160
Wedderburn’s Theorem about semisimple
rings, 83
Wedderburn–Artin radical, 89, 91
Weierstrass, 521
Weierstrass gap, 557
Weierstrass point, 557
Weierstrass valuation, 557
weight vectors, 494
Weil, 541, 543
Weyl algebra, 85
Zariski closure, 561, 578
Zariski topology, 560, 571
Zariski’s Theorem, 431, 525, 601
zero locus, 455, 559, 571
zero member, 245
zero morphism, 233
zero object, 233
zeta function, 530
Riemann, 52, 58

