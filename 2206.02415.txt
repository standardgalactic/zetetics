Quantitative theory of magnetic interactions in solids
Attila Szilva,1 Yaroslav Kvashnin,1 Evgeny A. Stepanov,2 Lars Nordström,3
Olle Eriksson,1, 4 Alexander I. Lichtenstein,5 and Mikhail I. Katsnelson6
1Department of Physics and Astronomy, Uppsala University, Box 516, SE-75120 Uppsala, Sweden
2CPHT, CNRS, Ecole Polytechnique, Institut Polytechnique de Paris, F-91128 Palaiseau, France
3Department of Physics and Astronomy, Division of Materials Theory,
Uppsala University, Box 516, SE-75120, Uppsala, Sweden
4School of Science and Technology, Örebro University
5Institut für Theoretische Physik, Universität Hamburg, Notkestraße 9 , 22607 Hamburg, Germany
6Institute for Molecules and Materials, Radboud University,
Heyendaalseweg 135, 6525 AJ, Nijmegen, The Netherlands
(Dated: June 7, 2022)
In this report we review the method of explicit calculations of interatomic exchange interactions
of magnetic materials. This involves exchange mechanisms normally refereed to as Heisenberg ex-
change, Dzyaloshinskii-Moriya interaction and anisotropic symmetric exchange.
The connection
between microscopic theories of the electronic structure, such as density functional theory or dy-
namical mean ﬁeld theory, and interatomic exchange is given in detail. The multiscale aspect of
extracting information for an eﬀective spin Hamiltonian that involves thousands of atoms, from elec-
tronic structure calculations considering signiﬁcantly fewer atoms (1-50) is highlighted. Examples
of exchange interactions of a large group of materials is presented, which involves heavy elements
of the 3d period, alloys between transition metals, Heusler compounds, multilayer systems as well
as overlayers and adatoms on a substrate, transition metal oxides, 4f elements, magnetic materials
in two dimensions and molecular magnets. Where possible, a comparison to experimental data is
made, which naturally becomes focused on the magnon dispersion. The inﬂuence of relativity is
reviewed for a few cases, as is the importance of dynamical correlations. Developments to theories
that handle out of equilibrium conditions is also described here.
The review ends with a short
description of extensions of the theories behind explicit calculations of interatomic exchange, to
non-magnetic situations, e.g. that describe chemical (charge) order and superconductivity.
I.
INTRODUCTION
The study of magnetism and magnetic materials is con-
nected to many ground breaking ﬁndings, where Nobel
Prize awarded results represent perhaps the most signif-
icant discoveries. The list of these ﬁndings include nat-
urally the invention of quantum theory of matter (Bohr
with a Nobel Prize in Physics 1922, Heisenberg with a
Nobel Prize in Physics 1932, Schrödinger and Dirac with
a Nobel Prize in Physics 1932), since magnetic phenom-
ena are naturally of quantum nature. This follows from
the success that quantum theory has had in describing
magnetism, but it can also be ascribed to the discovery
of a theorem of Bohr and van Leeuwen that demonstrates
that a classical treatment fails in describing any magnetic
properties at the thermal equilibrium, with classical mag-
netic susceptibility identically equal to zero [1]. Other
important discoveries relating to the understanding of
magnetism of materials is the nuclear magnetic resonance
(Bloch and Purcell, Nobel Prize in Physics 1952), Möss-
bauer eﬀect (Nobel Prize in Physics 1961), the discov-
ery of antiferromagnetism (Neel, Nobel Prize in Physics
1970), the theoretical studies of the electronic structure
of correlated magnetic materials (van Vleck, Mott and
Anderson, Nobel Prize in Physics 1977), the theory of
critical phenomena and phase transitions (Wilson, No-
bel Prize in Physics 1982), the development of the neu-
tron scattering technique (Brockhouse and Shull, Nobel
Prize in Physics 1994), the invention of density functional
theory (Kohn, Nobel Prize in Chemistry 1998), the dis-
covery of Giant Magnetoresistance (Fert and Grunberg,
Nobel Prize in Physics 2007), the theory of topological
phase transitions (Thouless, Haldane, and Kosterlitz, No-
bel Prize in Physics 2016), and most recently the theory
of spin glasses (Parisi, Nobel Prize in Physics 2021).
There are many textbooks covering the essentials of
magnetic materials and magnetic phenomena [1–14]. The
purpose of this review article is by no means an attempt
to cover what has already been described in detail in the
references mentioned above. Instead, the main ambition
of this work is to describe in detail how interatomic ex-
change interactions can be evaluated from ab-initio elec-
tronic structure theory, in a framework based on density
functional theory (DFT) [15, 16] and dynamical mean
ﬁeld theory (DMFT) [17–19]. The pioneering work that
this review focuses on, was published in 1984 [20], and
since then many important contributions have been made
to what is now a vibrant research ﬁeld, that include both
fundamental questions on the nature of the interatomic
exchange interaction but also involve practical investi-
gations in how to ﬁnd functional materials with tailor
made properties. The latter studies involve green energy
technologies, e.g. the attempt to ﬁnd permanent mag-
nets that do not contain the costly and (from mining
perspective) the environmentally troublesome rare-earth
metals, as well as to discover materials to be used in mag-
neto caloric devices [21, 22]. As this review will outline
arXiv:2206.02415v1  [cond-mat.mtrl-sci]  6 Jun 2022

2
in detail, it is possible to evaluate the interatomic ex-
change interaction between any pair of magnetic atoms
of a solid, from theoretical electronic structure calcula-
tions that considers atoms only within a primitive unit
cell. This is illustrated schematically in Fig.1, and the
capability of extracting information from one scale (that
of a conventional unit cell) to anther scale (that involves
thousands or even millions of atoms), is an important
step in realizing multiscale approaches for magnetism and
magnetization dynamics.
This review hence describes how to calculate the inter-
action term, Jij, of the celebrated Heisenberg Hamilto-
nian;
HH =
X
<ij>
Jij ⃗Si · ⃗Sj,
(1.1)
where the summation is made over pairs of atomic spins,
⃗Si, and how its relativistic generalization [23] allows to
evaluate the Dzyaloshinskii-Moriya (DM) interaction (of
vector form - ⃗Dij)[24] in;
HDM =
X
<ij>
⃗Dij ·

⃗Si × ⃗Sj

.
(1.2)
In fact, the steps described in this review, that are used to
derive an expression of interatomic exchange interactions,
can be seen as the most robust argument (or derivation)
for using the Heisenberg Hamiltonian (and its generaliza-
tions) to analyze magnetic phenomena, compared to the
original argument of Heisenberg and Dirac (described in
many textbooks, e.g. Refs.[1-3]), who considered a rather
simple system, that of a two electron system and the
energy diﬀerence between spin-singlet and spin-triplet
states (a derivation which is covered in most textbooks in
solid state physics). In fact, the connection between elec-
tronic structure information and interatomic exchange
interactions, pioneered in Ref. 20, can be seen as the
magnetic parallel to the quantum mechanical forces that
are available from the Hellmann-Feynman theorem. The
similarity extends also to their use; the interatomic ex-
change interactions can be used for torque minimization
to ﬁnd a ground state magnetic conﬁguration, similar to
the force minimization to obtain the geometrical mini-
mum of the nuclear position. Also, the use of a magnetic
torque for studies of dynamics of magnets (in so called
spin dynamics simulations [25]) is completely analogous
to the use of forces for molecular dynamics simulations.
It should be noted that coupled spin-lattice dynamics
simulations [25], involving both interatomic forces and
exchange, have also been described and used in practical
simulations [26].
This review outlines explicit calculations of exchange
parameters, where the term explicit implies that the pa-
rameters are obtained explicitly and directly once the
solution to a singular electronic structure calculation is
obtained [20, 27, 28]. This can be compared to implicit
approaches, where a Hamiltonian of the form used in
Eqs. (1.1) and (1.2) is used to ﬁt total energies obtained
Figure 1. Schematic illustration of the multiscale step of us-
ing information from electronic structure calculations consid-
ering the primitive unit cell (bright square) to evaluate the
exchange interaction, J, between two atomic spin-moments
(red arrows). Note that atomic magnetic moments are only
depicted for one pair of atoms, moments of other atoms are
not shown.
from electronic structure calculations, for a large number
of magnetic conﬁgurations. A third method that is fre-
quently employed, is to calculate in a DFT framework,
the total energies of spin-spiral conﬁgurations for sev-
eral wavelengths of the spin-spirals. In this way one can
obtain information of a reciprocal space representation
of the exchange, and after a Fourier transform, the real
space interatomic exchange paramaters are obtained [29–
35].
The
implicit,
often
called
cluster
expansion
ap-
proaches, as well as the spin-spiral approaches have been
used with success, but they are outside of the scope of
this review. We do however note a few key references
that have outlined the cluster expansion approach [36, 37]
and excellent treatises have covered the spin-spiral ap-
proach [29, 34, 35]. The focus of this review is, as men-
tioned, on the explicit approach of extracting intraatomic
exchange directly from a single electronic structure cal-
culation, and details in how this is done both formally
and practically are presented. We note that the method
introduced in Ref. 20 has its strengths in that it is a uni-
versal way to calculate exchange parameters of Eqs. (1.1)
and (1.2), in the sense that systems with or without
translation symmetry can be considered and that alloys
and compounds can be treated on equal footing. It also
oﬀers an orbital decomposition of the interactions, that
opens up for symmetry analysis from contributions be-
tween diﬀerent irreducible representations of the electron
states. It is also an excellent way to investigate general
trends of the exchange.
It should be noted that similar approaches as the
one reviewed here for the calculations of interatomic ex-
change, have been derived and used with success in other
ﬁelds of solid state science. Examples involve for instance
the chemical interaction between atomic species in alloys,
in a method referred to as the ”Generalized perturba-
tion theory”, ﬁrst presented in Ref. 38 (for a review see

3
Ref. 39), that is designed to calculate chemical interac-
tions in alloys. We will touch brieﬂy on this method in
Section X.
A.
A short description of the early history of
magnetism
Before continuing these introductory remarks, we make
here a short expose of the early historical discoveries of
magnetic phenomena. In ancient times it was known that
a type of stone which was found in northern Greece, close
to a place called Magnesia, could attract iron. Thales
of Milet (a Greek philosopher living in the 7’th century
B.C.) is documented to be aware of the mysterious and
invisible force these stones could have on iron [1, 40].
Other philosophers of the past that were attracted to
the apparently mysterious properties of these magnetic
minerals (later named Loadstone, where the magnetism
stems from Fe3O4) involve Plinus the elder and Lucretius,
both active in the ﬁrst century BC [40]. The name of
this ﬁrst discovered magnetic mineral comes from the
Lodestar (the pole star) which leads (or marks) the north-
ern direction [40].
The ﬁrst documented magnetic de-
vice used for establishing direction, the compass, is to
be found in a Chinese manuscript dated to the 11th cen-
tury [1], and it is indeed curious that this technology is
used widely even today, one thousand years later! Apart
from its use in navigation, these ﬁrst compasses were used
for construction of buildings and their alignment, in the
belief that they would be in harmony with the forces of
nature [40].
Other historical breakthroughs in the science of mag-
netism and magnetic materials involve Peter Peregrinus
(13th century B.C.) who undertook several experiments
with Loadstone, and discovered that a magnet has poles.
He in fact used the term “polus” to describe the north and
south end of a magnet [40]. Curiously, he is known for a
quote that “experience rather than argument is the basis
of certainty in science”, a principle most natural science
lives by today, which he realized over half a millennium
ago! Some three hundred years after the investigations
of Peter Peregrinus, the ﬁrst treatise of magnetism was
published by William Gilbert [40].
In his book, with
a title translated in English to ”On the Loadstone and
Magnetic Bodies and on the Great Magnet the Earth;
a New Physiology, Demonstrated by Many Arguments
and Experiments”, he presented, among many things, his
greatest realizations, that magnetism could be found to
disappear when the material was heated and that the
earth itself is magnetic [40].
The ﬁnal major historical leap in the science of mag-
netism, before the above mentioned development of quan-
tum mechanics, is the discovery of electromagnetism, one
of the greatest discoveries of the 19th century. This is
something that is covered in almost all textbooks on
physics, and is for this reason not discussed here fur-
ther.
We note however that from a practical point of
view, several discoveries made in the 19th century, con-
cerning magnetic materials, now form a ﬁrm basis for
technologies used to propel our society. To mention con-
crete examples, Faradays induction law, which allows to
convert mechanical energy to electricity, is used in all
power plants. Also, the development of electrical motors,
which becomes more and more a standard technology for
motorized vehicles, has performance based on a magnetic
ﬁeld strength [21, 22]. A ﬁnal example is that of magnetic
refrigeration, and the principle of adiabatic demagneti-
sation, that is considerably less energy demanding com-
pared to compressor based technology of cooling [21, 22].
Hence, many technologies that rely on magnetic mate-
rials are used in our society, being key components to
the economy and to the well-being of household and pri-
vate use. The functionality of these technologies is based
on the performance of the magnetic materials they are
constructed around. Hence, in a general aim of a more
electriﬁed society, and with the ambition to ﬁnd greener
technologies to generate electricity, e.g. in farms of wind
power mills, the search of magnetic materials with tai-
lored properties has become a very active ﬁeld of sci-
ence [21, 22].
We end this subsection with a comment on the coupling
of magnetism and biology. The coupling of magnetism
and living matter were discussed over the many centuries
that magnetic phenomena were known.
For instance,
Bartholomew the Englishman (13th century) advocated
its medicinal powers [40], and the ideas of Franz Anton
Mesmer (late 18th and early 19th century) around “ani-
mal magnetism” have escaped few. Although the ideas
of Mesmer are now regarded as nonsense, the inﬂuence of
magnetic ﬁelds on biological matter is well established,
e.g. as demonstrated by levitating animals or fruit when
subjected to strong magnetic ﬁelds [41]. It is also estab-
lished that birds use nano-particles of magnetite (Fe3O4)
to navigate in the Earths magnetic ﬁeld [42]. In addi-
tion, it is well established that magnetic materials, again
in the form of magnetite, can be produced by bacteria,
e.g. magnetotactic bacteria, and the bacterium GS-15 is
known to produce magnetite [43]. It has even been spec-
ulated that this is one reason for large amounts of ﬁne-
grained magnetite found in ancient sediments.
Single-
domain magnetite produced in this way could then reveal
the magnetic recording of the ancient geomagnetic ﬁeld.
B.
On magnetic materials and magnetic
phenomena
Most elements have for the free atom a pairing of
electron spins, due to intraatomic exchange interaction
among the electrons.
This leads to atomic moments,
similar to what is illustrated schematically in Fig.1, for
almost all elements of the Periodic Table, provided they
are isolated atoms.
In the solid state things are more
complicated since the spin-pairing energy competes with
the kinetic energy, which is lowest for equal population

4
Figure 2. Comparison between measured magnetic spin mo-
ments and results obtained from theoretical calculations based
on DFT (data taken from Ref. 9).
of spin up and spin down electrons. Combined with the
fact that band formation of electron states can make the
kinetic energy rather signiﬁcant, one ends up with a com-
petition between two mechanisms, once favoring equal
population of spin states, and one that favors spin pair-
ing and local (or atom centered) moments. Stoner theory
quantiﬁes this competition and allows to identify a sim-
ple rule for when magnetic order is to be expected (see
e.g. Ref. 1). Among most elemental solids, it is in fact
the kinetic energy and band formation that dominates,
so that an equal amount of spin up and down states are
populated, making these materials either Pauli paramag-
netic or diamagnetic. Spontaneous magnetic order occurs
only for a limited number of elements of the Periodic Ta-
ble, and at (or just below) room temperature merely four
are found to have spontaneous ferromagnetic (FM) order
(bcc Fe, hcp Co, fcc Ni and hcp Gd). However, there are
thousands of compounds and alloys that show signiﬁcant
magnetic moments, and there are plenty of materials to
investigate with respect to the many interesting magnetic
phenomena that have been reported.
One of the more eﬃcient ways to evaluate the delicate
balance between band formation and spin-pairing, relies
on DFT and the invention of eﬃcient methods for solving
the electronic structure of solids, so that measured mag-
netic moments can be reproduced with good accuracy.
These calculations are often referred to as ab-initio, in-
dicating that they are carried out without experimental
input. Results from ab-initio theory are shown in Fig.2,
where a comparison is made to experimental results for
the four ferromagnetic elements listed above, as well as
for the ferromagnetic, hexagonal compound Fe2P. This
compound has Fe atoms occupying two distinct crystal-
lographic sites, a tetrahedral and an octahedral site, and
neutron scattering measurements have revealed that the
magnetic moments of these sites is quite diﬀerent. As
Fig.2 shows, ab-initio theory reproduces the measured
magnetic moments with good accuracy. The moments
for Fe2P are particularly interesting since they reveal a
delicate balance between band formation and interatomic
Figure 3. Magnetization density of bcc Fe, from theoretical
calculations based on DFT (redrawn after Ref. 9).
exchange energy, resulting in very diﬀerent moments for
Fe atoms situated on diﬀerent crystallographic sites. The
results shown in Fig.2 actually reveal a rather typical ac-
curacy of theory based on DFT, at least when it comes
to reproducing magnetic moments. Notable diﬃculties of
DFT based theory are however found for correlated elec-
tron systems, where multiconﬁguration eﬀects become
important, something we will also discuss in this review.
Ab-initio theory provide another important piece of in-
formation; that provided by the magnetization density.
This is illustrated in Fig.3 for bcc Fe, for a plane inside
the crystal, spanned by vectors parallel to the axis of the
conventional unit cell of the bcc structure. Note that red
coloration indicate high magnetization density while blue
indicate low values of this density. As the ﬁgure shows,
the magnetization density is high only in a small region
that is located close to the atomic nuclei of the Fe atoms.
This is a typical result and allows, for almost all mate-
rials, to describe the magnetic state as being composed
of atom centered (or atomic) moments, as illustrated in
the upper right of the ﬁgure. The results shown in Fig.3
justiﬁes a discussion based on atomic moments and the
diﬀerent types of phenomena such moments display.
The inset of Fig. 3 illustrates a speciﬁc arrangement
of atomic moments, and as the ﬁgure shows, bcc Fe is
a ferromagnet; all atomic moments point in the same
direction. However, for other materials many diﬀerent
orderings of atomic moments have been reported, such
as antiferromagnetism, where every other magnetic mo-
ment shown in the inset of Fig.3 would have its direc-
tion reversed. A majority of the materials that have ﬁ-
nite atomic moment have either of these two types of
collinear magnetic order. However, more complex mag-
netic orders exists in nature, where atomic moments form
a noncollinear arrangement (see e.g.
Ref. 3).
Among
the elements, such order is found predominantly among
the lanthanides [7]. As highlighted with the Nobel Prize
in Physics 2021, glass-like phenomena are also found for
speciﬁc groups of magnetic materials, in which one singu-
lar magnetic ground state is never realized. Instead, the
magnetism can be understood to reﬂect a multi-valley

5
landscape, where very many diﬀerent conﬁgurations of
the atomic moments result in very similar energies [43].
Thermal ﬂuctuations can make the system drift from one
conﬁguration to the next, and aging phenomena are a ﬁn-
gerprint of spin-glasses. Dilute alloys (e.g. Mn impurities
in a Cu matrix [44]) and more recently, elemental Nd [45],
are known spin-glass systems.
Each class of magnetic materials has its own charac-
teristic in terms of ground state properties as well as ﬁn-
gerprints revealing its excited state. This involves quasi-
particple properties of the collective excitations, referred
to as magnons (see e.g. Ref. 1), the temperature depen-
dence of the magnetic state, the value of the ordering
temperature and the critical exponents used to charac-
terize second order phase transitions, when the magnetic
state vanishes with temperature.
Many (if not all) of
these phenomena are typically analyzed using Eqs. (1)
(and (2)), and diﬀerent forms of Heisenberg exchange
interactions have been discussed to be responsible for
the widespread list of magnetic properties found in na-
ture. As reviewed in this communication, this involves
direct exchange, super- and double exchange, RKKY in-
teraction and interlayer exchange.
In these investiga-
tions the dimensionality of the magnetic material is a
natural component of the analysis, and the celebrated
Mermin-Wagner theorem describes the connection be-
tween dimensionality and ﬁnite temperature eﬀects of
spontaneously broken symmetries of magnets (see e.g.
Ref. 46–49).
C.
Recent trends in magnetism
Recent trends in magnetism often have focus on sys-
tems in the nano-scale. This relates for instance to mag-
netic multilayers and trilayers, where perhaps the most
celebrated ﬁnding is the GMR eﬀect and its applica-
tions for sensors [50, 51].
Most applications in mag-
netic information storage currently rely on sensors based
on the tunneling magneto resistance (TMR) eﬀect [52],
where interestingly the use of MgO as an optimal tun-
neling layer was predicted [53] by ab-initio theory be-
fore experimental veriﬁcation. These investigations had
focus on systems that are conﬁned in one dimension,
and thin ﬁlm physics is reviewed in many textbooks on
magnetism [3, 4].
These investigations of quasi two-
dimensional systems have now expanded to focus on top-
logical magnetic states (e.g. skyrmions, merons and hop-
ﬁons) [54] as well as investigations of purely 2D mate-
rials. The latter class is particularly interesting, given
the strong inﬂuence on geometrical dimensionality and
magnetism, as stated by the Mermin-Wagner theorem.
However, Cr trihalides have been synthesized and their
magnetic properties are by now rather well known [55].
Other aspects of magnetism that currently are under in-
vestigation are coupled to questions on the ultra-fast dy-
namics, pioneered in Ref. 56, as well as magnonics [57]
and spintronics [58]. As a ﬁnal remark of this subsection
we note the recent interest in spin-ice [59] and spin-liquid
states [60], as well as the so called Kitaev systems [61].
D.
Early theories of interatomic exchange
This review has a starting point in the work of Ref. 20,
but it is clear that the work published in Ref. 20 has over-
lap with earlier works, that attempted to also ﬁnd for-
malisms that allows to extract interatomic exchange from
information given by it ab-initio electronic structure the-
ory. We speciﬁcally mention the early works of Oguchi
and coworkers [62, 63], where a similar, but not identi-
cal approach was presented. In this work an approach
was used, where the magnetic moments were rotated by
180 degrees in order to extract the exchange interaction
strength, instead of the use of inﬁnitesimally small ro-
tations, which is the essence of the works in [20]. The
results of Refs. 62 and 63 were similar to earlier works
by [64] and by Lacour-Cyet and Cyrot [65].
We also
mention here the early works of Gyorﬀy et al. [66] and
by Liu [67], that inspired the works of [20], and an early
work from Wang at al. [68] who studied ﬂuctuating lo-
cal band theory of itinerant electron ferromagnetism in
nickel and iron.
E.
A comment on nomenclature
Before entering the main results of this review, we
make a comment on the form of the Hamiltonian used
in this text. In the derivations and the examples given
below we will use the expressions,
HH =
X
<ij>
Jij⃗ei · ⃗ej,
(1.3)
and
HDM =
X
<ij>
⃗Dij · (⃗ei × ⃗ej) ,
(1.4)
where ⃗ei is a unit vector describing the direction of the
magnetic moment of the atom as site i. In this review we
will refer to the interaction parameters in Eq. (1.3) either
as interatomic exchange or as Heisenberg exchange (Jij)
and DM interaction ( ⃗Dij), or simply as the Jij’s or ⃗Dij’s.
It should also be noted that the deﬁnition of the inter-
atomic energy, used in this work, is with a plus sign in
front of the summations in Eq. (1.3), where the summa-
tion is made over pairs of atoms < ij >. One sometimes
uses a slightly diﬀerent notation, where the summation is
made such that i ̸= j, but the indexes i and j run over all
atoms considered in a calculation. In this case a factor
1/2 appears in front of the summations in Eq. (1.3), to
ensure that each pair interaction is calculated only once.
Some authors also use a minus sign in front of Eq. (1.3).
In Section VII, where results of exchange parameters are

6
given, we clarify for each case what convention of spin
Hamiltonian has been used.
A comparison between Eqs. (1.1) and (1.3) gives that
Jij = JijSiSj where Si and Sj stand for the lengths
of the vectors ⃗Si and ⃗Sj.
Similarly we obtain that
⃗Dij = ⃗DijSiSj.
This distinction is important when
comparing interactions obtained from diﬀerent theoret-
ical methods and experiments.
The diﬀerent forms of
Eqs. (1.1) and (1.3) (and between Eqs. (1.2) and (1.4))
also allows an important distinction between quantum-
and classical spin Hamiltonians.
We adopt here the
nomenclature that Eqs. (1.3) and (1.4) allow for inﬁnites-
imal rotations of the direction of an atomic moment, and
hence ⃗ei can be treated as a classical vector. This is diﬀer-
ent from approaches when ⃗Si (as in Eqs. (1.1) and (1.2))
is considered as a quantum mechanical operator. The lat-
ter is obviously preferable from a formal point of view,
but it is in many cases impractical. In fact, all mate-
rials speciﬁc examples given in this review make use of
Eqs. (1.3) and (1.4). In the review, we will describe mag-
netic ﬁelds that are expressed in energy units. In other
words, we consider a magnetic ﬁeld as ⃗B = 1
2gµB ⃗˜B where
˜B is measured in Tesla, µB is the Bohr-magneton and g
approximately equals to -2 for electrons. We also note
that we will use bold symbols for vectors in real and
reciprocal space while symbols with an arrow denotes
vectors in spin space. Finally, we note that we use the
dot (·) symbol when components of a vector or a tensor
are contracted (summed over), e.g., ⃗A · ⃗B = P
µ AµBµ
or ⃗D · C · ⃗E = P
µν DµCµνEν, the cross (×) symbol is
used for cross product (or vector product) and the star
(⋆) symbol will be used when an equation continues on a
new line.
II.
LINEAR RESPONSE THEORY OF THE
SUSCEPTIBILITY
In this review we present a description of magnetic in-
teractions of many-electron systems, via the separation
of speciﬁc spin degrees of freedom (roughly, directions of
localized magnetic moments) from a complete quantum
description of all properties of the system starting from
the Schrödinger equation. This cannot be done without
approximations, due to a presence of strong interelectron
interactions. Nevertheless, it makes sense to start with
a formally rigorous scheme and then introduce these ap-
proximations step by step, something we do here.
For equilibrium properties, there are two main prac-
tical schemes: density functional theory based on the
Hohenberg-Kohn theorem [15] with the associated Kohn-
Sham quasiparticles [16] and Green function formalism
based on Luttinger-Ward generating functional [69, 70].
Spin dynamics deals with out-of-equilibrium properties,
and, fortunately, both these main techniques can be gen-
eralized for this case. For the Green function functional,
this is done in the most general form by Baym and
Kadanoﬀ[71] but in reality this method does not have
any applications to the properties of real materials since
it is computationally too demanding.
Only for model
systems is there a real progress [72]. Since in this review
we are focused on the applications to real materials, con-
necting calculated results to experimental observations,
we will not consider the time-dependent Green function
functionals here.
On the other hand, the time-dependent generalization
of density functional theory has been realized. It is based
on the Runge-Gross theorem [73] and its generalization
to spin-polarized calculations [74]. There are numerous
examples of the time-dependent density functional theory
(TDDFT), applied to speciﬁc magnetic materials [75–80].
In principle, if one knows the exact time-dependent den-
sity functional and, in particular, the so called exchange-
correlation kernel [73], one can calculate the dynamical
magnetic susceptibility, and ﬁnd the spin-wave spectrum
as the poles of the dynamical susceptibility. A ﬁtting of
exchange parameters could even be done to the calcu-
lated spectrum. This method would be formally exact,
but not very practical, at least at this stage, since the suc-
cesses in building of reliable expressions for the exchange-
correlation kernel are still very restrictive (note however
the ﬁrst attempts that have been made [81, 82]). In order
to proceed with practical calculations, we introduce an
approximation, that is, the so-called adiabatic approx-
imation within TDDFT (ADA-TDDFT). According to
this approximation, the exchange correlation kernel is
equal to its equilibrium form.
This is naturally a sig-
niﬁcant simpliﬁcation. Indeed, whereas the full exchange
correlation kernel depends on two times, in the adiabatic
approximation it depends only on one time, via the time-
dependence of the charge and spin densities only. After
this approximation is made, one can proceed to the ﬁ-
nal expression for the exchange parameters [83]. We will
follow here this derivation, which generalizes earlier the-
ories [84].
We proceed with the master equation of density func-
tional theory, the Kohn-Sham equation, that has the form
of a single particle Schrödinger equation. Within the self-
consistent ADA-TDDFT approximation it has the form
i∂ψ
∂t = Hψ
H = −∇2 + V (r) −

⃗Bxc(r) + ⃗Bext(r)

· ⃗σ (2.1)
where V (r) is the eﬀective potential, ⃗Bext(r) and ⃗Bxc(r)
are the external magnetic ﬁeld and the exchange-
correlation ﬁeld, respectively, that couple to the elec-
trons spin, and ⃗σ stands for the Pauli spin matrices
{σx, σy, σz}.
Note that Rydberg units are used here:
ℏ= 2m = e2/2 = 1.
Next, we employ the adiabatic approximation, assum-
ing that the functional dependencies of the exchange-
correlation potential, and hence the ﬁeld of the charge
and spin density, are the same as in the stationary case.
In the local spin density approximation (LSDA) depend

7
on the values of charge and spin densities at the same
spatial and temporal point only:
V (r) = Vext(r) +
Z
dr′ n(r′)
|r −r′| + ∂
∂n[nεxc]
⃗Bxc(r) = −⃗m
m
∂
∂m[nεxc],
(2.2)
where n(r) and ⃗m(r) are the charge and spin density,
m(r) is the magnitude of ⃗m(r), εxc is the exchange-
correlation energy density, and Vext(r) is the external po-
tential, that is, the electrostatic potential of nuclei. Note
that in the expressions above, we have in some places
omitted for simplicity the spacial argument r, that en-
ters all variables in Eq. (2.2). We will in some of the
equations below also adopt this simplifying notation.
The spin susceptibility which we are interested in is
the linear-response function, therefore we consider the
limit ⃗Bext(r) →0.
Then the eﬀective complete “non-
equilibrium” ﬁeld contains both an external ﬁeld as well
as an additional exchange correlation ﬁeld, due to redis-
tribution of the spin density, and the variation of this
ﬁeld can be expressed as:
δBα
tot = δBα
ext + δBα
xc
δmβ δmβ,
(2.3)
where αβ are Cartesian indices and a sum over repeated
indices is assumed.
The exact, non-local, frequency-dependent spin sus-
ceptibility, bχαβ, is the kernel of the operator that con-
nects the variation of the spin density and the external
magnetic ﬁeld:
δmα = bχαβδBβ
ext .
(2.4)
We use here the standard deﬁnition of the operator prod-
uct:
(bχϕ)(r) =
Z
dr′χ(r, r′)ϕ(r′) .
(2.5)
A parallel consideration for the calculation of the spin-
susceptibility follows from the Runge-Gross theorem [73]
and its generalization to the spin-polarized case [74],
where in the time-dependent density functional theory
one has the exact relation
δmα = bχαβ
0 δBβ
tot ,
(2.6)
where bχαβ
0
is the susceptibility of an auxiliary system
of one-electron, Kohn-Sham particles.
Comparing the
equations (2.3), (2.4), and (2.6), we arrive at the result
that
bχαβ = bχαβ
0
+ bχαγ
0
δBγ
xc
δmδ bχδβ ,
(2.7)
which is a particular case of the Bethe-Salpeter equa-
tion [85], with
δBγ
xc
δmδ
playing the role of the vertex, Γ.
One may note that this equation turns out to be for-
mally exact within ADA-TDDFT. Actually, even if one
does not assume the local spin density approximation,
equation (2.7) is still exact, but the vertex, Γ, is then not
local in spatial coordinates. The adiabatic approxima-
tion assumes however its locality in time.
The local spin density approximation (2.2) leads to
further simpliﬁcations. Indeed, one then obtains
δBγ
xc
δmδ = Bxc
m

δγδ −mγmδ
m2

+ mγmδ
m2
∂Bxc
∂m ,
(2.8)
where the ﬁrst term in Eq. (2.8) is purely transverse and
the second one is purely longitudinal with respect to the
local magnetization density (or the local magnetic mo-
ment) and Bxc is the length of ⃗Bxc.
In the next simpliﬁcation, we restrict ourselves to the
case of collinear magnetic ground states, with moments
along the z-direction. Then, the coupling between the
longitudinal and transverse components of the magnetic
susceptibility vanishes. For the transverse spin suscepti-
bility, which is commonly denoted by χ+−and depends
on the frequency ω, we have an especially simple expres-
sion:
χ+−(r, r′, ω) = χ+−
0
(r, r′, ω)
+
Z
dr′′χ+−
0
(r, r′′, ω)Ixc(r′′)χ+−(r′′, r′, ω)
(2.9)
where
Ixc = 2Bxc
m
,
(2.10)
is an exchange-correlation, Stoner (or Hund) interaction.
This is the standard RPA equation for the transverse sus-
ceptibility written for the spatially inhomogeneous case.
As one may see, it follows directly from the adiabatic
and local-spin-density approximations of TDDFT, with-
out any further assumptions. The magnetic and charge
electron densities as well as bare magnetic susceptibility
are related to the Kohn-Sham states in the usual way,
m =
X
µσ
σfµσ | ψµσ(r) |2 ,
(2.11)
n =
X
µσ
fµσ | ψµσ(r) |2 ,
(2.12)
and
χ+−
0
(r, r′, ω) =
X
µν
fµ↑−fν↓
ω −εµ↑+ εν↓
ψ∗
µ↑(r)ψν↓(r)ψ∗
ν↓(r′)ψµ↑(r′) .
(2.13)
In these expressions, ψµσ and εµσ are eigenstates and
eigenenergies for the time-independent Kohn-Sham equa-
tion,
(H0 −σBxc) ψµσ = εµσψµσ
H0 = −∇2 + V (r) ,
(2.14)

8
σ (without a vector symbol) stands for the spin index
±1 =↑↓and fµσ = f (εµσ) is the Fermi distribution func-
tion and µ labels the Kohn-Sham states.
The same approach leads to expressions for the longi-
tudinal spin susceptibility, which turns out to be coupled
to the charge density.
Since these expressions are not
necessary for the derivation of the values of exchange pa-
rameters we do not show them here, but refer to the work
in Ref. 83.
Further transformations are needed to make the ex-
pressions for spin wave spectrum more explicit.
First,
when substituting Eq. (2.10) into Eq. (2.9) we have the
product of exchange-correlation ﬁeld and wave functions.
According to Eq. (2.14) it can be transformed as
2Bxcψµ↑ψ∗
ν↓= (εν↓−εµ↑) ψ∗
ν↓ψµ↑
+ ∇(ψµ↑∇ψ∗
ν↓−ψ∗
ν↓∇ψµ↑) .
(2.15)
Substituting Eq. (2.15) into Eq. (2.13) one has
2(χ+−
0
Bxc)(r, r′, ω) = m(r)δ(r −r′) −ωχ+−
0
(r, r′, ω)
(2.16)
where we used the completeness condition
X
µ
ψ∗
µσ(r)ψµσ(r′) = δ(r −r′)
(2.17)
Substituting Eq. (2.16) into Eq. (2.9) we can transform
the latter expression to the following form
bχ+−= bχ+−
0
+ bχ+−
0
2Bxc
m
bχ+−
= bχ+−
0
+ bχ+−−ωbχ+−
0
1
m bχ+−+
bΛ
m bχ+−
(2.18)
or, equivalently,
bχ+−= m

ω −

c
χ0
+−−1 bΛ
−1
(2.19)
where
Λ(r, r′, ω) =
X
µν
fµ↑−fν↓
ω −εµ↑+ εν↓
ψ∗
µ↑(r)ψν↓(r)
⋆∇

ψµ↑(r′)∇ψ∗
ν↓(r′) −ψ∗
ν↓(r′)∇ψµ↑(r′)

.
(2.20)
Using Eqs. (2.13) and (2.19) we come to our ﬁnal expres-
sion
bχ+−=

m + bΛ
 
ω −IxcbΛ
−1
.
(2.21)
Let us emphasize that the transformation from Eq. (2.9)
to Eq. (2.21) is exact. The latter however is more conve-
nient to study the magnon spectrum.
The susceptibility, expressed in Eq. (2.21), has poles
at the condition
ω = Ω(r, r′, ω) ≡IxcΛ(r, r′, ω) .
(2.22)
Solutions to Eq. (2.22) allows to ﬁnd a real-valued ex-
pression for the magnon spectrum. The imaginary part
of Ωdescribes Stoner damping of magnons, that ap-
pear in metals. Note that there are many practical cal-
culations of exchange interactions and magnon disper-
sion of real material, using the dynamical susceptibil-
ity [75, 76, 80, 84, 86–90].
The last step we describe in this section, and which
allows a crucial result, is to restore eﬀective exchange in-
tegrals from Eq. (2.19). This procedure cannot be made
in a unique way; there are, at least, two diﬀerent deﬁ-
nitions of exchange integrals which are both reasonable,
but unfortunately not identical.
First, we can try to ﬁt interatomic exchange param-
eters to the poles of the susceptibility, that is, to the
magnon spectrum.
To do this explicitly we need a
bit more transformations. Substituting Eq. (2.15) into
Eq. (2.20) we ﬁnd
Λ(r, r′, ω) =
X
µν
fµ↑−fν↓
ω −εµ↑+ εν↓
⋆ψ∗
µ↑(r)ψν↓[2Bxc(r′) −εν↓+ εµ↑] ψ∗
ν↓(r′)ψµ↑(r′) .
(2.23)
Therefore, one may write
Ω(r, r′, ω) =
4
m(r)J(r, r′, ω) + Ixc(r)
X
µν
fµ↑−fν↓
ω −εµ↑+ εν↓
⋆(εµ↑−εν↓) ψ∗
µ↑(r)ψν↓(r)ψ∗
ν↓(r′)ψµ↑(r′) .
(2.24)
It is reasonable to identify the quantity
J(r, r′, ω) =
X
µν
fµ↑−fν↓
ω −εµ↑+ εν↓
⋆ψ∗
µ↑(r)Bxc(r)ψν↓(r)ψ∗
ν↓(r′)Bxc(r′)ψµ↑(r′)
(2.25)
as frequency-dependent interatomic exchange parame-
ters. If one sets ω = 0 in this expression, one arrives
at Rudderman-Kittel-Kasuya-Yosida (RKKY) type, in-
direct interactions [10, 11]. As will be shown later in this
review, these expressions are exactly equivalent to those
from Refs. [20, 28, 91].
In fact, these expressions are
more general, since they do not assume a rigid-moment
approximation and they take into account the full co-
ordinate dependence of the wave functions.
Using the
identity (2.17) one can also show that
Ω(r, r′, 0) =
4
m(r)J(r, r′, 0) −2Bxc(r)δ(r −r′) . (2.26)
The other way to evaluate inter atomicexchange inter-
actions is to connect exchange parameters to the energy
of spin spiral conﬁgurations, that is, with the static mag-
netic susceptibility bχ+−(0). The latter can be rewritten
as
bχ+−(0) = m

bΩ−1 −1
2B−1
xc

(2.27)

9
 
0.1 0.2 0.3 0.4 0.5 0.6 0.7
0.7 0.6 0.5 0.4 0.3 0.2 0.1 0.0
0
20
40
60
80
100
120
140
160
180
200
[111]
q (A -1)
o
q (A -1)
o
Γ
Energy, meV
[111]-
LSDA
LDA+U
Hubbard 1
DMFT
a
b
d
a)
c)
d)
b)
a
b
c
c
d
NiO
Figure 4.
Calculated and measured magnon dispersion of
NiO. Note that several levels of approximation for the the-
ory are shown (solid lines) together with experiments (solid
circles). Figure redrawn after Ref. 95.
which corresponds to the renormalized spin-wave energy
beΩ= bΩ

1 −1
2B−1
xc bΩ
−1
.
(2.28)
Note that this expression corresponds to the deﬁnition
of exchange parameters in terms of the energy of static
spin conﬁgurations [92–94]. As we will show below, this
corresponds to the exchange parameters from Refs. [20,
28, 91], normalized by taking into account constraints of
the density functional [92].
Thus, strictly speaking one cannot map the density
functional susceptibility onto an eﬀective Heisenberg
model with inter atomicexchange parameters in a unique
way. The formal reason is the renormalization of the nu-
merator, that is, the residue of the susceptibility at the
magnon pole, in the expression (2.21). There are however
two important limits where this diﬀerence disappears.
First, if we pass to the Fourier representation with the
wave vector q and consider the limit q →0 then, due
to the Goldstone theorem, Ω→0, the renormalization of
the magnon spectrum (2.28) disappears. This means that
the expression for the spin-wave stiﬀness constant [20] de-
termining magnon spectrum at q →0 is well-deﬁned and
exact within the local spin density approximation. Sec-
ond, if typical magnon energies are much smaller than the
Stoner splitting, B−1
xc bΩis small and the two deﬁnitions
of exchange integrals coincide. This corresponds to an
adiabatic approximation for magnons (note that magnon
energies are much smaller than typical electron energies)
which should be, of course, clearly distinguished from the
adiabatic approximation in the sense of TDDFT. This is
the case where the mapping of a full quantum mechanical
description to the eﬀective spin model is possible. In the
sections below, we will focus on this case.
In Fig. 4 we highlight the results of Ref. 95, using the
expressions of exchange parameters discussed above. The
ﬁgure shows results of a calculation for NiO, and after
performing a Fourier transform from real-space J(r, r′),
from Eq. (2.25) to reciprocal space, J(q), the magnon dis-
persion was calculated. The ﬁgure also shows experimen-
tal data and one may note that the agreement between
observation and calculation is satisfactory, if the correct
level of approximation is used for solving the Kohn-Sham
equation (2.1).
For NiO dynamical mean ﬁeld theory,
LDA+U and the Hubbard 1 approximation are all found
to reasonable well reproduce experiments. This will be
discussed further in Section VII.
III.
MAPPING ELECTRONIC ENERGIES TO
AN EFFECTIVE SPIN HAMILTONIAN
In the previous section we touched on the central as-
pect of this review; to extract from calculations of the
electronic structure, parameters that describe accurately
magnetic excitations. In this section we outline the ba-
sic principles of a method to do this, as was originally
proposed in Ref. 20. A more detailed description of this
method will be presented in Section V. We emphasize
that unless stated explicitly, we are only concerned with
parameters that describe the coupling between spin mo-
ments. We start by a section that contains the essential
aspect of Refs. 20 and 28, that involves how to connect
changes of the energy of a spin Hamiltonian (such as the
one in Eq. (1.1)) with changes of the grand canonical
potential, that contains energies of the electronic sub-
system.
A.
Basic assumptions
We start by making a central assumption; that it is
possible to identify well-deﬁned regions of a material
where the magnetisation density is more or less unidi-
rectional and sizeable only close to an atomic nucleus.
This implies the existence of local atomic magnetic mo-
ments (atomic spins), as is illustrated in Fig. 3, with fer-
romagnetic, anti-ferromagnetic (AFM) or non-collinear
interactions between atomic spin moments. As discussed
in connection to Fig. 3, very few materials, if any, are not
accurately described in this way.
An atomic spin moment is here chosen to be described
with a direction, ⃗ei, quantiﬁed as:
⃗ei = (sin(θi) cos(φi), sin(θi) sin(φi), cos(θi)) ,
(3.1)
where θi and φi stand for the polar and azimuthal an-
gles, respectively, of the atomic spin moment at site i.
The rigid-spin approximation [96] is also assumed, where
upon rotation of atomic spins, the length is not changed.
The method of Ref. 20 is an explicit method for calcu-
lations of interatomic exchange interactions, which relies
on a formalism of the Green function of the electronic
sub-system [3, 97]. The basic idea is that an eﬀective
spin Hamiltonian describes accurately the energy of dif-
ferent atomic spin conﬁgurations, that are close to the

10
magnetic ground state. We will below refer to the en-
ergy of the spin Hamiltonian as H, and one needs to make
sure that variation of H, when the spin conﬁguration is
modiﬁed slightly, follows closely changes of the true total
energy (the grand canonical potential, Ω, described be-
low) as provided by the electronic sub-system. This then
allows to map energies of the electron sub-system, as pro-
vided by e.g. density functional theory, to energies of an
eﬀective spin Hamiltonian, as given in Eq. (1.1). Practi-
cally, this mapping is based on the magnetic force theo-
rem, which states that the variation of total energy of the
electronic sub-system can be expressed in terms of varia-
tions only of occupied single particle energies [20, 98, 99].
More details of the argumentation and its extension for
correlated systems will be discussed in Subsections V A
and V L, respectively.
B.
The mapping scheme
In making the mapping between energies of the spin
Hamiltonian and energies of the electronic sub-system,
one considers as a reference state the atomic spin ar-
rangement of the ground state, with the energy H. Then
the orientation of one atomic spin moment, at site i, is
rotated with an inﬁnitesimally small angle, keeping the
length of the spin vector conserved (see Fig. 5). The vari-
ation of the direction of the spin, due to this rotation is
denoted δ⃗ei and the new direction of the perturbed spin
can be written as
⃗e′
i →⃗ei + δ⃗ei .
(3.2)
The energy of this system, that can be seen as having a
small perturbation from the ground state, can be written
as H′ = H′(δ⃗ei), where
H′ = H + δHone
i
.
(3.3)
As a second step, one considers a system with two atomic
spin moments rotated, at the site i and j. One can then
express the energy of this spin arrangement as
H′′ = H + δHone
i
+ δHone
j
+ δHtwo
ij
,
(3.4)
where H′′ = H′′(δ⃗ei, δ⃗ej) stands for the energy of a spin
system with two atomic moments rotated with an in-
ﬁnitesimal amount (see Fig. 6).
One may assume that the same procedure can be done
for the grand canonical potential variation of the elec-
tronic system, where the value of the single site rotated
system is
Ω′ = Ω+ δΩone
i
(3.5)
and for the two-site rotated system is
Ω′′ = Ω+ δΩone
i
+ δΩone
j
+ δΩtwo
ij
.
(3.6)
The next step is to derive explicit expressions for both
δΩone
i
and δΩtwo
ij
and to make a comparison with the
δHone
i
and δHtwo
ij , respectively.
The limit when the
spin-orbit coupling (SOC) is neglected, and the spins
are arranged collinearly along a global quantisation axis
(e.g.
the z-direction) will here be referred to as the
LKAG-limit (LKAG is after the authors of Refs. 20
and 28). A typical case for a small deviation from the
collinear state that will be considered here is:
δ⃗ei ≃

δθi, 0, −1/2 (δθi)2
.
C.
Excitation of the spin model
The classical Heisenberg spin Hamiltonian has been
introduced in Eq. (1.3). First, as shown in Fig. 5, we
will derive the one-site spin rotation variation, δHone
H,i.
Let us denote the non-perturbed spin conﬁguration by
the set of {⃗el} vectors and a perturbed system by the
set of {⃗el + δilδ⃗ei} where δ⃗ei stands for an inﬁnitesimal
variation of the spin direction due to a rotation at site i
with the angle δθi. One then ﬁnd
H′
H =
X
⟨lk⟩
Jlk (⃗el + δil δ⃗ei) · (⃗ek + δik δ⃗ei)
= HH + 1
2
X
l(̸=i)
Jli ⃗el · δ⃗ei + 1
2
X
k(̸=i)
Jik δ⃗ei · ⃗ek ,
(3.7)
where the origin of the factor of 1
2’s has been explained
in Subsection I E. Note that Eq. (3.7) can be simpliﬁed
to
δHone
H,i =
X
l(̸=i)
Jli ⃗el · δ⃗ei,
(3.8)
since the interaction is symmetric, Jil = Jli. This means
that the energy variation of the one-site spin rotation is
an energy cost resulted by the interaction of the rotated
spin and its environment formed by the non-rotated spins
as shown in Fig. 5.
If the non-perturbed conﬁguration is now collinear fer-
romagnetic, i.e., {⃗ej} = {(0, 0, 1)} for all j in the spin sys-
tem with the energy HH, one obtains that ⃗ej · δ⃗ei = δez
i ,
which is proportional to (cos δθi −1), i.e., approximately
to −(1/2) (δθi)2. Therefore, in the ferromagnetic limit,
one can demonstrate that
δHone
H,i ≃−1
2
X
j(̸=i)
Jji (δθi)2 .
(3.9)
Next, we simultaneously rotate two spins at site i and
j with δθi and δθj, respectively. As shown in Fig. 6, the
perturbed system for the two-site spin rotation is given
by the set of {⃗el + δilδ⃗ei + δjlδ⃗ej} and its energy is
H′′
H = HH + δHone
H,i + δHone
H,j + Jijδ⃗ei · δ⃗ej .
(3.10)
Comparing Eq. (3.10) to Eq. (3.4), we obtain [100]
δHtwo
H,ij = Jij δ⃗ei · δ⃗ej .
(3.11)

11
δ~ei
Figure 5. A schematic ﬁgure for the one-site spin rotation
when the unperturbed system is collinear, ferromagnetic. An
atomic spin at site i is being rotated with an inﬁnitesimal
vector δ⃗ei. This process costs the energy δHone
i
due to the
fact that the spin interacts with every other spin in the rest
of the spin system.
In
the
LKAG
limit
when
δ⃗ei = (δθi, 0, 0)
and
δ⃗ej = (−δθj, 0, 0), it can be shown that
δHtwo
H,ij = −Jij δθiδθj .
(3.12)
One can also consider a spin Hamiltonian with a ten-
sorial coupling between the spins as follows,
HT =
X
<ij>
⃗ei · ˆ
Jij · ⃗ej ,
(3.13)
where ˆ
Jij = {Jµν
ij ; µ, ν ∈{x, y, z}}. This is needed even
in a collinear system when the SOC is present [23]. Note
that HT can be rewritten as
HT = HH + Hanis + HDM ,
(3.14)
where
Hanis =
X
<ij>
⃗ei · Aij · ⃗ej
(3.15)
and HH and HDM have been introduced by Eqs. (1.3)
and (1.4), respectively. More precisely, the yz, the zx
and the xy components of the antisymmetric part of ˆ
Jij
are the Dx
ij, Dy
ij and Dz
ij components of the DM vector,
⃗Dij, respectively.
The one- and two-site energy variations of HT can be
given as the sum of the variations of HH, Hanis and
HDM, i.e.,
δHone
T,i =
X
j(̸=i)

Jij δ⃗ei · ⃗ej
+ ⃗Dij · (δ⃗ei × ⃗ej) + δ⃗ei · Aij · ⃗ej

(3.16)
and
δHtwo
T,ij =Jij δ⃗ei · δ⃗ej
+ ⃗Dij · (δ⃗ei × δ⃗ej) + δ⃗ei · Aij · δ⃗ej ,
(3.17)
δ~ei
δ~ej
Figure 6.
A schematic ﬁgure for the two-site spin rota-
tion when the unperturbed system is collinear, ferromagnetic.
Atomic spins at site i and j are rotated with the inﬁnitesimal
vector δ⃗ei and δ⃗ej, respectively. This process costs the energy
δHone
i
+ δHone
j
+ δHtwo
ij
where δHone
i
and δHone
i
stand for the
energy cost of a one-site rotations (shown in Fig. 5) while the
interacting term, δHtwo
ii , see text, characterizes the exchange
energy between the spins located at site i and j.
respectively. The expressions of energy variations of the
spin Hamiltonian, in Eqs. (3.16) and (3.17), must now be
compared to similar expressions for the the grand canon-
ical potential variations of the electrons. Before we make
this connection, a few important aspects of electronic
structure theory needs to be reviewed, which is what the
following section attempts to do.
IV.
BASIC CONCEPTS OF ELECTRONIC
STRUCTURE THEORY
In this section we introduce a few central concepts
of electronic structure theory, such as the one-electron
Green function and (intergrated) density of states that
will be needed in Section V, where we present the details
of the derivation of the generalized interatomic exchange
formulas.
A.
Grand canonical potential
We need an expression for the electronic energy and its
variations under a perturbation, such as the rotations in
Figs. 5 and 6. The grand canonical ensemble is used for
this purpose, where energy and particles of the system
considered can be exchanged with a reservoir, implying
that the chemical potential (µ) and temperature (T) are
relevant thermodynamic variables. The grand canonical
potential can be calculated as
Ω= E −µN ,
(4.1)
where E is the energy given by the equation
E =
∞
Z
−∞
dε εf(ε)n(ε),
(4.2)

12
and N is the number of electrons in the valence band.
Note that f(ε) is the Fermi-Dirac distribution function
and n(ε) denotes the density of states (DOS). Consid-
ering that the Fermi-energy, εF , usually is much higher
than the critical (Curie or Neel) temperature, it is for
most cases enough to work in the T = 0 approach (i.e.
f(ε) is a step function). In this case Ω= E −εF N, i.e.,
Ω=
εF
Z
−∞
dεεn(ε) −εF N = −
εF
Z
−∞
dεN(ε),
(4.3)
where partial integration has been used. Here the num-
ber of states function (or integrated density of states-
IDOS) is introduced, N(ε), and one ﬁnds that the grand
canonical potential can be calculated as an integral of this
function. This means that one has to determine the vari-
ations of IDOS to get the variations of the grand canoni-
cal potential. A practical way to do this is to employ the
so-called Lloyd formula, that will be described in Sec-
tion V. Note that the corresponding formula of Eq. (4.3)
for cases when the energy argument is in the complex
plane, is presented at the of Subsection IV B.
B.
Green function
Since the derivation of the interatomic exchange formu-
las relies on a Green function formalism of the electronic
structure, we summarize here the most central aspects
needed. A full account may be seen in Ref. 101. The
Green function (or resolvent) of the electronic Hamilto-
nian, H, is deﬁned as
G(z) = (z −H)−1 ,
(4.4)
where z ∈C. This implies that G (z∗) = G†(z). If both
sides of the equation (z2 −H) −(z1 −H) = z2 −z1 are
multiplied by G(z1)G(z2) and one sets that z2 = z + dz,
z1 = z and considers the limit dz →0, then the equation
dG(z)
dz
= −G2(z)
(4.5)
can be obtained.
Next, we consider an electronic Hamiltonian, H, with
a discrete spectrum[102], with solutions Hϕµ = εµϕµ.
Note that ⟨ϕµ|ϕν⟩= δµν and the solutions to H form a
complete set. The spectral resolution of the Green func-
tion can then be obtained from the so called Lehmann
representation,
G(z) =
X
µ
|ϕµ⟩⟨ϕµ|
z −εµ
.
(4.6)
This implies that on the basis of the eigenfunction
of H
the Green function could be represented as
Gµν(z) = δµν
1
z−εµ . In addition, G(z) is obviously unde-
ﬁned for z = εµ. However, considering z in the complex
plane, just above or below the real axis (z = ε±iδ) allows
to deﬁne[103]:
G±(ε) = lim
δ→0 G(ε ± iδ) .
(4.7)
One should note that a lattice site-dependent Green func-
tion, Gij(z), is relevant here, and it is obtained as
G(z) =
X
ijµ
|φi⟩⟨φi|ϕµ⟩⟨ϕµ|φj⟩⟨φj|
z −εµ
=
X
ij
|φi⟩Gij(z)⟨φj|.
(4.8)
with local functions |φi⟩at site i.
For our purposes, it is useful to ﬁnd a relationship be-
tween the IDOS, DOS and the Green function, and one
may note that in a system of independent fermions, the
expectation value of a one-particle observable, A, is given
as
⟨A⟩=
X
µ
pµ⟨ϕµ|A|ϕµ⟩,
(4.9)
where pµ = f(εµ), i.e. the Fermi-Dirac distribution func-
tion. One can evaluate this expression with the help of
Cauchy’s theorem, which states that for a closed con-
tour oriented clock-wise the integration of a function
g(z)/(z−a) is equal to −2πig(a) if a is within the contour
(otherwise the result is zero). With the help of Cauchy’s
theorem and Eq. (4.6), Eq. (4.9) can be simply given by
G+(ε) as follows [104],
⟨A⟩= −1
π ℑ
∞
Z
−∞
dεf(ε) TrLσAG+(ε)
(4.10)
where the trace is taken over both the orbital (L) and
spin (σ) spaces. If A is the identity operator one obtains
N = −1
π ℑ
∞
Z
−∞
dεf(ε)TrLσG+(ε) .
(4.11)
This allows to identify a relationship between the DOS
and the Green function,
n(ε) = −1
π ℑTrLσG+(ε) .
(4.12)
In the rest of the paper we consider the limit of upper
part of the complex plane (Eq. (4.7)) and the “+ symbol”
will be omitted for brevity for functions of real energies.
For future use where integrals along the real axis as
in Eq. (4.11) are less convenient and it is preferable to
transform such integrals to the complex plane. First we
note that the DOS can equally well be calculated with
the help of G−(ε), or since ℜG+(ε) = ℜG−(ε) as
n(ε) = −1
2πiTrLσ

G+(ε) −G−(ε)
	
.
(4.13)

13
With the latter choice, the number of particles of
Eq. (4.11) can be reformulated as
N = −1
2πi
∞
Z
−∞
dεf(ε)TrLσ

G+(ε) −G−(ε)
	
=
= −1
2πiTrLσ



∞
Z
−∞
dεfG+ +
−∞
Z
∞
dεfG−


.
(4.14)
Referring to the two integrals as I+ and I−, one can
view them as the two path integrals illustrated in blue
in Fig. 7. A closed contour integral can be obtained by
adding the two integrals labeled C+ and C−, respectively,
drawn in red, that both give vanishing contributions since
the energies of this part of the path can be chosel to
lie inﬁnitely far away from the poles of the Green func-
tions. Then since the integrand is analytical within these
contours, these integrals can be evaluated by summing
the residues that arise from the Fermi-Dirac distribution,
Res (f, µ + iωn) = −T, due to its poles at the Matsubara
energies z = µ + iωn, where ωn = (2n + 1)πT and T is
the temperature[105]. Hence
N =
 I+ + C+
+
 I−+ C−
=
= −1
2πi
I
+
dzfG +
I
−
dzfG

=
= −1
2πiTrLσ
∞
X
n=−∞
(2πi) Res (fG, µ + iωn) =
= T
∞
X
n=−∞
TrLσ G(µ + iωn) .
(4.15)
Finally, we note that the grand canonical potential can
be written as
Ω= T
∞
X
n=−∞
π N(µ + ωn) ,
(4.16)
which corresponds to Eq. (4.3) at ﬁnite temperature.
V.
DETAILED DERIVATION OF THE
EXCHANGE FORMULAS
In this section, we present the details of the mapping of
the electronic Hamiltonian to the spin Hamiltonian given
by the Jij-tensor as shown in Eq. (3.13). The derivation
is general in the sense that we consider a non-collinear
spin arrangement when the SOC interaction is present.
Hence, we will give explicit expressions for the Heisenberg
Jij, the DM vector ⃗Dij and the symmetric anisotropic
exchange term Aij in general, and the interpretation of
the results in the LKAG limit.
= z
I+
C−
C+
Figure 7. Integration paths in the complex plane.
A.
Magnetic local force theorem
As mentioned in Section III, the mapping of the elec-
tronic Hamiltonian to the spin Hamiltonian is based on
the magnetic force theorem, since one can always consider
small variations from the ground states, i.e, a mapping
to an eﬀective Hamiltonian is locally[106] possible (close
enough to the magnetic ground state).
Let us write the grand canonical potential as
Ω= Ωsp −Ωdc ,
(5.1)
where Ωdc stands for the interaction or "double-counting"
term. Then one can calculate the ﬁrst-order change in Ω
when the system is under some perturbation. In deriv-
ing the magnetic force theorem small rotations are con-
sidered as perturbations. These changes are assumed to
be described by some set of parameters[99]. As a ﬁrst
step, the potential is held ﬁxed which leads to a varia-
tion in the single particle energy δ∗Ωsp. Then, in a sec-
ond step, the parameters that characterize the changes
are held constant and the potential is allowed to re-
lax to self-consistency.
This leads to variations δ1Ωsp
and −δΩdc in the single particle energies and the double
counting term, respectively. However, these two contri-
butions, δ1Ωsp and −δΩdc cancel each other as shown in
Refs. 20, 98, and 99. In summary, the magnetic force
theorem indeed shows that the variation of total energy
of the electronic sub-system can be expressed in terms of
variations only of occupied single particle energies. Note
that the magnetic local force theorem strictly holds only
for ﬁrst order variations.
B.
Energy variation from non-collinear Kohn-Sham
Hamiltonian
Let us start with a general non-collinear state with
spin moments {⃗ei} and the Kohn-Sham Hamiltonian de-
ﬁned by Eq. (2.1). For simplicity we introduce ⃗B(r) as

14
⃗B(r) = ⃗Bxc(r) + ⃗Bext(r) and in condensed form we can
express the spin-dependent interaction as B ≡⃗B(r) · ⃗σ.
Then one can let the directions of the local moments
rotate away slightly from the a given magnetic conﬁgu-
ration. Instead of the case when only one spin is rotated
in the spin system, as shown in Fig. 5 and by Eq. (3.2),
we allow in principle a δ⃗ei change at all possible sites.
As we will see this is more than a sum of one-site rota-
tions because of the intersite interactions. However, the
corresponding perturbation in the potential δV , which
is purely spin-dependent, can be divided into the local
changes of the spin polarised potential in a given region
around the atomic sites where the moments are varied
δV = −
X
i
δ ⃗Bi · ⃗σ = −
X
i
Bi δ⃗ei · ⃗σ ,
(5.2)
where ⃗Bi ≡Bi⃗ei. Having the perturbation δV , one can
write for the perturbed Green function, G′ (omitting for
simplicity the energy argument), that
G′ = G + G δV G′
G = G′ −G δV G′ = (1 −G δV ) G′ ,
(5.3)
where G stands for the unperturbed Green function.
Now, from Eq. (4.5) one can deduce that
G = −∂ln G
∂ε
(5.4)
which means that IDOS, which is the primitive function
to the DOS of Eq. (4.12), is given by
N = −1
π ℑTriLσ (−ln G)
(5.5)
and the change in IDOS, is then given by Lloyd for-
mula [107]
δN = −1
π ℑTriLσ {−ln G′ + ln (1 −G δV ) G′}
= −1
π ℑTriLσ ln (1 −G δV )
(5.6)
which means that one does not have to deal with the
exact Green function G′ in order to calculate δN. One
can also expand the logarithm in a series as long as δV
is small
δN = 1
π ℑTriLσ
X
n
(δV G)n
n
,
(5.7)
where the order of the two factors can be altered due to
the properties of the trace. Note that G is the Green
function corresponding to the electronic Hamiltonian,
Eq. (2.1). It can be decomposed to inter site terms, Gij,
according to Eq. (4.8), that can further be decomposed
into spin-components as
Gij = G0
ij + ⃗Gij · ⃗σ ,
(5.8)
where ⃗Gij is a vector with the components of Gx
ij, Gy
ij and
Gz
ij. We introduce here the notation Gη
ij where the in-
dex η enumerates both the scalar spin-independent Green
function as well as the components of the spin-dependent
vector Green function of Eq. (5.8), i.e. η can be either 0,
x, y or z. Note that Gij is deﬁned in both the spin and
orbital spaces while Gη
ij is represented only in the orbital
space. In other words, Gij can be represented by a 18x18
matrix while Gη
ij is a 9x9 matrix when spd orbitals are
used in a practical calculation. We refer here to G0
ij as
the charge part and to ⃗Gij as the spin part of the Green
function and the physical interpretation of the decompo-
sition will be discussed in Subsection V E. Note that in
the LKAG limit the vector ⃗Gij has only a z-component,
and in Subsection V J we will deﬁne the up and down spin
channels with the help of G0
ij and Gz
ij. It should also be
noted that the trace in Eqs. (5.6) and (5.7) is over the
atomic sites i, the local basis functions L, as well as the
spin components σ.
Based on Eq. (4.3), the variation in grand canonical
potential (Eq. (4.1)), due to the moment rotations, is
obtained through integration of the change in number of
states function, i.e.,
δΩ= −
∞
Z
−∞
dε δN(ε)f(ε),
(5.9)
where Eq. (5.7) can be used for δN.
Considering
Eq. (4.16), the corresponding grand canonical potential
variation formula at ﬁnite temperature is given as
δΩ= T
∞
X
n=−∞
π δN(µ + ωn)
(5.10)
where δN (that along the real axis is given by Eq. (5.6)) is
generalised to an expression in the complex plane (writ-
ten with explicit energy argument for clarity)
δN(z) = −1
π TriLσ ln (1 −δV G(z)) ,
(5.11)
with the limit
lim
z→0+ ℑδN(z) = δN(ε) .
(5.12)
With Eq. (5.11) one can rewrite the sum over Matsubara
frequencies in Eq. (5.10) as a trace
δΩ= −Tr ln (1 −δV G(z)) = Tr
X
n
(δV G)n
n
(5.13)
which is a short notation for
Tr = TrωiLσ = T
∞
X
n=−∞
TriLσ .
(5.14)

15
Using analytical continuation from the Matsubara space
to the real frequencies we can get the following rela-
tion [108]
TrωiLσ = −1
π
∞
Z
−∞
dεf(ε)ℑTriLσ .
(5.15)
C.
Perturbation to ﬁrst order
One may directly conclude that whenever the low-
est order in Eq. (5.7) is not vanishing it will dominate.
Therefore we ﬁrst analyse the ﬁrst order term, which can
be described as a sum of one-site rotations
δN one = 1
π ℑTriLσ δV G =
X
i
δN one
i
(5.16)
where the site local variation of the number of states is
δN one
i
= −1
π ℑδ⃗ei · TrLσ Bi ⃗σ Gii =
= −2
π ℑδ⃗ei · TrL Bi ⃗Gii ,
(5.17)
and the factor 2 arises from the trace over spin variables.
The grand canonical potential variation (δΩone
i
) due to
one-site rotation (Fig. 5) is based on the expression δN one
i
(given by Eq. 5.17) and the details of the derivation will
be presented in Subsection V F. Note that Fig. 5 shows a
collinear (ferromagnetic) case. However, Eq. (5.17) also
holds for cases when the rotation, δ⃗ei, appear in a non-
collinear background of atomic moments.
D.
A sum rule
While δN one
i
(and therefore δΩone
i
) can be obtained
by direct calculation based only on onsite quantities as
shown by Eq. (5.17), we prefer to deepen the analysis by
taking an algebraic step which allows to express this ﬁrst
order term as a bilinear intersite magnetic interaction
which eases the understanding of these magnetic interac-
tions. Since the local Green functions arise from a self-
consistent solution of a magnetic order one can derive an
explicit expression for it in the following way. One may
consider a solution as obtained from a well deﬁned non-
magnetic system with a Hamiltonian in the form of the
right hand side of Eq. (2.1), more precisely, V (r) = V nm
0
to which one may add the spin-orbit coupling, Hso. In
this case ⃗Bxc(r) = ⃗Bext(r) = 0.
Note that the non-
spin-polarized potential V nm
0
for this non-magnetic state
in general will not be equivalent to the corresponding
spin-independent part of the potential, V0, for a mag-
netic state. The Green function of the magnetic state is
related to the Green function of the non-magnetic state,
Gnm, through Dyson’s equation as follows (omitting for
simplicity the energy argument)
G = Gnm + Gnm ∆V G
(5.18)
or
 G−1 −G−1
nm

ij =
n
V nm
0
−V0 + ⃗Bj · ⃗σ
o
δij ,
(5.19)
where the spin polarized ﬁelds can be written ⃗Bj = Bj ⃗ej
and ∆V = V0 −⃗Bj · ⃗σ −V nm
0
.
In order to arrive at a suitable expression one makes
use of the fact that this magnetic state has to be degen-
erate with the corresponding time reversed state, i.e., the
state with all moments switched and the direction of a
charge current is reversed. The Green function for this
time reversed problem, eG, is given by

eG−1 −G−1
nm

ij =
n
V nm
0
−V0 −⃗Bj · ⃗σ
o
δij .
(5.20)
The diﬀerence between Eqs. (5.19) and (5.20) gives

G−1 −eG−1
ij = 2 ⃗Bj · ⃗σ δij .
(5.21)
By letting eG and G act on Eq. (5.21) from either side in
a symmetric fashion, we arrive at a sum rule for the local
Green functions
eGii −Gii =
X
j

Gij ⃗Bj · ⃗σ eGji + eGij ⃗Bj · ⃗σ Gji

.
(5.22)
E.
Further decomposition of Green function and
its physical interpretation
To be able to utilize the relation of Eq. (5.22) one can
further decompose the components of the Green function
in Eq. (5.8) into terms that are either even or odd under
time reversal symmetry [109]. This can be done by intro-
ducing Gηκ
ij where the ﬁrst index η has been introduced
and explained after Eq. (5.8) while the second index κ
can be viewed as an indicator whether the terms that are
time reversal invariant and those are not, i.e, κ can be
0 or 1, but the exact relation is explained below. This
decomposition of the Green function can be summarised
as,
Gη
ij = Gη0
ij + Gη1
ij
(5.23)
where G00
ij and ⃗G1
ij are time reversal invariant while G01
ij
and ⃗G0
ij are not.
Sometimes it is convenient to write
the x, y or z dependent components of the Green func-
tion as vectors, i.e. ⃗Gκ. This decomposition also plays a
useful role in how the Green function behave under site
exchange, since in a real local basis [109] we have that
Gηκ
ij = (−1)κGηκ
ji
T .
(5.24)
In fact, it has been shown [109] that these two index
Green functions are decomposed in terms that produce

16
local charge-, G00 or spin-densities, ⃗G0, and charge-,
G01, and spin-currents ⃗G1, respectively, an aspect we will
come back to.
We can express both the Green function and its time
reversed version as a superposition of these two index
decomposed Green functions, as
G = G00 + G01 + ⃗G0 · ⃗σ + ⃗G1 · ⃗σ
(5.25)
eG = G00 −G01 −⃗G0 · ⃗σ + ⃗G1 · ⃗σ .
(5.26)
These decomposed Green functions are then inserted in
Eq. (5.22), which leads to
eGii −Gii =
X
j

G00 + G01 + ⃗G0 · ⃗σ + ⃗G1 · ⃗σ

ij
⃗Bj · ⃗σ

G00 −G01 −⃗G0 · ⃗σ + ⃗G1 · ⃗σ

ji
+

G00 −G01 −⃗G0 · ⃗σ + ⃗G1 · ⃗σ

ij
⃗Bj · ⃗σ

G00 + G01 + ⃗G0 · ⃗σ + ⃗G1 · ⃗σ

ji

(5.27)
which for the spin dependent and time reversal odd part,
⃗G0
ii, of 1
2(Gii −eGii) = G01
ii + ⃗G0
ii · ⃗σ we get
⃗G0
ii = −
X
j
n
G00
ij ⃗Bj G00
ji −G01
ij ⃗Bj G01
ji
o
−i
X
j
n
⃗G1
ij × ⃗Bj G00
ji + G00
ij ⃗Bj × ⃗G1
ji
o
+ i
X
j
n
⃗G0
ij × ⃗Bj G01
ji + G01
ij ⃗Bj × ⃗G0
ji
o
−
X
j
n
⃗G1
ij · ⃗Bj ⃗G1
ji −⃗G0
ij · ⃗Bj ⃗G0
ji
o
+
X
j
n
⃗G1
ij × ⃗Bj

× ⃗G1
ji −

⃗G0
ij × ⃗Bj

× ⃗G0
ji
o
.
(5.28)
Note that the expression in Eq. (5.28) is general, despite
that we arrived at it from considerations of the Greens
function of its normal and spin reversed (180° rotation)
state. Hence Eq. (5.28) can be used also for small angle
rotations of moments[110], which will utilize in Subsec-
tion V F.
To give a physical interpretation for the charge- and
spin-densities and charge- and spin-currents, it is useful
to study the decomposition of the Green function in real
space , G(r, r′; ε), into eight independent two indexed
contributions
G(r, r′; ε) =
X
η∈{0,x,y,z}
1
X
κ=0
ση Gηκ(r, r′; ε) ,
(5.29)
where σ0 is the identity matrix. Note that the second
index, κ, of the Green function in Eq. (5.29), indicates
whether the function is even (0) or odd (1) under the
exchange of spatial coordinates (r ↔r′) x
Gηκ(r′, r; ε) = (−1)κ Gηκ(r, r′; ε) ,
(5.30)
and one may write
G(r′, r; ε) =
X
η∈{0,x,y,z}
1
X
κ=0
(−1)κση Gηκ(r′, r; ε) . (5.31)
The four diﬀerent Green function, two scalar and two vec-
tor valued, as discussed above all have a direct physical
property as in the local limit they give rise to charge and
spin density and charge and spin currents, respectively,
through
n(r) = −1
π ℑ
Z
G00(r, r; ε) dε
(5.32)
⃗m(r) = −1
π ℑ
Z
⃗G0(r, r; ε) dε
(5.33)
j(r) = −1
π ℜ
Z
∇G01(r, r; ε) dε
(5.34)
⃗q(r) = −1
π ℜ
Z
∇⃗G1(r, r; ε) dε .
(5.35)
These four independent density quantities are important
in the case of magnetic materials and is known to appear
in many other approaches such as in general Hartree-Fock
theory [111].
Expanding the Green function represented in real
space in a local basis (Eq. (4.8)) results in
Gηκ(r, r′; ε) = φT
i (r) Gηκ
ij φj(r′),
(5.36)
where space is divided into regions around the atomic
sites, such that the site i is speciﬁed by the position r
and the vector of basis functions φi(r) is uniquely deﬁned.
Then the condition of Eq. (5.30) leads to
Gηκ(r′, r; ε) = φT
j (r′) Gηκ
ji φi(r)
= (−1)κ φT
i (r) Gηκ
ij φj(r′)
= (−1)κ 
φj(r′)T 
Gηκ
ij
	T φi(r)
T
= (−1)κ φj(r′)T 
Gηκ
ij
	T φi(r) ,
(5.37)

17
where the outer transpose is superﬂuous since it is acting
on a scalar.
This leads to the relation for the Green
function matrices expanded in a real basis shown in
Eq. (5.24), which illustrates that the decomposed Green
functions that stem from currents, κ = 1, are asymmetric
in the direction of the propagation in contrast to those
that stem from densities, κ = 0.
F.
Bilinear interaction parameters due to one-site
spin rotation
One can express the variation of grand potential as a
sum of ﬁrst and second order contributions
δΩ=
X
i
δΩone
i
+
X
⟨ij⟩
δΩtwo
ij
+ . . . .
(5.38)
To derive the bilinear interaction parameters due to one-
site spin rotation, one then has to express the one-site
grand potential variation, δΩone
i
, in terms of intersite
Green functions.
Note that δΩone
i
can be calculated
by inserting Eq. (5.17) into Eq. (5.9) where Eq. (5.17)
is given with the onsite Green function ⃗Gii. However,
it is only the time reversal odd spin dependent Green
function, ⃗G0
ii, that will give rise to a non-zero product
TrL Bi ⃗Gii in Eq. (5.17), where ⃗G0
ii in turn can be ex-
pressed in terms of intersite Green functions due to the
sum rule of Eq. (5.28). Hence, one can express the ﬁrst
order term as a superposition of diﬀerent pair interac-
tions to be compared with Eq. (3.16)
δΩone
i
= 2
π ℑδ⃗ei ·
Z
TrL Bi ⃗G0
ii(ε) dε
=
X
j(̸=i)

J(1)
ij δ⃗ei · ⃗ej + ⃗D(1)
ij · (δ⃗ei × ⃗ej) + δ⃗ei · A(1)
ij · ⃗ej

(5.39)
where J(1)
ij
is
J(1)
ij
= −2
π ℑ
Z
TrL

Bi G00
ij Bj G00
ji −Bi G01
ij Bj G01
ji
+
X
ν
Bi Gν0
ij Bj Gν0
ji −
X
ν
Bi Gν1
ij Bj Gν1
ji

dε,
(5.40)
and the components of ⃗D(1)
ij
and A(1)
ij are given as
D(1)ν
ij
= −4
π ℜ
Z
TrL
 BiG00
ij BjGν1
ji −BiG01
ij Bj Gν0
ji

dε
(5.41)
and
A(1)νµ
ij
= −4
π ℑ
Z
TrL

BiGν1
ij BjGµ1
ji −BiGν0
ij BjGµ0
ji

dε ,
(5.42)
respectively, where µ and ν can be x, y or z. Note that
index (1) in J(1)
ij , ⃗D(1)
ij
and A1
ij refers to the fact that
these parameters are derived from one-site spin rotation
[112]. Comparing Eq. (5.39) to Eq. (3.16) shows that a
local mapping can be made with the Heisenberg exchange
parameter Jij = J(1)
ij , the DM vector ⃗Dij = ⃗D(1
ij and
the symmetric anisotropic interaction tensor Aij = A1
ij,
around the magnetic order of the reference state.
G.
Bilinear interaction parameters due to two-site
spin rotations
Whenever the ﬁrst order term vanishes the second or-
der perturbation plays an important role.
This is for
instance the case for a collinear state in the absence of
SOC where the ﬁrst order contribution is identically zero.
The second order term in Eq. (5.7) corresponds to simul-
taneous rotations at site i and j as illustrated in Fig. 6
and is naturally bilinear
δΩtwo
ij
= −1
π
Z
ℑTrLσ δ⃗ei · ⃗σ Bi Gij δ⃗ej · ⃗σ Bj Gji dε ,
(5.43)
Note that Fig. 6 shows a collinear (ferromagnetic) case,
but Eq. (5.43) also holds for the general non-collinear
case. One should note that Eq. (5.43) can be simpliﬁed
in a similar fashion as the ﬁrst order contributions; ﬁrst
decompose the Green functions and then sum out the
spin degrees of freedom after manipulating the matrix
product by means of Pauli algebra. A comparison with
Eq. (3.17) leads to
δΩtwo
ij
=J(2)
ij δ⃗ei · δ⃗ej + ⃗D(2)
ij · δ⃗ei × δ⃗ej+
+ δ⃗ei · A(2)
ij · δ⃗ej,
(5.44)
and a hence the conclusion that J(2)
ij
should be deﬁned
as
J(2)
ij
= −2
π ℑ
Z
TrL

Bi G00
ij Bj G00
ji + Bi G01
ij Bj G01
ji
−
X
ν
Bi Gν0
ij Bj Gν0
ji −
X
ν
Bi Gν1
ij Bj Gν1
ji

dε ,
(5.45)
while the components of ⃗D(2)
ij
and A(2)
ij are given as
D(2)ν
ij
= −4
π ℜ
Z
TrL
 Bi G00
ij Bj Gν1
ji + Bi G01
ij Bj Gν0
ji

dε
(5.46)
and
A(2)νµ
ij
= −4
π ℑ
Z
TrL

BiGν1
ij BjGµ1
ji + BiGν0
ij BjGµ0
ji

dε ,
(5.47)
respectively, where the superscript (2) in J(2)
ij , ⃗D(2)
ij
and
A(2)
ij refers to the fact that these parameters are derived
from two-site spin rotations. When comparing Eq. (5.44)

18
to Eq. (3.17) one can observe that an alternative map-
ping than that found in Eq. (5.39) can also be made with
the Heisenberg Jij = J(2)
ij , the components of the DM
vector ⃗Dij = ⃗D(2)
ij
and the symmetric anisotropic inter-
action tensor Aij = A(2)
ij .
H.
Explicit symmetric or asymmetric interactions
With a relation in hand for the decomposed Green
functions we observe that the interactions are explicitly
determined as symmetric or asymmetric. For example
for the Dzyaloshinskii-Moryia interaction of Eq. (5.41)
we can, since the trace of the transpose of a matrix is
equal to the trace of the matrix and the fact that the
trace of a product is invariant under cyclic permutation
of the factors, derive its asymmetric property explicitly
due to the property of Eq. (5.24) as follows,
D(1)ν
ij
= −4
π ℜ
Z
TrL
 BiG00
ij BjGν1
ji −BiG01
ij BjGν0
ji
T dε
= 4
π ℜ
Z
TrL
 BjGν1
ji BiG00
ij −BjGν0
ji BiG01
ij

dε
= −D(1)ν
ji
.
(5.48)
In general we can conclude that pair interaction terms
that include an even number of asymmetric Green func-
tions become symmetric, while those that include an odd
number is asymmetric. Then it is clear that it is only
the Dzyaloshinskii-Moriya interaction that is asymmet-
ric among the bilinear interactions of Eqs. (5.40)–(5.42).
Note that the argumentation presented here holds for
D(2)ν
ij
(see Eq. (5.46)) as well.
I.
The interaction parameters in tensor form
The interaction energy in the form of Eq. (5.39) can
also be written as
δΩone
i
=
X
i̸=j
δ⃗ei · J (1)
ij
· ⃗ej,
(5.49)
where the 3 × 3 tensorial interaction is given by
J (1)
ij
=



J(1)
ij + A(1)xx
ij
D(1)z
ij
+ A(1)xy
ij
−D(1)y
ij
+ A(1)xz
ij
−D(1)z
ij
+ A(1)xy
ij
J(1)
ij + A(1)yy
ij
D(1)x
ij
+ A(1)yz
ij
D(1)y
ij
+ A(1)zx
ij
−D(1)x
ij
+ A(1)yz
ij
J(1)
ij + A(1)zz
ij


.
(5.50)
Such a 3 × 3 tensor can be decomposed by symmetry
into three independent tensor terms; a symmetric scalar
or rank 0, S(1), an asymmetric vector or rank 1, V(1), and
lastly a symmetric rank 2 tensor term, T (1), respectively.
These are deﬁned as
S(1) = 1
3 Tr J (1)
(5.51)
V(1) = ⃗D(1)
(5.52)
T (1) = A(1) −1
3 Tr A(1).
(5.53)
While we have referred to the Heisenberg interaction
as the term where the explicit magnetic interaction is a
scalar, there is an alternative view that, the Heisenberg
interaction is the interaction that is eﬀectively a scalar,
i.e. S(1). Such an approach ensures that the other interac-
tions are traceless. This means that the Dzyaloshinskii-
Moryia interaction is unique, but the exact Heisenberg
and second rank tensor is kind of a matter of choice. A
similar tensor expression exists also of course for the sec-
ond order term of Eq. (5.44).
J.
Comparison the interaction parameters obtained
from one- and two-site variations
Since we have reformulated the ﬁrst order interactions
in a bilinear form (Eq. (5.40)), it can be directly com-
pared with the second order interactions that are nat-
urally bilinear (Eq. (5.45)). There are clear diﬀerences
in the two expressions, which might not be very sur-
prising as they reﬂect diﬀerent quantities. However, in
the LKAG limit, with collinear order and negligible spin-
orbit coupling, they should result in similar values. When
studying the details of this limit it turns out that the
similarity is slightly fortuitous. The mapping to the spin
Hamiltonian HT based on one-site spin rotation, resulted
in the exchange parameters J(1)
ij , ⃗D(1) and A(1) while
a similar mapping based on two-site spin variations led
to the parameters J(2)
ij , ⃗D(2) and A(2).
In the LKAG
limit there is no spin and charge current present and
we can choose a global coordinate system in which the
non-perturbed spin-arrangement will all point to the z
direction and one has the freedom to restrict the small
rotations to the xz plane.
Let us start with the exchange parameters obtained
from two-site variations. In this case we can see that the
J(2)
ij
parameter, deﬁned by Eq. (5.45), is reduced to
J(2)
ij
= −2
π ℑ
Z
TrL

Bi G00
ij Bj G00
ji −Bi Gz0
ij Bj Gz0
ji

dε .
(5.54)
In the LKAG limit, ⃗D(2), deﬁned by Eq. (5.46), van-
ishes and the symmetric anisotropic interaction tensor
A(2), deﬁned by Eq. (5.47), will only have one non-
vanishing component, A(2)zz
ij
. However, it can be seen
from the third term in Eq. (5.44) that A(2)zz
ij
is irrelevant,
since in the LKAG limit only the product of δex
i = δθ
and the δex
j = −δθ components of the variation vec-
tors will be relevant in leading order, while e.g. δez
i ez
j =
(1/4) (δθ)4 represents a vanishingly small contribution.

19
This means that only the ﬁrst Heisenberg term is relevant
in Eq. (5.44) as is shown in Eq. (3.12), where the LKAG
exchange parameter is given by Eq. (5.54). We can intro-
duce the notation G↑
ij = G00
ij + Gz0
ij and G↓
ij = G00
ij −Gz0
ij
and the LKAG exchange expression will be given in its
well-known form as
J(2)
ij
= −2
π ℑ
Z
TrL

Bi G↑
ij Bj G↓
ji

dε .
(5.55)
We also note here that substituting Eq. (4.6) into
Eq. (5.55) and integrating over energy one arrives at an
expression which is equivalent to Eq. (2.25) [113].
Next, we focus on the parameters obtained from one-
site variation. In the LKAG limit Eq. (5.39) is drastically
simpliﬁed, since ⃗ej = {(0, 0, 1)} for all j in the spin sys-
tem while ⃗D(1), deﬁned by Eq. (5.41), vanishes.
This
means that one only has to deal with the component δez
i
of the variation vector δ⃗ei, and Eq. (5.39) will be equiva-
lent with Eq. (3.9), where Jij = J(1)
ij +A(1)zz
ij
. However, it
can be seen that in the LKAG limit J(1)
ij + A(1)zz
ij
= J(2)
ij
where J(2)
ij
is given by Eq. (5.55). In conclusion, both
the mapping based on one- and two-site spin rotations
is consistent in the LKAG limit with the exchange pa-
rameter (5.55), although the expressions in Eqs. (5.40)
and (5.45), are diﬀerent.
Finally, we note the the component of the DM vectors
⃗D(1)
ij
and ⃗D(2)
ij
is a sum of a density-current and current-
density term, as shown by the 0-1 and 1-0 indices of the
Green functions in Eqs. (5.41)–(5.46). This implies that
for trivial topology as the collinear spin arrangment the
DM term will vanish (in the lack of SOC). However, the
symmetric anisotropic interaction terms A(1)
ij
and A(2)
ij
deﬁned by Eqs. (5.42)–(5.47) consist of a density-density
term (represented by the Green functions with indices 0-
0) and a current-current type term (represented by Green
functions with the indices 1-1). Due the the presence of
the density-density term, the symmetric anisotropic in-
teraction can have a relevance for non-trivial spin arreng-
ment even in the lack of SOC. The density-density term
in A(2)
ij
is formally present in the LKAG limit as well,
however, it gives a fourth order contribution in terms
of angle variations.
This term was interpreted as an
anisotropy anomaly in Ref. 114. Note that DM vectors
and the symmetric anisotropic terms, in fact all elements
of the Jij-tensor, have been derived in Ref. 23.
We end this subsection with a comment for practi-
cal reasons, we have in Section VII given numerical ex-
amples of exchange interactions that are based on the
equations obtained from the two-site energy variations
(Eq. (5.45)), except for the results in Fig. 12, where data
from Eq. (5.40) is shown.
K.
Local versus global spin models
We make a comment here on the distinction between
local and global spin models proposed by Ref. 115. Spin
models that are obtained by mapping from a generaliza-
tion of the LKAG approach, i.e. perturbation out of an
already magnetic reference state, will incorporate com-
posed Green functions, ⃗G10, ⃗G11 and G01, that are di-
rectly dependent on the magnetic order. Hence the ob-
tained model is only valid locally on the energy vs. con-
ﬁguration curve, i.e. it is only relevant for small mag-
netic ﬂuctuations around the reference state.
This is
in contrast to global spin models that are supposed to
be valid for all magnetically ordered states and the full
curve of energy vs. conﬁguration. This implies that local
models do not have to fulﬁll global symmetry require-
ments. A magnetic state dependence of the interaction
coeﬃcients arises naturally for local models due to their
dependence on the reference state [115]. If the state de-
pendence is taken into account for a local spin model, all
global symmetries are of course recovered. It is impor-
tant to realize that the existence of global spin models for
itinerant-electron systems is not guaranteed, since there
is no way to prove that the magnetic degrees of freedom
can be globally described by any Hamiltonian dependent
solely on spin operators.
At the same time, at least,
for small frequencies and small wave-vectors any ferro-
magnetic system should be described by the macroscopic
Landau-Lifshitz equation [10, 116, 117]. This means that
at least the expression for the spin-wave stiﬀness con-
stant, based on small variations from the ferromagnetic
ground state, is always meaningful [20]. Moreover, within
the local approximations such as dynamical mean-ﬁeld
theory (see Subsection V L) the expression for the spin-
wave stiﬀness constant derived from magnetic force the-
orem becomes exact [118].
L.
Exchange interactions in correlated system
In order to calculate the eﬀective exchange interaction
parameters for correlated magnetic systems the DMFT
approach has been explored, with a local frequency de-
pendent self energy. First of all, let us prove the analog
of the local force theorem in the DMFT-like theory [108].
Instead of working with the thermodynamic potential Ω
as a density functional we have to start from its general
expression in terms of an exact Green function [19, 69]
Ω= Ωsp −Ωdc
Ωsp = −Tr

ln

Σ −G−1
0
	
Ωdc = Tr ΣG −Φ
(5.56)
where G, G0 and Σ are an exact Green function, its bare
value and self-energy, correspondingly; Φ is the Lut-
tinger generating functional (sum of the all connected
skeleton diagrams without free legs), Tr = TrωiLσ is

20
the sum over Matsubara frequencies Trω... = T P
ω
...,
ω = πT (2n + 1) , n = 0, ±1, ..., and T is the temper-
ature.
Furthermore, iLσ are site numbers (i), orbital
quantum numbers (L = l, m) and spin projections σ ,
correspondingly.
Both Green functions are related via
the Dyson equation
G−1 = G−1
0
−Σ
(5.57)
with the important variational identity
δΦ = Tr ΣδG.
(5.58)
We represent the expression Eq. (5.56) as a diﬀerence of
“single particle” (sp) and “double counted” (dc) terms as
it is usual in the density functional theory. When ne-
glecting the quasiparticle damping, Ωsp is nothing but
the thermodynamic potential of ”free” fermions but with
exact quasiparticle energies. Suppose we change the ex-
ternal potential, for example, by small spin rotations.
Then the variation of the thermodynamic potential can
be written as
δΩ= δ∗Ωsp + δ1Ωsp −δΩdc,
(5.59)
where δ∗is the variation without taking into account the
change of the “self-consistent potential” (i.e. self energy)
and δ1 is the variation due to this change of Σ. Taking
into account Eq. (5.58) it can be easily shown (cf. Ref. 19
and 69) that
δ1Ωsp = δΩdc = TrGδΣ
(5.60)
and hence
δΩ= δ∗Ωsp = −δ∗Tr ln

Σ −G−1
0

,
(5.61)
which is an analog of the “local force theorem” in the
density functional theory [20, 98, 99].
In the DMFT scheme, the self energy is local, i.e., it
is diagonal in site indices. Let us write the spin-matrix
structure of the self energy and Green function in the
following form
Σi = Σc
i + ⃗Σs
i⃗σ
Gij = Gc
ij + ⃗Gs
ij⃗σ
(5.62)
where Σ(c,s)
i
=
1
2

Σ↑
i ± Σ↓
i

, ⃗Σs
i = Σs
i⃗ei, with ⃗ei be-
ing the unit vector in the direction of eﬀective spin-
dependent potential on site i and in the local moment
approximation not depending on frequency (discussed
furter in Section IX), Gc
ij
=
1
2Trσ(Gij) and ⃗Gs
ij
=
1
2Trσ(Gij⃗σ).
Then following the general idea of inﬁnitesimal rota-
tion of local magnetic potential/self-energy the eﬀective
exchange interactions in correlated magnetic system can
be obtained by rewriting all equations in this section with
a substitution of Σs
i for Bi, leading to the expression [108]
Jij = 2TrωL

Σs
iG↑
ijΣs
jG↓
ji

,
(5.63)
to be compared with Eq. (5.15).
VI.
BEYOND KINETIC EXCHANGE
Let us now return to a general discussion of ex-
change interactions within the, formally rigorous, scheme
of time-dependent density functional presented in Sec-
tion II. In this approach, the whole dynamics of the
many-electron system is described in terms of the time-
dependent one-particle density matrix ραβ (r, r,t)
=
D
η+
β (r, t) ηα (r, t)
E
, where ηα (r, t) is the annihilation op-
erator for the electron at the point r with spin projec-
tion α at the instant time t. Equivalently, one can intro-
duce the charge n (r,t) = TrLσρ (r, r, t) and magnetiza-
tion ⃗m (r,t) = TrLσρ (r, r, t)⃗σ densities (also obtained in
the time-independent case from Eqs. (2.11) and (2.12)).
In the adiabatic approximation, the spin and charge den-
sities are expressed in terms of Kohn-Sham spinor eigen-
fuctions ψνα (r,t) and the corresponding eigenenergies
ϵν (t) satisfying the Kohn-Sham equation of Eqs. (2.1)
and (2.14). The Kohn-Sham wave functions and the cor-
responding energies depend here on time due to the time-
dependence of the densities and external ﬁeld (the latter
is supposed to be slowly varying in time in comparison
to the characteristic electron energies).
Very importantly, even in the local-density approxima-
tion there is a nonlocality in the kinetic term in the total
density functional, via nonlocality of the kinetic-energy
term T[ˆρ], due to nonlocality of Kohn-Sham states. The
total eﬀective magnetic ﬁeld can be represented as
⃗Btot(r) = −
δT
δ⃗m(r) −δExc
δ⃗m(r) + ⃗Bext(r),
(6.1)
and the ﬁrst term in the r.h.s. of Eq. (6.1) depends on
⃗m(r′) at r′ ̸= r even if the exchange-correlation term
⃗Bxc(r) is local. This leads to exchange interactions, i.e.,
a connection between magnetization direction in diﬀer-
ent points of space. In this sense, exchange parameters
discussed until now all correspond to kinetic, or indirect,
exchange.
As will be discussed in Section VII, the whole expe-
rience of calculations of exchange parameters via the
LKAG formula, or its extensions, is that for many classes
of systems it reproduces experimental data with good ac-
curacy. This means that in most of the cases indirect,
that is, a kinetic contribution, to exchange interactions
is dominant. There is nevertheless a natural questions as
to what is exactly neglected in this approach [119]. To
answer this question one needs to go beyond the local
spin-density approximation and study the nonlocality of
⃗Bxc[⃗m].
There are many works on a general analysis of non-
collinear magnetism within density functional without lo-
cal spin-density approximation [3, 29, 79, 119–131]. Here
we focus only on one aspect of this activity, namely, the
applicability of the local spin-density approximation to
the calculations of exchange parameters. To study this
issue we need to investigate the origin of nonlocality in
the exchange-correlation functionals.

21
At the construction of the local spin-density approxi-
mation, one starts with the calculation of the exchange-
correlation energy for a homogeneous electron gas, from
a given charge and spin density. A natural step in study-
ing its nonlocality is to replace this reference system by
the simplest nonuniform state, namely, the electron gas
in a spin-spiral state. This approach was suggested by
Kleinman [120] at the level of the Fock approximation
and by Katsnelson and Antropov [119] at the level of
the random phase approximation (RPA). The latter was
developed further and used in electronic structure cal-
culations, e.g.
as published in Refs. 79, 123–129.
To
illustrate the basic idea and some simple estimations we
will follow here the presentation of Ref. 119.
Let us consider a homogeneous electron gas in the spin-
density-wave (SDW) state. The latter is characterized
by anomalous averages sp =
D
c+
p+Q/2↑cp−Q/2↓
E
where
c+
pσ,cpσ are the creation and annihilation operators of
electrons with momentum p and spin projection σ. To
consider a spin-density wave, it is convenient to use a
spinor representation of the creation and annihilation op-
erators, similar to the Gorkov-Nambu formalism in the
theory of superconductivity [132, 133]. To this end, we
introduce the spinor operator ηp = (c+
p+Q/2↑, cp−Q/2↓).
Then the Hamiltonian of the homogeneous electron gas
takes the form
H =
X
p
ηphpηp + 1
2
X
q̸=0
X
pp′
vc (q)
 η+
p+qηp
 
η+
p′−qηp′

,
(6.2)
where vc (q) = 4πe2/q2V, V is a volume, hp = θp +
τpσz −∆pσx and
θp = 1
2
 εp+Q/2 + εp−Q/2

= p2/2 + Q2/8 −µ,
τp = 1
2
 εp+Q/2 −εp−Q/2

= pQ/2,
(6.3)
where εp = p2/2−µ is the energy of the free electron and
2∆p is the antiferromagnetic gap, related to the forma-
tion of the spin-density wave. In the Fock approximation
the gap equals to
∆p =
X
p′
vc(p −p′)sp′.
(6.4)
To simplify the consideration as much as possible one can
replace vc by and eﬀective Stoner exchange splitting I =
 V ↑
exc −V ↓
exc

/ (n↑−n↓) , where V σ
exc = ∂(nεexc) /∂nσ.
Then, Eq. (6.4) can be replaced by ∆= I (n↑−n↓) /2,
where ∆does not depend on p.
To calculate the correlation contribution to the energy
of the homogeneous electron gas one can restrict one-
self to the simplest meaningful approximation, namely,
the RPA corresponding to the summation of all “bubble”
diagrams [134, 135]. The “bare” Green function in the
Matsubara representation has the form
G (iωm, p) =
1
iωm −hp
= iωm −θp + τpσz −∆pσx
 iωm −ξp↑
  iωm −ξp↓
 ,
(6.5)
where ξp↑,↓= θp ∓Ep is a quasiparticle spectrum for
SDW with Ep =
q
τ 2p + ∆2. From Eq. (6.5) one can ﬁnd
the occupation number matrix
2Np =

1 + τpσz −∆σx
Ep

fp↑+

1 −τpσz −∆σx
Ep

fp↓,
(6.6)
where fpσ = f (ξpσ) is a Fermi function. Then for the
Fock contribution to the exchange-correlation energy one
has
EF ock = −1
2
X
pp′
vc (p −p′) Tr [N(p)N(p′)]
= E(1)
F ock + E(2)
F ock ,
(6.7)
where
E(1)
F ock = −1
4
X
pp′σ
vc (p −p′) fpσfp′σ

1 + τpτp′ + ∆2
EpEp′

,
E(2)
F ock = −1
2
X
pp′
vc (p −p′) fp↑fp′↓

1 −τpτp′ + ∆2
EpEp′

.
(6.8)
Further, one may consider the case of small Q only, which
is suﬃcient for the calculation of the contributions to
the spin-wave stiﬀness constant. The RPA-based calcu-
lations without this restriction were ﬁrst performed in
Ref. 125. Expansion of Eq. (6.7) up to Q2 leads to the
corrections of the chemical potential (from the conserva-
tion of the number of particles)
δeµ = eµQ −eµQ=0 = −
Q2
8F (n↑, n↓)
(6.9)
and to the total energy
EF ock
V
= −e2
8π3
(
 p4
F ↑+ p4
F ↓

−Q2
" 1
2F −2
3
  p2
F ↑+ p2
F ↓

+ (pF ↑+ pF ↓)2
12F 2
# )
.
(6.10)
where F = (pF ↑+ pF ↓)I(n↑, n↓)/2π2 is a dimensionless
Stoner enhancement factor, pF σ = (6π2nσ)1/3.
To treat the correlation eﬀects, one may use RPA and
sum up the bubble diagrams [134, 135]. The correspond-
ing expression is expressed in terms of the empty-loop
polarization operator
Π (iω, q) = −Tr
X
p
T
X
εn
G (p + q, iεn + iωn) G (p, iεn) .
(6.11)

22
The corresponding contribution to the Ω-potential equals
Ωcorr =
X
q
∞
Z
−∞
dω
4π
(
ln

1 + vc (q) Π (iω, q)
1 + vc (q) ΠQ=0 (iω, q)

−vc (q) [Π (iω, q) −ΠQ=0 (iω, q)]
)
,
(6.12)
where only Q-dependent part of the correlation energy
was considered. Substituting Eq. (6.5) into Eq. (6.11)
one ﬁnds
Π (iω, q) = 1
2
X
p,σ

1 + τpτp+q + ∆2
EpEp+q

fpσ −fp+qσ
iω + ξpqσ −ξpσ
+ 2
X
p

1 −τpτp+q + ∆2
EpEp+q

fp↑−fp+q↓
iω + ξp+q↓−ξp↑
. (6.13)
The corresponding exchange-correlation addition to the
spin wave spectrum at ﬁnite Q can be written as
δωQ = 4
M [ESDW (Q) −ESDW (0)] ,
(6.14)
where ESDW (Q) is the total energy of the spin spiral and
M is the magnetic moment of the unit cell.
The
next
step
is
to
restore
the
expression
of
the exchange-correlation functional corresponding to
Eq. (6.14). The simplest rotational invariant expression
has the form
Eexc =
Z
dr {nεexc (n↑, n↓) + λ (n↑, n↓) D} ,
(6.15)
where D = (∇αeβ) (∇αeβ) = (∇θ)2 + sin2 θ (∇ϕ)2 is the
rotational invariant of lowest order. Here ⃗e = ⃗m/ |⃗m| ≡
(sin θ cos ϕ, sin θ sin ϕ, cos θ) . More detailed analysis of
the functional dependence in the general density func-
tional can be found in Refs. 79, 124–128. Based on the
analysis of Fock and RPA expressions for the total en-
ergy of the spin-spiral state, the following expression for
λ was suggested in Ref. 119:
λ (n↑, n↓) = −
e2
16π2
 1
F −4
3
  V ↑
excpF ↑−V ↓
excpF ↓

+
e2
96π3F 2 .
(6.16)
To evaluate the importance of the non-locality of the
exchange-correlation functional for the exchange param-
eters one can calculate the corresponding contribution to
the spin-wave stiﬀness constant
D = 4
M

lim
Q→0
ESDW (Q) −ESDW (0)
Q2

.
(6.17)
Namely, Eq. (6.15) gives:
δD = 4
M
Z
drλ (n↑, n↓) ,
(6.18)
with integration over the whole elementary cell. The nu-
merical calculations for the case of Fe and Ni, performed
in Ref. 119, led to the following results: whereas the
standard local-spin-density approximation gave the val-
ues 239 meVÅ2 and 692 meVÅ2 for D in bcc Fe and fcc
Ni, respectively, the corrections, Eq. (6.18), for δD were
equal to 13 meVÅ2 and 45 meVÅ2, respectively. Hence,
the total D became 253 meVÅ2 and 735 meVÅ2 for bcc Fe
and fcc Ni, respectively. Thus, for these materials, that
serve as important systems for testing theoretical mod-
els, the indirect (kinetic) contributions are much larger
than the direct contributions from the non-locality of the
exchange-correlation functional.
In the model (e.g., tight-binding) approach direct ex-
change enters the Hamiltonian straightforwardly, via the
matrix elements
Jij = ⟨ij |v| ji⟩
=
Z
drdr′ψ∗
i (r)ψ∗
j (r′)v (r −r′) ψj(r)ψi(r′),
(6.19)
where v (r −r′) is the eﬀective potential of electron-
electron interaction (in the simplest approximation, just
Coulomb interaction). In most of the cases, this contri-
bution is supposed to be irrelevant but in some cases it is
claimed that this interaction is important and can even
change the calculated magnetic ground state (e.g., trans-
form a spin-spiral state into a ferromagnet). Examples
include single-side hydrogenated graphene [136] and half-
metallic CrO2 [137]. The direct exchange interaction is
also relevant in single-side ﬂuorinated graphene [136] and
fourth-group adatoms at the surface of Si(111) [138] and
SiC(0001) [139].
Whereas sp-bonded magnets may be
considered as an exotic exception, the example of CrO2
demonstrates that the issue is not completely clear even
for conventional 3d-electron magnets and requires a care-
ful investigation.
VII.
NUMERICAL EXAMPLES OF
INTERATOMIC EXCHANGE
In this section we provide examples of numerical cal-
culations of interatomic exchange interactions as well as
magnetic moments, for several classes of materials. Re-
views of theoretical results of magnetic materials have
been published before, albeit with diﬀerent focus than
the present article.
However, it is noteworthy that in
Refs. 1, 3, and 9, a comparison between experiment and
theory regarding bulk magnetic moments was made, with
some of the results shown in Fig. 2. In general DFT calcu-
lations reproduce experimental magnetic moments with
an error that seldom exceeds 5%, in particular for transi-
tion metal elements and their intermetallic compounds.
Since reviews of magnetic moments have been published
before, we focus in this section on results of the inter-
atomic exchange. The work in Ref. 3 also reviews results
of interlayer exchange interactions of magnetic multilay-

23
ers, as well as magnon dispersion from spin-spiral calcula-
tions [29, 30, 32–35]. Results for thin ﬁlms were reviewed
in Ref. 140, where magnon measurements based on spin-
polarized electron energy loss spectroscopy (SPEELS)
were compared to adiabatic magnon spectra evaluated
from explicit calculations of interatomic exchange. Fi-
nally, we note that in Ref. 141 a full review was published
of the magnetic properties, including explicit calculations
of interatomic exchange, of diluted magnetic semiconduc-
tors. We also note here that the most direct comparison
between experiment and theory of interatomic exchange
interactions is likely to be the magnon dispersion. This
is in contrast to, e.g., estimates of the Curie tempera-
ture, that in principle also reﬂects the strength of the
interatomic exchange. However, most of the DFT cal-
culations of interatomic exchange are carried out at low
(in fact zero) temperature, which challenges a compar-
ison for results at ﬁnite temperature.
If the exchange
interaction was independent on temperature (or mag-
netic conﬁguration), a comparison to experimental re-
sults at ﬁnite temperature, such as the ordering temper-
ature, would be unproblematic. Although most materials
do have interatomic exchange that depends on temper-
ature, there have been progress also in calculations of
conﬁguration dependent exchange, and magnetic prop-
erties at ﬁnite temperature, as discussed in Section V.
Before entering details of materials speciﬁc results of in-
teratomic exchange, we note that since we give examples
from previously published works, there will be a mixture
of units presented. In particular, energy is in some works
given in eV and sometimes in Ry.
Early implementations of the explicit method, i.e.
Eq. (5.55), were incorporated in the linear muﬃn-
tin orbital (LMTO) [142] and Korringa-Kohn-Rostoker
(KKR) [143, 144] electronic structure methods. Both ap-
proaches were ﬁrst formulated within the atomic sphere
approximation (ASA), where the potential inside each
sphere is assumed to be spherically symmetric.
For
closed-packed systems this is a reasonable approxima-
tion and the results were consistent.
However, with
the development of so called full-potential electronic
structure methods, which are free from geometrical con-
straints of the self-consistent density and potential, it
quickly became clear that for more loosely-packed, or
low-dimensional, systems, this level of approximation is
needed. There are several ab-initio implementations, us-
ing diﬀerent basis functions, that employ a full-potential
approach. However, it should be noted that the compu-
tationally much more eﬃcient ASA calculations are still
being pursued with good accuracy, especially for close
packed systems.
The biggest advantage of ASA-based codes is the com-
pact representation of the basis functions, which are
atom-centered and have a well-deﬁned il-character. This
is very convenient for implementation of the magnetic
force theorem, which operates with quantities, which
have a site index i attached (section V). In the full-
potential codes the basis set is more extended and in
general a minimal basis set is avoided. In this case, the
problem of deﬁning a good representation of the local
basis (see Eq.4.8) becomes less obvious and in general it
does not have a unique solution. This issue sometimes
hinders a proper quantitative comparison between the
results obtained with various codes or even implementa-
tions within a given code.
When one evaluates the interatomic exchange interac-
tion between two atoms, the resulting values may depend
on the choice of orbitals, which represent these atoms (see
e.g. Ref. 145 and 146). This issue was discussed in de-
tail in Ref. 147 and 148, where the comparison between
the Jij’s obtained with the projection on the muﬃn-
tin sphere and Löwdin-orthogonalized orbitals were pre-
sented. Overall, the results for fcc Ni and hcp Gd were
very consistent, but in general it is found that depending
on system there may be an unwanted sensitivity to the
projection. Moreover, strong covalent bonding between
3d and ligand states also calls for either perturbing the
spins of the hybrid orbitals or for explicit treatment of
ligand spins as a standalone entity [149–151].
One commonly used choice is to use Wannier func-
tions to obtain a localized basis for the Jij calcula-
tions [150, 152–154].
In particular, maximally local-
ized Wannier functions [155] form an appealing basis set,
which is well-deﬁned for a given set of bands and thus
enables the comparison of the magnetic interactions ob-
tained with diﬀerent DFT codes. There are a couple of
versatile softwares, which allow one to apply the present
formalism for an arbitrary tight-binding Hamiltonian in-
dependent of the chosen projection scheme [156, 157].
Having these issues in mind, we now proceed with a
discussion of calculated results of interatomic exchange
for several classes of magnetic materials.
A.
Elemental transition metals
One of the most important test cases for explicit cal-
culations of interatomic exchange, is the ability to quan-
titatively reproduce magnetic properties such as spin-
wave dispersion and ordring temperature of the three
ferromagnetic 3d elements; bcc Fe, hcp Co and fcc Ni.
The spin-wave stiﬀness, D, of bcc Fe was evaluated in
the original articles of explicit calculations of interatomic
exchange [20, 28].
In these works, the interaction be-
tween the ﬁrst two coordination shells was calculated for
bcc Fe. The dominant, nearest-neighbour (NN) coupling
was found to be ferromagnetic (FM), while the next NN
coupling was found to be antiferromagnetic, and much
smaller. The obtained value of the spin-wave stiﬀness, D,
was 294 meVÅ
2 for bcc Fe, which is in good agreement
with experimental values that range from 305 meVÅ
2
(Ref. 158) to 314 Å
2 (Ref. 159). This initial result proved
the formalism described in detail in Section V to be
highly promising. The formula for calculating the Heisen-
berg exchange, Jij, also allowed the authors of Ref. 20

24
Figure 8. Spin-wave stiﬀness in bcc Fe as a function of the
upper integration limit. Figure from Ref. 20.
and 28 to evaluate D as a function of the upper inte-
gration limit, which can be viewed as the position of the
Fermi level (see Fig. 8). This provides valuable informa-
tion of how D can be aﬀected by doping of the material.
In particular, as one changes the Fermi level to arrive at
the half-ﬁlled 3d-shell, at around -1 – -3 eV in Fig. 8, the
D takes negative values, indicating that the FM reference
state becomes unstable.
In Refs. 20 and 28 it was argued that the NN ex-
change coupling primarily determines the value of spin-
wave stiﬀness. The interactions with the neighbours be-
yond 2nd coordination shell were not computed, as their
contribution to D was expected to be negligibly small
due to their oscillatory sign [62]. However, later it was
shown that the magnetic interactions in elemental tran-
sition metals are, in fact, extremely long-ranged [160–
162] and obtaining a well-converged value of the spin-
wave stiﬀness was indeed found to be extremely diﬃ-
cult [160, 161].
Pajda and co-workers made a substantial advancement
in that direction, by performing a thorough study of
spin-waves and ordering temperatures, calculated from
explicit values of Jij, for bcc Fe, fcc Co and fcc Ni [163].
Their calculations were performed using a tight-binding
LMTO method [142]. This work was done using the full
set of valence states (spd basis) and a very ﬁne k-point
mesh. For a magnetic material with one-atom per unit
cell the spin-wave dispersion is governed by the exchange
couplings, Jij, in the following way:
ω(q) = 4µB
Ms
X
j
Jij(1 −exp (iq · Rij)),
(7.1)
where Ms is the value of the saturated magnetic moment
in the units of µB. Since the real space values of Jij’s
are involved, the summation has to be truncated. The
authors of Ref. 163 considered interactions with ﬁrst 195
and 172 shells for bcc and fcc metals, respectively, in
order to ensure that the spin-wave dispersions are con-
verged. The obtained dispersion for fcc Ni is shown in
Fig. 9.
The experimental data obtained with inelastic
neutron scattering is also shown for comparison. Since
Figure 9. Calculated spin-wave dispersion relation of fcc Ni
from Ref. 163. Experimental data are taken from Ref. 169.
the experimental spin waves become damped for higher
values of q, it is only possible to compare experiments
and theory in a region around the zone-center, and as
Fig. 9 shows, in this regime the agreement between theory
and experiment is impressive. Results of similar accuracy
were obtained from spin-spiral calculations [3], and it is
reassuring that DFT calculations of interatomic exchange
obtained from diﬀerent methods give similar results. In
fact a direct comparison between the two methods was
made for bcc Fe, with very similar results [164].
In Fig. 9 experimental data are only shown for bcc Fe
and fcc Ni. This is primarily due to that it is diﬃcult to
measure inelastic scattering of polarized neutrons of Co,
due to the strong self-absorption eﬀect. In addition, the
crystal structure of bulk Co is hcp, not fcc. However, as
reviewed in Ref. 140, experimental results of the magnon
dispersion have been published for thin ﬁlms of Co (in the
fcc structure), as an overlayer of, e.g., Cu (001). Also
here can one ﬁnd good agreement between theory and
experiments. The results for thin ﬁlms of fcc Co were also
reported in Refs. 165–168, with good agreement between
theory and observations.
In Ref. 163 the long-ranged character of the oscillations
was discussed in great detail.
Using stationary phase
approximation and the asymptotic behaviour of the inter-
site Green function, the long-range character of the Jij’s
was shown to be of the following form:
Jij ∝ℑexp [i((k↑
F + k↓
F )Rij + Φ↑+ Φ↓)]
R3
ij
,
(7.2)
where kF is the wave vector of energy EF having the
direction such that the associated group velocity is par-
allel to Rij, Φ is an additional phase factor, while ↑and
↓denote spin projections.
For weak itinerant-electron
ferromagnets, which have both spin-up (majority) and
spin-down (minority) bands partially occupied, the Fermi
wave vectors are real and one recovers the oscillatory ex-
change interaction, known as Rudermann-Kittel-Kasuya-
Yosida (RKKY) mechanism of indirect exchange [170].

25
At the same time, if one of the spin channels is com-
pletely empty or ﬁlled, the Fermi wave vector becomes
imaginary kF = iκF , which in turn results in the evanes-
cence of the Jij’s. Thus, in weak ferromagnets one can
expect more long-ranged magnetic interactions than in
e.g. half-metals or strong ferromagnets, that have a ﬁlled
majority-band. This result also provides an explanation
for why bcc Fe, being a weak ferromagnet, shows much
more pronounced Kohn anomalies in the spin-wave spec-
tra compared to Co and Ni [32].
In addition, it was shown that the interactions with
very distant neighbors must be taken into account when
calculating the spin-wave stiﬀness. However, by consid-
ering interactions between very distant atoms (which are
more than 6 lattice constant apart), the value of D keeps
oscillating as one takes more coordination shells in the
summation. The reason for this is that the expression
for the D includes a term R2
ij (see Eq. (7.3). The Jij’s
have at worst (from a summation point of view) an R−3
ij
dependence (Eq. (7.2)). As a result, the numerical con-
vergence of D is quite problematic. One solution to this
problem was also proposed in Ref. 163. It was suggested
that the expression for spin-wave stiﬀness can be regular-
ized by introducing an additional decay factor η, which
ensures its convergence at large distances. So the D(η)
is then deﬁned as:
D(η) =
lim
Rmax→∞
2µB
3Ms
X
Rij≤Rmax
JijR2
ije(−η
Rij
a )
(7.3)
and ﬁnally the spin-wave stiﬀness is calculated by taking
the limit of η going to zero:
D = lim
η→0 D(η).
(7.4)
The so obtained values are shown in Table I. They
show systematically good agreement with experimental
data, measured by diﬀerent techniques.
In Table I we also show the experimental results for
hcp Co. The magnetic interactions in hcp Co were calcu-
lated in several studies [160, 171, 172]. In one of the more
recent works the spin-wave excitations and the Tc were
calculated by means of atomistic spin dynamics simula-
tions and excellent agreement with experiment for both
properties was reported [173].
The magnetic ordering temperatures of the three FM
metals were also calculated in a number of publications,
from several diﬀerent approaches: mean-ﬁeld approxima-
tion (MFA), Tiablikov’s decoupling scheme (also known
as random phase approximation (RPA) [174]), classi-
cal Monte Carlo simulations or atomistic spin dynam-
ics [9, 25, 175–178], while the latter uses unsupervised
machine learning. The MFA values for bcc Fe and fcc
Co were reported to be in reasonably good agreement
with experiment. For instance, for Fe it was found to be
∼1400 K, while the experimental value is 1045 K [163].
Given the fact that MFA is known to overestimate the
estimates by roughly 30% as compared with more accu-
Table I. Calculated and measured values of spin-wave stiﬀness
in elemental ferromagnets in the units of meVÅ
2.
Metal
Dtheo (Ref. 163)
Dexp
Fe (bcc)
250 ± 7
281c, 266a, 256a
Co (fcc)
663 ± 6
384a, 371a, 466d, 360e
Ni (fcc)
756 ± 29
374a, 403a, 555b
a - Ref. 180 and references therein.
b - Ref. 181
c - Ref. 182
d - Ref. 165 (thin ﬁlms)
rate Monte Carlo method [179], the calculated value is
close to what one should expect.
The calculations for fcc Ni suggested a Tc of about 397
in MFA and 350 K in RPA [163], which is much smaller
than the experimental value of about 630 K. This strik-
ing underestimation was already reported in Refs. 28 and
160. However, the spin-wave stiﬀness is, on the contrary,
overestimated as compared with experiment. This sug-
gests that the inconsistency of the results for Ni can not
be circumvented by a simple re-scaling of the exchange
integrals.
The problem of describing magnetic excitations in fcc
Ni has been addressed for a long time. Bruno suggested
that the corrections to the LKAG formula due to trans-
verse constraining ﬁelds become substantial when the ex-
change splitting is small and becomes comparable with
magnon energies [92], as discussed also in Section II of
this review.
This is indeed the case of fcc Ni, whose
saturated magnetic moment amounts to roughly 0.6 µB
per atom, indicating that the splitting between spin-up
and spin-down bands is the smallest among three ele-
mental magnets as shown in Ref. 183. Using renormal-
ized values of exchange parameters, it was shown that
the MFA-based Tc estimates can be substantially im-
proved [92]. At the same time, the employed corrections
were shown not to modify the magnon spectrum [83],
such that the good agreement between theory and ex-
periment remained (Fig. 9).
However, as discussed above, the case of Ni also raises
questions whether the small moment of Ni can be treated
classically. In addition, the values of the magnetic mo-
ments in fcc Ni depend signiﬁcantly on the magnetic con-
ﬁguration, and this dependence is much more pronounced
than in, e.g., bcc Fe 161, 177, and 184. It seems that the
best gauge for estimating the accuracy of interatomic ex-
change of fcc Ni is to compare magnon dispersion, as
opposed to the Curie temperature.
Since both the calculated magnetic moments and the
interatomic exchange integrals depend on the reference
state, it is reasonable to expect that the spin stiﬀ-
ness should be better described by the set of Jij’s ex-
tracted from the ordered magnetic ground state, while
the Tc should be estimated using a magnetic conﬁgura-
tion found at the ordering temperature [185]. The prob-
lem is that representing such a state in DFT calculations

26
Figure 10. Spin-wave dispersion in bcc Fe as obtained from
DFT+DMFT (referred to as LDA+Σ(E)) and spin-polarized
DFT (LSDA) calculations [108].
is not straightforward. In the disordered local moment
(DLM) picture [97], the magnetic moments experience
a completely spin-disordered environment introduced via
the coherent potential approximation (CPA) [186, 187].
However, in these calculations, the local moment in fcc
Ni collapses to zero [185], in contrast to observations. A
generalized Heisenberg model, which takes into account
not only the short-range order eﬀects [188], but also al-
lows the magnetic moments to change their magnitude,
i.e. introducing longitudinal spin ﬂuctuations, were pro-
posed in Refs. 184 and 189, and from this model the cal-
culated Tc’s of bcc Fe and fcc Ni are in good agreement
with experimental values.
In general, interatomic exchange is a quantity that de-
pends critically on the details of the electronic structure.
The results discussed so far were obtained employing
LSDA or the similar, spin polarized generalized gradi-
ent approximation (GGA). Electron correlations beyond
LSDA/GGA can be captured by means of a combination
of DFT and dynamical mean ﬁeld theory [17–19].
In
Ref. 108 this method was used to calculate interatomic
exchange. It was shown that taking into account local
correlations of bcc Fe, can inﬂuence both the local mag-
netic moment, and the Jij’s. Subsequent work [162] ba-
sically conﬁrmed this result.
The results shown in Fig. 10 indicate that the calcu-
lation of the spin-wave stiﬀness in bcc Fe, obtained us-
ing LSDA is diﬀerent from results of DFT+DMFT (by
roughly 20%). We note that the starting point for these
calculations was non-magnetic DFT solution, and there-
fore the local exchange splitting emerges purely from
DMFT and is governed by the Hubbard U term. How-
Cr
Mn
Fe
Co
Ni
-2.0
-1.0
0.0
1.0
2.0
-2J1(mRy)
Eg - Eg
Eg - T2g
T2g - T2g
Total
AFM
FM
Figure 11. Calculated orbital decomposed NN exchange in-
teraction in elemental 3d metals in the bcc structure from
Ref. 193.
ever, it was shown that if one starts from magnetic DFT
and performs DMFT calculations on top of it, then the
diﬀerences between LSDA and LSDA+DMFT results are
quite modest [147]. This is partly related with the fact
that the exchange splitting is introduced by LSDA and
does not change much after U is explicitly added to con-
sideration. In the case of moderate correlation strength,
the overall diﬀerences in the total exchange interaction J0
are related to the quasiparticle’s mass renormalization,
brought by electron-electron interactions [190].
How-
ever, since the orbitals of diﬀerent symmetry have dif-
ferent eﬀective masses, the overall impact of dynamical
correlations on each individual Jij is more sophisticated.
In Ref. 191 it was shown that dynamical correlations,
as described by DMFT, can produce up to 30 % vari-
ation of the leading Heisenberg and DM exchange in-
teractions.
This was exempliﬁed by a study of inter-
metallic compounds such as CoPt and FePt, MnSi and
FeGe, as well as transition metal bilayers; Co/Pt(111)
and Mn/W(001).
Furthermore, non-local correlations,
modelled on the GW level, have also been made for Fe, Co
and Ni [192], albeit with marginal changes in the Heisen-
berg exchange.
A great advantage of the formalism of explicit calcu-
lation of the Jij parameters, is that one can perform
orbital-by-orbital decomposition of each magnetic cou-
pling. This decomposition is possible since in the LKAG
formula (given by Eq. (5.55)) the TrL can ﬁrst be taken
over just a part of the orbitals, i.e., one can see the indi-
vidual orbital contributions of the exchange parameter,
e.g. in a cubic material one can follow the coupling be-
tween diﬀerent irreducible representations of the 3d or-
bitals (Eg and T2g). This turns out to be a powerful tool
for obtaining a microscopic understanding of the nature
of magnetic interactions. To be speciﬁc, if the material
has cubic symmetry, the d orbitals split into Eg and T2g
manifolds. In the basis of cubic harmonics the local ex-
change splitting becomes a diagonal matrix and the ex-
change interaction can be represented as a sum of orbital
contributions Jmm′
ij
, where an orbital m on the site i is

27
Figure 12.
Magnetic moment in µB’s (solid lines) and the
ﬁrst derivative of the energy (Ω) with the respect to angle
θi (dashed lines) for the case of bcc Fe and fcc Ni shown on
the left and right sides, respectively, when one spin is rotated
with a ﬁnite θi in a ferromagnetic background [177] as shown
by the added schematic ﬁgure.
coupled with each orbital m′ on the site j. In the cubic
system it is therefore natural to group these terms into
three contributions:
Jij = JEg−Eg
ij
+ JEg−T2g
ij
+ JT2g−T2g
ij
,
(7.5)
which combine the individual orbital contributions ac-
cording to the symmetry of the d orbitals involved. In
Ref. 193 such orbital decomposition of the NN exchange
integral was performed for a series of transition metal
alloys in the bcc structure.
The results, also shown
in Fig. 11 reveal that in case of Mn and Fe there is a
strong competition between diﬀerent terms having oppo-
site (FM and AFM) signs. This balance is most intricate
for bcc Fe, where all three terms in Eq. (7.5) are of com-
parable size. Most interestingly, it was shown that thanks
to this decomposition it was possible to identify the mi-
croscopic exchange mechanisms to each of these three
channels, revealing a combination of RKKY, double- and
super-exchange [193].
Overall, the sign of the NN coupling in all elemental
3d follows the famous Bethe-Slater curve, but it is gov-
erned by a complex interplay between diﬀerent orbital
contributions [194]. This result paves the way towards
designing magnetic interactions in metallic 3d systems in
general, and allows for a deeper analysis of interatomic
exchange interaction.
One way to continue the analy-
sis is to calculate the symmetry-decomposed interaction
parameters between further neighbors as was done for
bcc Fe [193] and for other 3d elements [194].
One of
the most important conclusions in case of bcc Fe is that
the exchange between the T2g orbitals is Heisenberg-like
and long-ranged while it is relatively short-ranged with a
substantial non-Heisenberg behavior in case of the Eg-Eg
and the mixed (Eg-T2g) channel [193].
Note that the non-Heisenberg behavior of bcc Fe and
especially of fcc Ni have been discussed for a long time
[177], from calculations that considered δΩone
i
when a
spin is rotated by a ﬁnite θi, as shown in Fig. 12. The
Figure 13.
First-nearest neighbour Heisenberg and non-
Heisenberg interatomic exchange parameters in bcc Fe when
one spin is rotated by a ﬁnite θi running from zero to π at
site i in a ferromagnetic background in case of bcc Fe [195].
JH
1
= J(2)
1
+ A(2)xx
1
and JNH
1
= −2A(2)zx
1
, see Eqs. (5.45)
and (5.47). The black curve stands for the total value while
the red, blue, and green lines show its symmetry decomposi-
tion in the d channel deﬁned by Eq. 7.5.
results of the ﬁgure are clear; a strong conﬁguration de-
pendence can be observed for the magnetic moment and
the angular dependence of the energy variation does not
follow a sine function, especially for angles far from the
ground state.
In Ref. 195 a similar system was considered, i.e., one
spin was rotated by a ﬁnite θi at site i on a bcc Fe lat-
tice when every other spin formed a ferromagnetic back-
ground and θi ran from 0 to π. In this case the two-site
energy variation was in the main focus. Note that in gen-
eral one formally gets for the two-site energy variation (in
the lack of SOC) that
δΩtwo
ij
= −
 JH
ij cos θi + JNH
ij
sin θi

δθiδθj ,
(7.6)
where the terms which are proportional to a cosine and
a sine function are referred to as the Heisenberg (H)
term and the non-Heisenberg (NH) term, respectively
and JH
ij = J(2)
ij
+ A(2)xx
ij
and JNH
ij
= −2A(2)zx
ij
accord-
ing to Eqs. (5.45) and (5.47). In the discussion of this
paragraph, when the ﬁrst-nearest neighbour couplings
are considered, the ij indices are replaced by the in-
dex 1.
The calculated Heisenberg and non-Heisenberg
results for diﬀerent values of θi are shown by the solid
black line in Fig. 13. The ﬁgure shows that in a gen-
eral, non-collinear, case the non-Heisenberg contribution
can be signiﬁcant. However, the symmetry decomposi-
tion proves that in the T2g channel the system is more
Heisenberg-like and the non-Heisenberg behavior origi-
nates from the Eg and the mixed channel.
This is in
good agreement with the conclusions based on collinear
formalism presented in Refs. 193 and 194.

28
Figure 14. Calculated Fe-Fe exchange interactions with ﬁrst
3 coordination shells in fcc Fe0.5Ni0.5 for two diﬀerent unit
cell volumes (V ) [196]. The 16-atom supecell-based results
for V =73.6 a.u.3 and V =70.3 a.u.3 are shown with blue and
green circles, respectively. Supercell- and CPA-averaged Jij’s
are shown for comparison.
B.
Itinerant magnets based on 3d metal alloys and
compounds
The explicit
method of calculating exchange has
been widely applied to study 3d-based alloys and
compounds[197, 198], and we describe in this sub-section
some selected examples. According to the Slater-Pauling
curve, the maximal magnetization per atom in 3d metal
alloys is achieved for the Fe1−xCox family. In the entire
composition range, these alloys are ferromagnetic [199].
Ref. 199 suggested that all pairs of Fe-Fe, Fe-Co and Co-
Co interactions are FM and the NN JFe-Co have the high-
est value. The latter result was also reported earlier for
an ordered B2-FeCo [200], highlighting the fact that the
eﬃcient hybridization between Fe and Co states results
in the enhancement of both the saturated magnetization
and the Tc. Interestingly, for x>0.17, an experimental
value of Tc of the bcc phase is unknown, since the struc-
tural bcc-fcc transition occurs before the bcc structure
reaches a Curie temperature.
The temperature of the
bcc-fcc transition sets a lower value of the expected Tc of
the bcc structure, and it is very high. In fact, MFA-based
estimates predict values of 1600K for x=0.5 [199], which
is consistent with expectations. An interesting feature
of this family of alloys is that by changing concentra-
tion, one gradually transforms the electronic structure,
to achieve a transition from weak to strong ferromag-
netism. As a result, depending on Co concentration, the
magnetic interactions (and hence the Tc’s) have very dif-
ferent sensitivity to, e.g., volume changes [199].
Iron-nickel alloys form in the fcc crystal structure, and
are celebrated thanks to the Invar eﬀect; a vanishing ther-
mal expansion at room temperature, which is commonly
attributed to the non-collinearity of the magnetic conﬁg-
uration [201]. In Ref. 196, the magnetic interactions were
calculated in Fe0.5Ni0.5 and Fe0.65Ni0.35. They were com-
Figure 15. Calculated versus measured Tc’s in the series of
L21 Heusler alloys [204].
pared with those in (fcc) γ-Fe, and it was found that al-
though both types of systems are frustrated, the physical
picture is drastically diﬀerent. In fcc Fe, the frustration
comes from the competition between FM NN exchange
coupling and that with more distant neighbours, having
long-ranged oscillatory character. In contrast, the Fe-Ni
alloys are characterized by highly dispersive interactions
already with the ﬁrst coordination shell, as one can see
in Fig. 14. Although CPA-based results agree well with
the averaged Jij’s obtained from the supercell approach,
it is clear that the latter captures more details and re-
veals strong inﬂuence of the local environment, which
infers why the magnetic order of these alloys is so com-
plex. Note that fcc-based Fe-Mn alloys have a similar ten-
dency to AFM coupling and non-collinearity [202]. Gen-
erally, for Ni-based alloys, it was found that the renor-
malized [92] Jij’s provide better estimates the Tc’s [203],
which is again related with relatively small exchange
splitting of its 3d states.
Heusler alloys have been intensely studied with the ex-
plicit formalism of exchange interaction [204–213]. For
instance, in Ref. 204, a systematic study of magnetic in-
teractions, spin wave dispersion and Tc was done for the
series of Heusler compounds with L21 structure. The re-
sults shown in Fig. 15 demonstrate that Tc’s calculated
from Jij’s combined with a mean ﬁeld (MFA) estimate of
the ordering temperature, are overall in excellent agree-
ment with experiment. Given all the approximations of
this work, such as a MFA for Tc estimation and the ne-
glection of local correlations, one may regard this excel-
lent result as somewhat fortuitous. However, it is still
impressive that the theory is able to correctly reproduce
the experimental trend so well.
Heusler alloys attract great attention partially due to
the half-metallic character, which is observed in some of
them. However, there are many other half-metals, such
as Cr- and Mn- compounds, with zinc blende structure,
which were also successfully modelled by the formalism
presented here [214–216]. For an overall review of the

29
calculated Jij’s in half-metallic magnets see Ref. 217. As
expected from the earlier considerations (Eq. (7.2)), the
Jij’s in half-metals are relatively short-ranged.
C.
Alloys with 4d and 5d elements
The 4d and 5d metals are typically non-magnetic due
to relatively more pronounced band dispersion, which
makes it diﬃcult for the Stoner criterion to get satis-
ﬁed. However, when placed in proximity to 3d metals,
these elements can get quite substantial induced mag-
netic moments [218]. The problem of coexisting intrinsic-
and induced moments was addressed in several works on
FePt and CoPt alloys with L10 structure [219, 220]. It
was suggested that the size of the induced moments of 5d
elements is deﬁned by an eﬀective Weiss ﬁeld, produced
by the surrounding 3d magnetic moments. This idea was
later elaborated on, where a generalized Monte Carlo-
based scheme was suggested, which dynamically updates
the induced magnetic moments for each magnetic con-
ﬁguration during the simulation [221].
Application of
this scheme to the series of FexPd1−x and CoxPt1−x al-
loys was shown to deliver a systematically good agree-
ment with experimental values of Tc. In Ref. 222 it was
pointed out that such treatment of the induced moments
eﬀectively leads to the emergence of higher-order (bi-
quadratic) exchange interactions between 3d metal mo-
ments.
Indeed, such interactions were suggested [220]
to play a key role in explaining the intriguing meta-
magnetism of FeRh [223].
In ordered FePd3, the bi-
quadratic interactions were also suggested to stabilize the
non-collinear 3Q phase under pressure [224].
Alloying 3d metals with heavier elements can also
boost the eﬀective strength of the spin-orbit coupling
(SOC). Indeed, the SOC constant of Pt 5d states is
one order of magnitude larger than that of Fe 3d states,
and can therefore be used to enhance anisotropic mag-
netic interactions and the magnetocrystalline anisotropy
(MAE). Indeed, the results for Pt-doped 3d metals [225]
showed that the MAE is to a large extent deﬁned by non-
local scattering of electrons from the SOC potential of Pt
states. In the next section we will see how these ideas be-
come particularly useful for inducing large magnetocrys-
talline anisotropy and DM interaction in low-dimensional
systems.
D.
Multilayers and atoms on metallic surfaces
With the development of epitaxial growth techniques,
it is now possible to produce extremely thin layers of
magnetic materials with good control of the structural
homogeneity.
The magnetic interactions in such low-
dimensional magnets bring many surprises and opportu-
nities for applications, e.g. in spintronics and magnonics.
Moreover, for thin-ﬁlm systems, SPEELS serves as a
very accurate experimental tool for observing magnon
0
5
10
15
Cap thickness [monolayer]
200
300
400
500
Curie temperature [K]
0
5
10
15
Cap thickness [monolayer]
400
500
600
700
Co
Fe
Figure 16. RPA-derived estimates of the Tc of Co (left) and Fe
(right) monolayers on Cu(001) substrate, covered by Cu-layer
of varying thickness [226].
excitations [167].
In a number of works, the adia-
batic magnon spectra, calculated using Jij’s, are di-
rectly compared against measured spectra, with in gen-
eral a good agreement [227–229].
In order to incor-
porate ﬁnite temperatures into the theory, atomistic
spin dynamics simulations have also been widely used
to model model the surface magnons (for a review, see
Ref. 140). Among the studied systems one observes the
Co/Cu(111), Co/Cu(001), Fe/Cu(001) and Fe/W(110)
systems [230].
Exchange interactions in multilayers of elemental tran-
sition metals were investigated in many studies. Ref. 231
provides a comprehensive overview of calculated spin-
wave stiﬀnesses, obtained using diﬀerent electronic struc-
ture methods.
An interesting result was obtained in
Refs. 226 and 232, where Fe and Co monolayers on
Cu(001) was considered. Depending on the thickness of
the capping Cu layer, the Tc’s were shown to have os-
cillatory character. This results, also shown in Fig. 16,
was suggested to be caused by the interference eﬀects in
the capping layer. Such oscillations have actually been
observed in Co/Cu/Ni trilayers [233] and also explained
using the explicit approach of calculating exchange inter-
actions [234].
Multilayers of 3d metals on the substrates of heavier
elements get even more unpredictable behaviour. This is
partially related to substantial exerted strain as well as
a modiﬁcation of the bandwidth of electron states. For
instance, in Ref. 228 the study of Fe/Rh(001) revealed
a pronounced softening of acoustic magnons at the M
point, as seen as a dip in the dispersion in Fig. 17. Usu-
ally in layered systems the lowest magnon branch orig-
inates from the spins subject to the smallest eﬀective
Weiss ﬁeld (deﬁned by the total exchange interaction).
In this work is was demonstrated that Fe atoms at the
interface have a strong tendency to AFM coupling and
therefore give the main contribution to the lowest acous-

30
Figure 17. Computed and measured acoustic magnon disper-
sions in Fe/Rh(001) from Ref. 228. Inset shows the parts of
the Brillouine zone used in the plot.
tic magnon mode. This is an unexpected result, given
that bulk bcc Fe has such a pronounced NN and next
NN FM interaction. In fact, this tendency was also re-
ported for pure Fe surface [235] and is related with the
changes of density of states of the surface Fe atoms. Sim-
ilar tendency to AFM Fe-Fe interactions were reported
for Fe/Ir(001) [227, 236, 237].
E.
Inﬂuence of spin-orbit coupling
In recent years a growing interest in studying magnetic
3d atoms on heavy-element surfaces is related with the
enhanced SOC-inﬂuenced eﬀects. This was demonstrated
by a systematic comparison of relativistic exchange cou-
plings calculated for Fe/Cu(001) and Fe/Au(001), which
was done in Ref. 23. The authors showed that strong
SOC of Au-5d states gives rise to substantially diﬀerent
magnon spectra for the in-plane and out-of-plane orien-
tation of the magnetization. Currently, experimental ef-
forts are concentrated on the studies of DM interaction in
such systems [238]). Indeed, DM interactions can be ef-
fectively enhanced on the surfaces of heavy elements due
to combined eﬀect of surface localization and substrate-
derived large SOC. By means of explicit calculations, it
was shown that sizeable DM interaction exists between
Fe atoms on a W(110) surface [239]. The so obtained DM
vectors are shown in Fig. 18. Due to the symmetry of the
system, the DM vectors are oriented strictly in plane of
the surface, such that the z-component of the DM vector
is zero.
Moreover, in Ref. 239 these interactions were predicted
to give rise to an asymmetry of the magnon dispersion,
i.e. a preferred chirality, with an asymmetry energy de-
ﬁned as ∆E = E(q)−E(−q). This asymmetry was later
conﬁrmed experimentally, in Ref. 238. The comparison
between computed and measured asymmetry energy for
the Fe/W(110) system, also shown in Fig. 19, was done
Figure 18.
Schematic representation of the calculated DM
interactions in Fe/W(110) between central iron atom (C) and
its NN and next NN, denoted as 1 and 2, respectively. Figure
is taken from Ref. 239.
The DM vectors are seen to obey
twofold rotational symmetry.
in Ref. 230. Without DM interaction, ∆E is strictly zero
for all q-vectors. Thus, ∆E can be eﬀectively used for
quantifying DM couplings in this class of systems, par-
tially due to high resolution of SPEELS-based experi-
ments and partially due to the theory of evaluating the
Dij’s.
In this respect, the relativistic interactions be-
tween transition metals deposited on Pt(111) have at-
tracted particular attention [240–243].
As demonstrated, e.g., in Ref. 239, a Hamiltonian with
a 3 × 3 tensorial coupling between the spins can be con-
sidered where the x-component of the moment on atomic
site i can interact with the y-component of the moment
on atomic site j, as shown in Eqs. (3.13) and (3.14).
These interactions come in a form that is antisymmet-
ric under interchange of x- and y-indices, which leads to
the DM interaction discussed above. However, there is
also a symmetric component to the anisotropic exchange
interaction, as shown in Eq. (3.15), that in some cases
is signiﬁcant. As an example we note a recent calcula-
tion of symmetric and antisymmetric exchange of CoPt,
where the two interactions were found to be of similar
size [191].
F.
Clusters of atoms on surfaces
With the invention of real space methods for calcula-
tions of electronic structures [142, 244], it has become
possible to study magnetic exchange interactions of sys-
tems without periodic boundary conditions.
The real-
space LMTO-ASA method is particularly relevant here,
since its implementation is built on a Green function
formalism, and the expressions of interatomic exchange
(Section V) are, more or less, straight forward to im-
plement.
This has, e.g., been published in a series of
works [162, 195, 245–251]. An example of results of such
an implementation [247] is shown in Fig. 20. These re-
sults are obtained from a calculation based on the LSDA,
for an isolated chain of Mn atoms (5 and 9 Mn atoms in
the chain was considered) on top of a bcc Fe (001) sur-
face. The results of Fig. 20 show that the interactions

31
Figure 19.
Experimental [238] and theoretical [239] chiral
asymmetry of magnon spectrum of bilayer Fe/W(110) (from
Ref. 230).
are dominantly short ranged between all atom types. In
addition, the interactions between Mn-Mn pairs as well
as Mn-Fe pairs, are both ferromagnetic and antiferrmag-
netic, depending on distance between the atoms. This
competition between interactions is responsible for the
complex, non-collinear magnetic structures found in this
system.
G.
f -electron systems
Unpaired electrons of transition metal d states is the
most common source of magnetism, but not the only
one. Many elements with partially ﬁlled electronic f shell
also exhibit intrinsic magnetic ordering. Modelling mag-
netism of such systems is quite challenging, since the f
electrons are governed by a sophisticated interplay be-
tween strong local correlations, spin-orbit coupling, crys-
tal ﬁeld eﬀects and hybridization. Capturing all these
ingredients on equal footing is a huge challenge for ﬁrst-
principles electronic structure calculations.
An advantage of the rare-earth elements is that their
4f wavefunctions are extremely localized and hybridiza-
tion eﬀects can be neglected (with few exceptions; La and
Ce) [7]. Indeed, although 4f electrons are responsible for
the formation of the local magnetic moments, they do
not explicitly participate in the formation of magnetic
interactions [170]. Instead, the 4f electrons locally spin-
polarize valence 6s6p5d orbitals, which mediate the ex-
change couplings (see e.g. Ref. 252).
Turek et al. have shown that by treating the 4f elec-
trons as a non-interacting spin-polarized core, a very
good description of magnetic interaction can be achieved
for hcp Gd from calculations of a FM state [253].
Gadolinium orders ferromagnetically with an observed
total magnetic moment of about 7.6 µB per atom, where
7 µB come from half-ﬁlled f-shell (S=7/2) [7]. This is
Figure 20. Geometry of Mn chain (orange spheres) on a bcc
Fe surface (001 orientation) with Fe atoms as grey spheres
(upper panel). Calculated exchange interactions between Mn-
Mn pairs and between Fe-Mn pairs (lower panel). Data from
Ref. 247. Note that in this work the deﬁnition of the spin
Hamiltonian (Eq. (1.3)) is with a minus sign in front of Jij.
reproduced excellently by theory [254]. In the work of
Ref. 253, the MFA-based estimate of the Tc was 334 K,
which is in excellent agreement with experiment (293
K) [7].
Subsequent studies treated the paramagnetic
phase of Gd by means of the DLM approach [255]. Al-
though the calculated values of NN Jij’s were diﬀerent
from the FM-derived ones, a similar Tc estimate was ob-
tained.
A systematic study of the entire series of late rare-
earths was published in Ref. 256. It was here shown that
the calculations incorporating local 4f correlations on
Hubbard-I level of approximation are capable of repro-
ducing both electronic valence band excitation spectra,
showing well pronounced atomic multiplets, and mag-
netic interactions of these systems. Also, full charge self-
consistency in DMFT was shown to be of utter impor-
tance in order to correctly describe the exchange cou-
plings.
Fortunately, the Jij’s can already be well de-
scribed with the 4f-as-core approach, which is much less
computationally demanding. The Fourier transform of
the obtained Jij’s, calculated in Ref. 256, is shown in
Fig. 21 (as J(⃗q)−J(0)). The maximum value of this curve
indicates the ground state magnetic ordering q-vector.
The results show that Er and Tm have a tendency to
have non-collinear magnetic order (similarly to Eu [257]).
Holmium is also on the border to have a ﬁnite-q maxi-
mum, which is compatible with experiments [7]. The or-
dering temperatures were calculated from the spin Hamil-
tonian (Eq. (1.3)) combined with Monte Carlo simula-
tions, and were found to systematically be in good agree-
ment with experiments for all studied rare earths [256].
Overall, the ordering temperature was found to decrease

32
Figure 21.
Fourier transform of the exchange interaction
J(⃗q)−J(0) in heavy elemental lanthanides [256]. If the maxi-
mum correspond to Γ point, the ferromagnetic order is prefer-
able.
linearly with the number of electronic in the 4f shell. As
a ﬁnal remark of this subsection we note that recently,
an intriguing self-induced spin glass state was observed
for elemental Nd [45]. Ab-initio calculations of the ex-
change parameters of Nd, revealed that this is related to
the unique exchange interactions of the crystal structure
of Nd (dhcp), with competing FM and AFM interactions
of equal strength.
Numerous lanthanide-based systems [258–262] were
successfully modelled with the methods reviewed here to
calculated interatomic exchange, by treating the 4f elec-
trons as core states. Alternatively, Hubbard-I approxi-
mation (which also neglects the hybridisation eﬀects) was
also used in few works [263, 264].
The magnetic interactions of 5f-based compounds are
much more complicated due to more pronounced hy-
bridisation and spin-orbit coupling.
This situation of-
ten leads to high anisotropy of the spin density, so that
approximating spins with dipoles does not apply any
longer. Instead, higher-order multipoles, which were ex-
tensively discussed in the context of actinide oxides [265],
come into play. In order to calculate these multipoles,
a generalized many-body force theorem has been pro-
posed in Ref. 266.
It relies on the assumption that
the correlated states (responsible for magnetism) can
be well projected onto atomic wavefunctions (calculated
via Hubbard-I approximation). This new methodology
has recently been applied to investigate magnetism of
UO2 [267] and NpO2 [268]. In the former case, calculated
quadrupolar exchange interactions have successfully pre-
dicted stabilization of the 3Q magnetic order in the cubic
phase, which could previously only be explained by the
presence of lattice distortions.
H.
Transition metal oxides
Transition metal oxides (TMOs) is a class of materi-
als, which shows outstanding variety of diﬀerent mag-
netic orders and interesting physical and checmial prop-
erties.
The magnetism of these materials can usually
be explained in terms of super-exchange [12, 269–272]
or double-exchange [273] processes. The competition be-
tween them is, for example, responsible for a particularly
rich phase diagram of doped magnanites [274].
Oguchi et al. calculated magnetic interactions in tran-
sition metal monoxides MnO and NiO from ﬁrst princi-
ples at an early stage [62, 63]. The obtained values were
too high compared with experiment, which was most
likely related with the absence of strong local correlations
in the calculation. Indeed, later it was shown that taking
a Hubbard U term into account for the transition metal
3d states, substantially improves the situation [149, 275–
277].
As was demonstrated in Ref. 276, a systematic,
good description of the Néel temperatures can be ob-
tained in the whole series of transition metal monoxides
using a self-interaction-corrected (SIC) version of DFT,
although the valence band spectrum of these types of cal-
culations do not agree with observations. The magnon
spectra calculated from SIC theory, of MnO, FeO, CoO
and NiO [276], is shown in Fig. 22, and one may note
excellent agreement with experimental data.
Further-
more, the impact of dynamical correlations (treated in
DMFT) on the Jij’s was considered in Refs. 95 and 147.
Although, there are some quantitative diﬀerences, the
results of DMFT are rather close to the LDA+U results
and data from the Hubbard I approximation (see Fig. 4).
This result might seem counter-intuitive, since the elec-
tronic structure resulting from the two approaches is sub-
stantially diﬀerent [278]. The likely reason is probably
due to the fact that wide-gap TMOs are close to the
U >> t limit, where the exchange integrals are roughly
deﬁned as t2/U, which is similar in the two approaches.
The interatomic exchange extracted from a calculation
of the susceptibility, using the GW approximation, also
provide results of similar quality [279].
Perovskite 3d oxides were studied very intensely by
Solovyev and co-workers [280–284]. Despite a huge va-
riety of magnetic phases which are found in these ma-
terials, the Jij’s are usually consistent with experimen-
tal ground state magnetic orders. Clearly this is a very
rewarding result. Treating the electron interactions be-
yond DFT usually results in better values of the inter-
atomic exchange interactions of these materials.
No-
tably, LaMnO3 is an interesting exception to this rule.
In Ref. 280 it was suggested that the Hubbard U act-
ing on the eg and t2g orbitals is diﬀerent, due to distinct
screening eﬀects. It was thus suggested that having no
U is a better choice for than adding the same U on the
entire set of Mn-3d orbitals for LaMnO3. However, this
result depends on details of the implementation, as dis-
cussed in Ref. 285.
Generally, TMO’s are regarded as good Heisenberg

33
Figure 22.
Calculated spin-wave dispersion in MnO, FeO,
CoO and NiO (solid line) from Ref. 276. Experimental results
are shown with symbols.
magnets, in the sense that the spins are localized around
3d ions and the interactions are of bilinear kind with-
out strong conﬁguration dependence. However, the total
energies of diﬀerent magnetic orders are not always con-
sistent with the Heisenberg model of Eq. (1.3), as was
reported in several publications [149, 286]. Oxygen po-
larization is suggested to be responsible for this inconsis-
tency [277]. Moreover, for certain oxides, like LiCu2O2,
which have 90◦superexchange, direct exchange plays a
crucial role [287]. Direct exchange interaction was ﬁrst
introduced in the original Heitler-London scheme [288].
Oxides with more complex crystal structures [289–293],
including the ones with 4d and 5d elements [294–296]
have also been successfully analysed with respect to the
interatomic exchange, using the method reviewed here.
Although several LKAG-inspired approaches for calcu-
lating relativistic interactions have been proposed, DM
interactions attracted most of attention [23, 281, 297–
302]. In principle, DM can be extracted using ﬁrst-order
or second-order variation in the spin rotation angles as
well as from the sum rule expansion, which is in fact
of zeroth order.
The ﬁrst-order approach, introduced
in Ref. 299 have been applied to the weak ferromagnets
La2CuO4 and FeBO3 [303] and in both cases provided
good agreement with experimentally observed canting
angles. This approach relies on the fact that the cant-
ing angle is small and a collinear magnetic state, subject
to ﬁnite torque acting on the magnetic moments, is not
far from the true one.
Interestingly, in this approach
one can rotate spin and orbital momenta separately and
for both studied systems the latter prevailed in the to-
tal DMI value. However, these terms along with the L-
derived contributions to isotropic exchange [300] seem to
be related with non-local crystal ﬁeld excitations and are
likely not to be of pure magnetic origin.
I.
Novel 2D magnets
Magnetism in layered van-der-Waals (vdW)-bonded
materials was already reported in the 1960’s [304, 305].
For a long time, these materials were not in the focus of
researchers, but in recent years they have attracted enor-
mous attention [55, 306]. The discovery of intrinsic 2D
magnetic order does not only challenge well-established
preconceptions about 2D magnetism [46], but also of-
fers prospects for building ultra-thin spintronic devices
by combining these types of layered materials [307, 308].
CrI3 is the most well-studied example of 2D magnets.
It is ferromagnetic and the Tc of its monolayer form is
45 K, which is slightly smaller than that of the bulk
form (61 K) [55].
The crystal structure of the mono-
layer of CrI3 is shown in Fig. 23.
Here Cr atoms are
seen to form a honeycomb lattice and each of them is
surrounded by six iodine atoms forming an octahedron.
Two I octahedra of the NN Cr atoms are sharing one
edge, as illustrated in Fig. 23(b), which results in the
Cr-I-Cr bond angle being close to 90◦. The material is
an insulator, so it is expected that the magnetic interac-
tions are deﬁned by a superexchange processes involving
also the I −p states. Nominally, the Cr3+ ions should
be characterized by a d3 conﬁguration, with a half-ﬁlled
t2g shell and with the eg states are completely empty.
In Ref. 309, it was shown that the eg states form very
strong covalent bonds with I −p and become eﬀectively
occupied by hybridization and band broadening. As a
result, the NN Jij’s between Cr atoms are aﬀected by
two competing contributions, namely the AFM superex-
change between half-ﬁlled t2g orbitals and FM superex-
change between t2g and eg states. The latter dominates
and results in the overall FM sign of the NN exchange.

34
(b)
∠Cr-I-Cr ≈90∘
(a)
Figure 23. Left panel: Crystal structure of CrI3 monolayer
with I atoms shown as red spheres, and Cr in purple.
Cr
atoms form honeycomb lattice. Right panel: Local structure
of the Cr-I-Cr bond.
The same physics was conﬁrmed to take place also in case
of monolayer CrI3 [310, 311]. Since the structure is the
same in all three chromium halides, CrX3 (X={Cl,Br,I}),
the complex nature of the NN coupling in these materi-
als explains why its sign is so sensitive to lattice dis-
tortions and strain [312–314].
Similar orbital analysis
for the inter-layer coupling [315] has provided a micro-
scopic description of the theoretically predicted stacking-
dependent magnetic order in bilayered CrI3 [316], which
was also conﬁrmed experimentally [317, 318]. The cal-
culated magnetic interactions in trilayer CrI3 were also
suggested to exhibit similar features [319].
One intriguing aspect of bulk CrI3 is a large gap (≈4
meV) between the two magnon branches, which was ob-
served experimentally [320]. There are mainly two mech-
anisms that have been proposed to explain this, namely a
large next NN DM interaction [320] or NN Kitaev inter-
actions [321]. Relativistic exchange interactions in bulk
and monolayer of CrI3 were studied in Ref. 322.
Ac-
cording to that work, where both conventional DFT as
well as two diﬀerent ﬂavours [323, 324] of LDA+U calcu-
lations were employed, both calculated DM interaction
and Kitaev terms were found to be too small to induce a
substantial gap in the magnon spectrum at the K point.
The work of Ref. 86 suggested that GW approximation
combined with a Hubbard U, is needed to reproduce the
magnon spectrum and most importantly that the ≈4
meV magnon gap is open by correlation enhanced inter-
layer coupling. Given the relative young age of this ﬁeld
of magnetic materials, it is likely that other mechanisms
will be discussed in the future.
Other
2D
magnets,
such
as
Cr2Ge2Te6
[325],
Fe3GeTe2 [326], CrOX (X={Cl,Br}) [327], FeX2 [328]
have also been studied with the help of explicit calcu-
lations of interatomic exchange. Interestingly, the class
of 2D versions of Cr2X2Te6 (X=Ge and Si) systems was
predicted from ab-initio electronic structure theory [329]
before the experimental realization. A rather common
Figure 24. Maximally localized Wannier functions represent-
ing the band crossing the Fermi level in Si(111):X where
X = {Sn, C, Si, Pb}. The ﬁgure is taken from Ref. 138.
feature of the magnetic 2D materials is that they are
characterized by relatively strong hybridization of 3d or-
bitals of the transition metals and the p orbitals of the
ligand states. In this case, the choice of electronic states
that should be used in the expressions of interatomic ex-
change (Section V), i.e. the projection scheme, becomes
particularly non-trivial.
This issue has been raised by
Solovyev and co-workers in Refs. 309 and 325.
J.
sp-magnets
Another class of systems where the magnetism emerges
from highly covalent states is sp-magnets.
One exam-
ple of such materials is semi-hydrogenated or ﬂuorinated
graphene [136].
Systems of adatoms on semiconduct-
ing surfaces, such as Si(111): X = {Sn, C, Si, Pb} are
also often regarded as ideal prototypes of one-band Hub-
bard model (see e.g. Refs. 138 and 330 and references
therein). Indeed, these systems are characterized by the
presence of single relatively ﬂat band crossing Fermi level,
which is subject to strong local and non-local electron
correlations. Although this band originates from the sp-
electrons of adatoms, its wavefunction is highly delocal-
ized and has tails well inside the Si slab, as can be seen
in Fig. 24. It has been proposed that this band leads to a
magnetic instability and various exotic magnetic orders
can be realized in these materials [138]. For instance, the
low-temperature ground state of Si(111): X systems is
predicted to be of 120◦-Néel type. Moreover, formation
of skyrmions is suggested to emerge upon application of
high magnetic ﬁeld [138].
Due to the delocalized nature of the orbitals, carry-
ing the magnetic moments, the inﬂuence of direct ex-
change mechanism is extremely pronounced. It gives rise
to a ferromagnetic exchange (as expected for wavefunc-
tions with small overlap) and its magnitude is so strong,
that it compensates all other indirect exchange contri-
butions [138].
As a result, the isotropic exchange can

35
be eﬀectively suppressed, which can result in relatively
large | ⃗D | /J ratio, where | ⃗D | is the size of DMI. Since
this ratio deﬁnes the period of magnetic texture, the sup-
pression of J has led to the proposition that extremely
compact skyrmions can be realized [139]. Ultimately, it
has been envisaged that exchange-free skyrmions can also
potentially emerge [331].
For the moment, these are mostly theoretically pro-
posed concepts, backed strongly by ﬁrst-principles calcu-
lations. Their actual realization in experiment is yet to
be seen.
K.
Molecular magnets
Single
molecular
magnets
is
a
class
of
systems
where transition metal atoms are embedded in an or-
ganic environment [332].
The chemical formula of
these systems are quite complicated.
For example,
K6[V15As6O42(H2O)]·8H2O is one of them, which is most
often referred to as V15 for the sake of brevity.
The
coupling between the 3d magnetic moments often re-
sults in a total magnetization that is uncompensated,
where the net moment is regarded as a total molecu-
lar spin. Since the interactions between these molecular
complexes are very weak their collective behaviour is sim-
ilar to that of an ensemble of non-interacting point-like
magnetic entities. Thus, molecular magnets not only al-
low to address fundamental aspects of magnetism on the
mesoscale [333, 334], but also ﬁnd their applications in
spintronics [335, 336].
DFT calculations have been widely used to understand
the basic electronic and magnetic properties of molecular
magnets (for a review, see Ref. 337). The formalism of
Section V) has been widely applied to model magnetic
interactions and excitation spectra in the systems, like
V15 [338], Mn4 [339] and Mn12 [340, 341]. In these works
it was shown that a very good description of both elec-
tron spectroscopy and magnetic excitations is only pos-
sible if the correlation eﬀects of the 3d states are taken
into account via application of LDA+U approach, sim-
ilarly to the situation of the 3d oxides.
We note that
the total energy diﬀerence method has also been widely
used to extract the Jij parameters for these systems (see
e.g. [342, 343]).
The most complete description of exchange interac-
tions in molecular magnets was done for Mn12 acetate
in Ref. 341.
The structure of this complex, shown in
Fig. 25, contains two inequivalent types of Mn atoms
having diﬀerent oxidation states. Eight Mn3+ and four
Mn4+ ions are coupled antiferromagnetically, which re-
sults in the total, uncompensated spin S=10. Contrary
to previous works, which only addressed isotropic inter-
actions, Ref. 341 adds relativistic exchange interactions
and single-ion anisotropy to the picture.
Overall, the
Figure 25. Crystal structure of Mn12-acetate from Ref. 344.
Red atoms represent Mn3+ (S=2) ions and the purple ones
correspond to Mn4+ (S=3/2).
following spin Hamiltonian was considered in Ref. 341;
ˆH = HDM + HH +
X
iµν
ˆSµ
i Aµν
i
ˆSν
i ,
(7.7)
where {µ, ν} ∈{x, y, z} and Aµν
i
is the single site
anisotropy tensor. This is hence a generalization of the
sum of Eqs. (1.1) and (1.2), since magnetic crystalline
anisotropy is included.
Since transition metal ions in such molecular com-
plexes have relatively low-symmetric environment, the
Dzyaloshinskii-Moriya interactions can take relatively
large values (more than typically encountered in bulk
3d oxides).
This was exactly the case for Mn12 com-
plex, where the calculations with spin-orbit coupling re-
vealed that the ferrimagnetic arrangement of Mn spins is
canted due to the presence of DM interaction. Combin-
ing Heisenberg exchange, DM interaction and magneto
crystalline anisotropy, the authors of Ref. 341 performed
an exact diagonalization study of the complete 12-spin
Hamiltonian given by Eq. (7.7), treating all constituent
spins as quantum operators. Thanks to a very eﬃcient
realization of a parallel Lanczos algorithm, it was pos-
sible to calculate 50 lowest eigenvalues of the system,
which allowed for a qualitative comparison with inelastic
neutron scattering data and to assign diﬀerent measured
peaks to the transitions from the lowest S=10 to excited
S=9 multiplets.
VIII.
OUT OF EQUILIBRIUM EXCHANGE
Femtosecond laser sources provide a unique possibility
to manipulate magnetism at ultrafast time scales [345,
346]. In particular, the light irradiation of magnetic ma-
terials allows one to modify the value of the exchange
interaction [347–349]. The idea of small spin rotations
as a way to derive eﬀective exchange interactions can be

36
generalized to the case of time-dependent electron Hamil-
tonians [300]. In Ref. 300 the approach was applied to
the time-dependent multi-orbital Hubbard model, that
is, only onsite interaction was taken into account. The
Hamiltonian has the form
ˆH(t) ≡ˆHT (t) + ˆHV ,
(8.1)
where ˆHT (t) is the time-dependent single-particle Hamil-
tonian
ˆHT (t) ≡
X
iaλa
X
ibλb
Tiaλa,ibλb(t)
X
σ
ˆφ†
iaλaσ ˆφibλbσ
=
X
a
X
b
Tab(t)ˆφ†
a · ˆφb,
(8.2)
where we have grouped the site and orbital indexes ac-
cording to a ≡(ia, λa) and b ≡(ib, λb), and introduced
the spinor fermionic operators
ˆφ†
a =

ˆφ†
a↑ˆφ†
a↓

,
ˆφb =
 
ˆφb↑
ˆφb↓
!
.
(8.3)
The interaction Hubbard-like Hamiltonian
ˆHV
is as-
sumed to be time-independent:
ˆHV ≡1
2
X
i
X
λ1λ2λ3λ4
X
σσ′
Vλ1λ2λ3λ4 ˆφ†
iλ1σ ˆφ†
iλ2σ′ ˆφiλ3σ′ ˆφiλ4σ.
(8.4)
The spinor ﬁeld operators ˆφa describes both spin and
charge dynamics of the interacting itinerant-electron sys-
tem. To separate supposedly slow spin dynamics from
the fast charge dynamics one can introduce the rotational
matrices
Ri(t) ≡


q
1 −|ξi(t)|2
ξ∗
i (t)
−ξi(t)
q
1 −|ξi(t)|2

,
(8.5)
where we have introduced bosonic ﬁelds
ξi(t) ≡−eiϕi(t) sin [θi(t)/2] ,
(8.6)
with θi ∈[0, π[ , ϕi ∈[0, 2π[ being the polar angles that
determine the spin axis on site i at time t; it holds that
R†
i(t) · Ri(t) = 1.
The matrix ˆR provides a transition to the new ﬁeld
operators ˆψa:
ˆφ†
a(t) = ˆψ†
a(t) · R†
a(t),
ˆφa(t) = Ra(t) · ˆψa(t),
(8.7)
and we assume that in the new coordinate frame the aver-
age spin at the site i at time instant t
D
0
 ˆψ†
aσ ˆσa ˆψaσ
 0
E
is directed along the z axis. Thus, all the information
about instant direction of the local spin
D
0
ˆφ†
aσ ˆσa ˆφaσ
 0
E
is passed to the bosonic ﬁeld ξi(t).
In the approach of Ref. 300, the problem is reformu-
lated at the Baym-Kadanoﬀ-Keldysh contour [350–353],
which is a common way to proceed in nonequilibrium
quantum statistical mechanics.
The eﬀective action of
the system is expanded, up to the second order, in the
angles of spin rotations θi(t), and the result is compared
to the eﬀective action of the time-dependent classical
Heisenberg model. As a result, we have expressions for
the time-dependent exchange parameters which are ex-
pressed in terms of single-particle Green functions and
electron self-energies.
Both the derivation and the ﬁ-
nal expressions are quite cumbersome, and we refer the
reader to the original paper [300].
The procedure can
be dramatically simpliﬁed if we consider electron corre-
lations at the level of time-dependent mean-ﬁeld approx-
imation [354]. In this case one can derive relatively com-
pact expressions for the time-dependent magnetic suscep-
tibility and extract the exchange parameters from them,
similar to the method which we used in Section II. The
corresponding expression has the form [354]
Jij(t) = i ΣiS(t) lim
ϵ→0+
Z ∞
0
dτe−ϵτ ΣjS(t −τ/2)

G<
↓
i,t+τ/2
j,t−τ/2

G>
↑
j,t−τ/2
i,t+τ/2 −

G>
↓
i,t+τ/2
j,t−τ/2

G<
↑
j,t−τ/2
i,t+τ/2

.
(8.8)
Here ΣiS(t) = 1
2 (Σi↑(t) −Σi↓(t)) is the spin part of the
local self energy which is dependent only on one time t
in the mean-ﬁeld approximation, (G<,>
σ
)i,t
j,t′ are the cor-
responding components of the Keldysh two-time Green
functions.
The theoretical description of interacting electronic
systems under diﬀerent time-dependent perturbations,
such as an applied electric ﬁeld, generally requires to
use advanced many-body numerical techniques.
How-
ever, there exists a particular type of the perturbation,
namely an oﬀ-resonant periodic driving, that can be ad-
dressed in a relatively simple way. Indeed, this type of
driving brings the system to a non-equilibrium steady
state, and the corresponding many-body problem can
therefore be solved using existing time-independent ap-
proaches.
The standard theoretical framework to de-
scribe the periodically driven system is the Floquet for-
malism [355, 356].
This method relies on an eﬀective
time-independent Hamiltonian description of the non-
equilibrium system at stroboscopic times. In the limiting

37
case of a high-frequency driving, this eﬀective Hamilto-
nian can be derived analytically. The key idea is to take
an advantage of a high-frequency feature of the light and
use a Magnus-like perturbation expansion that allows one
to reduce the time evolution of a quantum state to a
time-independent eigenvalue problem with respect to the
eﬀective Hamiltoniana [357, 358]. This can be done as fol-
lows. The time-periodic Hamiltonian, H(t), of the initial
problem obeys the time-dependent Schrödinger equation
i∂tΨ(λ, t) = H(t)Ψ(λ, t).
(8.9)
One can introduce a dimensionless parameter λ = δE/Ω,
which compares a certain energy scale δE of the system
to the frequency Ωof the applied ﬁeld. Let us look for
a unitary transformation Ψ(λ, τ) = exp{−i∆(τ)}ψ(λ, τ)
that removes the time dependence of the Hamilto-
nian. Here, we introduce τ = Ωt and also impose that
∆(τ) = P+∞
n=1 λn∆n(τ) with ∆n(τ) being a 2π periodic
function. Then, the Schrödinger equation (8.9) can be
rewritten as
i∂tψ(λ, τ) = λ ¯Hψ(λ, τ)
(8.10)
with an eﬀective Hamiltonian
¯H = ei∆(τ) ¯H(τ)e−i∆(τ) −iλ−1ei∆(τ)∂τe−i∆(τ).
(8.11)
Here, the bar over the Hamiltonian means the normal-
ization on the energy scale δE: ¯H(τ) = H(τ)/δE. Using
the series representation ¯H = P+∞
n=1 λn ˜Hn, one can de-
termine operators ˜Hn and ∆n(τ) iteratively in all orders
in λ.
The zeroth order term in this representation is
given by the time-average over the period of the driving
˜H0 = ⟨¯H(τ)⟩= ¯H0 deﬁned as
¯Hm =
R +π
−π
dτ
2πeimτ ¯H(τ).
The ﬁrst- and the second-order terms λ in the eﬀective
Hamiltonian are given by the following equations
˜H1 = −1
2
X
m̸=0
 ¯Hm, ¯H−m

m
(8.12)
˜H2 = 1
2
X
m̸=0
 ¯Hm, ¯H0

, ¯H−m

m2
+
1
3
X
m̸=0
X
n̸=0,m
 ¯Hm, ¯Hn−m

, ¯H−n

mn
(8.13)
where the square brackets stand for a commutator.
The resulting eﬀective time-independent Hamiltonian de-
scribes the stroboscopic dynamics of the system, whereas
its evolution between two stroboscopic times is encoded
into the time-dependent function ∆n(τ).
Importantly,
this approach allows one to explore interesting phases of
matter and to control diﬀerent properties of materials
through a direct tuning of model parameters (hopping
amplitudes and electronic interactions) that in Floquet
theory become explicitly dependent on characteristics of
the applied perturbation (see e.g. Refs. 358–365).
The introduced formalism can also be used for calcu-
lating magnetic exchange interactions under the eﬀect of
the high-frequency light irradiation [346, 358, 363, 366–
368].
In particular, in a strong-coupling limit U ≫t,
where U is the Coulomb interaction and t is the hop-
ping amplitude, one can make a Schrieﬀer-Wolﬀtrans-
formation in order to map the derived eﬀective Hamil-
tonian onto a Heisenberg Hamiltonian [369–372]. In the
presence of an external time-dependent perturbation this
transformation has been performed in Refs. 359, 363, and
365. The resulting isotropic symmetric exchange inter-
action J = JK −JD contains two contributions. The ki-
netic exchange interaction corresponds to a usual anti-
ferromagnetic (AFM) superexchange JK = ˜t2/U that
exists in equilibrium.
However, out-of equilibrium JK
contains the hopping amplitude ˜t = tJ0(E) that is renor-
malised by the m-th order Bessel function of the ﬁrst kind
Jm(E) due to the eﬀect of a high-frequency light irradia-
tion. The dimensionless parameter E = eE0a/Ωcontains
the strength of the laser ﬁeld E0, the elementary charge
e, and the lattice constant a0. The AFM exchange JK
competes with the direct ferromagnetic (FM) exchange
interaction JD = JD
bare + JD
ind. The bare part of the di-
rect exchange JD
bare stems from the non-local electronic
interactions and is present already in equilibrium (see
e.g. Refs. 136, 138, 152, 287, and 290). The second part
corresponds to the contribution that is induced by the
high-frequency light irradiation [358, 359]
JD
ind = 2t2U
+∞
X
m=1
J 2
m(E)
m2Ω2 −U 2 .
(8.14)
Remarkably, for the case of a nearly resonant driving
Ω≃U/m [358, 366] or when the bare direct exchange is
suﬃciently large [363] the total isotropic symmetric ex-
change interaction can be substantially modiﬁed by the
high-frequency light and can even change sign under cer-
tain conditions. The introduced formalism can also be
extended to other types of magnetic exchange interac-
tions, such as the Dzyaloshinskii-Moriya [363], the chiral
three-spin [367], and the biquadratic exchange [368] in-
teraction that all can be tuned by high-frequency laser
pulses. In particular, the light control of magnetic in-
teractions may dynamically induce chiral spin liquids in
frustrated Mott insulators [367].
This may also allow
for creation, stabilization, and modifying the shape of
skyrmions in materials where these topological spin tex-
tures do not exist at equilibrium conditions [363]. More-
over, when the isotropic symmetric exchange interaction
J is completely suppressed by the light irradiation, one
can access a unique phase where magnetic properties of
the system are governed solely by the Dzyaloshinskii-
Moriya interaction [331].
IX.
LOCAL MOMENT FORMATION AND
SPIN-DYNAMICS
Historically, the density functional theory (DFT) be-
came the standard language for the theory of magnetism

38
and magnetic interactions. As discussed in previous sec-
tions, in this framework exchange interactions can be
obtained considering variations of the total energy with
respect to small rotations of magnetic moments start-
ing from equilibrium ground states.
Despite the suc-
cess of this approach in describing many magnetic ma-
terials, there are several important problems that can-
not be addressed using this language. Indeed, realistic
models for magnetic materials that are derived within
DFT are interacting electronic problems. However, ﬁnd-
ing a possibility of mapping these electronic models onto
Heisenberg-like spin problems is a highly nontrivial task
that remains unsolved in the framework of DFT. In ad-
dition, calculating the exchange interactions using the
magnetic force theorem is based on the assumption that
the variation of the magnetization from the ground state
magnetic conﬁguration is small, which is frequently not
the case, especially for itinerant electron systems.
The most common way to introduce an eﬀective spin
model for an interacting electronic problem is based on a
Schrieﬀer-Wolﬀtransformation [369–372], which, strictly
speaking, is justiﬁed only at integer ﬁlling in the limiting
case of a very large interaction between electrons. Al-
ready t-J or s-d exchange models [10] that are frequently
used to describe the physics of a doped Mott insulator
cannot be easily mapped onto a purely spin Hamiltonian.
Moreover, spin degrees of freedom in the transformed
problem are described in terms of composite fermionic
variables and not in terms of physical bosonic ﬁelds as
would be desirable for purely spin models. This results in
a need to introduce artiﬁcial constraints in order to con-
serve the length of the total spin. In addition, one also
has to assume that the average value of these composite
fermionic variables that deﬁnes the local magnetization
is nonzero. The latter is hard to justify in a paramag-
netic regime, where, generally speaking, it should also be
possible to introduce a Heisenberg-like spin model.
Even though already deriving an eﬀective spin prob-
lem for interacting electrons is not an easy task, one
must do more than that and ﬁnd a way to introduce
a correct equation of motion for spin degrees of freedom.
For localized spins, the classical equation for the spin
precession can be obtained by evaluating path integrals
over spin coherent states in the saddle-point approxima-
tion [105, 373, 374]. In this approach, the kinetic term
that describes the rotational dynamics of spins originates
from the topological Berry phase, for which the conserva-
tion of the length of the total spin on each site is a neces-
sary condition. For this reason, generalizing the formal-
ism of spin-coherent states to itinerant electronic prob-
lems is mathematically a highly non-trivial task. Nev-
ertheless, ﬁnding a way to derive the equation of mo-
tion for the local magnetic moment in the framework
of electronic problems is crucially important for a cor-
rect description of the full spin dynamics of the system.
Indeed, studying classical spin Hamiltonians allows one
to describe only a uniform precession of the local mag-
netic moment. Taking into account dissipation eﬀects,
e.g. Gilbert damping, requires to couple classical spins
to itinerant electrons [375, 376]. In addition, consider-
ing classical spins disregards quantum ﬂuctuations of the
modulus of the local magnetic moment [377] that have
been observed in recent experiments [378–383]. In anal-
ogy with high-energy physics, these fast ﬂuctuations are
usually described in terms of a massive Higgs mode [384–
387], while slow spin rotations are associated with Gold-
stone modes that originate from the broken rotational
invariance in spin space.
There were many attempts to address the problem of
the spin dynamics of interacting electrons. To get the
Berry phase, one usually follows a standard rout that
consists in introducing rotation angles for a quantization
axis of electrons [388–391]. These angles are considered
as path integral variables to fulﬁll rotational invariance
in the spin space.
In this case, the Berry phase term
appears as an eﬀective gauge ﬁeld that, however, is cou-
pled to fermionic variables instead of a spin bosonic ﬁeld.
Considering purely electronic problems makes it diﬃcult
to disentangle spin and electronic degrees of freedom. For
this reason, until very recently it was not possible to con-
nect the Berry phase to a proper bosonic variable that
describes the modulus of the local magnetic moment. For
the same reason, it was also not possible to introduce a
proper Higgs ﬁeld to describe ﬂuctuations of the modu-
lus of the magnetization. Indeed, in electronic problems
this ﬁeld is usually introduced by decoupling the inter-
action term [392–396]. First, such decoupling ﬁeld does
not have a clear physical meaning and its dynamics does
not necessary correspond to the dynamics of the local
magnetic moment. Also, in actual calculations this eﬀec-
tive Higgs ﬁeld is usually treated in a mean-ﬁeld approx-
imation assuming that it has a non-zero average value,
which is non-trivial to justify in a paramagnetic phase.
One should also keep in mind that although the decou-
pling of the interaction term is a mathematically exact
procedure, it can be performed in many diﬀerent ways.
In particular, this fact leads to a famous Fierz ambigu-
ity problem [397–399] if the decoupling ﬁeld is further
treated in a mean-ﬁeld approximation.
The aim of this section is to collect all previous achieve-
ments in describing spin degrees of freedom of interact-
ing electrons and unify them in a general theory of spin
dynamics and eﬀective exchange interactions in strongly
correlated systems.
Below we discuss how an eﬀec-
tive quantum spin action written in terms of physical
bosonic variables can be rigorously derived starting from
a pure electronic problem.
Importantly, we show that
this derivation can be performed without assuming that
the average magnetization is nonzero and without im-
posing any constraints such as artiﬁcial magnetic ﬁelds.
We illustrate that the introduced eﬀective spin problem
allows one to obtain all kinds of exchange interactions be-
tween spins and thus to establish relations between the
magnetic local force approach and the standard language
of response functions.
Further, we show that the cor-
responding equation of motion for this action correctly

39
describes the dissipative rotational dynamics of the local
magnetic moment via the Berry phase and Gilbert damp-
ing term, and also takes into account the Higgs ﬂuctu-
ations of the modulus of the magnetic moment. At the
end, we introduce a physical criterion for the formation
of the local magnetic moment in the system and show
that this approach is applicable even in the paramag-
netic regime. As a whole, this section provides a solid and
mathematically consistent background for a complete de-
scription of spin dynamics in strongly correlated electron
systems.
A.
Derivation of the bosonic action for the
fermionic problem
To introduce a consistent theory of spin dynamics, we
will mainly follow the route presented in Refs. 400 and
401 and will use the action formalism based on Feyn-
man path integral technique as a more appropriate lan-
guage for treating many-body quantum problems. We
start with a general action for a multi-orbital extended
Hubbard model, as a particular example of the strongly-
correlated electronic problem that possesses spin dynam-
ics
Slatt[c(∗)] = −
Z β
0
dτ
X
jj′,σσ′,ll′
c∗
jτσl

G−1ττll′
jj′σσ′ cj′τσ′l′
+ 1
2
Z β
0
dτ
(
X
j,σσ′,{l}
Ul1l2l3l4c∗
jτσl1cjτσl2c∗
jτσ′l4cjτσ′l3
+
X
jj′,ς,{l}
V jj′ς
l1l2l3l4ρς
jτl1l2ρς
j′τl4l3
)
(9.1)
This action is written in terms of annihilation (creation)
fermionic Grassmann variables c(∗)
jτσl and is considered in
the lattice j, imaginary time τ, spin σ = {↑, ↓}, and or-
bital l space. The bare (non-interacting) Green function
is deﬁned by the inverse of the matrix

G−1ττ ′ll′
jj′σσ′ = δττ ′
h
δjj′δσσ′δll′(−∂τ + µ) −εσσ′
jj′ll′
i
.
(9.2)
It contains the chemical potential µ and the hopping
matrix εσσ′
jj′ll′.
The latter has the following form in
the spin space εσσ′ = ε δσσ′ + i⃗κ · ⃗σσσ′, where the di-
agonal part ε of this matrix corresponds to the usual
hopping amplitude of electrons. The non-diagonal part
⃗κ accounts for the spin-orbit coupling (SOC) in the
Rashba form [402, 403].
The interacting part of the
model action (9.1) consists of the local Coulomb po-
tential Ul1l2l3l4 and the non-local interaction V jj′ς
l1l2l3l4
(V jj = 0) between electrons in the charge (ς = c) and
spin (ς = s = {x, y, z}) channels.
Composite fermionic
variables ρς
jτll′ = nς
jτll′ −⟨nς
ll′⟩describe ﬂuctuations of
charge and spin densities nς
jτll′ = P
σσ′ c∗
jτσl σς
σσ′cjτσ′l′
around their average values.
We note that the exchange interactions between spins
in the bosonic problem that we aim to derive are non-
local, while the dynamics of the magnetic moment is usu-
ally described by local Berry and Higgs terms. For this
reason, it would be useful to explicitly decouple local and
non-local correlations in the system. Refs. 400 and 401
propose to perform this decoupling by considering the lo-
cal site-independent reference problem that accounts for
the local part of the lattice action (9.1)
S(j)
imp[c(∗)] = −
ZZ β
0
dτ dτ ′ X
σ,ll′
c∗
jτσl

g−1
0
ll′
ττ ′ cjτ ′σl′
+ 1
2
Z β
0
dτ
X
σσ′,{l}
Ul1l2l3l4c∗
jτσl1cjτσl2c∗
jτσ′l4cjτσ′l3 (9.3)
where

g−1
0
ll′
ττ ′ = δττ ′δll′(−∂τ + µ) −∆ll′
ττ ′
(9.4)
is the inverse of the bare Green function of the reference
system. The action (9.3) has the form of the impurity
problem of dynamical mean-ﬁeld theory (DMFT) [17]
and is intended to describe the local correlation ef-
fects of the initial lattice action (9.1). This is achieved
by introducing a non-stationary hybridization function
∆ll′
ττ ′ = ∆ll′(τ −τ ′) that aims at capturing the eﬀect of
surrounding electrons on a given impurity site. In gen-
eral, the impurity problem (9.3) can be considered ei-
ther in a polarized [400] or in a non-polarized [401] form,
which corresponds to an ordered or paramagnetic solu-
tion for the problem, respectively. At present, we stick
to a non-polarized local reference system, which allows
one to describe a more interesting regime of the system,
where the average local magnetization is identically zero
⟨ns
ll′⟩imp = 0.
In this case, the hybridization function
∆ll′
ττ ′ is spin independent, and can be determined from the
self-consistent condition
1
2
P
σ Gττ ′ll′
jjσσ = gll′
ττ ′ [401] that
equates the diagonal in spin local part of the interact-
ing lattice Green function Gττ ′ll′
jjσσ
and the interacting
Green function of the local reference problem gll′
ττ ′.
A
DMFT-like form of the reference system (9.3) allows
for the exact solution of this local problem using, e.g.,
the continuous-time quantum Monte Carlo method [404–
407]. This implies that corresponding local many-body
correlation functions including the full interacting Green
function gll′
ττ ′ and the susceptibility χς ττ ′
l1l2l3l4 can be ob-
tained numerically exactly. This drastically simpliﬁes in-
vestigation of many physical eﬀects that are directly re-
lated to local electronic correlations, which, in particular,
includes formation of the local magnetic moment [401].
We will discuss this point in more details in the last part
of this section.
After isolating the local reference system, the non-
local correlations are contained in the remaining part of
the lattice action Srem[c(∗)] = Slatt[c(∗)] −P
j S(j)
imp[c(∗)].

40
However, the local and non-local correlation eﬀects are
not yet disentangled, because Simp[c(∗)] and Srem[c(∗)]
are written in terms of the same fermionic Grassmann
variables.
Calculating any physical observable using
the present form of the lattice action will immediately
mix these correlations up. After that, separating them
is possible only by a complex resummation of corre-
sponding contributions to Feynman diagrammatic expan-
sion [408, 409]. Instead, there exists a more simple way
to completely disentangle local and non-local correlation
eﬀects.
The idea consists in integrating out the refer-
ence system as proposed in the dual fermion (DF) [410–
412] and the dual boson (DB) [413–417] theories. To this
aim, we ﬁrst rewrite the non-local part of the action in
terms of new fermionic c(∗) →f (∗) and bosonic ρς →φς
variables by means of the Hubbard-Stratonovich trans-
formation [418, 419]. After this transformation, the lat-
tice action Slatt[c∗, f ∗, φς] depends on two fermionic and
one bosonic variables. Original Grassmann variables c(∗)
are contained only in the local part of the lattice action,
which includes the impurity problem (9.3), and thus can
be integrated out.
Before making this integration, one should recall that
isolating local correlation eﬀects should help us to cor-
rectly describe dynamics of spin degrees of freedom. In
general, spin dynamics might have a non-trivial form,
since it involves a combination of a slow spin precession
and fast Higgs ﬂuctuations of the modulus of the local
magnetic moment. For this reason, it is more convenient
to treat these two contributions separately. In electronic
systems, the Berry phase term that describes the uniform
spin precession is commonly obtained by transforming
original electronic variables to a rotating frame [388–391].
This can be achieved by introducing a unitary matrix in
the spin space
Rjτ =
 
cos(θjτ/2)
−e−iϕjτ sin(θjτ/2)
eiϕjτ sin(θjτ/2)
cos(θjτ/2)
!
(9.5)
and making the corresponding change of variables
cjτl →Rjτcjτl, where cjτl = (cjτl↑, cjτl↓)T . Rotation an-
gles ΩR = {θjτ, ϕjτ} are considered as site j and time
τ dependent variables. Introducing an additional func-
tional integration over them allows one to preserve the
rotational invariance in the spin space.
As a conse-
quence, the modiﬁed lattice action takes the following
form; Slatt[c∗, f ∗, φς, ΩR].
The Berry phase arises from the local impurity problem
that upon rotation becomes [401]
S(j)
imp[c(∗)] →S(j)
imp[c(∗)] +
Z β
0
dτ
X
s,l
As
jτρs
jτll.
(9.6)
The z
component of an eﬀective gauge ﬁeld As
jτ
has
the
desired
form
of
the
Berry
phase
term
Az
jτ = i
2 ˙ϕjτ(1 −cos θjτ). To exclude other components
of the gauge ﬁeld from consideration, one usually as-
sumes that the rotation angles ΩR correspond to the spin-
quantization axis of electrons. In this case, the composite
fermionic variable in the spin channel ρs is replaced by its
z component ρz which is coupled to the “correct” compo-
nent of the gauge ﬁeld Az
jτ. Proceeding in this direction
leads to several problems.
Associating rotation angles
with the spin-quantization axis is non-trivial to formu-
late in a strict mathematical sense.
In Refs. 390 and
391 it was done introducing slave boson approximation.
However, there is no guarantee that the average mag-
netization on a given lattice site will also point in the
z direction. Indeed, the spin-quantization axes on dif-
ferent sites may point in diﬀerent directions, which may
induce an eﬀective mean magnetic ﬁeld that will change
the direction of the magnetization on a given site. In par-
ticular, this does not allow one to replace the composite
fermionic variable ρz by it’s average value in the Berry
phase term (9.6). Moreover, in the paramagnetic phase
this replacement does not make sense, because the aver-
age magnetization in this case is identically zero. Finally,
in Eq. (9.6) the eﬀective gauge ﬁeld As
jτ is coupled to a
composite fermionic variable ρs instead of a proper vec-
tor bosonic ﬁeld that describes ﬂuctuations of the local
magnetic moment. This representation of spin degrees of
freedom does not conserve the length of the total spin,
which is a necessary condition for a correct description
of a spin precession.
We emphasize that the rotation angles cannot be asso-
ciated with the direction of the newly introduced bosonic
ﬁeld for spin degrees of freedom φs. This ﬁeld enters the
lattice action as an eﬀective quantum magnetic ﬁelds that
polarises original electrons [400, 401] and is frequently as-
sociated with the Higgs ﬁeld [392–396].
However, this
eﬀective bosonic ﬁeld is introduced as the result of a
Hubbard-Stratonovich transformation and does not have
a clear physical meaning. Moreover, even if it would be
possible to associated φs with the physical Higgs ﬁeld,
its dynamics would not necessarily correspond to the dy-
namics of the local magnetic moment. All these observa-
tions suggest that the idea to describe the spin precession
in terms of rotation angles is very appealing, but one has
to ﬁnd a way to relate these angles to the direction of the
local magnetic moment and not to the spin-quantization
axis or to the eﬀective Higgs ﬁeld.
After transforming original electronic variables c(∗)
to a rotating frame they can ﬁnally be integrated
out, which results in the, so called, dual boson action
Slatt[f (∗), φς, ΩR] [413–415]. In this action, bare propa-
gators for the fermionic f (∗) and bosonic φς variables are
purely non-local and explicitly depend on rotation angles
ΩR [401]. All local correlations are absorbed in the inter-
action part of the fermion-boson action ˜F[f (∗), φς, ΩR]
that consist of all possible fermion-fermion, fermion-
boson, and boson-boson vertex functions of the local ref-
erence problem (9.3). To proceed further, we truncate
the interaction at the two particle level and keep only the
four-point (fermion-fermion) Γ and three-point (fermion-
boson) Λς vertices. This approximation is widely used
in the DF [410–412], the DB [413–417], and the re-
cently introduced dual triply irreducible local expansion

41
(D-TRILEX) [420–422] approaches including their dia-
grammatic Monte Carlo realizations [423–425] that pro-
vide results in a good agreement with the exact bench-
mark methods [421, 423–427].
Integrating out the reference system not only disentan-
gles local and non-local correlations, but also allows one
to get rid of composite fermionic variables ρς that are no
longer present in the dual boson action Slatt[f (∗), φς, ΩR].
Now, charge and spin degrees of freedom are described
by a proper bosonic ﬁeld φς that has a well-deﬁned prop-
agator and a functional integration over them.
More-
over, in this action the gauge ﬁeld As
jτ is coupled (up
to a certain multiplier) to the spin component of this
bosonic ﬁeld φs [401].
However, as discussed above,
the bosonic variable φς does not have a clear physical
meaning.
The way of introducing a physical bosonic
variable was proposed in Ref. 400 and was inspired by
works [390, 391], where a similar transformation was per-
formed for fermionic ﬁelds. The idea consists in introduc-
ing a source ﬁeld ης for the original composite fermionic
variable ρς that describes ﬂuctuations of charge and spin
densities. Then, after obtaining the dual boson action
one performs one more Hubbard-Stratonovich transfor-
mation φς →¯ρς that makes ης the source ﬁeld for the
resulting physical bosonic ﬁeld ¯ρς. Further, unphysical
bosonic ﬁelds φς are integrated out, which leads to the
fermion-boson action Slatt[f (∗), ¯ρς, ΩR].
Importantly, the derived fermion-boson action has
a simpler form compared to the dual boson action
Slatt[f (∗), φς, ΩR].
Indeed, the interaction part of the
fermion-boson action contains only the three point vertex
function Λς. The four-point vertex Γ that is present in
the dual boson action is approximately cancelled by the
counterterm that is generated during the last Hubbard-
Stratonovich transformation [400, 420]. As the result, the
fermion-boson action Slatt[f (∗), ¯ρς, ΩR] takes the form of
an eﬀective t-J or s-d exchange model [10] that describes
local charge and spin moments ¯ρς coupled to itinerant
electrons f (∗) via the local fermion-boson vertex function
Λς. Moreover, in this action the gauge ﬁeld As
jτ is cou-
pled to the spin component of the physical bosonic ﬁeld
¯ρs as desired for a correct description of the rotational
dynamics of the local magnetic moment [401].
We note that at this point all parameters of the
fermion-boson action, including the coupling of the gauge
ﬁeld As
jτ to the bosonic ﬁeld ¯ρs, explicitly depend on the
rotation angles ΩR. From the very beginning, these an-
gles are introduced to account for the spin precession ex-
plicitly.
For this reason, ΩR should be related to the
direction of the local magnetic moment, which in the
fermion boson action is deﬁned by a bosonic vector ﬁeld
¯ρs. It is convenient to rewrite the latter in spherical co-
ordinates as ρs
jτll′ = Mjτll′es
jτ, where Mjτll′ is a scalar
ﬁeld that describes ﬂuctuations of the modulus of the
orbitally-resolved local magnetic moment.
In this ex-
pression we assume that the multi-orbital system that ex-
hibits a well-developed magnetic moment is characterised
by a strong Hund’s exchange coupling that orders spins of
electrons at each orbital in the same direction. Therefore,
the direction of the local magnetic moment in the system
is deﬁned by the orbital-independent unit vector ⃗ejτ, e.g.
described by a set of polar angles ΩM = {θ′
jτ, ϕ′
jτ} associ-
ated with this vector. It has been shown in Ref. 401 that
taking the path integral over rotation angles ΩR in the
saddle point approximation allows one to equate these
two sets of angles ΩR = ΩM that from now on deﬁne the
direction of the local magnetic moment. After that, the
remaining dependence on rotation angles can be elimi-
nated from fermionic parts of the fermion-boson action.
This can be achieved in the adiabatic approximation that
assumes that characteristic times for electronic degrees of
freedom are much faster than for spin ones.
The bosonic problem that describes the behavior of
charge and spin densities can be obtained integrating out
fermionic ﬁelds f (∗). The fermion-boson action is Gaus-
sian in terms of these ﬁelds, so this integration can be
performed exactly.
The resulting bosonic action takes
the following ﬁnal form [401]
Slatt = −Tr ln

 ˜G−1ττ ′ll′
jj′σσ′ −δjj′
Z β
0
dτ1
X
ς,l1l′
1
σς
σσ′Λς ττ ′τ1
ll′l1l′
1 ¯ρς
jτ1l′
1l1

+ 1
2
Z β
0
dτ
X
jj′,ς,{l}
¯ρς
jτll′ V jj′ς
ll′l1l′
1 ¯ρς
j′τl′
1l1
−1
2
ZZ β
0
dτ dτ ′ X
j,{l}
(
¯ρc
jτll′

χc −1ττ ′
ll′l1l′
1 ¯ρc
jτ ′l′
1l1 + Mjτll′

χz −1ττ ′
ll′l1l′
1 Mjτ ′l′
1l1
)
+
Z β
0
dτ
X
j
Az
jτMjτ.
(9.7)
Importantly, in this action the modulus of the total mag-
netic moment Mjτ = P
l Mjτll is coupled only to the z
component of the eﬀective gauge ﬁeld Az
jτ that gives ex-
actly the desired Berry phase term. Other components
of the gauge ﬁeld disappear upon associating rotation
angles with the direction of the local magnetic moment.
B.
Exchange interactions in many-body theory and
relation to other approaches
As expected, in the derived bosonic action local and
non-local correlations eﬀects are completely disentangled.
The ﬁrst line in Eq. (9.7) describes non-local exchange in-

42
teractions between charge ¯ρc and spin ¯ρs densities. The
ﬁrst term in this line is responsible for the kinetic ex-
change processes mediated by electrons. This can be il-
lustrated by directly expanding this term to all orders in
¯ρς variables. The standard quadratic exchange interac-
tion Jςς′
jj′ is given by the second order of the expansion
Jςς′ττ ′
jj′ll′l′′l′′′ =
Z β
0
{dτi}
X
{σi},{li}
⋆Λ∗ς ττ1τ2
ll′l1l2
˜Gτ1τ3l1l3
jj′σ1σ3 ˜Gτ4τ2l4l2
j′jσ4σ2 Λς′τ3τ4τ ′
l3l4l′′l′′′,
(9.8)
where
a
“transposed”
three-point
vertex
Λ∗ς τ1τ2τ3
l1l2l3l4
= Λς τ3τ2τ1
l4l3l2l1
is introduced to simplify nota-
tions.
˜G in the expression for the exchange interaction
stands for the non-local Green function given by the
diﬀerence between DMFT G and impurity g Green
functions
˜Gττ ′ll′
jj′σσ′ = Gττ ′ll′
jj′σσ′ −δjj′δσσ′gll′
ττ ′
(9.9)
The DMFT Green function corresponds to the bare lat-
tice Green function (9.2) dressed in the exact self-energy
Σimp of the local reference problem (9.3) [17]. Accord-
ing to the self-consistency condition, the local part of the
DMFT Green function is identically equal to the exact
local Green function g of the reference problem.
The diagonal part of the quadratic exchange in-
teraction is given by the Heisenberg exchange Jss
jj′
for spin [400, 401] and the Ising interaction Jcc
jj′ for
charge [428] densities. The latter will be discussed in de-
tails in Section X. The non-diagonal Js̸=s′
jj′
components
give rise to the Dzyaloshinskii-Moriya and the symmetric
anisotropic interactions (see, e.g., Ref. 403) that may ap-
pear in the system due to SOC. These kinetic exchange
interactions compete with the bare non-local electron-
electron interaction V ς
jj′ that plays a role of a direct ex-
change between charge and spin densities. This makes
the total non-local quadratic exchange interaction
Iςς′
jj′ = Jςς′
jj′ + δςς′V ς
jj′.
(9.10)
Importantly, the non-local interaction V ς
jj′ enters the
bosonic problem in the same way as it was introduced
in the initial lattice action (9.1). We also note that the
direct spin-spin interaction V s
jj′ usually has the opposite
sign to the kinetic interaction Jss
jj′. More involved inter-
actions, e.g. the chiral three-spin [429–434] and the four-
spin [435–437] exchange interactions can be obtained by
expanding the ﬁrst term in Eq. (9.7) to higher orders in
the ρς variable.
At this step we can already establish the relation be-
tween the exchange interactions derived within two dif-
ferent frameworks, namely using a magnetic force theo-
rem and a quantum many-body path-integral technique.
In this case it is convenient to work in the Matsubara
fermionic ν and bosonic ω frequency representation. To
simplify expressions we further omit orbital indices that
can be restored trivially. First, we note that the three-
point vertex function Λς for the zeroth bosonic frequency
can be obtained from single-particle quantities
Λs
ν,ω=0 = △s
ν + χs −1
ω=0
(9.11)
by varying the self-energy of the local reference prob-
lem (9.3) with respect to the magnetization [401]
△s
ν = ∂Σimp
ν
/∂Mω=0
(9.12)
In the ordered phase, where the spin rotational invariance
is broken, this variation can be approximated as
△s
ν =
Σimp
ν↑↑−Σimp
ν↓↓
2⟨M⟩
.
(9.13)
This relation is justiﬁed by local Ward identities and the
fact that in the regime of a well-developed magnetic mo-
ment the renormalized fermion-fermion interaction (four-
point vertex function) does not depend on fermionic fre-
quencies [400].
Therefore, in Eq. (9.11) the △s
ν term
describes the spin splitting of the self-energy due to po-
larization of the system. In turn, χs −1
ω=0 can be seen as
a kinetic self-splitting eﬀect, because χs
ω = −⟨ρs
ωρs
−ω⟩imp
is the exact spin susceptibility of the reference system.
In magnetic materials with a relatively large value of
the magnetic moment the kinetic contribution can be ne-
glected. Indeed, in this case the spin splitting of the self-
energy is determined by the Hund’s exchange coupling.
The latter is much larger than the inverse of the spin sus-
ceptibility, for which the estimation χs
ω=0 ∼T −1 holds
due to Curie–Weiss law [438]. Then, the static exchange
interaction Jss′
jj′ (ω = 0) =
R
dτ ′ Jss′
jj′ (τ −τ ′) (see Ref. 401
for discussions) reduces to the form
Jss′
jj′,ω=0 =
X
ν,{σ}
△s
jν ˜Gσ1σ3
jj′ν △s′
j′ν ˜Gσ4σ2
j′jν
(9.14)
that under the approximation (9.13) coincides with the
expression (5.63) that for the ordered phase was de-
rived in Section V L using the magnetic force theo-
rem [20, 27, 28, 108, 439].
Note that Eq. (9.14) con-
tains the sum over spin indices {σ} and for this rea-
son does not contain the prefactor “2” that is present
in Eq. (5.63). The magnetic force theorem can also be
applied in a paramagnetic phase. In the Hubbard I ap-
proximation this was done in Ref. 266, and the result
coincides with Eq. (9.14), where the spin splitting (9.12)
is calculated numerically exactly. It should be empha-
sized that in Eq. (9.8), and consequently in Eq. (9.14),
the vertex function (9.11) and thus the self-energy (9.12)
are given by the local reference system (9.3). Moreover,
the Green function (9.9) that enters the expression for
the exchange interaction is also dressed only in the local
self-energy. The spin splitting △s obtained from the non-
local self-energy was introduced in Ref. 440. However,
the corresponding exchange interaction is formulated in
terms of bare (non-interacting) Green functions and can

43
be derived considering only in the density-density ap-
proximation for the interaction between electrons. For
these reasons, the limit of applicability of this approach
and the relation to other methods remain unclear.
One can also relate the obtained many-body re-
sult (9.8) to the expression for the exchange interaction
deduced from the spin susceptibility.
Indeed, the full
quadratic exchange interaction (9.10) enters the bosonic
action as a non-local part of the inverse of the lattice
susceptibility [400, 401, 428]

X−1ςς′
jj′ = δjj′δςς′ [χς]−1 −Iςς′
j̸=j′.
(9.15)
This expression was used in the works [87, 441, 442] to
estimate the magnetic exchange interaction based on the
DMFT approximation for the spin susceptibility. In addi-
tion, if the fermionic frequency-dependence in Eq. (9.11)
is fully neglected, the the vertex function can be ap-
proximated by the inverse of the local bare polarization
Λs ≃χ0 −1
ω=0, where χ0
ω = P
ν gνgν+ω. Then, the exchange
interaction (9.8) reduces to the form of an eﬀective bare
non-local susceptibility that was derived in Ref. 93
Jss′
jj′,ω=0 = χ0 −1
ω=0 ˜X0
jj′,ω=0 χ0 −1
ω=0
(9.16)
where ˜X0
jj′ω = P
ν ˜Gjj′ν ˜Gj′jν+ω.
C.
Equation of motion for the local magnetic
moment
The second line in the bosonic action (9.7) contains
only local contributions that describe dynamics of charge
and spin degrees of freedom. The ﬁrst term in this line
accounts for the Higgs ﬂuctuations of the modulus of
the charge ρc and spin M moments around their aver-
age value. This can be seen by formally expanding the
time-dependence of the moments in powers of τ −τ ′. For
the local magnetic moment this gives
SHiggs = −1
2
ZZ β
0
dτ dτ ′ X
j
Mjτ

χz −1
ττ ′ Mjτ ′
≃−1
2
Z β
0
dτ
X
j

χz −1
ω=0 M 2
jτ + ∂2χz −1
ω
2 ∂ω2

ω=0
˙M 2
jτ

(9.17)
The ﬁrst order diﬀerence in time vanishes, because the
exact local susceptibility χς
ω is the even function of the
frequency ω.
The Lagrangian equation for this action
immediately gives the standard equation of motion for
a simple harmonic oscillator
¨
Mjτ + λ2Mjτ = 0, where
λ2 = −2χz −1
ω=0/
 ∂2
ωχz −1
ω

ω=0. Note that in our deﬁni-
tion the susceptibility χς
ω is negative.
However, this
expansion has to be performed with an ultimate care.
Indeed, Higgs ﬂuctuations of the modulus of the local
magnetic moment are fast, and the spin susceptibility is
strongly non-local in time [401]. For this reason, there is
no uniform justiﬁcation that the Higgs ﬂuctuations can
be accurately described using an equal-time term (sec-
ond line of Eq. (9.17)) instead of the full non-stationary
in time local part of the lattice action (ﬁrst line of
Eq. (9.17)). The last term in the bosonic action (9.7) that
contains the eﬀective gauge ﬁeld Az
jτ accounts for the ro-
tational spin dynamics. It has been shown in Ref. 401
that after averaging over fast Higgs ﬂuctuations the equa-
tion of motion for the bosonic action reduces to the stan-
dard Landau-Lifshitz-Gilbert form. To illustrate this, we
replace the scalar ﬁeld Mjτ by its constant non-zero av-
erage value ⟨Mjτ⟩= 2S and introduce ⃗Sjτ = S ⃗ejτ. The
spin part of the action becomes
Sspin =
Z β
0
dτ
X
j

i ˙ϕjτ(1 −cos θjτ) S −⃗Sjτ · ⃗hjτ

(9.18)
where we explicitly rewrote the gauge ﬁeld in terms of
rotation angles. Components of the eﬀective magnetic
ﬁeld ⃗hjτ can be expressed via the quadratic exchange
interaction and the eﬀective magnetic ﬁeld that appears
due to SOC [401]
hs
jτ = −4
Z β
0
dτ ′ X
j′,s′
Iss′
jj′ (τ −τ ′) Ss′
j′τ ′ + hsoc s
jτ
. (9.19)
In the general case, the equation of motion for the non-
stationary spin action (9.18) is a complex set of integro-
diﬀerential equations. However, one can make use of the
fact that the interaction between spins is determined by
the super-exchange processes mediated by electrons (9.8)
and thus decays fast on the time scales of inverse band
width. Instead, the time-dependence of the angle vari-
ables ϕjτ and θjτ is slow, because the spin precession
is slow in time [375, 376, 443]. Contrary to the case of
Higgs ﬂuctuations, this allows one to expand the time-
dependence of the spin variable Ss′
j′τ ′ in Eq. (9.19) up to
the ﬁrst order in powers of τ −τ ′
hs
j(t) = −4
X
j′,s′
IR ss′
jj′
(Ω= 0) Ss′
j′ (t) + hsoc s
j
(t)
−4
X
j′,s′
∂
∂ΩIm IR ss′
jj′
(Ω)

Ω=0
˙Ss′
j′ (t).
(9.20)
With this expression for the eﬀective magnetic ﬁeld the
spin problem (9.18) becomes stationary in time, and the
corresponding equation of motion for this action takes
the standard Landau-Lifshitz-Gilbert form
˙⃗Sj(t) = −⃗hj(t) × ⃗Sj(t)
(9.21)
This expression can be derived by making analytical
continuation that transforms the imaginary-time ex-
change interaction Iss′
jj′ (τ −τ ′) to a retarded function
IR ss′
jj′
(t −t′) in real time t. In turn, IR ss′
jj′
(Ω) is a Fourier
transform of the retarded exchange interaction to real

44
frequency Ω. This transformation allows one to obtain
the Gilbert damping, which is described by the last term
in the eﬀective magnetic ﬁeld (9.20). A similar expres-
sion for the Gilbert damping was derived in Refs. 375
and 376 for the case of a classical spin coupled to the
system of conduction electrons. Note that the Gilbert
damping cannot be obtained in the imaginary-time rep-
resentation, because the exchange Iss′
jj′ (τ −τ ′) is an even
function of time. Physically, this means that dissipation
eﬀects cannot be visible in the equilibrium formalism.
There are several restrictions for the derived Landau-
Lifshitz-Gilbert equation of motion that have to be dis-
cussed. Eq. (9.21) describes the spin precession that is
assumed to be slow in time compared to electronic pro-
cesses in the system. The corresponding eﬀective mag-
netic ﬁeld (9.20) thus takes into account only the low-
frequency part of the exchange interaction. In general,
the exchange term (9.8) has a non-trivial frequency de-
pendence and even diverges at high frequencies, because
it is given by a non-local part of the inverse of the lattice
susceptibility (9.15).
Non-adiabatic eﬀects that corre-
spond to high-frequency behavior of the exchange inter-
action are not taken into account by the Eq. (9.21). The
latter can only be described using the derived bosonic
action (9.7) that has no restriction on the regime of fre-
quencies, but is non-stationary in time.
Another important point is that the Higgs and the
Berry phase terms in the form they enter the bosonic
action (9.7) can be obtained only after associating the
rotation angles with the direction of the local magnetic
moment. As discussed above, this can be done taking
the path integral over rotation angles in the saddle point
approximation. However, this approximation can be jus-
tiﬁed only for the case of a large magnetic moment [401].
In practice, it means that the classical Landau-Lifshitz-
Gilbert equation of motion is applicable only in the multi-
orbital case, where the large value of the local magnetic
moment is provided by a strong Hund’s coupling. If the
magnetic moment is small, spin dynamics in the system
is governed by quantum ﬂuctuations. In this case, the
local magnetic moment can still be well-deﬁned, but its
behavior can no longer be described in terms of classical
equations of motion.
D.
Local magnetic moment formation
The Landau-Lifshitz-Gilbert equation of motion (9.21)
makes physical sense only for a non-zero value of the av-
erage magnetic moment ⟨M⟩. In the ordered phase this
is ensured by a non-zero average value of the magneti-
zation. Deﬁning ⟨M⟩in a paramagnetic regime is much
more problematic, because in this case the average mag-
netization is identically zero. For this reason, the value of
⟨M⟩is commonly estimated from the static (equal-time)
spin susceptibility as
3χz
ττ = ⟨M 2⟩≃⟨M⟩
 ⟨M⟩+ 2

(9.22)
However, this approximation gives quite large and be-
sides, almost temperature-independent value for the
magnetic moment even in the high-temperature regime
where the moment is not yet formed [401]. Taking into
account dynamical screening eﬀects changes the value
of the average moment, but it still remains substan-
tially larger compared to the one measured experimen-
tally [443–445]. This result can be explained by the fact
that the local spin susceptibility simultaneously accounts
for correlations of the local magnetic moment and for spin
ﬂuctuations of itinerant electrons. These two contribu-
tions to the susceptibility cannot be easily disentangled.
In Ref. 401 the average value of the magnetic moment
was proposed to obtain from the free energy of the lo-
cal problem that describes the behavior of the magnetic
moment. The action of this local problem
Sloc = −Tr ln
"
[g−1]ττ ′δσσ′ +
Z β
0
dτ1
X
ς
σς
σσ′Λς
ττ ′τ1ρς
τ1
#
−1
2
ZZ β
0
dτ dτ ′ X
ς
ρς
τ

χς −1
ττ ′ ρς
τ ′
(9.23)
can be derived by excluding the contribution of itiner-
ant electrons from the local reference system (9.3). The
resulting problem reminds of the bosonic action (9.7),
where the non-local Green function ˜G is replaced by the
full local Green function g. In the introduced local prob-
lem (9.23) the magnetic moment appears as a result of
a spontaneous symmetry breaking.
According to Lan-
dau phenomenology [446] the latter corresponds to the
change of the free energy from a paraboloid-like form
with a minimum at ⟨M⟩= 0 to a Mexican-hat potential
characterized by a continuous set of minima at ⟨M⟩̸= 0
(see insets in Fig. 26). Remarkably, the resulting value
for the average local magnetic moment appears to be
substantially smaller than the one deduced from the lo-
cal spin susceptibility (9.22).
The change of the form of the free energy can be cap-
tured by the sign change of its second variation with re-
spect to the the local magnetic moment
−∂2Sloc[ρs]
∂ρsτ ∂ρs
τ ′ =

χs −1
ττ ′ −Jloc
ττ ′.
(9.24)
The right-hand side of this equation can be seen as a self-
exchange between the local magnetic moments, because
it is given by the inverse of the local susceptibility with
subtracted contribution of itinerant electrons. The latter
is described by a local analog of the kinetic exchange
interaction (9.8)
Jloc
ττ ′ =
Z β
0
{dτi}
X
σ
Λ∗s
ττ1τ2gσ
τ1τ3gσ
τ4τ2Λs
τ3τ4τ ′
(9.25)
It is important to emphasize that the local magnetic mo-
ment exists only at relatively long times compared to
single-electron processes. In the static limit the moment

45
is screened by Kondo eﬀect or by intersite exchange-
induced spin ﬂips. For this reason, formation of the lo-
cal magnetic moment in the system corresponds to the
symmetry breaking at intermediate time scales. Conse-
quently, as has been shown in Ref. 401, the second vari-
ation of the local free energy (9.24) changes sign at any
times except τ = τ ′. Therefore, the formation of the local
moment is not a real physical transition and should be
considered as a crossover eﬀect. The static contribution
to the local problem (9.23) is contained in the inverse of
the local susceptibility χs −1
ττ ′ = (Πs imp
ττ ′ )−1 −δττ ′U s. It is
given by the bare local interaction in the spin channel
U s = −U/2. In this expression Πs imp
ττ ′
is the exact po-
larization operator of the reference system (9.3).
The
criterion for the local magnetic moment formation can
thus be obtain by explicitly excluding this static contri-
bution from Eqs. (9.23) and (9.24). The corresponding
condition written in the frequency space is following
C =
 Πs imp
ω=0
−1 −Jloc
ω=0 = 0.
(9.26)
This expression illustrates that when the eﬀective self-
exchange becomes diamagnetic (C > 0) the system ac-
quires the magnetic moment. The derived criterion (9.26)
can be approximately related to the ﬁrst variation of the
local electronic self-energy with respect to the magne-
tization.
This fact suggests that the formation of the
local magnetic moment is energetically favorable when
this variation is negative, which minimizes the energy of
electrons.
Applying the derived criterion (9.26) to interacting
electronic systems shows that the local magnetic moment
develops at temperatures well above the phase transition
to the ordered state [401]. At the same time, the mo-
ment can be formed only above a relatively large critical
value of the local Coulomb interaction U, which for the
case of a half-ﬁlled single-orbital cubic lattice exceeds the
half of the bandwidth. The corresponding result is shown
in Fig. 26, where the blue line corresponds to the Néel
phase boundary, and the red line is obtained from the
condition (9.26). At low temperatures the red line de-
termines the point at which the local magnetic moment
disappears. In the regime of large interactions this is re-
lated to Kondo screening [447, 448]. At small U, the local
magnetic moment is destroyed by local spin ﬂuctuations,
which corresponds to the regime of valence ﬂuctuations of
the Anderson model [447]. The low-temperature branch
of the red line splits the ordered phase into two parts,
which allows one to distinguish between Slater [449, 450]
and Heisenberg regimes of spin ﬂuctuations.
To summarise, the path-integral formalism allows us
to derive the bosonic problem (9.7) that describes spin
dynamics of itinerant electronic systems. The non-local
part of this problem gives a general form for all kinds
of magnetic exchange interactions. Upon certain approx-
imations, the derived expression for the quadratic ex-
change (9.8) reduces to the result that was originally in-
troduced in a completely diﬀerent framework of DFT.
These approximations are justiﬁed by the existence of
Figure 26.
Phase diagram for the 3D Hubbard model as a
function of temperature T and local Coulomb interaction U.
Red line corresponds to the criterion (9.26) for the formation
of the local magnetic moment.
Blue line depicts the Néel
phase boundary obtained in Ref. 451. The insets show the
local free energy (9.23) as a function of the magnetic moment
in two regimes, when it does not exist (to the left of the red
line) and where it is already formed (red shaded area). Figure
is adapted from Ref. 401.
a well-developed magnetic moment in the system and
determine the limit of applicability of the DFT result.
Apart of deriving the magnetic interactions, the path-
integral formalism makes possible to introduce the equa-
tion of motion for spin degrees of freedom. It was shown
that for a relatively large value of the magnetic moment
its slow rotational dynamics is described by a standard
Landau-Lifshitz-Gilbert equation, and fast Higgs ﬂuc-
tuations can be taken into account by the local non-
stationary in time contribution to the bosonic problem.
Deriving the criterion for the formation of the local mag-
netic moment completes the path-integral formulation of
the theory of magnetism and magnetic interactions.
X.
NON-MAGNETIC ANALOGOUS OF
EXCHANGE INTERACTION
The basic idea presented and discussed in this review is
an idea of coarse-grained description of collective behav-
ior in a system of strongly interacting electrons in solids.
The prototype example is magnetism, and “gross” vari-
ables in the coarse-grained description of spin degrees of
freedom are angles determining directions of individual
local magnetic moments. Technically, the main tool is
the magnetic force theorem when we express the varia-
tion of the total thermodynamic potential under small
spin rotations in terms of variations of single-electron
Green function. This approach is general and can be ap-
plied to other collective phenomena than for magnetism.
Here we consider two examples, namely, superconduc-
tors and charge-ordered systems.
Since these subjects
are auxiliary for the main aim of the review we restrict

46
Figure 27. Illustration of the Hubbard-plaquette lattice (tij,
U) with lattice vector r, self-energies Σi and plaquette sites
0, 1, 2, 3. It is mapped to the Josephson lattice model with
eﬀective coupling Jij of plaquettes due to phase ﬂuctuations
δθi of the d-wave superconducting order parameter Φi.
ourselves by presentation of main ideas and some illus-
trative results emphasizing similarities with the discussed
approach to magnetic exchange interaction.
We start with the case of superconductors; our pre-
sentation in this part will mostly follow Ref. 452. The
superconductor is characterized, in the simplest case of
singlet Cooper pairing, by a complex-valued order param-
eter meaning a wave function of condensate of the Cooper
pairs. There is a huge literature on the subject; for a very
basic introduction the text books in Refs. 132, 134, and
453 can be recommended.
Let us consider a model of strong-coupling supercon-
ductor with Cooper pairs relative well localized in real
space, an analog of a magnet with well-deﬁned local mag-
netic moments.
This is a very bad model for conven-
tional superconductors with a typical diameter of Cooper
pairs in thousands of interatomic distances [132, 453]
but it can by reasonable well applicable to cuprate high-
temperature superconductors assuming that we consider
the lattice of copper plaquettes rather than individual
sites [452, 454]. Then, the macroscopic superconductiv-
ity in the system can be described in terms of a coherence
of the phase of the local Cooper pairs θi which are sup-
posed to be all equal in the ground state (without the
loss of generality, this ground-state value can be chosen
as zero). The model, that can address the issue of super-
conducting phase ordering and thus macroscopic quan-
tum properties of the superconductor, is the Josephson
lattice model
Heﬀ=
X
<ij>
Jij cos (θi −θj) ,
(10.1)
where i, j are (super)site indices (e.g., plaquette indices
for the two-dimensional Hubbard model used in the the-
ory of superconducting cuprates). The Josephson cou-
pling parameters Jij determine in particular superﬂuid
density and London penetration depth [132, 134, 453].
Instead of magnetic systems where we deal with the
local rotational (or SU(2)) symmetry, for singlet super-
conductors we deal with the U(1) symmetry (see Fig. 27).
Following the general approach accepted in this review,
we have to calculate the variation of the thermodynamic
potential under small phase variations, and the answer
will be expressed in terms of single-particle Green func-
tion. In the superconducting state, the latter is a super-
matrix with normal and anomalous part (the so called
Nambu-Gor’kov representation) [132]:
 
Gp↑
F
F
Gh↓
!−1
ij
=
 
Gp↑
0
0
0
Gh↓
0
!−1
ij
−δij
 
Σp↑
S
S
Σh↓
!
i
,
(10.2)
where Gp↑
0 , Gh↓, and F are electron spin-up, hole spin-
down and anomalous parts of the Green functions, F is
supposed to be considered as local in the supersite, as in
Refs. 452 and 454.
To obtain explicit microscopic expressions for the
Josephson couplings Jij we have to calculate the varia-
tion of the thermodynamic potential Ωunder small vari-
ations of the superconducting phases, and compare the
result with (10.1).
Following our consideration of the
exchange interactions within dynamical mean-ﬁeld the-
ory discussed in Subsection V L we start with a general
representation of the thermodynamic potential in terms
of single-particle and double-counted contribution with
the Luttinger-Ward functional Φ, and use the local-force
theorem. The result is [452]
δΩ≃
X
ij
Tr

δijGiiδ∗Σi + 1
2Gijδ∗ΣjGjiδ∗Σi

, (10.3)
where δ∗denotes the local variation of the self-energy
Σ without taking into account its variation due to the
self-consistency procedure. We omit here for simplicity
matrix indices of intra-plaquette and Nambu spaces.
The variation of the self-energy under an inﬁnitesimal
change of the local phase δθi entering Eq. (10.3) in a
homogeneous environment it reads
δ∗Σi = eiδθiσz/2Σie−iδθiσz/2 −Σi
=
 
Σp↑
i
eiδθiSi
e−iδθiSi
Σh↓
i
!
−Σi
≃


0

iδθi −(δθi)2
2

Si

−iδθi −(δθi)2
2

Si
0

,
(10.4)
where Σp↑
i , Σh↓
i , and Si are electron-up, hole-down, and
anomalous parts of the supersite self-energy, respectively,
and the third Pauli matrix σz acts in the Nambu-space.
The starightforward calculations up to second order in
δθ results in

47
δΩ=
X
ij
Trωα

Gp↑
ij SjGh↓
ji Si −δijFiiSi −FijSjFjiSi

δθ2
i + 1
2
X
ij
Trωα

FijSjFjiSi −Gp↑
ij SjGh↓
ji Si

δθ2
ij.
(10.5)
The trace goes over Matsubara frequencies and over the
sites within the supersite (α).
The term ∝δθ2
i vanishes which reﬂects the gauge in-
variance of the theory which can be checked by the direct
calculation [452]. The remaining nonlocal term ∝δθ2
ij
δΩ≡−1
2
X
<ij>
Jijδθ2
ij,
(10.6)
should be compared with (10.1) to ﬁnd the coupling con-
stants Jij. The answer reads
Jij = 2 Trωα

Gp↑
ij SjGh↓
ji Si −FijSjFjiSi

.
(10.7)
In order to study macroscopic observables of the
Josephson lattice model, we take the continuum, long-
wavelength limit of (10.1). In this limit, the interaction
becomes the superconducting stiﬀness
Iab = −
1
(2π)d
Z
ddk Trωα
(10.8)
⋆
∂Gp↑(k)
∂ka
S ∂Gh↓(k)
∂kb
S −∂F(k)
∂ka
S ∂F(k)
∂kb
S

with the eﬀective Hamiltonian
Heﬀ= 1
2
X
ab
Iab
Z
ddr ∂θ
∂ra
∂θ
∂rb
.
(10.9)
If we assume that our lattice is isotropic (in two or
three dimensions) then Iab = Iδab, and the constant I is
related to the London penetration depth [132, 453]:
1
λ2 = 16πe2
ℏ2c2 I.
(10.10)
We present an example of the calculated Josephson
couplings Jr for plaquette-translations r in Fig. 28. The
ﬁgure shows that Jr reduces sharply with increasing
plaquette-translation length |r|, and thus the short-range
components of Jr alone can give a complete description.
The strongest coupling is J100, followed by the interlayer
coupling J001. They have their maxima around δ = 0.05
and δ = 0.1, respectively. All couplings diminish at large
dopings, δ > 0.1. The ﬁrst term of Eq. (10.7) (GSGS) is
negative, and the second (FSFS) is positive. GSGS is
a mixed term with normal (G) and anomalous (S) con-
tributions.
It makes the main contribution to J, that
can be ﬁnite only if there is a superconducting gap and
therefore a ﬁnite anomalous self-energy S as both terms
depend on it. Regarding the largest contributions to the
nearest neighbour Josephson coupling J(1,0,0), GSGS is
about 3 times as large as FSFS.
Another interesting feature of correlated materials that
can be potentially described by a corresponding bosonic
model is charge ordering. In electronic systems this phe-
nomenon attracts a considerable attention since the dis-
covery of the Verwey transition in magnetite Fe3O4 [455–
457].
Further, eﬀects similar to the Verwey transition
have been observed in many other materials, such as the
rare-earth compound Yb4As3 [458–460], transition metal
MX2 [461–463] and rare-earth R3X4 [464–466] chalco-
genides (M = V, Nb, Ta; R = Eu, Sm; X = S, Se), Mag-
néli phase Ti4O7 [467–470], vanadium bronzes NaxV2O5
and LixV2O5 [460, 471].
There, the charge ordering
is driven by the strong non-local Coulomb interaction
and/or the electron-phonon mechanism.
Both these
interactions eﬀectively reduce the strength of the lo-
cal Coulomb repulsion [472–476] and may even result
in an eﬀective attraction between electrons.
Describ-
ing these eﬀects in the framework of ab initio elec-
tronic models requires to use very advanced many-body
approaches, such as the quantum Monte-Carlo tech-
nique [477–479], the GW method combined with the ex-
tended dynamical mean-ﬁeld theory [480, 481], the dy-
namical cluster approximation [482–484], or the dual the-
ories [414, 416, 425, 485, 486]. These theoretical calcu-
lations require signiﬁcant numerical eﬀorts, which addi-
tionally motivates reformulating the original electronic
problem in terms of eﬀective bosonic variables.
Similarly to magnetism, the charge ordering is charac-
terised by the local order parameter – the on-site elec-
tronic density.
This ordering appears as the result of
a spontaneous symmetry breaking of a discrete lattice
symmetry contrary to the case of a magnetic ordering,
which is associated with breaking of a continuous SU(2)
0.05
0.10
δ
10−4
10−3
10−2
-2Jr
J
0.05
0.10
δ
−GSGS
0.05
0.10
δ
F SF S
r
(1,0,0)
(1,1,0)
(2,0,0)
(0,0,1)
Figure 28. Josephson coupling Jr (left) and its constituents,
GSGS (center) and FSFS (right), as functions of doping δ
and for diﬀerent plaquette translations r at T = 1/52 ∼0.02,
t⊥= 0.15.

48
symmetry. For this reason, eﬀective models formulated
in terms of scalar bosonic variables are more suitable for
addressing this problem. In particular, Ising-like mod-
els are frequently used for describing the ordering in al-
loys [39, 185, 487–489]. In this framework, one deals with
a conﬁguration energy written in terms of eﬀective inter-
actions V (n)
α
for clusters of order n and type α. For the
case of a binary alloy AcB1−c with the concentration c
the conﬁguration energy can be written as
Hconf =
X
p
V (2)
p
X
i,j∈p
σiσj +
X
t
V (3)
t
X
i,j,k∈t
σiσjσk
+
X
q
V (4)
q
X
i,j,k,l∈q
σiσjσkσl + . . .
(10.11)
where scalar variables σi take the value −1 or +1 depend-
ing whether A or B atom occupies the site i. Parameters
for this microscopic model can be derived from ab initio
energy calculations within the framework of the density
functional theory [490–493].
To this aim, one can ap-
ply, e.g., a generalized perturbation theory [38, 494–500].
In this approach eﬀective cluster interactions V (n)
α
can
either be obtained by calculating the corresponding n-
point correlation functions (see, e.g., Refs. 489 and 501)
or from the single-electron energy using the force theo-
rem [502]. In the latter case, the variation of the con-
centration of atoms of a given kind is considered as a
perturbation. This seems to be very diﬀerent from con-
sideration of small spin rotations, the primary topic of
this review, that has been used successfully in the case of
magnetism. Nevertheless, the resulting pair interaction
between sites j and j′ is given by the expression
V (2)
jj′ = −2
π ℑ
Z EF
−∞
dE∆tj ˜Gjj′(E) ∆tj′ ˜Gj′j(E) (10.12)
which very closely resembles the magnetic exchange in-
teraction derived using the magnetic force theorem (see
Section V). Here, ∆tj = (tA
j −tB
j )/2 is the diﬀerence be-
tween single-site scattering matrices for A and B type
of atoms, and ˜Gjj′(E) is the partial interatomic Green
function of the reference system provided by a random
alloy.
As in the case of magnetism, using the force theo-
rem does not allow one to rigorously determine limits
of applicability of the theory.
In this regard, deriving
eﬀective Ising-like models in the many-body framework
should be beneﬁcial. In the context of interacting elec-
tronic problems this has been achieved in Refs. 401 and
428. The corresponding derivation was discussed in Sec-
tion IX leading to an eﬀective bosonic problem (9.7). It
is important to note that introducing the bosonic model
for charge degrees of freedom does not require impos-
ing the adiabatic approximation that separates time- and
energy-scales of single- and two-particle ﬂuctuations in
the magnetic case [428].
All possible interactions between the electronic densi-
ties at diﬀerent lattice sites can be obtained by expand-
ing the logarithm in Eq. (9.7) in terms of the bosonic
Figure 29. Double occupancy of the extended Hubbard model
shown on the U-V phase diagram. Calculations are performed
in the normal phase, where the value of the double occupancy
d is depicted by color. The gray color depicts the charge or-
dered phase. The black dashed line surrounds the area of the
large double occupancy d ≳70% dmax, where charge excita-
tions can be described by an eﬀective Ising model.
Values
of Coulomb interactions U and V are given in units of half
of the bandwidth 4t = 1, t is the nearest-neighbor hopping
amplitude. The inverse temperature for this calculation was
set to T −1 = 50. The Figure is taken from Ref. 428.
ﬁeld ρc that describes ﬂuctuations of the charge densi-
ties n around their average values.
The explicit form
for the pair interaction is given by Eqs. (9.8) and (9.10).
The tree-point vertex function Λc that enters the kinetic
exchange (9.8) represents a remormalized local coupling
between electronic and charge degrees of freedom. Thus,
this vertex can be seen as a single-site scattering matrix,
which makes the many-body expression for the exchange
interaction (9.8) very similar to the pair cluster interac-
tion derived in the context of alloys (10.12).
Mapping the quantum bosonic problem for electronic
densities (9.7) onto a classical Ising-like model can be
justiﬁed only in the regime of well-developed charge ﬂuc-
tuations. In a broken symmetry (charge ordered) phase,
the electronic density at a given lattice site strongly dif-
fers from the average density of the system. This allows
one to replace the bosonic variable ρc
j at each site j by its
average value ⟨ρc
j⟩, which reduces the quantum bosonic
action (9.7) to a classical Ising-like Hamiltonian. In the
normal phase the average density on each lattice site is
uniform, which makes it diﬃcult to introduce the corre-
sponding classical problem and complicates determining
the regime of applicability of this approach.
In Ref. 428 the double occupancy d = ⟨n↑n↓⟩of the
lattice site was proposed as a measure of the strength of
the charge ﬂuctuations in the normal phase. The double
occupancy for a particular case of the extended Hubbard
model on a square lattice is shown in Fig. 29. The result
is obtained at half ﬁlling, where the maximum value of

49
the double occupancy is dmax = 0.25. In this model the
charge ordered phase (grey area) is driven by the nearest-
neighbor Coulomb interaction V .
If the latter defeats
the on-site Coulomb repulsion U, the electronic density
forms a checkerboard pattern on the lattice made of al-
ternating doubly occupied and empty sites. For a given
value of U the maximum double occupancy appears at
the boundary between the normal and ordered phases
depicted by a dashed red line. This fact conﬁrms that
strongest charge ﬂuctuations in the normal phase emerge
in the region close to the phase transition to the ordered
state.
However, the value of the double occupancy is
not uniformly distributed along the phase boundary and
decreases with the increase of the local Coulomb interac-
tion. It has been shown in Ref. 428 that strong charge
ﬂuctuations drastically suppress the frequency depen-
dence of the eﬀective local electron-electron interaction
(two-particle irreducible four-point vertex function). The
value of the double occupancy at which the eﬀective local
interaction is nearly frequency independent and coincides
with the actual Coulomb interaction U was estimated as
d ≳70% dmax. This condition deﬁnes the Ising regime of
the system depicted by the black dashed line in Fig. 29,
where charge ﬂuctuations are indeed well-developed. In-
terestingly, this regime is not limited to small values of
the local interaction U that for some values of V exceed
the half of the bandwidth.
In the Ising regime of the normal phase the quantum
action (9.7) can be mapped onto an eﬀective classical
Hamiltonian. This can be achieved by replacing the cor-
responding bosonic variable by an eﬀective charge den-
sity, which is given by the square root of the double oc-
cupancy ρc →
√
d. Note that determining the eﬀective
charge density can be performed more accurately ﬁnding
the the minimum of the local free energy in the same way
as it is done for estimating the value of the local magnetic
moment (see discussion in Section IX). However, using
the two particle correlation function (the double occu-
pancy) to deﬁne the average density in the case of charge
degrees of freedom is also well justiﬁed contrary to the
case of magnetism (1.23). Indeed, the magnetic phase
corresponds to the ordering of single-particle quantites
(local magnetizations), while the charge ordering is re-
alised through the formation of double occupations that
are two-particle observables. Ref. 428 shows that the ef-
fective Ising model introduced in such a simple way is
able to predict the transition temperature between the
normal and charge ordered phases in a good agreement
with much more elaborate methods, even though the cal-
culations are performed in the unbroken symmetry phase.
XI.
SUMMARY AND OUTLOOK
The developments that started in Refs. 62–67 culmi-
nated in Ref. 20, with a practical and eﬃcient scheme
of extracting exchange interactions between atomic mag-
netic moments of solids and molecules. This has opened
up a ﬁeld of research where a deeper understanding of
magnetic interactions is possible. These early works on
explicit calculations of interatomic exchange enabled new
dimensions of DFT and DMFT calculations, and it is
now routine to extract from electronic structure calcu-
lations on one scale (involving a few atoms per unit
cell) information about exchange interactions on a much
larger scale (involving interactions between thousands of
atoms), that if needed can be used to evaluate parameters
of micromagnetic simulations [503, 504]. This represents
multiscale transitions between three length scales and en-
ables simulations of magnetic phenomena on scales equal
to that of experimental sample sizes, without using ex-
perimental information as input. In addition to oﬀering
a deeper understanding of basic magnetic exchange be-
tween atoms, the method of Ref. 20 has so far been used
to calculate ordering temperatures of materials and to
map out magnon dispersions (via adiabatic approaches
or in spin-dynamics simulations via the dynamic struc-
ture factor, e.g as reviewed in Ref. 9). It has also been
used to address ultra fast magnetisation phenomena ob-
served in pump probe measurements [505] as well as to
analyze topological magnetic states [506] and spin-glass
formation [45], to name a few.
It is foreseeable that the method of Ref. 20 will con-
tinue to be developed, to enable a more detailed and
deeper understanding of the mechanisms that govern the
properties of a magnetic material. An example here is the
coupling of spin- and lattice degrees of freedom, where
initial steps have been taken.
In a recent work [507]
spin-lattice parameters were calculated from an exten-
sion of the formalism of Ref. 20. Hence coupled motion,
e.g. involving magnons and phonons, are now possible
to consider in combined spin-lattice simulations [25, 26].
It is foreseeable that these developments will continue to
be developed, so that a natural output from electronic
structure calculations are a set of interaction parameters
that enable simulations of all relevant collective modes
and the coupling between them.
The theories reviewed here have focused on bilinear ef-
fects, such as the ones expressed in Eq. (1.1). However,
extensions of the formulas of Section V, can be extended
to involve also biquadratic eﬀects that involve coupling
terms like P
<ij> J BQ
ij
(⃗Si · ⃗Sj)2 or generalizations of it,
i.e., P
<ijkl> J Ring
ijkl (⃗Si · ⃗Sj)(⃗Sk · ⃗Sl), where i, j, k, l are
site indices. These interactions are expected to be much
weaker than that of bilinear exchange, but in some cases
they have been argued to be important. In these exten-
sions, that one can expect will become under focus in
the years to come, it would be of interest to also anal-
yse the interaction terms in an orbital composed fashion,
in the same way as was done for bilinear exchange [193]
as shown here in Fig. 11. In connection to this analy-
sis we mention that a similar analysis of the DM inter-
action is not straight forward since spin-orbit coupling
mixes orbitals that otherwise would belong to separate
irreducible representations. Orbital decomposed DM in-
teraction hence becomes an issue of which basis is the

50
most natural to use, which most likely will depend from
material to material, given that spin-orbit coupling is ei-
ther the weakest (for the 3d transition metals) or equal
in size to other interactions of the electronic Hamiltonian
(e.g. for the actinides).
The primary focus of this review is on the magnetic
dipole of an atom, as calculated from the expectation
value of a spin-operator.
This is natural since for the
majority of materials it is the most commonly observed
order parameter. However, for some solids other order
parameters are of relevance, e.g. the quadropolar order
that is observed in NpO2 [508]. Extensions of the method
of small rotations, as shown in Figs. 5 and 6, would have
to be made to other order parameters in order to evaluate
the coupling strengths in these cases.
To illustrate that the research ﬁeld reviewed here is
very much a living, developing activity, we note a recent
set of publications regarding details of the spin Hamil-
tonian in Eq. (1.4).
In Refs. 439 and 509 it was sug-
gested that DM like interaction terms can be realized
for non-collinear magnetic structures, even if spin-orbit
interaction is neglected (or is vanishingly small). This
interpretation was criticized in Ref. 510, who suggested
that fundamental interactions of DM character have have
to rely on an electronic Hamiltonian with spin-orbit cou-
pling included. Further elaborations on non-relativistic
DM interaction was however published in Refs. 511 and
512 without a ﬁrm consensus being reached.
We also note that alternative ways to extract exchange
parameters have recently been suggested [513], e.g, from
tight-biding electronic structure theory and adiabatic
spin-dynamics, where the local Weiss ﬁeld is evaluated
from the so called constraining ﬁeld.
In this work it
was suggested that eﬀective interatomic exchange can
be evaluated (dynamically) from the energy curvature
tensor of any magnetic conﬁguration.
It was demon-
strated in Ref. 513 that both moment lengths and ef-
fective exchange interactions can depend quite strongly
on the magnetic conﬁguration.
Apart from magnetism of electrons in solids, there are
very interesting magnetic phenomena related to order-
ing of nuclear spins in solid helium-3 [514]. In this case,
the exchange interactions cannot be described by bilin-
ear spin Hamiltonians, and three- and four-spin exchange
interactions turn out to be highly important [514, 515].
Apart from solid helium-3, monolayers of helium-3 on
graphite is the other example of a system with compli-
cated nuclear-spin-based magnetism [516]. Applications
of the methods presented here to such systems seems to
be an interesting direction of further development.
The last three sections of the review (VIII, IX, and X)
present an alternative approach to the theory of ex-
change interactions, in light of contemporary quantum-
many body theory with its mathematically more ad-
vanced tools, like path integrals and Feynman diagrams.
Changing the language allows to go much further than
the initial formulation considering the systems out-of-
equilibrium (Section VIII), nonmagnetic collective phe-
nomena such as charge ordering and superconductivity
(Section X), and giving a full derivation of equations of
spin dynamics for itinerant-electron systems, including
not only exchange interaction-related term but also dy-
namical, spin-precession term (Section IX). These new
developments are relatively recent, and their potential
for applications is far from being unveiled completely.
Especially, a systematic study of laser-induced nonlin-
ear magnetic phenomena within the developed formalism
looks like an extremely promising direction.
As a ﬁnal remark of the outlook section, we note that
equations of the form of Eq. (1.3) (and extensions of it)
have been used for research ﬁeld outside of materials sci-
ence, or even natural science. In the Ising approximation
of the classical Heisenberg Hamiltonian, the atomic spins
are arranged in a z graph, usually a lattice, that can be
in one of two states (+1 or -1) [517] and the strength of
the interaction is given by Jij in Eq. (1.3). This inspired
the so called classical voter model, and its extensions,
which represents an idealized description for the evolu-
tion of opinions in a population [518–520]. In the clas-
sic voter model, similar to the Ising model, each voter
can assume two states, -1 or +1.
A voter at site i is
selected at random and copies the state of a randomly
chosen neighbor voter j.
Another example where the
Ising-model (and percolation theory) can be used is epi-
demics as it it shown in a comprehensive review focused
on Covid-19 [521].
The work of Giorgio Parisi on the
hidden patterns in spin glasses [522] should also be men-
tioned that gave an extremely important contribution to
the theory of complex system, which is a quantitative,
predictive and experimentally veriﬁable science of gen-
eralized matter that interact through interactions that
can be exchange of objects or opinions by co-evolving on
multilayer networks [523]. In case of complex systems a
macroscopic pattern can emerge of the mutual inﬂuence
of a large number of individuals [524–526] and it makes
it possible to understand phenomena, not only in physics
but also in other, very diﬀerent areas, such as mathemat-
ics, biology, neuroscience and machine learning [527–529].
Acknowledgements. E.A.S. was supported by the
European Union’s Horizon 2020 Research and Innova-
tion programme under the Marie Skłodowska Curie grant
agreement No. 839551 - 2DMAGICS.
O.E., A.I.L.,
and M.I.K. acknowledge support from the ERC (the
FASTCORR project). O.E. also acknowledges support
from the Swedish Research Council (VR), the foun-
dation for strategic research (SSF), the Swedish En-
ergy Agency (STEM), the Knut and Alice Wallenberg
(KAW) foundation, eSSENCE and STandUPP. Valuable
discussions with A. Bergman, V. Borisov, R. Cardias,
A. Delin, E. Delzceg, I. Di Marco, J. Fransson, O. Granas,
J. Hellsvik, H. Herper, J. Jonsson, A. Klautau, I. Mi-
randa, C. S. Ong, M. Pereiro, B. Sanyal, S. Streib,
D. Thonig, P. Thunström, R. Vieira and A. Vishina are
acknowledged.

51
[1] P. Mohn, Magnetism in the solid state: an introduction,
Vol. 134 (Springer Science & Business Media, 2006).
[2] R. M. White and B. Bayne, Quantum theory of mag-
netism, Vol. 1 (Springer, 1983).
[3] J. Kübler, Theory of itinerant electron magnetism, Vol.
106 (Oxford University Press, 2017).
[4] J. Stöhr and H. C. Siegmann, Magnetism. From Fun-
damentals to Nanoscale Dynamics, Solid State Sciences
Series (Springer, 2006).
[5] K. H. J. Buschow and F. R. Boer, Physics of magnetism
and magnetic materials, Vol. 7 (Springer, 2003).
[6] M.
Getzlaﬀ,
Magnetism
in
Reduced
Dimensions
–
Nanoparticles,
in
Fundamentals
of
Magnetism
(Springer, 2008) pp. 175–210.
[7] J. Jensen and A. R. Mackintosh, Rare earth magnetism
(Clarendon Press Oxford, 1991).
[8] J. M. D. Coey, Magnetism and magnetic materials
(Cambridge university press, 2010).
[9] O. Eriksson, A. Bergman, L. Bergqvist, and J. Hellsvik,
Atomistic spin dynamics: foundations and applications
(Oxford university press, 2017).
[10] S. V. Vonsovskii, Magnetism, Vol. 2 (New York: J. Wi-
ley & Sons, 1974).
[11] K. Yosida, Theory of Magnetism
(Springer-Verlag,
Berlin Heidelberg, 1996).
[12] J. B. Goodenough, Magnetism and the Chemical Bond,
J. Phys. Chem. Solids 10, 87 (1963).
[13] P. Fazekas, Lecture notes on electron correlation and
magnetism, Vol. 5 (World scientiﬁc, 1999).
[14] R. Skomski, Handbook of Magnetism and Magnetic Ma-
terials, edited by J. M. D. Coey and S. S. Parkin
(Springer International Publishing, Cham, 2021) pp.
53–102.
[15] P. Hohenberg and W. Kohn, Inhomogeneous Electron
Gas, Phys. Rev. 136, B864 (1964).
[16] W. Kohn and L. J. Sham, Self-Consistent Equations In-
cluding Exchange and Correlation Eﬀects, Phys. Rev.
140, A1133 (1965).
[17] A. Georges, G. Kotliar, W. Krauth, and M. J. Rozen-
berg, Dynamical mean-ﬁeld theory of strongly corre-
lated fermion systems and the limit of inﬁnite dimen-
sions, Rev. Mod. Phys. 68, 13 (1996).
[18] A. I. Lichtenstein and M. I. Katsnelson, Ab initio calcu-
lations of quasiparticle band structure in correlated sys-
tems: LDA++ approach, Phys. Rev. B 57, 6884 (1998).
[19] G. Kotliar, S. Y. Savrasov, K. Haule, V. S. Oudovenko,
O. Parcollet, and C. A. Marianetti, Electronic structure
calculations with dynamical mean-ﬁeld theory, Rev.
Mod. Phys. 78, 865 (2006).
[20] A. I. Liechtenstein,
M. I. Katsnelson, and V. A.
Gubanov, Exchange interactions and spin-wave stiﬀness
in ferromagnetic metals, Journal of Physics F: Metal
Physics 14, L125 (1984).
[21] O. Gutﬂeisch, M. A. Willard, E. Brück, C. H. Chen,
S. G. Sankar, and J. P. Liu, Magnetic materials and
devices for the 21st century: stronger, lighter, and more
energy eﬃcient, Advanced materials 23, 821 (2011).
[22] O. Tegus, E. Brück, K. H. J. Buschow, and F. R.
De Boer, Transition-metal-based magnetic refrigerants
for room-temperature applications, Nature 415, 150
(2002).
[23] L. Udvardi, L. Szunyogh, K. Palotás, and P. Weinberger,
First-principles relativistic study of spin waves in thin
magnetic ﬁlms, Phys. Rev. B 68, 104436 (2003).
[24] See Eqs. (3.14) and (3.15) for a more precise generaliza-
tion.
[25] V. P. Antropov, M. I. Katsnelson, M. van Schilfgaarde,
and B. N. Harmon, AbInitio Spin Dynamics in Magnets,
Phys. Rev. Lett. 75, 729 (1995).
[26] J.
Hellsvik,
D.
Thonig,
K.
Modin,
D.
Iuşan,
A. Bergman, O. Eriksson, L. Bergqvist, and A. Delin,
General method for atomistic spin-lattice dynamics
with ﬁrst-principles accuracy, Phys. Rev. B 99, 104302
(2019).
[27] A. I. Liechtenstein,
M. I. Katsnelson, and V. A.
Gubanov, Local spin excitations and Curie temperature
of iron, Solid State Communications 54, 327 (1985).
[28] A. I. Liechtenstein, M. I. Katsnelson, V. P. Antropov,
and V. A. Gubanov, Local spin density functional ap-
proach to the theory of exchange interactions in ferro-
magnetic metals and alloys, Journal of Magnetism and
Magnetic Materials 67, 65 (1987).
[29] J. Kubler, K.-H. Hock, J. Sticht, and A. R. Williams,
Density functional theory of non-collinear magnetism,
Journal of Physics F: Metal Physics 18, 469 (1988).
[30] L. M. Sandratskii, Symmetry analysis of electronic
states for crystals with spiral magnetic order. II. Con-
nection with limiting cases, Journal of Physics: Con-
densed Matter 3, 8587 (1991).
[31] O. N. Mryasov, A. I. Liechtenstein, L. M. Sandratskii,
and V. A. Gubanov, Magnetic structure of FCC iron,
Journal of Physics: Condensed Matter 3, 7683 (1991).
[32] S. V. Halilov, H. Eschrig, A. Y. Perlov, and P. M.
Oppeneer, Adiabatic spin dynamics from spin-density-
functional theory: Application to Fe, Co, and Ni, Phys.
Rev. B 58, 293 (1998).
[33] L. M. Sandratskii and P. Bruno, Exchange interactions
and Curie temperature in (Ga,Mn)As, Phys. Rev. B 66,
134435 (2002).
[34] L. M. Sandratskii, Noncollinear magnetism in itinerant-
electron systems: Theory and applications, Advances in
Physics 47, 91 (1998).
[35] A. Jakobsson, P. Mavropoulos, E. Şaşıoğlu, S. Blügel,
M. Ležaić, B. Sanyal, and I. Galanakis, First-principles
calculations of exchange interactions, spin waves, and
temperature dependence of magnetization in inverse-
Heusler-based spin gapless semiconductors, Phys. Rev.
B 91, 174439 (2015).
[36] R. Drautz and M. Fähnle, Spin-cluster expansion:
Parametrization of the general adiabatic magnetic en-
ergy surface with ab initio accuracy, Phys. Rev. B 69,
104404 (2004).
[37] R. Singer, F. Dietermann, and M. Fähnle, Spin Interac-
tions in bcc and fcc Fe beyond the Heisenberg Model,
Phys. Rev. Lett. 107, 017204 (2011).
[38] F. Ducastelle and F. Gautier, Generalized perturbation
theory in disordered transitional alloys: Applications to
the calculation of ordering energies, Journal of Physics
F: Metal Physics 6, 2039 (1976).
[39] A. V. Ruban, S. Shallcross, S. I. Simak, and H. L.
Skriver, Atomic and magnetic conﬁgurational energet-
ics by the generalized perturbation method, Phys. Rev.

52
B 70, 125115 (2004).
[40] G. L. Verschuur, Hidden attraction:
the history and
mystery of magnetism (Oxford University Press on De-
mand, 1996).
[41] As can be seen e.g. here: https://www.youtube.com/
watch?v=A1vyB-O5i6E.
[42] W. Wiltschko, U. Munro, H. Ford, and R. Wiltschko,
Bird navigation:
what type of information does the
magnetite-based receptor provide?, Proceedings of the
Royal Society B: Biological Sciences 273, 2815 (2006).
[43] I. Snowball, L. Zillén, and P. Sandgren, Bacterial mag-
netite in Swedish varved lake-sediments: a potential bio-
marker of environmental change, Quaternary Interna-
tional 88, 13 (2002).
[44] V. Cannella and J. A. Mydosh, Magnetic Ordering in
Gold-Iron Alloys, Phys. Rev. B 6, 4220 (1972).
[45] U. Kamber, A. Bergman, A. Eich, D. Iuşan, M. Stein-
brecher, N. Hauptmann, L. Nordström, M. I. Katsnel-
son, D. Wegner, O. Eriksson, et al., Self-induced spin
glass state in elemental and crystalline neodymium, Sci-
ence 368 (2020).
[46] N. D. Mermin and H. Wagner, Absence of Ferro-
magnetism or Antiferromagnetism in One- or Two-
Dimensional Isotropic Heisenberg Models, Phys. Rev.
Lett. 17, 1133 (1966).
[47] D.
Ruelle,
Statistical
mechanics:
Rigorous
results
(World Scientiﬁc, 1999).
[48] S. Chakravarty, B. I. Halperin, and D. R. Nelson, Two-
dimensional quantum Heisenberg antiferromagnet at
low temperatures, Phys. Rev. B 39, 2344 (1989).
[49] V. Y. Irkhin, A. A. Katanin, and M. I. Katsnelson, Self-
consistent spin-wave theory of layered Heisenberg mag-
nets, Phys. Rev. B 60, 1082 (1999).
[50] M.
N.
Baibich,
J.
M.
Broto,
A.
Fert,
F.
N.
Van
Dau,
F.
Petroﬀ,
P.
Etienne,
G.
Creuzet,
A. Friederich, and J. Chazelas, Giant Magnetoresistance
of (001)Fe/(001)Cr Magnetic Superlattices, Phys. Rev.
Lett. 61, 2472 (1988).
[51] G. Binasch, P. Grünberg, F. Saurenbach, and W. Zinn,
Enhanced magnetoresistance in layered magnetic struc-
tures with antiferromagnetic interlayer exchange, Phys.
Rev. B 39, 4828 (1989).
[52] M.
Bowen,
V.
Cros,
F.
Petroﬀ,
A.
Fert,
C. Martınez Boubeta,
J. L. Costa-Krämer,
J. V.
Anguita, A. Cebollada, F. Briones, J. M. De Teresa,
L.
Morellón,
M.
R.
Ibarra,
F.
Güell,
F.
Peiró,
and
A.
Cornet,
Large
magnetoresistance
in
Fe/MgO/FeCo(001)
epitaxial
tunnel
junctions
on
GaAs(001), Applied Physics Letters 79, 1655 (2001).
[53] W. H. Butler, Theory of electronic transport in random
alloys: Korringa-Kohn-Rostoker coherent-potential ap-
proximation, Phys. Rev. B 31, 3260 (1985).
[54] A. Belavin and A. Polyakov, Metastable states of two-
dimensional isotropic ferromagnets, JETP lett 22, 245
(1975).
[55] B. Huang, G. Clark, E. Navarro-Moratalla, D. R. Klein,
R. Cheng, K. L. Seyler, D. Zhong, E. Schmidgall, M. A.
McGuire, D. H. Cobden, W. Yao, D. Xiao, P. Jarillo-
Herrero, and X. Xu, Layer-dependent ferromagnetism
in a van der Waals crystal down to the monolayer limit,
Nature 546, 270 (2017).
[56] E. Beaurepaire,
J.-C. Merle,
A. Daunois, and J.-
Y. Bigot, Ultrafast Spin Dynamics in Ferromagnetic
Nickel, Phys. Rev. Lett. 76, 4250 (1996).
[57] V. V. Kruglyak, S. O. Demokritov, and D. Grundler,
Magnonics, Journal of Physics D: Applied Physics 43,
264001 (2010).
[58] Wolf, S. A. and Awschalom, D. D. and Buhrman, R. A.
and Daughton, J. M. and von Molnár, S. and Roukes,
M. L. and Chtchelkanova, A. Y. and Treger, D. M.,
Spintronics: A Spin-Based Electronics Vision for the
Future, Science 294, 1488 (2001).
[59] S. T. Bramwell and M. J. P. Gingras, Spin Ice State in
Frustrated Magnetic Pyrochlore Materials, Science 294,
1495 (2001).
[60] M. R. Norman, Colloquium: Herbertsmithite and the
search for the quantum spin liquid, Rev. Mod. Phys.
88, 041002 (2016).
[61] A. Kitaev, Anyons in an exactly solved model and be-
yond, Annals of Physics 321, 2 (2006).
[62] T. Oguchi, K. Terakura, and N. Hamada, Magnetism of
iron above the Curie temperature, Journal of Physics F:
Metal Physics 13, 145 (1983).
[63] T. Oguchi, K. Terakura, and A. R. Williams, Band the-
ory of the magnetic interaction in MnO, MnS, and NiO,
Phys. Rev. B 28, 6443 (1983).
[64] M. Inoue and T. Moriya, Interaction between localized
moments in metals, Progress of Theoretical Physics 38,
41 (1967).
[65] P. Lacour-Gayet and M. Cyrot, Magnetic properties of
the Hubbard model, Journal of Physics C: Solid State
Physics 7, 400 (1974).
[66] B. L. Gyorﬀy and G. M. Stocks, Momentum distribution
of electrons in concentrated random alloys, Journal of
Physics F: Metal Physics 10, L321 (1980).
[67] S. H. Liu, Exchange Interaction between Conduction
Electrons and Magnetic Shell Electrons in Rare-Earth
Metals, Phys. Rev. 121, 451 (1961).
[68] C. S. Wang, R. E. Prange, and V. Korenman, Mag-
netism in iron and nickel, Phys. Rev. B 25, 5766 (1982).
[69] J. M. Luttinger and J. C. Ward, Ground-State Energy
of a Many-Fermion System. II, Phys. Rev. 118, 1417
(1960).
[70] L. Hedin, New Method for Calculating the One-Particle
Green’s Function with Application to the Electron-Gas
Problem, Phys. Rev. 139, A796 (1965).
[71] G. Baym and L. P. Kadanoﬀ, Conservation Laws and
Correlation Functions, Phys. Rev. 124, 287 (1961).
[72] H. Aoki, N. Tsuji, M. Eckstein, M. Kollar, T. Oka, and
P. Werner, Nonequilibrium dynamical mean-ﬁeld theory
and its applications, Rev. Mod. Phys. 86, 779 (2014).
[73] E. Runge and E. K. U. Gross, Density-Functional The-
ory for Time-Dependent Systems, Phys. Rev. Lett. 52,
997 (1984).
[74] K. L. Liu and S. H. Vosko, A time-dependent spin den-
sity functional theory for the dynamical spin suscepti-
bility, Canadian journal of physics 67, 1015 (1989).
[75] J. F. Cooke, J. A. Blackman, and T. Morgan, New Inter-
pretation of Spin-Wave Behavior in Nickel, Phys. Rev.
Lett. 54, 718 (1985).
[76] S. Y. Savrasov, Linear Response Calculations of Spin
Fluctuations, Phys. Rev. Lett. 81, 2570 (1998).
[77] P. Buczek, A. Ernst, and L. M. Sandratskii, Diﬀerent di-
mensionality trends in the Landau damping of magnons
in iron, cobalt, and nickel:
Time-dependent density
functional study, Phys. Rev. B 84, 174418 (2011).
[78] N. Singh, P. Elliott, T. Nautiyal, J. K. Dewhurst, and
S. Sharma, Adiabatic generalized gradient approxima-

53
tion kernel in time-dependent density functional theory,
Phys. Rev. B 99, 035151 (2019).
[79] S.
Sharma,
J.
K.
Dewhurst,
C.
Ambrosch-Draxl,
S. Kurth, N. Helbig, S. Pittalis, S. Shallcross, L. Nord-
ström, and E. K. U. Gross, First-Principles Approach
to Noncollinear Magnetism: Towards Spin Dynamics,
Phys. Rev. Lett. 98, 196405 (2007).
[80] T. Gorni, I. Timrov, and S. Baroni, Spin dynamics from
time-dependent density functional perturbation theory,
The European Physical Journal B 91, 1 (2018).
[81] A. Castro, J. Werschnik, and E. K. U. Gross, Con-
trolling the Dynamics of Many-Electron Systems from
First Principles:
A Combination of Optimal Control
and Time-Dependent Density-Functional Theory, Phys.
Rev. Lett. 109, 153603 (2012).
[82] M. Thiele, E. K. U. Gross, and S. Kümmel, Adiabatic
Approximation in Nonperturbative Time-Dependent
Density-Functional
Theory,
Phys.
Rev.
Lett.
100,
153004 (2008).
[83] M. I. Katsnelson and A. I. Lichtenstein, Magnetic sus-
ceptibility, exchange interactions and spin-wave spec-
tra in the local spin density approximation, Journal of
Physics: Condensed Matter 16, 7439 (2004).
[84] J. Callaway, C. S. Wang, and D. G. Laurent, Magnetic
susceptibility and spin waves in ferromagnetic metals,
Phys. Rev. B 24, 6491 (1981).
[85] E. E. Salpeter and H. A. Bethe, A Relativistic Equation
for Bound-State Problems, Phys. Rev. 84, 1232 (1951).
[86] L. Ke and M. I. Katsnelson, Electron correlation eﬀects
on exchange interactions and spin excitations in 2D van
der Waals materials, npj Computational Materials 7, 4
(2021).
[87] A. S. Belozerov, A. A. Katanin, and V. I. Anisimov,
Momentum-dependent susceptibilities and magnetic ex-
change in bcc iron from supercell dynamical mean-ﬁeld
theory calculations, Phys. Rev. B 96, 075108 (2017).
[88] R. B. Muniz and D. L. Mills, Theory of spin excitations
in Fe(110) monolayers, Phys. Rev. B 66, 174417 (2002).
[89] A. T. Costa, R. B. Muniz, and D. L. Mills, Ground State
of Magnetic Dimers on Metal Surfaces, Phys. Rev. Lett.
94, 137203 (2005).
[90] S. Lounis, A. T. Costa, R. B. Muniz, and D. L.
Mills, Dynamical Magnetic Excitations of Nanostruc-
tures from First Principles, Phys. Rev. Lett. 105,
187205 (2010).
[91] A. I. Liechtenstein, V. I. Anisimov, and J. Zaanen,
Density-functional theory and strong interactions: Or-
bital ordering in Mott-Hubbard insulators, Phys. Rev.
B 52, R5467 (1995).
[92] P. Bruno, Exchange Interaction Parameters and Adi-
abatic Spin-Wave Spectra of Ferromagnets: A “Renor-
malized Magnetic Force Theorem”, Phys. Rev. Lett. 90,
087205 (2003).
[93] V. P. Antropov, The exchange coupling and spin waves
in metallic magnets: removal of the long-wave approxi-
mation, Journal of Magnetism and Magnetic Materials
262, L192 (2003).
[94] Y. H. Szczech, M. A. Tusch, and D. E. Logan, Spin
interactions in an Anderson-Hubbard model, Journal of
Physics: Condensed Matter 10, 639 (1998).
[95] X. Wan, Q. Yin, and S. Y. Savrasov, Calculation of Mag-
netic Exchange Interactions in Mott-Hubbard Systems,
Phys. Rev. Lett. 97, 266403 (2006).
[96] P. Phariseau and B. L. Gyorﬀy, Electrons in Disordered
Metals and at Metallic Surfaces, Vol. 42 (Springer Sci-
ence & Business Media, 2012).
[97] B. L. Gyorﬀy, A. J. Pindor, J. Staunton, G. M. Stocks,
and H. Winter, A ﬁrst-principles theory of ferromagnetic
phase transitions in metals, Journal of Physics F: Metal
Physics 15, 1337 (1985).
[98] O. K. Andersen and A. R. Mackintosh, Fermi surfaces
and eﬀective masses in FCC transition metals, Solid
State Communications 6, 285 (1968).
[99] M. Methfessel and J. Kubler, Bond analysis of heats
of formation: application to some group VIII and IB
hydrides, Journal of Physics F: Metal Physics 12, 141
(1982).
[100] A factor of 2 would appear in the last term of Eq. 3.10,
but it is canceled by a factor of 1
2 (that is explained in
Subsection I E).
[101] E. N. Economou, Green’s functions in quantum physics,
Vol. 7 (Springer Science & Business Media, 2006).
[102] Our conclusions would be the same for continuous spec-
trum.
[103] Note that G±(ε) =
 G∓(ε)
†.
[104] More details can be found at http://newton.phy.bme.
hu/~szunyogh/Elszerk/Kkr-slides.pdf.
[105] A. Auerbach, Interacting Electrons and Quantum Mag-
netism (Springer, New York, 1994).
[106] See the discussion of local vs global spin model later in
this Section.
[107] P. Lloyd, Wave propagation through an assembly of
spheres: II. The density of single-particle eigenstates,
Proceedings of the Physical Society 90, 207 (1967).
[108] M. I. Katsnelson and A. I. Lichtenstein, First-principles
calculations of magnetic interactions in correlated sys-
tems, Phys. Rev. B 61, 8906 (2000).
[109] J. Fransson, D. Thonig, P. F. Bessarab, S. Bhattachar-
jee, J. Hellsvik, and L. Nordström, Microscopic theory
for coupled atomistic magnetization and lattice dynam-
ics, Phys. Rev. Materials 1, 074404 (2017).
[110] Note that ∆V that we consider in Subsections V D and
V E is not the same as δV that stands for perturba-
tions due to diﬀerent kind of inﬁnitesimally small spin
rotations in the rest of Subsection V.
[111] H. Fukutome, Unrestricted Hartree–Fock theory and its
applications to molecules and chemical reactions, Inter-
national Journal of Quantum Chemistry 20, 955 (1981).
[112] We also note that in Eq. (5.39) we avoid to consider
the case of i = j that would correspond to a local, one-
site, anisotropy that is not included in the bilinear spin
model.
[113] V. P. Antropov, M. I. Katsnelson, and A. I. Liecht-
enstein, Exchange interactions in magnets, Physica B:
Condensed Matter 237, 336 (1997).
[114] S. Lounis and P. H. Dederichs, Mapping the magnetic
exchange interactions from ﬁrst principles: Anisotropy
anomaly and application to Fe, Ni, and Co, Phys. Rev.
B 82, 180404 (2010).
[115] S. Streib, A. Szilva, V. Borisov, M. Pereiro, A. Bergman,
E. Sjöqvist, A. Delin, M. I. Katsnelson, O. Eriksson,
and D. Thonig, Exchange constants for local spin hamil-
tonians from tight-binding models, Phys. Rev. B 103,
224413 (2021).
[116] A. I. Akhiezer, V. G. Bar’yakhtar, and S. V. Peletmin-
skii, Spin Waves (North-Holland, Amsterdam, 1968).
[117] A. Aharoni, Introduction to the Theory of Ferromag-
netism (Clarendon Press, 2000).

54
[118] A. I. Lichtenstein and M. I. Katsnelson, Magnetism
of
Correlated
Systems:
Beyond
LDA,
in
Band-
Ferromagnetism, edited by K. Baberschke, W. Nolting,
and M. Donath (Springer, Berlin, Heidelberg, 2001) pp.
75–93.
[119] M. I. Katsnelson and V. P. Antropov, Spin angular gra-
dient approximation in the density functional theory,
Phys. Rev. B 67, 140406 (2003).
[120] L. Kleinman, Density functional for noncollinear mag-
netic systems, Phys. Rev. B 59, 3314 (1999).
[121] K. Capelle, G. Vignale, and B. L. Györﬀy, Spin Cur-
rents and Spin Dynamics in Time-Dependent Density-
Functional Theory, Phys. Rev. Lett. 87, 206403 (2001).
[122] K. Capelle and B. L. Gyorﬀy, Exploring dynamical mag-
netism with time-dependent density-functional theory:
From spin ﬂuctuations to Gilbert damping, Europhysics
Letters (EPL) 61, 354 (2003).
[123] J. E. Peralta, G. E. Scuseria, and M. J. Frisch, Non-
collinear magnetism in density functional calculations,
Phys. Rev. B 75, 125119 (2007).
[124] G. Scalmani and M. J. Frisch, A New Approach to Non-
collinear Spin Density Functional Theory beyond the
Local Density Approximation, Journal of Chemical The-
ory and Computation 8, 2193 (2012).
[125] F. G. Eich, S. Pittalis, and G. Vignale, Transverse
and longitudinal gradients of the spin magnetization in
spin-density-functional theory, Phys. Rev. B 88, 245102
(2013).
[126] F. G. Eich and E. K. U. Gross, Transverse Spin-
Gradient Functional for Noncollinear Spin-Density-
Functional Theory, Phys. Rev. Lett. 111, 156401 (2013).
[127] I. W. Bulik, G. Scalmani, M. J. Frisch, and G. E.
Scuseria, Noncollinear density functional theory hav-
ing proper invariance and local torque properties, Phys.
Rev. B 87, 035117 (2013).
[128] C. A. Ullrich, Density-functional theory for systems
with noncollinear spin:
Orbital-dependent exchange-
correlation functionals and their application to the Hub-
bard dimer, Phys. Rev. B 98, 035140 (2018).
[129] S. Sharma, E. K. U. Gross, A. Sanna, and J. K.
Dewhurst, Source-Free Exchange-Correlation Magnetic
Fields in Density Functional Theory, Journal of Chem-
ical Theory and Computation 14, 1247 (2018).
[130] L. Nordström and D. J. Singh, Noncollinear Intra-
atomic Magnetism, Phys. Rev. Lett. 76, 4420 (1996).
[131] V. Heine and J. H. Samson, Magnetic, chemical and
structural ordering in transition metals, Journal of
Physics F: Metal Physics 13, 2155 (1983).
[132] J. R. Schrieﬀer, Theory of Superconducctivity (Avalon
Publishing, 1999).
[133] S. V. Vonsovsky, Y. A. Izyumov, and E. Z. Kurmaev,
Superconductivity of Transition Metals, their Alloys and
Compounds (Springer-Verlag, 1982).
[134] G. D. Mahan, Many-Particle Physics (Springer Science
& Business Media, 2000).
[135] G. Giuliani and G. Vignale, Quantum Theory of the
Electron Liquid (Cambridge University Press, 2005).
[136] V. V. Mazurenko, A. N. Rudenko, S. A. Nikolaev, D. S.
Medvedeva, A. I. Lichtenstein, and M. I. Katsnelson,
Role of direct exchange and Dzyaloshinskii-Moriya in-
teractions in magnetic properties of graphene deriva-
tives: C2F and C2H, Phys. Rev. B 94, 214411 (2016).
[137] I. V. Solovyev, I. V. Kashin, and V. V. Mazurenko,
Mechanisms and origins of half-metallic ferromagnetism
in CrO2, Phys. Rev. B 92, 144407 (2015).
[138] D. I. Badrtdinov, S. A. Nikolaev, M. I. Katsnelson, and
V. V. Mazurenko, Spin-orbit coupling and magnetic in-
teractions in Si(111):{C,Si,Sn,Pb}, Phys. Rev. B 94,
224418 (2016).
[139] D. I. Badrtdinov, S. A. Nikolaev, A. N. Rudenko, M. I.
Katsnelson, and V. V. Mazurenko, Nanoskyrmion engi-
neering with sp-electron materials: Sn monolayer on a
SiC(0001) surface, Phys. Rev. B 98, 184425 (2018).
[140] C. Etz, L. Bergqvist, A. Bergman, A. Taroni, and
O. Eriksson, Atomistic spin dynamics and surface
magnons, Journal of Physics: Condensed Matter 27,
243202 (2015).
[141] K. Sato, L. Bergqvist, J. Kudrnovský, P. H. Ded-
erichs, O. Eriksson, I. Turek, B. Sanyal, G. Bouzerar,
H. Katayama-Yoshida, V. A. Dinh, T. Fukushima,
H. Kizaki, and R. Zeller, First-principles theory of dilute
magnetic semiconductors, Rev. Mod. Phys. 82, 1633
(2010).
[142] O. K. Andersen and O. Jepsen, Explicit, First-Principles
Tight-Binding Theory, Phys. Rev. Lett. 53, 2571 (1984).
[143] J. Korringa, On the calculation of the energy of a Bloch
wave in a metal, Physica 13, 392 (1947).
[144] W. Kohn and N. Rostoker, Solution of the Schrödinger
Equation in Periodic Lattices with an Application to
Metallic Lithium, Phys. Rev. 94, 1111 (1954).
[145] H. Yoon, T. J. Kim, J.-H. Sim, S. W. Jang, T. Ozaki,
and M. J. Han, Reliability and applicability of magnetic-
force linear response theory:
Numerical parameters,
predictability, and orbital resolution, Phys. Rev. B 97,
125132 (2018).
[146] M. J. Han, T. Ozaki, and J. Yu, Electronic struc-
ture, magnetic interactions, and the role of ligands in
Mnn(n = 4, 12) single-molecule magnets, Phys. Rev. B
70, 184421 (2004).
[147] Y. O. Kvashnin, O. Grånäs, I. Di Marco, M. I. Kat-
snelson, A. I. Lichtenstein, and O. Eriksson, Exchange
parameters of strongly correlated materials: Extraction
from spin-polarized density functional theory plus dy-
namical mean-ﬁeld theory, Phys. Rev. B 91, 125133
(2015).
[148] T. Steenbock, J. Tasche, A. I. Lichtenstein, and C. Her-
rmann, A Green’s-Function Approach to Exchange Spin
Coupling As a New Tool for Quantum Chemistry, Jour-
nal of Chemical Theory and Computation 11, 5651
(2015).
[149] R. Logemann, A. N. Rudenko, M. I. Katsnelson, and
A. Kirilyuk, Exchange interactions in transition metal
oxides: the role of oxygen spin polarization, Journal of
Physics: Condensed Matter 29, 335801 (2017).
[150] R. Logemann, A. N. Rudenko, M. I. Katsnelson, and
A. Kirilyuk, Non-heisenberg covalent magnetism in iron
oxide clusters, Phys. Rev. Materials 2, 073001 (2018).
[151] I. V. Solovyev, Exchange interactions and magnetic
force theorem, Phys. Rev. B 103, 104428 (2021).
[152] A. N. Rudenko, F. J. Keil, M. I. Katsnelson, and
A. I. Lichtenstein, Exchange interactions and frustrated
magnetism in single-side hydrogenated and ﬂuorinated
graphene, Phys. Rev. B 88, 081405 (2013).
[153] D. M. Korotin, V. V. Mazurenko, V. I. Anisimov, and
S. V. Streltsov, Calculation of exchange constants of the
Heisenberg model in plane-wave-based methods using
the Green’s function approach, Phys. Rev. B 91, 224405
(2015).

55
[154] X. Zhu, A. Edström, and C. Ederer, Magnetic exchange
interactions in SrMnO3, Phys. Rev. B 101, 064401
(2020).
[155] N. Marzari, A. A. Mostoﬁ, J. R. Yates, I. Souza, and
D. Vanderbilt, Maximally localized Wannier functions:
Theory and applications, Rev. Mod. Phys. 84, 1419
(2012).
[156] H. Yoon, T. J. Kim, J.-H. Sim, and M. J. Han, Jx: An
open-source software for calculating magnetic interac-
tions based on magnetic force theory, Computer Physics
Communications 247, 106927 (2020).
[157] X. He, N. Helbig, M. J. Verstraete, and E. Bousquet,
TB2J: A python package for computing magnetic inter-
action parameters, Computer Physics Communications
264, 107938 (2021).
[158] M. V. You, V. Heine, A. J. Holden, and P. J. Lin-Chung,
Magnetism in Iron at High Temperatures, Phys. Rev.
Lett. 44, 1282 (1980).
[159] M. W. Stringfellow, Observation of spin-wave renormal-
ization eﬀects in iron and nickel, Journal of Physics C:
Solid State Physics 1, 950 (1968).
[160] M. van Schilfgaarde and V. P. Antropov, First-principles
exchange interactions in Fe, Ni, and Co, Journal of Ap-
plied Physics 85, 4827 (1999).
[161] V. Antropov, B. Harmon, and A. Smirnov, Aspects of
spin dynamics and magnetic interactions, Journal of
Magnetism and Magnetic Materials 200, 148 (1999).
[162] S. Frota-Pessôa, R. B. Muniz, and J. Kudrnovský, Ex-
change coupling in transition-metal ferromagnets, Phys.
Rev. B 62, 5293 (2000).
[163] M. Pajda, J. Kudrnovský, I. Turek, V. Drchal, and
P. Bruno, Ab initio calculations of exchange interac-
tions, spin-wave stiﬀness constants, and Curie tempera-
tures of Fe, Co, and Ni, Phys. Rev. B 64, 174402 (2001).
[164] L. Bergqvist, Electronic structure and statistical meth-
ods applied to nanomagnetism, diluted magnetic semi-
conductors and spintronics, Ph.D. thesis, Acta Univer-
sitatis Upsaliensis (2005).
[165] X. Liu, M. M. Steiner, R. Sooryakumar, G. A. Prinz,
R. F. C. Farrow, and G. Harp, Exchange stiﬀness,
magnetization, and spin waves in cubic and hexagonal
phases of cobalt, Phys. Rev. B 53, 12166 (1996).
[166] R. Vollmer, M. Etzkorn, P. S. A. Kumar, H. Ibach, and
J. Kirschner, Spin-wave excitation in ultrathin Co and
Fe ﬁlms on Cu(001) by spin-polarized electron energy
loss spectroscopy, Journal of Applied Physics 95, 7435
(2004).
[167] R. Vollmer, M. Etzkorn, P. S. A. Kumar, H. Ibach, and
J. Kirschner, Spin-Polarized Electron Energy Loss Spec-
troscopy of High Energy, Large Wave Vector Spin Waves
in Ultrathin fcc Co Films on Cu(001), Phys. Rev. Lett.
91, 147201 (2003).
[168] T. Balashov, P. Buczek, L. Sandratskii, A. Ernst, and
W. Wulfhekel, Magnon dispersion in thin magnetic
ﬁlms, Journal of Physics: Condensed Matter 26, 394007
(2014).
[169] H. A. Mook and D. M. Paul, Neutron-Scattering Mea-
surement of the Spin-Wave Spectra for Nickel, Phys.
Rev. Lett. 54, 227 (1985).
[170] M. A. Ruderman and C. Kittel, Indirect Exchange Cou-
pling of Nuclear Magnetic Moments by Conduction
Electrons, Phys. Rev. 96, 99 (1954).
[171] I. Turek, J. Kudrnovský, V. Drchal, P. Bruno, and
S. Blügel, Ab initio theory of exchange interactions in
itinerant magnets, physica status solidi (b) 236, 318
(2003).
[172] Y. O. Kvashnin, W. Sun, I. Di Marco, and O. Eriksson,
Electronic topological transition and noncollinear mag-
netism in compressed hcp Co, Phys. Rev. B 92, 134422
(2015).
[173] R. Chimata, E. K. Delczeg-Czirjak, A. Szilva, R. Car-
dias,
Y. O. Kvashnin,
M. Pereiro,
S. Mankovsky,
H. Ebert, D. Thonig, B. Sanyal, A. B. Klautau, and
O. Eriksson, Magnetism and ultrafast magnetization dy-
namics of Co and CoMn alloys at ﬁnite temperature,
Phys. Rev. B 95, 214417 (2017).
[174] S. Tiablikov, Methods in the Quantum Theory of Mag-
netism (Springer US, 2013).
[175] V. P. Antropov, M. I. Katsnelson, B. N. Harmon, M. van
Schilfgaarde, and D. Kusnezov, Spin dynamics in mag-
nets: Equation of motion and ﬁnite temperature eﬀects,
Phys. Rev. B 54, 1019 (1996).
[176] R. F. L. Evans, W. J. Fan, P. Chureemart, T. A. Ostler,
M. O. A. Ellis, and R. W. Chantrell, Atomistic spin
model simulations of magnetic nanomaterials, Journal
of Physics: Condensed Matter 26, 103202 (2014).
[177] S. Turzhevskii, A. I. Liechtenstein, and M. Katsnel-
son, Degree of localization of magnetic moments and
the non-Heisenberg nature of exchange interactions in
metals and alloys, Soviet Physics-Solid State 32, 1138
(1990).
[178] A. A. Shirinyan, V. K. Kozin, J. Hellsvik, M. Pereiro,
O. Eriksson, and D. Yudin, Self-organizing maps as a
method for detecting phase transitions and phase iden-
tiﬁcation, Phys. Rev. B 99, 041108 (2019).
[179] K. Binder and D. W. Heermann, Theoretical founda-
tions of the Monte Carlo method and its applications in
statistical physics, in Monte Carlo Simulation in Statis-
tical Physics (Springer, 2010) pp. 5–67.
[180] S.
J.
Pickart,
H.
A.
Alperin,
V.
J.
Minkiewicz,
R. Nathans, G. Shirane, and O. Steinsvoll, Spin-Wave
Dispersion in Ferromagnetic Ni and fcc Co, Phys. Rev.
156, 623 (1967).
[181] H. A. Mook, J. W. Lynn, and R. M. Nicklow, Tempera-
ture Dependence of the Magnetic Excitations in Nickel,
Phys. Rev. Lett. 30, 556 (1973).
[182] G. Shirane, V. J. Minkiewicz, and R. Nathans, Spin
Waves in 3d Metals, Journal of Applied Physics 39, 383
(1968).
[183] R. Singer, M. Fähnle, and G. Bihlmayer, Constrained
spin-density functional theory for excited magnetic con-
ﬁgurations in an adiabatic approximation, Phys. Rev. B
71, 214435 (2005).
[184] N.
M.
Rosengaard
and
B.
Johansson,
Finite-
temperature
study
of
itinerant
ferromagnetism
in
Fe, Co, and Ni, Phys. Rev. B 55, 14975 (1997).
[185] S. Shallcross, A. E. Kissavos, V. Meded, and A. V.
Ruban, An ab initio eﬀective Hamiltonian for mag-
netism including longitudinal spin ﬂuctuations, Phys.
Rev. B 72, 104437 (2005).
[186] P. Soven, Coherent-Potential Model of Substitutional
Disordered Alloys, Phys. Rev. 156, 809 (1967).
[187] R. J. Elliott, J. A. Krumhansl, and P. L. Leath, The
theory and properties of randomly disordered crystals
and related physical systems, Rev. Mod. Phys. 46, 465
(1974).
[188] V. Antropov, Magnetic short-range order above the
Curie temperature of Fe and Ni, Phys. Rev. B 72,

56
140406 (2005).
[189] A. V. Ruban, S. Khmelevskyi, P. Mohn, and B. Johans-
son, Temperature-induced longitudinal spin ﬂuctuations
in Fe and Ni, Phys. Rev. B 75, 054402 (2007).
[190] V. V. Mazurenko, S. N. Iskakov, A. N. Rudenko, I. V.
Kashin, O. M. Sotnikov, M. V. Valentyuk, and A. I.
Lichtenstein, Correlation eﬀects in insulating surface
nanostructures, Phys. Rev. B 88, 085112 (2013).
[191] V. Borisov, Y. O. Kvashnin, N. Ntallis, D. Thonig,
P. Thunström, M. Pereiro, A. Bergman, E. Sjöqvist,
A. Delin, L. Nordström, and O. Eriksson, Heisenberg
and anisotropic exchange interactions in magnetic mate-
rials with correlated electronic structure and signiﬁcant
spin-orbit coupling, Phys. Rev. B 103, 174422 (2021).
[192] H. Yoon, S. W. Jang, J.-H. Sim, T. Kotani, and
M. J. Han, Magnetic force theory combined with quasi-
particle self-consistent GW method, Journal of Physics:
Condensed Matter 31, 405503 (2019).
[193] Y. O. Kvashnin, R. Cardias, A. Szilva, I. Di Marco,
M. I. Katsnelson, A. I. Lichtenstein, L. Nordström, A. B.
Klautau, and O. Eriksson, Microscopic Origin of Heisen-
berg and Non-Heisenberg Exchange Interactions in Fer-
romagnetic bcc Fe, Phys. Rev. Lett. 116, 217202 (2016).
[194] R. Cardias, A. Szilva, A. Bergman, I. D. Marco, M. I.
Katsnelson, A. I. Lichtenstein, L. Nordström, A. B.
Klautau, O. Eriksson, and Y. O. Kvashnin, The Bethe-
Slater curve revisited;
new insights from electronic
structure theory, Scientiﬁc Reports 7, 4058 (2017).
[195] A. Szilva, D. Thonig, P. F. Bessarab, Y. O. Kvashnin,
D. C. M. Rodrigues, R. Cardias, M. Pereiro, L. Nord-
ström, A. Bergman, A. B. Klautau, and O. Eriksson,
Theory of noncollinear interactions beyond Heisenberg
exchange: Applications to bcc Fe, Phys. Rev. B 96,
144413 (2017).
[196] A. V. Ruban, M. I. Katsnelson, W. Olovsson, S. I.
Simak, and I. A. Abrikosov, Origin of magnetic frustra-
tions in Fe −Ni Invar alloys, Phys. Rev. B 71, 054402
(2005).
[197] I. Turek, J. Kudrnovský, V. Drchal, and P. Bruno, Ex-
change interactions, spin waves, and transition temper-
atures in itinerant magnets, Philosophical Magazine 86,
1713 (2006).
[198] H. Ebert, D. Ködderitzsch, and J. Minár, Calculating
condensed matter properties using the KKR-Green's
function method—recent developments and applica-
tions, Reports on Progress in Physics 74, 096501 (2011).
[199] M. Ležaić,
P. Mavropoulos, and S. Blügel, First-
principles prediction of high Curie temperature for fer-
romagnetic bcc-Co and bcc-FeCo alloys and its rele-
vance to tunneling magnetoresistance, Applied Physics
Letters 90, 082504 (2007).
[200] J. M. MacLaren, T. C. Schulthess, W. H. Butler, R. Sut-
ton, and M. McHenry, Electronic structure, exchange
interactions, and Curie temperature of FeCo, Journal of
Applied Physics 85, 4833 (1999).
[201] M. van Schilfgaarde, I. A. Abrikosov, and B. Johansson,
Origin of the Invar eﬀect in iron–nickel alloys, Nature
400, 46 (1999).
[202] A. Sakuma, First-Principles Study on the Non-Collinear
Magnetic Structures of Disordered Alloys, Journal of the
Physical Society of Japan 69, 3072 (2000).
[203] J. Kudrnovský, V. Drchal, and P. Bruno, Magnetic
properties of fcc Ni-based transition metal alloys, Phys.
Rev. B 77, 224422 (2008).
[204] J. Thoene, S. Chadov, G. Fecher, C. Felser, and
J. Kübler, Exchange energies, Curie temperatures and
magnons in Heusler compounds, Journal of Physics D:
Applied Physics 42, 084013 (2009).
[205] Y. Kurtulus, R. Dronskowski, G. D. Samolyuk, and
V. P. Antropov, Electronic structure and magnetic ex-
change coupling in ferromagnetic full Heusler alloys,
Phys. Rev. B 71, 014425 (2005).
[206] J. Rusz, L. Bergqvist, J. Kudrnovský, and I. Turek,
Exchange
interactions
and
Curie
temperatures
in
Ni2−xMnSb alloys: First-principles study, Phys. Rev.
B 73, 214412 (2006).
[207] V. D. Buchelnikov, P. Entel, S. V. Taskaev, V. V.
Sokolovskiy, A. Hucht, M. Ogura, H. Akai, M. E.
Gruner, and S. K. Nayak, Monte Carlo study of the
inﬂuence of antiferromagnetic exchange interactions on
the phase transitions of ferromagnetic Ni-Mn-X alloys
(X = In, Sn, Sb), Phys. Rev. B 78, 184427 (2008).
[208] V. D. Buchelnikov, V. V. Sokolovskiy, H. C. Herper,
H. Ebert, M. E. Gruner, S. V. Taskaev, V. V. Khovaylo,
A. Hucht, A. Dannenberg, M. Ogura, H. Akai, M. Acet,
and P. Entel, First-principles and Monte Carlo study of
magnetostructural transition and magnetocaloric prop-
erties of Ni2+xMn1−xGa, Phys. Rev. B 81, 094411
(2010).
[209] L. Wollmann, S. Chadov, J. Kübler, and C. Felser, Mag-
netism in cubic manganese-rich Heusler compounds,
Phys. Rev. B 90, 214420 (2014).
[210] S. Khmelevskyi, E. Simon, and L. Szunyogh, Anti-
ferromagnetism in Ru2MnZ (Z = Sn, Sb, Ge, Si) full
Heusler alloys:
Eﬀects of magnetic frustration and
chemical disorder, Phys. Rev. B 91, 094432 (2015).
[211] D. Comtesse, B. Geisler, P. Entel, P. Kratzer, and
L. Szunyogh, First-principles study of spin-dependent
thermoelectric properties of half-metallic Heusler thin
ﬁlms between platinum leads, Phys. Rev. B 89, 094410
(2014).
[212] E. Simon, J. G. Vida, S. Khmelevskyi, and L. Szunyogh,
Magnetism of ordered and disordered Ni2MnAl full
Heusler compounds, Phys. Rev. B 92, 054438 (2015).
[213] J. Chico,
S. Keshavarz,
Y. Kvashnin,
M. Pereiro,
I. Di Marco, C. Etz, O. Eriksson, A. Bergman, and
L. Bergqvist, First-principles studies of the Gilbert
damping and exchange interactions for half-metallic
Heuslers alloys, Phys. Rev. B 93, 214439 (2016).
[214] B. Sanyal, L. Bergqvist, and O. Eriksson, Ferromagnetic
materials in the zinc-blende structure, Phys. Rev. B 68,
054417 (2003).
[215] S. K. Bose and J. Kudrnovský, Exchange interactions
and Curie temperatures in Cr-based alloys in the zinc
blende structure: Volume- and composition-dependence
from ﬁrst-principles calculations, Phys. Rev. B 81,
054446 (2010).
[216] Y. Liu, S. K. Bose, and J. Kudrnovský, First-principles
theoretical studies of half-metallic ferromagnetism in
CrTe, Phys. Rev. B 82, 094435 (2010).
[217] M. I. Katsnelson, V. Y. Irkhin, L. Chioncel, A. I. Licht-
enstein, and R. A. de Groot, Half-metallic ferromagnets:
From band structure to many-body eﬀects, Rev. Mod.
Phys. 80, 315 (2008).
[218] P. Mohn and K. Schwarz, Supercell calculations for tran-
sition metal impurities in palladium, Journal of Physics:
Condensed Matter 5, 5099 (1993).
[219] O. N. Mryasov, Magnetic interactions in 3d–5d layered

57
ferromagnets, Journal of magnetism and magnetic ma-
terials 272, 800 (2004).
[220] O. N. Mryasov, Magnetic interactions and phase trans-
formations in FeM, M=(Pt,Rh) ordered alloys, Phase
Transitions 78, 197 (2005).
[221] S.
Polesya,
S.
Mankovsky,
O.
Sipr,
W.
Meindl,
C. Strunk, and H. Ebert, Finite-temperature magnetism
of FexPd1−x and CoxPt1−x alloys, Phys. Rev. B 82,
214409 (2010).
[222] S. Polesya, S. Mankovsky, D. Ködderitzsch, J. Minár,
and H. Ebert, Finite-temperature magnetism of FeRh
compounds, Phys. Rev. B 93, 024423 (2016).
[223] J. Barker and R. W. Chantrell, Higher-order exchange
interactions leading to metamagnetism in FeRh, Phys.
Rev. B 92, 094402 (2015).
[224] Y. O. Kvashnin, S. Khmelevskyi, J. Kudrnovský, A. N.
Yaresko, L. Genovese, and P. Bruno, Noncollinear mag-
netic ordering in compressed FePd3 ordered alloy: A
ﬁrst principles study, Phys. Rev. B 86, 174429 (2012).
[225] I. V. Solovyev, P. H. Dederichs, and I. Mertig, Ori-
gin of orbital magnetization and magnetocrystalline
anisotropy in TX ordered alloys (where T=Fe,Co and
X=Pd,Pt), Phys. Rev. B 52, 13419 (1995).
[226] M. Pajda, J. Kudrnovský, I. Turek, V. Drchal, and
P. Bruno, Oscillatory Curie Temperature of Two-
Dimensional Ferromagnets, Phys. Rev. Lett. 85, 5424
(2000).
[227] T.-H. Chuang, K. Zakeri, A. Ernst, Y. Zhang, H. J. Qin,
Y. Meng, Y.-J. Chen, and J. Kirschner, Magnetic prop-
erties and magnon excitations in Fe(001) ﬁlms grown on
Ir(001), Phys. Rev. B 89, 174404 (2014).
[228] Y. Meng, K. Zakeri, A. Ernst, T.-H. Chuang, H. J.
Qin, Y.-J. Chen, and J. Kirschner, Direct evidence
of antiferromagnetic exchange interaction in Fe(001)
ﬁlms: Strong magnon softening at the high-symmetry
M point, Phys. Rev. B 90, 174437 (2014).
[229] K. Zakeri,
H. Qin, and A. Ernst, Unconventional
magnonic surface and interface states in layered ferro-
magnets, Communications Physics 4, 18 (2021).
[230] L.
Bergqvist,
A.
Taroni,
A.
Bergman,
C.
Etz,
and O. Eriksson, Atomistic spin dynamics of low-
dimensional magnets, Phys. Rev. B 87, 144401 (2013).
[231] C. A. F. Vaz, J. A. C. Bland, and G. Lauhoﬀ, Mag-
netism in ultrathin ﬁlm structures, Reports on Progress
in Physics 71, 056501 (2008).
[232] P. Bruno,
J. Kudrnovský,
M. Pajda,
V. Drchal,
and I. Turek, Oscillatory Curie temperature of 2D-
ferromagnets, Journal of Magnetism and Magnetic Ma-
terials 240, 346 (2002), 4th International Symposium
on Metallic Multilayers.
[233] A. Ney, F. Wilhelm, M. Farle, P. Poulopoulos, P. Sri-
vastava, and K. Baberschke, Oscillations of the Curie
temperature and interlayer exchange coupling in mag-
netic trilayers, Phys. Rev. B 59, R3938 (1999).
[234] E. I. Isaev, L. V. Pourovskii, A. M. N. Niklasson, Y. K.
Vekilov, B. Johansson, and I. A. Abrikosov, Magnetic
properties of a Co/Cu/Ni trilayer on the Cu(100) sur-
face, Phys. Rev. B 65, 024435 (2001).
[235] S. Keshavarz, Y. O. Kvashnin, I. Di Marco, A. Delin,
M. I. Katsnelson, A. I. Lichtenstein, and O. Eriksson,
Layer-resolved magnetic exchange interactions of sur-
faces of late 3d elements: Eﬀects of electronic correla-
tions, Phys. Rev. B 92, 165129 (2015).
[236] J. Kudrnovský, F. c. v. Máca, I. Turek, and J. Redinger,
Substrate-induced antiferromagnetism of a Fe mono-
layer on the Ir(001) surface, Phys. Rev. B 80, 064405
(2009).
[237] K. Zakeri, T.-H. Chuang, A. Ernst, L. M. Sandratskii,
P. Buczek, H. J. Qin, Y. Zhang, and J. Kirschner, Direct
probing of the exchange interaction at buried interfaces,
Nature Nanotechnology 8, 853 (2013).
[238] K. Zakeri, Y. Zhang, J. Prokop, T.-H. Chuang, N. Sakr,
W. X. Tang, and J. Kirschner, Asymmetric Spin-
Wave Dispersion on Fe(110): Direct Evidence of the
Dzyaloshinskii-Moriya Interaction, Phys. Rev. Lett.
104, 137203 (2010).
[239] Udvardi, L. and Szunyogh, L., Chiral Asymmetry of the
Spin-Wave Spectra in Ultrathin Magnetic Films, Phys.
Rev. Lett. 102, 207204 (2009).
[240] S. Mankovsky, S. Bornemann, J. Minár, S. Polesya,
H. Ebert, J. B. Staunton, and A. I. Lichtenstein, Ef-
fects of spin-orbit coupling on the spin structure of
deposited transition-metal clusters, Phys. Rev. B 80,
014422 (2009).
[241] G. J. Vida, E. Simon, L. Rózsa, K. Palotás, and L. Szun-
yogh, Domain-wall proﬁles in Co/Irn/Pt(111) ultrathin
ﬁlms: Inﬂuence of the Dzyaloshinskii-Moriya interac-
tion, Phys. Rev. B 94, 214422 (2016).
[242] E. Simon, L. Rózsa, K. Palotás, and L. Szunyogh, Mag-
netism of a Co monolayer on Pt(111) capped by over-
layers of 5d elements: A spin-model study, Phys. Rev.
B 97, 134405 (2018).
[243] B.
Zimmermann,
G.
Bihlmayer,
M.
Böttcher,
M. Bouhassoune, S. Lounis, J. Sinova, S. Heinze,
S. Blügel, and B. Dupé, Comparison of ﬁrst-principles
methods to extract magnetic parameters in ultrathin
ﬁlms: Co/Pt(111), Phys. Rev. B 99, 214426 (2019).
[244] R. Haydock, V. Heine, and M. J. Kelly, Electronic struc-
ture based on the local atomic environment for tight-
binding bands. II, Journal of Physics C: Solid State
Physics 8, 2591 (1975).
[245] A. Bergman, L. Nordström, A. Burlamaqui Klautau,
S. Frota-Pessôa, and O. Eriksson, Magnetic structures
of small Fe, Mn, and Cr clusters supported on Cu(111):
Noncollinear ﬁrst-principles calculations, Phys. Rev. B
75, 224425 (2007).
[246] M. S. Ribeiro, G. B. Corrêa, A. Bergman, L. Nordström,
O. Eriksson, and A. B. Klautau, From collinear to vor-
tex magnetic structures in Mn corrals on Pt(111), Phys.
Rev. B 83, 014406 (2011).
[247] R. N. Igarashi, A. B. Klautau, R. B. Muniz, B. Sanyal,
and H. M. Petrilli, First-principles studies of complex
magnetism in Mn nanostructures on the Fe(001) surface,
Phys. Rev. B 85, 014436 (2012).
[248] A. Szilva, M. Costa, A. Bergman, L. Szunyogh, L. Nord-
ström, and O. Eriksson, Interatomic Exchange Interac-
tions for Finite-Temperature Magnetism and Nonequi-
librium Spin Dynamics, Phys. Rev. Lett. 111, 127204
(2013).
[249] M.
M.
Bezerra-Neto,
M.
S.
Ribeiro,
B.
Sanyal,
A. Bergman, R. B. Muniz, O. Eriksson, and A. B. Klau-
tau, Complex magnetic structure of clusters and chains
of Ni and Fe on Pt (111), Scientiﬁc Reports 3, 1 (2013).
[250] R. Cardias,
M. M. Bezerra-Neto,
M. S. Ribeiro,
A. Bergman, A. Szilva, O. Eriksson, and A. B. Klau-
tau, Magnetic and electronic structure of Mn nanos-
tructures on Ag(111) and Au(111), Phys. Rev. B 93,
014438 (2016).

58
[251] P.
C.
Carvalho,
I.
P.
Miranda,
A.
B.
Klautau,
A. Bergman, and H. M. Petrilli, Complex magnetic tex-
tures in Ni/Irn/Pt(111) ultrathin ﬁlms, Phys. Rev. Ma-
terials 5, 124406 (2021).
[252] A. Y. Perlov, S. V. Halilov, and H. Eschrig, Rare-earth
magnetism and adiabatic magnon spectra, Phys. Rev.
B 61, 4070 (2000).
[253] I. Turek, J. Kudrnovsk, G. Bihlmayer, and S. Blügel,
Ab initio theory of exchange interactions and the Curie
temperature of bulk Gd, Journal of Physics: Condensed
Matter 15, 2771 (2003).
[254] M. Colarieti-Tosti, S. I. Simak, R. Ahuja, L. Nordström,
O. Eriksson, D. Åberg, S. Edvardsson, and M. S. S.
Brooks, Origin of Magnetic Anisotropy of Gd Metal,
Phys. Rev. Lett. 91, 157201 (2003).
[255] S. Khmelevskyi, T. Khmelevska, A. V. Ruban, and
P. Mohn, Magnetic exchange interactions in the param-
agnetic state of hcp Gd, Journal of Physics: Condensed
Matter 19, 326218 (2007).
[256] I. L. M. Locht, Y. O. Kvashnin, D. C. M. Rodrigues,
M. Pereiro, A. Bergman, L. Bergqvist, A. I. Lichten-
stein, M. I. Katsnelson, A. Delin, A. B. Klautau, B. Jo-
hansson, I. Di Marco, and O. Eriksson, Standard model
of the rare earths analyzed from the Hubbard I approx-
imation, Phys. Rev. B 94, 085137 (2016).
[257] I.
Turek,
J.
Kudrnovský,
M.
Diviš,
P.
Franek,
G. Bihlmayer, and S. Blügel, First-principles study of
the electronic structure and exchange interactions in bcc
europium, Phys. Rev. B 68, 224431 (2003).
[258] J. Rusz, I. Turek, and M. Diviš, Random-phase ap-
proximation for critical temperatures of collinear mag-
nets with multiple sublattices: GdX compounds (X =
Mg, Rh, Ni, Pd), Phys. Rev. B 71, 174408 (2005).
[259] X. B. Liu and Z. Altounian, Exchange interaction in
GdT2 (T=Fe,Co,Ni) from ﬁrst-principles, Journal of
Applied Physics 107, 09E117 (2010).
[260] S. Khmelevskyi, Antiferromagnetic ordering on the frus-
trated fcc lattice in the intermetallic compound GdPtBi,
Phys. Rev. B 86, 104429 (2012).
[261] P. Söderlind, A. Landa, I. L. M. Locht, D. Åberg,
Y. Kvashnin, M. Pereiro, M. Däne, P. E. A. Turchi,
V. P. Antropov, and O. Eriksson, Prediction of the new
eﬃcient permanent magnet SmCoNiFe3, Phys. Rev. B
96, 100404 (2017).
[262] Q. Gong, M. Yi, R. F. L. Evans, B.-X. Xu, and O. Gut-
ﬂeisch, Calculating temperature-dependent properties
of Nd2Fe14B permanent magnets by atomistic spin
model simulations, Phys. Rev. B 99, 214409 (2019).
[263] M. J. Han, X. Wan, and S. Y. Savsavrrasov, Competi-
tion between Kondo and RKKY exchange couplings in
Pu1−xAmx alloys: Density functional theory with static
Hartree-Fock and dynamic Hubbard-I approximations,
Phys. Rev. B 78, 060401 (2008).
[264] X.
Wan,
J.
Dong,
and
S.
Y.
Savrasov,
Mecha-
nism of magnetic exchange interactions in europium
monochalcogenides, Phys. Rev. B 83, 205201 (2011).
[265] P. Santini, S. Carretta, G. Amoretti, R. Caciuﬀo,
N. Magnani, and G. H. Lander, Multipolar interactions
in f-electron systems: The paradigm of actinide diox-
ides, Rev. Mod. Phys. 81, 807 (2009).
[266] L. V. Pourovskii, Two-site ﬂuctuations and multipo-
lar intersite exchange interactions in strongly correlated
systems, Phys. Rev. B 94, 115117 (2016).
[267] L. V. Pourovskii and S. Khmelevskyi, Quadrupolar su-
perexchange interactions, multipolar order, and mag-
netic phase transition in UO2, Phys. Rev. B 99, 094439
(2019).
[268] L. V. Pourovskii and S. Khmelevskyi, Hidden order and
multipolar exchange striction in a correlated f-electron
system, Proceedings of the National Academy of Sci-
ences 118, 10.1073/pnas.2025317118 (2021).
[269] P. W. Anderson, New Approach to the Theory of Su-
perexchange Interactions, Phys. Rev. 115, 2 (1959).
[270] J. B. Goodenough, Theory of the Role of Covalence
in the Perovskite-Type Manganites [La, M(II)]MnO3,
Phys. Rev. 100, 564 (1955).
[271] J. Kanamori, Superexchange interaction and symmetry
properties of electron orbitals, Journal of Physics and
Chemistry of Solids 10, 87 (1959).
[272] H. A. Kramers, L’interaction entre les atomes magné-
togènes dans un cristal paramagnétique, Physica 1, 182
(1934).
[273] C. Zener, Interaction between the d-Shells in the Tran-
sition Metals. II. Ferromagnetic Compounds of Man-
ganese with Perovskite Structure, Phys. Rev. 82, 403
(1951).
[274] P. Schiﬀer, A. P. Ramirez, W. Bao, and S.-W. Cheong,
Low Temperature Magnetoresistance and the Magnetic
Phase Diagram of La1−xCaxMnO3, Phys. Rev. Lett. 75,
3336 (1995).
[275] I. V. Solovyev and K. Terakura, Eﬀective single-particle
potentials for MnO in light of interatomic magnetic in-
teractions:
Existing theories and perspectives, Phys.
Rev. B 58, 15496 (1998).
[276] G. Fischer, M. Däne, A. Ernst, P. Bruno, M. Lüders,
Z. Szotek, W. Temmerman, and W. Hergert, Exchange
coupling in transition metal monoxides:
Electronic
structure calculations, Phys. Rev. B 80, 014408 (2009).
[277] S. Keshavarz, J. Schött, A. J. Millis, and Y. O. Kvash-
nin, Electronic structure, magnetism, and exchange in-
tegrals in transition-metal oxides:
Role of the spin
polarization of the functional in DFT+U calculations,
Phys. Rev. B 97, 184404 (2018).
[278] O. Grånäs, I. Di Marco, P. Thunström, L. Nordström,
O. Eriksson, T. Björkman, and J. Wills, Charge self-
consistent dynamical mean-ﬁeld theory based on the
full-potential linear muﬃn-tin orbital method: Method-
ology and applications, Computational Materials Sci-
ence 55, 295 (2012).
[279] T. Kotani and M. van Schilfgaarde, Spin wave dispersion
based on the quasiparticle self-consistent GW method:
NiO, MnO and α-MnAs, Journal of Physics: Condensed
Matter 20, 295214 (2008).
[280] I. Solovyev, N. Hamada, and K. Terakura, t2g versus
all 3d localization in LaMO3 perovskites (M=Ti–Cu):
First-principles study, Phys. Rev. B 53, 7158 (1996).
[281] I. Solovyev, N. Hamada, and K. Terakura, Crucial Role
of the Lattice Distortion in the Magnetism of LaMnO3,
Phys. Rev. Lett. 76, 4825 (1996).
[282] I. V. Solovyev and K. Terakura, Zone Boundary Soft-
ening of the Spin-Wave Dispersion in Doped Ferromag-
netic Manganites, Phys. Rev. Lett. 82, 2959 (1999).
[283] I. V. Solovyev and K. Terakura, Magnetic Spin Origin
of the Charge-Ordered Phase in Manganites, Phys. Rev.
Lett. 83, 2825 (1999).
[284] I. V. Solovyev, Lattice distortion and magnetism of 3d−
t2g perovskite oxides, Phys. Rev. B 74, 054412 (2006).
[285] S. W. Jang, S. Ryee, H. Yoon, and M. J. Han, Charge

59
density functional plus U theory of LaMnO3: Phase
diagram, electronic structure, and magnetic interaction,
Phys. Rev. B 98, 125126 (2018).
[286] I. Solovyev, Long-Range Magnetic Interactions Induced
by the Lattice Distortions and the Origin of the E-Type
Antiferromagnetic Phase in the Undoped Orthorhombic
Manganites, Journal of the Physical Society of Japan
78, 054710 (2009).
[287] V. V. Mazurenko, S. L. Skornyakov, A. V. Kozhevnikov,
F. Mila, and V. I. Anisimov, Wannier functions and ex-
change integrals: The example of LiCu2O2, Phys. Rev.
B 75, 224408 (2007).
[288] W. Heitler and F. London, Wechselwirkung neutraler
Atome und homöopolare Bindung nach der Quanten-
mechanik, Zeitschrift für Physik 44, 455 (1927).
[289] V. V. Mazurenko, F. Mila, and V. I. Anisimov, Elec-
tronic structure and exchange interactions of Na2V3O7,
Phys. Rev. B 73, 014418 (2006).
[290] V. V. Mazurenko, S. L. Skornyakov, V. I. Anisimov, and
F. Mila, First-principles investigation of symmetric and
antisymmetric exchange interactions of SrCu2(BO3)2,
Phys. Rev. B 78, 195110 (2008).
[291] S. Jodlauk, P. Becker, J. A. Mydosh, D. I. Khomskii,
T. Lorenz, S. V. Streltsov, D. C. Hezel, and L. Bo-
hatý, Pyroxenes: a new class of multiferroics, Journal
of Physics: Condensed Matter 19, 432201 (2007).
[292] J. Barker, D. Pashov, and J. Jackson, Electronic struc-
ture and ﬁnite temperature magnetism of yttrium iron
garnet, Electronic Structure 2, 044002 (2020).
[293] O.
I.
Gorbatov,
G.
Johansson,
A.
Jakobsson,
S. Mankovsky, H. Ebert, I. Di Marco, J. Minár, and
C. Etz, Magnetic exchange interactions in yttrium iron
garnet: A fully relativistic ﬁrst-principles investigation,
Phys. Rev. B 104, 174401 (2021).
[294] I. V. Solovyev, Electronic structure and stability of the
ferrimagnetic ordering in double perovskites, Phys. Rev.
B 65, 144446 (2002).
[295] C. Etz, I. V. Maznichenko, D. Böttcher, J. Henk,
A. N. Yaresko, W. Hergert, I. I. Mazin, I. Mertig, and
A. Ernst, Indications of weak electronic correlations in
SrRuO3 from ﬁrst-principles calculations, Phys. Rev. B
86, 064441 (2012).
[296] S. K. Panda, Y. O. Kvashnin, B. Sanyal, I. Dasgupta,
and O. Eriksson, Electronic structure and exchange in-
teractions of insulating double perovskite La2CuRuO6,
Phys. Rev. B 94, 064427 (2016).
[297] V. V. Mazurenko and V. I. Anisimov, Weak ferromag-
netism in antiferromagnets: α−Fe2O3 and La2CuO4,
Phys. Rev. B 71, 184434 (2005).
[298] H. Ebert and S. Mankovsky, Anisotropic exchange cou-
pling in diluted magnetic semiconductors:
Ab initio
spin-density functional theory, Phys. Rev. B 79, 045209
(2009).
[299] M. Katsnelson,
Y. Kvashnin,
V. Mazurenko, and
A. Lichtenstein, Correlated band theory of spin and
orbital contributions to Dzyaloshinskii-Moriya interac-
tions, Physical Review B 82, 100403 (2010).
[300] A. Secchi, S. Brener, A. I. Lichtenstein, and M. I.
Katsnelson, Non-equilibrium magnetic interactions in
strongly correlated systems, Annals of Physics 333, 221
(2013).
[301] S. Mankovsky and H. Ebert, Accurate scheme to calcu-
late the interatomic Dzyaloshinskii-Moriya interaction
parameters, Phys. Rev. B 96, 104416 (2017).
[302] H. Ebert, S. Mankovsky, and S. Wimmer, Handbook of
Magnetism and Magnetic Materials, edited by J. M. D.
Coey and S. S. Parkin (Springer International Publish-
ing, Cham, 2021) pp. 187–259.
[303] V. E. Dmitrienko, E. N. Ovchinnikova, S. P. Collins,
G.
Nisbet,
G.
Beutier,
Y.
O.
Kvashnin,
V.
V.
Mazurenko, A. I. Lichtenstein, and M. I. Katsnelson,
Measuring the Dzyaloshinskii-Moriya interaction in a
weak ferromagnet, Nature Physics 10, 202 (2014).
[304] I. Tsubokawa, On the Magnetic Properties of a CrBr3
Single Crystal, Journal of the Physical Society of Japan
15, 1664 (1960).
[305] J. F. Dillon and C. E. Olson, Magnetization, Resonance,
and Optical Properties of the Ferromagnet CrI3, Journal
of Applied Physics 36, 1259 (1965).
[306] C. Gong, L. Li, Z. Li, H. Ji, A. Stern, Y. Xia, T. Cao,
W. Bao, C. Wang, Y. Wang, Z. Q. Qiu, R. J. Cava,
S. G. Louie, J. Xia, and X. Zhang, Discovery of intrin-
sic ferromagnetism in two-dimensional van der Waals
crystals, Nature 546, 265 (2017).
[307] K. S. Burch, D. Mandrus, and J.-G. Park, Magnetism in
two-dimensional van der Waals materials, Nature 563,
47 (2018).
[308] M. Gibertini, M. Koperski, A. F. Morpurgo, and K. S.
Novoselov, Magnetic 2D materials and heterostructures,
Nature Nanotechnology 14, 408 (2019).
[309] O. Besbes, S. Nikolaev, N. Meskini, and I. Solovyev,
Microscopic origin of ferromagnetism in the trihalides
CrCl3 and CrI3, Phys. Rev. B 99, 104432 (2019).
[310] I. V. Kashin, V. V. Mazurenko, M. I. Katsnelson, and
A. N. Rudenko, Orbitally-resolved ferromagnetism of
monolayer CrI3, 2D Materials 7, 025036 (2020).
[311] D. Soriano, A. N. Rudenko, M. I. Katsnelson, and
M. Rösner, Environmental screening and ligand-ﬁeld ef-
fects to magnetism in CrI3 monolayer, npj Computa-
tional Materials 7, 162 (2021).
[312] L. Webster and J.-A. Yan, Strain-tunable magnetic
anisotropy in monolayer CrCl3, CrBr3, and CrI3, Phys.
Rev. B 98, 144411 (2018).
[313] M. Dupont, Y. O. Kvashnin, M. Shiranzaei, J. Frans-
son, N. Laﬂorencie, and A. Kantian, Monolayer CrCl3
as an Ideal Test Bed for the Universality Classes of 2D
Magnetism, Phys. Rev. Lett. 127, 037204 (2021).
[314] B. Sadhukhan, A. Bergman, Y. O. Kvashnin, J. Hellsvik,
and A. Delin, Spin-lattice couplings in two-dimensional
CrI3 from ﬁrst-principles computations, Phys. Rev. B
105, 104418 (2022).
[315] S. W. Jang, M. Y. Jeong, H. Yoon, S. Ryee, and M. J.
Han, Microscopic understanding of magnetic interac-
tions in bilayer CrI3, Phys. Rev. Materials 3, 031001
(2019).
[316] N. Sivadas, S. Okamoto, X. Xu, C. J. Fennie, and
D. Xiao, Stacking-Dependent Magnetism in Bilayer
CrI3, Nano Letters 18, 7658 (2018).
[317] T. Song, Z. Fei, M. Yankowitz, Z. Lin, Q. Jiang,
K.
Hwangbo,
Q.
Zhang,
B.
Sun,
T.
Taniguchi,
K. Watanabe, M. A. McGuire, D. Graf, T. Cao, J.-H.
Chu, D. H. Cobden, C. R. Dean, D. Xiao, and X. Xu,
Switching 2D magnetic states via pressure tuning of
layer stacking, Nature Materials 18, 1298 (2019).
[318] T. Li, S. Jiang, N. Sivadas, Z. Wang, Y. Xu, D. Weber,
J. E. Goldberger, K. Watanabe, T. Taniguchi, C. J.
Fennie, K. Fai Mak, and J. Shan, Pressure-controlled
interlayer magnetism in atomically thin CrI3, Nature

60
Materials 18, 1303 (2019).
[319] D. Wang and B. Sanyal, Systematic Study of Mono-
layer to Trilayer CrI3: Stacking Sequence Dependence
of Electronic Structure and Magnetism, The Journal of
Physical Chemistry C 125, 18467 (2021).
[320] L. Chen, J.-H. Chung, B. Gao, T. Chen, M. B. Stone,
A. I. Kolesnikov, Q. Huang, and P. Dai, Topologi-
cal Spin Excitations in Honeycomb Ferromagnet CrI3,
Phys. Rev. X 8, 041028 (2018).
[321] I. Lee,
F. G. Utermohlen,
D. Weber,
K. Hwang,
C. Zhang, J. van Tol, J. E. Goldberger, N. Trivedi, and
P. C. Hammel, Fundamental Spin Interactions Underly-
ing the Magnetic Anisotropy in the Kitaev Ferromagnet
CrI3, Phys. Rev. Lett. 124, 017201 (2020).
[322] Y. O. Kvashnin, A. Bergman, A. I. Lichtenstein, and
M. I. Katsnelson, Relativistic exchange interactions in
CrX3 (X = Cl, Br, I) monolayers, Phys. Rev. B 102,
115162 (2020).
[323] V. I. Anisimov, J. Zaanen, and O. K. Andersen, Band
theory and Mott insulators:
Hubbard U instead of
Stoner I, Phys. Rev. B 44, 943 (1991).
[324] M. T. Czyżyk and G. A. Sawatzky, Local-density func-
tional and on-site correlations:
The electronic struc-
ture of La2CuO4 and LaCuO3, Phys. Rev. B 49, 14211
(1994).
[325] K. Wang, S. Nikolaev, W. Ren, and I. Solovyev, Giant
contribution of the ligand states to the magnetic prop-
erties of the Cr2Ge2Te6 monolayer, Phys. Chem. Chem.
Phys. 21, 9597 (2019).
[326] S. W. Jang, H. Yoon, M. Y. Jeong, S. Ryee, H.-S. Kim,
and M. J. Han, Origin of ferromagnetism and the eﬀect
of doping on Fe3GeTe2, Nanoscale 12, 13501 (2020).
[327] S. W. Jang, D. H. Kiem, J. Lee, Y.-G. Kang, H. Yoon,
and M. J. Han, Hund’s physics and the magnetic ground
state of CrOX (X = Cl, Br), Phys. Rev. Materials 5,
034409 (2021).
[328] R. K. Ghosh, A. Jose, and G. Kumari, Intrinsic spin-
dynamical properties of two-dimensional half-metallic
FeX2 (X = Cl, Br, I) ferromagnets: Insight from den-
sity functional theory calculations, Phys. Rev. B 103,
054409 (2021).
[329] S. Lebègue, T. Björkman, M. Klintenberg, R. M. Niem-
inen, and O. Eriksson, Two-Dimensional Materials from
Data Filtering and Ab Initio Calculations, Phys. Rev.
X 3, 031002 (2013).
[330] P. Hansmann, T. Ayral, L. Vaugier, P. Werner, and
S. Biermann, Long-Range Coulomb Interactions in Sur-
face Systems:
A First-Principles Description within
Self-Consistently Combined GW and Dynamical Mean-
Field Theory, Phys. Rev. Lett. 110, 166401 (2013).
[331] E. A. Stepanov, S. A. Nikolaev, C. Dutreix, M. I. Kat-
snelson, and V. V. Mazurenko, Heisenberg-exchange-
free nanoskyrmion mosaic, Journal of Physics:
Con-
densed Matter 31, 17LT01 (2019).
[332] D. Gatteschi, A. Caneschi, L. Pardi, and R. Sessoli,
Large Clusters of Metal Ions:
The Transition from
Molecular to Bulk Magnets, Science 265, 1054 (1994).
[333] I. Chiorescu, W. Wernsdorfer, A. Müller, H. Bögge, and
B. Barbara, Butterﬂy Hysteresis Loop and Dissipative
Spin Reversal in the S = 1/2, V15 Molecular Complex,
Phys. Rev. Lett. 84, 3454 (2000).
[334] V. V. Dobrovitski, M. I. Katsnelson, and B. N. Harmon,
Mechanisms of Decoherence in Weakly Anisotropic
Molecular Magnets, Phys. Rev. Lett. 84, 3458 (2000).
[335] L. Bogani and W. Wernsdorfer, Molecular spintronics
using single-molecule magnets, Nature Materials 7, 179
(2008).
[336] M. Mannini, F. Pineider, P. Sainctavit, C. Danieli,
E. Otero, C. Sciancalepore, A. M. Talarico, M.-A. Ar-
rio, A. Cornia, D. Gatteschi, and R. Sessoli, Magnetic
memory of a single-molecule quantum magnet wired to
a gold surface, Nature Materials 8, 194 (2009).
[337] A. V. Postnikov, J. Kortus, and M. R. Pederson, Density
functional studies of molecular magnets, physica status
solidi (b) 243, 2533 (2006).
[338] D. W. Boukhvalov, V. V. Dobrovitski, M. I. Katsnel-
son, A. I. Lichtenstein, B. N. Harmon, and P. Kögerler,
Electronic structure and exchange interactions in V15
magnetic molecules: LDA+U results, Phys. Rev. B 70,
054417 (2004).
[339] E. Kampert, F. F. B. J. Janssen, D. W. Boukhvalov,
J. C. Russcher,
J. M. M. Smits,
R. de Gelder,
B. de Bruin, P. C. M. Christianen, U. Zeitler, M. I.
Katsnelson, J. C. Maan, and A. E. Rowan, Ligand-
Controlled Magnetic Interactions in Mn4 Clusters, In-
organic Chemistry 48, 11903 (2009).
[340] D. W. Boukhvalov, A. I. Lichtenstein, V. V. Dobrovit-
ski, M. I. Katsnelson, B. N. Harmon, V. V. Mazurenko,
and V. I. Anisimov, Eﬀect of local Coulomb interactions
on the electronic structure and exchange interactions
in Mn12 magnetic molecules, Phys. Rev. B 65, 184435
(2002).
[341] V. V. Mazurenko, Y. O. Kvashnin, F. Jin, H. A.
De Raedt, A. I. Lichtenstein, and M. I. Katsnelson,
First-principles modeling of magnetic excitations in
Mn12, Phys. Rev. B 89, 214422 (2014).
[342] E. Ruiz,
J. Cano, and S. Alvarez, Density Func-
tional Study of Exchange Coupling Constants in Single-
Molecule Magnets: The Fe8 Complex, Chemistry – A
European Journal 11, 4767 (2005).
[343] K. Park, M. R. Pederson, and C. S. Hellberg, Properties
of low-lying excited manifolds in Mn12 acetate, Phys.
Rev. B 69, 014416 (2004).
[344] G. Chaboussant, A. Sieber, S. Ochsenbein, H.-U. Güdel,
M. Murrie, A. Honecker, N. Fukushima, and B. Nor-
mand, Exchange interactions and high-energy spin
states in Mn12-acetate, Phys. Rev. B 70, 104422 (2004).
[345] A. Kirilyuk, A. V. Kimel, and T. Rasing, Ultrafast op-
tical manipulation of magnetic order, Rev. Mod. Phys.
82, 2731 (2010).
[346] J. H. Mentink, Manipulating magnetism by ultrafast
control of the exchange interaction, Journal of Physics:
Condensed Matter 29, 453001 (2017).
[347] A. Melnikov, I. Radu, U. Bovensiepen, O. Krupin,
K. Starke, E. Matthias, and M. Wolf, Coherent Optical
Phonons and Parametrically Coupled Magnons Induced
by Femtosecond Laser Excitation of the Gd(0001) Sur-
face, Phys. Rev. Lett. 91, 227403 (2003).
[348] R. R. Subkhangulov, A. B. Henriques, P. H. O. Rappl,
E. Abramof, T. Rasing, and A. V. Kimel, All-optical
manipulation and probing of the d–f exchange interac-
tion in EuTe, Scientiﬁc reports 4, 1 (2014).
[349] R. V. Mikhaylovskiy, E. Hendry, A. Secchi, J. H.
Mentink, M. Eckstein, A. Wu, R. V. Pisarev, V. V.
Kruglyak, M. I. Katsnelson, T. Rasing, and A. V. Kimel,
Ultrafast optical modiﬁcation of exchange interactions
in iron oxides, Nature communications 6, 1 (2015).
[350] L. P. Kadanoﬀand G. Baym, Quantum Statistical Me-

61
chanics: Green’s Function Methods in Equilibrium and
Nonequilibrium Problems, 1st ed. (CRC Press, 1962).
[351] J. Rammer and H. Smith, Quantum ﬁeld-theoretical
methods in transport theory of metals, Rev. Mod. Phys.
58, 323 (1986).
[352] G. Stefanucci and R. van Leeuwen, Nonequilibrium
Many-Body Theory of Quantum Systems: A Modern In-
troduction (Cambridge University Press, 2013).
[353] A. Kamenev, Field Theory of Non-Equilibrium Systems
(Cambridge University Press, 2011).
[354] A. Secchi, A. I. Lichtenstein, and M. I. Katsnelson,
Nonequilibrium itinerant-electron magnetism: A time-
dependent mean-ﬁeld theory, Phys. Rev. B 94, 085153
(2016).
[355] M. Bukov, L. D’Alessio, and A. Polkovnikov, Univer-
sal high-frequency behavior of periodically driven sys-
tems: from dynamical stabilization to Floquet engineer-
ing, Advances in Physics 64, 139 (2015).
[356] A. Eckardt, Colloquium: Atomic quantum gases in pe-
riodically driven optical lattices, Rev. Mod. Phys. 89,
011004 (2017).
[357] A. P. Itin and A. I. Neishtadt, Eﬀective Hamiltonians
for fastly driven tight-binding chains, Physics Letters A
378, 822 (2014).
[358] A. P. Itin and M. I. Katsnelson, Eﬀective Hamiltoni-
ans for Rapidly Driven Many-Body Lattice Systems:
Induced Exchange Interactions and Density-Dependent
Hoppings, Phys. Rev. Lett. 115, 075301 (2015).
[359] M.
Bukov,
M.
Kolodrubetz,
and
A.
Polkovnikov,
Schrieﬀer-WolﬀTransformation for Periodically Driven
Systems: Strongly Correlated Systems with Artiﬁcial
Gauge Fields, Phys. Rev. Lett. 116, 125301 (2016).
[360] C. Dutreix, E. A. Stepanov, and M. I. Katsnelson,
Laser-induced topological transitions in phosphorene
with inversion symmetry, Phys. Rev. B 93, 241404(R)
(2016).
[361] S. Kitamura and H. Aoki, η-pairing superﬂuid in
periodically-driven
fermionic
Hubbard
model
with
strong attraction, Phys. Rev. B 94, 174503 (2016).
[362] C. Dutreix and M. I. Katsnelson, Dynamical control of
electron-phonon interactions with high-frequency light,
Phys. Rev. B 95, 024306 (2017).
[363] E. A. Stepanov, C. Dutreix, and M. I. Katsnelson, Dy-
namical and Reversible Control of Topological Spin Tex-
tures, Phys. Rev. Lett. 118, 157201 (2017).
[364] F. Peronaci, O. Parcollet, and M. Schiró, Enhancement
of local pairing correlations in periodically driven Mott
insulators, Phys. Rev. B 101, 161101(R) (2020).
[365] V. N. Valmispild, C. Dutreix, M. Eckstein, M. I. Kat-
snelson, A. I. Lichtenstein, and E. A. Stepanov, Dynam-
ically induced doublon repulsion in the Fermi-Hubbard
model probed by a single-particle density of states,
Phys. Rev. B 102, 220301 (2020).
[366] J. H. Mentink, K. Balzer, and M. Eckstein, Ultrafast
and reversible control of the exchange interaction in
mott insulators, Nature communications 6, 1 (2015).
[367] M. Claassen, H.-C. Jiang, B. Moritz, and T. P. De-
vereaux, Dynamical time-reversal symmetry breaking
and photo-induced chiral spin liquids in frustrated Mott
insulators, Nature communications 8, 1 (2017).
[368] M. M. S. Barbeau, M. Eckstein, M. I. Katsnelson, and
J. H. Mentink, Optical control of competing exchange
interactions and coherent spin-charge coupling in two-
orbital Mott insulators, SciPost Phys. 6, 27 (2019).
[369] K. A. Chao, J. Spałek, and O. A. M., Degenerate pertur-
bation theory and its application to the Hubbard model,
Physics Letters A 64, 163 (1977).
[370] K. A. Chao, J. Spałek, and A. M. Oleś, Kinetic exchange
interaction in a narrow S-band, Journal of Physics C:
Solid State Physics 10, L271 (1977).
[371] A. H. MacDonald, S. M. Girvin, and D. Yoshioka,
t
U
expansion for the Hubbard model, Phys. Rev. B 37,
9753 (1988).
[372] J. Spałek, t-J Model Then and Now:
a Personal
Perspective from the Pioneering Times, Acta Physica
Polonica A 111, 409 (2007).
[373] A. Inomata, H. Kuratsui, and C. C. Gerry, Path Inte-
grals and Coherent States of SU(2) and SU(1,1) (World
Scientiﬁc, Singapore, 1992).
[374] A. Schapere and F. Wilczek, Geometric Phases in
Physics (World Scientiﬁc, Singapore, 1989).
[375] M. Sayad and M. Potthoﬀ, Spin dynamics and relax-
ation in the classical-spin Kondo-impurity model be-
yond the Landau–Lifschitz–Gilbert equation, New Jour-
nal of Physics 17, 113058 (2015).
[376] M. Sayad, R. Rausch, and M. Potthoﬀ, Relaxation of a
Classical Spin Coupled to a Strongly Correlated Elec-
tron System, Phys. Rev. Lett. 117, 127201 (2016).
[377] D. Pekker and C. M. Varma, Amplitude/Higgs Modes
in Condensed Matter Physics, Annual Review of Con-
densed Matter Physics 6, 269 (2015).
[378] C. Rüegg, B. Normand, M. Matsumoto, A. Furrer,
D. F. McMorrow, K. W. Krämer, H. U. Güdel, S. N.
Gvasaliya, H. Mutka, and M. Boehm, Quantum Mag-
nets under Pressure: Controlling Elementary Excita-
tions in TlCuCl3, Phys. Rev. Lett. 100, 205701 (2008).
[379] P. Merchant, B. Normand, K. W. Krämer, M. Boehm,
D. F. McMorrow, and C. Rüegg, Quantum and classi-
cal criticality in a dimerized quantum antiferromagnet,
Nature physics 10, 373 (2014).
[380] A. Jain, M. Krautloher, J. Porras, G. H. Ryu, D. P.
Chen,
D. L. Abernathy,
J. T. Park,
A. Ivanov,
J. Chaloupka, G. Khaliullin, B. Keimer, and B. J. Kim,
Higgs mode and its decay in a two-dimensional antifer-
romagnet, Nature Physics 13, 633 (2017).
[381] Souliou, Soﬁa-Michaela and Chaloupka, Jiří and Khali-
ullin, Giniyat and Ryu, Gihun and Jain, Anil and Kim,
B. J. and Le Tacon, Matthieu and Keimer, Bernhard,
Raman Scattering from Higgs Mode Oscillations in
the Two-Dimensional Antiferromagnet Ca2RuO4, Phys.
Rev. Lett. 119, 067201 (2017).
[382] T. Hong, M. Matsumoto, Y. Qiu, W. Chen, T. R. Gen-
tile, S. Watson, F. F. Awwadi, M. M. Turnbull, S. E.
Dissanayake, H. Agrawal, R. Toft-Petersen, B. Klemke,
K. Coester, K. P. Schmidt, and D. A. Tennant, Higgs
amplitude mode in a two-dimensional quantum anti-
ferromagnet near the quantum critical point, Nature
Physics 13, 638 (2017).
[383] T. Ying, K. P. Schmidt, and S. Wessel, Higgs Mode of
Planar Coupled Spin Ladders and its Observation in
C9H18N2CuBr4, Phys. Rev. Lett. 122, 127201 (2019).
[384] F. Englert and R. Brout, Broken Symmetry and the
Mass of Gauge Vector Mesons, Phys. Rev. Lett. 13, 321
(1964).
[385] P. W. Higgs, Broken symmetries, massless particles and
gauge ﬁelds, Physics Letters 12, 132 (1964).
[386] P. W. Higgs, Broken Symmetries and the Masses of
Gauge Bosons, Phys. Rev. Lett. 13, 508 (1964).

62
[387] G. S. Guralnik, C. R. Hagen, and T. W. B. Kibble,
Global Conservation Laws and Massless Particles, Phys.
Rev. Lett. 13, 585 (1964).
[388] H. J. Schulz, Eﬀective action for strongly correlated
fermions from functional integrals, Phys. Rev. Lett. 65,
2462 (1990).
[389] Z. Y. Weng, C. S. Ting, and T. K. Lee, Path-integral
approach to the Hubbard model, Phys. Rev. B 43, 3790
(1991).
[390] N. Dupuis and S. Pairault, A Strong-coupling Expan-
sion for the Hubbard Model, International Journal of
Modern Physics B 14, 2529 (2000).
[391] N. Dupuis, A new approach to strongly correlated
fermion systems: the spin–particle–hole coherent-state
path integral, Nuclear Physics B 618, 617 (2001).
[392] S. Sachdev, Quantum magnetism and criticality, Nature
Physics 4, 173 (2008).
[393] A. Thomson and S. Sachdev, Fermionic Spinon The-
ory of Square Lattice Spin Liquids near the Néel State,
Phys. Rev. X 8, 011012 (2018).
[394] M. S. Scheurer, S. Chatterjee, W. Wu, M. Ferrero,
A. Georges, and S. Sachdev, Topological order in the
pseudogap metal, Proceedings of the National Academy
of Sciences 115, E3665 (2018).
[395] W. Wu, M. S. Scheurer, S. Chatterjee, S. Sachdev,
A. Georges, and M. Ferrero, Pseudogap and Fermi-
Surface Topology in the Two-Dimensional Hubbard
Model, Phys. Rev. X 8, 021048 (2018).
[396] S. Gazit, F. F. Assaad, and S. Sachdev, Fermi Sur-
face Reconstruction without Symmetry Breaking, Phys.
Rev. X 10, 041057 (2020).
[397] J. Jaeckel and C. Wetterich, Flow equations without
mean ﬁeld ambiguity, Phys. Rev. D 68, 025020 (2003).
[398] T. Baier, E. Bick, and C. Wetterich, Temperature de-
pendence of antiferromagnetic order in the Hubbard
model, Phys. Rev. B 70, 125111 (2004).
[399] J. Jaeckel, Understanding the Fierz Ambiguity of Par-
tially Bosonized Theories (2002), arXiv:hep-ph/0205154
[hep-ph].
[400] E. A. Stepanov, S. Brener, F. Krien, M. Harland, A. I.
Lichtenstein, and M. I. Katsnelson, Eﬀective Heisenberg
Model and Exchange Interaction for Strongly Corre-
lated Systems, Phys. Rev. Lett. 121, 037204 (2018).
[401] E. A. Stepanov, S. Brener, V. Harkov, M. I. Katsnel-
son, and A. I. Lichtenstein, Spin dynamics of itinerant
electrons: Local magnetic moment formation and Berry
phase, Phys. Rev. B 105, 155151 (2022).
[402] Y. A. Bychkov and E. I. Rashba, Properties of a 2D
electron gas with lifted spectral degeneracy, JETP Lett.
39, 78 (1984), [Pis’ma Zh. Eksp. Teor. Fiz. 39, 66-69
(1984)].
[403] T. Yildirim, A. B. Harris, A. Aharony, and O. Entin-
Wohlman, Anisotropic spin Hamiltonians due to spin-
orbit and Coulomb exchange interactions, Phys. Rev. B
52, 10239 (1995).
[404] A. N. Rubtsov, V. V. Savkin, and A. I. Lichten-
stein, Continuous-time quantum Monte Carlo method
for fermions, Phys. Rev. B 72, 035122 (2005).
[405] P. Werner, A. Comanac, L. de’ Medici, M. Troyer, and
A. J. Millis, Continuous-Time Solver for Quantum Im-
purity Models, Phys. Rev. Lett. 97, 076405 (2006).
[406] P. Werner and A. J. Millis, Dynamical Screening in
Correlated Electron Materials, Phys. Rev. Lett. 104,
146401 (2010).
[407] E. Gull, A. J. Millis, A. I. Lichtenstein, A. N. Rubtsov,
M. Troyer, and P. Werner, Continuous-time Monte
Carlo methods for quantum impurity models, Rev. Mod.
Phys. 83, 349 (2011).
[408] G. Li, Hidden physics in the dual-fermion approach: A
special case of a nonlocal expansion scheme, Phys. Rev.
B 91, 165134 (2015).
[409] S. Brener, E. A. Stepanov, A. N. Rubtsov, M. I. Katsnel-
son, and A. I. Lichtenstein, Dual fermion method as a
prototype of generic reference-system approach for cor-
related fermions, Annals of Physics 422, 168310 (2020).
[410] A. N. Rubtsov, M. I. Katsnelson, and A. I. Lichtenstein,
Dual fermion approach to nonlocal correlations in the
Hubbard model, Phys. Rev. B 77, 033101 (2008).
[411] A. N. Rubtsov, M. I. Katsnelson, A. I. Lichtenstein,
and A. Georges, Dual fermion approach to the two-
dimensional Hubbard model: Antiferromagnetic ﬂuctu-
ations and Fermi arcs, Phys. Rev. B 79, 045133 (2009).
[412] H. Hafermann, G. Li, A. N. Rubtsov, M. I. Katsnelson,
A. I. Lichtenstein, and H. Monien, Eﬃcient Perturba-
tion Theory for Quantum Lattice Models, Phys. Rev.
Lett. 102, 206401 (2009).
[413] A. N. Rubtsov, M. I. Katsnelson, and A. I. Lichtenstein,
Dual boson approach to collective excitations in corre-
lated fermionic systems, Annals of Physics 327, 1320
(2012).
[414] E. G. C. P. van Loon, A. I. Lichtenstein, M. I. Katsnel-
son, O. Parcollet, and H. Hafermann, Beyond extended
dynamical mean-ﬁeld theory: Dual boson approach to
the two-dimensional extended Hubbard model, Phys.
Rev. B 90, 235135 (2014).
[415] E. A. Stepanov, E. G. C. P. van Loon, A. A. Katanin,
A. I. Lichtenstein, M. I. Katsnelson, and A. N. Rubtsov,
Self-consistent dual boson approach to single-particle
and collective excitations in correlated systems, Phys.
Rev. B 93, 045107 (2016).
[416] E. A. Stepanov, A. Huber, E. G. C. P. van Loon, A. I.
Lichtenstein, and M. I. Katsnelson, From local to non-
local correlations: The Dual Boson perspective, Phys.
Rev. B 94, 205110 (2016).
[417] L. Peters, E. G. C. P. van Loon, A. N. Rubtsov, A. I.
Lichtenstein, M. I. Katsnelson, and E. A. Stepanov,
Dual boson approach with instantaneous interaction,
Phys. Rev. B 100, 165128 (2019).
[418] R. L. Stratonovich, On a method of calculating quantum
distribution functions, in Soviet Physics Doklady, Vol. 2
(1957) p. 416.
[419] J. Hubbard, Calculation of Partition Functions, Phys.
Rev. Lett. 3, 77 (1959).
[420] E. A. Stepanov, V. Harkov, and A. I. Lichtenstein, Con-
sistent partial bosonization of the extended Hubbard
model, Phys. Rev. B 100, 205115 (2019).
[421] V. Harkov, M. Vandelli, S. Brener, A. I. Lichtenstein,
and E. A. Stepanov, Impact of partially bosonized col-
lective ﬂuctuations on electronic degrees of freedom,
Phys. Rev. B 103, 245123 (2021).
[422] M. Vandelli, J. Kaufmann, M. El-Nabulsi, V. Harkov,
A. I. Lichtenstein, and E. A. Stepanov, Multi-band
D-TRILEX approach to materials with strong electronic
correlations (2022), arXiv:2204.06426 [cond-mat.str-el].
[423] S. Iskakov, A. E. Antipov, and E. Gull, Diagrammatic
Monte Carlo for dual fermions, Phys. Rev. B 94, 035102
(2016).
[424] J. Gukelberger, E. Kozik, and H. Hafermann, Dia-

63
grammatic Monte Carlo approach for diagrammatic ex-
tensions of dynamical mean-ﬁeld theory: Convergence
analysis of the dual fermion technique, Phys. Rev. B 96,
035152 (2017).
[425] M. Vandelli, V. Harkov, E. A. Stepanov, J. Gukelberger,
E. Kozik, A. Rubio, and A. I. Lichtenstein, Dual bo-
son diagrammatic Monte Carlo approach applied to the
extended Hubbard model, Phys. Rev. B 102, 195109
(2020).
[426] S. Iskakov, H. Terletska, and E. Gull, Momentum-space
cluster dual-fermion method, Phys. Rev. B 97, 125114
(2018).
[427] T. Schäfer, N. Wentzell, F. Šimkovic, Y.-Y. He, C. Hille,
M. Klett, C. J. Eckhardt, B. Arzhang, V. Harkov,
F.-M. Le Régent, A. Kirsch, Y. Wang, A. J. Kim,
E. Kozik, E. A. Stepanov, A. Kauch, S. Andergassen,
P. Hansmann, D. Rohe, Y. M. Vilk, J. P. F. LeBlanc,
S. Zhang, A.-M. S. Tremblay, M. Ferrero, O. Parcol-
let, and A. Georges, Tracking the Footprints of Spin
Fluctuations: A MultiMethod, MultiMessenger Study
of the Two-Dimensional Hubbard Model, Phys. Rev. X
11, 011058 (2021).
[428] E. A. Stepanov, A. Huber, A. I. Lichtenstein, and M. I.
Katsnelson, Eﬀective Ising model for correlated systems
with charge ordering, Phys. Rev. B 99, 115124 (2019).
[429] J. K. Pachos and M. B. Plenio, Three-Spin Interactions
in Optical Lattices and Criticality in Cluster Hamilto-
nians, Phys. Rev. Lett. 93, 056402 (2004).
[430] B. Bauer, L. Cincio, B. P. Keller, M. Dolﬁ, G. Vidal,
S. Trebst, and A. W. Ludwig, Chiral spin liquid and
emergent anyons in a Kagome lattice Mott insulator,
Nature communications 5, 1 (2014).
[431] S. A. Owerre, Topological thermal Hall eﬀect in frus-
trated kagome antiferromagnets, Phys. Rev. B 95,
014422 (2017).
[432] S. Grytsiuk, J.-P. Hanke, M. Hoﬀmann, J. Bouaziz,
O. Gomonay, G. Bihlmayer, S. Lounis, Y. Mokrousov,
and S. Blügel, Topological–chiral magnetic interactions
driven by emergent orbital magnetism, Nature commu-
nications 11, 1 (2020).
[433] L.-c. Zhang, D. Go, J.-P. Hanke, P. M. Buhl, S. Gryt-
siuk, S. Blügel, F. R. Lux, and Y. Mokrousov, Im-
printing and driving electronic orbital magnetism using
magnons, Communications Physics 3, 1 (2020).
[434] O. M. Sotnikov, V. V. Mazurenko, J. Colbois, F. Mila,
M. I. Katsnelson, and E. A. Stepanov, Probing the
topology of the quantum analog of a classical skyrmion,
Phys. Rev. B 103, L060404 (2021).
[435] M.
Sato,
Four-spin-exchange-
and
magnetic-ﬁeld-
induced chiral order in two-leg spin ladders, Phys. Rev.
B 76, 054427 (2007).
[436] S. Heinze, K. Von Bergmann, M. Menzel, J. Brede,
A. Kubetzka, R. Wiesendanger, G. Bihlmayer, and
S. Blügel, Spontaneous atomic-scale magnetic skyrmion
lattice in two dimensions, Nature Physics 7, 713 (2011).
[437] S. Paul, S. Haldar, S. von Malottki, and S. Heinze, Role
of higher-order exchange interactions for skyrmion sta-
bility, Nature communications 11, 1 (2020).
[438] T. Moriya, Spin ﬂuctuations in itinerant electron mag-
netism, Vol. 56 (Springer Science & Business Media,
2012).
[439] R. Cardias, A. Bergman, A. Szilva, Y. O. Kvash-
nin, J. Fransson, A. B. Klautau, O. Eriksson, and
L. Nordström, Dzyaloshinskii-Moriya interaction in ab-
sence of spin-orbit coupling (2020), arXiv:2003.04680
[cond-mat.mtrl-sci].
[440] A. Secchi, A. I. Lichtenstein, and M. I. Katsnelson, Spin
and orbital exchange interactions from Dynamical Mean
Field Theory, J. Magn. Magn. Mater. 400, 112 (2016).
[441] P. A. Igoshev, A. V. Efremov, and A. A. Katanin,
Magnetic exchange in α-iron from ab initio calculations
in the paramagnetic phase, Phys. Rev. B 91, 195123
(2015).
[442] J. Otsuki, K. Yoshimi, H. Shinaoka, and Y. Nomura,
Strong-coupling formula for momentum-dependent sus-
ceptibilities in dynamical mean-ﬁeld theory, Phys. Rev.
B 99, 165134 (2019).
[443] C. Watzenböck, M. Edelmann, D. Springer, G. Sangio-
vanni, and A. Toschi, Characteristic Timescales of the
Local Moment Dynamics in Hund’s Metals, Phys. Rev.
Lett. 125, 086402 (2020).
[444] P. Hansmann, R. Arita, A. Toschi, S. Sakai, G. San-
giovanni, and K. Held, Dichotomy between Large Local
and Small Ordered Magnetic Moments in Iron-Based
Superconductors, Phys. Rev. Lett. 104, 197002 (2010).
[445] A. Toschi, R. Arita, P. Hansmann, G. Sangiovanni, and
K. Held, Quantum dynamical screening of the local
magnetic moment in Fe-based superconductors, Phys.
Rev. B 86, 064411 (2012).
[446] L. D. Landau and E. M. Lifshitz, Statistical Physics
(Pergamon, Oxford, 1980).
[447] A. C. Hewson, The Kondo Problem to Heavy Fermions
(Cambridge University Press, Cambridge, 1993).
[448] P. Chalupa, T. Schäfer, M. Reitner, D. Springer, S. An-
dergassen, and A. Toschi, Fingerprints of the Local Mo-
ment Formation and its Kondo Screening in the Gen-
eralized Susceptibilities of Many-Electron Problems,
Phys. Rev. Lett. 126, 056403 (2021).
[449] J. C. Slater, Magnetic Eﬀects and the Hartree-Fock
Equation, Phys. Rev. 82, 538 (1951).
[450] G. Rohringer and A. Toschi, Impact of nonlocal corre-
lations over diﬀerent energy scales: A dynamical vertex
approximation study, Phys. Rev. B 94, 125144 (2016).
[451] D. Hirschmeier, H. Hafermann, E. Gull, A. I. Licht-
enstein, and A. E. Antipov, Mechanisms of ﬁnite-
temperature magnetism in the three-dimensional Hub-
bard model, Phys. Rev. B 92, 144409 (2015).
[452] M. Harland, S. Brener, A. I. Lichtenstein, and M. I.
Katsnelson, Josephson lattice model for phase ﬂuctu-
ations of local pairs in copper oxide superconductors,
Phys. Rev. B 100, 024510 (2019).
[453] A. A. Abrikosov, Fundamentals of the Theory of Metals
(North Holland, 1988).
[454] A. I. Lichtenstein and M. I. Katsnelson, Antiferromag-
netism and d-wave superconductivity in cuprates:
A
cluster dynamical mean-ﬁeld theory, Phys. Rev. B 62,
R9283 (2000).
[455] E. J. W. Verwey and P. W. Haayman, Electronic
conductivity and transition point of magnetite Fe3O4,
Physica 8, 979 (1941).
[456] E. J. W. Verwey, P. W. Haayman, and F. C. Romeijn,
Physical Properties and Cation Arrangement of Oxides
with Spinel Structures II. Electronic Conductivity, The
Journal of Chemical Physics 15, 181 (1947).
[457] N. F. Mott, Metal-insulator transitions (London: Taylor
& Francis, 1974).
[458] U. Staub, M. Shi, C. Schulze-Briese, B. D. Patterson,
F. Fauth, E. Dooryhee, L. Soderholm, J. O. Cross,

64
D. Mannix, and A. Ochiai, Temperature dependence of
the crystal structure and charge ordering in Yb4As3,
Phys. Rev. B 71, 075115 (2005).
[459] P. Fulde, B. Schmidt, and P. Thalmeier, Theoretical
Model for the Semi-Metal Yb4As3, EPL (Europhysics
Letters) 31, 323 (1995).
[460] T. Goto and B. Lüthi, Charge ordering, charge ﬂuctu-
ations and lattice eﬀects in strongly correlated electron
systems, Advances in Physics 52, 67 (2003).
[461] C. J. Arguello, S. P. Chockalingam, E. P. Rosenthal,
L. Zhao, C. Gutiérrez, J. H. Kang, W. C. Chung, R. M.
Fernandes, S. Jia, A. J. Millis, R. J. Cava, and A. N.
Pasupathy, Visualizing the charge density wave transi-
tion in 2H-NbSe2 in real space, Phys. Rev. B 89, 235115
(2014).
[462] T. Ritschel, J. Trinckauf, K. Koepernik, B. Büchner,
M. v. Zimmermann, H. Berger, Y. I. Joe, P. Abbamonte,
and J. Geck, Orbital textures and charge density waves
in transition metal dichalcogenides, Nature physics 11,
328 (2015).
[463] M. M. Ugeda, A. J. Bradley, Y. Zhang, S. Onishi,
Y. Chen, W. Ruan, C. Ojeda-Aristizabal, H. Ryu,
M. T. Edmonds, H.-Z. Tsai, A. Riss, S.-K. Mo, D. Lee,
A. Zettl, Z. Hussain, Z.-X. Shen, and M. F. Crommie,
Characterization of collective ground states in single-
layer NbSe2, Nature Physics 12, 92 (2016).
[464] T. Furuno, K. Ando, S. Kunii, A. Ochiai, H. Suzuki,
M. Fujioka, T. Suzuki, W. Sasaki, and T. Kasuya, Physi-
cal properties of Sm3Se4 at low temperatures, Journal of
Magnetism and Magnetic Materials 76-77, 117 (1988).
[465] V. Y. Irkhin and M. I. Katsnelson, RVB-type states
in systems with charge and spin degrees of freedom:
Sm3Se4, Y1−xScxMn2 etc., Physics Letters A 150, 47
(1990).
[466] P. Wachter, Physics of Eu3S4 and Sm3S4, Philosophical
Magazine B 42, 497 (1980).
[467] C. Schlenker and M. Marezio, The order–disorder tran-
sition of Ti3+-Ti3+ pairs in Ti4O7 and (Ti1−xVx)4O7,
Philosophical Magazine B 42, 453 (1980).
[468] B. K. Chakraverty, Charge ordering in Fe3O4, Ti4O7
and bipolarons, Philosophical Magazine B 42, 473
(1980).
[469] Eyert, V. and Schwingenschlögl, U. and Eckern, U.,
Charge order, orbital order, and electron localization
in the Magnéli phase Ti4O7, Chemical Physics Letters
390, 151 (2004).
[470] I. Leonov, A. N. Yaresko, V. N. Antonov, U. Schwingen-
schlögl, V. Eyert, and V. I. Anisimov, Charge order and
spin-singlet pair formation in Ti4O7, Journal of Physics:
Condensed Matter 18, 10955 (2006).
[471] J. Dumas, C. Schlenker, and R. Buder, The vanadium
bronzes NaxV2O5-β, Philosophical Magazine B 42, 485
(1980).
[472] M. Schüler, M. Rösner, T. O. Wehling, A. I. Lichten-
stein, and M. I. Katsnelson, Optimal Hubbard Mod-
els for Materials with Nonlocal Coulomb Interactions:
Graphene, Silicene, and Benzene, Phys. Rev. Lett. 111,
036601 (2013).
[473] E. G. C. P. van Loon, M. Schüler, M. I. Katsnelson, and
T. O. Wehling, Capturing nonlocal interaction eﬀects in
the Hubbard model: Optimal mappings and limits of
applicability, Phys. Rev. B 94, 165141 (2016).
[474] E. Berger, P. Valášek, and W. von der Linden, Two-
dimensional Hubbard-Holstein model, Phys. Rev. B 52,
4806 (1995).
[475] G.
Sangiovanni,
M.
Capone,
C.
Castellani,
and
M. Grilli, Electron-Phonon Interaction Close to a Mott
Transition, Phys. Rev. Lett. 94, 026401 (2005).
[476] P. Werner and A. J. Millis, Eﬃcient Dynamical Mean
Field Simulation of the Holstein-Hubbard Model, Phys.
Rev. Lett. 99, 146404 (2007).
[477] M. Hohenadler, F. Parisen Toldin, I. F. Herbut, and
F. F. Assaad, Phase diagram of the Kane-Mele-Coulomb
model, Phys. Rev. B 90, 085146 (2014).
[478] W. Wu and A.-M. S. Tremblay, Phase diagram and
Fermi liquid properties of the extended Hubbard model
on the honeycomb lattice, Phys. Rev. B 89, 205128
(2014).
[479] P. Buividovich, D. Smith, M. Ulybyshev, and L. von
Smekal, Competing order in the fermionic Hubbard
model on the hexagonal graphene lattice, in Proceed-
ings of 34th annual International Symposium on Lattice
Field Theory — PoS(LATTICE2016), Vol. 256 (2017)
p. 244.
[480] T. Ayral, S. Biermann, and P. Werner, Screening and
nonlocal correlations in the extended Hubbard model
from self-consistent combined GW and dynamical mean
ﬁeld theory, Phys. Rev. B 87, 125149 (2013).
[481] T. Ayral, S. Biermann, P. Werner, and L. Boehnke, In-
ﬂuence of Fock exchange in combined many-body per-
turbation and dynamical mean ﬁeld theory, Phys. Rev.
B 95, 245130 (2017).
[482] H. Terletska, T. Chen, and E. Gull, Charge ordering
and correlation eﬀects in the extended Hubbard model,
Phys. Rev. B 95, 115149 (2017).
[483] H. Terletska, T. Chen, J. Paki, and E. Gull, Charge or-
dering and nonlocal correlations in the doped extended
Hubbard model, Phys. Rev. B 97, 115117 (2018).
[484] J. Paki, H. Terletska, S. Iskakov, and E. Gull, Charge
order and antiferromagnetism in the extended Hubbard
model, Phys. Rev. B 99, 245146 (2019).
[485] E. G. C. P. van Loon, M. Rösner, G. Schönhoﬀ, M. I.
Katsnelson, and T. O. Wehling, Competing Coulomb
and electron-phonon interactions in NbS2, npj Quantum
Mater. 3, 1 (2018).
[486] E. A. Stepanov, V. Harkov, M. Rösner, A. I. Lichten-
stein, M. I. Katsnelson, and A. N. Rudenko, Coexisting
charge density wave and ferromagnetic instabilities in
monolayer InSe, npj Comput. Mater. 8, 118 (2022).
[487] P. A. Korzhavyi, A. V. Ruban, J. Odqvist, J.-O. Nils-
son, and B. Johansson, Electronic structure and eﬀec-
tive chemical and magnetic exchange interactions in bcc
Fe-Cr alloys, Phys. Rev. B 79, 054202 (2009).
[488] M. Ekholm, H. Zapolsky, A. V. Ruban, I. Vernyhora,
D. Ledue, and I. A. Abrikosov, Inﬂuence of the Mag-
netic State on the Chemical Order-Disorder Transition
Temperature in Fe-Ni Permalloy, Phys. Rev. Lett. 105,
167208 (2010).
[489] B. Alling, A. V. Ruban, A. Karimi, L. Hultman, and
I. A. Abrikosov, Uniﬁed cluster expansion method ap-
plied to the conﬁgurational thermodynamics of cubic
Ti1−xAlxN, Phys. Rev. B 83, 104203 (2011).
[490] J. W. D. Connolly and A. R. Williams, Density-
functional theory applied to phase transformations in
transition-metal alloys, Phys. Rev. B 27, 5169 (1983).
[491] M. Hennion, Chemical SRO eﬀects in ferromagnetic Fe
alloys in relation to electronic band structure, Journal
of Physics F: Metal Physics 13, 2351 (1983).

65
[492] F. Ducastelle and F. Ducastelle, Order and phase sta-
bility in alloys (North-Holland Amsterdam, 1991).
[493] A. V. Ruban and I. A. Abrikosov, Conﬁgurational ther-
modynamics of alloys from ﬁrst principles:
eﬀective
cluster interactions, Reports on Progress in Physics 71,
046501 (2008).
[494] F. Gautier, F. Ducastelle, and J. Giner, Ordering and
segregation processes in transition metal alloys in re-
lation to their electronic structures, The Philosophical
Magazine: A Journal of Theoretical Experimental and
Applied Physics 31, 1373 (1975).
[495] F. Gautier, J. van der Rest, and F. Brouers, Energy of
formation, band structure and local environment eﬀects
in transitional binary alloys, Journal of Physics F: Metal
Physics 5, 1884 (1975).
[496] J. Giner, J. van der Rest, F. Brouers, and F. Gau-
tier, Charge transfer and ordering energy in a model
binary alloy, Journal of Physics F: Metal Physics 6, 1281
(1976).
[497] G. Treglia, F. Ducastelle, and F. Gautier, Generalised
perturbation theory in disordered transition metal al-
loys: application to the self-consistent calculation of or-
dering energies, Journal of Physics F: Metal Physics 8,
1437 (1978).
[498] F. Ducastelle and G. Treglia, Thermodynamic deriva-
tion of the coherent potential approximation and order-
ing processes in transition alloys, Journal of Physics F:
Metal Physics 10, 2137 (1980).
[499] A. Gonis, X. G. Zhang, A. J. Freeman, P. Turchi, G. M.
Stocks, and D. M. Nicholson, Conﬁgurational energies
and eﬀective cluster interactions in substitutionally dis-
ordered binary alloys, Phys. Rev. B 36, 4630 (1987).
[500] R. Monnier, First-principles approaches to surface seg-
regation, Philosophical Magazine B 75, 67 (1997).
[501] A. V. Ruban, S. I. Simak, P. A. Korzhavyi, and H. L.
Skriver, Screened Coulomb interactions in metallic al-
loys. II. Screening beyond the single-site and atomic-
sphere approximations, Phys. Rev. B 66, 024202 (2002).
[502] A. R. Mackintosh and O. K. Andersen, Electrons at the
Fermi surface (Cambridge Univ. Press, London, 1980)
p. 149.
[503] M. Poluektov, O. Eriksson, and G. Kreiss, Scale tran-
sitions in magnetisation dynamics, Communications in
Computational Physics 20, 969 (2016).
[504] M. Poluektov, O. Eriksson, and G. Kreiss, Coupling
atomistic and continuum modelling of magnetism, Com-
puter Methods in Applied Mechanics and Engineering
329, 219 (2018).
[505] R. F. L. Evans, U. Atxitia, and R. W. Chantrell, Quan-
titative simulation of temperature-dependent magneti-
zation dynamics and equilibrium properties of elemental
ferromagnets, Phys. Rev. B 91, 144425 (2015).
[506] M. Pereiro, D. Yudin, J. Chico, C. Etz, O. Eriksson,
and A. Bergman, Topological excitations in a kagome
magnet, Nature communications 5, 1 (2014).
[507] S. Mankovsky, S. Polesya, H. Lange, M. Weißenhofer,
U. Nowak, and H. Ebert, Angular momentum transfer
via relativistic spin-lattice coupling from ﬁrst principles,
arXiv preprint arXiv:2203.16144 (2022).
[508] P. Santini and G. Amoretti, Magnetic-Octupole Or-
der in Neptunium Dioxide?, Phys. Rev. Lett. 85, 2188
(2000).
[509] R. Cardias, A. Szilva, M. Bezerra-Neto, M. Ribeiro,
A. Bergman, Y. O. Kvashnin, J. Fransson, A. Klau-
tau, O. Eriksson, and L. Nordström, First-principles
dzyaloshinskii–moriya interaction in a non-collinear
framework, Scientiﬁc Reports 10, 1 (2020).
[510] M. dos Santos Dias, S. Brinker, A. Lászlóﬀy, B. Nyári,
S. Blügel, L. Szunyogh, and S. Lounis, Proper and im-
proper chiral magnetic interactions, Phys. Rev. B 103,
L140408 (2021).
[511] R. Cardias,
A. Szilva,
A. Bergman,
Y. Kvashnin,
J. Fransson, S. Streib, A. Delin, M. I. Katsnelson,
D. Thonig, A. B. Klautau, O. Eriksson, and L. Nord-
ström, Comment on “Proper and improper chiral mag-
netic interactions”, Phys. Rev. B 105, 026401 (2022).
[512] M. dos Santos Dias, S. Brinker, A. Lászlóﬀy, B. Nyári,
S. Blügel, L. Szunyogh, and S. Lounis, Reply to “Com-
ment on ‘Proper and improper chiral magnetic interac-
tions’ ”, Phys. Rev. B 105, 026402 (2022).
[513] S.
Streib,
R.
Cardias,
M.
Pereiro,
A.
Bergman,
E. Sjöqvist, C. Barreteau, A. Delin, O. Eriksson, and
D. Thonig, Adiabatic spin dynamics and eﬀective ex-
change interactions from constrained tight-binding elec-
tronic structure theory: beyond the Heisenberg regime,
arXiv preprint arXiv:2203.11759 (2022).
[514] M. Roger, J. H. Hetherington, and J. M. Delrieu, Mag-
netism in solid 3Helium, Rev. Mod. Phys. 55, 1 (1983).
[515] D. M. Ceperley, Path integrals in the theory of con-
densed helium, Rev. Mod. Phys. 67, 279 (1995).
[516] H. Fukuyama, Nuclear magnetism in two-dimensional
solid helium three on graphite, J. Phys. Soc. Japan 77,
111013 (2008).
[517] E. Ising, Contribution to the theory of ferromagnetism,
Z. Phys 31, 253 (1925).
[518] P. Cliﬀord and A. Sudbury, A model for spatial conﬂict,
Biometrika 60, 581 (1973).
[519] R. A. Holley and T. M. Liggett, Ergodic theorems for
weakly interacting inﬁnite systems and the voter model,
The annals of probability , 643 (1975).
[520] J. P. Gleeson, Binary-State Dynamics on Complex Net-
works: Pair Approximation and Beyond, Phys. Rev. X
3, 021004 (2013).
[521] I. F. Mello, L. Squillante, G. O. Gomes, A. C. Serido-
nio, and M. de Souza, Epidemics, the Ising-model and
percolation theory: A comprehensive review focused on
Covid-19, Physica A: Statistical Mechanics and its Ap-
plications 573, 125963 (2021).
[522] M. Mézard, G. Parisi, and M. A. Virasoro, Spin glass
theory and beyond:
An Introduction to the Replica
Method and Its Applications, Vol. 9 (World Scientiﬁc
Publishing Company, 1987).
[523] S. Thurner, R. Hanel, and P. Klimek, Introduction to
the theory of complex systems (Oxford University Press,
2018).
[524] P. W. Anderson, More is diﬀerent, Science 177, 393
(1972).
[525] A. Principi and M. I. Katsnelson, Self-Induced Glassi-
ness and Pattern Formation in Spin Systems Subject to
Long-Range Interactions, Phys. Rev. Lett. 117, 137201
(2016).
[526] A. A. Bagrov, I. A. Iakovlev, A. A. Iliasov, M. I. Kat-
snelson, and V. V. Mazurenko, Multiscale structural
complexity of natural patterns, Proceedings of the Na-
tional Academy of Sciences 117, 30241 (2020).
[527] C. Castellano, S. Fortunato, and V. Loreto, Statistical
physics of social dynamics, Rev. Mod. Phys. 81, 591
(2009).

66
[528] Y. I. Wolf, M. I. Katsnelson, and E. V. Koonin, Physical
foundations of biological complexity, Proceedings of the
National Academy of Sciences 115, E8678 (2018).
[529] M. Baity-Jesi, L. Sagun, M. Geiger, S. Spigler, G. B.
Arous, C. Cammarota, Y. LeCun, M. Wyart, and
G. Biroli, Comparing dynamics: Deep neural networks
versus glassy systems, in International Conference on
Machine Learning (PMLR, 2018) pp. 314–323.

