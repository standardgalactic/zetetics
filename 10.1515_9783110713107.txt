Dynamic Measuring Systems

De Gruyter Series in
Measurement Sciences
౩
Edited by
Klaus-Dieter Sommer and Thomas Fröhlich

Dynamic
Measuring
Systems
౩
Fundamentals and application of time-dependent
measurements
Edited by
Sascha Eichstädt

Editor
Dr. Sascha Eichstädt
Physikalisch-Technische Bundesanstalt
2-12 Abbestr.
10587 Charlottenburg Berlin
Germany
bibliothek@ptb.de
ISBN 978-3-11-071303-9
e-ISBN (PDF) 978-3-11-071310-7
e-ISBN (EPUB) 978-3-11-071313-8
ISSN 2510-2974
Library of Congress Control Number: 2023940867
Bibliographic information published by the Deutsche Nationalbibliothek
The Deutsche Nationalbibliothek lists this publication in the Deutsche Nationalbibliografie;
detailed bibliographic data are available on the Internet at http://dnb.dnb.de.
© 2024 Walter de Gruyter GmbH, Berlin/Boston
Cover image: Wassily and the World of Metrology, Susanna Beyer, llmenau, Deutschland Aus der Sammlung:
Measurement lmpressions (Privatbesitz)
Typesetting: VTeX UAB, Lithuania
Printing and binding: CPI books GmbH, Leck
www.degruyter.com

Foreword
The De Gruyter Book Series in Measurement Science (DGSMS) includes monographs rang-
ing from the mathematical foundations of metrology, the link between metrology and
information theory, and dynamic measurements to recent developments such as quan-
tum sensing and cognitive sensors and measurement systems.
The present volume “Dynamic Measuring Systems,” which has been produced
under the leadership of the internationally renowned metrologists Sascha Eichstaedt
(Physikalisch-Technische Bundes-anstalt, Germany), is one of the first monographs in the
DGSMS. The other planned volumes of the book series will be available within a period
of 24 months after the publication of this volume.
Analysis and correct consideration of the time and frequency dependence of sen-
sors and measurement processes is one of the fundamental tasks and scientific areas
of metrology and practical measurement. Classical application areas of the theory of
measurement dynamics are energy and communications engineering. In recent years,
dynamic measurement systems have gained new importance; on the one hand, due
to the modern calculation of measurement uncertainty and, on the other hand—very
topically—the strongly networked digital measurement and information systems. More-
over, comparability between discrete and analogues sensors must be analyzed and eval-
uated. Without consideration and synchronization of the individual dynamic charac-
teristics, the networked digital systems would not work successfully, and metrological
traceability could hardly be derived.
The authors and the volume editor focus this monograph on the modeling and state
space description of dynamic measurement systems and signals and the propagation
of measurement uncertainties that can be derived from them. With the help of numer-
ous practical examples from metrology, this succeeds extraordinarily clearly. The link
to the classical literature on dynamic measurement systems is successfully established
in Chapter “Traceable calibration for the dynamic measurement of mechanical quanti-
ties,” which deals with the dynamics of mechanical measurands, and in Chapter “Trace-
able measurements with dynamically calibrated hydrophones,” which deals with ultra-
sound measurements. The step into the digital modern age or the IoT related metrol-
ogy takes place in Chapter “Dynamic measurement analysis and the internet of things,”
which deals with the dynamics of cognitive systems and digital metrological twins.
The consistently chosen structure of the book starting with the fundamentals of dy-
namic measurement analysis, the modeling of dynamic measurements and uncertainty
propagation, calibration examples up to current developments in the digitalization of
metrology make the book an important companion and reference work for all metrolo-
gists worldwide.
This book should be at least as important for university teaching in metrology and
information technology as for their industrial application.
https://doi.org/10.1515/9783110713107-201

VI
౪
Foreword
We firmly believe that this book will become a standard work in metrology. We
congratulate the editor and the authors on a successful and highly topical monograph
and wish it a wide readership.
Klaus-Dieter Sommer
Technische Universitaet Ilmenau (Germany)
Editor of the DG Book Series in Measurement Science
Frank Haertig
Vice President of the Physikalisch-Technische Bundesanstalt (Germany)
President of the International Measurement Federation (IMEKO)

Editorial
S. Eichstädt
The analysis and study of measuring systems in scenarios with time-dependent mea-
surements dates back at least to the 19th century. Since then several technological and
scientific developments and breakthroughs have been accomplished. These develop-
ments have changed the way measurements are performed, analyzed and used in sci-
ence, technology and society. For instance, with the use of computing technologies and
low-cost measuring devices, the acquisition of time series measurement data has be-
come common practice. However, in metrology—the science of measurement—the anal-
ysis of dynamic measuring systems has not been addressed substantially until the early
21st century.
First historical examples of dynamic measurements include the study of the mo-
tion of a galvanometer by A. Cornu [1], the modeling and analysis of an oscilloscope
by A. Blondel [2] or the investigations of oscillating laboratory balances by D. I. Mende-
leev [3]. In these and other early scientific developments, some elementary aspects of
dynamic measurements were addressed. For instance, A. N. Krylov [4] considered an
expression for estimating the measurement error as a function of time. Later in the
20th century, N. Wiener [5] considered stochastic processes, which can also be applied to
model time-dependent measurement errors. In the middle of the 20th century, Kalman
[6] established the analysis, modeling and optimal treatment of dynamic measuring sys-
tems, taking random variations into account. The Kalman filter is used until today in
various applications and modifications. With the increasing use of digital measuring
systems, the application of digital signal processing has become common practice in
most areas of engineering and a whole new scientific field was established. Metrology
for dynamic measuring systems is mostly based on signal processing, system theory and
time-series analysis as can be seen in Chapters “Fundamentals of dynamic measurement
analysis for LTI systems” and “Modeling dynamic measurements in metrology and prop-
agation of uncertainties.”
The range of application areas and examples of dynamic measurements have
greatly expanded over the course of the 20th century. Chapter “Traceable calibration
for the dynamic measurement of mechanical quantities” gives an introduction to state-
of-the-art methods relevant to the traceable dynamic measurement of mechanical quan-
tities. In Chapter “Traceable measurements with dynamically calibrated hydrophones,”
the area of ultrasound measurements with hydrophones is considered. Figure 1 shows
an example setup for the dynamic calibration of hydrophones. Such measuring in-
struments are used, for instance, for the characterization and assessment of medical
ultrasound devices.
The recent developments in industry, science and society, e. g., due to the digital
transformation, also affect the view on dynamic measuring systems. For instance, the
https://doi.org/10.1515/9783110713107-202

VIII
౪
Editorial
Figure 1: Setup for the calibration of hydrophones for ultrasound measurements [7]. For the measure-
ment, a short ultrasound pulse is used. The ultrasonic signal is reflected at the water surface resulting in a
displacement, which is related to the particle velocity of an ultrasonic wave propagating inside the water.
The laser vibrometer measures the velocity of the surface, which is shown at the right diagram. From the
surface velocity, the ultrasonic pressure inside the water can be calculated and this information is used to
calibrate hydrophones in a second step by exposing the hydrophone to the same ultrasonic signal.
development of Industry 4.0 as an interconnected production environment, is based on
the increasing use of monitoring measurements in the production process and by the
effective use of measurement information. These measurements are dynamic by nature,
and thus the importance of dynamic measurements in the development of Industry 4.0
technologies is increasing; see also Chapter “Dynamic measurement analysis and the
internet of things.”
A further effect of the digital transformation is the rapid increase in the number of
sensors in place and the increasing use of sensor networks. This makes it relevant to cal-
ibrate sensors on site. Such an in situ calibration is particularly challenging for dynamic
calibration as it requires properly designed sensor excitations and a reliable time base.
Some early approaches to this end are proposed in the literature, but no widely used
standards and guidelines are available yet.
The technologies and solutions for these future challenges will largely be based on
methods and infrastructure for dynamic measuring systems. For instance, the authors in
[8] propose the extension of an existing setup for the dynamic calibration of accelerom-
eters such that it can be used for the calibration of digital sensors. In [9], methods for
the analysis of dynamic measurements are applied for industrial sensor networks. Thus,
the core concepts of metrology for dynamic measuring systems are the basis for the ap-
plication of metrology in Industry 4.0, Smart Cities and many more.
This book intends to provide an introduction and practical guidance for metrol-
ogists toward the use and further development of methodologies in dealing with dy-

Editorial
౪
IX
namic measuring systems. Chapter “Fundamentals of dynamic measurement analysis
for LTI systems” gives an introduction to the basic vocabulary and the method toolbox
required. Chapter “Modeling dynamic measurements in metrology and propagation
of uncertainties” outlines the state-of-the-art in uncertainty evaluation for dynamic
measuring systems. Chapters “Traceable calibration for the dynamic measurement
of mechanical quantities” and “Traceable measurements with dynamically calibrated
hydrophones” provide practical examples of the dynamic calibration for metrological
traceability of dynamic measurements. Finally, Chapter “Dynamic measurement analy-
sis and the internet of things” outlines the use of dynamic measurement methodologies
for applications in the (industrial) internet of things (IIoT).

X
౪
Editorial
Bibliography
[1] A. Cornu. Sur la condition de stabilite du movement d’un systeme oscilant soumis a une liaison
synchrinique pendulaire. C. R. Acad. Sci., 104(22):1463–1470, 1887.
[2] A. Blondel. Oscillographes, nouveaux apparelis pour l’etude des oscillations electriques lentes.
C. R. Acad. Sci., 116(10):502–506, 1893.
[3] D. I. Mendeleev. About methods of precise or metrological weighing. Papers on metrology, VNIIM
Standart gid, pages 67–164, 1936.
[4] A. N. Krylov. Some notes about crushers and indicators. Izvestia S. Peterburg, Sboi A. N., pages 623–655,
1909.
[5] N. Wiener. Extrapolation, Interpolation, and Smoothing of Stationary Time Series. Technology press of MIT
and Wiley, New York, 1949.
[6] R. E. Kalman. A new approach to linear filtering and prediction problems. J. Basic Eng., 82:35–45, 1960.
[7] M. Weber and V. Wilkens. A comparison of different calibration techniques for hydrophones used in
medical ultrasonic field measurement. IEEE Trans. Ultrason. Ferroelectr. Freq. Control, 68:1919–1929, 2021.
[8] B. Seeger and Th. Bruns. Primary calibration of mechanical sensors with digital output for dynamic
applications. ACTA IMEKO, 10(3):177–184, 2021.
[9] M. Gruber, T. Dorst, A. Schütze, S. Eichstädt, and C. Elster. Discrete wavelet transform on uncertain data:
Efficient online implementation for practical applications. In Advanced Mathematical and Computational
Tools in Metrology and Testing XII, volume 90 of Series on Advances in Mathematics for Applied Sciences,
pages 249–261, World Scientific, 2021.

Acknowledgment
We would like to express our sincere gratitude to Anupam Prasad Vedurmudi for his in-
valuable contribution to the manuscript. Anupam Prasad Vedurmudi’s exceptional skills
in proofreading and correcting the text have significantly improved the quality and clar-
ity of this scientific book. His attention to detail and meticulous approach to editing have
made a significant impact on the final product. We appreciate his dedication and com-
mitment to this project, and we are grateful for his time and effort in helping us to refine
and improve our work.
https://doi.org/10.1515/9783110713107-203


Contents
Foreword ౩V
Editorial ౩VII
Acknowledgment ౩XI
List of Contributing Authors ౩XV
S. Eichstädt and M. Gruber
Fundamentals of dynamic measurement analysis for LTI systems ౩1
M. Gruber, S. Eichstädt, and C. Elster
Modeling dynamic measurements in metrology and propagation of
uncertainties ౩35
Th. Bruns, L. Klaus, and M. Kobusch
Traceable calibration for the dynamic measurement of mechanical quantities ౩73
V. Wilkens and M. Weber
Traceable measurements with dynamically calibrated hydrophones ౩99
S. Eichstädt
Dynamic measurement analysis and the internet of things ౩117
Index ౩127


List of Contributing Authors
Th. Bruns
Physikalisch-Technische Bundesanstalt (PTB)
100 Bundesallee
38116 Braunschweig
Germany
E-mail: thomas.bruns@ptb.de
S. Eichstädt
Physikalisch-Technische Bundesanstalt
Metrology for Digital Transformation
2-12 Abbestraße
10587 Berlin
Germany
E-mail: sascha.eichstaedt@ptb.de
C. Elster
Physikalisch-Technische Bundesanstalt
Data Analysis and Measurement Uncertainty
2-12 Abbestraße
10587 Berlin
Germany
E-mail: clemens.elster@ptb.de
M. Gruber
Physikalisch-Technische Bundesanstalt
Metrology for Digital Transformation
2-12 Abbestraße
10587 Berlin
Germany
E-mail: maximilian.gruber@ptb.de
L. Klaus
Physikalisch-Technische Bundesanstalt (PTB)
100 Bundesallee
38116 Braunschweig
Germany
E-mail: leonard.klaus@ptb.de
M. Kobusch
Physikalisch-Technische Bundesanstalt (PTB)
100 Bundesallee
38116 Braunschweig
Germany
E-mail: michael.kobusch@ptb.de
M. Weber
University of Helsinki
Department of Physics
2 Gustaf Hällströmin katu
FIN-00014 Helsinki
Finland
E-mail: martin.weber@helsinki.fi
V. Wilkens
Physikalisch-Technische Bundesanstalt
Ultrasonics Working Group 1.62
100 Bundesallee
38116 Braunschweig
Germany
E-mail: volker.wilkens@ptb.de


S. Eichstädt and M. Gruber
Fundamentals of dynamic measurement
analysis for LTI systems
This chapter introduces the fundamental principles, vocabulary, and mathematics for
the analysis of dynamic measurements. We focus on linear time-invariant (LTI) systems,
which are most often used in metrology to model the characteristics of a measuring sys-
tem used in a dynamic measurement. Furthermore, we focus on principles and notation
used in the later chapters. There is a large amount of literature on system and signal the-
ory, system identification, and related topics for further reading. Thus, this chapter only
introduces basic elements and refers to other sources for the interested reader.
1 Fundamental principles and vocabulary
The analysis of time-dependent measurements has a long history. It combines elements
from several disciplines and application areas. The basic mathematical approaches orig-
inate from the area of analysis (in particular differential equation theory), and system
and signal theory. This section introduces some of the basic terms used in this and the
following chapters.
A quantity for which the value changes over time in a significant way is called dy-
namic quantity. For instance, the velocity of an accelerating vehicle measured by an ac-
celerometer has a time-dependent value v(t). The term signal is then typically used for
the measured value of a quantity, when that value depends on some independent quan-
tity such as time. Note that signals can also be multivariate and may depend on space,
frequency, or other independent quantities instead of time. For simplicity and ease of
notation, we here focus on time-dependent signals, also because the term “dynamic” is
usually associated with variations in time. Multivariate signals are denoted as x(t), uni-
variate signals as x(t). An example for a multivariate time-dependent signal is an object
moving in three-dimensional space, thus x(t) denoting the position in space at time t.
The term system denotes the (mathematical) model of a (measurement) process. The
mathematical model describes the relation between the signals that enter the system
(input signals) and the signals that leave the system (output signals). For instance, an
ordinary differential equation (ODE) may describe the signal y(t) that is indicated by an
accelerometer depending on the excitation a(t),
y(2)(t) + by(1)(t) + cy(t) = ρa(t),
(1)
where the exponent y(k)(t) denotes the kth derivative w. r. t. time. In this example, the
process is the measurement of a time-dependent acceleration with an accelerometer.
https://doi.org/10.1515/9783110713107-001

2
౪
S. Eichstädt and M. Gruber
The ODE (1) is the mathematical model for this measurement process. The acceleration
a(t) is the input signal and the sensor signal y(t) is the output signal; b and c are the
system model parameters. A system that contains differential equations to model the
measurement process is called a dynamic measuring system and the corresponding pro-
cess a dynamic measurement. The quantity of interest in this setting is called the dynamic
measurand.
The ODE description (1) allows to model the dynamic behavior and dynamic proper-
ties of the measuring instrument in the measurement process considered as the relation
between excitation and response, i. e., between input and output signal. The dynamic be-
havior of a measuring instrument differs from static behavior in that it depends on the
frequency content of the excitation. Examples for characteristic elements of dynamic
behavior are ringing (due to a resonance frequency), attenuation of high-frequency, or
low-frequency components or a time delay between output and input signal; see Fig-
ure 1 for an example. It is worth noting that we often refer to the measuring system as
“sensor,” even though we refer to the instrument as a whole. Hence, when we refer to
“sensor input signal,” “sensor output signal,” “sensor behavior,” and so on, we always
mean the measuring instrument. In cases where we actually refer to the sensing ele-
ment, we indicate this directly.
Figure 1: Example of input and output signal to an accelerometer, modeled by the ODE equation (1).
Algebraic equations such as y(t) = ρa(t) + γ cannot describe dynamic behavior, be-
cause the relation between input and output signal does not allow to model frequency-
dependent characteristics. Hence, if the measurement process can be described using
algebraic equations only, then this system is called a static measuring system and the
corresponding measurement process a static measurement. This distinction is not as
strict as it may appear at first glance. A static system could be considered a dynamic
system in a steady state. Thus, in principle any system can be described using differ-
ential equations. In fact, the whole mathematical theory for the analysis of dynamic

Fundamentals of dynamic measurement analysis for LTI systems
౪
3
systems applies to the steady state, too. The differential equations then reduce to alge-
braic equations. For this reason, static systems (i. e., measurement processes that do not
require modeling of dynamic behavior) are modeled using algebraic equations from the
start. For example, the same accelerometer could be applied in a dynamic measurement
or a static measurement. In principle, in both cases an ODE model could be applied as
a mathematical model. However, in practice the static measurement is described using
algebraic equations as the one above for simplicity.
Measurement processes are typically continuous in time, i. e., measurements are
carried out continuously instead of at discrete points in time. The signals are then repre-
sented by continuous functions of time x(t) and are often referred to as analog signals.
On the other hand, when measurements are considered at separate, discrete time in-
stances, the signals are represented by discrete functions of time x[tn], with tn a specific
time instant. These are also referred to as digital signals. For ease of presentation, the
function x[tn] is usually denoted as x[n]. In practice, the analysis of a measurement is
carried out using computer systems and software. This software usually requires dis-
crete time signals to work with. Therefore, continuous-time signals are converted from
analog (continuous time) to digital (discrete time)—also called AD conversion or ADC.
An increasing number of measuring instruments provide discrete-time (digital) signals
as output only. Such devices have an internal AD conversion, translating the continuous
signal into discrete-time output signals.
The measurement of a dynamic quantity with a properly calibrated measuring in-
strument, followed by a proper derivation of the measurement result (estimate of the
measurand’s value with associated uncertainty) is called a traceable dynamic measure-
ment. Traceability here refers to the possibility of tracing the unit of measurement back
to the international system of units (SI) via an unbroken chain of calibrations. Hence,
when considering metrology for dynamic measurements, sometimes referred to as dy-
namic metrology, one has to address the association of measurement uncertainty with
signals and systems. In Chapter 2, a detailed introduction to this topic is given. Here,
we briefly outline the basic terminology and general concepts. We distinguish between
the uncertainty associated with a measuring instrument (system) and the uncertainty
associated with a dynamic measurand (signal).
The uncertainty associated with a measuring instrument is related to a certain rep-
resentation form (system) and the corresponding system parameters. That is, let the vec-
tor θ of parameters encode the dynamic system for a certain dynamic model. Then the
uncertainty denoted by Uθ associated with this vector of parameters models the avail-
able knowledge about the values that can reasonably be attributed to the parameters.
Hence, the dynamic uncertainty of a measuring system is the uncertainty associated
with its parameters, determined from a calibration. This is no different to a static mea-
surement. Similarly, the uncertainty Ux associated with a discrete-time dynamic mea-
surand, i. e., a signal, is given as x = (x[t0], x[t1], . . . , x[tN]) and encodes the knowledge
about the values that can reasonably be attributed to x.

4
౪
S. Eichstädt and M. Gruber
Sometimes the term dynamic uncertainty is used to refer to the component of an un-
certainty budget that originates from an uncompensated dynamic behavior of the mea-
suring system. This interpretation is related to the notion of naming uncertainty budget
components in accordance with their origin or cause. However, it is not recommended
to use dynamic uncertainty for this component, because it can easily be confused with
the uncertainty associated with a dynamic measurand. Instead, one may use dynamic
uncertainty component or dynamic error. In Section 6, an introduction to the concept of
the dynamic error is given.
2 Characteristics of continuous-time measurements
Continuous, time-invariant dynamic systems are naturally described by linear differen-
tial equations (ODE) with constant coefficients:
any(n)(t) + an−1y(n−1)(t) + ⋅⋅⋅+ a1y(1)(t) + a0y(t)
(2)
= bmx(m)(t) + b(m−1)x(m−1)(t) + ⋅⋅⋅+ b1x(1)(t) + b0x(t)
(3)
where x(t) is the input signal of the measuring system; y(t) is the corresponding output
signal; an, an−1, . . . , a0 and bm, bm−1, . . . , b0 are constant coefficients. The exponent y(k)(t)
denotes the kth derivative of y(t) w. r. t. time t. The coefficients of the ODE are constant,
i. e., time-invariant. Hence, the system described by the ODE does not change over the
time period considered. The system is also linear in its inputs. That is, for two different
input signals x1(t) and x2(t) with corresponding output signals y1(t) and y2(t), it holds
ℋ{αx1(t) + βx2(t)} = αℋ{x1(t)} + βℋ{x2(t)} = αy1(t) + βy2(t),
(4)
where ℋdenotes the system acting on its inputs. Such systems are called linear, time-
invariant (LTI).
The above differential equation is one possible representation of an LTI system.
Other possibilities are
–
step response function
–
impulse response function
–
frequency response function
–
transfer function
All the aforementioned representations are equivalent to each other. That is, for the
calibration of dynamic measuring system with LTI characteristics, any of these charac-
terizations can be considered. It is worth noting here that any calibration that results in
the identification of one of these representations is called a dynamic calibration. In the
following, we briefly describe these different representations and their relation to each

Fundamentals of dynamic measurement analysis for LTI systems
౪
5
other. We focus on aspects of relevance for the later chapters in this book. For further
information on LTI system theory, we refer interested readers, for instance, to [1, 2].
When studying an LTI system by means of calibration experiments, the frequency
range covered by the excitation signal (i. e., the input signal) is of great importance. Sig-
nals with slow variations only cover a narrow range of frequencies. Thus, these signals
can only characterize the measuring system in a narrow range of frequencies. For the
theoretical basis of the step response and the impulse response, one therefore consid-
ers ideal signals of infinitely fast variations. Hence, theoretically when considered as
input signals to the measuring system, these signals fully characterize the LTI system.
For the step response of an LTI system, we consider the ideal unit step function as input
signal
x(t) = {0
t < 0
1
else.
(5)
The output signal y(t) = s(t) of the measurement system is called the unit step re-
sponse. The ideal step signal x(t) in this definition changes instantaneously from 0 to 1.
Mathematically speaking, this instantaneous change corresponds to an infinitely high
speed of variations. Thus, the ideal step signal covers the whole frequency range, and
the ideal step response fully characterizes the dynamic properties of the measuring
system. Figure 2 shows an example for a step response of a dynamic system. The sys-
tem output shows a clear overshoot and damped ringing—typical characteristics of
a second-order system. The step response representation is often used in the calibra-
tion of dynamic measuring systems. The input step is realized, for instance, by a fast
opening valve [3, 4], a breaking membrane [4, 5] other means of a quickly changing
excitation, which remains basically constant for a sufficiently long time period after-
wards. In these experiments, the excitation is usually not an ideal unit step, because
of the practical infeasability of generating a signal with an instantaneous step change.
Thus, a measurement or other type of knowledge of the excitation signal is required for
a calibration; see, for example, [5].
If the input signal x(t) is the Dirac delta function,
x(t) = δ(t −t0) {∞
t = t0,
0
t
̸= t0
(6)
with
∞
∫
−∞
x(t)dt = 1
(7)
then the output signal y(t) = h(t) is called the impulse response of the dynamic sys-
tem. An example of an impulse response function is shown in Figure 3. Similar to the

6
౪
S. Eichstädt and M. Gruber
Figure 2: Unit step response of a dynamic system.
Figure 3: Impulse response of a dynamic system.
step response, the impulse response representation is often used in calibrations. For in-
stance, when calibrating an oscilloscope, as electrical input signal to the device under
test a narrow pulse signal can be used, which is close to the ideal impulse response;
see, for example, [6]. However, as in the case of the unit step function, the ideal im-
pulse response cannot be achieved in practice due to physical and experimental con-
straints.
The impulse response is of particular theoretical importance for LTI systems, be-
cause it allows to model the system response to arbitrary excitations in a simple math-
ematical form. Consider, for instance, an arbitrary signal x(t) as input of the measuring
system with y(t) the corresponding output. We split the input signal into elementary im-
pulses of infinitesimal width dτ. Then the impulse at time τk with area x(τk)dτ creates
a component of the output signal as
x(τk)dτk ⋅h(t −τk).
(8)

Fundamentals of dynamic measurement analysis for LTI systems
౪
7
With the integration of the responses from all elementary impulses, the output signal of
the dynamic measuring system will thus take the form
y(t) =
t
∫
0
x(τ)h(t −τ)dτ.
(9)
The integral on the right-hand side of equation (9) is referred to as convolution of the
system’s impulse response and the system input signal. Thus, it represents the input–
output relation of the dynamic measurement system modeled by equations (2)–(3) using
the system’s impulse response.
Another representation form can be created in the frequency domain. To this end,
we utilize the Fourier transform as a way to decompose the signal x(t) into its frequency
components. The Fourier transform has been applied in various versions to analyze,
represent, and work with signals and processes [7]. The Fourier transform of the input
signal x(t) (under suitable conditions) is given as follows:
X(jω) =
∞
∫
−∞
x(t)e−jωtdt,
(10)
where j = √−1 and ω = 2πf is the radial frequency. The Fourier transform X(jω) deter-
mines the spectrum of the signal x(t). The characteristics for ω = 0 are considered static
components whereas all others are considered as dynamic components of x(t). The in-
verse Fourier transform allows us to determine the temporal realization of a signal x(t)
from its Fourier transform X(jω) as
x(t) = 1
2π
∞
∫
−∞
X(jω)ejωtdω.
(11)
For instance, with the application of the Fourier transform to the unit step signal one
can derive the corresponding Fourier transform as
X(jω) = 1
jω.
(12)
Thus, the spectral components of the unit step response decay with increasing fre-
quency.
The Fourier transform of the δ-impulse takes the form
X(jω) = 1.
(13)
Thus, the spectral components of the impulse are the same for all frequencies. The
Fourier transform of the convolution (9) equation is given by

8
౪
S. Eichstädt and M. Gruber
Y(jω) = X(jω)H(jω)
(14)
with H(jω) the Fourier transform of the impulse response h(t). Thus, the convolution in
the time domain is equivalent to a multiplication in the frequency domain. This property
is used for the calibration of a dynamic system in the frequency domain, because it is
equivalent to the calibration of the impulse response in the time domain. The Fourier
transform H(jω) is also called the system’s frequency response. This representation type
is also used to visualize the so-called transfer behavior of a system.
A consequence of the LTI property is also that the output signal y(t) for a harmonic
input
x(t) = Am sin(ωt)
(15)
is given by
y(t) = Bm sin(ωt + φ(ω)),
(16)
with ϖ(ω) the phase change caused by the LTI system. Hence, only the amplitude and
phase of the signal are changed by the system. This property is exploited in the calibra-
tion of dynamic measuring systems by using a harmonic excitation. This usually allows
to characterize the frequency response of the system with high precision at frequency
ω. However, in this way only one frequency at a time is excited. That is, to calibrate
the system’s frequency response, one typically applies sinusoidal excitation at a certain
number of frequencies and then a parametric function of the frequency response is
fitted to the obtained magnitude and phase values. Another possibility is the use of a
multisinusoidal excitation, for which a sum of sinusoidal functions with different fre-
quencies is applied. See Chapter 3 for more details and for an example of a sinusoidal
excitation. Instead of a sinusoidal excitation, which excites the system at a controlled set
of frequencies, excitations with a broad spectral content are used for calibration, too. An
example is given in Chapter 4.
Another consequence of the Fourier transform of equation (9) is that (under appro-
priate conditions) equation (14) can be reformulated as
Y(jω)
X(jω) = H(jω) = 󵄨󵄨󵄨󵄨H(jω)󵄨󵄨󵄨󵄨ejφ(ω).
(17)
Hence, the Fourier transform H(jω) of the system’s impulse response h(t) is the quotient
of the Fourier transform of the input and output signal. This property is also used in the
calibration of the system’s frequency response; see Chapter 4.
Figure 4 shows a typical example of a frequency response. The magnitude |H(jω)|
of the frequency response shows a peak at frequency 20 kHz, which is characteristic
for a resonance and that frequency is thus called the resonance frequency. For higher

Fundamentals of dynamic measurement analysis for LTI systems
౪
9
Figure 4: Example of a typical magnitude and phase response of a dynamic system.
frequencies, the magnitude response decays monotonically. This is also characteristic
for physical dynamic measuring systems.
An often applied parameter to characterize the ability of a dynamic system to cor-
rectly measure a signal is the system’s bandwidth. The bandwidth is usually taken as the
frequency ωb such that signals with frequency range up to ωb are not significantly dis-
torted by the system. For instance, for a dynamic system with monotonically decaying
frequency response the 3 dB bandwidth is determined such that
󵄨󵄨󵄨󵄨H(jω)󵄨󵄨󵄨󵄨≤0.7 ⋅󵄨󵄨󵄨󵄨H(0)󵄨󵄨󵄨󵄨
∀ω ∈[0, ωb].
(18)
Note that the choice of ωb and the specification of bandwidth are usually specified based
on requirements of the applications for which the measuring instrument is to be applied.
The frequency response of an LTI system provides many valuable insights about the
dynamic behavior of the measuring device. More insights can be obtained by consider-
ing the Laplace transform, which can be introduced as follows. Introducing the complex
variable s = σ + jω, one obtains the Laplace transform of the signal x(t) as
X(s) =
∞
∫
0
x(t)e−stdt.
(19)
Let us denote the application of the Laplace transform as ℒ{x(t)} = X(s) in the following.
The Laplace transform has the property that, applied to the derivative x′(t), it is
given as
ℒ{x′(t)} = s ⋅X(s).
(20)
Correspondingly, the Laplace transform of the nth derivative with zero initial conditions
for all (n −1) derivatives of x(t) has the form
ℒ{x(n)} = snX(s).
(21)

10
౪
S. Eichstädt and M. Gruber
Thus, application of the Laplace transform to equations (2)–(3) results in
ansnY(s) + an−1sn−1Y(s) + ⋅⋅⋅+ a1sY(s) + a0Y(s)
(22)
= bmsmX(s) + b(m−1)sm−1X(s) + ⋅⋅⋅+ b1sX(s) + b0X(s).
(23)
This equation can easily be transformed to the ratio
H(s) = Y(s)
X(s) = bmsm + bm−1sm−1 + ⋅⋅⋅b1s + b0
ansn + an−1sn−1 + ⋅⋅⋅+ a1s + a0
,
(24)
which is called the system’s transfer function. Similar to the frequency response func-
tion, it models the input–output relation of the system. The dynamic properties of the
system in terms of its transfer function are determined by the location of the roots of
the numerator and denominator polynomials—its zeros and poles. That is, the poles λi
of the transfer function are the roots of the denominator polynomial (22), and the ze-
ros γj are the roots of the numerator polynomial (23). When all poles are located in the
left half-plane of the complex domain, the system is said to be stable [1]. Complex con-
jugated poles λi and λ∗
i determine the corresponding exponential component of the so-
lution to the differential equation (2)–(3). Therefore, the further these poles are located
away from the imaginary axis, the faster this exponential component decays, which in
turn expresses the system’s performance in terms of stability. The closer the zeros γj
and γ∗
j of the measuring system are to the poles, the more these zeros compensate the
transient process. In the limiting case, when γj = λi, the transient process, determined
by the poles λi and λ∗
i , is fully compensated and this part of the dynamic system behaves
like a static system.
In signal processing and system theory, these characteristics of the system, de-
scribed by the zeros and poles of its transfer function, are often used to design an LTI
system. That is, the sought characteristics of the system are expressed by locating poles
and zeros in the complex plane and these yield the corresponding transfer function.
3 Time domain characterization of discrete-time
measurements
A measuring instrument is usually developed based on certain physical principles. Ex-
amples are the piezo-electric effect or strain gauges. The dynamic behavior of the sens-
ing element is thus modeled using differential equations and is based on the theory of
continuous-time dynamic systems. In a discrete-time (i. e., digital) system, the sensing
element is still a continuous system, but for the analysis is considered in a discrete-time
representation.

Fundamentals of dynamic measurement analysis for LTI systems
౪
11
One possibility for such a discrete-time representation can be derived from directly
from the differential equation
y(n)(t) + an−1y(n−1)(t) + ⋅⋅⋅+ a1y(1)(t) + a0y(t) = b0x(t).
(25)
To obtain the corresponding discrete-time difference equation, we transform the nth
order ODE into a system of first-order ODEs in the form of a so-called state-space sys-
tem [1].1 Let us introduce the variables
z1(t) = y(t);
z2(t) = dz1
dt (t);
. . . ;
zn(t) = dzn−1
dt
(t).
(26)
We define the state vector as z(t) = [z1(t), z2(t), . . . , zn(t)]T. Then equation (25) can be
written in matrix-vector form
dz
dt (t) = Az(t) + Bx(t),
(27)
where
A =
[[[[[[
[
0
1
0
⋅⋅⋅
0
0
0
1
⋅⋅⋅
0
. . .
. . .
. . .
⋅⋅⋅
. . .
0
0
0
⋅⋅⋅
1
−a0
−a1
−a2
⋅⋅⋅
−an−1
]]]]]]
]
B =
[[[[[[
[
0
0
. . .
0
b0
]]]]]]
]
(28)
The sensor output signal is then modeled as
y(t) = Cz(t),
(29)
where C = [1, 0, 0, . . . , 0].
For given initial conditions z(t0), the state vector is defined as
z(t) = X(t, t0)z(t0) +
t
∫
t0
X(t, τ)Bx(τ)dτ,
(30)
where X(t, τ) is the system transition matrix of states, which for a system of differential
equations with constant coefficients has the form [8],
X(t, τ) = eA(t−τ).
(31)
Setting t0 = nT and t = (n + 1)T in equation (30) with T as the sampling period length,
we obtain
1 A more detailed introduction to state-space systems for dynamic measurements is given in Chapter 2.

12
౪
S. Eichstädt and M. Gruber
z[(n + 1)T] = eATz[nT] +
(n+1)T
∫
nT
eA((n+1)T−τ)Bx(τ)dτ.
(32)
In this way, equation (32) describes how the continuous-time input signal x(t) is trans-
lated into a discrete-time output signal. Note that the state-space model describes the
sensing element and the subsequent AD conversion as one system for ease of presenta-
tion. In practice, the effect of the ADC may be modeled by a separate system to account
for additional effects and to maintain a certain degree of model modularity. It is also
worth noting that the same derivation as above can be carried out for the complete ODE
(2)–(3).
4 Spectral characterization of discrete-time
measurements
In the previous section, we considered a digital measuring system using a continuous-
time model function. In this way, the internal sensing element (e. g., the sensor itself)
can be modeled based on physical arguments and the corresponding differential equa-
tions. In some cases, though, it is easier to start with a discrete-time representation of
the system. In analogy with the continuous-time case, the Laplace transform provides a
possible starting point. Its discrete form is given by [9],
X(q) =
∞
∑
n=0
x[n]e−qn
(33)
where q = σ + jω is a complex variable similar to the variable s for the continuous
Laplace transform, and ω = ΩT is the relative frequency associated with the absolute
angular frequency Ω = 2πf for T the sampling interval length. The function X(q) is called
the Laplace image or forward Laplace and x[n] is the inverse of the given image or the
inverse Laplace.
The Laplace transform of the unit step function has the form
ℒ{1[n]} =
∞
∑
n=0
1[n]e−qn =
1
1 −e−q =
eq
eq −1
(34)
It can be seen from equation (34) that a discrete Laplace image is always a function of eq,
which significantly complicates its form in comparison with the continuous Laplace
transform. To this end, the related z-transform is used, which is obtained from the
Laplace transform by setting z = eq in the above formulas. Thereby, the z-transform has
the form
𝒵{u[n]} =
∞
∑
n=0
x[n]z−n
(35)

Fundamentals of dynamic measurement analysis for LTI systems
౪
13
The z-transform is used, for instance, when modeling digital filters; see also Chapter 2
and below.
Similarly, as for the impulse response and step response of a continuous-time sys-
tem, the Fourier transform can also be applied for discrete-time representations. Let
x[n] be a discrete function such that the series ∑∞
n=0 |x[n]| converges, i. e., ∑∞
n=0|x[n]| < M
for some real-valued M > 0. Then the discrete Fourier transform for x[n] is defined as
X(ω) =
∞
∑
n=−∞
x[n]e−jωn
(36)
where again ω = ΩT. The corresponding inverse Fourier transform is given by
x[n] = 1
2π
π
∫
−π
X(ω)ejωndω.
(37)
A special case is when x[n] = 0 for all n < 0:
X(ω) =
∞
∑
n=0
x[n]e−jωn
(38)
This is called the one-sided Fourier transform, which is a special case of the Laplace
transform when q = jω. Expressing equation (38) in terms of real and imaginary parts
X(ω) = ℛ(ω) + jℐ(ω) results in
ℛ(ω) =
∞
∑
n=0
x[n] cos(ωn)
(39)
ℐ(ω) =
∞
∑
n=0
x[n] sin(ωn)
(40)
Thus, the real part is an even function and the imaginary part is an odd function. There-
fore, the values of X(ω) corresponding to positive and negative values are complex con-
jugated
X(−ω) = X(ω).
(41)
With (39) and (40), it then follows that the discrete one-sided Fourier transform X(ω) is
a periodic function of ω with period 2π and is completely determined by its values for
ω ∈[0, π]. Noting that ω = 2πTf , with T the sampling period and f denoting frequency,
and with sampling frequency defined as Fs = 1/T, it follows that X(ω) = X(2πfT) is fully
determined for f ∈[0, Fs/2].
The relation between the Fourier transform X(ω) of x[n] and the Fourier transform
Xc(Ω) of the corresponding continuous-time x(t) is given by

14
౪
S. Eichstädt and M. Gruber
X(ω) = 1
T
∞
∑
r=−∞
Xc(ω
T + 2πr
T ).
(42)
Hence, the function X(ω) consists of periodic copies of the function Xc(Ω). With (39) and
(40), the same holds true for the real and imaginary parts. Let denote ω0 = 2πFs = 2π/T
the radial sampling frequency. Then equation (42) becomes
X(ω) = 1
T
∞
∑
r=−∞
Xc(ωFs + ω0r).
(43)
Thus, if Xc(Ω) has components beyond ω0/2, the Fourier transform X(ω) of the discrete-
time signal x[n] is distorted by the overlapping content between the periodic copies
of Xc(Ω). As a result, the spectral content of Xc(Ω) for higher frequencies is mapped
to lower-frequency components of the spectral content of X(ω). Conversely, it can also
be said that the sampling frequency Fs = 1/T for sampling the continuous-time signal
must be twice as large as the highest frequency (spectral) component of the continuous-
time signal in order to obtain a distortion-free discrete-time representation of it. This is
also known as the fundamental sampling theorem of signal processing and goes back to
Nyquist and others, and the frequency Fs/2 is also called the “Nyquist frequency.”
This relation can also be formulated as follows. Consider the continuous function
x(t) with Fourier transform X(ω). If |X(ω)| ≈0 for all |ω| > ωc, then x(t) can be ap-
proximately reconstructed from the discrete x[nT] provided that T ≤π/ωc. That is, the
discrete spectrum then contains all information about the continuous spectrum. The
accuracy of the reconstruction depends on how accurately the condition |X(ω)| ≈0 for
|ω| > ωc is met. In practice, these conditions are enforced by application of a low-pass
filter to the continuous-time signal before sampling. The low-pass filter attenuates all
frequency components that could result in a distorted discrete-time signal. Therefore, a
suitable cut-off frequency ωc has to be defined corresponding to the sampling frequency
and the low-pass filter characteristics in order to avoid distortions in the discretization
process. Such a low-pass filtering is also applied before downsampling a discrete-time
signal for the same reasons and is called antialiasing. The corresponding filter is then
called antialias filter [1].
5 Discretization of analog systems
There are several methods for the discretizing of an analog system. One is the method of
impulse invariance [1]. In principle, this method samples the continuous-time impulse
response such that
hd[n] = Thc(nT)
(44)
where the sampling period length T is used to scale the discrete-time impulse response
hd such that the frequency response Hd magnitude matches that of the continuous-time

Fundamentals of dynamic measurement analysis for LTI systems
౪
15
frequency response function Hc. In practice, however, the impulse invariance method is
not applied to the impulse response, but rather to an analog transfer function model [1].
By transforming the poles and zeros of the transfer function, a representation of the
discrete-time transfer function is obtained.
The bilinear transform is a discretization method that is also applied to the ana-
log transfer function. The discrete-time transfer function is obtained with the bilinear
transform by substituting s in the transfer function model by [1],
s = 2
T
z −1
z + 1
(45)
The bilinear transform is a highly nonlinear method where the positive imaginary axis
in the continuous s-domain is transformed into the upper-half unit circle in the z-domain
with z = esT. A result of the nonlinearity is a phenomenon known as “frequency warp-
ing” [1]. Some software packages allow the specification of a so-called “matched fre-
quency,” which is used to rescale the frequency values in a process called “prewarping.”
With this approach, the discrete-time system’s frequency responses matches that of the
analog system at the “matched frequency.”
As for all discretization methods, care has to be taken of the choice of the sampling
period length to avoid aliasing. Figure 5 shows a simulated example of a second-order
analog system, which is discretized using the method of impulse invariance (left-hand
side) and the bilinear transform (right-hand side).
Figure 5: Examples for the effect of aliasing when discretizing an analog representation of a dynamic sys-
tem. Left: using the method of impulse invariance. Right: using the bilinear transform.
For the smallest sampling period Ts = 1e −5, Figure 5 shows that the discrete-time
system cannot be distinguished from the analog one on this scale. For the larger sam-
pling period Ts = 1e−4, both discretization methods show a clear deviation between the
discrete and the analog system’s frequency response. It is worth noting, though, that the
result obtained from the impulse invariance method matches the resonance frequency
behavior better than the bilinear method. At the same time, the result obtained from the

16
౪
S. Eichstädt and M. Gruber
impulse invariance method shows a strong aliasing effect where the analog system’s fre-
quency response values beyond fs/2, with fs = 1/Ts, are mapped onto lower frequency
values in the discrete-time system’s frequency response. This effect becomes even more
visible for the smallest sampling period Ts = 5e −4 with the bilinear transform. Note
that some of the plots are not continued beyond a certain frequency, because this is their
sampling frequency limit, i. e., they are plotted for [0, fs/2] only.
6 Compensation of dynamic effects
In the analysis of dynamic measurements, it is often desired to compensate for cer-
tain unwanted behaviors of the measuring system that results from the time-dependent
properties of the measurand. For instance, the spectral content of the measurand may
have resulted in a ringing or a phase distortion in the system’s output signal. To this end,
the known properties of the measuring system can be utilized to compensate for these
effects. In general, an input signal x(t) to a measuring system with system model H(jω)
results in an output signal y(t) that differs significantly from x(t). In particular, the input
signal x(t) can usually not be reconstructed from y(t) using algebraic operations only. In-
stead, the design of a compensation system is typically carried out. Such a compensation
system is itself a dynamic system, because it has time-dependent inputs (the measuring
system output) and outputs (the estimate of the value of the measurand). That is, the
compensation system is applied to y(t) and calculates an estimate of x(t). This process
is also known as dynamic error correction or dynamic input estimation, because it im-
proves the quality of the signal estimate by reducing errors introduced by the dynamic
behavior of the measuring system. In general, the compensation (also known as decon-
volution [10]) is an ill-posed inverse problem. That is, small changes in the input of the
compensation system may result in disproportionally large changes in the compensa-
tion result. For instance, small (numerical) noise in y(t) may be amplified by the com-
pensation system such that the estimate of x(t) consists mainly of noise components; see
[11] for an example. To this end, a so-called regularization has to be carried out to ren-
der the ill-posed problem stable. Therefore, the compensation is often considered in two
steps: the design of an inverse dynamic system that compensates the dynamic effects of
the measuring system, and subsequently the design of a type of regularization.
6.1 Design of an inverse dynamic system
In general, a perfect inverse system with frequency response Hi(jω) has the property
that
1 = Hs(jω)Hi(jω),
(46)

Fundamentals of dynamic measurement analysis for LTI systems
౪
17
and hence
Hi(jω) =
1
Hs(jω).
(47)
Figure 6 shows the result in the frequency domain. Here, the resonance frequency of the
measuring system is perfectly compensated. Note that the magnitude of the spectrum
of the measuring system goes to zero asymptotically. Consequently, the amplitude spec-
trum of the ideal compensation filter goes to infinity for higher frequencies, because
of (47). Hence, the inverse system also compensates the high-frequency attenuation of
the measuring system. The inverse system (red curve in Figure 6) thus amplifies high-
frequency content. When applying this inverse system to the observed output signal
of the measuring system, it will thus amplify noise significantly. Even if we were to ig-
nore the noise amplification in y(t) when applying the inverse system, the condition
|Hi(jω)| →∞for ω →∞is not realizable in practice. To this end, one usually selects an
upper frequency limit ωc up to which condition (46) must be satisfied by the compensa-
tion system Hc(jω):
1 = Hs(jω)Hc(jω)
∀ω ∈[0, ωc].
(48)
Figure 6: Frequency characteristic of a measuring system, its ideal inverse and the regularized compensa-
tion result.
The interval [0, ωc] is then called the compensation bandwidth. The value of ωc must
match the spectral properties of x(t) in order to avoid systematic errors. At the same
time, ωc should be chosen such that noise is not amplified too much. This balancing is the
key task of regularization; see Section 6.2. The frequency response of the compensation
system can be used for the estimation of the input signal, i. e., the value of the dynamic

18
౪
S. Eichstädt and M. Gruber
measurand in the analysis of a dynamic measurement. A detailed example is given in
Chapter 4. As a short summary, this approach works as follows:
1.
The system’s output signal y is Fourier transformed to the frequency domain to ob-
tain Y.
2.
The compensation system’s frequency response Hc and Y are transformed to the
same set of frequencies, e. g., by interpolation or by adjusting the length of y before
the Fourier transform.
3.
The estimate of the input signal x is calculated in the frequency domain as ̂X = Hc⋅Y.
4.
The estimate ̂x of the input signal x is calculated by applying the inverse Fourier
transform to ̂X.
The evaluation of uncertainties for this approach is described in Chapter 2. A software
implementation for such an uncertainty evaluation is provided in the Python library
PyDynamic [12].
The frequency response of the ideal compensation system can also be used to design
a digital filter as an inverse filter or deconvolution filter. This digital filter is obtained by
fitting a chosen filter model to the frequency response of the ideal compensation system,
typically within the desired compensation bandwidth. The resulting filter is then applied
to the discrete-time output y[n] of the measuring system. The filter output signal is thus
a discrete-time estimate of x(t); see, for instance, [13] for a tutorial. Here, we briefly
outline the basic concepts for the design of a digital compensation filter. There are two
types of digital filters: finite impulse response (FIR) and infinite impulse response (IIR)
type systems. An FIR filter is described by its filter coefficients c = (c0, c1, . . . , cN)T in the
z-domain as
HFIR(z) =
N
∑
k=0
ckz−k.
(49)
Note that the filter coefficient vector c is also the discrete-time impulse response of the
system modeled by the FIR filter. Hence, an application of an FIR filter to a discrete-time
signal x[n] is given as
y[n] =
N
∑
k=0
ckx[n −k].
(50)
An IIR filter is described by in the z-domain as
HIIR(z) =
∞
∑
k=−∞
hkz−k.
(51)
In practice, IIR type filters are written in a recursive form using two vectors of filter
coefficients b = (b0, b1, . . . , bNb)T and a = (a0, a1, . . . , aNa)T in the z-domain as

Fundamentals of dynamic measurement analysis for LTI systems
౪
19
HIIR(z) =
∑Nb
k=0 bkz−k
∑Na
l=0 alz−l .
(52)
Hence, the application of an IIR filter to a discrete-time signal x[n] is given as
y[n] = 1
a0
(
Nb
∑
k=0
bkx[n −k] −
Na
∑
l=0
aly[n −l]),
(53)
which is usually simplified by normalizing the filter coefficients such that a0 = 1. After
choosing the filter type and order, the design of a digital compensation filter is carried
out as a regression problem, e. g., least-squares minimization. That is, the filter coef-
ficients are determined by solving an optimization problem such that the filter’s fre-
quency response corresponds to the reciprocal of the system’s frequency response. For
an FIR filter as digital compensation filter, this results in
min(̃H −̃Dc)T(̃H −̃Dc),
(54)
where
̃H = (ℛ(H−1
s (ω)), ℐ(H−1
s (ω)))
T
(55)
and ̃D = (ℛ(E), ℐ(E))T with
Ek,⋅= (1, e−jωkT, . . . , e−jωkNT).
(56)
In practice, a time delay of nd samples is added to the reciprocal of Hs(ω) before fitting
the filter coefficients to achieve a causal system and improve the quality of the fit. When
an IIR filter is used as digital compensation filter, the time delay also plays an important
role for stabilizing the resulting filter [14]. The evaluation of uncertainties for this ap-
proach is addressed in Chapter 2. The software PyDynamic can be applied for its easy
implementation [12].
Instead of the above described approach in the frequency domain, the inverse sys-
tem can also be designed in the Laplace domain. Let the system’s transfer function have
the form
Hs(s) = Y(s)
X(s) = bmsm + bm−1sm−1 + ⋅⋅⋅+ b1s + b0
ansn + an−1sn−1 + ⋅⋅⋅+ a1s + a0
.
(57)
Let λi, i = 1, . . . , n be the roots of the denominator polynomial and γj, j = 1, . . . , n the roots
of the numerator polynomial, i. e., λi the poles and γj the zeros of the transfer function.
The transfer function (57) can then also be written in pole-zero representation as
Hs(s) = Ks
(s −γ1)(s −γ2) . . . (s −γm)
(s −λ1)(s −λ2) . . . (s −λn)
(58)

20
౪
S. Eichstädt and M. Gruber
Consequently, the pole-zero representation of the ideal compensation system is given by
Hc(s) = Kc
(s −λ1)(s −λ2) . . . (s −λn)
(s −γ1)(s −γ2) . . . (s −γm).
(59)
Although mathematically feasible, this system is unrealizable in practice. First of all, for
real systems it holds that m ≤n, which results in more zeros than poles in the ideal
compensation system. Moreover, the system’s transfer function zeros γi located in the
right semi-half of the complex domain make the compensation system unstable as they
become its poles. Therefore, the actual compensation transfer function has to have the
form
Hc(s) = Kc
(s −λ1)(s −λ2) . . . (s −λn)
(s −μ1)(s −μ2) . . . (s −μn+r)
(60)
with r > 0 and all roots μk in the left semiplane. Note that the same holds true for
the z-transform as the discrete counterpart of the Laplace transform. That is, the actual
compensation transfer function in the z-domain has to have the form
Hc(z) = Kc
(z −̃λ1)(z −̃λ2) . . . (z −̃λp)
(z −̃μ1)(z −̃μ2) . . . (z −̃μq)
(61)
with q ≥p and all roots ̃μj located inside the unit circle in the complex domain. The con-
struction of the roots μj and ̃μj, respectively, is also known as stabilization. An approach
of stabilization in the z-domain is described, for instance, in [14].
To summarize the different approaches for the design of an inverse system, we con-
sider the following scenarios:
(I)
The system’s frequency response is given in terms of a complex-valued vector for
the whole frequency range (i. e., from 0 to Nyquist).
(II)
A parametric model of the system’s transfer function is given, either in the
s-domain or z-domain.
(III) The system’s impulse response is given in terms of a real-valued vector in the time
domain or as a parametric model.
(IV) The system’s step response is given in terms of a real-valued vector in the time
domain or as a parametric model.
Note that there are several other possible scenarios. However, the above are most typical
for practical dynamic metrology settings.
Figure 7 illustrates how for the above scenarios (I)–(IV) a representation of the in-
verse system can be obtained. For scenario (I), the inverse system’s frequency response
is calculated as the reciprocal of the measuring system’s frequency response. Here, it is
important that the frequency response values are given for the whole frequency range.
Otherwise the inverse system’s frequency response cannot be applied for input estima-
tion. If this is not the case—for instance due to limitations of the calibration setup—

Fundamentals of dynamic measurement analysis for LTI systems
౪
21
Figure 7: Example representation forms of the compensation system and their derivation from different
types of knowledge about the measuring system.
extrapolation can be considered; cf. Chapter 4. Another possibility is to fit a parametric
model of the frequency response, i. e., the s-domain or z-domain transfer function, to the
available system’s frequency response values. This is usually applied for dynamic cali-
bration with sinusoidal excitation; cf. Chapter 3. The result of the fit, e. g., by means of a
least-squares regression, leads to scenario (II). For scenario (II), the inverse system’s fre-
quency response can be calculated simply by evaluating the corresponding expression
at the respective frequency points. For scenario (III), one calculates the (discrete time)
Fourier transform of the impulse response to obtain scenario (I). For scenario (IV), one
calculates the numerical integration of the step response to obtain the corresponding
impulse response, and thus, scenario (III).
Hence, for all scenarios (I)–(IV) an essential step is the calculation of the inverse
system’s frequency response. This can be applied directly for input estimation as in
Chapter 4. Alternatively, one can fit an FIR or IIR filter model to the inverse system’s
frequency response to obtain the so-called “inverse filter” or “deconvolution filter”; cf.
Chapter 2. For further insights into the derivation of a digital deconvolution filter, we
refer the interested reader to [13].
For the optimal design of the inverse system’s parametric model, a suitable opti-
mization criterion has to be defined. This criterion should take into account the compen-
sation property (48) as well as the stability criterion for the resulting transfer function.
To this end, the compensation error can be employed. For instance, an upper bound for
the dynamic error can be derived as follows: Let the dynamic error in the discrete time
domain be written as
Δ[n] = ̂x[n] −x[n],
(62)
with ̂x[n] the discrete-time output of the compensation system Hc and Ts the sampling
interval length. Due to ̂x[n] = (hc ∗y)[n] with hc the impulse response of the compensa-
tion system, it follows with the definition of the inverse Fourier transform that

22
౪
S. Eichstädt and M. Gruber
Δ[n] = 1
2π
π
∫
−π
ejωn( ̂X(ω) −X(ω))dω
(63)
= 1
2π
π
∫
−π
ejωn(Hc(jω)Y(ω) −X(ω))dω,
(64)
where ω = ΩT = 2πfT, and hence Ω = ωFs.
From the relation between the discrete-time and the continuous-time Fourier trans-
form, it follows that
Y(ω) = 1
Ts
∞
∑
k=−∞
Hs(j(Ω + 2πkFs))Xc(Ω + 2πkFs)
(65)
with Fs = 1/T and Xc(Ω) the Fourier transform of x(t). Assuming that no aliasing is
present, i. e., Xc(Ω) = 0 for all Ω ≥πFs, this reduces to
Y(ω) = 1
T Hs(jΩ)Xc(Ω).
(66)
From this, an upper bound on Δ[n] can be derived as
󵄨󵄨󵄨󵄨Δ[n]󵄨󵄨󵄨󵄨=
1
2πT
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
π
∫
−π
ejωn(Hc(jω)Hs(jωFs) −1)Xc(ωFs)dω
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
(67)
≤
1
2πT
π
∫
−π
󵄨󵄨󵄨󵄨Hc(jω)Hs(jωFs) −1󵄨󵄨󵄨󵄨
󵄨󵄨󵄨󵄨Xc(jωFs)󵄨󵄨󵄨󵄨dω
(68)
≤
1
2πT
π
∫
−π
󵄨󵄨󵄨󵄨Hc(jω)Hs(jωFs) −1󵄨󵄨󵄨󵄨B(ωFs)dω
(69)
where B(Ω) ≥|X(Ω)| ∀Ω > 0 is an upper bound for the amplitude spectrum of the
assumed measuring system input signal, i. e., the measurand. Note that the upper bound
(69) can also take into account errors due to discretization by using the full sum from (65)
instead of the reduced one. The above derived expression can also be used to evaluate
the dynamic error of the measuring system. The dynamic error is defined as
ϵ(t) = 1
K0
y(t) −x(t),
(70)
with K0 the static gain of the measuring system. That is, the dynamic error is defined
as the deviation of the system output from a steady-state response. When the system
does not introduce time-dependent errors then ϵ(t) = 0, because only the static gain K0
has to be compensated. Otherwise, the dynamic error ϵ(t) > 0. Consider the case that in
expression (69) the compensation system consists of the reciprocal static gain only, i. e.,
Hc(jω) = 1/K0. Then the upper bound on Δ[n] is given as

Fundamentals of dynamic measurement analysis for LTI systems
౪
23
󵄨󵄨󵄨󵄨Δ[n]󵄨󵄨󵄨󵄨≤
1
2πT
π
∫
−π
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
1
K0
Hs(jωFs) −1
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
B(ωFs)dω
(71)
It is worth noting that sometimes this or similar derivations of an (worst case) estimate
of the dynamic error is considered as the “dynamic uncertainty”; see, for instance, [15].
However, as explained above, this terminology should be avoided to not be confused
with the actual uncertainty associated with the value of a dynamic quantity. Instead
one should use “dynamic uncertainty component” when this value is used in an uncer-
tainty budget. This is useful, for instance, when a compensation of the system’s dynamic
behavior is not possible for whatever reason.
6.2 Regularization of the inverse system
The compensation system is designed to reduce, or ideally remove, the unwanted dy-
namic effects by minimizing the dynamic error of the combined system Hc(s)Hs(s). That
is, after the application of the compensation system to the output of the measuring sys-
tem, the remaining dynamic error should be minimized. In any case, the compensa-
tion or deconvolution is an ill-posed inverse problem. In [11] and [16], an insight from a
metrological perspective is given. The author in [10] provides an overview on the gen-
eral problem of deconvolution.
6.2.1 Tikhonov regularization
A regularization first proposed by A. N. Tikhonov [17] is based on the solution of the
convolution integral
y(t) =
t
∫
0
x(τ)h(t −τ)dτ.
(72)
Assuming that x(t) = 0 for all t < 0 and h(t −τ) = 0 for all τ > t, we can expand this to
the general convolution integral
y(t) =
∞
∫
−∞
x(τ)h(t −τ)dτ.
(73)
The measured output signal y(t) is modeled as
y(t) = y0(t) + ν(t),
(74)
where ν(t) is a random noise process and y0(t) denotes the ideal, noise-free output sig-
nal. Application of the Fourier transform to the convolution integral (73) yields

24
౪
S. Eichstädt and M. Gruber
X(ω)H(jω) = Y0(ω) + V(ω).
(75)
This can be transformed to
X(ω) = Y0(ω)
H(jω) + V(ω)
H(ω).
(76)
Hence, the inverse of the measuring system is applied to the noise-free output signal
and the additive noise process individually. Applying the inverse Fourier transform to
the expression (76) gives
x(t) = 1
2π
∞
∫
−∞
X0(ω)e−jωtdω + 1
2π
∞
∫
−∞
V(ω)
H(jω)e−jωtdω
(77)
= x0(t) + 1
2π
∞
∫
−∞
V(ω)
H(jω)e−jωtdω
(78)
The integral in the second line may not exist due to the noise ν(t) having significant
high-frequency components and H(jω) →0 for ω →∞. In any case, the value of this
integral term will be very large compared to the value of x0(t). To this end, a stabilizing
component 0 ≤f (ω, α) ≤1 with α > 0 is added as follows:
xα(t) = 1
2π
∞
∫
−∞
Y(ω)
H(jω)f (ω, α)e−jωtdω.
(79)
The function f (ω, α) is to be chosen such that it suppresses high frequency components
of Y(ω)/H(jω) whilst not affecting the spectrum of X0(ω). Hence, here again the above
described compensation bandwidth [0, ωc] has to be considered. That is, the ideal sta-
bilizer equals f (ω, α) = 1 within the compensation bandwidth and |f (ω, α)| →0 for
ω →∞sufficiently fast to render (79) stable.
This condition is met by [17],
f (ω, α) =
|H(jω)|2
|H(jω)|2 + αQ(ω)
(80)
where |H(jω)|2 = H(jω)H(jω) and Q(ω) a nonnegative function of ω. For a chosen α, the
resulting compensation system is then given by
Hα(jω) =
H(jω)
|H(jω)|2 + αQ(ω).
(81)
The resulting estimate of the input signal’s spectrum is thus calculated as Xα(ω) =
Hα(jω)Y(ω).

Fundamentals of dynamic measurement analysis for LTI systems
౪
25
The important task in the Tikhonov regularization method is the selection of a suit-
able value for α. One approach is to use the expression
ϕ(α) = 1
2π
∞
∫
−∞
󵄨󵄨󵄨󵄨H(jω)Xα(ω) −Y(ω)󵄨󵄨󵄨󵄨
2dω = 1
2π
∞
∫
−∞
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
|H(jω)|2Y(ω)
|H(jω)|2 + αQ(ω) −Y(ω)
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
2
dω
(82)
= 1
2π
∞
∫
−∞
α2Q2(ω)|Y(ω)|2
[|H(jω)|2 + αQ(ω)]2 dω.
(83)
Thus, it holds that ϕ(0) = 0 and
ϕ(α) ≤1
2π
∞
∫
−∞
󵄨󵄨󵄨󵄨Y(ω)󵄨󵄨󵄨󵄨
2dω = 󵄨󵄨󵄨󵄨y(t)󵄨󵄨󵄨󵄨
2,
(84)
with ϕ(α) →|y(t)|2 for α →∞. Hence, the function ϕ(α) is a strictly increasing func-
tion of α. Therefore, a suitable value of α can be selected by increasing it until ϕ(α) is
sufficiently close to |y(t)|2. Another approach is the so-called L-curve method [18]. The
name of this method stems from the typical shape of the curve one obtains when plot-
ting ‖(h ∗xα)(t) −y(t)‖ (x axis) against ‖xα‖ (y axis) in logarithmic scale. This approach
takes into account that larger values of α will result in a large error when inserting
the estimate xα(t) back in the convolution equation, whereas smaller values of α will
result in an insufficient damping of high-frequency deteriorations. Hence, the L-curve
method considers the typical regularization trade-off between noise attenuation and
reconstruction quality. The heuristic approach for selecting α is to identify the “corner”
of the L-curve [18, 19]. Although not imposed explicitly, the quality of several heuristic
approaches depend on prior knowledge about x(t) [19].
6.2.2 Wiener–Kolmogorov deconvolution filter
The above-described method of Tikhonov regularization does not use a priori informa-
tion about the input signal explicitly. However, when such information is available it
is of advantage to take that into account. The Wiener–Kolmogorov filter method is an
approach to this end [20].
Consider the system input signal x(t) and the noise component of the system out-
put v(t) to be uncorrelated stationary stochastic processes. We assume that the spectral
densities Sx(f ) and Sv(f ) of x(t) and v(t), respectively, are known and that the measur-
ing system with impulse response h(t) is stationary, too. Note that the knowledge of the
spectral density is not equivalent with knowing the actual signal x(t). The corresponding
measurement equation is given as
y(t) = (h ∗x)(t) + v(t).
(85)

26
౪
S. Eichstädt and M. Gruber
The Wiener–Kolmogorov deconvolution filter g(t) is designed such that the estimate
̂x(t) = (g ∗y)(t)
(86)
minimizes the quadratic error
ϵ(t) = (x(t) −̂x(t))
2.
(87)
In the frequency domain, this leads to
E(f ) = 𝔼󵄨󵄨󵄨󵄨X(f ) −̂X(f )󵄨󵄨󵄨󵄨
2
(88)
= 𝔼󵄨󵄨󵄨󵄨X(f ) −G(f )(H(f )X(f ) + V(f ))󵄨󵄨󵄨󵄨
2
(89)
After some simple reformulation, taking into account that 𝔼{V(f )X∗(f )} = 0 because of
the assumed independence, one obtains
E(f ) = (1 −G(f )H(f ))(1 −G(f )H(f ))
∗Sx(f ) + G(f )G∗(f )Sv(f ).
(90)
Minimization of this expression w. r. t. G(f ) then yields the Wiener–Kolmogorov decon-
volution filter as
G(f ) =
H∗(f )Sx(f )
|H(f )|2Sx(f ) + Sv(f ),
(91)
which is often also written as
G(f ) =
H∗(f )
|H(f )|2 + Sv(f )
Sx(f )
.
(92)
It is worth noting that the reciprocal of Sv(f )/Sx(f ) is also known as the signal-to-noise
ratio (SNR). That is, the filter g(t) with frequency response G(f ) is regularized based on
the expected SNR. When there is zero noise, i. e., Sv(f ) ≡0, then G(f ) = 1/H(f ) and no
regularization is applied.
6.2.3 Low-pass filter regularization
Both approaches to regularizing the deconvolution problem introduced in the previous
section have a similar structure. The Tikhonov regularization gives
Gα(jω) =
H∗(jω)
|H(jω)|2 + αQ(ω) =
1
H(jω)
|H(jω)|2
|H(jω)|2 + αQ(ω),
(93)
and the Wiener–Kolmogorov deconvolution filter can be written as

Fundamentals of dynamic measurement analysis for LTI systems
౪
27
G(jω) =
H∗(f )
|H(f )|2 + Sv(f )
Sx(f )
=
1
H(jω)
|H(jω)|2
|H(jω)|2 + Sv(ω)/Sx(ω).
(94)
When the second term in the denominator in those expressions is larger than zero, the
second factor in both equations resembles a low-pass filter. Hence, both approaches re-
sult in a cascade of the reciprocal of the system’s frequency response H(jω) and a certain
low-pass filter. The characteristics of the low-pass filter is determined by the choice of the
respective regularization parameters. That is, the low-pass filter part for the Tikhonov
regularization is determined by α and Q(ω) whereas the low-pass filter part for the
Wiener–Kolmogorov deconvolution filter is determined by the signal-to-noise-ratio. As
a generalization of this, one may also use any low-pass filter for regularizing the inverse
system. The regularization parameter is then the vector of filter parameters, such as fil-
ter order and cut-off frequency. The upper bound (69) for the dynamic error (70) could
be used to determine an optimal low-pass filter characteristics [21] then.
When designing the regularization in this way, one has to take into account the ex-
pected spectral content of the measurands to be considered in the application. For in-
stance, in the hydrophone measurements considered in Chapter 4 a certain type and
spectral content of input signals exist. This knowledge can be employed to ensure a low
regularization error.
To visualize the effect of the choice of low-pass filter characteristics, we take a simple
example:
–
The measurement system is modeled by a second-order system with known param-
eters (gain, damping, resonance frequency)
–
The input signal (i. e., the measurand) is a bell-shaped pulse with spectral content
in the vicinity of the system’s resonance frequency
–
The output signal (i. e., the indicated signal) shows ringing, because of the system’s
resonance frequency
–
The input estimation is regularized by a low-pass filter with certain cut-off fre-
quency
The input and output signals are shown in Figure 8. The output signal shows a strong
ringing that is attenuated over time due to the system’s damping. Note that the ring-
ing cannot be compensated for with algebraic operations, i. e., scaling or shifting the
observed output signal. Hence, a dynamic compensation system must be designed to
remove the ringing.
For the compensation of the ringing and other dynamic behavior, the ideal inverse
system is accompanied with a low-pass filter. We hold the filter order fix and vary only
its cut-off frequency. The filter cut-off frequency determines up to which frequency the
filter does not attenuate signal content. That is, a low cut-off frequency may attenuate
desired content of the measurand to be estimated. At the same time, a high cut-off fre-
quency may unsufficiently attenuate signal noise in the observed measurement. Fig-
ure 9 shows the magnitude of the system’s frequency response, its ideal inverse and of

28
౪
S. Eichstädt and M. Gruber
Figure 8: Example measurand with corresponding simulated output signal for the considered second-
order system with resonance frequency.
Figure 9: Magnitude frequency response of the considered system, its ideal inverse, and three different
regularized deconvolution systems.
the compensation systems for three different choices of low-pass filter cut-off frequency.
Note that the compensation system with the low cut-off frequency attenuates frequency
content within the vicinity of the systems resonance frequency. This compensation sys-
tem is thus not able to compensate the effect of ringing.
The different compensation systems result in different estimates of the value of the
dynamic measurand, of course. In this illustrative, simulated example the measurand
has significant spectral content in the vicinity of the resonance frequency. Thus, the
compensation system with the low cut-off frequency for the regularizing low-pass fil-
ter causes a significant estimation error:

Fundamentals of dynamic measurement analysis for LTI systems
౪
29
–
high cut-off frequency low-pass filter compensation system: rms estimation error
of approximately 0.67e-3
–
medium cut-off frequency low-pass filter compensation system: rms estimation er-
ror of approximately 0.77e-3
–
low cut-off frequency low-pass filter compensation system: rms estimation error of
approximately 8.5e-3
In this example, the low cut-off frequency compensation system has a root mean square
(rms) error, which is one magnitude larger than for the other two choices of low-pass
filter cut-off frequency. This is also illustrated in Figure 10, which shows the estimation
error in the time domain.
Figure 10: Estimation error for the three different compensation systems each applied to the system’s
output signal.
Note that we here know the true value of the measurand, because it is a simulated
example. We can thus actually calculate the estimation error. In practice, however, this
is not the case and one has to estimate the error based on the available knowledge; for
instance, by using upper bound function introduced in equation (69).
6.3 Other forms of regularized deconvolution
On a more abstract level it can be argued that regularization utilizes some knowledge
or assumption about the measurand to be estimated. This assumption (or knowledge)
can be represented in various forms. Some of these have been discussed above: In
the Wiener–Kolmogorov deconvolution, the assumption is made that the measurand’s

30
౪
S. Eichstädt and M. Gruber
value, the measurement and the noise can be modeled as stationary stochastic pro-
cesses. This assumption is then used to derive the low-pass filter characteristic of the
compensation system. In practice, the Wiener–Kolmogorov deconvolution is some-
times applied using the frequency response function of the measuring system and
Fourier transform of the system’s output together with the SNR function instead of ac-
tual stochastic processes’ spectral densities. Strictly speaking, this violates the method’s
assumptions, but the result is nevertheless often usable. The Tikhonov deconvolution,
in particular with the L-curve method to determine the regularization parameter, em-
ploys certain assumptions about the statistical properties of the system output and the
measurand’s value [19]. In practice, these assumptions are typically not validated when
applying this method, which can lead to a significant estimation bias [19]. Application of
other parametric low-pass filters utilize assumptions about the spectral content of the
measurand’s value for the determination of reasonable parameter values. In principle,
this can be implemented as an optimization problem, e. g., using the above introduced
upper bound for the spectrum [21]. In practice, one may also choose a rather conserva-
tive (i. e., high) low-pass filter cut-off frequency such that the regularization bias effect
can be considered negligibly small compared to other sources of uncertainty.
A much more explicit approach of considering knowledge about the measurand is
to apply a parametric model in the time or frequency domain. For instance, a (multi)si-
nusoidal function model may be assumed for the measurand:
x(t) =
N
∑
k=1
ak sin(bkt + ck).
(95)
Estimation of the value of the measurand can then be implemented as a regression prob-
lem:
̂θ = arg min
θ∈ℝN
󵄩󵄩󵄩󵄩(h ∗xθ) −y󵄩󵄩󵄩󵄩
2
(96)
with θ = (a1, . . . , aN, b1, . . . , bN, c1, . . . , cN) the vector of model parameters. That is, the
model parameters for x(t) are chosen such that the application of the measuring system
to x(t) is as close as possible to the observed system output y(t). For a fixed N, this can
be considered a regularization because it does not amplify noise, i. e., it renders the ill-
posed estimation problem stable. When the number N of sinusoidal components is also
considered as parameter to be optimized, the risk of noise fitting occurs. That is, a high
value of N may lead to smaller estimation errors for the observed y(t) just because the
resulting model function for x(t) leads to (h ∗x)(t) mimicking the noisy y(t). In other
words, an ideal regularization should consider the model
y(t) = y0(t) + ε(t)
(97)
with y0(t) the noise-free ideal output signal and achieve (h ∗x)(t) ≈y0(t).

Fundamentals of dynamic measurement analysis for LTI systems
౪
31
An example of a model-based input estimation, which is not a regularization, is the
“differential operator method” for bandpass correction in spectral measurements [22,
23]. The mathematical model for bandpass measurements is
M(λ) = ∫S( ̃λ)b( ̃λ −λ)d ̃λ
(98)
with b(λ) the so-called “bandpass function.” When replacing the bandpass function by
its reverse ←󳨀b (λ −̃λ) = b( ̃λ −λ), equation (98) becomes a convolution and the estimation
of S(λ) from knowledge about M(λ) and ←󳨀b (λ) becomes a deconvolution problem.
The differential operator method for bandpass correction considers a Taylor series
expansion of the measurand S(λ) at a certain λk:
S(λ) = S(λk) + (λ −λk)S′(λk) + 1
2(λ −λk)2S′′(λk) + ⋅⋅⋅.
(99)
Plugging the expression (99) into the measurement equation (98) and calculating the
operator inverse, one obtains an expression for S(λk) as [22]:
S(λk) = θ0M(λk) + θ1M′(λk) + ⋅⋅⋅.
(100)
That is, the measurand is expressed in terms of the derivatives of the measurement.
Replacing the derivates in (100) with finite differences, one obtains a closed formula
for each chosen largest derivative of M. The final formulae for resulting polynomials of
order 3 and 5 are given in [22].
This approach to bandpass correction applies a parametric model for the measur-
and, i. e., the Taylor series expansion, and results in a parametric model for the estima-
tion of its value. However, this method is not a regularized deconvolution. The reason
is that due to the use of finite differences in the model, noise approximation increases
with decreasing sampling period. That is, the closer the discrete measurement gets to
the (continuous) analog measurement, the smaller the region in which the polynomial
approximation is applied. In fact, the parameter values increase indefinitely with de-
creasing sampling period [23].
Another approach to bandpass correction, and to deconvolution in general, is the
use of an iterative method such as the so-called Richardson–Lucy method [24, 25]. This
method was originally developed individually by Richardson and Lucy for image correc-
tion in astronomy. However, the method is also applied in bandpass correction [23] or for
deconvolution of certain effects when calculating COVID-19 epidemic curves from avail-
able incidence data and non-pharmaceutical inventions; see, for instance, [26] among
others. An advantage of the Richardson–Lucy method is that under mild assumptions
it guarantees an estimate of the measurand with nonnegative values. This is of impor-
tance, for instance, for spectral reconstruction or epidemic cases.
Starting with a basically arbitrary initial estimate of the measurand, the Richard-
son–Lucy method iteratively improves this estimate by repeating the following steps:

32
౪
S. Eichstädt and M. Gruber
1.
Calculate an estimate of the measurement
̃M(λk) from the current estimate ̃S(λk) at
all available instances λk.
2.
Calculate a correction factor as Q(λk) = M(λk)/ ̃M(λk) at all available instances λk.
3.
Calculate the damping term as R(λk) = (b ∗Q)(λk) at all available instances λk.
4.
Calculated the updated estimate as ̃S+(λk) = R(λk) ̃S(λk) at all available instances λk.
A simple initial estimate could be the measurement M(λ) itself. As long as the initial
estimate and the convolution kernel b(λ) are nonnegative, the above calculations will
always result in a nonnegative ̃S. Care has to be taken for λk where
̃M(λk) is zero or
close to zero. One could then set Q(λk) to zero at those instances.
Because the correction factor is calculated from the noisy measurement M, an in-
definite repetition of the above updates would lead to noise fitting. Thus, regularization
of this iterative deconvolution has to determine a suitable number of iterations, i. e.,
repetitions. In [23], an approach to determine a suitable number of iterations has been
proposed that resembles the L-curve method known from Tikhonov regularization.
Bibliography
[1]
A. V. Oppenheim and R. W. Schafer. Discrete-time signal processing: Pearson New International Edition.
Pearson Education, Limited, 2013.
[2]
B. P. Lathi. Linear Systems and Signals. Oxford University Press, 2004.
[3]
A. C. G. C. Diniz, A. B. S. Oliveira, J. N. de Souza Vianna, and F. J. R. Neves. Dynamic calibration methods
for pressure sensors and development of standard devices for dynamic pressure. In XVIII IMEKO
WORLD CONGRESS, 2006.
[4]
E. Amer, M. Wozniak, G. Jönsson, and F. Arrhén. Evaluation of shock tube retrofitted with fast-opening
valve for dynamic pressure calibration. Sensors, 21(13):4470, 2021.
[5]
C. Matthews, F. Pennecchi, S. Eichstädt, A. Malengo, T. Esward, I. M. Smith, C. Elster, A. Knott, F. Arrhén,
and A. Lakka. Mathematical modelling to support traceable dynamic calibration of pressure sensors.
Metrologia, 51(3):326–338, 2014.
[6]
H. Füser, S. Eichstädt, K. Baaske, C. Elster, K. Kuhlmann, R. Judaschke, K. Pierz, and M. Bieler.
Optoelectronic time-domain characterization of a 100 ghz sampling oscilloscope. Meas. Sci. Technol.,
23(2):025201, 2012.
[7]
W. L. Briggs and V. E. Henson. The DFT: An Owners’ Manual for the Discrete Fourier Transform. Society for
Industrial and Applied Mathematics, 1995.
[8]
V. Strejc. State space theory of discrete linear control. Wiley, Chichester, 1981.
[9]
G. F. Franklin, J. D. Powell, and M. L. Workman. Digital Control of Dynamic Systems. Addison-Wesley 3rd
edition, 1980.
[10] S. M. Riad. The deconvolution problem: an overview. Proc. IEEE, 74(1):82–85, 1986.
[11]
S. Eichstädt, V. Wilkens, A. Dienstfrey, P. Hale, B. Hughes, and C. Jarvis. On challenges in the
uncertainty evaluation for time-dependent measurements. Metrologia, 4(53):S125, 2016.
[12] B. Ludwig, S. Eichstädt et al. PyDynamic – python package for the analysis of dynamic measurements,
2020.
[13] S. Eichstädt, C. Elster, T. J. Esward, and J. P. Hessling. Deconvolution filters for the analysis of dynamic
measurement processes: a tutorial. Metrologia, 47(5):522–533, 2010.

Fundamentals of dynamic measurement analysis for LTI systems
౪
33
[14] R. Vuerinckx, Y. Rolain, J. Schoukens, and R. Pintelon. Design of stable iir filters in the complex domain
by automatic delay selection. IEEE Trans. Signal Process., 44(9):2339–2344, 1996.
[15] O. M. Vasilevskyi, P. I. Kulakov, K. V. Ovchynnykov, and V. M. Didych. Evaluation of dynamic
measurement uncertainty in the time domain in the application to high speed rotating machinery.
Int. J. Metrol. Qual. Eng., 8:25, 2017.
[16] A. Dienstfrey and P. D. Hale. Analysis for dynamic metrology. Meas. Sci. Technol., 25(3):035001, 2014.
[17] A. N. Tikhonov and V. J. Arsenin. Solution of Ill-posed Problems. Winston, Washington, 1977.
[18] P. C. Hansen and D. P. O’Leary. The use of the l-curve in the regularization of discrete ill-posed
problems. SIAM J. Sci. Comput., 14(6):1487–1503, 1993.
[19] A. Dienstfrey and P. D. Hale. Colored noise and regularization parameter selection for waveform
metrology. IEEE Trans. Instrum. Meas., 63(7):1769–1778, 2014.
[20] N. Wiener. Extrapolation, Interpolation, and Smoothing of Stationary Time Series. Technology press of MIT
and Wiley, New York, 1949.
[21] S. Eichstädt, A. Link, Th. Bruns, and C. Elster. On-line dynamic error compensation of accelerometers
by uncertainty-optimal filtering. Measurement, 43(5):708–713, 2010.
[22] E. R. Woolliams, R. Baribeau, A. Bialek, and M. G. Cox. Spectrometer bandwidth correction for
generalized bandpass functions. Metrologia, 48:164–172, 2011.
[23] S. Eichstädt, F. Schmähling, G. Wübbeler, K. Anhalt, L. Bünger, U. Krüger, and C. Elster. Comparison
of the Richardson–Lucy method and a classical approach for spectrometer bandpass correction.
Metrologia, 50(2):107, 2013.
[24] W. H. Richardson. Bayesian-based iterative method of image restoration. J. Opt. Soc. Am., 62:55–59,
1972.
[25] L. B. Lucy. An iterative technique for the rectification of observed distributions. Astron. J., 79:745–754,
1974.
[26] L. Y. Chan, B. Yuan, and M. Convertino. Covid-19 non-pharmaceutical intervention portfolio
effectiveness and risk communication predominance. Sci. Rep., 11:10605, 2021.


M. Gruber, S. Eichstädt, and C. Elster
Modeling dynamic measurements in
metrology and propagation of uncertainties
This chapter provides an overview of methods for evaluating dynamic measurement
uncertainty in metrology. The common approach behind most of these methods is the
application of the GUM uncertainty framework to discrete linear time-invariant (LTI)
systems. To bridge theory and practice, the mathematical background is accompanied
with software support through the Python library PyDynamic.
The feature that distinguishes a static from a dynamic system is its dependency on
the history of its previous states. Along with the history-dependent nature of dynamic
measurements, the associated measurement uncertainties of estimated quantities will
show dynamic properties as well. It is of fundamental interest to metrology to quantify
these dynamic measurement uncertainties.
Figure 1 illustrates a typical scenario considered in this chapter. The figure shows the
indicated measurements of a simulated dynamic sensor (red), the underlying measur-
and (black) and an estimate of the measurand based on the indication and the sensor’s
uncertain transfer behavior (purple).
Figure 1: Time series plot of simulated sensor indication, measurand and measurand estimate in arbitrary
units (a. u.). Colored bands indicate standard uncertainty. Results can be reproduced using Listing 2.1 in
Appendix A.2.
https://doi.org/10.1515/9783110713107-002

36
౪
M. Gruber et al.
The goal of this chapter is to provide means for the calculation of the dynamic uncer-
tainty associated with the estimation of a dynamic measurand such as indicated by the
scenario of Figure 1. The development of methods for evaluating dynamic uncertainty
will be based on the “Guide to the expression of uncertainty in measurement” (GUM [1]).
The GUM provides the de-facto standard for uncertainty evaluation in metrology.
The chapter is structured as follows: in Section 1 the concepts and notations of the
GUM are briefly introduced and the assumptions made about the dynamic measure-
ments are stated. We then proceed by introducing the mathematical concepts used to
model the dynamic measurements (Section 2), to calibrate these models (Section 3), to
estimate the input from indications (Section 4) and to evaluate the uncertainty asso-
ciated with these estimates (Section 5). Software support for the presented methods
is introduced in Section 6. Finally, the source code complementing the mathematical
analysis in the examples shown throughout this chapter is provided in the chapter
appendix, Appendix A.
1 GUM uncertainty framework
Uncertainty propagation in metrology typically refers to the “Guide to the expression
of uncertainty in measurement” (GUM) and its constituent parts and supplements [1–4].
The document GUM-3 [1] covers uncertainty evaluation for scalar quantities depending
on multiple input quantities using a first order approximation of the functional relation-
ship between the quantity under study and the input quantities. GUM-7 [2] considers the
same scenario, but uses Monte-Carlo simulations to enable an uncertainty evaluation for
nonlinear models and distributions associated with the input quantities, and provides
the result as a distribution for the measurand. GUM-8 [3] then extends these to vector
valued quantities. GUM-6 [4] provides an extensive guidance on the development and
use of measurement models. It also covers how dynamic measurement uncertainties
can be treated within the existing GUM framework.
1.1 Uncertainty evaluation
To evaluate uncertainty, the GUM proposes three stages: formulation of model assump-
tions, propagation of uncertainty (or of distributions associated with the input quanti-
ties) through the model and summarizing the propagation result in terms of an estimate
and its associated uncertainty [3].
The formulation stage requires to establish a measurement function f : ℝN →ℝM
that relates the sought quantity Y ∈ℝM to the input quantities X ∈ℝN, such that
Y = f (X).
(1)
This model can range from explicit mathematical equations to involved algorithms. It
is necessary to model the knowledge about X by specifying a (joint) probability density

Modeling dynamic measurements in metrology and propagation of uncertainties
౪
37
function (PDF) gX or, alternatively, to provide an estimate x of X along with a covariance
matrix Ux. These estimates represent the mean of gX for x and the covariance matrix
of gX for Ux.
The result of the propagation stage is then either a PDF gY that represents the knowl-
edge about the measurand Y, or an estimate y along with a covariance matrix Uy. The
GUM proposes (1) analytical methods, (2) the law of propagation of uncertainty or (3)
Monte Carlo methods to accomplish this task. While analytical methods provide an ideal
and mathematical representation of gY, the complexity of the necessary calculations re-
main manageable only for rather simple measurement models and PDFs. An alternative
is the “law of propagation of uncertainty” which propagates uncertainties using a first
order approximation of the functional relationship f and is a sufficiently accurate rep-
resentation of uncertainty in many cases. The resulting estimate y of the measurand Y
is obtained by inserting the estimate x of the input quantity X into the functional rela-
tionship (Equation (1)) and the associated covariance matrix Uy is calculated from the
covariance of the inputs Ux and the sensitivity C of the measurement function f [3] with
Ux = Cov(X)
(2)
C =
[[[[
[
𝜕f1
𝜕X1
. . .
𝜕f1
𝜕XN
...
...
...
𝜕fM
𝜕X1
. . .
𝜕fM
𝜕XN
]]]]
]
(3)
Uy = Cov(Y)
= CUxCT.
(4)
In cases where a propagation of uncertainties is no longer feasible, a Monte Carlo
method (MCM) can be used instead to numerically propagate the PDF associated with
the input quantities through the functional relationship (Equation (1)), yielding a PDF
for the measurand which provides the most comprehensive uncertainty quantification.
The MCM draws samples xi with i = 1, 2, . . . , m from the PDF gX and for each sample the
model (Equation (1)) is evaluated. The resulting samples yi with i = 1, 2, . . . , m then pro-
vide independent samples from the sought PDF gY for the measurand. The proceeding
takes full account of nonlinearities in the measurement model. The MCM can become
computationally intensive depending on the chosen number of drawn samples (“runs”)
and the complexity of f .
The summarizing stage extracts information about the expectation and a covari-
ance matrix (or coverage region) of Y from the calculated PDF. When applying a prop-
agation of distributions, the estimate y and covariance Uy of the output quantity Y are
given by the expectation and covariance operator:
y = E(Y)
(5)
Uy = Cov(Y).
(6)

38
౪
M. Gruber et al.
When applying a MCM with m runs for the propagation of distributions, the expectation
value and covariance matrix can be estimated according to:1
y = 1
m
m
∑
i=1
yi
(7)
Uy =
1
m −1
m
∑
i=1
(yi −y)(yi −y)T.
(8)
In this book (if not stated otherwise), uncertainty refers to the standard uncertainty.
It is the “uncertainty of the result of a measurement expressed as a standard deviation”
[1, Section 2.3.1]. In addition, the term expanded uncertainty refers to “an interval about
the result of a measurement that may be expected to encompass a large fraction of the
distribution of values that could reasonably be attributed to the measurand” [1, Section
2.3.5]. Typically, a coverage factor relates the expanded uncertainty to the standard un-
certainty.
1.2 Assumptions for dynamic measurements
Following the approach described in multiple publications [4, 6–8], we consider a real-
valued time-dependent measurand ψ(t) ∈ℝ(with time t ∈ℝ) that is measured by
a sensor with transfer behavior 𝒮. The sensor converts the measurand to an indicated
value ̃γ𝒮(t) based on its evaluation model 𝒮. Moreover, an analog-digital converter (ADC)
discretizes the indicated value in time and value γ𝒮(tk) = ADC( ̃γ𝒮(tk)). In the case of
equidistant time-steps Δt it is also common to write γ𝒮[k] = γ𝒮(tk) = γ𝒮(kΔt). The indi-
cated value γ𝒮(tk) is influenced by the observed (potentially dynamic) measurand ψ(t)
and the transfer behavior of the sensor. The latter effect is typically unwanted and the
idea is to apply a reconstruction ℛto yield a discrete-time estimate of the measurand
̂ψℛ(tk) given knowledge about the sensor 𝒮used to compensate the influence. The pro-
cess is visualized in Figure 2 and two distinctive tasks arise in which uncertainty needs
to be evaluated:
–
To estimate the dynamic transfer behavior of 𝒮(see Section 3)
–
To estimate the input ψ(t) (see Section 4)
To accomplish these tasks, a model for the dynamic transfer behavior of 𝒮needs to
be established, as well as a reconstruction model ℛderived from 𝒮. In the following
1 If it is unfeasible to store all results in memory before evaluating Equations (7) and (8), numerically
stable variations are proposed in [5] to incrementally evaluate these equations after some (≥1) runs.
Suitable implementations are also mentioned in Section 6.

Modeling dynamic measurements in metrology and propagation of uncertainties
౪
39
Figure 2: Schematic view of the reconstruction task.
Section 2, a class of models applicable to dynamic measurements in metrology is intro-
duced.2
2 Models for dynamic measurements
In order to characterize the input-output behavior of dynamical systems, systems of (or-
dinary) differential equations have proven to be a powerful modeling tool [9–11]. Such
equations describe how an incoming signal x affects an internal state z. Additionally,
an output equation usually maps the internal state z to the output γ of the dynamical
system. This can be expressed by Equation (9) for continuous-time systems and by Equa-
tion (10) for discrete-time systems [9]. Small bold letters are used to denote vectors and
capital bold letters for matrices.3
̇z(t) = ̃f (z(t), ψ(t))
γ(t) =
̃h(z(t), ψ(t))
(9)
z[k + 1] = ̃f (z[k], ψ[k])
γ[k] =
̃h(z[k], ψ[k])
(10)
These equations are the basis for many system and control engineering approaches
[9, 12–14]. The Equations (9) and (10) are generic and allow for fully nonlinear behav-
ior. However, a nonlinear treatment is often not required [15]. Linear time invariant
(LTI) systems form a subclass which cover many practical scenarios. Furthermore, LTI
systems enjoy analytical properties that allow for efficient numerical treatment. Three
2 Some of the notation and models already presented in Chapter 1 are repeated in order to draw the
connection to the GUM uncertainty framework.
3 To avoid naming conflicts for variables with the GUM notation, we use ψ, Ψ, γ, Γ, ̃f , ̃h, ̃C instead of the
more common x, X, y, Y, f , g, C.

40
౪
M. Gruber et al.
different ways to represent scalar LTI systems in continuous and discrete time are pre-
sented in the following: state-space notation, impulse response, frequency response.
Moreover, the concept of an observer is discussed.
2.1 State-space system notation
A straightforward simplification of Equation (9) is to assume that
̃f and
̃h weight the
internal state z, z0 ∈ℝN and input ψ ∈ℝM with constant matrices A, ̃A ∈ℝN×N, B, ̃B ∈
ℝN×M,
̃C ∈ℝN×P and
̃D ∈ℝM×P to update the internal state z and calculate the output
γ ∈ℝP as follows:
̇z(t) = Az(t) + Bψ(t),
z(0) = z0
γ(t) =
̃Cz(t) +
̃Dψ(t).
(11)
In the discrete case the state equations are given by
z[k + 1] =
̃Az[k] + ̃Bψ[k],
z[0] = z0
γ[k] =
̃Cz[k] +
̃Dψ[k].
(12)
These equations can also be visualized conveniently using the block diagram in Figure 3.
Under the assumption that the Nyquist-criterion holds (see Section 4 in Chapter 1), the
continuous and discrete forms can be transformed into each other without information
loss for equidistant sampling with Δt [16]:
̃A = eAΔt
̃B =
Δt
∫
0
eAτBdτ
The GUM framework considers only the influence of finite dimensional input quan-
tities X. Because uncertainty in the model description and in the input signal is expected,
these input quantities need to represent the model ( ̃A,
̃B,
̃C,
̃D, z0) and the input signal
(ψ). Suitable ways of representing the model could e. g. store the actual entries of all
matrices or just a subset of the entries (if some entries are fixed or dependent by con-
struction) as influencing quantities. The input signal could be parameterized using a
(piecewise) polynomial approximation in the continuous-time case or the actual signal
values in the discrete-time case.
Under certain conditions, (a part of) the internal state z of such a state-space sys-
tem can be estimated by another system by observing the output γ. A system with such
an observing capability is called an observer. Special cases of observers are the Luen-
berger observer and Kalman filter – the latter already provides uncertainty information

Modeling dynamic measurements in metrology and propagation of uncertainties
౪
41
Figure 3: Block diagram representation of a linear state-space models Equations (11) and (12) and hint to
more generic nonlinear Equations (9) and (10). s−1 represents the integration operation in the continuous-
time case and z−1 the delaying operation in the discrete-time case.
about the estimated state which under specific assumptions can be compatible with the
GUM [17]. Observability criteria and design guidelines for observers are available in the
control engineering literature [9, 16].
2.2 Impulse and step response
An LTI system with scalar input ψ and output γ can also be represented in the time
domain by stating its response h to a Dirac impulse input or unit step [16]. By using the
impulse response as a convolution kernel the input-output relation is:
γ(t) = (ψ ∗h)(t) =
∞
∫
−∞
ψ(t −τ) ⋅h(τ)dτ,
(13)
γ[k] = (ψ ∗h)[k] =
∞
∑
i=−∞
ψ[k −i] ⋅h[i].
(14)
An exemplary impulse response is visualized in Figure 5.
To preserve causality, h is typically zero for negative time arguments – otherwise the
systems would react to input values before “seeing” them. If h is non-zero only over an
interval of finite length it is said to be finite. Two important subgroups of discrete causal
impulse responses are covered, as they are frequently used in practical applications in
the form of digital filters [10]. A (causal discrete) finite impulse response (FIR) filter can
be represented by a coefficient vector b ∈ℝm+1:
γ[k] =
m
∑
i=0
ψ[k −i] ⋅b[i]
(15)

42
౪
M. Gruber et al.
This approach can represent arbitrary long responses, but it will not achieve true infi-
nite impulse response behavior. A (causal discrete) infinite impulse response (IIR) filter
can be represented by coefficient vectors b ∈ℝm+1 and a ∈ℝn+1. Typically, the first
element of a is set to 1 without loss of generality (a[0] ≡1).
γ[k] =
m
∑
i=0
ψ[k −i] ⋅b[i] −
n
∑
j=1
γ[k −j] ⋅a[j]
(16)
The infinite filter response is realized via an output recursion. This corresponds to a
frequency response that is a rational function, as seen in the next subsection.
Uncertainty evaluation of IIR filters according to the GUM will consider the model
representation (b, a), the input signal (ψ) and initial conditions as influencing quantities.
Typically, these are set to all entries of the coefficient vectors (except a[0]) and a finite
length of the discrete input signal.
It is also possible to represent an IIR filter as a discrete time state-space model4 by
setting
̃A = AIIR, ̃B = BIIR, ̃C = CIIR and
̃D = DIIR in Equation (12) with [8]:
AIIR =
[[[[[[[[
[
0
1
0
⋅⋅⋅
0
0
0
0
1
⋅⋅⋅
0
0
...
0
0
0
⋅⋅⋅
0
1
−a[p]
−a[p −1]
−a[p −2]
⋅⋅⋅
−a[2]
−a[1]
]]]]]]]]
]
(17)
BIIR =
[[[[[
[
0
...
0
1
]]]]]
]
̃CIIR =
[[[
[
b[p] −b[0]a[p]
...
b[1] −b[0]a[1]
]]]
]
T
̃DIIR = [b[0]]
p = max(m, n)
∀j>na[j] = 0
∀i>mb[i] = 0
2.3 Frequency response
By transforming the impulse response description introduced in Equations (13) and (14)
into the frequency domain, another relevant representation of LTI systems is obtained
– the frequency response. Applying a Laplace transformation to Equation (13) and
𝒵-transformation to Equation (14) transforms the convolution operation into a simple
multiplication in the frequency domain.
Γ(s) = ℒ{γ(t)}(s) = ℒ{(ψ ∗h)(t)}(s) = H(s) ⋅Ψ(s)
(18)
4 this is one of infinitely many representations and is called “controller canonical form”.

Modeling dynamic measurements in metrology and propagation of uncertainties
౪
43
Γ[z] = 𝒵{γ[k]}[z] = 𝒵{(ψ ∗h)[k]}[z] = H[z] ⋅Ψ[z]
(19)
Examples of frequency responses for the continuous- and discrete-time cases are visual-
ized in Figure 4. When considering the Laplace transform along the imaginary axis (i. e.
s = jω) ́, the Fourier-transform is obtained. The Fourier approach allows the interpreta-
tion of the system behavior intuitively in terms of a spectrum alteration (e. g. high-pass,
low-pass, band-pass, band-stop). For the previously mentioned IIR filter Equation (16)
(with the exact same b[i] and a[i]) the transfer function H[z] = HIIR[z] is given by [10]
HIIR[z] = ∑m+1
i=0 b[i]z−i
∑n+1
i=0 a[i]z−i = Gb[z]
Ga[z].
(20)
As in the previous two subsections, uncertainty evaluation will consider the model
representation (H) and the input signal (Ψ) as influencing quantities. Both aspects could
be parameterized using a polynomial approximation in the continuous-frequency case
or the actual spectrum values in the frequency-discrete case. This involves transforming
the input signal and its uncertainty into the frequency domain.
2.4 Example: accelerometer
As an example, we use the accelerometer described in [18] with a continuous-time
second order transfer behavior. The selection of this specific model structure is moti-
vated from prior knowledge that the sensor shows resonance around a certain input
frequency. Such a behavior can be modeled as a mass-spring-damper system5
G(s) =
S0ω2
0
s2 + 2δω0s + ω2
0
,
(21)
with assumed parametrization
̂θ = [ ̂δ
̂ω0
̂S0]
T
(22)
= [0.01
2π ⋅30 kHz
1]
T
(23)
Uθ = [[
[
(0.1 ̂δ)2
(0.03 ̂ω0)2
(0.01 ̂S0)2
]]
]
.
(24)
This corresponds to a continuous IIR filter with numerator b and denominator a,
such that
5 Of course, the parametrization of chosen model structure needs to be identifiable by the available
experimental data. For more details on this, please refer to e. g. [19–22].

44
౪
M. Gruber et al.
b = [ ̂S0
̂ω0
2]
T
(25)
= [3.55 ⋅1010 Hz2]
T ,
(26)
a = [1.0
2 ̂δ ̂ω0
̂ω0
2]
T
(27)
= [1.0
3.77 ⋅103 Hz
3.55 ⋅1010 Hz2]
T ,
(28)
Cba = [[
[
0
2 ̂ω0 ̂S0
̂ω0
2
2 ̂ω0
2 ̂δ
0
0
2 ̂ω0
0
]]
]
,
(29)
Uba = CbaUθCT
ba
(30)
= [[
[
2.41 ⋅1017 Hz4
6.11 ⋅109 Hz3
1.15 ⋅1017 Hz4
6.11 ⋅109 Hz3
1.42 ⋅105 Hz2
6.11 ⋅109 Hz3
1.15 ⋅1017 Hz4
6.11 ⋅109 Hz3
1.15 ⋅101 Hz4
]]
]
.
(31)
This can be transformed into a discrete time IIR filter at a sample rate of 500 kHz with
the MC_cont2discrete method from Listing 2.5 with6
bdiscrete = [6.99 ⋅10−2
6.97 ⋅10−2]
T ,
(32)
adiscrete = [1.0
−1.85
0.99]
T ,
(33)
Uba,discrete =
[[[[
[
8.12 ⋅10−7
8.09 ⋅10−7
7.78 ⋅10−7
−1.87 ⋅10−8
8.09 ⋅10−7
8.07 ⋅10−7
7.62 ⋅10−7
−4.99 ⋅10−9
7.78 ⋅10−7
7.62 ⋅10−7
2.21 ⋅10−6
−5.87 ⋅10−7
−1.87 ⋅10−8
−4.99 ⋅10−9
−5.87 ⋅10−7
5.80 ⋅10−7
]]]]
]
.
(34)
The frequency response of the continuous and discrete system are plotted in Figure 4,
showing the equivalence of the two representations. Figure 5 shows the impulse re-
sponse of the discrete time system. All the findings of this example can be reproduced
using Listing 2.2 in Appendix A.2.
3 Calibration for dynamic measurements
Estimating the transfer behavior of a (dynamic) system involves the selection of a suit-
able mathematical model and identification of its parameters [23]. Because this estab-
lishes a relation between indicated signal and the measurand, it can be considered a
calibration in the sense of the “International vocabulary of metrology” (VIM) [24] – pro-
vided that the reference signal is obtained by traceable measurement standards. The
6 The discrete coefficients have unit 1 because z = esT.

Modeling dynamic measurements in metrology and propagation of uncertainties
౪
45
Figure 4: Frequency response of a continuous-time and corresponding discrete time system with uncer-
tainty. The corresponding impulse response is shown in Figure 5. The small deviation at high frequencies is
expected by the chosen analog-discrete conversion method. Results can be reproduced using Listing 2.2.
Figure 5: Impulse response of a discrete time system with uncertainty. The corresponding frequency re-
sponse is shown in Figure 4. Results can be reproduced using Listing 2.2.

46
౪
M. Gruber et al.
result of this calibration process is a fixed model structure f θ with parameter estimate
̂θ ∈Θ ⊆ℝR and corresponding covariance U ̂θ ∈ℝR×R.
In that general regard, a calibration for dynamic systems is similar to a static calibra-
tion. In static calibration, the same measurand is observed in an experiment using two
different sensors – one (traceable, ideally more accurate) reference device and the de-
vice to be calibrated. Different values of the measurand are applied and the input output
characteristic is then fitted to the experimental data. If the same experiment was carried
out to evaluate the dynamic characteristics of a sensor, it would likely yield unusable re-
sults because the experiment tests only for its response for input signals of 0 Hz (static
signal). The distinguishing feature of dynamic measurement calibration therefore is a
time-varying measurand that allows to show the dynamics of the assumed transfer be-
havior.
3.1 Formulation in terms of the GUM framework
A calibration can be expressed by means of the GUM uncertainty framework (see Sec-
tion 1). The (unknown true) scalar measurand ψm(t) is measured simultaneously by two
sensors. The reference sensor provides a discrete and finite time series ψr with corre-
sponding uncertainty (quantified by a PDF gr). The device to be calibrated provides a
discrete and finite time series ψc that could come with an indication uncertainty (quan-
tified by a PDF gc).
ψr = [ψr(t0), . . . , ψr(tk−1)]
(35)
ψc = [ψc(t0), . . . , ψc(tk−1)]
(36)
A function f cal extracts a parameter estimate for the assumed model structure f θ.
An initial estimate θ0 of the parameter that defines f θ is available with PDF gθ0. This
leads to the following formulation using the GUM notation (see Section 1.1) with
X = [ψr, ψc, θ0],
gX = gr ⋅gc ⋅gθ0,
(formulation)
Y = f cal(X),
(propagation)
̂θ = E(Y),
U ̂θ = V(Y).
(summarizing)
In a similar manner, the input signals could be directly available in the frequency do-
main (see Section 5), such that
Ψr = [Ψr(ω0), . . . , Ψr(ωk−1)]
(37)
Ψc = [Ψc(ω0), . . . , Ψc(ωk−1)]
(38)

Modeling dynamic measurements in metrology and propagation of uncertainties
౪
47
X = [̃
Ψr, ̃
Ψc, θ0]
(39)
with ̃
Ψr and ̃
Ψc being the concatenated real and imaginary parts of Ψr and Ψc respec-
tively. This is in analogy to Equation (89) to take care of the GUM requirement of real-
valued inputs.
3.2 Generic regression task
The main estimation step of a calibration can in general be seen as a regression or sys-
tem identification process [25–27]. A common approach is to reformulate the parameter
estimation as a (constrained) optimization problem, i. e. to minimize the difference be-
tween modeled and observed system output with respect to some norm:
̂θ = arg min
θ∈Θ
󵄩󵄩󵄩󵄩̃ψr −̃f θ( ̃ψc)󵄩󵄩󵄩󵄩
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
f cal
(40)
Here,
̃ψr|c and
̃f θ denote suitable vectorizations of the assumed model structure and
input signals to e. g. allow minimization over multiple observations. With this reformu-
lation, it is possible to apply existing optimization methods, e. g. [28–30].7
To obtain a GUM-compliant uncertainty for the parameters ̂θ, one of the three suit-
able propagation approaches needs to be chosen (check Section 1). Because of the (often)
nonlinear nature of optimization techniques, Monte Carlo approaches are a common
choice to implement the propagation stage.
3.3 FIR and IIR filter
If the input signals are directly given in the frequency domain (Equation (39)), the coef-
ficients of an FIR or IIR filter can be estimated [18, 31]. The general idea is to augment the
existing least squares based fitting method with an uncertainty statement by evaluating
them with a MCM (see Section 1), such that
̂θ = arg min
θ∈Θ
󵄩󵄩󵄩󵄩Ψr −Hθ ⊙Ψc󵄩󵄩󵄩󵄩
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
f cal
(41)
where ⊙denotes element-wise multiplication and Hθ is the transfer function of the filter
evaluated at the same ωi for which the input signals Ψr and Ψc are available:
7 To check the identified parameters, a validation should follow the estimation step. This can be achieved
by applying the model to data that has not been used in the estimation process and compare the model’s
output with the measured output.

48
౪
M. Gruber et al.
Hθ = [Hθ(ω0), . . . , Hθ(ωk−1)]
(42)
For FIR filters, this directly yields a linear expression in θ.
In the case of an IIR filter, it is possible to maintain a linear expression in θ by con-
sidering that Hθ can be seen as a fraction of numerator and denominator polynomials
(see Equation (20)) [18], such that
Hθ(ωi) = Bθ(ωi)
Aθ(ωi)
(43)
̂θ = arg min
θ∈Θ
󵄩󵄩󵄩󵄩Aθ ⊙Ψr −Bθ ⊙Ψc󵄩󵄩󵄩󵄩
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
f cal
.
(44)
If the L2-norm is chosen, this leads to a least square problem in both cases. Moreover,
it is even possible to directly yield a regularized inverse deconvolution filter, which is
detailed in Section 4 [18].
3.4 Second-order model
System dynamics with decaying oscillations can often be captured using a second order
model (SOM). As already detailed in Section 2.4, any SOM can be directly seen as an IIR
filter [18]. It is therefore possible to refer back to the calibration methods for IIR filters
in Section 3.3 to identify an SOM system. Depending on the application, the resulting
discrete IIR filter might already be suitable (e. g. as in Section 3.6). However, if the actual
parameters of the SOM are sought, an additional step is required: The mapping from the
filter coefficients b, a back to model parameters [ ̂δ
̂ω0
̂S0]T needs to be established with
the corresponding uncertainties propagated accordingly.8
3.5 Sine fitting
In Chapter 3 a mechanical system is calibrated by analyzing the input-output behavior
for monofrequent input signals at different amplitudes. The method directly yields tu-
ples of (ωi, H(jωi), UH(jωi)) that can be interpreted as a non-parametric representation
of the frequency response H with uncertainty UH. If required, suitable parameterized
transfer models (e. g. IIR filter, second order model) can be fitted against this curve. The
practical implementation with further details is given in Chapter 3 and Section 1.1.
3.6 Example: dynamic calibration of an accelerometer
In the following we present the example of the calibration of an accelerometer. The ex-
ample is based on simulated data using the dynamic model from Section 2.4. The follow-
8 In Section 2.4 the inverse conversion is given – from model parameters to filter coefficients.

Modeling dynamic measurements in metrology and propagation of uncertainties
౪
49
ing values for the model parameters were taken in accordance with [18]:
θtrue = [8.3 ⋅10−3
29.4 kHz
0.985]
T
(45)
The underlying acceleration is simulated as a chirp signal with linearly increasing fre-
quencies from 0.01 kHz to 40 kHz. Figure 6 visualizes this acceleration, together with the
assumed measurements of a reference sensor as well as the measurements of the device
under test (DUT). The latter was calculated using the underlying acceleration together
with the assumed dynamic model of the DUT. Transforming the reference and DUT sig-
nal into the frequency domain, a stabilized IIR filter is fitted against the quotient of both
spectra. The true transfer function, the quotient and the fitted IIR are shown in Figure 7
and the obtained coefficients are
bfitted = [0.00 Hz
0.13 Hz2]
T
(46)
afitted = [1.0
−1.86 Hz
0.99 Hz2]
T
(47)
Uab =
[[[[
[
2.07 ⋅10−9 Hz2
−1.96 ⋅10−9 Hz3
−2.70 ⋅10−9 Hz2
3.37 ⋅10−9 Hz3
−1.96 ⋅10−9 Hz3
2.13 ⋅10−9 Hz4
2.20 ⋅10−9 Hz3
−2.60 ⋅10−9 Hz4
−2.70 ⋅10−9 Hz2
2.20 ⋅10−9 Hz3
2.13 ⋅10−7 Hz2
−1.95 ⋅10−7 Hz3
3.37 ⋅10−9 Hz3
−2.60 ⋅10−9 Hz4
−1.95 ⋅10−7 Hz3
1.97 ⋅10−7 Hz4
]]]]
]
(48)
The results of this example can be reproduced using Listing 2.3.
Figure 6: Time series of true acceleration, together with the output of a reference sensor and the device
under test. Results can be reproduced using Listing 2.3.

50
౪
M. Gruber et al.
Figure 7: Transfer functions of the device under test, (simulated) experimental data and fitted IIR filter.
Reproduce using Listing 2.3.
4 Input estimation
Looking again at Figure 2, the result of a calibration (Section 3) is a model for the transfer
behavior 𝒮. In practical applications, it is not so much of interest what the sensor indi-
cates (in other words: how the sensor responds to the sensed quantity), but to deduce
the value of the physical quantity being measured. This is called input estimation, signal
reconstruction or sensor compensation. This can be accomplished by the application of
an LTI system which corresponds to the inverse of the dynamic (forward) model (see
Figure 2).
The inverse model ℛdescribes how to obtain an estimate ̂ψℛof the measured quan-
tity ψ(t) from the indicated signal γ𝒮(see also Figure 2). Some aspects of such a compen-
sation have already been described in Section 6 in Chapter 1. One way of obtaining ℛ
could be to re-run the system identification process of a calibration with exchanged in-
put and output. This requires access to the original calibration data and the selection of
a suitable model structure for ℛ(which can differ from that of 𝒮). We refer to Section 3
for suitable methods.
When the original calibration data is not available and only a parameterized model
is known, it is possible to obtain ℛdirectly from 𝒮. This seemingly easy task, however,
should be undertaken with a degree of precaution as direct (naive) inversion of a dy-
namic system can lead to unstable or non-causal models. To avoid such effects, the com-
mon approach is to perform the inversion using additional assumptions tailored to the

Modeling dynamic measurements in metrology and propagation of uncertainties
౪
51
application at hand. For example one could restrict the frequency response of the in-
verse system above a certain frequency as that would otherwise only amplify the noise.
The incorporation of such assumptions into the design of an inverse system is called
regularization and is a common procedure for ill-posed problems [32]. In the field of
control engineering, model inversion is an important aspect of controller design, as a
controller needs to invert (some) of a given system’s behavior in order to deal with or
adjust its output [11].
In the following, we will look at some specialized approaches to underline and de-
tail the need for regularization when working with ill-posed model inversion problems.
Further examples of regularization in a practical context is provided in [33].
4.1 Finite Impulse Response (FIR)
Assume that the sensor’s transfer behavior 𝒮is given as a frequency response H(jω) at
discrete frequencies ω = ωk with k = 1, . . . , k. An FIR filter of order N shall represent the
compensation filter ℛ[18, 31]. Although any FIR filter is inherently stable, performing
a minimization purely against H−1 will likely not yield a suitable compensation filter
due to the delaying nature of FIR filters. A common regularization approach in this case
would therefore be to fit the FIR against a delayed version of the inverted frequency
response
̂H−1(jω) = H−1(jω)e−jωτ with a user-defined delay τ typically chosen to be a
multiple of the inverse sample rate [31]. Note that the regularization term has no effect
on the amplitude of
̂H−1 as |e−jωτ| = 1.
The identification task can be expressed as an optimization task (see Equation (40))
where
̂b = arg min
b∈ℝN
N
∑
k=1
( ̂H−1(jωk) −Gb(jωk))
2
(49)
with Gb(jω) being the frequency response of an FIR filter with coefficient vector b. Define
̂H
−1 = [ ̂H−1(jω0), . . . , ̂H−1−1(jωk)]
T ,
(50)
Gb = [Gb(jω0), . . . , Gb(jωk)]
T ,
(51)
̃H
−1 = [R( ̂H
−1)
I( ̂H
−1)
] ,
(52)
̃Gb = [R(Gb)
I(Gb)] .
(53)
Moreover, define (similar to Equations (100) and (101)):

52
౪
M. Gruber et al.
Cexp,N =
[[[
[
1
e−jω1Ts
. . .
e−jNω1Ts
...
...
...
...
1
e−jωkTs
. . .
e−jNωkTs
]]]
]
(54)
MN = [R(Cexp,N)
I(Cexp,N)]
(55)
The matrix expression Cexp,Nb represents the complex Fourier spectrum of b at the
given discrete frequencies ωk. Therefore, the product MNb directly yields the discrete
version ̃Gb of Gb(jω) with separate real and imaginary parts as desired. Equation (49) can
then be reformulated as a (weighted) linear least-squares fit [18], the solution to which
can be found in most standard statistics textbooks; see, e. g. [34]. In GUM notation, the
estimation of b with weights W can be expressed by
X =
̃H
−1
(56)
Y = b
= f (X)
= arg min
b∈ℝN( ̃H
−1 −Mb)
TW −1( ̃H
−1 −Mb).
(57)
The propagation stage requires to state the distribution of X, e. g.
X ∼gX = 𝒩( ̃H
−1, UH
−1)
(58)
UH
−1 = (UH)−1 = Cov(X)
(59)
UH = [URR,H
URI,H
UIR,H
UII,H
]
(60)
The propagation can then be carried out using [35] or MCM.
4.2 Infinite Impulse Response (IIR)
Another common approach is to approximate ℛwith an IIR filter. The idea is similar
to the already presented procedure for FIR filter. However, the details differ and are
given in [18, 36]. Let Gb,a(jω) = Gb(jω)
Ga(jω) be the frequency response of the IIR filter, where
Gb(jω) and Ga(jω) are defined as in Equation (20). The estimation problem could then
be (naively) formulated like
̂b, ̂a = arg min
b,a
N
∑
i=k
(H−1(jωk) −Gb,a(jωk))
2
This approach has two issues: (1) the formulation is nonlinear in a and (2) the resulting
filter given by b and a can be unstable. While the former can be linearized by a refor-

Modeling dynamic measurements in metrology and propagation of uncertainties
౪
53
mulation, the latter requires an iterative regularizing approach that reuses the idea of
an introduced delay from Equation (49).
̂b, ̂a = arg min
b,a
N
∑
k=1
(Ga(jωk)H−1(jωi)e−jωkτk −Gb(jωk))
2
(61)
As proposed by [36], the delay τi is iteratively incremented until a stable solution is
found. The update considers the group delay of the fitted filter and a stabilized version
of it.9
Using MN and MM as in Equation (55), this can again be reformulated as a GUM-
compliant least-squares problem:
X =
̃H
−1
(62)
Y = [b
a]
= f (X)
= arg
min
b,a∈ℝN+M(MNa ⊙
̃H
−1 −MNb)
TW −1(MNa ⊙
̃H
−1 −MNb)
(63)
The propagation stage requires to state the distribution of X, e. g.
X ∼gX = 𝒩( ̃H
−1, UH
−1)
(64)
UH
−1 = (UH)−1 = Cov(X)
(65)
UH = [URR,H
URI,H
UIR,H
UII,H
]
(66)
The propagation can then be carried out using MCM.
4.3 Example: input estimation of an accelerometer
In the previous examples (Sections 2.4 and 3.6), we have seen how an acceleration sensor
can be modeled as an IIR filter and how the parameters in this model can be estimated by
means of a calibration. It is now of interest to compensate the influence of the transfer
behavior and estimate the input to the sensor.
9 Alternatively, another regularization method for approximation of inverse system behavior with IIR
filters is achieved by decomposing the resulting filter into a minimum-phase system and an all-pass
system [33]. While the all-pass system has a constant amplitude response, the minimum-phase system
and its inverse are stable. The regularization would therefore be to only use the minimum-phase system
as ℛ.

54
౪
M. Gruber et al.
The continuous (Equation (21)) representation of the accelerometer is evaluated at
discrete frequencies ωi and an IIR filter is fitted to the inverse behavior.10 A lowpass fil-
ter is added to regularize the inverse behavior above ∼60 kHz. The true, fitted, inverted
and regularized transfer functions are shown in Figure 8. Application of the regularized
inverse behavior to the indicated signal used for calibration in Section 3.6 is compared
to the true acceleration and the uncompensated signal in Figure 9. Note, that in this
example the effect of the resonance frequency is damped, but not completely compen-
sated. Uncertainty propagation is calculated as described in Section 5. The results of this
example can be reproduced using Listing 2.4.
5 Uncertainty propagation for dynamic models
To express the uncertainty of processed dynamic measurements by means of the GUM, a
signal ψ ∼gψ is propagated through a system represented by model parameters θ ∼gθ
to obtain the processed signal γ ∼gγ.11 To further fulfill the GUM-requirement of a
finite set of input variables (see Equation (1)), our focus lies on the uncertainty propaga-
tion for discrete-time systems as stated in Section 2. This does not impose major practi-
cal drawbacks, as measurement data is typically already discrete-time. For information
about uncertainty propagation in continuous systems the reader is referred to the sec-
ond chapter of [6] and references therein, and for the assignment of uncertainties to
input quantities to e. g. the GUM [1, clause 4 and annex F].12
5.1 State-space models
Discrete state-space systems with uncorrelated input uncertainties can be dealt with
using the GUM’s “law of propagation of uncertainties” [3, 37]. To formulate the task in
GUM notation, consider the following input X and model f (see also Equations (1) and
(12)):
10 The accelerometer is modeled as a second order system. To obtain a compensation model, a stable
IIR filter of similar structure (i. e. b ∈ℝ1 and a ∈ℝ3) or a higher-order FIR filter (a ∈ℝ12) are suitable
choices [18].
11 E. g. in an input estimation the signal ψ corresponds to the indicated signal of the employed sensor
and the processed signal γ equals the estimate of the input signal to the sensor, i. e. the measurand.
12 The GUM [1] considers two types of uncertainty: While type A uncertainty is calculated based on
provided observations, type B uncertainty is established by scientific judgment of multiple information
source e. g. manufacturer specifications, calibration certificates, previous data or experience.

Modeling dynamic measurements in metrology and propagation of uncertainties
౪
55
Figure 8: Frequency responses of the true, calibrated and inverted DUT behavior, as well as the regularized
compensation filter. Results can be reproduced using Listing 2.4.

56
౪
M. Gruber et al.
Figure 9: Time series of the true simulated quantity, the indication of the device under test and the com-
pensated indication. Results can be reproduced using Listing 2.4.

Modeling dynamic measurements in metrology and propagation of uncertainties
౪
57
X = [[
[
z[k]
ψ[k]
θ
]]
]
(67)
Y = [z[k + 1]
γ[k] ]
= f (X) = f (z[k], ψ[k], θ)
=
{
{
{
{
{
̃A =
̃A(θ), ̃B =
̃B(θ), ̃C =
̃C(θ), ̃D =
̃D(θ)
z[k + 1]
=
̃Az[k] + ̃Bψ[k]
γ[k]
=
̃Cz[k] +
̃Dψ[k]
(68)
The propagation according to Equation (4) requires the uncertainty Ux of X and the
sensitivities C of f with respect to X. Typically, no correlations between the input signal,
model parameters and model state are expected, leading to a sparse Ux. We assume here
in addition that X follows a Gaussian distribution, such that the uncertainty Ux and
sensitivity C are given by
X ∼gX = 𝒩(μx, Ux),
(69)
Ux = [[
[
Uz[k]
0
0
0
Uψ[k]
0
0
0
Uθ
]]
]
= Cov(X),
(70)
C = [
̃A
̃B
Φz
̃C
̃D
Φγ
] .
(71)
The sub-sensitivities Φz and Φγ are calculated such that13
Φz = 𝜕z[k + 1]
𝜕θ
=
̃A(θ)
⏟⏟⏟⏟⏟⏟⏟
const.
𝜕z[k]
𝜕θ
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
from previous
+ 𝜕̃A(θ)
𝜕θ
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
const.
z[k]
⏟⏟⏟⏟⏟⏟⏟
known
+ 𝜕̃B(θ)
𝜕θ
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
const.
ψ[k]
⏟⏟⏟⏟⏟⏟⏟
known
,
(72)
Φγ = 𝜕γ[k]
𝜕θ
=
̃C(θ)
⏟⏟⏟⏟⏟⏟⏟
const.
𝜕z[k]
𝜕θ
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
from Equation (72)
+ 𝜕̃C(θ)
𝜕θ
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
const.
z[k]
⏟⏟⏟⏟⏟⏟⏟
known
+ 𝜕̃D(θ)
𝜕θ
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
const.
ψ[k]
⏟⏟⏟⏟⏟⏟⏟
known
.
(73)
The application of Equation (4) yields a block matrix
13 Initial values (k = 0) of z[k], 𝜕z[k]
𝜕θ
and Uz[k] can be obtained e. g. by assuming a steady state for the
state-space model. Details are given in [38].

58
౪
M. Gruber et al.
Uy = [Uzz
Uzγ
Uγz
Uγγ
] .
(74)
The lower right block provides the uncertainty information about the output signal γ[k],
such that
Uγγ =
̃CUz[k] ̃C
T +
̃DUψ[k] ̃D
T + ΦγUθΦT
γ.
(75)
5.2 FIR models
Practical implementations of impulse response models are typically discrete-time FIR
and IIR filters. Uncertainty for these can be propagated using the result of the previous
subsection in conjunction with Equation (17) [8]. However, a specialized approach exists
for FIR filters that provide computational benefits and operate on blocks of discrete time
series. The approach suited for FIR filter makes use of efficient convolution operations
and allows to provide full output covariance information.
Stating the task in GUM notation uses the following input X and model f (see also
Equations (1) and (15)) with
X = [ψ
b] = [ψ[0], . . . , ψ[N], b[0], . . . , b[m]]
T ,
(76)
Y = γ = [γ[0], . . . , γ[k], . . . , γ[N]]
T
= f (X) = f (ψ, b),
=
[[[[[[[[[
[
∑m
i=0 ψ[0 −i] ⋅b[i]
...
∑m
i=0 ψ[k −i] ⋅b[i]
...
∑m
i=0 ψ[N −i] ⋅b[i]
]]]]]]]]]
]
.
(77)
The propagation stage requires to state the distribution of X. Independent multivariate
Gaussian distributions are chosen for the input signal and filter coefficients.
X ∼gX = gψ ⋅gb
(78)
gψ = 𝒩(μψ, Uψ)
(79)
gb = 𝒩(μb, Ub)
(80)
The propagation for the FIR filter can then be carried out under full consideration of the
measurement model and input distribution (without first-order approximations) [7, 39].
This involves the integration of the variance expression [40]

Modeling dynamic measurements in metrology and propagation of uncertainties
౪
59
Uy =
∫
ℝN+m
gX(η)(f (η) −y)(f (η) −y)
Tdη,
(81)
which yields the elements [uy]i,j of the covariance matrix Uy with
[uy]i,j = bTUψi,ψjb + ψT
i Ubψj
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
first order only
+ Tr(Uψi,ψjUb)
(82)
where ψi and Uψi denote corresponding “cutouts” of ψ and Uψ matching the filter length
m + 1 and time indices i, j, such that
ψi = [ψ[i]
ψ[i −1]
. . .
ψ[i −m]]
T
(83)
Uψi,ψj =
[[[
[
u(ψ[i], ψ[j])
. . .
u(ψ[i −m], ψ[j])
...
...
...
u(ψ[i −m], ψ[j])
. . .
u(ψ[i −m], ψ[j −m])
]]]
]
.
(84)
It should be noted, that in contrast to Equation (75), Equation (82) does not describe the
uncertainty of the output vector at a single point in time, but the covariance matrix of
multiple sequential scalar output values. Equation (82) can be efficiently implemented
using two-dimensional convolution operations; see also Section 6.
5.3 IIR models
Uncertainty propagation for IIR models refers back to the uncertainty propagation of
state-space systems by transforming the IIR filter (e. g.) using Equation (17). The uncer-
tainty propagation is then carried out using the respective state-space model [8]. Al-
ternatively, Monte Carlo methods can be used to evaluate the uncertainty of IIR filter
models. Different available methods here optimize the calculations for implementation
simplicity, parallel scalability, memory usage or online use. Further information is given
in Section 6.
5.4 Frequency response models
Let ψ be a real-valued equidistant discrete time signal of length N with complex fre-
quency spectrum Ψ and a complex transfer behavior H – represented by vectors ψ, Ψ
and H respectively. For ease of notation, we assume N to be even.
ψ = [ψ[0], . . . , ψ[N −1]]
T = [ψ(t0 + 0Δt), . . . , ψ(t0 + (N −1)Δt)]
T
(85)
Ψ = [Ψ[0], . . . , Ψ[N −1]]
T = [Ψ( 0
NΔt), . . . , Ψ( N/2−1
NΔt ), Ψ( −N/2
NΔt ), . . . , Ψ( −1
NΔt)]
T
(86)
H = [H[0], . . . , H[N −1]]
T = [H( 0
NΔt), . . . , H( N/2−1
NΔt ), H( −N/2
NΔt ), . . . , H( −1
NΔt)]
T
(87)

60
౪
M. Gruber et al.
ψ and Ψ are linked by the discrete Fourier transform
Ψ[k] =
N−1
∑
n=0
ψ[n] exp(−jk 2πn
N )
(88)
Recall that for real valued signals only half the spectrum is required for reconstruc-
tion. To take both of these aspects into account, consider the following representation
of the signal spectra Ψ and H:
̃
Ψ = [R(Ψ[0]), . . . , R(Ψ[N/2 −1]), I(Ψ[0]), . . . , I(Ψ[N/2 −1])]
T
(89)
̃H = [R(Ψ[0]), . . . , R(Ψ[N/2 −1]), I(Ψ[0]), . . . , I(Ψ[N/2 −1])]
T
(90)
To evaluate the uncertainty for Equation (19) the following mapping to the GUM
notation is used [41]
X = [
̃
Ψ
̃H]
(91)
Y = ̃Γ = [R(Γ)
I(Γ)]
= f (X) = ̃
Ψ ⊙
̃H
=
[[[
[
̃H[0] ⋅̃Ψ[0]
...
̃H[N] ⋅̃Ψ[N]
]]]
]
(92)
The propagation stage requires to state the distribution of X. It is assumed that the
spectra of the input signal and transfer behavior are independent,which is reflected by
the block diagonal structure of Ux.
X ∼gX = 𝒩(μx, Ux)
(93)
Ux = [U ̃
Ψ
0
0
U
̃H
] = Cov(X)
(94)
C = [
̃H
T
0
0
̃
Ψ
T]
(95)
Application of Equation (4) directly yields the uncertainty of the filtered spectrum ̃Γ
Uy =
̃H
TU ̃
Ψ ̃H + ̃
Ψ
TU
̃H ̃
Ψ
(96)
U ̃
Ψ and U
̃H are made up of blocks covering the covariances between all real parts (RR),
all imaginary parts (II) and the real-imaginary-mixed parts (RI, IR).

Modeling dynamic measurements in metrology and propagation of uncertainties
౪
61
U ̃
Ψ = [URR,Ψ
URI,Ψ
UIR,Ψ
UII,Ψ
]
U
̃H = [URR,H
URI,H
UIR,H
UII,H
]
(97)
5.5 Discrete Fourier transform
As detailed by [41], there are more things to consider when working in the frequency
domain. Many measurement processes do not directly record frequency domain values
and one has to transform the measured data from the time-domain into the frequency-
domain (and back, if required). The tool of choice is typically the discrete Fourier trans-
form (DFT, see Equation (88)). To evaluate the uncertainty propagation for the DFT, con-
sider the following mapping to the GUM notation:
X = ψ
(98)
Y = ̃
Ψ = [R(Ψ)
I(Ψ)]
= f (X) = [Ccos
Csin
] ψ
(99)
with Ccos and Csin transforming Equation (88) into a matrix expression for separate real
and imaginary parts in the output.
Ccos =
[[[
[
cos(0 ∗β0)
. . .
cos(0 ∗βN−1)
...
...
...
cos( N
2 ∗β0)
. . .
cos( N
2 ∗βN−1)
]]]
]
(100)
Csin =
[[[
[
−sin(0 ∗β0)
. . .
−sin(0 ∗βN−1)
...
...
...
−sin( N
2 ∗β0)
. . .
−sin( N
2 ∗βN−1)
]]]
]
(101)
βn = 2π n
N
(102)
To carry out the uncertainty propagation, a multivariate Gaussian distribution is as-
sumed for X. The sensitivity matrix C is composed of the individual sensitivities for the
real (Ccos) and imaginary (Csin) parts given by
X ∼gX = 𝒩(μx, Ux),
(103)
Ux = Uψ = Cov(X),
(104)
C = [Ccos
Csin
] .
(105)
The uncertainty is then directly given by Equation (4) which upon further inspection
presents the block-matrix structure already mentioned earlier in Equation (97).

62
౪
M. Gruber et al.
Uy = [CcosUxCcos
T
CcosUxCsin
T
CsinUxCcos
T
CsinUxCsin
T ]
(106)
= [URR,Ψ
URI,Ψ
UIR,Ψ
UII,Ψ
]
(107)
= U ̃
Ψ
(108)
5.6 Inverse discrete Fourier transform
The inverse discrete Fourier transform (IDFT) is very similar to the DFT and uncertainty
evaluation for the IDFT is given in [41]. Formulating it in terms of the GUM notation
yields:
X = ̃
Ψ
(109)
Y = ψ
= f (X) = [ ̃Ccos
̃Csin] ̃
Ψ
(110)
with
̃Ccos = WCcos
(111)
̃Csin = WCsin
(112)
W = 1
N
[[[[[[
[
1
0
. . .
0
0
2
...
...
...
0
0
. . .
0
2
]]]]]]
]
(113)
To prepare the propagation stage, assume a multivariate Gaussian distribution for
X that has a block matrix structure. The sensitivity is (similarly to the DFT) given by the
compound of both individual sensitivities.
X ∼gX = 𝒩(μx, Ux)
(114)
Ux = U ̃
Ψ = [URR,Ψ
URI,Ψ
UIR,Ψ
UII,Ψ
] = Cov(X)
(115)
C = [ ̃Ccos
̃Csin]
(116)
Propagation according to Equation (4) and exploiting the block structure yields
Uy =
̃CcosURR,Ψ ̃Ccos
T + 2 ̃CcosURI,Ψ ̃Csin
T + ̃CsinUII,Ψ ̃Csin
T
(117)
= Uψ
(118)

Modeling dynamic measurements in metrology and propagation of uncertainties
౪
63
6 Software support: the PyDynamic library
PyDynamic is a “Python library for the analysis of dynamic measurements” [42] with spe-
cial attention to GUM-compliant uncertainty evaluation. It provides implementations
for many of the methods presented in this chapter.
Section 3 covered the calibration of dynamic sensors. The estimation of parameters
for FIR, IIR and second order models to fit a given frequency response can be accom-
plished by the following functions from the model_estimation module:
–
PyDynamic.model_estimation.LSFIR
–
PyDynamic.model_estimation.LSIIR
–
PyDynamic.model_estimation.fit_som
All three methods propagate uncertainty according to a Monte Carlo scheme.
Section 4 dealt with the estimation of an inverse system. The functions LSFIR and
LSIIR already mentioned above can be used for this purpose as well by setting the ap-
propriate switch to true (e. g. LSIIR(..., inv=True)).
Section 5 covered the propagation of uncertainty through a given system or oper-
ation. The propagation schemes for FIR and IIR filters are covered by the uncertainty
module
–
PyDynamic.uncertainty.FIRuncFilter
–
PyDynamic.uncertainty.IIRuncFilter
–
PyDynamic.uncertainty.MC
–
PyDynamic.uncertainty.SMC
–
PyDynamic.uncertainty.UMC
The MC, SMC and UMC methods also provide IIR uncertainty evaluation, but based on
different Monte Carlo implementations in contrast to the analytical calculation in
IIRuncFilter. MC implements a straight forward Monte Carlo variant of an IIR filter.
SMC achieves a memory efficient implementation by only evaluating the filter output
one time-step at a time, hence advancing sequentially in time. UMC implements another
memory efficient variant by evaluating one (or multiple) time-series at a time from
which the mean and standard deviation of the result are updated incrementally.
Moreover, the propagation schemes from and to the frequency domain, as well as
operations (multiplication, division, conversion of polar and Cartesian complex repre-
sentations) are provided:
–
PyDynamic.uncertainty.GUM_DFT
–
PyDynamic.uncertainty.GUM_iDFT
–
PyDynamic.uncertainty.DFT_multiply
–
PyDynamic.uncertainty.AmpPhase2DFT()
–
PyDynamic.uncertainty.DFT2AmpPhase

64
౪
M. Gruber et al.
Although not mentioned in this chapter, the uncertainty module also provides func-
tions for uncertainty-aware interpolation, discrete wavelet transformation and convo-
lution. Some of these functions are used in the examples of this chapter to which the
source code is available in Appendix A. Further documentation and implementation
details of PyDynamic are available at https://github.com/PTB-M4D/PyDynamic, https://
pydynamic.readthedocs.io/en/latest/index.html.
Appendix A. Practical examples in Python
A.1 Prerequisites to run the code
The above code examples are executed using the following packages:
–
Python 3.11.2
–
NumPy 1.24.2
–
SciPy 1.10.1
–
Matplotlib 3.7.0
–
PyDynamic 2.3.2
To set up a programming environment, please refer to the official Python documenta-
tion: https://docs.python.org/3/installing/index.html.
A.2 Code implementations
The following code blocks (Listings 2.1 to 2.5) only highlight the main calculation steps
of each example. The full code for the examples (which includes the required imports
and the plot-related code) of this book is published as [43] and can be accessed at the
following web addresses: https://doi.org/10.5281/zenodo.7189016.
# measurand signal
N = 200
dt = 0.05
t = dt * np.arange(N)
x = np.full(N, 1.0)
x[N//3:2*N//3] = 0.0
ux = np.full_like(x, 0.002)
# sensor transfer behavior (second order lowpass with resonance)
wc = 8 # / 2pi
zeros = np.array([3.5]) * wc
poles = np.array([-0.25+1j, -0.25-1j]) * wc
b_gain, a_gain = zpk2tf(zeros, poles, 1.0)
gain = a_gain[-1] / b_gain[-1] # ensure stationary accuracy

Modeling dynamic measurements in metrology and propagation of uncertainties
౪
65
b, a, _ = cont2discrete(zpk2tf(zeros, poles, gain), dt=dt)
b = np.squeeze(b)
Uba = np.diag(np.hstack((np.full(len(b), 1e-8), np.full(len(a)-1, 1e-8))))
# sensor indication signal
state0 = x[0] * lfilter_zi(b, a)
y, _ = lfilter(b, a, x, zi=state0)
uy = np.full_like(y, 5 / 2**8) # from 8-bit quantization
# get inverse filter
b_inv, a_inv, uab_inv = MC_inverse_iir(b, a, Uba, dt_input=dt, dt_IIR=dt, tau=1)
# obtain estimate of measurand by applying inverse filter
init_state = IIR_get_initial_state(b_inv, a_inv, Uab=uab_inv, x0=y[0], U0=uy[0])
x_hat, ux_hat, _ = IIRuncFilter(y, uy, b_inv, a_inv, Uab=uab_inv, kind="diag",
state=init_state)
Listing 2.1: Simulation and compensation of a dynamic sensor with uncertainty.
# estimated parameter values
delta_hat = 0.01 # 1
f0_hat = 30e3 # Hz
omega0_hat = 2 * np.pi * f0_hat # Hz
S0_hat = 1 # 1
U_theta_hat = np.diag(np.square([0.1 * delta_hat, 0.03 * f0_hat, 0.01 * S0_hat]))
# estimated filter coefficients
a = np.array([1.0, 2 * delta_hat * omega0_hat, omega0_hat ** 2])
b = np.array([S0_hat * omega0_hat ** 2])
C = np.array(
[
[2 * omega0_hat, 2 * delta_hat, 0],
[0, 2 * omega0_hat, 0],
[0, 2 * omega0_hat * S0_hat, omega0_hat ** 2],
]
) # sensitivities
ab = np.hstack([a[1:], b])
Uab = C @ U_theta_hat @ C.T
# discrete filter coefficients
fs = 500e3 # Hz
b_discrete, a_discrete, Uab_discrete = MC_cont2discrete(
b, a, Uab, dt=1.0 / fs, runs=500
)
# get spectra
W_conti, H_conti, UH_conti_diag = MC_freq(b, a, Uab)
W_discrete, H_discrete, UH_discrete_diag = MC_freq(

66
౪
M. Gruber et al.
b_discrete, a_discrete, Uab_discrete, dt=1.0 / fs, use_w=W_conti
)
# get impulse / step response
t_discrete = np.arange(0, 1000 / fs, 1 / fs)
t_discrete, h_discrete, uh_discrete_diag = MC_impulse(
b_discrete, a_discrete, Uab_discrete, dt=1.0 / fs, use_t=t_discrete
)
Listing 2.2: Visualization of the transfer behavior of an acceleration sensor in the frequency and time
domain.
# true device under test (DUT) transfer behavior
delta_true = 8.3e-3 # 1
f0_true = 29.4e3 # Hz
omega0_true = 2 * np.pi * f0_true # Hz
S0_true = 0.985 # 1
a = np.array([1.0, 2 * delta_true * omega0_true, omega0_true ** 2])
b = np.array([S0_true * omega0_true ** 2])
# true acceleration
fs = 500e3 # Hz
t = np.arange(0, 0.01, 1 / fs)
acc_true = chirp(t, f0=10, t1=t[-1], f1=40e3, method="linear", phi=-90)
# measured reference signal
u_ref = 0.05
acc_ref = acc_true + u_ref * np.random.randn(acc_true.size)
# measured DUT signal
t, acc_dut, xout = lsim((b, a), U=acc_true, T=t)
# transfrom to frequency domain
f = GUM_DFTfreq(len(t), dt=1 / fs)
F_ref, UF_ref = GUM_DFT(acc_ref, u_ref ** 2)
F_dut, UF_dut = GUM_DFT(acc_dut, 0.0)
H, UH = DFT_deconv(F_ref, F_dut, UF_ref, UF_dut)
H = real_imag_2_complex(H)
# calibration (fit IIR to empirical spectrum)
# only fit up to 40kHz, as noise is expected above
fi = fit_indices = f < 40e3
fifi = np.hstack((fi, fi))
b_discrete, a_discrete, tau, Uab_discrete = LSIIR(
H[fi],
UH=UH[fifi, :][:, fifi],
f=f[fi],

Modeling dynamic measurements in metrology and propagation of uncertainties
౪
67
Nb=1,
Na=2,
Fs=fs,
mc_runs=500,
verbose=False,
)
# calculate true transfer functions of true sensor and DUT (only for visualization)
W, H_true = freqs(b, a, worN=2 * np.pi * f)
W, H_dut, UH_dut = MC_freq(
b_discrete,
a_discrete,
Uab_discrete,
dt=1 / fs,
use_w=2 * np.pi * f,
return_full_cov=True,
)
UH_dut_diag = np.sqrt(np.diag(UH_dut))
UH_dut_abs = np.abs(real_imag_2_complex(UH_dut_diag))
UH_dut_phase = np.angle(real_imag_2_complex(UH_dut_diag))
Listing 2.3: Visualize and perform a calibration for an acceleration sensor based on simulated data.
# true device under test (DUT) transfer behavior ( taken from
Section 3.6
)
a_true = np.array([1.00e00, 3.07e03, 3.41e10])
b_true = np.array([3.36e10])
# estimate of DUT parameters ( taken from
Section 2.4
)
a = np.array([1.00e00, 3.77e03, 3.55e10])
b = np.array([3.55e10])
Uab = np.array(
[
[1.42e05, 6.11e09, 6.11e09],
[6.11e09, 1.15e17, 1.15e17],
[6.11e09, 1.15e17, 2.41e17],
]
)
# estimated DUT inverse behavior
fs = 500e3 # Hz
b_inv, a_inv, Uab_inv = MC_inverse_iir(b, a, Uab, dt_input=None, dt_IIR=1 / fs)
# lowpass regularization
b_low, a_low = cheby2(4, 30, 100e3, btype="low", analog=False, output="ba", fs=fs)
b_reg, a_reg, Uab_reg = chain_filter_with_lowpass(b_inv, a_inv, Uab_inv, b_low,
a_low)
# acceleration input
t = np.arange(0, 0.01, 1 / fs)

68
౪
M. Gruber et al.
acc_true = chirp(t, f0=10, t1=t[-1], f1=40e3, method="linear", phi=-90)
# measured DUT signal
t, acc_dut, _ = lsim((b_true, a_true), U=acc_true, T=t)
Uacc_dut = np.full_like(
t, 0.2
) # assumed uncertainty of indiciation, i.e. known from a calibration
# compensated DUT signal
acc_comp, Uacc_comp, _ = IIRuncFilter(
acc_dut, Uacc_dut, b_reg, a_reg, Uab_reg, kind="diag"
)
Listing 2.4: Visualize and perform an input estimation for an acceleration sensor.
def MC_cont2discrete(b, a, Uab, dt, runs=500):
ab = np.hstack((a[1:], b))
Na_conti = len(a) - 1
results = []
AB = multivariate_normal(ab, Uab, allow_singular=True).rvs(runs)
for ab_tmp in AB:
a_tmp = np.hstack(([1.0], ab_tmp[:Na_conti]))
b_tmp = ab_tmp[Na_conti:]
b_discrete, a_discrete, _ = cont2discrete((b_tmp, a_tmp), dt=dt)
results.append(np.hstack((a_discrete[1:], np.squeeze(b_discrete))))
Na_discrete = a_discrete.size - 1
ab_discrete = np.mean(results, axis=0)
a_discrete = np.hstack(([1.0], ab_discrete[:Na_discrete]))
b_discrete = ab_discrete[Na_discrete:]
uab_discrete = np.cov(np.array(results).T)
return b_discrete, a_discrete, uab_discrete
def MC_step(b, a, Uab, runs=500, dt=None, use_t=None):
ab = np.hstack((a[1:], b))
Na = len(a) - 1
t = use_t
h_list = []
AB = multivariate_normal(ab, Uab, allow_singular=True).rvs(runs)
for ab_tmp in AB:
a_tmp = np.hstack(([1.0], ab_tmp[:Na]))
b_tmp = ab_tmp[Na:]
if dt is None:
t, h_tmp = step((b_tmp, a_tmp), T=t)
else:
t, h_tmp = dstep((b_tmp, a_tmp, dt), t=t)
h_tmp = np.squeeze(h_tmp)

Modeling dynamic measurements in metrology and propagation of uncertainties
౪
69
h_list.append(h_tmp)
h = np.mean(h_list, axis=0)
uh = np.cov(np.array(h_list).T)
uh_diag = np.sqrt(np.diag(uh))
return t, h, uh_diag
def MC_impulse(b, a, Uab, runs=500, dt=None, use_t=None):
ab = np.hstack((a[1:], b))
Na = len(a) - 1
t = use_t
h_list = []
AB = multivariate_normal(ab, Uab, allow_singular=True).rvs(runs)
for ab_tmp in AB:
a_tmp = np.hstack(([1.0], ab_tmp[:Na]))
b_tmp = ab_tmp[Na:]
if dt is None:
t, h_tmp = impulse((b_tmp, a_tmp), T=t)
else:
t, h_tmp = dimpulse((b_tmp, a_tmp, dt), t=t)
h_tmp = np.squeeze(h_tmp)
h_list.append(h_tmp)
h = np.mean(h_list, axis=0)
uh = np.cov(np.array(h_list).T)
uh_diag = np.sqrt(np.diag(uh))
return t, h, uh_diag
def MC_freq(b, a, Uab, dt=None, runs=500, use_w=None, return_full_cov=False):
W = use_w
ab = np.hstack((a[1:], b))
Na = len(a) - 1
H_list = []
AB = multivariate_normal(ab, Uab, allow_singular=True).rvs(runs)
for ab_tmp in AB:
a_tmp = np.hstack(([1.0], ab_tmp[:Na]))
b_tmp = ab_tmp[Na:]
if dt is None:
W, H_tmp = freqs(b_tmp, a_tmp, worN=W)
else:
W, H_tmp = freqz(b_tmp, a_tmp, worN=W, fs=2 * np.pi / dt)
H_tmp = np.squeeze(H_tmp)
H_list.append(H_tmp)

70
౪
M. Gruber et al.
HH = np.array(H_list)
H = np.mean(HH, axis=0)
UH = np.cov(np.hstack((np.real(HH), np.imag(HH))).T)
if return_full_cov:
return W, H, UH
else:
UH_diag = np.sqrt(np.diag(UH)[: len(W)] + np.diag(UH)[len(W) :])
return W, H, UH_diag
def MC_inverse_iir(b, a, Uab, runs=500, dt_input=None, dt_IIR=1.0, tau=0.0):
# this seems not to work currently
# generate frequency response with uncertainty via Monte Carlo
W, H, UH = MC_freq(b, a, Uab, dt=dt_input, return_full_cov=True)
Na = len(a[1:])
Nb = len(b)
b_inv, a_inv, tau_inv, Uab_inv = LSIIR(
H, UH=UH, Nb=Na+2, Na=Nb, f=W / (2*np.pi), Fs=1.0 / dt_IIR, tau=tau,
inv=True, mc_runs=runs
)
# gain correction
gc = np.sum(a_inv) / np.sum(b_inv)
b_inv = gc * b_inv
Uab_inv[Na:,Na:] = Uab_inv[Na:,Na:] * gc**2
return b_inv, a_inv, Uab_inv
def chain_filter_with_lowpass(b, a, Uab, b_low, a_low):
# define shortcuts
Na = len(a) - 1
uaa = block_diag([0.0], Uab[:Na,:Na])
ubb = Uab[Na:,Na:]
bc, Ubc = convolve_unc(b, ubb, b_low, None, mode="full")
ac, Uac = convolve_unc(a, uaa, a_low, None, mode="full")
UC = block_diag(Uac[1:,1:], Ubc)
return bc, ac, UC
Listing 2.5: Monte-Carlo helper functions used in the examples.

Modeling dynamic measurements in metrology and propagation of uncertainties
౪
71
Bibliography
[1]
BIPM, IEC, IFCC, ILAC, ISO, IUPAC, IUPAP, and OIML. Guide to the expression of uncertainty in
measurement, 2008.
[2]
BIPM, IEC, IFCC, ILAC, ISO, IUPAC, IUPAP, and OIML. Supplement 1 to the “Guide to the expression of
uncertainty in measurement” – Propagation of distributions using a Monte Carlo method, 2008.
[3]
BIPM, IEC, IFCC, ILAC, ISO, IUPAC, IUPAP, and OIML. Supplement 2 to the “Guide to the expression of
uncertainty in measurement” – Extension to any number of output quantities, 2011.
[4]
BIPM, IEC, IFCC, ILAC, ISO, IUPAC, IUPAP, and OIML. Guide to the expression of uncertainty in
measurement – Part 6: Developing and using measurement models, 2020.
[5]
S. Eichstädt, A. Link, P. Harris, and C. Elster. Efficient implementation of a Monte Carlo method for
uncertainty evaluation in dynamic measurements. Metrologia, 49(3):401–410, 2012.
[6]
S. Eichstädt. Analysis of Dynamic Measurements. PhD thesis, Technische Universität Berlin, Berlin, 2012.
[7]
C. Elster and A. Link. Uncertainty evaluation for dynamic measurements modelled by a linear
time-invariant system. Metrologia, 45(4):464–473, 2008.
[8]
A. Link and C. Elster. Uncertainty evaluation for IIR (infinite impulse response) filtering using a
state-space approach. Meas. Sci. Technol., 20(5):055104, 2009.
[9]
H. K. Khalil. Nonlinear Systems. Pearson, 3rd edition, 2002.
[10] I. Rennert and B. Bundschuh. Signale und Systeme: Einführung in die Systemtheorie. Carl Hanser Verlag
GmbH & Co. KG, München, 2013.
[11]
R. C. Dorf and R. H. Bishop. Modern Control Systems. Pearson, 12th edition, 2014.
[12] W. J. Rugh. Linear System Theory. Prentice-Hall, Inc., USA, 2nd edition, 1996.
[13] S. J. Julier and J. K. Uhlmann. Unscented filtering and nonlinear estimation. Proc. IEEE, 92(3):401–422,
2004.
[14] L. Grüne and J. Pannek. Nonlinear Model Predictive Control, 2nd edition, 2017.
[15] S. H. Strogatz. Nonlinear Dynamics and Chaos. Westview Press, 2000.
[16] H. W. Knobloch and H. Kwakernaak. Lineare Kontrolltheorie. Springer, Berlin Heidelberg, 1985.
[17]
S. Eichstädt, N. Makarava, and C. Elster. On the evaluation of uncertainties for state estimation with
the Kalman filter. Meas. Sci. Technol., 27(12):125009, 2016.
[18] S. Eichstädt, C. Elster, T. J. Esward, and J. P. Hessling. Deconvolution filters for the analysis of dynamic
measurement processes: a tutorial. Metrologia, 47(5):522–533, 2010.
[19] F.-G. Wieland, A. L. Hauber, M. Rosenblatt, C. Tönsing, and J. Timmer. On structural and practical
identifiability. Curr. Opin. Syst. Biol., 25:60–69, 2021.
[20] E. L. Lehmann and G. Casella. Theory of Point Estimation. Springer Texts in Statistics. Springer, New
York, 2nd edition, 1998.
[21] V. Fedorov. Optimal experimental design. WIREs Comput. Stat., 2(5):581–589, 2010.
[22] F. Pukelsheim. Optimal Design of Experiments. Classics in Applied Mathematics. Society for Industrial
and Applied Mathematics, 2006.
[23] R. Pintelon and J. Schoukens. System Identification: A Frequency Domain Approach. MATLAB Examples.
IEEE Press, Piscataway, NJ, 2nd edition, 2012.
[24] BIPM, IEC, IFCC, ILAC, ISO, IUPAC, IUPAP, and OIML. International vocabulary of metrology – Basic and
general concepts and associated terms (VIM), 2012.
[25] R. Isermann. Identifikation dynamischer Systeme 1: Grundlegende Methoden. Springer, Berlin, 2nd
edition, 1992.
[26] K. P. Burnham and D. R. Anderson. Model Selection and Multimodel Inference: A Practical
Information-Theoretic Approach. Springer, New York, 2nd edition, 2002.
[27] K. J. Keesman. System Identification: An Introduction. Advanced Textbooks in Control and Signal
Processing. Springer, London, 2011.
[28] S. Boyd and L. Vandenberghe. Convex Optimization. Cambridge University Press, Cambridge, 2004.

72
౪
M. Gruber et al.
[29] N. Hansen. The CMA Evolution Strategy: A Comparing Review. In J. A. Lozano, P. Larrañaga, I. Inza
and E. Bengoetxea, editors, Towards a New Evolutionary Computation: Advances in the Estimation of
Distribution Algorithms. Studies in Fuzziness and Soft Computing, pages 75–102. Springer, Berlin, 2006.
[30] J. Nocedal and S. Wright. Numerical Optimization. Springer Series in Operations Research and Financial
Engineering. Springer, New York, 2nd edition, 2006.
[31] P. J. Parker and R. R. Bitmead. Approximation of Stable and Unstable Systems via Frequency Response
Interpolation. IFAC Proc. Vol., 20(5, Part 10):357–362, 1987.
[32] R. C. Aster, B. Borchers, and C. H. Thurber. Parameter Estimation and Inverse Problems. Elsevier, 3rd
edition, 2018.
[33] S. Eichstädt, V. Wilkens, A. Dienstfrey, P. Hale, B. Hughes, and C. Jarvis. On challenges in the
uncertainty evaluation for time-dependent measurements. Metrologia, 4(53):S125, 2016.
[34] T. Strutz. Data Fitting and Uncertainty (A Practical Introduction to Weighted Least Squares and Beyond),
2010.
[35] C. Elster and B. Toman. Bayesian uncertainty analysis for a regression model versus application of
GUM Supplement 1 to the least-squares estimate. Metrologia, 48(5):233–240, 2011.
[36] R. Vuerinckx, Y. Rolain, J. Schoukens, and R. Pintelon. Design of stable iir filters in the complex domain
by automatic delay selection. IEEE Trans. Signal Process., 44(9):2339–2344, 1996.
[37] M. Wegener and E. Schnieder. Application of the GUM method for state-space systems in the case of
uncorrelated input uncertainties. Meas. Sci. Technol., 24(2):025003, 2013.
[38] M. Gruber, T. Dorst, A. Schütze, S. Eichstädt, and C. Elster. Discrete wavelet transform on uncertain
data: Efficient online implementation for practical applications. In Advanced Mathematical and
Computational Tools in Metrology and Testing XII, volume 90 of Series on Advances in Mathematics
for Applied Sciences, pages 249–261, World Scientific, 2021.
[39] C. Elster, A. Link, and Th. Bruns. Analysis of dynamic measurements and determination of
time-dependent measurement uncertainty using a second-order model. Meas. Sci. Technol.,
18(12):3682–3687, 2007.
[40] M. G. Cox and B. R. L. Siebert. The use of a Monte Carlo method for evaluating uncertainty and
expanded uncertainty. Metrologia, 43(4):S178, 2006.
[41] S. Eichstädt and V. Wilkens. GUM2DFT—a software tool for uncertainty evaluation of transient signals
in the frequency domain. Meas. Sci. Technol., 27(5):055001, 2016.
[42] B. Ludwig, M. Gruber, P. Kruse, S. Eichstädt, M. Weber, M. Sieberer, A. M. Piniella, and Th. Bruns.
PTB-M4D/PyDynamic. Zenodo, December 2021.
[43] M. Gruber. PTB-M4D/dgsm_code_examples: Initial Code Release. Zenodo, October 2022.

Th. Bruns, L. Klaus, and M. Kobusch
Traceable calibration for the dynamic
measurement of mechanical quantities
The vast majority of inertial motion sensors nowadays are so-called seismic sensors.
This term is owed to the fact that the sensing element makes use of the inertia of a
seismic mass, which is coupled to the housing via an elastical structure that can be
described as a spring. When the housing is moved and changes its state of motion, the
inertia counteracts the connecting spring, and by measuring the deformation of the
spring, we obtain a measure of the applied change of motion. The simplest (and most
frequently used) approach to model this motion sensor is a single mass-spring system
of one degree of freedom, where the measurement equation relates a motion quantity
of the (rigid) housing to the resulting elongation of the spring. Figure 1 illustrates the
principle. The equation of motion xs of the seismic mass ms in relation to the motion of
the base xb is then given by
0 = d( ̇xb −̇xs) + k(xb −xs) −ms ̈xs,
(1)
Figure 1: Illustration of the motion sensor as a spring-mass-damped
system of one degree of freedom.
where the first component on the right-hand side is the (viscous) damping force due
to the deformation velocity of the spring, the second term is the elastic force due the
deformation itself, and the third term is the inertial reactive force of the seismic mass.
Dividing the equation by ms transforms it to an equation of motion quantities instead of
forces and scales the coefficients:
0 = d
ms
( ̇xb −̇xs) + k
ms
(xb −xs) −̈xs.
(2)
With the usual approach of a (complex) monofrequency vibration for all the motions
like
x(t) = ̂x ⋅eiωt,
̇x(t) = iω ̂x ⋅eiωt,
̈x(t) = −ω2 ̂x ⋅eiωt,
(3)
https://doi.org/10.1515/9783110713107-003

74
౪
Th. Bruns et al.
one can derive a relation between the elongation of the spring (xs −xb) and the acceler-
ation of the housing ( ̈xb):
̂xs −̂xb
ω2 ̂xb
=
̂xs −̂xb
̂̈xb
=
1
k
ms + iω d
ms −ω2 .
(4)
For the assumption of an electrical output proportional to the spring deformation, and
with the usual textbook substitution of k/ms = ω2
0 for the (undamped) resonance fre-
quency and d/ms = γ for the specific damping, this is already the transfer function of
an accelerometer usually written as
Sqa = ρ ⋅
1
ω2
0 + iγω −ω2 =
S0
1 + i γ
ω2
0 ω −ω2
ω2
0
.
(5)
Here, for example, Sqa models the so-called complex charge sensitivity of an accelerom-
eter, with ρ being the charge conversion factor of a piezoelectric spring, and S0 being
the static sensitivity.
For the case of different kinds of motion sensors, like geophones or seismometers,
which measure velocity instead of acceleration, the approach is the same but the ratio
considered in equation (4) has to be related to the base velocity ̇xb instead of accelera-
tion ̈xb.
1 Calibration of motion sensors
Equation (5) provides the idealized transfer function of a linear seismic accelerometer.
However, there are three parameters in this equation, which are generally unknown,
depending on the individual sensor and to some extent even on environmental condi-
tions. Those are S0 (which describes the asymptotic low frequency sensitivity), γ, and ω0.
In order to derive the actual acceleration from the electrical output of the sensor, those
parameters, or more generally, the complex transfer function has to be determined ex-
perimentally. This process of calibration can be performed in several ways, which are in-
ternationally harmonized via the series of the ISO 16063 standards. These guidelines dis-
tinguish between primary calibration by the use of laser interferometry and secondary
calibration by the use of a reference standard, which is a calibrated motion sensor itself.
In the following sections, both approaches are briefly introduced.
1.1 Primary calibration by laser interferometry
Acceleration is the second time derivative of the displacement. Hence, for a primary re-
alization, the obvious approach is to measure displacement, which is a length, and time
with high accuracy and resolution. Accurate time measurements in the context of me-

Traceable calibration for the dynamic measurement of mechanical quantities
౪
75
chanical processes are no exceptional problem with the currently available oscillators
in today’s data acquisition systems. Time-dependent (dynamic) length measurements
are more challenging.
In length metrology, the use of laser interferometry is common practice for decades
by now, and it is used in acceleration metrology for almost the same time. A typical
setup for primary calibration is depicted in Figure 2. Its basic components are a electro-
dynamic exciter (shaker), which provides a sinusoidal vibration to the motion sensor
to be calibrated, a laser interferometer, which is capable to measure the dynamics of
the applied motion, and the motion sensor itself. Not shown are the data acquisition
devices to capture the electric signals from the measuring devices. During calibration,
a monofrequency sinusoidal vibration is applied to the motion sensor and its output is
sampled over time with the data acquisition system. Simultaneously, the motion of the
reference surface (of the motion) is measured with the laser interferometer. In order to
derive the full complex frequency response, the timing relation between the two chan-
nels must be well-defined; the simplest case here is a synchronous sampling system.
The sampled motion data of the distinct channels are subsequently analyzed by the sine
approximation method, which fits a sine function with a bias of the form
x(t) = a ⋅sin(ωt) + b ⋅cos(ωt) + c
(6)
Figure 2: Illustration of a primary calibration setup for motion sensors using a laser interferometer. The
principle is shown on the left, a realization on the right. The red arrow points at the (tiny) accelerometer.
to the measured data. Amplitude and initial phase of the signal is then given as
̂x = √a2 + b2,
φx = arctan(a
b).
(7)
Based on that, the model functions for the signals after fitting are

76
౪
Th. Bruns et al.
̇x(t) = ω ̂x ⋅ei(ωt+φx+ π
2 ),
̈x(t) = ω2 ̂x ⋅e−i(ωt+φx+π),
(8)
q(t) = ̂q ⋅ei(ωt+φq).
(9)
Equation (8) models the velocity or acceleration based on the interferometric data and
equation (9) models the electrical response of the motion sensor.
Since interferometers sense displacement, the model functions in (8) are scaled and
phase-shifted from the original fit to transform the measurand from displacement to ve-
locity ( ̇x) or acceleration ( ̈x). The measured transfer coefficient for the angular frequency
ω in relation to acceleration is then given as
Sqa(ω) =
̂q(ω)
ω2 ̂x(ω) ⋅ei(φq−φx−π) = 󵄨󵄨󵄨󵄨Sqa(ω)󵄨󵄨󵄨󵄨⋅eiφSqa(ω),
(10)
which is the experimental result according to equation (5). |Sqa| is called the magnitude
and φSqa the phase of the complex sensitivity. More details on the standardized proce-
dure are given in [1].
1.2 Secondary calibration
Once primary calibrated motion sensors are available (cf. previous section), it is a rather
simple task to compare an unknown sensor, the device under test (DUT), with one that
is already traceably calibrated, the reference. This process of direct comparison of two
motion sensors is called a secondary calibration [2]. Direct comparison in this context
means that both sensors are mounted together on the exciter and both outputs during
the vibration excitation are again sampled synchronously. Figure 3 depicts such a so-
called back-to-back configuration as a schematic and in a photograph.
There are special sensor designs available for such back-to-back mounting, where
the seismic system is connected to the top side of the sensor.
Also, in secondary calibration, the excitation is usually applied as a single frequency
sinusoidal motion. Accordingly, the amplitude and the initial phase of the electrical out-
put can be determined by sine approximation again. Provided that the known complex
sensitivity of the reference is Sref, and its output amplitude and initial phase are ̂qref and
φref, respectively, then the reference motion during calibration was
aref =
̂qref ⋅ei(ωt+φref)
Sref
= qref
Sref
.
(11)
According to the definition of the complex sensitivity, this provides the necessary
information for the calculation of the complex sensitivity of the DUT as
SDUT(ω) = qDUT(ω)
qref(ω) ⋅Sref(ω),
(12)

Traceable calibration for the dynamic measurement of mechanical quantities
౪
77
Figure 3: Illustration of a secondary calibration setup for motion sensors using the preferred back-to-back
configuration. The left image shows the principle, and the right shows a realization. Note that the reference
planes of the two seismic systems are in direct contact to each other, because the sensor at the bottom has
internally an inverted arrangement of mass and spring.
or in terms of magnitudes and phases
|SDUT| = |Sref| ⋅
̂qDUT
̂qref
,
(13)
φDUT = φout −φin −φref.
(14)
The charge output qx is usually derived from a voltage measurement via a dynamically
calibrated charge amplifier (cf. Section 2). For this secondary calibration, the standard-
ized methods are documented in [2].
1.3 Disturbing effects of the real world
The calibration conditions were idealized in the previous Sections 1.1 and 1.2. This as-
sumes, e. g., a purely uniaxial motion strictly in the direction of the sensitive axis of
reference and a device under test with a clean sinusoidal curve over time. In reality,
those assumptions fail to a smaller or larger degree and give rise to deviations to be
quantified by the uncertainty of measurement.
Typical effects influencing the magnitude of sensitivity include:1
–
Misalignment between the direction of motion and direction of sensitivity.
–
Transverse sensitivity of reference or DUT in conjunction with rocking or transverse
motion [3].
1 The lists show typical examples and are not meant to be exhaustive.

78
౪
Th. Bruns et al.
–
Asymmetric motion measurement by laser interferometry [4].
–
Electromagnetic interference from magnetic stray fields of the electrodynamic
shaker.
–
Relative motion between the reference and the DUT (due to finite mechanical stiff-
ness or non-optimal mounting) [5, 6].
–
Residual alternating gravitational components.
–
Mass loading sensitivity of the reference in back-to-back calibration.
Effects influencing the phase of the sensitivity include:
–
Dynamic tilting motion of the shaker armature.
–
Unknown (group) delay in complementary components like conditioning amplifiers
or laser interferometers [7, 8].
–
Jitter of the sample clock of either data acquisition channel.
The international standards of the ISO 16063 series require that such influencing effects
are investigated, analyzed, and quantified in a measurement uncertainty budget. Ac-
cordingly, a proper measurement uncertainty evaluation is an elaborate and complex
task. However, guidance can be found in the standards themselves as well as the sci-
entific literature (see references). Once determined, such calibration uncertainties are
stated in the calibration certificates and should be used in subsequent applications of
the sensor as an input to dynamic measurement uncertainty propagation as described
in the previous chapter “Modeling dynamic measurements in metrology and propaga-
tion of uncertainties”.
1.4 Parameter identification
Results from the previously described calibrations describe the behavior of motion sen-
sors in the frequency domain for a selected set of discrete frequencies. Typically, those
frequencies are taken from the set of standard frequencies according to the standard
ISO 266 [9]. However, for general dynamic measurements it is often necessary to de-
scribe the sensor’s response in a continuous frequency range or even in the time do-
main. An imminent example of such a case are transient shock measurements of all
kinds, where no predominant frequency could be identified. An appropriate approach
to retrieve traceable measurements in such cases is the use of the model parameter iden-
tification; also often referred to as system identification. A prerequisite for the model
parameter identification is (of course) an appropriate model of the used electrome-
chanical system, i. e., the sensor or measuring chain in the application. Motion sen-
sors, as considered in this chapter, are typically modeled as systems of masses, elastic
springs, and viscous damping elements, which are already indicated in the previous fig-
ures.

Traceable calibration for the dynamic measurement of mechanical quantities
౪
79
A simple linear single mass-spring-damper model like depicted in Figure 1 can be
represented by the complex-valued transfer function of the form
H(ω) = Y(ω)
X(ω) =
S0 ⋅k
ms
k
ms + iω d
ms −ω2 =
S0 ⋅ω2
0
ω2
0 + iωγ −ω2 ,
(15)
where the base sensitivity S0, the seismic mass ms, the spring stiffness k, and the damp-
ing coefficient d are the physical parameters. However, only three of four parameters are
actually mathematically independent, which results in the right-hand side of equation
(15) with the parameter set {S0, ω0, γ}. Here, ω0 is the undamped resonance frequency
and γ is the specific damping.
Use cases and approaches for the identification process based on this model can
be found in a large number in the literature (e. g., [10, 11]) and even made it into an
international standard [12]. However, the simplicity of the model calls for an extension
to improve the accuracy in some applications. Typically, this happens when the used
frequency range comes close to or even covers resonances of the measurement setup.
Then additional effects like the elasticity of the mounting or an internal structure of the
sensor have to be considered [6, 13, 14].
From the mathematical point of view, the parameter identification is an optimiza-
tion problem, which in the framework of this book which is handled in the previous
chapter. From the metrological point of view, it has to be noted that the uncertainty of
measurement is handled by a propagation of uncertainty from the calibration results to
an uncertainty of the parameters. The methods for this transfer are introduced in the
previous chapter.
2 Conditioning amplifiers
Although the electromechanical conversion process of modeled motion sensors can be
derived in a straightforward way, the measured data usually do not follow this descrip-
tion directly. This is due to the simple fact that the sensor is connected to the sampling
system via a conditioning amplifier. These are devices that convert between different
electrical quantities often with the additional option to adjust a gain factor and/or the
frequency band of transmission. Typical types of conditioning amplifiers are listed in
the subsequent table. For the purpose of measurements, these devices are designed
to behave linearly in terms of input quantity value to output voltage. Hence, they can
amplifier type
conversion from →to
sensor type
voltage amplifier
voltage →voltage (gain and bandwidth only)
voltage output servoelectric
charge amplifier
charge →voltage
piezoelectric
bridge amplifier
resistance ratio →voltage
piezoresistive strain gage

80
౪
Th. Bruns et al.
Figure 4: Graphical representation of the complex transfer function of conditioning amplifiers in the fre-
quency domain, a voltage amplifier on the left and a charge amplifier on the right. In both cases, the top
shows the phase response while the bottom shows the magnitude (gain) response.
be considered as LTI systems. Their transfer characteristics can usually be modeled as
a combination of a high-pass and a low-pass filter [15, 16]. Typical frequency-domain
transfer functions are depicted in Figure 4. While classical (analogue) electronic devices
typically implement conversion stages with filter characteristics of second or third or-
der, there are more and more devices on the market with intermediate digital process-
ing, where high-order filters with sometimes tens of parameters are realized. While the
specs of these latter devices may look excellent, their benefit in terms of input prediction
processing and other metrological measurement data analysis still needs to be proven.
With respect to modeling, the increased number of unknown parameters (and unknown
number of parameters, in fact) poses a huge challenge for sure.
Recently, comprehensive guidelines [17] were developed and published concern-
ing the proper dynamic calibration of various types of conditioning amplifier. These de-
scribe the experimental setups, the calibration processes, the measurement uncertainty
contributions, and common pitfalls. Since they are openly available, the details should
not be discussed here. In preparation of this guideline, extensive investigations [7] took
place, which repeatedly identified the impedance of the connected measurement chain
as a potentially detrimental source of influence. This means two things:
1.
The calibration data of a conditioning amplifier are only valid for a given measure-
ment, if the source impedance of the sensor is close enough to the source impedance
used during calibration of the amplifier. What “close enough” means in a particular
case depends strongly on the individual type of conditioning amplifier and specifi-
cally on its complex input impedance [18].
2.
The input impedance of the data acquisition system has to be high in comparison to
the output (source) impedance of the conditioning amplifier. The ratio of deviation
caused by a too low input impedance is approximately given by the ratio of the two
impedances of sampling system and amplifier. If both impedances are known, the
influence can be corrected.
If, however, the calibration is handled properly in all respect, the result is a complex
frequency response function given by samples in the frequency domain, equivalent to
the characterization of the motion sensor. The frequency response function of the com-

Traceable calibration for the dynamic measurement of mechanical quantities
౪
81
pleted measuring chain consisting of sensor and conditioning amplifier is accordingly
given by their product as
H(ω)chain = Samp(ω) ⋅Ssens(ω).
(16)
3 Dynamic force calibration
The vast majority of force sensor calibrations are static calibrations only. For most static
force calibrations, different force levels in tension or compression are applied for a cer-
tain time. The output of the sensor under test is read, and then the force load is changed
to the next level [19]. Afterwards, a sensitivity can be calculated as a one-number value
or a quadratic approximation, depending on the required level of measurement uncer-
tainty.
Many applications differ significantly from these calibration conditions. In case of
rapidly changing force levels, a static calibration is not sufficient. Albeit not available
universally, the dynamic calibration of force sensors was included into normative doc-
uments recently in a general way [20] and for dedicated applications [21].
The force sensors used for dynamic measurements typically incorporate one of two
measurement principles: piezoelectric elements or strain gauges. The former type ap-
plies piezoceramics or piezocrystals, which emit or absorb electric charge if being com-
pressed or decompressed [22]. These sensors are only suitable for dynamic measure-
ments. Due to charge leakage, they cannot measure true static forces. The output signal
of the conditioning electronics, the charge amplifier, is nearly always equipped with a
high-pass filter to avoid a drifting output signal. As result of this, piezoelectric sensors
are well suited for the measurement of dynamic forces in presence of a dominant static
load, which then is not present in the measured signal.
The latter strain-gauge based sensors are suitable for both static and dynamic mea-
surements. These sensors have one or more structural elements with reduced stiffness.
Strain gauges are applied on these places to sense the force-dependent deformation at
these more compliant structural parts. Strain gauges are resistive elements that change
their resistance proportionally to the applied elongation [23]. Multiple strain gauges
can be connected in a Wheatstone bridge circuit. If a known voltage is applied, the
small changes in resistance lead to an—also small—voltage, which can be conditioned
in bridge amplifiers. Temperature and offset compensation can be realized by cleverly
adding resistors in the bridge circuit. A wide range of strain gauge sensors from preci-
sion sensors, over sensors dedicated to dynamic measurements, to mass-produced load
cells used in scales are available. More details on the measurement principle and the
mechanical design of strain gauge sensors can be found in [24, 25].
Other force measurement principles exist but have no significance for traceable dy-
namic measurements. More details to the various measurement principles can be found
in [24].

82
౪
Th. Bruns et al.
Dynamic force applications
In material testing, cyclic fatigue testing is carried out to demonstrate the safety of struc-
tures or to test the strength of materials when being exposed to cyclic loads. If these tests
are carried out in fatigue testing machines, the applied load is often measured by means
of force sensors.
In the automotive industry, the safety of new vehicle developments is analyzed by
means of crash tests. To analyze the force of the impact, the duration and the peak force
during a crash test is measured using sensor-equipped walls. Often, the sensors used for
crash applications are based on the piezoelectric measurement principle. Standards on
instrumentation for crash tests in the automotive industry like ISO 6487 [26] or SAE J211/1
[27] already specify requirements for force sensors used in such tests.
3.1 State of the art in dynamic force calibration
The dynamic calibration of force sensors is still a topic of scientific research. Although
the challenges of traceable dynamic measurements are well known for a long time, up
to now, no commonly accepted solutions are available.
The general suitability of a force sensor for dynamic measurements can be roughly
estimated on the basis of its resonance frequency, which is typically given by the man-
ufacturer in the sensor’s data sheet, although it is unknown how the manufacturer de-
rived the information (calculation, simulation, or measurement) and it is also not known
how accurate the given data is. For reliable knowledge, the sensor needs to be calibrated.
This always means that not only properties of the device under test are determined,
but also the associated measurement uncertainty (obtained with the given calibration
device) is estimated. The uncertainty allows to classify the degree of confidence of the
calibration results.
3.1.1 Sine force excitation: electrodynamic shakers, prestressed frames with
hydraulic exciters
The dynamic calibration of force sensors began in the field of material testing machines
[28, 29]. The excitation form used in material testing machines and in the dynamic cali-
bration of force sensors is a mono-frequency sinusoidal force. Two different setups are
typically used for this kind of calibration.
An electrodynamic shaker can be used to generate oscillations in a wide range of
frequency and for different types of waveforms. A mass-loaded force sensor mounted
on the shaker armature experiences a force when accelerated. The dynamic force F(t)
is dependent on the acceleration a(t) and on the mass m mounted on top of the force
sensor according to Newton’s second law giving

Traceable calibration for the dynamic measurement of mechanical quantities
౪
83
F(t) = m ⋅a(t).
(17)
A calibration setup based on a electrodynamic shaker is shown in principle and as a
photo in Figure 5.
Figure 5: Dynamic force calibration setup based on an electrodynamic shaker. The calibration principle is
illustrated on the left; a photograph of a calibration setup is shown on the right [30].
This type of dynamic force calibration setup provides a primary calibration (i. e.,
a calibration traced to other quantities than force) in a wide frequency range (usually
ranging from a few hertz to a few kilohertz). The acceleration can be measured by an
accelerometer placed on the load mass or by means of a laser interferometer (as shown
in Figure 5). The force magnitudes are limited to the capabilities of the shakers used and
go up to about 10 kN. Such types of dynamic force calibration setups were established
in several national metrology institutes (NMIs) worldwide [31–34].
The most simple dynamic characterization of the sensor obtained with such type of
calibration setup is the sensor sensitivity S at different excitation frequencies ω. For this
purpose, the measured force Fsens and the reference force input Fref (derived according
to equation (17)) are compared giving the sensor’s transfer function
S(ω) = Fsens(ω)
Fref(ω) =
Fout(ω)
m ⋅aref(ω).
(18)
This complex transfer function is usually given as magnitude response and phase re-
sponse, respectively.
Due to parasitic mechanical influences like tilting of the shaker, the reference ac-
celeration might be not evenly distributed. Such possible influences need to be taken

84
౪
Th. Bruns et al.
into account in case of a calibration [35, 36]. Calibrations like these are offered as a ser-
vice from PTB [37]. International comparison measurements showed good agreement,
but also issues due to parasitic motions [38]. Investigations of uniaxial force sensors are
carried out on such setups, but also research on the calibration of multicomponent sen-
sors was carried out [39–42].
In addition to calibration setups based on electrodynamic shakers, there are also
calibration devices that operate with hydraulic excitation. Hydraulic exciters can gen-
erate much higher dynamic forces (in the range of 100 kN) but only up to frequencies of
about 100 Hz. To generate dynamic forces by the above-mentioned principles based on
Newton’s second law, large masses need to be coupled to the force sensor [43].
To generate higher force levels, the hydraulic exciter and the force sensor to be
calibrated can be mounted and prestressed within a machine frame. This setup is very
similar to material testing machines, which operate with such a frame, too. If two force
sensors are placed in a series arrangement in this frame, a calibration can be carried
out by comparison (secondary calibration). One of the sensors will be the reference and
the other sensor under test is compared to this reference [43, 44].
3.1.2 Shock force: Colliding masses
The limited force magnitudes of electrodynamic shakers and the very limited frequency
range of hydraulic exciters led to the development of shock force calibration setups in
the early 2000s [45]. Shock force calibration devices use the same principle of traceability
of the dynamic force as the shaker-based calibration devices (see equation (17)) and,
therefore, also provide primary calibrations.
The use of shock forces has some advantages and disadvantages compared to sinu-
soidal calibrations.
Force magnitude: The forces generated in shock force calibration devices can be sig-
nificantly larger than that of shaker-based setups. While electrodynamic shakers
are limited to about 10 kN, shock force calibration devices for forces up to 250 kN
and 1 MN exist [46, 47].
Frequency range, waveform control: Electrodynamic shakers can excite frequencies
up to several kilohertz (while hydraulic exciters are limited to a few hundred hertz)
and allow the operator to choose the waveform (single frequency, multifrequency
sine, random noise excitation). In a shock force calibration device, the generated
waveform is predominantly defined by the stiffness of the contact surface pairing as
well as the stiffness and mass distribution of the sensor under test and the connected
components. It is possible to control the contact properties to some extend (e. g., by
softening and, therefore, stretching the shock pulse), but the possibilities are very
limited compared to a shaker excitation.

Traceable calibration for the dynamic measurement of mechanical quantities
౪
85
To date, two different types of shock force calibration devices have been established at
different NMIs: The first type is a horizontal setup based on two movable masses. The
first mass is accelerated to a certain velocity and then impacts onto the force sensor,
which is mounted on the second mass. The (de) acceleration of the masses during the
brief time of contact can be measured by accelerometers or laser interferometers. From
the measurements on both masses, the impact force and the reaction force can be de-
rived independently according to Newton’s second law (cf. equation (17)). Examples for
this design are the setups at PTB [46, 48] or at the Shanghai Institute of Quality Inspec-
tion and Technical Research [49]. An illustration of a setup and a photo is displayed in
Figure 6.
Figure 6: Shock force calibration setup. On the left, an illustration of a horizontal design, and on the right
the experimental setup [30].
The second type is a vertical design that uses a falling mass, which impacts onto the
force sensor mounted at the bottom. This design was implemented at NIM in China and
NIS in Egypt [47, 50]. The height of the release position of the mass can be varied to adjust
the force magnitude. The measurement principle is the same as of the aforementioned
horizontal design. The dynamic force generated by the falling mass body is given by the
product of the mass and time-dependent acceleration during impact.
3.2 Model-based dynamic force calibration
A significant challenge of the dynamic calibration of force sensors (the same applies also
to torque sensors) is the fact that they are always mechanically coupled to their environ-
ment on both sides. In contrast to, e. g., accelerometers, this environment influences the
dynamic behavior of the sensor and always needs to be taken into account. If the sensor
is placed into a different environment (e. g., in a calibration device for the calibration)
or the mechanical properties of the application change, the dynamic behavior of the
sensor may change, too.
If a transfer function is derived like described in Section 3.1.1, it is only valid in later
applications if coupled masses and their connection stiffnesses are the same as during
calibration.

86
౪
Th. Bruns et al.
A solution for the aforementioned issue of the influence of the mechanical environ-
ment can be a model-based calibration. In this case, the sensor is described by an appro-
priate mechanical model. During calibration, the model parameters for this model are
identified; see above.
The model usually chosen for force sensors resembles the mechanical design. The
most simple model is linear and time-invariant (LTI) and consists of two rigid masses
(base mass mB, top/head mass mH) connected by a spring k and a damper d in parallel.
Figure 7 illustrates the model in a calibration setup.
Figure 7: Illustration of the model of a force sensor mounted on a shaker, as shown in Figure 5. The sensor
is described by two masses connected by a spring and a damper.
This model leads to an ordinary differential equation system as follows:
M ̈x + D ̇x + Kx = L,
(19)
with the mass matrix M, damping matrix D, stiffness matrix K, and load vector L. The
excitations are found in the displacement vector x and its derivative equivalents
̇x
and ̈x.
Based on the mechanical design of the force sensor and of the measuring device,
different degrees of complexity of the sensor model and of the calibration device might
be required. The most simple approach is the aforementioned four parameter model of
the sensor. Sometimes it might be necessary to extend the sensor model to account for
compliant mounting bolts of the sensor, or other elasticities. In other cases, the mounting
of the mass bodies might be so compliant that an additional spring element is necessary.
In Figure 8, different models for the shaker-based sinusoidal calibration are shown with
the known parameters of the measuring device and the parameters to be identified dur-
ing the calibration. The same is given in Figure 9 for the shock force calibration.

Traceable calibration for the dynamic measurement of mechanical quantities
౪
87
Figure 8: Models used for parameter identification using sinusoidal excitation.
Figure 9: Models used for parameter identification using shock force excitation [30].
The model should always be chosen as simple (i. e., with as few parameters) as pos-
sible, an “overfitting” should be avoided. More parameters do not mean a more precise
result. On the contrary, if there are too many parameters to identify, the identification
becomes more difficult. This principle is also known as “Occam’s razor.” Additionally,
if there are too many “stiff” parameters (i. e., parameters with only little influence on
the behavior of a system), the identification of all parameters will be less stable. More
details can be found in [51, Chapter 5].

88
౪
Th. Bruns et al.
The model parameter identification for calibration setups with sinusoidal excita-
tion is carried out in the frequency domain. Based on the chosen model, the matrices of
the equation systems as given in equation (19) will have different sizes and will require
the motion quantities at different positions to be measured. Although the excitation is
required to be measured as displacement, velocity, and acceleration, in case of the sinu-
soidal excitation, these quantities can be derived from each other by simple calculation.
In case of a sinusoidal excitation, these different motion quantities can be expressed
as follows:
x(t) = ̂x eiωt,
̇x(t) = iω ̂x eiωt
or
̇x(t) = iω x(t)
respectively,
(20)
̈x(t) = −ω2 ̂x eiωt
or
̈x(t) = −ω2x(t).
From the equation system (19), different transfer functions can be defined. This
of course is dependent on the chosen model. With the most simple model assuming a
rigidly coupled sensor under test to both exciter and mass body and, therefore, with
only degree of freedom, transfer functions like the one presented in Section 1.4 will be
the result. In practice, at least a nonrigid mounting of the mass body is often required
to be incorporated in the model [37].
In general, the more complicated the model is, the more measuring positions need
to be acquired for the model parameter estimation. Due to technical restrictions, it is
not always possible to measure the acceleration directly below and above the sensor. In
these cases, it can be helpful to assume the output of the sensor UF to be proportional to
its compression or tension giving
UF(t) = ρ(xH(t) −xB(t))
(21)
with an unknown proportionality constant ρ, which adds as a parameter to identify.
The derived transfer functions then can be used for the parameter identification
using measurement data. The estimation of the parameter vector θ (consisting of all pa-
rameters to be identified) is carried out by minimizing the squared cost function K(ω, θ),
which is the difference of the model function G and the corresponding measurement
data Y giving
K(ω, θ) = (G(ω, θ) −Y(ω)) ⋅W
(22)
with an (optional) weighting matrix W.
The parameter identification for shock force calibration can be carried out in the
frequency domain or in the time domain. As the shock pulses are typically very short,
the frequency resolution is low after carrying out a discrete Fourier transform. This
resolution is directly proportional to the measuring time. Generally, it is advantageous
to carry out the parameter identification in the time domain if the excitation signals

Traceable calibration for the dynamic measurement of mechanical quantities
౪
89
cannot be chosen and/or the frequency domain representation is not optimal because
of the frequency resolution or leakage. More details on advantages and disadvantages
of the time or frequency domain identification can be found in [51, Chapter 3].
If the model parameters of a sensor were identified, they can be used to calculate
or model the behavior of the sensor in a later application. By principle, this requires a
similar knowledge about the components that are coupled in this specific application to
the sensor. It can require a lot of experiments or simulations to derive this information.
If the sensor will be used in frequently changing measurement setups, a proper deter-
mination of the properties of the mechanical environment might be not feasible for the
user.
3.3 In situ calibration without modeling
To overcome the issue of the demanding modeling of a dynamic force application, al-
ternative methods—which also have their limitations—have been developed. Here, we
give some examples of such approaches and their limitations. Fatigue testing of material
probes is carried out to determine the material properties. For this purpose, a load is pe-
riodically applied to a specimen in a so-called fatigue testing machine. Such a machine
consists of a stable frame, an exciter (hydraulic, electromagnetic, etc.), and clamping
mechanisms to mount the specimen. It is important to correctly adjust the applied dy-
namic force during fatigue testing to be able to correctly estimate the capabilities of the
specimen under testing. For this purpose, force sensors are installed in the machine to
measure the applied force. The results from those tests are then used to estimate the
lifetime of designed components.
Due to the dynamic excitation, the effective sensitivity of the force sensor can differ
from the static calibration value. The international standard ISO 4965 [21, 52] addresses
this issue. The approaches given in this standard differ from those of the model-based
calibration previously presented. Sheet 1 of the standard (ISO 4965-1) describes two ap-
proaches to tackle the deviation of the force sensor’s output at dynamic excitations:
1.
One replica test-piece will be equipped with strain gauges to measure the actual
force. A static calibration is used to determine the sensitivity of the test piece. In a
second step, dynamic measurements are carried out. The differences between the
output of the replica test piece and that of the sensor are calculated and compen-
sated for in subsequent tests. This approach is only valid for specimens of the same
stiffness or compliance as the replica test piece.
2.
A compliance envelope is calculated with two force sensors. One has a lower com-
pliance than the hardest specimen in use, and one has a higher compliance than the
softest specimen in use. The maximum deviations are determined in dynamic tests
and a compliance envelope is defined, in which these deviations are smaller than
1 %. Only within the compliance envelope, an operation is permitted.

90
౪
Th. Bruns et al.
The second sheet of the standard (ISO 4695-2 [21]) ensures that the conditioning electron-
ics and the data acquisition and indication comply with the requirements. An approach
to dynamically calibrate force sensors in situ was proposed by [53]; additional investiga-
tions of possible influences showed a successful implementation [54]. The idea is to use
an impact hammer as a transportable force reference. Impact hammers are hammers
equipped with a force sensor at the tip. If this force sensor is calibrated dynamically, it
can be carried around and be used to calibrate a force sensor in situ. Figure 10 illustrates
the calibration principle and shows an example measurement.
Figure 10: Dynamic calibration of a force sensor with a calibrated impact hammer, principle on the left,
application on the right [54].
Advantages of the approach are that the impact hammer and its conditioning elec-
tronics can be calibrated as a measurement chain and do not need to be assessed indi-
vidually. The impact hammer’s excitation bandwidth defines the calibration bandwidth.
The procedure is well suited for applications, at which one end of the force sensor is
accessible for the hammer impact, like crash walls or the measurement of wave im-
pacts [55]. The impulse that can be applied to the system to be calibrated is limited by
the impact hammer.
4 Dynamic torque calibration
Torque measurement is in many aspects similar to force measurement. The torque M
equals the cross-product of a location vector r and a vectorial force F giving

Traceable calibration for the dynamic measurement of mechanical quantities
౪
91
M = r × F,
(23)
more commonly denoted in scalar units as a force F acting on a lever arm r giving
M = r ⋅F.
(24)
Torque as a rotatory quantity is measured in many rotating shafts. When analyzing the
applications, a distinction not only between static and dynamic torque loads is neces-
sary, but also between rotating and nonrotating conditions. The sensors are either reac-
tion torque sensors, which are not suited for rotation, or shaft- and flange-type sensors
designed to operate also in rotating conditions.
The measurement principle of torque sensors is similar to force sensors (cf. Sec-
tion 3). Reaction torque sensors are mostly based on the piezoelectric [22] or on the
strain gauge measurement principle. Most of the shaft-type and flange-type sensors are
based on strain gauges; different mechanical designs for different applications [56]. For
dynamic applications, the manufacturers try to develop sensors with high torsional stiff-
ness. Other measurement principles also exist, but do not have high importance for dy-
namic measuring applications at the moment. More information on the different mea-
suring principles can be found in [25].
Sensors designed for rotating conditions need to transmit the measurement signals
from the rotating measuring element to some kind of receiver. For this purpose, passive
methods like slip rings have been available for many decades. Noncontact methods con-
sist of two sets of two coils each (one rotating, one stationary); one set of coils transfers
energy to the rotating components, while the other set receives the measurement sig-
nal. In the past, the transfer was passive (using transformers) or the torque signal was
transferred as a frequency modulated analogue signal. Today, the signal is often not only
conditioned on the rotating shaft, but also digitized. A digital torque data stream is then
transmitted to the stator.
As an example, let us consider engine test benches. The efficiency of internal com-
bustion engines can be determined by measuring the output torque M output and the
rotational speed n. To determine the efficiency, the mechanical output power P is de-
rived as follows:
P = n ⋅M,
(25)
and can be compared with the consumed energy, i. e., the amount of fuel used in a cer-
tain time. Due to its operation principle with many combustions in a short time, the
output torque of an internal combustion engine (ICE) changes rapidly over time. This
dynamic torque change can lead to problems if not taken into account. The dynamic
components can be significantly higher than the mean torque and, therefore, overload
the torque sensors until they may fail mechanically. Nevertheless, the state of the art
for calibrations of torque sensors used in engine test benches are still only static cal-
ibrations. The sensors are often mechanically oversized to account for the unknown

92
౪
Th. Bruns et al.
amount of superimposed dynamic torque components, and are partly only calibrated
for lower torque levels than the higher nominal load of the sensor, which increases the
safety margin for mechanical failure. In many industrial production processes, screw
connections are fastened with so-called impact and impulse wrenches. These wrenches
apply short torque impulses to fasten the screw connection, generated by mechanical
impact (impact wrenches) and by hydraulic pulses (impulse wrenches). Due to the iner-
tia of the tool, only a small amount (the shorter the pulse, the less) of the torque pulse is
absorbed by the operator, making these tools ergonomic. All measuring fastening tools
in production processes need to be calibrated according to ISO 9000. Up to now, no dy-
namic calibration procedures for reference torque sensors used for the calibration of
these fastening tools exist. Instead, statically calibrated reference sensors need to be
used [57, Appendix D].
4.1 Rotation and dynamic torque
Both torque measurements in engine test benches and impact wrenches deal with dy-
namic torque signals. While the sensor used for calibrating torque tools does not need
to be rotatable, the in-line measurement at the drive shaft in engine test benches re-
quires sensors designed for rotation. The output power can also be measured without a
rotating torque sensor by measuring the reaction torque of the brake.
The dynamic calibration of torque sensors is still under research. First proposals for
calibration devices were made by PTB in the early 2000s [58]. First measurement results
and concepts for the traceability were presented later [59, 60]. Recently, a new dynamic
torque calibration device was presented [61]. Meanwhile, other institutes also worked
on the dynamic calibration of torque sensors, e. g., the Brazilian NMI INMETRO [62, 63],
the Chinese CIMM [64], or Japan’s NMIJ [65]. The last mentioned approach from NMIJ
is unique and different from the others; it is based on the principle of a Kibble balance.
The formerly mentioned dynamic torque calibration devices are using the same mea-
surement principle based on Newton’s second law. The dynamic torque M(t) is defined
by the product of the mass moment of inertia J and the angular acceleration ̈φ(t) giving
M(t) = J ⋅̈φ(t).
(26)
This approach is similar to the dynamic calibration of force sensors but transferred to
rotational quantities.
The mechanical design of a dynamic torque calibration setup consists of a rotational
exciter (typically an electric motor of some sort) to which the sensor under test is con-
nected. On the other side of the sensor, a mass moment of inertia body in mounted.
Typically, this kind of setup requires additional coupling elements and bearings to con-
nect the components and to avoid parasitic forces and bending moments acting on the
sensor. The calibration devices can be designed as a horizontal or vertical arrangement
of the components. An example of a horizontal design is shown in Figure 11.

Traceable calibration for the dynamic measurement of mechanical quantities
౪
93
Figure 11: Dynamic torque calibration device at PTB [61].
4.2 Model-based calibration for torque measurements
Due to the similarities of the mechanical design and the measurement principle (cf. Sec-
tion 4), the model of a torque sensor can be made in analogy to that of a force sensor.
The model assumptions of a linear and time-invariant behavior are the same, too. A typ-
ical sensor model therefore consists of two mass moments of inertia elements (MMOI)
connected by a linear torsional spring and a torsional damper.
A schematic of a calibration device with a sensor as a model is depicted in Figure 12.
In order to be able to identify the model parameters, the calibration device needs to be
modeled as well. The model parameters of the calibration device need to be determined
prior to the model parameter identification.
This model leads to a system of ordinary differential equations in analogy to (19) for
the quantity force giving
J ̈φ + D ̇φ + Kφ = L,
(27)
with the mass moment of inertia matrix J, damping matrix D, stiffness matrix K, and
load vector L. The angular excitations are found in the angular displacement vector φ
and its derivative equivalents
̇φ and
̈φ.
The model chosen for the model-based calibration at PTB is also shown in Figure 12.
In the practical application, the model parameter identification for torque sensors
is more complex than for force sensors. This is due to several reasons:
Angle measurement Instead of the angular acceleration, a measured angle position is
often used to calculate the angular acceleration. The position of the angle measure-
ment can typically not be chosen as freely as an acceleration measurement position.
Model parameters of the calibration device For the determination of the model
parameters of the calibration device, additional experiments need to be set up.
Whereas in case of dynamic force calibrations the mass value can be easily de-
termined by weighing, the determination of the mass moment of inertia used in
dynamic torque calibrations is much more challenging and requires dedicated
experiments.

94
౪
Th. Bruns et al.
Figure 12: Illustration of components of the dynamic torque calibration device (left) and the mechanical
model (right) [66].
Limited options to modify the measurement device The model parameter identifi-
cation becomes much more robust if the masses (in case of force calibration) or
mass moments of inertia (torque calibration) can be modified. In this case, a well-
known “detuning” can be carried out. This can be implemented much more easily
for translatory quantities than for rotatory ones.
The model-based calibration approach of torque sensors, which was published in [66],
required a rather complex model. This was because of the mechanical design of the cali-
bration device and the limited options of the placement of the angle measuring devices.
To be able to identify the model parameters, not only the two measured rotational
quantities above and below the sensors were used to calculate two transfer functions,
but also the output of the sensor was used for this purpose assuming it to be proportional
to its torsion giving
UM(t) = ρ(φH(t) −φB(t)) = ρ ΔφHB(t),
(28)
with ρ as an unknown scaling factor. This scaling factor is an additional unknown pa-
rameter in the identification. The two derived transfer functions included all the un-

Traceable calibration for the dynamic measurement of mechanical quantities
౪
95
known parameters of the device under a test. These functions and their corresponding
measurement quantities are shown in Figure 13.
Figure 13: Derived transfer functions and corresponding measurement quantities [66].
With the model parameter identification, the mechanical properties of a sensor un-
der test will be identified. To do this properly, influences due to signal conditioning
and data acquisition need to be compensated. This can be done by calibrating the data
acquisition electronics and the signal conditioning amplifier separately. In contrast to
force sensors, which are typically passive sensors without integrated electronics, this
separation is difficult with torque sensors. The increasing use of integrated electron-
ics in the sensors requires a dynamic calibration of this electronics, which is not in-
tended by design by the manufacturers and would require direct access to the bridge
amplifier inputs. Strain gauge sensors are often sealed in order to reduce influences
due to environmental conditions, especially humidity. Moreover, the bridge amplifier
inputs are very sensitive to electromagnetic disturbances and, therefore, need to be
shielded.
This issue cannot be solved without changing the design of the sensors. A dynamic
calibration of the electronics during or prior to the assembly of the sensor might help in
this regard, but will not account for changes during the lifetime of the sensor.

96
౪
Th. Bruns et al.
Bibliography
[1]
ISO/TC 108. ISO 16063-11:1999 Methods for the calibration of vibration and shock transducers —
Part 11: Primary vibration calibration by laser interferometry. Standard, Geneva, CH, 1998.
[2]
ISO/TC 108. ISO 16063-21:2003 Methods for the calibration of vibration and shock transducers —
Part 21: Vibration calibration by comparison to a reference transducer. Standard, Geneva, CH, 2003.
[3]
T. Usuda, C. Weißenborn, and H.-J. von Martens. Theoretical and experimental investigation of
transverse sensitivity of accelerometers under multiaxial excitation. Meas. Sci. Technol., 15(5):896–904,
2004.
[4]
D. Sprecher and C. Hof. Primary accelerometer calibration by scanning laser Doppler vibrometry.
Meas. Sci. Technol., 31(6):065006, 2020.
[5]
A. Täubner, H. Schlaak, M. Brucke, and T. Bruns. The influence of different vibration exciter systems on
high frequency primary calibration of single-ended accelerometers. Metrologia, 47(1):58–64, 2009.
[6]
T. Bruns, A. Link, and A. Täubner. The influence of different vibration exciter systems on high
frequency primary calibration of single-ended accelerometers: II. Metrologia, 49(1):27–31, 2011.
[7]
L. Klaus, Th. Bruns, and H. Volkers. Calibration of bridge-, charge- and voltage amplifiers for dynamic
measurement applications. Metrologia, 52(1):72–81, 2015.
[8]
F. Blume, A. Täubner, U. Göbel, and T. Bruns. Primary phase calibration of laser-vibrometers with a
single laser source. Metrologia, 46(5):489–495, 2009.
[9]
ISO. ISO 266:1997 Acoustics – Preferred frequencies. Standard, Geneva, CH, 1997.
[10] A. Link, A. Täubner, W. Wabinski, Th. Bruns, and C. Elster. Calibration of accelerometers: determination
of amplitude and phase response upon shock excitation. Meas. Sci. Technol., 17(7):1888–1894, 2006.
[11]
A. Link, A. Täubner, W. Wabinski, Th. Bruns, and C. Elster. Modelling accelerometers for transient
signals using calibration measurements upon sinusoidal excitation. Measurement, 40(9):928–935,
2007.
[12] ISO/TC 108. ISO 16063-43:2015 Methods for the calibration of vibration and shock transducers —
Part 43: Calibration of accelerometers by model-based parameter identification. Standard, Geneva,
CH, 2015.
[13] H. Volkers and Th. Bruns. A method for high-shock accelerometer calibration comparison using a
2-DOF model. J. Phys. Conf. Ser., 1065:222013, 2018.
[14] H. Volkers, Th. Bruns, and G. P. Ostermeyer. A two-DOF model-based input prediction for high-shock
accelerometer calibration. Meas. Sci. Technol., 30(5):055001, 2019.
[15] T. Bruns and H. Volkers. Efficient calibration and modelling of charge amplifiers for dynamic
measurements. J. Phys. Conf. Ser., 1065:222005, 2018.
[16] H. Nozato, A. Ota, W. Kokuyama, H. Volkers, and Th. Bruns. A novel low-shock calibration method
using digital filter technique. In Proc. of the XXI IMEKO World Congress “Measurement in Research and
Industry”. IMEKO, Prague, Czech Rep., 2015.
[17]
DKD. Guideline DKD-R 3-2 Calibration of conditioning amplifiers for dynamic application. Guideline,
Bundesallee 100, 38116 Braunschweig, 2019.
[18] H. Volkers and Th. Bruns. The influence of source impedance on charge amplifiers. Acta IMEKO,
2(2):56–60, 2013.
[19] ISO/TC 164/SC 1. ISO 376:2011 Metallic materials – Calibration of force-proving instruments used for
the verification of uniaxial testing machines. Technical report, Geneva, Switzerland, June 2011.
[20] DKD Technical Committees Force and Acceleration and Materials Testing Machines. Dynamic
calibration of uniaxial force measuring devices and testing machines (basic principles): Guideline
DKD-R 3-10 Sheet 1. Technical report, Braunschweig, Germany, June 2017.
[21] ISO/TC 164/SC 4. ISO 4965-2:2012 Metallic materials – Dynamic force calibration for uniaxial fatigue
testing – Part 2: Dynamic calibration device (DCD) instrumentation. Technical report, Geneva,
Switzerland, July 2012.
[22] G. Gautschi. Piezoelectric Sensorics. Springer, Berlin, 2002.

Traceable calibration for the dynamic measurement of mechanical quantities
౪
97
[23] K. Hoffmann. An Introduction to Stress Analysis Using Strain Gages. Hottinger Baldwin Messtechnik,
Darmstadt, 1989.
[24] A. Bray, G. Barbato, and R. Levi. Theory and Practice of Force Measurement. Monographs in Physical
Measurement, Academic press, London, 1990.
[25] W. Göpel, J. Hesse, J. N. Zemel, H. H. Bau, N. F. de Rooij, and B. Kloeck. Sensors: A Comprehensive Survey
– Volume 7: Mechanical Sensors. VCH, Weinheim, 1994.
[26] ISO/TC 22/SC 36 Safety and impact testing. ISO 6487:2015 – Road vehicles – Measurement techniques
in impact tests – Instrumentation. Technical report, 2015.
[27] SAE Test Instrumentation Standards Comittee. J211/1: Instrumentation for Impact Test – Part 1 –
Electronic Instrumentation. Technical report, Warrendale, USA, March 2014.
[28] A. Sawla. Ein Beitrag zur Verringerung der Messunsicherheiten bei der dynamischen Werkstoff- und
Bauteilprüfung mit periodischen Kräften, 1979.
[29] R. Kumme. Untersuchung Eines Direkten Verfahrens Zur Dynamischen Kalibrierung von Kraftmeßgeräten:
Ein Beitrag Zur Verringerung Der Meßunsicherheit. Wirtschaftsverl. NW, Verl. für Neue Wiss,
Bremerhafen, 1996.
[30] M. Kobusch. Characterization of Force Transducers for Dynamic Measurements. PTB-Mitteilungen,
125(2):915928, 2015.
[31] R. Kumme. A new calibration facility for dynamic forces up to 10 kN. In Proc. of XVII IMEKO World
Congress, Dubrovnik, Croatia, page 4, 2003.
[32] L. Zhang, Y. Wang, L. Zhang, and E. P. Tomasini. Investigation of calibrating force transducer using
sinusoidal force. In Proc. of 9th International Conference on Vibration Measurements by Laser and
Non-Contact Techniques, Ancona (Italy), pages 395–401, 2010.
[33] N. Medina and J. de Vicente. Force sensor characterization under sinusoidal excitations. Sensors,
14(10):18454–18473, 2014.
[34] N. Vlajic and A. Chijioke. Traceable dynamic calibration of force transducers by primary means.
Metrologia, 53(4):S136–S148, 2016.
[35] C. Schlegel, G. Kieckenap, and R. Kumme. Application of a scanning vibrometer for the periodic
calibration of force transducers. In Proc. of XX IMEKO World Congress, Busan, Republic of Korea, page 6,
2012.
[36] C. Schlegel, G. Kiekenap, H. Kahmann, and R. Kumme. Mechanical influences in sinusoidal force
measurement. ACTA IMEKO, 4(2):57, 2015.
[37] C. Schlegel, G. Kieckenap, B. Glöckner, A. Buß, and R. Kumme. Traceable periodic force calibration.
Metrologia, 49(3):224–235, 2012.
[38] L. Zhang, Y. Wang, X. Yin, C. Schlegel, and R. Kumme. Comparison results between PTB and CIMM on
the force transducer calibration under sinusoidal loading. J. Phys. Conf. Ser., 1065:042019, 2018.
[39] Y.-K. Park, R. Kumme, and D.-I. Kang. Dynamic investigation of a binocular six-component
force-moment sensor. Meas. Sci. Technol., 13(8):1311–1318, 2002.
[40] Y.-K. Park, R. Kumme, D. Roeske, and D.-I. Kang. Column-type multi-component force transducers and
their evaluation for dynamic measurement. Meas. Sci. Technol., 19(11):115205, 2008.
[41] J. Nitsche, R. Kumme, and R. Tutsch. Dynamic characterization of multi-component sensors for force
and moment. J. Sens. Sens. Syst., 7(2):577–586, 2018.
[42] J. E. Nitsche. Statische und dynamische Untersuchung von Mehrkomponentensensoren für Kräfte und
Momente. PhD thesis, Technische Universität Braunschweig, Düren, 2019.
[43] R. Kumme, B. Glöckner, and Ch. Schlegel. A new facility for continuous and dynamic force calibration
with forces up to 100 kN. In Proc. of IMEKO 2010 TC3, TC5 and TC22 Conference, Pattaya, Thailand, pages
13–16, 2010.
[44] R. Kumme. Investigation of the comparison method for the dynamic calibration of force transducers.
Measurement, 23(4):239–245, 1998.
[45] Th. Bruns, R. Kumme, M. Kobusch, and M. Peters. From oscillation to impact: The design of a new
force calibration device at PTB. Measurement, 32(1):85–92, 2002.

98
౪
Th. Bruns et al.
[46] M. Kobusch, Th. Bruns, L. Klaus, and M. Müller. The 250 kN primary shock force calibration device at
PTB. Measurement, 46(5):1757–1761, 2013.
[47] M. Feng, Zh. ZhiMin, Zh. Yue, and Zh. Wei. Dynamic force calibration by impact excitation. EPJ Web
Conf., 77:00008, 2014.
[48] Th. Bruns and M. Kobusch. Impulse force calibration: Design and simulation of a new calibration
device. In Proc. 17th IMEKO TC3 Conference, Istanbul, Turkey, pages 85–91, 2017.
[49] X. Lu, Q. Zhai, C. Tu, H. Fan, and H. Hu. Calibration method of piezoelectric force sensor. J. Vib. Shock,
40(5):261–265, 2021.
[50] Sh. A. Gelany and G. M. Mahmoud. An investigation on using the falling mass technique for dynamic
force calibrations. In Metrology and Measurement Systems, 2021.
[51] J. Schoukens and R. Pintelon. Identification of Linear Systems: A Practical Guideline to Accurate Modeling.
Pergamon Press, Oxford, 1991.
[52] ISO/TC 164/SC 4. ISO 4965-1:2012 Metallic materials – Dynamic force calibration for uniaxial fatigue
testing – Part 1: Testing systems. Technical report, Geneva, Switzerland, July 2012.
[53] N. Vlajic and A. Chijioke. Traceable calibration and demonstration of a portable dynamic force transfer
standard. Metrologia, 54(4):S83–S98, 2017.
[54] M. Kobusch and L. Klaus. In-situ dynamic force calibration using impact hammers. ACTA IMEKO,
9(5):118, 2020.
[55] E. van de Bunt, J. Dekker, J. Scharnke, and F. Jaouën. Applying force panels for wave impact
measurements. Ocean Eng., 232:108857, 2021.
[56] R. Schicker and G. Wegener. Drehmoment richtig messen. Hottinger Baldwin Messtechnik, Darmstadt,
2002.
[57] DKD Technical Committees Force and Acceleration. Statische Kalibrierung von Kalibriereinrichtungen
für Drehmomentschraubwerkzeuge: Richtlinie DKD-R 3-8, 446336 bytes, 28 pages, September 2018.
[58] Th. Bruns. Sinusoidal torque calibration: A design for traceability in dynamic torque calibration. In
Proc. of XVII IMEKO World Congress, Dubrovnik, Croatia, page 4, 2003.
[59] C. Bartoli, M. F. Beug, Th. Bruns, C. Elster, T. Esward, L. Klaus, A. Knott, M. Kobusch, S. Saxholm, and
C. Schlegel. Traceable dynamic measurement of mechanical quantities: Objectives and first results of
this European project. Int. J. Metrol. Qual. Eng., 3(3):127–135, 2012.
[60] L. Klaus. Dynamic torque calibration. PTB-Mitteilungen, 125(2):572809, 2015.
[61] K. Leonard and M. Kobusch. A new dynamic torque calibration device at PTB. Measurement: Sensors,
18:100149, 2021.
[62] R. S. Oliveira, S. Winter, H. A. Lepikson. Th. Fröhlich, and R. Theska. A new approach to test torque
transducers under dynamic reference regimes. Measurement, 58:354–362, 2014.
[63] R. S. Oliveira, R. R. Machado, H. Lepikson, Th. Fröhlich, and R. Theska. A method for the evaluation of
the response of torque transducers to dynamic load profiles. ACTA IMEKO, 8(1):13, 2019.
[64] L. Zhang, Z. Y. Wang, and X. Yin. Research on new dynamic torque calibration system. In Proc. of
12th International A. I. VE. LA. Conference on Vibration Measurement by Laser and Noncontact Techniques:
Advances and Applications, Ancona, Italy, pages 090004-1–090004-6, 2016.
[65] M. Hamaji, A. Nishino, and K. Ogushi. Design of a new dynamic torque generation machine based on
the principle of Kibble balance. Measurement: Sensors, 18:100183, 2021.
[66] K. Leonard. Model parameter identification from measurement data for dynamic torque calibration –
measurement results and validation. ACTA IMEKO, 5(3):55, 2016.

V. Wilkens and M. Weber
Traceable measurements with dynamically
calibrated hydrophones
1 Introduction ultrasonics
Ultrasonic waves comprise more than 20000 mechanical stress or pressure cycles per
second. This is a highly dynamic physical process per definition, and dynamic proper-
ties need to be quantified during measurements. The dynamics of the field quantities are
still much slower than in optics, which offers the direct access to time resolved detection,
a prerequisite for the many technical pulse-echo and time-of-flight measurement imple-
mentations. Ultrasound in the kHz frequency range is largely applied in industry, for in-
stance for material cleaning and processing and in sonochemistry, whereas nondestruc-
tive testing and the prominent medical applications mostly use even higher frequencies
in the MHz range. Such medical applications comprise the nowadays widespread use of
sonography for imaging and diagnostics, as well as therapeutic applications like phys-
iotherapy and high intensity therapeutic ultrasound, for instance, for tumor ablation.
Propagation of MHz-ultrasonic waves through tissue enables highly resolved imaging
of opaque media as well as treatment of deeply located parts inside the body without
the need for surgical opening.
2 Ultrasound exposimetry
To ensure both, the safety for the patient as well as the efficiency of treatments, the
acoustic output of ultrasonic medical equipment needs to be determined before devices
can be marketed and subsequently be used on patients. Modern ultrasound scanners
offer a lot of modalities to not only determine anatomic images from inside the body
but to also provide spatially resolved information on movements, flow velocities, tissue
composition, elastic parameters, and others. A variety of ultrasonic signals with differ-
ent working frequencies, acoustic pressure amplitudes, pulse lengths, repetition rates,
and spatial scanning patterns is applied to support those modalities. In general, sonogra-
phy is considered a particularly safe imaging modality. However, a potential for thermal
and mechanical hazards exists if the natural tolerances of human tissue against sonica-
tion are exceeded, and some diagnostic modalities would produce stronger effects in
tissue than others. For instance, the determination of blood flow in the umbilical cord
requires longer pulse lengths and higher repetition rates than usual brightness mode
imaging of the anatomy of organs, and exposes a small region of tissue for the time of
the measurement instead of spatially scanning larger volumes. As the actual acoustic
output of a sonography device will depend on a large number of system settings, it is
https://doi.org/10.1515/9783110713107-004

100
౪
V. Wilkens and M. Weber
required that the system provides information on the monitor for the user. The acous-
tic output display according to IEC 60601-2-37:2007 uses mechanical and thermal indices
for this purpose [1]. Along with these numbers the sonographer should also consider ex-
isting guidelines for exposure duration [2]. In particular, the examination time should
be kept short if high thermal index values are displayed, for instance, by freezing the
image which deactivates the acoustic output and allows the tissue to cool down before
exposure might be activated again for further assessments.
3 Basic ultrasonic exposure quantities
Acoustic output declarations for medical ultrasonic equipment either in form of index
data for diagnostic machines or in other forms to specify the acoustic fields of thera-
peutic systems, are all based on acoustic field measurements where the treatment head
emits into water as a standard propagation medium. The most important physical quan-
tities to be measured are:
1.
the time averaged emitted acoustic power P,
2.
the time dependent acoustic pressure waveform p(t) including peak compressional
pc and peak rarefactional pressure pr and acoustic working frequency f ,
3.
the local temporal average ultrasonic intensity I,
4.
geometrical dimensions of the acoustic beams.
The time averaged overall acoustic power emitted from an ultrasonic transducer (1.) is
a relevant safety parameter mainly regarding the thermal effect of ultrasound in tissue.
The preferred measurement method uses radiation force balances [3]. The ultrasonic
beam is directed toward an appropriately designed absorber, which is mechanically
connected with a sensitive balance. The radiation force is determined during switch-
ing on and off of the ultrasonic source from the change in weight measured with the
balance. For this type of measurement, it is actually not necessary to resolve the high
ultrasonic frequency in the detection process. For all the other basic quantities (2. to 4.),
measurements providing temporal and spatial resolution of the acoustic field quanti-
ties are required. The ultrasonic waves emitted into water are characterized through
scanning with piezoelectric local pressure receivers, so called hydrophones [4]. From
the measured pressure-time waveforms, direct pressure parameters are derived that
are relevant for mechanical hazard. Further parameters like local intensity parameters
and beam dimensions all relevant for the local heating hazard are also derived from the
hydrophone-based acoustic pressure measurements [5].
4 Ultrasonic hydrophones
Hydrophones for the measurement of medical ultrasonic fields use piezoelectric receiv-
ing elements to convert the ultrasonic pressure into signal voltage. While piezoceramics

Traceable measurements with dynamically calibrated hydrophones
౪
101
are still in use, most hydrophones for broadband detection in the MHz frequency range
are based on PVDF (polyvinylidenefluoride) films, which offers lower acoustic impe-
dence mismatch with the sound propagation medium water. Different types of PVDF
hydrophones like needle-type, capsule-type, and membrane type offer different advan-
tages for specific measurement conditions and tasks. While needle- and capsule-type
hydrophones offer most flexibility and practical advantages for large scale water tank
scanning applications, membrane hydrophones provide more homogeneous frequency
responses, and are often used as reference receivers. Figure 1 shows an example of a
membrane hydrophone with differential electrode design and an integrated preampli-
fier that can be used for ultrasound frequencies up to 100 MHz and even beyond.
Figure 1: Example of an ultrasonic membrane hydrophone (PTB RS072) of differential electrode design
[6]. The small sensing element in the center of the ring is formed through spot-poling at the overlap of the
front (golden) and the rear (chrome) electrode and has a diameter of 0.2 mm. The larger ground electrodes
are for noise reduction. A preamplifier is located inside the outer ring.
To address large detection bandwidths and small effective receiving areas— these
should be small compared to the acoustic wavelength to keep the spatial averaging of the
acoustic pressure reasonable—it is necessary to use short passive electrical paths. Thus,
a preamplifier and signal cable driver electronics are often located close to the sensing
element inside the hydrophone system. The frequency dependent transfer function of
such a hydrophone assembly, usually termed hydrophone sensitivity, relies on several
mechanical and electronical design choices and material parameters. Therefore, to en-
able precise and reliable acoustic pressure measurements, ultrasonic hydrophones need
to be calibrated individually, and recalibrated periodically after appropriate periods of
time.

102
౪
V. Wilkens and M. Weber
5 Hydrophone calibration and voltage-to-pressure
transfer functions
Hydrophone calibration services are offered by a number of national metrology insti-
tutes and by other calibration laboratories, for instance, run by hydrophone manufac-
turers [7–14]. Some metrology institutes hold a primary realization of the measurand
of ultrasound pressure as well. Primary calibration provides direct traceability to SI
unit quantities, while secondary calibration methods allow the comparison of two hy-
drophones within a substitution arrangement. Different calibration techniques using
a variety of ultrasonic excitation pressure waveforms comprising different pressure
amplitude ranges and frequency compositions have been proposed and applied over
the past decades. Such excitations include single-frequency tonebursts and swept fre-
quency tonebursts in the kPa amplitude range of quasilinear acoustics as well as higher
amplitude burst [7] and impulse excitations including nonlinear propagation [15]. Guid-
ance on the application of different techniques is provided in IEC 62127-2 [16]. Tradition-
ally and for technical reasons, hydrophone calibrations have been performed mostly
as magnitude or modulus calibrations only, in the past. However, calibration methods
were further developed through the years to meet the demands of calibrations at higher
frequencies and with reduced uncertainties and to provide calibration data comprising
both modulus and phase [17–21]. Complex-valued calibration data are particularly im-
portant for deconvolution applications when characterizing broadband ultrasonic fields
[21–27]. A calibration result for the broadband membrane hydrophone (PTB RS072) de-
picted in Figure 1 obtained by a primary calibration technique [20] is shown in Figure 2.
A relatively flat response can be observed between 1 MHz to 40 MHz and an increase of
sensitivity up to the thickness mode resonance of the sensing element located at about
70 MHz followed by a high frequency roll off. The thickness mode resonance frequency
depends on the thickness of the sensing element, which is 11 µm in this example. For
an unbacked hydrophone like this, it appears at the frequency corresponding to half
an acoustic wavelength in the material fitting to the element thickness. For hydrophone
designs including an absorbing backing material, the resonance is at a quarter of the
wavelength, e. g., the resonance frequency is lower for the same PVDF foil thickness.
Other hydrophone designs like needle-type hydrophones usually provide more sensi-
tivity variations than membrane hydrophones, particularly in the low MHz frequency
range due to the stronger impact of radial resonances and diffraction effects of such
probes.
6 Hydrophone measurements—signal
deconvolution
For acoustic pressure waveform measurements, the output voltage uL(t) of a hy-
drophone is acquired using an oscilloscope. For a pure, single frequency waveform,

Traceable measurements with dynamically calibrated hydrophones
౪
103
Figure 2: Broadband calibration data of a hydrophone depicted as logarithmic sensitivity level or modu-
lus of the sensitivity (upper plot) and corresponding phase response; uncertainty ranges are shown for a
coverage factor of k = 2 for 95 %.
the voltage-time signal represents the pressure-time waveform at the position of the
sensitive element in the acoustic field. The actual pressure data p(t) can be determined
by scaling the voltage signal with the modulus sensitivity of the hydrophone |ML| as
read from the calibration data at the frequency of the waveform, the acoustic working
frequency fawf:
p(t) =
uL(t)
|ML(fawf)|
(1)
If the hydrophone would provide the same sensitivity for all frequencies, the same
conversion method could be applied to waveforms comprising more than one frequency

104
౪
V. Wilkens and M. Weber
as well. But as outlined before, ultrasonic detection always suffers more or less from spe-
cific internal resonance effects of sensing elements as well as from outer reflection and
diffraction of the acoustic waves impinging on the receivers. Thus, transfer functions
are affected by these phenomena and will show variation with frequency rather than
being constant. Nevertheless, for the vast majority of hydrophone measurements the
conversion by scaling has been performed by scaling so far for all types of waveforms.
Corrections may then have been addressed by empirical methods or the imperfections
were attributed by increased uncertainty estimates. The former IEC TS 61220 [28] pub-
lished in 1993 provided such an empirical method to remove the signal overshoot of
nonlinearly distorted waveforms to avoid large overestimation of peak compressional
pressures. In 2007, the succeeding (and 2022 updated) standard IEC 62127-1 [4] already
replaced this method with instead recommending waveform deconvolution according
to
p(t) = ℱ−1[ UL(f )
ML(f )]
(2)
where ℱ−1 denotes the inverse Fourier transform and UL(f ) is the Fourier transform
result of uL(t), for specified measurement situations where the so-called narrowband
approximation of equation (1) would not hold. Recognizing wider availability of broad-
band and complex-valued calibration data over the years, the second edition of this stan-
dard [4] changes the recommendation for deconvolution toward a requirement. Only
in specified cases with low impact of nonlinear propagation or sufficient flatness of the
hydrophone frequency response, the narrowband approximation can still be applied.
However, such a requirement needed to be accompanied by more detailed description
of the deconvolution method as a prerequisite for broader application by many users. To
further support the method and its standardization, a calculation scheme including step-
by-step guidance and examples were developed as a deconvolution tutorial available
through online publication [29]. In addition, the determination of output parameter un-
certainties when using waveform deconvolution needed specific attention beforehand
[30–32], since commonly used methods possible with the narrowband approximation,
e. g., when applying just a single hydrophone sensitivity factor, cannot directly be fol-
lowed in the same way with this method.
7 Tutorial for waveform deconvolution
A tutorial was developed and published, to help users with the practical application of
waveform deconvolution. It uses freeware software tools only and comprises all nec-
essary procedures for deconvolution and associated uncertainty estimation. Figure 3
shows the schematic workflow of the method. Some details of the various steps are dis-
cussed in the following subclauses.

Traceable measurements with dynamically calibrated hydrophones
౪
105
Figure 3: Schematic workflow of signal deconvolution for an ultrasonic hydrophone measurement.
The tutorial provides all mathematical procedures and functions and makes use
of the PyDynamics package [33]. The script can be run online, or on a local computer
after download according to the instructions provided at the beginning. Hydrophone
calibration data are provided for a set of four hydrophones of different types as exam-
ples. To keep differences caused by spatial averaging effects small, hydrophones offering
small effective element diameters in the range from 0.11 mm to 0.14 mm were chosen.
Ultrasonic waveforms of an ultrasonic diagnostic device were measured by each of the
hydrophones. The device was used in two different modes. The first mode used was the
motion (M) mode which produces waveforms that are similar to the common brightness
(B) mode, but without scanning the ultrasonic beam. This mode uses a short pulse with
only a few cycles. The other mode was the pulse Doppler (pD) mode, which is used to
investigate the flow of liquids. For the Doppler mode, a burst signal with several cycles is
produced. Both modes were operated at two different frequencies, approximately 3 MHz
and approximately 7 MHz. The signals at the lower acoustic work frequency were emit-
ted from a convex array, and the signals at the higher acoustic work frequency from a
linear array. Settings were chosen for the acoustic work frequency, the output power, the
focal length, the region of interest, and the pulse repetition frequency, which produced
the maximum spatial-peak temporal-average intensity of the diagnostic machine with
the respective transducer for the particular mode. The waveforms were acquired at the
position of the spatial-peak temporal-average intensity. Altogether, the data sets com-
prise 16 different combinations, e. g., measurement situations that directly can be inves-
tigated. Of course, the functions of the tutorial can also be applied to own hydrophone
and waveform data.

106
౪
V. Wilkens and M. Weber
7.1 Input data
As can be seen in Figure 2, the tutorial needs data input for hydrophone sensitivity and
for measured voltage signals including information on associated uncertainties. The
complex-valued hydrophone calibration data were determined in the frequency range
from 0.1 MHz to 100 MHz by means of primary [20] or secondary calibration [34]. The
hydrophone sensitivity level, e. g., the modulus of the transfer function in logarithmic
scales is depicted in Figure 4 including calibration uncertainties for the four example
hydrophones.
Figure 4: Hydrophone sensitivity level for four hydrophones of different type.
In general, the combination of sampling interval and number of points acquired
determines the frequency interval of the spectrum of the measured signal according to
the equation:
Δf =
1
Δt × N
(3)
where Δf , Δt, and N denote the frequency increment, the time increment, and the num-
ber of data points, respectively. Frequently, it is found that this frequency increment
of the measured data differs from that supplied between consecutive points in the hy-
drophone calibration data. To ensure that calibration data is available at the appropriate
frequency points, it may be necessary to interpolate values at the required spacing from
the calibration data.
For the deconvolution calculation according to equation (2), the data sets of the volt-
age spectrum UL(f ) and the sensitivity ML(f ) need to cover the same frequency ranges

Traceable measurements with dynamically calibrated hydrophones
౪
107
from zero to the Nyquist frequency of the hydrophone measurement. For instance, for
a typical waveform sample rate of 500 MS/s, data is needed up to 250 MHz. Therefore,
extrapolation of ML(f ) may be used to cover frequencies f outside the calibration range
available if necessary. A convenient way is to start with extrapolating the modulus data
first and to adjust the phase data in a second step using equation (4) below. This will
assure consistent complex-valued response extrapolation, including the phase value be-
ing zero at zero frequency as is necessary for any real-valued time domain impulse re-
sponse [24]. The modulus extrapolation should follow the trend indicated by the calibra-
tion range limit region, for instance, if some thickness mode resonance behaviour can
be observed at the high frequency end a decreasing behavior with frequency may be
estimated from that. Of course, the sensitivity cannot become zero. This would induce
singularities in the deconvolution because some noise can be expected in the voltage
spectrum even at frequencies not transduced by the hydrophone due to zero sensitivity.
Several investigations have shown that rather simple extrapolation schemes work well
for most applications, e. g., lead to reasonable deconvolved waveform results. For mem-
brane hydrophones, using the calibration data point modulus at the lowest frequency as
constant value down to zero and using the calibration data point modulus at the highest
frequency as constant value above the calibration range may be sufficient [24, 26, 27, 35]
and can be applied as standard procedure. The tutorial follows this standard procedure
for all hydrophones.
However, if the preamplifier is known to cause a significant roll-off at low frequen-
cies, either from manufacturers specifications or from electrical measurements, such
sensitivity decrease should be accounted for in obtaining ML(f ). For needle type hy-
drophones, a decreasing sensitivity toward low frequencies may be expected due to
the impact of diffraction at the sensor tip. Here, decreasing sensitivity modulus func-
tions show good results [23]. If available, more comprehensive hydrophone frequency
response modeling may be used for the purpose of extrapolation. Relatively simple sec-
ondary impulse calibration methods [34, 36] can also be applied by the hydrophone user
to extrapolate sensitivity data reasonably, as can measurements of similar units of the
same design.
An alternative approach to measuring hydrophone phase response is the compu-
tation of phase response data from modulus response data. A minimum phase system
can be assumed for some hydrophones, which allows an estimation of the frequency de-
pendent phase response using, e. g., Hilbert-transform methods or iterative phase signal
reconstruction techniques [19, 37, 38]. A straightforward easy-to-implement method of
calculating the discrete phase response data arg M(fm) in rad from modulus response
data for minimum phase systems is provided by the Bode gain-phase relation formu-
lation [39], which can be written for problems with discrete and uniform frequency
intervals as
arg M(fm) = 2fm
π
N/2
∑
n=0
ln(|M(fn)|/|M(fm)|)
f 2
n −f 2
m
Δf
(4)

108
౪
V. Wilkens and M. Weber
where n and m run from 0 to N/2, n
̸= m, N denotes the number of time signal data
points (resulting in N/2 + 1 frequency domain data points in the single-sided spectrum),
fn and fm denote discrete frequencies, and Δf is the constant frequency increment, e. g.,
Δf = fn+1 −fn, respectively. The methods of phase calculation from modulus responses
may also be helpful when used in combination with measured hydrophone phase data to
correct the phase calibration data for linear-with-frequency terms by this comparison.
Furthermore, it may be used to adequately extrapolate the measured data below and
above the experimentally available frequency ranges by assuming reasonable modulus
data for that frequency ranges first, and then calculating the suitable phase response
extrapolation with equation (4).
The tutorial provides two alternatives: Either using the hydrophone phase response
data as determined through calibration, or using equation (4) to determine phase data
from sensitivity modulus data. Figure 5 shows the modulus of the inter and extrapolated
calibration data of a needle-type hydrophone. The example described herein refers to
data set 4 of the tutorial. Extrapolation was performed for this example below 1 MHz
to 0 MHz and beyond 50 MHz up to 250 MHz. The corresponding phase response data
determined from those modulus data using equation (4) is depicted in Figure 6. The
tutorial offers the calculation of phase uncertainties from the modulus uncertainties
as well if the phase response calculation option is chosen. Both, modulus and phase
response uncertainties are then used in the further uncertainty determination for the
deconvolved waveforms.
Figure 5: Modulus of a needle-type hydrophone transfer function as determined by calibration and inter
and extrapolations.

Traceable measurements with dynamically calibrated hydrophones
౪
109
Figure 6: Phase of a needle-type hydrophone transfer function as determined from modulus data shown in
Figure 5 using the Bode formula.
The hydrophone measurement voltage data are imported in the tutorial as single
column list of values representing uL(t) at equal steps in time. To each data point of the
measurement, an uncertainty should be assigned. In a simple (but typical) case, the un-
certainty may be estimated for each point by means of the quantization uncertainty of
the instrument as an upper bound. Furthermore, the additional contribution of a possi-
ble scaling error should be taken into account. The quantization error may be assumed
to have a rectangular distribution. It is calculated by means of the full range of measure-
ment and by the number of bits of the AD converter 2Δa = Ufullrange/2n. This distribution
can be transferred into a standard deviation 2Δa : ux = Δa/√3 that will be used in later
uncertainty calculations. For other distributions, the value needs to be corrected. The
conversion factors can be found in the literature [40]. The uncertainty vector is calcu-
lated from this value. If more information is known about the uncertainty at each time
step—derived, for instance, from a separate voltage calibration measurement of the os-
cilloscope, then this vector can be altered and all the information should be used for
further calculation. The preferred way is to determine the uncertainty experimentally.
The hydrophone is connected to the oscilloscope (as in the waveform measurements).
The oscilloscope has the same settings (voltage resolution, sample rate, number of aver-
ages, and so on) as during the acquisition of the waveform. But this time, no ultrasonic
signal is transmitted, so that only the noise of the hydrophone (together with the noise of
the oscilloscope) is present. From this data, the standard deviation from the mean value
(voltage offset) can be calculated and be used as the uncertainty of the signal voltages. In
addition, the uncertainty of the voltage scale itself should be determined by a separate
calibration of the oscilloscope.

110
౪
V. Wilkens and M. Weber
7.2 Deconvolution of waveforms
Deconvolution is performed using the function from the GUM2DFT package [30, 33] sup-
plied with PyDynamic. The Fourier-transformed time-domain voltage signal of the hy-
drophone measurement is the numerator and the hydrophone frequency response is the
denominator in equation (2). The spectrum of the measured signal corrected for the fre-
quency weighting of the hydrophone is then transformed from the frequency domain
to the time domain through inverse Fourier transformation. Figure 7 shows as exam-
ple the deconvolved pressure waveform for 3 MHz M-mode operation measured with a
needle-type hydrophone compared with the waveform obtained by scaling according to
equation (1).
Figure 7: Deconvolved pressure waveform for 3 MHz M-mode operation measured with a needle-type
hydrophone compared with waveform obtained by scaling.
For the deconvolution, hydrophone calibration modulus data were used from 1 MHz
to 50 MHz with constant value extrapolation below and beyond this range (Figure 5) and
phase response data were determined from modulus data (Figure 6). Due to the rather
strong variations of the sensitivity for this needle-type hydrophone large deviations are
obtained between the deconvolved and the scaled pressure waveform. Typical signal
overshoot of the peak compressional part of the waveform is removed and the peak
compressional pressure obtained by deconvolution is much more realistic and compa-
rable to the corresponding result obtained with the other hydrophones offering more
homogeneous frequency responses. The peak rarefactional pressure is also affected, but

Traceable measurements with dynamically calibrated hydrophones
౪
111
here the deconvolution leads to an increase. Again, the deconvolved result is in closer
agreement with the corresponding results of the other hydrophones.
7.3 Regularization filtering
To avoid excessive additional high frequency noise in the deconvolved waveforms, reg-
ularization filtering may be necessary. Such noise can arise from low hydrophone sensi-
tivity (at high frequencies) and from the Gibbs phenomenon. Appropriate suppression
may be achieved by low-pass filtering of the pressure pulse spectrum prior to the back
transformation to the time domain:
p(t) = ℱ−1(LP(f ) UL(f )
ML(f ))
(5)
On the other hand, any additional low-pass filtering causes additional effective lim-
itations of the detection bandwidth and, in particular, peak compressional parts of non-
linearly distorted ultrasonic waveforms incorporating high frequency components may
possibly be cut.
Different numerical low-pass filters LP(f ) can be used for regularization. A stan-
dard low-pass filter, a low-pass filter with critical damping and a Bessel filter were im-
plemented in the tutorial, as well as the option of not filtering. Other filter customized
functions may be added, if needed.
7.4 Regularization uncertainty estimation
In order to estimate the additional uncertainty that is introduced by the regularization
filtering, the upper-bound function method described in [31] is applied. By means of this
method, the impact of the induced systematic error is investigated quantitatively. This
is done by considering a continuous upper-bound function in the frequency domain
for the pressure modulus spectrum, using an approach with a simple basic function,
which has one parameter only. Prior knowledge is included (such as the monotonous
decrease of the spectral components with increasing frequency—as can be expected for
nonlinearly distorted acoustic pulse waveforms—and the typical noise at high frequen-
cies that differs from the contribution of the signal). For the uncertainty estimation, in-
formation is required about the signal at all frequencies, even if this information cannot
be obtained by measurements. For that reason, it is necessary to carry out a signal ap-
proximation. In the publication of Eichstaedt and Wilkens [31], a wavelet-like approach
was used. This is rather a simple approximation, for which no additional knowledge
is necessary. On the other hand, the model is rather conservative and may overesti-
mate the uncertainty. Better models for the approximation might be chosen. Figure 8

112
౪
V. Wilkens and M. Weber
Figure 8: Deconvolved pressure waveform for 3 MHz M-mode operation measured with a needle-type
hydrophone including regularization and uncertainty (k = 2).
shows the same example as Figure 7 but as final result including the regularization fil-
tering using the standard low-pass filter with −3 dB cut-off frequency set to 100 MHz, as
well as the overall uncertainty of the pressure waveform determined with the tutorial
script.
7.5 Reference data sets
To enable a comparison of the waveforms obtained by deconvolution using the tutorial
with the results of other implementations, a set of results was stored for reference in the
results folder for download. Furthermore, the example parameters used for those evalu-
ations are summed up in a table at the end of the script for all 16 hydrophone waveform
combinations along with the ultrasonic parameter results like peak compressional, peak
rarefactional pressure, and pulse-pressure-squared integral ppsi, which is the basis for
local intensity parameters, all including the associated uncertainties (k = 1). Table 1
shows the data of the first 5 of the 16 examples. The uncertainties include the—often
conservative—estimation of the contribution from regularization. This compilation of
results is meant to support quick comparison when varying the calculation parameters
like regularization bandwidth or calibration data ranges extrapolated as well as valida-
tion purposes for own deconvolution implementations.

Traceable measurements with dynamically calibrated hydrophones
౪
113
Table 1: Part of measurement examples, evaluation settings, and acoustic output parameter results stored
with the deconvolution tutorial as reference data.
Number (i)
1
2
3
4
5
Mode
M
M
M
M
pD
Frequency
3 MHz
3 MHz
3 MHz
3 MHz
3 MHz
Hydrophon
Membrane
MH44
Membrane
MH46
Capsule
1704
Needle
1434
Membrane
MH44
Calibration range
1 MHz to
60 MHz
1 MHz to
100 MHz
0.1 MHz to
50 MHz
1 MHz to
50 MHz
1 MHz to
60 MHz
amplitude
calibration only
yes
yes
no
yes
yes
Bode equation
yes
yes
no
yes
yes
filter type
low-pass
low-pass
low-pass
low-pass
low-pass
cut-off fc
100 MHz
100 MHz
100 MHz
100 MHz
120 MHz
pc/MPa
5.62 ± 0.12
5.02 ± 0.13
5.30 ± 0.10
5.33 ± 0.11
3.38 ± 0.08
pr/MPa
2.63 ± 0.12
2.51 ± 0.13
2.57 ± 0.10
2.54 ± 0.11
1.10 ± 0.08
ppsi/kPa2s
1.637 ± 0.016
1.572 ± 0.016
1.600 ± 0.060
1.639 ± 0.025
2.618 ± 0.017
Bibliography
[1]
IEC. IEC 60601-2-37:2007 Medical electrical equipment - Part 2-37: Particular requirements for the
basic safety and essential performance of ultrasonic medical diagnostic and monitoring equipment.
International Standard, 2007.
[2]
G. R. Harris, C. C. Church, D. Dalecki, M. C. Ziskin, and J. E. Bagley. Comparison of thermal safety
practice guidelines for diagnostic ultrasound exposures. Ultrasound Med. Biol., 42:345–357, 2016.
[3]
IEC. IEC 61161:2013 ultrasonics – power measurement – radiation force balances and performance
requirements. International Standard, 2013.
[4]
IEC. IEC 62127-1:2022 Ultrasonics – hydrophones – part 1: Measurement and characterization of
medical ultrasonic fields. International Standard, 2022.
[5]
IEC. IEC 62359 Ultrasonics – field characterization – test methods for the determination of thermal
and mechanical indices related to medical diagnostic ultrasonic fields. International Standard, 2010.
[6]
V. Wilkens and W. Molkenstruck. Broadband PVDF membrane hydrophone for comparisons of
hydrophone calibration methods up to 140 MHz. IEEE Trans. Ultrason. Ferroelectr. Freq. Control,
54(9):1784–1791, 2007.
[7]
D. R. Bacon. Primary calibration of ultrasonic hydrophones using optical interferometry. IEEE Trans.
Ultrason. Ferroelectr. Freq. Control, 29(2):152–161, 1982.
[8]
C. Koch and W. Molkenstruck. Primary calibration of hydrophones with extended frequency range 1
to 70 MHz using optical interferometry. IEEE Trans. Ultrason. Ferroelectr. Freq. Control, 46(5):1303–1314,
1999.
[9]
G. Ludwig and K. Brendel. Calibration of hydrophones based on reciprocity and time delay
spectrometry. IEEE Trans. Ultrason. Ferroelectr. Freq. Control, 35(2):168–174, 1988.
[10] Y. Matsuda, M. Yoshioka, and T. Uchida. Primary calibration of hydrophones up to 40 MHz in
ultrasonic far-field using optical interferometry. Proc. Symp. Ultrason. Electron., 34:403–404, 2013.
[11]
R. C. Preston, S. P. Robinson, B. Zeqiri, T. Esward, P. N. Gélat, and N. D. Lee. Primary calibration of
membrane hydrophones in the frequency range 0.5 MHz to 60 MHz. Metrologia, 36:331–343, 1999.
[12] E. G. Radulescu, J. Woicik, P. Lewin, and A. Nowicki. Calibration of ultrasonic hydrophone probes up to
100 MHz using time gating frequency analysis and finite amplitude waves. Ultrasonics, 41(4):247–254,
2003.

114
౪
V. Wilkens and M. Weber
[13] R. A. Smith and D. R. Bacon. A multiple-frequency hydrophone calibration technique. J. Acoust. Soc.
Am., 87(5):2231–2243, 1990.
[14] P. Yang, G. Xing, and L. He. Calibration of high-frequency hydrophone up to 40 MHz by heterodyne
interferometer. Ultrasonics, 54(1):402–407, 2014.
[15] M. Weber and V. Wilkens. A comparison of different calibration techniques for hydrophones used
in medical ultrasonic field measurement. IEEE Trans. Ultrason. Ferroelectr. Freq. Control, 68:1919–1929,
2021.
[16] IEC. IEC 62127-2 Ultrasonics – hydrophones – part 2: Calibration for ultrasonic fields up to 40 MHz.
International Standard, 2007.
[17]
M. P. Cooling and V. F. Humphrey. A nonlinear propagation model-based phase calibration technique
for membrane hydrophones. IEEE Trans. Ultrason. Ferroelectr. Freq. Control, 55(1):84–93, 2008.
[18] C. Koch. Amplitude and phase calibration of hydrophones by heterodyne and time-gated time-delay
spectrometry. IEEE Trans. Ultrason. Ferroelectr. Freq. Control, 50(3):344–348, 2004.
[19] K. A. Wear, P. M. Gammell, S. Maruvada, Y. Liu, and G. R. Harris. Time-delay spectrometry
measurement of magnitude and phase of hydrophone response. IEEE Trans. Ultrason. Ferroelectr. Freq.
Control, 58(11):2325–2333, 2011.
[20] M. Weber and V. Wilkens. Using a heterodyne vibrometer in combination with pulse excitation for
primary calibration of ultrasonic hydrophones in amplitude and phase. Metrologia, 54(4):432–444,
2017.
[21] V. Wilkens and C. Koch. Amplitude and phase calibration of hydrophones up to 70 MHz
using broadband pulse excitation and an optical reference hydrophone. J. Acoust. Soc. Am.,
115(6):2892–2903, 2004.
[22] A. M. Hurrell. Voltage to pressure conversion: are you getting ’phased’ by the problem? J. Phys. Conf.
Ser., 1(1):57, 2004.
[23] A. M. Hurrell and S. Rajagopal. The practicalities of obtaining and using hydrophone calibration data
to derive pressure waveforms. IEEE Trans. Ultrason. Ferroelectr. Freq. Control, 64(1):126–140, 2017.
[24] K. A. Wear, P. M. Gammell, S. Maruvada, Y. Liu, and G. R. Harris. Improved measurement of acoustic
output using complex deconvolution of hydrophone sensitivity. IEEE Trans. Ultrason. Ferroelectr. Freq.
Control, 61(1):62–75, 2014.
[25] K. A. Wear, Y. Liu, P. M. Gammell, S. Maruvada, and G. R. Harris. Correction for frequency-dependent
hydrophone response to nonlinear pressure waves using complex deconvolution and rarefactional
filtering: application with fiber optic hydrophones. IEEE Trans. Ultrason. Ferroelectr. Freq. Control,
62(1):152–164, 2015.
[26] M. Weber and V. Wilkens. HIFU waveform measurement at clinical amplitude levels: primary
hydrophone calibration, waveform deconvolution and uncertainty estimation. In IUS 2017 IEEE
International Ultrasonics Symposium, Washington DC, IEEE, 2017.
[27] V. Wilkens, S. Sonntag, and O. Georg. Robust spot-poled membrane hydrophones for measurement
of large amplitude pressure waveforms generated by high intensity therapeutic ultrasonic
transducers. J. Acoust. Soc. Am., 139(3):1319–1332, 2016.
[28] IEC. IEC 61220 Ultrasonics – fields – guidance for the measurement and characterization of ultrasonic
fields generated by medical ultrasonic equipment using hydrophones in the frequency range 0,5 MHz
to 15 MHz (meanwhile withdrawn technical specification). Technical Specification, 1993.
[29] M. Weber and V. Wilkens and S. Eichstädt. Tutorial for the deconvolution of hydrophone
measurement data. https://doi.org/10.5281/zenodo.4012242 2020.
[30] S. Eichstädt, V. Wilkens, A. Dienstfrey, P. Hale, B. Hughes, and C. Jarvis. On challenges in the
uncertainty evaluation for time-dependent measurements. Metrologia, 4(53):S125, 2016.
[31] S. Eichstädt and V. Wilkens. Evaluation of uncertainty for regularized deconvolution: A case study in
hydrophone measurements. J. Acoust. Soc. Am., 141(6):4155–4167, 2017.
[32] S. Eichstädt, N. Makarava, and C. Elster. On the evaluation of uncertainties for state estimation with
the Kalman filter. Meas. Sci. Technol., 27(12):125009, 2016.

Traceable measurements with dynamically calibrated hydrophones
౪
115
[33] B. Ludwig, S. Eichstädt et al. PyDynamic – python package for the analysis of dynamic measurements,
2020.
[34] V. Wilkens, S. Sonntag, and M. Weber. Secondary complex-valued hydrophone calibration up to
100 MHz using broadband pulse excitation and a reference membrane hydrophone. In 2019 IEEE
International Ultrasonics Symposium (IUS), pages 1846–1849. IEEE, Glasgow, 2019.
[35] Y. Chiba and M. Yoshioka. Effectiveness evaluation of extrapolation to frequency response of
hydrophone sensitivity for measuring instantaneous acoustic pressure of diagnostic ultrasound.
Jpn. J. Appl. Phys., 60(SD):SDDE14-1–SDDE14-7, 2021.
[36] S. Howard. Calibration of reflectance-based fiber-optic hydrophones. In Proceedings of the IEEE
Ultrasonics Symposium, 2016.
[37] P. E. Bloomfield and P. A. Lewin. Determination of ultrasound hydrophone phase from Fourier-Hilbert
transformed 1 to 40 MHz time delay spectrometry amplitude. IEEE Trans. Ultrason. Ferroelectr. Freq.
Control, 61(4):622–672, 2014.
[38] Th. F. Quateri and A. V. Oppenheim. Iterative techniques for minimum phase signal reconstruction
from phase of magnitude. IEEE Trans. Acoust. Speech Signal Process., ASSP–29(6):1187–1193, 1981.
[39] J. Bechhoefer. Kramers–Kronig, Bode, and the meaning of zero. Am. J. Phys., 79(10):1053–1059, 2011.
[40] BIPM, IEC, IFCC, ILAC, ISO, IUPAC, IUPAP, and OIML. Guide to the expression of uncertainty in
measurement, 2008.


S. Eichstädt
Dynamic measurement analysis and the
internet of things
1 Introduction
With the rise of the Internet of Things (IoT), as in Industry 4.0 or Smart City, the world
of measurement is changing rapidly. For instance, sensor networks are preferred over
single sensors, since data analysis for huge data sets in almost real-time has become
feasible and low-cost sensors are easily available. The role of mathematical modeling is
changing, because of the increasingly often application of purely data-driven methods,
based on machine learning. This also leads to a different role of calibration information
and the communication of measurement data [1, 2].
Usually, the sensors applied in the IoT are measuring continuously irrespective of
how the measured values are used. Thus, it has to be ensured that the sensor behavior is
well known for a wide range of measurement situations. This includes situations where
the measurand, i. e., the sensor input signal, changes rapidly over time. The performance
of the sensor in such scenarios needs to be known in order to assess the reliability and
quality of the reported measurement values. The way these measured values are ac-
quired and used, however, may depend on the scenario. For instance, in some scenarios
measured values are reported only if a certain event was detected, e. g., if a given thresh-
old for the sensor output signal was reached. In other scenarios, measured values may
be provided upon request by another instance in the network, e. g., in a client-server
subscription based environment like OPC-UA.
This chapter addresses the link between the developments for dynamic measure-
ments and requirements from the IoT. Data analysis in the IoT typically relies on meth-
ods from machine learning, because of the complexity of the sensor network and the
amount of data acquired. Uncertainty evaluation for machine learning is an important
topic and considered in several research activities. However, this is only possible when
the uncertainty associated with the machine learning input values is available. To this
end, this chapter focuses on the uncertainty for data preprocessing as the initial step in
machine learning for IoT.
2 Data analysis for machine learning pre-processing
In situations where IoT devices are used, measurements are usually time-dependent,
i. e., dynamic, because measurements are taken continuously and no efforts are taken to
ensure a steady state of the measured processes. Examples are air quality monitoring,
https://doi.org/10.1515/9783110713107-005

118
౪
S. Eichstädt
traffic surveillance, production control, or mobile health measurements. Thus, signal
processing methods are regularly applied for data preprocessing in IoT scenarios. For
instance, the discrete Fourier transform is often applied to extract magnitude and phase
values from a measurement of vibration, which are then used in a subsequent machine
learning method as features. Other examples for preprocessing are: synchronizing the
time axis of sensors, because sensor data is acquired from different sources that have
different time keeping; interpolation of sensor data to accommodate for missing values
or nonequidistant sampling; low-pass filtering to reduce noise or other unwanted high-
frequency components in the measured data. Another reason for the application of data
preprocessing is the reduction of data dimensionality. This may be necessary simply due
to storage or data transfer bandwidth limitations. Moreover, it reduces the complexity
of the machine learning required to learn the relevant aspects from the data by letting
it focus on a preselected representation of the data. In this way, one can also steer the
machine learning in the right direction. Thus, data preprocessing is a very relevant step
in machine learning.
The above kinds of preprocessing are usually applied before the actual machine-
learning; see Figure 1. For instance, the interpolated data may be Fourier transformed
to extract the frequency components with the highest absolute value, i. e., magnitudes.
These features are then fed into a machine learning method for classification [3].
Uncertainty-aware machine learning (UA-ML) means that the machine learning method
takes the uncertainties associated with its input values into account. For example, the
classification method may use the uncertainties associated with the frequency compo-
nents as a weighting in the selection of suitable features. Hence, uncertainty-aware ma-
chine learning requires the propagation of uncertainties from the sensor data through
the preprocessing steps. Most of the uncertainty evaluation methods needed for the
machine learning preprocessing are similar to tasks in the analysis of dynamic mea-
surements: digital filtering, Fourier transform, Wavelet transform, interpolation, etc.
Thus, the toolbox of methods for dynamic measurements provides an excellent starting
point to enable uncertainty-aware machine learning (UA-ML).
Figure 1: (Placeholder image) Typical workflow in machine learning with data preprocessing including use
of signal processing methods as first step.

Dynamic measurement analysis and the internet of things
౪
119
Evaluation of uncertainty for such data processing pipelines needs to be real-time
capable, robust, and easy to implement in order to fit into IoT scenarios. That is, similar
to the fact that sensors are becoming more intelligent, the analysis of the sensor data
needs to become automated and intelligent, too. One reason is the rapidly increasing
amount of data that needs to be processed in IoT environments. For IoT, it is not one
individual measurement for which a model, uncertainty budget definition, and uncer-
tainty evaluation are to be carried out. Instead, data streams from several (hundreds of)
sensors need to be analyzed online. This can be achieved only by automated, flexible,
and intelligent approaches and implementations.
3 Calibrated measuring instruments in the Internet
of Things
Measuring instruments in the IoT usually need to: provide their measured values via a
digital interface, ideally over a network interface; work reliably under a wide range of
conditions and ideally, detect and report adversarial conditions; report on their health
status upon request; work automatically without significant human interaction, ideally
containing some sort of self-control and adaption to changing conditions. Sensors that
have these properties are also called “smart sensors” [3–5]. Thus, these are measuring
devices that contain some sort of preprocessing. Due to the rise of IoT and related ap-
plications, smart sensors are increasingly requested from sensor manufacturers. Their
preprocessing may range from a simple analogue-to-digital conversion up to a complex
compensation of influencing effects measured by sensing elements integrated into the
“smart sensor.”
Calibration traceable to the international system of units (SI), a harmonized treat-
ment of measurement uncertainties and the application of industry standards and
guidelines are the main components of a metrological infrastructure that enables glob-
alized production and international trade. This holds true as well for the IoT. The cal-
ibration and verification of smart sensors, though, is very challenging, because to the
user these devices usually remain a “black box.” Moreover, common standards for the
calibration or treatment of measurement uncertainty for the integrated preprocessing
are not available yet. The approaches and experiences from dynamic measurement
analysis in metrology provide a good starting point to address some of these challenges.
The concept of the IoT relies on a versatile and flexible combination of measuring
instruments, the automated acquisition and processing of the measured data, and the
application of intelligent algorithms to derive conclusions or decisions. Moreover, due
to the increasing availability of low-cost measuring devices, sensor networks in the IoT
are much larger than is usually the case for traditional measurement applications. As a
consequence of the size and complexity of the networks, data analysis is typically data-
driven and, in particular, machine learning methods are often applied. In contrast to

120
౪
S. Eichstädt
mathematical models that rely on a physical understanding of the measured process,
machine learning can be applied directly based on the sensors’ output data. Thus, the
need for calibration is not as obvious as for “traditional” measurements. However, cali-
brated measuring instruments in the IoT offer several benefits:
–
Calibrated sensors can serve as reference devices in the network to assess and im-
prove data quality;
–
Calibration of the sensor enables the estimation of the measurand, i. e., its input
signal. In this way, a replacement of the sensor by another calibrated one does not
affect the machine learning;
–
Calibration enables traceability to the international system of units of measurement
(SI), and thus, the comparability between different sites and countries;
–
Calibrated sensors improve the explainability of the obtained output from the ma-
chine learning.
Moreover, there is an increasing use of digital twins, in which a model of a physical
object is updated based on an evolving set of data [6], and software-based sensors as
a fusion of models with sensor data. In the IoT, digital twins provide insights into the
behavior of the system being observed. Calibration information is the first step to build
reliable digital twins. Software-based sensors, or simply “soft sensors,” are aggregating
data from a set of sensors. The outcome may be considered a “measurement” provided a
calibration has been carried out such that a unit of measurement can be associated with
the values of the soft sensor. The simplest form of a soft sensor is a smart sensor that uses
measurement information about its surroundings in the internal data preprocessing.
Thus, calibration information in IoT play an important role. The use of this infor-
mation varies with the place where in the IoT architecture the sensor data is processed.
The simplest form of IoT is a direct communication between the individual devices with
a central unit, usually considered to be in the “cloud,” i. e., a computer somewhere in the
internet. Sometimes, the preprocessing of data is carried out before data is sent to the
cloud. This is also called processing at the “edge” and devices that integrate such pre-
processing are called “edge devices.” For larger and more complex IoT architectures, it
may be infeasible to communicate all data to the cloud. In these cases, preprocessing at
the edge, soft sensors, and other approaches are combined into what is called the “fog”
also considered as a layer between the edge and the cloud [7]. Figure 2 illustrates the
role of calibration in the different layers in the IoT.
Calibration of the individual sensors provides traceability to the SI as well as the ba-
sis for the evaluation of measurement uncertainty. For homogeneous sensor networks,
i. e., with sensors measuring the same quantity or even the same measurand, novel con-
cepts such as cocalibration may be considered. For example, one of the sensors could
be considered as reference and the parameters of the LTI model of the other sensors
adapted accordingly. This could also be used to detect sensor drift and automatically
adapt the model parameters online. For heterogeneous sensor networks, i. e., with sen-
sors measuring different quantities, traceability to the SI simplifies the replacement of

Dynamic measurement analysis and the internet of things
౪
121
Figure 2: The role of calibration in the different layers in the IoT: calibration of the individual sensors pro-
vides information for the data preprocessing at the edge or in the fog layer. The uncertainties associated
with the preprocessed data and the general calibration information is used for the assignment of quality of
data metrics in the cloud layer.
sensors and improves the interpretability and explainability of data. Software-based
sensors aggregate data from individual sensors into a measurement result using a math-
ematical model or data-driven machine learning.
At the edge layer, measurement uncertainties and other calibration information
can be used in the data preprocessing. Examples are uncertainty-aware feature selec-
tion, plausibility assessment, and anomaly detection. The propagation of uncertainties
through these processing steps is necessary to enable its use in the fog and cloud layers.
In the cloud layer, calibration data and measurement uncertainties associated with
the data streams form the basis for an assessment of data quality. This enables the selec-
tion of high-quality data as reference, and it improves the trustworthiness of data-driven
conclusions and decision-making.
The application of metrological principles for the IoT leads to several calibration
and traceability challenges. For example, the establishment of metrology in IoT means
that calibration possibilities have to be extended to sensors with a purely digital out-
put signal. This requires, among other things, new concepts for the generation of time
stamps for the signals from sensors. This is particularly important for dynamic, i. e.,

122
౪
S. Eichstädt
frequency-dependent, calibration. The reason is that the reliable calibration of the
phase change in the sensor signal is an important element for time-dependent quanti-
ties as outlined in Chapter 3. In typical IoT applications, sensors provide digital, time-
dependent output signals, and have internal signal processing capabilities. This makes
the calibration of the sensor phase response difficult, because the internal time mea-
surement of the sensor is no longer managed by the calibration system, which requires
new concepts for the calibration of such sensors.
To this end, the authors in [8] developed a microcontroller board, which can ac-
commodate one or more sensors, provides options for connection to external, traceable
timers, and allows online preprocessing of the measured data. With the integration of
traceable timers, the time axis is traceable to the SI and the sensor can be dynamically
calibrated with conventional approaches, including its phase response. With the appro-
priate hardware with proper calibration as described in [8, 9], a sensor can then be ex-
panded to allow an easy integration into IoT. In addition to the traced back time stamps
of the sensor signals, evaluation methods can be implemented on-board of the microcon-
troller. These methods could provide the determination of the measurement uncertainty
for each measured value. In this way, basic principles of measurement value treatment
can be integrated directly on the extended sensor or applied in an edge computing ap-
proach close to the sensor, i. e., at the edge. For this purpose, the applied methods of
data and signal processing must be extended by methods for propagating measurement
uncertainties as described in Chapter 2. The basic mathematical groundwork for huge
variety of methods is already available and basic implementations in Python are also
available as part of the PyDynamic software package. Important for the practical use is
the modular structure of the implementation in order to be applicable to many applica-
tion areas in a flexible way using so-called agents as outline below.
Provision of calibration information in the IoT also includes a machine-readable
data structure, e. g., in terms of a digital calibration certificate (DCC) [10]. A DCC should
at least contain the information required by the ISO 17025. This information can be used
in the fog or cloud layer to monitor the overall status of measurement instrumentation
in the network. In some industrial areas, such as in the pharmaceutical sector, this is a
requirement by regulation authorities. In addition, a DCC could also include a validated
expression of the calibrated dynamic system model or a validated inverse model for
deconvolution.
The combination of the above described components (calibration of digital sensor;
DCC integration into the sensor; extension of sensor to provide a measurement result
rather than measured values) lead to what can be called “smart traceability.” This con-
cept uses hardware and software elements that can be moved easily between the indi-
vidual smart sensor, the edge, the fog, or the cloud—depending on the available comput-
ing power and application. With smart traceability present in the IoT, novel concepts for
using semantic information can be applied. The authors in [1] describe an approach that
utilizes the information from smart sensors and other sources to obtain a semantic de-
scription of the sensor network. This information is provided in a machine-readable way

Dynamic measurement analysis and the internet of things
౪
123
such that an algorithm can make use of it in the subsequent data analysis. For example,
the expression of the calibration dynamic system model can be used to automatically
design a deconvolution filter with associated uncertainty evaluation. Again, this can be
implemented using so-called agents as outlined below.
4 From calibration data to a digital twin
Beyond the mere extension of the calibration equipment, approaches for the treatment
of data preprocessing methods integrated in the sensor must be developed. As a rule,
these methods will not be visible to the calibration laboratory. Formally, knowledge of
the methods used in the sensor is not necessary to perform the calibration. In practice,
however, the methods can lead to strong nonlinear effects. For example, an algorithm
for avoiding jumps in the sensor signal by smoothing can lead to a nonlinear behavior of
the sensor in a shock calibration. The previously linearly reacting sensor thus becomes a
nonlinear measuring instrument due to the software used and the result of the calibra-
tion may no longer reflect the real behavior of the measuring instrument in practice.
As a result, calibration regulations need to be revised. However, this will first require
extensive basic research and the definition of approved types of methods for data pre-
processing. It must be ensured that the methods and algorithms integrated in the mea-
suring instrument cannot lead to misjudgments regarding the measuring capability and
precision as a result of the calibration. A mere disclosure of the algorithms is probably
not enough for this purpose, since the complexity of corresponding procedures is in-
creasing rapidly. In particular, if methods of machine learning should be integrated into
measuring instruments, a pure analysis of the algorithm will probably not provide reli-
able statements for the uncertainty of the calibration result. However, without a correct
calibration with associated measurement uncertainty, the later measurement result is
not traceable to SI units. Alternatively, targeted approaches could be developed, which
implement recognized methods of measurement data evaluation including the deter-
mination of measurement uncertainties close to the sensor. This could result in smart
measuring devices that combine the traceability to SI units achieved by calibration with
intelligent data preprocessing in the measuring device. This means, e. g., that the cali-
bration results are also implemented directly in the measuring instrument in the form
of methods for compensating dynamic effects of the sensor. The result would be the
principle of “smart traceability” already mentioned above. In this way, the customers’
desire for intelligent sensors can be met by the manufacturers, and at the same time the
application of methods for evaluating measured data recognized in metrology can be
simplified.

124
౪
S. Eichstädt
5 Modeling of dynamic measurements in IoT
In Chapter 1, mathematical models for individual measuring instruments as well as for
complex measuring systems are discussed. These kinds of models for the individual sen-
sors can also be applied in IoT scenarios. For instance, a low-pass filter or second-order
model may be applicable for a MEMS acceleration sensor similarly to a piezo-type ac-
celerometer. The digital technologies embedded in the (smart) sensors, the edge or some-
where else in the IoT network allow for a more efficient provision and automated use
of such models, provided they are given in a machine-readable way [1]. That is, the IoT
can make use of the sensor model in a more efficient way. The aspect of the machine-
readability of the model is important for the IoT, because of the typically large number of
sensors being in place. With hundreds or even thousands of sensors in place, a manual
application of a model, data analysis and integration cannot be carried out reasonably.
The often used state-space models for measuring systems, consisting of several sen-
sors, as discussed in Chapter 1, is usually not used in IoT scenarios, though. The reason is
that such models assume knowledge of a physical interconnection of the system, which
is usually not given in IoT. For instance, a state-space model of a measuring system ob-
serving the position of a moving vehicle may contain measurements of inertia, velocity,
and acceleration. The model is then derived based on the known physical relationship
between these quantities to estimate the position of the vehicle. In a typical IoT approach
to this problem, though, usually data-driven models are used instead. These models re-
quire large amounts of data and derive a relationship between the measured values in
the system and of the target value. In this way, even large and complex systems can be
handled efficiently. Provided the information about the sensors, their interconnection
and the target are provided in an appropriate machine-readable way, the estimation of
the model can even be carried out automatically.
With an existing data-driven model in place, also new insights into the physical re-
lationship in a sensor network can be achieved. For instance, a data analysis as in [5] of a
sensor network estimating the health status of a machine part may result in the finding
that the change in sound characteristics of the working machine part is more relevant
for the target value than the actual physical components such as electrical power con-
sumption or movement of the part.
With the new possibilities for making use of sensor models and for working with
sensor networks, also the way in which models and methods are implemented change.
One aspect is the above-mentioned machine-readability of information. The other as-
pect is the implementation of the actual methods, e. g., for uncertainty evaluation. The
methods described in the previous chapters are all implemented with a manual appli-
cation in mind. That is, it is assumed that a human acquires the sensor data, runs the
software, checks and saves the results manually. This also includes the interpretation
of software interfaces, the potential adjustment of variables and other fixes. In an IoT
scenario, this is not a practical approach. Instead, the software implementing the meth-
ods must have clear and largely standardized interfaces. In addition, the data analysis

Dynamic measurement analysis and the internet of things
౪
125
methods must be able to work with data streams. This requires implementation of meth-
ods in such a way that they can either work sequentially or with a moving window of
data. This also requires that the methods need to run efficient enough to ensure that
the results are calculated at least as quickly as new data arrives. Sequential uncertainty
evaluation methods have been developed for some scenarios, such as Fourier transform
[11], Wavelet transform [12], and digital filtering [13]. It can be expected that more work
in this direction will follow in the near future.
6 Conclusions and outlook
The analysis of dynamic measurements in metrology has focused on the increase of pre-
cision and accuracy of sensors by improving the underlying mathematical model and its
proper calibration. This is in line with the general metrological approach to improve un-
derstanding and working of measuring instruments. The sensors in the IoT, though, are
often low-cost devices, such as MEMS sensors. For these types of measuring instruments,
an improvement of precision and accuracy via calibrations with smaller uncertainties is
not an appropriate consideration. Nevertheless, the models and methods from dynamic
metrology are highly relevant for the IoT, too. Understanding dynamic effects, modeling
of complex systems and the development of uncertainty evaluation methods will be the
basis for the emerging field of sensor network metrology. These methods, however, will
need to be further developed to meet the novel requirements that differ from the labo-
ratory practice. In addition, completely new developments are needed, such as, e. g., in
situ and cocalibration in IoT, and semantic description of measurands, conditions, and
measuring instruments in accordance with metrology standards.
Bibliography
[1]
S. Eichstädt, M. Gruber, A. P. Vedurmudi, B. Seeger, Th. Bruns, and G. Kok. Toward smart traceability for
digital sensors and the industrial internet of things. Sensors, 2019(6):21, 2021.
[2]
D. Hutzschenreuter, F. Härtig, W. Heeren, Th. Wiedenhöfer, A. Forbes, C. Brown, I. Smith, S. Rhodes,
I. Linkeová, J. Sýkora, V. Zelený, B. Ačko, R. Klobučar, P. Nikander, T. Elo, T. Mustapää, P. Kuosmanen,
O. Maennel, K. Hovhannisyan, B. Müller, L. Heindorf, and V. Paciello. Smartcom digital system of
units (d-si): Guide for the use of the metadata-format used in metrology for the easy-to-use, safe,
harmonised and unambiguous digital transfer of metrological data. https://doi.org/10.5281/zenodo.
3522631.
[3]
T. Schneider, N. Helwig, and A. Schütze. Industrial condition monitoring with smart sensors using
automated feature extraction and selection. Meas. Sci. Technol., 29(9) 2018.
[4]
V. A. Vasiliev and P. S. Chernov. Smart sensors, sensor networks, and digital interfaces general
problems of metrology and measurement technique. Meas. Tech., 55:1115–1119, 2013.
[5]
A. Schütze and N. Helwig. Sensorik und messtechnik für die industrie 4.0. Tech. Mess., 84(5):310–319,
2017.

126
౪
S. Eichstädt
[6]
W. Wright and S. Davidson. How to tell the difference between a model and a digital twin. Adv. Model.
Simul. Eng. Sci., 7(13):13, 2020.
[7]
K. Bierzynski, A. Escobar, and M. Eberl. Cloud, fog and edge: Cooperation for the future? In Proceedings
of the Second International Conference on Fog and Mobile Edge Computing, 2017.
[8]
B. Seeger and Th. Bruns. Primary calibration of mechanical sensors with digital output for dynamic
applications. ACTA IMEKO, 10(3):177–184, 2021.
[9]
B. Seeger, E. Jugo, A. Bosnjakovic, S. Ruiz, and Th. Bruns. Comparison in dynamic calibration of
digital-output accelerometer between CEM and PTB. Metrologia, 59:3, 2022. https://dx.doi.org/10.
1088/1681-7575/ac5a5d
[10] S. Hackel, F. Härtig, T. Schrader, A. Scheibner, J. Loewe, L. Doering, B. Gloger, J. Jagieniak,
D. Hutzschenreuter, and G. Söylev-Öktem. The fundamental architecture of the dcc. Measurement:
Sensors, 18:100354, 2021.
[11] S. Eichstädt and V. Wilkens. GUM2DFT—a software tool for uncertainty evaluation of transient signals
in the frequency domain. Meas. Sci. Technol., 27(5):055001, 2016.
[12] M. Gruber, T. Dorst, A. Schütze, S. Eichstädt, and C. Elster. Discrete wavelet transform on uncertain
data: Efficient online implementation for practical applications. In Advanced Mathematical and
Computational Tools in Metrology and Testing XII, volume 90 of Series on Advances in Mathematics for
Applied Sciences, pages 249–261, World Scientific, 2021.
[13] C. Elster and A. Link. Uncertainty evaluation for dynamic measurements modelled by a linear
time-invariant system. Metrologia, 45(4):464–473, 2008.

Index
ADC see analog-to-digital conversion
algebraic equation 2
amplifier
– bridge 79
– charge 79
– conditioning 79
analog-to-digital conversion 3
anti-alias filter 14
back-to-back configuration 76
bandpass correction 30
bandpass function 30
bandwidth 9
bilinear transform 15
Bode gain-phase relation 107
bound function 21
calibration 44, see also dynamic calibration
– bandwidth 90
– dynamic 4
– uncertainty 77
– guideline 80
charge sensitivity 74
cloud 120
combustion engine 91
compensation
– bandwidth 17
– dynamic compensation 16
– filter 19
compensation system 16, 17, 27
convolution 7
damping 73
deconvolution 16, 102, 104, 110, 111, see also input
estimation
– filter 18
– frequency domain 17
differential operator method 30
digital compensation filter 19
digital output 80
digital twin 120
discrete-time 3
– Fourier transform 13
dynamic 1
– behavior 2
– ringing 2
– calibration 82
– measurand 1
– measurement 1
– measuring system 1
– quantity 1
– system 1
dynamic error 4, 16, 21, 22
dynamic error correction 16
dynamic force calibration 81
dynamic input estimation 16
dynamic measurement uncertainty see uncertainty
dynamic metrology 3
dynamic model 78, 86, 94, see transfer behavior
dynamic torque 90, 92, 93
dynamic uncertainty 3, 23
dynamic uncertainty component 4, 23
edge device 120
error bound 21
extrapolation 108, 111
falling mass calibration 85
fatigue testing 89
filter
– FIR 18
– IIR 18
FIR see transfer behavior
FIR filter 18
fog 120
Fourier domain
– convolution 7
– deconvolution 107
Fourier transform 7, 104, 110
– inverse 7
– one-sided 13
frequency domain estimation 17
frequency response 20
frequency response function 7
– amplitude 108
– extrapolation 108
– interpolation 108
– magnitude 107
– modulus 107, 108
– phase 107, 108
frequency warping 15
GUM see uncertainty
https://doi.org/10.1515/9783110713107-006

128
౪
Index
Hilbert transform 107
hydrophone 101
– calibration 102
– calibration data 106
– sensitivity 102, 103, 106, 111
– thickness mode resonance 102
IIR see transfer behavior
IIR filter 18
ill-posed problem 16
impact hammer 90
impulse invariance method 14
impulse response 5, 20
Industrie 4.0 117
input estimation 50
Internet of Things 117
inverse filter 18
inverse model see input estimation
inverse problem 16
inverse system 20
IoT 117
L-curve method 25
Laplace transform 9, 12
laser interferometry 74
linear time-invariant system 4
low-pass filter 111
lowpass filter cut-off 27
LTI see linear time-invariant system, see transfer
behavior
machine learning 117
– uncertainty-aware 118
mass moment of inertia 92
mass-spring-damper model 73
measurement
– dynamic 99
measurement process 1
minimum phase system 107
model see transfer behavior
– amplifier 79
model-free calibration 89
Monte Carlo see uncertainty
motion sensor 73
narrowband approximation 104
Nyquist frequency 14
ODE see ordinary differential equation
OPC-UA 117
ordinary differential equation 1
piezoelectric 81
pre-processing 118
pre-warping 15
primary calibration 74, 75
PyDynamic 35, 63, 64, 105, 110
quantity
– dynamic 99
regularization 16, 23, 27, 111
– filter 111
– uncertainty estimation 111
regularization error 27
resonance frequency 8
rotation torque 92
secondary calibration 76
seismic sensor 73
shock excitation 84
shock force 88
SI 117
signal 1
– analog 3
– continuous-time 3
– digital 3
– discrete-time 3
– input 1
– multivariate 1
– output 1
– time-dependent 1
signal processing 117
signal-to-noise ratio 26
sine approximation method 75
sinusoidal excitation 75, 87
SNR see signal-to-noise ratio
soft sensor 120
state-space system 11
static 2
– measurement 2
– measuring system 2
– system 2
step response 5, 20
strain gauges 81
Tikhonov 23
time-dependent measurement 1

Index
౪
129
traceable
– dynamic measurement 3
transfer behavior 8, see also system
– finite impulse response 41
– frequency response 42, see also Fourier, see also
frequency response
– impulse response 41, see also impulse response
– infinite impulse response 42
– linear time invariant 39
– state-space 40
– step response 41, see also step response
transfer function 10
– poles 10, 19
– roots 10
– zeros 10, 19
ultrasonic waves 99
ultrasound 99
– exposimetry 100
– hydrophone 101
– peak compressional pressure 100, 112
– peak rarefactional pressure 100, 112
– power 100
– pressure 100
– temporal average ultrasonic intensity 100, 112
uncertainty
– dynamic measurement 38
– evaluation see uncertainty
– framework 36
– propagation 36, 47
uncertainty estimation 104, 109
unit step signal 5
upper bound 21
wavelet 111
Wiener deconvolution 25
Wiener filter 25
z-domain 18


