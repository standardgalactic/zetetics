Bayesian inference of substrate properties from film behavior
The MIT Faculty has made this article openly available. Please share 
how this access benefits you. Your story matters.
Citation
Aggarwal, R, M J Demkowicz, and Y M Marzouk. “Bayesian Inference
of Substrate Properties from Film Behavior.” Modelling Simul.
Mater. Sci. Eng. 23, no. 1 (December 19, 2014): 015009.
As Published
http://dx.doi.org/10.1088/0965-0393/23/1/015009
Publisher
IOP Publishing
Version
Author's final manuscript
Citable link
http://hdl.handle.net/1721.1/97567
Terms of Use
Creative Commons Attribution-Noncommercial-Share Alike
Detailed Terms
http://creativecommons.org/licenses/by-nc-sa/4.0/

Bayesian inference of substrate properties from ﬁlm
behavior
R. Aggarwal1, M.J. Demkowicz2 and Y.M. Marzouk3
1Dept. of Mechanical Engineering, Massachusetts Institute of Technology,
Cambridge, MA 02139, USA
2Dept. of Materials Science and Engineering, Massachusetts Institute of Technology,
Cambridge, MA 02139, USA
3Dept. of Aeronautics and Astronautics, Massachusetts Institute of Technology,
Cambridge, MA 02139, USA
E-mail: raghav a@mit.edu
Abstract.
We demonstrate that, by observing the behavior of a ﬁlm deposited on a substrate,
certain features of the substrate may be inferred with quantiﬁed uncertainty using
Bayesian methods. We carry out this demonstration on an illustrative ﬁlm/substrate
model, where the substrate is a Gaussian random ﬁeld and the ﬁlm is a two-component
mixture that obeys the Cahn-Hilliard equation. We construct a stochastic reduced
order model to describe the ﬁlm/substrate interaction and use it to infer substrate
properties from ﬁlm behavior. This quantitative inference strategy may be adapted to
other ﬁlm/substrate systems.
Keywords: bayesian inference, substrate, ﬁlm, uncertainty quantiﬁcation, reduced
order models
1. Introduction
Materials scientists are often interested in measuring spatially varying properties of
surfaces.
When these properties cannot be observed directly, they may sometimes
nevertheless be inferred from the behavior of a ﬁlm deposited on the surface. The surface
of interest then becomes a substrate that inﬂuences ﬁlm behavior while the behavior of
the ﬁlm is an indicator of substrate properties. For example, Lewandowski and Greer
inferred high temperature shear bands in metallic glasses through the localized melting
of a ﬁlm of tin deposited on the sample [1]. Aizenberg et al. inferred the distribution
of local disorder in self-assembled alkanethiolate monolayers by observing water vapor
condensation ﬁgures [2]. Bowden et al. found that buckling patterns of metal ﬁlms on
elastomer substrates indicate underlying relief structures of the substrate [3].
In all the examples above, a property of a substrate (e.g., temperature, local
disorder, topography) may be inferred from ﬁlm behavior (e.g., melting, condensation,
buckling).
We investigate how such intuitive inferences may be made quantitative

Bayesian inference of substrate properties from ﬁlm behavior
2
using Bayesian statistical methods [4; 5]. These methods enable the inference of model
parameters from indirect and incomplete data. We will demonstrate two key beneﬁts of
Bayesian inference, namely quantiﬁcation of uncertainty in the inferred parameters and
the ability to improve these estimates sequentially as additional data become available.
We carry out our analysis on a model ﬁlm/substrate system. The substrate property
is modeled as a Gaussian random ﬁeld with a characteristic length scale. The ﬁlm is a
two-component mixture described by an order parameter that obeys the Cahn-Hilliard
equation. In this model system, the length scale of the substrate ﬁeld is inferred from
the phase separation behavior of the ﬁlm. To assess the quality of the inference, we show
how the Bayesian posterior concentrates as more data are employed, and we compare
the posterior with the known correct substrate length scale.
Although our model
system does not correspond to a speciﬁc experiment, it nevertheless demonstrates certain
general features of how Bayesian methods may be used to deduce substrate properties
from ﬁlm behavior. It also sheds light on the usefulness of developing stochastic reduced
order models (ROMs) for the purpose of inference.
In Section 2, we introduce a numerical model of the substrate and the ﬁlm. In
Section 3, we formulate a simple ROM for the stochastic ﬁlm-substrate interaction,
based on simulations of the numerical model and on the Buckingham Pi theorem. In
Section 4, we demonstrate Bayesian inference of the substrate length scale from ﬁlm
behavior using the ROM developed in Section 3. Section 5 discusses features of the
inference strategy described here that may be adapted to other ﬁlm/substrate systems.
2. Model problem
In our model problem, the substrate is described by a spatially varying scalar ﬁeld
T (x, y). The ﬁlm is a two-component mixture that phase separates or remains uniform,
depending on the value of T (x, y). It is described by order parameter c(x, y, t), which is
a function of both position and time. We assume that the substrate cannot be directly
observed. Instead, some of its aggregate properties may be inferred from the behavior
of the ﬁlm, which may be directly observed.
2.1. Modeling the substrate
We model the substrate as a Gaussian random ﬁeld [6] T (x, y) on a square domain ⌦
with side LD, with zero mean and covariance function speciﬁed as follows:
Cov (T (x1, y1), T (x2, y2)) = K1D (x1, x2) K1D (y1, y2)
(1)
(xi, yi) 2 ⌦= [0, LD] ⇥[0, LD]
where
K1D (s1, s2) = β2exp
✓
−2 sin2 (|s1 −s2|⇡/LD)
(`s/LD)2
◆
.
(2)
This covariance kernel ensures that realizations of T (x, y) are smooth (inﬁnitely
di↵erentiable) and periodic on the square with dimensionless edge length LD. Note

Bayesian inference of substrate properties from ﬁlm behavior
3
that T (x, y) is a stochastic quantity; every realization of the Gaussian random ﬁeld is
a distinct substrate ﬁeld T (x, y). At any ﬁxed spatial location (x⇤, y⇤), T(x⇤, y⇤) is a
Gaussian random variable with mean zero and variance β2. The covariance kernel above
also encodes smoothness or structure by imposing nonzero covariance between T (x1, y1)
and T (x2, y2). Thus it is di↵erent from uncorrelated Gaussian noise.
As the distance between locations increases, the covariance in (2) decays at a
rate controlled by parameter `s. This distance-dependent covariance creates correlated
variations in the substrate ﬁeld with characteristic dimensionless length scale `s. Large
values of `s result in long-wavelength variations in T (x, y) and, conversely, small values
of `s give rise to short-wavelength T (x, y) variations.
Due to the periodic nature of the covariance kernel, peaks in the covariance kernel
recur with a period of LD. Therefore, the above described decay in covariance is to be
understood to occur locally. To ensure that periodic images of the covariance peaks do
not interact, `s must be much smaller than LD. In this study, `s is never greater than
LD/5. We ﬁnd that this condition is suﬃcient to prevent periodic image artifacts.
Figures 1(e) and 1(i) show two realizations of T (x, y) with `s values of 0.77 and
0.13, respectively, and LD = 5. As expected, variations in T (x, y) occur over larger
length scales in 1(e) than in 1(i). For contrast, Fig. 1(a) shows a uniform substrate ﬁeld
T (x, y) = −1.
In our inference problem, the substrate ﬁeld property of interest is `s.
That
is, we will not infer the particular realization of the substrate ﬁeld giving rise to a
single instance of ﬁlm behavior. Rather, we are interested in learning the length scale
parameter in the stochastic description of the substrate ﬁeld. Since the substrate ﬁeld
cannot be observed directly, `s is inferred from the behavior of a ﬁlm evolving on the
substrate, described next.
2.2. Modeling the ﬁlm behavior
The ﬁlm deposited on top of the substrate is a two-component mixture represented by an
order parameter ﬁeld c(x, y, t). The order parameter takes values in the range [−1, 1],
where c = −1 and c = 1 represent single-component phases and c = 0 represents a
uniformly mixed phase. The behavior of the ﬁlm is encoded in the substrate-dependent
potential energy density
g(c, T (x, y)) = c4
4 + T (x, y)c2
2 .
(3)
For negative values of T (x, y), g(c, T (x, y)) is a double-well potential and the ﬁlm
tends to separate into two distinct phases with c = ±
p
−T (x, y). By contrast, when
T (x, y) is positive, g(c, T (x, y)) has a single well at c = 0 and the ﬁlm remains uniform.
The substrate property T may therefore be thought of as a temperature di↵erence from
some hypothetical critical temperature. It promotes mixing in regions where T (x, y) > 0
and phase separation in regions where T (x, y) < 0.

Bayesian inference of substrate properties from ﬁlm behavior
4
The total energy of the ﬁlm may be expressed as
E =
Z
⌦
✓
g(c, T (x, y)) + ✏2
2 |rc|2
◆
dxdy,
(4)
where ⌦is the spatial domain. In addition to the potential energy density g(c, T (x, y)),
the energy functional E contains a gradient energy penalty ✏2|rc|2/2. The larger the
value of ✏, the larger the penalty for sharp gradients in c(x, y, t). Thus, larger ✏values
lead to smoother c(x, y, t) solutions. ✏may be thought of as a characteristic length scale
for composition ﬂuctuations in the ﬁlm. It is a material property of the ﬁlm.
The temporal evolution of c(x, y, t) is modeled by the Cahn-Hilliard equation [7]
@c
@t = ∆
✓@g
@c −✏2∆c
◆
,
(5)
which minimizes the energy functional in Equation (4).
We solve this equation on
a square domain ⌦with edge length LD and periodic boundary conditions using an
unconditionally stable, linear splitting scheme [8]. Spectral methods are used for spatial
discretization [9] and exponential time di↵erencing is used for time integration [10].
In all solutions, the initial condition of the Cahn-Hilliard equation is taken to be a
realization of a spatially uncorrelated Gaussian random ﬁeld with variance 0.01. This
initial condition represents a ﬁlm that has been slightly perturbed from a purely uniform
state. It is another independent source of stochasticity in the problem, in addition to
the substrate ﬁeld: di↵erent realizations of the initial condition give rise to di↵erent
temporal evolution trajectories of the ﬁlm.
The substrate variance parameter β2 controls the amplitude of T (x, y), but does
not a↵ect the length scale over which T (x, y) varies. The choice of β2 does not a↵ect our
results as long as there is suﬃcient contrast between the phase-separating and phase-
mixing regions of the substrate. This requirement is met if ✏2 < β2. We choose to ﬁx β2
to a value of 0.09, resulting in T (x, y) lying largely within the range of [−1, 1]. All ✏2
values we consider are smaller than 0.01, so there is always good contrast between the
phase-separating and mixing regions in our simulations.
2.3. Understanding the ﬁlm behavior
To illustrate the interaction of the ﬁlm with the substrate, Figure 1 shows the evolution
of the ﬁlm for three di↵erent cases: a ﬁlm with ✏= 0.05 on a uniform substrate with
`s = 1, a ﬁlm with ✏= 0.02 on a coarsely patterned substrate with `s = 0.77, and a
ﬁlm with ✏= 0.025 on a ﬁnely patterned substrate with `s = 0.13.
To describe the behavior of the ﬁlm quantitatively, we calculate the characteristic
length scale of composition ﬂuctutations using the normalized autocorrelation function
C(x, y, t) of the order-parameter ﬁeld c(x, y, t), calculated as
C (x, y, t) =
R
⌦c(x0 + x, y0 + y, t)c(x0, y0, t)dx0dy0
R
⌦c(x0, y0, t)2dx0dy0
.
(6)

Bayesian inference of substrate properties from ﬁlm behavior
5
The length scale ⇤(t) is calculated as the radius of the central peak in the autocorrelation
function C(x, y, t). The radius is calculated by least squares ﬁtting of a covariance kernel
K(x, y, λ) = exp
 
−2
'
sin2 (x⇡/LD) + sin2 (y⇡/LD)
(
(λ/LD)2
!
,
(7)
with an adjustable length scale parameter λ, to the autocorrelation function C(x, y, t):
⇤(t) = arg min
λ2R+
✓Z
⌦
(C(x, y, t) −K(x, y, λ))2 dxdy
◆
.
(8)
The uniform substrate with T (x, y) = −1 shown in Figure 1(a) favors phase
separation at all locations. Upon solving the Cahn-Hilliard equation (5) with ✏= 0.05,
we observe classic spinodal decomposition [11], snapshots of which are shown in Figure
1(b)-(d). The two phases separate, coarsen, and eventually converge to a stationary,
boundary length-minimizing shape. The phase separated structure of the ﬁlm converges
because the computational domain is ﬁnite. In principle, if the ﬁlm were simulated
over a hypothetical inﬁnite computational domain (LD ! 1), the ﬁlm would coarsen
indeﬁnitely, albeit at an ever-decreasing rate. In our ﬁnite-domain simulations, Figure
2(a) shows that ⇤(t) increases with time t and converges to a value ⇤1 close to LD = 5.
⇤1 is calculated as the length scale of the ﬁlm in its converged state:
⇤1 = lim
t!1 ⇤(t).
(9)
In practice, the ﬁlm behavior is considered converged if the maximum change in the ﬁlm
between two subsequent time steps is below a threshold δ:
max
(x,y)2⌦
**c(x, y, tn+1) −c(x, y, tn)
** < δ.
(10)
For this study, δ = 10−3.
The substrate shown in Figure 1(e) is coarsely patterned (`s = 0.77). We simulate
the behavior of a ﬁlm with ✏= 0.02 on this substrate and ﬁnd that it phase separates
in some regions, but not in others, as shown in Figure 1(f)-(h). Phase separation occurs
where T (x, y) < 0. The order parameter ﬁeld in Figure 1(h) has a structure ﬁner than
the scale of the computational domain. Figure 2(a) plots ⇤(t) for this ﬁlm/substrate
system and shows that the converged length scale ⇤1 is smaller than the computational
domain size LD = 5. Thus, unlike the case of the uniform substrate, the convergence of
the ﬁlm over this patterned substrate is due to the substrate itself, not the ﬁnite size of
the computational domain.
To further illustrate this distinction, we plot ⇤1 as a function of domain size LD
for both the uniform substrate and the patterned substrate in Figure 2(b). As expected,
⇤1 increases with LD for the uniform substrate while for the patterned substrate, ⇤1
is independent of LD. This conﬁrms that the length scale of compositional ﬂuctuations
in the ﬁlm on a patterned substrate converges because of the patterned substrate and
not due to the ﬁnite computational domain size.

Bayesian inference of substrate properties from ﬁlm behavior
6
The third substrate, shown in Figure 1(i), is ﬁnely patterned (`s = 0.13). A ﬁlm
with ✏= 0.025 is deposited on top of it. Figures 1(j)-(l) show the phase separation of
the ﬁlm. We do not ﬁnd any correlation between the phase-separated regions of the ﬁlm
and the parts of the substrate where T (x, y) < 0. This behavior contrasts with that of
a ﬁlm with ✏= 0.02 deposited on a substrate with `s = 0.77. This comparison suggests
that the behavior of the ﬁlm/substrate system depends on both ✏and `s. The nature
of this dependence is explored in the next section.
3. Model simpliﬁcation
The previous section describes a model ﬁlm/substrate system where the substrate has
characteristic length scale `s and the ﬁlm has two characteristic length scales: the
gradient energy penalty factor ✏and the converged length scale ⇤1. We propose to infer
`s given ✏and ⇤1. Note that the relationship between these parameters, as described
by the phase ﬁeld model given in the previous section, is intrinsically stochastic due to
randomness both in the initial conditions and in the substrate ﬁeld itself (for a given
`s). Direct evaluation of the resulting likelihood function in a Bayesian approach (to be
described in Section 4) is thus intractable. Approximate Bayesian computation methods
[12; 13] could be used instead, but these would require many thousands or millions of
model evaluations.
Instead, we adopt a di↵erent approach to infer `s given ✏and ⇤1: we construct a
simpliﬁed model that relates `s, ✏, and ⇤1, in a way that will give rise to a tractable
likelihood function to be used in Section 4. This relation may be viewed as a “reduced
order model” (ROM), because it ignores the detailed structure of the substrate, replacing
it with `s, and because it also ignores the exact temporal evolution of the ﬁlm, instead
describing it using only ✏and ⇤1. This relation may be expressed as
⇤1 =
reduced order model
z
}|
{
f (✏, `s)
| {z }
deterministic term
+ γ (✏, `s)
| {z }
random term
.
(11)
The deterministic term captures the average response of the ﬁlm/substrate system. The
random term γ(✏, `s) can account for both the inherent stochasticity of the ﬁlm evolution
and any systematic error in the deterministic term. We will construct both f(✏, `s) and
γ(✏, `s) in turn.
First, we use the Buckingham Pi theorem [14] to simplify the putative relation
⇤1 = f(✏, `s) between `s, ✏, and ⇤1. Because ✏, `s, and ⇤1 all denote characteristic
lengths, we may use them to write two independent parameter groups ⇤1/`s and `s/✏.
The Buckingham Pi theorem then allows us to simplify the relation to
⇤1
`s
= F
✓`s
✏
◆
.
(12)
To get the actual form of function F, we perform runs of the full model over a
range of ✏and `s. ✏was varied over ten logarithmically-spaced values between [0.01,

Bayesian inference of substrate properties from ﬁlm behavior
7
0.1]. Similarly, `s was systematically varied in the range [0.1, 1]. For each combination
of ✏and `s, ten simulations of the full model were performed, each with an independent
realization of the substrate parameter ﬁeld and the stochastic initial condition. The
resulting values of ⇤1 were recorded. The spatial discretization length h was always at
least a factor of 2 smaller than `s, ✏, or ⇤1 and the computational domain size LD was
always at least a factor of 5 larger than `s, ✏, or ⇤1.
Figure 3(a) plots ⇤1/`s as a function of `s/✏. The individual data points collapse
onto a single curve, as expected. The curve has two asymptotes. When `s/✏≫1,
⇤1/`s ⇡1. This limit is illustrated in Figure 1(f)-(h). In it, the ﬁlm order parameter
c(x, y, t), upon convergence, exhibits variations over a distance of approximately `s. This
is because the phase-separating regions of the substrate ((x, y) | T (x, y) < 0) are on
average separated by a distance `s. Since `s is much larger than ✏, neighboring phase
separating regions do not interact. The ﬁlm phase separates to the full extent of the
phase separating regions, but not beyond. Since the phase separating regions are on
average of size `s, ⇤1 is close to `s.
The second asymptote occurs at `s/✏⇡1, where ⇤1/`s appears to diverge. This
is the behavior observed in Figure 1(j)-(l), where the ﬁlm phase separates to a length
scale larger than that of the substrate. Variations in the converged ﬁlm occur over
a distances larger than `s. This is because the characteristic spacing between phase
separating regions `s, is close to ✏. As a result, the ﬁlm is no longer constrained to
follow individual phase separating regions, and phase separates beyond length scale `s.
This causes ⇤1 to be larger than `s.
Given these observations of the simulated ﬁlm behavior, we prescribe a functional
form for F that is consistent with both asymptotes:
⇤1
`s
= F
✓`s
✏
◆
= a +
b
(`s/✏−1)c.
(13)
We obtain point estimates of a, b, and c by least squares ﬁtting to all model runs
where ⇤1 < 1. This is done to ensure that ⇤1 < LD/5 at all times. The estimates are:
a = 1.046,
b = 79.51,
c = 1.537.
(14)
Figure 3(a) shows the scatter of data around this parametric ﬁt, which reﬂects the
stochasticity of the full model. To simulate the likelihood function in Bayesian inference,
we must capture this stochasticity. We do so by adding a zero-mean Gaussian random
variable Γ(`s/✏) to F(`s/✏):
⇤1
`s
= F
✓`s
✏
◆
+ Γ
✓`s
✏
◆
,
Γ
✓`s
✏
◆
⇠N
✓
0, σ2
✓`s
✏
◆◆
.
(15)
Any systematic o↵set between the deterministic model F and the mean of the scattered
data in Figure 3(a) should be incorporated in the mean of the random variable Γ.
However, this o↵set is negligible in the current results, and thus we choose Γ to have
mean zero. The variance of the random term is chosen to be a function of `s/✏, due

Bayesian inference of substrate properties from ﬁlm behavior
8
to the inherent non-stationarity of the scatter in Figure 3(a). This non-stationarity is
an intrinsic feature of the ﬁlm evolution and its response to the stochastic inputs. We
ﬁt this dependence to the observed scatter using Gaussian process regression [6]. This
approach captures the variance σ2(`s/✏) nonparametrically.
The variance of the residual (⇤1/`s −F(`s/✏)) at each (`s/✏) value is estimated
directly from the corresponding simulation data. We then regress the logarithm of the
variance on the logarithm of `s/✏. GP regression is applied to the logarithm of the
variance, rather than the variance itself, to ensure that the latter remains positive. Our
GP regression scheme uses a squared exponential covariance kernel; hyperparameters
of this kernel are tuned by maximizing their marginal likelihood, as described in [6].
The mean function so obtained is used as a point estimate of σ2. The variance function
obtained from the GP is ignored. In Figure 3(b), we have plotted the variance σ2(`s/✏)
as obtained from the procedure described above. The non-stationarity of the variance
can be easily observed.
4. Bayesian inference
We use Bayesian methods and the simpliﬁed model described in Section 3 for the
inference problem of interest here. In Bayesian inference, the parameter to be inferred,
✓, is treated as a random variable. Thus, instead of producing a single estimate for
the parameter, Bayesian inference yields the probability density function (PDF) of the
parameter conditioned on the available data, D1 : P(✓|D1, ⌘1). In general, the parameter
✓may also be conditioned on some known experimental parameter, ⌘1. This posterior
PDF contains complete information about the uncertainty of the inference, as opposed
to only a point estimate (or a point estimate and a Gaussian approximation). Particular
measures of uncertainty, such as variances, credible intervals, or tail probabilities, may
be extracted from the posterior PDF.
The posterior PDF may be calculated using Bayes formula:
posterior
z
}|
{
P(✓|D1, ⌘1) =
likelihood
z
}|
{
P(D1|✓, ⌘1)
prior
z}|{
P(✓)
Z
✓
P(D1|✓, ⌘1)P(✓)d✓
|
{z
}
evidence
.
(16)
P(✓) is the prior PDF and represents knowledge about possible values of ✓before
any data is collected. The prior may reﬂect expert opinion, previous experiments, or
physical constraints. In case of no prior information, one may select a maximum entropy
prior [15; 16] or another kind of non-informative prior [17; 18]. The likelihood is the
probability density of the data, conditioned on the parameter of interest. It encodes the
relationship between the parameters and the observations. In our case, the likelihood
is the simpliﬁed model from Section 3. The evidence is a normalizing term needed to
ensure that the left hand side of (16) is a valid PDF.

Bayesian inference of substrate properties from ﬁlm behavior
9
An important feature of Bayesian inference is that it allows for sequential
improvements the posterior as additional data become available. The previous posterior
is simply assigned to be the new prior and an improved posterior, incorporating the new
data, is obtained using
P(✓|D1:n, ⌘1:n) / P(Dn|✓, ⌘n)P(✓|D1:n−1, ⌘1:n−1).
(17)
Here D1:n refers to the ﬁrst n data points collected from experiments with known
parameters ⌘1:n
4.1. Inferring `s
We consider a series of experiments where ✏is a known experimental parameter, ⇤1 is
directly observed in the experiment, and `s is to be inferred. The quality of the inference
is to be improved as more experiments are performed, i.e., as additional (⇤1, ✏) pairs
become available. To model experiments that generate (⇤1, ✏) pairs, values of ✏are
picked at random from a uniform distribution in the log-space with range [0.01,0.1].
For each value of ✏, a substrate is randomly generated with `s = 0.4 and used to run
the Cahn-Hilliard model described in Section 2. ⇤1 are obtained from the converged
order-parameter ﬁeld of the ﬁlm.
To infer `s, both sides of equation (15) are multiplied by `s/✏, giving
⇤1
✏
= F 0
✓`s
✏
◆
+ Γ0
✓`s
✏
◆
,
Γ0
✓`s
✏
◆
⇠N
✓
0, σ02
✓`s
✏
◆◆
,
(18)
F 0 (`s/✏) = (`s/✏)F (`s/✏) ,
(19)
σ0 (`s/✏) = (`s/✏)σ (`s/✏) .
(20)
The likelihood of any candidate `s is obtained from the di↵erence between the
experimentally-obtained value of ⇤1/✏and the value of ⇤1/✏obtained from equation
(18), given by
Observed
z}|{
⇤1
✏
−`s
✏F
✓`s
✏
◆
|
{z
}
Predicted
⇠N
 
0,
✓`s
✏
◆2
σ2
✓`s
✏
◆!
.
(21)
We may use equation (21) to construct the likelihood function, which incorporates
both parts of the ROM: the parametric deterministic term and the non-parameteric
stochastic term,
P (⇤1|`s, ✏) =
1
p
2⇡σ0(`s/✏)
exp
 
−(⇤1/✏−F 0(`s/✏))2
2σ02(`s/✏)
!
.
(22)
Figure 4(a) shows the likelihood for ⇤1/✏= 70. Note that the likelihood is bimodal
because the function F 0 in equation (18) is not monotonic. Thus, a unique value of `s
cannot be inferred from a single (⇤1, ✏).

Bayesian inference of substrate properties from ﬁlm behavior
10
We use a truncated Je↵reys prior [17] for `s, P(`s) / 1/`s. The prior is truncated
outside the range [0.1, 1], which includes the true value `s = 0.4. This restriction is
imposed for computational convenience and may be relaxed, if needed. The result of an
iterative inference process that incorporates successive (⇤1, ✏) pairs is shown in Figure
4(b). The posterior PDF with zero data points is the prior. The posterior PDF with
one data point is bimodal, as expected from the construction of the likelihood. However,
the bimodality of the posterior vanishes with two or more data points. When multiple
(⇤1, ✏) pairs are introduced, only the modes corresponding to the most probable `s will
coincide, reinforcing each other. The modes corresponding to the unlikely values of `s
will not coincide and will decay away after the inclusion of a few data points.
The bimodal nature of the posterior PDF accurately represents the non-
monotonicity of the ROM given in equation (18), and the possibility of two correct
values of `s for a given (⇤1, ✏) pair. A single estimate of `s and any single measure
of uncertainty in this estimate (e.g., a variance or a standard error) would not
have accurately represented the ambiguity in `s resulting from a single measurement.
Inclusion of additional data points lifts this ambiguity, which is captured by the change
of the posterior PDF from bimodal to unimodal.
As additional (⇤1, ✏) pairs are introduced, the peak in the posterior moves towards
the true value of `s. Any number of point estimates of `s may be calculated from the
posterior, such as the mean, median, or mode. The PDF also gives a full characterization
of the uncertainty in `s. As an example, we have plotted in Figure 4(c) both the posterior
variance (a measure of uncertainty) and the absolute di↵erence between the posterior
mean and the true value of `s (a measure of error), for di↵erent numbers of data points.
As more data are used in the inference problem, both the posterior variance and the
error in the posterior mean decrease.
It is interesting to consider whether the posterior mean of `s will converge to the true
value of `s, i.e., the value used to generate the data, as the number of data pairs (⇤1, ✏)
approaches inﬁnity. It is also interesting to consider what happens to the posterior
variance in the same limit. These are questions of posterior consistency, i.e., about
the asymptotic (and frequentist) properties of the posterior distribution. If the data
were being generated directly from the likelihood, then in problems with ﬁxed and ﬁnite
parameter dimension such as this one, standard results establish conditions under which
the posterior mean converges to the truth and the posterior becomes asymptotically
normal with decreasing variance [19; 20]. But the problem analyzed here is di↵erent,
in that the data pairs (⇤1, ✏) are generated via solution of the Cahn-Hilliard equation
while the ROM is used to deﬁne the likelihood function for inference. Thus there exists
model error or misspeciﬁcation, and posterior consistency is far less clear. Theoretically,
there may be no particular reason to expect consistency in the present setting. But the
empirical results in Figure 4(c) suggest that the ROM is suﬃciently accurate for the
posterior mean to provide a good representation of the true underlying parameter. Had
this not been the case, we could have introduced a model discrepancy term to capture
the di↵erence between the ROM mean and the true mean response of the Cahn-Hilliard

Bayesian inference of substrate properties from ﬁlm behavior
11
system. This could be accomplished using the framework provided by Kennedy and
O’Hagan [21], in which the model discrepancy is represented as a Gaussian process and
conditioned on data.
4.2. Inferring ✏
In addition to inferring `s from ✏and ⇤1, the modeling framework we have described
also allows us to solve another inference problem, namely determining ✏from (⇤1, `s)
pairs. Thus, we infer a property of the ﬁlm, ✏, given that the length scale `s of the
substrate is known and the converged length scale of the ﬁlm, ⇤1, may be observed.
To generate data in the form of (⇤1, `s) pairs, values of `s are picked at random
from a uniform distribution in the range [0.1,1]. For each value of `s, a substrate ﬁeld
is randomly generated. For each substrate, the full Cahn-Hilliard model is run using
✏= 0.04. Values of ⇤1 thereby obtained are used to construct (⇤1, `s) pairs and the
likelihood is calculated from equation (15) in a manner similar to that in Section 4.1.
The process for obtaining the likelihood is shown in Figure 5(a).
The mode of the
likelihood corresponds to the intersection of the horizontal line deﬁned by the ratio of
⇤1/`s with equation (15). The spread in the likelihood is controlled by the random
term, Γ. In this case, the likelihood is unimodal because the function F in equation
(15) is monotonic.
As before, we use a truncated Je↵reys prior [17] for ✏, supported on the interval
[0.01, 0.1].
Figure 5(b) shows the e↵ect of incorporating successive data points on
the posterior. Both the accuracy and conﬁdence in the estimate of ✏improve as the
number of (⇤1, `s) pairs increases. Figure 5(c) plots the error in the posterior mean
and the posterior variance for di↵erent numbers of data points used in the inference. As
the number of data points increases, both the posterior variance and the error in the
posterior mean decrease.
5. Discussion
We demonstrated the inference—with quantiﬁed uncertainty—of a substrate property
from ﬁlm behavior in an illustrative, model ﬁlm/substrate system.
Two features of
Bayesian inference are demonstrated in this context. First is the ability to quantitatively
describe uncertainty in the inferred parameters via a posterior probability distribution.
This distribution describes the state of knowledge about the inferred parameters, after
observing the data.
Second,
Bayesian inference allows for sequential improvement of parameter
estimates by using the posterior from a previous inference as the prior for inference
with new data. We used the error in the posterior mean and variance of the posterior
distribution as estimates of the error and uncertainty in the inference, respectively. It
was shown that both the error and the uncertainty reduce as an increasing number of
data points used for inference.

Bayesian inference of substrate properties from ﬁlm behavior
12
An important component of our inference procedure is the construction of a reduced
order model (ROM) that directly connects the known quantities to those that are to
be inferred. To construct our ROM, we built a simpliﬁed, parametric model using the
Buckingham Pi theorem. The parametric model incorporates physical understanding
of the asymptotic behavior of the ﬁlm.
The values of the parameters in the model
were obtained by least squares ﬁtting with simulation data.
In addition to the
parametric model, the ROM includes an additive Gaussian random term to account
for the stochastic nature of the full model. The sources of stochasticity are the random
initial condition and the randomness of the underlying substrate. The variance of the
additive noise is a function of `s/✏. The exact form of the random term is obtained
non-parametrically using a Gaussian process ﬁt.
Similar approaches have been adopted in previous applications of Bayesian inference
in materials science-related problems.
For example, Davis and Guttierrez inferred
the melting point of Ti2GaN starting with what is e↵ectively a ROM for the energy-
temperature relation in isochoric molecular dynamics simulations of Ti2GaN [22]. Yoo
et al. modeled the creep rupture life of Ni-base superalloys as a function of their
composition using Bayesian neural networks [23]. These neural networks are trained
on data collected from existing literature and serve a purpose analogous to our ROM.
Other methods for constructing ROMs besides the one we used are available. For
instance, a direct GP regression of log(⇤1/`s) on log(`s/✏) might be used as a ROM.
However, this choice would not have allowed us to take advantage of known structure of
the problem (i.e., the asymptotic behavior described in Section 3). Moreover, capturing
the non-stationary stochastic response of the ﬁlm/substrate system would require using
a non-stationary prior covariance kernel — a non-trivial task.
Also, we could have used a more fully Bayesian procedure to construct the ROM.
This approach would involve constructing posterior distributions for a, b, c and σ2(`s/✏),
conditioned on the training data, instead of using point estimates.
However, this
additional complexity seemed unnecessary in our case, since we had a large and
comprehensive training set from which to construct the ROM. If we had had a limited
training set, as in [24], a Bayesian construction of the ROM would have been warranted.
Although the ﬁlm/substrate model studied here does not correspond to a speciﬁc
experiment, it nevertheless illustrates general features of how Bayesian inference may
be applied to inferring substrate properties from ﬁlm behavior.
In particular, it
demonstrates the utility of constructing a ROM that connects the quantities of interest
in a way that may be inverted.
Although it ignores much of the details of the
ﬁlm/substrate model under consideration, this approach nevertheless gives rise to
accurate inferences with quantiﬁed uncertainty. Similar approaches may be adapted
to particular ﬁlm/substrate systems as well as to other situations in materials science
where diﬃcult-to-observe quantities are to be inferred from easily observable ones.

REFERENCES
13
Acknowledgement
MJD acknowledges fruitful discussions with the organizers and attendees of the
Uncertainty Quantiﬁcation in Materials Modeling workshop organized in 2013 at the
Institute for Mathematics and its Applications, University of Minnesota, Twin Cities.
This project was funded by the US Department of Energy, Oﬃce of Basic Energy
Sciences under award no. DE-SC0008926.
References
[1] J. Lewandowski and A. Greer, “Temperature rise at shear bands in metallic glasses,”
Nature Materials, vol. 5, pp. 15–18, 2006.
[2] J. Aizenberg, A. Black, and G. Whitesides, “Controlling local disorder in self-
assembled monolayers by patterning the topography of their metallic supports,”
Nature, vol. 394, pp. 868–871, 1998.
[3] N. Bowden, S. Brittain, A. Evans, J. Hutchinson, and G. Whitesides, “Spontaneous
formation of ordered structures in thin ﬁlms of metals supported on an elastomeric
polymer,” Nature, vol. 393, pp. 146–149, 1998.
[4] D. Sivia and J. Skilling, Data analysis:
A Bayesian tutorial.
Oxford science
publications, 2 ed., 2006.
[5] A. Gelman, J. Carlin, H. Stern, D. Dunson, A. Vehtari, and D. Rubin, Bayesian
data analysis. CRC Press, 3 ed., 2013.
[6] C. Rasmussen and C. Williams, Gaussian Processes for Machine Learning. The
MIT Press, 2006.
[7] J. Cahn and J. Hilliard, “Free energy of a nonuniform system. i. interfacial free
energy,” J. Chem. Phys, vol. 28, pp. 258–267, 1958.
[8] D. Eyre, “An unconditionally stable one-step scheme for gradient systems.”
Unpublished manuscript, University of Utah, Salk Lake City, UT, June 1998.
[9] L. Trefethen, Spectral Methods in MATLAB. SIAM, 2000.
[10] S. Cox and P. Matthews, “Exponential time di↵erencing for sti↵systems,” Journal
of Computational Physics, vol. 176, pp. 430–455, 2002.
[11] J. Cahn, “On spinodal decomposition,” Acta Met., vol. 9, pp. 795–801, 1961.
[12] M. Beaumont, W. Zhang, and D. Balding, “Approximate bayesian computation in
population genetics,” Genetics, vol. 162, pp. 2025–2035, 2002.
[13] P. Marjoram, J. Molitor, V. Plagnol, and S. Tavare, “Markov chain monte carlo
without likelihoods,” Proceedings of the National Academy of Sciences, vol. 100,
no. 26, pp. 15324–15328, 2003.
[14] L. Yarin, The Pi-Theorem: Applications to Fluid Mechanics and Heat and Mass
Transfer, vol. 1. Springer, 2012.

REFERENCES
14
[15] E. Jaynes, “Information theory and statistical mechanics,” Physical Review,
vol. 106, no. 4, pp. 620–630, 1957.
[16] E. Jaynes, “Information theory and statistical mechanics. ii,” Physical Review,
vol. 108, no. 4, pp. 171–190, 1957.
[17] H. Je↵reys, “An invariant form for the prior probability in estimation problems,”
Proceedings of the Royal Society, no. 453-461, 1946.
[18] J. Berger and J. Bernardo, “On the development of the reference prior method,”
Tech. Rep. 91-15C, Department of Statistics, Purdue University, 1991.
[19] J. Doob, “Application of the theory of martingales,” in Le Calcul des Probabilites
et ses Applications, pp. 23–27, Colloques Internationaux du Centre National de la
Recherche Scientiﬁque, 1949.
[20] A. van der Vaart, Asymptotic Statistics. Cambridge University Press, 2000.
[21] M. Kennedy and A. O’Hagan, “Bayesian calibration of computer models,” Journal
of the Royal Statistical Society B, vol. 63, pp. 425–464, 2001.
[22] S. Davis and G. Gutierrez, “Bayesian inference as a tool for analysis of ﬁrst-
principles calculations of complex materials: an application to the melting point of
Ti2GaN,” Modelling and Simulation in Materials Science and Engineering, 2013.
[23] Y. Yoo, C. Jo, and C. Jones, “Compositional prediction of creep rupture life of
single crystal ni base superalloy by bayesian neural network,” Materials Science
and Engineering, pp. 22–29, 2001.
[24] S. Sarkar, D. Kosson, S. Mahadevan, J. Meeussen, H. van der Sloot, J. Arnold, and
K. Brown, “Bayesian calibration of thermodynamic parameters for geochemical
speciation modeling of cementitious materials,” Cement and Concrete Research,
vol. 42, pp. 889–902, 2012.

REFERENCES
15
U n i form
ϵ = 0. 05
S u b st rat e
a
Ph ase
sep arati on
b
Coarsen i n g
c
Convergen ce
d
ℓs = 0. 77
ϵ = 0. 02
e
f
g
h
 
 
y
x
ℓs = 0. 13
ϵ = 0. 025
i
0
5
0
5
−1
0
1
j
 
 
k
−1
0
1
l
Figure 1. (a) Uniform substate (T (x, y) = −1), (e) patterned substrate with `s = 0.77
and (i) patterned substrate with `s = 0.13.
The rows (b)-(d),(f)-(h), and (j)-(l)
show the time evolution of initially nearly uniform ﬁlms with ✏= [0.05, 0.02, 0.05]
respectively, on the three substrates

REFERENCES
16
10
−2
10
0
10
2
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
t
F i l m l en gth scal e, Λ
 
 
Λ ∞< L D
Λ ∞≈L D
a)
U n i form su b strate
Pattern ed su b strate
(a)
5
7
10
0
2
4
6
8
10
12
14
L D
Converged Len gth S cal e, Λ ∞
 
 
b)
U n i form su b strate
Pattern ed su b strate
(b)
Figure 2.
(a) Three trajectories of the ﬁlm length scale ⇤(t) for the uniform
substrate in Figure 1(a) and the patterned substrate in Figure 1(e). (b) Variation
of the converged ﬁlm length scale ⇤1 as a function of computational domain size LD
for the uniform substrate in Figure 1(a) and the patterned substrate in Figure 1(e).
10
1
10
2
0
5
10
15
20
ℓs/ϵ
Λ ∞/ℓs
 
 
Data
ROM
±σ
(a)
10
1
10
2
10
−2
10
−1
10
0
10
1
ℓs/ϵ
σ 2 (ℓs/ϵ)
(b)
Figure 3. (a) A plot of the reduced order model (ROM) given in equation (15). (b)
A plot of the non-stationary variance of the random term Γ(`s/✏) given in equation
(15)

REFERENCES
17
10
0
10
1
0
10
20
30
40
50
60
70
80
90
100
ℓs/ϵ
Λ∞/ϵ
 
 
a)
←P (Λ∞|ϵ, ℓs)
ROM
Data
(a)
0.25
0.5
0.75
1
0
5
10
15
0
1
8
4
2
ℓs
P (ℓs|Λ∞, ϵ)
b)
(b)
10
−2
10
−1
10
0
10
−5
10
−4
10
−3
10
−2
10
−1
2
4
8
16
32
64
error in posterior mean
posterior variance
c)
(c)
Figure 4. (a) Likelihood P(⇤1|`s, ✏) plotted as a function of `s/✏for ﬁxed ⇤1 and
✏. Each (⇤1, ✏) pair represents a point on the y-axis. The discrepancy is given by
the distance between the horizontal line at the given value of (⇤1/`s) and the ROM.
The random term in the model, given in grey, is used to calculate the likelihood. (b)
Posterior PDFs for di↵erent numbers of (⇤1, ✏) pairs. With the inclusion of ever more
data, PDF centers closer to the true value of `s with a tighter uncertainty bound. (c)
Posterior variance and error in posterior mean for di↵erent numbers of (⇤1, ✏) pairs.
Both error and variance are reducing with increasing data points

REFERENCES
18
10
0
10
1
0
2
4
6
8
10
12
14
16
ℓs/ϵ
Λ∞/ℓs
 
 
a)
←P (Λ∞|ϵ, ℓs)
ROM
Data
(a)
0.01
0.02
0.03
0.04
0.05
0.06
0
1
2
4
ϵ
P (ϵ|Λ∞, ℓs)
b)
(b)
10
−3
10
−7
10
−6
10
−5
2
4
8
16
32
64
error in posterior mean
posterior variance
c)
(c)
Figure 5. (a) Likelihood P(⇤1|`s, ✏) plotted as a function of `s/✏for ﬁxed ⇤1 and
`s. Each (⇤1, `s) pair represents a point on the y-axis. The discrepancy is given by
the distance between the horizontal line at the given value of (⇤1/`s) and the ROM.
The random term in the model, given in grey, is used to calculate the likelihood. (b)
Posterior PDFs for di↵erent numbers of (⇤1, `s) pairs. With the inclusion of ever
more data, PDF centers closer to the true value of ls with a tighter uncertainty bound.
(c) Posterior variance and error in posterior mean for di↵erent numbers of (⇤1, `s)
pairs. Both error and variance are reducing with increasing data points

