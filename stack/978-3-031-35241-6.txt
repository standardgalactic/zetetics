Conny Hansson
Krzysztof (Kris) Iniewski   Editors
X-ray Photon 
Processing 
Detectors
Space, Industrial, and Medical 
applications

X-ray Photon Processing Detectors

Conny Hansson • Krzysztof (Kris) Iniewski 
Editors 
X-ray Photon Processing 
Detectors 
Space, Industrial, and Medical applications

Editors 
Conny Hansson 
Stanford University 
SLAC National Accelerator Laboratory 
Menlo Park, CA, USA 
Krzysztof (Kris) Iniewski 
Emerging Technologies CMOS Inc. 
Port Moody, BC, Canada 
ISBN 978-3-031-35240-9
ISBN 978-3-031-35241-6 (eBook) 
https://doi.org/10.1007/978-3-031-35241-6 
© The Editor(s) (if applicable) and The Author(s), under exclusive license to Springer Nature Switzerland 
AG 2024 
This work is subject to copyright. All rights are solely and exclusively licensed by the Publisher, whether 
the whole or part of the material is concerned, speciﬁcally the rights of translation, reprinting, reuse 
of illustrations, recitation, broadcasting, reproduction on microﬁlms or in any other physical way, and 
transmission or information storage and retrieval, electronic adaptation, computer software, or by similar 
or dissimilar methodology now known or hereafter developed. 
The use of general descriptive names, registered names, trademarks, service marks, etc. in this publication 
does not imply, even in the absence of a speciﬁc statement, that such names are exempt from the relevant 
protective laws and regulations and therefore free for general use. 
The publisher, the authors, and the editors are safe to assume that the advice and information in this book 
are believed to be true and accurate at the date of publication. Neither the publisher nor the authors or 
the editors give a warranty, expressed or implied, with respect to the material contained herein or for any 
errors or omissions that may have been made. The publisher remains neutral with regard to jurisdictional 
claims in published maps and institutional afﬁliations. 
This Springer imprint is published by the registered company Springer Nature Switzerland AG 
The registered company address is: Gewerbestrasse 11, 6330 Cham, Switzerland 
Paper in this product is recyclable.

Preface 
Currently, most digital radiation detectors for medical and industrial applications 
are based on integrating the X-ray photons emitted from the X-ray tube for each 
frame. This technique is vulnerable to noise due to variations in the magnitude of 
the electric charge generated per X-ray photon. Higher energy photons deposit more 
charge in the detector than lower energy photons so that in a quantum integrating 
detector, the higher energy photons receive greater weight. This effect is undesirable 
in many detection applications because the higher part of the energy spectrum 
provides lower differential attenuation between materials, and hence, these energies 
yield images of low contrast. 
Photon counting X-ray quantum counting detectors solve the noise problem 
associated with photon weighting by providing better weighting of information 
from X-ray quanta with different energies. In an X-ray quantum counting system, 
all photons detected with energies above a certain predetermined threshold are 
assigned the same weight. Adding the energy windowing capability to the system 
theoretically eliminates the noise associated with photon weighting and decreases 
the required X-ray dosage by up to 50% compared to integrating systems. 
Silicon, germanium, and high-Z materials like CdTe, CZT, GaAs, and perovskites 
offer the best implementation possibility of direct conversion X-ray detectors. We 
discuss material challenges, detector operation physics and technology, and readout 
integrated circuits required to detect signals processes by these sensors. We will 
conclude providing examples of applications of photon pixel detectors in medical 
imaging, high energy physics, non-destructive testing, and security. 
Menlo Park, CA, USA
Conny Hansson 
Port Moody, BC, Canada
Krzysztof (Kris) Iniewski
v

Contents 
Introduction to Detector Technologies .........................................
1 
Conny Hansson and Krzysztof (Kris) Iniewski 
Charge Sharing in Single-Photon-Counting Detectors ...................... 
27 
Aleksandra Krzyzanowska 
Sub-pixel Sensing for Pixelated CdZnTe Detectors .......................... 
39 
Yuefeng Zhu 
Machine Learning Approaches in Room Temperature 
Semiconductor Detectors........................................................ 
67 
Srutarshi Banerjee, Miesher Rodrigues, Manuel Ballester, 
Alexander Hans Vija, and Aggelos K. Katsaggelos 
High Energy Resolution X and Gamma Ray Imaging 
Spectroscopy with the ORION Multichip Readout Electronics............. 
95 
Filippo Mele 
MIRA: A Low-Noise Pixelated ASIC for Photon Counting 
Applications....................................................................... 111 
Edoardo Fabbrica, Marco Carminati, and Carlo Fiorini 
Development of the Analog Front-End Circuit for the CMS Pixel 
Readout Chip at the HL-LHC .................................................. 129 
L. Gaioni, A. Galliani, M. Manghisoni, L. Ratti, V. Re, E. Riceputi, 
and G. Traversi 
A Readout Electronic System for a 3D Position-Sensitive CdZnTe 
Gamma-Ray Spectrometer Based on the CPRE10-32 Readout ASIC ..... 155 
Tianze Chen, Xiaohui Li, Ke Wang, CunFeng Wei, Lei Shuai, 
Xiaopan Jiang, Na Wang, Mian Wang, and Long Wei 
Space Applications of CdZnTe and CdTe Detector Systems: Past, 
Present and Future............................................................... 179 
Branden Allen
vii

viii
Contents
Germanium Detectors for MeV Gamma-Ray Astrophysics with 
the Compton Spectrometer and Imager ....................................... 225 
Jacqueline Beechert, Hadar Lazar, and Albert Y. Shih 
Particle Measurements in Space................................................ 249 
Martin Kroupa, Jonathan Barney, August Gula, Carlos Maldonado, 
Thomas Campbell-Ricketts, and Stuart George 
Photon Counting Detectors: Applications in Radiotherapy ................. 269 
Alex Winkler 
Index............................................................................... 291

About the Editors 
Conny Hansson has an M.Sc. in both Space Engineering (Umea University, 
Sweden) and Electrical Engineering (Halmstad University, Sweden) and earned his 
doctorate in Material Science from the University of Manchester, United Kingdom. 
He has spent over 15 years engaged in the design, construction, characterization, 
and implementation of novel X-ray, gamma-ray, charged particle, and IR detectors 
for a number of different application areas including space science, particle physics, 
accelerator facilities, security, and medical imaging. During this time, Dr. Hansson 
has worked at the European Space Agency’s European Space Research and 
Technology Center (ESTEC), the Dutch National Institute for Subatomic Physics 
(NIKHEF), both in the Netherlands, and at Redlen Technologies Inc., Canada. 
Much of his work has been dedicated to the development of compound semi-
conductor sensors and dedicated Application Speciﬁc Integrated Circuits (ASIC’s), 
and as such he has been involved in all areas of required technical development, 
including sensor growth and characterization; ASIC development; prototype detec-
tor qualiﬁcation; integration of detector in ﬁnal instrumentation; and evaluation 
of instrument performance. He currently holds a Staff Engineer – Detectors and 
Scientiﬁc Instrumentation position at the LCLS detectors group, SLAC National 
Accelerator Laboratory, Stanford University, USA. 
Krzysztof (Kris) Iniewski is managing R&D development activities at Redlen 
Technologies Inc., a detector company based in British Columbia, Canada. During 
his 15 years at Redlen, he has managed development of highly integrated CZT 
detector products in medical imaging and security applications. Prior to Redlen, 
Kris hold various management and academic positions at PMC-Sierra, University 
of Alberta, SFU, UBC, and University of Toronto. 
Dr. Iniewski has published over 150+ research papers in international journals 
and conferences. He holds 25+ international patents granted in USA, Canada, 
France, Germany, and Japan. He wrote and edited 75+ books for Wiley, Cambridge 
University Press, McGraw Hill, CRC Press, and Springer. He is a frequent invited 
speaker and has consulted for multiple organizations internationally.
ix

Introduction to Detector Technologies 
Conny Hansson and Krzysztof (Kris) Iniewski 
1 
Radiation Detectors 
The operation of any radiation detector depends on how the radiation interacts with 
the sensor material of the detector. The interaction needs to cause a measurable 
change in the physical properties of the sensor, typically a change in the number 
of free carriers available to conduct current.1 Electronic circuits then measure and 
further process this change in sensor property to extract information about the 
detected photon. The subject of this chapter pertains detection of X-rays and γ-
rays using semiconductor sensors and the associated front-end electronics. More 
speciﬁcally, a largely qualitative treatise on the physics and principles of hybrid and 
monolithic pixel detectors is given. 
The basic steps in detecting an X-ray photon by a semiconductor sensor are 
described as follows: An X-ray impinges on a semiconductor crystal and interacts 
with the atoms of that crystal, creating a charge cloud consisting of electrons 
and holes. The electron-hole clouds are accelerated in opposite directions due to 
the electric ﬁeld applied across the sensor via the electrodes. The movement of 
these charge carriers is sensed at the electrode, creating a current in the ampliﬁer 
1 Although the creation of an electrical pulse is the most common method of detecting a photon, 
alternatives excist, such as the creation of optical photons for scintillators and heat increase 
(phonons) in bolomteters. 
C. Hansson () 
Stanford University, SLAC National Accelerator Laboratory, Menlo Park, CA, USA 
K. (Kris) Iniewski 
Redlen Technologies, Saanichton, BC, Canada 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
C. Hansson, K. (Kris) Iniewski (eds.), X-ray Photon Processing Detectors, 
https://doi.org/10.1007/978-3-031-35241-6_1
1

2
C. Hansson and K. (Kris) Iniewski
Fig. 1 Basic conﬁguration for detection of X-rays in a semiconductor detector. The sensor and 
funtctional blocks making up the electronics chain is illustrated 
that is measured and evaluated per what property is being determined. This basic 
measurement process and the associated detection chain are illustrated in Fig. 1. 
Depending on the sensor and the electronics design, it is possible to extrapolate 
different properties related to the measured photons. The most common properties 
of interest are the position of interaction, photon energy, and time of arrival of the 
photon. The position is required to get an image of the photon source. As such, 
detailed information regarding the photon interaction point in the sensor is required. 
This is achieved by segmenting, i.e., pixelating, the sensor. Energy determination 
is required to measure the source’s spectrum, i.e., the energy deposited by each 
interacting photon. This requires us to ensure the full photon energy is deposited 
and subsequently measured accurately. Finally, the photon arrival time can be used 
to perform timing measurements and evaluate how long the photon has traveled 
w.r.t. a set time frame (Time of Flight). We therefor need to be able to identify 
when the photon is absorbed in the sensor, and relate it to the external time frame 
of interest. This chapter is divided into a section discussing the properties of the 
sensor, followed by a description of the electronics. 
2 
Sensor and Sensor Physics 
The sensor is the part of the detector where the X-ray interaction takes place, and 
the signal that is measured by the electronics originates. Here a comprehension 
of the photon/sensor interaction and charge cloud generation must be obtained to 
understand the sensor’s behavior. Also, understanding the subsequent charge cloud 
transport and signal generation mechanisms is needed. The details of these processes 
are discussed in the following sections, starting with the photon/sensor interaction 
mechanisms present in semiconductor sensors.

Introduction to Detector Technologies
3
2.1 
X-Ray and Gamma-Ray Interactions with Sensors 
When X-rays enter a semiconductor sensor, it has a ﬁnite probability to be absorbed. 
An X-ray beam entering a sensor will be attenuated according to: 
StartLayout 1st Row StartFraction upper I Over upper I 0 EndFraction equals e Superscript minus mu Super Subscript a Superscript rho x EndLayoutI
I0
= e−μaρx
where I is the intensity of the X-ray beam after it has traveled a distance x into the 
material, I0 is the beam’s intensity prior to entering the sensor, ρ is the mass density 
of the material, and μa is the attenuation coefﬁcient of the material. The attenuation 
coefﬁcient of the material is given by adding the attenuation coefﬁcients of each 
of the x-ray matter interactions that can take place in that sensor. X-rays and γ-
rays interact with matter mainly by four basic processes: photoelectric absorption, 
elastic scattering, Compton scattering, and pair production. 
In photoelectric absorption [1], all the photon’s energy is transferred to an atomic 
electron, with the highest probability electron being a K-shell electron. The electron 
that receives the energy from the photon, referred to as a photoelectron, becomes 
free to move in the sensor and interacts with neighboring atoms creating a charge 
cloud [2]. The atom that gave up the photoelectron ends up in an excited state. 
Usually, the excited atom is relaxed by having a higher orbital electron ﬁll the 
vacancy, emitting a characteristic photon in the process. Under normal conditions, 
the characteristic photon is reabsorbed in the sensor, creating a second charge cloud 
that is measured together with the original charge cloud. For a given X-ray photon 
energy, E, the total number of charge carriers, N, in the charge cloud is given by: 
StartLayout 1st Row upper N equals StartFraction upper E Over upper W EndFraction EndLayoutN = E
W
where W is the material dependant pair creation energy, which dictates the energy it 
takes to create an electron-hole pair. However, if the characteristic electron can travel 
far enough to leave the sensor, only part of the total photon energy will be measured. 
When reconstructing photon spectra, these partial depositions, referred to as escape 
peaks, can sometimes be seen as additional energy lines located below the main 
peak, with an energy difference corresponding to the energy of the characteristic 
photon. 
Both Rayleigh [3] and Thomson scattering fall under the category of inelastic 
scattering. In this process, the photons interact with the sensor’s atoms but do not 
impart any energy. Instead, the photons are just redirected at an angle with respect 
to their incoming trajectory. As such, it does not create a charge cloud and is not 
detected by the detector electronics.

4
C. Hansson and K. (Kris) Iniewski
In Compton scattering [4], also known as elastic scattering, the photon will 
impart some of its energy to a loosely bound electron, known as a recoil electron, 
and then be scattered at an angle. The amount of energy that is imparted to the recoil 
electron depends on the photon scattering angle. At 0
◦ no energy is transferred to the 
electron, and the maximum energy transfer occurs at180
◦ . As no energy larger than 
this maximum energy can be deposited, it creates an upper energy limit referred to 
as the Compton edge. 
Finally, pair production can occur if the photon has an energy exceeding 
1.022 MeV. This process takes place in the columb ﬁeld of an atomic nucleus, 
and the photon is transformed into an electron-positon pair. Any energy exceeding 
1.022 MeV will be imparted as kinetic energy for the newly created pair. After 
slowing down, the positron annihilates, creating two annihilation photons. 
For the described interaction mechanisms, only photoelectric absorption results 
in the whole photon energy being deposited in the sensor. As such, especially 
for spectroscopic detectors, it is preferential to try and ensure this is the most 
probable interaction mechanism. In Fig. 2 we can see the regions where the different 
interaction mechanisms dominate as a function of the sensor’s atomic number, 
Z, and the photon energy. From the graph, it is clear that decreasing the photon 
energy and/or increasing the atomic number of the sensor increase the probability 
of photoelectric absorption being the dominant interaction mechanism. 
A more detailed view of the relative probability of the different interaction 
mechanisms for Si can be seen in Fig. 3. This plot shows that the photoelectric 
effect is dominant at lower energies and remains the primary interaction mechanism 
across the entire range. Compton only starts to have a noticeable impact on the 
absorption in the sensor when the photon energy reach 60–70 keV. 
Fig. 2 Illustration of where in phase space the three interaction mechanisms between matter and 
sensor are dominant, as a function of the atomic number of the sensor and energy of the photon. 
The atomic number for Si, GaAs, Ge, and CdZnTe are highlighted. (Reproduced from Ref. [5])

Introduction to Detector Technologies
5
Fig. 3 Relative efﬁciency of interaction mechanisms for Silicon as a function of photon energy. 
As seen from the graph, Compton scattering only start to play a signiﬁcant role around 60 keV. 
Attenuation coefﬁcients used to produce the plot was taken from [6] 
2.2 
Sensor Detection Efﬁciency 
As discussed, the atomic number of the sensor plays a signiﬁcant role in the 
detection efﬁciency of the sensor,2 as do the sensor thickness and the structure of 
the entrance window.3 The effect of atomic number can be seen in Fig. 4, where 
the detection efﬁciency at different photon energies are seen for different sensor 
materials. For ease of comparison the absorption efﬁciency for all materials are 
shown for a sensor thickness of 500 um. It should be noted that these plots assume 
no entrance window at all. It is seen from the plot that a higher detection efﬁciency 
is achieved with a higher atomic number material sensors. However, the absorption 
edges of the materials also have to be considered for different energy regions. This 
is seen for CdZnTe in the 27 keV region where the absorption edges result in the 
sensor having a worse detection efﬁciency than what is observed for Ge and GaAs.4 
The effect of the sensor thickness is seen in Fig. 5, where the detection efﬁciency 
is plotted for Si sensors with two different thicknesses. While this has no effect in 
the lower energy regions, a clear increase is apparent at the higher end. While these 
plots show the effect of the atomic number and thickness of a sensor, they are plotted 
without considering the entrance window’s effect.
2 Here the term detection efﬁciency refers to the ratio of the number of detected photons vs the total 
number incoming photons. Other deﬁnitions do exist that take into account the detector response 
function. 
3 The entrance window is somethimes called the deadlayer, and referes to any layers or structures 
on the entrance side of the sensor that do not create a measureable signal for the photons that are 
absorbed within it. 
4 Due to the similar atomic number and density of Ge and GaAs the lines for these materials ovelap 
eachother in the plots in Fig. 4. 

6
C. Hansson and K. (Kris) Iniewski
Fig. 4 Detection efﬁciencies as a function of photon energy for different sensor types. The 
efﬁciency has been plotted for a 500 μm sensor of each material type, and photon absorption 
in the entrance window is neglected 
Fig. 5 Detection efﬁciency as a function of photon energy for two different thicknesses of Si. The 
photon absorption in the entrance window is neglected 
For the case of resistive devices, such as CdTe, GaAs, and CdZnTe, the primary 
consideration for the entrance window is the metal contacts used to establish an 
electric ﬁeld across the sensor, attached to both sides of the sensor. For a junction 
device, such as Si sensors, a small region of non-sensitive Si created at the pn-
junction region and a thin layer of Al, used to block visible light, usually constitutes 
the entrance window. For both resitive and junction devices, the effect of the 
entrance window is to reduce the detection efﬁciency at the lower photon energy 
end of the spectra. The effect is illustrated in Fig. 6, where the detection efﬁciency

Introduction to Detector Technologies
7
Fig. 6 Detection efﬁciency as a function of photon energy for a 500 um thick Si sensor. The 
effect of taking the entrance window into account is illustrated. For these calculations, an entrance 
window consisting of a 1 um thick non-responsive Si region and a 1 um thick Al layer (optical 
light shield) have been used 
is compared for a sensor with just 500 μm Si with and without an entrance window. 
The entrance window used here consitited of a 1 μm Al layer and a 1 μm insensitive 
silicon region. The plot clearly shows the need to carefully consider, and optimize, 
the entrance window when designing X-ray detectors targeted at low X-ray energies 
[ 7, 8]. 
2.3 
Photon Absorption Proﬁles in Sensors 
While the detection efﬁciency curves seen in the previous section give a good insight 
into the probability that the sensor detects a photon at any one photon energy, the 
absorption proﬁle for the sensor also plays an essential role in understanding and 
designing the operation of a sensor. As discussed in the section on sensor geometry, 
for certain sensor geometires which charge carrier type is responsible for the charge 
induction onto the readout electronics depends on where in the sensor that charge is 
present. Also, it is common to use oxide layers for insulation in the pixel electrode 
area for various reasons. As oxides are prone to radiation damage,5 it is sometimes 
a requirement that photons cannot reach this far into the sensor. 
The X-ray absorption proﬁles in a semiconductor sensor follow an exponentially 
falling function, as shown in Fig. 7. As the photons will be absorbed through photo-
electric absorption, their energy will be entirely deposited in a single interaction 
point. Therefore, the graphs in Fig. 7 can be interpreted as the probability of a
5 As carriers that are excited by X-ray photons in insulators are not free to move, they are unable 
to recombine or escae the region, leading to a gradual charging of the oxcide, which can effect the 
electrical potential of the region, leading to unwabted behavior or outright failure of the device. 

8
C. Hansson and K. (Kris) Iniewski
Fig. 7 X-ray photon absorption proﬁles for various sensor materials, photon energies, and sensor 
thicknesses. (a) The absorption proﬁles for various materials for 16 keV photons, showing the 
impact of using different sensor material. (b) The variation in absorption proﬁles of 16keV photons 
and 8 keV photons, showing the impact of the photon energy on a set material system. It should 
be noted that for X-ray interactions, this proﬁle corresponds to the probability of a photon being 
absorbed at a speciﬁc depth in the sensor. This is in contrast to the absorption proﬁles plotted for 
charge particles, where the amount of charge deposited as a function of depth traveled for a particle 
into the sensor is usually visualized 
photon being absorbed at a speciﬁc depth in the sensor.6 The absorption proﬁle for 
a sensor is strongly dependent on the sensor’s atomic number and the energy of the 
incoming photon. The effect of the atomic number can be seen in Fig. 7a, where the 
absorption proﬁle for 16 keV photons has been plotted for 500 μm thick sensors of 
different materials. The probability of being absorbed close to the entrance window 
increases with increassing atomic number of the sensor. As such, a much steeper 
function for a higher atomic number sensor is observed. While CdZnTe has a higher 
average atomic number than either GaAs or Ge, the absorption proﬁle for CdZnTe 
at 16 keV is less steep then for these materials. This is due to the inﬂuence of one of 
the absorption edges of CdZnTe reducing the absorption probability in this part of 
energy space. Going to energies above the edge sees the CdZnTe sensor recovering 
its absorption capability. This illustrates the need to consider absorption edges for 
various sensors when understanding the response for a speciﬁc energy range. 
The effect on the absorption proﬁle with photon energy is illustrated in Fig. 7b, 
where the response can be seen for 8 and 16 keV in a 500 μm thick Si sensor. A 
much steeper curve is observed at 8 keV with a higher absorption probability close 
to the entrance window. It should also be noted that we have full detection efﬁciency 
at this energy, as indicated at 8 keV for Si in Fig. 6. However, the absorption proﬁle 
becomes much more level when the photon energy increases to 16 keV. Also, many 
photons make it through the sensor at this energy without being detected. This can
6 In contracts to the absorption proﬁle for a charged particle, where the charge pf the particle is 
gradually deposited along its path, and the proﬁle corresponds to the amount of charge that is 
deposited at any a speciﬁc depth in the detector. 

Introduction to Detector Technologies
9
be seen by the absorption probability not being zero at the back end of the sensor 
and that detection efﬁciency has fallen from 100% to 63%. 
2.4 
Basic Sensor Conﬁgurations – Resistive Device 
and PN-Junction Device 
Once a charge cloud has been created by the photon we need to be able to measure 
the pulse these carriers create. The be able to do so, the resistivity, ρ, of the sensor 
material is key. The resistivity of a material is set by the number of free carriers and 
the ability of those carriers to move under the inﬂuence of an electric ﬁeld. This is 
mathematically expressed in the equation below [9]: 
StartLayout 1st Row normal rho equals StartFraction 1 Over n e left parenthesis mu Subscript e Baseline plus mu Subscript h Baseline right parenthesis EndFraction EndLayoutρ =
1
ne (μe + μh)
where n is the number of free carriers, e is the charge of an electron and μe 
and μh are the electron and hole mobility, respectively. In a semiconductor, the 
amount of free carriers can be set by either the number of carriers that have been 
able to be thermally excited across the bandgap, the amount of doping, and/or the 
amount of carriers that have been released/captures from various trapping states.7 
The resistivity for several common detector materials can be seen in Table 2. The  
material’s resistivity is a crucial parameter for sensor materials as it dictates the 
amount of leakage current in the sensor. The leakage current is the amount of current 
ﬂowing without any photons incident of the device (also referred to as dark current). 
As the leakage increase, so does the statistical variation of that current, which 
manifests as noise in a measurement. As such, the leakage current has to be low 
enough for the electronics to be able to handle it and for the induced current caused 
by the photon created charge cloud to be distinguishable from the leackage noise 
[10]. Some of the materials stated in Table 2, namely CdZnTe, GaAs, and TlBr, have 
resistivities that allow the X-ray photon-generated signals to be detected with only 
mild cooling. These materials can be operated by attaching electrodes directly on 
opposite sides of the crystals and applying an electric ﬁeld between the electrodes. 
If the sensor is operated in this way, it is said to be a resistive sensor. However, 
for some of the materials in Table 2, i.e., Si and Ge, the amount of leakage would
7 If the electrical property of the material is dictated by carriers that have been thermally excited 
across the bandgap, the material is said the be intrinsic, while if the amount of doping sets the 
number of free carriers available to carry current, the material is said the be extrinsic. If a signiﬁcant 
number of defects or impurities are also present, they can contribute to the number of free carriers 
either by adding additional carriers or acting as trapping sites that captures carriers and prevent 
them from moving. Additionally, these trapping sites can alter the mobility of the carriers and, 
if in sufﬁcient density, result in locally charged region resulting in electric ﬁeld distortions (i.e. 
polarization effects). 

10
C. Hansson and K. (Kris) Iniewski
Fig. 8 Basic conﬁgurations for a resistive sensor, (a), and a pn-junction sensor, (b). For the 
resistive sensor, metal electrodes are deposited on either side of the sensor, and an electric ﬁeld 
is applied between the two. For the pn-juntion sensor, doping is used to create a junction and 
a corresponding depletion region. As the bias across the junction increases, the depletion region 
starts to grow. In this type of sensor, only the depleted part of the sensor is fully responsive to 
photon interactions, and the maximum achievable depletion width often limits the maximum sensor 
thickness. The use of a depletion region in a pn-juntion sensor is introduced to get rid of the excess 
carriers in the material bulk. In contrast, the carrier concentration is low for the resistive sensor to 
detect photons without a depletion region 
be prohibitive to operate as a resistive device, and they are operated as depletion 
devices instead. This is usually done by creating a pn-junction on one side of the 
sensor that is then reverse-biased to have the resulting depletion region, i.e., the 
region where free carriers have been removed, extend throughout the sensor volume. 
This effectively reduces the leakage of the material to the point where the signal can 
be detected. These types of sensors are often referred to as junction or diode sensors. 
The two types of conﬁgurations can be seen in Fig. 8. 
It should be noted that while for the resistive device, the bias applied results in 
an electric ﬁeld across the entire device, similar to what would be expected for a 
plate capacitor,8 for the junction device, this is not necessarily the case. As a bias 
is applied to the pn-junction the depletion region will start to grow from the p-
implant side towards the backside with increased bias voltage. Since the depleted 
region of the sensor will have a much higher resistivity then the non-depleted 
region, the electric ﬁeld will primarily be established across this section, As such, 
the electron-hole clouds created by a photon absorbed in the non-depleted region 
will not experience any electric ﬁeld. Consequently, the charge clouds will not 
separate and the carriers recombine, effectively ensuring the detector electronics do 
not detect the photon.9 As such, it is critical when operating a pn-junction sensor to 
ensure the sensor is biased high enough to fully deplete and make the entire sensor
8 It should be noted that this assumes that both metal contacts create ohmic contacts with the 
semiconductor. 
9 The charge cloud created in this region will still diffuse and some of the charge will make it to the 
depleted region and be detected. However, this will result in a much lower charge and is neglected 

Introduction to Detector Technologies
11
Fig. 9 The electric ﬁeld line proﬁles for planar and pixelated devices can be seen in (a) and  (b), 
respectively. In addition, a 1D cross-section of the weighting ﬁeld for both detectors is illustrated in 
(c), clearly showing the effect on the weighting ﬁeld caused by pixelating the electrode (electrode 
to thickness ratio: 0.125). The location of the cross sections is indicated by the red dashed lines in 
(a) and  (b) 
area sensitive to photons.10 For a more in-depth discussion on various detector 
conﬁgurations the reader is directed to [9, 10]. 
2.5 
Sensor Geometry – Planar and Pixel Detectors 
In order to ensure the electrons and holes that consititute the charge cloud separate 
and induce a signal on the electronics, and electric ﬁeld has to be established 
between the sensor electrodes. The most straightforward electrode conﬁguration for 
a semiconductor sensor can be seen in Fig. 9a. This conﬁguration is refered to a 
a planar conﬁguration and consists of two large electrodes deposited on opposite 
sides of the sensor. As a result, the electric ﬁeld resulting from biasing the electrodes 
creates a uniform electric ﬁeld across the sensor’s active area, as indicated by the 
dashed blue electric ﬁeld lines. 
While this conﬁguration is the technically easiest to realize, a photon can interact 
anywhere in the sensor volume, and no ﬁner information regarding the interaction 
location can be obtained, i.e., the detector does not have any spatial resolution 
outside of the size of the detector itself. If the detector’s targeted application requires 
spatial resolution, such as is the case for example in imaging, a more complicated 
electrode conﬁguration is needed. This can be realized by segmenting one of the 
electrodes into sections, effectively creating a pixelated device, and having each 
pixelated electrode read out by an electronic channel. This is illustrated in Fig. 9b. 
in the description to clarify the effect that not having a fully depleted device will have on the sensor 
performance.
10 It should be noted here that not fully depleting the device will make the sensor have worse low 
photon energy response since they will be preferentially absorbed in this non-depleted region. This 
is sometime referred to as the entrance window and is of key importance to minimize for low 
energy X-ray detectors (usually of concern in the <5 keV photon energy region). 

12
C. Hansson and K. (Kris) Iniewski
As can be seen in the resulting electric ﬁeld line proﬁles, any photon absorbed 
within the voxel volume of a speciﬁc electrode will be transported to that electrode. 
Therefore, when the electronics associated with that electrode measure a signal, the 
interaction point of the photon can be more accurately determined than in the case 
of the planar electrode conﬁguration. 
Additionally, other considerations are needed to understand the operational 
differences between these two electrode conﬁgurations. As indicated in Sect. 1, 
it is not the collection of the charge clouds at the electrode that allows a signal 
to be measured by the pixel electronic channel but the movement by the charge 
cloud within the sensor. The electrostatic coupling between the charge cloud and 
the electronics (via the electrode) causes a current to be measured at the charge 
ampliﬁer11 (CSA). As such, the current starts being induced on the electronics as 
soon as the created charge cloud starts moving and ﬁnishes when the charge cloud 
reaches the electrode.12 The process of charge induction on the pixel electronics is 
dictated by two ﬁelds in the detector: the electric ﬁeld and the weighting ﬁeld. The 
electric ﬁeld has been touched on above, and it dictates how the charge cloud moves 
in the sensor, with the carriers following the ﬁeld lines shown as blue dashed lines 
in Fig. 9a, b. As such, an understanding of the electric ﬁeld allows us to understand 
how the carriers will move in the sensor. On the other hand, the weighting ﬁeld [11, 
12] is a geometrical effect that describes how strongly coupled the charge cloud is 
to any one electrode when that charge cloud is at any speciﬁc point in the detector. 
As such, the weighting ﬁeld describes how much current will be induced at the CSA 
when the charge is moving in a speciﬁc part of the sensor. Since the weighting ﬁeld 
is directly dependent on the electrode conﬁguration, it is different for the planar and 
pixels conﬁgurations. This can be seen in the graph in Fig. 9c, where a 1D cross-
section of the weighting ﬁeld is illustrated for both conﬁgurations. The 1D cross 
sections correspond to the red dotted lines in Fig. 9a, b. In the graph, sensor depth 1 
corresponds to the pixel electrode’s position, while position 0 is where the backside 
contact is located. As can be seen, for the planar conﬁguration the weighting ﬁeld 
has a uniform slope forming a straight line while for the pixel geometry, the slope 
increases closer to the pixel electrode. The weighting ﬁeld slope can be interpreted 
as a measure of how much charge will be induced in the CSA by the movement of 
charge in this section of the sensor. Therefore for the constant slope of the planar 
electrode, regardless of where the charge is moving along the cross-section, it will 
induce the same charge on the electronics. For the pixel electrode conﬁguration, 
on the other hand, the slope is much steeper closer to the pixel electrode. This 
means that movement of charge carriers in this region contributes most of the 
charge of the measured signal on the pixel electronics. This fact is capitalized on
11 First stage of the electronic channel, as discussed in the charge integrating and pulse processing 
electronics section. 
12 This process is fundamentally different then for example what happens in a CCD detector, 
where the charge created is transported to the potential pocket created by the pixel electrode, and 
subsequently transported out via the other pixel electrodes during the readout phase, and ﬁnally 
measured by the readout node when the charge physically arrives at the node. 

Introduction to Detector Technologies
13
in a couple of ways in pixelated detectors. The ﬁrst one is to optimize energy 
resolution in compound semiconductors [12], where one of the two carrier types 
(usually the holes), has much worse transport properties. By biasing the sensor in 
the correct direction and ensuring the photon is preferentially absorbed closer to the 
backside electrode, the carriers with the poorer transport properties are transported 
towards the region where their movement does not have much of an effect (backside 
electrode). Therefore, the increased trapping this type of carrier is subject to will 
have little impact. In contrast, the carrier with good transport properties will move 
towards the sensitive region (pixel electrode), and the majority of the signal induced 
will be caused by the preferred carrier type. This effect is often referred to as the 
small pixel effect. The second way the pixel weighting ﬁeld is capitalized on is in the 
design of detectors that can handle high count rates (quickly measure each photon). 
For a set electric ﬁeld strength, the charge cloud will be transported with roughly 
constant speed across the sensor As such, for a weighting ﬁeld with a constant slope, 
the signal induction time is set by the time it takes for the charge clouds to traverse 
the entire sensor. For the pixel conﬁguration however, the signal will be developed 
during the short period while the charge cloud is moving close to the pixel electrode 
making the charge induction time much faster. As such, the electronics can be made 
faster and still measure a good representation of the full signal when operating a 
pixelated sensor, and consequently be able to handle a higher count rate. 
A ﬁnal point should be made on operating detectors with small pixels. When 
the sensor absorbs the X-ray, it initially creates a charge cloud, σi, with a size of a 
few um,13 and as the charge cloud traverses the sensor, the cloud expands through 
diffusion. The diffusion expansion of the cloud is given by [13]: 
StartLayout 1st Row sigma Subscript d Baseline equals StartRoot 2 upper D t EndRoot tilde StartRoot 2 StartFraction k upper T Over e EndFraction EndRoot StartFraction d squared Over upper V Subscript b Baseline EndFraction EndLayoutσd =
√
2Dt ∼

2kT
e
d2
Vb
Where D is the diffusion constant, k is Boltzmann’s constant, e is the charge of an 
electron, d is the thickness of the sensor, and Vb is the applied bias over the sensor. 
The approximation is valid for an average electric ﬁeld (i.e., E = V/d). As such, 
for d = 500 μm, T = 300 K, and Vb = 100 V, the charge cloud size (sigma) when 
reaching the electrode is the initial charge cloud size, σi, plus σd ~ 11  μm. Due to 
this spatial extent of the charge cloud, if the photon is absorbed close to the edge
13 The size of the initial charge cloud generated is dictated by the rathlength of the ejected 
photoelectron. If the photon was absorbed using photoelectric absorption, the photoelectron will 
have an energy equal to the energy of the absorbed photon minus the binding energy of the electron. 
The electron will subsequently interact with the electrons of the sensor as it travels and impart 
energy to them, resulting in the excitation of additional electrons, creating the electron/hole clouds. 
The path the initial photoelectron manages to traverse before it has lost enough energy to not be 
able to excite more electron is given by the Bethe-block equation for electrons and is on the range 
0.1–15 μm (sigma) range for 5–100 keV photons, respectively. There is a slight dependence on the 
atomic number of the sensor in the size of the initial charge cloud size. 

14
C. Hansson and K. (Kris) Iniewski
between two pixels, the resulting charge cloud could be measured by two pixels 
(partial charge induction on both pixels) instead of just one where the photon was 
absorbed.14 This effect is referred to as charge sharing and becomes more prevalent 
in detectors as the pixel size becomes smaller and smaller [14]. When trying to 
measure the energy of the photon (spectroscopy), which is done by measuring the 
total amount of charge that the photon has released, charge sharing can have adverse 
effects even after resuming the measured charge detected by both pixels.15 However, 
the sharing of charge between pixels can also be used beneﬁcially by looking at the 
amount of charge detected by the different pixels in a cluster of affected pixels. 
By centroiding this cluster, the interaction point of the photon can sometimes be 
determined to an accuracy higher than the pixel pitch (subpixel spatial resolution) 
[15]. 
2.6 
Sensor Materials 
The material properties of interest for the semiconductor crystal to be used as a 
sensor can be elucidated by walking through this basic detection process. As a set 
energy X-ray photon impinges on the sensor, the probability for the x-ray to be 
absorbed, and the absorption proﬁle for multiple photons, is dictated by the atomic 
number, Z, and density, ρ, of the crystal. The higher the atomic number and density, 
the higher the stopping power of the sensor. When a lattice atom in the crystal 
absorbs the X-ray, many electrons and holes are eventually released. The number 
of electron-hole pairs that are released is directly related to the size of the bandgap, 
Eg, of the semiconductor. The smaller the bandgap, the more charge carriers are 
released, and the more accurately the energy of the X-ray can be determined.16 
However, the smaller the bandgap, the larger the sensor’s leakage current (thermally 
generated current). When the leakage current increases, the ability to accurately 
measure the amount of charge created goes down. The leakage current can be 
suppressed in several ways and the most basic method is to cool the sensor to
14 A full treatise of charge sharing has to take into account the electric ﬁeld proﬁle, weighting ﬁeld 
proﬁle, the charge cloud size and expansion, as well as the photon interation point (x, y, and z 
coordinates), and is outside the scope of this chapter. 
15 Transport of charge carriers between pixels can cause incomplete charge collection due to effects 
like interpixel gap losses, electronic trigger levels etc. which can limit the effectiveness of the 
energy reconstruction. 
16 The smaller the bandgap the more carrier per unit energy is excited from the valence band to the 
conduction band. The variation in number of carriers created for the same photon energy is given 
by StartRoot upper N EndRoot
√
N, where N is the number of created carriers. As such the higher the number of released 
carriers for a set photon energy, the less variation is observed in the number of measured carriers 
for repeated photons of the same energy. 

Introduction to Detector Technologies
15
Table 1 Overview of basic material parameters of interest when considering a sensor material 
Property
Symbol 
Unit
Physical consideration 
Atomic number
Z
#
Detection efﬁciency of the sensor 
Density
ρ
g/cm3
Detection efﬁciency of the sensor 
Bandgap
Eg
eV
The number of carriers created per unit photon 
energy; leakage current 
Mobility
μ
cm2/Vs 
The ability of charge carriers to move in the sensor 
under the inﬂuence of an electric ﬁeld 
Lifetime
τ
s
The average distance a carrier can survive in the 
conduction band before being recaptured. Not an 
intrinsic parameter of the material but primarily 
related to the material quality 
Mobility-lifetime 
product 
μτ
cm2/V 
A measure of the transport quality for a speciﬁc 
material 
lower temperatures.17 As such, the bandgap of the sensor material often must 
be chosen in a trade-off between the number of charge carriers created per unit 
photon energy, the magnitude of the leakage current, and the restraint imposed if 
needing to cool the detector. Once the charge clouds have been created, they are 
separated by the applied electric ﬁeld and start to drift in opposite directions. The 
speed with which the carriers can move and the ability of the carriers to make 
it across the sensor without being recaptured is given by the carrier mobility, 
μ, and carrier lifetime, τ, respectively. These two parameters are often lumped 
together and referred to as the mobility-lifetime product, μτ-product, of a material 
when discussing the transport properties of that speciﬁc material. Additionally, 
imperfections of the crystal lattice can introduce electrically active trapping states in 
the bandgap, resulting in incomplete charge collection. If sufﬁcient trapping occurs, 
the resulting charge can distort the electric ﬁeld set up by the bias, resulting in time-
dependent variation in response to X-ray photons. The basic material properties that 
need to be considered for any sensor material are summarized in Table 1. 
In addition to these basic material parameters discussed, some additional consid-
erations have to be made when selecting the sensor material: The hardness of the 
material must be considered when evaluating the ease with which the crystal can 
be cut into the desired sensor shape; the binding energy between the atoms must be 
considered to ensure no ionic conduction takes place, changing the structure of the 
crystal; the existence of proper electrode material that will produce good electric 
contacts (ohmic or Schottky depending on the desired property) and doping atoms 
if pn-junctions are required for contacting or sensor operation. 
Table 2 lists the key electrical and physical parameters for the most commonly 
available semiconductor materials that are used as X-ray sensors. The elemental
17 While cooling is the most basic method to suppress leakage current, the most common one is 
the creation of depletion regions using pn-junctions, as is done to allow for Si sensor to operate at 
normal room temperature, a feat that would not be possible if Si was operated as just a pure crystal. 

16
C. Hansson and K. (Kris) Iniewski
Table 2 List of some common semiconductor materials used in radiation detection 
Si
Ge
GaAs
Cd1-xZnxTe
TlBr 
Atomic number (Z)
14
32
31,33
48,30,52
81,35 
Density (g cm−3)
2.33 
5.33 
5.32
5.4–5.8
7.45 
Resistivity (-cm)
1e5 
53
1010
>1010
1012 
Bandgap (eV)
1.12 
0.664 
1.425
1.51 + 0.606x + 0.139x2 
2.68 
Pair creation energy (eV) 
3.66 
2.96 
4.18
4.6
6.5 
Electron mobility 
(cm2V−1 s−1) 
1500 
3900 
8500
1350
50 
Hole mobility 
(cm2V−1 s−1) 
480 
1900 
400
120
4 
μeτe (cm2V−1)
>1
>1
1 × 10−4 
1 × 10−2
3 × 10−4 
μeτe (cm2V−1)
~1
>1
4 × 10−6 
2 × 10−4
6 × 10−5 
semiconductors Si and Ge are considered the gold standard for sensor materials. 
This is primarily due to the extremely high-quality crystals available for these 
materials. As such, they have excellent transport properties and do not suffer from 
any polarization effects.18 However, they suffer from some limitations, leading 
to an interest in alternative materials systems. The primary drawback of Si is its 
low atomic number, which prevents it from having a high detection efﬁciency at 
higher X-ray energies. This drawback in Si has been the primary driver behind 
the development of high-Z semiconductor materials, namely GaAs, CdTe, CdZnTe, 
and TlBr, for X-ray sensors. While Ge has a reasonably high atomic number, this 
material also has a very small bandgap. This results in Ge having better intrinsic 
energy resolution than Si, but it also leads to the need to cool this material, often 
to cryogenic temperatures, to reduce the thermally generated leakage current and be 
able to differentiate a photon signal. The need for such signiﬁcant cooling forces the 
use of vacuum operation and bulky cooling equipment to operate these detectors. 
While this can be dealt with for speciﬁc applications, it becomes preventative 
for others, such as space-based applications. As can be seen from Table 2, GaAs  
offers an alternative to Ge with very similar atomic number and density values but 
with a much wider bandgap, effectively reducing the need for cooling. The larger 
bandgap also ensures that GaAs have similar carrier concentrations to depleted Si, 
meaning it can be operated as ‘depleted’ without pn-junctions [10, 16]. Additionally, 
GaAs have excellent carrier mobilities, which has led to it being identiﬁed as 
a material of interest for sensor materials that require swift pulse response (fast 
timing application) [17]. However, the promising features promised by GaAs are 
currently being prevented by the material quality, with a large number of impurity 
states present [18, 19]. This leads to reduced transport properties, as seen from
18 Here the term polarization effect is used to indicate any time dependent change in detector 
performance when all other parameters are kept constant. 

Introduction to Detector Technologies
17
this material’s very low mobility-lifetime products. Additionally, deep-level traps19 
resulting in regional distortions of the electric ﬁeld have been observed [20]. These 
problems plaguing GaAs have limited its use to thin sensors, reducing the detection 
efﬁciency at higher photon energies. TlBr is available from a few select companies 
for use as X-ray sensors. However, material quality issues, low hardness, and 
its nature as a mixed electric-ionic conductor has so far prevented it from being 
used in commercial products [17]. The most developed high Z sensors currently 
available are CdTe and CdZnTe. While suffering from material quality issues, they 
have reached a maturity level that has allowed them to be used in commercial 
products. While some producers have managed to produce CdZnTe allowing for 
stable operation even under very high ﬂux conditions, CdTe is still suffer from 
polarization effects [21, 22].20 For a more detailed coverage of various detector 
materials and their properties the reader is directed to [17]. 
3 
Detector Electronics 
The charge pulse that is generated in the sensor is induced on the electronics, where 
it is then processed according to the photon parameter of interest. Two common 
architectures for electronics design are the pulse processing design, also referred 
to as the photon counting design, and the charge integrating design [23]. The basic 
operation of these designs is dictated by the reset methodology used by the ﬁrst 
stage in the electronic chain, the Charge Sensitive Ampliﬁer (CSA). The following 
sections discuss the differences between these two architectures and what pulse 
parameter is used to determine the most common photon parameters of interest. 
Finally, the implementation of these electronic designs into the two Application 
Speciﬁc Integrating Circuit (ASIC) solutions, the hybrid pixel detector design and 
the monolithic pixel detector design, is discussed. 
3.1 
Pulse Processing and Charge Integrating Electronics 
Many different ampliﬁer solutions exist to measure the signal generated by detecting 
an X-ray photon in a semiconductor sensor, including current and voltage ampliﬁers. 
However, one of the most used ones is the charge-sensitive ampliﬁer (CSA) [13, 16]. 
The primary reason for the popularity of the CSA is the fact that the gain remains 
the same regardless of the capacitive loading on its input that the sensor subjects it 
to, a fact that is not true for many other ampliﬁer solutions.
19 The EL2+ mid gap defect caused by As substitutionally occupying a Ga lattice site. 
20 For CdTe polarization is strongly linked to operation with schottky contatcs that are used to 
reduce the amount of leackage current from this material. 

18
C. Hansson and K. (Kris) Iniewski
Fig. 10 Illustration of a basic sensor/csa/ﬁlter network used for X-ray detection. As the charge 
cloud that the X-ray photon has created starts to move, a signal is induced onto the CSA. A ﬁlter is 
often used at the output of the CSA to limit the bandwidth of the newtwork and reduce the system 
noise. A trade-off between increased noise performance (low bandwidth) and pulse response time 
(high bandwidth) often has to be done to optimize for the application. In the system above, no reset 
mechanism is present 
The basic operation of the CSA can be seen in Fig. 10. Once the X-ray photon 
creates charge clouds in the sensor, and these charge clouds start moving to create 
a current in the sensor, the charge is induced onto the feedback capacitor of the 
preampliﬁer. As this happens, the signal goes from being a current signal to a voltage 
signal, and as more charge is induced onto the CSA feedback capacitor, the voltage 
at the output of the CSA is driven up. When the full signal has been induced on the 
CSA, the magnitude of the voltage at the output of the ampliﬁer is directly related 
to the amount of charge released by the absorbed X-ray photon. 
In general, the CSA is designed with a ﬁlter attached to its output. The main 
aim of the ﬁlter is to modify the frequency range (bandwidth) of the CSA and 
ﬁlter network to a more suitable one than what is given by the frequency response 
provided by the CSA alone. As the bandwidth of the frequency response of the 
CSA/Filter network is reduced, the noise is also reduced since signals not belonging 
to the photon-generated pulse are rejected.21 However, the bandwidth reduction also 
results in the rise time at the output of the CSA/Filter network becoming slower 
in the temporal domain (i.e., signal rise time is increased). As such, the detector 
needs longer to measure the signal, effectively reducing the maximum count rate 
the detector can handle accurately. This trade-off between noise level and countrate 
capability for a detector is one of the design criteria the electronics designer has 
to take into consideration and can serve as a general example of why a generic 
electronic channel for all applications can not be created, but each application 
has to have its dedicated solution depending on what is the most critical design
21 This is a simplistic argument highlighting a general rule that reducing the bandwidth reduces the 
noise. In reality a detailed study between liear, parallel and shot noise components in the systems 
has to be evaluated and an optimim noise performance occur at a speciﬁc shaping time (bandwidth). 
For a more detailed description, please see [13]. 

Introduction to Detector Technologies
19
Fig. 11 The effect of implementing a continuous reset mechanism by connecting a resistive 
element in parallel to the CSA feedback capacitor is illustrated. Once the charge has been fully 
induced onto the feedback capacitor, the resistor provides a discharge path. This results in the pulse 
shape seen at the far right. Care to the sensor pulse rise time, and the discharge characteristics must 
be taken to ensure the full charge is allowed to be developed at the CSA output 
criteria for that application. How the voltage at the output of the CSA/Filter network 
behaves as a function of time can be seen on the furthest right of Fig. 10. Before the 
photon is absorbed, the output is at the baseline value. As the charge clouds are 
created and move through the sensor, the output voltage rises and stops at a voltage 
corresponding to the induced charge when the charge clouds reach the electrodes. 
At this point, the output stays at this voltage, and the value corresponds to the 
energy of the photon. If a second photon is absorbed at this point, the output will 
increase again. Eventually, the output of the CSA would saturate when the output 
reached the supply voltage (i.e., the ampliﬁer would hit the rails). To prevent this, 
a reset mechanism is designed and put in parallel to the CSA feedback capacitor. 
Historically this function has been handled by what is known as a continuous reset 
solution and is what is used in photon counting detector designs. More recently, for 
reasons that will further elaborate on below, switched reset solutions have started to 
be used used in charge integrating detector designs for speciﬁc applications [23].22 
Illustrations of these two reset mechanisms, and their pulse responses, can be seen 
in Figs. 11 and 13. 
For the continuous reset scheme, a resistive element is connected in parallel to 
the feedback capacitor. As such, once the charge has been induced on the feedback 
capacitor it has a path to discharge. The resulting pulse shape can be seen at the 
furthest right in Fig. 11. Once the charge has been induced, it starts to discharge
22 Continuous reset and switched reset are also sometimes referred to as time-independent reset and 
time dependant reset respectively. This is due to their general nature where the continuous reset 
will respond to the incoming charge as it comes in, and therefore always have the same response, 
while for the switched reset happens at a set time, and the response to a photon can vary depending 
on when in time (w.r.t. the photon arrval time) the pulse characteristic measurement takes place. 

20
C. Hansson and K. (Kris) Iniewski
Fig. 12 Common pulse characteristics that can be measured to establish speciﬁc photon charac-
teristics in a continuous reset system 
towards the baseline value (i.e., reset), and a pseudo-Gaussian pulse shape is created 
where the pulse’s height corresponds to the photon’s energy. For the rising edge of 
the pulse, care must be taken to ensure that the signal has enough time to develop 
before the discharge starts taking effect. Otherwise, the full pulse height might 
not present, an effect referred to as ballistic deﬁcit. For the pulse’s falling edge, 
consideration must be taken so that the signal returns to the baseline fast enough 
before the next pulse comes in (i.e., the reset time has to be commensurate with the 
expected count rate). If this does not happen the pulse of the second event will be 
superimposed on the tail of the ﬁrst pulse, an effect referred to as pulse pile-up or 
simply pile-up. While measuring the pulse height to establish the amount of energy 
deposited by the X-ray photon was used above to describe the operation of this type 
of reset scheme, it is not the only feature of the pulse that can be evaluated, as is 
illustrated in Fig. 12. If a threshold circuit is added to the output of the ﬁlter, an 
electronic threshold can be used to evaluate if the pulse is above a speciﬁc voltage 
value. If it is, three additional parameters can be measured: the Time of Arrival 
(ToA), Time over Threshold (ToT), and counting. For the ToA measurement, the 
exact time when the pulse goes above the threshold is measured with respect to 
a reference timing. As such, the photon’s arrival time can be determined, and the 
detector can be used for timing measurement applications. If the transition across 
the electronic threshold is coupled to a counter, the circuitry can also be used to 
measure the number of photons (counting). Finally, by measuring the amount of 
time the signal stays above the threshold, again w.r.t. a reference timing, a second 
way to measure the photon’s energy can be achieved. 
As mentioned above, this reset scheme has historically been the most used. 
However, with the new generation of X-ray sources, i.e., next-generation syn-
chrotron sources and X-ray free electron lasers, the time between photons arriving is

Introduction to Detector Technologies
21
Fig. 13 The effect of using a switched reset scheme is illustrated. For this system, the output of the 
ﬁlter is measured before and after the X-ray pulse has been allowed to develop. The difference gives 
the amount of energy deposited by the photons and is usually measured using a CDS circuit (not 
shown). For this reset scheme, the timing of the incoming x-rays and the readout of the electronics 
has to be synchronized. Also, since the reset mechanism consists of a switch incorporated in the 
ampliﬁer’s feedback loop, the circuit has to be given time to stabilize after switching occurs or 
much noise is introduced in the measurement 
becoming so short that it is not possible for the electronics to reset between events. 
For example, for current pixelated detectors at the LCLS X-ray free electron laser, 
the detectors have been designed to handle X-ray pulses arriving with up to 80,000, 
8 keV, photons within a pulse width of 10 fs. As such, this type of detector has been 
designed to have a switched reset scheme operating as a charge-integrating detector. 
A switched reset scheme is realized by adding a switch in parallel with the feedback 
capacitor of the CSA, as can be seen in Fig. 13. the scheme works by having the 
switch disconnected when the photons arrive and are deposited in the sensor. 
The charge created by the photons is then induced onto the feedback capacitor, 
and the voltage at the output of the CSA/Filter network rises accordingly. After the 
full charge has been induced, the reset is activated by connecting the switch, creating 
a path for the feedback resistor to discharge. The measurement of the charge (i.e., 
the number of keV of photons that have been deposited in the sensor) is done by 
adding a correlated double sampling (CDS) circuit. This circuit ﬁrst measures the 
baseline at the output of the ﬁlter prior to the X-ray pulse arriving (ﬁrst red dot in the 
signal graph at the right in Fig. 13). Subsequently the ﬁnal voltage at the output of 
the ﬁlter after the full signal has been developed is measured (second red dot in Fig. 
13). Finally, the difference between these two measured values, which correspond 
to the total amount of photon energy, is outputted. Since the channel is not reset 
between the arrival of separate photons, this reset scheme cannot unambiguously 
determine each photon’s energy and is considered a charge-integrating detector 
design. Additionally, this detector design primarily works for pulsed sources since 
the ﬁrst CDS sample has to happen after the circuit has had time to recover from

22
C. Hansson and K. (Kris) Iniewski
the switch disconnecting23 (i.e. coming out of reset) and before the X-ray pulse has 
arrived, while the second sample has to be taken after the signal has had a chance to 
develop fully and before the reset happens. As such, this scheme requires the X-ray 
pulse and the detector’s operation to be timed together, and the X-ray pulse must 
arrive at a known time in the readout cycle of the detector. 
3.2 
Monolithic and Hybrid Pixel Detectors 
Many modern pixelated X-ray detectors are implemented using chips from large-
scale Si foundries. These chips are often referred to as Application Speciﬁc 
Integrated Circuits (ASIC) due to their application-tailored nature. Two groupings of 
these detectors that adhere to the physical principles described above are the hybrid 
pixel detector [24] and the monolithic pixel detector [25]. The primary difference 
between the two types of detectors is that the sensor and the chip containing the 
readout electronics are two different entities for the hybrid pixel detector. In contrast, 
for a monolithic pixel detector, the sensor and electronics are implemented in the 
same piece of Silicon. While the hybrid pixel detector technology is relatively 
mature, having been around for several decades, the monolithic pixel detector group 
is still comparatively early in its development path. As will be elucidated below, 
both approaches offer advantages with respect to the other. A cross-section of a 
pixel in a hybrid pixel detector can be seen in Fig. 14. For this type of detector, the 
ASIC is designed in a selected Silicon technology node and is created so that an 
array of readout channels are located in an array pattern that can then be coupled 
via bump bonding to the corresponding pixel of the sensor chip, connecting the 
two. The electronic chip design also typically contains signal digitization (ADC), 
timing circuitry, and facilities to send the chip data to the associated electronics 
board. This additional circuitry is sometimes referred to as the pheriﬁal curcitry as 
it is commonly designed away from the chip’s central region that contains the pixel 
electronics channels. The main advantage of this technology is that the sensor chip 
and the electronics chip do not have to be created in the same technology or the same 
material. This last point is crucial for many applications that require high detection 
efﬁciencies at higher X-ray photon energies. Due to the low atomic number of its 
constituting atoms, Silicon sensors have fairly low detection efﬁciencies at photon 
energies exceeding ~20 keV. This problem can, to some degree, be alleviated 
by using high-resistivity Si sensors that can be depleted further into the bulk of 
the semiconductor. As such, the sensor can be thicker, effectively increasing the
23 Since the design of the reset scheme effectively uses a switch in the feedback loop of an 
ampliﬁer, a signiﬁcant amount of noise (i.e. ringing) occurs when the switch is connected and 
disconnected, which has to have time to settle before sampling the output of the channel can 
be done. If the circuit is not given enough time to recover from the switch, then the ringing is 
effectively sampled resulting in a very noisy signal being measured. 

Introduction to Detector Technologies
23
Fig. 14 Illustration of the 
cross-section for a hybrid 
pixel detector. In this type of 
the detector, the sensor pixel 
and the electronic channel is 
connected via bump bonding. 
The strength of this solution 
is the ability to optimize the 
sensor and the electronics 
separately 
detection efﬁciency.24 However, this solution offers relatively little reprieve as we 
go to even higher energies. 
For operation at these energies, the hybrid pixel detector trait of having the sensor 
and the electronic chip being different comes into its own, as it then allows for the 
sensor to be created in a material other than Silicon, such as CdZnTe, GaAs, or 
Ge. The larger atomic number of these sensors’ atomic constituents allows for a 
much better detection efﬁciency at higher energies. Detectors utilizing these high 
atomic number sensor materials have started to see commercial use in recent years. 
While the higher atomic number of these sensors offers better detection efﬁciencies, 
they are often much less developed than Si. As a result, they often suffer from 
drawbacks such as polarization effects, non-ideal processing methodologies, lack 
of doping atoms, and suitable passivation and contact materials. One also has to 
consider the difference in thermal expansion when using two different materials, 
both during detector manufacturing and during operation, if the operation occurs 
under a signiﬁcantly different temperature than the one used for bump bonding. 
In the monolithic pixel detector, the sensor and electronics are created on the 
same die, simplifying the process as no additional high-density interconnects (i.e. 
bump bonding) are needed. The cross-section of a pixel from a monolithic pixel 
detector can be seen in Fig. 15 [25]. For this setup, the sensor part consists of the
24 While standard Si sensors can be found with 300–500um thicknesses, high resistivity sensors 
with thicknesses of up to 1 mm are commercially available. 

24
C. Hansson and K. (Kris) Iniewski
Fig. 15 Illustration of the cross-section of a monolithic pixel detector. In this design the sensor 
and electroncs is designed in the same Si die. This allows for the full detector to be implemented 
in one process. As such, no high-density interconnect technology is needed, and since the bump 
bond capacitance is not present, lower noise performance can be achieved. (Reproduced from Ref. 
[25]) 
chip substrate, which is fully depleted by the backside bias. The active circuitry 
is located in the n and p wells (NW and PW), and additional deep wells (DPW 
and DNW) are incorporated to isolate the electronics from the substrate as well 
as act as the charge collecting electrode (DNW). In the design referenced in the 
ﬁgure, the pixel’s circuitry includes the CSA, ﬁlter, and CDS.25 Since the sensor 
and the readout electronics are created on the same die, this approach is limited 
to Si as the sensor material, which excludes speciﬁc high-energy applications for 
this technology. However, since the sensing electrode and the sensor are in the 
same die, no high-density interconnection is required, signiﬁcantly reducing the 
complexity. Additionally, since there is no need for a bump bond between the CSA 
and the sensor, the input capacitance is signiﬁcantly lowered, reducing the noise. 
This solution is a good option when very low X-ray energies need to be detected 
(>2–4 keV), as these detectors require extremely low noise to differentiate the small 
signal from that noise.26 
25 The line between fully monolithic detectors and semi-monolithic detectors are not completely 
clear currently. The detector used for the description in this section contain the sensor and the 
FE (CSA,ﬁlter,CDS), but does not contain the needed ADC’s and FIFO electronics. This will be 
provided by bonding the detector to a second chip using low density interconnects which contain 
this functionality [25]. As such, the detector is actually semi-monolithic detector, but for the case of 
simplicity this has not been elaborated on in the text. For more details on the nuances and different 
types of monolithic detectors under development [16] is recommended. 
26 An alternative solution to the noise problem is to increase the magnitude of the photon signal. 
This approach is also being persued by certain groups through the use of low gain avalanche 
(LGAD) sensors.

Introduction to Detector Technologies
25
References 
1. Einstein, A. (1905). Über einen die Erzeugung und Verwandlung des Lichtes betreffenden 
heuristischen Gesichtspunkt. Annal der Physik, 17, 132–148. 
2. Schlesinger, T. E., et al. (2001). Cadmium zinc telluride and its use as a nuclear radiation 
detector material. Materials Science and Engineering, 32, 102–189. 
3. Rayleigh, L. (1871). Philosophical Magazine, 17, 274–447. 
4. Compton, A. H. (1923). A quantum theory of the scattering of X-rays by light elements. 
Physics Review, 21, 483–502. 
5. Decher, R., et al. (1994). X-ray and gamma ray astronomy detectors, section 1c (Library 
of Congress Catalogue Number 94-92211). National Aeronautics and Space Administration 
(NASA) Scienti_c and Technical Information Program. 
6. NIST XCOM: https://physics.nist.gov/PhysRefData/Xcom/html/xcom1.html 
7. Segal, J., et al. (2021). Thin-entrance window process for soft x-ray sensors. Frontiers of 
Physics, 9, 618390. 
8. Zhang, J., et al. (2022). Development of LGAD sesnors with a thin entrance window for soft 
X-ray detection. Journal of Instrumentation, 17, C11011. 
9. Sze, S. M., & Lee, M. K. (2012). Semiconductor devices: Physics and technology (3rd ed.). 
Wiley. 
10. McGregor, D. S., & Shultis, J. K. (2021). Radiation detection conecpts, methods, and devices. 
CRC Press. 
11. He, Z. (2001). Review of the Schockley-Ramo theorem and its application in demiconductor 
gamma-ray detectors. Nuclear Instruments and Methods in Physics Research Section A: 
Accelerators, Spectrometers, Detectors and Associated Equipment, 463, 250–267. 
12. Owens, A., & Kozorezov, A. G. (2006). Single carrier sensing techniques in compound 
semiconductor detectors. Nuclear Instruments and Methods in Physics Research Section A: 
Accelerators, Spectrometers, Detectors and Associated Equipment, 563, 31–36. 
13. Spieler, H. (2005). Semiconductor Detector Systems. Oxford University Press. 
14. Veale, M. C., et al. (2014). Measurements of charge sharing in small pixel CdTe detectors. 
Nuclear Instruments and Methods in Physics Research Section A: Accelerators, Spectrometers, 
Detectors and Associated Equipment, 767, 218–226. 
15. Khalil, M., et al. (2018). Subpixel resolution in CdTe Timepix3 pixel detectors. Journal of 
Synchrotron Radiation, 25, 1650–1657. 
16. Rossi, L., Fischer, P., Rohe, T., & Wermes, N. (2006). Pixel Detectors from fundamentals to 
applications. Springer. 
17. Owens, A. (2020). Semiconductor radiation detectors. CRC Press. 
18. Greiffenberg, D., et al. (2021). Characterization of Chromium Compensated GaAs sensors with 
the charge-integrating Jungfrau readout chip by means of a highly collimated pencil beam. 
Sensors, 21(4), 1550. 
19. Wheater, R. M., et al. (2021). X-ray microbeam characterisationof crystalline defects in small 
pixel GaAs:Cr detectors. Nuclear Instruments and Methods in Physics Research Section A: 
Accelerators, Spectrometers, Detectors and Associated Equipment, 999, 165207. 
20. Blakemore, J. S. (1987). Gallium arsenide. American Institute of Physics. 
21. Veale, M. C., et al. (2019). Cadmium zink telluride pixel detectors for high-intensity x-ray 
imaging at free electron lasers. Journal of Physics D: Applied Physics, 52, 085106. 
22. Cola, A., & Farella, I. (2009). The polarization mechanism in CdTe Schottky detectors. Applied 
Physics Letters, 94, 102113. 
23. Jaeschke, E. J., et al. (2020). Synchrotron light sources and free-electron lasers (2nd ed.). 
Springer-Verlag. 
24. Ballabringa, R. (2016). Review of hybrid pixel detector readout ASICs for spectroscopic 
imaging. Journal of Instrumentation, 11, P01007. 
25. Rota, L. (2019). Design of ePixM, a fully-depleted monolithic CMOS active pixel sensor for 
soft X-ray experiements at LCLS-II. Journal of Instrumentation, 14, C12014.

Charge Sharing 
in Single-Photon-Counting Detectors 
Aleksandra Krzyzanowska 
1 
Introduction 
Semiconductor pixelated position sensitive sensors are widely used in imaging and 
spectroscopic applications. The integration of analog and digital structures and 
CMOS-technology-scaling made implementation of detectors with pixel sizes even 
down to tens of micrometers possible. A hybrid pixel detector consists of a pixelated 
sensor connected electrically and mechanically via bump-bonding to an array of 
electronic readout channels. When an X-ray photon interacts with a detector, it 
deposits energy in a sensor volume. Electron-hole pairs are created in the sensor, 
and the charge carriers drift towards the electrodes as a result of a bias voltage 
applied. 
Detectors can be divided into those working in the integrating and single photon 
counting modes. In the integrating systems, signals induced by the incoming pho-
tons are integrated over a given time exposure, ampliﬁed, and digitised. However, 
this mode of operation, proposed to deal with high intensity of photon ﬂux, has a 
limited dynamic range and a low signal-to-noise ratio because of integration of the 
noise. In the single-photon-counting (SPC) systems the photons are processed one 
by one, and in general, both the photon energy and the interaction position can be 
measured. Such a solution offers noise reduction, high dynamic range, and enhanced 
spatial resolution. However, SPC systems face limitations in operation under high-
ﬂux conditions. The answer to this problem is, on the one hand, optimisation of the 
readout channel processing speed and, on the other hand, minimisation of the pixel 
size, which allows a detector to accept more photons per unit area. 
A. Krzyzanowska () 
AGH University of Science and Technology, Krakow, Poland 
e-mail: krzyzanowska@agh.edu.pl 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
C. Hansson, K. (Kris) Iniewski (eds.), X-ray Photon Processing Detectors, 
https://doi.org/10.1007/978-3-031-35241-6_2
27

28
A. Krzyzanowska
However, when the pixel sizes become smaller, the charge sharing phenomenon 
starts playing an important role. While charge clouds drift to the electrodes, they 
spread as a result of diffusion and repulsion. An increase in the cloud size may 
result in charge collection by several neighbouring electrodes, and this phenomenon 
is called charge sharing. In this case, with no circuitry dealing with charge sharing, 
a detector may register more than one simultaneous event, and the signal amplitudes 
are no longer proportional to the deposited energy. Therefore, charge sharing may 
signiﬁcantly distort the energy and spatial resolution, as well as result in an increase 
in the false counts within lower energies in the spectrum and a decrease in the 
number of counts in higher energies in the spectrum. 
To overcome problems caused by the charge sharing effect, on-chip hardware 
algorithms have been proposed, and some of them were implemented in silicon. 
In some applications, an off-chip correction of measured data is also possible. 
Solutions involve the process of estimating total charge based on fractional signals 
and assigning a hit to the pixel with the largest charge deposition. Alternatively, the 
pattern recognition technique, or searching the centre of charge-cloud gravity, has 
been proposed. Performing these tasks always requires the development of a large 
inter-pixel communication system. 
Interestingly, even though the charge sharing effect has a negative impact on the 
spatial resolution of a detector, the resolution can be improved beyond the resolution 
determined by the physical pixel size when information on the proportions of charge 
collected by neighbouring pixels is used to estimate the position of the event. 
This chapter presents the physics of the charge sharing effect, discusses different 
implementations that attempt to overcome charge sharing, and possible ways of 
using the charge sharing effect to the advantage of the detectors. 
2 
Charge Sharing Physics and Modelling 
In a direct detector, X-ray photons are absorbed and directly converted into electron-
hole pairs, whose number depends on the sensor material and the photon energy. 
A hybrid pixel detector, working in the SPC mode, consists of a segmented 
sensor connected to an array of electronic readout channels with a bump-bonding 
technique, which is presented in Fig. 1. A sensor is a system of reverse biased 
diodes and a high resistivity pure layer is used to provide detection with low leakage 
current. A bias voltage is applied to drift charge carriers and induce signals at the 
electrodes for processing by the readout electronics. In an SPC device, each photon 
is processed individually and generally both the interaction position and photon 
energy can be measured. However, if the charge cloud produced by an interacting 
photon spreads out during the drift to the electrodes, it can be detected by more than 
one channel of the readout ASIC. The charge sharing between pixels is presented in 
Fig. 1 for photon B.

Charge Sharing in Single-Photon-Counting Detectors
29
Fig. 1 Charge sharing effect in a hybrid pixel detector. Photon A hits the sensor in the pixel central 
area, thus, the charge is collected by only one electrode and processed by one readout channel. 
Photon B interacts on the pixel edge, and the fractional signals are processed by neighbouring 
readout channels 
The charge cloud is commonly assumed to be Gaussian shaped [1]. The size of 
the cloud arriving at the electrodes can be modelled using a simple diffusion model 
and expressed in terms of the detector parameters, according to Eq. (1) which is 
based on the solution of the diffusion equation [2]: 
StartLayout 1st Row sigma Subscript x Baseline equals StartRoot 2 k upper T left parenthesis d minus lamda right parenthesis squared divided by q upper V EndRoot equals StartRoot 2 upper D t EndRoot comma EndLayoutσx =

2kT (d −λ)2/qV =
√
2Dt,
(1) 
or according to Eq. (2) [3]: 
StartLayout 1st Row r equals r 0 plus 1.15 StartRoot 2 k upper T left parenthesis d minus lamda right parenthesis squared divided by q upper V EndRoot comma EndLayoutr = r0 + 1.15

2kT (d −λ)2/qV ,
(2) 
where σ x is charge cloud sigma, r is deﬁned as the radius of the charge cloud, r0 
is the initial charge cloud width formed in the sensor, d is the sensor thickness, λ 
is the photon interaction depth, V is the the bias voltage, k = 1.38•10−23 J·K−1 
is the Boltzmann constant, T = 300 K is the temperature, and q = 1.602•10−19 
C is the unit charge, D is the diffusion coefﬁcient, t is the collection time. If the 
detector thickness d ≫λ, the particle mean free path λ is negligible. However, as 
shown in [4], absorption depth should be taken into account to process data for high 
resolution imaging. Thus, in the simple diffusion model for simulation purposes 
in the following paragraphs, the mean free paths λ were calculated from the cross 
sections obtained from the NIST X-ray attenuation database [5]. 
It was shown in [6] that the diffusion of the charge cloud is the main factor 
inﬂuencing the spread of the charge cloud, however, the analytical model underes-
timates the size of the charge cloud, which is affected by other processes such as 
repulsion, Compton scattering, and ﬂuorescence. If more detailed calculations are 
needed, Monte Carlo simulations of photon transport and absorption in matter and 
charge carrier transport in the semiconductor sensor can be performed [6–8].

30
A. Krzyzanowska
3 
The Signiﬁcance of Charge Sharing Effect in Small Pixel 
Devices 
Based on the diffusion model the charge cloud sigma can be estimated for detectors 
depending on the sensor material, photon energy and sensor dimensions. To show 
how many photon interactions in a typical detector are subject to charge sharing 
the charge cloud sigma was estimated for two example sensors (Si and CdTe) of 
different thicknesses and bias voltages. The resulting charge cloud sizes with respect 
to pixel sizes are collected in Table 1. The pixel area not affected by charge sharing 
is deﬁned as the pixel area for which 99.7% of the charges resulting from one 
interaction are processed by only one readout channel. Figure 2 visualises the charge 
cloud size with respect to the pixel size. 
Fig. 2 Simulations of the charge cloud spread on the pixel for sample detectors described in Table 
1. The blue circle represents the charge cloud of 3 sigma radius for a photon hitting the pixel centre. 
The gray square represents the pixel area not affected by charge sharing
The results show that for small pixel devices, with the 100 μm pixel pitch 
and smaller, the size of the charge cloud becomes signiﬁcant relative to the 
pixel dimensions. Thus, the charge sharing effect needs to be considered and, 
preferentially, corrected by the dedicated algorithm. The next sections describe the 
aspects of detector operation inﬂuenced by charge sharing and the algorithms that 
allow to deal with charge sharing on and off chip. 
Table 1 Pixel area affected by charge sharing for sample detectors 
Detector 1
Detector 2 
Sensor material
Si
CdTe 
Photon energy (keV)
8
22 
Sensor thickness (μm)
320
1500 
Bias voltage (V)
100
−500 
Pixel size (μm)
100
50
100
50 
Calculated σ x (μm)
5.75
5.75
14.39
14.39 
Calculated σ x/pixel size
0.058
0.115
0.144
0.288 
Pixel area not affected by charge sharing
43%
10%
2%
0% 

Charge Sharing in Single-Photon-Counting Detectors
31
4 
Inﬂuence of Charge Sharing on the SPC Detector 
Performance 
A typical readout channel of an SPC detector consists of a preampliﬁer, which 
is charge sensitive, a pulse shaper, which improves the signal-to-noise ratio, a 
discriminator, which compares the signal with a threshold and a digital circuit, 
processing and storing the information about registered events before transmitting it 
off-chip [9]. In the simplest implementation, a counter is incremented if the signal 
crosses the threshold. When charge sharing occurs, fractional signals are processed 
by neighbouring channels; thus, the same event might be registered multiple times 
or might not be registered at all, depending on threshold settings. This effect can be 
observed on the integral and differential spectra. 
4.1 
Impact on the Number of Registered Counts as a Function 
of Threshold Voltage 
The effect of charge sharing impacts the number of counts measured as a function 
of the threshold voltage, namely, an integral energy spectrum. The cascaded model 
of an SPC detector and simple linear charge division model [10, 11] deﬁned by Eq. 
(3) can be applied to the measured characteristics. 
StartLayout 1st Row upper N left parenthesis upper E Subscript upper T Baseline comma upper E Subscript upper X Baseline right parenthesis equals one half left bracket 1 minus 2 StartFraction normal upper Delta l Over x 0 EndFraction left parenthesis StartFraction upper E Subscript upper T Baseline Over upper E Subscript x Baseline EndFraction minus one half right parenthesis right bracket left bracket 1 minus upper E r f left parenthesis StartFraction upper E Subscript upper T Baseline minus upper E Subscript x Baseline Over sigma StartRoot 2 EndRoot EndFraction right parenthesis right bracket 2nd Row plus StartFraction normal upper Delta l Over x 0 EndFraction StartFraction sigma Over upper E Subscript x Baseline StartRoot 2 pi EndRoot EndFraction e Superscript minus left parenthesis StartFraction upper E Super Subscript upper T Superscript minus upper E Super Subscript x Superscript Over sigma StartRoot 2 EndRoot EndFraction right parenthesis squared EndLayoutN (ET , EX) = 1
2

1 −2 l
x0
ET
Ex
−1
2
 
1 −Erf
ET −Ex
σ
√
2

+l
x0
σ
Ex
√
2π
e
−
 ET −Ex
σ
√
2
2
(3) 
where N is the counts number, ET is the energy threshold, Ex is the X-ray energy, l 
is the charge sharing region width, x0 is the pixel size, σ is the noise sigma. As stated 
by the authors of [12] the linear charge division model describing microstrip and 
large pixels detectors may be insufﬁcient for small pitch pixel detector modelling 
(such as 25 μm pitch), since events occurring in the pixel corners become a 
signiﬁcant part of interactions. The model can be extended in that case [12]. 
Figure 3 presents the measured data and the ﬁtted model described by Eq. (3) 
for the detector consisting of LNPIX ASIC [13] and a 320 μm thick silicon sensor, 
biased with voltages of 62 V and 326 V illuminated with 8 keV photons. 
The charge sharing can be observed on the integral spectrum as the characteristic 
slope dependent on the bias voltage. Low bias leads to a larger charge cloud and 
more signiﬁcant increase of the registered events in the low energy range and a 
decrease of the counted events in the high energy spectrum. In the differential 
spectrum, the charge sharing effect manifests itself in the characteristic plateau

32
A. Krzyzanowska
Fig. 3 Measurements of an X-ray detector with LNPIX ASIC and Si sensor biased with low and 
high voltages (a) integral spectra – measurements and ﬁtted model, for the reference no charge 
sharing case was also modelled. (b) differential spectra 
Fig. 4 The total number of counts registered in the detector as a function of beam position for 
CHASE Jr. chip (a) in the SPC mode and (b) with the charge sharing correction algorithm 
with the higher number of counts, the lower the bias voltage. The reason for this 
behaviour is distorted by charge sharing events registration on pixel edges. 
4.2 
Impact on the Number of Registered Counts as a Function 
of Photon Interaction Position 
The effect of counts loss can be also observed in the tests with precise, pencil photon 
beam scanning the area of the detector. The results of such tests in synchrotron with 
the X-ray detector consisting of a Chase Jr. chip [14] and a 320 μm thick Si detector 
are presented in Fig. 4. The measurements are performed for set threshold in two 
operating modes, namely single-photon-counting with no charge sharing correction 
and with the C8P1 charge sharing correction algorithm enabled. 
Table 2 presents the mean and standard deviation of the number of counts 
registered by the detector in the chosen region of interest (ROI) for the test results 
presented in Fig. 4.

Charge Sharing in Single-Photon-Counting Detectors
33
Table 2 Number of counts in the chosen regions for the chase Jr. chip working with and without 
charge sharing correction [14] 
Mode of operation and region of interest
No of counts Mean 
No of counts Sigma 
Charge sharing correction OFF, all area
5404
1048 
Charge sharing correction ON, all area
5827
108 
Charge sharing correction OFF, pixel central area 
5822
83 
Charge sharing correction ON, pixel central area
5819
101 
The results in Table 2 and Fig. 3 show that the number of counts registered by the 
detector is comparable when the charge sharing correction is enabled or disabled if 
the photon beam reaches the central pixel area. It stays on the same level also for 
the whole ROI including edges only if the charge sharing correction is enabled. If 
the entire detection ROI is examined, the total number of counts decreases when the 
charge sharing correction is disabled. 
Such problems with counting events on pixel borders lead as a consequence to 
the degradation of spatial resolution and detection efﬁciency. Therefore, the results 
prove the importance of charge sharing correction algorithms, especially for small 
pixel devices and thick sensors, for which the charge sharing is more profound. 
5 
Algorithms Dealing with Charge Sharing 
5.1 
Known Solutions Implemented on Chip 
A possible way to overcome limitations caused by charge sharing is to introduce 
advanced counting algorithms in the readout electronics. Known approaches to 
charge sharing mitigation are presented in Table 3. 
Most algorithms [14–19] are based on the summing concept. The fractional 
signals from the adjacent pixels are added, and the total recovered signal undergoes 
discrimination. The pixel from the neighbouring group that received the majority 
of charge is chosen either by comparison of signal amplitudes between the pixels 
or using the Time-over-Threshold technique. Other solutions [20, 21] implement 
pattern recognition algorithms [23, 24], which together with signal summing, allow 
for event position and total energy reconstruction. Another approach [22] involves  
the approximation of a geometric shape of a charge cloud by ﬁnding the centre 
of gravity of an object. Several concepts are proposed or compared in simulations 
[25–27]. It should be noted that charge sharing correction, especially involving 
analog summing, requires implementation of complex inter-pixel communication 
and pixel-to-pixel calibration techniques (such as DC offsets and gains correction) 
[28].

34
A. Krzyzanowska
Table 3 Algorithms implemented on the chip for charge sharing correction 
ASIC
No of pixels 
Pixel size [μm2] 
Process (nm) 
Charge 
reconstruction 
technique 
Pixirad Pixie III 
[15] 
512 × 402
62 × 62
CMOS 160 nm 
Pixel summing mode 
X-Counter [16]
128 × 256
100 × 100
CMOS 180 nm 
Charge sharing 
correction feature 
Medipix3 [17]
256 × 256
55 × 55
CMOS 130 nm 
Charge summing 
algorithm 
Medipix3RX [18] 
128 × 128
110 × 110
CMOS 130 nm 
Charge summing 
algorithm 
Chase Jr. [14]
18 × 24
100 × 100
CMOS 40 nm
C8P1 
miniVIPIC [19]
32 × 32
100 × 100
CMOS 130 nm 
C8P1 
MPIX [20]
96 × 192
100 × 100
CMOS 130 nm 
Multithreshold 
pattern recognition 
FRIC [21]
64 × 64
50 × 50
CMOS 40 nm
Pattern recognition 
COGITO 
prototype [22] 
16 × 16
55 × 55
CMOS 55 nm
COGITO algorithm 
5.2 
Algorithms Limitation – High Count Rate Performance 
The solutions dealing with charge sharing implemented on chip allow to allocate the 
event to the pixel receiving majority of charges from the charge cloud. Additionally, 
if they involve summing, the total photon energy can be retrieved. However, the 
analog summing blocks the front-end of neighbouring pixels for the time of charge 
correction algorithm processing, which results in increasing the pile-up effects 
and, as a consequence, increasing the dead time of the detector. For example, 
the average dead time for the C8P1 algorithm, estimated from the Chase Jr. chip 
measurements using the paralyzable detector model, was τ = 1.01 μs, for the 
SPC mode, τ = 0.21 μs [14]. The dead time measured for the Medipix chip was 
τ = 2.02 μs, in the charge summing mode, and τ = 0.4 μs, for the SPC mode 
[29]. The dead time of the detectors with pattern recognition algorithm, which 
involves summing, also increased compared to the SPC mode, and the high count 
rate performance depended on the pulse shaping time and the charge cloud sigma 
[30]. Figure 5 presents the simulated output vs. input count rates for the detector 
with the pattern recognition algorithm implemented. 
Limitation of the high count rate performance due to the charge summing 
techniques leads to research on new mechanisms that do not increase pile-up, such 
as the coincidence counting bin, which is triggered by coincident events in adjacent 
pixels and provides an estimate of the double counts arising from charge sharing 
[31].

Charge Sharing in Single-Photon-Counting Detectors
35
Fig. 5 Simulations of high count rate performance of a hybrid pixel detector working in an SPC 
mode and with the pattern recognition (PR) algorithm. (Results from [30]) 
6 
Subpixel Algorithms Improving Spatial Resolution 
It was shown in previous sections that the counting performance of the SPC 
detectors suffers from charge sharing in small pixel devices. The solution to this 
problem is implementation of the charge sharing correction algorithms inside the 
readout electronics, which allows for proper spatial allocation of the event and 
photon energy reconstruction. However, even though the charge sharing effect 
has a negative impact on the spatial resolution of a detector, the resolution can 
be improved beyond the resolution determined by the physical pixel size when 
information on the proportions of charge collected by neighbouring pixels is used 
to estimate the position of the event [32]. 
So far, the off-chip method has been presented to acquire high-resolution 
two-dimensional images with integrating pixel and strip detectors equipped with 
MONCH and GOTTHARD chips, respectively [33]. Since the proposed cluster-
ﬁnding algorithm is dedicated to integrating detectors, it must deal with the noise 
and integration of dark current that happens during exposure. Another challenge is to 
acquire large statistics for complete image reconstruction. For the measurements of 
the detector consisting MÖNCH chip, the spatial resolution of 3.5 μm was achieved 
for the pixel pitch of 25 μm [34]. 
The same research group presented in the [35] the ﬁrst implementation of the 
on-chip interpolation algorithm for a microstrip single-photon-counting MYTHEN 
III microstrip detector. A one-dimensional digital communication scheme between 
neighbouring channels was implemented. Each readout channel consists of two 
comparators and three counters, and the logic could be extended to the pixel 
detectors, however, it would require implementation of more complex interpixel 
communication and additional logics for photons hitting pixel corners, and would 
take up more silicon area.

36
A. Krzyzanowska
7 
Conclusions 
Single-photon-counting systems suffer from charge sharing effect, which results 
in the deterioration of spatial and energy resolution of the detector. The smaller 
the detector pixel and the larger the charge cloud that reaches the electrodes, the 
more severe the impact of the charge sharing effect. It was shown that even for 
typical detectors of 100 μm pitch, most of the photon-sensor interaction results in 
charge division between channels. Therefore, it is necessary to implement dedicated 
algorithms to deal with this effect. The charge sharing correction algorithms require 
often complex mixed signal circuitry ﬁtted inside each pixel. Implementation of 
such solutions allows reconstruction of both initial photon energy and interaction 
position, leading to the improvement of detector efﬁciency and spatial resolution. 
However, it should be noted that algorithms based on analog summing deteriorate 
the high count rate performance of the detectors and increase their dead time. 
Although the charge sharing effect has a negative impact on detector performance, 
it can be used to the advantage of the detectors, if the information on proportion of 
charges collected in the neighbouring pixels is used to estimate the photon position. 
Acknowledgements This work was supported by the National Science Centre, Poland, under 
Contract No. UMO- 2018/29/N/ST7/02770. 
References 
1. Turchetta, R. (1993). Spatial resolution of silicon microstrip detectors. Nuclear Instruments 
and Methods in Physics Research A, 335, 44–58. Accessed: Jun. 13, 2018. [Online]. 
Available:
http://www-ucjf.troja.mff.cuni.cz/kodys/works/data_analysis/SourcesMacros/ 
turcheta_resolution.pdf 
2. Lutz, G. (2007). Semiconductor radiation detectors, device physics. Springer Berlin Heidel-
berg. https://doi.org/10.1007/978-3-540-71679-2_1 
3. Veale, M. C., et al. (2014, December). Measurements of charge sharing in small pixel CdTe 
detectors. Nuclear Instruments and Methods in Physics Research A, 767, 218–226. https:// 
doi.org/10.1016/j.nima.2014.08.036 
4. Cartier, S., et al. (2015, March). Study of the signal response of the MÖNCH 25μm pitch 
hybrid pixel detector at different photon absorption depths. Journal of Instrumentation, 10(03), 
C03022. https://doi.org/10.1088/1748-0221/10/03/C03022 
5. NIST XCOM: Photon Cross Sections Database – Introduction. https://physics.nist.gov/ 
PhysRefData/Xcom/Text/intro.html 
6. Nilsson, H. E., Dubari, E., Hjelm, M., & Bertilsson, K. (2002, July). Simulation of photon and 
charge transport in X-ray imaging semiconductor sensors. Nuclear Instruments and Methods 
in Physics Research, Section A: Accelerators, Spectrometers, Detectors and Associated 
Equipment, 487(1–2), 151–162. https://doi.org/10.1016/S0168-9002(02)00959-2 
7. Chmeissani, M., & Mikulec, B. (2001). Performance limits of a single photon counting pixel 
system. Nuclear Instruments and Methods in Physics Research A, 460(1), 81–90. https:// 
doi.org/10.1016/S0168-9002(00)01100-1 
8. Frodh, C., Graafsma, H., Nilsson, H. E., & Ponchut, C. (2006). Characterization of a pixellated 
CdTe detector with single-photon processing readout. Nuclear Instruments and Methods in 
Physics Research A, 563, 128–132. https://doi.org/10.1016/j.nima.2006.01.076

Charge Sharing in Single-Photon-Counting Detectors
37 
9. Ballabriga, R., et al. (2016, January). Review of hybrid pixel detector readout ASICs for 
spectroscopic X-ray imaging. Journal of Instrumentation, 11(01), P01007–P01007. https:// 
doi.org/10.1088/1748-0221/11/01/P01007 
10. Robert Szczygieł, Szybkie, wielokanałowe układy scalone pracuj ˛ace w trybie zlicza-
nia pojedynczych fotonów w systemach detekcji niskoenergetycznego promieniowania X. 
Wydawnictwa AGH, 2012. 
11. Krzyzanowska, A. (2021, December). Measurements of charge sharing in a hybrid pixel 
photon counting CdTe detector. Journal of Instrumentation, 16(12). https://doi.org/10.1088/ 
1748-0221/16/12/C12027 
12. Bergamaschi, A., et al. (2015). Looking at single photons using hybrid detectors. Journal of 
Instrumentation, 10(1). https://doi.org/10.1088/1748-0221/10/01/C01033 
13. Kleczek, R., et al. (2019, September). SPC Pixel IC with 9.4 e− rms Offset Spread, 60 e− 
rms ENC and 70 kfps Frame Rate. ESSCIRC 2019 – IEEE 45th European Solid State Circuits 
Conference (ESSCIRC). https://doi.org/10.1109/ESSCIRC.2019.8902905 
14. Krzyzanowska, A., Deptuch, G. W., Maj, P., Grybos, P., & Szczygiel, R. (2017, September). 
Characterization of the photon counting CHASE Jr., Chip built in a 40-nm CMOS process with 
a charge sharing correction algorithm using a collimated X-ray beam. IEEE Transactions on 
Nuclear Science, 64(9), 2561–2568. https://doi.org/10.1109/TNS.2017.2734821 
15. Bellazzini, R., et al. (2015). PIXIE III: A very large area photon-counting CMOS pixel ASIC 
for sharp X-ray spectral imaging. Journal of Instrumentation, 10, C01032–C01032. https:// 
doi.org/10.1088/1748-0221/10/01/C01032 
16. Ullberg, C., Urech, M., Weber, N., Engman, A., Redz, A., & Henckel, F. (2013). Measurements 
of a dual-energy fast photon counting CdTe detector with integrated charge sharing correction. 
Proceedings of SPIE Medical Imaging, 8668, 86680P-86680P–8. https://doi.org/10.1117/ 
12.2007892 
17. Ballabriga, R., Campbell, M., Heijne, E. H. M., Llopart, X., & Tlustos, L. (2006). The 
Medipix3 prototype, a pixel readout chip working in single photon counting mode with 
improved spectrometric performance. 2006 IEEE Nuclear Science Symposium Conference 
Record, 54(5), 3557–3561. https://doi.org/10.1109/NSSMIC.2006.353767 
18. Ballabriga, R., et al. (2013, February). The Medipix3RX: A high resolution, zero dead-time 
pixel detector readout chip allowing spectroscopic imaging. Journal of Instrumentation, 8(02), 
C02016–C02016. https://doi.org/10.1088/1748-0221/8/02/C02016 
19. Hoff, J., et al. (2014). An on-chip charge cluster reconstruction technique in the miniVIPIC 
pixel readout chip for X-ray counting and timing. In Proceedings of IEEE Nuclear 
Science Symposium and Medical Imaging Conference (pp. 1–11). https://doi.org/10.1109/ 
NSSMIC.2014.7431041 
20. Grybos, P., et al. (2022, January). Pixel readout IC for CdTe detectors operating in single 
photon counting mode with interpixel communication. Journal of Instrumentation, 17(1). 
https://doi.org/10.1088/1748-0221/17/01/C01036 
21. Otﬁnowski, P., Deptuch, G. W., & Maj, P. (2020, January). FRIC – A 50 μm pixel-pitch single 
photon counting ASIC with pattern recognition algorithm in 40 nm CMOS technology. Journal 
of Instrumentation, 15(1). https://doi.org/10.1088/1748-0221/15/01/C01016 
22. Otﬁnowski, P., Deptuch, G. W., & Maj, P. (2018). Asynchronous approximation of a center of 
gravity for pixel detectors’ readout circuits. IEEE Journal of Solid-State Circuits, 1–9. https:// 
doi.org/10.1109/JSSC.2018.2793530 
23. Otﬁnowski, P. (2018, February). Spatial resolution and detection efﬁciency of algorithms 
for charge sharing compensation in single photon counting hybrid pixel detectors. Nuclear 
Instruments and Methods in Physics Research A, 882, 91–95. https://doi.org/10.1016/ 
J.NIMA.2017.10.092 
24. Otﬁnowski, P., Krzyzanowska, A., Grybo´s, P., & Szczygieł, R. (2019). Pattern recognition 
algorithm for charge sharing compensation in single photon counting pixel detectors. Journal 
of Instrumentation, 14(1). https://doi.org/10.1088/1748-0221/14/01/C01017 
25. Hsieh, S. S., & Sjolin, M. (2018). Digital count summing vs analog charge summing for photon 
counting detectors: A performance simulation study. Medical Physics. 

38
A. Krzyzanowska 
26. Pickford Scienti, O. L. P., Bamber, J. C., & Darambara, D. G. (2020, November). Cdte 
based energy resolving, x-ray photon counting detector performance assessment: The effects 
of charge sharing correction algorithm choice. Sensors (Switzerland), 20(21), 1–24. https:// 
doi.org/10.3390/s20216093 
27. Otﬁnowski, P., Maj, P., Deptuch, G., Fahim, F., & Hoff, J. (2017). Comparison of allo-
cation algorithms for unambiguous registration of hits in presence of charge sharing in 
pixel detectors. Journal of Instrumentation, 12(01), C01027–C01027. Accessed: Jun. 30, 
2017. [Online]. Available: http://iopscience.iop.org.000005bl06b8.wbg2.bg.agh.edu.pl/article/ 
10.1088/1748-0221/12/01/C01027/pdf 
28. Krzyzanowska, A., Deptuch, G., Maj, P., Grybo´s, P., & Szczygieł, R. (2018). Addressing of 
imperfection of a hybrid pixel sensor for X-ray detection with a circuit for charge sharing 
cancellation implemented. Journal of Instrumentation, 13(12). https://doi.org/10.1088/1748-
0221/13/12/C12014 
29. Frojdh, E., et al. (2014). Count rate linearity and spectral response of the Medipix3RX chip 
coupled to a 300μm silicon sensor under high ﬂux conditions. Journal of Instrumentation, 
9(04), C04028–C04028. https://doi.org/10.1088/1748-0221/9/04/C04028 
30. Krzyzanowska, A., Otﬁnowski, P., & Grybos, P. (2018, October). Simulations of high count 
rate performance of hybrid pixel detectors with algorithms dealing with charge sharing. 2018 
International Conference on Signals and Electronic Systems, ICSES 2018 – Proceedings, 23– 
26. https://doi.org/10.1109/ICSES.2018.8507325 
31. Hsieh, S. S. (2020, March). Coincidence counters for charge sharing compensation in 
spectroscopic photon counting detectors. IEEE Transactions on Medical Imaging, 39(3), 678– 
687. https://doi.org/10.1109/TMI.2019.2933986 
32. Krzyzanowska, A., & Szczygieł, R. (2021). Simulation study on improving the spatial 
resolution of photon-counting hybrid pixel X-ray detectors. Opto-Electronics Review, 29(4), 
187–191. https://doi.org/10.24425/opelre.2021.139756 
33. Cartier, S., et al. (2014, May). Micron resolution of MÖNCH and GOTTHARD, small pitch 
charge integrating detectors with single photon sensitivity. Journal of Instrumentation, 9(05), 
C05027–C05027. https://doi.org/10.1088/1748-0221/9/05/C05027 
34. Chiriotti, S., et al. (2022, April). High-spatial resolution measurements with a GaAs:Cr sensor 
using the charge integrating MÖNCH detector with a pixel pitch of 25 μm. Journal of 
Instrumentation, 17(4). https://doi.org/10.1088/1748-0221/17/04/P04007 
35. Bergamaschi, A., et al. (2022, November). First demonstration of on-chip interpolation using a 
single photon counting microstrip detector. Journal of Instrumentation, 17(11), C11012. https:/ 
/doi.org/10.1088/1748-0221/17/11/C11012 

Sub-pixel Sensing for Pixelated CdZnTe 
Detectors 
Yuefeng Zhu 
1 
Introduction 
The performance and imaging capability of CdZnTe (CZT) detectors have improved 
steadily over the past decade at University of Michigan [1–9]. Energy resolutions 
around 1% FWHM at 662 keV have been consistently demonstrated using large 
volume (1.5times×1.5times×1.0 cmcubed3 or 2.0times×2.0times×1.5 cmcubed3) pixelated CZT detectors. An 
energy resolution of 0.48% FWHM at 662 keV for single-pixel-triggered events (or 
single-pixel events as we call) has been measured on a 2.0times×2.0times×1.5 cmcubed3 crystal 
using BNL readout ASIC system [10]. With a lower 1.5-keV electronic noise, 
the IDEAS VAD_UM digital ASIC with direct-attachment conﬁguration can give 
0.31% FWHM at 662 keV [11]. This resolution is already close to the 0.2% theoretic 
limit of the CdZnTe detectors. 
These Pixelated CZT detectors are capable of providing 3-D position information 
of gamma-ray interactions within one detector volume. It is a key performance 
parameter for Compton imaging or coded aperture applications [12]. The lateral 
position resolution of CZT detectors using pixelated anodes is limited by the pixel 
pitch. In the pixelated CZT detector design at University of Michigan, the pixel pitch 
is 1.72 mm. As a comparison, the depth sensing technique based on the cathode-
to-anode ratio [1] can give about 0.5 mm depth resolution [10]. It is much more 
precise than the pixel pitch. The relatively poor lateral position resolution limits 
the Compton image angular resolution to roughly 40 degrees FWHM using simple 
back-projection reconstruction [13]. For coded aperture imaging, the impact is more 
signiﬁcant [14]. 
Y. Zhu () 
University of Michigan, Ann Arbor, MI, USA 
e-mail: zhuyuef@umich.edu 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
C. Hansson, K. (Kris) Iniewski (eds.), X-ray Photon Processing Detectors, 
https://doi.org/10.1007/978-3-031-35241-6_3
39

40
Y. Zhu
Better position resolution is desired to improve the imaging capability. A number 
of efforts have been made in the past decades to achieve position resolution better 
than the pitch of the charge collecting electrode for semiconductor detectors. War-
burton [15], Burks et al. [16] and Williams et al. [17] proposed and demonstrated 
a method to obtain improved position resolution based on induced transient signals 
on non-charge-collecting electrodes in striped CdZnTe and HPGe detectors. Marks 
et al. [18], Vickersa and Chakrabarti [19] and Jakubek and Uher [20] studied 
several algorithms to achieve sub-pixel position resolution when an electron cloud 
is collected by several pixels in pixelated detectors. Narita et al. [21] showed the 
difference in the transient signals on neighboring non-charge-collecting pixels in 
pixelated CdZnTe detectors when the gamma-ray interaction position was changed. 
For our detectors, the pixel size of the anode is 1.72 cm as mentioned above. It is 
bigger than or similar as the electron cloud size in the energy range of 0–3 MeV, the 
dynamic range of our detector system [22]. Therefore, the charge-sharing sub-pixel 
position determination method discussed in [18–20] can’t be applied. The transient 
signal method mentioned in [16, 17] is promising. As mentioned in [21], the induced 
transient signals on the neighbor pixels change with the electron cloud location. 
However, since the area of a pixel in our detectors is much smaller than the area 
of the anode strip in [16, 17], the induced transient signals on the non-collecting 
electrodes are expected to be much smaller. It is more challenging to implement the 
transient signal method in the pixelated CdZnTe detectors. 
This article describes the detailed study on a sub-pixel position calculation 
algorithm based on non-charge-collecting transient signals [16, 17] for pixe-
lated CdZnTe detectors. First, a detailed simulation to generate the signal pulse 
waveforms expected from the detection system is presented. Next, several sub-
pixel position calculation algorithms are proposed for single-pixel events, which, 
combined with results from simulations, provides the theoretical limit on the 
best achievable position resolution as a function of electronic noise and energy 
deposition. These simulation results are then compared with the experimental 
data from a 2.0 cmtimes×2.0 cmtimes×1.5 cm CZT detector irradiated with a Superscript 137137Cs 662 keV 
gamma-ray source collimated by a tungsten collimator with a 100 normal muμm opening. The 
result validated the accuracy of the proposed sub-pixel calculation methods. Finally, 
a method for measuring sub-pixel positions for two-pixel triggered events (or two-
pixel events as we call) is presented and discussed. 
2 
The Detector System 
An illustration of a 3-D position-sensitive CZT detector is shown in Fig. 1. The CZT 
detector used in this study is 1.5 cm thick and its dimension is 20times×20times×1.5 mmcubed3. The  
cathode is a simple continuous plane, while the anode consists of an array of 11 times×
11 pixels. Each pixel is 1.66 times×1.66 mmsquared2 with a gap of 60 normal muμm between the pixels. 
The pixel pitch is 1.72 mm. The guard ring is 0.5 mm wide. It is used to reduce the 
leakage current from the side surface of the crystal. The guard ring can be biased

Sub-pixel Sensing for Pixelated CdZnTe Detectors
41
Fig. 1 An illustration of the 
pixelated CdZnTe detector 
used in this study 
up to a certain voltage to steer the electron cloud toward inner pixels to improve the 
detector efﬁciency [23]. 
The readout electronics of the pixelated CdZnTe detectors are ASIC based 
systems. Several readout ASICs have been developed at University of Michigan 
[1, 24–26]. An ASIC called VAD_UM ASIC [26, 27] is used in this study. It was 
jointly developed by University of Michigan, USA and IDEAS, Norway. This ASIC 
is consisted of 130 channels with pre-ampliﬁers and waveform sampling circuits 
in each channel. When an event happens, the induced signal waveforms can be 
sampled and stored in the ASIC. There are 160 sampling capacitor cells for each 
channel. The sampling frequency is up to 80 MHz and can be changed to a lower 
frequency to cover the entire charge drifting window. The stored waveform samples 
are analog signals. They can be readout and digitized by an external ADC. A FPGA 
is required to control the process. The VAD_UM ASIC is also called digital ASIC 
because of its waveform sampling capability. 
The VAD_UM ASIC has four dynamic ranges: 700 keV, 3 MeV, 7 MeV and 
9 MeV. The power consumption is very low, only about 1.6 mW per channel. The 
ASIC can work in either full readout mode for system calibration or sparse readout 
mode for applications. The electronic noise of the system was measured to be about 
2 keV in full readout mode when the ASIC was attached to a CdZnTe detector and 
the detector was biased. 
In this article, a prototype digital readout system was built for a 3 times 33 × 3 pixel 
array for the principle study. The details of this system are given in Sect. 6.1. The  
VAD_UM digital system was used for the charge-sharing sub-pixel study. 
3 
System Modeling 
A simulation was performed to ﬁnd expected pre-ampliﬁer output pulse waveforms. 
These simulated waveform results are then be used to develop and optimize the sub-
pixel position estimation techniques for experimental data. The simulation package 
includes two components: charge transport and induction and electronic noise.

42
Y. Zhu
3.1 
The Signal Induction 
Charge induction on a given electrode can be calculated using the Shockley-Ramo 
theorem [28]. Barrett et al. showed an example to calculate the charge induction 
on electrodes [29]. Kim [22] described in detail a simulation procedure applied for 
pixelated CdZnTe detectors. This article uses a similar simulation method as Kim. 
In the following paragraphs, we will give a simple description of the method. 
The track and velocity of electrons and holes are determined by modeling the 
operating electric ﬁeld in the detector. It is assumed that electrons and holes are 
following electric ﬁeld in the crystal bulk. When the charge reach electrode surface, 
holes are just simply collected by cathode. However, for electrons there are two 
boundary conditions deﬁned to describe their behavior at anode surface based on 
grid bias. If grid is biased, we will assume full charge collection. Electrons that reach 
the gap instead of pixel pads or grid will be further transported along the electric 
ﬁeld between grid and pixels on the anode surface; If grid is unbiased, electrons 
will stay in the location where they reach the anode surface. 
The induced charge on each electrode is calculated from the weighting potential 
along each charge track. The ﬁnal induced signal at time t is then equal to the 
product of the charge quantity and the difference in weighting potential between the 
charge carriers position at time t and its initial position. The operating and weighting 
ﬁelds are complicated in a pixelated detector. This problem is solved numerically 
using an electromagnetic ﬁeld calculation software: Maxwell v11 from Ansoft. 
Figure 2 gives an example of the simulated waveform signal induced on a center 
collecting pixel as well as the pixels that surround it. In this example, each electron 
cloud is modeled as a geometrical point with a total charge equivalent to the energy 
deposition of a 662-keV photon. Two electron clouds are simulated in this ﬁgure, 
one is located at the center of the collecting pixel (thick line) and another is near 
the pixel edge (dashed line). They are both in the middle depth of the detector. For 
this simulation, the cathode bias is negative 3000−3000 V. Because the mobility of holes is much 
lower than that of electrons, only the electron drift was simulated during the charge 
collection time. The trapping of electrons in the detector is not modeled because it 
is not a critical factor in this study as will be discussed in Sect. 5. 
The signal induced on the center collecting pixel is very small in the detector bulk 
until the electron cloud drifts to the vicinity of the pixelated anode. In this anode 
region, the induced signal rises rapidly because of the large gradients in weighting 
potential and eventually, it will rise to an amplitude close to the original 662 keV. 
There is a small amplitude deﬁcit due to the trapped holes in the detector bulk. 
Additionally, electron trapping can contribute to the deﬁcit of the induced signal 
amplitude. 
For the non-collecting neighboring pixels, the signals ﬁrst rise as the electron 
cloud travels from the detector bulk to near the anode surface and then drop when the 
electron cloud enters the anode region. The boundary of the anode region is deﬁned 
as the depth where the maximum of this “transient signal” happens, roughly one 
pixel size away from the anode surface. Eventually, the signals will drop to zero or

Sub-pixel Sensing for Pixelated CdZnTe Detectors
43
0 
0.1 0.2 0.3 0.4 0.5 0.6 
−10 
10 
30 
50 
70 
Neighbor Non−Collecting Pixel 
Position 11 
0 
0.1 0.2 0.3 0.4 0.5 0.6 
−10 
10 
30 
50 
70 
Neighbor Non−Collecting Pixel 
Position 12 
0 
0.1 0.2 0.3 0.4 0.5 0.6 
−10 
10 
30 
50 
70 
Neighbor Non−Collecting Pixel 
Position 13 
0 
0.1 0.2 0.3 0.4 0.5 0.6 
−10 
10 
30 
50 
70 
Neighbor Non−Collecting Pixel 
Position 21 
Signal Amplitude (keV) 
0 
0.1 0.2 0.3 0.4 0.5 0.6 
0 
200 
400 
600 
800 
1000 
Center Collecting Pixel 
Position 22 
0 
0.1 0.2 0.3 0.4 0.5 0.6 
−10 
10 
30 
50 
70 
Neighbor Non−Collecting Pixel 
Position 23 
0 
0.1 0.2 0.3 0.4 0.5 0.6 
−10 
10 
30 
50 
70 
Neighbor Non−Collecting Pixel 
Position 31 
0 
0.1 0.2 0.3 0.4 0.5 0.6 
−10 
10 
30 
50 
70 
Neighbor Non−Collecting Pixel 
Position 32 
Time (s) 
0 
0.1 0.2 0.3 0.4 0.5 0.6 
−10 
10 
30 
50 
70 
Neighbor Non−Collecting Pixel 
Position 33 
Fig. 2 Signal induction for a collecting pixel (pixel 22) and its 8 neighbors. The responses 
correspond to a single simulated 662-keV point electron cloud collected by the center pixel. The 
transient signals of the neighbor pixels are shown for two events: one happened underneath the 
center (thick line) and the other near the edge (dashed line) of the collecting pixel and close to 
pixel 21. They are both located in the middle depth of the detector 
to a negative value (hereafter referred as a “negative tail”) due to the trapped holes. 
The amplitude of the negative tail depends on the depth of the initial interaction. 
When the interaction happens at the cathode surface, the neighboring pixel signal 
will drop to zero. If the interaction is in the detector bulk or the anode region, the 
negative tail occurs. The negative tail is the biggest if the interaction happens at the 
anode region boundary. 
The peak signal amplitude of the neighboring pixel’s transient waveform is very 
sensitive to the lateral position (or sub-pixel position) of the interaction position. As 
seen in Fig. 2, the induced signal on the neighboring pixels changes signiﬁcantly 
from the thick line to the dashed line when the electron cloud moves from the 
pixel center to the edge. The reason is that when a transient signal reaches its 
maximum the distance between the electron cloud and a neighboring pixel depends 
signiﬁcantly on lateral interaction position. As was mentioned earlier, the transient

44
Y. Zhu
signal reaches its maximum when the electron cloud is roughly one pixel length 
away from the anode. At this time, the lateral distance from the electron cloud to 
the center of a neighboring pixel ranges from half a pixel to one-and-a-half pixels 
for interaction location on one edge of the charge collecting pixel or the other. As 
a result, the total 3-D distance from the electron cloud to a neighboring pixel at 
the transient peaking time strongly depends on the lateral position of the electron 
cloud at that time. Therefore, the peak amplitude of the neighboring transient signals 
actually gives the lateral position where the electron cloud enters the anode region. 
An interaction location is the start point of an electron cloud trajectory. if an 
electron cloud trajectory is a straight line perpendicular to the cathode and anode 
surface, the neighboring transient signal peak amplitudes would be directly related 
to the initial lateral interaction position. However, the electron cloud trajectory 
can be bent because of grid bias or material defects. The impacts of those factors 
on neighboring pixel transient signals are different. The grid bias is used to help 
improve charge collection efﬁciency and it is normally very small comparing to 
the cathode bias. Its impact on an electron cloud trajectory is negligible before the 
electron cloud gets very close to the anode surface, so the initial interaction position 
can still be obtained by the neighboring transient signals. As for material defects, it 
can alter an electron cloud trajectory signiﬁcantly when the electron cloud is still in 
the detector bulk. In this case, the neighboring pixel transient signals won’t be able 
to provide initial interaction positions. 
If a detector crystal has very good quality and is free of defects, we can use 
the peak amplitude of the transient signals to determine the sub-pixel position of 
an interaction. However, as we can see in Fig. 2, the transient signals are very fast 
and have very small amplitude compared to the charge collection signal. Electronic 
noise is expected to be the limiting factor in how accurately we can determine the 
sub-pixel interaction position. 
3.2 
Electronic Noise Simulation 
Pullia and Riboldi [30] provide a method to precisely simulate the electronic noise 
of a detector system in the time domain. Simulation of the parallel and serial noise 
in our detector system is based on experimental data. The 1/f noise, is assumed to 
be negligible for our ﬁrst-order approximation. In this case, the noise parameters 
that need to be constructed for the noise model are the parallel- and serial-noise 
amplitudes, which are assigned to a and b respectively. The noise density function 
can be written as 
upper S squared equals a squared plus b squared divided by omega squared periodS2 = a2 + b2/ω2.
(1) 
Where upper S squaredS2 is in unit of k e upper V squared divided by upper H zkeV 2/Hz and omegaω is the circular frequency. To measure a and 
b, we can apply a CR-RCSuperscript 44 ﬁlter to the signal waveform and search for the lowest 
noise amplitude upper V Subscript nVn and the corresponding shaping time tau Subscript o p tτopt. The noise amplitudes

Sub-pixel Sensing for Pixelated CdZnTe Detectors
45
can then be calculated as 
StartLayout 1st Row 1st Column a squared 2nd Column equals upper V Subscript n Superscript 2 Baseline times tau Subscript o p t Baseline times upper C 1 2nd Row 1st Column b squared 2nd Column equals upper V Subscript n Superscript 2 Baseline divided by tau Subscript o p t Baseline times upper C 2 comma EndLayout
a2 = V 2
n × τopt × C1
b2 = V 2
n /τopt × C2,
(2) 
where upper C 1C1 and upper C 2C2 are the coefﬁcients calculated from the response function of the 
ﬁlter. For a CR-RCSuperscript 44 ﬁlter, upper C 1C1 and upper C 2C2 are 220 and 31.4 respectively. If a different 
ﬁlter is applied, upper C 1C1 and upper C 2C2 would have different values. The near-optimal shaping 
time of a CR-RCSuperscript 44 ﬁlter for the collecting pixel signal was measured to be about 
250 ns (at a peaking time of 1 normal muμs) and the noise FWHM was 4 keV. With these 
parameters, a general noise model can be constructed for the waveform model. 
3.3 
Digital Filter Design 
To compare the performance of estimating the transient signal amplitude on 
neighboring anode pixels, several digital ﬁlters, including CR-RC, triangular, and 
the theoretical optimal ﬁlter, were studied. The theoretical optimal ﬁlter is obtained 
based on the method described by Radeka [31]. For collecting pixels, the signal-
to-noise ratio of the optimal ﬁlter is shown in Fig. 3a. However, the optimal ﬁlter 
formula described in [31] cannot be directly applied to the neighboring transient 
signal. In [31], the signal amplitude is chosen to be the maximum value of the 
ﬁltered signal. However, as will be discussed in Sect. 4, it is the difference between 
the maximum and minimum value of the ﬁltered transient signal that provides a 
useful transient signal amplitude. In this case, the signal amplitude for transient 
signals can be written as 
StartLayout 1st Row 1st Column v Subscript o 2nd Column equals v Subscript o Baseline left parenthesis t Subscript m a x Baseline right parenthesis minus v Subscript o Baseline left parenthesis t Subscript m i n Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals StartFraction 1 Over 2 pi EndFraction integral Subscript negative normal infinity Superscript normal infinity Baseline upper H left parenthesis omega right parenthesis upper V Subscript i Baseline left parenthesis omega right parenthesis left parenthesis e Superscript j omega t Super Subscript m a x Superscript Baseline minus e Superscript j omega t Super Subscript m i n Superscript Baseline right parenthesis d omega period EndLayout
vo = vo(tmax) −vo(tmin)
= 1
2π
 ∞
−∞
H(ω)Vi(ω)(ejωtmax −ejωtmin)dω.
(3) 
Fig. 3 The signal-to-noise 
ratio of different shaping 
ﬁlters for: (a) the  
charge-collecting pixel signal, 
and (b) the non-collecting 
pixel transient signal
0
500
1000
1500
2000
2500 
200 
300 
400 
500 
600 
Shaping Time (ns) 
Signal to Noise Ratio 
(a)
 
 
CR−RC filter 
CR−RC4 filter 
Triangular filter 
Theoretic optimal filter 
0
100
200
300
400
500
600
700
800
900
1000 
2 
4 
6 
8 
10 
12 
Shaping Time (ns) 
Signal to Noise Ratio 
(b)
 
 

46
Y. Zhu
Here, v Subscript o Baseline left parenthesis t Subscript m a x Baseline right parenthesisvo(tmax) and v Subscript o Baseline left parenthesis t Subscript m i n Baseline right parenthesisvo(tmin) are the signal maximum and minimum. upper H left parenthesis omega right parenthesisH(ω) is the 
Fourier transform of the ﬁlter and upper V Subscript i Baseline left parenthesis omega right parenthesisVi(ω) is the Fourier transform of the noise-
free transient signal proﬁle (or the mean input signal). If we know the noise power 
density function upper S Subscript i Baseline left parenthesis omega right parenthesisSi(ω), the noise amplitude can be calculated as 
StartLayout 1st Row upper V Subscript n Superscript 2 Baseline equals StartFraction 1 Over 2 pi EndFraction integral Subscript negative normal infinity Superscript normal infinity Baseline StartAbsoluteValue upper H left parenthesis omega right parenthesis EndAbsoluteValue squared upper S Subscript i Baseline left parenthesis omega right parenthesis d omega EndLayout V 2
n = 1
2π
 ∞
−∞
|H(ω)|2 Si(ω)dω
(4) 
The signal to noise ratio can then be expressed as 
StartLayout 1st Row eta squared equals StartFraction v Subscript o Superscript 2 Baseline Over upper V Subscript n Superscript 2 Baseline EndFraction equals StartFraction StartAbsoluteValue integral Subscript negative normal infinity Superscript normal infinity Baseline upper H left parenthesis omega right parenthesis upper V Subscript i Baseline left parenthesis omega right parenthesis left parenthesis e Superscript j omega t Super Subscript m a x Superscript Baseline minus e Superscript j omega t Super Subscript m i n Superscript Baseline right parenthesis d omega EndAbsoluteValue squared Over 2 pi integral Subscript negative normal infinity Superscript normal infinity Baseline StartAbsoluteValue upper H left parenthesis omega right parenthesis EndAbsoluteValue squared upper S Subscript i Baseline left parenthesis omega right parenthesis d omega EndFraction comma EndLayout η2 = v2
o
V 2n
=
 ∞
−∞H(ω)Vi(ω)(ejωtmax −ejωtmin)dω
2
2π
 ∞
−∞|H(ω)|2 Si(ω)dω
,
(5) 
The optimal signal-to-noise ratio [31] occurs when the frequency response of the 
ﬁlter is 
StartLayout 1st Row 1st Column upper H left parenthesis omega right parenthesis 2nd Column equals k StartFraction upper V Subscript i Superscript asterisk Baseline left parenthesis omega right parenthesis Over upper S Subscript i Baseline left parenthesis omega right parenthesis EndFraction left parenthesis e Superscript minus j omega t Super Subscript m a x Superscript Baseline minus e Superscript minus j omega t Super Subscript m i n Superscript Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals k StartFraction upper V Subscript i Superscript asterisk Baseline left parenthesis omega right parenthesis Over upper S Subscript i Baseline left parenthesis omega right parenthesis EndFraction e Superscript minus j omega t Super Subscript m a x Superscript Baseline left bracket 1 minus e Superscript minus j omega left parenthesis t Super Subscript m i n Superscript minus t Super Subscript m a x Superscript right parenthesis Baseline right bracket period EndLayout
H(ω) = k V ∗
i (ω)
Si(ω) (e−jωtmax −e−jωtmin)
= k V ∗
i (ω)
Si(ω) e−jωtmax

1 −e−jω(tmin−tmax)
.
(6) 
upper V Subscript i Superscript asterisk Baseline left parenthesis omega right parenthesisV ∗
i (ω) is the conjugate of the Fourier transform of the input signal, k is a constant, 
and e Superscript minus j omega t Super Subscript m a xe−jωtmax is a time-shift term. Neither k nor e Superscript minus j omega t Super Subscript m a xe−jωtmax affect the signal-to-noise 
ratio, thus, they can be eliminated to simplify the equations. Hence, the optimal ﬁlter 
for neighboring pixel signals is 
StartLayout 1st Row 1st Column upper H Subscript o p t Superscript n b Baseline left parenthesis omega right parenthesis 2nd Column equals StartFraction upper V Subscript i Superscript asterisk Baseline left parenthesis omega right parenthesis Over upper S Subscript i Baseline left parenthesis omega right parenthesis EndFraction left bracket 1 minus e Superscript minus j omega left parenthesis t Super Subscript m i n Superscript minus t Super Subscript m a x Superscript right parenthesis Baseline right bracket period EndLayout H nb
opt(ω) = V ∗
i (ω)
Si(ω)

1 −e−jω(tmin−tmax)
.
(7) 
The time interval between occurrence of the maximum and minimum signal 
amplitude of the shaped transient signal depends on the digital ﬁlter. As a result, 
it is difﬁcult to analytically derive the solution for an optimal ﬁlter. However, a 
solution can be found numerically by searching through all possible time intervals. 
The dashed line in Fig. 3b gives the signal-to-noise ratio of the optimal ﬁlters for 
simulated neighbor transient signals. The best signal-to-noise ratio can only be 
achieved with the optimal ﬁlter. As Fig. 3b shows, the CR-RC ﬁlter performs better 
than the other three ﬁlters and its best signal-to-noise ratio at the shaping time of 
200 ns is very close to the optimal ﬁlter. Because the transient signal pulse waveform 
is a sensitive function of the 3-D position of interactions, it is very difﬁcult to apply 
the optimal ﬁlter to calculate the sub-pixel position experimentally. 
Therefore, we use a CR-RC ﬁlter for the transient signal ﬁlter as a good practical 
approximation. Based on the results in Fig. 3b, it is possible to achieve position 
resolution similar to what can be obtained using the optimal ﬁlter.

Sub-pixel Sensing for Pixelated CdZnTe Detectors
47
4 
Sub-pixel Position Calculation Algorithm 
The maximum amplitude of the transient signals of the 8 neighboring pixels can 
be compared quantitatively to determine the sub-pixel position of an interaction. 
However, the transient signal maximum decreases as the interaction position 
changes from the cathode side toward the anode side. The signal becomes very 
small when the interaction is in the anode region. If we choose the signal maximum 
to calculate the sub-pixel position, the algorithm coefﬁcients may vary from depth 
to depth and the sub-pixel position resolution will be poor in the anode region. 
Fortunately, the signal maximum occurs in a certain depth for the interactions 
located at a particular lateral position, where the electron cloud just drifts past the 
boundary of the anode region. The weighting-potential change from this depth to 
the anode surface (charge fully collected) is independent of the initial depth of the 
electron cloud when this interaction occurs in the detector bulk. In other words, 
the signal difference between the signal maximum and its negative tail, the signal 
minimum, is not a function of interaction depth at a particular lateral position 
and in detector bulk. Therefore, we deﬁne the transient signal amplitude as the 
value difference between the signal maximum and minimum amplitudes. In the 
anode region this transient signal amplitude is no longer independent of interaction 
depth. However, it is still much bigger than the transient signal maximum, which is 
actually zero and thus this deﬁnition extends the active region where we can perform 
subpixel position calculation. 
Transient signal amplitude is the key measurable parameter that is used to 
calculate sub-pixel interaction position. A method referred to as the opposing-
neighboring ratio uses these neighbor pixel amplitudes to calculate the sub-pixel 
centroid position of an electron cloud. If the position of the center collection pixel 
and its 8 neighbors is labeled as shown in Fig. 2, the opposing-neighboring ratio 
along the lateral x direction, upper R n Subscript xRnx can be written as 
upper R n Subscript x Baseline left parenthesis x comma y comma z right parenthesis equals StartFraction s 21 left parenthesis x comma y comma z right parenthesis minus s 23 left parenthesis x comma y comma z right parenthesis Over s 21 left parenthesis x comma y comma z right parenthesis plus s 23 left parenthesis x comma y comma z right parenthesis EndFraction commaRnx(x, y, z) = s21(x, y, z) −s23(x, y, z)
s21(x, y, z) + s23(x, y, z),
(8) 
where s 21 left parenthesis x comma y comma z right parenthesiss21(x, y, z) and s 23 left parenthesis x comma y comma z right parenthesiss23(x, y, z) are the transient signal amplitudes on the middle-
left and the middle-right neighbors respectively induced by an electron cloud located 
at (x,y,z). As described above, the transient signal amplitude is not a function of 
depth z unless the interaction happens in the anode region. Therefore, Eq. (8) can be 
simpliﬁed as 
upper R n Subscript x Baseline left parenthesis x comma y right parenthesis equals StartFraction s 21 left parenthesis x comma y right parenthesis minus s 23 left parenthesis x comma y right parenthesis Over s 21 left parenthesis x comma y right parenthesis plus s 23 left parenthesis x comma y right parenthesis EndFraction periodRnx(x, y) = s21(x, y) −s23(x, y)
s21(x, y) + s23(x, y).
(9) 
Here, upper R n Subscript xRnx is not only a function of the lateral x coordinate of the electron cloud, 
but also the lateral y coordinate. If a electron cloud is moving along the y direction, 
its distance to the middle-left neighbor (pixel 21) and middle-right neighbor (pixel 
23) will change, resulting in different induced signals on those neighbors. However,

48
Y. Zhu
if the left three neighbors and right three neighbors are considered as a whole 
respectively, the mean distance from the moving electron cloud to these neighbors 
will change much less. Therefore, a new signal ratio can be written as 
StartLayout 1st Row 1st Column s Subscript l Baseline left parenthesis x right parenthesis almost equals s Subscript l Baseline left parenthesis x comma y right parenthesis equals 2nd Column s 11 left parenthesis x comma y right parenthesis plus s 21 left parenthesis x comma y right parenthesis plus s 31 left parenthesis x comma y right parenthesis 2nd Row 1st Column s Subscript r Baseline left parenthesis x right parenthesis almost equals s Subscript r Baseline left parenthesis x comma y right parenthesis equals 2nd Column s 13 left parenthesis x comma y right parenthesis plus s 23 left parenthesis x comma y right parenthesis plus s 33 left parenthesis x comma y right parenthesis 3rd Row 1st Column upper R Subscript x Baseline left parenthesis x right parenthesis equals 2nd Column StartFraction s Subscript l Baseline left parenthesis x right parenthesis minus s Subscript r Baseline left parenthesis x right parenthesis Over s Subscript l Baseline left parenthesis x right parenthesis plus s Subscript r Baseline left parenthesis x right parenthesis EndFraction period EndLayout
sl(x) ≈sl(x, y) =s11(x, y) + s21(x, y) + s31(x, y)
sr(x) ≈sr(x, y) =s13(x, y) + s23(x, y) + s33(x, y)
Rx(x) =sl(x) −sr(x)
sl(x) + sr(x).
(10) 
We call this the opposing-neighboring ratio. The relationship between upper R Subscript xRx and 
the x coordinates is calculated by simulation for different lateral y positions and 
depths z. The result is presented in Fig. 4. The change in upper R Subscript xRx due to the variation 
of the lateral y position and the depth z of an interaction is given by the error bar. 
As can be seen, such change is small compared to the pixel size, indicating that 
the approximation of Eq. (10) is valid. Additionally, Fig. 4 shows that the upper R Subscript xRx versus 
x curve is close to a straight line. To a ﬁrst order approximation, we can employ 
a linear function to model the signal ratio upper R Subscript xRx versus x in the sub-pixel position 
calculation. 
In the y direction, the opposing-neighboring ratio upper R Subscript yRy can be formed the same 
way as for upper R Subscript xRx: 
StartLayout 1st Row 1st Column s Subscript t Baseline left parenthesis y right parenthesis almost equals s Subscript t Baseline left parenthesis x comma y right parenthesis equals 2nd Column s 11 left parenthesis x comma y right parenthesis plus s 12 left parenthesis x comma y right parenthesis plus s 13 left parenthesis x comma y right parenthesis 2nd Row 1st Column s Subscript b Baseline left parenthesis y right parenthesis almost equals s Subscript b Baseline left parenthesis x comma y right parenthesis equals 2nd Column s 31 left parenthesis x comma y right parenthesis plus s 32 left parenthesis x comma y right parenthesis plus s 33 left parenthesis x comma y right parenthesis 3rd Row 1st Column upper R Subscript y Baseline left parenthesis y right parenthesis equals 2nd Column StartFraction s Subscript t Baseline left parenthesis y right parenthesis minus s Subscript b Baseline left parenthesis y right parenthesis Over s Subscript t Baseline left parenthesis y right parenthesis plus s Subscript b Baseline left parenthesis y right parenthesis EndFraction period EndLayout
st(y) ≈st(x, y) =s11(x, y) + s12(x, y) + s13(x, y)
sb(y) ≈sb(x, y) =s31(x, y) + s32(x, y) + s33(x, y)
Ry(y) =st(y) −sb(y)
st(y) + sb(y).
(11) 
−1
−0.5
0
0.5
1 
−0.8 
−0.6 
−0.4 
−0.2 
0 
0.2 
0.4 
0.6 
0.8 
X Coordinate of the Interaction Position (mm) 
Opposing Neighboring Ratio 
Fig. 4 The relationship between the opposing-neighboring ratio upper R Subscript xRx and real lateral x coordination 
calculated by simulation. The curve gives upper R Subscript xRx as a function of x when the electron cloud is in the 
middle of a pixel (y equals 0y = 0) and near the cathode surface (z equals 0z = 0). The error bars mark the range of 
the upper R Subscript xRx if the lateral y position and the depth z of the electron cloud change in the pixel volume. 
The dashed lines mark the boundary of a pixel

Sub-pixel Sensing for Pixelated CdZnTe Detectors
49
Besides the opposing-neighboring ratio, there are at least two more ratios that 
can be used to calculate the electron cloud position: 
1. the ratio between the neighboring pixel signals and the center pixel signal 
2. the signal ratio between two corner neighbors and the center pixel signal. 
We refer to (1) as the neighbor-to-center ratio, and (2) the corner-neighbor ratio. 
The neighbor to center ratio (upper R c Subscript xRcx and upper R c Subscript yRcy) and corner neighbor ratio (upper R c r Subscript xRcrx and 
upper R c r Subscript yRcry) are expressed as 
StartLayout 1st Row upper R c Subscript x Baseline left parenthesis x right parenthesis equals StartFraction s Subscript l Baseline left parenthesis x right parenthesis Over s 22 EndFraction 2nd Row upper R c Subscript y Baseline left parenthesis y right parenthesis equals StartFraction s Subscript t Baseline left parenthesis y right parenthesis Over s 22 EndFraction EndLayout
Rcx(x) = sl(x)
s22
Rcy(y) = st(y)
s22
(12) 
and 
StartLayout 1st Row upper R c r Subscript x Baseline left parenthesis x comma y right parenthesis equals StartFraction s 11 left parenthesis x comma y right parenthesis minus s 13 left parenthesis x comma y right parenthesis Over s 22 EndFraction 2nd Row upper R c r Subscript y Baseline left parenthesis x comma y right parenthesis equals StartFraction s 11 left parenthesis x comma y right parenthesis minus s 31 left parenthesis x comma y right parenthesis Over s 22 EndFraction EndLayout
Rcrx(x, y) = s11(x, y) −s13(x, y)
s22
Rcry(x, y) = s11(x, y) −s31(x, y)
s22
(13) 
where s 22s22 is the charge collected by the center pixel. These two methods have their 
shortcomings. For the neighbor-to-center ratio, the ratio is not a linear function 
of the actual electron cloud position. For the corner-neighbor ratio, the ratio is a 
function of both x and y coordinates and thus is difﬁcult to calibrate. Therefore, the 
opposing neighbors’ transient ratio is preferred. 
However, neighbor-to-center ratio and corner-neighbor ratio require fewer neigh-
boring pixel signals than the opposing-neighboring ratio. The neighbor-to-center 
ratio requires three neighbors on one side of a collecting pixel. The corner-neighbor 
ratio method requires two corner neighbors. For multi-pixel interaction events, the 
induced signal on a neighboring pixel from a electron cloud may be polluted by the 
signal induction from another separate electron cloud. In this situation, opposing-
neighboring ratio may not be applicable and then the neighbor-to-center ratio or 
corner-neighbor ratio could be employed to determine the sub-pixel position for 
each electron cloud. Section 7 addresses this scenario in greater detail. 
5 
Estimate of Sub-pixel Position Resolution by Simulation 
The precision of the sub-pixel position obtained by the opposing-neighboring ratio 
method can be estimated based on the system model discussed in Sect. 3. The results 
are given in Fig. 5. In this simulation, the energy deposition of the gamma ray is 
set to be 662 keV and the electronic noise is set to 4 keV FWHM. The cathode is

50
Y. Zhu
−0.6
−0.4
−0.2
0
0.2
0.4
0.6 
−0.02 
−0.01 
0 
0.01 
0.02 
x (mm) 
Xmeasured−Xtrue (mm) 
(a) 
−0.6
−0.4
−0.2
0
0.2
0.4
0.6 
0.1 
0.12 
0.14 
0.16 
0.18 
0.2 
x (mm) 
FWHM (mm) 
(b) 
Fig. 5 Sub-pixel simulation performance results: (a) the offset difference between the mean 
calculated position and the true simulated position based on the linear assumption, and (b) the  
position variation in terms of FWHM due to 4 keV electronic noise. The offset and position 
variation is plotted for the x coordinate. The error bars mark the offset and FWHM range as the 
electron cloud position is shifted along y and z directions through the volume of the collecting-
pixel column 
assumed to be biased at negative 3000−3000 V and the grid is at negative 100−100 V. The sampling frequency 
is set as 100 MHz. The energy is assumed to be deposited at a single space point 
rather than a extended electron cloud for principle study. Figure 5a gives the bias  
of the calculated position using the linear-relation assumption of upper R Subscript xRx (as deﬁned 
in Eq. (10)) versus  x from the true energy-deposition position. Figure 5b presents 
the calculated sub-pixel position uncertainty due to the 4 keV electronic noise. The 
calculated position bias is smaller than the position uncertainty, indicating that the 
linear assumption is an appropriate model. 
The dominant source of uncertainty in the calculated sub-pixel position is the 
electronic noise. Uncertainty in the collected charge due to charge production in 
the ionization process and charge trapping will generate proportional changes to the 
signals induced on all 8 neighbors. As a result, the associated ﬂuctuation cancel out 
using the signal ratio. As seen in Fig. 5b, the expected sub-pixel position resolution 
at 662 keV is below 180 normal muμm. This simulation result assumes energy is deposited 
at a single point. In reality, energy is deposited in an extended electron cloud. The 
calculated sub-pixel position for a real interaction is the centroid of the electron 
cloud. As a result, the size of the electron cloud will introduce additional uncertainty 
in the determination of the interaction position.

Sub-pixel Sensing for Pixelated CdZnTe Detectors
51
6 
Experimental Measurements and Analysis 
6.1 
Measured Sub-pixel Position Resolution with Collimator 
Results from a collimation experiment provide an experimental measure of the sub-
pixel position resolution. Figure 6 illustrates the design of the collimator experiment. 
The collimator is made of 6-cm thick tungsten with a 100-normal muμm opening, separated 
by 3 cm away the bottom surface of the detector. The opening of the collimator is 
aligned parallel with the edge of a target pixel. A Superscript 137137Cs point source is placed in 
the collimator and used to irradiate a narrow section of the pixel from the cathode 
side of the detector. The irradiated pixel and its 8 neighbors are connected to eV-
Products model 5093 preampliﬁers. Each preampliﬁer signal is fed into a channel of 
a GaGe Octopus CompuScope model 8389 multichannel digitizer card (8 channels 
per card, 14-bit resolution, 125 MHz), operating at a 100 MSa/s sampling rate (10-ns 
sampling interval). 
The detector is manufactured by eV-Products. The detector schematics are 
identical to those found in the system model discussion in Sect. 3. During operation, 
the cathode is biased at negative 3000−3000 V but the grid was unintentionally left unbiased. 
However the different grid bias shouldn’t impact the conclusion we have achieved 
in the simulation. 
The collimator is positioned near the center of the pixel at ﬁrst and then moved 
toward the edge with a step size of 100 normal muμm. For each collimator position, photopeak 
events from single-pixel interactions are selected for use in the sub-pixel study. For 
neighbor-pixel signals, a CR-RC ﬁlter with 200-ns shaping time is employed. This 
Fig. 6 The collimator design for experimentally measuring sub-pixel position resolution

52
Y. Zhu
0
100
200
300 
0.05 
0.1 
0.15 
0.2 
0.25 
0.3 
0.35 
0.4
(a) 
Collimator Position (m) 
Ratio (Arbitrary Unit) 
Meansured points 
Linear fit 
0
100
200
300 
300 
310 
320 
330 
340 
350 
360 
370
(b) 
Collimator position (m) 
Position FWHM (m) 
Fig. 7 Measured sub-pixel resolution at 662 keV: (a) the mean neighboring pixel ratio for each 
collimator position. This data is ﬁtted by a linear function and the result shows the slope as left parenthesis 9.2 plus or minus 0.5 right parenthesis times 10 Superscript negative 4(9.2 ± 
0.5) × 10−4 and the interception as 0.072 plus or minus 0.0090.072 ± 0.009 with 95% conﬁdence; (b) the FWHM of the 
position variance at each collimator position. The origin of x axis of these plots are the start location 
of the collimator instead of the center of the pixel 
ﬁlter choice is based on the simulation results described in Sect. 3.3. The results of 
the measurements at four collimator positions are summarized in Fig. 7. Figure 7a 
shows the opposing-neighboring ratio for each collimator position and Fig. 7b gives  
the measured position uncertainty. The x axis origin of both plots are the start 
location of the collimator. The FWHM of the position estimate is below 360 normal muμm. 
However, this 360-normal muμm position uncertainty is not equivalent to the sub-pixel 
resolution. There are two more factors that add uncertainty to the measurement: 
(1) collimator-beam size and (2) electron cloud size. The collimator has a 100-normal muμm 
opening, but the beam will be spread bigger at the detector surface and the beam 
size will become even wider when the interactions occur at deeper depths in the 
detector. The increase in measured resolution caused by the collimator is signiﬁcant. 
Additionally, the measured sub-pixel position of each interaction represents the 
centroid of the ionized electron cloud not the initial gamma-ray interaction position. 
As a result, even when the gamma beam is ﬁxed at a single position relative to 
the detector, the electron cloud centroid will be different if the secondary fast 
electron follows a different track. Using the Geant4 simulation package, we can 
simulate the total uncertainty contribution from the two factors together. As shown 
in Fig. 8, we ﬁnd that the collimator beam and 662-keV electron cloud can cause 
280-normal muμm FWHM position uncertainty in the measurement. The contributions of 
spreading from collimator and electron cloud size can be simulated individually and 
the result shows collimator can cause 150 normal muμm spreading in FWHM and electron 
cloud size introduces 240 normal muμm. Though both collimator and electron cloud caused 
spreading are not strictly Gaussian shaped, the quadratic sum of the contribution 
from collimator and electron cloud results in the same result as obtained with 
the simulation considering them together, indicating quadratic operation can be 
applied in estimating the contribution of each factor to sub-pixel position resolution 
measurement.

Sub-pixel Sensing for Pixelated CdZnTe Detectors
53
Fig. 8 The simulated 
distribution of the electron 
cloud centroid from a 
662-keV gamma-ray source 
using a collimator. 
Distribution width is due to 
the collimator and electron 
cloud size 
−1000
−500
0
500
1000 
0 
5 
10 
15 
20 
25 
30 
35 
40 
45 
50 
x position of electron cloud centroid (um) 
Counts 
Position FWHM =277um 
simulated data 
Gaussian fit 
After quadratic subtraction, the real sub-pixel resolution of the system in terms 
of determining electron cloud centroid position is calculated to be around 230 normal muμm 
at 662 keV. However, if we consider the initial gamma-ray interaction position, 
we would need to add the additionally uncertainty caused by electron cloud size. 
The projection of electron cloud size on x-y plane is a function of recoil electron 
direction, especially at high energy. If assuming the secondary electrons are emitted 
isotropically, the sub-pixel position resolution of initial gamma-ray interaction 
position would be 330 normal muμm FWHM at 662 keV. 
The 230-normal muμm sub-pixel position resolution at 662 keV is a little bit worse than 
the simulation result of 180 normal muμm. There are several factors that may cause the 
difference, including the inaccuracy of the measured geometry of the collimator 
setup (especially the distance between the detector and the collimator and the 
opening width), slight skewing of the collimator beam, the neglected 1 divided by f1/f noise, 
the diffusion of the electron cloud and material defects. 
The inaccuracy of the measurement on geometry setup can be estimated in a easy 
way. The spreading caused by the collimator should be proportional to delta times left parenthesis d plus z right parenthesis divided by zδ × (d +
z)/z, where deltaδ is the opening width, d is the distance between collimator surface 
and detector surface and z is the collimator thickness. It can be calculated that even 
with 1 cm error on d or z, the change of total uncertainty caused by collimator 
and electron cloud would be smaller than 20 normal muμm. For opening width deltaδ, the error 
of measurement should be less than 10% and its inﬂuence on total uncertainty can 
be calculated to be smaller than 20 normal muμm too. Therefore, the geometry measurement 
error should be negligible. Diffusion can change the drifting path of electrons [32]. 
For our 1.5 cm CdZnTe crystals at 3000 V, diffusion caused position uncertainty 
for each electron would be about 70 normal muμm in standard deviation and thus 170 normal muμm 
in FWHM if assuming Gaussian distribution. However, ideally diffusion shouldn’t 
shift the centroid of an electric cloud if the electron cloud is consisted of inﬁnite 
number of electrons. In reality we expect additional uncertainty from diffusion but 
its impact on sub-pixel position resolution should be much smaller than 170 normal muμm 
and we expect its impact on the measurement uncertainty should be negligible. The 
presence of 1 divided by f1/f noise may change the performance of the CR-RC ﬁlter and cause 
some underestimation of the uncertainty from the electronic noise in simulation. 
At last, the material defects in CdZnTe has been known for deviate electrons from

54
Y. Zhu
drifting straight [33]. In a poor crystal, this effect can move electron several hundred 
microns in lateral direction. In our experiment, a good CdZnTe detector was chosen 
but the deviation should still be noticeable according to Kaye et al. [33]. Therefore, 
we suspect material defects to be the main cause of the slight inaccuracy of the 
collimator experiment result. 
The sub-pixel position resolution of electron cloud centroid is proportional 
to the energy deposition. The reason is the induced signals on the neighboring 
pixels are proportional to the energy deposition while the electronic noise is a 
constant. However, with the energy deposition increases, the electron cloud size 
gets larger. The total inﬂuence of those two effects will make the measured gamma-
ray interaction position resolution improve at ﬁrst with energy deposition increasing 
and then degrade when the energy deposition passes a favorite energy. On the other 
hand when the energy of recoil electrons is very high, the electron track would be 
very long and there might be a chance to extract the electron cloud distribution 
and reduce the impact of the large electron cloud size on identifying gamma-ray 
interaction position. 
6.2 
Complete Charge Collection Boundary 
If a source is placed on the detector’s cathode side and far from the detector, the 
single-pixel photopeak counts should be distributed uniformly along the lateral 
plane of the collecting pixel. 
The boundary of this distribution marks the edge of the complete charge 
collection region. If the steering grid between the pixels is biased at the correct 
voltage, the electrons are expected to be steered toward the pixel and no charge 
should be lost in the gap between anode electrodes. In this case, the full pixel is the 
complete charge collection region and photopeak counts distribution should spread 
from one pixel edge to another, namely from minus−0.86 to 0.86 mm since the pixel pitch 
is 1.72 mm. When the grid is unbiased or grounded, only those events located under 
the pixel pad can be fully collected. The complete charge collection region should 
shrink to the pixel pad size, which is 1.22 mm. 
Figure 9 shows the distribution of measured single-pixel photopeak events within 
a pixel when the steering grid is unbiased. The dotted line marks the measured pixel 
boundary of complete charge collection. As shown, the complete charge collection 
region is from minus−0.6 to 0.6 mm, totally 1.2 mm, consistent with our expectation. 
The pixel boundary can affect the measured result of the collimator position. 
When the collimator is placed close to the complete charge collection boundary 
with unbiased grid, a portion of events will lose some charge to the gap or the 
grid and then they will not be registered as photopeak events. If we only choose 
photopeak events to measure the collimator center position, the measured collimator 
center position will be shifted. Figure 10 shows that the center position of the 
selected photopeak events, or the measured collimator center, is shifted toward the 
inside of the pixel when the collimator is placed near the edge of the complete

Sub-pixel Sensing for Pixelated CdZnTe Detectors
55
Fig. 9 The distribution of 
single-pixel photopeak events 
inside a pixel  
−1.5
−1
−0.5
0
0.5
1
1.5 
0 
50 
100 
150 
200 
250 
300 
350 
Sub−pixel position (mm) 
Counts 
Photopeak counts distribution 
Estimated pixel boundary 
Fig. 10 Calculated position 
versus collimator position 
including a comparison 
between the simulation and 
experimental results. The 
dotted line marks the 
boundary of the complete 
charge collection region 
0
100
200
300
400
500
600
700 
−100 
0 
100 
200 
300 
400 
500 
600 
Real collimator position (m) 
Calculated collimator Position (m) 
Complete Charge Collection Region 
Estimated collimator position by simulation 
Measured collimator position 
A graph of calculated collimator position in micrometers versus real collimator 
position in micrometers. It plots measured collimator positions and a line of estimat
ed collimator positions by simulation. 10A graph of calculated collimator position in micrometers versus
 real collimator position in micrometers. It plots measured collimator positions an
d a line of estimated collimator positions by simulation.
7 
Sub-pixel Position Sensing for Two-pixel Events 
Two-pixel events can be categorized into three groups according to the distance 
between the center of the two triggering pixels: 
1. neighboring events, including side neighboring or diagonally neighboring events 
2. non-neighboring events with the distance less than three pitches, and 
3. non-neighboring events with the distance greater than or equal to three pitches. 
In the discussion above, we only considered the induced signals on the 8 pixels 
surrounding the charge collecting pixel. For the non-neighboring pixels, the distance 
to the electron cloud is far, but signals are still induced. However, these signals are so 
small that we can ignore them in a ﬁrst order approximation. With this assumption, 
the sub-pixel position calculation can be performed in the same way as it was for 
single-pixel events in case (3). However, for case (1) and case (2), the induced signal

56
Y. Zhu
Fig. 11 The two cases of the arrangement of the triggered pixels for neighboring pixel events 
on a neighboring pixel from one electron cloud may be polluted by the induced 
signal from another electron cloud. To study these two cases, they can be further 
grouped into two categories based on the arrangement of the triggered pixels: 
(a) the two collecting pixels are diagonally placed, or diagonal-neighboring 
(b) the two collecting pixels are both on the same row or column, or side-
neighboring 
Figure 11 illustrates the two categories of neighboring pixel events. In Fig. 11a, the 
two collecting pixels are pixel A and pixel B. The neighboring pixels of pixel A 
are labeled as A1, A2, A4, A5, A6, A7 and A8, while for pixel B as B1, B2, B3, 
B4, B5, B6, B7 and B8. Based on our assumption that the induced signals on non-
neighboring pixels are negligible, the signals on the neighboring pixels except pixel 
B7/A5 and pixel B4/A2 are induced only by one electron cloud and their amplitudes 
can indicate the position of that electron cloud. These unpolluted neighbors are 
sufﬁcient to apply neighbor-to-center ratio (as deﬁned in Sect. 4) and both x and 
y sub-pixel positions can be determined. 
For the side-neighboring case shown in Fig. 11b, the x-direction unpolluted 
neighbors for collecting pixel A are A1, A4 and A6. They form one column so one 
can apply the neighbor-to-center ratio for x direction. However, for the y direction, 
there is not an entire row of 3 unpolluted neighbors. Therefore, the corner neighbor 
ratio method needs to be employed. We will discuss the application of neighbor-to-
center ratio ﬁrst and then the corner-neighbor ratio. 
As discussed in Sect. 4, the neighbor-to-center ratio does not have a linear 
relationship with the interaction position. However, the opposing-neighboring ratio 
is a linear function of interaction position. Therefore, we can associate the neighbor-
to-center ratio with the opposing-neighbor ratio to calibrate the nonlinear relation. 
This step can be done for single-pixel events. 
To demonstrate the effectiveness of the neighbor-to-center ratio, we again use 
a fan-beam collimator experiment. The collimator was placed near the center of a 
pixel and its opening was oriented along the y direction so that all the events through 
the collimator were located around x=0. The neighboring two-pixel photopeak 
events were chosen and the sub-pixel position of the ﬁrst interaction (its electron

Sub-pixel Sensing for Pixelated CdZnTe Detectors
57
Fig. 12 Sub-pixel position 
for the two-pixel events in the 
collimator experiment. The 
energy deposition on the 
neighboring pixels is required 
to be greater than 100 keV 
−1.5
−1
−0.5
0
0.5
1
1.5 
0 
5 
10 
15 
20 
25 
30 
35 
40 
45 
Subpixel position (mm) 
Counts 
Opposing−neighboring ratio method for 2−pixel events 
Neighbor−to−center ratio method for 2−pixel events 
Opposing−neighboring ratio for 1−pixel events 
A graph of counts from 0 to 45 versus subpixel position in millimeters. It plots 
3 lines of opposing neighboring for 1 and 2 pixels and neighbor-to-center ratios
.
12A grap h of count s from 0 to 45 versus subp
ixel position  in millim eters. It plots  3 lines  of  oppo si ng neighbo ring for 1 a nd 2
 pixels and neighbor-to-center ratios.
11A graph of counts from 0 to 45 versus subpixel position in millimeters. It
 plots 3 lines of opposing neighboring for 1 and 2 pixels and neighbor-to-center ratios. 4A graph of counts from 0 to 45 versus subpixel position in
 millimeters. It plots 3 lines of opposing neighboring for 1 and 2 pixels and neighbor
-to-center ratios.

58
Y. Zhu
8 
Sub-pixel Position Sensing for Charge-sharing Events 
Charge-sharing events are usually side-neighboring events. There is an algo-
rithm to discriminate charge-sharing side-neighboring events from Compton side-
neighboring events [34]. As discussed, the sub-pixel location can be determined 
using center-to-neighbor ratio and corner-neighbor ratio. However, they are not 
accurate, especially for charge-sharing events. The electron cloud is on the gap 
between the collecting pixels and far away from the neighbors that can be used 
for neighbor-to-center ratio. The neighbor signal amplitude will be very small and 
the signal-to-noise ratio will very poor. In addition, the “center” amplitude needs to 
be the sum of the two collecting pixels. But there will be severe crosstalk between 
the two collecting pixels. The “center” amplitude will be altered. Therefore, the 
neighbor-to-center ratio will perform very poor for charge-sharing events. Since 
there is only one electron cloud for a charge-sharing event, there is a method to 
better determine the sub-pixel location of this electron cloud. 
One traditional method to determine the sub-pixel location for charge-sharing 
events is the ratio of the energy deposition between the two shared pixels. This 
method is called energy ratio in the later context of this paper. The energy ratio 
method works well when electron cloud is a consistent sphere. It is usually true 
when the energy is low, and diffusion dominates. However, when the energy is high, 
the electron cloud will have some shape. And there will be problems. 
First, at high energy, electron cloud size and shape are not consistent. They must 
be known to translate an energy ratio value into the centroid location of the cloud. 
Unfortunately, both electron cloud size and shape changes as a function of energy. A 
Geant4 [35] simulation was carried out to describe the problem. Figure 13 presents 
an example of the simulated energy deposition of a fast electron traveling inside a 
CdZnTe detector. Electron-hole pairs will generate around these energy deposition 
locations, which will form an electron cloud. When the energy is only 60 keV, the 
electron cloud is small, only about several micrometer. When the electron cloud 
drifts to the anode side, its size will be dominated by diffusion, whose contribution 
is about 50 normal muμm [36] for a 20 times× 20 times×15 mmcubed3 CdZnTe detector biased at minus−3000 V. 
The shape of the electron cloud is close to a circle since diffusion dominates and 
it is isotropic. When the fast electron energy is as high as 662 keV, the electron 
cloud becomes much bigger, which is around 200 normal muμm as shown in Fig. 13c. The 
average electron size increases roughly linearly with energy. But the uncertainty of 
the size increases at the same time [4]. It is difﬁcult to determine the size of a particle 
electron cloud when the energy is high. As for the shape, since the contribution from 
diffusion is still around 50 normal muμm, the 200-normal muμm 662-keV electron cloud will maintain 
its shape as generated when it reaches the anode side. Therefore, the electron cloud 
shape for high energy events will depend on the fast electron track. For example, the 
energy deposition presented in Fig. 13c could generate an electron cloud like a long 
spindle. The fast electron track generation is a random process. Given the energy of 
a fast electron, it is unpredictable what track it will produce. It makes the shape of 
the electron cloud at high energy undetermined. As a summary, both the size and the

Sub-pixel Sensing for Pixelated CdZnTe Detectors
59
Fig. 13 Examples of the simulated energy deposition of an electron traveling inside a CdZnTe 
detector. Each dot gives the location of the energy deposition. The size and color give the amount 
of the energy deposited at that location 
shape are random for high energy events. It is difﬁcult to acquire them accurately in 
real applications. 
Second, even if the electron cloud size and shape is known, the centroid location 
of the cloud is still undetermined if the electron cloud is anisotropic. For example, if 
an electron cloud is like a long spindle, with the same energy ratio, the electron cloud 
centroid changes if the electron cloud orientation changes. Unfortunately, at high 
energy, anisotropic electron cloud is more likely. It makes it inaccurate to determine 
the electron cloud centroid with energy ratio for high-energy events. 
To obtain accurate sub-pixel location, neighbor signals must be used. Different 
from the charge collecting pixels, the signals induced on the neighboring-pixel are 
produced by the movement of the electron cloud and no charge will be collected on 
them. The neighboring-pixel signals are usually transient signals. Their amplitude 
depends on the distance between the neighboring pixel and the electron cloud [37] .  
A short shaper is used to pick up the amplitude of these signals. 
Figure 11b is used to deﬁne the signals. Here, we deﬁne: (1) far-left neighbors 
as the leftmost signals (B5+B8+B3) and far-right neighbors as the rightmost 
(A4+A6+A1); (2) adjacent-left neighbors as the two left neighbors above and 
below the collecting pixels (B7/A8+B2/A3) and adjacent-right neighbors as the 
two right neighbors (B6/A7+B1/A2); (3) adjacent-upper neighbors as the two 
upper neighbors (B7/A8+B6/A7) and adjacent-bottom neighbors as the lower ones 
(B2/A3+B1/A2); (4) the two collecting pixels are represented as B and A. The 
ratio of these signals can give the information of the interaction location. To keep 
symmetry, the ratio of a pair of signals X and Y is deﬁned as (Xminus−Y)/(X+Y) in this 
article. 
Like single-pixel sub-pixel sensing, the ratio between far-left neighbors and far-
right neighbors should give the centroid of the electron cloud for the charge-sharing 
event. This far-neighbor ratio, however, has poor signal-to-noise ratio. Because of 
the large distance, the signal amplitude of those far-left and far-right neighbors are 
small. The position resolution will then be poor using the far-neighbor ratio. It is not

60
Y. Zhu
Fig. 14 Normalized plot of (a) far-neighbor ratio vs. energy ratio and (b) far-neighbor ratio vs. 
adjacent-neighbor ratio for 662-keV 2-pixel side-neighboring events with depth separation less 
than 1 mm 
an ideal method for charge-sharing events sub-pixel sensing. But this method can 
be used to determine the feasibility of other proposed algorithms. 
Two methods are investigated: (1) energy ratio between the collecting pixels 
B and A; (2) adjacent-neighbor ratio, which is the ratio between adjacent-left 
and adjacent-right neighbors. In Fig. 14, the relation between the energy ratio and 
adjacent neighbor ratio vs. far neighbor ratio are plotted respectively for 662-keV 
2-pixel side-by-side neighboring events, or side-neighboring events, with depth 
separation less than 1 mm. The selected events are mostly charge-sharing events. 
Inevitably, A few same-depth Compton-scattering events will be included. Far-
neighbor ratio can be treated as the real location of that electron cloud for charge 
sharing events. As shown in the plot, when energy ratio is either close to 1 or 
minus−1, there is no one-to-one relationship between the electron cloud centroid and the 
energy ratio. Depending on the electron cloud orientation, the centroid can change 
signiﬁcantly. On the contrary, the adjacent-neighbor ratio shows a clear one-to-one 
relationship with the far-neighbor ratio. It is clearly more reliable to determine the 
electron cloud centroid for charge-sharing events. 
A simulation [38] is performed to understand the underline relationship between 
the electron cloud centroid of the charge-sharing event and adjacent-neighbor ratios 
[5]. Shockley-Ramo theory [28] is the basic principle used for signal induction 
calculation on all the electrodes. Maxwell was employed to calculate the static 
electric ﬁeld inside the detector. Geant4 was selected to simulate the physics 
especially the electron cloud generation. The electric ﬁeld inside the detector was 
assumed to be uniform. It is true that in a real detector, the electric ﬁeld is not 
always perfectly uniform because of the material non-uniformity [39] . However, 
for many detectors, the electric ﬁeld is close to uniform [40] . To the ﬁrst-order 
approximation, we pick constant ﬁeld to simplify the calculation. In fact, since the 
neighbor transient signal only happens about 1-pixel away from the anode surface 
[28], it is reasonable to assume uniform electric ﬁeld in this region. For extremely 
non-uniform detectors, corrections can be made [41].

Sub-pixel Sensing for Pixelated CdZnTe Detectors
61
Fig. 15 Simulation result of using adjacent-neighbor LR and UD ratio to determine x and y sub-
pixel position, assuming the charge is shared along x direction. Plot (a) and (b) gives the 2-D and 
3-D views of the adjacent-neighbor LR ratio as a function of the X position. Plot (c) and (d) gives  
the same views of the adjacent-neighbor UD ratio versus Y position 
The result is presented in Fig. 15. It is assumed that the charge is shared along x 
direction as shown in Fig. 11b. The left and right column of plots give the relation 
between adjacent-neighbor left-to-right ratio vs x location, and adjacent-neighbor 
top-to-bottom ratio vs y location, respectively. Figure 15a gives the adjacent-
neighbor left-to-right ratio as a function of x location. Each curve is for one y 
location. Similarly, Fig. 15c depicts the adjacent-neighbor top-to-bottom ratio as a 
function of y location. Each curve is for one x location. The lower two plots are 
3-dimensional view of the adjacent-neighbor ratio as the x and y location. 
As can be observed in those plots, the adjacent-neighbor ratio vs y location curve 
is independent of the x location, and it is a linear function to the ﬁrst order of 
approximation. The neighbor transient signal amplitude was extracted independent 
of depth as discussed in [37]. Therefore, the linear relationship is expected for all 
depth. The ratio deﬁnition of the adjacent-neighbor signals removes the energy 
dependence. However, if the electron cloud is too large and it is shared among 
more than two pixels, the adjacent-neighbor ratio will not only contain the induced 
transient signal, but also the charge collecting signal. The linear relationship will 
then not be guaranteed. 
As for the adjacent-neighbor ratio vs x location, it depends on the y location, and 
it is nonlinear as shown in Fig. 15a. Therefore, to calculate the sub-pixel location 
based on the adjacent-neighbor ratio, one should calculate the y location ﬁrst using 
the adjacent-neighbor top-to-bottom ratio. Then, based on the y location, one can 
derive the adjacent-neighbor ratio vs x location curve. The x location can be then 
calculated. Because of the nonlinearity, simulation is necessary to map out the 
relation between the location and adjacent-neighbor ratio. 
Based on method described above, the sub-pixel location of the two-pixel charge-
sharing events for a real measurement can be calculated. It can be compared to

62
Y. Zhu
Fig. 16 Sub-pixel position distribution of single-pixel events and 2-pixel charge-sharing events 
for pixel (6,3), pixel (4,4) and pixel (3,2) using 662-keV photopeak events 
the distribution of single-pixel events to validate the result. Figure 16 provides the 
calculated sub-pixel distribution for charge-sharing events and single-pixel events. 
The source is a 30-muμCi Superscript 137137Cs point source placed about 20 cm from the cathode 
side. The plot axis range is from minus−1 to 1 mm. The actual pixel range is minus−0.86 to 
0.86 mm. The extra bins are for overﬂow events from noise and abnormal signals. 
Each pair of plots are for one pixel. The plots in the left column are for single-
pixel events. The plots in the right column are for 2-pixel charge-sharing events. 
Each row presents the result for a pixel. Charge-sharing is identiﬁed by selecting 
side-neighboring events with depth separation less than 1 mm. There will be a few 
Compton-scattering events mis-classiﬁed to be charge-sharing events in the plot. 
But their fraction is very small and can be neglected. 
From the plots, we can see the distribution from the single-pixel events matches 
with the distribution from the charge-sharing events. For example, for pixel (6,3), 
there is a dent at left edge of the single-pixel distribution. For charge-sharing 
distribution, there is a clear hump at the inner left edge to match the dent. It is 
clear evidence to show the effectiveness of the sub-pixel sensing technique for 
charge-sharing events. The origin of such dent is so called pixel-jumping effect [33]. 
The incoming gamma-ray ﬂux is uniform. However, due to material defects, some 
electron clouds travel along a curve instead of a straight line. The lateral movement 
of those electron clouds result in distortion or non-uniformity of the observed events 
distribution at the anode side. 
Figure 17 shows the ﬂooded radiation result using 662-keV Superscript 137137Cs source for 7-
by-7 inner pixels in detector 6RID-5. The source is placed about 20 cm from the 
cathode side. The intensity of the source is about 30 muμCi. 1-pixel events and 2-pixel 
charge-sharing events are both plotted, as well as the sum of them. As shown, the 
charge-sharing events ﬁlls the gap left by 1-pixel events reasonably well. There are

Sub-pixel Sensing for Pixelated CdZnTe Detectors
63
Fig. 17 Sub-pixel distribution of a ﬂood radiation from a Superscript 137137Cs 662-keV source for 1-pixel and 
2-pixel charge-sharing events in 6RID-5 
several holes and many hot spots in the sum distribution. They should be due to the 
pixel-jumping effect discussed previously. 
9 
Summary 
The purpose of this article is to introduce and justify a sub-pixel calculation 
algorithm based on the digital readout of the induced signal on the charge collecting 
pixel and its 8 neighbors. Without such a method, the lateral position resolution 
of pixelated, 3-D position sensitive, CdZnTe detectors is limited by their pixel 
pitch. This barrier introduces a signiﬁcant limitation on the Compton imaging 
and coded-aperture imaging performance. To improve lateral position resolution to 
the sub-pixel scale, algorithms based on signals induced on pixels that neighbor 
a charge collecting pixel are used. The opposing-neighboring ratio method is 
shown to be capable of providing accurate estimates of sub-pixel electron cloud 
centroid position. A detailed system simulation predicted 180-normal muμm FWHM position 
resolution at 662 keV with 4-keV electronic noise. A collimator experiment resulted 
in a 360 normal muμm position ﬂuctuation for a 662 keV Superscript 137137Cs source. After subtracting the 
uncertainty caused by the collimator beam width and the electron cloud size, the 
experimental sub-pixel position resolution for measuring the electron cloud centroid 
of a recoil electron is found to be about 230 normal muμm. The uncertainty of measured 
gamma-ray interaction position would then be 330 normal muμm at 662 keV if we assume 
the secondary electrons are emitted isotropically. 
Besides the opposing-neighboring ratio, two additional methods (neighbor-to-
center ratio and corner-neighbor ratio) are discussed for the more difﬁcult case of 
multi-pixel charge collection events. It is demonstrated that neighbor-to-center ratio 
method is effective in estimating the sub-pixel interaction position for two-pixel 
events. 
For charge-sharing events, a special algorithm is introduced to improve their sub-
pixel resolution. Two methods are discussed: energy ratio and adjacent-neighbor 
ratio. The energy ratio method is not accurate for high-energy events since the 
electron cloud shape and the induced centroid location uncertainty due to the

64
Y. Zhu
electron cloud orientation. Using adjacent-neighbor ratio, more accurate sub-pixel 
location can be obtained. Experimental measurement was taken and the result was 
shown to demonstrate the effectiveness of the method. 
References 
1. Zhang, F., He, Z., Knoll, G. F., Wehe, D. K., & Berry, J. E. (2005). 3-D position sensitive 
CdZnTe spectrometer performance using third generation VAS/TAT readout electronics. IEEE 
Transactions on Nuclear Science, 52(6), 2009–2016. 
2. Zhang, F., He, Z., & Xu, D. (2004). Analysis of detector response using 3-D position-sensitive 
CZT gamma-ray spectrometers. IEEE Transactions on Nuclear Science, 51(6), 3098–3104. 
3. Zhang, F., He, Z., & Xu, D. (2004). Improved resolution for 3-D position sensitive CdZnTe 
spectrometers. IEEE Transactions on Nuclear Science, 51(5), 2427–2431. 
4. Kaye, W., Zhang, F., Boucher, Y. A., Wang, W., Kim, J. C., Zhu, Y., & He, Z. (2011). 
Event classiﬁcation in 3D position sensitive pixelated CdZnTe detectors. In Nuclear Science 
Symposium Conference Record (NSS/MIC), 2011 IEEE, Valencia, Oct. 2011 (pp. 4756–4760). 
5. Kim, J., Anderson, S. E., Kaye, W., Zhang, F., Zhu, F., Kaye, S. J., & He, Z. (2011). Charge 
sharing in common-grid pixelated CdZnTe detectors. Nuclear Instruments and Methods in 
Physics Research A, 645(1), 233–243. 
6. Zhang, F., Zhu, Y., Streicher, M., & He, Z. (2014). New nonlinearity calibration method for 
3-d position-sensitive CdZnTe detectors. In Nuclear Science Symposium Conference Record 
(NSS/MIC), 2014 IEEE, Seattle, Oct. 2014 (pp. 1–4) 
7. Streicher, M., Zhu, Y., & He, Z. (2015). CdZnTe gamma-ray spectroscopy in high ﬂux 
environments using digital pulse processing techniques. In Nuclear Science Symposium 
Conference Record (NSS/MIC), 2015 IEEE, San Diego, Oct. 2015 (pp. 1–4). 
8. Streicher, M., Brown, S., Zhu, Y., Goodman, D., & He, Z. (2016). Special nuclear material 
characterization using digital 3-D position sensitive CdZnTe detectors and high purity germa-
nium spectrometers. IEEE Transactions on Nuclear Science, 63(5), 2649–2656. 
9. Xia, J., Zhu, Y., & He, Z. (2020). Efﬁcient temperature corrections for gamma-ray energy 
reconstruction in 3-D position-sensitive CdZnTe detectors. Nuclear Instruments and Methods 
in Physics Research, A, 954, 161340. 
10. Zhang, F., Kaye, W. R., & He, Z. (2009). Performance of 3-D position sensitive CdZnTe 
detectors for gamma-ray energies above 1 MeV. In Nuclear Science Symposium Conference 
Record (NSS/MIC), 2009 IEEE, Orlando, Oct. 2009 (pp. 2012–2016). 
11. Zhu, Y., & He, Z. (2021). Performance of larger-volume 40x40x10- and 40x40x15-mm3 
CdZnTe detectors. IEEE Transactions on Nuclear Science, 68(2), 250–255. 
12. Jupp, I. D., Byard, K., & Dean, A. J. (1994). An improved sampling conﬁguration for a coded 
aperture telescope. Nuclear Instruments and Methods in Physics Research, A, 345(3), 576–584. 
13. Xu, D., He, Z., Lehner, C. E., & Zhang, F. (2004). 4-pi Compton imaging with single 3D 
position sensitive CdZnTe detector. Proceedings SPIE, 5540, 144–155. 
14. Brown, S., Goodman, D., Chu, J., Williams, B., Williamson, M., & He, Z. (2020). Time-
encoded gamma-ray imaging using a 3-D position-sensitive CdZnTe detector array. IEEE 
Transactions on Nuclear Science, 67(2), 464–472. 
15. Warburton, W. K. (1998). An approach to sub-pixel spatial resolution in room temperature 
X-ray detector arrays with good energy resolution. In Mat. Res. Symp. Proc. (Vol. 487, pp. 
531–535). 
16. Burks, M., Jordan, E., Hull, E., Mihailescu, L., & Vetter, K. (2004). Signal interpolation in 
germanium detectors for improved 3-D position resolution. In Nuclear Science Symposium 
Conference Record (NSS/MIC), 2004 IEEE, Rome, Oct. 2004 (pp. 309–394)

Sub-pixel Sensing for Pixelated CdZnTe Detectors
65
17. Williams, C. S., Baker, W. P., Burggraf, L. W., Adamson, P. E. & Petrosky, J. C. (2010). Toward 
simultaneous 2D ACAR and 2D DBAR: sub-pixel spatial characterization of a segmented 
HPGe detector using transient charges. IEEE Transactions on Nuclear Science, 57(2), 860– 
869. 
18. Marks, D., Barber, H., Barrett, H., Tueller, J., & Woolfenden, J. (1999). Improving performance 
of a CdZnTe imaging array by mapping the detector with gamma rays. Nuclear Instruments and 
Methods in Physics Research, A, 428(1), 102–112. 
19. Vickersa, J. S., & Chakrabarti, S. (1999). Silicon-anode detector with integrated electronics for 
microchannel-plate imaging detectors. Review of Scientiﬁc Instruments, 70(7), 2912–2916. 
20. Jakubek, J., & Uher, J. (2009). Fast neutron detector based on TimePix pixel device with 
micrometer spatial resolution. In Nuclear Science Symposium Conference Record (NSS/MIC), 
2009 IEEE, Orlando, Oct. 2009 (pp. 1113–1116). 
21. Narita, T., Grindlay, J. E., Hong, J., & Niestemski, F. C. (2004). Anode readout for pixellated 
CZT detector. Proceedings SPIE, 5165, 542–547. 
22. Kim, J. C., Anderson, S. E., Kaye, W., Kaye, S. J., Zhu, Y., Zhang, F., & He, Z. (2009). Study on 
effect of charge sharing events in common-grid pixelated CdZnTe detectors. In Nuclear Science 
Symposium Conference Record (NSS/MIC), 2009 IEEE, Orlando, Oct. 2009 (pp. 1640–1646). 
23. Chen, Z., Zhu, Y., & He, Z. (2020). Intrinsic photopeak efﬁciency measurement and simulation 
for pixelated CdZnTe detector. Nuclear Instruments and Methods in Physics Research, A, 980, 
164500. 
24. Zhang, F., Herman, C., He, Z., Ceronimo, G. D., Vernon, E., & Fried, J. (2012). Characteriza-
tion of the H3D ASIC readout system and 6.0 cm3 3-d position sensitive CdZnTe detectors. 
IEEE Transactions on Nuclear Science, 59(1), 236–242. 
25. Zhu, Y., & He, Z. (2012). Performance of a 2-keV digitizer ASIC for 3-D position-
sensitive pixellated semiconductor detectors. In Nuclear Science Symposium Conference 
Record (NSS/MIC), 2012 IEEE, Anaheim, Oct. 2012 (pp. 4109–4112). 
26. Zhu, Y., & He, Z. (2010). Performance improvement of 3-D position-sensitive pixellated hgi2 
detectors when cooled from room temperature to 10 degrees C. In Nuclear Science Symposium 
Conference Record (NSS/MIC), 2010 IEEE, Knoxville, Oct. 2010 (pp. 3959–3962). 
27. Zhu, Y., Zhang, F., Boucher, Y. A., Mann, J., & He, Z. (2013). Performance comparison of 
steering-grid and simple-pixel CdZnTe detectors. In Nuclear Science Symposium Conference 
Record (NSS/MIC), 2013 IEEE, Seoul, Oct. 2013 (pp. 1–5). 
28. He, Z. (2001). Review of the Shockley-Ramo theorem and its application in semiconductor 
gamma-ray detectors. Nuclear Instruments and Methods in Physics Research, A, 463, 250– 
267. 
29. Barrett, H. H., Eskin, J. D., & Barber, H. B. (1995). Charge transport in arrays of semiconductor 
gamma-ray detectors. Physical Review Letters, 75(1), 156–159. 
30. Pullia, A., & Riboldi, S. (2004). Time-domain simulation of electronic noises. IEEE Transac-
tions on Nuclear Science, 51(4), 1817. 
31. Radeka, V. (1967). Least-square-error amplitude measurement of pulse signals in presence of 
noise. Nuclear Instruments and Methods in Physics Research, A, 52(1), 86. 
32. Knoll, G. F. (1999). Radiation detection and measurement (3rd ed.). Hoboken, NJ: Wiley. 
33. Kaye, S., Kaye, W., & He, Z. (2009). Experimental demonstration of coded aperture imaging 
using thick 3D-position-sensitive CdZnTe detectors. In Nuclear Science Symposium Confer-
ence Record (NSS/MIC), 2009 IEEE, Orlando, Oct. 2009 (pp. 1902–1906). 
34. Brown, C. R., Zhu, Y., Yang, H., & He, Z. (2012). Adjacent 2-pixel event discrimination in 3-
D position sensitive imaging CdZnTe detectors using the UM VAD ASIC. In Nuclear Science 
Symposium Conference Record (NSS/MIC), 2012 IEEE, Anaheim, Oct. 2012 (pp. 4175–4178). 
35. Agostinelli, S., et al. (2003). Geant4—A simulation toolkit. Nuclear Instruments and Methods 
in Physics Research, A, 506(3), 250–303. 
36. Du, Y. F., He, Z., Li, W., Knoll, G. F., & Wehe, D. K. (1998). Monte carlo investigation of the 
charge sharing effects in 3-D position sensitive CdZnTe gamma ray spectrometers. In Nuclear 
Science Symposium Conference Record (NSS/MIC), 1998 IEEE, Toronto, Oct. 1998 (pp. 634– 
637).

66
Y. Zhu
37. Zhu, Y., Anderson, S., & He, Z. (2011). Sub-pixel position sensing for pixelated, 3-D position 
sensitive, wide band-gap, semiconductor, gamma-ray detectors. IEEE Transactions on Nuclear 
Science, 58(3), 1400–1409. 
38. Rodrigues, M. L., & He, Z. (2010). 3D monte carlo simulations of pixelated CdZnTe detectors 
under high photon ﬂuxes. In Nuclear Science Symposium Conference Record (NSS/MIC), 2010 
IEEE, Knoxville, Oct. 2010 (pp. 3836–3838). 
39. Koehler, W., Streicher, M., O’Neal, S., & He, Z. (2016). A correction factor to the two-bias 
method for determining mobility-lifetime products in pixelated detectors. IEEE Transactions 
on Nuclear Science, 63(3), 1832–1838. 
40. Xia, J., Streicher, M., Zhu, Y., & He, Z. (2018). Measurement of electron mobility-lifetime 
product in 3-D position-sensitive CdZnTe detectors using the VAD_UM v2.2 digital readout 
system. IEEE Transactions on Nuclear Science, 65(11), 2834–2837. 
41. Kim, J. C., Kaye, W. R., Yang, H., Brown, C. R., & He, Z. (2013). Improvement of sub-pixel 
position sensing in nonuniform large-volume pixelated CdZnTe crystals. IEEE Transactions 
on Nuclear Science, 60(2), 1201–1207.

Machine Learning Approaches in Room 
Temperature Semiconductor Detectors 
Srutarshi Banerjee, Miesher Rodrigues, Manuel Ballester, 
Alexander Hans Vija, and Aggelos K. Katsaggelos 
1 
Introduction 
RTSDs and semiconductor detectors such as HPGe are required for a large number 
of applications such as medical imaging, homeland security, astronomy and high 
energy physics [1–5]. These applications call for high quality crystals at reasonable 
cost, with uniform and optimized charge transport properties – no polarization 
effect, excellent fabrication quality, high breakdown voltage, high drift velocity, 
high energy resolution and lowest possible defects (charge trapping centers). Over 
the last several decades, RTSDs such as CdTe, CdZnTe, HgI2, TlBr have emerged as 
potential detectors. RTSDs are often used as compact radiation detection units with 
highly segmented anode and cathode patterns. For the case of single charge carrier 
(electrons), the segmented anode pattern is often used, while for the signiﬁcant drift 
of holes in the detector (along with electrons), segmented anode and cathode design 
is required for better energy resolution. 
Compared to the semiconductor detectors, RTSDs are a preferred choice today 
due to the high energy resolution spectral responses without the need for cooling. 
The performance and yield of high-quality detector-grade materials for real world 
S. Banerjee () 
Electical and Computer Engineering, Northwestern University, Evanston, IL, USA 
X-Ray Science Division, Argonne National Laboratory, Lemont, IL, USA 
e-mail: srutarshibanerjee2022@u.northwestern.edu 
M. Ballester · A. K. Katsaggelos 
Electical and Computer Engineering, Northwestern University, Evanston, IL, USA 
e-mail: manuelballestermatito2021@u.northwestern.edu; a-katsaggelos@northwestern.edu 
M. Rodrigues · A. H. Vija 
Molecular Imaging, Siemens Medical Solutions USA Inc., Hoffman Estates, IL, USA 
e-mail: miesher.rodrigues@siemens-healthineers.com; hans.vija@siemens-healthineers.com 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
C. Hansson, K. (Kris) Iniewski (eds.), X-ray Photon Processing Detectors, 
https://doi.org/10.1007/978-3-031-35241-6_4
67

68
S. Banerjee et al.
applications are limited by the presence of high concentrations of defects which 
are randomly distributed. The manufacturing processes of the RTSD crystal is 
often non-uniform and this leads to random distribution of defects in the material. 
RTSDs such as CdZnTe (CZT) suffers from major detrimental defects [6] such as 
compositional inhomogeneity due to non-unity segregation coefﬁcient of Zn [7], 
presence of high concentration of secondary phases, Te inclusions and sub-grain 
boundaries/dislocation walls in high concentration in CZT array. These defects act 
as trapping centers, hindering localized charge transport and imposes spatial non-
uniformity in charge transport properties, thereby adversely affecting the detector 
performance [8–13]. The trapping centers have lower ionization energies than the 
bandgap of the material and enables transition of charged carriers (electrons or 
holes) from the valence band or conduction band. These trapping centers can be 
non-uniform over the volume of the material and typically differs for electrons and 
holes. 
The efforts to characterize these detectors have been done over the last sev-
eral years. For instance, using thermoelectric emission spectroscopy (TES) and 
thermally stimulated conductivity (TSC) measurements, the thermal ionization 
energies of the electron and hole traps were measured [14]. Determination of the 
trap lifetime was done using a microwave cavity perturbation method in CdZnTe 
and HgI2 [15]. In [16], the electron and hole traps of CdZnTe samples were 
radially irradiated with 5 MeV focused proton beam to generate electron-hole 
pairs and ﬁll traps, which were released later by thermal re-emission. Electron 
and hole traps were distinguished by excitation near the vicinity of the appropriate 
electrodes. Analyzing simultaneous multiple peaks on TSC measurements allowed 
characterization of deep trap levels in CdZnTe [17]. In [18], the average hole 
trapping time τ h was derived using statistical model of charge collection efﬁciency 
based on known electron average trapping time. In [19–21], average hole de-
trapping time τ Dh was extracted by comparing the measured and simulated signals 
for holes as measured in the cathode. Imperfections due to mechanical damage or 
adsorbed chemical species trap charges or increase leakage current. Using pulsed 
laser microwave cavity perturbation method selectively at the surface and in the 
bulk region of CZT, these defects has been characterized [22]. The inﬂuence 
of type of metal contacts and deposition techniques on the recombination and 
trapping defects at the metal-semiconductor interface has also been studied [23]. 
The uniformity of high ﬂux CdZnTe has also been characterized [13]. In literature, 
the defects and charge transport properties of electrons and holes are measured using 
classical approaches considering homogeneous behavior over the detector. This 
requires cumbersome multiple experiments and technical know-how. However, the 
homogeneity and repeatability of the defects and charge transport properties within 
a detector and across multiple detectors spatially and temporally are unknown. 
Moreover, achieving high energy resolution below 1.0% at 662 keV and sub-
millimeter position detection accuracy depends on in-depth characterization of the 
RTSDs. Detailed electrical and material characterization of RTSD will also aid in 
developing improved reconstruction algorithms. However, this approach tradition-
ally is hugely time consuming, requires numerous sophisticated experiments and

Machine Learning Approaches in Room Temperature Semiconductor Detectors
69
skilled manpower. On the other hand, deployment of such detector arrays requires 
precise characterization of the individual detectors, and knowledge of the defects 
within the sensors spatially and temporally. Sensors with defects are typically 
discarded, which signiﬁcantly reduces manufacturing yield, increases production 
cost and results in ﬁnancial loss. 
In order to solve this important problem, we utilize a Machine Learning 
approach. Machine learning and deep learning-based models have not only been 
popular in the last few years but also have created a paradigm shift in different 
ﬁelds such as material science, drug discovery and others. Integrating Physics-based 
Modeling and Machine Learning is becoming more popular over the years [24, 25]. 
The overall objectives of such approaches are to develop inverse models, improve 
predictions beyond state-of-art physical models, model parameterization, partial 
differential equations (PDEs) solutions, discover symbolic governing equations, and 
others. Solving problems in physics governed by PDEs using Neural Networks has 
been done [26, 27]. For example, the two-dimensional wave equation is modeled 
as a Recurrent Neural Network [28]. DeepONets [29] have been demonstrated as a 
powerful tool to learn nonlinear operators in a supervised data-driven manner. The 
2D Poisson Equation has been solved with a Physics Informed Neural Networks 
[30]. In most of these physics-based machine learning approaches, relatively simpler 
PDEs have been solved. However, the charge transport in a RTSD has multitude of 
coupled PDEs [31] involving charge drift, trapping, detrapping and recombination. 
To the best of our knowledge, our work is the ﬁrst novel approach to characterize 
the radiation detectors using machine learning. 
In our machine learning based physical models [32–36] we solve the following 
problems currently plaguing the characterization of radiation detectors with a 
reasonable detection area for its wide scale implementation in medical and security 
applications: (a) Micron-level characterization of detector material properties with 
spatial and temporal uniformity in a fast and efﬁcient way, (b) Determination of 
detector material properties as per industry standards, (c) Determination of detector 
material properties based on reduced amount of data, and, (d) Micron-level defect 
identiﬁcation and characterization. 
2 
Classical Approach to Detector Modeling 
In solid-state detectors, depending on the end application, electrons and holes 
transport properties play a signiﬁcant role in selecting detectors. Compensation 
techniques used to increase the resistivity of RTSDs with mostly shallow defect 
levels introduce deep defect levels in them [37]. The deeper defects degrade the 
performance of the RTSDs owing to longer trapping centers for charges. The 
trapping, detrapping and recombination is governed by Shockley-Read-Hall Theory 
[38, 39]. Rodrigues et al. [40] worked on techniques to measure more detailed 
properties of these materials using the charge transport equations driven by the 
charge continuity equations with multiple electron and hole defect levels – trapping

70
S. Banerjee et al.
Fig. 1 Energy level diagram of a RTSD showing shallow electron trapping centers along with 
shallow and deep hole trapping centers, (i) Before photon interaction; (ii) Electrons-holes in excess 
of equilibrium generated at t = 0; (iii) Transport of electrons and holes by operating electric ﬁeld 
alongwith trapping, de-trapping, and, recombination for t > 0. (Figure adapted with permission 
[32]) 
centers – coupled with Poisson’s equation [41–44]. The macroscopic equations in 
[31] describe the various phenomena occurring in the material when photons, X-
rays or energetic gamma rays interact with the material usually by Photoelectric, 
Compton or Pair-Production type of interaction, creating electron-hole pairs. Once 
the electron-hole pairs are created the following phenomena occur: (1) drift of 
charges (electrons and holes) due to electric ﬁeld between the electrodes, (2) free 
charges getting trapped and de-trapped in defect levels within the material, (3) 
recombination of free charges, which are modeled as capture of free electrons 
followed by capture of free holes in the material [45] (Fig. 1). 
Equation (1) describes the electron movement in the RTSD. The dynamic 
concentration of free electrons is ne in excess of equilibrium. There is an increase 
in electron concentration at a spatial region due to charge creation in the bulk, 
drift of charges to that region and de-trapping from trapped levels. On the other 
hand, there is reduction of charges in the same region due to diffusion, trapping, 
and recombination of charges. The model considers that the trapped charges never 
saturate the trapping centers, since excess carrier concentrations are small compared 
to the number of available trapping and recombination centers and the simpliﬁed 
equations can be used [41]. In Eq. (1), only 1 trapping level for electrons has been 
shown, while in principle there can be several trapping levels, 
StartLayout 1st Row StartFraction partial differential n Subscript e Baseline Over partial differential t EndFraction plus nabla dot left parenthesis n Subscript e Baseline mu Subscript e Baseline nabla phi right parenthesis equals minus StartFraction n Subscript e Baseline Over tau Subscript e Baseline EndFraction minus StartFraction n Subscript e Baseline Over tau Subscript e upper T Baseline 1 Baseline EndFraction plus StartFraction n overTilde Subscript e Baseline 1 Baseline Over tau Subscript e upper D Baseline 1 Baseline EndFraction plus midline horizontal ellipsis plus delta Subscript e Baseline comma EndLayout∂ne
∂t + ∇· (neμe∇φ) = −ne
τe
−ne
τeT 1
+ ˜ne1
τeD1
+ · · · + δe,
(1) 
where μe is the mobility of the electrons, φ is the voltage, τ e is the electron lifetime, 
n overTilde Subscript e Baseline 1˜ne1, τ eT1, and τ eD1 are respectively the concentration, trapping, and detrapping 
lifetime of electrons in trapped level 1, δe is the source term. 
The increase in concentration of electrons in trapped level 1 is dependent on its 
own concentration n overTilde Subscript e Baseline 1˜ne1, concentration of free electrons ne, trapping and detrapping 
lifetimes τ eT1 and τ eD1 respectively, as shown in Eq. (2),

Machine Learning Approaches in Room Temperature Semiconductor Detectors
71
StartLayout 1st Row StartFraction partial differential n overTilde Subscript e Baseline 1 Baseline Over partial differential t EndFraction equals StartFraction n Subscript e Baseline Over tau Subscript e upper T Baseline 1 Baseline EndFraction minus StartFraction n overTilde Subscript e Baseline 1 Baseline Over tau Subscript e upper D Baseline 1 Baseline EndFraction period EndLayout∂˜ne1
∂t
=
ne
τeT 1
−˜ne1
τeD1
.
(2) 
A similar equation applies to holes, as shown in Eqs. (3) and (4) considering 2 
trapping centers for holes and recombination of electrons and holes. Equation (4) 
shows the increase in holes trapped in trapping centers 1 and 2, 
StartLayout 1st Row StartFraction partial differential n Subscript h Baseline Over partial differential t EndFraction plus nabla dot left parenthesis n Subscript h Baseline mu Subscript h Baseline nabla phi right parenthesis equals minus StartFraction n Subscript h Baseline Over tau Subscript h Baseline EndFraction minus StartFraction n Subscript h Baseline Over tau Subscript h upper T Baseline 1 Baseline EndFraction plus StartFraction n overTilde Subscript h Baseline 1 Baseline Over tau Subscript h upper D Baseline 1 Baseline EndFraction minus StartFraction n Subscript h Baseline Over tau Subscript h upper T Baseline 2 Baseline EndFraction plus StartFraction n overTilde Subscript h Baseline 2 Baseline Over tau Subscript h upper D Baseline 2 Baseline EndFraction plus midline horizontal ellipsis plus delta Subscript h Baseline comma EndLayout∂nh
∂t + ∇· (nhμh∇φ) = −nh
τh
−nh
τhT 1
+ ˜nh1
τhD1
−nh
τhT 2
+ ˜nh2
τhD2
+ · · · + δh,
(3) 
StartLayout 1st Row StartFraction partial differential n overTilde Subscript h Baseline 1 Baseline Over partial differential t EndFraction equals StartFraction n Subscript h Baseline Over tau Subscript h upper T Baseline 1 Baseline EndFraction minus StartFraction n overTilde Subscript h Baseline 1 Baseline Over tau Subscript h upper D Baseline 1 Baseline EndFraction comma StartFraction partial differential n overTilde Subscript h Baseline 2 Baseline Over partial differential t EndFraction equals StartFraction n Subscript h Baseline Over tau Subscript h upper T Baseline 2 Baseline EndFraction minus StartFraction n overTilde Subscript h Baseline 2 Baseline Over tau Subscript h upper D Baseline 2 Baseline EndFraction comma EndLayout∂˜nh1
∂t
=
nh
τhT 1
−˜nh1
τhD1
, ∂˜nh2
∂t
=
nh
τhT 2
−˜nh2
τhD2
,
(4) 
where nh is the dynamic concentration of free holes in excess of equilibrium. μh 
is the mobility of the holes, and τ h is the hole lifetime. n overTilde Subscript h Baseline 1˜nh1, τ hT1, and τ eD1 are 
the concentration, trapping, and detrapping lifetime of holes in trapped level 1 
respectively. Similarly, n overTilde Subscript h Baseline 2˜nh2, τ hT2, and τ hD2 are the concentration, trapping, and 
detrapping lifetime of holes in trapped level 2 respectively. δh is the source term. 
The drift of charges is dependent on the electric ﬁeld E, as shown in Eq. (5), with 
the voltage satisfying the Poisson equation Eq. (6), 
StartLayout 1st Row upper E equals minus nabla phi comma EndLayoutE = −∇φ,
(5) 
StartLayout 1st Row nabla squared phi equals minus k StartFraction q Over epsilon EndFraction left parenthesis n Subscript e Baseline plus n overTilde Subscript e Baseline 1 Baseline plus n Subscript h Baseline plus n overTilde Subscript h Baseline 1 Baseline plus n overTilde Subscript h Baseline 2 Baseline plus midline horizontal ellipsis right parenthesis period EndLayout∇2φ = −k q
ϵ (ne + ˜ne1 + nh + ˜nh1 + ˜nh2 + · · · ) .
(6) 
where ϵ represents the permittivity of the RTSD material in Eq. (6). 
The temporal dynamics of free electrons and holes following the SRH model 
is affected by the trapping energy states in the bandgap [46]. For free hole 
concentration p, with trapping and detrapping lifetimes τ Ti and τ Di respectively for 
ith trap, and pti as the concentration of holes in the ith trap, the following equation 
can be written [46], 
StartLayout 1st Row StartFraction d p Over d t EndFraction equals sigma summation Underscript i Endscripts left parenthesis minus StartFraction p Over tau Subscript upper T Baseline 1 Baseline EndFraction plus StartFraction p Subscript t i Baseline Over tau Subscript upper D i Baseline EndFraction right parenthesis period EndLayoutdp
dt =

i

−p
τT 1
+ pti
τDi

.
(7) 
The trapping and detrapping lifetimes dictate whether the defects induce short term 
or long-term trapping of charges in the detector. Considering the low probability of 
transition of charges between the trapping centers, the occurrence of such process 
[47] is neglected in Eq. (7). 
Signals collected at the electrodes arise due to the movement of charges [48–51]. 
High energy photons (γ -rays or X-rays) are incident on the detector and creates 
electron-hole pairs. The hole drifts towards the cathode and electrons towards the

72
S. Banerjee et al.
Fig. 2 (i) Incoming high energy photons (γ -rays or X-rays) interacting with the detector having 
pixelated anode and a single cathode; (ii) Electron-hole motion in the detector – (a) Sensor 
pixelated anode pattern, (b) Central region model illustrating pixelated anode design with uniform 
material and electrons-holes drift in bulk. (Figure adapted with permission [32]) 
Fig. 3 (i) Electric ﬁeld proﬁles for simulated materials A and B, (ii) Anode Signals C, CAT 
and NE simulated for materials A and B (for electron-hole charge injection at Voxel 50). (Figure 
adapted with permission [32]) 
pixelated anodes as shown in Fig. 2a. The detector setup is shown in Fig. 2b(i, 
ii) with the 9 grid electrodes on the anode side (NW, N, NE, W, C, E, SW, S, 
SE) and 1 single large cathode electrode (CAT). Since the mobility of electrons 
is higher than holes, only single cathode is used, and grid anodes are used. In case 
hole mobility is also signiﬁcant, grid cathode can also be used. Figure 3(i) shows 2 
cases of the electric ﬁeld – uniform and piece-wise linear which are plausible inside 
the RTSD, while Fig. 3(ii) shows the signals observed in the cathode electrode and 
three adjacent anodes (center or collecting anode, north and north-east or neighbors)

Machine Learning Approaches in Room Temperature Semiconductor Detectors
73
for electron-hole pair injection at voxel position 50, where in this case the cathode 
was at position 0 and anode at position 100. At a quick glance, there is almost no 
difference in the signals generated at the electrodes due to the 2 Electric Fields as 
shown in Fig. 3(ii). However, with a closer look at the electric ﬁeld proﬁles in Fig. 
3(i), we can see distinct differences between them. Our learning-based approach 
can clearly distinguish between these two electric ﬁeld proﬁles as shown in Fig. 3(i) 
from the signals shown in Fig. 3(ii), along with the charges transport in the volume 
of the RTSD. 
The data for training the proposed learning model has been generated using the 
classical equations, Eqs. (1), (2), (3), (4), (5), (6) and (7). A code based on these 
equations has been developed to deﬁne the charge transport equations in the detec-
tor, by deﬁning the trapping, de-trapping and recombination lifetimes of electrons 
and holes as constant pre-deﬁned parameters, with varying the electric ﬁeld along 
the material. This classical model has been created by spatially discretizing the 
detector. For a charge input at a voxel position, the signals are generated in the 
cathode and pixelated anode. Additionally, the free and trapped charges in different 
spatial pixel locations are computed. These signals, free and trapped charges are 
computed for each time step, with the total number of time steps deﬁned a priori. 
The input-output data for training the learning-based model consists of the input 
electron-hole pair injected at a known voxel position and the output as the signals, 
free and trapped charges in different spatial voxels of the classical model over 
different time steps. 
3 
Machine Learning Based Full Model of Detector 
We introduce a novel method to determine the material properties such as μe, h, 
τ eT1, τ eD1, τ hT1, τ hD1 and recombination coefﬁcients of free and trapped electrons 
and holes at spatially discretized locations in the RTSD. The detector is subdivided 
into N voxels, where the division can be in a 1D, 2D, or 3D manner. In each of the 
discretized volume (or voxel) i, the RTSD properties such as μe, h, i, τ eT1, i, τ eD1, i, 
τ hT1, i, τ hD1, i are deﬁned. These weights are thus spatially discrete from each other. 
For instance, the mobility μe is converted into N discrete values of wTrpt, e. Now, the  
relation between μe and μh can be separately modeled as unknowns or be related to 
each other. This physics-based learning model therefore allows the determination of 
each of these unknowns in the RTSD. For each of these coefﬁcients (referred here 
as τ in general), we compute the number of charges particles (electrons or holes) 
remaining in that particular level as upper N Subscript l e f t Baseline equals upper N 0 e Superscript minus dollar sign t dollar sign slash dollar sign tau dollar signNlef t = N0e
−t
τ , where N0 and Nleft are the 
number of charged particles at a particular level at t = 0 and at time t respectively. 
Thus, given the time t = t1, (example, t1 = 10 ns for the 100-voxel model) and 
given τ, we can compute the fraction of charges transitioning from an energy level 
to another and those remaining in the same energy level.

74
S. Banerjee et al.
Fig. 4 RTSD model with (i) 1D voxels and electrodes, and (ii) Overview of the learning-based 
physical model of RTSD. The model consists of trainable weights in each voxel. The charges 
move dynamically from one voxel to another based on the Electric Field and polarity (blue for 
electrons, and red for holes). The free and trapped charges in each voxel with the signals generated 
during movement of charges are used as output of the model. Cathode and Anode is on outer ends 
of Voxel 1 and N respectively. (Figure adapted with permission [33]) 
3.1 
Machine Learning Based Physical Model 
A voxelated representation of the detector in 1 dimension is shown in Fig. 4(i). 
Linearly the material is divided into N voxel segments with the electrodes at either 
end, anode on the right and cathode on the left. We consider a grid anode with M 
electrodes (M = 9 for illustration) and a single cathode. The high energy photons 
can interact in any position in the detector. 
The resultant physical model in turn is a discretized version of the physical 
phenomena occurring in the RTSD over time. The model can be thought of as being 
analogous to a network composed of Long Short Term Memory (LSTM) or Gated 
Recurrent Unit (GRU) cells [52]. However, in a LSTM/GRU model it would require 
more weights. This will lead to not only training the model with more weights and 
with more training data and time. In order to remove these limitations, we introduce 
a model which corresponds to the exact physics-based equations as shown in Fig. 
5(i). 
In Fig. 5(i), the operations taking place in voxel i at time t are shown. At a time 
t − 1, the charge in voxel i in free state is q Subscript h Superscript t minus 1 comma iqt−1,i
h
for holes and q Subscript e Superscript t minus 1 comma iqt−1,i
e
for electrons. 
Under the inﬂuence of Electric Field, holes drift at time t from other voxels i + 1, 
· · · , i + k, · · · N, to voxel i, with charges q Subscript h comma o Superscript t comma i plus 1 Baseline comma midline horizontal ellipsis comma q Subscript h comma o Superscript t comma i plus k Baseline comma midline horizontal ellipsis comma q Subscript h comma o Superscript t comma upper Nqt,i+1
h,o
, · · · , qt,i+k
h,o
, · · · , qt,N
h,o respectively. 
These charges are added into the existing charge q Subscript n Superscript t minus 1 comma iqt−1,i
n
to form the total charge due 
to holes in voxel i at time t, referred here as q Subscript h comma i n t Superscript t comma iqt,i
h,int. The subscript int refer to the total 
or integrated charge due to sum of all holes in voxel i at time t. Some of the holes 
recombine with the intrinsic electron concentration in the bulk of the material with 
weight whRec, i, which in voxel i at time t is referred as q Subscript h comma upper R e c Superscript t comma iqt,i
h,Rec. The subscript Rec 
refers to recombination. The presence of trapped hole centers in the material traps 
some of the holes and detraps holes back as excess hole concentration over bulk, as

Machine Learning Approaches in Room Temperature Semiconductor Detectors
75
Fig. 5 (i) Operations at voxel 3 at a particular time t. The electron transport from cathode to 
anode (left to right) is shown in the bottom half of this ﬁgure, while the hole transport in the 
opposite direction is shown in the top half of the ﬁgure and (ii) Current generation in the RTSD. 
For simpliﬁcation, we show the 1D model with only ﬁve voxels. Charge transfer from one voxel to 
another induces a potential difference w at the electrodes. The product of transferred charge with 
w gives the generated current at the electrodes. (Figure adapted with permission [32, 33]) 
indicated respectively by the trapping and detrapping weights whT, j, i and whD, j, i, 
for hole trapping level j in voxel i. The total holes which are available for transport 
in the valence band of voxel i at time t is termed as mobile or free holes, q Subscript h comma m o b Superscript t comma iqt,i
h,mob, and 
mob in the subscript denotes the mobile holes. In Fig. 5(i), we show just one level 
of trapping centers (for both electrons and holes). However, in principle, depending 
on the material properties there can be several trapping centers. A fraction of holes 
wh, i drift out of voxel i as q Subscript h comma o Superscript t comma iqt,i
h,o, while the remaining holes are left behind in voxel i 
as q Subscript h Superscript t comma iqt,i
h at time t. Same operations are repeated for electrons, as shown in the bottom 
half of Fig. 5(i). The stepwise computations for holes in voxel i are shown in Eqs. 
8, 9, 10 and 11. 
StartLayout 1st Row q Subscript h comma i n t Superscript t comma i Baseline equals q Subscript h Superscript t minus 1 comma i Baseline plus left parenthesis q Subscript h comma o Superscript t comma i plus 1 Baseline plus midline horizontal ellipsis plus q Subscript h comma o Superscript t comma i plus k Baseline plus midline horizontal ellipsis plus q Subscript h comma o Superscript t comma upper N Baseline right parenthesis EndLayoutqt,i
h,int = qt−1,i
h
+

qt,i+1
h,o
+ · · · + qt,i+k
h,o
+ · · · + qt,N
h,o

(8) 
StartLayout 1st Row q Subscript h comma upper R e c Superscript t comma i Baseline equals w Subscript h upper R e c comma i Baseline times q Subscript h comma i n t Superscript t comma i EndLayoutqt,i
h,Rec = whRec,i × qt,i
h,int
(9) 
StartLayout 1st Row q Subscript h comma m o b Superscript t comma i Baseline equals q Subscript h comma i n t Superscript t comma i Baseline times left parenthesis 1 minus w Subscript h upper R e c comma i Baseline minus w Subscript h upper T comma j comma i Baseline right parenthesis plus left parenthesis q overTilde Subscript h comma j comma i Baseline times w Subscript h upper D comma j comma i Baseline right parenthesis EndLayoutqt,i
h,mob = qt,i
h,int ×

1 −whRec,i −whT,j,i
	
+

˜qh,j,i × whD,j,i
	
(10) 
StartLayout 1st Row q Subscript h comma o Superscript t comma i Baseline equals w Subscript h comma i Baseline times q Subscript h comma m o b Superscript t comma i EndLayoutqt,i
h,o = wh,i × qt,i
h,mob
(11) 
Figure 5(ii) shows the model with the detector discretized into 5 voxels (for 
explanation purposes only). The high energy rays are incident on Voxel V3 creating 
electron-hole pairs. The electrons drift towards the anode (right of Voxel V5), while 
the holes drift towards the cathode (left of Voxel V1). While drifting, the electron

76
S. Banerjee et al.
charges are multiplied by difference of potentials, shown as wL, e1 and wL, e2 for 
electrons drifting between voxel V3 and V4, and, V4 and V5, respectively, to 
generate electrical signals for electrons (signalelectrons). Similarly electrical signals 
are generated due to drift of holes (signalholes). The electrical signals are generated 
in the electrodes based on the Shockley-Ramo Theorem [49]. In each voxel, the free 
and trapped charges, as well as the signals generated at the electrodes are recorded. 
We also consider the voltages at the electrodes at the ends of the detector to be 
ﬁxed Vi and Vf , increasing from cathode to anode in a linear manner. We consider 
Voxel 0 with reference position x0, and successive Voxels 1, 2, · · · , 5, (denoted by 
V1, V2, · · · , V5) at positions x1, x2, · · · , x5 with each successive voxel at distance dx, 
(for example, x5 −x4 = x4 −x3 = dx) from the previous voxel. In between the 2 
voxels (for example voxels 3 and 4), we can apply Eqs. 12a and 12b, where voltages 
V3 and V4 are linearly related. Similarly for voxels 4 and 5, we can apply Eqs. 13a 
and 13b, where Voltage upper V prime 4V ′
4 and upper V prime 5V ′
5 are linearly related. In these equations, C31, C32, 
C41, C42 are learnable coefﬁcients. Now, the voltage V4 and upper V prime 4V ′
4 from Eq. 12b and 
Eq. 13a must match. Thus combining we can formulate an error term, errorvoltage 
as the difference between V4 and upper V prime 4V ′
4 normalized over the distance of Voxel 4 from 
origin 0, x4, deﬁned in Eq. 14, 
StartLayout 1st Row upper V 3 equals upper C 31 x 3 plus upper C 32 EndLayoutV3 = C31x3 + C32
(12a) 
StartLayout 1st Row upper V 4 equals upper C 31 x 4 plus upper C 32 EndLayoutV4 = C31x4 + C32
(12b) 
StartLayout 1st Row upper V prime 4 equals upper C 41 x 4 plus upper C 42 EndLayoutV ′
4 = C41x4 + C42
(13a) 
StartLayout 1st Row upper V prime 5 equals upper C 41 x 5 plus upper C 42 EndLayoutV ′
5 = C41x5 + C42
(13b) 
StartLayout 1st Row e r r o r Subscript v o l t a g e Baseline equals left parenthesis upper C 31 minus upper C 41 right parenthesis minus StartFraction left parenthesis upper C 42 minus upper C 32 right parenthesis Over 4 d x EndFraction EndLayouterrorvoltage = (C31 −C41) −(C42 −C32)
4dx
(14) 
The model is trained with input-output data pairs. The input data is the position 
of injected electron-hole pair along with the fraction of charge generated in that 
voxel. The magnitude of the injected charges is normalized to 1. The output data 
are the signals obtained at the electrodes along with the electrons and holes (free 
and trapped) in each of the voxels over time. During training of the model, the loss 
function is computed as the sum of the squared errors between the signals at the 
electrodes and charges in the voxels compared to the ground truth signals along with 
the e r r o r Subscript v o l t a g e Superscript 2error2
voltage. The overall loss function (LF) for this model is shown in Eq. 15. 
The loss function in Eq. 15 is shown for simulation experiments considering CZT 
detector with 2 trapping centers for holes and 1 trapping center for electrons [14, 
31]. However, in general, there can be several trapping centers for both electrons and 
holes, and thus several such terms, whose number is pre-deﬁned, and the learning-
based model needs to be designed accordingly. In the loss function, the errors due to

Machine Learning Approaches in Room Temperature Semiconductor Detectors
77
the signals and voltage are grouped together, free and trapped electron charges are 
grouped together, and free and trapped charges due to holes are grouped together 
with weighting terms k, l and n respectively. The higher the value of the parameters 
k, l and/or n, the lower the errors associated with those terms. In these error terms, 
the subscript gt for a particular parameter X (for instance X is signal or qe) refers 
to the ground truth data for that parameter X generated using the classical model as 
described and the subscript L for the same parameter X refers to the data generated 
by the learning-based model. 
StartLayout 1st Row StartLayout 1st Row 1st Column upper L upper F equals 2nd Column k left bracket left parenthesis s i g n a l Subscript g t Baseline minus s i g n a l Subscript upper L Baseline right parenthesis squared plus e r r o r Subscript v o l t a g e Superscript 2 Baseline right bracket 2nd Row 1st Column Blank 2nd Column plus l left bracket left parenthesis q Subscript e comma g t Baseline minus q Subscript e comma upper L Baseline right parenthesis squared plus left parenthesis q Subscript e t comma g t Baseline minus q Subscript e t comma upper L Baseline right parenthesis squared right bracket 3rd Row 1st Column Blank 2nd Column plus n left bracket left parenthesis q Subscript h comma g t Baseline minus q Subscript h comma upper L Baseline right parenthesis squared plus left parenthesis q Subscript h upper T 1 comma g t Baseline minus q Subscript h upper T 1 comma upper L Baseline right parenthesis squared plus left parenthesis q Subscript h upper T 2 comma g t Baseline minus q Subscript h upper T 2 comma upper L Baseline right parenthesis squared right bracket EndLayout EndLayout
LF = k


signalgt −signalL
	2 + error2
voltage

+ l


qe,gt −qe,L
	2 +

qet,gt −qet,L
	2
+ n


qh,gt −qh,L
	2 +

qhT1,gt −qhT1,L
	2 +

qhT2,gt −qhT2,L
	2
(15) 
The trainable model weights are initialized to a value. Based on the electron-hole 
pair input to this model, the output (signals, free and trapped charges) is computed 
over time. The model consists of training and testing phases. In the training phase, 
the loss is computed using Eq. 15 for every electron-hole input pair based on the 
outputs from this model and the ground truth output data over time. Since our model 
is a recurrent network structure over time, Backpropagation through Time (BPTT) 
[53, 54] is used to compute the gradients of the loss with respect to the trainable (or 
tunable) weights of the model. BPTT unfolds the learnable model in time by creating 
several copies of the model which can be treated as a feed forward deep network 
with tied weights. The update of the trainable weights is based on a stochastic 
gradient descent method – ADAM optimization [55], which is based on adaptive 
estimation of ﬁrst- and second-order moments. ADAM optimizer is used with a 
learning rate of 5 × 10−4 with two momentum terms set as β1 = 0.9 and β2 = 0.999. 
Learning rate higher than 5 × 10−4 causes oscillations in the loss function, while a 
lower learning rate slows down convergence. In each epoch (iteration), the ADAM 
optimization updates the trainable weights of the model based on the gradients, with 
the goal to minimize the loss function over the epochs. This learning-based physical 
model is developed using Tensorﬂow library [56] in Python. Over the epochs, the 
weights of the model such as electron transport weights wTrpt, e, i, electron trapping 
weights weT, i, electron detrapping weights weD, i and other weights in voxel i as 
shown in Fig. 5(i) in the learning-model are trained. Once the model is trained, 
the model can be tested based on the electron-hole pair input at voxel position. The 
injection position is different from the ones used for training the model. In the testing 
phase, there is no computation of loss. Only the signals and charges are obtained in 
each time step as output from the model.

78
S. Banerjee et al.
3.2 
Experimental Studies 
In order to train and test the model actual measured data would be needed. Unfortu-
nately, no such dataset is available in the literature for RTSD. We generate synthetic 
data using the classical model. Since the learning-based model is developed in 
a voxelated manner, the training data generated using the classical approach is 
also voxelated. During the training process, the loss is monitored over epochs and 
allowed to converge to less than 0.005 or until it stops decreasing. In our simulation 
experiments, there is no signiﬁcant improvement in the model coefﬁcients/weights 
below this threshold loss value. 
3.2.1 
Numerical Experiment with Unweighted Loss Function 
We performed experimental studies with k = l = n = 1 in Eq.  15 and a model with 
100 voxels. The voxel at one end, voxel 100 is connected to the anode terminal while 
the voxel at the other end, voxel 0 is connected to the cathode terminal. The material 
is considered as 1D and discretized into 100 equal partitions, termed as voxels for 
generalization, and the experiments are done with timesteps of 10 ns resolution. 
The simulated detector has size of 10 mm, with total simulation time of 2 μ s. The 
overall loss function reduces over epochs. 
Unit charge in terms of an electron-hole pair is injected at voxel positions 20, 
30, 40, and 50. Figure 6(i–iii) show the drift coefﬁcients, electron coefﬁcients and 
hole coefﬁcients, respectively. The drift coefﬁcients follow the ground truth closely 
as shown in Fig. 6(i). It is seen in Fig. 6(iii) that hole coefﬁcients (for trapping 
centers 1 and 2 and recombination coefﬁcients) also follow closely the ground truth 
coefﬁcients. There are slight oscillations near the injection points of the electron-
hole pair, which are mostly due to the learning of the hole coefﬁcients for voxels 
less than 10 voxels away which is the length of the injection intervals of the e-h 
pairs. Clearly, the closer the injection points, the lower the oscillations in the hole 
coefﬁcients. However, it is seen that the electron coefﬁcients (Fig. 6(ii)) oscillate 
around the ground truth values for the recombination coefﬁcients. 
3.2.2 
Numerical Experiment with Weighted Loss Function 
We performed experimental studies with k, l, n ∈{0.1, 1.0, 10.0, 100.0} in Eq. 15 
using the 100 voxel size model. Now k, l, n can take any ﬁnite values. However, in 
the experimental studies, k, l, n are chosen to be linear in logarithmic scale from 0.1 
to 100, which spans a wide range. The experimental data and the model size used 
for learning the model consists of transport, trapping and detrapping centers for 
electrons and holes, along with recombination of charges. We ﬁnd that for k = 0.1, 
l = 100 and n = 100, the Normalized Mean Square Error (NMSE) [32] has a

Machine Learning Approaches in Room Temperature Semiconductor Detectors
79
Fig. 6 (i) Drift coefﬁcients (μe), (ii) electron coefﬁcients (weT, 1, weD, 1, weRec), and, (iii) hole 
coefﬁcients (whT, 1, whD, 1, whT, 2, whD, 2, whRec) for e-h injection at Voxels 20, 30, 40 and 50. 
(Figure adapted with permission [32]) 
Fig. 7 (i) Drift coefﬁcients (μe), (ii) electron coefﬁcients (weT, 1, weD, 1, weRec), and, (iii) hole 
coefﬁcients (whT, 1, whD, 1, whT, 2, whD, 2, whRec) for e-h injection at Voxels 20, 30, 40 and 50 with 
k = 0.1, l = 100, n = 100 in Eq. 15. (Figure adapted with permission [32]) 
minimum of 0.1761. This combination of k, l, n values in the learning model is used 
for injecting charges at multiple voxel positions of 20, 30, 40, 50. Figure 7(i–iii) 
shows the drift, electron, and hole coefﬁcients, respectively, for material B (material 
B has non-uniform electric ﬁeld proﬁle as shown in Fig. 3(i)). The weighted model 
prioritizes signals at the electrodes, charges (free and trapped) due to electrons and 
holes differently than the unweighted model. Now, since these hole and electron 
charges are more fundamental and the signals are generated only due to charge 
motion, the higher weightage of charges (free and trapped) in the loss function 
compared to the signals drives the model to its optimized material parameters better 
than the unweighted model. In both cases, e-h injection is at the same voxel locations 
of 20, 30, 40, 50. Clearly, choosing appropriately the regularization parameters in 
the loss function improved the accuracy in the learned parameters. 
The physical model can be designed with voxels other than 100 voxels as well. 
For a material with the same dimension as before, increasing the number of voxels 
in the model will reduce the size of each voxel. The decrease in voxel size in the 
model will improve the response characteristics of the output signals.

80
S. Banerjee et al.
3.2.3 
Numerical Experiment with Model Having Higher Voxels 
This model has been designed with 200 voxels having a time step of 5 ns in the 
ground truth model. This time step has been chosen in order to ensure that the 
electrons have enough time to travel from one voxel to the next adjacent voxel. For a 
material with the same dimension as before, increasing the number of voxels in the 
model will decrease each voxel size and improve the response characteristics of the 
output signals. The results of this model injected with electron-hole pair at voxels 
80, 120 and 160 is shown in Figs. 8 and 9 respectively. The model is trained for 60 
voxels at a time for electrons and 20 for holes. k = 0.1, l = 100 and n = 100 have 
been used in this model. Clearly for the electrons and holes, the learned coefﬁcients 
of drift, trapping, detrapping, and recombination match the ground truth values for 
Fig. 8 (i) Drift coefﬁcients (μe), (ii) electron coefﬁcients (weT, 1, weD, 1, weRec), and, (iii) hole 
coefﬁcients (whT, 1, whD, 1, whT, 2, whD, 2, whRec) for e-h injection at Voxels 80, 120 and 160 with 
k = 0.1, l = 100, n = 100 in Eq. 15. Readers are suggested to enlarge the ﬁgure for closer view. 
(Figure adapted with permission [32]) 
Fig. 9 (i) Electron recombination coefﬁcients (weRec), and, (ii) Hole recombination coefﬁcients 
(whRec), for multiple e-h injections at Voxel 80, 120 and 160 with k = 0.1, l = 100, n = 100 in Eq. 
15. Readers are suggested to enlarge the ﬁgure for closer view. (Figure adapted with permission 
[32])

Machine Learning Approaches in Room Temperature Semiconductor Detectors
81
the classical model for most of the cases. Different initializations for the model 
weights than the 100 voxels model provides better convergence to the ground truth. 
In this section, we describe our physics-based learning model for 100 and 200 
voxels. However, this approach can be extended to any voxels as long as the physical 
electron and hole charge transport laws in each voxel holds true. 
4 
Machine Learning Based Full Model of Detector 
The learning-based full model of the detector uses a loss function taking into 
consideration the complete data as required by the classical physical equations – 
signals, voltage distribution in the material, free and trapped charges. In the real 
world, each of these data must be obtained from experimental hardware setups with 
the detector, which not only requires costly equipments, but also skilled manpower 
and time. In order to address this issue, in this section, we propose learning-based 
models to learn from fewer data than in the full model (which is dictated by 
the classical physical model). We explore the models by training with fewer data 
than what is dictated by the classical physical equations, step-wise removing small 
fraction of relevant data from the full learning-model (such as charge trapped and 
trapping centers) and evaluate the performance of the new physics based learning 
model. 
4.1 
Machine Learning Based Physical Model with Reduced 
Data 
4.1.1 
Physical Model-1 
The Physical Model-1 has been developed using signals at the electrodes, voltage 
distribution along the detector, free electron charges and, free and trapped hole 
charges in one trap center as shown in Eq. 16. We use hole charges corresponding to 
only one trapping center and no electron charges for its trapping center for CdZnTe 
detector with 2 trapping centers for holes and 1 trapping center for electrons. Our 
model as shown in Figs. 4 and 5 can be trained using charges corresponding to any 
one of the hole trapping centers, shallow or deep. However, for illustration purposes, 
we have used data from shallow hole trapping center. For any other material with 
NTh trapping centers for holes and NTe trapping centers for electrons, we would 
use the data corresponding to NTe − 1 trapped charges for electrons and NTh −1 
trapped charges for holes.

82
S. Banerjee et al.
StartLayout 1st Row StartLayout 1st Row 1st Column upper L upper F Subscript 1 Baseline equals 2nd Column k left bracket left parenthesis s i g n a l Subscript g t Baseline minus s i g n a l Subscript upper L Baseline right parenthesis squared plus e r r o r Subscript v o l t a g e Superscript 2 Baseline right bracket plus l left bracket left parenthesis q Subscript e comma g t Baseline minus q Subscript e comma upper L Baseline right parenthesis squared right bracket 2nd Row 1st Column Blank 2nd Column plus n left bracket left parenthesis q Subscript h comma g t Baseline minus q Subscript h comma upper L Baseline right parenthesis squared plus left parenthesis q Subscript h upper T 1 comma g t Baseline minus q Subscript h upper T 1 comma upper L Baseline right parenthesis squared right bracket EndLayout EndLayout
LF 1 =k


signalgt −signalL
	2 + error2
voltage

+ l


qe,gt −qe,L
	2
+ n


qh,gt −qh,L
	2 +

qhT1,gt −qhT1,L
	2
(16) 
The learning-based model uses the same hyperparameters k, l, n in the loss function 
in Eq. 15 which was derived through optimization in our last section of the chapter. 
4.1.2 
Physical Model-2 
In Physical Model-1, we observed from our simulation experiments that the hyper-
parameters k, l, n in the loss function are biased heavily towards the hyperparameters 
l, n are much higher than k. Thus, the Physical Model-2 has been developed 
considering only the free electron charges and, free and trapped hole charges – in 
this case using hole charges in hole trapping center – 1 (for illustration purposes). 
The loss function LF2 is then deﬁned in Eq. 17, 
StartLayout 1st Row upper L upper F Subscript 2 Baseline equals l left bracket left parenthesis q Subscript e comma g t Baseline minus q Subscript e comma upper L Baseline right parenthesis squared right bracket plus n left bracket left parenthesis q Subscript h comma g t Baseline minus q Subscript h comma upper L Baseline right parenthesis squared plus left parenthesis q Subscript h upper T 1 comma g t Baseline minus q Subscript h upper T 1 comma upper L Baseline right parenthesis squared right bracket EndLayoutLF 2 = l


qe,gt −qe,L
	2
+ n


qh,gt −qh,L
	2 +

qhT1,gt −qhT1,L
	2
(17) 
In general, for NTh trapping centers for holes and NTe trapping centers for electrons, 
we can use the free hole and electron charges, as well as electron and hole trapped 
charges for NTe − 1 and NTh −1 trapping centers respectively in training the model. 
4.1.3 
Physical Model-3 
In the Physical Model-3, we further reduce the dependency on any of the trapped 
hole charges which were used in the Physical Model-2, and this results in a model 
which characterizes the trapping centers in an equivalent manner. The equivalent 
trapping and detrapping lifetimes are the contribution of several trapping and 
detrapping lifetimes in the detector which contributes to the dynamics of charge 
motion in the detector as shown in Eq. 7. The properties of the physical detector 
can be attributed as defect-free properties in addition to equivalent defects in the 
material. The presence of multiple trapping and detrapping levels can be converted 
to equivalent trapping and detrapping levels. In such a scenario, for 2 hole trapping 
centers of CZT with trapping lifetimes τ 1 and τ 2, the equivalent trapping lifetime is 
given in Eq. 18, 
StartLayout 1st Row StartFraction 1 Over tau Subscript e q Baseline EndFraction equals StartFraction 1 Over tau 1 EndFraction plus StartFraction 1 Over tau 2 EndFraction EndLayout 1
τeq
= 1
τ1
+ 1
τ2
(18) 
Considering the probability of trapping 1 level as p Subscript tau 1pτ1 and detrapping 1 lifetime as 
tau Subscript d t 1τdt1, alongwith probability of trapping 2 level as p Subscript tau 2pτ2 and detrapping 2 lifetime as 
tau Subscript d t 2τdt2, we can calculate the equivalent detrapping lifetime as in Eq. 19,

Machine Learning Approaches in Room Temperature Semiconductor Detectors
83
Fig. 10 Equivalent Operations in Voxel i at time t. (Figure adapted with permission [33]) 
StartLayout 1st Row StartFraction p Subscript tau Sub Subscript e q Subscript Baseline Over tau Subscript e q Baseline EndFraction equals StartFraction p Subscript tau 1 Baseline Over tau Subscript d t 1 Baseline EndFraction plus StartFraction p Subscript tau 2 Baseline Over tau Subscript d t 2 Baseline EndFraction period EndLayoutpτeq
τeq
= pτ1
τdt1
+ pτ2
τdt2
.
(19) 
The physical model-3 is designed as a combination of defect-free model and model 
with equivalent defects. The equivalent computations in a voxel i is shown in Fig. 10. 
The equivalent trapping and detrapping weights are w Subscript h upper T Sub Subscript e q Subscript comma iwhTeq,i and w Subscript h upper D Sub Subscript e q Subscript comma iwhDeq,i for holes, 
and similarly for electrons, the corresponding trapping and detrapping weights are 
w Subscript e upper T Sub Subscript e q Subscript comma iweTeq,i and w Subscript e upper D Sub Subscript e q Subscript comma iweDeq,i. The charges in equivalent trap center are q overTilde Subscript h Sub Subscript e q Subscript comma i˜qheq,i and q overTilde Subscript e Sub Subscript e q Subscript comma i˜qeeq,i for 
holes and electrons respectively. The loss function consists of only the free electron 
and free hole charges to train the model, as shown in Eq. 20, 
StartLayout 1st Row upper L upper F Subscript 3 Baseline equals l left bracket left parenthesis q Subscript e comma g t Baseline minus q Subscript e comma upper L Baseline right parenthesis squared right bracket plus n left bracket left parenthesis q Subscript h comma g t Baseline minus q Subscript h comma upper L Baseline right parenthesis squared right bracket period EndLayoutLF 3 = l


qe,gt −qe,L
	2
+ n


qh,gt −qh,L
	2
.
(20) 
4.1.4 
Physical Model-4 
In Physical Model-4, we use only the signals generated at the cathode and anodes 
due to motion of the charged particles to train. Typically, the signals are generated at 
the electrodes by the superposition of signals generated individually due to transport 
of electrons and transport of holes. However, in Physical Model-4, we separate out 
the signals generated due to the drift of electrons from the signals generated due to 
the drift of holes and then train the model. The loss function for training the physical 
model-4 is shown in Eq. 21,

84
S. Banerjee et al.
StartLayout 1st Row upper L upper F Subscript 4 Baseline equals left bracket left parenthesis s g Subscript e comma g t Baseline minus s g Subscript e comma upper L Baseline right parenthesis squared right bracket plus left bracket left parenthesis s g Subscript h comma g t Baseline minus s g Subscript h comma upper L Baseline right parenthesis squared right bracket EndLayoutLF 4 =


sge,gt −sge,L
	2
+


sgh,gt −sgh,L
	2
(21) 
It is also observed from our simulation experiments that by using the loss function 
in Eq. 21 leads to the trained model weights which fail to converge to the ground 
truth solution. The solution converges to a local minimum which is different from 
global minimum, and hence the trained weights differ from the ground truth weights. 
We use a Total Variation (T.V.) regularization on the different weights of the model 
to converge the learned solution to the global minimum solution as observed in 
our simulation experiments. The loss function gets modiﬁed to LF4, m as shown in 
Eq. 22, 
StartLayout 1st Row StartLayout 1st Row 1st Column upper L upper F Subscript 4 comma m Baseline equals 2nd Column left bracket left parenthesis s g Subscript e comma g t Baseline minus s g Subscript e comma upper L Baseline right parenthesis squared right bracket plus lamda 1 double vertical bar nabla w Subscript e upper T Sub Subscript e q Subscript Baseline plus nabla w Subscript e upper D Sub Subscript e q Subscript Baseline plus nabla w Subscript e comma upper R e c Baseline double vertical bar Subscript 2 2nd Row 1st Column Blank 2nd Column plus left bracket left parenthesis s g Subscript h comma g t Baseline minus s g Subscript h comma upper L Baseline right parenthesis squared right bracket plus lamda 2 double vertical bar nabla w Subscript h upper T Sub Subscript e q Subscript Baseline plus nabla w Subscript h upper D Sub Subscript e q Subscript Baseline plus nabla w Subscript h comma upper R e c Baseline double vertical bar Subscript 2 EndLayout EndLayout
LF 4,m =


sge,gt −sge,L
	2
+ λ1
∇weTeq + ∇weDeq + ∇we,Rec

2
+


sgh,gt −sgh,L
	2
+ λ2
∇whTeq + ∇whDeq + ∇wh,Rec

2
(22) 
The T.V. regularization ensures smoothness in the trained weights of the model. 
The optimal values of λ1 and λ2 are determined through simulation experiments 
by ﬁnding the minimum error between the ground truth weights and the trained 
weights. 
The trained weights for the different Physical Models have been evaluated by 
computing an error metric for each of the weights. For example, for electron 
trapping weight (weT) with weT, gt and weT, lr as the ground truth and trained weights 
respectively, the error is expressed as, 
StartLayout 1st Row upper E r r left parenthesis w Subscript e upper T Baseline right parenthesis equals StartRoot StartFraction 1 Over upper N Subscript f i n Baseline minus upper N Subscript i n j Baseline plus 1 EndFraction sigma summation Underscript i equals upper N Subscript i n j Baseline Overscript upper N Subscript f i n Baseline Endscripts StartSet StartFraction w Subscript e upper T comma l r comma i Baseline minus w Subscript e upper T comma g t comma i Baseline Over w Subscript e upper T comma g t comma i Baseline EndFraction EndSet squared EndRoot EndLayoutErr (weT ) =





1
Nf in −Ninj + 1
Nf in

i=Ninj
weT,lr,i −weT,gt,i
weT,gt,i
2
(23) 
The error is computed over the injection positions of the electrons/holes and the 
number of voxels over which the weight gets trained over the epochs. The difference 
between the trained weights and ground truth weights for the trained region is 
normalized by the ground truth weights, to take into account the different ranges 
of weights in the model and put equal emphasis on the different model weights. The 
relative error, expressed as 
StartLayout 1st Row upper E r r Baseline 2 left parenthesis w Subscript e upper T Baseline right parenthesis equals StartFraction 1 Over upper N Subscript f i n Baseline minus upper N Subscript i n j Baseline plus 1 EndFraction sigma summation Underscript i equals upper N Subscript i n j Baseline Overscript upper N Subscript f i n Baseline Endscripts StartAbsoluteValue StartFraction w Subscript e upper T comma l r comma i Baseline minus w Subscript e upper T comma g t comma i Baseline Over w Subscript e upper T comma g t comma i Baseline EndFraction EndAbsoluteValue times 100 EndLayoutErr2 (weT ) =
1
Nf in −Ninj + 1
Nf in

i=Ninj

weT,lr,i −weT,gt,i
weT,gt,i
 × 100
(24) 
for each of the trained weight are also shown for electrons and holes for the four 
different physical models. For electron and hole weights, the mean of the different 
electron and hole weights are computed as the relative error metric.

Machine Learning Approaches in Room Temperature Semiconductor Detectors
85
Fig. 11 (i) Drift coefﬁcients (μe), (ii) electron coefﬁcients (weT, weD, weRec), and, (iii) hole 
coefﬁcients (whT, 1, whD, 1, whT, 2, whD, 2, whRec) for e-h injection at voxel positions 9 with stride 
of 5 voxels until voxel 59 for k, l, n in Physical Model-1 as shown in the plot legend. Rec in the 
legend refers to recombination coefﬁcients. Readers are suggested to enlarge the ﬁgure for closer 
view. (Figure adapted with permission [33]) 
4.2 
Experimental Studies 
4.2.1 
Numerical Experiments with Physical Model-1 
We performed experimental studies with unit electron-hole charge pair injections 
at voxel positions 9 with stride of 5 voxels until voxel 59. The trained weights of 
the model for electron drift coefﬁcients, electron and hole trapping coefﬁcients are 
shown in Fig. 11(i–iii) respectively for different k, l and n in the loss function shown 
in Eq. 16. The error for the electron coefﬁcients is computed from Voxels 9 to 99 
since the electrons move towards anode, Voxel 100, and the coefﬁcients in those 
voxels gets trained, while for the hole coefﬁcients, the error is computed from Voxels 
1–59, where the hole move towards cathode, Voxel 0. For k = 1, l = 104 and n = 103, 
the mean error (Err) of the trained weights has a minimum of 0.0821, while for 
k = 1, l = 103 and n = 103, the mean error (Err) is 0.1140. 
4.2.2 
Numerical Experiments with Physical Model-2 
Unit charge in terms of electron-hole pair injections at voxel positions 9 with stride 
of 5 voxels until voxel 5 9 is fed into the model in order to train the model. The 
trained weights of the model – drift coefﬁcients, electron coefﬁcients and hole 
coefﬁcients are shown in Fig. 12(i–iii) respectively. In the weighted loss function of 
Eq. 17, we use the weights l = 10, n = 1. The error values of drift coefﬁcients (μe), 
trapping (weT), detrapping (weD), recombination coefﬁcients (weRec) for electrons 
are 1.6108 × 10−4, 0.1241, 0.0240, 0.1673 respectively which are computed for 
voxels 9 to 99. Similarly, the error values of the trapping 1 (whT, 1), detrapping 1 
(whD, 1), trapping 2 (whT, 2), detrapping 2 (whD, 2) and recombination coefﬁcients 
(whRec) for holes are 0.0768, 0.0447, 0.1005, 0.0640, 0.2406 respectively which are 
computed for voxels 1–59. The arithmetic mean of the error of these coefﬁcients is 
0.0936.

86
S. Banerjee et al.
Fig. 12 (i) Drift coefﬁcients (μe), (ii) electron coefﬁcients (weT, weD, weRec), and, (iii) hole 
coefﬁcients (whT, 1, whD, 1, whT, 2, whD, 2, whRec) for e-h injection at voxel positions 9 with stride 
of 5 voxels until voxel 59 for k, l, n in Physical Model-2 as shown in the plot legend. Rec in the 
legend refers to recombination coefﬁcients. Readers are suggested to enlarge the ﬁgure for closer 
view. (Figure adapted with permission [33]) 
Fig. 13 (i) Drift coefﬁcients (μe), (ii) electron coefﬁcients (weT, weD, weRec), and, (iii) hole 
coefﬁcients (whT, 1, whD, 1, whT, 2, whD, 2, whRec) for e-h injection at voxel positions 9 with stride 
of 5 voxels until voxel 59 for k, l, n in Physical Model-3 as shown in the plot legend. Rec in the 
legend refers to recombination coefﬁcients. Readers are suggested to enlarge the ﬁgure for closer 
view. (Figure adapted with permission [33]) 
4.2.3 
Numerical Experiments with Physical Model-3 
The electron-hole charge pairs are injected at voxel positions 9 with stride of 5 
voxels until voxel 59 during training the Physical Model-3 as well. The learned 
physical properties of the model – drift coefﬁcients, electron coefﬁcients and hole 
coefﬁcients are shown in Fig. 13(i–iii) respectively. Equation 20 is used as the 
loss function with weights l = 10 and n = 1. Clearly, the electron drift, trapping, 
detrapping and recombination coefﬁcients follow the ground truth values. The 
learned recombination coefﬁcients for the holes follow the ground truth values as 
well. For multiple trapping centers for holes (2 in this case), the learning-based 
model ﬁnds the equivalent trapping center, with equivalent trapping and detrapping 
lifetimes following Eqs. 18 and 19 respectively. 
The ground truth values of trapping 1 lifetime is 0.195 μ s and trapping 2 lifetime 
is 0.094 μ s corresponding to probability of trapping holes in trap center 1 and 2 to 
be 0.05 and 0.10 respectively. The ground truth equivalent trapping lifetime (τ eq) 
is calculated using Eq. 18 to be 0.0634 μs. The fraction of holes getting trapped in

Machine Learning Approaches in Room Temperature Semiconductor Detectors
87
the equivalent trapping center is 1 − 0.8541 = 0.1459. Similarly, in the ground truth 
simulation data, we considered fraction of charge getting detrapped from trap center 
1 and 2 are 0.10 and 0.05 respectively. In the same manner, the detrapping 1 and 
2 lifetimes are 94.9122 ns and 194.9573 ns respectively. Considering Eq. 19, and 
equivalent trapping probability as 0.1459, we compute the equivalent detrapping 
lifetime τ dt, eq as 145.9 ns. The fraction of holes remaining after detrapping from 
the equivalent trapping level would be 0.9338. Thus, the fraction of charges getting 
detrapped from the equivalent trapping center is 1 − 0.9338 = 0.0662. For the 
trained weights as shown in Fig. 13, the error values of drift coefﬁcients (μe), 
trapping (weT), detrapping (weD), recombination coefﬁcients (weRec) for electrons 
are 1.32 × 10−5, 0.0412, 0.0316, 0.0277 respectively which are computed for voxels 
9 to 99. Similarly, the error values of the equivalent trapping (whT, eq), equivalent 
detrapping (whD, eq), and recombination coefﬁcients (wh, Rec), for holes are 0.0954, 
0.1957 and 0.3378 respectively which are computed for voxels 1–59. The arithmetic 
mean of the error of these material properties is 0.1042. 
4.2.4 
Numerical Experiments with Physical Model-4 
The physical model-4 is trained with signals generated from motion due to 
electrons and holes separately. Figure 14 shows the hole trapping, detrapping and 
recombination coefﬁcients due to electron-hole pair injection at voxel positions 
24, 27 and 30 for different λ2 in Eq. 22. During training, the trapping hole and 
detrapping hole weights were bounded in [0.04, 0.07], and [0.15, 0.30] respectively 
which are close to the actual ground truth weights. The initialization of trapping, 
detrapping and recombination coefﬁcients for holes are done uniformly at 0.05, 0.2, 
and 0.005 respectively. It is seen that for λ2 = 0, the hole trapping, detrapping and 
recombination coefﬁcients does not converge to the ground truth hole coefﬁcients. 
However, using T.V. regularization improves the convergence of these coefﬁcients 
to actual ground truth values. For λ2 = 0.001 and 0.01, the hole trapping and 
detrapping coefﬁcients are closer to the ground truth coefﬁcients than for λ2 = 0.1 
and hence smaller the error. However, for recombination coefﬁcients, the trained 
weights for λ2 = 0.1, 0.01 and 0.001 are better than for λ2 = 0. Thus, it is seen 
that the weights λ2 = 0.01, 0.001 in the loss function of Eq. 22 provides better 
convergence for the hole coefﬁcients. 
Additional simulation experiments have been done with λ2 = {0.001, 0.01} with-
out bounds on trapping and detrapping coefﬁcients and electron-hole pair injections 
at Voxels 24, 26 and 28. All the initial weights of trapping and detrapping over the 
voxels has been uniformly initialized as {0.005, 0.005}, {0.05, 0.2}, {0.07, 0.3} which 
corresponds to ‘far’, ‘ip1’ and ‘ip2’ respectively in Figs. 15 and 16. It is observed 
that bounds on the trapping and detrapping weights do not have any inﬂuence on 
the ﬁnal trained weights of the holes. However, for λ2 = 0.001, the hole trapping, 
detrapping and recombination coefﬁcients converge more closely to the ground truth 
parameters. Additionally, initializing the trapping and detrapping hole weights with 
‘ip2’ provides better convergence to the trained weights.

88
S. Banerjee et al.
Fig. 14 Trapping, Detrapping and Recombination Hole Coefﬁcients for hole injection at Voxels 
24, 27 and 30 in Physical Model-4 with varying λ values as shown in the legend. Here λ refers 
to λ2 in Eq. 22. Readers are suggested to enlarge the ﬁgure for closer view. (Figure adapted with 
permission [33]) 
Fig. 15 Trapping, Detrapping and Recombination Hole Coefﬁcients for hole injection at Voxels 
24, 26 and 28 in Physical Model-4 with λ = 0.001 as shown in the legend. Here λ refers to λ2 in Eq. 
22. Readers are suggested to enlarge the ﬁgure for closer view. (Figure adapted with permission 
[33]) 
Fig. 16 Trapping, Detrapping and Recombination Hole Coefﬁcients for hole injection at Voxels 
24, 26 and 28 in Physical Model-4 with λ = 0.01 as shown in the legend. Here λ refers to λ2 in Eq. 
22. Readers are suggested to enlarge the ﬁgure for closer view. (Figure adapted with permission 
[33]) 
Similar experiments have been done with varying λ1 = 0.1 in Eq.  22 with 
λ1 ∈{0, 0.001, 0.01, 0.1}. The electron-hole pair injections are at Voxels 81, 84 
and 87. It is seen that for λ1 = 0.1 in Eq. 22, the mean error value has the

Machine Learning Approaches in Room Temperature Semiconductor Detectors
89
Fig. 17 (i) Drift, (ii) Trapping and Detrapping, and (iii) Recombination Electron Coefﬁcients for 
electron injection at Voxels 81, 84 and 87 in Physical Model-4 with λ1 = 0.1 as shown in the 
legend. Here λ refers to λ1 in Eq. 22. Readers are suggested to enlarge the ﬁgure for closer view. 
(Figure adapted with permission [33]) 
minimum value of 0.0638. During training, the bounds on trapping, detrapping 
and recombination weights for electrons are bounded in [0.004, 0.012], [0.008, 0.02] 
and [0.0005, 0.005] respectively, while the initialization of trapping, detrapping and 
recombination coefﬁcients for electrons are done uniformly at 0.012, 0.015 and 
0.002 respectively. This is referred to as ‘bound’. Additional simulation experiments 
have been done with λ1 = 0.1 without bounds on trapping, detrapping and 
recombination coefﬁcients with electron-hole pair injections at the same Voxels. 
The initialization of trapping, detrapping and recombination weights for electrons 
are done with the same values of {0.012, 0.015, 0.002}, {0.02, 0.02, 0.004} and 
{0.005, 0.009, 0.0005} which are referred as ‘same’, ‘grtr’ and ‘lt’ respectively. It is 
seen that for ‘grtr’ case, the mean error has the value of 0.1159 which is minimum 
of these three cases. Overall, the case with ‘bound’ provides us with the minimum 
error for the electron coefﬁcients. Figure 17 shows the electron drift, trapping, 
detrapping and recombination coefﬁcients for λ = 0.1 with ‘bound’ and ‘grtr’ cases. 
The material properties for the electrons converges very closely to the corresponding 
ground truth values. 
4.3 
Comparison of the Different Physical Models 
The performance of the different physical models is shown in Table 1. The mean 
relative error due to the electron coefﬁcients (Err2(electrons)) are separated from 
that of holes (Err2(holes)) and the mean of Err2(electrons) and Err2(holes) are then 
computed as Err2(Total) in Table 1. For Physical Model-1, k = 1, l = 104, n = 103 
are used with electron-hole pair injections are voxel position 9 with stride of 5 voxels 
until voxel 59. For Physical Model-2, l = 10, n = 1 is used, with same electron-
hole pair injections as in Physical Model-1. For Physical Model-3, l = 10, n = 1, 
and the electron-hole pair injections are in the same voxel position as in Physical 
Model-1 and 2. In Physical Model-4, the electrons and holes coefﬁcients are trained

90
S. Banerjee et al.
Table 1 Relative Error (in %) for the four different physical models 
Physical model
Err2(electrons)
Err2(holes)
Err2(Total) 
1
2.4104
2.9942
2.7023 
2
2.6536
3.6098
3.1317 
3
1.3443
16.0488
8.6966 
4 (holes only)
×
3.2256
4.1909 
4 (electrons only)
5.1561
× 
separately. Hence, the Err2(electrons) only refers to the relative error result for the 
model trained for electron coefﬁcients only. The electron injections are at voxel 
81, 84 and 87 with λ1 = 0.1 with ‘bound’ condition as described in the previous 
subsection. The hole injections are at voxel 24, 26 and 28 with λ1 = 0.001 with 
‘ip2’ condition as described in the previous subsection. 
It is seen that for Physical Models 1 and 2, the Err2(Total) value is small. On 
the other hand, for Physical Model 3, the Err2(holes) are maximum. This is because 
in the learned model, the hole coefﬁcients (equivalent in this case) tend to oscillate 
around the ground truth value. Overall, the Err2(Total) is less than 9%, which shows 
good convergence of the RTSD material parameters to the ground truth values. 
5 
Discussion and Conclusion 
We demonstrate how machine learning can be used to characterize the Room 
Temperature Semiconductor Detector (RTSD) at a much ﬁner scale spatially which 
is vital for developing more sophisticated algorithms and its implementation in large 
scale medical and industrial applications. We consider pixelated conﬁguration of the 
RTSD detector in demonstrating our physics-based machine learning approach, but 
this method can be extended to other electrode conﬁgurations as well. The RTSD 
crystal is virtually discretized into small volumes or voxels where the physical 
laws governing the electron and hole charge motion in the RTSD holds true. A 
learning-based model has been developed by incorporating these physical laws – 
transport, trapping, detrapping and recombination of electron and hole charges for 
each of these voxels. The electron-hole charge pair is injected in this model at one 
or multiple positions and the outputs of the model are the signals at the electrodes, 
along with free and trapped charges in the crystal. The CZT detector in this model 
is considered to have 1 trapping center for electrons and 2 for holes. However, 
this physics-based machine learning approach can be extended to any number of 
trapping centers for electrons and holes. Once trained on the ground truth data, the 
learning model has the trained weights which are the material properties in terms 
of drift, trapping, detrapping and recombination coefﬁcients for both electrons and 
holes.

Machine Learning Approaches in Room Temperature Semiconductor Detectors
91
The data required to train the learning-based models must be generated in real 
world using several experimental setups and expertise. This is not repeatable and 
scalable for numerous RTSD crystals which are required for several applications. 
In order to address this issue, several reduced order models have been developed 
in Sect. 4 requires fewer data for training the model. One of our models, Physical 
Model-4 can identify most of the material properties just using the signals at the 
electrodes, which ﬁnds suitable application in current electronic sensor hardware 
setup. 
There are a few limitations of our physics-based machine learning approach in 
characterizing RTSDs. Our model has been developed by considering a forward 
physics model (classical model) as described in Sect. 2 of this chapter. However, 
there are other physical equations which describe the charge transport in RTSDs. 
Although our physics-based machine learning methodology for ﬁnding the material 
properties in micron scale is still valid for those forward models (classical models), 
the detailed implementation in that case needs to be carried out. Additionally, since 
this physics-based learning model has been based on equations used in a classical 
model, the physics-based learning model has the risks of “inverse crime” [58] when 
the same (or nearly the same) theoretical ingredients are employed to synthesize 
as well as invert data in an inverse problem. In order to avoid this pitfall, one way 
could be to use a relaxed theoretical model compared to the one exactly used as the 
forward model. Alternatively, a traditional machine learning or deep learning model 
can be used in conjunction with the physics-based learning model. In this work, 
the machine learning based models have been developed without considering noise 
such as Poisson noise, Quantization noise, Sampling Noise or other Statistical noise 
and actual experimental data from sensor hardware electronics. Developing models 
incorporating this information a priori  is one of the future research directions. This 
physics-based machine learning also needs to be trained based on training data on 
GPUs. Although the training time is a few hours, but this also needs to be accounted 
for while implementing this model. However, this drawback exists in mostly all deep 
learning and artiﬁcial intelligence models, but since our physics-based model uses 
far less training weights, the training time is faster than conventional deep learning 
models and faster than the classical approaches using non-deep learning methods or 
experimental approaches. 
Overall, the chapter presents a novel approach of physics-based machine learning 
model for characterizing RTSDs. This work has been discussed in more details 
in [32–36, 57]. Our approach in characterization of the RTSD is the ﬁrst novel 
approach in this ﬁeld. Additionally, we have used most of the knowledge of the 
physical world in this model, some of which may vary from crystal to crystal. 
Development of learning-based models which use fewer physical laws, which can 
infer the physics from data is another interesting approach which is within the scope 
of future work. Incorporating the sensor models to image reconstruction and reuse 
of imperfect RTSD sensors is one the applications for the learning-based physical 
model. Our learning-based model can be extended to sub-pixel imaging and improve 
the quality of image reconstruction.

92
S. Banerjee et al.
References 
1. Scheiber, C., & Giakos, G. C. (2001). Medical applications of CdTe and CdZnTe detectors. 
Nuclear Instruments and Methods in Physics Research Section A: Accelerators, Spectrometers, 
Detectors and Associated Equipment, 458(1–2), 12–25. 
2. Schlesinger, T. E., Toney, J. E., Yoon, H., Lee, E. Y., Brunett, B. A., Franks, L., & James, R. B. 
(2001). Cadmium zinc telluride and its use as a nuclear radiation detector material. Materials 
Science and Engineering: R: Reports, 32(4–5), 103–189. 
3. Butler, A. P. H., Anderson, N. G., Tipples, R., Cook, N., Watts, R., Meyer, J., Bell, A. J., Melzer, 
T. R., & Butler, P. H. (2008). Bio-medical X-ray imaging with spectroscopic pixel detectors. 
Nuclear Instruments and Methods in Physics Research Section A: Accelerators, Spectrometers, 
Detectors and Associated Equipment, 591(1), 141–146. 
4. Sordo, S. D., Abbene, L., Caroli, E., Mancini, A. M., Zappettini, A., & Ubertini, P. (2009). 
Progress in the development of CdTe and CdZnTe semiconductor radiation detectors for 
astrophysical and medical applications. Sensors, 9(05), 3491–3526. 
5. Johns, P. M., & Nino, J. C. (2019). Room temperature semiconductor detectors for nuclear 
security. Journal of Applied Physics, 126(4), 040902. 
6. Roy, U. N., Camarda, G. S., Cui, Y., Gul, R., Yang, G., Zazvorka, J., Dedic, V., Franc, J., 
& James, R. B. (2019). Evaluation of CdZnTeSe as a high-quality gamma-ray spectroscopic 
material with better compositional homogeneity and reduced defects. Scientiﬁc Reports, 9(1), 
7303. 
7. Zhang, N., Yeckel, A., Burger, A., Cui, Y., Lynn, K. G., & Derby, J. J. (2011). Anomalous 
segregation during electrodynamic gradient freeze growth of cadmium zinc telluride. Journal 
of Crystal Growth, 325(1), 10–19. 
8. Bolotnikov, A. E., Camarda, G. S., Cui, Y., Yang, G., Hossain, A., Kim, K., & James, R. B. 
(2013). Characterization and evaluation of extended defects in CZT crystals for gamma-ray 
detectors. Journal of Crystal Growth, 379, 46–56. 
9. Carini, G. A., Bolotnikov, A. E., Camarda, G. S., & James, R. B. (2007). High-resolution X-ray 
mapping of CdZnTe detectors. Nuclear Instruments and Methods in Physics Research Section 
A: Accelerators, Spectrometers, Detectors and Associated Equipment, 579(1), 120–124. 
10. Amman, M., Lee, J. S., & Luke, P. N. (2002). Electron trapping nonuniformity in high-
pressure-Bridgman-grown CdZnTe. Journal of Applied Physics, 92(6), 3198–3206. 
11. Camarda, G. S., Bolotnikov, A. E., Cui, Y., Hossain, A., Awadalla, S. A., Mackenzie, J., Chen, 
H., & James, R. B. (2008). Polarization studies of cdznte detectors using synchrotron x-ray 
radiation. IEEE Transactions on Nuclear Science, 55(6), 3725–3730. 
12. Roy, U. N., Camarda, G. S., Cui, Y., & James, R. B. (2021). Advances in CdZnTeSe for 
radiation detector applications. Radiation, 1(2), 123–130. 
13. Veale, M. C., Booker, P., Cross, S., Hart, M. D., Jowitt, L., Lipp, J., Schneider, A., Seller, P., 
Wheater, R. M., Wilson, M. D., & Hansson, C. C. T. (2020). Characterization of the uniformity 
of high-ﬂux CdZnTe material. Sensors, 20(10), 2747. 
14. Lee, E. Y., James, R. B., Olsen, R. W., & Hermon, H. (1999). Compensation and trapping 
in CdZnTe radiation detectors studied by thermoelectric emission spectroscopy, thermally 
stimulated conductivity, and current-voltage measurements. Journal of Electronic Materials, 
28(6), 766–773. 
15. Tepper, G. C., Kessick, R., James, R. B., & Van den Berg, L. (2000, November). Contactless 
measurements of charge traps and carrier lifetimes in detector-grade cadmium zinc telluride 
and mercuric iodide. In Hard X-ray, gamma-ray, and neutron detector physics II (Vol. 4141, 
pp. 76–88). SPIE. 
16. Meduni´c, Z., Pastuovi´c, Ž., Jakši´c, M., & Skukan, N. (2005). Studying of trap levels by the use 
of focused ion beams. Nuclear Instruments and Methods in Physics Research Section B: Beam 
Interactions with Materials and Atoms, 231(1–4), 486–490. 
17. Pavlovi´c, M., Jakši´c, M., Zorc, H., & Meduni´c, Z. (2008). Identiﬁcation of deep trap levels from 
thermally stimulated current spectra of semi-insulating CdZnTe detector material. Journal of 
Applied Physics, 104(2), 023525.

Machine Learning Approaches in Room Temperature Semiconductor Detectors
93
18. Rodrigues, M. L., & He, Z. (2011, October). High-ﬂux experiments and simulations of 
pulse-mode 3d-position-sensitive CdZnTe pixelated detectors. In 2011 IEEE nuclear science 
symposium conference record (pp. 4677–4688). IEEE. 
19. Blakney, R. M., & Grunwald, H. P. (1967). Small-signal current transients in insulators with 
traps. Physical Review, 159(3), 658. 
20. Jung, M., Morel, J., Fougeres, P., Hage-Ali, M., & Siffert, P. (1999). A new method for 
evaluation of transport properties in CdTe and CZT detectors. Nuclear Instruments and Meth-
ods in Physics Research Section A: Accelerators, Spectrometers, Detectors and Associated 
Equipment, 428(1), 45–57. 
21. Prokesch, M., Bale, D. S., & Szeles, C. (2010). Fast high-ﬂux response of CdZnTe x-ray 
detectors by optical manipulation of deep level defect occupations. IEEE Transactions on 
Nuclear Science, 57(4), 2397–2399. 
22. Tepper, G. C., Kessick, R., & Szeles, C. (2001, December). Investigation of the electronic 
properties of cadmium zinc telluride surfaces using pulsed laser microwave cavity perturbation. 
In Hard X-ray and gamma-ray detector physics III (Vol. 4507, pp. 79–89). SPIE. 
23. Zheng, Q., Dierre, F., Franc, J., Crocco, J., Bensalah, H., Corregidor, V., Alves, E., Ruiz, E., 
Vela, O., Perez, J. M., & Dieguez, E. (2012). Investigation of generation of defects due to 
metallization on CdZnTe detectors. Journal of Physics D: Applied Physics, 45(17), 175102. 
24. Willard, J., Jia, X., Xu, S., Steinbach, M., & Kumar, V. (2022). Integrating scientiﬁc knowledge 
with machine learning for engineering and environmental systems. ACM Computing Surveys, 
55(4), 1–37. 
25. Karniadakis, G. E., Kevrekidis, I. G., Lu, L., Perdikaris, P., Wang, S., & Yang, L. (2021). 
Physics-informed machine learning. Nature Reviews Physics, 3(6), 422–440. 
26. Khoo, Y., Lu, J., & Ying, L. (2019). Solving for high-dimensional committor functions using 
artiﬁcial neural networks. Research in the Mathematical Sciences, 6, 1–13. 
27. Han, J., Jentzen, A., & E, W. (2018). Solving high-dimensional partial differential equations 
using deep learning. Proceedings of the National Academy of Sciences, 115(34), 8505–8510. 
28. Hughes, T. W., Williamson, I. A., Minkov, M., & Fan, S. (2019). Wave physics as an analog 
recurrent neural network. Science Advances, 5(12), eaay6946. 
29. Lu, L., Jin, P., Pang, G., Zhang, Z., & Karniadakis, G. E. (2021). Learning nonlinear operators 
via DeepONet based on the universal approximation theorem of operators. Nature Machine 
Intelligence, 3(3), 218–229. 
30. Markidis, S. (2021). The old and the new: Can physics-informed deep-learning replace 
traditional linear solvers? Frontiers in Big Data, 4, 92. 
31. Rodrigues, M. (2012). High-ﬂux experiments and simulations of pulse-mode position-sensitive 
CdZnTe pixelated detectors. PhD thesis, University of Michigan. 
32. Banerjee, S., Rodrigues, M., Vija, A. H., & Katsaggelos, A. K. (2021). A learning-based 
physical model of charge transport in room-temperature semiconductor detectors. IEEE 
Transactions on Nuclear Science, 69(1), 2–16. 
33. Banerjee, S., Rodrigues, M., Ballester, M., Vija, A. H., & Katsaggelos, A. K. (2023). Learning-
based physical models of room-temperature semiconductor detectors with reduced data. 
Scientiﬁc Reports, 13(1), 168. 
34. Banerjee, S., & Rodrigues, M. (2022). Space time electron-hole charge transport network for 
solid-state material studies. U.S. Patent 11,480,608. Siemens Medical Solutions USA Inc. 
35. Banerjee, S., & Rodrigues, M. (2021). Inverse neural network for particle detection in a solid-
state-devices. U.S. Patent Application 16/850,306. Siemens Medical Solutions USA Inc. 
36. Vija, A. H., Rodrigues, M., Banerjee, S., & Katsaggelos, A. (2022). Enhancement of weak 
signal for machine training neural network representing a solid-state detector. U.S. Patent 
Application 17/302,718. Northwestern University and Siemens Medical Solutions USA Inc. 
37. Diéguez, E. (2011). Growth of Cd0.9Zn0.1Te bulk crystals. Comprehensive Semiconductor 
Science and Technology, 3, 170–201. 
38. Shockley, W. T. R. W., & Read, W. T., Jr. (1952). Statistics of the recombinations of holes and 
electrons. Physical Review, 87(5), 835. 
39. Hall, R. N. (1952). Electron-hole recombination in germanium. Physical Review, 87(2), 387.

94
S. Banerjee et al.
40. Rodrigues, M. L., & He, Z. (2011, September). Properties and spectroscopic performance 
of semiconductor detectors under high-ﬂux irradiation. In Medical applications of radiation 
detectors (Vol. 8143, pp. 51–61). SPIE. 
41. Prettyman, T. H. (1999). Method for mapping charge pulses in semiconductor radiation 
detectors. Nuclear Instruments and Methods in Physics Research Section A: Accelerators, 
Spectrometers, Detectors and Associated Equipment, 422(1–3), 232–237. 
42. Durst, J., Bartl, P., Kreisler, B., Michel, T., & Anton, G. (2008, October). Monte Carlo 
simulation of pixelated photon counting X-ray detectors like the Medipix2 and the Medipix3 
using high-Z sensor materials. In 2008 IEEE nuclear science symposium conference record 
(pp. 4990–4994). IEEE. 
43. Picone, M., Glière, A., & Massé, P. (2003). A three-dimensional model of cdznte gamma-ray 
spectrometer. Nuclear Instruments and Methods in Physics Research Section A: Accelerators, 
Spectrometers, Detectors and Associated Equipment, 504(1–3), 313–316. 
44. Sze, S. M., Li, Y., & Ng, K. K. (2021). Physics of semiconductor devices. Wiley. 
45. Prokesch, M. (2015). CdZnTe for gamma and x-ray applications. In Solid-state radiation 
detectors: Technology and applications (pp. 17–48). CRC Press. 
46. Musiienko, A., Pipek, J., Praus, P., Brynza, M., Belas, E., Dryzhakov, B., Mao-Hua, D., 
Ahmadi, M., & Grill, R. (2020). Deciphering the effect of traps on electronic charge 
transport properties of methylammonium lead tribromide perovskite. Science Advances, 6(37), 
eabb6393. 
47. Musiienko, A., Grill, R., Moravec, P., Korcsmáros, G., Rejhon, M., Pekárek, J., Elhadidy, H., 
Šedivý, L., & Vasylchenko, I. (2018). Dual-wavelength photo-Hall effect spectroscopy of deep 
levels in high resistive CdZnTe with negative differential photoconductivity. Journal of Applied 
Physics, 123(16), 161502. 
48. Shockley, W. (1938). Currents to conductors induced by a moving point charge. Journal of 
Applied Physics, 9(10), 635–636. 
49. Ramo, S. (1939). Currents induced by electron motion. Proceedings of the IRE, 27(9), 584– 
585. 
50. Knoll, G. F. (2010). Radiation detection and measurement. Wiley. 
51. He, Z. (2001). Review of the Shockley–Ramo theorem and its application in semiconductor 
gamma-ray detectors. Nuclear Instruments and Methods in Physics Research Section A: 
Accelerators, Spectrometers, Detectors and Associated Equipment, 463(1–2), 250–267. 
52. Van Houdt, G., Mosquera, C., & Nápoles, G. (2020). A review on the long short-term memory 
model. Artiﬁcial Intelligence Review, 53, 5929–5955. 
53. Werbos, P. J. (1990). Backpropagation through time: What it does and how to do it. Proceedings 
of the IEEE, 78(10), 1550–1560. 
54. Rumelhart, D. E., Hinton, G. E., & Williams, R. J. (1985). Learning internal representations 
by error propagation. California University San Diego La Jolla Institutefor Cognitive Science. 
55. Kingma, D. P., & Ba, J. (2014). Adam: A method for stochastic optimization. arXiv preprint 
arXiv:1412.6980. 
56. Abadi, M., Agarwal, A., Barham, P., Brevdo, E., Chen, Z., Citro, C., Corrado, G. S., Davis, 
A., Dean, J., Devin, M., & Ghemawat, S. (2016). Tensorﬂow: Large-scale machine learning on 
heterogeneous distributed systems. arXiv preprint arXiv:1603.04467. 
57. Banerjee, S. (2022). Learning based intelligent imaging. PhD thesis, Northwestern University. 
58. Wirgin, A. (2004). The inverse crime. arXiv preprint math-ph/0401050.

High Energy Resolution X and Gamma 
Ray Imaging Spectroscopy with the 
ORION Multichip Readout Electronics 
Filippo Mele 
1 
Introduction 
The observation of the high energy transients coming from the deep space is a 
fundamental tool for the understanding of a multitude of astrophysical phenomena. 
Especially since 2017—when for the ﬁrst time the simultaneous detection of 
gravitational waves (GWs) and short gamma ray bursts (GRBs) generated by the 
same binary neutron star merger has been observed [1]—a new era of multi-
messenger astrophysics started: observing the sky with a wide ﬁeld of view and 
covering a large frequency range can be extremely useful to trigger the observation 
and accurate localization of GRBs, which, in turn, enable the search of GWs 
associated with these intense and wide-range electromagnetic emissions, from the 
radio spectrum up to gamma-rays [2]. Due to the absorption of X and gammaγ photons 
in the atmosphere, balloon-borne [3] and satellite instrumentation are required for 
such speciﬁc purpose. With the aim of realizing a comprehensive census of GRBs, 
with special focus on high red-shift GRBs, the THESEUS (Transient High Energy 
Sky and Early Universe Surveyor) space mission concept has been proposed for 
medium-class ESA (European Space Agency) calls [4]. Providing a substantial 
advancement in time-domain astronomy through detection, accurate location, multi-
wavelength (0.3 keV to 10 MeV) characterization, and red-shift measurement, of 
many classes of high-energy transients, THESEUS will have a unique capability 
to serve the scientiﬁc community in this sense, providing a powerful synergy with 
the ground observation stations and next generation large facilities for GWs and 
neutrino detectors [5]. The scientiﬁc payload of the THESEUS satellite will exploit 
the combination of three on-board instruments, covering the energy bands from the 
F. Mele () 
Dipartimento di Elettronica, Informazione e Bioingegneria, Politecnico di Milano, Milano, Italy 
e-mail: ﬁlippo.mele@polimi.it 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
C. Hansson, K. (Kris) Iniewski (eds.), X-ray Photon Processing Detectors, 
https://doi.org/10.1007/978-3-031-35241-6_5
95

96
F. Mele
near infrared up to gamma rays with an unprecedented monitoring capability on the 
GWs electromagnetic counterparts:
•
Infra-Red Telescope (IRT) [6]—the IRT is a 70 cm diameter class near-infrared 
telescope with tilde∼15 arcmin ﬁeld of view in the 0.7minus−1.8 normal muμm wavelength range. 
The IRT is designed to localize and study the GRB afterglows [7] detected either 
by the SXI or the XGIS instruments. The IRT can work both in imaging and in 
low-resolution spectroscopy mode.
•
Soft X-ray Imager (SXI) [8]—the SXI is a set of two “Lobster-Eye” X-ray 
telescope [9], for a total ﬁeld of view of 0.5 steradiant with a <2 arcmin source 
localization accuracy. The SXI covers the X-ray low energy range between 0.3 
and 5 keV and will be based on innovative large size X-ray CMOS detectors.
•
X-Gamma ray Imaging Spectrometer (XGIS) [10, 11]—the XGIS spectrometer, 
composed by two detection units, is based on both silicon drift detectors (SDDs) 
and Thallium activated CsI scintillation (CsI(Tl)) crystals, to cover the energy 
range between 2 keV and 10 MeV. The XGIS is the on-board instrument with the 
widest ﬁeld of view, and will be discussed in detail in the following section. 
The three instruments work simultaneously with overlapped ﬁelds of view. The 
initial trigger comes from the XGIS or SXI cameras; once the GRB is identiﬁed, 
the satellite will be able to point to the IRT target within tilde∼10 min, to capture the 
near-optical afterglows, with an on-board red-shift evaluation, and communicating 
the reﬁned GRB position to ground and space observatories for a larger follow-
up of the event. Among the scientiﬁc instruments of the THESEUS payload, the 
discussion of which is beyond the scope of this introduction, we shall now focus on 
the XGIS module. 
1.1 
The SISWICH Detector Concept 
The on-board XGIS is composed by two cameras, each one based on a large 
(tilde∼50times×50 cmsquared2) highly segmented detection plane of 6400 crystal scintillator bars 
(4.5times×4.5times×30 mmcubed3) optically coupled to 12,800 silicon detector pixels, realizing a 
wide ﬁeld deep sky monitor in the 2 keV to 10 MeV energy band [10]. The camera 
is realized in a modular approach, with the pixel structure shown in Fig. 1, which 
allows to mitigate the effects of a potential system failures at different hierarchy 
levels. The technology is based on the silicon-scintillator sandwich (SISWICH) 
concept [14], using a CsI(Tl) bar as scintillator crystal (4.5 mmtimes×4.5 mmtimes×30 mm) 
and two silicon sensors (5 mmtimes×5 mm) respectively at the top and at the bottom 
of the CsI(Tl) bar [15]. Each XGIS pixel operates in a combination of direct 
conversion for low energy X photons (2–30 keV), stopped by the silicon sensor 
facing the incoming radiation, and indirect conversion for the hard-X and gammaγ energy 
range (20 keV to 10 MeV), stopped inside the scintillator. Using this approach, the

High Energy Resolution X/Gamma Ray Imaging Spectroscopy with ORION
97
Fig. 1 In (a), the XGIS pixel structure, based one the SISWICH concept, composed by on CsI(Tl) 
bar and two SDDs. The incoming radiation entrance window is facing the top SDD, so that low-
energy photons (<20 keV) are absorbed by the SDD at the top interface. High-energy photons (up 
to 10 MeV) pass through the top SDD and are absorbed in the CsI(Tl) crystal, whose scintillation 
light illuminates both the SDDs [12]. In (b) the simulated detection efﬁciency of the SISWICH 
structure through SDD detection (red) and through CsI(Tl) light conversion (blue) [13] 
charge generated at the top silicon sensor can be thus collected and measured by the 
top readout electronics, and can be associated to a low-energy event. For energies 
above tilde∼30 keV, photons will most likely pass through the top silicon sensor and 
be absorbed in the CsI(Tl) crystal, whose scintillation light illuminates both the 
top and bottom silicon sensors, as shown in Fig. 1; subsequent reconstruction of the 
incident photon energy is then possible through appropriate processing of the charge 
generated in coincidence at the top and bottom SDDs. The usage of SDDs [16] for  
the implementation of the silicon sensors, guarantees a small anode capacitance 
(<100 fF) even for the relatively large 25 mmsquared2 active area required by the XGIS 
application, and allows to expect excellent spectroscopic resolution performances 
even at room temperature, or at moderate cooling. 
The optical coupling between the CsI(Tl) bar and the SDDs is done using soft 
transparent silicon pads, which provide minimal detection efﬁciency loss in the 
low-energy band and allow to control the mechanical compression on the XGIS 
structure. Thanks to a reﬂective wrapping of 0.15–0.2 mm thickness on each crystal, 
the scintillation light is conveyed and conﬁned only to the photo-readout sensors 
(SDDs) of the hit pixels. The total energy released by the photon into the crystal 
can be then calculated by conveniently summing the charge signals measured on 
the two SDDs. On the backside of the SDDs a 0.5 mm aluminum grid is realized 
with a dedicated production step of the SDD entrance window, and together with a 
separation frame among the silicone pads, helps to minimize the light bleed at the 
pixel interfaces.

98
F. Mele
Fig. 2 Exploded view of the 
XGIS 64-pixel module 
structure, based on the 
SISWICH architecture. The 
“bottom assembly” is a 
mirrored replica of the top 
assembly, composed by the 
soft silicone pads, the 
aluminum frame, the SDD 
matrix, the FE-PCB and the 
ORION-FE chips, assembled 
together 
1.2 
The X and γ Imaging Spectrometer (XGIS) Module 
XGIS pixels composed by one CsI(Tl) bar and two SDDs are grouped into modules 
of 8times×8 pixels, as shown schematically in Fig. 2. To maximize the active area on the 
XGIS module, SDDs are realized in 8times×8 monolithic matrices of 42.4times×42.4 mmsquared2
size, so that each XGIS module is based two SDD matrices (one for the top and one 
for the bottom ends of the scintillators). The pixel readout is performed using the 
ORION multichip application speciﬁc integrated circuit (ASIC), whose architecture 
will be discussed with more detail in the following sections, that is composed by 
a constellation of small area ORION-FE chips, placed in close proximity of the 
SDDs, and large multi-channel ORION-BE chips for the complete signal processing 
and digitization. The ORION-FE chips are placed on narrow PCB strips (3 mm 
width) sitting on top of both SDD matrices, called FE-PCB. Signals are routed 
using a rigid-ﬂex interconnections toward the bottom part of the XGIS module, 
where a BE-PCB hosts 8 ORION-BE. Groups of 2times×5 modules are assembled into 
super-modules and mounted over a super-module Back-End Electronics PCB (SM-
BEE) which provides the power supply for the ten modules, and hosts the FPGA 
for controlling the modules, collecting the data from the modules and interfacing 
the modules to the top-level XGIS Camera Back End Electronics (C-BEE). Tiling 
together 10 super-modules, the obtained detector assembly is a matrix of 10times×10 
closely arranged XGIS modules, which constitutes the XGIS detection plane. A 
coded mask (or coded aperture mask) and a collimator assembly are then mounted 
on top of the detector assembly, to constitute the entrance window of the incoming 
radiation measured by the detection plane. The structure of the coded mask has a

High Energy Resolution X/Gamma Ray Imaging Spectroscopy with ORION
99
proﬁle of 60times×60 cmsquared2 and is composed by a random mask of non-transparent square 
tiles of 10times×10 mmsquared2 size made of Tungsten. In practice, the coded mask serves 
the same purpose of the lenses in optical imaging systems, which are not suitable 
at the target energies of the XGIS unit; thanks to the non-uniform transparency 
of the aperture, the incoming wavefronts arriving to the detection plane will be 
unequivocally coded in intensity according to the incidence angle, allowing a 
reconstruction of the direction of arrival by a dedicated post-processing algorithm 
[17, 18]. The thickness of the coded mask (0.5 mm) makes the camera suitable for X 
and gammaγ imaging in the 1–150 keV energy range, which acts as a full-sky spectrometer 
for energies above tilde∼150 keV. The associated collimator is then used not only to give 
mechanical structure to the coded mask, but also to set the proper distance between 
the coded mask and the detection plane, which, in turn, deﬁnes the ﬁeld of view 
of the instrument and its spatial resolution. Inside the collimator structure, a thick 
layer of heavy material will provide a radiation shield to the detector assembly up 
to 150 keV, reducing the background radiation outside the desired ﬁeld of view. 
2 
The ORION Multichip Readout Electronics 
With respect to other popular solutions for spaceborne applications, based on 
compound semiconductor detectors with high stopping power, such as CdTe or 
CdZnTe detectors [19], the SISWICH hybrid detector arrangement allows the XGIS 
instrument to combine the excellent energy-resolving capability of SDDs for the 
soft X-ray energy range, with the high stopping power of CsI(Tl) crystals, in a 
modular approach capable of covering a large and highly segment detection plane 
of tilde∼50times×50 cmsquared2. However, this comes at the cost of a more complex readout 
electronics. In this section we will describe how the readout of the XGIS pixel is 
performed with the ORION multichip ASIC, which allows to conveniently readout 
and discriminate both low-energy and high-energy photons. Being the top SDD 
illuminated from both sides, and relatively large in size with respect to standard 
ASIC geometry and cost constraints, the 3D integration of the SDD with the readout 
ASIC—as generally done for silicon sensor matrices, and more recently proposed 
for bump-bonded SDD matrices as well [20, 21]—is not possible, and a solution 
which preserves the effective active area of the top interface of the detection plane 
is required. As typically happens for space-borne and battery operated systems, 
the ASIC has a very tight power budget (1.8 mW margins included) per XGIS 
pixel, which allows a the target power consumption on the detection plane for 
each XGIS camera of approximately 12.5 W. The necessity of the XGIS to detect 
and process with high resolution a wide energy range of incoming photons led to 
the implementation of a smart on-chip discrimination between X and gammaγ events, 
which are conveniently processed by two independent processors of the ORION 
ASIC, which will be described in the following. As already mentioned, the ORION 
ASIC, is organized in a multichip constellation, where small-area front-end chips

100
F. Mele
Fig. 3 Block-diagram of a single XGIS element readout circuit, composed by two ORION-FE (for 
the top and bottom SDD pixels) and one ORION-BE channel with separate X and gammaγ processors 
(ORION-FE) are placed in close proximity of the SDD anodes, to minimize the 
stray input capacitance and optimize the SDD noise performance, while large multi-
channel back-end chips (ORION-BE) are place on dedicated PCB in the detection 
module, outside of the XGIS detection plane. A schematic representation of the 
pixel readout strategy with the ORION readout electronics is shown in Fig. 3, and 
includes 2times×ORION-FE chips and 1times×ORION-BE channel. The charge generated 
by each pixel on the top SDD (in case of a low-energy X event) or by both top and 
bottom SDDs (in case of a normal gammaγ event) is processed independently by the ORION-
FEs. The ORION-FE provides the fundamental ampliﬁcation and processing to 
the charge signal, and integrates a charge sensitive ampliﬁer in continuous reset 
conﬁguration—required by timing applications as in the case of THESEUS—, a 
pole-zero compensation network, and a current conveyor, which is responsible for 
the ﬁrst CR shaping and for signal transmission to the ORION-BE. The signals 
are transmitted in current mode, in an approach already successfully tested on the 
LYRA chipset, on board the HERMES nano-satellites, which minimizes the inter-
pixel cross-talk, that represents a major concern in the XGIS module, due to the 
potential coupling with the highly-sensitive wire bondings toward the SDD anodes 
[22, 23]. The current outputs of the ORION-FE top and bottom channels of the 
same XGIS pixel are delivered to two current receivers in the ORION-BE channel, 
positioned up to tilde∼5 cm away from the respective FE. Internally, the ORION-BE 
includes an X-processor, which takes only the signal coming from the top FE, and 
a gammaγ -processor, which elaborates the signals coming from both the top and bottom 
channels, providing, for each of the two possible events the more appropriate signal 
ﬁltering. Provided the ORION architecture, the internal power budget is thus further 
split into 300 normal muμm for each ORION-FE (in a number of two for each pixel) and 
1.2 mW for each ORION-BE channel.

High Energy Resolution X/Gamma Ray Imaging Spectroscopy with ORION
101
2.1 
The X-Processor 
Photons with energies between 2 and 20 keV are typically stopped inside the top 
SDD, and do not reach the CsI(Tl) crystal. These hits are referred as X-ray events 
in the ORION architecture. In this case the signal is readout exclusively by the 
ORION-FE, composed in the ﬁrst stage by a low-noise charge sensitive ampliﬁer 
(CSA). The CSA implements a folded cascode architecture with a dedicated supply 
for the input PMOS device, which allows a better 1/f noise performance with 
respect the NMOS device [24]. The CSA also includes an auxiliary input pad for 
external test-charge injection through an integrated calibration capacitance, which 
can be digitally disconnected by means of a test-enable bit during in-application 
operation. Given an end-of-life maximum SDD anode current of approximately 
500 pA, the continuous reset network is constituted by an active device, followed by 
a matched pole-zero compensation network [25]. Then, a shaping current conveyor 
[26] provides a replica DC operating point to the pole-zero network, and sets 
the time constant of the ﬁrst CR shaping to 1 normal muμs. The top ORION-FE cannot 
discriminate a priori  if an event has arrived on the bottom-SDD, so its input charge 
range must be designed to process both X and gammaγ ray events. Since the XGIS 
instrument is supposed to detect gammaγ photons up to 10 MeV, but the probability of 
having the whole photon energy deposition in a single CsI(Tl) crystal is extremely 
low, the expected maximum energy range of a single XGIS pixel is of 7.2 MeV. 
Assuming an equal partition between the charge collected at the top and at the 
bottom SDDs, and an average coefﬁcient of photon energy to charge conversion 
of 25 el./keV [27] the maximum input charge range for the CSA is conveniently set 
to 90,000 electrons (14.4 fC). The output of the ORION-FE is then transmitted in 
current mode, through the FE-PCB and the rigid-ﬂex connectors to the BE-PCB, and 
routed to the corresponding top ORION-BE current receiver based on the schematic 
presented on the LYRA ASIC [23]. This low-input impedance current receiver has 
a two current outputs with different gain settings: a high-gain output, routed to 
the X-processor, and a low-gain output, routed to the gammaγ -processor, which will be 
described in the following section. The X-processor is optimized to process signals 
up to 20 keV directly converted in the SDD, corresponding to an input charge of 
asymptotically equals≃10,000 electrons. The current receiver is followed by a RC current-mode ﬁlter 
based on the R-lens block [28] with 1 normal muμs time constant that, in combination with the 
CR ﬁltering stage in the ORION-FE realizes a ﬁrst-order semi-gaussian shaper. The 
obtained 1 normal muμs peaking time is chosen to effectively collect signals from the SDD, 
with an expected rise-time in the order of few tens of nanoseconds, avoiding gain 
loss due to ballistic deﬁcit. 
An externally tunable baseline holder [29] is used to set the desired DC level, 
providing a stable output baseline level, regardless from the frequency of incoming 
photons. The shaped signal is compared by an amplitude discriminator with an 
X-threshold, programmable at both global and pixel level, which automatically 
subtracts the DC level set by the baseline holder circuit. When the amplitude 
discriminator detects a signal above threshold, the integrated peak detect and

102
F. Mele
hold (PDH) [30] is enabled, which automatically holds the peak-value of the 
shaped waveform, to allow sufﬁcient time for the low-power analog-to-digital 
converter (ADC) sampling. When the peak-value is reached, the PDH input signal 
is disconnected, to reduce the probability pile-up of incoming events, and the pixel 
logic is notiﬁed that a value is ready for the ADC sampling. The photon is assigned 
a unique time-stamp, synchronized with the satellite time, based on the peak-detect 
signal, reducing the jitter contribution caused by the amplitude discriminator time 
walk. The stretched output voltage is then over-sampled by a second order 12 
effective number of bits (ENOB) incremental analog to digital converter [31, 32]. 
With a programmable oversampling rate (128, 256 and 512 samples), and a clock 
frequency of 10 MHz, the expected conversion time is between 12.8 and 51.2 normal muμs. 
When the acquisition at the back-end is completed, the central logic sends an End Of 
Conversion (EOC) ﬂag, to properly reset the analog processor for a new acquisition. 
2.2 
The γ -Processor 
At the same time, the signal from the top current receiver is processed also by the 
gammaγ -processor, with a lower gain required to process the full input charge range of 
90,000 electrons. In this case, the gammaγ -shaper realizes a third order semi-gaussian 
shaping with 3 normal muμs peaking time, which is more suitable for the long scintillation 
time-constants of CsI(Tl) bars, in the order of few normal muμs.1 In case of a high-energy 
event, the top and bottom SDDs are expected to be illuminated simultaneously by 
the CsI(Tl) scintillation light. In this case, the bottom ORION-FE will collect, pre-
shape and sent to the bottom ORION-BE current receiver2 a corresponding signal. 
This second signal is processed by an independent bottom gammaγ -shaper. The outputs 
on the top and bottom channels in the gammaγ -processor, are summed in current mode to 
be compared by the gammaγ amplitude discriminator, allowing a reduction of the noise 
threshold by a factor of StartRoot 2 EndRoot
√
2 with respect to the case of two different thresholds 
set for the separated top and bottom channels. The gammaγ amplitude discriminator has 
its own and independently programmable threshold with respect to the X amplitude 
discriminator. Two independent PDH and ADCs are then used to digitize the outputs 
of the gammaγ shapers, which are eventually summed in the digital domain for a more 
ﬂexible post-processing reconstruction, until an end-of-conversion signal is sent 
back to reset the analog BE.
1 Using a third order semi-gaussian shaper allows to the X and gammaγ processors to share the same 1 normal muμs 
time constant in the ORION-FE, which can conveniently be used for both processing chains. 
2 The current receiver of the bottom channel has only a single low-gain output, because no X-ray 
event is expected at the bottom interface of the XGIS pixel. 

High Energy Resolution X/Gamma Ray Imaging Spectroscopy with ORION
103
2.3 
Pixel Logic and Output Data Word Structure 
Based on the comparison between the X and gammaγ amplitude discriminators outputs, 
the incoming event is either reconstructed as an X-event, discarding the gammaγ -processor 
data, or a gammaγ -event, disregarding the X-processor data. The output digital data word 
is thus produced, including 1-bit for the event type information (X or gammaγ ), 24-bits 
for the time stamping, with 100 ns timing resolution, 32-bits for the amplitude 
information (16-bit for each processing channel) and 3-bits for address information 
in the multichannel ORION-BE chip. Since in the end applications several addresses 
are expected to trigger at the same time, and since the expected input count-rate 
for each pixel is expected to be below 100 counts per second (cps), the ORION-
BE pixel logic can wait a programmable time (rise time protection) after the event 
trigger before starting the ADC conversion, in order to give sufﬁcient time to other 
channels to settle to a stable value [13]. 
3 
Experimental Results on the ORION Readout Electronics 
Using a CMOS 0.35 normal muμm technology by AMS, with consolidated results in low-noise 
ASICs for high energy resolution spectroscopy [33] and space-borne applications 
[34, 35], a few prototypes of the ORION ASIC have been produced and charac-
terized. A dual-channel ORION-FE was designed in a back-to-back conﬁguration, 
meaning that, on the ﬁnal XGIS module FE-PCB the chip will readout the charge 
of SDD pixels placed on both sides of the narrow PCB ribs, halving the PCB 
obscuration for low-energy photons. The ORION-BE was designed as a stand-
alone analog prototype, which includes all pre-ADC circuitry of both X and gammaγ
processors and the pixel-level discrimination and trigger logic. The performances 
and functionalities of the ORION ASIC coupled to a multi-anode 2times×2 silicon 
drift detector matrix, with squared pixels of tilde∼25 mmsquared2 each, have been tested and 
extensively characterized using a dedicated board designed by INAF-IASF (Milan), 
shown in Fig. 4, which doesn’t include the possibility of testing the system with the 
CsI(Tl) scintillation crystal. In the board, the ORION-FEs and the ORION-BE have 
been routed emulating the typical distance expected on the XGIS module, with the 
possibility to select different interconnection loads using inductive and capacitive 
tanks between the two chips. The silicon drift detectors used in the presented 
characterization, designed and manufactured by Fondazione Bruno Kessler (FBK) 
in collaboration with the Italian National Institute of Nuclear Physics (INFN-Ts), 
showed anode currents of tilde∼25 pA at room temperature. 
3.1 
Spectroscopic Resolution 
The spectroscopic resolution on the proposed SDD-ORION prototype was tested 
using Superscript 241241Am and Superscript 5555Fe calibration sources to acquire different energy spectra

104
F. Mele
Fig. 4 Test-board used for the ORION-ASIC experimental measurements [12]. The board 
includes two ORION-FE, one ORION-BE and one multi-element SDD with 4 pixels of 25 mmsquared2
each, designed by INFN and produced by Fondazione Bruno Kessler (FBK) 
across the expected operating temperature range (+30 °/minus−20 °C). In absence of 
the integrated ADC, the spectra have been acquired using the ORION-BE shaped 
signals, and sampling the output waveform with a commercial Multi-Channel 
Analyzer (Amptek MCA-8000D). The spectrum on the X-processor, acquired at 
minus−20 °C with an input count-rate of tilde∼2.5 kcps is reported in Fig. 5. In the picture, 
the characteristic Np-L lines of the Superscript 241241Am can be easily resolved and the Mn-K 
lines of the Superscript 5555Fe source, even if partially overlapped, are clearly distinguishable 
above the system noise threshold, which is reported slightly above 300 eV. The 
energy resolution, as measured on pulser, is 250 eV FWHM, corresponding to 
an equivalent noise charge (ENC) of 28.7 electrons rms, which increases to 
341.2 eV (39.4.7 electrons r.m.s.), when the system is thermalized at the nominal 
operating temperature of +10 °C). Removing the Superscript 241241Am, the input count-rate drops 
signiﬁcantly closer to the end application (tilde∼100 cps) allowing the acquired Superscript 5555Fe 
spectrum to increase the peak-to-background from 15bold nabla bold dot∇·1 to 300bold nabla bold dot∇·1, and obtaining 
a FWHM on the 5.9 keV of 249 eV, and 212 eV FWHM (24.3 electrons r.m.s.) on 
the test pulser [36]. 
On the gammaγ -processor results showed an equivalent noise charge on the test-pulse 
of 39.6 el. r.m.s. (corresponding to 3.7 keV FWHM on CsI(Tl)) at minus−20 °C, increased 
to 43.6 el. r.m.s. (4.1 keV FWHM on CsI(Tl)) for the nominal operating temperature 
of the XGIS module (+10 °C).

High Energy Resolution X/Gamma Ray Imaging Spectroscopy with ORION
105
Fig. 5 Detail of the 
low-energy spectrum of a 
Superscript 241241Am and Superscript 5555Fe radioactive 
sources, acquired sampling 
the output waveform of the 
ORION X-processor with a 
commercial multi-channel 
analyzer by Amptek 
3.2 
Dynamic Range and Linearity Performance 
Using the Superscript 241241Am and Superscript 5555Fe calibration sources with an external test-pulse to inject 
a ﬁxed charge at the CSA input, the linearity and full-scale range of the complete 
analog processing chain in the operative energy range has been measured, showing 
for the X-processor a linearity error below ±1% over the 6–26 keV energy range 
and below ±1.5% for the gammaγ -processor over an input charge range of 10Superscript 55 el.— 
corresponding to a maximum energy of tilde∼4.1 MeV, for the single gammaγ -top and 
gammaγ -bottom channels, and 8.2 MeV for the complete gammaγ -processor. 
By looking at the ORION-BE peak-stretcher output it is possible to also 
evaluate the minimum signal that can be effectively detected and stretched by the 
integrated amplitude discriminator and peak-detect and hold circuit. In this mode, 
the ﬁne characterization of the trigger threshold level can be performed using a 
precision pulser and digital counter as follows: a test charge on the ORION-FE is 
injected with a known frequency, and the count-ratio between the pulser input test 
signals and the ORION-BE output trigger signals is computed. As the input pulse 
amplitude decreases, the trigger ratio lowers in percentage, eventually approaching 
0% when the is signal is sufﬁciently below the threshold level. At the nominal 
operating temperature of +10 °C, the measured energy threshold of the internal 
pulse-amplitude discriminator, deﬁned for a trigger-count ratio of 50%, is 563 eV, 
for X-ray events with signal rise time of 100 ns,3 and 42 keV for gammaγ -ray events with 
signal rise time of 1 normal muμs. For a trigger-count ratio of 20%, the threshold values on the 
X and gammaγ discriminators are 473 eV and 39.1 keV respectively. The threshold value 
on the gammaγ processor is of particular interest, because it deﬁnes the energy gap between
3 Since the trigger-count ratio is inﬂuenced by the rise time and shape of the input signal, is critical 
to deﬁne an input test waveform representative of the ﬁnal application. 

106
F. Mele
Fig. 6 Gain and offset variation of the ORION X and gammaγ processors over the expected temperature 
range of the XGIS instrument. Courtesy of Irisa Dedolli (Politecnico di Milano) 
the SDD and the CsI(Tl) operation of the SISWICH pixel as shown in Fig. 1b, which 
allows an accurate and continuous reconstruction of the acquired spectra over almost 
4 decades of dynamic range. 
3.3 
Gain Stability over Temperature Variations 
Spaceborne instrumentation is often exposed to wide temperature variations accord-
ing to its position with respect to the Sun. Thermal analysis on the XGIS instrument, 
which is stabilized using a cold ﬁnger ﬂange [10], showed an expected temper-
ature variation on the from minus−20 °C to +30 °C, including design margins. Precise 
evaluation of the conversion gain variation of the readout electronics across the 
temperature range is crucial to allow a correct reconstruction of the incoming photon 
energies. 
Measurements on the X-processor were done acquiring the energy spectrum 
using Superscript 241241Am and Superscript 5555Fe as calibration sources and considering the KSubscript alphaα= 5.9 keV  
and NpLSubscript alphaα= 13.9 keV photon energies for the calculation of the energy conversion 
gain. For the gammaγ -processor the 26.3 and 59.5 keV lines of the Superscript 241241Am source have 
been used. The results across the operating temperature range are shown in the 
left plots of Fig. 6 for the X-processor and gammaγ -processor, reporting an average gain 
of 82.3 normal muμV/el. plus or minus±0.1% and 7.97 normal muμV/el. plus or minus±0.5% respectively. On the right plots of 
Fig. 6, the corresponding variation of the offset level is reported associated with 
a baseline shift in the zero-energy analog-to-digital unit (ADU) value. Results 
are compensated with respect to the electron-hole pair generation energy, whose 
sensitivity to temperature variation is reported in the scientiﬁc literature [37]. 
Acknowledgments This work was carried out within the ReDSoX collaboration of INFN and 
THESEUS collaborations of ASI-INAF through ASI-INAF agreement n. 2018-29-HH.0. The

High Energy Resolution X/Gamma Ray Imaging Spectroscopy with ORION
107
contribution of universities and research institutes taking part in the collaboration is acknowledged: 
Politecnico di Milano, University of Pavia, University of Trieste, University of Udine, University 
of Bologna, University of Ferrara, Fondazione Bruno Kessler (FBK), Italian Space Agency (ASI), 
Italian National Institute of Astrophysics (INAF and IASF) and Trento Institute for Fundamental 
Physics and Applications (TIFPA). The author gratefully acknowledges the contribution of Irisa 
Dedolli from Politecnico di Milano for the experimental characterization. 
References 
1. Abbott, B. P., Abbott, R., Abbott, T. D., Acernese, F., Ackley, K., Adams, C., Adams, T., 
Addesso, P., Adhikari, R. X., Adya, V. B., et al. (2017). The Astrophysical Journal Letters, 
848(2), L13. https://doi.org/10.3847/2041-8213/aa920c 
2. Abbott, B., Abbott, R., Adhikari, R., Ageev, A., Allen, B., Amin, R., Anderson, S., Anderson, 
W., Araya, M., Armandula, H., et al. (2005). Physical Review D, 72(4), 042002 (2005). https:// 
doi.org/10.1103/PhysRevD.72.042002 
3. Ventura, G., Horstman, H., Brighenti, A., Cavani, C., Camprini, M., Cazzola, P., Giovannini, 
G., Labanti, C., & Poulsen, J. M. (1984). Nuclear Instruments and Methods in Physics 
Research Section A: Accelerators, Spectrometers, Detectors and Associated Equipment, 
226(2–3), 524 . https://doi.org/10.1016/0168-9002(84)90075-5 
4. Amati, L., O’Brien, P., Götz, D., Bozzo, E., Tenzer, C., Frontera, F., Ghirlanda, G., Labanti, 
C., Osborne, J. P., Stratta, G., et al. (2018). Advances in Space Research, 62(1), 191 (2018). 
https://doi.org/10.1016/j.asr.2018.03.010 
5. Amati, L., O’Brien, P., Götz, D., Bozzo, E., Santangelo, A., Tanvir, N., Frontera, F., Mereghetti, 
S., Osborne, J., Blain, A., et al. (2021). Experimental Astronomy, 52(3), 183. https://doi.org/ 
10.1007/s10686-021-09807-8 
6. Rossi, A., Stratta, G., Maiorano, E., Amati, L., Nicastro, L., & Palazzi, E. (2018). arXiv preprint 
arXiv:1802.01688. https://doi.org/10.48550/arXiv.1802.01688 
7. Mészáros, P., & Rees, M. J. (1997). The Astrophysical Journal, 476(1), 232. https://doi.org/10. 
1086/303625 
8. O’Brien, P., Bozzo, E., Willingale, R., Hutchinson, I., Osborne, J., Amati, L., & Götz, D. 
(2018). arXiv preprint arXiv:1802.01675. https://doi.org/10.48550/arXiv.1802.01675 
9. Angel, J. R. P. (1979). Space Optics Imaging X-Ray Optics Workshop (Vol. 184, pp. 84–85). 
International Society for Optics and Photonics. https://doi.org/10.1117/12.957437 
10. Labanti, C., Amati, L., Frontera, F., Mereghetti, S., Gasent-Blesa, J. L., Tenzer, C., Orleanski, 
P., Kuvvetli, I., Campana, R., Fuschino, F., et al. (2020). Space Telescopes and Instrumentation 
2020: Ultraviolet to Gamma Ray (Vol. 11444, pp. 395–413). SPIE. https://doi.org/10.1117/12. 
2561012 
11. Amati, L., Labanti, C., Mereghetti, S., Frontera, F., Campana, R., Auricchio, N., Baldazzi, G., 
Bellutti, P., Bertuccio, G., Branchesi, M., et al. (2022). Space Telescopes and Instrumentation 
2022: Ultraviolet to Gamma Ray (Vol. 12181, pp. 551–563). SPIE. https://doi.org/10.1117/12. 
2630178 
12. Mele, F. (2022). Special Topics in Information Technology (pp. 31–42). Cham: Springer. 
https://doi.org/10.1007/978-3-030-85918-3_3 
13. Fuschino, F., Campana, R., Labanti, C., Amati, L., Virgilli, E., Terenzi, L., Bellutti, P., 
Bertuccio, G., Borghi, G., Ficorella, F., et al. (2020). Space Telescopes and Instrumentation 
2020: Ultraviolet to Gamma Ray (Vol. 11444, pp. 1263–1276). SPIE. https://doi.org/10.1117/ 
12.2561002 
14. Friese, J., Gillitzer, A., Korner, H., Reinhold, J., Peter, M., & Maier, M. (1993). IEEE 
Transactions on Nuclear Science, 40(4), 443. https://doi.org/10.1109/NSSMIC.1992.301188

108
F. Mele
15. Marisaldi, M., Labanti, C., & Soltau, H. (2004). IEEE Transactions on Nuclear Science, 51(4), 
1916. https://doi.org/10.1109/TNS.2004.832679 
16. Gatti, E., & Rehak, P. (1984). Nuclear Instruments and Methods in Physics Research, 225(3), 
608. https://doi.org/10.1016/0167-5087(84)90113-3 
17. Skinner, G. K. (1984). Nuclear Instruments and Methods in Physics Research, 221(1), 33. 
https://doi.org/10.1016/0167-5087(84)90174-1 
18. Skinner, G. K. (1988). Scientiﬁc American, 259(2), 84. 
19. Ubertini, P., Lebrun, F., Di Cocco, G., Bazzano, A., Bird, A., Broenstad, K.e., Goldwurm, A., 
La Rosa, G., Labanti, C., Laurent, P., et al. (2003). Astronomy & Astrophysics, 411(1), L131. 
https://doi.org/10.1051/0004-6361:20031224 
20. Gandola, M., Grassi, M., Mele, F., Dedolli, I., Malcovati, P., & Bertuccio, G. (2022). 
Nuclear Instruments and Methods in Physics Research Section A: Accelerators, Spectrometers, 
Detectors and Associated Equipment, 1040, 167249. 
https://doi.org/10.1016/j.nima.2022. 
167249 
21. Haﬁzh, I., Carminati, M., & Fiorini, C. (2020). 2020 IEEE Nuclear Science Symposium 
and Medical Imaging Conference (NSS/MIC) (pp. 1–3). IEEE. https://doi.org/10.1109/NSS/ 
MIC42677.2020.9508100 
22. Gandola, M., Grassi, M., Mele, F., Malcovati, P., & Bertuccio, G. (2019). 2019 IEEE Nuclear 
Science Symposium and Medical Imaging Conference (NSS/MIC) (pp. 1–3). IEEE. https://doi. 
org/10.1109/NSS/MIC42101.2019.9059616 
23. Gandola, M., Mele, F., Grassi, M., Malcovati, P., & Bertuccio, G. (2021). Journal of 
Instrumentation, 16(12), T12013. https://doi.org/10.1088/1748-0221/16/12/T12013 
24. Rivetti, A. (2018). CMOS: Front-End Electronics for Radiation Sensors. CRC Press. https:// 
doi.org/10.1201/b18599 
25. De Geronimo, G., & O’Connor, P. (1999). Nuclear Instruments and Methods in Physics 
Research Section A: Accelerators, Spectrometers, Detectors and Associated Equipment, 
421(1–2), 322. https://doi.org/10.1016/S0168-9002(98)01218-2 
26. Sampietro, M., & Bertuccio, G. (1998). Electronics Letters, 34(19), 1801. https://doi.org/10. 
1049/el:19981293 
27. Marisaldi, M., Labanti, C., Soltau, H., Fiorini, C., Longoni, A., & Perotti, F. (2005). IEEE 
Transactions on Nuclear Science, 52(5), 1842. https://doi.org/10.1109/TNS.2005.856615 
28. Bertuccio, G., Gallina, P., & Sampietro, M. (1999). Electronics Letters, 35(15), 1209. https:// 
doi.org/10.1049/el:19990842 
29. De Geronimo, G., O’Connor, P., & Grosholz, J. (1999). 1999 IEEE Nuclear Science Sympo-
sium. Conference Record. 1999 Nuclear Science Symposium and Medical Imaging Conference 
(Cat. No. 99CH37019) (Vol. 1, pp. 370–374). IEEE. https://doi.org/10.1109/NSSMIC.1999. 
842511 
30. Mele, F., Dedolli, I., & Bertuccio, G. (2022). IEEE Solid-State Circuits Letters, 5, 74. https:// 
doi.org/10.1109/LSSC.2022.3162496 
31. Grassi, M., & Malcovati, P. (2023). AISEM Annual Conference on Sensors and Microsystems 
(pp. 356–362). Springer. https://doi.org/10.1007/978-3-031-08136-1_54 
32. Grassi, M., Gemelli, A., Malcovati, P., Mele, F., Dedolli, I., Gandola, M., Bertuccio, G., March-
esini, E., Virgilli, E., Campana, R., et al. (2022). 2022 IEEE International Instrumentation 
and Measurement Technology Conference (I2MTC) (pp. 1–6). IEEE. https://doi.org/10.1109/ 
I2MTC48687.2022.9806486 
33. Mele, F., Gandola, M., & Bertuccio, G. (2021). IEEE Transactions on Nuclear Science, 68(3), 
379. https://doi.org/10.1109/TNS.2021.3055934 
34. Ceraudo, F., Dedolli, I., Cirrincione, D., Del Monte, E., Mele, F., Ambrosino, F., Bellutti, P., 
Bertuccio, G., Borghi, G., Campana, R., et al. (2022). Nuclear Instruments and Methods in 
Physics Research Section A: Accelerators, Spectrometers, Detectors and Associated Equip-
ment, 166903 . https://doi.org/10.1016/j.nima.2022.166903 
35. Gandola, M., Grassi, M., Mele, F., Bertuccio, G., & Malcovati, P. (2019). 2019 26th IEEE 
International Conference on Electronics, Circuits and Systems (ICECS) (pp. 346–349). IEEE.

High Energy Resolution X/Gamma Ray Imaging Spectroscopy with ORION
109
36. Mele, F., Dedolli, I., Gandola, M., Grassi, M., Malcovati, P., Amati, L., Bellutti, P., Borghi, 
G., Campana, R., Demenev, E., et al. (2021). IEEE Transactions on Nuclear Science, 68(12), 
2801. https://doi.org/10.1109/TNS.2021.3130184 
37. Pehl, R. H., Goulding, F. S., Landis, D. A., & Lenzlinger, M. (1968). Nuclear Instruments and 
Methods, 59(1), 45. https://doi.org/10.1016/0029-554X(68)90342-X

MIRA: A Low-Noise Pixelated ASIC for 
Photon Counting Applications 
Edoardo Fabbrica, Marco Carminati, and Carlo Fiorini 
1 
MIRA: The MIcrochannel Plate Readout ASIC 
Considering the future long-term space mission programs, many scientiﬁc targets 
will require a payload that includes an UV imager spectrograph. For instance, 
future missions on gas or ice giant planets will require imaging spectroscopy for 
a comprehensive study of the aurora footprints and polar magnetosphere as well as 
the characteristics of the upper atmosphere or exosphere of their satellites (Europa, 
Titan, Triton,ellipsis. . .) [1, 2]. On the other hand, future missions on the inner planets will 
also resort to imaging spectroscopy for the exosphere or ionosphere science [3]. 
Within this context, a novel dual-channel FUV/EUV imaging spectrometer working 
in the 55–200 nm spectral range will be developed in the PLUS (PLanetary Ultravi-
olet Spectrometer) project with the goal of improving both the optics efﬁciency 
and dynamic range. Splitting the spectral range into two distinct channels, one 
functioning in the extreme ultraviolet (EUV, lamda almost equalsλ ≈55–120 nm) and the other in the 
far ultraviolet (FUV, lamda almost equalsλ ≈115–200 nm), would provide a signiﬁcant improvement 
with respect to conventional solutions. The FUV channel can be easily extendable 
up to 350 nm [4]. The instrument will adopt a novel hybrid pixel detector to count 
the incoming radiation events. For this purpose, the low-noise readout integrated 
circuit MIcrochannel plate Readout ASIC (MIRA) with on-chip photon-counting 
capability has been designed to be coupled with a Chevron microchannel plate 
(MCP). A ﬁrst prototype of the photon counting, solar-blind UV detector for the 
PLUS project has been realized, having high-performance characteristics, such as 
spatial resolution close to 35 normal muμm, longer lifetime, and unprecedented performance 
in terms of dynamic range (count rate > 100 kcps/pixel). It allows to measure, 
E. Fabbrica () · M. Carminati · C. Fiorini 
Dipartimento di Elettronica, Informazione e Bioingegneria (DEIB), Politecnico di Milano, 
Milano, Italy 
e-mail: edoardo.fabbrica@polimi.it; carlo.ﬁorini@polimi.it 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
C. Hansson, K. (Kris) Iniewski (eds.), X-ray Photon Processing Detectors, 
https://doi.org/10.1007/978-3-031-35241-6_6
111

112
E. Fabbrica et al.
MCP 
Photocathode 
MIRA 
UV-ray 
H = 21 cm  
Detector Slot 
2 mm  
Ø = 13 cm  
2 mm  
Fig. 1 Illustration of the photon-counting unit designed for the PLUS UV spectrometer. The low-
noise readout integrated circuit MIcrochannel plate Readout ASIC (MIRA) with on-chip photon-
counting capability is coupled with a Chevron microchannel plate (MCP) 
simultaneously and without the necessity of ﬁlters, spectral lines with different 
intensities of orders of magnitude, exploiting the maximum Signal to Noise Ratio 
provided by the statistical limit. Figure 1 shows the photon-counting unit designed 
for the PLUS spectrometer highlighting the working principle of the PLUS hybrid 
pixel detector. Each impinging UV photon is converted into a photoelectron through 
the photocathode. The photoelectron entering the microchannel plate is gained of 
a factor G, proportional to the voltage applied across the MCP. The electric ﬁeld 
between the end surface of the MCP and the MIRA ASIC forces the generated 
charges cloud to impinge the ROIC and to be collected and processed by the latter. 
Thus, the main operation of MIRA is to detect, count, and specify the position of 
the incoming photons [5]. 
2 
The MIRA Pixel 
The MIRA ASIC implements an architecture aimed at converting the charge cloud, 
exiting the MCP, to an electronic signal, discriminating the true signal from noise, 
counting the number of hits, and eliminating the spectral distortion produced by the 
charge sharing process. The chip is developed in TSMC 65 nm CMOS technology, 
and the ﬁrst prototype features a matrix of 32times×32 pixels. Each pixel occupies an area

MIRA: A Low-Noise Pixelated ASIC for Photon Counting Applications
113
of 35times×35 normal muμm2 with an integrated anode of 20times×20 normal muμm2, limited by technological 
design constraints. The main challenge was designing both Analog and Digital 
blocks so that all of them ﬁt in such small pixel. 
As the pixel size decreases, the charge sharing effect increases. Indeed, the charge 
sharing effect occurs when the total charge exiting the MCP is not entirely collected 
by a single pixel, but it is also shared among neighboring ones. It may result in a loss 
of detection efﬁciency due to errors such as missing some of the events and counting 
extra events. In the MIRA architecture, the charge information is reconstructed by 
grouping pixels into clusters of four, summing the charge collected in each cluster, 
and associating the event to the pixel with the largest charge deposition. 
MIRA pixel architecture is divided into two parts: Analog and Digital. Figure 2a 
shows the pixel matrix and the Analog and Digital blocks in the pixel. The pixel 
readout chain is shown in Fig. 2b. 
35 μm 
35 μm 
CSA 
20 μm 
ANODE 
Cap. 
Filter 
Discrim. 
DAC 
PCR 
Counters 
CSCL 
(a) 
C#1 
C#2 
Readout 
Filter Discriminator
Counters 
Charge Sharing 
Correction Logic 
Charge Sensitive 
Amplifier (CSA) 
Req 
CF 
VTH 
from adjacent pixels 
(b) 
Fig. 2 (a) A microscope view of the 32times×32 pixels matrix and their anodes. The MIRA pixel has 
a compact size of 35normal muμm and an anode size of 20normal muμm. (b) The pixel readout chain of MIRA ASIC

114
E. Fabbrica et al.
The Analog side of the pixels is constituted by: 
• 
CSA 
• 
Filter Stage 
• 
Current Discriminator 
The charge collected from the anode pad of a pixel is integrated by a Charge 
Sensitive Ampliﬁer (CSA) on a feedback capacitance. According to the limitation in 
the area, both charge collection and noise ﬁltering are integrated into the CSA. After 
the charge is integrated, the CSA generates a signal with an amplitude proportional 
to the amount of charge hitting the input pad. The signal is transferred toward 
four summing nodes located at each pixel corner. As the CSA generates signals 
in voltage, the Filter stage circuitry converts them into current and then sums them. 
Once the signal has reached the summing node, it receives further ﬁltering, and it is 
compared with a threshold that should discriminate the signal from the noise level. 
The discrimination process is done by comparing the current signal by its own DC 
level, which is extracted thanks to a baseline holder. In this way, the threshold level 
can be adjusted thanks to a 4-bit Digital-to-Analog Converter (DAC) whose job is 
to sum a DC current to the signal baseline; in other words, the DAC is used for 
modifying and setting the threshold level of the discriminator. 
The Digital side of the pixels is constituted by: 
• 
Charge Sharing Correction Logic (CSCL) 
• 
Two 17-bit Counters 
• 
Pixel Conﬁguration Register (PCR) 
Once the discriminator signal is ﬁred, it produces a pulse signal that has the width 
proportional to the amount of charge present in the summing node. The pulse, then, 
will go into the charge sharing correction logic circuitry, whose job is to decide to 
which pixel assign the event. The hit assignment decision is made by comparing the 
pulse signal coming from the internal discriminator with the pulse signals coming 
from the neighboring pixel discriminators. Once the charge sharing correction logic 
circuit has decided to which pixel allocate the event, a pulse is forwarded toward 
one of the two counters. Each pixel contains two 17-bit counters that allow to have a 
zero dead-time. It means that while one of the two can count the events, the other is 
read out by the periphery. The drawback is the area occupied by the counters that is 
almost 75% of the digital area, allowing only a small portion for the implementation 
of the charge sharing correction logic and the Pixel Conﬁguration Registers (PCR) 
that are needed for the DAC bits selection and other useful conﬁguration signals. 
All the digital circuits have been implemented with a semi-custom approach using 
standard cell libraries. This has allowed to reduce the time needed to design the 
digital part at the cost of a bit more area occupation.

MIRA: A Low-Noise Pixelated ASIC for Photon Counting Applications
115
2.1 
The MIRA CSA 
As the dedicated area to the analog part in each pixel is relatively small, design 
decisions on the ampliﬁer architecture have been made considering the required 
area for the implementation. In this regard, the charge sensitive ampliﬁer (CSA) 
should be the optimum one in terms of Equivalent Noise Charge (ENC) and active 
area occupation. Hence, the CSA shaping time (normal tau Subscript normal sτs) has been chosen both for 
signal ampliﬁcation and for noise ﬁltering. The time constant of the stage (normal tau Subscript normal upper FτF) has 
been selected in a way that gives the desired noise level and avoids the pile-up 
effect. The MIRA CSA is created by combining the folded cascode ampliﬁer, the 
cascode buffer, and the ICON cell [6]. Figure 3 shows the detailed architecture of the 
CSA. The folded cascode ampliﬁer provides both a large gain-bandwidth product 
(GBWP) and a low white, and 1/f voltage noises. The ICON cell creates a large 
feedback resistance starting from the physical resistor in the cascode buffer, and 
provides low current white noise. The operation principle of the stage is mainly 
divided into the charge path and the discharge path. When a cloud of electrons hits 
the anode, a current signal is generated, and the feedback capacitance CSubscript normal upper FF is charged, 
exploiting the internal loop of the stage. Then, the loop composed of the ICON cell, 
i.e., the discharge path, comes into play, discharging the feedback capacitance. The 
time constant of the discharge is proportional to the ICON cell mirroring factor 
K and the resistor RSubscript 11 implemented in the cascode buffer by the transistor MSubscript normal upper R Baseline 1R1. 
The green and red arrows in Fig. 3 illustrate the charge and discharge phases of the 
capacitor CSubscript normal upper FF, respectively. The possibility to exploit a faster time constant is given 
by adding two equal selectable resistances RSubscript 11 in parallel in the cascode buffer. Thus, 
the MIRA CSA can be operated in slow or fast mode. When the switch is activated 
(fast mode), the value of the total resistance, and thus the time constant, is halved 
with respect to the slow mode. The transfer function of the input current (ISubscript i nin) to the  
output voltage node (VSubscript o u tout) is:  
StartFraction upper V Subscript o u t Baseline Over upper I Subscript i n Baseline EndFraction equals StartFraction upper K upper R 1 Over 1 plus s upper C Subscript upper F Baseline upper R 1 left parenthesis upper K plus 1 right parenthesis EndFraction commaVout
Iin
=
KR1
1 + sCF R1(K + 1),
(1) 
where K is the ICON cell mirroring factor, RSubscript 11 is the resistance in the cascode 
buffer implemented by the NMOS (MSubscript normal upper R Baseline 1R1) in ohmic region, and CSubscript normal upper FF is the feedback 
capacitance. The time constant of the stage is given by normal tau Subscript normal upper FτF = CF RSubscript 11(K+1), and the 
shaping time normal tau Subscript normal sτs may be deﬁned as the output signal (Vout) time width calculated at 
1% of the peak. Table 1 summarizes the MIRA CSA main parameters. 
Moreover, due to the mirroring factor, all the noise contributions on the ICON 
left branch, either the ones corresponding to the buffer or the ICON itself, will be 
reduced by a factor K2. In this regard, the total current white noise contribution Si,out 
in the right branch of the ICON mirror would be:

116
E. Fabbrica et al.
K : 1 
K : 1
MR1 
CF 
VDD 
VDD 
VDD 
MR1 
Iout ,dc 
VDD 
ICON
Buffer
Amplifier 
Fig. 3 The MIRA CSA is composed of the folded cascode ampliﬁer, the cascode buffer, and the 
ICON cell. The charge (green arrows) and discharge (red arrows) phases of the capacitor CSubscript normal upper FF are 
highlighted 
Table 1 MIRA CSA main 
parameters 
Parameter
Slow mode 
Fast mode 
RSubscript 11 [kupper Omega]
50
25 
K
218
218 
Iout,dc [pA]
300
300 
CF [fF]
5
5 
Req = (K+1)RSubscript 11 [Mupper Omega] 
10.95
5.48 
normal tau Subscript normal upper FτF [ns]
54.75
27.4 
Shaping time normal tau Subscript normal sτs [ns] 
264.5
124.9 
upper S Subscript i comma o u t Baseline equals StartRoot 2 left parenthesis 2 q upper I Subscript o u t comma d c Baseline right parenthesis squared plus left parenthesis StartFraction upper S Subscript i comma l e f t Baseline Over upper K squared EndFraction right parenthesis squared EndRoot commaSi,out =

2

2qIout,dc
2 +
Si,lef t
K2
2
,
(2) 
where Iout,dc is the ICON output DC current, and Si,left is the total equivalent noise 
in the left branch of the mirror, which is equal to the sum of all noise contributions 
corresponding to buffer and left branch of ICON. As Eq. 2 asserts, since the total 
equivalent noise in the left branch is demagniﬁed by a factor K2, the dominant 
contribution of the MIRA CSA current white noise is given only by the ICON 
output DC current Iout,dc. The advantages of the noise, thus the ENC, reduction 
of the proposed CSA can be highlighted by the comparison with a more common 
architecture, i.e., the Krummenacher feedback [7]. In the Krummenacher feedback,

MIRA: A Low-Noise Pixelated ASIC for Photon Counting Applications
117
CF 
Vref 
(a) 
Qin 
CF 
−IK 
2 ∗ 1 
CF 
τs 
OUT 
(b) 
t 
Fig. 4 (a) The Krummenacher feedback architecture. (b) A simpliﬁed version of the output 
response 
Table 2 MIRA CSA 
comparison with 
Krummenacher feedback 
Parameter 
MIRA CSA 
Krummenacher 
normal tau Subscript normal sτs
proportional to∝KRSubscript 11CF
proportional to∝Qin/IK 
Si,w
Iout,dc
IK 
shown in Fig. 4a, the pulse duration depends on the input charge Qin and on the 
bias current of the stage IK (see Fig. 4b). At the same time, IK contributes to the 
total current noise of the stage. With the proposed solution, the time duration of the 
stage (thus the shaping time) results independent of the main current noise source 
contribution. Indeed, the shaping time depends on RSubscript 11, K, CF, and it is independent 
of Iout,dc, which is the main contribution to the current noise in the MIRA CSA. 
Table 2 compares shaping time (normal tau Subscript normal sτs) and current noise source (Si,w) dependencies 
for both stages. In the MIRA CSA, the current noise can be decreased without 
compromising the shaping time. Instead, in the Krummenacher feedback, the 
shaping time is inversely proportional to the bias current (IK). Thus, decreasing Si,w 
would result in a shaping time increase. 
2.2 
The Filter Stage 
The second stage in the pixel readout chain is the Filter Stage which converts the 
CSA output voltage signal into a current signal. Figure 5 shows the Filter Stage 
schematic. The Filter Stage can be mainly divided into the low-pass ﬁlter and the 
summing node. The summing node represents the ﬁrst step to correcting the charge 
sharing effect [8]. After being DC-shifted, the CSA output signal of each pixel is 
converted into a current signal in the Filter Stage. Referring to pixel E, its summing

118
E. Fabbrica et al.
Isum 
CLPF 
ME 
ME
ME
ME 
Vout ,CSA 
Pixel E 
A
B
 C
 
D 
E 
F 
G
H
 I
 
MA
MB
MD 
To 
PPixel H 
To 
Pixel F 
To 
Pixel I 
M2 
MM 
Vout ,LS 
From 
Pixel B 
From 
Pixel A 
From 
Pixel D 
M1 
Fig. 5 The Filter stage schematic 
node has the goal of summing the signal current of the considered pixel (E) with 
the current signals coming from the adjacent top-left pixels (A, B, D), as shown 
in Fig. 5. For the same reason, each pixel creates three independent copies of the 
current signal that will be fed to the summing node of the adjacent bottom-right 
pixels (F, H, I). In this way, in the case of charge sharing among a cluster of four 
pixels, the total charge can be reconstructed in the summing node in the form of a 
current. Then, it will be mirrored and sent to the discriminator. Thus, the total output 
current of the stage is: 
upper I Subscript s u m Baseline equals sigma summation Underscript j equals left bracket upper A comma upper B comma upper D comma upper E right bracket Endscripts upper V Subscript o u t comma upper L upper S comma j Baseline dot g Subscript m comma j Baseline commaIsum =

j=[A,B,D,E]
Vout,LS,j · gm,j,
(3) 
with Vout,LS being the output voltage of the level shifter and gm the transconduc-
tance of the common source MOSFET. 
Moreover, further noise ﬁltering occurs in this stage. It allows to achieve an ENC 
of about 20 e-rms. In this regard, a low-frequency pole has been introduced in the 
stage. In terms of occupation area, the best way has been to place a MOS capacitor 
in the mirror branch. Indeed, a single ﬁlter that acts after the sum of the currents has 
allowed for saving space. 
The Filter Stage can also be conﬁgured in single pixel mode by changing the 
interconnections through a system of six switches (from now on, SP = Single Pixel 
mode, CS = Charge Summing mode). In SP mode, each pixel processes the amount 
of charge collected at its anode independently from the others. Hence, the four 
common source transistors convert the CSA output signal into four equal currents. 
Then, they are summed in the summing node and mirrored in the right branch of the 
mirror. In this case, the stage introduces a gain G = 4 conversely to the summing 
node modality. In case of charge sharing effect, the CS and the SP mode will allow 
the Charge Sharing Correction Logic (CSCL) to identify the pixel with the highest 
charge starting from the reconstructed charge level or not, respectively.

MIRA: A Low-Noise Pixelated ASIC for Photon Counting Applications
119
2.3 
The Current Discriminator 
Referring to Fig. 5, the sum current Isum, reconstructed in CS mode or ampliﬁed in 
SP mode, is fed to the current discriminator, where it is compared with a threshold 
current ITH. ITH is the is the sum of a reference threshold current generator (Isum,dc) 
and a current generated by a 4-bit DAC (IDAC). The discriminator is composed of 
three blocks: the current comparator, the transimpedance ampliﬁer (TIA), and the 
inverter. The role of the current comparator is to compare the current signal with 
a threshold current. The difference between the two (Idisc) is sent to the input of 
the TIA. The TIA is a gain stage that provides a small impedance path and a small 
time constant for fast switching. Transistors Mup and Mdown are alternatively ON, 
depending on whether the current signal exceeds the threshold current or not. After 
the transimpedance ampliﬁer, an inverter is present to consolidate the logic levels. 
Figure 6 illustrates the operation of the discriminator in the two possible scenarios: 
when the signal is below the threshold (Isum < ITH) and when the signal exceeds the 
threshold level (Isum > ITH). When Isum < ITH (see Fig. 6a), the current difference 
Idisc switches Mup on, while Mdown is off. When Isum > ITH (see Fig. 6b), the circuit 
behaves in the opposite way. The current difference Idisc switches Mdown on, while 
Mup is off. The input impedance Zin and the switching time are considerably reduced 
OUT 
Idisc 
VDD 
0V 
TIA
Inverter 
Zin 
Isum 
ITH 
Vout ,1 
IDAC 
ITH 
Mup 
Mdown
MB 
MA 
Isum 
DC 
Feedback 
Isum ,DC 
Current Comparator 
(a) 
OUT 
Isum 
Idisc 
TIA
Inverter 
Zin 
Vout ,1 
IDAC 
ITH 
Mup 
Mdown
MB 
MA 
Isum 
ITH 
VDD 
0V 
DC 
Feedback 
Isum ,DC 
Current Comparator 
(b) 
Fig. 6 The current discriminator working condition when the signal is below threshold (a) and  
above threshold (b)

120
E. Fabbrica et al.
by a negative loop gain provided by the second part of the TIA. The loop gain can 
be calculated with the following expression: 
upper G Subscript l o o p Baseline equals minus left parenthesis g Subscript m upper A Baseline plus g Subscript m upper B Baseline right parenthesis left parenthesis r Subscript o upper A Baseline StartAbsoluteValue EndAbsoluteValue r Subscript o upper B Baseline right parenthesis commaGloop = −(gmA + gmB)(roA||roB),
(4) 
where gmA,B and roA,B are the transconductances and the output resistances of 
transistors MA,B. Hence, the input impedance is reduced as follows: 
upper Z Subscript i n Baseline equals StartFraction 1 Over g Subscript m comma u p vertical bar d o w n Baseline dot left parenthesis 1 minus upper G Subscript l o o p Baseline right parenthesis EndFraction commaZin =
1
gm,up|down · (1 −Gloop),
(5) 
where gm,up|down is alternatively the transconductance of the transistor Mup|down, 
depending on discriminator operation. When the current discriminator is ﬁred, its 
output features a time-over-threshold (ToT) value depending on the input charge 
levels. In particular, for higher input charges, the ToT will be longer than for lower 
input charges. Thus, the rising and falling edges of the output pulse will come earlier 
and later, respectively, than for a lower input charge. The rising and falling edges 
arrival times are of fundamental importance for the functioning of the charge sharing 
correction logic. 
A baseline holder has been designed to reduce variations coming from transistor 
mismatches of the threshold current with respect to the input current. The DC 
feedback block copies the current Isum, ﬁlters it leaving the DC component, and 
gives it back to the threshold branch. In the ideal case, the threshold current is pre-
cisely equal to the DC component of the signal current. Thus, no more dependency 
exists on mismatches coming from previous stages, and only mismatches in the DC 
feedback block affect the threshold current. Hence, a DAC current IDAC sets the 
threshold of the desired value above the noise limit and recovers the mismatches. 
Reducing variations allows for designing a DAC with a lower number of bits, lower 
FSR, and ﬁner LSB, thus saving area. Table 3 reports the main parameters of the 
MIRA current discriminator in SP mode and with an input charge Qin = 1000 e-. 
Table 3 The MIRA current 
discriminator main 
parameters in SP mode with 
an input charge Qin = 1000 e-
Parameter
Value 
Isum,peak [normal muμA]
6 
normal sigma Subscript normal n comma i s u mσn,isum [nArms]
99 
normal sigma Subscript normal n comma upper Q s u mσn,Qsum [e-rms]
68 
ENC [e-rms]
17 
normal tau Subscript upper L upper P upper FτLPF [ns]
600 
normal sigma Subscript upper I t h minus upper I s u m comma upper D upper CσIth−Isum,DC [nArms] 
617 
DAC LSB [nA]
130

MIRA: A Low-Noise Pixelated ASIC for Photon Counting Applications
121
2.4 
The Charge Sharing Correction Logic 
In a photon counting application employing a microchannel plate (MCP) as a 
detector, the charge sharing effect may happen when the total charge exiting the 
MCP is not captured by a single pixel. In this case, it would be shared by many 
nearby ones due to electron cloud diffusion. Indeed, mistakes like missing part of the 
events and counting excess events in more than one pixel might lead to a reduction 
in detection efﬁciency. Thus, the goal of the charge sharing correction logic is to 
avoid multiple counts and degradation of the spatial resolution. It is performed by 
comparing the outputs of current comparators of different pixels and assigning the 
count to the pixel that collected the highest charge. In this way, a spatial resolution 
limited to the 35 normal muμm pixel size may be achieved even in the case of charge sharing. 
MIRA features three different modalities. Moreover, depending on modality choice, 
the MIRA ﬁlter stage can be conﬁgured either in Single Pixel (SP) mode or Charge 
Summing (CS) mode. The three modalities are Mode1, Mode2, and Mode3. 
In Mode1, the MIRA ﬁlter stage works in single pixel (SP) mode, and the charge 
sharing correction logic is excluded. Indeed, each pixel works independently and 
with its own collected charge. Then, the current comparator output pulse is fed to 
the pixel counters, incrementing the stored value. 
In Mode2, the ﬁlter stage is conﬁgured in single pixel mode, and the Mode2 
charge sharing correction logic is enabled. Thus, in the case of charge sharing, the 
charge exiting the MCP is collected by each pixel in different amounts depending 
on the position of the electron cloud. Then, it is processed by the CSA and ampliﬁed 
by a factor of four by the ﬁlter stage. Once the signal has reached the current 
comparator, it will be compared with the threshold, and an output pulse will be 
generated. The path is the same as in Mode1. Since the Mode2 algorithm has been 
enabled, comparisons between the other pixel pulses are performed to ﬁnd the pixel 
with the highest collected charge. The comparisons are both in the vertical and the 
horizontal directions. Hence, the winning pixel would be the one with four arrows 
pointing to it. In each pixel, the process of ﬁnding the pixel with the highest amount 
of charge is based on a comparison performed by the MUTEXes arbitrators. When 
the discriminator ﬁres, it generates a pulse with a temporal width according to the 
amount of charge accumulated by the pixel. Following that, the pulse is transferred 
to the MUTEXes. They are responsible for choosing between two requests and 
activating an acknowledgment signal for only one request, even when many requests 
come simultaneously. The operation principle of the MUTEX is, thus, based on 
the decision of which pulse arrives ﬁrst and lasts more. They are based on an RS 
latch with a simple structure (U3 and U4) to eliminate glitches at the output and to 
ﬁlter the metastable state occurring when two inputs arrive closely spaced in time. 
Figure 7 shows the Mode2 schematic based on the MUTEX comparisons of a cluster 
of four pixels, i.e., pixel F, G, L, and M. Pixel M has collected the highest amount 
of charge (1400 e-), thus its counter is ﬁred. 
The Mode3 charge sharing correction logic is, in principle, an extension of 
Mode2. Moreover, the ﬁlter stage is conﬁgured in charge summing mode (CS). In

122
E. Fabbrica et al.
F 
L 
G 
out_dx 
out_down 
M 
in_down 
in_dx 
Counter 
out_dx 
in_down 
in_dx 
Counter 
H 
out_dx 
out_down 
N 
in_down 
in_dx 
Counter 
G 
L
M 
M 
600 − 
1
− 
0e− 
0e−
− 
− 
Pixell F 
Pixell L 
Pixell G 
0 
0 
0 
0 
0 
0 
N 
out_dx 
in_down 
in_dx 
Counter 
Pixel M 
1 
1 
M 
1 
1 1 
A 
0 
B 
0 
C 
0 
D 
0 
E 
0 
F 
600 
G 
1000 
H 
0 
I 
0 
L 
1000 
M 
1400 
N 
0 
O
P
Q
R 
U1 
U2
U4 
U3 
R1 
R0
G0 
G1 
Mutex 
R1 
R0 
0 
1 
G0 
G1 
0e− 
0e− 
out_down 
0e− 
out_down
R
Q
Q
P 
0
0
0
0 
Fig. 7 Mode2 charge sharing correction logic of pixel F, G, L, and M. Vertical and horizontal 
comparisons are performed by MUTEXes. The operation principle of the MUTEX is based on the 
decision of which pulse arrives ﬁrst and lasts more. Pixel M has collected the highest amount of 
charge, thus its counter is ﬁred 
CS mode, each pixel summing node receives the charge from adjacent pixels on the 
top, top-left, and left sides of the considered pixel. Indeed, unlike in Mode2, the total 
initial charge may be reconstructed in the case of charge sharing. As for Mode2, the 
logic operates for a cluster of four pixels. The summing node that reconstructs the 
total charge is located in the center of the four pixels cluster and, for this reason, 
is called the central summing node. Thus, in the case of charge sharing, a two-
step algorithm ﬁnds the winning pixel, starting from comparisons between summing 
nodes. Firstly, it identiﬁes the four pixels cluster where the charge is present, i.e., 
where the central summing node is located. Then, it ﬁnds the pixel in the cluster 
that collected the highest amount of charge by making comparisons with summing 
nodes around the selected cluster. 
Imaging simulations considering the charge dispersion of the MCP charge cloud 
and modeling the pixel electronic noise and the pixel threshold dispersion validate 
the implemented algorithms. The simulation model of the charge cloud follows the 
2D Gaussian probability density function distribution with standard deviations in 
the x and y directions of normal sigma Subscript normal xσx = 7 normal muμm and normal sigma Subscript normal yσy = 9 normal muμm. Moreover, the pixel ﬁll factor 
FF = 33% has been taken into account. A beam of electrons, with QMCP = 4000 e-, 
has been scanned with a step of 500 nm in both x and y directions, over a matrix 
of 6times×6 pixels, for 1000 times. Figure 8 shows the simulation results for the Mode1 
and Mode2 algorithms. The resulting image is a composition of an array of 3times×3 
images, where each image corresponds to a speciﬁc pixel and shows the number of 
counts at each step of the beam scanning. The number above each image represents

MIRA: A Low-Noise Pixelated ASIC for Photon Counting Applications
123
Mode1 
362e-
0
100
200 
0 
50 
100 
150 
200
0 
500 
1000 
426e-
0
100
200 
0 
50 
100 
150 
200
0 
500 
1000 
440e-
0
100
200 
0 
50 
100 
150 
200
0 
500 
1000 
362e-
0
100
200 
0 
50 
100 
150 
200
0 
500 
1000 
400e-
0
100
200 
0 
50 
100 
150 
200
0 
500 
1000 
398e-
0
100
200 
0 
50 
100 
150 
200
0 
500 
1000 
417e-
0
100
200 
0 
50 
100 
150 
200
0 
500 
1000 
384e-
0
100
200 
0 
50 
100 
150 
200
0 
500 
1000 
376e-
0
100
200 
x [µm] 
0 
50 
100 
150 
200 
y [µm] 
0 
500 
1000 
(a) 
Mode2 
362e-
0
100
200 
0 
50 
100 
150 
200
0 
500 
1000 
426e-
0
100
200 
0 
50 
100 
150 
200
0 
500 
1000 
440e-
0
100
 200
 
0 
50 
100 
150 
200
0 
500 
1000 
362e-
0
100
200 
0 
50 
100 
150 
200
0 
500 
1000 
400e-
0
100
200 
0 
50 
100 
150 
200
0 
500 
1000 
398e-
0
100
 200
 
0 
50 
100 
150 
200
0 
500 
1000 
417e-
0
100
200 
0 
50 
100 
150 
200
0 
500 
1000 
384e-
0
100
200 
0 
50 
100 
150 
200
0 
500 
1000 
376e-
0
100
 200
 
x [µm] 
0 
50 
100 
150 
200 
y [µm] 
0 
500 
1000 
(b) 
Fig. 8 Simulation results of a beam of electrons, with QMCP = 4000 e-, scanned with a step of 
500 nm in both x and y directions, over a matrix of 6times×6 pixels, for 1000 times. (a) The charge 
sharing correction logic is excluded (Mode1); hence the spatial resolution is worsened. (b) The  
Mode2 algorithm is enabled. Vertical and horizontal comparisons allow only one pixel to count for 
each event in whatever position it originated, granting thus a spatial resolution of 35normal muμm

124
E. Fabbrica et al.
the threshold level of that pixel after the DAC correction. Ideally, each pixel should 
count the events only when the beam is scanned inside its area, while it should 
never count when the beam is elsewhere. Thus, the result should be a uniform 
white area image at the location of the considered pixel. Figure 8a shows  the  
simulation results without the charge sharing correction logic (Mode1). It can be 
noticed that each pixel counts even when the charge cloud is centered in the area 
of others, thus causing a worsening of the spatial resolution. Figure 8b shows  the  
simulation results with the Mode2 algorithm enabled. The algorithm of Mode2 
compares the discriminator output of pixels on the top, left, right, and bottom sides 
of the considered pixel. This should allow only one pixel to count for each event in 
whatever position it originated. Indeed, each pixel detects the event only when the 
latter is inside the pixel area, granting thus a spatial resolution limited to the pixel 
size (35 normal muμm). 
2.5 
MIRA Readout Stage 
The output of the charge sharing correction logic is fed to the pixel readout stage. 
The readout stage of the pixel is composed mainly of two 17-bit counters that will 
increment their value each time a hit is assigned to the pixel. The two counters work 
alternatively to have a zero-dead time operation, meaning that, while one counts the 
events, the other is read by the chip periphery. In this way, a continuous counting 
and reading phase is guaranteed. During the counting phase, one counter receives the 
events from the charge sharing correction logic and increments the stored number. 
During the counting phase, the same counter behaves like a Shift Register (SR), 
moving its content to the bottom pixels (with one of the two counters conﬁgured as 
an SR) until it reaches the End-Of-Column block (EOC), i.e., the chip periphery. The 
two pixel counters have been implemented as 17-bit Linear Feedback Shift Register 
(LFSR) that are able to work in the two modalities and, thus, saving occupation 
area [9]. Figure 9 shows the implementation of the two 17-bit LFSRs (for clarity, 
only three FFs out of seventeen are represented in the ﬁgure). 
Moreover, inside each pixel, a 7-bit Pixel Conﬁguration Register (PCR) is also 
present. It is composed of seven FFs that store the pixel conﬁguration bits. They 
consist of the four DAC bits used for the pixel threshold programming, one sign 
bit used for reducing the threshold current, one “CSA Mask” bit for decoupling 
the CSA from the rest of the circuit in case of malfunctioning, and one bit used 
to activate the injection network, i.e., a network responsible of testing the pixel 
electronics by an external signal. The PCR is attached to the last seven FFs (from 
Q11 to Q17) of only one counter. Figure 9 also shows the implementation of the PCR 
for just one pixel. To reduce the complexity of the ﬁgure, only two FFs of the PCR 
are represented.

MIRA: A Low-Noise Pixelated ASIC for Photon Counting Applications
125
D
Q 
D
Q 
D
Q 
0
1
C&R 
1 
0 
C&R 
EVENTS 
CK_READ1 
D
Q 
D
Q 
D
Q 
1
0
C&R 
0 
1 
C&R 
EVENTS 
CK_READ1 
FF1 
FF14 
FF17 
FF1 
FF14 
FF17 
From previous pixel
From previous pixel 
PCR 
D
Q
Q 
D
Q
Q 
Acquisition 
Config 
To next pixel
To next pixel 
Fig. 9 The two pixel counters. Two 17-bit LFSR with multiplexing logic controlled by the Campersand&R 
signal to alternate the counting and the reading phases. Moreover, a 7-bit Pixel Conﬁguration 
Register (PCR) is connected to only one counter. The PCR stores the pixel conﬁguration bits loaded 
during the conﬁguration phase 
3 
Experimental Results 
The MIRA ASIC has been characterized both in a laboratory setup and in the 
photon-counting unit (see Sect. 1) without the microchannel plate, showing similar 
results. This section describes the characterization of the MIRA CSA and the charge 
sharing correction logic. In each pixel, an injection capacitance Cinj is present to 
pulse each pixel. Hence, an equivalent input charge may be injected into each MIRA 
CSA by an input square wave. The relationship between the amplitude Vtest of input 
test signal and the CSA output amplitude Vout,amp is: 
upper V Subscript o u t comma a m p Baseline equals upper Delta upper V Subscript t e s t Baseline StartFraction upper C Subscript i n j Baseline Over upper C Subscript upper F Baseline EndFraction periodVout,amp = Vtest
Cinj
CF
.
(6) 
Thus, with a square wave of amplitude upper DeltaVtest = 1.2 V, a CSA output amplitude 
Vout,amp almost equals≈120 mV. Moreover, the MIRA ASIC features two test pixels from 
which some analog signals, such as the MIRA CSA output, may be monitored and 
characterized. 
Figure 10 shows the measured CSA output voltage Vout in pink. In Fig. 10a, the 
measurement has been performed employing an active probe not to compromise the 
rising time of the signal. The MIRA CSA has been conﬁgured in slow mode, and 
the amplitude of the square wave signal has been set to Vtest = 1.2 V. The latter 
corresponds to an equivalent input charge of Qin = 4000 e-.

126
E. Fabbrica et al.
trise 
tfall 
Vout ,amp 
(a) 
σn,vout 
(b) 
Fig. 10 (a) The measured MIRA CSA output response to an input charge Qin=4000 e-. An active 
probe has been employed. The MIRA CSA has been conﬁgured in slow mode. An output voltage 
amplitude Vout,amp=112 mV, a rise time trise=7 ns, and a fall time tfall=150 ns, thus a shaping time 
normal tau Subscript normal sτs=261 ns, have been achieved. (b) An SMA connection to quantify the noise performances of the 
stage has been employed. An rms output voltage noise normal sigma Subscript normal n comma v o u tσn,vout=750normal muμVrms that corresponds to an 
ENCCSA=27 e-rms has been achieved at the CSA level 
An amplitude of the CSA output voltage Vout,amp = 112 mV, a rising time 
trise = 7 ns, and a falling time tfall = 150 ns, thus a shaping time normal tau Subscript normal sτs = 261 ns, have been 
achieved. The measured shaping time and the output voltage amplitude are close to 
the simulated values. Since the measurement setup add a not negligible contribution 
to the signal rise time, the measured rise time is slightly lower than the expected one 
of 2 ns (a rise time faster than 7 ns is expected in a real operation). Moreover, since 
the rms noise introduced by the active probe is higher than the rms noise expected

MIRA: A Low-Noise Pixelated ASIC for Photon Counting Applications
127
Fig. 11 MIRA charge 
sharing correction logic 
characterization, Mode1 and 
Mode2. The pixels cluster is 
highlighted with a red box. 
The equivalent charge cloud 
has been rotated inside the 
cluster by changing the input 
charge from time to time. In 
every case, all pixels count in 
Mode1. In Mode2, only the 
pixel with the highest charge 
amount is counting. The 
spatial resolution is limited to 
the pixel size 
Mode1
Mode2 
at the CSA output, an SMA connection has been employed to better quantify the 
noise performances of the stage. In Fig. 10b, the measured CSA transient response 
shows an rms output voltage noise normal sigma Subscript normal n comma v o u tσn,vout = 750 normal muμVrms that corresponds to an 
ENCCSA = 27 e-rms at the CSA level. Hence, an ENC = 20 e-rms is achieved thanks 
to further ﬁltering by the Filter Stage. It can be concluded that measurements of the 
MIRA CSA showed transient characteristics and noise performances in line with 
simulations. 
The MIRA charge sharing correction logic (CSCL) has been tested by replicating 
a real operating environment. Indeed, since MIRA has been characterized without 
the microchannel plate, different charge levels are provided to the pixels of one 
cluster. When the chip is conﬁgured in Mode1 modality, the MIRA CSCL is 
excluded. Thus, all four pixels discriminate the event and will count it. The spatial 
resolution is degraded and limited to the cluster dimensions. The Mode2 modality 
should be selected to avoid multiple counting inside the cluster and to assign the 
count to the pixel with the highest amount of collected charge. Figure 11 shows the 
results in Mode1 and Mode2. The four pixels cluster is highlighted with a red box. 
The equivalent charge cloud has been rotated inside the cluster by changing the 
pixels injected charge from time to time. In every case, all pixels count in Mode1. 
In Mode2, only the pixel with the highest charge amount counts. Thus, the spatial 
resolution is limited to the pixel size (35 normal muμm). Mode3 has been tested in a similar 
way, showing analogous results to Mode2 in terms of spatial resolution. In this test, 
the charge resolution for which the charge sharing correction logic can correctly

128
E. Fabbrica et al.
distinguish the pixel with the highest charge from the others is 150 e-, limited by the 
test setup. It is expected to be lower during real operation (with the MCP and the 
charge sharing effect), determined only by the pixel mismatches inside the cluster. 
4 
Conclusions 
We have introduced the design of a charge readout ASIC. The key features achieved 
by this design are the compactness of the pixels (of only 35 normal muμm side with an 
anode ﬁll factor of 32percent sign%) and the very low noise. The main challenge of densely 
pixelated detectors is charge sharing among neighboring pixels: consequently, we 
have endowed the chip with different types of charge correction logic. Another key 
challenge is the layout of the ASIC, in particular of the bonding pads that should 
be grouped on a single side in order for the several chips to be tiled (on three sides) 
to cover larger detector areas. The growth in the number of pixels also impacts 
the time for data readout along the serial bus. We expect that the number of pixels 
can grow by a factor between 100 to 1000 and still be compatible with the zero 
dead-time condition and a feasible frequency of the digital clock that has to be 
correspondingly increased. In addition to MCPs, this ASIC could be coupled to 
other types of detectors, in particular semiconductor ones, for multispectral X-ray 
and gamma-ray imaging applications. 
References 
1. Arridge, C. S., et al. (2012). Uranus Pathﬁnder: Exploring the origins and evolution of Ice Giant 
planets. Experimental Astronomy, 33(2), 753–791. 
2. Hofstadter, M., et al. (2017) Ice giants pre-decadal survey mission study report. JPL D-100520. 
3. Ghail, R. C., et al. (2012). EnVision: Taking the pulse of our twin planet. Experimental 
Astronomy, 33(2), 337–363. 
4. Pelizzo, M. G., et al. (2021). The PLanetary extreme Ultraviolet Spectrometer Project. In Astro-
nomical optics: Design, manufacture, and test of space and ground systems III (vol. 11820). 
Bellingham: SPIE. 
5. Fabbrica, E., et al. (2022). Design of MIRA, a low-noise pixelated ASIC for the readout of 
micro-channel plates. Journal of Instrumentation, 17(1), C01047. 
6. Fiorini, C., & Porro, M. (2004). Integrated RC cell for time-invariant shaping ampliﬁers. IEEE 
Transactions on Nuclear Science, 51(5), 1953–1960. https://doi.org/10.1109/TNS.2004.835578 
7. Krummenacher, F. (1991). Pixel detectors with local intelligence: An IC designer point 
of view. Nuclear Instruments and Methods in Physics Research Section A: Accelerators, 
Spectrometers, Detectors and Associated Equipment, 305(3), 527–532. https://doi.org/10.1016/ 
0168-9002(91)90152-G 
8. Ballabriga, R., et al. (2007). The Medipix3 prototype, a pixel readout chip working in 
single photon counting mode with improved spectrometric performance. IEEE Transactions on 
Nuclear Science, 54(5), 1824–1829. 
9. Cusick, T. W., & Stanica, P. (2017) Cryptographic Boolean functions and applications. 
Cambridge: Academic Press.

Development of the Analog Front-End 
Circuit for the CMS Pixel Readout Chip 
at the HL-LHC 
L. Gaioni, A. Galliani, M. Manghisoni, L. Ratti, V. Re, E. Riceputi, 
and G. Traversi 
1 
Introduction 
Phase-II upgrades of CMS and ATLAS at the High-Luminosity (HL) Large Hadron 
Collider (LHC) require new trackers to deal with extraordinary particle rates and 
radiation levels [1, 2]. Advanced pixel sensors, in the crowded region surrounding 
the interaction point, will handle rates close to 3 GHz/cmsquared2, with a total ionizing 
dose (TID) expected to be about 1 Grad(SiOSubscript 22),  with a 1 MeV  neutron equivalent 
ﬂuence of 2times×10Superscript 1616 nSubscript eq Baselineeq cmSuperscript negative 2−2 accumulated over around 10 years of operation. In 
the innermost layers of the tracker, an elementary pixel size of 50 times × 50 normal muμm 
(or, alternatively, 25 times× 100 normal muμm) will improve momentum measurement accuracy. 
While sensors with a typical thickness close to 300 normal muμm are currently in use in the 
experiments, thinner sensors, with an active volume around 100 normal muμm, will be used in 
the phase-II upgrades [3, 4]. On one hand, sensor radiation hardness will naturally 
beneﬁt from a reduced device thickness, but, on the other hand, the amount of charge 
and, thus, the signal delivered by the pixels will be smaller. The readout chips will 
be required to be fully functional at low thresholds (1000 electrons or lower) in 
order to preserve the detection efﬁciency of the system. This will tighten up the 
requirements on both the noise and threshold dispersion performance of the analog 
front-end, where the per-pixel power consumption has to be limited (to about 6 normal muμW) 
to meet the speciﬁcations set by cooling and power-delivery systems. 
L. Gaioni () · A. Galliani · M. Manghisoni · V. Re · E. Riceputi · G. Traversi 
Università di Bergamo, Dalmine, Italy 
INFN, Sezione di Pavia, Pavia, Italy 
e-mail: luigi.gaioni@unibg.it 
L. Ratti 
Università di Pavia, Pavia, Italy 
INFN, Sezione di Pavia, Pavia, Italy 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
C. Hansson, K. (Kris) Iniewski (eds.), X-ray Photon Processing Detectors, 
https://doi.org/10.1007/978-3-031-35241-6_7
129

130
L. Gaioni et al.
The RD53 collaboration [5] was established at CERN in 2013 to tackle, in a 
commercial 65 nm CMOS technology, the design of high performance readout 
chips for the high-luminosity upgrades of the CMS and ATLAS experiments. The 
collaborative effort of the two communities led to the submission, in 2017, of the 
ﬁrst large-scale demonstrator chip, called RD53A [6]. RD53A includes a matrix 
of 400 times× 192 readout channels, featuring a cell size of 50 times × 50 normal muμm, that can be 
bonded to the sensor through dedicated bump pads laid out in the topmost metal 
layer. Three different analog front-end architectures, called Synchronous, Linear 
and Differential, were speciﬁcally developed and integrated in the RD53A chip, 
whose pixel matrix is split in three regions each hosting one front-end ﬂavor. In 
particular, 128 columns were allocated to the Synchronous front-end, whereas 136 
columns were assigned to both the Linear and the Differential front-ends. The three 
analog processors have been thoroughly investigated in view of their integration 
into the production chips [7], with the Linear front-end being chosen for the ﬁnal 
integration in the CMS chip, and the Differential for the ATLAS one. 
After RD53A characterization, a number of bug ﬁxes and design improvements 
were proposed and implemented in the second generation of RD53 readout chips, 
referred to as RD53B. In particular, some modiﬁcations to the RD53A Linear front-
end were needed to improve the time-walk performance of the readout channel 
and its threshold tuning capabilities in speciﬁc operating conditions [8]. In this 
work, the RD53B Linear front-end circuit will be described, discussing the main 
modiﬁcations with respect to the RD53A version and the results relevant to the 
testing of a small prototype chip including both the RD53A and RD53B front-
end ﬂavors. In particular, the overall architecture of the analog processor will be 
introduced in Sect. 2 along with a discussion of the optimization process which led 
to the RD53B design. Section 3 is concerned with the key test results, as obtained 
from the characterization of the prototype chip before and after irradiation up to a 
total ionizing dose of 1 Grad(SiOSubscript 22). 
2 
Front-End Design 
The Linear front-end architecture is shown, with some transistor level details, in 
Fig. 1. Such an architecture implements a shaper-less readout chain including a 
charge sensitive ampliﬁer (hereafter referred to as CSA or preampliﬁer) and a 
comparator, exploited, together with a Time-over-Threshold (ToT) counter (not 
shown in the ﬁgure), for analog to digital conversion of the input signal amplitude. 
The front-end circuit also includes a threshold tuning DAC (TDAC), acting on 
the output of the ﬁrst stage of the comparator, needed to reduce the threshold 
dispersion of the front-end and making operations with a threshold level close to 
1000 electrons possible. An injection circuit, emulating the signal delivered by 
the sensor, is connected to the preampliﬁer input, while an actual sensor can be 
connected to the front-end through a dedicated, octagonal pad about 16 normal muμm wide. A 
description of the blocks integrated in the Linear front-end is given in the following 
sections.

Development of the Analog Front-End Circuit for the CMS Pixel Readout Chip. . .
131
CF 
Vref 
IK 
IK/2 
VDDA 
Injection 
circuit 
Vo,csa 
detector 
bump PAD 
CK 
M3 
M1
M2 
Transconductance 
stage 
Vth 
Tr ff 
TDAC code 
V 
Vo,comp 
Itrim 
Comparator 
Fig. 1 Block diagram of the Linear front-end 
2.1 
Charge Sensitive Ampliﬁer 
The preampliﬁer integrates a folded cascode gain stage surrounded by a Krumme-
nacher feedback network [9] featuring a differential pair biased with a current upper I Subscript upper KIK. 
The Krummenacher feedback serves a two-fold purpose: on one hand it guarantees 
proper operation of the front-end also in the presence of leaky detectors, and on 
the other hand it provides a linear discharge of the CSA feedback capacitance, upper C Subscript upper FCF . 
In steady state, half of the upper I Subscript upper KIK current is sourced by transistor upper M 2M2 (whose drain 
is connected to a current generator upper I Subscript upper K Baseline divided by 2IK/2) while the remaining half ﬂows through 
upper M 1M1. Since the current in the matched pair upper M 1M1 and upper M 2M2 is the same, the preampliﬁer 
DC output voltage is locked to upper V Subscript r e fVref . In the presence of a detector leakage current 
the output of the preampliﬁer tends to increase, rising the current in upper M 2M2 and, thus, 
charging the capacitor upper C Subscript upper KCK. As a result, the gate of upper M 3M3 is driven low, and the 
transistor carries the additional current which compensates for the detector leakage 
one. On the other hand, for fast signals the leakage compensating loop (which reacts 
to extremely low frequency signals) does not kick in, the output voltage increases 
and the drain current of upper M 1M1 is reduced. Nonetheless, the current in upper M 3M3 does not 
change, and part of this current (or the entire current in case of saturation of the 
differential pair upper M 1M1-upper M 2M2) discharges the feedback capacitance upper C Subscript upper FCF , thus restoring the 
CSA baseline. When saturation of the differential pair takes place (this happens for 
an input charge larger than around 2000 electrons in the actual implementation of 
the front-end), the Krummenacher feedback thus provides a linear discharge of upper C Subscript upper FCF . 
With a current of 3 normal muμA ﬂowing in the input branch of the folded cascode gain stage, 
the preampliﬁer is the main contributor to the total power consumption of the Linear 
front-end. 
By using a single pole approximation for the CSA forward gain stage, the 
preampliﬁer transfer function, upper F left parenthesis s right parenthesisF(s), can be written as:

132
L. Gaioni et al.
upper F left parenthesis s right parenthesis equals StartFraction upper V Subscript o comma c s a Baseline Over upper Q Subscript i n Baseline EndFraction asymptotically equals StartFraction 2 upper C Subscript upper K Baseline Over g Subscript m Sub Subscript n Subscript Baseline g Subscript m Sub Subscript p Subscript Baseline EndFraction StartFraction s left parenthesis 1 plus s tau 3 right parenthesis Over left parenthesis 1 plus s tau 1 right parenthesis left parenthesis 1 plus s tau 2 right parenthesis left parenthesis 1 plus s tau 3 right parenthesis left parenthesis 1 plus s tau 4 right parenthesis EndFraction commaF(s) = Vo,csa
Qin
≃
2CK
gmngmp
s(1 + sτ3)
(1 + sτ1)(1 + sτ2)(1 + sτ3)(1 + sτ4),
(1) 
with upper V Subscript o comma c s aVo,csa being the Laplace transform of the preampliﬁer output signal, upper Q Subscript i nQin the 
input charge, g Subscript m Sub Subscript ngmn and g Subscript m Sub Subscript pgmp the transconductance of upper M 1M1 (or upper M 2M2) and upper M 3M3, respectively. 
It can be shown that 
StartLayout 1st Row 1st Column tau 1 2nd Column asymptotically equals 3rd Column StartFraction upper C Subscript upper K Baseline Over g Subscript m Sub Subscript p Subscript Baseline EndFraction comma EndLayoutτ1 ≃CK
gmp
, StartLayout 1st Row 1st Column tau 1 2nd Column asymptotically equals 3rd Column StartFraction upper C Subscript upper K Baseline Over g Subscript m Sub Subscript p Subscript Baseline EndFraction comma EndLayout
(2) 
St a
rtLayout 2nd Row 1st Column tau 2 2nd Column asymptotically equals 3rd Column StartFraction upper C Subscript upper F Baseline Over g Subscript m Sub Subscript n Subscript Baseline divided by 2 EndFraction comma EndLayout
StartLayout 2nd Row 1st Column tau 2 2nd Column asymptotically equals 3rd Column StartFraction upper C Subscript upper F Baseline Over g Subscript m Sub Subscript n Subscript Baseline divided by 2 EndFraction comma EndLayout StartLayout 2nd Row 1st Column tau 2 2nd Column asymptotically equals 3rd Column StartFraction upper C Subscript upper F Baseline Over g Subscript m Sub Subscript n Subscript Baseline divided by 2 EndFraction comma EndLayout
(3) 
St a rtLayout 3rd Row 1st Column tau 3 2nd Column asymptotically equals 3rd Column StartFraction upper C Subscript upper A Baseline Over 2 g Subscript m Sub Subscript n Subscript Baseline EndFraction comma EndLayout
Start
Layout 3rd Row 1st Column tau 3 2nd Column asymptotically equals 3rd Column StartFraction upper C Subscript upper A Baseline Over 2 g Subscript m Sub Subscript n Subscript Baseline EndFraction comma EndLayout StartLayout 3rd Row 1st Column tau 3 2nd Column asymptotically equals 3rd Column StartFraction upper C Subscript upper A Baseline Over 2 g Subscript m Sub Subscript n Subscript Baseline EndFraction comma EndLayout
(4) 
St a rtLayout 4th Row 1st Column tau 4 2nd Column asymptotically equals 3rd Column StartFraction upper C Subscript upper D Baseline Over upper C Subscript upper F Baseline EndFraction StartFraction tau Subscript p Baseline Over upper A 0 EndFraction comma EndLayout
Sta
rtL
ayo
ut 4th Row 1st Column tau 4 2nd Column asymptotically equals 3rd Column StartFraction upper C Subscript upper D Baseline Over upper C Subscript upper F Baseline EndFraction StartFraction tau Subscript p Baseline Over upper A 0 EndFraction comma EndLayout
(5) 
where upper C Subscript upper ACA is the parasitic capacitance at the source of upper M 1M1 and upper M 2M2, upper A 0A0 the DC gain of 
the CSA forward stage and tau Subscript pτp the time constant associated with its dominant pole. 
In simulations, such values were found to be 76 dB and 140 kHz, respectively. In 
(5), upper C Subscript upper DCD models the sensor and the parasitics capacitance shunting the preampliﬁer 
input. To avoid instabilities in the front-end operation, it has to be ensured that tau 1τ1
much greater than≫tau 2τ2 much greater than≫tau 3τ3 much greater than≫tau 4τ4. 
The transfer function in (1) can be simpliﬁed by assuming upper C Subscript upper K Baseline right arrow normal infinityCK →∞and upper C Subscript upper A Baseline right arrow 0CA →
0. Under this hypothesis, it is possible to write 
upper F left parenthesis s right parenthesis asymptotically equals StartFraction 2 divided by g Subscript m Sub Subscript n Subscript Baseline Over left parenthesis 1 plus s tau 2 right parenthesis left parenthesis 1 plus s tau 4 right parenthesis EndFraction periodF(s) ≃
2/gmn
(1 + sτ2)(1 + sτ4).
(6) 
In the time domain, the response of the preampliﬁer to a Dirac delta-like current 
pulse, delta left parenthesis t right parenthesis upper Q Subscript i nδ(t)Qin, is given by 
v Subscript o comma c s a Baseline left parenthesis t right parenthesis asymptotically equals upper U left parenthesis t right parenthesis upper Q Subscript i n Baseline StartFraction 2 Over g Subscript m Sub Subscript n Subscript Baseline EndFraction StartFraction normal e Superscript minus StartFraction t Over tau 2 EndFraction Baseline minus normal e Superscript minus StartFraction t Over tau 4 EndFraction Baseline Over tau 2 minus tau 4 EndFraction commavo,csa(t) ≃U(t)Qin
2
gmn
e−t
τ2 −e−t
τ4
τ2 −τ4
,
(7) 
upper U left parenthesis t right parenthesisU(t) being the unit step function. Assuming tau 2 much greater than tau 4τ2 ≫τ4, the response of the CSA can 
be written as 
v Subscript o comma c s a Baseline left parenthesis t right parenthesis asymptotically equals upper U left parenthesis t right parenthesis StartFraction upper Q Subscript i n Baseline Over upper C Subscript upper F Baseline EndFraction left parenthesis normal e Superscript negative t divided by tau 2 Baseline minus normal e Superscript negative t divided by tau 4 Baseline right parenthesis periodvo,csa(t) ≃U(t)Qin
CF

e−t/τ2 −e−t/τ4
.
(8) 
The peaking time, t Subscript ptp, at which the CSA output voltage gets to its maximum can be 
shown to be

Development of the Analog Front-End Circuit for the CMS Pixel Readout Chip. . .
133
t Subscript p Baseline asymptotically equals tau 4 l n left parenthesis StartFraction tau 2 Over tau 4 EndFraction right parenthesis commatp ≃τ4ln
τ2
τ4

,
(9) 
which is an increasing function of tau 2τ2. This means that the larger the Krummenacher 
current upper I Subscript upper KIK, the larger the transconductance of upper M 1M1 and upper M 2M2 and, in turn, the smaller 
the peaking time. The charge sensitivity of the CSA (i.e. the charge to voltage gain 
of the preampliﬁer) can be computed as the peak value of the Laplace anti-transform 
of upper F left parenthesis s right parenthesisF(s). For very small values of g Subscript m Sub Subscript ngmn, and this is the case of the front-end discussed 
in this work, where the Krummenacher current is typically set around 25 nA, the 
charge sensitivity, upper G Subscript upper QGQ, can simply be written as 
upper G Subscript upper Q Baseline asymptotically equals StartFraction 1 Over upper C Subscript upper F Baseline EndFraction periodGQ ≃
1
CF
.
(10) 
Both the RD53A and RD53B front-end ﬂavours have been designed with a target 
charge sensitivity close to 150 mV/fC. 
For input signals larger than around 2000 electrons, the response of the pream-
pliﬁer cannot be modelled by (8), since the differential pair upper M 1M1-upper M 2M2, as already 
mentioned, gets saturated. In this condition, upper M 1M1 is turned off and the current upper I Subscript upper K Baseline divided by 2IK/2, 
ﬂowing in upper M 3M3, linearly discharges the CSA feedback capacitance. The preampliﬁer 
response to a large input signal can thus be modelled by means of 
v Subscript o comma c s a Baseline left parenthesis t right parenthesis equals StartFraction upper Q Subscript i n Baseline Over upper C Subscript upper F Baseline EndFraction left parenthesis 1 minus normal e Superscript negative t divided by tau 4 Baseline right parenthesis minus StartFraction upper I Subscript upper K Baseline Over 2 upper C Subscript upper F Baseline EndFraction t periodvo,csa(t) = Qin
CF

1 −e−t/τ4
−IK
2CF
t.
(11) 
The discharge process is completed for t greater than t 0t > t0, where the output voltage returns to 
its baseline value. t 0t0 is such that 
StartFraction upper Q Subscript i n Baseline Over upper C Subscript upper F Baseline EndFraction left parenthesis 1 minus normal e Superscript minus t 0 divided by tau 4 Baseline right parenthesis minus StartFraction upper I Subscript upper K Baseline Over 2 upper C Subscript upper F Baseline EndFraction t 0 equals 0 periodQin
CF

1 −e−t0/τ4
−IK
2CF
t0 = 0.
(12) 
The response to a large signal can thus be approximated by means of a triangular 
pulse with a peak value occurring at the time t Subscript p Superscript asteriskt∗
p given by 
t Subscript p Superscript asterisk Baseline equals tau 4 l n left parenthesis StartFraction 2 upper Q Subscript i n Baseline Over upper I Subscript upper K Baseline tau 4 EndFraction right parenthesis commat∗
p = τ4ln
2Qin
IKτ4

,
(13) 
which is a monotonically increasing function of the input charge upper Q Subscript i nQin. 
2.2 
Noise Performance 
In order to operate the front-end with a threshold close to 1000 electrons and a 
noise occupancy not exceeding 10Superscript negative 6−6, as requested by the RD53A and RD53B

134
L. Gaioni et al.
speciﬁcation documents, noise optimization is of paramount importance. The main 
contributions to the Linear front-end noise come from the CSA input device and 
from the transistors in the Krummenacher feedback network. The mean square noise 
at the preampliﬁer output, ModifyingAbove v Subscript n Superscript 2 Baseline With quotation dashv2n, can be computed as 
ModifyingAbove v Subscript n Superscript 2 Baseline With quotation dash equals ModifyingAbove v Subscript n Sub Subscript i n Subscript Superscript 2 Baseline With quotation dash plus ModifyingAbove v Subscript n Sub Subscript p Subscript Superscript 2 Baseline With quotation dash plus ModifyingAbove v Subscript n Sub Subscript d Subscript Superscript 2 Baseline With quotation dash commav2n = v2nin + v2np + v2nd,
(14) 
where ModifyingAbove v Subscript n Sub Subscript i n Superscript 2 Baseline With quotation dashv2nin is the contribution given by the CSA input device, ModifyingAbove v Subscript n Sub Subscript p Superscript 2 Baseline With quotation dashv2np is the one 
relevant to the PMOS transistor upper M 3M3, and where ModifyingAbove v Subscript n Sub Subscript d Superscript 2 Baseline With quotation dashv2nd takes into account the noise 
sources associated with the differential pair upper M 1M1-upper M 2M2. The noise contribution of the 
preampliﬁer input transistor is mainly due to channel thermal noise. By neglecting 
the ﬂicker noise contribution, ModifyingAbove v Subscript n Sub Subscript i n Superscript 2 Baseline With quotation dashv2nin can be written as 
ModifyingAbove v Subscript n Sub Subscript i n Subscript Superscript 2 Baseline With quotation dash equals StartFraction 2 k Subscript upper B Baseline upper T gamma Subscript i n Baseline Over pi g Subscript m Sub Subscript i n Subscript Baseline EndFraction left parenthesis upper C Subscript upper D Baseline plus upper C Subscript upper F Baseline right parenthesis squared integral Subscript 0 Superscript normal infinity Baseline omega squared StartAbsoluteValue upper F left parenthesis j omega right parenthesis EndAbsoluteValue squared d omega commav2nin = 2kBT γin
πgmin
(CD + CF )2
 ∞
0
ω2|F(jω)|2dω,
(15) 
where k Subscript upper BkB is the Boltzmann’s constant, T is the absolute temperature, g Subscript m Sub Subscript i ngmin the 
transconductance of the CSA input device and gamma Subscript i nγin its channel thermal noise 
coefﬁcient, depending on the degree of inversion of the device channel [10]. By 
computing the integral in (15), and assuming tau 2 much greater than tau 4τ2 ≫τ4, it is possible to write 
ModifyingAbove v Subscript n Sub Subscript i n Superscript 2 Baseline With quotation dash asymptotically equals StartFraction 4 k Subscript upper B Baseline upper T gamma Subscript i n Baseline Over g Subscript m Sub Subscript i n Subscript Baseline g Subscript m Sub Subscript n Subscript Superscript 2 Baseline EndFraction StartFraction left parenthesis upper C Subscript upper D Baseline plus upper C Subscript upper F Baseline right parenthesis squared Over tau 2 squared tau 4 EndFraction equals StartFraction k Subscript upper B Baseline upper T gamma Subscript i n Baseline Over g Subscript m Sub Subscript i n Subscript Baseline EndFraction StartFraction left parenthesis upper C Subscript upper D Baseline plus upper C Subscript upper F Baseline right parenthesis squared Over upper C Subscript upper F Baseline upper C Subscript upper D Baseline EndFraction StartFraction upper A 0 Over tau Subscript p Baseline EndFractionv2nin ≃4kBT γin
gming2mn
(CD + CF )2
τ 2
2 τ4
= kBT γin
gmin
(CD + CF )2
CF CD
A0
τp
(16) 
which shows the dependence of ModifyingAbove v Subscript n Sub Subscript i n Superscript 2 Baseline With quotation dashv2nin on the total capacitance, upper C Subscript upper DCD, shunting the 
preampliﬁer input and on the gain bandwidth product of the CSA forward gain 
stage. Similarly, the noise contribution associated with upper M 3M3 and the one relevant to 
the differential pair are given, respectively, by 
ModifyingAbove v Subscript n Sub Subscript p Superscript 2 Baseline With quotation dash asymptotically equals StartFraction 2 k Subscript upper B Baseline upper T gamma Subscript p Baseline g Subscript m Sub Subscript p Subscript Baseline Over pi EndFraction integral Subscript 0 Superscript normal infinity Baseline StartAbsoluteValue upper F left parenthesis j omega right parenthesis EndAbsoluteValue squared d omega equals StartFraction 2 k Subscript upper B Baseline upper T gamma Subscript p Baseline Over upper C Subscript upper F Baseline EndFraction StartFraction g Subscript m Sub Subscript p Subscript Baseline Over g Subscript m Sub Subscript n Subscript Baseline EndFractionv2np ≃2kBT γpgmp
π
 ∞
0
|F(jω)|2dω = 2kBT γp
CF
gmp
gmn
(17) 
ModifyingAbove v Subscript n Sub Subscript d Subscript Superscript 2 Baseline With quotation dash asymptotically equals StartFraction 2 k Subscript upper B Baseline upper T gamma Subscript n Baseline g Subscript m Sub Subscript n Subscript Baseline Over pi EndFraction integral Subscript 0 Superscript normal infinity Baseline StartAbsoluteValue one half upper F left parenthesis j omega right parenthesis EndAbsoluteValue squared d omega equals StartFraction k Subscript upper B Baseline upper T gamma Subscript n Baseline Over upper C Subscript upper F Baseline EndFraction commav2nd ≃2kBT γngmn
π
 ∞
0

1
2F(jω)

2
dω = kBT γn
CF
,
(18) 
where gamma Subscript nγn and gamma Subscript pγp are the noise coefﬁcients of transistors upper M 1M1 (or upper M 2M2) and upper M 3M3, 
respectively. Equations 17 and 18 have been obtained, again, by neglecting the 1/f 
noise contribution of the transistors. The noise properties of a charge preampliﬁer 
are generally expressed in terms of equivalent noise charge (ENC), which is deﬁned 
as

Development of the Analog Front-End Circuit for the CMS Pixel Readout Chip. . .
135
upper E upper N upper C squared equals StartFraction ModifyingAbove v Subscript n Superscript 2 Baseline With quotation dash Over upper G Subscript upper Q Superscript 2 Baseline EndFraction periodENC2 = v2n
G2
Q
.
(19) 
By combining (10) with (14)–(18), it is possible to write 
upper E upper N upper C squared asymptotically equals k Subscript upper B Baseline upper T upper C Subscript upper F Baseline left bracket StartFraction left parenthesis upper C Subscript upper D Baseline plus upper C Subscript upper F Baseline right parenthesis squared Over upper C Subscript upper D Baseline EndFraction StartFraction gamma Subscript i n Baseline Over g Subscript m Sub Subscript i n Subscript Baseline EndFraction StartFraction upper A 0 Over tau Subscript p Baseline EndFraction plus 2 StartFraction g Subscript m Sub Subscript p Subscript Baseline Over g Subscript m Sub Subscript n Subscript Baseline EndFraction gamma Subscript p Baseline plus gamma Subscript n Baseline right bracket periodENC2 ≃kBT CF

(CD + CF )2
CD
γin
gmin
A0
τp
+ 2gmp
gmn
γp + γn
	
.
(20) 
It is worth noticing that, in (20), the ENC depends on the upper A 0 divided by left parenthesis tau Subscript p Baseline g Subscript m Sub Subscript i n Subscript Baseline right parenthesisA0/(τpgmin) ratio, which 
is a constant function of g Subscript m Sub Subscript i ngmin. This means that changing the current biasing the 
preampliﬁer input device and, thus, its transconductance, should not, in theory, have 
an impact on the noise properties of the analog processor. Also, when the front-end 
is coupled to a non-leaky detector, the ratio g Subscript m Sub Subscript p Baseline divided by g Subscript m Sub Subscript ngmp/gmn is close to 1, since transistors 
upper M 1M1 and upper M 3M3, operated in weak inversion, carry the same current upper I Subscript upper K Baseline divided by 2IK/2. On the other 
hand, the transconductance of upper M 3M3 is larger than the one of upper M 1M1 in the presence of 
leakage, leading to a non negligible rise in the ENC. 
2.3 
Threshold Discriminator 
The schematic diagrams of the threshold discriminators integrated in the RD53A 
and RD53B Linear front-ends are shown in Figs. 2 and 3, respectively. The ﬁrst 
stage of the comparator is implemented by means of a transconductance stage, 
which outputs a current, upper I Subscript upper G mIGm, whose polarity depends on the difference between 
upper V Subscript o comma c s aVo,csa, the output of the preampliﬁer, and the global threshold voltage, upper V Subscript t hVth. Such 
a current signal represents the input of the subsequent stage, featuring a Träff 
transimpedenace ampliﬁer (TIA) [11]. As shown in Fig. 1, the  upper V Subscript o comma c primeVo,c′ signal is sent 
to a couple of inverters, which consolidate the logic levels that will be fed to the 
digital circuits for ToT conversion of the input charge signal. 
Fine tuning of the threshold is accomplished by properly setting the TDAC code 
controlling the upper I Subscript t r i mItrim current, drained from the output of the transconductance stage. 
The actual implementation of the tuning DACs integrated in the RD53A and RD53B 
versions of the front-end will be discussed in the next subsection. 
The transfer function, upper T Subscript upper C Baseline left parenthesis s right parenthesisTC(s), of the comparator can be computed as: 
upper T Subscript upper C Baseline left parenthesis s right parenthesis equals StartFraction upper V Subscript o comma c Sub Superscript prime Subscript Baseline Over upper V Subscript o comma c s a Baseline EndFraction asymptotically equals upper G Subscript m Baseline StartFraction upper R Subscript f Baseline Over 1 plus s tau Subscript c comma c l Baseline EndFraction commaTC(s) = Vo,c′
Vo,csa
≃Gm
Rf
1 + sτc,cl
,
(21) 
where 
tau Subscript c comma c l Baseline asymptotically equals StartFraction upper R Subscript f Baseline Over left parenthesis g Subscript m 3 Baseline plus g Subscript m 4 Baseline right parenthesis left parenthesis r Subscript o 3 Baseline parallel to r Subscript o 4 Baseline right parenthesis EndFraction upper C Subscript iτc,cl ≃
Rf
(gm3 + gm4)(ro3 ∥ro4)Ci
(22)

136
L. Gaioni et al.
iin,tia 
Ci 
+ 
Gm 
Vth 
IGm 
M2a 
M2b 
M1b 
M1a 
M3 
Vdd 
M4 
v 
Vo,csa 
TDAC 
Itrim 
Fig. 2 Schematic diagram of the threshold discriminator integrated in the RD53A Linear front-
end 
M2 
M1 
M3 
Vdd 
M4 
Vbias 
M5 
v
iin,tia 
Cm 
Ci 
+ 
Gm 
Vth 
IGm 
Vo,csa 
Itrim 
TDAC 
Fig. 3 Schematic diagram of the threshold discriminator integrated in the RD53B Linear front-end

Development of the Analog Front-End Circuit for the CMS Pixel Readout Chip. . .
137
is the closed-loop time constant associated with the input node of the Träff 
transimpedenace ampliﬁer. In the previous equations, upper G Subscript mGm is the trasconductance 
of the input stage, g Subscript m Sub Subscript igmi and r Subscript o Sub Subscript iroi are the transconductance and the output resistance of 
transistor upper M Subscript iMi, whereas upper C Subscript iCi and upper R Subscript fRf represent, respectively, the input capacitance and 
the equivalent feedback resistor of the TIA. It can be easily shown that the open-loop 
time constant, tau Subscript c comma o lτc,ol, associated with the TIA input is 
tau Subscript c comma o l Baseline equals upper R Subscript f Baseline upper C Subscript i Baseline periodτc,ol = Rf Ci.
(23) 
Hence, the closed-loop time constant is signiﬁcantly faster than the open-loop 
one, provided that left parenthesis g Subscript m 3 Baseline plus g Subscript m 4 Baseline right parenthesis left parenthesis r Subscript o 3 Baseline parallel to r Subscript o 4 Baseline right parenthesis(gm3 +gm4)(ro3 ∥ro4) is large enough, and the negative feedback 
of the TIA improves the timing performance of the comparator. 
The main difference between the comparator integrated in the RD53A and 
RD53B Linear front-end is the lack of diode-connected transistors upper M Subscript 1 bM1b and upper M Subscript 2 bM2b
in the RD53B ﬂavour. This has an impact on the equivalent feedback resistance, 
upper R Subscript fRf , of the transimpedance ampliﬁer. In particular, for the RD53A design, such a 
resistance is given by: 
upper R Subscript f Baseline equals StartLayout Enlarged left brace 1st Row StartFraction 1 Over g Subscript m Sub Subscript 1 a Subscript Baseline EndFraction plus StartFraction 1 Over g Subscript m Sub Subscript 1 b Subscript Baseline EndFraction comma i Subscript i n comma t i a Baseline less than 0 2nd Row StartFraction 1 Over g Subscript m Sub Subscript 2 a Subscript Baseline EndFraction plus StartFraction 1 Over g Subscript m Sub Subscript 2 b Subscript Baseline EndFraction comma i Subscript i n comma t i a Baseline greater than 0 comma EndLayoutRf =
⎧
⎨
⎩
1
gm1a +
1
gm1b , iin,tia < 0
1
gm2a +
1
gm2b , iin,tia > 0,
(24) 
where i Subscript i n comma t i aiin,tia is the input current of the TIA stage, whereas for the RD53B version 
upper R Subscript f Baseline equals StartLayout Enlarged left brace 1st Row StartFraction 1 Over g Subscript m 1 Baseline EndFraction comma i Subscript i n comma t i a Baseline less than 0 2nd Row StartFraction 1 Over g Subscript m 2 Baseline EndFraction comma i Subscript i n comma t i a Baseline greater than 0 period EndLayoutRf =
⎧
⎨
⎩
1
gm1 , iin,tia < 0
1
gm2 , iin,tia > 0.
(25) 
By assuming the same transconductance of the transistors integrated in the feedback 
path of the TIA, it is possible to conclude that the equivalent feedback resistor for 
the RD53B version is a factor of 2 smaller than the one obtained in RD53A. This, 
in turn, means that the time constant tau Subscript c comma c lτc,cl is, ideally, a factor of 2 smaller in the 
RD53B design. Moreover, the lack of upper M Subscript 1 bM1b and upper M Subscript 2 bM2b in the RD53B ﬂavour, which 
were added in RD53A to minimize the current consumption of the TIA gain stage 
(implemented by means of upper M 3M3 and upper M 4M4), extends the current range of i Subscript i n comma t i aiin,tia for 
which the stage operates in the linear region, boosting the response speed of the 
comparator. In order to keep the power consumption of the transimpedance ampliﬁer 
under control, a starving transistor, upper M 5M5, has been added in the RD53B front-end. As 
shown in the test results discussed in the next section, the improved RD53B design 
has a profound impact on the time-walk performance of the front-end. In particular, 
a time-walk smaller than 25 ns (i.e. the LHC bunch crossing period) can be achieved 
with the RD53B analog processor. This, in turn, makes it possible to operate the 
front-end with low in-time thresholds, as requested by RD53 speciﬁcations [12], 
which set a minimum in-time threshold of 1200 electrons (meaning that 50% of 
1200 eSuperscript minus−hits are in time).

138
L. Gaioni et al.
Vref 
IK 
IK/2 
VDDA 
Vo,csa 
M3 
M1
M2 
M5 
M4 
Vth 
M8 
to TIA 
M6
M7 
M9 
VDDA 
IB 
Vth5 
Vth1,2 
VthFE 
Vth4 
Vth8,9 
Vth6,7 
Fig. 4 Schematic digram for the threshold dispersion analysis. The device threshold voltage 
mismatch is modelled by mens of the voltage sources upper Delta upper V Subscript t h Sub Subscript i comma jVthi,j and upper Delta upper V Subscript t h Sub Subscript kVthk
2.4 
Threshold Dispersion Analysis 
Very low threshold dispersion is a must in order to operate the front-end at 
thresholds close to 1000 electrons. As discussed in the next subsection, the threshold 
dispersion is optimized in the Linear front-end by means of an in-pixel, current-
mode tuning DAC. Nonetheless, having a small un-tuned threshold dispersion is, in 
general, strongly desirable, since lower TDAC resolution and power consumption 
are required. In this section the un-tuned threshold dispersion analysis is carried 
out with the aid of Fig. 4, which shows the devices, in the Krummenacher feedback 
network and in the transconductance stage of the comparator, mostly contributing 
to the threshold dispersion. In this analysis, only the threshold voltage mismatch 
between nominally identical transistors will be taken into account in order to 
evaluate the front-end threshold dispersion. In Fig. 4, the mismatch in the devices is 
modelled by means of the following voltage sources: 
• 
.Vth1,2, which models the mismatch in the differential pair upper M 1M1 and upper M 2M2 integrated 
in the Krummenacher feedback; 
• 
.Vth4, which accounts for the threshold variations in the transistor, upper M 4M4, generat-
ing the upper I Subscript upper K Baseline divided by 2IK/2 in the Krummenacher feedback; 
• 
.Vth5, modeling the mismatch in upper M 5M5, which acts as the tail current generator upper I Subscript upper KIK
for the differential pair upper M 1M1 and upper M 2M2; 
• 
.Vth6,7, which models the mismatch for the input transistors of the comparator;

Development of the Analog Front-End Circuit for the CMS Pixel Readout Chip. . .
139
• 
.Vth8,9, modeling the mismatch in the current mirror load of the comparator 
input stage. 
According to the well-know model described in [13], it is possible to write the 
variances 
sigma squared left parenthesis upper Delta upper V Subscript t h Sub Subscript i comma j Subscript Baseline right parenthesis equals StartFraction upper A Subscript upper V Sub Subscript t h Subscript Superscript 2 Baseline Over upper W Subscript i comma j Baseline upper L Subscript i comma j Baseline EndFraction commaσ 2(Vthi,j ) =
A2
Vth
Wi,jLi,j
,
(26) 
sigma squared left parenthesis upper Delta upper V Subscript t h Sub Subscript k Subscript Baseline right parenthesis equals one half StartFraction upper A Subscript upper V Sub Subscript t h Subscript Superscript 2 Baseline Over upper W Subscript k Baseline upper L Subscript k Baseline EndFraction commaσ 2(Vthk) = 1
2
A2
Vth
WkLk
,
(27) 
where upper Delta upper V Subscript t h Sub Subscript i comma jVthi,j is the threshold difference between matched transistors upper M Subscript iMi and upper M Subscript jMj
(upper M 1M1-upper M 2M2, upper M 6M6-upper M 7M7 and upper M 8M8-upper M 9M9) and upper Delta upper V Subscript t h Sub Subscript kVthk is the difference between the actual 
threshold voltage for an individual device upper M Subscript kMk (upper M 4M4 and upper M 5M5) and its nominal 
threshold. upper A Subscript upper V Sub Subscript t hAVth is a process dependent parameter, commonly provided by the 
foundry. 
The front-end threshold dispersion, referred to the comparator input, can be 
modelled by means of a voltage source upper Delta upper V Subscript t h Sub Subscript upper F upper EVthFE, whose standard deviation is given 
by 
sigma left parenthesis upper Delta upper V Subscript t h Sub Subscript upper F upper E Subscript Baseline right parenthesis equals StartRoot sigma squared left parenthesis upper Delta upper V Subscript t h Sub Subscript upper C upper S upper A Subscript Baseline right parenthesis plus sigma squared left parenthesis upper Delta upper V Subscript t h Sub Subscript upper C upper O upper M upper P Subscript Baseline right parenthesis EndRoot commaσ(VthFE) =

σ 2(VthCSA) + σ 2(VthCOMP ),
(28) 
with sigma left parenthesis upper Delta upper V Subscript t h Sub Subscript upper C upper S upper A Subscript Baseline right parenthesisσ(VthCSA) being the threshold dispersion contributed by the charge sensitive 
ampliﬁer, and sigma left parenthesis upper Delta upper V Subscript t h Sub Subscript upper C upper O upper M upper P Subscript Baseline right parenthesisσ(VthCOMP ) the one associated with the comparator. The ﬁrst term 
in (28) can be shown to be 
StartLayout 1st Row 1st Column sigma squared left parenthesis upper Delta upper V Subscript t h Sub Subscript upper C upper S upper A Subscript Baseline right parenthesis equals 2nd Column sigma squared left parenthesis upper Delta upper V Subscript t h Sub Subscript 1 comma 2 Subscript Baseline right parenthesis plus 4 StartFraction g Subscript m 5 Superscript 2 Baseline Over g Subscript m 2 Superscript 2 Baseline EndFraction sigma squared left parenthesis upper Delta upper V Subscript t h 5 Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column plus 4 StartFraction g Subscript m 4 Superscript 2 Baseline Over g Subscript m 2 Superscript 2 Baseline EndFraction sigma squared left parenthesis upper Delta upper V Subscript t h 4 Baseline right parenthesis comma EndLayout
σ 2(VthCSA) =σ 2(Vth1,2) + 4
g2
m5
g2m2
σ 2(Vth5)
+ 4
g2
m4
g2m2
σ 2(Vth4),
(29) 
whereas the second one can be written, assuming linear operation for the compara-
tor, as 
sigma squared left parenthesis upper Delta upper V Subscript t h Sub Subscript upper C upper O upper M upper P Subscript Baseline right parenthesis equals sigma squared left parenthesis upper Delta upper V Subscript t h Sub Subscript 6 comma 7 Subscript Baseline right parenthesis plus StartFraction g Subscript m 8 Superscript 2 Baseline Over g Subscript m 6 Superscript 2 Baseline EndFraction sigma squared left parenthesis upper Delta upper V Subscript t h Sub Subscript 8 comma 9 Subscript Baseline right parenthesis commaσ 2(VthCOMP ) = σ 2(Vth6,7) +
g2
m8
g2m6
σ 2(Vth8,9),
(30) 
with g Subscript m Sub Subscript igmi being the transconductance of the transistor upper M Subscript iMi. The front-end input-
referred threshold dispersion, sigma left parenthesis upper Delta upper Q Subscript t h Baseline right parenthesisσ(Qth), can thus be computed by dividing (28) by  
the charge sensitivity of the preampliﬁer:

140
L. Gaioni et al.
sigma left parenthesis upper Delta upper Q Subscript t h Baseline right parenthesis equals StartFraction sigma left parenthesis upper Delta upper V Subscript t h Sub Subscript upper F upper E Subscript Baseline right parenthesis Over upper G Subscript upper Q Baseline EndFraction periodσ(Qth) = σ(VthFE)
GQ
.
(31) 
According to (26) and (27), a way to reduce the un-tuned threshold dispersion is to 
increase the gate area of the transistors. This should actually be done carefully, since 
increasing the size of the Krummenacher feedback devices, may lead to instabilities 
in the preampliﬁer. In particular, by increasing the size of upper M 1M1, upper M 2M2 and upper M 5M5, the  
capacitance upper C Subscript upper ACA (described in section II.A) gets larger, pushing the time constant 
tau 3τ3 towards tau 2τ2 and, in the end, degrading the phase margin of the preampliﬁer. 
Moreover, larger comparator transistors, may affect the value of the capacitance 
upper C Subscript iCi shunting the transimpedance ampliﬁer input, slowing down the response speed 
of the comparator. Hence, a compromise between threshold dispersion, speed and 
stability has to be found. 
2.5 
Threshold Tuning DAC 
The ﬁne-tuning of the threshold is addressed by means of a current-mode DAC 
generating a current, upper I Subscript t r i mItrim, at the output of the transconductance stage of the 
comparator, as shown in Figs. 2 and 3. Figures 5 and 6 show the schematic of the 
TDACs integrated in the two front-ends. Both the analog processors implement a 
binary weighted DAC architecture with a resolution of 4 bits for RD53A and 5 bits 
for RD53B. While cascoded current mirrors were used in the RD53A version of the 
TDAC, a more compact design has been laid out in the RD53B front-end, featuring 
regular current mirrors. The DAC switches (upper M Subscript bMb) are implemented by means of 
NMOS devices for both the front-end ﬂavors. NMOS devices, at extremely high 
levels of total ionizing doses, are indeed more radiation tolerant with respect to the 
PMOS counterpart for the 65 nm technology adopted in the design of the Linear 
front-end. 
It can be easily shown that the threshold variation, upper Delta upper Q Subscript t hQth, referred to the 
preampliﬁer input, in response to a change upper Delta upper I Subscript t r i mItrim of the tuning DAC output is 
given by Gaioni et al. [14]: 
upper Delta upper Q Subscript t h Baseline equals StartFraction upper Delta upper I Subscript t r i m Baseline Over upper G Subscript m Baseline EndFraction StartFraction 1 Over upper G Subscript upper Q Baseline EndFraction periodQth = Itrim
Gm
1
GQ
.
(32) 
The dynamic range of the tuning DAC is set by the upper I Subscript upper L upper D upper A upper CILDAC current, mirrored in 
the pixel cells from the matrix periphery. The partial re-design implemented in the 
RD53B version of the TDAC, was driven by tuning issues emerged, in speciﬁc 
conditions, during the test campaign on the RD53A demonstrator. Speciﬁcally, a 
non-linear TDAC transcharacteristics has been measured for irradiated samples of 
the RD53A chip operated at temperatures around minus−20Superscript ring◦C. In these conditions, the 
TDAC has to be biased with a large upper I Subscript upper L upper D upper A upper CILDAC current, to compensate for a very large 
threshold dispersion. However, in the RD53A design, a large TDAC bias current

Development of the Analog Front-End Circuit for the CMS Pixel Readout Chip. . .
141
Unit Cell 
B0
B1
B2
B3 
Itrim 
M3 
M4 
M1 
M2 
VX 
Ma1 
Ma2 
Vb1 Vb2 Vdd 
out
Bi 
Mb 
Unit 
cell 
Vb1 
Bi 
Vdd 
out 
Vb2 
Unit 
cell 
x2 
Vb1 
Bi 
Vdd 
out 
Vb2 
Unit 
cell 
x4 
Vb1 
Bi 
Vdd 
out 
Vb2 
Unit 
cell 
x8 
Vb1 
Bi 
Vdd 
out 
Vb2 
ILDAC 
M6 
M5 
Vdd 
Fig. 5 Block diagram of the threshold tuning DAC included in the RD53A front-end 
generates a voltage upper V Subscript upper XVX at the drain of upper M 2M2 that is sufﬁcient to drive switch transistors 
out of the triode region. On the other hand, the removal of cascode structures in the 
RD53B design guarantees the operation of the switches in the triode region for an 
extend range of upper I Subscript upper L upper D upper A upper CILDAC values. Moreover, additional readout logic was added in the 
RD53B pixel cell thanks to the more compact TDAC layout. 
3 
Test Results 
In preparation for the June 2021 submission of the CMS pixel readout ASIC (the 
pre-production chip), a small prototype integrating the RD53A and RD53B versions 
of the Linear front-end has been submitted and tested. The prototype, referred to as 
FELin chip, has been characterized both before and after exposure to TIDs of X-rays 
up to 1 Grad(SiOSubscript 22). The prototype chip is brieﬂy described and the key ﬁndings of 
the testing activities are covered in the following sections.

142
L. Gaioni et al.
ILDAC 
M3 
Itrim 
M2
M1 
Vx 
Unit 
cell 
Vb 
Bi 
Vdd 
out 
Unit 
cell 
x2 
Vb 
Bi 
Vdd 
out 
Unit 
cell 
x4 
Vb 
Bi 
Vdd 
out 
Unit 
cell 
x8 
Vb 
Bi 
Vdd 
out 
Unit 
cell 
x16 
Vb 
Bi 
Vdd 
out 
Unit Cell 
Ma 
Mb 
Vb 
Bi 
Vdd 
out 
B0
B1
B2
B3
B4 
Vdd 
Fig. 6 Block diagram of the threshold tuning DAC included in the RD53B front-end 
3.1 
The FELin Chip 
The FELin chip, shown in Fig. 7, integrates a matrix of 16times×16 readout channels 
featuring a pitch of 50 times× 50 normal muμm. The basic brick of the matrix is a single structure 
of 2times×2 channels laid out in such a way to have a central analog region, surrounded 
by the digital logic. This is the so-called “analog island” structure already adopted 
in the design of the RD53A demonstrator. The matrix is split in two 8times×16 sub-
matrices, featuring the two versions of the Linear front-end. The readout chain is 
equipped with a calibration circuit, which includes a 8.5 fF injection capacitance, 
providing conﬁgurable test signals at the preampliﬁer input. Such a node is also 
connected to a pad, featuring the same size of the one integrated in the ﬁnal CMS 
readout chip, for sensor bump bonding. Two capacitors of 50 and 100 fF, emulating 
the presence of an actual sensor, can be selectively switched to the preampliﬁer input 
and allow for four possible setups (namely 0, 50, 100 and 150 fF). A programmable 
switch may also be used to connect the preampliﬁer input to a detector leakage 
emulating circuit, implemented by means of an NMOS current mirror. 
Different samples of the FELin chip were tested before and after exposure to 
radiation, with TIDs up to 1 Grad(SiOSubscript 22), by means of an FPGA-based setup and 
a LabView data acquisition system. The main test results are presented in the 
following subsections.

Development of the Analog Front-End Circuit for the CMS Pixel Readout Chip. . .
143
Fig. 7 Microphotograph of the FELin chip, which integrates a 16 times× 16 matrix with RD53A and 
RD53B front-end channels 
3.2 
Results Before Irradiation 
The front-end noise performance has been evaluated in terms of equivalent noise 
charge, which has been measured by means of charge scans on the readout channels, 
along with threshold data. During a charge scan, the front-end input signal, upper Q Subscript i nQin, 
is made to change within a suitable range, and the comparator hit efﬁciency is 
measured. The function eta Subscript cηc, which is deﬁned as 
eta Subscript c Baseline equals one half left bracket 1 plus e r f left parenthesis StartFraction upper Q Subscript i n Baseline minus mu Over StartRoot 2 EndRoot sigma EndFraction right parenthesis right bracket commaηc = 1
2

1 + erf
Qin −μ
√
2σ

,
(33) 
may be used to ﬁt the efﬁciency curves. The front-end threshold and equivalent 
noise charge are represented by the ﬁtting parameters muμ and sigmaσ, respectively. As 
an example, Fig. 8 shows the efﬁciency curves (commonly referred to as s-curves) 
acquired on the sub-matrix featuring the RD53B version of the front-end. The data 
shown in the plot was obtained at room temperature after the ﬁne-tuning of the 
threshold to a level close to 1100 electrons, with a 50 fF capacitance shunting 
the CSA input. From the ﬁtting of such a family of curves, the data shown in 
Figs. 9 and 10 were obtained. In particular, the histogram in Fig. 9 shows the 
threshold distribution for the RD53B matrix, with a mean value close to 1125 
electrons and a standard deviation, referred to as threshold dispersion, around 29

144
L. Gaioni et al.
-0.2 
0 
0.2 
0.4 
0.6 
0.8 
1 
1.2 
0
500
1000
1500
2000 
Comparator hit efficiency 
Input charge [e- ] 
Fig. 8 Measured s-curves as obtained for the RD53B Linear front-end after threshold tuning at 
around 1100 electrons. The s-curves are subsequently ﬁtted with erf function to compute ENC 
and threshold 
electrons r.m.s. On the other hand, Fig. 10 shows the ENC distribution, with a mean 
value close to 80 electrons r.m.s. 
Figure 11 shows the mean ENC for different values of the detector capacitor, upper C Subscript upper DCD, 
for the two versions of the front-end, with the height of the error bars being equal to 1 
standard deviation. The equivalent noise charge lies in a range between 60 electrons 
r.m.s., with no capacitors connected to the preampliﬁer input, and 130 electrons 
r.m.s. for upper C Subscript upper DCD equal to 150 fF. For a detector capacitance of 50 fF, compatible to the 
3D sensors that are planned to be used in the innermost layer of the CMS tracker, a 
noise close to 85 electrons r.m.s. was measured for both the ﬂavours of the Linear 
front-end. Figure 12 shows the ENC for a detector leakage current varying between 
0 and 20 nA. As discussed in section II.B, the larger the detector leakage, the larger 
the g Subscript m p Baseline divided by g Subscript m ngmp/gmn ratio in (20), which results in an increased equivalent noise charge, as 
shown in the ﬁgure. The ENC increase was found to be somewhat smaller in the 
RD53B ﬂavour. 
The time-walk improvement brought about by the RD53B design is clearly visible in 
Fig. 13, where the time-walk is shown as a function of an input charge, upper Q Subscript i nQin, ranging 
from 1150 electrons (i.e. the threshold level) to 1600 electrons. Speciﬁcally, for the 
unirradiated sample which has been tested, the RD53B ﬂavor yielded a time-walk

Development of the Analog Front-End Circuit for the CMS Pixel Readout Chip. . .
145
0 
5 
10 
15 
20 
25 
30 
35 
40 
1000
1050
1100
1150
1200
1250
1300 
Counts 
Threshold [e- ] 
μ = 1125.3 e-
σ = 29.29 e r.m.s. 
Fig. 9 Threshold distribution (solid blue), and its ﬁtting (dashed red), for the RD53B Linear front-
end operated at a threshold close to 1100 electrons, with a detector emulating capacitor of 50 fF. 
The plot also reports threshold mean and standard deviation, known as threshold dispersion 
of 22 ns, whereas around 33 ns were measured for the RD53A version of the front-
end. A smaller time-walk dispersion was detected for the RD53B version: this is 
compatible with a reduced time constant tau Subscript c comma c lτc,cl (discussed in section II.C), which 
translates in a faster rising edge of the signal, upper V prime Subscript o comma cV ′
o,c, triggering the comparator output 
inverters. 
The behaviour of the Time-over-Treshold is shown in Fig. 14, again, for  upper Q Subscript i nQin
ranging from the threshold level up to 30,000 electrons. According to the RD53 
requirements, the bias current, upper I Subscript upper KIK, in the Krummenacher feedback network was 
tuned in such a way to convert 6000 electrons input signal into a ToT of about 
130 ns. A linear response has been measured for both the analog processors for an 
input charge larger than 2000 electrons, with similar ToT dispersions. 
The improvement in the threshold tuning capabilities associated with the RD53B 
design is visible in Fig. 15. The plot shows the tuning DAC dynamic range for 
the two front-ends, measured at a temperature around minus−20Superscript ring◦C, as a function of the 
upper I Subscript upper L upper D upper A upper CILDAC current. The dynamic range is expected to increase almost linearly with such 
a current: this is actually the case of the RD53B front-end, whereas a non-linear 
behavior was detected for the RD53A one, with a dynamic range saturating to a 
value close to 1700 electrons.

146
L. Gaioni et al.
0 
5 
10 
15 
20 
25 
50
60
70
80
90
100
110
120 
Counts 
Equivalent Noise Charge [e r.m.s. ] 
μ = 80.5 e r.m.s. 
σ = 7.50  e r.m.s. 
Fig. 10 Noise distribution (solid blue), and its ﬁtting (dashed red), for the RD53B Linear front-
end operated at a threshold close to 1100 electrons, with a detector emulating capacitor of 50 fF 
3.3 
Results After Irradiation 
In order to evaluate the radiation hardness of the RD53A and RD53B Linear front-
ends, one sample of the FELin chip has been exposed to TIDs up to 1 Grad(SiOSubscript 22) 
of X-rays. A Seifert RP149 machine was used to irradiate the prototype chip at 
the CERN EP-ESE facility, with a temperature that was kept close to minus−10Superscript ring◦C, 
and a dose rate of 11 Mrad(SiOSubscript 22)/h. During irradiation, simple charge scans were 
continuously running to generate analog and digital activities in the chip. The matrix 
was biased with the default settings before the irradiation, with a threshold close to 
1000 electrons. During the irradiation, the bias conditions were not changed, while 
a ﬁne-tuning of the threshold has been performed at each stage of the irradiation 
process. 
The ENC as a function of the TID is shown in Fig. 16, for an emulated 
detector capacitance of 50 fF. Noise was also measured after 1 day annealing at 
room temperature at the end of the irradiation campaign. As shown in the plot, 
radiation has a little impact on the noise properties of the front-end, with moderate

Development of the Analog Front-End Circuit for the CMS Pixel Readout Chip. . .
147
Fig. 11 Equivalent noise charge as a function of the detector capacitance for the RD53A and 
RD53B version of the Linear front-end. The height of the error bars is equal to 1 standard deviations 
increases (close to 12 and 6% for RD53A and RD53B, respectively) of the ENC 
at 1 Grad(SiOSubscript 22). It is worth noticing that ENC data, here, is relevant to a chip not 
connected to a sensor. The expected increase of the detector leakage current with 
the TID, would actually translate in a more pronounced increase in the front-end 
ENC. A partial recover in the ENC after annealing may be expected: nonetheless, 
the variation of the measured ENC after 1 day annealing is not signiﬁcant. This 
may be explained considering that the measure of the noise after annealing was 
performed at room temperature, whereas the ENC data during irradiation was 
gathered at minus−10Superscript ring◦C. 
Figure 17 shows the threshold dispersion of the front-ends as a function of the 
total ionizing dose. The plot shows the data as obtained before (un-tuned) and after 
(tuned) the ﬁne-tuning of the threshold. It is worth noticing that the tuned-threshold 
dispersion is roughly a factor of 2 smaller for the RD53B front-end, which features 
an extra TDAC trimming bit, compared to the RD53A counterpart. The tuned 
threshold dispersion for the RD53B ﬂavour turns out to be close to 30 electrons

148
L. Gaioni et al.
Fig. 12 Equivalent noise charge as a function of the detector leakage current for the RD53A and 
RD53B version of the Linear front-end. The ENC is measured for a detector capacitance of 50 fF. 
The height of the error bars is equal to 1 standard deviations 
r.m.s. up to a TID of 400 Mrad(SiOSubscript 2 Baseline right parenthesis2). A moderate increase is detected in the range 
400 Mrad(SiOSubscript 2 Baseline right parenthesis2)–1 Grad(SiOSubscript 2 Baseline right parenthesis2). 
A key ﬁgure of merit of the front-end, hereafter referred to as rhoρ, is the  
quadrature sum of the tuned-threshold dispersion and the ENC. According to RD53 
speciﬁcations [12], such a parameter should be smaller than 126 electrons r.m.s. in 
order not to exceed a noise occupancy level of 10Superscript negative 6−6. Figure 18 shows rhoρ as a function 
of TID for the two versions of the front-end. Notice that RD53A analog processor 
breaks the 10Superscript negative 6−6 limit for TIDs larger than around 200 Mrad(SiOSubscript 2 Baseline right parenthesis2), whereas the 
curve relevant to the RD53B one lays always below such a limit. 
The time-walk for the two front-end ﬂavours, as measured for an input signal 
close the threshold, is shown in Fig. 19 as a function of the TID. Such a parameter 
is, in general, signiﬁcantly smaller for the RD53B front-end, which features a time-
walk around 22 ns before irradiation, with a marginal increase for TIDs larger 
than 200 Mrad(SiOSubscript 22). The time-walk slightly exceeds the 25 ns limit for TIDs 
approaching 1 Grad(SiOSubscript 22). On the other hand, the time-walk measured for the 
RD53A analog processor, is always well above 25 ns, with a maximum around 45 ns

Development of the Analog Front-End Circuit for the CMS Pixel Readout Chip. . .
149
0 
5 
10 
15 
20 
25 
30 
35 
40 
1100
1200
1300
1400
1500
1600 
RD53A 
RD53B 
Timewalk [ns] 
Input charge [e- ] 
Fig. 13 Time-walk for RD53A and RD53B front-ends, as a function of the input signal, for a 
threshold close to 1150 electrons. The time-walk has been measured at a temperature of minus−10Superscript ring◦C. 
The height of the error bars is equal to 1 standard deviations 
achieved at 1 Grad(SiOSubscript 22). A partial recovery was detected, for both the front-ends, 
after 1 day annealing at room temperature. 
A general conclusion which is possible to draw after discussing the performance 
before and after irradiation of the FELin chip, is that the effects of the radiation on 
the behaviour of the RD53B Linear front-end are pretty limited. This is actually in 
line with the radiation tolerance properties of the 65 nm technology [15, 16] which 
was used for the design of the chip. 
4 
Conclusions 
The CERN RD53 collaboration is designing pixel readout chips for the phase-
II upgrades of the CMS and ATLAS. In 2017, the collaboration submitted the 
large-scale chip, called RD53A, including three versions of the analog front-end, 
referred to as Synchronous, Linear and Differential front-ends. After an intensive

150
L. Gaioni et al.
0 
200 
400 
600 
800 
0
5000 
10000 
15000 
20000 
25000 
30000 
RD53A 
RD53B 
Time-over-Threshold [ns] 
Input charge [e- ] 
Fig. 14 Time-Over-Threshold for RD53A and RD53B front-ends, as a function of the input signal, 
for a threshold close to 1000 electrons. The height of the error bars is equal to 1 standard deviations 
test campaign on the three readout channels, the Linear analog processor has 
been selected for the integration into the production chip for the CMS pixels. 
In preparation to the submission of the pre-production (RD53B) and production 
(RD53C) chips, a small prototype ASIC, including the RD53A and RD53B version 
of the Linear front-end, has been fabricated and tested. The paper described the 
architecture of the Linear front-end and highlighted the design improvements 
that have been implemented in the RD53B ﬂavour. The test of a prototype chip, 
integrating a matrix of 16 times× 16 pixels with RD53A and RD53B readout channels, 
was successful, and very encouraging results were obtained for the RD53B Linear 
front-end, even for TIDs up to 1 Grad(SiOSubscript 22). 
The characterization of the CMS pre-production chip is now in progress in 
the framework of the RD53 collaboration, with very promising results, and the 
submission of the CMS RD53C chip is foreseen for mid 2023.

Development of the Analog Front-End Circuit for the CMS Pixel Readout Chip. . .
151
1000 
1500 
2000 
2500 
3000 
3500 
12
14
16
18
20
22
24 
RD53A 
RD53B 
TDAC dynamic range [e- ] 
ILDAC current [uA] 
Fig. 15 Dynamic range of the threshold tuning DAC, as a function of the upper I Subscript upper L upper D upper A upper CILDAC current, for the 
two versions of the front-end. A saturation effect is visible for the RD53A ﬂavour 
60 
70 
80 
90 
100 
110 
120 
0.1
1
10
100
1000
10000 
RD53A 
RD53B 
ENC [e r.m.s.] 
TID [Mrad] 
pre-rad
1d anneal 
Fig. 16 Equivalent noise charge for the RD53A and RD53B front-ends, as a function of TID. The 
ENC was measured for a detector capacitance of 50 fF

152
L. Gaioni et al.
0 
100 
200 
300 
400 
500 
600 
0.1
1
10
100
1000
10000 
RD53A 
RD53B 
C 
D 
Threshold dispersion [e r.m.s.] 
TID [Mrad] 
pre-rad
1d anneal 
un-tuned 
tuned 
Fig. 17 Un-tuned and tuned threshold dispersions for the RD53A and RD53B front-ends, as a 
function of TID 
60 
80 
100 
120 
140 
160 
180 
200 
0.1
1
10
100
1000
10000 
RD53A 
RD53B 
ρ [e r.m.s.] 
TID [Mrad] 
pre-rad
1d anneal 
ρ        10-6 noise occupancy level 
Fig. 18 
rhoρ parameter, deﬁned as the quadrature sum of tuned threshold dispersion and ENC, as a 
function of the TID for the two versions of the Linear front-end

Development of the Analog Front-End Circuit for the CMS Pixel Readout Chip. . .
153
20 
25 
30 
35 
40 
45 
50 
0.1
1
10
100
1000
10000 
RD53A 
RD53B 
Time-walk @ threshold [ns] 
TID [Mrad] 
pre-rad
1d anneal 
25 ns limit 
Fig. 19 Time-walk for an input signal close to the threshold, as function of TID, for the two 
versions of the Linear front-end 
Acknowledgments The authors would like to acknowledge the valuable assistance of Giulio 
Borghello during the CERN irradiation campaign. They also like to thank the RD53 members 
for their support during the design and testing phase of the chip described in the paper. The authors 
are in debt with Giulio Dellacasa, Natale Demaria, Sara Garbolino and Francesco Rotondo, from 
INFN Torino, who took care of the integration of the FELin chip and of the development of the 
data acquisition system. 
References 
1. Rossi, A., et al. (2022). The CMS tracker for the high luminosity LHC. Nuclear Instruments 
and Methods, 1048, 167950. 
2. Calderini, G., et al. (2022). The ATLAS ITk detector for high luminosity LHC upgrade. 
Nuclear Instruments and Methods, 1040, 167048. 
3. Steinbrück, G., et al. (2020). Development of planar pixel sensors for the CMS inner tracker at 
the high-luminosity LHC. Nuclear Instruments and Methods, 978, 164438. 
4. Meschini, M., et al. (2020). Radiation resistant innovative 3D pixel sensors for the CMS 
upgrade at the high luminosity LHC. Nuclear Instruments and Methods, 978, 164429. 
5. RD53 Web Site. http://rd53.web.cern.ch/rd53/ 
6. Marconi, S., et al. (2019). Design implementation and test results of the RD53A, a 65 nm large 
scale chip for next generation pixel detectors at the HL-LHC. In 2018 IEEE Nuclear Science 
Symposium and Medical Imaging Conference Proceedings, 18973028. 
7. The Tracker Group of the CMS Collaboration. (2021). Comparative evaluation of analogue 
front-end designs for the CMS inner tracker at the high luminosity LHC. Journal of Instru-
mentation, 16, P12014.

154
L. Gaioni et al.
8. Gaioni, L., et al. (2021). Optimization of the 65-nm CMOS linear front-end circuit for the CMS 
pixel readout at the HL-LHC. IEEE Transactions on Nuclear Science, 68(11), 2682–2692. 
9. Krummenacher, F. (1991). Pixel detectors with local intelligence: an IC designer point of view. 
Nuclear Instruments and Methods, 305(3), 527–532. 
10. Tsividis, Y. P. (1999). Operation and modeling of the MOS transistor (2nd ed.). New York: 
McGraw-Hill. 
11. Träff, H. (1992). Novel approach to high speed CMOS current comparators. Electronics 
Letters, 28(3), 310–312. https://doi.org/10.1049/el:19920192 
12. RD53A integrated circuit speciﬁcations. https://cds.cern.ch/record/2113263/ﬁles/RD53A_ 
specs_V3_2.pdf 
13. Pelgrom, M., et al. (1989). Matching properties of MOS transistors. IEEE Journal of Solid-
State Circ, 24(2), 1433–1439. 
14. Gaioni, L., et al. (2020). Threshold tuning DACs for pixel readout chips at the high luminosity 
LHC. Nuclear Instruments and Methods, 969, 164025. 
15. Krohn, M., et al. (2015). Radiation tolerance of 65 nm CMOS transistors. Journal of 
Instrumentation, 10, P12007. 
16. Borghello, G., et al. (2021). Ionizing radiation damage in 65 nm CMOS technology: inﬂuence 
of geometry, bias and temperature at ultra-high doses. Microelectronics Reliability, 116, 
114016.

A Readout Electronic System for a 3D
Position-Sensitive CdZnTe Gamma-Ray
Spectrometer Based on the CPRE10-32
Readout ASIC
Tianze Chen, Xiaohui Li, Ke Wang, CunFeng Wei, Lei Shuai, Xiaopan Jiang,
Na Wang, Mian Wang, and Long Wei
1
Introduction
Semiconductor detectors are widely used in X-ray and γ-ray detection. Among a
series of semiconductor materials, the most commonly used materials are Si, Ge,
GaAs, HgI2, CdZnTe, et al. Due to the physical properties of CdZnTe, nuclear
detection and imaging instruments based on CdZnTe (CZT) detectors have been
used in the ﬁelds of homeland security, medical imaging, astronomical observations,
and physical research. The research on the CZT began from the 1990s and has
achieved many efforts.
CZT is a semiconductor material with an average atomic number of 49.1 and a
density of 5.78 g/cm3, which makes it good for blocking X-ray and gamma rays. The
band gap of CZT is 1.57 eV, which leads to a high electrical resistivity up to1010 
cm.Extensive researches on CZT detectors have led to different types of detectors
being designed, among which pixelated detectors are widely used due to the high
T. Chen · C. Wei · M. Wang · L. Wei ()
Institute of High Energy Physics, Chinese Academy of Sciences, Beijing, China
School of Nuclear Science and Technology, University of Chinese Academy of Sciences, Beijing,
China
Jinan Laboratory of Applied Nuclear Science, Jinan, China
e-mail: weil@ihep.ac.cn
X. Li · L. Shuai · X. Jiang
Institute of High Energy Physics, Chinese Academy of Sciences, Beijing, China
Jinan Laboratory of Applied Nuclear Science, Jinan, China
K. Wang · N. Wang
Institute of High Energy Physics, Chinese Academy of Sciences, Beijing, China
State Key Laboratory of Particle Detection and Electronics, Institute of High Energy Physics,
Chinese Academy of Sciences, Beijing, China
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024
C. Hansson, K. (Kris) Iniewski (eds.), X-ray Photon Processing Detectors,
https://doi.org/10.1007/978-3-031-35241-6_8
155

156
T. Chen et al.
energy resolution and the capability of acquiring the depth of interaction. To acquire
a better energy resolution, He et al. [1] proposed the concept of the 3-D position-
sensitive CZT (3D-CZT) detector. The depth of interaction (DOI) information of
the case inside the detector is the important information which we should focus
on. There are two methods to perform depth measurements: cathode/anode ratio for
single interaction events [2] and electron drift time for multiple interaction events
[3]. By acquiring energy and depth data, the energy resolution is improved through
3-D corrections. Meanwhile, the energy and depth information make it possible to
implement Compton scatter imaging with a single pixelated detector [4].
In recent years, Kromek, Redlen and, other companies have focused their
attention on the growth of CZT materials and the production of detectors. The ASIC
chips, which are used in 3D-CZT detectors, include VASTAT from IDEAS [5] and
H3D from Brookhaven National Laboratory [6] and so on.
Based on a CPRE10-32 readout application speciﬁc integrated circuit (ASIC) [7],
we designed a readout electronic system which is used for 3D-CZT detectors. This
work also includes some researches on the way to achieve a better electronic noise
performance. It is the ﬁrst time to use and verify the new CPRE10-32 ASIC. This
work is a prototype of the Compton imaging system of which every part is designed
by ourselves, and it can be updated according to our demands. The result of the
experiment could also become the references for other related designs. Experiment
results of energy and time information demonstrate that the readout electronic
system can meet the needs of Compton imaging. The experiment of Compton scatter
imaging shows that the system has the ability to realize the Compton imaging.
The three main parts of the readout electronic system include hardware basics,
FPGA ﬁrmware and PC software. The depth correction using the depth of inter-
action is included in the PC software. This work is a complete system foundation
for the Compton scatter imaging. More research would be conducted based on this
readout electronic system.
2
Compton Scatter Imaging Using 3D-CZT
A schematic of the 3D-CZT detector and the typical Compton scattering case inside
the detector is shown in Fig. 1. A normal Compton scattering event will cause two
interactions inside the detector, whose energy will be absorbed by two pixels in most
situations. By using energy E1 and E2 of two pixels, the Compton scattering angle
can be calculated. Then the conical surface can be determined in 3D space using
the angle and the interaction depth Z1 and Z2 of two pixels. The Compton image
can be reconstructed through multiple conical surfaces. The Compton energies and
scattering angle are related as in Eqs. (1 and 2).
StartLayout 1st Row upper E 0 equals upper E 1 plus upper E 2 EndLayoutE0 = E1 + E2
(1)

A Readout Electronic System for a 3D Position-Sensitive CdZnTe Gamma-Ray. . .
157
Fig. 1 (a) Pixelated CZT electrode structure. (b) Schematic diagram of the interaction of Compton
events with materials inside the CZT detector
StartLayout 1st Row cosine theta equals 1 minus StartFraction m Subscript e Baseline c squared dot left parenthesis upper E 0 minus upper E 2 right parenthesis Over upper E 0 dot upper E 2 EndFraction EndLayout cos θ = 1 −mec2· (E0 −E2)
E0· E2
(2)
We can ﬁnd that Compton scatter imaging demands the energy and depth data of the
pixels interacted by photon. The method of acquiring energy information is similar
between different types of detectors, but the method of acquiring depth information
varies. The method of 3D-CZT detector is discussed here. As a normal Compton
scattering event will interact with two pixels, the readout electronic system would
read out the energy and time information of these two pixels. The depth data can
be calculated using electron drift time. After acquiring the energy and depth data
of two pixels, Compton scattering imaging can be achieved. With the requirement
of Compton scatter imaging using 3D-CZT, the readout electronic can be designed
now.
3
Depth of Interaction
3.1
C/A Ratio
The type of the 3D-CZT detector mostly used is the Single-polarity charge sensing
detector. The depth of interaction can be obtained by acquiring the signals from the
cathode and the anode for each gamma-ray event. The weighting potentials of these
two kinds of electrodes are different. According to the Shockley–Ramo theorem,
the signals of the cathode and the anode can be related to Eqs. (3 and 4), where the
e0 is the charge of electron and the Z is the distance off the anode.
StartLayout 1st Row upper Q Subscript cathode Baseline equals upper N e 0 asterisk upper Z EndLayoutQcathode = Ne0 ∗Z
(3)
StartLayout 1st Row upper Q Subscript anode Baseline equals upper N e 0 EndLayoutQanode = Ne0
(4)

158
T. Chen et al.
Therefore, the C/A ratio can be calculated, and the result is Z. This result shows
that the depth of interaction only depends on the signal of the cathode and the
anode. Although there are some differences between theory and the reality, it can
still provide the way to determine the depth of interaction z that it is related to the
C/A ratio. The only problem is that the C/A ratio cannot be used in Compton Scatter
Imaging.
3.2
Electron Drift Time
When there is more than one pixel motivated in the array, the C/A ratio cannot
obtain the depth of interaction any more. As the Compton scatter imaging is the
ﬁnal purpose, a typical Compton scattering case would be discussed here which is
shown in Fig. 2. Assuming that the electron would drift at a constant velocity inside
the detector, the drift time can represent the depth of interaction. The cathode is
always the ﬁrst to trigger the readout electronics, then followed by the two anodes.
Using the fast-shaping circuit, we will get two data of time Ta and Tb which are
shown in Fig. 3. The functional relationship between electron drift time T and the
depth of interaction Z can be obtained by calibration. It is possible for us to acquire
the depth data by obtain the electron drift time data in multiple-pixels interaction
cases.
Fig. 2 Schematic illustration of the Compton scattering case
Fig. 3 The trigger of the cathode would be the ﬁrst followed by the other two. These two periods
of time data would be acquired using the ASIC

A Readout Electronic System for a 3D Position-Sensitive CdZnTe Gamma-Ray. . .
159
4
Introduction of CPRE10-32 Readout Chip
CPRE10-32 is a 32-channel general-purpose readout chip designed for particle
detector pulse signal readout, and is the latest in the CPRE series. The energy
information and time information can be readout with low noise and low power
consumption. The original magniﬁcation of the chip is suitable for Si-PIN, CZT, and
other semiconductor particle detectors which have no multiplication effect. By using
a smaller gain in the chip or an external charge distribution structure, it can also
be used for Multi-anode Photo Multiplier Tube (MaPMT), Gas Electron Multiplier
(GEM), and other detectors with a larger gain compared to semiconductor particle
detectors. There is an independent test signal chain from a pin to the input of every
channel inside the chip so that the function and characteristic can be tested without
an actual signal. Table 1 presents some performance characteristics of CPRE10-32.
The functional block diagram of single readout channel is shown in Fig. 4.
Table 1 Performance
characteristics of the
CPRE10-32 Die
Parameter
Characteristics
Technology
0.35 μm CMOS
Size of DIE
7100 × 8500μmm2
Number of pins
123
Number of channels
32
Input noise
200 e−± 22 e−/pF
Polarity
Positive and negative optional
Time resolution
About 10 ns
Power consumption
5 mW/channel and 160 mW overall
Counting rate
Maximum 100 k/s
Mode of signal output
Single-end and differential selectable
Working temperature
−20~80 ◦C
Fig. 4 Functional block diagram of single readout channel

160
T. Chen et al.
The CPRE10-32 chip has multiple functions to control most parts of the circuit.
The programmable parameters include the switch of each channel, the size of the
feedback capacitor, the DAC threshold voltage of slow and fast shaping circuits and
the gain number. With the help of these parameters, it is possible for us to select the
suitable parameters in different conditions of experiments.
5
The Design of the Readout Electronic System
Based on the physical theory of the Compton scattering image, the requirements of
the readout electronic system are shown as follows:
1. The system should provide working conditions for the 3D-CZT detector includ-
ing high voltage (−1000 V to −2000 V) and six low-noise power rails for the
ASIC and the connection between ASIC and FPGA. A high-speed cable of
Samtec is chosen to transport control digital signals, power supplies and analog
output of ASIC.
2. The system should have a good electronic design in linear response and electronic
noise to achieve reliable data of 3D-CZT detector.
3. The system should have the ability to acquire the energy and time data of the 3D-
CZT detector. Time data will be used to calculate the depth data by electron drift
time. The goal of the energy resolution is lower than 1% at 662 keV of Cs-137
using the depth correction. (The original energy resolution of CZT is normally
about 1.23 keV (0.18%) at 662 keV of Cs-137.)
4. The system should realize full duplex communication between PC and FPGA
to monitor and control the system conveniently. The Gigabit network is used to
connect FPGA and PC.
5. The system would save the data acquired by the ASIC in PC and display the origi-
nal energy spectrum on the GUI. Data processing is temporarily ofﬂine. When the
processing algorithm is determined in the future research, the processing would
be online in the PC software and more ﬁgures would display on the GUI.
We designed a complete readout electronic system based on the CPRE10-32
readout chip to meet the requirements. It is composed of FEE board, DAQ board,
the logic ﬁrmware of FPGA, and the PC software on host computer. The FEE board
works in a shielding case.
5.1
The Hardware Architecture Design of the Readout
Electronic System
We use a design in which the FEE board containing the ASIC chip is separated from
the DAQ board containing the FPGA chip. The two boards are connected through

A Readout Electronic System for a 3D Position-Sensitive CdZnTe Gamma-Ray. . .
161
Fig. 5 Hardware architecture design of the readout electronic system
Fig. 6 Picture of the FEE board and DAQ board. The CPRE10-32 chip is wire-boned to the PCB
connecting wires. By doing so, the interference between the digital part and the
analog part of the FEE can be reduced. The hardware architecture design of the
readout electronic system is mainly divided into two parts:
1. FEE board, including CZT detector connector, CPRE10-32 chip and high voltage
input connector;
2. DAQ board, including FPGA chip, FPGA power supply chip, FEE power supply
chip, ADC chip, Gigabit network chip, and high voltage module.
The architecture design is shown in Fig. 5. A picture of the FEE board and the DAQ
board is shown in Fig. 6.
5.2
FPGA Control Logic
Based on the readout electronic hardware designed above, ASIC chips, FPGA chips,
high-voltage modules, and their control and monitoring are required. The system

162
T. Chen et al.
Fig. 7 Block diagram of the ﬁrmware logic function modules
includes all the classic control and monitoring functions required in a readout board.
The four main functions performed by the FPGA board are:
1. The communication between the FPGA and PC using a Gigabit Ethernet for the
transmission of control instructions and the upload of data;
2. Parameters’ conﬁguration of ASIC and the control of working status;
3. Storage, selection, and packaging of data acquired through ASIC;
4. The conﬁguration and monitoring of the high-voltage module.
To realize the requirements of the logic functions, we adopt a modular design,
which can separate the requirements to modules. Every module can be tested and
modiﬁed individually. The FPGA used in this article is the Artix-7 series FPGA of
Xilinx Company, whereby the Vivado 2022.1 software platform of Xilinx Company
is used in the ﬁrmware logic development. The programming language used is
Verilog-HDL. A design block diagram of the ﬁrmware logic function modules is
shown in Fig. 7. In the control logic, the functional modules that play an important
role are the instruction decoding module, the ASIC control module, the high-voltage
control and monitoring module, the data cache packing module, and the Ethernet
module. With the help of all above modules, the host computer can directly change
the conﬁguration parameters of the ASIC, and can freely control the start and end
of data acquisition, while obtaining the data collected by the ASIC in real time.
5.3
Design of PC Software
To cooperate with the control logic of the FPGA, it is necessary to design a
PC software on the host computer which can communicate with the FPGA and

A Readout Electronic System for a 3D Position-Sensitive CdZnTe Gamma-Ray. . .
163
Fig. 8 Design block diagram and GUI interface of the PC software. The most important functions
are the ASIC conﬁguration and Data receiver and display
implement functions to send conﬁguration data, receive and display collected data,
and save it locally. The PC software is designed based on the C++ QT open-source
library. To distribute and change conﬁguration parameters more conveniently, it is
necessary that the energy data of each channel can be recorded in real-time and
displayed in the form of an energy spectrum. Moreover, it is necessary for the GUI
to show the data of the high voltage and counting rate of every channel; thus, the
PC software is developed. A design block diagram and GUI interface of the upper
computer are shown in Fig. 8.
6
System Characterization of the Readout Electronic System
After the hardware and software design of the readout electronic system is complete,
a system characterization is required. Characterizations included baseline and noise,
and linear response and dynamic range. These characterizations can directly reﬂect
the performance of the readout electronic system, and provide basic data for
subsequent experiments.
6.1
Noise Characterization of the Readout Electronic System
In this experiment, the electronic noise was tested under the conditions of no detec-
tor and no high voltage, and connecting a detector with high voltage, respectively.
To test the electronic noise of the system without the detector, a signal generator
was used to generate a standard signal, which was set to 50 mV and 500 Hz.
The system was designed for CZT detector so that we used the ENN to show the
characterization of the system. The average ionization energy of CZT used here
is 5 eV. Because the CPRE10-32 chip had a test pin which was connected with
the input of channel inside the chip through a capacitor, the test signal could be
connected to the test pin directly. In order to study the inﬂuence of the gain of the
ASIC chip on the noise simultaneously, we used the minimum gain and maximum

164
T. Chen et al.
Fig. 9 ENN of the readout electronic system without the detector when the minimum and
maximum gains are selected under the condition of using a standard signal
Fig. 10 Baseline and its noise while connecting a detector and high voltage. The minimum gain
is selected. Channel 1 is connected to the cathode, and other channels are connected to the anode.
The baselines of the two electrodes are different
gain to conduct the noise test. The results are shown in Fig. 9. The electronic noise
when the system is connected with the detector and the high voltage is applied, is
called “baseline noise” here. The data of this noise would provide the information
for further experiments on noise analysis. According to the data acquired, the ENN
of the electronic noise can be calculated. The results are shown in Fig. 10.
As the reason that it was ﬁrst time to use and test the CPRE10-32 ASIC, we
decided to do some extra experiments on the inﬂuence of the design of electronic
board on the electronic noise. The ground copper under the tracker between detector
and ASIC had two ways to design, whether to remove or keep. The ground copper
under channel 0–24 were removed, and the ground copper under channel 25–31
were kept. We did not know which kind of design would have better electronic
noise performance in our system because we had found both designs in other works
using ASIC and detectors. The channel 15 and 28 were bad at the pin pad. So,
these two channels were ﬂoat pins. The channel 0 was connected to an individual
connector to test the function of the ASIC. It could be found from the Figs. 9 and 10
that the ENN of channel 25–31 were larger than that of channel 1–24, which proved

A Readout Electronic System for a 3D Position-Sensitive CdZnTe Gamma-Ray. . .
165
Fig. 11 The real-time energy spectrum while changing the input signal voltage from 50 mV in the
experiment. The x-axis represents ADC counts and y-axis represents counts. The spectrum data
collected by the system increases nearly at equal intervals with the increase of the input signal
that removing the ground copper had better noise performance. The electronic noise
increased after connecting the detector probably because of the noise of high voltage
and the increase of the crosstalk between channels. This result provided a reference
for our future electronic design.
When the system is not connected with the detector, the ENN is about 265 e−at
minimum and maximum gain, and the electronic noise is approximately 3.335 keV
at minimum gain and 3.074 keV at maximum gain. The data of the electronic noise
is the FWHM of the electronic noise which is used to calculate the ENN. After
connecting the 3D-CZT detector and high voltage, the ENN is about 375 e−, and
the baseline noise is approximately 4.72 keV.
6.2
Linear Response and Dynamic Range of the Electronic
System
In this part of experiment, the standard signal input was used to drive the electronic
system. The data output from the ADC which was acquired by the FPGA was used
as the standard to analyze the linear response characteristics of the readout electronic
system to the input signal. The input signal ranges from 50 mV to 1000 mV in steps
of 50 mV until the electronic system is saturated. There is a 75 fC capacitor inside
the ASIC right after the input signal. So, the input signal would be transformed
into the signal of electric charge. The real-time energy spectrum acquired in the
experiment while changing the input signal is shown in Fig. 11. The response curve
of the read amplitude data with respect to the input signal is shown in Fig. 12.

166
T. Chen et al.
Fig. 12 (a) Response curve of data and signal of channel 10. The Pearson’s r and Linearity γ are
shown in the ﬁgure. (b) Response curve of data and signal of channel 1–31
Fig. 13 Response curve of
data and signal of channel 10
with smaller step size
According to the results of the experiments above, the Pearson’s r is about 0.9991
and the linearity γ is about 1.36%. The Integral Nonlinearity (INL) and Differential
Nonlinearity (DNL) of the system is about 115 ADC counts and 0.52 ADC counts.
The linear response characteristics of the system are good enough for the energy
detection. The response is nonlinear when the input signal is extremely large, which
would not appear in most usage scenarios.
In order to evaluate the dynamic range of the system, we conducted a more
accurate test of the transition between the linear and nonlinear regions of the system
response to ﬁnd the linear region and the absolute dynamic range. By using a signal
generator and using a smaller step size to test at the minimum gain, the linear
range of the readout electronics could be obtained. The test results are shown in
Fig. 13. It can be determined from the results that the absolute dynamic range
of the electronic system designed in this paper was approximately 0–9145 ADC
counts, and the linear dynamic range was approximately 0–8556 ADC counts. The
baseline had been subtracted from both ranges. According to the energy data of
the radioactive source, the dynamic range of the linear range was approximately

A Readout Electronic System for a 3D Position-Sensitive CdZnTe Gamma-Ray. . .
167
0–450 keV at the maximum gain, and the dynamic range of the linear range was
approximately 0–3 MeV at the minimum gain. The minimum energy depends on
the experimental environment and trigger threshold and the choice of gain number.
The minimum energy of different channels is also different. Therefore, in order to
make it equivalent for every channel, 0 keV was used as the baseline reference,
and the actual value was greater than 0. For example, the dynamic range of channel
10 was approximately 20–450 keV under the condition of maximum gain. When
the minimum gain is selected, the dynamic range of channel 10 was approximately
100–3 MeV.
7
Functional and Performance Characterization Using
3D-CZT Detectors
The 3D-CZT detector used in this experiment was an 11 × 11 array. The size of
the detector was 22 × 22 × 5 mm. The high voltage is selected as −600 V at the
cathode. Considering that this is a prototype and this is also the ﬁrst time using
the CPRE10-32 chip, we chose to use one CPRE10-32 chip to verify functionality
and test performance. Thirty channels were selected to connect the detector in the
actual design. One channel was connected to the cathode signal terminal. The others
were connected to the anode signal terminal. After testing, it was found that channel
15 and channel 28 did not work properly due to wire-bonding problems. Two
radioactive sources, Am-241 and Cs-137, were used in the experiment. They were
placed 2 cm away from the cathode of the detector. The data collection time ranged
from 2 to 8 h. The temperature was around 20 ◦C. The experimental environment is
shown in Fig. 14.
Fig. 14 Picture of Experimental environment

168
T. Chen et al.
Fig. 15 The energy spectra of Am-241 at the maximum gain. Due to the noise problem, the data
of 8 channels could not be acquired correctly, so it is not shown here
7.1
Spectral Test Using Radioactive Sources
Two radioactive sources, Am-241 and Cs-137, were used to conduct data acquisition
tests. Without selecting hit cases, the baseline was subtracted from the energy
spectrum information. The energy spectrum diagrams are shown in Figs. 15 and
16.
According to the energy spectrum test, it can be found that the FWHM for the
full-energy peak of Am-241 at 59.6 keV under the maximum gain was preferably
7.25% for 14 channels. The FWHM of the full-energy peak of Cs-137 at 662 keV
was preferably 2.22% for channel 11 at low gain. The energy spectra of the last 6
channels in Fig. 16 were greatly disturbed. The noise of these channels, as shown
in Fig. 15, was too large and could not be read normally, so the energy spectra were
not displayed. This phenomenon was also found in the noise test above.
7.2
Electron Drift Time and Depth Correction
Depth information can be obtained by recording the voltage as a function of time.
Since the design uses only one ASIC chip and only 30 channels are connected, the
data of 121 channels cannot be completely read out, and therefore we only selected

A Readout Electronic System for a 3D Position-Sensitive CdZnTe Gamma-Ray. . .
169
Fig. 16 The energy spectra of Cs-137 detected by 28 anode channels at low gain
the single-anode signal triggering case, i.e., the case in which one anode and one
cathode were triggered simultaneously was acquired.
Given that it is impossible to determine whether other channels that are not
connected are triggered, depth correction using the C/A ratio method cannot be
performed smoothly. Therefore, we tried depth correction based on electron drift
time. After obtaining the time information, depth correction of the energy spectrum
was conducted according to the correction method mentioned above. The energy
data of Cs-137 at different depths of channel 12 were separated, as shown in Fig.
17. Through depth correction, the FWHM of the 662 keV full-energy peak was
improved from 1.35% to 0.76% at medium gain and 3.08% to 2.51% at low gain,
respectively. The results are shown in Fig. 18. The correction parameters of this
result were then used to directly correct the newly acquired energy spectrum, of
which the FWHM was successfully improved from 2.05% to 1.54%, as shown
in Fig. 19. The experiment demonstrates that the depth correction was conducted
correctly, while also highlighting that the readout electronics designed in this
experiment can simultaneously collect energy and time information, which meets
the requirements of Compton scattering imaging of 3D-CZT.
In Fig. 18, the scattering part almost disappears at low gain, which is related to
the relatively high threshold and small signal amplitude. The energy shown here
must trigger slow and fast shaping triggers at the same time, and the output of slow
and fast shaping circuit are not the same. The output of the fast-shaping circuit is
smaller than that of the slow-shaping circuit, which would cause the situation that
the slow trigger is triggered and the fast trigger is not triggered. Meanwhile, the

170
T. Chen et al.
Fig. 17 Energy spectra of Cs-137 obtained from channel 12 at different depths
Fig. 18 The energy spectra of channel 12 before and after correction, where the left picture is
medium gain, and the right picture is low gain
energy threshold of the minimum gain which would cause trigger is larger than that
of the medium gain. Considering all these conditions, the data in scattering part
would be thrown away and will lead to this kind of energy spectra. This situation
provides a reference for us to choose the appropriate gain number. So, we choose to
exhibit this result.

A Readout Electronic System for a 3D Position-Sensitive CdZnTe Gamma-Ray. . .
171
Fig. 19 Results after directly
using the correction result
under low gain to correct the
newly obtained data. The
effect is consistent with the
calculation group in Fig. 18
right
8
The Design of a Four-Chip Readout Electronic System
After the veriﬁcation and the test of the one-chip system, the basic function of the
system has been achieved. But if we want to conduct more experiment on 3D-
CZT detector or on the spectral correction algorithm, the one-chip system which
cannot collect all channels of the 3D-CZT detector is not suitable. Therefore, we
designed a four-chip system to gain the full function of the 121 channels of the
3D-CZT detector. The DAQ board is the same as that in one-chip system. After the
design of the four-chip FEE board, we have conducted more experiments on the
characterization of the depth of interaction of the 3D-CZT detector. The spectral
characterization is also performed in this study.
8.1
The Hardware Architecture Design of the Four-Chip
System
The main design of the four-chip FEE board is the same as the one-chip FEE board.
The difference is that the four-chip would have more signal routes to place. The total
design of the four-chip FEE board should be paid more attention on the interference
between the chips. Figure 20 is the picture of the four-chip FEE board after the
design.
The area of the four-chip FEE board is much smaller than the one-chip board.
The reason is that there is no need for us to do the conﬁrmatory experiment. So,
most of the area can be saved to decrease the area of the board. Although the four-
chip FEE board shown here is not a minimum area design, it still proves that using
the CPRE10-32 ASIC chip can build a small size of imaging devices. If the ASIC
could integrate more channels in a single chip, the area used of the FEE board can
become smaller and more integrated.

172
T. Chen et al.
Fig. 20 The picture of the four-chip FEE board. The chips are also wire-boned to the PCB
8.2
Spectral Test Using Radioactive Sources
After the design of the four-chip FEE board, we conducted the spectral test. Using
the CPRE10-32 ASIC chip, we have a lot of conﬁguration parameters to choose
which include the threshold DAC parameters, the gain parameters, the shaping
time parameters and so on. A different combination of the conﬁguration parameters
could lead to a better performance when the conditions of the environment or the
types of the radioactive source are different. Undercertain conditions, including a
temperature of 15 ◦C, a radioactive source of Cs-137, a middle gain and a high
voltage of −600 V, a energy spectrum diagram is shown in Fig. 21.
The basic energy spectral test shows that the function of the four-chip FEE board
was correct. The best energy resolution is 2.59% of the channel 57. The result is a bit
higher than the one-chip FEE board. The major reason could be the larger crosstalk
from the other signal routes. One chip could also be interfered by other chips when
they are working. This study is the prototype of the readout electronic system for
the 3D-CZT detector. So, these kinds of interferences are acceptable and would be
improved in the future.
8.3
C/A Ratio and Electron Drift Time
In the experiments of the four-chip FEE board, the research on the depth of
interaction inside the 3D-CZT detector is the most important. The crosstalk and the
interferences of the channels could be improved by a new design of the FEE board.
But the research on the characterization of the depth of interaction would lead to the
next-stage of research on 3D-CZT detector and the Compton scatter imaging.

A Readout Electronic System for a 3D Position-Sensitive CdZnTe Gamma-Ray. . .
173
Fig. 21 The energy spectrum of the Cs-137
As the discussion above, the C/A ratio can only perform in the single-pixel
interaction cases smoothly, and the electron drift time can perform anytime. So,
we select the single-pixel interaction cases to research the characterization of the
depth of interaction. First, we calculate the C/A ratio of all cases and tag every case
with its ratio. By doing this, we can acquire a diagram of the distribution of every
case related to the ratio. To ﬁnd a common result, we choose the channel 61 as the
example instead of the best channel 57. The diagram is shown in Fig. 22. The X
axis is the C/A ratio and the Y axis is the ADC counts. Every case has its energy
information and the C/A ratio information. The ADC count represents the data of
energy.
It is obvious that the full-energy peak is different at different ratio. This
phenomenon would lead to a decline in energy spectrum resolution because the
energy spectrum ﬁnally used is obtained by stacking cases of these ratio. The
ratio from 0 to 1 represents the depth of interaction from anode to cathode. So,
the full-energy peak would transform from low to high and decrease from the top
uniformly. Our purpose is to achieve a good energy resolution at the full-energy
peak. To realize the purpose, we should normalize the ADC counts of the full-
energy peak at different C/A ratio. But before the normalization, it is necessary
for us to pay attention to the electron drift time. As the capability of acquiring the
time information, we can obtain the electron drift time of every case. We can make

174
T. Chen et al.
Fig. 22 The diagram shows the distribution of the cases related to the ratio
Fig. 23 The diagram shows the distribution of the cases related to the electron drift time
the same diagram as the C/A ratio does with replacing the ratio into the electron
drift time. The diagram is shown in Fig. 23.

A Readout Electronic System for a 3D Position-Sensitive CdZnTe Gamma-Ray. . .
175
Fig. 24 The diagram shows the relationship between the C/A ratio and the electron drift time
It can be found from these two diagrams that the shapes of the full-energy peak
are similar to each other. But the other parts of the energy spectrum are not the same.
As mentioned above, the normalization of the full-energy peak is our purpose. So,
we focus on the full-energy peak ﬁrst. In order to ﬁnd the relationship between the
C/A ratio and the electron drift time, we select the cases of the full-energy peak and
draw the diagram of relationship between the C/A ratio and the electron drift time.
The result is shown in Fig. 24.
The middle part of the diagram can be ﬁtted to a straight line through the origin.
The result shows that the electron drift time and the C/A ratio can represent the depth
of interaction consistently. The origin represents the anode of the detector. The C/A
ratio can not distinguish the cases of which the ratio is below 0.25 or above 0.85
and the electron drift time can not distinguish the cases of which the time is below
250 ns or above 850 ns. We can perform the depth correction now using both the
C/A ratio and the electron drift time. The result is shown in Fig. 25.
The correction results show that the electron drift time performs a better energy
resolution than the C/A ratio does. Although these two kinds of depth correction
lead to different results, they are all working properly. According to this research, we
could demonstrate that the readout electronic system has the capability to provide
the working conditions for the 3D-CZT detector. The depth of interaction of the
cases inside the detector can provide information for further study on both the
characterization of the CZT detector and the Compton scatter imaging. The actual
relationship between the depth of interaction and the C/A ratio or the electron drift

176
T. Chen et al.
Fig. 25 The result of the depth correction of the electron drift time and the C/A ratio
Fig. 26 The photo of the environment of the experiment
time is not a straight line. So, extra researches on the function relationship between
these parameters should be conducted.
9
The Experiment of Compton Scatter Imaging
After all the experiments above, it is able for us to conduct the Compton scatter
imaging experiment. Put the detector towards a direction and lay the radioactive
source Cs-137 away from the detector. The Fig. 26 shows the environment of the
experiment. To realize Compton imaging, the two-pixels events are chosen as the
basic data for image reconstruction. The radioactive source Cs-137 has a radioactive
activity of 20 μ Ci. So, the distance between the radioactive source and the detector
was selected as 25 cm. The Compton scatter imaging results using simple back
projection are shown in Fig. 27. The results prove that the readout electronic system
has the ability to conduct the Compton imaging and can support other researches in
the future.

A Readout Electronic System for a 3D Position-Sensitive CdZnTe Gamma-Ray. . .
177
Fig. 27 The results of Compton scatter imaging using simple back projection. (a) The radioactive
source is 25 cm away from the center of the detector. (b) The radioactive source moves 25 cm
towards left from the position in (a)
10
Conclusion
Based on a new CPRE10-32 readout ASIC chip, we developed an electronic system
used for the 3D-CZT detector. In this chapter, we have introduced the hardware
and software design of the system, the results of the functional experiments using
radioactive source and the experiment of Compton scatter imaging. After all the
experiments have been conducted in this work, the readout electronic system has
been proved to be able to work properly connecting the 3D-CZT detector and can
perform the Compton scatter imaging. More experiments would be conducted in the
future based on this electronic system.
References
1. He, Z., et al. (1999). 3-D position sensitive CdZnTe gamma-ray spectrometers. Nuclear Instru-
ments and Methods in Physics Research. Section A, Accelerators, Spectrometers, Detectors and
Associated Equipment, 422(1–3), 173–178.
2. Zhong, H., et al. (1996). 1-D position sensitive single carrier semiconductor detectors. Nuclear
Instruments and Methods in Physics Research, 380(1-2), 228–231.
3. Zhang, F., et al. (2004). 3D position-sensitive CdZnTe gamma-ray spectrometers: Improved
performance with new ASICs. Proceedings of SPIE - The International Society for Optical
Engineering, 5540, 135–143.
4. Dan, X., Zhong, H., et al. (2004). 4-pi Compton imaging with single 3D position-sensitive
CdZnTe detector. Proceedings of SPIE - The International Society for Optical Engineering,
5540(5540), 144–155.
5. Zhu, Y., & Zhong, H. (2012). Performance of a 2-keV digitizer ASIC for 3-D position-
sensitive pixellated semiconductor detectors. In Nuclear science symposium & medical imaging
conference IEEE (pp. 4109–4112).
6. Feng, Z., et al. (2012). Characterization of the H3D ASIC readout system and 6.0 cmˆ3 3-D
position sensitive CdZnTe detectors. IEEE Transactions on Nuclear Science, 59(1), 236–242.
7. Wang, N., Wang, K., et al. (2016). CPRE low-noise readout chip for semiconductor detectors and
the development and application progress of system. In The 18th National annual conference on
nuclear electronics and nuclear detection technology.

Space Applications of CdZnTe and CdTe 
Detector Systems: Past, Present and 
Future 
Branden Allen 
1 
Introduction 
Here I will attempt to outline some of the signiﬁcant threads of CdTe and CdZnTe 
(CZT) detector technology development alongside the parallel evolution in high 
energy space research, encompassing astrophysics, heliophysics, and planetary 
science. It is not intended to capture the whole scope of both enterprises, but rather, 
to provide sufﬁcient detail to enable the interested reader some insight into how 
these threads have tied together in the past and how current trends might propel the 
ﬁeld forward in the years to come. 
1.1 
Observation Opportunities 
The advancement of practical technologies and science are complementary and self-
supporting components of the same enterprise and is all the more true for the space 
sciences. Over the duration of their lifetimes, all observatories operate in remote 
environments far beyond the reach of direct human intervention. To ensure that 
science objectives and the operational lifetime required to achieve these goals can 
be guaranteed with a high degree of certainty, these missions require substantial 
development and rigorous preﬂight qualiﬁcation prior to their deployment in the 
space environment. 
The dawn of the space age launched a revolution in our understanding of plan-
etary science, astrophysics and heliophysics. The ability to place payloads above 
B. Allen () 
Harvard College Observatory part of the Center for Astrophysics | Harvard-Smithsonian, Harvard 
University, Cambridge, MA, USA 
e-mail: ballen@cfa.harvard.edu 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
C. Hansson, K. (Kris) Iniewski (eds.), X-ray Photon Processing Detectors, 
https://doi.org/10.1007/978-3-031-35241-6_9
179

180
B. Allen
the Earth’s atmosphere lifted the veil on large sections of the Electromagnetic (EM) 
spectrum that had previously been denied to space scientists due to atmospheric 
absorption and scattering. This is particularly true for high-energy astrophysics at 
energies extending from the extreme UV (EUV) at approximately 10 eV (124 nm) 
to the soft gammaγ -ray regime up to about 50 GeV (0.25 fm); above approximately 
50 GeV ground observations have been routinely carried out for Very High Energy 
(VHE) sources using Imaging Atmospheric Air Cherenkov Telescopes (IACTs) 
(e.g. MAGIC [126], HESS [8], HAWC [7], LHASSO [9], Tibet ASgammaγ [13], etc.) 
which are able to indirectly detect astrophysical gammaγ -rays by measurement of particles 
and photons produced in km-scale Extensive Air Showers (EASs) that are initiated 
by a single photon or cosmic-ray. 
Within the EUV to soft gammaγ -ray band instruments may be deployed in one of the 
three following ways: 
1. On board high-altitude balloons. NASA currently supports the ﬂight of payloads 
of up to 3700 kg at altitudes ranging between 30–45 km above mean seal level 
(MSL) for a duration of up to 2 weeks. More recent advances have enabled the 
launch of long-duration balloon ﬂights (LDBs) and ultra-long duration balloon 
ﬂights (ULDBs) with mission lifetimes extending up to approximately 100 days 
[61]. Additionally, balloon payloads also provide a relatively inexpensive proving 
ground for the ﬂight-qualiﬁcation of technologies and instruments which may 
later be deployed on satellites that are typically about 2 orders of magnitude 
more costly. 
2. Shorter duration observations at higher altitudes than achievable with balloon 
payloads may be obtained using sub-orbital rockets. Currently, apogees of up to 
approximately 1600 km and spaceﬂight durations (greater than 100 km altitude) 
of up to 1300 s can be achieved [123]. Notably, the whole of X-ray astrophysics 
was launched with such a rocket on June 18, 1962 at 2359 MST, where, during a 
350 s ﬂight the ﬁrst detection of a soft astrophysical X-ray source was made using 
a payload consisting of 3 large, collimated, Geiger counters [56]. At present, 
sub-orbital rockets remain an important tool where short-duration observations 
are acceptable and are currently most frequently employed for heliophysics and 
space weather studies. 
3. Finally the addition of a ﬂight instrument to a dedicated satellite or, quite 
commonly, as part of a suite of instruments for the study of a series of 
well deﬁned science goals is the preferred method, in spite of the cost. Well 
designed observatories such as Hubble Space Telescope (HST) (launched: 24 
April 1990) [27] , Chandra (launched: 23 July 1999 on STS-93) [151] and X-
Ray Multi-Mirror Mission (XMM) Newton (launched: 10 December 1999) [79] 
have remained operational and productive for 30 to 20 years. With the notable 
exception of HST (cf. [24]) none of this has been achieved through repair or 
replacement of any of the components. Incidentally this is the only method 
available to planetary science which, in addition, must survive a long cruise phase 
lasting 6 months up to a decade or more before observations may even begin.

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
181
Today all 3 methods are utilized by governments around the world, as well 
as some private entities, to provide access to space enabling a broad variety 
of investigations covering a wide array of topics in astrophysics, heliophysics, 
planetary science, and Earth science. 
In parallel, the development of new detector technologies has vastly improved the 
sensitivity and scientiﬁc impact of these payloads per unit mass. This is particularly 
true of CdTe and CdZnTe (CZT) which have been increasingly used in spaceﬂight 
over the last 20 years, particularly for astrophysics applications, greatly expanding 
the reach and impact of investigations in the X/gammaγ -ray regime. 
1.2 
High Energy Astrophysics and the Space Age 
As outlined three key technologies exist to extend the reach or our instrumentation 
beyond the inﬂuence of the Earth’s atmosphere. The oldest of these methods is 
high-altitude ballooning. Since the ﬁrst crewed ﬂights began with the Montgolﬁer 
brothers hot air balloon demonstration at Versailles in 1783, balloon ﬂights have 
expanded our view of the world, initially by direct observation, then with pho-
tography followed by the addition of increasingly complex instrumentation as new 
technologies were developed and became available. The initial discovery of cosmic 
rays in 1912 by Victor Hess was made from a balloon [68] in a series of ﬂights which 
opened a new line of research into their origin and properties. These studies lead to 
greater understanding of the space environment and simultaneously helped launch 
the ﬁeld of modern fundamental particle physics with Carl Anderson’s discovery 
of the positron (a.k.a. positive electron) [14] and the discovery of the muon shortly 
thereafter [14]. 
In the same period, accelerated development of rocket technologies throughout 
the interwar period (1920s-1930s), beginning with the ﬂight of the ﬁrst liquid 
fueled rocket by Robert Goddard on 16 March 1926 from Auburn, MA and his 
launch of the ﬁrst scientiﬁc payload, a barometer and camera, in 1929. Additional 
advances throughout the 1930s and 1940s culminated in the launch of the ﬁrst rocket 
outside of the Earth’s atmosphere from the Heeresversuchsanstalt Peenemünde 
on 20 June 1944 and, simultaneously, increased interest in rocketry within the 
United States saw the reorientation of the Guggenheim Aeronautical Laboratory 
of the California Institute of Technology (GALCIT), the forerunner of NASA 
Jet Propulsion Laboratory (NASA-JPL), toward rocket research in 1938 under 
Frank Molina. Ultimately GALCIT, under the Ordinance-California Institute of 
Technology (ORDCIT) program, successfully launched the ﬁrst exemplar of what 
may be considered the ﬁrst sounding rocket, the Wac Corporal, in 1945 marking 
the start of regular sounding rocket ﬂights and the formation of the ﬁrst permanent 
sounding rocket launch facility at the White Sands Proving Grounds. The Wac 
Corporal is, in many respects, the forerunner of the Aerobee rocket which served

182
B. Allen
as the workhorse for the NASA sub-orbital ﬂight program in the decades to follow. 
Additionally, captured V-2 rockets and components shipped back to the U.S. at the 
close of the second world war bolstered early sounding rocket experiments and ﬂew 
a number of notable payloads throughout the late 1940s and 1950s. For a more 
complete history the interested reader may consult [36] and the references therein. 
By the 1950s all of the necessary vehicles for the propulsion of scientiﬁc 
payloads into the uppermost reaches of the Earth’s atmosphere and beyond were 
in place, settings the stage for the deployment of the world’s ﬁrst scientiﬁc space 
payloads. The ﬁrst successful X-ray and Extreme Ultraviolet (EUV) observations of 
the sun were conducted with V-2 Rocket No. 49 [49] on the 29 September 1949 and 
followed by a slew of other sub-orbital ﬂights with a wide variety of objectives. The 
launch of Sputnik I on 4 October 1957 marked the beginning of the space age and 
was quickly followed by the launch of Explorer 1 into Earth orbit with a Jupiter C 
rocket almost 4 months later on 31 January 1958. Explorer 1 carried with it the 
ﬁrst scientiﬁc satellite placed into orbit and enabled the discovery of the Van Allen 
radiation belts [148]. 
During the 1960s X-ray astronomy was initiated and rapidly advanced through 
a series of sub-orbital ﬂights until the ﬁrst dedicated science satellite for the study 
of astronomical X-ray sources, Small Astronomy Satellite A (SAS-A) or -1 was  
launched on 12 December 1970 from the San Marco platform, located off the coast 
of Kenya, by Agenzia Spaziale Italiana (ASI) on behalf of the United States, a ﬁrst 
for a US payload. Following launch SAS-A was renamed Uhuru in honor of Kenyan 
independence achieved just 7 years prior [77]. Uhuru remained in operation until 
10 March 1973 and completed the ﬁrst full survey of the X-ray sky in the 2–20 keV 
energy band. Following the success of Uhuru a wide variety of payloads were placed 
into low Earth orbit (LEO) dedicated to the study of X-ray astrophysics. 
At the same time, the United States Department of Defense (DOD) had initiated 
the Vela nuclear test-ban monitoring program which consisted of a constellation of 
12 satellites launched in pairs at a cadence of approximately 1 per year beginning 
with the launch of the ﬁrst pair, Vela 1A and 1B, on 17 October 1963 and ending 
with the ﬁnal pair Vela 6A and Vela 6B on 8 April 1970 [102]; just a few months 
prior to the launch of Uhuru. Although Vela did not deﬁnitively identify any test ban 
violations, they did discover intense bursts of gammaγ -ray radiation of cosmic origin [86]. 
Dubbed Gamma-Ray Bursts (GRBs), these events remain a subject of intense study 
critical to our understanding of the end states of stellar evolution, the history of 
nucleosynthesis over the lifetime of the universe and serve as a probe of extreme 
physics during the mergers of any permutation of black holes (BHs), Neutron Stars 
(NSs) and White Dwarfs (WDs) pairs. 
The study of GRBs is in fact one of the main use cases for spaceﬂight CZT 
and CdTe instruments at present and also was one of the motivating factors for the 
launch of the ﬁrst CdTe detectors during the 1970s aboard the ISEE-1 payload.

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
183
1.3 
The Search for New Detectors and Early Spaceﬂight 
Deployments of CdTe (1970–1990) 
Around the same time that X-ray astronomy had established a ﬁrm footing in 
LEO, CdTe had begun to gain recognition as a potentially useful medium for the 
detection of gammaγ /X-rays. The ﬁrst suggestions that CdTe could potentially be used 
as a radiation detector [38] were proven correct within less than a decade, when 
a handful of groups working to improve CdTe growth techniques for a variety of 
purposes unrelated to X-ray detector development managed also to demonstrate 
sensitivity to X/gammaγ -radiation [10, 155] in 1968 at Hughes Research Laboratories. 
Meanwhile large efforts to explore the origin of GRBs were launched by 
astrophysicists and instrumentalists who, recognizing the intrinsic limitations in 
spectral resolution of readily available scintillators and proportaional counters (PCs) 
available at the time, began investigating the possibility of using a variety of semi-
conductor materials in their place. A number of candidate materials are mentioned 
in the literature of the time including High Purity Germanium (HPGe), CdTe 
and HgISubscript 22. In spite of its superior energy resolution it was widely recognized that 
the added complexity levied by the cooling requirements of germanium detectors 
were a signiﬁcant drawback to their use. Consequently, individual groups began 
investigating the feasibility of CdTe deployment in a space environment as early as 
1976 [98] and eventually ﬁelded a small number of CdTe-based spectrometers. 
The ﬁrst such deployment, that I am aware of, was carried out as part of the 
International Sun-Earth Explorer (ISEE) program. The ISEE series of satellites was 
conceived as a close international partnership between the National Aeronautics and 
Space Administration (NASA) and European Space Agency (ESA). This consisted 
of a total of 3 separate spacecraft that were launched beginning with ISEE-1 and
-2 on 22 October 1977 ending with the launch of ISEE-3 less than a year later on 
12 August 1978. For this mission ESA was responsible for ISEE-2 and NASA for 
ISEE-1 and -3. The primary objective for this partnership was the study of space 
weather and, in particular, the character and conditions of Earth’s magnetosphere. 
For this reason ISEE-1 and -2 were placed in a highly elliptical orbit around the 
Earth with an apogee extending to 23 Earth radii (R⊕), while ISEE-3 was placed 
outside of the Earth’s magnetosphere at the L1 Lagrange point between the Earth 
and the Sun [108]. In this way ISEE-1 and -2 would monitor the environment around 
the Earth while ISEE-3 would provide a data point in a region outside the inﬂuence 
of the Earth’s magnetosphere. 
The planning phases of the ISEE program had started prior to the announcement 
of the existence of GRBs to the public in 1973, however, NASA had adopted a 
policy endorsing the modiﬁcation of instruments under construction in order to 
accommodate studies to advance GRB science. As a result the ISEE-1 and -3 
missions were modiﬁed to accommodate the addition of GRB monitors. For ISEE-

184
B. Allen
Fig. 1 Schematic cross section of the 3Superscript r drd CdTe spectrometer system ﬂown in space (reproduced 
with permissions from [74]). Each spectrometer contained 2 rectangular CdTe detectors measuring 
22 times× 7 mm with a thickness of 2 mm (shown here on the 7 times× 2 mm cross section). The P78-1 
satellite included 4 of these spectrometers in total 
1 this instrument suite included a CsI scintillator system supplied by Max Planck 
Institut (MPI) and a 6 cmsquared2 array of CdTe detectors with unspeciﬁed thickness 
supplied by Goddard Space Flight Center (GSFC) [31, 71]. To my knowledge, the 
CdTe detectors launched with ISEE-1 represent the ﬁrst spaceﬂight use of such 
detectors. The ISEE-3 spacecraft was also equipped with a passively cooled (to 
approx. 90 K) HPGe spectrometer which represents the ﬁrst spaceﬂight use of that 
material as well [108]. The very ﬁrst germanium detectors to have ﬂown in space 
were, however, launched with the satellite 1972-076B into a polar orbit [73], also 
for the characterization of GRBs. 
Slightly after the ISEE array was deployed the P78-1 “Solwind” satellite was 
launched on 24 February 1979 carrying with it an additional CdTe array aloft [74]. 
In contrast to the ISEE instrument, for which details are hard to come by in the 
literature, the array for this instrument is reasonably well documented. Here the 
Gamma Ray Environment Sensor (GEMS) instrument consisted of 8 separate 2 mm 
thick rectangular CdTe detectors measuring 7 times× 22 mm (2 per GEMS module) 
and were surrounded by an active CsI shield (see Fig. 1)1 . The primary purpose 
of this instrument was for the measurement of bremsstrahlung X-rays emitted from 
the Earth’s atmosphere. This mission survived until it was decommissioned and 
ultimately became the target of a U.S. ASM-135 anti-satellite weapon (ASAT) test  
conducted on 13 September 1985 that terminated its existence.
1 I speculate that 4 of these CdTe detectors, totalling 6.12 cmsquared2, very likely made up the CdTe array 
in the ISEE-1 payload, however, I unfortunately cannot conﬁrm this at present. 

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
185
1.4 
General Progress in X-Ray Astronomy and New Imaging 
Techniques (1970–1990) 
The rocket ﬂights of the 1960s gradually expanded the number of known astro-
physical X/gammaγ -Ray sources leaving many questions as to their origin and even 
their full distribution on the sky unanswered. This changed with launch of Uhuru 
(Sect. 1.2) which provided the ﬁrst all-sky survey of X-ray sources in the 2– 
20 keV band. However, the Uhuru instrument consisted of a pair of collimated 
proportional counters: one with a 0.5Superscript ring◦times× 5.0Superscript ring◦FoV and the other with a square 
5Superscript ring◦FoV (FWHM) [77]. In spite of its limitations, Uhuru identiﬁed a wide variety 
of X-ray sources and phenomena including varieties with signiﬁcant temporal 
variability. Further study to reveal their nature was required and fueled the demand 
for instruments with improved sensitivity, energy and angular resolution. 
To answer this call NASA placed a slew of instruments dedicated to the study of 
high-energy phenomna into LEO and beyond (e.g. SAS and OSO series) throughout 
the 1970s, including a series dedicated entirely to the study of X/gammaγ -ray astronomy. 
The ﬁrst of the High Energy Astrophysical Observatory (HEAO) series,  HEAO-A 
(or -1), conducted observations between 12 August 1977 and 9 January 1979, and 
HEAO-B (or -2) which launched on 12 November 1978 remaining in operation until 
12 April 1981. HEAO-A hosted a number of instruments utilizing collimators to 
probe the higher energy sky in a similar respect to that achieved with Uhuru but with 
higher sensitivity [48]. At this point, the launch of X-ray astronomy payloads into 
LEO also started to become a much more international enterprise, with important 
contributions from the UK’s Ariel 5 mission [133], Japan’s Hakucho (a.k.a. Cosmic 
Radiation Satellite (CORSA-b)) [105], and Netherlands’ Astronomical Netherlands 
Satellite (ANS) [21, 39] to name a few. 
1.5 
Focusing X-Ray Imaging Telescopes 
The greatest technical leap of the decade, arguably, was demonstrated in the HEAO-
B [55] satellite. Renamed the “Einstein” observatory subsequent to its launch, 
Einstein introduced the ﬁrst use of grazing incidence optics in conjunction with 
a position sensitive X-ray detector system for astronomy from LEO.2 This gave 
astronomers a focusing X-ray imager with high angular resolution (2double prime′′ for the High 
Resolution Imager (HRI)) accompanied by a background reduction enabling many 
orders magnitude improvement in sensitivity over previous missions but with a 
narrow 25prime′ Field of View (FoV) (HRI). This was the result of nearly 20 years of 
development from the formulation of the initial concept in 1960 [54] followed by a
2 Although the ANS carried with it the ﬁrst telescope equipped with grazing incidence optics 
injected into LEO [39] it was incapable of imaging by design. 

186
B. Allen
demonstration on a sub-orbital payload which captured the ﬁrst soft X-ray images 
of the sun using this technique in 1965 [57], culminating in the launch Einstein’s 
launch in 1978 (for more detail Riccardo Giacconi’s Nobel lecture is an excellent 
entry point from a technical and scientiﬁc perspective [53]). 
These new capabilities enabled the Einstein observatory to produce many break-
throughs in the study of extended sources, such as supernova remnants (SNRs), 
as well as a wide variety of point sources and served as the forerunner of many 
of the X-ray observatories to come. This includes ROSAT [143] (1 June 1990– 
12 February 1999), which would perform the ﬁrst high resolution (7double prime′′) all-sky 
survey using a focusing optic by systematically scanning the entire sky [149, 150]; 
the Advanced Satellite for Cosmology and AStrophysics (ASCA) mission [139] 
(20 February 1993–14 July 2000), which ﬂew the ﬁrst X-ray sensitive charge 
coupled device (CCD) focal plane used with a focusing X-ray optic at the heart of 
its Solid State Imaging Spectrometer (SIS) instrument [26] for astrophysics; as well 
as today’s premier soft X-ray observatories: the Chandra X-ray Observatory (CXO) 
(formerly the Advanced X-ray Astrophysics Facility (AXAF)) and XMM-Newton 
deployed just under 10 years later and which are both still in operation today. 
Unfortunately, the mirror technologies of the day only enabled imaging at energies 
up to approximately 10–15 keV, leaving those wishing to observe or monitor the 
sky at higher energies with limited options. This state of affairs would dramatically 
turn with the millennium expanding their reach up to energies approaching 100 keV; 
discussed later in Sect. 4. 
1.6 
Coded-Aperture Imagers 
Simultaneously astronomers and instrumentalists had begun to look into other 
methods to improve capabilities at energies above approximately 15 keV and 
struck upon a modiﬁcation of the pinhole camera concept. Clearly, the use of a 
single pinhole together with a large position sensitive detector would not reach the 
sensitivities required by the astrophysics community, however, it was recognized 
that adding holes to increase X-ray throughput to a large, underlying detector plane 
coupled with the application of cross-correlation/FFT image reconstruction would 
enable the deployment of more sensitive wide-ﬁeld, hard X-ray telescopes. In most 
applications an X-ray opaque “mask” is constructed so that a number of regions 
are left open to the sky some distance above the detector plane. In the presence of 
an X-ray source at celestial distances photons will register on a position sensitive 
detector plane and reproduce the mask pattern as upper N Subscript gamma Baseline right arrow normal infinityNγ →∞. Based on this principle 
it was realized that the positions of X-ray sources may be reconstructed through 
cross-correlation of detector plane images with the known mask pattern. After its 
proposal the coded-aperture imaging technique, originally termed a “Dicke camera” 
after its original proposer [40], was rapidly adopted by the community to fulﬁll

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
187
this important roll. By the mid- to late-1980s coded-aperture imaging was widely 
recognized as a powerful technique for the wide-ﬁeld monitoring of the X-ray sky 
in spite of relatively high backgrounds and source-contamination issues that are 
inherent to its use. 
Following the initial proposal in 1969 the ﬁrst payloads making use of coded-
aperture imaging began appearing in launch manifests starting around the mid-
1970s. Initially the UK’s Ariel 5 mission deployed the ﬁrst “pinhole” camera 
provided by NASA-GSFC using position sensitive proportional counters (PSPCs) 
and a 1 cmsquared2 aperture to conduct all-aky X-ray source monitoring and to search for 
transient events [133]. Subsequently, the ﬁrst true 2D coded-mask wide-ﬁeld imager, 
SL 1501, was tested on board a sub-orbital rocket payload in 1976 and successfully 
observed the galactic center resolving individual X-ray sources [62, 117]. By the 
early 1980s Japan’s Tenma mission (20 February 1983–22 November 1985) also 
had been equipped with a 1-D “Hadamard” mask as part of a 2 instrument Transient 
Source Monitor (TSM) with a wide 40Superscript ring◦times× 40Superscript ring◦FoV designed to detect and pinpoint 
the location of any potential GRBs and other transient events, etc. [138]. This was 
followed by the ﬁrst LEO deployment of a 2D coded-aperture mask on the space 
shuttle mounted Skylab2 payload: Spacelab 2 X-ray Telescope (SL2-XRT) [153] 
with a 1024 cmsquared2 PSPC located 3 m below the mask. The SL2-XRT had a 6Superscript ring◦FoV 
and performed a 2.5–25 keV survey of the galactic center, extending observations 
that had been carried out by the Einstein observatory to higher energies, albeit 
at lower angular resolution, providing additional information on this region in a 
powerful demonstration of this technique [129]. Not long afterward on 1 December 
1989, the Soviet-French GRANAT mission carried two large coded aperture imagers 
aloft: (1) the Sigma telescope [113] with a 794 cmsquared2 NaI detector plane conﬁgured 
as an Anger camera with a 2D tungsten mask mounted 2.5 m above the detector 
plane sensitive between 35 keV and 1.3 MeV with an angular resolution of 13prime′; 
(2) The ART-P telescope, which consisted of 4 separate modules each containing 
a large 630 cmsquared2 active area PSPC capable of operation over the 4–60 keV energy 
range and a coded-aperture mask mounted 1.32 m above the detector plane, enabling 
a 6prime′ angular resolution. The success of these missions paved the way for the 
introduction of future wide-ﬁeld and hard X-ray imagers in astrophysics satellite 
payloads sensitive at energies above about 15 keV where, as mentioned earlier, 
grazing-incidence optics lose reﬂectivity and typically are only able to achieve a 
FoV at about the 1Superscript ring◦times× 1Superscript ring◦scale maximally. 
Following the development and astounding performance of grazing incidence 
optics and the introduction of coded aperture imaging between the late 1970s and the 
mid 1990s orders of magnitude improvements in sensitivity were achieved primarily 
using only proportional counters and scintillators. Beginning in the 1990s additional 
improvements in semiconductor manufacturing led to the adoption of CCDs and 
accelerated activity in the development of CdTe as well as the development of CZT 
would lead to, what I consider, the CdTe/CZT revolution in astrophysics, discussed 
later in Sect. 3.

188
B. Allen
1.7 
Dawn of the Solid State Imagers 
By the early- to mid-1990s grazing-incidence telescopes (Sect. 1.5) and coded-
aperture imagers (Sect. 1.6) were ﬁrmly established as complementary techniques: 
the former enabling high-resolution (arcsec) observations soft X-ray sources and 
the X-ray sky and the latter providing a monitoring and survey capability for large 
swaths of the sky with moderate (arcmin) angular resolutions at all energies. 
While both techniques are reliant on position sensitive detector planes, all 
of the instruments of the day made use of either position sensitive proportional 
counters or Microchannel Plates (MCPs) or some form of segmented scintillator 
system or Anger camera, etc. During this time development of Si-based CCD 
had been progressing and gradually reaching a level of maturity acceptable for 
spaceﬂight [25, 47]. As concepts for the next-generation of high-energy wide-ﬁeld 
monitors and focusing telescopes took on their ﬁnal forms throughout the 1990s a 
rapid shift toward position sensitive detectors based on semiconductor materials of 
all types began to occur. 
At this point lithium-drifted Ge and High Purity Germanium were considerable 
frontrunners in addition to Si and all had been ﬂown in various missions since 
the 1970. The signiﬁcant difﬁculties associated with the cooling of these detector 
systems kept some focus on the development of room-temperature semiconductors 
over this period albeit at a relatively low level. By the end of the 1980s HgISubscript 22 was 
considered the forerunner room temperature material and had been included on at 
least two balloon payloads by the end of 1982 [121, 147] enabling astrophysical 
observations of the black hole binary Cyg-X1 in conjunction with the Japanese 
Hakucho mission in 1980 [107]. However, outside of astronomy improvements 
in CdTe growth and fabrication were enabling some commercial applications 
(e.g. [43]). Eventually improvements in CdTe growth techniques and the develop-
ment of CZT would make possible the production of detectors in the volumes and 
quality required for next generation astrophysics experiments turning the tables in 
dramatic fashion. 
2 
Early Semiconductor Detector Developments and the 
Deployment of the First Imagers 
The 1970s and 1980s saw some initial experimentation and deployment of useful 
semiconductor detectors for use in space science, of particular interest here CdTe 
and Ge detectors (Sect. 1.3). These were simple spectrometers mounted into colli-
mators with no intrinsic imaging or position sensing capability of their own. 
In the early 1990s long-term development of semiconductor imaging technolo-
gies that has begun in the mid-1970s for heliophysics, astrophysics, and planetary 
science began to be deployed. This was initiated by the recognition of the potential

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
189
improvements that semiconductor detectors, of all compositions, could enable 
leading to rapid development in this arena, initially for Si-based CCDs. 
2.1 
Early Space Science CCD Development 
One of the earliest deployments of CCDs for space science occurred with the launch 
of the Giotto Halley Multicolour Camera (Giotto-HMC) using a Texas Instruments 
(TI) virtual phase CCD (VPCCD) on 14 May 1986. As the instrument name strongly 
implies, the purpose of the mission was to intercept and conduct in situ observations 
of Halley’s comet [84, 85] during its close ﬂyby of the Earth in 1986. 
This line of CCDs was an outgrowth of a JPL/TI led development program [94] 
conducted for the Galileo probe which performed a ﬂy by of Venus before settling 
into orbit around Jupiter 7 December 1995 after its launch 6 years earlier on 18 
October 1989. In the case of the Galileo mission, Si-based CCDs were quickly 
recognized as a key technology for the improvement in imaging sensitivity that 
would be critical for observation of the Jovian system, particularly during close 
ﬂy-bys of the Jovian moons. A joint effort between Jet Propulsion Laboratory (JPL) 
and TI was initiated in the mid-1970s to replace the SeSSubscript 22 vidicon based imaging 
system used in the Mariner and Voyager probes that served as the backbone of 
planetary imaging (cf. Voyager imaging science subsystem (Voyager-ISS) [134]) 
with a new detector plane. After a 15 year development effort the Galileo solid 
state imager (Galileo-SSI) was deployed in a system very similar to that of the 
Voyager-ISS excepting the use of a 800 times× 800 pixel (15.2 normal muμm) VPCCD [17, 78]. 
This program was also intimately connected to the development of the HST Wide 
Field/Planetary Camera (WF/PC) [152] as well. The  WF/PC was equipped with a 
4 times× 4 array of these  CCDs [152] and launched shortly after Galileo on 24 April 
1990. 
Finally, a slightly different version of these VPCCDs were launched with the 
Japanese Solar-A Mission renamed Yohkoh (translation: Sunbeam) a little over a 
year later on 30 August 1991. One difference between the CCD ﬂown with Yohkoh 
and that of the Galileo and HST instruments is that it was expanded to support 
a 1024 times× 1024 array of slightly larger square pixels (18.3 normal muμm). The primary 
difference, however, is that this CCD was built for the high-resolution observations 
of the sun in soft X-rays. It was ﬂown at the focal point of a grazing incidence 
optic [87, 144] making it one of the ﬁrst of a new-generation of CCD based X-ray 
telescopes including ASCA [26, 139], which was a Japanese astrophysics mission 
with signiﬁcant US participation, and ﬁnally the Chandra X-ray Observatory (CXO) 
and X-Ray Multi-Mirror Mission Newton (XMM-Newton) at near the turn of the 
millennium, brieﬂy discussed earlier in Sect. 1.5.

190
B. Allen
2.2 
Non-Silicon Semiconductor Imager Development 
Just after the ﬁrst generation of Si-based CCD detectors were deployed the 
development, construction and testing of imaging detectors using Ge, CdTe and 
CZT began to occur. 
The ﬁrst exemplar of a non-Si semiconductor imaging instrument (occasionally 
identiﬁed as the “Birmingham experiment”) that was successfully tested in a 
near-space environment, consisted of a 9 element HPGe conﬁgured in a 3 times× 3 
array of detectors with a 0.2 mm gap between adjacent crystals. Each individual 
crystal measured 15 times× 15 mm with a 50 mm thickness along the observation 
axis [131, 132]. A rectangular coded aperture mask was placed 980 mm above 
the upper surface of the detector plane and the payload launched together with 
the Gamma-Ray Imaging Spectrometer (GRIS) [145]. The GRIS payload also was 
made up of an array of HPGe detectors, deployed for the same purpose and was, 
notably, part of a NASA initiative launched in 1982 for the creation of gammaγ -ray 
detectors with improved sensitivity for future spaceﬂight opportunities. During a 
September 1993 ﬂight, the Birmingham instrument successfully imaged the Cyg-
X1 and obtained both images and measured the spectrum of the Crab nebula, a 
standard candle in X-ray astronomy, demonstrating the feasibility of coded-aperture 
imaging using semiconductor detectors for spaceﬂight. This was seen as a potential 
forerunner to the next-generation of wide-ﬁeld instruments under development at 
that time while recognizing, as before, the difﬁculties associated with maintaining 
low temperatures over the large detector areas required, 1000s of cmsquared2. Accordingly, 
development efforts for the spaceﬂight use of room temperature semiconductors 
began to gain momentum at about the same time that the need for these large 
detector planes became clear. 
A few years after the ﬁrst viable CZT detectors became available the ﬁrst 
spaceﬂight CZT detector demonstration was carried out as part of the Piggyback 
Room Temperature Instrument for Astronomy (PoRTIA) payload in 1995 along 
with a HgISubscript 22 detector in an effort led by GSFC [111, 112]. Though the PoRTIA 
instrument only carried a single 6.5 times× 6.5 cm, 1.9 mm thick CZT crystal, this 
successful ﬂight represents a signiﬁcant milestone leading to the production of 
large-scale CZT detector planes. 
Additional, parallel efforts, were also underway for the development of position 
sensitive detectors using an anode segmented into strips, e.g. strip detectors with 
pitches as ﬁne as 100 normal muμm [111, 112] at GSFC. Beyond GSFC a number of other 
groups were pursuing the development of strip detectors and simultaneously were 
pursuing balloon ﬂights to demonstrate their own technologies (e.g. University 
of New Hampshire (UNH) [125], University of California, San Diego (UCSD) 
in collaboration with Aurora technologies [41, 42]). Although the CZT crystals 
acquired at the time were by no-means defect free the quality and volume was 
sufﬁcient to stimulate interest and propel further development. The primary problem 
for many of the groups aiming to produce ﬁnely pixelated detector planes shifted to 
development of the front-end readout system and the search and/or development of

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
191
application speciﬁc integrated circuits (ASICs) that could be safely deployed into 
the space environment. 
2.3 
Further Advances in Astrophysics 
At the same time as these developments were well underway and the Compton 
Gamma-Ray Observatory (CGRO) (5 April 1991–4 June 2000) along with the Burst 
and Transient Source Experiment (BATSE) instrument were placed into orbit and 
began observations. The detector system consisted of 8 separate modules, each 
containing 2 detectors: (1) the Large Area Detector (LAD), NaI(Tl) scintillators 
with a 1.27 cm thickness and 2025 cmsquared2 area, sensitive in the energy range between 
30 keV and 1.9 MeV; and (2) the Spectroscopic Detector (SD), also composed 
of NaI(Tl) but with a 127 cmsquared2 area and 7.62 cm thickness optimized for spectral 
response. Each of these modules were placed at the corners of the CGRO in order 
to provide some source localization capability while enabling observation of the 
full visible sky [45, 110]. During the course of its operations BATSE detected 
approximately 1 GRB every day. The localization capability of BATSE enabled 
astronomers to determine that the distribution of GRBs was deﬁnitively isotropic 
strongly implying an extra-galactic origin but the mechanism and source could not 
yet be identiﬁed, see [44] for a classic review of the status of the investigation into 
GRBs circa 1995. 
In the bottom half of that decade the Satellite italiano per Astronomia X 
(BeppoSAX) (30 April 1996–30 April 2002) mission was fast approaching its 
launch date. BeppoSAX was a major ASI mission with signiﬁcant participation of 
the Netherlands Agency for Aerospace Programs (NAAP), or in Dutch, Nederlands 
Instituut voor Vliegtuigontwikkeling en Ruimtevaart (NIVR) [22]. The payload was 
designed to observe the X-ray sky over a wide 0.1–300 keV energy band for the 
detection and characterization of variable X-ray sources; GRBs were of particular 
interest but other variable sources that permeate the galactic and extra-galactic X-
ray sky were also of critical interest. The key innovation of BeppoSAX mission 
was the inclusion of both wide- and narrow-ﬁeld X-ray instruments for the express 
purpose of performing rapid follow-up observations of transient sources detected 
in the wide-ﬁeld instrument with the narrow-ﬁeld instruments for the acquisition 
of higher-resolution source positions and spectra. More speciﬁcally, it was outﬁtted 
with two Wide-Field Cameras (WFCs) [22] oriented in opposite directions. Each of 
the identical WFCs consisted of a PSPC coupled to a coded aperture mask placed 
700 mm above the surface of the detector plane. This combination resulted in an 
instrument with a 20Superscript ring◦times× 20Superscript ring◦FoV and a 5prime′ angular resolution sensitive over the 
1.8–28 keV energy band. Further, BeppoSAX was equipped with four grazing-
incidence narrow ﬁeld instruments with the objective of performing X-ray followup 
observations within about 1/2 day in the soft (0.1–10 keV) X-ray band. BeppoSAX 
was able to precisely localize GRB to arcmin resolution and successfully performed 
the ﬁrst follow-up observations of GRBs [37].

192
B. Allen
Fig. 2 The upper T 90T90 distribution, 
i.e. the distribution of the 
width of the time window 
within which 90% of the total 
events for a single GRB are 
detected, from the BATSE-4B 
catalog. The bimodal 
distribution implied the 
existence of two different 
gammaγ -ray emission mechanisms 
but, for events lasting less that 
1 s, followup with  BeppoSAX 
was not possible due to the 
constraints of the mission 
Critically, these high-angular resolution positions enabled followup observations 
from the ground, identiﬁcation of host-galaxies, and a measurement of their redshift 
(cosmological distance) for the ﬁrst time [114]. These observations placed the 
origin of the long-GRB population ﬁrmly within distant galaxies, conﬁrming the 
primary conclusions drawn from the BATSE data but left some questions as to the 
origin of short-GRBs which, due to their prompt emission lasting less than 1 s (see 
Fig. 2), were undetectable by the time a follow-up observation could be conducted 
(see [114] for a good review after the discoveries enabled by BeppoSAX). 
At the turn of the millennium the success of the BeppoSAX mission demon-
strated the value of followup observations and made signiﬁcant contributions to 
our understanding of GRBs but left many questions as to their origin and nature 
unanswered due to the limited effective area of the detector system itself and 
the limitations of its followup strategy. Even prior to the launch of BeppoSAX, 
proposals for much larger observatories with effective area of an order of magnitude 
larger had been in circulation. The results gathered up to that point underscored the 
need for this class of new, larger, instruments with greatly improved reporting and 
follow-up capabilities. Here the “new” materials CdTe and CZT would play a key 
role in their realization. 
3 
The CdTe/CZT Revolution 
At the close of the last millennium the ﬁrst true imaging detector utilizing 
segmented semiconductors had been successfully demonstrated on high-altitude 
balloon ﬂights boosting conﬁdence that the coded-aperture technique could be 
successfully deployed in the space environment. Additionally, the recent success 
of the BeppoSAX mission had also demonstrated the feasibility and importance 
of followup observations utilizing instrumentation within the same spacecraft and 
Mission Operation Center (MOC) to provide actionable alerts for rapid observations 
from other observatories at multiple wavelengths. With BeppoSAX serving as a

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
193
rapid alert system, the collective use of the assets of the astronomical community 
enabled a revolution in our understanding of one of the most enigmatic transient 
phenomena GRBs. 
Building on technologies demonstrated in the mid-90s, which produced some of 
the ﬁrst non-Si semiconductor based imaging instruments (cf. Sect. 2.2), segmented 
detectors with one CdTe or CZT crystal serving as a discrete pixel were scaled up 
dramatically enabling the ﬁrst generation of large area, wide-ﬁeld monitors. This 
was made possible, in large part, due to the increasing availability and quality of 
commercially produced material which allowed astronomers to overcome the intrin-
sic limitations in effective area imposed by the use of gas-ﬁlled position sensitive 
proportional counters at high energy, and avoid the complexity of integrating a large-
scale cooling unit into this generation of all-sky monitors. Two missions containing 
this next-generation monitoring technology were proposed and ﬁelded in the early 
2000s to survey the hard X-ray sky and fulﬁll the rapid-alert role of the BeppoSAX 
mission: INTEGRAL (Sect. 3.1) and Swift (Sect. 3.2). 
3.1 
Integral 
The International Gamma-Ray Astrophysics Laboratory (INTEGRAL) was  
designed and deployed to provide high-resolution spectroscopy as well as precise 
positions of X/gammaγ -ray sources over the 15 keV to 10 MeV energy range. It 
was conceived as a ESA/NASA/Russian collaboration whose baseline design 
contained two primary instruments, as well as two secondary monitors, just 
prior to its selection as a medium-class mission within the ESA “Horizons 2000” 
framework in 1993 [130]: 
1. A spectrometer consisting of 3 times× 3 array of “large volume” 68 mm diameter, 
80 mm long Ge detectors sensitive between 15 keV and 10 MeV. For background 
reduction these detectors were to be surrounded by an active BGO shield. 
Together with a coded-aperture mask ﬁxed 4 m away from the surface of the 
detectors, an angular resolution of 1.4Superscript ring◦was expected with a 10Superscript ring◦FoV Full-Width 
Half-Maximum (FWHM) and a detector area of 327 cmsquared2. 
2. A wide ﬁeld coded-aperture imager utilizing 3 stacked CsI detector planes 
coupled with a BGO active shield mounted between the lower CsI plane and 
the spacecraft surface for background reduction. As originally envisioned, each 
CsI detector plane would have contained 2500 individual 1 cmsquared2 bars each 
individually coupled to a Si PIN diode; a 2500 cmsquared2 active area in total. With 
a coded-aperture mask mounted at a distance of 4 m above the detector plane an 
angular resolution of 17prime′ would have been possible over a 70 keV to 10 MeV 
energy range (contingent on the mask transparency at the higher energy range). 
By 1995 the wide-ﬁeld coded-aperture imager had been renamed Imager on 
Board the INTEGRAL Satellite (IBIS) and the upper CsI detector plane replaced 
with the ISGRI instrument, a 2600 cmsquared2 CdTe detector plane consisting of 2 mm

194
B. Allen
Fig. 3 (Left) the  ISGRI “Polycell” (from [90]) and (Right) the BAT “Detector Module” (from 
[16]). The ISGRI polycell supports the operation of a 4 times× 4 array of 4 mm square, 2 mm thick 
CdTe crystal read out by 4 ASICs, each with 4 input channels. The BAT-DM, on the other hand, 
supports the readout of a 8 times× 16 array of CZT crystals of the same size and thickness 
thick, 4 mm square detector elements produced by AEROTECH (now ACRORAD). 
The two lower CsI detector planes, now designated Pixelated Imaging CsI Telescope 
(PICsIT), were reduced to a single 3100 cmsquared2 plane. Ultimately the form of this 
detector plane underwent little change from this point until its launch from the 
Baikonur, Kazakhstan on 17 October 2002 and is currently still in operation. Of 
note, the mission occupies a highly elliptical 9000 kmtimes× 154,000 km (approximately 
1.4 R⊕times× 24 R⊕) orbit which coincidentally happens to be quite similar to that of the 
ISEE-1 mission’s orbit that carried the ﬁrst CdTe detectors into space (see Sect. 1.3). 
The ISGRI instrument was composed of 16384 individual CdTe elements 
selected from pool of 29600 CdTe crystals. The full detector plane design was 
modularized to facilitate efﬁcient and safe integration where the fundamental 
building block consists of a single “polycell” containing a 4 times× 4 array CdTe crystals 
situated on the upper surface (see Fig. 3). On the back a 2 times× 2 array  ASICs is  
mounted each of which support 4 readout channels, 16 total. A 8 times× 16 array of 
“polycells” are then combined into a single Modular Detection Unit (MDU) and, 
ﬁnally, a 2 times× 4 array of MDUs comprise the whole of the ISGRI detector plane. 
At the time of its launch the ISGRI array was, by far, the largest CdTe detector 
ever placed into space. 
3.2 
Swift 
At the same time, efforts within NASA were concentrated on the development and 
launch of the Swift mission whose primary goal would be the rapid identiﬁcation 
and follow-up observation of GRBs within 60 seconds or less. Where followup 
observations with BeppoSAX required up to a 12 hour wait following the detection

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
195
Fig. 4 The layout of the Swift mission (modiﬁed from [51]). The Swift-BAT coded aperture 
telescope is made up of 256 DMs (see Fig. 3) each containing 128 individual CZT that all together 
make up the 32768 pixels of the BAT detector plane 
of an event, Swift was designed to automatically detect and localize X-ray transients 
with a single wide-ﬁeld monitor then slew the spacecraft to place a GRB, or other 
transient X-ray source, within the FoVs of the narrow ﬁeld instruments capable of 
conducting more detailed observations and precise (arcsec scale) localization, all 
without human intervention. 
The Swift Mission was selected for a Phase A study in January 1999 and then for 
ﬂight in October of the same year under the NASA Explorer’s program as a medium 
class mission MIDEX [51] with the primary objective of uncovering the source and 
nature of the environment about GRBs. To achieve this Swift was equipped with the 
following 3 instruments: 
1. a wide ﬁeld instrument, the Swift BAT [16], which would be responsible for the 
initial detection of GRBs and their automated localization (see Fig. 4). 
2. a soft grazing incidence X-ray telescope, the Swift X-Ray Telescope (XRT), 
which would provide follow-up observations and provide high-quality spectra 
and reﬁned positions for the GRB afterglow. 
3. a UV telescope, the Swift Ultraviolet/Optical Telescope (UVOT), which was 
added for yet better reﬁnement and characterization of detected GRBs in the  
EUV. 
Similar to the ISGRI instrument the Swift BAT was composed of discrete 
detector elements bonded to ASICs and assembled into tileable modules (see Fig. 3) 
which were assembled into a very large detector plane [16], but with some important 
key differences. First, the BAT instrument made use of 4 mmtimes× 4 mm, 2 mm thick 
CZT procured from eV products in place of CdTe. Second, the Swift-BAT detector 
is about a factor of 2 larger than the ISGRI detector plane and contains a 32768 
individual detectors with a total active area of approximately 5242 cmsquared2 active 
area with an extent of 1.2 m times× 6.0 m. Finally, the FoV of the BAT instrument is

196
B. Allen
much larger than that of ISGRI subtending roughly 1.2 sr Full-Width Half-Intensity 
(FWHI) maximizing the number of bursts that may be imaged and pursued. 
Critically, the Swift mission also was built with the ability to rapidly downlink 
derived transient event information through the Tracking and Delay Relay Satellite 
(TDRS) system for rapid distribution to ground-based observers. In this way Swift 
was designed to enable the determination of the redshifts, a proxy for cosmological 
distances, for as many GRBs as possible. Over 19 years of nearly continuous 
operation since its launch on 20 November 2004, the Swift mission has succeeded 
magniﬁcently in this goal and remains the premiere GRB and X-ray transient 
monitor in operation to date also remains the largest CZT array ever launched. 
3.3 
The Dawn GRaND Experiment 
It is important to note here that, although the Swift BAT is the ﬁrst imager and 
instrument to make use of CZT in a major astrophysics mission, the ﬁrst CZT 
utilized in spaceﬂight was actually deployed on the planetary science mission Dawn. 
At the same time that INTEGRAL ISGRI and the Swift BAT were in development, 
the planetary science community had also been conducting their own investigation 
into the use of CZT for the characterization of the elemental compositions of 
planets and asteroid through nuclear line-emission spectroscopy [116]. Using this 
information, together with in situ observations from other instruments, information 
regarding the formation history of small bodies may be deduced. 
For this purpose Dawn carried 3 instruments including the Framing Camera 
(FC), a Visible and Infrared Spectrometer (VIR), and GRaND (see Fig. 5). Of 
Fig. 5 (Left) A cross section of the GRaND instrument that was mounted to the deck of the Dawn 
mission (reproduced from [115] with permissions)

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
197
primary interest here is GRaND which consisted of: (1) a bismuth germanate 
(BGO) scintillator with 300 cmsquared2 volume at its core; (2) a 4 times× 4 array of CZT 
10 mmtimes× 10 mmtimes× 7 mm crystals, each conﬁgured as co-planar grids (CPGs) and 
optimized for spectroscopic measurements; (3) a two L-shaped boron loaded plastic 
(BLP) scintillators surrounding the sides of the BGO and CZT array primarily to 
provide sensitivity to neutrons; and (4) a two BLP phoswitch detectors located 
above and below the CZT and BGO instruments which are also sensitive to neutron 
interactions [115]. 
The Dawn mission was launched on 27 September 2007 and entered orbit around 
4 Vesta on 16 July 2011 within the asteroid belt after a nearly 4 year cruise. 
Following a 14 month observation period Dawn began its departure from 4 Vesta 
orbit on 25 July 2012 beginning a 2 year transit to 1 Ceres arriving on 6 March 2015. 
Dawn collected data for another 2 years around 1 Ceres before end of mission on 
11 November 2018. Dawn, though inactive, remains in orbit around 1 Ceres and 
carries with it the most well traveled CZT array ﬁelded thus far. 
4 
Beyond Wide-Field Imagers: CZT Comes into Focus 
Up to the early- to mid-2000s all CdTe or CZT instruments deployed were either 
simple spectrometers or used as a detector plane in a coded-aperture telescope, or 
other wide-ﬁeld imager, but not any sort of focusing optic. This is due in large part 
to the limitations of grazing incidence optics whose reﬂectivity rapidly decreases 
beyond energies around 15 keV. These mirrors are typically coupled with CCD’s 
such as those found in the Swift-XRT [28], Chandra or XMM Newton given their 
availability and the overlap in usable energy ranges. 
Advances in X-ray mirror technologies during the late 1999s/early 2000s 
signiﬁcantly extended the effective energy range of grazing incidence mirrors. 
The introduction of “super-mirrors”, e.g. [154], with adequate response up to 
approximately 100 keV made possible the potential deployment of hard X-ray 
missions with arcsec angular resolutions for the ﬁrst time. Since Si detectors become 
nearly transparent to hard X-rays pixelated CZT detectors, which had reached 
a sufﬁcient level of maturity in the preceding decade, were chosen as a natural 
alternative. The primary drawback of these optics was, and remains, the long focal 
lengths required to realize imaging up to 80 keV. Nonetheless initial balloon ﬂights 
to prove out these concepts were conducted by at least three groups during the early 
2000s in preparation for a potential space mission: High Energy Focusing Telescope 
(HEFT) [63], International Focusing Optics Collaboration for μ-Crab Sensitivity 
(InFOCμS) [106], and High Energy Replicated Optics (HERO) [118, 119]. 
Ultimately the HEFT group expanded on the mirror and detector technologies 
demonstrated in their balloon ﬂights and proposed the Nuclear Spectroscopic 
Telescope Array (NuSTAR) mission as a Small Mission Explorer (SMEX) to

198
B. Allen
Fig. 6 (Top) The  NuSTAR telescope with the optics fully deployed; the instrument as a focal 
length of 10.4 m. (Bottom) Major components of the NuSTAR instrument in it’s launch 
conﬁguration before extension of the mast (from [64]) 
NASA [64]. NuSTAR was launched on 13 June 2012 and made use of a deployable 
boom (see Fig. 6) to realize the focal lengths necessary to produce the world’s ﬁrst 
and only, spaceﬂight, focusing hard X-ray telescope. 
Technologies that had been developed by AEC-Able Engineering, now part of 
ATK space systems, in the previous decade for the Shuttle Radar Topography 
Mission (SRTM) experiment demonstrating the space use of 50 m extensible and 
retractable masts from the Space Shuttle [81]; and advances in CZT detector tech-
nology were brought together by the NuSTAR collaboration to produce the world’s 
ﬁrst and, currently, only operating space-based focusing hard X-ray telescope. 
NuSTAR has provided unprecedented sensitivity in the moderately hard X-ray 
regime between 15 and 85 keV enabling improved estimates of the spins and masses 
for select black holes (e.g. [140]), precise morphological studies of the distribution 
of residual radioactive isotopes in Cassiopeia A, a supernova remnant, that have 
been gradually decaying since the original supernova explosion [59], resolution of 
up to 33%-39% of sources making up the hard component of the cosmic X-ray 
background (CXB) conﬁrming the existence of an obscured population of Active 
Galactic Nucleis (AGNs) [65], as well as a series of solar observations [60], etc. It 
can be expected that the next generation of mirrors and CZT and/or CdTe detectors 
will play a signiﬁcant role in this energy range in the years ahead in all branches of 
space science.

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
199
5 
Pixelated and Strip Detectors Become Standard 
The amazing successes of the ISGRI (Sect. 3.1), BAT (Sect. 3.2) and NuSTAR 
(Sect. 4) instruments have heightened the proﬁle and familiarity of CZT and CdTe 
within the astrophysics community where it is now viewed as a fairly standard 
material, although the construction and deployment of such detectors remains a 
signiﬁcant challenge. 
The complexity of the assembly process for the ISGRI and BAT instruments, 
which both used discrete crystals as single detector pixels is widely recognized, 
as are the limitations in the minimum achievable pixel size and the difﬁculties 
associated reduction of parasitic noise sources on the interconnects of such arrays. 
This was avoided with the use of pixelated CZT in the NuSTAR instrument launched 
nearly a decade later. Since the mid-1990s (see Sect. 2.2) development of CZT, CdTe  
or other non-Si semiconductor for deployment in space generally includes detector 
crystals with some form of anode and/or cathode segmentation. The most common 
conﬁgurations are the use of an array of square anode pixels or the application strips 
on the anode and cathode side where the strips on opposite sides of the crystal 
are oriented orthogonally to one another, so-called Double-Sided Strip Detectors 
(DSSDs). The latest notable example is the HPGe based Compton Spectrometer 
and Imager (COSI) mission [142] a Compton telescope for astrophysics sensitive 
between 0.2–3 MeV which makes use of Double-Sided Strip Detectors and is 
currently scheduled for a launch in 2025 as NASA’s latest SMEX mission. 
For CZT, CdTe and other room temperature semiconductors spaceﬂight develop-
ment within the U.S. and Europe has been primarily focused on the development of 
pixelated detectors since at least the early 2000s, with signiﬁcant interest in CdTe 
DSSD development in Japan. The Indian Space Research Organization has also 
ﬁelded a number of instruments for all branches of space science reliant on pixelated 
CZT detectors. 
A key component of this development, regardless of the segmentation strategy, 
has been improvement in detector contact deposition over the past 15 years as 
well as the production and availability of low-power ASICs. These advances 
have enabled the creation of high resolution position sensitive detector systems 
that may be supported within the power and thermal constraints of spaceﬂight; 
the speciﬁc constraints of each mission are naturally dependent upon the target 
spacecraft or platform (e.g. SmallSat, CubeSat, International Space Station (ISS), 
etc). Although the trend toward ﬁner pixelization for many applications, coupled 
with the requirement for large areas in non-focusing instruments produce signiﬁcant 
challenges in the design of viable instrumentation, corresponding reductions in 
device power density over the last 20 years have enabled the realization of ﬁnely 
pixelated (or ﬁne pitch strip) detectors at the 100 normal muμm level and smaller (see Table 1) 
that may be credibly considered for spaceﬂight. 
This is enabling a new generation of highly capable instruments while avoiding 
many of the drawbacks and difﬁculties associated with the construction of the ﬁrst

200
B. Allen
Table 1 Characteristics of selected and potential spaceﬂight ASICs used with CdTe and/or CZT 
based detector systems 
P/N or name
NSubscript upper C h comma upper I nCh,In
Pwr. [mW/ch] 
Year Intro. 
Notes 
ISGRI95 [15, 23]
4
2.8
1996
ISGRI 
XA1.2 [16]
128
2.8
2000
BAT [16], Mfg. Ideas 
HEFT [30, 35]
1054
47 times 10 Superscript negative 347 × 10−3
1998
HEFT Balloon Flight 
Direct Bond: 24 times× 44 
498 normal muμm Pitch 
NuSTAR Precurssor 
NuASIC
1024
47 times 10 Superscript negative 347 × 10−3
to 92 times 10 Superscript negative 392 × 10−3
2008
NuSTAR [64] and  
ProtoEXIST2 [12] 
Direct Bond: 32 times× 32 
604.8 normal muμm Pitch  
Note: Pwr. dep. on operation 
cond. 
VATA-
SGD [135, 136] 
64
0.3
2003
Hitomi-SGD [136], Mfg. 
Ideas 
FOXSI-3 [50] 
IDeF-X [93]
64
0.6–2.8
2006
Basis for Caliste-64, -256, and
-SO 
STIX uses Caliste-SO [95] 
SVOM uses the IDeF-X 
ECLAIRs [52, 89] 
Note: At least 7-variants 
w/diff. Pwr. 
HEXITEC [80, 124]
6400
220 times 10 Superscript negative 3220 × 10−3
2009
Direct Bond: 80 times× 80 
250 normal muμm Pitch 
generation of wide-ﬁeld imagers and has lead a large fraction of the space-science 
community to adopt pixelated CZT detectors as a fairly ubiquitous standard, with 
a few notable exceptions (e.g. position sensitive virtual Frisch grid detectors [96], 
etc.). 
6 
Recent Development Activities and Missions 
Over the last 15 years the supply of ASIC, CZT and CdTe have improved 
dramatically enabling the development of many different instruments and missions 
cutting across all segments of space science. Below I outline some of the most recent 
activities within the last decade and highlight some of the ongoing efforts.

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
201
6.1 
Wide-Field Instrumentation for Astrophysics 
The recent discovery of gravitational waves and the detection of only a single 
electromagnetic counterpart, designated GW170817, has highlighted the need 
for improved wide-ﬁeld monitoring with prompt detection, characterization, and 
reporting capabilities. There are currently a large number of missions and concepts 
under development utilizing Si, scintillator, CZT/CdTe, etc., often combined within 
a single mission. 
The High Resolution Energetic X-Ray Imager (HREXI) program (formerly 
ProtoEXIST) has developed a number of tileable CZT detector plane architectures 
that utilize large numbers of 2 cmtimes× 2 cm, 5 or 3 mm thick pixelated  CZT detectors. 
Two prototypes have been qualiﬁed in successful high altitude balloon ﬂights, 
ProtoEXIST1 (2009 ﬂight) [11] utilizing an 8times× 8 array of detectors with a 2.5 mm 
pixel pitch and ProtoEXIST2 (2012 ﬂight) [12, 70] which utilized the NuSTAR 
ASIC (NuASIC) to reduce the pixel pitch of the array to 604.8 normal muμm. The HREXI 
effort is ongoing with a reﬁnement of the ProtoEXIST2 detector plane architecture 
underway based on lessons learned from the ProtoEXIST experience. Depending 
on the deployment method chosen, detector areas of up to approximately 4 msquared2 are 
feasible on a large spacecraft. Currently low-cost implementations are under study 
on SmallSats to enable the launch of multiple independent spacecraft into LEO. If  
realized, this detector net would achieve all-sky coverage with high sensitivity over 
the 3 keV to 1 MeV (approx.) energy range and while enabling arcmin localization, 
rapid reporting and characterization of transient sources including Gravitational 
Wave (GW) counterparts. 
Meanwhile, the Indian Space Research Organization designed and deployed a 
mission to LEO that is, in many respects, similar to Swift: ASTROSAT [128] 
(28 September 2015-Present). Like Swift, ASTROSAT is equipped with a wide-
ﬁeld monitor, CZT Imager (CZTI), which is a coded aperture imager based on 
4 cmtimes× 4 cm, 5 mm thick General Electric (GE) (formerly Orbotech, formerly 
Imarad) CZT with a total active area of 976 cmsquared2 and a coded-mask afﬁxed 
481 mm above the detector plane [18, 29]. In the ﬁrst 16 months of operation 
CZTI was able to detect approximately 96 GRBs, performed timing measurements 
and simultaneously probed the hard X-ray polarization of the Crab nebula [120]. 
In the interim CZTI continues operation and regularly reports on the occurrence 
and properties of transient X-ray events including GRBs. On an additional note, the 
baseline detector plane architecture of the CZTI instrument has been used on at least 
2 other spaceﬂight missions in which Indian Space Research Organization (ISRO) 
participated or led: Chandrayaan-1 (Sect. 6.6) which carried out observations of the 
moon from lunar orbit and CORONAS-PHOTON, a Russian payload where ISRO 
provided a hard X-ray instrument for solar observations (Sect. 6.7). 
To expand their wide-ﬁeld transient monitoring capability, ISRO has proposed 
and is developing the Daksha [19, 20] high-energy transient mission with a heavy 
focus on rapid detection and characterization of GW counterparts. One of the 
instruments responsible for the localization of hard X-ray sources will utilize

202
B. Allen
the same baseline CZT detector plane architecture which ISRO has ﬁelded since 
the launch of Chandrayaan-1 but reconﬁgured and optimized to provide full 
sky coverage to maximize the detection probability of Gravitational Wave event 
counterparts. 
Another mission focused on the detection of GW counterparts is the joint 
sino-ESA effort, the Space-based Astronomical Variable Object Monitor (SVOM) 
mission, which is approaching its launch date, expected in 2023, and includes 
a suite of instrumentation to characterize X/gammaγ -ray transients including a CdTe 
based wide-ﬁeld monitor ECLAIRs which makes use of the Imaging Detector 
Frontend (IDeF-X) ASIC. IDeF-X has been developed and ﬂight qualiﬁed over 
approximately the last 15 years at the Commissariat à l’énergie atomique et aux 
énergies alternatives (CEA). The ECLAIRs detector plane utilizes an array of 6400 
discrete 4 mmtimes× 4 mm, 1 mm thick CdTe crystals to produce an imaging detector 
with a total active area of 960 cmsquared2 in a manner analogous to that of ISGRI. With the 
placement of a 2D coded aperture mask 46 cm above the detector plane ECLAIRs 
will have a 22.1Superscript ring◦times× 22.1Superscript ring◦FoV [58] with a usable energy range extending from 
4 keV up to 150 keV. SVOM will operate similarly to Swift in order to perform 
automated followup observation of transient sources for their characterization and 
dissemination of alerts to the community. 
On a ﬁnal note, there currently are a large variety of wide-ﬁeld instruments 
and mission concepts for their deployment in all phases of development targeting 
time domain multi-messenger astrophysics (TDAMM). These make use of a wide 
variety of detector systems which are not discussed here in any detail, and which are 
complementary and sometimes competitive with CZT and CdTe based instruments. 
6.2 
Hard X-Ray Focusing Missions 
The success of the NuSTAR mission unambiguously demonstrated the power of 
coupling new grazing incidence mirror technologies with CZT. Although this had 
been anticipated by a number of groups who were pursuing parallel development 
efforts (see Sect. 4) throughout the 2000s only one other such instrument has been 
deployed in a spaceﬂight mission. 
The Hard X-Ray Imager (HXI), was launched with the Hitomi mission (previ-
ously ASTRO-H or New exploration X-ray Telescope (NeXT)) on 17 February 2016 
together with 3 additional instruments [136, 137]: (1) the Soft X-ray Imager (SXI) 
which built on heritage from the Suzaku (Astro-E) X-ray Imaging Spectrometer 
(XIS) [66] was a focusing X-ray telescope utilizing an X-ray CCD provided by 
MIT/LL; (2) the Soft X-ray Spectrometer (SXS) was the ﬁrst micro-calorimeter 
used in spaceﬂight for astrophysics which conducted observations (e.g. [32]) 
and achieved an energy resolution of 5 eV; (3) the Soft Gamma-Ray Detector 
(SGD) [135] which was a low background Compton spectrometer optimized for 
the characterization of source spectra between 10 keV and 600 keV.

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
203
The HXI shared many common features with NuSTAR including an extendable 
optical bench (i.e. mast) which would have enabled a 12 m focal length and 
would have been sensitive over the 5 to 80 keV energy range with a Half-
Power Diameter (HPD) of 1prime′.7 (cf. NuSTAR approx. 1prime′). The primary difference 
lies in the implementation of the detector system. Here the HXI made use of a 
combination of Si DSSDs and CdTe DSSDs. Ordered from the mirror toward the 
direction of the detector plane, the HXI consisted of a vertical stack of 4 layers of 
0.5 mm thick Si detectors with a single 0.75 mm thick CdTe detector located at the 
bottom. The pitch of the strip pattern deposited on both Si and Cd detectors was 
250 normal muμm. The stacking of detector planes mitigated the need to use a single, thick, 
detector crystal as was done in NuSTAR easing the fabrication requirements on the 
CdTe which, in contrast to CZT, remains difﬁcult to grow into thick boules. 
Unfortunately, the Hitomi mission was lost on the 26 March 2016 shortly after 
the deployment of the optical bench for the HXI. However, during a short period 
between the 19 March and 26 March of that year HXI was able to conduct short 
observations of G21.5-09 (a supernova remnant) and the Crab nebula, the “standard 
candle” of X-ray astronomy [99]. 
6.3 
Compton Imagers and Spectrometers 
Both the Hitomi HXI and SGD beneﬁted from a long-running development program 
combining the use of Si and CdTe strip detectors, using CdTe from ACRORAD. 
In the case of the SGD this was used for the creation of sensitive hard X-ray 
spectrometer with polarization measurement capabilities [135]. This instrument has 
gone through multiple iterations of development over the last 20 years with one 
of the latest versions selected for inclusion and eventually launched with Hitomi. 
Like the HXI (see Sect. 6.2) the  SGD was also able to conduct some observations 
beginning on 24 March 2016 prior to the loss of the mission two days later on 
26 March 2016 [99, 136]. 
The SGD targeted a 10–600 keV energy range and was conﬁgured to function 
as a collimated instrument that would not required high positional resolution of 
individual events. The full instrument consisted of 3 detector units, each with 
their own collimator, and surrounded by a BGO active shield. Ordered from the 
collimator to the bottom of the instrument the 3 individual detector planes consisted 
32 stacked 0.6 mm thick Si detectors followed by another 8 layer stack of CdTe 
detectors, each with a thickness of 0.75 mm. On the anode surface of both the Si 
and CdTe detectors, a square pixel pattern with a 3.2 mm pitch was applied over a 
51.2 mm span, i.e. 16 times× 16 pixel pattern. With limitations in the size of CdTe crystals 
available each CdTe layer is actually consists of 4 buttable crystals in order to match 
the active area of the overlying Si detectors. The entire stack is surrounded by a 
2 layer thick wall each consisting of identical 0.75 mm thick CdTe detectors [136]. 
In spite of its short lifetime this instrument managed to produce a measurement of 
the degree of polarization in the Crab nebula during the initial on-orbit checkout [69]

204
B. Allen
and a new version of this, the mini-SGD, is scheduled to ﬂy as part of a balloon 
payload from Alice Springs, Australia, this spring (2023) [100]. 
6.4 
A Quick Note on XRISM: The Hitomi Successor 
Following the loss of the Hitomi mission Japan Aerospace Exploration Agency 
(JAXA) and NASA agreed to the fabrication and launch of a mission primarily 
to replace the loss of the micro-calorimeter, the SXS, which provides unique 
capabilities that have heretofore remained unrealized on orbit; the loss of the Hitomi 
mission is in fact the third failed attempt to deploy an X-ray micro-calorimeter to 
LEO. 
In light of the high-priority assigned to this instrument by JAXA, NASA and the 
high energy astrophysics community the X-Ray Imaging and Spectroscopy Mission 
(XRISM) mission was rapidly approved and is nearing launch expected sometime 
after August of this year (2023) [1]. 
In order to reduce mission risk and cost the decision was made to maintain the 
design of the Hitomi mission but remove the extensible optical bench, including 
the instruments mounted to it: the Soft Gamma-Ray Detector (SGD) (Sect. 6.3) and 
the Hard X-Ray Imager (HXI) (Sect. 6.2) [75, 141]. The SXS (renamed: Resolve) 
and the XIS (renamed: Xtend) largely retain the same capabilities as the instruments 
from the Hitomi mission but the two CdTe-based instruments, regrettably, must wait 
for another ﬂight opportunity. 
6.5 
Instrumentation for Earth Observing 
Traditionally observation of the Earth in gammaγ -rays was originally carried out for 
nuclear weapons test ban monitoring (e.g. the Vela program brieﬂy described in 
Sect. 1.2). In the 1990s the BATSE detection of a new and unexpected atmospheric 
phenomena [46], Terrestrial Gamma-Ray Flashs (TGFs), has fueled increasingly 
intensive research efforts over the past 30 years with over 1000 detections conﬁrmed 
in a wide variety of high-energy instruments in LEO and is a problem that spans 
the study of Earth science, heliophysics and space-weather. An association between 
TGFs and thunderclouds was discovered almost immediately and conﬁrmed in many 
subsequent observations. The current leading theories are that the intense electro-
magnetic ﬁelds generated in thunderclouds provide an acceleration mechanism for 
electron’s at high altitude up to GeV scale energies which can produce an upward 
directed Extensive Air Shower into space resulting in a ﬂash of high energy photons 
that may be detected in our ﬂeet of orbiting observatories. 
In order to study this phenomena the Atmospheric-Space Interactions Monitor 
(ASIM) experiment was deployed to the ISS on 2 April 2018. ASIM consists of two 
individual instruments:

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
205
1. the Modular X-Ray and Gamma-Ray Sensor (MXGS) which utilizes a two-
layer detector plane where the upper layer consists of a tiled array of 
4 cmtimes× 4 cm, 5 mm thick  CZT each with a 16times × 16 pixelated anode on a 
2.5 mm pitch. Each individual detector is coupled to two XA-1.82 ASICs from 
Ideas (i.e. 128 ch/ASIC). Fully assembled, the entire detector plane comprises a 
total active area of 1024 cmsquared2. The lower detector plane is comprised of an array 
of four 15 cmtimes× 15 cmtimes× 3.2 cm BGO bars, each with a separate readout giving 
an active area of 900 cmsquared2. A coded aperture mask is mounted 30.3 cm above the 
detector plane to provide an imaging capability for high energy transients within 
the Earth’s atmosphere [109]. 
2. the Modular Multi-Spectral Imaging Array (MMIA) is designed to monitor the 
Earth in the same region as the MXGS in order to capture and characterize 
Transient Luminous Events (TLEs) [58]. 
In this way the ASIM experiment is beginning to study the association between 
contemporaneous optical TLEs and high-energy TGFs in order to clarify their indi-
vidual natures as well as to unmask the relationship between these two phenomena. 
6.6 
Solar Instrumentation 
So far ISRO has launched 3 missions making use of 5 mm thick, 4 cmtimes× 4 cm  
CZT crystals provided by GE medical devices (formerly Orbotech) for in situ 
characterization of the Lunar surface (Chandrayaan-1), observation of hard X-ray 
sources and transients (ASTROSAT-CZTI), and for solar observations in partnership 
with Russia. The ISRO contribution to the Russian CORONAS-PHOTON mission, 
RT-2, consisted of 3 GE CZT crystals [101]. Here two different imaging techniques 
were attempted (1) using a Fresnel zone plate and (2) a coded aperture imager. The 
mission launched on 20 January 2009 but was terminated in December of the same 
year impeding the science return of this instrument. 
More recently the Solar Orbiter [97] (10 February 2020-Present), an ESA M-
class mission with contributions from NASA, launched a CdTe detector plane based 
on the Caliste architecture that has been in development led by CEA with Le site du 
Centre national d’études spatiales (CNES) for over 15 years. The primary science 
target of the Spectrometer/Telescope for Imaging X-rays (STIX) instrument is to 
perform hard X-ray imaging spectroscopy of solar X-ray ﬂares over the 4–150 keV 
energy range with a 7prime′ angular resolution. The STIX [88] instrument makes use 
of the indirect Fourier transform imaging that has been utilized for this purpose 
since at least the early 1990s; the Hard X-ray Telescope (HXT) of the Yohkoh 
mission utilized a similar optical assembly but with a PSPC [87]. Similar to the 
Parker Solar Probe, the Solar Orbiter mission will make close passes of the sun, 
coming within 0.28 AU, in order to resolve processes within the photosphere and 
corona, investigate the origin of the coronal magnetic ﬁeld and solar wind, the 
production of energetic particles in during solar eruptions and their interaction with

206
B. Allen
the heliosphere, etc. Through multiple gravity assist maneuvers the Solar Orbiter 
probe’s orbital inclination will be raised to 33Superscript ring◦enabling the best view of the solar 
polar region yet achieved. 
6.7 
Instrumentation for Planetary Science 
After the launch of the Dawn mission (see Sect. 3.3) efforts to deploy a CdTe 
or CZT gamma-ray spectrometer or imager have not progressed rapidly. I am 
aware of a single program under development which proposes the use of CZT: 
Ambient-Temperature Imaging Gamma-Ray Spectrometer (TIGRS) [104]. Here 
thick pixelated CZT detectors would be utilized to form a Compton imager which 
could map elemental abundance distributions with higher precision than is possible 
with a simple non-imaging spectrometer. Given the success of CZT and CdTe in 
astrophysics additional development efforts may certainly be expected in the near 
future. 
Outside of the U.S. the ISRO ﬂew a CZT based collimated spectrometer, the 
High Energy X-ray Spectrometer (HEX) instrument, for this purpose on the lunar 
observing mission Chandrayaan-1 that launched on 22 October 2008 and terminated 
less than 1 year later in August of 2009. The full detector plane made use of 
a 6 times× 6 array of 5 mm thick  GE CZT modules, the same described earlier in 
Sect. 6.6 and Sect. 6.1. The objectives of the HEX mission were focused on Lunar 
volatile transport of Superscript 222222Rn and an attempt to trace this process through observation 
of the Superscript 210210Pb decay line (46.5 keV). Although the HEX instrument was not able 
to achieve this objective due to high backgrounds and a reduction in the mission 
duration [146], the HEX experience paved the way for the standardized CZT 
detector plane system that has supported ISRO missions over the last decade and 
is likely to see deployment on future ISRO missions (e.g. Daksha; see Sect. 6.1). 
6.8 
A Quick note on Polarimeters 
Most of the discussions thus far have focused on imaging spectrometers but I have 
neglected to cover the topic of hard X-ray polarimeters. There are a number of 
concepts and balloon-borne payloads that make use of CZT for the characterization 
of X-ray polarization from astrophysical sources, but none that have been deployed 
to LEO or beyond, the Hitomi SGD and ASTROSAT CZTI excepted. 
Many of these concepts use a grazing incidence optic to concentrate X-ray 
photons onto a low-Z detector, Si or a scintillator, which is surrounded by a pixelated 
CZT detector plane. The hard X-rays which undergo Compton scattering in the 
low-Z detector may then escape for detection at the periphery within the CZT. 
The measurement of the initial deposited energy due to the initial scattering event 
coupled with the detection and measurement of the energy of the outgoing photon

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
207
in the CZT detector plane with the added positional information enables one to 
reconstruct the polarization vector of the source after the collection of many such 
events (e.g. XL-Calibur [4]). 
The development of instruments of this class can be expected to continue and 
it is conceivable that a mission dedicated to their deployment to LEO could occur 
within the next decade. 
7 
New Deployment Opportunities 
Over the last 20 years additional emphasis has been placed on improving access to 
space by a number of space agencies. I would argue that the JAXA and NASA have 
stood at the forefront of this effort and both have been aggressively expanding these 
programs not only for engineering and science payloads but as a public outreach 
and education tool as well. 
Within the scientiﬁc community there has been greater recognition that it is 
possible to achieve signiﬁcant science within constrained payloads, though this 
requires a great deal of ingenuity and effort in order to compensate for the imposed 
constraints. 
7.1 
CubeSats 
Since their introduction in the early-2000s CubeSats have gradually gained pop-
ularity due to their low-cost and the opportunities they provide for education and 
outreach. The scientiﬁc potential of these systems has also been recognized by 
NASA and other space agencies worldwide fueling a boom in their deployment. 
CubeSat spacecraft are available from a number of different commercial vendors 
but are designed to a strict standard to enable low cost attachment as a ride-along 
payload or for ﬂight to the ISS for eventual release. Each CubeSat adheres strictly 
to a 10 cmcubed3 form factor, i.e. 1U, and are commonly combined to produce 3U 
(10 cmtimes× 10 cmtimes× 30 cm) and 6U (10 cmtimes× 20 cmtimes× 30 cm) payloads. Depending on 
the vendor and mission requirements, scientiﬁc payloads may occupy up to 80–90% 
of the available volume. Most missions launched at present likely are accompanied 
by at least a few CubeSats. 
HaloSat was the ﬁrst dedicated NASA astrophysics mission that utilized a 
CubeSat and was released from the ISS on 13 July 2018. HaloSat was a X-ray 
line mapping mission launched to probe emission from ionized Oxygen in hot halos 
surrounding nearby galaxies in an effort to assess the contribution of this region 
to the cosmological mass budget [82]. The success of this mission demonstrated 
that low-cost, targeted science investigations within small payloads and budgets is 
possible.

208
B. Allen
It is also important note that a number of engineering and education payloads 
which have included CZT instruments as part of their payloads have also been 
deployed, in particular the Cosmic X-ray Background NanoSat (CXBN) 1 and
-2 [67, 127] which were launched in 2012 and 2015, though results on their 
measurements have, to my knowledge, not yet been published. 
Since that time a number of other CubeSats bearing CZT instruments have been 
launched, most recently Sharjah-Sat-1 [83] (3 January 2023), which will use a 
single 25.4 cm square, 3 mm thick CZT with a unique segmented anode pattern in 
conjunction with a collimator with the stated objective to characterize the hard X-ray 
component of the solar corona as well as monitor known hard X-ray astrophysical 
sources. 
With the expansion of launch opportunities that CubeSats afford together with 
the high-efﬁciency and relaxed thermal requirements that CZT and CdTe offer, the 
deployment of more small-scale instrumentation for a wide variety of cross-cutting 
science objectives using these materials is a near certainty. 
7.2 
SmallSats 
SmallSats are a larger class of ride-along payload which have been under develop-
ment for the last 15 years and are now routinely launched as well. The forerunner of 
the SmallSat can be traced to the “university-class” program that NASA initiated in 
1989 for the deployment of low-cost satellites in collaboration with institutions of 
higher education. One such mission, High Energy Transient Explorer 2 (HETE-2) 
launched on 9 October 2000 to explore the soft (2–25 keV) and hard (30–400 keV) 
X-ray regime was dedicated the study of GRBs and continued operation until 
2007 [122]. 
Subsequently, JAXA, then NASA began introducing standardized ports on the 
payload adapter ring which serves as the mechanical interface between the launcher 
and primary payload. These ports enable the mounting of additional sub-payloads, 
i.e. SmallSats, within the surplus space between the rocket and the primary payload. 
One of the earliest series of SmallSat launches was carried out by JAXA with the 
launch of the Hayabusa-2 mission on 2 December 2014 in this manner. 
A more recent SmallSat example is MoonBEAM [72] which carries a simple 
non-imaging scintillator system similar to that of the BATSE and the Gamma-ray 
Burst Monitor (GBM), and was selected for a Phase A study expressly for the 
detection of transient X-ray events. The key difference between MoonBEAM and 
previous scintillator based missions is that it will be injected into a highly elliptical 
cis-Lunar orbit, in some ways similar to that used for the ISEE-1 satellite, to enable 
near all-sky coverage during the observing runs of Gravitational Wave detectors, if 
it is ultimately selected for launch. A major reason for the serious consideration of 
MoonBEAM for launch rests with the widespread recognition that small missions 
can enable follow-up observations and thereby contribute to the advancement of our 
fundamental understanding of these short-duration phenomena.

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
209
For the same reason, and with the advantages that CZT offers for resource-
constrained payloads, and its demonstration on small CubeSat payloads, the deploy-
ment of these materials on a SmallSat mission, e.g. the HREXI effort described 
earlier in Sect. 6.1, is highly likely in the near future. 
8 
Some Current Science Drivers and New Opportunities 
Each decade the astronomical, planetary science, and heliophysics communities 
come together to deﬁne objectives and funding priorities for the next 10 years which 
is used by the federal funding agencies: NASA, National Science Foundation (NSF), 
etc. to deﬁne implementation strategies and policies to realize as many of the 
community’s objectives as possible within budget constraints. 
The last decadal survey for astrophysics heavily emphasized the need for new 
instrumentation and facilities [103] for the study of time domain multi-messenger 
astrophysics (TDAMM) phenomena, including GRBs and supernovas (SNs). This 
was motivated in no small part by the ﬁrst detection of Gravitational Waves in 
2016 [5] and their known connection to the mergers of compact objects (e.g. BHs 
and NSs) which, in some cases, results in an observable GRB. The additional 
need for enhanced followup capabilities exceeding those of the Swift mission and 
other currently operational payloads has been highlighted by the sheer number 
of gravitational wave detections (see Fig. 7) and the dearth of corresponding EM 
counterpart detections. 
In fact, the simultaneous detection of a gravitational wave event and identiﬁ-
cation of a EM counterpart has only been achieved once. The event, designated 
GW170817, was identiﬁed the merger of two Neutron Stars or a NS-NS merger. 
Approximately 1.7 s after the detection of the GW signature by 2 LIGO stations 
(Hanford, WA and Livingston, LA) and 1 Virgo station (Santo Stefano a Macerata, 
Italy) the INTEGRAL observatory and the Fermi-GBM, a more modern incarnation 
of the scintillator detector systems used ubiquitously in the search for GRBs since 
their discovery in the 1970s (see Sect. 1.2) [6]. These detections kicked off a massive 
campaign of follow-up observations that resulted in additional detections across the 
EM spectrum. The source of the EM emissions observed are consistent with the 
decay of r-process nuclei that are expected to arise during a NS-NS merger event 
and was consistent with the GW signature. 
When the joint LASER Interferometer Gravitational-Wave Observatory (LIGO)-
Virgo-Kamioka Gravitational Wave Detector (KAGRA) observing run resumes in 
mid-2023, it is plausible, even likely, that the current suit of instruments in orbit 
will, once again, enable such observations. However, due to the ﬂeeting nature of 
these events, along with the opportunity they provide to probe the physics of extreme 
environments, i.e. strong gravitational ﬁelds, neutron star equations of state, etc. 
there is a strong motivation to improve X-ray monitoring capabilities on orbit. 
Although not covered here in any detail, there are other transient phenomena 
of unknown origin, e.g Fast Radio Bursts (FRBs) only recently discovered in

210
B. Allen
Fig. 7 The minimum cumulative number of GRBs detected since their discovery in 1967 with 
the contributions of individual instruments derived the HEASARC provided data tables grbcat, 
hete2grb, fermi-gbm and pvogrb [2], as well as the 3rd Swift GRB Catalog [91] with removal 
of duplicate entires common to 2 or more of these catalogs. Though the impact of the BATSE 
instrument on our sample and understanding of GRBs was immense the much smaller sample 
acquired with BeppoSAX was equally impactful highlighting the value of followup observation. 
Plotted alongside the GRB detections are the number of Gravitational Wave events (magenta; 
derived from the “conﬁdent” GWTC catalog for LIGO/Kagra/Virgo over all observing runs up 
to the present (O1-O3) [3, 34]). Multi-wavelength followup and high-energy telescopes will play a 
signiﬁcant role in the study of these events in the years to come. 
2007 [92], which will require robust multi-wavelength follow-up capability for char-
acterization and eventual explanation. The addition of new ground-based facilities 
is the coming decade are also expected to vastly expand the transient monitoring 
capability across the EM spectrum, e.g. Canadian Hydrogen Intensity Mapping 
Experiment (CHIME) [33] in radio, the Vera Rubin telescope (formerly the Large 
Synoptic Survey Telescope (LSST)) [76] in visible/IR, a new generation of IACTs 
and wide-ﬁeld TeV instruments [7, 9]. This will provide additional opportunities 
as well as signiﬁcant challenges for multi-wavelength counterpart searches which 
will require additional monitoring capability in the X/gammaγ -band covered by CZT 
detectors in order to fully exploit the opportunities presented not only by the new 
GW detection capabilities, but the ﬂood of data that can be expected in the next 
decade and beyond for a wide variety for transients. 
9 
Conclusions 
Over nearly 45 years CdTe, then CZT detectors of increasing complexity and 
volume have been incorporated onto payloads for a wide-range of scientiﬁc inves-
tigations, ranging from the observation of phenomena in the Earth’s atmosphere, to

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
211
the study of solar ﬂares in our own Sun, and to uncover the mysteries surrounding 
the end states of stellar evolution, the history of star formation and nucleosynthesis, 
as well as the growth of black holes and for the study of extreme physical processes 
that cannot be replicated in laboratories on Earth. 
The evolution and maturation of CZT and CdTe technologies over the past 20 
years in particular have given the scientiﬁc community ample experience in their 
operation and proven that they may be reliably deployed into the space environment 
under a wide variety of conditions. The breakthroughs enabled by the last generation 
of CZT and CdTe wide-ﬁeld monitors and focusing telescopes has paved the way 
for future missions ranging from focused CubeSats to large next-generation wide 
ﬁeld monitors. These new instruments promise to play a key role in a wide range of 
investigations that touch and advance every facet of the space sciences, extending 
from processes taking place in our own atmosphere, to the exploration of the solar 
system, and all else the lies far beyond. 
10 
Glossary and Acronyms 
ANS
Astronomical Netherlands Satellite 
AGN
Active Galactic Nuclei 
ASAT
anti-satellite weapon 
ASCA
Advanced Satellite for Cosmology and AStrophysics 
ASIC
application speciﬁc integrated circuit 
ASI
Agenzia Spaziale Italiana 
ASIM
Atmospheric-Space Interactions Monitor 
AXAF
Advanced X-ray Astrophysics Facility 
BAT
Burst Alert Telescope 
BATSE
Burst and Transient Source Experiment 
BeppoSAX
Satellite italiano per Astronomia X 
BGO
bismuth germanate 
BH
black hole 
BLP
boron loaded plastic 
CCD
charge coupled device 
CEA
Commissariat à l’énergie atomique et aux énergies alternatives 
CHIME
Canadian Hydrogen Intensity Mapping Experiment 
CNES
Le site du Centre national d’études spatiales 
CORSA-b
Cosmic Radiation Satellite 
COSI
Compton Spectrometer and Imager 
CPG
co-planar grid 
CGRO
Compton Gamma-Ray Observatory 
CXBN
Cosmic X-ray Background NanoSat 
CXO
Chandra X-ray Observatory 
CZT
CdZnTe 
CZTI
CZT Imager

212
B. Allen
CXB
cosmic X-ray background 
DM
Detector Module 
DOD
Department of Defense 
DSSD
Double-Sided Strip Detector 
EAS
Extensive Air Shower 
EM
Electromagnetic 
ESA
European Space Agency 
EUV
Extreme Ultraviolet 
FC
Framing Camera 
FFT
fast Fourier transform 
FoV
Field of View 
FOXSI
Focusing Optics X-ray Solar Imager 
FRB
Fast Radio Burst 
FWHM
Full-Width Half-Maximum 
FWHI
Full-Width Half-Intensity 
GALCIT
Guggenheim Aeronautical Laboratory of the California 
Institute of Technology 
Galileo-SSI
Galileo solid state imager 
GBM
Gamma-ray Burst Monitor 
GC
galactic center 
GE
General Electric 
GEMS
Gamma Ray Environment Sensor 
Giotto-HMC
Giotto Halley Multicolour Camera 
GRaND
Gamma Ray and Neutron Detector 
GRB
Gamma-Ray Burst 
GRIS
Gamma-Ray Imaging Spectrometer 
GSFC
Goddard Space Flight Center 
GW
Gravitational Wave 
HEAO
High Energy Astrophysical Observatory 
HEASARC
High Energy Astrophysics Science Archive Research Center 
HERO
High Energy Replicated Optics 
HEFT
High Energy Focusing Telescope 
HETE-2
High Energy Transient Explorer 2 
HEX
High Energy X-ray Spectrometer 
HEXITEC
High Energy X-ray Imaging Technology 
HPD
Half-Power Diameter 
HPGe
High Purity Germanium 
HREXI
High Resolution Energetic X-Ray Imager 
HRI
High Resolution Imager 
HST
Hubble Space Telescope 
HXI
Hard X-Ray Imager 
HXT
Hard X-ray Telescope 
JAXA
Japan Aerospace Exploration Agency 
JPL
Jet Propulsion Laboratory 
KAGRA
Kamioka Gravitational Wave Detector

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
213
IACT
Imaging Atmospheric Air Cherenkov Telescope 
IBIS
Imager on Board the INTEGRAL Satellite 
IDeF-X
Imaging Detector Frontend 
InFOCμS
International Focusing Optics Collaboration for μ-Crab 
Sensitivity 
ISGRI
INTEGRAL Soft Gamma-Ray Imager 
ISRO
Indian Space Research Organization 
INTEGRAL
International Gamma-Ray Astrophysics Laboratory 
ISEE
International Sun-Earth Explorer 
ISS
International Space Station 
LAD
Large Area Detector 
LIGO
LASER Interferometer Gravitational-Wave Observatory 
LDB
long-duration balloon ﬂight 
LEO
low Earth orbit 
LSST
Large Synoptic Survey Telescope 
MCP
Microchannel Plate 
Mfg.
Manufacturer 
MIDEX
Medium-Class Explorer Mission 
MMIA
Modular Multi-Spectral Imaging Array 
MPI
Max Planck Institut 
MXGS
Modular X-Ray and Gamma-Ray Sensor 
NASA
National Aeronautics and Space Administration 
NASA-JPL
NASA Jet Propulsion Laboratory 
NAAP
Netherlands Agency for Aerospace Programs 
NIVR
Nederlands Instituut voor Vliegtuigontwikkeling en 
Ruimtevaart 
NSF
National Science Foundation 
NuASIC
NuSTAR ASIC 
NuSTAR
Nuclear Spectroscopic Telescope Array 
NS
Neutron Star 
ORDCIT
Ordinance-California Institute of Technology 
OSO
Orbiting Solar Observatory 
PICsIT
Pixelated Imaging CsI Telescope 
PoRTIA
Piggyback Room Temperature Instrument for Astronomy 
PC
proportaional counter 
PSPC
position sensitive proportional counter 
R⊕
Earth radii 
SAS
Small Astronomy Satellite 
SAS-A
Small Astronomy Satellite A 
SD
Spectroscopic Detector 
SGD
Soft Gamma-Ray Detector 
SIS
Solid State Imaging Spectrometer 
SL2-XRT
Spacelab 2 X-ray Telescope 
SMEX
Small Mission Explorer 
SRTM
Shuttle Radar Topography Mission

214
B. Allen
STS
Space Transportation System (i.e. The Space Shuttle) 
STIX
Spectrometer/Telescope for Imaging X-rays 
SN
supernova 
SNR
supernova remnant 
SVOM
Space-based Astronomical Variable Object Monitor 
SXI
Soft X-ray Imager 
SXS
Soft X-ray Spectrometer 
TDRS
Tracking and Delay Relay Satellite 
TDAMM
time domain multi-messenger astrophysics 
TGF
Terrestrial Gamma-Ray Flash 
TI
Texas Instruments 
TIGRS
Ambient-Temperature Imaging Gamma-Ray Spectrometer 
TLE
Transient Luminous Event 
TSM
Transient Source Monitor 
UCSD
University of California, San Diego 
UNH
University of New Hampshire 
UVOT
Ultraviolet/Optical Telescope 
VHE
Very High Energy 
MDU
Modular Detection Unit 
MOC
Mission Operation Center 
MSL
mean seal level 
NeXT
New exploration X-ray Telescope 
ULDB
ultra-long duration balloon ﬂight 
VIR
Visible and Infrared Spectrometer 
Voyager-ISS
Voyager imaging science subsystem 
VPCCD
virtual phase CCD 
XIS
X-ray Imaging Spectrometer 
XRISM
X-Ray Imaging and Spectroscopy Mission 
XRT
X-Ray Telescope 
XMM
X-Ray Multi-Mirror Mission 
XMM-Newton 
X-Ray Multi-Mirror Mission Newton 
WD
White Dwarf 
WFC
Wide-Field Camera 
WF/PC
Wide Field/Planetary Camera 
References 
1. https://www.jaxa.jp/press/2023/03/20230331-2_j.html. Retrieved April 14, 2023. 
2. https://heasarc.gsfc.nasa.gov/cgi-bin/W3Browse/w3catindex.pl#GAMMA-RAY 
%20BURSTS. Retrieved April, 17 2023. 
3. Abbott, R., Abbott, T. D., Abraham, S., et al. (2021). Open data from the ﬁrst and second 
observing runs of advanced ligo and advanced virgo. SoftwareX, 13. ISSN 2352-7110. https:// 
doi.org/10.1016/j.softx.2021.100658

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
215
4. Abarr, Q., Awaki, H., Baring, M., et al. (2021). Xl-calibur – a second-generation balloon-
borne hard x-ray polarimetry mission. Astroparticle Physics, 126, 102529. ISSN 0927-6505. 
https://doi.org/10.1016/j.astropartphys.2020.102529. https://www.sciencedirect.com/science/ 
article/pii/S0927650520301018. 
5. Abbott, B. P., Abbott, R., Abbott, T. D., et al. (2016). Observation of gravitational waves 
from a binary black hole merger. Physical Review Letters, 116, 061102. https://doi.org/10. 
1103/PhysRevLett.116.061102. https://link.aps.org/doi/10.1103/PhysRevLett.116.061102. 
6. Abbott, B. P., Abbott, R., Abbott, T. D., et al. (2017). Multi-messenger observations of a 
binary neutron star merger*. The Astrophysical Journal Letters, 848(2), L12. https://doi.org/ 
10.3847/2041-8213/aa91c9. https://dx.doi.org/10.3847/2041-8213/aa91c9 
7. Abeysekara, A., Albert, A., Alfaro, R., et al. (2023). The high-altitude water cherenkov 
(HAWC) observatory in méxico: The primary detector. Nuclear Instruments and Methods 
in Physics Research Section A: Accelerators, Spectrometers, Detectors and Associated 
Equipment, 1052, 168253. ISSN 0168-9002. https://doi.org/10.1016/j.nima.2023.168253. 
https://www.sciencedirect.com/science/article/pii/S0168900223002437 
8. Aharonian, F., Akhperjanian, A. G., Bazer-Bachi, A. R., et al. (2006). Observations of the 
Crab nebula with HESS. Astronomy and Astrophysics, 457(3), 899–915. https://doi.org/10. 
1051/0004-6361:20065351. https://doi.org//astro-ph/0607333 
9. Aharonian, F., An, Q., Axikegu; et al. (2021). Observation of the Crab Nebula with LHAASO-
KM2A - a performance study. Chinese Physics C, 45(2), 025002. https://doi.org/10.1088/ 
1674-1137/abd01b. https://doi.org//2010.06205 
10. Akutagawa, W., & Zanio, K. (1968). The possibilities of using CdTe as a gamma spectrometer. 
IEEE Transactions on Nuclear Science, 15(3), 266–274. https://doi.org/10.1109/TNS.1968. 
4324947 
11. Allen, B., Hong, J., Grindlay, J., et al. (2010). ProtoEXIST: Advanced prototype CZT coded 
aperture telescopes for EXIST. In M. Arnaud, S. S. Murray, & T. Takahashi (Eds.), Space 
telescopes and instrumentation 2010: Ultraviolet to gamma ray (vol. 7732, p. 77324D). 
Bellingham: International Society for Optics and Photonics (SPIE). https://doi.org/10.1117/ 
12.857940. https://doi.org/10.1117/12.857940 
12. Allen, B., Hong, J., Grindlay, J., et al. (2011). Development of the protoexist2 advanced czt 
detector plane. In 2011 IEEE Nuclear Science Symposium Conference Record (pp. 4470– 
4480). https://doi.org/10.1109/NSSMIC.2011.6154693 
13. Amenomori, M., Bao, Y. W., Bi, X. J., et al. (2019). First detection of photons with energy 
beyond 100 TeV from an astrophysical source. Physical Review Letters, 123(5), 051101. 
https://doi.org/10.1103/PhysRevLett.123.051101. https://doi.org//1906.05521 
14. Anderson, C. D. (1933). The positive electron. Physical Review, 43, 491–494. https://doi.org/ 
10.1103/PhysRev.43.491. https://link.aps.org/doi/10.1103/PhysRev.43.491 
15. Arques, M., Baffert, N., Lattard, D., et al. (1999). A basic component for ISGRI, the CdTe 
gamma camera on board the INTEGRAL satellite. IEEE Transactions on Nuclear Science, 
46(3), 181–186. https://doi.org/10.1109/23.775511 
16. Barthelmy, S. D. (2004). Burst alert telescope (BAT) on the swift MIDEX mission. In K. A. 
Flanagan & O. H. W. Siegmund (Eds.), X-ray and gamma-ray instrumentation for astronomy 
XIII. Society of Photo-Optical Instrumentation Engineers (SPIE) Conference Series (vol. 
5165, pp. 175–189. https://doi.org/10.1117/12.506779 
17. Belton, M. J. S., Klaasen, K. P., Clary, M. C., et al. (1992). The galileo solid-state imaging 
experiment. Space Science Reviews, 60(1), 413–455. ISSN 1572-9672. https://doi.org/10. 
1007/BF00216864. https://doi.org/10.1007/BF00216864 
18. Bhalerao, V., Bhattacharya, D., Vibhute, A., et al. (2017). The cadmium zinc telluride imager 
on AstroSat. Journal of Astrophysics and Astronomy, 38(2), 31. https://doi.org/10.1007/ 
s12036-017-9447-8. https//doi.org//1608.03408 
19. Bhalerao, V., Sawant, D., Pai, A., et al. (2022). Science with the daksha high energy transients 
mission. arXiv:2211.12052. https://doi.org/10.48550/arXiv.2211.12052. https//doi.org//2211. 
12052

216
B. Allen
20. Bhalerao, V., Vadawale, S., Tendulkar, S., et al. (2022). Daksha: On alert for high energy tran-
sients. arXiv:2211.12055. https://doi.org/10.48550/arXiv.2211.12055. https//doi.org//2211. 
12055 
21. Bloemendal, W., & Kramer, C. (1973). The netherlands astronomical satellite/ans. Philips 
Technical Review, 33(5), 117–129. 
22. Boella, G., Butler, R. C., Perola, G. C., et al. (1997). BeppoSAX, the wide band mission for 
X-ray astronomy. Astronomy and Astrophysics, Supplement, 122, 299–307. https://doi.org/10. 
1051/aas:1997136 
23. Bonnefoy, J. P., Lattard, D., Mathy, F., et al. (1996). A novel ASIC for readout electronics 
in semiconductor γ -ray detection. Nuclear Instruments and Methods in Physics Research A, 
380(1), 342–345. https://doi.org/10.1016/S0168-9002(96)00382-8 
24. Brown, R. A., & Ford, H. C. (1991). Report of the HST strategy panel: A strategy for recovery: 
The results of a special study, August-October 1990. 
25. Burke, B. E., Mountain, R. W., Daniels, P. J., et al. (1993). CCD soft x-ray imagers for ASCA 
and AXAF. In Siegmund, O. H. W. (Ed.), EUV, X-ray, and gamma-ray instrumentation for 
astronomy IV (vol. 2006, pp. 272–285). Bellingham: International Society for Optics and 
Photonics, SPIE. https://doi.org/10.1117/12.162840 
26. Burke, B. E., Mountain, R. W., Daniels, P. J., et al. (1994). CCD soft X-ray imaging 
spectrometer for the ASCA satellite. IEEE Transactions on Nuclear Science, 41(1), 375–385. 
https://doi.org/10.1109/23.281527 
27. Burrows, C. J., Holtzman, J. A., Faber, S. M., et al. (1991). The imaging performance of 
the hubble space telescope. Astrophysical Journal, Letters, 369, L21. https://doi.org/10.1086/ 
185950 
28. Burrows, D. N., Hill, J. E., Nousek, J. A., et al. (2005). The swift x-ray telescope. Space 
Science Reviews, 120(3), 165–195. ISSN 1572-9672. https://doi.org/10.1007/s11214-005-
5097-2 
29. Chattopadhyay, T., Vadawale, S. V., Rao, A. R., et al. (2014). Prospects of hard X-ray 
polarimetry with Astrosat-CZTI. Experimental Astronomy, 37(3), 555–577. https://doi.org/ 
10.1007/s10686-014-9386-1 
30. Chen, C. M. H., Cook, W. R., Harrison, F. A., et al. (2004). Characterization of a large-format, 
ﬁne-pitch CdZnTe pixel detector for the HEFT balloon-borne experiment. IEEE Transactions 
on Nuclear Science, 51(5), 2472–2477. https://doi.org/10.1109/TNS.2004.836143 
31. Cline, T. L., Desai, U. D., & Teegarden, B. J. (1981). The goddard program of gamma-ray 
transient astronomy. Astrophysics and Space Science, 75(1), 93–108. https://doi.org/10.1007/ 
BF00651386 
32. Collaboration, H., Aharonian, F., Akamatsu, H., et al. (2018). Measurements of resonant 
scattering in the Perseus Cluster core with Hitomi SXS*. Publications of the Astronomical 
Society of Japan, 70(10), 1–29. ISSN 0004-6264. https://doi.org/10.1093/pasj/psx127. https:// 
academic.oup.com/pasj/article-pdf/70/2/10/24612261/psx127.pdf 
33. Collaboration, T. C., Amiri, M., Andersen, B. C., et al. (2021). The ﬁrst chime/FRB fast radio 
burst catalog. The Astrophysical Journal Supplement Series, 257(2), 59. https://dx.doi.org/10. 
3847/1538-4365/ac33ab 
34. Collaboration, T. L. S., The Virgo Collaboration, The KAGRA Collaboration, et al. (2023). 
Open data from the third observing run of ligo, virgo, kagra and geo. https//doi.org//2302. 
03676. 
35. Cook, W. R., Burnham, J. A., & Harrison, F. A. (1998). Low-noise custom VLSI for CdZnTe 
pixel detectors. In O. H. W. Siegmund & M. A. Gummin (Eds.), EUV, X-ray, and gamma-ray 
instrumentation for astronomy IX (vol. 3445, pp. 347–354). Bellingham: International Society 
for Optics and Photonics, SPIE. https://doi.org/10.1117/12.330328 
36. Corliss, W. R. (1971). NASA sounding rockets, 1958–1968: A historical summary. NASA 
SP-4401 (vol. 4401) 
37. Costa, E., Frontera, F., Heise, J., et al. (1997). Discovery of an x-ray afterglow associated with 
the γ -ray burst of 28 february 1997. Nature, 387(6635), 783–785. ISSN 1476-4687. https:// 
doi.org/10.1038/42885

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
217
38. De Nobel, D., & Kröger, F. A. (1962). Method of manufacturing high-ohmic cadmium 
telluride for use in semiconductor devices or photosensitive devices. U.S. Patent 3 033 791. 
39. den Boggende, A. J. F., & Laﬂeur, H. T. J. A. (1975). An instrument for measuring cosmic X-
ray radiation. IEEE Transactions on Nuclear Science, 22, 555–559. https://doi.org/10.1109/ 
TNS.1975.4327702 
40. Dicke, R. H. (1968). Scatter-hole cameras for X-rays and gamma rays. Astrophysical Journal, 
Letters, 153, L101. https://doi.org/10.1086/180230 
41. Doty, F. P., Barber, H. B., Augustine, F. L., et al. (1994). Pixellated CdZnTe detector arrays. 
Nuclear Instruments and Methods in Physics Research A, 353(1–3), 356–360. https://doi.org/ 
10.1016/0168-9002(94)91675-6 
42. Doty, F. P., Friesenhahn, S. J., Butler, J. F., et al. (1993). X-ray and gamma-ray imaging 
with monolithic CdZnTe detector arrays. In P. Y. Bely, & J. B. Breckinridge (Eds.), 
Space astronomical telescopes and instruments II. Society of Photo-Optical Instrumentation 
Engineers (SPIE) Conference Series (vol. 1945, pp. 145–151). https://doi.org/10.1117/12. 
158756 
43. Entine, G., Waer, P., Tiernan, T., et al. (1989). Survey of CdTe nuclear detector applications. 
Nuclear Instruments and Methods in Physics Research A, 283(2), 282–290. https://doi.org/ 
10.1016/0168-9002(89)91373-9 
44. Fishman, G. J., & Meegan, C. A. (1995). Gamma-ray bursts. Annual Review of Astronomy 
and Astrophysics, 33, 415–458. https://doi.org/10.1146/annurev.aa.33.090195.002215 
45. Fishman, G. J., Meegan, C. A., Wilson, R. B., et al. (1992). The BATSE experiment on 
the compton gamma ray observatory: Status and some early results. In NASA Conference 
Publication. NASA Conference Publication (vol. 3137, pp. 26–34). 
46. Fishman, G. J., Bhat, P. N., Mallozzi, R., et al. (1994). Discovery of intense gamma-ray ﬂashes 
of atmospheric origin. Science, 264(5163), 1313–1316. https://doi.org/10.1126/science.264. 
5163.1313. https://www.science.org/doi/abs/10.1126/science.264.5163.1313 
47. Fraser, G. W. (1989). Semiconductor detectors. Cambridge Astrophysics (pp. 179–229). 
Cambridge: Cambridge University Press. https://doi.org/10.1017/CBO9780511735554.006 
48. Friedman, H. (1978). Heao-A. In K. A. van der Hucht & G. Vaiana (Eds.), New instrumenta-
tion for space astronomy (vol. 20, p. 101). 
49. Friedman, H., Lichtman, S. W., & Byram, E. T. (1951). Photon counter measurements of solar 
X-rays and extreme ultraviolet light. Physical Review, 83(5), 1025–1030. https://doi.org/10. 
1103/PhysRev.83.1025 
50. Furukawa, K., Buitrago-Casas, J. C., Vievering, J., et al. (2019). Development of 60 m 
pitch CDTE double-sided strip detectors for the foxsi-3 sounding rocket experiment. 
Nuclear Instruments and Methods in Physics Research Section A: Accelerators, Spec-
trometers, Detectors and Associated Equipment, 924, 321–326. ISSN 0168-9002. https:// 
doi.org/https://doi.org/10.1016/j.nima.2018.07.011. https://www.sciencedirect.com/science/ 
article/pii/S0168900218308349. 11th International Hiroshima Symposium on Development 
and Application of Semiconductor Tracking Detectors. 
51. Gehrels, N., Chincarini, G., Giommi, P., et al. (2004). The swift gamma-ray burst mission. 
Astrophysical Journal, 611(2), 1005–1020. https://doi.org/10.1086/422091. https//doi.org// 
astro-ph/0405233 
52. Gevin, O., Baron, P., Coppolani, X., et al. (2009). IDeF-X ECLAIRs: A CMOS ASIC 
for the readout of CDTE and CDZNTE detectors for high resolution spectroscopy. IEEE 
Transactions on Nuclear Science, 56(4), 2351–2359. ISSN 1558-1578. https://doi.org/10. 
1109/TNS.2009.2023989 
53. Giacconi, R. (2003). The dawn of X-ray astronomy. International Journal of Modern Physics 
A, 18(18), 3127–3149. https://doi.org/10.1142/S0217751X03016112 
54. Giacconi, R., & Rossi, B. (1960). A ‘Telescope’ for soft X-ray astronomy. Journal of 
Geophysics Research, 65, 773. https://doi.org/10.1029/JZ065i002p00773 
55. Giacconi, R., Branduardi, G., Briel, U., et al. (1979). The Einstein (HEAO 2) X-ray 
observatory. Astrophysical Journal, 230, 540–550. https://doi.org/10.1086/157110

218
B. Allen
56. Giacconi, R., Gursky, H., Paolini, F. R., et al. (1962). Evidence for x rays from sources 
outside the solar system. Physical Review Letters, 9(11), 439–443. https://doi.org/10.1103/ 
PhysRevLett.9.439 
57. Giacconi, R., Reidy, W. P., Zehnpfennig, T., et al. (1965). Solar X-ray image obtained using 
grazing-incidence optics. Astrophysical Journal, 142, 1274–1278. https://doi.org/10.1086/ 
148404 
58. Godet, O., Nasser, G., Atteia, J., et al. (2014). The x-/gamma-ray camera ECLAIRs for the 
gamma-ray burst mission SVOM. In: T. Takahashi, J.-W. A. den Herder, & M. Bautz (Eds.), 
Space telescopes and instrumentation 2014: Ultraviolet to gamma ray (vol. 9144, p. 914424). 
Bellingham: International Society for Optics and Photonics, SPIE. https://doi.org/10.1117/12. 
2055507 
59. Grefenstette, B. W., Fryer, C. L., Harrison, F. A., et al. (2016). The distribution of radioactive 
44TI in Cassiopeia A. The Astrophysical Journal, 834(1), 19. https://dx.doi.org/10.3847/ 
1538-4357/834/1/19 
60. Grefenstette, B. W., Glesener, L., Krucker, S., et al. (2016). The ﬁrst focused hard x-ray 
images of the sun with nustar. The Astrophysical Journal, 826(1), 20. https://dx.doi.org/10. 
3847/0004-637X/826/1/20. 
61. Group, N. G. S. S. (2019). long-duration ballooning ldb support for science. Retrieved 
March 28, 2023 from https://www.csbf.nasa.gov/documents/ldb/LDB%20Support%20for 
%20Science%20EL-100-10-H%20Rev%20B.pdf 
62. Gunson, J., & Polychronopulos, B. (1976). Optimum design of a coded mask X-ray telescope 
for rocket applications. Monthly Notices of the RAS, 177, 485–497. https://doi.org/10.1093/ 
mnras/177.3.485 
63. Harrison, F. A., Christensen, F. E., Craig, W., et al. (2005). Development of the heft and nustar 
focusing telescopes. Experimental Astronomy, 20(1), 131–137. ISSN 1572-9508. https://doi. 
org/10.1007/s10686-006-9072-z. 
64. Harrison, F. A., Craig, W. W., Christensen, F. E., et al. (2013). The nuclear spectroscopic 
telescope array (NuSTAR) high-energy X-ray mission. Astrophysical Journal, 770(2), 103. 
https://doi.org/10.1088/0004-637X/770/2/103. https//doi.org//1301.7307 
65. Harrison, F. A., Aird, J., Civano, F., et al. (2016). The nustar extragalactic surveys: The 
number counts of active galactic nuclei and the resolved fraction of the cosmic x-ray 
background. The Astrophysical Journal, 831(2), 185. https://dx.doi.org/10.3847/0004-637X/ 
831/2/185 
66. Hayashida, K., Kitamoto, S., Miyata, E., et al. (2000). X-ray imaging spectrometers for Astro-
E: Ground calibration in the soft x-ray range. In J. E. Truemper & B. Aschenbach (Eds.), X-
ray optics, instruments, and missions III (vol. 4012, pp. 123–136). Bellingham: International 
Society for Optics and Photonics, SPIE. https://doi.org/10.1117/12.391548 
67. Healea, J. J. (2016). Characterization and implementation of a COTS X/gamma ray imaging 
device to be ﬂown on CXBN -2 with the goal of making a precise measurement of the diffuse 
cosmic X-ray background in the 20–50 keV energy regime. Master’s thesis, Morehead State 
University, Minnesota. 
68. Hess, V. F. (1912). Über Beobachtungen der durchdringenden Strahlung bei sieben Freibal-
lonfahrten. Physikalische Zeitschrift, 13, 1084–1091. 
69. Hitomi Collaboration, Aharonian, F., Akamatsu, H., et al. (2018). Detection of polarized 
gamma-ray emission from the Crab nebula with the hitomi soft gamma-ray detector. 
Publications of the Astronomical Society of Japan, 70(6), 113. https://doi.org/10.1093/pasj/ 
psy118. https//doi.org//1810.00704 
70. Hong, J., Allen, B., Grindlay, J., et al. (2013). Tiled array of pixelated czt imaging detectors 
for protoexist2 and mirax-hxi. IEEE Transactions on Nuclear Science, 60(6), 4610–4617. 
https://doi.org/10.1109/TNS.2013.2283806 
71. Hovestadt, D., Gloeckler, G., Fan, C. Y., et al. (1978). The nuclear and ionic charge 
distribution particle experiments on the ISEE-1 and ISEE-C spacecraft. IEEE Transactions on 
Geoscience Electronics, 16(3), 166–175 (1978). https://doi.org/10.1109/TGE.1978.294540

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
219
72. Hui, C. M., & MoonBEAM Team. (2022). Moon burst energetics all-sky monitor: A 
beyond earth-orbit gamma-ray burst detector for multi-messenger astronomy. In American 
Astronomical Society Meeting #240. American Astronomical Society Meeting Abstracts (vol. 
54, p. 127.07). 
73. Imhof, W. L., Nakano, G. H., Johnson, R. G., et al. (1974). Spectra measurements of a cosmic 
gamma-ray burst with fast time resolution. Astrophysical Journal, Letters, 191, L7.  https:// 
doi.org/10.1086/181529 
74. Imhof, W., Kilner, J., Nakano, G., et al. (1980). Satellite x ray mappings of sporadic 
auroral zone electron precipitation events in the local dusk sector. Journal of Geophysical 
Research: Space Physics, 85(A7), 3347–3359. https://doi.org/10.1029/JA085iA07p03347. 
https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/JA085iA07p03347 
75. Ishisaki, Y., Kelley, R. L., Awaki, H., et al. (2022). Status of resolve instrument onboard 
X-ray imaging and spectroscopy mission (XRISM). In J.-W. A. den Herder, S. Nikzad, & 
K. Nakazawa (Eds.), Space telescopes and instrumentation 2022: Ultraviolet to gamma ray, 
(vol. 12181, p. 121811S). Bellingham: International Society for Optics and Photonics, SPIE. 
https://doi.org/10.1117/12.2630654 
76. Ivezi´c, Ž., Kahn, S. M., Tyson, J. A., et al. (2019). LSST: From science drivers to reference 
design and anticipated data products. Astrophysical Journal, 873, 111. https://doi.org/10. 
3847/1538-4357/ab042c. https//doi.org//0805.2366 
77. Jagoda, N., Austin, G., Mickiewicz, S., et al. (1972). The uhuru x-ray instrument. IEEE Trans-
actions on Nuclear Science, 19(1), 579–591. https://doi.org/10.1109/TNS.1972.4326562 
78. Janesick, J. R., Hynecek, J., & Blouke, M. M. (1981). Virtual phase imager for galileo. In J. C. 
Geary & D. W. Latham (Eds.), Solid-state imagers for astronomy (vol. 0290, pp. 165–173). 
Bellingham: International Society for Optics and Photonics, SPIE. https://doi.org/10.1117/12. 
965856. 
79. Jansen, F., Lumb, D., Altieri, B., et al. (2001). Xmm-newton observatory* - i. the spacecraft 
and operations. Astronomy & Astrophysics, 365(1), L1–L6. https://doi.org/10.1051/0004-
6361:20000036 
80. Jones, L., Seller, P., Wilson, M., et al. (2009). Hexitec asic—a pixellated readout 
chip for czt detectors. Nuclear Instruments and Methods in Physics Research Sec-
tion A: Accelerators, Spectrometers, Detectors and Associated Equipment, 604(1), 34– 
37. ISSN 0168-9002. https://doi.org/10.1016/j.nima.2009.01.046. https://www.sciencedirect. 
com/science/article/pii/S0168900209001090. PSD8. 
81. Jordan, R. L., Caro, E. R., Kim, Y., et al. (1996). Shuttle radar topography mapper (SRTM). In: 
G. Franceschetti, C. J. Oliver, F. S. Rubertone, et al., (Eds.), Microwave sensing and synthetic 
aperture radar (vol. 2958, pp. 412–422). Bellingham: International Society for Optics and 
Photonics, SPIE. https://doi.org/10.1117/12.262717. 
82. Kaaret, P., Zajczyk, A., LaRocca, D. M., et al. (2019). HaloSat: A CubeSat to study the hot 
galactic halo. Astrophysical Journal, 884(2), 162. https://doi.org/10.3847/1538-4357/ab4193. 
https//doi.org//1909.13822 
83. Kalemci, E., Altıngün, A. M., Bozkurt, A., et al. (2023). The improved x-ray detector (iXRD) 
on Sharjah-Sat-1, design principles, tests and ground calibration. Experimental Astronomy 
https://doi.org/10.1007/s10686-023-09890-z 
84. Keller, H. U., Arpigny, C., Barbieri, C., et al. (1986). First halley multicolour camera imaging 
results from giotto. Nature, 321(6067s), 320–326. ISSN 0028-0836. 
85. Keller, H. U., Schmidt, W. K. H., Wilhelm, K., et al. (1987). The halley multicolour camera. 
Journal of Physics E: Scientiﬁc Instruments, 20(6), 807. https://dx.doi.org/10.1088/0022-
3735/20/6/039 
86. Klebesadel, R. W., Strong, I. B., & Olson, R. A. (1973). Observations of gamma-ray bursts of 
cosmic origin. Astrophysical Journal, Letters, 182, L85. https://doi.org/10.1086/181225 
87. Kosugi, T., Makishima, K., Murakami, T., et al. (1991). The hard X-ray telescope (HXT) for 
the SOLAR-A mission. Solar Physics, 136(1), 17–36. https://doi.org/10.1007/BF00151693 
88. Krucker, S., Hurford, G. J., Grimm, O., et al. (2020). The spectrometer/telescope for imaging 
x-rays (stix). Astronomy & Astrophysics, 642, A15 (2020). https://doi.org/10.1051/0004-
6361/201937362.

220
B. Allen
89. Lacombe, K., Nasser, G., Amoros, C., et al. (2013). Development of a 32-detector CdTe 
matrix for the SVOM ECLAIRs X/Gamma camera: Preliminary results. Nuclear Instruments 
and Methods in Physics Research A, 732, 122–125. https://doi.org/10.1016/j.nima.2013.07. 
003 
90. Lebrun, F., Leray, J. P., Lavocat, P., et al. (2003). ISGRI: The INTEGRAL soft gamma-ray 
imager. Astronomy and Astrophysics, 411, L141–L148. https://doi.org/10.1051/0004-6361: 
20031367. https//doi.org//astro-ph/0310362 
91. Lien, A., Sakamoto, T., Barthelmy, S. D., et al. (2016). The third swift burst alert telescope 
gamma-ray burst catalog. The Astrophysical Journal, 829(1), 7. https://dx.doi.org/10.3847/ 
0004-637X/829/1/7 
92. Lorimer, D. R., Bailes, M., McLaughlin, M. A., et al. (2007). A bright millisecond radio 
burst of extragalactic origin. Science, 318(5851), 777–780. https://doi.org/10.1126/science. 
1147532. https://www.science.org/doi/abs/10.1126/science.1147532 
93. Lugiez, F., Gevin, O., Baron, P., et al. (2006). IDeF-X V1.1: Performances of a new CMOS 
16 channels analogue readout ASIC for Cd(Zn) te detectors. In 2006 IEEE Nuclear Science 
Symposium Conference Record (vol. 2, pp. 841–844). https://doi.org/10.1109/NSSMIC.2006. 
355981 
94. Macau-Hercot, D., Kramm, J. R., Schmidt, W. K. R., et al. (). Optimization, test and cali-
bration of the halley multicolour camera CCD detectors. In ESO Conference and Workshop 
Proceedings (vol. 25). European Southern Observatory, Garching bei Munchen (1987). ISBN 
3923524250. 
95. Meuris, A., Hurford, G., Bednarzik, M., et al. (2012). Caliste-SO x-ray micro-camera for the 
STIX instrument on-board solar orbiter space mission. Nuclear Instruments and Methods 
in Physics Research Section A: Accelerators, Spectrometers, Detectors and Associated 
Equipment, 695, 288–292. ISSN 0168-9002. https://doi.org/10.1016/j.nima.2011.11.016. 
https://www.sciencedirect.com/science/article/pii/S016890021102050X. New Developments 
in Photodetection NDIP11. 
96. Moiseev, A., Bolotnikov, A., DeGeronimo, G., et al. (2017). High-energy 3d calorimeter 
for use in gamma-ray astronomy based on position-sensitive virtual frisch-grid CDZNTE 
detectors. Journal of Instrumentation, 12(12), C12037. https://dx.doi.org/10.1088/1748-
0221/12/12/C12037 
97. Müller, D., Zouganelis, I., St. Cyr, O. C., et al. (2020). Europe’s next mission to the sun. 
Nature Astronomy, 4(2), 205–205. ISSN 2397-3366. https://doi.org/10.1038/s41550-020-
1015-5 
98. Nakano, G. H., Imhof, W. L., & Kilner, J. R. (1976). Effects of 33-MeV proton bombardent 
on the performance of CdTe gamma-ray detectors. IEEE Transactions on Nuclear Science, 
23(1), 467–472. https://doi.org/10.1109/TNS.1976.4328289 
99. Nakazawa, K., Sato, G., Kokubun, M., et al. (2018). Hard x-ray imager onboard Hitomi 
(ASTRO-H). Journal of Astronomical Telescopes, Instruments, and Systems, 4(2), 021410. 
https://doi.org/10.1117/1.JATIS.4.2.021410 
100. Nakazawa, K., Okuma, K., Tsuji, Y., et al. (2022). Balloon-borne narrow ﬁeld of view 
semiconductor Compton telescope concept: miniSGD. In J.-W. A. den Herder, S. Nikzad, 
& K. Nakazawa (Eds.), Society of photo-optical instrumentation engineers (SPIE) conference 
series. Society of Photo-Optical Instrumentation Engineers (SPIE) Conference Series (vol. 
12181, pp. 1218172). https://doi.org/10.1117/12.2628199 
101. Nandi, A., Palit, S., Debnath, D., et al. (2011). Instruments of RT-2 experiment onboard 
CORONAS-PHOTON and their test and evaluation III: coded aperture mask and fresnel 
zone plates in RT-2/CZT payload. Experimental Astronomy, 29(1–2), 55–84. https://doi.org/ 
10.1007/s10686-010-9184-3. https//doi.org//1011.3338 
102. Nasa space science data coordinate archive (NSSDCA). Retrieved March 30, 2023 from 
https://nssdc.gsfc.nasa.gov/nmc/SpacecraftQuery.jsp 
103. National Academies of Sciences, Engineering and Medicine, E. and Medicine. (2021). 
Pathways to discovery in astronomy and astrophysics for the 2020s. Washington: The 
National Academies Press. ISBN 978-0-309-46734-6. https://doi.org/10.17226/26141.

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
221
https://nap.nationalacademies.org/catalog/26141/pathways-to-discovery-in-astronomy-and-
astrophysics-for-the-2020s 
104. Nowicki, S. F., He, Z., Zhu, Y., et al. (2021). Ambient-temperature imaging gamma-ray 
spectrometer (TIGRS) for high-sensitivity planetary elemental mapping. In 52nd Lunar and 
Planetary Science Conference. Lunar and Planetary Science Conference (p. 1702). 
105. Oda, M. (1980). Cosmic X-ray satellite ’Hakucho’. Acta Astronautica, 7, 957–965. https:// 
doi.org/10.1016/0094-5765(80)90094-6 
106. Ogasaka, Y., Tamura, K., Okajima, T., et al. (2003). Development of supermirror hard x-
ray telescope and the results of the ﬁrst InFOCuS ﬂight observation. In J. E. Truemper & 
H. D. Tananbaum (Eds.), X-ray and gamma-ray telescopes and instruments for astronomy 
(vol. 4851, pp. 619–630). Bellingham: International Society for Optics and Photonics, SPIE. 
https://doi.org/10.1117/12.461531. 
107. Ogawara, Y., Mitsuda, K., Masai, K., et al. (1982). X-ray observations of the 1980 cygnus 
x-1 ‘high state’. Nature, 295(5851), 675–676. ISSN 1476-4687. https://doi.org/10.1038/ 
295675a0 
108. Ogilvie, K. W., Durney, A., & von Rosenvinge, T. (1978). Introduction descriptions of 
experimental investigations and instruments for the ISEE spacecraft. IEEE Transactions on 
Geoscience Electronics, 16(3), 151–153. https://doi.org/10.1109/TGE.1978.294535 
109. Østgaard, N., Balling, J. E., Bjørnsen, T., et al. (2019). The modular X- and gamma-ray sensor 
(MXGS) of the ASIM payload on the international space station. Space Science Reviews, 
215(2), 23. https://doi.org/10.1007/s11214-018-0573-7. https//doi.org//1906.10452 
110. Paciesas, W. S., Pendleton, G. N., Lestrade, J. P., et al. (1989). Performance of the large-
area detectors for the burst and transient source experiment (BATSE) on the gamma ray 
observatory. In C. J. Hailey & O. H. W. Siegmund (Eds.), EUV, X-ray, and gamma-ray 
instrumentation for astronomy and atomic physics (vol. 1159, pp. 156–164). Bellingham: 
International Society for Optics and Photonics, SPIE. https://doi.org/10.1117/12.962574 
111. Parsons, A., Lisse, C., Stahle, C., et al. (1994). Room temperature cdznte and hgi/sub 
2/ detectors for hard x-ray astrophysics. In: Proceedings of 1994 IEEE Nuclear Science 
Symposium - NSS’94 (vol. 2, pp. 781–785). https://doi.org/10.1109/NSSMIC.1994.474495 
112. Parsons, A. M., Stahle, C. M., Lisse, C. M., et al. (1994). Room temperature semiconductor 
detectors for hard x-ray astrophysics. In E. Aprile (Ed.), Gamma-ray detector physics and 
applications. Society of Photo-Optical Instrumentation Engineers (SPIE) Conference Series 
(vol. 2305, pp. 121–132). https://doi.org/10.1117/12.187260 
113. Paul, J., Mandrou, P., Ballet, J., et al. (1991). Sigma: The hard x-ray and soft gamma-ray tele-
scope on board the granat space observatory. Advances in Space Research, 11(8), 289–302. 
ISSN 0273-1177. https://doi.org/10.1016/0273-1177(91)90181-I. https://www.sciencedirect. 
com/science/article/pii/027311779190181I 
114. Piran, T. (1999). Gamma-ray bursts and the ﬁreball model. Physics Reports, 314(6), 
575–667. ISSN 0370-1573. https://doi.org/10.1016/S0370-1573(98)00127-6. https://www. 
sciencedirect.com/science/article/pii/S0370157398001276 
115. Prettyman, T. H., Feldman, W. C., McSween, H. Y., et al. (2011). Dawn’s gamma ray and 
neutron detector. Space Science Reviews, 163(1–4), 371–459. https://doi.org/10.1007/s11214-
011-9862-0 
116. Prettyman, T. H., Feldman, W. C., Ameduri, F. P., et al. (2003). Gamma-ray and neutron 
spectrometer for the Dawn mission to 1 Ceres and 4 Vesta. IEEE Transactions on Nuclear 
Science, 50(4), 1190–1197. https://doi.org/10.1109/TNS.2003.815156 
117. Proctor, R. J., Skinner, G. K., & Willmore, A. P. (1978). X-ray emission from the region of the 
Galactic Centre. Monthly Notices of the RAS, 185, 745–754. https://doi.org/10.1093/mnras/ 
185.4.745 
118. Ramsey, B. D., Engelhaupt, D. E., Speegle, C. O., et al. (1999). HERO program: High-
energy replicated optics for a hard-x-ray balloon payload. In O. H. Siegmund & K. A. 
Flanagan (Eds.), EUV, X-ray, and gamma-ray instrumentation for astronomy X. Society of 
Photo-Optical Instrumentation Engineers (SPIE) Conference Series (vol. 3765, pp. 816–821). 
https://doi.org/10.1117/12.366569

222
B. Allen
119. Ramsey, B. D., Alexander, C. D., Apple, J. A., et al. (2002). First images from hero, a hard 
x-ray focusing telescope. The Astrophysical Journal, 568(1), 432. https://dx.doi.org/10.1086/ 
338801 
120. Rao, A. R., Bhattacharya, D., Bhalerao, V. B., et al. (2017). Cadmium-Zinc-Telluride Imager 
on-board AstroSat: A multi-faceted hard X-ray instrument. Current Science, 113(4), 595. 
https://doi.org/10.18520/cs/v113/i04/595-598. https//doi.org//1710.10773 
121. Ricker, G., Vallerga, J., & Wood, D. (1983). A mercuric iodide detector system for 
x-ray astronomy: I. Design considerations and predictions of background and sensi-
tivity. Nuclear Instruments and Methods in Physics Research, 213(1), 133–144. ISSN 
0167-5087. https://doi.org/10.1016/0167-5087(83)90053-4. https://www.sciencedirect.com/ 
science/article/pii/0167508783900534 
122. Ricker, G. R., Atteia, J. L., Crew, G. B., et al. (2003). The high energy transient explorer 
(HETE): Mission and science overview. In G. R. Ricker & R. K. Vanderspek (Eds.), Gamma-
ray burst and afterglow astronomy 2001: A workshop celebrating the ﬁrst year of the HETE 
mission. American Institute of Physics Conference Series (vol. 662, pp. 3–16). https://doi.org/ 
10.1063/1.1579291 
123. Rosanova, G., and Others. (2022). NASA sounding rockets annual report 2022. Retrieved 
March 28, 2023 from https://sites.wff.nasa.gov/code810/ﬁles/Annual20Report202022_web. 
pdf 
124. Ryan, D. F., Christe, S. D., Shih, A. Y., et al. (2017). Modeling and measuring charge sharing 
in hard x-ray imagers using HEXITEC CdTe detectors. In O. H. Siegmund (Ed.), UV, x-
ray, and gamma-ray space instrumentation for astronomy XX (vol. 10397, p. 1039702). 
Bellingham: International Society for Optics and Photonics, SPIE. https://doi.org/10.1117/ 
12.2274419 
125. Ryan, J. M., Macri, J. R., McConnell, M. L., et al. (1995). Large-area submillimeter resolution 
CdZnTe strip detector for astronomy. In O. H. Siegmund & J. V. Vallerga (Eds.), EUV, X-ray, 
and gamma-ray instrumentation for astronomy VI. Society of Photo-Optical Instrumentation 
Engineers (SPIE) Conference Series (vol. 2518, pp. 292–301). https://doi.org/10.1117/12. 
218403 
126. Scapin, V., & MAGIC Collaboration. (2008). Recent results from the MAGIC telescope. 
Nuclear Instruments and Methods in Physics Research A, 595(1), 77–79. https://doi.org/10. 
1016/j.nima.2008.07.104 
127. Simms, L. M., Jernigan, J. G., Malphrus, B. K., et al. (2012). CXBN: A blueprint for an 
improved measurement of the cosmological x-ray background. In R. B. James, A. Burger, 
L. A. Franks, et al. (Eds.), Hard x-ray, gamma-ray, and neutron detector physics XIV. Society 
of Photo-Optical Instrumentation Engineers (SPIE) Conference Series (vol. 8507, p. 850719). 
https://doi.org/10.1117/12.953573 
128. Singh, K. P., Tandon, S. N., Agrawal, P. C., et al. (2014). ASTROSAT mission. In T. 
Takahashi, J.-W. A. den Herder, & M. Bautz (Eds.), Space telescopes and instrumentation 
2014: Ultraviolet to gamma ray. Society of Photo-Optical Instrumentation Engineers (SPIE) 
Conference Series (vol. 9144, p. 91441S). https://doi.org/10.1117/12.2062667 
129. Skinner, G. K., Willmore, A. P., Eyles, C. J., et al. (1987). Hard x-ray images of the galactic 
centre. Nature, 330(6148), 544–547. ISSN 1476-4687. https://doi.org/10.1038/330544a0 
130. Skinner, G. K., Bergeson-Willis, S., Courvoisier, T., et al. (1993). INTEGRAL: The next 
major gamma-ray astronomy mission? In P. Y. Bely, & J. B. Breckinridge (Eds.), Space astro-
nomical telescopes and instruments II. Society of Photo-Optical Instrumentation Engineers 
(SPIE) Conference Series (vol. 1945, pp. 112–123). https://doi.org/10.1117/12.158753 
131. Skinner, G. K., Herring, J. R. H., & Balthazor, R. L. (1993). Coded mask telescope with 
a germanium array detector. In P. Y. Bely & J. B. Breckinridg, (Eds.), Space astronomical 
telescopes and instruments II (vol. 1945, pp. 465–477). Bellingham: International Society for 
Optics and Photonics, SPIE. https://doi.org/10.1117/12.158792 
132. Skinner, G. K., Balthazor, R. L., Herring, J. R. H., et al. (1995). A balloon 
ﬂight test of a coded-mask telescope with a multi-element germanium detector. 
Nuclear 
Instruments 
and 
Methods 
in 
Physics 
Research 
A, 
357, 
580–587. 
https://doi.org/10.1016/0168-9002(94)01521-X

Space Applications of CdZnTe and CdTe Detector Systems: Past, Present and Future
223
133. Smith, J. F., & Courtier, G. M. (1976). The ariel 5 programme. Proceedings of the Royal 
Society of London Series A, 350(1663), 421–439. https://doi.org/10.1098/rspa.1976.0115 
134. Snyder, L. (1980). Television optics for the Voyager mission to Jupiter and Saturn. Optical 
Engineering, 19, 566–576. https://doi.org/10.1117/12.7972560 
135. Tajima, H., Nakamoto, T., Tanaka, T., et al. (2003). Performance of a low noise front-end 
asic for SI/CDTE detectors in compton gamma-ray telescope. In 2003 IEEE Nuclear Science 
Symposium. Conference Record (IEEE Cat. No.03CH37515) (vol. 1, pp. 396–401). https:// 
doi.org/10.1109/NSSMIC.2003.1352071 
136. Tajima, H., Watanabe, S., Fukazawa, Y., et al. (2018). Design and performance of soft gamma-
ray detector onboard the hitomi (ASTRO-H) satellite. Journal of Astronomical Telescopes, 
Instruments, and Systems, 4, 021411. https://doi.org/10.1117/1.JATIS.4.2.021411 
137. Takahashi, T., Mitsuda, K., Kelley, R., et al. (2014). The ASTRO-H X-ray astronomy 
satellite. In T. Takahashi, J.-W. A. den Herder, & M. Bautz (Eds.), Space telescopes 
and instrumentation 2014: Ultraviolet to gamma ray, (vol. 9144, p. 914425). Bellingham: 
International Society for Optics and Photonics, SPIE. 
138. Tanaka, Y., Fujii, M., Inoue, H., et al. (1984). X-ray astronomy satellite Tenma. Publications 
of the Astronomical Society of Japan, 36(4), 641–658. 
139. Tanaka, Y., Inoue, H., & Holt, S. S. (1994). The X-ray astronomy satellite ASCA. Publica-
tions of the Astronomical Society of Japan, 46, L37–L41. 
140. Tao, L., Tomsick, J. A., Walton, D. J., et al. (2015). Nustar and swift observations of the black 
hole candidate XTE j1908+094 during its 2013 outburst. The Astrophysical Journal, 811(1), 
51. https://dx.doi.org/10.1088/0004-637X/811/1/51 
141. Tashiro, M., Maejima, H., Toda, K., et al. (2020). Status of x-ray imaging and spectroscopy 
mission (XRISM). In J.-W. A. den Herder, S. Nikzad, & K. Nakazawa (Eds.), Space 
telescopes and instrumentation 2020: Ultraviolet to gamma ray (vol. 11444, p. 1144422). 
Bellingham: International Society for Optics and Photonics, SPIE. https://doi.org/10.1117/ 
12.2565812 
142. Tomsick, J., & COSI Collaboration. (2022). The compton spectrometer and imager project 
for MeV Astronomy. In 37th International Cosmic Ray Conference (p. 652). https://doi.org/ 
10.22323/1.395.0652. https//doi.org//2109.10403 
143. Trümper, J. (1982). The rosat mission. Advances in Space Research, 2(4), 241–249. ISSN 
0273-1177. https://doi.org/10.1016/0273-1177(82)90070-9. https://www.sciencedirect.com/ 
science/article/pii/0273117782900709 
144. Tsuneta, S., Acton, L., Bruner, M., et al. (1991). The soft X-ray telescope for the SOLAR-A 
mission. Solar Physics, 136(1), 37–67. https://doi.org/10.1007/BF00151694 
145. Tueller, J., Barthelmy, S., Gehrels, N., et al. (1988). The gamma-ray imaging spectrometer 
(GRIS) instrument and plans for serving sn 1987a. AIP Conference Proceedings, 170(1), 439– 
443. https://doi.org/10.1063/1.37243. https://aip.scitation.org/doi/abs/10.1063/1.37243 
146. Vadawale, S. V., Sreekumar, P., Acharya, Y. B., et al. (2014). Hard X-ray continuum from 
lunar surface: Results from high energy X-ray spectrometer (HEX) onboard Chandrayaan-1. 
Advances in Space Research, 54(10), 2041–2049. https://doi.org/10.1016/j.asr.2013.06.013 
147. Vallerga, J., Vanderspek, R., & Ricker, G. (1983). A mercuric iodide detector sys-
tem for x-ray astronomy: II. Results from ﬂight tests of a balloon borne instru-
ment. Nuclear Instruments and Methods in Physics Research, 213(1):145–154. ISSN 
0167-5087. https://doi.org/10.1016/0167-5087(83)90054-6. https://www.sciencedirect.com/ 
science/article/pii/0167508783900546 
148. Van Allen, J. A. (1959). The geomagnetically trapped corpuscular radiation. Journal of Geo-
physical Research, 64(11), 1683–1689. https://doi.org/10.1029/JZ064i011p01683. https:// 
agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/JZ064i011p01683 
149. Voges, W., Aschenbach, B., Boller, T., et al. (1999). The ROSAT all-sky survey bright source 
catalogue. Astronomy and Astrophysics, 349, 389–405. https//doi.org//astro-ph/9909315 
150. Voges, W., Aschenbach, B., Boller, T., et al. (2000). Rosat all-sky survey faint source 
catalogue. IAU Cirulars, 7432, 3.

224
B. Allen
151. Weisskopf, M. C., Tananbaum, H. D., Speybroeck, L. P. V., et al. (2000). Chandra X-ray 
observatory (CXO): Overview. In J. E. Truemper & B. Aschenbach (Eds.), X-ray optics, 
instruments, and missions III (vol. 4012, pp. 2–16). Bellingham: International Society for 
Optics and Photonics, SPIE. https://doi.org/10.1117/12.391545 
152. Westphal, J. A. (1982). The wide ﬁeld/planetary camera. In NASA Conference Publication 
(vol. 2244, pp. 28–39). 
153. Willmore, A., Skinner, G., Eyles, C., et al. (1984). A coded mask telescope for the 
spacelab 2 mission. Nuclear Instruments and Methods in Physics Research, 221(1), 284–287. 
ISSN 0167-5087.https://doi.org/10.1016/0167-5087(84)90211-4. https://www.sciencedirect. 
com/science/article/pii/0167508784902114. Proceedings of the International Workshop on X-
and -Ray Imaging Techniques. 
154. Yamashita, K., Kunieda, H., Tawara, Y., et al. (1999). New design concept of multilayer 
supermirrors for hard x-ray optics. In R. B. Hoover & A. B. Walker (eds.), X-ray optics, 
instruments, and missions II. Society of Photo-Optical Instrumentation Engineers (SPIE) 
Conference Series (vol. 3766, pp. 327–335). https://doi.org/10.1117/12.363646 
155. Zanio, K., & Akutagawa, W. (1972). Analysis of CdTe as a γ -ray spectrometer. Applied 
Physics Letters, 20(8), 294–296. https://doi.org/10.1063/1.1654155

Germanium Detectors for MeV 
Gamma-Ray Astrophysics with the 
Compton Spectrometer and Imager 
Jacqueline Beechert, Hadar Lazar, and Albert Y. Shih 
1 
The MeV Gap in Astrophysics 
Accessing the rich scientiﬁc potential of the MeV bandpass is of high priority in the 
astrophysics community. Home to a wealth of astrophysical mysteries, including 
determining the nature of Galactic positrons, measuring emission from Galactic 
nucleosynthesis, and performing novel polarization measurements of gamma ray 
bursts (GRBs) and compact objects, decades of astrophysics experiments have been 
devoted to exploring this energy regime (refer to Sect. 7 for a brief review of a few  
of these goals). In this chapter, we describe the Compton Spectrometer and Imager 
(COSI), previously a balloon-borne instrument now funded as a future NASA Small 
Explorer space mission, which uses state-of-the-art high purity germanium detectors 
to tackle the challenges of observing in this bandpass. 
Spectroscopic, imaging, and polarization studies of MeV photons have his-
torically suffered from poorer sensitivity compared to those in adjacent energy 
ranges. In astrophysics, this range is accordingly referred to as the “MeV gap” 
(0.1–10 MeV) [1, 2]. Figure 1 shows the diminished sensitivity of astrophysics 
instruments operating within the MeV gap compared to missions which detect 
photons of lower and higher energies. Poorer sensitivity in the MeV gap is attributed 
to: 
1. Low interaction cross-sections 
2. High instrumental background 
J. Beechert () · H. Lazar 
Space Sciences Laboratory, University of California, Berkeley, CA, USA 
e-mail: jbeechert@berkeley.edu; hadlaz@berkeley.edu 
A. Y. Shih 
NASA Goddard Space Flight Center, Greenbelt, MD, USA 
e-mail: albert.y.shih@nasa.gov 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
C. Hansson, K. (Kris) Iniewski (eds.), X-ray Photon Processing Detectors, 
https://doi.org/10.1007/978-3-031-35241-6_10
225

226
J. Beechert et al.
Fig. 1 The “MeV gap” between 0.1–10 MeV is characterized by poor continuum sensitivity 
compared to adjacent energy ranges. Continuum sensitivity is a measure of minimum detectable 
ﬂux from a gamma-ray source. Image is from [3] 
3. Instrumental constraints 
Photon detection is predicated on interaction with matter. The cross-section of 
this interaction is a measure of probability which is dependent on both photon 
energy and the properties of the detecting material. For example, in silicon (atomic 
number normal upper Z equals 14Z = 14) and germanium (normal upper Z equals 32Z = 32), two commonly used materials for 
semiconductor detectors, the overall interaction cross-section reaches a minimum 
near an incident photon energy of a few MeV (Fig. 2), squarely in the MeV gap. 
Figure 2 also demonstrates that the dominant interaction mechanism between 
tilde 0.1 minus 10∼0.1−10 MeV is Compton scattering. Photons typically Compton scatter between 
two and seven times in the detector volume, each at a different location and 
with changing energy. Sophisticated event reconstruction algorithms are required 
to chronicle this complicated sequence of Compton scatters. In recognition of 
Compton scattering as the dominant interaction mechanism in this energy range, 
detectors are developed to induce and track the Compton scattering path of photons 
throughout the instrument; refer to Sect. 3 for an overview of this operating 
principle. 
Additionally, MeV astrophysics missions are susceptible to signiﬁcant back-
ground contamination from nuclear excitation and de-excitation of instrument 
materials. This is often referred to as “instrumental activation.” Instrument mate-
rials, including the HPGe detectors themselves and surrounding components, can 
be excited to higher energy states, i.e. are “activated,” by incident high-energy 
particles from space, often cosmic rays. The activated materials subsequently decay 
on the time scale of desired measurements via the emission of a gamma-ray.

Germanium Detectors for MeV Gamma-Ray Astrophysics with COSI
227
Fig. 2 Attenuation of 
photons in germanium and 
silicon, two common 
materials for semiconductor 
detectors used for gamma-ray 
detection. The MeV gap is 
dominated by Compton 
scattering and encompasses 
the minimum overall 
interaction cross-section near 
a few MeV. Attenuation data 
are from NIST XCOM [4] 
The gamma-rays from these background nuclear decays lie in the MeV bandpass 
and must be distinguished from signal photons, further underscoring the uniquely 
difﬁcult conditions of observing in this regime. Discerning the background activa-
tion gamma-rays from astrophysical gamma-rays often involves a combination of 
substantial simulation time, uncertain estimations of high-energy particle ﬂuxes in 
the instrument’s orbit, and dedicated observation time of background irradiation on 
gamma-ray instruments. Machine learning methods may also be used to separate 
signal and background. 
Finally, astronomical instruments are subject to practical constraints which hin-
der their ability to detect photons in the MeV range. MeV photons are of sufﬁciently 
high energy to Compton scatter non-negligible distances and even pair produce, 
creating tracks on the order of several centimeters which must be fully contained 
in the detector volume. Creating arbitrarily large detectors, however, is not without 
cost. It is difﬁcult to manufacture large solid state detectors, and balloon and satellite 
launch platforms face strict upper limits on mass. Additionally, typical orbiting 
altitudes of MeV astrophysics instruments are plagued by atmospheric background 
contamination. Particle and photon interactions in the Earth’s atmosphere cause it to 
emit intensely in the gamma-ray bandpass. This atmospheric “glow” in gamma-rays 
is called Earth albedo radiation. Balloon missions, which typically ﬂoat at altitudes 
of approximately 30–40 km in the Earth’s atmosphere, require heavy shielding to 
reject these events. Satellite orbits avoid this signiﬁcant source of background by 
their increased distance from the Earth albedo radiation. 
Carefully curated instrument designs using semiconductors, scintillators, 
gaseous detectors, electron-tracking silicon wafers, and more have been developed 
to address the immediate need for sensitive measurements of MeV gamma-rays. 
The following sections describe how COSI uses germanium detectors to perform 
the high-resolution spectroscopic, imaging, and polarization analyses required to 
close the MeV gap. A discussion about germanium detectors, with comparison to 
adjacent detector technologies, is provided in Sect. 2, followed by an introduction to

228
J. Beechert et al.
the general operating principle of Compton telescopes in Sect. 3. Sect. 4 describes 
the COSI instrument in more detail and is followed by an overview of its calibration 
procedures (Sect. 5), metrics of instrument performance (Sect. 6), and ﬁnally 
scientiﬁc achievements as a balloon-borne germanium Compton telescope (Sect. 7). 
2 
High-Purity Germanium Detectors 
Germanium semiconductor detectors—particularly high-purity germanium (HPGe) 
detectors—have key advantages for making breakthrough observations in the MeV 
gap. Not only can HPGe detectors be fabricated with large volumes and excellent 
energy resolution, but modern advances in contact fabrication enable the ﬁne 
segmentation of such large-volume HPGe detectors to locate individual energy 
depositions in 3D, not just 2D. Even one of germanium’s limitations—its merely 
good and not excellent stopping power—can be considered an enabling feature for 
certain types of instruments. 
Energy Resolution 
As with other semiconductor detectors, germanium detectors achieve excellent 
energy resolution thanks to the large number of electron-hole pairs that are created 
when energy is deposited. Among semiconductors, germanium has the lowest 
average energy (2.96 eV) to create an electron-hole pair, so depositing 1 MeV 
creates tilde∼340,000 pairs. The intrinsic relative uncertainty of this number would 
already be very low if Poisson statistics were appropriate, but because the creation of 
electron-hole pairs is not statistically independent, the actual variance is smaller than 
Poisson variance by an empirical ratio called the Fano factor [5]. This low intrinsic 
uncertainty is just one component of the energy resolution, which is typically 
dominated by other sources of noise (e.g., from readout electronics). However, there 
are some instruments that are able to achieve Fano-limited energy resolution. 
By contrast, scintillator detectors produce far fewer scintillation photons for the 
same amount of energy deposited, with tilde∼15 eV per scintillation photon on average 
for even the brightest scintillators. There are also inefﬁciencies and losses in the 
detection of those scintillation photons (e.g., by a photomultiplier tube). For a 
deposition of 1 MeV in the scintillator, there may be only tilde∼10,000 photoelectrons 
produced at the input of the corresponding photomultiplier tube. Finally, there is no 
analogue of the Fano factor: the relative uncertainty of the number of photoelectrons 
behaves as predicted by Poisson statistics. Consequently, scintillator detectors have 
energy resolutions that are at least an order of magnitude worse than germanium 
detectors. 
Finely Segmented Large Volumes 
Semiconductor detectors are typically limited to thicknesses of tilde∼1 cm at most  
because the achievable impurity levels are too high to prevent breakdown when 
applying high-voltage bias. HPGe detector material is fabricated in a process

Germanium Detectors for MeV Gamma-Ray Astrophysics with COSI
229
speciﬁc to germanium called zone reﬁning where impurities are “swept” out, 
resulting in one to two orders of magnitude lower impurity levels [6]. A HPGe 
detector can then reach a thickness of multiple centimeters in the bias direction, and 
depending on the the detector geometry, can have a volume of hundreds of cubic 
centimeters. Other semiconductor detectors would be able to achieve such volumes 
only through two- or three-dimensional arrays of smaller detectors (e.g., each with 
a volume of tilde∼1 cc), with correspondingly greatly increased design complexity and 
unavoidable passive material between the detectors that would degrade the quality 
of measurements. 
Furthermore, the blocking contacts for such large-volume detectors can now 
be fabricated using amorphous germanium (or silicon), instead of traditional 
techniques such as lithium-drifted contacts. The excellent blocking properties 
of amorphous-germanium contacts facilitate ﬁne electrical segmentation of the 
contacts akin to the pixelization that is possible with thin semiconductor detectors. 
The HPGe detectors on COSI leverage this advantage by using orthogonal strip 
contacts on opposite faces to recover the full 3D location of each energy deposition. 
As mentioned previously, such full 3D information could alternatively be 
recovered through a massive 3D array of pixelated non-germanium semiconductor 
detectors, albeit at greatly increased design complexity. The large volume attainable 
in a single HPGe detector compares favorably to the typical large scintillator 
detector (e.g., 3 double prime times 3 double prime3′′ × 3′′ crystals) and it is simpler to achieve volumes of thousands 
of cubic centimeters through arrays of scintillator detectors than arrays of HPGe 
detectors, given the associated electronics. However, such an array of scintillator 
detectors would not reap the other beneﬁts of HPGe detectors. 
Cryogenic Operation 
Germanium’s excellent energy resolution is coupled with its most readily apparent 
limitation: germanium detectors typically must be operated at cryogenic tempera-
tures. The need for such low temperatures is that the bandgap energy of germanium 
is only 0.7 eV, one of the smallest for a semiconductor. Accordingly, germanium at 
room temperature continuously generates electron-hole pairs from thermal motion 
alone, and the resulting thermal leakage current renders the detector inoperable. 
Most non-germanium semiconductor detectors can be operated at room tem-
perature, although they would typically beneﬁt from reduced noise if cooled to 
0Superscript ring◦C or colder. In a laboratory setting, germanium detectors are typically kept cold 
using liquid nitrogen, and thus are operated at a temperature close to 77 K. In 
space, missions such as RHESSI [7] and INTEGRAL [8] have demonstrated the 
effectiveness of using a mechanical cryocooler to maintain germanium detectors at 
liquid-nitrogen temperatures, which allows for mission durations of over a decade 
thanks to the lack of an expendable resource. 
Stopping Power 
The stopping power of a gamma-ray detector is primarily a function of the mass of 
the detector material, but it also depends on the atomic number (Z) because higher-
Z materials are more likely to absorb photons rather than allow them to Compton

230
J. Beechert et al.
scatter and potentially escape the material. Germanium has the relatively low Z of 
32 compared to elements in other materials used for gamma-ray detectors—e.g., 
the iodine in sodium-iodide detectors has a Z of 53—and thus for the same mass, 
germanium’s efﬁciency for fully stopping an incident gamma-ray is lower. Yet, 
this slightly lower photopeak efﬁciency can be mitigated by the large achievable 
volumes of HPGe detectors, and regardless may be a worthwhile trade-off for the 
excellent energy resolution. 
Speciﬁcally, compared to other materials, gamma-rays will tend to Compton 
scatter in germanium. Moreover, the Compton-scattered photon is more likely to 
travel an appreciable distance or scatter again prior to being absorbed. While this 
behavior does negatively impact the photopeak efﬁciency, it turns out to be an 
enabling feature for Compton telescopes, which are described in the next section. 
3 
Principles of Gamma-Ray Detection in Compton 
Telescopes 
As photons propagate through the detector volume of Compton telescopes, the 
deposited energies and locations of each interaction site are recorded. The energy of 
a Compton-scattered photon (upper E primeE′) is given by the Compton equation: 
upper E prime equals StartStartFraction upper E 0 OverOver 1 plus StartFraction upper E 0 Over m Subscript e Baseline c squared EndFraction left parenthesis 1 minus cosine phi right parenthesis EndEndFraction commaE′ =
E0
1 +
E0
mec2

1 −cos φ
,
(1) 
where upper E 0E0 is the initial energy of the photon, m Subscript e Baseline c squaredmec2 is the rest energy of the electron, 
and cosine phicos φ is the cosine of the Compton scattering angle. The operating principle of 
a “compact” Compton telescope (CCT) uses the measured energies and locations of 
at least two interaction sites to conﬁne the origin of the propagating photon to a cone 
deﬁned by cosine phicos φ; refer to Sect. 3.1 for an explanation of the “compact” distinction. 
Figure 3 illustrates this principle with an example case of only two interaction 
sites: an incident photon Compton scatters in the detector volume at location bold italic r bold 1r1, 
deposits energy upper E 1E1, and subsequently deposits energy upper E 2E2 at location bold italic r bold 2r2 in a ﬁnal 
photoabsorption interaction (i.e., upper E 2E2 is equal to upper E primeE′ in Eq. 1). The energy of the 
incident photon is reconstructed as the sum of the deposited energy, upper E 0 equals upper E 1 plus upper E 2E0 = E1 + E2. 
The origin is constrained to a circle on the sky tracing the base of the Compton cone, 
which is deﬁned by: 
cosine phi equals 1 minus StartFraction m Subscript e Baseline c squared Over upper E 2 EndFraction plus StartFraction m Subscript e Baseline c squared Over upper E 1 plus upper E 2 EndFraction period cos φ = 1 −mec2
E2
+
mec2
E1 + E2
.
(2)

Germanium Detectors for MeV Gamma-Ray Astrophysics with COSI
231
Fig. 3 Principle of Compton telescopes. Left: Illustration of a gamma-ray event with two 
interactions measured by detectors with 3D position measurement capabilities (COSI, a CCT, is 
shown). Compton scattering detectors can reconstruct the Compton scattering angle (phiφ) and  the  
azimuthal scattering angle (etaη). Image from [9]. Right: The intersection of overlapping event circles 
marks the source location 
The intersection of overlapping circles on the sky, also called “event circles,” from 
multiple incident photons localizes the source (Fig. 3). Optionally tracking the recoil 
electron of a Compton scatter provides additional kinematic information which can 
reduce the circles to arcs on the sky. 
Event reconstruction in CCTs is complicated by the fact that the timing resolution 
of the HPGe detectors is too coarse to determine the sequence of interactions 
with absolute time tags (tilde 10∼10 ns resolution for interactions which occur on 
sub-nanosecond scales). As such, the most likely gamma-ray path is determined 
through interaction probabilities and kinematics. The Klein-Nishina differential 
cross-section (Eq. 3; [10]) deﬁnes the probability of a Compton interaction given its 
measured scattering angle and energy. It is also dependent on photon polarization, 
though this is not used in the event reconstruction. 
StartFraction d sigma Over d upper Omega EndFraction equals StartFraction r 0 squared Over 2 EndFraction left parenthesis StartFraction upper E prime Over upper E EndFraction right parenthesis squared left parenthesis StartFraction upper E Over upper E prime EndFraction plus StartFraction upper E prime Over upper E EndFraction minus 2 sine squared phi cosine squared eta right parenthesis dσ
d = r2
0
2
E′
E
2 E
E′ + E′
E −2 sin2 φ cos2 η

(3) 
Additionally, given the properties of the detector material and energy of the gamma-
ray, the probability that the traveling gamma-ray traverses the distance between any 
two potentially sequential interactions limits the number of possible paths. Further 
constraints on the order of interactions are derived from redundancy between 
kinematic and geometric determinations of the Compton scattering angle: the 
correct order of interactions is that which gives the same scattering angle, within 
uncertainties [11, 12]. A Bayesian approach [12, 13], a random forest of decision 
trees, and shallow neural networks are also being developed for event reconstruction 
in Compton telescopes. For more information about these techniques and the 
principles of gamma-ray detection in Compton telescopes, refer to [2, 12, 14].

232
J. Beechert et al.
3.1 
Comparison to Other Gamma-Ray Instruments 
There are advantages and disadvantages of the CCT design compared to other 
commonly employed gamma-ray instruments, including the “classic” Compton 
telescope, the coded-mask imager, and the Laue lens. 
Both the “classic” Compton telescope and CCT designs perform single-photon 
reconstruction. A “classic” Compton telescope (e.g. the COMPTEL instrument 
on-board NASA’s CGRO satellite [15]) Compton scatters a photon once in a low-
Z scattering plane positioned tilde∼2 m above a high-Z absorber plane, where the 
remaining energy is deposited via photoabsorption. The classic telescope is simpler 
in design but has lower efﬁciency than the CCT, as it can only detect photons which 
Compton scatter once and at a small enough angle to be detected in the absorber 
plane. 
A coded-mask imager (e.g. the SPI instrument on-board ESA’s INTEGRAL 
satellite [8]) reconstructs sources through shadow patterns cast by incident photons 
on a plane of semiconductor detectors (HPGe) positioned below a high-Z (tungsten) 
mask. Coded-masks boast simplicity in design and event reconstruction, as there 
is only one interaction per event. This simplicity sacriﬁces sensitivity to low ﬂux 
gradients and intrinsic background rejection techniques in CCTs, which can boost 
sensitivity by factors of tilde∼5–10. 
Lastly, Laue lens instruments use Bragg diffraction to focus gamma-rays onto 
a detector plane. They have low background due to small collecting areas and 
achieve remarkable arc-second angular resolution, but strict diffraction requirements 
severely limit their energy range and ﬁeld of view and require prohibitively long 
focal lengths of greater than 10> 10 m. 
Thus, only the CCT can perform single-photon reconstruction, wide ﬁeld-of-
view imaging of low-gradient emission, and intrinsically suppress background 
events. A comprehensive review of Compton telescopes in gamma-ray astrophysics 
is provided in [16], and a review of various telescope concepts in the ﬁeld is provided 
in [2]. 
4 
The Compton Spectrometer and Imager 
COSI is an MeV gamma-ray CCT designed to determine the nature of Galactic 
positrons, measure emission from Galactic nucleosynthesis, and perform novel 
polarization measurements of gamma-ray bursts (GRBs) and compact objects. It 
was originally deployed as a scientiﬁc balloon mission [17] and is being upgraded 
to a satellite mission for launch in 2027 [18]. Operating COSI at balloon (tilde∼33 km) 
or satellite orbits (low-Earth orbit tilde∼500 km) is necessary because MeV photons 
are attenuated in the atmosphere and cannot be detected on the ground. The HPGe 
detector volume of the balloon instrument (Fig. 4), the advantages of which uniquely

Germanium Detectors for MeV Gamma-Ray Astrophysics with COSI
233
Fig. 4 Top left: One of COSI’s twelve HPGe detectors. The reﬂection in the mirror shows the 
orthogonal strips on the opposite side of the detector. Image from [19]. Top right: Stack of COSI’s 
HPGe detectors which form the full detector volume. Image from [20]. Bottom left: The COSI 
cryostat maintains the detectors at pressures of 10 Superscript negative 610−6 torr. The cryocooler in the foreground cools 
the detectors to tilde∼84 K. Image from [20]. Bottom right: The fully assembled COSI gondola before 
launch in 2016. Image courtesy of the COSI collaboration 
enable COSI to pursue its scientiﬁc objectives, is described in this section1 . The  
satellite design will be very similar. 
4.1 
COSI HPGe and instrument Design 
COSI’s detector volume is comprised of twelve double-sided cross-strip HPGe 
detectors (Fig. 4). The detectors are 8 times 8 times 1.5 c m cubed8 × 8 × 1.5 cm3 and were fabricated using
1 This section draws heavily from the publication [20]: Beechert, Lazar, et al., Calibrations of 
the Compton Spectrometer and Imager, Nuclear Instruments and Methods in Physics Research 
Section A: Accelerators, Spectrometers, Detectors and Associated Equipment, Volume 1031, 2022, 
166510, ISSN 0168-9002, https://doi.org/10.1016/j.nima.2022.166510. 

234
J. Beechert et al.
the Lawrence Berkeley National Laboratory’s amorphous Ge contact technology 
[21]. Orthogonally oriented aluminum strip electrodes are deposited on opposite 
sides of the detector. The 37 strips on each side (888 total over all detectors) are 
of 2 mm strip pitch and the gap between each strip is 0.25 mm. This gap achieves 
a balance between small gaps, which minimize the risk of losing charge carriers 
that fall between strips, and large gaps, which improve energy resolution through 
decreased strip capacitance. Leakage current from events close to the edge of the 
detector is collected by a 2 mm-wide guard ring that surrounds the active area of 
each detector face. Note that the COSI satellite instrument will have sixteen of these 
detectors with 64 strips per side for enhanced effective area and angular resolution, 
respectively. 
The intersection of orthogonal triggered strips deﬁnes the x–y position of a 
photon interaction [22]. The depth of the interaction in the detector (z-position) is 
computed from the timing difference between electrons collected on the positively 
biased side (anode) and the holes collected on the grounded side (cathode) of the 
detector. Sect. 5.5 explains the conversion from timing to depth in more detail. 
Overall, the orthogonal strip electrodes have a 3D position resolution, deﬁned as 
the product of the x minusx−, y minusy−, and z minusz−position resolutions (tilde∼2, tilde∼2, and tilde∼0.5 mm, 
respectively), of approximately 2 mmcubed3 [23]. 
The detectors are over-depleted with bias voltages between 1000 V and 1500 V. 
The high-voltage side is AC-coupled and accordingly referred to as the “AC side” 
(anode), while the low-voltage side is referred to as the “DC side” (cathode). To 
limit the effect of electronic noise, coincident triggers on the AC and DC sides are 
required to trigger the readout. Since launching the instrument with consumable 
liquid nitrogen would limit the mission duration and add considerable weight to the 
instrument payload, the detectors are cooled by a Sunpower CryoTel CT mechanical 
cryocooler (tilde∼26 cm long, tilde∼8 cm diameter; [24]) to approximately 84 K. The 
aluminum cryostat thermally isolates the detectors and maintains them at a pressure 
of approximately 10Superscript negative 6−6 torr (Fig. 4). 
5 
Calibrations 
Robust calibrations are required to fully exploit the advantages afforded by HPGe 
detectors. This section (see footnote 1) details the calibration procedures which 
convert raw data from the COSI detectors into quantities with physical units, which 
can then be readily interpreted for the purposes of instrument performance or 
scientiﬁc analysis. A series of necessary corrections arising from effects intrinsic to 
the detectors, electronics, and the external environment are described as well. Each 
of these steps is essential to the end product: gamma-ray events whose energies 
and origins have been determined with the high resolution characteristic of HPGe 
detectors. 
While these procedures were developed speciﬁcally for the COSI instrument, the 
underlying principles are transferable to other applications. All electronic pulse-

Germanium Detectors for MeV Gamma-Ray Astrophysics with COSI
235
heights must be converted to energy, for example. The observed inﬂuence of 
temperature on COSI’s readout electronics may affect similar laboratory setups 
(e.g., see [25] for an alternative method of correcting temperature dependence in 
gamma-ray spectra from NaI scintillators). Thus, this section presents a calibration 
pipeline which can be adapted to an instrumentalist’s particular needs. 
5.1 
Energy Calibration 
Energy calibration deﬁnes the conversion from electronic readout units (e.g. ADC) 
to physical units (e.g. keV). This conversion is unique to each strip electrode, as 
COSI’s 888 strips are read out individually by the data acquisition system. There are 
variations in gain, threshold, and other electronic considerations which differentiate 
the strips’ individual calibrations and prohibit a global conversion. To achieve the 
required individual treatment, each strip is illuminated with radioactive sources that 
emit gamma-ray lines of known energy across COSI’s energy range. Each strip 
records a spectrum of pulse heights in response to the radiation. The photopeaks are 
ﬁt in ADC space (the pulse heights) with a Gaussian, lower-energy continuum, and 
a linear background model. The ﬁtting algorithm returns the centroid value of each 
ﬁtted peak in ADC and matches it with the corresponding known, true photopeak 
energy in keV. The centroid energy versus ADC relation for each strip is ﬁt with a 
polynomial that deﬁnes the desired relationship between pulse height and energy. 
While the centroid of the photopeak deﬁnes the energy calibration, the full-
width half maximum (FWHM) of each photopeak deﬁnes the single-strip, energy-
dependent energy resolution of the instrument. The “single-strip” distinction is 
important when considering the spectral capabilities of the HPGe detectors them-
selves against the spectral capabilities of the instrument overall. The photopeaks 
recorded on individual strips measure the signals induced by charge carriers in 
individual HPGe detectors and their respective electronic readouts. Photopeaks from 
spectra of fully reconstructed Compton events, namely those reconstructed from 
multiple Compton scatters potentially spanning several detectors, are additionally 
affected by subsequent calibrations and the quality of the event reconstruction itself. 
As a result, the single-strip resolution discussed here is a more reliable proxy of the 
performance of the HPGe detectors themselves, compared to that of the full COSI 
instrument (Sect. 6.1). 
The single-strip spectral resolution of COSI is given as the ratio of the FWHM of 
the Superscript 137 Baseline upper C s137Cs gamma-ray line to its photopeak energy of 661.7 keV. In 2016 and 2020 
calibration data, COSI had an average spectral resolution of 0.49 plus or minus 0.010.49 ± 0.01% on the  
AC side and 0.47 plus or minus 0.010.47±0.01% on the DC side. Figure 5 demonstrates the dependence of 
COSI’s single-strip energy resolution on photon energy E. Below 1 MeV, the energy 
resolution is dominated by electronic noise and is approximately independent of 
photon energy. Accordingly, we expect the percentage energy resolution to scale as 
1 divided by upper E1/E. Indeed, ﬁtting the data points of percentage energy resolution versus energy 
with a power law gives a power law index k equals negative 0.96k = −0.96, matching expectations of 
dominant electronic noise in COSI up to about 1 MeV.

236
J. Beechert et al.
Fig. 5 Single-strip energy 
resolution (FWHM) as a 
function of energy in 2016 
and 2020 energy calibrations. 
The ﬁtted power law 
exponent k equals negative 0.96k = −0.96 is 
consistent with expectations 
of dominant electronic noise 
in COSI’s detectors. Image 
from [20] 
5.2 
Temperature Dependence of the Readout Electronics 
Though not intrinsic to HPGe detectors, an important consideration during operation 
is that the accompanying electronic readout system may exhibit a temperature 
dependence. COSI’s preampliﬁer boards were observed to shift pulse-height spectra 
by up to 0.5 keV/Superscript ring◦C at 661.7 keV in laboratory calibrations [3], displacing recorded 
photopeak energies from their true values. Correcting the dependence is therefore 
critical to preserving HPGe detectors’ excellent energy resolution. 
A linear relationship between preampliﬁer temperature and ADC peak location 
was determined for each strip, yielding a precise correction tailored to each strip’s 
individual readout. The correction reduced the difference between measured and 
true line energy from 0.5 to 0.1% [3]. Experimentalists should be mindful of how 
ambient conditions may affect their chosen electronic readout and in turn, the 
interpreted performance of the detectors. Dedicated calibration time at controlled 
temperatures would greatly beneﬁt this effort. 
5.3 
Cross-Talk Correction 
An additional deleterious electronic effect is “cross-talk,” which refers to electronic 
interactions between a strip and its neighbors that affect the measurement of charge 
on that strip. For COSI, a fraction of the events on a strip are affected by cross-talk 
and register more charge than was actually collected, which creates a “bump” in 
the higher-energy tail of the photopeak (Fig. 6). Correcting this offset between true 
and enhanced energy is necessary for accurate event reconstruction and spectral 
analysis. 
For COSI, the spurious enhancement in measured charge due to cross-talk is 
strongly correlated with corresponding enhancements in the neighboring strips,

Germanium Detectors for MeV Gamma-Ray Astrophysics with COSI
237
Energy (keV) 
620
640
660
680
700 
Counts / keV 
0 
50 
100 
150 
200 
3 
10 
Energy (keV) 
620
640
660
680
700 
Counts / keV 
0 
100 
200 
300 
400 
3 
10 
Fig. 6 The cross-talk inﬂuence of neighboring strip electronics enhances the energy recorded on 
nearby strips. Left: The resulting enhancement is visible at higher energies in an uncorrected Superscript 137 Baseline upper C s137Cs
spectrum. Right: Applying a linear correction removes the enhancement. Images are from [3] 
and this relationship is carefully calibrated. The effect of cross-talk can then be 
subtracted from the measured charge in a strip using the information from the 
neighboring strips [3]. Figure 6 demonstrates how applying the cross-talk correction 
removes the unwanted enhancement at tilde∼670 keV and restores the spectrum to its 
expected appearance with one Gaussian photopeak at 661.7 keV. 
5.4 
Strip Pairing 
The x–y position of an interaction is determined using the triggered AC- and DC-
side strips in a process called strip pairing [26]. Strip pairing is straightforward if 
there is only one interaction in a detector: the x–y position is the point at which 
the orthogonal AC- and DC-side strips intersect. As the number of interactions 
increases, however, so does the number of candidate interaction locations. The 
correct solution matches the AC- and DC-side strips that record the most similar 
energy; neglecting small differences in recorded charge from the effects of charge 
carrier transport (e.g., electron vs. hole mobility in germanium), the charge induced 
by the equal number of electrons and holes generated in the interaction should be 
the same. 
The strip pairing process is further complicated by detector and electronics 
effects such as ﬁnite energy resolution, charge sharing between adjacent strips, 
multiple interactions occurring on a single strip, and energy distortion due to charge 
loss, including sub-threshold energy deposits (see [19] for more details). A strip-
pairing algorithm which accommodates these effects is of the utmost importance, as 
accurate position determination is critical to proper event reconstruction.

238
J. Beechert et al.
5.5 
Depth Calibration 
Strip pairing deﬁnes the two-dimensional position of an interaction as the inter-
section of orthogonal strips on opposite sides of the HPGe detectors. The third 
dimension, depth in the detector, is derived from the collection time difference 
(CTD, denoted below by tauτ) of electrons and holes generated in the interaction. 
When a charge cloud is generated in a detector, electrons and holes drift in opposite 
directions along ﬁeld lines to the AC and DC sides of the detector, respectively. The 
drift times differ depending on the interaction location. For example, the electron 
collection time will be less than that of the hole if the charge cloud is produced 
closer to the AC side. Hence, the CTD is a proxy for localizing the depth of the 
interaction. 
Each of the “pixels” (37 strips times× 37 strips times× 12 detectors = 16,428 regions 
segmented by the grid of orthogonal strips) in the detectors is uniquely calibrated 
to account for individual strip readout and variations in drift velocities across the 
detector volume. The calibration procedure was developed by the Nuclear Compton 
Telescope [27] and was subsequently implemented by COSI. A detailed explanation 
of the approach is provided in [28, 29] and is adapted here for brevity. 
Numerical simulations solve Poisson’s equation for the electrostatic potential 
inside a simpliﬁed 5 times 55 × 5 strip detector with appropriate boundary conditions 
(detector bias) and detector characteristics (impurity concentrations and thickness). 
The applied high voltage bias in COSI’s detectors is 1000–1500 V. The weighting 
ﬁeld [6] is calculated by setting each strip to 1 V and rest to 0 V. The Shockley-
Ramo theorem [30] then uses the weighting ﬁeld to calculate the current induced 
on the electrodes by charge carriers which move along the previously determined 
electric ﬁeld. These simulations create a look-up table relating the CTD (tau Subscript s i mτsim) to  
depth in each detector. 
A real CTD (tau Subscript m e a sτmeas) in each pixel of the instrument is recorded using a Superscript 137 Baseline upper C s137Cs
calibration source. This calibration run is then mimicked in simulations to produce a 
histogram of interaction depths, i.e. a simulated depth distribution, for each detector. 
These simulated depth distributions are converted to simulated CTD distributions 
from units of centimeters to nanoseconds using look-up tables. This simulated CTD 
distribution for each detector, called a “CTD template,” is then used to calibrate the 
detectors’ constituent pixels. We ﬁt for the “stretching” lamdaλ and “offset” upper Delta factors that 
most closely transform measured CTDs from each pixel into the CTD template of 
the detector which hosts the pixel of interest. The transformation is given by 
tau Subscript m e a s Baseline equals lamda tau Subscript s i m Baseline plus upper Delta periodτmeas = λτsim + .
(4) 
The lamdaλ and upper Delta returned for each pixel are used to calculate a per-pixel tau Subscript s i mτsim that 
is converted to a depth via the simulated look-up table. Thus, a pixel-speciﬁc depth 
calibration relating the CTD and z-coordinate of each interaction is obtained.

Germanium Detectors for MeV Gamma-Ray Astrophysics with COSI
239
6 
Instrument Performance 
In order to assess the instrument’s performance as a spectrometer, imager, and 
polarimeter, it is necessary to quantify the expected performance with metrics 
including energy resolution, angular resolution, effective area, and polarization 
sensitivity. This process is called “benchmarking.” These metrics are dependent 
on the ﬁdelity of the previously described calibrations, and in turn on the HPGe 
detectors. The benchmarking results in this section (see footnote 1) are presented as 
a cumulative manifestation of the high-performing instrumentation and scientiﬁc 
achievements made possible only through the development of HPGe detector 
technology. 
Note that the data used in these analyses are fully reconstructed Compton events: 
the energy calibration converts ADC to energy, the temperature and cross-talk 
corrections are applied, the strip-pairing algorithm determines the most likely x– 
y positions of the interactions, and the depth calibration returns the z-coordinate of 
the interactions. These calibrated strip hits are then grouped as single gamma-ray 
events that scatter through the instrument. 
6.1 
Energy Resolution 
We study the energy resolution of fully reconstructed Compton events to understand 
the instrument’s spectral performance. Recall that this energy resolution differs 
from the single-strip energy resolution discussed in Sect. 5.1, the latter of which 
considers hits on individual strips. The single-strip resolution is more a measure 
of an individual detector’s spectral performance while the resolution of fully 
reconstructed events informs the spectral performance of the instrument as a whole. 
The energy resolution is again deﬁned as the ratio of a reconstructed photopeak’s 
FWHM to its true line energy. The energy resolution as a function of energy in 2020 
calibration data is shown in Table 1. COSI’s HPGe detectors have an average energy 
resolution of 0.7% across its energy range, granting the discriminating resolution 
required for high precision spectroscopic analyses. 
Table 1 Fully-reconstructed energy resolution, angular resolution, and effective area in 2020 
calibration data. Listed values are from [20] 
Line energy
FWHM
Energy
Angular
Effective 
Isotope
[keV]
[keV]
resolution [%]
resolution [Superscript ring◦] 
area [cmsquared2] 
Superscript 22 Baseline upper N a22Na
511.0
5.78 plus or minus 0.015.78 ± 0.01
1.1
5.97 plus or minus 0.045.97 ± 0.04
12.0 plus or minus 0.512.0 ± 0.5
Superscript 137 Baseline upper C s137Cs
661.7
5.27 plus or minus 0.015.27 ± 0.01
0.8
5.1 plus or minus 0.15.1 ± 0.1
9.6 plus or minus 0.4 9.6 ± 0.4
Superscript 60 Baseline upper C o60Co
1173.2
6.80 plus or minus 0.026.80 ± 0.02
0.6
4.13 plus or minus 0.044.13 ± 0.04
6.4 plus or minus 0.3 6.4 ± 0.3
Superscript 22 Baseline upper N a22Na
1274.5
7.04 plus or minus 0.037.04 ± 0.03
0.6
6.1 plus or minus 0.36.1 ± 0.3
6.1 plus or minus 0.3 6.1 ± 0.3
Superscript 60 Baseline upper C o60Co
1332.5
6.97 plus or minus 0.026.97 ± 0.02
0.5
4.2 plus or minus 0.14.2 ± 0.1
5.3 plus or minus 0.2 5.3 ± 0.2

240
J. Beechert et al.
6.2 
Angular Resolution 
Event reconstruction in a Compton telescope localizes the origin of an incident 
photon to an “event circle” on the sky. The overlap of circles from many events 
marks the measured location of the source (Sect. 3, Fig. 3). Ideally, in the case of a 
known source, this overlap lies at source’s true location. A histogram of the smallest 
angular distance between the source’s true location and the event circle of each 
event has a centroid of approximately zero. This near-zero deviation between the 
measured location and the true location indicates accurate localization. The full-
width half maximum of this histogram, which represents the spread in deviation 
between measured and true source location, deﬁnes the angular resolution of the 
telescope. The angular resolution is governed primarily by the uncertainty in the 
3D position of each interaction, which in COSI is dominated by the 2 mm distance 
between the centers of adjacent strip electrodes. 
The angular resolution as a function of gamma-ray energy for 2020 calibration 
measurements is shown in Table 1. The observed improvement in angular resolution 
(monotonically decreasing values) with increasing energy is expected. Incident 
photons of higher energy travel greater distances between subsequent Compton 
interactions. This increased distance between interactions improves the quality of 
the event reconstruction because the positions are more easily resolved. 
Thus, physical considerations of the interactions inside the detectors inform 
overall trends of angular resolution. Narrow strips spaced closer together may in 
theory be able to achieve improved angular resolution. However, decreasing the strip 
pitch increases the likelihood of a competing complication called charge sharing. 
Charge sharing occurs when the charge cloud of liberated electrons and holes in an 
interaction falls on multiple adjacent strip electrodes. Determining the position of 
the interaction in the detector becomes more complicated in this case. The upcoming 
iteration of COSI as a satellite will have a slightly ﬁner strip pitch of 1.16 mm and is 
expected to improve upon the COSI’s balloon’s angular resolution by approximately 
a factor of two [18]. Identifying the ideal strip pitch is dependent on the speciﬁc 
goals and requirements of a given experiment. 
6.3 
Effective Area 
The effective area is a measure of an instrument’s detection efﬁciency and geomet-
rical size. In Compton telescopes, the effective area is maximized by using a large 
collecting area and detector volume which can fully contain an incident photon’s 
multiple Compton scatters and ﬁnal photoelectric absorption. For this reason, large 
volume HPGe detectors, like COSI’s 2 times 2 times 32 × 2 × 3 array of 8 times 8 times 1.58 × 8 × 1.5 cmcubed3 detectors 
(Fig. 4), are a natural choice for Compton telescopes. 
We scale COSI’s collecting area by an efﬁciency to quantify its effective area. 
The efﬁciency is deﬁned as the ratio of the measured luminosity, or count rate, to the

Germanium Detectors for MeV Gamma-Ray Astrophysics with COSI
241
incident luminosity of radioactive calibration sources. The former is determined as 
the number of events in a measured photopeak divided by a known observation time. 
The latter is determined from the source activity and distance of the source from the 
instrument. Additional effects including electronic dead time and attenuation in air 
of incident photons are considered. 
Table 1 lists the effective area as a function of incident photon energy in 2020 
calibration data. The radioactive sources in these calibrations were placed directly 
overhead the COSI cryostat at zenith; insufﬁcient calibration time prohibited a more 
comprehensive study spanning the entire ﬁeld of view. We observe the expected 
trend of decreasing effective area with increasing energy. As incident photon energy 
increases, so does the probability that a scattered photon escapes the detector volume 
before photoabsorption. Such incompletely absorbed events cannot be reconstructed 
and are vetoed from the analysis. The COSI satellite mission’s 2 times 2 times 42 × 2 × 4 array of 16 
HPGe detectors will more fully contain the scattering path of higher energy photons 
and therefore have a greater effective area than the 12-detector balloon instrument. 
6.4 
Polarization Response 
Germanium’s ability to induce Compton scattering directly facilitates studies 
of photon polarization. Compton telescopes preserve information from linearly 
polarized photons via the Klein-Nishina equation (Eq. 3), which deﬁnes the cross-
section of the Compton scattering process. It dictates that photons are preferentially 
scattered in the direction perpendicular to the incoming photon plane. Thus, photons 
in a highly polarized beam of light likely scatter in the same azimuthal direction 
(visualized by etaη in the left panel of Fig. 3). The polarization angle and level are 
inferred from the characteristic sinusoidal shape of measured azimuthal scattering 
angle distributions (ASADs; Fig. 9). Higher ASAD amplitudes indicate highly 
polarized light. 
The full method of calibrating COSI and extracting the polarization information 
from ASADs is detailed in Sect. 7.3 and [9, 20, 29]. COSI’s unique ability to study 
photon polarization with its HPGe detectors provides an additional probe of the 
geometry and emission mechanisms of high energy sources in the gamma-ray sky, 
including pulsars, active galactic nuclei, and gamma-ray bursts (GRBs). 
7 
Scientiﬁc Achievements 
Launched on May 17, 2016, from Wanaka, New Zealand, COSI was the ﬁrst science 
payload to ﬂy on NASA’s superpressure balloon technology and remained aﬂoat 
for 46 days before terminating safely over Peru on July 2, 2016. A complete 
overview of the ﬂight is provided in [31]. This section (see footnote 1) summarizes 
the spectroscopic, imaging, and polarization achievements of the 2016 ﬂight and,

242
J. Beechert et al.
by extension, demonstrates the importance of HPGe detectors to MeV gamma-
ray astrophysics. Namely, COSI observed the strong positron-electron annihilation 
signature at the center of the Milky Way Galaxy [32, 33], measured Galactic 
Superscript 26 Baseline upper A l26Al [34], detected the Crab pulsar [26], and set a constraining upper limit on 
the polarization of GRB 160530A [29, 35]. The upcoming COSI satellite draws 
signiﬁcant heritage from the balloon mission as a HPGe instrument with improved 
sensitivity that can deepen understanding of the MeV gamma-ray sky. 
7.1 
Positron-Electron Annihilation 
A balloon-borne astrophysics mission in the 1970s discovered strong, persistent 
511 keV emission emananting from the center of the Milky Way Galaxy [36, 37]. 
After decades of study, the dichotomy between its extended “disk” emission along 
the Galactic Plane and stronger “bulge” emission around the Galactic Center is not 
understood, nor is the primary source (or collection of sources) of the positrons 
fueling this annihilation. Furthermore, it is unknown whether the annihilation occurs 
at the sites of positron production or if the positrons propagate away from their 
production sites before annihilating, thereby displacing the observed emission from 
the positron sources. 
High-resolution spectroscopy of Doppler shifts in the 511 keV spectrum can 
probe the kinematics of and conditions in which the positrons annihilate. COSI’s 
balloon ﬂight in 2016 built upon SPI’s high-resolution 511 keV spectral analyses 
with HPGe [38–42]. COSI detected the 511 keV line with 7.2sigmaσ signiﬁcance (Fig. 7; 
[3, 32]) and found a ﬂux of (3.9 plus or minus 0.4 right parenthesis times 10 Superscript negative 33.9 ± 0.4) × 10−3 ph cmSuperscript negative 2−2 s Superscript negative 1−1, which exceeds that 
from SPI of (2.74 plus or minus 0.03 right parenthesis times 10 Superscript negative 32.74 ± 0.03) × 10−3 ph cmSuperscript negative 2−2 s Superscript negative 1−1 [41]. 
Fig. 7 Observations of positron-electron annihilation in the Milky Way Galaxy from the COSI 
2016 balloon ﬂight. Left: Spectrum of the emission. The centroid of the ﬁtted Gaussian is 511.8 plus or minus 0.3511.8 ±
0.3 keV and the inherent width, subtracting out ﬁnite instrumental resolution, is sigma equals 1.7 plus or minus 0.4σ = 1.7±0.4 keV 
[3, 32]. Right: Image of the emission [33] from a Richardson-Lucy deconvolution technique [43, 
44]

Germanium Detectors for MeV Gamma-Ray Astrophysics with COSI
243
To complement spectroscopic studies, SPI [45–47] and COSI (Fig. 7) have also  
imaged the 511 keV emission. The COSI image reveals a central 511 keV bulge
FWHM 28Subscript negative 12 Superscript plus 19+19
−12 Superscript ring◦
[33] that is 2–3 times larger than that reported by SPI (FWHM 
8Superscript ring◦) [48]. It is possible that COSI measured a greater overall ﬂux and a broader bulge 
than SPI because CCTs are more sensitive to small ﬂux gradients than are coded-
mask telescopes, highlighting again the importance of Compton scattering in HPGe 
instrumentation. Improved sensitivity and angular resolution in the upgrade of COSI 
as a satellite mission may clarify the discrepancy between the SPI and COSI balloon 
results and help reveal the true nature of positron annihilation in the Milky Way. 
7.2 
Radioactivity and Galactic 26Al 
Products of stellar and explosive nucleosynthesis decay primarily into the MeV 
bandpass. Studying the energy spectra of the emitted gamma-ray lines with HPGe 
detectors can reveal the origins and dynamics of these radioisotopes in the Milky 
Way Galaxy. There are four main isotopes which COSI targets for studies of nucle-
osynthesis: Superscript 2626Al (1.809 MeV), Superscript 6060Fe (1.173 MeV and 1.332 MeV), Superscript 4444Ti (1.157 MeV 
and 68 keV and 79 keV lines in the hard X-ray range), and Superscript 5656Co (0.847 MeV and 
1.238 MeV). This section focuses on Superscript 2626Al, which traces nucleosynthesis in massive 
stars and core-collapse supernovae over its lifetime of approximately 10 Superscript 6106 years. 
The HEAO-3 satellite, a germanium detector, ﬁrst detected Superscript 2626Al in the Milky 
Way Galaxy in the 1980s [49]. In the 1990s, COMPTEL produced the ﬁrst 
images of Superscript 2626Al emission in the Milky Way [50]. Note that the energy resolution 
of COMPTEL’s cesium iodide (CsI) scintillator detectors was nearly two orders 
of magnitude worse than that of germanium and insufﬁcient for spectroscopic 
studies. By contrast, SPI has conducted detailed spectroscopic studies with its HPGe 
detectors [51–53], detected the 1.809 MeV line with 58sigmaσ signiﬁcance [54], and 
produced an image largely consistent with that of COMPTEL [55]. 
Analysis of the COSI 2016 balloon ﬂight data yielded a 3.7sigmaσ signiﬁcance 
measurement of Galactic 
Superscript 2626Al with an Inner Galaxy ﬂux of 
left parenthesis 8.6 plus or minus 2.5 right parenthesis times 10 Superscript negative 4(8.6 ± 2.5) ×
10−4 ph cmSuperscript negative 2−2 s Superscript negative 1−1 [34]. This ﬂux exceeds that reported by SPI and COMPTEL 
(tilde 3.3 times 10 Superscript negative 4∼3.3 × 10−4 ph cmSuperscript negative 2−2 s Superscript negative 1−1) by approximately 2sigmaσ. The COSI satellite’s sixteen 
HPGe detectors will have the discriminating energy resolution required for detailed 
spectroscopic studies and decrease the likelihood that 1.809 MeV photons at the 
upper end of COSI’s energy range scatter out of the instrument before they are fully 
absorbed, thereby increasing the effective area. The satellite’s ﬁner strip pitch will 
also improve the angular resolution from tilde∼4Superscript ring◦in the balloon to tilde∼1.5Superscript ring◦FWHM at 
1.8 MeV [18]. This will be critical to advancing studies of Superscript 2626Al emission across the 
Milky Way Galaxy.

244
J. Beechert et al.
7.3 
Polarization 
In order to determine COSI’s polarization response and to identify systematic 
deviations from an ideal sinusoidal modulation, it is necessary to evaluate COSI’s 
polarization performance in the laboratory. This evaluation requires measuring 
a polarized beam and simulating the experimental conﬁguration. We are able 
to produce a partially polarized gamma-ray beam using a principle detailed in 
[56]. When unpolarized photons Compton scatter, the outgoing beam is partially 
polarized with a polarization level given by 
upper Pi equals StartFraction sine squared phi Over epsilon plus epsilon Superscript negative 1 Baseline minus sine squared phi EndFraction comma	 =
sin2 φ
ϵ + ϵ−1 −sin2 φ
,
(5) 
in which epsilonϵ is the ratio of scattered photon energy to initial photon energy and phiφ
is the Compton scattering angle. The polarization vector of the scattered beam is 
perpendicular to the scattering plane. We produce partially polarized gamma-ray 
beams in the laboratory by scattering photons from a NaI scintillator. As an example, 
661.7 keV photons that scatter off the scintillator at 90Superscript ring◦(to obtain the highest 
polarization level possible) produce a beam with an outgoing photon energy of 
288 keV and a polarization level of approximately tilde∼58%. Using an active detector 
as a scattering surface allows us to select only events coincident between COSI and 
the NaI and thus reject the majority of the background. 
Figure 8 shows the geometrical conﬁguration for pre-ﬂight calibrations. We sus-
pend the NaI scintillator above the instrument (GeDs within the cryostat surrounded 
by the CsI shields) and ﬁx a Superscript 137137Cs source (661.7 keV) at the cryostat’s level. 
We place a lead brick between the Superscript 137137Cs source and the COSI detector system in 
order to prevent the direct ﬂux from unnecessarily elevating the shield count rate. 
Acquiring data with the NaI scintillator in many different locations captures a range 
of polarization and scattering angles. 
Fig. 8 Left: To produce a partially polarized beam, gamma-rays from a Superscript 137137Cs source scatter off of 
a scintillator towards the HPGe detector. Right: The setup at Space Sciences Laboratory, Berkeley, 
2019. Images are from [9]

Germanium Detectors for MeV Gamma-Ray Astrophysics with COSI
245
Fig. 9 The geometrically-corrected ASAD ﬁt with a modulation curve, the parameters of which 
reﬂect the beam’s polarization level and angle 
The coincident events, which are effectively background-subtracted by cal-
culating the number of expected chance coincidences, are used to produce a 
geometrically-corrected ASAD. The characteristic sinusoidal shape of a ﬁtted, 
geometrically-corrected ASAD is shown in Fig. 9. The sinusoidal ﬁt parameters 
correlate to the known direction of the partially-polarized beam and its induced 
polarization level, which is determined by Eq. 5. 
To effectively benchmark the simulated instrument response with calibrations, 
we employ non-parametric statistical tests. The Kolmogorov-Smirnov and 
Anderson-Darling tests evaluate the hypothesis that the azimuthal scattering 
angle samples from the measurements and simulations are drawn from the same 
underlying distribution [9]. This process conﬁrms COSI’s ability to measure photon 
polarization by nature of Compton scattering in its HPGe detectors. 
8 
Conclusion 
Understanding the MeV gamma-ray sky has long been a pursuit complicated 
by measurement difﬁculties intrinsic to the energy range. Developing powerful 
instrumentation which can remedy the historical dearth of sensitivity in this “MeV 
gap” is of high priority. This chapter described the advantages of using high-
purity germanium (HPGe) as a material particularly well-suited to measuring MeV 
gamma-rays as they preferentially Compton scatter through the detectors. Compact 
Compton telescopes (CCTs) are presented as a compelling conﬁguration of HPGe 
detectors on an astrophysics platform, as demonstrated by the success of the COSI

246
J. Beechert et al.
mission. The procedures needed to calibrate the detectors and quantify instrument 
performance are detailed; these procedures can be adapted to ﬁt the needs of similar 
experiments. In conclusion, it is clear that utilizing leading technology is necessary 
to advance MeV gamma-ray astrophysics and that the implementation of HPGe in 
COSI is one such path forward for progress. 
References 
1. McEnery, J., & Amego Team. (2020). All sky medium energy gamma-ray Observatory 
(AMEGO): Exploring the extreme multimessenger universe. American Astronomical Society 
Meeting Abstracts # 235. vol. 235. 
2. Siegert, T., et al. (2022). Telescope concepts in gamma-ray astronomy. arXiv:2207.02248. 
https://arxiv.org/abs/2207.02248 
3. Kierans, C. (2018). Detection of the 511 keV positron annihilation line with the 
compton spectrometer and imager. Available from Dissertations & Theses at Uni-
versity of California; ProQuest Dissertations & Theses A&I; ProQuest Dissertations 
& Theses Global. https://www.proquest.com/dissertations-theses/detection-511-kev-positron-
annihilation-line-with/docview/2135808024/se-2?accountid=14496 
4. Berger, M. J., et al. (2010). NIST standard reference database 8 (XGAM), NIST, PML, 
Radiation Physics Division, NBSIR 87-3597. https://dx.doi.org/10.18434/T48G6X 
5. Croft, S., & Bond, D. S. (1991). A determination of the Fano factor for germanium at 77.4 K 
from measurements of the energy resolution of a 113 cm3 HPGe gamma-ray spectrometer 
taken over the energy range from 14 to 6129 keV. International Journal of Radiation 
Applications and Instrumentation. Part A. Applied Radiation and Isotopes, 42(11), 1009–1014. 
6. Knoll, G. F. (2010). Radiation detection and measurement. Hoboken: Wiley. 
7. Lin, R. P., et al. (2002). The reuven ramaty high-energy solar spectroscopic imager (RHESSI). 
Solar Physics, 210, 3–32. https://doi.org/10.1023/A:1022428818870 
8. Vedrenne, G., et al. (2003). SPI: The spectrometer aboard INTEGRAL. Astronomy & 
Astrophysics, 411(1), L63–L70. 
9. Tomsick, J. A., Lowell, A., Lazar, H., Sleator, C., & Zoglauer, A. (2022). Soft gamma-ray 
polarimetry with COSI using maximum likelihood analysis. arXiv:2204.00027 
10. Klein, O., & Nishina, Y. (1929). Über die Streuung von Strahlung durch freie Elektronen nach 
der neuen relativistischen Quantendynamik von Dirac. Zeitschrift für Physik, 52, 853–868. 
https://doi.org/10.1007/BF01366453 
11. Boggs, S. E., & Jean, P. (2000). Event reconstruction in high resolution Compton telescopes. 
Astronomy and Astrophysics Supplement Series, 145(2), 311–321. 
12. Zoglauer, A. (2005). First light for the next generation of compton and pair telescopes. 
Technische Universität München. https://mediatum.ub.tum.de/node?id=603105 
13. Zoglauer, A., et al. (2007). Application of neural networks to the identiﬁcation of the compton 
interaction sequence in compton imagers. In G. X. Ritter, M. S. Schmalz, J. Barrera, & 
J. T. Astola (Eds.), Proceedings of SPIE: Mathematics of Data/Image Pattern Recognition, 
Compression, Coding, and Encryption X, with Applications (vol. 6700, pp. 67000I–1–67000I– 
12) 
14. Zoglauer, A., et al. (2021). COSI: From calibrations and observations to all-sky images. 
arXiv:2102.13158. https://arxiv.org/abs/2102.13158 
15. Schonfelder, V., et al. (1993). Instrument description and performance of the imaging gamma-
ray telescope COMPTEL aboard the compton gamma-ray observatory. Astrophysical Journal 
Supplement Series, 86, 657–692. 
16. Kierans, C., et al. (2022). Compton telescopes for gamma-ray astrophysics. arXiv:2208.07819

Germanium Detectors for MeV Gamma-Ray Astrophysics with COSI
247
17. Kierans, C., et al. (2017). The 2016 super pressure balloon ﬂight of the compton spectrometer 
and imager. arXiv:1701.05558. https://ui.adsabs.harvard.edu/abs/2017arXiv170105558K 
18. Tomsick, J., et al. (2019). The compton spectrometer and imager, Astro2020: Decadal 
survey on astronomy and astrophysics, APC white papers, no. 98; Bulletin of the American 
Astronomical Society, vol. 51, Issue 7, id. 98. arXiv:1908.04334. 
19. Sleator, C., et al. (2019). Benchmarking simulations of the compton spectrometer and 
imager with calibrations. Nuclear Instruments and Methods in Physics Research Section A: 
Accelerators, Spectrometers, Detectors and Associated Equipment, 946, 162643, ISSN 0168-
9002. https://doi.org/10.1016/j.nima.2019.162643 
20. Beechert, J., et al. (2022). Calibrations of the compton spectrometer and imager. Nuclear 
Instruments and Methods in Physics Research Section A: Accelerators, Spectrometers, Detec-
tors and Associated Equipment, 1031 (2022). https://doi.org/10.1016/j.nima.2022.166510 
21. Amman, M. (2020). High purity germanium based radiation detectors with segmented 
amorphous semiconductor electrical contacts: Fabrication procedures. arXiv:2006.05471. 
22. Phlips, B. F., et al. (2004). Development and performance of large ﬁne-pitch germanium strip 
detectors. In IEEE Symposium Conference Record Nuclear Science (vol. 4). Piscataway: IEEE. 
https://doi.org/10.1109/NSSMIC.2004.1462679 
23. Bandstra, 
M. 
S. 
(2010). 
Observation 
of 
the 
crab 
nebula 
in 
soft 
gamma 
rays 
with the nuclear compton telescope. Dissertations & Theses at University of Cal-
ifornia; 
ProQuest 
Dissertations 
& 
Theses 
A&I; 
ProQuest 
Dissertations 
& 
Theses 
Global. https://www.proquest.com/dissertations-theses/observation-crab-nebula-soft-gamma-
rays-with/docview/861483974/se-2?accountid=14496 
24. CryoTel 
Cryocoolers 
CryoTel 
CT. 
AMETEK. 
https://www.sunpowerinc.com/products/ 
stirling-cryocoolers/cryotel-cryocoolers/ct 
25. Mitra, P., et al. (2016). Application of spectrum shifting methodology to restore NaI (Tl)-
recorded gamma spectra, shifted due to temperature variations in the environment. Applied 
Radiation and Isotopes, 107, 133–137. 
26. Sleator, C. (2019). Measuring the polarization of compact objects with the compton spectrom-
eter and imager. Dissertations & Theses at University of California; ProQuest Dissertations 
& Theses A&I; ProQuest Dissertations & Theses Global. https://www.proquest.com/docview/ 
2313733159?pq-origsite=gscholar&fromopenview=true 
27. Bowen, J. D., et al. (2007). Depth dependent background measurements with NCT. In IEEE 
Nuclear Science Symposium Conference Record (vol. 1). Piscataway: IEEE (2007). https://doi. 
org/10.1109/NSSMIC.2007.4436364 
28. Lowell, A., et al. (2016). Positional calibrations of the germanium double-sided strip detectors 
for the Compton spectrometer and imager. In High energy, optical, and infrared detectors for 
astronomy VII (vol. 9915). Bellingham: SPIE. https://doi.org/10.1117/12.2233145 
29. Lowell, A. (2017). Polarimetric studies of the long duration gamma-ray burst GRB 160530A 
with the compton spectrometer and imager. Dissertations & Theses at University of California; 
ProQuest Dissertations & Theses A&I; ProQuest Dissertations & Theses Global. https://www. 
proquest.com/docview/2031543342?pq-origsite=gscholar&fromopenview=true 
30. Shockley, W. (1938). Currents to conductors induced by a moving point charge. Journal of 
Applied Physics, 9(10), 635–636. 
31. Kierans, C., et al. (2016). The 2016 super pressure balloon ﬂight of the compton spec-
trometer and imager. In 11th INTEGRAL Conference Gamma-Ray Astrophysics in Multi-
Wavelength Perspective. SAO/NASA Astrophysics Data System. https://ui.adsabs.harvard.edu/ 
abs/2016int..workE..75K 
32. Kierans, C., et al. (2020). Detection of the 511 keV Galactic positron annihilation line with 
COSI. The Astrophysical Journal, 895 44. 
33. Siegert, T., et al. (2020). Imaging the 511 keV positron annihilation sky with COSI. The 
Astrophysical Journal, 897, 45. 
34. Beechert, J., et al. (2022). Measurement of galactic 26Al with the compton spectrometer and 
imager. The Astrophysical Journal, 928 119.

248
J. Beechert et al.
35. Lowell, A., et al. (2017). Polarimetric analysis of the long duration gamma-ray burst GRB 
160530A with the balloon borne compton spectrometer and imager. The Astrophysical Journal, 
848, 119. 
36. Johnson, W. N., et al. (1972). The spectrum of low-energy gamma radiation from the galactic-
center region. The Astrophysical Journal, 172, L1.  
37. Leventhal, M., et al. (1978). Detection of 511 keV positron annihilation radiation from the 
galactic center direction. The Astrophysical Journal, 225, L11. 
38. Jean, P., et al. (2006). Spectral analysis of the Galactic e+ e-annihilation emission. Astronomy 
& Astrophysics, 445, 579. 
39. Weidenspointner, G., et al. (2008). Positron astronomy with SPI/INTEGRAL. New Astronomy 
Reviews, 52(7–10), 454–456. 
40. Churazov, E., et al. (2011). Positron annihilation spectrum from the Galactic Centre region 
observed by SPI/INTEGRAL revisited: Annihilation in a cooling ISM? Monthly Notices of the 
Royal Astronomical Society, 411(3), 1727–1743. 
41. Siegert, T., et al. (2016). Gamma-ray spectroscopy of positron annihilation in the Milky Way. 
Astronomy & Astrophysics, 586, A84. 
42. Siegert, T., et al. (2019). Constraints on positron annihilation kinematics in the inner Galaxy. 
Astronomy & Astrophysics, 627 A126. 
43. Richardson, W. H. (1972). Bayesian-based iterative method of image restoration. Journal of 
the Optical Society of America, 62, 55. 
44. Lucy, L. B. (1974). An iterative technique for the rectiﬁcation of observed distributions. The 
Astronomical Journal, 79, 745. 
45. Bouchet, L., et al. (2010). On the morphology of the electron-positron annihilation emission as 
seen by SPI/INTEGRAL. The Astrophysical Journal, 720 1772. 
46. Skinner, G., et al. (2014). The Galactic distribution of the 511 keV e+/e- annihilation radiation. 
In Proceedings of 10th INTEGRAL Workshop: A Synergistic View of the High-Energy Sky (vol. 
10) 
47. Siegert, T., et al. (2016). Gamma-ray spectroscopy of positron annihilation in the Milky Way. 
Astronomy & Astrophysics, 586, A84. 
48. Knödlseder, J., et al. (2005). The all-sky distribution of 511 keV electron-positron annihilation 
emission. Astronomy & Astrophysics, 441(2), 513–532. 
49. Mahoney, W. A., et al. (1984). HEAO 3 discovery of Al-26 in the interstellar medium. The 
Astrophysical Journal, 286, 578–585. 
50. Plüschke, S. (2001). The COMPTEL 1.809 MeV survey. Exploring the Gamma-Ray Universe, 
459, 55–58. 
51. Siegert, T. (2017). Positron-annihilation spectroscopy throughout the milky way. PhD Dis-
sertation, Technical University of Munich. SAO/NASA Astrophysics Data System. https://ui. 
adsabs.harvard.edu/abs/2017PhDT.......404S/abstract 
52. Krause, M. G., et al. (2015). 26Al kinematics: Superbubbles following the spiral arms? 
Constraints from the statistics of star clusters and HI supershells. Astronomy & Astrophysics, 
578, A113. 
53. Kretschmer, K., et al. (2013). Kinematics of massive star ejecta in the Milky Way as traced by 
26Al. Astronomy & Astrophysics, 559, A99. 
54. Pleintinger, M. M. M. (2020). Star groups and their nucleosynthesis. PhD Dissertation, 
Technical University of Munich. SAO/NASA Astrophysics Data System. https://ui.adsabs. 
harvard.edu/abs/2020PhDT........13P 
55. Bouchet, L., et al. (2015). The Galactic 26Al emission map as revealed by INTEGRAL SPI. 
The Astrophysical Journal, 801, 142. https://doi.org/10.1088/0004-637x/801/2/142 
56. Lei, F., Dean, A. J., & Hills, G. L. (1997). Compton polarimetry in gamma-ray astronomy. 
Space Science Reviews, 82(3), 309–388.

Particle Measurements in Space 
Martin Kroupa, Jonathan Barney, August Gula, Carlos Maldonado, 
Thomas Campbell-Ricketts, and Stuart George 
1 
Introduction 
At the turn of the twentieth century, experimentalists measuring terrestrial radiation 
noticed a violation of expected phenomena. They knew that some minerals found 
in the soil were radioactive, but their expectation was that with increasing distance 
from the radioactivity in the earth’s soil, the rate of radiation detection would drop. 
However, in the summer of 1912, Victor Hess discovered that the radiation measured 
at the sea level is lower than that measured at higher altitudes. With the aid of 
balloons as observation platforms he ascended to 5350 meters with his electroscope 
and measured that radiation environment. At this altitude, he discovered that the 
rate of radiation interactions is over two times the rates he measured at sea level 
[1]. From this discovery, it was concluded that “radiation of very high penetrating 
power enters from above into our atmosphere.” This early work experimentally 
demonstrated that there is radiation outside the atmosphere which bombards the 
Earth constantly. 
However, due to the lack of sufﬁciently sophisticated detectors, Victor Hess’s 
experiment, like many others of the time, could say very little with regard to 
identifying the origin of this radiation. The detection devices used on these early 
M. Kroupa () · J. Barney · A. Gula · C. Maldonado 
Los Alamos National Laboratory, Los Alamos, NM, USA 
e-mail: mkroupa@lanl.gov 
T. Campbell-Ricketts 
Leidos Corporation, Houston, TX, USA 
Space Radiation Analysis Group, NASA, JSC, Houston, TX, USA 
S. George 
Department of Health and Human Performance, University of Houston, Houston, TX, USA 
Space Radiation Analysis Group, NASA, JSC, Houston, TX, USA 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
C. Hansson, K. (Kris) Iniewski (eds.), X-ray Photon Processing Detectors, 
https://doi.org/10.1007/978-3-031-35241-6_11
249

250
M. Kroupa et al.
investigations were incredibly basic and provided simple information such as 
approximate rates, conﬁrmation of radiation hits, and occasionally particle tracks. 
Despite these limitations, some of the ﬁrst hints to the complexity of the radiation 
arriving at the Earth were discovered. 
Early radiation detection devices included nuclear emulsions, which are types of 
photographic plates, that were sensitive to radiation. Once these photographic plates 
were exposed to radiation and developed, they were carefully inspected for particle 
tracks imprinted by impacting radiation [2]. Due to the microscopic scales on which 
these events took place, the analysis of nuclear emulsions was incredibly time 
consuming often requiring many hours or days to perform. Despite this hindrance, 
discoveries of several exotic particles were made. One of the very ﬁrst discoveries 
using this technique was the piπ-meson [3], which was made very early on in high-
altitude investigations. 
Operation of nuclear emulsions for high altitude measurements was quite 
demanding. The sensitive emulsions had to be protected before the ﬂight, carefully 
installed and removed from the balloon after the ﬂight to be processed in the 
laboratories. Because of these technological difﬁculties, an all too familiar set of 
requirements was laid out. Like our modern Size, Weight, and Power-Cost (SWAP-
C) requirements, these early pioneers already understood that “The technical 
problem has three essential requirements: The apparatus must be light in weight, 
low in cost, and it must be reliable in operation” [4]. 
As these high-altitude and balloon experiments continued to be performed, the 
Geiger-Müller (GM) tube became the detector of choice for studying radiation. This 
device, though helpful in understanding rates, is very limited. The GM tubes are 
ﬁlled with a low pressure gas and rely on large voltage gradients between the central 
anode wire and the surrounding cylindrical cathode. When impinging radiation 
interacts with and ionizes the gas in GM tubes, the large voltage gradient causes 
the initial ionization to produce a cascade of electrons throughout the tube. As a 
result, a very clear event is produced. However, because of this electrical cascade, 
the GM tube has a signiﬁcant recovery period, typically around 100 normal muμs. This means 
that after one particle traverses the volume of the detector the device is insensitive 
for those 100 normal muμs and if an other particle arrives during that insensitive period it 
would be missed. Because of this limitation in GM tubes, they are only sensitive to 
radiation rates up to a certain threshold. Above this threshold, the device will under-
report the rate of radiation. It is also worth noting that GM tubes don’t provide any 
information about particle type and energy. 
This under-reporting became a particular point of interest during the early NASA 
missions of Explorer 1 and Explorer 3 (1958) which employed GM tubes as their 
mission payload. During the Explorer 1 mission, a rapid increase of the radiation 
rates was observed above 400 km. However, at 2000 km above South America an 
anomalous behavior was observed in the count rate. Occasionally, the instrument 
would report ˜30 counts/sec, which was below the previously measured trends, or 
zero counts over two minute intervals. This peculiar behavior led the researchers to 
take a spare ﬂight unit of their instrument to an X-ray beam facility. From this study, 
they discovered that the GM tube would report zero counts per second after ˜35000

Particle Measurements in Space
251
X-rays/sec were impinged on the device. This was a result of the high radiation rate 
depleting the GM tube faster than it could recover, thus causing the pulses generated 
to be below the detection threshold of their electronics. Such high levels of radiation 
were perplexing, since the ground and high-altitude measurements of the time being 
performed in South America would have seen ﬂuxes this high. As a result of this 
ﬁnding, the researchers concluded that there was a high radiation area above South 
America. This was the ﬁrst discovery of the radiation belts surrounding the Earth 
and of the South Atlantic Anomaly (SAA) [5]. 
Today we know that the magnetic ﬁeld of the Earth is able to “trap” the charged 
particles, which then traverse along the magnetic ﬁeld lines. The Earth’s trapped 
radiation environment is very energetic and consists of different types of radiation, 
mainly protons and electrons [6–10]. These high radiation areas are called the Van 
Allen belts and are a primary concern for satellites. Earth has two main belts—the 
inner belt, typically between 1000 and 12,000 km in altitude, consists predominantly 
of protons with some electrons, and the outer belt consists mainly of electrons and 
sits between 13,000 and 60,000 km. Due to the magnetic axis of the Earth being 
tilted and also shifted with respect to the rotational axis, the inner belt above South 
America can reach altitudes of 200 km, creating the SAA. 
In addition to the trapped radiation population, a constant stream of Galactic 
Cosmic Rays (GCRs), which consist of all kinds of particles and elements from 
hydrogen to uranium, bombards the Earth. The energy of these GCR particles covers 
many orders of magnitude. We have observed particles ranging from those that can 
be stopped by a thin sheet of paper to the particles with macroscopic energies. The 
record holding “Oh-My-God” particle, which had an energy about 3 times 10 Superscript 203 × 1020 eV, had 
the equivalent energy to a baseball ﬂying at 100 km/h. This energy is about seven 
orders of magnitude higher than the fastest particles we can produce in the most 
potent particle accelerator on Earth, the Large Hadron Collider (LHC). GCR count 
rates are many orders of magnitude lower than the trapped ones. However, it turns 
out that not only the rates but also the composition of the radiation environment is 
important, and we will discuss it later. From radiation protection point of view, the 
energy of the GCR particles prevents effective radiation shielding as it is currently 
not possible to bring enough shielding material to space to block the GCR. 
The last source of the charged particles in the near Earth environment is Solar 
Particle Events (SPEs). These unpredictable events release a massive amount of 
particles (orders of magnitude higher ﬂuxes than GCR) from the Sun and eject 
them into the solar system. The unpredictability and severity of such events causes 
a lot of sleepless nights for the individuals responsible for human space ﬂight. 
Indeed, during the Apollo program, a solar storm occurred during the time between 
the Apollo 16 and Apollo 17 missions (August 1972). Exposure to this harsh 
environment while on the surface of the Moon would have caused signiﬁcant risk 
for Apollo crews. In the case that an SPE were to have occurred, the contingency 
strategy while on the surface of the Moon was to lie down under the lunar module 
with one astronaut on top of the others and to swap positions every 10 minutes. 
An interesting phenomenon was also described by the Apollo 11 crew in the 
middle of the program, in which astronauts reported seeing ﬂashes of light even

252
M. Kroupa et al.
Fig. 1 Landau-Vavilov distribution, which describes the probability of the energy deposition 
for a given particle type and energy in the material. This example represents a high-energy 
(minimum-ionizing) proton. The distribution is asymmetric with a tail toward high energy losses. 
For comparison, real measured data and a Monte-Carlo model for the corresponding detector 
are shown too. There is a slight difference between analytical Landau-Vavilov and Monte-Carlo 
results. Figure taken from [19] 
when their eyes were closed. When other crews were asked, it was conﬁrmed that 
every crew member observed the optical ﬂashes. Thus from Apollo 15, the crews 
had dedicated time slots to investigate this phenomenon. It turned out that the ﬂashes 
are a response of the human visual system to the space radiation [11, 12]. 
Following the Explorer missions it was recognized that the greatest need in 
studying this environment was the ability to separate particle populations. As 
mentioned previously, nuclear emulsions were used to measure and distinguish 
different particles, particularly those with high atomic number [13]. Additionally, 
this technology was quite fragile and required extensive processing at the ground-
based lab. Because of this, an effort to use active detectors together with known 
charged particle stopping power physics [14–18] has been adopted. 
For charged particles penetrating matter, the energy loss inside the material is 
probabilistic. The probability distribution of this energy loss is highly asymmetric 
with a tail toward high energy losses (see Fig. 1). This asymmetry results from the 
fact that as a particle travels through matter, ionizing atoms along the way, it can 
sometimes hit an electron “just right” and give it much more than the mean amount 
of energy. These high-energy electrons, if stopped inside the detector volume, cause 
the high energy deposition tail in the Landau-Vavilov distribution. As one would 
imagine, if we are interested to know what the energy of an interacting charged 
particle was, then we would try to reconstruct the energy using several measured 
energy losses throughout a detector. Due to the statistical nature of the energy loss, 
it is signiﬁcantly better to sample the energy losses of the charged particle in a

Particle Measurements in Space
253
multi-layered detector. By comparing the energy losses in these detector layers to 
the stopping power, a reconstruction of the energy can be derived. 
These multi-layered detectors, or particle telescopes, were the next level of 
advancement employed to understand the high energy particle populations in the 
radiation environments surrounding the Earth. This paradigm-shift in detection 
methodology allowed for the collection of both low and high energy GCR particles 
while efﬁciently separating light and heavy charged particle populations. Despite 
many of these early technical advancements being a part of the space race between 
the USSR and USA [20], some were for purely scientiﬁc purposes. Highlights 
leading up to the present time were the missions of the International Sun-Earth 
Explorer (ISEE) [21], the EXOspheric Satellite-C (EXOS-C/OHZORA) [22], the 
Solar Anomalous and Magnetospheric Particle Explorer (SAMPEX) [23], and the 
Combined Release and Radiation Effects Satellite (CRRES) [24]. 
The ﬁrst of these missions, the ISEE missions, was one of the ﬁrst examples of 
a long-term multi-satellite and multi-experiment missions [21]. The lessons learned 
from the multitude of prior Explorer missions in the 1960s and 1970s were applied 
to the ISEE-1, negative 2−2, and negative 3−3 satellites. These insights, particularly in the choice 
of instruments aboard, led to the variety of instruments aboard these satellites 
being quite diverse. Experiments ranged from electromagnetic ﬁeld measurements 
to charged particle detectors and ion spectrometers. 
Though there were signiﬁcant technological advancements in implementing 
particle telescopes, there were also drawbacks. At the time, in order to perform 
energy measurements over a wide range of energies, multiple solid-state detector 
telescopes were required [25, 26]. With such a large energy range to cover, one 
such telescope existed for just the low to medium energies, the Very Low Energy 
Telescope (VLET). This telescope itself was made up of four detectors along with 
its own shielding and electronics to cover only the 2–8 MeV/nucleon energy region. 
There were additional telescopes aboard for low, medium, and high energies [21]. 
For missions seeking to have low SWAP-C, this kind of specialization in devices 
presents a problem. 
Compounding the SWAP-C problem is cost: a large investment is required to 
produce these satellite observatories. That is why, as missions continued to be 
developed and technological advancements occurred, a miniaturization of electron-
ics and technology has been a boon to space research. As technology continued 
to improve, the volume and mass of these payloads continued to decrease, and 
more compact designs were made. However, despite this miniaturization, the 
fundamental principle remained: a multi-layered device must be used to separate 
particle energies, species, and trajectories. In the case of the Small Explorer missions 
for low cost spacecraft, the SAMPEX spacecraft is one such beneﬁciary of these 
advancements while retaining scientiﬁc potency. 
Though the number of instruments aboard SAMPEX pales in comparison to 
ISEE, the science did not. SAMPEX lasted a year longer than ISEE-1 and the energy 
range of its four instruments covered an appreciable almost equals≈0.4–almost equals≈300 MeV/nucleon 
compared to the energy range almost equals≈1–almost equals≈500 MeV/nucleon of ISEE with its telescope 
instruments. Though the energy range had decreased, so did the mass of SAMPEX.

254
M. Kroupa et al.
SAMPEX measured around 158 kg, which is signiﬁcantly smaller SWAP-C com-
pared to ISEE-1 with a weight of 340 kg. With every gram to orbit having a large 
cost associated with it, these advances in technology miniaturization have proven to 
pay great dividends. 
2 
Challenges of Using Particle Telescopes 
As described above, particle telescopes effectively sample the stopping power of 
charged particle radiation and allow for the reconstruction of the particle’s kinetic 
energy. In order to perform this reconstruction, the impinging radiation typically 
needs to travel close to the axis through the layers of the telescope. In space, 
however, these particles can originate from all directions and potentially miss 
several of the telescope layers. A particularly frequent and troublesome case of 
this occurs when a high energy particle penetrates the shielding surrounding the 
telescope and interacts with a single layer as it passes through. For cases such as 
this—where a background signal is generated in an arbitrary layer—these events 
can overwhelm, undermine, and obfuscate the energy reconstruction process. 
Over many years of use and development, several different strategies have been 
produced to combat such issues with particle telescopes. The simplest solution is 
the implementation of collimation. By limiting the ﬁeld of view to angles very 
near coaxial with the telescope, not only can lower ﬂuxes be obtained but the low 
energy background can be drastically suppressed (as discussed above, background 
are the events which are not of interest, but still are being processed by detectors 
and their electronics). The use of a collimator, however, typically adds signiﬁcant 
size and weight to a particle telescope in addition to the collimation effectiveness 
being limited by the energy range of interest. For particles with high kinetic energy, 
it is impossible to create a robust enough collimator within reasonable size and 
weight constraints. For example, 10 MeV protons have range of about 700 normal muμm 
inside silicon, 100 MeV protons have a range of about 40 mm, and for 1000 MeV 
protons it is about 1.7 m. 
For cases where high energy particles are of interest and collimation would 
become cumbersome, hardware or software solutions are often implemented. In 
these cases, one can require that only the events depositing energies in all telescope 
layers will be assessed and recorded. A recent example of such an approach 
was implemented on the Van Allen Probes high energy telescope named the 
Relativistic Proton Spectrometer (RPS) [27]. Another option in such regimes of 
interest is to determine if the particle entered the telescope at an angle by including 
an anticoincidence layer on the sides of the telescope. If a particle hits this 
anticoincidence detector, then the event is discarded. This was the approach used 
by the Radiation Assessment Detector (RAD) on the Mars Science Laboratory [28], 
which we know colloquially today as the Curiosity mission (although in this case the 
anticoincidence was used for separation of the charged particle and neutron signal).

Particle Measurements in Space
255
Fig. 2 The stopping power, or mean Linear Energy Transfer (LET), for a selection of nuclei, as 
a function of energy per nucleon of the projectile. These values were calculated using the Bethe 
formula. For H, He, and C, the spread of observed energy depositions around the mean LET is 
indicated at 100, 400, and 800 MeV/nuc, by overlaying the relevant Landau-Vavilov distributions. 
The overlap between these Landau-Vavilov curves, for example for hydrogen at 400 and 800 
MeV/nuc, illustrates the difﬁculty in using a single LET measurement to infer particle energy 
An unfortunate limitation of charged particle telescopes comes in the scientiﬁc 
reality that for very fast particles the stopping power does not vary signiﬁcantly 
over a wide range of high energies. The Bethe-Bloch formula, which describes 
the stopping power of charged particles as a function of the particle energy, has 
a minimum around 2.5 GeV per nucleon (Fig. 2). 
Charged particles near this energy will deposit, on average, the smallest energy 
possible inside a detector. These particles are called Minimum Ionizing Particles, 
or MIPs for short. Additionally, the difference between the stopping power of a 1, 
2.5, and 10 GeV particle is rather small. Because of this, it is typically impossible to 
assess the energy of such particles using just a sampling of the stopping power. 
Therefore, additional physical processes need to be taken into account if this 
high energy region is to be distinguished. For very fast-moving particles, such as 
these, the traversing particle will create light as it penetrates through a material. 
This light is called Cherenkov radiation and can be detected with photo-sensitive 
materials, allowing for additional information on these MIPs. Such considerations 
were implemented on the RPS, which used a Cherenkov detector in its design [27]. 
Alternative telescope designs have been used to measure this energy region. An 
extreme example is the Alpha Magnetic Spectrometer (AMS) experiment operating 
on the International Space State (ISS) [29]. The most recent version, AMS-2, is 
a several billion dollar and over 6500 kg instrument ﬂying on the ISS [30]. This

256
M. Kroupa et al.
device utilizes strong magnetic ﬁelds to distinguish particle energies, because the 
bending of the trajectory of the charged particles in the magnetic ﬁeld is a function 
of the kinetic energy via the Lorentz Force. By measuring the ﬁnal position of these 
charged particles inside the AMS-2, very high energy particles can be distinguished 
from each other. 
There has been a growing interest in the space physics community for satellite 
constellations missions to enable multi-point observations capable of resolving 
temporal and spatial science investigations [31, 32]. This new wave of mission 
concepts has been fueled by the current era of rapidly expanding CubeSat launch 
opportunities and the increased demand for low-resource instruments capable of 
making relevant science observations. This interest, combined with advances in 
sensor and other spacecraft technologies, has enabled the rapid increase in the 
number of miniaturized charged particle detectors with ﬂight heritage. 
The Relativistic Electron and Proton Telescope integrated little experiment 
(REPTile) on board the Colorado Student Space Weather Experiment (CSSWE) 
CubeSat mission was one of the ﬁrst missions to demonstrate the ability of CubeSats 
and miniaturized instruments to produce high quality science returns [33]. The 
instrument design was based on the Van Allen Probes Relativistic Electron and 
Proton Telescope (REPT) [34] and consisted of four solid state detectors encased 
in aluminum and tungsten shielding. Similarly, the Miniaturized Electron pRoton 
Telescope (MERiT), a 1U device consisting of a stack of solid-state detectors 
behind space facing avalanche diodes, was ﬂown in a low polar Earth orbit to 
investigate electron microbursts and to study solar particles [35]. Embracing the 
design paradigm of “faster, cheaper, better” [36] the Falcon Solid State Energetic 
Electron Detector (SEED) pushed the bounds of low-resource instrumentation by 
demonstrating the ability of a single element telescope consisting of Commercial 
Off The Shelf components to successfully operate in GEO for one year [37]. The 
SEED experiment also demonstrated the ability of a low resource charged particle 
telescope to provide comparable measurements to state-of-the-art payloads [38]. 
These modern CubeSat missions, hosting next generation miniaturize charged 
particle telescopes, are now targeting more ambitious missions with the promise 
of signiﬁcant science returns. Among these are two CubeSat missions, the Geo-
stationary transfer orbit Satellite (GTOSat) [39] and the Experiment for Space 
Radiation Analysis (ESRA) [40–43], that will for the ﬁrst time, attempt to operate 
through GTO providing observations of proton and electron energy resolved rates. 
The ESRA mission will utilize a ﬁve-element detector stack consisting of Si 
detectors of varying thickness and a photodiode [44, 45]. The GTOSat will host the 
Relativistic Electron Magnetic Spectrometer (REMS), a miniaturized version of the 
MagEIS-Medium instrument onboard NASA’s Van Allen Probes to measure high 
energy electrons [9], and the micro Charged Particle Telescope (normal muμCPT) to measure 
energetic proton populations [46]. The GTO environment is extremely stressing 
and hazardous for satellites since they cross both the inner and outer Van Allen 
radiation belts multiple times each day. Additionally, the success and subsequent 
ﬂight heritage of the ﬁrst MERiT mission enabled the instrument to be manifested 
as a science payload on the CubeSat Mission to Study Solar Particles (CuSP) which 
was launched in a heliocentric Earth-escape orbit [47].

Particle Measurements in Space
257
3 
Crew Dosimetry 
Since the early NASA days it was clear that radiation monitoring will be an 
important part of all crewed missions. Quantifying the impact of the radiation to 
the human body is a complicated subject which is even more convoluted by the 
fact that radiation environment in space is so different than that on the surface 
of the Earth. Traditionally the impact of the radiation to the body was measured 
using dose, which is the quantity representing the energy deposited to the mass. 
However, it turned out that impact of different types of radiation is different, and 
measuring just the dose is not enough. Hence the so called quality factors and 
dose equivalent were introduced. Quality factors are trying to weight the impact 
of different types of radiation to the body, however the weighting is coarse. To 
measure dose and dose equivalent different detector technologies have been used, 
ranging from passive Thermoluminescent dosimeters (TLDs) to Tissue Equivalent 
Proportional Counters (TEPCs). Progress in biomedical physics produced better 
understanding of the differing impacts of radiation on the human body, allowing 
NASA to abandon dose and dose equivalent paradigm to introduce the new Risk 
Assessment model [48, 49]. For this model, the ﬂuxes of different particles are 
required as an input. In other words it is not enough to know how much dose was 
absorbed, but it is required also to discern what type of radiation is present. This in 
fact means that particle telescopes should be utilized. The Space Radiation Analysis 
Group (SRAG) at NASA Johnson Space Center (JSC), which is responsible for crew 
safety from mission exposure to radiation, consequently started to work on the next 
generation radiation monitors for their future crewed missions in the early 2010s. 
The requirement for the next generation radiation monitors was to be compact, 
but able to provide more information than traditional TLDs and TEPCs. From the 
explored detection technologies the pixel detector technology has been selected. 
In the last decade, NASA invested heavily in this technology and utilized it for 
radiation monitoring during crewed missions [50]. In fact, Timepix which is the 
detector to use became the state-of-the-art technology for radiation monitoring 
during crewed missions (all NASA Artemis missions are scheduled to use this 
technology). Twenty-three Timepix detectors have been used in seven different 
NASA missions in the last decade. Further utilization in four missions in the near 
future is also planned. 
4 
Pixel Detectors 
Recent developments in electronics have allowed for the continued signiﬁcant 
miniaturization of devices. The development of dedicated Application-Speciﬁc 
Integrated Circuits (ASICs) based on Complementary Metal-Oxide Semiconductor 
(CMOS) technology has enabled the creation of many of these miniaturized devices. 
An example of these miniaturized devices are pixel arrays with dedicated Front End

258
M. Kroupa et al.
Electronics (FEE) in each pixel. A signiﬁcant result of these developments is that 
the output of such devices can be purely digital, simplifying the data processing 
pipeline. 
An example of these pixel arrays is the Timepix detector [51], which originated 
from the Medipix collaboration based in CERN [52]. The Timepix device is a hybrid 
pixel detector. Hybrid technology allows for the separation of the read-out ASIC and 
the active volume sensor. These two media are bump-bonded together via ﬂip-chip 
technology. The beneﬁt of using this hybrid technology is that the sensor can be 
a different material to the ASIC, which allows the sensor material to be optimized 
for a given application. Thus, Timepix detectors have been used with a variety of 
sensors made of different thicknesses or materials ranging from Si, CdTe, GaAs, 
and even gas chambers [53–55]. 
Since the Timepix detector is a fully digital device, it possesses many advantages 
in its use. One can look at the Timepix as a digital camera for radiation, taking 
snapshots of the environment, referred to as frames, over adjustable frame acquisi-
tion times. Adjusting the acquisition time thus allows operation in the wide variety 
of environments. In each frame the interacting particles create electron-hole pairs 
in the active detector volume. These are collected by an applied bias voltage and 
processed by the read-out ASIC. Only signals above a certain energy threshold in 
the pixel are processed and digitized, allowing for the elimination of dark current 
from the device. Because of this, the detector can be operated for “inﬁnite” time and 
the counters will be increased only when the radiation hits the pixel volume. This 
makes the usage of these detectors for particle detection very easy as there is no need 
of any background subtraction. If those pixel detectors are used for X-ray imaging 
, this allows for a continuously improving signal to noise ratio. As a result of this 
advantage, Timepix detectors are widely used in micro-tomography applications 
and for exploring new imaging modalities such as phase contrast imaging [56]. 
There are several different modes that each pixel can be operated in. The most 
basic one is the counting mode, in which the device counts how many particles were 
above the threshold during the acquisition. As the digital shutter opens, the counters 
in each pixel are increased when the signal crosses the pixel threshold. This mode 
is typically used for imaging, there is no energy information in this mode.1 The 
most common mode for space applications is Time Over Threshold (TOT). This 
mode allows for the measurement of the length of the signal above the threshold. As 
soon as the signal crosses the threshold the pixel counter starts adding clock ticks 
until the signal crosses below threshold. Timepix can operate at different internal 
clocks, but typically the 10 MHz clock is used. The set of internal Digital to Analog 
Converters (DACs) allows optimizing the analogue circuit shaping [57]. The length 
of the analogue signal can be thousands of clocks or hundreds of microseconds. 
It can be shown that this length is proportional to the energy deposited. Timepix, 
therefore, with its 256 times 256256 × 256 pixel array, provides measurements from over sixty-
ﬁve thousand multichannel analyzers simultaneously [58]. However, in order to
1 With exception on the low energy limit given by the threshold. 

Particle Measurements in Space
259
have good measurements, at most one particle should hit each pixel during the 
acquisition time, as the signal from all particles will be summed when the shutter is 
opened. Operating Timepix detectors in space thus requires automatic adjustment 
of the length of the measurement, where the occupation of the detector matrix 
is evaluated, and the shutter time is adjusted accordingly. To avoid overlap of 
clusters we typically aim at the maximum occupancy (active pixels) of 2%. On ISS, 
frames with acquisition time of 4 s typically have much less than 2% occupancy. 
However, when the ISS crosses the SAA the acquisition time has to be shortened in 
order to keep occupancy low. Thus, during the SAA crossing the acquisition time 
typically settles around a couple hundred milliseconds. When on Orion vehicle and 
crossing the Van Allen belt, acquisition times of millisecond length were observed. 
The shortest acquisition time which still provides reliable data is in fact in the 
milliseconds. If the acquisition time would be shorter there is a high chance that 
the signal from particle would be clipped by the end of the shutter window and 
energy measurement would not be correct. 
Originally these detectors were designed for X-ray imaging with their FEE being 
optimized for energy depositions in tens of keV. Signiﬁcant efforts were made 
recently to push the calibration of these devices into the MeV range [19]. From 
these efforts, it was discovered that this task is not as simple as ﬁrst envisioned. The 
electronics are overwhelmed by the large signals originating from charge particles 
and the preampliﬁers are saturated by this signal. As the signal returns from this 
saturation, an extra fake signal is produced and causes the energy calibration to be 
non-linear. The so-called “advanced calibration method” was invented and allowed 
for compensation of this fake signal [19]. This method allowed for the calibration 
to be extended up to about 2 MeV. For higher energy depositions the signal is 
affected by the so-called “volcano effect” where a portion of the signal is lost due 
to the saturation time being longer than the measuring time [59]. Such high energy 
depositions almost invariably lead to signals in neighboring pixels, the analysis of 
which was shown to allow the total deposited energy to be reconstructed and the 
calibration extended up to 8 MeV per pixel. Because of this, the Timepix detector 
can be used for cosmic ray particles up to iron and thus enables the practical 
measurement of all particle species of interest to NASA crewed missions. 
4.1 
Pixel Data Analysis 
Because of the highly pixelated nature of Timepix detectors, they can provide 
signiﬁcant advantages in charged particle measurements. Speciﬁcally, the Timepix 
detector mimics a Wilson cloud chamber in solid state, allowing for analysis of the 
tracks of interacting charged particles. 
Common use of Timepix detectors led to development of a data analysis toolkit 
by NASA which allows for the identiﬁcation of all independent particle tracks in 
the detector. We will call these analyzed tracks “clusters” in this chapter. Using 
image processing techniques, several properties of each cluster can be identiﬁed,

260
M. Kroupa et al.
such as the entry angle. Combining this with the known thickness of the sensor 
and the assumption that the particle fully penetrated the sensor, one can estimate 
the particle track length inside the detector [60]. Using this information, together 
with the measurement of the energy deposition, one can then assess the energy lost 
per unit length or dE/dx. This measurement is crucial for particle identiﬁcation and 
energy reconstruction. 
A ﬁrst demonstration mission of the commercially available instruments based 
on the Timepix detector started in 2012 when 5 Radiation Environment Monitors 
(REMs) were deployed to the International Space Station (ISS). This was highly 
successful and showed viability of these detectors for the desired purpose. In the 
next ten years Timepix based detectors were part of 7 missions with a total of 
23 detectors being deployed. At the same time NASA started developing its own 
devices using Timepix detectors. This effort resulted in the Hybrid Electronic 
Radiation Assessor (HERA) which is the radiation monitor for the NASA Orion 
vehicle and recently ﬂew aboard of the Artemis I mission around the Moon. 
Because the data these detectors provide can yield such crucial information, 
Timepix based devices can provide a wealth of highly valuable scientiﬁc results 
as well as interesting surprises. During the inaugural NASA Orion vehicle ﬂight, 
called EFT-1, the Battery-operated Independent Radiation Detector (BIRD) was the 
only scientiﬁc payload on board. This payload was based on Timepix technology. 
During the highly eccentric trajectory of EFT-1, two crossings of the Van-Allen belts 
occurred. When the BIRD data were analyzed, it was discovered that during parts 
of the trajectory there was a large increase in low energy photons with a speciﬁc 
energy of 25 keV. Following further investigations, those photons were shown to 
be a tertiary effect of detection. While Orion crossed the electron belts, signiﬁcant 
Bremsstrahlung was created in the walls of the vehicle. Bremsstrahlung photons 
irradiated the Timepix detector and hit the bump-bonds. These bump-bonds are 
made of tin, which has an X-ray ﬂuorescence line of 25.27 keV. It was later shown 
that a similar signal is measured on the ISS as well, and undergoes enhancement as 
geomagnetic storms occur. In a very unexpected way, it was shown that a detector 
inside the crew vehicle can provide information about outside environment which is 
unable to penetrate the vehicle’s walls. 
Another interesting discovery was the recording of pion showers [61]. Some 
frames from ISS showed very signiﬁcant events with thousands of particles in 
one frame and basically none in the one before and after the event (see Fig. 3). 
This means that the event was very narrow in time. The clusters in the frame also 
showed directional correlation, looking like jet events from high energy physics. It 
is assumed that these events are the result of interactions between very high energy 
particles (often in excess of 1 TeV) and the mass of the ISS or detector, creating 
hadronic showers. These events are so potent that up to 1 GeV can be deposited 
inside the volume of the detector. The observation opens the question about the 
impact of these super high energy events to the ﬁeld of dosimetry. The main concept 
of dosimetry is that the dose deposited in the detector and body would be the same. 
However in the case of showers which develop in the matter this requirement might 
not be satisﬁed. In other words, the shower, while traveling through human body,

Particle Measurements in Space
261
Fig. 3 Time evolution of a typical shower event. The observed temporal pattern, together with the 
highly aligned nature of the tracks conﬁrm this as a shower event, originating at a single point 
somewhere in the vehicle. (a) Frame before the event. (b) Frame of the event. (c) Frame after the  
event 
would evolve more, creating more particles and depositing more energy than it 
would in the smaller volume of the detector. The extreme situation would be when 
the shower is started inside the human body, thus the measured dose from radiation 
monitor and dose deposited to the human body would be completely uncorrelated. 
4.2 
Single Layer Particle Telescope 
NASA’s experience with Timepix for particle spectroscopy, as part of its space-
based dosimetry effort, has led to a realization that an array of pixels represents a 
generalization of the particle telescope concept, both extended to two dimensions, 
and achieved in highly miniaturized form. Thus, noting the 55 normal mu mμm pixel pitch 
characteristic of the Timepix, a penetrating particle incident, for example, at 60Superscript ring◦to 
the surface normal of a 500 normal mu mμm thick sensor will traverse almost 20 pixels, each of 
which can be considered a virtual telescope layer. For this reason, we will sometimes 
refer to our pixel detectors as single layer particle telescopes. [62] The advantage of 
this approach is not only the size of the whole detector, but also the fact that whole 
energy deposition is known and recorded. There are no insensitive material or dead 
layers in between telescope layers as the layers are just virtual parts of the same 
pixelated silicon. 
As noted, particle telescopes were devised to overcome the highly stochastic 
mapping from kinetic energy to dE/dx. By taking several samples of the latter, a 
better estimate of the former can be obtained. For many spectroscopic applications 
involving pixel detectors, the amounts of energy deposited in each pixel along 
a particle track can be considered to be very nearly independent, in which case 
this desire for multiple dE/dx samples is easily met. A maximum-likelihood 
approach, making use of this multi-pixel information has been demonstrated to give 
signiﬁcantly better kinetic energy reconstruction than simply using a single dE/dx

262
M. Kroupa et al.
measurement for the whole cluster [62]. The longer the cluster is, the more pixels 
are involved, and more virtual telescope layers can be used. If the particle entry 
angle to the sensor volume is the normal to the surface of the sensor, the sampling is 
not possible, and we obtain just one virtual telescope layer. For good performance of 
the method an entry angle of the particle larger than 60Superscript ring◦with respect to the normal 
of the surface is desirable. The ﬁeld of view of such telescope is then a donut-shaped 
structure, opposite to the typical cone ﬁeld of view known from regular telescopes. 
Thanks to pixelization, the Timepix detector can be used to reconstruct kinetic 
energy of the particles in relatively broad range. Data published in [62] showed  
very good reconstruction capability up to 400 MeV protons. For higher energies, 
the energy resolution of the device and the characteristic of the energy loss are a 
limiting factor, but it was shown that these data can be still used for a good integral 
measurement. 
This approach applies broadly for different particle species and thus not only 
energy but also particle type can be evaluated. The method was tested on the protons, 
alpha particles, CNO group and high Z (iron like) particles. 
The single layer telescope concept also offers great utility in cases where dE/dx is 
varying systematically along the track, i.e. when a particle slows down appreciably 
within the detector. In such cases, it has been found that rather than needing to 
examine each pixel individually, much of the information content is captured in the 
energy deposited at either end of a long track. The high resolution of this technique, 
relative to other telescope devices, stems from the high pixel density in the Timepix, 
coupled with our ability to select subcluster elements larger than the individual 
pixel. From geometric analysis of the pixel pattern in a cluster, we have an excellent 
estimate of the track angle, making it possible with long tracks to select just the 
right number of pixels in each subcluster to provide a uniform subcluster length. 
This contrasts with many other particle telescopes, where the path length in each 
detector element varies over the opening angle of the device, and one is forced to 
apply some mean chord length in order to go from upper Delta upper EE to dE/dx. 
The strength of this method was highlighted when the analysis of Timepix data 
from ISS allowed identiﬁcation of the proton isotopes with resolution unprecedented 
for a device of this compactness [63]. In this work we focused on stopping particles, 
i.e. particles that do not penetrate fully the detector volume. When a particle slows 
downs and stops in the detector it deposits more energy per unit length at the end 
of its track. This terminal spike in deposited energy is called the Bragg peak and is 
always the same for the given particle type [18]. Segmenting a cluster to provide two 
parts of ﬁxed length at the beginning and end of the track, one can search for these 
tell-tale Bragg energies. When any of these energies is found, one can conﬁdently 
identify the particle species. Thus, we were able to discriminate different isotopes of 
hydrogen, namely protons, deuterons, and tritons. Results from [63] are summarized 
in the Fig. 4. 
Different areas in the Fig. 4 can be discussed. Areas on the d upper E divided by d x 1 equals d upper E divided by d x 2dE/dx1 = dE/dx2
line corresponds to the particles where the stopping power didn’t change dramati-
cally while going through the material of the sensor. Namely Area A corresponds 
to minimum ionizing particle (MIP) of protons. We can observe broadening

Particle Measurements in Space
263
Fig. 4 dE/dx vs dE/dx plot from single Timepix device. Data taken onboard the ISS, ﬁgure taken 
from [63] 
about the line d upper E divided by d x 1 equals d upper E divided by d x 2dE/dx1 = dE/dx2 which is caused by statistical ﬂuctuations 
in energy deposition for penetrating charged particles as discussed above (see 
Fig. 1). Similarly Area B corresponds mainly to MIP helium ions (there would be a 
contamination of the slow protons which have same stopping power as fast helium 
ions). Slowing down of the particles can be seen in Area C where two branches 
diverge from the d upper E divided by d x 1 equals d upper E divided by d x 2dE/dx1 = dE/dx2 line. Areas D, E, F, and G are including 
particles which signiﬁcantly slowed down in the sensor material and are stopping 
inside the detector. It was shown that these areas correspond to different isotopes 
of hydrogen (Areas D, E, F are for protons, deuterons and tritons respectively) and 
helium (Area G). 
Observation of features corresponding to three hydrogen isotopes in a single 
layer is the result of a level of track-length resolution not possible with a single, 
monolithic sensor of the type used in traditional particle telescopes. This ability to 
identify stopping particles using subcluster analysis also improves the measurement 
of linear energy transfer (LET), which is a common quantity measured for particles. 
With monolithic detector elements, in order to measure LET, one is typically 
forced to assume that the particle penetrates the whole detector volume, in order 
to calculate upper Delta xx. For stopping particles, this assumption is clearly violated, and 
the path length within the sensor is uncertain. Utilizing whole-cluster LET analysis

264
M. Kroupa et al.
with a 300 mu mμm thick sensor on a Timepix, for example, it was shown that stopping 
particles create an artiﬁcial peak at around 10 k e upper V divided by mu mkeV/μm in the LET spectrum [64]. 
By identifying stoppers and removing them from the LET spectra it was shown 
that the LET peaks from minimum ionizing ions of the CNO (Carbon, Nitrogen, 
Oxygen) group can be resolved [63]. 
5 
Summary 
The journey for the development of the smallest possible particle detectors took 
a fast pace over last decade. As shown by the success of the Timepix detector 
technology, miniaturized devices the size of an index ﬁnger can provide rich 
quantitative and qualitative information. The importance of this technology was 
recently highlighted, with the HERA radiation monitors aboard of the Orion vehicle 
ﬂying around the Moon.2 The future of space exploration is bright and exciting. The 
push for new technologies will continue, and we eagerly anticipate learning what the 
next chapter in space radiation measurements will bring. 
References 
1. Angelo, J. (2004). Nuclear Technology (Sourcebooks in modern technology). Westport: Green-
wood Press. ISBN: 9781573563369. https://books.google.com/books?id=ITfaP-xY3LsC. 
2. Walter, M., & Wolfendale, A. W. (2012). Early history of cosmic particle physics. The 
European Physical Journal H, 37(3), 323–358. 
3. Lattes, C. M. G., Muirhead, H., Occhialini, G. P. S., & Powell, C. F. (1947). Processes 
involving charged mesons. Nature, 159(4047), 694–697. ISSN: 1476–4687. https://doi.org/10. 
1038/159694a0 
4. Johnson, T. H. (1937). Radio balloon-measurements of the cosmic radiation. Eos, Transactions 
American Geophysical Union, 18(1), 150–151. https://doi.org/10.1029/TR018i001p00150-2. 
https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/TR018i001p00150-2 
5. Van Allen, J. A., Ludwig, G. H., Ray, E. C., & McIlwain, C. E. (1958). Observation of high 
intensity radiation by satellites 1958 alpha and gamma. Journal of Jet Propulsion, 28(9), 588– 
592. https://doi.org/10.2514/8.7396 
6. Rossi, B. (1964). Cosmic rays. New York: McGraw-Hill. 
7. Badhwar, G. & O’Neill, P. (1996). Galactic cosmic radiation model and its applications. 
Advances in Space Research, 17(2), 7–17. Proceedings of the Meetings F2.6 and F2.7 of 
COSPAR Scientiﬁc Commission F which was held during the Thirtieth COSPAR Scientiﬁc 
Assembly. ISSN: 0273-1177. http://dx.doi.org/10.1016/0273-1177(95)00507-B. http://www. 
sciencedirect.com/science/article/pii/027311779500507B 
8. Bourdarie, S., & Xapsos, M. (2008). The near-earth space radiation environment. IEEE 
Transactions on Nuclear Science, 55(4), 1810–1832. ISSN: 0018-9499. https://doi.org/10.1109/ 
TNS.2008.2001409
2 On Artemis I mission November 2022. 

Particle Measurements in Space
265
9. Simpson, J. A. (1983). Elemental and isotopic composition of the galactic cosmic rays. Annual 
Review of Nuclear and Particle Science, 33(1), 323–382. https://doi.org/10.1146/annurev.ns. 
33.120183.001543 
10. Shea, M. A., & Smart, D. F. (1990). A summary of major solar proton events. Solar Physics, 
127(2), 297–320. ISSN: 1573-093X. https://doi.org/10.1007/BF00152170 
11. Budinger, T., Tobias, C., Lyman, J., Chapman, P., Pinsky, L., Bichsel, H., Denney, J., Nelp, J. 
(1971). Light ﬂash phenomenon seen by astronauts. Lawrence Berkeley National Laboratory. 
LBNL Report #: LBL-31. Retrieved from https://escholarship.org/uc/item/0gx3f6cq 
12. McNulty, P. J., Pease, V. P., Pinsky, L. S., Bond, V. P., Schimmerling, W., & Vosburgh, K. G. 
(1972). Visual sensations induced by relativistic nitrogen nuclei. Science, 178(4057), 160– 
162. https://doi.org/10.1126/science.178.4057.160. https://www.science.org/doi/pdf/10.1126/ 
science.178.4057.160 
13. Shirk, E. E., Price, P. B., Kobetich, E. J., Osborne, W. Z., Pinsky, L. S., Eandi, R. D., & Rushing, 
R. B. (1973). Charge and energy spectra of transiron cosmic rays. Physical Review D, 7, 3220– 
3233. https://link.aps.org/doi/10.1103/PhysRevD.7.3220 
14. Bethe, H., Heitler, W., & Dirac, P. A. M. (1934). On the stopping of fast particles and on the 
creation of positive electrons. Proceedings of the Royal Society of London. Series A, Containing 
Papers of a Mathematical and Physical Character, 146(856), 83–112. https://doi.org/10.1098/ 
rspa.1934.0140. https://royalsocietypublishing.org/doi/abs/10.1098/rspa.1934.0140 
15. Landau, L. D. (1944). On the energy loss of fast particles by ionization. Journal of Physics, 
8(4), 201–205. https://cds.cern.ch/record/216256 
16. Vavilov, P. V. (1957). Ionization losses of high-energy heavy particles. Soviet Physics Journal 
of Experimental and Theoretical Physics, 5, 749–751. https://www.osti.gov/biblio/4311507 
17. Lindhard, J., & So/rensen, A. H. (1996). Relativistic theory of stopping for heavy ions. Physical 
Review A, 53, 2443–2456. https://doi.org/10.1103/PhysRevA.53.2443. https://link.aps.org/doi/ 
10.1103/PhysRevA.53.2443 
18. Bragg, W. H., & Kleeman, R. (1905). XXXIX. On the α particles of radium, and their loss of 
range in passing through various atoms and molecules. The London, Edinburgh, and Dublin 
Philosophical Magazine and Journal of Science, 10(57), 318–340. https://doi.org/10.1080/ 
14786440509463378 
19. Kroupa, M., Campbell-Ricketts, T., Bahadori, A., & Empl, A. (2017). Techniques for precise 
energy calibration of particle pixel detectors. Review of Scientiﬁc Instruments, 88(3), 033301. 
http://dx.doi.org/10.1063/1.4978281 
20. Siddiqi, A. A. (2018). Beyond earth: A chronicle of deep space exploration, 1958–2016. In 
National aeronautics and space administration (pp. 1958–2016). NASA History Division. 
21. Ogilvie, K. W., von Rosenvinge, T., & Durney, A. C. (1977). International sunearth explorer: A 
three-spacecraft program. Science, 198(4313), 131–138. https://doi.org/10.1126/science.198. 
4313.131. https://www.science.org/doi/abs/10.1126/science.198.4313.131 
22. NASA. (2022). Ohzora. https://nssdc.gsfc.nasa.gov/nmc/spacecraft/display.action?id=1984-
015A 
23. Baker, D. N., Mason, G. M., Figueroa, O., Colon, G., Watzin, J. G., & Aleman, R. M. (1993). 
An overview of the solar anomalous, and magnetospheric particle explorer (sampex) mission. 
IEEE Transactions on Geoscience and Remote Sensing, 31(3), 531–541. 
24. Gussenhoven, M., & Mullen, E. (1993). Space radiation effects program: An overview. IEEE 
Transactions on Nuclear Science, 40(2), 221–227. 
25. Greiner, D. E., Bieser, F. S., & Heckman, H. H. (1978). ISEE-C HKH high energy cosmic rays. 
IEEE Transactions on Geoscience Electronics, 16(3), 163–165. https://doi.org/10.1109/TGE. 
1978.294539 
26. Von Rosenvinge, T. T., McDonald, F. B., Trainor, J. H., Van Hollebeke, M. A. I., & Fisk, 
L. A. (1978). The medium energy cosmic ray experiment for ISEE-C. IEEE Transactions on 
Geoscience Electronics, 16(3), 208–212. https://doi.org/10.1109/TGE.1978.294548 
27. Mazur, J., Friesen, L., Lin, A., Mabry, D., Katz, N., Dotan, Y., George, J., Blake, J., Looper, 
M., Redding, M., et al. (2012). The relativistic proton spectrometer (RPS) for the radiation belt 
storm probes mission. In The Van Allen probes mission (pp. 221–261). Berlin: Springer.

266
M. Kroupa et al.
28. Hassler, D. M., Zeitlin, C., Wimmer-Schweingruber, R., Böttcher, S., Martin, C., Andrews, 
J., Böhm, E., Brinza, D., Bullock, M., Burmeister, S., et al. (2012). The radiation assessment 
detector (rad) investigation. Space Science Reviews, 170(1), 503–558. 
29. AMS Collaboration, Aguilar, M., Alcaraz, J., et al. (2002). The alpha magnetic spectrometer 
(AMS) on the international space station: Part I - results from the test ﬂight on the space shuttle. 
Physics Reports, 366(6), 331–405. https://doi.org/10.1016/S0370-1573(02)00013-3 
30. Lübelsmeyer, K., Schultz von Dratzig, A., Wlochal, M., et al. (2011). Upgrade of the alpha 
magnetic spectrometer (AMS-02) for long term operation on the international space station 
(ISS). Nuclear Instruments and Methods in Physics Research A, 654(1), 639–648. https://doi. 
org/10.1016/j.nima.2011.06.051 
31. Spence, H., Klein, K., & Bookbinder, J. (2019). The HelioSwarm Mission: A swarm of small 
satellites revealing the physics of space plasma turbulence. In Proceedings of the 33rd Annual 
Small Satellite Conference. 
32. Friis-Christensen, E., Lühr, H., Knudsen, D., & Haagmans, R. (2008). Swarm – an earth 
observation mission investigating geospace. Advances in Space Research, 41(1), 210–216. 
ISSN: 0273-1177. https://doi.org/10.1016/j.asr.2006.10.008. https://www.sciencedirect.com/ 
science/article/pii/S0273117706005497 
33. Li, X., Schiller, Q., Blum, L., et al. (2013). First results from csswe cubesat: 
Characteristics of relativistic electrons in the near-earth environment during the octo-
ber 2012 magnetic storms. Journal of Geophysical Research: Space Physics, 118(10), 
6489–6499. https://doi.org/10.1002/2013JA019342. https://agupubs.onlinelibrary.wiley.com/ 
doi/abs/10.1002/2013JA019342. 
34. Blake, J. B., et al. (2013). The magnetic electron ion spectrometer (mageis) instruments aboard 
the radiation belt storm probes (RBSP) spacecraft. Space Science Reviews, 179, 383–421. 
https://doi.org/10.1007/s11214-013-9991-8 
35. Kanekal, S., Blum, L., Christian, E., Crum, G., Desai, M., Dumonthier, J., Evans, A., Greeley, 
A., Guerro, S., Livi, S., et al. (2019). The merit onboard the ceres: A novel instrument to 
study energetic particles in the earth’s radiation belts. Journal of Geophysical Research: Space 
Physics, 124(7), 5734–5760. 
36. Young, D. T. (1998). Space plasma particle instrumentation and the new paradigm: Faster, 
cheaper, better. In Measurement techniques in space plasmas: Particles (pp. 1–16). American 
Geophysical Union (AGU). ISBN: 9781118664384. https://doi.org/10.1029/GM102p0001. 
https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/GM102p0001 
37. Cress, R., Maldonado, C. A., Coulter, M., Haak, K., Balthazor, R. L., McHarg, M. G., Barton, 
D., Greene, K., & Lindstrom, C. D. (2020). Calibration of the falcon solid-state energetic 
electron detector (SEED). Space Weather, 18(5), e2019SW002345, 2020, e2019SW002345 
2019SW002345. https://doi.org/10.1029/2019SW002345. https://agupubs.onlinelibrary.wiley. 
com/doi/abs/10.1029/2019SW002345 
38. Maldonado, C. A., et al. (2023). Initial results for on-orbit calibration of the FalconSEED 
on-board STPSat-6. In 2023 IEEE Aerospace Conference (pp. 1–10). https://doi.org/10.1109/ 
AERO55745.2023.10115657 
39. Blum, L. W., Kepko, L., Turner, D., et al. (2020). The GTOSat CubeSat: Scientiﬁc objectives 
and instrumentation. In T. George & M. S. Islam (Eds.), Micro- and nanotechnology sensors, 
systems, and applications XII. International Society for Optics and Photonics (vol. 11389, p. 
113892E). Bellingham: SPIE. https://doi.org/10.1117/12.2556268 
40. Maldonado, C. A., Deming, J., Mosley, B. N., et al. (2022). The experiment for space radiation 
analysis: A 12u cubesat to explore the earth’s radiation belts. In 2022 IEEE Aerospace 
Conference (AERO) (pp. 1–15). https://doi.org/10.1109/AERO53065.2022.9843239 
41. Maldonado, C. A., et al. (2022). The experiment for space radiation analysis: Probing the 
earth’s radiation belts using a cubesat platform. In 2022 SmallSat Conference (pp. 22-22664). 
42. Maldonado, C. A., et al. (2022). The experiment for space radiation analysis (ESRA): 
Technology maturation of next generation charged particle detectors in GTO. Advanced Maui 
Optical and Space Surveillance Technologies Conference.

Particle Measurements in Space
267
43. Maldonado, C. A., et al. (2023). Development of the experiment for space radiation analysis 
(esra) cubesat mission to GTO, Proceedings of the IEEE Aerospace Conference, 2023. 
44. Barney, J., Garduno, O., Roecker, C., et al. (2022). Experiment for space radiation analysis, 
energetic charged particle sensor: A charged particle telescope with novel sensors for measur-
ing earth’s radiation belts. In 2022 IEEE Aerospace Conference (AERO) (pp. 1–7). https://doi. 
org/10.1109/AERO53065.2022.9843784 
45. Gula, A., et al. (2023). Development of the energetic charged particle instrument for the ESRA 
CubeSat Mission. In 2023 IEEE Aerospace Conference (pp. 1–9). BigSky, MT, USA. https:// 
doi.org/10.1109/AERO55745.2023.10116011 
46. Turner, D. L., Lee, J. H., Nguyen, C. Q., Crain, W. R., Berman, A. L., & Blake, J. B. (2018). The 
micro-charged particle telescope (μCPT) for the AeroCube-10 mission. In AGU Fall Meeting 
Abstracts (vol. 2018). SH41D-3669, SH41D–3669 
47. Desai, M. I., Allegrini, F., Ebert, R. W., Ogasawara, K., Epperly, M. E., George, D. E., 
Christian, E. R., Kanekal, S. G., Murphy, N., & Randol, B. (2019). The cubesat mission to 
study solar particles. IEEE Aerospace and Electronic Systems Magazine, 34(4), 16–28. https:// 
doi.org/10.1109/MAES.2019.2917802 
48. Durante, M. (2014). Space radiation protection: Destination mars. In Life sciences in space 
research (pp. 2–9). https://doi.org/10.1016/j.lssr.2014.01.002 
49. Cucinotta, F. A., Kim, M.-H. Y., & Chappell, L. J. (2012). Space radiation cancer risk 
projections and uncertainties. NASA Technical Paper TP-2013-217375. https://spaceradiation. 
jsc.nasa.gov/irModels/TP-2013-217375.pdf 
50. Gaza, R., Kroupa, M., Rios, R., Stofﬂe, N., Benton, E. R., & Semones, E. J. (2017). Compar-
ison of novel active semiconductor pixel detectorwith passive radiation detectors during the 
NASA orion exploration ﬂight test 1 (eft-1). In Radiation measurements (vol. 106, pp. 290– 
297). Proceedings of the 18th International Conference on Solid State Dosimetry (SSD18), 
Munich, Germany, 3–8 July 2016. ISSN: 1350-4487. https://doi.org/10.1016/j.radmeas.2017. 
03.041. https://www.sciencedirect.com/science/article/pii/S135044871730224X 
51. Llopart, X., Ballabriga, R., Campbell, M., Tlustos, L., & Wong, W. (2007). Timepix, a 65k pro-
grammable pixel readout chip for arrival time, energy and/or photon counting measurements. 
Nuclear Instruments and Methods in Physics Research Section A: Accelerators, Spectrometers, 
Detectors and Associated Equipment, 581, 485–494. 
52. M. Collaboration. (2022). Medipix. Retrieved Nov 30, 2022 from https://medipix.web.cern.ch/ 
53. Hahn, C., Weber, G., Märtin, R., Höfer, S., Kämpfer, T., & Stöhlker, T. (). CDTE timepix 
detectors for single-photon spectroscopy and linear polarimetry of high-ﬂux hard x-ray 
radiation. Review of Scientiﬁc Instruments, 87(4), 043106. https://doi.org/10.1063/1.4945362 
54. Tremsin, A., & Vallerga, J. (2020). Unique capabilities and applications of microchannel 
plate (MCP) detectors with medipix/timepix readout. Radiation Measurements, 130, 106228. 
ISSN: 1350–4487. https://doi.org/10.1016/j.radmeas.2019.106228. https://www.sciencedirect. 
com/science/article/pii/S1350448719305141 
55. Smolyanskiy, P., Bergmann, B., Chelkov, G., Kotov, S., Kruchonak, U., Kozhevnikov, D., 
Sierra, Y. M., Stekl, I., & Zhemchugov, A. (2018). Properties of gaas: Cr-based timepix 
detectors. Journal of Instrumentation, 13(2), T02005. https://dx.doi.org/10.1088/1748-0221/ 
13/02/T02005 
56. Krejci, F., Jakubek, J., & Kroupa, M. (2011). Single grating method for low dose 1-d and 2-d 
phase contrast x-ray imaging. Journal of Instrumentation, 6(1), C01073. https://dx.doi.org/10. 
1088/1748-0221/6/01/C01073 
57. Kroupa, M., Jakubek, J., & Soukup, P. (2012). Optimization of the spectroscopic response of 
the timepix detector. Journal of Instrumentation, 7(02), C02058. https://dx.doi.org/10.1088/ 
1748-0221/7/02/C02058 
58. Jakubek, J. (2011). Precise energy calibration of pixel detector working in timeover-
threshold mode. In Nuclear instruments and methods in physics research section A: 
Accelerators, spectrometers, detectors and associated equipment (vol. 633), S262–S266. 
11th International Workshop on Radiation Imaging Detectors (IWORID), ISSN: 0168-
9002. http://dx.doi.org/10.1016/j.nima.2010.06.183. http://www.sciencedirect.com/science/ 
article/pii/S0168900210013732

268
M. Kroupa et al.
59. George, S., Kroupa, M., Wheeler, S., Kodaira, S., Kitamura, H., Tlustos, L., Campbell-Ricketts, 
T., Stofﬂe, N., Semones, E., & Pinsky, L. (2018). Very high energy calibration of silicon 
timepix detectors. Journal of Instrumentation, 13(11), P11014. https://dx.doi.org/10.1088/ 
1748-0221/13/11/P11014 
60. Hoang, S., Vilalta, R., Pinsky, L., Kroupa, M., Stofﬂe, N., & Idarraga, J. (2014). Data analysis 
of tracks of heavy ion particles in timepix detector. Journal of Physics: Conference Series, 
523(1), 012026. https://dx.doi.org/10.1088/1742-6596/523/1/012026 
61. Kroupa, M., Campbell-Ricketts, T., George, S. P., Bahadori, A. A., & Pinsky, L. S. (2023). 
Particle showers detected on iss in timepix pixel detectors. Life Sciences in Space Research. 
62. Kroupa, M., Bahadori, A. A., Campbell-Ricketts, T., George, S. P., & Zeitlin, C. (2018). Kinetic 
energy reconstruction with a single layer particle telescope. Applied Physics Letters, 112(13), 
134103. https://doi.org/10.1063/1.5024920 
63. Kroupa, M., Bahadori, A. A., Campbell-Ricketts, T., George, S. P., Stofﬂe, N., & Zeitlin, 
C. (2018). Light ion isotope identiﬁcation in space using a pixel detector based single layer 
telescope. Applied Physics Letters, 113(17), 174101. https://doi.org/10.1063/1.5052907 
64. Stofﬂe, N., & Pinsky, L. (2018). Identiﬁcation of stopping ions in a silicon timepix detector. 
Nuclear Instruments and Methods in Physics Research Section A: Accelerators, Spectrometers, 
Detectors and Associated Equipment, 880, 35–39. ISSN: 0168-9002. https://doi.org/10.1016/j. 
nima.2017.10.068. https://www.sciencedirect.com/science/article/pii/S0168900217311518

Photon Counting Detectors: Applications 
in Radiotherapy 
Alex Winkler 
Following abbreviations are used in this chapter. 
Ag
Silver 
b
Barn, unit of nuclear cross sections 
B
Boron Neutron Capture 
Be
Beryllium 
BNC
Boron Neutron Capture 
BNCT
Boron Neutron Capture Therapy 
CBCT
Cone Beam Computed Tomography 
Cd
Cadmium 
CdNC
Cadmium Neutron Capture 
CdTe
Cadmium Telluride 
CdZnTe 
Cadmium Zinc Telluride 
CMOS 
Complementary Metal Oxide Semiconductor 
Co
Cobalt 
Cr
Chromium 
Cs
Caesium 
CT
Computed Tomography 
eV
electron Volt 
EID
Energy Intergrating Detector 
ERBT
External Radiation Beam Therapy 
F
Fluorine 
Ge
Germanium 
Gy
Gray, unit of absorbed dose of ionizing radiation 
HPLC
High Performance Liquid Chromatography 
Hf
Hafnium 
A. Winkler () 
Helsinki Institute of Physics, University of Helsinki, Helsinki, Finland 
e-mail: alexander.winkler@helsinki.ﬁ 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
C. Hansson, K. (Kris) Iniewski (eds.), X-ray Photon Processing Detectors, 
https://doi.org/10.1007/978-3-031-35241-6_12
269

270
A. Winkler
Hz
Hertz, unit of frequency 
Ir
Iridium 
IRT
Internal Radiation Therapy 
IORT
Intraoperative Radiation Therapy 
LET
Linear Energy Transfer 
Li
Lithium 
Linacs
Linear accelerators 
Mn
Manganese 
MRI
Magnetic Resonance (tomography) Imaging 
NCT
Neutron Capture Therapy 
O
Oxygen 
PC
Photon Counting 
Pd
Palladium 
PCD
Photon Counting Detector 
PET
Positron Emission Tomography 
PG
Prompt Gamma 
RT
Radiation Therapy 
Si
Silicon 
SNR
Signal to Noise Ratio 
SOBP
Spread-Out Bragg Peak 
SPECT 
Single-Photon Emission Computed Tomography 
Ta
Tantalum 
Te
Tellurium 
W
Tungsten 
Zn
Zinc 
1 
Radiotherapy Introduction 
Radiation therapy (RT), also known as radiotherapy, is a form of cancer treatment 
that utilizes high-energy radiation. The goal of RT is to deliver a lethal dose of 
radiation to the tumor (cancer stem cells), while minimizing exposure to healthy 
tissue. The treatment may be realized as the primary therapy for treatment, or used 
in conjunction with surgery, chemo, or other therapies. Typical RTs are divided into 
daily sessions that are distributed over a period of several weeks until the prescribed 
does is reached. The radiation provided for RT can be delivered externally using 
specialized accelerators, or internally, through the placement of small radioactive 
sources inside the body. 
The detection of the radiation is an essential part of RT and has been an element 
therapy’s development since its introduction. However, the requirements to detectors 
used for RT show several principal differences compared to diagnostic imaging 
applications. Radiation hardness and signal intensity are two of the most pronounced

Photon Counting Detectors: Applications in Radiotherapy
271
differences. These lead to several additional difﬁculties for the adoption of photon 
counting detectors (PCDs) in RT which are discussed in this chapter. 
1.1 
History 
Conrad Wilhelm Röntgen’s discovery of the X-rays in 1895 lead quickly to the 
application in medical imaging, with the ﬁrst X-ray images being acquired for 
surgical applications within a year from their discovery. It is less known that the 
ﬁrst breast cancer patient was also treated within one year from the discovery 
of X-rays [15]. Although with questionable success, as the adverse effects of 
ionizing radiation were only begun to be collected a few years after Röntgen’s 
initial discovery. As practitioners and patients found to experience inﬂammations, 
blistering, ulceration and necrosis at the areas of exposure to X-rays. 
This quickly lead to more dedicated and sophisticated trials of treating various 
skin and superﬁcial carcinomas with X-rays. Whilst deeper laying tumors required 
ionizing radiation with larger energies in the range of MeV. These became widely 
available after the invention of nuclear reactor and their possibility to transmute 
stable elements to radioactive isotopes through neutron bombardment [12]. H.E. 
Johns presented in 1949 the ﬁrst prototype that employed Superscript 6060Co as source for higher 
energy ionizing radiation, in order to treat deeper seeded tumors. He developed 
the concept quickly further and his proposed Cobalt-60 Units established as the 
main source for radiation therapy until the 1970s. At that time the development of 
linear accelerators (Linacs) made sufﬁcient advances to provide beams with high 
enough energy, intensity and operation time to replace the established Cobalt Units. 
Since then numerous generations of medical accelerators have been iterated and are 
nowadays the main tool for contemporary radiation therapy. Larger hospitals often 
operate 10s of linacs to serve their districts. These comparably cheap devices deliver 
electron or X-ray beams, whiles further specialized accelerator types have been 
developed for other radiation therapies such as proton, carbon or neutron therapy. 
Linacs accelerate particles through the use of an oscillating electrical potential. 
Whereas the frequency of the oscillation being in historically in the MHz and thus 
radio frequency region. For X-ray Linacs, electrons are accelerated to 20 MeV or 
more and are directed on suitable target materials such as W. This results in X-
ray energies up to the acceleration voltage of the electrons. The overall principle is 
similar to that of an X-ray tube, however with substantially higher spectral energies. 
Modern Linacs are equipped with a low and high energy imaging system referred 
to as kV and MV imager. These are discussed in Sects. 2 and 4. An example of an 
X-ray Linac is presented in Fig. 1. 
Except for neutron therapy, are dedicated Linacs for particle therapies focusing 
the beam directly on the patient, hence do not require a target material. This 
necessitate additional beam focusing elements and substantially larger acceleration 
electronics, due to the higher mass of protons and ions compared to electrons. Linacs

272
A. Winkler
Fig. 1 An X-ray Linac for 
radiation therapy at the Oulu 
University Hospital, Finland. 
The devices on the arms are 
an X-ray tube and 
corresponding detector, as 
well as the Portal imager 
retracted on the bottom. 
Credit to Dr. Mikael Brix, 
Dr. Sakari Karhula, Oulun 
Yliopistollinen 
Sairaala—OYS, private 
communication, February 
2023 
for neutron therapy use a proton beam on a suitable target material such as Be or Li 
to produce neutrons, which is the principle of a spallation source. 
More details on the history of RT can be found in the publications referred to in 
the Further reading section, Sect. 5 
1.2 
Concepts and Types of Radiation Therapy 
Radiation therapy is general divided into external radiation beam therapy (ERBT) 
and internal radiation therapy (IRT). Whereas this separation refers to the source of 
radiation. Thus, if said source is located internally or externally from the patient. 
Please note that intraoperative radiation therapy (IORT), thus treating a cancer that 
has been exposed during surgery with ionizing radiation, is also considered part of 
ERBT.

Photon Counting Detectors: Applications in Radiotherapy
273
1.2.1 
Internal Radiation Therapy 
IRT relies on a surgical implantation of a radiation source near or inside a cancer, 
providing a deﬁned dose to a locally restricted volume. IRT utilizes radioactive 
isotopes that emit continuously and omnidirectional, rather than on demand and 
directed beams, as in ERBT. Therefore, IRT is also referred to as Brachytherapy, 
whereas brachy is based on the Greek word brachys, meaning short and describes 
the therapy more precise. 
Sources used for this therapy, are mainly small and sealed isotopes that emit betaβ or 
low energy photon radiation, which allow to deposit the therapeutic dose within a 
short distance from the source. This way a lethal dose can be provided to the cancer, 
while tissues further away are mostly saved from exposure. The strong dose gradient 
is the main advantage of this therapy type. Various subdivision of this therapy have 
developed, which include temporary and permanent placement of the source, as well 
as hot loading and afterloading. The latter refers the process of loading the radiation 
source into an applicator that was surgically implanted to the patient earlier. While 
hot loading implies that said applicator is already loaded with an radioactive source, 
during the implantation. 
Advantages of brachytherapy are local application and restriction of the treatment 
volume. Additionally, the continuous application of the treatment dose at either low 
(less than or equals≤2Gy/h) or high rates (less than or equals≤12Gy/h) have lead to clinical success rates similar to 
EBRT [22, 34], while keeping exposure to healthy tissue low. Typical isotopes used 
are among others, Superscript 131131Cs,Superscript 125125I, Superscript 192192Ir and Superscript 103103Pd. 
Although under active research, alphaα sources are not used for brachytherapy [3], 
due to the short linear energy transfer (LET) of alphaα particles, therefore rendering the 
effective range in tissue to less than< 1 mm. 
1.2.2 
External Radiation Beam Therapy 
Modern ERBT is provided by some form of an accelerator and is the most used 
mode of therapy that is applied nowadays. The advantage compared to IRT is that 
the source of radiation is only active as long as the accelerator is active. Hence, 
deactivated accelerators do not pose a radiation risk. This makes it easier to place 
these devices within the premises of hospitals and treatment institutions. A major 
downside of ERBT is that healthy tissue is inevitably exposed to high doses of 
radiation. Therefore, careful treatment planning has become an essential part of 
contemporary external radiotherapy, as have radiation detectors to verify the planned 
outcome.

274
A. Winkler
1.3 
Most Commonly Used Therapies 
The by far most commonly used type of external RT is based on X-rays. This 
is due to the comparably cheap and small footprint linacs used for this therapy. 
Furthermore, shielding of a facility is simple and only little activation of materials 
occurs. All this makes X-ray based RT the choice for most cancer types. It is 
further referred to as photon-, Röntgen-, or colloquially beam therapy. Various 
improvements and modiﬁcations exist for this therapy. Of which a few are described 
in this section. 
The most noteworthy improvements are the advances of medical imaging for RT. 
Today, virtually all radiotherapies are delivered based on Computer Tomography 
(CT), Magnetic Resonance (Tomography) Images (MRI), or similar techniques that 
are obtained before, during and after the therapy. These information allow to monitor 
and adjust the treatment continuously, which has enabled does reductions to healthy 
tissue signiﬁcantly, while also increase the efﬁcacy of modern X-ray therapy. 
Another improvement is computer assisted (tumor) tracking that allows to com-
pensate for respiratory and patient movement to some extend. It further improves 
dose delivery, while reducing exposure to healthy tissue [37].  The next step is to  
actively track the tumor during the therapy and adjust the beam and dose proﬁle 
while the therapy is being carried out. This requires specialized detectors and will 
be discussed later in more detail (Sect. 4.1). Other recent improvements are: 
Intensity Modulation Using beamlets to actively control shape and portion of the 
beam, allowing to further spare healthy tissue, while cancer tissue is treated. 
Stereotactic Irradiation Uses several (usually lower dose) beams from various 
directions, providing high dose at the convergence center, while reducing exposure 
of healthy tissue. 
Combination Therapy Is used in combination with other cancer therapies, such 
as surgical, chemo or gene therapy. 
Other Types of EBRT 
These are electron, proton, carbon and heavy ion therapies. Each with their 
individual advantages and disadvantages. The most notably advantage is that these 
types of therapy allow to control the energy of the particle in the patient precisely, 
which results in control of the location of the Bragg peak and with that the place 
of highest energy transfer in the patient. This leads to lower surface and healthy 
tissue dose and more precise dose delivery to the tumor volume. Conceptually 
this is depicted in Fig. 2, where the dose distribution of X-ray and proton therapy 
beams are shown in relation to one another. For X-ray therapy, the dose is highest 
slightly below the skin and is then continuously decreasing with increasing depth 
in the patient. The dose is further scaled so that the tumor region receives 100% 
of the target dose. As a consequence, are skin and shallow tissue doses higher 
than the target dose. In addition, is the tissue located after the tumor (from beam 
point of view) also exposed so signiﬁcant dose. This is the reason why X-ray RT is

Photon Counting Detectors: Applications in Radiotherapy
275
Fig. 2 Dose distribution for 
X-ray and proton therapy in 
comparison. For X-ray 
therapy, a continuous 
attenuated dose proﬁle (red 
line) is administered to the 
patient, including tissue 
before and after the tumor 
region. A much more 
conﬁned dose proﬁle can be 
achieved with proton therapy 
by spreading out the Bragg 
peak (SOBP, blue dashed 
line). [46] 
performed from multiple angles and in numerous sessions (fractionated), to ensure 
that the overall dose of healthy tissue stays below an adverse threshold, while the 
accumulated dose to the tumor tissue reaches the prescribed dose to treat the tumor. 
In proton and other particle based therapies, the majority of the dose is deposited 
at the Bragg peak, with no further dose after it as the particle is stopped completely. 
Furthermore, the entrance dose is also reduced as comparably little energy is lost 
during shallow interaction in the tissue. The depth of the Bragg peak is controlled 
with slight adjustments in the energy of the particle acceleration, causing a spreading 
out the Bragg peak (SOBP), which enables precise dose administration to the tumor 
volume. 
Accelerators that can be used for particle therapy are however substantially 
more expansive, therefore leading to fewer devices. In Europe, were only 44 
particle therapy accelerators listed in 2022, which includes all types of particle 
therapies [36]. Please note that the Bragg peak of an electron beam behaves 
differently and thus requires a different approach to administer a prescribed dose 
in a tumor region, while keeping it low for healthy tissue [21]. 
1.4 
Modiﬁcations of Existing Radiotherapies 
Numerous modiﬁcations exist for RTs, with some being actively practiced and 
others still being at the stage of clinical studies. A few of the main research concepts 
are: 
Hypofractionated RT Increases the dose delivered per fraction by a factor of <2, 
while shortens the total therapy time by half [50]. The motivation for this approach 
is that some cancer tissues (e.g. prostate cancer) have a different sensitivity to

276
A. Winkler
irradiation than other cancer tissues. Hypofractionation allows better disease control 
for these types of cancer [2]. 
FLASH Provides ultra high dose rates, thus delivering higher doses than conven-
tional X-ray therapy in a fraction of the time. Treatments may potentially be reduced 
to a single or a few sessions [8]. This increase of throughput reduces cost of RT 
signiﬁcantly, making this therapy more affordable and available. This modiﬁcation 
is currently evaluated in clinical trials [29]. 
Spatially fractionated RT Exposing areas of a tumor with a booster dose and/ 
or providing non-uniform dose distribution within the tumor, while achieving 
improved disease control [11, 13, 48]. 
1.5 
Exotic Radiation Therapy: Boron Neutron Capture 
Therapy 
A particular promising RT, for which currently clinical phase II studies are ongoing 
is the Boron Neutron Capture Therapy (BNCT) [16, 19]. BNCT has been developed 
since the 1930s and has the ability to deliver the treatment dose on a per cell level, 
while keeping the dose to neighboring healthy cells very low and even dose free. 
BNCT can be considered either a mix of IRT and ERBT or a new category. Since the 
therapeutic dose is provided internally to cells that have been loaded with a neutron 
active isotope and only if the cell is exposed to external neutron radiation [25]. 
Healthy cells have a slower uptake proﬁle for the neutron active isotope, resulting 
in low presence in these cells, which are thus unaffected by the neutron beam. The 
principle of neutron capture therapy is shown in Fig. 3. For BNCT, the neutron 
active isotope is boron-10 (Superscript 1010B) with a neutron capture cross section of 3843 b at 
thermalized neutron energies [9]. 
BNCT has been evaluated in since the 1980s in modern clinical trials and 
with positive success rated for especially recurring tumors of the head and neck 
region [24, 39, 40, 49]. Currently, it is tested as a last-resort therapy type, after 
unsuccessful treatment of other therapies. Once a clinical established RT, it may be 
combined with other therapies or used as a ﬁrst option. Research has recently gained 
more activity due to the availability of neutron accelerators with sufﬁcient intensity 
and energy, leading to new clinical studies in Japan [16, 19] and further studies 
being expected from China and Finland in 2023 [20]. One of the main research foci 
of BNCT is a method for real time dosimetry. A task for which PCDs are ideally 
suited, this will be discussed in Sect. 4.2.1.

Photon Counting Detectors: Applications in Radiotherapy
277
Fig. 3 The principle of BNCT. The nuclear reaction (left): a Superscript 1010B atom captures a neutron, 
transmutes into unstable Superscript 1111B and decays into a Superscript 77Li, an alphaα particle and a gammaγ photon. The therapeutic 
effect (right): Superscript 1010B is loaded to a tumor cell (dark), in which the nuclear reaction occurs upon 
neutron capture. Healthy neighboring cells stay unaffected by the passing neutrons [47] 
2 
Difﬁculties in Imaging for Radiotherapy 
Imaging in RT is a highly complex task that faces numerous difﬁculties. The 
most prominent are saturation of detectors, tissue equivalent dosimetry, radiation 
hardness, patient positioning and anatomical changes of patients during the therapy. 
These are discussed here with respect on the inﬂuence of detectors onto the imaging 
process. 
2.1 
Dosimetry 
To measure the (patient) dose is one of the most important tasks in RT, as it allows 
the veriﬁcation of the prescribed dose and is thus a measure for the therapeutic 
efﬁcacy of the therapy for a patient. Several dose models exist to calculate the patient 
dose, however veriﬁcation before, during and after the therapy require dedicated 
detectors to do so. Depending on the type of therapy active and passive devices may 
be used. Passive detectors are usually based on chemical or physical changes of a 
medium that is exposed to the treatment radiation. These processes are generally 
linear, non-reversible but the dosimeters are comparably cheap. Therefor, these are 
often the ﬁrst choice in RT. However, passive dosimeters have major disadvantages 
compared to active ones. 
These are most notably the readout time and the sensitivity. Passive dosimeters 
are read out after the treatment or treatment session and the treatment plan is 
adjusted accordingly. In case of an activation based material (as used in neutron 
therapy), the readout window is often very short as the activation of the material 
quickly decays. The sensitivity of most standard passive dosimeters is comparably

278
A. Winkler
poor, as precise measurements on the level of a therapy session are difﬁcult due 
to the nature of the processes utilized for these dosimeters. Active dosimeters, do 
not show these difﬁculties and can be read out quickly or in real time and during a 
therapy session. Their sensitivity is much higher resolved and allows precise enough 
measurement for a RT session. Typically, these kind of devices are more expansive 
than the passive dosimeters. 
Both dosimeter types share similar further difﬁculties. One being the obstacle 
to place the dosimeter inside a patient, which can often only be resolved with an 
incision. Another difﬁculty is to cover the complete tumor volume and from all 
sides. Finally, dosimeters are not tissue equivalent, thus a conversion of the dose 
received by the dosimeter and the patient tissue, needs to be applied. 
Another, substantially important detail is that both passive and active dosimeters 
are calibrated against one radiation source. For example the 662 keV gammaγ -emission of 
Superscript 137137Cs, or the 1173.2 keV and 1332.5 keV gammaγ -emissions of Superscript 6060Co. Near these photon 
energies the dosimeter will show accurate readings. However, the spectrum that the 
patient is exposed to, as well as the spectrum that the tumor and healthy tissue 
are exposed to, are substantially wider than the calibration energy. Clear standards 
and traceable processes for clinical dosimetry ensure as correct as feasible readings 
of dosimeters. However, a dose reading may still be off by signiﬁcant values, 
which occurs in particular for energies further away from the calibration energy 
of the dosimeter. For example, uncertainties of as much as 10% are possible for 
Brachytherapy [10]. In particular the uncertainty of dose readings, is a shortcoming 
that PCDs could principally overcome. As each pixel of these detectors resolves the 
detectable spectrum in discrete sections called energy bins that allow to approximate 
the dose more accurate. A PCD with reasonably high number of energy bins would 
be able to measure a whole spectrum, from which dose calculations are possible 
with higher precision. The minimum number of energy bins required for such 
a task is discussed in Sect. 4.2. An integration over all energy bins restores the 
whole spectrum and results in a single energy bin, which is what energy integrating 
detectors (EIDs) detect. Figure 4 visualizes the concept. Discrete energy bins are the 
core beneﬁt of PCDs over EIDs and several improvements over existing solutions 
are possible because of these. 
2.2 
Treatment Plan, Patient Positioning and Anatomy 
Today, most EBRTs are preformed in a similar manner. After the diagnosis of 
the tumor and decision to treat the tumor with RT, is the patient imaged by 
CT, Positron Emission Tomography (PET), Single Photon Emission Computed 
Tomography (SPECT), MRI, Ultrasound (US), or a speciﬁc imaging methods such 
as Mammography for breast cancer. Often more than one of these methods in 
combination. The images are then loaded into the treatment planning software and 
the treatment planner is devising one or more plans for the patient. Shortly before 
the treatment is started the patient is imaged again, e.g. with cone-beam computed

Photon Counting Detectors: Applications in Radiotherapy
279
Fig. 4 Schematic representation of energy bins as used by PCDs. While the whole spectrum is 
being integrated into a single energy bin for EIDs, allow PCDs to separate the detected spectrum 
into several bins. Please note that the width of the bins may be arbitrary for some PCDs 
tomography (CBCT) to account for potential changes in the patients anatomy and 
then the treatment is carried out. Depending on the number of session and treatment 
length, additional patient images are taken to adjust the treatment course. These 
may also be obtained with the imaging device attached to the RT machine. After the 
therapy has concluded, several images are taken over an extended period of time to 
monitor the development of the tumor. Even though this practice is an established 
method, it enables only limited monitoring of the patient, or the progress of the 
treatment while it is being carried out. 
The patient’s position and anatomy have major inﬂuence on the efﬁcacy of the 
treatment. Typical issues include: 
• 
Positioning the patient as required by the treatment plan for every treatment 
session 
• 
Ensure minimal or no patient movement during the treatment 
• 
Account for anatomical changes. E.g. different organ volumes, such as non-
emptied bowels before treatment of prostate cancer, or inﬂamed breasts during 
treatment of breast cancer 
• 
Account for anatomical changes due to a different imaging and treatment position 
of the patient 
• 
Different tumor size compared to the last scan 
Modern treatment facilities contain scanning systems to conﬁrm the patient’s 
position or even the treatment progress. However, these require an additional 
imaging source and detector. In general these are C-arm like scanning systems using 
CBCT to monitor the patient. These are the kV imagers mentioned in Sect. 1.1. A  
kV panel is visible on the right arm of the RT device presented in Fig. 1. The source, 
a standard X-ray tube, is located on the left arm. 
Despite, these kV imaging systems improving the issues mentioned, they are not 
an ideal solution. The patient is exposed to additional dose of radiation that needs to

280
A. Winkler
be accounted for in the treatment plan. Imaging and treatment cannot be done at the 
same time, as the detectors would saturate (see Sect.3). Furthermore, the imaging 
geometry is perpendicular and external to the treatment direction, which may lead 
to situations where the patient can not be imaged due to spatial collision with the 
patient or other devices in the treatment room. Finally, is the lifetime of the imaging 
detectors greatly reduced due to the high dose of radiation they are exposed to. 
Regular replacements are costly and not environmentally responsible. Ideally, an 
in-beam geometry that uses the treatment beam, patient attenuation and potentially 
patient scatter to image the progress and in real time would be the most practical 
method. The MV, or  Portal imagers of modern RT devices follows this approach, 
which is more discussed in Sect. 4. Difﬁculties related to this approach and the 
resulting detector requirements are discussed in the next section, Sect. 3. 
3 
Requirements to Detectors in Radiotherapy 
The rest of this chapter will focus on PCDs only and leave out passive detectors as 
these go beyond the scope of this book. However, the topics discussed in this and 
the following section may partially apply to passive detectors, too. As they do for 
other direct conversion materials that are not further mentioned here. These include 
Perovskites and quantum dots, both novel and highly promising direct conversion 
materials and both with their own advantages and disadvantages. Neither of these 
however, is developed enough, to be used as EID or PCD for medical applications 
and are therefore not covered here. The reader however is referred to other sources 
for these materials as mentioned in the further reading section, Sect. 5. 
Detectors that are to be used for RT, both for direct and indirect imaging 
require: 
• 
Radiation hardness 
• 
Low efﬁciency 
• 
Sufﬁcient resolution for the application (temporal, spatial, spectral) 
• 
Non-activatable 
• 
Comply with legal requirements 
The ﬁrst and most important requirement is the radiation hardness of the 
detector that are to be used for RT. In case of X-rays, the detector may be 
exposed to several 10’s of kGy per year [32]. The detector is required to keep it’s 
performance over it’s lifetime, which should naturally be as long as possible. Highly 
ordered materials, such as crystalline silicon as in complementary metal–oxide– 
semiconductor (CMOS) detectors will suffer quick performance degradation in form 
of higher noise or failure of functionality due to induced crystallographic damages 
by the ionizing radiation. Some less ordered structures are more radiation hard, for 
example amorphous silicon [51]. These however still suffer failure during operation, 
due to radiation damage. A similar argumentation applies to the scintillation 
materials that convert the X-ray photons to light in these detectors.

Photon Counting Detectors: Applications in Radiotherapy
281
The second requirement on detectors for RT, is a comparably low efﬁciency. 
Though, initially contradicting, is a low efﬁciency of advantage. A most efﬁcient 
detector, as used for diagnostic imaging, will produce a signal that saturates the 
readout electronics and data links and thus becomes unusable. A highly inefﬁcient 
detector on the other hand, produces a signal that uses only a small fraction of the 
incoming photon or particle ﬂux and can be operated with existing and reasonable 
readout electronics. It will further not saturate data link technologies. Therefore, 
the majority of the radiation that is exposed to a detector during RT, should be 
transmitted without interaction. This condition further supports the requirement for 
radiation hardness, as less interaction results in less radiation damage. To build an 
inefﬁcient detector is comparably simple. The difﬁculty however, lies in building a 
detector that still performs linear with the ﬂux it is exposed to. 
Naturally any detector used for RT, needs to fulﬁll the application requirement 
on temporal, spatial and spectral resolution. Thus, being able to produce a signal 
reasonably fast compared to the beam frequency. A detector with high lag or reaction 
time of a few seconds is not usable as a real time imaging device in RT. Similar 
requirements apply to the spatial resolution. The spectral resolution is somewhat 
more complex, but can be understood when considering neutron imaging. The 
neutron capture cross section of Superscript 66Li, a typical material used in neutron detectors, is 
about 940 barn at thermal neutron energies of less than< 0.025 eV. The capture cross section 
decreases linearly for neutron energies up until 10 keV. Is the neutron energy raised 
even further, then a resonance peak appears at 244.13 keV, followed by non-linear 
cross section behavior, see Fig. 5. This will cause severe complications during an 
imaging application, where part of the image is exposed by thermalized neutrons 
and part by faster neutrons in the resonance region. The detector will not be able 
to distinguish if the neutron had an energy of 244.13 keV, or 190 eV. Hence, a 
distinction if the neutron had been thermalized in the imaged target (i.e. the patient), 
or is a beam neutron is not possible. 
Another requirement to detectors used in RT is to be as little activatable as 
possible. This can be achieved by choice of the right materials or intelligent com-
bination of shielding materials. Activation can occur through secondary particles 
(e.g. pair production, ionization particles), or originate directly from the beam (e.g. 
proton, or neutron). A small number of beam or secondary particles undergo nuclear 
reactions with the materials in their surrounding and create radioactive isotopes. 
A typical case is the activation of C, N, O in proton therapy [27, 28]. The decay 
of the isotopes that are created during the therapy, are an additional dose to the 
patient. For the detector these additional radiation sources deteriorate the signal 
as they are manifesting as scatter radiation. Furthermore, the detector itself may 
be activated causing additional image deteriorating scatter radiation and potential 
radiation damage. 
Finally, the detector needs to fulﬁll the legal requirements to be used in the place 
of operation. This particularly applies to neutron detectors. As the legislation in 
some countries do not allow certain types of detectors or certain materials used 
for detectors. As an example, the bureaucratic hurdles to purchase and operate a U

282
A. Winkler
10-12 
10-10 
10-8 
10-6 
10-4 
10-2 
100 
102 
Energy [MeV] 
100 
101 
102 
103 
104 
105 
Cross section [barns] 
Fig. 5 Nuclear capture cross section of Superscript 66Li, a typical material for neutron detectors. The detector 
will react linear with neutron energies up to 10 keV. At higher neutron energies, non-linear behavior 
will dominate. Plotted after data from [9] 
based ﬁssion chamber in Japan are prohibitively high, making their use unfeasible 
for many projects. 
4 
Examples of Photon Counting Detectors for Radiation 
Therapy 
Radiation detectors in all their variations are an essential part of RT. Their usage 
can be separated into indirect applications and direct applications. The indirect 
applications form the majority of use cases, due to the rather novelty of PCDs. 
Within these indirect applications, is the ﬁeld of quality assurance the most 
dominant utilization. Direct application cases are in the focus of active development 
however and we can expect to see this ﬁeld growing in the near future. 
Most of the applications and examples mentioned in this section are under active 
research and thus only theoretical or laboratory results can be reported. Nonetheless, 
all of these are addressing needs of RT and therefore well possible to ﬁnd their ways 
into RT systems in one form or another. 
PCDs assumed in this section refer to line or matrix type detectors, consisting 
of multiple pixels that are capable of recording photons with more than one energy 
bin. Single pixel detectors with a high number of energy bins are excluded from the 
PCD deﬁnition here.

Photon Counting Detectors: Applications in Radiotherapy
283
4.1 
Indirect Applications 
Beam Veriﬁcation The most dominant application in RT is beam veriﬁcation. 
This includes measuring beam proﬁles (horizontal and vertical), count statistics 
and spectral composition. The beam proﬁle is an essential parameter that has to 
be veriﬁed for every RT device and on a regular basis. If the beam proﬁle is out of 
speciﬁcation, then the treatment plan can not be executed as intended. Low treatment 
efﬁcacy and unnecessary patient dose are immediate consequences. For most RT 
devices the beam proﬁle is measured by local technicians or clinical physicists. 
This work is carried out under the annual quality assurance program in regular 
intervals with standardized phantoms and measurement procedures. Despite the well 
deﬁned and veriﬁed procedures, the actual situation under which the patient will be 
treated, is difﬁcult to reproduce. In particular beam scatter of the patient itself is 
deteriorating the beam proﬁle more than a homogeneous phantom does. Therefore, 
a system that actively measures the beam proﬁle during the treatment allows to 
compensate deviations compared to the calibration settings [14]. The compensation 
is for example achieved by with tuning beam shaping assembly, or with multileaf 
collimators. 
A device that is capable of providing an online beam proﬁle during therapy, may 
also be used as a counter to verify beam ﬂux. Which is the task of beam monitors. All 
medical RT devices need various and redundant ways of verifying that the desired 
treatment ﬂux is actually delivered, which directly translates to delivered dose. In 
addition to the beam monitors, this functionality is currently also achieved with 
the MV imager mentioned in Sect. 1 [26]. However, PCDs allow to improve the 
accuracy. The spectrum of a beam proﬁle for example, can roughly be divided into 
a lower energetic part that is highly dominated by scatter radiation and a higher 
energetic part originating from the beam itself. A PCD with 2 energy bins allows to 
separate these and provide more accurate feedback data to the treatment planning 
software that controls the RT device. Advanced algorithms also allow to use the 
scatter information of the lower energy bin for the same purpose. Furthermore, a 
PCD can be used in conjunction with the current MV imager, allowing to correct 
the current data. The latter is likely the favored approach by manufacturers, as PCDs 
remain signiﬁcantly more expansive than EIDs for the foreseeable future. 
Veriﬁcation of Clinical Isotopes Another application that can directly beneﬁt from 
PCDs is the veriﬁcation of therapeutic isotopes. This applies for both diagnostic and 
therapeutic isotopes. The bulk of clinically used isotopes are comparably short lived. 
This means that the time window for synthesis and quality assurance (here activity 
and purity) are very short. Most isotopes for medical application are produced with 
an in-hospital accelerator (usually a cyclotron). However, the desired isotope is often 
not the only one that is being synthesized, due to impurities of the source materials 
and ablation of the window material between the cyclotron chamber and the target 
volumes. For example, 18O enriched water that is irradiated with protons, can be 
used to produce 18F, along with small amounts of radioactive Co, Mn, Cr and Ag

284
A. Winkler
isotopes. The radiobiological effects of these isotopes may be problematic if these 
decay with alpha particles. In addition, some of the produced isotopes are toxic, or 
form toxic compounds in the body. Quality assurance of the produced radio tracer 
or therapeutic isotope is therefore mandatory. This is simply executed by measuring 
the spectrum of the produced isotope mix with a suitable spectrometer, such as 
a high purity Ge detector. The emissions of impurities are however, often below 
the sensitivity at a given measurement time window (18F half life time is 109.77 
minutes). Thus, certainty and accuracy can only be assured to a limited level of 
conﬁdence. PCDs with suitable high energy resolution allow to measure the isotope 
while it is being pumped though a plastic tube to the transport container. This may 
even be feasible with a line detector, which is a 1-dimensional detector. Techniques 
such as time delayed integration used over all pixels allows to produce a spectrum of 
the synthesized isotope mix, while it is being pumped to the transport capsule. This 
procedure could further improve the currently favored method of radio-HPLC [30], 
while also increase conﬁdence and reduce costs to the health care system. 
New Contrast Agents and Tracers Further research is focusing on the develop-
ment novel contrast agents for diagnostic and radiotherapy imaging. These include 
nano materials and various materials that are already used for medical applications 
such as gold and gadolinium [4] as well as complementary materials such as Ta 
and Hf [5, 7, 23] . The most obvious approach is to use K-edge imaging [38] of  
the contrast materials and adjust the PCDs energy bins accordingly, which enables 
improved separation of tissues with and without the contrast agent [35], or the 
separation of multiple contrast agents [41]. This approach equally interesting for 
the therapeutic side of radio medicine, since tracers are also used there. 
Other Applications Aside from the aforementioned applications, are further topics 
being investigated in ongoing research. These include the improvement of treatment 
plan and dose calculations based on PCD CT images [42], as well as radiobiology 
research [17]. The latter focuses on the improvement of RTs on a cellular level. E.g. 
by testing different dose plans, or various combinations of cancer pharmaceuticals 
with RT. Results are analyzed on a cell culture level and with small animal studies, 
thus a rather early stage of research. PCDs are expected to penetrate radio biological 
research ﬁrst, as comparably small detectors and low ﬂuxes (hence doses) are 
sufﬁcient. Current commercially available devices are already suited for these 
applications. 
4.2 
Direct Applications 
Direct applications of PCDs for RT are majorly focusing on in-beam patient 
imaging, as part of image guided RT. The main approach is to image the treatment 
area of the patient during the therapy. Ideally this includes healthy and tumor tissue, 
as well as the beam allowing to image the location of the beam and the progress of 
the therapy. Currently this is realized with the MV imagers of modern RT devices.

Photon Counting Detectors: Applications in Radiotherapy
285
However, image quality is still inferior to conventional devices, thus requiring 
the kV imagers with the corresponding X-ray source and additional patient dose. 
Nonetheless, in-beam patient imaging, enables to correct for major deviations from 
the intended treatment plan while it is being carried out, leading to higher efﬁcacy, 
lower doses and side effects. 
Common deviations that occur during treatment divide into two categories. 
The ﬁrst category is concerning alignment deviations, which describe the relative 
difference between the actual beam location and intended location noted in the 
treatment plan. Such difference may be caused by misalignment of the RT device, 
patient positioning, anatomical changes or sudden patient movements. Alignment 
deviations have direct impact on the treatment efﬁcacy and therapy side effects. 
Therefore, great efforts are put on reducing these deviations. Patient imaging with 
direct and in-transmission geometry allows to improve these deviations. Ultimately, 
this technique should be used to update the patient diagnostic images, with the goal 
to render additional exams (CT, MRI, PET, kV imager, etc.) unnecessary. PCDs are 
investigated to improve the in-beam MV imager, as mentioned earlier. 
The second category of deviation compared to a treatment plan concerns the 
prescribed dose. Each RT, session and irradiation angle is calculated to provide 
the maximum dose to the tumor region, while keep minimal dose to the healthy 
tissue. An accurate dose veriﬁcation during treatment is however difﬁcult and often 
not possible as discussed in Sect. 2). Dosimeters would need to be placed in the 
tumor and healthy tissues to measure the actual dose. Such devices, however are not 
tissue equivalent and are further changing the delivered dose to the tissue they are 
embedded in. As the absorbed dose by the dosimeter is missing from the prescribed 
dose. This maybe insigniﬁcant compared to the prescribed dose, but may also 
accumulate to a noticeable deviation from the treatment plan over all sessions. A 
way out of this are in-beam measurements of the transmission spectrum after the 
patient, enabling the determination of the currently delivered dose at the beam focal 
point. A delivered dose can be reasonably well estimated, based on previous patient 
images (CT, MRI, etc.) and updated anatomical information obtained through 
alignment veriﬁcation (as described above). This is done to some extend using the 
MV imagers, however additional and external dose monitors are still required. An 
improvement has been reported using dual energy images [44]. Employing PCDs for 
this task, as the next logical step, allows to improve the dose calculations depending 
on the spectral resolution. The amount of energy bins required for a reasonable 
accurate dose determination (10 [18]) may be beyond the reach of the less than< 8 energy 
bins of PCDs for CT that are currently developed [6], however should improve with 
future generations. 
4.2.1 
Realtime Dosimetry for Boron Neutron Capture Therapy 
The following example is supposed to help the reader, widen the mind for 
unconventional ideas of how PCDs can be used to improve RT.

286
A. Winkler
An application that requires the PCDs is BNCT. In-treatment and real-time 
dosimetry is an essential component for this therapy’s general acceptance. As the 
dose of the neutron active component Superscript 1010B is a function of time and is inﬂuenced by 
the patient anatomy and current state of health. The efﬁcacy of the therapy greatly 
depends on irradiating the patient only when the tumor cells have a nominal load of 
Superscript 1010B, while the surrounding tissues have signiﬁcant lower load (European protocols 
follow a ratio of 3.5:1 for tumor to healthy tissue). The optimal time when this 
ratio has been achieved and when it has fallen below this threshold ratio, needs 
to be measured in real-time. Specialized PCD panels as described in this chapter, 
can be used to measure this ratio. A geometry similar to SPECT, can be used for 
this purpose and has been proposed by several research groups [31, 33, 43, 45]. 
Tomographic images can be obtained with this technique, based on the amount of 
boron neutron capture (BNC) reactions that occurred in the patient. The nuclear 
reaction 
Superscript 10 Baseline upper B left parenthesis n comma alpha right parenthesis Superscript 7 Baseline upper L i Superscript asterisk Baseline right arrow 7 upper L i Superscript asterisk Baseline plus gamma10B(n, α)7Li∗→7Li∗+ γ
creates a prompt gamma (PG) photon of 478 keV for 94% of the BNC reactions. 
A PCD with reasonable energy resolution can measure these photons and calculate 
the delivered dose directly from the number of photons that were measured. From 
the point of the photon energy, this could be already achieved with SPECT or PET 
detectors. The key where PCDs are required is to distinguish the PG photons created 
through the BNC reaction, from the neutron and photon background [31, 43]. 
Compared to the rest of the spectrum, is the BNC signal quite small. Furthermore, 
is it with 478 keV very closely located to the 511 keV annihilation peak. Therefore, 
a detector needs to be able to resolve both signals in order to count the number 
of BNC reactions correctly. In addition, complex shielding structures are required 
to shield the neutrons of the therapy and their gammaγ background [43]. These however, 
create further gammaγ and X-ray photons through secondary emissions of the shielding 
materials themselves, leading to increased patient dose and further increase of 
the background spectrum as well as scatter counts at the detector. In particular 
annihilation events contribute to this problem. Therefore, a detector that is to be 
used in for BNCT, should be designed according to the requirements noted in 
Sect. 3. Hence, lightweight and inefﬁcient. This leads to lower overall detection, 
but also an improved background spectrum, that allows to better distinguish the 
annihilation from the BNC events. Another possibility to improve the signal from 
the BNC reaction is to measure a related nuclear reaction. In particular the cadmium 
neutron capture (CdNC) reaction is of interest, assuming a CdTe, CdZnTe, or similar 
based PCD is used. The natural isotope Superscript 113113Cd undergoes a nuclear capture and decay 
reaction, if it has captured a neutron, however inside the detector itself. The resulting 
PG photon from this reaction, at 558 keV, is easy to detect as it is the photon with the 
highest production probability and substantially more neutrons hit the detector than 
PGs from the BNC reaction. An imaging protocol would ﬁrst establish a baseline 
of CdNC events, without Superscript 1010B being administered to the patient and then image the 
patient once Superscript 1010B has been administered. This leads to a decrease in of CdNC events

Photon Counting Detectors: Applications in Radiotherapy
287
at the detector, because some neutrons were converted by the Superscript 1010B in the tumor. With 
some scaling factor, this difference represents the number of BNC reactions and 
thus the dose in the patient [1]. This task can only be achieved with dedicated PCDs 
with several energy bins. 
5 
Further Reading 
General 
Gibbons, J. P., Dernoski, N., McGuire, S., Murphy, D. (Eds.). (2019). Khan’s the 
physics of radiation therapy (6th edn.). New Delhi: Wolters Kluwer (India) Pvt. 
Ltd. ISSN: 978-93-89335-92-7. Rs. 11,000/- (Online). 
Podgorsak, E. B. (2005). Radiation oncology physics. International Atomic Energy 
Agency Vienna, Non-serial Publications. ISBN 92-0-107304-6. https://www.iaea. 
org/publications/7086/radiation-oncology-physics 
History 
Linz, U. (2011). From X-rays to Ion beams: A short history of radiation therapy 
(PDF). Ion Beam Therapy. Biological and Medical Physics, Biomedical Engineer-
ing (vol. 320, p. 6, 1st edn.). Berlin: Springer. https://doi.org/10.1007/978-3-642-
21414-1_1. ISBN 978-3-642-21413-4. 
Dosimetry and Traceability 
International Atomic Energy Agency. (2016). Accuracy requirements and uncer-
tainties in radiotherapy. IAEA Human Health Series No. 31, IAEA, Vienna (2016) 
Requirements to Detectors in Radiotherapy 
Schmidt, O., Kraus, T., et al. (2016). PbS quantum dot based hybrid-organic 
photodetectors for X-ray sensing. Organic Electronics (vol. 33, pp. 201–206). ISSN 
1566-1199. https://doi.org/10.1016/j.orgel.2016.03.023 
Iniewski, K. Advanced materials for radiation detection. Cham: Springer. ISBN 
978-3-030-76461-6. https://doi.org/10.1007/978-3-030-76461-6 
Johns, H., Bates, L., Epp, E., et al. (1951). 1,000-Curie Cobalt-60 units for radiation 
therapy. Nature, 168, 1035–1036. https://doi.org/10.1038/1681035a0 
References 
1. Alexander, W., Hanna, K., Vappu, R., et al. (2015). Prompt gamma and neutron detection in 
BNCT utilizing a CdTe detector. Applied Radiation and Isotopes, 106, 139–144. http://dx.doi. 
org/10.1016/j.apradiso.2015.07.040 
2. Alexidis, P., Karatzoglou, S., Dragoumis, D., et al. (2020). Late results of a randomized trial on 
the role of mild hypofractionated radiotherapy for the treatment of localized prostate cancer. 
Journal of Cancer, 11(5), 1008–1016. https://doi.org/10.7150/jca.37825. PMID: 31956347; 
PMCID: PMC6959068.

288
A. Winkler
3. Arazi, L., Cooks, T., Schmidt, M., Keisari, Y., & Kelson, I. (2010). The treatment of solid 
tumors by alpha emitters released from (224)Ra-loaded sources-internal dosimetry analysis. 
Physics in Medicine and Biology, 55(4), 1203–1218. https://doi.org/10.1088/0031-9155/55/4/ 
020 
4. Badea, C. T., Clark, D. P., Holbrook, M., et al. (2019). Functional imaging of tumor vasculature 
using iodine and gadolinium-based nanoparticle contrast agents: A comparison of spectral 
micro-CT using energy integrating and photon counting detectors. Physics in Medicine and 
Biology, 64(6), 1–27. 
5. Badea, C. T., Clark, D. P., Alphin, A., et al. (2022). Co-clinical photon counting CT research for 
multi-contrast imaging. In Proceedings of SPIE 12304, 7th International Conference on Image 
Formation in X-Ray Computed Tomography, 123040G. https://doi.org/10.1117/12.2646399 
6. Ballabriga, R., et al. (2020). Photon counting detectors for x-ray imaging with emphasis on CT. 
IEEE Transactions on Radiation and Plasma Medical Sciences, 5(4), 422–440. https://doi.org/ 
10.1109/TRPMS.2020.3002949 
7. Berger, M., Bauser, M., Frenzel, T. et al. (2017). Hafnium-based contrast agents for X-ray 
computed tomography. Inorganic Chemistry, 56(10), 5757–5761. https://doi.org/10.1021/acs. 
inorgchem.7b00359 
8. Binwei, L., Feng, G., Yiwei, Y., et al. (2021). FLASH radiotherapy: History and future. 
Frontiers in Oncology, 11, 4–5. https://www.frontiersin.org/articles/10.3389/fonc.2021.644400 
9. Brown, D. A., Chadwick, M. B., Capote, R. et al. (2018). ENDF/B-VIII.0: The 8th major 
release of the nuclear reaction data library with CIELO-project cross sections, new standards 
and thermal scattering data. Nuclear Data Sheets, 148, 1–142. 
10. DeWerd, L. A., Ibbott, G. S., Meigooni, A. S., et. al. (2011). A dosimetric uncertainty 
analysis for photon-emitting brachytherapy sources: Report of AAPM task group no. 138 and 
GEC-ESTRO. Medical Physics, 38(2), 782–801. https://doi.org/10.1118/1.3533720. PMID:  
21452716; PMCID: PMC3033879. 
11. Duriseti, S., Kavanaugh, J., Goddu, S., et al. (2021). Spatially fractionated stereotactic body 
radiation therapy (Lattice) for large tumors. Advances in Radiation Oncology, 6(3), 100639. 
https://doi.org/10.1016/j.adro.2020.100639 
12. Dyk, J. V., et al. (2020). A retrospective of cobalt-60 radiation therapy: “The atom bomb 
that saves lives”. https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=& 
cad=rja&uact=8&ved=2ahUKEwiQsoqO3ISBAxX4KxAIHaPTDIAQFnoECBQQAQ&url= 
https%3A%2F%2Famos3.aapm.org%2Fabstracts%2Fpdf%2F166-58831-15631646-171798-
1721147678.pdf&usg=AOvVaw3GPsNzJOGYxgKrgjCNcV1D&opi=89978449 
13. Fernandez-Palomo, C., Chang, S., & Prezado, Y. (2022). Should peak dose be used to prescribe 
spatially fractionated radiation therapy? A review of preclinical studies. Cancers, 14, 3625. 
https://doi.org/10.3390/cancers14153625 
14. Ferrero, V., Fiorina, E., Morrocchi, M., et al. (2018). Online proton therapy monitoring: 
Clinical test of a Silicon-photodetector-based in-beam PET. Science Reports, 8, 4100. https:// 
doi.org/10.1038/s41598-018-22325-6 
15. Grubé, E. H. (1933). Priority in the therapeutic use of X-rays. Radiology, 21, 156–162. 
16. Hirose, K., Konno, A., Yoshimoto, S., et al. (2019). 1135P - Updated results of a phase II study 
evaluating accelerator-based boron neutron capture therapy (AB-BNCT) with borofalan(10B) 
(SPM-011) in recurrent squamous cell carcinoma (R-SCC-HN) and recurrent and locally 
advanced non-SCC (R/LA-nSCC-HN) of the head and neck. Annals of Oncology, 30(suppl. 
5), v460. https://doi.org/10.1093/annonc/mdz252.027 
17. Hu, X., Zhong, Y., Yang, K., et al. (2022). Photon counting detector-based multi-energy cone 
beam CT platform for preclinical small animal radiation research. Proceedings of SPIE 12304, 
7th International Conference on Image Formation in X-Ray Computed Tomography, 123042R. 
https://doi.org/10.1117/12.2647036 
18. Iwasaki, A., Kimura, S., Sutoh, K., et al. (2011). A convolution/superposition method using 
primary and scatter dose kernels formed for energy bins of X-ray spectra reconstructed as 
a function of off-axis distance: A theoretical study on 10-MV X-ray dose calculations in 
thorax-like phantoms. Radiological Physics and Technology, 4, 203–215. https://doi.org/10. 
1007/s12194-011-0125-2

Photon Counting Detectors: Applications in Radiotherapy
289
19. Kawabata, S., Suzuki, M., Hirose, K., et al. (2021). Accelerator-based BNCT for patients with 
recurrent glioblastoma: A multicenter phase II study. Neuro-Oncology Advances, 3(1), 1–9. 
https://doi.org/10.1093/noajnl/vdab067 
20. Kiyanagi, Y., Sakurai, Y., Kumada, H., et al. (2019). Status of accelerator-based BNCT projects 
worldwide. AIP Conference Proceedings, 2160, 050012. https://doi.org/10.1063/1.5127704 
21. Kokurewicz, K., Brunetti, E., Curcio, A. et al. (2021). An experimental study of focused very 
high energy electron beams for radiotherapy. Communications Physics, 4, 33. https://doi.org/ 
10.1038/s42005-021-00536-0 
22. Koukourakis, G., Kelekis, N., Armonis, V., et al. (2009). Brachytherapy for prostate cancer: 
A systematic review. Advances in Urology, 2009, 327945, 11pp. https://doi.org/10.1155/2009/ 
327945 
23. Lambert, J. W., Sun, Y., Stillson, C., et al. (2018). An Intravascular Tantalum Oxide-based CT 
Contrast Agent: Preclinical evaluation emulating overweight and obese patient size. Radiology, 
289(1), 103–110. https://doi.org/10.1148/radiol.2018172381 
24. Leena, K., Tiina, S., Hanna, K., et al. (2021). Boron neutron capture therapy in the treatment of 
locally recurred head-and-neck cancer: Final analysis of a phase I/II trial. International Journal 
of Radiation Oncology Biology Physics, 82(1), e67–e75. 
25. Locher, G. L. (1936). Biological effects and therapeutic possibilities of neutrons. The American 
Journal of Roentgenology Radium Therapy, 36, 1–13. 
26. Maitreyee, N. (2001). Portal imaging. The British Journal of Radiology, 274(885), 789–804. 
https://doi.org/10.1259/bjr.74.885.740789. PMID: 11560826. 
27. Maitreyee, N. (2021). Secondary radiation in ion therapy and theranostics: A review. Frontiers 
in Physics, 8, 1–8. https://doi.org/10.3389/fphy.2020.598257 
28. Marco, D., & Katia, P. (2020). Radioactive beams in particle therapy: Past, present, and future. 
Frontiers in Physics, 8, 1–9. https://doi.org/10.3389/fphy.2020.00326 
29. Mascia, A. E., Daugherty, E. C., Zhang, Y., et al. (2023). Proton FLASH radiotherapy for 
the treatment of symptomatic bone metastases: The FAST-01 nonrandomized trial. JAMA 
Oncology, 9(1), 62–69. https://doi.org/10.1001/jamaoncol.2022.5843 
30. Mathis, C. A., Jones, R. M. Joseph, & Chasko, H. (1986). Overall radio-HPLC design. In D. 
M. Wieland, M. C. Tobes, & T. J. Manger (Eds.), Analytical and chromatographic techniques 
in radiopharmaceutical, chemistry. New York: Springer. https://doi.org/10.1007/978-1-4612-
4854-5_6 
31. Minsky, D. M., Valda, A. A., Kreiner, A. J., et al. (2009). Experimental feasibility studies on 
a SPECT tomograph for BNCT dosimetry. Applied Radiation and Isotopes, 67(7–8), S179– 
S182. 
32. Montague, M. E., Delzer, C., Wen, X., et al. (2020). Radiation hardness characterization of 
LKH-5 scintillating glass. Nuclear Instruments and Methods in Physics Research Section A: 
Accelerators, Spectrometers, Detectors and Associated Equipment, 982, 164551. https://doi. 
org/10.1016/j.nima.2020.164551 
33. Munck af Rosenschöld, P. M., Verbakel, W. F. A. R., Ceberg, C. P., et al. (2001). Toward 
clinical application of prompt gamma spectroscopy for in vivo monitoring of boron uptake in 
boron neutron capture therapy. Medical Physics, 28(5), 787. 
34. Nag, S. (2004) High dose rate brachytherapy: Its clinical applications and treatment guide-
lines. Technology in Cancer Research & Treatment, 3(3), 269–287. https://doi.org/10.1177/ 
153303460400300305 
35. Nakamura, Y., Higaki, T., Kondo, S., et al. (2022). An introduction to photon-counting detector 
CT (PCD CT) for radiologists. Japanese Journal of Radiology, 41, 266–282. https://doi.org/10. 
1007/s11604-022-01350-6 
36. Particle Therapy Co-Operative Group. (2022). An organisation for those interested in proton, 
light ion and heavy charged particle radiotherapy. Retrieved Feb 5, 2023 from https://www. 
ptcog.ch/index.php/ 
37. Podder, T. K., Buzurovic, I., Galvin, J. M., et al. (2008). Dynamics-based decentralized control 
of robotic couch and multi-leaf collimators for tracking tumor motion. In IEEE International 
Conference on Robotics and Automation, Pasadena (pp. 2496–2502). https://doi.org/10.1109/ 
ROBOT.2008.4543588

290
A. Winkler
38. Roessl, E., & Proksa, R. (2007). K-edge imaging in x-ray computed tomography using multi-
bin photon counting detectors. Physics in Medicine & Biology, 52(15), 4679. https://doi.org/ 
10.1088/0031-9155/52/15/020 
39. Sauli, S., Mika, K., Marjut, T., et al. (2013). Boron neutron capture therapy (BNCT) in Finland: 
Technological and physical prospects after 20 years of experiences. Physica Medica, 29(3), 
233–248. 
40. Slatkin, D. N. (1991). A history of boron neutron capture therapy of brain tumours. Postulation 
of a brain radiation dose tolerance limit. Brain, 114, 1609–1621. 
41. Symons, R., Krauss, B., Sahbaee, P., et al. (2017). Photon-counting CT for simultaneous 
imaging of multiple contrast agents in the abdomen: An in vivo study. Medical Physics, 44(10), 
5120–5127. 
42. Taasti, V. T., Hansen, D. C., Michalak, G. J., et al. (2018). Theoretical and experimental 
analysis of photon counting detector CT for proton stopping power prediction. Medical 
Physics, 45, 5186–5196. https://doi.org/10.1002/mp.13173 
43. Tooru, K., Yoshinori, S., & Masayori, I. (2000). A noninvasive dose estimation system for 
clinical BNCT based on PG-SPECT—Conceptual study and fundamental experiments using 
HPGe and CdTe semiconductor detectors. Medical Physics, 27(9), 2124. 
44. Vaniqui, A., Schyns, L. E. J. R., Almeida, I. P., et al. (2017). The impact of dual energy CT 
imaging on dose calculations for pre-clinical studies. Radiation Oncology, 12, 181. https://doi. 
org/10.1186/s13014-017-0922-9 
45. Verbakel, W. F. A. R., & Stecher-Rasmussen, F. (1997). A γ -ray telescope for on-line 
measurements of low boron concentrations in a head phantom for BNCT. Nuclear Instruments 
and Methods in Physics Research Section A, 394(1–2), 163–172. 
46. Wikipedia Contributors. (2023). Proton therapy, Wikipedia. Retrieved Feb 5, 2023 from https:// 
en.wikipedia.org/wiki/Proton_therapy#cite_note-SOBP-3 
47. Wikipedia Contributors. (2023). Neutron capture therapy of cancer, Wikipedia. Retrieved Feb 
5, 2023 from https://en.wikipedia.org/wiki/Neutron_capture_therapy_of_cancer 
48. Yan, W., Khan, M. K., Wu, X., et al. (2019). Spatially fractionated radiation therapy: History, 
present and the future. Clinical and Translational Radiation Oncology, 20, 30–38. https://doi. 
org/10.1016/j.ctro.2019.10.004. PMID: 31768424; PMCID: PMC6872856. 
49. Yutaka, M., Chihiro, H., Masamitsu, I., et al. (1989). Treatment of malignant melanoma by 
single thermal neutron capture therapy with melanoma-seeking 10B-compound. The Lancet, 
334(8659), 388–389. 
50. Zaorsky, N. G., Ohri, N., Showalter, T. N., et al. (2013). Systematic review of hypofractionated 
radiation therapy for prostate cancer. Cancer Treatment Reviews, 39(7), 728–736. https://doi. 
org/10.1016/j.ctrv.2013.01.008 
51. Zentai, G. (2011). Comparison of CMOS and a-Si ﬂat panel imagers for X-ray imaging. In 
2011 IEEE International Conference on Imaging Systems and Techniques, Batu Ferringhi, 
Malaysia (pp. 194–200). https://doi.org/10.1109/IST.2011.5962217

Index 
A 
Alpha particle detector, 262, 284 
Application speciﬁc integrating circuit (ASIC), 
17, 22, 28, 31, 32, 34, 39, 41, 98, 99, 
101, 103, 104, 111–128, 141, 150, 
155–177, 200–202, 205, 258 
B 
Boron neutron capture therapy (BNCT), 276, 
277, 285–287 
C 
Cadmium Telluride (CdTe), v, 6, 16, 17, 30, 
67, 99, 179–211, 258, 286 
Cadmium Zinc Telluride (CdZnTe/CZT), v, 
4–6, 8, 9, 16, 17, 23, 39–67, 68, 76, 81, 
82, 90, 99, 155–177, 179–211, 286 
Calibration, 33, 41, 101, 103, 105, 106, 142, 
158, 228, 233–241, 244, 245, 259, 278, 
283 
Characterization at micron scale, 69 
Charge collection efﬁciency, 44, 68 
Charge integrating detector, 17–22 
Charge sharing, 14, 27–36, 40, 41, 58–63, 113, 
114, 118, 120–124, 127, 128, 237, 240 
Charge-sharing correction, 32–36, 114, 118, 
120–124, 127 
Charge transport in semiconductors with 
defects, 29 
CMOS Front-end electronics, 257, 258 
Compton spectrometer, 199, 202, 225–246 
Compton telescope, 199, 228, 230–232, 240, 
241 
Crew dosimetry, 257 
CsI(Tl), 96–99, 101–104, 106 
D 
Detector physics, 252 
Digital ASIC, 39, 41 
Dosimetry, 257, 260, 261, 276–278, 285–287 
E 
Energy integrating detectors (EID), 280 
Energy reconstruction, 14, 33, 35, 254, 260, 
261 
Energy resolution, 16, 36, 39, 67, 68, 95–106, 
156, 160, 172, 173, 183, 202, 228–230, 
234–237, 239, 243, 262, 284, 286 
F 
Full model and reduced data models, 81–85 
H 
High-Luminosity LHC (HL-LHC), 129–153 
High-purity germanium (HPGe), 40, 67, 183, 
184, 188, 190, 199, 225, 226, 228–236, 
238–246 
Hybrid pixel detectors, 17, 22–24, 27, 29, 35, 
111 
© The Editor(s) (if applicable) and The Author(s), under exclusive license to 
Springer Nature Switzerland AG 2024 
C. Hansson, K. (Kris) Iniewski (eds.), X-ray Photon Processing Detectors, 
https://doi.org/10.1007/978-3-031-35241-6
291

292
Index 
I 
Imager, 111, 185–191, 193, 196–206, 225–246, 
271, 272, 279, 280, 283–285 
Ionizing radiation effects, 271, 272, 280 
L 
Low-noise CSA, 24 
M 
Microchannel plate, 111–112, 121, 125, 127, 
188 
Miniaturization, 253, 257 
Monolithic pixel detector, 1, 17, 22–24 
O 
On-chip hardware algorithms, 28 
P 
Particle telescope, 253–257, 261–264 
Photon counting, v, 17, 19, 27–36, 111–128, 
269–287 
Photon counting detectors (PCD), 19, 27–36, 
269–287 
Physics based machine learning model, 69, 90, 
91 
Pixelated detector, 13, 21, 40, 42, 128, 155, 
156, 190, 199 
Pixel detector, v, 1, 11–14, 17, 22–24, 27–29, 
31, 35, 111, 112, 257–264, 282 
Pixel readout chip, 129–153 
Polarimeter, 206–207, 239 
R 
Radiation detector characterization, 69 
Radiation therapy (RT), 270–285 
Room-temperature semiconductor, 67–91, 188, 
190, 199 
S 
Sensor physics, 2–17 
Silicon drift detectors (SDDs), 96–103 
Single photon counting detectors, 27–36 
Soft gamma-ray, 202, 204 
Spaceﬂight, 180–184, 188, 190, 196, 198–202 
Space radiation, 252, 257, 264 
Sub-pixel position resolution, 40, 47, 49–54, 
63 
Sub-pixel resolution, 52, 53, 63 
T 
Telescope, 96, 185–188, 194, 195, 197–199, 
202, 205, 210, 211, 228, 230–232, 238, 
240, 241, 245, 253–257, 261–263 
X 
X-ray, 1, 27, 71, 96, 128, 141, 155, 180, 243, 
250, 271 
X-ray detector, v, 7, 11, 22, 32, 183, 185

