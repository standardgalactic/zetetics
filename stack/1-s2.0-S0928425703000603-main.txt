Cortical connections and early visual function:
intra- and inter-columnar processing q
Ohad Ben-Shahar, Patrick S. Huggins, Tomas Izo 1, Steven W. Zucker *
Department of Computer Science and Interdisciplinary Neuroscience Program, Yale University, P.O. Box 208285, New Haven, CT USA
Abstract
While it is widely assumed that the long-range horizontal connections in V1 are present to support contour integration, there has
been only limited consideration of other possible relationships between anatomy and physiology (the horizontal connections) and
visual function beyond contour integration. We introduce the possibility of other relationships directly from the perspective of
computation and diﬀerential geometry by identifying orientation columns in visual physiology with the (unit) tangent bundle in
diﬀerential geometry. This suggests abstracting early vision in a space that incorporates both position and orientation, from which
we show that the physiology is capable of supporting a number of functional computations beyond contour integration, including
texture-ﬂow and shading-ﬂow integration, as well as certain relationships between them. The geometric abstraction emphasizes the
role of curvature, which necessitates a coupled investigation into how it might be estimated. The result is an elaboration of layer-
to-layer interactions within an orientation column, with non-linearities possibly implemented by shunting inhibition. Finally, we
show how the same computational framework naturally lends itself to solving stereo correspondence, with binocular tangents
abstracting curves in space.
 2003 Published by Elsevier Ltd.
Keywords: Computational neuroscience; Horizontal connections; Visual cortex; Shunting inhibition; Perceptual organization
1. Introduction
Orientation provides the basis for organizing much of
visual cortex and provides the foundation for visual
information processing. An examination of receptive
ﬁeld structure shows how the neurons in V1 form a
position + orientation map of the visual ﬁeld [19].
Roughly speaking, recordings along a short tangential
(interblob) penetration reveal a collection of cells with
about the same receptive ﬁeld centers but with shifts in
orientation preference, while normal penetrations reveal
cells with similar orientation and position preferences
but diﬀerent receptive ﬁeld sizes (or spatial frequency
selectivity). Taken together these observations deﬁne an
array of orientation columns which, combined with eye
of origin, provide a basic representation for visual in-
formation processing; see Fig. 1.
The resulting hypercolumns are not independent.
There exist long-range horizontal interactions between
them, which greatly enlarges the domain of possibilities
for information processing. The basic question is: which
early visual information processing tasks take place
within columns, and which between?
One such task is edge detection, and it is widely be-
lieved that the long-range horizontal connections sup-
port the sensory integration necessary for this. The
nature of the evidence supporting this belief is reviewed
in the next section. However, less analysis has been
applied to the question of determining which tasks
comprise sensory integration, and it is on this latter
question that we concentrate in this paper. Assembling
estimates of local orientation (within columns) into long
curves (between columns) is clearly one such task, but
this is not unique; there are several other tasks that also
arise naturally in early vision, all of which, we shall
show, are consistent with the available data on long-
range horizontal integration.
q Research supported by AFOSR and DARPA.
* Corresponding author.
E-mail addresses: ben-shahar@cs.yale.edu (O. Ben-Shahar), hug-
gins@cs.yale.edu
(P.S.
Huggins),
tomas@mit.edu
(T.
Izo),
zuc-
ker@cs.yale.edu (S.W. Zucker).
1 Current address: Artiﬁcial Intelligence Laboratory, MIT, Cam-
bridge MA.
0928-4257/$ - see front matter  2003 Published by Elsevier Ltd.
doi:10.1016/j.jphysparis.2003.09.004
Journal of Physiology - Paris 97 (2003) 191–208
www.elsevier.com/locate/jphysparis

This paper is primarily computational. We ﬁrst de-
velop a computational theory of curve detection to il-
lustrate that there is more to this task than is normally
presupposed. We also use this opportunity to introduce
the conceptual thread that runs through the paper: the
use of diﬀerential-geometric ideas to articulate theories
of sensory integration. We then sketch how these ideas
can be extended for the analysis of texture, shading, and
binocular information. Particular types of sensory inte-
gration arise for each of these tasks, although the gen-
eral form remains invariant.
The computational ideas have a natural expression in
physiological terms, and we will use the intra-columnar
processing to develop local representations and inter-
columnar processing to integrate them into coherent
wholes. Some of the functional roles in which the long-
range horizontal connections could be involved are quite
unexpected, in that they do not appear related to curve
integration without the analysis provided.
More detailed issues arise throughout the discussion,
such as the role of certain non-linearities in information
processing. We also relate these to biology, at both a
biophysical level (implementing the non-linearities with
shunting inhibition) and at a detailed anatomical level
(elaborating intra-columnar processing across layers).
While evidence is provided to demonstrate that the
above claims are well-founded computationally, in our
current state of understanding any attempt to reduce
such abstract models to physiological circuits must
necessarily involve a degree of speculation. This said, we
feel the time is right to start contributing such ideas to
the neurophysiological community. Our hope is that
they will broaden both the discussion around, and the
experimental perspective on, sensory integration.
1.1. Background: co-linear facilitation and curve integra-
tion
Finding the boundaries of objects is one of the central
problems of early visual information processing (Fig. 2),
and cells with oriented receptive ﬁelds are often inter-
preted as local edge detectors, or at least as components
of a system for local edge detection. That a system is
required follows from the fact that many of the local
responses are noisy or ambiguous: they may arise from
an accidental alignment of viewing geometry and light-
ing, from a specularity, from noise in the sensory pro-
cess, or from a myriad of other causes. The resolution of
these noisy, ambiguous responses is sought from con-
text, with those cells responding consistently along an
edge facilitating one another to enhance the correct re-
sponses while eliminating the noisy, random ones.
This is perhaps the most basic type of contour inte-
gration, and it is classical. The Gestalt psychologists
argued for a form of orientation good continuation nearly
75 years ago [46], and it was suggested nearly 20 years
ago that the anatomical substrate for such facilitation
could be the long-range horizontal connections [33].
The long-range horizontal axons eﬀectively connect
cells in the superﬁcial layers of nearby orientation col-
umns, so to test the above hypothesis the orientation
preferences of the cells involved must be known. Two
experimental paradigms have been developed. First, to
test for contextual eﬀects, one can isolate a target unit
with a particular orientation preference, and then plot
how its activity is modulated by stimuli in the surround.
This paradigm was ﬁrst used to demonstrate inﬂuences
from beyond the classical receptive ﬁeld [1,34], and is
still being applied in technically advanced ways [26,28].
Many such studies show that the target cell’s ﬁring is
facilitated by surround stimuli that have about the same
orientation as the one preferred by the target cell. While
Fig. 2. Two sample images suggest the range of problems for early
vision, even when the task is limited to static, monocular, monochrome
imagery. Both the sheet and the duck illustrate the importance of
boundary and shading information for supporting three-dimensional
interpretations, but closer examination reveals how subtle the ques-
tions can become. Where, for example, should the boundaries be
drawn on the sheet? Or how can edge and shading information com-
bine to indicate that the duck’s neck occludes its back rather than the
other way around?
L
R
Layer 1
Layer 6
Fig. 1. The standard Hubel–Wiesel ‘‘ice cube cartoon’’ shows how
cortex is organized so that each local retinotopic area is covered by
receptive ﬁelds spanning orientations (tangential penetration), size
(normal penetration), and eye-of-origin.
192
O. Ben-Shahar et al. / Journal of Physiology - Paris 97 (2003) 191–208

this technique can provide detailed characterization of
the inﬂuences on an individual cell, it is not suitable for
gathering population distributions, it is stimulus de-
pendent, and the system-wide functional links it reveals
are more diﬃcult to interpret in terms of the physical
connections between neurons.
Alternatively, studies that are more suitable for
population statistics have used optical imaging and an-
atomical tracing to reveal the entire connectivity struc-
ture of cells (Fig. 3). Here optical imaging techniques are
used to ‘‘colour’’ (an image of) the cortex with the ap-
proximate orientation preference of the underlying cells.
Tracers are then injected into a cell and mark its ter-
minals. The distribution of these terminals can then be
plotted against the ‘‘colour’’ (or rough orientation
preference) of the domain in which they terminate to
yield a complete characterization of cells connectivity
structure in the orientation domain [7,31].
Physiological evidence of both types is accumulating,
and a summary of the evidence is that the majority of
such facilitory interactions are iso-orientational; i.e.,
between
cells
with
similar
orientation
preferences
[26,31,43]. Taken back to the edge detection problem,
many researchers observe that this is essentially what the
orientation good continuation hypothesis would predict,
and it suggests that a form of co-linear facilitation un-
derlies edge detection.
This basic model for edge detection––ﬁltering by
operations analogous to linear, oriented receptive ﬁelds
followed by co-aligned facilitation––can be implemented
and tested on natural images. Thus far this is only an
outline of an approach, however, because variations in
ﬁlters, their interactions, and the detection process re-
main unspeciﬁed. Researchers in computer vision have
considered these issues, and one of the most widely used
edge detectors is that of Canny [8]. This system eﬀec-
tively implements the above outline, and consists of an
initial ﬁltering stage, with ﬁlters very similar in form to
simple-cell receptive ﬁelds, followed by a facilitory
(hysteresis) stage that implements a type of co-aligned
facilitation. Allowing an analogy to driving a car along
the edge, the output of the detector is essentially the
strongest set of initial edge detector responses that
continue the edge in the same orientation in which it was
(recently) going. Of course, the continuation can be
adjusted by several parameters, intuitively varying
the ‘‘inertia’’ with which an edge continues. Both the
‘‘driving history’’ and the strength of responses aﬀect the
ﬁnal result.
The Canny detector can be evaluated on an image to
assess performance, and researchers unfamiliar with
computer vision are often surprised at the results.
However, edge detection is not an easy problem as it
may initially appear. Diﬀerent values of the parameters
illustrate the variations that typically occur, and it is
instructive to examine them (Fig. 4). Among the prob-
lems that emerge: boundaries can be broken apart or,
what is perhaps worse, proper but physically discon-
nected boundary segments can be inappropriately con-
nected. Note in particular how diﬀerent values can
bridge between nearby (but totally diﬀerent) parts of
edges by stressing how the inertia parameter jumps
across gaps. Unfortunately, there is no agreement on
how to select the parameters so that these problems do
not arise.
The experience with edge detection in computer vi-
sion reveals some of the types of questions that can arise
from an information processing perspective. First, for
the initial operators, there is the question of how to
obtain local estimates of orientation that provide a
consistent bridge between the image and the scene. This
must not induce incorrect linkages between disparate
curves, even when they are close in the image, because
this implies incorrect physical structure for objects in the
world. Second, there is the question of orientation good
continuation: What does this mean in terms of physical
object properties and how should nearby oriented re-
sponses facilitate one another so that they induce pre-
cisely the right amount of facilitation, co-linear when
appropriate and curved when not?
Thirdly, diﬀerent types of questions arise from
physiology. For example, if the majority (as opposed to
the entirety) of connections are between (approximately)
Fig. 3. A cartoon of the relationship between orientation columns and
long range horizontal connections as revealed in optical imaging
combined with anatomical tracing. Diﬀerent colours represents the
diﬀerent orientation columns. The white dots represent the region
where an anatomical tracer is injected. The black dots represent axonal
terminals coloured by this process. As is typically found, short range
interactions span all possible orientations, while long range interac-
tions tend to concentrate in cortical regions that share similar orien-
tation speciﬁcity with the injection site.
O. Ben-Shahar et al. / Journal of Physiology - Paris 97 (2003) 191–208
193

iso-oriented cells, are the ‘‘outliers’’ to this simply noise?
Is the correct abstraction for the majority co-linear fa-
cilitation, or is something else going on? And, how
should the majority be deﬁned; in particular, what is the
proper spread in the distribution of connections in the
orientation domain?
Finally, there are questions that arise from the in-
terface between physiology and computer vision: are
horizontal facilitations only participating in edge de-
tection, or might they also be implementing other
functional roles? If so, what might these be and are they
consistent with the given data about connections?
We shall consider each of these groups of questions in
this paper. To set the stage, we note that a closer ex-
amination of the physiological data suggests the story is
more complex than co-aligned contour facilitation (Fig.
5). For example, while Kapadia et al. [26] stress iso-
orientation facilitation, they also provide examples of
facilitation between cells with up to 50 orientation
diﬀerence (their Fig. 10). The distributions provided by
Bosking et al. [7] clearly show non-negligible portion of
anatomical connections even between cross orientations
(their Fig. 6). And from the ﬁndings of Ts’o et al. [43] it
is evident that there are facilitory functional interactions
between iso-oriented cells whose receptive ﬁelds are
parallel to one another, rather than co-aligned (see top
pair in their Fig. 5). Interpreting such pairs as partici-
pating in collinear contour integration is awkward. In-
stead, we shall argue that such exceptions are naturally
explained from a series of computational tasks, includ-
ing curved contour integration, texture, shading, and
stereo processing.
To develop this argument, we shall have to consider
how early visual information processing can be struc-
tured on orientation hypercolumns. We do this in two
stages. First, we brieﬂy review a model that captures
enough of the structure of the columnar architecture
that it can be related to neurophysiology and neuro-
anatomy, but is suﬃciently abstract that it can be ana-
lyzed mathematically and computationally. We then
proceed to the analysis of curves, textures, shading, and
stereo in it, and how these relate back to (certain aspects
of) scene structure. As we show, facilitory interactions
can be involved in all of them, but co-aligned facilitation
by itself is insuﬃcient. Diﬀerential geometry, and
Fig. 4. Geometric problems in edge detection using the Canny operator (Matlab implementation). The diﬀerent edge maps depict the results of the
edge detection process using diﬀerent parameter values. Note that at some levels non-boundaries are signaled as edges while at other levels genuine
edges are missed or broken. Often proper but distinct boundaries are inappropriately connected (e.g., the boundary of the duck’s back and the one of
its neck).
Fig. 5. The fact that the majority of connections are between iso-ori-
entation columns does not necessarily imply co-aligned facilitation;
similarly, orientation good continuation does not necessarily imply
only iso-orientation interactions. Three diﬀerent pairs of cells are
shown, with position corresponding to the relative placement of re-
ceptive ﬁelds and the short bar corresponding to the preferred orien-
tation of the cell. (Left) Co-aligned facilitation is a natural implication
of boundary detection and a common interpretation of iso-orientation
interactions. (Center) An ‘‘outlier’’ to co-aligned facilitation, with
about a 50 rotation over a short (retinotopic) distance. This example
is not iso-orientation facilitation although it reﬂects a possible recep-
tive ﬁeld arrangement along a coherent boundary curve. (Right) An
‘‘outlier’’ to co-aligned facilitation that is iso-orientation facilitation.
While this example may contribute to the majority of iso-orientation
interactions, it cannot be interpreted as serving curve integration. The
question is whether this and other ‘‘outliers’’ can support useful visual
information processing.
194
O. Ben-Shahar et al. / Journal of Physiology - Paris 97 (2003) 191–208

curvature in particular, is necessary to understand why
co-aligned facilitation is dominant but not unique; there
are an important (and predictable) number of non-
co-aligned facilitory inﬂuences that play key processing
roles.
2. The columnar machine
We begin by re-drawing the ice-cube model to illus-
trate the possibility of geometric information process-
ing. We focus on columns with the same monocular
speciﬁcity and drop deep layers. We depict the orienta-
tion hypercolumns as vertical ﬁbres distributed over a
retinotopic array (the tilted plane) and we display the
orientation preference of cells within each hypercolumn
as oriented segments (Fig. 6). When organized in this
fashion, a geometric view of processing emerges, in
which the ﬁbre of orientations at each position in the
retinotopic array abstracts the orientation hypercolumn,
and the arrangement of neighbouring ﬁbres suggests an
architecture that is specialized to support interaction
between orientations. All orientations in nearby col-
umns are clearly in a position to interact.
Mathematically we conceptualize this interaction by
thinking of the diﬀerent orientations at each position as
‘‘labels’’ and the measure of activity of each neuron as
the probability that the neuron is signaling the correct
orientation for that retinotopic position. Interactions
are modeled as a compatibility function ðrijðk1; k0Þ in the
top right of Fig. 6) between orientation k0 at position j
with orientation k1 at nearby position i. In game-theo-
retic terms, one can think of this function as represent-
ing the payoﬀthat player i gets by choosing strategy
(label) k1 when player j plays strategy k0. The goal is to
seek an equilibrium for this game. Diagramatically we
illustrate this with the thickness of the orientated bars,
with thicker bars denoting more activity or higher
probability (bottom of Fig. 6). Note that this can be
viewed as a selection process. The initial values are
spread out along each ﬁbre (bottom left, Fig. 6), but the
ﬁnal values concentrate on a single, or a small number,
of distinct orientations (bottom right, Fig. 6).
Dynamics are not shown in this diagram, but are key
to specifying the manner in which abstract computations
map onto networks of real neurons. We have developed
one way to do this, which is consistent with biophysics
at least to low-order. Imagine neurons as players in the
above game, with pure strategies being whether the
neuron
should
depolarize
(spike)
or
hyperpolarize
[36,37]. Modeling neurons as piecewise-linear ampliﬁers,
synapses (compatibilities) as conductances, etc., they
can be placed in the above form. The key idea behind
our model is to consider groups of tightly interconnected
excitatory neurons capable of bringing themselves to
saturation feedback response following a modest initial
Fig. 6. Two re-drawings of the ice-cube model, emphasizing (top) the functional anatomy and (bottom) the processing. A retinotopic array (the tilted
plane) and a sampling of superﬁcial-layer cells drawn (scale not included) on ﬁbres representing hypercolumns. (Top left) Inter-columnar connections
are not only between iso-orientation cells. (Top right) Notation for a game theoretic interpretation of inter-columnar processing; see text for details.
(Bottom) Here cells are drawn as oriented segments to show their orientation preference. The thickness of the orientated bars denotes activity of cells;
initial values in time (bottom left) and then later (bottom right) denote processing in time, which may be viewed as a selection process along each
ﬁbre. Dynamics are not shown.
O. Ben-Shahar et al. / Journal of Physiology - Paris 97 (2003) 191–208
195

aﬀerent bias current. We refer to each such group of
neurons as a clique, and for this the connections can
involve both short-range and long-range interactions.
The basic computation is in two phases, and builds
upon the observed regular spiking behavior of pyrami-
dal cells. Consider a patch of cortex, consisting of
hundreds of thousands of cells. We view this as being
further organized into many times that number of cli-
ques of densely-interconnected neurons, with order-of-
magnitude tens of cells per clique. (Miller and Zucker
calculate 33 cells/clique for orientation hyperacuity
computations.) Initially the cells in this patch are qui-
escent. A computation amounts to activating all the cells
in a single clique to saturation levels, but no others. This
begins, in Phase I, when aﬀerent stimulation produces
single spikes in a majority of the cells in one clique
(those cells can be distributed among many diﬀerent iso-
orientation areas), as well as a certain number of other
cells outside the clique (noise). Because the clique has a
suﬃcient level of excitatory interconnections, all its cells
drive themselves to saturation response levels of about 5
spikes in about 25 ms (end of Phase I), whereas the
initially activated cells outside the clique return to their
resting membrane potentials and do not spike further
(end of Phase II). Thus the clique has been ‘‘retrieved’’,
or the orientation speciﬁed, at each position, and it is
these cliques that deﬁne the equilibrium of the game. See
[38] for further motivation, development, and analysis.
This model of an abstract machine provides a
framework for specifying computations. Given that the
labels at each position represent orientation, what re-
mains is to specify the ‘‘payoﬀs’’ for having, say, a
vertical label at one position, and another vertical label
at the co-aligned position. Specifying such payoﬀs re-
quires building an abstraction for the curve detection
problem, starting with the geometry underlying con-
nections between columns in the superﬁcial layers. This
is followed with discussions of interlayer intra-columnar
processing, stressing ﬁrst some of the non-linearities that
are motivated by our earlier computational demonstra-
tions of Canny edge detection. We then build upon this
foundation by developing the geometry and the corre-
sponding connections for texture and shading analysis,
and for stereo.
3. The curve inference problem
Assume that orientation selectivity deﬁnes a substrate
for representing those tangents that approximate the
curves that bound objects in the scene and that deﬁne
highlights and other surface markings. We now analyze
how long-range horizontal interactions can reduce the
errors inherent in locally estimating tangent orientation.
Orientation change can be used to localize corners and
junctions (as may occur at the point where one object
occludes another in depth), and for the perceptual in-
tegration necessary to connect fragments of the same
contour, e.g., as a result of occlusion or specularities
[49]. Orientation change is also essential for curve de-
tection: it enables us to establish good orientation con-
tinuation and it is the connection between tangents and
curves. The mathematical theory of how tangents in-
teract with one another is provided by diﬀerential geo-
metry.
The interaction between receptive ﬁelds for curve
detection is illustrated in Fig. 7. Diﬀerential geometry
dictates that the interactions must involve curvature [9].
The formal question is how to transport a tangent at one
location to a nearby location. The analysis is not unlike
driving a car, in the following sense. At each instant of
time (that is, position along the curve) the axis of the car
deﬁnes its (tangent) orientation, and the relationship
between the orientation of the car at one instant with
that at the next depends on how much the road bends; in
operational terms, it depends on how much the steering
wheel has to be turned during transport.
The endstopping property of visual cortical neurons
is suﬃcient for representing curvature [10]. (We shall
return to the issue of how this might be developed by
intra-columnar circuitry shortly.) The majority of su-
perﬁcial, interblob orientation selective cells in V1 are
also endstopped to some extent, and these bi-selective
dimensions of orientation and endstopping are precisely
what is required to represent tangent and curvature.
We have used such notions of transport to derive the
horizontal interactions [42,49]; see Fig. 8 . Observe that
they agree with available data that emphasize co-aligned
facilitation [31,39,43] as well as outliers [26]. That is,
most interactions are between cells with approximately
orientation
RF preferred
Curvature based
local model for
good continuation
Receptive field
Incompatible RFs
Compatible overlapping RF
Fig. 7. The problem of receptive ﬁeld interaction. Which tangent (re-
ceptive ﬁeld) continues the curve? Here strict co-aligned facilitation is
clearly inappropriate.
196
O. Ben-Shahar et al. / Journal of Physiology - Paris 97 (2003) 191–208

the same orientation preference, but some (for the
higher values of curvature) involve 50–60 shifts. A
demonstration of the performance for this curvature-
based system is in Figs. 9 and 10.
While it may seem counterintuitive at ﬁrst, it is im-
portant to realize that building curvature directly into
the system predicts a dominance of roughly co-aligned
facilitation as well as the spread of the distribution.
Other models [48] adopt only the zero curvature case,
and do not predict the non-co-linear data. Such results
also question the interpretation of psychophysical data
(e.g., [12]).
Rather than make comparisons with ‘‘intuitive’’ no-
tions of edge, as we did earlier, this example lets us
appeal to the basic mathematics of the situation. Whit-
ney has classiﬁed maps from smooth surfaces into
smooth surfaces [13], and has shown that only two types
of boundary points can occur generically (i.e., without
changing under small changes in viewpoint): the fold
and the cusp (the position where the fold disappears into
the surface). Folds clearly indicate boundaries when
viewed from a given position; in fact, the word implies
that the tangent plane to the surface ‘‘folds’’ away from
the viewer’s line of sight. It is in this sense that they
become singular (the two-dimensional tangent space
collapses to a 1D tangent) and it is in this sense that
boundaries are signalled. These ideas are illustrated in
Fig. 11.
Fig. 8. The geometry of inter-columnar interactions for curves. Co-circularity indicates how consistent a neighbouring tangent is with a given tangent
at the origin (center of display). Since the analysis is local, smooth edge curves can be approximated by their osculating circle, and neighbouring
tangents can be transported along it to ﬁx a measure of mis-match. Our networks select those tangents that minimize such mismatches [20,37]. In
network implementations, the transport results are precomputed and embedded in the connections. A very small mismatch results in an excitatory
connection, and a larger mismatch in an inhibitory one. Three examples of the compatibilities derived from co-circularity are shown. The bars
indicate orientation preference, and all compatibility ﬁelds are with respect to the central neuron (shown at maximal brightness). The brightness for
each bar is the strength of the synapse with the central tangent, white indicating excitatory connections, black indicating inhibitory connections.
Multiple bars at the same position indicate several cells in the same orientation hypercolumn. The connections are intended to model long-range
horizontal interactions. Three cases are shown: co-aligned facilitation, curved a large amount in the negative sense and, curved a small amount.
Notice in particular that most of the excitatory connections are between co-aligned cells, given the loose deﬁnition of alignment commonly used in the
physiological literature (e.g., ±15); however, in the high curvature example there are cases of excitatory connections with 50 relative orientation.
Fig. 9. Results of curve detection using our network, with curvature-based connections (see Fig. 8). (Left) Original image, (center) initial edge tangent
measurements, (right) ﬁnal edge tangents.
O. Ben-Shahar et al. / Journal of Physiology - Paris 97 (2003) 191–208
197

4. Intra-columnar processes
The above example shows that boundaries need not
be (in fact, are rarely) straight. Viewed locally, then, an
approximation to a boundary over a very short distance
is the tangent to the (boundary) curve. Viewed over a
slightly larger neighbourhood, curvature begins to
matter. Thus there are two problems that need to be
addressed: (i) estimating tangents and (ii) estimating
curvature.
Determining tangent directions with linear operators
can be diﬃcult, because diﬀerent types of structure may
fall within a single receptive ﬁeld which would then be
(inappropriately) averaged together. Thus we ﬁrst con-
sider the logical subunits of receptive ﬁelds and a
mechanism to implement the non-linearities among
them. The goal of these non-linearities is to prevent in-
appropriate types of structure from being combined into
erroneous tangent estimates.
These local tangents are then combined to provide
curvature responses, based on the idea that curvature
can
be
viewed
geometrically
as
‘‘deviation
from
straightness’’. Measurements over diﬀerent spatial scales
are utilized in this case. The result is two local circuits
that illustrate the elaboration of function across layers
within a single orientation column. We now sketch each
in turn, including new simulation results for the non-
linearities in tangent estimation.
4.1. Building orientation response through logical subunits
and shunting inhibition
Boundaries that arise from surface folds, as discussed
above, usually imply an intensity diﬀerence in the di-
rection normal to the edge, with a generic dropoﬀin
contrast in a neighbourhood around the edge (we shall
consider this dropoﬀin detail in Section 6). Cracks ap-
pear as dark lines, with a bright-dark-bright contrast
variation normally; while extended highlights can ap-
pear oppositely in contrast. Clearly, around ‘‘edges’’,
there are diﬀerent photometric events in in the direction
normal to the edge [23].
In the tangential direction along an edge, continuity
conditions arise. For the edge to be part of a boundary
curve, locally its tangent must exist (almost everywhere)
which implies that the limit as one point approaches
another along it must exist. This can be realized as
similar contrast signs along an edge element, for exam-
ple.
Linear operators (or cells that combine receptive ﬁeld
subunits linearly) would respond similarly to various
contrast situations. They would respond to both cracks
and edges, and low-contrast edges and complicated
distributions of intensities would all give intermediate
responses. In eﬀect, all of these diﬀerent physical situa-
tions would be mapped into a single response, making
the inverse problem of labeling the type of physical
Fig. 11. The motivation from diﬀerential topology for early vision. (Left) The image of the Klein bottle shows how ‘‘T’’-junctions can arise from
occlusion relationships (e.g., at the top and center of the ﬁgure), and how certain interior edges can end (e.g., where the fold smoothly joins the body).
(Middle) The Canny edge structure is inconsistent with both of these topological observations. Notice how the boundary ‘‘T’’-junction is not
connected, how it smooths the outline, and how the interior folds are blurred into the shading. (Right) Output of the logical/linear operator [23].
Notice how the ‘‘T’’-junctions are maintained, and how the contours end at cusps.
Fig. 10. Performance of our cooperative model for boundary and edge detection and localization. (Left) the sheet edge map and a region of interest.
(Middle) Zoom on the initial edge measurements [23] in the region of interest. (Right) Result of 5 iterations of relaxation labeling [20] with Co-
circularity compatibilities. Note the localization of the edge and the elimination of sparious measurements.
198
O. Ben-Shahar et al. / Journal of Physiology - Paris 97 (2003) 191–208

situation from which the contrast diﬀerence arises un-
tenable.
We have developed a class of non-linear local oper-
ators, called logical/linear operators [22] to conﬁrm such
conditions operationally. Subunit combinators are de-
ﬁned with Boolean conditions testing for the above
photometric and continuity conditions. If the structural
conditions are met, they return the average; if not, they
veto to zero. ‘‘Edge operators’’ are separated from ‘‘line
operators’’, and edge patterns from multiple curves do
not combine to give an artifactual response. These non-
linearities are diﬀerent from the compatibility ﬁelds
above, because they are taking place at much smaller
spatial scales.
We illustrate some of these cases below, but ﬁrst set
up the question of whether this type of non-linear re-
sponse could be found in visual cortical circuits. We now
illustrate one physiologically plausible possibility, be-
ginning with the subunit interactions and then intro-
ducing the non-linearity.
The receptive ﬁelds of pyramidal neurons in layer VI
are comprised of a number of zones, each of which may
correspond, at least conceptually, to the receptive ﬁeld
of a layer V cell which synapses onto the layer VI cell.
This view is supported by a Bolz and Gilbert experiment
[3]: when one of the presynaptic layer V cells is phar-
macologically inactivated, the layer VI cell shows no
response to stimuli presented in the corresponding part
of its receptive ﬁeld. When the layer V neuron is re-
activated, the receptive ﬁeld of the layer VI cell returns
to its original size.
This composite receptive ﬁeld structure is a natural
substrate for logical/linear operator construction. Both
the tangential and the normal components consist of
displaced linear operators joined together using logical/
linear combinators. This is analogous to a number of
layer V pyramidal cells sending axonal projections onto
a layer VI neuron.
With the component construction now in place, logi-
cal/linear responses need a veto mechanism to assure no
output response when at least one of the input condi-
tions is not satisﬁed. Motivated by the demonstration of
shunting inhibition in visual cortex [29], and after
considering several possibilities in simulation, we ex-
ploit this non-linear mechanism to dramatically decrease
the eﬃcacy of excitatory post-synaptic potentials, and
thereby implement the veto. In simulations we approxi-
mated shunting inhibition by decreasing the passive
conductance of the cell membrane [27]. Following Borg-
Graham and coworkers [29], we used a GABA type A
synaptic model that was modiﬁed to increase the post-
synaptic passive conductance by 200% for the duration
of spiking and a short period of time (10 ms) after each
spike. This refractory period corresponded to the reup-
take of the neurotransmitter and the closing of the ionic
channels. Since we are working within the clique model
for the columnar machine (Section 2), it is necessary for
the post-synaptic conductance to remain increased be-
tween the spikes of the interneuron as it was ﬁring at a
high rate during the 3–5 spike burst. Since the soma of
every cell in our model consisted of a single compart-
ment [35], the post-synaptic conductance increase was a
global change. Note that this does not make the model
less realistic: the two excitatory synapses could easily be
proximal to each other as well as proximal to the single
inhibitory synapse.
We now illustrate the construction of a logical/linear
edge operator over a receptive ﬁeld with four subzones,
Response to diﬀerent input cases varies with the pho-
tometric conﬁguration (Fig. 12). In cases B and C the
operator should show no response due to the lack of an
intensity edge. Case D is the optimal case, so the oper-
ator to respond maximally to this case. Case E should
generate a weak response because only the left side of
the receptive ﬁeld contains the optimal stimulus. In case
F, a weak response should be observed because the edge
has opposite contrast. Finally, case G should generate
an intermediate response due to the weak edge in the
right half of the receptive ﬁeld.
While shunting inhibition provides us with a useful
mechanism to implement the non-linear decision step of
the logical/linear operator, the tricky design issue is how
A
B
C
D
E
F
G
with four subzones
Receptive field
Six different inputs to the logical/linear
edge operator
Fig. 12. Logical/linear receptive ﬁeld subunits and experimental stimuli used in our simulations.
O. Ben-Shahar et al. / Journal of Physiology - Paris 97 (2003) 191–208
199

to activate the inhibitory interneuron when some of the
conditions necessary for the operator to respond are not
met. After experimenting with diﬀerent conﬁgurations, a
natural solution emerged by considering both the posi-
tive and negative contrast logical/linear edge operators
at the same time and connecting them in a push–pull
architecture that would enable each of the operators to
inhibit its complement. This idea led to the circuit design
shown in Fig. 13. It is pleasing to observe this interac-
tion between the photometric characterizations at the
functional level and the neuronal characterizations at
the implementation level.
The circuit consists of four layer V pyramidal cells,
two layer VI pyramidal cells and two inhibitory inter-
neurons. Each of the layer V cells corresponds to a
subzone of the composite receptive ﬁeld. The two layer
VI cells represent the responses of the two opposite
logical/linear edge operators. The performance of this
circuit is perhaps best described using an example.
Suppose that the input to the visual ﬁeld is an ideal
positive contrast edge, as in Fig. 12D. Given such input,
the layer V cells corresponding to the top two subzones
of the receptive ﬁeld (subzones 1 and 2 in Fig. 13) will
burst, exciting the top layer VI cell and causing it to
burst as well. At the same time, the activity of these layer
V cells will also excite the left inhibitory interneuron,
which will in turn inhibit the lower layer VI cell. Since,
however, the layer V pyramids corresponding to the
bottom half of the receptive ﬁeld are inactive, the lower
layer VI cell shows minimal activity regardless of the
inhibition. A much more interesting case to examine is
the input pattern shown in Fig. 12G. Since this is not an
ideal edge, the cells monitoring the bottom half of the
receptive ﬁeld will burst, though with a lower frequency
than the cells corresponding to the top half of the ﬁeld.
Fig. 14 shows the results of our simulations. The top
left of Fig. 14 corresponds to the optimal positive con-
trast edge input discussed above. As we can see, the top
layer VI cell responds by bursting at a frequency much
higher than baseline while the bottom layer VI pyramid
shows only baseline activity.
The top right of Fig. 14 shows the results of a sim-
ulation, in which the input was a non-ideal edge such as
in Fig. 12G. We simulated this by exciting the top two
layer V cells with a strong current clamp (1.2 mA) and
injecting the bottom right layer V cell with a weaker but
still substantial current clamp (0.8 mA). The high
frequency activity of the top two layer V cells excited the
left interneuron, which in turn inhibited the bottom
layer VI cell. Had the inhibition not been in place, the
bottom right layer V cell would have driven the bottom
layer VI pyramid to ﬁre at a higher than baseline rate.
The top layer VI cell was excited by the top layer V cells
and ﬁred at a rate substantially higher than baseline.
In the bottom left of Fig. 14, we can see the results of
a simulation with input similar to the pattern in Fig.
12E. The top left and the bottom right layer V cells were
injected with a strong current clamp (1.2 mA). The
bottom right of Fig. 14 shows the results of stimulating
all four layer V cells with a strong input (Fig. 12B).
The simulations illustrate how one cortical circuit can
exhibit logical/linear-like response patterns. The compact
push–pull circuit that gave the two contrasting logical/
linear responses is natural and simple, and is intended as a
ﬁrst demonstration of concept. The eﬀects of synaptic
plasticity must also be considered in more realistic mod-
els, however, since facilitation and depression can pro-
foundly aﬀect the behavior of a cell. Many diﬀerent types
of such synapses have been found in the striate cortex,
e.g., certain tufted layer V pyramidal cells that exhibit
relatively fast frequency dependent depression [32].
We now show how these operators can form the basis
for the curvature response; again the diﬀerences between
‘‘edge’’ and ‘‘line’’ conﬁgurations will play a key role.
pyramidal neuron
interneuron
weak current clamp
excitatory synapse
inhibitory synapse
1                     2
3                    4
Sketch of a logical/linear push-pull circuit
1                                                            2
3                                                           4
Sketch of the corresponding
receptive field with four subzones
Fig. 13. A neural circuit implementing a logical/linear operator.
200
O. Ben-Shahar et al. / Journal of Physiology - Paris 97 (2003) 191–208

4.2. Building up the curvature response
Our earlier scheme for integrating the information
available from nearby tangent estimates is a function of
curvature, but direct measurements of curvature are not
common in the vocabulary of V1 functionality. Never-
theless, it is widely accepted that the (interblob) super-
ﬁcial layer neurons in V1 are often endstopped to some
extent, and these bivariate selectivities for orientation
and endstopping are precisely what we shall utilize in
this subsection.
Dobbins et al. [10] have developed a theory of end-
stopping which equates it to curvature. In its simplest
form, an endstopped operator is constructed by taking
the diﬀerence between the responses of excitatory and
inhibitory component cells. Matching these component
cells for position, receptive-ﬁeld proﬁle, and orientation
tuning, but not with size, results in a response that is
sensitive to curvature. In particular, when the inhibitory
component covers a larger spatial scale than the excit-
atory component the combined response will peak for a
speciﬁc, typically non-zero curvature.
While Dobbins’ analysis assumes that the component
operators are linear (combined via a ‘‘positive part’’
non-linearity to model the base ﬁring rate and to prevent
negatives from combining incorrectly), we now see the
central role of the logical/linear non-linearities––to
guarantee that receptive ﬁelds respond to tangents if and
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
c[0].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
c[1].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
c[2].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
c[5].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
intn[1].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
c[0].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
c[1].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
c[2].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
c[5].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
intn[1].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
c[0].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
c[1].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
c[2].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
c[5].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
intn[1].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
c[0].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
c[1].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
c[2].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
c[5].soma.v(0.5)
0
100
200
300
400
500
-80
-40
0
40
0
100
200
300
400
500
-80
-40
0
40
intn[1].soma.v(0.5)
Fig. 14. Simulation results on the logical/linear circuit shown in Fig. 12. See text for details.
O. Ben-Shahar et al. / Journal of Physiology - Paris 97 (2003) 191–208
201

only if they properly exist within the component recep-
tive ﬁelds. The large ‘‘surround’’ operator component in
the curvature response must arise from a long curve for
it to be meaningful; not from an unrelated series of
fragments. Furthermore, Dobbins et al. [11] have found
that even-symmetry (large) receptive ﬁelds provide an
estimate of the magnitude of the curvature, while odd-
symmetry
surround
operators
provide
information
about the sign of curvature.
4.3. The position-orientation representation
We now take a step back from the circuitry, to il-
lustrate how this geometry is represented in the colum-
nar machine sketched earlier (Fig. 6). As in that ﬁgure,
the diﬀerent orientation possibilities can be viewed as a
structure ‘‘on top of’’ the image, with retinotopic ðx; yÞ
coordinates extended into a third dimension (‘‘height’’)
corresponding to orientation. This orientation axis is
diﬀerent from the x and y axes, because orientation
wraps around 2p with the circle S1 being its domain.
Thus this (position, orientation) space is not modeled as
ðx; y; zÞ, but as ðx; y; hÞ, where h is the tangent angle. A
point in this space is a point in R2  S1.
It is instructive to consider how diﬀerent curves in the
ðx; yÞ plane lift into R2  S1, to understand some of its
advantages for the cortical columnar machine. Not
much happens for a straight line in the plane, which lifts
to a ‘‘horizontal’’ straight line in R2  S1 at a ‘‘height’’
dependant only on the angle h. A smooth, closed curve
in the plane lifts into a smooth, closed curve in R2  S1.
A real diﬀerence arises when we consider curves that are
continuous but with corners. Such events are important
because they could signal a monocular occlusion cue
and as we mentioned ealier, all these discontinuities in
orientation lift into broken curves in R2  S1 (Fig. 15).
In the following we denote it as the ðx; y; hÞ space.
5. The geometry of texture ﬂows
With this understanding of the inference of tangent
maps for individual curves, we move to patterns of
multiple curves. Examples include pinstriped material
and artist’s etchings, animal coats and zebra’s stripes.
For such patterns orientation is distributed over two-
dimensional regions, and as the requirement for perfect
continuations is relaxed we obtain texture ﬂows.
The importance of locally (almost) parallel structure
has been observed psychologically [14,24,44]. In partic-
ular, the human visual system has the tendency to or-
ganize and group parallel structure into coherent units.
Examples include Kanizsa’s ‘‘social conformity of a
line’’ [15,24], and Glass’s random dot moire patterns
[14,41]. In all cases, this organization drastically eﬀects
the interpretation of a scene both in 2D and 3D (e.g.,
[44]).
Informally, texture ﬂows are deﬁned by their orien-
tation content––a dense visual percept characterized by
local parallelism and slowly varying dominant local
orientation. However, texture ﬂows are not simply a
matter of completing a number of almost ‘‘parallel’’
curves, but rather involve dense interpolation of a ﬁeld
of orientations (Fig. 16). This should be compared with
the gap-completion property for curves (e.g., [18,25,47]).
Represented as a scalar orientation function, the local
behavior of the ﬂow is governed to ﬁrst-order by its
gradient. Unfortunately, this quantity does not capture
all of the relevant geometry. As with curves, psycho-
physical evidence suggests that texture ﬂow perception is
linked to curvature [17,30,50,51].
Fig. 15. An illustration of the lift into position ðx; yÞ, orientation ðhÞ space. Three contour fragments from the tangent map in Fig. 5(center) are
highlighted. Notice how the discontinuity in orientation at the 1–2 T-junction is separated, highlighting multiple orientations at the same position, the
natural columnar representation for orientation discontinuities.
Fig. 16. Example of a texture ﬂow and it’s perceptual completion
quality. The wavy surface appears to form a single coherent unit be-
hind the occluders, even though there are a diﬀerent number of line
segments in each visible region (this eﬀect is valid for all but the most
extreme of scales). This demonstrates that orientation is distributed
densely over a region, and that computing texture ﬂows is not simply
the simultaneous completion of a number of ’’parallel’’ curves.
202
O. Ben-Shahar et al. / Journal of Physiology - Paris 97 (2003) 191–208

We model the diﬀerential geometry of texture ﬂows
by applying the frame ﬁeld representation [4,5,52]. A
frame is essentially a local coordinate system attached to
each point in the ﬂow in a natural way; one axis points
in the direction tangential to the ﬂow and the other in
the normal direction. It is this frame that serves as a
local ‘‘piece’’ of a texture ﬂow in the sense that it gen-
eralizes the tangent (which we earlier used as a local
‘‘piece’’ of a curve). It remains to develop an analog to
the osculating circle, or the local curvature, which was
used to transport tangents, and to determine what needs
to be measured locally. (Recall previously, for curves,
local orientation and curvature were measured.)
The geometry of a texture ﬂow is given by the rota-
tion of the Frenet frame as it is displaced a small dis-
tance in an arbitrary direction within the ﬂow. The
resulting structure is modeled by the Cartan connection
equation [40,52]. Since the rotation may vary for dif-
ferent displacement directions, and since two coordi-
nates are required to specify this displacement, it follows
from the connection equation that the local behavior of
a texture ﬂow patch can be fully approximated by two
scalars––two curvatures––which describe the rate of
rotation along two independent directions. Since the
tangential and normal directions are the natural local
basis, we deﬁne both the tangential curvature and the
normal curvature at each point; they represent the gen-
eralization of curvature (for curves) to texture ﬂows and
fully specify the behavior of the ﬂow to ﬁrst order ap-
proximation. To illustrate: for the case of strictly par-
allel straight lines there is no diﬀerence in the orientation
for a displacement in either the tangential or the normal
directions, while in a texture ﬂow composed of nested
circles having the same center the orientation changes
with displacement only in the tangential but not in the
normal direction. On the other hand, a texture ﬂow
composed of straight lines all converging to meet at the
same point (as in images of strictly parallel straight lines
viewed perspectively from almost all view points) has
zero tangential curvature but non-zero normal curvature
everywhere.
Following the discussion in Section 1, it is now clear
that the biological machinery of the primary visual
cortex is capable of measuring the tangential direction,
and thus the (rigidly coupled) normal one as well. Hence
the basic components for representing texture ﬂow
curvatures do exist in V1. While it was argued that
endstopping relates to (tangential) curvature, the rep-
resentation of normal curvature in V1 is still a matter of
speculation. From a computational point of view,
however, we end up with a natural representation for
texture ﬂow based on the tangent, the tangential cur-
vature, and the normal curvature. Unfortunately, earlier
computational eﬀorts have omitted the normal curva-
ture altogether (e.g., [45]).
If the local behavior of the ﬂow is characterized (up
to Euclidean transformation) by a pair of curvatures, it
is natural to conclude that nearby local measurements of
texture ﬂow orientation should relate to each other
based on these curvatures. Put diﬀerently, measuring a
particular curvature pair at a point should induce a ﬁeld
of coherent measurements (i.e., an orientation function)
in the neighbourhood of that point. This ﬁeld, which we
call the texture ﬂow osculating object, generalizes the
osculating circle for curves, and coherence of local
measurements of texture ﬂow can then be determined in
a manner analogous to co-circularity for tangents to a
curve [42] (Fig. 17). For that purpose, we have devel-
oped a unique texture ﬂow osculating object based on
formal notions of good continuations. In ðx; y; hÞ space
Fig. 17. The problem of inferring coherent texture ﬂow both in the image plane (left) and in the lifted space of ðx; y; hÞ (right). Given two nearby
texture ﬂow patches of given curvatures they may or may not be part of the same coherent structure. What aﬀects this coherence is not only the local
orientation of the patches, but their curvatures as well. In ðx; y; hÞ this task can be visualized as associating both texture patches, now represented as
3D points, to the same surface (whose height represents orientation). Here, the two blue patches are coherent and should facilitate each other while
the red one is incompatible to both.
O. Ben-Shahar et al. / Journal of Physiology - Paris 97 (2003) 191–208
203

this object takes the form of a right helicoid [52] and it is
the only geometrical object that does not prefer either of
the two curvatures over the other. Using this object we
then designed compatibility structures to be used in the
columnar machine (Section 2), examples of which are
illustrated in Fig. 18. The same ‘‘neural’’ machinery
equipped with this new set of ‘‘long range horizontal
connections’’ is now able to integrate and infer 2D co-
herent texture ﬂows, as is exempliﬁed in Fig. 19. Indeed,
both this class of connections, as well as the one based
on cocircularity, have now been shown to be biologically
plausible by correctly predicting the distribution of long
range horizontal connections in visual cortex [53].
6. Shading ﬂows and fold-type edges
While texture ﬂows are a generalization of perceptual
organization beyond curves, they are still a somewhat
special class of patterns. It is therefore diﬃcult to un-
derstand why the cortex might have evolved specialized
circuitry for them. We believe an important part of the
answer to this question is that there are other, more
universal perceptual features that share the basic struc-
tural properties of texture ﬂows. Prominent among these
features is the shading ﬂow ﬁeld––the vector ﬁeld of
tangents to the iso-brightness contours (or intensity level
sets) of the gray level image of smooth surfaces [6].
Measured from a shading distribution as opposed to
from surface markings, the shading ﬂow is directly
analogous to the texture ﬂow discussed earlier. Its geo-
metry is a precursor to shape [16], and its interaction
with edge geometry provides useful information for edge
classiﬁcation [21].
When applied to shading ﬂow ﬁelds instead of tex-
tures, a successful organization of coherent ﬂow struc-
ture constrains the geometry of the smoothly curved
surface which gives rise to the scene. The singularities of
the shading ﬂow ﬁeld can arise from shape discontinu-
ities and spectral highlights, and thus its reliable recov-
ery, while preserving its discontinuities and singularities,
is an important step toward the robust interpretation of
shape from shading.
The shading distribution takes on a particular form in
the neighbourhood around an edge. Recall that we
earlier discussed how edges which correspond to object
boundaries arise when the tangent plane to a surface
‘‘folds’’ out of sight. Such edges are distinct in appear-
ance in that they enjoy a stable pattern of shading with
respect to the edge. This shading pattern is illustrated in
Fig. 18. Three examples of texture ﬂow compatibility structures for various tuning values for orientation and curvatures. Bright/dark indicates
excitatory/inhibitory connections. (Left) Horizontal orientation tuning with both curvatures equal zero. (Center) Vertical orientation tuning positive
normal curvature. (Right) Vertical orientation tuning positive tangential curvature.
Fig. 19. Example of texture ﬂow computation with the columnar machine. In this piece of a ﬁngerprint image the perceptual structure is overwhelmed
by the noisy measurements of local orientation (left). Based on the right helicoidal model for good continuation discussed in the text (see [5] for
details), the columnar machine can extract the perceptually coherent structure (right) in few iterations of relaxation labeling.
204
O. Ben-Shahar et al. / Journal of Physiology - Paris 97 (2003) 191–208

Fig. 20. As smooth surfaces fold away from the viewer,
the shading ﬂow ﬁeld becomes tangent to the edge. At
the same time, the fold side of the edge ‘‘cuts’’ the
background scene, which implies that the background
cannot exhibit this regularity in general. Cuts, therefore,
are those kinds of boundaries in which the shading
distribution is transverse to the edge. This is fortunate as
it naturally suggests a type of ‘‘ﬁgure’’ boundary, be-
cause it shows which is the occluding side and which is
the occluded side of an edge [21]. This complements
earlier work which classiﬁed shadow edges on the basis
of the shading ﬂow ﬁeld [6].
Since shading information shares the same geometri-
cal characteristics of texture ﬂow, it opens up the possi-
bility that shading ﬂows may be signaled by cells that are
orientation selective and tuned to low spatial frequencies
(those tuned to higher spatial frequencies would localize
edges, as before). The geometrical analysis described in
this section thus suggests two additional kind of com-
putations and orientation-based interactions in the co-
lumnar machine. Firstly, the computation of coherent
shading ﬂow can be done through texture-ﬂow-like in-
teractions (see Section 5) between orientation-selective
cells of low frequency, and the result can be used for the
interpretation of shape from shading. Secondly, the in-
teraction between shading and boundaries for edge
classiﬁcation may be achieved though interaction be-
tween low spatial frequency cells and high spatial fre-
quency cells. Thus, following the ideas above, signaling a
fold-type edge could follow from an iso-orientation in-
teraction between low spatial frequency (shading) and
high spatial frequency (edge) cells, while cut-type edges
requires interactions between cells of diﬀerent orienta-
tions. This is illustrated in Fig. 21.
Fig. 20. Illustration of shading ﬂow in the neighbourhood of an edge. When a shaded surface (left) is viewed such that an edge appears, the shading
ﬂow ﬁeld (right) takes on diﬀerent appearances depending on the nature of the edge. A fold occurs (top) when the surface bends smoothly away from
the viewer (the typical occlusion case), and the shading ﬂow ﬁeld appears tangent to the edge. At a cut, the surface is discontinuous (or occluded), and
shading ﬂow is generally non-tangent to the edge.
Fig. 21. Example of shading ﬂow relaxation and the possible interaction between the ﬂow and the edges to signal either fold- or cut-type edges. Note
how the initial shading ﬂow (left) of the marked region of interest (center) becomes fully coherent after few iterations of relaxation labeling based on
the texture ﬂow compatibilities (right), and how the relationship of the relaxed shading to the active high frequency cells (in white) indicates a fold on
the left and a cut to the right. Indeed, the surface to the left of the edge occludes the one to its right, as is clearly seen in the image itself.
O. Ben-Shahar et al. / Journal of Physiology - Paris 97 (2003) 191–208
205

7. The geometry of stereo correspondence
As our ﬁnal example of interactions between orien-
tations we turn to stereo. Thus far we have been con-
sidering interactions between orientations within cells
driven by one eye; we now consider both of the ocular
dominance bands. Abstractly this implies an important
construction for the columnar machine: the ‘‘product’’
of two machines, one for the left eye and the other for
the right eye. Mathematically this suggests working in
the product space ðR2  S1Þ  ðR2  S1Þ and designing
compatability structures that also take a ‘‘product’’
form.
We have developed such a product structure and an
algorithm for computing stereo correspondences [2,54]
that generalizes the tangent ﬁelds for plane curves to
those for general space curves. A curve in three space
can be described by the relationships between its tan-
gent, normal and binormal [9]. As the curve moves
across depth planes, there exists a positional disparity
between the projection of the curve in the left image and
the projection in the right image. However, there also
exist higher order disparities, in particular ones in ori-
entation. It is these types of relationships that can be
capitalized upon when solving the correspondence
problem. Rather than correlating left/right image pairs,
we require that there exists a curve in three space whose
projection in the left and right image planes is com-
mensurate with the locus of tangent pairs, and their
orientation, in a neighbourhood of the proposed match.
For the stereo correspondence problem, we are given
two edge maps (one for the left camera and one for the
right); each of these will be consistent (in the sense that
they satisfy the monocular transport constraint); our goal
now is to make them consistent with a local approxima-
tion to the space curve from which they project. Again, an
osculating object is required and the one that we have
derived [2] takes the form of a helix in ðx; y; zÞ. Based in
this model it is possible to construct the compatibility
ﬁelds that are required to facilitate responses of tangent
pairs that are consistent with the same space curve. Ex-
amples of two compatibility ﬁelds are shown in Fig. 22
while the computation that results in using these struc-
ture in the columnar machine is illustrated in Fig. 23.
To conclude this section we observe that once again
an early vision task, this time stereopsis, can be com-
puted using the columnar machine when equipped with
the appropriate orientation-based connectivity struc-
ture. Once again, these structures suggest a majority of
connections between cells of similar orientations. Yet,
connections between cells of signiﬁcantly diﬀerent ori-
entations are intrinsic, not accidental. The only new
aspect in connectivity that is required by the stereo
compatibilities is links between monocular cells to
–2.5
–2
–1.5
–1
–0.5
0
0.5
1
1.5
2
2.5
x 10–4
–4
–3
–2
–1
0
1
2
3
4
5 x 10–4
x
y
–2.5
–2
–1.5
–1
–0.5
0
0.5
1
1.5
2
2.5
x 10–4
–4
–3
–2
–1
0
1
2
3
4
x 10–4
x
y
–3
–2
–1
0
1
2
3
4
x 10–4
–4
–3
–2
–1
0
1
2
3
4
5 x 10–4
x
y
–3
–2
–1
0
1
2
3
4
x 10–4
–4
–3
–2
–1
0
1
2
3
4
5 x 10–4
x
y
Projection in left image
Projection in right image
Fig. 22. Two examples of facilitory compatibility structures for stereo are shown. Note how they incorporate both position and orientation disparity;
this is especially evident in the lower pair of compatibility ﬁelds which are tuned for non-zero values of curvature.
206
O. Ben-Shahar et al. / Journal of Physiology - Paris 97 (2003) 191–208

binocular ones. Interestingly, some evidence showing
such interactions already exist in the literature [31].
8. Conclusions
We have argued for a diﬀerential geometric approach
to vision, and have shown how this can be supported by
the columnar architecture of visual cortex. Our com-
putational model comprises non-linear local orientation
measurements and the reﬁnement of these measure-
ments using context, provided by curvature, through a
cooperative network. We have demonstrated how the
local orientation measurements could be computed by
intra-columnar neural circuitry, via shunting inhibition.
The observed physiology of inter-columnar connections
suggests a more complex model for contour integration
than co-aligned facilitation; we hypothesize that the
connections implement curvature, which follows from
the computational considerations of our model. Finally,
we have shown how the diﬀerential geometric frame-
work naturally extends to handle the analysis of texture,
shading, and stereo correspondence, all using the same
basic columnar architecture. We hope that these devel-
opments will provide a basis for future neurophysio-
logical experiments.
Acknowledgement
We thank S. Alibhai for the stereo computations.
References
[1] J. Allman, F. Miezin, E. McGuinness, Stimulus speciﬁc responses
from beyond the classical receptive ﬁeld: Neurophysiological
mechanisms for local-global comparisons in visual neurons, Ann.
Rev. Neurosci. 8 (1985) 407–430.
[2] S. Alibhai, S.W. Zucker, Contour-based correspondence for
stereo, in: Computer Vision––ECCV 2000, Lecture Notes in
Computer Science 1842, June 2000.
[3] J. Bolz, C.D. Gilbert, Generation of end-inhibition in the visual
cortex via interlaminar connections, Nature 320 (1986) 362–
365.
[4] O. Ben-Shahar, S.W. Zucker, Flowing towards coherence: on the
geometry of texture and shading ﬂow, in: IEEE Computer
Society Workshop on Perceptual Organization in Computer
Vision, 2001.
[5] O. Ben-Shahar, S.W. Zucker, On the perceptual organization of
texture and shading ﬂows: from a geometrical model to coherence
computation, in Proc. Computer Vision and Pattern Recognition,
2001, pp. 1048–1055.
[6] P. Breton, S.W. Zucker, Shadows and shading ﬂow ﬁelds, in: Proc.
Computer Vision and Pattern Recognition, 1996.
[7] W.H. Bosking, Y. Zhang, B. Schoﬁeld, D. Fitzpatrick, Orienta-
tion selectivity and the arrangement of horizontal connections in
the tree shrew striate cortex, J. Neurosci. 17 (6) (1997) 2112–2127.
[8] J. Canny, A computational approach to edge detection, IEEE
Trans. Pattern Anal. Machine Intell. 8 (6) (1986) 679–698.
[9] M. do Carmo, Diﬀerential Geometry of Curves and Surfaces,
Prentice-Hall, Inc., 1976.
[10] A. Dobbins, S.W. Zucker, M.S. Cynader, Endstopped neurons in
the visual cortex as a substrate for calculating curvature, Nature
329 (1987) 438–441.
[11] A. Dobbins, S.W. Zucker, M.S. Cynader, Endstopping and
curvature, Vision Res. 29 (1989) 1371–1387.
[12] D. Field, A. Hayes, R. Hess, Contour integration by the human
visual system: evidence for a local association ﬁeld, Vision Res. 33
(1993) 173–193.
Fig. 23. Example of a depth map computation using the stereo compatibility structures in the columnar machine. The edge depth map is color coded
(see bar on the right) and for clarity we show a magniﬁed detail.
O. Ben-Shahar et al. / Journal of Physiology - Paris 97 (2003) 191–208
207

[13] M. Golubitsky, V. Guillemin, Stable Mappings and their Singu-
larities, Springer-Verlag, 1973.
[14] L. Glass, Moire eﬀect from random dots, Nature 223 (5206) (1969)
578–580.
[15] A. Galli, A. Zama, Untersuchungen €uber die wahrnehmung
ebener geometrischen ﬁguren die ganz oder teilweise von anderen
geometrischen ﬁguren verdecket sind, Zeitschrift fur Psychologic
123 (1931) 308–348.
[16] B.K.P. Horn, M.J. Brooks (Eds.), Shape from Shading, MIT
Press, Cambridge, MA, 1989.
[17] Y. Hel Or, S.W. Zucker, Texture ﬁelds and texture ﬂows:
sensitivity to diﬀerences, Spat. Vision 4 (2/3) (1990) 131–139.
[18] F. Heitger, R. von der Heydt, O. Kubler, A computational model
of neural contour processing: ﬁgure-ground segregation and
illusory contours, in: Proc. From Perception to Action Con.,
1994, pp. 181–192.
[19] D. Hubel, T. Wiesel, Functional architecture of macaque monkey
visual cortex, in: Proc. R. Soc. London Ser. B, vol. 198, 1977,
pp. 1–59.
[20] R. Hummel, S.W. Zucker, On the foundations of relaxation
labeling processes, IEEE Trans. Pattern Anal. Mach. Intell. 6
(1983) 267–287.
[21] P.S. Huggins, S.W. Zucker. How folds cut a scene, in: Proc. 4th
Int. Workshop on Visual Form, 2001.
[22] L. Iverson, S.W. Zucker, Logical/linear operators for measuring
orientation and curvature, Technical Report TR-CIM-90-06,
McGill Research Center for Intelligent Machines, Montreal,
Canada, July 1990.
[23] L.A. Iverson, S.W. Zucker, Logical/linear operators for image
curves, IEEE Trans. Pattern Anal. Mach. Intell. 17 (10) (1995)
982–996.
[24] G. Kanizsa, Organization in Vision: Essays on Gestalt Perception,
Praeger Publishers, 1979.
[25] B.K. Kimia, L. Prankel, A.M. Popescu, Euler spiral for shape
completion, in: IEEE Computer Society Workshop on Perceptual
Organization in Computer Vision, 1999.
[26] M.K. Kapadia, M. Ito, C. Gilbert, G. Westheimer, Improvement
in visual sensitivity by changes in local context: parallel studies in
human observers and in vl of alert monkeys, Neuron 15 (1995)
843–856.
[27] C. Koch, Biophysics of Computation: Information Processing in
Single Neurons, Oxford University Press, New York, 1999.
[28] M.K. Kapadia, G. Westheimer, C.D. Gilbert, Dynamics of spatial
summation in primary visual cortex of alert monkey, Proc. Natl.
Acad. Sci. USA 96 (21) (1999) 12073–12078.
[29] Y. Fregnac, L.J. Borg-Graham, C. Monier, Visual input evokes
transient and strong shunting inhibition in visual cortical neurons,
Nature 393 (1998) 369–373.
[30] N.K. Link, S.W. Zucker. Sensitivity to corners in ﬂow patterns,
Technical Report TR-85-4R, Computer Vision and Robotics
Laboratory, Department of Electrical Engineering, McGill Uni-
versity, April 1985. Image texture ﬂow.
[31] R. Malach, Y. Amir, M. Harel, A. Grinvald, Relationship
between intrinsic connections and functional architecture revealed
by optical imaging and in vivo targeted biocytin injections in
primate striate cortex, Proc. Natl. Acad. Sci. USA 90 (1993)
10469–10473.
[32] H. Markram, A network of tufted layer 5 pyramidal neurons,
Cereb. Cort. 7 (6) (1997) 523–533.
[33] G. Mitchison, F. Crick, Long axons within the striate cortex: their
distribution, orientation, and patterns of connections, Proc. Natl.
Acad. Sci. USA 79 (1982) 3661–3665.
[34] M. Maﬀei, A. Fiorentini, The unresponsive regions of visual
cortical receptive ﬁelds, Vision Res. 16 (1976) 1131–1139.
[35] Z.F. Mainen, T.J. Sejnowski, Inﬂuence of dendritic structure on
ﬁring pattern in model neocortical neurons, Nature 382 (1996)
363–366.
[36] D.A. Miller, S.W. Zucker, Eﬃcient simplex-like methods for
equilibria of nonsymmetric analog networks, Neural Computat. 4
(1992) 167–190.
[37] D.A. Miller, S.W. Zucker, Computing with self-excitatory cliques:
a model and an application to hyperacuity-scale computation in
visual cortex, Neural Computat. 11 (1999) 21–66.
[38] D.A. Miller, S.W. Zucker, Cliques, computations, and computa-
tional tractability, Pattern Recog. 22 (2000) 535–542.
[39] J. Nelson, B. Frost, Intracortical facilitation among co-oriented,
co-axially aligned simple cells in cat striate cortex, Exp. Brain Res.
61 (1985) 54–61.
[40] B. O’Neill, Elementary Diﬀerential Geometry, Academic Press,
1966.
[41] K. Prazdny, Some new phenomena in the perception of glass
paterns, Biol. Cybern. 53 (1986) 153–158.
[42] P. Parent, S.W. Zucker, Trace inference, curvature consistency,
and curve detection, IEEE Trans. Pattern Anal. Mach. Intell. 11
(8) (1989) 823–839.
[43] D.Y. Ts’o, C.D. Gilbert, T.N. Wiesel, Relationships between
horizontal interactions and functional architecture in cat striate
cortex as revealed by cross-correlation analysis, J. Neurosci. 6 (4)
(1986) 1160–1170.
[44] J.T. Todd, F.D. Reichel, Visual perception of smoothly curved
surfaces from double-projected contour patterns, J. Exp. Psych.:
Human Percept. Perform. 16 (3) (1990) 665–674.
[45] P.W. Verbeek, L.J. van Vliet, J. van de Weijer, Improved
curvature and anisotropy estimation for curved line bundles, in:
ICPR, 1998, pp. 528–533.
[46] M. Wertheimer, Laws of organization in perceptual forms, in:
W.D. Ellis, (Ed.), A source book of Gestalt Psych., Routledge &
Kegan Paul Ltd., 1955, pp. 71–88.
[47] L.R. Williams, D.W. Jacobs, Stochastic completion ﬁelds: A
neural model of illusory contour shape and salience, Neural
Comput. 9 (4) (1997) 837–858.
[48] S.C. Yen, L. Finkel, Salient contour extraction by temporal
binding in a cortically-based network, Adv. Neural Inform.
Process. Syst. 9 (1997).
[49] S.W. Zucker, A. Dobbins, L. Iverson, Two stages of curve
detection suggest two styles of visual computation, Neural
Comput. 1 (1989) 68–81.
[50] O. Ben-Shahar, S.W. Zucker, Curvature and the perceptual
organization of texture ﬂows. Annual meeting of the Vision
Sciences Society, Saratoga, Florida, 2002.
[51] O.
Ben-Shahar,
S.W.
Zucker,
Sensitivity
to
curvatures
in
orientation-based texture segmentation, Vision Research (in
press).
[52] O. Ben-Shahar, S.W. Zucker, The perceptual organization of
texture ﬂows: a contextual inference approach, IEEE Transac-
tion on Pattern Analysis and Machine Intelligence 24 (4) (2003)
401–417.
[53] O. Ben-Shahar, S.W. Zucker, Geometrical computations explain
projection patterns long range horizontal connections in visual
cortex, Neural Computation (in press).
[54] G. Li, S.W. Zucker, A diﬀerential geometrical model for contour-
based stereo correspondence, Proc. of IEEE Workshop on
Variational, Geometric and Level set Methods in Computer
Vision, Nice, France, 2003.
208
O. Ben-Shahar et al. / Journal of Physiology - Paris 97 (2003) 191–208

