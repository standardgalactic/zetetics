 
 
Potts Models 
and Protein Covariation
Structural Bioinformatics II
Temple University
Allan Haldane
Ron Levy Group

 
 
Outline
The Evolutionary Origins of Protein Sequence Variation
●Contents of the Pfam database
●Protein Evolution     (tour of concepts & current ideas)
●Protein Fitness, Marginal Stability, Compensatory mutations
Using Protein-sequence-variation profitably
●Correlated Mutations and Structural Contacts
●Potts Models: Theory
●Review of Potts Model Results
Protein Families and their Evolution – A Structural perspective. Annual Review of Biochemistry  2005
Bridging the physical scales in ev. biology: from protein sequence space to fitness of organisms and populations COSB 2017
Potts Hamiltonian models of protein co-variation, free energy landscapes, and evolutionary fitness COSB  2017 

 
 
Pfam
●Pfam is a collection of HMMs and MSAs of many 
protein families
●Uses HMMs to detect new sequences
●http://pfam.xfam.org/
●16,306 curated protein families (folds)
●23 million protein sequences
●7.6 billion residues
collected from all branches of life

 
 
Pfam website 
example
●All fibronectin sequences in 
the alignment have the same 
“beta sandwich” fold.
●~65,000 different sequences
●~100 residues long
How similar do you think the 
sequences are (% identical aa)?
Fibronectin type III
Seed
Matches

 
 
Fibronectin Type III domain MSA
WebLogo
MSA
Seq.
ID
Average sequence identity: 19%

 
 
Fibronectin has 
quite typical 
diversity

 
 
The Protein Universe
●Protein sequence→ structure mapping is highly 
degenerate
●Typically ~30-40% identity per fold, as low as 8-9% (equal 
to random sequences)
●Space of all possible sequences is 
●Space of all sequences sharing a common folded structure 
may be                                  (rough intuition/guess) 
(Poses a challenge for HMM methods: Below 20% identity, HMMs have 
difficulty predicting whether sequence share a fold. This is known as the 
“twilight zone” of sequence similarity)
Twilight zone of protein sequence alignments. Rost, Protein Eng Des Sel (1999)
How much of protein sequence space has been explored by life on Earth? Dryden et al. J Royal Society Interface (2008)

 
 
●Many authors suggest there are only 1000 to 10,000 
existing protein folds across all life
●16,384 families in Pfam
●1086 folds, 3464 families in SCOP
●(compare to 20,000 protein-genes in human genome)
The Protein Universe
Protein Families and their Evolution – A Structural perspective. Annual Review of Biochemistry  2005
Estimating the total number of protein folds. Govindarajan et al.  Proteins: Struct. Func. Bioinfo. 1999
Expanding protein universe and its origin from the Biological Big Bang PNAS 2002
The Protein Folds as Platonic Forms. Denton et al. Journal of Theoretical Biology 2002

 
 
Evolutionary origins of proteins
4 genomes with multiple variants of the same protein fold:
Tree of 512 kinases in the
human genome (paralogs) 
New variants/copies 
are generated by
●Gene duplication (paralog)
●Speciation (ortholog)
Tree of c-SRC kinase 
across species (orthologs)
(usually same function)
(often different function)

 
 
How is sequence diversity generated?
 Observations
More closely related species have fewer 
differences per (orthologous) protein
% difference in Hemoglobin 
between related species
The Neutral Theory of Molecular Evolution. Kimura 1983

 
 
“Rate constant hypothesis” or “Molecular Clock”
(Zuckerland & Pauling 1965)
(fossil record)
# of substitutions per site
p = percent final sequence difference
K = number of past substitution events
Technical detail (correction for repeated substitutions)
substitutions occur at a constant rate
How is sequence diversity generated?
 Observations

 
 
●Proteins appear to accumulate substitutions at a constant 
rate, usually about 1 substitution per site per billion years
How is sequence diversity generated?
 Observations

 
 
●Different proteins have different evolutionary rates
●Proteins appear to accumulate substitutions at a constant 
rate, usually about 1 substitution per site per billion years
How is sequence diversity generated?
 Observations

 
 
●Different proteins have different evolutionary rates
●Different parts of a single protein have different evolutionary rates
●Proteins appear to accumulate substitutions at a constant 
rate, usually about 1 substitution per site per billion years
Why is there variation in evolutionary rate?
Causes of evolutionary rate variation among protein sites. Nature Reviews Genetics (2016)
How is sequence diversity generated?
 Observations

 
 
Summary
●Many possible sequences lead to same fold
●Proteins in a common family/fold accumulate substitutions 
at a constant rate over time

 
 
How is sequence diversity generated?
Why is there so much variation? 
How do substitutions happen?
Evolutionary forces acting on proteins:
●Natural Selection    (selective pressures above)
●Mutation
●Genetic Drift
Selective pressure (Natural Selection) on protein sequences:
●function
●stability (folding)
●(non-)aggregation
●...
Bridging the physical scales in evolutionary biology: from protein sequence 
space to fitness of organisms and populations COSB 2017

 
 
Why is there so much variation? 
How do substitutions happen?
How is sequence diversity generated?
Evolutionary forces acting on proteins:
●Natural Selection    (selective pressures above)
●Mutation
●Genetic Drift
Selective pressure (Natural Selection) on protein sequences:
●function
●stability (folding)
●(non-)aggregation
●...
Bridging the physical scales in evolutionary biology: from protein sequence 
space to fitness of organisms and populations COSB 2017
Many mutations affect stability
(Functional site is often small % of protein)

 
 
Protein Folding Biochemistry
(understanding selective forces in protein evolution)
Folded
Unfolded
Reality is more complicated:
●disordered state
●molten globule state
●native state (folded)
●decoy state
●hyper-stability
Two-State model of Folding

 
 
Variations in Stability
●Different sequences will have (slightly) 
different stabilities
●Protein are “marginally stable”
●Possible explanations:
●Hyper-stability is penalized?
●More unstable sequences/mutations?
●Stability related to overall “fitness”
●Stability varies as proteins evolve
Distribution of stabilities
Missense meanderings in sequence space: a biophysical view of protein evolution DePristo, Weinreich, Hartl. Nat Rev Genet 2005 

 
 
●Compensatory Mutations/Substitutions
Eg, a destabilizing substitution is compensated for by a stabilizing substitution
●Epistasis
When the effect of a mutation (eg, on stability) depends on the identity of 
other residues. 
CTL escape and viral fitness in HIV/SIV infection  Front. Microbiol 2010
destabilizing
stabilizing

 
 
Protein Evolution
Evolutionary forces acting on proteins:
●Natural Selection    (previous few slides)
●Mutation
●Genetic Drift           (next 2 slides)
●Recombination    (not discussed)
Why do deleterious (stability-reducing) mutations occur?
Why aren’t proteins optimally stable?
Quick intro to the Wright-Fisher Model & Population Genetics
?

 
 
The Wright-Fisher Model
Simulation 1
Simulation 2
Time
Cyan genotype
has “fixed”
Population of 10 individuals with different (equally fit) genotypes. (asexual)
Next generation 
formed by random 
sample (with 
replacement) of 
previous generation
(without natural selection)
“Genetic Drift” = fluctuations in allele frequencies. It causes new alleles 
to “fix” in the population even without any natural selection.
Need to understand how new variants arise at the population level

 
 
The Wright-Fisher Model
Two allele case, with selection
Conclusion:
Genetic Drift can cause a new mutant to “fix” even if it’s deleterious (s < 0).
 “Natural Selection” modelled 
by assigning a weight 
(fitness) to each genotype, 
and performing a weighted 
sample to get the next 
generation.
Say we assign 
●Old genotype has a weight of  1
●Mutant individual has a weight of  1+s
Then mutant’s fixation probability =
Deleterious
Beneficial
Neutral
s = selection coefficient
N = population size
(Kimura’s fixation probability)
Scenario: All individuals in population have the same protein, but one individual mutates

 
 
Mutation-Selection Balance
destabilizing
stabilizing
●Most protein mutations slightly decrease stability (deleterious). 
●A small number of mutations increase stability. 
●Most deleterious mutations do not fix.
Mutation-Selection Balance 
# deleterious substitutions    =   # beneficial substitutions
(population genetics theory can be used to quantitatively understand when/how this balance occurs)
(alternative explanation for why proteins are marginally stable) 
Why are proteins marginally stable? Taverna, Goldstein. Proteins: Structure, Function, and Bioinformatics 2002
Missense meanderings in sequence space: a biophysical view of protein evolution DePristo, Weinreich, Hartl. Nat Rev Genet 2005
Stability effects of mutations and protein evolvability Tokuriki, Tawfik. Current Opinion in Structural Biology 2009
How Protein Stability and New Functions Trade Off Tokuriki, Stricher, Serrano, Tawfik. PLoS Comput Biol  2008
●Mutation:       
An individual mutates to a new variant
●Substitution:  
A mutant genotype appears and fixes in the  
       population

 
 
Summary
●Many possible sequences lead to same fold
●Proteins in a common family/fold accumulate substitutions at a constant 
rate over time
●Most substitutions affect protein stability
●There is a dynamic balance of slightly deleterious (destabilizing) and 
slightly beneficial (stabilizing) substitutions over time. Marginal stability is 
maintained.
●This dynamic balance also involves:
●Compensatory mutations
●Epistatic interactions

 
 
Part II: Potts Models 
(Using Protein-sequence-variation to study structure)
contacts in protein structure → Compensatory mutations →  correlations in MSA columns?
Outline
●Motivation and Background
●Parameterizing a Potts Model
●Applications of Potts models

Correlated Mutations in a MSA
          imply
Structural Interactions 
Coevolutionary Analysis and Potts Models
Lövkvist et al, PRE 87, 2013
Long history (25 years) of Coevolutionary analysis: 
Detect Correlated positions, then predict contacts
Recent Developments:
Instead of modeling each residue pair individually, build a 
correlated statistical model of the MSA: 
The Potts model
The model can be used for more than contact prediction

 
 
How to measure correlations in an MSA
Bivariate marginal (frequency)
Univariate marginal (frequency)
Positions
Residue types
Correlations:
Observed pairwise 
frequency
Expected pairwise frequency if 
positions vary independently
(Example:                   )
if the two positions vary independently

 
 
Pairwise measures of correlations in an MSA
●Want a correlation score between position-pairs      (sum over       )
●Different scoring methods in literature (two shown below)
●All designed to give a score of “0” for independent variation
Mutual Information (MI)
Statistical Coupling  (SCA)
Can be interpreted as the
“neg. log likelihood” of generating the 
distribution        when sampling from 
the distribution 
Probability of     at i excluding sequences with mutation at j 
Bar means average over all positions

 
 
Relationship to contacts
●
Top-ranking MI (and other) scores 
finds top contact with about 70% 
true-positive rate, top 50 at 50%.
●
Can this be improved?
Mutual information without the influence of phylogeny or entropy dramatically improves residue contact prediction Dunn, Wahl, Gloor. Bioinformatics 2008 
Protein 3D Structure Computed from Evolutionary Sequence Variation. Marks et al Plos One 2011

 
 
Direct vs Indirect Correlations
●Problem: MI, SCA, Cij can be though of as “local” models of 
the correlation: They look at single pairs at a time
●However, correlations can be caused by “indirect” 
interactions, or correlated networks – these local models 
ignore this
●Instead want to make a “global” model of the correlations, in 
order to distinguish direct from indirect correlations.
Idea: Make a statistical model of the sequence as a whole
Probability of a pair of residues
Probability of a whole sequence
vs
Eg: Position 7 interacts with 15, and 15 interacts with 25. Then 7 
and 25 will be correlated even though they don’t interact.

 
 
Potts Models: Origin & Motivation
How to model P(S)?   P(S) describes the probability of generating 
sequce S, where S spans the entire sequence space.
Most general form of P(S) is the set of probabilities of all 
sequences – a model with            parameters!  
We can’t directly measure P(S) from an MSA (since each 
sequence appears once). Unlike bivariate marginals, which can be 
directly measured from an MSA.
Solution: Get the “least biased” distribution subject to constraints: 
The Maximum Entropy distribution P(S)

 
 
In our case, set constraint that P(S) gives the right bivariate marginals 
(pairwise correlation statistics)
Bivariate marginals from P(S):
Entropy of a distribution:
Maximum Entropy
The Maximum Entropy distribution P(S)
●Maximizing entropy minimizes the amount of prior 
information built into the distribution
●Number of model parameters will be equal to number of 
constraints
Sum over entire sequence space

 
 
Maximum Entropy
Constraints:
Method of Lagrange Multipliers:
Lagrange multipliers, one per constraint
Entropy of a distribution
Maximize by solving                                for all S

 
 
Solved by:
Rearrange to give:
(normalization)
This gives the Potts Model
(“statistical energy”)
(Boltzmann distribution)
Maximum Entropy
Note: This model is named for its history in physics of magnetic materials, has many other applications

 
 
“Fields” (L x q)
A
A
A
A
A
A
A
A
G
G
R
R
I
V
F
F
Form of the Potts Model
Potts parameters interpretated as energy contributions from each position/pair
“Couplings” ( (L x q)2)
L = sequence length (eg 200)
q = # of residue types (eg 20)
Note similarity of fields to PSSMs

Form of the Potts Model
Fields 
Couplings
A
A
A
A
A
A
A
A
G
G
R
R
I
V
F
F
Prevalence
Statistical Energy
Sequence landscape
Potts Energy
Sequence Prevalence
Statistical Potts Energy
Image: Dill
●P(S) gives us a probability for any sequence
●Can compute other statistics
●E(S) gives us a statistical energy landscape
●Can model effect of mutations, with epistasis + compensation
●Coupling values        give us info about direct interactions between 
positions (without indirect interactions)
Given known values for the fields and couplings:

●Above we found the functional form of the Maximum 
Entropy distribution, but we did not discuss how to find the 
values of the parameters
●This is actually a challenging task. We need to find the set 
of values which satisfly the constraints on the marginals, 
but there is no obvious way to do so
Parameterizing the Model given an MSA
Non-trivial function of Potts parameters

Parameterizing the Model given an MSA
A number of different numerical methods and approximations 
have been developed to find the parameters:
●Belief Propagation, Susceptibility Propagation
●Mean Field inference
●Pseudolikelihood Methods + Conjugate Gradient Descent
●Cluster Expansion
●Monte Carlo + Quasi-Newton Optimization
This is a computationally intensive task.

●Problem can be framed as a “Maximum Likelihood” inference
●Define a “Likelihood” function which has a maximum when the 
constraints are satisfied.
Parameterizing the Model given an MSA
Flavor of the algorithms:
(probability of the MSA 
according to model)
Conjugate Gradient methods, Quasi-Newtons methods:
●Start with an initial guess for the Parameters
●Compute local gradient of the Likelihood
●Take a small step in that direction (update parameters) 
●Repeat

 
 
Aside: Correction for Phylogeny and Sampling Biases
●Sequences may be phylogenetically related we may have a biased sample
●This may give the appearance of correlations even when there are none
Eg:  wild type:                              AAAAAAAAAAAAAAAAAA
       Single mutants                      AAAAABAAAAAAAAAAAA
                                                     AAAAAAAAAABAAAAAAA
       Double mutant                      AAAAABAAAABAAAAAAA
If we oversample dbl mut, 
overestimate correlation
One solution: Weight each sequence by how many sequences are similar to it:
(weighted average)
weight
Effective # of seqs

Summary of Inference Procedure
1)Obtain an MSA (eg from Pfam)
2)Apply phylogenetic weighting. 
●Need > 1000 effective sequences for precise marginals
3)Compute the bivariate (and univariate) marginals of the data
4)Perform Parameter inference (eg Gradient Descent) 
given bivariate marginals
Parameterizing the Model given an MSA
End up with a set of parameters                which we can use 
in a number of ways.

Mutant stability
Melting temperature
Seq. Prevalence
Electrostatic 
coupling
Structure prediction
Contact maps
Viral fitness
Enzyme fitness
●Contact Prediction
– Ab-initio Structure Prediction
●Free Energy (Conformational) Landscapes
●Fitness landscapes
Potts Model Applications
Potts Hamiltonian models of protein co-variation, free energy landscapes, and evolutionary fitness Levy, Haldane, Flynn. COSB  2017 

 
 
Application 1: Contact Prediction
(removes 'background')
●Want to get an interaction score (like MI or SCA) but using Potts model
●Want to summarize the       coupling         values for each position pair 
             (sum/average over         )
Frobenius Norm of Couplings:
APC Correction:
Direct Information
(some technical details related to “gauges” not discussed here)
Similar to MI, but will exclude indirect interactions since it is 
computed using direct couplings

 
 
Application 1: Contact Prediction
Contact Map from PDB structures
Contact Map from Potts Model
(Protein-Kinase domain)
Can achieve 80% True Positive rate for top 200 contacts.

 
 
Application 1: Contact Prediction
Identification of direct residue contacts in protein–protein interaction by message passing Weigt, White, Szurmant, Hoch, Hwa. PNAS 2009 
DI gives many more “True 
Positives” (red) than MI
Direct Interactions
Indirect Interactions
Non-interacting
DI distinguishes direct from indirect 
interactions, MI does not

 
 
Application 1: Structure Prediction
Idea: Use predicted contacts as input to further algorithms:
●NRM   (distance geometry: contact map → structure)
●Go Models   (coarse grained MD)
Genomics-aided structure prediction Sułkowska, Morcos, Weigt, Hwa, Onuchic. PNAS  2012 

 
 
Application 2: Free Energy and Conformational Landscapes
Mutant stability
Melting temperature
Coevolutionary information, protein folding landscapes, and the thermodynamics of natural selection Morcos, Schafer, Cheng, Onuchic, Wolynes. PNAS 2014 
Quantification of the effect of mutations using a global probability model of natural sequence variation Hopf, Ingraham, Poelwijk, Springer, Sander, Marks Oct 2015 
Potts Energy E(S) reflects 
experimental mutant-
stability measurements 
and melting temperatures
Biased MD/Go simulations using 
contacts as bias/constraints can 
uncover conformational landscape
Coevolutionary signals across protein lineages help capture multiple protein conformations Morcos, Jana, Hwa, Onuchic. PNAS  2013 

 
 
Application 3: Fitness Landscapes
Viral fitness
Enzyme fitness
The Fitness Landscape of HIV-1 Gag: Advanced Modeling Approaches and Validation of Model Predictions by in vitro Testing PLoS Comput Biol  2014 
Coevolutionary landscape inference and the context-dependence of mutations in beta-lactamase TEM-1  Molecular Biology and Evolution 2015 
Potts energy E(S) reflects “fitness” of sequences and mutants
Potts model can describe epistatic effects and compensatory mutations

