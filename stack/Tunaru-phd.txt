Middlesex University Research Repository
An open access repository of
Middlesex University research
http://eprints.mdx.ac.uk
Tunaru, Radu (1999) Statistical modelling of road accident data via graphical models and
hierarchical Bayesian models. PhD thesis, Middlesex University. [Thesis]
This version is available at: https://eprints.mdx.ac.uk/8030/
Copyright:
Middlesex University Research Repository makes the University’s research available electronically.
Copyright and moral rights to this work are retained by the author and/or other copyright owners
unless otherwise stated. The work is supplied on the understanding that any use for commercial gain
is strictly forbidden. A copy may be downloaded for personal, non-commercial, research or study
without prior permission and without charge.
Works, including theses and research projects, may not be reproduced in any format or medium, or
extensive quotations taken from them, or their content changed in any way, without ﬁrst obtaining
permission in writing from the copyright holder(s). They may not be sold or exploited commercially in
any format or medium without the prior written permission of the copyright holder(s).
Full bibliographic details must be given when referring to, or quoting from full items including the
author’s name, the title of the work, publication details where relevant (place, publisher, date), pag-
ination, and for theses or dissertations the awarding institution, the degree type awarded, and the
date of the award.
If you believe that any material held in the repository infringes copyright law, please contact the
Repository Team at Middlesex University via the following email address:
eprints@mdx.ac.uk
The item will be removed from the repository while any claim is being investigated.
See also repository copyright: re-use policy: http://eprints.mdx.ac.uk/policies.html#copy

MX 7228164 2 
Statistical Modelling of Road Accident Data 
via Graphical Models and Hierarchical 
Bayesian Models 
A thesis stibmitted to Middlesex University 
in partial fulfillment of the requirements 
for the degree of Doctor of Philosophy 
RADU 
TUNARU 
Business School 
Middlesex University 
October 1999 

1 
To tny wife 
"Sonie mathematician, 
l believe. kas said that Irue pleasure lies not in the 
discovery of truth, but in the research for it." 
Tolstoy, Anna 
Karenina 

A C K N O W L E D G E M E N T S 
M y first thanks go to the Director of Studies and my ñrst supervisor, M r . 
David Jarrett, for his careful supervisión and many helpful discussions through-
out the research. for his thoughtful reading of the thesis, and for drawing my 
attention to a new área of research based on Markov Chain Monte Cario meth-
ods. 
Thanks are gratefully extended to my second supervisor, Professor C . C 
Wright, for his clear and concise comments about the research and the thesis, 
and for his continuous encouragement. 
[ would also like to acknowledge Middlesex University for providing a three-
year studentship to support the research in this thesis. 
1 also thank Ken Lupton, the research manager of Transport Management 
Research Centre at Middlesex University, for helping me to prepare the data. 
The Library of Middlesex University at Hendon supported me in getting 
many articles and books needed for the research. 
The calculations in the 
research are made on a Pentium computer provided by Middlesex University. 
The thesis is typed using LaTex2e. 
I take full responsibility for any errors or omissions in this thesis. 

iii 
A B S T R A C T 
The objective of this thesis is to develop statistical models for multivari­
ate road accident data. 
Two directions of research are followed: graphical 
modelling for contingency tables cross-classified by accident characteristics, 
and hierarchical Bayesian models for multiple accident frequencies of different 
types modelled jointly. 
Multi-dimensional tables are analysed and it is shown how to use collapsi-
bility to reduce the dimensionality of the analysis without the problems of 
Simpson's paradox. It is revealed that accident severity and the number of 
casualties are associated, and that these variables are mainly influenced by 
the number of vehicles and speed limit. Graphical chain models allow causal 
hypotheses to be formulated and it is shown how they are valuable tools for 
empirical research about road accident characteristics. 
The hierarchical Bayesian models developed combine generalized linear 
models with random effects. The novelty of these models consists in the joint 
modelling of multiple response variables. The models account for overdisper-
sion and they are used for accident prediction and for ranking hazardous sites. 
A l l models are fully Bayesian and are fitted using Markov Chain Monte Carlo 
methods. It is shown that multiple response variables models are superior to 
separate univariate response models. 
Some theoretical problems are examined regarding the maximum likelihood 
estimation process for the two parameters negative binomial distribution. A 
condition is given that is equivalent with unique maximum likelihood estima-

iv 
tors. 
The two directions of research are connected by using graphs to describe the 
models. In addition, a new Bayesian mode! sélection procédure for contingency 
tables is proposed. 
This is based on Gibbs sampling and avoids problems 
associated vvith asymptotic tests. 
The conclusions revealed here can help practitioners to design better safety 
policies and to spend money more wisely on sites that really are dangerous. 

Contents 
1 
Introduction 
1 
1.1 
Background 
1 
1.1.1 
Possible forms of analysis 
2 
1.1.2 
Graphical représentation 
7 
1.1.3 
Data sets used 
9 
1.2 
Aims of the thesis 
11 
1.3 
Overview of the thesis 
13 
2 
Statistical modelling of road accident data 
18 
2.1 
Introduction 
18 
2.2 
Models for accident frequencies 
20 
2.2.1 
The pure Poisson Model 
20 
2.2.2 
Before-after studies 
22 
2.2.3 
Regression models for accident frequencies 
30 
2.3 
Selecting sites for treatment 
36 
2.3.1 
Introduction 
36 
2.3.2 
Statistical modelling methodology 
39 

CONTENTS 
vi 
2.4 
Models for type of accidents 
45 
2.5 
Models for accident frequencies and type of accidents 
48 
2.6 
Summary 
50 
3 
Graphical log-linear models 
52 
3.1 
Introduction 
52 
3.2 
The need for graphical modelling 
54 
3.3 
Préliminaires and terminology 
59 
3.3.1 
Background 
59 
3.3.2 
Graph theory concepts 
61 
3.3.3 
Conditional independence 
65 
3.4 
Graphical models for contingency tables 
67 
3.4.1 
Graphical Models 
67 
3.4.2 
Graphical Chain Models 
78 
3.5 
Summary 
84 
4 
Inference and model sélection 
86 
4.1 
Introduction 
86 
4.2 
Inference 
87 
4.2.1 
Graphical modelling 
87 
4.2.2 
Hypothesis testing 
91 
4.2.3 
Graphical chain modelling 
93 
4.3 
Model sélection 
98 
4.3.1 
Aitkin's method 
100 

CONTENTS 
vii 
4.3.2 
Brown's method 
104 
4.3.3 
Edwards-Havranek model sélection procédure 
106 
4.4 
Summary 
107 
5 
Applications to road accident data 
109 
5.1 
Introduction 
109 
5.2 
Bedfordshire data 
110 
5.2.1 
Graphical model with 6 variables 
110 
5.2.2 
Graphical chain model with 6 variables 
119 
5.2.3 
Graphical chain model with 10 variables 
122 
5.3 
Bedfordshire and Hampshire data 
125 
5.3.1 
Graphical models for the Hampshire data and comparisonsl25 
5.3.2 
Graphical chain model with 10 variables 
128 
5.4 
Graphical chain modelling at a disaggregated level 
130 
5.4.1 
Accidents with pedestrian casualties 
130 
5.4.2 
Accidents without pedestrian casualties 
136 
5.5 
Summary 
138 
6 
Collapsibility in contingency tables 
140 
6.1 
Introduction 
140 
6.1.1 
Simpson's Paradox 
141 
6.2 
Collapsibility 
142 
6.2.1 
Response variable models 
150 
6.3 
Summary 
158 

CONTENTS 
viii 
7 
Problems for compound Poisson distributions 
160 
7.1 
Introduction 
160 
7.2 
Estimation problems for N B distribution 
161 
7.3 
Sensitivity analysis of priors in compound Poisson modelling . 
171 
7.3.1 
Theoretical derivation 
172 
7.3.2 
Application to road accident data in Kent 
174 
7.4 
Summary 
177 
8 
Bayesian models for accident counts 
179 
8.1 
Introduction 
179 
8.2 
Univariate Hierarchical Models of Counts 
183 
8.2.1 
Choice of the form of prior 
183 
8.2.2 
A fully Bayesian approach 
185 
8.2.3 
Monitoring the convergence and inference 
193 
8.2.4 
Residual examination 
195 
8.2.5 
Deviance Information Criterion 
196 
8.2.6 
Global goodness-of-fit tests based on Bayesian p-values 
199 
8.2.7 
A comparison between different compound Poisson mod­
els 
201 
8.3 
Multivariate Hierarchical Models of Counts 
207 
8.3.1 
Hierarchical Poisson-regression models with random ef­
fects 
2ÛS 
8.3.2 
Bayesian models using the multivariate Poisson-log nor­
mal distribution 
218 

CONTENTS 
ix 
8.4 
Bayesian model selection 
222 
5.4.1 
Bayesian forward selection 
225 
8.4.2 
Bayesian backward elimination 
226 
5.4.3 
Bayesian bidirectional selection 
227 
5.4.4 
Applications to road accident tables 
22S 
8.5 
Summary 
232 
9 
Multiple response models for road accident data 
235 
9.1 
Introduction 
235 
9.1.1 
Data analysed 
236 
9.2 
Hierarchical Poisson-regression models for multiple accidents . 
23$ 
9.2.1 
A Poisson-regression model with gamma random effects 
241 
9.2.2 
Comparison with a simpler scenario 
250 
9.2.3 
A Poisson-regression model with log normal random effects253 
9.2.4 
Poisson-regression model with multivariate normal ran­
dom effects 
258 
9.3 
Multivariate Poisson-log normal model 
262 
9.4 
Model selection using DIC 
265 
9.5 
Ranking the sites 
269 
9.5.1 
Ranking by the probability that a site is the worst . . . 
270 
9.5.2 
Ranking by posterior distributions of ranks 
273 
9.5.3 
Comparison of ranks by three models 
277 
9.6 
Summary 
278 

CONTENTS 
x 
10 Conclusion 
286 
10.1 Summary of the thesis 
286 
10.1.1 Multivariate modelling of road accident data 
2S6 
10.1.2 Graphical models 
2S7 
10.1.3 Hierarchical joint-response models 
290 
10.2 Conclusion 
292 
10.3 Limitations of the research 
295 
10.4 Suggestions for further research 
298 
10.5 A final comment 
303 
A Proof of a collapsibility result 
304 
B 
Tables for graphical chain modelling 
309 
C 
Comparison of the (P-ga) and (P-logN) models 
312 
D 
Ranks with credible intervals 
315 
E 
Ordered ranks with credible intervals 
322 
F 
Comparison of ranks 
329 
G Posterior statistics for regression coefficients 
335 

List of Figures 
1.1 
Graphical association model 
8 
1.2 
Directed graphical model for Bayesian model spécification in 
W i n B U G S 
9 
3.1 
A simple graph, neither directed nor unclirected 
62 
3.2 
Chain graph with dependence chain {A, B] U {(7, D] U {E} 
. 
64 
3.3 
Undirected graph g = 
(V,E) 
where V = {A,B,C,D} 
and 
E = {AB, 
AC, BC.BD) 
74 
3.4 
The global Markov property 
75 
3.5 
Conditional independence graph for collision-rollover data; A is 
Driver ejected, B is Car type, C is ïnjury and D is Accident type 77 
3.6 
Chain graph with the dependence chain {A} U {B, C} U {D} 
. 
80 
3.7 
Chain graph corresponding to graphical chain model for collision-
rollover data, with dependence chain {B}D} 
U {A} U {C} 
, , 
81 
3.8 
Moral graph for the chain graph corresponding to graphical 
chain model for collision-rollover data, with dependence chain 
{B,D}U{A}U{C} 
82 
xi 

LIST OF FIGURES 
xii 
3.9 
Moral subgraph of {A,B,D} 
83 
5.1 
The final graphical model for Bedfordshire data with 6 variables 112 
5.2 
Conditional independence graphs revealing a more detailed as­
sociation structure 
116 
5.3 
Graphical model for Bedfordshire data, chosen by Akaike crite-
rion from the minimal accepted models by Edwards-Havranek 
model sélection procédure 
119 
5.4 
Graphical chain model for Bedfordshire data with the depen­
dence chain { R, £, 7\ S] U {N} 
U {A} 
. . 
121 
5.5 
Graphical chain model for Bedfordshire data with 10 variables 
123 
5.6 
Graphical model for Hampshire data with 6 variables 
126 
5.7 
A graphical non-decornposable model for Hampshire data with 
6 variables 
127 
5.8 
Graphical chain model for Bedfordshire + Hampshire data 
. . 
129 
5.9 
Initial step of building the chain graph for accident data with 
pedestrian casualties in Bedfordshire 
1.32 
5.10 
First step of building the chain graph for accident data with 
pedestrian casualties in Bedfordshire 
133 
5.11 Second step of building the chain graph for accident data with 
pedestrian casualties in Bedfordshire 
134 
5-12 Third step of building chain graph for accident data with pedes­
trian casualties in Bedfordshire 
134 

LIST OF FIGURES 
xiii 
5.13 Graphical chain model for Bedfordshire data; accidents with 
pedestrian casualties only 
135 
6.1 
Graphical model for Bedfordshire data: A is accident severity, 
S is speed limit, /V is the number of vehicles involved, T is road 
type, L is lighting conditions, R is road surface 
144 
6.2 
Probabilities that an accident on urban and rural roads in Bed­
fordshire is fatal 
145 
6.3 
Probabilities that an accident on urban and rural roads in Bed­
fordshire is fatal or serious 
146 
6.4 
Graphical chain model for Bedfordshire data with 6 variables . 
154 
6.5 
Graphical model for Hampshire data 
158 
7.1 
Approximate posterior means, calculated from gamma(0.58,0.02), 
aga'mst the posterior means of Poisson-log normal model with 
p = 2.44 and a2 = 2.45 
175 
7.2 
Approximate posterior means, calculated from gamma(1.17,0.02), 
against the posterior means of Poisson-log normal model with 
/i = 2.44 and a2 = 2.45 
176 
8.1 
Directed graphical model for a mixed Poisson-log normal model 187 
5.2 
Directed graphical model for a mixed Poisson-gamma model 
. 
192 
8.3 
Box plots for the models compared 
206 
5.4 
Directed graphical model for Poisson-régression model with gamma 
random effects 
213 

LIST OF FIGURES 
xW 
8.5 
Directed graphical model for Poisson-regression model with mul­
tivariate normal random effects 
216 
5.6 
Directed graphical model for a multivariate Poisson-log normal 
model 
221 
9.1 
Part of Kent road network 
236 
9.2 
Directed graphical model for the hierarchical Bayesian model 
with gamma random effects 
242 
9.3 
Directed graphical model for the hierarchical Bayesian model 
with log normal random effects 
254 
9.4 
Sca.tter plots of totals for model (P-ga) 
258 
9.5 
Scatter plots of totals for model (P-logN) 
258 
9.6 
Ranks of means; Poisson-regression with gamma random effects 
model 
275 
9.7 
Ordered posterior medians and credible intervals of ranks; model 
(P-ga) for first type of accidents 
279 
9.8 
Ordered posterior medians and credible intervals of ranks; model 
(P-ga) for second type of accidents 
2S0 
9.9 
Ordered posterior medians and credible intervals of ranks; model 
(P-ga) for third type of accidents 
280 
9.10 Ordered posterior medians and credible intervals of ranks; model 
(P-ga) for fourth type of accidents 
281 
9.11 
Ordered posterior medians and credible intervals of ranks; model 
(P-MNre) for the first type of accidents 
281 

LIST OF FIGURES 
xv 
9.12 Ordered posterior médians and crédible intervais of ranks; model 
(P-MNre) for the second type of accidents 
282 
9-13 Ordered posterior médians and crédible intervais of ranks; model 
(P-MNre) for the third type of accidents 
282 
9.14 Ordered posterior médians and crédible intervais of ranks; model 
(P-MNre) for the fourth type of accidents 
283 
9.15 Comparison of posterior médians of ranks of residual informa­
tion; fatal or serious accidents with 1 vehicle, (P-MNre) against 
(P-ga) 
283 
9.16 Comparison of posterior médians of ranks of means; fatal or 
serious accidents with 2+ vehicles, (P-MNre) against (P-ga) 
. 
284 
9.17 Comparison of posterior médians of ranks of means; slight ac­
cidents with 1 vehicle, (P-MNre) against (P-ga) 
284 
9.18 Comparison of posterior médians of ranks of means; slight ac­
cidents with 2+ vehicles, (P-MNre) against (P-ga) 
285 
C l 
KSI with 1 vehicle for Model 1 
312 
C.2 
KSI with 1 vehicle for Model 2 
312 
C.3 
KSI with 2+ vehicles for Mode) 1 
313 
C.4 
KSI with 2+ vehicles for Mode! 2 
313 
C.5 
S with 1 vehicle only for Model 1 
313 
C.6 
S with 1 vehicle only for Model 2 
313 
C.7 
S with 2+ vehicles for Model 1 
314 
C.8 
S with 2+ vehicles for Model 2 
314 

List of Tables 
3.1 
A 3-way contingency table of road accidents 
55 
3.2 
Models fitted to the collision-rollover data 
57 
3.3 
4-way contingency table of road accidents 
58 
4.1 
A l l j-factors models 
101 
4.2 
Tests for Aitkin's model selection procedure 
101 
4.3 
Models selected by Aitkin's procedure 
102 
4.4 
Akaike's criterion values 
103 
4.5 
Marginal and partial association tests 
105 
4.6 
Deviance residuals for the model [ACD][BCD] 
107 
5.1 
3-way marginal contingency table of road accidents 
114 
5.2 
Partitioned deviance tests; the P-values are with 3 decimals 
. 
114 
5.3 
Minimal accepted models by Edwards-Havranek procedure . . 
118 
5.4 
Bedfordshire 1995 ; a = 0.05 
131 
5.5 
Bedfordshire 1995; a = 0.01 
137 
6.1 
Observed counts for subtables B C D and A C D of collision-rollover 
data 
147 
xvi 

LIST OF TABLES 
xvii 
6.2 
Estimâtes for subtables B C D and A C D of collision-rollover data 148 
7.1 
Means and variances of two prior distributions 
176 
8.1 
Posterior calculations for ail 3 models compared 
204 
5.2 
D1C calculations for ail 3 models compared 
205 
8.3 
Bayesian model sélection for ACD 
subtable 
229 
8.4 
Bayesian model sélection for BCD 
subtable 
230 
5.5 
Bayesian forward sélection for Bedfordshire data, ANS 
subtable 231 
8.6 
Bayesian backward élimination for Bedfordshire data, 
ANS 
subtable 
232 
9.1 
Total nurnber of accidents for each category of accidents 
. . . 
238 
9.2 
Posterior means of régression coefficients for mixed Poisson-
gamma model 
243 
9.3 
Proportional réductions in accidents when traffic flow is re-
duced, as resulted from the Poisson-regression model with gamma 
random effects 
249 
9.4 
Posterior means of régression coefficients for Poisson-regression 
model 
251 
9.5 
Réductions in accident percentages when traffic flow is reduced. 
as resulted from the Poisson-regression model without random 
effects 
252 
9.6 
Posterior means for mixed Poisson-log normal régression coef­
ficients 
256 

LIST OF TABLES 
xviii 
9.7 
Posterior means of regression coefficients for the Poisson-regression 
model with multivariate normal random effects 
261 
9.S 
Posterior estimation of parameters of multivariate Poisson-log 
normal model 
264 
9.9 
Deviance Information Criterion calculations 
26S 
9.10 Ranking probabilities for KSI accidents with 1 vehicle 
271 
9.11 Ranking probabilities for KSI accidents with 2+ vehicles 
. . . 
272 
9.12 Ranking probabilities for slight accidents with 1 vehicle . . . . 
272 
9.13 Ranking probabilities for slight accidents with 2+ vehicles 
. . 
273 
B.L 
Accidents with pedestrian casualties in Bedfordshire, 1995; a = 
0.01 
309 
B.2 
Accidents with pedestrian casualties in Bedfordshire and Hamp­
shire, 1995; a = 0.05 
310 
B.3 
Accidents with pedestrian casualties in Bedfordshire and Hamp­
shire, 1995; a = 0.01 
310 
B.4 
Accidents without pedestrian casualties in Bedfordshire and 
Hampshire, 1995; a - 0.05 
311 
B.5 
Accidents without pedestrian casualties in Bedfordshire and 
Hampshire, 1995; a = 0.01 
311 
G . l 
Estimates for mixed Poissomgamma regression model 
336 

Chapter 1 
Introduction 
1.1 
Background 
The cost to society of road accidents is very high. According to The Institution 
of C i v i l Engineers it was estimated in 1996 as being between £14 billion and 
«£19 billion per annum in the TJK. although it is unmeasurable in terms of 
human lives (Carruthers, Bulpitt, Gray. Holmes, MacKinven, Moore, Quinn, 
Zealley and Huxford, 1996). Since road accidents are random events, their 
occurrence cannot be predicted. Varions factors are thought to contribute to 
the réalisation of road accidents. Valuable information can be extracted from 
large and complex data sets with the help of Statistical methods. 
Although 
the exact number of future accidents cannot be calculated, it is possible to 
predict or estimate this number and to identify some important contributing 
factors that can be measured and influenced if necessary. 
What makes ail 
thèse possible is Statistical modelling. 
1 

CHAPTER 
l. 
INTRODUCTION 
2 
After the second world war the number of accidents increased dramatically 
but so did the number of vehicles. Governments all over the world were fac­
ing a serious problem that needed major attention. Statistical methods were 
soon starting to be applied in this area of research too. However, the major 
turning point in the advance of scientific methodologies for analysing road 
accidents has been the development of the theory of generalized linear models 
(McCullagh and Nelder, 1989). This new class of models is flexible enough to 
allow modelling of the accident frequencies with a Poisson error. There are sta­
tistical methods for measuring the safety effect of engineering treatment and 
for taking into account the regression-to-mean effect (Hauer, 19S0; Hatter, 
Ng and Lovell, 1989; Hauer, 1997; Wright, Abbess and Jarrett, 1988), and 
for relating the number of accidents at a site to road network characteristics 
(Maycock and Hall, 1984; Maher and Summersgill, 1996; Mountain, Fawaz and 
Jarrett, 1996; Amis, 1996). Comparatively little statistical work has been done 
on the relationships between accident characteristics such as severity, number 
of vehicles, pedestrian involvement, time of day and so on. The aim of this 
research is to contribute to the statistical modelling of large and complex road 
accident data using and developing appropriate multivariate techniques. 
1.1.1 
Possible forms of analysis 
The statistical investigation of road accident data is a non-randomized study, 
a kind of observational study in which there is no direct control by the inves­
tigator. The analyst just observes what is happening, making it very difficult 

CHAPTER 
1. 
INTRODUCTION 
3 
to establish causal relationships. The nature of this type of data makes im­
possible any controlled randomization that would help in designing the study. 
This îs true for data collected for accident characteristics and summarised 
in contingency tables and it is also true for data collected for régression-like 
analyses. For the former case, the analyst takes into account the fact that the 
accidents already occurred so a rétrospective view is appropriate. In the latter 
case, the situation is somehow reversed, the task of the analysis being to pre-
dict future numbers of accidents using a statistical model that hts the current 
set of data, again an observational study. A practitioner aims to understand 
why accidents occur on a road network and what can be done to reduce the 
number of accidents to a minimum. There are two ways of extracting valuable 
statistical information from road accident data and thèse perspectives divide 
the thesis into two parts. 
First, various characteristics are recorded for ail accidents which occur in 
a given period of time. At a national level this is done in U K each year in a 
database like STATS 19. Then the practitioners might attempt to understand 
the associations between thèse characteristics that will help them to design 
better safety policies. Primarily, they are interested in identifying the causes 
of accidents. However, they cannot analyse each accident individually so they 
rely on a statistical analysis to identify factors contributing to a large num­
ber of accidents. Then the local authorities design and implement the safety 
policies thought to manipula-te the identified factors in such a way to reduce 
the future number of accidents. It has to be remarked that in statistics the 

CHAPTERL 
INTRODUCTION 
4 
word '"causal" is very often avoided in favour of a less powerful term, that 
is "association". Nevertheless, studies from other areas of research and some 
external information may help to identify causes and effects. Maycock (1985) 
studied 20 variables as road accident factors. 
VVriting about future possible 
research he said : 
"Fveryone knows that corrélation is not the same thing as cau-
sation but the existence of corrélations demand explanations and 
attempting to obtain explanations would lead into différent sorts 
of behavioural studies, but studies which were targeted towards 
explanations of established accident facts, 
Moreover, establishing and following up statistical associations 
in this way could provide fairly direct dues to the design of re­
médiai measures for those involved in safety législation, éducation 
and training and the design and administration of driving test 
standards." 
For the analysis of accident characteristics the observational units are the 
accidents themselves. 
The variables are the characteristics of the accidents 
together with other more gênerai variables like road network characteristics, 
time spécifications and so on. They are analysed in this thesis as categorical, 
any continuous variables being categorised, and data is summarised in con-
tingency tables. This type of data is most of the time recorded by police and 
it is possible to have miscategorization of some observations due to human 
error. As highlighted above, for this type of data, one purpose is to nnd a 

CHAPTER 
1. INTRODUCTION 
5 
model which explains how the categorical variables are interrelated. For three 
variables A, B and C , if the model suggests that only the pairs A , B and S, C 
are related, this is formulated statistically as a conditional independence be-
tween A and C given the values of B. In common language, knowing the 
values of variable B may provide some information about possible values of 
C, and moreover., Unding out any information about A would be irrelevant for 
discovering more information about C other than it is already known from B. 
For the first kind of data, the approach proposed in this thesis is based on 
graphical modelling and its derivative, graphical chain modelling. With 6 or 
more road accident characteristics under study, the contingency table can be 
expected to be sparse. Due to the nature of the data it is a hnite population 
in a fïxed period of time. This particularity créâtes specific problems that are 
discussed in this thesis. On a real-world example, it is shown that relying on 
asymptotic inference gives différent results than exact conditional inference 
and the latter should ahvays be used in such instances. 
The second type of data is analysed by dividing the road network into small 
units, called sites, and then trying to relate the observed number of accidents 
to site characteristics, either environmental or socio-economical or géométrie. 
Depending on the results ot' the Statistical analysis, treatment policies are 
implemented to reduce the number of accidents. The units of the analysis are 
the sites and the variables are both discrète (e.g. accident frequeucies) and 
continuons (e.g. traffic flow). 
This second direction of research aims at modelling the accident counts as 

CHAPTER!. 
INTRODUCTION 
6 
numerical random variables. The units of the statistical investigation are the 
sites of the road network. The models proposed in this thesis can be used for 
prediction of future numbers of accidents, for describing possible correlation 
structures between accident frequencies of different type and for ranking the 
sites according to different criteria. Practical applications described here show 
the usefulness of the joint modelling of multiple accident counts. 
Analysing multivariate counts by statistical methods has been very difficult 
because of the lack of well-defined parametric distributions that can explain 
complex correlation structures. 
This problem is solved in this thesis using 
hierarchical 
Poisson multivariate models. The whole methodology used for 
generalized linear modelling (McCullagh and Nelder, 1989) is incorporated and 
models with random effects and regression structures are easily and naturally 
included. However, the complexity of such models makes analytical methods 
unfeasible. In the modelling process integrals of dimension of hundreds have to 
be calculated and even numerical methods are not helpful because they are not 
feasible for dimensions greater than 20. This major difficulty is overcome in 
this thesis using Markov Chain Monte Carlo ( M C M C ) methods, in particular 
Gibbs sampling. 
The class of hierarchical Bayesian models proposed here is new to ap­
plied statistical modelling of road accident data because multiple responses 
are jointly modelled, the models are fully Bayesian in specification and they 
can be used to answer different questions based on the same statistical M C M C 
output. Although hierarchical Bayesian models have been developed for re-

CHAPTER 
1. INTRODUCTION 
7 
peated measurements data in other areas of research, the hierarchical raodels 
developed in this thesis are tailored for road accident data. The multiple re-
sponses studied in this thesis represent counts of différent type of accidents, so 
the possible corrélation structure of the responses is not caused by studying 
the same model over time, like in longitudinal studies. The novel multiplica­
tive équations describing the models can be used by practitioners to predict 
changes in accident type as well as frequency if treatment policies are imple-
mented. 
It is somehow regretable that the term "hierarchical" has différent mean-
ings in the two parts of the thesis. In connection with a log-linear mode! for 
contingency tables, hierarchical means an imposed rule of model spécification, 
very important for the interpretability of the models. Regarding a prédictive 
accident model, hierarchical is again about model spécification but in a totally 
différent manner. The observed data is combined with a prior distribution for 
the model parameters; the prior also dépends on some unknown parameters 
which follow a hyper-prior and the spécification may continue like that on 
several stages. The hierarchy is ended at some stage where ail the parameters 
are known. 
1.1.2 
Graphical représentation 
The two directions of research are related by the basic method of represent-
ing hiérarchies, which is a graph. In the discussion of the articles given by 
Wermuth and Lauritzen (1990) and Edwards (1990), A . P . Dawid strongly sup-

CHAPTER 
1. 
INTRODUCTION 
8 
C 
Figure 1.1: Graphical association model 
portée! the use of graphs for communicating statistical modelling ideas. In this 
thesis, two types of graphical models, therefoi'e of graphs, are used. The first 
type, like the one illustrated in Figure 1.1, has vertices associated with ob-
served categorical variables representing accident characteristics. The graph 
synthesizes the conditional independencies revealed by the graphical model 
fitting the data. 
Similar graphs with a mixture of undirected and directed 
edges will be encountered in the first part of this thesis. 
Regardless of the 
nature of the edges, thèse graphs are built using observed variables. 
The second type of graphs are used in this thesis again for model spéc­
ification, more exactly for expressing conditional independencies. There are 
only directed edges due to the hierarchical structure of the models. The dif­
férence relative to the first type consists in having vertices for observed and 
unobserved quantities. À simple example is giveu in Figure 1.2. The program 
W i n B U G S uses such a graphical model for simulation. 
In addition, there are some other links between the two main parts of 
the thesis. 
The analysis of the characteristics of accidents in Bedfordshire 

CHAPTER1. 
INTRODUCTION 
9 
( 
alpha 
\ 
/^imbda[kr) 
( 
beta ^ \ 
forfkIN 1 :N1 
Figure 1.2: Directed graphical model for Bayesian model spécification 
in Win-
BUGS 
and Hampshire data sets reveals that the accident severity and the number 
of vehicles involved in the accident are directly related. This suggests that 
developing separate régression models for thèse two variables may give unreli-
able results. The research carried out in the second part of the thesis conhrms 
this hypothesis and provides a feasible methodological solution. Regarding the 
model sélection procédures for (hierarchical) graphical models, a new method 
is proposed in a Bayesian framework, ernploying similar Markov Chain Monte 
Carlo ideas as those used for the multiple response variables models. 
This 
method provides another link between the two parts of the thesis. 
1.1.3 
Data sets used 
Two separate sources of data were used in this thesis. The first was the STATS 
19 database for 1995, obtained from U K E S R C Data Archive by the Trans-

CHAPTER 
1. INTRODUCTION 
10 
port Management Research Centre at Middlesex University. The two subsets 
of data extracted from STATS 19 and the subset of variables analysed were 
the author's choice. Some of the variables, like accident severity, were used as 
recorded in the database but others were recategorised to have a small num­
ber of levels. For example, the number of vehicles involved and the number 
of casualties were considered with only three levels (one, two, three or more), 
road surface conditions with only three (dry, wet-damp, snow-ice-frost-flood). 
Other temporal variables were also categorised as it will be seen in later chap­
ters. 
The set of data analysed in the second part of the thesis contains the accident 
frequencies on 156 single-carriageway link sites between 1984 and 1991 in Kent. 
The data had been provided by Kent County Council to Middlesex Univer­
sity's Transport Management Research Centre for a previous research project 
(Mountain, Jarrett and Fawaz, 1995; Mountain, Jarrett and Wright, 1994). 
The accident counts are known at a disaggregated level; four separate cate­
gorises were investigated. The disaggregation was made by the author linking 
the original set of data with the STATS 19 database. Covariate information, 
such as estimated traffic flow, speed limit and link length, was also available 
and used in the modelling process. Speed limit was considered as a binary vari­
able having only two levels: urban meaning 40 mph or less and rural meaning 
50 mph or 60 mph. 
It is well known that not all road accidents are recorded in STATS 19 data­
base (Department of Transport, 1996). The number of unreported accidents 

CHAPTER 
I. 
INTRODUCTION 
11 
is not known and the analysts try to make the best of what is available. In this 
thesis the sets of data are used without trying to account for missing records. 
1.2 
Aims of the thesis 
The overall aim of this thesis is to contribute to the development of sound 
statistical techniques that can be applied to road accident data. The intention 
is to develop statistical methods which improve the extraction of relevant 
information contained in the data, information that can be used subsequently 
by various organisations and traffic engineers to design safety measures. If the 
wrong sites are selected for treatment due to bad ranking methods, or policy 
measures are designed to improve irrelevant (from the safety point of view) 
characteristics of road accidents, the loss is very high in terms of money and 
human life. 
Graphical models and graphical chain models are described as an ex­
ploratory multivariate technique that can be applied to large sets of road 
accident data. 
It is intented to find out which variables, "environmental", 
"road user", and so on, are associated with variables representing very impor­
tant accident characteristics, such as accident severity, the number of vehicles 
involved and the number of casualties. 
More specifically, the first part of the thesis has the following objectives 
1. To investigate the associations and conditional independencies between 
several road accident characteristics for two fairly large datasets, corre-

CHARTER 
1. 
INTRODUCTION 
12 
sponding to the counties of Bedfordshire and Hampshire, separately and 
pooled together. 
2. To investigate methods of reducing the analysis of large contingency ta­
bles to the analysis of a smaller dimensional subtables defined by subsets 
of variables of particular interest. 
3. To investigate various model sélection procédures that can be used in 
practice for selecting a graphical model; to discuss their advantages and 
limitations. 
4. To investigate the application of graphical chain models when Substan­
tive research hypothèses are formulated prior to the Statistical modelling 
process and to identify posible causal implications of such hypothèses. 
The research carried out in the hrst part of the thesis will use only categor-
ical variables, but continuous variables such as trafhc flow are also important 
in the study of road accidents. The problem is that the theory of graphical 
models is less well developed for a mixture of discrète and continuous variables. 
Partly for this reason, the research continues in the second part of the thesis 
by separating out the individual accidents according to location, in order to 
relate the accidents to the road network. 
In the second part of the thesis the author's aim is to propose a new class 
of models for différent type of accidents jointly modelled. Models including 
covariate information as well as models based only on parametric spécification 
are developed. It is shown how computational problems in developing such 

CHAPTER 
1. 
INTRODUCTION 
13 
comp lex mo ciels can be solved using M C M C . It is important to relate the 
observed number of accidents to environmental characteristics, such as speed 
lim.it, link length and estimated trafhc flow and this aim will play a major 
rôle in this thesis in developing the hierarchical models for multiple accident 
frequencies. The objectives in the second part of the thesis are therefore 
1. To develop hierarchical Bayesian models for multiple accident counts. 
2. To discuss the problem of ranking the sites according to différent criteria 
and considering multiple response variables. 
3. To discuss estimation problems for Compound Poisson distributions. 
This research will beneht authorities in designing new measures for traf­
hc safety control and new methods for collecting data. At the same time it 
will provide some dues and starting points for future studies. 
The hierar­
chical Bayesian models will provide a new and deeper Statistical modelling 
methodology for road accident data. 
1.3 
Overview of the thesis 
This introduction is followed by a Statistical literature review, Chapter 2, 
where some of the Statistical problems related to the ideas developed in the 
thesis are defmed and the solutions known so far are illustrated. Although 
the applications, for which the Statistical techniques are developed, concern 
road accidents, the same models can be adapted for other count data. 
The 

CHAPTER 
1. 
INTRODUCTION 
14 
originality of this thesis consists in taking a multivariate approach for statisti­
cal modelling, where ""multivariate" means several responses modelled jointly. 
Nevertheless the univariate case is also important and is better known in the 
literature. The role of the Chapter 2 is to review the most up to date statisti­
cal modelling for the univariate case and to identify potential problems worth 
discussing in the multivariate setting. 
Chapter 3 is concerned with graphical modelling. It provides a motivation 
for applying graphical modelling to road accident data, describes the graph 
theory concepts used in the thesis, together with a short account of conditional 
independence, and gives a detailed description of various Markov properties 
necessary to develop graphical models and graphical chain models. The theory 
is almost everywhere accompanied by examples using road accident data. 
The inference process is described in Chapter 4. The starting point of dis­
cussion is the class of log-linear models, a particular case of generalized linear 
models. 
When the researcher is interested in identifying conditional inde­
pendence relationships between the variables (or between groups of variables) 
under study, graphical models are proposed as one of the best solutions. The 
theoretical framework and the most important results are described. More­
over, since it is known that any log-linear model can be nested into a graphical 
model, it seems to be always useful to find out a graphical model fitting the 
data well and simply enough to assist interpretation. Various model selection 
procedures for log-linear models and graphical, models are reviewed and exem­
plified. The theoretical aspects of graphical chain models are also developed. 

CHAPTER 
1. 
INTRODUCTION 
15 
The data subsequently analysed in Chapter 5 are aubsets of data extracted 
from the national road accident database for Great Britain. STATS 19. It is 
expected that the contingency table summarising such data will be sparse. 
This particular aspect makes the contingency tables more difficult to analyse. 
The classical tests based on asymptotic methods are not reliable so exact 
conditional tests, using Monte Carlo methods to overcome the computational 
difficulties, are described in the context of graphical models. Graphical mod-
els and graphical chain models for very large sets of data are proposed and 
important conditional independencies between road accident characteristics 
are identified. A comparison of asymptotic and exact conditional methods is 
investigated in relation to graphical chain modelhng, for a large subset of data 
regarding accidents with pedestrian casualties in Bedfordshire in 1995. 
Methods of reducing the dimensionality of the analysis are extremely use-
ful. Collapsibility is a concept developed in the context of log-linear modelling 
that proves extremely belpful in reducing the amount of work necessary to ex­
tract reliable information from data. This is done in an applied manner in 
Chapter 6. 
Probably the most theoretical chapter of this thesis is Chapter 7 where esti­
mation problems for Compound Poisson distributions are studied. Two major 
cases, the Poisson-gamma and Poisson-log normal distributions, are discussed 
in greater detail. This chapter lias a special importance since many practition-
ers seem not to be aware of the difficulties presented by thèse two Compound 
distributions and Compound Poisson distributions in gênerai. Chapter 7 con-

CHAPTER 
1. INTRODUCTION 
16 
tinues the discussion started in Chapter 2 about empirical Bayesian modelling 
but goes beyond that and opens the door to more complex and realistic models. 
Chapter 8 is dedicated to hierarchical Bayesian models for counts. Bayesian 
methods combining hierarchical models and regression techniques are devel­
oped to extract information from a set of road accident data. 
In the first 
section the general methodology is explained in the context of univariate mod­
els, thus making a straightforward connection with the second chapter of the 
thesis. M C M C methods are used to solve computational problems related to 
hierarchical models and are illustrated using two standard models. In the sec­
ond part of Chapter 8 several complex hierarchical models are developed. At 
the same time, an attempt is made to model multiple response count mod­
els, based solely on the observed frequencies, using distributions such as the 
multivariate log-normal distribution, hierarchically specified. 
A new Bayesian model selection procedure is proposed for log-linear models 
for contingency tables. The computational side of the new method is solved 
again by applying M C M C techniques and this is the main reason why this 
section is included in this chapter. 
Given the applied character of this thesis, there is a companion Chapter 9 
to Chapter S in which a complex set of accident data is investigated at a mul­
tiple response level. The set of data concerns accidents on 156 links in Kent 
between 1984 and 1991. 
The models analysed are fully Bayesian and range 
from simple log-linear regression models to mixed Poisson regression models 
with random effects. First, it is shown how to select a small subset of represen-

CHAPTER 
1. INTRODUCTION 
17 
tative models (3 models are identifiée!), and then, thèse rnodels are examined 
in greater detail. The sites can be ranked according to différent criteria using 
a single M C M C output, and the results are described and discussed towards 
the end of the chapter. 
The last chapter summarises the conclusions of this thesis, from both theo-
retical and applied points of vïew. It also contains a section proposing further 
research that would follow quite naturally from the results of this thesis. 

Chapter 2 
Statistical modelling of road 
accident data 
2.1 
Introduction 
The purpose of this chapter is to présent the framework of the thesis in terms 
of the assurnptions made and the problems that will be tackled, and also to 
review critically the contingent literature to thèse problems. 
Road accidents are among the more visible conséquences of an enormous 
number of failures in the daily volume of interaction between the people who 
use the road networks and the environment in which thev travel. A n accident 
that is predictable is a contradiction in terms. fn other words, when we are 
talking about an individual accident, no matter how much knowledge we have 
about the possible generating mechanisms. we are unable to predict exactly 
where, when and to whom the next individual accident will occur. The best 
18 

CHAPTER 
2. STATISTICAL 
MODELLING 
OF ROAD ACCIDENT 
DATA 
19 
that can be done is to predict their approximate number. 
This is simply 
because, although an individual accident is impossible to predict, the total 
number of accidents of some kind may behave with an almost constant overall 
frequency in the long run. 
As defined in Hauer et al. (19S9) and Hauer (1997) safety is the property 
of some specific entity, most commonly a site of the road network. The prop­
erty of safety (or more exactly the non-safety) for a site is quantified as the 
number of accidents expected to occur per unit of time and their adverse con­
sequences. The important term is "expected" which makes a straightforward 
connection with the statistical approach. If all conditions that affect safety 
(traffic, weather, and so on) are frozen, expected means the "average" in the 
long run. 
One aim of collecting and investigating road accident data is to identify 
significant clusters of accidents having common causal factors and to asses 
the expected numbers of road accidents. 
The list of problems includes the 
evaluation of safety treatments, the ranking and identification of hazardous 
locations, predicting the numbers of futures accidents and investigating the 
associations between characteristics of road accidents. 
The statistical mod­
els proposed for solving these problems can be divided into three categories: 
models for accident frequencies, models for type of accidents and models for 
both accident frequencies and type of accidents. The first category has been 
well investigated at univariate level and it is reviewed next. 

CHAPTER 
2, STATISTICAL 
MODELLIN 
G OF ROAD ACCIDENT 
DATA 20 
2.2 
Models for accident frequencies 
The following methodological Framework is followed for studying accidents 
counts on a road network over a fixed period of time. The network is first 
divided irito units. usually cailed sites, like junctions or Stretches of the road. 
The Statistical unit is the road network element and the response variables are 
accident counts. 
2.2.1 
The pure Poisson Model 
The main probability distribution used in modelling accident data is the Pois­
son distribution. Accidents occur in time. Consider a fixed site for which ac­
cidents are recorded in a hxed period of time T. Partitioning the time period 
into n intervais of duration T/n, let YUii be the number of accidents recorded 
in the i-th time interval. let Pnj 
— Pr(y n ] I- — 1) and let en,i ~ Pr(YnA 
> 2). 
The following assumptions are made 
1. The random variables Ynti, (i = 1 , 2 , . . . . n) are independent over i 
2- ESï-P»,; -> A € (0,co) as n -» co, 
3. maxi<i< n Pnj —» 0 as n —> oo, 
4- 
e n,i -* 0 as n -> oo. 
Then it is shown in Durrett (1991, Theorem 6.1) that 
>'n,i+Vn,2 + . . . + V- n, n ^ Pois(A) 

CHAPTER 
2. STATISTICAL 
MODELLING 
OF ROAD ACCIDENT 
DATA 21 
vvhere d means that the convergence is in distribution. This justifies using the 
Poisson distribution for modeliing road accidents. This dérivation is concep-
tually différent from the one based on a homogeneous Poisson process and the 
Poisson distribution that characterizes it. The assumption of a homogeneous 
Poisson process is not valid for road accidents since it is natural to expect 
great variation of accidents by time patterns. 
The Poisson distribution is defined mathematically and whether a séries of 
events is in agreement with it is an empirical fact. Dénote by Yk the number 
of accidents at site k during an observed time period Tk- The first assumption 
made in modeliing accident frequencies (Nicholson, 1985) is that 
Yk I mk '~ Pois(m A = A f cT*) 
where h = 1,2, ....N 
and A;, is the mean accident frequency per unit time 
at site k. The expected number of accidents, mjt, can then be linked with 
a covariate vector Xk = {Xk\, Xk2t • - • > X^q)'. representing for instance traffic 
flows and the géométrie characteristics of the site. The connection is made via 
a multiplicative équation which can be transformée! into a linear équation on 
the logarithmic scale. The unknown coefficients are estimated by fitting the 
model to data and thèse will be used for statistical inference. 
The 
fitting 
process, under this generalized linear statistical modeliing framework. can 
be done in G L I M or G E N S T A T , where maximum likelihood estimâtes are 
obtained using an itérative weighted least squared (WLS) procédure. 
The 

CHAPTER 
2. STATISTICAL 
MODELLING 
OF ROAD ACCIDENT 
DATA 22 
most common goodness-of-fit measures used are 
k=N 
G2 
X2 
X ^ L l o g ^ ) 
(yk 
-mky 
- (yk - 
rnk) 
k=N f„ 
^2 
(2.1) 
(2.2) 
where yk(k = 1 , 2 , . . . . iV) are the observed number of accidents and 
are 
the estimated means under the fitted model. 
The above notation for the 
Poisson model will be used without any index accounting for différent sites 
when the theoretical model in itself is the same for each site and the model is 
self-explanatory. 
Regarding the accident frequencies observed on a fixed number of sites, 
there are two broad types of statistical investigations: 
1. before-after studies; and 
2. régression models regarding the prédiction of future number of accidents. 
2.2.2 
Before-after studies 
A safety treatment of a site of a road network aims to reduce the number of 
accidents at that site. The usual way of assessing the effectiveness of a safety 
treatment is to compare tire accident frequency before the treatment has been 
implemented with that after treatment. 
A réduction in accidents at the treated sites does not necessarily imply 
that the treatment has been successful. Three reasons may be responsible for 
this. 

CR AFTER 
2. STATISTICAL 
MODELLING 
OF R.OAD ACCIDENT 
DATA 23 
• The number of accidents at a site may change in a random manner, 
increasing or decreasing. whether or not there has been any change at the 
site. Statistical methods are necessarv to consider this random variation. 
• The mean number of accidents may decrease without any connection 
vvith the treatment. 
In order to study these systematic factors it is 
important to compare treated sites with a control group of untreated 
sites. The confounding effects, such as time, can be overcome by selecting 
a control group of sites and observe the number of accidents at these 
sites over the same period as the treated sites. This design is called the 
before-after study and it uses a 2 x 2 contingency table 
Control 
Treatment 
Before 
nn 
ni2 
After 
«21 
«22 
defined by the time dichotomy, before-after, and the control-treatment 
dichotomy. 
• The thircL problem. is the régression-lo-mean 
effect, which means that 
for the many sites with a "low"'"' accident frequency before treatment 
there will be a slight rise after treatment, for the few sites with a "high" 
frequency a greater fall; while for all sites together, no change, (Hauer, 
1980). 
The first two problems can be solved by standard methods (Hauer, 1986; 
Hauer, 1980; Hauer, 1997). In terms of improvement due to the Statistical 

CHAPTER 
2. STATISTICAL 
MODELLING 
OF ROAD ACCIDENT 
DATA 24 
analysis, the third problem is viewed as one of the most important. 
The 
regression-to-mean bias inadvertently results from the fact that only locations 
with a large number of accidents are generally selected for treatment, which 
may lead to biased conclusions. The standard solution to this problem is to 
use empirical Bayes (EB) models as developed in Abbess, Jarrett and Wright 
(1981), Jarrett, Abbess and Wright (1982), Brude and Larsson (1988), Mor­
ris, Christiansen and Pendleton (1991). Hauer (1997) is a general reference 
explaining empirical Bayes methods for practitioners. 
The empirical Bayes (EB) method for estimation provides a general frame­
work where different distributions can be studied in order to improve the qual­
ity of the estimators. The compound model 
Yk | ™>k l~ 
Pois(m/.) 
(2.3) 
mk 
~ 
G'(-) 
ke 
{1,2,... .JV} 
lead to estimates of the individual parameters 
using information from all 
sites under study. In studies using E B methods the variation of rajt from site 
to site is regarded as purely random. Then the Yk are marginally independent. 
If the unknown distribution G(-) has probability density g then the marginal 
density is 
PciVk) = / 
Po)s(yk\rnk)g(rnk)dmk 

CHAPTER 
2. STATISTICA 
L MODELLING 
OF ROAD A CCIDENT 
DATA 25 
and the posterior density of mk is 
Poi$(yk\Tnk)g(mk) 
Pc(Vk) 
(2.4) 
If g is known. meaning that its parameters are given and do not have to be 
estimated. then the model is called fully Bayesian; if the parameters of g have 
to be estimated from data then this approach is called an empirical Bayes 
(EB) method. 
One of the first important empirical Bayes ideas for modelling counts was 
advocated by Robbins (1955) in a nonparametric form. For the componnd 
Poisson-G model described in (2.3), suppose that G is totally unknown. Under 
squared error loss (SEL), the Bayes estimator is the posterior mean 
The M L E of m is y so raB 
is biased. However, m 
is preferred because of 
lower M S E . When G is known, the estimation is straightforward. For the 
case when G is unknown Robbins (1955) suggested to estimate pc[y) by the 
number of values Y in the sarnple Y\, V2, - - •, YN that are equal with Y, so 
m B 
E(m\y) 
(y + l ) p g ( y + l ) 
Pc(y) 
(2.5) 
(2.6) 
mu 
= {y + l) 
where 
is the indicator function. Therefore, the Bayes estimate m takes 

CHAPTER 
2. STATISTICAL 
MODELLIN 
G OF ROAD ACCIDENT 
DATA 26 
information from other sites as well. Although this procédure has some good 
asymptotic properties, it was shown that, even when the sample size is large, 
this method does not perform very well and a parametric approach is more 
suitable (Carlin and Louis, 1996). 
The prior distribution g (m) is usually assumed to be of gamma form, 
because the gamma distribution is the conjugate distribution for the Poisson 
distribution (George. Makov and Smith, 1993). Thus 
/ 
\ 
a a 
/rt -% 
m ~ gamma(a, o) = gamma 7 ; — • 
(2-0 
L6' 62 
where gam.ma(x | a, b) = J ^ x
a - l e - x b and the second parameterisation is in 
terms of the mean | and variance ^ . Then it follows from the Bayes formula 
in équation (2.4) that the posterior distribution of m is 
p( m 1 y) = T [ ^ y
m °
+ " "
v
(
m
,
m 
( 2 ' 8 ) 
The marginal distribution of Y is then 
which is a negative binomial distribution NB(-j-^, a). As described by Morris in 
discussionof Haueret al. (1989), thewhole parametricmodellingmethodology 
for accident counts can be expressed in terms of a descriptive model and an 
inferential model, Both describe the distribution for the observed data and the 

CHARTER 
2. STATISTICAL 
MODELLING 
OF ROAD ACCIDENT 
DATA 27 
distribution of the unobserved parameters. The descriptive model is given by 
• observed data 
Y 
^ 
Pois(m) 
(2.10) 
• unobserved parameters 
m \ a, 6 ~ 
gamma(a, 6) = gamma a a 
[V p 
(2.11) 
The inferential model is then 
• observed data 
Y 
~ 
N B [ p = 
1 + 6' 
(2.12) 
• unobserved parameters 
m | y ~ gamma(a + y, b + 1) = gamma a + y 
a + y 
. 6 + l ' ( è + l )
2 J 
(2.13) 
The Bayes estimate of m for the subpopulation of those sites at which y 
accidents occurred is 
E(m | y) = a + y 
6 + 1 
(2.14) 
The régression efFect can then be defined by E ( m | y) — y- An. alternative 

CHAPTER 
2. STATISTICAL 
MODELLING 
OF ROAD ACCIDENT 
DATA 28 
définition is the expected percentage change in the number of accidents 
R 
= 
E(m \ 
y)-y 
x 100 
n + yf_ 
y 
b+ly 
x 100. 
In order to calculate the régression effect R the values of pararaeters a 
and b need to be estimated. The values of thèse parameters can be estimated 
by htting the négative binornial distribution, équation (2.9). to the observed 
data. This can be doue in G L I M using macros or more directly in G E N S T A T . 
Some examples of such analyses are in Persaud (1991), .larrett et al. (1982), 
Hauer (1997). 
The Bayes estimate mB is a convex combination of the overall expected 
accident frequency /i and the observed frequency y 
mB 
— E(m I y) = a + y 
m 
= 
6 + 1 
ap + (1 - ct)y 
(2.15) 
(2.16) 
where a = 7^7, ju = E(m | a,6) = |. It is worth pointing out that a dépends 
on var(m) in the population of sites. 
Another way of modelling the effect of a safety measure implemented at a 
site is to define a coefficient 0 such that 
majt = 6 rribej 

CHA PTER 2. STATISTICAL 
MODELLING 
OFROAD 
ACCIDENT 
DATA 
29 
where the two m values represent the expected number of accidents, before 
and after the implementation. If the remédiai treatment has no effect then 
0 = 1. ï h e différence from this value can be interpreted as an increase or 
decrease by the same percentage in the expected number of accidents. The 
value of 0 is estimated as shown in Kulmala (1994). 
There are other methods for dealing with the regression-to-mean effect, 
though they are more difhcult to apply in practice (Wright et 
al., 1988). 
However, only the E B methods are important for the development of the 
models considered in the second part of the thesis. 
Wright et 
al. (1988) 
describe four main problems about the assumptions made for ail methods 
that need to be carefully considered. 
1. The first problem is about the définition of the term "site". For treated 
sites this is done by local authorities and this may influence the estimate 
of the true accident rate for that site in future years. However. for the 
régression models considered in the next subsection and later chapters, 
the road network is usually divided into nodes (jmictions) and links. 
2. The second problem is about defining the population. For a given site, 
do " a i l " the sites in the study area dehne the population or only "those" 
with similar physical characteristics as the treated site? The régression 
models allow the parameters of the gamma distribution to dépend on 
site characteristics, so the 'population' consists of ail sites with the same 
characteristics. 

CHAPTER 
2. STATISTICAL 
MODELLING 
OF ROAD ACCIDENT 
DATA 30 
3. The third problem concerns the "gamma assumption". Following Abbess 
et al. (1981). this means that the distribution of the true mean accident 
rates is gamma. This is very convenient from the mathematical point 
of view but it is a strong assumption. It would be very interesting to 
know how sensitive the results are to this assumption and whether other 
distributions such as log normal give satisfactory solutions. Some new 
approaches are described in this thesis in Chapters 7 and 9. 
4. The remedial sites are chosen for treatment because they have a large 
number of accidents which appear to have causal factors in common. The 
fourth problem is whether the regression-to-mean effect can be studied 
in terms of the overall accident frequency at each site. 
A simultane­
ous analysis of accident frequencies of various type would certainly be 
more beneficial. Statistical models for doing this kind of analysis after 
disaggregation are developed in Chapters 8 and 9. 
2.2.3 
Regression models for accident frequencies 
Very often, a better prediction of future number of accidents is posssible when 
the covariate information available is linked to the observed number of acci­
dents. This will help in establishing a straightforward method for prediction. 
Linear regression models using a normal distribution for the error term are 
not appropriate. 
Generalized linear modelling gives better modelling flexi­
bility and the predictive accident models developed in the last two decades 
are included in this general framework. 
This allows retention of the Pois-

CHAPTER 
2. STATISTICAL 
MODELLING 
OF ROAD ACCIDENT 
DATA 31 
son assumption. Therefore, Poisson log-linear modelling is often used for the 
régression models for road accident data. 
A generalized linear model, McCullagh and Neider (1989), is specîfied by 
Y 
~ 
f{9,è) 
(2.17) 
E(Y') 
= 
m 
(2.18) 
h(m) 
= 
X'ß. 
(2.19) 
In this, À' is a vector of explanatory variables. The relationship between the 
mean m and the linear predictor X'ß is modelled by the so called link function 
h. This is possible as long as there is a function h* such that 0 = 
h*(Xfß). 
When the error distribution /(0, <j>) is Poisson with mean m the canonical link 
0 = log (m) = X'ß leads to the standard log-linear Poisson-régression model. 
Regression models 
In the literature there are studied several classes of régression models. A 
Poisson cla-ss of models (Miaou and Lum. 1993) assumes that 
Y 
- 
Pois(m) 
(2.20) 
m = E(Y) 
- 
v[exp(X'ß)] 
(2.21) 
where v is an exposure factor. like time for instance. 
The rate function is 
A = exp (X'ß) which is very convenient being nonnegative. A modified Poisson 

CHAPTER 
2. STATISTICAL 
MODELLING 
OFROAD 
ACCIDENT 
DATA 32 
régression model, Maycock and Hall (1984), is described by 
Y 
~ 
Pois(m) 
m = 
E ( T ) 
=iA[exp(X'ß)] 
where the unknovvri constant ß0 rieeds to be estimated. If u is a good exposure 
measure then the estimated ß0 should be close to 1. 
As pointed out in Miaou and Lum (1993), the Poisson distribution is very 
useful not only because tests and confidence sets for the estimated régression 
coefficients can be calculated, but probabilistic statements can be made about 
Y. This is an important point in favour of using the Poisson distribution, which 
is discrète. Thcre is no need to look for some other continuous distributions, 
like the normal that is still used, quite inappropriately, in some investigations, 
for example Amis (1996). 
For prédictive accident moclels traffic flow plays a major role, and should 
also be considered in before-after studies. Changes in trafFic flows influence 
changes in accident counts between the "before" and "after" periods, and 
this should be accounted for before making any claims about the effectiveness 
of any treatment. Traffic flow is also important for estimating the expected 
accident numbers, and is usually included amongst the explanatory variables 
À'. 
Quite often accident rates like accidents/vehicle kilometer are used to 
account for changes in traffic flow as a measure of exposure. This would be 
correct if the expected accident frequencies like accidents/year were directly 

CHAPTER2. 
STATISTÏCAL 
MODELLING 
OF ROAD ACCIDENT 
DATA 
33 
proportion al to traffic flow. This common belief is seldom true; the coefficient 
of flow is significantly différent from 1. 
A further problein is that the exact values for traffic flows are not known 
and they are replaced by estimâtes. This may cause further problems if there 
are random errors in thèse estimâtes. If Q is the traffic flow count and z is 
the true annual average daily traffic ( A A D T ) flow. they can be modelled at 
the same time using the following model 
Y 
~ 
Pois(m = AT) 
(2.22) 
Q 
~ 
Pois(^) 
(2.23) 
m 
= 
7 1exp[X /^ + log(z) 7]. 
(2.24) 
A n itérative procédure described in Maher and Summersgill (1996), can be 
used to calculate the estimâtes of the unknown parameters (/?,7). 
The Overdispersion problem 
One limitation of the Poisson-régression modelling. well documented in the 
literature, is that the error variance bas to be equal to the mean Ë(K) in 
équation (2.18), see Cox (1983) and Dean and Lawless (1989). However, in 
practice count data very often shows overdispersion: the error variance is 
greater than the mean. Ignoring this phenomenon can be very troublesome. 
Although the maximum likelihood estimators of the régression coefficients are 
still consistent, the variances of the estimated coefficients tend to be underes-

CHAPTER 
2. STATISTICAL 
MODELLING 
OF ROAD ACCIDENT 
DATA 34 
timated, which means that the significance levels of the estimated coefficients 
can be misleading. The phenomenon of overdispersion is well-known in many 
areas of statistics. There are several methods to overcome this difficulty but 
there is much research under progress searching for better solutions. Some pos­
sible reasons for overdispersion in prédictive accident models are commented 
in Maher and Summersgill (1996). 
Overdispersion occurs quite often in modelling count data under a Poisson 
assumption. so the first attempts to solve this problem were based on making 
more complex distributional assumptions. 
One solution proposed by Wed-
derbnrn (1974) to correct for overdispersion is a quasi-Poisson model (QP)-
The différence from the classical Poisson model is that var(F) 
= r m , with 
the parameter r accounting for overdispersion. This parameter can. then be 
estimated by any of G2/{N 
- p), A" 2/(iV - p), or G 2 / E ( G 2 ) , where N is the 
number of observations and /; is the number of parameters estimated. Sim­
ulation studies (Maher and Summersgill, 1996) have shown that the second 
performs better. For the estimâtes of the régression parameters 
there is no 
différence compared to the pure Poisson model, but their standard errors are 
inflated by a factor of %Jr. The asymptotic i-statistic for the coefficient of 
régression can be improved (Agresti, 1990) by multiplying the value for the 
initial i-statistic, obtained from the Poisson régression model, by T ~ 2 . One 
may obtain the correct adjusted asymptotic standard errors by multiplying 
the values given by traditional generalized linear modelling software by the 
scaling factor y/r = JX^KN 
— p). The inference is then performed in the 

CH AFTER 
2. STATISTICAL 
MO DELLING 
OF ROAD ACCIDENT 
DATA 35 
classical manner using thèse adjusted asymptotic standard errors. It can be 
immediately seen that, when r > 1. Le. there is overdispersion, the confidence 
intervais obtainecl after adjusting are larger than the unadjusted 
confidence 
intervais. Thus. the inferential process is improved by using the correct as­
ymptotic standard errors. 
A n alternative is to use another discrète distribution instead of the Poisson 
distribution. Following a Bayesian approach as described above, it seems that 
the negative binomial distribution (NB) is more suitable, as it allows the 
variance to be greater than the mean. A third more gênerai solution is to use 
a more gênerai family of negative binomial distributions for which (QP) and 
(NB) models are just two special cases (Cameron and Trivedi, 1986). 
This 
gênerai model is given by the following assumptions 
Yk 
~ 
?o\s{\kTk), 
for ail A 
\ k 
~ 
gamma(r?.6) = gamma 
(2.25) 
(2.26) 
(2.27) 
where a is a constant factor and the overall mean f_i is estimated from the 
data. From the model spécification it follows that 
p(Yk | ß,b) 
= 
N B 
E(Yk\fL,b) 
lTk 
,b + Tk 
var(V* 1/1,6) 
= 
E(Yk \ ^ b)b-±J± 
= //f, ( l + ^ ) 
(2.28) 
(2.29) 
(2.30) 

CHAFTER 
2. STATISTICAL 
MODELLING 
OFROAD 
ACCIDENT 
DATA 
36 
Using équation (2.27) it follovvs that b = afiJ~l, 
and this means that 
u2~jT2 
var(y f c | ii, b) = 
fxTk + 
h- 
k-
a 
as mentioned in Mäher and Summersgill (1996). Thus, j = 0 implies that 
?/ = a and this is the ciassical N B model used. If j = 1 it follovvs that n = a/j, 
so the shape of the gamma distribution is not constant and it dépends on its 
mean. In this case 
var(V f c|/ i,6) = /
/ r ^ l + 
^ 
and if Tk = T then this model becomes a (QP) model with r = 1 + ~. 
This methodology can be extended to incorporate covariate information; 
the parameter \i is then a function of the covariate vector X. In this family of 
models, for the T R L studies, like the T R L 4-arm roundabout study (Maycock 
and Hall. 1984), it seems that the (NB) model is more adéquate than the (QP) 
model. 
2.3 
Selecting sites for treatment 
2.3.1 
Introduction 
The main job of traffic safety engineers is to correct hazardous sites. 
First, 
they have to identify the risky locations, then to détermine remedial schemes 
and in the end to implement the best feasible treatment. Choosing the wrong 
sites is damaging in two ways: firstly, some hazardous sites may be left un-

CHAPTER 
2. STATISTICAL 
MODELLING 
OF ROAD ACCIDENT 
DATA 
37 
treated and secondly, large amounts of public money are was ted. Ideally, sites 
should be ranked by the values of their true means m. These are unknown, 
but because of random variation, observed numbers of accidents are not en-
tirely reliable. Statistical modelling is often used to improve the methodology. 
Similar problem s are addressed in mediane (Morris and Christiansen, 1996), 
where profiling hospitals lias become very important in récent years, and in 
éducation (Laird and Louis, 1989), where ranking schools based on pupil per­
formance data is required for public information and for implementation of 
better éducation policies. 
Ranking and sélection are related to either a "relative" given set of Statisti­
cal units, in our case sites, and then the units are just compared to each other, 
or to an "absolute" standard like a given threshold and the purpose is then 
to identify those units that exceed the threshold. Ranking can be successfully 
used to indicate good or bad performance. Ranks should contain Statistical 
information that avoid misrepresentation of the précision of estimation. 
If 
régression methods can be used to explain the whole between-sites variation 
there is no basis for ranking. 
Generally, sites are ranked according to some safety measure such as acci­
dent count or rate. Higle and Witkowski (1988) were the first to propose (EB) 
methods for ranking locations. The (EB) methods were used to give greater 
weight to those sites having greater exposure. They were not used because of 
sélection bias, which is not of concern here. The site estimâtes are différent 
in their reliability. 
For example, if a large number of accidents y\ is observed 

CHAPTER 
2. STATISTICAL 
MODELLING 
OF ROAD ACCIDENT 
DATA 
38 
at a site with a high exposure, then there is more confidence that yi is close 
to its true mean value than for a large number yi accidents observed at a site 
with low exposure. 
Ranking the sites by their empirical accident frequency, without consid­
ering the uncertainty of each estimate, may not correctly identify the worst 
locations. Nothing can be said about the probability that the worst sites have 
been selected or about the extent to which the selected sites are really haz­
ardous compared with the non-selected ones. Bayesian and empirical Bayes 
methods have been used to overcome some of these difficulties, see Hauer 
(1980), Higle and Witkowski (1988), Davies (1990), Christiansen, Morris and 
Pendleton (1992). A recent study, proposing hierarchical Bayesian models as 
a general solution to all the problems highlighted above, is given in Schluter, 
Deely and Nicholson (1997). 
Ranking and selection are based on solving one or more of the following 
problems (Morris and Christiansen, 1996), here translated for road accident 
sites. 
1. Estimate the maximum or minimum of all means or even find the dis­
tribution of this quantity. 
2. Determine the site or family of sites that are likely to be the best (or 
worst). 
3. Find the sites that are likely to exceed a given threshold. 
4. Obtain the predictive distribution for each of the N sites and calculate 

CHARTER 
2, STATISTICAL 
MODELLING 
OE ROAD ACCIDENT 
DATA 39 
the probability that, for a fixée! future period, each site will have the 
maximum (or minimum) number of accidents 
Methods for solving thèse problems can be based on a Bayesian framework. 
Given a tolérance level S. Higle and Witkowski (1988) called a site k haz­
ardous when the probability that A*, the expected accident frequency per unit 
time, is greater than a specified upper limit A (a possible acceptable underlying 
accident mean) exceeds S. In another study (Davies, 1990) sites were classified 
by the ratio p between the accident mean at each site and the pooled acci­
dent means at the remaining sites. For each site under scrutiny, the posterior 
distribution of p is used to obtain the similarity measure 
a = Pr(p < 1 I yi,.,. 
,yN). 
When a is small the corresponding site has a higher underlying accident mean 
than the other sites pooled together and it is therefore selected. 
Christiansen et 
al. (1992) developed a hierarchical Bayesian model for 
estimation and for ranking the accident sites. The posterior accident mean es­
timâtes, adjusted for costs and future trame volume, are ranked in a decreasing 
order and sites are selected until a hxed budget constraint is met. 
2.3.2 
Statistical modelling methodology 
Suppose there are N sites labelled k — 1.2, . . . , / V , and at site k there is a 
total of Vfc accidents over a period of time Tk. 
The counts Vfe are assumed 

CHAPTER 
2. STATISTICAL 
MODELLING 
OFROAD 
ACCIDENTDATA 
40 
independent with means A^, where Xk > 0. 
The hierarchical models are developed in several stages. First of all, the 
mean per unit time Ajt is considered a random variable with prior distribution 
/(* | 0, i/). Then the hierarchical 
Bayesian method considers a hyper-prior 
distribution h on the parameters ß and i/, in a second stage. 
Under the 
assumption of exchangeability the prior distribution of A = ( A i , . . . , A/v) is 
fW 
= i i IT 
I ß,v)Kß>")dßfo- 
(2-31) 
Ju Jß 
fc=1 
The hyper-prior h(ß.v) 
can be factorised as 
h(ß,v) 
= h1(ß)h2(v\ß) 
(2.32) 
using prior information about the nature of parameters ß and v. The posterior 
distribution of the parameter of direct interest A, given the observed data 
2/ = ( y i , . . . ,i/iv), can be written as 
« " • ' 
- 
f
f
^
*
- 
< ' - - ' 
/(A | y) 
= 
r 
T/(A | 
ffl0,,,)P&!lMÄ2^ | ß)kx(ß)dßdu 
(2.34) 
./o io 
p(y) 
where 
f 
/ 
p ( H / M ^ H / W W ^ 
0 
(2.35) 

CHAPTER 
2. STATISTICAL 
MO DELLING 
OF ROAD ACCIDENT 
DATA 41 
is the marginal distribution of the observed data y. 
Because the Bayesian 
calculus involves only the expectation of the posterior distribution or other 
measures such as mean or mode, the exact form of the posterior distribution 
is not a matter of specific concern. 
However, it has to be remarked that 
under the gamma assumption, p(y \ ß^u) is a product of negative binomial 
distributions. The spécification of the hyper-prior distribution h(ß,v) 
is not 
easy. Schlüter et al. (1997) provide an interesting discussion in connection 
with the ranking problem. 
Based on the previous methodology, Schlüter et al. (1997) proposed three 
criteria for ranking. These will be explained in turn. 
Ranking using the posterior probability that a site is the worst site 
For a given type of accident or the total number of accidents, if A^ is the 
accident mean at the site k, then the posterior probability that the site k is 
the worst one can be calculated as 
Pk(v) = Pr(A f c > v \j, 
for all j / k \ y) 
where v £ [0, co). If v ~ 1 then p*(u) is the probability that the site k is 
the worst site. 
Only for this value of v the surn of pjt(u) equals 1. so they 
are true probabilities. The practitioners specify v a priori. Then either the 
first r largest values Pk(v) or the smallest group of sites with summed values 
Pk(v) greater than some threshold value _P*, are selected. If the results are not 
satisfactory, for instance only two or three sites are selected, then the value of 

CHAPTER 
2. 
STATISTICAL 
MODELLÏNG 
OF ROAD 
A CCÏDENT 
DATA 
42 
v can be lowered and the ranking process repeated. This criterion is designed 
for long term projects and calculâtes a measure of uncertainty, based on a 
pre-specified distance quantity v. 
Ranking using the prédictive probability of future accidents 
For a given threshold number n 0 . if Yk is the future number of accidents in 
the next period at site k, then 
pd f c(no) = Pr(Y* > n0\y) = / 
p(yk | A,y)/(A | y)dX 
is the Bayesian prédictive probability that the future number of accidents will 
exceed an important future target accident number. Again, the sélection is 
made by taking either the first r largest pdj.(no) values or ail the sites having 
pdk(nc) 
> Pq, where P0 is fixed. This criterion is designed for short term 
objectives because it uses the probability of future numbers of accidents in 
the next period. 
Ranking using the posterior mean 
The posterior mean 
E(A f c | y) = / 
\kf{\k | y)dXk 
is the most commonly used measure. Sélection is made either by taking the r 
largest E(Ajt | y) or by retaining ail sites for which E(Afe | y) > e 0, where eo is 

CHAPTER 
2. STATISTICAL 
MODELLING 
OFROAD 
ACCIDENT 
DATA 
43 
a given threshold value. This measure is probably the most easily calculated 
of ail three. It is an estimate of the underlying mean and it can be used for 
long term forecasts. 
Howe ver, as pointed out by Laird and Louis (1989) and Morris and Chris­
tiansen (1996), this approach can be misleading. A more reliable method is to 
estimate the actual ranks of the parameters of interest corresponding to the 
observational units, which in this thesis will be the meaJis A^ of the Poisson 
distributions. The beauty of the Bayesian methodology coupled with M C M C 
methods is that the entire posterior distribution of ranks can be estimated. 
It would be very useful if the above methodology could be further devel-
oped and hierarchical models for multiple counts considered to rank the sites 
according to différent criteria. Nothing has been done apparently about rank­
ing hazardous locations when multiple accident counts are jointly investigated. 
Practitioners prefer to use data at an aggregated level, mainly because of lack 
of Statistical models that can be used for multiple counts. For the same period 
of observation, if one site has a total of 30 accidents, out of which 6 are KSI, 
and another site has a total of 15, out of which 10 are KSI, then, looking only 
at the totals, the first site seems more hazardous than the second one. But if 
only the number of KSI accidents is considered then the second site is more 
hazardous than the first one. Therefore developing models for ranking multi­
ple accident counts would provide a much better analysis. Three hierarchical 
Bayesian models are investigated for ranking 156 link sites in Chapter 9. 
Another hierarchical model used for ranks was proposed by Maher and 

CHAPTER 
2. STATISTÏCAL 
MODELLING 
OF ROAD ACCIDENT 
DATA 44 
Mountain (19SS). The model is specified in three stages 
and the différence At — Sk represents the quantity by vvhich the mean accident 
frequency at the site k exceeds the average mean for a site with fixed char-
acteristics of that type. Maher and Mountain (1988) ranked the sites by the 
potential accident réduction criterion (PAR), that is by yk — 6k, where 6 is 
an estimate. It was shown that this criterion is better than ranking based on 
annual accident totals, provided that the estimation of 6 is accurate enough. 
This model is an improvement because it is not based only on the observed 
total accident counts at each site and because covariates can be easily in-
cluded. 
Although (PAR) shows great promise there are several drawbacks 
for using this model in this form. One major criticism is that the estimated 
average means 6 and the observed counts y are assumed to be sufficient for 
calculating the ranks. The environment may expérience dynamic changes in 
many unobserved ways with results in increasing or decreasing the number of 
accidents. The plain observed counts are unreliable for ranking purposes, but 
fully Bayesian or E B methods combine the data from other sites and therefore 
are more reliable, especially if random effects are employed. for estimating 
E(Àjt | y) or for ranking the sites. 
In addition, nothing bas been said, re-
Pois(A f c) 
(2.36) 
(2.37) 
(2.38) 

CHAPTER 
2. STATISTICAL 
MODELLING 
OF ROAD ACCIDENT 
DATA 45 
garding the (PAR) criterion, about the uncertainty associated with the ranks. 
Even when two sites hâve différent ranks, if their uncertainty intervais are 
quite overlapped then the différence may be due to the particular estimation 
procédure chosen. A solution to ail thèse problems is sketched in Chapters S 
and 9, using hierarchical models combining régression with random effects in 
a Bayesian framework. 
2.4 
Models for type of accidents 
The flrsfc category of studies described in Section 2.2 focused on statistical 
modelling of accident frequencies as random variables. 
A second category 
of applications is looking at the characteristics of the accidents which have 
occurred, such as the severity of injury, the date (day, month, year), location, 
speed limit, road classification and so on. The unit of the statistical an.al.ysis is 
différent from that in the previous category of studies. Each accident is a unit 
of the sample and the random variables are the characteristics of the accident, 
given that the accident has occurred. 
There will typically be a large nurnber of variables. There is an obvious 
interest in identifying the association or independence 
relationships 
among 
the variables. A n example is in Salminen and Heiskanen (1997), where the 
corrélations between accidents in traffic, at work, at home and during sports 
and leisure time were investigated. The product moment corrélation was used 
as the main tool. 
Even after logarithmic transformations, the corrélations 

CHAPTER 
2. STATISTICAL 
MODELUNG 
OF ROAD ACCIDENT 
DATA 
46 
were unchanged and still low. The study used data for 3 years 1980. 1988 and 
1993, the matrix of corrélation changing over time. 
Another study of which declared purpose was to investigate the charac­
teristics of pedal cycle accidents at T-junctions is Henson (1992). A number 
of ten variables representing various accident factors were analysed using log­
linear models for data summarised in contingency tables. The analysis was 
conducted on several marginal two dimensional. and three dimensional tables 
and it was inconclusive. Henson (1992) required a larger database to get bet­
ter results. The data was indeed sparse, comprising only 272 reported injury 
accidents, but the Statistical methodology used, analysing several marginal ta­
bles, is potentially misleading. However, there are better techniques available 
for studying associations between variables that will be described and applied 
in this thesis in Chapters 3, 4 and 5. It will be shown in this thesis how to 
conduct an exploratory analysis on a single large table cross-classified by ail 
variables under study. 
It will also be shown how to avoid model sélection 
problems for sparse tables by using exact conditional tests. 
Studies of accident characteristics are observational in the same sensé as 
studies regarding accident frequencies at individual sites. A rétrospective view 
is taken, conditioning on the fact that accidents have occurred, so only char­
acteristics of observed accidents are recorded. In this thesis we will call by 
"road accident characteristics" features of accidents such as accident severity, 
the number of casualties, the number of vehices involved in the accident; char­
acteristics of the road network such as road class, speed limit; environmental 

OHA PTER 
2. STATISTICAL 
MODELLING 
OF ROAD ACCIDENT 
DATA 
47 
conditions such as road surface conditions, hazardous objects on the road; 
temporal characteristics such as day of the week, hour of the day and so on. 
The report book, that was used by Thames Valley Police to collect data about 
contributory factors of accidents, contains a total of 33 variables of this kind. 
There are some studies about road accident characteristics (Taylor and 
Barker, 1994-1995; Maycock, 1985), but the approach is more descriptive 
rather than trying a Statistical inferential approach. Generally there is a lack 
of exploratory studies of large data sets in this area. Several applications will 
be given in this thesis in Chapters 5 and 6 continuing the work described in 
Tunaru and Jarrett (19986) and Tunaru and Jarrett (1998a). 
For tables of small dimension cross-classified by accident 
characteristics 
the class of log-linear models has been used (Fienberg, 1980) successfully for 
Statistical modelling. A subset of data of this type extracted from Kihlberg, 
Narragon and Campbell (1964) has been analysed in textbooks, see Fienberg 
(1980) and Christensen (1990). This small table is used in Chapters 3, 4, 6 
and 8 as a gênerai example to illustrate the theoretical concepts involved. A n -
other example of a log-linear analysis is described in Agresti (1996), examining 
the characteristics of passengers in cars and light trucks involved in accidents. 
The 4-dimensional contingency table contains data on 68,694 passengers in 
the state of Maine in 1991 and the analysis revealed that, even for a large 
sample size, asymptotic significance tests can be unreliable. This conclusion 
will be reconhrmed by the results obtained in Chapter 5. 

CHAPTER 
2. STATISTICAL 
MODELLING 
OF ROAD ACCIDENT 
DATA 
48 
2.5 
Models for accident frequencies and type 
of accidents 
The previous two catégories of variables are sometimes studied jointly, devel-
oping models for relating road environment factors to both accident frequency 
and the type of accident. The models falling into this category try to relate 
the total number of accidents at a junction or along a length of road to a 
number of explanatory road environment variables, and also to investigate 
which variables are associated with the type of accident (Amis, 1996; Moun­
tain et al., 1996). In Amis (1996), an exploratory stepwise multiple régression 
approach was proposed in the flrst stage in order to détermine which covari-
ates should be retained for further régression modelling. If the square root is 
taken to normalise the Poisson variable, the mode! proposed fîrst is 
y/Yk = a + Xkß 
+ e 
where Yk is the number of accidents at the site k, ß is a vector of parameters, 
Xk is a vector of covariates and e is an error term having the standard normal 
distribution. In the second stage generalized linear models are fitted either for 
accident frequencies or for accident type. For example, if the site is defined as 
a junction, then the generalized linear model for accident frequencies proposed 
in Amis (1996) is 
Yk - Pois ( M * x (exp(a + 
X'kß))) 

CHAPTER 
2. STATISTICAL 
MODELLING 
OF ROAD ACCIDENT 
DATA 
49 
where M * is either the time period or the link length. 
A logistic model is 
discussed in the same paper for accident type. 
Stepwise multiple regression applied in an automated way can easily lead 
to misleading results. A particular covariate can be evaluated as significant as 
well as non-significant, depending on what explanatory terms are included in 
regression. This model selection procedure should be used with great caution. 
In addition, instead of attempting to normalise the Poisson variable, it would 
be better to use a Poisson or N B regression model. However, the idea as a 
whole is very interesting and further research could usefully be done in this 
area. This may require a multivariate approach a.nd a general framework is 
proposed now. 
Suppose that there are Y^i accidents of type i, at site k, that are Poisson 
distributed with mean A^, where i — 1 , 2 , . . . , M , k = 1 , 2 , . . . , A^. Given the 
means A*,-, the accident frequencies Yki are assumed independent from site to 
site, but accident frequencies of different types are not assumed independent. 
From the properties of Poisson distribution, the total number of accidents of 
type i is Kj-t ~ Pois(A +^). Conditioning on the total number of accidents over 
all sites Y++, it follows (Santner and Duffy, 1989) that 
( K + l , Y + 2 , . - . , V W ) | { Y + + = n} ~Multi(n,pO 
where the probabilities pi — 
Making a strong assumption that the mean 
number of accidents can be calculated, multiplicatively as a product of a site 

GHAPTER 
2. STATISTICAL 
MO DELLING 
OF ROAD ACCIDENT 
DATA 
50 
efFect and an accident type effect, A*» = ßk^i-, it follows that A + 1- = fi+9i and 
therefore pi = J^. The next step is to consider a log-linear model for the vector 
of probabilities (p,)i=i,2,....Af • Therefore. this is a log-linear analysis of accident 
characteristics. 
Thus, conditioning on the fact that the accidents h ave oc-
curred and knowing various information about the characteristics of accidents 
and road network, the relationships between thèse categorical variables can 
be investigated and the conclusion can be drawn about accidents as a whole 
on that road network. Since there are many variables of interest regarding 
accident characteristics, the log-linear modelling, in this context, should be 
able to deal. with large probability vectors in an efficient manner. A Statistical 
technique that does just that is graphical modelling which will be the subject 
of the following four chapters. 
2.6 
Summary 
In this chapter a number of différent Statistical models for road accidents have 
been reviewed. Statistical modelling for road accident data was greatly im-
proved by applying generalized linear models. Accident data can be viewed as 
an example of count data in gênerai and therefore models for counts developed 
in other areas of research can be also applied here. Nevertheless, accident data 
has some specific characteristics that makes it more difficult to analyse. Data 
corne from observational studies and it is almost always sparse. that is many 
counts are zéro or very small. This means that classical techniques applied 

CHAPTER 
2. STATISTICAL 
MODELLING 
OF ROAD ACCIDENT 
DATA 51 
in other areas cannot be always applied here and various changes need to be 
made. 
More powerful statistical methods are required to handle large and complex 
road accident datasets. 
Graphical modelling offers a solution to study the 
relationships between the variables under study, usually a large number, and 
multiple response variables models would give accident prediction modelling 
a new dimension. 
Predictive accident models were developed mainly at an univariate level. 
The lack of models for joint types of accident gives the statistician an op­
portunity to research a vast area. The benefits would be a better and more 
structured information for local authorities that could in return spend the 
money more wisely and help reducing the number of accidents further. 

Chapter 3 
Graphical log-linear models 
3.1 
Introduction 
In the last décade graphical modelling has become an important tool in applied 
Statistical modelling. A graphical model is usually identified with a pictorial 
représentation of a Statistical model, thus making a straightforward connection 
with graph theory. Graphical models are mainly used to represent conditional 
independencies and they cover exploratory studies, where ail variables are 
treated as response variables, and more causal approaches where the variables 
are divided into response and explanatory blocks. The potential of applications 
includes biostatistics, genetics, sociology, éducation studies- see the examples 
in Edwards (1995) and Mohamed, Diamond and Smith (199S), and credit 
scoring in finance (Hand, McConway and Stanghellini, 1997; Stanghellini, 
McConway and Hand, 1999) among others. 
These models can be also ap­
plied to econometrics (Lyngaard and Walt her, 1993) and theoretical statistics 
52 

CHAPTER 
3. 
GRAPHICAL 
LOG-LINEAR 
MODELS 
53 
(Stangheilini. 1997). A directed graph representing an econometric model for 
traffic fatalities lias been illustrated in Roh, Bessler a,nd Gilbert (1999)-
In addition, the concept of graphical rnodel is fundamental in the devel-
opment of Mar ko v Chain Monte Carlo stratégies for applied Bayesian statis-
tics. 
It is also used as a tool for communicating complex Statistical models 
analysed in the computer program W i n B U G S : see Spiegelhalter, Thomas and 
Best (1998). 
In this chapter, the theoretical éléments on which graphical modelling is 
based are reviewed, and some terminology from graph theory, used in the 
subséquent chapters, is introduced. A 4-dimensional contingency table is used 
throughout to illustrate various concepts related to graphical modelling. 
In Section 3.2 the motivation for applying graphical modelling for analysing 
large contingency tables is given. Section 3.3 contains a short revision of con-
ditional independence and a list of various concepts of graph theory used later 
on. Then, in Section 3.4, the Markov properties deflning the graphical mod­
els and the methodological skeleton for practical applications are outlined. 
Chain graphical modelling is a généralisation of graphical modelling for situ­
ations when variables are ordered by some causal a priori assumption. 
The 
corresponding Markov properties and other results are summarised in Sec­
tion 3.4.2. Various model sélection procédures are discussed in Chapter 4 and 
a nevv battery of Bayesian model sélection procédures that can be applied for 
contingency tables is proposed in Chapter 8, Section 8.4. 
Chapters 5 and 6 are com p lernen t. ar y to this one, discussing some practical 

CHAPTER 
3. 
GRAPHIC 
AL LOG-LINEAR 
MODELS 
54 
applications to large and sparse contingency table sumrnarising road accident 
data and methods of reducing the dimensionality of the Statistical analysis 
vvith the help of a collapsibility concept and corresponding theoretical results 
as given in Asmussen and Edwards (19S3). 
3.2 
The need for graphical modelling 
A national road accident database will contain a large number of variables rep-
resenting characteristics of the recorded road accidents. An important problem 
is then to identify the associations, or in a complementary way, the conditional 
independence relationships between the variables under study. For Statistical 
analysis, the data can be summarised in a multi-dimensional contingency ta­
ble cross-classified by the variables under study. Because of the Yule-Simpson 
paradox (Simpson, 1951), the analysis of marginal tables, involving only two 
or three variables at a time, can be very misleading. 
Consider, for instance, a subset of data reported in Kihlberg et al. (1964). 
The variables are 
• A = Driver ejected (No / Yes) 
• B — Car type (Small / Standard) 
• C = Injury type (Not severe / Severe). 
and the data is shown in Table 3.1. 
The Statistical analysis of contingency tables like this, where all variables 
are viewed as response variables, is based on the class of log-linear models, 

CHAPTER 
3. GRAPHICAL 
LOG-LINEAR 
MODELS 
Table 3.1: A 3-way contingency table of road accidents 
55 
Driver 
Car 
Ejected 
type 
Not Severe 
Severe 
In jury type 
No 
Small 
Standard 
410 
2026 
262 
1426 
y es 
Small 
Standard 
45 
133 
103 
426 
Source: Kihlberg et al. (1964). 
which is perhaps the most useful class for contingency tables (Haberman, 1974; 
Bishop, Fienberg and Holland, 1975; Christensen, 1990). Log-linear models 
express the logarithms of the cell probabilities as sums of main effects and 
interaction terms, by analogy with analysis of variance ( A N O V A ) models for 
continuous data. The parameter pijk represents the probability of the cell at 
the intersection of level i of A, levelj/ of B and level h. of C. The saturated log-
linear model for a three dimensional contingency table can be parameterised 
as 
l°gPr7fc = U + «1(0 + «2(» + «3(Ä) + u12(tj) + «13(tfc) + u23{3k) +^123(tjfc), 
where, for instance, the term «12(1» represents the interaction between vari­
ables A and B. The terms ii 1 2(^), uys(ik)> u23(jk) a
r
e ealled 
two-way interac­
tion terms and Ui23(tjfc) <s calted a three-way interaction 
term. The mutual 
independence model. that is the model which spécifies that ail variables cross-

CHARTER 
3. 
GRAPHIC AL LOG-LINEAR 
MODELS 
classifying the table are independent, is 
56 
\°&Pijk = u + u ] { i ) + w2(j) 4- w3(jt), 
and the all two-way interaction model is 
Since there are more parameters on the right side of the équation than on the 
left side, the représentations are overparameterised. Thus, in order to have a 
unique représentation, sorne A N O V A - l i k e constraints are imposed. The main 
effects are always kept in the model because it is very hard to interpret a 
model having a higher-order relative term of a main effect not présent in the 
model. 
Since there are only three variables involved in this example, it is possible 
to test the fit of all possible modets. The results are shown in Table 3.2. In 
this table, the model formula is expressed using only the terms of highest in­
teraction. Thus, for example, [^][ß][C] dénotes a log-Linear model containing 
the main effects of the factors A, B and C. while [AB][i?C] is an abbreviation 
for A 
B + C -Y A.B + B.C. 
a model containing ail the main effects and 
the interactions between factors A and B and respectively, between B and C. 
The scaled déviance 
(McCullagh and Neider, 1989) is the statistic employed 
to test the model. The saturated model [ylfîC] fits the data perfectly and has 
déviance 0. In gênerai, the scaled déviance is the generalised log-likelihood 

CHAPTER 
3. 
GRAPHICAL 
LOG-LINEAR 
MODELS 
57 
ratio statistic for comparing each model with the saturated model. Under the 
null hypothesis that a particular model is correct, the scaled déviance is as-
ymptotically distributed as chi-squared with the indicated number of degrees 
of freedom (denoted by df). This distribution is used to calculate the P-value, 
the probability of obtaining the observed or a larger déviance. There are two 
Table S.S: Models fitted to the collision-rollover 
data 
Model 
Formula 
Scaled 
déviance 
df 
P- value 
1 
[A}[B}[C] 
298.69 
4 
0.000 
2 
[AB]{C] 
289.89 
3 
0.000 
3 
[AC][B] 
12.69 
3 
0.005 
4 
[BC][A] 
297.93 
3 
0.000 
5 
[AB][BC] 
289.13 
2 
0.000 
6 
[AB][AC] 
3.89 
2 
0.143 
7 
[BC][AC] 
11.93 
2 
0.003 
8 
[AB][BC]{AC] 
1.15 
1 
0.284 
9 
[ABC] 
0.00 
0 
1.000 
models that fit the data well, models [AB][£C][4C] and [A£][AC]. The sec­
ond model is nested within the first one so it is preferred because it has fewer 
parameters and is easier to interpret in terms of conditional independencies. 
The model informs us that car type, B, and injury type, C , are independent 
given driver ejected, A. 
This means that. knowing whether the driver has 
been ejected or not in an accident, fmding out the type of the car will not 
help in any way to predict the type of injury in that accident. Therefore, B is 
irrelevant to C when A is known, or in other words it is only A which is associ-
ated with C. This conditional independence relationship is denoted, following 

CHAPTER 
3. GRAPHICAL 
LOG-LÏNEAR 
MODELS 
58 
Dawid (1980), by B IL G \ A. À similar notation will be used throughtout 
the thesis for the conditional independence of sets of random variables. 
The problem here is that there is more information available and there is a 
fourth variable D — Accident Type (Collision / Rollover) so the Table 3.1 can 
be further cross-classifled. Even if the interest is focused on the relationship 
between type of injury, type of car and driver being ejected it is not wise to 
take out of the analysis the variable D, the accident type. The full data is 
shown in the 4-dimensional Table 3.3. 
Table 3.3: Jrway contingency table of road accidents 
A 
B 
C 
Driver 
Car 
Accident 
Injury type 
Ejected 
type 
type D 
Not Severe 
Severe 
No 
Small 
Collision 
350 
150 
Rollover 
60 
112 
Standard 
Collision 
1878 
1022 
Rollover 
148 
404 
yes 
Small 
Collision 
26 
23 
Roi lover-
19 
80 
Standard 
Col li si on 
111 
161 
Rollover 
22 
265 
Source: Kihlberg et al. (1964). 
One of the models that fits Table 3.3 well is [ACD][BCD]. 
The impor­
tance of this model will be better described in the context of various model 
sélection procédures compared in Chapter 4. This model can be again inter-
preted in terms of conditional independence such as A _LL B \ {C, D}7 which 
means that driver ejected is independent of car type given accident type and 

CHAPTER 
3. 
GRAPHICAL 
LOG-LINEAR 
MODELS 
59 
injury type. In addition, B and C are not conditionally independent which 
seems to contradict the analysis of the 3-dimensional table. 
Moreover, the 
conditional independence between A and B is in contradiction with the previ­
ous conclusion. This phenomenon, where a relationship between two variables 
is changing to the opposite when more (or less variables) are considered, is 
called Yule-Simpson paradox or just Simpson's paradox and it highlights the 
importance of taking a multivariate approach, by involving all relevant vari­
ables under study. Therefore a powerful technique is needed to analyse large 
tables in an efficient manner without losing important information or arriving 
at misleading conclusions. 
This looks like a problem without any solution. On the one hand all the 
variables under study should be considered in order to avoid Simpson's para­
dox, and on the other hand there is a natural tendency to simpLify the picture 
to have more reasonable interpretations. 
This is where graphical 
modelling 
comes in as a very useful exploratory technique for describing the conditional 
independencies between the variables. 
3.3 
Preliminaries and terminology 
3.3.1 
Background 
The seminal ideas of graphical modelling can be found in several areas of 
science where statistics plays an important role: 

CHAPTER 
3. 
GRAPHICAL 
LOG-LINEAR 
MODELS 
60 
1. in statistical physics, Gibbs (1902) studied a large system of particles of 
a gas or a solid where, for a subgroup of particles, only the interactions 
between the particles in the subgroup and the neighbour particles are 
considered significant. 
2. in genetics, path analysis (Wright, 1934) was proposed for studying heri­
table properties of natural species using graphs with arrows from parents 
to children. These ideas were later taken up in economics and social sci­
ences for developing causal models (Wold. 1954; Wold, 1960; Blalock, 
1971). 
3. in theoretical statistics, Bartlett (1935) used interactions for contingency-
tables in a similar way to their use in statistical physics. The counts in 
a group of cells of the table were independent of the counts in the rest 
of the table , given the counts in the boundary of the group. 
Graphical models have been developed for categorical variables as a subclass 
of hierarchical log-linear models (Darroch, Lauritzen and Speed, 1980; Lau-
ritzen, 1996; Whit taker, 1990; Wermuth and Lauritzen, 1990; Edwards, 1995), 
for continuous Gaussian variables, better known as covariance selection mod­
els (Wermuth, 1976; Whittaker, 1990; Lauritzen, 1996), and for a mixture 
of continuous Gaussian and categorical variables (Lauritzen, 1989; Edwards, 
1990; Edwards, 1995). In the first part of the thesis only graphical models for 
categorical variables and graphical chain models are considered. Other forms 
of graphical models, like directed graphical models or graphical chain models 

CHAPTER 
3. 
GRAPHICAL 
LOG-LINEAR 
MODELS 
61 
with categorical, discrète and continuous (not necessarily normal) variables, 
are used implicitly in conjunction with Markov Chain Monte Carlo methods 
applied, in the second part of the thesis. 
3.3.2 
Graph theory concepts 
The account of the éléments of graph theory in this subsection follows Lau­
ritzen (1996). Formally, a graph is a pair G = (V, E) where V is a hnite set of 
vertices (which in this thesis correspond to the variables under examination) 
and E is the set of edges, which is a subset of the set of ordered pairs of dis­
tinct éléments of V". The number of vertices in V is clenoted by |V|. A l l the 
graphs in this thesis are assumed to be simple, that is no multiple edges or 
loops are allowed. ff (a, 6) 6 E but (6, a) ^ E. then the edge is called directed 
and is represented by an arrow from. a pointing towards b; it is said that a is 
a parent of b and b is a child of a. denoted by a —> 6. The set of parents of 6 is 
denoted by pa(6) and the set of children of a as ch(a). ff both (a. b) € E and 
(6, a) 6 E then the edge is undirected and represented by a line joining a to b; 
the vertices are then called adjacent or neighbours, denoted by a ~ b. The set 
of neighbours of a vertex a is denoted by ne(a). For a subset of vertices A, the 
notations pa(*4), ch(.4) and ne(„4) dénote the collection of parents, children 
and neighbours respectively of vertices in A that are not themselves éléments 
of A. For example, in the graph in Figure 3.1, 5' and N are both parents of A 
whereas {S,T,L} 
is the parental set of the set {A.N}. 
In the same time, R 
has only one neighbour L and N has none. In spite of the fact that iV has no 

CHAPTER 
3. 
GRAPHICAL 
LOG-LÏNEAR 
MODELS 
62 
Figure 3.1: A simple graph, neilher directed nor undirected 
neighbours, this node has parents and children so the concept of houndary of 
a set of vertices A, defined as bd(.4) = pa(^4) U ne(.4), is just a natural exten­
sion of the set of neighbours for situations where there is a mixture of directed 
and undirected edges. Another useful concept from graph theory that will be 
used later is the closure of a set of vertices A, defined as cl(^4) = A U bd(>l). 
A graph with. only undirected edges is called an undirected graph, and if ail 
edges are directed the graph is called directed. The undirected graph obtained 
from G by replacing arrows with. lines is called the undirected version G~ of 
G- A set of vertices that has ail possible pairs adjacent is called 
complète. 
A subset A Ç V is a clique if it is complète and there is not other subset 
B. 
A Ç B Ç V that is also complète. 
A path of length n from a to 6 is a séquence a = a 0 ; . . . . an = b of distinct 
vertices such that (a»_i,ai) G E for ail i = 1 , 2 ; . . . . T Î . 
A n n-cycle is a path 
of length n with a = b. The cycle is called directed if one or more of its 

CHAPTER 
3. 
GRAPHICAL 
LOG-LINEAR 
MODELS 
6 3 
edges are arrows. If there is a path from a to 6, denoted by a h-> 6. and if in 
addition 6 i—»• a. it is said that a and 6 are connected. This is an équivalence 
relationship and the équivalence classes are called connectivity coraponents. A 
subset S Ç V is said to be an (a, b) separator if ail paths from a to 6 intersect 
5. The subset S is said to separate A from. # if it is an (a,b) separator for 
every a € A, b 6 B. For the graph in Figure 3.1, {S,N} 
séparâtes {A} and 
{R,Tj 
L). The vertex a such that a i—» b and 6 
a is called an ancestor of 
6, and the vertex b is called a descendant of a. The set of ancestors of ail 
vertices from the subset b is denoted by an(6) and the set of descendants of 
ail vertices from a subset a is denoted by de[a). The set of non-descendants 
of a is denoted by nd(a). For the graph in Figure 3.1, the ancestors of A are 
R,L,T, 
S,N and A lias no descendants. 
If bd(a) Ç A for ail a E A then A is said to be an ancestraî 
set. In an 
undirected graph, the ancestraî sets are unions of connectivity components. 
The intersection of a collection of ancestraî sets is again. ancestraî, so there 
is a smallest ancestraî set containing A which is denoted by An(A). 
For 
example, in the graph of Figure 3.1, A n ( { R , £ , j V , S , T } ) - 
{R,L,N,S,T} 
whereas A.n({A, LyN}) 
= {A,N: S,L,T, 
R). 
Chain graphs are graphs where the vertex set V can be partitioned into 
numbered blocks, forming a so-called dependence chain V - V(1)U- • -U V ( T ) , 
such that ail. edges between vertices in the same block are undirected and ail 
edges between différent blocks are directed, pointing from the blocks with lower 
numbers to the blocks with higher numbers. Thèse graphs are characterised 

CHAPTER 
3. 
GRAPHICAL 
LOG-LINEAR 
MODELS 
64 
vii). 
.Y.(2), 
A 
B i 
i D 
Figure S.2: Chain graph with dependence chain {A, B} U {C, D} U {E} 
by having no directed cycles. The connectivity components indicate the block 
partitioning of the chain graph. A graph Q is a chain graph if and only if its 
connectivity components induce undirected subgraphs. It is easy to identify 
the chain components simply by removing all directed edges before taking 
connectivity components. The graph in Figure 3.2 illustrates the definitions 
given above. The boxes are not part of the graph, but are used to indicate 
the partition into blocks of the chain graph. The connectivity components 
are easy to determine: they are {A. .£?}, {C, D} and {E} and these are the 
blocks. If there had been an arrow from C to A , the graph could not have 
been a chain graph, even after determining the new connectivity components, 
which would have been {A, B, C\ D] and {E}. The reason is that there would 
be a directed cycle A —> B —> C —> A and this is not allowed by definition 
because it will create problems regarding interpretability of the model and 
model specification. 
The moral graph Çm of a chain graph Q is the undirected graph with the 
same vertex set V but with a ~ b in Çm if and only if either a —> 6 or b —* a 

CHAPTER 
3. GRAPHICAL 
LOG-LINEAR 
MODELS 
65 
or if there are <$i,<!>2, connected in the same block, such that a —> 6\ and 
b —> ¿2- For a directed. acyclic graph. that is a directed graph with no cycles, 
the moral graph is obtained from the original graph by "marrying parents" 
with a common child and subsequently deleting directions on all arrows. 
A triangulated graph is an undirected graph with the property that every 
cycle of length n > 4 has a chord, that is two non-consecutive vertices that 
are neighbours. This type of graph is sometimes also called ckordal. 
3.3.3 
Conditional independence 
Suppose that Xv = (X^,,.. ,X<i) is the entire set of random variables of 
interest (often denoted by the index K), where each variable Xv takes values 
in. a set $lv. 
Then Xv takes values in Ï7 = Oy = Üvev^«- 
Ii A C. V let 
— riveA 
éléments of QA will be denoted by XA ~ (X-V)VÇA and 
the corresponding vectors will be denoted as XA = 
(XV)V^A-
In this thesis, / (or sometimes p) is used as a generic symbol for the 
probability density of the random variables involved. The random vectors X 
and. Y are called conditionally independent given the random vector Z if and 
only if 
f(z,V 
| z) = f{x \ z)f(y \ z) 
for all triples (x,y,z) 
for which f(z) 
> 0. 
Given the applied character of 
the thesis, only variables having a positive density probability function, for 
continuous variables, or a positive mass probability function, for discrète vari-

CHAPTER 
3. 
GRAPHICAL 
LOG-LINEAR 
MODELS 
66 
ables, are taken înto account. This will ensure that ail conditional densities 
are defined. 
Several équivalent définitions of conditional independence are 
f(x,y,z) 
= 
f(xtz)f(ytz)/f(z)1 
f(x \y,z) 
= 
f(x | z), and 
/(.t, y, z) 
= 
h(x, z)k(y,z), 
for some h, k. 
It is very easy to prove the following properties (Lauritzen, 1996), where h, 
dénotes an arbitrary measurable function on the sample space Qx' 
( C l ) : if X AL Y \ Z then Y AL X \ Z 
(Symmetry) 
(C2) : if X AL Y \ Z and U = h{X) then. U AL Y \ Z 
(Réduction) 
(C3) : \î X ALY \ Z and U = h{X) then X AL Y \ (Z, U) 
(Redundance) 
(C4) : if X AL Y \ Z and X AL W \ ( K Z) then X IL (V, W) \ Z 
(Contraction) 
(C5) : if X AL Y \ Z and X AL Z \ Y then X AL (Y, Z). (Strong contraction) 
It should be noted that the assumption of the positive densities or mass 
functions is needed to prove (C5). 
Axioms of irrelevance for road accident characteristics 
As pointed out in Lauritzen (1996) the first four properties (Cl)-(C4) can be 
interpreted in a non-probabilistic language as gênerai axioms of irrelevance. A 
model of irrelevance is given by the graph séparation property for undirected 

CHAPTER 
3. 
GRAPHICAL 
LOG-LINEAR 
MODELS 
67 
graphs. [f A,B and C are subsets of the vertex set V of an undirected graph 
G 
Q = (V, E) the séparation of A and B by C is denoted by A _L B \ C. Then 
it can be easily checked that 
Q 
Q 
(Cl) Symmetry: if A _L B \ C then B 
LA\C 
(C2) Réduction: if A 1 £? | C and IJ Ç A then U 
LB\C 
(C3) Redundance: if v4 î £ | C and U Ç A then A 1 £ | (C7 U U) 
(C4-) Contraction: if A _L £ | C and A ± D \ (B U C) then 
A i ( ß u D ) |C 
If the subsets are disjoint then 
G 
G 
G 
(C5) Strong contraction: if A J_ B \ C and A 1 C \ B then A 1 (S, C ) is also 
true. This correspondence shows that graphs can be used to conceptualise 
and communicate complex scientific ideas. The use of graphs in this way will 
become particulary important in Chapters 8 and 9 where, in relation with 
Bayesian graphical modelling, it gives a basis for computation as implemented 
in W i n B U G S (Spiegelhalter. Thomas and Best, 1996). 
3.4 
Graphical models for contingency tables 
3.4.1 
Graphical Models 
Let Xy = {Xv)vev 
be a vector of d — |V| caiegorical random variables. The 
catégories are labelled by positive integers so that each variable Xv takes values 
in flv = /„ = {1,2,..., rv}. 
Let T = Ylvçv h dénote the set of ail possible 
configurations of Xy. For any subset A. Ç V, let XA = YIVÇA h- The cells of 

CHAPTER 
3. GRAPHIC 
AL LOG-LINEAR 
MODELS 
68 
the contingency table resulting from cross-classification of Xv are indicated 
by i € T, and i_\ E 1A dénotes a cell from the marginal table of XA- 
Suppose 
that observational units are classified according to factors in V and the data 
is summarised in contingency tables, by counts n = {n(i) : i G Î ) where n(i) 
is the number of units that fall in the ith cell. The table has dimension equal 
to the number of variables d. For A C V the counts on the A-marginal table 
= {n(iA) 
: ÎA G XA] are given by summation over all cells in Ty\A so for 
A = 0 it follows that 
n(i$) = ^n(i) 
= |n| = ./V, 
iei 
the total number of observations. Considering B C V and a cell ig € Xß, the 
iß-slice 
of the table is obtained by classifying only those observations for a 
fixed level of each. variable in B. This means that the i^-slice has cells in TA 
where A = V \ B, and counts n^B(iA) — nfz^, iß) where the %A is variable and 
IQ is fixed. 
For the purposes of this thesis only three différent sampling schemes are 
considered. 
1. A l l cell counts and the total number of observations are random. This 
situation appears when counting the number of events in fixed time pe-
riods (such as traffic accidents) and classifying them accordingly to type 
of road. accident severity. day of the week etc. The sampling scheme 
assumes that the cell counts {n(i)}i^j are independent and Poisson dis-

CHAPTER 
3. 
GRAPHICAL 
LOG-LINEAR 
MODELS 
69 
tributed. The joint distribution of counts is 
P r [ n ( 0 , x 6 I] = n - M î T « « P ( - m ( 0 ) 
where E(n(i)) = 
m(i). 
2. The total number of observations is fixed but cell counts are otherwise 
random. This sampling scheme assumes that the observations are inde­
pendent and the probability that a given observation belongs to the cell 
z is p(i) > 0, so the joint distribution is a multinomial distribution 
By conditioning upon the total number of observations N the Poisson 
distribution becomes multinomial. 
3. The number of observations n(is) 
— Y,iA&iA
n%°^A) 
in each ¿o-slice is 
fixed for some B C V. The sampling scheme is based on the assumption 
that the counts in the slices are independent and multinomially distrib­
uted as in case 2, with cell probabilities in slice ig equal to P(Í,\\ÍB)- 
The 
joint distribution is product-multinomial (also called restricted multino­
mial) 
P r [ n ( ¿ ) , ¿ € 2 ] 
= 
J[ 
= 
n 
r w , n - M ! ¿ i
p
( 
, A 
1 
,B> 

CHAPTER 
3. 
GRAPHÏCAL 
LOG-LÏNEAR 
MODELS 
70 
This distribution can be also obtained from the Poisson distribution by 
conditioning, in addition to the condition shown for 2. on n(tg), is £ 1B-
The log-linear models are based on expansions for either log(./Vp(¿)) or 
logp(i) (whîch is not much différent since log ¿V is a constant for the multino-
mial sampling) as a sum of main effects and interaction terms 
logp(¿) 
= 
53 Uo(0» 
aÇV 
subject to ANOVA-like constraints to make the expansion unique. The terms 
it£ are called |a|-order interaction terms. 
The first order interaction terms 
are also called main effects and should usually be included in the log-linear 
models. 
If the u-terms are written in the form tt^ , then the subscript (in 
this case a) shows the subset of variables and the superscript (V in this case) 
shows the set of variables for which the log-linear model is proposed. 
For 
small dimensional tables a more straightforward notation, depending on the 
context, is used. 
For a given log-linear model, denoted for convenience by X, a graph can 
be associated, called the interaction graph, which is an undirected graph with 
vértices corresponding to the variables in V , and an edge between two vértices 
(variables) v and w if and only if there is an interaction term u^v 
wy in L. 
The 
properties of the interaction graph are studied in Darroch et 
al. (1980). 
A hierarchical log-linear model L is specified by its associated 
generating 
class. This is defined as the class of subsets a of V, maximal with respect to 

CHAPTER 
3. GRAPHIC AL LOG-LINEAR 
MODELS 
71 
inclusion, such that ua ^ 0. The subsets a are called the generators of the log­
linear model and the model may be specified by enumerating the generators in 
square brackets. For instance, the log-linear model A + B-rC-r 
A.B + A.C will 
be specified as [A£][AC]. 
Différent hierarchical models may have the same 
interaction graph. The simplest example is given by the models [A£C] and 
[AB}[AC]\BC]. 
The restriction La, of a log-linear model L to a set o Ç V , is a log-linear 
model for the set of probabihties pa, whose generating class can be determined 
from the generating class of L by removing all factors in ac — V \ a, the 
variables in V which are not in a, and then removing the redundant subsets. 
Graphical models can be described as a sub-class of hierarchical log-linear 
models with the maximal permissible higher-order interactions corresponding 
to a given graph. 
More formally, a graphical model is a family of proba-
bility distributions Pg which satisfies some Markov property over a graph G 
(Whittaker, 1990; Lauritzen, 1996). More détails about the Markov proper-
ties of a family of probability distributions, over a graph, are given below. 
The decomposable models are graphical models whose interaction graphs con-
tain no cycle of length greater than 3 without a chord (Lauritzen, Speed and 
Vijayan, 1984). 
This class of log-linear models is better known in the lit-
erature (Haberman, 1974; Bishop et al., 1975; Christensen, 1990; Santner 
and Duffy, 1989), one reason being that, for decomposable models, maximum 
likelihood estimators have closed forms. 
From the inference point of view, the three sampling distributions are 

CHA.PT ER 3. 
GRAPHIC AL LOG-LINEAR 
MODELS 
72 
related and without loss of generality, the main results can be illustrated 
using only one distribution, like the multinomial distribution (Agresti, 1990). 
The unknown quantities that are the subject of Statistical modelling are the 
probabilities p(i) of the cells i of the contingency table. The table of counts 
is a sufficient statistic for the parameters p = (p(i))ter (Whittaker, 1990). 
In this thesis all log-linear models are assumed to be hierarchical so in 
the model formula only the maximal terms need to be specified. A hierarchi­
cal model is based on the assumption that if a lower-order interaction term 
is miasing then all its higher level relatives interaction terms are out of the 
model. So if any of u i 2 , U i 3 , u23 is set to zéro then U123 should be also set to 
zéro. Graphical models require an extra condition in a somewhat opposite di­
rection. For a graphical model, if ail interaction terms of some lower level are 
included in the model then the higher relative interaction term should be also 
included. For example, if Ui2 ;Wi4,u 24 are in the log-linear expansion then U\24 
should also be included. Graphical models are fully interprétable in terms of 
conclitional independencies. In addition, it is worth pointing out that, because 
the saturated model is graphical, any log-linear model can be nested within a 
graphical model. This suggests that for any log-linear modelling relative to a 
contingency table, it may be useful to find first the simples! graphical model 
fitting the table and then try to renne the analysis. 
Some graphical models have already been encountered in Section 3.2. Some 
other simple models are described now to explain the différence between a 
graphical and a hierarchical model. With only three variables A , B and G for 

CHAPTER 
3. 
GRAPHICAL 
LOG-LINEAR 
MODELS 
73 
simplicity, the saturated log-linear model (which is hierarchical and graphical) 
is 
The log-linear model 
l ogPijfc = « + Ul(t) + «2(j) + 
u3(k) + Ul3(ifc) + «23(jJfc) 
is hierarchical, but 
logpiji = U + 
+ W2(j) "I- W3(fc) + Ui3(ifc) + U23(jk) + «123(yA) 
is not hierarchical. The hierarchical model of no three-way interaction 
log Pijk =U-\- 
+ U2(j) + U3(A) + tii2(tj) + ^13(ifc} + u23(jA:) 
is not graphical because the inclusion of uv¿, u 1 3 and u
2
3 would require the 
inclusion of «123 too. 
The interaction graph of a graphical model for categorical variables, is 
equivalent to the conditional independence graph, which is the main tool in 
graphical modelling (Whittaker, 1990). The conditional independence graph 
(for short the independence graph) is an undirected graph Q = (VtE) 
where 
the set of vertices V = {1,2, ...,d] 
is corresponding to the set of variables 

CHAPTER 
3. 
GRAPHICAL 
LOG-LINEAR 
MODELS 
74 
B 
D 
C 
Figure 3.3: Undirected graph Q = 
where V = {A, B,C,D) 
and E = 
{AB,ACtBC,BD} 
under study Xy = {Xi,... 
,X^}, and where 
is not in the edge set E if the 
variables Xi and Xj are independent given the remaining variables Xv\{i,j}> 
Very often the random quantifies are denoted with the labels of their nodes 
in the graph. 
Markov properties on undirected graphs 
A probability measure P on Ù has: 
(P) the pairwise Markov property, relative to G-, if for any pair of non-adjacent 
vertices a ^ b, 
a Al b | V \ {a,b}; 
thus, in Figure 3.3 A is independent of D conditional on B, C ; 
(L) the local Markov property. relative to Ç% if for any vertex a £ V\ 
a Al (V\cl(a)) | bd(a); 
again on the graph in Figure 3.3, D is independent of A, C given bd(£>) = B: 

CHAPTER 
3. 
GRAPHICAL 
LOG-LINEAR 
MODELS 
75 
Figure S.Ą: The global Markov 
-property 
(G) the global Markov property, relative to Q, if for any triple (A,B,S) 
of 
disjoint subsets of V such that S separates A from B in Q, 
A1LB\S. 
The global Ma.rkov property can be understood as a separation property, see 
Figure 3.4. If all paths connecting nodes from A to nodes from B intersect 
at least one node from S then A _IL B \S. Because of the general regularity 
assumptions made, it is true that if A i L B | C U D and A i L C \ B U D then 
A IL (B U C) I D for any disjoint subsets of variables A,B,C,D. 
The main 
result regarding these Markov properties is described next. 
T h e o r e m 3.1 If G is an undirected graph then the global Markov 
property 
(G), the local Markov property (L) and the painoise Markov property (P) are 

CHAPTER 
3. 
GRAPHICAL 
LOG-LINEAR 
MODELS 
76 
all 
équivalent. 
For a proofj see Lauritzen (1996). 
The most important property is the global Markov property because it 
gives a gênerai criterion for dcciding when two groups of variables A and B 
are conditionally independent given a third group of variables S. 
Under the assumption. that the joint density f(V) 
is everyvvhere positive 
the local Markov property is also équivalent to the following factorisation of 
f(V) 
f(v) = n 
m»C) 
where C is the set of cliques of the graph Ç (Lauritzen, 1996). Hence, for the 
graph in Figure 3.3 the joint density can be factorised as 
f{V) 
= 
ii>l{A,B,C)H,D) 
because the cliques of the graph are {A, B, C} and 
{D}. 
The process of building a graphical model, or equivalently its corresponding 
conditional independence graph. can be illustrated using the collision-rollover 
data in Table 3.3. The set of vertices of the graph corresponds to the variables 
under study. In this case four vertices are needed, that can be denoted again 
by A.BtC 
and D. 
Then an edge is présent for each two-way interaction 
term in the model. This is the same thing as having no edge between two 
vertices when they are conditionally independent given the remaining set of 
variables. This pairwise Markov property is used for building the graph which 

CHAPTER 
3. GRAPH 
(CAL LOG-LINEAR 
MODELS 
77 
C 
D 
Figure 3.5: Conditional 
independence grapk for collision-rollover 
data; A is 
Driver ejected. ß is Car type, G is Injury and D is Accident type 
is obviously an undirected graph. The independence graph corresponding to 
the rnodel [ACD\[BCD] 
h as the following set of edges: AG, AD,CD, 
BC, BD 
and is represented in Figure 3.5. 
Because all Markov properties are équivalent, after constructing the condi­
tional independence graph, the independence relationships between the vari­
ables can be read directly from the graph, using the global Markov property. 
The variables B and A are not directly connected on the graph but they are 
linked via either the variable C or the variable D. This is telling us that B and 
A are independent given {C, D}. Although in this case it does not look that 
global Markov property is more helpful than the pairwise Markov property 
used to build the graph, vvhen a large number of variables is used, and the fi­
nal graphical model is proposed as a resuit of a sélection algorithm, the global 
Markov property (G) is a valuable tool to read the conditional independencies 
correctly. 

CHAPTER 
3. 
GRAPHICAL 
LOG-LINEAR 
MODELS 
78 
3.4.2 
Graphical Chain Models 
Chain graphs are a combination of directed and undirected edges such that 
there are no directed cycles in the graph (Section 3.3). They originated in 
statistical modelling of substantive research hypotheses in the social sciences 
(Wermuth and Lauritzen, 1990; Cox and Wermuth, 1993). Quite often, the set 
of the variables under study can be divided into blocks by some prior ordering 
criterion. The partitioning imposed by the research hypotheses requires nat­
urally that variables in the same block are to be treated on an equal footing, 
and variables from lower-numbered blocks influence the variables in the blocks 
with higher order numbers. In a chain graph G, the vertex set V is partitioned 
into disjoint blocks V = V(l) U • • • U V{T) such that the vertices within each 
V(f) has undirected edges between vertices, and the arrows point from vertices 
in blocks with lower number to those with higher number. Thus a directed 
acyclic graph is a chain graph where each block contains only one vertex and 
an undirected graph is a chain graph with only one block. For t < T, define 
C(i) = l / ( l ) U - U V ( i ) . 
Given a particular chain graph Q it is said that a probability P satisfies: 
(PB) the pairwise block-recursive Markov property if for any pair a f/> b it is 
true that 
aMb\C(t*)\{a,b] 
where i * is the smallest t that has a. b E C(/); 
(PC) the pairwise chain Markov property, if for any pair a ^ b with b a 

CHAPTER 
3. GRAPHÏCAL 
LOG-LINEAR 
MODELS 
79 
non-descendant of a, 
a AL b | nd(a) \ {6}; 
(LC) the local chain Markov property, if for any vertex a 6 V , 
a AL nd(a) | bd(a); 
(GC) the global chain Markov property if for any triple (A,B,S) 
of disjoint 
subsets of V such that S séparâtes A from B in {pAn(AjtfuS)) 
> the moral 
graph of the smallest ancestral set containing A U B U 5 , it is true that 
AALB\S. 
The same chain graph can have attached différent dependence chains. The 
property (PB) is relative to a particular dependence chain. It can be shown 
(Lauritzen. 1996) that 
Theorem 3.2 For a chain graph Ç, the global chain Markov property 
(GC), 
the local chain Markov property (LC), the pairwise chain Markov 
property 
(PC) and the pairwise block-recursive Markov property (PB) are ail 
équivalent. 
A useful practical resuit is that a chain graph Ç possesses the Markov prop-
erties of its associated moral graph Qm (Whittaker, 1990). Frydenberg (1990) 
shown that (LC) is équivalent to a factorisation of the joint distribution as 
f(v) 
= 
Ilf(V(t)\p4V(t)]), 
t 
(3.1) 

CHAPTER 
3. 
GRAPHICAL 
LOG-LINEAR 
MODELS 
80 
V ( l ) 
B 
V(3) 
D 
C 
Figure 3.6: Chain graph with the dependence chain {A} U {B,C} 
U {D} 
where a £ p&[V{t)] if there is a directed link from a to a vertex of V(f). This 
factorisation is similar to the case of a directed acyclic graph where each block 
has been considered a single vertex in the directed graph. Moreover, each term 
in the factorisation (3.1) can be further factor-ised into 
where Ct is the set of cliques of the undirected graph with the set of vertices 
(V(i)Upa(V(i)]), edges consisting of the undirected links between the vertices 
of V(i), 
the arrows between pa[V(£)] and V(t) 
transformed into undirected 
lines, and a complète set of lines between the vertices of pa[V /(t)]. Thus for 
the chain graph in Figure 3.6 the following factorisation takes place 
f(V(t) 
| pa[y(t)]) = n 
Mvc) 
(3.2) 
cect 
f(A,B,C,D) 
= 
f{D\B)!(BX\A)f(A) 
where 
f(D\B) 
= 
MB,D) 

CHAPTER 
3. 
GRAPMCAL 
LOG-LINEAR 
MODELS 
SI 
Figure S. 7: Chain graph corresponding to graphical chain model for 
collision-
rollover data, with dependence chain {B,D} 
U {A} U 
{C} 
an< 
f(B1C\A) 
= 
th(BiC)M^C). 
The variables cross-classifyirig the collision-rollover data in Table 3.3 can 
be divided into three blocks: first the car type B and the accident type D, 
then A driver-ejected and the third block is the injury type C. 
The chain 
graph for this graphical chain model is described in Figure 3.7. 
Although the research hypothèses are obvious from the chain partition-
ing, the conditional independencies should be read on the associated moral 
graph in Figure 3.8. 
The moral graph is complète so there seern to be no 
conditional independencies. Apparently this contradicts the conditional inde-
pendence between car type B and driver ejected A revealed by the conditional 
independence graph in Figure 3-5. However, the sampling schemes are différ­
ent. For simple graphical models ail variables are treated as response variables 
in a joint framework, so multinomial sampling is used, whereas for graphical 
chain models some prior assumptions require the factorisation of the joint dis-

CHARTER 
3. 
GRAPHIC 
AI, LOG-LINEAR 
MODELS 
82 
V.(3) 
Figure S.8: Moral graph for the chain graph corresponding to graphical chain 
raodel for collision-rollover 
data, with dependence chain {B,D} 
U {A} U 
{C}.The 
dependence chain is superimposed for comparison and 
clarification. 
tribution into conditional distributions according to the block division. The 
same data was used to exemplify all situations but the modelling problems to 
be solved are différent. Moreover, during the modelling process which is car-
ried out sequentially, it can be noticed that, when just the first two blocks are 
considered, the arrow from B to A is missing which means that B IL A | D. 
There is nothing wrong with this. If the question is whether B IL A | D in the 
final chain graph with all three blocks, then the moral graph of the smallest 
ancestral subset covering {B, D , A} needs to be considered. The moral graph 
^An(BuDuA) = 
GBUDUA 
a
n
G ^ * s described in Figure 3.9. The conditional inde-
pendence between B and A given only D is obvious now. The lesson to learn 
is that the füll moral graph can hicle some independence 
relationships. 
The graphical model illustrated in Figure 3.5 is différent from the graph­
ical chain model with the chain graph in Figure 3.7 in terms of assumptions, 
fitting process and conclusions implied. The graphical model is based on the 
assumption that all four variables A.B,C,D 
are response; the fitting process 

CHAPTER 
3. 
GRAPH (CAL LOG-LINEAR 
MODELS 
83 
B 
A 
D 
Figure 3.9: Moral subgrapk of {A, B. D] 
is based on multinomial sampling and the model fitted uses the factorisation 
f(A, 
5 , C, D) = f(A, 
C , D)f(B, 
C, D). 
(3.3) 
The graphical model is the family of probability multinomial distributions 
satisfying équation (3.3). 
On the contrary, the graphical chain model starts by assuming that B, D 
are pure explanatory variables, A is an intermediate response and C is a 
pure response. Because of this assumption the joint distribution modelled is 
not f{AtB,C,D) 
but f(C 
| A,B,D)f(A 
\ B,D)f(B,D), 
so the product-
multinomial distribution is employed. In this case each conditional distrib­
ution is fitted to the data separately. 
The graphical chain model selected is 
given by 
f(C\A,B,D)f(A\D)f(B,D)t 
(3.4) 
so the data contains Statistical évidence of a simplification of only the second 
factor f(A 
\ B,D). 
The graphical chain model is the family of product-

CHAPTER 
3. 
GRAPHICAL 
LOG-LINEAR 
MODELS 
84 
multinomial distributions satisfying équation (3.4). If another partition of the 
set variables is chosen, a différent graphical chain model may be selected. This 
Highlights the importance of choosing appropriate ordering of the variables in 
practice. 
A graphical chain model where car type follows after injury type 
does not make much sensé although the inference process would fit the model 
to the data and would give some (meaningless) estimâtes. 
More complicated graphical chain models will be investigated in Chap-
ter 5. The process of building the chain graph corresponding to a graphical 
chain model will be described in detail on an example in Section 5.4. In addi­
tion, graphical chain models are mentioned in the context of response variable 
models in Section 6.2.1. 
3.5 
Summary 
This chapter contained a brief revision through examples of the main con­
cepts from graph theory and probability theory that are needed to under-
stand graphical modelling. The emphasis was on graphical models and graph­
ical chain models because thèse two classes of models will be applied in the 
following chapters of this thesis. 
Graphical modelling is useful because of the need to analyse large contin-
gency tables. Graphical chain modelling is designed to be applied to situations 
were some external knowledge is available and the models then become more 
sophisticated in interprétation. 

CHAPTER 
3. 
GRAPHICAL 
LOG-LINEAR 
MODELS 
85 
Although both classes of models are represented by graphs there is a major 
distinction between them. Graphical chain models are built relative to depen­
dence chains. Great care is needed when interpreting such models because the 
dependence chain describing the partition plays a major role in extracting the 
conclusion. 

Chapter 4 
Inference and model sélection 
4.1 
Introduction 
In ttiis chapter the estimation ancl model sélection processes are reviewed. The 
first section highlights, from an applied perspective, the results on which the 
vvhole inference process for graphical log-linear models is based. More détails 
can be found in the standard accounts of Whittaker (1990) and Lauritzen 
(1996). The second section describes several model sélection procédures that 
can be applied for selectïng graphical log-linear models. The problems are 
explained with the help of the collision-rollover 4-dimensional table. For this 
particular example, it will be shown that ail log-linear models selected by 
various methods can be nested into the same graphical model. This highlights 
the idea that graphical modelling can be used to select a small number of 
models that can be interpreted in terms of conditional independencies and 
that are good initial models for further analysis. 
86 

CHAPTER 
4. 
INFERENCE 
AND MO DEL SELECTION 
87 
Estimation and testing procédures are briefly described for graphical mod-
els and graphical chain models. Although thèse two classes are conceptually 
différent, the inferential process for the latter mimics sequentially the fitting 
and testing process for the former class. The collision-rollover 4-dimensional 
table used in this thesis as an omnibus example has been analysed in classical 
textbooks (Fienberg, 1980; Christensen, 1990) in the context of log-linear mod­
els but the analysis output and the graphical chain approach presented here 
are the author's contribution. More complex tables are analysed in Chapter 5. 
4.2 
Inference 
4.2.1 
Graphical modelling 
Statistical inference can be based on the (scaled) déviance 
(McCullagh and 
Neider, 1989) which is a generalised log-likelihood ratio. Denoting the current 
model by M and the saturated model by M
s , the déviance dev(M) is twice the 
différence between the maximised log-likelihood function under the saturated 
model Ms and the maximised log-likelihood function under the model M: 
IÏ • 
dev(M) = 
2 Ç n , l o g - ^ % 
This is the same quantity as G2 given in équation (2.1) because it is easy to 
show that Yli{ni 
— NpM(i)) 
= 0 knowing that 
= jV. This statistic is 
asymptotically distributed chi-squared with degrees of freedom equal to the 

CHAPTER 
4. 
INEERENCE 
AND MODEL 
SELECTION 
88 
number of free parameters. Thus the overall déviance can be used as a measure 
of goodness-of-fit. For testing nested models M0 C M\ the déviance différence 
that Mo is true, d has an asymptotic chi-squared distribution with degrees of 
freedoin equal to the différence in the number of free parameters between M0 
and M\. The asymptotic test based on the déviance différence is more reliable 
than that based on the overall déviance so it is always better to use the former 
for model sélection. Another generally used measure of goodness-of-fit is the 
Pearson chi-squared statistic 
having the same asymptotic distribution as the déviance; again this may not 
provide a reliable test. Both this and the déviance are special cases of the 
power family of test statistics introduced by Read and Cressie (1988) 
which also covers other well known statistics such as Freeman-Tukey and Ney-
man; see Bishop et 
al. (1975). The Pearson X2 
is obtained for A = 1 and 
the déviance is obtained for A = 0 by taking the limit of Ix 
when A —> 0. It 
has been suggested (Read and Cressie, 1988) that /a is more reliable than the 
more common dev and X2, 
especially for sparse tables. 
The dérivation of the likelihood équations for the maximum likelihood 
d = dev(Mo | M\) = dev(vV/0) — dev(Afi) is appropriate: under the hypothesis 
x 2 
= E 

CHAPTER 
4. INFERENCE 
AND MO DEL 
SELECTION 
89 
estimators of the table of probabilities p, satisfying a graphical model given 
by formula M = [A^, j(-•-j[À^ c], is based on the fact that a set of minimal 
sufficient statistics is given by the set of marginal tables n a corresponding to 
the generators in the model, that is for ail cliques a = du ... ,dc. 
Then the 
maximum likelihood équations are formed by equating the minimal sufficient 
statistics to their expected values under the model M 
for ail cliques a = d\,...,dc. 
A proof of this resuit is given in Whittaker 
(1990). 
If the graphical model M is based on one single conditional independence 
relationship 
then there are exactly two cliques in the independence graph, a U c and b U c, 
and the likelihood équations are 
n a = A'p; a 
(4.1) 
Xa IL 
| Xc 
NpM(iac) 
= n{iac) 
and Nf4(ibc) 
= n{ibe). 
(4.2) 
The probabilities can then be calculated as 
p M ( ' a c ) p M f o c ) 
(4.3) 
n(iac)n(ibc) 
Nn(ic) 
(4.4) 

CHAPTER 
4. INFERENCE 
AND MO DEL 
SELECTION 
90 
Denoting by ra,7'& and r c the number of cells of the marginal tables given 
by Xa,Xf, 
and Xc, the déviance of the graphical model M : Xa AL Xf> | Xc is 
and it has an asymptotic x2 distribution with rc(ra 
— l){'f'b — 1) degrees of 
freedom. As an immédiate conséquence, the déviance for testing the exclusion 
of only one edge (u, w) in a gênerai independence graph G is 
D e c o m p o s a b l e models 
The fîrst graphical models investigated were a subclass of log-linear models 
for contingency tables that h ave closed-form maximum likelihood estimâtes 
(Darroch et al., 1980). Those models werecalled decomposable models because 
the joint density function can be factorised into the product of marginal density 
functions on cliques. 
Recalling the model with the independence graph in 
Figure 3.5, specified by [ADC\[BCD]. 
this îs a decomposable model and its 
joint density function can be calculated from 
dev(M) = 
2j2n(iabc)\og n(igbc)n{ic) 
n(iac)n(ibc) 
<Aev(Xv IL Xw | XV\{v,uf}) 
= 2 ^ n ( z v ) l o g n{iy)n(iy\{v,w}) 
n(iV\v)n(iV\w) 
p(A, B , C, D) = p(A, C, D)p{B, C, D). 
Decomposable models are characterised in terms of graph theory as those that 
have triangulated (or chordal) independence graphs (Lauritzen et al., 1984). 

Cil AFTER 
4. 
INFERENCE 
AND MODEL 
SELECTION 
91 
Being able to calculate maximum likelihood estimators in closed-form is very 
attractive but numerical methods can overcome this difficulty easily for non-
decomposable models. 
Other reasons why statisticians might restrict their 
attention to this subclass of graphical models is that exact conditional tests 
are available only for decomposable models (Lauritzen. 1996) and this is very 
important for model sélection in sparse tables (Kreiner, 1987). 
4.2.2 
Hypothesis testing 
There is specialised software called M I M which was designed for graphical 
modelling (Edwards, 1995). It includes several methods of model sélection 
and testing. The model sélection procédures are discussed in greater detail in 
Section 4.3 but for grasping a complète view of the graphical modellling from 
the beginning to the end, MIM's backward élimination procédure is briefly 
described. 
The procédure of backward élimination starts from the saturated model 
and at each step it removes the edge for which the déviance différence test 
for edge removal has the largest P-value greater than or equal to a specified 
significance level a. The edges that are significant (with P-values smaller than 
a) at one stage of the analysis are not tested again at further stages but always 
retained in the graph. In the end, when no further edge can be deleted, the 
corresponding model should fit the data well. Furthermore, the conditional 
independencies can be read directly from the graph. The backward élimination 
procédure is usually preferred to a forward inclusion procédure since it is passes 

CHAPTER 
4. 
INFERENCE 
AND MO DEL SELECTION 
92 
through a séquence of models, ail of whïch fit the data, and the models become 
simpler at each step. 
E x a c t testing 
One aim of this thesis is to apply graphical modelling to large tables. 
In 
Chapter 5 tables with 6, 9 and 10 variables are investigated. 
Even if the 
sample size is very large, contingency tables summarïsing road accident data 
can be expected to be sparse, with many very small cell frequencies. This is 
due to the nature of road accident data in combination with a large number 
of cells. For instance, when accident severity is one of the variables, the total 
number of fatal accidents will be relatively small; when they are distributed 
across the cells resulting from the cross-classification of the levels of the other 
(more than 5) variables, many cells are likely to have zéro frequencies. This is 
one important problem that should not be overlooked in modelling accident 
tables. 
The usual methodology employing asymptotic tests for the déviance are 
then not very reliable. The asymptotic P-values in the case of large sparse 
tables tend to underestimate the real P-values. 
Exact tests are required 
(Kreiner, 1987) to overcome this difficulty and M I M provides options for them. 
Consider, for instance, a 3-dimensional table of counts. For testing the hy-
pothesis H0 : Xi IL X? \ X3 exact tests are constructed by conditioning on the 
marginal totals. Dénote by *P the sample space of ail possible 3-dimensional 
tables n = [n^jt] with the same fixed margins as the table of observed counts. 

CHAPTER 
4. INFERENCE 
AND MODEL 
SELECTION 
ï h e n the P-value for the test criterion T is 
93 
Pots = 
Pr(T > Tob$ | Ho) 
(4.5) 
(4.6) 
iien:r{n)>Tobî 
where 
Pr(n \Ho) = 
U IL n^lflj^+jfc! 
(4.7) 
This approach is implemented only for decomposable models, so tfiat closed 
form estimâtes exist, and it is easily generalised to higher dimensional tables 
(Whittaker, 1990; Lauritzen, 1996). The exhaustive enumeration method, cal-
culating T(n) and Pr(n | H0) 
for each table n in 
is not always feasible. 
The alternative is to use Monte Carlo sampiing. 
Following the algorithm in. 
Patefield (19S1), K random tables are sampled from $ such that the proba-
bility of sampiing a table n is from the right distribution. For the table n r , 
dehne zr to be 1 if T ( n r ) > T0f,s and to be 0 otherwise; then estimate P0bs by 
Pobs ~ Hr=i 7f-
4.2.3 
Graphical chain modelling 
In Chapter 3 it was noted that chain graphs extended graphical modelling 
to studies where Substantive information is available, the variables V being 
divided into blocks V(l) 
U . . . U V(T), 
ordered by a. prior causal assump-
tion. Great attention should be given to the meaning of the adjective causal 

CH A PTER 
4. 
ÏNFERENCE 
AND MO DEL SELECTION 
94 
(Cox, 1993). The meaning of the concept causal requires both the sensé of 
Suppes underlying Granger-Wiener causality in econometrics and the sensé of 
Rubin (Holland, 1986), and also that there is a Substantive process underlying 
the dependence structure proposed. Subject matter knowledge and théories 
indicate the type, direction and even the strength of the associations. These 
hypothèses, describing actual properties of observational units, are called Sub­
stantive research hypothèses 
or just research hypothèses (Wermuth and Lau-
ritzen, 1990). They are différent from Statistical null hypothèses which play 
only the rôle that they should be rejected by the observed data. 
Once again graphs are used to formulate research hypothèses. The spéci­
fication considers two types of direct association: dircctionat associations 
for 
pairs of variables where one is a response variable and the other is explanatory; 
and Symmetrie associations 
where variables are treated on an equal footing. 
Changing the direction of some associations would resuit in changing the re­
search hypothèses. 
A graph can serve three purposes: to formulate research hypothèses, to 
describe conditional independencies, and to characterise a Statistical model. 
In the first case, from subject knowledge, prior to the Statistical analysis, 
the variables under study are divided into several blocks indicated by boxes 
superimposed on the graph. The boxes are in a one-to-one correspondence 
with the blocks, of number T say, and they dehne a dependence chain with 
T concurrent sets of variables. A dependence chain can be also defined as 
an ordered partitioning of the set of vertices V into chain éléments such that 

CHAPTER 
4. 
INFERENCE 
AND MODEL 
SELECTION 
95 
edges within chain elements are undirected, and edges between chain elements 
are directed in the same direction. 
In the second case the graph is a mathematical object as used in graph 
theory. Such a graph is called a chain graph if a dependence chain can be at­
tached to it. Different dependence chains can have the same chain graph which 
means that they will describe the same conditional independence structure. A 
cautious approach should be taken when interpreting chain graphs. 
The third case relates a chain graph to a statistical model called a graphical 
chain model by specifying the joint distribution as a product of distributions 
over the blocks of the dependence chain. Graphical chain models are multi­
variate response models for V(t) given V'(l) U . . . V(t — 1). The joint density 
f{x\,X2..... 
Xd) can be factorised as 
f(V(l))f( 
1/(2) | V(l))...f(V(T) 
| C ( r - 1 ) U V ( T - 2 ) . . . U V ( 1 ) ) . 
The chain graph pictures the conditional independence restrictions on the 
joint distribution. The case of just two blocks is generic because the inference 
process is based on fitting two blocks at a time. 
The first block V'(l) is 
considered a set of covariates Xi,... 
, Xv and the second block V(2) 
a set of 
response variables Y\,..., Yr. 
If all p + r variables were responses it can be 
shown (Whittaker, 1990) that the number of possible models decreases from 
+ 2(2), which is an improvement. 
To see that note that there are two types of conditional independence rela-

CHAPE 
ER 4. 
INFERENCE 
AND MODEL 
SELECTION 
96 
tionships usée! to build the chain graph; (J) possible conditional independencies 
between pairs of responses given the remaining responses and ail covariates; 
and pr possible response-covariate pairwise conditional independencies given 
the remaining responses and remaining covariates. The response-response and 
covariate-covariate edges are represented by Unes, the covariate-response edges 
by arrows and response-covariate edges are forbidden. For categorical vari­
ables, in the class of log-linear models. it was stated in Section 3.4.2 that ail 
chain Markov properties are équivalent and also équivalent with the factorisa­
tion of the joint density as given in Equation (3.1). This factorisation implies 
that the fitting process can be done by focusing on only two blocks at a time 
The conditional independence structure is then conveyed by combining ail 
T — 1 conditional independence graphs into a chain graph. The independence 
relationships can be read using the global Markov property on the associ-
ated moral graph. obtained by replacing arrows with lines and by Connecting 
vertices that have connected children in the same block, see Sections 
3.3.2 
and 3.4.2. Considering just the case of two blocks, the conditional indepen­
dence graph for a mode! with the conditional distribution of V"(2) | V ( l ) is 
the same as the conditional independence graph for the model with the joint 
distribution of V ( l ) and V(2), having the subgraph corresponding to V ( l ) 
complète. Moreover, the graph has the global Markov property with respect 
to the conditional distribution /(V'(2) | V ( l ) ) . 
The modelling process can be carried out sequentially. At each step, the 
current block of variables is considered as response variables and ail the pre-

CHAPTER 
4. 
ÏNFERENCE 
AND MODEL 
SELECTION 
97 
vious blocks are considérée explanatory. The conditional model can be fitted 
in the joint framework making sure that the subgraph of the explanatory 
variables is complète. The htting process for a single graphical chain model 
requires that only pa.(V(t)) to be complète, so not necessarily the entire set 
of explanatory variables. 
However, for model sélection purposes, when ail 
possible models are tested. it is indeed a necessary condition. 
Fitting a conditional distribution in a joint distribution is not possible in 
gênerai but, for contingency tables under multinomial sampling, it is because 
the multinomial distribution is closed under marginalisation and conditioning. 
Ànother example when this is possible is for continuons Gaussian variables, the 
normal distribution being again closed under marginalisation and condition­
ing. Thus ail the methods of estimating and inference available for graphical 
models can be used. 
In gênerai, two graphical chain models are équivalent if they have identical 
joint distribution and identical conditional independence structures. A chain 
graph détermines (Frydenberg, 1990) the conditional independence structure 
and the joint distribution of a graphical chain model. 
In the sarne time, 
substantive research hypothèses based on différent chain graphs may have 
équivalent statistical models. In this case, spécifie research hypothèses cannot 
be distinguished just by a statistical analysis of data. 

CHAPTER 
4. 
WFERENCE 
AND MODEL 
SELECTION 
98 
4.3 
Model selection 
In this section. some model selection procedures for log-linear models, that 
are used for graphical models as well, are reviewed and compared. The overall 
deviance can be used as a measure of goodness-of-fit for a given model M. 
For 
nested models M0 C M i it is preferable to have tests on the deviance differ-
ence d = dev(M 0) — dev(Mi) because it has a better x2 Approximation and 
the deviance differences are asymptotically independently distributed when 
they are components of a single sequence of nested models passing from the 
maximal to model minimal (Whittaker, 1990). Apart from knowing its as-
ymptotic distribution there are some other advantages for using the deviance 
as the main tool for statistic inference. Edwards' specialised Software M I M for 
graphical modelling includes several methods of model selection and methods 
for estimation and testing. 
For any log-linear model there is a graphical model such that the log­
linear model is nested within the graphical model. Therefore, different model 
selection procedures for log-linear models can be applied and several models 
identified. Then, from this set of final models the graphical models can be 
selected and interpreted in terms of conditional independencies. 
The methodology of model selection used below generally follows the stages: 
1. Identify some initial models; for example the saturated model is a conve-
nient starting model since it fits the data perfectly. Other initial models 
can be the main effects model (all variables mutually independent), the 

CHAPTER 
4. 
INFERENCE 
AND MODEL 
SELECTION 
99 
models proposed by Brown's method (Brown, 1976; Christensen, 1990; 
Whittaker, 1990). models proposed in connection with Aitkin's method 
(Aitkin, 1979; Christensen, 1990: Santner and Duffy, 1989). 
2. From the starting model proposed above use a stepwise model selection 
(backward, forward or combined) or other method (for example Aitkin's 
method, Whittaker :s method, Edwards and Havranek method) to deter­
mine simplified models that fit the data well according to some criteria. 
The stepwise methods do not necessarily give the best model based on 
any overall criterion of model fit and they can be very sensitive to the 
cutoff values used and to the initial model. Consequently, it is better to 
use several variations and to propose several candidate models. 
3. Compare the list of these final models using the Akaike information 
criterion. 
This criterion is used lor selecting models that maximizes 
a type of information proposed by Akaike (1973), information that is 
contained in the statistical model. For log-linear models, in practice this 
means that the model with the minimum diference between the deviance 
and twice the number of degrees of freedom is selected. 
4. For final models study the residuals, the influential cells and the inter-
pretability of the models. 
5. Can a proposed model give some simple answers to some important 
questions? 
There is no doubt that it would be useful to identify a small set of graphical 

CHAPTER 
4. 
INFERENCE 
AND MODEL 
SELECTION 
100 
models, fitting the data well and that cari be used for further research. 
4.3.1 
Aitkin's method 
This method is a backward sélection procédure. It sélects an ail j interaction 
terms model and then it searches ail models between ail j interaction terms 
model and ail j — 1 interaction model. This method was desîgned to control 
the o ver ail rate for ail tests performed using simultantous 
testing. 
Let 
dénote the model with ail possible maximal u-terms of jth 
order 
interaction and let dj be its associated degrees of freedom. Examples for a 
of-dimensional contingency table are 
M
(
1
) : logpi = un + 
£ «
(
) 
the mutual independence model, and 
M(2) 
: logpi = u9 + ^2ut 
+ 
£ 
UjWfc, 
tev 
.i.fcev 
the ail 2-factor effects model. 
The initial model for this procédure is the model 
that fits the data 
well while the model M ' - ' - 1 ' does not fit the data. The cutoff points 7j for 
X
2 ( l — 7J,C/J_I 
— dj) should be chosen such that there is a probability no 
greater than 7 € (0.25,0.5) of rejecting the main effects model when this 
model is adéquate. When complète independence is true the various tests for 

CHAPTER 
4. 
INFERENCE 
AND MODEL 
SELECTION 
101 
j-order interactions are asymptotically independent, so 
i - 7 = n (
i - T i ) -
Aitkin (1979) suggests using I — 7j = (1 — O J ) ^ and choosing an a level 
that yields a 7 E (0.25,0.5). For a 4-dimensional contingency table, choosing 
Table 
All j-factors 
models 
all j- 
factors 
Model formula 
df 
deviance 
4 
[ABCD] 
0 
0 
3 
[ABC] [ABD] [ACD] 
[BCD] 
1 
0.67 
2 
[AB] [AC] [AD] [BC] [ BD] [C D] 
5 
7.33 
1 
[A][B][C][D] 
11 
1193.10 
74 = 0.05,73 = 0.185 and 72 = 0.265, it is calculated that 7 = 0.431. 
For 
the collision-rollover data in Table 3.3, Chapter 3, there are 4 models to be 
compared, which are described in Table 4.1. Based on calculations in Table 4.2 
the model selected is model M^3\ given by the largest value j such that 
d e v ( A f ( j ' _ 1 ) ) - d e v ( M ^ ) > 
/ Y
2(1 
7 „ ^ - i 
- 
dj). 
Table 
Tests for Aitkin's model selection procedure 
j-1 vs j 
dev(Mü-V) 
- dev(M^) 
y 2 ( l - 7j,^--i 
dj) 
3 vs 4 
0.67 - 0 = 0.67 
x 2(-95, 1) = 
3.841 
2 vs 3 
7.33 - 0.67 = 6.66 
x 2(.S15, 4) = 
6.178 
1 vs 2 
1193.10 - 7.33 = 1185.77 
x
2(.735, 6) = 7.638 

CHAPTER 
4. INFERENCE 
AND MODEL 
SELECTION 
102 
This overall criterion was criticised by D.R. Cox in the discussion of Aitkin's 
paper (Aitkin. 1979). 
Christensen (1990) tried to improve the method by 
choosing 
Following Christensen's idea for a = 0.1 it results that 7 = 0.271 and the 
model M *
2 ' is selected. 
Aitkin's model sélection procédure continues by examining the models be-
tween 
and M
(
2
) . A model M vvill be rejected if 
Using the concept of coherence as introduced by Gabriel (1969), the submodels 
of a rejected model will be definitely rejected too and models which contain 
an accepted model will be accepted too. This is of great help especially for 
tables with a large number of variables. The models selected by this procedure 
are enumerated in Table 4.3. A l l these are non-graphical log-linear models. If 
Table 4.3: Models selected by Aitkin's 
procedure 
a = 72 = • - • = 7fc-
dev(M) - d e v ( M ( 3 ) ) > x 2 ( l - 
fjjj 
d3) =x 2(.815,4) = 6.178. 
Model formula 
dev(M' t I M<3Q 
df(MQ - d f ( M ^ ) 
Mi : \ABC\\ABD)\CD\ 
M2 : [ABC][ACD][BD] 
Mz : [ABC][BCD}[AD] 
M4 : 
[ABD}[AC][BC][CD] 
M
5 : \ACD}[AB}\BC}[BD} 
M6 : [BCD)[AB][AC)[AD] 
4.04 
2 
4.S6 
2 
4.86 
2 
4.51 
3 
4.90 
3 
4.99 
3 
only one model should be proposed then Akaike's information criterion can be 

CHAPTER 
4, 
INFERENCE 
AND MODEL 
SELECTION 
103 
used, fînding the model Mi for which dev(M t) — df(M,) ïs minimum. Using 
the décomposition of déviance (Whittaker, 1990) 
dev(jV/0 
= 
dev(M, | M ( 3 ) ) + d e v ( M ( 3 ) ) 
df(M ;) 
- 
df(M,- | M ( 3 ) ) + d f ( M ( 3 ) ) , 
it is easy to calculate the values of Akaike's criterion in Table 4.4. The model 
Table 
Akaike's criterion values 
Model formula 
dev(Mf) 
dev(Mj) - df(M,-) 
M
a : [ABC][ABD}[CD] 
4.04+6.66=10.70 
10.70-2=8.70 
M
2 : [ABC][ACD\[BD\ 
4.86+6.66=11.52 
11.52-2=9.52 
M
3 : [ABC}[BCD][AD] 
4.86+6.66=11.52 
11.52-2=9.52 
M , : [ABD][AC][BC][CD} 
4.51+6.66=11.17 
11.17-3=8.17 
M5 : [ACD][AB][BC][BD] 
4.90+6.66=11.56 
11.56-3=8.56 
M
6 : [i?CP][/iffpC][/tD] 
4.99+6.66=11.65 
11.65-3=8.65 
selected is MA : [A£.D][J4C'][.BC'][C£>]. 
Because ail the models should have 
ail two-way factors the simplest graphical model that contains this model 
as a nested submodel is the saturated model, which is not very informative. 
Therefore nothing can be said about the conditional independencies that might 
be true. 
However, considering the slight alternative proposed by Christensen, the 
initial model M ^ is selected. There is only one simpler model that fits the 
data well and this is 
M
7 : 
[AC][AD]\BC][BD\[CD]. 

CHAPTER 
4. 
INFERENCE 
AND MODEL 
SELECTION 
104 
This model also is not graphical because AC, AD and CD are included in the 
model but ACD 
is not. However, it can be nested within a graphical model, 
the simplest being Ms '• [ACD][BCD]. 
The conditional independence graph 
of this graphical model is illustrated in Figure 3.5. 
4.3.2 
Brown's method 
This method can be used to détermine an initial model. For each term in the 
saturated model, marginal association and partial association 
(Brown, 1976) 
are tested. 
For a 3-dimensional table and interaction between variables A 
and 
a marginal association test compares [.A][i?] with [AB] and a partial 
association test compares [v4C][i?C] with [AC][f?C][AB]. The extension to 
larger tables is obvious. The models considered are built considering 
1. either ail ternis for which either the marginal or the partial test is sig­
nifie ant 
2. or ail terms for which both the marginal and partial tests are significant. 
The first method gives the largest model and is suitable for backward élimi­
nation and the second method gives the smallest model and can be used for 
torward sélection. 
For collision-rollover data Brown's tests are described in 
Table 4.5. The stepwise backward sélection can start either from 
[AB] [AC] [AD] [BC] [BD] 
[CD] 

CHAPTER 
4. INFERENCE 
AND MODEL 
SELECTION 
Table 4-5: Marginal and partial association iests 
105 
Partial 
Marginal 
Interaction 
Association clev 
P-value 
Association clev 
P-value 
AB 
1.69 
0.19 
8.79 
0.00 
AC 
220.24 
0.00 
401.69 
0.00 
AD 
114.84 
0.00 
285.99 
0.00 
BC 
57.48 
0.00 
52.96 
0.00 
BD 
15.58 
0.00 
0.38 
0.00 
CD 
441.89 
0.00 
601.42 
0.00 
ABC 
1.10 
0.29 
0.07 
0.79 
ABD 
2.92 
0.08 
1.15 
0.28 
ACD 
2.94 
0.08 
1.71 
0.19 
BCD 
1.22 
0.27 
1.44 
0.23 
(at 0.05 significance level here), or from 
[ABD][ACD][BC] 
with calculations made at 0.1 significance level. This procedure will select 
the final models [ACD][BC][BD) 
and [AD}\AC}[BC}\BD}\CD]. 
None is a 
graphical model but both are submodels of the graphical model [/1C7D][BZ)C]. 
Applying a forward selection (a = 0.05 or a = 0.01) started from the initial 
model [AC][AD][BD][CD] 
leads to the final model [BCD][AD][AC]. 
This is 
again a non-graphical log-linear model which can be nested into the graphical 
model 
[ACD][BDC]. 

CHARTER 
4. 
INPERENCE 
AND MODEL 
SELECTION 
106 
4.3.3 
Edwards-Havranek model sélection procédure 
This is a fast model sélection method with the potential to identify a set of 
simple models all Utting the data well. In this respect it is différent from a 
stepwise model sélection which identifies ont final model. This single model 
is most of the time used for any inferences, neglecting uncertainty about the 
model itself, leading to underestimation of measures of uncertainty such as 
standard errors. ït is always good practice (Christensen, 1990) to look at sev-
eral well-fitting models and the method proposed by Edwards and Havranek 
(1985) is perfect for this task. It can search through the class of graphical mod­
els between a maximal model and a minimal model that can be specified before 
starting the search. The models are then classified as 'accepted', which means 
that they fit the data well, or 'rejected'. The cohérence principle from Gabriel 
(1969) is applied, submodels of rejected models being considered rejected and 
models containing "accepted 5' models being accepted without further testing. 
This principle improves the speed of the model sélection procédure. 
A t any 
step, based on the asymptotic x'2 distribution of the déviance, a model M is 
accepted if its corresponding P-value is higher than the significance level a. 
More détails are given in Edwards and Havranek (1985) and Edwards (1995). 
For the collision-rollover data summarised in Table 3.3, using a 0.05 sig­
nificance level and searching between the saturated model [ABCD] 
and the 
complète independence model [-4][B][C][-D], the Edwards-Havranek procédure 
identifies a unique minimal accepted model [ACD][BCD\. 
This is the same 
model as selected previously and being the only one gives greater confidence 

CHAPTER 
4. INFERENCE 
AND MODEL 
SELECTION 
107 
about the conditional independence implied by the model. 
Moreover, the 
model has a deviance equal to 5.87 with 4 degrees of freedom providing a very 
good fit. P = 0.21. This set of data is not very complex but the method can 
be very useful for a higher dimensional contingency table, as illustrated in the 
next chapter. 
It seems that all methods lead to one graphical model 
[ACD][ßCD]. 
Therefore, various relationships can be studied using this model. In Table 4.6 
the deviance residuals ± (2n^| logf/ii/m;)!) 1^ 2 are given, where m; = E(n,-) and 
sign used when ri{ < m;. Overall, the fit seems to be good, although 
Table 4-$: Deviance residttals for the model 
[ACD][BCD] 
Driver 
Car 
Accident 
Injury type 
Ejected 
type 
type 
Not Severe 
Severe 
No 
S mall 
Collision 
-.22 
.04 
Rollover 
-.75 
-.29 
Standard 
Collision 
.10 
-.01 
Rollover 
.50 
.15 
ves 
S mall 
Collision 
.88 
-.10 
Rollover 
1.55 
.35 
Standard 
Collision 
-.40 
.04 
Rollover 
-1.18 
-.19 
simpler models might be more informative. 
4.4 
Summary 
The estimation and model selection framework was highlighted in this chapter. 
A graphical log-linear model is built in parallel with its corresponding condi-

CHA PTER 4. 
LNFERENCE 
AND MODEL 
SELECTION 
108 
tional independence graph. Undirected independence graphs have a missing 
edge for any pairwise independence of two variables conditioned on the rest. 
This means setting to zéro ail two-way and higher-order interaction terms 
containing that pair. Empirically, the interaction terms, u, are estimated by 
maximizing the appropriate likelihood function. this being a well-developed 
process for log-linear models that can be done in gênerai in widely known 
software like SPSS, SAS, S-Plus and G L I M . 
Graphical chain models require the same inferential procédures as graphical 
models. However, their interprétation is made in a différent framework, where 
the variables under study are partitioned by some partial order relationship 
with possible causal reasoning. The conditional independencies in this case 
should be read on the moral graph. 
Road accident data is usually sparse and therefore asymptotic tests are 
unreliable. 
For model sélection exact conditional tests should be used and 
when an exhaustive enumeration is impossible, Monte Carlo sampling provides 
a feasible solution. 
There are many model sélection algorithms that have been proposed for 
the log-linear models and that can be used for graphical models as well. A p -
plying various mode! sélection procédures can be bénéficiai in providing a set 
of good models. F,dwards-Havranek procédure is very fast and can be used 
to select more than one model. The collision-rollover data was used here for 
exemplification but a better example with six variables is given in Chapter 5. 

Chapter 5 
Applications to road accident 
data 
5.1 
Introduction 
This chapter contains several applications for road accident 
characteristics, 
following the methodology described in earlier chapters. 
Large tables are 
investigated for two U K counties, Bedfordshire and Hampshire. Thèse two 
counties vvere chosen because they have a relatively small number of records 
with missing information; bot h have a large sarnple size Hampshire having 
almost four times more records than Bedfordshire, so some comparisons can 
be made. There are two aims in this chapter. To investigate the relationships 
between a relatively large number of characteristics and to show, on a particu-
lar case, that asymptotic inference may lead to very différent results compared 
with exact conditional inference. 
109 

CHAPTER 
5. 
APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
110 
For thèse two sets of data graphical models will be selected in an ex-
ploratory manner and graphical chain models will be proposed in relation 
with a prior ordering of the variables given by the temporal order of variables 
related to the accident. 
5.2 
Bedfordshire data 
5.2.1 
Graphical model with 6 variables 
The data under study consists of ail accidents in the STATS 19 database 
for the county of Bedfordshire in 1995. 
The data can be summarised in a 
contingency table cross-classihed by the following variables: 
• A = Accident severity (fatal, serious, slight), 
• L = Light conditions (daylight, darkness), 
• N = Number of vehicles involved in the accident (one, two, three or 
more), 
• R = Road surface conditions (dry, wet-damp, snow-ice-frost-flood), 
• T = Road Type (major roads, minor roads, where major roads are mo-
torways and A roads, and minor roads are B, C and unclassified roads), 
and 
• S = Speed Limit (< 40 mph, > 40 mph). 

CHAPTER 
5. 
APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
111 
The author believes thèse variables to be the six most important road accident 
characteristics. but the choice of variables does not afFect the principle of 
graphical modelling. There are 1,951 accident records summarised in a 6-
dimensional contingency table of order 3 x 2 x 3 x 3 x 2 x 2 . 
The variables are 
ail considered response variables. The conditional independence relationships 
between the variables can be studied in an exploratory manner, with the 
aim of finding an initial model that can be investigated further using more 
sophisticated techniques. The analysis below follows the lines of Tunaru and 
Jarrett (1998a). 
The contingency table summarising the data is sparse. For instance, there 
are 42 fatal accidents spread over 2 x 3 x 3 x 2 x 2 = 72 cells, giving an average 
cell frequency of 0.58 in this part of the table. 
Model sélection procédures 
based on the asymptotic % 2 tests are therefore unreliable (Kreiner, 1987). Ex­
act conditional tests using Monte Carlo simulation are implemented to over-
come this difficulty. This can be donc in M I M (Edwards, 1995) which is an 
easy and élégant computer platform for graphical modelling. In this case back-
ward élimination, under exact and asymptotic inferential procédures, leads to 
the model represented in Figure 5.1. That both procédures lead to the same 
model might be just a coïncidence; for other sets of data, as will be shown 
later, the différences are striking. 
The graph of Figure 5.1 can be interpreted as follows. Grouping the vari­
ables as a = 
= {^,¿7} and c = {L,R,T} 
it is easy to verify the con­
ditions relative to the global Markov property. Directly on the independence 

CE APTEK 
5. APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
112 
Figure 5.1: The final graphical model for Bedfordshire data with 6 variables; 
A is accident severity (fatal, serious, slight), N is the number of vehicles 
involved (1, 2, 3 or m,ore), S is speed limit (< 40 mph, > 40 mph), L is 
lighting conditions (day, night), T is road type (major, minor), and R is road 
surface (dry, wet-damp, snoiv-ice) 
graph it can be read that, given the number of vehicles N, and the speed limit 
S, accident severity A is independent of lig ht conditions L, road surface R: and 
road type T. This is not saying that those three variables are not important 
regarding accident severity, but conditioning on the fact that an accident has 
happened, the information provided by those three variables is important for 
accident severity only as a vvay of influencing speed limit (which is regarded 
here as a proxy for the actual speed of the vehicle) and the number of vehicles 
involved. Thus the important variables for explaining accident severity seem 
to be speed limit and the number of vehicles. 
There are many variables involved in a study of road accident data. Col-
lapsibility (summing over a subset of variables to obtain the marginal table 

CHAPTER 
5. 
APPLICATIONS 
TO ROAD 
ACCIDENT 
DATA 
113 
of the others) breaks large problems into small problems. 
Looking at the 
graph in Figure 5.1, let 6 = {L,T, 
R} and a = {AiS1N}. 
The boundary of 
6 is {S.N}. 
which is complète, so the model can be collapsed over 6, as is 
proved later in Chapter 6, Section 6.2. This means that the conditional inde-
pendencies between A, 5', N are preserved in the independence graph of any 
graphical model fitting the marginal table defined by A,S,N. 
In addition, 
since the multinomial distribution is closed under marginalisation, the proba­
bilités of this marginal table PASN can be estimated from the marginal model 
of {A. S, N}. 
In other words, attention may be restricted to the marginal table 
defined by the variables A, N and S instead of looking at the 6-dimensional 
table, without introducing problems with Simpson's paradox. 
The graphical model presented above suggests that there is a three-way 
interaction between accident severity, speed limit and the number of vehicles 
involved, and that studying the marginal three-way table defined by thèse 
variables will lead to the same result. This lower dimensional table (the ré­
duction in dimension is from 216 to 18 cells) is more robust to asymptotic 
tests and it is not sparse as it can be seen from Table 5.1. 
For this table, 
the likelihood ratio tests for the three possible conditional independencies are 
reliable. Therefore the analysis can be further continued on this particular 
subtable. 
The likelihood test for A IL S \ N is calculated as 
dev(A i L S \N) = 2 £ 
£ 
E 
'"g 
v-\ 
s=\ a=ï 
na+vn+sv 

CHAPTEK 
5. APPLICATIONS 
TO KOAD 
ACCIDENT 
DATA 
Table 5.1: 3-way marginal contingency table of road accidents 
114 
Accident 
Speed Number of Vehicles 
Severity 
Limit 
1 
2 
3 > 
1 
1 
5 
2 
1 
2 
13 
12 
9 
2 
1 
77 
72 
15 
2 
39 
58 
31 
3 
1 
307 
640 
113 
2 
162 
271 
124 
where, for clarity, v is used to index the levels of iV; this is equal to 
3 ( 
2 3 
d.ev(A J L 5 | J V ) = èJ2èè nasv log 
u—1 l. s=l o=l 
If the value of variable N is known, the quantity inside the brackets is the 
Table 5.2: Partitioned 
déviance 
tests; the P-values are with 3 
décimais 
Variable 
Déviance 
df 
P- value 
N = 1 
10.41 
2 
0.005 
N = 2 
28.51 
2 
0.000 
iV = 3 
9.36 
2 
0.009 
Sum 
48.28 
6 
0.000 
5 = 1 
24.33 
4 
0.000 
5 = 2 
2.69 
4 
0.611 
Sum 
27.07 
8 
0.000 
A = \ 
1.65 
2 
0.439 
A = 2 
15.43 
2 
0.000 
A = 3 
40.83 
2 
0.000 
Sum. 
57.90 
6 
0.000 

CHARTER 
5. 
APPLICATIONS 
TO 
ROAD 
ACCIDENT 
DATA 
115 
déviance for testing independence between the variables A and S in the sub­
table given by N = v. 
In this way the likelihood test can be calculated at 
each level of the conditioning variable N. Similar calculations and partitions 
can be made for the other two possible conditional independence hypothèses 
A _U_ N | S and S AL N | A , as sumraarised in Table 5.2. The unpartitioned 
tests are named by the gênerai vvord "Sum" and it can be remarked that the 
sums of the partial déviances equal the total déviances and the same for the 
degrees of freedom. Nevertheless, the situation is not quite the same for P-
values, the quantities that are driving the inference process. 
The tests for 
the number of vehicles TV does not reveal anything new but for speed limit 
S and accident severity A there are some noticeable exceptions. 
Although 
A AL N | {S 
= 1} is strongly rejected by a P-value of 0.0001, the other 
specified conditional independence hypothesis A AL N \ {S = 2} cannot be 
rejected at ail and this is in spite of the rejection of the gênerai hypothesis 
A AL N | S. în a similar manner S AL N \ {A = 1} cannot be rejected because 
the corresponding P-value is 0.439, although overall S AL N \ A has a P-value 
much smaller than the critical value 0.05. 
Consequently, the conditional independence structure revealed by this set 
of data is more appropriately described by the conditional independence graphs 
in Figure 5.2. 
From thèse graphs it can be easily concluded that, for urban 
areas, accident severity and the number of vehicles are associated and for rural 
areas they are not. In addition, for fatal accidents speed limit and the number 
of vehicles are conditionally independent, the opposite being true for serious 

CHAPTER 
5. 
A PPLICATIONS 
TO ROA D A CCIDENT 
DATA 
116 
Figure 5.2: Conditional independence graphs revealing a more detailed associ-
aiion 
structure 
or slight accidents. 
Edwards-Havranek model selection 
As stated in the previous chapter it is better to look at several models instead 
of basing inference on a single model. The reason for this is that uncertainty 
in the model may be overlooked and as a consequence parameters of interest 
be underestimated. The approach proposed by Edwards and Havranek (1985) 
seeks the simplest models Atting the data well. This searching procedure can 
screen models between a maximal model known to fit the data well and a 
minimal model known not to fit the data well; both models are specified in 
the initialising stage. In M I M , by default the method searches between the 
saturated model and the complete independence model so all possible graphical 

CHAPTER 
5. 
APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
117 
models are eligible for sélection. 
The procédure is very fast. För the same 
data studied above, at the 0.05 signihcance level, between the saturated model 
[ALNRST] 
and the complète independence model [A][L][Af][P][5'][:T] only 288 
models are tested out of 2 1 5 = 32768 possible graphical models which is a great 
improvement. This happens because once a model M has been accepted ail 
models containing M as a submodel will automatically be accepted without 
further testing and also, once a model M has been rejected ail its submodels 
are considered rejected too without further testing. This procédure splits the 
set of possible models in three sets: accepted models. rejected models and 
non-tested models. The algorithm is testing marginal non-tested models until 
this set is empty and the minimal accepted models are retained. 
For Bedfordshire set of data, the minimal accepted models with the cor-
responding déviance tests and P-values are given in Table 5.3. 
The model 
selected by a stepwise backward élimination procédure using exact condi­
tional tests or approximate asymptotic x'2 tests, namely 
\RL][LTSN][ASN], 
is not included in Table 5.3 because some of its submodels, like the last model 
[P][A5iV][.£SX][LSA/], are listed. If the analyst would like anyway to select a 
unique model to work with, the Akaike information criterion (Akaike, 1973) 
is helpful. 
The idea is to pénalise complex models with a large number 
of parameters and to look for parsimony as recommended by Occam's ra-
zor principle. The Akaike information criterion favours the model M with 
minimum différence between the déviance dev(M) and the degrees of free-
dom d f ( M ) . 
The calculations are made in the last column of Table 5.3. 

CHAPTER 
5. APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
118 
Table 5.3: Minimal 
acceptée 
models by Edwards-Havranek 
procédure 
Model M 
dey (M) 
dî(M) 
P- value 
dev(iW) - df ( M ) 
[ALR)[LRS][LST][LSN] 
211.22 
180 
0.055 
31.22 
[ALR][ALT][LST][LSN] 
210.34 
180 
0.060 
30.34 
[AL] [AN] [RSN] [LST] [STN] 
205.21 
ISO 
0.095 
15.21 
[ALT][LRS][LST][LSN] 
215.48 
184 
0.056 
31.48 
[ALN)[LR][LST][LSN] 
209.06 
184 
0.099 
25.06 
\AN][LSTN}[RS] 
213.97 
182 
0.052 
31.97 
[R][ALN][LSTN] 
204.75 
178 
0.083 
26.75 
[AL][RS][LSTN] 
211.10 
184 
0.083 
27.10 
[A L] [AN] [RST] [LST] [STN] 
216.64 
184 
0.050 
32.64 
[AL][LR][LSTN] 
206.01 
184 
0.127 
22.01 
[AL][AN][LRS\[LST\[STN\ 
211.21 
184 
0.082 
27.21 
[AS][LR][LST][LSN] 
209.81 
192 
0.180 
17.81 
[AS][LR][LST][STN] 
219.68 
192 
0.083 
27.68 
[R][A.LS][LST][LSN] 
214.95 
190 
0.103 
24.95 
[AS][LST][LSN][RS] 
214.90 
192 
0.123 
22.90 
[R][AST][LST][LSN] 
222.81 
190 
0.052 
32.81 
[R][AS][LSTN] 
205.50 
186 
0.156 
19.50 
[AL][RSN][LST][LSN] 
216.29 
184 
0.052 
32.29 
[R][ASN][LST][STN] 
210.55 
186 
0.105 
24.55 
[AL][LRN][LST][LSN] 
215.90 
184 
0.054 
31.90 
[ALN][RS][LST][LSN] 
214.15 
184 
0.063 
30.15 
[AS}[LST}[RS)[STN] 
224.77 
192 
0.053 
32.77 
[AS] [LST] [LSN] [RN] 
218.76 
190 
0.075 
28.76 
[R][ASN][LST][LSN] 
200.68 
186 
0.219 
14.68 
The last model \R\[ASN\[LST}[LSN] 
is chosen. This difFers from the final 
model [RL][LTSN][A.SN], 
chosen by other model sélection procédures, by 
having two missing edges RL and TN as can be seen on its independence 
graph in Figure 5.3. However the main conditional independence relationship 
A IL {RjT,L} 
| {S, N] is still valid and again the model can be collapsed 
onto A,S,N. 
Regarding the variables A, S. N there are no différences com­
parée! vvith the model given by the graph in Figure 5.1. The total independence 

CHAPTER 
5. 
APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
119 
Figure 5-3: 
Graphical model for Bedfordshire data, chosen by Akaike 
crite-
rion from the minimal accepted models by Edioards-ffavranek 
model 
sélection 
procédure 
of road surface conditions R as implied by the model in Figure 5.3 seems a 
bit strong. A possible explanation is that the stepwise backward élimination 
procédure used in M I M does not test again for removal of the edge RL if it is 
found signihcant at one step of the procédure. 
This model sélection procédure can be used when the aim is to select a sub-
set of models in order to investigate the strength of some relationships between 
the variables. One major concern is that the testing is donc asymptotically. 
flowever, decomposable models can be retested using exact conditional tests. 
5.2.2 
Graphical chain model with 6 variables 
In this section, graphical chain modelling is applied to the same six variables 
investigated in the previous section. This type of analysis has more causal 

CHAPTER 
5. 
APPLICATIONS 
TO ROAD 
ACCIDENT 
DATA 
120 
implications and it will be expanded in the next section to ten variables. 
The Bedfordshire data is considered again. 
The six variables are par-
titioned into three ordered blocks: V"(l) = {LiR7SiT},V{2) 
= {-'V'} and 
V(3) = {A}. This partitioning was the authors choice motivated by a tempo­
ral argument. Imagine a journey during which an accident happens. Accident 
severity is decided after the accident takes place, sometimes few days past be-
fore an accident can be categorised as fatal or serious. The number of vehicles 
is established right away at the place of accident and the variables in the first 
block are known previous to the accident. 
The first block contains the variables light conditions, road type, road 
surface and speed limit and they are considered purely explanatory variables. 
The independence graph for this block may or may not be of interest. However, 
it was decided to investigate the conditional independence relationships among 
the variables in this block. There are two edges missing. between R and T 
and between R and S. 
This means that, given daylight conditions L, road 
surface R is independent of road type T and speed limit S. The first step to 
build the graphical chain model is to fit the conditional model for the first two 
blocks. The subgraph defined by L , R, 5 , T is assumed complète and there 
is only one missing arrow, between R and N. The next step is to consider 
accident severity, A, the single variable of the third block, as a response and 
to keep hxed the complète subgraph defined by ail variables in the first two 
blocks. There are three arrows missing, between R and A, between L and 
A and between T and A. The chain graph is described in Figure 5.4. The 

C H AFTER 
5. APPLICATIONS 
TO ROAD 
ACCIDENT 
DATA 
121 
V'(l) 
V(2) 
V(3) 
S 
A 
Figure 5.Ą: Graphical chain model for Bedfordshire data with the dependence 
chain {R, 
L,T,S}U{N}U{A} 
sequential process of building a graphical chain model is described in greater 
detail in Section 5.4. 
Thïs model has an obvious causal interprétation. 
The speed limit, road 
type and daylight conditions ail influence directly the number of vehicles in-
volved in the accident. 
Road surface has no direct influence to the number 
of vehicles but acts only through its association with daylight conditions. F i -
nally, accident severity is influenced only by the speed limit and the num­
ber of vehicles. The conditional independence relationships can be read on 
the moral graph of the chain graph in Figure 5.4. The moral graph in this 
case is obtained by replacing the directed edges with undirected edges. So 
A AL {L,R,T} 
] {N, S] which means that accident severity is independent of 
daylight conditions, road type and road surface given the number of vehicles 
and the speed limit. This is the same conclusion as before. Using thèse condi­
tional independencies, the model is given by the following factorisation of the 

CHAPTER 
5. 
APPLICATIONS 
TO ROAD 
ACCIDENT 
DATA 
joint density 
fonction 
122 
f(a,l,n,r,s 
f(l,rts 
t)f(n 
I l,rit,s)f(a 
| 
l,rA,s,n) 
f(a,ln,r,s 
0 
/(/,r,s t)f(n 
| lA,s)f(a 
| s,n) 
0 
f(l>r)I(l,3,t) 
/(0 
/(n | l,t,s)f(a 
| s,n) 
where the last factorisation is of less interest than the first two. 
5.2.3 
Graphical chain model with 10 variables 
It is possible to consider a larger number of variables. The table will then be 
more sparse and using exact conditional methods becomes essential. For the 
same county Bedfordshire, another four variables, regarding time characteris-
tics, location characteristics and accident characteristics, are considered: 
• C = Number of casualties in the accident (1, 2, 3 or more), 
• D = Day of the week ( Sunday, Monday-to-Thursday, Friday, Saturday), 
• H = Hour of the accident (0-6, 7-9, 10-14, 15-18, 19-23), 
• P = Pedestrian crossing within 50m of the place of the accident (no, 
It seems more appropriate not to consider ail 10 variables in a symmetric 
way. 
The possible history of the accident provides a clue about how the 
variables can be partitioned into recursive blocks. 
Consider the first block 
of variables { D , H , L , P , /?,S,T}; 
the reason for choosing thèse variables is 
yes). 

CHAPTER 
5. APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
V(l) 
V(2) 
V(3) 
123 
P 
T 
L 
A 
R 
D 
C 
Figure 5.5: Graphical chain model for Bedfordshire data with 10 variables, A 
is accident severlty, C is the number of casualties, N is the number of vehicles, 
S is speed lirait, H is hour of the day, D is day of the week, P is présence 
of 
a pedestrian crossing, T is road type, L is daylight conditions and R is road 
surface 
conditions 
that their values related to a site of a road network are established well in 
advance of the occurrence of the accident. The number of vehicles is the only 
variable in the second block and the last block contains accident severity and 
the number of casualties { A , C } . The values of thèse last two variables can 
be known only after the accident happens. Backward élimination, using exact 
conditional tests leads to he chain graph of Figure 5.5. The graphical model 
for the first block of variables may be of interest or not, but directly from the 
graph it can be seen that 
P AL {DJIJ,,R} 
| {S,T} 
{S,T} 
AL {KD} 
| 
{//,£}. 

CHAPTER 
5. 
APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
124 
Modelling the number of vehicles, N, as a response variable, it can be seen 
directly on the chain graph that 
N AL {D,L,P,R} 
| 
{H,S.T} 
and for the accident severity, A and the number of casualties, C, 
{A,C} 
AL {P.,R,T} 
] 
{D,H,LjV.,S} 
C AL {L,P,R7T} 
\ 
{A,D,H,N\S}. 
These relationships can help us understand what variables influence either 
the accident severity or other related variables of interest such as the number 
of vehicles and the number of casualties in the accident. 
The number of 
vehicles is independent of daylight conditions, day of the week, road surface 
and présence of pedestrian crossing given hour of the day, speed limit and road 
type. Accident severity and the number of casualties are influenced directly 
only by day of the week, hour of the day, daylight conditions, the number 
of vehicles and speed limit. The direct association between accident severity 
and the number of casualties suggests that, when data is disaggregated by 
thèse two variables, the analysis should consider modelling multiple accident 
frequencies jointly. This idea is followed in the second part of the thesis in 
Chapters S and 9. 

CHAPTER 
5. 
APPLICATIONS 
TO 
ROAD 
ACCIDENT 
DATA 
5.3 
Bedfordshire and Hampshire data 
125 
5.3.1 
Graphical models for the Hampshire data and 
comparisons 
In this section several graphical models are investigated for the Hampshire 
data and a comparison is made with the models obtained for the Bedfordshire 
data. 
After deleting 68 observations having missing variables, the data corre-
sponding to Hampshire for 1995 contains 7242 accident records, a much greater 
nurnber than that for Bedfordshire. Starting with the same 6 variables sym-
metrically treated. the Edwards-Havranek model sélection procédure search-
ing between the saturated model [ALNRST] 
and the complète independence 
model [A][£][A ,][tf][5][T], tested just 24 models out of 2' 5 possible models. 
This procédure was used because the 6-dimensional table is not so sparse, hav­
ing a cell frequency average of 2.76 for fatal accidents. It was aimed to select 
some models for comparison purposes. Only two minimal models, consistent 
with the data, are proposed. The first one is [ASN][LST][RSTN] 
having a 
déviance equal to 182.06 with 164 degrees of freedom, which has the indepen­
dence graph in Figure 5.6. The second one is 
[ASN}[LST][LSN][RST\[RSN} 
having a déviance of 173.91 with 172 degrees of freedom. The independence 
graph for the second model is showed in Figure 5.7. As opposed to the first 
model, the second model is not decomposable because of the chordless 4-cycle 
R — T — LJ — N. 
This means that the estimâtes have to be calculated by 

CHAPTER 
5. 
APPLICATIONS 
TO ROAD 
ACCIDENT 
DATA 
126 
R 
N 
A 
T 
L 
Figure 5.6: 
Graphical model for Hampshire data with 6 variables, where A is 
accident severity (fatal, serious, slight), N is the number of vehicles involved 
(1, 2, 3 or more), S is speed limit (< 40 mph, 
> 40 mph), 
L is 
lighting 
conditions 
(day, night), T is road type (major, minor), 
and R is road surface 
(dry, wet-damp, snow-ice) 
iterative methods. 
Anyway, both models still support the main conditional 
independence relationship identihed in the case of Bedfordshire county, which 
is 
For both counties, the independence relationship (5.1) is true. 
It is worth 
pointing out that this does not necessarily imply that this will be also true for 
the pooled set of data ; combining the accidents from Bedfordshire with the 
accidents from Hampshire. It could be just another instance of Simpson's para­
dox. The most generał model under which the conditional independence 
(5.1) 
can be tested is [ANS]\RTLNS). 
For Bedfordshire and Hampshire combined, 
the déviance of this model is 178.43 with 132 degrees of freedom. giving a P-
A i l {R, T, L }\{S,N}. 
(5.1) 

CHAPTER 
5. 
APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
127 
value of 0.004. Therefore. after pooling data for Bedfordshire and Hampshire 
into one table, it is not true anymore that accident severity is independent of 
road surface conditions, road type and daylight conditions given the values of 
speed limit and the number of vehicles involvecl. 
Figure 5.7: 
A graphical non-decomposable model for Hampshire 
data with 6 
variables, whe-re A is accident severity (fatal, serions, slight), N is the number 
of vehicles involved (î, S, S or more), S is speed limit (< 40 mph, > 40 
mph), 
L is Hghting conditions (day, night), T is road type (major, minor), 
and R is 
road surface (dry, wet-damp, snow-ice) 
This may happen because the two counties have différent geographical 
conditions, différent socio-economic characteristics, différent percentages of 
roads of some type and so on. The two sets of data are observational studies 
from différent populations. 

CHAPTER 
5. 
APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
128 
5.3.2 
Graphical chain model with 10 variables 
As revealed in the previous section, an interesting question is what happens 
when more data is collected. 
It may be thought that there is no need for 
exact conditional tests and Monte Carlo methods as there are data available 
for other counties as well and by pooling the data, the contingency table will 
cross-classify a larger and larger number of cases keeping fixed the number 
of cells. 
However this is not the case. 
Considering the data from STATS 
19 for 1995, for Bedfordshire and Hampshire, cross-classified by the same 
10 variables as before, the resulting table is still sparse in spite of the large 
sample size of 9193 accidents. This is due to the nature of the data and it has 
nothing to do with the sampling method. The table is expected to have small 
frequencies in the cells corresponding to fatal accidents and large numbers in 
the cells corresponding to slight accidents, for example. Applying the same 
methodology as before the chain graphical model in Figure 5.8 is obtained. 
There are some interesting causal relationships revealed by the chain graph. 
The presence of a pedestrian crossing, P, does not affect the number of vehi­
cles, N', the accident severity, A, or the number of casualties, C. The day of 
the week. D, influences directly the number of vehicles, the accident severity 
and the number of casualties. The accident severity and the number of casu­
alties are directly connected, suggesting that a multivariate regression model 
may be more appropriate than ordinary regression models. 
Following the modelling process step by step, it can be informative to 
describe the conditional independence relationships. From the chain graph it 

CHAPTER 
5. APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
129 
V(l) 
V(2) 
V(3) 
""D 
' 
1 
1 
1 
1 
— À 
1— 
\ ss '/ 
H / 
i \/ 1 • 
H / 
i \/ 1 • 
/ \ 
i i 
/ 
\ 
1 
1 
/ 
\ i i 
/ 
\ 
1 
\
1 
A 
i \ 
1 
\ 
i 
>Sj 1 \ 
i 
'^"v. \ 
1 
I
I 
i i 
• i 
i i 
I
I 
i i 
Figure 5.8: Graphical chain model for Bedfordshire -f Hampshire 
data 
is easy to see that 
N AL {P,T} 
| 
{D,H,L,R,S} 
and secondly 
C AL {P,R} | 
{D,H,L,N,S.T} 
{A,C} 
ALP | 
I,jV,.R, S, T}. 
Thèse conditional independence relationships suggest that safety measures. 
aiming at a réduction in accident severity and the number of casualties, should 
not consider primarily the présence of pedestrian crossings. The variables in 
the conditioning set are those that should be targeted because they influence 

CHAPTER 
5. 
APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
130 
directly the variables of interest. accident severity and the number of casual­
ties. The above conditional independence relationships reveals that. knowing 
that the accidents have occurred. we expect that the présence of pedestrian 
crossing to be irrelevant regard!ng accident severity and the number ol casu­
alties, from the statistical information point of view. This does not mean that 
pedestrian crossings are useless. They are designed for reducing pedestrian 
casualties. 
A more detailed analysis in the next section, only for accidents 
with pedestrian casualties, reveals that the présence of pedestrian crossing is 
directly influencing the number of casualties in such accidents but not the 
accident severity. Other road characteristics and accident characteristics con-
tribute to accident severity. 
5.4 
Graphical chain modelling at a disaggre-
gated level 
5.4.1 
Accidents with pedestrian casualties 
The accidents where there is a pedestrian casualty might have différent con-
tributory factors from those with no pedestrian casualties. For this reason it 
seems advisable to analyse separately the two classes of accidents. Table 5.4 
and Tables B . l , B.2, B.3 in the Appendix B contain the results needed to 
build the graphical chain models for Bedfordshire only and for Bedfordshire 
and Hampshire pooled together, at critical levels a = 0.05 and a = 0.01. For 

CHAPTER 
5. 
APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
131 
comparison the results obtained using decomposable model sélection, unre-
stricted model sélection and exact Monte Carlo sampling model sélection will 
be given. Unrestricted models sélection means that all graphical decompos­
able and non-decomposable models are searched. Before doing so, it is hei pfui 
Table 5.4: Bedfordshire 
1995 ; a = 0.05 
Variables 
Model formula 
Method 
A //, T 
[DH][HT] 
[DH][HT\ 
[T] [DH] 
Dec. 
Unres. 
Exact. 
L,R,S\ 
D,H,T 
[RS] [DLST] 
[DHLT] 
[RS] [HR] [LS] [HL] [D HT] [DS] 
[RS][HLST][DHST] 
Dec. 
Unres. 
Exact. 
P,N 
| 
L,R,S,D,H,T 
[NRS] [DHPRT] 
[D 
HERST] 
[NS][PST][DHLRST] 
[NS][PRT][D 
HERST] 
Dec. 
Unres. 
Exact 
A,C 
| 
P,NiLiRiSiD.HiT 
[ADHNPRT] 
[ACHNPR] 
[DHLNPRST] 
[AST][CS][DHLNPRST] 
[ART] [CHNP] 
[DHLNPRST] 
Dec. 
Unres. 
Exact 
to explain the building process of a chain graph using exact testing. The re­
sults in Table 5.4 contain ail the necessary information. The choice of blocks 
of variables was based on. the same principles as before. However. the previ-
ous set of explanatory variables was further divided into a block of temporal 
variables, day of the week, hour of the day together with road type, which are 
some sort of fixed variables, and a block of environmental variables: daylight 
conditions, road surface conditions and speed limit. Speed limit is included in 
the second block because it may change from time to time. The third block 

CHAPTEK 
5. APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
132 
...Y(I). 
î 
D ; 
III 
I 
H ! 
I...T.J 
Figure 5.9: 
Initial step of building the chain graph for accident data witk 
pedestrian casualties in Bedfordshire} 
1995: D is day of the week, H is hour 
of the week and T is road type 
includes présence of pedestrian crossing and the number of vehicles as fac-
tors that influence directly the number of casualties in the accident. Accident 
severity and the number of casualites are known only after the accident takes 
place. 
First the initial set of variables {D, 
T] is investigated and conditional 
independencies between thèse three variables, in the marginal table defined 
by them, are revealed in the graph of Figure 5.9. 
This step is not really 
necessary and can be skipped. The sequential process is modelling just two 
sets of variables at a time, one explanatory and one response. 
The next set of variables to be considered is {L, 
S}. The edges between 
{D.H.T} 
are not relevant and they can be left out of the graph. The two 
blocks are delimited in Figure 5.10 by dash boxes. As described in Chapter 3, 
there are arrows pointing towards the variables 'm the new block and undi-
rected lines between the variables inside this block. From Table 5.4 it can be 
seen that there is only one line between R and S and 5 arrows, 3 pointing 

CHA PTER 
5. 
APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
133 
m 
. . i m 
D ; 
; 
R ; 
H 
T i i L 
Figure 5.10: 
First step of building the chain grapk for accident data with 
pedestrian casualties in Bedfordshire, 
1995; R is road surface, S is the speed 
limit and L is lighting 
conditions 
towards S (out of 3 possible) and 2 pointing towards L (out of 3 possible). 
The second step consists in considering ail the variables in the hrst two 
blocks as one single explanatory set, so therefore a single block, and the third 
block, in order, of variables, that is {P,N}, 
takes the place of the response 
variables block. Again there are two types of edges; arrows pointing towards 
P or N and a possible line between P and N. The graph at this intermédiare 
stage is presented in Figure 5.11 and is based on the inferential results from 
The last step, the third, brings the last set of variables {A, C] 
as the 
response block and all the previously investigated variables are playing the 
role of explanatory variables as in Figure 5.12. 
From Table 5.4, there is no 
line between A and C and there are 5 arrows between R, T and A , and between 
H7N,P 
and C. 
The intermediary graphs look quite simple, revealing simple association 
structures. Now the chain graph, with the associated dependence chain, can be 
Table 5.4. 

CHAPTEK 
5. APPLICATIONS 
TO ROAD 
ACCIDENT 
DATA 
134 
y [ l ) U V ( 2 ) 
_V(3). 
D 
R 
P 
/ 
Ż 
T 
L 
• 
N 
Figure 5.11: Second step of building the chain graph for accident data with 
pedestrian casualties in Bedfordshire. 1995; P is the présence 
of pedestrian 
crossing within 50 m and N is the number of vehicles involved 
Figure 5.12: Third step of building chain graph for accident data with pedes­
trian casualties in Bedfordshire. 1995; A is accident severity and C is the 
num.ber of casualties 

CHAPTER 
5. APPLICATIONS 
TO ROAD 
ACCIDENT 
DATA 
135 
Figure 5.13: 
Graphicaî 
chain model for Bedfordshire 
data; accidents 
with 
pedestrian casualties only 
clrawn putting ail the previous steps together. The graphicaî chaiu model has 
the chain graph in Figure 5.13. Although this graph looks a bit complicated, 
the actual sequential building process shows the opposite. 
However, great 
care should be taken when reading the conditional independencies. The moral 
graph has to be used, replacing arrows by lines and Connecting vertices that 
have common children. For example N and F should be connected by a line 
in the moral graph because both have C as their child. It can be seen from the 
chain graph in Figure 5.13 that accident severity and the number of casualties 
are not associated, that speed limit is a very important variable absorbing the 
information from a group of other variables like day of the week, hour of the 
day, road type, daylight conditions and road surface; that accident severity 
is directly infiuenced only by speed limit and road type; that the number of 
casualties is directly inüuenced only by the hour of the day, the number of 

CHAPTER 
5. 
APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
136 
vehicles involved and the présence of pedestrian crossing. 
Howcver, the conclusions are slightly différent from a similar previous 
analysis considering all accidents, with or without pedestrian casualties, pooled 
together. 
From the author's point of view, the results found here do make 
sense. The accident severity is affected by the speed Limit and the type of the 
road where accident occurred. Speed limit is also influenced by the type of the 
road, as characteristics of accidents with pedestrian casualties. which again is 
sensible, but speed limit is not enough to explain accident severity, otherwise 
there would be no arrow from road type T to accident severity A. 
It is evident from Table 5.4 that the results are quite différent for the other 
methods, decomposable or unrestricted. This means that some false inference 
can be made when asymptotic rather than exact conditional methods are 
used. 
Since large accident tables are very offen sparse it is better to base 
the inference on exact conditional testing. A drawback of this method is that 
the selected models are always decomposable so simpler non-decomposable 
graphicaî models are not even tested with this approach. 
In the author's 
opinion it is better to have a reliable rnodel rather than a simple unreliable 
one. 
5.4.2 
Accidents without pedestrian casualties 
This section contains the complementary analysis for accidents without pedes­
trian casualties. For this type of accidents, the présence of pedestrian crossing 
was considered to have no importance and it was removed. Although the de-

CHAPTER 
5. APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
137 
pendence chain is very similar. it will not be surprising if the selected graphicaî 
chain models will be différent from those discussed earlier for accidents with 
pedestrian casualties. One major change revealed here is that accident severity 
and the number of casualties are directly associated. 
Table 5.5: Bedfordskire 
1995; a = 0.01 
Variables 
Model formula 
Method 
D, H, T 
\HT\[DH} 
[HT][DH] 
[HT][DH] 
Dec. 
Unres. 
Exact. 
L,R,S 
\D,H,T 
[LST}[HLT\[HLR][DHT] 
[LST][HLT][HLR][DHT] 
[LST] [H LT] [HR] [D H T] 
Dec. 
Unres. 
Exact. 
N | 
L,R,S\D}H/T 
[DHNRST] 
[DHLRST] 
[HNST][DHLRST] 
[HNST][DHLRST] 
Dec. 
Unres. 
Exact 
A,C 
| 
N,L,R,S,D,H,T 
[ACDHLNRST] 
[AS}[CNS]\DHLNRST] 
[ACNS] [A D UNS] 
[DHLNRST] 
Dec. 
Unres. 
Exact 
The Tables 5.5, and B.4, B.5 in the appendix B are for accidents without 
pedestrian casualties. 
It can be easily seen that exact inferential methods 
provide différent results than asymptotic inferential methods. 
In addition, 
there are différences between the graphicaî chain models for accidents with 
pedestrian casualties and the graphicaî chain models for accidents without 
pedestrian casualties. 
However this is not a surprise. The analysis at the 
more disaggregated level is more fragile because of the sparse character of 
the contingency tables. 
When there is a particular interest in one type of 

CHAPTER 
5. 
APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
133 
the accidents, like accidents with pedestrian casualties, this difficulty can be 
overcome by collecting more data over a l arger period of.time or over a larger 
spatial area. 
5.5 
Summary 
Graphicaî chain models provide a useful exploratory technique for disentan-
gling the potential factors which influence variables such as accident severity 
or the number of casualties. 
However, some care needs to be taken in the 
choice of Statistical test used to select a well Utting model. Using the same 10 
variables, the graphicaî chain models for Bedfordshire, and for Bedfordshire 
and Hampshire together, are différent. 
This is not surprising since the sec­
ond model was based on more data. It was pointed out that for Bedfordshire 
data alone, when just six variables are used, the graphicaî chain models ob-
tained using différent methods of testlng and model sélection are the same. 
For the 10-variables table, différent final models are obtained if asymptotic 
(chi-squared) methods of testing are used instead of the exact Monte-Carlo 
method used here. As the contingency tables becomes larger and more sparse. 
the classical tests are not reliable and the use of exact tests and Monte Carlo 
simulation procédures become essential. 
Graphicaî modelling and graphicaî chain modelling provide a sound alter­
native for investigating a large number of road accident characteristics at an 
aggregated level and at a more specific level of aggregation. In addition, there 

CHAPTER 
5. 
APPLICATIONS 
TO ROAD ACCIDENT 
DATA 
139 
is strong empirical évidence that, for large sparse tables, asymptotic methods 
and exact conditional methods give very différent results. the second type of 
inference being more reliable. 

Chapter 6 
Collapsibility in contingency 
tables 
6.1 
Introduction 
This chapter aims to show how data analysis can be reduced in dimensional-
ity, în a reliable manner, and questions of particular interest can be answered 
using other statistical tools following the results of graphical modelling. Col­
lapsibility was briefly used in Chapter 5 for continuing the analysis in a mar­
ginal table of interest. There are différent concepts of collapsibility 
defined 
in the literature (Bishop et al., 1975; Whittemore, 1978; Asmussen and E d ­
wards, 1983; Davis, 1986), and although there are some équivalence results 
(Davis, 1986), the collapsibility concept used hère concerns the présence or 
not of interactions terms in the log-linear expansion. This can be called rnodel 
collapsibility 
but being the only collapsibility type investigated in this thesis 
140 

CHAPTER 
6. 
COLLAPSIBILITY 
IN CONTINGENCY 
TABLES 
141 
it will be simply called collapsibility. 
For Statistical model ling. the more parameters a log-linear rnodel has the 
better is the fit to the data. 
The saturated model has one parameter for 
each data value, so it will fit the data perfectly. 
However. the saturated 
model cannot be used for prédiction because for another sample from the same 
population the results will be différent. The statistician is confronted with a 
dillema. One tendency is to put more parameters into the model to explain 
the complexity of the data. 
The other is to have less parameters because 
they are more efficiently estimated, Altham (1984), and the model is more 
easily interpreted. The solution is collapsibility, which breaks large problems 
down into small problems. It is very useful to know when lower dimensional 
marginal tables can be analysed instead of very large high-dimensional tables. 
6.1.1 
Simpson's Paradox 
This phenomenon has been described in many classical textbooks like Bishop 
et al. (1975), Edwards (1995), Whittaker (1990), which show that collapsing 
tables can lead to misleading conclusions. 
This phenomenon is not just of 
académie interest. 
A set of examples from the real worlcl is presented by 
Wagner (1982). 
A n example of Simpson's paradox in the context of road 
accident data was discussed in Section 3.2. 
Simpson's paradox is the result of collapsing a contingency table 
that 
should not be collapsed. Possibly the confusion starts with the analogy be-
tween log-hnear models and A N O V A models. 
For a three-factor A N O V A 

CHAPTER 
6. COLLAPSIBILITY 
IN CONTINGENCY 
TABLES 
142 
model, when there is no three-way factor interaction, ail of the two-factor 
interactions can be examined from the corresponding two-factor marginal ta­
ble. On the contrary. for tables of counts, for a log-linear model that has no 
three-way interaction but ail two-factor interactions, it is not correct to draw 
conclusions about two-factor interactions from the two-factor marginal tables. 
Simpson's paradox appears when the complex analysis of large tables is 
unwisely replaced by a séries of investigations of marginal s mail dimensional 
tables. Some studies that can be criticised on this ground are Henson (1992) 
and Taylor and Barker (1994-1995). In analysing large tables there is one 
last obstacle that needs to be overcome. The tables may be sparse and the 
asymptotic tests are unreliable. As it was shown in Chapters 4 and 5 exact 
conditional tests with Monte Carlo sampling can be extremely helpful in such 
situations. 
6.2 
Collapsibility 
Asmussen and Edwards (19S3) introduced a définition of collapsibility based 
on the relationship between maximum likelihood estimators computed on the 
joint and marginal tables of counts n. 
Definition 6.1 The hierarchical log-linear model L is collapsible onto the sub-
set of variables a if one of the following équivalent 
conditions hold: 
1. for ail p(i) € L, it is truc that p(ia) € La 
2. for ail ia, p(ia) = 
pa{ia). 

CHAPTER 
6. COLLAPSIBILITY 
IN CONTINGENCY 
TABLES 
143 
The hat dénotes the maximum likelihood estimator and pa is the vector of 
probabilities under model La. The next theorem and its corollary, proved by 
Asmussen and Edwards (19S3). are possibly the most important properties of 
collapsibility for contingency tables: 
Theorem 6.1 (Asmussen and Edwards) A hierarchical 
log-linear model 
L is collapsible onto the subset of variables a if and only if the boundary of 
every connected component of ac is contained in a generator of L. 
Corollary 6.1 If L is a graphical model, the condition in Theorem 6.1 means 
that the boundary of every connected component of ac is complète 
and L is 
said graphically collapsible onto a. 
The collapsibility as presented above is based on the idea that. for log-linear 
models, the présence or not of the interaction terms is important, and not the 
exact values of the log-linear parameters. 
The graphical model, proposed for Bedfordshire data following Edwards-
Havranek model sélection procédure and having the independence graph in 
Figure 6.1, is not collapsible onto a = {T, TV, A} because the connected com-
ponents of a c = {R.L,S} 
are {R} and {5, L] and their boundaries are 
bd{R) 
= {0} 
bâ{L,S] 
= 
[T.N.A] 
and although the empty boundary means that it is possible to collapse, the 
second boundary is properly incomplète and this means that the graphical 
model is not collapsible onto {T, N, A}. More generally, if the variables under 

CHAPTER 
6. 
COLLAPSIBILITY 
IN CONTINGENCY 
TABLES 
144 
Figure 6.1: Graphical model for Bedfordshire data: A is accident severity, S is 
speed limit, N is the number of vehicles invoived, T is road type, L is lighting 
conditions, 
R is road surface 
study Xv are partitioned into (Xa,X(,), 
knowing the independence graph of 
Xy-, what can be said about the independence graph of À' a? 
This question 
has an answer in the concept of graphical collapsibüity 
as defined in Corol-
lary 6.1. The important resuit, (Whittaker, 1990), is that, if Xy = (À"a, Xb) is 
graphically collapsible onto Ä'„, then the conditional independencies between 
the variables of Xa, 
in the independence graph of (Xa,Xb)-, 
are preserved in 
the independence graph of Xa. 
Again using the graphical model illustrated in 
Figure 6.1, for the partition a = {A.S,N} 
and b = {./?, L,T}, 
it can be seen 
that b d ( £ , T ) = {S-,N} 
which is complète, and so the model is collapsible 
onto a and the three-way interaction between accident severity, speed limit 
and the number of vehicles is preserved in the model for the 3-dimensional 
marginal contingency table defined by these three variables. This means that 

CHAPTER 
6. COLLAPSIBÏLÎTY 
IN CONTÏNGENCY 
TABLES 
145 
the only simpler hierarchical log-linear model that could fit this 3-way table is 
the model of no three-way interaction [A5][ÀÎV](SiV]. which is not graphical. 
Ànother question of interest concerning collapsibility is whether the pre-
dicted distribution, calculated by marginalising the fitted model of the joint 
distribution, can be recovered by modelling the marginal data. 
This is a 
CorapariaoD of urban and rursJ aieas 
tu . 
Humbcr of Vehkks 
Figure 6.2: Probabiiities that an accident on urban and rural roads in Bed-
fordshire is fatal 
question of commutativity of fitting and marginalisation, which means that 
a model fab for the joint distribution fab can be fitted first and then one can 
marginalise the fitted model to fa or marginalise first the joint distribution and 
then fit the marginal distribution fa and get the same resuit /„. Collapsibility 
in this sensé means that the fitted cell probabiiities are the same irrespective 
of the order of fitting and collapsing. A necessary and sufficient condition 
for the commutativity of the maximum likelihood estimâtes is graphical col­
lapsibility together with the closure under marginalisation of the parametric 

CHAPTER 
6. COLLAPSIBILÏTY 
IN CONTINGENCY 
TABLES 
146 
distribution. Then the estimated probabilities for Xa are the same calculated 
using the model for Xy or the model for Xa. 
The model of no three way interaction [/!A7][v45][iV5] is the only simpler 
log-linear model fitting the marginal 3-way table defined by A, N and S. It 
has a déviance equal to 7.29 with 4 degrees of freedom which gives a P-value 
of 0.12. For practitioners it might be of interest to compare the probability 
to have a fatal or serious accident on urban areas and rural areas. 
From 
Figures 6.2 and 6.3 it can be easily concluded that a fatal or serious accident 
is more likely to occur on rural roads than on urban roads. 
Compatisoa of urban and rural areas 
.i J 
, 
I 
lïbm 
î 
i 
i 
Number of Veine 
Figure 6.3: Probabilities 
that an accident on urban and rural roads in Bed-
fordshire is fatal or serious 
Another example where graphical collapsibility can be applied is the model 
with the independence graph in Figure 3.5, Chapter 3, Section 3.4.1, with 
b = { £ } , and a = {A,C,D}. 
The boundary of b = {B} is {C, D}\ which is 
complète, so the model can be collapsed graphically over B and the conditional 

CHAPTER 
6. COLLAPSIBILITY 
IN CONTINGENCY 
TABLES 
147 
independencies between A,C,D are preserved in the independence graph of 
Xa. 
As our model is graphically collapsible over {B}. and it is well known that 
the multinomial distribution is closed under marginalisation, the probabilities 
of interest can be estimated from the marginal model of {A, C, D}. In other 
words. the marginal table defmed by the variables A , C and D is sufficient 
for estimation and there is no need to look at the 4-dimensional table. A t 
the same time there are no problems with Simpson's paradox. 
The same 
argument is true for the subtable defined by B,C 
and D. The counts of the 
two subtables are given in Table 6.1. For each subtable the model of no three-
Table 6.1: Observée, counts for subtables BCD and ACD of 
collisïon-rollover 
data 
B 
Â 
C 
D 
1 
2 
C 
D 
1 
2 
1 
1 
376 
1989 
1 
1 
2228 
137 
2 
173 
1183 
2 
1172 
184 
2 
1 
79 
170 
2 
1 
208 
41 
2 
192 
669 
2 
516 
345 
way interaction (Bartlett's model) hts the data well and it is the only one, 
apart from the saturated model 
àev[AC}[CD][AD\ 
= l.ï\, 
df = 1, P = 0.19 
dev[BC][BD][CD] 
= 1.44, df = 1, P — 0.23. 
The estimâtes for the models [BC][BD][CD] 
and [/1C][AD][C0] are given 

CHAPTER 
6. COLLAPSIBILITY 
IN CONTINGENCY 
TABLES 
US 
Table 6.2: Estimates for subtables BCD and ACD of collision-rollover 
data 
B 
A 
c 
D 
1 
2 
C 
D 
1 
2 
1 
1 
382.35 
1982.65 
1 
1 
2234.10 
130.90 
2 
166.651 
1189.35 
2 
1165.90 
190.10 
2 
1 
72.65 
176.35 
2 
1 
201.90 
47.10 
2 
198.35 
662.65 
2 
522.097 
33S.90 
in Table 6.2. Considering that the variables are standing for rows, columns 
and layers, the model of no three-way interaction is equivalent to the model 
of equal odds ratios for rows and columns given the layer. The interpretation 
can be permuted by fixing either rows or columns. The Bartlett model can be 
examined by looking at the estimated odds ratios and see if they are approx­
imately equal. This can be done using the unrestricted estimates of the p^k 
which are p»¿jt = 
The index for the ACD table is i for C. j for D and 
k is for A. Thus, using the counts of Table 6.1, the estimated odds ratios for 
table ACD are 
PM1P122/P112P121 
= 
2.553 
(6.1) 
P211P222/P212P221 
= 
3.3919 
(6.2) 
Remember that the threshold value for the odds ratio is 1 and its distri­
bution is not symmetric. To overcome this small difficulty, log odds ratios 
are considered. The hypothesis of interest is whether the two odds ratios are 
equal. In other words whether the ratio of these odds ratios is 1 or, equiva-

CHAPTER 
6. COLLAPSIBÎLITY 
IN CONTINGENCY 
TABLES 
149 
lently whether 
A confidence interval can be easily calculated for this statistic. which bas 
the observed value 3.3919/2.553 = 1.3286. The standard déviation is 
The 2 variabLe is ° D
2^~° = 0.4071. The confidence interval for the ratio of 
odds ratios is (0.6045 , 2.9182) which includes the value 1. To conclude, for 
both types of accident, the odds of having a severe injury are almost 3 times 
larger if the driver is ejected than if the driver is not ejected and the odds 
of having a not severe injury when the driver has not been ejected are about 
3 times larger than the odds of having a not severe injury when the driver 
has been ejected. This shows that if the driver is ejected in an accident then 
this substantialty increases the probability of being severely injured. Similar 
conclusions can be deduced by regrouping the variables. 
For the table BCD the estimated odds ratios are 
P111P221/P121P211 
= 
5.2822 
(6.3) 
P112P222/P122P212 = 
6.6164 
(6.4) 
Fbllowing the idea described above and fixing variable car type, the hypothesis 
of interest is 

CHAPTER 
6. 
COLLAPSIBILITY 
IN CONTINGENCY 
TABLES 
150 
tic, which has the observed value 6.6164/5.2822 = 1.2526, can be constructed. 
The confidence interva! for the ratio of odds ratios is (0.6708 , 2.3382) which 
includes 1. Thus, for both types of car, the odds of having a severe injury in 
the case of a rolJover accident are 5 or 6 times larger than the odds of having 
a severe injury in the case of a collision accident. 
6.2.1 
Response variable models 
Very often it is known a priori that the variables under study do not play a 
Symmetrie role. Some of the variables, say a, are viewed as explanatory (ex-
ogenous. treatment-control. independent) for the rest of variables, say 6, which 
are considered response (endogenous, dépendent). Ignoring this type of infor­
mation can be misleading. Graphical chain models described in Chapters 3 
and 4 are suitable for this framework. For categorical variables the modelling 
process was done sequentially as explained in Section 5.4, using the classical 
log-linear framework. This does not mean that there are no graphical chain 
models that can be htted outside the log-linear framework. 
This section contains a discussion of collapsibility in relation to a class of 
models introduced by Goodman (1973) for modelling explanatory and response 
The Z variable is 0.2252-0 
0.7071 = 0.3185 and a confidence interval for this statis-

CHAPTER 
6, COLLAPSIBILITY 
IN CONTÏNGENCY 
TABLES 
151 
variables together. Some connections with the class of graphical chain models 
will be made and some useful results stated. 
Goodman's models factorises 
the joint density of (a, 6) into a product of the marginal density of a and the 
conditional density of b \ a such as: 
and then a log-linear mode! M is specifled for pM(ia) 
and a log-linear model 
G' for pc(ib \ ia)- The model M is htted in the marginal table of n B and G is 
fitted as a model for the whole table and since the model is conditioned on a, 
ail the interactions between the variables in a have to be included. The final 
joint model J bas the fitted values m calculated as 
Using the additivity property of the déviance (and the corresponding degrees 
of freedom of the asymptotic x2 distribution) inference for the marginal model 
and conditional model can be performed separately. However, the class of log-
linear models does not coincide with the class of response variable models, 
see Asmussen and Edwards (1983). In order to détermine the intersection of 
thèse classes some additional notation is necessary. Let C be the set of log-
linear models for the table of counts n , AAa be the set of log-linear models for 
the marginal table of counts n a , Ca the set of conditional models (having ua 
fixed in the log-linear expansion) and Ja the set of response variable models 
pJ(z) = p M(i.)p c(i t I t.) 
(6.5) 
mJ{i) = 
mM{ia){mc(i)/n{ia)}. 
(6.6) 

CHAPTER 
6. COLLAPSIBILITY 
IN CONTINGENGY 
TABLES 
152 
generated from M.a and Ca. The most important resuit regarding the response 
variable models is given in the next theorem (Asmussen and Edwards. 1983). 
What the author believes to be a more elementary proof is given in detail in 
Appendix, Section A . 
Theorem 6.2 // L € C. then L Ç Ja 
if and only if L is collapsible onto a. 
In that case M = La and C = [a] U L\>, where b = cl(a c). 
The reverse question, when a response variable model is a log-linear model, 
lias an answer in the following theorem, proved in Asmussen and Edwards 
(1983) 
Theorem 6.3 Lei J = ( M , C) € Ja 
be a response variable model. 
Then 
J E C if and only if the boundary of every connected component of ac is 
contained in a generator of M. Moreover, L = M U Cb, where 6 = cl(a c). 
To summarise the results, the log-linear models are appropriate for con-
tingency tables with response and explanatory variables if and only if they 
are collapsible onto the explanatory variables. 
For the graphical model in 
Figure 3.5, Chapter 3, Section 3.4.1, considering car type and accident type, 
{B, C], the explanatory variables and driver ejected and injury type A, D as 
response variables it is easy to see that bd{A, D} = {B. C } , which is complète 
and so the graphical model is collapsible onto the explanatory variables. This 
means that the graphical model with the independence graph in Figure 3.5 is 
appropriate. On the contrary. considering just D as a response variable, the 
same model is not appropriate because it cannot be collapsed onto the explana-

CHAPTER 
6. COLLAPSIBILÏTY 
ÏN CONTINGENCY 
TABLES 
153 
tory variables {A,B,C} 
because bd{0} = {AyB.C} 
which is not complète. 
In a similar manner, the model in Figure 5.1, Chapter 5, Section 5.2.1, with A 
accident severity as the only response variable, is appropriate because it can be 
collapsed onto the explanatory variables 7?, L , T, 
N since bd{/l} = {5,/V} 
which is complète. 
A généralisation of the class of response variable models is the class of 
graphical chain models described in Chapter 3. For thèse models, variables are 
divided into blocks V'(l) U V(2)... 
U V(T) , by a partial ordering relationship, 
given by time or any other possible causal prior Substantive knowledge. Dehne 
the sets dQ = V(i),dt 
= V(i + 1) U dt-U 
for ail ¿ 6 ( 1 , . . . . ^ - 1}. Then the 
class of graphical chain models is defined by the following factorisation of the 
joint density which describes the log-linear models Co, C L , • • •, CT-I on the 
corresponding marginal tables 
pJ = 
pc°(d0)Tflpc^di\di.l). 
i=i 
The collapsibility results for response variable models are generalised, As-
mussen and Edwards (1.983), in the next theorem. 
T h e o r e m 6.4 A log-linear model L € C is a graphical chain model if and 
only if it is collapsible onto dt, for all i Ç. {0,1,... , T — I}. 
Conuersely, a graphical chain model J = ( C 0 , C i , . . . , CT-\) is log-linear if 
and only if the boundary of each connected component of V{i + 1) under C% is 
containeâ 
in a generator of Gx-\, for ail i G {1,2,... , T — 1}. 

CHAPTER 
6. COLLAPSIBILiTY 
IN CONTINGENCY 
TABLES 
154 
Figure 6.Ą: Graphical chain model for Bedfordshire data with 6 variables 
A n example of a graphical chain model that is log-linear is the model in 
Figure 6.4. It is relatively easy to see that 
do = V(l) 
= 
{R,L.T,S} 
dl = V(2)UdQ 
= 
{N,R,L,T,S} 
d2 = V(3)Ud1 
= 
{A,N,R,L,T,S} 
and therefore 
bd(V(2) I Ci) = bd(N | Cx) 
= 
{S, T, L] Ç [STL] 
bd(V(3) I C2) = bd{A I C2) 
= 
{5,A'}C[5/V] 
A n example of a graphical chain model which is not a log-linear model is the 

CHAPTER 
6. 
COLLAPSIBIUTY 
ÍN CONTINGENCY 
TA BLES 
model with the chain graph in Figure 3.T. For that model 
155 
V(l) 
= {BiD}1 
V{2) = {A}t 
1/(3) = 
{C}. 
But 
hd(A I Ci) 
= 
{D} 
Ç 
[BD] 
b d ( C | C 2 ) 
= 
{A,B,D} 
which is not included in any generator of C\ defined by 
p(A,B,D) 
= 
p(A,D)p(D,B) 
Conversely, there are log-linear models that are not graphical chain models. 
For example, the log-linear model 
LY = 
[RL][TS][LSA][NT][LN] 
is not a graphical chain model for the dependence chain {T, R, L. S} U {N} 
U 
{A}. 
This is because it should be collapsible onto do = {T, R. L, S] and this 
by definition means that bd(JV) = {T, L} and bd(A) = {S.L} 
are complete, 
which is not true for the first boundary. This model can be made a graphical 
chain model if the interaction between L and T is allowed in the model. 

CHAPTER 
6. 
COLLAPSIBILITY 
[N CONTINGENCY 
TABLES 
156 
M i n i m a l collapsible set 
Very often there is some particular interest in a subset b of variables of a larger 
set of variables V. It is not always possible to collapse onto 6, so the problem 
is then what is the minimal subset 6^6 Ç bi Ç V. such that the log-linear 
modcl L can be collapsed onto ô x? This problem has an ans wer when the 
log-linear model is decomposable. 
The results are based on the concept of simplicial vertex and a version of 
Graham's algorithm known as Sélective 
Acyclic Hypergraph Réduction, 
pro-
posed by Tarjan and Yannakis (1984). 
A vertex is called simplicial 
if its 
boundary is complète. 
The Sélective Acyclic Hypergraph Réduction 
algo­
rithm, (SAHR), follows the steps: 
1. draw up a list of cliques of the corresponding interaction graph; 
2. remove a simplicial vertex which is not in b; 
3. delete from the list of cliques any redundant clique; 
4. repeat the last two steps until neither is applicable. 
The minimal collapsible set is given by the subset of vertices left. The main 
resuit, Madigan and Mosurski (1990), is given by the following theorem. 
T h e o r e m 6.5 
Lct L be a decomposable log-linear model having the 
interaction 
graph Ç = (V. E) and let b be a subset of variables of interest b Ç V. 
Then 
the SA HR algorithm provides the minimal set 
b C by Ç V, such that L can 
be collapsed onto b\. 

CHAPTER 
6. 
COLLAPSIBILITY 
IN CONTINGENCY 
TABLES 
157 
Let consider again the graphical model for Hampshire data with the cor-
responding conditional independence graph in Figure 6.5. This model is not 
collapsible onto {A,T} 
because bd{/ü, jV, S, L] = {A,T} 
is not complète on 
the graph. Howe ver, suppose that there is an interest in collapsing this 6-
dimensional table onto a smaller one containing A, T. 
For the S A H R algo­
rithm let 6 = {A,T} 
so bc = {R,_N,S:C}. 
It is easy to verify that R and L 
are simplicial, that is that their boundary is complète, and that N and S are 
not simplicial. The algorithm starts with the cliques 
[RNST][ASN][SLT] 
and in the first step it removes the simplicial vertex R. Thus, the next set of 
cliques is given by 
[NST][ASN}[SLT] 
and in the second step of the algorithm the vertex L is eliminated. In con­
clusion the minimal subset, containing the variables {A,T}7 
onto which the 
model in Figure 6.5 can be collapsed is { A , T , S , j V } . This can be checked by 
seeing that 
hd{{A,T,S,NY) 
= b d ( { f l , £ } ) = 
{T,S,N} 
which is a complète subset on the graph. 

CHAPTER 
6. COLLAPSIBTLTTY 
IN CONTINGENCY 
TABLES 
15S 
T 
L 
A 
Figure 6.5: Graphical model for Hampshire data 
6.3 
Summary 
The concept of collapsibility relative to log-linear models for contingency ta­
bles are extremely important, Not taking into account whether collapsibility 
équivalent conditions allow a multi-dimensional table to be collapsed and a 
marginal small-dimensional table to be analysed instead, may lead to Simp-
son's paradox. 
Reducïng safely the dimension of the analysis has important benefits, es-
pecially when the large table is sparse and asymptotic tests are unreliable. 
This was shown on a particular example in this chapter. The analysis of a six 
dimensional table was focused on a three dimensional marginal table deflned 
by accident severity, speed limit and the number of vehicles, doing also esti­
mation of some probabilities of interest. It was also shown how the analysis 
of a 4-dimensional table can be safely decomposed into two separate analyses 

CHAPTER 
6. 
COLLAPSIBILITY 
IN 
CONTINGENCY 
TABLES 
159 
of 3-dimensional tables, the analysis being continued on some odds ratios of 
interest. 
Graphical chain models are helpfulfor situations where the set of variables 
under study can be classified as response and explanatory. It was described 
in this section hovv to apply some collapsibility results and décide whether a 
log-linear model is a response variable model. 
When the model cannot be collapsed onto a desired subset of variables 
6 it is still possible to find out a minimal subset of variables />l5 containing 
the subset 6, such that the model is collapsible onto b\. This can help once 
more to reduce the complexity of the model by analysing a reduced number 
of variables. 

Chapter 7 
Problems for Compound Poisson 
distributions 
7.1 
Introduction 
The analysts using likelihood or empirical Bayes methods "estimate" 
some 
unknown parameters describing the Statistical model and then provide infer-
ence as if the data lias been generated by the model with those estimated 
parameters. 
The estimation process is.therefore crucial and bad estimation 
can lead to false inference. 
For count data, it is very common to use a Compound Poisson-gamma 
distribution for modelling since this distribution helps to overcome overdis-
persion. 
This implies that the marginal distribution of the observed data 
follows a negative binomial distribution with two unknown parameters. 
In this chapter, an insight into the process of maximum likelihood esti-
160 

CHAPTER 
7. PROBLEMS 
FOR COMPO UNO POISSON 
DISTRIB 
UTIONS161 
mation ( M L E ) for both parameters is given and a new proof of when there 
is such an estimator is given. The new approach does not give an answer to 
the question of whether this bivariate M L E estimator is unique but it does 
provide a numerical équivalent condition that can be checked on the computer 
for any set of data. 
Because the first part of this chapter suggests that the inference process 
may be sensitive to the choice of prior a numerical technique is developed 
in the second part of the chapter for investigating the change in posterior 
inference due to the change in prior distribution. A n example based on road 
accident data is also described. 
7.2 
Estimation problems for NB distribution 
Let Y = ( V ' i , . . . . Yn) be a sample of size n from a négative binomial distribu­
tion 
nb( s \P,K) = (" +r i)p- i(i- Pr 
(î-i) 
for x = 0 , 1 , 2 , . . . , and where 0 < p < 1 and K > 0. The combinatorial term 
( K +* - 1)) which is equal to (""^Ll 1), is generally used for K positive integer, but 
when K is real it is equal to ^ f ^ - 
This is equal to 1 when x is zéro. 
When the parameter K is known, the négative binomial distribution is of 
exponential type and the estimation process for p is simple and straightfor-
ward. On the contrary, when K and p are both unknown then the négative 
binomial distribution is no longer a mernber of the exponential family and 

CHAPTER 
7. PROBLEMS 
FOR, COMPO UND POISSON 
DISTRIB 
UTIONS162 
there are some unforeseen problems regarding the estimation of K. 
This distribution arise often in a Bayesian context. 
It is not therefore 
surprising that some parameters are estimated by biased but minimum vari-
ance estimators. In the exponential family of distributions there is always a 
complète sufhcient statistic so minimum variance unbiased estimators can be 
identified. However. this is not the case for the N B distribution with /c un-
known. The next theorem, proved in Willson, Folks and Young (19S6), is just 
the tip of the iceberg. 
T h e o r e m 7.1 The order statistic Y(\), Y(2)-, • • • •> Y(n) is minimal sufficient but 
not complète 
for the negative binomial family of distributions, when n > 3. 
This means that given an unbiased estimator of (p, K) the well known Rao-
Blackwell theorem for determining an unique unbiased estimator, for the same 
parameters, caimot be applied. Therefore, there may exist several unbiased 
estimators, all functions of the minimal sufficient statistic, for which we cannot 
compare their variances. This situation is due to having both parameters of 
the negative binomial distribution unknown and it gives a hint that there may 
be some problems regarding the M L E estimators for the N B distribution. 
Willson et al. (1986) found that an uniformly minimum variance unbiased 
estimator of K cannot be obtained in the usual manner. A n explanation was 
offered by Wang (1996) and it is desciibed in the following theorem: 
T h e o r e m 7.2 There is no unbiased estimator of K for NB(p, K). 
Proof : Let T(Yi,..., 
Yn) be an estimator of K for NB(p, «). This estimator is 

CHAPTER 
7. PROBLEMS 
FOR COMPOUND 
POISSON 
DISTRIBUTIONS 
163 
unbiased if and only if 
E{T(Y)\n,p) 
= K, for all K > 0 and p 6 (0,1). 
Hence, using the density function given in (7.1), if T is unbiased then 
n 
( v ' + r i ) 
Li=l 
P™(i-p)^=^T(y) 
= K 
where y = ( y 1 ? . . . ,yn) and the summation is taken over all n-uples of positive 
integers. Rearranging the terms it follows that 
r(o)...1o)ir+ £ n("
+-0 p""(i-p)2"-
wr(») = <t 
For «; = 1 and p —• 1 we get that T ( 0 , . . . , 0) = 1 and taking K ^ 1 and p —* 1 
we get that 
jT(0, . . . ,0) = 
which is obviously a contradiction.• 
This simple but powerful result is not altogether surprising from a Bayesian 
point of view. In general, for a univariate parameter #, the Bayes estimator 
T(Y) 
= E(0|V) is biased no matter what prior distribution 7r(#) is used. 
The following theorem summarises some known results and provides at the 
same time a motivation for using Bayesian estimators rather than classical 
frequentist estimators. 
T h e o r e m 7.3 Consider a statistical model with observed data y = {y\...., yn) 
and an univariate parameter 6. Then, i/T(Y) 
= E(0|V') is the Bayes estima­
tor, 

CHAPTER 
7. PROBLEMS 
FOR COMPOUND 
POISSON 
DISTRIBUTIONS 
164 
1. for any prior distribution ir(0); if vax(T(Y)) > 0 then T(Y) is biased. 
S. T(Y) is an admissible estimator of 0 relative to squared error loss 
MSEe 
= 
E((T{Y)~0)2\e) 
3. If the risk ofT(Y) 
is finit e, tkat is E(MSEQ) 
< oo, then 
E{MSEÔ{T)) 
< 
E(MSEe{U)) 
for any other estimator U(Y) and the equality is obtained if and only if 
T(Y) 
= U(Y) almost 
everywkerc. 
The fact that there is no unbiased estimator for the parameter /c of the negative 
binomial distribution N B suggests that, in this case, estimators with good 
properties are very likely to corne from a Bayesian approach. 
The negative of the corresponding log-likelihood function is, up to a con­
stant factor, 
where the last sum has a zéro term contribution when yi = 0 and this will 
be true for ail the subséquent calculations. The trivial case when the sample 
contains only zéros, that is ^ = 0 for ail i = 1,2,..., n, is not of interest in 

CHAPTEK 
7. PROBLEMS 
FOR COMPOUND 
POISSON 
DISTRIBUTIONS 
165 
this thesis and it seems bard to imagine an application where this sample is 
meaningful. Therefore, the assumption that at least one element of the sample 
is différent than zero. is natural and such a sample will be called non-trivial. 
The likelihood équations are 
E l p » 
= 
^
¿
„
-
-
=
0 
(7.2) 
dp 
1 - p ^ 
p 
= 
_
„
l
o
g
p
_
g
g
_ 
= 
0 . 
(,.3) 
From likelihood équation (7.2) the M L E of p is p = 
where m = ~ YA=I Vi-
Replacing p in (7.3) the following likelihood équation is obtained 
m 
1 
n 
V i ~ l 
1 
It can be easily seen that there are no closed form solutions of this équation. 
If S2 — ^J2i(Vi — m) 2i 
Anscombe (1950) conjectured that there is only one 
positive solution H when S2 > m and none otherwise. 
Johnson and Kotz 
(1969) proved that there is at least one positive solution K when S2 > m. Ross 
and Preece (1985) described how to fit the N B for real data in the computer 
program M L P . It is not known if the M L E of K is unique and it seems that it 
has not been proved that there is no solution when S2 < m. Aragon, Eberly 
and Eberly (1992) claimed to hâve proved the existence and uniqueness of 
the maximum likelihood estimator for the two-parameter negative binomial 
distribution but Wang (1996) showcd that there is a mistake in their proof 

CHAPTER 
7. PROBLEMS 
FOR COMPOUND 
POISSON 
DISTRIBUTIONS 
166 
and moreover, he could not correct it. 
The N B distribution is frequently used for Utting biological data and the 
related Statistical hterature lias grown considerably over the years. However 
précise estimation of K has been elusive and other methods of estimation were 
proposed and compared (Willson, Folks and Young, 1984; Willson et al., 1986) 
and simulation and graphie tools like contours and 3-dimensional plots of the 
log-likelihood function provided to show that the possibilities about M L E of 
K. are not encouraging. The log-likelihood can be very flat instead of being 
peaked and this means that the M L E of K, could be sensitive to small changes 
in sample values. A fully Bayesian approach may be more informative. 
It will be shown that there is at least a positive M L E of 
a différent proof 
being given in Willson et al. (1986), that there is no solution when S7 < m, 
and a sufhcient condition will be identihed when there is a unique solution K 
of the M L E équations. A dehnite answer is not given, but this criterion can 
be checked on computer for any set of data. 
The profile function /(«;) = /i(^,/>(«)) is 
n y,•-1 
/(K) 
= 
n[(n + m) log(/t + m) - /clog K - m log m] - 
S 
l o e ( K + •?') 
= 
n[« log(/c + m) — K log K, + m log(*; + m) — m log m] 
- E X > g (
K + ; ) . 
The next step is to transforrn the parameter K by the one-to-one transforma­
tion /?(«) = /c[log(/c + m) — log/c], where ß : (0,oo) —> (0,m). 
This is a 

CR AP TER 7. PROBLEMS 
FOR COMPOUND 
POISSON 
DISTRIBUTIONS 
167 
strictly monotone increasing concave function because 
711 
ß'(tt) 
= 
log(re + m) - log« 
> 0 
K -r m 
m2 
for any K > 0. 
Moreover l i m ^ o ß M = 0 and l i m ^ œ ß(n) 
= m. 
The 
transformation ß is one-to-one and instead of studying whether the profile 
log-likelihood function / = J[K) has a positive root, / can be studied as a 
function of ß. To prépare the grounds a few preliminary results are proved 
first. 
L e m a 7.1 For a non-trivial sample y = 
. . . , y n ) from the NB(p, K) distri­
bution, the application f and parameter ß introduced above. it is true that 
lim — = — oo. 
«\o dß 
Proof: B y the chain rule 
df 
df dK 
hm — 
= 
hm - — — 
«\o dß 
*\o dK dß 
,. 
df 
dß 
= 
l i m — / — 
«\o are are 
= lim 
n[log(« + m) - log K] - E ? = 1 
*\o 
log(/c + m) — log re — -
Denoting by r the number of non-zéro y,-, z = l , . . . , n , and separating the 

CHAPTER 
7. PROBLEMS 
FOR COMPOUND 
POISSON DISTRIBUTIONS 
168 
terms in the double sum for which j = 0, it follows that 
df 
1 : _ n[log(« + m) - log K] - l - E L i EjL-i 1 
«\o dß 
*\o 
log(/c + m) - log K - 
^ 
= 
u + l i m ^ 
l
i
m 
—7 
í 
; 
*\o log(/í + m) - log /c - 
^ 
and applying l'Hopital rule for the second term 
,. 
df 
rnopiui 
.. 
-
m
n
«
+
I
Í
^ + « ( Í C + m )
2 E L
1 E r
i
i
i ^ ) t 
hrn. — 
= 
n-\- lim 
• 
v 
' 
K\O dp 
Í S \ O 
—rn 2 
t .. 
mn« 
r(/t-(-m)2 
«(« + ™) 2 E"=i E ^ / 7^7y? 
= 
n + lim — — + hm — 
— — + hm 
' 
; 
K \ O m¿ 
*\o 
—m¿tí 
K\O 
—m2 
r ( M - m ) 2 
= 
n -1- hm - i 
«\o 
—m¿K 
- o o . ü 
Lema 7.2 7/m 
5' 2 = £ E¿(y* —
m )
2 
rtre ^
e m
e
a
n 
and the sample variance 
of a non-trivial 
negative binomial sample y = (yu, .., yn)} and f and ¡3 as 
above. then it is true that 
hm — = —(¿> 
-m). 
°o dp 
m¿ 
Proof : As before, using the chain rule followed by l'Hopital rule, we can 
calcúlate 
, 
df 
df .dß 
hm —- 
= 
hm -j- ~r 
dp 
K^°° d.K dtí 
l'Hospital 
,. 
<Pf , d2ß 
hm —— / ——-
du2 
dK¿ 

CHAPTER 
7. PROBLEMS 
FOR COMPOUND 
POISSON 
DISTRIBUTIONS 
169 
-mn 
_j_ -T-^TI 
-1 
1 
lim 
K—»CO 
Lim 
- m n ( s + m) + «(« + mf E L i E£=Q1 (~T. 
—m' 
— lim m n 
n Ui—1 
/ 
i 
\ 
t 
, 
\ 
c i 
\
r
r
S
K 
+ 
m 
( Ä + m ) - ( « + m ) X ; E 77x7^2 
¿=1 j=o l
K + 
—- lim (/c + m) 
m2 
—- lim (K + m") 
j 
n î/i-l 
i 
n ÎN-1 
1 
" 
" 
K ( K + m) 
™™ - > > -r 
T T
1 
s e i 
+ 
i=l j=0 V 
0 + j )
2 
(« + m ) [ « ( 2 j - m ) + j 2 ] 
(* + ; ) 2 
7 3 
- 
m )
2 + E 
m ï f - Y , v i - Y ,
m ' 
m 
_1 
771 
n 
\i=i 
i=i 
i=i 
¿=1 
2 ( n 5 2 4- m 2 n — m n — ?TL2TI) 
( S 2 - m ) . G 
Therefore. because ^ is a continuous function and using the above lemmas it 
is obvious that ^ = 0 has at least one positive solution when S2 > m. 
T h e o r e m 7.4 For the negative binomial distribution 
NB(p,«;), there is at 
least one MLE of K. Moreover, the MLE is unique if ^ is a strict 
monotone 
function. 
A sufficient condition to have a unique MLE is that ^ > 0. 
Proof: If there are two roots ß\ and ß2 ol the équation ^ — 0 then. because 
^ is differentiable, there must be at least one solution ß" of the équation 

CHAPTER 
7. PROBLEMS 
FOR COMPOUND 
POISSON 
DISTRIBUTIONS 
170 
= 0. where ß* is between 
and /?2. It is easy to see that 
dß2 
dß\dß) 
d?f 
dß 
d7ß 
df 
dx? 
du 
dn2 
du 
d§_ 
dK 
The condition ~m > °> which will prove that there is unique M L E of K, means 
that 
ê]_ 
dß 
cPß 
df 
du2 
du 
du2 
du 
which is équivalent to 
1 
1\ 
» ^ 
1 
n
l 
: 
+ E E 7 7 
Iog(/c + m) — log K — 
m 
> 
m 
K(/C 4- m)2 
n 
yi-l 
n(\og{K + m) - log /c) - E 
E 
i=i j=o *- + 3 
m 
1 
n 
Vi~l 
1 
m ' n + K ( K + m) I(Ä + m)log(l + — ) - m 
E
E 
/ 
, ^2 
K 
J t=i 7=0 i
K + 
—mnn i o g ( 1 + ^
) _
m ^
ä
, g _ l _
>
0 
( 7 . 5 ) 
£ î ^ 
(* + j) 
It seems that this complicated formula cannot be further simplified or 
proved. Therefore, a definitive answer is not known whether the M L E of n 

CHAPTER 
7. 
PROBLEMS 
FOR 
COMPOUND 
POISSON 
DISTRIBUTIONS 
171 
is unique. However, for a given set of data, it can be checked on a computer 
whether the left side of équation (7.5) is strictly positive. It cannot be strictly 
negative because of the results in Lemmas 1 and 2. 
The worst situation that may occur is that there are many solutions of the 
M L E équations and they are widely spread. If the likelihood of K is not peaked 
around the mode but it has a very hat top, a small change in the sample may 
resuit in large shifts in the M L E solutions and therefore the inference results 
may change dramatically. Therefore, it would be extremely useful to be able 
to investigate a large range of priors, or in other words a large range of the 
mixing distributions G for the Compound Poisson-G distributions. Another 
advantage of being able to do this is that the so called "gamma assumption", 
discussed in Chapter 2, Section 2.2.2, can be challenged and other types of 
mixing distributions can be investigated. 
A numerical procédure that is doing just that is described in the next 
section. 
7.3 
Sensitivity analysis of priors in Compound 
Poisson modelling 
In this section, a method is proposed for investigating the sensitivity of prior 
choice in Compound Poisson modelling. After a theoretical dérivation, a prac-
tical example involving a road accident data set is described. 

CHAPTER 
7. PROBLEMS 
FOR COMPOUND 
POISSON 
DISTRIBUTIONS 
172 
7.3.1 
Theoretical dérivation 
Most of the time, accident count data shows overdispersion. This is quite 
natural because of the unobserved changes in environmental conditions, social 
changes and so on that take place ail the time and that are not reflected in 
the data at the covariate level. The most used model to account for this 
pheriomenon is the Compound Poisson-gamma rnodel. 
This model can be 
described by 
Yk\\k 
~ 
Pois(A Ä), 
for ail h = l , 2 , . . . , y V 
A f c | a, 6 ~ 
gamma(a,6). 
Assuming that a and 6 are known quantities, it is relatively straightforward 
to calculate the posterior means 
E ( A t | „) = &±£. 
(7.6) 
for ail sites A = 1 , 2 , . . , , Af and where y = (iji,.... 
y,v) and A = ( A i , . . . , A,v). 
The gamma distribution, is used as a mixing distribution mainly because of 
computational simplicity. This prior distribution will be considered in the 
following as a référence prior and will be denoted by pre/. 
The distribution of 
another prior investigated for compaiïson will be denoted by pnew 
Following 
a resuit due to Kass, Tierney and Kadane (1989), if A^ ~ pnew 
then, the 

CHAPTER 
7. 
PROBLEMS 
FOR 
COMPOUND 
POISSON 
DISTRIBUTIONS 
173 
posterior expectations of 
can be approximated by the formula 
K n e t e t | y) & ^ ^ E r e / ( A f c I y) 
6(A) 
(7.7) 
where 6(A) = pnej|x) ' ^ maximizes log[Afcp(y | A)p r e^(A)] and Â maximizes the 
référence log-likelihood !og[p(y | A)p r e^(A)]. 
Taking pnew 
= logN(^, u 2), that is the log normal distribution, it can be 
easily calculated that 
6 ( A i , . . . , A,v) = 
V{a)N 
N 
•N II ( V e x p [ A , 6 - ^ ( l o g A , - 
tfty 
. 
(7.8) 
The only thing left is to calculate À and Â. Since 
l o g ï % I A)p«/(A) ex E l f e + a ~ l ) l o g Afe - A*(ô + 1)] 
Jt=i 
the optimising solutions are 
\ k = 
V k + 
a 
1 , 
for ail A = 1, 2,. . . , N 
6 + 1 
(7.9) 
under the requirement that a > 1. It can be easily remarked that, for a = 1 
and sites with 
= 0 observed accidents, the above formula is not convenient 
because it implies that A& is zéro. Therefore, either a référence gamma prior 
with the shape parameter a greater than 1 is used or estimation of posterior 
means is done separately for sites with zéro observed accidents. 

CHARTER, 
7. PROBLEMS 
FOR COMPOUND 
POISSON 
DISTRIBUTIONS174 
Similarly, because 
N 
log[A f cp(y | A) P r e /(A)] « 
^ [ ( y l - + a - l ) l o g A I - A i ( 6 + l ) ] + ( ^ + a ) l o g A f c - A j t ( 6 + l ) 
it can be easily shown that 
% 
= 
* ± j L - L , 
for a l l a i t 
r- 
y* + a 
= 
T + T 
and again a > 1 is required in order to bave convenient solutions, otherwise 
sites vvith zéro accidents must be treated separately. 
Plugging the solutions from Equations (7.S), (7.9), (7.10) and (7.11) into 
formula (7.7), for the Compound Poisson-log normal distribution the posterior 
means are approximately 
FNEW(XK 
| y) * 
e W 1 
^
l
o
s ^ 
[log 
(irf* 
2"J). 
(7.12) 
7.3.2 
Application to road accident data in Kent 
In Chapter 8 différent Compound Poisson models, fully Bayesian specified, 
are fitted to the total number of accidents between 1984 and 1991, on 156 
single-carriageway link sites in Kent. The posterior Bayes estimâtes for the 
gamma prior parameters are a -- 0.58 and b = 0.02 and for the log normal prior 
Parameters are a = 2.44 and a = 2.45. There are some weaknesses about these 
(7.10) 
(7.11) 

CHAPTER 
7. PROBLEMS 
FOR COMPOUND 
POISSON 
DISTRIBUTIONS 
175 
ErrfJrlcal me»nsvejsus posterior means 
PdsscrvtoB Ncrrrai mût) a 
o 
s? 
0 
o 
/ 
|D 
m 
poitirtof m u n 
Figure 7.1: Approximate posterior means, calculated from gamma(0.58,0.02) ; 
against the posterior means of Poisson-log normal model with p = 2.44 and 
a2 = 2.45; sites xoith zéro observed accidents are mÂssing 
two priors that should be acknowledged. From table 7.1 it can be seen that 
the variances of thèse two priors are very large. Thus, the value of the means 
does not play any rôle. The variance of the log normal prior is 8 times higher 
than the variance of the gamma distribution but in real terms both can be 
understood as infinite. Due to this non-informative or largely diffuse character 
of the priors used it follows that the data will dominate the priors so it is not 
surprising to see a very close agreement between the posterior estimâtes and 
the observations. The elicitation of prior distributions is subject of intensive 
research and it is known to be difficult. The priors used in this section play 
a rather illustrative purpose rcgarding the method proposed for studying the 
sensitivity of the priors in Compound Poisson modelling. The research done by 
Doss and Narasimhan (1994) can be also useful for investigating. for Poisson-
régression modelling, the effects on results of a large range of priors. 

CHAPTER 
7. PROBLEMS 
FOR COMPOUND 
POISSON 
D1STRIBUTI0NS 
176 
Table 7.1: Means and variances oftwo prior 
distributions 
prior distribution 
mean 
variance 
gamma(0.5S J0.02) 
29 
1450 
logN(2.44,2.45) 
38.86 
11604 
In this section the above approximation machinery is used to calculate the 
posterior means of accidents for all 156 sites, with an unknown log normal 
distribution as the new prior and gamma(0.58,0.02) as the référence distrib­
ution. Since the shape parameter of the Gamma prior is a = 0.58 < 1 sites 
with zéro accidents do not have a solution. For comparison a parallel calcula-
tion is made, doubling the value of a to 1.172. In this second situation, with 
garnma(1.17,0.02). approximate solutions are possible for ail sites. 
Errpfrieal rrcjns versus posterior nrans 
PdsscrUog Narmal met) H 
o 
0 
0 
cP 
0 
/ 
Figure 7.2: Approximate 
posterior means, calculated from gamma(l. 17, 0.02), 
against the posterior means of Poisson-log normal model with p = 2.44 
and 
a2 = 2.45; ail sites represented 
Both sets of posterior means can then be compared with the posterior 

CHAPTER 
7. PROBLEMS 
FOR COMPO UND POISSON 
DISTRIBUTIONS177 
means under a fully Bayesian Poisson-log normal model, with the estimated 
posterior parameters ft = 2.44 and a = 2.45. 
The comparison is made by 
plotting the approximated means, as calculated from Equation (7.12), against 
the posterior means given by the fully Bayesian Poisson-log normal model 
iuvestigated later in Chapter 8. The plots are in Figures 7.1 and 7.2. 
The 
fit seems to be very good, so the approximation method advocated in the 
previous section can provide reliable and easy calculations. 
This method can be used as a tool to investigate the use of différent pri-
ors, like the log-normal already investigated here, or the inverse Gaussian, or 
other more complicated distributions which are not implemented in standard 
packages and whose usefulness has not been yet confirmed. 
7.4 
Summary 
Great care should be taken in applying even the most known estimation meth-
ods relative to the two-parameter negative binomial distribution. The M L E 
équations are non-linear and analytical solutions are not tractable. W i t h this 
excuse, the majority of applied studies using negative binomial fitting for road 
accident data employés the method of moments for estimation. This circum-
vent the estimation problems for the parameter K and the Statistical inference 
is obtained relative to a single estimate. 
Another proof of some gênerai inference results for the N B distribution 
has been given in this chapter. 
A sufficient condition with the uniqueness 

CHAPTER 
7. PROBLEMS 
FOR COMPOUND 
POFSSON 
DISTRIBUTIONS 
178 
of M L E estimators for NB(p,&), 
that can be verified for each set of data, 
has been proposed. 
From the applied point of view, after fmding by some 
numerical procédures the M L e of p and 
the condition given by équation 
(7.5) 
gives a straighforward answer to the question whether there could be multiple 
solutions to the likelihood équations. 
If there is a unique solution then the 
conclusions can be based on this set of estimâtes; otherwise a more in depth 
analysis is required. 
Compound Poisson models are often proposed for modelling count data in 
gênerai and accident data in particular. The Poisson-gamma model is one of 
the well-known instances. 
The choice of the prior distribution, or the Com­
pound distribution, is a relative matter and although the choice of gamma 
distribution is motivated by the conjugacy with Poisson distribution, other 
distributions having a positive support may give a better ht to some sets of 
data. A numerical procédure for studying the sensitivity of prior choice has 
been developed and applied for a set of accident counts. 
The advantage of 
this procédure is that avoids complicated calculations and a wide range of 
distributions can be investigated easily. 

Chapter 8 
Bayesian models for accident 
counts 
8.1 
Introduction 
Statistical science was cleveloped in the 19 U l and 20th centuries by the founders 
such as Francis Galton, Karl Pearson, Sir Ronald.A. Fisher, Jerzy Neyman 
and Egon Pearson. 
Although at the beginning there was no clear distinc­
tion between the frequenlist approach and the Bayesian approach, the former 
was preferred in most of the 20th century because of the mathematical de-
velopments supporting the méthodologies defining the frequentist school of 
thought. Bayesian methods experienced a révolution in the last décade due 
to the development of Markov Chain Monte Carlo methods and are getting 
more and more enthusiasts attracted by the flexibility of this type of Statistical 
modelling. Paradoxically, the Bayesian approach is older. starting with the 
179 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
180 
original 1763 paper by the Rev. Thomas Bayes. The controversy surrounding 
the two approaches is not the subject of this thesis. 
One of the 
strongest 
arguments against the use of Bayesian statistics was the lack of closed-form 
mathematical results and what frequentist school called the lack of objectivity. 
It is not the aim of this thesis to discuss the pros and cons of the Bayesian 
methodology. We are more interested in the benefits of the Bayesian method­
ology for the applied work. Some of the problems analysed in this thesis, like 
modelling multiple count response variables, seem to have a solution only in a 
fully Bayesian framework. There is no free lunch, of course, and the choice of 
prior distributions can be seen as a lack of objectivity. However, in this thesis 
the majority of priors were largely spread, a non-informative approach being 
used for the empirical work. Mathematical solutions could be developed only 
for a limited range of probability distributions, such as the normal distribu­
tion. Multivariate problems in a Bayesian framework lead sooner or later to 
the calculation of multi-dimensional integrals of very high order. For a while, 
the inability to calculate such integrals hampered the development of these 
methods. The computational problems related to hierarchical models concern 
multi-dimensional integrals of order higher than 20, so a more sophisticated 
approach is needed. 
Helped by the advances in computer science, this major difficulty has been 
overcome using numerical methods and simulation. For applied statisticians, 
the real breakthrough was the paper by Geman and Geman (1984). 
Since 
then, a new class of methods has emerged, generally called Markov Chain 

CHARTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
181 
Monte Carlo methods ( M C M C ) , which are designed to solve specific applied 
Bayesian problems. For generał introductions to Bayesian data analysis and 
M C M C algorithms see Gelman, Carlin, Stern and Rubin (1995) or Carlin and 
Louis (1996). 
Bayesian methods have been used for Statistical analysis of road accident 
data in the last two décades. The approach was empirical^ either nonparamet-
ric, making use of Robbins' formula as described in Chapter 2 (Robbins, 1955) 
or parametric, estimating the parameters from the marginal likelihood of those 
Parameters (Morris, 1983; Maritz and Lwin, 1989; Carlin and Louis, 1996). 
However, in this part of the thesis a fully Bayesian approach is taken and the 
application of M C M C methods seems to be the only computational solution 
available. 
Generalized linear models with random effects are developed for 
road accident frequencies. The models are hierarchically specified in several 
stages, assuming that the parameters of probability distributions are random 
variables with some other probability distributions, up to the last level of 
hierarchy where ail parameters are known. These models can become quite 
complicated and the level of coniplexity is substantially increased when mul­
tiple response models are considered. The estimation process is in this case 
very difficult and computational problems are in abundance. 
M C M C meth­
ods, Gibbs sampling in particular, offer a good solution for computational 
problems and they will be applied in Chapter 9. 
A good starting point on 
modelling based on a Gibbs sampling approach can be found in Zeger and 
K a r i m (1991). Various other hierarchical Bayesian examples are described in. 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
182 
Gilks, Richardson and Spiegelhalter (1996). 
This chapter focuses on models of counts with particular emphasis on prac­
tical applications regarding accident frequencies on road networks. There are 
two problems investigated. Firstly, fully Bayesian models with univariate re­
sponse are investigated. These are models based on compound Poisson dis­
tributions and they are discussed in terms of theoretical improvements and 
interpretability. The Markov Chain Monte Carlo methodology is explained 
using a Poisson-gamma model and a Poisson-log normal model. A Poisson-
double exponential model is used as an unusual compound Poisson model and 
all three models are compared on a set of data by the Deviance Information 
Criterion (Spiegelhalter, Best and Carlin, 1998). 
Secondly, the hierarchical Bayesian modelling process is explained in the 
context of developing two classes of models for multiple response counts: 
hierarchical Poisson-regression models with random effects and multivariate 
Poisson-log normal models. Both classes are multiple response models. They 
are very complex and M C M C methods, employing Gibbs sampling and the 
Metropolis-Hastings algorithm overcome computational difficulties. The De­
viance Information Complexity criterion (DIC) is used in Chapter 9 to compare 
the fit of 11 models and to choose a small set of good fitting models. 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
183 
8.2 
Univariate Hierarchical Models of Counts 
Suppose that for N units (sites) accident counts Y*, with k — 1,2,... ,7V 
are observed over a fixed time period. The modelling process starts with the 
assumption that 
Yk 
Pois(A f c) for all ¿ = 1 , 2 , . . . , N. 
This model is not very useful because it is saturated. 
To improve it, the 
unobserved parameters A are modelled as random quantities from the same 
distribution G , 
Ák ~ O. 
The next step is to make some specific distributional assumptions about the 
prior distribution G. 
8.2.1 
Choice of the form of prior 
Historically, the choice of a suitable parametric class was often governed by 
mathematical convenience because, until software was widely available, statis­
ticians were restricted to closed analytical calculation. In a Bayesian context, 
it was helpful to consider the density g of G to be a conjugate distribution of 
the likelihood distribution. 
Therefore, when Yk ^ 
Pois(A^), the gamma distribution with probability 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR 
ACCIDENT 
COUNTS 
184 
distribution function 
g(x | a,0) = gamma(x|a î (5) = 
^ r i " - ^ ^ , 
V(a) 
with a > 0,/? > 0, was very convenient. This yields the marginal distribution 
of the observed counts as the négative binomial distribution 
with y — 0,1,2,-.. as already seen in équation (2.9) in Chapter 2. A i l that 
needs to be done is to estimate somehow the hyper-parameters a and (S. 
This procédure has become standard in modelling count frequencies in 
the social sciences. Using a négative binomial mode! seems more appropriate 
than using a simple Poisson model. The négative binomial distribution is here 
the resuit of compounding the Poisson distribution with a gamma distribution. 
Nevertheless, the parametric distribution G can be any other distribution with 
non-negative support. 
A log normal distribution, for instance, is a possible 
alternative, 
g(x) 
= logN(x|^,a 2) = 
_ L 
exp ( - ^ ( l o g x - y)2) 
, 
where \i G R, o2 
> 0. x > 0. 

CHAPTER 
8. BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
185 
But now the marginal distribution of Y cannot be calculated in closed form 
p(y|/*V) 
= 
|Pois(y|A)logN(A| M,a 2)dA 
(8.2) 
oc I A » - 1 + 5 e x p ( - A - ^ [ ( l o g A ) ' ] ) d A 
where "oc" means equality up to a normalizing factor, a convention followed 
every where in this thesis. The last integral cannot be expressed in closed form. 
It is possible to estimate the parameters of this Compound distribution either 
by moment estimators or maximum likelihood estimators (Shaban, 1988). The 
M L E estimâtes require numerical intégration techniques. Not very much is 
known about the properties of M L E estimators for the Poisson-log normal 
distribution, whether they are unique or not or under what conditions. The 
computational problems are further complicated when régression terms are 
involved and where multiple response variables are investigated. 
8,2.2 
A fully Bayesian approach 
However, Markov Chain Monte Carlo methods are designed specifically for-
situations like this. 
Under a fully Bayesian framework, some further prior 
distributions for the hyper-parameters fi and a2 have to be set up. A n initial 
approach can be based on setting non-informative priors for the parameters, 
or in other words, not very much is known a priori about thèse parameters. 
Non-informative priors are usually very flat. close in a sensé to an uniform 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
186 
distribution over a large range of values. For computational simplicity it is 
common to assume that 
P(u) 
= 
N[>|0S 0.001) 
(8.3) 
p(r) 
= 
gamma(r|0.001,0.001) 
where r = l/cr 2. 
The Poisson-Iog normal model is described by 
Yk\Xk 
~ 
Pois(Afc), for ail A: = 1 , 2 , . . . , TV 
(8.4) 
Xk\fi-,T 
~ 
LogN(^,r) 
p 
~ 
N(0,0.001) 
r 
~ 
gamma(0.001,0.001) 
The parameterisation of the normal distribution and of the log normal dis­
tribution is not in classical form, the second parameter is the inverse of the 
variance, also called précision. 
Therefore a very small précision means a very 
large variance. The actual value of the mean is not important when the vari­
ance is so large. 
Bayes theorem provides the posterior distribution calculated as 
p(A,p>T\y) ce p(y\X,p,r)p(A,r). 
(S.5) 
where A and y represent vectors. 

CHAPTER 
8. BAYES JAN MODELS 
FOR ACCIDENT 
COVNTS 
187 
(
 
m
u 
) 
,f 
tau 
) 
^*/theta[(J^
sY*' 
( Y [ k ] ^ ) 
fortklN 1 :Nî 
Figure 8.1: Direcled graphical model for a mixed Poisson-log normal model 
The conditional independencies between the quantifies involved, observed 
data and unobserved parameters are very important. They are used for simpli-
fying the mathematical calculations and to represent mathematically scientific 
assumptions made before the actual Statistical modelling exercise. The best 
way to communicate thèse relationships is via a directed graphical model. For 
example the Poisson-log normal model is based on the graphical model in Fig­
ure 8.1. This graph is similar to a directed acyclic graph. In order to be able to 
define a joint distribution over this type of graph, the graph must be acyclic. 
that is not containing directed cycles. By analogy with chain graphs described 
in Chapter 3, a directed local Markov property can be defined, stating that any 
vertex v is independent of ail vertices that are not descendants of v, given its 
parents pa[u] (Frydenberg. 1990). No positivity requirement is necessary to 
prove that this property is équivalent to assuming that the joint distribution 

CHAPTER 
8. BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
188 
of all quantities V factorizes as 
p(V) =l[p{v\ 
pa[t;]). 
vEV 
It follows that, in order to specify the joint distribution p(V)~ only the parent-
child distributions need to be provided. In W i n B U G S , there are two types 
of arrows, a normal type corresponding to stochastic relationships and hol-
low type, corresponding to deterministic fonctions, that is logical nodes. For 
reading the conditional independencies only the first type should be consid-
ered so the graphical model should be collapsed over ail logical variables before 
attempting to read any conditional independence between the stochastic vari­
ables. 
The conditional independencies are easy to read directly on the graph 
Yk AL r|Ai, for all k = 1 , 2 , . . . , N 
Yk AL n\\k. for ail A; = 1 , 2 , . . . , N. 
The équation (8.5) can then be simplihed as 
(8.6) 

CHAPTER 
8. BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
189 
This means that 
N 
jV 
p(K f-1; r\y) 
cc J J Pois(^|Ajk) [ J logN(A t|/ i ; r) 
k=l 
k=\ 
(X 
xiV(/i|0,0.001)gamma(-|0.001 ; 0.001) 
II "
V
i
- II y - e x p ( - - ( l o g A, - ft) J 
0.001 
..2 
xe 
2
^
R 
fc=jV 
^^O-OOl-^-O.OÜlT 
oc 
^ 
II 
A p - l e - X f c e - ? t l o « A * - ^ 
X e- Ł^ Łii 3
7.o.ooi-i e-o.ooiT i 
X 
The joint posterior distribution of all parameters of interest cannot be sim­
plified further. 
Markov Chain Monte Carlo methods overcomes the lack of 
closed form analytical methods by a simple and brilliant idea. Denoting by y> 
all parameters of interest, taking values in a sample space 
a Markov chain 
is simulated with the space state $ and whose equilibrium distribution is ex­
actly p{tp\y), the target distribution. So when a sample from p(<p\y) cannot 
be simulated directly it might be possible to simulate a Markov chain with 
the properties just described and after a sufficient number of iterations, having 
some confidence that it has become stationary, any sample from the stationary 
part of the Markov chain is a (dependent) sample from p(ip\y). Methods for 
simulating a Markov chain with all these properties have been identified and 
depend on the type of model investigated. The most famous method of sam­
pling is Gibbs sampling. This algorithm starts by calculating all conditional 
distributions of separate parameters, or block of parameters where appropri-

CHAPTER 
8. 
BAYESIAN 
MODELS 
EOR ACCIDENT 
COUNTS 
190 
ate, conditioning on everything eise. For the above model it follows easily 
that 
P(KP>T 
I y) 
« 
k=N 
k=i 
e - ^ - M 2
r D . 0 0 1 - l e - O . O O l T 
The conditional densities of separate parameters (possibly vectors) are calcu-
lated by retaining only those terms in the above product that are necessary. 
For example to calculate the conditional density p(Xk 
\ y, p. r) only the factors 
containing A^ are retained, everything eise being considered as a part of the 
normalizing constant, so for every site k 
p{Xk\y,p,r) 
oc 
A f - 1 + ^ e - A f e - ^ l 0 S ' ^ 2 ] 
(8.8) 
/ 
I 
\ 
\ 
0.001 
2 
» r 
2 
„ 
p{p\y,X,T) 
oc 
e 
* " 
IT 
k 
k=l 
(8.9) 
p(T\y,\,n) 
« 
rf+o.oo.-i e-r[o.ooi+iE:l 1(i"e^-^] 
(8.10) 
( 
N 
1 
cc 
gamma I r | — + 0.001-, 0.001 + - £ ( l o g A f c - 
p)' 
k=\ 
Starting from some arbitrary points {X^\ p^\r^), 
the Gibbs sampler goes 
through the following scheme 
1. Draw X[l) ~ p{Xk\y, ^ ° ) , r<°>), for all ¿ = 1 , 2 , . . . , N. 
2. Draw 
~ p(p\y, X^, T<°>) 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
191 
3. Draw 
- p{r\y, A< [), M
( 1 ))-
If (X^\p^\r^) 
| y is the Markov chain resulting from the Gibbs sampler 
described above then it can be proved under appropriate regularity conditions 
that ( A ^ , / i ^ . r^)\y 
- i (A, p, r)\y ~ p(A, p, r\y) as t —• oo. For a proof and 
a gênerai description of the conditions under vvhich this theorem is true see 
Besag (1974), Geman and Geman (1984), Roberts and Smith (1993). 
The hierarchical spécification of the Poisson-log normal model, équation (8.4), 
can be followed for the Poisson-gamma mode! in a similar manner 
Yk \ \k 
~ 
Pois(A*) 
(8.11) 
\k | ct,P 
~ 
gamma(a,/9) 
a 
~ 
logN(0,0.0001) 
P 
~ 
gamma(0.001,0.001) 
The directed graphical model describing the conditional independencies is 
given in Figure 8.2. This is a füll Bayesian model as opposed to an empirical 
Bayesian model which, instead of setting hyper-priors for the parameters a and 
ß. estimâtes them from the data. As above, in order to be able to simulate 
from the joint posterior density p(A,a,/3|y), the conditional densities are first 
calculated. From the model assumptions it follows that 
p(A,a,/? | y) 
ce 
p(y | A)p(A | a, 
ß)p{a)p(ß) 
r N 
oc 
Yl Pois(i/fc I Ajb)gamma(Afc | a,P) 
Lfc=i 
logN(a | 0,0.0001) 

CHAPTER 
8. BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
192 
f&rfkIN 1 :N) 
Figure 8.2: Directed graphicaî 
mode! for a mixed Poisson-gamma 
model 
xgamma(/? | 0.001,0.001) 
oc 
N 
n 
lk=\ n \Vkr-*k 
\<*-lr-0\k 
I Ê - ^ - ( i o g « ) 2 ^ o . o o i - i e - o . o o i ^ 
a 
The conditional densities are calculated now by retaining only the relevant 
factors from the above product. Therefore 
p(\k\y,a,{3) 
oc 
A f c ^ - V ^
1 " ^ 
oc gamma(y* -f a, £ + 1) 
(8.12) 
H
J v a 
, 
A ( ] ( ] ( ) ] 
\ 
p(a\y,\,fi) 
ce 
- ^ ( I ^
=
1 A
l . ) ° - V -
1 e x p ( - ' ^ ( l o g « )
2 J ( 8 . 1 3 ) 
[r(a)] 
p09|»,A,a) 
oc ^ w " + 0 J » , - , e x p ^ ( f ; A t + 0.001)j 
(S.14) 
oc gamma(//a +0.001. £ A * + 0.001) 
Compound Poisson models are very useful but cannot provide a good solu­
tion for situations when there are several types of counts, possibly correlated. 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
193 
In Section 8.3 these models are expanded further to allow multiple response 
counts to be analysed jointly. The computational problems will be more de-
manding but the same M C M C techniąues will be used in a similar manner to 
solve these problems. 
Let see now how the inferential process is execu.ted in practice. 
8.2.3 
Monitoring the convergence and inference 
Markov Chain Monte Carlo methods can be prone to serious errors when the 
convergence is very slow. If the simulated Markov chain has not converged to 
the stationary distribution, the inference can be false. Many papers included 
in Gilks et al. (1996) emphasize how dangerous M C M C methods can be when 
the convergence is not monitored. The simulated Markov chain shonld "forget" 
its starting point after a sufficient number of iterations and the starting point 
should not influence the inference process. 
Based on this simple idea. the following criterion for monitoring conver-
gence has been proposed (Gelman et al., 1995, Section 11.4). Several parallel 
seąuences started from different initial points are simulated. If convergence is 
attained then the empirical distribution of each seąuence is almost identical to 
the empirical distribution of the seąuence obtained by mixing all the sequences 
together. 
If convergence is not reached, the variations within each seąuence 
are smaller than the variation within the mixed seąuence. By analogy with 
the analysis of variance, for each parameter of interest, the within-seąuence 
variance W and the between-seąuence variance B are calculated, and then 

CHAPTER 
8. BAYESÏAN 
MODELS 
FOR ACCIDENT 
COUNTS 
194 
used to estimate the variance of the parameter of interest in the stationary 
distribution. 
Suppose there are m parallel sequences (simulated Markov chains) each 
with n values, and denote the parameter of interest by <f>. Denote by <f>{ the 
sample mean and by S'f the sample variance of the «th sequence. 
If 4> = 
^ Xw=i <Pi then the between-sequence variance is 
and the within-sequence variance is 
i m 
Under the assumption of stationarity of the simulated Markov chain, 
varO) = ?—^W + 
-B 
n 
n 
is an unbiased estimate of the variance of </>. If the chain has not yet converged 
then it overestimates the variance; then each sequence has less variability than 
the mixed sequence, so W underestimates the variance of <j>. When stationarity 
is reached both vâr(^) and W estimate var(^). Gelman et al. (1995) proposed 
using 
(8.15) 
known as the Gelman-Rubin statistic, as a tool to monitor convergence. When 

CHAPTER 
8. 
BAYESÏAN 
MODELS 
FOR ACCIDENT 
COUNTS 
195 
the simulated Markov chain converges to the stationary distribution then the 
R decreases to 1. In practice, a value of R less than 1.1 indicates convergence. 
The program W i n B U G S l . 2 allows an easy simulation of several paral­
lel chains simultaneously so convergence can be also checked by looking at 
the dynamic plots of the parameters monitored against iteration number. 
The Gelman-Rubin convergence statistic as improved by Brooks and Gelman 
(199S) is calculated in this program. It should be noted that no diagnostic 
tool can be considered a "proof of convergence of a M C M C algorithm be­
cause it is feasible to use only a finite sample of the chain. However, these 
monitoring tools help avoiding cases where the mixing is slow and the con­
vergence is unconfirmed. Another recommended practical point (Carlin and 
Louis, 1996; Gelman et al., 1995) is to simulate several chains starting from 
dispersed initial points. 
At this point, having a sample from the joint posterior distribution p((p\y), 
any summary inferences (means, medians, quartiles, credible intervals, modes, 
ranks, density estimation), or predictions of future observations, can be pro­
vided. 
8.2.4 
Residual examination 
The particular choice of a model or of a list of models should be checked 
by comparing the observed statistics with the expectations of these statis­
tics as given by the models. A simple way to check the fit of a model is to 
consider the residuals yk — E(Y't) or even better, the standardised residuals 

CHAPTER 
8. BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
196 
(yk — Ei(Yk))/yJvax(Yk)- Large residuals indicate observations that are unlikely 
to be provided by the probabitistic model proposed. If Yk ™ Pois(A^) it fol-
lows that E(Yk) = var(ifc) = A*. Estimating the unobserved quantity A* by 
tlie posterior mean E(A f c | y), where y dénotes all the data under study, the 
standardised residual in this case is (yk — E(A* | y))/yjE(\k 
\ y). 
Another équivalent way to look at the fit of the model is to plot the pre-
dicted values E(A^ | y) against the observed values yk- A good fit would have 
the points evenly scattered around the line with a 45 degrees slope. This idea 
will be exploited in Chapter 9 to compare the fit of two hierarchical Bayesian 
models. 
8.2.5 
Déviance Information Criterion 
Another method to check the fit of a model was proposed by Dempster (1974). 
It is similar to the use of the déviance measure in generalized linear modelling 
(McCullagh and Neider, 1989) but, being in a Bayesian framework, it is the 
posterior distribution of the log-likelihood of the observed data that is exam-
ined. 
If the model is given by the data Y and parameters tp = (O.VJ), the joint 
distribution can be generally factorised 
i.'he fit of the model is directly influenced by the parameters 0, because they 

CHAPTER 
8. BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
197 
affect directly the observed data y. The models are compared using the pos-
terior distribution of 
D{6) 
=-2\ogv(y\6). 
The quantity D{&) is called Bayesian déviance 
(Spiegelhalter, Best and Car­
lin, 1998). The posterior distribution of D(9) is calculated using p{B\y) oc 
p(y\B)p{Ô) and the fit of a model M is then measured by 
D = Eo\y[D]= J 
D(0)p(ô\y)d9. 
One aspect that should not be neglected, especially for hierarchical mod­
els, is the nnmber of parameters used. Hierarchical models combined with 
régression models provide a very good solution to fit sparse data. Typically, 
hierarchical models have more parameters than data observations. However, 
thèse models do not provide a perfect ht. This is because the parameters 
are structured in several layers in a hierarchical structure and they are not 
independent parameters like in the classical case. Thèse models allow a better 
description of the stochastic machinery that is assumed to generate the data. 
The parameters are considered random variables. 
Thus. the parameters in 
the second layer are used just to describe the probability distributions of the 
parameters in the hrst layer. 
Models with large number of parameters should be penalised in the same 
way the Akaike information criterion (Àkaike, 1973) does for régression or 
log-linear models. The effective number of parameters pjy is a measure of 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
complexity of the model and is defmed by 
193 
pD 
= 
D-D(E91V[$]) 
= 
D - 
D($) 
whîch means the posterior expectation of the Bayesian déviance minus the 
Bayesian déviance calculated by replacing 0 with their posterior expectations 
9. 
The Déviance Information Criterion puts thèse two measures together 
DIC = 
D+PD 
and this new measure allows the cornparison of arbitrarily complex models. 
DIC is a measure of fit together with a measure of the effective number of 
Parameters, based on the posterior distribution of the log-hkelihood under 
each model. It was shown, Spiegelhalter, Best and Carlin (1998), that this 
criterion is a natural généralisation of Akaike's Information Criterion. 
Another advantage of using this tool is that D and po are easy to compute 
from a M C M C output analysis. Both the Bayesian déviance D(0) and para-
rneters 9 are monitored during an M C M C and D equals the sample mean of 
the simulated values of D(9), 
while po is D minus D(9) calculated using the 
sample means 9. The models with smaller DIC are preferred. 
For a Poisson model, YK ~ Pois(Àjt), where the unknown parameters are 

CHAPTER 
8. BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
199 
the unobserved means A,t, the scaled déviance is 
Ds{0) = 
2'£ 
k 
» * l o g - ^ - ( » * - e » ' ) 
(3.16) 
where log A* = ôk. The Bayesian déviance is obtained by retaining only those 
terms that dépend on 0. The other terms depending only on data do not affect 
the comparison of différent models so they can be left out. 
This criterion can be easily calculated in a M C M C analysis, no further 
calculations being required outside the M C M C Output. D f C will be used for 
model comparison in Section 8.2.7 of this Chapter and in Chapter 9. It should 
be noted that DIC is not recommended to select a unique model (Spiegelhalter. 
Best and Carlin, 1998). A unique model should be selected using background 
knowledge. 
8.2.6 
Global goodness-of-fit tests based on Bayesian p-
values 
A compromise between Bayesian and fréquent ist model checking procédure 
was introduced by Gelman et al. (1995) and it is described in this section. 
The discrepancy between the model under scrutiny and the data is measured 
by a test quantity T(y.9)y 
which is a scalar summary of parameters, jointly 
denoted by Ö, and data, jointly denoted by y. 
In classical statistics, 9 is 
considered known or estimated, and the fit of the data can be measured by 
the tail-area probability, called the P-value. T'hen the test statistic dépends 

CHARTER 
8. BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
only on the observed data y and the P-value is calculated as 
200 
Pr(T(?/ r e p) > T(y) \ 9) 
where y r e p is a replicated set of data, a hypothetical future value of y if the 
conditions that produced data y are unchanged. Therefore, the probability in 
calculating the P-value is taken over the distribution of yrep 
with Ô known. 
A n estimate of B is used in gênerai to calculate this probability. 
In a Bayesian framework, point estimâtes of the parameters 9 are not 
needed. Instead. the ht of the model is measured by comparing the observed 
data y with the posterior prédictive distribution. The test quantity T dépends 
on the data y and the parameters 0 as well, and it is calculated over a sample 
frorn the posterior distribution of 9. The P-value is called Bayesian 
P-value 
and is defined as the probability that the replicated data y r e p has a test T 
more extreme than the test calculated for the observed data y 
pT = -Pi(T(y"--v,6)>T(y,9)\y). 
(8.17) 
A subtle différence is that a Bayesian P-value is conditioned over the data y 
and not over the parameters 9. 
For applications, for each value 0j, of a sample of size q from p($ | y), 
a value for y™p is simulated from the posterior prédictive distribution. The 
Bayesian P-value is easily calculated as the proportion of thèse q draws for 
which the T(yr^p,6j) 
> T(y.93), 
where j ~ 1,2,...(/. 
A set of data with a 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
201 
very small or very large Bayesian P-value provides évidence against the model. 
However, this does not mean that a single good value qualifies a model as being 
very good. Other aspects of the models investigated, such as those discussed 
in the previous two sections, may help in making better décisions regarding 
mode! sélection and criticism. 
A discrepancy measure that will be used for hierarchical multiple response 
models in Chapter 9 is the x2 
discrepancy 
where the sum is taken over ail observations. 
8.2.7 
A comparison between différent compound Pois-
son models 
For a given set of data, différent distributional spécifications for G may lead to 
différent results. Here a gamma distribution is used because analytical calcu-
lations are possible in this case. This does not mean that other distributions, 
such as log normal or even the double exponential cannot be used. 
M C M C 
methods can easily accommodate complicated calculations required by thèse 
two distributions. 
Consider road accident data, described in greater détail later at a disag-
gregated level in Chapter 9, concerning accidents between. 1984 and 1991 on 
156 single-carriageway link sites in Kent. Without considering any covariate 
k 
(yk - E(Yk | 0)f 
var(F t | 9) 
(8.18) 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
information, the following three prédictive models are compared 
M i : Poisson-gamma model 
202 
Yk\Xk 
~ 
Pois(A f c) 
Xk | a, b ~ 
gamma(a, b) 
a 
~ 
Ëxp(l) 
b 
~ 
gamma(0.1,1) 
where Exp(-) is the exponential distribution. This model is not exactly the 
same as the Poisson-gamma model given by équation (8.11). It was chosen 
because it can be shown (George et 
al., 1993) that this leads to a posterior 
for b which is a gamma distribution but leads to a non-standard posterior for 
a which requires the use of Gibbs sampling; 
M
2 : Poisson-log normal model 
Yk\Xk 
- 
Pois(Ajt) 
Afc | f.1, r 
~ 
logN(/A, T) 
ti 
~ 
N(0,0.0001) 
r 
- 
gamma(0.001,0.001) 
M$: Poisson-log double exponential model 
Yk | Xk 
~ 
Pois(A f c) 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
203 
log(Ajt) | u.r 
~ 
DE(//,r) 
v 
~ 
N(0,0.0001) 
r 
- 
gamma(0.001,0.001) 
where the double exponential probability density function is 
The posterior summary for the quantities of interest of each model is given in 
Table 8.1. The inference is based on a sample of 10000 values after a burn-in 
period of 20000 itérations. 
The so called burn-in period is the part of the 
Markov chain simulated before the user is confident that the convergence has 
been reached. 
This part of the chain is discarded and a sample is selected 
from the next part of the chain. The actual modelling in W i n B U G S took less 
than 100 seconds for 10000 itérations on a Pentium II personal computer with 
100 M H z . The three models can be comparée! in terms of fit to the data by 
the Déviance Information Criterion. (DIC). 
Before looking at the results one might expect the Poisson-gamma and 
Poisson-log normal models to be quite close in terms of fit because they have 
similar shapes and they have been used in the applied statistical literature 
as compound distributions for the Poisson distribution. Nothing is known 
from other studies about the Poisson-log double exponential. so vve would not 
be surprised if the third model did not fit the Kent data well. The quantities 

CHAPTER 
8. BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
204 
Table 8.1: Posterior calculations for all 3 models compared 
Model M i 
node 
mean 
sd 
2.5% 
median 
97.5% 
a 
0.58 
0.07 
0.46 
0.58 
0.72 
b 
0.02 
0.003 
0.02 
0.02 
0.03 
deviance 
151.9 
17.57 
119.7 
151.4 
188.6 
Model M2 
node 
mean 
sd 
2.5% 
median 
97.5% 
ß 
2.44 
0.14 
2.17 
2.44 
2.71 
T 
0.41 
0.06 
0.3 
0.40 
0.54 
deviance 
173.2 
18.5 
139.1 
172.7 
211.7 
Model iV/3 
node 
mean 
sd 
2.5% 
median 
97.5% 
V 
2.76 
0.12 
2.51 
2.76 
3 
T 
0.75 
0.70 
0.62 
0.75 
0.90 
deviance 
159.9 
18.04 
126.7 
158.9 
197.3 
required for calculating DIG are described in Table S.2 and it can be easily seen 
that, for this set of data, the gamma distribution is the most appropriate out 
of the three compared. It is also surprising that the log double exponential 
distribution gives better results, for this set of data, than the log normal 
distribution. One explanation for that might be the shape of the distribution. 
Having some sites with zero counts, the histogram of the data suggests that 
a gamma distribution with a shape parameter a £ (0,1) is appropriate. This 
is the case indeed and the log double exponential distribution is closer in 
resampling a gamma distribution of this shape than a log normal distribution. 

CHAPTER 
8. BAYESÎAN 
MODELS 
FOR ACCIDENT 
COUNTS 
205 
Table 8.2: DIC calculations for ail S models 
comparée 
Model 
D 
D{B) 
pD 
D I C 
M{ 
152 11.68 140.32 
292.32 
M2 
173.2 22.96 
150.24 
323.44 
M
3 
159.9 16.89 143.01 
302.91 
Another way to measure the adequacy of the models is to compare the 
Pearson resïduals calculated as yk~E(-Xk\y) f o r 
each site h = 1 , 2 , . . . , 156. The 
box plots of Pearson residuals for the three models are presented in Figure 8.3. 
A i l three models fit the data very well. However, there are a few points worth 
mentioning. The Poisson-gamma model tends to give higher estimâtes than 
the observed numbers of accidents. The Poisson-log normal model would be 
the best model if the extrême residuals about -1 were ignored. The sites giving 
thèse residuals close to -1 are sites with zéro accidents observed. The Poisson-
log normal model predicts a mean value around 1 for those sites whereas 
the Poisson-gamma model predicts values around 0.5, closer to the observed 
data. 
Therefore, taking out the sites with zéro accidents, it is likely that 
the Poisson-log normal model outperforms the Poisson-gamma rnodel. The 
Poisson-log double exponential is a good compromise between the previous 
two, and according to the DIC criterion better than the Poisson-log normal 
model, because its prédictions for sites with zéro accidents are better. 
In conclusion, for any Bayesian model, the M C M C modelling process will 
go through the following stages: 

CHAPTER 
8. BAYESIAN 
MODELS 
F O R ACCIDENT 
COVNTS 
206 
RESP3)E 
HESPSLN 
Figure 8.3: Box plots for the models comparée; 
RESPSGA 
dénotes 
residuals 
for Poisson-gamma model, RESPSDE 
dénotes residuals for Poisson-log double 
exponential model and RESPSLN 
dénotes 
residuals for Poisson-log 
normal 
model 
1. Start simulating either a single long chain or several parallel chains that 
will be considérée! in the end as a mixed chain: it is a good idea to start 
from some initial values that are not very far frora the région in which 
likelihood is positive. 
2. Monitor the convergence of the chain using the Gelman-Rubin conver­
gence tool and the dynamic plots of the values for some of the parameters 
of interest, and make sure that the chain has become stable. 
3. Using the Markov chain output, calculate the Bayesian P-values for one 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
207 
or more appropriate test criteria and make sure that the model is not 
rejected by the data, that is the Bayesian P-values are not too small. 
4. If everything is fine, any inferential statistics can be calculated now on 
the same M C M C output. 
These four steps are used in M C M C analyses for all models investigated in 
Chapter 9. 
8.3 
Multivariate Hierarchical Models of Counts 
Techniques for modelling multiple counts jointly have not been extensively 
developed in the statistical literature, mainly because of the lack of a multi­
variate discrete distribution that could support complex correlation structures. 
Bayesian and E B research related to multiple response variables has concen­
trated on longitudinal studies for clinical trials or biostatistical data (Breslow 
and Clayton, 1993; Zeger and Karim, 1991; Gilks et 
ah, 1996) and (Carlin 
and Louis, 1996) or educational studies (Goldstein, 1979). 
In this section, 
multiple response models for counts are developed. Several classes of models 
based on mixing the Poisson distribution with other known distributions are 
proposed. Some real-world applications involving accident frequencies on the 
road network are described in detail in Chapter 9. A l l the models are specified 
hierarchically and are fully Bayesian. 

CHAPTER 
8. 
BAYESÏAN 
MODELS 
FOR 
ACCIDENT 
COUNTS 
208 
8.3.1 
Hierarchical Poisson-regression models with ran-
dom effects 
Suppose that there are N units of the analysis ( for example the sites of a 
road network). At each unit, M different counts Y\, Y
2 , . . . , YM are recorded 
(for example the numbers of accidents of different levels of severity in a finite 
time period). Typically, the counts are modelled with a Poisson likelihood. 
It is possible that the counts are correlated so multiple response models are 
desirable. Depending on the information available, the statistical analysis can 
be based entirely on the observed counts. 
Alternatively, covariate informa­
tion (for example environmental characteristics) can be linked to the observed 
counts through some regression equations. 
A framework mean-variance model 
The proposed models offer solutions to, at least, two of the well-known prob­
lems in modelling counts: overdispersion, and. possible correlation between the 
M counts for each unit. The following mean-variance model can be used as a 
framework. A similar model has been proposed (Loveday and Jarrett, 1992) 
at an univariate level for spatially correlated accident frequencies. 
For all k 6 {1,2,... ,N], 
z € { 1 , 2 , . . . , M } let Yki be the count of type i 
at unit k. Then the assumptions of the model are 
E ( Y W I Xki) 
= 
var(y f c l- | \kl) 
= \kx 
(8.19) 
and \ki 
= 
fikie\p(Xl
kipi). 

CHAPTER 
8. BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
209 
Hère Xki dénotes a vector of explanatory variables, each of which can be fixed 
or random; /?, dénotes the vector of the régression coefficients, and fik{ is a 
random quantity independent of the X&. In addition, the random variables 
{.iki (for k = 1,2.... ,N) are independently and identically distributed. with 
for ail fc € {1,2,..., iV}, z, j 6 {1,2,..., M } . The mean of the random effects 
Pki can be always taken equal to 1. If it is not 1 from the beginning then 
^ = ft/E(ft) has mean 1 and the factor IfE(fi) 
can always be included in the 
régression component. The following proposition illustrâtes the value of this 
approach. 
Proposition 8.1 For the mean-variance model described above 
Proof : Because of the independence assumption over units the index k can 
be dropped to simplify the notation. Moreover, the results can be proved a 
bit more generally assuming a gênerai positive covariate structure O^i instead 
of exp(X'kifti) 
and this will be used below again for simplicity. Using the 
properties of conditional expectation it follows immediately that 
E(/Xfc») = 1, 
COv(fiki}f.Lkj) 
= <7, 
1. var(lk | X) > E(Yki 
\ X) 
2. cov{Yki,Ykj 
| X) = 
Gxp(X'ki 
E(Y; I G) 
EM(E(V;|0,M)) 
(8.20) 
E,.(MA) 

CHAPTER 
8. 
BAY ESI AN MODELS 
FOR ACCIDENT 
COUNTS 
210 
= 
0,-. 
var(K I 0) 
= 
E M(var(y; | X, /;)) + var, 4(E(K- I 0 , /u)) 
(3.21) 
= 
E m(;Í,-0¿) -f- var^/^0;) 
= 
E M(/ii)0i + var ( 4(> i)0? 
= 041 + ^0.] 
> 
0 ¡ . 
Similarly, 
Finally, 
c o v ^ Y } 
0) 
E i t(cov(K-,V; 10^)) 
+ 
+ c o v l i ( E ( ^ | 0 , / i ) 5 E ( ^ | 0 , / i ) ) 
Since the 0,- are positive 
corr(yfcl,yfcj I 0)| 
0 Ą K 
(8.22) 

CHAPTER 
8. 
BAYES!AN 
MODELS 
FOR ACCIDENT 
COUNTS 
211 
where pu = 
is the corrélation coefficient of the random effects a-, and 
fij. It can also be seen that 
sgn(cov(V^, Ykj \ ©)) = sgn(o-^). 
Taking a more specific parametric approach, the following hierarchical 
models, combining random effects with log-linear regression, are suitable for 
disentangling the complex structure of multivariate discrete data. 
A Poisson-regression model with gamma random effects 
This is a hierarchical Bayesian model combined with hxed explanatory vari­
ables 
that is specified in three stages. For all sites k = 1 , 2 , . . . , N and all 
types of accident i := 1,2,...,jW 
Yki I Xki 
ind Pois(A f c i) 
(8.23) 
log Xki = 0ki 
= 
\ogpkl 4 X'kiPu 
ind gamma(cv,-, c^) = gamma 1; 1 1 
ad 
N(0,0.001), and 
iid 
gamma(a, b) 
where a, 6 are known values. The shape and scale parameters of the gamma 
distribution of pki are chosen to be equal in order to ensure that the random 
efFects are distributed with mean equal to 1. The hyperprior for the regression 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
212 
coefficients (ft,-) is non-informative, and typically a and b are chosen to make 
the hyperprior for the gamma precision parameters (a») non-informative also. 
The random effects (pki) account for missing information, uncollected data 
or unobserved changes in data over the observed period of time. There is no 
correlation structure for 
so this model is a simplification of the general 
mean-variance model. 
The directed graphical model encapsulating the conditional independen­
cies of the above model is illustrated in Figure S.4. This graphical model is 
different from the graphical models investigated in the first part of the thesis 
in connection with road accident characteristics, because some vertices corre­
spond to unobserved quantities. For example the vertex denoted on the graph 
by lambda[k,i] does not correspond to an observed variable. It is just a variable 
used for model specification. The regression part of the model is concentrated 
into the variable denoted on the graph by theta[k,i]. It can be easily seen that, 
given the values of lambda[k,i], the variable y[k,i] is conditionally independent 
of all the other variables in the model. This is in agreement with the hierarchi­
cal specification of the model given in (8.24). A similar graph was illustrated 
in the Section 8.2 with a reduced number of vertices also representing observ­
able and unobservable variables. The graph illustrated here is more complex. 
The joint posterior distribution of all parameters p, ¡3 and a can be calculated 
as: 
p(^,ftcv | y) <x p(y | fi,P) p((i | a) p{a) p(f3) 

CHAPTER 
8. BAYES!AN 
MODELS 
FOR ACCIDENT 
COUNTS 
213 
X[k,i] 
forfkIN 1 : N) 
Y[k,i] 
forfllN 1 : M) 
Figure 8-4- Directed graphical model for Poisson-régression 
m.odel wiih gamma 
random effects 
N 
M 
N 
M 
a n n
pois(^' i 
n ns
amma(/^ i 
fc=l i = l 
k=l i = l 
M 
M 
x ]^[ gamraa(Q, | a, b) JJ 
I ] N ( A i I 0, 0.001) 
¿=1 
t=i j 
N 
M ( 
oc n 
U ] ^ ^ ' ^ ^
0 ^ 
• 
fc=i i=i L 
x fî < - v ^ n n « - ^ 
i=i 
¿=1 j 
r(«.) 
(8.24) 
If 
dim/? dénotes the number of régression coefficients used then there are 
MN -f M -\- dim/3 parameters. The model is very complex and it is not 
possible to sirnulate directly a sample from p(p,(3^a \ y). Again the Gibbs 
sampler is a simple, feasible solution, at the cost of computational effort. The 
conditional distributions required are 
p(/.« | y,0,a) 
oc 
/ 4 - + - - 1 e - " - < - + ^ ' " ' ) 

CHAPTER 
8. BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
214 
= 
gammaf/ijt,- | yki + ai:ai -f ex'^0i) 
(8.25) 
P(*t\y,v,0) 
a ^ ^ j ^ n ^ 
e - ^ E L - . + O o T i 
(8.26) 
Na{+a-\ 
/ 
N 
jv 
<x — 
e-°'-(-E*=i
 L o S ^ + E f c = i 
(g 27) 
0>>))* 
1 0 
] 
p(fr\y,p,a) 
oc e E ^ ^ ^ . - f t e - E . ^ ^ P ^ f t c - ^ W - 
( 8.28) 
where we shall use block conditional distribution for all the regression para­
meters, that is a multivariate normal distribution instead of a set of separate 
univariate normal distributions will be used for updating the priors. 
A Poisson-regression model with multivariate normal random effects 
Starting from the previous model several alternative models are possible. For 
example ; instead of a gamma distribution with mean 1, a multivariate M-
dimensional normal distribution for the random effects p might be considered 
as more appropiate. In addition, other hyper-priors are required. The model 
is given by 
Yki \ Xki 
~ 
Pois(A f c l) 
(8.29) 
l o g A t i 
= jj.ki + 
X'kiPi 
A i 
~ 
N(0, 0.001) 
T 
- 
Wishart(R,p) 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
215 
where N¿v/(0,v/-, T) is the jV/-dimensional multivariate normal distribution with 
mean vector having all elements equal to 0 and with T the inverse of the co-
variance matrix, also called the precision matrix. The hyper-prior parameters 
R and p > M are known, usually taking p — M for non-informative priors. 
The Wisfiart probability density function, as used in this thesis, is 
/ ( X l ü . p J a l f l l f l X l ^ e - ^ ™» 
where X is an M x M symmetric and positive-definite matrix, p > M is the 
degrees of freedom and R. is a M x M symmetric and positive-definite (non-
singular) matrix. The Wishart prior is used for the inverse of the covariance 
matrices of multivariate normal distributions and because E ( X ) = 
p ( i ? ) - 1 , 
R~x 
is best interpreted as the expected prior precisions of the random ef­
fects //. Small values of p correspond to vaguer prior distributions and it is 
recommended (Spiegelhalter, Thomas and Best, 1998) to take p = 
M. 
This is a complicated version of the mixed Poisson-gamma model and the 
differences can be seen easily on the graph in Figure 8.5. The Gibbs sampler 
requires the knowledge of conditional distributions of the unknown quantities 
of the target distribution, the posterior joint distribution 
p((p I y) = p(\,n,8,T 
I y) 
in this case, and this requirement cannot always be satisfied. For these sit­
uations a more general M C M C method, called the Metropolis-Bastings 
algo-

CHAPTER 
S. BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
216 
forfi IN 1 : M) 
Figure 8.5: Directed graphical model for Poisson-regression 
model with multi­
variate normal random effects 
rithm, offers a solution: see Carlin and Louis (1996) Section 5.4.3 and Gelman 
et al. (1995) Section 11.2.. The simulation process moves around in the ip-
space according to a candidate probability density q{y>,y) from which a draw 
ip" is made. Then the jump from the current value to the candidate value tp* 
is made with probability r where 
r = mm 1. 
/ / / — . — - 
. 
(8.30) 
This is called the acceptance probability and is always equal to 1 for the 
particular case of Gibbs sampling. The Metropolis-Hastings algorithm is used 
by default in W i n B U G S for situations where Gibbs sampling is not possible. 
The acceptance rate can be easily monitored and together with other measures 
on the output it is an indication of the performance of the algorithm. The 
Poisson-regression model with multivariate normal random effects requires the 

CHAPTER 
8. BAYESIAN 
MODELS 
EOR ACCIDENT 
COUNTS 
217 
use of Metropolis-Hastings algorithm. 
A simplifiée! version of the Poisson-régression mode! with gamma random 
effects is obtained by approximating the logarithm of the gamma distributed 
random effects /t^ by a normally distributed quantity b^i- Then 
logAfcf 
= 
bki + X'xßu 
(8.31) 
bu 
~ 
N(0,r), 
r 
- 
gamma(0.001,0.001). 
Sometimes the random effects 6^ can be separated into effects arising from 
variation among the sites and from variation among accident types 
bki = 
«fc + «i 
(8.32) 
uk 
~ 
N ( 0 , T U ) 
Vi 
~ 
N ( 0 , T V ) 
ru 
- 
gamma(0.001,0.001) 
rv 
~ 
gamma(0.001,0.001) 
A l l models described in this class are hierarchical and for inference 
M C M C 
methods are necessary. These models will be applied and further discussed in 
Chapter 9. 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
218 
8.3.2 
Bayesian models using the multivariate Poisson-
log normal distribution 
For multivariate continuous data the multivariate normal distribution provides 
a sound base for statistical modelling. By contrast, for multivariate counts, 
there is a lack of discrete multivariate distributions that could play the role 
of Poisson distribution in the univariate case. A consequence is that some­
times inappropriate methods employing continuous multivariate distributions 
are proposed in order to support a complex correlation structure. The study 
of Amis (1996) is an example of a good applied statistical work that can be 
further improved by applying the hierarchical Bayesian methodology proposed 
in the previous section. Because the aim of Amis' paper was to investigate 
accident counts and the associations between accident types and some envi­
ronmental variables, hierarchical models seem to be perfectly suitable for this. 
The probability distribution described bellow can also improve another exam­
ple of applied work involving road accident, done by Salmmen and Heiskanen 
(1997). 
Tn this section, a discrete multivariate distribution is described as a fea­
sible solution for discrete data modelling with multiple responses. The idea 
is simple, (Aitchison and Ho, 1989). but powerful computational methods are 
needed to put it into practice. For all k € {1, 2 , . . . , iV), i £ {1, 2 , . . . , M} 
we 
write 
Ykl\Xkt 
& 
P o i s ^ - ) , 
(8.33) 

CHAPTER 
8. BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
219 
(log(A A 1),...,log(A f c M))1/x,T 
~ 
N M O , T ) 
(8.34) 
where T = £ 
1 is the precision matrix. The probability density function of 
the M-dimensional log normal distribution is 
p(\\fc.T) = (2T)-*(nA,-)-l|T|-* exp ( - ^ l o g A - p y r a o g A - / , ) ) 
The multivariate Poisson-log normal distribution, that will be denoted by 
PAM(fitT)*t 
is the mixture of independent Poisson distributions with multi­
variate log normal distribution for the Poisson means. The probability density 
function of PAM(fx,T) 
is exactly the marginal density of Y's conditioned on 
fi and T only. 
f 
M 
P{yii---,VM\V;T) 
= / 
Y[?o\s(yl\Xl)p(Xl\p,T)dXl---dXM 
(8.35) 
where y i , • . •, y.,vf = 0,1,.... The important moments of this distribution can 
be easily calculated. If £ = (<7ij) then 
E(Yi) 
= E(E{Yi\\i)) = E{\i) 
(8.36) 
1 
X 
= 
exp(/i(- + -<7U) = (ii 
var(y0 = 
E(var(y;|A f)) + var(E(y;-|Al-)) 
(8.37) 
- 
E(A.-) + var(A0 
= 
a. + ftj(exp (<rri) - 1) 

CHAPTER 
8. BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
220 
cov(y;,^) 
= 
E(cov(y;,y^|A)) + cov(E(y;|AO !E(v j|A J-)) 
(8.38) 
= 
cov(Ai. Xj) = rt,-fij(exp (atj) — 1) 
Two immediate consequences are that, for each unit k G {1,2,. .. , A''}, 
v a r ( n 0 > 
Wki) 
which means that there is overdispersion for the marginal distributions, and 
\coTT(Yki,Ykj)\ < |corr(Afci. Xkj)\ 
sgn(corr(y f c i, Ykj)) = sgn(corr(A A i, A^)) 
which are special cases of the results of the mean-variance model. Altogether 
M{M+3) p a r a m e t ; e r s 
a
r
e needed to specify the PAM{ft,T) 
distribution. Nega­
tive and positive correlations are supported by this mixed distribution, which 
gives it an advantage over other multivariate discrete distributions such as 
multinomial or negative multinomial. However, the estimation of the pa­
rameters is not straightforward. For maximum likelihood estimation, a re-
parameterization and a mixture of Newton-Raphson and steepest ascent meth­
ods are helpful but computationally intensive, (see Aitchison and Ho (1989)). 
Here we shall use M C M C methods (Metropolis-Hastings algorithm) to 
obtain inference summaries about the parameters ft and and T. In a fully 
Bayesian context, further prior distributions, probably non-informative, are 

CHAPTER 
8. 
BAY ESI AN MODELS 
FOR ACCIDENT 
COUNTS 
221 
faffklNI :N) 
llll 
|| 
forfHN 1 :M) 
|| 
Figure 8.6: 
Directed graphical model for 
a multivariate 
Poisson-log 
normal 
model 
required for p and T. The recommended parametric distributions are normal 
for p and Wishart for T (Carlin and Louis, 1996; Gelman et ah. 1995). Such 
a model is described by the directed graph in Figure 8.6 and it can be easily 
seen that it is a straightforward generalisation of the directed graphical model 
in Figure 8.1 that represented a univariate Poisson-log normal model. 
Covariate information can be introduced easily in this model by regres­
sion components like pki — X'kip{. The information value of the explanatory 
variables Xki 
can be examined by comparing models without regression with 
models with regression. 
Many other variations on this model structure are 
possible by making small changes, like considering that the regression coeffi­
cients p do not depend on accident count type or repararnetrising p.ki — Ufc-i-w;, 
a site random effect and an accident type random effect. Models that have 
more parameters tend to fit data better. In a Bayesian context, for hierarchi-

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR A CCI DENT 
CO UNTS 
222 
cal and régression models, the number of parameters is usually very large but 
not all are effective. This class of models will be added to the class of models 
proposed in Section 8.3 and both will be applied and compared on a set of 
data in Chapter 9. 
8.4 
Bayesian model sélection 
In this section a new group of model sélection procédure for hierarchical log-
linear models is proposed in a Bayesian framework. Other model sélection 
procédures were investigated in the hrst part of the thesis. The reason why 
thèse methods are discussed here is that they employ Gibbs sampling for solv-
ing the computational side. The objective of thèse model sélection procédures 
belong in the hrst part of the thesis but the solution belongs in this second 
part. 
Since graphical models are log-linear models this method can be used for 
this subclass as well. 
The idea on which this model sélection algorithm is 
based is similar to a suggestion of Lindley (1969, Section 5.6) in connection 
with a classical test of a point null hypothesis. It is a compromise between 
Bayesian and classical statistics. The significance test at level a is conducted 
using the crédible set, which is roughly equal to the highest posterior région 
(Carlin and Louis, 1996). 
For hierarchical models only the maximal interaction u-terms (the genera-
tors of the model as they were described in Chapter 4) need to be specined and, 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
223 
as will be seen later, they efïectively drive the technique proposed hère. For 
log-linear models many sélection algorithms have been proposed; see Chap­
ter 4. Some of thèse methods were applied to the collision-rollover data in 
Chapter 4 and the Edwards-Havranek method was also applied to Bedford-
shire data in Chapter 5. Each of thèse known methods has a différent moti­
vation, but ail share the same drawbacks: practical sensitivity to the choice 
of stopping rule and of initial model; lack of information about the power of 
différent procédures; being able to apply standard distribution theory only 
for a fixed model; and lack of information about the influence of the model 
sélection procédure on the sampling distribution of the model that is 
fitted. 
In addition, some of thèse algorithms are based on asymptotic distributions 
of déviance (G' 2) or Pearson chi-squared (A' 2), which are unreliable when the 
data is sparse (Kreiner, 1987). 
Forward sélection procédures starting from 
the mutual independence model are dubious because this model rarely flts the 
data, and the hypothesis testing of nested models involves models known to 
fit the data badly. 
The idea of this new approach in this section is to overcome thèse diffi-
culties by avoiding classical hypothesis testing and asymptotic methods. In-
stead, forward, backward and bidirectional procédures are proposed using fully 
Bayesian inference for the maximal w-terms eligible for sélection (inclusion or 
élimination). 
These model sélection algorithms can be used for data sum-
marised in contingency tables thus making a straightforward connection with 
the first part of the thesis. 
However, the computational side of thèse algo-

CHAPTER 
8. 
RAY ESI AN MODELS 
FOR ACCIDENT 
COUNTS 
224 
rithms is mainly based on Gibbs sampling, used in this second part of the 
thesis, motivating the inclusion of thèse model sélection procédures hère. 
Fach stage of the sélection methods presented below is in correspondence 
with an order of interaction and, in any stage, only the maximal u-terms 
for that order of interaction are tested. 
The main effects 
k G V , are 
always kept in the models. 
Other terms might be included in the models 
because of sampling design spécification. For example, if the sampling scheme 
is a product-multinomial, some interactions terms need to be included in the 
model without any further testing. The procédures end when there are no 
maximal eligible u-terms left. The final model is a hierarchical interaction 
model. If the maximal u-terms correspond to the cliques of the interaction 
graph then the final hierarchical model is graphical (Whittaker, 1990) and the 
model is interprétable in terms of conditional independencies. 
The idea driving the model sélection methods proposed here is to consider 
the maximal u-terms under scrutiny as random effects and ail the other u-
terms in the model as fixed effects. For each interaction term ua (where a is 
a subset of vertices from V ) considérée! random effect, the following distribu-
tional assumptions are made 
ua 
~ 
N(0,r o) 
(8.39) 
ru = \ 
~ 
gamma(0.001,0.001) 
(8.40) 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR 
ACCIDENT 
COUNTS 
and all the other fixed terms have very flat normal priors 
225 
u 6~N(0,0.0001) 
The posterior distribution of the random efFects ua is p(ua\n(i) : i £ X), and 
this distribution is used to calcúlate the equal tail crédible set CS(u a) for 
ua, 
(see Carlin and Louis (1996. Section 2.3.2)), simply taking the a/2 and 
(1 — a)/2-quartiles of the posterior distribution p(ua\n(i) : i £ T). 
The equal 
tau crédible set is not always equal to the highest posterior density crédible 
set (unless the posterior distribution is Symmetrie and unimodal) but being 
just a bit wider it is more convenient for the applied statistician to work with 
the former. If 0 ^ CS(t¿ a) then ua should not be eliminated from the model. 
8.4.1 
Bayesian forward sélection 
This procédure starts from the mutual independence model 
(8.41) 
In any stage S^ 
the inclusion of each maximal eligible j-order of interaction 
terms ua 
is tested. 
If the final model selected at the end of stage S^ 
i is 
yVfO' 0 
: logÀp 
then, in the stage S^\ the posterior distributions of each 
eligible ua is calculated from the model 
i o
g A r > = i o
g A r > 
+ 
ua. 
(8.42) 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
226 
Therefore the credible sets are calculated independently for each ua. 
The final 
model of this stage, M^\ is obtainecl by adding to M
(
j ~ ^ all ua selected for 
inclusion. that is all ua with 0 ^ CS(u 0). In the following stages these terms 
are considered fixed terms. 
It is worth mentioning that, in a given stage, maybe not all maximal a-
terms are eligible for inclusion. For example, if U i 2 has been eliminated in a 
previous stage then u^a are automatically excluded because we require the 
log-linear model to be hierarchical. 
8.4.2 
Bayesian backward elimination 
The procedure starts with the saturated model 
where the sura is over all subsets of V, including the empty set. In any stage 
S^. 
all the maximal (d — j)-order u-terms, wtthout a higher order relative in 
the final model of stage S^-1\ 
are considered simultaneously 
random effects 
and all the other terms fixed effects. As before, the final model selected at the 
end of stage S^ 
is denoted by M ^
_
1 * : log A ^ - 1 ' . The posterior distributions 
of all eligible maximal interaction terms ua, 
a G A £ 2 V > are calculated ac-
cording to the model M^~1^ but the status of the terms w a, a 6 A. is changing 
from fixed effects (stage S ^ - 1 ' ) to random effects (stage 
S^). 
The credible sets CS(u a) are calculated for each of the ua and only those 

GHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
227 
terms whose crédible sets do not overlap zéro are kept in the model. 
The 
différence between this procédure and the Bayesiau for ward sélection procé­
dure is that, in a given stage, the crédible sets for the eligible u-terms are 
calculated based on the sarne log-linear model. Note that, at any given level 
of interaction excluding trivial cases, there may be lower, higher or the same 
order of interaction terms that are fixed terms and not eligible. 
8.4.3 
Bayesian bidirectional sélection 
A bidirectional procédure combining the above two procédures of Sections 8.4.1 
and 8.4.2 can be easily developed. Starting from an initial model, such as the 
mutual independence model of équation (8.41), a one-stage forwaxd inclusion 
is performed followed by a one-stage backward élimination. This combined 
computation is made until ail eligible terms are screened. 
For any of thèse three model sélection methods, at any stage, the zi-terms 
giving the model under considération can be partitioned into random effects 
u a , a G A 6 2 V , and hxed terms 
b G B G 2V. 
If u = {(ua)a€A, 
( u ^ ^ g ) and 
T 
— {Ta)a€.A &re the corresponding précision parameters, the joint posterior 
distribution of ail parameters is 
(8.44) 
oc 
nPois(n(i)|u) u 
N(u f t|0.T)gamma(T o|0.001.0.001) 
x fi 
N(u 6|0,0.0001) 
6Ç5 

CHAPTER 
S. BAYESïAN 
MODELS 
FOR ACCIDENT 
CO UNTS 
22S 
For for ward inclusion, A = {a} because the inference is done separately for 
each maximal eligible ua. 
Replacing in (8.44) the known densities. the joint 
posterior density of all quantities, observed and unobserved, is. 
p(u,r\n) oc fi A , ( « ) n ( i ) e - A ' W II ( T . )
0 '
0
0
1 - ^ - ^ -
0 '
0
0
1 ' " J[ 
e^^'^SAb) 
and it is obvious that this expression cannot be manipulated analytically. For 
example, the marginal posterior density of ua with a € A is 
p(ua | n) oc Jp(u,T\n)drduA\adus 
which requires the calculation of a complicated multidimensional integral. 
Such calculation is impossible to be done in closed form. 
However, an advanced Gibbs sampling method can be used to overcome 
this computational problem (Gilks> 1992) and the analysis can be done in 
W i n B U G S , (see Spiegelhalter, Thomas and Best (1998)). 
8.4.4 
Applications to road accident tables 
Collision-rollover data 
It was shown that the 4-dimensioual table 3.3 in Chapter 3, summarising the 
collision-rollover data from Kihlberg et al. (1964), can be safely decomposed 
into two 3-dimensional subtables AC D and BCD without evoking problems 
with Simpson's paradox. The model sélection procédures used in log-linear 

CHAPTER 
8. BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
229 
modelling cannot identify a simpler graphical model and the only simpler log-
linear mode! fitting the data well is the no three-way interaction model, for 
both subtables. 
In this subsection, forward and backward Bayesian model 
sélection are applied to each subtable. The results are presented in Tables 8.3 
and 8.4. It can easily be seen that for the subtable ACD the model of no 
Table 8.3: Bayesian model sélection 
for ACD subtable 
Forward 
e s 
Model 
u-term 
me an 
2.5% 
97.5% 
[AC] 
Ui2 
1.73 
1.56 
1.90 
[AD] 
U\3 
l.S 
1.64 
1.95 
[CD] 
U23 
1.45 
1.27 
1.63 
[ACD] 
«123 
0.15 
-0.12 
0.59 
Backward 
[ACD] 
«123 
0.15 
-0.12 
0.59 
[AC][AD][CD] 
U]2 
1.38 
1.20 
1.56 
^13 
1.60 
1.44 
1.76 
«23 
1.01 
0.82 
1.21 
three-way interaction is selected both by the forward and backward bayesian 
model sélection criteria. For the second subtable BCD, by forward bayesian 
sélection the model [.8C][C0] is selected and by backward élimination the 
model [BC][5D][(7.D] is selected. This illustrâtes the point that forward and 
backward Bayesian procédures do not necessarily select the same model. 
A corner point parameterisation (Bishop et al., 1975) was used for the 
log-linear expansion, that is ail u-terms having at Least one index equal to 1 is 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
230 
Table 8-4- Bayesian model sélection 
for BCD subtable 
Forward 
CS 
Model 
u-term 
mean 
2.5% 
97.5% 
[BC] 
ûT2 
-0.61 
-0.7S 
^043 
[BD] 
u}3 
0.04 
-0.08 
0.17 
[CD] 
«as 
1-79 
1.63 
1.95 
[BCD] 
uns 
0.15 
-0.12 
0.59 
Backward 
[BCD] 
u
1
2
3 
0.11 
-0.14 
0.45 
[BC][BD][CD] 
un 
-0.74 
-0.91 
-0.56 
«13 
0.29 
0.11 
0.45 
«23 
1.83 
1.67 
2.00 
set to 0. and because ail the variables are binary the tested i^j-terms are ail 
Utj[2,2], the other values being constrained to zéro. 
Bedfordshire data 3-dimensional subtable 
The collapsibility results discussed in Chapter 6 suggests that it may be 
vvorthwhile to analyse the 3-dimensional subtable defined by three variables, 
accident severity, number of vehicles involved and speed limit. There is no 
simpler graphical model than the saturated model for this subtable and it was 
shown in Section 5.2.1, Chapter 5, that the conditional independence struc­
ture is worth further exploration. In this subsection, forward and backward 
bayesian model sélection procédures are applied to this small subtable, in an 
attempt to understand whether a simpler log-linear model can be selected or 

CHAPTER 
8. BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
231 
Table 8.5: Bayesian forward sélection 
for Bedfordshire data, ANS subtable 
Forward 
CS 
Model 
u-terni 
mean 
2.5% 
97.5% 
[AN] 
«i 2[2,2] 
0.12 
-0.36 
0.78 
«,2(2,3] 
-0.15 
-0.69 
-0.16 
«i 2[3,2] 
0.66 
0.11 
1.29 
«12(3,3] 
0.02 
-0.40 
0.38 
[AS] 
«i3[2,2] 
-1.31 
-2.36 
-0.45 
«i 3[3,2] 
-1.71 
-2.76 
-0.90 
[NS] 
tx23[2,2] 
-0.09 
-0.30 
0.06 
« 2 3[3,2] 
0.85 
0.56 
1.14 
[ANS] 
«123(2,2,2] 
0.15 
-0.54 
0.95 
«i2 3[2,3,2] 
0.20 
-0.53 
1.20 
«i23[3,2,2] 
-0.37 
-1.24 
0.19 
«123(3,3,2] 
-0.23 
-1.30 
0.39 
not. 
The results in Tables 8.5 and 8.6 show that indeed the saturated model 
cannot easily be simplified. In both approaches, forward or backward, there 
are two problems. Consider the u 1 2 term, where index 1 stands for accident 
severity A and 2 stands for the number of vehicles N. 
This u term, which 
accounts for the pairwise interaction between A and N, would be rejected from 
the model if the corresponding CS for 1*12(3.2] overlapped zéro. Unfortunately 
this does not happen and therefore, the interaction between A and N can 
neither be included or excluded from the model. A similar situation occurs 
with the u 23 interaction term, for which 2 values, «23(2,2] and «23(3,2], should 
be tested. 
The three-way interaction term is rejected from the model by 
the backward élimination procédure so the model [A5][SAf][A/V] remains a 

CHARTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COVNTS 
232 
Table 8.6: Bayesian backivard élimination 
for Bedfordshire data, ANS subtable 
Backward 
CS 
Model 
u-terni 
mean 
2.5% 
97.5% 
[ASN\ 
u 1 2 3[2,2,2] 
0.15 
-0.54 
0.95 
«123(2,3,2] 
0.20 
-0.53 
1.20 
ui23[3,2,2] 
-0.37 
-1.24 
0.19 
«i 23[3,3,2] 
-0.23 
-1.30 
0.39 
[AN}[AS][SN] 
«12(2,2] 
0.03 
-0.46 
0.57 
«12(2,3] 
-0.14 
-0.65 
0.24 
«12(3,2] 
0.55 
0.04 
1.08 
«12(3,3] 
0.11 
-0.26 
0.60 
«13(2,2] 
-1.58 
-2.53 
-0.78 
«13(3,2] 
-1.97 
-2.9 
-1.21 
« 2 3[2,2] 
-0.06 
-0.26 
0.09 
«23(3,2] 
0.86 
0.57 
1.14 
candidate. This is not a graphical model so from the conditional independence 
point of view it does not reveal any new information. However ît can be used 
for other purposes, like making inference about odds ratios. 
The major drawback of this procédure is that each mode! investigated 
during the model sélection process fias to be fitted separately. There is no 
program available that would make possible an automated implementation. 
8.5 
Summary 
In this chapter two classes of hierarchical Bayesian models have been intro-
duced. The first class was based mainly on mixed Poisson-régression models 
with random effects. They are ail specified hierarchically in three stages and 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR ACCIDENT 
COUNTS 
233 
use the same régression part. 
The différence between them consists in the 
distributional assumption for the random efïects. 
A gênerai 
mean-variance 
framework model was introduced at the beginning of this chapter, which of-
fers a good solution for accounting for overdispersion and corrélation between 
observed frequencies. 
A i l the models investigated were fully Bayesian and have computational 
difficulties given by the lack of closed-form analytic inferential methods. The 
main points of the methodology for applying M C M C techniques, in particular 
the Gibbs sampler and the Metropolis-Hastings sampler, were pointed out and 
some relatively simple applications were given. A simple case of three possible 
Compound Poisson distributions for the accident totals on 156 sites in Kent 
was discussed, the same road accident data that will be investigated at a more 
disaggregated level in the next chapter. 
A new group of model sélection procédures for hierarchical log-tinear mod­
els for contingency tables has also been introduced. 
The novelty of thèse 
procédures consists in being formulated entirely in a Bayesian framework and 
avoiding classical hypothesis testing. 
The emphasis was more theoretical in this chapter, the applications being 
discussed in greater detail in Chapter 9. The main idea of this chapter is that 
hierarchical Bayesian models coupled with M C M C techniques offer a Statistical 
modelling solution to a wide range of problems related to analysing complex 
datasets such as road accident data, Moreover, the multiple response models 
proposed here open a new area of research and they can be easlly adapted to 

CHAPTER 
8. 
BAYESIAN 
MODELS 
FOR 
ACCIDENT 
COUNTS 
count data sets from other areas of research. 

Chapter 9 
Multiple response models for 
road accident data 
9.1 
Introduction 
In this chapter the techniques introduced in Chapter 8 are applied to a set 
of road accident data. Several models are fitted and the results are discussed 
and compared. The ability to model joint responses provides another dimen­
sion to Statistical modelling of road accidents. It is shown that the ranking 
of hazardous sites can be improved by looking at several types of accidents 
simultaneously. The advantage of using M C M C techniques is that the same 
model Output can be used to provide inference on several problems like model 
sélection, goodness-of-ht, ranking the units of the analysis according to différ­
ent criteria, and so on. This type of analysis is believed to be the first of this 
kind in the area of Statistical modelling of road accident data. 
235 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 
236 
9.1.1 
Data analysed 
The units of the analysis are 156 single carriageway link sites in Kent and the 
data includes ail accidents between 1984 and 1991. The links are defined as 
road sections between two major junctions, or between changes in carriageway 
type (single or dual), or between changes in speed limits. Figure 9.1 shows a 
map of the relevant part of the Kent road network. The nodes on the road 
network defining the junctions and the carriageway types were taken from 
digital maps supplied by Kent County Council and the speed limits were taken 
from the STATS 19 records. The speed limit plays another important rôle as a 
Figure 9.1: Part of Kent road network 
proxy for the actual speed. Speed is a variable that is known to have a major 
impact on the number and severity of accidents (Taylor and Barker, 1994-
1995; Tunaru and Jarrett, 1998a; Baruya, Finch and Wells, 1999). The other 

CHÁPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 
237 
expla.na.tovy variables used in this chapter are link length, in kilometers, and 
estimated traffic flow ( A A D T x 3 6 5 ) . in millions of vehicles per year. These two 
variables are continuous but speed limit, as it was used here. is dichotomous 
(40 mph or less, greater than 40 mph) so the interactions between speed 
limit and the other two were also considered. The original set of data had 
speed limit with several levéis. It was the author's choice to dichotomise this 
explanatory variable. The traffic ñows carne from mostly manual counts with 
some automatic counts. The manual counts can be sparse in both location 
and time but simple linear regression was used to fill in the missing years and 
account for some of the variation in individual counts. The estimated traffic 
flow was averaged o ver all se ven years. 
This set of data was provided by the Transport Management Research 
Centre at Middlesex University which took it from Kent county council for 
a previous research project. The number of accidents at each site was disag-
gregated by accident severity, having two levéis KSI = fatal or serious and S 
= slight, and the number of vehicles involved, with two levéis, 1 vehicle and 
2 or more vehicles. Therefore, there are four accident counts for each site. 
This further classification of the observed accidents was entirely the author's 
choice and it was motivated by the direct association between accident sever­
ity and the number of vehicles revealed by the graphical modeis proposed in 
Chapter 5. 
The cross-classífication of these two categorical variables gives four pos-
sibly correlated groups of observations and the log-linear Poisson regression 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
EOR ROAD ACCIDENT 
DATA 238 
équations for each group of accidents might be différent. The observed number 
Table 9.1: Total number of accidents for each category of accidents 
Severity 
Number of 
Total number 
vehicles involved 
of accidents 
fatal or serious 
1 
443 
2 or more 
852 
slight 
1 
796 
2 or more 
2160 
of accidents in each group is given in Table 9.1 and it is also worth pointing 
out that there are sites with zéro accidents for any type of accident and for 
the total number of accidents as well. 
9.2 
Hierarchical Poisson-régression models for 
multiple accidents 
This section contains the applied statistical modelling results for the models 
combining hierarchical Bayesian spécification with covariate information. The 
models reveal qualitative and quantitative relationships between the numbers 
of road accidents on one side and speed limit, estimatecl trafnc flow and link 
length on the other. Some parts of this section hâve been published in Tunaru 
(1999). 
Three road characteristics, speed limit. link length and traffrc flow, mea-

CHA PTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 
239 
sured for each site, are used in the regression equation. The traffic flovv was 
averaged over all years and denoted by Q. Speed limit S was coded —1 for 
less than 40 mph and +1 for less than 60 mph. link length / was transforrned 
on a logarithmic scale to log /, and the same for trame flows to log Q. 
The múltiple responses analysed in this paper correspond to the four types 
of accidents according to severity and the number of vehicles involved. The 
numbers of fatal or serious accidents with only one vehicle involved are de­
noted by V i , the fatal or serious accidents with two or more vehicles involved 
are denoted by Ví, the slight accidents with only one vehicle are denoted by 
y 3 and the slight accidents with two or more vehicles by Y\. A more detailed 
analysis might consider múltiple responses obtained by cross-classifying the 
accidents according to more than two criteria. For example, pedestrian in-
volvement might be of interest in addition to the criteria used in this paper. 
Moreover, other explanatory variables can be used in addition to those studied 
here. The data as provided by the Transport Management Research Centre 
contained dual carriageway sites as well so an explanatory variable with two 
levéis single-dual would be a natural candidate. 
ffowever, there were very 
few dual carriageway sites and a preliminary analysis revealed that it was not 
worth including those sites. 
The explanatory variables were standardised in order to improve the speed 
with which the simulated Markov chain approach its stationary distribution, as 
recommended in Spiegelhalter, Thomas and Best (1998). Therefore /* and Q*. 
the standardised valúes of the logarithms of the link length and estimated link 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 240 
traffic, were in place of log / and log Q. This standardisation was calculated by 
subtracting the sample mean from each value in the sample and then dividing 
it by the sample standard déviation, The terms accounting for the interactions 
between speed limit S and link length or link traffic were transformed in a way 
sim'ilar to that used for centring second order terms in polynomial régression. 
Hence, thèse terms are given by 
S U 
= 
{Sk - 5)(log lk-\ôfl)- 
(Sk - 5)(log h - 
\5fl) 
= 
Sk\oglk-Jï^t^{Sk)\^l~{loglk)S-v2S^t 
and 
S T , 
= 
{Sk-S)(logQk-\dgQ) 
- {Sk - S){\ogQk - logQ) 
= 
& l o
g g
J
b - 5 T ^ - ( 5 0 K g Q - ( l o g Q
J
t ) 5 + 2 5 l 5 i Ô 
where the bar indicates the sample mean of the corresponding variable. This 
transformation helped to reduce the autocorrélation between successive sam-
pled values of the Markov chain. Otherwise the Gibbs sampling algorithm 
would stay for too many itérations in a small région of the sample space, and 
it would be necessary to simulate a much larger number of values than usual 
in order to cover the whole sample space. 

CHAPTER 
9. MULTIPLE 
RESPONSE MODELS FOR ROAD ACCIDENT 
DATA 241 
9.2.1 
A Poisson-régression model with gamma random 
effects 
The model given below in (9.1) will be called (P-ga) and it is a particular 
case of the Poisson-régression model with gamma random effects dehned in 
Section 8.3. The explanatory variables are spécifie to the set of data analysed 
in this chapter. For ail sites k = 1 , 2 , . . . , 156 and accident groups i = 1,2,3,4 
Yki | Afcl- 
~ 
Pois(A f c l), 
(9-1) 
where 
Log(AjfeO 
= 
log^fcO + A i + fal*k + faQl -rfaSk + 
faSU 
+ 
faSTk, 
and 
fiki\oti 
'~ 
gamma(ûj,ai), 
- 
N(0.0,0.0001), 
cti 
~ 
gamma(3,1). 
The précision parameter for the régression coefficients is very small so 
the normal prior distribution is vague (quite 
flat). 
In practical terms this 
means that we do not have any information about what the actual values of 
régression coefficients might be. 
In other words, the régression coefficients 
rnay take almost any real value. The gamma(3,1) prior for the a parameters 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 242 
is motivated by approximating the logarithm of a gamma random variable 
with a normal variable. This particular choice of the parameters is explained 
later in conjunction with a mixed Poisson-log normal model. 
The directed graphical model associated with this particular model is pre-
sented in Figure 9.2. The two plates correspond to the two différent indices. 
k for sites and i for accident type. For this model, the results were calculated 
Figurę 9-2: Directed graphical model for the hierarchical Baycsian model with 
gamma random effects 
from. a sample of 10000 values of a single long chain, with a burn-in period 
of 45000 iterations, and from a mixed sample of 10000 of two parallel chains, 
aft er a burn-in period of 10000 iterations. The Gelman-Rubin monitoring sta-
tistic was very good, less than 1.05 for all parameters of interest, and also the 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 
243 
dynamic plots showed that the chain had attained convergence. 
The Bayesian P values for the x2 
discrepancy, équation (8.18) in Sec­
tion S.2.6, for each type of accident, are 0.72 for KSI accidents with one vehi-
cle, 0.62 for KSI with two or more vehicles, 0.51 for S with one vehicle, 0.53 
for S with two or more vehicles. Thèse values shows that the data does not 
contradict the model so the inferences are reliable. The hyper-parameters (c^) 
Table 9.2: Posterior means of régression 
coefficients for mixed 
Poisson-gamma 
model 
Response 
1 
/* 
Q* 
S 
SL 
ST 
Yi 
0 n 
014 
016 
0.55 
1.20 
0.60 
-0.29 
0.04 
-0.38 
Y2 
022 
023 
024 
025 
026 
0.85 
1.49 
0.72 
-0.29 
0.09 
-0.01 
Y* 
032 
033 
034 
035 
036 
1.09 
1.28 
0.57 
-0.16 
-0.10 
-0.26 
VA 
A i 
042 
043 
044 
045 
046 
2.00 
1.29 
0.69 
-0.35 
-0.00 
-0.08 
can be estimated by the following posterior means «7 = 4.5, cv^ = 6-0, 
= 
3.5,04 = 3.0. This shows that the random effects for différent types of acci­
dent have différent gamma distributions. The parameters a are the précision 
of the random effects fi. The différence in values of a by différent accident 
types may be due to différent missing information for each type of accident. 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 
244 
The largest précision. ÔT^ = 6.0 is for killed or seriousty injured accidents with 
two or more vehicles involved and the lowest précision 
is for slightly injured 
accidents with two or more vehicles. This means that for the latter type the 
corresponding random effects ¡14 are more volatile so there is more missing 
information. 
The posterior means of the régression coefficients are shown in Table 9.2, 
other quantiles are described in Appendix G extracted from Tunaru (1999). 
The four régression équations are 
log(A A 1) 
= 
l o g ( ^ i ) + 0 . 5 5 + 1.2ÛZÏ + Û . 6 0 0 î - 0 . 2 9 5 f c + 0.04SLjfc 
-0.38ST* 
log(A f c 2) 
= 
log(ju M) + 0.85 + 1.49/î + 0.72QÎ-0.295fc + 0.09SL f c 
- 0 . 0 l S T f c 
log(A f c 3) 
= 
log(/ijb3) + 1-09 + 1 . 2 8 ^ + 0 . 5 7 Ç Î - 0 . 1 5 5 * - O . l O S L f c 
-0.26ST* 
log(A f c 4) 
= 
log(^ f c 4) + 2.00 + 1.29i; + 0.69<3;-0.355jfc- 0.005SLfc 
-û.08ST f c 
Thèse estimated équations point to some interesting conclusions. 
• The interaction SL between speed limit and link length is almost null 
or very weak for ail 4 régression équations. 
This can be easily seen 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS FOR ROAD ACCIDENT 
DATA 
245 
looking at the posterior median. 2.5% and 97.5% percentiles given in 
Appendix G . A l l credible intervals overlaps zero. This means that the 
difference in number of accidents between a rural road of 10 km and an 
urban road of 10 km is the same between a rural road of 5 km and an 
urban road of 5 km. 
• There is a non-negligible interaction between speed limit and link traffic 
only for the regression equations corresponding to single vehicle acci­
dents. This means that, for accidents with only one vehicle, reducing 
the traffic flow by a factor equal to S, that is from Q to 5Q, and keeping 
all the other covariates the same, will result in a reduction of the number 
of accidents depending on 6 and the speed limit 5". It is shown bellow 
that the percentage in accident reduction is (1 — ^j 0- 8 8- 0- 3 3 5) for fatal or 
serious accidents with one vehicle and (1 — £°- 9 6-°- 2 6 5) f o r slight accidents 
with one vehicle. There would be no speed limit S in these formulae if 
there were no interactions between speed limit and link traffic. 
• For slight accidents the speed limit effect for accidents with two or more 
cars is more than double in absolute value the speed limit effect for ac­
cidents with only one vehicle involved. A possible explanation might be 
that, for this category of accidents, the interaction between speed limit 
and the other two variables, link length and traffic flow, is very weak, 
whereas for slight accidents with only one vehicle, there is considerable 
interaction between speed limit and the other variables. 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FORRO 
AD ACCIDENT 
DATA 246 
• Speed limit has a négative effect in the linear régression équation given 
above for ail four types of accidents and the effects seem to be the same 
for fatal or serious accidents with one vehicle and with two or more ve-
hicles. respectively. However. because of the définition of the interaction 
terms, the effect of speed limit on the number of accidents can be better 
understood from the multiphcative équations (9.3)—(9.6). 
The log-linear regresión équations can be re-expressed in multiplicative 
form as 
A„ = /.„ exP(/3- + ^ S
k ) l f ^
S
t
) Q f ^ ' '
S
t
) . 
(9.2) 
The new coefficients marked with a star can be recalculated from the initial 
pki- The coefficient {3^ can be included in the constant factor but the above 
form was preferred for symmetry. For (P-ga) model, the régression équations 
can be rewritten as 
AH 
= 
exp(-0.50 + 0 . 0 9 5 t ) / r 9 + 0 ' O 4 5 ' ) g i 0 ' 8 8 - o ' 3 8 S ' t ) 
(9.3) 
h2 
= 
^ e x p i - O ^ e - O . S l S , ) / !
1 '
0
9 ^
0 ^ ^ !
0 -
9
6 -
0
0
1 ^ 
(9.4) 
A « 
= 
^ e x p i O . l S + O . l l S , . ) / ' 0 9 8 " 0 1 0 5 ' ' ^ 0 - 8 1 " 0 - 2 6 5 0 
(9.5) 
A u 
= 
MHex P(0.94 - 0 . 2 7 S t ) / ( a 9 6 - 0 0 0 5 S " ) Q < O £ M - 0 O 8 S ' » 
(9.6) 
where the posterior distribution of random effects can be inferred as 
l¿ki ~ gamma(4.5,4.5). 
f.Lk2 
~ 
gamma(6,6) 
(Xh3 ~ gamma(3.5,3.5). 
/ i *
4 ~ gamma(3,3). 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 247 
The multiplicative equations have different forms, implying that a single 
response model rather than a multiple response model would lead to unreliable 
conclusions. For example, a single response model using a single regression 
equation would have only one value for the regression coefficient corresponding 
to the speed limit or to the interaction between speed limit and link length. 
It can be easily seen from equations (9.3)—(9.6) that there is a lot of variation 
across the four types of accidents for this coefficients. A single value cannot 
synthesize the whole picture. 
The regression equations developed as a major part of the hierarchical 
Bayesian models proposed can be used by practitioners to understand the 
behaviour of the mean number of accidents given the explanatory variables. 
They can also be used to predict how the mean number of accidents at a given 
site would change if some or all the explanatory variables were changed in 
some way, and to predict future accident rates given that the conditions are 
unchanged. If the local authority were to build a bypass around one of the 
villages on the road network (and they have since 1991) they would want to 
predict the effect on accidents. Most of the traffic that used to travel through 
the village would use the bypass and the only traffic using the old road would 
be traffic travelling to the village. The cost savings in accidents can then 
be calculated. The novelty of this approach is that predictions can be made 
simultaneously about the changes in accident type as well as the frequency. It 
is worth pointing out that many T R L studies investigated, at the univariate 
level, the relationships between traffic flows and various types of accident such 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 248 
as lorries, trucks, bikes, accidents classified by manoeuvre and so on. The work 
presented here is multivariate, looking at several correlated types of accident 
at the same time. 
We can see what happens when the traffic flow Q is changed to 8Q. where 
6 > 0. Momentarily we will drop the site index k. For all accident types, 
from equations (9.3)—(9.6), it can be easily shown that there is a reduction in 
the mean number of accidents A if and only if 8 < 1, that is if the traffic is 
reduced. The reduction in the number of accidents can be calculated as 
This formula is applied for each type of accident based on the multiplicative 
equations (9.3)—(9.6) and the calculations can be finalised by specifying the 
speed limit variable, urban S = —1 and rural 5 = 1 . 
For fatal or serious accidents with 1 vehicle 
A; 
x 100% = 
1 - 
T M x 100%. 
For fatal or serious accidents with 2-f- vehicles 
) x 100%. 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS FOR ROAD ACCIDENT 
DATA 249 
For slight accidents with 1 vehicle 
1 - &\ x 100% = 
(1-6 O.S 1-0.265 ) X 100%. 
For slight accidents with 2+ vehicles 
1 " v ) X 1 0 ° % = ( 1 " 8 
0.94-0.0SS ) x 100%. 
The final results are presented in Table 9.3. 
Table 9.3: Proportional 
réductions 
in accidents when traffic flow is reduced, as 
resulted from the Poisson-régression 
m.odel with gamma random ejfects 
Severity 
No of vehicles 
Speed limit 
Réduction 
fatal or serious 
slight 
1 
urban 
( 1 - ¿1.26) 
rural 
( 1 - - 
S0-5) 
2-f 
urban 
( 1 - ¿0.97) 
rural 
( 1 - ¿0.95) 
1 
urban 
( 1 - ¿1.07) 
rural 
( 1 - ¿0.55) 
2+ 
urban 
( 1 - ¿1.02) 
rural 
( 1 - ¿0.86) 
The conclusion of this analysis is that reducing the traffic flow by a factor 
of S will reduce différent type of accidents in différent ways. In a similar way 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 
250 
the percentage increase in accidents can be calculated if the traffic is increased 
by a multiplicative factor 6. 
9.2.2 
Comparison with a simpler scénario 
One may wonder why a multiple response approach would give better results 
than fitting separate Poisson-régression models for accident counts of each 
type. Therefore in this section the following model vvill be investigated 
YkilXki 
- 
Pois(A,0 
(9.7) 
Pi, 
~ 
N(0.0,0.0001) 
and the results will be compared with those given by the (P-ga) model. Fol­
lowing the usual M C M C modelling steps, two chains were simulated in parallel 
and after a burn-in period of 15000 itérations a sample of 10000 values was 
retained for inference. The régression coefficients were estimated by their pos-
terior means given in Table 9.4. 
Comparing Table 9.2 with Table 9.4, the 
only major différences are between the coefficients of the interaction terms 
between traffic flow and speed lim.it. If this model was proposed for inference 
the following multiplicative prédictive équations would be used 
A t l 
= 
exp(-0.50 + 0 . 2 5 5 f c ) 4 0 - 8 7 + 0 ' 0 1 S ' ) Q r S " ° " , 8 5 f c ) 
(9-8) 

CHAPTER 
9, MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 251 
Table 9-4: Posterior raeans of régression 
coefficients for 
Poisson-régression 
•model 
Response 
1 
Q* 
S 
SL 
ST 
Yi 
A i 
012 
A s 
A4 
A s 
016 
0.56 
1.17 
0.58 
-0.24 0.01 -0.48 
Y2 
A i 
A
2 
A s 
A4 
A s 
026 
0.91 
1.37 
0.71 
-0.21 
0.09 
-0.13 
Yz 
A i 
A2 
A s 
A4 
A s 
036 
1.12 
1.20 
0.59 
-0.07 -0.12 -0.46 
Y4 
A i 
A2 
A 3 
A4 
A s 
046 
2.00 
1.28 
0.74 
-0.30 0.01 -0.24 
\ k 2 
= 
e X p ( - 0 . 1 9 - 0 . 0 9 5 t ) 4 L O O + 0 ' 0 9 5 t ) Q i 0 - 9 7 - o a 3 S * » 
(9.9) 
A
W 
= 
exp(0.04 + 0 . 4 l 5 ' , ) 4 O ' 9 2 ' O ' l 2 S O Q i O 8 8 " a 4 6 S ' ' ) 
(9.10) 
A i 4 
= 
exp(0.79 - 0 . 0 5 S t ) ; l ° ' 9 6 + o ' o l 5 t ) ( 3 i 1 ' o ^ o ' 2 4 S y 
(9.11) 
Comparing thèse équation with équations (9.3)—(96) it is easy to see that the 
values for traffic flow are différent, and this will change prédictions in model. 
The percentages of réduction in accidents when the traffic flow Q is re-
duced by a factor of 6 are différent from before as can be seen from Table 9.5. 
The simple Poisson-régression model overestimates the réductions in accidents 
resulting from reducing the traffic for ail urban areas, that is it gives higher 
réduction percentages for S = —1, and underestimates the réductions in acci-

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 252 
Table 9.5: Reductions in accident percentages when traffic flow is reduced, as 
resulted from the Poisson-regression 
model without random effects 
Severity 
No of vehicles 
Speed limit 
Reduction 
fatal or serious 
slight 
1 
urban 
( 1 - ¿1.36) 
rural 
( 1 - - S°A) 
2+ 
urban 
( 1 -
¿1.10) 
rural 
( 1 -
¿0.84) 
1 
urban 
( 1 -
¿1.34) 
rural 
( 1 -
¿0.38) 
2+ 
urban 
( 1 -
¿1.28) 
rural 
( 1 -
¿0.80) 
dents in rural areas, that is it gives smaller percentages for 5 = 1. 
In conclusion fitting accident counts of different type at an univariate level 
would result in different inferential results. In a Bayesian framework, it can be 
easily seen that this simpler model is rejected by the data since the Bayesian 
P-values for x2 for each type of accident are respectively 0.013, 0.005, 0,000 
and 0.000. These values are calculated as described in Section S.2.6 by for­
mula (8.17) for the test statistic given by formula (8.18). The model is rejected 
by the data if the Bayesian F-values are too small. It can be easily seen that, 
for the first type of accident, it is just accepted at 0.01 level but for all the 
other three the rejection is clear. 
Thus, the model without random effects 
cannot model the data well and therefore the inclusion of random effects seem 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 
253 
to be necessary. This is not surprising since only three explanatory variables 
are used as covariate information. The role of the random effects is to account 
for missing explanatory variables. 
This emphasizes that even after ensuring that the Markov chain has con­
verged and parameters are reliably estimated it is necessary to check the 
goodness-of-fit 
of the model before applying the results. 
Hence the joint-
response model is superior to four separate univariate response models. 
9.2.3 
A Poisson-regression model with log normal ran-
dom effects 
The logarithm of a gamma distributed random variable is approximately nor­
mal so it is worth considering a model where the random effect is normally 
distributed. This assumption can be exploited to simplify computation since 
all the parameters describing the regression equations are normally distrib­
uted. 
This model is also specified hierarchically in 3 stages and it will be 
called (P-logN). For all sites k = 1,2,.. .,156 and i = 1,2,3,4 
Yki I hi 
~ 
Pois(AjtO, 
(9T2) 
where 
log(AfcO 
= 
^ + 
ft1+A2^ 
+ A
3 ^ + 
fe^ 
+ A5SU + A- 6ST A 
and 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 2 5 4 
h\r 
Ä 
N ( 0 . 0 , T ) , 
ßij 
~ 
N(0.0,0.0001), 
r 
~ 
garnma(3,1). 
For the precision distribution r a prior gamma(3,l) was used. The reason 
Figure 9.3: Directed graphical model for the hierarchical Bayesian model with 
log normal random effects 
for choosing a gamma(3,1) prior is based on an idea described in Smith, 
Spiegelhalter and Thomas (1995). The model just described might support 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 255 
the assumption that 95% of the sites having identical covariates 
X'kl = 
(\.Jt,Qt,Sk,SU.STk), 
will hâve a log(A) between —1.%/y/r and 1.%/y/r. 
Assuming (from a sub­
jective point of view) that sites with the same covariates have expectations 
varying within one order of magnitude log 10 = 2.3 but not over two orders of 
magnitude log 100 = 4.6, the équation 
2 x 1.96A/f 2.3 
implies that r ?a 2.9 is a good approximation for E ( r ) . In addition, an ap­
proximation of a low value for r is obtained. from 
2 x 1.96/>/f ~ 4.6 
and this lower limit equals 0.73. With tbe prior distribution gamma(3,1), 
r has the mean 3 and Pr(r > 0.73) — 0.96 which shows that this gamma 
distribution is appropriate for our subjective assumption. 
The joint distribution of the observed and unobserved quantifies, data 
and parameters, factorises in a similar way to the previous model. Although 
the graphical model in Figure 9.3, representing the conditional distributions 
assumed by the model, is very similar to that describing the model (P-ga) in 
Figure 9.2, it should be noted that différent parametric distributions are used 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS FOR ROAD ACCIDENT 
DATA 256 
Table 9.6: Posterior 
means for mixed Poisson-log 
normal régression 
coeffi­
cients 
Response 
1 
Q* 
S 
SL 
ST 
Yi 
011 
0.41 
pii 
1.25 
013 
0.60 
01.4 
-0-29 
015 
0.05 
016 
-0.34 
Y2 
Pn 
0.73 
022 
1.49 
023 
0.75 
024 
-0.29 
025 
0.12 
026 
0.04 
031 
0.97 
032 
1.28 
033 
0.59 
034 
-0-13 
035 
-0.10 
036 
-0.29 
Y4 
041 
1.82 
042 
1.39 
043 
0.78 
044 
-0.38 
045 
0.04 
. 046 
-0.06 
for corresponding nodes of the graph, and différent logical expressions for the 
means lambda[k,i]. Furthermore, the précision parameter tau for the normal 
random effects b[k], does not dépend on the accident type or the site. 
Two parallel chains were simulated and after a burn-in period of 15000 it­
érations a sample of 10000 itérations was selected for inference. The Gelman-
Rubin statistics were very good for ail parameters of interest and the Bayesian 
P-values for the four types of accidents were 0.58 for KSI with 1 vehicle. 0.53 
for KSI with 2+ vehicles, 0.07 for S with 1 vehicle and 0.04 for S with 2+ vehi-
cles. The fit of this model seems to be good. for the first two accident types and 
not very good for the last two types. The variance of the random effects can be 
estimated by its posterior mean 0.50. The results obtained for this model are 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 
257 
shown in Table 9.6. They are very similar to those obtained using a gamma 
random efFect. However, the observed ranges of the standardised logarithmic 
link length l'k and the standardised logarithmic estimated traffic flow Q*k are 
between -2.7 and 1.6, which is quite narrow. Therefore, small différences in the 
estimated values of régression coefficients may resuit in substantial différences 
in the fit of the two models. This problem will be investigated further in the 
next subsection. 
Model comparison 
A simple way to check the fit of a model is to compare the posterior predicted 
mean given by the model with the data values. A close linear relationship 
would suggest a close fit. This can be done in parallel for the two models 
(P-ga) and (P-logN). First, the observed pooled number of accidents at each 
site is plotted against the sum of the predicted means of accidents at the same 
site. It seems that model (P-logN) perforais slightly better. 
A better insight is plotting each type of accident separately and this is 
done in Appendix C. There, the model (P-ga) seems to fit the data well for 
ail four types, and for each type better than the (P-logN) model. This can 
be expected since it was shown in Chapter 8 that the log normal distribution 
will not perform very well with the extreme observed values. 
In addition, 
the random effects dépend only on site so they can account only for missing 
information about the site and not about the accident class. In summary, both 
models fit the data well at an aggregated level, the second model appreciably 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 
258 
-ICO, 
, 
, 
1 
-tcoj 
, 
. 
-ICO 
0 
ICO 
£ 0 
-100 
0 
100 
ID 
YÎUT/L 
YIŒûL 
Figure 
9.4: 
Scatter plots of totals 
Figure 9.5: 
Scatter plots of totals 
for model (P-ga) 
for model (P-logN) 
better. 
But at a disaggregated level, clearly the first model fits the data 
better than the second one. The aim of this analysis was to extract statistical 
information at a disaggregated level so it is vital to have a good fit for each type 
of accident. The difference in the form of random effects and the distribution 
used is important. 
9.2.4 
Poisson-regression model with multivariate nor-
mal random effects 
The (P-ga) and (P-logN) models studied above provide a good start for the 
statistical modelling process but there is no correlation structure assumed for 
the random effects p and as a consequence these two models may overlook 
an important aspect of the real data. 
The next model, that will be called 

CHARTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 
259 
(P-MNre). tries to overcome this difficult probiem as well. It can be viewed as 
an extension of the two previously studied models, the only différence being 
in the distributional assumption for the random effects p. 
For ail sites fc = 1 . 2 , . . . , 156 and accident groups i = 1,2,3,4 
Yki\Xki 
~ 
Pois(A w), 
(9.13) 
w here 
log(Ajbi) 
- 
/i f e l- + fti + ft2/i; + /?aÖfc + Ä45jfc + ft5SLfc + 
ft6STfc, 
and 
(Mfci)i-t 
4 | T 
™d 
N 4 ( 0 , T ) , 
ßü 
~ 
N(0.0,0.0001), 
T 
~ 
Wishart(Ä,4). 
The covariance structure of the random effects is given by the 
covariance 
mat rix S = X
-
1 , so the parameterisation is again based on the inverse of the 
variance-covariance matrix. For computational simplicity, a Wishart hyper-
prior distribution is required for the matrix T and the matrix [R)~x 
accounts 
for our prior beliefs about the précisions between random effects ß of différent 
types of accidents; the second parameter of the Wishart distribution is chosen 
to be as small as possible (in this case 4) to reflect our ignorance about 
T. 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
EOR ROAD ACCIDENT 
DATA 260 
For this model the inference process is based again on M C M C methods but 
the Markov chain has to be generated using the Metropolis-Hastings algorithm 
(see Gelman et al. (1995)), because the Gibbs sampler does not work in this 
case. W i n B U G S has both methods implemented so the models can be fitted 
using the same software platform. To improve speed, an initial run can be 
made using some arbitrary values for i?, and then the posterior means of the 
elements of £
_
l = T are used for the R values. 
The posterior distribution for the model (P-MNre), with multivariate nor­
mal random effects, gave the posterior means for the regression coefficients 
in Table 9.7. A burn-in period of 30000 iterations was used before a sample 
of 10000 was taken as representative for the posterior distribution of all pa­
rameters of the model. Very similar results were obtained when two parallel 
chains were simulated. After a burn-in period of 15000 iterations a sample 
of 10000 iterations was taken. The Gelman-Rubin convergence statistics were 
all less than 1.05 for all parameters of interest /3,T, £ and also, the Bayesian 
P-values indicated a good fit of this model. The values were 0.87, 0.80, 0.65 
and 0.65 for the four types of accident in order, showing a good fit to the 
data. 
Apart from the intercept terms 0n, there are no major differences in 
the signs and absolute values of the regression coefficients as compared with 
the Poisson model with gamma random effects, (P-ga). The matrix given in 
(9.14) contains the posterior means of the elements of X , the inverse of the 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 
261 
Table 9.7: Posterior means of regression coefficients for the 
Poisson-regression 
model with multivariate 
normal random effects 
Response 
1 
I* 
Q* 
S 
SL 
ST 
011 
012 
013 
014 
0r 5 
016 
-0.65 
1.27 
0.63 
-0.30 
0.04 
-0.34 
Y2 
021 
022 
023 
024 
025 
026 
-0.31 
1.55 
0.78 
-0.31 
0.11 
0.00 
Y3 
031 
032 
033 
034 
035 
036 
-0.14 
1.35 
0.60 
-0.16 
-0.08 
-0.25 
041 
042 
043 
044 
045 
046 
0.73 
1.36 
0.77 
-0.34 
0.00 
-0.06 
covariance matrix. 
T = 
( 
\ 
4.65 
-1.75 
-1.5 
-0.1 
-1.75 
6.12 
-0.86 
-1.35 
-1.5 
-0.S6 
3.25 
-0.5 
-0.1 
-1.35 
-0.5 
2.3 
\ 
(9.14) 
Eléments close to zéro in the inverse covariance matrix T indicate that the 
corresponding random effects a are conditionally independent given the val­
ues of the random effects not in the pair. For instance, T u = —0.1 indicates 
conditional independence between the random effects for fatal or serious ac­
cidents with only one vehicle and slight accidents with two or more vehicles, 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD 
ACCIDENT 
DATA 262 
which is not surprising. What is surprising is the weak association 
between 
slight accidents with one vehicle and slight accidents with two or more vehicles. 
T34 = -0.5. 
9.3 
Multivariate Poisson-log normal model 
In the previous chapter, the mixture of a Poisson distribution with a multivari­
ate log normal distribution was described, equation (8.35), as a discrete mul­
tivariate distribution for modelling multiple counts. Starting from this mul­
tivariate Poisson-log normal distribution a hierarchical, fully Bayesian model, 
that will be called (P-MN1), is proposed. 
YKT\XKT 
W 
Pois(A f c l-) 
(9.15) 
(log(Afc»))t=i 
A\^T 
S 
N 4(/*,T) 
Hi 
~ 
N(0,0.0001) 
T 
~ 
Wishart(i?. ;4) 
where the parameterisations are the same as used for the previous models. A 
variant of this model, (P-MN2), would be to add another level to the hierarchy: 
Pi 
~ 
N(l/.7„) 
v ~ 
N(0,0.001) 
ra 
~ 
gamma(0.001,0.001) 
(9.16) 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 263 
and keeping everything else the same. 
This allows a comparison between 
two nested models. The matrix parameter R for the Wishart distribution is 
proposed by analogy with model (P-MNre). 
The graphical model associated with model ( P - M N l ) is illustrated in Fig­
ure 8.6. The conditional independence structure is remarkably simple. The 
graphical model for model (P-MN2) would have an extra two vertices for u 
and ra as parents of the vertex ft{. 
The same strategy for simulation was used as for the model (P-ga). Thus 
the inference results were based on either a sample of 10000 values, taken from 
a single chain after a burn-in period of 45000 iterations, or on a mixed sample 
of 10000 taken from two parallel chains, after a burn-in of 20000 iterations. 
The Gelman-Rubin convergence statistics, equation (8.15) in Section 8.2.3, 
were very good, with values less than 1.1 for all parameters of interest. 
The Bayesian P values for the x2 discrepancy, equation (8.18), for each 
type of accident, are 0.87 for KSI accidents with one vehicle, 0.77 for K S I 
accidents with two or more, 0.71 for S accidents with one vehicle and 0.62 
for S accidents with two or more vehicles. These values are a bit larger than 
the corresponding Bayesian P-values for model (P-ga), but they are still good 
and shows that the data does not contradict the model so the inferences are 
reliable. 
The posterior estimates of the parameters of interest for the multivariate 
Poisson-log normal model ( P - M N l ) is given in Table 9.8. The covariance 
matrix £ = T
-
1 is provided because it makes a straightforward link with 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 264 
possible covariance structure of the observed data. 
Table 9.8: Posterior estimation of parameters of multivariate Poisson-log nor­
mal model 
parameter 
mean 
scl 
2.5% 
97.5% 
o n 
2.15 
0.41 
1.46 
3.09 
012 
2.34 
0.41 
1.65 
3.29 
0"l3 
2.10 
0.39 
1.48 
3.00 
014 
2.25 
0.38 
1.62 
3.11 
021 
2.34 
0.41 
1.66 
3.29 
0~22 
3.04 
0.54 
2.16 
4.27 
023 
2.48 
0.45 
1.78 
3.54 
0"24 
2.78 
0.45 
2.04 
3.79 
031 
2.10 
0.39 
1.48 
3.00 
032 
2.4S 
0.45 
1.78 
3.54 
033 
2.49 
0.47 
1.75 
3.61. 
034 
2.39 
0.41 
1.73 
3.32 
(74i 
2.25 
0.38 
1.62 
3.11 
0~42 
2.78 
0.45 
2.04 
3.79 
0~43 
2.39 
0.40 
.1.73 
3.32 
0-44 
3.04 
0.47 
2.25 
4.09 
^1 
0.28 
0.15 
-0.034 
0.56 
0.67 
0.16 
0.34 
0.97 
0.79 
0.16 
0.46 
1.08 
P4 
1.65 
0.15 
1.35 
1.94 
The matrix given in (9.17) contains the posterior means of the elements of 
X , the inverse covariance matrix. 
T = 
( 
\ 
4.42 
-1.55 
-1.65 
-0.55 
-1.55 
3.76 
-0.99 
-1.52 
-1.65 
- 0 . ! 
3.18 
-0.36 
-0.55 
-1.52 
-0.36 
2.44 
(9.17) 
There are weak partial corrélations between KSI accidents with 1 vehicle and 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 
265 
slight accidents with 2+ vehicles, between KSI accidents with 2+ vehicles and 
slight accidents with 1 vehicle and between slight accidents with I vehicle and 
slight accidents with 2+ vehicles. 
Having so many models under study, some of them nested, some of them not, 
it would be helpful to check the fit of the models and identify the best ones 
for further analysis. In a Bayesian context, this can be done uslng the poste-
rior distribution of the log-likelihood, as suggested by Dempster, but because 
extremely complex models should be penalised for using a large number of 
parameters, the déviance information criterion, D I C , offers a better solution. 
For comparison, several simpler nested and non-nested models are inves-
tigated. The previously discussed models were denoted by (P-ga), (P-logN), 
(P-MNre), (P-MN1) and (P-MN2). The following models are considered as 
well 
(P-difreg): A Poisson-régression model without random effects but différent 
régression coefficients for différent accident types 
9.4 
Model sélection using DIC 
Yki | A fo­
in d 
Pois(A f c z) 
(9.18) 
Pij 
iid 
N(0.0,0.0001) 
(P-ureg): A Poisson-régression model with random effects and with the same 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROA D ACCIDENT 
DATA 
266 
régression coefficients for ail types of accidents 
Yki\Xki 
- 
Pois(A H) 
(9.19) 
log(A f c i) 
= 
hg(tiki) + Pi + falî + P3Ql + P4Sk + psSLk 
+ 0eSTk 
a*; | oti 
*~ 
g a m m a ( û i , Q i ) 
P3 
~ 
N(0.0,0.0001) 
cti 
^ 
gamma(3, l) 
(P-classic): A Poisson-régression model with identical régression coefficients 
for ail types of accidents and without random effects 
Ykl\Xki 
^ d 
Pois(Afo) 
(9.20) 
log(A, t) 
= 
ft 
+ ft/I + A O Î + A f t + ftSLjt + 
ftSTjt 
p3 
- 
N(0.0,0.0001) 
(P-logN2): The same Poisson-log normal régression model as before but with 
différent hyper-prior parameters, gamma(0.001, 0.001) 
Yki I A*, 
Pois(A f c l) 
(9.21) 
log(A f c i) 
= 
6, + fti + pi2lt + P*QÎ + piASk + ftsSLfc + 
ft6STfc 
6fc | r 
~ 
N(0.0,r) 
Pu 
~ 
N(0.0,0.0001) 
r 
~ 
gamma(0.00l, 0.001) 

CIIA PTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 
267 
(P-add): A n additive random effects model; there is no covariate information 
and the effects are split into terms accounting for site variation and terms 
trying to explain site by accident type variation 
YKT \ X K I 
Pois(A f c l) 
(9.22) 
bk\r 
Ä 
N(0.0,r) 
pki\cxi *~ 
gamma( a*,at-) 
ai 
~ 
gamma(3,1) 
T 
~ 
gamma(3,1) 
(P-add2): The same additive model as before with différent hyper-prior para-
meters, gamma(0.001,0.001). 
YK I X
K
I 
Pois(A f c l) 
(9.23) 
log(Ajtt) 
= 
6 f c - f l o g ^ 
bk\r 
~ 
N(0.0,r) 
fiki\a{ 
l~ 
gamma(Qt, a*) 
ax 
~ 
gamma(0.001,0.001) 
r 
- 
gamma(0.001,0.001) 
In the table 9.9, DIC is calculated for ail models using the method described 
in Section 8.2.5. If the analysis had been based only on the posterior mean of 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 26S 
Table 9.9: Déviance 
Information 
Criterion 
calculations 
M O D E L 
random 
with 
différent 
D 
D{&) 
PD 
DIC 
effects 
régression 
8 
(P-ga) 
V 
427.50 
255.30 
172.20 
599.70 
(P-difreg) 
v 
y/ 
1180.40 
579.35 
601.05 
1781.45 
(P-ureg) 
427.10 
68.52 
35S.58 
785.68 
(P-classic) 
2621.80 
1308.27 
1313.53 
3935.33 
(P-MNre) 
V 
383.32 
127.42 
255.90 
639.22 
(P-logN) 
V 
530.40 
212.44 
317.96 
848.36 
(P-logN2) 
V 
V 
530.50 
213.35 
317.15 
847.65 
(P-add) 
V 
409.79 
60.66 
349.13 
758.92 
(P-add2) 
y 
412.62 
60.7S 
351.84 
764.46 
( P - M N l ) 
389.38 
119.40 
269.98 
659.36 
(P-MN2) 
389.65 
60.00 
329.65 
719.30 
the Bayesian déviance, D, then the models (P-MNre), ( P - M N l ) and (P-MN2) 
would have been preferred. Taking into account the complexity of the models 
using DIC as a yardstick, the model (P-ga) is preferred followed closely by 
models (P-MNre) and ( P - M N l ) . 
In making this comparison, several points are worth noting. 
First the 
simplest model (P-classic) has a very large DIC = 3935.33. Therefore the 
improvement due to including random effects or allowing the régression coeffi­
cients to dépend on accident type can be gauged relative to this basic model. 
Just adding the random effects /*, as in the model (P-ureg), results in a ré­
duction of 3149.65 in DIC. Secondly, nested models like some pairs in the first 
fîve or the last two models in the table can be compared in terms of DIC. For 
example, the model (P-MN2) and its submodel ( P - M N l ) per form equally well 
in terms of the posterior mean of the déviance, but when we take into account 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 
269 
the number of parameters the DIC clearly indicates that the model ( P - M N l ) 
is better. Thirdly, the models retained, (P-ga), (P-MNre) and ( P - M N l ) , are 
very flexible and reveal various aspects of the data analysed. 
Notice that 
model ( P - M N l ) does not use any regression structure, although to do that is 
quite easy linking the mean of the multivariate log normal distribution with 
explanatory variables. 
9.5 
Ranking the sites 
Identifying hazardous sites is the first important step for developing road en­
gineering measures. This problem is vital since designing and implementing 
remedial measures is based on the characteristics and factors related to those 
sites. Moreover, engineering treatment is applied only to sites selected. Large 
amounts of money can be wasted just because the right sites have not been 
identified as dangerous. 
Several approaches proposing some solutions were 
discussed in Chapter 2. A l l previous work was developed for univariate re­
sponse models, nothing apparently having been done for multiple responses. 
This section investigates ranking the 156 sites from Kent, with four types of 
accidents. 
The three hierarchical multiple response models that have been selected 
by the DIC criterion, that is (P-ga), (P-MNre) and ( P - M N l ) , will be used. 
Therefore, for each measure, the ranking calculations are made for three mod­
els by four types of accident. Under a restricted budget, the analysis proposed 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 270 
here (using several criteria of ranking) would help the practitioners to select 
the hazardous locations, vvhere "hazardous" has many facets. Modelling mul­
tiple counts jointly makes ranking just a bit more difficult but more rewarding 
in the same time. A practitioner may compare the sites according to différent 
point of views and hidden aspects might corne to the surface in this way. 
9.5.1 
Ranking by the probability that a site is the worst 
The posterior probability that the site k is worse than ail the others by a factor 
of 
for the accident type 
is 
pki{v) = Pr(A f t i > v\ji 
for all j ^ k\y) 
where v > 0. For example, when v — 1 this is the probability that the site is 
the worst one. The factor v should be established prior to the analysis by the 
practitioner. The posterior probability that is usecl as a criterion for ranking 
represents a measure of how much worse one accident site is compared with 
ail the others. In practice arbitrarily selected v- values like v = 1,1.1,1.25 are 
used. The practitioner then can see différent lists and make an ad-hoc décision 
accordingly. The point to bear in mind is that the list of selected sites should 
not contain just a few sites or too many sites. The value v = 1 is always a 
good start and depending on the results obtained, the practitioner can modify 

CHARTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 271 
v accordingly. When v = 1 it is true that 
X>,-(i) = i 
k 
and this is convenient for checking that the calculations are correct. 
Table 9.10: Ranking probabilities for KSI accidents with î vehicle 
model (P-ga) 
model (P-MNre) 
model (P-MN1) 
Site No 
Pr 
Site No 
Pr 
Site No 
Pr 
11 
0.0023 
11 
0.0020 
12 
0.0070 
14 
0.0257 
14 
0.0048 
14 
0.0076 
23 
23 
0.0002 
38 
3S 
0.0012 
38 
0.0002 
41 
0.1427 
41 
0.1244 
41 
0.1332 
42 
0.0003 
42 
42 
0.0004 
46 
0.0330 
46 
0.0204 
46 
0.0280 
50 
0.0007 
68 
6S 
0.0004 
76 
0.0023 
76 
76 
0.0004 
77 
0.0046 
77 
0.0028 
77 
0.0058 
90 
0.7573 
90 
0.8132 
90 
0.7934 
91 
91 
0.0016 
91 
0.0004 
95 
95 
0.0048 
95 
0.0058 
118 
118 
0.0008 
143 
143 
0.0264 
143 
0.0218 
Only the sites with corresponding probabilities larger than 10"'' are pre-
sented in the tables sumrnarising the results. The tables contain the probabil­
ities for the same type of accident, given by ail three raodels for comparison. 
The sites with the largest probabilities need to be treated. If fatal or seriously 
injured accidents with only one vehicle involved are of particular interest, it 
is obvious from Table 9.10 that the worst site is number 90, urgent measures 

CHAPTER 
9. M ULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 272 
Table 9.11: Ranking probabilities for KSI accidents with 2~h vehicles 
mode! (P-ga) 
model (P-MNre) 
model ( P - M N l ) 
Site No 
Pr 
Site No 
Pr 
Site No 
Pr 
4 
4 
0.0004 
4 
0.0018 
11 
0.1200 
11 
0.1444 
11 
0.1252 
12 
0.2173 
12 
0.1900 
12 
0.1194 
14 
0.3630 
14 
0.3144 
14 
0.2732 
24 
0.0023 
24 
0.0004 
24 
0.0018 
41 
41 
0.0014 
46 
0.2061 
46 
0.2520 
46 
0.3228 
76 
0.0076 
76 
0.0060 
76 
0.0032 
77 
0.0007 
77 
77 
0.0002 
90 
90 
0.0004 
90 
0.0064 
98 
0.0596 
98 
0.0408 
98 
0.0348 
102 
0.0169 
102 
0.0040 
102 
0.0028 
118 
0.0062 
118 
0.0472 
118 
0.1070 
being required: also sites 41, 46, 14 and possîbly 143 should be investigated. 
Site 90 is the worst site for accidents with slight injuries as well, see Tables 9.12 
and 9.13. but, as can be seen from Table 9.11, it is not as bad regarding fa­
tal or seriously injured accidents with two or more vehicles. Therefore, the 
statistical analysis at the disaggregated level provides practitioners with more 
valuable information as what might be the problems at a spécifie site. 
Table 9.12: Ra^nking probabilities for slight accidents with 1 vehicle 
model (P-ga) 
model (P-MNre) 
model ( P - M N l ) 
Site No 
Pr 
Site No Pr 
Site No Pr 
14 
14 
0.0008 
14 
0.0008 
41 
0.0019 
41 
0.0004 
41 
0.0010 
46 
0.0062 
46 
0.0008 
46 
0.0036 
90 
0.9919 
90 
0.99S0 
90 
0.9946 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 273 
The results are qnite similar for ail three models. B y the measure studied 
in this section, it seems that there are not many dangerous sites for slight 
accidents with only one vehicle. One reason might be that site 90 is so bad 
that almost the whole probability is concentrated on this site, and there is 
not very much left to distinguish between the others. This site is particulary 
interesting. It is the urban link that runs along the sea front at the resort 
of Margate. 
Thus, there would be a high volume of holiday makers bot h 
pedestrian and drivers. The high pedestrian fiow distinguishes it from the 
other links and spécial safety measures need to be implemented. 
Table 9.13: Ranking probabilities for slight accidents with 2+ vehicles 
model (P-ga) 
model (P-MNre) 
model ( P - M N I ) 
Site No 
Pr 
Site No 
Pr 
Site No 
Pr 
11 
11 
0.0004 
12 
0.1200 
12 
0.0820 
12 
0.1054 
14 
0.0923 
14 
0.0512 
14 
0.0626 
24 
0.0185 
24 
0.0304 
24 
0.0220 
41 
0.2338 
41 
0.2368 
41 
0.2144 
46 
0.0035 
46 
0.0048 
46 
0.0036 
76 
0.0031 
76 
0.0028 
76 
0.0022 
77 
0.0007 
77 
0.0004 
90 
0.4869 
90 
0.5640 
90 
0.5688 
98 
0.0412 
98 
0.0276 
98 
0.0206 
9.5.2 
Ranking by posterior distributions of ranks 
The second criterion for ranking sites investigated here is based on the ranks 
of the mean parameters X^i which are the site spécifie parameters. The 
ranking process is made again for each type of accident i. The posterior means 

CHAPTER 
9. M ULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 
274 
E(Afei | y) are optimal estimâtes vvhen the aim is to produce iriference about 
Afc,. However, if the ranks of A*,- are of interest, the conditional expected ranks 
(or a discretized version of them when they are not integers) are optimal. It is 
known that ranking the observed data or even the posterior means can perform 
poorly (Laird and Louis, 1989; Morris and Christiansen, 1996). Consequently, 
this ranking method is developed using the posterior distribution of the ranks, 
that is p(r \ y), and not the posterior distribution p(A | y). This differs than 
the approach proposed by Schlüter et al. (1997). 
Ranks are notoriously uncertain and it is useful to know the uncertainty 
associated with them. The approach followed here easily calculâtes the corre-
sponding crédible intervais of the estimated ranks. The ranks will be estimated 
by the posterior médians, mainly because they are easier to calculatè. For each 
model and each accident type, the posterior median ranks and the associated 
2.5% —97.5% crédible intervais are plotted together for comparison. Sites with 
ranks to the far right are more dangerous and sites with ranks to the far left 
are more safe. 
The ranking process should be adjusted for including covariate information. 
There are two ways for doing that. A weak adjustment is already implicit in a 
Bayesian framework on the estimation process. For Poisson-régression models 
like (P-ga) and (P-MNre). a stronger approach considers the ranks not of A^ 
but of some quantities like random effects or regression-line intercepts or their 
sum, after removing the covariate information. Note that if the covariates 
included in the model are sufhcient to explain ail the variation between the 

CHAPTER 
9, MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 275 
sites then there is no reason for ranking. When no covariate information is 
used, as in Schlüter et al. (1997), obviously no adjustment of this type needs 
to be done. Model (P-MN1) is specified without any covariates so the ranking 
is based on the ranks of À^. 
The plot in Figure 9-6 illustrâtes the estimated statistics of the ranks of 
Afci relative to the model (P-ga), the Poisson-régression model with gamma 
random effects. It can be remarked on the plot in Figure 9.6 that sites with 
the lowest and. respectively highest, rank values, have quite small crédible 
intervais. The local authorities may décide to treat ail the sites that are 
Figure 9.6: Ranks of means: Poisson-régression 
with gamma random effects 
ranked after 120. for example, where 156 is the worst. The plots like the one 
in Figure 9.6 can be used to draw a vertical line at the point rank 120 and 
KSI accidents with 1 vehide 
(P-ga) model 
model 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 
276 
select all the sites whose credible intervals are intersected by this threshold line 
or to the right of this line. In this way it is accounted for the uncertainty in 
the calculation of ranks. Although two sites may have ranks with a difference 
of 20 between them, if their credible intervals overlap this means that it may 
be possible that the situation to be not so different, so both should be selected. 
This discussion applies to the other two models (P-MNre) and (P-MN1) and 
all other types of accident, as well. A l l four plots of this type, corresponding 
to the four type of accidents and also for the other two models (P-MNre) and 
(P-MN1) are given in the Appendix D. 
The ranks and their credible intervals can be plotted ordering the sites 
firstly by the rank, secondly by the 2.5% percentile and thirdly by the 97.5% 
percentile. The pattern of the change in rank and associated credible interval 
can then be seen. For ranking based on ranks of A ^ , these ordered plots are 
given in Appendix E, for all three models by accident type. A l l plots have a 
leaf shape pattern suggesting that the models give more credible ranks in the 
extremes, that is for sites with very low and very high ranks. 
The advantage of using ranks of the residual terms after removing the 
covariates, is that exposure variables like traffic flow and link length is taken 
into account. 
It can be argued that a site A having double the length of a 
site B is "expected" to have a greater number of accidents if all the other 
conditions are the same. A similar argument can be followed for traffic how. 
The idea is therefore to rank the "residual" information left after accounting 
for the covariates. 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 
277 
There are only two Poisson-regression models investigated. The residual 
terms are iog([iki) + /3,*i as calculated from the multiplicative equations of the 
type given in equation (9.2). The sites are presented as ordered by the ranks 
and corresponding percentiles. For the Poisson-regression model with gamma 
random effects, the four plots in Figures (9.7-9.10) show how uncertain the 
ranks may be. 
The similar plots provided by the Poisson-regression model 
with multivariate normal random effects, provided at the end of this chapter 
in Figures 9.11-9.14, tell a similar story. It might be useful to compare to 
ranks given by different models. This is clone in the next section. 
9.5.3 
Comparison of ranks by three models 
It is of course of interest to know how close the rankings are, as given by the 
three models investigated. A n easy way to do that is to plot the estimated 
ranks given by one model against the estimated, ranks given by another model. 
The comparison should be made for the same type of ranking. This means 
that either the models are compared for ranks of mean parameters A*,-, as 
shown in Appendix F, or for the Poisson-regression models, the models are 
compared for ranks of log(/^) -f ¡3^, as shown below. Overall it can be noticed 
immediately, from Figures 9.15-9.18, that the two Poisson-regression models 
provide similar rankings for all types of accident. 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 
278 
9.6 
Summary 
This chapter is a continuation of Chapter 8, applying the theoretical ideas 
emphasized there to some real data. A set of road accident data concerning 
road accidents in Kent on 156 single-carriageway link sites has been analysed 
for predictive purposes, for ranking the sites according to two criteria and 
for understanding the relationship between four types of accident and covari-
ate information like link length, speed limit and estimated traffic flow. 
The 
main models investigated were (P-ga), (P-MNre), (P-MN1) and (P-logN). The 
inference process was possible due to M C M C methods and the results were 
compared from several points of view. 
The first three models have been selected by D I C from a set of 11 models. 
Each models has its advantages and disadvantages and none should necessarily 
be rejected in favour of the others. There is some evidence that the accident 
numbers of different types are correlated and this could bias the analysis if 
multiple response accident frequencies were modelled separately at the uni­
variate level. 
This chapter provides an important tool for identifying hazardous locations 
and for forecasting the reduction in accidents that would result if the traffic 
could be reduced by a known factor. It was shown that the reduction is not 
similar for all four types of accidents investigated and generally depends on 
rural-urban areas. 
The selection of hazardous sites followed some ideas reviewed in Chapter 2 
for univariate models. The sites were categorised as dangerous according to 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS FOR ROAD ACCIDENT 
DATA 279 
either the probability of a site to be the worst or the posterior distribution of 
the rank of a parameter of interest of a site. The results were then compared 
with the Poisson-regression with gamma random effects model as a base model. 
Fatal or serious with 1 vehicle 
-ffi 
0 
25 
ED 
¡5 
1CO 
125 
ISO 
ZD 
FUnk alijw ; (P-ga) model 
Figure 9.7: Ordered posterior médians 
and crédible 
intervais of ranks; model 
(P-ga) for first type of accidents 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 280 
Fatal or serious with 2+ vehicles 
•S 
0 
35 
5D 
75 
tB 
t25 
H) 
175 
3D 
Rank values; (P-ga) model 
Figure 9.8: Ordered posterior médians 
and crédible 
intervais of ranks; model 
(P-ga) for second type of accidents 
Slight with 1 vehicle 
•Œ 
0 
2S 
33 
S 
1CO 
ES 
1SD 
175 
33J 
Rank values; (P-ga) model 
Figure 9.9: Ordered posterior médians 
and crédible 
intervais of ranks; model 
(P-ga) for third type of accidents 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS FOR ROAD ACCIDENT 
DATA 2S1 
Slight with 2+ vehtcles 
s 
-35 
0 
S 
3} 
75 
XD 
IS 
H) 
175 
ZD 
Ranhiatues; (P-ga) model 
Figure 9.10: Ordered posterior médians and crédible intervais of ranks; model 
(P-ga) for fourth type of accidents 
Fatal or seriouswith 1 vehicle 
0 
25 
S) 
7 5 X 0 1 3 5 1 3 ] 
175 
2C0 
R»nk\alues; (P-WNre) model 
Figure 9.11: Ordered posterior médians and crédible intervais of ranks; model 
(P-MNre) for the first type of accidents 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS FOR ROAD ACCIDENT 
DATA 282 
Fatal or serious with 2+ vehicles 
0 
2
5
È
D
7
5
t
H
t
S
i
a
]
1
7
5 
2tD 
Rar* values; (P-M*e) model 
Figure 9.12: Ordered posterior médians 
and crédible intervais of ranks; model 
(P-MNre) for the second type of accidents 
Sligtitwith 1 vehicle 
•25 
0 
3 5 3 ) 
7 5 0 3 1 2 5 1 3 ) 
175 
2B 
Rank value*: (P-M*re) model 
Figttre 9.13: Ordered posterior médians and crédible intervais of ranks; model 
(P-MNre) for the third type of accidents 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS FOR ROAD ACCIDENT 
DATA 283 
Slight with 2+ vehîcles 
• 3 5 D 2 S 3 ) 7 5 1 D t 2 5 t S ) 1 7 5 X D 
Rank values; (P-NTJro) mode) 
Figure 9.14•' Ordered posterior médians and crédible intervais of ranks; model 
(P-MNre) for the fourth type of accidents 
Fatal or se nous with 1 vehicle 
• 
0 
• 
• 
• 
O 
A 
° 
a 
• 
a
D 
tP 
D 
• m 
a 
° D 
• 
• 
„ 0 
cP 
• 
m 
s ^ g 
D 
• 
• "^ 
D tno-P 
O 
a • • • 
m 
• 
o 
D 
• 
0 
= ° ° 
o
S 
• CD 
• 
0 
2
0
*
3
3 
K) 
1C0 
t» 
VC 
«3 
Ranks rfven by(P-ga) modd 
Figure 9.15: Comparison of posterior médians of ranks of residual 
informa­
tion; fatal or serious accidents with 1 vehicle, (P-MNre) 
against (P-ga) 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD ACCIDENT 
DATA 2S4 
Fatal or serious with 1 vehicle 
a n
0 
rvP 
0 
• 
r, O 
o o 
0
0 
m 
•coa •cP 
• a 
• Q 
•O 
60 
83 
KD 
TO 
Ranks ojven by(P-ga) model 
Figure 9.16: Comparison 
of posterior médians 
of ranks of means; fatal or 
serious accidents with 2+ vehicles, (P-MNre) 
against (P-ga) 
Slight with 1 vehicle 
Ranks gi\en by(P-ga) modd 
Figure 9.17: Comparison 
of posterior médians 
of ranks of means; slight acci­
dents with 1 vehicle, (P-MNre) 
against (P-ga) 

CHAPTER 
9. MULTIPLE 
RESPONSE 
MODELS 
FOR ROAD 
ACCIDENT 
DATA 285 
Slight wrth 2+ vehicles 
•O 
60 
ED 
KD 
Rar* values given by (P-oa) model 
Figure 9.18: Comparison of posterior médians of ranks of means; slight acci­
dents with 2+ vehicles, (P-MNre) 
against (P-ga) 

Chapter 10 
Conclusion 
10.1 
Summary of the thesis 
10.1.1 
Multivariate modelling of road accident data 
The development of computer technology and computational techniques allows 
scientists to analyse more and more complex sets of data. 
Applied statisti­
cal modelling offers solutions for extracting valuable information from data. 
Simpson's paradox indicates that the modelling must be done at a multivariate 
level. One area of research which has not yet extensively exploited multivari­
ate statistical modelling is road accident analysis. This thesis aimed to make 
a step forward and to develop statistical procedures that can be used in this 
area of research and possibly in other similar areas of research. 
The thesis had two main directions of research given by the type of variables 
modelled, categorical variables representing characteristics of accidents in the 
first part, and multiple response variables representing accident numbers of 
286 

CHAPTER 
10. 
CONCLUSION 
287 
different type in the second part. The two parts were joined by using a similar 
tool of modelling, a graphical model represented by a graph. In the first part 
of the thesis this tool was mainly used for interpretation purposes at the end 
of the analysis, whereas in the second part of the thesis it was used to set up 
a hierarchical model before the actual fitting process. 
The difficulty of analysing road accident data has several facets. Firstly, 
data is collected as an observational study, no randomisation being possible. 
Secondly, the data is bound to be sparse, either when it is summarised in a 
contingency table or when it is modelled by regression-like techniques bringing 
covariate information. Therefore, inference based on classical asymptotic tests 
is most of the time unreliable and other methods are needed. This has been 
clearly demonstrated for graphical models with about 10 variables, during the 
course of a comparative model selection in Chapter 5. This is also true for 
modelling multiple accident frequencies simultaneously, the task dealt with in 
the second part of this thesis. The disaggregation by accident type was not 
possible for a larger number of types because the data would have been so 
sparse that a statistical analysis could have not revealed reliable conclusions. 
10.1.2 
Graphical models 
The complexity of road accident contingency tables requires multivariate sta­
tistical models and exact conditional testing. Graphical modelling is a useful 
multivariate statistical technique for disentangling the potential factors which 
influence important accident characteristics such as accident severity or the 

CHAPTER, 
10. 
CONCLUSION 
288 
number of casualties. 
It was shown in Chapters 3, 4 and 5 that graphical modelling ofFers a very 
good solution for investigating road accident characteristics in an exploratory 
mariner, being useful for small and large contingency tables. 
It was shown 
that speed limit, the number of vehicles involved and the number of casual­
ties are directly associated with accident severity, one characteristic of major 
interest to road safety. Various other conditional independence relationships 
were established. 
With a help of a small table it was shown that most of the log-linear models 
htting the data could be nested into a graphical model. Therefore, even when 
the objective is to find some spécifie type of log-linear model it would be 
useful to identify first a graphical model htting the data well and to refine the 
analysis starting from this model. The advantage of using a graphical model 
is that it is interprétable in terms of conditional independencies which can be 
visualised on a graph. 
The analysis of large contingency tables summarising road accident data 
was further improved when substantive external knowledge was made avail-
able. This type of analysis had a causal fiavour and the models, called graphi­
cal chain models, are a direct généralisation of graphical models. The inference 
process for this class of models is a sequential one, but at each step, it is the 
sarne process as developed for graphical models. It was shown on an example 
in Chapter 5 how this process should be developed. Graphical chain models 
were developed for a set of data concerning the county of Bedfordshire, for a 

CHAPTER 
10. 
CONCLUSION 
2SÔ 
set of data with accidents from Bedfordshire and Hampshire pooled together, 
and for two disaggregated sets of data for Bedfordshire. Reading conditional 
independencies on chain graphs can be sometimes difficult. It was shown using 
examples how to avoid traps by considering the moral graph of the smallest 
ancestral set of the subset of variables investigated. 
A class of precursor models to graphical chain models consists of the re­
sponse variable models introduced by Goodman (1973). Generally speaking, 
neither this class nor the class of graphical chain models coincides with the 
class of log-linear models. A resuit indicating when this équivalence is true, 
proved in Asmussen and Edwards (1983) using collapsibility, was restated in 
Chapter 6. Some examples and counterexamples using models encountered in 
the thesis were also exemplified in Chapter 6. 
Collapsibility also helped in showing how the analysis of a 6-dimensional 
table could be refined using a 3-dimensional marginal table without having 
Problems with Simpson's paradox. Furthermore, it was concluded that what 
seemed a natural graphical chain model for the collision-rollover table was not 
a log-linear model. 
It was also noticed that Simpson's paradox can appear in a négligent analy­
sis of contingency tables summarising road accidents. In conjunction with the 
need for analysing large tables this was one of the main motivations for ap-
plying graphical modelling to road accident tables. It was also shown how the 
concept of collapsibility of maximum likelihood estimators could be used to 
reduce safely the dimension of the analysis. 

CHAPTER 
10. 
CONCLUSION 
290 
10.1.3 
Hierarchical joint-response models 
The hierarchical modelling approach with multiple responses and random ef­
fects, developed in Chapters S and 9, give a solution to the problem of mod­
elling multiple response variables in a joint manner, that is a multivariate 
approach on the left hand side of the equations of the models as well as on 
the right hand side. The inference process can be done by employing M C M C 
techniques. The model output contains all the ingredients to answer various 
questions of interest, like predicting future values or ranking the observational 
units according to different measures. 
A framework model was proposed and it was proved that, under its as­
sumptions, this model offers a solution for modelling overdispersion and cor­
relation of the observed counts. This general model can be followed by other 
researchers in developing other hierarchical models for other sets of road acci­
dent data and for other areas where modelling counts is of interest. 
Using the models developed in this thesis, for the first time, practitioners 
can predict changes in accident type as well as the frequency. The predicted 
percentage reduction in accidents, if the traffic flow is reduced by a known fac­
tor 6. was calculated. The results were different for different types of accident 
and this could provide valuable information to local authorities. 
In Chapter 7 some theoretical aspects regarding the compound Poisson 
distributions were re-examined, a new proof of when there is a maximum 
likelihood estimator for the two parameters of a negative binomial distribution 
was given, and a condition for this estimator to be unique was also identified. 

CHAPTER 
10. 
CONCLUSION 
291 
A n approximation result was given that helps in studying the sensitivity of 
changing priors in compound Poisson modelling. 
M C M C techniques were successfully used for inferential purposes. 
One 
advantage of M C M C methods is that the same output can be used for an­
swering many questions. The Gibbs sampler was also helpful in developing a 
new group of selection procedures of log-linear models for contingency tables, 
thus making a direct connection between the two parts of the thesis. 
It is 
likely that many other complex models proposed for road accident data will 
have computational problems that could be easily solved by M C M C methods. 
Another problem investigated in the context of multiple accident frequen­
cies was ranking the sites. The ability to rank the sites using multiple response 
models gives another dimension to practical efforts in this area, selecting the 
hazardous sites according to different criteria. The ranking process was done 
for the four types of accidents investigated by three models selected by the 
DIC criterion, that is (P-ga), (P-MNre) and (P-MN1). One ranking measure 
used was the probability that a site is the worst one. Other ranking measures 
used were the posterior distribution of the rank of the mean parameter Ajt», 
for all three models, and the posterior distribution of the rank of the resid­
ual terms after removing the covariates, that is log(/xjt,-) + 
for (P-ga) and 
(P-MNre). The posterior distribution was described by its median and 2.5% 
and 97.5% percentiles. The rankings given by different models were compared 
using some scatterplots and found to be similar. 

CHAPTER 
10, 
CONCLUSION 
292 
10.2 
Conclusion 
The main conclusion emerging from this research is that it is better to start 
the analysis of accident data by a multivariate approach. For both types of 
accident data, either contingency tables or accident frequencies at sites, it is 
advisable and feasible to do this as shown in this thesis. 
Sometimes, the graphical models proposed can be collapsed onto a smaller 
subset of variables. Then the analysis can be continued with other statistical 
techniques. A n incorrect simplification of the analysis could lead to Simpson's 
paradox. 
Graphical representations are an useful instrument for communicating re­
sults and models to a large audience. Graphs can help to extract conclusions 
from the statistical analyses by, for example, reading conditional independen­
cies between subsets of variables on the conditional independence graph, or to 
specify models, like the fully Bayesian models analysed in W i n B U G S . 
It was revealed that speed limit and the number of vehicles involved influ­
ence directly accident characteristics responsible for road safety, like accident 
severity and the number of casualties. 
Other variables like road class, road 
surface conditions and the presence of a pedestrian crossing within 50m are 
not directly associated. 
The conditional independencies emphasized for the 
subset of STATS 19 data for Bedfordshire county, for Hampshire county and 
for those two sets of data pooled together, show that it is wrong to extend 
conclusions found at county level to a more aggregated level. The type of con­
clusions revealed by graphical models and graphical chain models developed 

CHAPTER 
10. 
CONCLUSION 
293 
in the first part of the thesis can help local authorities in designing better poli­
cies and in planning research. The results may also be useful in fundamental 
research involving the conceptualisation of data structures of road accidents 
as described in Lupton, Wing and Wright (1998). 
Since M C M C methods help to overcome many computational problems, 
almost any fully Bayesian model can be fitted and any arbitrary function of 
the parameters of the model can be posteriori estimated. This suggests that 
fully Bayesian models deserve more attention and more complex questions can 
be answered in this context. 
A statistical approach that can be used for inference on any aspect of the 
data, modelling multiple accident frequencies of different type, was shown in 
the second part of the thesis. This is the first analysis of this type in this area 
of research. 
The predictive accident models developed here can be used for a wide 
range of applications. The novelty of these models is that, for the first time in 
this area, qualitative as well as quantitative conclusions can be drawn at the 
same time. It was proved that a parallel approach, fitting several univariate 
regression models, leads to unreliable inference and should be avoided. 
Practitioners use either the observed accident frequencies or the posterior 
mean of the expected number of accidents at a site, in an empirical Bayes 
approach, to rank hazardous sites. Both are wrong and a better approach is 
described and applied in this research. 
As emphasized in Chapter 9, rank­
ing the sites ought to be done by the posterior distributions of ranks of the 

CHAPTER 
10. 
CONCLUSION 
294 
expected accident rates, that is of the ranks rki of À^. The posterior distrib­
ution is then used for a point estimation of the ranks and for calculating the 
associated crédible intervais. This seems to be an almost impossible task for 
traditional methods because it is not easy at ail to provide estimâtes of ranks 
of parameters. However, as it was shown in this thesis, under a fully Bayesian 
framework, it is possible to find a whole samplefrom the posterior distribution 
of any arbitrary functions of parameters, so for ranks as well. The ranks of 
observational units, such as sites in this thesis, are notoriously uncertain and 
a measure of uncertainty associated with rank estimâtes should be considered 
in the final analysis. Crédible intervais are a perfect solution to this problem 
and there is no additional modelling effort for calculating them. Once we have 
the M C M C output for the model investigated, any empirical summaries can 
be calculated easily. 
Another way of identifying the hazardous sites, presented in this thesis, is 
to calculate the posterior probability that a site is worst. This second method 
can be used for long term projects. 
Applying bad statistical techniques may 
have extremely bad conséquences for the public. If some really hazardous sites 
are left out of the list of sites to be treated, then, not only will large amounts 
of public money be wasted, but human lives could be lost as well. 
It was also shown that ail three explanatory variables used in the second 
part of the thesis, that is speed limit, estimated traffic flow and link length, 
have a significant contribution in explaining accident frequencies. However, 
the interactions between speed limit and the other two explanatory variables 

CHAPTER 
10. 
CONCLUSION 
295 
are not significant for all types of accident investigated. The prédictive acci­
dent models developed in the second part imply that reducing the traffic flow 
will reduce the number of accidents and it was calculated by how much. 
The hierarchical Bayesian models developed here for multiple response 
variables have been motivated by road accident data. However, they can be 
adapted to other areas of research where the modelling of counts is of interest. 
10.3 
Limitations of the research 
The research carried out in the first part of this thesis focused on only two 
counties, Bedfordshire and Hampshire, due to time limitations and to the re­
search for the second part of the thesis. However, a more gênerai investigation 
would be very much appreciated from the practical point of view by local 
autorities. 
The data used for developing graphical models in the first part of the thesis 
contained only accidents recorded in 1995. A larger set of data, containing road 
accidents from several years, may lead to other useful results. Unfortunately, 
this extension of the analysis to several sets of STATS 19 data was not possible 
given the period of time of this research. 
Another idea not exploitée! here is to consider ail counties in Great Britain 
with ail accidents in the same period of time. Then an additional variable 
can be defined for county and it would be interesting to see how this spatial 
variable affects the conclusions revealed by graphical models. 
This would 

CHAPTER 
10. CONCLUSION 
296 
be a vast project in itself, involving a lot of data préparation and a lot of 
computation. 
Some categorical variables such as accident severity, the number of vehicles 
involved and the number of casualties involved are ordinal. It would have been 
ideal if it had been possible to take this information into account. There is 
little or no theory of graphical models for variables of this type, only marginal 
tests developed for log-linear models being implemented in M I M . 
Moreover, the Bayesian model sélection procédures proposed in this thesis 
may be improved and a software program able to handle large tables would 
be a big step forward. 
There is no single package that can be used, in a user friendly manner, to 
develop the type of modelling proposed in this thesis. However, graphical mod­
els can be quite easily investigated with the package M I M (Edwards, 1995), 
and W i n B U G S 1.2 (Spiegelhalter, Thomas and Best, 1998) is one of the most 
aclvauced packages that can handle hierarchical Bayesian models. A list of 
other packages having implemented various M C M C techniques for various Sta­
tistical, modelling méthodologies is given in Carlin and Louis (1996). 
A n improved model sélection procédure using Akaike information criterion 
is available on a new version of M I M . However, this version was not available 
when the research for the relevant part of this thesis was carried out. 
The problem whether the maximum likelihood estimators of the two para­
meters of a negative binomial distribution are unique is very important. If the 
estimators are not unique then the results of the analysis should be carefully 

CHAPTER 
10. 
CONCLUSION 
297 
interprétée). Although the condition given by équation (7.5) can be checked for 
any set of data, it would be useful to know a definitive answer. A simulation 
study can provide some hints. 
There are some limitations concerning the elicitation of prior distributions. 
For the hierarchical Bayesian models the priors used in this thesis fotlowed 
the gênerai trend in the literature for modelling generalized linear models 
with random effects (Zeger and Karim, 1991; Spiegelhalter, Thomas and Best, 
1998; 
Gilks et 
al., 1996). 
Some researchers may prefer more informative 
priors. The Bayesian methodology can be improved from this point of view 
and this is an area of intensive research. For Poisson-regression models, Doss 
and Narasimhan (1994) provided a Computing environment within which one 
can immediately see the changes in the posterior distribution, corresponding 
to the changes in the prior distribution. Unfortunately, this program seems 
to be available only for Unix Workstations. Subject matter information may 
help in. developing better informative priors. 
The spécification of a covariance structure for the random effects /a in 
Chapter 8 is not straightforward. A possible model is described in the next 
section. The difficulty is due to the fact that the random effects account for 
information not included in the explanatory variables. Thus, it is difhcult to 
Interpret the covariance between two random effects. 

CHAPTER 
10. 
CONCLUSION 
298 
10.4 
Suggestions for further research 
Graphical models for ail counties 
It was remarked in Section 10.3 that one limitation of this research was the 
focus on only two counties, Bedfordshire and Hampshire. As mentioned in 
Chapter 5, for the same set of variables, the data sets of différent counties may 
be htted by différent graphical models. Without relying on unique models for 
each county. a question of interest would be what conditional independencies 
are supported by the data across the counties. More specifically, is accident 
severity independent of road type, daylight conditions and road surface con­
ditions given the speed limit and the number of vehicles involved? 
Another interesting question is what happens when there are several sets 
of data corresponding to several years for the same county, with the same 
variables investigated. For example, if there are data for Bedfordshire for ail 
years between 1995 and 1998, relative to the six variables studied in Chapter 5, 
can a graphical model Ht ail thèse sets of data separately? Some theoretical 
developments on this direction are described in Lyngaard and Walther (1993). 
Error in flow estimâtes 
The traffîc flow count at a site is usually a rough estimate because measure-
ments are taken not over the entire period under study but over a limited 
interval (or intervais) of time. The flows should be calculated as A A D T s over 
the entire time period for which the accident counts are taken. If Zk is the real 
unknown A A D T for site k in a multiplicative model, \ogZk would be one of 

CHARTER 
10. 
CONCLUSION 
299 
the explanatory variables. As Zk is usually not known, an estimate Qk is used, 
calculated over a period of time tk < 
A functional model in which just 
one of the explanatory variables is flow, has been briefly described in Mäher 
and Summersgill (1996). The flow with the true A A D T Zk is separated from 
the other variables 
and assuming that the estimated traffic flow Qk is Poisson distributed with 
mean Zktk-, the logTikelihood is partitioned into two parts, one modelling the 
accidents and the other the flows. A fully Bayesian spécification of this type 
of modelling is given by 
E(y*) = AJb = T f cexp[/3'X + 
7 l o g Z J t ] 
Yk I Afc 
Pois(At) 
A f c 
= 
exp\ß'X 
+ 7 log Zk] 
Qk | Zk, 
£fc 
?o\s(Zk'tk) 
ßj 
N(0,0.0001) 
7 
A'(0,0.0001) 
and it can easily be extended to multiple response models along the lines 
described in Chapter S. 

CHAPTER 
10. 
CONCLUSION 
300 
A more complex hierarchical Bayesian model 
The Poisson-régression model with gamma random effects specified in (8.24) 
docs not impose a covariance structure on the random effects fi. The following 
model suggests a possible structure. For ail k = 1 , 2 , . . . , N and t = 1 , 2 , . . . , M 
Yki I hi 
~ 
Pois(Afc(-) 
(10.1) 
(logAjtO = tfjti = 
log/ijti 4- X'kiPi 
Pki I et,-, ai 
= 
6*,- -j-
ftj 
~ 
N(0,0.001) 
bki 
*~ 
g a m m a ^ , £) 
a
i = E{ -r Vi 
a2 = Fi-r 
V2 
a3 = F2-\- Vi 
a 4 = F2 + V2 
where Fi,F2, 
Vï} V2 are mutually independent and ail independent of bkl. 
The 
variables Fi,F2 
model missing information concerning accident severity and 
the variables V\, V2 concerning number of vehicles. It is also assumed that 
F\ 
~ gamma(/1,<5), F2 
~ gamma(/ 2,6) 
Vi 
~ gammajui, S). V2 
^ gammafuj, 5) 
which implies that 
ai 
~ 
gamma(/ 1 + ui,<5) 

CHAPTER 
10. 
CONCLUSION 
301 
a2 
~ 
gamma(/i + v2. 6) 
a 3 
~* gamma(/ 2 + vx,6) 
a4 
~ 
gamma(/ 2 + v2. S). 
The condition that E(/*H) = 1 for 2 = 1, 2 , . . . , 4 is équivalent to the following 
System of linear équations, subject to the strict positivity restrictions for ail 
unknowns. 
= 
S 
(10-2) 
w2 + / i + v2 
= 6 
U>3 + ¡2 + Ul 
= 
# 
^ 4 + /2 + V2 
= 6-
It must be checked first that this System has proper solutions. This System 
of linear équations can be solvecl on computer, using for example MÀPLE V . 
The idea behind this model was described in Maher (1991) and it was later 
followed in Loveday and Jarrett (1992). 
The covariance structure of ju can be easily calculated as 
+/l +fl 
S2 
II 
S2 
•">2+h+V2 
¿ 2 
21 
S2 
0 
22. 
S2 
¡2 
52 
S2 
\ 
(10.3) 

CHAPTER 
10. 
CONCLUSION 
302 
and using the system of equations (10.2) this can be further simplified to 
5 
¿2 
¿2 
n 
^2-
I 
h. 
5 
52 
1 
(10.4) 
It can be remarked that this model may be further refined by choosing the 
scale parameter of the gamma distribution of 6& to be different from 8. the 
calculations being adjusted accordingly. A n immediate consequence will be 
that the system of equations (10.2) is nonlinear and the covariance structure 
becomes more complicated. 
Multiple response empirical Bayes models 
Many researchers are more interested in empirical Bayes models rather than 
in a fully Bayesian approach. For univariate responses, these methods are 
thoroughly investigated in textbooks (Carlin and Louis, 1996; Maritz and 
Lwin, 1989) and applied on a large scale in modelling road accidents (Hauer, 
1997; Mountain et 
al., 1996; Wright et 
ah, 1988; Jarrett et 
ah, 1982). 
However, for multiple responses, empirical Bayes methods are less developed. 
Taking either a nonparametric approach in Rob-bins' style (Robbins, 1955) or 
a parametric approach, the results of empirical Bayes models could usefully 
be compared to the fully Bayesian results developed in this thesis. One of the 
advantages of empirical Bayes methods is that they are not sensitive to prior 

CHAPTER 
10. 
CONCLUSION 
303 
elicitation. The models can be still specified hierarchically in several stages 
but the parameters of the distribution at the penultimate level of the hierarchy 
are estimated from data. The estimation process can be very difficult. 
10.5 
A final comment 
Statistical modelling is recognized as an art. A U models are false, otherwise 
they will explain the data entirely, but some are useful. Road accident data is 
an example of large and complex data requiring advanced Statistical techniques 
for a good analysis. 
The graphical modelling methodology emphasized in this thesis can be ap­
plied in the future to a large range of studies in this area of research. Similarly, 
multiple response models as those proposed here can be adapted by other re-
searchers to investigate other questions of interest related to trafhc and safety 
transport. A i l thèse contributions can make a différence to a better world. 

Appendix A 
Proof of a collapsibility resuit 
The following corollary of Theorem 6.1 shows how collapsibility helps in cal-
culating the maximum likelihood estimâtes for large tables using known max­
imum likehhood estimâtes for marginal tables, and it will be used to prove a 
collapsibility resuit for response variable models in this appendix. 
C o r o l l a r y A . l Let the log-linear model L be collapsible onto a. Then 
= fcHlI [Pc](6)(icl(6))/{n(ibd(b))/iV}] 
( A . l ) 
6 
where the product is taken over all connected components b ofac. 
The next resuit, given in Asmussen and Edwards (1983), can be proved in a 
différent, more explicit way as it is shown below. 
T h e o r e m A . l If L G C, then L 6 Ja 
if and only if L is collapsible onto a. 
In lhat case M = in and C = [a] U Lb} where b = cl(a c). 
304 

APPENDIX 
A, PROOF 
OF A COLLAPSIBILITY 
RESULT 
Proof . If LE Ja 
tfien 
305 
pL(i)=P
M(ia)pc(i 
(A.2) 
so it follows easily that 
pLM 
= EP
1(«') = £/'(OP
0(»". 
If it can be shown that M Ç La then it will follow that pc(in) 
G pLa{ia) 
and this is exactly the définition of collapsibility of L onto a. 
Note that 
pa is denoted hère by pLa. 
The inclusion can be shown using the log-linear 
expansions, and this is the main différence compared to the constructive proof 
given in Âsmussen and Edwards (1983). It is obvious that 
I°SPC(^K) = E <A'+ E 
u 
,ttUac 
Therefore from équation (A.2) it follows that 
logp L(*) 
l o g p M ( i a ) -r-logp c( Î Q C | i a 
= E«}+ E «r+ E 
aUac 
'92U93 

APPENDIX 
A. PROOF 
OF A COLLAPSIBILITY 
RESOUT 
306 
and so 
Now it is obvious that M — La. 
To show that C = [a] U 
it follows from 
équation A.2 that 
= E «,r-E«£ 
31 CoUac 
.?2Ça 
and it is known that there are interaction terms corresponding to all subsets 
of a, that is a is a generator. Thus, 
i°gpc(-^ i <.) = E < + E «CC + E 
siÇa 
S2Çac 
A3 Ca 
The first s um gives [a]; the second sum contains all u-terms from L that are 
given by variables in ac and the third sum contains all u-terms from L that 
are given by variables in a connected with variables from Gc, that is those 
variables in bd(a c). Therefore, the last two sums give a log-linear expansion 
of La 
cubd(oc) which is Zrt, with 6 = cl(a c). 
Conversely, if L is collapsible onto a then let M = La. C = [a] U 
where 
b = cl(a e). Then pM(ia) 
= pLa{'ia) 
— PL{ia) by the définition of collapsibility 
in Section 6.2. and it h as to be proved that pL(i) = pJ(i), 
where J = ( M , C). 
Let ac = bi U . . . U bq be the connected components of ac. 
Using the global 

APPENDIX 
A. PROOF 
OF A CÖLLAPSIBSLITY 
RESULT 
307 
Markov property 
V 
(«a* | ta) = V [u* 
| «bd( a
c)) 
and using the independence of the subsets of variables corresponding to the 
connected components 
the last equality following because &kUbd(a c) = c\{bk) Ubd(a c). Since bd(a c) n 
cl(6jt) = bd(6jt) C a and a is a generator for C the following Lemma, proved 
by Haberman (1974) the first part, and Lauritzen (1982) the second part, can 
be applied 
Lema A . l (Haberman-Lauritzen) If a-\ andbi are two subsets of variables 
of the sei of variables of interest X such that 
1. a1Ubl 
= X 
2. ai and 
are separated by ax 0 b\ 
S. ai H &i C cl} where c\ is a generator of the log-linear model Li 
then 
k=l 
It is obvious that 
P 
(hk 
I *bd(a«)) 
(A.3) 
"(t f t lnfci) 
N 
}, and p(iai) 
= 
pai(iai)-

APPENDIX 
A. PROOF 
OF A COLLAPSIBILITY 
RESULT 
303 
Taking a\ = bd(a c) and bx = cl(6¿), it follows from equation (A.3) and 
Haberman-Lauritzen lema that 
P {Íbk I ¿bd(a<)) = 
p(*bd(ac)) 
= 
Pbd(a') (¿bd(ac))Pcl(6fe) (¿cl(fafc) ) 
P{ibd{a<)){n{ibd(b„))/N} 
which shows, putting all together that 
fi7(i) 
= Pa{ia) u 
[£cl(b f c)(M(i>*))/{n(i M( b k))/N}\ 
k=l 
and using Corollary A..1 that pJ = pL. Hence L — J £ Ja as required.• 

Appendix B 
Tables for graphical chain 
modelling 
Table B.l: 
Accidents with pedestrian casualtics in Bcdfordshire, 
1995; a 
= 
0.01 
Variables 
Model formula 
Method 
DJLJ 
\T]\DH) 
[T][DH] 
[T][DH] 
Dec. 
Unres. 
Exact. 
L,R,S\ 
0, 
H:T 
[R][LS][HL][DHT\ 
[RS] [HR] [LS] [HL] \D HT) [DS] 
[R][LS][HL)[DHT] 
Dec. 
Unres. 
Exact. 
P,N 
| L}R, 
S,D,H,T 
[ P RT] [NS] [DH 
LRST] 
[NS][PT][DHLRST\ 
[NS][PT][DHLRST] 
Dec. 
Unres. 
Exact 
A,C\P,N,L, 
R, 
S,D,H,T 
[AHRST] 
[C S) [DHL 
NPRST] 
[AS}[CS\[DHLNPRST] 
[A][CN}[DHLNPRST} 
Dec. 
Unres. 
Exact 
309 

APPENDIX 
B. 
TABLES 
FOR GRAPHIC AL CHAIN 
MODELLING 
310 
Table B.2: Accidents wük pedestrian casualties in Bedfordskire 
and Hamp­
shire, 1995; a = 0.05 
Variables 
Model formula 
Method 
D,H,T 
{HT][DH} 
[HT][DH] 
[HT][DH] 
Dec. 
Unres. 
Exact. 
LtR,S 
| DJI,T 
[HRT\ [EST] [HLT] [DHT] 
[H ST][H R][H LS][D 
HT] 
[H ST] [HR] [HLS] [DHT] 
Dec. 
Unres. 
Exact. 
P,N 
| 
L,R,S,D,H,T 
[DH 
LPRT][NS\[DHLRST] 
[NS] [LPT] [D H ERST] 
[NS] [DLPRT] 
[D HERST] 
Dec. 
Unres. 
Exact 
A,C 
| 
P,N,L,R,S,D,H,T 
[ACDH 
PRST][CDHNPRST][DHLNPRST] 
[AST] [C NPS] 
[DHLNPRST] 
[ACHST][CHNST)[DHLNPRST] 
Dec. 
Unres. 
Exact 
Table B.S: Accidents tuith pedestrian casualties in Bedfordshire 
and Hamp­
shire, 1995; a = 0.01 
Variables 
Model formula 
Method 
D,H,T 
[T][DH] 
[T][DH] 
[T\[DH] 
Dec. 
Unres. 
Exact. 
L,R,S 
| D..H.T 
[HR] [LST] [HLT] [DHT] 
[ST][HR][HL]\LS]{DHT] 
[H 
ST][HR][HLS][DHT] 
Dec. 
Unres. 
Exact. 
P,N 
| L,R,S: 
0 , H, T 
[DHLPRT][NS][DH 
LRST] 
[NPS][LPST][DHLRST] 
[NS] 
[DLPT][DHLRST] 
Dec. 
Unres. 
Exact 
A,C 
| P,N,L, 
ß, 
S,D,H.T [ACHP][ADHPRST][DH 
LNPRST] 
[AS][CNP][DHLNPRST] 
[ACHS][CHNS][DHLNPRST] 
Dec. 
Unres. 
Exact 

APPENDIX 
B. TABLES 
FOR GRAPHIC AL CHAIN 
MODELLIN 
G 
311 
Table B.4: Accidents without pedestrian casualties in Bedfordshire and Hamp­
shire, 1995; a = 0.05 
Variables 
Model formula 
Method 
D, H, T 
[HT]{DH] 
[HT][DH] 
[HT][DH] 
Dec. 
Unres. 
Exact. 
L,R,S\ 
D, //", T 
[H LRST] 
[DHRST] 
[HLRST][DHRT] 
[HLRST][DHRT] 
Dec. 
Unres. 
Exact. 
N | 
L,R,S,D,H,T 
\DHLNRST) 
[DHNRST] 
[D H LRST] 
[DHLNRST] 
Dec. 
Unres. 
Exact 
A,C 
| 
N,L,R,S,D,H,T 
[ACDHLNRST] 
Dec. 
[A.LNS][CHNRS][DHLNRST] 
Unres. 
[ACDHNS] 
[CDHLNST] 
[DHLNRST] 
Exact 
Table B.5: Accidents without pedestrian casualties in Bedfordshire 
shire, 1995; a = 0.01 
and Hamp-
Variables 
Model formula 
Method 
D,H,T 
\HT][DH] 
[HT\[DH] 
[HT][DH] 
Dec. 
Unres. 
Exact. 
L,R,S 
| D , i / , T 
[HERST] 
\ DH 
RST] 
[HLRST][DHRT] 
[H LRST] 
[DHRT] 
Dec. 
Unres. 
Exact. 
N | 
L,R,S,D,H,T 
[DHLNRST] 
[DHNRST] 
[DHLRST] 
[DHNRST][DHLRST] 
Dec. 
Unres. 
Exact 
A,C\ 
N\.L.R,S,DJ-I/T 
[ACDHLNRST] 
[ALNS][CHNRS][DHLNRST] 
[AC H N S][C D H N ST]\D H LN 
RST] 
Dec. 
Unres. 
Exact 

Appendix C 
Comparison of the (P-ga) and 
(P-logN) models 
The plots on the left correspond to model (P-ga) (model 1 here) given in 
Chapter 9 by équations (9.1) and those plots on the right correpond to model 
(P-logN) (model 2 here) given in Chapter 9 by équations (9.12). The fit is 
better for model (P-ga) for each type of accident. 
I 
1° 
observai acadmlil 
Figure Cl: 
KSI with 1 vehicle for 
Figure C.2: 
KSI witk 1 vehicle 
for 
Model 1 
Model 2 
312 

APPENDIX 
C. COMPARISON 
OF THE (P-GA) AND (P-LOGN) 
MODELS 
313 
-10 
0 
10 
20 
30 
« 
-10 
0 
10 
20 
30 
observod accident» 2 
oteorvod acd (knls2 
Figure C.3: KSI with 2+ vehicles 
Figure C-4: KSI with 2+ vehicles 
for Model 1 
for Model 2 
Figure C.5: S with 1 vehicle only 
Figure C.6: S with 1 vehicle 
only 
for Model 1 
f0r Model 2 

APPENDIX 
C. COMPARISON 
OE THE (P-GA) AND (P-LOGN) 
MODELS 
314 
Figure ¿7,7: S with 2+ vehicles for 
Figure C.8: S with 2+ vehicles for 
Model 1 
Model 2 

Appendix D 
Ranks with credible intervals 
315 

APPENDIX 
D. 
RANKS 
WÏTH 
CREDIBLE 
INTERVALS 
KSI accidents with 1 vehicle 
(P-ga) model 
KSI accidents with 2+ vehicles 
(P-ga) model 
T 
1 1 • 
1 1 
1 
1 
1 r——i 
1 
1 
1 
100 
200 

APPENDIX 
D. 
RANKS 
WITH 
CREDIBLE 
INTERVALS 
S accidents with 1 vehicle 
(P-ga) model 
S accidents with 2+ vehicles 
(P-ga) model 
i—i—i—i—i—•—i—i—i—i—i—i—i—i—i—1 
100 
200 

APPENDIX 
D. RANKS 
WITH 
CREDIBLE 
INTERVALS 
KSI accidents with 1 vehicle 
(P-MNre) model 
KSI accidents with 2+ vehicles 
(P-MNre) model 

APPENDIX 
D 
RANKS 
WITH 
CREDIBLE 
INTERVALS 
S accidents with 1 vehicle 
(P-MNre) model 
S accidents with 2+ vehicles 
(P-MNre) model 

APPENDIX 
D. RANKS 
WITH CREDIBLE 
INTERVALS 
KSI accidents with 1 vehicle 
(P-MNI)model 
KSI accidents with 2+ vehicles 
(P-MNI)model 

APPENDIXD. 
RANKS 
WITH 
CREDIBLE 
INTERVALS 
S accidents with 1 vehicle 
(P-MNI)model 
S accidents with 2+ vehicles 
(P-MNI)model 

Appendix E 
Ordered ranks with credible 
intervals 
322 

APPENDIX 
E. ORDERED 
RANKS 
WITH 
CREDIBLE 
INTERVALS 
KSI with 1 vehicle 
(P-ga) model 
T 
• 
• 
• 
1 
1 
• 
• 
I 
O 
25 
50 
75 
100 
125 
150 
175 
200 
Rank values 
KSI with 2+ vehicles 
(P-ga) model 
25 
50 
75 
IQQ 
125 
150 
175 
200 
Rank values 

APPENDÏX 
E. ORDERED 
RANKS 
WITH 
CREDIBLE 
INTERVALS 
324 
S with 1 vehicle 
P-ga) model 
Rank values 
S with 2+ vehicles 
(P-ga) model 
- • 
» 
• 
• 
• 
r— 
• 
i 
26 
M 
73 
100 
125 
150 
1 75 
200 
Rank values 

APPENDIX 
E. ORDERED 
RANKS 
WITH CREDIBLE 
INTERVALS 
KSI with 1 vehicle 
(P-MNre) model 
.a • 
¡55 
" 
1 
• 
1 
1 
1— 
25 
50 
75 
100 
125 
150 
175 
Rank values 
KSI with 2+ vehicles 
(P-MNre) model 
03 1 
25 
50 
75 
100 
125 
150 
175 
200 
Rank values 

APPENDIX 
F, ORDERED 
RANKS 
WITH 
CREDIBLE 
INTERVALS 
S with 1 vehicle 
(P-MNre) model 
Rank values 
S with 2+ vehicles 
(P-MNre) model 
Rank salues 

APPENDIX 
E. ORDERED 
RANKS 
WITH 
CREDIBLE 
INTERVALS 
KSI with 1 vehicle 
(P-MN1) model 
Rank values 
KSI with 2+ vehicles 
(P-MN1) model 
i 
25 
90 
75 
100 
125 
150 
175 
200 
Rank values 

APPENDIX 
E. ORDERED 
RANKS 
WITH CREDIBLE 
INTERVALS 
S with 1 vehicle 
(P-MN1) model 
Rank values 
S with 2+ vehicles 
(P-MN1) model 
• 
• 
i 
• 
• 
• 
i 
25 
SO 
75 
100 
125 
150 
175 
200 
Rank values 

Appendix F 
Comparison of ranks 
In the following scatterplots the posterior median of ranks, as given by (P-
MNre) and (P-MN1), are compared to the posterior median of ranks as given 
by (P-ga). 
The model (P-MNre) gives closer matchings of ranks with the 
base model (P-ga) than the matchings of model (P-MN1). This is not very 
surprising, (P-ga) and (P-MNre) having a similar model specification and using 
the same covariate information. On the contrary, the model (P-MN1) is based 
on different "distributional" assumptions, more exactly on the multivariate 
Poisson-log normal distribution, and it does not use any covariate information. 
For fatal or serious accidents, the plots of (P-MN1) against (P-ga) are more 
volatile but still close in the right extreme of the plot, where is the interest of 
the practitioner. For slight accidents, the plots of (P-MN1) against (P-ga) are 
improving; this suggests that the sparsity of the data may be the cause of the 
difference in ranking. From the plot comparing ranks given by ( P - M N l ) with 
those given by (P-ga), for fatal or serious accidents with 2+ vehicles, it can be 
329 

APPENDIX 
F. COMPARISON 
OF RANKS 
330 
seen that there are more triangles above the diagonal line for the sites in the 
middle of the ranks. This means that the (P-MN1) model gives larger right 
ends of the crédible intervais of the ranks than those given by model (P-ga). 
KSI accidents with 1 vehicle 
156 fink sites in Kent 
to , 
. 
Ranlcs by P-ga irodd 

APPENDIX 
F. COMPARISON 
OF 
RANKS 
KSI accidents with 1 vehicle 
156 link aites in Kent 
MO 
0 
Z) 
43 
Œ) 
83 
1 CD 
K) 
MO 
Ranks by P-ga mode) 
KSI accidents with 2+ vehicles 
156 Bnk 9rte3 in Kent 
Ranks by P-ga model 

APPENDIX 
F. COMPARISON 
OF 
RANKS 
KSI accidents with 2+ vehicles 
156 Gnk sites in Kent 
H) 
0 
Z> 
"O 
80 
BD 
KO 
QD 
MO 
Ranks by P-ga model 
S accidents with 1 vehicle 
156 link sites in Kent 
183 
Ranks byP-ga mode) 

APPENDIX 
F. COMPARISON 
OF 
RANKS 
S accidents with 1 vehicle 
156 fink sites in Kent 
O 
2D 
«
B
D 
BD 
1C0 
CO 
140 
1Q) 
Ranks byP-gamodd 
S accidents with 2+ vehicles 
156 link sites in Kent 
wo 
« 
EO 
BO 
XD 
120 
MO 
163 
Ranks by P-ga modd 

APPENDIX 
F, 
COMPARISON 
OF 
RANKS 
S accidents with 2+ vehicle 
156 Knk sites in Kent 
«0 
D 
2
0
«
8
)
8
0
K
D
1
2
]
W
J
i
œ 
Ranks byP-ga mode) 

Appendix G 
Posterior statistics for 
régression coefficients 
335 

APPENDIX 
G. POSTERIOR 
STATISTICS 
FOR REGRESSION 
COEFFICIENTS 
336 
Table G.l: 
Estimâtes 
for mixed Poisson-gamma 
régression 
model 
1 
5T(log/) 
S 
SL 
SX 
Statistic 
A i 
A a 
A 3 
A 4 
A s 
Ä 6 
mean 
0.55 
1.20 
0.60 
-0.29 
0.04 
-0.38 
sd 
0.09 
0.11 
0.09 
0.10 
0.08 
0.14 
2.5 % 
0.36 
1.00 
0.41 
-0.49 
-0.13 
-0.66 
median 
0.54 
1.20 
0.60 
-0.29 
0.04 
-0.37 
97.5 % 
0.72 
1.43 
0.79 
-0.09 
0.20 
-0.10 
Statistic 
A i 
A z 
A 3 
A 4 
A s 
A s 
mean 
0.85 
1.49 
0.72 
-0.29 
0.09 
-0.01 
sd 
0.08 
0.09 
0.08 
0.08 
0.07 
0.11 
2.5 % 
0.70 
1.30 
0.56 
-0.47 
-0.06 
-0.25 
median 
0.85 
1.49 
0.72 
-0.29 
0.09 
-0.01 
97.5 % 
1.00 
1.70 
0.87 
-0.12 
0.24 
0.20 
Statistic 
A i 
A Î 
A 3 
A 4 
A s 
Ä 6 
mean 
1.09 
1.28 
0.57 
-0.16 
-0.10 
-0.26 
sd 
0.07 
0.10 
0.09 
0.08 
0.08 
0.13 
2.5 % 
0.94 
1.08 
0.47 
-0.34 
-0.26 
-0.52 
median 
1.09 
1.28 
0.57 
-0.15 
-0.10 
-0.26 
97.5 % 
1.23 
1.49 
0.75 
0.00 
0.05 
-0.02 
Statistic 
A i 
A
2 
A s 
A 4 
A s 
A e 
mean 
2.00 
1.29 
0.69 
-0.35 
-0.00 
-0.08 
sd 
0.06 
0.09 
0.07 
0.07 
0.06 
0.10 
2.5 % 
1.S7 
1.12 
0.55 
-0.48 
-0.12 
-0.28 
median 
2.00 
1.30 
0.69 
-0.35 
-0.00 
-0.08 
97.5 % 
2.13 
1.46 
0.85 
-0.21 
0.13 
0.12 

Bibliography 
Abbess, C , J arret t, D. and Wright, C. (1981), 'Accidents at blackspots: 
estimating the effectiveness of remedial treatment with special refer­
ence to the regression-to-mean effect', Traffic Engineering 
and 
Control 
22(10), 535-542. 
Agresti, A . (1990), Categorical Data Analysis, Wiley, New York. 
Agresti, A . (1996), An Introduction to Categorical Data Analysis, Wiley, New 
York. 
Aitchison, J. and Ho, C. (1.989), 'The multivariate Poisson-log normal distri­
bution', Biometrika 
76(4), 643-653. 
A i t k i n , M . (1979), ' A simultaneous test procedure for contingency table mod­
els', Applied Statistics 28, 233-242. 
Akaike, H. (1973), Information theory and an extension of the maximum like­
lihood principle, in B. Petrov and F. Csaki. eds, 'Second Int. Symp. 
Information Theory', Akademiai Kiado: Budapest, pp. 267-281. 
337 

BIBLIOGRAPHY 
338 
Altham, P. (1984), 'Improving the precision of estimation by fitting a model', 
J. Roy. Statist 
Soc. B(46), 118-119. 
Amis, G . (1996), ' A n application of generalised linear modelling to the analysis 
of traffic accidents'. Traffic Eng. and 
Control. 
Anscombe, F. (1950), 'Sampling theory of the negative binomial and logarith­
mic series distributions', Biometrika 
37, 358-382. 
Aragon, J . ; Eberly, D . and Eberly, S. (1992), 'Existence and uniqueness of the 
maximum likelihood estimator for the two-parameter negative binomial 
distribution 1, Statistics and Probability Letters 15, 375-379. 
Asmussen, S. and Edwards, D. (1983), 'Collapsibility and response variables 
in contingency tables', Biometrika 
70(3), 566-578. 
Bartlett, M . (1935), 'Contingency table interactions', Journal of the Royal 
Statistical Society 2, 248-52. 
Baruya, A . , Finch, D. and Wells, P. (1999), ' A speed-accident relationship 
for european single-carriageway roads', Traffic Engineering 
and 
Control 
40(3), 135-139. 
Besag, J. (1.974), 'Spatial interaction and the statistical analysis of lattice 
systems (with discussion) 1, ./. Roy. Statist. Soc. Ser. B. 36, 192-236. 
Bishop, Y . , Fienberg, S. and Holland, P. (1975), Discrete Multivariate 
Analy­
sis, M I T Press, Cambridge, Massachusetts. 

BIBLIOGRAPH*' 
339 
Blalock, H . (1971), Causal modeîs 
in the social sciences, Aldine-Atheston, 
Chicago. 
Breslow, N . and Clayton, D. (1993), 'Approximate inference in generalized 
linear mixed models'. Journal of American Statistical Association 
88. 9-
25. 
Brooks, S. and Gelman, A . (1998), 'Alternative methods for monitoring con­
vergence of iterative simulations', Journal of Computational 
and Graph-
ical Statistics 7, 434-455. 
Brown, M . (1976), 'Screening effects in multi-dimensional contingency tables', 
Appt. Statist. 25(1), 37-46. 
Brude, U . and Larsson. J. (1988), 'The use of prédiction models for eliminating 
effects due to regression-to-the-mean in road accident data', 
Accident 
Analysés and Prévention 
20(4), 299-310. 
Cameron, A . and Trivedi, P. (1986), 'Econometric models based on count data: 
comparisons and and applications of some estimators and tests', Journal 
of Applied Econometrics 
(1), 29-53. 
Carlin, B. and Louis, T. (1.996). Bayes and Empirical Bayes Methods for Data 
Analysis, Chapman & Hall, London. 
Carruthers, D . , Bulpitt, M . , Cray, G . . Holmes, A . , MacKinven, D., Moore, 
P., Quinn, D., Zealley, H . and Huxford, R. (1996), A vision for road 

BIBLIOGRAPHY 
340 
safety beyond 2000, Technical report, The Institution of Civil Engineers, 
London. 
Christensen, R. (1.990), Log-Linear Models, Springer-Verlag, New York. 
Christiansen, C-, Morris, C. and Pendleton, 0. (1992), A hierarchical Pois-
son model, with beta adjustments for traffic accident analyses, Technical 
Report 103, Center for Statistical Sciences, University of Texas, Austin. 
Cox, D. (19S3), 'Some remarks on overdispersion', Biometrika 
70(1), 269-274. 
Cox, D. (1993), 'Causality and graphical models', Bulletin 
of 
International 
Statistical Institute Proceedings of 49th session, 365-372. 
Cox, D . and Wermuth, N . (1993), 'Linear dependencies represented by chain 
graphs', Statist. Set. 8, 204-218. 
Darroch, J., Lauritzen, S. and Speed. T. (1980), 'Markov fields and log-linear 
interaction models for contingency tables', Annals of Statistics 
8, 522— 
539. 
Davies, J. (1990), ' A Bayesian analysis of some accident data'. 
Statistician 
39,11-17. 
Davis, L. (1986), 'Whittemore's notion of collapsibility in multidimensional 
contingency tables', Communications 
in Statistics Theory 15, 2541-2554. 
Dawicl, A . (19S0), 'Conditional independence for statistical operations', An­
nals of Statistics 8, 598-617. 

BIBLIOGRAPHY 
341 
Dean. C. and Lawless, J. (1989), 'Tests for detecting overdispersion in pois-
son regression models', Journal of the American 
Statistical 
Association 
84(406), 467-472. 
Dempster, A . (1974), The direct use of likelihood for significance testing, in 
P. B. 0 . BarndorfT-Nielsen and G . Schou, eds, 'Proceedings of Confer­
ence on Foundational Questions in Statistical Inference', Department of 
Theoretical Statistics: University of Aarhus, pp. 335-352. 
Department of Transport (1996), Road accidents Great Britain: 1995 the 
casualty report, Technical report, Department of Transport, London. 
Doss. H . and Narasimhan, B. (1994), Bayesian Poisson regression using the 
Gibbs sampler: Sensitivity analysis through dynamic graphics, Technical 
report, Department of Statistics, The Ohio State University, Ohio. 
Durrett, R. (1991), Probability: 
Theory and Examples, The Wads worth and 
Brooks, California. 
Edwards, D. (1990), 'Hierarchical interaction models (with discussion)"', Jour­
nal of the Royal Statistical Society, B (52), 3-20. 
Edwards, D. (1995), Introduction 
to Graphical 
Modelling, 
Springer-Verlag, 
New York. 
Edwards, D. and Havranek, T. (1985), ' A fast procedure for model search in 
multi-dimensional contingency tables', Biometrika 
72(2), 339-351. 

BIBLIOGRAPHY 
342 
Fienberg, S. (1980), The Analysis of Cross-Classified 
Categorical Data, M I T 
Press, Cambridge, Massachusetts. 
Frydenberg, M . (1990), 'The chain graph Markov property', 
Scandinavian 
Journal of Statistics 17, 333-353. 
Gabriel, K . (1969), 'Simultaneous test procedures: some theory of multiple 
comparisons', Ann. Math. Statist. 40(1), 224-250. 
Gelman, A . , Carlin, J., Stern, H . and Rubin, D. (1995), Bayesian Data Analy­
sis, Chapman and Hall, London. 
Geman. S. and Geman, S. (1984), 'Stochastic relaxation, Gibbs distributions 
and the Bayesian restoration of images', IEEE Transactions 
on 
Pattern 
Analysis and-Machine 
Intelligence 6, 721-741. 
George, E., Makov, U . and Smith, A . (1993), 'Conjugate likelihood distribu­
tions', Scandinavian 
Journal of Statistics 20, 147-156. 
Gibbs, W . (1.902), Elementary 
principles 
of statistical 
mechanics, Yale Uni­
versity Press, NewHaven. 
Gilks, W . (1992), Derivative-free adaptive rejection sampling for Gibbs sam­
pling, in J. Bernardo, J. Berger. A. Dawid and A . Smith, eds, 'Bayesian 
Statistics 4', Oxford University Press, pp. 641-649. 
Gilks, W . , Richardson, S. and Spiegelhalter, D., eds (1996), Markov 
Chain 
Monte Carlo in Practice, Chapman and Hall, London. 

BIBLIOGRAPHY 
343 
Goldstein. H . (1979). The design and anaiysis of longitudinal studies, 
Acad-
emic Press, London. 
Goodman, L. (1973), 'The anaiysis of multidimensional contingency tables 
vvhen some variables are posterior to others: a modified path anaiysis 
approach'. Biometrika 
60. 179-192. 
Haberman, S. (1974), The Anaiysis of Frequency data, University of Chicago 
Press, Chicago. 
Hand, D . , McConway, D. and Stanghellini, E. (1997), 'Graphical models of 
applicants for credit', IMA Journal of Mathematics 
Applied in Business 
and Industry (8), 143-155. 
Haner, E. (1980), 'Bias-by-selection: Overestimation of the effectiveness of 
safety countermeasures caused by the process of selection for treatment', 
Accid. Anal, and Frev. 12(2), 113-118. 
Hauer, E. (1986), 'On the estimation of the expected number of accidents', 
Accid. Anal, and Frev. 18(1), 1-12. 
Hauer, E. (1997), Observational before-after studies in road safety: 
estimating 
the effect of highway and traffic engineering measures on road safety, 
Elsevier Science, Oxford. 
Hauer, E., Ng, J. and Lovell, J. (1989), 'Estimation of safety at signalized 
intersections', Trans. Res. Record 1185, 48-61. 

BIBLIOGRAPHY 
344 
Henson, R. (1992), Pedal cycle accidents at T-junctions, in J. Griffiths, 
ed., 'Mathematics in Transport Planning and Control', Clarendon Press, 
pp. 355-366. 
Higle, J. and Witkowski, J. (1988), 'Bayesian identification of hazards loca­
tions', Trans. Res. Ree. 1185, 24-36. 
Holland. P. (1986), 'Statistics and causal inference', Journal of the 
American 
Statistical Association 81, 945-970. 
Jarrett, D., Abbess, C. and Wright, C. (1982), Bayesian methods applied to 
road accident blackspot studies: some recent progress. S W O V Confer­
ence, Amsterdam. 
Johnson, N . and Kotz, S. (1969), Discrete 
distributions, 
Houghton Mifflin 
Company, Boston. 
Kass, R., Tierney, L. and Kadane, J. (1989), 'Approximate methods for assess­
ing influence and sensitivity in Bayesian analysis', Biometrika 
76, 663-
674. 
Kihlberg, J., Narragon, E. and Campbell, B. (1964), Automobile crash injury 
in relaion to car size, Technical Report VJ-1823-RU, Cornell Aero. Lab. 
Kreiner, S. (1987), 'Analysis of multi-dimensional contingency tables by exact 
conditional tests: techniques and strategies'. Scand. J. Statist. 14, 97-
112. 

BIBLIOGRAPHY 
345 
Kulmala, R. (1994), 'Measuring the safety effect of road measures at junctions', 
Accid. Anal, and Prev. 26(6), 7S1-794. 
Laird, N . and Louis, T. (1989), 'Empirical Bayes ranking methods 1, 
Journal 
of Bducational Statistics 14, 29-46. 
Lauritzen, S. (1982), Lectures on Contingency 
Tables, 2 edn, University of 
Âalborg Press, Denmark. 
Lauritzen, S. (1989), 'Mixed graphical association models (with discussion)', 
Scand. J. Statist. 16, 273-306. 
Lauritzen, S. (1996), Graphical Models, Oxford University Press, Oxford. 
Lauritzen, S., Speed, T. and Vijayan, K . (1984), 'Decomposable graphs and 
hypergraphs', ./. Austral. Math. Soc. A 36, 12-29. 
Lindley, D. (1969), Introduction to Probability and Statistics front a Bayesian 
vicivpoint, Cambridge University Press, London. 
Loveday, J. and Jarrett, D. (1992), Spatial modelling of road accident data, 
in J. Grifhths, éd., 'Mathematics in Transport 
Planning and Control", 
Clarendon Press, pp. 433-446. 
Lupton, K . , VVing, M . and Wright, C. (1998), Conceptual data structures 
and the statistical modelling of road accidents, in J. Grifhths, éd., 'Third 
I M A International Conférence on Mathematics in Transport 
Planning 
and Control', Elsevier, Oxford, pp. 267-277. 

BIBLIOGRAPHY 
346 
Lyngaard, H . and Walther, K . (1993), Dynamic modelling with mixed graphi-
cal association models. Technical Report VJ-1S23-R11, Institute for Elec­
tronic Systems, University of Aalborg. 
Madigan. D . and Mosurski, K . (1990), ' A n extension of the results of As-
mussen and Edwards on collapsibility in contingency tables', 
Biometrika 
77(2), 315-319. 
Maher, M . J. (1991), ' A new bivariate negative binomial model for accident 
frequencies', Traffic Engineering and Control 32(9), 422-423. 
Maher. M . and Mountain, L. (19S8), 'The identification of accident blackspots: 
A comparison of current methods', Accident 
Analysis 
and 
Prévention 
20(2), 143-151. 
Maher, M . and Summersgill, I. (1996), ' A comprehensive methodology for the 
fitting of prédictive accident models', Accid. Anal and Prev. 28(3), 281-
296. 
Maritz, J. and Lwin, T. (1989), Empirical Bayes Methods, second edn, Chap­
man and Hall, London. 
Maycock, G . (1985), 'Accident liability and human Factors: researching the 
relationship', Traffic Engineering and Control 26(6), 330-335. 
Maycock. G. and Hall, R. (1.984), Accidents at 4-arm roundabouts, Technical 
Report 1120, T R R L Laboratory Report Crowthorne, U . K . : Transport 
and Road Research Laboratory. 

BIBLIOGRAPHY 
347 
McCullagh, P. and Nelder, J. (19S9), Generalized Linear Models, second edn, 
Chapman and Hall, London. 
Miaou, S. and hum, H . (1993), 'Modeling vehicle accidents and highway geo­
metric design relationships', Accid. Anal, and Prev. 25(6), 689-709. 
Mohamed, W . , Diamond, I. and Smith, P. (1998), 'The determinants of in­
fant mortality in malaysia: a graphical chain modelling approach', 
J.R. 
Statist. Soc. A 161, 349-366. 
Morris, C (1983), 'Parametric empirical Bayes inference: Theory and appli­
cations', J. Amer. Statist. Assoc. 25(78), 47-65. 
Morris, C. and Christiansen, C. (1996), Hierarchical models for ranking and 
for identifying extremes, with applications, in J. Bernardo, J. Berger. 
A . Dawid and A . Smith, eds, 'Bayesian Statistics 5', Oxford University 
Press, pp. 277-296. 
Morris, C , Christiansen, C. and Pendleton. 0 . (1991), Application of new 
accident analysis methodologies, Technical report, U.S. Department of 
Transportation. 
Mountain, L., Fawaz, B. and Jarrett, D. (1996), 'Accident prediction models 
for roads with minor junctions'. Accid. Anal, and Prev. 28(6), 695-707. 
Mountain, L., Jarrett, D. and Fawaz, B. (1995), The safety effects of high­
way engineering schemes, in 'Proc. Instn Civ. Engrs Transp.', Vol. I l l , 
pp. 298-309. 

BIBLIOGRAPHY 
34S 
Mountain, L., Jarrett, D. and Wright, C. (1994), Road accident migration. 
E P S R C project, GR/G53415. 
Nicholson, A . (1985), 'The variability of accident counts', Accident 
Analysis 
and Prevention 17, 47-56. 
Pate-field, W . (1.981), ' A n efficient method of generating random R x C tables 
with given row and column totals 1, Appl. Statist. 30, 91-97. 
Persaud, B. (1991), 'Estimating accident potential of Ontario road sections', 
Transportation Research Record (1327), 47-53. 
Read, T. and Cressie, N . (1988), Goodness-of-fit Statistics for Discrete 
Multi­
variate Data, Springer-Verlag. New York. 
Robbing, H . (1955), A n empirical Bayes approach to statistics, in 'Proceedings 
of 3rd Berkeley Symp. on Math. Statist, and Prob.', Vol. 1, Univ. of 
California Press, pp. 157-164. 
Roberts, G . and Smith, A . (1993), 'Simple conditions for the convergence of the 
Gibbs sampler and Metropolis-Hastings algorithms', Stochastic Processes 
and their Applications 49, 207-216. 
Roh, J., 
Bessler, D. and Gilbert, R. (1999), 
'Traffic fatalities, 
Peltz-
man's model, and directed graphs', Accident Analysis and 
Prevention 
31(1/2), 55-62. 
Ross, G . and Preece, D . (1985), '"The negative binomial distribution 1, The 
Statistician 
34, 323-336. 

BIBLIOGRAPHY 
349 
Salminen, S. and Heiskanen, M . (1997), 'Correlations between traffic, occupa­
tional, sports and home accidents', Accid. Anal, and Prev. 29(1), 33-36. 
Santner, T. J. and Duffy, D. (1989), The Statistical Analysis of Discrete 
Data, 
Springer-Verlag, New York. 
Schluter, P., Deely, J. and Nicholson, A . (1997), 'Ranking and selecting mo­
tor vehicle accident sites by using a hierarchical Bayesian model', The 
Statistician 
46(3), 293-316. 
Shaban, 
S. (1988), 
Poisson-lognormal 
distributions, 
in E . Crow and 
K. Shimizu, eds, 'Lognormal distributions: theory and applications', Mar­
cel Dekker, New York, pp. 195-210. 
Simpson, C. (1951), 'The interpretation of interaction in contingency tables', 
J. Roy. Statist. Soc. (B) 13, 238-241. 
Smith. T., Spiegelhalter, D. and Thomas, A . (1995), 'Bayesian graphical mod­
elling applied to random effects meta-analysis', Statistics 
in 
Medicine 
14, 2685-2699. 
Spiegelhalter, D . , Best, N . and Carlin, B. (1998). 'Bayesian deviance, the 
effective number of parameters, and the comparison of arbitrarily complex 
models', unpublished paper. 
Spiegelhalter. D., Thomas, A . and Best, N . (1996), Computation on bayesian 
graphical models, ¿71 J. Bernardo. J. Berger, A . Dawid and A . Smith, eds, 
'Bayesian statistics 5', Oxford University Press, Oxford, pp. 407-425. 

BIBLIOGRAPHY 
350 
Spiegelhalter, D., Thomas, A . and Best, N . (1998), WinBUGS: 
User Manual, 
version l.l.î, 
M R C Biostatistics Unit, Cambridge. 
Stanghellini, B. (1997), 'Identification of a single-factor model using graphical 
gaussian rules'. Biometrika 
84(1), 241-244. 
Stanghellini, E., McConway, D. and Hand, D . (1999), ' A discrète variable 
chain graph for applicants for credit', Appt. Statist. 48, 239-251. 
Tarjan, R. and Yannakis, M . (1984), 'Simple linear time algorithms to test 
chordality of graphs, test acyclicity of hypegraphs, and selectively reduce 
acyclic hypergraphs', SI AM Journal on Computing 13, 566-579. 
Taylor, C. and Barker, K . (1994-1995), Injury accidents on rural single-
carriageway roads - an analysis of statsl9 data, Technical Report 304, 
T R L . 
Tunaru, R. (1999), 'Hierarchical bayesian models for road accident data', Traf-
fic Engineering 
and Control 40(6), 318-324. 
Tunaru, R. and Jarrett, D. (199Sß), A n analysis of causality for road accident 
data using graphical models, in J. Griffiths, ed., 'Third I M A International 
Conference on Mathematics in Transport Planning and Control', Elsevier, 
Oxford, pp. 279-290. 
Tunaru, R. and Jarrett, D. (19986), Graphical models for road accident data. 
Universities Transport Study Group 30th Annual Conference, Dublin. 

BIBLIOGRAPHY 
351 
Wagner, C. (1982), 'Simpson's paradox in real life 1, The American 
Statistician 
(36), 46-48. 
Wang, Y . (1996), 'Estimation problems for the two-parameter negative bino­
mial distribution', Statistics and Probability Letters 26, 113-114. 
Wedderburn, R. (1974), 'Quasi-likelihood functions, generalized linear models 
and the Gauss-Newton method', Biometrika 
61, 439-447. 
Wermuth, N . (1976), 'Analogies between multiplicative models in contingency 
tables and covariance selection', Biometrics 
32, 95-108. 
Wermuth, N . and Lauritzen, S. (1990), ' O n substantive research hypotheses, 
conditional independence graphs and graphical chain models', J. 
Roy. 
Statist. Soc. # 52(1), 21-50. 
Whittaker, J. (1990), Graphical Models in Applied Multivariate 
Statistics, W i ­
ley, Chichester. 
Whittemore, A . (1978), 'Collapsibility of multidimensional contingency ta­
bles', Journal of Royal Statistical Society B 40(3), 328-340. 
Willson, L . J., Folks, J. and Young, J. (1984), 'Multistage estimation compared 
with 
fixed-sample-size 
estimation of the negative binomial parameter k', 
Biometrics 
40, 109-117. 
Willson, L. J., Folks, J. and Young, J. (19S6), 'Complete sufficiency and max­
imum likelihood estimation for the two-parameter negative binomial dis­
tribution', Metrika 33, 349-362. 

BIBLIOGRAPHE' 
352 
Wold, H . (1954). 'Causality and econometrics'. Econometrica 
22, 162-177. 
Wold, H . (1960), ' A généralisation 
of causal chain models'. 
Econometrica 
28, 443-463. 
Wright, C , Abbess, C. and Jarrett, D. (1988), 'Estimating the régression-to-
mean effect associated with road accident black spot treatment: Towards 
a more realistic approach', Accid. Anal, and Prev. 20(3), 199-214. 
Wright, S. (1934), 'The method of path coefficients', Annals of 
Mathematical 
Statistics 5, 161-215. 
Zeger, S. and Karim, M . (1991), 'Generalized linear models with random ef-
fects; a Gibbs sampling approach', Journal of the American 
Statistical 
Association 86(413), 79-86. 

