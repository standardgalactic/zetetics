Simple geodesics and Weil-Petersson volumes of
moduli spaces of bordered Riemann surfaces
Maryam Mirzakhani
July 12, 2005
Contents
1
Introduction
1
2
Background material
8
3
Geometry of pairs of pants
13
4
Generalized McShane identity for bordered surfaces
18
5
Statement of the recursive formula for volumes
27
6
Polynomial behavior of the Weil-Petersson volume
30
7
Leading coeï¬ƒcients of volume polynomials
34
8
Integration over the moduli space
36
9
Volumes of moduli spaces of bordered Riemann surfaces
43
1
Introduction
In this paper we investigate the Weil-Petersson volume of the moduli space of
curves with marked points. We develop a method for integrating geometric
functions over these moduli spaces, and obtain an eï¬€ective recursive for-
mula for the volume Vg,n(L1, . . . , Ln) of the moduli space Mg,n(L1, . . . , Ln)
of hyperbolic Riemann surfaces of genus g with n geodesic boundary compo-
nents. We show that Vg,n(L) is a polynomial whose coeï¬ƒcients are rational
multiples of powers of Ï€. The constant term of the polynomial Vg,n(L) is
1

the Weil-Petersson volume of the traditional moduli space of closed surfaces
of genus g with n marked points.
In forthcoming papers, we will use these results to investigate problems
related to the distribution of the lengths of simple closed geodesics on hyper-
bolic surfaces, volume of Ïµâˆ’thin part of the moduli space and intersection
theory on moduli spaces of curves.
Volume of the moduli space. When studying volumes of moduli spaces of
hyperbolic Riemann surfaces with cusps, it proves fruitful to consider more
generally bordered hyperbolic Riemann surfaces with geodesic boundary
components. Given L = (L1, . . . , Ln) âˆˆ(Râ‰¥0)n, the mapping class group
Modg,n acts on the TeichmÂ¨uller space Tg,n(L) of hyperbolic structures with
geodesic boundary components of length L1, . . . , Ln. We study the Weil-
Petersson volume of the quotient space
Mg,n(L) = Tg,n(L)/ Modg,n .
Our main result, obtained in Â§6, is:
Theorem 1.1. The volume Vg,n(L1, . . . , Ln) = Volwp(Mg,n(L)) is a poly-
nomial in L1, . . . , Ln; namely we have:
Vg,n(L) =

Î±
|Î±|â‰¤3gâˆ’3+n
CÎ± Â· L 2Î±,
where CÎ± > 0 lies in Ï€6gâˆ’6+2nâˆ’|2 Î±| Â· Q.
Here the exponent Î± = (Î±1, . . . , Î±n) ranges over elements in (Zâ‰¥0)n ,
LÎ± = LÎ±1
1 Â· Â· Â· LÎ±n
n , and |Î±| =
n
i=1
Î±i.
Moreover, in Â§5 we give an explicit recursive formula for calculating these
volumes. For example, we have:
V1,1(L) = L2/24 + Ï€2/6.
For more examples see Table 1.
In particular, the Weil-Petersson volume of the moduli space of curves
of genus g with n marked point, the constant term of Vg,n(L), is a rational
multiple of Ï€6gâˆ’6+2n. This result was previously obtained by S. Wolpert
[Wol2]. A formula for Vol0,n(0), the Weil-Petersson volume of M0,n, was
obtained in [Zo].
Remark. Note that there is a diï¬€erence in the normalization of the volume
form; in [Zo] the Weil-Petersson KÂ¨ahler form is 1/2 the imaginary part of
2

Table 1. Volumes of moduli spaces of curves
g
n
Vg,n(L)
0
3
1
1
1
1
24(L2 + 4Ï€2)
0
4
1
2(4Ï€2 + L2
1 + L2
2 + L2
3 + L2
4)
1
2
1
192(4Ï€2 + L2
1 + L2
2)(12Ï€2 + L2
1 + L2
2)
0
5
1
8

80Ï€4 +
5
i=1
L4
i + 4

1â‰¤i<jâ‰¤5
L2
i L2
j + 24Ï€2
5
i=1
L2
i

2
1
1
2211840

4Ï€2 + L2
1) (12Ï€2 + L2
1) (6960Ï€4 + 384 Ï€2 L2
1 + 5 L4
1)
the Weil-Petersson pairing, while here we work with the imaginary part of
the pairing. So our answers are diï¬€erent by a power of 2.
We approach the calculation of these volumes by studying the lengths of
simple closed geodesics on X âˆˆMg,n. Our main tool is a generalization of
McShaneâ€™s identity [M], which gives us a way to calculate the volume of the
moduli space Mg,n = Tg,n/ Modg,n without having to ï¬nd a fundamental
domain for the action of the mapping class group on TeichmÂ¨uller space.
McShane identity. Our point of departure for calculating these volume
polynomials is the following result [M]:
Theorem 1.2 (McShane). Let X be a hyperbolic once-punctured torus.
Then we have

Î³
(1 + eâ„“Î³(X))âˆ’1 = 1
2,
(1.1)
3

where the sum is over all simple closed geodesics Î³ on X.
Calculation of Vol(M1,1). We brieï¬‚y explain the relation between Mc-
Shaneâ€™s identity and Weil-Petersson volumes by treating the case g = n = 1.
Consider the space of pairs:
Mâˆ—
1,1 = {(X, Î³) | X âˆˆM1,1, Î³ a simple closed geodesic on X},
and let
Ï€ : Mâˆ—
1,1 â†’M1,1
be the projection map, deï¬ned by Ï€(X, Î³) = X. Also, deï¬ne â„“: Mâˆ—
1,1 â†’R
by
â„“(X, Î³) = â„“Î³(X).
Then we can rewrite (1.1) as

Ï€(Y )=X
f(â„“(Y )) = 1
2,
(1.2)
where f(x) = (1 + ex)âˆ’1.
For any simple closed curve Î± on a hyperbolic once punctured torus, we
have Mâˆ—
1,1 = T1,1/ Stab(Î±). Now we use the Fenchel-Nielsen coordinates for
T1,1 about Î±; Any element (X, Î³) âˆˆMâˆ—
1,1 is determined by the pair (â„“, Ï„),
the length and the twisting parameter of X around Î³. Note that we have
Ï†Î³(â„“, Ï„) = (â„“, â„“+ Ï„), where Ï†Î³ denotes a right Dehn twist around Î³. Hence
we have
Mâˆ—
1,1 âˆ¼= {(â„“, Ï„)|0 â‰¤â„“â‰¤Ï„}

(x, 0) âˆ¼(x, x).
The Weil-Petersson symplectic form in Fenchel-Nielsen coordinates is
given by Ï€âˆ—(Ï‰wp) = dâ„“âˆ§dÏ„. Therefore, we have

M1,1

Ï€(Y )=X
f(â„“(Y )) dX =

Mâˆ—
1,1
f(â„“(Y )) dY =
âˆ

0
f(x)
x

0
1 dy dx.
Integrating McShaneâ€™s identity (1.2) over M1,1 against the Weil-Petersson
volume form, we obtain
Vol(M1,1) = 2
âˆ

0
â„“f(â„“) dâ„“= 2
âˆ

0
â„“
1 + eâ„“dâ„“= Ï€2
6 .
Calculation of Vg,n. To carry out a similar analysis for Mg,n we will:
4

(I): Generalize McShane identity (Theorem 1.2) to arbitrary hyperbolic
surfaces with geodesic boundary components (Â§4), and
(II): Develop a method to integrate functions given in terms of the hy-
perbolic length functions over the moduli space (Â§8).
The result is a recursive formula for the volume polynomial Vg,n(L) ob-
tained in Â§9.
We now turn into a more detailed account of two main steps of the proof:
(I): Generalized McShaneâ€™s identity.
McShane [M] gives a version
of formula (1.1) for punctured Riemann surfaces of higher genus. In our
discussion, we need a further generalization to bordered Riemann surfaces
with geodesic boundary components. Roughly speaking, we want to ï¬nd a
function deï¬ned on TeichmÂ¨uller space such that the sum of its values over
the elements of each orbit of Modg,n is a constant independent of the orbit.
In Â§3 we introduce two auxiliary functions D, R : R3
+ â†’R+ related to the
geometry of hyperbolic pairs of pants. A central role in our approach to
volumes of moduli spaces is played by the following result (Â§4 ):
Theorem 1.3. For any hyperbolic surface X with n geodesic boundary com-
ponents Î²1,. . . ,Î²n of lengths L1, . . . , Ln, we have

{Î±1,Î±2}
D(L1, â„“Î±1(X), â„“Î±2(X)) +
n

i=2

Î³
R(L1, Li, â„“Î³(X)) = L1.
(1.3)
Here the ï¬rst sum is over all unordered pairs of simple closed geodesics
{Î±1, Î±2} bounding a pair of pants with Î²1, and the second sum is over simple
closed geodesics Î³ bounding a pairs of pants with Î²1 and Î²i.
In the formula above, we also allow Î²i to be a cusp of X, by regarding it as
a geodesic of length 0.
As a special case, for any hyperbolic surface X of genus one with one
geodesic boundary component of length L, we get

Î³
D(L, â„“Î³(X), â„“Î³(X)) = L,
(1.4)
where the sum is over all simple closed geodesics Î³ on X. On the other
hand, we have (Â§3)
D(x, y, y) âˆ¼
2x
1 + ey
as x â†’0, therefore our formula for genus one hyperbolic surfaces with one
geodesic boundary component (1.4) implies the original McShane identity
(1.1) when L â†’0.
5

(II): Integration over the moduli space. In Â§8, we develop a method for
integrating the right hand side of the identity for the lengths of simple closed
geodesics (1.3) over Mg,n(L).
Working with bordered Riemann surfaces
allows us to exploit the existence of commuting Hamiltonian S1-actions on
certain coverings of the moduli space in order to integrate certain geometric
functions over the moduli space of curves.
Let Sg,n be a closed surface of genus g with n boundary components and
Y âˆˆTg,n. For any simple closed curve Î³ on Sg,n, let [Î³] denote the homo-
topy class of Î³ and let â„“Î³(Y ) denote the hyperbolic length of the geodesic
representative of [Î³] on Y .
To each simple closed curve Î³ on Sg,n, we associate the set
OÎ³ = {[Î±] |Î± âˆˆModg,n Â·Î³}
of homotopy classes of simple closed curves in the Modg,n-orbit of Î³ on
X âˆˆMg,n. For any function f : R+ â†’R+,
fÎ³(X) =

[Î±]âˆˆOÎ³
f(â„“Î±(X)),
deï¬nes a function
fÎ³ : Mg,n â†’R.
Here we sketch the main idea of calculating the integral of fÎ³ over Mg,n with
respect to the Weil-Petersson volume form when Î³ is a connected simple
closed curve. See Theorem 8.1 for the general case.
First, consider the covering space of Mg,n
Ï€Î³ : MÎ³
g,n = {(X, Î±) | X âˆˆMg,n, and Î± âˆˆOÎ³ is a geodesic on X } â†’Mg,n,
where Ï€Î³(X, Î±) = X. The hyperbolic length function descends to the func-
tion,
â„“: MÎ³
g,n â†’R
deï¬ned by â„“(X, Î·) = â„“Î·(X). Therefore, we have

Mg,n
fÎ³(X) dX =

MÎ³
g,n
f â—¦â„“(Y ) dY.
On the other hand, The function f is constant on each level set of â„“and we
have

MÎ³
g,n
f â—¦â„“(Y ) dY =
âˆ

0
f(t) Vol(â„“âˆ’1(t)) dt,
6

where the volume is taken with respect to the volume form âˆ’âˆ—dâ„“on â„“âˆ’1(t).
The main idea for integrating over MÎ³
g,n is that the decomposition of the
surface along Î³ gives rise to a description of MÎ³
g,n in terms of moduli spaces
corresponding to simpler surfaces. This leads to formulas for the integral
of fÎ³ in terms of the Weil-Petersson volumes of moduli spaces of bordered
Riemann surfaces and the function f.
Let Sg,n(Î³) be the result of cutting the surface Sg,n along Î³; that is
Sg,n(Î³) âˆ¼= Sg,n âˆ’UÎ³, where UÎ³ is an open neighborhood of Î³ homeomorphic
to Î³ Ã— (0, 1). Thus Sg,n(Î³) is a possibly disconnected compact surface with
n+2 boundary components. We deï¬ne M(Sg,n(Î³), â„“Î³ = t) to be the moduli
space of Riemann surfaces homeomorphic to Sg,n(Î³) such that the lengths
of the 2 boundary components corresponding to Î³ are equal to t. We have
a natural circle bundle
â„“âˆ’1(t) âŠ‚MÎ³
g,n
ï£¦ï£¦
M(Sg,n(Î³), â„“Î³ = t)
We will study the S1-action on the level set â„“âˆ’1(t) âŠ‚MÎ³
g,n induced by
twisting the surface along Î³. The quotient space â„“âˆ’1(t)/S1 inherits a sym-
plectic form from the Weil-Petersson symplectic form. On the other hand,
M(Sg,n(Î³), â„“Î³ = t) is equipped with the Weil-Petersson symplectic form.
By investigating these S1-actions in more detail in Â§8 we show that
â„“âˆ’1(t)/S1 âˆ¼= M(Sg,n(Î³), â„“Î³ = t)
as symplectic manifolds. So we expect to have
Vol(â„“âˆ’1(t)) = t Vol(M(Sg,n(Î³), â„“Î³ = t)).
But as we will see in Â§8, the situation is diï¬€erent when Î³ seperates oï¬€a
one-handle in which case the length of the ï¬ber at a point is in fact t/2
instead of t. For any connected simple closed curve Î³ on Sg,n, we have

Mg,n
fÎ³(X) dX = 2âˆ’M(Î³)
âˆ

0
f(t) t Vol(M(Sg,n(Î³), â„“Î³ = t)) dt,
(1.5)
where M(Î³) = 1 if Î³ seperates oï¬€a one-handle, and M(Î³) = 0 otherwise.
An alternative proof of Theorem 1.1. The method of symplectic reduc-
tion can be used to show that Vg,n(L) is a polynomial in L. In a sequel, we
obtain a formula for Vg,n(L) in terms of intersection numbers of tautological
7

classes over Mg,n. However, this symplectic method does not lead us to a
recursive algorithm for calculating the volumes explicitly.
Applications. In forthcoming papers, we will study the connection of the
polynomial Vg,n(L) with the length distribution of simple closed geodesics on
a hyperbolic surface [Mirz1]. We also relate the coeï¬ƒcients of the volume
polynomial Vg,n(L) to intersection numbers of tautological line classes on
Mg,n [Mirz2]. The algorithm for calculating Vg,n(L) presented in Â§5 leads
to a new proof of the Virasoro constraints for a point which is equivalent to
the Witten-Kontsevich formula [K].
Notes and references. The Weil-Petersson volume of the moduli space
of punctured Riemann surfaces arises naturally in diï¬€erent contexts[KMZ].
A recursive formula for the Weil-Petersson volume of the moduli space of
punctured spheres was obtained by Zograf [Zo]. Moreover, Zograf and Manin
have obtained generating functions for the Weil-Petersson volume of Mg,n
[MaZ]. Also, R. Penner has developed a diï¬€erent method for calculating the
Weil-Petersson volume of the moduli spaces of curves with marked points
by using decorated TeichmÂ¨uller theory and calculated the Weil-Petersson
volume of M1,2 [Pen]. The volume polynomial V1,1(L) was also previously
obtained in [NN] by ï¬nding a fundamental domain for the action of the
mapping class group on TeichmÂ¨uller space.
Acknowledgments. I would like to thank Curt McMullen for his invaluable
help and many stimulating discussions over the course of this work. I am also
grateful to Said Akbari, Izzet Coskun, Maxim Kontsevich, Chiu-Chu Melissa
Liu, Andrei Okounkov, Rahul Pandharipandeh, S.T. Yau and Igor Riven for
helpful discussions. I would like to thank Greg McShane and Scott Wolpert
for many helpful comments and dscussions. The author would also like to
thank the Max Planck Institute of Mathematics in Leipzig and the Institute
for Studies in Theoretical Physics and Mathematics (IPM) in Tehran for
their hospitality during the writing of this paper.
2
Background material
In this section, We present some familiar concepts in a less familiar setting
about the symplectic structure of the moduli space of bordered Riemann
surfaces and the space of measured geodesic laminations.
we also recall
some basic facts and results on hyperbolic geometry.
Recall that a symplectic structure on a manifold M is a non-degenerate
8

closed 2-form Ï‰ âˆˆâ„¦2(M). The n-fold wedge product
1
n! Ï‰ âˆ§Â· Â· Â· âˆ§Ï‰
never vanishes and deï¬nes a volume form on M.
TeichmÂ¨uller Space. Here we brieï¬‚y summarize the background material
on TeichmÂ¨uller theory of Reimann surfaces with geodesic boundary compo-
nents.
A point in the TeichmÂ¨uller space T (S) is a complete hyperbolic surface X
equipped with a diï¬€eomorphism f : S â†’X. The map f provides a marking
on X by S. Two marked surfaces f : S â†’X and g : S â†’Y deï¬ne the
same point in T (S) if and only if f â—¦gâˆ’1 : Y â†’X is isotopic to a con-
formal map. When âˆ‚S is nonempty, consider hyperbolic Riemann surfaces
homeomorphic to S with geodesic boundary components of ï¬xed length.
Let A = âˆ‚S and L = (LÎ±)Î±âˆˆA âˆˆR|A|
+ . A point X âˆˆT (S, L) is a marked
hyperbolic surface with geodesic boundary components such that for each
boundary component Î² âˆˆâˆ‚S, we have
â„“Î²(X) = LÎ².
Let Sg,n be an oriented connected surface of genus g with n boundary com-
ponents (Î²1, . . . , Î²n). Then
Tg,n(L1, . . . , Ln) = T (Sg,n, L1, . . . , Ln),
denote the TeichmÂ¨uller space of hyperbolic structures on Sg,n with geodesic
boundary components of length L1, . . . , Ln. By convention, a boundary
geodesic of length zero is a cusp and we have
Tg,n = Tg,n(0, . . . , 0).
Let Mod(S) denote the mapping class group of S, or the group of isotopy
classes of orientation preserving self homeomorphisms of S leaving each
boundary component set wise ï¬xed. The mapping class group Modg,n =
Mod(Sg,n) acts on Tg,n(L) by changing the marking. The quotient space
Mg,n(L) = M(Sg,n, â„“Î²i = Li) = Tg,n(L1, . . . , Ln)/ Modg,n
is the moduli space of Riemann surfaces homeomorphic to Sg,n with n
boundary components of length â„“Î²i = Li. Also, we have
Mg,n = Mg,n(0, . . . , 0).
9

For a disconnected surface S =
k	
i=1
Si such that Ai = âˆ‚Si âŠ‚âˆ‚S, we have
M(S, L) =
k

i=1
M(Si, LAi),
where LAi = (Ls)sâˆˆAi.
The Weil-Petersson symplectic form. By work of Goldman [Gol], the
space Tg,n(L1, . . . , Ln) carries a natural symplectic form invariant under the
action of the mapping class group. Th is symplectic form is called Weil-
Petersson symplectic form, and denoted by Ï‰ or Ï‰wp. In this paper, we
are interested in calculating the volume of the moduli space with respect to
the volume form induced by the Weil-Petersson symplectic form. Note that
when S is disconnected, we have
Vol(M(S, L)) =
k

i=1
Vol(M(Si, LAi)).
The Fenchel-Nielsen coordinates. A pants decomposition of S is a set of
disjoint simple closed curves which decompose the surface into pairs of pants.
Fix a system of pants decomposition of Sg,n, P = {Î±i}k
i=1, where k = 6gâˆ’6+
2n. For a marked hyperbolic surface X âˆˆTg,n(L), the Fenchel-Nielsen coor-
dinates associated with P, {â„“Î±1(X), . . . , â„“Î±k(X), Ï„Î±1(X), . . . , Ï„Î±k(X)}, con-
sists of the set of lengths of all geodesics used in the decomposition and
the set of the twisting parameters used to glue the pieces.
We have an
isomorphism
Tg,n(L) âˆ¼= RP
+ Ã— RP
by the map
X â†’(â„“Î±i(X), Ï„Î±i(X)).
By work of Wolpert, over TeichmÂ¨uller space the Weil-Petersson symplectic
structure has a simple form in Fenchel-Nielsen coordinates [Wol1].
Theorem 2.1 (Wolpert). The Weil-Petersson symplectic form is given by
Ï‰wp =
k

i=1
dâ„“Î±i âˆ§dÏ„Î±i.
Twisting. For any simple closed geodesic Î± on X âˆˆTg,n(L) and t âˆˆR, we
can deform the hyperbolic structure as follows. We cut the surface along Î±,
10

turn left hand side of Î± in the positive direction the distance t and reglue
back. Let us denote the new surface by twtÎ±(X). As t varies, the resulting
continuous path in TeichmÂ¨uller space is the Fenchel-Nielsen deformation of
X along Î±. For t = â„“Î±(X), we have
twtÎ±(X) = Ï†Î±(X),
where Ï†Î± âˆˆMod(Sg,n) is a right Dehn twist about Î±.
By Wolpertâ€™s result (Theorem 2.1), the vector ï¬eld generated by twisting
around Î± is symplectically dual to the exact one form dâ„“Î±. In other words,
twtÎ± is the Hamiltonian ï¬‚ow of the length function.
Splitting along a simple closed curve.
Î±
Î±2
Î±1
Î²2
Î²4
Î²1
Î²2
Î²1
Î²3
Î²3
Î²4
Figure 1. Cutting the surface
Let Î³
Î³ =
k

i=1
ciÎ³i,
where Î³1, . . . and Î³k are distinct, disjoint simple closed curves, be the isotopy
class of a multi curve on Sg,n.
Consider the surface Sg,n âˆ’UÎ³, where UÎ³ is an open set homeomorphic
to 	k
1(0, 1) Ã— Î³i around Î³.
We denote this surface by Sg,n(Î³), which is
a (possibly disconnected) surface with n + 2k boundary components and
s = s(Î³) connected components. Each connected component Î³i of Î³, gives
rise to 2 boundary components, Î³1
i and Î³2
i on Sg,n(Î³). Namely,
âˆ‚(Sg,n(Î³)) = {Î²1, . . . , Î²n} âˆª{Î³1
1, Î³2
1, . . . , Î³1
k, Î³2
k}.
Now for Î“ = (Î³1, . . . , Î³k), L = (L1, . . . , Ln) and x = (x1, . . . , xk) âˆˆRk
+, let
M(Sg,n(Î³), â„“Î“ = x, â„“Î² = L)
11

be the moduli space of hyperbolic Riemann surfaces homeomorphic to Sg,n(Î³)
such that â„“Î³i = xi and â„“Î²i = Li. Also, deï¬ne Vg,n(Î“, x, Î², L) by
Vg,n(Î“, x, Î², L) = Vol(M(Sg,n(Î³), â„“Î“ = x, â„“Î² = L)).
We can write Sg,n(Î³) as a union of its connected components
Sg,n(Î³) =
s
i=1
Sgi,ni , Ai = âˆ‚Si âŠ‚B.
(2.1)
Then in terms of the above notation, we have
M(Sg,n(Î³), â„“Î“ = x, â„“Î² = L) âˆ¼=
s

i=1
Mgi,ni(â„“Ai),
where â„“Ai = (â„“Î±)Î±âˆˆAi, and consequently we get
Vg,n(Î“, x, Î², L) =
s

i=1
Vgi,ni(â„“Ai).
Symmetry group of a multi curve. For any set A of homotopy classes
of simple closed curves on Sg,n, deï¬ne Stab(A) by
Stab(A) = {h âˆˆModg,n | h Â· A = A} âŠ‚Modg,n .
For Î³ =
k
i=1
ciÎ³i, deï¬ne the symmetry group of Î³, Sym(Î³), by
Sym(Î³) = Stab(Î³)/ âˆ©k
i=1 Stab(Î³i).
In fact, when Î³ has extra symmetry
k
i=1
Stab(Î³i) Ì¸= Stab(Î³).
First, for any connected simple closed curve Î±, | Sym(Î±)| = 1.
Note | Sym(Î³)| Ì¸= 1 for
Î³ =
k

i=1
ciÎ³i
will put a non trivial condition on the câ€²
is.
For example | Sym(Î³)| = k!
implies that c1 = c2 = . . . = ck.
12

When k = 2, by the deï¬nition
| Sym(Î³1 + Î³2)| = 2
if and only if Sg,n(Î³1) is homeomorphic to Sg,n(Î³2).
Here we want the
homemorphisem to ï¬x each boundary component of âˆ‚(Sg,n) setwise, and
send Î³1 to Î³2.
Later we will be interested in the case where Î³ bounds a pair of pants with
a boundary component of Sg,n. It is easy to check that | Sym(Î³1 + Î³2)| = 2
if and only either Sg,n(Î³) is connected or
Sg,n(Î³) âˆ¼= Sg1,1 âˆªSg1,1.
Simple closed curves on X âˆˆMg,n. Let [Î³] denotes the homotopy class
of a simple closed curve Î³ on Sg,n. Although there is no canonical simple
closed geodesic on X âˆˆMg,n corresponding to [Î³], the set
OÎ³ = {[Î±]| Î± âˆˆMod Â·Î³},
of homotopy classes of simple closed curves in the Modg,n-orbit of Î³ on X, is
determined by Î³. In other words, OÎ³ is the set of [Ï†(Î³)] where Ï† : Sg,n â†’X
is a marking of X. Let â„“Î±(X) denote the hyperbolic length of Î± on X. Here,
we study functions of the form
fÎ³ : Mg,n â†’R+
X â†’

Î±âˆˆOÎ³
f(â„“Î±(X)),
where f : R â†’R+.
As an example, for f = Ï‡[0, L), the characteristic function of [0, L), fÎ³(X)
is equal to the number of elements of OÎ³ of length less than L on X.
3
Geometry of pairs of pants
In this section we study inï¬nite simple geodesic rays on a hyperbolic pair
of pants. For background on hyperbolic geometry see [Bus].
A pair of pants is an oriented compact surface homeomorphic to S0,3, a
surface of genus-0 with three boundary components.
Let C(x1, x2, x3) be the unique hyperbolic pair of pants with geodesic
boundary curves (Î²i)3
i=1 such that â„“Î²i(C) = xi, i = 1, 2, 3. We also allow the
degenerate case in which one or more of the lengths vanish.
13

Î²3
Î²2
y1
w2
w1
z1
Î²1
Figure 2. complete geodesics in a pair of pants
Each boundary component of C has two canonical points, the end points
of the length minimizing geodesics connecting it to the other two boundary
components.
On the other hand, we can obtain C(x1, x2, x3) by pasting two copies
of the (unique) right angled geodesic hexagons with pairwise non-adjacent
sides of length x1/2, x2/2 and x3/2 along the remaining three sides. Thus
C(x1, x2, x3) admits a reï¬‚ection involution Ïƒ which interchanges the two
hexagons.
Complete geodesics on hyperbolic a pair of pants. A hyperbolic pair
of pants contains 5 complete geodesics disjoint from Î²2, Î²3 and orthogonal
to Î²1. More precisely, 2 of these geodesics meet Î²1 at y1 and y2 and spiral
around Î²3, the other 2 meet Î²1 at z1 and z2 and spiral around Î²2. There
is also a unique common simple geodesic perpendicular from Î²1 to itself
meeting Î²1 perpendicularly at 2 points, w1 and w2.
Note that we have
Ïƒ(w1) = w2, Ïƒ(z1) = z2, and Ïƒ(y1) = y2. See Figure 2.
Deï¬nitions. Deï¬ne R(x1, x2, x3) to be the geodesic length of (y1, y2), the
interval between y1 and y2 along Î²1 containing w1 and w2.
For caclulating
the function R, we consider the universal cover of C. Then it is easy to check
that
x1 âˆ’R(x1, x2, x3)
is equal to the geodesic length of the projection of Î²3 on Î²1. See Figure 3.
Note that this length does not depend on the choice of the lift of C.
Also, deï¬ne D(x1, x2, x3) to be the sum of the geodesic length of (y1, z1)
and (y2, z2), the interval between yi and zi containing wi on Î²1.
So the
14

p1
p2
p3
Î²1
Î²3
r3
r2
r1
Figure 3. Projection of a geodesic
function D(x1, x2, x3) is twice the geodesic distance between two geodesics
perpendicular to Î²1 spiraling around Î²2 and Î²3. Equivalently in the universal
cover of C, D(x1, x2, x3) equals 2 times the distance between the projection
of Î²2 and Î²3 on Î²1.
Also, deï¬ne H : R2 â†’R by
H(x, y) =
1
1 + e
x+y
2
+
1
1 + e
xâˆ’y
2
.
Basic properties of D and R. It can be easily checked that the functions
D and R satisfy
D(x1, x2, x3) = D(x1, x3, x2),
and
R(x1, x2, x3) + R(x1, x3, x2) = x1 + D(x1, x2, x3).
Moreover, one can explicitly calculate these functions and show that:
Lemma 3.1. The functions D and R are given by
D(x, y, z) = 2 log

e
x
2 + e
y+z
2
e
âˆ’x
2 + e
y+z
2

,
(3.1)
and
R(x, y, z) = x âˆ’log
cosh(y
2) + cosh(x+z
2 )
cosh(y
2) + cosh(xâˆ’z
2 )

.
(3.2)
15

Proof. It is enough to calculate R(x, y, z). Using basic trigonometry (e.g.
Theorem 2.3.1 of [Bus]) in any geodesic quadrilateral with three right angles
and consecutive sides of lengths a, b, inï¬nity and inï¬nity (when one vertex
is on the boundary at inï¬nity ), we have
Sinh(a) Â· Sinh(b) = 1.
(3.3)
Let r3 p3 be the unique geodesic perpendicular to Î²3 and Î²1. Now by apply-
ing formula (3.3) to two geodesic quadrilaterals r1 r3 p1 p3 and r3 r2 p3 p2
in Figure 3, we have
R(x1, x2, x3) = x1 âˆ’2 arcsinh

1
sinh(d(Î²1, Î²3))

.
On the other hand by cutting the pairs of pants along the shortest geodesics
joining distinst boundary components, we obtain two convex right-angled
geodesic hexagons with consecutive sides of lengths x1/2, d(Î²1, Î²2), x2/2,
d(Î²2, Î²3), x3/2 and d(Î²3, Î²1). This means that x1, x2 and x3 uniquely de-
termine d(Î²1, Î²3). Using basic trigonometry of hyperbolic hexagons ( e.g.
Theorem 2.4.1 in [Bus] ), we get
cosh(d(Î²1, Î²3)) = cosh(x2
2 ) + cosh(x3
2 ) cosh(x1
2 )
sinh(x3
2 ) sinh(x1
2 )
.
See Â§2 of [Bus] for more details.
On the other hand, since arcsinh(z) = log(z +
âˆš
z2 + 1) we have
2 arcsinh

1
sinh(Î±)

= 2 log

1
sinh(Î±) + cosh(Î±)
sinh(Î±)

= log
cosh(Î±) + 1
cosh(Î±) âˆ’1

,
therefore,
R(x1, x2, x3) = x1 âˆ’log
 cosh(d(Î²1, Î²3) + 1
cosh(d(Î²1, Î²3)) âˆ’1

,
which implies equation 3.2.
2
Remark. Equation (3.1) shows that D is a function of x and y + z. Next
lemma allows us to simplify integrals involving D and R :
Lemma 3.2. The functions D, R : R+ â†’R+ satisfy the following equations:
âˆ‚
âˆ‚xD(x, y, z) = H(y + z, x),
(3.4)
and
âˆ‚
âˆ‚xR(x, y, z) = 1
2(H(z, x + y) + H(z, x âˆ’y)).
(3.5)
16

Proof. Equation (3.4) is a straight forward calculation from equation (3.1),
since we have
âˆ‚
âˆ‚xD(x, y, z) =
ex/2
ex/2 + e(y+z)/2 +
eâˆ’x/2
eâˆ’x/2 + e(y+z)/2 = H(y + z, x).
On the other hand, using Lemma 3.1, one can show that
D(x, y, z) + D(x, âˆ’y, z) = 2 R(x, y, z)
which implies (3.5).
2
Asymptotic behavior of D and R. Functions D and R are continuous
on R3
+. As 0 < D(x, y, z) â‰¤x and 0 < R(x, y, z) â‰¤x, both D(x, y, z) and
R(x, y, z) go to zero when x â†’0. By using Lemma 3.2 it is easy to verify
that
D(x, y, z) âˆ¼x H(y + z, x) âˆ¼
2x
1 + e
y+z
2
,
(3.6)
R(x, y, z) âˆ¼x

1
1 + e
z+y
2
+
1
1 + e
zâˆ’y
2

, R(x, x, z) âˆ¼
2x
1 + e
z
2 ,
(3.7)
as x â†’0.
Moreover, we have:
Lemma 3.3. There are constants c1, c2 > 0 such that for any x â‰¤1 we
have

D(x, y, z)
x
âˆ’
1
1 + e
y+z
2
 â‰¤c1 x e
âˆ’(y+z)
2
,

R(x, y, z)
x
âˆ’

1
1 + e
z+y
2
+
1
1 + e
zâˆ’y
2
 â‰¤c2 x e
âˆ’z
2 .
Also, when x and y are ï¬xed numbers as z â†’âˆ, we have
R(x, y, z) â†’0,
similarly, when x is a ï¬xed number as y, z â†’âˆ,
D(x, y, z) â†’0.
17

4
Generalized McShane identity for bordered sur-
faces
In this section, we generalize McShaneâ€™s identity for bordered hyperbolic
Riemann surfaces with geodesic boundary components.
Embedded Pairs of pants. We say three isotopy classes of connected
simple closed curves, (Î±1, Î±2, Î±3) on Sg,n, bound a pair of pants if there
exists an embedded pair of pants Î£ âŠ‚Sg,n such that âˆ‚Î£ = {Î±1, Î±2, Î±3}.
Here Î±i can be a boundary component and we consider punctures as simple
closed geodesics of length 0. The statement of Theorem 1.3 motivates the
following deï¬nitions.
â€¢ For 1 â‰¤i â‰¤n, let Fi be the set of unordered pairs of isotopy classes of
simple closed curves {Î±1, Î±2} bounding a pairs of pants with Î²i such
that Î±1, Î±2 Ì¸âˆˆâˆ‚(Sg,n);
â€¢ For 1 â‰¤i Ì¸= j â‰¤n, let Fi,j be the set of isotopy classes of simple closed
curves Î³ bounding a pairs of pants containing Î²i and Î²j.
An identity for lengths of simple closed geodesics. First we state
an identity for lengths of simple closed geodesics on hyperbolic punctured
surfaces due to G. McShane [M]:
Theorem 4.1. Let {pi}n
1 be the set of punctures of X âˆˆTg,n. Then we have

{Î±1,Î±2}âˆˆF1
1
1 + e
â„“Î±1 (X)+â„“Î±2 (X)
2
+
n

i=2

Î³âˆˆF1,i
1
1 + e
â„“Î³ (X)
2
= 1
2.
We will use the properties of functions D, R : R3
+ â†’R+, deï¬ned in the
preceding section, and the geometry of complete simple geodesics on a hy-
perbolic surface to get the following result for hyperbolic bordered Riemann
surfaces with geodesic boundary components:
Theorem 4.2 (Generalized McShane identity for bordered sur-
faces). For any X âˆˆTg,n(L1, . . . , Ln) with 3g âˆ’3 + n > 0, we have

{Î±1,Î±2}âˆˆF1
D(L1, â„“Î±1(X), â„“Î±2(X)) +
n

i=2

Î³âˆˆF1,i
R(L1, Li, â„“Î³(X)) = L1. (4.1)
Note that as L1 â†’0 both sides of (4.1) tend to zero and Î²1 tends to a
puncture p1. Using (3.6) and (3.7), the following Corollary is an immediate
result of Theorem 4.2 :
18

Corollary 4.3. For any X âˆˆTg,n(0, L2, . . . , Ln) with 3g âˆ’3 + n > 0, we
have

{Î±1,Î±2}âˆˆF1
1
1 + e
â„“Î±1 (X)+â„“Î±2 (X)
2
+
n

i=2

Î³âˆˆF1,i
1
2

1
1 + e
â„“Î³ (X)+Li
2
+
1
1 + e
â„“Î³ (X)âˆ’Li
2

= 1
2.
(4.2)
Notice that corollary 4.3 implies Theorem 4.1.
Remark. To prove Theorem 4.2, we basically follow the proof presented
in [M] almost line for line by relating the topology of the union of complete
simple geodesics perpendicular to all boundary components to the global
behavior of simple closed geodesics. See also [B] for a related result for the
lengths of common orthogonals of two totally geodesic hypersurfaces on a
hyperbolic manifold.
Union of complete simple geodesics.
Let E(X) be the union of all
simple complete geodesics perpendicular to all boundary components and
Ei = E âˆ©Î²i.
Given x âˆˆEi, let Î³x, the geodesic emanating from x, denote the complete
simple geodesic perpendicular to Î²i such that x âˆˆÎ³x.
Theorem 4.4. The set Ei âŠ‚Î²i, deï¬ned as above, has measure zero.
Proof. By a result due to Birman and Series [BS], the union of all com-
plete geodesics on a closed surface has Hausdorï¬€dimension 1. Doubling the
bordered surface along its boundary components shows that the same state-
ment holds for a bordered surface. That is Âµ(E) = 0. Therefore, E âˆ©UÎ²i
has measure zero , where UÎ²i is the collar neighborhood around Î²i. Because
of the structure of the collar neighborhood we have
Âµ(E âˆ©UÎ²i) = sinh r Ã— Âµ(Ei),
where r is the width of the collar neighborhood. So Âµ(E âˆ©UÎ²i) = 0 implies
that Âµ(Ei) = 0.
2
Later we show that:
Theorem 4.5. Each Ei is homeomorphic to the Cantor set union countably
many isolated points.
19

Characterization of boundary and isolated points in Ei. In this part
we give a characterization of boundary and isolated points in Ei. We say
a lamination Î³ spirals to a lamination â„¦(Î³) iï¬€â„¦(Î³) is in the closure of Î³.
It can be easily checked that when Î³ is a ray, â„¦(Î³) is actually a minimal
lamination. Note that for x âˆˆEi, the corresponding simple geodesic ray, Î³x
falls into exactly one of the following two classes.
1. The other end spirals into a compact minimal lamination inside the
surface, which will be denoted by â„¦(Î³x).
2. The other end also approaches a (not necessarily distinct) boundary
component Î²i in which case either the ray Î³x meets Î²i perpendicularly
or spirals around it.
We will prove the following classiï¬cation of points in Ei in terms of the
behavior of the corresponding complete simple geodesics (See [M]) :
Theorem 4.6. For any x âˆˆEi, exactly one of the following holds:
a) The point x is an isolated point of Ei if the other end of Î³x approaches a
boundary component.
b) If â„¦(Î³x) is a not a simple closed curve then x is neither a boundary nor
an isolated point in Ei.
c) The point x is a boundary point of Ei if â„¦(Î³x) is a simple closed curve
inside the surface.
Figure 4. Finding the pair of pants containing a simple geodesic
Notice that, as shown in Figure 4, for any Î³ joining two boundary compo-
nents, there exists a unique embedded pair of pants containing Î³ and these
(not necessarily distinct) boundary components.
Also in each pair of pants containing two (not necessarily distinct) bound-
ary components, there exists a unique simple geodesic joining them perpen-
dicularly.
20

Proof of Theorem 4.6(a). let x = x1 âˆˆX1 be such that the other end of
Î³x goes up to Î²1 and let x2 âˆˆÎ²1 be such that
Î³x âˆ©Î²1 = {x, x2}.
One can easily modify the argument for other cases. Let Î£ denote the pair
of pants containing Î³x1 such that âˆ‚Î£ = {Î²1, Î±1, Î±2}. There are precisely 4
inï¬nite geodesic rays in Î£ meeting Î²1 perpendicularly at one point (as in
Figure 1). Let Î³yi and Î³zi be the ones spiraling around Î±i for i = 1, 2 such
that x1 âˆˆX1 âˆ©(y1, z1) and x2 âˆˆX1 âˆ©(y2, z2). We claim that
X1 âˆ©(y1, z1) = x1,
and
X1 âˆ©(y2, z2) = x2.
if Î³z is a simple geodesic ray and z Ì¸âˆˆ{x1, x2, y1, y2, w1, w2}, Î³z must leave
Ëœz
r1
r2
s1
h
ËœÎ²
ËœÎ±1
Figure 5. Universal cover of a pair of pants
Î£ and hence meet Î±1âˆªÎ±2. Without loss of generality, we can assume that Î³z
meet Î±1 ï¬rst. In the universal cover of this pair of pants, as shown in Figure
5, let ËœÎ², joining s1 and âˆ, be a lift of Î²1. Also, let ËœÎ±1, joining r1 and r2,
be the outermost lift of Î±1 meeting ËœÎ³z. Consider Ïˆ1 and Ïˆ2, two geodesics
perpendicular to ËœÎ² passing through the two end points of ËœÎ±1. And let Î·1
(resp. Î·2) be the piecewise geodesic path going from Ëœz to h along ËœÎ³z and
from h to r1(resp. r2) along ËœÎ±1 As both Î±1 and Î³z are simple, the projection
of Î·1 and Î·2 are simple rays on the surface. On the other hand, since ËœÎ±1 is
the outermost lift of Î±1 meeting Î³z the projection of Î·1 and Î·2 are disjoint
21

from both Î±1 and Î±2. Therefore, the projections are inï¬nite simple geodesic
rays on Î£.
Furthermore, Î·1 (resp. Î·2) is homotopic to Ïˆ2( resp. Î·2). This shows
that the projections of Ïˆ1 and Ïˆ2 are complete simple geodesics on Î£. Since
both Ïˆ1 and Ïˆ2 are asymptotic to a lift of Î±1, their images spiral to Î±1.
Therefore a1 and a2 are actually pre images of z1 and y1. Also, for any
x âˆˆ[a1, a2] the curve Î³x meets Î±. Therefore, we have z âˆˆ[y1, z1].
2
Next, assume that Î³x spirals into a compact minimal lamination â„¦(Î³x)
which is not a simple closed curve. To prove part (b) we construct a sequence
{xj} âŠ‚Ei getting close to x from both side on Î²i. So roughly, we need to
approximate Î³x with simple complete geodesics from both sides.
Quasi-geodesics. Later, we construct paths with uniformly bounded small
curvature approximating a complete simple geodesic.
A path Î±(t) in H, parameterized by arclength, is a quasi geodesic if
d(Î±(s), Î±(t)) > Ïµ|s âˆ’t|
for all s and t. One can show that any quasi geodesic is a bounded distance
from a unique geodesic. See [CEG] for more details.
The main point is that it is easier to construct quasi geodesics approximating
a complete geodesic.
Lemma 4.7. A polygon path Î± of segments of length at least L and bends at
most Î¸ < Ï€ is a quasi-geodesic when L is long enough compared to Î¸. Also
as (L, Î¸) â†’(âˆ, 0) the distance from Î± to its straightening tends to zero.
In the next 3 parts, we show how one can approximate Î³x with simple
complete geodesics using quasi geodesics:
I): Good geodesic segments. Let Î±(t) be the arc length parameterization
of a simple geodesic segment on X, t0 < t1 âˆˆR, Ïµ > 0 and c : [0, 1] â†’X be
a diï¬€erentiable arc transverse to Î± such that
c(0) = Î±(t0) , c(1) = Î±(t1).
We say that (Î±, t0, t1, c) is an Ïµ-good geodesic arc iï¬€
â€¢ â„“(c) â‰¤Ïµ,
â€¢ The arc c is almost perpendicular to Î±, that is
|âˆ (câ€²(0), Î±â€²(t0)) âˆ’Ï€
2 | â‰¤Ïµ,
22

c
Î±(t0)
Î±
Î±(t1)
Figure 6. A good geodesic segment
|âˆ (câ€²(1), Î±â€²(t1)) âˆ’Ï€
2 | â‰¤Ïµ,
and
â€¢ The arc c meets the geodesic arc Î± in only two points,
c âˆ©{Î±(t)|t0 â‰¤t â‰¤t1} = {Î±(t0), Î±(t1)}.
Consider the vectors Î±â€²(t0) and câ€²(0)) at point c(0) = Î±(t0), and Î±â€²(t1)
and câ€²(1)) at the point c(1) = Î±(t1).
We say (Î±, t0, t1, c) is positive (negative) if the orientation of the pairs
(Î±â€²(t0), câ€²(0)), (Î±â€²(t1), câ€²(1))
agree. Note that positivity only depends on the image of Î± and is indepen-
dent of the parameterization. So if (Î±, t0, t1, c) is a positive pair the two
tangent vectors to Î± at Î±(t1) and Î±(t2) are almost parallel, that is we have
âˆ¥Vc(Î±â€²
t1) âˆ’Î±â€²
t0 âˆ¥â‰¤Ïµ,
where Vc(v) is the parallel transport of vector v along c.
II): Complete simple geodesics. Let (Î±, t0, t1, c) be an Ïµ-good geodesic
segment such that
Î± âˆ©Î³x = âˆ…, Î³x âˆ©c[0, 1] Ì¸= âˆ…,
and let
t0 = inf{t | Î³x(t) âˆˆc[0, 1]}.
Then we construct a complete simple curve, Î·, which starts at x and
goes along Î³(t) for t â‰¤t0 then spirals around Ïˆ(Î±, t0, t1, c), the simple
23

closed curve which goes along c from Î±(t1) to Î±(t0), and then goes back to
Î±(t1) along Î±. In fact, by possibly changing the direction of Î±, Î· will be a
quasi-geodesic and consequently lies within a bounded distance of a unique
complete simple geodesic. More precisely, we have:
Lemma 4.8. Assume that
c âˆ©{Î±(t)|0 â‰¤t < t1} = âˆ….
For any Ïµ > 0 there exist Î´, L > 0 such that if (Î±, t0, t1, c) is a Î´- good
geodesic segment and L â‰¤t1 âˆ’t0, then Î· is a simple quasi geodesic. Also, if
ËœÎ· denote its geodesic representative and y = ËœÎ· âˆ©Î²i, then
d(y, x) < Ïµ.
Furthermore, y lies on the right(left) side of x if and only if (Î±, t0, t1, c) is
positive(negative).
We will use this lemma to approximate Î³x with complete simple geodesics.
III): Good geodesic sub-segments in a minimal geodesic lamina-
tion.
In this part, we want to ï¬nd good geodesic segments in a non-
trivial minimal lamination â„¦(Î³x) = Î» in order to construct complete simple
geodesics.
Given y âˆˆÎ», let Ï†y denote the arc length parameterization of the leaf of
Î» such that Ï†y(0) = y. Then we have:
Lemma 4.9. For any Ïµ, L > 0 there exist 0 â‰¤s < t and a transverse arc
c and y âˆˆc âˆ©Î», such that (Ï†y, s, t, c) is a positive Ïµ-good geodesic segment,
Ï†(s) and Ï†(t) are not boundary points in Î» âˆ©c, and we have
L â‰¤|s âˆ’t|.
Sketch of the proof. Take a transverse almost perpendicular arc c such
that Î» âˆ©c Ì¸= âˆ….
Note that Î» is a minimal lamination, and it is not a
simple closed curve. Hence, Î» âˆ©c is uncountable with only countably many
boundary points. Therefore one can choose x0 âˆˆÎ» âˆ©c so that Ï†x0 âˆ©c does
not contain any boundary points of Î» âˆ©c. Let Ï† = Ï†x0 and c : [âˆ’r, +r] â†’
X , r > 0, c(0) = x0 be a small enough transverse arc such that for
Ï†(a), Ï†(b) âˆˆc[âˆ’r, r] we have |aâˆ’b| > L or a = b. Without loss of generality,
we can assume that the orientation of the pair
(Ï†â€²
0, câ€²
0)
24

0
0
1
1
1
2
0
2
a)
b)
c)
Ï†x0
Ï†x0
Ï†x0
c
c
c
Figure 7. Finding good-geodesic segments
agrees with the orientation of X. Now deï¬ne t1, t2 as follows.
Let
t1 = inf{ t > 0|Ï†(t) âˆˆc[âˆ’r, 0) },
and Ï†(t1) = c(x1). Similarly, as Ï†(ti) is not a boundary point for i = 1, 2
we can deï¬ne
t2 = inf{ t > t1|Ï†(t) âˆˆc(x1, 0) }.
Then as in Figure 7 at least one of (Ï†, 0, t1, c), (Ï†, t1, t2, c) and (Ï†, 0, t2, c) is
a positive Ïµ-good geodesic segment. Also, we have
min{|t1 âˆ’t2|, t1, t2} â‰¥L.
2
Now we can prove part b that if â„¦(Î³x) is a non simple closed curve then
x is not a boundary point.
Proof of part (b) and (c) of Theorem 4.6. The main idea is to apply
Lemma 4.9 to ï¬nd positive Ïµ-good geodesic segments inside Î» and use it to
construct complete simple geodesics.
Let (Î±, t1, t2, c) be an Ïµ-good geodesic segment in Î» constructed in Lemma
4.9 such that Î±(ti) = c(ri), and Î±(t1) is not a boundary point of Î» âˆ©c.
As Î³x spirals to Î», Î³x âˆ©c[r1, r2] is non-empty. Let
t0 = inf{t |Î³x(t) âˆˆc[r1, r2]}.
Then from Lemma 4.8 the result is immediate.
Using the same method, one can ï¬nd a sequence of complete simple geodesics
approximating Î³x from one side if â„¦(Î³x) is a simple closed curve inside the
25

surface in which case, by the proof of part (a), x will be a boundary point
of Ei.
2
Now, we can show that the set of non-isolated points of Ei is topologically
homeomorphic to the Cantor set.
Proof of Theorem 4.5. Recall that we have a topological characterization
of the Cantor set. That is any perfect totally disconnected compact metric
space is homeomorphic to the Cantor set.
By Theorem 4.6, apart from countably many points, corresponding to
the simple geodesics joining boundary components, points in Ei are limit
points. The result follows since non-isolated points of Ei form a compact
totally disconnected perfect subset of Î²i.
2
Connection with embedded pairs of pants.
Let x âˆˆEi such that
the ray Î³x spirals into a simple closed geodesic Î±1. Then there is a unique
embedded pair of pants Î£x on X such that Î³x âŠ‚Î£x. In other words, there
exists a unique simple closed geodesic Î±2 bounding a pair of pants Î£x with
Î²1 and Î±1 such that Î³x âŠ‚Î£x.
Let Ii be the set of isolated points in Ei. Then we can write
Ii âˆª(Î²i âˆ’Ei) =

h
(ah, bh),
where ah, bh are both boundary points of Ei.
We ï¬nd a natural one to
one correspondence between embedded pairs of pants containing Î²1 and
complementary intervals of Ei âˆ’Ii as follows.
For any h, let Î£h be the unique pairs of pants containing Î³ah such that
âˆ‚(Î£) = {Î²1, â„¦(Î³ah), Î±}.
Now if Î± is not a boundary component of X, then by Theorem 4.6, Î³bh âŠ‚
Î£h, otherwise we could ï¬nd y âˆˆ(ah, bh) and Î³y âŠ‚Î£h spirals into Î±. So
Î± = â„¦(Î³bh) which means that â„¦(Î³ah), â„¦(Î³bh) and Î²1 bound a pair of pants.
Similarly if Î± = Î²j is a boundary component, then Î³bh âŠ‚Î£h which
means that Î²1, Î²j and â„¦(Î³ah) = â„¦(Î³bh) bound an embedded pair of pants
inside the surface.
We will use this fact and Lemma 4.4 to prove the main result of this
section.
Proof of Theorem 4.2. Let
Ii âˆª(Î²i âˆ’Ei) =

h
(ah, bh),
26

where ah, bh âˆˆÎ²i. Then by Theorem 4.4 we have:
Li = â„“Î²i(X) =

h
|bh âˆ’ah|,
(4.3)
where |ah âˆ’bh| is the geodesic distance between ah and bh along Î²i.
For each 1 â‰¤h one of the following holds:
1. There exists j such that Î³ = â„¦(Î³ah) = â„¦(Î³bh), Î²j and Î²i bound a pair
of pants in X.
2. The two curves Î± = â„¦(Î³ah) and Î² = â„¦(Î³bh) are distinct and bound a
pair of pants containing Î²i.
By the deï¬nition the functions D and R in Â§3 in the ï¬rst case we have
R(Li, Lj, â„“Î³(X)) = |ah âˆ’bh|,
(4.4)
and in the second case, we have:
1
2D(Li, â„“Î±(X), â„“Î²(X)) = |ah âˆ’bh|.
(4.5)
Now we can use (4.4) and (4.5) to rewrite (4.3) as
Li(X) =

{Î±1,Î±2}
D(Li, â„“Î±1(X), â„“Î±2(X)) +

j
jÌ¸=i

Î³
R(Li, Lj, â„“Î³(X)),
where the ï¬rst sum is over unordered {Î±1, Î±2} bounding a pairs of pants
with Î²i in X and the second some is over Î³ bounding a pair of pants with
Î²i and Î²j.
2
5
Statement of the recursive formula for volumes
In this section we state a recursive formula for Vg,n(L), the Weil-Petersson
volume of Mg,n(L). The proof is given later in Â§9.
The volume function Vg,n(L1, . . . , Ln) is a symmetric function in L1, . . . , Ln.
Hence for any set A of positive numbers with |A| = n, we can deï¬ne Vg,n(A)
by
Vg,n(A) = Vg,n(a1, . . . , an),
where {a1, . . . , an} = A.
Statement of the recursive formula. The function Vg,n(L1, . . . , Ln) for
any g and n (2g âˆ’2 + n > 0) is determined recursively as follows :
27

â€¢ For any L1, L2, L3 â‰¥0, set
V0,3(L1, L2, L3) = 1,
and
V1,1(L1) = L2
1
24 + Ï€2
6 .
The ï¬rst equation holds since the moduli space M0,3(L1, L2, L3) con-
sists of only one point. For the calculation of V1,1(L) see Â§6.
â€¢ Let L = (L2, . . . , Ln). When (g, n) Ì¸= (1, 1), (0, 3), the volume Vg,n(L) =
Vol(Mg,n(L)) is inductively determined by :
âˆ‚
âˆ‚L1
L1Vg,n(L) = Acon
g,n(L1, L) + Adcon
g,n (L1, L) + Bg,n(L1, L),
(5.1)
where the functions
Acon
g,n(L1, L) = 1
2(
âˆ

0
âˆ

0
x y 
Acon
g,n(x, y, L1, L) dx dy),
(5.2)
Adcon
g,n (L1, L) = 1
2(
âˆ

0
âˆ

0
x y 
Adcon
g,n (x, y, L1, L) dx dy),
(5.3)
and
Bg,n(L1, L) =
âˆ

0
x Â· 
Bg,n(x, L1, L) dx,
(5.4)
are deï¬ned in terms of the Vh,m(L)â€™s with 3h + m < 3g + n as follows. We
deï¬ne the functions

Acon
g,n : Rn+2
+
â†’R+,

Adcon
g,n
: Rn+2
+
â†’R+,
and
Bg,n : Rn+1
+
â†’R+.
To do this, we need the function H : R â†’R+ deï¬ned in Â§3 by
H(x, y) =
1
1 + e
x+y
2
+
1
1 + e
xâˆ’y
2
.
28

Also as before, let
m(g, n) = Î´(g âˆ’1) Ã— Î´(n âˆ’1).
So m(g, n) = 0 unless g = 1 and n = 1.
I) : Deï¬nition of 
Acon
g,n. Deï¬ne 
Acon
g,n : Rn+2
+
â†’R+ by

Acon
g,n(x, y, L1, . . . , Ln) =
1
2m(gâˆ’1,n+1) Vgâˆ’1,n+1(x, y, L) Â· H(x + y, L1).
See Figure 8(b).
II) : Deï¬nition of 
Ag,n
dcon. Let Ig,n be the set of ordered paris
a = ((g1, I1), (g2, I2))
where I1, I2 âŠ‚{2, . . . , n} and 0 â‰¤g1, g2 â‰¤g such that the followings hold:
1. The two sets I1 and I2 are disjoint and {2, 3, . . . , n} = I1 âŠ”I2.
2. The numbers g1, g2 â‰¥0 and n1 = |I1|, n2 = |I2| satisfy
2 â‰¤2g1 + n2,
2 â‰¤2g2 + n2,
and
g1 + g2 = g.
For notational convenience, given L = (L1, . . . , Ln) and I âŠ‚{1, . . . , n} with
|I| = k, deï¬ne LI by
LI = (Lj1, . . . , Ljk),
where I = {j1, . . . , jk}. Now for each
a = ((g1, I1), (g2, I2)) âˆˆIg,n,
let
V (a, x, y, L) = Vg1,n1+1(x, LI1)
2m(g1,n1+1)
Ã— Vg2,n2+1(y, LI2)
2m(g2,n2+1)
.
As we will see later, the reason we have to divide by 2 in this case is that
every X âˆˆM1,1(L) has a symmetry of order 2.
Note that as the function Vg,n(L) is symmetric, the function V (a, x, y, L)
is well deï¬ned. Now deï¬ne 
Adcon
g,n
: Rn+2
+
â†’R+ by

Adcon
g,n (x, y, L1, L) =

aâˆˆIg,n
V (a, x, y, L) Â· H(x + y, L1).
29

See Figure 8(a).
III) : Deï¬nition of Bg,n. Finally, deï¬ne Bg,n : Rn+1
+
â†’R+ by
Bg,n(x, L1, L) =
1
2m(g,nâˆ’1)
n

j=2
1
2(H(x, L1 + Lj) + H(x, L1 âˆ’Lj)) Â· Vg,nâˆ’1(x, L2, . . . , Ë†Lj, . . . , Ln). (5.5)
See Figure 8(c).
Connection with topology of the set of pairs of pants. Although the
recursive formula 5.1 has been described in purely combinatorial terms, as
in Figure 8, it is closely related to the topology of diï¬€erent types of pairs of
pants in Sg,n. In fact, this formula gives us the volume of Mg,n(L) in terms
of volumes of moduli spaces of Riemann surfaces that we get by removing
a pair of pants containing at least one boundary component of Sg,n. Also,
the second condition in the deï¬nition of Ig,n is equivalent to the condition
that both complementary regions of the pair of pants have negative Euler
characteristics. See Â§9 for more details.
Remark. The functions Acon
g,n, Adcon
g,n
and Bg,n are determined by the func-
tions {Vi,j} where 3i + j < 3g + n. Therefore equation (5.1) is a recursive
formula for calculating Vg,n(L). In Â§6 we will simplify this recursive formula
and use it to prove that Vg,n(L) is a polynomial in L (Theorem 1.1).
6
Polynomial behavior of the Weil-Petersson vol-
ume
In this section we use the recursive formula for the volumes of moduli spaces
stated in Â§5 to establish the following result:
Theorem 6.1. The function Vg,n(L) is a polynomial in L1, . . . , Ln, namely:
Vg,n(L) =

Î±
|Î±|â‰¤3gâˆ’3+n
CÎ± Â· L 2Î±,
where CÎ± > 0 lies in Ï€6gâˆ’6+2nâˆ’|2 Î±| Â· Q.
We will also calculate the leading coeï¬ƒcients of V0,n(L).
Calculation of V1,1(L). Before proving Theorem 6.1, we elaborate the main
idea of the calculation of the Vg,n(L)â€™s through an example when g = n = 1.
In this case, using Theorem 4.2 for a hyperbolic surface of genus one with
30

one geodesic boundary component implies that for any X âˆˆT (S1,1, L), we
have

Î³
D(L, â„“Î³(X), â„“Î³(X)) = L,
where the sum is over all simple closed curves Î³ on S1,1. Also, by Lemma
3.2, we have
âˆ‚
âˆ‚LD(L, x, x) =
1
1 + exâˆ’L
2
+
1
1 + ex+ L
2
.
Integrating over M1,1(L), as in the calculation of Vol(M1,1) in the Intro-
duction, we get:
L Â· V1,1(L) =
âˆ

0
x D(L, x, x) dx.
So we have
âˆ‚
âˆ‚LL Â· V1,1(L) =
âˆ

0
x Â· (
1
1 + ex+ L
2
+
1
1 + exâˆ’L
2
) dx.
By setting y1 = x + L/2 and y2 = x âˆ’L/2, we get
âˆ

0
x Â· (
1
1 + ex+ L
2
+
1
1 + exâˆ’L
2
) dx =
âˆ

L/2
y1 âˆ’L/2
1 + ey1 dy1 +
âˆ

âˆ’L/2
y2 + L/2
1 + ey2
dy2 =
= 2
âˆ

0
y
1 + ey dy +
L/2

0
y âˆ’L/2
1 + ey
dy +
âˆ’L/2

0
y + L/2
1 + ey
dy =
Ï€2
6 +
L/2

0
(y âˆ’L/2)(
1
1 + ey +
1
1 + eâˆ’y ) dy = Ï€2
6 + L2
8 ,
Since we have
1
1 + ey +
1
1 + eâˆ’y = 1.
Therefore, we have:
V1,1(L) = L2
24 + Ï€2
6 .
(6.1)
Remark. This result agrees with the result obtained in [NN]. It seems
straightforward to generalize our calculation for hyperbolic surfaces with
ï¬nitely many cone singularities [NN].
31

Polynomial behavior of H and Vg,n . At ï¬rst glance the equation in 5.1
looks too complicated to be useful, but by using the following elementary
lemmas we will be able to simplify both sides of the equation 5.1
âˆ‚
âˆ‚L1
L1Vg,n(L) = Acon
g,n(L) + Adcon
g,n (L) + Bg,n(L),
and prove that Vg,n(L) is actually a polynomial in L.
The following easy observation shows that it suï¬ƒces to prove that Acon
g,n(L),
Adcon
g,n (L) and Bg,n(L) are polynomials in L.
Lemma 6.2. For any diï¬€erentiable function F : Rn â†’R, deï¬ne P(F) by:
Pi(F) =
âˆ‚
âˆ‚xi
(xiF(x1, ..., xn)).
Then Pi(F) determines F, and we have F âˆˆR[x1, .., xn] if and only if
Pi(F) âˆˆR[x1, .., xn] .
Deï¬nition. For i âˆˆN, deï¬ne F2i+1 : R+ â†’R+ by
F2k+1(t) =
âˆ

0
x2k+1 Â· H(x, t) dx.
We easily ï¬nd in the following that
âˆ

0
âˆ

0
x2i+1Â·y2j+1Â·H(x+y, t) dx dy = (2i + 1)! Â· (2j + 1)!
(2i + 2j + 3)!
F2i+2j+3(t). (6.2)
To prove equation 6.2, note that for any m, n âˆˆN, we have
T

0
ym (T âˆ’y)ndy =
m! n!
(m + n + 1)! T m+n+1.
Now we can simplify the left hand side of the equation 6.2, as follows. By
setting Z = x + y, we get
âˆ

0
âˆ

0
x2i+1Â·y2j+1Â·H(x+y, t) dx dy =
âˆ

0
Z

0
(Zâˆ’y)2i+1Â·y2j+1Â·H(Z, t) dy dZ =
32

= (2i + 1)! Â· (2j + 1)!
(2i + 2j + 3)!
âˆ

0
Z2i+2j+3H(Z, t) dZ.
These functions play a key role in the calculation of Vg,n(L). In fact, us-
ing equations (5.2), (5.3) and (5.4) we can express the functions Adcon
g,n (L),
Acon
g,n(L) and Bg,n(L) in terms of the F2k+1(t)â€™s and the volumes of moduli
spaces of simpler Riemann surfaces.
The following lemma helps us to proceed to the calculation of Vg,n(L).
Lemma 6.3. For any k â‰¥0, we have
F2k+1(t)
(2k + 1)! =
k+1

i=0
Î¶(2i) (22i+1 âˆ’4)
t2k+2âˆ’2i
(2k + 2 âˆ’2i)!.
Therefore F2k+1(t) is a polynomial in t2 of degree k + 1 such that the coef-
ï¬cient of m2k+2âˆ’2i lies in Ï€2i Â· Q>0.
Remark. Since Î¶(0) = âˆ’1/2, therefore the leading coeï¬ƒcient of F2k+1(t)
is t2k+2/(2k + 2).
Proof. Simplifying F2k+1(t), exactly as in the calculation of V1,1(L) in the
beginning of this section, we have
âˆ

0
x2k+1 Â· (
1
1 + ex+t +
1
1 + exâˆ’t) dx =
=
âˆ

0
((x + t)2k+1 + (x âˆ’t)2k+1
1 + ex
)dx +
t

0
âˆ’(x âˆ’t)2k+1
1 + ex
+ (âˆ’x + t)2k+1
1 + eâˆ’x
dx
= t2k+2
2k + 2 +
k

i=0
2t2kâˆ’2i Â·
2k + 1
2i + 1

Â·
âˆ

0
x2i+1
1 + ex dx,
which is a polynomial in t2 whose leading term is m2k+2
2k+2 . So the equality
2
âˆ

0
x2i+1
1 + ex dx = Î¶(2i + 2) (2i + 1)! (2 âˆ’2âˆ’2i)
implies that
F2k+1(2t)
(2k + 1)! = 22k+2(
t2k+2
(2k + 2)! +
k

i=0
t2kâˆ’2i
(2k âˆ’2i)! Â· Î¶(2i + 2) (2 âˆ’2âˆ’2i))
33

which implies the result.
2
Now we can use the preceding lemma to prove that Vg,n(L) is a polyno-
mial in L.
Proof of Theorem 6.1.
The proof is by induction on 3g + n.
Using
equation 5.1, and Lemma 6.2, it suï¬ƒces to prove that Acon
g,n(L), Adcon
g,n (L)
and Bg,n(L) are polynomials in L. We prove that Acon
g,n(L) is a polynomial
in L, the proof for Adcon
g,n
and Bg,n is similar.
Let Tn = {1, 2, . . . , n} and L = (L1, . . . , Ln). By the induction hypothesis
Vg,nâˆ’1(x, LTnâˆ’{1,j}) is a polynomial in x2 and {Lk}kâˆˆTn âˆ’{1, j}. Therefore,
to complete the proof we have to show that
âˆ

0
x2i+1 Â· (H(x, L1 + Lj) + H(x, L1 âˆ’Lj)) dx
is a polynomial in L1 and Lj which is immediate from Lemma 6.3.
2
7
Leading coeï¬ƒcients of volume polynomials
In this section, we ï¬nd a recursive method for calculating the coeï¬ƒcients of
Vg,n(L) and calculate the leading coeï¬ƒcients of V0,n(L).
Deï¬nition. Let
Cg(Î±1, . . . , Î±n)
be the coeï¬ƒcient of L2Î±1
1
Â· Â· Â· L2Î±n
n
in the polynomial Vg,n(L). Also, let
(Î±1, . . . , Î±n)g = Cg(Î±) Ã—
n

i=1
Î±i! Ã— 2|Î±|,
where |Î±| =
n
i=1
Î±i.
The recursive formula Â§5 simpliï¬es when
n
i=1
2Î±i = 6g âˆ’6 + 2n in which
case we get a recursive formula in terms of the leading coeï¬ƒcients of {Vh,m}
with 3h âˆ’m < 3g âˆ’n. Also, if one of the Î±iâ€™s is 0 or 1, the coeï¬ƒcient of
L2Î± in 
Acon(L) and 
Adcon
g,n (L) equals zero and we have:
Theorem 7.1. If
n
i=1
Î±i = 3g âˆ’3 + n, then we have
(1, Î±1, . . . , Î±n)g = (2g + n âˆ’2) (Î±1, . . . , Î±n)g.
34

Theorem 7.2. If
n
i=1
Î±i = 3g âˆ’2 + n, then we have
(0, Î±1, . . . , Î±n)g =

Î±iÌ¸=0
(Î±1, . . . , Î±i âˆ’1, . . . , Î±n)g.
Proof of Theorem 7.1. We prove the Theorem by induction on n. To
do this, we calculate the coeï¬ƒcient of L2
1 Â· Â· Â· L 2 Î±n
n+1 in Vg,n+1(L) by using the
recursive formula for the volume polynomials. The coeï¬ƒcient of L2
1 Â· Â· Â· L 2 Î±n
n+1
on the left hand side of equation 5.1 equals
3 (1, Î±1, . . . , Î±n)g
Î±! Ã— 23gâˆ’3+n+1 ,
where Î±! = Î±1! Â· Â· Â· Î±n!.
As in the proof of Lemma 6.3, the leading coeï¬ƒcient of F2i+1(m) equals
1/2i + 2. It can be easily veriï¬ed that the coeï¬ƒcient of L2
1 Â· Â· Â· L2 Î±n
n+1 in
n+1

j=2
âˆ

0
1
2 x Â· (H(x, L1 + Lj) + H(x, L1 âˆ’Lj)) Â· Vg,nâˆ’1(x, LTâˆ’{1,j}) dx
equals
n

j=1
2 Î±j+2
2

2 Î±i + 2 Â· (Î±1, . . . , Î±n)g
Î±! Ã— 23gâˆ’3+n = 3 (2g âˆ’2 + n)
2
Ã— (Î±1, . . . , Î±n)g
Î±! Ã— 23gâˆ’3+n .
On the other hand, there is no L2Î±1
1
Â· Â· Â· L2Î±n
n+1 term in Adcon
g,n (L) and Bg,n(L).
Therefore, we have
3 (1, Î±1, . . . , Î±n)g = 3 (2g + n âˆ’2)(Î±1, . . . , Î±n)g
which implies the result.
2
We omit the proof of Theorem 7.2 since it is quite similar.
These two recursive formulas are actually enough for determining
(Î±1, . . . , Î±n)g when g = 0. In this case, by induction on n it can be easily
proved that:
Corollary 7.3. When
n
i=1
Î±i = n âˆ’3, we have
(Î±1, . . . , Î±n)0 =
Î±1 + Â· Â· Â· + Î±n
Î±1, Â· Â· Â· , Î±n

.
35

Remark.
Equations in Theorem 7.1 and Theorem 7.2 are reminiscent of
the dilaton and string equations for the intersection pairings over the moduli
spaces [Har]. In a sequel we prove that
(Î±1, . . . , Î±n)g =

Mg,n
ÏˆÎ±1
1 Â· Â· Â· ÏˆÎ±n
n ,
where Ïˆi denotes the Chern class of the ith tautological line bundle over
Mg,n [Mirz2].
8
Integration over the moduli space
In this section, we investigate the Weil-Petersson symplectic structure of
Mg,n(L).
For
Î³ =
k

i=1
ciÎ³i,
where ci > 0 and Î³1, . . . , Î³k are disjoint non homotopic simple closed curves
on Sg,n, let Î“ = (Î³1, . . . , Î³k).
For any f : R+ â†’R+,
fÎ³(X) =

[Î±]âˆˆMod Â·[Î³]
f(â„“Î±(X)),
where â„“Î±(X) =
k
i=1
ciâ„“Î³i(X), deï¬nes a function fÎ³ : Mg,n(L) â†’R.
In this section we establish the following result for integrating the func-
tion fÎ³ over Mg,n(L).
Theorem 8.1. For any Î³ =
k
i=1
ciÎ³i, the integral of fÎ³ over Mg,n(L) with
respect to the Weil-Petersson volume form is given by

Mg,n(L)
fÎ³(X) dX =
2âˆ’M(Î³)
| Sym(Î³)|

xâˆˆRk
+
f(|x|) Vg,n(Î“, x, Î², L) x Â· dx dt,
where |x| =
k
i=1
ci xi, and
M(Î³) = |{i|Î³i seperates oï¬€a one-handle from Sg,n}|
36

Here xÂ·dx = x1 Â· Â· Â· xnÂ·dx1âˆ§Â· Â· Â·âˆ§dxn, and for any x = (x1, . . . , xk) âˆˆRk
+,
Vg,n(Î“, x, Î², L) is given by
Vol(M(Sg,n(Î³), â„“Î“ = x, â„“Î² = L)).
We can write Sg,n(Î³) as a union of its connected components
Sg,n(Î³) =
s
i=1
Si ,
(8.1)
where Si âˆ¼= Sgi,ni, and Ai = âˆ‚Si. Then we have
Vg,n(Î“, x, Î², L) =
k

i=1
Vgi,ni(â„“Ai).
Remark 1. The terms Sym(Î³) and M(Î³) appear when Î³ has some extra
symmetry.
See Â§2 for the deï¬nition of Sym(Î³), the symmetry group of
Î³ = k
i=1 ciÎ³i. In fact | Sym(Î³)| Ì¸= 1 will put a non trivial restriction on the
ciâ€™s. More precisely, if g(Î³i) = Î³j for g âˆˆSym(Î³) then ci = cj. Hence we
have
k

i=1
ciâ„“Î³i =
k

i=1
ciâ„“gÂ·Î³i
.
Remark 2. Since later will use lemma 8.1 to integrate the left hand side of
equation 4.1 over Mg,n(L), it is essential that D(x, y, z) is in fact a function
of x and y + z (Â§3).
By Theorem 8.1 integrating fÎ³, even for a compact Riemann surface,
reduces to the calculation of volumes of moduli spaces of bordered Riemann
surfaces.
Hamiltonian circle actions. Let (M, Ï‰) be a symplectic manifold. Then
for any smooth function H : M â†’R, the vector ï¬eld XH determined by
Ï‰(XH, .) = dH(.)
is called the Hamiltonian vector ï¬eld associated to H. Here we are interested
in the case where XH generates an S1 action on M. In other words, Ïˆ1 = id,
where Ïˆt is the integral of the vector ï¬eld XH. The Hamiltonian function
H in this case is called the moment map of the action. See [McD] for more
details.
Integration and covering. Let
Ï€ : X1 â†’X2
37

be a covering and v2 a volume form on X2. Then v1 = Ï€âˆ’1âˆ—(v2) deï¬nes a
volume form on X1. If f is in L1(X1, v1), then the push forward
(Ï€âˆ—f)(x) =

yâˆˆÏ€âˆ’1{x}
f(y)
deï¬nes a function in L1(X2, v2) and we have

X2
(Ï€âˆ—f) dv2 =

X1
f dv1.
(8.2)
Next we construct coverings of Mg,n and functions deï¬ned over them whose
push forward to Mg,n is constant.
Coverings and volume forms of the Mg,n(L)â€™s. For h âˆˆModg,n let
h.Î“ = (h Â· Î³1, . . . , h Â· Î³k).
As in Â§2, let OÎ“ be the set of homotopy classes of elements of the set Mod Â·Î“.
Consider Mg,n(L)Î“ deï¬ned by the following space of pairs:
{(X, Î·)| X âˆˆMg,n(L) , Î· = (Î·1, . . . , Î·k) âˆˆOÎ“, Î·iâ€™s are closed geodesics on X}.
Let Ï€Î“ : Mg,n(L)Î“ â†’Mg,n(L) be the projection map deï¬ned by
Ï€Î“(X, Î·) = X.
Let Ï†Î³ âˆˆModg,n denote the Dehn twist along Î³. Then
GÎ“ =
s
i=1
Stab(Î³i) âŠ‚Mod(Sg,n)
is generated by the Ï†Î³iâ€™s and elements of the mapping class group of Sg,n(Î³),
and
Mg,n(L)Î“ = Tg,n(L)/GÎ³.
As the Weil-Petersson symplectic structure on TeichmÂ¨uller space is invari-
ant under the action of the mapping class group, it induces a symplectic
structure on Mg,n(L)Î“ which is the same as the form Ï€Î“âˆ—(wwp).
In fact, the space Mg,n(L)Î“ is closely related to the moduli space of hyper-
bolic structures over Sg,n cut along {Î³1, . . . , Î³k}.
Twisting and the Weil-Petesson symplectic form. The results of this
section will arise from the existence of k commuting Hamiltonian S1-actions
38

on Mg,n(L)Î“. induced by twisting the surface along connected components
of Î³. We ï¬rst describe the corresponding R-action on Tg,n(L) as deï¬ned in
Â§2.
Consider the length-normalized twist ï¬‚ow, given by
Ï†t
Î±(X) = twtÂ·â„“Î±(X)
Î±
(X).
Then
Ï†1
Î± = Ï†Î± âˆˆStab(Î±)
is the Dehn-Twist around Î±. See Â§2 for more details. Let â„“Î“ : Tg,n â†’Rk
+
denote the length function deï¬ned by
â„“Î“(X) = (â„“Î³1(X), . . . , â„“Î³k(X)).
Then the level set
Tg,n(a) = â„“âˆ’1
Î“ (a)
carries a natural volume form âˆ’âˆ—(dâ„“Î³1 âˆ§Â· Â· Â· dâ„“Î³k).
Since â„“Î±(X) = â„“Î±(twt
Î±(X)), the map
Ï†(t1,...,tk)
Î³
: Tg,n(a) â†’Tg,n(a)
gives rise to an action of Rk on the level set Tg,n(a) preserving the Weil-
Petersson symplectic form. By cutting the surface along Î³ we get a Riemann
surface with geodesic boundary components. Now Theorem 2.1 implies the
following result:
Lemma 8.2. For any (a1, . . . , ak) âˆˆRk
+, the canonical map
s : â„“âˆ’1
Î“ (a1, . . . , ak)/Rk â†’
s

i=1
T (Si, LAi)
sending each point X âˆˆTg,n to the surface that we get by cutting X along
components of Î³, is a symplectomorphism.
Induced ï¬‚ows on Mg,n(L)Î“. The length function â„“Î“ descends to a function
LÎ“ on Mg,n(L)Î“
Rk
L
â†âˆ’âˆ’âˆ’âˆ’Mg,n(L)Î“
ï£¦ï£¦Ï€
Mg,n(L)
39

where LÎ“(X, Î·) = (â„“Î·i(X)). The construction of the Fenchel-Nielsen ï¬‚ow
deï¬ned on TeichmÂ¨uller space is equivariant with respect to the action of the
mapping class group. Therefore, we have:
â€¢ Each level set
Mg,n(L)Î“(a) = Lâˆ’1(a1, . . . , ak) âŠ‚Mg,n(L)Î“
carries a natural volume form va induced by âˆ’âˆ—dL = âˆ’âˆ—(
i dâ„“Î³i).
â€¢ The Hamiltonian ï¬‚ow of Li, twi, has closed orbits on MÎ“
g,n(a1, . . . , ak).
That is we have
twt
i(X, Î·) = (twt
Î·i(X), Î·),
where twt
Î·i(X) is obtained by cutting X along Î·i, twisting to the right
by hyperbolic length t and regluing the boundaries. Then for ti =
Li(Y ), twti(Y )
i
is the Dehn twist of Y along Î·i which equals Y in
Mg,n(L)Î“.
Therefore, the Hamiltonian ï¬‚ow of L2/2 : Mg,n(L)Î“ â†’Rk
+ gives rise to
the action of T k = S1 Ã— Â· Â· Â· Ã— S1 by twisting along Î³i proportional to its
length.
The quotient space,
Mg,n(L)Î“âˆ—(a) = Mg,n(L)Î“(a)/T k,
where T k = k
i=1 S1, inherits a symplectic structure from the symplectic
structure of Mg,n(L)Î“. For an open set U âŠ‚Mg,n(L)Î“âˆ—(a), and the projec-
tion map
Ï€ : Mg,n(L)Î“(a) â†’Mg,n(L)Î“âˆ—(a).
Note in general the twisting parameter along Î³i can be between 0 and â„“Î³i. In
the case of a simple geodesic Î³i separating oï¬€a one-handle (the elliptic tail
case) Stab(Î³j) contains a half twist and so Ï„ varies with fundamental region
{0 â‰¤Ï„ â‰¤â„“Î³i/2}. The reason is that every X âˆˆM1,1(L) comes with an
elliptic involution, but when (g, n) Ì¸= (1, 1), a generic point in Mg,n(L) does
not have any non trivial automorphism ï¬xing the boundary components set
wise. Therefore, since âˆ’âˆ—dL2 = âˆ’âˆ—dL/L, we get
Vol(Ï€âˆ’1(U)) = 2âˆ’M(Î³) Vol(U) Â· a1 Â· Â· Â· ak,
(8.3)
40

where M(Î³) is the number of connected components Î³ separating oï¬€a one-
handle.
Mg,n(L)Î“(a)
Ï€
âˆ’âˆ’âˆ’âˆ’â†’Mg,n(L)Î“âˆ—(a) âˆ¼=  Mgi,ni,Ai
ï£¦ï£¦
Mg,n(L)
Therefore, we have the following result:
Lemma 8.3. For any k-tuple Î“ = (Î³1, . . . , Î³k) of disjoint simple closed
curves, the canonical isomorphism
s : Mg,n(L)Î“âˆ—(a) â†’M(Sg,n(Î³), â„“Î“ = a, LÎ² = L) âˆ¼=
s

i=1
Mgi,ni(â„“Ai)
is a symplectomorphism.
Remark. By what we said, L2/2 is the moment map for the T k action,
and the space Mg,n(L)Î“âˆ—(a) is a symplectic quotient space ( See [Ki]). In
[Mirz2], we use this fact to relate the volume polynomials to the intersection
pairings of tautological classes over the moduli space.
Integrating geometric functions. Now we can use the preceding lemma
to integrate certain functions over the covering space Mg,n(L)Î“.
Lemma 8.4. For any function F : Rk â†’R, deï¬ne FÎ³ : Mg,n(L)Î“ â†’R by
FÎ³(Y ) = F(L(Y )).
Then the integral of FÎ³ over Mg,n(L)Î“ is given by

Mg,n(L)Î“
FÎ³(Y ) dY = 2âˆ’M(Î³)

xâˆˆRk
+
F(x) Vol(M(Sg,n(Î³), â„“Î² = L, â„“Î“ = x)) x dx,
where x = (x1, . . . , xn) and x Â· dx = x1 Â· Â· Â· xn Â· dx1 âˆ§Â· Â· Â· âˆ§dxn.
Proof. Note that the function FÎ³ is constant on each level set of Mg,n(L)Î“(a)
of L. Using Lemma 8.3 and equation 8.3, we get
Vol(Lâˆ’1(a1, Â· Â· Â· , ak)) = 2âˆ’M(Î³) a1 Â· Â· Â· ak Â· Vol(M(Sg,n(Î³), â„“Î² = L, â„“Î“ = a)),
and as a result we get
41

I(a) =

Mg,n(L)Î“(a)
F(â„“Î³(X)) dX = 2âˆ’M(Î³)Ã—
F(a) Â· Vol(M(Sg,n(Î³), â„“Î² = L, â„“Î³ = a)) Â· a1 Â· Â· Â· ak.
Now the result is immediate, since by Theorem 2.1, we have

Mg,n(L)Î“
FÎ³(Y ) dY =

xâˆˆRk
+
I(x) dx
2
Now we are ready to prove the main result of this section
Proof of Theorem 8.1. The function
Ï€Î“
âˆ—f : Mg,n(L) â†’R+
is given by
Ï€Î“
âˆ—f(X) =

hâˆˆModg,n /âˆ©Stab(Î³i)
f(â„“hÂ·Î³(X)).
(8.4)
Therefore by using equation (8.2) and Lemma 8.3, using the notation of
Lemma 8.4 the integral of Ï€Î“
âˆ—f over the moduli space is given by

Mg,n(L)
Ï€Î“
âˆ—f(X)dX =

Mg,n(L)Î“
FÎ³(Y )dY,
where F(x1, . . . , xk) = f(
k
i=1
cixi). Now we can use Lemma 8.4 to see that

Mg,n(L)
Ï€Î“
âˆ—f(X)dX
equals
2âˆ’M(Î³)

(x,t)âˆˆV
f(|x|) Vol(M(Sg,n(Î³), â„“Î“ = x, â„“Î² = L)) Â· x Â· dx dt.
On the other hand, we have,

gâˆˆModg,n /âˆ©Stab(Î³i)
f(â„“gÂ·Î³(X)) = Sym(Î³) Â·

[Î±]âˆˆ[Î³]Â·Modg,n
f(â„“Î±(X),
42

where
Sym(Î³) = | Stab(Î³)/ âˆ©Stab(Î³i)|.
Hence we get
Ï€Î“
âˆ—f(X) = Sym(Î³) Â· fÎ³(X).
2
9
Volumes of moduli spaces of bordered Riemann
surfaces
In this section we use the identity for lengths of simple closed geodesics in
Theorem 4.2 to derive the recursive formula for the Vg,n(L)â€²s stated in Â§5.
Idea of the calculation of Vg,n(L).
By Theorem 4.2, for any X âˆˆ
Tg,n(L1, . . . , Ln) we have

{Î±1,Î±2}âˆˆF1
D(L1, â„“Î±1(X), â„“Î±2(X)) +
n

i=2

Î³âˆˆF1,i
R(L1, Li, â„“Î³(X)) = L1, (9.1)
where as in Â§4, F1 and F1,j are respectively in one to one correspondence
with the set of pairs of pants containing Î²1 and {Î²1, Î²j}. Now let
ËœRj(X) =

Î³âˆˆF1,j
R(L1, Lj, â„“Î³(X)),
(9.2)
and
ËœD(X) =

(Î±1,Î±2)âˆˆF1
D(L1, â„“Î±(X), â„“Î²(X)).
Then from 9.1 we get
ËœD(X) +
n

j=2
Ëœ
Rj(X) = L1,
where ËœD and Ëœ
Rj are functions deï¬ned on Mg,n(L).
We use the description of Fi/ Modg,n and Fi,j/ Modg,n to reformulate
ËœRj and ËœD as push forwards of functions deï¬ned over certain coverings of the
moduli space of the form described in Â§8. This enables us to apply Theorem
8.1 and integrate these functions over Mg,n(L).
Topology of pairs of pants on a surface. We characterize the set of
topologically diï¬€erent pairs of pants containing Î²1.
43

..
Î²i1
Î²j1
Î²jn2
y
Î²n
x
Î²2
Î²1
x
..
...
Î²n
Î²1
x
Î²j
y
Î²1
Î²2
a)
b)
c)
Î²in1
Î£
Î£
Î£
Figure 8. a):|âˆ‚(Î£) âˆ©âˆ‚Sg,n| = 1, separating case b): non-separating case
c): |âˆ‚(Î£) âˆ©âˆ‚Sg,n| = 2
44

Let Î£ be a pair of pants such that Î²1 âˆˆâˆ‚(Î£). Then as in Figure 8 one
of the following holds.
I): Î£ contains two boundary components. If âˆ‚(Î£)âˆ©âˆ‚(Sg,n) = {Î²1, Î²j},
as in Fig 7.c, then âˆ‚Î£ âˆˆF1,j, and Sg,n(Î£) is homeomorphic to Sg,nâˆ’1 (See
also the deï¬nition of Bg,n).
II): Î£ contains one boundary component. If âˆ‚(Î£) âˆ©âˆ‚(Sg,n) = {Î²1}
then Î£ âˆˆF1, and Sg,n(Î£) can have 1 or 2 connected components.
Î£ is non-separating: In this case, as in Fig 7.b, Sg,n(Î£) is homeomorphic
to Sgâˆ’1,n+1 (See also the deï¬nition of Acon
g,n).
Î£ is separating: In this case , as in Fig 7.a, the elements of Ig,n are in one-
to-one correspondence with diï¬€erent topological types of separating pairs of
pants such that âˆ‚(Î£) âˆ©âˆ‚(Sg,n) = {Î²1} (See also the deï¬nition of Adcon
g,n ).
The action of Modg,n on F1 is not transitive, nevertheless the orbits
can be characterized by the topology of their complementary regions which
is determined by the number of the connected components, genus and the
number of boundary components of each connected component.
Proof of the recursive formula. Now we are ready to prove the recursive
formula stated in Â§5.
Theorem 9.1. For (g, n) Ì¸= (1, 1), (0, 3), the volume function Vg,n(L) satis-
ï¬es
âˆ‚
âˆ‚L1
L1Vg,n(L) = Acon
g,n(L) + Adcon
g,n (L) + Bg,n(L).
(9.3)
Proof. We can integrate both sides of the equation
ËœD(X) +
n

i=2
 ËœRi(X) = L1
over Mg,n(L) with respect to the volume form induced by the Weil-Petersson
symplectic form.
Therefore from equation 9.2 we get

2â‰¤j

Mg,n(L)
ËœRj(X) dX +

Mg,n(L)
ËœD(X) dX = L1 Â· Vg,n(L).
(9.4)
Next we calculate the integrals
Rj
g,n(L) =

Mg,n(L)
ËœRj(X) dX,
45

and
Dg,n(L) =

Mg,n(L)
ËœD(X) dX.
I): Integrating ËœRj. For 1 Ì¸= j the mapping class group Modg,n acts transi-
tively on F1,j and for any Î³ âˆˆF1,j we have
Modg,n Â·{Î³} = F1,j.
Let Î³j be a simple closed curve in F1,j. Consider the map Ï€Î³j : Mg,n(L)Î³j â†’
Mg,n(L), and deï¬ne RÎ³j : Mg,n(L)Î“ â†’R+ by
RÎ³j(X) = R(L1, Lj, â„“Î³j(X)).
Hence, we get
Ï€Î³j
âˆ—RÎ³j(X) =

Î³âˆˆF1,j/ Mod
R(L1, Lj, â„“Î³(X)),
and
ËœRj(X) = Ï€Î³j
âˆ—RÎ³j.
As Sg,n(Î³j) = Sg,nâˆ’1, and | Stab(Î³)| = 1, by using Theorem 8.1 to show that
we have
Rj
g,n(L) = 2âˆ’m(g,nâˆ’1)
âˆ

0
x Â· R(L1, Lj, x) Â· Vol(M(Sg,n(Î³j), â„“Î³j = x, L)) dx
= 2âˆ’m(g,nâˆ’1)
âˆ

0
x Â· R(L1, Lj, x) Â· Vg,nâˆ’1(x, L2, . . . , Ë†Lj, . . . , Ln)dx,
which can be calculated in terms of Vg,nâˆ’1.
Therefore, from equation 3.5
âˆ‚
âˆ‚L1
Rj
g,n(L)
equals
2âˆ’m(g,nâˆ’1)
2
âˆ

0
x (H(x, L1âˆ’Lj)+H(x, L1+Lj)) Vg,nâˆ’1(x, L2, . . . , Ë†Lj, . . . , Ln)dx.
46

Hence, from the deï¬nition of Bg,n we have
n

j=2
âˆ‚
âˆ‚L1
Rj
g,n(L) = Bg,n(L).
(9.5)
II): Integrating ËœD . Here we sketch the calculation for ËœD. For {Î±1, Î±2} âˆˆ
F1, let Î± = Î±1 + Î±2.
It is essential that by Lemma 3.1, the function
D(L1, â„“Î±1(X), â„“Î±2(X)) is in fact a function of L1 and â„“Î±(X) = â„“Î±1(X) +
â„“Î±2(X). Therefore by classifying the Modg,n orbits of F1, we can use Theo-
rem 8.1 for Î± = Î±1 + Î±2.
As in Â§5, let Ig,n be the set of all possible combinations of the genus and
set of boundary components of the complementary regions of elements of
F1. We can classify the orbits of the action of the mapping class group as
follows.
â€¢ Deï¬ne Acon to be the set of Î±1 + Î±2 such that the complement of the
pair of pants containing Î²1, Î±1, Î±2 is a connected surface of genus gâˆ’1
with n+1 boundary components. (See Figure 8). Then | Sym(Î±)| = 1
2.
See Â§2
â€¢ For a âˆˆ((g1, I), (g2, J)) âˆˆIg,n, let Aa be the set of Î± = Î±1 + Î±2 such
that the complement of the pair of pants containing Î²1, Î±1 and Î±2 is a
disjoint union of two surfaces S1 and S2, respectively homeomorphic
to Sg1,n1+1 and Sgâˆ’g1,n2+1, such that we have:
{Î²i1, . . . , Î²in1} âŠ‚âˆ‚S1, {Î²j1, . . . , Î²jn2} âŠ‚âˆ‚S2.
See Figure 8. The action of the mapping class group on Acon and Aa (a âˆˆ
Ig,n) is transitive and we have
F1 = Acon 
Adcon,
where
Adcon =

aâˆˆIg,n
Aa.
Choose Î³ âˆˆAcon and also, for each a âˆˆIg,n, choose Î±a an element of the
set Aa. Deï¬ne the set of representatives of the distinct orbits of Ig,n, C by
C = {Î±a | a âˆˆIg,n} âˆª{Î³}.
47

Hence C âˆ¼= F1/ Modg,n, and we have:
ËœD(X) =

Î±=Î±1+Î±2âˆˆC
Ï€Î±
âˆ—DÎ±(X),
where ËœD : MÎ±
g,n(L) â†’R+ is deï¬ned by
DÎ±(X) = D(L1, â„“Î±1(X), â„“Î±2(X)).
Also by what we showed in Â§2, for Î± âˆˆAa we have | Sym(Î±)| = 2 if and only
if I = J = Ï† and g1 = g2, otherwise | Sym(Î±)| = 1.
Therefore, from eqaution 3.4 and the deï¬nition of Acon and Adcon, we
get
âˆ‚
âˆ‚L1
Dg,n(L) = Acon
g,n(L) + Adcon
g,n (L).
(9.6)
Now the result is immediate from equations 9.4, 9.5 and 9.6.
Remark. The term 1/2 in equation 5.2 comes from sym(Î±) when Î± is non
seperating. Also, as the sum in the deï¬nition of 
Ag, n
dcon is over ordered
pairs ((g1, I1), (g2, I2)) in fact every term in the integral appears twice ex-
cept for the term corresponding to the g1 = g2, and I1 = I2 = Ï†. So by
considering 1/2 in equation 5.3, we will take care of the Sym(Î±).
2
References
[B]
A. Basmajian. The orthogonal spectrum of a hyperbolic manifold.
Amer. J. Math. 115(1993), 1139â€“1159.
[BS]
J. S. Birman and C. Series. Geodesics with bounded intersection
number on surfaces are sparsely distributed.
Topology 24(1985),
217â€“225.
[Bus]
P. Buser.
Geometry and Spectra of Compact Riemann Surfaces.
BirkhÂ¨auser Boston, 1992.
[CEG]
R. D. Canary, D. B. A. Epstein, and P. Green. Notes on notes of
Thurston. In Analytical and Geometric Aspects of Hyperbolic Space,
pages 3â€“92. Cambridge University Press, 1987.
[Gol]
W. Goldman. The symplectic nature of fundamental groups of sur-
faces. Adv. Math. 54(1984), 200â€“225.
48

[Har]
J. Harris and I. Morrison. Moduli of curves, volume 187 of Graduate
Texts in Mathematics. Springer-Verlag, 1998.
[KMZ] R. Kaufmann, Y.Manin, and D. Zagier. Higher Weil-Petersson vol-
umes of moduli spaces of stable n-pointed curves. Comm. Math.
Phys. 181(1996), 736â€“787.
[Ki]
F. Kirwan. Momentum maps and reduction in algebraic geometry.
Diï¬€erential Geom.Appl. 9(1998), 135â€“171.
[K]
M. Kontsevich. Intersection on the moduli space of curves and the
matrix airy function. Comm. Math. Phys. 147(1992).
[MaZ]
Y. Manin and P. Zograf. Invertible cohomological ï¬eld theories and
Weil-Petersson volumes.
Ann. Inst. Fourier(Grenoble) 50(2000),
519â€“535.
[McD]
D. McDuï¬€. Introduction to symplectic topology. Amer. Math. Soc.,
Providence, RI, 1999.
[M]
G. McShane.
Simple geodesics and a series constant over Te-
ichmÂ¨uller space. Invent. math. 132(1998), 607â€“632.
[Mirz1] M. Mirzakhani. Growth of the number of simple closed geodesics
on a hyperbolic surface. Preprint, 2003.
[Mirz2] M. Mirzakhani. Weil-Petersson volumes and intersection theory on
the moduli space of curves. Preprint, 2003.
[NN]
T. Nakanishi and M. NÂ¨aÂ¨atÂ¨anen. Areas of two-dimensional moduli
spaces. Proc. Amer. Math. Soc. 129(2001), 3241â€“3252.
[Pen]
R. Penner. Weil-Petersson volumes. J. Diï¬€erential Geom. 35(1992),
559â€“608.
[Wol1]
S. Wolpert.
The Fenchel-Nielsen deformation.
Annals of Math.
115(1982), 501â€“528.
[Wol2]
S. Wolpert. On the homology of the moduli space of stable curves.
Ann. of Math.(2) 118(1983), 491â€“523.
[Zo]
P. Zograf. The Weil-Petersson volume of the moduli space of punc-
tured spheres. In Mapping class groups and moduli spaces of Rie-
mann surfaces, volume 150 of Contemp. Math., pages 367â€“372.
Amer. Math. Soc., 1993.
49

