Simple geodesics and Weil-Petersson volumes of
moduli spaces of bordered Riemann surfaces
Maryam Mirzakhani
July 12, 2005
Contents
1
Introduction
1
2
Background material
8
3
Geometry of pairs of pants
13
4
Generalized McShane identity for bordered surfaces
18
5
Statement of the recursive formula for volumes
27
6
Polynomial behavior of the Weil-Petersson volume
30
7
Leading coeﬃcients of volume polynomials
34
8
Integration over the moduli space
36
9
Volumes of moduli spaces of bordered Riemann surfaces
43
1
Introduction
In this paper we investigate the Weil-Petersson volume of the moduli space of
curves with marked points. We develop a method for integrating geometric
functions over these moduli spaces, and obtain an eﬀective recursive for-
mula for the volume Vg,n(L1, . . . , Ln) of the moduli space Mg,n(L1, . . . , Ln)
of hyperbolic Riemann surfaces of genus g with n geodesic boundary compo-
nents. We show that Vg,n(L) is a polynomial whose coeﬃcients are rational
multiples of powers of π. The constant term of the polynomial Vg,n(L) is
1

the Weil-Petersson volume of the traditional moduli space of closed surfaces
of genus g with n marked points.
In forthcoming papers, we will use these results to investigate problems
related to the distribution of the lengths of simple closed geodesics on hyper-
bolic surfaces, volume of ϵ−thin part of the moduli space and intersection
theory on moduli spaces of curves.
Volume of the moduli space. When studying volumes of moduli spaces of
hyperbolic Riemann surfaces with cusps, it proves fruitful to consider more
generally bordered hyperbolic Riemann surfaces with geodesic boundary
components. Given L = (L1, . . . , Ln) ∈(R≥0)n, the mapping class group
Modg,n acts on the Teichm¨uller space Tg,n(L) of hyperbolic structures with
geodesic boundary components of length L1, . . . , Ln. We study the Weil-
Petersson volume of the quotient space
Mg,n(L) = Tg,n(L)/ Modg,n .
Our main result, obtained in §6, is:
Theorem 1.1. The volume Vg,n(L1, . . . , Ln) = Volwp(Mg,n(L)) is a poly-
nomial in L1, . . . , Ln; namely we have:
Vg,n(L) =

α
|α|≤3g−3+n
Cα · L 2α,
where Cα > 0 lies in π6g−6+2n−|2 α| · Q.
Here the exponent α = (α1, . . . , αn) ranges over elements in (Z≥0)n ,
Lα = Lα1
1 · · · Lαn
n , and |α| =
n
i=1
αi.
Moreover, in §5 we give an explicit recursive formula for calculating these
volumes. For example, we have:
V1,1(L) = L2/24 + π2/6.
For more examples see Table 1.
In particular, the Weil-Petersson volume of the moduli space of curves
of genus g with n marked point, the constant term of Vg,n(L), is a rational
multiple of π6g−6+2n. This result was previously obtained by S. Wolpert
[Wol2]. A formula for Vol0,n(0), the Weil-Petersson volume of M0,n, was
obtained in [Zo].
Remark. Note that there is a diﬀerence in the normalization of the volume
form; in [Zo] the Weil-Petersson K¨ahler form is 1/2 the imaginary part of
2

Table 1. Volumes of moduli spaces of curves
g
n
Vg,n(L)
0
3
1
1
1
1
24(L2 + 4π2)
0
4
1
2(4π2 + L2
1 + L2
2 + L2
3 + L2
4)
1
2
1
192(4π2 + L2
1 + L2
2)(12π2 + L2
1 + L2
2)
0
5
1
8

80π4 +
5
i=1
L4
i + 4

1≤i<j≤5
L2
i L2
j + 24π2
5
i=1
L2
i

2
1
1
2211840

4π2 + L2
1) (12π2 + L2
1) (6960π4 + 384 π2 L2
1 + 5 L4
1)
the Weil-Petersson pairing, while here we work with the imaginary part of
the pairing. So our answers are diﬀerent by a power of 2.
We approach the calculation of these volumes by studying the lengths of
simple closed geodesics on X ∈Mg,n. Our main tool is a generalization of
McShane’s identity [M], which gives us a way to calculate the volume of the
moduli space Mg,n = Tg,n/ Modg,n without having to ﬁnd a fundamental
domain for the action of the mapping class group on Teichm¨uller space.
McShane identity. Our point of departure for calculating these volume
polynomials is the following result [M]:
Theorem 1.2 (McShane). Let X be a hyperbolic once-punctured torus.
Then we have

γ
(1 + eℓγ(X))−1 = 1
2,
(1.1)
3

where the sum is over all simple closed geodesics γ on X.
Calculation of Vol(M1,1). We brieﬂy explain the relation between Mc-
Shane’s identity and Weil-Petersson volumes by treating the case g = n = 1.
Consider the space of pairs:
M∗
1,1 = {(X, γ) | X ∈M1,1, γ a simple closed geodesic on X},
and let
π : M∗
1,1 →M1,1
be the projection map, deﬁned by π(X, γ) = X. Also, deﬁne ℓ: M∗
1,1 →R
by
ℓ(X, γ) = ℓγ(X).
Then we can rewrite (1.1) as

π(Y )=X
f(ℓ(Y )) = 1
2,
(1.2)
where f(x) = (1 + ex)−1.
For any simple closed curve α on a hyperbolic once punctured torus, we
have M∗
1,1 = T1,1/ Stab(α). Now we use the Fenchel-Nielsen coordinates for
T1,1 about α; Any element (X, γ) ∈M∗
1,1 is determined by the pair (ℓ, τ),
the length and the twisting parameter of X around γ. Note that we have
φγ(ℓ, τ) = (ℓ, ℓ+ τ), where φγ denotes a right Dehn twist around γ. Hence
we have
M∗
1,1 ∼= {(ℓ, τ)|0 ≤ℓ≤τ}

(x, 0) ∼(x, x).
The Weil-Petersson symplectic form in Fenchel-Nielsen coordinates is
given by π∗(ωwp) = dℓ∧dτ. Therefore, we have

M1,1

π(Y )=X
f(ℓ(Y )) dX =

M∗
1,1
f(ℓ(Y )) dY =
∞

0
f(x)
x

0
1 dy dx.
Integrating McShane’s identity (1.2) over M1,1 against the Weil-Petersson
volume form, we obtain
Vol(M1,1) = 2
∞

0
ℓf(ℓ) dℓ= 2
∞

0
ℓ
1 + eℓdℓ= π2
6 .
Calculation of Vg,n. To carry out a similar analysis for Mg,n we will:
4

(I): Generalize McShane identity (Theorem 1.2) to arbitrary hyperbolic
surfaces with geodesic boundary components (§4), and
(II): Develop a method to integrate functions given in terms of the hy-
perbolic length functions over the moduli space (§8).
The result is a recursive formula for the volume polynomial Vg,n(L) ob-
tained in §9.
We now turn into a more detailed account of two main steps of the proof:
(I): Generalized McShane’s identity.
McShane [M] gives a version
of formula (1.1) for punctured Riemann surfaces of higher genus. In our
discussion, we need a further generalization to bordered Riemann surfaces
with geodesic boundary components. Roughly speaking, we want to ﬁnd a
function deﬁned on Teichm¨uller space such that the sum of its values over
the elements of each orbit of Modg,n is a constant independent of the orbit.
In §3 we introduce two auxiliary functions D, R : R3
+ →R+ related to the
geometry of hyperbolic pairs of pants. A central role in our approach to
volumes of moduli spaces is played by the following result (§4 ):
Theorem 1.3. For any hyperbolic surface X with n geodesic boundary com-
ponents β1,. . . ,βn of lengths L1, . . . , Ln, we have

{α1,α2}
D(L1, ℓα1(X), ℓα2(X)) +
n

i=2

γ
R(L1, Li, ℓγ(X)) = L1.
(1.3)
Here the ﬁrst sum is over all unordered pairs of simple closed geodesics
{α1, α2} bounding a pair of pants with β1, and the second sum is over simple
closed geodesics γ bounding a pairs of pants with β1 and βi.
In the formula above, we also allow βi to be a cusp of X, by regarding it as
a geodesic of length 0.
As a special case, for any hyperbolic surface X of genus one with one
geodesic boundary component of length L, we get

γ
D(L, ℓγ(X), ℓγ(X)) = L,
(1.4)
where the sum is over all simple closed geodesics γ on X. On the other
hand, we have (§3)
D(x, y, y) ∼
2x
1 + ey
as x →0, therefore our formula for genus one hyperbolic surfaces with one
geodesic boundary component (1.4) implies the original McShane identity
(1.1) when L →0.
5

(II): Integration over the moduli space. In §8, we develop a method for
integrating the right hand side of the identity for the lengths of simple closed
geodesics (1.3) over Mg,n(L).
Working with bordered Riemann surfaces
allows us to exploit the existence of commuting Hamiltonian S1-actions on
certain coverings of the moduli space in order to integrate certain geometric
functions over the moduli space of curves.
Let Sg,n be a closed surface of genus g with n boundary components and
Y ∈Tg,n. For any simple closed curve γ on Sg,n, let [γ] denote the homo-
topy class of γ and let ℓγ(Y ) denote the hyperbolic length of the geodesic
representative of [γ] on Y .
To each simple closed curve γ on Sg,n, we associate the set
Oγ = {[α] |α ∈Modg,n ·γ}
of homotopy classes of simple closed curves in the Modg,n-orbit of γ on
X ∈Mg,n. For any function f : R+ →R+,
fγ(X) =

[α]∈Oγ
f(ℓα(X)),
deﬁnes a function
fγ : Mg,n →R.
Here we sketch the main idea of calculating the integral of fγ over Mg,n with
respect to the Weil-Petersson volume form when γ is a connected simple
closed curve. See Theorem 8.1 for the general case.
First, consider the covering space of Mg,n
πγ : Mγ
g,n = {(X, α) | X ∈Mg,n, and α ∈Oγ is a geodesic on X } →Mg,n,
where πγ(X, α) = X. The hyperbolic length function descends to the func-
tion,
ℓ: Mγ
g,n →R
deﬁned by ℓ(X, η) = ℓη(X). Therefore, we have

Mg,n
fγ(X) dX =

Mγ
g,n
f ◦ℓ(Y ) dY.
On the other hand, The function f is constant on each level set of ℓand we
have

Mγ
g,n
f ◦ℓ(Y ) dY =
∞

0
f(t) Vol(ℓ−1(t)) dt,
6

where the volume is taken with respect to the volume form −∗dℓon ℓ−1(t).
The main idea for integrating over Mγ
g,n is that the decomposition of the
surface along γ gives rise to a description of Mγ
g,n in terms of moduli spaces
corresponding to simpler surfaces. This leads to formulas for the integral
of fγ in terms of the Weil-Petersson volumes of moduli spaces of bordered
Riemann surfaces and the function f.
Let Sg,n(γ) be the result of cutting the surface Sg,n along γ; that is
Sg,n(γ) ∼= Sg,n −Uγ, where Uγ is an open neighborhood of γ homeomorphic
to γ × (0, 1). Thus Sg,n(γ) is a possibly disconnected compact surface with
n+2 boundary components. We deﬁne M(Sg,n(γ), ℓγ = t) to be the moduli
space of Riemann surfaces homeomorphic to Sg,n(γ) such that the lengths
of the 2 boundary components corresponding to γ are equal to t. We have
a natural circle bundle
ℓ−1(t) ⊂Mγ
g,n

M(Sg,n(γ), ℓγ = t)
We will study the S1-action on the level set ℓ−1(t) ⊂Mγ
g,n induced by
twisting the surface along γ. The quotient space ℓ−1(t)/S1 inherits a sym-
plectic form from the Weil-Petersson symplectic form. On the other hand,
M(Sg,n(γ), ℓγ = t) is equipped with the Weil-Petersson symplectic form.
By investigating these S1-actions in more detail in §8 we show that
ℓ−1(t)/S1 ∼= M(Sg,n(γ), ℓγ = t)
as symplectic manifolds. So we expect to have
Vol(ℓ−1(t)) = t Vol(M(Sg,n(γ), ℓγ = t)).
But as we will see in §8, the situation is diﬀerent when γ seperates oﬀa
one-handle in which case the length of the ﬁber at a point is in fact t/2
instead of t. For any connected simple closed curve γ on Sg,n, we have

Mg,n
fγ(X) dX = 2−M(γ)
∞

0
f(t) t Vol(M(Sg,n(γ), ℓγ = t)) dt,
(1.5)
where M(γ) = 1 if γ seperates oﬀa one-handle, and M(γ) = 0 otherwise.
An alternative proof of Theorem 1.1. The method of symplectic reduc-
tion can be used to show that Vg,n(L) is a polynomial in L. In a sequel, we
obtain a formula for Vg,n(L) in terms of intersection numbers of tautological
7

classes over Mg,n. However, this symplectic method does not lead us to a
recursive algorithm for calculating the volumes explicitly.
Applications. In forthcoming papers, we will study the connection of the
polynomial Vg,n(L) with the length distribution of simple closed geodesics on
a hyperbolic surface [Mirz1]. We also relate the coeﬃcients of the volume
polynomial Vg,n(L) to intersection numbers of tautological line classes on
Mg,n [Mirz2]. The algorithm for calculating Vg,n(L) presented in §5 leads
to a new proof of the Virasoro constraints for a point which is equivalent to
the Witten-Kontsevich formula [K].
Notes and references. The Weil-Petersson volume of the moduli space
of punctured Riemann surfaces arises naturally in diﬀerent contexts[KMZ].
A recursive formula for the Weil-Petersson volume of the moduli space of
punctured spheres was obtained by Zograf [Zo]. Moreover, Zograf and Manin
have obtained generating functions for the Weil-Petersson volume of Mg,n
[MaZ]. Also, R. Penner has developed a diﬀerent method for calculating the
Weil-Petersson volume of the moduli spaces of curves with marked points
by using decorated Teichm¨uller theory and calculated the Weil-Petersson
volume of M1,2 [Pen]. The volume polynomial V1,1(L) was also previously
obtained in [NN] by ﬁnding a fundamental domain for the action of the
mapping class group on Teichm¨uller space.
Acknowledgments. I would like to thank Curt McMullen for his invaluable
help and many stimulating discussions over the course of this work. I am also
grateful to Said Akbari, Izzet Coskun, Maxim Kontsevich, Chiu-Chu Melissa
Liu, Andrei Okounkov, Rahul Pandharipandeh, S.T. Yau and Igor Riven for
helpful discussions. I would like to thank Greg McShane and Scott Wolpert
for many helpful comments and dscussions. The author would also like to
thank the Max Planck Institute of Mathematics in Leipzig and the Institute
for Studies in Theoretical Physics and Mathematics (IPM) in Tehran for
their hospitality during the writing of this paper.
2
Background material
In this section, We present some familiar concepts in a less familiar setting
about the symplectic structure of the moduli space of bordered Riemann
surfaces and the space of measured geodesic laminations.
we also recall
some basic facts and results on hyperbolic geometry.
Recall that a symplectic structure on a manifold M is a non-degenerate
8

closed 2-form ω ∈Ω2(M). The n-fold wedge product
1
n! ω ∧· · · ∧ω
never vanishes and deﬁnes a volume form on M.
Teichm¨uller Space. Here we brieﬂy summarize the background material
on Teichm¨uller theory of Reimann surfaces with geodesic boundary compo-
nents.
A point in the Teichm¨uller space T (S) is a complete hyperbolic surface X
equipped with a diﬀeomorphism f : S →X. The map f provides a marking
on X by S. Two marked surfaces f : S →X and g : S →Y deﬁne the
same point in T (S) if and only if f ◦g−1 : Y →X is isotopic to a con-
formal map. When ∂S is nonempty, consider hyperbolic Riemann surfaces
homeomorphic to S with geodesic boundary components of ﬁxed length.
Let A = ∂S and L = (Lα)α∈A ∈R|A|
+ . A point X ∈T (S, L) is a marked
hyperbolic surface with geodesic boundary components such that for each
boundary component β ∈∂S, we have
ℓβ(X) = Lβ.
Let Sg,n be an oriented connected surface of genus g with n boundary com-
ponents (β1, . . . , βn). Then
Tg,n(L1, . . . , Ln) = T (Sg,n, L1, . . . , Ln),
denote the Teichm¨uller space of hyperbolic structures on Sg,n with geodesic
boundary components of length L1, . . . , Ln. By convention, a boundary
geodesic of length zero is a cusp and we have
Tg,n = Tg,n(0, . . . , 0).
Let Mod(S) denote the mapping class group of S, or the group of isotopy
classes of orientation preserving self homeomorphisms of S leaving each
boundary component set wise ﬁxed. The mapping class group Modg,n =
Mod(Sg,n) acts on Tg,n(L) by changing the marking. The quotient space
Mg,n(L) = M(Sg,n, ℓβi = Li) = Tg,n(L1, . . . , Ln)/ Modg,n
is the moduli space of Riemann surfaces homeomorphic to Sg,n with n
boundary components of length ℓβi = Li. Also, we have
Mg,n = Mg,n(0, . . . , 0).
9

For a disconnected surface S =
k	
i=1
Si such that Ai = ∂Si ⊂∂S, we have
M(S, L) =
k

i=1
M(Si, LAi),
where LAi = (Ls)s∈Ai.
The Weil-Petersson symplectic form. By work of Goldman [Gol], the
space Tg,n(L1, . . . , Ln) carries a natural symplectic form invariant under the
action of the mapping class group. Th is symplectic form is called Weil-
Petersson symplectic form, and denoted by ω or ωwp. In this paper, we
are interested in calculating the volume of the moduli space with respect to
the volume form induced by the Weil-Petersson symplectic form. Note that
when S is disconnected, we have
Vol(M(S, L)) =
k

i=1
Vol(M(Si, LAi)).
The Fenchel-Nielsen coordinates. A pants decomposition of S is a set of
disjoint simple closed curves which decompose the surface into pairs of pants.
Fix a system of pants decomposition of Sg,n, P = {αi}k
i=1, where k = 6g−6+
2n. For a marked hyperbolic surface X ∈Tg,n(L), the Fenchel-Nielsen coor-
dinates associated with P, {ℓα1(X), . . . , ℓαk(X), τα1(X), . . . , ταk(X)}, con-
sists of the set of lengths of all geodesics used in the decomposition and
the set of the twisting parameters used to glue the pieces.
We have an
isomorphism
Tg,n(L) ∼= RP
+ × RP
by the map
X →(ℓαi(X), ταi(X)).
By work of Wolpert, over Teichm¨uller space the Weil-Petersson symplectic
structure has a simple form in Fenchel-Nielsen coordinates [Wol1].
Theorem 2.1 (Wolpert). The Weil-Petersson symplectic form is given by
ωwp =
k

i=1
dℓαi ∧dταi.
Twisting. For any simple closed geodesic α on X ∈Tg,n(L) and t ∈R, we
can deform the hyperbolic structure as follows. We cut the surface along α,
10

turn left hand side of α in the positive direction the distance t and reglue
back. Let us denote the new surface by twtα(X). As t varies, the resulting
continuous path in Teichm¨uller space is the Fenchel-Nielsen deformation of
X along α. For t = ℓα(X), we have
twtα(X) = φα(X),
where φα ∈Mod(Sg,n) is a right Dehn twist about α.
By Wolpert’s result (Theorem 2.1), the vector ﬁeld generated by twisting
around α is symplectically dual to the exact one form dℓα. In other words,
twtα is the Hamiltonian ﬂow of the length function.
Splitting along a simple closed curve.
α
α2
α1
β2
β4
β1
β2
β1
β3
β3
β4
Figure 1. Cutting the surface
Let γ
γ =
k

i=1
ciγi,
where γ1, . . . and γk are distinct, disjoint simple closed curves, be the isotopy
class of a multi curve on Sg,n.
Consider the surface Sg,n −Uγ, where Uγ is an open set homeomorphic
to 	k
1(0, 1) × γi around γ.
We denote this surface by Sg,n(γ), which is
a (possibly disconnected) surface with n + 2k boundary components and
s = s(γ) connected components. Each connected component γi of γ, gives
rise to 2 boundary components, γ1
i and γ2
i on Sg,n(γ). Namely,
∂(Sg,n(γ)) = {β1, . . . , βn} ∪{γ1
1, γ2
1, . . . , γ1
k, γ2
k}.
Now for Γ = (γ1, . . . , γk), L = (L1, . . . , Ln) and x = (x1, . . . , xk) ∈Rk
+, let
M(Sg,n(γ), ℓΓ = x, ℓβ = L)
11

be the moduli space of hyperbolic Riemann surfaces homeomorphic to Sg,n(γ)
such that ℓγi = xi and ℓβi = Li. Also, deﬁne Vg,n(Γ, x, β, L) by
Vg,n(Γ, x, β, L) = Vol(M(Sg,n(γ), ℓΓ = x, ℓβ = L)).
We can write Sg,n(γ) as a union of its connected components
Sg,n(γ) =
s
i=1
Sgi,ni , Ai = ∂Si ⊂B.
(2.1)
Then in terms of the above notation, we have
M(Sg,n(γ), ℓΓ = x, ℓβ = L) ∼=
s

i=1
Mgi,ni(ℓAi),
where ℓAi = (ℓα)α∈Ai, and consequently we get
Vg,n(Γ, x, β, L) =
s

i=1
Vgi,ni(ℓAi).
Symmetry group of a multi curve. For any set A of homotopy classes
of simple closed curves on Sg,n, deﬁne Stab(A) by
Stab(A) = {h ∈Modg,n | h · A = A} ⊂Modg,n .
For γ =
k
i=1
ciγi, deﬁne the symmetry group of γ, Sym(γ), by
Sym(γ) = Stab(γ)/ ∩k
i=1 Stab(γi).
In fact, when γ has extra symmetry
k
i=1
Stab(γi) ̸= Stab(γ).
First, for any connected simple closed curve α, | Sym(α)| = 1.
Note | Sym(γ)| ̸= 1 for
γ =
k

i=1
ciγi
will put a non trivial condition on the c′
is.
For example | Sym(γ)| = k!
implies that c1 = c2 = . . . = ck.
12

When k = 2, by the deﬁnition
| Sym(γ1 + γ2)| = 2
if and only if Sg,n(γ1) is homeomorphic to Sg,n(γ2).
Here we want the
homemorphisem to ﬁx each boundary component of ∂(Sg,n) setwise, and
send γ1 to γ2.
Later we will be interested in the case where γ bounds a pair of pants with
a boundary component of Sg,n. It is easy to check that | Sym(γ1 + γ2)| = 2
if and only either Sg,n(γ) is connected or
Sg,n(γ) ∼= Sg1,1 ∪Sg1,1.
Simple closed curves on X ∈Mg,n. Let [γ] denotes the homotopy class
of a simple closed curve γ on Sg,n. Although there is no canonical simple
closed geodesic on X ∈Mg,n corresponding to [γ], the set
Oγ = {[α]| α ∈Mod ·γ},
of homotopy classes of simple closed curves in the Modg,n-orbit of γ on X, is
determined by γ. In other words, Oγ is the set of [φ(γ)] where φ : Sg,n →X
is a marking of X. Let ℓα(X) denote the hyperbolic length of α on X. Here,
we study functions of the form
fγ : Mg,n →R+
X →

α∈Oγ
f(ℓα(X)),
where f : R →R+.
As an example, for f = χ[0, L), the characteristic function of [0, L), fγ(X)
is equal to the number of elements of Oγ of length less than L on X.
3
Geometry of pairs of pants
In this section we study inﬁnite simple geodesic rays on a hyperbolic pair
of pants. For background on hyperbolic geometry see [Bus].
A pair of pants is an oriented compact surface homeomorphic to S0,3, a
surface of genus-0 with three boundary components.
Let C(x1, x2, x3) be the unique hyperbolic pair of pants with geodesic
boundary curves (βi)3
i=1 such that ℓβi(C) = xi, i = 1, 2, 3. We also allow the
degenerate case in which one or more of the lengths vanish.
13

β3
β2
y1
w2
w1
z1
β1
Figure 2. complete geodesics in a pair of pants
Each boundary component of C has two canonical points, the end points
of the length minimizing geodesics connecting it to the other two boundary
components.
On the other hand, we can obtain C(x1, x2, x3) by pasting two copies
of the (unique) right angled geodesic hexagons with pairwise non-adjacent
sides of length x1/2, x2/2 and x3/2 along the remaining three sides. Thus
C(x1, x2, x3) admits a reﬂection involution σ which interchanges the two
hexagons.
Complete geodesics on hyperbolic a pair of pants. A hyperbolic pair
of pants contains 5 complete geodesics disjoint from β2, β3 and orthogonal
to β1. More precisely, 2 of these geodesics meet β1 at y1 and y2 and spiral
around β3, the other 2 meet β1 at z1 and z2 and spiral around β2. There
is also a unique common simple geodesic perpendicular from β1 to itself
meeting β1 perpendicularly at 2 points, w1 and w2.
Note that we have
σ(w1) = w2, σ(z1) = z2, and σ(y1) = y2. See Figure 2.
Deﬁnitions. Deﬁne R(x1, x2, x3) to be the geodesic length of (y1, y2), the
interval between y1 and y2 along β1 containing w1 and w2.
For caclulating
the function R, we consider the universal cover of C. Then it is easy to check
that
x1 −R(x1, x2, x3)
is equal to the geodesic length of the projection of β3 on β1. See Figure 3.
Note that this length does not depend on the choice of the lift of C.
Also, deﬁne D(x1, x2, x3) to be the sum of the geodesic length of (y1, z1)
and (y2, z2), the interval between yi and zi containing wi on β1.
So the
14

p1
p2
p3
β1
β3
r3
r2
r1
Figure 3. Projection of a geodesic
function D(x1, x2, x3) is twice the geodesic distance between two geodesics
perpendicular to β1 spiraling around β2 and β3. Equivalently in the universal
cover of C, D(x1, x2, x3) equals 2 times the distance between the projection
of β2 and β3 on β1.
Also, deﬁne H : R2 →R by
H(x, y) =
1
1 + e
x+y
2
+
1
1 + e
x−y
2
.
Basic properties of D and R. It can be easily checked that the functions
D and R satisfy
D(x1, x2, x3) = D(x1, x3, x2),
and
R(x1, x2, x3) + R(x1, x3, x2) = x1 + D(x1, x2, x3).
Moreover, one can explicitly calculate these functions and show that:
Lemma 3.1. The functions D and R are given by
D(x, y, z) = 2 log

e
x
2 + e
y+z
2
e
−x
2 + e
y+z
2

,
(3.1)
and
R(x, y, z) = x −log
cosh(y
2) + cosh(x+z
2 )
cosh(y
2) + cosh(x−z
2 )

.
(3.2)
15

Proof. It is enough to calculate R(x, y, z). Using basic trigonometry (e.g.
Theorem 2.3.1 of [Bus]) in any geodesic quadrilateral with three right angles
and consecutive sides of lengths a, b, inﬁnity and inﬁnity (when one vertex
is on the boundary at inﬁnity ), we have
Sinh(a) · Sinh(b) = 1.
(3.3)
Let r3 p3 be the unique geodesic perpendicular to β3 and β1. Now by apply-
ing formula (3.3) to two geodesic quadrilaterals r1 r3 p1 p3 and r3 r2 p3 p2
in Figure 3, we have
R(x1, x2, x3) = x1 −2 arcsinh

1
sinh(d(β1, β3))

.
On the other hand by cutting the pairs of pants along the shortest geodesics
joining distinst boundary components, we obtain two convex right-angled
geodesic hexagons with consecutive sides of lengths x1/2, d(β1, β2), x2/2,
d(β2, β3), x3/2 and d(β3, β1). This means that x1, x2 and x3 uniquely de-
termine d(β1, β3). Using basic trigonometry of hyperbolic hexagons ( e.g.
Theorem 2.4.1 in [Bus] ), we get
cosh(d(β1, β3)) = cosh(x2
2 ) + cosh(x3
2 ) cosh(x1
2 )
sinh(x3
2 ) sinh(x1
2 )
.
See §2 of [Bus] for more details.
On the other hand, since arcsinh(z) = log(z +
√
z2 + 1) we have
2 arcsinh

1
sinh(α)

= 2 log

1
sinh(α) + cosh(α)
sinh(α)

= log
cosh(α) + 1
cosh(α) −1

,
therefore,
R(x1, x2, x3) = x1 −log
 cosh(d(β1, β3) + 1
cosh(d(β1, β3)) −1

,
which implies equation 3.2.
2
Remark. Equation (3.1) shows that D is a function of x and y + z. Next
lemma allows us to simplify integrals involving D and R :
Lemma 3.2. The functions D, R : R+ →R+ satisfy the following equations:
∂
∂xD(x, y, z) = H(y + z, x),
(3.4)
and
∂
∂xR(x, y, z) = 1
2(H(z, x + y) + H(z, x −y)).
(3.5)
16

Proof. Equation (3.4) is a straight forward calculation from equation (3.1),
since we have
∂
∂xD(x, y, z) =
ex/2
ex/2 + e(y+z)/2 +
e−x/2
e−x/2 + e(y+z)/2 = H(y + z, x).
On the other hand, using Lemma 3.1, one can show that
D(x, y, z) + D(x, −y, z) = 2 R(x, y, z)
which implies (3.5).
2
Asymptotic behavior of D and R. Functions D and R are continuous
on R3
+. As 0 < D(x, y, z) ≤x and 0 < R(x, y, z) ≤x, both D(x, y, z) and
R(x, y, z) go to zero when x →0. By using Lemma 3.2 it is easy to verify
that
D(x, y, z) ∼x H(y + z, x) ∼
2x
1 + e
y+z
2
,
(3.6)
R(x, y, z) ∼x

1
1 + e
z+y
2
+
1
1 + e
z−y
2

, R(x, x, z) ∼
2x
1 + e
z
2 ,
(3.7)
as x →0.
Moreover, we have:
Lemma 3.3. There are constants c1, c2 > 0 such that for any x ≤1 we
have

D(x, y, z)
x
−
1
1 + e
y+z
2
 ≤c1 x e
−(y+z)
2
,

R(x, y, z)
x
−

1
1 + e
z+y
2
+
1
1 + e
z−y
2
 ≤c2 x e
−z
2 .
Also, when x and y are ﬁxed numbers as z →∞, we have
R(x, y, z) →0,
similarly, when x is a ﬁxed number as y, z →∞,
D(x, y, z) →0.
17

4
Generalized McShane identity for bordered sur-
faces
In this section, we generalize McShane’s identity for bordered hyperbolic
Riemann surfaces with geodesic boundary components.
Embedded Pairs of pants. We say three isotopy classes of connected
simple closed curves, (α1, α2, α3) on Sg,n, bound a pair of pants if there
exists an embedded pair of pants Σ ⊂Sg,n such that ∂Σ = {α1, α2, α3}.
Here αi can be a boundary component and we consider punctures as simple
closed geodesics of length 0. The statement of Theorem 1.3 motivates the
following deﬁnitions.
• For 1 ≤i ≤n, let Fi be the set of unordered pairs of isotopy classes of
simple closed curves {α1, α2} bounding a pairs of pants with βi such
that α1, α2 ̸∈∂(Sg,n);
• For 1 ≤i ̸= j ≤n, let Fi,j be the set of isotopy classes of simple closed
curves γ bounding a pairs of pants containing βi and βj.
An identity for lengths of simple closed geodesics. First we state
an identity for lengths of simple closed geodesics on hyperbolic punctured
surfaces due to G. McShane [M]:
Theorem 4.1. Let {pi}n
1 be the set of punctures of X ∈Tg,n. Then we have

{α1,α2}∈F1
1
1 + e
ℓα1 (X)+ℓα2 (X)
2
+
n

i=2

γ∈F1,i
1
1 + e
ℓγ (X)
2
= 1
2.
We will use the properties of functions D, R : R3
+ →R+, deﬁned in the
preceding section, and the geometry of complete simple geodesics on a hy-
perbolic surface to get the following result for hyperbolic bordered Riemann
surfaces with geodesic boundary components:
Theorem 4.2 (Generalized McShane identity for bordered sur-
faces). For any X ∈Tg,n(L1, . . . , Ln) with 3g −3 + n > 0, we have

{α1,α2}∈F1
D(L1, ℓα1(X), ℓα2(X)) +
n

i=2

γ∈F1,i
R(L1, Li, ℓγ(X)) = L1. (4.1)
Note that as L1 →0 both sides of (4.1) tend to zero and β1 tends to a
puncture p1. Using (3.6) and (3.7), the following Corollary is an immediate
result of Theorem 4.2 :
18

Corollary 4.3. For any X ∈Tg,n(0, L2, . . . , Ln) with 3g −3 + n > 0, we
have

{α1,α2}∈F1
1
1 + e
ℓα1 (X)+ℓα2 (X)
2
+
n

i=2

γ∈F1,i
1
2

1
1 + e
ℓγ (X)+Li
2
+
1
1 + e
ℓγ (X)−Li
2

= 1
2.
(4.2)
Notice that corollary 4.3 implies Theorem 4.1.
Remark. To prove Theorem 4.2, we basically follow the proof presented
in [M] almost line for line by relating the topology of the union of complete
simple geodesics perpendicular to all boundary components to the global
behavior of simple closed geodesics. See also [B] for a related result for the
lengths of common orthogonals of two totally geodesic hypersurfaces on a
hyperbolic manifold.
Union of complete simple geodesics.
Let E(X) be the union of all
simple complete geodesics perpendicular to all boundary components and
Ei = E ∩βi.
Given x ∈Ei, let γx, the geodesic emanating from x, denote the complete
simple geodesic perpendicular to βi such that x ∈γx.
Theorem 4.4. The set Ei ⊂βi, deﬁned as above, has measure zero.
Proof. By a result due to Birman and Series [BS], the union of all com-
plete geodesics on a closed surface has Hausdorﬀdimension 1. Doubling the
bordered surface along its boundary components shows that the same state-
ment holds for a bordered surface. That is µ(E) = 0. Therefore, E ∩Uβi
has measure zero , where Uβi is the collar neighborhood around βi. Because
of the structure of the collar neighborhood we have
µ(E ∩Uβi) = sinh r × µ(Ei),
where r is the width of the collar neighborhood. So µ(E ∩Uβi) = 0 implies
that µ(Ei) = 0.
2
Later we show that:
Theorem 4.5. Each Ei is homeomorphic to the Cantor set union countably
many isolated points.
19

Characterization of boundary and isolated points in Ei. In this part
we give a characterization of boundary and isolated points in Ei. We say
a lamination γ spirals to a lamination Ω(γ) iﬀΩ(γ) is in the closure of γ.
It can be easily checked that when γ is a ray, Ω(γ) is actually a minimal
lamination. Note that for x ∈Ei, the corresponding simple geodesic ray, γx
falls into exactly one of the following two classes.
1. The other end spirals into a compact minimal lamination inside the
surface, which will be denoted by Ω(γx).
2. The other end also approaches a (not necessarily distinct) boundary
component βi in which case either the ray γx meets βi perpendicularly
or spirals around it.
We will prove the following classiﬁcation of points in Ei in terms of the
behavior of the corresponding complete simple geodesics (See [M]) :
Theorem 4.6. For any x ∈Ei, exactly one of the following holds:
a) The point x is an isolated point of Ei if the other end of γx approaches a
boundary component.
b) If Ω(γx) is a not a simple closed curve then x is neither a boundary nor
an isolated point in Ei.
c) The point x is a boundary point of Ei if Ω(γx) is a simple closed curve
inside the surface.
Figure 4. Finding the pair of pants containing a simple geodesic
Notice that, as shown in Figure 4, for any γ joining two boundary compo-
nents, there exists a unique embedded pair of pants containing γ and these
(not necessarily distinct) boundary components.
Also in each pair of pants containing two (not necessarily distinct) bound-
ary components, there exists a unique simple geodesic joining them perpen-
dicularly.
20

Proof of Theorem 4.6(a). let x = x1 ∈X1 be such that the other end of
γx goes up to β1 and let x2 ∈β1 be such that
γx ∩β1 = {x, x2}.
One can easily modify the argument for other cases. Let Σ denote the pair
of pants containing γx1 such that ∂Σ = {β1, α1, α2}. There are precisely 4
inﬁnite geodesic rays in Σ meeting β1 perpendicularly at one point (as in
Figure 1). Let γyi and γzi be the ones spiraling around αi for i = 1, 2 such
that x1 ∈X1 ∩(y1, z1) and x2 ∈X1 ∩(y2, z2). We claim that
X1 ∩(y1, z1) = x1,
and
X1 ∩(y2, z2) = x2.
if γz is a simple geodesic ray and z ̸∈{x1, x2, y1, y2, w1, w2}, γz must leave
˜z
r1
r2
s1
h
˜β
˜α1
Figure 5. Universal cover of a pair of pants
Σ and hence meet α1∪α2. Without loss of generality, we can assume that γz
meet α1 ﬁrst. In the universal cover of this pair of pants, as shown in Figure
5, let ˜β, joining s1 and ∞, be a lift of β1. Also, let ˜α1, joining r1 and r2,
be the outermost lift of α1 meeting ˜γz. Consider ψ1 and ψ2, two geodesics
perpendicular to ˜β passing through the two end points of ˜α1. And let η1
(resp. η2) be the piecewise geodesic path going from ˜z to h along ˜γz and
from h to r1(resp. r2) along ˜α1 As both α1 and γz are simple, the projection
of η1 and η2 are simple rays on the surface. On the other hand, since ˜α1 is
the outermost lift of α1 meeting γz the projection of η1 and η2 are disjoint
21

from both α1 and α2. Therefore, the projections are inﬁnite simple geodesic
rays on Σ.
Furthermore, η1 (resp. η2) is homotopic to ψ2( resp. η2). This shows
that the projections of ψ1 and ψ2 are complete simple geodesics on Σ. Since
both ψ1 and ψ2 are asymptotic to a lift of α1, their images spiral to α1.
Therefore a1 and a2 are actually pre images of z1 and y1. Also, for any
x ∈[a1, a2] the curve γx meets α. Therefore, we have z ∈[y1, z1].
2
Next, assume that γx spirals into a compact minimal lamination Ω(γx)
which is not a simple closed curve. To prove part (b) we construct a sequence
{xj} ⊂Ei getting close to x from both side on βi. So roughly, we need to
approximate γx with simple complete geodesics from both sides.
Quasi-geodesics. Later, we construct paths with uniformly bounded small
curvature approximating a complete simple geodesic.
A path α(t) in H, parameterized by arclength, is a quasi geodesic if
d(α(s), α(t)) > ϵ|s −t|
for all s and t. One can show that any quasi geodesic is a bounded distance
from a unique geodesic. See [CEG] for more details.
The main point is that it is easier to construct quasi geodesics approximating
a complete geodesic.
Lemma 4.7. A polygon path α of segments of length at least L and bends at
most θ < π is a quasi-geodesic when L is long enough compared to θ. Also
as (L, θ) →(∞, 0) the distance from α to its straightening tends to zero.
In the next 3 parts, we show how one can approximate γx with simple
complete geodesics using quasi geodesics:
I): Good geodesic segments. Let α(t) be the arc length parameterization
of a simple geodesic segment on X, t0 < t1 ∈R, ϵ > 0 and c : [0, 1] →X be
a diﬀerentiable arc transverse to α such that
c(0) = α(t0) , c(1) = α(t1).
We say that (α, t0, t1, c) is an ϵ-good geodesic arc iﬀ
• ℓ(c) ≤ϵ,
• The arc c is almost perpendicular to α, that is
|∠(c′(0), α′(t0)) −π
2 | ≤ϵ,
22

c
α(t0)
α
α(t1)
Figure 6. A good geodesic segment
|∠(c′(1), α′(t1)) −π
2 | ≤ϵ,
and
• The arc c meets the geodesic arc α in only two points,
c ∩{α(t)|t0 ≤t ≤t1} = {α(t0), α(t1)}.
Consider the vectors α′(t0) and c′(0)) at point c(0) = α(t0), and α′(t1)
and c′(1)) at the point c(1) = α(t1).
We say (α, t0, t1, c) is positive (negative) if the orientation of the pairs
(α′(t0), c′(0)), (α′(t1), c′(1))
agree. Note that positivity only depends on the image of α and is indepen-
dent of the parameterization. So if (α, t0, t1, c) is a positive pair the two
tangent vectors to α at α(t1) and α(t2) are almost parallel, that is we have
∥Vc(α′
t1) −α′
t0 ∥≤ϵ,
where Vc(v) is the parallel transport of vector v along c.
II): Complete simple geodesics. Let (α, t0, t1, c) be an ϵ-good geodesic
segment such that
α ∩γx = ∅, γx ∩c[0, 1] ̸= ∅,
and let
t0 = inf{t | γx(t) ∈c[0, 1]}.
Then we construct a complete simple curve, η, which starts at x and
goes along γ(t) for t ≤t0 then spirals around ψ(α, t0, t1, c), the simple
23

closed curve which goes along c from α(t1) to α(t0), and then goes back to
α(t1) along α. In fact, by possibly changing the direction of α, η will be a
quasi-geodesic and consequently lies within a bounded distance of a unique
complete simple geodesic. More precisely, we have:
Lemma 4.8. Assume that
c ∩{α(t)|0 ≤t < t1} = ∅.
For any ϵ > 0 there exist δ, L > 0 such that if (α, t0, t1, c) is a δ- good
geodesic segment and L ≤t1 −t0, then η is a simple quasi geodesic. Also, if
˜η denote its geodesic representative and y = ˜η ∩βi, then
d(y, x) < ϵ.
Furthermore, y lies on the right(left) side of x if and only if (α, t0, t1, c) is
positive(negative).
We will use this lemma to approximate γx with complete simple geodesics.
III): Good geodesic sub-segments in a minimal geodesic lamina-
tion.
In this part, we want to ﬁnd good geodesic segments in a non-
trivial minimal lamination Ω(γx) = λ in order to construct complete simple
geodesics.
Given y ∈λ, let φy denote the arc length parameterization of the leaf of
λ such that φy(0) = y. Then we have:
Lemma 4.9. For any ϵ, L > 0 there exist 0 ≤s < t and a transverse arc
c and y ∈c ∩λ, such that (φy, s, t, c) is a positive ϵ-good geodesic segment,
φ(s) and φ(t) are not boundary points in λ ∩c, and we have
L ≤|s −t|.
Sketch of the proof. Take a transverse almost perpendicular arc c such
that λ ∩c ̸= ∅.
Note that λ is a minimal lamination, and it is not a
simple closed curve. Hence, λ ∩c is uncountable with only countably many
boundary points. Therefore one can choose x0 ∈λ ∩c so that φx0 ∩c does
not contain any boundary points of λ ∩c. Let φ = φx0 and c : [−r, +r] →
X , r > 0, c(0) = x0 be a small enough transverse arc such that for
φ(a), φ(b) ∈c[−r, r] we have |a−b| > L or a = b. Without loss of generality,
we can assume that the orientation of the pair
(φ′
0, c′
0)
24

0
0
1
1
1
2
0
2
a)
b)
c)
φx0
φx0
φx0
c
c
c
Figure 7. Finding good-geodesic segments
agrees with the orientation of X. Now deﬁne t1, t2 as follows.
Let
t1 = inf{ t > 0|φ(t) ∈c[−r, 0) },
and φ(t1) = c(x1). Similarly, as φ(ti) is not a boundary point for i = 1, 2
we can deﬁne
t2 = inf{ t > t1|φ(t) ∈c(x1, 0) }.
Then as in Figure 7 at least one of (φ, 0, t1, c), (φ, t1, t2, c) and (φ, 0, t2, c) is
a positive ϵ-good geodesic segment. Also, we have
min{|t1 −t2|, t1, t2} ≥L.
2
Now we can prove part b that if Ω(γx) is a non simple closed curve then
x is not a boundary point.
Proof of part (b) and (c) of Theorem 4.6. The main idea is to apply
Lemma 4.9 to ﬁnd positive ϵ-good geodesic segments inside λ and use it to
construct complete simple geodesics.
Let (α, t1, t2, c) be an ϵ-good geodesic segment in λ constructed in Lemma
4.9 such that α(ti) = c(ri), and α(t1) is not a boundary point of λ ∩c.
As γx spirals to λ, γx ∩c[r1, r2] is non-empty. Let
t0 = inf{t |γx(t) ∈c[r1, r2]}.
Then from Lemma 4.8 the result is immediate.
Using the same method, one can ﬁnd a sequence of complete simple geodesics
approximating γx from one side if Ω(γx) is a simple closed curve inside the
25

surface in which case, by the proof of part (a), x will be a boundary point
of Ei.
2
Now, we can show that the set of non-isolated points of Ei is topologically
homeomorphic to the Cantor set.
Proof of Theorem 4.5. Recall that we have a topological characterization
of the Cantor set. That is any perfect totally disconnected compact metric
space is homeomorphic to the Cantor set.
By Theorem 4.6, apart from countably many points, corresponding to
the simple geodesics joining boundary components, points in Ei are limit
points. The result follows since non-isolated points of Ei form a compact
totally disconnected perfect subset of βi.
2
Connection with embedded pairs of pants.
Let x ∈Ei such that
the ray γx spirals into a simple closed geodesic α1. Then there is a unique
embedded pair of pants Σx on X such that γx ⊂Σx. In other words, there
exists a unique simple closed geodesic α2 bounding a pair of pants Σx with
β1 and α1 such that γx ⊂Σx.
Let Ii be the set of isolated points in Ei. Then we can write
Ii ∪(βi −Ei) =

h
(ah, bh),
where ah, bh are both boundary points of Ei.
We ﬁnd a natural one to
one correspondence between embedded pairs of pants containing β1 and
complementary intervals of Ei −Ii as follows.
For any h, let Σh be the unique pairs of pants containing γah such that
∂(Σ) = {β1, Ω(γah), α}.
Now if α is not a boundary component of X, then by Theorem 4.6, γbh ⊂
Σh, otherwise we could ﬁnd y ∈(ah, bh) and γy ⊂Σh spirals into α. So
α = Ω(γbh) which means that Ω(γah), Ω(γbh) and β1 bound a pair of pants.
Similarly if α = βj is a boundary component, then γbh ⊂Σh which
means that β1, βj and Ω(γah) = Ω(γbh) bound an embedded pair of pants
inside the surface.
We will use this fact and Lemma 4.4 to prove the main result of this
section.
Proof of Theorem 4.2. Let
Ii ∪(βi −Ei) =

h
(ah, bh),
26

where ah, bh ∈βi. Then by Theorem 4.4 we have:
Li = ℓβi(X) =

h
|bh −ah|,
(4.3)
where |ah −bh| is the geodesic distance between ah and bh along βi.
For each 1 ≤h one of the following holds:
1. There exists j such that γ = Ω(γah) = Ω(γbh), βj and βi bound a pair
of pants in X.
2. The two curves α = Ω(γah) and β = Ω(γbh) are distinct and bound a
pair of pants containing βi.
By the deﬁnition the functions D and R in §3 in the ﬁrst case we have
R(Li, Lj, ℓγ(X)) = |ah −bh|,
(4.4)
and in the second case, we have:
1
2D(Li, ℓα(X), ℓβ(X)) = |ah −bh|.
(4.5)
Now we can use (4.4) and (4.5) to rewrite (4.3) as
Li(X) =

{α1,α2}
D(Li, ℓα1(X), ℓα2(X)) +

j
j̸=i

γ
R(Li, Lj, ℓγ(X)),
where the ﬁrst sum is over unordered {α1, α2} bounding a pairs of pants
with βi in X and the second some is over γ bounding a pair of pants with
βi and βj.
2
5
Statement of the recursive formula for volumes
In this section we state a recursive formula for Vg,n(L), the Weil-Petersson
volume of Mg,n(L). The proof is given later in §9.
The volume function Vg,n(L1, . . . , Ln) is a symmetric function in L1, . . . , Ln.
Hence for any set A of positive numbers with |A| = n, we can deﬁne Vg,n(A)
by
Vg,n(A) = Vg,n(a1, . . . , an),
where {a1, . . . , an} = A.
Statement of the recursive formula. The function Vg,n(L1, . . . , Ln) for
any g and n (2g −2 + n > 0) is determined recursively as follows :
27

• For any L1, L2, L3 ≥0, set
V0,3(L1, L2, L3) = 1,
and
V1,1(L1) = L2
1
24 + π2
6 .
The ﬁrst equation holds since the moduli space M0,3(L1, L2, L3) con-
sists of only one point. For the calculation of V1,1(L) see §6.
• Let L = (L2, . . . , Ln). When (g, n) ̸= (1, 1), (0, 3), the volume Vg,n(L) =
Vol(Mg,n(L)) is inductively determined by :
∂
∂L1
L1Vg,n(L) = Acon
g,n(L1, L) + Adcon
g,n (L1, L) + Bg,n(L1, L),
(5.1)
where the functions
Acon
g,n(L1, L) = 1
2(
∞

0
∞

0
x y 
Acon
g,n(x, y, L1, L) dx dy),
(5.2)
Adcon
g,n (L1, L) = 1
2(
∞

0
∞

0
x y 
Adcon
g,n (x, y, L1, L) dx dy),
(5.3)
and
Bg,n(L1, L) =
∞

0
x · 
Bg,n(x, L1, L) dx,
(5.4)
are deﬁned in terms of the Vh,m(L)’s with 3h + m < 3g + n as follows. We
deﬁne the functions

Acon
g,n : Rn+2
+
→R+,

Adcon
g,n
: Rn+2
+
→R+,
and
Bg,n : Rn+1
+
→R+.
To do this, we need the function H : R →R+ deﬁned in §3 by
H(x, y) =
1
1 + e
x+y
2
+
1
1 + e
x−y
2
.
28

Also as before, let
m(g, n) = δ(g −1) × δ(n −1).
So m(g, n) = 0 unless g = 1 and n = 1.
I) : Deﬁnition of 
Acon
g,n. Deﬁne 
Acon
g,n : Rn+2
+
→R+ by

Acon
g,n(x, y, L1, . . . , Ln) =
1
2m(g−1,n+1) Vg−1,n+1(x, y, L) · H(x + y, L1).
See Figure 8(b).
II) : Deﬁnition of 
Ag,n
dcon. Let Ig,n be the set of ordered paris
a = ((g1, I1), (g2, I2))
where I1, I2 ⊂{2, . . . , n} and 0 ≤g1, g2 ≤g such that the followings hold:
1. The two sets I1 and I2 are disjoint and {2, 3, . . . , n} = I1 ⊔I2.
2. The numbers g1, g2 ≥0 and n1 = |I1|, n2 = |I2| satisfy
2 ≤2g1 + n2,
2 ≤2g2 + n2,
and
g1 + g2 = g.
For notational convenience, given L = (L1, . . . , Ln) and I ⊂{1, . . . , n} with
|I| = k, deﬁne LI by
LI = (Lj1, . . . , Ljk),
where I = {j1, . . . , jk}. Now for each
a = ((g1, I1), (g2, I2)) ∈Ig,n,
let
V (a, x, y, L) = Vg1,n1+1(x, LI1)
2m(g1,n1+1)
× Vg2,n2+1(y, LI2)
2m(g2,n2+1)
.
As we will see later, the reason we have to divide by 2 in this case is that
every X ∈M1,1(L) has a symmetry of order 2.
Note that as the function Vg,n(L) is symmetric, the function V (a, x, y, L)
is well deﬁned. Now deﬁne 
Adcon
g,n
: Rn+2
+
→R+ by

Adcon
g,n (x, y, L1, L) =

a∈Ig,n
V (a, x, y, L) · H(x + y, L1).
29

See Figure 8(a).
III) : Deﬁnition of Bg,n. Finally, deﬁne Bg,n : Rn+1
+
→R+ by
Bg,n(x, L1, L) =
1
2m(g,n−1)
n

j=2
1
2(H(x, L1 + Lj) + H(x, L1 −Lj)) · Vg,n−1(x, L2, . . . , ˆLj, . . . , Ln). (5.5)
See Figure 8(c).
Connection with topology of the set of pairs of pants. Although the
recursive formula 5.1 has been described in purely combinatorial terms, as
in Figure 8, it is closely related to the topology of diﬀerent types of pairs of
pants in Sg,n. In fact, this formula gives us the volume of Mg,n(L) in terms
of volumes of moduli spaces of Riemann surfaces that we get by removing
a pair of pants containing at least one boundary component of Sg,n. Also,
the second condition in the deﬁnition of Ig,n is equivalent to the condition
that both complementary regions of the pair of pants have negative Euler
characteristics. See §9 for more details.
Remark. The functions Acon
g,n, Adcon
g,n
and Bg,n are determined by the func-
tions {Vi,j} where 3i + j < 3g + n. Therefore equation (5.1) is a recursive
formula for calculating Vg,n(L). In §6 we will simplify this recursive formula
and use it to prove that Vg,n(L) is a polynomial in L (Theorem 1.1).
6
Polynomial behavior of the Weil-Petersson vol-
ume
In this section we use the recursive formula for the volumes of moduli spaces
stated in §5 to establish the following result:
Theorem 6.1. The function Vg,n(L) is a polynomial in L1, . . . , Ln, namely:
Vg,n(L) =

α
|α|≤3g−3+n
Cα · L 2α,
where Cα > 0 lies in π6g−6+2n−|2 α| · Q.
We will also calculate the leading coeﬃcients of V0,n(L).
Calculation of V1,1(L). Before proving Theorem 6.1, we elaborate the main
idea of the calculation of the Vg,n(L)’s through an example when g = n = 1.
In this case, using Theorem 4.2 for a hyperbolic surface of genus one with
30

one geodesic boundary component implies that for any X ∈T (S1,1, L), we
have

γ
D(L, ℓγ(X), ℓγ(X)) = L,
where the sum is over all simple closed curves γ on S1,1. Also, by Lemma
3.2, we have
∂
∂LD(L, x, x) =
1
1 + ex−L
2
+
1
1 + ex+ L
2
.
Integrating over M1,1(L), as in the calculation of Vol(M1,1) in the Intro-
duction, we get:
L · V1,1(L) =
∞

0
x D(L, x, x) dx.
So we have
∂
∂LL · V1,1(L) =
∞

0
x · (
1
1 + ex+ L
2
+
1
1 + ex−L
2
) dx.
By setting y1 = x + L/2 and y2 = x −L/2, we get
∞

0
x · (
1
1 + ex+ L
2
+
1
1 + ex−L
2
) dx =
∞

L/2
y1 −L/2
1 + ey1 dy1 +
∞

−L/2
y2 + L/2
1 + ey2
dy2 =
= 2
∞

0
y
1 + ey dy +
L/2

0
y −L/2
1 + ey
dy +
−L/2

0
y + L/2
1 + ey
dy =
π2
6 +
L/2

0
(y −L/2)(
1
1 + ey +
1
1 + e−y ) dy = π2
6 + L2
8 ,
Since we have
1
1 + ey +
1
1 + e−y = 1.
Therefore, we have:
V1,1(L) = L2
24 + π2
6 .
(6.1)
Remark. This result agrees with the result obtained in [NN]. It seems
straightforward to generalize our calculation for hyperbolic surfaces with
ﬁnitely many cone singularities [NN].
31

Polynomial behavior of H and Vg,n . At ﬁrst glance the equation in 5.1
looks too complicated to be useful, but by using the following elementary
lemmas we will be able to simplify both sides of the equation 5.1
∂
∂L1
L1Vg,n(L) = Acon
g,n(L) + Adcon
g,n (L) + Bg,n(L),
and prove that Vg,n(L) is actually a polynomial in L.
The following easy observation shows that it suﬃces to prove that Acon
g,n(L),
Adcon
g,n (L) and Bg,n(L) are polynomials in L.
Lemma 6.2. For any diﬀerentiable function F : Rn →R, deﬁne P(F) by:
Pi(F) =
∂
∂xi
(xiF(x1, ..., xn)).
Then Pi(F) determines F, and we have F ∈R[x1, .., xn] if and only if
Pi(F) ∈R[x1, .., xn] .
Deﬁnition. For i ∈N, deﬁne F2i+1 : R+ →R+ by
F2k+1(t) =
∞

0
x2k+1 · H(x, t) dx.
We easily ﬁnd in the following that
∞

0
∞

0
x2i+1·y2j+1·H(x+y, t) dx dy = (2i + 1)! · (2j + 1)!
(2i + 2j + 3)!
F2i+2j+3(t). (6.2)
To prove equation 6.2, note that for any m, n ∈N, we have
T

0
ym (T −y)ndy =
m! n!
(m + n + 1)! T m+n+1.
Now we can simplify the left hand side of the equation 6.2, as follows. By
setting Z = x + y, we get
∞

0
∞

0
x2i+1·y2j+1·H(x+y, t) dx dy =
∞

0
Z

0
(Z−y)2i+1·y2j+1·H(Z, t) dy dZ =
32

= (2i + 1)! · (2j + 1)!
(2i + 2j + 3)!
∞

0
Z2i+2j+3H(Z, t) dZ.
These functions play a key role in the calculation of Vg,n(L). In fact, us-
ing equations (5.2), (5.3) and (5.4) we can express the functions Adcon
g,n (L),
Acon
g,n(L) and Bg,n(L) in terms of the F2k+1(t)’s and the volumes of moduli
spaces of simpler Riemann surfaces.
The following lemma helps us to proceed to the calculation of Vg,n(L).
Lemma 6.3. For any k ≥0, we have
F2k+1(t)
(2k + 1)! =
k+1

i=0
ζ(2i) (22i+1 −4)
t2k+2−2i
(2k + 2 −2i)!.
Therefore F2k+1(t) is a polynomial in t2 of degree k + 1 such that the coef-
ﬁcient of m2k+2−2i lies in π2i · Q>0.
Remark. Since ζ(0) = −1/2, therefore the leading coeﬃcient of F2k+1(t)
is t2k+2/(2k + 2).
Proof. Simplifying F2k+1(t), exactly as in the calculation of V1,1(L) in the
beginning of this section, we have
∞

0
x2k+1 · (
1
1 + ex+t +
1
1 + ex−t) dx =
=
∞

0
((x + t)2k+1 + (x −t)2k+1
1 + ex
)dx +
t

0
−(x −t)2k+1
1 + ex
+ (−x + t)2k+1
1 + e−x
dx
= t2k+2
2k + 2 +
k

i=0
2t2k−2i ·
2k + 1
2i + 1

·
∞

0
x2i+1
1 + ex dx,
which is a polynomial in t2 whose leading term is m2k+2
2k+2 . So the equality
2
∞

0
x2i+1
1 + ex dx = ζ(2i + 2) (2i + 1)! (2 −2−2i)
implies that
F2k+1(2t)
(2k + 1)! = 22k+2(
t2k+2
(2k + 2)! +
k

i=0
t2k−2i
(2k −2i)! · ζ(2i + 2) (2 −2−2i))
33

which implies the result.
2
Now we can use the preceding lemma to prove that Vg,n(L) is a polyno-
mial in L.
Proof of Theorem 6.1.
The proof is by induction on 3g + n.
Using
equation 5.1, and Lemma 6.2, it suﬃces to prove that Acon
g,n(L), Adcon
g,n (L)
and Bg,n(L) are polynomials in L. We prove that Acon
g,n(L) is a polynomial
in L, the proof for Adcon
g,n
and Bg,n is similar.
Let Tn = {1, 2, . . . , n} and L = (L1, . . . , Ln). By the induction hypothesis
Vg,n−1(x, LTn−{1,j}) is a polynomial in x2 and {Lk}k∈Tn −{1, j}. Therefore,
to complete the proof we have to show that
∞

0
x2i+1 · (H(x, L1 + Lj) + H(x, L1 −Lj)) dx
is a polynomial in L1 and Lj which is immediate from Lemma 6.3.
2
7
Leading coeﬃcients of volume polynomials
In this section, we ﬁnd a recursive method for calculating the coeﬃcients of
Vg,n(L) and calculate the leading coeﬃcients of V0,n(L).
Deﬁnition. Let
Cg(α1, . . . , αn)
be the coeﬃcient of L2α1
1
· · · L2αn
n
in the polynomial Vg,n(L). Also, let
(α1, . . . , αn)g = Cg(α) ×
n

i=1
αi! × 2|α|,
where |α| =
n
i=1
αi.
The recursive formula §5 simpliﬁes when
n
i=1
2αi = 6g −6 + 2n in which
case we get a recursive formula in terms of the leading coeﬃcients of {Vh,m}
with 3h −m < 3g −n. Also, if one of the αi’s is 0 or 1, the coeﬃcient of
L2α in 
Acon(L) and 
Adcon
g,n (L) equals zero and we have:
Theorem 7.1. If
n
i=1
αi = 3g −3 + n, then we have
(1, α1, . . . , αn)g = (2g + n −2) (α1, . . . , αn)g.
34

Theorem 7.2. If
n
i=1
αi = 3g −2 + n, then we have
(0, α1, . . . , αn)g =

αi̸=0
(α1, . . . , αi −1, . . . , αn)g.
Proof of Theorem 7.1. We prove the Theorem by induction on n. To
do this, we calculate the coeﬃcient of L2
1 · · · L 2 αn
n+1 in Vg,n+1(L) by using the
recursive formula for the volume polynomials. The coeﬃcient of L2
1 · · · L 2 αn
n+1
on the left hand side of equation 5.1 equals
3 (1, α1, . . . , αn)g
α! × 23g−3+n+1 ,
where α! = α1! · · · αn!.
As in the proof of Lemma 6.3, the leading coeﬃcient of F2i+1(m) equals
1/2i + 2. It can be easily veriﬁed that the coeﬃcient of L2
1 · · · L2 αn
n+1 in
n+1

j=2
∞

0
1
2 x · (H(x, L1 + Lj) + H(x, L1 −Lj)) · Vg,n−1(x, LT−{1,j}) dx
equals
n

j=1
2 αj+2
2

2 αi + 2 · (α1, . . . , αn)g
α! × 23g−3+n = 3 (2g −2 + n)
2
× (α1, . . . , αn)g
α! × 23g−3+n .
On the other hand, there is no L2α1
1
· · · L2αn
n+1 term in Adcon
g,n (L) and Bg,n(L).
Therefore, we have
3 (1, α1, . . . , αn)g = 3 (2g + n −2)(α1, . . . , αn)g
which implies the result.
2
We omit the proof of Theorem 7.2 since it is quite similar.
These two recursive formulas are actually enough for determining
(α1, . . . , αn)g when g = 0. In this case, by induction on n it can be easily
proved that:
Corollary 7.3. When
n
i=1
αi = n −3, we have
(α1, . . . , αn)0 =
α1 + · · · + αn
α1, · · · , αn

.
35

Remark.
Equations in Theorem 7.1 and Theorem 7.2 are reminiscent of
the dilaton and string equations for the intersection pairings over the moduli
spaces [Har]. In a sequel we prove that
(α1, . . . , αn)g =

Mg,n
ψα1
1 · · · ψαn
n ,
where ψi denotes the Chern class of the ith tautological line bundle over
Mg,n [Mirz2].
8
Integration over the moduli space
In this section, we investigate the Weil-Petersson symplectic structure of
Mg,n(L).
For
γ =
k

i=1
ciγi,
where ci > 0 and γ1, . . . , γk are disjoint non homotopic simple closed curves
on Sg,n, let Γ = (γ1, . . . , γk).
For any f : R+ →R+,
fγ(X) =

[α]∈Mod ·[γ]
f(ℓα(X)),
where ℓα(X) =
k
i=1
ciℓγi(X), deﬁnes a function fγ : Mg,n(L) →R.
In this section we establish the following result for integrating the func-
tion fγ over Mg,n(L).
Theorem 8.1. For any γ =
k
i=1
ciγi, the integral of fγ over Mg,n(L) with
respect to the Weil-Petersson volume form is given by

Mg,n(L)
fγ(X) dX =
2−M(γ)
| Sym(γ)|

x∈Rk
+
f(|x|) Vg,n(Γ, x, β, L) x · dx dt,
where |x| =
k
i=1
ci xi, and
M(γ) = |{i|γi seperates oﬀa one-handle from Sg,n}|
36

Here x·dx = x1 · · · xn·dx1∧· · ·∧dxn, and for any x = (x1, . . . , xk) ∈Rk
+,
Vg,n(Γ, x, β, L) is given by
Vol(M(Sg,n(γ), ℓΓ = x, ℓβ = L)).
We can write Sg,n(γ) as a union of its connected components
Sg,n(γ) =
s
i=1
Si ,
(8.1)
where Si ∼= Sgi,ni, and Ai = ∂Si. Then we have
Vg,n(Γ, x, β, L) =
k

i=1
Vgi,ni(ℓAi).
Remark 1. The terms Sym(γ) and M(γ) appear when γ has some extra
symmetry.
See §2 for the deﬁnition of Sym(γ), the symmetry group of
γ = k
i=1 ciγi. In fact | Sym(γ)| ̸= 1 will put a non trivial restriction on the
ci’s. More precisely, if g(γi) = γj for g ∈Sym(γ) then ci = cj. Hence we
have
k

i=1
ciℓγi =
k

i=1
ciℓg·γi
.
Remark 2. Since later will use lemma 8.1 to integrate the left hand side of
equation 4.1 over Mg,n(L), it is essential that D(x, y, z) is in fact a function
of x and y + z (§3).
By Theorem 8.1 integrating fγ, even for a compact Riemann surface,
reduces to the calculation of volumes of moduli spaces of bordered Riemann
surfaces.
Hamiltonian circle actions. Let (M, ω) be a symplectic manifold. Then
for any smooth function H : M →R, the vector ﬁeld XH determined by
ω(XH, .) = dH(.)
is called the Hamiltonian vector ﬁeld associated to H. Here we are interested
in the case where XH generates an S1 action on M. In other words, ψ1 = id,
where ψt is the integral of the vector ﬁeld XH. The Hamiltonian function
H in this case is called the moment map of the action. See [McD] for more
details.
Integration and covering. Let
π : X1 →X2
37

be a covering and v2 a volume form on X2. Then v1 = π−1∗(v2) deﬁnes a
volume form on X1. If f is in L1(X1, v1), then the push forward
(π∗f)(x) =

y∈π−1{x}
f(y)
deﬁnes a function in L1(X2, v2) and we have

X2
(π∗f) dv2 =

X1
f dv1.
(8.2)
Next we construct coverings of Mg,n and functions deﬁned over them whose
push forward to Mg,n is constant.
Coverings and volume forms of the Mg,n(L)’s. For h ∈Modg,n let
h.Γ = (h · γ1, . . . , h · γk).
As in §2, let OΓ be the set of homotopy classes of elements of the set Mod ·Γ.
Consider Mg,n(L)Γ deﬁned by the following space of pairs:
{(X, η)| X ∈Mg,n(L) , η = (η1, . . . , ηk) ∈OΓ, ηi’s are closed geodesics on X}.
Let πΓ : Mg,n(L)Γ →Mg,n(L) be the projection map deﬁned by
πΓ(X, η) = X.
Let φγ ∈Modg,n denote the Dehn twist along γ. Then
GΓ =
s
i=1
Stab(γi) ⊂Mod(Sg,n)
is generated by the φγi’s and elements of the mapping class group of Sg,n(γ),
and
Mg,n(L)Γ = Tg,n(L)/Gγ.
As the Weil-Petersson symplectic structure on Teichm¨uller space is invari-
ant under the action of the mapping class group, it induces a symplectic
structure on Mg,n(L)Γ which is the same as the form πΓ∗(wwp).
In fact, the space Mg,n(L)Γ is closely related to the moduli space of hyper-
bolic structures over Sg,n cut along {γ1, . . . , γk}.
Twisting and the Weil-Petesson symplectic form. The results of this
section will arise from the existence of k commuting Hamiltonian S1-actions
38

on Mg,n(L)Γ. induced by twisting the surface along connected components
of γ. We ﬁrst describe the corresponding R-action on Tg,n(L) as deﬁned in
§2.
Consider the length-normalized twist ﬂow, given by
φt
α(X) = twt·ℓα(X)
α
(X).
Then
φ1
α = φα ∈Stab(α)
is the Dehn-Twist around α. See §2 for more details. Let ℓΓ : Tg,n →Rk
+
denote the length function deﬁned by
ℓΓ(X) = (ℓγ1(X), . . . , ℓγk(X)).
Then the level set
Tg,n(a) = ℓ−1
Γ (a)
carries a natural volume form −∗(dℓγ1 ∧· · · dℓγk).
Since ℓα(X) = ℓα(twt
α(X)), the map
φ(t1,...,tk)
γ
: Tg,n(a) →Tg,n(a)
gives rise to an action of Rk on the level set Tg,n(a) preserving the Weil-
Petersson symplectic form. By cutting the surface along γ we get a Riemann
surface with geodesic boundary components. Now Theorem 2.1 implies the
following result:
Lemma 8.2. For any (a1, . . . , ak) ∈Rk
+, the canonical map
s : ℓ−1
Γ (a1, . . . , ak)/Rk →
s

i=1
T (Si, LAi)
sending each point X ∈Tg,n to the surface that we get by cutting X along
components of γ, is a symplectomorphism.
Induced ﬂows on Mg,n(L)Γ. The length function ℓΓ descends to a function
LΓ on Mg,n(L)Γ
Rk
L
←−−−−Mg,n(L)Γ
π
Mg,n(L)
39

where LΓ(X, η) = (ℓηi(X)). The construction of the Fenchel-Nielsen ﬂow
deﬁned on Teichm¨uller space is equivariant with respect to the action of the
mapping class group. Therefore, we have:
• Each level set
Mg,n(L)Γ(a) = L−1(a1, . . . , ak) ⊂Mg,n(L)Γ
carries a natural volume form va induced by −∗dL = −∗(
i dℓγi).
• The Hamiltonian ﬂow of Li, twi, has closed orbits on MΓ
g,n(a1, . . . , ak).
That is we have
twt
i(X, η) = (twt
ηi(X), η),
where twt
ηi(X) is obtained by cutting X along ηi, twisting to the right
by hyperbolic length t and regluing the boundaries. Then for ti =
Li(Y ), twti(Y )
i
is the Dehn twist of Y along ηi which equals Y in
Mg,n(L)Γ.
Therefore, the Hamiltonian ﬂow of L2/2 : Mg,n(L)Γ →Rk
+ gives rise to
the action of T k = S1 × · · · × S1 by twisting along γi proportional to its
length.
The quotient space,
Mg,n(L)Γ∗(a) = Mg,n(L)Γ(a)/T k,
where T k = k
i=1 S1, inherits a symplectic structure from the symplectic
structure of Mg,n(L)Γ. For an open set U ⊂Mg,n(L)Γ∗(a), and the projec-
tion map
π : Mg,n(L)Γ(a) →Mg,n(L)Γ∗(a).
Note in general the twisting parameter along γi can be between 0 and ℓγi. In
the case of a simple geodesic γi separating oﬀa one-handle (the elliptic tail
case) Stab(γj) contains a half twist and so τ varies with fundamental region
{0 ≤τ ≤ℓγi/2}. The reason is that every X ∈M1,1(L) comes with an
elliptic involution, but when (g, n) ̸= (1, 1), a generic point in Mg,n(L) does
not have any non trivial automorphism ﬁxing the boundary components set
wise. Therefore, since −∗dL2 = −∗dL/L, we get
Vol(π−1(U)) = 2−M(γ) Vol(U) · a1 · · · ak,
(8.3)
40

where M(γ) is the number of connected components γ separating oﬀa one-
handle.
Mg,n(L)Γ(a)
π
−−−−→Mg,n(L)Γ∗(a) ∼=  Mgi,ni,Ai

Mg,n(L)
Therefore, we have the following result:
Lemma 8.3. For any k-tuple Γ = (γ1, . . . , γk) of disjoint simple closed
curves, the canonical isomorphism
s : Mg,n(L)Γ∗(a) →M(Sg,n(γ), ℓΓ = a, Lβ = L) ∼=
s

i=1
Mgi,ni(ℓAi)
is a symplectomorphism.
Remark. By what we said, L2/2 is the moment map for the T k action,
and the space Mg,n(L)Γ∗(a) is a symplectic quotient space ( See [Ki]). In
[Mirz2], we use this fact to relate the volume polynomials to the intersection
pairings of tautological classes over the moduli space.
Integrating geometric functions. Now we can use the preceding lemma
to integrate certain functions over the covering space Mg,n(L)Γ.
Lemma 8.4. For any function F : Rk →R, deﬁne Fγ : Mg,n(L)Γ →R by
Fγ(Y ) = F(L(Y )).
Then the integral of Fγ over Mg,n(L)Γ is given by

Mg,n(L)Γ
Fγ(Y ) dY = 2−M(γ)

x∈Rk
+
F(x) Vol(M(Sg,n(γ), ℓβ = L, ℓΓ = x)) x dx,
where x = (x1, . . . , xn) and x · dx = x1 · · · xn · dx1 ∧· · · ∧dxn.
Proof. Note that the function Fγ is constant on each level set of Mg,n(L)Γ(a)
of L. Using Lemma 8.3 and equation 8.3, we get
Vol(L−1(a1, · · · , ak)) = 2−M(γ) a1 · · · ak · Vol(M(Sg,n(γ), ℓβ = L, ℓΓ = a)),
and as a result we get
41

I(a) =

Mg,n(L)Γ(a)
F(ℓγ(X)) dX = 2−M(γ)×
F(a) · Vol(M(Sg,n(γ), ℓβ = L, ℓγ = a)) · a1 · · · ak.
Now the result is immediate, since by Theorem 2.1, we have

Mg,n(L)Γ
Fγ(Y ) dY =

x∈Rk
+
I(x) dx
2
Now we are ready to prove the main result of this section
Proof of Theorem 8.1. The function
πΓ
∗f : Mg,n(L) →R+
is given by
πΓ
∗f(X) =

h∈Modg,n /∩Stab(γi)
f(ℓh·γ(X)).
(8.4)
Therefore by using equation (8.2) and Lemma 8.3, using the notation of
Lemma 8.4 the integral of πΓ
∗f over the moduli space is given by

Mg,n(L)
πΓ
∗f(X)dX =

Mg,n(L)Γ
Fγ(Y )dY,
where F(x1, . . . , xk) = f(
k
i=1
cixi). Now we can use Lemma 8.4 to see that

Mg,n(L)
πΓ
∗f(X)dX
equals
2−M(γ)

(x,t)∈V
f(|x|) Vol(M(Sg,n(γ), ℓΓ = x, ℓβ = L)) · x · dx dt.
On the other hand, we have,

g∈Modg,n /∩Stab(γi)
f(ℓg·γ(X)) = Sym(γ) ·

[α]∈[γ]·Modg,n
f(ℓα(X),
42

where
Sym(γ) = | Stab(γ)/ ∩Stab(γi)|.
Hence we get
πΓ
∗f(X) = Sym(γ) · fγ(X).
2
9
Volumes of moduli spaces of bordered Riemann
surfaces
In this section we use the identity for lengths of simple closed geodesics in
Theorem 4.2 to derive the recursive formula for the Vg,n(L)′s stated in §5.
Idea of the calculation of Vg,n(L).
By Theorem 4.2, for any X ∈
Tg,n(L1, . . . , Ln) we have

{α1,α2}∈F1
D(L1, ℓα1(X), ℓα2(X)) +
n

i=2

γ∈F1,i
R(L1, Li, ℓγ(X)) = L1, (9.1)
where as in §4, F1 and F1,j are respectively in one to one correspondence
with the set of pairs of pants containing β1 and {β1, βj}. Now let
˜Rj(X) =

γ∈F1,j
R(L1, Lj, ℓγ(X)),
(9.2)
and
˜D(X) =

(α1,α2)∈F1
D(L1, ℓα(X), ℓβ(X)).
Then from 9.1 we get
˜D(X) +
n

j=2
˜
Rj(X) = L1,
where ˜D and ˜
Rj are functions deﬁned on Mg,n(L).
We use the description of Fi/ Modg,n and Fi,j/ Modg,n to reformulate
˜Rj and ˜D as push forwards of functions deﬁned over certain coverings of the
moduli space of the form described in §8. This enables us to apply Theorem
8.1 and integrate these functions over Mg,n(L).
Topology of pairs of pants on a surface. We characterize the set of
topologically diﬀerent pairs of pants containing β1.
43

..
βi1
βj1
βjn2
y
βn
x
β2
β1
x
..
...
βn
β1
x
βj
y
β1
β2
a)
b)
c)
βin1
Σ
Σ
Σ
Figure 8. a):|∂(Σ) ∩∂Sg,n| = 1, separating case b): non-separating case
c): |∂(Σ) ∩∂Sg,n| = 2
44

Let Σ be a pair of pants such that β1 ∈∂(Σ). Then as in Figure 8 one
of the following holds.
I): Σ contains two boundary components. If ∂(Σ)∩∂(Sg,n) = {β1, βj},
as in Fig 7.c, then ∂Σ ∈F1,j, and Sg,n(Σ) is homeomorphic to Sg,n−1 (See
also the deﬁnition of Bg,n).
II): Σ contains one boundary component. If ∂(Σ) ∩∂(Sg,n) = {β1}
then Σ ∈F1, and Sg,n(Σ) can have 1 or 2 connected components.
Σ is non-separating: In this case, as in Fig 7.b, Sg,n(Σ) is homeomorphic
to Sg−1,n+1 (See also the deﬁnition of Acon
g,n).
Σ is separating: In this case , as in Fig 7.a, the elements of Ig,n are in one-
to-one correspondence with diﬀerent topological types of separating pairs of
pants such that ∂(Σ) ∩∂(Sg,n) = {β1} (See also the deﬁnition of Adcon
g,n ).
The action of Modg,n on F1 is not transitive, nevertheless the orbits
can be characterized by the topology of their complementary regions which
is determined by the number of the connected components, genus and the
number of boundary components of each connected component.
Proof of the recursive formula. Now we are ready to prove the recursive
formula stated in §5.
Theorem 9.1. For (g, n) ̸= (1, 1), (0, 3), the volume function Vg,n(L) satis-
ﬁes
∂
∂L1
L1Vg,n(L) = Acon
g,n(L) + Adcon
g,n (L) + Bg,n(L).
(9.3)
Proof. We can integrate both sides of the equation
˜D(X) +
n

i=2
 ˜Ri(X) = L1
over Mg,n(L) with respect to the volume form induced by the Weil-Petersson
symplectic form.
Therefore from equation 9.2 we get

2≤j

Mg,n(L)
˜Rj(X) dX +

Mg,n(L)
˜D(X) dX = L1 · Vg,n(L).
(9.4)
Next we calculate the integrals
Rj
g,n(L) =

Mg,n(L)
˜Rj(X) dX,
45

and
Dg,n(L) =

Mg,n(L)
˜D(X) dX.
I): Integrating ˜Rj. For 1 ̸= j the mapping class group Modg,n acts transi-
tively on F1,j and for any γ ∈F1,j we have
Modg,n ·{γ} = F1,j.
Let γj be a simple closed curve in F1,j. Consider the map πγj : Mg,n(L)γj →
Mg,n(L), and deﬁne Rγj : Mg,n(L)Γ →R+ by
Rγj(X) = R(L1, Lj, ℓγj(X)).
Hence, we get
πγj
∗Rγj(X) =

γ∈F1,j/ Mod
R(L1, Lj, ℓγ(X)),
and
˜Rj(X) = πγj
∗Rγj.
As Sg,n(γj) = Sg,n−1, and | Stab(γ)| = 1, by using Theorem 8.1 to show that
we have
Rj
g,n(L) = 2−m(g,n−1)
∞

0
x · R(L1, Lj, x) · Vol(M(Sg,n(γj), ℓγj = x, L)) dx
= 2−m(g,n−1)
∞

0
x · R(L1, Lj, x) · Vg,n−1(x, L2, . . . , ˆLj, . . . , Ln)dx,
which can be calculated in terms of Vg,n−1.
Therefore, from equation 3.5
∂
∂L1
Rj
g,n(L)
equals
2−m(g,n−1)
2
∞

0
x (H(x, L1−Lj)+H(x, L1+Lj)) Vg,n−1(x, L2, . . . , ˆLj, . . . , Ln)dx.
46

Hence, from the deﬁnition of Bg,n we have
n

j=2
∂
∂L1
Rj
g,n(L) = Bg,n(L).
(9.5)
II): Integrating ˜D . Here we sketch the calculation for ˜D. For {α1, α2} ∈
F1, let α = α1 + α2.
It is essential that by Lemma 3.1, the function
D(L1, ℓα1(X), ℓα2(X)) is in fact a function of L1 and ℓα(X) = ℓα1(X) +
ℓα2(X). Therefore by classifying the Modg,n orbits of F1, we can use Theo-
rem 8.1 for α = α1 + α2.
As in §5, let Ig,n be the set of all possible combinations of the genus and
set of boundary components of the complementary regions of elements of
F1. We can classify the orbits of the action of the mapping class group as
follows.
• Deﬁne Acon to be the set of α1 + α2 such that the complement of the
pair of pants containing β1, α1, α2 is a connected surface of genus g−1
with n+1 boundary components. (See Figure 8). Then | Sym(α)| = 1
2.
See §2
• For a ∈((g1, I), (g2, J)) ∈Ig,n, let Aa be the set of α = α1 + α2 such
that the complement of the pair of pants containing β1, α1 and α2 is a
disjoint union of two surfaces S1 and S2, respectively homeomorphic
to Sg1,n1+1 and Sg−g1,n2+1, such that we have:
{βi1, . . . , βin1} ⊂∂S1, {βj1, . . . , βjn2} ⊂∂S2.
See Figure 8. The action of the mapping class group on Acon and Aa (a ∈
Ig,n) is transitive and we have
F1 = Acon 
Adcon,
where
Adcon =

a∈Ig,n
Aa.
Choose γ ∈Acon and also, for each a ∈Ig,n, choose αa an element of the
set Aa. Deﬁne the set of representatives of the distinct orbits of Ig,n, C by
C = {αa | a ∈Ig,n} ∪{γ}.
47

Hence C ∼= F1/ Modg,n, and we have:
˜D(X) =

α=α1+α2∈C
πα
∗Dα(X),
where ˜D : Mα
g,n(L) →R+ is deﬁned by
Dα(X) = D(L1, ℓα1(X), ℓα2(X)).
Also by what we showed in §2, for α ∈Aa we have | Sym(α)| = 2 if and only
if I = J = φ and g1 = g2, otherwise | Sym(α)| = 1.
Therefore, from eqaution 3.4 and the deﬁnition of Acon and Adcon, we
get
∂
∂L1
Dg,n(L) = Acon
g,n(L) + Adcon
g,n (L).
(9.6)
Now the result is immediate from equations 9.4, 9.5 and 9.6.
Remark. The term 1/2 in equation 5.2 comes from sym(α) when α is non
seperating. Also, as the sum in the deﬁnition of 
Ag, n
dcon is over ordered
pairs ((g1, I1), (g2, I2)) in fact every term in the integral appears twice ex-
cept for the term corresponding to the g1 = g2, and I1 = I2 = φ. So by
considering 1/2 in equation 5.3, we will take care of the Sym(α).
2
References
[B]
A. Basmajian. The orthogonal spectrum of a hyperbolic manifold.
Amer. J. Math. 115(1993), 1139–1159.
[BS]
J. S. Birman and C. Series. Geodesics with bounded intersection
number on surfaces are sparsely distributed.
Topology 24(1985),
217–225.
[Bus]
P. Buser.
Geometry and Spectra of Compact Riemann Surfaces.
Birkh¨auser Boston, 1992.
[CEG]
R. D. Canary, D. B. A. Epstein, and P. Green. Notes on notes of
Thurston. In Analytical and Geometric Aspects of Hyperbolic Space,
pages 3–92. Cambridge University Press, 1987.
[Gol]
W. Goldman. The symplectic nature of fundamental groups of sur-
faces. Adv. Math. 54(1984), 200–225.
48

[Har]
J. Harris and I. Morrison. Moduli of curves, volume 187 of Graduate
Texts in Mathematics. Springer-Verlag, 1998.
[KMZ] R. Kaufmann, Y.Manin, and D. Zagier. Higher Weil-Petersson vol-
umes of moduli spaces of stable n-pointed curves. Comm. Math.
Phys. 181(1996), 736–787.
[Ki]
F. Kirwan. Momentum maps and reduction in algebraic geometry.
Diﬀerential Geom.Appl. 9(1998), 135–171.
[K]
M. Kontsevich. Intersection on the moduli space of curves and the
matrix airy function. Comm. Math. Phys. 147(1992).
[MaZ]
Y. Manin and P. Zograf. Invertible cohomological ﬁeld theories and
Weil-Petersson volumes.
Ann. Inst. Fourier(Grenoble) 50(2000),
519–535.
[McD]
D. McDuﬀ. Introduction to symplectic topology. Amer. Math. Soc.,
Providence, RI, 1999.
[M]
G. McShane.
Simple geodesics and a series constant over Te-
ichm¨uller space. Invent. math. 132(1998), 607–632.
[Mirz1] M. Mirzakhani. Growth of the number of simple closed geodesics
on a hyperbolic surface. Preprint, 2003.
[Mirz2] M. Mirzakhani. Weil-Petersson volumes and intersection theory on
the moduli space of curves. Preprint, 2003.
[NN]
T. Nakanishi and M. N¨a¨at¨anen. Areas of two-dimensional moduli
spaces. Proc. Amer. Math. Soc. 129(2001), 3241–3252.
[Pen]
R. Penner. Weil-Petersson volumes. J. Diﬀerential Geom. 35(1992),
559–608.
[Wol1]
S. Wolpert.
The Fenchel-Nielsen deformation.
Annals of Math.
115(1982), 501–528.
[Wol2]
S. Wolpert. On the homology of the moduli space of stable curves.
Ann. of Math.(2) 118(1983), 491–523.
[Zo]
P. Zograf. The Weil-Petersson volume of the moduli space of punc-
tured spheres. In Mapping class groups and moduli spaces of Rie-
mann surfaces, volume 150 of Contemp. Math., pages 367–372.
Amer. Math. Soc., 1993.
49

