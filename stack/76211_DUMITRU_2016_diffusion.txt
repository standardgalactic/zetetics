HAL Id: tel-01318048
https://tel.archives-ouvertes.fr/tel-01318048
Submitted on 19 May 2016
HAL is a multi-disciplinary open access
archive for the deposit and dissemination of sci-
entific research documents, whether they are pub-
lished or not.
The documents may come from
teaching and research institutions in France or
abroad, or from public or private research centers.
L’archive ouverte pluridisciplinaire HAL, est
destinée au dépôt et à la diffusion de documents
scientifiques de niveau recherche, publiés ou non,
émanant des établissements d’enseignement et de
recherche français ou étrangers, des laboratoires
publics ou privés.
A Bayesian approach for periodic components
estimation for chronobiological signals
Mircea Dumitru
To cite this version:
Mircea Dumitru. A Bayesian approach for periodic components estimation for chronobiological signals.
Probability [math.PR]. Université Paris-Saclay, 2016. English. ￿NNT : 2016SACLS104￿. ￿tel-01318048￿

NNT : 2016SACLS104
THÈSE DE DOCTORAT
DE  
L’UNIVERSITÉ PARIS-SACLAY
PRÉPARÉE À 
L’UNIVERSITE PARIS-SUD 
 LABORATOIRE DES SIGNAUX ET SYSTÈMES
ECOLE DOCTORALE N° 580 STIC
Sciences et technologies de l'information et de la communication
Traitement du Signal et des Images
Par
M. Mircea Dumitru
Approche bayésienne de l’estimation des composantes périodiques des signaux en
chronobiologie
Thèse présentée et soutenue à CentraleSupélec, le 25 Mars 2016 :
Composition du Jury : 
M. Kieffer, Michel
                         Professeur des Universités, Paris-Sud
Président 
M. Giovannelli, Jean-François
           Professeur des Universités, Bordeaux
Rapporteur
M. Kuruoglu, Ercan Engin
           Chercheur senior CNR, ISTI, Italie
              Rapporteur
M. Renaux, Alexandre
                         Maître de conférences, Paris-Sud                  Examinateur
M. Djafari, Ali-Mohammad
           Directeur de recherche CNRS
              Directeur de thèse
M. Lévi, Francis                                        Directeur de recherche CNRS
              Co-directeur de thèse

Thèse préparée au
Laboratoire des Signaux et Systèmes
UMR 8506 (Université Paris-Sud - CNRS- Supélec)
Supélec, 3 rue Joliot-Curie
91192 Gif-sur-Yvette, France


APPROCHE BAYÉSIENNE DE L’ESTIMATION DES COMPOSANTES PÉRIODIQUES DES
SIGNAUX EN CHRONOBIOLOGIE
Résumé
La toxicité et l’efﬁcacité de plus de 30 agents anticancéreux présentent de très fortes variations
en fonction du temps de dosage. Par conséquent, les biologistes qui étudient le rythme circadien ont
besoin d’une méthode très précise pour estimer le vecteur de composantes périodiques (CP) de signaux
chronobiologiques. En outre, dans les développements récents, non seulement la période dominante
ou le vecteur de CP présentent un intérêt crucial, mais aussi leurs stabilités ou variabilités. Dans les
expériences effectuées en traitement du cancer, les signaux enregistrés correspondant à différentes
phases de traitement sont courts, de sept jours pour le segment de synchronisation jusqu’à deux ou
trois jours pour le segment après traitement. Lorsqué’on étudie la stabilité de la période dominante
nous devons considérer des signaux très court par rapport à la connaissance a priori de la période
dominante, placée dans le domaine circadien. Les approches classiques fonées sur la transformée de
Fourier (TF) sont inefﬁcaces (i.e. manque de précision) compte tenu de la particularité des données
(i.e. la courte longueur). Une autre particularité des signaux qui est prise en considération dans ces
expériences, est le niveau de bruit. Ces signaux étant très bruités, il est difﬁcile de déterminer les
composantes périodiques associées aux phénomènes biologiques et de les distingué de celles qui sont
associées au bruit. Dans cette thèse, nous proposons une nouvelle méthode pour l’estimation du vecteur
de CP des signaux biomédicaux, en utilisant les informations biologiques a priori et en considérant un
modèle qui représente le bruit.
Les signaux enregistrés dans le cadre d’expériences développées pour le traitement du cancer ont
un nombre limité de périodes. Cette information a priori peut être traduite comme la parcimonie du
vecteur de CP. La méthode proposée considère l’estimation de vecteur de CP comme un problème in-
verse en utilisant l’inférence bayésienne générale aﬁn de déduire toutes les inconnues de notre modèle,
à savoir le vecteur de CP mais aussi les hyperparamètres (i.e. les variances associées). L’information
a priori de parcimonie est modélisée en utilisant une loi a priori renforcent la parcimonie. Dans cette
thèse, nous proposons une distribution de Student, considérée comme la distribution marginale d’une
loi bivariée - la distribution Normale - Inverse Gamma. En fait, lorsque l’égalité entre les paramèters de
forme et d’échelle, de la distribution Inverse Gamma n’est pas imposée, la marginale de la distribution
Normale-Inverse Gamma est une généralisation de la distribution de Student. Nous construisons un mo-
dèle hierarchique où nous attribuons aussi une loi a priori pour les hyperparamètres. L’expression de
la loi conjointe a posteriori du vecteur de CP et des hyperparamètres est obtenue par la règle de Bayes
et les inconnues sont estimées soit par Maximum A Posteriori (MAP) soit par l’espérance a posteriori
(EAP). Pour le calcul de EAP, l’expression de la loi a posteriori est approchée par une loi séparables en
utilisant l’approximation bayésienne variationelle (ABV), via la divergence de Kullback-Leibler (KL).
Deux possibilités sont envisagées : une approximation avec des lois partiellement séparables ou entiè-
rement séparable. Ces algorithmes sont présentés en détail et sont comparées avec ceux correspondant
au modèle gaussien. Nous examinons la convergence des algorithmes et donnons des résultats de si-
mulation aﬁn de comparer leurs performances. Enﬁn, nous montrons des résultats de simulation sur
des données synthétiques et réelles dans une application de traitement du cancer. Les données réelles
utilisées dans cette thèse representent des modèles de repos-activité et d’expression des gènes de KI /
KI Per2 : :luc souris luc, âgées de 10 semaines, seules dans leur cages des RT-BIO.
Mots-clefs : Estimation de composantes périodiques, Problèmes inverses, Approches bayésiennes, Mo-
dèle hierarchique, Renforcement de parcimonie, Student-t généralisée, chrnobiologie, chronothérapie,
Gènes de l’horologe, Rythme circadien, Traitement du cancer.

Abstract
The toxicity and efﬁcacy of more than 30 anticancer agents presents very high variations, depend-
ing on the dosing time. Therefore the biologists studying the circadian rhythm require a very precise
method for estimating the Periodic Components (PC) vector of chronobiological signals. Moreover,
in recent developments not only the dominant period or the PC vector present a crucial interest, but
also their stability or variability. In cancer treatment experiments the recorded signals corresponding
to different phases of treatment are short, from seven days for the synchronization segment to two or
three days for the after treatment segment. When studying the stability of the dominant period we have
to consider very short length signals relative to the prior knowledge of the dominant period, placed in
the circadian domain. The classical approaches, based on Fourier Transform (FT) methods are inefﬁ-
cient (i.e. lack of precision) considering the particularities of the data (i.e. the short length). Another
particularity of the signals considered in such experiments is the level of noise: such signals are very
noisy and establishing the periodic components that are associated with the biological phenomena and
distinguish them from the ones associated with the noise is a difﬁcult task. In this thesis we propose
a new method for the estimation of the PC vector of biomedical signals, using the biological prior
informations and considering a model that accounts for the noise.
The experiments developed in the cancer treatment context are recording signals expressing a lim-
ited number of periods. This is a prior information that can be translated as the sparsity of the PC
vector. The proposed method considers the PC vector estimation as an Inverse Problem (IP) using
the general Bayesian inference in order to infer all the unknowns of our model, i.e. the PC vector
but also the hyperparameters. The sparsity prior information is modelled using a sparsity enforcing
prior law. In this thesis we propose a Student-t distribution, viewed as the marginal distribution of
a bivariate Normal - Inverse Gamma distribution. In fact, when the equality between the shape and
scale parameters corresponding to the Inverse Gamma distribution is not imposed, the marginal of the
Normal-Inverse Gamma distribution is a generalization of the Student-t distribution. We build a general
Inﬁnite Gaussian Scale Mixture (IGSM) hierarchical model where we also assign prior distributions for
the hyperparameters. The expression of the joint posterior law of the unknown PC vector and the hy-
perparameters is obtained via the Bayes rule and then the unknowns are estimated via Joint Maximum
A Posteriori (JMAP) or Posterior Mean (PM). For the PM estimator, the expression of the posterior
distribution is approximated by a separable one, via Variational Bayesian Approximation (VBA), us-
ing the Kullback-Leibler (KL) divergence. Two possibilities are considered: an approximation with
partially separable distributions and an approximation with a fully separable one. The algorithms are
presented in detail and are compared with the ones corresponding to the Gaussian model. We examine
the practical convergency of the algorithms and give simulation results to compare their performances.
Finally we show simulation results on synthetic and real data in cancer treatment applications. The
real data considered in this thesis examines the rest-activity patterns and gene expressions of KI/KI
Per2::luc mouse, aged 10 weeks, singly housed in RT-BIO.
Keywords : Periodic Components (PC) vector estimation, Sparsity enforcing, Bayesian parameter
estimation, Variational Bayesian Approximation (VBA), Kullback-Leibler (KL) divergence, Inﬁnite
Gaussian Scale Mixture (IGSM), Normal - Inverse Gamma, Inverse problem, Joint Maximum A Pos-
teriori (JMAP), Posterior Mean (PM), Chronobiology, Circadian rhythm, Cancer treatment..


Acknowledgements
First and foremost I would like to express my deep gratitude for my advisor Ali
Mohammad-Djafari. It has been an honour and a privilege to be one of his Ph.D. students.
I am very grateful for his continuous support and patient guidance, for all the encourage-
ments and advices he has provided throughout my time as his student and especially for his
friendship.
The members of the Groupe Problémes Inverses have contributed immensely to my per-
sonal and professional time at L2S. I am grateful to all the permanent members of the group
Aurelia Fraysse, Nicolas Gac, Mathieu Kowalski, François Orieux and Thomas Rodet and
to all the postdocs and PhD students: Sha Zhu, Caifang Cai, Ning Chu, Yuling Zheng, Long
Chen, Leila Gharshalli, Li Wang, Fengchen Fang, Alina Mere¸sescu and Thomas Boulay for
their friendship and for their help.
Also, I would like to express my gratitude for my advisor Francis Lévi and all the members
of Rythmes Biologiques et Cancers laboratory Xiao-Mei Li, Alexandre Arbaud, Jacques Beau,
Sandrine Dulong, Virginie Hossard, Pasquale Innominato, Ali Mteyrek, Alper Okyar, Narin
Öztürk, Véronique Roche, Elisabet Ortiz Tudela and Monique Lévi for their warm reception
in the their laboratory and for introducing me in the fascinating ﬁeld of chronobiology.
For my dissertation I would like to thank my reading committee members Ercan Engin
Kuruoglu and Jean-François Giovannelli and my examiners Michel Kieffer and Alexandre
Renaux. It was an honour to have them as jury members and I am deeply grateful for all the
time they invested for reading the manuscript and for their insightful comments and encour-
agement.
I would like to thank John Skilling for introducing me to nested sampling. Working with
him was an honour.
My sincere thanks also goes to all my friends from CentraleSupélec: Achal Agrawal,
Laurence Antunes, Simona Baghai, Ejder Bastug, Anne Batalie, Soﬁane Ben Chabane, Is-
lam Boussaada, Yacine Bouzidi, Patrice Brault, Hugo Cavalera, Frédéric Desprez, Bakarime
Diomande, Sette Diop, Bernard Duchêne, Mohamed Farouq, Marcel Geam˘anu, Maryvonne
Giron, Franck Guimonet, Fethullah Güne¸s, Israel Hinostroza, Djawad Hamache, Trong-
Bien Hoang, Dina Irofti, Céline Labrude, Mohammed-Tahar Laraba, Dominique Lesselier,
Moussa Kefel, Rajesh Koduri, Mohammad Koteich, Wanchao Ma, Delphine Maucherat, Azza
Mokadem, Panagiotis Piteros, Chengfang Ren, Karim Tadrist, Miassa-Amira Taleb, Moham-
mad Toufayli and Chao Zhang.
Lastly, I would like to thank and dedicate this thesis to my sister, Irina.
This dissertation would not have been possible without funding from the ERASysBio+.


Contents
1
Résumé
13
2
Introduction
21
2.1
Biological context: from chronobiology to chronotherapy . . . . . . . . . . .
22
2.2
Experiments description
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
23
2.3
Chronobiological signals: particularities . . . . . . . . . . . . . . . . . . . .
24
2.4
Summary description of the following chapters
. . . . . . . . . . . . . . . .
26
3
Classical Methods
27
3.1
Basic example and notations . . . . . . . . . . . . . . . . . . . . . . . . . .
27
3.2
Fourier Transform . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
29
3.3
Zero Padding . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
31
3.4
Direct or Generalized Inversion . . . . . . . . . . . . . . . . . . . . . . . . .
32
3.5
Least Squares and regularized LS . . . . . . . . . . . . . . . . . . . . . . . .
37
3.6
L1 regularization and LASSO
. . . . . . . . . . . . . . . . . . . . . . . . .
43
3.7
Conclusion and why go to Bayesian . . . . . . . . . . . . . . . . . . . . . .
48
4
Linear Model, Inverse Problem and Bayesian approach with sparsity enforcing prior 51
4.1
Forward model and inverse problem approach . . . . . . . . . . . . . . . . .
52
4.2
General Bayesian inference . . . . . . . . . . . . . . . . . . . . . . . . . . .
55
4.3
Sparsity enforcing priors . . . . . . . . . . . . . . . . . . . . . . . . . . . .
56
4.4
Generalized Student-t hierarchical model
. . . . . . . . . . . . . . . . . . .
58
4.4.1
Generalized Student-t hierarchical prior model
. . . . . . . . . . . .
58
4.4.2
Joint MAP Estimation . . . . . . . . . . . . . . . . . . . . . . . . .
63
4.4.3
Posterior Mean (via VBA, partial separability)
. . . . . . . . . . . .
65
4.4.4
Prior Inverse Gamma parameters setting for vfj . . . . . . . . . . . .
72
9

4.4.5
Prior Inverse Gamma parameters setting for vǫi . . . . . . . . . . . .
75
4.4.6
Posterior Mean (via VBA, full separability) . . . . . . . . . . . . . .
77
5
Simulations: Synthetic data
79
5.1
Simulations 05dB . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
80
5.1.1
Synthetic data 05dB
. . . . . . . . . . . . . . . . . . . . . . . . . .
80
5.1.2
Data 05dB
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
81
5.1.3
JMAP IGSM 05dB . . . . . . . . . . . . . . . . . . . . . . . . . . .
82
5.1.4
PM (via VBA, partial separability) IGSM 05dB . . . . . . . . . . . .
84
5.1.5
PM (via VBA, full separability) IGSM 05dB
. . . . . . . . . . . . .
85
5.1.6
Methods comparison 05dB . . . . . . . . . . . . . . . . . . . . . . .
86
5.1.7
Error comparison 05dB . . . . . . . . . . . . . . . . . . . . . . . . .
87
5.2
Synthetic data 10dB . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
91
5.2.1
Data 10dB
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
91
5.2.2
JMAP IGSM 10dB . . . . . . . . . . . . . . . . . . . . . . . . . . .
92
5.2.3
PM (via VBA, partial separability) IGSM 10dB . . . . . . . . . . . .
93
5.2.4
PM (via VBA, full separability) IGSM 10dB
. . . . . . . . . . . . .
95
5.2.5
Methods comparison 10dB . . . . . . . . . . . . . . . . . . . . . . .
96
5.2.6
Error comparison 10dB . . . . . . . . . . . . . . . . . . . . . . . . .
97
5.3
Synthetic data 15dB . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
5.3.1
Data 15dB
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
5.3.2
JMAP IGSM 15dB . . . . . . . . . . . . . . . . . . . . . . . . . . . 101
5.3.3
PM (via VBA, partial separability) IGSM 15dB . . . . . . . . . . . . 102
5.3.4
PM (via VBA, full separability) IGSM 15dB
. . . . . . . . . . . . . 104
5.3.5
Methods comparison 15dB . . . . . . . . . . . . . . . . . . . . . . . 105
5.3.6
Error comparison 15dB . . . . . . . . . . . . . . . . . . . . . . . . . 106
5.4
Student-t PM via VBA vs. LASSO 05dB . . . . . . . . . . . . . . . . . . . . 109
5.5
Student-t PM via VBA vs. LASSO 10dB . . . . . . . . . . . . . . . . . . . . 114
6
Simulations: Real data
121
6.1
CT 502 A1: Photon Absorption and Activity . . . . . . . . . . . . . . . . . . 122
6.1.1
Dominant Period evolution: Activity . . . . . . . . . . . . . . . . . . 123
6.1.2
Dominant Period evolution: Photon . . . . . . . . . . . . . . . . . . 127

6.1.3
Conclusions: Dominant Period evolution
. . . . . . . . . . . . . . . 131
6.2
CT 502 A2: Photon Absorption and Activity . . . . . . . . . . . . . . . . . . 132
6.2.1
Dominant Period evolution: Activity . . . . . . . . . . . . . . . . . . 132
6.2.2
Dominant Period evolution: Photon . . . . . . . . . . . . . . . . . . 137
6.2.3
Conclusions: Dominant Period evolution
. . . . . . . . . . . . . . . 140
6.3
CT 502 A3: Photon Absorption and Activity . . . . . . . . . . . . . . . . . . 142
6.3.1
Dominant Period evolution: Activity . . . . . . . . . . . . . . . . . . 142
6.3.2
Dominant Period evolution: Photon . . . . . . . . . . . . . . . . . . 146
6.3.3
Conclusions: Dominant Period evolution
. . . . . . . . . . . . . . . 150
6.4
CT 502 B1: Photon Absorption and Activity . . . . . . . . . . . . . . . . . . 151
6.4.1
Dominant Period evolution: Activity . . . . . . . . . . . . . . . . . . 152
6.4.2
Dominant Period evolution: Photon . . . . . . . . . . . . . . . . . . 156
6.4.3
Conclusions: Dominant Period evolution
. . . . . . . . . . . . . . . 161
6.5
CT 502 B2: Photon Absorption and Activity . . . . . . . . . . . . . . . . . . 161
6.5.1
Dominant Period evolution: Activity . . . . . . . . . . . . . . . . . . 162
6.5.2
Dominant Period evolution: Photon . . . . . . . . . . . . . . . . . . 164
6.6
CT 502 B3: Photon Absorption and Activity . . . . . . . . . . . . . . . . . . 168
6.6.1
Dominant Period evolution: Activity . . . . . . . . . . . . . . . . . . 169
6.6.2
Dominant Period evolution: Photon . . . . . . . . . . . . . . . . . . 172
6.6.3
Conclusions: Dominant Period evolution
. . . . . . . . . . . . . . . 177
7
Conclusions and perspectives
179
7.1
Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179
7.2
Perspectives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181
7.2.1
Multicomponent case: PC amplitudes vectors for multiple inputs . . . 181
7.2.2
Sparsity Rate: initialisation and week dependencies . . . . . . . . . . 182
A Generalized Student-t
185
A.1
Context . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 185
A.2
Student-t: Origins . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 187
A.2.1
ML parameter estimation . . . . . . . . . . . . . . . . . . . . . . . . 187
A.2.2
Bayesian parameter estimation . . . . . . . . . . . . . . . . . . . . . 188
A.3
Generalization from the Bayesian point of view . . . . . . . . . . . . . . . . 189

A.4
Sparsity Rate and Generalized Student-t . . . . . . . . . . . . . . . . . . . . 190
A.5
Conclusion
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 192
B
Publications
195
Références . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 197

1
Résumé
L
A toxicité et l’efﬁcacité de plus de 30 agents anticancéreux présentent de très fortes vari-
ations en fonction du temps de dosage. Par conséquent, les biologistes qui étudient
le rythme circadien ont besoin d’une méthode très précise pour estimer le vecteur de com-
posantes périodiques (CP) de signaux chronobiologiques. En outre, dans les développements
récents, non seulement la période dominante ou le vecteur de CP présentent un intérêt crucial,
mais aussi leur stabilités ou variabilités.
Les données réelles utilisées dans cette thèse, montrées dans la ﬁgure (1.1), representent
des modèles de repos-activité et d’expression des gènes de KI / KI Per2::luc souris luc, âgées
de 10 semaines, seules dans leur cages des RT-BIO.
Dans les expériences effectuées en traitement du cancer, les signaux enregistrés correspon-
dant à différentes phases de traitement sont courts, de sept jours pour le segment de synchro-
nisation jusqu’à deux ou trois jours pour le segment après traitement, ﬁgure (1.2) (modèles de
repos-activité) et ﬁgure (1.3) (modèles d’expression des gènes).
Lorsqué’on étudie la stabilité de la période dominante nous devons considérer des signaux
très court par rapport à la connaissance a priori de la période dominante, placée dans le
domaine circadien. Les approches classiques basées sur la transformée de Fourier (TF) sont
inefﬁcaces (i.e. manque de précision) compte tenu de la particularité des données (i.e. la
courte longueur). Une autre particularité des signaux qui est prise en considération dans ces
expériences, est le niveau de bruit. Ces signaux étant très bruités, il est difﬁcle de determiner
les composantes périodiques associées aux phénomènes biologiques et de les distingue de
celle qui sont associées au bruit.
Dans cette thèse, nous proposons une nouvelle méthode pour l’estimation du vecteur de CP
des signaux biomédicaux, en utilisant les informations biologiques a priori et en considérant
un modèle qui représente le bruit,
g = H1f 1 + H2f 2 + ǫ
(1.1)
Les signaux enregistrés dans le cadre d’expériences développées pour le traitement du
13

CHAPTER 1. RÉSUMÉ
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
0
10
20
30
40
50
60
LD Period
Before DD
During DD
After DD
A2 Activity All - CT 502 
A2 Activity All - CT 502
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
×105
0
2
4
6
8
10
12
LD Period
Before DD
During DD
After DD
A2 Photon All - CT 502 
A2 Photon All - CT 502
Figure 1.1: Exemple de signaux chronobiologiques obtenus dans des expériences de traite-
ment du cancer: le signal repos-activité (en haut) et le signal l’expression des gènes (absorp-
tion de photons, en bas).
Number of points
0
1
2
Amplitude
0
10
20
30
40
50
60
A2 Activity Before - DD - CT 502 
A2 Activity Before - DD - CT 502
Number of points
0
1
2
3
4
Amplitude
0
10
20
30
40
50
60
A2 Activity During - DD - CT 502 
A2 Activity During - DD - CT 502
Number of points
0
1
Amplitude
0
10
20
30
40
50
60
A2 Activity After - DD - CT 502 
A2 Activity After - DD - CT 502
Figure 1.2: Les données brutes pour un signal representent des modelés de repos-activité en
chronobiologie: avant le traitement (gauche, longueur 3 jours), pendant le traitement (centre,
longueur de 5 jours), après le traitement (droite, longueur 2 jours).
Number of points
0
1
2
Amplitude
×104
0
1
2
3
4
5
6
7
8
9
10
A2 Photon Before - DD - CT 502 
A2 Photon Before - DD - CT 502
Number of points
0
1
2
3
4
Amplitude
×105
0
1
2
3
4
5
6
7
8
9
A2 Photon During - DD - CT 502 
A2 Photon During - DD - CT 502
Number of points
0
1
Amplitude
×105
0
0.5
1
1.5
2
A2 Photon After - DD - CT 502 
A2 Photon After - DD - CT 502
Figure 1.3: Les données brutes pour un signal representent l’expression des génes en chrono-
biologie: avant le traitement (gauche, longueur 3 jours), pendant le traitement (centre,
longueur de 5 jours), après le traitement (droite, longueur 2 jours).
14

cancer ont un nombre limité de périodes. Cette information a priori peut être traduit comme
la parcimonie du vecteur de CP. La méthode proposée considère l’estimation de vecteur de
CP comme un problème inverse en utilisant l’inférence bayésienne générale aﬁn de déduire
toutes les inconnues de notre modèle, à savoir le vecteur de CP mais aussi les hyperparamètres
(i.e. les variances associées),
p(f, θ1, θ2|g) ∝p(g|f, θ1) p(f|θ2) p(θ1) p(θ2)
(1.2)
où θ = (θ1, θ2) représente les hyperparamètres qui apparaissent dans le modèle.
L’information a priori de parcimonie est modélisée en utilisant une loi a priori renforcent
la parcimonie. Dans cette thèse, nous proposons une distribution de Student, pour sa propriété
de longue queue, présentée dans la ﬁgure (1.4).
St(f kj|ν) =
Γ

ν+1
2

√νπΓ

ν
2

 
1 + f kj2
ν
!−ν+1
2
(1.3)
−6
−4
−2
0
2
4
6
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
Normal vs Student−t Distribution
 
 
G ( x | 0, 1 )
St−t ( x | 1 )
Figure 1.4: Densité de la loi Normale et densité de la loi de Student.
La distribution de Student est considérée comme la distribution marginale d’une loi bivarié
- la distribution Normale - Inverse Gamma,
f kj|ν ∼
Z
N (fkj|0, vf j) IG(vf j|ν
2, ν
2), k ∈{1, 2} , j ∈{1, 2, . . ., M} .
(1.4)
En fait, lorsque l’égalité entre les paramèters de forme et d’échelle, de la distribution
Inverse Gamma n’est pas imposée, on a
f kj|αf0, βf0 ∼
Z
N (fkj|0, vfj) IG(vfj|αf0, βf0), k ∈{1, 2} , j ∈{1, 2, . . ., M} .
(1.5)
La marginale de la distribution Normale-Inverse Gamma est une généralisation de la distribu-
tion de Student
p(fkj|αf0, βf0) =
Γ(αf0 + 1
2)
q
2βf0π Γ(αf0)
 
1 + f kj2
2βf0
!−(αf0+ 1
2)
= Stg(f kj|αfj0, βfj0).
(1.6)
15

CHAPTER 1. RÉSUMÉ
La distribution bivariée Normale - Inverse Gamma, modélisant

f kj, vfj

et la distribution
marginale modélisant f kj sont présentés dans la ﬁgure (1.5).
−0.5
−0.4
−0.3
−0.2
−0.1
0
0.1
0.2
0.3
0.4
0.5
0
2
4
6
8
10
12
14
16
18
Marginal IGSM distribution
 
 
p(fj|αj,βj) ~ marg IGSM(fj|αj,βj)
Figure 1.5: La distribution bivarié Normale - Inverse Gamma modélisant

f kj, vfj

et la
distribution marginale modélisant f kj|αf0, βf0.
Nous construisons un modèle hierarchique où nous attribuons aussi une loi a priori pour
les hyperparamètres, Equation (1.7).





















p(g|f 1, f 2, vǫ) = N (g|H1f 1 + H2f 2, V ǫ)
p(vǫ|αǫ0, βǫ0) =
QN
i=1 IG(vǫi|αǫi0, βǫi0)
p(f 1|vf) = N (f 1|0, V f)
p(f 2|vf) = N (f 2|0, V f)
p(vf|αf0, βf0) =
QM
j=1 IG(vfj|αf0, βf0)
(1.7)
La forme analytique du modèle hiérarchique écrite par proportionnalités est le suivant:





































p(g|f 1, f 2, vǫ) ∝|V ǫ|−1
2 exp
n
−1
2∥V ǫ−1
2 (g −H1f 1 −H2f 2) ∥2o
p(vǫ|αǫ0, βǫ0) ∝
QN
i=1
βǫ0αǫ0
Γ(αǫ0) vǫi
−(αǫ0+1) exp
n
−βǫ0v−1
ǫi
o
p(f 1|vf) ∝|V f|−1
2 exp

−1
2∥V
−1
2
f f 1∥2

p(f 2|vf) ∝|V f|−1
2 exp

−1
2∥V
−1
2
f f 2∥2

p(vf|αf0, βf0) ∝QM
j=1
βf0
αf0
Γ(αf0) vf j
−(αf0+1) exp
n
−βf0v−1
fj
o
(1.8)
16

L’expression de la loi conjointe a posteriori du vecteur de CP et des hyperparamètres est
obtenue par la règle de Bayes:
p(f 1, f 2, vǫ, vf|g) ∝p(g|f 1, f 2, vǫ) p(vǫ|αǫ0, βǫ0) p(f 1|vf) p(f 2|vf) p(vf|αf0, βf0).
(1.9)
Les inconnues sont estimées soit par Joint Maximum A Posteriori (JMAP), soit par
l’espérance a posteriori (EAP). L’estimateur du Joint Maximum A Posteriori s’obtient en
calculant le mode de la loi a posteriori,
c
f 1, c
f 2, c
vǫ, c
vf

=
arg max
(f 1,f 2, vǫ, vf)
p(f 1, f 2, vǫ, vf|g) =
arg min
(f 1,f 2, vǫ, vf)
L(f 1, f 2, vǫ, vf),
(1.10)
où le critére L(f 1, f 2, vǫ, vf) est déﬁni comme suit:
L(f 1, f 2, vǫ, vf) = −ln p(f 1, f 2, vǫ, vf|g).
(1.11)
L’algorithme JMAP est présenté en détail dans la ﬁgure (1.6).
Pour le calcul de EAP,
l’expression de la loi a posteriori p(f 1, f 2, vǫ, vf|g) est approchée par une loi séparables
q(f 1, f 2, vǫ, vf|g):
p(f 1, f 2, vǫ, vf|g) ≈q(f 1, f 2, vǫ, vf|g) = q1(f 1) q2(f 2) q3(vǫ) q4(vf)
(1.12)
en utilisant l’approximation bayésienne variationelle (ABV), via la divergence de Kullback-
Leibler (KL), déﬁni comme suit:
KL (q(f 1, f 2, vǫ, vf1|g) : p(f 1, f 2, vǫ, vf1|g)) =
=
ZZ
. . .
Z
q(f 1, f 2, vǫ, vf|g) ln q(f 1, f 2, vǫ, vf|g)
p(f 1, f 2, vǫ, vf|g) df 1 df 2 dvǫ dvf,
(1.13)
où les notations suivantes sont utilisées:
q3(vǫ) =
N
Y
i=1
q3i(vǫi) ; q4(vf) =
M
Y
j=1
q4j(vf j) ;
dvǫ =
N
Y
i=1
dvǫi ;
dvf =
M
Y
j=1
dvfj
(1.14)
La minimisation peut se faire via l’optimisation alternée, résultant les proportionnalités
suivants:



























q1(f 1) ∝exp
n
⟨ln p(f 1, f 2, vǫ, vf|g)⟩q2(f 2) q3(vǫ) q4(vf )
o
q2(f 2) ∝exp
n
⟨ln p(f 1, f 2, vǫ, vf|g)⟩q1(f 1) q3(vǫ) q4(vf )
o
q3i(vǫi) ∝exp

⟨ln p(f 1, f 2, vǫ, vf|g)⟩q1(f 1) q2(f 2) q3−i(vǫi) q4(vf )

, i ∈{1, 2 . . ., N}
q4j(vfj) ∝exp

⟨ln p(f 1, f 2, vǫ, vf|g)⟩q1(f 1) q2(f 2) q3(vǫ) q4−j(vfj )

, j ∈{1, 2 . . ., M} ,
(1.15)
17

CHAPTER 1. RÉSUMÉ
c
f 1 =
h
HT
1 V ǫ−1H1 + V f −1i−1 HT
1 V ǫ−1 (g −H2f 2)
(a) - mise à jour de vector f 1
c
f 2 =
h
HT
2 V ǫ−1H2 + V f −1i−1 HT
2 V ǫ−1 (g −H1f 1)
(b) - mise à jour de vector f 2
d
vǫi =
βǫi0+1
2(gi−H2if 1−H2if 2)
2
αǫi0+3
2
(c) - mise à jour des variances du bruit vǫi
d
vfj =
βf0+1
2(f2
1j+f2
2j)
αf0+2
(d) - mise à jour des
variances du vector vfj
V ǫ = diag [ c
vǫ]
(e)
V f = diag
h
d
vf
i
(f)
Figure 1.6: Les equations de mise à jour des paramètres pour l’estimation MAP.
en utilisant les notations:
q3−i(vǫi) =
N
Y
k=1,k̸=i
q3k(vǫk)
;
q4−j(vfj) =
M
Y
k=1,k̸=j
q4k(vfk)
(1.16)
et aussi
⟨u(x)⟩v(y) =
Z
u(x)v(y) dy.
(1.17)
Deux possibilités sont envisagées: une approximation avec des lois partiellement séparables
ou entièrement séparable. Ces deux algorithmes sont présentés en détail dans la ﬁgure (1.7)
(approximation avec des lois partiellement séparables) et dans la ﬁgure (1.8) (approximation
avec des lois entièrement séparable).
18

f 1P M =

H1T g
V ǫH1 + g
V f
−1 H1T g
V ǫ (g −H2f 2P M)
Σ1P M
=

H1T g
V ǫH1 + g
V f
−1
(a) - mise à jour de vector f 1
f 2P M =

H2T g
V ǫH2 + g
V f
−1 H2T g
V ǫ (g −H1f 1P M)
Σ2P M
=

H2T g
V ǫH2 + g
V f
−1
(b) - mise à jour de vector f 2
αǫi
=
αǫ0 +
1
2
βǫi
=
βǫi0
+
1
2
h
(gi −Hi
1f 1P M −Hi
2f 2P M)2 +

Hi
1Σ1P MHiT
1 + Hi
2Σ2P MHiT
2
i
(c) - mise à jour des hyperparamètres de bruit
αfj
=
αfj0 + 1
βfj = βfj0 + 1
2
h
f 2
1jP M + Σ1jjP M + f2
2jP M + Σ2jjP M
i
(d) - mise à jour des hyperparamètres
d
V −1
ǫ
= diag

αǫi
βǫi

d
V −1
f
= diag

αfi
βfi

Initialisation
Figure 1.7: Les equations de mise à jour des paramètres pour l’estimation EAP via ABV,
séparabilité partielle.
19

CHAPTER 1. RÉSUMÉ
f 1jP M
=
H jT
1
d
V −1ǫ (g−H −j
1 f −j
1 −H 2f 2)
∥H jT
1
 d
V −1ǫ
1/2H j
1∥2+ c
v−1
fj
var1j
=
 
∥HjT
1

d
V −1
ǫ
1/2
Hj
1∥2 + d
v−1
fj
!1
(a) - mise à jour de l’élément f 1jP M du vecteur f 1
f 2jP M
=
H jT
2
d
V −1ǫ (g−H −j
2 f −j
2 −H 1f 1)
∥H jT
2
 d
V −1ǫ
1/2H j
2∥2+ c
v−1
fj
var2j
=
 
∥HjT
2

d
V −1
ǫ
1/2
Hj
2∥2 + d
v−1
fj
!1
(b) - mise à jour de l’élément f 2jP M du vector f 2
αǫi
=
αǫ0 +
1
2
βǫi
=
βǫi0
+
1
2
h
(gi −Hi
1f 1P M −Hi
2f 2P M)2 +

Hi
1Σ1P MHiT
1 + Hi
2Σ2P MHiT
2
i
(c) - mise à jour des hyperparamètres de bruit
αfj
=
αfj0 + 1
βfj = βfj0 + 1
2
h
f 2
1jP M + Σ1jjP M + f 2
2jP M + Σ2jjP M
i
(d) - mise à jour des hyperparamètres
d
V −1
ǫ
= diag

αǫi
βǫi

d
V −1
f
= diag

αfi
βfi

Initialisation
Figure 1.8: Les equations de mise à jour des paramètres pour l’estimation EAP via ABV,
séparabilité totale.
20

2
Introduction
Contents
2.1
Biological context: from chronobiology to chronotherapy . . . . . . . .
22
2.2
Experiments description
. . . . . . . . . . . . . . . . . . . . . . . . . .
23
2.3
Chronobiological signals: particularities
. . . . . . . . . . . . . . . . .
24
2.4
Summary description of the following chapters . . . . . . . . . . . . . .
26
T
HIS ﬁrst chapter gives a general presentation of the context of our work. From chrono-
biology and biological rhythms (in particular the circadian rhythms) to cancer treatment
(chronotherapy), gene expressions (along with other circadian indicators, like temperature or
rest-activity), signal processing and the particularities of such signals. The goal of this chap-
ter is to give a short presentation of how the periodic components estimation of (short) time
series arises naturally in the context of chronotherapy and cancer treatment. This chapter is
organized as it follows:
In Section (2.1) we give a brief presentation of the biological context: we introduce the circa-
dian rhythm, discuss its mechanism and its importance relative to cancer treatment.
Section (2.2) presents the experimental protocol for producing chronobiological signals: we
give details of the kind of mice used in those experiments, of the clock-genes that are studied,
discuss the protocol of the experiments and give brief details concerning the technology that
allows recording such signals.
Finally, Section (2.3) makes the transition from chronobiology and cancer treatment to sig-
nal processing: we present such signals, we discuss their particularities and deﬁne our goal
relative to such signals.
21

CHAPTER 2. INTRODUCTION
2.1 Biological
context:
from
chronobiology
to
chronotherapy
Several biological processes in living organisms follow oscillations that repeat themselves
about every 24 hours - these oscillations are called circadian rhythms. Together with other
periodic phenomena, they are the object of study of chronobiology, [HRM08], [SSL+11] and
[DSA10]. In mammals, circadian rhythms involve all organs, tissues and cells and are su-
pervised by the Circadian Timing System (CTS), a set of molecular clock genes that cross
regulate each other by positive and negative feedback loops, [MGT12], [MS04] and [TH94].
More precisely, the CTS consists of a central pacemaker, the Suprachiasmatic Nuclei (SCN)
in the hypothalamus, which is made sensitive to light by retinal afferents, and which coor-
dinates the molecular clocks in the peripheral organs by releasing/producing diffusible and
neurophysiologic signals, [DSA10].
In mammals, the core of the molecular clock consists of about a dozen speciﬁc clock
genes. The circadian oscillations in the single cells result from transcriptional and post-
transcriptional activation and inhibition regulatory loops. Speciﬁcally, a positive branch, in-
cluding the proteins Clock, Npas2 and Bmal1, and a negative branch, including Per (Per1 and
Per2), CRY (Cry1 and Cry2) are interconnected by the nuclear orphan receptor Rev-erbα.
The heterodimer of either Bmal1+Clock or Bmal1+Npas2 activate Per and Cry genes tran-
scription. These hetherodimers action is facilitated by Ezh2 (Polycomb protein), CK2 (casein
kinase 2) and SIRT1. Per and Cry proteins accumulation and activity is also regulated by phos-
phorylation by protein kinases (CKδ , ǫ), by ubiquitination (of Crys), by histone methylation
and demethylation. Dec1 and Dec2 compete with the Bmal1+Clock/Npas2 heterodimers to
bind Per and Cry genes, therefore reducing their activation. An accessory feedback loop sees
the nuclear orphan receptors Rorα, β and γ as activators of Bmal1 circadian transcription,
whereas Rev-erbα and β inhibit it.
The period of the circadian timing system, which is about 24 hours, is therefore regularly
calibrated by the succession of day and night (light and dark). It can be inﬂuenced by other
environmental factors, such as socio-professional interactions and feeding times, [MS04].
The resulting circadian physiologic ﬂuctuations are observed in sleep-wakefulness and rest-
activity alternation, body temperature, cortisol secretion by the adrenal gland, melatonin se-
cretion by the pineal gland, and they involve as well the sympathetic and the parasympathetic
systems, [TH94].
Former studies have already shown how focusing on/taking chronobiology into account can
improve anticancer treatments efﬁcacy and reduce at the same time their toxicity/increase at
the same time their tolerability, contrary to the previous "the worst the toxicity, the better
the efﬁcacy" paradigm, [LMDD+13], [IGM+11], [IGB+12] and [OTMB+13]. The molecular
clocks are involved in the regulation of important processes such as cell cycle and prolif-
eration, DNA damage sensing and repair, apoptosis, angiogenesis, pharmacodynamics and
pharmacokinetics, therefore they can greatly inﬂuence the metabolism, transportation and
detoxiﬁcation of drugs, [LOD+10].
Tolerability to anticancer treatments has been proven to depend signiﬁcantly on their timing
in respect to the circadian rhythms, measuring up to 10-fold changes in the tolerability to drug
administration at different circadian times for 40 anticancer drugs in rodents, and up to 5-fold
in patients, [LOD+10], [LS07]. Notably, chemotherapeutic agents proved to be at their best
efﬁcacy, both administered alone and combined, when they are also at their best tolerability
level, that is to say when they are least toxic to the healthy tissues.
22

Experiments description
Furthermore, substantial interpatient variability of circadian rhythms have been observed and
can be due to factors such as gender, age and genetic polymorphisms (amongst others), there-
fore anticancer drugs dosing and timing need to be personalized, at least for subgroups of pa-
tients with similar chronotoxicity (chronobiological) key features. Modulating drugs admin-
istration according to (the patient’s) circadian rhythms is known as/called "chronotherapy",
[F.01], [ML03]. On the other hand, administrating anticancer drugs at their most toxic time
causes the disruption of molecular clocks synchronization, which has been shown to acceler-
ate the cancer evolution, [FKL+02],[FL03],[IFG+09],[MWB+00],[SSKS00] and [FIW+05]
In order to optimize cancer treatment, once proven that a certain drug effects are susceptible
to circadian rhythms, the best administration time must be identiﬁed. Furthermore, in case of
interpatient variability in chronotoxicity, we want to personalize the standard chronotherapy
to best ﬁt to the patient’s circadian speciﬁcs.
2.2 Experiments description
The experiments considered are focused on irinotecan and everolimus, two of the most com-
mon drugs used at the moment in cancer treatment. First, for each drug is proved the correla-
tion with on the circadian rhythms in a rodent model, which has been proved to well represent
the human circadian phisiology, [LOD+10]. This is achieved by studying the chronotoxicity
of the drug, inferred by body weight loss and histopathologic lesions, at different circadian
times (CT, or ZT, from Zeitgeber time) using mice. Their circadian clock is synchronized
by exposure to light for 12 hours, followed by 12 hours of dark, repeating this cycle for one
week, and its rhythm is detected by measuring the expression of one or more of its core genes.
The genes are Bmal1, Per2, Rev-erbα.
Mice with a disrupted clock (clock-defective mice, obtained via the functional knock out of
one of its genes, normally Bmal1, Per2 or Rev-erbα) are used to conﬁrm the relevance of the
molecular clock for the drug toxicity.
At the same time, the main characteristics of the circadian expression of the observed gene(s)
are studied to observe whether the administration of the drug modiﬁes them. Once deﬁned the
CTs or ZTs at which the drug best and worst tolerability is observed, we can look for the (spe-
ciﬁc tissutal) molecular mechanisms that inﬂuence it. Genes inﬂuencing the pharmacokinetics
(absorption, distribution, metabolism and excretion) of the drug are a good starting point, and
we can follow how their expression correlates with the higher or lower drug chronotoxicity.
For instance, the transporter abcc2, involved in the cellular efﬂux of several drugs, has been
shown to inﬂuence irinotecan chronotolerance in ileum, according to the circadian changes in
abcc2 local expression [OPA+11].
Similarly, the experiments that we consider are studying everolimus toxicity in respect to the
circadian expression of intestinal Mdr1a. Everolimus is an anticancer drug also used as im-
munosuppressant after transplants to prevent organ rejection and its pharmacokinetics also
depend on Mdr1a, a P-glycoprotein (P-gp) which functions as a transmembrane drug trans-
porter and is responsible for multidrug resistance in cancer cells that over-express it, [GP93]
and [EIM90].
The circadian clocks of the mice used in such experiments are ﬁrst synchronized to the same
day-night alternation, where 12 hours of light are followed by 12 hours of dark (LD12:12).
After synchronization, the mice are kept in constant darkness (DD), which implies to subtract
the light as Zeitgeber, allowing the circadian clock to dictate their endogenous rhythm? and
23

CHAPTER 2. INTRODUCTION
normally the period of the circadian rhythm becomes shorter. After the start of DD, the mice
are split in two groups: to one the drug is administered at the CT of the best chronotolerance,
to the other at the CT of the worst chronotolerance. For each group one mouse is kept as
control, no drug is administered to it. Throughout the experiment, gene expression and rest-
activity pattern are measured to establish how the basic parameters of their circadian rhythms
(period, acrophase, amplitude) vary in respect to the drug treatment.
Both measures are allowed by an innovative monitoring device, the RealTime-Biolumicorder
(RT-BIO), [SLC+13]. The locomotor activity is detected by an infrared sensor, whereas the
gene expression is measured at the post-translational level in mice engineered to express the
gene of interest together with luciferase (fLUC), so that the gene activity and is marked by bio-
luminescence measured by a photomultiplier tube. Common mouse strains used are C57BL/6-
based [LMDD+13], [OPA+11] and 129S1/SvImJ, [LMB+09].
An exact estimation of the Periodic Components (PC) vector of the those chronobiological
signals is needed.
2.3 Chronobiological signals: particularities
The major interest is the study of the periodicity of such chronobiological time series, i.e.
the precise estimation of the PC vector and the stability of the dominant period, requiring
a dominant periodic components variation analysis. The major limitation is given by their
reduced length. Figure (2.1) presents the signals obtained in an experiment developed in
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
0
10
20
30
40
50
60
LD Period
Before DD
During DD
After DD
A2 Activity All - CT 502 
A2 Activity All - CT 502
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
×105
0
2
4
6
8
10
12
LD Period
Before DD
During DD
After DD
A2 Photon All - CT 502 
A2 Photon All - CT 502
Figure 2.1: Example of chronobiological signals obtained in cancer treatment experiments:
the rest-activity signal (up) and the gene expression signal (photon absorption, bottom)
the conditions described in Section (2.2). As mentioned, via the RT-BIO monitoring device,
[SLC+13] the gene expression and the rest-activity patterns can be recorded. The experiment
exempliﬁed in Figure (2.1) corresponds to 22 days and both signals are sampled every minute
(rest-activity pattern - up and gene expression - bottom). The gene expression is measured
24

Chronobiological signals: particularities
by a photomultiplier tube, and the amplitude of the signal represents the photon absorption.
For the rest-activity pattern, the locomotor activity is detected by an infrared sensor. For the
PC vector estimation, four segments are of great interest: the ﬁrst part, corresponding to the
synchronization part, where 12 hours of light are followed by 12 hours of dark (LD12:12)
and then the second part, in complete darkness (DD), which is divided in three segments,
corresponding to before, during and after treatment. We note that the length of those segments
vary between two or three days (the segments corresponding to the after treatment and to the
before treatment) and 7 days (the segment corresponding to the synchronization, (LD12:12)).
When studying the stability or the variability of the PC vector, even shorter signal must be
considered. More precisely, for analysing the stability for the segment corresponding to the
during treatment, at least 4 days length signals should be considered. In this context, we note
a ﬁrst particularity of the signal that are considered for the PC vector estimation. Relative to
the prior knowledge, an about 24 hours periodicity, we deal with very short signals: three
or four days length signals, relative to the an about one day period. Another particularity
of such signals is represented by the noise. Both signals, the one corresponding to the gene
expression and the one corresponding to the rest-activity pattern are (very) noisy signals due
to the measurement errors.
The problem that is considered can be formulated as it follows: precise estimation of the
PC vector of noisy and very short signals relative to our knowledge for the principal period.
Examples of raw data signals for which the corresponding PC vector must be inferred are
presented in Figure (2.2) and Figure (2.3) One fundamental particularity of such signals is
Number of points
0
1
2
Amplitude
0
10
20
30
40
50
60
A2 Activity Before - DD - CT 502 
A2 Activity Before - DD - CT 502
Number of points
0
1
2
3
4
Amplitude
0
10
20
30
40
50
60
A2 Activity During - DD - CT 502 
A2 Activity During - DD - CT 502
Number of points
0
1
Amplitude
0
10
20
30
40
50
60
A2 Activity After - DD - CT 502 
A2 Activity After - DD - CT 502
Figure 2.2: Raw data for a rest-activity pattern signal in chronobiology: before treatment (left,
3 days length), during treatment (center, 5 days length), after treatment (right, 2 days length)
Number of points
0
1
2
Amplitude
×104
0
1
2
3
4
5
6
7
8
9
10
A2 Photon Before - DD - CT 502 
A2 Photon Before - DD - CT 502
Number of points
0
1
2
3
4
Amplitude
×105
0
1
2
3
4
5
6
7
8
9
A2 Photon During - DD - CT 502 
A2 Photon During - DD - CT 502
Number of points
0
1
Amplitude
×105
0
0.5
1
1.5
2
A2 Photon After - DD - CT 502 
A2 Photon After - DD - CT 502
Figure 2.3: Raw data for a gene expression signal in chronobiology: before treatment (left, 3
days length), during treatment (center, 5 days length), after treatment (center, 2 days length)
given by the biological prior knowledge: the number of periodic components is small, i.e. the
PC vector is sparse. In Chapter (3) we present the drawback of the classical methods, and
in Chapter (4) we present the proposed method for the PC vector estimation, using the prior
information.
25

CHAPTER 2. INTRODUCTION
2.4 Summary description of the following chapters
In Chapter (2) we have established the context of our work. Brieﬂy, the fundamental goal of
our work can be summarized as it follows:
Estimate the sparse PC amplitudes vector corresponding to short duration signals relative
to the (prior) dominant period with a given precision. The number of components is small
(sparse PC amplitudes vector) but unknown.
First, we present some classical methods that can be considered in order to address the above
question. In Chapter (3) we examine the Fourier Transform techniques, the Direct or General-
ized Inversion (DI), Least Squares (LS) and Regularized Least Squares techniques and ﬁnally
we consider the L1 regularization and the LASSO method, the nearest state of art method to
account for sparsity through L1 regularization term. We will show that given the particulari-
ties of the context, i.e. the short duration of the signals relative to the (prior) dominant period,
the high level of noise in the signals, the above methods do not give satisfactory results.
In Chapter (4) we introduce the proposed solution, based on a forward model that accounts the
noise, built in a similar way as the one corresponding to the Fourier transform but using the
elements corresponding to the considered circadian PC amplitudes vector (in terms of limits
and precision). The estimation of the PC amplitudes vector (but also the other hyperparmeters
involved in the model, i.e. the variances corresponding to the PC amplitudes vector and the
noise) corresponds to an ill posed inverse problem, due to the huge condition number of the
matrix in the forward model. The proposed inversion is based on the general Bayesian in-
ference, based on a generalization of the Student-t distribution used as the sparsity enforcing
prior for the PC amplitudes vector.
In Chapter (5) we test the results corresponding to the proposed algorithm on synthetic data,
for different levels of noise.
In Chapter (6) the proposed algorithm is used for real data. Finally, in Chapter (7) we present
the conclusions.
26

3
Classical Methods
Contents
3.1
Basic example and notations
. . . . . . . . . . . . . . . . . . . . . . . .
27
3.2
Fourier Transform . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
29
3.3
Zero Padding . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
31
3.4
Direct or Generalized Inversion
. . . . . . . . . . . . . . . . . . . . . .
32
3.5
Least Squares and regularized LS . . . . . . . . . . . . . . . . . . . . .
37
3.6
L1 regularization and LASSO
. . . . . . . . . . . . . . . . . . . . . . .
43
3.7
Conclusion and why go to Bayesian
. . . . . . . . . . . . . . . . . . . .
48
T
HE main objective of this chapter is to show that the classical methods have some limi-
tations when faced with the biological signals we are concerned. To show this, ﬁrst we
simulate a synthetic signal g(t) very near to the biological data we may have to process (short
signal, i.e. 4 days length, very noisy, i.e. 5dB) and show the limitations of many well known
methods.
3.1 Basic example and notations
For this purpose, ﬁrst we consider the following forward model:
g(t) = g0(t) + ǫ(t),
(3.1)
where
• g0(t) =
PM
j=1 fje
−i 2π
pj t;
• p = {p1, p2, . . . pM} is the known periods vector, called Periodic Components (PC)
vector during the manuscript;
27

CHAPTER 3. CLASSICAL METHODS
• f = {f1, f2, . . .f M} is the corresponding amplitudes vector, called Periodic Compo-
nents (PC) amplitudes vector;
• ǫ(t) represents the errors and noise.
We are assuming that a few components p∗of p have non-zero amplitudes f ∗. In order to
analyse the effects of the noise, we will apply the methods not only on the original signal
g0(t), i.e. the signal without noise, but also on the noisy signal g(t). As we are using sampled
signal g(t) for t = 0, . . . , (N −1)∆t, with ∆t = 1h. In the following we can write g0 = Hf
and g = g0 + ǫ where g = {g0, g1, . . . , gN−1}, ǫ = {ǫ0, ǫ1, . . . , ǫN−1}, and Hnm = e−i 2π
pm tn.
To summarize:
• f - original Periodic Component (PC) amplitudes vector;
• f ∗- the non-zero elements of f;
• g0 - original signal g0 = Hf
• g - noisy signal g = Hf + ǫ;
• c
f 0 - estimated f by any method, corresponding to the original signal, g0
• bf - estimated f by any method, corresponding to a noisy input, g
• δf 1 - L1 relative estimation error δf 1 = ∥f −bf ∥1
∥f ∥1
• δf 2 - L2 relative estimation error δf 2 = ∥f −bf ∥2
2
∥f ∥2
2
• bg - reconstructed signal (estimated data) bg = H bf
• δg1 - L1 relative estimation error δg1 = ∥g−bg∥1
∥g∥1
• δg2 - L2 relative estimation error δg2 = ∥g−bg∥2
2
∥g∥2
2
Some classical methods are presented in this chapter. Section (3.2) presents the results cor-
responding to the Fourier Transform. Section (3.3) presents the results corresponding to the
zero padding technique. In Section (3.4) we discuss the Direct Inversion (DI). Section (3.5)
deals with the results corresponding to the Least Squares and Regularized Least Squares tech-
niques. In Section (3.6) we consider the LASSO technique and present the corresponding
results.
We consider a synthetic sparse PC amplitudes vector, deﬁned for the circadian domain and for
the potential relevant harmonics, [8 : 32], with non zero values corresponding to 11h, 15h and
23h. The corresponding amplitudes are 0.7, 0.5 and 1. The PC amplitudes vector, the forward
operator, the corresponding signal and noisy signal (SNR=5dB) are presented in Figure (3.1).
We apply the methods mentioned above both for the signal without noise (Figure (3.1c)) and
for the noisy signal, 5dB (Figure (3.1d)). For each PC amplitudes vector estimation, we
present the comparison with the theoretical PC amplitudes vector, Figure (3.1a) and also the
comparison between the reconstructed signal and the signal without noise. For certain meth-
ods (LASSO) we will also consider the variability of the L1 and L2 PC amplitudes vector error
28

Fourier Transform
estimation for different noise realisation, in order to establish if the method is stable. We also
present results corresponding to the behaviour of the L1 and L2 PC amplitudes vector error
estimation depending on the level of noise (SNR).
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
0
0.2
0.4
0.6
0.8
1
PC vector f
(a) Sparse PC vector f
Forward Operator H
5
10
15
20
25
10
20
30
40
50
60
70
80
90
-1
-0.5
0
0.5
1
(b) Forward operator
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
Original Signal g0
(c) Original signal g0
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
Noisy Signal g
(d) Noisy signal g (05dB)
Figure 3.1: Synthetic data: sparse theoretical PC amplitudes vector f with 3 non-zero peaks
corresponding to 11h, 15h and 23h (3.1a); forward operator H (3.1b); original signal g0 =
Hf (3.1c); noisy signal g = g0 + ǫ (SNR=05dB) (3.1d)
3.2 Fourier Transform
The spectral analysis for time series is a well known subject in literature for a very long time.
Some of the most used methods are the Fast Fourier Transform based methods, which are
widely used for many applications in the signal processing community, having obvious ad-
vantages: the FFT based methods are well known, well understood and fast. Nevertheless, the
particularities of the biomedical signals considered in chronobiology experiments show that
the classical methods presents certain limitations. In particular, for short time series relative to
the searched (via prior knowledge) periodic components (in the experiment considered in this
article, a 96h recorded signal relative to a 24h periodic component, linked with the circadian
clock) the precision given by the FFT methods is by far insufﬁcient for determining the exact
periodic components. This is a consequence of the fact that via the FFT based methods, even
if the frequencies are linear, the periods are not equidistant. In particular, for a four day (96h)
recorded biomedical signal, beside the 24h corresponding periodic components, the nearest
amplitudes in the periodic components vector correspond to the 32h, respectively 19h periodic
components. More general, if the prior knowledge sets the principal period around a value
P, it is easy to see that in order to obtain a period vector that contains the period P and also
the periods P −1 and P + 1, the signal must be observed for (P −1)(P + 1) periods, i.e.
(P −1)P(P + 1). For the chronobiology applications, where the circadian period is around
29

CHAPTER 3. CLASSICAL METHODS
24h, this is translated as the need to record a signal for 575 days in order to obtain a periodic
component vector that contains the 23, 24 and 25 periods. Evidently, the signal should be
observed for an exponential bigger interval of time in order to obtain a periodic component
vector that contains all the periods from the circadian domain is searched.
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
Original Signal g0
(a) Original signal g0
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
Noisy Signal g
(b) Noisy signal g (05dB)
Periods
8   
8.7 
9.6 
10.6
12  
13.7
16  
19.2
24  
32  
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
PC vector c
f0 (FFT)
(c) c
f 0 via FFT
Periods
8   
8.7 
9.6 
10.6
12  
13.7
16  
19.2
24  
32  
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
PC vector b
f (FFT)
(d) bf via FFT
Figure 3.2: Estimated PC amplitudes vectors c
f 0 (3.2c) and bf (3.2d) for the original signal g
(3.2a) and the noisy signal g0 (3.2b) corresponding to the theoretical sparse PC amplitudes
vector, (3.1a)
As an example, Figure (3.2) presents the FFT PC amplitudes vectors c
f 0 (Figure (3.2c))
and bf (Figure (3.2d)) corresponding to the original signal g0 and the noisy signal g. The
signals presented in Figure (3.2a) and Figure (3.2b) correspond to the sparse PC vector, Fig-
ure (3.1a), via the forward operator, Figure (3.1b).
The corresponding PC amplitudes vectors obtained via FFT are presented for the interval be-
tween 8h and 32 h, the circadian domain. In the synthetic PC vector the non-zero periods are
set for 11h, 15h and 23h (dominant peak). The FFT estimates the dominant peak at 24h, due
to the fact that the time series observation period is limited to 96h, for both cases, original
and noisy signal. In such conditions, it offers no information for the correct positions, 11h,
15h, 23h. It also offers no informations for the periods in the interval [20 : 31], except the
estimation for 24h. A better image of the intervals with no information from the PC ampli-
tudes vectors estimations is presented in Figure (3.3), where the periods of the PC amplitudes
vector are not scaled.
For similar signals, corresponding to PC vectors having the principal peak around 24h,
the FFT will estimate the principal peak at 24h. Another example is presented in Figure (3.4).
A four days length signal recorded in an experiment in chronobiology is presented in Fig-
ure (3.4a). Figure (3.4b) presents its corresponding FFT PC amplitude vector, with the same
drawbacks presented in the synthetic example, Figure (3.2). The FFT PC vector presents
peaks corresponding only to 8h, 8.72h, 9.6h, 10.66h, 12h, 13.71h, 16h, 19.2h, 24h and 32h
30

Zero Padding
Periods
8   8.7 9.6 10.6 12  13.7
16  
19.2
24  
32  
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
PC vector c
f0 (FFT)
(a) c
f 0 via FFT
Periods
8   8.7 9.6 10.6 12  13.7
16  
19.2
24  
32  
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
PC vector b
f (FFT)
(b) bf via FFT
Figure 3.3: Estimated PC amplitudes vectors c
f 0 (3.3a) and bf (3.3b). Periods are not scaled
in the plot.
inside the considered interval [8 : 32]. The periods corresponding to 24h, 12h and 8h can
be associated with the presence of the circadian rhythm, expressed by the principal peak and
the corresponding harmonics. But the presence of the other peaks can be more difﬁcult to
be interpreted by the biologists. Another drawback of FFT is the difﬁculty of selecting the
peaks corresponding to the presence of a biological phenomena and peaks that are explained
by error measures and uncertainties.
Figure (3.4c) presents the PC amplitudes vector estimated via the proposed method, pre-
sented in Chapter (4).
3.3 Zero Padding
One possible approach to artiﬁcially increase the precision of the FFT estimation is the zero
padding technique, which consists of appending zeros to the signal. In the simulations pre-
sented in this Section (3.2), we have considered a four days length signal, and analysed the
FFT PC amplitudes vector estimation, Figure (3.2). Between 8h and 32h, via FFT, we obtained
informations corresponding only for 10 periods. Considering the zero padding technique, the
number of the periods in the PC amplitudes vector can be increased.
First, we consider the signal from Figure (3.1c) and the noisy signal from Figure (3.1d),
both padded with zero values for four days, and the corresponding FFT PC amplitudes vectors,
Figure (3.5):
Padding the signal with 4 additional days with zero values, the results do not improve:
there are still no informations for certain periods inside the studied domain: compared with
the FFT PC amplitudes vector estimated using just the available signal, with zero padding the
interval [20 : 31] has only two additional periods, corresponding to 21.3 and 27.4. A better
image of the segments with no information for the periods is showed in Figure (3.6).However,
the sparsity rate is increased (the PC amplitudes vector is less sparse), and selecting the peaks
corresponding to the biological phenomena is difﬁcult.
We consider the same approach, padding the signal with 12 days of zero values, Fig-
ure (3.7):
Also in this case there are still no informations for certain periods inside the studied do-
31

CHAPTER 3. CLASSICAL METHODS
0
24
48
72
−2000
−1000
0
1000
2000
3000
Time(h)
Amplitude
Real Signal
g
SNR=0
(a) Real signal recorded in cancer treatment experiments, f
8
8.72
9.6
10.66
12
13.71
16
19.2
24
32
0
50
100
150
200
Periods
Amplitude
FFT PC
b
fF F T
(b) FFT PC amplitude vector bf
8
11
14
17
20
23
26
29
32
0
50
100
150
200
250
300
350
400
450
Periods
Amplitude
Estimated PC (VBA1 St−t)
b
fV BA1St
(c) PC vector corresponding to Proposed Method (PM estimation, IGSM model)
Figure 3.4: Real data: A 4 days length signal recorded in cancer treatment experiments (3.4a),
the PC amplitudes vector corresponding to FFT (3.4b) and corresponding to the proposed
method (3.4a).
main, Figure (3.8). Evidently, increasing the length of the zero vector, we can obtain infor-
mations corresponding to the all periods from the circadian domain considered. However, the
estimation is not a sparse vector, and therefore the selection of the periods corresponding to
the biological phenomena is very difﬁcult.
3.4 Direct or Generalized Inversion
In this section, we consider another classical method: the Direct Inversion (DI). When g =
Hf and H is a square and invertible matrix, we have bf = H−1g. In fact, the case where
H is the FFT matrix, H−1 is the IFFT matrix. But in our case, the forward operator H is
not necessarily a square matrix, but the pseudoinverse (or the generalized inverse) can still be
used. The relation between the original signal g0 and the corresponding PC amplitudes vector
32

Direct or Generalized Inversion
Time(h)
0  
24 
48 
72 
96 
120
144
168
Amplitude
-3
-2
-1
0
1
2
3
Original Signal g0 (ZP)
(a) Zero padded original signal g0
Time(h)
0  
24 
48 
72 
96 
120
144
168
Amplitude
-3
-2
-1
0
1
2
3
Noisy Signal g (ZP)
(b) Zero padded noisy signal g
Periods
8   8.3 8.7 9.1 9.6 10.110.611.212  12.813.714.716  17.419.221.324  27.432  
Amplitude
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
PC vector c
f0 (ZP)
(c) c
f 0 via FFT
Periods
8   8.3 8.7 9.1 9.6 10.110.611.212  12.813.714.716  17.419.221.324  27.432  
Amplitude
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
PC vector b
f (ZP)
(d) bf via FFT
Figure 3.5: Estimated PC amplitudes vectors c
f 0 (3.5c) and bf (3.5d) for the zero padded origi-
nal signal g (3.5a) and the zero padded noisy signal g0 (3.5b) corresponding to the theoretical
sparse PC amplitudes vector, (3.1a)
Periods
8   
8.3 
8.7 
9.1 
9.6 
10.1
10.6
11.212  
12.8
13.714.716  17.4 19.2
21.3
24  
27.4
32  
Amplitude
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
PC vector c
f0 (ZP)
(a) c
f 0 via FFT
Periods
8   
8.3 
8.7 
9.1 
9.6 
10.1
10.6
11.212  
12.8
13.714.716  17.4 19.2
21.3
24  
27.4
32  
Amplitude
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
PC vector b
f (ZP)
(b) bf via FFT
Figure 3.6: Estimated PC amplitudes vectors c
f 0 (3.6a) and bf (3.6b), corresponding to zero
padded signals. Periods are not scaled in the plot.
f is given in Equation (3.2).
g0 = Hf
(3.2)
33

CHAPTER 3. CLASSICAL METHODS
Time(h)
0  
24 
48 
72 
96 120 144 168 192 216 240 264 288 312 336 360
Amplitude
-3
-2
-1
0
1
2
3
Original Signal g0 (ZP3)
(a) Zero padded original signal g0
Time(h)
0  
24 
48 
72 
96 120 144 168 192 216 240 264 288 312 336 360
Amplitude
-3
-2
-1
0
1
2
3
Noisy Signal g (ZP3)
(b) Zero padded noisy signal g
Periods
8   8.1 
8.3 
8.5 
8.7 
8.9 
9.1 
9.3 
9.6 
9.8 
10.1
10.3
10.6
10.9
11.2
11.6
12  
12.3
12.8
13.2
13.7
14.2
14.7
15.3
16  
16.6
17.4
18.2
19.2
20.2
21.3
22.5
24  
25.6
27.4
29.5
32  
Amplitude
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.16
0.18
0.2
PC vector c
f0 (ZP3)
(c) c
f0 via FFT
Periods
8   8.1 
8.3 
8.5 
8.7 
8.9 
9.1 
9.3 
9.6 
9.8 
10.1
10.3
10.6
10.9
11.2
11.6
12  
12.3
12.8
13.2
13.7
14.2
14.7
15.3
16  
16.6
17.4
18.2
19.2
20.2
21.3
22.5
24  
25.6
27.4
29.5
32  
Amplitude
0
0.05
0.1
0.15
0.2
0.25
PC vector b
f (ZP3)
(d) bf via FFT
Figure 3.7: Estimated PC amplitudes vectors c
f 0 (3.7c) and bf (3.7d) for the zero padded origi-
nal signal g (3.7a) and the zero padded noisy signal g0 (3.7b) corresponding to the theoretical
sparse PC amplitudes vector, (3.1a)
Periods
8   
8.1 
8.3 
8.5 
8.7 
8.9 
9.1 
9.3 
9.6 
9.8 
10.1
10.3
10.6
10.9
11.2
11.6
12  
12.3
12.8
13.2
13.7
14.2
14.7
15.3
16  
16.6
17.4
18.219.220.221.322.5 24  25.6 27.4
29.5
32  
Amplitude
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.16
0.18
0.2
PC vector c
f0 (ZP3)
(a) c
f0 via FFT
Periods
8   
8.1 
8.3 
8.5 
8.7 
8.9 
9.1 
9.3 
9.6 
9.8 
10.1
10.3
10.6
10.9
11.2
11.6
12  
12.3
12.8
13.2
13.7
14.2
14.7
15.3
16  
16.6
17.4
18.219.220.221.322.5 24  25.6 27.4
29.5
32  
Amplitude
0
0.05
0.1
0.15
0.2
0.25
PC vector b
f (ZP3)
(b) bf via FFT
Figure 3.8: Zero padded signal (a) and the corresponding FFT PC amplitudes vector.
Deﬁning H+ = HT 
HHT −1 it is easy to verify that H+ is satisfying all of the following
four criteria:
HH+H = H
(3.3a)
H+HH+ = H+
(3.3b)

HH+T = HH+
(3.3c)

H+H
T = H+H
(3.3d)
so H+ is the pseudoinverse of H. First, we apply the method considering the signal with-
out noise, Figure (3.9a).
The estimated PC vector via DI is presented in Figure (3.9b).
34

Direct or Generalized Inversion
The comparison between the estimated PC amplitudes vector via DI and the theoretical
PC amplitudes vector is presented in Figure (3.9c). The L1 PC amplitude vector estima-
tion error is δf 1 = 0.86 × 10−6 ≃0 and the L2 PC amplitude vector estimation error is
δf 2 = 0.56 × 10−6 ≃0. The comparison between the reconstructed signal the original signal
is presented in Figure (3.9d), with the L1 signal reconstruction error is δg1 = 0.42×10−15 ≃0
and the L2 signal reconstruction error error is δg2 = 0.44 × 10−15 ≃0. In this case, the DI
method gives very good result.
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
Original Signal g0
(a) Original signal g0
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
0
0.2
0.4
0.6
0.8
1
PC vector c
f0 (DI)
(b) PC via DI c
f 0
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
0
0.2
0.4
0.6
0.8
1
L1 error = 8.6151e-07
L2 error = 5.6885e-07
f0 vs. c
f0 (DI)
Theoretical
Estimated - DI
(c) c
f 0 vs. f 0
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L1 error = 4.201e-16
L2 error = 4.4245e-16
g0 vs. b
g0 (DI)
Theoretical
Estimated - DI
(d) c
g0 vs. g0
Figure 3.9: Direct Inversion: Signal without noise
However, for the forward operator, we note that the condition number of the matrix is very
high. In particular, in this case we have
cond(H) = 5.6799 × 1010,
(3.4)
where H denotes the forward operator, Figure (3.1b). Due to this high value of the condition
number of the matrix, the problem is ill-posed. We consider in the following the results
corresponding to the DI, but applied on the noised signal. First, we consider the case SNR=
50dB, Figure (3.10).
We note that for a very small SNR, even though the signal is well reconstructed, Fig-
ure (3.10d), with the L1 signal reconstruction error δg1 = 1.6 × 10−3 and the L2 signal
reconstruction error error is δg2 = 1.6 × 10−3, the PC estimation via DI, Figure (3.10c) has a
huge error: the L1 PC amplitude vector estimation error is δf 1 = 4.87 × 106 and the L2 PC
amplitude vector estimation error is δf 2 = 3.24 × 106. Further, we consider the SNR= 20dB
(Figure (3.11)) and SNR= 05dB (Figure (3.12)) cases:
In both cases, the signal reconstruction is fairly accurate. For 20dB, the L1 signal recon-
struction error δg1 = 3 × 10−2 and the L2 signal reconstruction error error is δg2 = 4 × 10−2,
Figure (3.11d) and for 05dB, the L1 signal reconstruction error δg1 = 2.3 × 10−1 and the L2
35

CHAPTER 3. CLASSICAL METHODS
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
Noisy Signal g
(a) Signal, 50dB, g
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
×10 6
-2.5
-2
-1.5
-1
-0.5
0
0.5
1
1.5
2
2.5
PC vector b
f (DI)
(b) PC via DI bf
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
×10 6
-2.5
-2
-1.5
-1
-0.5
0
0.5
1
1.5
2
2.5
L1 error = 4874462.3007
L2 error = 3240004.0531
f vs. b
f (DI)
Theoretical
Estimated - DI
(c) bf vs. f
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L1 error = 0.0016309
L2 error = 0.0016187
g0 vs. b
g0 (DI)
Theoretical
Estimated - DI
(d) bg vs. g
Figure 3.10: Direct Inversion: Signal with noise, 50dB
Time(h)
0 
24
48
72
Amplitude
-2
-1
0
1
2
3
Noisy Signal g
(a) Signal, 20dB, g
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
×10 8
-1
-0.5
0
0.5
1
PC vector b
f (DI)
(b) PC via DI bf
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
×10 8
-1
-0.5
0
0.5
1
L1 error = 250799960.7753
L2 error = 157831221.5274
f vs. b
f (DI)
Theoretical
Estimated - DI
(c) bf vs. f
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L1 error = 0.036998
L2 error = 0.040423
g0 vs. b
g0 (DI)
Theoretical
Estimated - DI
(d) bg vs. g
Figure 3.11: Direct Inversion: Signal with noise, 20dB
signal reconstruction error error is δg2 = 2.4 × 10−1, Figure (3.12d). In both cases, the PC
amplitude vector error estimation is huge. For 20dB the L1 PC amplitude vector estimation
error is δf 1 = 2.5 × 109 and the L2 PC amplitude vector estimation error is δf 2 = 1.5 × 109,
Figure (3.11c) and for 05dB the L1 PC amplitude vector estimation error is δf 1 = 2.7 × 1010
36

Least Squares and regularized LS
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
Noisy Signal g
(a) Signal, 5dB, g
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
×10 9
-1
-0.5
0
0.5
1
PC vector b
f (DI)
(b) PC via DI bf
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
×10 9
-1
-0.5
0
0.5
1
L1 error = 2748439970.2929
L2 error = 1730220809.9471
f vs. b
f (DI)
Theoretical
Estimated - DI
(c) bf vs. f
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L1 error = 0.23963
L2 error = 0.24354
g0 vs. b
g0 (DI)
Theoretical
Estimated - DI
(d) bg vs. g
Figure 3.12: Direct Inversion: Signal with noise, 05dB
and the L2 PC amplitude vector estimation error is δf 2 = 1.7 × 1010, Figure (3.12c). The
behaviour of the DI L1 and L2 PC amplitudes vector estimation error δf 1 and δf 2 and L1
and L2 signal reconstruction error δg1 and δg2, depending on the level of noise is presented
in Figure (3.13).
The PC estimation error via Direct Inversion is huge even for small values corresponding
to the SNR, Figure (3.13a). Therefore, the Direct Inversion approach can not be used for a
precise PC amplitudes vector estimation, due to the fact that the for the real data, the level of
noise is very important.
3.5 Least Squares and regularized LS
In this section, we consider another classical method: the Least Squares and its extension,
regularized Least Squares. For the LS, the solution is given by:
bf = arg min
f
∥g −Hf∥2
2,
(3.5)
which leads to
bf = (HTH)−1HTf
(3.6)
For the regularized LS, the solution is given by:
bf = arg min
f
J(f),
(3.7)
where the criterion J(f) is deﬁned as:
J(f) = ∥g −Hf∥2
2 + λ∥f∥2
2.
(3.8)
37

CHAPTER 3. CLASSICAL METHODS
SNR
5 
10
15
20
25
30
40
50
Error
×10 9
0
0.5
1
1.5
2
2.5
3
δ f1 and δ f2 PC Estimation Error (DI)
δ f1
δ f2
(a) δf 1 and δf 2
SNR
5 
10
15
20
25
30
40
50
Error
0
0.05
0.1
0.15
0.2
0.25
δ g1 and δ g2 Signal Estimation Error (DI)
δ g1
δ g2
(b) δg1 and δg2
Figure 3.13: Direct Inversion L1 and L2 errors: PC estimation errors and signal reconstruction
errors
First, we consider the Least Squares, applied on the signal without noise, Figure (3.14).
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
Original Signal g0
(a) Original Signal, g0
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
-0.2
-0.1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
PC vector c
f0 (LS)
(b) PC via LS, c
f 0
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
-0.2
0
0.2
0.4
0.6
0.8
1
L1 error = 0.69062
L2 error = 0.45264
f0 vs. c
f0 (LS)
Theoretical
Estimated - LS
(c) c
f0 vs. f0
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L1 error = 5.4703e-07
L2 error = 5.9409e-07
g0 vs. b
g0 (LS)
Theoretical
Estimated - LS
(d) c
g0 vs. g0
Figure 3.14: Least Squares: Signal without noise
We note that the reconstruction of the signal is accurate, with the L1 signal reconstruction
38

Least Squares and regularized LS
error δg1 = 5.4×10−7 ≃0 and the L2 signal reconstruction error error is δg2 = 5.94×10−7 ≃
0, Figure (3.14d).
The LS PC amplitude vector estimation, Figure (3.14c) has a signiﬁcant error: the L1 PC
amplitude vector estimation error is δf 1 = 0.69 and the L2 PC amplitude vector estimation
error is δf 2 = 0.45. We note that different from the DI approach, presented in Section (3.4),
for which the PC amplitude vector estimation error is huge when the considered signal is
noisy, but the PC amplitude vector estimation error is very small for the case when the input
has no noise, for the LS approach, the PC amplitude vector estimation error is signiﬁcant even
in this case.
We consider the cases where the signal is noised, SNR= 15dB, Figure (3.15), SNR=
10dB, Figure (3.16) and SNR= 05dB, Figure (3.17)
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
Noisy Signal g
(a) Signal, 15dB, g
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
-100
-50
0
50
100
PC vector b
f (LS)
(b) PC via LS, bf
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
-100
-50
0
50
100
L1 error = 444.6272
L2 error = 195.8683
f vs. b
f (LS)
Theoretical
Estimated - LS
(c) bf vs. f
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L1 error = 0.089867
L2 error = 0.086922
g0 vs. b
g0 (LS)
Theoretical
Estimated - LS
(d) bg vs. g
Figure 3.15: Least Squares: Signal with noise, 15dB
The results corresponding to the LS method, considering the input signal with SNR=
15dB noise is presented in Figure (3.15). The input signal, with SNR= 15dB is presented
in Figure (3.15a). The estimated PC vector via LS is presented in Figure (3.15b). The com-
parison between the estimated PC amplitudes vector via LS and the theoretical PC ampli-
tudes vector is presented in Figure (3.15c). The L1 PC amplitude vector estimation error is
δf 1 = 4.44 × 102 and the L2 PC amplitude vector estimation error is δf 2 = 1.95 × 102.
The comparison between the reconstructed signal and the original signal is presented in Fig-
ure (3.15c), with the L1 signal reconstruction error δg1 = 0.08 and the L2 signal reconstruc-
tion error δg2 = 0.08.
The results corresponding to the LS method, considering the input signal with SNR=
10dB noise is presented in Figure (3.16). The input signal, with SNR= 10dB is presented
in Figure (3.16a). The estimated PC vector via LS is presented in Figure (3.16b). The com-
parison between the estimated PC amplitudes vector via LS and the theoretical PC ampli-
39

CHAPTER 3. CLASSICAL METHODS
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
Noisy Signal g
(a) Signal, 10dB, g
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
-150
-100
-50
0
50
100
150
PC vector b
f (LS)
(b) PC via LS, bf
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
-150
-100
-50
0
50
100
150
L1 error = 631.9012
L2 error = 277.8745
f vs. b
f (LS)
Theoretical
Estimated - LS
(c) bf vs. f
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L1 error = 0.1332
L2 error = 0.12804
g0 vs. b
g0 (LS)
Theoretical
Estimated - LS
(d) bg vs. g
Figure 3.16: Least Squares: Signal with noise, 10dB
tudes vector is presented in Figure (3.16c). The L1 PC amplitude vector estimation error is
δf 1 = 6.31 × 102 and the L2 PC amplitude vector estimation error is δf 2 = 2.77 × 102.
The comparison between the reconstructed signal and the original signal is presented in Fig-
ure (3.16c), with the L1 signal reconstruction error δg1 = 0.13 and the L2 signal reconstruc-
tion error δg2 = 0.12.
The results corresponding to the LS method, considering the input signal with SNR=
05dB noise is presented in Figure (3.17). The input signal, with SNR= 05dB is presented
in Figure (3.17a). The estimated PC vector via LS is presented in Figure (3.17b). The com-
parison between the estimated PC amplitudes vector via LS and the theoretical PC ampli-
tudes vector is presented in Figure (3.17c). The L1 PC amplitude vector estimation error is
δf 1 = 7.16 × 102 and the L2 PC amplitude vector estimation error is δf 2 = 3.17 × 102.
The comparison between the reconstructed signal and the original signal is presented in Fig-
ure (3.17c), with the L1 signal reconstruction error δg1 = 0.26 and the L2 signal reconstruc-
tion error δg2 = 0.25.
For all three levels of noise considered, the signal reconstruction errors are fairly accurate.
For the PC amplitudes vector estimation errors are very important. The behaviour of the LS L1
and L2 PC amplitudes vector estimation error δf 1 and δf 2 and L1 and L2 signal reconstruction
error δg1 and δg2, depending on the level of noise is presented in Figure (3.18).
An extension of the LS approach is the regularized LS. We consider, different values for
the regularization term λ and apply the RLS both on the signal without noise and with noise,
SNR= 5dB. Figure (3.19) presents the simulations corresponding to λ = 0.1, considering the
signal without noise.
The signal is well reconstructed, Figure (3.19d). L1 and L2 reconstruction errors are
0.0018 and 0.002. However, for the PC amplitudes vector estimation, both L1 and L2 errors
40

Least Squares and regularized LS
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
Noisy Signal g
(a) Signal, 05dB, g
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
-150
-100
-50
0
50
100
150
200
PC vector b
f (LS)
(b) PC via LS, bf
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
-150
-100
-50
0
50
100
150
200
L1 error = 716.2359
L2 error = 317.2939
f vs. b
f (LS)
Theoretical
Estimated - LS
(c) bf vs. f
Time(h)
0 
24
48
72
Amplitude
-4
-3
-2
-1
0
1
2
3
L1 error = 0.26451
L2 error = 0.25421
g0 vs. b
g0 (LS)
Theoretical
Estimated - LS
(d) bg vs. g
Figure 3.17: Least Squares: Signal with noise, 05dB
SNR
5 
10
15
20
25
30
40
50
Error
0
100
200
300
400
500
600
700
δ f1 and δ f2 PC Estimation Error (LS)
δ f1
δ f2
(a) δf 1 and δf 2
SNR
5 
10
15
20
25
30
40
50
Error
0
0.05
0.1
0.15
0.2
0.25
δ g1 and δ g2 Signal Estimation Error (LS)
δ g1
δ g2
(b) δg1 and δg2
Figure 3.18: Least Squares L1 and L2 errors: PC estimation errors and signal reconstruction
errors
are high, Figure (3.19c): 0.89 and 0.57.
Figure (3.20) presents the simulations corresponding to the same regularization parame-
41

CHAPTER 3. CLASSICAL METHODS
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
Original Signal g0
(a) Original signal, g0
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
-0.2
-0.1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
PC vector c
f0 (RLS) (λ =0.1)
(b) PC via RLS, λ = 0.1, c
f0
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
-0.2
0
0.2
0.4
0.6
0.8
1
L1 error = 0.89851
L2 error = 0.57804
f0 vs. c
f0 (RLS) (λ=0.1)
Theoretical
Estimated - RLS
(c) c
f0 vs. f0 (λ = 0.1)
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L1 error = 0.0018604
L2 error = 0.0020246
g0 vs. b
g0 (RLS) (λ=0.1)
Theoretical
Estimated - RLS
(d) c
g0 vs. g0 (λ = 0.1)
Figure 3.19: Regularized Least Squares, λ = 0.1: Signal without noise
ters, but considering the noisy signal, SNR= 5dB.
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
Noisy Signal g
(a) Noisy signal, 5dB, g
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
-0.4
-0.3
-0.2
-0.1
0
0.1
0.2
0.3
0.4
0.5
0.6
PC vector b
f (RLS) (λ=0.1)
(b) PC via RLS, λ = 0.1, f
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
L1 error = 1.8032
L2 error = 0.80248
f vs. b
f (RLS) (λ=0.1)
Theoretical
Estimated - RLS
(c) bf vs. f (λ = 0.1)
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L1 error = 0.2063
L2 error = 0.20528
g0 vs. b
g0 (RLS) (λ=0.1)
Theoretical
Estimated - RLS
(d) bg vs. g (λ = 0.1)
Figure 3.20: Regularized Least Squares, λ = 0.1: Signal with noise, 5dB
The signal is not well reconstructed, Figure (3.20d), L1 and L2 reconstruction errors are
0.20 and 0.20, nor the PC amplitudes vector estimation is acurate, both L1 and L2 errors are
42

L1 regularization and LASSO
high, Figure (3.20c): 1.44 and 0.64.
The behaviour of the L1 and L2 PC amplitudes vector estimation errors and signal recon-
struction are presented in Figure (3.21)
SNR
5 
10
15
20
25
30
40
50
Error
0
0.05
0.1
0.15
0.2
δ g1 and δ g2 Signal Estimation Error (RLS) (λ=0.1)
δ g1
δ g2
(a) RLS δf 1 and δf 2 PC estimation errors (λ = 0.1)
SNR
5 
10
15
20
25
30
40
50
Error
0.6
0.8
1
1.2
1.4
1.6
1.8
δ f1 and δ f2 PC Estimation Error (RLS) (λ=0.1)
δ f1
δ f2
(b) RLS δg1 and δg2 signal reconstruction errors (λ = 0.1)
Figure 3.21: Regularized Least Square L1 and L2 errors: PC estimation and signal reconstruc-
tion
Figure (3.22) presents the behaviour of the L1 (Figure (3.22a)) and L2 (Figure (3.22b))
signal reconstruction error depending on the level of noise, for different values of λ (λ =
{0.01, 0.1, 0.5, 1, 10}):
Figure (3.23) presents the behaviour of the L1 (Figure (3.23a)) and L2 (Figure (3.23b))
PC estimation error depending on the level of noise, for different values of λ (λ =
{0.01, 0.1, 0.5, 1, 10}):
3.6 L1 regularization and LASSO
In Section (3.5), we have considered the LS method, and also the quadratic regularized ver-
sion of this method. Another regularized version of LS is the Least Absolute Shrinkage and
Selection Operator (LASSO) method which uses the constraint that the L1-norm of the PC
amplitudes vector is no greater than a given value. We note that in the Bayesian approach, the
LASSO method is equivalent to the use of a zero-mean Laplace prior distribution on the PC
amplitudes vector. The optimization problem may be solved using quadratic programming
or more general convex optimization methods, as well as by speciﬁc algorithms such as the
LASSO algorithm. The L1-regularized formulation is useful in the context of a sparse PC
amplitudes vector, due to its tendency to prefer solutions with a small number of non-zero
parameter values.
43

CHAPTER 3. CLASSICAL METHODS
SNR
5 
10
15
20
25
30
40
50
Error
0
0.05
0.1
0.15
0.2
0.25
0.3
δ g1 Signal Estimation Error (RLS)
λ=0.01
λ=0.1
λ=0.5
λ=1
λ=10
(a) RLS δg1 signal reconstruction error for different values of λ
SNR
5 
10
15
20
25
30
40
50
Error
0
0.05
0.1
0.15
0.2
0.25
0.3
δ g2 Signal Estimation Error (RLS)
λ=0.01
λ=0.1
λ=0.5
λ=1
λ=10
(b) RLS δg2 signal reconstruction error for different values of λ
Figure 3.22: Regularized Least Square δg1 and δg2 signal reconstruction errors for different
values of λ
SNR
5 
10
15
20
25
30
40
50
Error
0
2
4
6
8
10
δ f1 PC Estimation Error (RLS)
λ=0.01
λ=0.1
λ=0.5
λ=1
λ=10
(a) RLS δf 1 PC estimation error for different values of λ
SNR
5 
10
15
20
25
30
40
50
Error
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
δ f2 PC Estimation Error (RLS)
λ=0.01
λ=0.1
λ=0.5
λ=1
λ=10
(b) RLS δf 2 PC estimation error for different values of λ
Figure 3.23: Regularized Least Square δf 1 and δf 2 PC estimation errors for different values
of λ
For LASSO, the solution is given by:
bf = arg min
f
J(f),
(3.9)
44

L1 regularization and LASSO
where the criterion J(f) is deﬁned as:
J(f) = ∥g −Hf∥2
2 + λ∥f∥1.
(3.10)
Figure (3.24) presents the simulations corresponding to LASSO method, considering the
signal without noise:
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
Original Signal g0
(a) Original signal g0
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
PC vector c
f0 (LASSO)
(b) PC via LASSO, c
f0
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
0
0.2
0.4
0.6
0.8
1
L1 error = 0.031363
L2 error = 0.030227
f0 vs. c
f0 (LASSO)
Theoretical
Estimated - LASSO
(c) c
f 0 vs. f 0
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L1 error = 0.029183
L2 error = 0.030502
g0 vs. b
g0 (LASSO)
Theoretical
Estimated - LASSO
(d) c
g0 vs. g0
Figure 3.24: LASSO: Signal without noise
In this case, for the signal without noise, the PC amplitudes estimation (and, consequently,
the signal reconstruction) is very accurate. Via the LASSO method, the estimation is a sparse
vector, and for all the non-zero values, the estimated amplitudes are very close to the real
ones, Figure (3.24c). The L1 error norm is 0.031 and the L2 error norm is 0.030. The com-
parison between the reconstructed signal and the original signal is presented in (3.24d). We
consider now the case when the input signal is noisy. Figure (3.25) presents the simulations
corresponding to LASSO method, but considering the noisy signal, SNR= 10dB.
We note that for a SNR= 10dB, via the LASSO method the estimation of the PC am-
plitudes vector is still accurate, Figure (3.25c). The estimation is sparse, and except the am-
plitudes corresponding to 8h and 10h, which are negligible, the periods corresponding to
non-zero amplitudes are correctly detected. The L1 error norm is 0.22 and the L2 error norm
is 0.13. We consider the case when the SNR= 5dB. Figure (3.26) presents the simulations
corresponding to LASSO method, but considering the noisy signal with SNR= 5dB.
Figure (3.26c) shows the comparison between the estimated PC amplitudes vector and the
theoretical PC amplitudes vector. The L1 error norm is 0.17 and the L2 error norm is 0.19. The
PC amplitudes vector is sparse and the periods corresponding to non-zero amplitudes are cor-
rectly detected, and the amplitudes are fairly accurate. However, LASSO method can provide
very inaccurate estimations. Figure (3.27) presents the results corresponding to a simulation
done in the same conditions as the one from Figure (3.26): a noisy signal with SNR= 5dB
45

CHAPTER 3. CLASSICAL METHODS
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
Noisy Signal g
(a) Signal, 10dB, g
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
-0.1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
PC vector b
f (LASSO)
(b) PC via LASSO, bf
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
0
0.2
0.4
0.6
0.8
1
L1 error = 0.22173
L2 error = 0.13772
f vs.
b
f (LASSO)
Theoretical
Estimated - LASSO
(c) bf vs. f
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L1 error = 0.11997
L2 error = 0.11637
g0 vs. b
g0 (LASSO)
Theoretical
Estimated - LASSO
(d) bg vs. g
Figure 3.25: LASSO: Signal with noise, 10dB
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
Noisy Signal g
(a) Signal, 5dB, g
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
PC vector b
f (LASSO)
(b) PC via LASSO, bf
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
0
0.2
0.4
0.6
0.8
1
L1 error = 0.17386
L2 error = 0.19252
f vs.
b
f (LASSO)
Theoretical
Estimated - LASSO
(c) bf vs. f
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L1 error = 0.19171
L2 error = 0.19111
g0 vs. b
g0 (LASSO)
Theoretical
Estimated - LASSO
(d) bg vs. g
Figure 3.26: LASSO: Signal with noise, 5dB - Accurate estimation
used as the input using the same LASSO method, but for a different noise realisation. How-
ever, in this case the solution is not sparse, and the estimation of the amplitude corresponding
to the 23h period is far from being accurate, Figure (3.27c). In this case, the L1 error norm is
3.07 and the L2 error norm is 1.5.
46

L1 regularization and LASSO
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
Noisy Signal g
(a) Signal, 5dB, g
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
PC vector b
f (LASSO)
(b) PC via LASSO, bf
Periods
8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32
Amplitude
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
L1 error = 3.0371
L2 error = 1.5098
f vs. b
f (LASSO)
Theoretical
Estimated - LASSO
(c) bf vs. f
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L1 error = 0.25365
L2 error = 0.25634
g0 vs. b
g0 (LASSO)
Theoretical
Estimated - LASSO
(d) bg vs. g
Figure 3.27: LASSO: Signal with noise, 5dB - Inaccurate estimation
LASSO method can provide good results for the PC amplitudes vector, even for SNR=
5dB. But in certain cases, for high signal to noise ratios, the method is not stable. Figure (3.28)
presents the variations of the LASSO L1 and L2 error norms corresponding to the PC ampli-
tudes vector estimation (Figure (3.28a)) and to the signal reconstruction (Figure (3.28b)) using
as an input a noisy signal with SNR= 10dB, for 50 different noise realisations. For the sig-
nal reconstruction, the variation is not very important, i.e. the LASSO method provides an
estimation of the PC amplitudes vector that can accurately reconstruct the signal. However,
for the estimation of the PC amplitudes vector, the variation of the error is important, and
in certain cases, the error value is high. In this experiment, we note that for the 50th noise
realisation, via the LASSO method the PC amplitudes vector error estimation is superior to
2.5 for L1 norm and superior to 1.5 for L2 norm.
The instability of the LASSO method is more obvious when considering the variability of
the L1 and L2 error norms for 50 different noise realisations with the input the noisy signal,
with SNR= 5dB, Figure (3.29) and Figure (3.30).
For the signal reconstruction, in both examples, Figure (3.29b) and Figure (3.30b) the
variation is not very important, i.e. the LASSO method provides an estimation of the PC
amplitudes vector that can accurately reconstruct the signal. For the estimations of the PC
amplitudes vector, the variation of the error is important, and in certain cases, the error value
is high. In these experiments, we note that for the 45th noise realisation in the ﬁrst experiment
(Figure (3.29b)) and for the 9th noise realisation in the second experiment (Figure (3.30b)),
via the LASSO method the PC amplitudes vector error estimation is superior to 2.5 for L1
norm for the ﬁrst experiment and superior to 7 for L1 norm for the second experiment.
The behaviour of the LASSO L1 and L2 error norms corresponding to the PC amplitudes
vector estimation and to the signal reconstruction is presented in Figure (3.31).
47

CHAPTER 3. CLASSICAL METHODS
Nr of Realisations
1 
4 
7 
10
13
16
19
22
25
28
31
34
37
40
43
46
49
Error
0
0.5
1
1.5
2
2.5
3
δ f1 and δ f2 PC Estimation Error (LASSO) (10dB)
δ f1
δ f2
(a) LASSO δf 1 and δf 2 PC estimation error stability - 10dB
Nr of Realisations
1 
4 
7 
10
13
16
19
22
25
28
31
34
37
40
43
46
49
Error
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.16
0.18
δ g1 and δ g2 Signal Estimation Error (LASSO) (10dB)
δ g1
δ g2
(b) LASSO δg1 and δg2 signal reconstruction error stability - 10dB
Figure 3.28: LASSO L1 and L2 errors stability: PC estimation and signal reconstruction -
10dB
Nr of Realisations
1 
4 
7 
10
13
16
19
22
25
28
31
34
37
40
43
46
49
Error
0
0.5
1
1.5
2
2.5
δ f1 and δ f2 PC Estimation Error (LASSO) (5dB)
δ f1
δ f2
(a) LASSO δf 1 and δf 2 PC estimation error stability - 5dB
Nr of Realisations
1 
4 
7 
10
13
16
19
22
25
28
31
34
37
40
43
46
49
Error
0.1
0.15
0.2
0.25
0.3
0.35
δ g1 and δ g2 Signal Estimation Error (LASSO) (5dB)
δ g1
δ g2
(b) LASSO δg1 and δg2 signal reconstruction error stability - 5dB
Figure 3.29: LASSO L1 and L2 errors stability: PC estimation and signal reconstruction -
5dB
3.7 Conclusion and why go to Bayesian
The classical methods presented in this chapter do not give satisfactory results. The FFT ap-
proach fails to give the one hour precision for the PC vector, and while via the zero padding
48

Conclusion and why go to Bayesian
Nr of Realisations
1 
4 
7 
10
13
16
19
22
25
28
31
34
37
40
43
46
49
Error
0
1
2
3
4
5
6
7
8 δ f1 and δ f2 PC Estimation Error (LASSO) (5dB)
δ f1
δ f2
(a) LASSO δf 1 and δf 2 PC estimation error stability - 5dB
Nr of Realisations
1 
4 
7 
10
13
16
19
22
25
28
31
34
37
40
43
46
49
Error
0.1
0.15
0.2
0.25
0.3
δ g1 and δ g2 Signal Estimation Error (LASSO) (5dB)
δ g1
δ g2
(b) LASSO δg1 and δg2 signal reconstruction error stability - 5dB
Figure 3.30: LASSO L1 and L2 errors stability: PC estimation and signal reconstruction -
5dB
SNR
5 
10
15
20
25
30
40
50
Error
0
0.05
0.1
0.15
0.2
δ f1 and δ f2 PC Estimation Error (LASSO)
δ f1
δ f2
(a) LASSO δf 1 and δf 2 PC estimation error
SNR
5 
10
15
20
25
30
40
50
Error
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.16
0.18
0.2
δ g1 and δ g2 Signal Estimation Error (LASSO)
δ g1
δ g2
(b) LASSO δg1 and δg2 signal reconstruction error
Figure 3.31: LASSO L1 and L2 errors: PC estimation and signal reconstruction
the precision can be improved, the sparse structure of the PC vector is not achieved. The
Direct and Generalized Inversion is extremely sensitive to the level of noise: the estimation
of the PC amplitudes vector is very precise in the particular case when the considered signal
49

CHAPTER 3. CLASSICAL METHODS
has no noise, but fails to correctly estimate the PC amplitudes vector when even very small
level of noise is considered, although the reconstruction of the signal is very accurate. Also
the Least Squares and the regularized LS fails to correctly estimate the PC amplitudes vector
when the input is noisy. Setting the regularization parameter is also critical. Finally while the
L1 regularization can give satisfactory results, even for high levels of noise, this approach has
two fundamental drawbacks: the stability of the solution and the determination of the regu-
larization parameter. For the choice of the regularization parameter, there are many methods.
We can mention the L−curve and the cross validation. We used the cross-validation method
proposed in the MATLAB program for optimal value of the regularization parameter, even if
this step has high computational cost. The stability of the solution is a more important draw-
back: depending on the realization of the noise, the method may not be able to ﬁnd the right
solution, as showed in Figure (3.29) (a). Final point related to all the deterministic regulariza-
tion methods is that they do not give naturally the possibility of quantifying the uncertainties.
Regardless of their drawbacks in terms of precision or the stability of the solution, the
methods presented in this chapter don’t allow the estimation of the variances associated with
the PC amplitudes vector.
A Bayesian approach allows accounting for the prior information, in our case the sparse
structure of the PC amplitude vector, by selecting a sparsity enforcing prior and also allows
the estimation of the variances associated with the PC amplitudes vector, by considering the
variances in our model as unknowns.
50

4
Linear Model, Inverse Problem and
Bayesian approach with sparsity enforcing
prior
Contents
4.1
Forward model and inverse problem approach . . . . . . . . . . . . . .
52
4.2
General Bayesian inference . . . . . . . . . . . . . . . . . . . . . . . . .
55
4.3
Sparsity enforcing priors . . . . . . . . . . . . . . . . . . . . . . . . . .
56
4.4
Generalized Student-t hierarchical model . . . . . . . . . . . . . . . . .
58
4.4.1
Generalized Student-t hierarchical prior model
. . . . . . . . . . .
58
4.4.2
Joint MAP Estimation
. . . . . . . . . . . . . . . . . . . . . . . .
63
4.4.3
Posterior Mean (via VBA, partial separability)
. . . . . . . . . . .
65
4.4.4
Prior Inverse Gamma parameters setting for vf j . . . . . . . . . . .
72
4.4.5
Prior Inverse Gamma parameters setting for vǫi . . . . . . . . . . .
75
4.4.6
Posterior Mean (via VBA, full separability) . . . . . . . . . . . . .
77
T
HIS chapter is dedicated to the detailed presentation of the proposed method and the re-
sulting algorithms. First, we present the proposed linear (sinusoidal) model. Other ap-
proaches for modelling this problem are mentioned and discussed. Then, the general Bayesian
inference is discussed. After that, we give a detailed presentation of the hierarchical model
that is build: the probability density functions considered for the likelihood, for the priors and
for the hyperparameter priors. The unknowns of the model are estimated from the posterior
distribution derived from the hierarchical model, via the Bayes rule, considering Joint Max-
imum A Posterior and Posterior Mean. For each estimator the computational methods are
presented in detail, along with their corresponding algorithm.
51

CHAPTER 4. LINEAR MODEL, INVERSE PROBLEM AND BAYESIAN
APPROACH WITH SPARSITY ENFORCING PRIOR
4.1 Forward model and inverse problem approach
The proposed method for improving the precision in PC vector estimation consists, in the ﬁrst
step, in formulating the problem as a linear forward model. This can be done starting from the
inverse Fourier transform, which establishes a linear relation between the known signal g(t)
and its PC amplitudes vector. Evidently, in this case, the PC amplitudes vector is the one that
is set by default by the FFT method. Considering a matrix that is built in the same way as the
one corresponding to the inverse Fourier transform, but using the elements that corresponds
to the imposed PC vector, the linear relation between a chronobiological time series and the
corresponding PC vector can be described by the following equation:
g(ti) ≃
M
X
j=1
f1(pj) sin(2π ti
pj
) +
M
X
j=1
f 2(pj) cos(2π ti
pj
), i ∈{1, . . . , N} , j ∈{1, . . . , M}
(4.1)
In Equation (4.1), the following notations are used:
• ti, i ∈{1, 2, . . ., N} represents the sampling points of the observed signal; in partic-
ular, both for synthetic and real data simulations, we have considered the observed
signal sampled every hour. During the real data simulations we had to consider differ-
ent lengths, depending on the segment that was studied, i.e. 2 days length signals for
the segments corresponding to the after treatment segment (N = 48), 3 days length
signals for the segments corresponding to the before treatment (N = 72), 5 days length
signals for the segments corresponding to the during treatment (N = 120). For the seg-
ments that allowed the study of the stability or variability of the PC amplitudes vector,
the length of the windows was 4 days. In particular, for the synthetic simulations, the
length of the observed signals was considered also 4 days (N = 96).
• g(ti) represents the amplitudes of the observed signal, corresponding to the sampling
point ti
• pj, j ∈{1, 2, . . ., M} represents the periods contained by the PC vector; during the
simulations, we consider a precision of one hour, in the circadian domain, between 19h
and 32h. In order to analyse the behaviour of the potential harmonics corresponding to
the periodic components inside the circadian domain, we will also include the periodic
components superior to 7h. So, the PC vector considered in the simulations will be
[8h, 9h, . . ., 32h], M = 25.
• f 1(pj) and f 2(pj) represents the amplitudes of PC vectors, corresponding to the period
pj.
Introducing the notations:
g(ti) = gi,
i ∈{1, ..., N} ; f k(pj) = fkj,
k ∈{1, 2} ,
j ∈{1, ..., M} ,
(4.2)
equation (4.1) becomes:
gi ≃
M
X
j=1
f 1j sin(2π ti
pj
) +
M
X
j=1
f 2j cos(2π ti
pj
) −→g ≃H1f 1 + H2f 2
(4.3)
52

Forward model and inverse problem approach
The potential modelling and measurement errors should be accounted. This is critical in
our model, since the chronobiological signals are noisy. We want to be able to distinguish
between the periodic components corresponding to the biological phenomena and the period
components that are due to the noise and uncertainties. The linear model (4.3) is completed
by introducing the error vector ǫ, leading to the forward linear model:
g = H1f 1 + H2f 2 + ǫ
(4.4)
where the following notations are used:
• g represents the observed data i.e.
the chronobiological time series:
g
=
h
g1, g2 . . . gN
iT ∈MN×1 , a N-dimensional vector, where the notation g(ti) = gi
introduced in (4.2) is used;
• H1 and H2 represent the sine and cosine matrices, [H1]ij = (sin(2π ti
pj ))ij, [H2]ij =
(cos(2π ti
pj ))ij ∈MN×M corresponding to the considered period component vector
h
p1, p2, . . . , pM
iT;
• f 1 and f 2 represent the unknowns of the forward linear model (4.4), i.e. the peri-
odic components vector amplitudes, corresponding to the sine matrix H1 and cosine
matrix H2: f 1
=
h
f11, f 12, . . . , f 1M
iT , f 2
=
h
f 21, f 22, . . . , f 2M
iT, ∈MM×1,
M-dimensional vectors, where the notations f 1(pj) = f 1j and f 2(pj) = f2j introduced
in (4.2) are used;
• ǫ represents the errors: ǫ =
h
ǫ1, ǫ2, . . . , ǫN
iT ∈MN×1, is a N-dimensional vector;
together with the two PC vectors amplitudes, f 1 and f 2 the error vector ǫ represents
the unknowns of the model (4.4).
The main goal is to estimate the unknowns of the linear model (4.4), i.e.
the PC
amplitude vectors
c
f 1 and
c
f 2 and the error vector bǫ.
In our approach, the strat-
egy used is based on general Bayesian inference:
building a hierarchical model, by
assigning probability density functions for the likelihood, for the priors, and in or-
der to estimate the hyperparameters that appear in the hierarchical model (namely the
variances associated with the unknowns of the linear model (4.4), i.e.
c
f 1,
c
f 2 and
bǫ) for the hyperparameters priors and then estimating the unknowns from the poste-
rior probability density function, obtained via Bayes rule, using the available data g:
g
✲
Inversion
✲c
f 1,
c
f 2
✲
H1, H2
✲bg
Once an inversion method is considered and the corresponding estimations are obtained, the
estimation accuracy can be veriﬁed by comparing the estimates c
f 1 and c
f 2 with f 1 and f 2.
Evidently, such a comparison is possible just in the synthetic case. From the estimates c
f 1 and
c
f 2, via the linear model (4.4) the reconstructed signal bg = H1 c
f 1 + H2 c
f 2 is computed and
then compared with the available g. This comparison is possible in both the synthetic simula-
tions and the real simulations case. The comparison can be done computing the Normalized
Mean Squared Error (NMSE, p = 2) or Normalized Mean Absolute Error (NMAE, p = 1)
via the following relations:
δpf = ∥f −bf∥p
p
∥f∥p
p
; δpg = ∥g −bg∥p
p
∥g∥p
p
, p = 1, 2.
(4.5)
53

CHAPTER 4. LINEAR MODEL, INVERSE PROBLEM AND BAYESIAN
APPROACH WITH SPARSITY ENFORCING PRIOR
Remark on the linear model
The linear model considered in Equation (4.4) can be expressed in a different form. Introduc-
ing the notations
H = [H1, H2] ; f =
"
f 1
f 2
#
(4.6)
the linear model can be expressed by the following equation:
g = Hf + ǫ
(4.7)
In particular, Equation (4.7) is expressing an forward model that corresponds to many
other application such as signal deconvolution, image restoration, Computed Tomography
(CT) image reconstruction, Fourier Synthesis (FS) inversion, microwave imaging [NMD94]
and [FDMD07], ultrasound echography, seismic imaging, radio astronomy [KTB04] ﬂuores-
cence imaging, inverse scattering [CMD97], [FDMD05], [AMD10] and [GHBMD13], Eddy
current non destructive testing [NMD96] or SAR imaging [AKZ06]. In all these examples,
including the PC amplitude vector estimation, the common inverse problem is to estimate f
from the observations of g. In general, the inverse problems are ill-posed [Had01], since the
conditioning number of the matrix H is very high. This means that, in practice, the data g
alone is not sufﬁcient to deﬁne an unique and satisfactory solution.
One particular case of the linear model, Equation (4.7) is when the error vector is neglected
(ǫ = 0). For this particular case, the linear model is given by the equation
g = Hf.
(4.8)
If the matrix H was invertible and orthogonal, i.e. HTH = I (this is the case of the Fast
Fourier Transform for the particular case when M = N), the solution is given by
bf = HTg.
(4.9)
If the matrix is just invertible but not orthogonal we could write
bf = H−1g.
(4.10)
If the matrix is not invertible we can still deﬁne generalized inverse or pseudo-inverse solu-
tions. The Minimum Norm Solution (MNS) and the Least Square Solution (LSS) are two
examples:
MNS : bf MN =

HHT −1 HTg, M < N
(4.11)
LSS : bf LS = HT 
HHT −1 g, M > N
(4.12)
However, neither solutions Equation (4.10), Equation (4.11) and Equation (4.12) are helpful
in practice, since they don’t account for the noise. These inverse solutions are in general too
sensitive to the errors due to the ill-conditioning of the matrix H in Equation (4.10), HTH
in Equation (4.11) and HHT in Equation (4.12).
Among the techniques that have been successfully used for solving Equation (4.7) are
regularization theory and the Bayesian inversion. Quadratic and Tikhonov regularization
54

General Bayesian inference
is developed in [DR85], [Hol92], [PL99] and [YLZF12].
Total Variation (TV) is devel-
oped in [CW98], [ZL11] and [YFZ12], different entropy based regularization are devel-
oped in [Wig77], [Dee81], [Don81] and [MDD88], Lp and sparsity enforcing in [YBW85]
and [WHmPw08], blind deconvolution and applications in [NPQ00], [JSM+02], [Fio04]
and [MSSM11]. Cross Validation (CV) and generalized CV methods for determining the
regularization parameter are developed in [Wah82] and [LN11], Bernouilli-Gaussian mod-
els in [GDI90] and [CGI96], the Compress Sensing (CS) approach in [RMW12], document
image restoration in [PB13] and [LB13], joint restoration and segmentation in [AMD09].
Considering the model (4.4) or equivalent
(4.7) we focus on an inversion based
on General Bayesian Inference, building an hierarchical model, based on the general-
ized Student-t prior distribution modelling the PC amplitude vectors in order to enforce
the sparsity.
Accounting for sparsity has been considered in many ways.
One way is
via regularization techniques, by using L0 or L1 norms.
This approach was developed
in [DDM04], [Tro06], [TGS06], [CWB08] and [PS10]. One of these methods which has
become now the standard is LASSO [Tip01]. Therefore, during the simulations chapter,
we will consider LASSO for comparisons with the proposed algorithm.
One other way
is via Bayesian inference using strict sparsity or sparsity enforcing priors. For the strict
sparsity requirement, very often Bernouilli distribution is used. For example, Bernouilli-
Gaussian [GDI90], [CGI96] and [GILC08], Bernouilli-Laplace [DB08] or Bernouilli-Gamma,
while for the sparsity enforcing, mainly three categories of priors have been considered and
used very often: Generalized Gaussian (GG), Mixture models and heavy tailed probability
laws such as Student-t. A review of these priors is discussed in [Tip01] and [MD12] and their
references.
Furthermore, the hierarchical model developed in this chapter will account for the non sta-
tionarity of the noise. For this, in literature zero mean Gaussian model with unknown varying
variance has been considered in [CGHM14] and a Cauchy-Gaussian model in [CKS15]. Like
the prior distribution modelling the PC amplitude vectors, the Student-t distribution is used
for modelling the non-stationarity.
4.2 General Bayesian inference
In Section (4.1) we have described the strategy adopted for doing the inversion in Equa-
tion (4.4) or equivalent (4.7): building an hierarchical model enforcing the sparsity for the
PC amplitudes vectors and talking into account the non stationarity of the noise, based on
general Bayesian inference. Considering the linear inverse problem of Equation (4.7), the
Bayesian inference starts by the fundamental relation given by the Bayes rule:
p(f|g, θ1, θ2) = p(g|f, θ1) p(f|θ2)
p(g|θ1, θ2)
, θ = (θ1, θ2)
(4.13)
where θ represents the hyperparameters that appear in the model, namely the variances as-
sociated with the unknowns of our model, i.e the PC amplitudes vector and the noise vector
ǫ.
The Bayes rule can be interpreted as a proportionality relation between the posterior law
and the product of the prior law (the sparsity information) and the likelihood:
p(f|g, θ1, θ2) ∝p(g|f, θ1) p(f|θ2)
(4.14)
55

CHAPTER 4. LINEAR MODEL, INVERSE PROBLEM AND BAYESIAN
APPROACH WITH SPARSITY ENFORCING PRIOR
The probabilistic model that assigns particular distributions for the prior and likelihood laws
represents the hierarchical model. An extension of Equation (4.14) is the general Bayesian
Inference, where the hyperparameters involved in the Bayes Rule, θ = (θ1, θ2) are considered
unknowns and are also estimated from the posterior law:
p(f, θ1, θ2|g) ∝p(g|f, θ1) p(f|θ2) p(θ1) p(θ2)
(4.15)
4.3 Sparsity enforcing priors
In the Bayesian framework, distributions must be assigned for the likelihood (derived from
the prior distribution assigned for modelling the errors of the forward model), for the prior
(in our case one that allows enforcing the sparsity) and also for the hyperparameters of the
model (i.e. the variances associated with the PC amplitudes vector and with the errors). In
literature, [Tip01] and [MD12] and their references certain classes of distribution (heavy-
tailed, mixture models) are well known as good sparsity enforcing priors. The overview is
presented in the following scheme:
56

Sparsity enforcing priors
Hierarchical
Model
Likelihood
Law
Gaussian
Hyperparameters
Law
Conjugate
Priors
Inverse
Gamma
Prior Law
Gen.
Gaus-
sian
G
L
Symmetric
Weibull
SR
DE
Student-
t
C
Elastic
Net
Gen.
Hyper-
bolic
Dirichlet
SD
Mixture
of
Gaus-
sians
MoG2
BG
MoG3 MoGG
Prior models that can be considered are: a) Generalized Gaussian (GG) with Gaussian (G)
and Laplace; b) Weibull (W) with Symmetric Rayleigh (SR) or Double Exponential (DE) as
particular cases; c) Student-t (St) with Cauchy (C) as particular case; d) Elastic net; e) Gener-
alized Hyperbolic model; f) Dirichlet and with Symmetric Dirichlet (SD) as particular case; g)
Mixture of Gaussians, with (i) Mixture of two centred Gaussians (MoG2), one with very small
and one with a large variance, with Bernoulli-Gauss (BG) (also called Spike and slab) as a
particular case, (ii) Mixture of three Gaussians (MoG3), one centred with very small variance
and two symmetrically centred on positive and negative axes and large variances; (iii) Mix-
ture of one Gaussian and one or two Gammas (MoG-Gammas), and h) Bernoulli-Multinomial
(BMult) or mixture of Dirichlet (MoD).
Mainly, the prior models are classiﬁed in three categories: Generalized Gaussian, heavy
tailed distributions and Mixture Models, which result to hierarchical models.
57

4.4.1 - Generalized Student-t hierarchical prior model
4.4 Generalized Student-t hierarchical model
This section presents the assignment of the probability laws corresponding to the likelihood,
the prior and the prior corresponding to the hyperparameters, i.e. the variances associated
with the PC amplitude vectors and the error vector. The goal is to build a hierarchical model
that accounts for the prior informations, i.e. the sparsity of the PC amplitude vectors and
the non-stationary noise. To account for both of these two prior informations, we model
the noise ǫ as a zero mean non stationary Gaussian with unknown variances on which we
assign Inverse Gamma priors, and to enforce the sparsity, we use the generalized Student-
t distribution as the prior modelling the PC amplitude vectors f 1 and f 2, expressed as the
marginal of the bivariate Normal - Inverse Gamma distribution. The main advantage of the
Student-t distribution is that, thanks to its Inﬁnite Gaussian Scaled Mixture (IGSM) prop-
erty, it can be used in a hierarchical Gaussian - Gamma or Gaussian - Inverse Gamma model.
In this way, in fact both for the non stationarity of the noise and for sparsity enforcing we
have the same prior model structure: Gaussian with unknown variances on which we as-
sign Inverse Gamma priors. The Bayesian framework with different priors both on the noise
and on the solution is a very well known approach in the literature, and it goes back to
1950, using the Normal distribution [HW83] or the Poisson distribution [MSC99] for the
noise and the Normal distribution for the solution. More speciﬁc priors and in particular the
Markovian model [GG84] and [IG90], non Gaussian priors [NMD94], the hierarchical mod-
els [GLRI93] are more recent. The main difﬁculties in those methods have been more on
the computational aspects. Beside the classical Gaussian approximation [RMC09] and the
MCMC methods [GRS96],[DDJ09],[GILC08], we may mention the more recent ones: the
Approximate Bayesian Computation (ABC) [BCMR09],[Blu10],[BF10],[MPRR11], Varia-
tional Bayesian Approximation (VBA) [KMS+12b],[KMS+12a] and Message Passing (MP)
[Bea03],[WBJ05],[PCS11],[SR12] methods.
In general, a hierarchical model represents the set of probability laws assigned for the
probabilities involved in (4.15), namely the assignment of the likelihood p(g|f, θ1), the prior
p(f|θ2) and the hyperparameters priors p(θ1) and p(θ2). The equations corresponding to
each probability density function assigned in the model are presented and discussed in detail
in Subsection (4.4.1). The unknowns of the hierarchical prior model are estimated from the
expression of the posterior distribution, via the Bayes rule, Equation (4.15) using two different
estimation techniques: Joint Maximum A Posteriori (JMAP) and PM (Posterior Mean), via
Variational Bayesian Approximation (VBA). The computations corresponding to those esti-
mations and the resulting algorithm are detailed in Subsection (4.4.2) and Subsection (4.4.3).
4.4.1
Generalized Student-t hierarchical prior model
In the ﬁrst step, the error vector ǫ of the linear model (4.4) is modelled. We propose to use a
non-stationary Gaussian model for the conditional probability p(ǫi|vǫi), i.e. every point in the
error vector conditioned by the corresponding variance, ǫi|vǫi is considered as a zero mean
normal distribution with the corresponding variance:
p(ǫi|vǫi) = N (ǫi|0, vǫi), i ∈{1, 2, . . ., N} ,
(4.16)
58

Generalized Student-t hierarchical model
where the corresponding variances vǫi are considered to be unknowns. For having the possi-
bility to estimate them we model them as Inverse Gamma distributions:
p(vǫi|αǫ0, βǫ0) = IG(vǫi|αǫ0, βǫ0), i ∈{1, 2, . . ., N} ,
(4.17)
where αǫ0 and βǫ0 represent the shape and scale parameters corresponding to the Inverse
Gamma distribution associated with the corresponding variance of every point in the error
vector, vǫi, i ∈{1, 2, . . ., N}. Doing this, the joint probability of the error vector points and
their corresponding variances (ǫi, vǫi), i ∈{1, 2, . . ., N} are modelled as a bivariate Normal -
Inverse Gamma distribution:
p(ǫi, vǫi|αǫ0, βǫ0) = N (ǫi|0, vǫi)IG(vǫi|αǫ0, βǫ0) , i ∈{1, 2, . . ., N} ,
(4.18)
and the probability of each error vector point ǫi is modelled by its marginal, i.e. a generalized
Student-t distribution:
p(ǫi|αǫ0, βǫ0) =
Z
N (ǫi|0, vǫi)IG(vǫi|αǫ0, βǫ0) dvǫi , i ∈{1, 2, . . ., N} ,
(4.19)
More general, the equations introduced in (4.16) and (4.17), can be used to write:
(
p(ǫ|vǫ) = N (ǫ|0, V ǫ)
p(vǫ|αǫ0, βǫ0) = QN
i=1 IG(vǫi|αǫ0, βǫ0)
(4.20)
where we introduced the variance error vector vǫ and the corresponding diagonal matrix V ǫ:
vǫ =
h
vǫ1 . . . vǫi . . . vǫN
iT
; V ǫ = diag [vǫ]
(4.21)
The likelihood p(g|f, vǫ) is obtained considering the linear model, Equation (4.4) and the
assigned distribution for the error vector ǫ conditioned by the variance vǫ, p(ǫ|vǫ), Equa-
tion (4.20). The distribution modelling the likelihood is also a multivariate Normal distribu-
tion, having the same covariance matrix V ǫ and the mean H1f 1 + H2f 2, derived from the
linear model Equation (4.4):
p(g|f 1, f 2, vǫ) = N (g|H1f 1 + H2f 2, V ǫ)
(4.22)
The likelihood and the prior distribution corresponding to the noise variance vǫ represents the
ﬁrst part of the hierarchical model:



p(g|f 1, f 2, vǫ) = N (g|H1f 1 + H2f 2, V ǫ)
p(vǫ|αǫ0, βǫ0) =
QN
i=1 IG(vǫi|αǫi0, βǫi0)
(4.23)
The proposed prior distribution is a generalized Student-t distribution Stg, in order to en-
force the sparsity, obtained via a Normal - Inverse Gamma distribution. A generalization of
the Student-t distribution is obtained from the Normal - Inverse Gamma distribution by not
introducing any supplementary conditions for the shape and scale parameters corresponding
to the Inverse Gamma. This generalization is discussed in detail in Subsection (4.4.4). The
probability density function of the standard Student-t distribution is given in Equation (4.24):
St(x|ν) =
Γ

ν+1
2

√νπΓ

ν
2

 
1 + x2
ν
!−ν+1
2
(4.24)
59

4.4.1 - Generalized Student-t hierarchical prior model
−6
−4
−2
0
2
4
6
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
Standard Normal Distribution
 
 
G ( x | 0, 1 )
−6
−4
−2
0
2
4
6
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
Student−t Distribution
 
 
St−t ( x | 1 )
Figure 4.1: Normal and Student-t distribution
The Student-t distribution with one degree of freedom (ν = 1) (Cauchy distribution) and
the standard Normal distribution are presented in Figure (4.1). The Student-t distribution is
a good sparsity enforcing prior due to the heavy tailed structure: the tail of the distribution
is above the tail of the Normal distribution, allowing certain cases of high values i.e. the
non zero values in the periodic component vector amplitudes, corresponding to the biolog-
ical periods expressed in the chronobiological signal. A comparison between the standard
Normal distribution and the Student-t distribution (ν = 1) is presented in Figure (4.2). A
−6
−4
−2
0
2
4
6
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
Normal vs Student−t Distribution
 
 
G ( x | 0, 1 )
St−t ( x | 1 )
Figure 4.2: Normal vs. Student-t distribution
direct assignment of Student-t distributions for the prior laws p(f 1) and p(f 2) leads to a non-
quadratic criterion when estimating f 1, f 2. The Student-t distributions corresponding to the
prior distributions modelling the PC amplitudes vectors f 1 and f 2 can be assigned via Nor-
mal - Inverse Gamma, jointly modelling the periodic component vectors amplitudes and their
corresponding variances. For the variances of f 1 and f 2 we assume general models. Also,
the considered model will assign the same variances for f 1 and f 2, linking the two periodic
component vectors:
vf =
h
vf1 . . . vfj . . . vfM
iT ; V f = diag [vf]
(4.25)
Therefore, for sparsity enforcing for the PC amplitudes vectors, the joint distributions corre-
sponding to the PC amplitudes vectors elements and their corresponding variances are mod-
elled via the bivariate Normal - Inverse Gamma distribution, imposing equal values for the
shape and scale parameter of the Inverse Gamma distribution, αf0 = βf0 = νf
2 :

fkj, vfj

∼N (fkj|0, vfj) IG(vfj|νf
2 , νf
2 ), k ∈{1, 2} , j ∈{1, 2, . . ., M}
(4.26)
60

Generalized Student-t hierarchical model
Doing so, the marginal of the joint distribution, modelling the PC amplitudes vectors elements
is a Student-t distribution, Equation (4.24):
p(f kj|νf) =
Z
N (fkj|0, vfj) IG(vfj|νf
2 , νf
2 ) dvfj = St(f kj|νf)
(4.27)
This approach can be extended by considering a Normal - Inverse Gamma distribution for the
joint distribution

fkj, vfj

, without imposing the equality αf0 = βf0 = νf
2 in the expression
of the Inverse Gamma distribution. Considering αfj0, βfj0 as the parameters of the Inverse
Gamma distribution in the Normal - Inverse Gamma, the joint probability of

f kj, vfj

is
modelled as:

f kj, vfj

∼N (fkj|0, vfj) IG(vfj|αf0, βf0), k ∈{1, 2} , j ∈{1, 2, . . ., M}
(4.28)
The marginal modelling the elements of the PC amplitudes vectors is:
p(f kj|αf0, βf0) =
Γ(αf0 + 1
2)
q
2βf0π Γ(αf0)
 
1 + f kj2
2βf0
!−(αf0+ 1
2)
= Stg(f kj|αfj0, βfj0)
(4.29)
The Normal - Inverse Gamma distribution, modelling

f kj, vfj

and the marginal modelling
fkj are presented in Figure (A.1). The two parameters αf0, βf0 introduced for deﬁning the
−0.5
−0.4
−0.3
−0.2
−0.1
0
0.1
0.2
0.3
0.4
0.5
0
2
4
6
8
10
12
14
16
18
Marginal IGSM distribution
 
 
p(fj|αj,βj) ~ marg IGSM(fj|αj,βj)
Figure 4.3: Normal - Inverse Gamma distribution

fkj, vfj

and the corresponding marginal
fkj|αf0, βf0
Normal - Inverse Gamma joint distribution are directly modelling the variances vf j via the In-
verse Gamma prior distribution IG(vfj|αf0, βf0) and also modelling fkj via equation (A.25).
In order to enforce the sparsity, the two parameters must be chosen such that the Normal
61

4.4.1 - Generalized Student-t hierarchical prior model
- Inverse Gamma marginal is a heavy tailed distribution and such that the behaviour of the
variance is in accordance with the sparse structure of the f kj.
In fact, in such an approach, the mechanism of sparsity is based not only on the heavy
tailed property of the prior distribution, but also on a particular behaviour of the vari-
ances. In such an approach a bivariate prior is set for the unknown of the model that needs
to be estimated (the PC amplitudes vectors in our case) and for the corresponding vari-
ance.
The algorithm that results is an iterative one, updating at every iteration both the
unknowns of the model (PC amplitudes vectors f 1 and f 2) and the corresponding vari-
ance.
In order to obtain a sparse solution for the unknowns, the structure of the vari-
ance must be sparse itself.
In particular the variances associated with the zero or close
to zero points from the unknown of the model must be small, and the variances associ-
ated with the non-zero elements of the sparse unknowns of the model must be signiﬁcant.
generalized Student-t
❄
f 1 and f 2 sparse
✲
✛
vf sparse
✻
Inverse Gamma
Therefore, the shape and scale parameters of the Inverse Gamma distribution must be chosen
such that the variance vector vf is sparse, i.e. the expected value of the elements vfj is close
to zero, EIG
h
vfj
i
ց 0. Furthermore, in a Bayesian approach, we may have a prior knowledge
for the numerical value associated with the variance of the Inverse Gamma modelling vfj, i.e.
VarIG
h
vf j
i
= w, where w is the numerical value obtained via prior knowledge. Evidently, de-
pending on the shape and scale parameters corresponding to the Inverse Gamma distribution,
the behaviour of the marginal corresponding to the Normal - Inverse Gamma bivariate distri-
bution, i.e. the generalized Student-t distribution, Equation (A.25) is different. Figure (4.4)
presents a comparison between the standard Normal distribution and the generalized Student-t
distribution for different values of the two parameters. We note that in order to select a prior
model that enforces sparsity, the two parameters αfj0 and βfj0 must be chosen such that the
generalized Student-t distribution modelling the PC amplitudes vectors is concentrated around
zero, i.e. it’s variance is very small, VarStg [f kj] ց 0.
For modelling the priors corresponding to f kj, k ∈{1, 2}, j ∈{1, 2, . . . , M} as in (A.25),
we assign Normal - Inverse Gamma distributions for the joint priors (f 1j, vf j) and (f 2j, vfj).
Therefore, f 1j|vfj and f 2j|vfj are modelled as zero mean Normal distributions, and the vari-
ances vfj are modelled as Inverse Gamma distributions, for j ∈{1, 2, . . ., M}. In this way,
the vector f 1 conditioned by the variance vector vf is modelled by a zero mean multivari-
ate Normal distribution, with the covariance matrix deﬁned in (4.25), the variance vector vf
is modelled as a product of Inverse Gamma distributions and the vector f 2 conditioned by
the variance vector vf is modelled by a zero mean multivariate Normal distribution, with the
covariance matrix deﬁned in (4.25):









p(f 1|vf) = N (f 1|0, V f)
p(f 2|vf) = N (f 2|0, V f)
p(vf|αf0, βf0) =
QM
j=1 IG(vfj|αf0, βf0)
(4.30)
62

Generalized Student-t hierarchical model
-6
-4
-2
0
2
4
6
0
0.2
0.4
0.6
0.8
1
1.2
Normal vs IGSM Marginal Distribution
IGSM ( x | 0.5 0.5 )
IGSM ( x | 0.4 0.6 )
IGSM ( x | 0.3 0.7 )
IGSM ( x | 0.2 0.8 )
IGSM ( x | 0.1 0.9 )
IGSM ( x | 0.6 0.4 )
IGSM ( x | 0.7 0.3 )
IGSM ( x | 0.8 0.2 )
IGSM ( x | 0.9 0.1 )
G ( x | 0, 1 )
-6
-5.5
-5
-4.5
-4
-3.5
-3
-2.5
-2
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
Normal vs IGSM Marginal Distribution
IGSM ( x | 0.5 0.5 )
IGSM ( x | 0.4 0.6 )
IGSM ( x | 0.3 0.7 )
IGSM ( x | 0.2 0.8 )
IGSM ( x | 0.1 0.9 )
IGSM ( x | 0.6 0.4 )
IGSM ( x | 0.7 0.3 )
IGSM ( x | 0.8 0.2 )
IGSM ( x | 0.9 0.1 )
G ( x | 0, 1 )
Figure 4.4: Normal vs. Normal - Inverse Gamma marginal distributions
The likelihood and the error variance prior (4.23) and the prior (4.30) represents the IGSM Hi-
erarchical Model. The analytical form of the Hierarchical Model written via proportionalities
is the following:





































p(g|f 1, f 2, vǫ) ∝|V ǫ|−1
2 exp
n
−1
2∥V ǫ−1
2 (g −H1f 1 −H2f 2) ∥2o
p(vǫ|αǫ0, βǫ0) ∝QN
i=1
βǫ0αǫ0
Γ(αǫ0) vǫi
−(αǫ0+1) exp
n
−βǫ0v−1
ǫi
o
p(f 1|vf) ∝|V f|−1
2 exp

−1
2∥V
−1
2
f f 1∥2

p(f 2|vf) ∝|V f|−1
2 exp

−1
2∥V
−1
2
f f 2∥2

p(vf|αf0, βf0) ∝QM
j=1
βf0
αf0
Γ(αf0) vf j
−(αf0+1) exp
n
−βf0v−1
fj
o
(4.31)
From the Hierarchical Model the posterior distribution can be obtained via the proportionality
relation considered in (4.15):
p(f 1, f 2, vǫ, vf|g) ∝p(g|f 1, f 2, vǫ) p(vǫ|αǫ0, βǫ0) p(f 1|vf) p(f 2|vf) p(vf|αf0, βf0)
(4.32)
4.4.2
Joint MAP Estimation
This section presents the results obtained by the estimation of the unknowns from the posterior
distribution, Equation (4.32), via Joint Maximum A Posteriori (JMAP), a point estimator of
63

4.4.2 - Joint MAP Estimation
the unobserved quantities f 1, f 2, vǫ, vf on the basis of the available data g. JMAP estimator
is deﬁned as:
c
f 1, c
f 2, c
vǫ, c
vf

=
arg max
(f 1,f 2, vǫ, vf)
p(f 1, f 2, vǫ, vf|g) =
arg min
(f 1,f 2, vǫ, vf)
L(f 1, f 2, vǫ, vf),
(4.33)
where for the second equality the criterion L(f 1, f 2, vǫ, vf) is deﬁned as:
L(f 1, f 2, vǫ, vf) = −ln p(f 1, f 2, vǫ, vf|g)
(4.34)
The MAP estimator is the solution minimizing the criterion L(f 1, f 2, vǫ, vf). One of the
simplest optimisation algorithm that we can use is an alternate optimization with respect to
the each unknown:
• With respect to f 1:
∂L(f 1, f 2, vǫ, vf)
∂f 1
= 0 ⇔
∂
∂f 1

∥V ǫ
−1
2 (g −H1f 1 −H2f 2) ∥2 + ∥V f
−1
2f 1∥2
= 0
⇔−HT
1 V ǫ
−1 (g −H1f 1 −H2f 2) + V f
−1f 1 = 0
⇔
h
HT
1 V ǫ
−1H1 + V f
−1i
f 1 = HT
1 V ǫ
−1 (g −H2f 2)
⇒c
f 1 =
h
HT
1 V ǫ
−1H1 + V f
−1i−1 HT
1 V ǫ
−1 (g −H2f 2)
• With respect to f 2:
∂L(f 1, f 2, vǫ, vf)
∂f 2
= 0 ⇔
∂
∂f 2

∥V ǫ
−1
2 (g −H1f 1 −H2f 2) ∥2 + ∥V f
−1
2f 2∥2
= 0
⇔−HT
2 V ǫ
−1 (g −H1f 1 −H2f 2) + V f
−1f 2 = 0
⇔
h
HT
2 V ǫ
−1H2 + V f
−1i
f 2 = HT
2 V ǫ
−1 (g −H1f 1)
⇒c
f 2 =
h
HT
2 V ǫ
−1H2 + V f
−1i−1 HT
2 V ǫ
−1 (g −H1f 1)
• With respect to vǫi, i ∈{1, 2, . . ., N}:
∂L(f 1, f 2, vǫ, vf)
∂vǫi
= 0 ⇔
∂
∂vǫi

αǫi0 + 3
2

ln vǫi+
+

βǫi0 + 1
2 (gi −H2if 1 −H2if 2)2

v−1
ǫi

= 0
⇔

αǫi0 + 3
2

vǫi −

βǫi0 + 1
2 (gi −H2if 1 −H2if 2)2

= 0
⇒c
vǫi = βǫi0 + 1
2 (gi −H2if 1 −H2if 2)2
αǫi0 + 3
2
64

Generalized Student-t hierarchical model
• With respect to vf, j ∈{1, 2, . . ., M}:
∂L(f 1, f 2, vǫ, vf)
∂vfj
= 0 ⇔
∂
∂vfj

[αf0 + 2] ln vfj +

βf0 + 1
2

f 2
1j + f 2
2j

v−1
fj

= 0
⇔(αf0 + 2) vfj −

βf0 + 1
2

f2
1j + f 2
2j

= 0
⇒d
vfj =
βf0 + 1
2

f 2
1j + f 2
2j

αf0 + 2
The scheme of the iterative algorithm obtained via JMAP estimation is presented Figure (4.5):
c
f 1 =
h
HT
1 V ǫ−1H1 + V f −1i−1 HT
1 V ǫ−1 (g −H2f 2)
(a) - update PC amplitudes vector f 1
c
f 2 =
h
HT
2 V ǫ−1H2 + V f −1i−1 HT
2 V ǫ−1 (g −H1f 1)
(b) - update PC amplitudes vector f 2
d
vǫi =
βǫi0+1
2(gi−H2if 1−H2if 2)
2
αǫi0+3
2
(c) - update noise variances vǫi
d
vfj =
βf0+1
2(f2
1j+f2
2j)
αf0+2
(d) - update PC variances vfj
V ǫ = diag [ c
vǫ]
(e)
V f = diag
h
d
vf
i
(f)
Figure 4.5: Updating scheme: JMAP estimation for generalized Student-t prior model
This algorithm is compared to the algorithm corresponding to Posterior Mean estimation
in the simulations section.
4.4.3
Posterior Mean (via VBA, partial separability)
The JMAP computes the mod of the posterior distribution. The Posterior Mean computes the
mean of the posterior distribution. One of the advantages of this estimator is that it minimizes
65

4.4.3 - Posterior Mean (via VBA, partial separability)
the Mean Square Error (MSE). Computing the posterior means of any unknown needs great
dimensional integration. For example,
Ep {f 1} =
ZZZZ
f 1 p(f 1, f 2, vǫ, vf|g) df 1 df 2 dvǫ dvf.
(4.35)
In general, these computations are not easy.
One way to obtain approximate esti-
mates is to approximate p(f 1, f 2, vǫ, vf|g) by a separable one q(f 1, f 2, vǫ, vf|g)
=
q1(f 1) q2(f 2) q3(vǫ) q4(vf|g), then computing
Eq {f 1} =
Z
f 1 df 1
(4.36)
If we can do this approximation intelligently, i.e. in such a way that Eq {f 1} is the same as
Ep {f 1} we gain great amount of computational cost. In particular, for the proposed hierar-
chical model, Equation (4.31), the posterior distribution, Equation (4.32), is not a separable
distribution, making the analytical computation of PM very difﬁcult. One way the compute
the PM in this case is to ﬁrst approximate the posterior law p(f 1, f 2, vǫ, vf|g) with a separa-
ble law q(f 1, f 2, vǫ, vf|g):
p(f 1, f 2, vǫ, vf|g) ≈q(f 1, f 2, vǫ, vf|g) = q1(f 1) q2(f 2) q3(vǫ) q4(vf)
(4.37)
by minimizing of the Kullback-Leibler divergence, deﬁned as:
KL (q(f 1, f 2, vǫ, vf1|g) : p(f 1, f 2, vǫ, vf1|g)) =
=
ZZ
. . .
Z
q(f 1, f 2, vǫ, vf|g) ln q(f 1, f 2, vǫ, vf|g)
p(f 1, f 2, vǫ, vf|g) df 1 df 2 dvǫ dvf
(4.38)
where the following notations are used:
q3(vǫ) =
N
Y
i=1
q3i(vǫi) ; q4(vf) =
M
Y
j=1
q4j(vfj) ;
dvǫ =
N
Y
i=1
dvǫi ;
dvf =
M
Y
j=1
dvfj
(4.39)
The minimization can be done via alternate optimization resulting the following proportion-
alities:



























q1(f 1) ∝exp
n
⟨ln p(f 1, f 2, vǫ, vf|g)⟩q2(f 2) q3(vǫ) q4(vf )
o
q2(f 2) ∝exp
n
⟨ln p(f 1, f 2, vǫ, vf|g)⟩q1(f 1) q3(vǫ) q4(vf )
o
q3i(vǫi) ∝exp

⟨ln p(f 1, f 2, vǫ, vf|g)⟩q1(f 1) q2(f 2) q3−i(vǫi) q4(vf)

, i ∈{1, 2 . . ., N}
q4j(vf j) ∝exp

⟨ln p(f 1, f 2, vǫ, vf|g)⟩q1(f 1) q2(f 2) q3(vǫ) q4−j(vfj )

, j ∈{1, 2 . . ., M} ,
(4.40)
using the notations:
q3−i(vǫi) =
N
Y
k=1,k̸=i
q3k(vǫk)
;
q4−j(vfj) =
M
Y
k=1,k̸=j
q4k(vfk)
(4.41)
and also
⟨u(x)⟩v(y) =
Z
u(x)v(y) dy.
(4.42)
66

Generalized Student-t hierarchical model
From Equation (4.32), the analytical expression of the logarithm is obtained:
ln p(f 1, f 2, vǫ, vf1, vf2|g) = C −1
2 ln det (V ǫ) −1
2∥V ǫ
−1
2 (g −H1f 1 −H2f 2) ∥2
−
N
X
i=1
(αǫi0 + 1) ln vǫi −
N
X
i=1
βǫi0v−1
ǫi −ln det (V f)
−1
2∥V
−1
2
f f 1∥2 −
M
X
j=1

αfj0 + 1

ln vfj −
M
X
j=1
βfj0v−1
fj
−1
2∥V
−1
2
f f 2∥2
(4.43)
• Expression of q1(f 1) and q2(f 2):
The proportionality relation corresponding to q1(f 1) established in equation (4.40) refers to
f 1, so in the expression of ln p(f 1, f 2, vǫ, vf|g) all the terms free of f 1 can be regarded as
constants:
⟨ln p(f 1, f 2, vǫ, vf|g)⟩q2(f 2) q3(vǫ) q4(vf ) = C
−
1
2∥V ǫ
−1
2 (g −H1f 1 −H2f 2) ∥2

q2(f 2) q3(vǫ)
−
1
2∥V
−1
2
f f 1∥2

q4(vf )
Introducing the notations:
f
vǫi =
D
v−1
ǫi
E
q3i(vǫi) ;
f
vǫ =
h
f
vǫ1 . . . f
vǫi . . . g
vǫN
iT
;
g
V ǫ = diag [f
vǫ]
g
vfj =
D
v−1
fj
E
q4j(vfj) ;
f
vf =
h
g
vf1 . . . g
vf j . . . g
vfM
iT
;
g
V f = diag [f
vf]
(4.44)
we can write:
⟨ln p(f 1, f 2, vǫ, vf|g)⟩q2(f 2) q3(vǫ) q4(vf ) = C −1
2
D
∥g
V ǫ
1
2 (g −H1f 1 −H2f 2) ∥2E
q2(f 2)
−1
2∥g
V f
1
2f 1∥2
Developing the norm ∥g
V ǫ
1
2 (g −H1f 1 −H2f 2) ∥2, introducing the notation
f 2P M = ⟨f 2⟩q2(f 2)
(4.45)
and then excluding the f 1 free terms, we obtain:
D
∥g
V ǫ
1
2 (g −H1f 1 −H2f 2) ∥2E
q2(f 2) = −2gT g
V ǫH1f 1 + f 1
TH1
T g
V ǫH1f 1
+ 2f T
2P MH2
T g
V ǫH1f 1
(4.46)
so the proportionality for q1(f 1) can be expressed as:
q1(f 1) ∝exp

−1
2

f 1
T 
H1
T g
V ǫH1 + g
V f

f 1 −2

g −H2 f
f 2
T g
V ǫH1f 1

(4.47)
67

4.4.3 - Posterior Mean (via VBA, partial separability)
i.e. the probability density function q1(f 1) is proportional to a exponential having a quadratic
criterion, leading to the conclusion that q1(f 1) is a multivariate Normal distribution, q1(f 1) =
N (f 1|f 1P M, Σ1P M). Evidently, for determining the mean of the Normal distribution it is
sufﬁcient to minimize the quadratic criterion of the exponential. The covariance matrix is
then obtained by identiﬁcation, leading to:
q1(f 1) = N (f 1|f 1P M, Σ1P M) ,







f 1P M =

H1T g
V ǫH1 + g
V f
−1 H1T g
V ǫ (g −H2f 2P M)
Σ1P M =

H1T g
V ǫH1 + g
V f
−1
(4.48)
with g
V ǫ, g
V f and f 2P M introduced in (4.44) and (4.45). For the expression q2(f 2) all the
computations are the same and following the same developments, we conclude that q2(f 2) is
a multivariate Normal distribution:
q2(f 2) = N (f 2|f 2P M, Σ2P M) ,







f 2P M =

H2T g
V ǫH2 + g
V f
−1 H2T g
V ǫ (g −H1f 1P M)
Σ2P M =

H2T g
V ǫH2 + g
V f
−1
(4.49)
• Expression of q3i(vǫi):
Considering the terms free of vǫi as constants, we have:
⟨ln p(f 1, f 2, vǫ, vf|g)⟩q1(f 1) q2(f 2) q3−i(vǫi) q4(vf ) = C −1
2 ln vǫi −(αǫ0 + 1) ln vǫi
−1
2
D
∥V ǫ
−1
2 (g −H1f 1 −H2f 2) ∥2E
q1(f 1) q2(f 2) q3−i(vǫi) −βǫ0v−1
ǫi
(4.50)
For
D
∥V ǫ−1
2 (g −H1f 1 −H2f 2) ∥2E
q1(f 1) q2(f 2) q3−i(vǫi) we have the following develop-
ment:
D
∥V ǫ
−1
2 (g −H1f 1 −H2f 2) ∥2E
q1(f 1) q2(f 2) q3−i(vǫi) = C
+ v−1
ǫi

gi −Hi
1f 1P M −Hi
2f 2P M
2
+ v−1
ǫi

Hi
1Σ1P MHiT
1

+ v−1
ǫi

Hi
2Σ2P MHiT
2

(4.51)
so the proportionality relation corresponding to q3i(vǫi), Equation (4.40) becomes:
q3i(vǫi) ∝v
−(αǫi+1)
ǫi
exp
n
−βǫiv−1
ǫi
o
(4.52)
So q3i(vǫi) is an Inverse Gamma distribution with the following parameters:
q3i(vǫi) = IG (vǫi|αǫi, βǫi) ,













αǫi = αǫ0 + 1
2
βǫi = βǫ0 + 1
2
h
(gi −Hi
1f 1P M −Hi
2f 2P M)
2 +

Hi
1Σ1P MHiT
1 + Hi
2Σ2P MHiT
2
i
(4.53)
• Expression of q4j(vf j):
68

Generalized Student-t hierarchical model
Considering the terms free of vfj as constants, we have:
⟨ln p(f 1, f 2, vǫ, vf|g)⟩q1(f 1) q2(f 2) q3(vǫ) q4−j(vfj ) = −ln vfj −(αf0 + 1) ln vfj
−1
2

∥V
−1
2
f f 1∥2

q1(f 1) q4−j(vfj ) −1
2

∥V
−1
2
f f 2∥2

q2(f 2) q4−j(vfj ) −βf0v−1
f j
(4.54)
For

∥V
−1
2
f f 1∥2

q1(f 1) q4−j(vfj ) and

∥V
−1
2
f f 2∥2

q2(f 2) q4−j(vfj ) we have the following rela-
tions:










∥V
−1
2
f f 1∥2

q1(f 1) q4−j(vfj ) = C + v−1
fj

f 2
1jP M + Σ1jjP M


∥V
−1
2
f f 2∥2

q2(f 2) q4−j(vfj ) = C + v−1
fj

f 2
2jP M + Σ2jjP M

(4.55)
so the proportionality relation corresponding to q4j(vf j) established in equation (4.40) be-
comes:
q4j(vfj) ∝v
−(αfj +1)
f j
exp
n
−βfjv−1
fj
o
(4.56)
We conclude that q4j(vfj) is an Inverse Gamma distribution with the following parameters:
q4j(vfj) = IG

vf j|αfj, βfj

,





αfj = αf0 + 1
βfj = βf0 + 1
2
h
f 2
1jP M + Σ1jjP M + f 2
2jP M + Σ2jjP M
i
(4.57)
The expressions of the parameters corresponding to the two multivariate Normal distributions
q1(f 1) and q2(f 2) depend on g
V ǫ and g
V f, introduced in (4.44). Since q3i(vǫi) and q4j(vf j)
are Inverse Gamma distributions it is easy to express the two matrices with the corresponding
Inverse Gamma parameters:
f
vǫi =
D
v−1
ǫi
E
IG(vǫi|αǫi,βǫi) = αǫi
βǫi
⇒g
V ǫ = diag
"αǫi
βǫi
#
g
vfj =
D
v−1
f j
E
IG(vfj |αfj ,βfj) = αfj
βfj
⇒g
V f = diag
"αfj
βfj
#
(4.58)
• Algorithm:
Equations (4.48), (4.49), (4.53), (4.57), representing the distribution families of separable laws
q and their corresponding parameters are leading to an iterative algorithm estimating all the
parameters involved. The shape parameters corresponding to the Inverse Gamma distributions
69

4.4.3 - Posterior Mean (via VBA, partial separability)
rest constants during the iterations. All the other parameters are updated, changing the value.







f 1P M =

H1Tdiag

αǫi
βǫi

H1 + diag

αfj
βfj
−1
H1Tdiag

αǫi
βǫi

(g −H2f 2P M)
Σ1P M =

H1Tdiag

αǫi
βǫi

H1 + diag

αfj
βfj
−1
(4.59a)







f 2P M =

H2Tdiag

αǫi
βǫi

H2 + diag

αfj
βfj
−1
H2Tdiag

αǫi
βǫi

(g −H1f 1P M)
Σ2P M =

H2Tdiag

αǫi
βǫi

H2 + diag

αfj
βfj
−1
(4.59b)



αǫi = αǫ0 + 1
2
βǫi = βǫ0 + 1
2
h
(gi −Hi
1f 1P M −Hi
2f 2P M)
2 +

Hi
1Σ1P MHiT
1 + Hi
2Σ2P MHiT
2
i
(4.59c)



αfj = αf0 + 1
βfj = βf0 + 1
2
h
f2
1jP M + Σ1jjP M + f 2
2jP M + Σ2jjP M
i
(4.59d)
Equation (4.59a) establish the dependency of the parameters corresponding to the Multivari-
ate Normal Distribution q1(f 1) and the others hyperparameters involved in the Hierarchical
Model: the mean f 1P M and the covariance matrix Σ1P M depend on diag

αǫi
βǫi

and diag

αfj
βfj

:
{βǫi} ,
n
βfj
o
✲f 1P M, Σ1P M
(4.60)
Equation (4.59b) establish the dependency of the parameters corresponding to the Multivari-
ate Normal Distribution q2(f 2) and the others hyperparameters involved in the Hierarchical
Model: the mean f 2P M and the covariance matrix Σ2P M depend on diag

αǫi
βǫi

and diag

αfj
βfj

:
{βǫi} ,
n
βfj
o
✲f 2P M, Σ2P M
(4.61)
Equation (4.59c) leads to the following dependency scheme:
f 1P M, Σ1P M, f 2P M, Σ2P M
✲
{βǫi}
(4.62)
Equation (4.59d) leads to the following dependency schemes:
f 1P M, Σ1P M, f 2P M, Σ2P M
✲
n
βfj
o
(4.63)
The scheme of the iterative algorithm is presented in Figure (4.6):
An important part of the algorithm is represented by the initialization part. We have to
choose the parameters that will be used for the initialization part and assign them numerical
values. We also have to assign numerical values for the shape and scale parameters corre-
sponding to the two Inverse Gamma prior distributions involved in the hierarchical model. In
70

Generalized Student-t hierarchical model
f 1P M =

H1T g
V ǫH1 + g
V f
−1 H1T g
V ǫ (g −H2f 2P M)
Σ1P M
=

H1T g
V ǫH1 + g
V f
−1
(a) - update PC amplitudes vector f 1
f 2P M =

H2T g
V ǫH2 + g
V f
−1 H2T g
V ǫ (g −H1f 1P M)
Σ2P M
=

H2T g
V ǫH2 + g
V f
−1
(b) - update PC amplitudes vector f 2
αǫi
=
αǫ0 +
1
2
βǫi
=
βǫi0
+
1
2
h
(gi −Hi
1f 1P M −Hi
2f 2P M)
2 +

Hi
1Σ1P MHiT
1 + Hi
2Σ2P MHiT
2
i
(c) - update noise variance hyeperparameters
αfj
=
αfj0 + 1
βfj = βfj0 + 1
2
h
f 2
1jP M + Σ1jjP M + f2
2jP M + Σ2jjP M
i
(d) - update PC variance hyeperparameters
d
V −1
ǫ
= diag

αǫi
βǫi

d
V −1
f
= diag

αfi
βfi

Initialization
Figure 4.6: Updating scheme: PM estimation via VBA (partial separability) for generalized
Student-t prior model
order to select the values corresponding to αf0, βf0, αǫ0, βǫ0 we have to account for the fact
that those hyperparameters have a crucial role in the selection of the model. The marginal
of the Normal-Inverse Gamma distribution, i.e. the generalized Student-t modelling the two
PC amplitudes vectors f 1 and f 2 depends on αf0, βf0, Equation (A.25). Furthermore, for
the mechanism sparsity, αf0, βf0 must be chosen such as they impose a sparse structure for
the variance vector vf via the Inverse Gamma distribution. αǫ0, βǫ0 must be chosen such that
the proposed algorithm can distinguish between the peaks from the PC amplitudes vectors
corresponding to the biological phenomena and the peaks corresponding to the noise.
71

4.4.4 - Prior Inverse Gamma parameters setting for vfj
4.4.4
Prior Inverse Gamma parameters setting for vf j
The proposed hierarchical model (4.31) is modelling the variances corresponding to f 1 and
f 2, namely vfj as Inverse Gamma distributions.
0
0.1
0.2
0.3
0.4
0.5
0
5
10
15
Inverse Gamma distribution
 
 
α=1, β=1
α=2, β=1
α=3, β=1
α=4, β=1
α=3, β=0.5
α=3, β=0.25
α=4, β=0.25
0
0.02
0.04
0.06
0.08
0.1
0
50
100
150
200
250
300
350
400
450
Inverse Gamma distribution
 
 
α=3, β=1
α=4, β=1
α=3, β=0.5
α=3, β=0.25
α=4, β=0.25
α=4, β=0.1
α=6, β=0.01
Figure 4.7: Inverse Gamma distributions for different α, β parameters
Figure (4.7) presents the behaviour of the Inverse Gamma distribution, depending on the
two parameters. The fundamental goal of the proposed hierarchical model was to search a
sparse solution for f 1 and f 2. The mechanism of the sparsity enforcing is linked with the
f 1 and f 2 sparse
✲
✲
high
number
of
points f 1j and f 2j are
zero or close to zero
✲
high
number
of
points vfj are zero or
close to zero
❄
small
number
of
points f 1j and f 2j
have high values
✲
small
number
of
points vfj have high
values
✻
vf sparse
Figure 4.8: Sparsity mechanism: the sparsity is imposed (also) via the corresponding variance
corresponding variances vf j: the points of the vector with zero or almost zero values are
associated with small variances, meaning that once the algorithm is setting those values close
to zero then they will rest close to zero, not having high variations. For the non-zero values,
we want to allow certain variations of the amplitude. In this case, the variances associated
72

Generalized Student-t hierarchical model
must have signiﬁcant values. The link between the PC amplitudes vectors f 1 and f 2 and the
variances vector vf is presented in Figure (4.8). Therefore, we search the Inverse Gamma
distributions parameters such that the expected value is close to zero and the variance is close
to a certain value w set in accordance with the data.
The expected value of an Inverse Gamma distribution, IG(x|α, β) is deﬁned for α > 1,
EIG [x] =
β
α−1, and the variance is deﬁned for α > 2, V arIG [x] =
β2
(α−1)2(α−2). The shape
and scale parameters for the Inverse Gamma distribution must be set such that:
β
α −1 = ǫ ≃0
;
β2
(α −1)2(α −2) = w
(4.64)
One way to assure an Inverse Gamma distribution that presents a small expected values ǫ ≃0
and a certain w variation is to adopt the following model for the parameters:
α = 2 + ǫ2
0 ; β = √wǫ0(1 + ǫ2
0) , ǫ0 =
ǫ
√w
(4.65)
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0
2
4
6
8
10
12
14
16
E=0.1
Inverse Gamma distribution
Var=1
Var=0.1
Var=0.01
Var=0.001
Figure 4.9: x ∼IG(x|α, β); E [x] = 0.1; Var [x] = 1, 0.1, 0.01 and 0.001
0
0.01
0.02
0.03
0.04
0.05
0
20
40
60
80
100
120
140
E=0.01
Inverse Gamma distribution
Var=1
Var=0.1
Var=0.01
Var=0.001
Figure 4.10: x ∼IG(x|α, β); E [x] = 0.01; Var [x] = 1, 0.1, 0.01 and 0.001
Figure (4.9) shows four Inverse Gamma distributions for which the mean is the same,
E [x] = 0.1, but with the variances Var [x] = 1, 0.1, 0.01 and 0.001, for which the param-
eters are computed using Equation (4.65). The generalized Student-t distributions, i.e. the
marginals of the IGSM distributions corresponding to the two parameters α and β, imposing
the mean and variances mentioned above are presented in Figures (4.12), (4.13)
73

4.4.4 - Prior Inverse Gamma parameters setting for vfj
×10 -3
0
1
2
3
4
5
0
200
400
600
800
1000
1200
1400
E=0.001
Inverse Gamma distribution
Var=1
Var=0.1
Var=0.01
Var=0.001
Figure 4.11: x ∼IG(x|α, β); E [x] = 0.001; Var [x] = 1, 0.1, 0.01 and 0.001
ǫ
w
VarStg = EIG
VarIG
Figure
0.1
0.1
0.1
0.1
Figures (4.9), (4.12),(4.13)
0.1
0.01
0.1
0.01
Figures (4.9),(4.12),(4.13)
0.1
0.001
0.1
0.001
Figures (4.9),(4.12),(4.13)
0.01
0.1
0.01
0.1
Figure (4.10),(4.14),(4.15)
0.01
0.01
0.01
0.01
Figure (4.10),(4.14),(4.15)
0.01
0.001
0.01
0.001
Figure (4.10),(4.14),(4.15)
0.001
0.1
0.001
0.1
Figure (4.11),(4.16),(4.17)
0.001
0.01
0.001
0.01
Figure (4.11),(4.16),(4.17)
0.001
0.001
0.001
0.001
Figure (4.11),(4.16),(4.17)
Table 4.1: Mean and variance for Stg via ǫ and w
Figure (4.10) shows four Inverse Gamma distributions for which the mean is the same,
E [x] = 0.01, but with the variances Var [x] = 1, 0.1, 0.01 and 0.001, for which the param-
eters are computed using Equation (4.65). The generalized Student-t distributions, i.e. the
marginals of the IGSM distributions corresponding to the two parameters α and β, imposing
the mean and variances mentioned above are presented in Figures (4.14), (4.15)
Figure (4.11) shows four Inverse Gamma distributions for which the mean is the same,
E [x] = 0.001, but with the variances Var [x] = 1, 0.1, 0.01 and 0.001, for which the param-
eters are computed using Equation (4.65). The generalized Student-t distributions, i.e. the
marginals of the IGSM distributions corresponding to the two parameters α and β, imposing
the mean and variances mentioned above are presented in Figures (4.16), (4.17)
-1
-0.5
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
ESt=0
Var St=0.1
EIG=0.1
Var IG=0.1
Generalized St-t
-1
-0.5
0
0.5
1
0
0.5
1
1.5
ESt=0
Var St=0.1
EIG=0.1
Var IG=0.01
Generalized St-t
-1
-0.5
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1.2
1.4
ESt=0
Var St=0.1
EIG=0.1
Var IG=0.001
Generalized St-t
Figure 4.12: Different Generalized Student-t distributions for which the means EStg = 0 and
the variances VarStg = 0.1 are the same
74

Generalized Student-t hierarchical model
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
ESt=0
Var St=0.1
Generalized St-t
Var IG=0.1
Var IG=0.01
Var IG=0.001
Figure 4.13: Generalized Student-t: VarStg = 0.1; VarIG = 0.1, 0.01, 0.001;
-0.5
0
0.5
0
1
2
3
4
5
6
ESt=0
Var St=0.01
EIG=0.01
Var IG=0.1
Generalized St-t
-0.5
0
0.5
0
1
2
3
4
5
6
ESt=0
Var St=0.01
EIG=0.01
Var IG=0.01
Generalized St-t
-0.5
0
0.5
0
1
2
3
4
5
6
ESt=0
Var St=0.01
EIG=0.01
Var IG=0.001
Generalized St-t
Figure 4.14: Different Generalized Student-t distributions for which the means EStg = 0 and
the variances VarStg = 0.01 are the same
-0.5
-0.4
-0.3
-0.2
-0.1
0
0.1
0.2
0.3
0.4
0.5
0
1
2
3
4
5
6
ESt=0
Var St=0.01
Generalized St-t
Var IG=0.1
Var IG=0.01
Var IG=0.001
Figure 4.15: Generalized Student-t: VarStg = 0.01; VarIG = 0.1, 0.01, 0.001;
-0.1
-0.05
0
0.05
0.1
0
2
4
6
8
10
12
14
16
18
ESt=0
Var St=0.001
EIG=0.001
Var IG=0.1
Generalized St-t
-0.1
-0.08
-0.06
-0.04
-0.02
0
0.02
0.04
0.06
0.08
0.1
0
2
4
6
8
10
12
14
16
18
ESt=0
Var St=0.001
EIG=0.001
Var IG=0.01
Generalized St-t
-0.1
-0.05
0
0.05
0.1
0
2
4
6
8
10
12
14
16
18
ESt=0
Var St=0.001
EIG=0.001
Var IG=0.001
Generalized St-t
Figure 4.16: Different Generalized Student-t distributions for which the means EStg = 0 and
the variances VarStg = 0.001 are the same
4.4.5
Prior Inverse Gamma parameters setting for vǫi
The variance corresponding to the noise, vǫi, i ∈1, 2, . . ., N are also modelled as Inverse
Gamma distributions, for the same conjugacy reasons as in the case of vfj. However, while
75

4.4.5 - Prior Inverse Gamma parameters setting for vǫi
-0.1
-0.05
0
0.05
0.1
0
2
4
6
8
10
12
14
16
18
ESt=0
Var St=0.001
Generalized St-t
Var IG=0.1
Var IG=0.01
Var IG=0.001
Figure 4.17: Generalized Student-t: VarStg = 0.001; VarIG = 0.1, 0.01, 0.001;
the behaviour of vfj variances is linked with the sparsity enforcing of f 1 and f 2, so the
parameters of the prior Inverse Gamma distributions IG(vfj|αf0, βf0) and can be ﬁxed such
that the mean and the variance are in accordance with the sparsity enforcing strategy, it is not
the case for the noise variance. Therefore, in order to ﬁx the parameters of the prior Inverse
Gamma distributions corresponding to the noise variance, another strategy is needed. We
propose two possible approaches.
Non-Informative Prior law for vǫi
As mentioned above, for ﬁxing the parameters of Inverse Gamma distributions for vfj the
prior knowledge was used. In the case of the noise variance, no (direct) prior information is
available. Therefore, we can consider that the most proper way to model the noise variance is
a non-informative prior law. So, in this case, the Inverse Gamma distribution parameters must
be set such that the distribution becomes non-informative, i.e. uniform. The Inverse Gamma
distribution becomes uniform for the parameters equal to zero:
αǫ0 = 0 ; βǫ0 = 0
(4.66)
Data deriving for vǫi
The second approach for ﬁxing the Inverse Gamma distribution parameters corresponding to
vǫi such that the mean and the variance correspond to numerical values derived from data. In
a pure Bayesian inference, such approach could be criticized, since doing this, the available
data, namely the known chronobiological signal g, is used twice for inference: ﬁrst when
deriving the numerical values corresponding to the mean and variance of the prior Inverse
Gamma distribution modelling the noise variance and secondly during the proposed algo-
rithm. However, for the application addressed in this thesis the main limitations is the lack of
prior information. Therefore, this we consider also this approach. The mean and the variance
of vǫi are expressed via the two Inverse Gamma parameters, αǫ0 and βǫ0:
E [vǫi] =
βǫi0
αǫi0 −1 , for αǫi0 > 1
,
Var [vǫi] =
β2
ǫi0
(αǫi0 −1)2 (αǫi0 −2) , for αǫi0 > 2
(4.67)
Both values, E [vǫi] and Var [vǫi] correspond to the noise variance (the mean of the noise
variance and the variance of the noise variance), an unknown of our model. The known input
76

Generalized Student-t hierarchical model
g contains the error vector. This information can be exploited to obtain numerical values for
the Inverse Gamma distribution mean and variance. Considering the mean of the known data
E[g], the mean of the noise variance E [vǫ] can be deﬁned as the squared norm of the difference
between the data and its mean, while the variance of the noise variance Var [vǫ] can be deﬁned
in the same manner: E [vǫ] = ∥g −E [g] ∥2
,
Var [vǫ] = ∥(g −E [g]) −E [g −E [g]] ∥2.
Equations (4.67) links the parameters αǫ0 and βǫ0 with numerical values that are derived from
the known data:
αǫ0 = E [vǫ]
Var [vǫ] + 2 ; βǫ0 = E [vǫ]
 E [vǫ]
Var [vǫ] + 1
!
(4.68)
In particular, such an approach, is consistent to a non-supervised algorithm.
4.4.6
Posterior Mean (via VBA, full separability)
In Subsection (4.4.3) the Student-t model is considered and the PM estimator is used. The
posterior law is approximated by a separable one, Equation (4.37), where the notations for
q3(vǫ) and q4(vf ), introduced in Equation (4.39), represent a full separability relative to vǫ
and vf . But the prior law p(f 1, f 2, vǫ, vf |g) is not approximated by a fully separable one
since for q1(f 1) and q2(f 2) we consider a multivariate law modelling the vector f 1 and f 2. In
this subsection we investigate the development of the proposed model and same PM estimator,
but the posterior law is approximated by a fully separable law relative to all the unknowns, i.e.
also for f. The interest of such development concerns the applications where the precision
required is high, making the numerical computations very costly. In this case, the posterior law
from the Hierarchical Model p(f, vǫ, vf|g) is approximated by a fully separable probability
density function:
p(f 1, f 2, vǫ, vf|g) ≈q(f 1, f 2, vǫ, vf|g) = q1(f 1) q2(f 2) q3(vǫ) q4(vf)
(4.69)
where the notations for q3(vǫ) and q4(vf) are deﬁned in Equation (4.39) and :
q1(f 1) =
M
Y
j=1
q1j(f 1j) ; q2(f 2) =
M
Y
j=1
q2j(f 2j) ;
df 1 =
M
Y
j=1
df 1j ;
df 2 =
M
Y
j=1
df 2j
(4.70)
and
q1−j(f1j) =
M
Y
k=1,k̸=j
q1k(f 1k) ; q2−j(f 2j) =
M
Y
k=1,k̸=j
q2k(f2k)
(4.71)
Like in Subsection (4.4.3), the law q(f 1, f 2, vǫ, vf|g) is obtained by minimizing the
Kullback-Leibler divergence, Equation (4.38), via alternate optimization, obtaining an iter-
ative algorithm. The scheme of the iterative algorithm is presented in Figure (4.18):
77

4.4.6 - Posterior Mean (via VBA, full separability)
f 1jP M
=
H jT
1
d
V −1ǫ (g−H −j
1 f −j
1 −H 2f 2)
∥H jT
1
 d
V −1ǫ
1/2H j
1∥2+ c
v−1
fj
var1j
=
 
∥HjT
1

d
V −1
ǫ
1/2
Hj
1∥2 + d
v−1
fj
!1
(a) - update element f1jP M from PC amplitudes vector f 1
f 2jP M
=
H jT
2
d
V −1ǫ (g−H −j
2 f −j
2 −H 1f 1)
∥H jT
2
 d
V −1ǫ
1/2H j
2∥2+ c
v−1
fj
var2j
=
 
∥HjT
2

d
V −1
ǫ
1/2
Hj
2∥2 + d
v−1
fj
!1
(b) - update element f 2jP M from PC amplitudes vector f 2
αǫi
=
αǫ0 +
1
2
βǫi
=
βǫi0
+
1
2
h
(gi −Hi
1f 1P M −Hi
2f 2P M)2 +

Hi
1Σ1P MHiT
1 + Hi
2Σ2P MHiT
2
i
(c) - update noise variance hyeperparameters
αfj
=
αfj0 + 1
βfj = βfj0 + 1
2
h
f 2
1jP M + Σ1jjP M + f 2
2jP M + Σ2jjP M
i
(d) - update PC variance hyeperparameters
d
V −1
ǫ
= diag

αǫi
βǫi

d
V −1
f
= diag

αfi
βfi

Initialization
Figure 4.18: Updating scheme: PM estimation via VBA (full separability) for generalized
Student-t prior model
78

5
Simulations: Synthetic data
Contents
5.1
Simulations 05dB
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
80
5.1.1
Synthetic data 05dB
. . . . . . . . . . . . . . . . . . . . . . . . .
80
5.1.2
Data 05dB
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
81
5.1.3
JMAP IGSM 05dB . . . . . . . . . . . . . . . . . . . . . . . . . .
82
5.1.4
PM (via VBA, partial separability) IGSM 05dB . . . . . . . . . . .
84
5.1.5
PM (via VBA, full separability) IGSM 05dB
. . . . . . . . . . . .
85
5.1.6
Methods comparison 05dB . . . . . . . . . . . . . . . . . . . . . .
86
5.1.7
Error comparison 05dB . . . . . . . . . . . . . . . . . . . . . . . .
87
5.2
Synthetic data 10dB . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
91
5.2.1
Data 10dB
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
91
5.2.2
JMAP IGSM 10dB . . . . . . . . . . . . . . . . . . . . . . . . . .
92
5.2.3
PM (via VBA, partial separability) IGSM 10dB . . . . . . . . . . .
93
5.2.4
PM (via VBA, full separability) IGSM 10dB
. . . . . . . . . . . .
95
5.2.5
Methods comparison 10dB . . . . . . . . . . . . . . . . . . . . . .
96
5.2.6
Error comparison 10dB . . . . . . . . . . . . . . . . . . . . . . . .
97
5.3
Synthetic data 15dB . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
5.3.1
Data 15dB
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
5.3.2
JMAP IGSM 15dB . . . . . . . . . . . . . . . . . . . . . . . . . . 101
5.3.3
PM (via VBA, partial separability) IGSM 15dB . . . . . . . . . . . 102
5.3.4
PM (via VBA, full separability) IGSM 15dB
. . . . . . . . . . . . 104
5.3.5
Methods comparison 15dB . . . . . . . . . . . . . . . . . . . . . . 105
5.3.6
Error comparison 15dB . . . . . . . . . . . . . . . . . . . . . . . . 106
79

5.1.1 - Synthetic data 05dB
5.4
Student-t PM via VBA vs. LASSO 05dB . . . . . . . . . . . . . . . . . . 109
5.5
Student-t PM via VBA vs. LASSO 10dB . . . . . . . . . . . . . . . . . . 114
T
HIS chapter is dedicated to the simulations results corresponding to the synthetic data,
for the iterative algorithms presented in Chapter (4). First, we present in detail the
results for three levels of noise, 05dB, Section (5.1), 10dB, Section (5.2) and 15dB, Sec-
tion (5.3), for comparing the Gaussian model (i.e the Gaussian prior) with the proposed
Student-t model. For each prior, we compare the algorithms corresponding to the JMAP
and PM estimation. For all three sections, we present comparisons between the theoreti-
cal PC amplitude vector f and the estimated PC amplitude vector bf. We show the con-
vergency of the PC vectors during the iterations and show the evolutions of the estimation
errors for different realisation of the noise. Then, in Section (5.4) and Section (5.5) and
we present the comparison between the Proposed Method and LASSO method, showing in
detail the results corresponding to SNR=05dB and SNR=10dB and ﬁnally showing the be-
haviour of the L1 and L2 error norms corresponding to the Proposed Method and LASSO for
SNR={50dB,40dB,30dB,25dB,20dB,15dB,10dB,05dB}.
For Sections (5.1), (5.2) and (5.3), ﬁve algorithms corresponding the Bayesian approach
are compared: Joint MAP with Gaussian prior, Posterior Mean with Gaussian prior, Joint
MAP with Student-t prior, Posterior Mean (via VBA) with Student-t prior (partial separability)
and Posterior Mean (via VBA) with Student-t prior (full separability).
For each iterative algorithm, we present a comparison between the algorithm’s estimation
and the synthetic data, i.e. a comparison between bf Method and f, between bgMethod and g and
between bgMethod and g0 theoretical signal (g without noise). For every algorithm considered,
we present the convergency analysis of the parameters and hyperparameters involved. Then,
we present a comparison between the estimations of proposed algorithms and the classical
FFT method. Finally, the proposed algorithms are tested 10 times over the same data, but
different noise realisation, in order to obtain the L2 error vector (the normalized difference
between data and estimated data, considered for f, g and theoretical signal g0) and compare
the performances of each algorithm. The comparisons between error vectors corresponding
to each algorithm are presented at the end of the subsections.
We consider the following protocol: we consider a theoretical PC vector f and the cor-
responding theoretical signal Hf; we consider the corresponding signal g = Hf + ǫ, by
adding noise over the theoretical signal. The considered signal represents a four day signal,
sampled every hour. The matrix H considered in this set of simulations is a cosine plus sine
matrix.
5.1 Simulations 05dB
This section presents the simulations corresponding to the synthetic case, for 05dB.
5.1.1
Synthetic data 05dB
For testing we have considered a four days signal, corresponding to a sparse PC vector, having
non-zero values for 11h, 15h, and 23h. We consider this particular structure for the following
80

Simulations 05dB
reasons: we want to verify if the proposed method can precisely distinguish the peaks inside
the circadian domain. As we have mentioned, for such signals, via the FFT we obtain an
important peak corresponding to 24h and the corresponding harmonics, but this method offers
no information for certain values in the circadian domain. We have showed in Chapter (3),
Figure (3.2) that a dominant period, corresponding to 23h is wrongly estimated at 24h via FFT
method and offers no other informations for the interval [20-31].
5.1.2
Data 05dB
The PC vector f, theoretical signal g0 and the signal g are presented in the Figure (5.1):
Figure (5.1a) shows the theoretical PC, having the non-zero periods corresponding to 11h,
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
f
Theoretical PC
(a) PC vector f
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
cond(H)=56798792591.5098
Theoretical Signal
(b) Theoretical Signal g0
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
4
5
g
SNR=5
Real Signal
(c) Signal g
Figure 5.1: f PC vector, theoretical signal g0 and input signal g = g0 + ǫ of the model (5dB)
15h and 23h. All the other values in the PC vector are zero. Figure (5.1b) presents the signal
corresponding to the linear model considered in Equation (4.4), neglecting the errors, g0 =
Hf. We note that the conditioning number of the matrix H is cond(H) = 56798792591.
81

5.1.3 - JMAP IGSM 05dB
All the simulations are done using as the input the noisy signal g corresponding to the linear
model, Equation (4.4), presented in Figure (5.1c). We compare the estimated PC vector with
the theoretical one, Figure (5.1a) and the corresponding reconstructed signal with g0 and g.
The comparison with the theoretical signal g0 is important in order to verify if the propose
algorithm can distinguish the peaks corresponding to biological phenomena from the ones
corresponding to the noise.
5.1.3
JMAP IGSM 05dB
A comparison between the synthetic data and the JMAP estimation, corresponding to the
IGSM prior hierarchical model is presented in Figure (5.2). We compare the theoretical PC
vector f and the JMAP estimation bf JMAP. We also present the comparison between the es-
timated bgJMAP and g and the comparison between the estimated bgJMAP and the theoretical
signal (without noise) g0: The proposed method is searching for a sparse solution correspond-
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.0726
Theoretical & Estimated PC (JMAP St-t)
Theoretical
Estimated
(a) Theoretical and Estimated PC
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
4
L2 norm: 0.0524
Theoretical & Reconstructed Signal (JMAP St-t)
Theoretical
Estimated
Rezidual Error
(b) Theoretical and Estimated Signal
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
4
5
L2 norm: 0.285
Real & Reconstructed Signal (JMAP St-t)
Theoretical
Estimated
Rezidual Error
(c) Real and Estimated Signal
Figure 5.2: JMAP IGSM Estimation (5dB)
82

Simulations 05dB
ing to the linear model, Equation (4.4). The comparison between the theoretical signal g0 and
bgJMAP, Figure (5.2b) shows that the proposed algorithm is converging to a solution that leads
to a fairly accurate reconstruction, having the L2 norm error δg0 = ∥g0−bgJMAP ∥2
2
∥g0∥2
2
= 0.0524.
For the PC vector, the reconstruction error is δf = ∥f −bf JMAP ∥2
2
∥f ∥2
2
= 0.0726. For the JMAP
estimation, the condition imposed for the searched solution, i.e. the sparsity is not respected,
Figure (5.2a). In fact, the alternate optimization algorithm considered for searching the JMAP
solution is converging to a local minimum and the estimation errors corresponding to the
JMAP estimation might be far from the example presented. Figure (5.3a) presents the vari-
Number Of Simulations
1
6
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
L2 Error PC (JMAP St)
(a) L2 Error: f vs. bf JMAP
Number Of Simulations
1
6
Amplitude
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
0.5
L2 Error Signal Theoretical (JMAP St)
(b) L2 Error: g0 vs. bgJMAP
Number Of Simulations
1
6
Amplitude
0.25
0.3
0.35
0.4
0.45
0.5
0.55
0.6
0.65
L2 Error Signal Real (JMAP St)
(c) L2 Error: g vs. bgJMAP
Figure 5.3: JMAP IGSM L2 error measured for 10 different noise realisations (5dB)
ation of L2 PC vector error reconstruction for 10 different noise realisation. As mentioned,
the JMAP solution given by the alternate optimization algorithm is converging to a local min-
imum and the estimation may be very inaccurate. We note that the ﬁgure presents a variation
of L2 PC vector error reconstruction from 0.0524 to 4.2841. Important variations correspond-
ing to the L2 error reconstruction for the theoretical signal g0, and signal g, are presented in
Figure (5.3b) and Figure (5.3c).
83

5.1.4 - PM (via VBA, partial separability) IGSM 05dB
5.1.4
PM (via VBA, partial separability) IGSM 05dB
A comparison between the synthetic data and the PM (via VBA, partial separability) IGSM
estimation is presented in Figure (5.4). We compare the theoretical PC vector f with the
PM (via VBA, partial separability) IGSM estimation bf P M, Figure (5.4a) and the corre-
sponding reconstructed signal bgP M both with the theoretical signal g0, Figure (5.4b) and
the input signal g, Figure (5.4c). In the case of the Posterior Mean estimation via VBA,
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.0283
Theoretical & Estimated PC (VBA1 St-t)
Theoretical
Estimated
(a) Theoretical and Estimated PC
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
4
L2 norm: 0.0275
Theoretical & Reconstructed Signal (VBA1 St-t)
Theoretical
Estimated
Rezidual Error
(b) Theoretical and Estimated Signal
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
4
5
L2 norm: 0.259
Real & Reconstructed Signal (VBA1 St-t)
Theoretical
Estimated
Rezidual Error
(c) Real and Estimated Signal
Figure 5.4: PM (via VBA, partial separability) IGSM Estimation (5dB)
both the PC estimation and theoretical signal g0 reconstruction are very accurate, Figure
(5.4a) and Figure (5.4b).
For the reconstruction of the theoretical signal g0, the L2 er-
ror norm is δg0 =
∥g0−bgP M∥2
2
∥g0∥2
2
= 0.0275. For the PC vector, the reconstruction error is
δf = ∥f −bf P M∥2
2
∥f ∥2
2
= 0.0283. The algorithm is converging to a sparse solution where all the
non zero peaks are detected. The residual error computed between g and the reconstructed
signal is consistent with the error considered in the model, 5dB, Figure (5.4c) . During the
84

Simulations 05dB
algorithm both Inverse Gammas shape parameters are constant, Equation (4.59c) and Equa-
tion (4.59d). We present the convergence of the scale parameters βǫ and βf, Figure (5.5d) and
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
PC Convergency  (VBA1 St-t)
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
(a) f convergency
1
4
7 10 13 16 19 22 25 28 31 34 37 40 43 46 49 52 55 58 61 64 67 70 73 76 79 82 85 88 91 94
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
Periods
Amplitude
βf Convergency  (IGSM)
 
 
10
20
30
40
50
60
70
80
90
100
(b) βǫ convergency
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.02
0.04
0.06
0.08
0.1
Cov Diag Convergency  (VBA1 St-t)
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
(c) diag( bΣ) convergency
8
16
24
32
0
0.1
0.2
0.3
0.4
0.5
0.6
Periods
Amplitude
βε Convergency  (IGSM)
 
 
10
20
30
40
50
60
70
80
90
100
(d) βf convergency
Figure 5.5: PM (via VBA, partial separability) IGSM hyperparameters and f convergency
Figure (5.5b), the convergence of Σ covariance matrix diagonal, Figure (5.5c) and the conver-
gence of algorithm’s solution f. For a better visualisation of the PC convergence f is plotted
as a vector, Figure (5.5a). The colour scale corresponding to each ﬁgure represents the itera-
tions, showing a very fast convergence both for the parameters and hyperparameters involved
in the model. All the estimations of the parameters and hyperparameters are superposed after
the ﬁrst ten iterations. In the previous paragraph we have showed that the JMAP estimation
for the proposed model is presenting high variations in terms of the error estimation and re-
construction. We show that for the PM estimation, the error variation is very small. Figure
(5.6a) presents the variation of L2 PC vector error reconstruction for 10 different noise realisa-
tion. The ﬁgure presents a very small variation of L2 PC vector error reconstruction, between
0.02215 and 0.0621. Very small variations corresponding to the L2 error reconstruction for
the theoretical signal g0, and signal g, are presented in Figure (5.6b) and Figure (5.6c).
5.1.5
PM (via VBA, full separability) IGSM 05dB
The estimations for the full separability case are also accurate: Numerically, for the recon-
struction of the theoretical signal g0, the L2 error norm is δg0 = ∥g0−bgP M ∥2
2
∥g0∥2
2
= 0.0247. For
the PC vector, the reconstruction error is δf = ∥f −bf P M ∥2
2
∥f ∥2
2
= 0.0234. Figure (5.8a) presents
the variation of L2 PC vector error reconstruction for 10 different noise realisation. The ﬁgure
presents a very small variation of L2 PC vector error reconstruction, between 0.02 and 0.067.
Very small variations corresponding to the L2 error reconstruction for the theoretical signal
g0, and signal g, are presented in Figure (5.8b) and Figure (5.8c).
85

5.1.6 - Methods comparison 05dB
Number Of Simulations
1
6
Amplitude
0.02
0.025
0.03
0.035
0.04
0.045
0.05
0.055
0.06
0.065
L2 Error PC (VBA1 St)
(a) L2 Error: f vs. bfP M
Number Of Simulations
1
6
Amplitude
0.02
0.03
0.04
0.05
0.06
0.07
L2 Error Signal Theoretical (VBA1 St)
(b) L2 Error: g0 vs. bgP M
Number Of Simulations
1
6
Amplitude
0.18
0.2
0.22
0.24
0.26
0.28
0.3
0.32
0.34
0.36
0.38
L2 Error Signal Real (VBA1 St)
(c) L2 Error: g vs. bgP M
Figure 5.6: PM (via VBA, partial separability) IGSM L2 error measured for 10 different noise
realisations (5dB)
5.1.6
Methods comparison 05dB
A comparison between the estimations corresponding to the IGSM proposed model is pre-
sented in Figure (5.9c) (JMAP estimator), Figure (5.9d) (PM via VBA, partial separability
estimator) and Figure (5.9e) (PM via VBA, full separability estimator). As mentioned in Sec-
tion (4.1), during this article we adopted a Bayesian approach. However, other approaches
are possible, via regularization. For this reason we include a comparison with the Gaussian
case (i.e. Gaussian prior), via the two estimators discussed, Figure (5.9a) (Gaussian Model,
JMAP estimator) and Figure (5.9b) (PM via VBA estimator). A comparison with the FFT
is presented in Figure (5.9f). The L2 estimation error for the PC vector is very high for the
two Gaussian models. Also, the estimations are not sparse. For the IGSM models, the JMAP
estimator is providing a good estimation, but it is unstable. PM via VBA estimation, both
partial and fully separable provides very accurate stable estimations.
86

Simulations 05dB
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.0234
Theoretical & Estimated PC (VBA2 St-t)
Theoretical
Estimated
(a) Theoretical and Estimated PC
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
4
L2 norm: 0.0247
Theoretical & Reconstructed Signal (VBA2 St-t)
Theoretical
Estimated
Rezidual Error
(b) Theoretical and Estimated Signal
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
4
5
L2 norm: 0.26
Real & Reconstructed Signal (VBA2 St-t)
Theoretical
Estimated
Rezidual Error
(c) Real and Estimated Signal
Figure 5.7: PM (via VBA, full separability) IGSM Estimation (5dB)
5.1.7
Error comparison 05dB
The L2 error measurement corresponding to the PC estimation, theoretical signal estimation
and the signal estimation, for 10 different noise realisation is presented in the following ﬁgure:
The L2 error corresponding to the PM via VBA IGSM Model corresponding to the PC vector
estimation, Figure (5.10a) shows the performances of the proposed algorithm compared to the
Gaussian Model and the JMAP estimation for IGSM Model.
87

5.1.7 - Error comparison 05dB
Number Of Simulations
1
6
Amplitude
0.02
0.025
0.03
0.035
0.04
0.045
0.05
0.055
0.06
L2 Error PC (VBA2 St)
(a) Theoretical and Estimated PC
Number Of Simulations
1
6
Amplitude
0.02
0.03
0.04
0.05
0.06
0.07
L2 Error Signal Theoretical (VBA2 St)
(b) Theoretical and Estimated Signal
Number Of Simulations
1
6
Amplitude
0.18
0.2
0.22
0.24
0.26
0.28
0.3
0.32
0.34
0.36
0.38
L2 Error Signal Real (VBA2 St)
(c) Real and Estimated Signal
Figure 5.8: PM (via VBA, full separability) IGSM L2 error measured for 10 different noise
realisations (5dB)
88

Simulations 05dB
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
-0.2
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.381
Theoretical & Estimated PC (JMAP G)
Theoretical
Estimated
(a) JMAP Gaussian
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
-0.2
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.384
Theoretical & Estimated PC (VBA G)
Theoretical
Estimated
(b) PM (via VBA) Gaussian
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.0726
Theoretical & Estimated PC (JMAP St-t)
Theoretical
Estimated
(c) JMAP IGSM
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.0283
Theoretical & Estimated PC (VBA1 St-t)
Theoretical
Estimated
(d) PM (via VBA p. s.) IGSM
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.0234
Theoretical & Estimated PC (VBA2 St-t)
Theoretical
Estimated
(e) PM (via VBA f. s.) IGSM
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
b
fF F T
FFT PC
(f) FFT
Figure 5.9: Methods Comparison (5dB)
89

5.1.7 - Error comparison 05dB
Number Of Simulations
1
6
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
L2 Error PC
JMAP G
VBA G
JMAP St
VBA1 St
VBA2 St
(a) PC error estimation
Number Of Simulations
1
6
Amplitude
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
0.5
L2 Error Signal Theoretical
JMAP G
VBA G
JMAP St
VBA1 St
VBA2 St
(b) Theoretical signal error estimation
Number Of Simulations
1
6
Amplitude
0.2
0.25
0.3
0.35
0.4
0.45
0.5
0.55
0.6
0.65
L2 Error Signal Real
JMAP G
VBA G
JMAP St
VBA1 St
VBA2 St
(c) Signal error estimation (5dB)
Figure 5.10: L2 Errors estimation (5dB)
90

Synthetic data 10dB
5.2 Synthetic data 10dB
In this subsection we present the synthetic data case corresponding to the 10 dB SNR.
5.2.1
Data 10dB
The periodic component vector f, theoretical signal g0 and the signal g are presented in the
following ﬁgure: Figure (5.11a) shows the theoretical PC, set for 11h, 15h and 23h. All
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
f
Theoretical PC
(a) PC vector f
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
cond(H)=56798792591.5098
Theoretical Signal
(b) Theoretical Signal g0
Time(h)
0 
24
48
72
Amplitude
-4
-3
-2
-1
0
1
2
3
4
g
SNR=10
Real Signal
(c) Signal g
Figure 5.11: f PC vector, theoretical signal g0 and input signal g = g0 + ǫ of the model
(10dB)
the other values in the PC vector are zero. Figure (5.11b) presents the signal corresponding
to the linear model considered in Equation (3), neglecting the errors, g0 = Hf. All the
simulations are done using as the input the noisy signal g, (5.11c) corresponding to the linear
model,Equation (3).
91

5.2.2 - JMAP IGSM 10dB
5.2.2
JMAP IGSM 10dB
A comparison between the synthetic data and the JMAP IGSM estimation is presented in the
Figure (5.12). The theoretical periodic component vector f and the JMAP IGSM estimation
bf JMAP are compared in Figure (5.12a). The reconstruction error is δf = ∥f −bf JMAP ∥2
2
∥f ∥2
2
=
0.0259. The comparison between the estimated bgJMAP and the theoretical signal (without
noise) g0 is presented in in Figure (5.12b). The reconstruction error is δg0 =
∥g0−bgJMAP ∥2
2
∥g0∥2
2
=
0.0225. The comparison between the estimated bgJMAP and the signal g is presented in in
Figure (5.12c). Figure (5.13a) presents the variation of L2 PC vector error reconstruction for
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
-0.2
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.0259
Theoretical & Estimated PC (JMAP St-t)
Theoretical
Estimated
(a) Theoretical and Estimated PC
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L2 norm: 0.0225
Theoretical & Reconstructed Signal (JMAP St-t)
Theoretical
Estimated
Rezidual Error
(b) Theoretical and Estimated Signal
Time(h)
0 
24
48
72
Amplitude
-4
-3
-2
-1
0
1
2
3
L2 norm: 0.103
Real & Reconstructed Signal (JMAP St-t)
Theoretical
Estimated
Rezidual Error
(c) Real and Estimated Signal
Figure 5.12: JMAP IGSM Estimation (10dB)
10 different noise realisation, showing high variations. Important variations corresponding to
the L2 error reconstruction for the theoretical signal g0, and signal g, are presented in Figure
(5.13b) and Figure (5.13c).
92

Synthetic data 10dB
Number Of Simulations
1
6
Amplitude
0
1
2
3
4
5
6
L2 Error PC (JMAP St)
(a) L2 Error: f vs. bf JMAP
Number Of Simulations
1
6
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
L2 Error Signal Theoretical (JMAP St)
(b) L2 Error: g0 vs. bgJMAP
Number Of Simulations
1
6
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
L2 Error Signal Real (JMAP St)
(c) L2 Error: g vs. bgJMAP
Figure 5.13: JMAP IGSM L2 error measured for 10 different noise realisations (10dB)
5.2.3
PM (via VBA, partial separability) IGSM 10dB
For the Posterior Mean estimation via VBA, both the PC estimation and theoretical signal g0
reconstruction are very accurate, Figure (5.14a) and Figure (5.14b). For the reconstruction
of the theoretical signal g0, the L2 error norm is δg0 =
∥g0−bgP M∥2
2
∥g0∥2
2
= 0.011. For the PC
vector, the reconstruction error is δf = ∥f −bf P M ∥2
2
∥f ∥2
2
= 0.0144. The algorithm is converging
to a sparse solution where all the non zero clocks are detected. The residual error computed
between g and the reconstructed signal is consistent with the error considered in the model,
10dB, Figure (5.14c). The convergency of Σ covariance matrix diagonal, Figure (5.15a) and
the convergency of algorithm’s solution f, Figure (5.15b) is showing a very fast convergency.
All the estimates are superposed after the ﬁrst ten iterations. We show that for the PM estima-
tion, the error variation is very small. Figure (5.16a) presents the variation of L2 PC vector
error reconstruction for 10 different noise realisation. The ﬁgure presents a very small vari-
ation of L2 PC vector error reconstruction, between 0.008 and 0.02. Very small variations
93

5.2.3 - PM (via VBA, partial separability) IGSM 10dB
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.0144
Theoretical & Estimated PC (VBA1 St-t)
Theoretical
Estimated
(a) Theoretical and Estimated PC
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L2 norm: 0.011
Theoretical & Reconstructed Signal (VBA1 St-t)
Theoretical
Estimated
Rezidual Error
(b) Theoretical and Estimated Signal
Time(h)
0 
24
48
72
Amplitude
-4
-3
-2
-1
0
1
2
3
4
L2 norm: 0.119
Real & Reconstructed Signal (VBA1 St-t)
Theoretical
Estimated
Rezidual Error
(c) Real and Estimated Signal
Figure 5.14: PM (via VBA, partial separability) IGSM Estimation (10dB)
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.02
0.04
0.06
0.08
0.1
Cov Diag Convergency  (VBA1 St-t)
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
(a) diag( bΣ) convergency
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
-0.2
0
0.2
0.4
0.6
0.8
1
PC Convergency  (VBA1 St-t)
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
(b) f convergency
Figure 5.15: PM (via VBA, partial separability) IGSM hyperparameters and f convergency
corresponding to the L2 error reconstruction for the theoretical signal g0, and signal g, are
presented in Figure (5.16b) and Figure (5.16c).
94

Synthetic data 10dB
Number Of Simulations
1
6
Amplitude
0.008
0.01
0.012
0.014
0.016
0.018
0.02
L2 Error PC (VBA1 St)
(a) L2 Error: f vs. bf P M
Number Of Simulations
1
6
Amplitude
0.005
0.01
0.015
0.02
L2 Error Signal Theoretical (VBA1 St)
(b) L2 Error: g0 vs. bgP M
Number Of Simulations
1
6
Amplitude
0.06
0.07
0.08
0.09
0.1
0.11
0.12
L2 Error Signal Real (VBA1 St)
(c) L2 Error: g vs. bgP M
Figure 5.16: PM (via VBA, partial separability) IGSM L2 error measured for 10 different
noise realisations (10dB)
5.2.4
PM (via VBA, full separability) IGSM 10dB
The estimations for the full separability case are also accurate: For the reconstruction of the
theoretical signal g0, the L2 error norm is δg0 = ∥g0−bgP M∥2
2
∥g0∥2
2
= 0.0095. For the PC vector,
the reconstruction error is δf = ∥f −bf P M ∥2
2
∥f ∥2
2
= 0.0103. Figure (5.18a) presents the variation
of L2 PC vector error reconstruction for 10 different noise realisation. The ﬁgure presents a
very small variation of L2 PC vector error reconstruction, between 0.0046 and 0.0168. Very
small variations corresponding to the L2 error reconstruction for the theoretical signal g0, and
signal g, are presented in Figure (5.18b) and Figure (5.18c).
95

5.2.5 - Methods comparison 10dB
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.0103
Theoretical & Estimated PC (VBA2 St-t)
Theoretical
Estimated
(a) Theoretical and Estimated PC
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L2 norm: 0.0095
Theoretical & Reconstructed Signal (VBA2 St-t)
Theoretical
Estimated
Rezidual Error
(b) Theoretical and Estimated Signal
Time(h)
0 
24
48
72
Amplitude
-4
-3
-2
-1
0
1
2
3
4
L2 norm: 0.12
Real & Reconstructed Signal (VBA2 St-t)
Theoretical
Estimated
Rezidual Error
(c) Real and Estimated Signal
Figure 5.17: PM (via VBA, full separability) IGSM Estimation (10dB)
5.2.5
Methods comparison 10dB
The comparison between the estimations corresponding to the proposed IGSM models is pre-
sented in Figure (5.19c) (JMAP estimator), Figure (5.19d) (PM via VBA, partial separability
estimator) and Figure (5.19e) (PM via VBA, full separability estimator). The comparison with
the Gaussian case (i.e. Gaussian prior), via the two estimators discussed, is presented in Fig-
ure (5.19a) (Gaussian Model, JMAP estimator) and Figure (5.19b) (PM via VBA estimator).
A comparison with the FFT is presented in Figure (5.19f).
The L2 estimation error for the PC vector is very high for the two Gaussian models. Also,
the estimations are not sparse. For the IGSM models, the JMAP estimator is providing a
good estimation, but it is unstable. VBA estimator, both partial separable and fully separable
provides very accurate stable estimations.
96

Synthetic data 10dB
Number Of Simulations
1
6
Amplitude
0.004
0.006
0.008
0.01
0.012
0.014
0.016
L2 Error PC (VBA2 St)
(a) Theoretical and Estimated PC
Number Of Simulations
1
6
Amplitude
0.004
0.006
0.008
0.01
0.012
0.014
0.016
0.018
L2 Error Signal Theoretical (VBA2 St)
(b) Theoretical and Estimated Signal
Number Of Simulations
1
6
Amplitude
0.06
0.07
0.08
0.09
0.1
0.11
0.12
L2 Error Signal Real (VBA2 St)
(c) Real and Estimated Signal
Figure 5.18: PM (via VBA, full separability) IGSM L2 error measured for 10 different noise
realisations (10dB)
5.2.6
Error comparison 10dB
The L2 error measurement corresponding to the PC estimation, theoretical signal estimation
and the signal estimation, for 10 different noise realisation is presented in the following ﬁgure:
The L2 error corresponding to the PM via VBA IGSM Model shows the performances of
proposed via algorithm compared to the Gaussian Model and the JMAP estimation for IGSM
Model.
97

5.2.6 - Error comparison 10dB
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
-0.2
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.365
Theoretical & Estimated PC (JMAP G)
Theoretical
Estimated
(a) JMAP Gaussian
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
-0.2
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.363
Theoretical & Estimated PC (VBA G)
Theoretical
Estimated
(b) PM (via VBA) Gaussian
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
-0.2
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.0259
Theoretical & Estimated PC (JMAP St-t)
Theoretical
Estimated
(c) JMAP IGSM
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.0144
Theoretical & Estimated PC (VBA1 St-t)
Theoretical
Estimated
(d) PM (via VBA p. s.) IGSM
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.0103
Theoretical & Estimated PC (VBA2 St-t)
Theoretical
Estimated
(e) PM (via VBA f. s.) IGSM
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
b
fF F T
FFT PC
(f) FFT
Figure 5.19: Methods Comparison (10dB)
98

Synthetic data 10dB
Number Of Simulations
1
6
Amplitude
0
1
2
3
4
5
6
L2 Error PC
JMAP G
VBA G
JMAP St
VBA1 St
VBA2 St
(a) PC error estimation
Number Of Simulations
1
6
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
L2 Error Signal Theoretical
JMAP G
VBA G
JMAP St
VBA1 St
VBA2 St
(b) Theoretical signal error estimation
Number Of Simulations
1
6
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
L2 Error Signal Real
JMAP G
VBA G
JMAP St
VBA1 St
VBA2 St
(c) Signal error estimation (10dB)
Figure 5.20: L2 Errors estimation (10dB)
99

5.3.1 - Data 15dB
5.3 Synthetic data 15dB
In this subsection we present the synthetic data case corresponding to the 15 dB SNR.
5.3.1
Data 15dB
The periodic component vector f, theoretical signal g0 and the signal g are presented in the
following ﬁgure: Figure (5.21a) shows the theoretical PC, set for 11h, 15h and 23h. All
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
f
Theoretical PC
(a) PC vector f
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
cond(H)=56798792591.5098
Theoretical Signal
(b) Theoretical Signal g0
Time(h)
0 
24
48
72
Amplitude
-4
-3
-2
-1
0
1
2
3
g
SNR=15
Real Signal
(c) Signal g
Figure 5.21: f PC vector, theoretical signal g0 and input signal g = g0 + ǫ of the model
(15dB)
the other values in the PC vector are zero. Figure (5.21b) presents the signal corresponding
to the linear model considered in Equation (3), neglecting the errors, g0 = Hf. All the
simulations are done using as the input the noisy signal g, (5.21c) corresponding to the linear
model,Equation (3).
100

Synthetic data 15dB
5.3.2
JMAP IGSM 15dB
A comparison between the synthetic data and the JMAP IGSM estimation is presented in the
Figure (5.22). The theoretical periodic component vector f and the JMAP IGSM estimation
bf JMAP are compared in Figure (5.22a). The reconstruction error is δf = ∥f −bf JMAP ∥2
2
∥f ∥2
2
=
0.0069. The comparison between the estimated bgJMAP and the theoretical signal (without
noise) g0 is presented in in Figure (5.22b). The reconstruction error is δg0 =
∥g0−bgJMAP ∥2
2
∥g0∥2
2
=
0.00692. The comparison between the estimated bgJMAP and the signal g is presented in in
Figure (5.22c). Figure (5.23a) presents the variation of L2 PC vector error reconstruction for
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.0069
Theoretical & Estimated PC (JMAP St-t)
Theoretical
Estimated
(a) Theoretical and Estimated PC
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L2 norm: 0.00692
Theoretical & Reconstructed Signal (JMAP St-t)
Theoretical
Estimated
Rezidual Error
(b) Theoretical and Estimated Signal
Time(h)
0 
24
48
72
Amplitude
-4
-3
-2
-1
0
1
2
3
L2 norm: 0.0298
Real & Reconstructed Signal (JMAP St-t)
Theoretical
Estimated
Rezidual Error
(c) Real and Estimated Signal
Figure 5.22: JMAP IGSM Estimation (15dB)
10 different noise realisation, showing high variations. Important variations corresponding to
the L2 error reconstruction for the theoretical signal g0, and signal g, are presented in Figure
(5.23b) and Figure (5.23c).
101

5.3.3 - PM (via VBA, partial separability) IGSM 15dB
Number Of Simulations
1
6
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
L2 Error PC (JMAP St)
(a) L2 Error: f vs. bfJMAP
Number Of Simulations
1
6
Amplitude
×10-3
4
6
8
10
12
14
L2 Error Signal Theoretical (JMAP St)
(b) L2 Error: g0 vs. bgJMAP
Number Of Simulations
1
6
Amplitude
0.022
0.023
0.024
0.025
0.026
0.027
0.028
0.029
0.03
0.031
L2 Error Signal Real (JMAP St)
(c) L2 Error: g vs. bgJMAP
Figure 5.23: JMAP IGSM L2 error measured for 10 different noise realisations (15dB)
5.3.3
PM (via VBA, partial separability) IGSM 15dB
For the Posterior Mean estimation via VBA, both the PC estimation and theoretical signal g0
reconstruction are very accurate, Figure (5.24a) and Figure (5.24b). For the reconstruction
of the theoretical signal g0, the L2 error norm is δg0 = ∥g0−bgP M∥2
2
∥g0∥2
2
= 0.00513. For the PC
vector, the reconstruction error is δf = ∥f −bf P M∥2
2
∥f ∥2
2
= 0.00437. The algorithm is converging
to a sparse solution where all the non zero clocks are detected. The residual error computed
between g and the reconstructed signal is consistent with the error considered in the model,
15dB, Figure (5.24c). The convergency of Σ covariance matrix diagonal, Figure (5.25a) and
the convergency of algorithm’s solution f, Figure (5.25b) is showing a very fast convergency.
All the estimates are superposed after the ﬁrst ten iterations. We show that for the PM estima-
tion, the error variation is very small. Figure (5.26a) presents the variation of L2 PC vector
error reconstruction for 10 different noise realisation. The ﬁgure presents a very small vari-
ation of L2 PC vector error reconstruction, between 0.003 and 0.01. Very small variations
102

Synthetic data 15dB
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.00513
Theoretical & Estimated PC (VBA1 St-t)
Theoretical
Estimated
(a) Theoretical and Estimated PC
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L2 norm: 0.00437
Theoretical & Reconstructed Signal (VBA1 St-t)
Theoretical
Estimated
Rezidual Error
(b) Theoretical and Estimated Signal
Time(h)
0 
24
48
72
Amplitude
-4
-3
-2
-1
0
1
2
3
L2 norm: 0.0293
Real & Reconstructed Signal (VBA1 St-t)
Theoretical
Estimated
Rezidual Error
(c) Real and Estimated Signal
Figure 5.24: PM (via VBA, partial separability) IGSM Estimation (15dB)
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.02
0.04
0.06
0.08
0.1
Cov Diag Convergency  (VBA1 St-t)
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
(a) diag( bΣ) convergency
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
-0.2
0
0.2
0.4
0.6
0.8
1
PC Convergency  (VBA1 St-t)
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
(b) f convergency
Figure 5.25: PM (via VBA, partial separability) IGSM hyperparameters and f convergency
corresponding to the L2 error reconstruction for the theoretical signal g0, and signal g, are
presented in Figure (5.26b) and Figure (5.26c).
103

5.3.4 - PM (via VBA, full separability) IGSM 15dB
Number Of Simulations
1
6
Amplitude
×10-3
3
4
5
6
7
8
9
10
11
12
L2 Error PC (VBA1 St)
(a) L2 Error: f vs. bfP M
Number Of Simulations
1
6
Amplitude
×10-3
2
3
4
5
6
7
8
9
10
L2 Error Signal Theoretical (VBA1 St)
(b) L2 Error: g0 vs. bgP M
Number Of Simulations
1
6
Amplitude
0.022
0.023
0.024
0.025
0.026
0.027
0.028
0.029
0.03
L2 Error Signal Real (VBA1 St)
(c) L2 Error: g vs. bgP M
Figure 5.26: PM (via VBA, partial separability) IGSM L2 error measured for 10 different
noise realisations (15dB)
5.3.4
PM (via VBA, full separability) IGSM 15dB
The estimations for the full separability case are also accurate: For the reconstruction of the
theoretical signal g0, the L2 error norm is δg0 = ∥g0−bgP M∥2
2
∥g0∥2
2
= 0.00398. For the PC vector,
the reconstruction error is δf = ∥f −bf P M∥2
2
∥f ∥2
2
= 0.00374. Figure (5.28a) presents the variation
of L2 PC vector error reconstruction for 10 different noise realisation. The ﬁgure presents a
very small variation of L2 PC vector error reconstruction, between 0.0037 and 0.027. Very
small variations corresponding to the L2 error reconstruction for the theoretical signal g0, and
signal g, are presented in Figure (5.28b) and Figure (5.28c).
104

Synthetic data 15dB
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.00374
Theoretical & Estimated PC (VBA2 St-t)
Theoretical
Estimated
(a) Theoretical and Estimated PC
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
3
L2 norm: 0.00398
Theoretical & Reconstructed Signal (VBA2 St-t)
Theoretical
Estimated
Rezidual Error
(b) Theoretical and Estimated Signal
Time(h)
0 
24
48
72
Amplitude
-4
-3
-2
-1
0
1
2
3
L2 norm: 0.0294
Real & Reconstructed Signal (VBA2 St-t)
Theoretical
Estimated
Rezidual Error
(c) Real and Estimated Signal
Figure 5.27: PM (via VBA, full separability) IGSM Estimation (15dB)
5.3.5
Methods comparison 15dB
The comparison between the estimations corresponding to the proposed IGSM models is pre-
sented in Figure (5.29c) (JMAP estimator), Figure (5.29d) (PM via VBA, partial separability
estimator) and Figure (5.29e) (PM via VBA, full separability estimator). The comparison with
the Gaussian case (i.e. Gaussian prior), via the two estimators discussed, is presented in Fig-
ure (5.29a) (Gaussian Model, JMAP estimator) and Figure (5.29b) (PM via VBA estimator).
A comparison with the FFT is presented in Figure (5.29f). The L2 estimation error for the PC
vector is very high for the two Gaussian models. Also, the estimations are not sparse. For the
IGSM models, the JMAP estimator is providing a good estimation, but it is unstable. VBA
estimator, both partial separable and fully separable provides very accurate stable estimations.
105

5.3.6 - Error comparison 15dB
Number Of Simulations
1
6
Amplitude
0.005
0.01
0.015
0.02
0.025
L2 Error PC (VBA2 St)
(a) Theoretical and Estimated PC
Number Of Simulations
1
6
Amplitude
×10-3
2
3
4
5
6
7
8
9
L2 Error Signal Theoretical (VBA2 St)
(b) Theoretical and Estimated Signal
Number Of Simulations
1
6
Amplitude
0.022
0.023
0.024
0.025
0.026
0.027
0.028
0.029
0.03
L2 Error Signal Real (VBA2 St)
(c) Real and Estimated Signal
Figure 5.28: PM (via VBA, full separability) IGSM L2 error measured for 10 different noise
realisations (15dB)
5.3.6
Error comparison 15dB
The L2 error measurement corresponding to the PC estimation, theoretical signal estimation
and the signal estimation, for 10 different noise realisation is presented in the following ﬁgure:
106

Synthetic data 15dB
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
-0.2
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.355
Theoretical & Estimated PC (JMAP G)
Theoretical
Estimated
(a) JMAP Gaussian
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
-0.2
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.382
Theoretical & Estimated PC (VBA G)
Theoretical
Estimated
(b) PM (via VBA) Gaussian
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.0069
Theoretical & Estimated PC (JMAP St-t)
Theoretical
Estimated
(c) JMAP IGSM
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.00513
Theoretical & Estimated PC (VBA1 St-t)
Theoretical
Estimated
(d) PM (via VBA p. s.) IGSM
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.2
0.4
0.6
0.8
1
L2 norm: 0.00374
Theoretical & Estimated PC (VBA2 St-t)
Theoretical
Estimated
(e) PM (via VBA f. s.) IGSM
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
b
fF F T
FFT PC
(f) FFT
Figure 5.29: Methods Comparison (15dB)
107

5.3.6 - Error comparison 15dB
Number Of Simulations
1
6
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
L2 Error PC
JMAP G
VBA G
JMAP St
VBA1 St
VBA2 St
(a) PC error estimation
Number Of Simulations
1
6
Amplitude
×10-3
2
4
6
8
10
12
14
L2 Error Signal Theoretical
JMAP G
VBA G
JMAP St
VBA1 St
VBA2 St
(b) Theoretical signal error estimation
Number Of Simulations
1
6
Amplitude
0.021
0.022
0.023
0.024
0.025
0.026
0.027
0.028
0.029
0.03
0.031
L2 Error Signal Real
JMAP G
VBA G
JMAP St
VBA1 St
VBA2 St
(c) Signal error estimation (15dB)
Figure 5.30: L2 Errors estimation (15dB)
108

Student-t PM via VBA vs. LASSO 05dB
5.4 Student-t PM via VBA vs. LASSO 05dB
In this section we compare the performances of the Proposed Method and LASSO, for
SNR=05dB. We consider the theoretical PC amplitude vectors f 1, f 2 and f, deﬁned as
= √f 12 + f 22, the corresponding theoretical (original) signal g0 = H2f 1 + H2f 2 and
the corresponding (noisy) signal g = g0 + ǫ, by adding noise over the theoretical signal.
The considered signal represents a four day signal, sampled every hour. The matrix H1 is
a sine matrix and the matrix H2 is a sine matrix. The data is presented in Figure (5.31):
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.5
1
1.5
2
2.5
3
f
Theoretical PC 1
(a) PC amplitude vector (sin) f1
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.5
1
1.5
2
2.5
3
f
Theoretical PC 2
(b) PC amplitude vector (cos) f 2
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
f
Theoretical PC
(c) f =
p
f 12 + f22
Time(h)
0 
24
48
72
Amplitude
-10
-8
-6
-4
-2
0
2
4
6
8
Theoretical Signal
(d) Original signal g0 = H1f 1 + H2f 2
Time(h)
0 
24
48
72
Amplitude
-10
-5
0
5
10
g
SNR=5
Real Signal
(e) Noisy signal g = g0 + ǫ (05dB)
Time(h)
0 
24
48
72
Amplitude
-6
-4
-2
0
2
4
6
8
g
SNR=5
Noise
(f) Added noise ǫ
Figure 5.31: Synthetic simulation data (05dB): sine PC amplitudes vector f 1, (5.31a), cosine
PC amplitudes vector f 2, (5.31b), PC amplitudes vector f, (5.31c); corresponding original
signal g0 = H1f 1 + H2f 2, (5.31d), noisy signal g, (5.31e) and the added noise (05dB) ǫ
(5.31f)
the PC amplitude vector f 1, corresponding to sine, is presented in Figure (5.31a) and the PC
amplitude vector f 2, corresponding to cosine, is presented in Figure (5.31b). We have consid-
ered sparse vectors, with three periods with non-zero corresponding amplitudes: 11 hours, 15
hours and 23 hours. We have considered for both PC amplitudes vectors f 1 and f 2 the same
109

5.3.6 - Error comparison 15dB
periods with non-zero corresponding amplitudes, but different values for the amplitudes. The
PC amplitude vector f is presented in Figure (5.31c), the corresponding original signal g0 in
Figure (5.31d) and the corresponding noisy signal g in Figure (5.31e). The added noise ǫ,
corresponding to SNR=05dB, is presented in Figure (5.31f). The estimation corresponding
to the Student-t model, with PM estimation, is presented in Figure (5.32). The comparison
between the estimated c
f 1 and f 1 is presented in Figure (5.32a) and the comparison between
the estimated c
f 2 and f 2 is presented in Figure (5.32b). Both estimated PC amplitudes vectors
c
f 1 and c
f 2 are sparse and the non-zero amplitudes are correctly estimated. The L1 and L2
estimation error norms corresponding to f 1 are δf 11 = 0.34 and δf 12 = 0.05; the L1 and
L2 estimation error norms corresponding to f 2 are δf 21 = 0.16 and δf 22 = 0.004. The
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
-0.5
0
0.5
1
1.5
2
2.5
3
L2 norm: 0.0528
L1 norm: 0.34
Theoretical & Estimated PC sin (VBA1-IGSM)
Theoretical
Estimated
(a) PM (via VBA p.s.) c
f1 vs. f 1
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
-0.5
0
0.5
1
1.5
2
2.5
3
3.5
L2 norm: 0.00442
L1 norm: 0.162
Theoretical & Estimated PC cos (VBA1-IGSM)
Theoretical
Estimated
(b) PM (via VBA p.s.) c
f 2 vs. f 2
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
L2 norm: 0.0158
L1 norm: 0.247
Theoretical & Estimated PC (VBA1-IGSM)
Theoretical
Estimated
(c) PM (via VBA p.s.) bf vs. f
Time(h)
0 
24
48
72
Amplitude
-10
-8
-6
-4
-2
0
2
4
6
8
10
L2 norm: 0.0249
L1 norm: 0.159
Theoretical & Reconstructed Signal (VBA1-IGSM)
Theoretical
Estimated
Rezidual Error
(d) PM (via VBA p.s.) c
g0 vs. g0
Time(h)
0 
24
48
72
Amplitude
-6
-4
-2
0
2
4
6
8
Noise & Estimated Noise (VBA1-IGSM)
Noise
Estimated Noise
(e) PM (via VBA p.s.) bǫ vs. ǫ
Figure 5.32: Synthetic simulation (05dB): comparison between the Proposed Method estima-
tions and the synthetic data
comparison between f and bf is presented in Figure (5.32c): the L1 estimation error norm is
δf 1 = 0.247 and the L2 estimation error norm is δf 2 = 0.015. The comparison between
the reconstructed signal bg and g is presented in Figure (5.32d): the reconstruction is fairly
110

Student-t PM via VBA vs. LASSO 05dB
accurate: the L1 reconstruction error norm is δg1 = 0.159 and the L2 reconstruction error
norm is δg2 = 0.024. The estimation corresponding to LASSO is presented in Figure (5.33).
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
-0.5
0
0.5
1
1.5
2
2.5
3
L2 norm: 0.827
L1 norm: 0.875
Theoretical & Estimated PC sin (Lasso)
Theoretical
Estimated
(a) LASSO c
f 1 vs. f 1
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
-0.5
0
0.5
1
1.5
2
2.5
3
L2 norm: 0.496
L1 norm: 0.994
Theoretical & Estimated PC cos (Lasso)
Theoretical
Estimated
(b) LASSO c
f 1 vs. f 1
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
L2 norm: 0.658
L1 norm: 1.05
Theoretical & Estimated PC (Lasso)
Theoretical
Estimated
(c) LASSO bf vs. f
Time(h)
0 
24
48
72
Amplitude
-10
-8
-6
-4
-2
0
2
4
6
8
10
L2 norm: 0.0436
L1 norm: 0.202
Theoretical & Reconstructed Signal (Lasso)
Theoretical
Estimated
Rezidual Error
(d) LASSO bg vs. g
Time(h)
0 
24
48
72
Amplitude
-6
-4
-2
0
2
4
6
8
Noise & Estimated Noise (Lasso)
Noise
Estimated Noise
(e) LASSO bǫ vs. ǫ
Figure 5.33: Synthetic simulation (05dB): comparison between the LASSO estimations and
the synthetic data
The comparison between the estimated c
f 1 and f 1 is presented in Figure (5.33a) and the com-
parison between the estimated c
f 2 and f 2 is presented in Figure (5.33b). Both estimations
have a missing value (i.e. the non-zero amplitude corresponding to 23h hours is estimated as
zero) and both estimations have one ore two false detections: for c
f 1, LASSO is associating
a non-zero amplitude corresponding to 22 hours and for c
f 2 two non-zero amplitudes corre-
sponding to 24 and 25 hours. The L1 and L2 estimation error norms corresponding to f 1
are δf 11 = 0.87 and δf 12 = 0.82 and the L1 and L2 estimation error norms corresponding
to f 2 are δf 11 = 0.49 and δf 12 = 0.99. The comparison between f and bf is presented
in Figure (5.33c): the L2 estimation error norm is δf 2 = 0.65 and the L1 estimation error
norm is δf 1 = 1.05. The comparison between the reconstructed signal bg and g is presented
in Figure (5.33d): the reconstruction is fairly accurate: the L1 reconstruction error norm is
111

5.3.6 - Error comparison 15dB
δg1 = 0.2 and the L2 reconstruction error norm is δg2 = 0.04. To analyse the stability of
Number Of Realisations
1 
4 
7 
10
13
16
19
22
25
28
Error
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
L1 Error Teh Sig VBA vs. LASSO
VBA
LASSO
(a) δg1: Proposed Method vs. LASSO
Number Of Realisations
1 
4 
7 
10
13
16
19
22
25
28
Error
-0.05
0
0.05
0.1
0.15
0.2
L2 Error Teh Sig VBA vs. LASSO
VBA
LASSO
(b) δg2: Proposed Method vs. LASSO
Figure 5.34: Stability: L1 and L2 reconstruction errors (05dB): δg1 and δg2: Proposed
Method vs. LASSO
the Proposed Method and LASSO, we compute the L1 and L2 estimation and reconstruction
errors corresponding to the Proposed Method and LASSO, for 30 noise realisations, in the
same conditions as in Figure (5.31). Figure (5.34) presents the behaviour of the L1 and L2
reconstruction errors corresponding to the original signal g0: Figure (5.34a) compares the
behaviour of L1 reconstruction error corresponding to the original signal, δg1, correspond-
ing to the Proposed Method and LASSO and Figure (5.34b) compares the behaviour of L2
reconstruction error corresponding to the original signal, δg2, corresponding to the Proposed
Method and LASSO. Both methods provide small reconstruction errors, and both methods
are stable. Figure (5.35) presents the behaviour of the L1 and L2 estimation errors for f 1,
f 2 and f: Figure (5.35a) compares the behaviour of L1 estimation error for f 1, δf 11, cor-
responding to the Proposed Method and LASSO and Figure (5.35b) compares the behaviour
of L2 estimation error for f 2, δf 12, corresponding to the Proposed Method and LASSO. The
comparison corresponding to f 2 is presented in Figure (5.35c) (L1) and Figure (5.35d) (L2)
and corresponding to f is presented in Figure (5.35e) (L1) and Figure (5.35f) (L2).
The Proposed Method has better performances compared to LASSO in terms of L1 and L2
estimation errors for the PC amplitudes vector: the associated errors are always smaller than
the ones corresponding to LASSO. Also, in this case, for SNR=05dB the LASSO is unstable.
112

Student-t PM via VBA vs. LASSO 05dB
Number Of Realisations
1 
4 
7 
10
13
16
19
22
25
28
Error
2
4
6
8
10
12
14
L1 Error PC1 VBA vs. LASSO
VBA
LASSO
(a) δf 11: Proposed Method vs. LASSO
Number Of Realisations
1 
4 
7 
10
13
16
19
22
25
28
Error
0
10
20
30
40
50
60
L2 Error PC1 VBA vs. LASSO
VBA
LASSO
(b) δf 12: Proposed Method vs. LASSO
Number Of Realisations
1 
4 
7 
10
13
16
19
22
25
28
Error
2
4
6
8
10
12
14
16
L1 Error PC2 VBA vs. LASSO
VBA
LASSO
(c) δf 21: Proposed Method vs. LASSO
Number Of Realisations
1 
4 
7 
10
13
16
19
22
25
28
Error
0
10
20
30
40
50
60
70
L2 Error PC2 VBA vs. LASSO
VBA
LASSO
(d) δf 22: Proposed Method vs. LASSO
Number Of Realisations
1 
4 
7 
10
13
16
19
22
25
28
Error
2
4
6
8
10
12
14
16
18
L1 Error PC VBA vs. LASSO
VBA
LASSO
(e) δf 2: Proposed Method vs. LASSO
Number Of Realisations
1 
4 
7 
10
13
16
19
22
25
28
Error
0
10
20
30
40
50
60
70
L2 Error PC VBA vs. LASSO
VBA
LASSO
(f) δf 1: Proposed Method vs. LASSO
Figure 5.35: Stability: L1 and L2 estimation errors (05dB): δf 1 and δf 2: Proposed Method
vs. LASSO
113

5.3.6 - Error comparison 15dB
5.5 Student-t PM via VBA vs. LASSO 10dB
In this section we compare the performances of the Proposed Method and LASSO, for
SNR=10dB. We consider the theoretical PC amplitude vectors f 1, f 2 and f, deﬁned as
= √f 12 + f 22, the corresponding theoretical (original) signal g0 = H2f 1 + H2f 2 and
the corresponding (noisy) signal g = g0 + ǫ, by adding noise over the theoretical signal.
The considered signal represents a four day signal, sampled every hour. The matrix H1 is
a sine matrix and the matrix H2 is a sine matrix. The data is presented in Figure (5.36):
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.5
1
1.5
2
2.5
3
f
Theoretical PC 1
(a) PC amplitude vector (sin) f 1
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.5
1
1.5
2
2.5
3
f
Theoretical PC 2
(b) PC amplitude vector (cos) f2
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
f
Theoretical PC
(c) f =
p
f12 + f 22
Time(h)
0 
24
48
72
Amplitude
-10
-8
-6
-4
-2
0
2
4
6
8
Theoretical Signal
(d) Original signal g0 = H1f 1 + H2f2
Time(h)
0 
24
48
72
Amplitude
-10
-8
-6
-4
-2
0
2
4
6
8
10
g
SNR=10
Real Signal
(e) Noisy signal g = g0 + ǫ (01dB)
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
g
SNR=10
Noise
(f) Added noise ǫ
Figure 5.36: Synthetic simulation data (10dB): sine PC amplitudes vector f 1, (5.36a), cosine
PC amplitudes vector f 2, (5.36b), PC amplitudes vector f, (5.36c); corresponding original
signal g0 = H1f 1 + H2f 2, (5.36d), noisy signal g, (5.36e) and the added noise (05dB) ǫ
(5.36f)
the PC amplitude vector f 1, corresponding to sine, is presented in Figure (5.36a) and the PC
amplitude vector f 2, corresponding to cosine, is presented in Figure (5.36b). We have consid-
ered sparse vectors, with three periods with non-zero corresponding amplitudes: 11 hours, 15
hours and 23 hours. We have considered for both PC amplitudes vectors f 1 and f 2 the same
114

Student-t PM via VBA vs. LASSO 10dB
periods with non-zero corresponding amplitudes, but different values for the amplitudes. The
PC amplitude vector f is presented in Figure (5.36c), the corresponding original signal g0 in
Figure (5.36d) and the corresponding noisy signal g in Figure (5.36e). The added noise ǫ,
corresponding to SNR=10dB, is presented in Figure (5.36f). The estimation corresponding
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.5
1
1.5
2
2.5
3
L2 norm: 0.00887
L1 norm: 0.154
Theoretical & Estimated PC sin (VBA1-IGSM)
Theoretical
Estimated
(a) PM (via VBA p.s.) c
f 1 vs. f1
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.5
1
1.5
2
2.5
3
L2 norm: 0.0177
L1 norm: 0.163
Theoretical & Estimated PC cos (VBA1-IGSM)
Theoretical
Estimated
(b) PM (via VBA p.s.) c
f1 vs. f 1
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
L2 norm: 0.0127
L1 norm: 0.158
Theoretical & Estimated PC (VBA1-IGSM)
Theoretical
Estimated
(c) PM (via VBA p.s.) bf vs. f
Time(h)
0 
24
48
72
Amplitude
-10
-8
-6
-4
-2
0
2
4
6
8
L2 norm: 0.01
L1 norm: 0.102
Theoretical & Reconstructed Signal (VBA1-IGSM)
Theoretical
Estimated
Rezidual Error
(d) PM (via VBA p.s.) bg vs. g
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
Noise & Estimated Noise (VBA1-IGSM)
Noise
Estimated Noise
(e) PM (via VBA p.s.) bǫ vs. ǫ
Figure 5.37: Synthetic simulation (10dB): comparison between the Proposed Method estima-
tions and the synthetic data
to the Student-t model, with PM estimation, is presented in Figure (5.37). The comparison
between the estimated c
f 1 and f 1 is presented in Figure (5.37a) and the comparison between
the estimated c
f 2 and f 2 is presented in Figure (5.37b). Both estimated PC amplitudes vectors
c
f 1 and c
f 2 are sparse and the non-zero amplitudes are correctly estimated. The L1 and L2
estimation error norms corresponding to f 1 are δf 11 = 0.15 and δf 12 = 0.008; the L1 and
L2 estimation error norms corresponding to f 2 are δf 21 = 0.16 and δf 22 = 0.017.
The comparison between f and bf is presented in Figure (5.37c): the L1 estimation error
norm is δf 1 = 0.158 and the L2 estimation error norm is δf 2 = 0.012. The comparison
between the reconstructed signal bg and g is presented in Figure (5.37d): the reconstruction is
115

5.3.6 - Error comparison 15dB
fairly accurate: the L1 reconstruction error norm is δg1 = 0.102 and the L2 reconstruction er-
ror norm is δg2 = 0.01. The estimation corresponding to LASSO is presented in Figure (5.38).
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.5
1
1.5
2
2.5
3
L2 norm: 0.26
L1 norm: 0.649
Theoretical & Estimated PC sin (Lasso)
Theoretical
Estimated
(a) LASSO c
f 1 vs. f 1
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.5
1
1.5
2
2.5
3
L2 norm: 0.483
L1 norm: 0.785
Theoretical & Estimated PC cos (Lasso)
Theoretical
Estimated
(b) LASSO c
f1 vs. f 1
Periods
8 
11
14
17
20
23
26
29
32
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
L2 norm: 0.305
L1 norm: 0.749
Theoretical & Estimated PC (Lasso)
Theoretical
Estimated
(c) LASSO bf vs. f
Time(h)
0 
24
48
72
Amplitude
-10
-8
-6
-4
-2
0
2
4
6
8
L2 norm: 0.012
L1 norm: 0.114
Theoretical & Reconstructed Signal (Lasso)
Theoretical
Estimated
Rezidual Error
(d) LASSO bg vs. g
Time(h)
0 
24
48
72
Amplitude
-3
-2
-1
0
1
2
Noise & Estimated Noise (Lasso)
Noise
Estimated Noise
(e) LASSO bǫ vs. ǫ
Figure 5.38: Synthetic simulation (10dB): comparison between the LASSO estimations and
the synthetic data
The comparison between the estimated c
f 1 and f 1 is presented in Figure (5.38a) and the com-
parison between the estimated c
f 2 and f 2 is presented in Figure (5.38b). Both estimations
have a missing value (i.e. the non-zero amplitude corresponding to 23h hours is estimated as
zero) and both estimations have one ore two false detections: for c
f 1, LASSO is associating
a non-zero amplitude corresponding to 22 hours and for c
f 2 two non-zero amplitudes corre-
sponding to 24 and 25 hours. The L1 and L2 estimation error norms corresponding to f 1
are δf 11 = 0.649 and δf 12 = 0.26 and the L1 and L2 estimation error norms corresponding
to f 2 are δf 11 = 0.78 and δf 12 = 0.48. The comparison between f and bf is presented
in Figure (5.38c): the L2 estimation error norm is δf 2 = 0.305 and the L1 estimation error
norm is δf 1 = 0.749. The comparison between the reconstructed signal bg and g is presented
in Figure (5.38d): the reconstruction is fairly accurate: the L1 reconstruction error norm is
116

Student-t PM via VBA vs. LASSO 10dB
δg1 = 0.012 and the L2 reconstruction error norm is δg2 = 0.11. To analyse the stability
Number Of Realisations
1 
4 
7 
10
13
16
19
22
25
28
Error
0
0.05
0.1
0.15
0.2
0.25
L1 Error Teh Sig VBA vs. LASSO
VBA
LASSO
(a) δg1: Proposed Method vs. LASSO
Number Of Realisations
1 
4 
7 
10
13
16
19
22
25
28
Error
-0.08
-0.06
-0.04
-0.02
0
0.02
0.04
0.06
0.08
0.1
0.12
L2 Error Teh Sig VBA vs. LASSO
VBA
LASSO
(b) δg2: Proposed Method vs. LASSO
Figure 5.39: Stability: L1 and L2 reconstruction errors (10dB): δg1 and δg2: Proposed
Method vs. LASSO
of the Proposed Method and LASSO, we compute the L1 and L2 estimation and reconstruc-
tion errors corresponding to the Proposed Method and LASSO, for 30 noise realisations, in
the same conditions as in Figure (5.36). Figure (5.39) presents the behaviour of the L1 and
L2 reconstruction errors corresponding to the original signal g0: Figure (5.39a) compares the
behaviour of L1 reconstruction error corresponding to the original signal, δg1, correspond-
ing to the Proposed Method and LASSO and Figure (5.39b) compares the behaviour of L2
reconstruction error corresponding to the original signal, δg2, corresponding to the Proposed
Method and LASSO. Both methods provide small reconstruction errors, and both methods
are stable. Figure (5.40) presents the behaviour of the L1 and L2 estimation errors for f 1,
f 2 and f: Figure (5.40a) compares the behaviour of L1 estimation error for f 1, δf 11, cor-
responding to the Proposed Method and LASSO and Figure (5.40b) compares the behaviour
of L2 estimation error for f 2, δf 12, corresponding to the Proposed Method and LASSO. The
comparison corresponding to f 2 is presented in Figure (5.40c) (L1) and Figure (5.40d) (L2)
and corresponding to f is presented in Figure (5.40e) (L1) and Figure (5.40f) (L2)
The Proposed Method has better performances compared to LASSO in terms of L1 and
L2 estimation errors for the PC amplitudes vector: the associated errors are always smaller
than the ones corresponding to LASSO.
Finally, we present a comparison between the Proposed Method and LASSO for
different values for the SNR. Figure (5.41a) presents the comparison between the L1
reconstruction norm for g0 corresponding to the Proposed Method and LASSO for
SNR={5dB, 10dB, 15dB, 20dB, 25dB, 30dB, 40dB, 50dB}. The comparison between the L2
reconstruction norm for g0 for the two methods is presented in Figure (5.41b). Figure (5.41c)
and Figure (5.41d) present the comparison between the L1 and L2 reconstruction norm for g
for the two methods.
Figure (5.42a) presents the comparison between the L1 estimation norm for f 1 corre-
sponding
to
the
Proposed
Method
and
LASSO
for
SNR={5dB, 10dB, 15dB, 20dB, 25dB, 30dB, 40dB, 50dB}. The comparison between the L2
reconstruction norm for f 1 for the two methods is presented in Figure (5.42b). Figure (5.42c)
and Figure (5.42d) present the comparison between the L1 and L2 estimation error norm for
f 2 for the two methods and Figure (5.42e) and Figure (5.42f) present the comparison between
the L1 and L2 estimation error norm for f for the two methods.
117

5.3.6 - Error comparison 15dB
Number Of Realisations
1 
4 
7 
10
13
16
19
22
25
28
Error
0
0.2
0.4
0.6
0.8
1
1.2
1.4
L1 Error PC1 VBA vs. LASSO
VBA
LASSO
(a) δf 11: Proposed Method vs. LASSO
Number Of Realisations
1 
4 
7 
10
13
16
19
22
25
28
Error
0
0.2
0.4
0.6
0.8
1
1.2
1.4
L2 Error PC1 VBA vs. LASSO
VBA
LASSO
(b) δf 12: Proposed Method vs. LASSO
Number Of Realisations
1 
4 
7 
10
13
16
19
22
25
28
Error
0
0.2
0.4
0.6
0.8
1
L1 Error PC2 VBA vs. LASSO
VBA
LASSO
(c) δf 21: Proposed Method vs. LASSO
Number Of Realisations
1 
4 
7 
10
13
16
19
22
25
28
Error
0
0.1
0.2
0.3
0.4
0.5
0.6
L2 Error PC2 VBA vs. LASSO
VBA
LASSO
(d) δf 22: Proposed Method vs. LASSO
Number Of Realisations
1 
4 
7 
10
13
16
19
22
25
28
Error
0
0.2
0.4
0.6
0.8
1
1.2
L1 Error PC VBA vs. LASSO
VBA
LASSO
(e) δf 2: Proposed Method vs. LASSO
Number Of Realisations
1 
4 
7 
10
13
16
19
22
25
28
Error
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
L2 Error PC VBA vs. LASSO
VBA
LASSO
(f) δf 1: Proposed Method vs. LASSO
Figure 5.40: Stability: L1 and L2 estimation errors (10dB): δf 1 and δf 2: Proposed Method
vs. LASSO
118

Student-t PM via VBA vs. LASSO 10dB
SNR
5 
10
15
20
25
30
40
50
Error
0
0.05
0.1
0.15
0.2
δ g1 Signal Estimation Error
VBA
LASSO
(a) δg01: Proposed Method vs. LASSO
SNR
5 
10
15
20
25
30
40
50
Error
0
0.005
0.01
0.015
0.02
0.025
0.03
0.035
0.04
0.045
δ g2 Signal Estimation Error
VBA
LASSO
(b) δg02: Proposed Method vs. LASSO
SNR
5 
10
15
20
25
30
40
50
Error
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
0.5
δ g1 Noisy Signal Estimation Error
VBA
LASSO
(c) δg1: Proposed Method vs. LASSO
SNR
5 
10
15
20
25
30
40
50
Error
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.16
0.18
0.2
δ g2 Noisy Signal Estimation Error
VBA
LASSO
(d) δg2: Proposed Method vs. LASSO
Figure 5.41: L1 and L2 estimation errors: δg1 and δg2: Proposed Method vs. LASSO
119

5.3.6 - Error comparison 15dB
SNR
5 
10
15
20
25
30
40
50
Error
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
1.1
δ f1 PC1 Estimation Error
VBA
LASSO
(a) δf 11: Proposed Method vs. LASSO
SNR
5 
10
15
20
25
30
40
50
Error
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
δ f2 PC1 Estimation Error
VBA
LASSO
(b) δf 12: Proposed Method vs. LASSO
SNR
5 
10
15
20
25
30
40
50
Error
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
δ f1 PC2 Estimation Error
VBA
LASSO
(c) δf 11: Proposed Method vs. LASSO
SNR
5 
10
15
20
25
30
40
50
Error
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
0.5
δ f2 PC2 Estimation Error
VBA
LASSO
(d) δf 12: Proposed Method vs. LASSO
SNR
5 
10
15
20
25
30
40
50
Error
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
1.1
δ f1 PC Estimation Error
VBA
LASSO
(e) δf 21: Proposed Method vs. LASSO
SNR
5 
10
15
20
25
30
40
50
Error
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
δ f2 PC Estimation Error
VBA
LASSO
(f) δf 22: Proposed Method vs. LASSO
Figure 5.42: L1 and L2 estimation errors: δf 1 and δf 2: Proposed Method vs. LASSO
120

6
Simulations: Real data
Contents
6.1
CT 502 A1: Photon Absorption and Activity
. . . . . . . . . . . . . . . 122
6.1.1
Dominant Period evolution: Activity . . . . . . . . . . . . . . . . . 123
6.1.2
Dominant Period evolution: Photon . . . . . . . . . . . . . . . . . 127
6.1.3
Conclusions: Dominant Period evolution
. . . . . . . . . . . . . . 131
6.2
CT 502 A2: Photon Absorption and Activity
. . . . . . . . . . . . . . . 132
6.2.1
Dominant Period evolution: Activity . . . . . . . . . . . . . . . . . 132
6.2.2
Dominant Period evolution: Photon . . . . . . . . . . . . . . . . . 137
6.2.3
Conclusions: Dominant Period evolution
. . . . . . . . . . . . . . 140
6.3
CT 502 A3: Photon Absorption and Activity
. . . . . . . . . . . . . . . 142
6.3.1
Dominant Period evolution: Activity . . . . . . . . . . . . . . . . . 142
6.3.2
Dominant Period evolution: Photon . . . . . . . . . . . . . . . . . 146
6.3.3
Conclusions: Dominant Period evolution
. . . . . . . . . . . . . . 150
6.4
CT 502 B1: Photon Absorption and Activity
. . . . . . . . . . . . . . . 151
6.4.1
Dominant Period evolution: Activity . . . . . . . . . . . . . . . . . 152
6.4.2
Dominant Period evolution: Photon . . . . . . . . . . . . . . . . . 156
6.4.3
Conclusions: Dominant Period evolution
. . . . . . . . . . . . . . 161
6.5
CT 502 B2: Photon Absorption and Activity
. . . . . . . . . . . . . . . 161
6.5.1
Dominant Period evolution: Activity . . . . . . . . . . . . . . . . . 162
6.5.2
Dominant Period evolution: Photon . . . . . . . . . . . . . . . . . 164
6.6
CT 502 B3: Photon Absorption and Activity
. . . . . . . . . . . . . . . 168
6.6.1
Dominant Period evolution: Activity . . . . . . . . . . . . . . . . . 169
6.6.2
Dominant Period evolution: Photon . . . . . . . . . . . . . . . . . 172
121

CHAPTER 6. SIMULATIONS: REAL DATA
6.6.3
Conclusions: Dominant Period evolution
. . . . . . . . . . . . . . 177
I
N this chapter we present the simulations corresponding to the real data. The considered
signals are obtained in an experiment performed in 6 male KI/KI Per2::luc mice, aged 10
weeks. Mice were singly housed in RT-BIO and synchronized with LD12:12 for 10 days of
adaptation. D-luciferin ([1.5 mg/mL] was loaded in drink water. Animals were then kept in
DD for 3 days. Vehicle or everolimus (5 mg/kg/d) was daily administered at ZT1 or ZT13
(Zeitgeber time) for 6 days, and then animals were kept in DD for another 4 days. Liver
bioluminescence and mouse rest-activity were monitored every minute during LD12:12 and/or
DD with the RT-BIO photomultiplier tube and infrared sensor respectively. For each mouse,
CT 502 A1 presented in Section (6.1), CT 502 A2 presented in Section (6.2), CT 502 A3
presented in Section (6.3), CT 502 B1 presented in Section (6.4), CT 502 B2 presented in
Section (6.5), CT 502 B3 presented in Section (6.6), every segment of interest, i.e. the LD
segment and the three segments corresponding to the DD, before, during and after treatment,
the PC amplitude vector is obtained using the proposed method and compared with the FFT
estimation, the standard method used today in chronobiology.
6.1 CT 502 A1: Photon Absorption and Activity
In the following we present the results of the proposed method compared with the standard
method used today for analysing the chronobiological signals, the FFT method, on real data,
obtained in experiments performed in male KI/KI Per2::luc mice, aged 10 weeks. This section
is dedicated to the complete study, i.e the study of the physiology, corresponding to the seg-
ment LD (light-dark, 12h-12h), where the mouse was synchronized and DD (total darkness),
the segment corresponding to the before treatment and the study of the behaviour during and
after treatment. For the study, two signals were recorded: the Activity Signal measuring the
activity (movement) of the mouse and the Photon Absorption Signal, measuring the number
of photons absorbed.
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
0
10
20
30
40
50
60
Light-Dark
Before
During
After
A1 Activity All - CT 502 
A1 Activity All - CT 502
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
×105
0
2
4
6
8
10
12
14
16
Light-Dark
Before
During
After
A1 Photon All - CT 502 
A1 Photon All - CT 502
Figure 6.1: CT 502, A1 Mouse: Activity (a) and Photon Absorption (b) raw data
Figure (6.1) presents the raw data corresponding to the Activity signal and Photon Absorp-
tion signal. The signals were recorded for 22 days, sampled every minute. For each signal,
we consider 4 segments: LD Period, corresponding to the synchronization part, then three
parts corresponding to the DD period: before, during and after treatment. We are interested
in the periodic component (PC) vector corresponding to each signal and in the corresponding
acrophase. The stability of the period is veriﬁed using the moving window strategy, where the
available data allows.
122

CT 502 A1: Photon Absorption and Activity
6.1.1
Dominant Period evolution: Activity
We start the analysis with the signal corresponding to the Activity. We consider zero-mean
signals, normalized between [-10:10] and sampled every hour.
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
0
10
20
30
40
50
60
Light-Dark
Before
During
After
A1 Activity All - CT 502 
A1 Activity All - CT 502
Number of days
0
1
2
3
4
5
6
Amplitude
-4
-2
0
2
4
6
8
10
A1 Activity LD - R2 Norm - CT 502 
A1 Activity LD - R2 Norm - CT 502
Number of days
0
1
2
Amplitude
-4
-2
0
2
4
6
8
10
A1 Activity Before - DD - R2Norm - CT 502 
A1 Activity Before - DD - R2Norm - CT 502
Number of days
0
1
2
3
4
Amplitude
-2
0
2
4
6
8
10
A1 Activity During - DD - R2Norm - CT 502 
A1 Activity During - DD - R2Norm - CT 502
Number of days
0
1
Amplitude
-2
0
2
4
6
8
10
A1 Activity After - DD - R2Norm - CT 502 
A1 Activity After - DD - R2Norm - CT 502
Figure 6.2: Activity raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-
hour sampled
For the LD part, 7 days are available. We compute the PC corresponding to the signal
using the Proposed Method and also using the FFT: Via the FFT method, the principal period
Number of days
0
1
2
3
4
5
6
Amplitude
-4
-2
0
2
4
6
8
10
CT 502 A1 Activity WinComp Signal
CT 502 A1 Activity WinComp Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
CT 502 A1 Activity WinComp VBA
Periods
11.2 
12   
12.92
14   
15.27
16.8 
18.66
21   
24   
28   
33.6 
42   
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
b
fF F T
CT 502 A1 Activity WinComp FFT
Figure 6.3: Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
is estimated at 24 hours. Evidently, beside the incertitude associated with the FFT estimated
PC, the existence of other rhythms can’t be established, being difﬁcult to interpret all the
picks present in the estimated PC. Via the Proposed Method, the principal period is estimated
at 23 hours.The amplitude corresponding to the 23h period via the Proposed Method is much
higher.
We consider now 4-days length signals (windows) from the available signal, with a shift
of one day and compute the PC via FFT and the Proposed method. Via the Proposed Method,
three windows present a 23 hours periodicity and for one window, a 24 hours periodicity
is detected. Via FFT method the principal period seems stable, every window presenting a
dominant period of 24 hours. This result is consistent with the PC estimation via Proposed
method, when all the signal was considered.
The stability or variability of the PC amplitudes vector for the LD part of the Activity
signal is presented in Figure (6.5):
123

6.1.1 - Dominant Period evolution: Activity
Number of days
0
1
2
3
Amplitude
-4
-2
0
2
4
6
8
CT 502 A1 Activity Win1 Signal
CT 502 A1 Activity Win1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
CT 502 A1 Activity Win1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
3
b
fF F T
CT 502 A1 Activity Win1 FFT
Number of days
1
2
3
4
Amplitude
-4
-2
0
2
4
6
8
10
CT 502 A1 Activity Win2 Signal
CT 502 A1 Activity Win2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 A1 Activity Win2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 A1 Activity Win2 FFT
Number of days
2
3
4
5
Amplitude
-2
0
2
4
6
8
10
CT 502 A1 Activity Win3 Signal
CT 502 A1 Activity Win3 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 A1 Activity Win3 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 A1 Activity Win3 FFT
Number of days
3
4
5
6
Amplitude
-2
0
2
4
6
8
10
CT 502 A1 Activity Win4 Signal
CT 502 A1 Activity Win4 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
CT 502 A1 Activity Win4 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
3
b
fF F T
CT 502 A1 Activity Win4 FFT
Figure 6.4: PC Stability: PC estimation via FFT and VBA for 4-days length signals
Figure 6.5: PC Stability: Proposed Method (a) vs. FFT (b)
124

CT 502 A1: Photon Absorption and Activity
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented in the Figure (6.6):
Figure 6.6: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
We consider now the DD period. First, we consider the before treatment segment. Only
3 days are available for this segment. We compute the PC vector, using FFT and Proposed
Method, (6.7): Via the FFT, the highest pick is set at 24 hours and the next three highest
Number of days
0
1
2
Amplitude
-4
-2
0
2
4
6
8
10
CT 502 A1 Activity DDBef Signal
CT 502 A1 Activity DDBef Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
CT 502 A1 Activity DDBef VBA
Periods
6    
6.54 
7.2  
8    
9    
10.28
12   
14.4 
18   
24   
36   
Amplitude
0
0.5
1
1.5
2
2.5
3
b
fF F T
CT 502 A1 Activity DDBef FFT
Figure 6.7: DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
picks are set at 8, 36 and 6 hours. Of course, given the short length of the signal, 3 days,
and the limitations of the FFT method all the values inside the interval (18,36) except 24 are
not present in the estimated vector, so the result presents a very important uncertainty. This
means that for this particular case, even the classiﬁcation of the rhythm (circadian or infradian)
is uncertain via FFT. Via the Proposed method the dominant period is set at 22 hours and the
other pick present in the PC vector correspond to 8 hours.
We consider the during treatment part of the data, for which ﬁve days are available, Fig-
ure (6.8). Via the proposed method, the estimated PC vector is a sparse vector, in accordance
Number of days
0
1
2
3
4
Amplitude
-2
0
2
4
6
8
10
CT 502 A1 Activity DDDur Signal
CT 502 A1 Activity DDDur Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
CT 502 A1 Activity DDDur VBA
Periods
8    
8.57 
9.23 
10   
10.9 
12   
13.33
15   
17.14
20   
24   
30   
Amplitude
0
0.5
1
1.5
2
b
fF F T
CT 502 A1 Activity DDDur FFT
Figure 6.8: DD during signal (a) and the corresponding PC via VBA (b) and FFT (c)
with the model and the dominant period is estimated at 25 hours. For the FFT estimated PC
vector, the dominant period is estimated at 24 hours, but the estimation is not sparse. In this
case, the next two important picks correspond to 8 and 12 hours, harmonics of 24 hours. We
consider now 4-days length signals (windows) from the available signal, with a shift of one
day and compute the PC via FFT and the Proposed method. In this case, analysing the during
125

6.1.1 - Dominant Period evolution: Activity
Number of days
0
1
2
3
Amplitude
-2
0
2
4
6
8
10
CT 502 A1 Activity DDDurWin1 Signal
CT 502 A1 Activity DDDurWin1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
CT 502 A1 Activity DDDurWin1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
b
fF F T
CT 502 A1 Activity DDDurWin1 FFT
Number of days
1
2
3
4
Amplitude
-2
0
2
4
6
8
10
CT 502 A1 Activity DDDurWin2 Signal
CT 502 A1 Activity DDDurWin2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
CT 502 A1 Activity DDDurWin2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
b
fF F T
CT 502 A1 Activity DDDurWin2 FFT
Figure 6.9: PC Stability: PC estimation via FFT and VBA for 4-days length signals, Activity
DD, during
segment using the moving window we note that via the Proposed Method a variability of the
dominant period is detected, while via FFT the dominant period seems stable. This can be
viewed in Figure (6.10). An image of dominant period stability or variability, regardless the
Figure 6.10: PC Stability: Proposed Method (a) vs. FFT (b)
numerical value of the amplitude associated with the dominant period for during segment is
presented in Figure (6.11):
Figure 6.11: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
For the after treatment part of the data 2 days are available. Via the FFT estimation, the
dominant period is 24 hours, while via the proposed method the dominant period is 25 hours.
The evolution of the dominant period, estimated via the Proposed Method and FFT, during
the complete Activity signal, for each segment of interest and for four-days length signals for
the segments that allowed this analysis is presented in Table (6.1).
126

CT 502 A1: Photon Absorption and Activity
Number of days
0
1
Amplitude
-2
0
2
4
6
8
10
CT 502 A1 Activity DDAft Signal
CT 502 A1 Activity DDAft Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 A1 Activity DDAft VBA
Periods
6   
6.85
8   
9.6 
12  
16  
24  
48  
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 A1 Activity DDAft FFT
Figure 6.12: DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
CT 502 - A1
Dominant Period - Proposed Method
Dominant Period - FFT
LD complete
23
24
LD win 1
23
24
LD win 2
23
24
LD win 3
24
24
LD win 4
23
24
DD before
22
24
DD during
25
24
DD during win 1
25
24
DD during win 2
24
24
DD after
25
24
Table 6.1: CT 502 A1: Activity Dominant Period Stability: Proposed Method vs. FFT
6.1.2
Dominant Period evolution: Photon
In this section we analyse the signal corresponding to the photon absorption, i.e. the gene
expression. Like before, we consider mean-zero signals, normalized between [-10:10] and
sampled every hour. In this case, the analysis corresponding to the LD part has no biological
interest, since the RT-BIO photomultiplier will not record the mouse liver bioluminescence
but the light inside cage corresponding to the 12 hours of light.
The complete Photon absorption signal and the four segments of interest are presented in
Figure (6.13).
For the LD part, 7 days are available. We compute the PC corresponding to the signal
using the Proposed Method and also using the FFT: Via the FFT method, the principal period
is estimated at 24 hours. In particular, in this case, the FFT method estimates a sparse PC
amplitudes vector, and along with the 24 hours, a non-zero peak is detected corresponding to
8 hours. Very similar results are obtained in this case via the Proposed Method: the principal
period is also estimated at 24 hours, together with the harmonic of 8 hours. However, the
amplitude corresponding to the Proposed Method is much higher.
We consider now 4-days length signals (windows) from the available signal, with a shift
of one day and compute the PC via FFT and the Proposed method, Figure (6.15). For all
the windows, a 24 hours periodicity is conﬁrmed, via the two methods, with a harmonic
corresponding to 8 hours, Figure (6.16). Once again, for this segment, there is no biological
interpretation.
127

6.1.2 - Dominant Period evolution: Photon
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
×105
0
2
4
6
8
10
12
14
16
Light-Dark
Before
During
After
A1 Photon All - CT 502 
A1 Photon All - CT 502
Number of days
0
1
2
3
4
5
6
Amplitude
-6
-4
-2
0
2
4
6
8
10
A1 Photon LD - R2 Norm - CT 502 
A1 Photon LD - R2 Norm - CT 502
Number of points
0
Amplitude
-2
0
2
4
6
8
10
A1 Photon Before - DD - R2Norm -CT 502 
A1 Photon Before - DD - R2Norm -CT 502
Number of points
0
Amplitude
-2
0
2
4
6
8
10
A1 Photon During - DD - R2Norm -CT 502 
A1 Photon During - DD - R2Norm -CT 502
Number of points
0
Amplitude
-5
0
5
10
A1 Photon After - DD - R2Norm -CT 502 
A1 Photon After - DD - R2Norm -CT 502
Figure 6.13: Photon raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-
hour sampled
Number of days
0
1
2
3
4
5
6
Amplitude
-6
-4
-2
0
2
4
6
8
CT 502 A1 Photon WinComp Signal
CT 502 A1 Photon WinComp Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
9
CT 502 A1 Photon WinComp VBA
Periods
7.63 
8    
8.4  8.84 9.33 9.88 10.5 11.2 12   12.92 14   15.27 16.8 18.66 21   
24   
28   33.6 
Amplitude
0
1
2
3
4
5
6
7
8
9
b
fF F T
CT 502 A1 Photon WinComp FFT
Figure 6.14: Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
Number of days
0
1
2
3
Amplitude
-6
-4
-2
0
2
4
6
8
CT 502 A1 Photon Win1 Signal
CT 502 A1 Photon Win1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
9
CT 502 A1 Photon Win1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
1
2
3
4
5
6
7
8
9
b
fF F T
CT 502 A1 Photon Win1 FFT
Number of days
1
2
3
4
Amplitude
-6
-4
-2
0
2
4
6
8
CT 502 A1 Photon Win2 Signal
CT 502 A1 Photon Win2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
9
CT 502 A1 Photon Win2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
1
2
3
4
5
6
7
8
9
b
fF F T
CT 502 A1 Photon Win2 FFT
Number of days
2
3
4
5
Amplitude
-6
-4
-2
0
2
4
6
8
CT 502 A1 Photon Win3 Signal
CT 502 A1 Photon Win3 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
9
10
CT 502 A1 Photon Win3 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
1
2
3
4
5
6
7
8
9
10
b
fF F T
CT 502 A1 Photon Win3 FFT
Number of days
3
4
5
6
Amplitude
-6
-4
-2
0
2
4
6
8
CT 502 A1 Photon Win4 Signal
CT 502 A1 Photon Win4 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
9
10
CT 502 A1 Photon Win4 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
1
2
3
4
5
6
7
8
9
10
b
fF F T
CT 502 A1 Photon Win4 FFT
Figure 6.15: PC Stability: PC estimation via FFT and VBA for 4-days length signals
128

CT 502 A1: Photon Absorption and Activity
Figure 6.16: PC Stability: Proposed Method (a) vs. FFT (b)
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented in Figure (6.17):
Figure 6.17: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
We consider now the DD period. First, we consider the before treatment segment. How-
ever, in this case the signal is corrupted, Figure (6.18):
Number of days
0
1
2
Amplitude
-2
0
2
4
6
8
10
CT 502 A1 Photon DDBef Signal
CT 502 A1 Photon DDBef Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 A1 Photon DDBef VBA
Periods
6    
6.54 
7.2  
8    
9    
10.28
12   
14.4 
18   
24   
36   
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 A1 Photon DDBef FFT
Figure 6.18: DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
We consider the during treatment part of the data. Five days are available, Figure (6.19).
Via FFT method, the dominant period is estimated at 24 hours, with important peaks corre-
sponding to 17, 10 and 30 hours. Via the Proposed Method, the PC amplitudes vector detects
three peaks: the dominant period is set at 26 hours and non-zero peaks are also detected for
17 and 23 hours.
The analysis of the during segment using the moving window is presented in Fig-
ure (6.20).
The visual representation of the variability of the PC amplitude vector via the two methods
is presented in Figure (6.21).
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented in Figure (6.22).
We consider the after treatment part of the data, two days length signal, Figure (6.23). In
129

6.1.2 - Dominant Period evolution: Photon
Number of days
0
1
2
3
4
Amplitude
-2
0
2
4
6
8
10
CT 502 A1 Photon DDDur Signal
CT 502 A1 Photon DDDur Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
CT 502 A1 Photon DDDur VBA
Periods
8    
8.57 
9.23 
10   
10.9 
12   
13.33
15   
17.14
20   
24   
30   
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
b
fF F T
CT 502 A1 Photon DDDur FFT
Figure 6.19: DD during signal (a) and the corresponding PC via VBA (b) and FFT (c)
Number of days
0
1
2
3
Amplitude
-2
0
2
4
6
8
10
CT 502 A1 Photon DDDurWin1 Signal
CT 502 A1 Photon DDDurWin1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
CT 502 A1 Photon DDDurWin1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
b
fF F T
CT 502 A1 Photon DDDurWin1 FFT
Number of days
1
2
3
4
Amplitude
-2
0
2
4
6
8
CT 502 A1 Photon DDDurWin2 Signal
CT 502 A1 Photon DDDurWin2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
CT 502 A1 Photon DDDurWin2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
b
fF F T
CT 502 A1 Photon DDDurWin2 FFT
Figure 6.20: PC Stability: PC estimation via FFT and VBA for 4-days length signals, Photon
DD, during
Figure 6.21: PC Stability: Proposed Method (a) vs. FFT (b)
Figure 6.22: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
Number of days
0
1
Amplitude
-5
0
5
10
CT 502 A1 Photon DDAft Signal
CT 502 A1 Photon DDAft Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
4
CT 502 A1 Photon DDAft VBA
Periods
6   
6.85
8   
9.6 
12  
16  
24  
48  
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
4
b
fF F T
CT 502 A1 Photon DDAft FFT
Figure 6.23: DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
130

CT 502 A1: Photon Absorption and Activity
CT 502 - A1
Dominant Period - Proposed Method
Dominant Period - FFT
LD complete
24
24
LD win 1
24
24
LD win 2
24
24
LD win 3
24
24
LD win 4
24
24
DD before
-
-
DD during
-
-
DD during win 1
-
-
DD during win 2
24
24
DD after
24
24
Table 6.2: CT 502 A1: Photon Absorption Dominant Period Stability: Proposed Method vs.
FFT
this case, the dominant period is estimated at 24 hours both via FFT and the Proposed Method.
The evolution of the dominant period, estimated via the Proposed Method and FFT, during
the complete Photon absorption signal, for each segment of interest and for four-days length
signals for the segments that allowed this analysis is presented in Table (6.2).
6.1.3
Conclusions: Dominant Period evolution
We have compared the FFT and Proposed Method PC amplitude vector evolution during the
four segments of interest for mouse CT 503 A1, considering the gene expression (Photon
Absorption signal) and the rest-activity patters (Activity signal), Figure (6.1). For both data,
we have considered four segments of interest, i.e. the LD part of the signal, corresponding to
the synchronization and the DD part of the signal, corresponding to the complete darkness,
for which we have considered the segments corresponding to the before, during and after
treatment phase, Figure (6.2) (rest-activity patterns) and Figure (6.13).
In particular, for the ﬁrst segment of interest, i.e. the LD part of data and for the dur-
ing treatment part, we have considered four days length signals to analyse the stability or
variability of the dominant period for the considered segment itself.
For the gene expression (photon absorption signal), we have presented the results corre-
sponding to each segment, but we haven’t considered the DD before and during treatment
parts of the data, since the corresponding signals are corrupted. The dominant period evolu-
tion, corresponding to the Proposed Method and FFT, is presented in Table (6.2). In this case,
via both methods, the dominant period is 24 hours and is stable during the signal. We note
that while the FFT approach do not give a sufﬁcient precision, the results are in accordance,
in the sense that generally, the peaks that appear in the PC amplitude vector estimated via
the Proposed Method, have corresponding important peaks in the FFT PC amplitude vector.
For the gene expression data, for the LD part, we note that both methods detect the dominant
period at 24 hours and the 8 hours harmonic.
The dominant period evolution, corresponding to the Proposed Method and FFT for the
131

6.2.1 - Dominant Period evolution: Activity
rest-activity patterns (Activity) signal is presented in Table (6.1). In this case, via FFT method
the dominant period is 24 hours for each segment and the evolution of the dominant period
seems to be stable. However, via the Proposed Method, the dominant period has certain
variation around 24 hours.
In particular, via the Proposed Method, for the rest-activity patterns, the dominant period
for the LD segment was estimated at 23 hours, Figure (6.3) (for three windows corresponding
to LD part of the signal, the dominant period is estimated at 23 hours and for one window
is estimated at 24 hours, Figure (6.5)). Furthermore, for the ﬁrst three days of complete
darkness, corresponding to the before treatment part of the signal, via the Proposed Method
the circadian rhythm seems to be perturbed: the dominant period is estimated at 22 hours,
Figure (6.7) and then, for the during and after treatment parts of the data, the dominant
period becomes 25 hours, Figure (6.8) and Figure (6.12).
6.2 CT 502 A2: Photon Absorption and Activity
This section presents the comparison between the Proposed Method and the FFT method, for
another experiment, performed in the same conditions as the one presented in Section (6.1).
For the study, two signals are recorded: the Activity signal measuring the rest-patterns
(movement) of the mouse and the Photon absorption signal, measuring the number of pho-
tons absorbed, i.e. the gene expression. Figure (6.24) presents the raw data corresponding
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
0
10
20
30
40
50
60
LD Period
Before DD
During DD
After DD
A2 Activity All - CT 502 
A2 Activity All - CT 502
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
×105
0
2
4
6
8
10
12
LD Period
Before DD
During DD
After DD
A2 Photon All - CT 502 
A2 Photon All - CT 502
Figure 6.24: CT 502, A2 Mouse: Activity (a) and Photon Absorption (b) raw data
to the Activity signal and Photon Absorption signal. The signals were recorded for 22 days,
sampled every minute. Like in Section (6.1), for each signal, we consider the same 4 seg-
ments: LD Period, corresponding to the synchronization part, then three parts corresponding
to the DD period: before, during and after treatment. We are interested in the periodic com-
ponent (PC) vector corresponding to each signal. The stability of the period is veriﬁed using
the moving window strategy, where the available data allows.
6.2.1
Dominant Period evolution: Activity
We present the analysis with the signal corresponding to the Activity. We will consider mean-
zero signals, normalized between [-10:10] and sampled every hour, Figure (6.25).
For the LD part, 7 days are available. We compute the PC corresponding to the signal
using the Proposed Method and also using the FFT, Figure (6.26): Via the FFT method, two
principal periods are detected: 24 and 21 hours. Via the Proposed method, the two principal
periods detected are 23 and 21 hours.
132

CT 502 A2: Photon Absorption and Activity
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
0
10
20
30
40
50
60
LD Period
Before DD
During DD
After DD
A2 Activity All - CT 502 
A2 Activity All - CT 502
Number of days
0
1
2
3
4
5
6
Amplitude
-2
0
2
4
6
8
10
A2 Activity LD - R2 Norm - CT 502 
A2 Activity LD - R2 Norm - CT 502
Number of days
0
1
2
Amplitude
-2
0
2
4
6
8
10
A2 Activity Before - DD - R2Norm - CT 502 
A2 Activity Before - DD - R2Norm - CT 502
Number of days
0
1
2
3
4
Amplitude
-1
0
1
2
3
4
5
6
7
8
9
10
A2 Activity During - DD - R2Norm - CT 502 
A2 Activity During - DD - R2Norm - CT 502
Number of days
0
1
Amplitude
-4
-2
0
2
4
6
8
10
A2 Activity After - DD - R2Norm - CT 502 
A2 Activity After - DD - R2Norm - CT 502
Figure 6.25: Activity raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-
hour sampled
Number of days
0
1
2
3
4
5
6
Amplitude
-2
0
2
4
6
8
10
CT 502 A2 Activity WinComp Signal
CT 502 A2 Activity WinComp Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
CT 502 A2 Activity WinComp VBA
Periods
11.2 
12   
12.92
14   
15.27
16.8 
18.66
21   
24   
28   
33.6 
42   
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
b
fF F T
CT 502 A2 Activity WinComp FFT
Figure 6.26: Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
We consider four days length signals (windows) from the available LD signal, with a
shift of one day and compute the PC via FFT and the Proposed method, Figure (6.27). Via
FFT method, the dominant period is 24 hours for all windows, therefore stable. Via the
Proposed Method, the dominant period is different for each window: 21, 22, 23 and 25 hours,
Figure (6.28). An image of dominant period stability or variability, regardless the numerical
value of the amplitude associated with the dominant period is presented in Figure (6.29): For
the DD period, we consider ﬁrst the before treatment segment. Only 3 days are available
for this segment. We compute the PC vector, using FFT and Proposed Method, Figure (6.30):
The estimation corresponding to the FFT method, the dominant peak corresponds to 24 hours,
and the next important peak corresponds to 14 hours. For the estimation corresponding to the
Proposed Method, the PC amplitude vector is sparse, with two non-zero peaks, corresponding
to 24 and 14 hours.
For the during treatment part of the data, ﬁve days are available. The comparison between
the Proposed Method and FFT is presented in Figure (6.31). The estimation corresponding
to the FFT method sets the dominant period at 12 hours, with important peaks corresponding
to 30, 24 and 12 hours. Via the Proposed Method, the dominant period is set at 32 hours,
and the other non-zero amplitudes in the PC amplitudes vector corresponds to 25 and 12
hours. We note that in this case, a certain consistency between the two results is shown: both
methods detect an important peak at 12 hours, an important peak around 24 hours (25 hours
for the Proposed Method) and the dominant period in the infradian domain (i.e. superior to
30 hours).
The analysis of the during segment using the moving window is presented in Fig-
133

6.2.1 - Dominant Period evolution: Activity
Number of days
0
1
2
3
Amplitude
-3
-2
-1
0
1
2
3
4
5
6
7
CT 502 A2 Activity Win1 Signal
CT 502 A2 Activity Win1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 A2 Activity Win1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 A2 Activity Win1 FFT
Number of days
1
2
3
4
Amplitude
-2
0
2
4
6
8
CT 502 A2 Activity Win2 Signal
CT 502 A2 Activity Win2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
CT 502 A2 Activity Win2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
3
b
fF F T
CT 502 A2 Activity Win2 FFT
Number of days
2
3
4
5
Amplitude
-2
0
2
4
6
8
10
CT 502 A2 Activity Win3 Signal
CT 502 A2 Activity Win3 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 A2 Activity Win3 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 A2 Activity Win3 FFT
Number of days
3
4
5
6
Amplitude
0
2
4
6
8
10
CT 502 A2 Activity Win4 Signal
CT 502 A2 Activity Win4 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
CT 502 A2 Activity Win4 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
b
fF F T
CT 502 A2 Activity Win4 FFT
Figure 6.27: PC Stability: PC estimation via FFT and VBA for 4-days length signals
Figure 6.28: PC Stability: Proposed Method (a) vs. FFT (b)
Figure 6.29: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
Number of days
0
1
2
Amplitude
-2
0
2
4
6
8
10
CT 502 A2 Activity DDBef Signal
CT 502 A2 Activity DDBef Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 A2 Activity DDBef VBA
Periods
6    
6.54 
7.2  
8    
9    
10.28
12   
14.4 
18   
24   
36   
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 A2 Activity DDBef FFT
Figure 6.30: DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
134

CT 502 A2: Photon Absorption and Activity
Number of days
0
1
2
3
4
Amplitude
-1
0
1
2
3
4
5
6
7
8
9
10
CT 502 A2 Activity DDDur Signal
CT 502 A2 Activity DDDur Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
CT 502 A2 Activity DDDur VBA
Periods
8    
8.57 
9.23 
10   
10.9 
12   
13.33
15   
17.14
20   
24   
30   
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
b
fF F T
CT 502 A2 Activity DDDur FFT
Figure 6.31: DD during signal (a) and the corresponding PC via VBA (b) and FFT (c)
ure (6.32). For the ﬁrst window, via the two methods, the dominant period is 32 hours, placing
Number of days
0
1
2
3
Amplitude
-2
0
2
4
6
8
CT 502 A2 Activity DDDurWin1 Signal
CT 502 A2 Activity DDDurWin1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
CT 502 A2 Activity DDDurWin1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
b
fF F T
CT 502 A2 Activity DDDurWin1 FFT
Number of days
1
2
3
4
Amplitude
-1
0
1
2
3
4
5
6
7
CT 502 A2 Activity DDDurWin2 Signal
CT 502 A2 Activity DDDurWin2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
CT 502 A2 Activity DDDurWin2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
b
fF F T
CT 502 A2 Activity DDDurWin2 FFT
Figure 6.32: PC Stability: PC estimation via FFT and VBA for 4-days length signals, Activity
DD, during
the rhythm in the ultradian domain. For the second window, both methods are placing the
rhythm in the circadian domain: via the FFT, the domaint period is detected at 24 hours, and
via the Proposed Method at 23 hours, Figure (6.33).
Figure 6.33: PC Stability: Proposed Method (a) vs. FFT (b)
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented in Figure (6.34):
We consider the after treatment part of the data, for which two days are available, Fig-
ure (6.35).
Via the Proposed Method, the dominant period is estimated at 23 hours, while via the FFT,
the dominant period is estimated at 24 hours.
The evolution of the dominant period, estimated via the Proposed Method and FFT, during
the complete Activity signal, for each segment of interest and for four-days length signals for
the segments that allowed this analysis is presented in Table (6.3).
135

6.2.1 - Dominant Period evolution: Activity
Figure 6.34: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
Number of days
0
1
Amplitude
-4
-2
0
2
4
6
8
10
CT 502 A2 Activity DDAft Signal
CT 502 A2 Activity DDAft Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 A2 Activity DDAft VBA
Periods
6   
6.85
8   
9.6 
12  
16  
24  
48  
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 A2 Activity DDAft FFT
Figure 6.35: DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
CT 502 - A2
Dominant Period - Proposed Method
Dominant Period - FFT
LD complete
23
21
LD win 1
21
24
LD win 2
22
24
LD win 3
23
24
LD win 4
25
24
DD before
24
24
DD during
32
12
DD during win 1
32
32
DD during win 2
23
24
DD after
23
24
Table 6.3: CT 502 A2: Activity Dominant Period Stability: Proposed Method vs. FFT
136

CT 502 A2: Photon Absorption and Activity
6.2.2
Dominant Period evolution: Photon
In this section we analyse the signal corresponding to the photon absorption, i.e. the gene
expression. Like before, we consider mean-zero signals, normalized between [-10:10] and
sampled every hour. In this case, the analysis corresponding to the LD part has no biological
interest, since the RT-BIO photomultiplier will not record the mouse liver bioluminescence but
the light inside cage corresponding to the 12 hours of light. The complete Photon absorption
signal and the four segments of interest are presented in Figure (6.36).
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
×105
0
2
4
6
8
10
12
LD Period
Before DD
During DD
After DD
A2 Photon All - CT 502 
A2 Photon All - CT 502
Number of days
0
1
2
3
4
5
6
Amplitude
-8
-6
-4
-2
0
2
4
6
8
10
A2 Photon LD - R2 Norm - CT 502 
A2 Photon LD - R2 Norm - CT 502
Number of points
0
Amplitude
-2
0
2
4
6
8
10
A2 Photon Before - DD - R2Norm -CT 502 
A2 Photon Before - DD - R2Norm -CT 502
Number of points
0
Amplitude
-2
0
2
4
6
8
10
A2 Photon During - DD - R2Norm -CT 502 
A2 Photon During - DD - R2Norm -CT 502
Number of points
0
Amplitude
-5
0
5
10
A2 Photon After - DD - R2Norm -CT 502 
A2 Photon After - DD - R2Norm -CT 502
Figure 6.36: Photon raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-
hour sampled
For the LD part, 8 days are available. We compute the PC corresponding to the signal
using the Proposed Method and also using the FFT, Figure (6.37): Via the FFT method, the
Number of days
0
1
2
3
4
5
6
Amplitude
-8
-6
-4
-2
0
2
4
6
8
10
CT 502 A2 Photon WinComp Signal
CT 502 A2 Photon WinComp Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
2
4
6
8
10
CT 502 A2 Photon WinComp VBA
Periods
7.63 
8    
8.4  8.84 9.33 9.88 10.5 11.2 12   12.92 14   15.27 16.8 18.66 21   
24   
28   33.6 
Amplitude
0
2
4
6
8
10
b
fF F T
CT 502 A2 Photon WinComp FFT
Figure 6.37: Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
principal period is estimated at 24 hours. Via the Proposed Method, the principal period is
also estimated at 24 hours, together with the harmonic of 8 hours. However, the amplitude
corresponding to the Proposed Method is much higher.
We consider now 4-days length signals (windows) from the available signal, with a shift
of one day and compute the PC via FFT and the Proposed method, Figure (6.38).
For all the windows, a 24 hours periodicity is conﬁrmed, via the two methods, Fig-
ure (6.39).
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented in Figure (6.40):
137

6.2.2 - Dominant Period evolution: Photon
Number of days
0
1
2
3
Amplitude
-8
-6
-4
-2
0
2
4
6
8
CT 502 A2 Photon Win1 Signal
CT 502 A2 Photon Win1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
2
4
6
8
10
CT 502 A2 Photon Win1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
2
4
6
8
10
b
fF F T
CT 502 A2 Photon Win1 FFT
Number of days
1
2
3
4
Amplitude
-8
-6
-4
-2
0
2
4
6
8
CT 502 A2 Photon Win2 Signal
CT 502 A2 Photon Win2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
2
4
6
8
10
CT 502 A2 Photon Win2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
2
4
6
8
10
b
fF F T
CT 502 A2 Photon Win2 FFT
Number of days
2
3
4
5
Amplitude
-8
-6
-4
-2
0
2
4
6
8
CT 502 A2 Photon Win3 Signal
CT 502 A2 Photon Win3 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
2
4
6
8
10
CT 502 A2 Photon Win3 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
2
4
6
8
10
b
fF F T
CT 502 A2 Photon Win3 FFT
Number of days
3
4
5
6
Amplitude
-8
-6
-4
-2
0
2
4
6
8
CT 502 A2 Photon Win4 Signal
CT 502 A2 Photon Win4 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
2
4
6
8
10
12
CT 502 A2 Photon Win4 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
2
4
6
8
10
12
b
fF F T
CT 502 A2 Photon Win4 FFT
Figure 6.38: PC Stability: PC estimation via FFT and VBA for 4-days length signals
Figure 6.39: PC Stability: Proposed Method (a) vs. FFT (b)
Figure 6.40: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
138

CT 502 A2: Photon Absorption and Activity
For the DD period, ﬁrst we consider the before treatment segment. Only 3 days are
available for this segment. We compute the PC vector, using FFT and Proposed Method,
Figure (6.41):
Number of days
0
1
2
Amplitude
-2
0
2
4
6
8
10
CT 502 A2 Photon DDBef Signal
CT 502 A2 Photon DDBef Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 A2 Photon DDBef VBA
Periods
6    
6.54 
7.2  
8    
9    
10.28
12   
14.4 
18   
24   
36   
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 A2 Photon DDBef FFT
Figure 6.41: DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
Via the FFT, the highest pick is set at 24. Of course, given the short length of the signal, 3
days, and the limitations of the FFT method all the values inside the interval (18,36) except 24
are not present in the estimated vector, so the values are uncertain. Via the Proposed method
the dominant period is set at 25 hours.
We now consider the during treatment part of the data, a 5-days length signal, Fig-
ure (6.42).
Number of days
0
1
2
3
4
Amplitude
-2
0
2
4
6
8
10
CT 502 A2 Photon DDDur Signal
CT 502 A2 Photon DDDur Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
CT 502 A2 Photon DDDur VBA
Periods
8    
8.57 
9.23 
10   
10.9 
12   
13.33
15   
17.14
20   
24   
30   
Amplitude
0
0.5
1
1.5
2
2.5
3
b
fF F T
CT 502 A2 Photon DDDur FFT
Figure 6.42: DD during signal (a) and the corresponding PC via VBA (b) and FFT (c)
Both methods are conﬁrming the 24 hours periodicity. We note again the difference be-
tween the amplitudes corresponding to the two methods and the sparse PC vector returned by
the Proposed Method.
Number of days
0
1
2
3
Amplitude
-2
0
2
4
6
8
CT 502 A2 Photon DDDurWin1 Signal
CT 502 A2 Photon DDDurWin1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
CT 502 A2 Photon DDDurWin1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
3
b
fF F T
CT 502 A2 Photon DDDurWin1 FFT
Number of days
1
2
3
4
Amplitude
-2
0
2
4
6
8
10
CT 502 A2 Photon DDDurWin2 Signal
CT 502 A2 Photon DDDurWin2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
CT 502 A2 Photon DDDurWin2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
3
b
fF F T
CT 502 A2 Photon DDDurWin2 FFT
Figure 6.43: PC Stability: PC estimation via FFT and VBA for 4-days length signals, Photon
DD, during
Analysing the during segment using the moving window, the 24 hour periodicity is
139

6.2.3 - Conclusions: Dominant Period evolution
conﬁrmed by both methods, and also the stability of this periodicity for this segment, Fig-
ure (6.44).
Figure 6.44: PC Stability: Proposed Method (a) vs. FFT (b)
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented in Figure (6.45):
Figure 6.45: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
For the after treatment part of the data, a 2-days length signal is available. In this case, the
Number of days
0
1
Amplitude
-5
0
5
10
CT 502 A2 Photon DDAft Signal
CT 502 A2 Photon DDAft Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
CT 502 A2 Photon DDAft VBA
Periods
6   
6.85
8   
9.6 
12  
16  
24  
48  
Amplitude
0
1
2
3
4
5
b
fF F T
CT 502 A2 Photon DDAft FFT
Figure 6.46: DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
dominant period is estimated at 24 hours via FFT. This value is uncertain, for this particular
case (a 2-days length signal) the interval (16:48) having only one value that is appearing the
FFT PC vector, i.e. 24 hours. Via the Proposed Method, the dominant period is set at 23
hours.
The evolution of the dominant period, estimated via the Proposed Method and FFT, during
the complete Photon absorption signal, for each segment of interest and for four-days length
signals for the segments that allowed this analysis is presented in Table (6.4).
6.2.3
Conclusions: Dominant Period evolution
We compared the FFT and Proposed Method PC amplitude vector evolution during the four
segments of interest for mouse CT 503 A2, considering the gene expression (Photon Absorp-
tion signal) and the rest-activity patters (Activity signal), Figure (6.24). For both data, we
140

CT 502 A2: Photon Absorption and Activity
CT 502 - A2
Dominant Period - Proposed Method
Dominant Period - FFT
LD complete
24
24
LD win 1
24
24
LD win 2
24
24
LD win 3
24
24
LD win 4
24
24
DD before
25
24
DD during
24
24
DD during win 1
24
24
DD during win 2
24
24
DD after
23
24
Table 6.4: CT 502 A2: Photon Absorption Dominant Period Stability: Proposed Method vs.
FFT
have considered four segments of interest, i.e. the LD part of the signal, corresponding to
the synchronization and the DD part of the signal, corresponding to the complete darkness,
for which we have considered the segments corresponding to the before, during and after
treatment phase, Figure (6.25) (rest-activity patterns) and Figure (6.36).
In particular, for the ﬁrst segment of interest, i.e. the LD part of data and for the dur-
ing treatment part, we have considered four days length signals to analyse the stability or
variability of the dominant period for the considered segment itself.
The dominant period evolution, corresponding to the Proposed Method and FFT for the
gene expression data (photon absorption signal), is presented in Table (6.4). For this experi-
ment, via FFT, the dominant period is 24 hours for each segment, and seems stable. Via the
Proposed Method, slight variations are detected during the experiment: a 23 hour periodicity
corresponding to the before treatment part of data and a 25 hour periodicity corresponding to
the after treatment part of data.
The dominant period evolution, corresponding to the Proposed Method and FFT for the
rest-activity patterns (Activity) signal is presented in Table (6.3). In this case, the drawbacks
of the FFT method are very clear. For the LD segment of the Activity signal, seven days
were available. The dominant period of this segment is 21 hours via FFT, the FFT PC ampli-
tude vector estimating two important peaks, corresponding to 21 and 24 hours, both of them
having almost equal amplitudes, with the amplitude corresponding to the 21 hours slightly
higher, Figure (6.26). However, for the evolution of the dominant period for this segment,
Figure (6.27), the dominant period is estimated at 24 hours for each windows, therefore sta-
ble. Via the Proposed Method, for the entire LD segment, the most important two peaks
corresponds to 23 and 21 hours, and the evolution of the dominant period during this seg-
ment is 21 hours for the ﬁrst window, 22 hours for the second window, 23 hours for the third
window and 25 hours for the fourth window.
Also, for the during treatment segment, the FFT PC amplitude vector has important peaks
corresponding to 12 hours, 30 hours and 24 hours. Considering the dominant period, which
is 12 hours, via FFT estimation, the rhythm for the during treatment is placed in the ultradian
141

6.3.1 - Dominant Period evolution: Activity
domain, Figure (6.31). However, studying the evolution of the PC amplitude vector for this
segment, via FFT, the dominant period corresponding to the ﬁrst window is 32 hours, so
infradian rhythm, and corresponding to the second window is 24 hours, so circadian rhythm.
Via the Proposed Method, for the during treatment segment, very similar peaks are esti-
mated in the PC amplitude vector: 32 hours, 24 hours and 12 hours, but the dominant period
is 32 hours, therefore the rhythm is infradian.
6.3 CT 502 A3: Photon Absorption and Activity
In the following we consider the experiment CT 502, Mouse A3. This section is dedicated to
the complete study, i.e the study of the physiology, corresponding to the segment LD (light-
dark, 12h-12h), where the mouse was synchronized and DD (total darkness), the segment
corresponding to the before treatment and the study of the behaviour during and after treat-
ment. For the study, two signals were recorded: the Activity Signal measuring the activity
(movement) of the mouse and the Photon Absorption Signal, measuring the number of pho-
tons absorbed, Figure (6.47).
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
0
10
20
30
40
50
60
LD Period
Before DD
During DD
After DD
A3 Activity All - CT 502 
A3 Activity All - CT 502
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
×104
0
2
4
6
8
10
12
14
16
18
LD Period
Before DD
During DD
After DD
A3 Photon All - CT 502 
A3 Photon All - CT 502
Figure 6.47: CT 502, A3 Mouse: Activity (a) and Photon Absorption (b) raw data
Figure (6.47) presents the raw data corresponding to the Activity signal and Photon Ab-
sorption signal. The signals were recorded for 22 days, sampled every minute. For each
signal, we consider 4 segments: LD Period, corresponding to the synchronization part, then
three parts corresponding to the DD period: before, during and after treatment. We are in-
terested in the periodic component (PC) vector corresponding to each signal and in the corre-
sponding acrophase. The stability of the period is veriﬁed using the moving window strategy,
where the available data allows.
6.3.1
Dominant Period evolution: Activity
We start the analysis with the signal corresponding to the Activity. We will consider mean-
zero signals, normalized between [-10:10] and sampled every hour. The Activity signal and
the four segments of interest are presented in Figure (6.48).
For the LD part, we have 8 days available. We compute the PC corresponding to the signal
using the Proposed Method and also using the FFT, Figure (6.49). Via the FFT method, the
principal period is estimated at 24 hours. The next highest pick in the PC vector is corre-
sponding to 21 hours. Via the Proposed Method, the principal period is estimated at 22 hours,
and the next highest pick in the PC vector corresponds to 20 hours
142

CT 502 A3: Photon Absorption and Activity
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
0
10
20
30
40
50
60
LD Period
Before DD
During DD
After DD
A3 Activity All - CT 502 
A3 Activity All - CT 502
Number of days
0
1
2
3
4
5
6
Amplitude
-2
0
2
4
6
8
10
A3 Activity LD - R2 Norm - CT 502 
A3 Activity LD - R2 Norm - CT 502
Number of days
0
1
2
Amplitude
-2
0
2
4
6
8
10
A3 Activity Before - DD - R2Norm - CT 502 
A3 Activity Before - DD - R2Norm - CT 502
Number of days
0
1
2
3
4
Amplitude
-2
0
2
4
6
8
10
A3 Activity During - DD - R2Norm - CT 502 
A3 Activity During - DD - R2Norm - CT 502
Number of days
0
1
Amplitude
-4
-2
0
2
4
6
8
10
A3 Activity After - DD - R2Norm - CT 502 
A3 Activity After - DD - R2Norm - CT 502
Figure 6.48: Activity raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-
hour sampled
Number of days
0
1
2
3
4
5
6
Amplitude
-2
0
2
4
6
8
CT 502 A3 Activity WinComp Signal
CT 502 A3 Activity WinComp Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 A3 Activity WinComp VBA
Periods
11.2 
12   
12.92
14   
15.27
16.8 
18.66
21   
24   
28   
33.6 
42   
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 A3 Activity WinComp FFT
Figure 6.49: Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
We consider now 4-days length signals (windows) from the available signal, with a shift
of one day and compute the PC via FFT and the Proposed method, Figure (6.50).
Via FFT, the dominant period seems stable, for each window the dominant period being
estimated at 24 hours. Via the Proposed Method, the dominant period shifts from 22 hours,
for the ﬁrst window to 23 hours for the second window to 24 hours for the last two windows,
Figure (6.51).
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented Figure (6.52).:
We consider now the DD period. First, we consider the before treatment segment. Only
3 days are available for this segment. We compute the PC vector, using FFT and Proposed
Method,Figure (6.53). Via the FFT, the highest pick is set at 24 hours and the next two highest
picks are set at 7.2 and 8 hours. Of course, given the short length of the signal, 3 days, and
the limitations of the FFT method all the values inside the interval (18,36) except 24 are not
present in the estimated vector, so the values are uncertain. Via the Proposed method, the PC
amplitude vector is sparse, with only one non-zero amplitude, corresponding to 24 hours.
For the during treatment part of the data, 5 days are available. We compute the PC
corresponding to the during treatment part of the data using the Proposed Method and also
using the FFT, Figure (6.54). Via the Proposed Method, the estimated PC amplitude vector is a
sparse vector and the dominant period is estimated at 24 hours. The other non-zero amplitudes
in the PC amplitudes vector corresponds to 8, 25 and 12 hours. In the FFT estimation, the
dominant period corresponds to 24 hours, and the next two highest peaks in the PC amplitude
143

6.3.1 - Dominant Period evolution: Activity
Number of days
0
1
2
3
Amplitude
-4
-2
0
2
4
6
8
CT 502 A3 Activity Win1 Signal
CT 502 A3 Activity Win1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
CT 502 A3 Activity Win1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
b
fF F T
CT 502 A3 Activity Win1 FFT
Number of days
1
2
3
4
Amplitude
-2
0
2
4
6
8
CT 502 A3 Activity Win2 Signal
CT 502 A3 Activity Win2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
CT 502 A3 Activity Win2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
b
fF F T
CT 502 A3 Activity Win2 FFT
Number of days
2
3
4
5
Amplitude
-2
0
2
4
6
8
10
CT 502 A3 Activity Win3 Signal
CT 502 A3 Activity Win3 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
CT 502 A3 Activity Win3 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
b
fF F T
CT 502 A3 Activity Win3 FFT
Number of days
3
4
5
6
Amplitude
-2
0
2
4
6
8
CT 502 A3 Activity Win4 Signal
CT 502 A3 Activity Win4 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 A3 Activity Win4 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 A3 Activity Win4 FFT
Figure 6.50: PC Stability: PC estimation via FFT and VBA for 4-days length signals
Figure 6.51: PC Stability: Proposed Method (a) vs. FFT (b)
Figure 6.52: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
Number of days
0
1
2
Amplitude
-2
0
2
4
6
8
10
CT 502 A3 Activity DDBef Signal
CT 502 A3 Activity DDBef Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
CT 502 A3 Activity DDBef VBA
Periods
6    
6.54 
7.2  
8    
9    
10.28
12   
14.4 
18   
24   
36   
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
b
fF F T
CT 502 A3 Activity DDBef FFT
Figure 6.53: DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
144

CT 502 A3: Photon Absorption and Activity
Number of days
0
1
2
3
4
Amplitude
-2
0
2
4
6
8
10
CT 502 A3 Activity DDDur Signal
CT 502 A3 Activity DDDur Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
CT 502 A3 Activity DDDur VBA
Periods
8    
8.57 
9.23 
10   
10.9 
12   
13.33
15   
17.14
20   
24   
30   
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
b
fF F T
CT 502 A3 Activity DDDur FFT
Figure 6.54: DD during signal (a) and the corresponding PC via VBA (b) and FFT (c)
vector estimation corresponds to 8 and 12 hours.
We consider now 4-days length signals (windows) from the available signal, with a shift
of one day and compute the PC via FFT and the Proposed method, Figure (6.55).
Number of days
0
1
2
3
Amplitude
-2
0
2
4
6
8
10
CT 502 A3 Activity DDDurWin1 Signal
CT 502 A3 Activity DDDurWin1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
CT 502 A3 Activity DDDurWin1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.2
0.4
0.6
0.8
1
b
fF F T
CT 502 A3 Activity DDDurWin1 FFT
Number of days
1
2
3
4
Amplitude
-2
0
2
4
6
8
CT 502 A3 Activity DDDurWin2 Signal
CT 502 A3 Activity DDDurWin2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
CT 502 A3 Activity DDDurWin2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
b
fF F T
CT 502 A3 Activity DDDurWin2 FFT
Figure 6.55: PC Stability: PC estimation via FFT and VBA for 4-days length signals, Activity
DD, during
We note that via the FFT, both windows are estimated with a dominant period of 24 hours,
with harmonics corresponding to 8 and 12 hours. Via the Proposed Method, we ﬁnd the
dominant period corresponding to the ﬁrst window at 25 hours (and important picks for 8
and 12 hours) and the dominant period corresponding to the second window at 25 hours (and
important picks for 8 and 12 hours), Figure (6.56).
Figure 6.56: PC Stability: Proposed Method (a) vs. FFT (b)
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented in the following ﬁgure:
We now consider the after treatment part of the data. Two days are available. For the FFT,
the dominant period corresponds to 24 hours. Via the Proposed Method, the dominant period
is estimated at 27 hours.
145

6.3.2 - Dominant Period evolution: Photon
Figure 6.57: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
Number of days
0
1
Amplitude
-4
-2
0
2
4
6
8
10
CT 502 A3 Activity DDAft Signal
CT 502 A3 Activity DDAft Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
CT 502 A3 Activity DDAft VBA
Periods
6   
6.85
8   
9.6 
12  
16  
24  
48  
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
b
fF F T
CT 502 A3 Activity DDAft FFT
Figure 6.58: DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
The evolution of the dominant period, estimated via the Proposed Method and FFT, during
the complete Activity signal, for each segment of interest and for four-days length signals for
the segments that allowed this analysis is presented in Table (6.5).
6.3.2
Dominant Period evolution: Photon
In this section we analyse the signal corresponding to the photon absorption, i.e. the gene
expression. Like before, we consider mean-zero signals, normalized between [-10:10] and
sampled every hour. In this case, the analysis corresponding to the LD part has no biological
interest, since the RT-BIO photomultiplier will not record the mouse liver bioluminescence but
the light inside cage corresponding to the 12 hours of light. The complete Photon absorption
signal and the four segments of interest are presented in Figure (6.59)
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
×104
0
2
4
6
8
10
12
14
16
18
LD Period
Before DD
During DD
After DD
A3 Photon All - CT 502 
A3 Photon All - CT 502
Number of days
0
1
2
3
4
5
6
Amplitude
-6
-4
-2
0
2
4
6
8
10
A3 Photon LD - R2 Norm - CT 502 
A3 Photon LD - R2 Norm - CT 502
Number of points
0
Amplitude
-5
0
5
10
A3 Photon Before - DD - R2Norm -CT 502 
A3 Photon Before - DD - R2Norm -CT 502
Number of points
0
Amplitude
-4
-2
0
2
4
6
8
10
A3 Photon During - DD - R2Norm -CT 502 
A3 Photon During - DD - R2Norm -CT 502
Number of points
0
Amplitude
-6
-4
-2
0
2
4
6
8
10
A3 Photon After - DD - R2Norm -CT 502 
A3 Photon After - DD - R2Norm -CT 502
Figure 6.59: Photon raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-
hour sampled
146

CT 502 A3: Photon Absorption and Activity
CT 502 - A3
Dominant Period - Proposed Method
Dominant Period - FFT
LD complete
22
24
LD win 1
22
24
LD win 2
23
24
LD win 3
24
24
LD win 4
24
24
DD before
24
24
DD during
24
24
DD during win 1
25
24
DD during win 2
24
24
DD after
27
24
Table 6.5: CT 502 A3: Activity Dominant Period Stability: Proposed Method vs. FFT
For the LD part, 8 days are available. We compute the PC corresponding to the signal
using the Proposed Method and also using the FFT, Figure (6.60): Via the FFT method, the
Number of days
0
1
2
3
4
5
6
Amplitude
-6
-4
-2
0
2
4
6
8
10
CT 502 A3 Photon WinComp Signal
CT 502 A3 Photon WinComp Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
9
CT 502 A3 Photon WinComp VBA
Periods
7.63 
8    
8.4  8.84 9.33 9.88 10.5 11.2 12   12.92 14   15.27 16.8 18.66 21   
24   
28   33.6 
Amplitude
0
1
2
3
4
5
6
7
8
9
b
fF F T
CT 502 A3 Photon WinComp FFT
Figure 6.60: Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
principal period is estimated at 24 hours and the only other non-zero peak in the PC amplitude
vector corresponds to 8 hours. The dominant period of 24 hours and the corresponding 8 hours
harmonic are also the only non-zero amplitudes in the PC amplitude vector corresponding to
the Proposed Method.
We consider now 4-days length signals (windows) from the available signal, with a shift
of one day and compute the PC via FFT and the Proposed method, Figure (6.61).
For all the windows, a 24 hours periodicity is conﬁrmed, via the two methods, Fig-
ure (6.62).
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented in Figure (6.63):
We consider now the DD period. First, we consider the before treatment segment. Only
3 days are available for this segment. We compute the PC vector, using FFT and Proposed
Method, Figure (6.64): Via the FFT, the highest pick is set at 24. Of course, given the short
length of the signal, 3 days, and the limitations of the FFT method all the values inside the
interval (18,36) except 24 are not present in the estimated vector, so the values are uncertain.
Via the Proposed method the dominant period is set at 23 hours.
For the during treatment part of the data, ﬁve days are available. We compute the PC
corresponding to the signal using the Proposed Method and also using the FFT, Figure (6.65):
147

6.3.2 - Dominant Period evolution: Photon
Number of days
0
1
2
3
Amplitude
-6
-4
-2
0
2
4
6
8
10
CT 502 A3 Photon Win1 Signal
CT 502 A3 Photon Win1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
9
CT 502 A3 Photon Win1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
1
2
3
4
5
6
7
8
9
b
fF F T
CT 502 A3 Photon Win1 FFT
Number of days
1
2
3
4
Amplitude
-6
-4
-2
0
2
4
6
8
10
CT 502 A3 Photon Win2 Signal
CT 502 A3 Photon Win2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
9
CT 502 A3 Photon Win2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
1
2
3
4
5
6
7
8
9
b
fF F T
CT 502 A3 Photon Win2 FFT
Number of days
2
3
4
5
Amplitude
-6
-4
-2
0
2
4
6
8
CT 502 A3 Photon Win3 Signal
CT 502 A3 Photon Win3 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
9
CT 502 A3 Photon Win3 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
1
2
3
4
5
6
7
8
9
b
fF F T
CT 502 A3 Photon Win3 FFT
Number of days
3
4
5
6
Amplitude
-6
-4
-2
0
2
4
6
8
CT 502 A3 Photon Win4 Signal
CT 502 A3 Photon Win4 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
9
10
CT 502 A3 Photon Win4 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
1
2
3
4
5
6
7
8
9
10
b
fF F T
CT 502 A3 Photon Win4 FFT
Figure 6.61: PC Stability: PC estimation via FFT and VBA for 4-days length signals
Figure 6.62: PC Stability: Proposed Method (a) vs. FFT (b)
Figure 6.63: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
Number of days
0
1
2
Amplitude
-5
0
5
10
CT 502 A3 Photon DDBef Signal
CT 502 A3 Photon DDBef Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
CT 502 A3 Photon DDBef VBA
Periods
6    
6.54 
7.2  
8    
9    
10.28
12   
14.4 
18   
24   
36   
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
b
fF F T
CT 502 A3 Photon DDBef FFT
Figure 6.64: DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
148

CT 502 A3: Photon Absorption and Activity
Via FFT, we obtain a 24 hours periodicity, while via the Proposed Method, the dominant peak
Number of days
0
1
2
3
4
Amplitude
-4
-2
0
2
4
6
8
10
CT 502 A3 Photon DDDur Signal
CT 502 A3 Photon DDDur Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 A3 Photon DDDur VBA
Periods
8    
8.57 
9.23 
10   
10.9 
12   
13.33
15   
17.14
20   
24   
30   
Amplitude
0
0.5
1
1.5
2
2.5
3
b
fF F T
CT 502 A3 Photon DDDur FFT
Figure 6.65: DD during signal (a) and the corresponding PC via VBA (b) and FFT (c)
corresponds to 25. The only other non-zero amplitude in the PC amplitude vector, corresponds
to 18 hour, which is consistent with the next highest peak in the FFT estimation, 17.14 hours.
We note again the difference between the amplitudes corresponding to the two methods and
the sparse PC vector returned by the Proposed Method.
We consider now 4-days length signals (windows) from the available during treatment
part of the data, with a shift of one day and compute the PC via FFT and the Proposed method,
Figure (6.66).
Number of days
0
1
2
3
Amplitude
-4
-2
0
2
4
6
8
10
CT 502 A3 Photon DDDurWin1 Signal
CT 502 A3 Photon DDDurWin1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
CT 502 A3 Photon DDDurWin1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
3
b
fF F T
CT 502 A3 Photon DDDurWin1 FFT
Number of days
1
2
3
4
Amplitude
-4
-2
0
2
4
6
8
CT 502 A3 Photon DDDurWin2 Signal
CT 502 A3 Photon DDDurWin2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
CT 502 A3 Photon DDDurWin2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
3
b
fF F T
CT 502 A3 Photon DDDurWin2 FFT
Figure 6.66: PC Stability: PC estimation via FFT and VBA for 4-days length signals, Photon
DD, during
Analysing the during segment using the moving window, a 24 hour periodicity is found
for both windows, via FFT. However, via the Proposed Method, the periodicity, also stable, is
estimated at 25 hours, Figure (6.67)
Figure 6.67: PC Stability: Proposed Method (a) vs. FFT (b)
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented in Figure (6.67):
149

6.3.3 - Conclusions: Dominant Period evolution
Figure 6.68: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
Number of days
0
1
Amplitude
-6
-4
-2
0
2
4
6
8
10
CT 502 A3 Photon DDAft Signal
CT 502 A3 Photon DDAft Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
CT 502 A3 Photon DDAft VBA
Periods
6   
6.85
8   
9.6 
12  
16  
24  
48  
Amplitude
0
1
2
3
4
5
6
7
8
b
fF F T
CT 502 A3 Photon DDAft FFT
Figure 6.69: DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
We now consider the after treatment part of the data. We have a 2-days length signal. In
this case, the dominant period is estimated at 24 hours via FFT. This value is very uncertain,
for this particular case (a 2-days length signal) all the interval (16:48) having only one value
that is appearing the FFT PC vector, i.e. 24 hours. Via the Proposed Method, the dominant
period is set at 23 hours, with also an important periodicity for 24 hours.
The evolution of the dominant period, estimated via the Proposed Method and FFT, during
the complete Photon signal, for each segment of interest and for four-days length signals for
the segments that allowed this analysis is presented in Table (6.6).
6.3.3
Conclusions: Dominant Period evolution
In this subsection we compared the FFT and Proposed Method PC amplitude vector evolution
during the four segments of interest for mouse CT 503 A3, considering the gene expression
(Photon Absorption signal) and the rest-activity patters (Activity signal), Figure (6.47). Like
before, for both signals, four segments of interest were considered, i.e. the LD part of the sig-
nal, corresponding to the synchronization and the DD part of the signal, corresponding to the
complete darkness, for which we have considered the segments corresponding to the before,
during and after treatment phase, Figure (6.48) (rest-activity patterns) and Figure (6.59).
Like before, for the ﬁrst segment of interest, i.e. the LD part of data and for the dur-
ing treatment part, we have considered four days length signals to analyse the stability or
variability of the dominant period for the considered segment itself.
The dominant period evolution, corresponding to the Proposed Method and FFT, for the
gene expression data, is presented in Table (6.6). For this experiment, via FFT, the domi-
nant period is 24 hours for each segment and seems stable. Via the Proposed Method, small
variations are detected during the experiment: a 23 hour periodicity corresponding to the be-
fore and after treatment part of data and a 25 hour periodicity corresponding to the during
treatment part of data.
150

CT 502 B1: Photon Absorption and Activity
CT 502 - A3
Dominant Period - Proposed Method
Dominant Period - FFT
LD complete
24
24
LD win 1
24
24
LD win 2
24
24
LD win 3
24
24
LD win 4
24
24
DD before
23
24
DD during
25
24
DD during win 1
25
24
DD during win 2
25
24
DD after
23
24
Table 6.6: CT 502 A3: Photon Dominant Period Stability: Proposed Method vs. FFT
The dominant period evolution, corresponding to the Proposed Method and FFT for the
rest-activity patterns (Activity) signal is presented in Table (6.5). In this case, the result are
similar, in the sense that both methods detect a circadian rhythm, but via the Proposed Method,
variations of the dominant period can be detected, while via FFT the evolution of the dominant
period seems stable.
6.4 CT 502 B1: Photon Absorption and Activity
In the following we consider the experiment CT 502, Mouse B1. This section is dedicated to
the complete study, i.e the study of the physiology, corresponding to the segment LD (light-
dark, 12h-12h), where the mouse was synchronized and DD (total darkness), the segment
corresponding to the before treatment and the study of the behaviour during and after treat-
ment. For the study, two signals were recorded: the Activity Signal measuring the activity
(movement) of the mouse and the Photon Absorption Signal, measuring the number of pho-
tons absorbed, Figure (6.70).
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
0
10
20
30
40
50
60
Light-Dark
Before
During
After
B1 Activity All - CT 502 
B1 Activity All - CT 502
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
×105
0
0.5
1
1.5
2
2.5
Light-Dark
Before
During
After
B1 Photon All - CT 502 
B1 Photon All - CT 502
Figure 6.70: CT 502, B1 Mouse: Activity (a) and Photon Absorption (b) raw data
Figure (6.70) presents the raw data corresponding to the Activity signal and Photon Ab-
sorption signal. The signals were recorded for 22 days, sampled every minute. For each
signal, we consider 4 segments: LD Period, corresponding to the synchronization part, then
three parts corresponding to the DD period: before, during and after treatment. We are in-
terested in the periodic component (PC) vector corresponding to each signal and in the corre-
151

6.4.1 - Dominant Period evolution: Activity
sponding acrophase. The stability of the period is veriﬁed using the moving window strategy,
where the available data allows.
6.4.1
Dominant Period evolution: Activity
We start the analysis with the signal corresponding to the Activity. We consider zero-mean
signals, normalized between [-10:10] and sampled every hour.
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
0
10
20
30
40
50
60
Light-Dark
Before
During
After
B1 Activity All - CT 502 
B1 Activity All - CT 502
Number of days
0
1
2
3
4
5
6
Amplitude
-4
-2
0
2
4
6
8
10
B1 Activity LD - R2 Norm - CT 502 
B1 Activity LD - R2 Norm - CT 502
Number of days
0
1
2
Amplitude
-4
-2
0
2
4
6
8
10
B1 Activity Before - DD - R2Norm - CT 502 
B1 Activity Before - DD - R2Norm - CT 502
Number of days
0
1
2
3
4
Amplitude
-2
0
2
4
6
8
10
B1 Activity During - DD - R2Norm - CT 502 
B1 Activity During - DD - R2Norm - CT 502
Number of days
0
1
Amplitude
-4
-2
0
2
4
6
8
10
B1 Activity After - DD - R2Norm - CT 502 
B1 Activity After - DD - R2Norm - CT 502
Figure 6.71: Activity raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-
hour sampled
For the LD part, 7 days are available. We compute the PC corresponding to the signal
using the Proposed Method and also using the FFT: Via the FFT method, the principal period
Number of days
0
1
2
3
4
5
6
Amplitude
-4
-2
0
2
4
6
8
10
CT 502 B1 Activity WinComp Signal
CT 502 B1 Activity WinComp Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
CT 502 B1 Activity WinComp VBA
Periods
11.2 
12   
12.92
14   
15.27
16.8 
18.66
21   
24   
28   
33.6 
42   
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
b
fF F T
CT 502 B1 Activity WinComp FFT
Figure 6.72: Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
is estimated at 24 hours. Evidently, beside the incertitude associated with the FFT estimated
PC, the existence of other rhythms can’t be established, being difﬁcult to interpret all the
picks present in the estimated PC. Via the Proposed Method, the principal period is estimated
at 24 hours.The amplitude corresponding to the 24h period via the Proposed Method is much
higher.
We consider now 4-days length signals (windows) from the available signal, with a shift
of one day and compute the PC via FFT and the Proposed method. Via the Proposed Method,
the ﬁrst windows presents a 25 hours dominant period, the second windows presents a 24
hours dominant period and for the last two windows, the dominant period is estimated at
23 hours. Via FFT method the principal period seems stable, every window presenting a
dominant period of 24 hours.
152

CT 502 B1: Photon Absorption and Activity
Number of days
0
1
2
3
Amplitude
-4
-2
0
2
4
6
8
CT 502 B1 Activity Win1 Signal
CT 502 B1 Activity Win1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
CT 502 B1 Activity Win1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
3
b
fF F T
CT 502 B1 Activity Win1 FFT
Number of days
1
2
3
4
Amplitude
-4
-2
0
2
4
6
8
CT 502 B1 Activity Win2 Signal
CT 502 B1 Activity Win2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
4
CT 502 B1 Activity Win2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
4
b
fF F T
CT 502 B1 Activity Win2 FFT
Number of days
2
3
4
5
Amplitude
-4
-2
0
2
4
6
8
10
CT 502 B1 Activity Win3 Signal
CT 502 B1 Activity Win3 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
CT 502 B1 Activity Win3 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
3
b
fF F T
CT 502 B1 Activity Win3 FFT
Number of days
3
4
5
6
Amplitude
-2
0
2
4
6
8
CT 502 B1 Activity Win4 Signal
CT 502 B1 Activity Win4 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
CT 502 B1 Activity Win4 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
3
b
fF F T
CT 502 B1 Activity Win4 FFT
Figure 6.73: PC Stability: PC estimation via FFT and VBA for 4-days length signals
The stability or variability of the PC amplitudes vector for the LD part of the Activity
signal is presented in Figure (6.74):
Figure 6.74: PC Stability: Proposed Method (a) vs. FFT (b)
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented in the Figure (6.75):
We consider now the DD period. First, we consider the before treatment segment. Only
3 days are available for this segment. We compute the PC vector, using FFT and Proposed
Method, (6.76): Via the FFT, the highest pick is set at 24 hours and the next three highest
picks are set at 8, 6 and 36 hours. Of course, given the short length of the signal, 3 days,
and the limitations of the FFT method all the values inside the interval (18,36) except 24 are
not present in the estimated vector, so the result presents a very important uncertainty. This
means that for this particular case, even the classiﬁcation of the rhythm (circadian or infradian)
is uncertain via FFT. Via the Proposed method the dominant period is set at 23 hours.
We consider the during treatment part of the data, for which ﬁve days are available, Fig-
ure (6.77). Via the proposed method, the estimated PC vector is a sparse vector, in accordance
with the model and the dominant period is estimated at 25 hours. For the FFT estimated PC
vector, the dominant period is estimated at 24 hours, but the estimation is not sparse. In this
153

6.4.1 - Dominant Period evolution: Activity
Figure 6.75: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
Number of days
0
1
2
Amplitude
-4
-2
0
2
4
6
8
10
CT 502 B1 Activity DDBef Signal
CT 502 B1 Activity DDBef Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 B1 Activity DDBef VBA
Periods
6    
6.54 
7.2  
8    
9    
10.28
12   
14.4 
18   
24   
36   
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 B1 Activity DDBef FFT
Figure 6.76: DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
Number of days
0
1
2
3
4
Amplitude
-2
0
2
4
6
8
10
CT 502 B1 Activity DDDur Signal
CT 502 B1 Activity DDDur Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
CT 502 B1 Activity DDDur VBA
Periods
8    
8.57 
9.23 
10   
10.9 
12   
13.33
15   
17.14
20   
24   
30   
Amplitude
0
0.5
1
1.5
2
b
fF F T
CT 502 B1 Activity DDDur FFT
Figure 6.77: DD during signal (a) and the corresponding PC via VBA (b) and FFT (c)
154

CT 502 B1: Photon Absorption and Activity
case, the next important pick corresponds to 12 hours, harmonics of 24 hours, and this values
is also found in the estimation obtained by the Proposed Method.
We consider 4-days length signals (windows) from the before treatment segment, with
a shift of one day and compute the PC via FFT and the Proposed method. In this case,
Number of days
0
1
2
3
Amplitude
-2
0
2
4
6
8
10
CT 502 B1 Activity DDDurWin1 Signal
CT 502 B1 Activity DDDurWin1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
CT 502 B1 Activity DDDurWin1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
b
fF F T
CT 502 B1 Activity DDDurWin1 FFT
Number of days
1
2
3
4
Amplitude
-2
0
2
4
6
8
CT 502 B1 Activity DDDurWin2 Signal
CT 502 B1 Activity DDDurWin2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 B1 Activity DDDurWin2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 B1 Activity DDDurWin2 FFT
Figure 6.78: PC Stability: PC estimation via FFT and VBA for 4-days length signals, Activity
DD, during
analysing the during segment using the moving window we note that via the Proposed Method
a variability of the dominant period is detected, 25 hours for the ﬁrst window and 26 hours
for the second. Via FFT the dominant period seems stable, 24 hours, but for the ﬁrst window,
the dominant period is 12 hours. This can be viewed in Figure (6.79). An image of dominant
Figure 6.79: PC Stability: Proposed Method (a) vs. FFT (b)
period stability or variability, regardless the numerical value of the amplitude associated with
the dominant period for during segment is presented in Figure (6.80):
Figure 6.80: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
For the after treatment part of the data 2 days are available. Via the FFT estimation, the
dominant period is 24 hours, while via the Proposed Method the dominant period is 26 hours.
The evolution of the dominant period, estimated via the Proposed Method and FFT, during
the complete Activity signal, for each segment of interest and for four-days length signals for
the segments that allowed this analysis is presented in Table (6.7).
155

6.4.2 - Dominant Period evolution: Photon
Number of days
0
1
Amplitude
-4
-2
0
2
4
6
8
10
CT 502 B1 Activity DDAft Signal
CT 502 B1 Activity DDAft Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
CT 502 B1 Activity DDAft VBA
Periods
6   
6.85
8   
9.6 
12  
16  
24  
48  
Amplitude
0
0.5
1
1.5
2
b
fF F T
CT 502 B1 Activity DDAft FFT
Figure 6.81: DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
CT 502 - B1
Dominant Period - Proposed Method
Dominant Period - FFT
LD complete
24
24
LD win 1
25
24
LD win 2
24
24
LD win 3
23
24
LD win 4
23
24
DD before
23
24
DD during
25
24
DD during win 1
25
12
DD during win 2
26
24
DD after
26
24
Table 6.7: CT 502 B1: Activity Dominant Period Stability: Proposed Method vs. FFT
6.4.2
Dominant Period evolution: Photon
In this section we analyse the signal corresponding to the photon absorption, i.e. the gene
expression. Like before, we consider mean-zero signals, normalized between [-10:10] and
sampled every hour. In this case, the analysis corresponding to the LD part has no biological
interest, since the RT-BIO photomultiplier will not record the mouse liver bioluminescence
but the light inside cage corresponding to the 12 hours of light.
The complete Photon absorption signal and the four segments of interest are presented in
Figure (6.82).
For the LD part, 7 days are available. We compute the PC corresponding to the signal
using the Proposed Method and also using the FFT: Via the FFT method, the principal period
is estimated at 24 hours. In particular, in this case, the FFT method estimates a sparse PC
amplitudes vector, and along with the 24 hours, a non-zero peak is detected corresponding to
8 hours. Very similar results are obtained in this case via the Proposed Method: the principal
period is also estimated at 24 hours, together with the harmonic of 8 hours. However, the
amplitude corresponding to the Proposed Method is much higher.
We consider now 4-days length signals (windows) from the available signal, with a shift
of one day and compute the PC via FFT and the Proposed method, Figure (6.84). For all
the windows, a 24 hours periodicity is conﬁrmed, via the two methods, with a harmonic
corresponding to 8 hours, Figure (6.85). Once again, for this segment, there is no biological
interpretation.
156

CT 502 B1: Photon Absorption and Activity
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
×105
0
0.5
1
1.5
2
2.5
Light-Dark
Before
During
After
B1 Photon All - CT 502 
B1 Photon All - CT 502
Number of days
0
1
2
3
4
5
6
Amplitude
-6
-4
-2
0
2
4
6
8
10
B1 Photon LD - R2 Norm - CT 502 
B1 Photon LD - R2 Norm - CT 502
Number of points
0
Amplitude
-2
0
2
4
6
8
10
B1 Photon Before - DD - R2Norm -CT 502 
B1 Photon Before - DD - R2Norm -CT 502
Number of points
0
Amplitude
-4
-2
0
2
4
6
8
10
B1 Photon During - DD - R2Norm -CT 502 
B1 Photon During - DD - R2Norm -CT 502
Number of points
0
Amplitude
-6
-4
-2
0
2
4
6
8
10
B1 Photon After - DD - R2Norm -CT 502 
B1 Photon After - DD - R2Norm -CT 502
Figure 6.82: Photon raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-
hour sampled
Number of days
0
1
2
3
4
5
6
Amplitude
-6
-4
-2
0
2
4
6
8
10
CT 502 B1 Photon WinComp Signal
CT 502 B1 Photon WinComp Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
9
CT 502 B1 Photon WinComp VBA
Periods
7.63 
8    
8.4  8.84 9.33 9.88 10.5 11.2 12   12.92 14   15.27 16.8 18.66 21   
24   
28   33.6 
Amplitude
0
1
2
3
4
5
6
7
8
9
b
fF F T
CT 502 B1 Photon WinComp FFT
Figure 6.83: Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
Number of days
0
1
2
3
Amplitude
-6
-4
-2
0
2
4
6
8
10
CT 502 B1 Photon Win1 Signal
CT 502 B1 Photon Win1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
9
CT 502 B1 Photon Win2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
1
2
3
4
5
b
fF F T
CT 502 B1 Photon Win1 FFT
Number of days
1
2
3
4
Amplitude
-6
-4
-2
0
2
4
6
8
CT 502 B1 Photon Win2 Signal
CT 502 B1 Photon Win2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
9
CT 502 B1 Photon Win2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
1
2
3
4
5
6
7
8
9
b
fF F T
CT 502 B1 Photon Win2 FFT
Number of days
2
3
4
5
Amplitude
-6
-4
-2
0
2
4
6
8
CT 502 B1 Photon Win3 Signal
CT 502 B1 Photon Win3 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
9
10
CT 502 B1 Photon Win3 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
1
2
3
4
5
6
7
8
9
10
b
fF F T
CT 502 B1 Photon Win3 FFT
Number of days
3
4
5
6
Amplitude
-6
-4
-2
0
2
4
6
8
CT 502 B1 Photon Win4 Signal
CT 502 B1 Photon Win4 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
9
10
CT 502 B1 Photon Win4 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
1
2
3
4
5
6
7
8
9
10
b
fF F T
CT 502 B1 Photon Win4 FFT
Figure 6.84: PC Stability: PC estimation via FFT and VBA for 4-days length signals
157

6.4.2 - Dominant Period evolution: Photon
Figure 6.85: PC Stability: Proposed Method (a) vs. FFT (b)
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented in Figure (6.86):
Figure 6.86: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
We consider now the DD period. First, we consider the before treatment segment, Fig-
ure (6.87): The dominant period corresponding to the FFT, is 24 hours, and via the Proposed
Number of days
0
1
2
Amplitude
-2
0
2
4
6
8
10
CT 502 B1 Photon DDBef Signal
CT 502 B1 Photon DDBef Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
CT 502 B1 Photon DDBef VBA
Periods
6    
6.54 
7.2  
8    
9    
10.28
12   
14.4 
18   
24   
36   
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
b
fF F T
CT 502 B1 Photon DDBef FFT
Figure 6.87: DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
Method the estimated periodicity is 25 hours.
We consider the during treatment part of the data. Five days are available, Figure (6.88).
Via FFT method, the dominant period is estimated at 24 hours, with important peaks corre-
sponding to 20, 8 and 30 hours. Via the Proposed Method, the PC amplitudes vector detects
three peaks: the dominant period is set at 25 hours and non-zero peaks are also detected for
19 and 20 hours.
The analysis of the during segment using the moving window is presented in Fig-
ure (6.89). For the FFT method, the dominant period corresponding to the ﬁrst window is
estimated at 24 hours, and for the second one is estimated at 19.2 hours. However in both
cases, both peaks are almost equal. Via the Proposed Method, the dominant period corre-
sponding to the ﬁrst window is 25 hours and corresponding to the second window is 26 hours.
For both windows, an important peak is estimated at 19 hours, consistent with the FFT esti-
mation.
158

CT 502 B1: Photon Absorption and Activity
Number of days
0
1
2
3
4
Amplitude
-4
-2
0
2
4
6
8
10
CT 502 B1 Photon DDDur Signal
CT 502 B1 Photon DDDur Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
CT 502 B1 Photon DDDur VBA
Periods
8    
8.57 
9.23 
10   
10.9 
12   
13.33
15   
17.14
20   
24   
30   
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
b
fF F T
CT 502 B1 Photon DDDur FFT
Figure 6.88: DD during signal (a) and the corresponding PC via VBA (b) and FFT (c)
Number of days
0
1
2
3
Amplitude
-4
-2
0
2
4
6
8
10
CT 502 B1 Photon DDDurWin1 Signal
CT 502 B1 Photon DDDurWin1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
CT 502 B1 Photon DDDurWin1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
b
fF F T
CT 502 B1 Photon DDDurWin1 FFT
Number of days
1
2
3
4
Amplitude
-4
-2
0
2
4
6
8
CT 502 B1 Photon DDDurWin2 Signal
CT 502 B1 Photon DDDurWin2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
CT 502 B1 Photon DDDurWin2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
b
fF F T
CT 502 B1 Photon DDDurWin2 FFT
Figure 6.89: PC Stability: PC estimation via FFT and VBA for 4-days length signals, Photon
DD, during
The visual representation of the variability of the PC amplitude vector via the two methods
is presented in Figure (6.90).
Figure 6.90: PC Stability: Proposed Method (a) vs. FFT (b)
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented in Figure (6.91).
We consider the after treatment part of the data, two days length signal and compute the
PC corresponding to the after treatment part of the data using the Proposed Method and also
using the FFT, Figure (6.92). In this case, the dominant period is estimated at 24 hours both
via FFT and 23 hours corresponding to the Proposed Method.
The evolution of the dominant period, estimated via the Proposed Method and FFT, during
the complete Photon absorption signal, for each segment of interest and for four-days length
signals for the segments that allowed this analysis is presented in Table (6.8).
159

6.4.2 - Dominant Period evolution: Photon
Figure 6.91: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
Number of days
0
1
Amplitude
-6
-4
-2
0
2
4
6
8
10
CT 502 B1 Photon DDAft Signal
CT 502 B1 Photon DDAft Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
CT 502 B1 Photon DDAft VBA
Periods
6   
6.85
8   
9.6 
12  
16  
24  
48  
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
b
fF F T
CT 502 B1 Photon DDAft FFT
Figure 6.92: DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
CT 502 - B1
Dominant Period - Proposed Method
Dominant Period - FFT
LD complete
24
24
LD win 1
24
24
LD win 2
24
24
LD win 3
24
24
LD win 4
24
24
DD before
25
24
DD during
25
24
DD during win 1
25
24
DD during win 2
26
19
DD after
23
24
Table 6.8: CT 502 B1: Photon Absorption Dominant Period Stability: Proposed Method vs.
FFT
160

CT 502 B1: Photon Absorption and Activity
6.4.3
Conclusions: Dominant Period evolution
We compared the FFT and Proposed Method PC amplitude vector evolution during the four
segments of interest for mouse CT 503 B1, considering the gene expression (Photon Absorp-
tion signal) and the rest-activity patters (Activity signal), Figure (6.70). For both data, we
have considered four segments of interest, i.e. the LD part of the signal, corresponding to
the synchronization and the DD part of the signal, corresponding to the complete darkness,
for which we have considered the segments corresponding to the before, during and after
treatment phase, Figure (6.71) (rest-activity patterns) and Figure (6.82).
For the ﬁrst segment of interest, i.e. the LD part of data and for the during treatment
part, we have considered four days length signals to analyse the stability or variability of the
dominant period for the considered segment itself.
The dominant period evolution, corresponding to the Proposed Method and FFT for the
gene expression data (photon absorption signal), is presented in Table (6.8). For this experi-
ment, via FFT, the dominant period is 24 hours for all segments, except the second window of
the during treatment segment and seems stable. Via the Proposed Method, slight variations
are detected during the experiment: a 25 hour periodicity corresponding to the before and
during treatment part of data and a 23 hour periodicity corresponding to the after treatment
part of data.
In the study of the stability of the dominant period for the during treatment segment,
Figure (6.78), for both windows, via both methods, important peaks are estimated for 19 and
24 hours (25 for the second one, via Proposed Method). Via FFT, for the second window, the
dominant period corresponds to 19 hours. Via Proposed Method, for the second window, the
dominant period corresponds to 25 hours.
The dominant period evolution, corresponding to the Proposed Method and FFT for the
rest-activity patterns (Activity) signal is presented in Table (6.7). Via FFT, the dominant
period is 24 hours for all segments, except the ﬁrst window of the during treatment segment
and seems stable. Via the Proposed Method, slight variations around 24 hours are detected
during the experiment: a 23 hour periodicity corresponding to the before treatment part of
data, a 25 hour periodicity corresponding to the during treatment part of data and a 26 hour
periodicity corresponding to the after treatment part of data.
In the study of the stability of the dominant period for the during treatment segment,
Figure (6.89), for both windows, via FFT, important peaks are estimated for 12 and 24 hours.
For the ﬁrst window, the dominant period corresponds to 12 hours. However, in this case, a
circadian rhythm can be associated.
6.5 CT 502 B2: Photon Absorption and Activity
This section presents the comparison between the Proposed Method and the FFT method, for
another experiment, performed in the same conditions as the one presented in Section (6.1).
For the study, two signals are recorded: the Activity Signal measuring the activity (move-
ment) of the mouse and the Photon Absorption Signal, measuring the number of photon
absorbed. Figure (6.93) presents the raw data corresponding to the Activity signal and Pho-
ton Absorption signal. The signals were recorded for 22 days, sampled every minute. Like in
161

6.5.1 - Dominant Period evolution: Activity
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
0
10
20
30
40
50
60
Light - Day
Before
During
After
B2 Activity All - CT 502 
B2 Activity All - CT 502
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
×104
0
1
2
3
4
5
6
7
Light - Day
Before
During
After
B2 Photon All - CT 502 
B2 Photon All - CT 502
Figure 6.93: CT 502, B2 Mouse: Activity (a) and Photon Absorption (b) raw data
Section (6.1), for each signal, we consider the same 4 segments: LD Period, corresponding
to the synchronization part, then three parts corresponding to the DD period: before, during
and after treatment. We are interested in the periodic component (PC) vector corresponding
to each signal. The stability of the period is veriﬁed using the moving window strategy, where
the available data allows.
6.5.1
Dominant Period evolution: Activity
We present the analysis with the signal corresponding to the Activity. We will consider mean-
zero signals, normalized between [-10:10] and sampled every hour, Figure (6.94).
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
0
10
20
30
40
50
60
Light - Day
Before
During
After
B2 Activity All - CT 502 
B2 Activity All - CT 502
Number of days
0
1
2
3
4
5
6
Amplitude
-2
0
2
4
6
8
10
B2 Activity LD - R2 Norm - CT 502 
B2 Activity LD - R2 Norm - CT 502
Number of days
0
1
2
Amplitude
-5
0
5
10
B2 Activity Before - DD - R2Norm - CT 502 
B2 Activity Before - DD - R2Norm - CT 502
Number of days
0
1
2
3
4
Amplitude
0
1
2
3
4
5
6
7
8
9
10
B2 Activity During - DD - R2Norm - CT 502 
B2 Activity During - DD - R2Norm - CT 502
Number of days
0
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
B2 Activity After - DD - R2Norm - CT 502 
B2 Activity After - DD - R2Norm - CT 502
Figure 6.94: Activity raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-
hour sampled
For the LD part, 7 days are available. We compute the PC corresponding to the signal
using the Proposed Method and also using the FFT, Figure (6.95): Via the FFT method, the
principal period is estimated at 24 hours and the next highest peak in the PC amplitude vector
corresponds to 12 hours. Via the Proposed Method, the principal period is estimated at 25
hours, together with the harmonic of 12 hours. However, the amplitude corresponding to the
Proposed Method is much higher.
We consider four days length signals (windows) from the available LD signal, with a shift
of one day and compute the PC via FFT and the Proposed method, Figure (6.96).
Via FFT method, the dominant period is 24 hours for all windows, therefore stable. Via
the Proposed Method, the dominant period is not stable, corresponding to 25 hours for the ﬁrst
162

CT 502 B2: Photon Absorption and Activity
Number of days
0
1
2
3
4
5
6
Amplitude
-2
0
2
4
6
8
10
CT 502 B2 Activity WinComp Signal
CT 502 B2 Activity WinComp Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 B2 Activity WinComp VBA
Periods
11.2 
12   
12.92
14   
15.27
16.8 
18.66
21   
24   
28   
33.6 
42   
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 B2 Activity WinComp FFT
Figure 6.95: Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
Number of days
0
1
2
3
Amplitude
-4
-2
0
2
4
6
8
CT 502 B2 Activity Win1 Signal
CT 502 B2 Activity Win1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 B2 Activity Win1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 B2 Activity Win1 FFT
Number of days
1
2
3
4
Amplitude
-4
-2
0
2
4
6
8
CT 502 B2 Activity Win2 Signal
CT 502 B2 Activity Win2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
CT 502 B2 Activity Win2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
3
b
fF F T
CT 502 B2 Activity Win2 FFT
Number of days
2
3
4
5
Amplitude
-2
0
2
4
6
8
10
CT 502 B2 Activity Win3 Signal
CT 502 B2 Activity Win3 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 B2 Activity Win3 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 B2 Activity Win3 FFT
Number of days
3
4
5
6
Amplitude
-2
0
2
4
6
8
10
CT 502 B2 Activity Win4 Signal
CT 502 B2 Activity Win4 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
CT 502 B2 Activity Win4 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
b
fF F T
CT 502 B2 Activity Win4 FFT
Figure 6.96: PC Stability: PC estimation via FFT and VBA for 4-days length signals
163

6.5.2 - Dominant Period evolution: Photon
window, 24 hours for the next two windows and 25 hours for the last window, Figure (6.97).
Figure 6.97: PC Stability: Proposed Method (a) vs. FFT (b)
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented in Figure (6.98):
Figure 6.98: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
For the DD period, we consider ﬁrst the before treatment segment. Only 3 days are avail-
able for this segment. We compute the PC vector, using FFT and Proposed Method, Fig-
ure (6.99): The estimation corresponding to the FFT method, the dominant peak corresponds
Number of days
0
1
2
Amplitude
-5
0
5
10
CT 502 B2 Activity DDBef Signal
CT 502 B2 Activity DDBef Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
CT 502 B2 Activity DDBef VBA
Periods
6    
6.54 
7.2  
8    
9    
10.28
12   
14.4 
18   
24   
36   
Amplitude
0
0.5
1
1.5
2
b
fF F T
CT 502 B2 Activity DDBef FFT
Figure 6.99: DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
to 24 hours. For the estimation corresponding to the Proposed Method, the PC amplitude
vector is sparse, with only one non-zero peak, corresponding to 24.
The evolution of the dominant period, estimated via the Proposed Method and FFT, during
the complete Activity signal, for each segment of interest and for four-days length signals for
the segments that allowed this analysis is presented in Table (6.9).
6.5.2
Dominant Period evolution: Photon
In this section we analyse the signal corresponding to the photon absorption, i.e. the gene
expression. Like before, we consider mean-zero signals, normalized between [-10:10] and
164

CT 502 B2: Photon Absorption and Activity
CT 502 - B2
Dominant Period - Proposed Method
Dominant Period - FFT
LD complete
23
24
LD win 1
21
24
LD win 2
22
24
LD win 3
23
24
LD win 4
25
24
DD before
24
24
DD during
-
-
DD during win 1
-
-
DD during win 2
-
-
DD after
-
-
Table 6.9: CT 502 B2: Activity Dominant Period Stability: Proposed Method vs. FFT
sampled every hour. In this case, the analysis corresponding to the LD part has no biological
interest, since the RT-BIO photomultiplier will not record the mouse liver bioluminescence but
the light inside cage corresponding to the 12 hours of light. The complete Photon absorption
signal and the four segments of interest are presented in Figure (6.100).
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
×104
0
1
2
3
4
5
6
7
Light - Day
Before
During
After
B2 Photon All - CT 502 
B2 Photon All - CT 502
Number of days
0
1
2
3
4
5
6
Amplitude
-8
-6
-4
-2
0
2
4
6
8
10
B2 Photon LD - R2 Norm - CT 502 
B2 Photon LD - R2 Norm - CT 502
Number of points
0
Amplitude
-4
-2
0
2
4
6
8
10
B2 Photon Before - DD - R2Norm -CT 502 
B2 Photon Before - DD - R2Norm -CT 502
Number of points
0
Amplitude
-2
0
2
4
6
8
10
B2 Photon During - DD - R2Norm -CT 502 
B2 Photon During - DD - R2Norm -CT 502
Number of points
0
Amplitude
-2
0
2
4
6
8
10
B2 Photon After - DD - R2Norm -CT 502 
B2 Photon After - DD - R2Norm -CT 502
Figure 6.100: Photon raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-
hour sampled
For the LD part, 8 days are available. We compute the PC corresponding to the signal
using the Proposed Method and also using the FFT, Figure (6.101): Via the FFT method, the
principal period is estimated at 24 hours and the next highest peak in the PC amplitude vector
corresponds to 12 hours. Via the Proposed Method, the principal period is estimated at 25
hours, together with the harmonic of 12 hours. However, the amplitude corresponding to the
Proposed Method is much higher.
We consider now 4-days length signals (windows) from the available signal, with a shift
of one day and compute the PC via FFT and the Proposed method, Figure (6.102).
For all the windows, a 24 hours periodicity is conﬁrmed, via the two methods, Fig-
165

6.5.2 - Dominant Period evolution: Photon
Number of days
0
1
2
3
4
5
6
Amplitude
-8
-6
-4
-2
0
2
4
6
8
CT 502 B2 Photon WinComp Signal
CT 502 B2 Photon WinComp Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
2
4
6
8
10
CT 502 B2 Photon WinComp VBA
Periods
7.63 
8    
8.4  8.84 9.33 9.88 10.5 11.2 12   12.92 14   15.27 16.8 18.66 21   
24   
28   33.6 
Amplitude
0
2
4
6
8
10
b
fF F T
CT 502 B2 Photon WinComp FFT
Figure 6.101: Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
Number of days
0
1
2
3
Amplitude
-8
-6
-4
-2
0
2
4
6
8
CT 502 B2 Photon Win1 Signal
CT 502 B2 Photon Win1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
2
4
6
8
10
CT 502 B2 Photon Win1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
2
4
6
8
10
b
fF F T
CT 502 B2 Photon Win1 FFT
Number of days
1
2
3
4
Amplitude
-8
-6
-4
-2
0
2
4
6
8
CT 502 B2 Photon Win2 Signal
CT 502 B2 Photon Win2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
2
4
6
8
10
CT 502 B2 Photon Win2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
2
4
6
8
10
b
fF F T
CT 502 B2 Photon Win2 FFT
Number of days
2
3
4
5
Amplitude
-8
-6
-4
-2
0
2
4
6
8
CT 502 B2 Photon Win3 Signal
CT 502 B2 Photon Win3 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
2
4
6
8
10
CT 502 A2 Photon Win3 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
1
2
3
4
5
6
7
8
9
b
fF F T
CT 502 B2 Photon Win3 FFT
Number of days
3
4
5
6
Amplitude
-8
-6
-4
-2
0
2
4
6
8
CT 502 B2 Photon Win4 Signal
CT 502 B2 Photon Win4 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
2
4
6
8
10
12
CT 502 A2 Photon Win4 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
1
2
3
4
5
6
7
8
9
b
fF F T
CT 502 B2 Photon Win4 FFT
Figure 6.102: PC Stability: PC estimation via FFT and VBA for 4-days length signals
166

CT 502 B2: Photon Absorption and Activity
ure (6.103).
Figure 6.103: PC Stability: Proposed Method (a) vs. FFT (b)
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented in Figure (6.104):
Figure 6.104: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
For the DD period, ﬁrst we consider the before treatment segment. Only 3 days are
available for this segment. We compute the PC vector, using FFT and Proposed Method,
Figure (6.105):
Number of days
0
1
2
Amplitude
-4
-2
0
2
4
6
8
10
CT 502 B2 Photon DDBef Signal
CT 502 B2 Photon DDBef Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 B2 Photon DDBef VBA
Periods
6    
6.54 
7.2  
8    
9    
10.28
12   
14.4 
18   
24   
36   
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 B2 Photon DDBef FFT
Figure 6.105: DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
Via the FFT, the highest pick is set at 24. Of course, given the short length of the signal, 3
days, and the limitations of the FFT method all the values inside the interval (18,36) except 24
are not present in the estimated vector, so the values are uncertain. Via the Proposed method
the dominant period is set at 25 hours.
The evolution of the dominant period, estimated via the Proposed Method and FFT, during
the complete Photon absorption signal, for each segment of interest and for four-days length
signals for the segments that allowed this analysis is presented in Table (6.10).
167

6.5.2 - Dominant Period evolution: Photon
CT 502 - B2
Dominant Period - Proposed Method
Dominant Period - FFT
LD complete
24
24
LD win 1
24
24
LD win 2
24
24
LD win 3
24
24
LD win 4
24
24
DD before
25
24
DD during
24
24
DD during win 1
24
24
DD during win 2
24
24
DD after
23
24
Table 6.10: CT 502 B2: Photon Absorption Dominant Period Stability: Proposed Method vs.
FFT
6.6 CT 502 B3: Photon Absorption and Activity
In the following we consider the experiment CT 502, Mouse B3. This section is dedicated to
the complete study, i.e the study of the physiology, corresponding to the segment LD (light-
dark, 12h-12h), where the mouse was synchronized and DD (total darkness), the segment
corresponding to the before treatment and the study of the behaviour during and after treat-
ment. For the study, two signals were recorded: the Activity Signal measuring the activity
(movement) of the mouse and the Photon Absorption Signal, measuring the number of pho-
ton absorbed, Figure (6.106).
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
0
10
20
30
40
50
60
70
LD Period
Before DD
During DD
After DD
B3 Activity All - CT 502 
B3 Activity All - CT 502
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
×105
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
Light - Dark
Before DD
During DD
After DD
B3 Photon All - CT 502 
B3 Photon All - CT 502
Figure 6.106: CT 502, B3 Mouse: Activity (a) and Photon Absorption (b) raw data
Figure (6.106) presents the raw data corresponding to the Activity signal and Photon
Absorption signal. The signals were recorded for 22 days, sampled every minute. For each
signal, we consider 4 segments: LD Period, corresponding to the synchronization part, then
three parts corresponding to the DD period: before, during and after treatment. We are
interested in the periodic component (PC) vector corresponding to each signal and in the
corresponding acrophase. The stability of the period is veriﬁed using the moving window
strategy, where the available data allows.
168

CT 502 B3: Photon Absorption and Activity
6.6.1
Dominant Period evolution: Activity
We start the analysis with the signal corresponding to the Activity. We will consider mean-
zero signals, normalized between [-10:10] and sampled every hour. The Activity signal and
the four segments of interest are presented in Figure (6.107).
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
0
10
20
30
40
50
60
70
LD Period
Before DD
During DD
After DD
B3 Activity All - CT 502 
B3 Activity All - CT 502
Number of days
0
1
2
3
4
5
6
Amplitude
-2
0
2
4
6
8
10
B3 Activity LD - R2 Norm - CT 502 
B3 Activity LD - R2 Norm - CT 502
Number of days
0
1
2
Amplitude
-4
-2
0
2
4
6
8
10
B3 Activity Before - DD - R2Norm - CT 502 
B3 Activity Before - DD - R2Norm - CT 502
Number of days
0
1
2
3
4
Amplitude
-2
0
2
4
6
8
10
B3 Activity During - DD - R2Norm - CT 502 
B3 Activity During - DD - R2Norm - CT 502
Number of days
0
1
Amplitude
-2
0
2
4
6
8
10
B3 Activity After - DD - R2Norm - CT 502 
B3 Activity After - DD - R2Norm - CT 502
Figure 6.107: Activity raw data (a) and the corresponding parts,(b),(c),(d),normalized and
one-hour sampled
For the LD part, we have 8 days available. We compute the PC corresponding to the sig-
nal using the Proposed Method and also using the FFT, Figure (6.108). Via the FFT method,
Number of days
0
1
2
3
4
5
6
Amplitude
-2
0
2
4
6
8
10
CT 502 B3 Activity WinComp Signal
CT 502 B3 Activity WinComp Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 B3 Activity WinComp VBA
Periods
11.2 
12   
12.92
14   
15.27
16.8 
18.66
21   
24   
28   
33.6 
42   
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 B3 Activity WinComp FFT
Figure 6.108: Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
the principal period is estimated at 24 hours. The next highest pick in the PC vector is cor-
responding to 12 hours. Via the Proposed Method, the principal period is estimated at 25
hours.
We consider now 4-days length signals (windows) from the available signal, with a shift
of one day and compute the PC via FFT and the Proposed method, Figure (6.109).
Via FFT, the dominant period seems stable, for each window the dominant period being
estimated at 24 hours. Via the Proposed Method, the dominant period shifts from 25 hours,
for the ﬁrst window to 24 hours for the second window and third window to 25 hours for the
last window, Figure (6.110).
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented Figure (6.111).:
We consider now the DD period. First, we consider the before treatment segment. Only
3 days are available for this segment. We compute the PC vector, using FFT and Proposed
169

6.6.1 - Dominant Period evolution: Activity
Number of days
0
1
2
3
Amplitude
-4
-2
0
2
4
6
8
CT 502 B3 Activity Win1 Signal
CT 502 B3 Activity Win1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 B3 Activity Win1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 B3 Activity Win1 FFT
Number of days
1
2
3
4
Amplitude
-2
0
2
4
6
8
10
CT 502 B3 Activity Win2 Signal
CT 502 B3 Activity Win2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
CT 502 B3 Activity Win2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
2.5
b
fF F T
CT 502 B3 Activity Win2 FFT
Number of days
2
3
4
5
Amplitude
-2
0
2
4
6
8
10
CT 502 B3 Activity Win3 Signal
CT 502 B3 Activity Win3 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
CT 502 B3 Activity Win3 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
b
fF F T
CT 502 B3 Activity Win3 FFT
Number of days
3
4
5
6
Amplitude
-2
0
2
4
6
8
10
CT 502 B3 Activity Win4 Signal
CT 502 B3 Activity Win4 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
CT 502 B3 Activity Win4 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
2
b
fF F T
CT 502 B3 Activity Win4 FFT
Figure 6.109: PC Stability: PC estimation via FFT and VBA for 4-days length signals
Figure 6.110: PC Stability: Proposed Method (a) vs. FFT (b)
Figure 6.111: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
170

CT 502 B3: Photon Absorption and Activity
Method,Figure (6.112). Via the FFT, the highest pick is set at 24 hours and the next highest
Number of days
0
1
2
Amplitude
-4
-2
0
2
4
6
8
10
CT 502 B3 Activity DDBef Signal
CT 502 B3 Activity DDBef Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
CT 502 B3 Activity DDBef VBA
Periods
6    
6.54 
7.2  
8    
9    
10.28
12   
14.4 
18   
24   
36   
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
b
fF F T
CT 502 B3 Activity DDBef FFT
Figure 6.112: DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
pick is set at 8 hours. Via the Proposed method, the PC amplitude vector is sparse, with only
one non-zero amplitude, corresponding to 24 hours.
For the during treatment part of the data, 5 days are available. We compute the PC corre-
sponding to the during treatment part of the data using the Proposed Method and also using
the FFT, Figure (6.113). Via the Proposed Method, the estimated PC amplitude vector is a
Number of days
0
1
2
3
4
Amplitude
-2
0
2
4
6
8
10
CT 502 B3 Activity DDDur Signal
CT 502 B3 Activity DDDur Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
CT 502 B3 Activity DDDur VBA
Periods
8    
8.57 
9.23 
10   
10.9 
12   
13.33
15   
17.14
20   
24   
30   
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
b
fF F T
CT 502 B3 Activity DDDur FFT
Figure 6.113: DD during signal (a) and the corresponding PC via VBA (b) and FFT (c)
sparse vector and the dominant period is estimated at 24 hours. The other non-zero amplitudes
in the PC amplitudes vector corresponds to 8, 12 and 15 hours. In the FFT estimation, the
dominant period corresponds to 24 hours, and the next two highest peaks in the PC amplitude
vector estimation corresponds to 8 and 12 hours.
We consider now 4-days length signals (windows) from the available signal, with a shift
of one day and compute the PC via FFT and the Proposed method, Figure (6.114).
Number of days
0
1
2
3
Amplitude
-2
0
2
4
6
8
CT 502 B3 Activity DDDurWin1 Signal
CT 502 B3 Activity DDDurWin1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
CT 502 B3 Activity DDDurWin1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
b
fF F T
CT 502 B3 Activity DDDurWin1 FFT
Number of days
1
2
3
4
Amplitude
-2
0
2
4
6
8
10
CT 502 B3 Activity DDDurWin2 Signal
CT 502 B3 Activity DDDurWin2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
CT 502 B3 Activity DDDurWin2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
b
fF F T
CT 502 B3 Activity DDDurWin2 FFT
Figure 6.114: PC Stability: PC estimation via FFT and VBA for 4-days length signals, Activ-
ity DD, during
We note that via the FFT, both windows are estimated with a dominant period of 24 hours,
with harmonics corresponding to 8 and 12 hours. Via the Proposed Method, we ﬁnd the
171

6.6.2 - Dominant Period evolution: Photon
dominant period corresponding to the ﬁrst window at 24 hours (and important picks for 8
and 13 hours) and the dominant period corresponding to the second window at 23 hours (and
important picks for 8 and 13 hours), Figure (6.115).
Figure 6.115: PC Stability: Proposed Method (a) vs. FFT (b)
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented in the following ﬁgure:
Figure 6.116: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
We now consider the after treatment part of the data. Two days are available. For the FFT,
Number of days
0
1
Amplitude
-2
0
2
4
6
8
10
CT 502 B3 Activity DDAft Signal
CT 502 B3 Activity DDAft Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
CT 502 B3 Activity DDAft VBA
Periods
6   
6.85
8   
9.6 
12  
16  
24  
48  
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
b
fF F T
CT 502 B3 Activity DDAft FFT
Figure 6.117: DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
the dominant period corresponds to 12 hours. Via the Proposed Method, the dominant period
is also estimated at 12 hours.
The evolution of the dominant period, estimated via the Proposed Method and FFT, during
the complete Activity signal, for each segment of interest and for four-days length signals for
the segments that allowed this analysis is presented in Table (6.11).
6.6.2
Dominant Period evolution: Photon
In this section we analyse the signal corresponding to the photon absorption, i.e. the gene
expression. Like before, we consider mean-zero signals, normalized between [-10:10] and
172

CT 502 B3: Photon Absorption and Activity
CT 502 - B3
Dominant Period - Proposed Method
Dominant Period - FFT
LD complete
25
24
LD win 1
25
24
LD win 2
24
24
LD win 3
24
24
LD win 4
25
24
DD before
24
24
DD during
24
24
DD during win 1
24
24
DD during win 2
23
24
DD after
12
12
Table 6.11: CT 502 B3: Activity Dominant Period Stability: Proposed Method vs. FFT
sampled every hour. In this case, the analysis corresponding to the LD part has no biological
interest, since the RT-BIO photomultiplier will not record the mouse liver bioluminescence but
the light inside cage corresponding to the 12 hours of light. The complete Photon absorption
signal and the four segments of interest are presented in Figure (6.118)
Number of days
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
Amplitude
×105
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
Light - Dark
Before DD
During DD
After DD
B3 Photon All - CT 502 
B3 Photon All - CT 502
Number of days
0
1
2
3
4
5
6
Amplitude
-6
-4
-2
0
2
4
6
8
10
B3 Photon LD - R2 Norm - CT 502 
B3 Photon LD - R2 Norm - CT 502
Number of points
0
Amplitude
-6
-4
-2
0
2
4
6
8
10
B3 Photon Before - DD - R2Norm -CT 502 
B3 Photon Before - DD - R2Norm -CT 502
Number of points
0
Amplitude
-2
0
2
4
6
8
10
B3 Photon During - DD - R2Norm -CT 502 
B3 Photon During - DD - R2Norm -CT 502
Number of points
0
Amplitude
-8
-6
-4
-2
0
2
4
6
8
10
B3 Photon After - DD - R2Norm -CT 502 
B3 Photon After - DD - R2Norm -CT 502
Figure 6.118: Photon raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-
hour sampled
For the LD part, 7 days are available. We compute the PC corresponding to the signal
using the Proposed Method and also using the FFT, Figure (6.119): Via the FFT method, the
principal period is estimated at 24 hours and the only other non-zero peak in the PC amplitude
vector corresponds to 8 hours. The dominant period of 24 hours and the corresponding 8 hours
harmonic are also the only non-zero amplitudes in the PC amplitude vector corresponding to
the Proposed Method.
We consider now 4-days length signals (windows) from the available signal, with a shift
of one day and compute the PC via FFT and the Proposed method, Figure (6.120).
For all the windows, a 24 hours periodicity is conﬁrmed, via the two methods, Fig-
173

6.6.2 - Dominant Period evolution: Photon
Number of days
0
1
2
3
4
5
6
Amplitude
-6
-4
-2
0
2
4
6
8
10
CT 502 B3 Photon WinComp Signal
CT 502 B3 Photon WinComp Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
2
4
6
8
10
CT 502 B3 Photon WinComp VBA
Periods
7.63 
8    
8.4  8.84 9.33 9.88 10.5 11.2 12   12.92 14   15.27 16.8 18.66 21   
24   
28   33.6 
Amplitude
0
2
4
6
8
10
b
fF F T
CT 502 B3 Photon WinComp FFT
Figure 6.119: Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
Number of days
0
1
2
3
Amplitude
-6
-4
-2
0
2
4
6
8
CT 502 B3 Photon Win1 Signal
CT 502 B3 Photon Win1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
2
4
6
8
10
CT 502 B3 Photon Win1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
2
4
6
8
10
b
fF F T
CT 502 B3 Photon Win1 FFT
Number of days
1
2
3
4
Amplitude
-6
-4
-2
0
2
4
6
8
CT 502 B3 Photon Win2 Signal
CT 502 B3 Photon Win2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
9
10
CT 502 B3 Photon Win2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
1
2
3
4
5
6
7
8
9
10
b
fF F T
CT 502 B3 Photon Win2 FFT
Number of days
2
3
4
5
Amplitude
-6
-4
-2
0
2
4
6
8
CT 502 B3 Photon Win3 Signal
CT 502 B3 Photon Win3 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
9
10
CT 502 B3 Photon Win3 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
1
2
3
4
5
6
7
8
9
10
b
fF F T
CT 502 B3 Photon Win3 FFT
Number of days
3
4
5
6
Amplitude
-6
-4
-2
0
2
4
6
8
CT 502 B3 Photon Win4 Signal
CT 502 B3 Photon Win4 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
1
2
3
4
5
6
7
8
9
10
CT 502 B3 Photon Win4 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
1
2
3
4
5
6
7
8
9
10
b
fF F T
CT 502 B3 Photon Win4 FFT
Figure 6.120: PC Stability: PC estimation via FFT and VBA for 4-days length signals
174

CT 502 B3: Photon Absorption and Activity
ure (6.121).
Figure 6.121: PC Stability: Proposed Method (a) vs. FFT (b)
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented in Figure (6.122):
Figure 6.122: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
We consider now the DD period. First, we consider the before treatment segment. Only
3 days are available for this segment. We compute the PC vector, using FFT and Proposed
Method, Figure (6.123): Via the FFT, the highest pick is set at 24. Other important peaks
Number of days
0
1
2
Amplitude
-6
-4
-2
0
2
4
6
8
10
CT 502 B3 Photon DDBef Signal
CT 502 B3 Photon DDBef Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
CT 502 B3 Photon DDBef VBA
Periods
6    
6.54 
7.2  
8    
9    
10.28
12   
14.4 
18   
24   
36   
Amplitude
0
0.5
1
1.5
2
b
fF F T
CT 502 B3 Photon DDBef FFT
Figure 6.123: DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
correspond to 18, 36 and 12 hours. Of course, given the short length of the signal, 3 days,
and the limitations of the FFT method all the values inside the interval (18,36) except 24 are
not present in the estimated vector, so the values are uncertain. Via the Proposed method the
dominant period is set at 23 hours and the other non-zero peak in the PC amplitude vector
corresponds to 22 hours.
For the during treatment part of the data, ﬁve days are available. We compute the PC
corresponding to the signal using the Proposed Method and also using the FFT, Figure (6.124):
Via FFT, we obtain a 24 hours periodicity, while via the Proposed Method, the dominant peak
corresponds to 23. The only other non-zero amplitude in the PC amplitude vector, corresponds
to 30 hour, which is consistent with the next highest peak in the FFT estimation, also 30 hours.
We note again the difference between the amplitudes corresponding to the two methods and
the sparse PC vector returned by the Proposed Method.
175

6.6.2 - Dominant Period evolution: Photon
Number of days
0
1
2
3
4
Amplitude
-2
0
2
4
6
8
10
CT 502 B3 Photon DDDur Signal
CT 502 B3 Photon DDDur Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
CT 502 B3 Photon DDDurWin1 VBA
Periods
8    
8.57 
9.23 
10   
10.9 
12   
13.33
15   
17.14
20   
24   
30   
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
b
fF F T
CT 502 B3 Photon DDDur FFT
Figure 6.124: DD during signal (a) and the corresponding PC via VBA (b) and FFT (c)
We consider now 4-days length signals (windows) from the available during treatment
part of the data, with a shift of one day and compute the PC via FFT and the Proposed method,
Figure (6.125).
Number of days
0
1
2
3
Amplitude
-2
0
2
4
6
8
CT 502 B3 Photon DDDurWin1 Signal
CT 502 B3 Photon DDDurWin1 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
CT 502 B3 Photon DDDurWin1 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.5
1
1.5
b
fF F T
CT 502 B3 Photon DDDurWin1 FFT
Number of days
1
2
3
4
Amplitude
-3
-2
-1
0
1
2
3
4
5
6
CT 502 B3 Photon DDDurWin2 Signal
CT 502 B3 Photon DDDurWin2 Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
CT 502 B3 Photon DDDurWin2 VBA
Periods
8    
8.72 
9.6  
10.66
12   
13.71
16   
19.2 
24   
32   
Amplitude
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
b
fF F T
CT 502 B3 Photon DDDurWin2 FFT
Figure 6.125: PC Stability: PC estimation via FFT and VBA for 4-days length signals, Photon
DD, during
Analysing the during segment using the moving window, a 24 hour periodicity is found
for both windows, via FFT. However, via the Proposed Method, the periodicity, also stable, is
estimated at 23 hours, Figure (6.126)
Figure 6.126: PC Stability: Proposed Method (a) vs. FFT (b)
An image of dominant period stability or variability, regardless the numerical value of the
amplitude associated with the dominant period is presented in Figure (6.126):
We now consider the after treatment part of the data. We have a 2-days length signal. In
this case, the dominant period is estimated at 24 hours via FFT. This value is very uncertain,
for this particular case (a 2-days length signal) all the interval (16:48) having only one value
that is appearing the FFT PC vector, i.e. 24 hours. Via the Proposed Method, the dominant
period is set at 22 hours.
176

CT 502 B3: Photon Absorption and Activity
Figure 6.127: PC Stability: Proposed Method (a) vs. FFT (b), normalized results
Number of days
0
1
Amplitude
-8
-6
-4
-2
0
2
4
6
8
10
CT 502 B3 Photon DDAft Signal
CT 502 B3 Photon DDAft Signal
Periods
8 
9 
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
CT 502 B3 Photon DDAft VBA
Periods
6   
6.85
8   
9.6 
12  
16  
24  
48  
Amplitude
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
b
fF F T
CT 502 B3 Photon DDAft FFT
Figure 6.128: DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
The evolution of the dominant period, estimated via the Proposed Method and FFT, during
the complete Photon signal, for each segment of interest and for four-days length signals for
the segments that allowed this analysis is presented in Table (6.12).
6.6.3
Conclusions: Dominant Period evolution
We compared the FFT and Proposed Method PC amplitude vector evolution during the four
segments of interest for mouse CT 503 B3, considering the gene expression (Photon Absorp-
tion signal) and the rest-activity patters (Activity signal), Figure (6.106). For both data, we
have considered four segments of interest, i.e. the LD part of the signal, corresponding to
the synchronization and the DD part of the signal, corresponding to the complete darkness,
for which we have considered the segments corresponding to the before, during and after
treatment phase, Figure (6.107) (rest-activity patterns) and Figure (6.118).
In particular, for the ﬁrst segment of interest, i.e. the LD part of data and for the dur-
ing treatment part, we have considered four days length signals to analyse the stability or
variability of the dominant period for the considered segment itself.
The dominant period evolution, corresponding to the Proposed Method and FFT for the
rest-activity patterns (Activity) signal is presented in Table (6.11). Via FFT, the dominant
period seems stable, at 24 hours, during the experiment, except the after treatment part of the
data, for which the dominant period is estimated at 12 hours. Via the Proposed Method, the
period corresponding to the after treatment part is also estimated at 12 hours, in accordance
with the FFT result. For the other part of the data, the dominant period is also estimated
around 24 hours, but with small variations between 23 and 25 hours.
The dominant period evolution, corresponding to the Proposed Method and FFT for the
gene expression data (photon absorption signal), is presented in Table (6.12). For this exper-
iment, via FFT, the dominant period is 24 hours for each segment, and seems stable. Via the
Proposed Method, slight variations are detected during the experiment: a 23 hour periodic-
ity corresponding to the before and during treatment part of data and a 22 hour periodicity
177

6.6.3 - Conclusions: Dominant Period evolution
CT 502 - B3
Dominant Period - Proposed Method
Dominant Period - FFT
LD complete
24
24
LD win 1
24
24
LD win 2
24
24
LD win 3
24
24
LD win 4
24
24
DD before
23
24
DD during
23
24
DD during win 1
23
24
DD during win 2
23
24
DD after
22
24
Table 6.12: CT 502 B3: Photon Dominant Period Stability: Proposed Method vs. FFT
corresponding to the after treatment part of data.
178

7
Conclusions and perspectives
Contents
7.1
Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179
7.2
Perspectives
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181
7.2.1
Multicomponent case: PC amplitudes vectors for multiple inputs . . 181
7.2.2
Sparsity Rate: initialisation and week dependencies . . . . . . . . . 182
7.1 Conclusions
T
HE fundamental objective of this thesis was the study of the periodic components (PC)
amplitudes vector corresponding to chronobiological signals. The context of our work
was chronobiological signal recorded in cancer treatment experiments, and the domain of
interest was the circadian domain. A very important prior information offered by the biologists
concerns the PC amplitudes vector: the number of periods modulating the recorded signals
is small. Also, the experiments impose two fundamental limitations: the short duration of
the signals (relative to the prior dominant period) and the high level of noise. Moreover, for
studying the stability or variability of the PC amplitudes vector, even shorter signals have to
be considered.
In this context, the objective was to develop a method that can offer a good PC ampli-
tudes vector estimation with a certain precision. During this thesis, one hour precision was
considered.
Translating the biological prior information of the small numbers of non zero elements in
PC amplitudes vector as sparsity, the problem considered in this thesis has been formulated
as it follows:
179

CHAPTER 7. CONCLUSIONS AND PERSPECTIVES
Estimate the sparse PC amplitudes vector corresponding to very short duration signals rela-
tive to the (prior) dominant period with a given precision. The number of components is small
(sparse PC amplitudes vector) but unknown.
First, we have examined the classical methods and identiﬁed their drawbacks in the con-
text of our subject. The Fourier Transform methods are successfully used if the duration of
the considered signals are long enough. In our case, due to the short duration of the signals,
the precision is far from being satisfactory. In Chapter (3), Section (3.2), we have showed that
for a four days length signal, in the interval of interest, i.e. the circadian domain [8h : 32h],
we obtain informations corresponding only to 10 periods. Zero padding technique was con-
sidered in Section (3.3), but in this case, the estimation is not sparse, and selecting periods
is difﬁcult. Direct and generalized Inversion was considered in Section (3.4), and we have
showed that except the case where the considered signal is not noisy, the method fails to offer
a good estimation of the PC amplitudes vector, even though the reconstruction of the signal is
accurate for all levels of noise. In Section (3.5) we have considered the Least Squares and the
regularized Least Squares, showing that both approaches fail to correctly estimate the PC am-
plitude vector. In Section (3.6) we considered the L1 regularization and the LASSO method.
This method is the nearest state of art method to account for sparsity through L1 regularization
term. However, we showed that even if very often the results are good, it happens also that for
different noise realizations the algorithm does not give satisfactory results.
In the approach proposed in the this thesis, we have considered a forward model, built
in the same way as the one corresponding to the Fourier transform, but using the elements
that correspond to the considered circadian PC vector, Equation (4.4) and Equation (4.7).
Estimating the PC amplitudes vector from the linear model corresponds to an ill-posed inverse
problem. More precisely, in the context of this forward model, the duration of the observed
signal (96h in synthetic simulations) the limits and the precision of the periods to explore
[8h : 32h], the matrix of the forward model has a huge condition number. We have proposed
an inversion based on general Bayesian Inference, building an hierarchical model based on
the generalized Student-t prior distribution modelling the PC amplitudes vector.
The Student-t distribution was considered as a sparsity enforcing prior due to its IGSM
property, i.e. the standard Student-t distribution St(x|ν) can be expressed as the marginal
of a bivariate Normal-Inverse Gamma distribution, when considering equal parameters of the
Inverse Gamma distribution α = β =
ν
2. In this thesis, we have used a generalized form
of the Student-t distribution, introduced via the IGSM property but not imposing the equality
between the shape and scale parameters corresponding to the Inverse Gamma distribution. The
advantage was given by the fact that for the generalized Student-t distribution, the variance
can take any positive value, (different from the standard Student-t distribution for which the
variance is greater than 1). Some details about this generalized Student-t distribution and its
properties are presented in Appendix (A) and in a paper submitted to IEEE Signal Processing
Letters.
The Bayesian approach allowed us to estimate also the variances associated with the PC
amplitude vector. The model that was developed in this thesis considered a non-stationary
Gaussian model for the errors (noise).
In Chapter (5) we have presented the results corresponding to the proposed model, show-
ing that the PM estimation corresponding to the proposed Student-t hierarchical model gives
accurate results which are stable.
180

Perspectives
In Chapter (6) the developed algorithm was applied on real data issued from cancer treat-
ment experiments. In this chapter, the results corresponding to the proposed method are com-
pared to the FFT results, which is the standard method for PC estimation in chronobiology
today. We have showed that the proposed method is able to detect variances that are not de-
tected by the FFT method. Some details of this approach and its application on simulated and
real data are published in the following papers:
• Mircea Dumitru, Ali Mohammad-Djafari, Simona Baghai Sain (2015). Precise periodic
components estimation for chronobiological signals through Bayesian Inference with
sparsity enforcing prior. EURASIP Journal on Bioinformatics and Systems Biology,
special issue on Bayesian Methods for Computational Systems Biology, 2015
• Ali Mohammad-Djafari, Mircea Dumitru (2015). Bayesian sparse solutions to linear
inverse problems with non-stationary noise with Student-t priors, Digital Signal Pro-
cessing, 2015, doi:10.1016/j.dsp.2015.08.005
7.2 Perspectives
In this subsection we discuss some possible perspectives of our work.
7.2.1
Multicomponent case: PC amplitudes vectors for multiple inputs
We discussed during this thesis, in Chapter (4), the fact the two equivalent direct models can
be considered: the one expressed in Equation (4.4) and the one expressed in Equation (4.7),
equivalent with Equation (4.4) via (4.6). The same hierarchical model, with a generalized
Student-t distribution as a sparsity enforcing prior for the PC amplitude vector and a non-
stationary Gaussian model for the errors can be applied for both forward models. However, in
the case of the linear model Equation (4.4), the link between the two PC amplitudes vectors
(i.e. f 1 and f 2, corresponding to the sine and cosine) is done by imposing the same variance
vf. This idea can be applied when the developed algorithm is used not for the case of one
signal recorded in the experiment, but for two or more signals. For the same experiment,
the gene expression signal and the activity signal are available. For the same experiment
other signal associated with the circadian clock can be recorded, (like temperature). The
developed algorithm can be extended to the multicomponent case. Given a set of available
signals, recorded for the same experiment, the algorithm will estimate the PC amplitudes
vectors containing the most common periodic components corresponding to the set of signals.
This can be done via the same technique used in the case of one available signal, imposing
the same variance for every PC amplitude vector corresponding to the available signals.
In the following, for the sake of simplicity we will consider as a reference, the linear
model expressed in Equation (4.7). However, the same development can be done using Equa-
tion (4.4). If the number of available signals is K, and for each available signal we use the
notation gk, k ∈{1, 2, ...K}, for the corresponding PC amplitudes vector we use the notation
f k, k ∈{1, 2, ...K} and for the corresponding error vector ǫk, k ∈{1, 2, ...K} the developed
method can be used in order to estimate each f k, for k ∈{1, 2, ...K}, considering as the
181

7.2.2 - Sparsity Rate: initialisation and week dependencies
direct model gk = Hf k + ǫk, for k ∈{1, 2, ...K} and the corresponding hierarchical model.
However, doing this, the advantage of multiple signals available is not exploited, since for
estimation f k it is used only the corresponding signal gk.
In order to use all the available data, we can link all the PC amplitudes vectors estimations
f k, for k ∈{1, 2, ...K} by imposing the same variance:
vfk = vf, ∀k ∈{1, 2, ...K};
(7.1)
The advantage of such an approach is given directly by the sparsity mechanism, explained
in Section (4.1): during the iterations the algorithm will impose zero value amplitudes for
the periods in the PC amplitude vector corresponding to small variances. Therefore, the ﬁnal
estimation for each PC amplitudes vector will contain non-zero values only for the periods that
correspond to the most signals and will exclude the ones corresponding to a small number of
signals from the available data.
Formally, this can be done using as the forward model:
gk = Hf k + ǫk, k ∈{1, 2, ...K};
(7.2)
or
G = HF + Ψ
(7.3)
where G = [g1, g2, . . . , gK], F = [f 1, f 2, . . . , f K] and Ψ = [ǫ1, ǫ2, . . . , ǫK].
7.2.2
Sparsity Rate: initialisation and week dependencies
Another perspective of the our work related with the generalized Student-t distribution. The
Stg distribution was used as the prior distribution in our hierarchical model in order to enforce
sparsity. The distribution is presented in detail in Appendices (A).
Brieﬂy, we have noted that for the standard Student-t distribution St(x|ν) its variance is
deﬁned as
ν
ν−2 for ν > 2 and ∞for 1 < ν ≤2, so the variance of the standard Student-t
distribution is always superior to 1. We have also noted that for the generalized Student-
t distribution Stg(x|α, β), presented in Equation (A.25), its variance is deﬁned as
β
α−1 for
α > 1 and ∞for 1/2 < α ≤1, (and in particular has the same expression as the mean
of the Inverse Gamma distribution corresponding to the Normal-Inverse Gamma distribution
that is marginalized for obtaining the generalized Student-t distribution) so once the shape
parameters α is set greater than 1, the variance of Stg(x|α, β) can be set at any wanted positive
value. In particular, in the context of a distribution that is used as a sparsity enforcing prior
this is of great interest.
For the developed algorithm, a crucial interest is represented by the initialization part,
where the prior parameters are set. Via the generalized Student-t distribution one way to con-
sider the initialization is to set the two parameters via the mean and the variance of the Inverse
Gamma. Noting that the mean of the Inverse Gamma distribution has the same expression as
the variance of the Student-t distribution:
EIG [v] =
β
α −1 = V arStg [x] = ǫ, for α > 1
(7.4)
and the expression of the Inverse Gamma variance is
V arIG [v] =
β2
(α −1)2(α −2) = w, for α > 2,
(7.5)
182

Perspectives
the choice of the prior parameters can be done in accordance with data, initializing the algo-
rithm via the associated Stg variance of the unknown vector, i.e. the PC amplitudes vector f
and the IG variance of the corresponding variance, vf.
In our work, the two prior parameters corresponding to the generalized Student-t distri-
bution are set via ǫ, which denotes the Student-t variance and w, which denotes the Inverse
Gamma variance. We have used Equation (4.65), in such way that α > 2, so that both the
variances are well deﬁned and the Student-t variance is small (in order to assure the sparsity,
Figure (A.3), Appendices (A)). One possible extension is to use Equation (4.65) with variance
values ǫ and w statistically derived from data.
Expressing the two parameters of the distribution using the mean and the variance of the
corresponding Inverse Gamma distribution, we have showed that the Sparsity Rate (SR) de-
pends on ǫ, the mean of the Inverse Gamma and the variance of the generalized Student-t dis-
tribution (Figure (A.3), Appendices (A)). But Figure (A.3) shows another interesting result,
a weak dependence of the SR with respect to w, the variance of the Inverse Gamma distribu-
tion. This result should be deepened, formalized and analytically explained by considering
the expression SR = p(|x| > t).
183


A
Generalized Student-t
Contents
A.1
Context . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 185
A.2
Student-t: Origins . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 187
A.2.1
ML parameter estimation . . . . . . . . . . . . . . . . . . . . . . . 187
A.2.2
Bayesian parameter estimation . . . . . . . . . . . . . . . . . . . . 188
A.3
Generalization from the Bayesian point of view . . . . . . . . . . . . . . 189
A.4
Sparsity Rate and Generalized Student-t
. . . . . . . . . . . . . . . . . 190
A.5
Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 192
T
HIS Appendix is dedicated to the generalized Student-t distribution. During this thesis,
we have used the notation Stg(x|α, β) for the generalized Student-t, which was obtained
from the bivariate Normal-Inverse Gamma distribution. The interest for this generalization
is the possibility to set any positive value for the variance, so therefore imposing the wanted
sparsity rate. In this Appendix, ﬁrst we discuss the context where this distribution can be
used, then we discuss the origins of the Student-t distribution, then we present the computa-
tions for obtaining the analytical expression of the generalized Student-t distribution and the
computations corresponding to the expressions of the mean and variance.
A.1 Context
During this thesis we have noted that beside the regularization techniques, the other approach
that has been successfully tested to account for sparsity is the Bayesian one. We have also
mentioned that for Bayesian inference generally two strategies are used: (a) the strict spar-
sity requirement, via Bernouilli distribution: Bernouilli-Gaussian [GDI90, CGI96, GILC08],
Bernouilli-Laplace [DB08], Bernouilli-Gamma and (b) the sparsity enforcing, where mainly
185

APPENDIX A. GENERALIZED STUDENT-T
three categories of priors have been considered and used: Generalized Gaussian (GG), Mix-
ture models and heavy tailed probability laws such as Student-t. A review of those priors can
be found in [Tip01, MD12].
The context of the generalized Student-t is placed relative to this second strategy, where
the searched solution is not strictly sparse, but sparse in the sense that the a high number
of elements are sufﬁciently small. We note that in this case we, the threshold is particular
important, in order to control the interval of small values that are associated with the zero
values.
Also, depending on the application considered, the input f may have different sparsity
rates, depending on the application, therefore the prior information concerning the Sparsity
Rate (SR) have to be accounted.
In this Appendices, we present the generalization of the Student-t distribution that allows
accounting for the SR. The standard Student-t pdf is given by the expression:
St(x|ν) =
Γ

ν+1
2

√νπ Γ

ν
2

 
1 + x2
ν
!−ν+1
2
,
ν > 0,
(A.1)
where ν is the number of degrees of freedom and Γ is the Gamma function. It is generalized
by introducing a location parameter µ and a scale parameter σ:
St(x|ν, µ, σ) =
Γ( ν+1
2 )
√νπ σ Γ( ν
2)

1 + 1
ν
 x−µ
σ
2−ν+1
2 ,
ν > 0, σ > 0, µ ∈R
(A.2)
The Student-t distribution can also be expressed via the IGSM:
St(x|ν) =
Z ∞
0
N (x|0, 1
z) G(z|ν
2, ν
2) dz
(A.3)
where N (x|m, v) = (2πv)−1
2 exp{−1
2v(x −m)2} is the Normal distribution and G(x|α, β) =
βα
Γ(α)xα−1 exp{−βx} is the Gamma distribution. The IGSM name comes from the fact that
when a bivariate pdf composed of the product of a zero mean Normal distribution N (x|0, 1
z)
with variance v =
1
z and a Gamma pdf for the inverse of the variance (precision) z =
1
v,
having equal scale and shape parameters α = β = ν
2
p(x, z|ν) = N (x|0, 1
z) G(z|ν
2, ν
2).
(A.4)
Now, marginalizing z or v = 1
z results to Student-t pdf as is given in Equation (A.3).
There are many works on the origins, properties and many other relations and generaliza-
tions
of
this
distribution. Some of them can be seen in [Fis25],[Li57],[Zel76],[Fer99],[KBJ00],[AH06].
Those works can mainly be classiﬁed in three categories: Probability and information theory,
Classical statistics and Bayesian inference. In probability theory Student-t pdf is deﬁned as
the pdf of the ratio of two variables: z with a Normal pdf and v with a chi-squared pdf. In clas-
sical statistics, its origins goes back to the Maximum Likelihood (ML) estimate of the mean
and variance of a Normal distribution. In Bayesian inference framework, the origin goes back
to the same context of ML parameter estimation but with a Jeffreys prior. In this paper, we
186

Student-t: Origins
focus on the Bayesian inference of the mean and the variance of a Normal distribution when a
Normal-Inverse Gamma prior is assigned to them. By doing this, we obtain an expression for
the marginal posterior pdf of the mean which extends the classical deﬁnition of the Student-t.
In this way, we obtain a two parameters Student-t that we called generalized Student-t Stg.
The rest of Appendices (A) is organized as follows: in Section (A.2), we give a brief presen-
tation of the origins of the distribution considered. Then, in Section (A.3) we present the new
generalized Student-t and some of its properties, in particular the computation of the expected
value and the variance. We will show that the variance can take any positive values. We
also present the link between the variance corresponding to the Stg and the expected value
corresponding to the IG, modeling the prior variance. Section (A.4) presents how using this
property of the variance can be linked with the SR and presents the relation between those
two values. The conclusions are presented in Section (A.5).
A.2 Student-t: Origins
Student-t distribution was ﬁrst derived as a Bayesian posterior distribution in 1876 by Helmert
[Hel75, Hel76b, Hel76a] and Lüroth.[L¨76]. It takes its name from William Sealy Gosset’s
1908 paper in Biometrika under the pseudonym "Student" [Gos08, Mor08]. In Probability
theory, Student’s t-distribution with ν degrees of freedom is deﬁned as the distribution of a
random variable X deﬁned as the ratio of two independent random variables:
X =
Z
q
V/ν
= Z
r ν
V ,
(A.5)
where Z has a standard normal distribution with expected value 0 and variance 1; V has a
chi-squared distribution with ν degrees of freedom [SR94]. Student’s t-distribution has also
been deﬁned as the Maximum Entropy probability distribution for a variable X for which
E {ln(ν + X2)} is ﬁxed [Haz01, VR02, GCSR03, WMMY02]. Also, it has been shown that
the T-distribution pdf is a solution to the following differential equation [HMC02]:



(ν + x2) f ′(x) + (ν + 1)xf(x) = 0,
f(1) = νν/2(ν+1)−ν
2 −1
2
B( ν
2 , 1
2)
(A.6)
In this paper, we consider two main origins of this distribution: the classical Maximum Like-
lihood (ML) parameter estimation of a Normal distribution and the Bayesian approach of this
problem via the Jeffreys prior. We introduce these two approaches brieﬂy.
A.2.1
ML parameter estimation
If x1, ..., xN are i.i.d samples from a Normal distribution with unknown mean µ and variance
v,
xi ∼N (xi|µ, v), i ∈{1, 2, . . ., N} ,
(A.7)
the maximum likelihood estimate of (bµ, bv) is deﬁned as
(bµ, bv)ML = arg max
(µ,v) {p(x|µ1, vI)} = arg min
(µ,v) {L(µ, v)}
(A.8)
187

A.2.2 - Bayesian parameter estimation
where L(µ, v) = −ln p(x|µ1, vI) = −PN
i=1 ln(p(xi|µ, v)). It is easy to show that the ex-
pression of L(µ, v) depends only on the two following sufﬁcient statistics:
¯x = 1
N
N
X
i=1
xi
and
s2 =
1
N −1
N
X
i=1
(xi −¯x)2
(A.9)
and are given by:
(
bµ = ¯x
bv = s2
(A.10)
It can also be easily shown that
(
¯x ∼N (¯x|µ, v
N )
s2 ∼χ2(s2|N −1),
(A.11)
where χ2 represents the Chi-squared distribution which is a particular case of the Gamma
distribution, and that the random variable deﬁned by T =
¯x−µ
s/
√
N , called pivot variable, follows
a Student-t distribution with N −1 degrees of freedom:
T = ¯x −µ
s/
√
N ∼St(t|N −1).
(A.12)
A.2.2
Bayesian parameter estimation
The Bayesian way to estimate (µ, v) needs the expression of the likelihood as before:
p(x|µ, v) =
N
Y
i=1
N (xi|µ, v) = N (x|µ1, vI),
(A.13)
but also assigning a prior to (µ, v). When choosing the Jeffreys priors p(µ, v) ∝1
v, which
is a particular case of a Normal-Inverse Gamma pdf: p(µ, v) = N (µ|µ0, v)IG(v|α, β) with
µ0 = α = β = 0, corresponding to a zero mean Normal distribution and a degenerate case of
the Inverse Gamma distribution, i.e.
(
p(µ|v) = N (µ|0, v)
p(v) = IG(v|0, 0)
(A.14)
we obtain the expression of the posterior law:
p(µ, v|x) ∝v−N
2 −1 exp
(
−1
2v
N
X
i=1
(xi −µ)2
)
(A.15)
from which we can deduce:
(
p(µ|x, v) = N (µ|¯x, v
N )
p(v|x) = χ2(v|N)
(A.16)
Now, looking for the marginal:
p(µ|x) =
Z ∞
0
p(µ, v|x) dv ∝
Z ∞
0
N (x|µ1, vI)1
v dv
= St(µ|¯x,
√
Ns2, N).
(A.17)
The standard Student-t appears via the pivot variable, T:
T =
¯x −µ
√
s2/
√
N
∼St(t|N −1).
(A.18)
188

Generalization from the Bayesian point of view
A.3 Generalization from the Bayesian point of view
In the previews Bayesian estimation, a more general informative prior for (µ, v) in the form
p(µ, v) = p(µ|v)p(v)
(A.19)
with
(
p(µ|v) = N (µ|0, v)
p(v|α, β) = IG(v|α, β)
(A.20)
leads to the joint posterior distribution:
p(µ, v|x) ∝
N
Y
i=1
N (xi|µ, v)N (µ|0, v)IG(v|α, β)
∝N (µ|bµ, bv)IG(v|bα, bβ)
(A.21)
with
(
bµ =
N
N+1 ¯x
bv =
1
N+1v
;
( bα = α + N
2
bβ = β + 1
2

−N2
N+1 ¯x2 +
PN
i=1 x2
i

(A.22)
From this joint posterior distribution the expression of the conditional posterior p(µ|x, v) and
posterior p(v|x, α, β) are easily derived:
(
p(µ|x, v) = N (µ|bµ, bv)
p(v|x, α, β) = IG(v|bα, bβ)
(A.23)
The marginal posterior distribution p(v|x, α, β) is an Inverse Gamma distribution and is de-
scribed by the two parameters bα and bβ of Equation (A.22). For obtaining the marginal poste-
rior distribution corresponding to µ, we need to compute:
p(µ|x)
=
Z ∞
0
N (µ|bµ, bv)IG(v|bα, bβ) dv
(A.24)
This is how a generalization of the Student-t appears naturally. In the following we consider
Equation (A.24) for which we show the analytical expression and some of its properties. For
the sake of simplicity we develop the case corresponding to bµ = 0 corresponding to the zero
mean Normal distribution.
Theorem: For two random variables following a bivariate Normal-Inverse Gamma distri-
bution, (X, V ) ∼N (x|0, v) IG(v|α, β), the marginal distribution corresponding to X is a
Student-t like distribution, generalizing the classical form, denoted Stg, depending on the two
parameters α and β corresponding to the Inverse-Gamma distribution having the following
pdf:
Stg(x|α, β) =
Z ∞
0
N (x|0, v)IG(v|α, β) dv
=
Γ(α + 1
2)
√2βπ Γ(α)
 
1 + x2
2β
!−(α+ 1
2)
, α > 0, β > 0.
(A.25)
189

A.2.2 - Bayesian parameter estimation
Proof: The expression of the distribution is obtained directly:
Stg(x|α, β) =
=
Z ∞
0
1
√
2πv exp

−1
2vx2
 βα
Γ(α)v−(α+1) exp
(
−β
v
)
dv
=
βαΓ(α + 1
2)
√
2πΓ(α)

β + x2
2
(α+ 1
2 )
Z ∞
0
IG
 
v|α + 1
2, β + x2
2
!
dv
=
Γ(α + 1
2)
√2βπ Γ(α)
 
1 + x2
2β
!−(α+ 1
2)
.
(A.26)
Remark 1: For α = β = ν
2, we obtain the standard case: Stg(x| ν
2, ν
2) = St(x|ν).
Remark 2: The expected value of the Stg(x|α, β) is zero for α > 1
2 and is undeﬁned other-
wise:
E{(x|α, β)} =
(
0
for α > 1
2,
undeﬁned
for 0 < α ⩽1
2.
(A.27)
Proof: The proof follows the same steps as the one corresponding to the standard case, also
using the fact that Stg(x|α, β) is an even function. One difference appears for the interval
of the α parameter for which the mean is deﬁned. In this case, during the computations the
integral
R ∞
0 x

1 + x2
2β
−(α+ 1
2) dx is considered. The integral is ﬁnite only for α > 1
2.
Remark 3: The variance of the Stg(x|α, β) is
β
α−1 for α > 1, is ∞for 1
2 < α ⩽1 and is
undeﬁned otherwise:
Var{(x|α, β)} =





β
α−1
for α > 1,
∞
for
1
2 < α ⩽1,
undeﬁned
for 0 < α ⩽1
2.
(A.28)
Proof: The proof follows the same steps as the one corresponding to the standard case and is
using the Euler integral of the ﬁrst kind.
Remark 4: We note that for α > 1, the mean of the IG distribution appearing in the ex-
pression of the bivariate Normal-Inverse Gamma distribution is well deﬁned and has the same
value as the variance of Stg:
VarStg{(x|α, β)} = EIG{(v|α, β)} =
β
α −1
(A.29)
This property is particularly interesting in the sparsity context. It is showing how the sparsity
mechanism is strongly related with the associated prior variances of the model. The bivariate
Normal-Inverse Gamma distribution and the corresponding marginal, i.e. the generalized
Student-t distribution are presented in Figure (A.1).
A.4 Sparsity Rate and Generalized Student-t
The Student-t distribution represents a good prior distribution for enforcing the sparsity,
thanks to its heavy tailed form. Among many other distributions having a heavy tailed form,
190

Sparsity Rate and Generalized Student-t
a) Normal-Inverse Gamma modelling (x, v)
-0.2
-0.1
0
0.1
0.2
0
2
4
6
8
10
12
14
16
18
b) Stg modelling x: VarStg{(x|α, β)} = ǫ = 0.1
Figure A.1: Normal-Inverse Gamma distribution (a) and the corresponding marginal Stg (b).
Illustrated for ǫ = 0.1 and k = 1, Eq. (A.30a) and Eq. (A.30b)
such as Double Exponential (DE) or Generalized Gaussian (GG), the Student-t distribution is
particularly interesting thanks to its IGSM expression and the conjugacy property of the Nor-
mal and Gamma (or Inverse Gamma) distributions. Therefore, in many Bayesian approaches
searching for sparse solutions, this distribution is of great interest. However, the mechanism
of the Bayesian algorithms where a sparse solution is searched is using at one hand the heavy-
tailed form of the prior distribution and at the other hand the small value of the variance. The
use of the standard Student-t distribution imposes a limitation: the variance is always greater
than 1. In this context, considering the generalization of the Student-t distribution and notably
the relation from Equation (A.28), we see the importance of this generalization for which the
variance may be set at any required value. Furthermore, Equation (A.29) sets the link between
the sparsity of a quantity x and the associated variances v. For Stg variance ǫ and IG variance
k, we have:
VarStg{(x|α, β)} = EIG{(v|α, β)} =
β
α −1 = ǫ;
(A.30a)
VarIG{(v|α, β)} =
β2
(α −1)2(α −2) = k;
(A.30b)
A solution for setting the scale and shape parameters α and β depending on the variance of
the generalized Student-t distribution ǫ and the variance of the Inverse Gamma distribution k
191

A.2.2 - Bayesian parameter estimation
is given in Equation (A.31).
( α = 2 + ǫ2
0
β =
√
kǫ0(1 + ǫ2
0) , ǫ0 =
ǫ
√
k;
(A.31)
We note that via Equation (A.31), α > 2 and β > 0: for both the Stg and IG distributions,
the corresponding expected values and variances are well deﬁned. The Sparsity Rate (SR) is
deﬁned in Equation (A.32).
SR = #non-zero points
#points
(A.32)
To show the link between the SR and the variance of the generalized Student-t distribution, ǫ,
we consider the sparse structure x and the corresponding variance v as it follows: (i) we con-
sider 10000 samples for the variance, IG distributed, Figure (A.2) (a); (ii) we consider 10000
samples for x, N distributed, with zero mean and the variance selected from (a), Figure (A.2)
(b); (iii) we set a threshold for x, (|x| < 0.1), obtaining a sparse structure, Figure (A.2) (c);
We consider different sparse structures x, corresponding to different values ǫ and k, Equa-
tion (A.31), and compute the associated SR value, Equation (A.32). Figure (A.3) presents the
behaviour of the SR depending on the Stg variance ǫ, for different values considered for the
variance of the IG, k. We note that regardless the considered values k, the SR is decreasing
with ǫ.
A.5 Conclusion
Based on Bayesian inference of the mean µ of a Gaussian pdf N (x|µ, v) with unknown vari-
ance v on which an a priori Inverse Gamma pdf IG(v|α, β) is assigned, we considered the
generalized Student-t pdf Stg(x|α, β) which becomes the standard Student t-distribution when
α = β = ν/2. We showed that the variance of this distribution can take any positive values,
and how it is linked with the SR. We showed how the two parameters of the generalized
Student-t can be set such that the value of the variance is imposed. Depending on applica-
tions, the SR can have different values, and the proposed distribution is offering a solution for
selecting a prior which is in accordance with data in terms of SR.
192

Conclusion
Number of samples
0
2000
4000
6000
8000
10000
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
a) IG distributed samples v ∼IG(v|α, β)
Number of samples
0
2000
4000
6000
8000
10000
-0.6
-0.4
-0.2
0
0.2
0.4
b) Stg distributed samples x ∼Stg(x|α, β)
Number of samples
0
2000
4000
6000
8000
10000
-0.6
-0.4
-0.2
0
0.2
0.4
c) Sparse signal obtained by thresholding |x| < 0.1
Figure A.2: Sparse signal, distributed following the generalized Student-t distribution after
thresholding
193

A.2.2 - Bayesian parameter estimation
eps
10    
5     
4     
3     
2     
1     
0.1   
0.01  
0.001 
0.0001
SR
0
0.2
0.4
0.6
0.8
1
k=10
k=5
k=4
k=3
k=2
k=1
k=0.1
k=0.01
k=0.001
k=0.0001
a) Sparsity rate as a function of ǫ, Eq. (A.30a)
k
10    
5     
4     
3     
2     
1     
0.1   
0.01  
0.001 
0.0001
SR
0
0.2
0.4
0.6
0.8
1
e=10
e=5
e=4
e=3
e=2
e=1
e=0.1
e=0.01
e=0.001
e=0.0001
b) Sparsity rate as a function of k, Eq. (A.30b)
Figure A.3: Behaviour of the Sparsity Rate as a function of ǫ for different values of k
Eq. (A.30a)
194

B
Publications
Journal Articles
• [J1] Mircea Dumitru, Ali Mohammad-Djafari, Simona Baghai Sain (2016). Precise
periodic components estimation for chronobiological signals through Bayesian Infer-
ence with sparsity enforcing prior. EURASIP Journal on Bioinformatics and Systems
Biology, special issue on Bayesian Methods for Computational Systems Biology, 2016,
doi:10.1186/s13637-015-0033-6
• [J2] Ali Mohammad-Djafari, Mircea Dumitru (2015). Bayesian sparse solutions to
linear inverse problems with non-stationary noise with Student-t priors, Digital Signal
Processing, 2015, doi:10.1016/j.dsp.2015.08.005
• [J3] Xiao-Mei Li, Ali Mohammad-Djafari, Mircea Dumitru, Sandrine Dulong, Elisa-
beth Filipski, Sandrine Siffroi-Fernandez, Ali Mteyrek, Francesco Scaglione, Catherine
Guettier, Franck Delaunay and Francis Lévi (2013). A circadian clock transcription
model for the personalization of cancer chronotherapy, Cancer Research, American As-
sociation for Cancer Research, 2013, 73 (24), pp.7176-88. <10.1158/0008-5472.CAN-
13-1528>
Conference Papers
• [C1] Li Wang, Ali Mohammad-Djafari, Nicolas Gac, Mircea Dumitru,(2016). Com-
puted tomography reconstruction based on a hierarchical model and variational
bayesian method. In 41st IEEE International Conference on Acoustics, Speech and
Signal Processing (ICASSP 2016), actes : ISBN:— ,in Shanghai, China
195

• [C2] Mircea Dumitru, Ali Mohammad-Djafari (2015). Periodic components estima-
tion in chronobiological time series via a Bayesian approach. In 23rd IEEE European
Signal Processing Conference, (EUSIPCO 2015), actes : ISBN: 978-0-9928626-4-0,
pages —–, Nice Congress Center, in Nice, France
• [C3] Mircea Dumitru, Ali Mohammad-Djafari (2014). Estimating the periodic compo-
nents of a biomedical signal through inverse problem modelling and Bayesian inference
with sparsity enforcing prior. In the 34th International Workshop on Bayesian Inference
and Maximum Entropy Methods in Science and Engineering (MaxEnt 2014) Proceed-
ings, actes : volume 1641, pages 548-555, Château Clos Lucé, Parc Leonardo Da Vinci,
Amboise, France
Oral and Poster presentations
• [OP1] Xiao-Mei Li, Mircea Dumitru, Narin Ozturk , Ali Mohammad-Djafari , Fran-
cis Lévi (2015). Characterization of circadian rhythms of liver Per2::luc expression in
freely moving mice. European Biological Rhythms Society (EBRS)/World Congress of
Chronobiology (WCC) meeting, Manchester, UK
• [OP2] Mircea Dumitru, Ali Mohammad-Djafari, Xiao-Mei Li, Francis Lévi (2013).
Prediction of weight loss in cancer treatment from the Reverb-α and Bmal1 gene ex-
pressions. Interdisciplinary Symposium on Signals and Systems for Medical Applica-
tions (ISSSMA13), June 2013, Paris France.
• [OP3] Ali Mohammad-Djafari, Leila Gharsalli, Mircea Dumitru (2012). Bayesian
variational approximation implementation for linear inverse problem with inﬁnite Gaus-
sian mixture model. Journées Résolution de problèmes inverses : optimisation et par-
allélisation (GDR ISIS). Paris France.

Bibliography
[AH06]
K. Aas and I.H. Haff. The generalized hyperbolic skew student’s t-distribution.
Journal of Financial Econometrics, 4(2):275–309, 2006.
[AKZ06]
A. Achim, E. E. Kuruoglu, and J. Zerubia.
Sar image ﬁltering based on
the heavy-tailed rayleigh model.
IEEE Transactions on Image Processing,
15(9):2686 – 2693, Sept. 2006.
[AMD09]
Hacheme Ayasso and Ali Mohammad-Djafari.
Joint image restoration and
segmentation using Gauss-Markov-Potts prior models and variational bayesian
computation. In Proceeding of the 15th IEEE International Conference on Im-
age Processing, (ICIP), pages 1297–1300, Égypte, 2009.
[AMD10]
Hacheme Ayasso and Ali Mohammad-Djafari.
Joint NDT image restora-
tion and segmentation using Gauss–Markov–Potts prior models and variational
bayesian computation. IEEE Transactions on Image Processing, 19(9):2265–
2277, 2010.
[BCMR09]
M. Beaumont, J.M. Cornuet, J.M. Marin, and C.P. Robert. Adaptive approxi-
mate bayesian computation. Biometrika, 96(4):983–990, 2009.
[Bea03]
M. Beal. Variational Algorithms for Approximate Bayesian Inference. PhD
thesis, Gatsby Computational Neuroscience Unit, University College London,
2003.
[BF10]
M. Blum and O. François.
Non-linear regression models for approximate
bayesian computation. Statistics and Computing, 20(1):63–73, 2010.
[Blu10]
M. Blum. Approximate bayesian computational: a non-parametric perspective.
Journal of the American Statistical Association, 491:1178–1187, 2010.
[CGHM14]
N. Chen, D. Giannakis, R. Herbei, and A.J. Majda.
An mcmc algorithm
for param- eter estimation in signals with hidden intermittent instability.
SIAM/ASA Journal on Uncertainty Quantiﬁcation, 2:647–669, 2014.
[CGI96]
F Champagnat, Y. Goussard, and J. Idier.
Unsupervised deconvolution of
sparse spike trains using stochastic approximation. IEEE Trans. signal pro-
cessing, 44(12):2988–2998, 1996.
[CKS15]
Y. Chen, E. E. Kuruoglu, and H. C. So. Optimum linear regression in additive
cauchy–gaussian noise. Signal Processing, 106:312–318, 2015.
197

BIBLIOGRAPHY
[CMD97]
H. Carfantan and Ali Mohammad-Djafari. A Bayesian framework for nonlinear
diffraction tomography. In IEEE EURASIP Workshop on Nonlinear Signal and
Image Processing NSIP’97, Mackinac island, MI, USA, September 1997.
[CW98]
T. F. Chan and C. K. Wong. Total variation blind deconvolution. IEEE Trans
Image Process, 7(3):370–375, 1998.
[CWB08]
E. J. Candès, M. Wakin, and S. Boyd. Enhancing sparsity by reweighted l1 min-
imization. Journal of Fourier Analysis and Applications, 14:877–905, 2008.
[DB08]
Julia A Dobrosotskaya and Andrea L Bertozzi. A wavelet-laplace variational
technique for image deconvolution and inpainting. IEEE Trans Image Process,
17(5):657–663, May 2008.
[DDJ09]
P. Del Moral, A. Doucet, and A. Jasra. An adaptive sequential monte carlo
method for approximate bayesian computation. Technical report, Imperial Col-
lege, London, 2009.
[DDM04]
I. Daubechies, M. Defrise, and C. De Mol. An iterative thresholding algorithm
for linear inverse problems with a sparsity constraint. Comm. Pure Appl. Math,
57:1413–1457, 2004.
[Dee81]
T.J. Deeming. Deconvolution and reﬂection coefﬁcient estimation using a gen-
eralized minimum entropy principle. Proc. 51st Ann. Meeting of the Soc. of
Exploration Geophysicists, page 1, 1981.
[Don81]
D.L. Donoho. On minimum entropy deconvolution. Applied Time Series Anal-
ysis II, page 1, 1981.
[DR85]
G. Demoment and R. Reynaud. Fast minimum-variance deconvolution. IEEE
Transactions on Acoustics Speech and Signal Processing, ASSP-33:1324–
1326, 1985.
[DSA10]
C. Dibner, U. Schibler, and U. Albrecht. The mammalian circadian timing
system: organisation and coordination of central and peripheral clocks. Annu.
Rev. Physiol., 72:517–549, 2010.
[EIM90]
Kane. S. E., Pastan. I., and Gottesman. M. M.
Genetic basis of multidrug
resistance of tumor cells. J Bionenerg Biomembr, 22:593–618, 1990.
[F.01]
Levi F. Circadian chronotherapy for human cancers. Lancet Oncol, 2:307–315,
2001.
[FDMD05]
Olivier Féron, Bernard Duchêne, and Ali Mohammad-Djafari.
Microwave
imaging of inhomogeneous objects made of a ﬁnite number of dielectric and
conductive materials from experimental data. Inverse Problems, 21(6):95–115,
Dec 2005.
[FDMD07]
Olivier Féron, Bernard Duchêne, and Ali Mohammad-Djafari.
Microwave
imaging of piecewise constant objects in a 2D-TE conﬁguration.
Interna-
tional Journal of Applied Electromagnetics and Mechanics, 26(6):167–174,
IOS Press 2007.
198

BIBLIOGRAPHY
[Fer99]
C Fernandez. Multivariate Student-t regression models: Pitfalls and inference.
Biometrika, 86(1):153–167, 1999.
[Fio04]
Simone Fiori. Fast ﬁxed-point neural blind-deconvolution algorithm. IEEE
Trans Neural Netw, 15(2):455–459, Mar 2004.
[Fis25]
R.A. Fisher. Applications of students, distribution. Metron, 5:90–104, 1925.
[FIW+05]
E. Filipski, P. F. Innominato, M. Wu, X. M. Li, and S. Iacobelli. Effects of
light and food schedules on liver and tumor molecular clocks in mice. J. Natl.
Cancer Inst., 97:507–517, 2005.
[FKL+02]
E. Filipski, V. M. King, X. Li, T. G. Granda, and M. C. Mormont. Host cir-
cadian clock as a control point in tumor progression. J. Natl. Cancer Inst,
94:690–697, 2002.
[FL03]
L. Fu and C. C. Lee. The circadian clock: pacemaker and tumor suppressor.
Nat. Rev. Cancer, 3:350–361, 2003.
[GCSR03]
Andrew Gelman, John B. Carlin, Hal S. Stern, and Donald B. Rubin. Bayesian
Data Analysis, Second Edition (Chapman & Hall/CRC Texts in Statistical Sci-
ence). Chapman and Hall/CRC, 2 edition, July 2003.
[GDI90]
Y. Goussard, G. Demoment, and J. Idier. A new algorithm for iterative decon-
volution of sparse spike trains. Proc. Int. Conf. ASSP, page 3, 1990.
[GG84]
S. Geman and D. Geman.
Stochastic relaxation, gibbs distributions, and
the bayesian restoration of images.
IEEE Trans Pattern Anal Mach Intell,
6(6):721–741, Jun 1984.
[GHBMD13] L. Gharsalli, A. Hacheme, D. Bernard, and A. Mohammad-Djafari.
Mi-
crowave tomography for breast cancer detection within a variational bayesian
approach. In IEEE European Signal Processing Conference, EUSIPCO, vol-
ume nc, page nc, Marrakech, Morocco, 2013.
[GILC08]
D. Ge, J. Idier, and E. Le Carpentier.
A new mcmc algorithm for blind
bernoulli- gaussian deconvolution. In Proceedings of EUSIPCO: Septembre
2008; Lausanne, Suisse, 2008.
[GLRI93]
G. Gindi, M. Lee, A. Rangarajan, and Zubal I. Bayesian reconstruction of func-
tional images using anatomical information as priors. ieeeMI, MI-12(4):670–
680, 1993.
[Gos08]
W. S. Gosset. The probable error of a mean. Biometrika, 6, 1908.
[GP93]
M. M. Gottesman and I. Pastan. Biochemistry of multidrug resistance mediated
by the multidrug transporter. Annu Rev Biochem, 62:385–427, 1993.
[GRS96]
W.R. Gilks, S. Richardson, and D.J. Spiegelhalter. Monte Carlo Markov Chains
in practice. Chapman and Hall, 1996.
[Had01]
J. Hadamard. Sur les problëmes aux dérivées partielles et leur signiﬁcation
physique. Princeton Univ. Bull., 13, 1901.
199

BIBLIOGRAPHY
[Haz01]
M. Hazewinkel. Student distribution, Encyclopedia of Mathematics. Springer,
2001.
[Hel75]
F. R. Helmert. Über die bestimmung des wahrscheinlichen fehlers aus einer
endlichen anzahl wahrer beobachtungsfehler. Z. Math., 20:300–303, 1875.
[Hel76a]
F. R. Helmert.
Die genauigkeit der formel von peters zur berechnung
des wahrscheinlichen beobachtungsfehlers directer beobachtungen gleicher
genauigkeit. Astron. Nachr., 88:113–132, 1876.
[Hel76b]
F. R. Helmert. Über die wahrscheinlichkeit der potenzsummen der beobach-
tungsfehler und uber einige damit in zusammenhang stehende fragen. Z. Math.
Phys., 21:192–218, 1876.
[HMC02]
R. V. Hogg, J. McKean, and A. T. Craig. Introduction to Mathematical Statis-
tics (7th Edition). Pearson, 2002.
[Hol92]
T. J. Holmes. Blind deconvolution of quantum-limited incoherent imagery:
maximum-likelihood approach. J Opt Soc Am A, 9(7):1052–1061, Jul 1992.
[HRM08]
M. E. Hastings, A. B. Reddy, and E. S. Maywood. A clockwork web: circa-
dian timing in brain and periphery, in health and disease. Nat. Rev. Neurosci,
4(8):649–661, 2008. cited By 555.
[HW83]
Kenneth M. Hanson and G. W. Wechsung. Bayesian approach to limited-angle
reconstruction in computed tomography. 73:1501–1509, November 1983.
[IFG+09]
P. F. Innominato, C. Focan, T. Gorlia, T. Moreau, and C. Garuﬁ. Circadian
rhythm in rest and activity: a biological correlate of quality of life and a predic-
tor of survival in patients with metastatic colorectal cancer. Cancer Research,
69:4700–4707, 2009.
[IG90]
J. Idier and Y. Goussard. Markov modeling for bayesian multi-channel decon-
volution. Proceedings of IEEE ICASSP, page 2, 1990.
[IGB+12]
P. F. Innominato, S. Giacchetti, G. A. Bjarnason, C. Focan, C. Garuﬁ, and
B. Coudert. Prediction of overall survival through circadian rest-activity mon-
itoring during chemotherapy for metastatic colorectal cancer. Int J Cancer,
131:2684–2692, 2012.
[IGM+11]
P. F. Innominato, S. Giacchetti, T. Moreau, R. Smaaland, C. Focan, and G. A.
Bjarnason. Prediction of survival by neutropenia according to delivery sched-
ule of oxaliplatin-5-ﬂuorouracil-leucovorin for metastatic colorectal cancer in
a randomized international trial. Chronobiol Int., 28:586–600, 2011.
[JSM+02]
Stuart Jefferies, Kathy Schulze, Charles Matson, Kurt Stoltenberg, and E. Keith
Hege.
Blind deconvolution in optical diffusion tomography.
Opt Express,
10(1):46–53, Jan 2002.
[KBJ00]
S. Kotz, N. Balakrishnan, and N.L. Johnson. Continuous multivariate distribu-
tions, models and applications, volume 334. Wiley-Interscience, 2000.
200

BIBLIOGRAPHY
[KMS+12a]
F. Krzakala, M. Mézard, F. Sausset, Y. Sun, and L. Zdeborová. Probabilistic re-
construction in compressed sensing: algorithms, phase diagrams, and threshold
achieving matrices. Journal of Statistical Mechanics: Theory and Experiment,
2012(08):P08009, 2012.
[KMS+12b]
F. Krzakala, M. Mézard, F. Sausset, Y. F. Sun, and L. Zdeborová. Statistical-
physics-based reconstruction in compressed sensing. Phys. Rev. X, 2:021005,
May 2012.
[KTB04]
EE Kuruoglu, A. Tonazzini, and L. Bianchi. Source separation in noisy as-
trophysical images modelled by markov random ﬁelds.
In Image Process-
ing, 2004. ICIP’04. 2004 International Conference on, volume 4, pages 2701–
2704. IEEE, 2004.
[L¨76]
J. Lüroth. Vergleichung von zwei werten des wahrscheinlichen fehlers. Astron.
Nachr., 87:209–220, 1876.
[LB13]
Thibault Lelore and Frédéric Bouchara. Fair: a fast algorithm for document
image restoration. IEEE Trans Pattern Anal Mach Intell, 35(8):2039–2048,
Aug 2013.
[Li57]
J.C.R. Li.
Student’s t-distribution. In Introduction to statistical inference.,
pages 87–104. Edwards Brothers, 1957.
[LMB+09]
Gu. L., Tsark. W. M., D. A. Brown, S. Blanchard, T. W. Synold, and S. E.
Kane. A new model for studying tissue-speciﬁc mdr1a gene expression in vivo
by live imaging. Proc Natl Acad Sci USA, 106:5394–5399, 2009.
[LMDD+13] X.-M. Li, A. Mohammad-Djafari, M. Dumitru, S. Dulong, E. Filipski,
S. Siffroi-Fernandez, A. Mteyrek, F. Scaglione, C. Guettier, F. Delaunay, and
F. Levi. A circadian clock transcription model for the personalization of cancer
chronotherapy. Cancer Research, 73(24):7176–7188, 2013. cited By 5.
[LN11]
Haiyong Liao and Michael K Ng. Blind deconvolution using generalized cross-
validation approach to regularization parameter estimation. IEEE Trans Image
Process, 20(3):670–680, Mar 2011.
[LOD+10]
F. Levi, A. Okyar, S. Dulong, P. F. Innominato, and J. Clairambault. Circadian
timing in cancer treatment. Annu Rev Pharmacol Toxicol, 50:377–421, 2010.
[LS07]
F. Levi and U. Schibler. Circadian rhythms: mechanisms and therapeutic im-
plications. Annu. Rev. Pharmacol. Toxicol., 47:593–628, 2007.
[MD12]
A Mohammad-Djafari. Bayesian approach with prior models which enforce
sparsity in signal and image processing. EURASIP Journal on Advances in
Signal Processing, Special issue on Sparse Signal Processing:2012:52, 2012.
[MDD88]
Ali Mohammad-Djafari and G. Demoment.
Image restoration and recon-
struction using entropy as a regularization functional. Maximum Entropy and
Bayesian Methods in Science and Engineering, 2:341–355, 1988.
[MGT12]
J. A. Mohawk, C. B. Green, and J. S. Takahashi. Central and peripheral circa-
dian clocks in mammals. Annu. Rev. Neurosci., 35:445–462, 2012.
201

BIBLIOGRAPHY
[ML03]
M. C. Mormont and F. Levi. Cancer chronotherapy: principles, applications,
and perspectives. Cancer, 97:155–169, 2003.
[Mor08]
R. G. Mortimer.
Mathematics for Physical Chemistry.
Academic Press. 3
edition., 1908.
[MPRR11]
J.M. Marin, P. Pudlo, C.P. Robert, and R. Ryder. Approximate bayesian com-
putational methods. arxiv:1101.0955, 2011.
[MS04]
R. E. Mistlberger and D. J. Skene. Social inﬂuences on mammalian circadian
rhythms: animal and human studies. Biol. Rev., 79:533–556, 2004.
[MSC99]
N.D.A. Mascarenhas, C.A.N. Santos, and P.E. Cruvinel. Transmission tomog-
raphy under poisson noise using the anscombe transformation and wiener ﬁlter-
ing of the projections. Nuclear Instruments and Methods in Physics Research
Section A: Accelerators, Spectrometers, Detectors and Associated Equipment,
423(2):265–271, 1999.
[MSSM11]
Andrés G Marrugo, Michal Sorel, Filip Sroubek, and María S Millán. Reti-
nal image restoration by means of blind deconvolution.
J Biomed Opt,
16(11):116016, Nov 2011.
[MWB+00]
M. C. Mormont, J. Waterhouse, P. Bleuzen, S. Giacchetti, and A. Jami. Marked
24-h rest/activity rhythms are associated with better quality of life, better re-
sponse, and longer survival in patients with metastatic colorectal cancer and
good performance status. Clin. Cancer Res, 6:3038–3045, 2000.
[NMD94]
M.K. Nguyen and A. Mohammad-Djafari. Bayesian approach with the maxi-
mum entropy priors in image reconstruction from the microwave scattered ﬁeld
data. ieeeMI, 1994.
[NMD96]
M. Nikolova and Ali Mohammad-Djafari. Eddy current tomography using a
binary Markov model. Signal Processing, 49:119–132, 1996.
[NPQ00]
M. K. Ng, R. J. Plemmons, and S. Qiao. Regularization of rif blind image
deconvolution. IEEE Trans Image Process, 9(6):1130–1134, 2000.
[OPA+11]
A. Okyar, E. Piccolo, C. Ahowesso, E. Filipski, V. Hossard, C. Guettier,
R. La Sorda, N. Tinari, S. Iacobelli, and F. Levi. Strain- and sex-dependent
circadian changes in abcc2 transporter expression: implications for irinotecan
chronotolerance in mouse ileum. PLoS One, 6, 2011.
[OTMB+13] E. Ortiz-Tudela, A. Mteyrek, A. Ballesta, P. F. Innominato, and F. Levi. Cancer
chronotherapeutics: experimental, theoretical, and clinical aspects. Handb Exp
Pharmacol., 217:261–288, 2013.
[PB13]
Hanjie Pan and Thierry Blu. An iterative linear expansion of thresholds for
l1-based image restoration. IEEE Trans Image Process, 22(9):3715–3728, Sep
2013.
[PCS11]
J.T. Parker, V. Cevher, and P. Schniter.
Compressive sensing under matrix
uncertainties: An approximate message passing approach.
In Signals, Sys-
tems and Computers (ASILOMAR), 2011 Conference Record of the Forty Fifth
Asilomar Conference on, pages 804 –808, nov. 2011.
202

BIBLIOGRAPHY
[PL99]
S. U. Pillai and B. Liang. Blind image deconvolution using a robust gcd ap-
proach. IEEE Trans Image Process, 8(2):295–301, 1999.
[PS10]
N. Polson and J. Scott. Shrink globally, act locally: sparse Bayesian regular-
ization and prediction. Bayesian Statistics 9, 2010.
[RMC09]
H. Rue, S. Martino, and N. Chopin. Approximate bayesian inference for latent
gaussian models using integrated nested laplace approximations (with discus-
sion). Journal of the Royal Statistical Society, Series B, 71(2):319–392, 2009.
[RMW12]
Mohammad Rostami, Oleg Michailovich, and Zhou Wang. Image deblurring
using derivative compressed sensing for optical imaging application. IEEE
Trans Image Process, 21(7):3139–3149, Jul 2012.
[SLC+13]
C. Saini, A. Liani, T. Curie, P. Gos, F. Kreppel, Y. Emmenegger, L. Bonacina,
J. P. Wolf, Y. A. Poget, P. Franken, and U. Schibler. Real-time recording of
circadian liver gene expression in freely moving mice reveals the phase-setting
behavior of hepatocyte clocks. Genes Dev., 27:1526–1536, 2013.
[SR94]
S. Senn and W. Richardson. The ﬁrst t-test. Statistics in Medicine, 13:785–803,
1994.
[SR12]
Philip Schniter and Sundeep Rangan. Compressive Phase Retrieval via Gener-
alized Approximate Message Passing. In Proceedings of Allerton Conference
on Communication, Control, and Computing, 2012.
[SSKS00]
S. E. Sephton, R. M. Sapolsky, H. C. Kraemer, and D. Spiegel. Diurnal cortisol
rhythm as a predictor of breast cancer survival. J. Natl. Cancer Inst., 92:994–
1000, 2000.
[SSL+11]
C. Saini, D. M. Suter, A. Liani, P. Gos, and U. Schibler. The mammalian
circadian timing system: synchronization of peripheral clocks. Cold Spring
Harbor Symposia on Quantitaive Biology, 76:39–47, 2011.
[TGS06]
J. A. Tropp, A. C. Gilbert, and M. J. Strauss. Algorithms for simultaneous
sparse approximation. part i: Greedy pursuit. Signal Processing, special issue
"sparse approximations in signal and image processing", 86:572–588, April
2006.
[TH94]
Y. Touitou and E. Haus. Biologic rhythms in clinical and laboratory medicine.
Springer-Verlag, 1994.
[Tip01]
M. Tipping. Sparse Bayesian learning and the relevance vector machine. Jour-
nal of Machine Learning Research, 1:211–244, 2001.
[Tro06]
J. A. Tropp. Algorithms for simultaneous sparse approximation. part ii: Convex
relaxation. Signal Processing, special issue "Sparse approximations in signal
and image processing", 86:589–602, April 2006.
[VR02]
W. N. Venables and B. D. Ripley. Modern Applied Statistics with S. Springer,
2002.
203

BIBLIOGRAPHY
[Wah82]
G. Wahba. Constrained regularization for ill-posed linear operator equations
with applications in meteorology and medicine. in Statistical Decision Theory
and Related Topics III New-York: Academic, pages 383–417, 1982.
[WBJ05]
John Winn, Christopher M. Bishop, and Tommi Jaakkola. Variational message
passing. Journal of Machine Learning Research, 6:661–694, 2005.
[WHmPw08] Liang Wei, Lei Hua-ming, and Que Pei-wen. Sparsity enhancement for blind
deconvolution of ultrasonic signals in nondestructive testing application. Rev
Sci Instrum, 79(1):014901, Jan 2008.
[Wig77]
R.A. Wiggins. Minimum entropy deconvolution. IEEE Proceedings Intern.
Symp. Computer-Aided Seismic Analysis and Discrimination, 1977.
[WMMY02] R. Walpole, R. Myers, S. Myers, and K. Ye. Probability and Statistics for
Engineers and Scientists. Pearson Education, 7th edition, 2002.
[YBW85]
R. Yarlagadda, J.B. Bednar, and T.L. Watt. Fast algorithms for lp deconvolu-
tion. IEEE Transactions on Acoustics Speech and Signal Processing, ASSP-33,
1985.
[YFZ12]
Luxin Yan, Houzhang Fang, and Sheng Zhong. Blind image deconvolution
with spatially adaptive total variation regularization. Opt Lett, 37(14):2778–
2780, Jul 2012.
[YLZF12]
Luxin Yan, Hai Liu, Sheng Zhong, and Houzhang Fang. Semi-blind spec-
tral deconvolution with adaptive tikhonov regularization.
Appl Spectrosc,
66(11):1334–1346, Nov 2012.
[Zel76]
Arnold Zellner.
Bayesian and Non-Bayesian Analysis of the Regression
Model with Multivariate Student-t Error Terms. J. of American Stat. Assoc.,
71(354):400–405, 1976.
[ZL11]
Wangmeng Zuo and Zhouchen Lin. A generalized accelerated proximal gra-
dient approach for total-variation-based image restoration. IEEE Trans Image
Process, 20(10):2748–2759, Oct 2011.
204

List of Figures
1.1
Exemple de signaux chronobiologiques obtenus dans des expériences de traitement du cancer: le
1.2
Les données brutes pour un signal representent des modelés de repos-activité en chronobiologie:
1.3
Les données brutes pour un signal representent l’expression des génes en chronobiologie: avant le
1.4
Densité de la loi Normale et densité de la loi de Student.
. . . . . . . . . . .
15
1.5
La distribution bivarié Normale - Inverse Gamma modélisant

f kj, vfj

et la distribution margina
1.6
Les equations de mise à jour des paramètres pour l’estimation MAP. . . . . .
18
1.7
Les equations de mise à jour des paramètres pour l’estimation EAP via ABV, séparabilité partielle
1.8
Les equations de mise à jour des paramètres pour l’estimation EAP via ABV, séparabilité totale.
2.1
Example of chronobiological signals obtained in cancer treatment experiments: the rest-activity s
2.2
Raw data for a rest-activity pattern signal in chronobiology: before treatment (left, 3 days length)
2.3
Raw data for a gene expression signal in chronobiology: before treatment (left, 3 days length), du
3.1
Synthetic data: sparse theoretical PC amplitudes vector f with 3 non-zero peaks corresponding to
3.2
Estimated PC amplitudes vectors c
f 0 (3.2c) and bf (3.2d) for the original signal g (3.2a) and the no
3.3
Estimated PC amplitudes vectors c
f 0 (3.3a) and bf (3.3b). Periods are not scaled in the plot. 31
3.4
Real data: A 4 days length signal recorded in cancer treatment experiments (3.4a), the PC amplitu
3.5
Estimated PC amplitudes vectors c
f 0 (3.5c) and bf (3.5d) for the zero padded original signal g (3.5
3.6
Estimated PC amplitudes vectors c
f 0 (3.6a) and bf (3.6b), corresponding to zero padded signals. P
3.7
Estimated PC amplitudes vectors c
f 0 (3.7c) and bf (3.7d) for the zero padded original signal g (3.7
3.8
Zero padded signal (a) and the corresponding FFT PC amplitudes vector. . . .
34
3.9
Direct Inversion: Signal without noise . . . . . . . . . . . . . . . . . . . . .
35
3.10 Direct Inversion: Signal with noise, 50dB . . . . . . . . . . . . . . . . . . .
36
3.11 Direct Inversion: Signal with noise, 20dB . . . . . . . . . . . . . . . . . . .
36
3.12 Direct Inversion: Signal with noise, 05dB . . . . . . . . . . . . . . . . . . .
37
3.13 Direct Inversion L1 and L2 errors: PC estimation errors and signal reconstruction errors 38
205

LIST OF FIGURES
3.14 Least Squares: Signal without noise
. . . . . . . . . . . . . . . . . . . . . .
38
3.15 Least Squares: Signal with noise, 15dB
. . . . . . . . . . . . . . . . . . . .
39
3.16 Least Squares: Signal with noise, 10dB
. . . . . . . . . . . . . . . . . . . .
40
3.17 Least Squares: Signal with noise, 05dB
. . . . . . . . . . . . . . . . . . . .
41
3.18 Least Squares L1 and L2 errors: PC estimation errors and signal reconstruction errors 41
3.19 Regularized Least Squares, λ = 0.1: Signal without noise . . . . . . . . . . .
42
3.20 Regularized Least Squares, λ = 0.1: Signal with noise, 5dB
. . . . . . . . .
42
3.21 Regularized Least Square L1 and L2 errors: PC estimation and signal reconstruction 43
3.22 Regularized Least Square δg1 and δg2 signal reconstruction errors for different values of λ 44
3.23 Regularized Least Square δf 1 and δf 2 PC estimation errors for different values of λ 44
3.24 LASSO: Signal without noise . . . . . . . . . . . . . . . . . . . . . . . . . .
45
3.25 LASSO: Signal with noise, 10dB . . . . . . . . . . . . . . . . . . . . . . . .
46
3.26 LASSO: Signal with noise, 5dB - Accurate estimation . . . . . . . . . . . . .
46
3.27 LASSO: Signal with noise, 5dB - Inaccurate estimation . . . . . . . . . . . .
47
3.28 LASSO L1 and L2 errors stability: PC estimation and signal reconstruction - 10dB 48
3.29 LASSO L1 and L2 errors stability: PC estimation and signal reconstruction - 5dB 48
3.30 LASSO L1 and L2 errors stability: PC estimation and signal reconstruction - 5dB 49
3.31 LASSO L1 and L2 errors: PC estimation and signal reconstruction . . . . . .
49
4.1
Normal and Student-t distribution
. . . . . . . . . . . . . . . . . . . . . . .
60
4.2
Normal vs. Student-t distribution . . . . . . . . . . . . . . . . . . . . . . . .
60
4.3
Normal - Inverse Gamma distribution

f kj, vf j

and the corresponding marginal f kj|αf0, βf0 61
4.4
Normal vs. Normal - Inverse Gamma marginal distributions
. . . . . . . . .
63
4.5
Updating scheme: JMAP estimation for generalized Student-t prior model . .
65
4.6
Updating scheme: PM estimation via VBA (partial separability) for generalized Student-t prior model
4.7
Inverse Gamma distributions for different α, β parameters
. . . . . . . . . .
72
4.8
Sparsity mechanism: the sparsity is imposed (also) via the corresponding variance 72
4.9
x ∼IG(x|α, β); E [x] = 0.1; Var [x] = 1, 0.1, 0.01 and 0.001 . . . . . . . . .
73
4.10 x ∼IG(x|α, β); E [x] = 0.01; Var [x] = 1, 0.1, 0.01 and 0.001
. . . . . . . .
73
4.11 x ∼IG(x|α, β); E [x] = 0.001; Var [x] = 1, 0.1, 0.01 and 0.001 . . . . . . . .
74
4.12 Different Generalized Student-t distributions for which the means EStg = 0 and the variances VarStg =
4.13 Generalized Student-t: VarStg = 0.1; VarIG = 0.1, 0.01, 0.001; . . . . . . . .
75
4.14 Different Generalized Student-t distributions for which the means EStg = 0 and the variances VarStg =
206

LIST OF FIGURES
4.15 Generalized Student-t: VarStg = 0.01; VarIG = 0.1, 0.01, 0.001;
. . . . . . .
75
4.16 Different Generalized Student-t distributions for which the means EStg = 0 and the variances Var
4.17 Generalized Student-t: VarStg = 0.001; VarIG = 0.1, 0.01, 0.001;
. . . . . .
76
4.18 Updating scheme: PM estimation via VBA (full separability) for generalized Student-t prior mod
5.1
f PC vector, theoretical signal g0 and input signal g = g0 + ǫ of the model (5dB) 81
5.2
JMAP IGSM Estimation (5dB) . . . . . . . . . . . . . . . . . . . . . . . . .
82
5.3
JMAP IGSM L2 error measured for 10 different noise realisations (5dB) . . .
83
5.4
PM (via VBA, partial separability) IGSM Estimation (5dB) . . . . . . . . . .
84
5.5
PM (via VBA, partial separability) IGSM hyperparameters and f convergency
85
5.6
PM (via VBA, partial separability) IGSM L2 error measured for 10 different noise realisations (5d
5.7
PM (via VBA, full separability) IGSM Estimation (5dB)
. . . . . . . . . . .
87
5.8
PM (via VBA, full separability) IGSM L2 error measured for 10 different noise realisations (5dB)
5.9
Methods Comparison (5dB)
. . . . . . . . . . . . . . . . . . . . . . . . . .
89
5.10 L2 Errors estimation (5dB) . . . . . . . . . . . . . . . . . . . . . . . . . . .
90
5.11 f PC vector, theoretical signal g0 and input signal g = g0 + ǫ of the model (10dB) 91
5.12 JMAP IGSM Estimation (10dB) . . . . . . . . . . . . . . . . . . . . . . . .
92
5.13 JMAP IGSM L2 error measured for 10 different noise realisations (10dB) . .
93
5.14 PM (via VBA, partial separability) IGSM Estimation (10dB) . . . . . . . . .
94
5.15 PM (via VBA, partial separability) IGSM hyperparameters and f convergency
94
5.16 PM (via VBA, partial separability) IGSM L2 error measured for 10 different noise realisations (10
5.17 PM (via VBA, full separability) IGSM Estimation (10dB) . . . . . . . . . . .
96
5.18 PM (via VBA, full separability) IGSM L2 error measured for 10 different noise realisations (10dB
5.19 Methods Comparison (10dB) . . . . . . . . . . . . . . . . . . . . . . . . . .
98
5.20 L2 Errors estimation (10dB)
. . . . . . . . . . . . . . . . . . . . . . . . . .
99
5.21 f PC vector, theoretical signal g0 and input signal g = g0 + ǫ of the model (15dB)100
5.22 JMAP IGSM Estimation (15dB) . . . . . . . . . . . . . . . . . . . . . . . . 101
5.23 JMAP IGSM L2 error measured for 10 different noise realisations (15dB) . . 102
5.24 PM (via VBA, partial separability) IGSM Estimation (15dB) . . . . . . . . . 103
5.25 PM (via VBA, partial separability) IGSM hyperparameters and f convergency 103
5.26 PM (via VBA, partial separability) IGSM L2 error measured for 10 different noise realisations (15
5.27 PM (via VBA, full separability) IGSM Estimation (15dB) . . . . . . . . . . . 105
5.28 PM (via VBA, full separability) IGSM L2 error measured for 10 different noise realisations (15dB
207

LIST OF FIGURES
5.29 Methods Comparison (15dB) . . . . . . . . . . . . . . . . . . . . . . . . . . 107
5.30 L2 Errors estimation (15dB)
. . . . . . . . . . . . . . . . . . . . . . . . . . 108
5.31 Synthetic simulation data (05dB): sine PC amplitudes vector f 1, (5.31a), cosine PC amplitudes vector
5.32 Synthetic simulation (05dB): comparison between the Proposed Method estimations and the synthetic
5.33 Synthetic simulation (05dB): comparison between the LASSO estimations and the synthetic data111
5.34 Stability: L1 and L2 reconstruction errors (05dB): δg1 and δg2: Proposed Method vs. LASSO112
5.35 Stability: L1 and L2 estimation errors (05dB): δf 1 and δf 2: Proposed Method vs. LASSO113
5.36 Synthetic simulation data (10dB): sine PC amplitudes vector f 1, (5.36a), cosine PC amplitudes vector
5.37 Synthetic simulation (10dB): comparison between the Proposed Method estimations and the synthetic
5.38 Synthetic simulation (10dB): comparison between the LASSO estimations and the synthetic data116
5.39 Stability: L1 and L2 reconstruction errors (10dB): δg1 and δg2: Proposed Method vs. LASSO117
5.40 Stability: L1 and L2 estimation errors (10dB): δf 1 and δf 2: Proposed Method vs. LASSO118
5.41 L1 and L2 estimation errors: δg1 and δg2: Proposed Method vs. LASSO . . . 119
5.42 L1 and L2 estimation errors: δf 1 and δf 2: Proposed Method vs. LASSO
. . 120
6.1
CT 502, A1 Mouse: Activity (a) and Photon Absorption (b) raw data
. . . . 122
6.2
Activity raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-hour sampled123
6.3
Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 123
6.4
PC Stability: PC estimation via FFT and VBA for 4-days length signals . . . 124
6.5
PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 124
6.6
PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 125
6.7
DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 125
6.8
DD during signal (a) and the corresponding PC via VBA (b) and FFT (c) . . 125
6.9
PC Stability: PC estimation via FFT and VBA for 4-days length signals, Activity DD, during126
6.10 PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 126
6.11 PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 126
6.12 DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . . 127
6.13 Photon raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-hour sampled128
6.14 Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 128
6.15 PC Stability: PC estimation via FFT and VBA for 4-days length signals . . . 128
6.16 PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 129
6.17 PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 129
6.18 DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 129
208

LIST OF FIGURES
6.19 DD during signal (a) and the corresponding PC via VBA (b) and FFT (c) . . 130
6.20 PC Stability: PC estimation via FFT and VBA for 4-days length signals, Photon DD, during130
6.21 PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 130
6.22 PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 130
6.23 DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . . 130
6.24 CT 502, A2 Mouse: Activity (a) and Photon Absorption (b) raw data
. . . . 132
6.25 Activity raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-hour sampled133
6.26 Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 133
6.27 PC Stability: PC estimation via FFT and VBA for 4-days length signals . . . 134
6.28 PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 134
6.29 PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 134
6.30 DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 134
6.31 DD during signal (a) and the corresponding PC via VBA (b) and FFT (c) . . 135
6.32 PC Stability: PC estimation via FFT and VBA for 4-days length signals, Activity DD, during135
6.33 PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 135
6.34 PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 136
6.35 DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . . 136
6.36 Photon raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-hour sampled137
6.37 Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 137
6.38 PC Stability: PC estimation via FFT and VBA for 4-days length signals . . . 138
6.39 PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 138
6.40 PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 138
6.41 DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 139
6.42 DD during signal (a) and the corresponding PC via VBA (b) and FFT (c) . . 139
6.43 PC Stability: PC estimation via FFT and VBA for 4-days length signals, Photon DD, during139
6.44 PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 140
6.45 PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 140
6.46 DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . . 140
6.47 CT 502, A3 Mouse: Activity (a) and Photon Absorption (b) raw data
. . . . 142
6.48 Activity raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-hour sampled143
6.49 Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 143
6.50 PC Stability: PC estimation via FFT and VBA for 4-days length signals . . . 144
209

LIST OF FIGURES
6.51 PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 144
6.52 PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 144
6.53 DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 144
6.54 DD during signal (a) and the corresponding PC via VBA (b) and FFT (c) . . 145
6.55 PC Stability: PC estimation via FFT and VBA for 4-days length signals, Activity DD, during145
6.56 PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 145
6.57 PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 146
6.58 DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . . 146
6.59 Photon raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-hour sampled146
6.60 Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 147
6.61 PC Stability: PC estimation via FFT and VBA for 4-days length signals . . . 148
6.62 PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 148
6.63 PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 148
6.64 DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 148
6.65 DD during signal (a) and the corresponding PC via VBA (b) and FFT (c) . . 149
6.66 PC Stability: PC estimation via FFT and VBA for 4-days length signals, Photon DD, during149
6.67 PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 149
6.68 PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 150
6.69 DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . . 150
6.70 CT 502, B1 Mouse: Activity (a) and Photon Absorption (b) raw data . . . . . 151
6.71 Activity raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-hour sampled152
6.72 Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 152
6.73 PC Stability: PC estimation via FFT and VBA for 4-days length signals . . . 153
6.74 PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 153
6.75 PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 154
6.76 DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 154
6.77 DD during signal (a) and the corresponding PC via VBA (b) and FFT (c) . . 154
6.78 PC Stability: PC estimation via FFT and VBA for 4-days length signals, Activity DD, during155
6.79 PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 155
6.80 PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 155
6.81 DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . . 156
6.82 Photon raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-hour sampled157
210

LIST OF FIGURES
6.83 Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 157
6.84 PC Stability: PC estimation via FFT and VBA for 4-days length signals . . . 157
6.85 PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 158
6.86 PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 158
6.87 DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 158
6.88 DD during signal (a) and the corresponding PC via VBA (b) and FFT (c) . . 159
6.89 PC Stability: PC estimation via FFT and VBA for 4-days length signals, Photon DD, during159
6.90 PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 159
6.91 PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 160
6.92 DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . . 160
6.93 CT 502, B2 Mouse: Activity (a) and Photon Absorption (b) raw data . . . . . 162
6.94 Activity raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-hour sampled162
6.95 Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 163
6.96 PC Stability: PC estimation via FFT and VBA for 4-days length signals . . . 163
6.97 PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 164
6.98 PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 164
6.99 DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 164
6.100Photon raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-hour sampled165
6.101Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 166
6.102PC Stability: PC estimation via FFT and VBA for 4-days length signals . . . 166
6.103PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 167
6.104PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 167
6.105DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 167
6.106CT 502, B3 Mouse: Activity (a) and Photon Absorption (b) raw data . . . . . 168
6.107Activity raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-hour sampled169
6.108Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 169
6.109PC Stability: PC estimation via FFT and VBA for 4-days length signals . . . 170
6.110PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 170
6.111PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 170
6.112DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 171
6.113DD during signal (a) and the corresponding PC via VBA (b) and FFT (c) . . 171
6.114PC Stability: PC estimation via FFT and VBA for 4-days length signals, Activity DD, during171
211

LIST OF FIGURES
6.115PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 172
6.116PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 172
6.117DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . . 172
6.118Photon raw data (a) and the corresponding parts,(b),(c),(d),normalized and one-hour sampled173
6.119Considered signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 174
6.120PC Stability: PC estimation via FFT and VBA for 4-days length signals . . . 174
6.121PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 175
6.122PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 175
6.123DD before signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . 175
6.124DD during signal (a) and the corresponding PC via VBA (b) and FFT (c) . . 176
6.125PC Stability: PC estimation via FFT and VBA for 4-days length signals, Photon DD, during176
6.126PC Stability: Proposed Method (a) vs. FFT (b)
. . . . . . . . . . . . . . . . 176
6.127PC Stability: Proposed Method (a) vs. FFT (b), normalized results . . . . . . 177
6.128DD after signal (a) and the corresponding PC via VBA (b) and FFT (c)
. . . 177
A.1
Normal-Inverse Gamma distribution (a) and the corresponding marginal Stg (b). Illustrated for ǫ = 0.
A.2
Sparse signal, distributed following the generalized Student-t distribution after thresholding193
A.3
Behaviour of the Sparsity Rate as a function of ǫ for different values of k Eq. (A.30a)194
212

List of Tables
4.1
Mean and variance for Stg via ǫ and w . . . . . . . . . . . . . . . . . . . . .
74
6.1
CT 502 A1: Activity Dominant Period Stability: Proposed Method vs. FFT . 127
6.2
CT 502 A1: Photon Absorption Dominant Period Stability: Proposed Method vs. FFT131
6.3
CT 502 A2: Activity Dominant Period Stability: Proposed Method vs. FFT . 136
6.4
CT 502 A2: Photon Absorption Dominant Period Stability: Proposed Method vs. FFT141
6.5
CT 502 A3: Activity Dominant Period Stability: Proposed Method vs. FFT . 147
6.6
CT 502 A3: Photon Dominant Period Stability: Proposed Method vs. FFT . . 151
6.7
CT 502 B1: Activity Dominant Period Stability: Proposed Method vs. FFT
. 156
6.8
CT 502 B1: Photon Absorption Dominant Period Stability: Proposed Method vs. FFT160
6.9
CT 502 B2: Activity Dominant Period Stability: Proposed Method vs. FFT
. 165
6.10 CT 502 B2: Photon Absorption Dominant Period Stability: Proposed Method vs. FFT168
6.11 CT 502 B3: Activity Dominant Period Stability: Proposed Method vs. FFT
. 173
6.12 CT 502 B3: Photon Dominant Period Stability: Proposed Method vs. FFT . . 178
213

Titre : Approche bayésienne de l’estimation des composantes périodiques des signaux en 
chronobiologie
Mots clés : Estimation de composantes périodiques, Problèmes inverses, Approches bayésiennes, 
Modèle hierarchique, Renforcement de parcimonie, Chronobiologie
Résumé : La toxicité et l’efficacité de plus de
30 agents anticancéreux présentent de très fortes
variations en fonction du temps de dosage. Par
conséquent,  les  biologistes  qui  étudient  le
rythme circadien ont besoin d’une méthode très
précise pour estimer le vecteur de composantes
périodiques (CP) de signaux chronobiologiques.
En outre, dans les développements récents, non
seulement la période dominante ou le vecteur de
CP présentent un intérêt crucial, mais aussi leurs
stabilités ou variabilités. Dans les expériences
effectuées en traitement du cancer, les signaux
enregistrés correspondant à différentes phases
de traitement sont courts, de sept jours pour le
segment  de  synchronisation  jusqu’à  deux  ou
trois  jours pour  le segment  après  traitement.
Lorsqué’on  étudie  la  stabilité  de  la  période
dominante nous devons considérer des signaux
très court par rapport à la connaissance a priori
de la période dominante, placée dans le 
domaine  circadien.  Les  approches  classiques
fonées sur la transformée de Fourier (TF) sont
inefficaces (i.e. manque de précision) compte
tenu  de  la  particularité  des  données  (i.e.  la
courte  longueur).  Dans  cette  thèse,  nous
proposons  une  nouvelle  méthode  pour
l’estimation  du  vecteur  de  CP  des  signaux
biomédicaux,  en  utilisant  les  informations
biologiques a priori et en considérant un modèle
qui représente le bruit. Les signaux enregistrés
dans le cadre d’expériences développées pour le
traitement du cancer ont un nombre limité de
périodes. Cette information a priori peut être
traduite comme la parcimonie du vecteur de CP.
La méthode proposée considère l’estimation de
vecteur de CP comme un problème inverse en
utilisant l’inférence bayésienne générale afin de
déduire toutes les inconnues de notre modèle, à
savoir  le  vecteur  de  CP  mais  aussi  les
hyperparamètres (i.e. les variances associées). 
Title : A Bayesian approach for periodic components estimation for chronobiological signals
Keywords : Periodic Components vector estimation, Inverse problem, Bayesian approach, 
Hierarchical model, Sparsity enforcing, Chronobiology
Abstract : The toxicity and efficacy of more
than 30 anticancer agents presents very high
variations,  depending  on  the  dosing  time.
Therefore the biologists studying the circadian
rhythm  require  a  very  precise  method  for
estimating  the  Periodic  Components  (PC)
vector of chronobiological signals. Moreover,
in recent developments not only the dominant
period  or  the  PC  vector  present  a  crucial
interest, but also their stability or variability. In
cancer  treatment  experiments  the  recorded
signals  corresponding  to  different  phases  of
treatment are short, from seven days for the
synchronization segment to two or three days
for the after treatment segment. When studying
the stability of the dominant period we have to
consider very short length signals relative to
the prior knowledge of the dominant period,  
placed in the circadian domain. The classical
approaches, based on Fourier Transform (FT)
methods are inefficient (i.e. lack of precision)
considering the particularities of the data (i.e.
the short length). In this thesis we propose a
new method for the estimation of the PC vector
of biomedical signals, using the biological prior
informations  and  considering  a  model  that
accounts  for  the  noise.  The  experiments
developed in the cancer treatment context are
recording signals expressing a lim ited number
of periods. This is a prior information that can
be translated as the sparsity of the PC vector.
The proposed method considers the PC vector
estimation as an Inverse Problem (IP) using the
general Bayesian inference in order to infer all
the unknowns of our model, i.e. the PC vector
but also the hyperparameters. 
Université Paris-Saclay
         
Espace Technologique / Immeuble Discovery 
Route de l’Orme aux Merisiers RD 128 / 91190 Saint-Aubin, France 

