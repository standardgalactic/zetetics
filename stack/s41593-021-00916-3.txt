Articles
https://doi.org/10.1038/s41593-021-00916-3
1Center for Mind and Brain, University of California, Davis, Davis CA, USA. 2Center for Neuroscience, University of California, Davis, Davis CA, USA. 
3Department of Psychology, University of California, Davis, Davis CA, USA. ✉e-mail: seongmin.a.park@gmail.com; edboorman@ucdavis.edu
H
umans and other animals have a remarkable capacity for 
inferring novel solutions in situations never encountered 
before. This extreme flexibility sets humans, in particular, 
apart from artificial intelligence, where inferring new solutions 
from sparse data and flexibly generalizing knowledge across tasks 
remains a considerable challenge1,2. As early as the 1940s, it was 
originally proposed that animals form and use some type of a ‘cog-
nitive map’ of the environment that allows them to flexibly infer 
novel routes and shortcuts through a spatial environment to reach a 
known reward’s location3.
In the context of spatial navigation, so-called ‘place cells’ in the 
hippocampus (HC) and ‘grid cells’ in the medial entorhinal cortex 
(EC) have been proposed to represent the animal’s current or pre-
dicted position within a spatiotemporal context4–7 and to provide 
an efficient context-invariant code for localization across similarly 
structured environments, respectively2,8,9. Together with related cell 
types (for example, border cells and band cells), these cells might, 
in part, provide a neuronal basis for a cognitive map of space. 
Critically, recent biologically inspired computational models have 
further proposed how these grid representations in EC might reflect 
basis functions for statistical transitions in two-dimensional (2D) 
topologies that can, in principle, enable animals and artificial agents 
to compose new routes and find shortcuts to reach goals in spatial 
environments2,9–11. These findings suggest a novel framework for 
understanding how humans might effectively ‘shortcut’ solutions in 
new situations.
Representing non-spatial relationships between entities or task 
states in the world as a cognitive map would likewise be very power-
ful because it could, theoretically, be leveraged to make inferences 
from sparse experiences that can dramatically accelerate learning 
and even guide decisions never faced before2,12,13. This is because, in 
theory, a cognitive map of abstract relationships, such as a concep-
tual space14 or task space15, would allow for ‘novel routes’ and ‘short-
cuts’ to be inferred, as in physical space2,11 (Fig. 1a). Notably, such 
direct inferences go beyond chaining together directly experienced 
associations (Fig. 1a) and are seen as the defining characteristic of 
a genuine cognitive map of spatial environments3,4,16. Despite these 
theoretical insights, whether such direct inferences (as opposed to 
chaining together previously experienced associations) are, in fact, 
used for non-spatial decision-making, and whether grid representa-
tions underpin these inferences about non-spatial relationships, is 
unknown.
Recent pioneering studies have identified hippocampal 
place-like and entorhinal grid-like neural modulation for behav-
iorally relevant, continuous, non-spatial stimulus dimensions, 
including sound frequency17, metric length of bird legs and necks 
in a conceptual ‘bird space’14 and odor concentration18. These find-
ings support theories proposing that place and grid cells revealed 
in physical space might reflect a general mechanism for organizing 
relationships between any behaviorally relevant dimensions2,19. In 
the real world, a wide range of everyday decisions involve discrete 
entities that vary along multiple abstract dimensions whose feature 
values must be learned discretely from piecemeal experiences and 
in the absence of explicit sensory feedback. Here we test the hypoth-
eses that, first, such piecemeal experiences are integrated into an 
abstract cognitive map, and, second, a grid code is used to make 
direct inferences to guide decision-making based on that cognitive 
map (Fig. 1b,c).
Results
Behavioral results. We used social hierarchies to test the above 
hypotheses, because they represent an ecologically important 
example of abstracted multidimensional relationships and build on 
recent studies suggesting that the brain might encode and maintain 
relational information about social entities, ranging from relation-
ships to traits20–23. Specifically, we leveraged established functional 
magnetic resonance imaging (fMRI) approaches14,24,25 to test for 
a reconstructed cognitive map of an abstract 2D social hierarchy 
and a grid-like code for inferred direct trajectories between enti-
ties during decision-making (Fig. 1b). Notably, the social hierarchy 
was never seen but could be reconstructed from the outcomes of 
binary comparisons about the higher-rank individual between 
pairs on one dimension at a time, with each dimension learned 
on a separate day. To test our hypotheses, we designed a ‘partner 
Inferences on a multidimensional social hierarchy 
use a grid-like code
Seongmin A. Park   1 ✉, Douglas S. Miller   1,2 and Erie D. Boorman   1,3 ✉
Generalizing experiences to guide decision-making in novel situations is a hallmark of flexible behavior. Cognitive maps of an 
environment or task can theoretically afford such flexibility, but direct evidence has proven elusive. In this study, we found that 
discretely sampled abstract relationships between entities in an unseen two-dimensional social hierarchy are reconstructed 
into a unitary two-dimensional cognitive map in the hippocampus and entorhinal cortex. We further show that humans use a 
grid-like code in entorhinal cortex and medial prefrontal cortex for inferred direct trajectories between entities in the recon-
structed abstract space during discrete decisions. These grid-like representations in the entorhinal cortex are associated with 
decision value computations in the medial prefrontal cortex and temporoparietal junction. Collectively, these findings show 
that grid-like representations are used by the human brain to infer novel solutions, even in abstract and discrete problems, and 
suggest a general mechanism underpinning flexible decision-making and generalization.
Nature Neuroscience | VOL 24 | September 2021 | 1292–1301 | www.nature.com/natureneuroscience
1292

Articles
NaTurE NEurosCIEnCE
selection task’ that required participants (n = 21) to infer a better 
collaborator for a given ‘entrepreneur’ by comparing their relative 
ordinal ranks in two ecologically important social dimensions: 
their competence and their popularity26. During behavioral train-
ing, participants learned the relative rank between individuals in the 
two independent dimensions through feedback-based binary com-
parisons. Participants only learned about individuals who differed 
by one rank level and on one dimension at a time (Fig. 1d), with 
each dimension learned on a separate day (on average 2 days apart). 
Notably, participants were never shown the true hierarchy, nor were 
they asked to construct it spatially, but they could, theoretically, 
reconstruct it through transitive inferences within a dimension on 
a given day and integration across dimensions learned on different 
days (Supplementary Fig. 1). During fMRI, participants were asked 
to choose a better partner for a given ‘entrepreneur’ (F0) between 
two potential partners (F1 or F2) (Fig. 2a). Critically, these indi-
viduals’ 2D rank in the combined social space was never learned 
during training, meaning that each decision during the fMRI task 
in fact required inferences to determine the better partner. That is, 
the two separately learned dimensions had to be combined to com-
pute the potential of a collaboration, which was never learned from 
feedback during training.
In our task, the better collaboration was determined by the 
growth potential (GP) of each pair. To compute the GP, participants 
Spatial navigation
Aligned
Misaligned
a
Experienced relationships
Inferred relationships
d
Competence
Popularity
b
c
θ1
θ2
Day 1
Day 2
Behavioral training
Partner selection
Partner selection
fMRI day 1
fMRI day 2
Post-scan
Placement
More than 1 week
1
2
3
4
5
6
Behavioral training
Piecemeal learning
Partner selection task (fMRI)
Day 2
Day 1
One rank difference
θ1, High activity
θ2, Low activity
Inferred trajectory
Attribute space
Activity
Soccer IQ
Athleticism
θ1
θ2
θ2
θ1
ϕ
ϕ
ϕ
ϕ + π
ϕ + 2π
Fig. 1 | Behavioral training procedure and hypothesized neural representations. a, A cognitive map of spatial (left) and non-spatial (right) relational 
structures allows for new direct routes or relationships to be inferred from directly experienced relationships, dramatically accelerating learning and 
decision capabilities through generalization. b, Participants learned the rank of 16 individuals organized into a 2D social hierarchy defined by competence 
and popularity. Participants never saw 1D or 2D social hierarchies, but they could learn it piecemeal from dyadic comparisons in one dimension at a time 
during behavioral training. We hypothesized that neural activity would be modulated hexadirectionally by the inferred trajectories over the 2D social space, 
as predicted by a hexagonal grid organization. c, The inferred trajectories can be categorized as aligned and misaligned with the mean grid orientation, 
ϕ, which is different for each participant. θ1 and θ2 show examples of aligned and misaligned trajectories, respectively. Greater activity is predicted when 
the inferred trajectory is aligned compared to misaligned because it passes over more grid fields, which generates hexadirectional grid-like modulation. 
d, Behavioral training procedure. On day 1 and day 2 of behavioral training, participants learned the ranks of 16 individuals (face stimuli) in each of two 
dimensions (competence or popularity) through binary decisions about the higher-rank individual in a pair who differed by only one rank level in a given 
dimension, with each dimension learned on a different day. Within a day, the order of pairs compared was further randomized. After behavioral training, 
participants performed three blocks of the ‘partner selection task’ twice during fMRI scanning, with a gap between sessions of at least 1 week. After the 
second session, participants were asked to place individuals according to their believed combined rank in a 2D space for the first time (placement task).
Nature Neuroscience | VOL 24 | September 2021 | 1292–1301 | www.nature.com/natureneuroscience
1293

Articles
NaTurE NEurosCIEnCE
were instructed that they should weight the ranks of the pair in both 
dimensions equally, with the rank of a pair in each dimension deter-
mined by the higher-rank individual between the two. Therefore, 
the GP corresponds to the area drawn by the higher rank of the 
two entrepreneurs in each dimension in the 2D hierarchy (Fig. 2b). 
In other words, the GP indicates the benefit that F0 could expect 
from a collaboration, and participants made their decisions based 
on which collaboration would benefit F0 most as a pair. We hypoth-
esized that people would infer direct trajectories (which we refer 
to as direct inferences because they correspond to direct vectors 
over the 2D space that were never learned during training) over the 
reconstructed 2D space between the positions of the entrepreneur, 
F0, and each potential partner, F1 and F2, to compute the GP for 
each collaboration (Figs. 1b and 2 and Supplementary Fig. 2a). After 
training on the partner selection task, performed with an entirely 
different set of choice comparisons and in the absence of any choice 
feedback, participants who passed our performance criterion 
(>95% accuracy; Methods) were highly accurate in choosing the 
better collaboration during the fMRI session (mean ± s.e. accuracy 
= 98.68% ± 0.27%; Supplementary Fig. 2).
We found significant effects of GP (corresponding to the pair’s 
decision value) on the reaction times (RTs) of decisions: the greater 
the GP of each pair, and the absolute difference between them, the 
faster the RT, even after partialling out Euclidean distances of the 
inferred trajectories (t20 > 4.7 and P < 0.001; Supplementary Fig. 
3). We also found that the higher the current transient entropy 
after seeing F1 (that is, the uncertainty of the decision before see-
ing F2), the slower the RT (t20 = 4.3 and P = 3.6 × 10−4), where the 
entropy is computed from the probability that F1 would be a better 
partner against all possible F2 candidates. Although this entropy is 
defined only transiently after F1 and before F2 presentation, it could 
help participants prepare their decisions, because the face stimuli 
are sequentially presented (note that this entropy term covaries 
with the F0–F1 vector angle but is independent from the grid code 
(cos(∠F0F1 −π/4)); r = 0.66 and P = 4.2 × 10−37; Supplementary 
Fig. 3 and Supplementary Table 1).
2D neural representation of the social hierarchy. We first tested 
whether the HC–EC system would reconstruct the true unseen 
social hierarchy as a 2D cognitive map. Specifically, we reasoned 
that more proximal people in the true 2D social space (measured 
by their Euclidian distance) would be represented progressively and 
linearly more similarly (Fig. 3a). Using representational similarity 
analysis (RSA) applied to blood-oxygen-level dependent (BOLD) 
activity patterns evoked by each face presentation (at F1 and F2) 
after downsampling to match the number of observations per face 
and excluding faces 1 and 16, which were sampled less frequently 
(Methods and Supplementary Fig. 4), we found that the level of pat-
tern dissimilarity across voxels (measured by the Mahalanobis dis-
tance) in a priori anatomically defined regions of interests (ROIs) in 
the HC and EC (Fig. 3b) was robustly related to the pairwise Euclidian 
distance between individuals in the true 2D social space (P < 0.001 
family-wise error (FWE)-corrected over ROIs) (Fig. 3c), such that 
closer people in the true 2D space were represented increasingly 
more similarly. Results were similar when, instead, all samples of 
all 16 faces were used (Supplementary Fig. 5e). To ensure that these 
pattern similarity effects in the HC and EC were better accounted 
for by the 2D Euclidian distance than either one-dimensional (1D) 
distance alone, we decomposed the Euclidian distance into sepa-
rate popularity and competence dimensions. We found significant 
effects of the 1D rank distance in both popularity and competence 
dimensions on pattern similarity in HC (popularity: τA = 0.07; 
b
GP2
a
θF0F1
θF0F2
F1 presentation
F2 presentation
GP1
Partner selection task (fMRI)
Decision
F0, 2.5 s
ISI1 jitter
ISI2, 3 s
ISI3, jitter
F1, 5 s
F0, 2.5 s
F2, 5 s
ITI jitter
F1
F0
F2
F0
Fig. 2 | Partner selection task. a, Illustration of a trial of the partner selection task during fMRI. Participants were asked to make a binary decision by 
choosing a better business partner for a given individual (F0) between two (F1 and F2). The better partner is determined by the GP that each pair could 
expect from their collaboration. Participants could compute the GP of the F0 and F1 pair when F1 is shown and the GP of the F0 and F2 pair when F2 
is shown. Participants were subsequently asked to make a decision during F2 presentation. No feedback was given. b, To compute the GP of a pair, 
participants were instructed that the GP corresponds to the higher ‘rank of the pair’ in each dimension. Participants were further asked to weigh the ‘rank 
of the pair’ in both dimensions equally. Therefore, the GP corresponds to the area drawn by the higher rank of the two people in each dimension in the 
2D hierarchy (GPF0F1 (green rectangle) > GPF0F2 (red rectangle); F1 is the better partner for F0 in this example). We hypothesized that people would infer 
direct trajectories over the mentally reconstructed 2D space between the positions of F0 and each potential partner, F1 and F2, to compute the GP for each 
collaboration. We searched for neural evidence for hexadirectional modulation of inferred trajectories though the reconstructed cognitive map (θF0F1 at the 
time of F1 presentation and θF0F2 at the time of F2 presentation). ISI, inter-stimulus interval; ITI, inter-trial interval.
Nature Neuroscience | VOL 24 | September 2021 | 1292–1301 | www.nature.com/natureneuroscience
1294

Articles
NaTurE NEurosCIEnCE
competence: τA = 0.07) and EC (popularity: τA = 0.05; competence: 
τA = 0.04) (all P < 0.001 FWE-corrected; see Fig. 3d,e for alternative 
definitions of x and y dimensions), consistent with a 2D cognitive 
map. Effects of the Euclidian distance were significantly stronger 
than either single dimension alone (Fig. 3c; see Supplementary 
Table 2 for formal comparisons). To further probe the representa-
tional architecture in HC and EC in a 2D space, we applied multidi-
mensional scaling (MDS) on their activity patterns while matching 
the number of observations per face, which revealed a consistent 
relationship between the true Euclidian distances and the estimated 
distances between the location of individuals in a 2D space (Fig. 3h 
and Extended Data Fig. 1a). To complement these results based on 
the downsampled events, we additionally performed RSA and MDS 
of the same 14 faces while including all trials’ neural responses. 
Consistent with the results of the sample size-matched analysis, 
the results of the analysis, including all responses (Extended Data 
Figs. 1b and 2) and additional control analyses (Supplementary Fig. 
5c,d), confirm that the HC–EC system integrates piecemeal, dis-
crete observations about abstract relationships, learned on separate 
days from the outcomes of choices, into a unitary 2D cognitive map.
To examine the neural representation of the 2D social hierarchy 
outside of our a priori ROIs, we performed a whole-brain search-
light RSA, both after downsampling (Fig. 3f and Supplementary 
Table 3a) and based on all observations (Fig. 3g and Supplementary 
Table 3b). In both analyses, we found significant effects of Euclidean 
distances in the HC and EC (PFWE < 0.05 threshold-free cluster 
enhancement (TFCE) correction in anatomically defined ROIs). 
In addition, we found significant effects in the medial prefrontal 
cortex (mPFC), orbitofrontal cortex (OFC) and posteromedial cor-
tical areas (posterior cingulate cortex (PCC)/precuneus and retro-
splenial cortex (RSC)), among other areas, in both analyses (Fig. 
3f,g) and the inferior parietal lobule in the analysis incorporating all 
observations (Fig. 3g) (PFWE < 0.05 whole-brain TFCE correction).
Grid-like representations of trajectories for novel inferences. 
Having found evidence that the 2D social hierarchy is represented 
as a 2D cognitive map in HC and EC and interconnected cortical 
regions, we next searched for established fMRI markers of a grid-like 
code but for inferred rather than previously experienced trajecto-
ries during decision-making14. Specifically, we searched for neural 
evidence for hexadirectional modulation for inferred trajectories 
though the reconstructed cognitive map (Fig. 1b,c) that, we hypoth-
esized, were used to compute the GP to guide decisions—−−→
F0F1 at 
the time of F1 presentation and −−→
F0F2 at the time of F2 presentation 
(Fig. 2). To test this hypothesis, we employed a two-step approach: 
first, we functionally identified ROIs showing hexagonal modula-
tion for inferred trajectories independently of a participant’s EC 
grid orientation for future independent tests; second, we searched 
across the whole brain for regions showing hexagonal modulation 
that is aligned to a participant’s EC grid orientation.
For the first step, we tested for regions where the BOLD sig-
nal was hexagonally modulated (that is, any linear combination of 
sin(6θ) and cos(6θ) using a z-transformed F-statistic (as in ref. 14), 
where θ is the inferred trajectory angle between two faces in the 
social space). We found significant non-uniform clustering of puta-
tive grid orientations (ϕ) for all participants across voxels in the EC 
ROIs (P < 0.01; mean z ± s.e.m. = 50.98 ± 4.14; Supplementary Fig. 
6). Note that this analysis was performed to functionally identify 
independent EC ROIs from which to compute the grid orientation 
angle ϕ for a given subject for future tests. We found evidence of 
hexagonal modulation, independently of grid orientation, in the 
EC (at z > 2.3 and P < 0.01) and, additionally, in mPFC, PCC and 
posterior parietal cortex (PPC) (P < 0.05 whole-brain TFCE correc-
tion) (Extended Data Fig. 3a,b and Supplementary Table 4).
We then tested for hexagonal modulation aligned to the EC grid 
orientation for each participant using an unbiased cross-validation 
(CV) procedure from fMRI sessions acquired on the same day. To 
obviate concerns of selection bias, we separated a ‘training dataset’ 
for estimating the putative grid angle (ϕ) from the EC ROI func-
tionally identified by step 1 above from a ‘testing dataset’ on which 
the effects of hexagonal symmetry were tested (using the regressor 
cos(6[θt −ϕ])) (Methods and Extended Data Fig. 3c). For this criti-
cal test, we observed hexagonal modulation for inferred trajectories 
aligned to the estimated grid orientation in bilateral EC and mPFC 
(P < 0.05 TFCE-corrected; Fig. 4a,b and Supplementary Table 5a; 
see Supplementary Fig. 7a for confirmatory analyses on indepen-
dent anatomically defined EC and mPFC ROIs). Notably, control 
analyses indicated that the modulation in EC and mPFC was spe-
cific to a six-fold periodicity, as significant modulation was not 
seen for four-, five-, seven- or eight-fold periodicities (all P > 0.05). 
Furthermore, the effect at six-fold was significantly stronger than 
the control periodicities (all P < 0.05) (Fig. 4b and Supplementary 
Table 6).
Outside of these regions predicted from previous studies14,24, we 
also observed within-day hexagonal modulation aligned to the EC 
grid orientation in bilateral temporoparietal junction (TPJ) areas 
and bilaterally along the superior temporal sulci (STS) (Fig. 4a; see 
Supplementary Fig. 7b for additional analyses of fusiform face area 
(FFA) ROIs). Notably, the TPJ, STS and dorsal aspect of mPFC, in 
which we observed hexagonal modulation, are commonly recruited 
during tasks engaging theory of mind in social cognition27–29, includ-
ing the modeling or simulation of different perspectives30. Because 
participants were asked to take the perspective of the entrepreneur 
(F0) and decide with whom they should partner, perspective-taking 
on the cognitive map was a likely requirement to perform the part-
ner selection task successfully. This requirement might, therefore, 
Fig. 3 | Building a 2D representation of a social hierarchy. a, Model RDM computed from the pairwise Euclidean distances between individuals on the 
true 2D social hierarchy. b, The extent to which the model RDM explained the pattern dissimilarity in ROIs. c, RSA based on equal sampling of 14 faces (by 
downsampling). The rank correlation (τA) shows robust effects of Euclidean distance (gray) compared to the permuted baseline (1,000 iterations; dashed 
line) but not in a control region, M1 (one-tailed Wilcoxon signed-rank test, green asterisks). The τA of the Euclidean distance was significantly greater 
than the 1D rank distance in each ROI (two-tailed Wilcoxon signed-rank test, black asterisks) (Supplementary Table 2; **PFWE < 0.005, Bonferroni–Holm 
correction). d, e, The pattern dissimilarity in HC and EC increases in proportion to the pairwise Euclidean distance between individuals (gray) as well as 
with the two-component 1D rank distances (blue and red). For display purposes, the dissimilarity level was normalized to account for individual differences 
in scales (n = 21). c–e, Box, lower and upper quartiles; line, median; whiskers, range of the data excluding outliers; +, the whiskers’ range of outliers. f, 
Whole-brain searchlight RSA based on equal sampling of 14 faces at all events (F0, F1 and F2 presentations). g, Whole-brain searchlight RSA including 
all observations. The activity patterns in the HC, EC, mPFC/mOFC and PCC/precuneus are explained by the model RDM for pairwise Euclidean distance 
(whole-brain TFCE correction, PFWE < 0.05, except for HC and EC, which was corrected using a priori ROIs (denoted by ✻)). h, Visualization of the group 
representation of the social hierarchy in a 2D space using MDS on the neural activity extracted from the HC ROIs. The MDS (left) captures the true social 
hierarchy structure (right) better than random configurations (P < 0.01 compared to 1,000 random permutations; Extended Data Fig. 1). i. Post-scan 
placement task. All participants successfully placed faces according to their ranks in a 2D social hierarchy space. Each participant’s responses were 
rescaled according to their longest distances. Each dot indicates the face position placed by a single participant, and colors indicate the ranks in the true 
social hierarchy. n.s., not significant.
Nature Neuroscience | VOL 24 | September 2021 | 1292–1301 | www.nature.com/natureneuroscience
1295

Articles
NaTurE NEurosCIEnCE
explain their recruitment, and alignment with the grid code, in our 
partner selection task.
Follow-up analyses tested plausible alternative decision-related 
vectors and subjectively defined cognitive maps. We did not find 
any evidence of hexadirectional grid-like coding of the alternative 
decision vector between F1 and F2 in the EC or mPFC (Extended 
Data Fig. 3d). In addition, we tested for alternative cognitive map 
geometries. First, we confirmed that the activity patterns in these 
brain areas were not better captured by the inferred trajectories 
over a neurally defined space, by using angles computed from the 
MDS of each participant’s HC (θMDS) compared to those from the 
true social hierarchy structure (θ). Notably, it was not possible to 
x = –29
y = –9
HC*
EC*
f
Whole-brain RSA with number matched samples
mPFC
OFC
y = 33
x = 32
HC*
EC*
x = –8
PCC/
precuneus
mPFC/OFC
g
Whole-brain RSA with all responses
y = –12
3.0
4.0
5.0
t-value
0.88
0.92
0.96
Popularity
1
2
3
0.86
0.90
0.96
Popularity
1
2
3
1
2
3
0.86
0.90
0.96
Competence
1
2
3
0.88
0.92
0.96
Competence
10 13
0.8
0.0
0.9
1.0
Dissimilarity (a.u)
Euclidean
1
2
4
5
8
9
1D distance
1D distance
2D distance2
2D distance2
1D distance
1D distance
2D distance2
Dissimilarity (a.u)
0.8
0.0
0.9
1.0
Dissimilarity (a.u)
Dissimilarity (a.u)
Dissimilarity (a.u)
Dissimilarity (a.u)
Euclidean
10 13
1
2
4
5
8
9
0.86
0.0
0.0
0.0
0.0
0.0
0.90
0.96
Dissimilarity (a.u)
Dissimilarity (a.u)
Dissimilarity (a.u)
Dissimilarity (a.u)
Euclidean
10 13
1
2
4
5
8
9
HC right
HC left
EC left
d
e
0.8
0.9
Competence
1
2
3
0.0
1D distance
2D distance2
0.80
0.0
0.90
Dissimilarity (a.u)
Euclidean
10 13
1
2
4
5
8
9
0.80
0.90
Popularity
1
2
3
1D distance
0.0
1
2
3
0.80
0.90
Competence
Dissimilarity (a.u)
1D distance
0.0
EC right
0.8
0.0
0.9
Popularity
1
2
3
1D distance
MDS with number matched samples
2
1
3
4
6
7
8
10
11
12
13
9
5
14
15
16
2
4
5
7
8
9
10
11
12
13
14
15
3
6
h
n = 21
Post-scan placement
(normalized)
i
n = 21
Close
Far
Euclidean distance
y = –9
n = 21
EC
HC
a
b
c
Rank correlation (Kendall’s τA)
HC left
HC right
EC left
EC right
M1 left
M1 right
–0.1
0.0
0.1
0.2
**
**
**
**
**
**
**
**
**
**
**
**
**
**
**
**
n.s.
n.s.
n.s.
n.s.
n.s.
n.s.
Euclidean distance (2D)
Competence rank (1D)
Popularity rank (1D)
2
2
3
3
14
14
15
15
Nature Neuroscience | VOL 24 | September 2021 | 1292–1301 | www.nature.com/natureneuroscience
1296

Articles
NaTurE NEurosCIEnCE
clearly distinguish between distances on a space defined by strictly 
linear dimensions and one defined by certain non-linear, mono-
tonic dimensions, such as certain sigmoidal functions, in our task 
(Supplementary Fig. 8).
To test whether grid alignment was consistent for the same 
behavioral task over time, we acquired another fMRI dataset on the 
same participants (n = 21) on the same task more than 1 week later 
(average duration = 8.95 ± 0.81 days). We found hexagonal modu-
lation aligned to the EC grid calculated from the other (left-out) 
day in a similar set of brain regions, including the EC and mPFC, 
and also in PCC (P < 0.05 TFCE-corrected) (Fig. 4c, Extended Data 
Fig. 3 and Supplementary Table 5b). Once again, the effect at the 
EC day1(2) (ϕ) →  EC day2(1) (θ)
EC day1(2) (ϕ) →  mPFC day2(1) (θ)
c
4
5
6
7
8
Periodicity
–0.2
–0.3
–0.1
0.0
0.1
0.2
0.3
Δ z-score (aligned – misaligned)
**
*
**
*
**
Mean±s.e.m.
Median
P < 0.01
P < 0.05
Two tailed one-sample t-test
Paired t-test
Quartiles
Range of the data
(excluding outliers)
Outliers
****
**
–0.2
–0.3
–0.1
0.0
0.1
0.2
0.3
Δ z-score (aligned – misaligned)
4
5
6
7
8
Periodicity
**
**
**
**
**
EC estimate (ϕ) →  mPFC test (θ)
b
EC estimate (ϕ) →  EC test (θ)
–0.2
–0.3
–0.1
0.0
0.1
0.2
0.3
4
5
6
7
8
Periodicity
Δ z-score (aligned – misaligned)
**
**
**
**
**
–0.2
–0.3
–0.1
0.0
0.1
0.2
0.3
Δ z-score (aligned – misaligned)
4
5
6
7
8
Periodicity
****
****
**
Direction of inferred trajectory (θ)
0.0
0.2
–0.2
0.4
0.6
–0.4
0.8
–0.8
–0.6
Mean activity (z-score)
ϕ
ϕ + 60
ϕ + 120
ϕ + 180
ϕ + 240
ϕ + 300
ϕ + 30
ϕ + 90
ϕ + 150
ϕ + 210
ϕ + 270
ϕ + 330
Direction of inferred trajectory (θ) 
0.0
0.2
–0.2
0.4
0.6
–0.4
0.8
–0.8
–0.6
Mean activity (z-score)
ϕ
ϕ + 60
ϕ + 120
ϕ + 180
ϕ + 240
ϕ + 300
ϕ + 30
ϕ + 90
ϕ + 150
ϕ + 210
ϕ + 270
ϕ + 330
0.0
0.2
–0.2
0.4
0.6
–0.4
0.8
–0.8
–0.6
Mean activity (z-score)
Direction of inferred trajectory (θ) 
ϕ
ϕ + 60
ϕ + 120
ϕ + 180
ϕ + 240
ϕ + 300
ϕ + 30
ϕ + 90
ϕ + 150
ϕ + 210
ϕ + 270
ϕ + 330
Direction of inferred trajectory (θ) 
0.0
0.2
–0.2
0.4
0.6
–0.4
0.8
–0.8
–0.6
Mean activity (z-score)
ϕ
ϕ + 60
ϕ + 120
ϕ + 180
ϕ + 240
ϕ + 300
ϕ + 30
ϕ + 90
ϕ + 150
ϕ + 210
ϕ + 270
ϕ + 330
x = –7
y = –58
y = 51
mPFC
EC*
STS
TPJ
TPJ
a
y = –8
3.0
4.0
5.0
t-value  
n = 21
Fig. 4 | Hexagonal modulation for inferred trajectories. a, Whole-brain parametric analysis showing hexagonal grid-like representation of inferred 
trajectories in alignment with the mean EC grid orientation at the time of F1 and F2 presentations. Significant effects are shown in EC (peak MNI 
coordinates, (x, y, z) = (22, −10, −28), t = 4.11), mPFC ((−6, 48, −4); t = 4.72), STS ((50, −40, 4), t = 4.05 for right; (−60, −24, −6), t = 4.29 for 
left), TPJ ((46, −58, 20), t = 3.67 for right; (−56, −68, 24), t = 5.71 for left) (all PTFCE < 0.05, whole-brain cluster-corrected using TFCE) and EC 
(peak MNI coordinates, (x, y, z) = (22, −10, −28), t = 4.11) (PFWE < 0.05 TFCE correction within a priori anatomical ROI). The maps are displayed at a 
cluster-corrected threshold PTFCE < 0.05 over the whole brain for all brain regions, except for the EC, where we used a threshold of PTFCE < 0.05 corrected 
within anatomically defined ROI (denoted by ✻ next to EC), due to our strong a priori hypothesis of grid coding in EC7,24 (Supplementary Table 5). b, 
Six-fold modulation signals in the EC (left panel) and mPFC (right panel) ROIs aligned to the grid orientation in EC. The grid orientation was estimated 
from separate fMRI sessions acquired from the same day. The mean (± s.e.) z-scored activity is plotted separately for aligned (teal) and misaligned (gray) 
trajectories categorized into 12 equal bins of 30° according to the direction of inferred trajectories. The mean activity difference between aligned and 
misaligned trajectories was larger than zero for six-fold (P < 0.01) but not for the other control periodicities (four-, five-, seven- and eight-fold; all P >0.05) 
(two-tailed one-sample t-test), and the activity difference is greater for six-fold compared to the other periodicities (P < 0.05; paired t-test). c. Cross-day 
consistency of the grid orientation in EC (see Extended Data Fig. 3e for whole-brain analysis). The activity in EC and mPFC shows hexadirectional 
modulations for the inferred trajectories in alignment with the grid orientation in EC estimated from separate sessions acquired from a different day 
more than 1 week apart. This effect is also specific to the six-fold (P < 0.01) periodicity (all others, P > 0.05), suggesting that the mean grid angle in EC is 
consistent between sessions more than 1 week apart (Supplementary Table 6).
Nature Neuroscience | VOL 24 | September 2021 | 1292–1301 | www.nature.com/natureneuroscience
1297

Articles
NaTurE NEurosCIEnCE
six-fold periodicity was significantly stronger than all other control 
periodicities (all P < 0.05; Supplementary Table 6). This set of brain 
regions—EC, mPFC and PCC—that showed a consistent grid-like 
code over time for novel inferences through a reconstructed social 
space during decision-making aligns with previous findings for 
trajectories actually traveled through physical space to remembered 
locations in virtual reality24.
Grid-like modulation of neural value signals. To make optimal 
decisions in the partner selection task, participants need to compute 
Direction of inferred trajectory (θ)
0.0
0.2
Ð0.2
0.4
0.6
Ð0.4
0.8
Ð0.8
Ð0.6
β GP (z-scored)
4
5
6
7
8
Periodicity
Ð0.2
Ð0.1
0.0
0.1
0.2
0.3
Ð0.3
Δz-score (aligned Ð misaligned)
EC estimate (ϕ) →  rTPJ test (θ)
ϕ
ϕ + 60
ϕ + 120
ϕ + 180
ϕ + 240
ϕ + 300
ϕ + 30
ϕ + 90
ϕ + 150
ϕ + 210
ϕ + 270
ϕ + 330
Direction of inferred trajectory (θ)
**
**
**
**
**
0.0
0.2
Ð0.2
0.4
0.6
Ð0.4
0.8
Ð0.8
Ð0.6
β GP (z-scored)
Ð0.2
Ð0.1
0.0
0.1
0.2
0.3
Ð0.3
Δz-score (aligned Ð misaligned)
4
5
6
7
8
Periodicity
EC estimate (ϕ) →  lTPJ test (θ)
ϕ
ϕ + 60
ϕ + 120
ϕ + 180
ϕ + 240
ϕ + 300
ϕ + 30
ϕ + 90
ϕ + 150
ϕ + 210
ϕ + 270
ϕ + 330
Direction of inferred trajectory (θ)
**** ****
**
*
*
**
***
*
Misaligned
Aligned
One-sample t test
(two tailed)
Mean ± s.e.m.
Median n = 21
P < 0.05
P < 0.01
P < 0.005
Paired t test
0.0
0.2
Ð0.2
0.4
0.6
Ð0.4
0.8
Ð0.8
Ð0.6
β GP (z-scored)
Ð0.2
Ð0.1
0.0
0.1
0.2
0.3
Ð0.3
4
5
6
7
8
Periodicity
Δz-score (aligned Ð misaligned)
b
EC estimate (ϕ) →  mPFC test (θ)
ϕ
ϕ + 60
ϕ + 120
ϕ + 180
ϕ + 240
ϕ + 300
ϕ + 30
ϕ + 90
ϕ + 150
ϕ + 210
ϕ + 270
ϕ + 330
**** ****
**
c
Gridness β cos(6 [θ Ð ϕ]) in EC
Ð0.4
0.0
0.4
0.6
0.8
0.0
1.0
2.0
lTPJ
rTPJ
β GP
e
β GP
0.0
Ð0.4
0.4
0.8
1.2
mPFC
rTPJ
lTPJ
***
***
**
***
***
*** ***
**
***
f
Neural correlates of |GP1 Ð GP2|
y = Ð11
x = Ð4
y = Ð4
mPFC
HC
EC*
3.0
4.0
5.0
t-value n = 21
a
x = 49
x = 7
mPFC
y = Ð59
TPJ
TPJ
y = Ð4 EC*
Neural correlates of decision values (GP)
3.0
4.0
5.0
t-value n = 21
x = 56
x = 52
mPFC
STS
y = 3
d
TPJ
3.0
4.0
5.0
t-value n = 21
β GP aligned trajectories > β GP misaligned trajectories
EC*
x = 7
Fig. 5 | GP and value comparison. a, Whole-brain map showing effects of the GP at the time of F1 and F2 presentation in a network of brain regions 
including the mPFC (peak MNI coordinates, (x, y, z) = (10, 52, 6), t = 5.55) and bilateral TPJ ((54, −56, 34), t = 5.45) for right; (−54, −60, 28), t = 5.18) 
for left) (PTFCE < 0.05 whole-brain TFCE correction). The EC ((x, y, z) = (20, −4, −32), t = 3.88) also showed GP effects. b. Mean (± s.e.) effects of GP 
(z-scored β) in mPFC and bilateral TPJ are modulated by the grid alignment of the inferred trajectories, θ, with six-fold periodicity aligned with the EC grid 
orientation, ϕ. Control analyses confirmed specificity for this six-fold periodicity (P < 0.01) over control periodicities (effect of six-fold compared to other 
control periodicities, all P < 0.05; Supplementary Table 6). c. Those participants with greater hexagonal modulation in EC show greater encoding of GP 
in independently defined bilateral TPJ ROIs (all P < 0.05; Extended Data Fig. 5). d. Whole-brain map contrasting the effects of GP (β GP) for trajectories 
aligned with the EC grid orientation, ϕ, compared to the misaligned trajectories (β GP aligned > β GP misaligned: PTFCE < 0.05 whole-brain TFCE 
correction). Contrasts are shown in mPFC, EC, STS and TPJ. e. Mean (± s.e.) GP effects in anatomically defined mPFC and bilateral TPJ ROIs (β GP). In all 
three areas, effects were greater for aligned compared to misaligned trajectories (all P < 0.01), although the GP effects of both trajectories were significant 
(all P < 0.01). b, e, Box, lower and upper quartiles; line, median; whiskers, range of the data excluding outliers; +, the whiskers’ range of outliers. f, Neural 
correlates of the relative decision value, |GP1 – GP2|, during decision-making, in vmPFC ((−8, 54, −6); t = 5.07), HC ((−28, −4, −26); t = 4.53)  
(PTFCE < 0.05) and bilateral EC ((22, −12, −26), t = 5.10 for right; (−26, −16, –32), t = 4.00 for left; PTFCE < 0.05 TFCE corrected in a priori ROIs). ***P < 
0.005; **P < 0.01; *P < 0.05. All the maps are displayed at a cluster-corrected threshold PTFCE < 0.05 over the whole brain for all brain regions, except for 
the EC, where we used a threshold of PTFCE < 0.05 corrected within our anatomically defined ROI (denoted by ✻ next to EC).
Nature Neuroscience | VOL 24 | September 2021 | 1292–1301 | www.nature.com/natureneuroscience
1298

Articles
NaTurE NEurosCIEnCE
and compare the GPs of each pair. The value of each decision option, 
therefore, corresponds to each pair’s GP. A whole-brain analysis of 
parametric effects of the GP at the time of face 1 and face 2 presen-
tations revealed significant effects of the GP in bilateral TPJ, mPFC 
and EC (P < 0.05 TFCE-corrected; Fig. 5a and Supplementary Table 
7), indicating that BOLD activity in these regions quantitatively 
reflected the GP of a pair under consideration. Notably, the GP and 
hexagonal modulation (cos(6[θt −ϕ])) regressors showed little cor-
relation (mean r ± s.e. = 0.04 ± 0.03), and both effects remained 
after including the other term as a regressor in the same general 
linear model (GLM), indicating that both terms explained inde-
pendent variance in these regions (Supplementary Figs. 3a and 9).  
We further confirmed that the mPFC and right TPJ activity not 
only encoded the decision value (GP) but also showed a hexadi-
rectional grid-like code for inferred trajectories for novel decisions 
(Supplementary Fig. 9), even when controlling for effects of the 
Euclidean distances of the trajectories (PFWE < 0.05 whole-brain 
TFCE correction; Supplementary Fig. 10).
We hypothesized that the grid code for inferred vectors might 
be used to estimate the relative rank distances between F0 and F1 
or F0 and F2 in each of the two dimensions, which might further 
underlie the computation of the GP of each pair based on a cogni-
tive map in our task (Supplementary Fig. 2a). If true, we predicted 
that the GP effects in the TPJ and mPFC regions would be modu-
lated by trajectories that were aligned compared to misaligned to 
the EC grid orientation. Examining the TPJ and mPFC ROIs func-
tionally defined using the statistically independent GP regressor (at 
P < 0.001 uncorrected) showed greater GP effects for trajectories 
that were aligned compared to misaligned with the EC grid orienta-
tion in these regions (Fig. 5b). Notably, while there was a significant 
GP effect in TPJ and mPFC for both trajectories that were aligned 
and misaligned to the grid orientation, the effect was modulated 
such that it was significantly stronger for aligned trajectories (Fig. 
5d,e and Supplementary Table 7c), consistent with a dependence of 
GP coding on EC grid coding. Control analyses confirmed speci-
ficity for this six-fold periodicity in TPJ and mPFC over control 
periodicities (all P < 0.05) (Fig. 5b). This dependence of GP cod-
ing on EC grid alignment may be hypothesized to influence behav-
ior. To test this possibility, we examined behavioral measures for 
inferred trajectories that were aligned or misaligned to the EC grid 
orientation but did not find a significant effect in RT (t20 > 1.4 and 
P > 0.05; Supplementary Fig. 3 and Supplementary Table 1) or 
accuracy (although there was limited behavioral variability in our  
participant sample).
We performed several confirmatory analyses and robustness 
checks, both for the GP effects aligned to the EC grid orientation 
and the grid-like coding reported previously. First, we confirmed 
that these effects were not driven by particular trajectories with spe-
cific angles sampled in sub-regions of the 2D space (Supplementary 
Table 8). Second, neither effects depended on the position of F0 in 
the pair, which was preferentially sampled to discourage the use of 
choice heuristics (P > 0.05; Supplementary Fig. 11). Last, we con-
firmed that these effects could not be explained by a memory of 
inferences made on previous trials in the absence of choice feed-
back but were used for novel inferences performed for the very first 
time (that is, novel pairs of F0 and F1 or F0 and F2). Specifically, we 
confirmed that the hexadirectional effects in EC and mPFC were 
robust when testing only for the pairs that were presented for the 
first time during the first day of the partner selection task (n = 88 
pairs presented for the first time on day 1 for 17 participants (83 
pairs were novel for four participants); 11 (16) pairs had been pre-
sented previously during practice, although they were compared 
against a different pair during decisions and in the absence of any 
choice feedback; Extended Data Fig. 4; P < 0.05). This analysis indi-
cates that the grid-like code and GP dependence on EC grid coding 
are both present for novel inferred trajectories composed on the fly.
We further reasoned that, if the grid code for inferred trajectories 
is related to the process of constructing the values of decision options 
(here, the pair’s GP), then those participants with greater hexagonal 
modulation in EC would also be predicted to show greater neural 
GP effects. Consistent with this prediction, we found a positive cor-
relation between the EC grid modulation effect and the GP effect in 
TPJ (Fig. 5c; r = 0.58 and P = 0.006 for left TPJ and r = 0.44 and P = 
0.05 for right TPJ) but not in mPFC (P > 0.05) across participants, 
after controlling for choice accuracy. In post hoc analyses, when we, 
instead, used the mPFC grid modulation effect, we found a marginal 
positive correlation with the GP effect in mPFC (r = 0.42 and P = 
0.057) and right TPJ (r = 0.42 and P = 0.06) (Extended Data Fig. 5).  
Although there was limited inter-subject variability in behavioral 
measures, we additionally tested for behavioral correlates of grid 
effects. We did not find a significant effect of the grid-like coding in 
EC on trial-by-trial RT (Supplementary Fig. 3 and Supplementary 
Table 1), nor a significant correlation between the extent of a par-
ticipant’s grid modulation and the degree to which the difference in 
GPs explained RT across participants (r = −0.19 for EC and r = 0.04 
for mPFC; P > 0.1).
At the time the second face (F2) is presented, participants have 
all the information needed to make a decision based on the GP of 
F0 collaborating with one partner compared to the other (a com-
parison of the two potential collaborations’ GPs). Considerable evi-
dence has supported a role for the ventromedial prefrontal cortex 
(vmPFC) in representing and comparing options’ reward values for 
goal-directed decisions, a signal that also reflects decision confi-
dence29–36. Searching for the equivalent value comparison term in 
our task —a comparison between the two options’ values, or |GP1 – 
GP2|—replicated this effect in vmPFC and also revealed a significant 
effect in the EC extending into the HC (P < 0.05 TFCE-corrected) 
(Fig. 5f and Supplementary Table 7b). Furthermore, participants 
who showed a greater hexagonal modulation in EC tended to show 
greater effects of the GP difference in vmPFC (r = 0.43 and P = 
0.05; Extended Data Fig. 5b). These effects in EC/HC are consistent 
with the interpretation that the comparison between options’ values 
during decision-making additionally involves the interconnected 
HC–EC system37 when it is based on a cognitive map38.
Discussion
We have shown that abstract and discrete relational structures, never 
seen but inferred from discrete samples through a series of binary 
comparisons on each dimension made on different days, are recon-
structed into a 2D cognitive map in the human brain. Specifically, 
we found that, the closer faces were ranked in the true 2D social 
hierarchy, the increasingly more similar their neural activity pat-
terns were in the HC and EC and also the interconnected mPFC, 
OFC and PCC/RSC37,39. This finding suggests that each entity is 
located according to its feature values along relevant dimensions 
in a 2D relational space2,19,23. Furthermore, we found evidence 
for hexagonal modulation for inferred direct trajectories over the 
abstract social space during discrete decision-making, further sup-
porting the interpretation that people infer over a 2D cognitive map 
of abstract relationships. Our findings thus suggest that having an 
explicit representation of structural relationships is beneficial for 
generalizing experiences that can be used to guide inferences dur-
ing novel decision-making.
We found evidence for a grid-like representation in EC, mPFC, 
PCC, TPJ and STS, for inferred direct trajectories through the recon-
structed 2D social space during decision-making. This finding pro-
vides novel evidence that humans can use direct inferred trajectories in 
non-spatial decision-making, a defining feature of a cognitive map of 
space4,16. Recent studies suggest that our brains have a representation of 
the relational structure of social information, including dynamic trait 
knowledge and social network relationships20–23. One study showed 
that the HC activity correlates with the vector angle defined by power 
Nature Neuroscience | VOL 24 | September 2021 | 1292–1301 | www.nature.com/natureneuroscience
1299

Articles
NaTurE NEurosCIEnCE
and affiliation dimensions22, suggesting that the HC and other regions 
might use a polar coordinate system. If the brain uses a polar coordinate 
system to locate individuals along abstract social dimensions during 
social interactions, one plausible hypothesis in the current task is that 
the brain would compute the vector angles to estimate the rank distance 
and relative position in the social hierarchy (Supplementary Fig. 2a).  
Our results indeed show that the brain encodes the vector angle to 
relate individuals in a multidimensional space, which allowed par-
ticipants to integrate separately learned relationships in each dimen-
sion to make accurate inferences for novel decisions that they have 
not made before. Taken together with recent findings in non-social 
tasks14,18,24,25,40, these findings suggest that grid-like codes are present 
in a markedly common set of core cortical brain regions, including 
the EC and interconnected mPFC and PCC37,41,42, for both spatial and 
non-spatial relational tasks. Furthermore, the grid-like code’s align-
ment between EC and mPFC was consistent when performing the 
same task over 1 week later, consistent with a previous study14, indicat-
ing a relatively stable representation over time, even in the absence of 
practice. In our study, we extended these previous reports by showing, 
to our knowledge for the first time, that, first, a grid-like code can be 
used for discretely sampled abstract spaces and, second, to compose 
novel inferences during non-spatial decision-making.
On the other hand, our findings also suggest that additional 
brain regions—TPJ, dorsal mPFC and STS (and also, to some 
extent, FFA (Supplementary Fig. 7b))—might come online in 
shared alignment with the EC grid code, depending on the spe-
cific processes required by a particular task. Notably, these areas 
are thought to play an important role in theory of mind27–29, which 
frequently involves simulating another person’s mental state30. 
Because participants were explicitly asked to select a partner 
on behalf of another entrepreneur, a manipulation that served 
to anchor trajectories to different locations in the social space, 
perspective-taking on the cognitive map was engaged in our task. 
Whether the grid-like modulation of the BOLD signal in these 
regions reflects grid cells locally outside of EC40,43 or synchronized 
input between EC and other interconnected cortical areas37,41 
remains an intriguing open question for future studies.
Finally, our study provides novel evidence linking a grid-like 
code to the construction of decision values in the mPFC and TPJ 
during decision-making. Specifically, we found that the GP of 
a pair, equivalent to the decision option’s value in our task, was 
encoded in the mPFC and TPJ, after controlling for the hexago-
nal modulation effect and Euclidian distance between individu-
als. This finding is consistent with past studies showing that these 
areas encode another person’s decision value when predicting 
their decision30,44. Importantly, this effect was modulated by the 
inferred trajectory’s alignment to the EC grid orientation, such 
that the value was encoded more strongly for aligned than mis-
aligned trajectories. Notably, hexagonal modulation of theta band 
local field data from pre-surgical human recordings has been 
identified for traveled trajectories in virtual reality45,46. Moreover, 
recent evidence indicates a critical role for theta-phase synchrony 
between the hippocampal formation and OFC that drives stimu-
lus value coding in OFC during value-based decision-making47. 
Thus, one interpretation of the dependence of value coding in 
mPFC and TPJ on EC grid alignment in our study is that the 
grid code is theta-phase locked to the coding of the GP in mPFC 
and TPJ, thus providing an information channel between EC and 
these regions. Moreover, we found that those individuals who 
showed a stronger hexagonal modulation in EC also showed 
stronger GP effects in TPJ, even after controlling for choice accu-
racy. Collectively, these findings suggest that the grid code might 
play a central role in value construction when it is based on infer-
ences over a cognitive map.
We reasoned that, to have any chance to identify the grid-like 
coding that we hypothesized, we needed to ensure that it would 
be measurable. For this reason, the behavioral training protocols 
were designed to encourage participants to treat ranks as equi-
distant intervals and to use the equal rank intervals per dimen-
sion, thereby facilitating measurement of the hypothesized direct 
vectors. We acknowledge that we cannot rule out the possibil-
ity that the requirement of high accuracy in behavioral training 
might have excluded some participants who constructed differ-
ent space geometries. However, during the partner selection task, 
participants were asked to make decisions that they had not made 
before. Decision values experienced in behavioral training, thus, 
cannot be generalized to those for the partner selection deci-
sions during fMRI. Notably, during fMRI, the GP of a pair can-
not be consistently predicted by the rank of a single individual 
but only by the combination of multidimensional information 
between two individuals (Supplementary Fig. 4). That is, the GP 
cannot be mapped on the 4 × 4 social hierarchy structure. Taken 
together with the consistent structure of the social hierarchy we 
found across sessions within 1 day and even between days over 
1 week apart, this suggests that the partner selection decisions 
did not appear to affect the representation of the social hierarchy 
structure. Moreover, it would be counterproductive to maintain a 
separate representation of the GP in a 16 × 16 structure as well as 
the 4 × 4 social hierarchy structure. Rather, using the 4 × 4 social 
hierarchy structure theoretically enables participants to flexibility 
compute the GP, even of new pairs, on the fly. This conclusion is 
supported by our RSA findings of Euclidian distance, grid-like 
coding for direct trajectories and grid orientation consistency 
across sessions acquired more than 1 week apart.
Importantly, participants do not need to represent the social 
hierarchy in a 2D space to solve our tasks. Both for the behavioral 
training task and for the novel decisions of the partner selection 
task, there is no a priori reason that these tasks need to be solved 
with a 2D map-like representation. Alternatively, participants could 
use two separate 1D number lines48 or update the rank values with 
neither 1D nor 2D maps49,50. If participants’ brains used either strat-
egy above, they still could theoretically pass our performance cri-
teria but should show no evidence of a 2D neural representation 
and grid-like coding. Our results show that human participants 
integrate two separately learned 1D social hierarchies into a 2D 
representation even when there is no explicit task demand to do so 
and use a grid-like representation to make novel decisions whose 
outcome they had never learned about before.
Taken together, our findings suggest that the cognitive map in 
the HC–EC system, and interconnected ‘default-mode’ regions, 
provide a systematic framework that the brain can use for vector 
navigation through spaces defined by abstract relationships, allow-
ing discrete entities or items to be related to each other in new situ-
ations and, thus, generalization and the discovery of new solutions 
for choice. This framework likely transcends the use of social hier-
archies investigated here, potentially extending to relational map-
ping of low-dimensional conceptual spaces2,3,11,19 and social trait 
knowledge20–23. We suggest that the alignment of the ‘default-mode’ 
network, and potentially other regions, with the entorhinal grid sys-
tem might reflect a general mechanism for knowledge-guided infer-
ence during learning and decision-making.
Online content
Any methods, additional references, Nature Research report-
ing summaries, source data, extended data, supplementary infor-
mation, acknowledgements, peer review information; details of 
author contributions and competing interests; and statements of 
data and code availability are available at https://doi.org/10.1038/
s41593-021-00916-3.
Received: 24 May 2020; Accepted: 21 July 2021;  
Published online: 31 August 2021
Nature Neuroscience | VOL 24 | September 2021 | 1292–1301 | www.nature.com/natureneuroscience
1300

Articles
NaTurE NEurosCIEnCE
References
	1.	 Sutton, R. S. & Barto, A. G. Reinforcement Learning: An Introduction  
(MIT Press, 1998).
	2.	 Behrens, T. E. J. et al. What Is a cognitive map? Organizing knowledge for 
flexible behavior. Neuron 100, 490–509 (2018).
	3.	 Tolman, E. C. Cognitive maps in rats and men. Psychol. Rev. 55,  
189–208 (1948).
	4.	 O’Keefe, J. & Nadel, L. The Hippocampus as a Cognitive Map  
(Oxford University Press, 1978).
	5.	 Stachenfeld, K. L., Botvinick, M. M. & Gershman, S. J. The hippocampus  
as a predictive map. Nat. Neurosci. 20, 1643–1653 (2017).
	6.	 Ekstrom, A. D. & Ranganath, C. Space, time, and episodic memory: the 
hippocampus is all over the cognitive map. Hippocampus 28, 680–687  
(2018).
	7.	 Hafting, T., Fyhn, M., Molden, S., Moser, M.-B. B. & Moser, E. I. 
Microstructure of a spatial map in the entorhinal cortex. Nature 436,  
801–806 (2005).
	8.	 Welinder, P. E., Burak, Y. & Fiete, I. R. Grid cells: the position code, neural 
network models of activity, and the problem of learning. Hippocampus 18, 
1283–1300 (2008).
	9.	 Bush, D., Barry, C., Manson, D. & Burgess, N. Using grid cells for navigation. 
Neuron 87, 507–520 (2015).
	10.	Banino, A. et al. Vector-based navigation using grid-like representations in 
artificial agents. Nature 557, 429–433 (2018).
	11.	Whittington, J. C. R. et al. The Tolman–Eichenbaum machine: unifying space 
and relational memory through generalization in the hippocampal formation. 
Cell 183, 1249–1263 (2020).
	12.	Kriete, T., Noelle, D. C., Cohen, J. D. & O’Reilly, R. C. Indirection and 
symbol-like processing in the prefrontal cortex and basal ganglia.  
Proc. Natl Acad. Sci. USA 110, 16390–16395 (2013).
	13.	Wang, J. X. et al. Prefrontal cortex as a meta-reinforcement learning system. 
Nat. Neurosci. 21, 860–868 (2018).
	14.	Constantinescu, A. O., O’Reilly, J. X. & Behrens, T. E. J. Organizing 
conceptual knowledge in humans with a gridlike code. Science 352, 
1464–1468 (2016).
	15.	Schuck, N. W., Cai, M. B., Wilson, R. C. & Niv, Y. Human orbitofrontal cortex 
represents a cognitive map of state space. Neuron 91, 1402–1412 (2016).
	16.	Bennett, A. T. D. Do animals have cognitive maps? J. Exp. Biol. 199,  
219–224 (1996).
	17.	Aronov, D., Nevers, R. & Tank, D. W. Mapping of a non-spatial dimension by 
the hippocampal–entorhinal circuit. Nature 543, 719–722 (2017).
	18.	Bao, X. et al. Grid-like neural representations support olfactory navigation of 
a two-dimensional odor space. Neuron 102, 1066–1075 (2019).
	19.	Eichenbaum, H. & Cohen, N. J. Can we reconcile the declarative memory 
and spatial navigation views on hippocampal function? Neuron 83,  
764–770 (2014).
	20.	Parkinson, C., Kleinbaum, A. M. & Wheatley, T. Spontaneous  
neural encoding of social network position. Nat. Hum. Behav. 1, 0072  
(2017).
	21.	Stolier, R. M., Hehman, E. & Freeman, J. B. A dynamic structure of social 
trait space. Trends Cogn. Sci. 22, 197–200 (2018).
	22.	Tavares, R. M. et al. A map for social navigation in the human brain. Neuron 
87, 231–243 (2015).
	23.	Park, S. A., Miller, D. S., Nili, H., Ranganath, C. & Boorman, E. D. Map 
making: constructing, combining, and inferring on abstract cognitive maps. 
Neuron 107, 1226–1238 (2020).
	24.	Doeller, C. F., Barry, C. & Burgess, N. Evidence for grid cells in a human 
memory network. Nature 463, 657–661 (2010).
	25.	Nau, M., Navarro Schröder, T., Bellmund, J. L. S. & Doeller, C. F. 
Hexadirectional coding of visual space in human entorhinal cortex. Nat. 
Neurosci. 21, 188–190 (2018).
	26.	Fiske, S. T., Cuddy, A. J. C. & Glick, P. Universal dimensions of  
social cognition: warmth and competence. Trends Cogn. Sci. 11,  
77–83 (2007).
	27.	Hampton, A. N., Bossaerts, P. & O’Doherty, J. P. Neural correlates of 
mentalizing-related computations during strategic interactions in humans. 
Proc. Natl Acad. Sci. USA 105, 6741–6746 (2008).
	28.	Wittmann, M. K., Lockwood, P. L. & Rushworth, M. F. S. Neural mechanisms 
of social cognition in primates. Annu. Rev. Neurosci. 41, 99–118 (2018).
	29.	Behrens, T. E. J. J., Hunt, L. T., Woolrich, M. W. & Rushworth, M. F. S. S. 
Associative learning of social value. Nature 456, 245–249 (2008).
	30.	Nicolle, A. et al. An agent independent axis for executed and modeled choice 
in medial prefrontal cortex. Neuron 75, 1114–1121 (2012).
	31.	Boorman, E. D., Behrens, T. E. J., Woolrich, M. W. & Rushworth, M. F. S. 
How green is the grass on the other side? Frontopolar cortex and the 
evidence in favor of alternative courses of action. Neuron 62, 733–743 (2009).
	32.	Boorman, E. D., Behrens, T. E. & Rushworth, M. F. Counterfactual choice 
and learning in a neural network centered on human lateral frontopolar 
cortex. PLoS Biol. 9, e1001093 (2011).
	33.	Park, S. A., Sestito, M., Boorman, E. D. & Dreher, J. C. Neural computations 
underlying strategic social decision-making in groups. Nat. Commun. 10, 
5287 (2019).
	34.	Kolling, N., Behrens, T. E. J., Mars, R. B. & Rushworth, M. F. S. Neural 
mechanisms of foraging. Science 336, 95–98 (2012).
	35.	Hunt, L. T. et al. Mechanisms underlying cortical activity during value-guided 
choice. Nat. Neurosci. 15, 470–476 (2012).
	36.	De Martino, B., Fleming, S. M., Garrett, N. & Dolan, R. J. Confidence in 
value-based choice. Nat. Neurosci. 16, 105–110 (2013).
	37.	Witter, M. P., Wouterlood, F. G., Naber, P. A. & Van Haeften, T. Anatomical 
organization of the parahippocampal–hippocampal network. Ann. N. Y. Acad. 
Sci. 911, 1–24 (2000).
	38.	Bakkour, A. et al. The hippocampus supports deliberation during value-based 
decisions. eLife 8, e46080 (2019).
	39.	Ferreira-Fernandes, E., Pinto-Correia, B., Quintino, C. & Remondes, M. A 
Gradient of hippocampal inputs to the medial mesocortex. Cell Rep. 29, 
3266–3279 (2019).
	40.	Jacobs, J. et al. Direct recordings of grid-like neuronal activity in human 
spatial navigation. Nat. Neurosci. 16, 1188–1190 (2013).
	41.	Eichenbaum, H. Prefrontal–hippocampal interactions in episodic memory. 
Nat. Rev. Neurosci. 18, 547–558 (2017).
	42.	Preston, A. R. & Eichenbaum, H. Interplay of hippocampus and prefrontal 
cortex in memory. Curr. Biol. 23, R764–R773 (2013).
	43.	Long, X. & Zhang, S.-J. A novel somatosensory spatial navigation system 
outside the hippocampal formation. Cell Res. 31, 649–663 (2021).
	44.	Piva, M. et al. The dorsomedial prefrontal cortex computes task-invariant 
relative subjective value for self and other. eLife 8, e44939 (2019).
	45.	Maidenbaum, S., Miller, J., Stein, J. M. & Jacobs, J. Grid-like hexadirectional 
modulation of human entorhinal theta oscillations. Proc. Natl Acad. Sci. USA 
115, 10798–10803 (2018).
	46.	Staudigl, T. et al. Hexadirectional modulation of high-frequency 
electrophysiological activity in the human anterior medial temporal lobe 
maps visual space. Curr. Biol. 28, 3325–3329 (2018).
	47.	Knudsen, E. B. & Wallis, J. D. Closed-loop theta stimulation in the 
orbitofrontal cortex prevents reward-based learning. Neuron 106, 537–547 
(2020).
	48.	Piazza, M., Izard, V., Pinel, P., Le Bihan, D. & Dehaene, S. Tuning curves for 
approximate numerosity in the human intraparietal sulcus. Neuron 44, 
547–555 (2004).
	49.	Frank, M. J., Rudy, J. W. & O’Reilly, R. C. Transitivity, flexibility, conjunctive 
representations, and the hippocampus. II. A computational analysis. 
Hippocampus 13, 341–354 (2003
	50.	von Fersen, L., Wynne, C. D. L., Delius, J. D. & Staddon, J. E. R. Transitive 
inference formation in pigeons. J. Exp. Psychol. Anim. Behav. Process. 17, 
334–341 (1991).
Publisher’s note Springer Nature remains neutral with regard to jurisdictional claims in 
published maps and institutional affiliations.
© The Author(s), under exclusive licence to Springer Nature America, Inc. 2021
Nature Neuroscience | VOL 24 | September 2021 | 1292–1301 | www.nature.com/natureneuroscience
1301

Articles
NaTurE NEurosCIEnCE
Methods
Participants. A total of 25 participants (13 females, age range: 18–25 years, normal 
or corrected-to-normal vision) were recruited for this study via the University of 
California, Davis (UCD) online recruitment system (see a priori test to determine 
the sample size below). Data collection and analysis were performed blinded. 
None of participants reported a history of neurological or psychiatric disorders. 
There was no potential self-selection bias, and we made every reasonable effort 
to minimize the potential for other biases in participant recruitment that could 
affect results. Using six motion parameters to assess motion in each participant, 
we excluded the data of four participants who had movement in the x, y and/or 
z directions greater than the voxel size (3 mm) relative to the middle timepoint 
across each scanning block and who had total displacement of more than 3 mm 
from the beginning to the end of the scanning session. The exclusion criteria were 
pre-established based on a previous study14. In total, the data of 21 participants 
were included in the analysis (ten females, mean age: 21.14 ± 0.52 years, ± s.e.). 
The study was approved by the UCD institutional review board (IRB) committee 
(IRB ID: 967139-3). All relevant ethical regulations were followed, and participants 
gave written consent before the experiment.
Participants received course credit as compensation for participating in day 
1 and day 2 training. Participants received monetary compensation for their 
participation from day 3 training onwards. In addition to the compensation, 
participants were told that extra monetary rewards will be earned if they pass the 
training (see the criteria below in behavioral training), and these extra rewards 
would be paid if they completed the fMRI task.
Sample size. One-tailed effects for hexadirectional signal in the EC were tested. 
The sample size was predetermined using the effect size estimates from the 
previous study using the same experimental paradigm23,51. We found a large effect 
(Cohen’s d = .7). A power analysis using G*Power v3.1 suggested a sample size of 
20 for .90 power. We scanned 25 participants, and the data of 21 participants were 
analyzed. All participants were scanned twice on different days.
Social hierarchies. During behavioral training, participants were asked to learn 
social hierarchies between 16 entrepreneurs presented as face stimuli, which were 
constructed in two independent ability dimensions: popularity and competence. 
Each dimension had four levels of rank. Four individuals were allocated at the 
same rank at each level. The rank of an individual in one dimension was not related 
to his/her rank in the other dimension, and each had a unique combination of 
popularity and competence ranks. This allowed us to create a 4 × 4 social hierarchy 
structure comprising two social hierarchy dimensions (Fig. 1b).
It is important to note that the true structure of social hierarchy (not only 
the 2D social hierarchy but also each 1D social hierarchy) was never shown to 
participants. Moreover, participants were never given any information implying 
the structure of the social hierarchies, including the total number of ranks in each 
dimension and the number of individuals allocated to the same rank.
Stimuli. The stimuli consisted of 16 grayscale photographic images of faces52. All 
of the images were adjusted to have the same mean grayscale value. To ensure that 
visual features of a face (including gender, race and age) were not associated with 
the rank of the entrepreneur, we prepared eight sets of 16 face stimuli selected 
from a pool of 42 faces. Each of the stimuli sets comprised 16 faces. A set of stimuli 
among eight was randomly assigned across participants. Stimuli were presented to 
participants through a mirror mounted on the head coil. The face stimuli presented 
in this paper are license-free images for display purposes.
Behavioral training. The 16 face stimuli were introduced as entrepreneurs. 
Each day of the behavioral training comprised ‘Learn’ phases and ‘Test’ phases. 
During a Learn phase of behavioral training, participants learned the relative rank 
between entrepreneurs (face stimuli) in one of the two independent dimensions 
through feedback-based binary comparisons. Specifically, participants were asked 
to learn which individuals were more capable of attracting crowdfunds (labeled 
popularity) and which individuals had higher technical proficiency (labeled 
competence). Participants only learned about individuals who differed by one 
rank level and on one dimension at a time. Participants learned the relative status 
of all possible one-rank difference pairs with feedback in random order. During 
the first 2 days of training, participants completed two learning-blocks. Each 
learning-block is followed by a test-block. During a learning-block, 48 possible 
pairs of individuals whose ranks have one-rank difference in the given dimension 
were presented twice (96 trials). During test-blocks, participants make inferences 
on the relative status of a pair of individuals who differed by one or more levels 
on one dimension while no feedback is given. During a test-block, all possible 
96 pairs were presented. The pairs presented for the learning- and test-blocks are 
depicted in Supplementary Fig. 1. It is important to note that the relative ranks in 
each dimension were learned on a separate day (for example, popularity on day 1 
and competence on day 2 or vice versa). The day 2 training occurred 2 d after day 
1 training. During day 2 training, participants learned the hierarchies on the other, 
different dimension (Fig. 1d and Supplementary Fig. 1). A computer randomly 
chose in which dimension a participant would learn the social hierarchy for the 
first day of training.
Participants were never shown the 1D or 2D structure of the social hierarchy, 
never asked to combine the two social hierarchy dimensions during training and 
never asked to solve the task spatially. However, participants could theoretically 
reconstruct the social hierarchy through transitive inferences, not only on two 
1D structures but also on a 2D structure by integrating the two dimensions 
learned on different days (as shown in the right panels in Supplementary Fig. 1). 
During training, participants were not informed about the fMRI task (partner 
selection task). Therefore, participants were not able to anticipate having to build a 
representation of the combined social hierarchy for future use for novel inferences. 
During behavioral training, each of the 16 face stimuli were exposed to participants 
the same number of times. See Park et al.51 for the details of behavioral training 
protocols and instruction and codes for stimuli presentation.
Training day 1. Participants learned the hierarchy of 16 individuals in either the 
competence or popularity dimension. On each trial during the Learn phase, 
two face stimuli of entrepreneurs were presented with a color cue (red or blue 
square) that indicated the task-relevant dimension. Participants were asked 
to choose the one who is superior to the other (the higher-rank individual) in 
the given dimension (Supplementary Fig. 1e). They received feedback at the 
end of every trial. Before the training, participants were informed that two 
entrepreneurs presented in a given trial during the Learn phase differed by only 
one rank on the given dimension (Supplementary Fig. 1a). The first learned 
hierarchy and the color associated with each dimension were counterbalanced 
across participants.
During the Test phase, which was followed by the Learn phase, participants’ 
knowledge about social hierarchy in the learned dimension was tested. On each 
trial during the Test phase, similarly to the Learn phase, participants chose one 
of two face stimuli who is superior to the other in the given social hierarchy. 
Participants did not receive any feedback for their choices during the Test phase. 
Before the training, participants were informed that two entrepreneurs presented 
in the Test phase would have one or more rank differences (dotted lines in 
Supplementary Fig. 1e). To make a correct decision, participants needed to use 
transitive inferences to infer the relative status of two individuals who were never 
compared during learning (Supplementary Fig. 1a).
Training day 2. Using the same method through which the participants learned 
the social hierarchy in one dimension during day 1 training, participants learned 
the hierarchy of the same 16 entrepreneurs in the other unlearned dimension 
(Supplementary Fig. 1e). For example, participants who learned about the 
hierarchy in the competence dimension on day 1 learned about the hierarchy in the 
popularity dimension on day 2 (Supplementary Fig. 1b).
At the end of day 2 training, participants were asked to perform an additional 
test, which we called the ‘Test 2’ phase. During the Test 2 phase, we tested 
participants’ ability to make flexible inferences while the task-relevant dimension 
was interleaved across trials. As with the previous Test phase, on each trial of the 
Test 2 phase, participants were asked to choose the superior face between two 
entrepreneurs who have one or more rank differences in the given dimension 
(Supplementary Fig. 1f), and no feedback was given for their decisions. However, 
in the Test 2 phase, the relevant dimension for decision-making was randomized 
across trials. Only the participants who were able to reach more than 80% accuracy 
in the Test 2 phase were invited to continue to the day 3 training (Supplementary 
Fig. 1b).
Day 3 and after training. Flexible inferences in intermixed behavioral contexts 
(Test 2). The day 3 training started with another Test 2 phase in which participants’ 
knowledge about social hierarchy was tested with the task-relevant dimension 
randomized across trials. As before, participants were asked to infer the relative 
rank between two individuals with one or more rank differences without feedback. 
From the day 3 training, on each trial of the Test 2 phase, stimuli were presented 
sequentially in the order of the conditional cue (red or blue square), indicating 
the task-relevant dimension, a face stimulus (F1) and another face stimulus 
(F2) (Supplementary Fig. 1d). A fixation cross was shown for the inter-stimulus 
intervals and inter-trial intervals. During F2 presentation (2 s), participants were 
asked to indicate the higher-rank individual between F1 and F2 in the given 
dimension. During the Test 2 phase, participants were presented all possible pairs 
of entrepreneurs (Supplementary Fig. 1f) twice by altering the position of F1 and 
F2 on interleaved dimensions, and they did not get feedback to their decisions. 
Only the participants who could make accurate inferences at 95% or more in both 
dimensions finished the training and were given the introduction about the partner 
selection task.
Conditional Learn phase. There were additional Learn phases for the participants 
whose accuracy was below 95% in one of two dimensions for the Test 2 phase on 
day 3 training. This additional Lean phase comprised the two Learn phases given 
on the day 1 and day 2 training. That is, participants were asked to choose the 
superior face between two entrepreneurs who differed by one rank on the given 
dimension while getting feedback to their decisions. Participants learned the 
hierarchy in one dimension at a time during each of two blocks in the Learn phase 
(Supplementary Fig. 1d).
Nature Neuroscience | www.nature.com/natureneuroscience

Articles
NaTurE NEurosCIEnCE
After the Learn phase, participants were asked to repeat the Test 2 phase 
of day 3 training. It could potentially take multiple days of training until the 
threshold was reached (>95% in both dimensions) (Supplementary Fig. 1d). 
This high performance threshold was selected because we reasoned that it would 
be necessary to accurately measure hypothesized grid angles for planned fMRI 
analyses.
Behavioral training of the ‘partner selection task’. Participants who successfully 
learned the social hierarchy in both dimensions independently subsequently 
learned the partner selection task for the first time. In each trial of the partner 
selection task, participants were asked to choose the better business partner for a 
given entrepreneur between two candidate partners while considering their relative 
hierarchy in both social hierarchy dimensions. Therefore, each decision during 
the fMRI task required novel inferences to be made by combining the two social 
hierarchy dimensions learned separately. See the ‘Partner selection task’ section  
for details.
The behavioral training of the partner selection task had two purposes. First, 
it was to ensure that participants understood the novel decision-making task to 
which they had never been exposed. Second, it was to ensure that participants did 
not use alternative heuristics for decision-making by providing test trials where the 
potential heuristics failed (see the ‘Partner selection task’ section for details). To do 
this, after the instructions were given, participants were asked to perform 24 trials 
of the partner selection task without time constraints. To prevent learning, we did 
not give any feedback to their decisions during the training of the partner selection 
task. They were only informed whether they made all correct selections or not at 
the end of a block, which comprised 24 trials. We generated three sets of 24 trials 
for the purpose of behavioral training. Those trials were not included in the fMRI 
experiments to make sure that participants made novel decisions for the fMRI 
experiment. That is, during fMRI, participants did not compare the same two pairs 
about which they had made decisions during behavioral training on the partner 
selection task. The pairs that were presented during the behavioral training on 
the partner selection task were paired with different pairs if they were also shown 
during fMRI. Therefore, the winning pair in a trial of behavioral training will often 
be a losing pair during fMRI or vice versa (Supplementary Fig. 2b). Therefore, 
remembering the winning pair from previous trials of the partner selection cannot 
be an effective solution for the task and could not produce the high performance 
level that we observed in our sample. Participants who failed to make all correct 
inferences in 24 trials were further asked to read again the instructions and to 
explain the instructions to the experimenter to ensure that they understood the 
task. Participants were asked to complete the same set of 24 trials in a randomized 
order until they made all correct decisions. After reaching 100% accuracy, 
participants were asked to complete the same set of 24 trials in a randomized order 
with time constraints (5 s), as in the fMRI experiment. To ensure that participants 
were not simply relying on remembered correct answers of the selected set and 
were able to generalize their knowledge to make novel inferences, we confirmed 
that all participants could also make correct decisions for a novel set of 24 trials of 
the partner selection task. Finally, using this procedure, we recruited participants 
who were able to reach an accuracy of 95% or more in both dimensions for more 
than two trial sets (48 trials total) to participate in the fMRI experiment.
Participant retention. In total, 107 participants were recruited and started the 
initial training. Fifteen participants participated only in the day 1 training. 
Of 92 participants who finished the day 2 training, 39 passed the threshold of 
behavioral accuracy (>80% in the Test 2 phase). The retention rate was 42.39%. 
Of these 39 participants, 29 agreed to continue training after day 3 training. The 
relatively high dropout rate, in part, reflects difficulties of retaining participants 
for effortful and time-intensive, multi-day studies; the variable performance was 
due, in part, to using course credit as incentives (many students had achieved 
full credits for their courses before the end of day 2 training, and ten participants 
who passed the threshold of behavioral accuracy decided not to continue the 
training), and true variability of task performance in our limited initial training 
timeframe. Twenty-seven of 29 participants reached more than 95% of behavioral 
accuracy during the Test 2 phase during day 3 and after training. The bar graph 
in Supplementary Fig. 1g shows the number of additional sessions that each of 
the 29 individuals participated in. Two of 29 participants stopped the training 
before reaching 95% accuracy, and two who reached more than 95% stopped 
the experiment before scanning (marked with * in Supplementary Fig. 1g). We 
included a high performance threshold because we needed to ensure accurate 
representations of cognitive maps, should they exist, to be able to measure the 
effects of grid-like coding reliably. We scanned 25 participants who agreed to 
participate in the fMRI part of the experiment.
Partner selection task (fMRI experiments). Participants were given the following 
instructions. The goal of the partner selection task was to find a better business 
partner for a given individual (F0) between two candidate partners (F1 and 
F2). F0, F1 and F2 were indicated as face stimuli that were selected from the 16 
entrepreneurs who had been presented to participants during behavioral training. 
To find a better business partner for F0, participants need to compute the GP of 
each potential collaboration. The GP indicates the level of benefits that F0 could 
expect from the potential collaboration with each of two partners, F1 and F2. 
Therefore, GP indicates the benefit that F0 could expect from a collaboration, and 
participants should make a decision based on which collaboration F0 could expect 
a better benefit as a group.
Participants were subsequently asked to choose between F1 and F2 according 
to the GP of each of two pairs—GP1: GP for F0–F1 pair; GP2: GP for F0–F2  
pair. While presenting F1 and F2, participants should consider the relative rank 
between F0 and F1 and the relative rank between F0 and F2 in both dimensions  
to select a partner who generates greater GP while compensating for any  
weakness of F0, which is analogous with the process that we undertake for 
selecting a better collaborator in real life. Notably, participants could not make a 
correct decision in every trial if they only compared the ranks between F1 and F2  
(Supplementary Fig. 2).
To estimate GP accurately, first, participants were asked to compute the ‘rank of 
the pair’ in each dimension, which was determined by the rank of the entrepreneur 
who had a higher rank (where the lowest rank was one). For example, if F0 was at 
a higher rank than F1 in the competence dimension, while F1 was at a higher rank 
than F0 in the popularity dimension, the rank of the F0–F1 pair would be the rank 
of F0 in the competence dimension and the rank of F1 in the popularity dimension. 
Second, participants were asked to weight the ‘rank of the pair’ in both dimensions 
equally to compute the GP. For example, when the ranks of F0 and F1 in the 
competence and popularity dimensions are CF0, PF0 and [CF1, PF1], respectively, 
the ‘rank of the pair’ would be max(CF0, CF1) in the competence dimension and 
max (PF0, PF1) in the popularity dimension. And the GP1 would be determined by 
multiplication of two ‘ranks of the pair’—that is, max(CF0, CF1) × max(PF0, PF1). 
Last, participants were asked to make a binary choice between F1 and F2 to find 
a better partner for F0 by selecting the pair whose GP was greater than the other 
pair: choose F1 if GP1 > GP2; choose F2 if GP2 > GP1. During the partner 
selection task, participants did not receive any feedback for their decisions. 
Participants were notified that they would receive extra rewards in proportion to 
their overall performance if their overall accuracy was more than 90% at the end of 
the experiments (after the second-day scan).
As Fig. 2a illustrates, in each trial of the partner selection task, participants 
were presented with two pairs of face stimuli sequentially in the order of F0, F1, 
F0 and F2. The stimuli F0 were presented for 2.5 s, and the stimuli F1 and F2 were 
presented for 5 s. In each trial, the inter-stimulus fixation was presented between 
F0 and F1 and between F0 and F2 for the same duration (a white cross, 2~5-s 
jittered). F0 was presented before each partner to anchor hypothesized direct 
vectors to the partner. The F1 stimuli were followed by a 3-s inter-stimuli fixation 
(a purple cross). Participants were asked to make a binary decision to indicate a 
better business partner for F0 between F1 and F2 during the F2 presentation by 
pressing a button. The inter-trial fixation was presented at the end of each trial 
(green cross, 1~4-s jittered). During the fMRI experiment, the color of the fixation 
cross on the middle of the screen informed participants the progress of the trial. 
No feedback was given to the participants. Trials that participants did not respond 
to within the allotted time were shown later after a random number of trials to 
ensure that all participants made responses to every trial.
Novel inferences for the partner selection task. During the partner selection 
task, participants were asked to make decisions that they had not made before. 
Although participants were trained extensively to learn the rank differences in each 
1D social hierarchy, participants still needed to make inferences of the decision 
value for novel decisions in the partner selection task. During behavioral training, 
participants only compared the ranks of two individuals in one social hierarchy 
dimension at a time. This is also true for the Test 2 blocks of the behavioral 
training in which the two dimensions were intermixed across trials. Importantly, 
there is no a priori reason that participants need to construct a combined 2D 
representation of the social hierarchy during behavioral training. Instead, 
participants could still reach a high accuracy level by constructing two separate 
1D representations for the competence and popularity dimensions that were 
learned with feedback on different days (Supplementary Fig. 1c) or by updating 
separate competence and popularity values under certain assumptions53. However, 
during fMRI, participants need to make inferences to compute a pair’s GP and 
make a novel comparison against another pair to make a correct decision in the 
partner selection task. Therefore, although the same pair of individuals might be 
presented as in training, participants need to compute different decision values for 
the partner selection task compared to the behavioral training task. If participants’ 
brains use two 1D representations, the brains should not encode the vector angles 
of inferred trajectories, which are defined on a 2D space, while making decisions in 
the partner selection task. Supplementary Fig. 2b,c shows a representative example 
in which the decision value for behavioral training of the same pairs cannot be 
generalized for the partner selection task.
Notably, here, we use the term ‘inference’ in a manner consistent with its 
usage in other studies on transitive inference53,54 and model-based inference 
using a pre-sensory conditioning procedure55–57. In those studies, participants 
are trained on predictive pairs (for example, A→B and B→C) but are frequently 
tested multiple times on inference trials without feedback during the critical test 
(for example, A→C). Importantly, unlike in some associative inference paradigms, 
simply presenting the pairs for a choice without feedback does not provide 
Nature Neuroscience | www.nature.com/natureneuroscience

Articles
NaTurE NEurosCIEnCE
any additional information concerning which face is of higher rank and, more 
importantly, which pair has a higher GP.
fMRI experimental procedure. Individuals participated in 2 days of scanning 
sessions more than 1 week apart (Fig. 1d). The average time gap between the two 
sessions was 8.95 ± 0.81 days (± s.e.) (in the range of 7–19 days). On each day of 
the fMRI experiment session, participants performed three blocks of the partner 
selection task. A block consisted of 48 trials. Participants, therefore, needed 
to compute the GP of 576 pairs in total (48 trials × 2 pairs per trial × 3 blocks 
× 2 days) to make accurate decisions for the partner selection task. The pairs 
presented during the first-day scan were re-presented for the second-day scan 
in reverse order. That is, the F0 and F1 pairs in the first-day scan were presented 
as the F0 and F2 pairs in the second-day scan and vice versa. This allowed us to 
test whether participants made correct decisions consistently, as well as whether 
their brain consistently represented the direction of inferred trajectories (θ) over 
the abstract 2D social hierarchy space across sessions acquired more than 1 week 
apart. Although we randomized the trial order in each block, we also changed the 
order of blocks between the first-day scan and the second-day scan. That is, the 
trials tested in blocks 1, 2 and 3 on the first-day scan were tested in blocks 5, 6 
and 4, respectively, on the second-day scan, which allowed us to generate unique 
comparisons for CV across blocks (see the fMRI analysis).
The frequency of the pairs presented for the partner selection task. Sixteen 
individuals can be paired with 15 other individuals except for oneself. Therefore, 
there are 240 pairs that can possibly be generated from 16 individuals (because 
the vector angles of the inferred trajectory are different, we treated the AB pair 
and the BA pair differently) (Supplementary Fig. 4a). Of 240 pairs, we carefully 
chose specific pairs for the partner selection task because we hypothesized that 
participants might be less likely to use grid-like codes to compute the GP for some 
pairs where they could rely on a heuristic instead. For example, participants do 
not need to compute the GP of two pairs if one of them includes an individual 
who has extreme ranks in both dimensions, such as faces 1 and 16 (Fig. 3h shows 
the position of these faces; (P,C) = (1,1) and (4,4), respectively, where 4 is the 
highest rank). In addition, if F0 is at the highest rank in one of two dimensions, 
participants only need to compare the rank of F1 and F2 in one dimension where 
F0’s rank was relatively lower. Considering the above, we sampled faces 1 and 16 
less frequently and were more likely to choose F0 from faces whose rank was not 
the highest in either dimension of the social hierarchy. Supplementary Fig. 4d 
shows the 99 unique pairs presented for the partner selection task for the first time 
in the fMRI experiment and the frequency of the presentation of each of those 
pairs during the partner selection task. Supplementary Fig. 4e shows the frequency 
of the inferred trajectories for the fMRI experiment categorized into 12 equal bins 
of 30° according to their direction (θ), which indicates that the 2D social hierarchy 
space was well sampled.
Post-scanning debriefing. After all the scans finished (on the second-day scan), 
we asked participants to describe the mental images that they had used to represent 
the interrelated 16 face stimuli and their decision strategy used to perform the 
partner selection task. All participants mentioned that, when they see a face 
stimulus, they did not recall the rank in one dimension at a time but they were 
able to recall the ranks in both dimensions simultaneously. Of 21 participants 
whose data were analyzed, only two participants reported the 4 × 4 social hierarchy 
structure in a 2D space that they used to represent the relationship. Other 
participants did not report being aware that this task can be solved spatially using 
an explicit 2D representation of the social hierarchy.
Post-scanning placement task. After participants reported their strategy, we asked 
them to perform a placement task. We asked participants to drag-and-drop each 
of the 16 faces of entrepreneurs to place on a 2D space defined by the two social 
hierarchy dimensions according to their ranks. Note that all other behavior and 
imaging data were collected before this placement task. Importantly, participants 
were never explicitly asked to think about the relationship between individuals 
spatially before this placement task. Although most of the participants reported 
during post-scanning debriefing that they did not use a spatial representation to 
perform the task, all participants were successfully able to place the faces according 
to their social hierarchy ranks and reconstruct the social hierarchies in a 4 × 4 grid.
For visualization purposes, we rescaled the map of the faces placed by each 
participant by normalizing the longest pairwise distance between faces on the x 
coordinate and that on the y coordinate to one (Fig. 3i). Note that, after rescaling, 
the location of faces can appear more precise at the boundary compared to the 
faces in the middle of the map. However, we confirmed that all participants 
reported an equidistant interval between any pair of neighboring entrepreneurs 
who differed by one rank in either the competence or popularity dimension.
Behavioral analyses. We examined whether participants made a model-based 
decision using the learned structure of the social hierarchy instead of a model-free 
decision using heuristics as an alternative decision strategy. Specifically, we 
examined whether the decision of participants was better explained by the 
difference between the GPs of two pairs (GP1–GP2), which requires participants to 
assemble the ranks of individuals in both dimensions compared to the difference 
in ranks or values that participants assigned to each individual, which does not 
require the internal representation of the social hierarchy to guide a decision.
As the first alternative way to make decision, we tested whether participants 
used an overall rank assigned to each individual in a combined dimension rather 
than ranks of each of two dimensions and chose the one who had higher overall 
rank between F1 and F2. That is, this model predicted that participants choose 
F1 if [PF1 × CF1] > [PF2 × CF2] and, otherwise, F2. This model differs from the 
GP-based decision in that the decision does not consider the rank of F0. As the 
second alternative model, we tested whether participants only use the ranks of F1 
and F2 in one of two dimensions in which the rank of F0 was relatively deficient. 
For example, the decision of participants might depend only on the ranks of F1 
and F2 in the popularity dimension when F0 was at a lower rank in the popularity 
dimension than their rank in the competence dimension. Formally, this model 
predicts that participants choose F1 if CF1 > CF2 given that PF0 > CF0 or if 
PF1 > PF2 given that CF0 > PF0; otherwise, they choose F2. If participants use this 
heuristic, therefore, they could have made sequential value comparisons rather 
than using the inferred trajectories.
To test these alternative hypotheses, we included trials in which participants 
would fail to choose the correct partner if they adopted one of the alternatives. 
If a participant used the first heuristic, they would fail to be correct in 35 trials 
(24.3% of total trials). If a participant used the second heuristic, they would fail 
to be correct in 109 trials (75.7% of total trials). This allowed us to assess whether 
participants used the ranks of individuals in both dimensions to compute the 
expected GP rather than using their ranks in only one dimension (Supplementary 
Fig. 2d).
Next, we analyzed the RTs of partner selection decisions. Notably, the accuracy 
of participant decisions was at ceiling, and there was limited variability across trails 
or between participants (mean accuracy was 98.68% ± 0.27%; Supplementary Fig. 
2d), precluding analysis of variables explaining accuracy. We performed a multiple 
linear regression to explain the RT of decisions instead. The RT was measured from 
the F2 onset to the response. The following 12 regressors were inputted into the 
multiple linear regression: the Euclidean distance between F0–F1 and F0–F2 pairs; 
the absolute difference between them (EF0F1, EF0F2 and ΔE = |EF0F1 −EF0F2|); 
the GP of F0–F1 and F0–F2 pairs and their absolute difference (GPF0F1, GPF0F2 
and ΔGP = |GPF0F1 −GPF0F2|); the cosine angles of the trajectories (cos ζF0F1, 
cos ζF0F2 and cos ζF1F2); whether the F0–F1 and F0–F2 vectors were aligned to the 
EC grid orientation (OnF0F1 and OnF0F2, where it was 1 for the on-grid pairs and 0 
for the off-grid pairs); and the transient entropy ( ˆH). In this analysis, we compute 
the regressors of the angle (cos ζ) to be maximized when the inferred trajectory is 
aligned to the diagonal, because ranks in both dimensions are equally important 
in the partner selection task (ζ=θ – π/4). Therefore, cos(θ – π/4) was inputted 
into the regressors. It makes, for example, cos θF0F1 = 1 when rank differences 
between F0 and F1 are equal in both dimensions. Note that cos ζ is independent 
of the hexadirectional grid-like term (cos[6(θ −ϕ)]) (Supplementary Fig. 3a,b). 
ˆH indicates the uncertainty caused by sequential presentations in the partner 
selection task. ˆH is defined only transiently in the period where the F2 is unknown 
after the F0 and F1 presentations, and ˆH is resolved (no uncertainty) with the F2 
presentation. The low ˆH (less uncertainty) theoretically could help participants 
prepare their decisions against all possible F2s (Supplementary Fig. 3c).
RT ∼c + β1EF0F1 + β2EF0F2 + β3ΔE
+β4GPF0F1 + β5GPF0F2 + β6ΔGP
+β7 cos ζF0F1 + β8 cos ζF0F2 + β9 cos ζF1F2
+β10OnF0F1 + β11OnF0F2 + β12 ˆH
Owing to the moderate correlation between the distances of trajectories (E) 
and the decision values (GP) (r = 0.47; Supplementary Fig. 3a), we also performed 
the multiple linear regression while including EF0F1 and EF0F2 after partialling 
out their covariance with GPF0F1; and GPF0F2. Group-level effects of each of the 
distance measures were tested with a one-sample t-test to treat participants as a 
random variable.
MRI data acquisition. We acquired T2-weighted functional images on a Siemens 
Skyra 3T scanner. We used gradient echo planar imaging (EPI) pulse sequence with 
a slice angle of 30° relative to the anterior–posterior commissure line, minimizing 
the signal loss in the OFC region58. We acquired 46 slices, 3 mm thick, with the 
following parameters: repetition time (TR) = 1,300 ms, echo time (TE) = 24 
ms, flip angle = 67°, field of view (FoV) = 192 mm, voxel size = 3 × 3 × 3 mm3. 
Contiguous slices were acquired in interleaved order. To correct for deformations, 
we also acquired a field map with dual echo time images covering the whole 
brain, with the following parameters: TR = 630 ms, TE1 = 10 ms, TE2 = 12.46 
ms, flip angle = 40°, FoV = 192 mm, voxel size = 3 × 3 × 3 mm3. We acquired a 
T1-weighted structural image using a magnetization-prepared rapid gradient echo 
sequence with the following parameters: TR = 1,810 ms, TE = 2.98 ms, flip angle = 
7°, FoV = 256 mm, voxel size = 1 × 1 × 1 mm3.
Pre-processing. The pre-processing of functional imaging data was performed 
using Statistical Parametric Mapping (SPM) v12 (Wellcome Centre for Human 
Nature Neuroscience | www.nature.com/natureneuroscience

Articles
NaTurE NEurosCIEnCE
Neuroimaging). Images were corrected for slice timing, realigned to the first 
volume and realigned to correct for motion using a six-parameter rigid body 
transformation. Inhomogeneities created using the phase of non-EPI gradient echo 
images at two echo times were co-registered with structural maps. Images were 
then spatially normalized by warping subject-specific images to the reference brain 
in the Montreal Neurological Institute (MNI) coordinate space (2-mm isotropic 
voxels). For the univariate analysis, images were smoothed using an 8-mm 
full-width at half maximum (FWHM) Gaussian kernel59.
fMRI RSA. We performed a multivariate analysis using RSA60 to test whether the 
a priori ROIs in the brain reflected the structure of the social hierarchy (Fig. 3a). 
The ROIs were defined anatomically in the bilateral HC61 and bilateral EC62,63 (Fig. 
3b). We also included additional ROIs in the bilateral primary motor cortex (M1)64 
as control regions. Note that ROIs were defined independently from the current 
task.
By using RSA, we tested whether the brain integrates piecemeal learned relative 
status between entrepreneurs into a social hierarchy and, more importantly, 
whether the brain combines two social hierarchy dimensions, which were learned 
on different days, into a single 2D representation. To address this question, we 
examined whether the level of pattern dissimilarity between the neural activity 
evoked by each entrepreneur was explained by a function of pairwise Euclidean 
distances between entrepreneurs on the 2D social space. This analysis allowed us 
to test whether the brain had increasingly similar patterns of neural activity for 
entrepreneurs who were increasingly close to each other in the true 2D  
social space.
To test our hypotheses, we first estimated β coefficients when each of the 
individual faces was shown at the time of F0, F1 or F2 using a GLM with a 2-s 
boxcar function in each of our anatomically defined a priori ROIs. We then 
averaged the unsmoothed β maps when the same face among 14 faces was 
presented across F0, F1 and F2 presentations, allowing us to estimate the patterns 
of neural activity in each ROI. We excluded two faces (1 and 16) that were sampled 
less frequently for the RSA analysis in order to match observations per face (see 
the pairs for the ‘Partner selection task’ section in the Methods). The reliability 
of the data was improved by applying multivariate noise normalization65. Second, 
we quantified the representational similarity between the neural activity patterns 
elicited by face stimuli across three independent fMRI blocks acquired on the 
same day using the Mahalanobis distance. This pairwise dissimilarity further 
constructed a 14 × 14 representational dissimilarity matrix (RDM). These analysis 
steps were repeated per ROI. The separately estimated RDMs for each of the two 
day scans were averaged across days. Third, we constructed a model RDM that 
contained the pairwise Euclidean distances between entrepreneurs on the 2D social 
hierarchy space (Fig. 3a). Last, we compared the neural RDMs estimated in each of 
the ROIs to our model RDMs using a rank correlation using Kendall’s τA
66. Because 
we excluded two faces that had extreme ranks in both dimensions, the pattern 
dissimilarity associated with the pairs in which the Euclidean distance between 
them was 
√18 and was determined only by one pair (faces 4 and 12; (P,C) = (1,4) 
and (4,1), respectively). We, therefore, excluded the pattern dissimilarity estimated 
between them to ensure that the effects of Euclidean distance could not possibly be 
driven by the patterns to particular faces. Therefore, we examined to what extent 
the dissimilarity between activity patterns is explained by the Euclidean distance 
in the range of 1 to 
√13. Statistical significance was calculated by constructing 
a null distribution by shuffling our data 1,000 times at the participant level. 
Each participant’s τA was compared to the mean of this permutation distribution 
and submitted to a one-sample Wilcoxon signed-rank test (one-tailed) across 
participants (we use non-parametric statistics because normality cannot be 
guaranteed in rank-based measures). We reported the results with the FWE  
to correct multiple comparisons by the number of ROIs using the Holm–
Bonferroni method67.
To test more rigorously the effect of Euclidean distance, which can be 
factorized into a 1D distance of rank differences in the competence dimension 
and another 1D distance of rank differences in the popularity dimension, we 
estimated the neural representation of the relationship between entrepreneurs in 
each of the two dimensions separately. We estimated the rank correlation (Kendall’s 
τA) between the neural RDM, which included neural activity patterns estimated 
from the same ROIs, and the model RDMs, which included the rank differences 
between entrepreneurs in each dimension. We further compared those rank 
correlations (τA) that represent to what extent an ROI contained the representation 
of 16 entrepreneurs’ relationship in one of two social hierarchy dimensions, to 
test whether the neural representation of the relative ranks among entrepreneurs 
in one dimension was not different from that of the other dimension with the 
non-parametric, two-tailed Wilcoxon signed-rank test (we use non-parametric 
statistics because normality cannot be guaranteed in rank-based measures).
First, we performed RSA of 14 faces in the social hierarchy, while matching 
the number of samples per face, to test the effects of Euclidean distances on the 
neural activity patterns. To do that, we downsampled by randomly choosing 12 
trial responses associated with each of 14 faces acquired in each day. Although 
downsampling allows us to circumvent the potential concerns of unequal 
sampling, it does suffer from an overall small sample size. To complement this 
result, second, we performed the same RSA of 14 faces while including all trials’ 
neural responses. Third, we performed a control RSA in which the neural activity 
acquired only at the time of F0 presentation was included. Because some faces 
were selected less frequently as F0 during partner selection (see the pairs for the 
‘Partner selection task’ section in the Methods), we include only eight individuals 
(Supplementary Fig. 4d) for the control RSA. Although this control analysis allows 
us to examine activity patterns while the brain activity was minimally modulated 
by other task-relevant cognitive processes, notably, the measurements of pattern 
similarity for F1 and F2 are likewise valid. Showing that the mean signals are 
hexadirectionally modulated with respect to F0 when presenting F1 and F2 does 
not imply that the pattern of the activity across voxels cannot also reflect the 
relative position in the social hierarchy. For these reasons, we include all three 
events (F0, F1 and F2) in the RSA analysis and present the new analysis of F0 as an 
additional result (Supplementary Fig. 5c).
Searchlight-based RSA. In addition to the ROI-based RSA, we performed 
whole-brain searchlight RSA to examine brain areas in which the dissimilarity 
between neural activity patterns associated with each of 14 faces is explained 
by the pairwise Euclidean distance between faces in the 2D social hierarchy. 
We estimated the neural activity patterns elicited while each of the 14 faces was 
presented at the time of F0, F1 or F2 from each of the searchlights. Consistent with 
the ROI-based RSA, first, we performed the searchlight-based RSA while matching 
the number of samples of each face presentation. To complement the results of RSA 
based on the downsampled responses, second, we also performed the RSA while 
including neural responses elicited from every trial. The dissimilarity matrices 
were quantified with the Euclidean distance between neural activity patterns 
estimated from different sessions acquired in the same day and averaged across 
days. Using the pairwise Euclidean distances as a predictor (Fig. 3a), we estimate 
the neural representational dissimilarity across searchlights with Kendall’s τA 
rank correlation. At the participant level, the effects of the Euclidean distances 
were further compared to a null distribution, which was estimated from 1,000 
permutations, while the positions of 14 faces were allocated randomly in the 2D 
space. Specifically, each participant’s τA was compared to the mean of the permuted 
distribution and then was mapped back on the central voxel of each searchlight, 
which created a continuous map of the levels of representation of 2D social 
hierarchy in the whole brain per participant. This map was further smoothed 
using an 8-mm FWHM Gaussian kernel and Fisher’s z-transformed. We further 
performed one-sample t-tests for group-level analysis. We reported the results 
corrected for multiple comparisons across the whole brain using TFCE68 with 1,000 
iterations of simulation (PTFCE < 0.05). In addition, because we hypothesized that 
cognitive map representations would be found in HC and EC based on previous 
studies4,11,19,23, we report results in the HC and EC corrected in the anatomically 
defined ROI61–63, which is independent of the current study (PTFCE < 0.05).
MDS. To visualize the representation of the social hierarchy structure built 
in HC and EC, we performed MDS analyses using the ‘midscale’ function in 
MATLAB. The MDS allowed us to find the best way to arrange 14 individuals 
spatially in a 2D space so that the distances between individuals in a 2D space 
reflect their similarities between neural activity patterns. The distances between 
two individuals in the social hierarchy were measured by Mahalanobis distances 
between the neural activity extracted from the same HC and EC ROIs acquired 
in the same session. The dissimilarity matrix of each participant was averaged 
across sessions, averaged across hemispheres in the HC and EC ROI separately and 
averaged across participants. We used the first two eigenvalues to reconstruct the 
representation in a 2D space.
With MDS, the locations of less-sampled entities are more likely biased by 
noise compared to those of the entities sampled with higher frequency. Therefore, 
as can be seen below, the measures for faces 1 and 16, in particular, are expected to 
be less reliable than others. We deliberately sampled less frequently these faces to 
mitigate against participants relying on heuristics during inferences, because face  
1 always lost on both dimensions, and face 16 always won on both dimensions. We, 
therefore, included 14 individuals from among 16 for the MDS analysis, excluding 
two faces that had extreme ranks in both dimensions. Moreover, we performed 
an MDS based on the activity patterns of the HC and EC while matching the 
number of sample responses associated with each of 14 individuals. Importantly, 
we apply MDS only for visualization of the group’s social hierarchy representation 
in the HC and EC, not for population inferences, where we, instead, rely on rank 
correlations of RSA. To complement the MDS based on equivalent sampling, which 
suffers from an overall smaller sample size, we also performed the additional MDS 
while including all responses associated with 14 individuals. We only report the 
Spearman correlation coefficients, along with the above caveat about sampling 
frequencies. The numbers of presentations of each of 16 faces are shown in 
Supplementary Table 9.
Last, we tested to what extent the pairwise Euclidean distance and pairwise 
cosine angle among 14 individuals in the MDS graph correlated with the true 
pairwise distance in the 4 × 4 social hierarchy structure. Unlike an individual MDS 
that can be acquired from the activity patterns of each participant, the MDS at the 
group level cannot be estimated by averaging multiple MDSs, owing to differences 
in the scale and the orientation across individual MDSs. Thus, we can only reliably 
acquire one MDS from the mean pattern dissimilarity of the group. To formally 
Nature Neuroscience | www.nature.com/natureneuroscience

Articles
NaTurE NEurosCIEnCE
test to what extent the group MDS accounts for the true social hierarchy structure, 
we compared the level of correlation (Spearman’s ρ) among the pairwise distances 
between all possible pairs of 14 faces in the MDS and the pairwise distances 
estimated from the true social hierarchy and compared it to the distribution of the 
correlation coefficients that we computed from 1,000 permutations while randomly 
locating those 14 faces in the 2D hierarchy. In addition to the pairwise Euclidean 
distances, we also estimated how well the MDS captures the pairwise cosine 
angles of all possible pairs of the true social hierarchy. Using the same method, we 
further compared the correlation coefficients between pairwise cosine angles to the 
null distribution of the correlation coefficients (1,000 random permutations). In 
addition to Spearman’s ρ, we report P values based on the permutation.
fMRI whole-brain analyses. In previous findings of rodent electrophysiology7,24,69, 
grid cells in the EC showed greater activity for navigating in the direction aligned 
with the mean grid orientation (ϕ) across grid cells compared to them for 
navigating in the direction misaligned with ϕ, which generated a specific pattern 
of six-fold symmetry (Fig. 1c). Recent studies have shown that a hexagonally 
symmetric grid-like code can be measured in the BOLD signal with fMRI in 
humans14,18,24,25,70. We leveraged these established fMRI markers to test whether 
a grid-like code is used for inferred trajectories between entities in an abstract 
cognitive map to guide decision-making. Specifically, we searched for neural 
evidence for hexadirectional modulation of inferred decision trajectories through 
the reconstructed cognitive map of a 2D social hierarchy that we hypothesized 
were used to compute the GP to guide decisions in the partner selection task—the 
−−→
F0F1 vector at the time of F1 presentation and the −−→
F0F2 vector at the time of F2 
presentation (Fig. 2).
To address this, we implemented a series of GLMs to analyze fMRI data. 
First, we performed a whole-brain analysis to identify brain areas in which 
activity showed hexagonal symmetrical patterns according to the direction of 
the inferred trajectories (θ) (GLM1). Importantly, GLM1 was performed without 
any assumption of the participant-specific mean grid orientation (ϕ). Based on 
the results of GLM1, we define ROIs in the brain in an unbiased way for GLM2. 
Second, in GLM2, we tested the effects of hexadirectional modulations according 
to θ aligned with ϕ using a leave-one-out CV procedure. Specifically, in GLM2, we 
estimated the putative grid orientation (ϕ) from one dataset (either two of three 
runs for within-day analyses or 1 of 2 days for between-day analyses) using an ROI 
defined independently based on GLM1 and applied the estimated ϕ to the other 
remaining dataset to test for the hexadirectional grid-like representation across the 
whole brain. Third, with GLM3, we identified brain areas encoding the variables 
guiding the partner selection decision, including both the GP and |GP1 – GP2|, 
which are independent of both θ and ϕ. In addition, with GLM3, we further 
examined the relationship between neural encodings of the decision variables 
(GP) and individual differences in the effects of hexadirectional modulation of the 
inferred trajectories while controlling the overall accuracy of decision-making. 
Last, with GLM4, we tested for complementary evidence of greater GP effects 
for the aligned compared to misaligned trajectories, consistent with a role of 
hexadirectional modulations in EC for guiding map-based decision-making.
Defining an ROI in an unbiased manner (GLM1). With GLM1, we identified brain 
areas where activity showed hexagonally symmetric patterns according to the 
direction of the inferred trajectories (θ) but did not depend on the grid orientation 
(ϕ). The purpose of GLM1 was to functionally define ROIs in a way that was 
unbiased from the putative grid orientation (ϕ) for future tests (see GLM2). GLM1 
contained separate onset regressors for the onsets of F0 and the partner stimuli 
presentations (combining F1 and F2 presentations). The BOLD responses of 
those regressors were modeled with the 2.5-s boxcar function. The regressors of 
F1 and F2 presentations were modulated with two parametric regressors, which 
include the sine and cosine of the direction of inferred trajectory (θ) with a six-fold 
periodicity—that is, sin(6θ) and cos(6θ). These regressors produced parameter 
estimates, βsin and βcos, with amplitude (
√
β2
sin + β2
cos) for brain regions that are 
sensitive to hexagonal symmetry. When a partner face stimulus (Fx) followed F0, 
the direction of inferred trajectory θF0Fx was defined as follows:
θF0F1 = arctan
( CFx −CF0
PFx −PF0
)
where CFx and PFx indicate the level of competence and popularity dimensions of 
the individual and Fx, respectively. We included the onset of button presses with 
a stick function as additional regressors of no interest to account for the potential 
motor-related effects. The six motion parameters obtained during realignment 
were also entered into GLM1 as regressors of no interest. The orthogonalize 
function was turned off. All these regressors were convolved with the canonical 
hemodynamic response function (HRF). Using an F-test, we identified the brain 
areas in which BOLD signals were significantly modulated by a weighted sum of 
two regressors, β sin × sin(6θ) + β cos × cos(6θ). This method we adopted here 
was established in a previous study14. All these regressors in these GLMs were 
convolved with the canonical HRF. Individual whole-brain contrast maps were 
z-scored and inputted to a one-sample t-test to test for group-level effects using the 
z-statistic based on an asymptotic approximation71.
Considering that the F-statistics could be overestimated if the variance of the 
first-level statistic was underestimated, we used only GLM1 to create ROIs in an 
unbiased manner but not for statistical inference. We defined ROIs for future 
tests in the EC (peak MNI coordinates at (x, y, z) = (26, −2, −36), z = 2.62) and 
mPFC (peak MNI coordinates at (x, y, z) = (2, 66, −4), z = 5.58) (Extended Data 
Fig. 3b). We defined the ROIs in the EC and mPFC based on the previous finding 
showing grid cells in these areas during virtual navigation in humans using 
pre-surgical single-unit recordings40 and previous grid-like fMRI effects in these 
regions14,24. Based on the F-test results, we defined ROIs in the EC and mPFC 
within their anatomical masks defined in EC62,63 and mPFC72, while including the 
voxels showing the effects of six-fold symmetry at the threshold z > 2.3, which 
corresponds to P = 0.01.
Testing hexadirectional modulation aligned to the grid orientation (GLM2). We 
performed the GLM2 to identify brain areas whose activity was modulated by the 
direction of inferred trajectories (θ) with six-fold symmetry aligned with the grid 
orientation (ϕ). To disentangle the effects of grid orientation (ϕ) from the direction 
of inferred trajectories (θ), we used a CV procedure. This allowed us to identify 
hexadirectional modulations with consistent grid orientation (ϕ) across sessions.
The CV was performed as follows. We estimated ϕ from a separate dataset of 
each participant (called estimate set) and applied the participant-specific parameter 
ϕ to the other dataset (called test set) to test the effects of θ. For instance, the effect of 
θ in block 1 was tested while applying ϕ estimated from blocks 2 and 3 acquired on 
the same-day scan. Likewise, the ϕ for block 2 was estimated from blocks 1 and 3,  
and the ϕ for block 3 was estimated from blocks 1 and 2 (Extended Data Fig. 3c).  
The CV was possible because, whereas the direction of inferred trajectories 
θ was consistent for the same trajectory across participants but varied across 
trajectories, the grid orientation ϕ was relatively consistent within a participant but 
varies across participants (Extended Data Fig. 3c and Supplementary Fig. 6). We 
estimated the mean grid orientation ϕ in the functionally defined ROIs in the EC, 
defined based on GLM1 (Extended Data Fig. 3b), by adopting the same method 
proposed in previous studies14,24,25. Specifically, we estimated ϕ in each voxel of the 
ROIs using the β coefficients for the sine and cosine regressors (βsin and βcos) in 
GLM1 as follows:
ϕ =
arctan
( βsin
βcos
)
6
The mean grid orientation (ϕ) across each voxel in each of the ROIs was 
estimated using the circular mean73, which was divided by 6 to compute ϕ in a 
range between −π
6 and π
6, thus taking the six-fold periodicity into account. We 
expected that the estimated grid orientations are not randomly distributed across 
voxels but show a non-uniformity of circular distances across voxels. We tested, 
using Rayleigh’s tests, if there was a non-uniform clustering of putative grid 
orientations estimated from different sessions across voxels in each participant.
In GLM2, we modeled the BOLD signals of onsets of the partner stimuli 
(combining F1 and F2 presentations) with a 2.5-s boxcar function. These events 
were modulated by a parametric regressor, cos (6 [θ −ϕ]), where θ is the 
hypothesized direction of inferred trajectories between individuals in each pair, 
and ϕ is the mean grid orientation estimated from the separate estimate dataset. 
Additionally, the onsets of F0 and button presses were modeled as separate 
regressors with a stick function. The six motion regressors were also entered as 
regressors of no interest. The orthogonalize function was turned off. All regressors 
in these GLMs were convolved with the canonical HRF. Last, the group-level effects 
were tested with a one-sample t-test.
In addition to the grid orientation consistency across sessions acquired on the 
same day, we further tested for the grid orientation consistency across sessions 
acquired on different days. Again, to test the effect of hexadirectional modulation 
in a statistically unbiased manner, we used a CV procedure. Specifically, the effect 
of the hexadirectional modulation was tested on the fMRI sessions acquired in 
one of two day scans while applying the grid orientation, ϕ, estimated in the EC 
activity from a session acquired in the other day scan (Extended Data Fig. 3c). 
This additional analysis allowed us to test whether the brain activity had the 
hexadirectional modulations in one day consistently showed the same effects to 
indicate the inferred trajectories in a different day. That is, we tested for a stable 
representation of the learned social hierarchy in the brain more than 1 week later.
Identifying neural encoding of decision-related variables (GLM3). To make accurate 
decisions in each trial of the partner selection task, participants were required to 
compute GP1 for the F1 presentation and GP2 for the F2 presentation. Specifically, 
the GP of each pair corresponds to the size of the rectangle that is drawn by the 
rank positions of two entrepreneurs in the abstract 2D social hierarchy space (as 
Fig. 2b shows). Subsequently, the decision should be guided by the difference 
between the two GPs. To capture this value comparison term, we use the absolute 
difference in GPs ((ΔGP = |GPF0F1 −GPF0F2|)).
We performed the GLM3 to examine the neural encodings of decision variables 
(GP and ΔGP) that guide the partner selection decision. We modeled the BOLD 
signals of onsets of the partner stimuli (combining F1 and F2 presentations) with 
a 2.5-s boxcar function, which were subsequently modulated by a parametric 
regressor, GP. We also modeled the BOLD signals at the time of decision-making 
Nature Neuroscience | www.nature.com/natureneuroscience

Articles
NaTurE NEurosCIEnCE
with a stick function, which was modulated by a parametric regressor, ΔGP. 
Additionally, the onset of F0 and the six motion regressors were also modeled with 
separate regressors in the same way of the GLM1. The orthogonalize function was 
turned off. All regressors in these GLMs were convolved with the canonical HRF.
The GP was dependent on the relative ranks of two entrepreneurs in both 
dimensions but independent from the directions of the inferred trajectories 
(Supplementary Fig. 9a; mean r ± s.e. = 0.04 ± 0.03). To rigorously test whether 
these two regressors explained independent variance in neural activity, as a control 
analysis, we performed an additional GLM in which the BOLD signals at F1 and 
F2 presentations were modulated by two parametric regressors, cos(6[θ −ϕ]) and 
GP, in the same model. The effects of each of those two regressors were further 
compared with the effects of cos(6[θ −ϕ]) in GLM2 and the GP effects in GLM3 
to examine whether the effects of two regressors remained while controlling for the 
effect of the other regressor.
Interaction effects between alignments to the grid orientation and GP 
computations (GLM4). In GLM 4, we tested the hypothesis that the GP effects 
depend on the alignments of the inferred trajectories to the EC grid orientation 
(ϕ) by comparing the GP effects between aligned trajectories and misaligned 
trajectories. Note that there was not a significant difference between GP 
regressor values for aligned and misaligned trajectories (Supplementary Fig. 
9b,c). In GLM4, we modeled the BOLD signals at the onset of the partner 
stimuli (combining both F1 and F2 presentations) separately for the trajectories 
aligned with the grid orientation (ϕ) from those misaligned trajectories with a 
2.5-s boxcar function. Both regressors were parametrically modulated by the 
GP of the pairs. Consistently, we applied the same putative grid orientation, 
ϕ, estimated in the EC ROI using a CV across sessions acquired on the same 
day, as before. Additionally, the onsets of F0 presentation and button presses 
were modeled with separate regressors with a stick function. The six motion 
parameters obtained during realignment were entered into the model as 
regressors of no interest. The orthogonalize function was turned off. All these 
regressors were convolved with the canonical HRF. We performed a contrast 
analysis between the GP effects in the aligned trajectories and those in the 
misaligned trajectories. The individual contrast maps were entered into a 
one-sample t-test to test group-level effects.
Group-level inference. For all analyses using a GLM (GLM1, GLM2, GLM3 
and GLM4), group-level effects were tested with a one-sample t-test. First, 
we performed group-level inference on a priori task-independent EC62,63 
and HC61 ROIs that were defined anatomically. Second, we performed 
exploratory whole-brain analyses. To correct for multiple comparisons, we used 
permutation-based TFCE68. The medial EC has been well known to contain 
grid cells and is thought to be their primary source7. A signature of these grid 
cells in EC has been found in recent human fMRI studies, and, thus, a central 
hypothesis of our study was that EC would show grid-like coding. Specifically, 
these recent studies show EC grid-like coding both for spatially navigating 
virtual environments24 and also for tracking the abstract task state defined by the 
continuously morphing neck and leg lengths of a bird stimulus14. The EC activity 
in these studies was modulated by the direction of the vector defined on a 2D 
space with hexagonal patterns. The EC is, therefore, the primary ROI to test our 
main hypothesis in the current study (note that all vectors are aligned to the EC 
grid orientation). In addition, the anatomical geometry of the EC is not ideal for 
cluster-based inference, such as TFCE. For those reasons, we used the anatomically 
defined ROI-based TFCE correction for statistical inference of the grid effect in the 
EC (PTFCE < 0.05 corrected in the ROI). We report activations (Figs. 3, 4 and 5)  
that are cluster-corrected at the threshold PTFCE < 0.05 over the whole brain for 
all brain regions, except for the EC, where we used a threshold of PTFCE < 0.05 
corrected within anatomically defined ROI due to our strong a priori hypothesis of 
grid coding in EC.
We use non-parametric statistics by default when normality cannot be 
guaranteed, specifically for all rank-based correlations (RSA analyses; Wilcoxon 
signed-rank test) (Fig. 3c), statistical inference on univariate fMRI effects (TFCE68) 
(Figs. 3f,g, 4a and 5a,d,f) and a post hoc analysis with small sample sizes (Kruskal–
Wallis test) (Supplementary Fig. 11). We use parametric one-sample t-tests on all 
tests of grid periodicity, with activity z-normalized, obviating the potential for 
normality violation (Figs. 4b,c and 5b). For our behavioral RT linear regression 
analysis, we both test for normality and equal variance (Shapiro–Wilk test) and 
include individual data points for resulting regression coefficients (Supplementary 
Fig. 3d).
ROI analyses. Specificity for six-fold symmetry in ROIs. We conducted the ROI 
analyses to test the hexadirectional patterns in alignment with the EC grid 
orientation (ϕ) within unbiased ROIs. Moreover, we visualized the sinusoidal 
modulations (Fig. 1c) in the activity in these ROIs as a function of the direction 
of inferred trajectories (θ) with six-fold periodicity. In addition, we performed 
control analyses to test whether the periodic effects in the ROIs were specific to 
six-fold periodicity but not to other control periodicities (four-, five-, seven- and 
eight-fold).
First, we tested the hexadirectional modulations on a priori ROIs in the 
EC and mPFC, which we defined based on the GLM1 (Extended Data Fig. 3b) 
independently from the grid orientation (ϕ). We tested this effect also on the 
anatomically defined EC and on mPFC ROIs as well (refs. 62,63 for EC; ref. 72 for 
mPFC) (Supplementary Fig. 7a) to confirm that the effects did not depend on 
how we defined the ROIs. Second, because we used faces as stimuli in our task, 
we tested the hexadirectional modulations in the ROIs defined in the FFAs. Note 
that the FFA was specifically engaged with the current task in response to the 
face stimuli. To define FFA ROIs independently from ϕ, we included the brain 
area activated in response to the face stimuli compared to fixations. The inclusive 
mask was defined at the threshold t20 > 3.6, which corresponds to P < 0.001, 
uncorrected (peak MNI coordinate (x, y, z) = (16, −34, −6), t = 10.94 for right 
FFA and (x, y, z) = (−18, −30, −10), t = 9.81 for left FFA; Supplementary Fig. 7b). 
Third, we defined ROIs in the brain areas where activity quantitatively encoded the 
GP, which included the bilateral TPJ and mPFC based on the GLM3 (Fig. 5a and 
Supplementary Table 7a). The inclusive mask was defined at the threshold t20 > 3.6, 
which corresponds to P < 0.001, uncorrected. With the TPJ and mPFC ROIs, we 
tested whether the neural encodings of GP (β GP) were modulated by the direction 
of the inferred trajectories (θ) with the six-fold periodicity aligned to the EC grid 
orientation (ϕ). Note that the functional definitions of the above ROIs were all 
independent from the subsequent statistical tests performed for inference.
To estimate the trajectory-by-trajectory neural activity, we modeled the  
BOLD signals at the time of onsets of every presentation of F1 and F2 stimuli  
as separate regressors with a 2.5-s boxcar function. These event regressors were 
also modulated by a parametric regressor for the GP. The onsets of button presses 
were modeled with a separate regressor with a stick function. The six motion 
parameters were added as regressors of no interest. All regressors were convolved 
with the HRF.
First, we extracted the BOLD signals activated at the time of every presentation 
of a partner stimulus (including both F1 and F2) in the EC, mPFC and FFA ROIs. 
Second, we extracted the series of β signals encoding GP at the time of every 
partner stimulus presentation in the bilateral TPJ and mPFC ROIs. The series of 
the extracted BOLD signals and β GP were separately z-scored per ROI within each 
block. Based on the participant-specific EC grid orientation (ϕ) estimated with the 
CV across sessions acquired within 1 d, we categorized the z-scores into 12 equal 
bins of 30° according to the direction of the inferred trajectory (θ). The z-scores of 
each participant were then averaged within each of 12 bins ± s.e. This procedure 
produced six mean activity of the aligned trajectories and six mean activity of the 
misaligned trajectories per ROI.
In each of the ROIs, we performed two-tailed, one-sample t-tests to test the 
effects of hexadirectional modulations that were measured as differences in 
z-scores (the aligned – misaligned trajectories’ bins). In addition, to test for the 
specificity of the six-fold periodicity, we performed additional control analyses. 
Specifically, we performed paired t-tests to compare the differences in z-scores 
computed using the model of the six-fold periodicity (effects of hexadirectional 
modulations) to the differences in z-scores computed using the other model 
assuming the different level of periodicity, including four-, five-, seven- and 
eight-fold (effects of modulations in other alternative periodicities). Last, we 
performed leave-one-bin-out (LOBO) analyses, which allowed us to confirm 
that the effect of hexadirectional modulations in β GP was not driven by the 
activity of any specific bin. Specifically, with the LOBO analysis, we performed 
two-tailed t-tests to examine whether the effects of hexadirectional modulations 
(difference in mean z-scores between the aligned and misaligned trajectories) 
were still greater than zero when the effects were computed from only 11 bins 
while excluding each of 12 bins (Supplementary Fig. 9f and Supplementary 
Table 8b).
Testing hexadirectional modulation for novel pairs. As mentioned in behavioral 
training, participants experienced two or three training sets of the partner 
selection task without feedback before the fMRI session. Although the trials 
presented during behavioral training were not presented again in the fMRI, 
some pairs (F0 and F1 or F2) that had been presented during behavioral training 
(always in the absence of feedback) were presented again with other pairs 
during fMRI. The number of these overlapping pairs differs across participants, 
depending on the number of training sets they experienced. Of 99 unique pairs, 
we found 11 pairs that were presented during both fMRI and behavioral training 
for 17 participants and 16 pairs that were presented during fMRI and behavioral 
training for four participants. Because no feedback was given to participants 
during behavioral training and fMRI, we reasoned that no learning process was 
involved during training on the partner selection task. However, it is possible 
that participants memorize the value of GP of some pairs when they were 
presented during behavioral training and recall the GP when the same pair was 
shown again in fMRI, even though they needed to compare it with a new pair to 
make a novel decision. If participants use their memorized decision values, it is 
also possible that participants might retrieve the GP computed in the previous 
trial to guide their decision in the current trial during fMRI. To test whether the 
grid-like code plays a role when making inferences about entirely novel pairs, 
we performed an additional ROI analysis in which we tested for a grid-like 
code only for the pairs that are presented for the first time during fMRI. In this 
control analysis, we include only the z-score transformed β extracted from the 
EC and mPFC ROI from the 88 (83) remaining pairs that were shown for the 
first time to each participant during the first day of scanning (day 1 scan). We 
Nature Neuroscience | www.nature.com/natureneuroscience

Articles
NaTurE NEurosCIEnCE
also tested the effects of hexadirectional modulations on β GP in the TPJ and 
mPFC ROIs aligned to the EC grid orientation (ϕ) only for those 88 (83) pairs 
when they were presented for the first time. Extended Data Fig. 4 shows the 88 
(83) pairs that we used for this analysis.
Between-subject relationship between hexadirectional modulations in EC and the 
GP effects. To test for a relationship between hexadirectional modulation and GP 
effects, we addressed the following question: Do those participants who had a 
greater hexadirectional modulation in EC and mPFC also show greater neural 
encoding of GP? The underlying rationale for this hypothesis is as follows. If the 
grid-like codes in the EC and mPFC are important for accurate representations 
of inferred trajectories, they might further serve for accurate computations of 
the decision values in decision-making guided by a cognitive map. To test this 
hypothesis, we defined the participant-specific ‘gridness’ score as to what extent 
the EC and mPFC signals were modulated by the direction of inferred trajectories 
in six-fold periodicity. Therefore, the gridness score equals to the β cos(6(θ – ϕ)) 
in EC and in mPFC, and then we tested whether individual differences in neural 
GP effects were explained by gridness scores. Specifically, using GLM3, we entered 
individual contrast maps of GP into a one-sample t-test to test the group-level 
effects and also entered the EC and mPFC gridness scores as (demeaned) 
covariates for the second-level regression analysis across participants. In addition 
to the gridness score, we also include the overall accuracy normalized in a range 
of 0 to 1 as an additional covariate to control for the choice accuracy. To test the 
between-subject effect in the brain areas engaged in the tasks requiring perspective 
taking, we tested this effect within the anatomically defined independent ROIs, 
including bilateral TPJ74 and mPFC72 (Fig. 5c).
The GP effects modulated by the inferred trajectories aligned to the EC grid 
orientation. We examined the effects of grid alignments in EC for making 
inferences of direct trajectories among individuals in the abstract social space on 
the activity in the brain areas encoding GP. We defined the ROIs in the mPFC 
and bilateral TPJ in which their activity correlates with GP while presenting F1 
or F2 stimuli (GLM3) within the inclusive mask defined at the threshold t20 > 
3.6, which corresponds to P < 0.001, uncorrected (Fig. 5a and Supplementary 
Table 7a). In the ROIs, we extracted the β GP of the aligned trajectories and 
the β GP of misaligned trajectories, which indicated to what extent the BOLD 
signals encoded the GP when the inferred trajectories were aligned and that for 
the trajectories misaligned to the EC grid orientation (ϕ). Note that the GP was 
independently defined from the direction of inferred trajectories (θ) regardless 
of the EC grid orientation (ϕ) (Supplementary Fig. 9a-c; mean r ± s.e. = 0.04 ± 
0.03). The GP, therefore, was also independent whether the inferred trajectory 
was aligned or misaligned, which obviates the concerns of the ROI selection 
biases. For each ROI, we performed a one-sample t-test to confirm that the 
activity encoded GP (β GP > 0) but also a paired t-test to test whether the β GP 
was greater for the trajectories aligned to the EC grid orientation compared to 
the β GP of misaligned trajectories (Fig. 5e).
Reporting Summary. Further information on research design is available in the 
Nature Research Reporting Summary linked to this article.
Data availability
The data that support the findings of this study are available on the Open 
Science Framework (https://doi.org/10.17605/osf.io/w96yk)75. Unthresholded 
group-level statistical maps are available on NeuroVault (identifiers.org/neurovault.
collection:9352)76.
Code availability
The code that supports the findings of this study is available on the Open Science 
Framework (https://doi.org/10.17605/osf.io/w96yk). The associated behavioral 
training protocols51 and code are available on the Open Science Framework (https://
doi.org/10.17605/osf.io/bnc3w)77. The behavioral data during the fMRI experiment 
were collected in Presentation v21.0 (Neurobehavioral Systems). The task for 
behavioral training was programmed in PsychoPy v3.0 (ref. 78). Data analysis 
was performed in MATLAB v.2018a (MathWorks). We used SPM (v12) (ref. 79) 
(Wellcome Centre for Human Neuroimaging), MarsBaR toolbox v0.44 (ref. 80),  
Circular Statistics Toolbox v31i10 (ref. 73) and RSA toolbox (v3)81 for analyzing 
neuroimaging data.
References
	51.	Park, S. A., Miller, D. S. & Boorman, E. D. Protocol for building a cognitive 
map of structural knowledge in humans by integrating abstract relationships 
from separate experiences. STAR Protoc. 2, 100423 (2021).
	52.	Strohminger, N. et al. The MR2: a multi-racial, mega-resolution database of 
facial stimuli. Behav. Res. Methods 48, 1197–1204 (2016).
	53.	Kumaran, D., Banino, A., Blundell, C., Hassabis, D. & Dayan, P. 
Computations underlying social hierarchy learning: distinct neural 
mechanisms for updating and representing self-relevant information. Neuron 
92, 1135–1147 (2016).
	54.	Kumaran, D., Melo, H. L. & Duzel, E. The emergence and representation of 
knowledge about social and nonsocial hierarchies. Neuron 76, 653–666 
(2012).
	55.	Jones, B. & Mishkin, M. Limbic lesions and the problem of 
stimulus-reinforcement associations. Exp. Neurol. 36, 362–377 (1972).
	56.	Barron, H. C. et al. Neuronal computation underlying inferential reasoning in 
humans and mice. Cell 183, 228–243 (2020).
	57.	Wang, F., Schoenbaum, G. & Kahnt, T. Interactions between human 
orbitofrontal cortex and hippocampus support model-based inference.  
PLoS Biol. 18, e3000578 (2020).
	58.	Weiskopf, N., Hutton, C., Josephs, O. & Deichmann, R. Optimal EPI 
parameters for reduction of susceptibility-induced BOLD sensitivity  
losses: a whole-brain analysis at 3 T and 1.5 T. Neuroimage 33,  
493–504 (2006).
	59.	Mikl, M. et al. Effects of spatial smoothing on fMRI group inferences.  
Magn. Reson. Imaging 26, 490–503 (2008).
	60.	Kriegeskorte, N. Representational similarity analysis—connecting  
the branches of systems neuroscience. Front. Syst. Neurosci. 2,  
4 (2008).
	61.	Yushkevich, P. A. et al. Quantitative comparison of 21 protocols for labeling 
hippocampal subfields and parahippocampal subregions in in vivo MRI: 
towards a harmonized segmentation protocol. Neuroimage 111, 526–541 
(2015).
	62.	Amunts, K. et al. Cytoarchitectonic mapping of the human amygdala, 
hippocampal region and entorhinal cortex: intersubject variability and 
probability maps. Anat. Embryol. (Berl.) 210, 343–352 (2005).
	63.	Zilles, K. & Amunts, K. Centenary of Brodmann’s map conception and fate. 
Nat. Rev. Neurosci. 11, 139–145 (2010).
	64.	Glasser, M. F. et al. The Human Connectome Project’s neuroimaging 
approach. Nat. Neurosci. 19, 1175–1187 (2016).
	65.	Walther, A. et al. Reliability of dissimilarity measures for multi-voxel pattern 
analysis. Neuroimage 137, 188–200 (2016).
	66.	Kendall, M. G. A new measure of rank correlation. Biometrika 30, 81 (1938).
	67.	Holm, S. A simple sequentially rejective multiple test procedure. Scand. J. 
Stat. 6, 65–70 (1979).
	68.	Smith, S. M. & Nichols, T. E. Threshold-free cluster enhancement: addressing 
problems of smoothing, threshold dependence and localisation in cluster 
inference. Neuroimage 44, 83–98 (2009).
	69.	Fyhn, M., Molden, S., Witter, M. P., Moser, E. I. & Moser, M. B. Spatial 
representation in the entorhinal cortex. Science 305, 1258–1264 (2004).
	70.	Julian, J. B., Keinath, A. T., Frazzetta, G. & Epstein, R. A. Human entorhinal 
cortex represents visual space using a boundary-anchored grid. Nat. Neurosci. 
21, 191–194 (2018).
	71.	Jenkinson, M. & Woolrich, M. Asymptotic T to Z and F to Z statistic 
transformations. FMRIB Technical Report TR00MJ1. https://www.fmrib.ox.
ac.uk/datasets/techrep/tr00mj1/tr00mj1/ (2004).
	72.	Neubert, F.-X., Mars, R. B., Sallet, J. & Rushworth, M. F. S. Connectivity 
reveals relationship of brain areas for reward-guided learning and decision 
making in human and monkey frontal cortex. Proc. Natl Acad. Sci. USA 112, 
1–10 (2015).
	73.	Berens, P. CircStat: a MATLAB toolbox for circular statistics. J. Stat. Softw. 
http://www.jstatsoft.org/v31/i10/ (2009).
	74.	Mars, R. B. et al. Connectivity-based subdivisions of the human right 
‘temporoparietal junction area’: evidence for different areas participating in 
different cortical networks. Cereb. Cortex 22, 1894–1903 (2012).
	75.	Park, S. A., Miller, D. S. & Boorman, E. D. Inferences on a multidimensional 
social hierarchy use a grid-like code. Open Science Framework https://osf.io/
w96yk/ (2020).
	76.	Park, S., Miller, D. & Boorman, E. Inferences on a multidimensional social 
hierarchy use a grid-like code. NeuroVault https://neurovault.org/
collections/9352/ (2020).
	77.	Park, S. A. & Miller, D. S. Behavioral training schedule for learning social 
hierarchy. Open Science Framework https://osf.io/bnc3w/ (2020).
	78.	Peirce, J. et al. PsychoPy2: experiments in behavior made easy. Behav. Res. 
Methods 51, 195–203 (2019).
	79.	Penny, W., Friston, K., Ashburner, J., Kiebel, S. & Nichols, T. Statistical 
Parametric Mapping: The Analysis of Functional Brain Images (Academic 
Press, 2007).
	80.	Brett, M., Anton, J.-L., Valabregue, R. & Poline, J.-B. Region of interest 
analysis using the MarsBar toolbox for SPM 99. Neuroimage 16, S497 (2002).
	81.	Nili, H. et al. A toolbox for representational similarity analysis. PLoS Comput. 
Biol. 10, e1003553 (2014).
Acknowledgements
We thank K. Yang, J. Barajas and X. He for behavioral training assistance. We thank D. 
Fox, R. Chaudhuri, T. Muller and M. Garvert for helpful comments on earlier drafts and 
discussions of the paper. This work was supported by a National Science Foundation 
CAREER Award (1846578), NIMH (1R01MH123713-01A1) and the University of 
California, Davis.
Nature Neuroscience | www.nature.com/natureneuroscience

Articles
NaTurE NEurosCIEnCE
Author contributions
S.A.P. and E.D.B. conceived the project and designed the experiments. S.A.P. and D.S.M. 
trained participants and collected data. With supervision from E.D.B., S.A.P. and D.S.M. 
analyzed data. S.A.P. and E.D.B. wrote the paper.
Competing interests
The authors declare no competing interests.
Additional information
Extended data is available for this paper at https://doi.org/10.1038/s41593-021-00916-3.
Supplementary information The online version contains supplementary material 
available at https://doi.org/10.1038/s41593-021-00916-3.
Correspondence and requests for materials should be addressed to S.A.P. or E.D.B.
Peer review information Nature Neuroscience thanks Nicolas Schuck and the other, 
anonymous, reviewer(s) for their contribution to the peer review of this work.
Reprints and permissions information is available at www.nature.com/reprints.
Nature Neuroscience | www.nature.com/natureneuroscience

Articles
NaTurE NEurosCIEnCE
Extended Data Fig. 1 | Multidimensional scaling (MDS). Visualization of the group representation of the social hierarchy in a 2-D space using MDS on 
the neural activity extracted from the HC and EC ROIs. There were considerably fewer presentations of individuals at the rank positions 1 and 16, making 
their estimates less reliable, and so these less frequently sampled individuals were excluded in computing the MDS. The 2-D representations (top) can 
be factorized into two 1-D hierarchies: competence (middle) and popularity (bottom). The lines indicate the individuals at the same rank in the social 
hierarchy. The thicker the line, the higher the rank in the given dimension. a. The MDS computed from the mean pattern dissimilarity across participants 
after matching the number of samples per face. Numbers indicate face position as shown in the true hierarchy in the Model on the left. Blue colors 
correspond to competence the dimension and red to the popularity dimension. The distances and angles between the estimated individual locations in  
the HC and EC MDS are significantly correlated with the pairwise Euclidean distances (Spearman’s ρ = 0.84 for HC and ρ = 0.63 for EC) and cosine angles 
(ρ = 0.93 for HC and ρ = 0.71 for EC) in the true 4×4 social hierarchy structure, compared to random configurations (both p<0.01 compared to 1000 
random permutations). b. The MDS estimated from the mean neural activity patterns including every presentation of the 14 face stimuli. Associated with 
Fig. 3g and Extended Data Fig. 2.
Nature Neuroscience | www.nature.com/natureneuroscience

Articles
NaTurE NEurosCIEnCE
Extended Data Fig. 2 | Representational similarity analysis (RSA) including all events of face stimuli presentation. a. RSA including neural responses to 
all the events associated with 14 individuals in the social hierarchy. Consistent with the results of the RSA based on down-sampling shown in Fig. 3c, we 
found effects of Euclidean distance on the pattern dissimilarity in the HC and EC but not in M1. The HC-EC system utilizes a 2-D relational cognitive map 
to represent the social hierarchy rather than representing 1-D map (τA of Euclidean distance (gray) > τA of one-dimensional rank distance in competence 
dimension (blue) and in popularity dimension (red)). **, pFWE<0.001 after correction for the number of bilateral ROIs (n=4) with the Bonferroni-Holm 
method; n.s., p>0.05, uncorrected. b. The dissimilarity between activity patterns estimated in bilateral HC and EC increases in proportion to the true 
pairwise Euclidean distance between individuals in the 2-D abstract social space (left, gray). The dissimilarity between activity patterns increases not only 
with the 1-D rank distance in the competence dimension (middle, blue) but also the 1-D rank distance in the popularity dimension (right, red). Methods 
and notation are identical to Fig. 3. Box, lower and upper quartiles; line, median; whiskers, range of the data excluding outliers; +, the whiskers’ range of 
outliers.
Nature Neuroscience | www.nature.com/natureneuroscience

Articles
NaTurE NEurosCIEnCE
Extended Data Fig. 3 | The analysis procedure to examine the effects of grid-like codes. a. Identifying brain regions sensitive to hexagonal symmetry 
across the whole brain without aligning to the entorhinal grid orientation, ϕ. To identify hexagonally symmetric signals, we adopted previously developed 
methods from a previous study14. We used a Z-transformed F-statistic to examine the BOLD activity modulated by any linear combination of sin(6θ) and 
cos(6θ). Hexagonal modulation was found in brain regions including in medial prefrontal cortex (mPFC; peak MNI coordinate, [x,y,z]=[2,66,-4], z=5.58), 
posterior cingulate cortex/precuneus (PCC; [2,-50, 36], z=3.19), bilateral posterior parietal cortex (PPC; [36,-46, 62], z=4.27 for right; [-38,-50, 50], 
z=3.81 for left), left lateral orbitofrontal cortex (OFC; [-42,44,-8], z=3.79), and retrosplenial cortex (RSC; [x,y,z] = [2,–54,28], z = 3.45) at a threshold 
pTFCE<0.05 (whole brain TFCE correction), as well as the right entorhinal cortex (EC; [26, -10, -40], z=2.80) at a threshold, pTFCE<0.05 (corrected within 
a priori anatomically defined EC region of interest (ROI)62,63). For visualization purposes, the maps are thresholded at z>2.6 (p<0.005 uncorrected). 
b. We did not use the results of F-test for statistical inference but to functionally define ROIs in EC and mPFC for future tests. The ROIs were defined 
within the anatomically defined masks in the EC62,63 and mPFC72 by including effects at a threshold of z>2.3, which corresponded to p<0.01. Using these 
independently defined ROIs, we then tested if the grid orientation estimated in the ROI was consistent across separate fMRI sessions in an unbiased way. 
It is important to note that the ROIs were defined from results of a statistically independent analysis, which was not dependent on the grid orientation.  
c. Illustrations of the cross-validation (CV) procedure. By splitting a dataset for estimating the grid orientation, ϕ, from another dataset to test for 
hexagonal modulation for inferred trajectories, θ, we could test for brain regions where activity was modulated by cos(6[θ-ϕ]) in alignment with the grid 
orientation estimated from the independent dataset for each participant. The CV was possible because the grid orientation, ϕ, is thought to be relatively 
stable but different across participants, whereas the direction of inferred trajectories θ varies only according to the position of F0, F1, and F2 (left panel). 
We performed a CV procedure both from fMRI sessions acquired within the same day (middle panel), and also from fMRI sessions acquired more than 
a week apart (right panel). d. We estimated the angle of the F1F2 vector (χ) and inputted the cos(6[χ-ϕ]) at the time of F2 presentation as an additional 
parametric regressor into GLM2. We did not find any brain areas encoding the angles of F1F2 vectors, except at a reduced threshold, in the bilateral 
somatosensory cortex ([x,y,z] = [-52,-14, 56], t=3.33 and [58,-8,50], t=3.17, p<0.005 uncorrected). e. Consistency of grid orientation in EC across 
sessions acquired more than a week apart. Concretely, in alignment with the EC grid orientation estimated from sessions acquired on a different day, we 
found hexadirectional modulation in a network of brain regions, including the mPFC ([-2, 36, -8], t=5.04), PCC ([6,- 58, 30], t=3.68), and TPJ ([-36, -64, 
22], t=4.06) at our whole brain corrected threshold pTFCE<0.05, as well as in EC ([36, -10, -38], t=4,21) at pTFCE<0.05, small-volume-corrected in our 
a priori EC ROI (Supplementary Table 5b).
Nature Neuroscience | www.nature.com/natureneuroscience

Articles
NaTurE NEurosCIEnCE
Extended Data Fig. 4 | Hexagonal modulation for inferred trajectories only for the novel pairs when presented for the first-time. a. Among all the 88 
(83) pairs (F0-F1 and F0-F2) presented during the partner selection task, those pairs that were not presented during behavioral training (always in the 
absence of feedback) but presented during fMRI for the first time are shown: 83 pairs in white were presented for the first-time for 4 participants; 88 pairs 
in white and gray were shown for the first-time for 17 participants. The grid effects were tested only for those pairs presented for the first time during the 
day1 scan. We extracted the mean activity and GP effects for each bin, restricted to when each pair was presented for the first time to participants. b and 
c. Associated with Fig. 4b and c. The mean EC (left panel) and mPFC (middle panel) activity in 30° bins aligned to the EC grid orientation estimated from 
different blocks acquired in the same day’s scan (b) and the EC grid orientation acquired from a different day’s (day 2) scan (c) with six-fold symmetry. 
Right panel shows formal comparison of trajectories aligned and misaligned with both methods of computing the EC grid orientation. We found greater 
activity for the aligned pairs compared to the misaligned pairs to the EC grid orientation in EC and mPFC ROIs (one-sample t-test). d. Associated with Fig. 
5b. The GP effects in mPFC and bilateral TPJ are modulated by the grid alignment of the inferred trajectories aligned with the EC grid orientation. The GP 
effects are greater for the aligned pairs compared to misaligned pairs, even when they were presented for the first time (one-sample t-test). Box, lower and 
upper quartiles; line, median; whiskers, range of the data excluding outliers; +, the whisker’s range of outliers. **, p<0.01; *, p<0.05.
Nature Neuroscience | www.nature.com/natureneuroscience

Articles
NaTurE NEurosCIEnCE
Extended Data Fig. 5 | Individual differences in the relationship between the gridness and the effects of growth potential. a. In addition to the 
relationship between EC gridness (β cos(6[θ −ϕ])) and GP effects (βGP) in bilateral TPJ that we present in Fig. 5c (upper left), we found a marginal 
positive correlation between the mPFC gridness and GP effects in mPFC and right TPJ (p<0.1) (upper middle). The gridness estimated in TPJ, however, 
does not correlate with their GP effects nor with the mPFC GP effect (p>0.1) (bottom left and middle). **, p<0.01; +, p<0.01. To further examine the 
relationship between the EC and mPFC gridness, we formally test which one better explains the GP effects in TPJ and mPFC. To address this question, we 
inputted the z-scored gridness of EC and mPFC into the same GLM to predict the GP effects in TPJ and mPFC. We found that the GP effect in bilateral TPJ 
was better explained by the EC gridness than the mPFC gridness (regression coefficient βEC=0.24** > βmPFC=0.17* for right TPJ; βEC=0.16* > βmPFC=0.13 for 
left TPJ; **, p<0.01 and *, p<0.05), and the GP effect in mPFC was better explained by the mPFC gridness than the EC gridness (βmPFC=0.09 (p=0.066) 
> βEC=0.01). Right: Colormap in matrix depicts regression coefficients for each regions’ gridness effect used to explain each regions’ GP effect. b. Left: 
Positive correlation between effects of differences in GP (|GP1-GP2|) in vmPFC during partner selection decisions and the EC gridness (r=0.43, p=0.05) 
but not mPFC gridness (r=-0.22, p=0.33). Right: Colormap shows regression coefficients for rEC and vmPFC gridness effects used to predict the vmPFC 
value difference effect. **, p<0.01; *, p<0.05; +, p<0.1. Box, lower and upper quartiles; line, median; whiskers, range of the data excluding outliers; +, the 
whiskers’ range of outliers.
Nature Neuroscience | www.nature.com/natureneuroscience

1
nature research  |  reporting summary
April 2020
Corresponding author(s):
Seongmin A. Park and Erie D. Boorman
Last updated by author(s): Jun 21, 2021
Reporting Summary
Nature Research wishes to improve the reproducibility of the work that we publish. This form provides structure for consistency and transparency 
in reporting. For further information on Nature Research policies, see our Editorial Policies and the Editorial Policy Checklist.
Statistics
For all statistical analyses, confirm that the following items are present in the figure legend, table legend, main text, or Methods section.
n/a Confirmed
The exact sample size (n) for each experimental group/condition, given as a discrete number and unit of measurement
A statement on whether measurements were taken from distinct samples or whether the same sample was measured repeatedly
The statistical test(s) used AND whether they are one- or two-sided 
Only common tests should be described solely by name; describe more complex techniques in the Methods section.
A description of all covariates tested
A description of any assumptions or corrections, such as tests of normality and adjustment for multiple comparisons
A full description of the statistical parameters including central tendency (e.g. means) or other basic estimates (e.g. regression coefficient) 
AND variation (e.g. standard deviation) or associated estimates of uncertainty (e.g. confidence intervals)
For null hypothesis testing, the test statistic (e.g. F, t, r) with confidence intervals, effect sizes, degrees of freedom and P value noted 
Give P values as exact values whenever suitable.
For Bayesian analysis, information on the choice of priors and Markov chain Monte Carlo settings
For hierarchical and complex designs, identification of the appropriate level for tests and full reporting of outcomes
Estimates of effect sizes (e.g. Cohen's d, Pearson's r), indicating how they were calculated
Our web collection on statistics for biologists contains articles on many of the points above.
Software and code
Policy information about availability of computer code
Data collection
The behavioral data during fMRI experiment were collected in Presentation v21.0 (Neurobehavioral Systems, Inc.).
Data analysis
The code that supports the findings of this study are available on the Open Science Framework, doi.org/10.17605/osf.io/w96yk. The 
associated behavioral training protocols (Park et al., 2021) and code are available in the Open Science Framework, doi.org/10.17605/osf.io/
bnc3w. The behavioral data during fMRI experiment were collected in Presentation v21.0 (Neurobehavioral Systems). The task for behavioral 
training was programmed in PsychoPy v3.0 (Peirce et al., 2019). Data analysis was performed in MATLAB v.2018a (Mathworks). We used 
Statistical Parametric Mapping (SPM v.12) (Penny et al., 2007, Wellcome Trust Centre for Neuroimaging), Marsbar toolbox v.0.44 (Brett et al., 
2002), Circular Statistics Toolbox v.31i10 (Berens, 2009), and representational similarity analysis toolbox (RSA toolbox v.3, Nili et al., 2014) for 
analyzing neuroimaging data.
For manuscripts utilizing custom algorithms or software that are central to the research but not yet described in published literature, software must be made available to editors and 
reviewers. We strongly encourage code deposition in a community repository (e.g. GitHub). See the Nature Research guidelines for submitting code & software for further information.
Data
Policy information about availability of data
All manuscripts must include a data availability statement. This statement should provide the following information, where applicable: 
- Accession codes, unique identifiers, or web links for publicly available datasets 
- A list of figures that have associated raw data 
- A description of any restrictions on data availability
The data that support the findings of this study are available on the Open Science Framework, doi.org/10.17605/osf.io/w96yk. Unthresholded group-level statistical 
maps are available on NeuroVault, identifiers.org/neurovault.collection:9352.

2
nature research  |  reporting summary
April 2020
Field-specific reporting
Please select the one below that is the best fit for your research. If you are not sure, read the appropriate sections before making your selection.
Life sciences
Behavioural & social sciences
 Ecological, evolutionary & environmental sciences
For a reference copy of the document with all sections, see nature.com/documents/nr-reporting-summary-flat.pdf
Life sciences study design
All studies must disclose on these points even when the disclosure is negative.
Sample size
One-sided effects for hexadirectional signal in the entorhinal cortex (EC) was tested. The sample size was predetermined using the effect size 
estimates from the previous study using the same experimental paradigm (Park et al., 2020). We found a large effect (Cohen's d = .7). A power 
analysis using G*power v3.1 suggested a sample size of 20 for .90 power. We scanned 25 participants and data of 21 participants were 
analyzed. All participants were scanned twice in different days.
Data exclusions
All data exclusions are reported in the manuscript. Using six motion parameters estimated by SPM 12 to assess motion in each participant, we 
excluded the data of 4 participants who had movement in the x, y, and/or z directions greater than the voxel size (3 mm) relative to the 
middle time point across each scanning block and who had total displacement of greater than 3 mm from the beginning to the end of the 
scanning session. The exclusion criteria were pre-established based on Constantinescu et al., 2016.
Replication
Data of all participants were acquired twice in different day at least more than a week apart. We have tested the effects of hexadirectional 
modulations not only based on the within day cross-validation (across blocks acquired in a same day) but also the cross-validation across 
different days scans. We confirmed that the effects were replicated when applying a cross-validation even across data acquired in different 
days.
Randomization
Participants were randomly assigned to one of stimuli sets which included different face stimuli. All trials were presented to participants in a 
randomized order.
Blinding
During fMRI, participants were not grouped. No blinding procedure was required. During behavioral training, a computer randomly chose in 
which dimension a participant would learn the social hierarchy for the first day of training.
Reporting for specific materials, systems and methods
We require information from authors about some types of materials, experimental systems and methods used in many studies. Here, indicate whether each material, 
system or method listed is relevant to your study. If you are not sure if a list item applies to your research, read the appropriate section before selecting a response. 
Materials & experimental systems
n/a Involved in the study
Antibodies
Eukaryotic cell lines
Palaeontology and archaeology
Animals and other organisms
Human research participants
Clinical data
Dual use research of concern
Methods
n/a Involved in the study
ChIP-seq
Flow cytometry
MRI-based neuroimaging
Human research participants
Policy information about studies involving human research participants
Population characteristics
Healthy young adults (n=21) including 10 female. Mean age ± standard error mean (SE) : 21.14±0.52.
Recruitment
Data collection and analysis were performed blind. Participants were recruited via the University of California, Davis online 
recruitment system. None of participants reported a history of neurological or psychiatric disorders. There was no potential 
self-selection bias, and we made every reasonable effort to minimize the potential for other biases in subjects recruitments 
that could impact results. Participants received course credit as compensation for participating in day 1 and day 2 training. 
Participants received monetary compensation for their participation from day 3 training. In addition to the compensation, 
participants have been told that extra monetary rewards will be earned if they pass the training based on a predetermined 
criteria and these extra rewards would be paid if they completed the fMRI task.
Ethics oversight
The current study protocols were approved by the UC Davis Institutional Review Board (IRB) committee (IRB ID: 967139-3), 
all relevant ethical regulations were followed, and participants gave written consent before the experiment.

3
nature research  |  reporting summary
April 2020
Note that full information on the approval of the study protocol must also be provided in the manuscript.
Magnetic resonance imaging
Experimental design
Design type
Event-related
Design specifications
On each day of the fMRI experiment session, participants performed three blocks of the task. A block consisted of 48 
trials. In each trial, participants needed to estimate a decision value of each of two pairs of stimuli to make a correct 
decision. Participants, therefore, needed to compute the decision value of 576 pairs in total (48 trials ×2 pairs per trial 
×3 blocks × 2 days of scans). 
Behavioral performance measures
Participants were highly accurate in binary choices during the fMRI session (mean ± SE accuracy = 98.68 ± 0.27%).
Acquisition
Imaging type(s)
Functional
Field strength
3T
Sequence & imaging parameters
We acquired T2-weighted functional images on a Siemens Skyra 3 Tesla scanner. We used gradient-echo-planar imaging 
(EPI) pulse sequence with a slice angle of 30° relative to the anterior-posterior commissure line, minimizing the signal 
loss in the orbitofrontal cortex region 61. We acquired 46 slices, 3mm thick with the following parameters: repetition 
time (TR) = 1300 ms, echo time (TE) = 24 ms, flip angle = 67°, field of view (FoV) = 192mm, voxel size = 3 x 3 x 3 mm3. 
Contiguous slices were acquired in interleaved order. To correct for deformations, we also acquired a field map with 
dual echo-time images covering the whole brain, with the following parameters: TR = 630 ms, TE1 = 10 ms, TE2 = 12.46 
ms, flip angle = 40°, FoV = 192mm, voxel size = 3 x 3 x 3 mm3. We acquired a T1-weighted structural image using a 
magnetization-prepared rapid gradient echo sequence (MPRAGE) with the following parameters: TR = 1810 ms, TE = 
2.98 ms, flip angle = 7°, FoV = 256mm, voxel size = 1 x 1 x 1 mm3.
Area of acquisition
Whole brain
Diffusion MRI
Used
Not used
Preprocessing
Preprocessing software
SPM12 (Wellcome Trust Centre for Neuroimaging)
Normalization
Functional and structural images were spatially normalized by warping subject-specific images to the reference brain in MNI 
(Montreal Neurological Institute) coordinate space (2mm isotropic voxels).
Normalization template
MNI template
Noise and artifact removal
During the first-level analysis, realignment parameters were entered as nuisance regressors, a participant-specific implicit 
mask smoothed with a 2mm FWHM-Gaussian kernel including probability masks of gray and white matters was applied.
Volume censoring
Volume censoring was not performed.
Statistical modeling & inference
Model type and settings
1. A multivariate analysis using RSA was performed to whether the a priori regions of interest (ROIs) in the brain reflected the 
structure of the social hierarchy. We examined whether the level of pattern dissimilarity between the neural activity evoked 
by each of 16 individual face stimuli was explained by a function of pairwise Euclidean distances between individuals on the 
two-dimension (2-D) social space. The representational similarity between the neural activity patterns elicited by face stimuli 
across three independent fMRI blocks was quantified using the Mahalanobis distance. We further tested whether the brain 
had increasingly similar patterns of neural activity for individuals who were increasingly close to each other in the true 2-D 
social space. 2. Univariate analyses were performed using general linear models (GLMs) in which we modeled the BOLD 
signals of onsets of the partner stimuli with a 2.5 boxcar function. These events were modulated by a parametric regressor, 
cos(6[θ-ϕ]), where θ was the hypothesized direction of inferred trajectories between individuals in each pair and ϕ was the 
mean grid orientation estimated from the separate estimate dataset using cross-validation. Additionally, the onsets of F0 
face stimulus and button presses were modeled as separate regressors with a stick function. The 6 motion regressors were 
also entered as regressors of no-interest. The orthogonalize function was turned off. All regressors in the GLM were 
convolved with the canonical HRF.
Effect(s) tested
1. For multivariate RSA analysis, we compared the neural representational dissimilarity matrix (RDMs) of each ROI to the 
model RDMs using a rank correlation (using Kendall’s TauA). Each subject’s rank correlation was compared to the mean of 
this permutation distribution and submitted to a one-sample Wilcoxon signed-rank test across participants. 2. For univariate 
analysis, whole brain analyses were performed to identify a brain area in which its activity was modulated by the direction of 
inferred trajectories with six-folds symmetry aligned to the grid orientation of the entorhinal cortex (EC) for making novel 
inferences. The group-level effects were tested with a one-sample t-test.

4
nature research  |  reporting summary
April 2020
Specify type of analysis:
Whole brain
ROI-based
Both
Anatomical location(s) The ROIs were defined anatomically independent from the current task in the bilateral hippocampus (HC) 
(Yushkevich, 2015),  bilateral entorhinal cortex (EC) (Amunts et al., 2005; Zilles and Amunts, 2010).
Statistic type for inference
(See Eklund et al. 2016)
We reported the non-parametric permutation-based threshold-free cluster enhancement (TFCE)-corrected images at the 
threshold pTFCE<0.05 (1000 iterations of simulation) (Smith and Nichols, 2009).
Correction
To correct for multiple comparisons, we used permutation-based threshold-free cluster enhancement (TFCE) (Smith and 
Nichols, 2009). The EC effects were reported at the threshold pTFCE<0.05 corrected within the independently defined 
anatomical ROI. For the whole-brain analyses, we reported results at the threshold pTFCE<0.05 corrected across the whole 
brain. Statistical significance of the multivariate effects was calculated by constructing a null distribution by shuffling our data 
1000 times at the subject level, corrected for multiple comparisons over the number of ROIs (n=4). The result was reported 
for family-wise error (FWE) with the Holm-Bonferroni method at p<0.05 while stronger effects were noted with asterisks.
Models & analysis
n/a Involved in the study
Functional and/or effective connectivity
Graph analysis
Multivariate modeling or predictive analysis

