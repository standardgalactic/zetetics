
Principles of 
Electron Optics 

Corrections for this volume are to be found after the index. 

Principles of 
Electron Optics 
Volume 1 
Basic Geometrical Optics 
by 
P. W. HAWKES 
CNRS Laboratory of Electron Optics, 
Toulouse, France 
and 
E. KASPER 
Institut f~r Angewandte Physik 
Universit~t T6bingen, 
Federal Republic of Germany 
• 
ACADEMIC PRESS 
Harcourt Brace & Company, Publishers 
London San Diego New York 
Boston Sydney Tokyo Toronto 

ACADEMIC PRESS LIMITED 
24/28 Oval Road, 
London NWl 7DX 
United States Edition published by 
ACADEMIC PRESS, INC. 
San Diego, CA 92101 
Copyright © 1996 
by ACADEMIC PRESS LIMITED 
All rights reserved. No part of this publication may 
be reproduced, stored in a retrieval system or 
transmitted, in any form or by any means, electronic, 
mechanical, photocopying or otherwise, without the 
prior permission of the publishers. 
British Library Cataloguing in Publication Data 
Hawkes, P. W. 
Principles of electron optics. 
Vol 1: Basic Geometrical Optics 
1. Electron Optics 
I. Title 
II. Kasper, E. 
537.5'6 
ISBN 0-12-333341-5 
Printed in Great Britain by St Edmundsbury Press Limited, 
Bury St Edmunds, Suffolk. 

Contents of Volume 1 
Basic Geometrical Optics 
Preface 
Chapter 
1 
Introduction 
1.1 
Organization of the subject 
1.2 
History 
PART I- CLASSICAL MECHANICS 
Chapter 
2 
2.1 
Chapter 
Chapter 
Chapter 
2.2 
2.3 
2.4 
2.5 
3 
3.1 
3.2 
3.3 
3.4 
4 
4.1 
4.2 
4.3 
4.4 
4.5 
5 
5.1 
5.2 
5.3 
5.4 
5.5 
Relativistic Kinematics 
The Lorentz equation and general 
considerations 
Conservation of energy 
The acceleration potential 
Definition of coordinate systems 
Conservation of axial angular momentum 
Different Forms of Trajectory Equations 
Parametric representation in terms of the 
arc-length 
Relativistic proper-time representation 
The cartesian representation 
Scaling rules 
Variational Principles 
The Lagrange formalism 
General rotational ly symmetric systems 
The canonical formalism 
The time-independent form of the 
variational principle 
Static rotational ly symmetric systems 
Hamiltonian Optics 
Introduction of the characteristic function 
The Hamilton-Jacobi equation 
The analogy with light optics 
The influence of vector potentials 
Gauge transformations 
17 
17 
18 
19 
22 
24 
27 
27 
29 
30 
33 
35 
35 
38 
41 
43 
44 
46 
46 
48 
49 
51 
53 

vi 
Contents 
5.6 
5.7 
5.8 
Poincar~'s integral invariant 
The problem of uniqueness 
R~sum6 
54 
57 
58 
PART II- CALCULATION OF STATIC FIELDS 
Chapter 
6 
6.1 
6.2 
6.3 
6.4 
6.5 
Chapter 
7 
7.1 
7.2 
7.3 
7.4 
7.5 
7.6 
Chapter 
8 
8.1 
8.2 
8.3 
Chapter 
9 
9.1 
9.2 
9.3 
9.4 
9.5 
Chapter 10 
10.1 
10.2 
10.3 
10.4 
10.5 
Chapter 11 
11.1 
Basic Concepts and Equations 
General considerations 
Field equations 
Variational principles 
Rotationally symmetric fields 
Planar fields 
Series Expansions 
Azimuthal Fourier series expansions 
Radial series expansions 
Rotationally symmetric fields 
Multipole fields 
Planar fields 
Fourier-Bessel series expansions 
Boundary-Value Problems 
Boundary-value problems in electrostatics 
Boundary conditions in magnetostatics 
Examples of boundary-value problems in 
magnetostatics 
Integral Equations 
Integral equations for scalar potentials 
Problems with interface conditions 
Reduction of the dimensions 
Important special cases 
R~sum~ 
The Boundary-Element Method 
Evaluation of the Fourier integral kernels 
Numerical solution of one-dimensional 
integral equations 
Superposition of aperture fields 
Three-dimensional Dirichlet problems 
Examples of applications of the 
boundary-element method 
The Finite-Difference Method (FDM) 
The choice of grid 
61 
61 
62 
65 
67 
69 
73 
73 
78 
85 
88 
90 
91 
94 
94 
96 
101 
107 
107 
111 
113 
117 
124 
125 
125 
131 
143 
149 
158 
159 
159 

Contents 
vii 
11.2 
11.3 
11.4 
11.5 
Chapter 12 
12.1 
12.2 
12.3 
12.4 
12.5 
Chapter 13 
13.1 
13.2 
The Taylor series method 
The integration method 
Nine-point formulae 
Iterative solution techniques 
The Finite-Element Method (FEM) 
Formulation for round magnetic lenses 
Formulation for self-adjoint elliptic 
equations 
Solution of the finite-element equations 
Improvement of the finite-element method 
Comparison and combination of different 
methods 
Field-Interpolation Techniques 
One-dimensional differentiation and 
interpolation 
Two-dimensional interpolation 
160 
162 
165 
170 
175 
175 
179 
182 
183 
184 
188 
188 
194 
PART III- THE PARAXlAL APPROXIMATION 
Chapter 14 
Chapter 15 
15.1 
15.2 
15.3 
15.4 
15.5 
Chapter 16 
16.1 
16.2 
16.3 
16.4 
Introduction 
Systems with an Axis of Rotational 
Symmetry 
Derivation of the paraxial ray equations 
from the general ray equations 
Variational derivation of the paraxial 
equations 
Forms of the paraxial equations and 
general properties of their solutions 
The Abbe sine condition and Herschel's 
condition 
Some other transformations 
Gaussian Optics of Rotationally Symmetric 
Systems: Asymptotic Image Formation 
Real and asymptotic image formation 
Asymptotic cardinal elements and transfer 
matrices 
Gaussian optics as a projective 
transformation 
Use of the angle characteristic to establish 
the optical quantities 
201 
202 
207 
212 
213 
219 
222 
225 
225 
226 
235 
237 

viii 
Contents 
16.5 
Chapter 17 
17.1 
17.2 
17.3 
17.4 
Chapter 18 
18.1 
18.2 
18.3 
18.4 
Chapter 19 
19.1 
19.2 
Chapter 20 
The existence of asymptotes 
Gaussian Optics of Rotationally Symmetric 
Systems: Real Cardinal Elements 
Real cardinal elements for high 
magnification and high demagnification 
Osculating cardinal elements 
Inversion of the principal planes 
Approximate formulae for the cardinal 
elements: the thin-lens approximation and 
the weak-lens approximation 
Electron Mirrors 
Introduction 
A time-like parameter as independent 
variable 
The cartesian representation 
A quadratic transformation 
Quadrupole Lenses 
Paraxial equations for quadrupoles 
Transaxial lenses 
Cylindrical Lenses 
239 
242 
242 
246 
253 
257 
261 
261 
264 
271 
274 
276 
277 
286 
290 
PART IV- ABERRATIONS 
Chapter 21 
Chapter 22 
Chapter 23 
23.1 
23.2 
23.3 
23.4 
23.5 
23.6 
23.7 
23.8 
Chapter 24 
24.1 
Introduction 
Perturbation Theory: General 
Formalism 
The Relation Between Permitted Types of 
Aberration and System Symmetry 
Introduction 
N=I 
N=2 
N=3 
N=4 
N = 5 and 6 
Systems with an axis of rotational 
symmetry 
Note on the classification of aberrations 
The Geometrical Aberrations of Round 
Lenses 
Introduction 
297 
3O3 
315 
315 
322 
325 
329 
330 
333 
334 
336 
339 
339 

Contents 
ix 
24.2 
24.3 
24.4 
24.5 
24.6 
24.7 
24.8 
24.9 
Chapter 25 
Chapter 26 
26.1 
26.2 
Chapter 2 7 
Chapter 28 
28.1 
28.2 
28.3 
28.4 
Chapter 29 
Chapter 
Chapter 
29.1 
29.2 
29.3 
29.4 
29.5 
30 
31 
31.1 
31.2 
31.3 
31.4 
Derivation of the real aberration 
coefficients 
Spherical aberration 
Coma 
Astigmatism and field curvature 
Distortion 
The variation of the aberration coefficients 
with aperture position 
Reduced coordinates 
Seman's transformation of the 
characteristic function 
Asymptotic Aberration Coefficients 
Chromatic Aberrations 
Real chromatic aberrations 
Asymptotic chromatic aberrations 
Aberration Matrices and the Aberrations 
of Lens Combinations 
The Aberrations of Mirrors and Cathode 
Lenses 
The parametric form of the theory 
Systems with curved cathodes 
Structure of the aberrations 
The cartesian form of the aberration theory 
The Aberrations of Quadrupole Lenses 
and Octopoles 
Introduction 
Geometrical aberration coefficients 
Aperture aberrations 
Chromatic aberrations 
Quadrupole multiplets 
The Aberrations of Cylindrical Lenses 
Parasitic Aberrations 
Small deviations from rotational symmetry; 
axial astigmatism 
Classification of the parasitic aberrations 
Numerical determination of parasitic 
aberrations 
The isoplanatic approximation 
339 
350 
365 
369 
378 
382 
384 
387 
393 
409 
409 
415 
418 
425 
425 
429 
430 
432 
434 
434 
434 
453 
460 
461 
466 
470 
470 
472 
475 
477 

x 
Contents - 
PART V- DEFLECTION SYSTEMS 
Chapter 32 
32.1 
32.2 
32.3 
32.4 
Deflection Systems and their Aberrations 
Introduction 
The paraxial optics of deflection systems 
The aberrations of deflection systems 
Stigmators 
PART VI- COMPUTER-AIDED ELECTRON OPTICS 
Chapter 33 
33.1 
33.2 
33.3 
33.4 
33.5 
33.6 
33.7 
Chapter 34 
34.1 
34.2 
34.3 
Numerical Calculation of Trajectories, 
Paraxial Properties and Aberrations 
Introduction 
Numerical solution of ordinary differential 
equations 
Standard applications in electron optics 
Differential equations for the aberrations 
Least-squares-fit methods in electron 
optics 
Determination and evaluation of 
aberration discs 
Optimization procedures 
The Use of Computer Algebra Languages 
Introduction 
Computer algebra, its role in electron 
optics 
Two practical examples 
Notes and References 
Preface and Chapter 1 
Part I, Chapters 2-5 
Part II, Chapters 6-13 
Part III, Chapters 14-20 
Part IV, Chapters 21-31 
Part V, Chapter 32 
Part Vl, Chapters 33 and 34 
Conference Proceedings 
Index 
483 
483 
487 
497 
516 
525 
525 
526 
533 
537 
543 
547 
558 
565 
565 
566 
569 
575 
586 
586 
591 
601 
619 
622 
1192 

Contents of Volume 2 
Applied Geometrical Optics 
Preface 
PART VII- INSTRUMENTAL OPTICS 
Chapter 35 
Chapter 36 
Chapter 37 
Chapter 38 
Chapter 39 
Chapter 40 
Electrostatic Lenses 
Magnetic Lenses 
Electron Mirrors 
Cathode Lenses and Field-Emission 
Microscopy 
Quadrupole Lenses 
Deflection Systems 
PART VIII- ABERRATION CORRECTION AND BEAM 
INTENSITY DISTRIBUTION (CAUSTICS) 
Chapter 41 
Chapter 42 
Aberration Correction 
Caustics and their Applications 
PART IX- ELECTRON GUNS 
Chapter 43 
Chapter 44 
Chapter 45 
Chapter 46 
Chapter 47 
Chapter 48 
Chapter 49 
Chapter 50 
General Features of Electron Guns 
Theory of Electron Emission 
Pointed Cathodes without Space Charge 
Space Charge Effects 
Brightness 
Emittance 
The Boersch Effect 
Complete Electron Guns 
PART X- SYSTEMS WITH A CURVED OPTIC AXIS 
Chapter 51 
Chapter 52 
General Curvilinear Systems 
Magnetic Sector Fields 
627 
629 
687 
796 
799 
801 
823 
855 
857 
879 
905 
907 
918 
934 
953 
971 
989 
1004 
1017 
1037 
1039 
1058 

xii 
Contents 
Chapter 53 
Unified Theories of Ion Optical Systems 
1080 
Notes and References 
Index 
1101 

Principles of 
Electron Optics 
Volume 3 
Topics to be covered in this volume are: 
- 
Derivation of the laws of electron propagation from 
Schr6dinger's equation. 
- 
Image formation and the notion of resolution in electron 
microscopes. 
- 
Electron-specimen interactions (scattering theory and 
dynamic theory). 
- Image processing: 
• discretization and coding; 
• enhancement; 
• restoration; 
• analysis, description and pattern recognition. 
- Electron holography and interference. 
- Coherence, brightness and the spectral functions. 

This Page Intentionally Left Blank

Preface 
The last attempt to cover systematically the whole of electron optics was 
made by the late Walter Glaser, whose Grundlagen der Elektronenoptik 
appeared in 1952; although a revised abridgement was published in the 
Handbuch der Physik four years later, we cannot but recognise that those 
volumes are closer to the birth of the subject, if we place this around 1930, 
than to the present day. 
Furthermore, electron optics has been altered dramatically during these 
intervening decades by the proliferation of large fast computers. Analytic 
expressions for the aberration coefficients of superimposed deflection and 
round magnetic lens fields, for example, have been derived only recently, 
partly because the latest generation of microlithography devices required 
them but also because they could only be evaluated by numerical methods: 
the earlier practice of seeking models permitting hand calculation could 
never have served here. Again, computer calculations have shed consid- 
erable light on electron gun behaviour, as the length of Part IX testifies 
convincingly; in 1952, Glaser was able to condense his account of gun theory 
into four pages! 
The growth of electron optics is not, however, solely due to the com- 
puter. Many systems that had not been thoroughly explored have now 
been analysed in detail and, in many cases, we have had to renounce the 
attempt to reproduce in detail new results, however interesting, to keep the 
number of pages within reasonable limits. This work should therefore be 
regarded as both a textbook and a source-book: the fundamentals of the 
subject are set out in detail, and there the student should find everything 
needed to master the basic ideas or to begin the analysis of some class 
of systems not yet explored; the principal electron optical components are 
likewise dealt with in great detail. Where optical elements that are not 
quite so common are concerned, however, we have felt at liberty to direct 
the reader to original articles and reviews, or specialist texts, to leave space 
for topics of wider interest. 
The following chapters are, moreover, limited to geometric optics: 
wave optics is to be covered in a companion volume. With the SchrSdinger 
equation as starting point, we shall there examine the propagation of elec- 
tron waves in electrostatic and magnetic fields and study image formation 
and resolution in the principal electron optical instruments. This demands 
some discussion of electron-specimen interactions. A chapter will be de- 
voted to the four broad themes of image processing: discretization and 

PREFACE 
coding; enhancement; restoration; and analysis, description and pattern 
recognition. In another, we shall give an account of the steadily grow- 
ing field of electron holography. Finally, we shall return to the optics of 
electron sources in order to understand the concept of coherence and we 
shall show how the notions of brightness, partial coherence and various 
associated spectral functions are inter-connected. 
Students of electron optics have been fortunate in that many excellent 
textbooks on the subject have appeared over the years, the first when the 
subject was still young (Briiche and Scherzer, 1934; Myers, 1939; Klem- 
perer, 1939; Picht, 1939); these were followed in the 1940s by the en- 
cyclopaedic Zworykin et al. 
(1945), Cosslett (1946) and Gabor (1945). 
Many books on the subject appeared in the 1950s, of which the texts by 
Glaser already mentioned, Sturrock (1955) Grivet et al. (1955, 1958) and 
Kel'man and Yavor (1959) are the most important for our present purposes. 
Subsequently, however, the flow has shrunk to a trickle, new editions and 
short introductory texts dominating, with the exception of the multi-author 
volumes edited by Septier (1967, 1980, 1983); conversely, monographs on 
limited topics have become more common. Although certainly 'standing 
on the shoulders of giants', the present volumes do differ considerably from 
their many predecessors in that the developments of the past twenty years 
are accorded ample space. 
For whom is this work intended? A knowledge of physics and math- 
ematics to first degree level is assumed, though many reminders and brief 
recapitulations are included. It would be a suitable background text for a 
post-graduate or final year course in electron optics, and much of the ma- 
terial has indeed been taught for some years in the University of Tiibingen; 
a course in the University of Cambridge likewise covered many of the prin- 
ciples. Its real purpose is, however, to provide a self-contained, detailed 
and above all modern account of electron optics for anyone involved with 
particle beams of modest current density in the energy range up to a few 
mega-electronvolts. Such a reader will find all the basic equations with 
their derivations, recent ideas concerning aberration studies, extensive dis- 
cussion of the numerical methods needed to calculate the properties of 
specific systems and guidance to the literature of all the topics covered. 
Composition of volumes such as these puts us in debt to a host of col- 
leagues: many have permitted us to reproduce their results; the librarians 
of our institutes and the Librarian and Staff of the Cambridge Scientific 
Periodicals Library have been unflagging in their pursuit of recondite and 
elusive early papers; Mrs. StrSer has uncomplainingly word-processed hun- 
dreds of pages of mathematical and technical prose; Mrs. Maczkiewicz and 
Mr. Inial have taken great pains with the artwork as have Mrs. Bret and 
her colleagues with the references; Academic Press and Professor Dr K.-H. 

PREFACE 
Herrmann, Director of the Institut fiir Angewandte Physik der Universit£t 
Tiibingen, have generously supported this work; the Zentrum f(ir Daten- 
verarbeitung has provided the text-editing facilities needed for TF_ ~. To all 
of these we are extremely grateful. We also thank the many authors and 
publishers who have been good enough to allow us to reproduce published 
drawings. The details are as follows. 
SPRINGER VERLAG: Figs 17.4-5, 36.6-7, 36.11 and 42.1-7 from Grund- 
lagen der Elektronenoptik by W. Glaser; Fig. 43.2 from the article by 
D. Kamke in Handbuch der Physik 33; and Figs 36.3-4, 36.13, 36.17 and 
36.36-37 from the chapters by F. Lenz, W.D. Riecke and T. Mulvey in 
Magnetic Electron Lenses. 
WISSENSCHAFTLICHE VERLAGSGESELLSCHAFT: Figs 35.5, 36.8-9, 36.15, 
36.18-26, 36.27-33, 36.35, 41.3-4, 41.7, 41.11, 42.15, 49.3 and 50.6-8 from 
Optik. 
INSTITUTE OF PHYSICS: Figs 35.10, 36.38-40 and 36.43 from J. Phys. E: 
Sci. Instrum.; Fig. 36.16 from Repts Prog. Phys.; and Fig. 35.3 from 
the Proceedings of the Fifth European Congress on Electron Microscopy 
(Manchester). 
JAPANESE SOCIETY OF ELECTRON MICROSCOPY: Figs 36.12, 36.34 and 
41.5-6 from Y. Electron Microsc. 
NORTH-HOLLAND PUBLISHING Co.: Figs 36.41-42 from Ultramicroscopy; 
and Fig. 42.17 from Nucl. Instrum. Meth. 
JAPANESE JOURNAL OF APPLIED PHYSICS: Figs 35.13-14 and 36.44-45. 
VEB DEUTSCHER VERLAG DER WISSENSCHAFTEN: Fig. 36.14 from Ezp. 
Tech. Phys. 
IEEE: Figs 40.24-25 from IEEE Trans Electron Devices. 
ACADEMIC PRESS: Figs. 45.8-9 and 48.7-8 from Adv. 
Opt. Electron 
Microsc.; Figs 40.14-19 from Microcircuit Engineering 83. 
"Now, soldiers, march away; And how thou pleasest, God, dispose the day/" 
Henry V, on the eve of the battle of Agincourt... 

This Page Intentionally Left Blank

Introduction 

This Page Intentionally Left Blank

Introduction 
1.1 Organization of the subject 
The properties of beams of free electrons, released from a material source 
and propagating through a vacuum region in some device, are of interest in 
many diverse fields of instrumentation and technology. The study of such 
electron beams forms the subject of electron optics, which divides naturally 
into geometrical optics, when the wavelength is negligible, and wave optics, 
in which effects due to the finite wavelength are considered. This first vol- 
ume is concerned with geometrical optics, a knowledge of which is needed 
to analyse an extremely wide range of instruments: cathode-ray tubes; 
the family of electron microscopes, which now includes the fixed-beam and 
scanning transmission instruments, the scanning electron microscope and 
the emission microscope; electron spectrometers and mass spectrographs if 
we include charged particles other than electrons; image converters; elec- 
tron interferometers and diffraction devices; electron welding machines; and 
electron-beam lithography devices. We could indeed include electron accel- 
erators, such as betatrons and electron synchrotrons, but a rather different 
approach is often more useful in those machines. This list is by no means 
complete but it already demonstrates the great diversity of the possible 
applications of electron optics. 
Over the years, a vast amount of knowledge about the many branches 
of electron optics has been accumulated and we have therefore had to be 
selective. The main emphasis is on the principles of electron optics, and 
technical details are only included to bridge the gap to the practical appli- 
cation of these principles. This seems justified, for the principles remain 
unaffected by the passage of time whereas instrumental development is so 
rapid that surveys and review articles are the best means of charting its 
progress. 
The physical properties of electrons in a free beam may be classified 
as follows: 
(a) corpuscular properties; 
(b) wave properties; 

4 
1. INTRODUCTION 
(c) macroscopic interactions; 
(d) microscopic or atomic interactions; 
(e) radiative properties. 
A similar classification is given by Sturrock (1955). 
The corpuscular properties are described by classical (relativistic) me- 
chanics, the electron being regarded as a charged particle acted on by 
electromagnetic forces. For almost all electron optical devices, extensive 
studies must be made on the assumption that these corpuscular properties 
alone are important and the present volume is almost wholly confined to 
the corresponding geometrical optics. Geometrical particle optics is very 
similar for all charged particles, ions in particular, and Parts I and X are 
written in such a way that many of the relations derived are valid for ions 
and electrons, or can be converted straightforwardly. 
The rest-mass of the electron is extremely small, a characteristic that 
has important consequences for the technology associated with electron 
beams. Only quite modest voltages are needed to accelerate electrons to 
a very high velocity, and the time of flight between the departure of an 
electron from the cathode and its arrival at its destination in a typical 
device is so small that it can almost invariably be ignored completely. It 
is therefore quite sufficient to study the purely geometrical shape of the 
electron motion within the beam, although a time-like curve parameter 
may prove to be advantageous in numerical calculations. 
A further consequence of the extremely small inertia of the beam elec- 
trons is that deflection by suitably placed magnetic or electrostatic fields 
occurs virtually instantaneously, in synchronism with the applied voltages 
or currents, unless the frequency involved is very high indeed. The perfor- 
mance of many devices relies upon this property. We shall consider electron 
motion only in static, that is, time-independent fields. This is justified even 
when studying the deflector in a scanning device, the time of flight being 
so short that the applied field is quasistatic; the time dependence is then 
merely a common amplitude factor. 
A knowledge of the wave properties of the electron is essential to 
understand the concept of resolution in electron microscopes, to ana- 
lyse the interactions between electron beams and targets of all kinds, and 
to analyse the behaviour of electron interferometers and diffraction devices 
and of course to comprehend electron holography. These topics will occupy 
much of Volume 3. 
The macroscopic interactions in an electron beam are a consequence 
of the fact that the latter may be regarded as a cloud of negative charges, 
which creates an electric field; this is superimposed on the external applied 
field and can thus alter the focusing properties of the device. In principle, of 
course, this occurs for every electron beam, but in reality such space charge 

1.1 ORGANIZATION OF THE SUBJECT 
effects are of importance only when the local beam intensity is very high. 
The space charge density can be treated as a macroscopic observable and 
the associated field calculation remains within the framework of classical 
electrostatics; we therefore call these interactions macroscopic. Such effects 
occur mainly in electron guns where the beam intensity can be high, and 
are therefore dealt with in Part IX, devoted to guns. Such effects are also 
extremely important in accelerators, but these are not within the scope of 
this book. 
The microscopic or atomic interactions are the various scattering pro- 
cesses that occur within the beam on the atomic scale. Such processes 
arise when an electron beam encounters a specimen or target and electron- 
electron collisions may also occur within the beam. The latter give rise 
to the Boersch effect, an anomalous broadening of the electron spectrum 
at beam waists, which are themselves enlarged. Classical collision theory 
is capable of providing an approximate explanation of this effect, which is 
examined briefly in Chapter 49. Collisions between beam electrons and the 
atoms in a target can only be properly understood in terms of quantum 
mechanics; some space is devoted to this topic in Volume 3. 
Finally, we come to the radiative properties of the electron, essentially 
the emission of bremsstrahlung when the acceleration is very high. This 
occurs mainly in high-voltage electron microscopes where particles with an 
energy of 1 MeV or more collide with the specimen placed in the path of the 
beam. Although the staff around the microscope must be protected from 
this radiation, the damage to the specimen is negligible in comparison with 
that inflicted by the mechanical bombardment. The bremsstrahlung caused 
by the acceleration of the electrons in vacuo only becomes important at the 
energies encountered in high-energy physics, which are beyond the scope 
of these volumes; we therefore ignore bremsstrahlung throughout. 
Our theme is thus the study of the motion of electrons, regarded as 
classical charged particles of negligible extent, through static electric or 
magnetic fields. We begin with the derivation of the conservation laws for 
the electron motion and cast these into a form particularly well suited to 
electron optics. Various forms of the trajectory equations are established 
but these are not at all satisfactory for our purpose, which is the study 
not of single trajectories but of whole families of electron paths: not bal- 
listics but optics. It is Hamiltonian theory that enables us to make the 
transition. As early as 1827, Hamilton drew his famous analogy between 
geometrical optics and classical mechanics; this tells us that, just as in 
optics, there must exist a mechanical characteristic function, or eikonal, 
with the property that the trajectories are always locally orthogonal to the 
surfaces of constant value of this function. This is true only in the absence 
of magnetic vector potentials; in the general case, when magnetic fields 

6 
1. INTRODUCTION 
are present, the correct form of this orthogonality relation emerges from 
the Hamilton-Jacobi theory presented in Chapter 5. This theory is very 
important, for it forms the cornerstone of geometrical electron optics. 
Most instrumental research is concerned with the design of new or im- 
proved electron optical systems, for which an accurate knowledge of the 
properties of families of rays traced through such systems is indispensable. 
This proceeds in two stages: first, the field distribution must be estab- 
lished, after which rays can be traced and quantities characteristic of the 
system calculated. A knowledge of the field distribution is usually needed 
only in the immediate vicinity of a curve in space, frequently a symme- 
try axis, known as the optic axis; the beam is required to remain close to 
this axis to prevent the aberrations from degrading the performance of the 
device. Unfortunately, the required information about the field can rarely 
be obtained without solving a boundary-value problem, since the field will 
be generated by electrodes and magnetic materials, such as polepieces, at 
some distance from this axis. 
In practice, field calculation is the most complicated part of numerical 
design and the principal methods are presented in considerable detail in 
Part II. Series ezpansions for electrostatic potentials and hence fields and 
for magnetic scalar and vector potentials are also listed since these are 
repeatedly needed in later chapters where the trajectory equations and 
aberration coefficients of various types of system are derived. 
This thorough presentation of the physical and mathematical funda- 
mentals leads naturally to the systematic investigation of electron optical 
components: how are these to be characterized, how can we code complex 
behaviour in terms of a few easily calculated parameters? Parts III and 
IV provide the traditional answers in terms of the paraxial approximation 
and the aberrations that measure departures from it. In the parazial ap- 
prozimation, it is assumed that the electron trajectories remain so close to 
the optic axis that equations of motion linear in the off-axis coordinates 
describe them satisfactorily. Although this is an excellent first-order ap- 
proximation, it is clearly an idealization, a consequence of which is that 
some electron optical systems appear to be free of any image defects and 
hence capable of producing a stigmatic, unblurred image or a sharp focus. 
In reality, no system is free of aberrations. One of the major tasks of 
electron optics is to establish what types of aberrations can occur in any 
given system and then to reduce the most deleterious as far as possible. 
A long Part is therefore devoted to the theory of aberrations. Since all 
wave optical considerations are excluded from this volume, only geometrical 
and chromatic aberrations are investigated. 
The former are those that 
measure the discrepancy between the true point of arrival of an electron at 
its destination and the point predicted by the paraxial approximation, due 

1.1 ORGANIZATION OF THE SUBJECT 
to the inadequacies of the latter and to small imperfections in the system; 
the chromatic aberrations are those caused by the presence of electrons 
with different energies in the beam, arising from the small spread of the 
initial energies at the cathode surface or from the loss of various amounts 
of energy when traversing a thin specimen. 
A separate Part is devoted to a similar analysis of deflection systems, 
of great practical importance for microlithography in the current quest for 
miniaturization. Such systems may be very complex, magnetic and electric 
deflection fields occupying the same region as a magnetic round lens field, 
and the number of degrees of freedom becomes very large. Both the theory 
and the experimental adjustment of such combinations reflect this com- 
plexity but it has proved necessary to resort to such intricate arrangements 
in modern electron beam lithography machines, which are used to produce 
the semiconducting integrated circuits required in computers. 
In the next four Parts, VI-IX, the principles set out in the first half 
of the book are applied to the many different types of electron optical 
components--round lenses, quadrupoles, mirrors, cathode lenses--for each 
of which the general theory takes a special form. We have preferred to 
organize this material by component rather than by instrument, since the 
latter must inevitably be understood as an assembly of individual mod- 
ules. In Part VI, the numerical techniques needed for tracing trajectories 
and computing aberrations in any system are presented, together with an 
introductory account of computer algebra, a tool that is very useful for 
establishing aberration integrals and evaluating these for the few models 
that permit a result to be obtained in closed form. 
Part VII indicates what practical information is available in the liter- 
ature concerning the optical properties of the various elements analysed in 
theory in earlier chapters, while in Part VIII we examine two special topics 
of sufficient importance to warrant separate treatment: aberration correc- 
tion, essentially for systems of round lenses, and the theory of caustics. 
Another topic of great complexity is the study of electron sources, 
usually known as electron guns. An entire Part (IX) is devoted to these, 
for although the degrees of freedom are not unduly large in number, the 
theoretical description requires concepts that are of little importance else- 
where and depend essentially on the purpose to which the gun is to be 
put. Thus the gun of an electron interferometer is very different from that 
of an electron welding machine. We have tried to impose a pattern on 
this complex and many-faceted topic by following the flight of the electron 
through the gun. First we examine the principal emission processes and 
the focusing effects in the neighbourhood of the cathode. This is followed 
by the theory of space charge, which may of course be important elsewhere 
than in the cathode region. We next introduce a number of quantities that 

8 
1. INTRODUCTION 
are employed to characterize the beam farther from the cathode, and, in 
particular, brightness, emittance and the energy spectrum, which are very 
important when considering the suitability of the gun for specific tasks. 
The Part ends with a few remarks about the design of complete guns. 
The final Part is devoted to systems in which the optic axis is curved, 
though in practice almost always a plane curve, a situation that arises 
in the electric or magnetic prisms of electron spectrometers. With this, 
most aspects of geometrical electron optics have been covered. The reader 
will notice that the emphasis throughout is on physical principles and on 
their theoretical formulation. Technical details are included only when 
they seem necessary to render the practical applications of these principles 
comprehensible. Inclusion of technological details would have made the 
• 
\ 
, 
book Impossibly large and rapidly obsolete, for there are few branches of 
the subject that are not in continual development. The lifetime of the 
underlying principles is, however, substantially longer. 
The subject has acquired a very voluminous literature over the decades, 
so that a full bibliography would alone fill many pages. We have adopted a 
compromise towards these many publications: papers of especial relevance 
are mentioned in the body of the text but, in order not to interrupt the 
flow, the majority are grouped in annotated bibliographic appendices at 
the end of each book. In this way, the reader is directed to the literature of 
each topic but is not continually distracted by notes and references. Even 
so, we have made no attempt to trace the history of the subject in these 
appendices and we therefore complete this introduction with a succinct 
account of the principal stages through which the subject has passed. 
1.2 History 
Electron optics was born in the 1920s. In 1925, Louis de Broglie argued 
convincingly that a wavelength should be associated with moving parti- 
cles, electrons in particular; and in 1927, Hans Busch demonstrated that 
the action of an axially symmetric coil on electrons can be described in 
the language of geometrical optics, in terms of a focal length: "Eine kurze 
Spule hat also die Eigenschaft, die Kathodenstrahlen nach der Achse zu um 
einen Winkel 7 abzulenken, der proportional der Achsenentfernung ... des 
Strahles ist. Genau die gleiche Eigenschaft besitzt aber fiir Lichtstrahlen 
eine Sammellinse"; this was an explicit statement of his conclusions adum- 
brated a year earlier (Busch, 1926). De Broglie's paper soon led to the 
experiments on electron diffraction of Davisson and Germer (1927) and of 
Thomson and Reid (1927). Busch's idea of associating a lens-like character 
with a short magnetic field was tested by Max Knoll and his young student, 

1.2 HISTORY 
9 
Ernst Ruska (Ruska and Knoll, 1931), who went on to combine such lenses 
into the first electron microscope, built in the Electrotechnical Institute of 
the Berlin Technological University (Knoll and Ruska, 1932a,b). 
An electron microscope has much in common with its light optical an- 
cestor. It consists of a source of illumination, condenser lenses to direct 
the illuminating beam onto a suitably sized region of the specimen with an 
appropriate angular spread, an objective lens to provide a first magnifica- 
tion and projector lenses to magnify the intermediate images still further. 
In appearance and nature, however, each of these optical elements is very 
different from those of the familiar compound microscope. The source of 
illumination is now an electron gun, of which the commonest type is the 
simple thermionic triode structure. A filament is heated, thus releasing 
electrons which are accelerated to the desired energy by a suitably polar- 
ized anode. A third electrode, the wehnelt, placed between filament and 
anode, improves the performance of such sources considerably. 
The lenses are short stretches of rotationally symmetric magnetic field, 
created by a current-carrying coil enclosed in an iron yoke. The interior 
of the microscope must be evacuated to a pressure typically of the order 
of 10 -s Torr (,-~ 10 -4 Pa) since electrons are scattered or halted by a very 
small amount of matter in their path. For the same reason, the specimen 
must be exceedingly thin (at most tens or hundreds of nanometres thick for 
a 100 kV instrument). In these conditions, the electrons are deflected or 
'scattered' within the specimen but almost no electrons fail to emerge from 
the far side. The specimen is thus a 'phase object' and contrast is created 
at the image by various mechanisms analogous to those encountered in the 
phase-contrast microscope. This image is rendered visible by allowing the 
electrons to fall on a fluorescent screen or a recording medium, a photo- 
graphic emulsion. One aspect of electron lenses deserves special mention: 
their optical quality is astonishingly poor! They suffer from two lens defects 
that have been virtually eliminated from glass lenses: spherical aberration, 
a defect that severely limits the numerical aperture at which they can be 
operated and hence the resolution attainable; and chromatic aberration, by 
which we mean that their focusing power varies rapidly with the velocity 
of the incoming electrons. The high spherical aberration has the practi- 
cal consequence of deteriorating the resolution of an electron microscope 
by some two orders of magnitude: with perfect lenses, the resolution limit 
might be expected to be of the order of picometres, whereas it is in reality 
of the order of hundreds of picometres (that is, of the order of £ngstrSms). 
The harmful effects of chromatic aberration are avoided by using nearly 
monoenergetic electrons and stabilizing the lens currents to a very high 
degree, typically to one part in a million. 
The first tentative studies of Ruska and Knoll, with which Bodo von 

10 
1. INTRODUCTION 
Borries was soon associated, were sufficiently encouraging to initiate a 
decade of theoretical and empirical electron optics, during which the foun- 
dations of the theory were laid, largely by Walter Glaser and Otto Scherzer, 
and the magnetic electron microscope was perfected to such a point that 
a commercial model was put on the market by the German company of 
Siemens in 1938. The British Metropolitan-Vickers company can, however, 
claim to have been the first commercial firm to supply a microscope, the 
custom-built EM1 instrument ordered by L.C. Martin for Imperial College, 
London, where it was installed in 1936; the resolution of the EM1 was not, 
however, superior to that of a light microscope (Mulvey, 1985). 
Meanwhile, comparable work on an electrostatic instrument was be- 
ing actively pursued in the research department of the Allgemeine Elek- 
trizit/ttswerke-Gesellschaft (AEG). For full details of these activities, see 
Ruska's historical volume (1979, 1980) and the 'Selfportrait' of the AEG 
Research Institute prepared by Ramsauer (1941) with further editions in 
1942 and 1943. The early development of the theory is fully chronicled in 
Glaser's Grundlagen der Elektronenoptik (1952). 
Outside Germany, many electron microscope projects were launched 
in the 1930s, though it was not until the end of the Second World War 
that commercial production began on any scale. The prototypes built in 
England and Canada are described in various historical articles, especially 
Gabor (1957), auska (1957) and Mulvey (1962, 1967, 1973), and many 
references and reminiscences are to be found in Hawkes (1985). We must, 
however, make particular mention of the work of Ladislaus Marton, who 
constructed a series of simple instruments in Brussels, with which he ob- 
tained the earliest osmium-stained biological micrographs, the specimens 
being the long-leafed sundew and the root of the bird's-nest orchid (Marton, 
1934, 1935). Soon after, first Driest and Mfiller (1935) and then Krause 
(1936) obtained biological electron micrographs with one of Ruska's mi- 
croscopes that foreshadowed, albeit faintly, modern biological electron mi- 
croscopy; Driest and Miiller's images of the wing and leg of the common 
housefly were the first micrographs of unprepared biological specimens. 
It was during the 1930s too that the field-emission microscope was 
developed by E.W. Miiller, in one of the Siemens research laboratories in 
Berlin. In this instrument, a high electric field is maintained at a tip and 
highly magnified details of the surface are visible in the image as a result 
of the differences in emission from point to point. Miiller's first papers 
appeared in 1936 and 1937 and a historical account is to be found in Good 
and Miiller (1956). 
By the 1950s, electron microscopes were being produced in West Ger- 
many, England, France, Holland, Switzerland, Czechoslovakia and the So- 
viet Union, with more modest activity in other European countries, par- 

1.2 HISTORY 
11 
ticularly Scandinavia. In the United States, RCA began manufacturing 
electron microscopes during the war years, and in Japan commercial pro- 
duction commenced in the late 1940s, though many prototypes were built 
during the first half of the decade; the Hitachi HU-4 was put on the market 
in 1947, for example, and the JEOL JEM-1 in 1949 (Sugata, 1968; Fujita, 
1986). 
Although our subject is not electron microscopy but electron optics, we 
must digress here to mention an important development in the years 1948- 
1952, which had a major effect on electron microscope design (Gettner and 
Ornstein, 1956). The accelerating voltages of the early microscopes were 
then of the order of 50-80 kV, which was too low to form a sharp image of 
a biological specimen if the latter was one or more micrometres in thick- 
ness. An increase in voltage therefore seemed imperative until in 1948, 
Pease and Baker succeeded in cutting sections only 0.3-0.5 #m thick with 
a modified Spencer 820 microtome, and by 1950 the figure had fallen to 
0.2 #m. In 1949, Newman et al. introduced methacrylate as an embedding 
medium, the mechanical properties of which greatly facilitated section cut- 
ting. In 1952, SjSstrand designed a new ultramicrotome (SjSstrand, 1953) 
with which sections 20 nm in thickness could be cut reproducibly and "the 
problem of high resolution electron microscopy of sectioned material had 
been solved " (SjSstrand, 1967); the immediate need for high-voltage mi- 
croscopes in biology vanished and the first megavolt instruments were not 
built for about another decade. The first of these was a 1.5 MV instrument 
constructed in Toulouse (Dupouy et al., 1960; Dupouy, 1968, 1985) and 
this was rapidly followed by a 750 kV machine in Cambridge (Smith et al., 
1966; Cosslett, 1981) and the commercial high-voltage microscopes of AEI, 
GESPA, Hitachi and JEOL. These were all giant versions of the familiar 
100 kV instruments, however, and essentially represented only technolog- 
ical progress; their optics was distinctly conservative. Their great bulk 
and the need for special buildings to house them did, however, furnish 
one of the reasons for the interest in superconducting lenses that sprang 
up in the mid-1960s, another being the perfect stability of the magnetic 
field generated by a coil in the persistent-current mode (Laberrigue and 
Levinson, 1964; Fern£ndez-Mor£n, 1965; Boersch et al., 1966; Siegel et al., 
1966; Ozasa et al., 1966). Of the various designs, the shielding lens intro- 
duced by Dietrich et al. (1969) is now used when it is important that the 
specimen and its immediate environment be at very low temperature (see 
Weyl et al., 1972; Hardy, 1973; Dietrich, 1976; Hawkes and Valdr~, 1977; 
Riecke, 1982; Lefranc et al., 1982). Students of superconducting lenses 
were not, however, alone in enquiring whether the focusing power of the 
monster lenses in traditional high-voltage electron microscopes could not 
be obtained in some other way. We draw attention to the numerous 'un- 

12 
1. INTRODUCTION 
conventional' designs introduced by Mulvey and colleagues, compared and 
contrasted in Mulvey (1982, 1984), and to the laminated lenses of Murillo 
(Balladore and Murillo, 1977), in which the yoke is made of highly inho- 
mogeneous material in order to maintain the flux density constant over its 
cross-section. 
The idea of forming an image not by irradiating a comparatively large 
specimen area and focusing this onto the image plane after suitable mag- 
nification but by scanning the specimen with a small probe and collecting 
a signal from the resulting interaction and using this signal to modulate 
the intensity of the spot of a cathode-ray tube scanned in synchronism goes 
back to the late 1930s. In 1938, yon Ardenne described a primitive ancestor 
of the modern scanning electron microscope, in which a probe size of some 
10 nm was achieved but at the cost of a very small current indeed (,-~ I pA); 
the beam traversed the specimen and struck a photographic film attached 
to a drum which rotated and advanced appropriately (see yon Ardenne, 
1978, 1985). In 1942, an instrument in which secondary electrons from a 
thick target provided the image signal was developed by Zworykin et al. 
but it was not until 1953 that McMullan described the first of the series of 
scanning electron microscopes to be built under Charles Oatley's direction 
in Cambridge, which culminated in the commercial 'Stereoscan', marketed 
by the Cambridge Instrument Company in 1965 (Oatley e~ al., 1965, 1985; 
Oatley, 1982, 1985). More recent versions of these instruments combine 
the properties of the X-ray microanalyser introduced by Castaing (1951) 
and perfected by Cosslett and Duncumb (1956) and Duncumb (195S), who 
added beam scanning, with the host of signals available in a scanning elec- 
tron microscope with the result that analytical electron microscopy (AEM) 
has become a discipline in its own right. 
The next major instrumental development occurred in the early 1960s. 
A celebrated set of curves (Oatley et aL, 1965) relating probe size, number 
of lines in the image and the time needed to record an image of accept- 
able quality had shown vividly that the resolution of the scanning micro- 
scope could never rival that of the transmission microscope owing to the 
inadequate performance of the thermionic gun. It was known that a field- 
emission gun would change this situation dramatically, making it possible 
to compress a useful current into a probe only a few £ngstr5ms in diameter, 
and it was in 1965 that Crewe first described a scanning transmission elec- 
tron microscope (STEM) with a field-emission gun (Crewe et al., 1968; 
Crewe, 1970, 1973). Instrumental development began in three companies, 
AEI, Vacuum Generators (VG) and Siemens, of which only VG continues 
to market STEMs; their first commercial instrument was installed in 1974. 
Those of Siemens and AEI were not pursued and the present tendency 
is to offer a field-emission gun and a STEM attachment as options with 

1.2 HISTORY 
13 
conventional transmission microscopes. 
The foregoing account evokes the main steps in electron optical instru- 
mentation for image formation. Many other innovations might have been 
listed: the development of new types of gun (lanthanum hexaboride and 
field emission) and the introduction of various types of energy filter and 
analyser, in particular the focusing device of Castaing and Henry (1962). 
We now turn to the theory of the subject and single out the principal con- 
tributions. We have already mentioned the role of Busch in the founding of 
geometrical electron optics. The ideas of Hamiltonian mechanics were ap- 
plied to electron motion by Walter Glaser, who derived expressions for the 
aberration coefficients with the aid of a characteristic function or eikonal, 
while Otto Scherzer obtained similar formulae by the 'trajectory method', 
in which equations of motion including aberration terms are derived and 
solved by the method of variation of parameters. In 1936, Scherzer pub- 
lished formulae for the coefficients of spherical and chromatic aberration 
that showed that these can never be made to change sign by skilful lens 
design; this result and the reactions to it are discussed in detail in Part IV. 
Eleven years later, it was again Scherzer (1947) who described several types 
of aberration correctors, capable in principle of cancelling these troublesome 
coefficients. The history of the 1950s is the history of attempts to use such 
correctors (see Chapter 41). Such attempts continue today, though this 
activity diminished considerably with the realization that digital process- 
ing of aberrated images might, indeed should, provide an easier solution. 
Scherzer's were not the only suggestions for aberration correction, however; 
in 1948, Gabor described a method of correcting spherical aberration by 
an optical reconstruction technique, which he called holography. For tech- 
nical reasons, this was unsuccessful at that time (the laser was yet to be 
invented) but with the development of bright electron sources and coherent 
light sources, both in-line and off-axis holography have subsequently been 
extensively developed, as we shall see in Volume 3. 
We must return to the 1940s and 1950s to draw attention to some other 
landmarks in electron optics. In 1943, Grinberg published a very general 
form of the equations of motion of electrons in electric and magnetic fields 
and this was later extended to include aberrations by Vandakurov (1955, 
1956). Similar general equations were derived by Sturrock (1952), who 
developed and perfected Glaser's Hamiltonian approach to electron optics 
in many ways (Sturrock, 1955), and by Rose (1968), who analysed a more 
limited class of systems. The labour of transforming aberration integrals 
was reduced by Seman (1951, 1954, 1955, 1958), who introduced a very 
ingenious method that replaces partial integration by differentiation. At 
about the same period, Lenz (1956, 1957) clarified the distinction between 
real and asymptotic aberration coefficients, already examined briefly by 

14 
1. INTRODUCTION 
Sturrock (1955). It was not until a decade later that the possibility of 
writing these asymptotic coefficients as polynomials of at worst fourth order 
in reciprocal magnification was noticed (Hawkes, 1968), an observation that 
renders computer-aided design of complex systems less arduous. The 1970s 
and 1980s have principally seen the application of sophisticated computing 
techniques in electron optics, and in particular to branches of electron optics 
that had perforce been almost completely neglected by earlier theoreticians: 
electron guns are the most striking example. Parts II, VI and IX bear 
witness to the progress that has been made, much of it in the theoretical 
electron optics group of the University of Tiibingen (Lenz, 1973; Kasper 
and Lenz, 1980; Kasper, 1982, 1984). 
This short account of the history of electron optics and electron mi- 
croscopes cannot but be invidious: we could have included all the other 
electron optical instruments and we could have charted the progress of the 
theory, equation by equation. This would, however, have left all too little 
space for the Principles of Electron Optics, to which we now turn. Refer- 
ences to many other accounts of the history of the subject are to be found 
in The Beginnings of Electron Microscopy (Hawkes, 1985). 

Part l 
Classical Mechanics 

This Page Intentionally Left Blank

2 
Relativistic Kinematics 
In the following sections we shall examine the motion of a charged parti- 
cle of rest mass m0 and charge Q in an electromagnetic field characterized 
by the electric and magnetic field vectors E(r, t) and B(r, t), respectively. 
Whenever the specialization Q = -e < 0 for electrons is not made explic- 
itly, the analysis is valid for the motion of any charged particle. 
The derivation of useful trajectory equations for the motion of charged 
particles--and of all conservation laws satisfied by them--can be performed 
in a very general and elegant manner by means of variational calculus, as 
we shall show in Chapter 4. First, however, we give a short introduction to 
relativistic kinematics, because this offers a better understanding of many 
of the optical aspects of the variational calculations. 
2.1 The Lorentz equation and general considerations 
The trajectory equation for the motion of charged particles is most simply 
represented in its Newtonian form 
dg - d 
= Q{E(v,t) 
+ v x B(v, t)} 
(2.1) 
v = dr/dt being the velocity and g = my the kinetic momentum, which 
must be clearly distinguished from the canonical momentum, defined in 
Chapter 4. The Lorentz force, given by the right-hand side of (2.1), is ex- 
pressed in SI units, which will be used consistently throughout this volume. 
It is convenient to introduce the familiar abbreviations 
v 
I*1 
1 
/3"- 
- 
, 
7- 
(2.2) 
¢ 
¢ 
X/1 _/~2 
whereupon (2.1) has the correct relativistic form if we represent the rela- 
tivistic mass m by the weU-known expression 
m0 
m - 
- 7mo 
(2.3) 

18 
2. RELATIVISTIC KINEMATICS 
The trajectory equation does not depend on the values of Q and m0 sepa- 
rately but only on the ratio Q/mo as can be seen by rewriting (2.1) thus: 
dt 
,,/1 
- 
In the special case of electron motion, we have 
Q = -e = -1.602 x 10-19C 
--e-e = 1.759 x Iollc kg -1 
(2.4) 
mo 
The absolute value of the electron charge will always be denoted by e. 
The practical evaluation of (2.1) requires the calculation of the field 
vectors E(r, t) and B(r, t) for arbitrary values of the position vector r and 
of the time t. The corresponding computer programs have to be written 
and executed before embarking on trajectory calculations. 
In practice, 
field calculation is the most complicated part of theoretical electron and 
ion optics. We shall deal with this subject in detail in Part II. In the present 
chapter we shall assume the fields to be known. 
In the most general case of arbitrary electron optical devices, (2.1) can 
only be solved numerically, from given initial conditions. In order to de- 
rive more detailed laws, it is necessary to introduce simplifying symmetry 
conditions, which are assumed to be exactly valid. The inevitable depar- 
tures from exact symmetry in practical devices will be discussed in later 
chapters. 
2.2 Conservation of energy 
In most electron and ion optical devices the applied fields are static, inde- 
pendent of time: E = E(r), B = B(r). It is then possible to derive a law 
for the conservation of particle energy. This is most easily done by scalar 
multiplication of both sides of (2.1) with v. We shall denote derivatives 
with respect to time by dots. Using (2.2) and (2.3) we obtain first 
d(mov) 
" 
a-i 
- # 
= Q " " E ( ,. ) 
(.=÷) 
Using the identity v. i~ = vz3, the left-hand side can be transformed to a 
total derivative: 

2.3 THE ACCELERATION POTENTIAL 
19 
In order to transform the right-hand side, we introduce the electrostatic 
potential (I)(r) and write 
E(r) = -grad (I)(r) 
(2.5) 
The right-hand side then becomes a total derivative too: 
d 
Qv. E(r) = -Q/'. grad ,I,(r) - --7: (Q(I,(r)) 
a/;- 
- 
Integration with respect to time and substitution for the factor 7 results 
in: 
E° "- m°c2 ( 
1 
) 
x/1 _ Z 2 - 1 
+ Q(I)(r) = const 
(2.6) 
The first term is the kinetic energy 
1 
T(v) := moc 2 X/1 - 
-1) 
(2.7) 
A power series expansion in v gives 
re°v2( 
3fl2 
5 4 
) 
T(v)=--~-- 
1+~ 
+g/~ +... 
the first term being the familiar nonrelativistic approximation. The second 
term in (2.6) is the usual potential energy of classical mechanics, 
V(r) := Q(I)(r) 
(2.8) 
The functions O(r) and hence V(r) are unique apart from the choice of an 
arbitrary additive constant. The total energy E0 depends on the choice of 
this constant and on the initial conditions of the trajectory in question, a 
trivial point in theory but important in many practical situations. 
2.3 The acceleration potential 
For practical calculations, it is of great importance that virtually all scalar 
kinetic quantities can be represented as unique functions in space, the 
constant E0 being a free parameter. The electrostatic potential (I)(r) is 
uniquely defined by its boundary values at the surfaces of the electrodes. 
In electron optics, the cathode surface in the electron gun is usually chosen 
to be the equipotential surface (I)(r) = 0. In this volume we shall adopt 

20 
2. RELATIVISTIC KINEMATICS 
this most convenient gauge. The constant E0 then has a very concrete 
physical meaning: it is the initial kinetic energy of the corresponding elec- 
tron trajectory at the cathode surface. This is a small positive quantity of 
the order of an electronvolt. The simplification E0 = 0, common in the 
literature on electron optics, is too strong a restriction, since this excludes 
the treatment of energy distributions in electron beams. Here, therefore, 
the convention E0 = 0 will be adopted in all practical calculations in which 
the electron energy distribution is not in question. In the remainder of the 
present chapter, however, the analysis will be completely general. 
Once the function (I)(r) and the constant E0 have been specified, all 
the other scalar functions are uniquely defined. The kinetic energy is given 
by 
T(r, E0) = E0 - Q(I)(r) 
(2.9) 
Since T can be rewritten as T = m0c2(7- 1), the dilatation factor 7 is a 
function of position: 
1 
- 1 -t- Eo- 
Q~(r) 
(2.10) 
7(r' E°) = ~/i -/~2 
moc 2 
Equation (2.9) also determines the absolute value of the kinetic momen- 
tum, Igl = g(r). In order to find the corresponding function, we first solve 
g = m0v(1-/~2)-1/2 for v = v(g) and then substitute the resulting expres- 
sion in (2.7), which yields the well-known formula 
moc 2 + T - c~/(moc) 2 + g2 -- mc 2 
(2.11) 
This expression will prove to be of great importance in the Hamiltonian 
theory. Here we solve (2.11) for g and obtain 
g - Igl = 
moT 
1 + 2m0c 2 
Substituting for T from (2.9), we find 
~2m ( 
Eo-Q~(r) 
o 
) 
By means of (2.10) and (2.13), the absolute value of the velocity can also 
be determined as a function, v(r, E0) = g/moT. 
In the nonrelativistic 
approximation (2.10), (2.13) and the expression for v simplify to the well- 
known formulae 
"/~ 1 
, 
g ~-, x/2m0(E0 - Q(I)) 
, 
v ~-, 
(E0 - Q(I)) 
(2.14) 

2.3 THE ACCELERATION POTENTIAL 
21 
Since the kinematic functions will be required very often in electron optical 
calculations, we introduce certain quantities to simplify the notation: 
'I'o := Eo/e 
e 
e := 
= 0.9785 MV -z 
2m0c 2 
,7 := 
= 2.965 x 105C½ kg-½ 
(2.z5) 
(2.z6) 
(2.17) 
Equation (2.13) now becomes 
g(r, E0) = v/2m0e(@0 + @){1 + e(@0 + ~)} 
Since the radicand will be required very frequently, it is convenient to 
introduce a new function 
6(,, ¢0):= (¢0 + ¢(,)){~ + ~(¢0 + ¢(,))} > 0 
(2.zs) 
called the acceleration potential. The circumflex^will be added to all func- 
tions and constants defined in terms of ~ rather than ~. It is now possible 
to express all the other kinematic functions in terms of ~. Obviously 
g = ~/2rn0e~ 
(2.19) 
On substituting this in (2.11), we find 
T=m0c 2 
l+4e~-I 
=- 
(2.20) 
Since T = m0c2(7-1), the dilatation factor 7 can be expressed as a function 
of ~ or ~: 
7 = V/1 + 4e~ = 1 + 2e{~(r)+ ¢0} 
(2.21) 
Using (2.19), (2.21) and (2.17), the velocity becomes 
/ 
v _= 
g 
= 2,/1 ] 
(2.22) 
m07 
vl + 4e~ 
Even the electric field strength E can be expressed in terms of ~ and its 
gradient: differentiation of (2.18) results first in 

22 
2 RELATIVISTIC KINEMATICS 
From (2.21), we see that the factor multiplying V(I) is equal to 7, so that 
finally 
v 
E = -1V4 
= -(1 + 4e4)-½V~ = ~Vg 
(2.23) 
7 
the last form being always valid in static fields. 
Thus no independent 
kinematic function other than ~(r, ~0) is needed. The gain obtained by 
this simplification will be obvious later. In order to lighten the notation, 
we shall omit the argument &0 whenever we are not concerned with energy 
distributions and chromatic effects. 
2.4 Definition of coordinate systems 
Many of the subsequent calculations are most favourably carried out by 
explicit representation in some suitably chosen coordinate system. In order 
to avoid repetition, we introduce general definitions and standard notations 
here, which we shall use consistently provided there is no risk of confusion. 
Any necessary changes of the notation will be mentioned explicitly. 
Cartesian coordinates are denoted by (x,y,z) or by subscripts 
(Xl, x2, x3); the cartesian components of any vector and the unit vectors 
i in the three cartesian directions will always be indicated by the corre- 
Sponding subscripts. Even when using orthogonal curvilinear coordinates, 
the unit vector indicating the direction of the gradient of the coordinate in 
question will be denoted by i and the corresponding subscript. Examples 
are given below. In sums of cartesian products, the familiar summation 
convention will be used wherever this does not cause confusion. 
Any vector a is thus represented by the equivalent notations 
3 
a = axi~ + a~iy + azi~ = E 
ajij = ajij 
(2.24) 
j--1 
and scalar products are written 
3 
a. b = E 
ajbj = ajbj 
(2.25) 
j=l 
As well as cartesian coordinates, we shall need cylindrical coordinates 
(z, r, ~0) and spherical coordinates (R, _G, ~). All these coordinate systems 
are related by the familiar transformations 
x = R sin 0 cos ~p = r cos 
y = R sin 0 sin ~ = r sin T 
(2.26) 
z=Rcos0 
, 
r=Rsin 
O<r<R 
, 
0<O<Ir 
, 
0<~0<27r 

2.4 DEFINITION OF COORDINATE SYSTEMS 
23 
The choice of notation for the spherical coordinate R is unusual but spheri- 
cal coordinates are very rarely used in electron optics. The only important 
case is the treatment of cathode tips (Chapter 45). Cylindrical coordinates 
are very frequently used and the corresponding notation is as simple as 
possible. 
The element of length, ds, is given by 
ds 2 - dx 2 + dy 2 + dz 2 
= dz 2 + dr 2 + r 2 dqa 2 
= dR 2 + R 2 dO 2 + R 2 sin 2 vgd~p 2 
The position vector in particular is given by 
r = xiz + yiv + Ziz = Ziz + rir = RiR 
(2.27a) 
and the velocity by 
v - ~ = ~i~ + ~liy + ~i~ = ~iz + ÷i~ + r~i~ 
(2.27b) 
= RiR + R(gio + R sin tg#i~ 
The components of arbitrary vectors, characterized by the corresponding 
subscripts, have the value of the corresponding projections; for example, 
if a = aRiR + aaio + a~i~, then aR = a . iR. 
This is clearly different 
from the familiar, but less convenient, covariant formalism, which we do 
not need here. A simple consequence of our definitions is that 
2 
2 
2 
2 
2 = a 2 + a0 + 
(2.28) 
]a] 2 = ajaj = a z + a r + a~ 
a~ 
No metric tensor is needed in this context. To facilitate the evaluation 
of vector products, it is useful to remember that the basic vectors, i z, i~, 
i~ and in, i0, i~ respectively, form positively orientated orthonormalized 
bases. 
In order to avoid giving explicit cartesian representations of vector 
differentiations in different vector spaces, we introduce the familiar abbre- 
viation 
0 
0 
0 
0 
0 
0---u := i ~ -~u ~ + i ' -~u y + i Z -~u ~ = i j O u j 
(2"29/ 
for differentiation in the space in question. Ordinary vector differentiation 
is denoted by V 
"= O/Or. 
Some common representations in cylindrical 
coordinates are as follows: 
0 
0 
10 
V = i~z z + i,.~r r + i, a 
(2.29a) 
r 0~ 
0 2 
02 
1 0 
1 
02 
V 2 - 
+ 
+ - 
+ 
(2.29b) 
-- 
0Z 2 
~r 2 
r Orr 
r 2 0~ 2 

24 
2. RELATIVISTIC KINEMATICS 
These are extensively used in Part II. Partial derivatives are denoted in 
various different ways, as shown in the following examples: 
02V 
O~ 2 - O~V - yl~ 
02V 
- O~yy = yi,y 
OxOy 
Expressions of this kind will appear intermittently in later chapters. 
2.5 Conservation of axial angular momentum 
This conservation law may be obtained very elegantly by use of the La- 
grange formalism but the subsequent elementary presentation brings out 
clearly its physical meaning. 
We now assume that the electron optical device is rotationally sym- 
metric about an optic axis. This assumption is valid in all perfect round 
lenses and mirrors. The fields in these devices are usually also static, but 
this additional assumption is not necessary. The following considerations 
remain valid in time-dependent systems and in ion optics. As everywhere 
in physics, the conservation of axial angular momentum is a direct conse- 
quence of the assumption of rotational symmetry. 
On forming the vector product of r with (2.1), we see that the ex- 
pression on the left-hand side is the derivative of the familiar mechanical 
angular momentum vector: 
d 
(E+v 
~(mr × v)= Qr x 
x B) 
(2.30) 
On the right-hand side, only the component parallel to the axis can be 
represented as a total derivative, and we therefore confine our attention to 
the evaluation of this component. 
In view of the assumed symmetry, we may anticipate that cylindrical 
coordinates (z,r,~o) will be most appropriate, the z-axis coinciding with 
the optic axis. The axial component of (2.30) then becomes 
d(mr2~b) = Qr{E~ + (v × B)~} = Qr(E~ + kBr - i'Bz) 
dt 
(2.31) 
In order to transform the expression on the right-hand side into a total 
derivative with respect to time, it is necessary to introduce the magnetic 
fluz function ~(z,r,t). This is defined as the magnetic flux through a 

2.5 CONSERVATION OF AXIAL ANGULAR MOMENTUM 
25 
trajectory 
7 
G \ 
z 
\C 
Fig. 2.1" Trajectory of a charged particle; a coaxial circular disc C is associated with 
an arbitrary point P with coordinates (z,r,~;t). This circle travels along the axis and 
its radius varies as the point P moves along the trajectory. 
coaxial circular disc C, located in a plane z=const and of radius r. The co- 
ordinates (z, r, qa) specify the instantaneous position of the charged particle 
on its trajectory. This is illustrated in Fig. 2.1. 
This function ~(z,r,t) is easily evaluated by expressing the surface 
element da = da iz = 27rr'dr'iz in cylindrical coordinates, giving 
• (z, r, t):= / B. da = 27r t r'Bz(z, r', t)dr' 
(2.32) 
c 
0 
Differentiation with respect to r gives immediately 
1 0~ 
B (z, 
t) = 
Or 
(2.33) 
Using the condition div B = 0, the second representation 
1 0~ 
Br(z,r,t) = 
2rr Oz 
(2.34) 
can be derived (see Section 6.4). Finally the integral induction law f E. 
dr = -0~/0t, applied to the circumference of the disc C, results in 
1 0~ 
E~(z, r, t) = 
27rr Ot 
(2.35) 
Introducing (2.33), (2.34) and (2.35)into (2.31) we obtain: 
d 
(2.36) 
d---t ( m r 2 ~ ) = -- 
~ 
+ ?~ -~z + ÷ -~r 
= 
27r dt 
Integration with respect to time leads to the conservation law for the axial 
angular momentum: 
mor2~ 
Q 
t) 
const 
(2.37) 
N := ~/1 - f12 + 
~(z,r, 
= 

26 
2. RELATIVISTIC KINEMATICS 
This expression differs from that familiar in classical mechanics by the 
presence of the important second term, which contains the electromagnetic 
interaction in integral form. Its physical origin and meaning appear very 
clearly on comparing (2.31) with (2.36). The electric torque, QrE~, is 
an induction effect in a fixed loop (specified by z and r). The magnetic 
part of the torque, Qr(v x B)~, is the corresponding induction effect in a 
loop moving with the particle and is hence a consequence of the implicit 
variation of • with time: -Qv. V~/2~r. This latter part remains nonzero 
even in static magnetic round lenses where it forces the particle beam to 
rotate about the optic axis, a fact of great importance in the physics of 
magnetic lenses. 
In the vicinity of the optic axis, this rotation is of most interest 
and can be easily calculated. 
In a sufficiently small paraxial domain, 
the magnetic field can be considered as radially homogeneous; the mag- 
netic flux is then • = ~rr2B(z,t), the function B(z,t) being the axial 
flux density. Furthermore, we have ÷2 + r2~2 << ~2. From (2.37), with 
m(z,t) = m0(1- ~2/c2)-1/2, we then obtain 
{ 
1 
} 
N = 
+  
QS(z, t) 
We now confine our considerations to trajectories that intersect the optic 
axis at some point. For such trajectories, N vanishes and we obtain 
OB(z,t) 
(2.38) 
= - 2m(z, t) 
This is the local and instantaneous value of the familiar Larmor frequency. 
In the important case of electron trajectories in static round lenses, it 
is convenient to represent the azimuth as a function of z. On the optic axis 
the relation 
=  /2m0  0(z) 
is satisfied, ¢0(z) being the axial acceleration potential. Using d~/dz = ~o/~ 
and integrating with respect to z we find 
~o(z) = 71 f ¢o ½ (z')B(z')dz' + ~(z0) 
z0 
(2.39) 
In Part III we shall show that the trajectory equations simplify considerably 
in a coordinate system that is twisted round the optic axis by this local 
angle of rotation. 

3 
Different Forms of TraJectory Equations 
The Lorentz equation (2.1) is generally valid but not always convenient. In 
very many practical applications, expressions for the trajectories of the form 
r = r(t) are of no interest; it is their geometrical shape that is required. 
In devices in which the fields E and B depend explicitly on the time, 
it is rarely possible to eliminate the latter from the trajectory equation. 
We therefore confine the following discussion to systems with static fields. 
In order to avoid repetition, we shall give here only those forms of the 
trajectory equations that cannot (or at least, only with greater difficulty) 
be derived from variational principles but are yet of practical importance. 
3.1 Parametric representation in terms of the arc-length 
The differential arc-length is given by ds := Idrl = vdt. The transformation 
of the differential operator is hence given by d/dt = v d/ds. Introducing 
this into (2.1) and noting that v/v = dr/ds, we obtain 
dg 
QE 
dr 
--- 
+Q 
×B 
ds 
v 
ds 
It is now of great importance that v and g = mv are unique functions of r, 
as explained in Chapter 2. Thus the time is already eliminated. By means 
of (2.23), the electric field vector can also be eliminated, giving 
d~ g(r)-~s 
= grad g(r) + 
ds x B(r) 
(3.1) 
In the absence of the magnetic term, this trajectory equation is even valid 
for the propagation of light in matter provided that the geometric approxi- 
mation is adequate (see e.g. Born and Wolf, 1959 eq.(3.2.2); Kasper, 1972). 
In this case the kinetic momentum is given by g = hkon(r, ko), ko being 
the mean wave number (27r/wavelength)in the vacuum and n(r, ko) the 
corresponding index of refraction in the material; h = h/2~r is Planck's 
constant. Hence (3.1) is a very general trajectory equation. 

28 
3. DIFFERENT FORMS OF TRAJECTORY EQUATIONS 
Some useful relations can be derived from (3.1) by calculating its com- 
ponents with respect to the orthonormal basis vectors 
dr 
dt 
b = t x n 
(3.2) 
t:= d"s- ' 
n:= Rds 
, 
the local tangent, principal normal and binormal respectively, R being the 
(positive.) radius of curvature. Scalar multiplication of (3.1) with each of 
these unit vectors in turn, using dg/ds = t. grad g and some elementary 
vector operations, yields: 
g 
Qb B-Q(n 
E/v 
b B) 
= n. grad g .
.
.
.
.
 
0 = b. grad g + Qn. B- 
Q(b. E/v + n. B) 
(3.3) 
(3.4) 
In a purely magnetic field (E - 0), (3.4) shows that the vector n is always 
orthogonal to B. From (3.3) the (absolute) curvature is found to be 
_-1 
Q 
1 
-=b. B - -[Qt x BI 
(3.5) 
R 
g 
g 
For electrons the curvature can be rewritten with the aid of the formulae 
0f Section 2.3 as 
1_ 
u ItxSl 
(3.6) 
R - 
,,/-g 
where Lr .= ~ is now a constant acceleration potential. Equation (3.1) then 
simplifies to: 
dr 
d2r _ 
r/ B(r) x 
(3.7) 
ds 2 
~ 
ds 
For the circular motion of charged particles in a homogeneous magnetic 
field the familiar relation 
BR = glQ1-1 
(3.7a) 
is a simple consequence of (3.5). This 'BR-product' is of great importance 
in the design of spectrometers and analysers (see Part X). 
In a purely electrostatic field the binormal b is always orthogonal to 
E, and (3.3) can then be rewritten in the familiar self-evident form 
my 2 
R 
= IQE.I = QIt × El 
(3.8) 
The dependence of the left-hand side on the acceleration potential can be 
obtained by use of the kinematic functions, given in Section 2.3. 

3.2 RELATIVISTIC PROPER-TIME REPRESENTATION 
29 
3.2 Relativistic proper-time representation 
The arc-length is a highly unsuitable trajectory parameter for numerical 
trajectory computations in electron guns and mirrors, since the radius of 
curvature varies over an extremely wide range of values. This implies that 
the integration step length As must also vary considerably. The time would 
be a much better parameter but has the disadvantage that the range of 
values is now too small. Other parametrizations such as that of Kel'man 
et al. (1972, 1973) are of specific interest for mirrors. These will be dealt 
with in Chapter 18. 
A favourable parameter, which exhibits none of the disadvantages men- 
tioned above and is very advantageous, particularly in the numerical inves- 
tigation of electron guns, is defined by (Kasper, 1985): 
da = u ~/1 - ~2 dt = udt' 
(u = const ) 
(3.9) 
dt' being the relativistic proper-time 
element, observable in' the frame 
of reference of the electron. 
The observable nature of the proper-time 
element is, of course, purely abstract, but the trajectory equation can be 
slightly simplified by introducing (3.9). A particularly suitable choice of 
the constant factor u is 
= 
¢-g 
u= 
/.J 
277 
the second constant U being the acceleration potential at some suitably 
chosen fixed point of reference. From (3.9) and (3.10), it is obvious that u 
has the dimensions of a speed and thus da that of a length, though da is 
proportional in magnitude to dt'. 
Equation (3.1) can now be straightforwardly transformed by means of 
the operator relation 
1 
d 
d 
~ 
~ 
U
~
 
x/1 -/~2 dt 
d~ 
The kinematic momentum is given by 
dr 
V 
z/~ 
eO dr 
g = mou-~a = 
mo 
da 
(3.11) 
which is already a simplification, since the factor before the derivative is 
now a constant, rather than a complicated function. Multiplying by the 
factor 3' = (1 - ~2)-1/2 and using the relations given above, the Lorentz 
equation (2.1) for electrons (Q = -e) now transforms into 
d2 r 
dr 
m0 u2 da 2 -- -eTE -4- eB x d--a 

30 
3. DIFFERENT FORMS OF TRAJECTORY EQUATIONS 
The electric term is eliminated by means of (2.23). Using (3.10) we obtain 
finally 
d2r -
2
-
(
)
d
r
~
(
r
)
 
= 
1grad 
B(r)x -- 
(3.12) 
The normalization constant U can be set arbitrarily to any positive value. 
In devices having an asymptotically field-free domain, we may choose any 
reference point R0 located in this domain: r) = ~(R0). This implies that 
da = ds in that domain. In an electron microscope a good choice for the 
reference point R0 is the centre of the recording screen. Then (~(R0) is 
usually the maximum of ~. Without loss of generality, the starting point 
of each electron trajectory at the cathode surface may be the point with 
a = 0. The final value of a is then slightly longer than the length L of 
the device, roughly ama, "~ 1.5L. There is thus no need for any special 
precautions to avoid inconvenient scales. 
The conservation laws for energy and axial angular momentum can 
also be represented in a very convenient form. By scalar multiplication of 
(3.12) with dr/da and integration with respect to a we find 
I dr 12 ~(r) 
(3.13) 
With the conventions adopted in Section 2.3, the constant of integration 
must be zero. 
For motion in static fields, (2.37) can be simplified with the aid of 
kinematic functions, the result being 
r2dqo 
dy 
dx 
rl (N 
~(z, r)) 
- 
-- + ~ 
(3.14) 
These conservation laws are useful as additional checks of the accuracy in 
numerical computations. In practice, the evaluation of (3.12) has proved 
to be the most successful method of calculating Lorentz trajectories. 
3.3 
The 
cartesian 
representation 
The various representations of the trajectory equation derived hitherto are 
suitable for calculating individual trajectories from given initial conditions 
but they are hardly suitable for developing a systematic theory of focusing 
and aberrations. For this, a cartesian representation x = x(z), y = y(z) 
is preferable. Such a formalism is possible if the electron optical device in 

3.3 THE CARTESIAN REPRESENTATION 
31 
question has a straight optic axis, if q) >~ 20 eV and if the slopes x'(z), y'(z) 
of all trajectories remain finite. The last two conditions are not satisfied in 
electron guns and mirrors and it is for this reason that there is at present 
no entirely satisfactory theory of the aberrations in these devices. 
In what follows, we shall use the explicit cartesian representation (2.27) 
with x = x(z), y = y(z). Differentiation with respect to z will be denoted 
by a prime, thus 
ot(z) = r'(z)= x'(z)ix + y'(z)iy + iz 
(3.15) 
Since It[ = 1, the absolute value of r ~ is: 
e := L 'I = 
+ 
+ 
(3.16) 
This function has a very simple geometric meaning: 0 -1 = t. iz - cos a, 
a being the angle between the local tangent and the optic axis. This holds 
even for skew trajectories. 
The required cartesian representation of the trajectory equation is 
most easily obtained by substituting 
d 
dz d 
ld 
ds 
ds dz 
0 dz 
in (3.1), giving 
01 d 
(g_dr)dz 
zaz 
Qr' 
-7- 
-gradg+-- 
xB 
0 
Expanding the derivative on the left-hand side yields 
+ ---7- 
-- grad g + -- 
x B 
0 
(3.17) 
Q d (g) 
azOg Q 
B) 
(3.18) 
= -z-- + - 
i~ .(r' 
x 
o 
is therefore dependent on the first two and may be omitted. In fact, it is 
possible to derive the x- and y- components of (3.17) directly from a two- 
dimensional variational principle but not (3.18). Here we shall use (3.18) 
to simplify (3.17) by eliminating the second term. Multiplying (3.18) by r' 
and subtracting the result from (3.17), we find 
g---r" 
r 'Og 
Q{r' 
B) r'} 
02 
-- grad g - 
~zz+-~ 
x B-iz.(r' 
x 
These are three scalar differential equations for the two functions x(z), 
y(z); the third equation 

32 
3. DIFFERENT FORMS OF TRAJECTORY EQUATIONS 
The third component of this is a trivial identity. The two components of 
interest are given explicitly by 
X tl 
g -~x - 
-~z + 
yÁ(Bz + x'B,,)- B,(1 + 
) 
yU _ ~2 
The magnetic terms can be rewritten in a more compact form by introdu- 
cing the tangential component of B: 
Bt := t. B = !(Bz + x'B= + y'B,) 
(3.19) 
and we finally obtain 
" 
oB,) 
y" 
g2 ( Og - y ' Og ) 
O g 2 
= g 
N 
N 
+---~--(-x'Bt+gB,) 
(3.20) 
These trajectory equations are valid for all charged particles, provided that 
the conditions mentioned above are satisfied. With Q = 0 and g = hk0n(r), 
they are even valid for light rays, n(r) being the optical index of refraction. 
The vacuum momentum hk0 cancels out and we obtain the ray equations 
" 
x' 
-- 
(3.21) 
X 
~ 
~ 
-- 
~ 
--- 
"~Z 
For electron trajectories, (2.19) and (2.17) may be used, whereupon (3.20) 
become 
X tt ~ 
~ 
-- 
X t 
yIBt) 
y" 
g2 C O' - y' C3' ~ 
~rlg2 
x' Bt) 
= F4 ,, 
-5;z 
+ 
/ + ( - B= + 
(3.22) 
These trajectory equations are equally well suited for the numerical com- 
putation of individual trajectories and for the development of a systematic 
theory of focusing and aberrations. It must be emphasized that only the 
existence of a straight optic axis is required, not rotational symmetry about 
this axis. Thus not only can round lenses be considered here, but also stig- 
mators, systems of multipole lenses and deflection units such as saddle coils. 

3.4 SCALING RULES 
33 
3.4 Scaling rules 
A number of simple scaling rules can be derived for trajectories in static 
fields. Since the time-dependent form of the trajectories is now of no inter- 
est, we confine the discussion to the time-independent form. Scale changes 
are most easily performed on (3.1). We shall consider only two very im- 
portant special cases. 
For purely electrostatic fields, (3.1) becomes linear in g(r), which 
means that (3.1) is unaffected by a scale-transform g(r) = gog*(r) of the 
kinematic momentum. Any experimental change of scales, however, is made 
by alteration of the electrode potentials and this affects the kinematic mo- 
mentum only indirectly. From (2.13), it is obvious that a simple rule can 
only be expected in the nonrelativistic case [E0 -Q~(r)[ << moc 2. Since 
the initial energy E0 is not constant in a particle beam, a unique change 
of scale common to all the particles is only possible if E0 << IQO[. For 
electrons and negatively charged ions, (2.13) then simplifies to: 
g(r)- ~/2mo}Ql(I,(r) 
, 
(I) __ 0 
(3.23) 
which is only valid sufficiently far from the cathode. In these circumstances, 
a linear scale transform ~(r) = U0~*(r) of the potential is equivalent to 
such a transform of the kinematic momentum, the relation between the 
scaling factors being given by go - U0 ~/2. Introducing (3.23) into (3.1), the 
factor (2mo[Q[) 1/2 is seen to cancel; the trajectory equation then simplifies 
to 
d--~ 
~ss 
- grad X/O(r) 
(3.24) 
which can be rewritten as 
} 
(3.25) 
= 
× 
× 
Here the relation dO/ds - (dr/ds). V¢ has been used. This trajectory 
equation is linear in ~(r). A linear scale change ~ = U0~* can be per- 
formed most easily by alteration of all the electrode potentials by the same 
factor, the cathode being ~* = 0. From (3.25) it is obvious that the geo- 
metric shape of the trajectories depends neither on Q and m0 nor on the 
scale factor U0. These constants affect only the time of propagation, which 
is of little interest. 
These conclusions are together known as the electrostatic principle, 
which also holds for positively charged particles, provided that ~(r) is 
replaced by }~(r)[ and ~(r) = 0 is now the emitting anode surface. In 

34 
3. DIFFERENT FORMS OF TRAJECTORY EQUATIONS 
practice, a consequence of this principle is that an electrostatic microscope 
can be operated with different kinds of particles and fixed ratios of the 
voltage differences between the acceleration electrodes and the source. 
The consequences of a geometric scale change can also be derived from 
(3.25). A transform 
r = at* 
, 
s = as* 
, 
~*(r*) = q~(r)U0 
(3.26) 
does not affect the geometric shape of the trajectories, since (3.25) is invari- 
ant with respect to (3.26).The magnitude of the trajectories is proportional 
to the distances between the electrodes if the shape of the field is unaltered. 
In purely magnetostatic devices the solutions of the trajectory equa- 
tions depend on Q/mo. 
We shall confine our considerations to electron 
motion; we must then investigate the effect of scale changes on (3.7). The 
constant U will now be the relativistic acceleration potential. Introducing 
the scale transforms 
r=ar* 
, 
s=as* 
, 
0=U0/)* 
, 
B(r)=BoB*(r*) 
(3.27) 
into (3.7) we find that this trajectory equation remains invariant if the 
condition 
/_--- 
aBo = ~/U0 
(3.28) 
is satisfied. This can be put into a more practical form by introducing 
scales for the field-producing currents. The magnetic field strength B is 
related to the electric current I by an expression of the form B = I~I/l, 
l being some typical length and # a permeability. An appropriate scale 
transform is now given by 
B=BoB* 
, 
I=IoI* 
, 
l=al* 
, 
aBo=-To 
(3.29) 
which must be compatible with (3.27). Equation (3.28) now simplifies to 
102 - ~r0 
(3.30) 
This simple scaling rule is of great importance in the practical design of 
magnetic lenses. 

4 
Variational Principles 
All our analysis has so far been based on the Lorentz equation (2.1). This 
equation is, however, identical with the Euler-Lagrange equations of Hamil- 
ton's variational principle which may hence be regarded as more fundamen- 
tal. This principle may be stated thus: 
tl 
W := f L(r, v, t) dt = extr. 
to 
(4.1) 
where 'extr.' denotes an extremum or at least a stationary value. The 
necessary constraints are that to, tl, r(t0) and r(tl) remain fixed and that 
the variable of integration must not be varied: 5t = 0. 
4.1 The Lagrange formalism 
In charged particle dynamics the integrand L, the Lagrangian, takes the 
form 
L = moc2(1 - ~/1 - ~) + Q(v. A - ~) 
(4.2) 
~(r, t) and A(r, t) being the electromagnetic potentials (e.g. Goldstein, 
1959). These are related to the field vectors E and B by 
B(r, t) = curl A(r, t) 
(4.3) 
0 
E(r, t) = -grad ¢(r, t) - ~A(r, t) 
(4.4) 
These relations do not provide a unique definition of the potentials; in other 
words, the same field vectors E and B may be obtained from different sets 
of potentials. The consequences of adopting different gauges for ¢I, and A 
are discussed in Section 5.5. Since only E and B have physical significance, 
but not ~ and A, the results of all calculations should be presented in a 
gauge-invariant form. 
It is convenient to rewrite the Lagrangian, L (4.2), as L = T* - V* 
with 
T*(v) := m0c2(1 - V/1 - ~2) 
(4.5) 
V*(r,v,t) :=Q{~(r,t)-v.A(r,t)} 
(4.6) 

36 
4. VARIATIONAL PRINCIPLES 
since this closely resembles the familiar classical form L = T- 
V. The 
function T*(v), known as the kinetic potential, is closely related to the 
kinetic energy T, by T* = T(1- ~2)1/2 (see 2.7). The function V* is 
a generalization of the familiar potential energy V (2.8), since it is now 
velocity-dependent. 
Since there are no geometric constraints in charged particle dynamics, 
we adopt cartesian coordinates. The Euler-Lagrange equations 
d5 
Oxj = 0 
(j = 1, 2, 3) 
(4.7a) 
are obviously equivalent to 
or* 
d--i \ Ov~ 
= ~i \ Ov~ ] 
o~ 
(4.7b) 
Performing the differentiations on the left-hand side, we first obtain 
tiT* 
mo v 
= 
= 9(v) 
dv 
~/1 - ~2 
(4.s) 
But Ov/Ovj = vj/v and so 
OT* 
dT* Ov 
movj 
= 
- 
=gj 
, 
j-1,2,3 
Ovj 
dv 
Ovj 
X/1 - f12 
This result is obviously the cartesian representation of the well-known ex- 
pression for the kinematic momentum. By using (2.29) with u = v, the 
kinematic momentum can be rewritten as 
OT* 
mo v 
g(~) - 
0~ 
= 
~/~ _ ~ 
(4.0) 
and (4.7b) as 
(or') 
or" 
=: F 
(4.10) 
We now evaluate the expression ]7 on the right-hand side: 
OV* 
OV* 
Ov 
QA 
, 
Or 
0 
A) 
= QV~ - Q-~r(v . 
and thus 
dA 
F= Q 
dt 
0 
A)) 
v¢ + ~(~. 

4.1 THE LAGRANGE FORMALISM 
37 
The total derivative dA/dt is given by 
d 
OA 
0__0_ A 
OA 
d--~A(r(t), t) = -~ + ~j Oxj 
- ~ 
+ (v. V)A 
We now make use of the vector identity 
v x curl a(r) = grad v. A(r) - 
(v. V)A(r) 
valid for any constant v and any vector function A(r). (This may easily be 
verified by writing the terms out in cartesian coordinates or, more simply 
still, by introducing tensor notation.) Recalling that v is to be treated as 
a constant in differentiations with respect to r, we find 
( 
0A 
) 
F=Q 
-V(I)--~+vxcurlA 
Substituting for E and B from (4.4) and (4.3), we obtain finally 
F:=~k. 
Ov ] 
Or = Q(E + v x B) 
(4.11) 
which means that the Lorentz force is the functional derivative of the gen- 
eralized potential V* given by (4.6). Equation (4.10) in combination with 
(4.11) is identical with (2.1). 
This calculation is only slightly longer than the usual derivation of 
the Lorentz equation by direct evaluation of (4.7a) without making the 
separation L = T* - V*, but it brings out clearly the physical meaning 
of the various expressions since it uses as few gauge-dependent quantities 
as possible. The direct evaluation of (4.7a) leads, as a first step, to the 
definition of the canonical momentum 
OL 
PJ'- 0~j 
, 
j-1,2,3 
or, in vector notation and using (4.2) 
OL 
p = ~ 
= g + QA(r, t) 
(4.12) 
Though familiar and frequently used in theoretical physics, this quantity 
has no physical meaning as an observable, since it is gauge-dependent. 
A great advantage of the variational calculus is the fact that the value 
of the integral appearing in (4.1) is invariant with respect to transforma- 
tions of the coordinates and of the variable of integration. Since it is usually 

38 
4. VARIATIONAL PRINCIPLES 
easier to perform these transformations on the Lagrangian than on the cor- 
responding Lorentz equation, new forms of trajectory equations can be de- 
rived straightforwardly. Not every useful form can be obtained in this way, 
however. For instance, it is impossible to derive (3.1) as Euler-Lagrange 
equations, since the arc-length does not satisfy the necessary constraints 
and is thus not a permissible variable of integration in the action integral 
W. An excellent example of the beneficial use of coordinate transforma- 
tions is given below. 
4.2 General rotationally symmetric systems 
We assume that the system in question is rotationally symmetric about 
an optic axis and we introduce the corresponding cylindrical coordinates. 
The components of E and B must not depend on the azimuth T, and it 
may be assumed that the same is true of Az, A~, A~ and (I). In cylindrical 
coordinates, the Lagrangian (4.2) is given explicitly by 
L=moc 2 1- 
1-(.;2+÷2+r 
2~2)c-2 
+ Q(~Az+÷Ar+r~Av-(~) 
Az, At, A~ and (I) being functions of z, r and t only. Hence L does not 
depend explicitly on T, which means that T is a cyclic variable. The cor- 
responding canonical momentum is therefore a constant of motion 
p~ -- OL/O~ - const 
or 
p~ ---- ~/1 -/~2 + Qr A~ (z, r, t) = const 
Integrating (4.3) over the circular disk C introduced in Section 2.5 and 
using Stokes's theorem we find 
J A. dr = 27rrA~ =/B. da = ~(z,r,t) 
C 
Thus the constant p~ is identical with the axial angular momentum N of 
(2.37). More suggestively, we can use (4.12) to represent the axial angular 
momentum as 
Y = (r × P)z 
(4.14) 

4.2 GENERAL ROTATIONALLY SYMMETRIC SYSTEMS 
39 
but this does not mean that p has become an observable quantity, even 
though we can measure N. We note that although the rotationally sym- 
metric gauge adopted for the potentials is most convenient, it is not ab- 
solutely necessary. If some other (unsymmetric) gauge were used, (4.14) 
would not hold, whereas (2.37) always remains valid. Moreover, the deriva- 
tion of the conservation law given in Section 2.5 gives more physical insight 
than does the formalism presented here. The evaluation of the remaining 
two Lagrange equations 
d(OL) 
OL 
d(OL) 
OL 
(4.15) 
d--i -5-/ 
Or =° 
' 
-5-iz 
-Oz 
is straightforward. 
we find 
Expressing (4.3) and (4.4)in cylindrical coordinates, 
r/ ---(m÷)- m÷(p 2 = Q(E~ + r(pB~ - ~Bv) 
dt 
Cl (m~) - Q(Ez - r(pB~ + ÷Bv) 
dt 
rno 
_ 
~2 
÷2 
2 2 
~-½ 
m= 
=m0{1 
( 
+ 
+r¢)c 
-2 
J 
(4.16) 
(4.17) 
The remaining calculations are left to the reader. The same results can, of 
course, be obtained by transforming the Lorentz equation in the appropri- 
ate fashion. 
The conservation law p~ = N = const may be used to eliminate ~b 
from (4.16). Better still, ~b may be eliminated from (4.13) before evalu- 
ating (4.15). Owing to the dependence of the mass on ~5 in (4.17), the 
resulting formulae are highly complicated. It is thus advantageous to elim- 
inate ~ from (4.13) only in the nonrelativistic approximation m = m0. 
Moreover, we make the simplifying assumption that all the terms in B~ 
can be neglected, since this field component is only produced by the par- 
ticle beam itself and is always very weak in comparison with the external 
magnetic field. B~ -- 0 is most easily satisfied by the gauge Az - Ar - 0, 
which will henceforward be adopted. From (4.4), we see that E~ and E~ 
are now represented by a quasistationary approximation: 
00 
00 
Ez= 
Oz 
' 
Er= 
Or 
with 
O-O(z,r,t) 
a simplification which is justified even in technical applications involving 
high-frequency devices. The essential induction effect is incorporated in 
the components E~ and A~ and thus in the dependence of • on time. 

40 
4. VARIATIONAL 
PRINCIPLES 
With all these simplifications the Lagrangian now becomes 
1 mo(~2 + ÷2 
L = ~ 
+ r2(a ~) + Q(r(oA~, - ~) 
(4.~s) 
Solving (2.37) for # in the nonrelativistic limit, we obtain 
N -Q~(z,r,t)/2~r 
(4.19) 
~ 
= 
mot 2 
On inserting this in (4.18) we obtain a Lagrangian that is a function of z, 
r, t, ~ and 7: only but is a very cumbersome expression. We can get a more 
compact form by making the Legendre transform 
L* := L - (ap~ - L - ~pN 
(4.20) 
before substituting for ~. This transform does not change the final equa- 
tions of motion since the corresponding action integrals differ from each 
other only by a fixed constant and have thus the same extremal trajecto- 
ries: 
tl 
tl 
to 
to 
Substitution of (4.19) in L* now results in 
z* = 2(~ = + ÷=)- X(z,~,t) 
(4.21) 
with the effective potential energy 
X(z, ~, t) = q¢(z, ~, t) + 
{N - Qq~(z,r,t)/2r} 2 
2m0 r2 
(4.22) 
The latter contains two contributions, the familiar electric term Qff and 
a centrifugal potential. The latter contains the terms involving ~ and has 
the value m0r 2 ~2/2. It differs from the familiar classical form in possessing 
a contribution from the magnetic flux ~. The final form of the trajectory 
equations is now obtained by writing down the Euler-Lagrange equation 
of (4.21)(StSrmer, 1904, 1906, 1933): 
OX 
OX 
moi: = 
Or 
, 
mo~ = 
Oz 
(4.23) 

4.3 THE CANONICAL FORMALISM 
41 
The third equation is (4.19), which can be rewritten in compact form if 
the quantity N, though constant with respect to time, is regarded as a free 
parameter. It is readily seen that 
OL* 
OX 
(P = 
ON - 
cON 
(4.24) 
In this sense L* is a Routhian function. 
In static fields, for which X is a function of z and r only, the law of 
conservation of energy can be simplified to 
Eo = 
+ 
+ X(z,,.) 
= 
(4.25) 
as can be easily verified. 
This example demonstrates that the use of the Lagrange formalism in 
electron optics can be quite advantageous, since the elementary derivation 
of (4.23) turns out to be more complicated if the electromagnetic fields 
are time-dependent. These equations are very useful in studies of particle 
motion in high-frequency devices, for which alternative simple forms of the 
trajectory equations are not available. 
4.3 The canonical formalism 
As well as the Lagrangian, the Hamiltonian function is of great impor- 
tance. The latter is needed in Hamilton-Jacobi theory, which is outlined in 
Chapter 5; the Hamiltonian itself and the associated canonical equations 
of motion are needed in the theory of electron emission from cathodes (see 
Chapter 44). 
In vector notation, the Legendre transform between the Lagrange func- 
tion L(r, v, t) and the Hamilton function H(r, p, t) has the form 
H(r, p, t) := p. v - L(r, p, t) 
(4.26) 
in which the velocity v has to be expressed in terms of the canonical mo- 
mentum p. This expression is obtained by solving (4.12) for v, the first 
step being 
1 
1 
v = --g= 
--(p-QA) 
rn 
rn 
The relativistic mass can be expressed as a function of p with the aid of 
(2.11) and we finally obtain 
c(p- 
QA) 
v = x/(moc)2 + (P _ QA) 2 
(4.27) 

42 
4. VARIATIONAL PRINCIPLES 
Introducing this into (4.26), we obtain the Hamilton function 
H = cx/(rnoc) 2 + (p - QA) 2 - moc 2 + QO 
(4.28) 
This expression is always valid, even in systems with time-dependent elec- 
tromagnetic potentials. The canonical equations of motion are given by 
OH 
v - + = ap 
(4.29) 
OH 
1~= 
Or 
(4.30) 
Equations (4.20) and (4.30) can easily be verified by performing the nec- 
essary differentiations. Equation (4.29) proves to be identical with (4.27), 
while (4.30) is equivalent to the Lagrange equation p = OL/Or. More gen- 
erally, the canonical equations can be derived from a variational principle 
of least action in phase 8pace (defined as the union of the vector spaces of 
r and p). This variational principle will not be investigated here. 
An important law can be established concerning the variation of the 
Hamiltonian with time. Taking the total derivative with respect to time 
of both sides of (4.26) we have first 
dH 
OH 
OH 
OH 
OL 
OL 
OL 
dt 
Ot 
~- r " --~r + P " -~p =lb.v+V-lb 
- 
o-7 
Using the canonical equations (4.29) and (4.30), the first part of this equa- 
tion reduces to dr~dr = OH~Or. Definition (4.12) together with the La- 
grange equation shows that the expression on the far right-hand side re- 
duces to -OL/Ot, thus 
dH 
OH 
OL 
d t -  
Ot - 
Ot 
(4.31) 
The most important consequence of this relation is that the value of H is 
conserved in all systems with static electromagnetic fields, since the only 
explicit dependence of H and L on time occurs in the potentials O(r, t) 
and A(r, t). By comparison of (4.28) with (2.6), (2.7), (2.8) and (2.11), it 
can be seen that the first two terms on the right-hand side represent the 
kinetic energy T as a function of p and r, while the last term QO is the 
potential energy V(r), so that H is the same as the total energy E0 of the 
motion. According to the conventions adopted in Section 2.3, this quantity 
H = E0 is the kinetic starting energy of the electron at the cathode surface; 
it thus has a very concrete and important meaning, since this quantity will 
be used in the statistical analysis of the emission process. 

4.4 THE TIME-INDEPENDENT FORM OF THE VARIATIONAL PRINCIPLE 43 
4.4 The time-independent 
form of the variational 
principle 
Since the value of H is conserved in all static systems, we can cast the 
variational principle (4.1) into a very attractive form by eliminating L. 
Solving (4.26) for L and introducing the resulting expression into (4.1), we 
find 
tt 
=/(p. 
v - H) dt = 
W 
extr. 
to 
In all static systems, the contribution 
tl 
H dt = E0(tl - to) 
to 
is a fixed constant, which does not affect the equation of motion and may 
hence be omitted. We thus obtain the (reduced) principle of least action: 
tl 
/ 
S "-- 
p. vdt - W + E0(tl - to) = extr. 
to 
(4.32) 
Elimination of the time and the introduction of any other legitimate vari- 
able of integration u is now straightforward: 
-- 
dr 
S = 
P" -~u du - 
p. dr = extr. 
u0 
7"0 
(4.33) 
m 
The second representation shows that S is invariant with respect to the 
choice of the parameter. 
In systems with a straight optic axis, the axial coordinate z is always 
the most convenient choice of variable of integration. 
Using (4.12) and 
(3.15) we obtain 
2:1 
=/(g 
+ QA) . r'(z)dz 
(4.33a) 
tur 
Zo 
Since the direction of the kinematic momentum vector g must be the same 
as that of the local tangent t, we may use 
g. 
,.' - 
t. 
,.' - 

44 
4. VARIATIONAL PRINCIPLES 
where ~ is given by (3.16). Bringing all this together and writing out the 
expression for S explicitly, we obtain finally 
Zl 
)dz 
ZO 
(4.34) 
with 
-M(z,y,z,z',y') = x/1 + x '2 + y,2 g(r) + Q(x'A~ + y'Ay + Az) 
(4.35) 
For electron motion, (2.19) may be used. The corresponding Euler equa- 
tions 
' 
--7 
= 
0y 
are the x- and y-components of (3.17) and will not be discussed here. An 
important way of developing a theory of aberrations consists in expanding 
(4.35) as a Taylor series before evaluating (4.36) and then developing an 
appropriate perturbation calculus. 
4.5 Static rotationally symmetric systems 
A good example of the simplification achieved by eliminating the time as a 
trajectory parameter is the static rotationally symmetric system. Moreover, 
the Stbrmer equation of motion thus obtained is of some importance. It 
is advantageous to transform (4.35) into cylindrical coordinates. In static 
systems, the only surviving component of A is A~ = ~(z, r)/2rr, • being 
the magnetic flux. Thus we immediately obtain 
M(z, r,r', ~') = g(z,r)x/1 + r '2 + r2~ '2 + Q~'~(z,r)127r 
. 
Since ~ is cyclic, the conservation of axial angular momentum 
is now 
expressed by 
Q '(z 
OM _ _ 
g(z, r)r2~o ' 
+ 
' 
= const 
(4.37) 
N = p~, = 0~0' 
~/1 -~- r t2 -~- r2~O t2 
27r 
On comparison with (2.37), it is clear that the value of N is invariant with 
respect to the parametric transform. 
Every canonical momentum 
can 
be shown to be invariant with respect to every parametric transform in 
variational theory. 

4.5 STATIC ROTATIONALLY SYMMETRIC SYSTEMS 
45 
Even for relativistic motion, it is easy to eliminate T' by solving (4.37) 
for T', the result being 
~/1 + r '2 
~' = ~ { N  
- Qq~(z, r)/27r} 
(4.38) 
~2g(z,~) 
with 
#(z, r):= {g2(z, r) - r-2(N - Q~/2r) 2 } ½ 
(4.39) 
Elementary calculations show that 
= ~/1 + r '2 + r2~ '2 = g(z, r)/2 -1X/1 + r '2 
The integrand of (4.34) can be simplified by means of the Legendre trans- 
form M* = M- ~'N (cf. 4.20), the result being 
M*(z,r,r') = X/1 -t-r'2~t(z,r) 
Evaluation of the Euler equation 
dz 
Or' 
Or 
yields 
dz 
~/1 + r '2 
Or 
which can be further simplified to the StSrmer equation 
l+r'210#-r'O# ) 
(4.40) 
r"(z) = #(z,r) 
~ 
This trajectory equation is similar in structure to (3.21) and to the elec- 
tric terms of (3.20). The function #(z,r) is the length of the meridional 
projection of g, since (4.39) can be rewritten as # = ]izgz + irgrl. When 
considering the motion of electrons, it is helpful to introduce the accelera- 
tion potential by means of (2.19). We find 
2(~(z,l+r'2 (0~'r) 
~ 
0~)) 
r" = 
- r'-~z 
(4.41) 
with the effective potential 
~(z, r) = (~(z, r) - {N + e~I'(z, r)/27r} 2 
(4.42) 
2m0er 2 
the second term being again a centrifugal contribution. 
On comparing these equations with the corresponding formulae in Sec- 
tion 4.2, the reader will notice that no approximations have been neces- 
saxy here and the exact calculation has not become at all complicated. 
The essential simphfication is a consequence of the fact that, in the time- 
independent representation, the relativistic mass is a simple function re(z, r); 
the need to use (4.17) in the time-dependent situation highly complicates 
the calculations. 

5 
Hamiltonian Optics 
In the previous chapter we investigated the various types of variational 
principles and showed how they can be made to yield suitable forms of tra- 
jectory equations. These trajectory equations are to be solved by methods 
that are explained in later chapters and the solutions will provide us with a 
certain measure of physical understanding. Though this is a possible way of 
investigating electron optical devices, it is not entirely satisfactory. In geo- 
metric light optics, Hamilton's theory of characteristic functions, in which 
the rays of light are treated as trajectories orthogonal to eikonal or char- 
acteristic functions, was a major advance, making it possible to investigate 
whole bundles of trajectories instead of individual ones. This is the main 
difference between optical and purely mechanical or ballistic treatments. 
In charged particle optics, the analogue of the eikonal theory is well- 
known under the name of Hamilton-Jacobi theory, which we shall now 
consider in detail. In the standard textbooks on classical mechanics, this 
theory is derived by means of canonical transformations, which is a very 
general but undeniably elaborate method (see e.g. Goldstein, 1959, Chap- 
ter VIII). We shall not follow their example. The presentation that follows 
is considerably simpler. 
5.1 Introduction of the characteristic function 
We again set out from (4.1). For given boundary values, to and tl, of t and 
hence of the vectors r0 := r(to) and rx := r(tx), a function W(ro,to; rx,tx) 
can be defined to be the stationary value of (4.1), obtained by integration 
over a physical trajectory, a solution of the corresponding Euler equations. 
This definition may be complicated by the presence of singularities and 
ambiguities, which will be investigated later. For the moment, we shall as- 
sume that the value of the integral expression is a unique and differentiable 
function of its arguments. We shall see that it is appropriate to regard this 
function W as a characteristic of the system and we shall indeed refer to it 
as a characteristic function. 
We now consider differential variations of the endpoint, the starting 
point being unaltered. In order to distinguish these variations from the 
notation used for integration, we denote them by At1 and At1 rather than 

5.1 INTRODUCTION OF THE CHARACTERISTIC FUNCTION 
47 
dt and dr. Since the curves connecting the fixed starting point and shifted 
endpoint must correspond to physical trajectories, the condition 
At1 = v(tl )Atl = va At1 
must be satisfied. The corresponding variation of W is then given by AW = 
L1Atl = L(rl, vl, tl)Atl. The Lagrangian L1 can be expressed in terms 
of the Hamiltonian H1 at the terminal point 1, the result being 
AW = (101 • Vl -- H1)Atl = Pl " A~'l -- Ha Atl 
(5.1) 
On the other hand we can expand the difference 
iW 
:= W(r0, to; rl + irl, 
tl + Atl) 
as a Taylor series. Retaining only the first order terms, we obtain 
• 
OW 
AW = Arl "-x--- + Atl~ 
Orl 
OW 
0ti 
(5.2) 
The two expressions for A W must be identical for all increments At l and 
At1 that represent a physical motion. Certainly we can choose arbitrary 
values of At l provided that a continuous range of values leads from t l 
to tl + At1. 
It is now of importance that (5.1) must be identical with 
(5.2) in every respect, that is, for all acceptable configurations of r0, to, 
rl and tl. This implies that Arl must be regarded as independent of Atl, 
even though rl = VlAtl; the velocity vl may be an arbitrary vector only 
subject to Iv11 < c. From (5.1) and (5.2), we then obtain the necessary and 
sufficient conditions 
OW 
OW 
- 
, 
Ha= 
(5.3) 
101- 
0~'1 
0"~1 
By considering variations of the starting point, we likewise find 
OW 
OW 
P0= 
0r0 
' 
H0= 0t0 
(5.4) 
Thus the variation AW due to alterations of both sets of arguments is given 
by Hamilton's central equation: 
AW -- 
• Ar -- H 
t 
- Pl " At1 -- PO " Aro -- H1 itl 
-[- Uoito 
(5.5) 
o 

48 
5. HAMILTONIAN OPTICS 
Since W is a continuously differentiable function of its arguments, (5.5) 
must hold even for completely arbitrary differential increments. 
5.2 The Hamilton-Jacobi equation 
In the following discussion we shall assume that the starting coordinates 
r0, to are uniquely specified and remain unaltered, while the terminal co- 
ordinates rl, tl may vary within physically allowed domains. In order to 
simplify the notation, we shall omit the arguments r0 and to whenever they 
are not explicitly needed. Furthermore, we shall omit the subscript 1 of 
the terminal coordinates, and the ordinary vector notation for the gradient 
will refer to differentiation with respect to rl. 
Introducing (5.3) into the Hamiltonian H(r,p,t), we immediately 
obtain the Hamilton-Jacobi equation 
OW 
H(r, grad W, t) = 
0t 
(5.6) 
W now being a function of r and t. Recalling (4.28), (5.6) is given explicitly 
by 
c{(moc) 2 +(grad W - QA)2 } ½ 
OW 
- m0d + Q¢ + 
= 0 
(5.7) 
and A being functions of v and t, like W. This is a partial differential 
equation of first order for the function W(r, t). Since only the derivatives of 
W appear in (5.7) and not the function itself, the solution of (5.7) may con- 
tain an arbitrary additive constant. A reasonable and simple normalization 
is W(r0, to; r0, to) = 0, since the solution then fits the original definition of 
W, namely as the integral representation of the action. From among the 
many solutions of (5.7), we shall select all those that satisfy this condition. 
They correspond to the paths of all trajectories that start at the point r0 
at the time to. 
Even after imposing this restriction on the set of solutions, the prac- 
tical solution of (5.7) will be extremely complicated in the general case; 
further simplification is therefore necessary. In all systems with static po- 
tentials ¢(r), A(r), the separation (in full notation) 
W(r0, to, r, t) = S(r0, r) - Eo(t - to) 
(5.8) 
is possible and advantageous, (5.7) then simplifying to 
c{(moc)2 + (grad-S- QA(r))2} ½ - moc 2 + Q¢(r) = E0 
(5.9) 

5.3 THE ANALOGY WITH LIGHT OPTICS 
49 
The point characteristic function S(r0, r) introduced by this separation is 
exactly the same as the function S appearing in the integral representations 
(4.32) and (4.33) if the normalization condition for W is satisfied. Thus, 
instead of solving (5.9) directly with S(r0, r0) = 0, S may in practice be 
obtained by evaluating (4.33). 
Familiar though it is in theoretical physics, (5.9) is an inconvenient 
form of the reduced Hamilton-Jacobi equation. By means of (2.13) we can 
simplify it to 
grad S(r) - QA(r) 
= g2(r) 
(5.10) 
which is still exact. In the case of electron propagation, we can rewrite it 
as 
grad S(r) + eA(r) 
= 2moe~'(r) 
(5.11) 
In all practical calculations we shall use this form. Despite this simplifica- 
tion, the practical solution may still be very arduous. 
5.3 The analogy with light optics 
Having formally introduced the characteristic function, we now discuss its 
physical meaning. For simplicity, we first assume that the vector potential 
A(r) vanishes. In the static case, the first equation in (5.3) then reduces 
to 
p(r) = g(r) = grad S(r) 
(5.12) 
and (5.11) to 
{grad S(r)} 2 = {g(r)} 2 = g2(r) = 2mock(r) 
(5.13) 
the last term of this equation being valid for electrons. The physical mean- 
ing of (5.12) and (5.13)is quite clear: (5.12) expresses the vector g-- my 
as a function of r, while (5.13) is the condition that the length of this 
vector is in agreement with relativistic kinematics. The truly new result, 
going beyond relativistic kinematics, is that the local direction of the vector 
g is always orthogonal to the corresponding surface S(r) - const (5.12). 
Since the vector g = g(r)t(r) always points in the same direction as the 
local tangent t(r) of the trajectory in question, we can draw the following 
conclusion: the particle trajectories are orthogonal to the set of surfaces 
S(r) = const. 
This statement is illustrated in Fig. 5.1. The analogy with geometric 
light optics is now complete. We may use the relation g = hkon(r)t(r), 

50 
5. HAMILTONIAN OPTICS 
J 
(6,~) = c~st 
i 
-.._____ 
T(~o,~) 
1 
Fig. 5.1" Simplified representation of the point characteristic function S(r0, v) in an 
isotropic medium. The point P0, with position vector r0, may be regarded as a point 
source, from which the various rays emanate. A number of surfaces S = const are shown 
in a two-dimensional section. The value of S at any arbitrary point P is equal to the 
variational integral along the trajectory from P0 to P. The local tangent t at P is 
orthogonal to the corresponding surface S = const. 
t(v) being the local tangent vector of a ray passing through the point r. 
The vacuum momentum hko cancels out if we introduce an eikonal function 
L(v) by writing S(v) =: hkoL(v), and we obtain 
n(v)t(v) = grad i(r) 
(5.14) 
{grad L(v)} 2 = n2(r) 
(5.15) 
Equation (5.14) expresses Hamilton's statement that light rays are the nor- 
mals to a family of surfaces L(r) = const known as wavefronts or eikonal 
surfaces (see e.g. Born and Wolf (1959) eq. (3.1.15b), where (5.15)is re- 
ferred to as the eikonal equation, recalling the work of Bruns (1895) on 
'Das Eikonal'). The eikonal itself is an optical length. Explicitly, the point 
eikonal 
P1 
L(lr0,11" 1) -- / 
/b 
n(lr) ds 
(5.16) 
qd' 
P0 
is the optical length between the points P0 and Pa with position vectors r0 
and rl, respectively. The integration is to be performed along a physical 
trajectory. According to Fermat's principle this function takes the same 
value along all trajectories connecting P0 and P1 that are continuously 
deformable into one another, and is stationary when evaluated along a 
trajectory. For rotationally symmetric dioptric systems, this stationary 

5.4 THE INFLUENCE OF VECTOR POTENTIALS 
51 
value is a true minimum (Sturrock, 1955 p.60). 
This result is exactly 
analogous to (4.32). 
It is possible and of potential interest to introduce an electron optical 
index of refraction in such a way that (5.12) and (5.13) are in formal agree- 
ment with (5.14) and (5.15), respectively. Since the index of refraction may 
be defined in light optics as the ratio of the momentum in the medium in 
question and in vacuo, we may similarly define the electron optical index 
of refraction to be 
nE(')--g(r)G --i(~~ r) 
(5.17) 
G = (2moeU) 1/2 being some suitable constant momentum. We now have 
complete formal agreement if we write S = GL instead of S = hkoL. There 
is, however, an important difference between light optics and electron op- 
tics. With respect to the propagation of light, the vacuum is the privileged 
medium of reference as it is the only medium free of dispersion and ab- 
sorption. In electron optics there is no privileged medium of reference, the 
choice of the positive constant G being arbitrary; different choices are to be 
found in the literature. A definition of an electron optical index of refrac- 
tion such as (5.17) thus offers no particular advantage and it seems more 
sensible to use (5.12) and (5.13) in their original form, since the kinematic 
momentum has a direct experimental significance. 
A more serious difference between light optics and electron optics is 
that, in the nonrelativistic approximation, the condition V2(n~) = 0 is 
satisfied in all source-free domains, whereas no such condition obtains in 
light optics. Although the index n(r) for the refraction of light is a piecewise 
constant function in all the principal optical devices, the free choice of the 
lens surfaces makes aberration correction possible. The fact that Laplace's 
equation must be satisfied is, however, such a strong restriction that some 
of the aberrations in electron optical devices are rigorously incapable of 
correction (see Part IV). The relativistic terms in (5.17) do not alter this 
situation. 
5.4 The influence of vector potentials 
The analogy between light optics and electron optics breaks down com- 
pletely when vector potentials have to be considered. We then have 
p(r) = g(r) + QA(r) = grad S(r) 
(5.18) 
Since the vectors g and A are in general not parallel to each other and 
g has the direction of the local tangent, p does not always point in this 

52 
5. HAMILTONIAN OPTICS 
r~al jl 
• .Surfaces 
_o9O~ ., 
_14 
nrt o .~:~tory 
~\ S=const 
.i= ~ trOJ ~" 
\ 
panticle ray 
Fig. 5.2: Influence of the vector potential A on the characteristic function S. 
tangential direction. The rays of particles are hence no longer orthogonal 
trajectories of surfaces S(r) = const. This is shown in Fig. 5.2. 
The principle of least action (4.33) can be rewritten as ~S = 0 or 
rl 
P1 
- 
/ 
/ 
S(~o,,~) = 
p. e~ = 
~(~, t) e~ = extr. 
ro 
P0 
(5.19) 
with 
and for electrons: 
~(~, t).= t.p = 9(~) + Q t. A(~) 
(5.20) 
/ 
~(~, t) = ~/2m0~(~) 
- ~ t. A(~) 
(5.21) 
The meaning of this quantity is shown in Fig. 5.2. The generalization of 
(5.17) is now 
nE(r,t) := 
) 
7/ t. A(r) 
(5.22) 
Expressions of this form or proportional to it are commonly encountered 
in the literature. The square-root term is regarded as an isotropic con- 
tribution to the index of refraction, while the vector potential term--due 
to its dependence on t--is an anisotropic contribution. 
It must be em- 
phasized that all these considerations are of a purely formal character and 
have no experimental significance, as will soon be obvious. Nevertheless, 
the point characteristic function S(r0, rl), defined by (5.19), does retain-- 
disregarding any constant normalization factor--the character of the opti- 
cal distance between the points r0 and r l. Various choices of the normal- 
ization factor (essentially U in (5.22)) are to be found in the literature (see 
Picht, 1939, 1957, eq. (3.10-11) or Picht, 1963, Section 3.8; Glaser, 1952 
Sections 9-10; Grivet, 1965, Chapter 6; Kel'man and Yavor, 1959, 1968, 
Section 4 of Chapter 1). A system of units--not adopted here---has been 
devised by Sturrock (1955, Section 1.2) to eliminate e, m0 and c from the 

5.5 GAUGE TRANSFORMATIONS 
53 
equations. We emphazise that the choice of any particular normalization 
is only a question of convenience and has no physical meaning. 
It is possible and obviously sensible to choose a gauge for A(r) such 
that A(r) vanishes in all domains in which B is zero. Thus at least in the 
field-free domains in front of and behind magnetic devices, we can make 
use of the orthogonality between trajectories and eikonal surfaces. 
5.5 Gauge transformations 
In the previous chapters we have frequently used electromagnetic poten- 
tials but, apart from the purely electrostatic potential, never specified their 
gauge. We now discuss the influence of different gauges on various physical 
quantities. 
Equations (4.3) and (4.4) can be satisfied by different pairs of poten- 
tials ~, A and q,', A', say, provided that these pairs are related by 
0 
, 
A' 
, 
¢ = ¢'- ~F(r, t) 
A = 
+ grad f(r t) 
(5.23) 
This is called a gauge transformation. The function F(r, t) is arbitrary so 
long as it is sufficiently differentiable. The other Maxwell equations impose 
further restrictions but do not completely eliminate the freedom of choice 
of F. Since only the field vectors have experimental significance and not 
the potentials, all quantities that depend in any way on F(r,t) have no 
experimental significance. 
The kinematic functions, introduced in Chapter 2, are gauge-invariant 
since they are essentially related to the kinetic energy and not to the po- 
tential. In the variational formalism, the gauge dependent quantities are 
the generalized potential V*, the canonical momentum p, the Lagrangian 
L and the Hamiltonian H, the corresponding transforms being given by 
V*=V*'-Q 
--+v.gradF 
=V*'-Q--d~ 
(5.24) 
dF 
(5.25) 
L = L' + Q dt 
p = p' + Qgrad r 
(5.26) 
OF 
(5.27) 
H=H'-Q 
Ot 
The transform of the variational integral (4.1) involves integration of a total 
derivative, the result being 
W=W'+ 
1 
QF(r,t) 
(5.28) 
0 

54 
5. HAMILTONIAN OPTICS 
ua 
~(ua) 
Fig. 5.3: A one-parameter family of rays, each ray being uniquely characterized by a 
specific value of the parameter u. Two paths of integration, F0 and F, are also shown. 
If the endpoints are kept fixed, W and W' differ only by a constant and thus 
have the same extremals as solutions of the corresponding Euler-Lagrange 
equations. 
If, however, the endpoints are regarded as variables, (5.28) 
shows that the action W is essentially gauge dependent. The characteristic 
functions are therefore gauge-dependent and are not observable quantities. 
Only for the propagation of particles in purely electrostatic fields can (5.12) 
and (5.13) be regarded as having a physical meaning, as they have a gauge- 
invariant form. In (5.20), however, the gauge-dependence is now obvious 
and so definition (5.22) has no particular advantage. 
5.6 Poincar~'s integral invariant 
We now return to (5.5). In time-independent systems, variations of the 
time are of no interest and we thus choose At1 = At0 = 0. Since spatial 
variations involve only the static point characteristic function S(v0, el), 
(5.5) then simplifies to 
D 
AS -" Pl " At1 -- P0 " At0 
(5.29) 
We now consider a one-parameter family of non-intersecting rays, each 
ray being uniquely characterized by a well-defined value of some parameter 
u, as shown in Fig. 5.3. This means that the points with vectors r0(u) and 
rl (u) are located on the same ray. It is useful to introduce derivatives with 
respect to u, for instance At0 = Au dro/du, with similar expressions for 
At1 and AS. The quantity Au then cancels out from (5.29), so that 
dS 
drl 
dro 
(5.30) 
is exactly valid. 

5.6 POINCARI~'S INTEGRAL INVARIANT 
55 
Fo 
F 
F, 
,-y--. 
Fig. 5.4: Tube of non-intersecting rays and three closed paths of integration, F0, F1 
and F round its surface. 
In the next step we consider a tube of non-intersecting rays, its mantle 
surface now being a one-parameter family, as shown in Fig. 5.4. On this 
surface we choose two closed loops F0 and F1 with parametric representa- 
tions r0(u) and ~'I(U) for u, < u < u~, respectively. Integration of (5.30) 
over the whole interval of u results in 
u# 
u# 
u# 
/d, 
/ 
d~'l / 
d,r 
0 
du = 
p~(~) . ~ 
d~ - 
po(~) " ~ 
du 
Uvt 
Ua 
Ig a 
m 
Since r/(u~) = r/(u~), (j = 0,1), and S is a unique function of its argu- 
ments, the expression on the left-hand side vanishes. Thus 
u~ 
u# 
/ 
.,1 
/ 
.0 
is invariant. 
The parametric representation facilitates the evaluation of 
these integrals but is not absolutely necessary; the value of I is invariant 
with respect to parametric transforms. Since F0 and F1 are arbitrary loops, 
the expression 
P 
I = ~ p. dr 
(5.al) 
J 
F 
has the same value for any closed loop F on the surface of the tube. This 
is Poincard's integral invariance theorem. This quantity is even invariant 
with respect to gauge transformations, since it can be rewritten as 
I = / 
g. d,. + Q~r 
(5.32) 
F 

56 
5. HAMILTONIAN 
OPTICS 
where ~r is the magnetic flux through F: 
~r = / A'dr= f B.da 
r 
(r) 
The flux term in (5.32) gives rise to a phase shift of magnitude Q~r/h in 
the wave-optical interference patterns produced by electron optical 'biprism 
devices'. This phase shift, known as the Bohm-Aharonov effect (Ehrenberg 
and Siday, 1949; Aharonov and Bohm, 1959), will be discussed in detail in 
Volume 3. 
Another interesting consequence of (5.31), is the existence of the point 
characteristic function. The invariance of the integral expression given by 
(5.31) can be derived by following an alternative route, using canonical 
transforms (Goldstein, 1959), and may thus be regarded as fundamental. 
Let us now assume that the whole bundle of rays shown in Fig. 5.4 and also 
all rays propagating laminarly in the interior of the tube intersect at some 
point r0. Then any closed loop F may be contracted to this point r0, and 
hence the integral I vanishes. From f p. dr = 0 (even in the interior), we 
can deduce that curl p = 0. Hence there must be a function U(r) ~ 0 such 
that p = grad U. With the reasonable assumption U(ro) = 0 we recover 
the point characteristic function 
1P 1 / 
v(,~) =: S(,o,,,) = 
v(,). d, 
1/'o 
Since the value of this integral is independent of the path of integration 
between r0 and ra, it must be identical with that of (5.19). 
It is often preferable to use the invariance theorem in its differential 
form. This can be easily obtained in the following way. We now consider 
congruences of rays. These are two-parameter manifolds or families of 
rays, represented by functions r(u, v;s), u and v being the parameters 
in question and s the arc-length. 
For instance, all monoenergetic rays 
emerging from a 'point source' at r0 form a congruence, the parameters u 
and v then being angles characterizing the starting direction. The definition 
is, however, more general. It is easily seen that the generalization of (5.30) 
for a congruence is given by 
0S 
Or1 
Oro 
& -p~ "-~-~ -po "-bT 
OS 
Or1 
Oro 
(5.33) 

5.7 THE PROBLEM OF UNIQUENESS 
57 
since all vector quantities are now functions of u and v (neglecting the 
irrelevant dependence on s). From the condition that 02-S/OuOv, calculated 
in different ways, must be the same continuous function, we obtain 
. 
- - - -  
. 
~ 
. 
Ov 
Ou 
Ov 
Ou 
Ou 
Ov 
Ou 
Ov 
or rearranging 
Ou 
Ov 
Ou 
Ov 
Ou 
Ov 
Ou 
Ov 
Since the points r0 and rl may be chosen arbitrarily so long as both are 
located on the same trajectory specified by the values of u and v, the 
expressions on each side do not depend on position but only on u and v, 
and are thus constant along each ray. This constant is the familiar Lagrange 
bracket 
0r 
0p 
0p 
0r 
{u, v } "- Ou" 0-~ - 0~ " 0---~ = const 
(5.34) 
A congruence is said to be normal if {u, v } -= 0. This is equivalent to I = 0, 
since the Poincar6 invariant can be obtained from (5.34) by integration 
(Sturrock, 1955 Section 2.3). In every normal congruence, there is thus a 
family of surfaces U(r) = const such that p = grad U, U usually being 
the point characteristic function S. 
As is illustrated in Fig. 
5.2, this 
does not automatically imply orthogonality with respect to the trajectories 
themselves. 
5.7 The problem of uniqueness 
In the preceding considerations we have tacitly assumed that the solutions 
of the Hamilton-Jacobi equation are unique and regular. This is very often 
not the case. A simple example is shown in Fig. 5.5. In a beam, there 
may exist an envelope surface, formed by a one-parameter family of rays. 
This surface, which is known as a caustic, usually has sharp edges, and 
its extension depends on the positions and the shapes of any apertures 
confining the beam. The caustic represents a singularity of the point char- 
acteristic function, since it separates the domain of no solution from that 
with two solutions, where the rays intersect. The example illustrated is 
highly simplified; in realistic electron optical devices, caustics may have a 
very complicated structure. We shall therefore not investigate them here 
in a general manner; instead we shall treat some concrete examples later, 

58 
5. HAMILTONIAN OPTICS 
CQUS 
/' 
/\,, 
Fig. 5.5: Particle trajectories (full lines) forming a caustic and wavefronts S(r) = 
const (broken lines) in a two-dimensional section through a beam in an isotropic medium. 
The domain beyond the caustic is inaccessible to the particles; within the caustic, the 
trajectories may intersect. At the caustic, the lines S - const form cusps. 
see Chapter 42. The foregoing theory remains valid in domains accessible 
to the beam, the vicinity of caustics being excluded. 
In domains in which different functional branches of the point charac- 
teristic function overlap, each branch is to be treated separately. 
5.8 R~sum~ 
In this part we have dealt with the general theoretical fundamentals of 
electron optics. We have derived various forms of trajectory equations, 
kinematic functions and conservation laws. We have investigated various 
kinds of variational principles and these have permitted us to derive the 
general theory of Hamiltonian optics. All the relations obtained are es- 
sential tools in the investigation of particular aspects of electron optical 
devices. Since a knowledge of the applied electromagnetic fields is needed 
before the trajectory equations can be solved, we must now interrupt the 
purely electron optical discussions and deal with field calculations. In Part 
III, we shall return to the theory of electron propagation. 

Part II 
Calculation of Static Fields 

This Page Intentionally Left Blank

6 
Basic Concepts and Equations 
6.1 General considerations 
In this Part we shall deal with the calculation of electrostatic or magne- 
tostatic fields, that is to say, time-independent fields. This major simpli- 
fication is justified, since in the vast majority of practical electron optical 
devices the applied fields are static. Even in electric and magnetic deflec- 
tion units, the frequencies of the time-dependent fields are so low that a 
quasistatic approximation is entirely justified. By this, we mean that all 
field functions can be separated in the form r(r,t) = fl(r)f2(t), where 
fl (r) is practically independent of the frequency and may be calculated as 
a static field. Special high-frequency devices for which these assumptions 
do not hold are not treated in this book. 
Charged particles usually propagate in vacuo in a very narrow domain 
far distant from any material walls. The only exceptions are the immediate 
vicinity of emitting surfaces in electron guns, the surfaces of mirrors, speci- 
mens, apertures and recording devices. Specimens, apertures and recording 
media are of little interest in the present context, because they are usually 
located in field-free domains or are assumed to have no effect on the field 
distribution. The vicinities of cathodes and reflecting surfaces will be ex- 
cluded from the following discussion. With these exceptions, the space 
through which particles travel will be referred to as the extended parazial 
domain. 
Usually this is a narrow but long tube around the optic axis 
of the system in question, see Fig. 6.1. One of the aims of this Part is 
to derive suitable series expansions for the field in this paraxial domain, 
since these are fundamental for the investigation of trajectories, focusing 
properties and aberration effects in practical devices. 
Although a concrete knowledge of the field in the appropriate extended 
paraxial domain would be quite sufficient for all further electron optical con- 
siderations (always excluding cathodes and mirrors), this knowledge cannot 
be obtained without making a complete calculation of the field within the 
whole device. The reason for this is that a static field within a given do- 
main can only be calculated as the solution of a boundary-value problem, 
as is further outlined in Chapter 8. In electron optics, the boundaries are 
the surfaces of electrodes or polepieces, which are thus of great importance 

62 
6. BASIC CONCEPTS AND EQUATIONS 
Fig. 6.1: Axial section through part of some electron optical device; the paraxial region 
is indicated by dashed lines. 
though they are usually far from the paraxial domain. Thus the second im- 
portant aim of this Part is to present techniques for solving boundary-value 
problems. 
Throughout this Part we shall assume that electrodes and magnetic 
polepieces have isotropic material properties. The corresponding material 
coefficients may be functions of position. This is mainly the case when 
saturation effects arise in ferromagnetic polepieces. We shall adopt the 
following standard electrodynamic notation: 
E : electric field strength; 
H: magnetic field strength; 
e, e0 • permittivity; 
t, = 1/# • magnetic reluctance; 
8 • space charge density; 
a :surface charge density; 
D: displacement vector; 
B-magnetic flux density; 
#, #0 " permeability; 
A :vector potential; 
j" electric current density; 
w :surface current density. 
Scalar potential functions are denoted in different ways, as they will ap- 
pear frequently in different contexts; very often they have only a formal 
mathematical meaning. 
6.2 Field equations 
In the case of stationary fields, Maxwell's equations reduce to 
curlE=O 
, 
curlH=j 
divD=~ 
, 
divB=0 
, 
(divj=0) 

6.2 FIELD EQUATIONS 
63 
These are to be complemented by the material equations 
D=eE 
, 
B=#H 
, 
(or 
H=uB) 
(6.2) 
In ferromagnetic materials, the reluctance 
u is a function of B = ]B], 
hence 
H = u(B)B 
(6.3) 
In (6.1) the space charge density ~0(r) and the current density j(r) are 
regarded as given functions of position. The determination of space charge 
distributions will be treated in Chapter 46. Electric fields in the interior 
of conducting materials are not considered here. The source-free Maxwell 
equations permit us to introduce electromagnetic potentials, 
E = -grad ¢(r) 
, 
B = curl A(r) 
(6.4) 
these equations being special cases of (4.3) and (4.4). Combining (6.4) with 
(6.1) and (6.2), we obtain partial differential equations of Poisson's type. 
For the electrostatic potential we have 
div {e(r)grad ~(r)) = -g(r) 
(6.5) 
In homogeneous dielectric media, where e is constant, (6.5) reduces to 
= 
(6.6) 
and in domains free of space charge, to Laplace's equation 
V2~(r) =0 
(6.7) 
The derivation of Poisson's equation for the vector potential 
proceeds as 
follows. In the general case, combination of V × H = j, H = uB with 
u = u(B) and B = V x A results in 
curl (v([curl A[) . curl A(r)) = j(r) 
(6.8) 
This complicated non-linear vector Poisson equation has to be solved in 
ferromagnetic domains with saturation effects. When the permeability # = 
u -1 is constant, this differential equation can be simplified considerably. 
Using the vector differential identity 
curl curl A = grad div A - V2A 

64 
6. BASIC CONCEPTS AND EQUATIONS 
valid only in cartesian representations, we obtain first 
-grad div A + V2A = -#j(r) 
A further important simplification can be achieved by choosing a gauge for 
A that satisfies 
div A(r) = 0 
(6.9) 
We then finally obtain the vector Poisson equation 
V2A(r) = -#j(r) 
(6.10) 
Yet another simplification is possible in current-free domains. 
have V x H = 0 and it is always permissible to write 
We then 
H(r) = -grad x(r) 
(6.11) 
x(r) being the scalar magnetic potential. 
Since # is constant, we have 
div H = 0 and X satisfies the Laplace equation 
V2x(r) = 0 
(6.12) 
The simplification thus achieved lies in the fact that only one scalar dif- 
ferential equation is to be solved instead of three coupled by (6.9). The 
representation (6.11), (6.12) is of course less general than that in terms of 
the vector potential, since the condition j(r) = 0 cannot be true throughout 
the whole space. The domain of solution of (6.12) is thus to be confined 
in such a way that j = 0 and that the solution for X remains unique. 
Important examples are given in Chapters 8 and 9. 
Although (6.11) is the correct form of the gradient representation of 
H, it is rather inconvenient, since it is the flux density B, and not H, 
that figures in the trajectory equations. After solving the boundary-value 
problem for the magnetic field, we are only interested in the source-free 
vacuum field. We may therefore introduce a new potential W(r), writing 
B=-gradW 
, 
V2W=0 
, 
W=#0X 
(6.12a) 
We shall use this representation whenever this is possible and causes no 
confusion. 

65 
B 
,,.._ 
6.3 VARIATIONAL PRINCIPLES 
Fig. 6.2: A branch of the magnetization curve, in which U(B) denotes the area under 
the curve. As B --, c¢, the gradient tends asymptotically to a constant value. 
6.3 Variational principles 
In connection with the finite-element method (see Chapter 12), it is of 
importance that the partial differential equations given above can also be 
derived from a variational principle, the integrand being the stored field 
energy. This principle takes different forms for scalar and vector potentials. 
The general form of variational principle for rn coupled functions of 
position yl(r).., ym(r) in a three-dimensional domain S is given by 
5W-5/A(r, yl...ym,VYl...Vym)d3r=O 
(6.13) 
s 
The boundary OS and the boundary values yl... ym on it must not vary. 
The corresponding Euler equations are 
0A 
k~l 0 
0A 
] 
0A 
(6.14) 
oy~ 
- 
: 
~ 
o(o~,/o~) 
- v 0(vy,) 
The cartesian components of the gradients are now treated as independent 
variables. 
In applications involving electrostatic fields, we have m = 1, yl(r) = 
(I)(r) being the electrostatic potential. The corresponding Lagrange density 
A is given by 
h - 2 E2 - ~(I) , 
(E- 
-V(I)) 
(6.15) 
Applying (6.14), we obtain (6.5). 
When source-free magnetic field domains are to be studied, we may 
choose scalar potential representations; as before m = 1 and now yl (r) = 
x(r). The Lagrange density A is now the familiar energy density: 
#H 2 
(H= -VX) 
(6.16) 
h-~ 
The corresponding Euler equation is (6.12). 

66 
6. BASIC CONCEPTS AND EQUATIONS 
In the case of general magnetostatic fields, we have to choose m = 3, 
and yi(r) = Ai(r), i = 1,2, 3, are then the three cartesian components of 
the vector potential A. We shall need the absolute flux density 
B = IBI = Icurl AI 
(6.17) 
The source-free term of the Lag'range density A is then a function of the 
form 
B 
U(B) = / H(B')dB' 
(6.18) 
o 
provided that any magnetic media are isotropic, that is, their permeabil- 
ity may vary with B but not with the direction of B mit is a scalar, not 
a tensor. For a non-linear medium with saturation effects, but without 
hysteresis effects, a graph of such a function is shown in Fig. 6.2. Differ- 
entiation of (6.18) with respect to B gives 
OU _ B dU(B) =: v(B)B 
(6.19a) 
H(B)-c3B 
B 
dB 
in accordance with (6.3) and hence 
1 dU 
t~(B) = B dB 
(6.19b) 
The complete Lagrange density is now given by 
A = U(B)- j. A 
(6.20) 
Evaluation of (6.14) for the three cartesian components of A and expression 
of the result in vector notation leads to (6.8). These tedious but elementary 
calculations are not reproduced here. 
In the case of linear (unsaturated) media, (6.18) simplifies to the fa- 
miliar energy density 
1 B 
1 (v × A) 
(6.21) 
U(B) 
= 
= 
# -- 1/u now being a constant. With the additional constraint (6.9), the 
Euler equations reduce to (6.10). 
In all the cases considered here, the Lagrange density A has the phys- 
ical meaning of an energy density, which generally contains an additional 
interaction term. The functional F = f Ad3r is thus an energy. Since this 

6.4 ROTATIONALLY 
SYMMETRIC 
FIELDS 
67 
has no upper bound, the concrete evaluation of the variational principle al- 
ways results in a minimum of F. This is of importance for the finite-element 
method. If the boundary OS is extended to infinity, the functional F must 
remain finite. This implies that any electrodynamic quantities must satisfy 
the 'natural' boundary conditions, which means that as Irl --. oo they must 
converge to zero in such a way that all the integrals involved remain finite. 
6.4 Rotationally symmetric fields 
Rotationally symmetric fields are of particular interest in electron optics, 
as the most common electron lenses are round, by which we mean they 
are built up from rotationally symmetric fields. Rotationally symmetric 
electrostatic fields are a simple special case of the Fourier series expansion 
treated in Chapter 7 and will therefore not be considered here. Magnetic 
fields, however, require special attention, as we now explain. 
For rotational symmetry it is advantageous to introduce cylindrical 
coordinates (z,r,T), as defined in Section 2.4. It is necessary to assume 
that the current density j(r) is circular and it is further convenient, though 
not necessary, to assume that the vector potential A(r) is likewise circular. 
This means that both vector functions have only azimuthal components: 
j(r) = j(z, r)i~ 
(6.22) 
A(r) = A(z,v)i~ 
(6.23) 
This already implies that div j = 0 and div A = 0. The cylindrical com- 
ponents of B - curl A are given by 
OA 
Bz(z, r) = _1 0 (rA) 
Br = 
, 
B~ = 0 
(6.24) 
~ 
' 
0z 
which represent a magnetic field, the direction of which always lies in a 
meridional plane. The opposite case of a circular magnetic field produced 
by a meridional current distribution is of little interest in electron optics 
but is of importance in plasma physics. This case will not be treated here. 
It is advantageous to introduce the magnetic flux function ~(z, r), as 
in Section 2.5" 
r 
• (z, r) = 2~r fr'Bz(z,r')dr' 
(6.25) 
0 
This is the static special case of (2.32). An immediate consequence is that 
Bz(r,z) = (2rr)-10~/0r is the static special case of (2.33). The condition 

68 
6. BASIC CONCEPTS AND EQUATIONS 
div B = 0, expressed in cylindrical coordinates, now becomes 
cOB, 
1 c3 
div B = ~ 
+ - 
(rB~) = 0 
(6.26) 
in which we have used B~ - 0 (6.24). 
Introducing the expression obtained above for Bz into (6.26), we find 
a() 
-~r rB~ 
= 
1 02q _ O( 
10q) 
2z OzOr- Or 
2z Oz 
Integration with respect to r yields first 
1 0q 
rB~ = 
2r Oz + C(z) 
C(z) being an arbitrary differentiable function of z. 
At the optic axis 
(r = 0), Br must remain finite. Since • and O$/i)z are proportional to 
r 2 in the vicinity of the optic axis, we can conclude that C(z) = O. Since 
the restriction to static fields is irrelevant in this context, we thus obtain 
(2.34). 
By applying Stokes's integral theorem to the circle z = const, r = 
const, r' < r shown in Fig. 2.1 we find immediately 
q(z, r) = 2rrrA(z, r) 
(6.27) 
A corresponding relation has already been used in Section 4.2. In connec- 
tion with the paraxial properties of magnetic round lenses, it is helpful to 
introduce an auxiliary potential function 
H(z,r) = 2A(z,r) 
(6.28) 
r 
We can now write the different representations of Bz and Br as follows: 
OA 
A 
r 
OH 
1 
Oq 
Bz(z, 
) = 
+ -  
= 
II + 
• 
- 
r 
"2 Or 
27rr 
Or 
OA 
r 
OH 
1 
O~ 
B~(z, r) = 
Oz - 
2 
Oz 
27rr 
Oz 
(6.29) 
(6.30) 
Comparing the different representations and noting that II(z, r) must re- 
main finite as r --, 0, we see that 
B,(,, 0) = U(z, o) 

6.5 PLANAR FIELDS 
69 
Furthermore, we see that, in the immediate vicinity of the optic axis, Br 
and A are proportional to r. These facts are of great importance in the 
physics of magnetic lenses. 
When we come to discuss the boundary conditions, it will be useful to 
write (6.29) and (6.30)in vector form: 
1 
B(r) = ~r~ri~ x grad @(z, r) 
(6.32) 
This is easily verified by writing out (6.32) in cylindrical components. 
The partial differential equation to be satisfied by A(z, r) is most easily 
obtained by substituting (6.24) into (6.8). In cylindrical coordinates, only 
the azimuthal component fails to vanish: 
O ( OA) 
O ( OA 
A) 
0----~ u -~z 
+ -~r 
u -~r + u 
= -j ( z, r) 
(6.33) 
In unsaturated materials # - u -1 is a constant and (6.33) then simplifies 
to 
02A 
02A 
10A 
A 
Oz 
---Y + -~Yr 
2 -~ r Or 
r 2 = -#j 
(6.34) 
Introducing (6.27) and (6.28) into this equation, more convenient partial 
differential equations, having no term in r -2, are obtained: 
021-I 
02II 
3 OH 
Oz 2 +-b72 + r Or 
0z 2 
0r 2 
r Or 
= 
2#j 
(6.35) 
r 
= -2r#rj 
(6.36) 
In Chapters 7 and 8, these equations will be encountered again as formal 
special cases of a more general differential equation. 
6.5 Planar fields 
Planar fields are such that the field components are independent of one 
of the three cartesian coordinates. In practice, they are idealizations of 
three-dimensional fields, obtained by neglecting the fringe-field domains in 
one direction. Fields of this type are approximately realized in such devices 
as electrostatic deflection units, slit lenses, secondary emission multipliers 
and deflection magnets with plane surfaces. 
Without loss of generality, we may choose the cartesian coordinate 
system in such a manner that the field does not depend on the coordinate 
y. In the z- x plane, we introduce the complex variable 
w = z + ix -- re '~ 
(6.37) 

70 
6. BASIC CONCEPTS AND EQUATIONS 
(a) 
v 
i 
/ 
/ 
X 
\ 
x 
:.1 
d 
.,.._ 
U 
Fig. 6.3: (a) Square grid in the (z, y)-plane, b) Conformal map in the (u, v)-plane; the 
mapping is such that angles are conserved. 
Any analytic function 
f(w) = ~(z, ~) + i~(z,~) 
(6.38) 
is a solution of Laplace's equation. This is a consequence of differentia- 
bility in the complex plane. As is well-known from the theory of analytic 
functions, u and v satisfy the Cauchy-Riemann equations 
OzU(Z, ~) = 
v(~, x) 
°v(z,.) = -°u(~,x) 
(6.39) 
From these, the orthogonality relation 
Ou Ov 
Ou Ov 
i)-~ Oz ~ Ox i:gx - grad u. grad v = 0, 
(6.40) 
the conformity relation 
Igrad ul = Igrad v[ = l/'(w)[ 
(6.41) 
(with f'(w):= df/dw) and the Laplace equations 
V2u=0 
, 
V2v=0 
, 
(V2= 
02 
(9~z22) 
Oz--- i -I- 
(6.42) 
can be derived. Equations (6.40) and (6.41) are characteristic of a confor- 
mal mapping, as shown in Fig. 6.3. The function f(w) defined by (6.38) 
can be interpreted as a transform from the square-shaped map in the z-x- 
plane (Fig. 6.3a) to a curvilinear map in the u-v-plane (Fig. 6.35). As the 
size of the curved cells is decreased, these cells collapse to squares. 

6.5 PLANAR FIELDS 
71 
//// 
Fig. 6.4: Coordinate system adapted to a sharp edge. 
A standard method of calculating planar fields consists in finding the 
inverse function [/(w)] -1 that transforms the given boundary in the z-z- 
plane into a pair of lines u = const. All lines u(z, z) = const are then 
equipotentials of the field and all lines v(z,z) = const are orthogonal flux 
lines. Such a transform is again a conformal mapping. This method of 
field calculation, commonplace in the mathematical literature, will not be 
outlined here since it is more complicated than the standard numerical 
techniques described later. It continues to be employed in the analysis of 
mass spectrometers (Boerboom and Chen, 1984; Wallington, 1970, 1971). 
An extremely detailed account is given by Durand (1966). 
Some interesting analytical functions and the corresponding potential 
fields are the following: 
(i) Arbitrary convergent power series expansions: 
S(w) = Z am Wm = Z amrmeim~ 
(6.43) 
m 
Non-negative integral exponents m lead to regular Taylor series expan- 
sions, while negative integers generate singular Laurent series expansions. 
The potential functions obtained from Taylor series expansions are approx- 
imately realized in the central zones of multipole devices, see Chapter 7. 
Non-integral values of m give rise to potential fields in the vicinity of sharp 
edges. The potential of the sharp edge shown in Fig. 6.4, for example, is 
given by 
OO 
Z 
~" 
(6.44) 
u(r, qo)=u0+ 
Anr nt' sinnpqo 
, 
P- 
27r-7 
n=l 
Here n is a positive integer. It is easy to verify that u = u0 = eonst on the 
lines ~0 = 0 and ~0 = 27r - 7 for all sets of coefficients A1, A2,... 
(ii) Complex Fourier integral expansions: 
OO 
f(w) = / A(k)exp(ikw) dk (k 
real, > 0) 
(6.45) 
l* 
0 

72 
6. BASIC CONCEPTS AND EQUATIONS 
With A(k) = A'(k)-iA"(k) 
and A(0) = 0 we obtain a potential distribution 
that satisfies u(z, x) ~ 
0 as x ~ 
oo: 
oo 
= f 
+ B'(k)sinkz} dk 
0 
(6.46) 
This is of importance in investigations on electron mirrors. 
(iii) Logarithmic singularity 
f(w) 
- 
logCw 
, 
u -- logCr 
, 
v - 
cp 
(6.47) 
(C is a positive constant.) This is of great importance in the practical 
application of the integral equation method, see Chapter 10. The inverse 
function 
1 exp(u + iv) 
w = z + ix = r exp(i~) = 
1 exp(u) 
~ ---- v 
(6.48a) 
(6.4Sb) 
describes the transform from quadratic to polar grids, see also Section 11.4.2. 

7 
Series Expansions 
As has been mentioned in Section 6.1, the electromagnetic field in the 
extended paraxial domain is of paramount interest in electron optics. In 
this domain, the field will be represented by series expansions, the general 
structures of which can already be derived without explicit solution of the 
corresponding boundary-value problem. As will be obvious later, the field 
in the vicinity of the optic axis can be obtained by analytic continuation 
of the axial distribution. 
In this chapter we shall assume that the optic axis is straight. Series 
expansions adapted to curvilinear axes are required in the treatment of 
devices with sector fields and will be derived in that context (see Part 
X). We shall further assume that the paraxial domain is usually source- 
free. This is certainly true for all current distributions, since the windings 
of coils are always far from the optic axis. 
Electric space charge may 
accumulate in the extended paraxial domain. Its distribution is, however, 
so inhomogeneous that the corresponding series expansions are of little 
practical value. Here, therefore, we shall mostly exclude them; they will be 
considered in detail when we come to treat electron guns (see Part IX). 
7.1 Azimuthal Fourier series expansions 
The aim of the following considerations is to decompose a three-dimensional 
field into a sequence of uncoupled two-dimensional fields. This is advan- 
tageous, since two-dimensional fields are far more easily calculated than 
three-dimensional ones. The required decoupling is obtained by expanding 
the field as a series of complete orthogonal functions, most favourably as 
a Fourier series (Glaser, 1952, Section 35). Since the present discussion is 
quite general, source distributions are not excluded. 
7.1.1 Scalar potentials 
Let us now consider a general Poisson equation 
= 
regardless of the special meanings of the functions V(r) and S(r). 
In 

74 
7. SERIES EXPANSIONS 
cylindrical coordinates (z, r, ~o) this Poisson equation takes the form 
02V 
OuV 
1 OV 
1 
02V 
Oz 2 + ~ 
+ - 
Or ! r2 
0~o2 = -S(z, r, ~o) 
(7.2) 
Both functions V and S are periodic with respect to the azimuth ~o, the pe- 
riod being 2~r, which suggests that we should introduce their Fourier series 
expansions. These can be represented in different equivalent forms. One 
essential requirement is that it should be easily possible to transform these 
series expansions and the corresponding ones for the gradient into regular 
power series expansions with respect to x and y. With these transforms in 
mind, we introduce the variables 
w := x + iv = r exp(iqo) 
(7.3) 
S := x 2 + y2 = r2 = ww* 
(7.4) 
the asterisk denoting complex conjugation. The series expansions in ques- 
tion then have the form 
oo 
v(,,~,~) = ~ 
~ 
{V~(,,,)e ~ 
} 
(7.5) 
m=0 
oo 
S(z,r,~o) = Z rm~ { gm(z's)eim~° } 
(7.6) 
rn'-O 
and in the cartesian representation 
oo 
V(,) = Z ~ { Um(z's)wm} 
(7.7) 
m--O 
with a corresponding expression for S(r). 
Differentiation of (7.7) with 
respect to z immediately results in: 
OV 
~ 
OUm(z,s) 
Oz = ~ ~ {w'- 
az 
} 
(Ts) 
m'-0 
The remaining derivatives are most favourably expressed in complex form: 
o= +i ~ 
= ~=0 ~+' 
~o~ + (~*) 
~ o~ + mUZ, 
(7.0) 
For m = 0 this series expansion contains no singularity, since (w*)-ls = 
w. Recalling that U0 must be a real function, we obtain the expression 
2wOUo/Os for the zero-order term of this series expansion. 

7.1 AZIMUTHAL FOURIER SERIES EXPANSIONS 
75 
Introducing (7.5) and (7.6) into (7.2), we first find a sequence of un- 
coupled differential equations 
02 Um 
02 Um 
2m + 10Um 
Oz 
----7+ 
Or 2 ÷ 
r 
Or - 
gm(z,r) 
m=0,1,2,... 
(7.10) 
It is possible to introduce the variable s = r 2 (Glaser, 1952, Section 35); 
this is, however, unfavourable with respect to the numerical solution, see 
Chapter 11. 
In practice, it is impossible to evaluate infinite series expansions nu- 
merically; instead, we have to truncate them in a suitable manner. From 
(7.5) we can get an idea of how this is to be done. Since Um and gm may be 
regarded as slowly varying functions within the extended paraxial domain, 
the factor r m is of greatest importance. Let R be some characteristic bore 
radius of the device in question. Then the exponent m -- M at which the 
series is truncated should be chosen in such a way that all terms (r/R) m 
with m > M can be neglected. In practice M - 5 is usually sufficient, 
since r/R ~ 10 -1. In order to avoid any misunderstanding, we emphasize 
that in concrete calculations, (7.10) (with 0 < m < M) are to be solved as 
a sequence of boundary-value problems, which implies that r may extend 
far beyond the paraxial domain. Only the values of the solutions obtained 
inside the extended paraxial domain are to be retained. 
In (7.10), the coefficients of the partial derivatives are simple real 
factors. A further simplification is therefore possible by considering only 
real source terms gm(Z,S) and real solutions Vm(z,s). Complex solutions 
can easily be obtained by forming linear combinations with appropriate 
complex factors. In Section 7.2, we shall thus assume that the functions 
Vm(z,s) are real. 
7.1.2 Vector potentials 
In Chapters 4 and 5, we have seen that the vector potential contributes 
to the canonical momentum and to the characteristic function. Though 
the vector potential itself is not an observable quantity, it still plays an 
important role in theoretical considerations. We now derive appropriate 
series expansions for it. Equations (6.9) and (6.10) must be satisfied and 
furthermore we impose the natural boundary condition A(r) ~ 0 for Irl 
cx~. Then A(r) is uniquely defined. For technical reasons we have jx - jy - 
0 on the optic axis, which implies that Ax = Ay = 0 for x = y = 0. 
The desired series expansions will be similar in form to (7.7). Here it 
is more convenient to consider the imaginary parts instead of the real ones, 
which is only a minor difference. Furthermore it is convenient to introduce 

76 
7. SERIES EXPANSIONS 
complex transverse components, thus 
i 
oo 
AT "= A, + iAy = ~ E 
C,,,(z, s)w" 
trt--" l 
A, "= -~ 
D,,,(z,s)w" 
(7.11) 
In a similar way the current density j(r) is represented by 
i 
oo 
jT := j, + ij, = ~ E 
Jm(z, s)w 'n 
m=l 
(20) 
jz := -~ 
Lm(z, s)w m 
(7.13) 
In the functions introduced on the right-hand side, the variable s is again 
defined by (7.4). 
A straightforward differentiation in cartesian coordinates results in 
div A = -~ { ~ (Dm-llz + sC,~ls + mCm)w'n-1} = O 
m=l 
Here the subscripts behind vertical bars denote partial differentiations with 
respect to the corresponding variable (see Section 2.4). 
Since different 
powers w m of w must be linearly independent, this condition div A - 0 
can only be satisfied if 
Dm-llz + 3Cmls -~- mCm = 0 (m > 1) 
(7.15) 
is valid for all integers m. Similarly the condition div j = 0 leads to 
Lm-l[z +SJm[s +mJm -O (m >__ l) 
(7.16) 
The determination of V 2 A in cartesian coordinates is also straightforward; 
we obtain 
m--I 
m~O 

7.1 AZIMUTHAL FOURIER SERIES EXPANSIONS 
77 
These series expansions are to be matched to (7.13) and (7.14). 
Using 
the linear independence of different powers of w and the vector Poisson 
equation V2A = -pj we obtain 
Cmlz~ + 4sCml~ + 4(m + 1)Cml~ = _#jm 
Dmlzz + 4SDmlss + 4(m + 1)Dmls = -#Lm 
(7.17) 
(7.18) 
With the transformations 
0 
1 0 
02 
1 02 
1 
0 
Os 
2r Or 
' 
Os 2 
4s Or 2 
4sr Or 
we obtain the more suitable differential equations 
2m+1 
Cmlzz + Cmlrr -Jr- 
emir = -~tJm(z,8) 
(7.19) 
r 
2rn+l 
Dmlzz -4;- Dmlrr -t- 
Dmlr - -ItLm(z, s) 
(7.20) 
r 
which have the same mathematical structure as (7.10). 
Here, however, 
their solutions are additionally coupled by (7.15). 
The magnetic flux density is obtained by differentiation, B = V × A. 
After some elementary calculations we find: 
BT'= Bx + iBy 
) 
) 
E 
SDZl'+mD*m 
(w*)--1 
1 
= _ 
m 
_ 
Cm+llz- Dmls wm+l 
m=O 
m=O 
(7.21) 
In source-free domains, where j = 0, this expression can be further simpli- 
fled. In order to show this, we differentiate (7.15) with respect to s and 
make use of (7.17) with Jm = 0, obtaining 
1 
-Drn_llsz = sCmlss + (m + 1)Cml s = -~Cmlzz 
This can be integrated with respect to z. Since A has to vanish asymptot- 
ically, no additive constant can appear, and so 
4Dml, = Cm+llz 
(7.22) 
Introducing this into (7.21) and eliminating Cm+al,, we find now 
BT = -- E 
SDal, + mDa 
(W*) m-1 
m'--O 
+ DmlsW m+l } 

78 
7. SERIES EXPANSIONS 
This equation has the same structure as (7.9). Therefore with # = #0 in 
vacuo 
we can introduce a scalar potential W(r) by writing 
W(r)=~ 
y~ 
D,,,(z,s)w" 
(7.23) 
m--0 
Calculation of the axial component B~ confirms this result. A straightfor- 
ward differentiation yields 
B~ -- Aylx - Axly - ~ ~ 
sCml8 4- mCm w m-1 
m--1 
On the right-hand side the expression Dml: can be introduced by means of 
(7.15) and we then find 
_0~ 
D,,,(z,s)w" 
= -Wl, 
B. = 
Oz 
_ 
since the permeability p is constant. The results obtained are in agreement 
with (6.11) and (6.12), as they should be. 
Comparison of (7.12) and (7.23) shows that W and Az are interrelated 
as the real and imaginary parts of a complex function: 
oo 
W-iA, 
= ~ 
D,,,(z,s)w m 
(7.24) 
m--0 
This relation holds, of course, only in source-free domains. 
The representation of the vector potential given above is a general- 
ization of Sturrock's (1951) formula. Other gauges, which do not satisfy 
div A = 0, have been introduced by Glaser (1952, Section 36) and by Schw- 
ertfeger and Kasper (1974). The present procedure is convenient, since we 
always arrive at the same class of partial differential equations. 
7.2 Radial series expansions 
7.2.1 Scalar potentials 
In accordance with the assumption that the paraxial domain is source-free, 
we shall now investigate solutions of (7.10) with source terms vanishing for 
sufficiently small values of r. From (7.5) and (7.7), it can be seen that a 
power series expansion with respect to s = r 2 will be the most suitable. 
We therefore introduce 
oo (_l),c,( z m)s" 
= 
' 
n'--O 
(7.25) 

7.2 RADIAL SERIES EXPANSIONS 
79 
into (7.10), the factor (-1)"/(2n)! being included for reasons of conve- 
nience. The coefficients c,, unknown at the moment, are related by recur- 
rence formulae: 
2m+ ) 
. 
o,12, 
1+ 2n+1 
c,+1 
, 
, 
, 
= 
, 
... 
where primes denote differentiation with respect to z. 
The coefficient 
co(z, m) can be chosen arbitrarily provided that all its derivatives remain 
finite for all values of z ([zl ~ oo included). This function is the axial value 
of U,,: 
co(z,m) = Urn(z, O)=: Urn(Z) 
(7.26) 
the subscript 0 being omitted to lighten the notation. In terms of r 2 the 
required power series expansion is now given by 
oo 
m! 
_ 
n'--0 
= u,,(z) - 4(m + 1) 
2!(m + 1)(m + 2) 
(7.27) 
6) 
Apart from the notation, this radial series expansion is identical with that 
given by Glaser (1952); it is equivalent to that given by Kasper (1982) 
if a is identified with 2m + 1. Equation (7.27) shows that each function 
U,,,(z,s) is already uniquely determined by its axial distribution u,,(z) 
(called the axial harmonic), provided that the series expansion converges. 
This property of the solution is very similar to that of analytic functions 
in the complex plane and by analogy we shall refer to (7.27) as an analytic 
continuation of the axial values. 
In the most general case, the convergence of (7.27) cannot be proven 
but must be assumed, at least in the extended paraxial domain. In this 
context there may arise problems since in fact (7.27) does not converge 
for all values of r. Unfortunately even reliable estimates for the radius of 
convergence are not known (apart from some special examples). 
In principle, it should be possible to compute the field in an entire 
device by analytic continuation of the appropriate axial harmonics u,,(z), 
since the solution as a boundary-value problem shows clearly that the sin- 
gularities must be located outside or at the boundaries. But in practice 
this is impossible for various reasons. A first problem is that the ana- 
lytical continuation is numerically unstable. Even if one starts with the 
correct functions u,,(z), one will not obtain the correct boundary values of 
U,,(z, r2), since rounding and truncation errors, initially very small, may 

80 
7. SERIES EXPANSIONS 
increase dramatically. Another serious difficulty is that it will be impos- 
sible to obtain reasonable shapes of electrodes or polepieces if the functions 
u,,(z) are only slightly different from those corresponding to a realistic 
field. This problem is further discussed in Chapter 34. 
In a realistic field computation, the first step is the solution of a 
boundary-value problem. In this way the axial harmonics u,n(z) can be 
determined uniquely. These have then to be differentiated numerically. Fi- 
nally (7,27) can be evaluated for arbitrary values of z and sufficiently small 
values of r (r/R ~ 10 -1, see Section 7.1). 
A very important practical application of the radial series expansion 
arises in general theoretical calculations, where no concrete numerical eval- 
uations are required. The purpose of such calculations is the derivation of 
general rules for focusing properties and aberration coefficients in classes 
of devices. In this context, it is often helpful to use simple analytic models 
of the axial field distributions. These models must contain some free pa- 
rameters with which a fit to a correct numerical solution for the u,,(z) is 
possible. 
7.2.2 Vector potentials 
Since the functions Cm(z,s) and D,,(z, s), introduced in Section 7.1.2, sat- 
isfy differential equations of the same basic type as (7.10), their radial series 
expansions must be similar to (7.27), always assuming that the domain of 
solution is source-free. Here we have to consider two series expansions, 
one for each of the two functions Cm(z, s) and Dm(z,s), but due to (7.15) 
and (7.22) these are linearly dependent. The consequence is that, though 
the three components of A(r) are different functions of position, only one 
axial harmonic IIm(z) can be introduced independently for each Fourier 
component. Since the scalar potential W itself, given by (7.23), has little 
significance, we define the axial harmonics by means of the relations 
II,,(z) :=-Dmlz(Z,0) 
, 
(m >_ 0) 
(7.2s) 
and hence 
Din(z, 0) = - f 
IIm(z')dz' 
--00 
(7.29) 
Applying (7.20) (with Lm(z, s) = 0), the radial series expansion of D,,(z, s) 
is then given by 
ff,~ 
m! 
_ 
n(2._~)(z ) 
Din(z, r 2) - - 
n!(m + m)! 
--" 
n--O 

7.2 RADIAL SERIES EXPANSIONS 
81 
= - / 
IIm(z') dz' + 4(m + 1) 
2!(m + 1)(m + 2) + O(~ 6) 
(7.30) 
The axial values of the function C,,(z, r 2) can be determined from (7.15). 
On the optic axis, the term sC,,,lo vanishes and using (7.28), we find 
C,.(z,O) = n.,_l(z)/m 
(m > 1) 
(7.3~) 
The series expansion for C,,(z, r 2) is given by 
c¢ 
m! 
_ 
C(m2n)(z, 0 ) 
era(z, r 2) = y~ n!(m + n)! 
n=0 
which must be similar to (7.27), since in the homogeneous case the cor- 
responding differential equations (7.10) and (7.17) have the same formal 
structure. With the aid of (7.31), we find 
o~ 
(m- 1)! 
n(2,) 
c,.(z, ~)= ~ 
.!(m + .)! - 
--,._1 
n-'O 
__ 
m--1 
- 
m 
- 
4m(m+l) 
+ 
2!m(m+ll(m+2) 
-O(r 6) 
(7.32) 
It is straightforward to prove, by carrying out the necessary differentiations, 
that (7.15) and (7.22) are satisfied. 
In order to obtain the complete series expansions of the vector potential 
A, the expansions, derived above, have to be substituted in (7.11) and 
(7.12). Practical expressions will be given in the next sections. Apart from 
the different notation, our results are identical with those given by Sturrock 
(1951). They differ from the formulae of Schwertfeger and Kasper (1974), 
which do not satisfy div A = 0, and also from those of Glaser (1952), in 
which A z = 0 is assumed and which do not necessarily satisfy A --. 0 
for z --. c¢. The particular gauge that does satisfy the natural boundary 
conditions is most convenient in practical applications. 
7.2.3 Explicit representations 
In almost all practical applications, it is quite sufficient to truncate the 
power series expansions of the potentials after the terms of fourth order in 
x and y, and consequently those of the field strength after the third order. 
These series expansions play an important role in the theory of electron 
optical aberrations. 

82 
7. SERIES EXPANSIONS 
In order to introduce a comparatively simple and easily remembered 
real representation of the series expansions, we define real axial harmonics 
p,,,(z), q,,(z), P,~(z) and Q,(z) as follows: 
(-1)" (p (z)-iqm(z)) 
m = O, 1,2,... 
(7.33) 
U,,(z,O) =: 
m! 
" 
j, 
¢-x)" 
m = 0, 
(7.34) 
D,,(z O) 
----_ *. 
' 
m! 
\ 
] 
Equation (7.33) will be used exclusively for the expansion of the electro- 
static potential ¢(r), while (7.34) will refer exclusively to the vector poten- 
tim A(r) and the flux density B(r). The Fourier coefficients with m = 0 
and m = 1 have a special meaning which will be encountered frequently. 
We therefore introduce a special notation for these coefficients apart from 
q0, which is identically zero: 
pO(Z) = ¢(Z) 
, 
pl(Z)-" Fl(z) 
, q~(z)= F2(z) 
(7.35) 
Here ¢(z) = ¢(z, 0, 0) is the familiar axial potential, F~ (z) = -q'l~(z, 0, 0) 
and F2(z) = -¢l~(z, 0, 0) are the transverse components of the field strength 
E on the optic axis. The electric potential is then given by 
1 
y~)¢"(z 
1 
y~)~¢(~)(z) 
¢(~) = ¢(z)- ~(~ + 
) + ~(~ + 
1 
y2)(xF~' + yF~') 
- ~r,(~) - yF~(z) + -~(~ + 
~-2(X 2- y2)p2(z)2t-xyq2(z)-- 2~(X 4- y4)p~__ ~___~(Xay + Xya)qt2' 
1 
1 
- -dps(z)(xs - 3xy ~) + -dqs(z)(yS - 3x~y) 
~4P4(Z)(X4 _ 6x2y 2 + y4) + 6qa(z)(xSy - xy a) 
(7.36) 
+ 
The corresponding series expansion in cylindrical coordinates reveals the 
structure better: 
r2(~n 
r4 (~(4) 
¢ = ¢--i-- +N 
r 3 
- r(F1 cos ~ + F2 sin ~) + ~(F~' cos ~ + F~' sin ~) 
r 2 
r 4 
+ -~-(P2 cos2v + q2 sin 2V) - ~-~(p~ cos2v + q~' sin2v) 
-- rZ (P3 cos 
r4 
3V + qs sin 3V) + ~-~(P4 cos 4~ + q4 sin 4V) 
(7.37) 
6 

7.2 RADIAL SERIES EXPANSIONS 
83 
For magnetic fields, we introduce the following special notation for the 
coefficients: 
II0(z)=:B(z) 
, 
Po(z) = - ] 
B(z) dz 
, 
Qo - O 
(7.38) 
~t 
--00 
Pl(z) =: Bl(z) 
, 
Ql(z)=: B2(z) 
(7.39) 
Again P0 is essentially a scalar axial potential, but here this has little 
physical meaning. The functions B(z), B1 (z) and B2(z) are, however, very 
important, since they represent the axial value of B(r)" 
B(O, O,z) = i~Bl(z) + iyB2(z) + izB(z) 
(7.40) 
The scalar magnetic potential is then given by: 
- f B 
+ 
+ 
+ 
W(r) 
- ~B~(z) - vB~(z)+ ~(~ + V~)(~B7 + vB~') 
1 
1 
4 
y4 
1 
+ ~(~ - v~)P~(z) + ~vQ~(z) - ~(~ 
- 
)P~'- ~(~v + ~v~)Q'~, 
1 
1 
1 
y2 
y4 
1 
+ ~--~(x a - 6x 2 
+ 
)P4(z) + ~(x3y - xya)Qa(z) 
(7.41) 
f 
r2 
r 4 B m 
W = - 
B dz + -~B'(z)- 
-~ 
(z) 
r 3 
- r(B1 cos ~ + B2 sin ~) + -~-(B~' cos ~p + B~' sin ~) 
r 2 
r 4 
+ -~-(P2 cos2~ + Q2 sin2~) - ~--~(P~' cos 2~ + Q~ sin 2~o) 
r 3 
r 4 
6 (P3 cos 3V + Qa sin 3~) + ~--~(P4 cos 4~p + Q4 sin 4~) (7.42) 
The vector potential is given by 
A~ = -~ 
B- g(~ + v~)B" 
1 
1 
1 
3 
4 
v ~)B;'' - ~ B~ + 
+ ~v ~ )B~" 
+ -4(x 2- y2IB' 2 - -~(x - 
-~(x y 
1 
1 
a 
12 (x3 - 3xy2)Q'2 - -i2 (y - 3x2ylP2 
1 
4 
y2 
y4 
1 
3 
+ ~-~(x --6x 2 
+ 
)Q~a - -~(x y- xy3)p~ 
(7.43) 

84 
7. SERIES EXPANSIONS 
Ay = ~ 
B- 
§& + 
¢).7' 
+ ~-(~ - y~)B~ - ~(~ 
- 
+ 
- 
+ ~y~)B~" 
1 
3 
3.2~)Q~ 
- ~(.~ 
-3.y*)p~ + ~(y 
- 
1 
y2 
y 4 
1 
1 
Az = -xB2(z) 4- yB1 (z) 4- ~(x 2 4- y2)(xB'2' - yB~') 
1 
y2 
1(x424 - y4)Q~ 4- l(x3y 4- xy3)p~, 
+ ~(x 2 - 
)O~- .yP~- 
1 
~(y3 
3X 2 
- g(x 3 - 
3xy2)Q3 
- 
- 
y)P3 
1 
4- 1(x4 _ 6x2y 2 4- ya)Q 4 - g(x3y - xy3lP4 
(7.45) 
24 
Differentiation using B = -VW = V x A and truncation of the resulting 
expressions beyond the third-order terms results in 
x B' 
~ 
+ 
B~=-~ 
(z)+__(x~ 
y~)B'" 
(3. ~ + ~)B~' - 4~ye~ ' 
a m  
+ B~(z)- 
13-,, 
1 
y3 
- ~P~ - yO~ + ~ F~ + i2(3~y + 
)O~ 
+ ~(~2 _ y2)p~ + 
d l  
x~JQ3 
1 
. 
~(y~ 
3~)Q, 
- ~(x 3 - 3xy2)p4 + 
- 
Y B'(z) + ~(~ + y~)B"' 
By = --~ 
+ B~(z)- !(3y~ + ~)B~' - ~~yB~' 
8 
ly3 " 
1-~ 
- xQ2 + yP2 - -~ P2 + 
( x3 + 3xy2)Q'~ 
1 
_ y2 
+ _~(~2 
)Q~ _ ~yp~ 
(7AO) 
(7.47) 

7.3 ROTATIONALLY SYMMETRIC 
FIELDS 
85 
1 
Bz = B- 
i(x 2 + y2)B" 
+ xB~ + yB~ - l(x2 + y2)(xB~" + yB~") 
1 
_ 
y2 
I 
- 5( ~2 
)P2 - xyQ2 
1 
1 
+ ~(x3 - 3xy~)P~ - ~(y3 - 3x2y)Q~ 
(7.48) 
In these formulae, general cartesian components Bx, B U, B, are clearly 
distinguished from their axial values B1, B2, B by the notation of the 
subscripts. The expressions for the electric field strength are obtained by 
interchanging the symbols as follows: 
B1,2 ~ F1,2 
, 
B ---*-¢' 
, 
B~,y,. ~ E~,y,, 
(7.49) 
Pj ~ pj 
, 
Qj -* qj 
The resulting formulae are not given explicitly here. 
7.3 Rotationally symmetric fields 
In Sections 7.3-7.5, we give the paraxial series expansions for the most 
important applications to be studied in later chapters in the notation that 
will be used there. 
7.3.1 Electrostatic fields 
Since it describes round lenses, the rotationally symmetric scalar poten- 
tial field is the most important special case. For electrostatic fields, the 
following identifications axe necessary in Sections 7.1.1 and 7.2.1: 
m = 0 
, 
Vo(z,s) = O(r) =: O(z,r) 
, 
Uo(Z) = O(z,0) =: ¢(z) 
With this notation, we obtain 
¢(z,~) = ~ 
(~)~ 
- 
¢(~-)(z) 
n--0 
(7.50) 
r 6 
_~2 
~~ ¢(~) (z) - 
¢(~)(z) + o(~ ~ ) 
= ¢(z) - ~-¢"(z) + 
2304 
The cartesian components of E = -grad ~ are most rapidly obtained by 
direct differentiation of (7.50): 
r 2 
r 4 
r 6 
E,(z, r) = -¢'(z)+ -~-¢(3)(z) - ~--~¢(5)(z) + 2--~¢(7)(z)- O(r s) 
(7.5~) 
r 
x 
y 
Er=--~RE, 
Ex=--~RE, 
Ey=-sRE 
(7.52a) 

86 
7. SERIES EXPANSIONS 
with 
r 2 
r 4 
r 2 
RE(~, ~ ~) := ¢"(z)- ~¢~')(z)+ 1--~¢¢~)(~)- 9-5i-~¢¢~)(z)+ O(~ ~) (7.52b) 
It is possible to express (7.50) in closed form as a complex integral (Glaser, 
1952) 
2a" 
q~(z, r) = ~ 
¢(z + ircosa)da 
0 
This has, however, little practical value and does not circumvent the diffi- 
culties described above associated with the analytic continuation. 
In some electron optical devices, the space charge of the beam is im- 
portant. We therefore present here the corresponding series expansions. It 
is convenient to expand the space charge density ~(z, r) as in (7.50): 
~o~°(z'~) = ~] (.i)~ 
- 
..(z) 
n:O 
r 2 
r 4 
-- aO(z ) -- Tal(Z) 
-~- ~-~a2(z)--... 
(7.~3) 
The coefficients an are here independent functions of z. Substituting (7.53) 
into the axisymmetric form of Poisson's equation, 
02~ 
02~ 
I O,I, 
# 
O z----~ + -g~r 2 + 
= - - 
r 
Or 
~0 
and introducing for q~ a series expansion similar to (7.50) but with un- 
known coefficients still to be determined, we find after some elementary 
calculations 
• (z,~) = ¢(z)- ¥ 
+ a0(z 
+ ~ 
+ 
+ al(Z) 
2304 ~(e)+ 
+ 
+a2(z) 
+ 
(7.54) 
The coefficient a0(z), representing the most important space charge term, 
is related to the axial space charge density by ~(z, 0) = eoao(z). 

7.3 ROTATIONALLY SYMMETRIC FIELDS 
87 
7.3.2 Magnetic fields 
The series expansions for round magnetic fields are obtained by recogniz- 
ing that he formulae of Section 6.4 are a special case of those given in 
Sections 7.1.2 and 7.2.2. We need to consider here only fields in source-free 
vacuum domains, where a scalar potential W can be applied. 
Equations (6.23), (6.28) and (7.11), (7.12) describe the same field in 
different ways if 
II(z,r) = Cl(z,s) 
, ~ (Do(z,s)) = 0 
so that recalling (6.31)and setting m 
= 1 in (7.31), we have 
n(z, 0) = el(Z, 0)= n0(z)= B(z) 
B(z) being the axial flux density. From (7.32) we now have the series 
expansion 
1 
II(z,r) = Z 
n!(n + 1)! -4 
B(2n)(z) 
rim0 
r 2 
r 4 
r 6 
= B(z)- -~B"(z)+ 1--~B(4)(z)- 9216 B(6)(z) + O(r 8) 
(7.55,,) 
Using this, we obtain series expansions for the various components of A 
and related quantities: 
r 
Av = A = ~II(z, r) 
YII(z, r) 
, 
,~ = ~rr2n(z, r) 
XlI(z,~) 
Ay = ~ 
(7.55b) 
Az = 0 
(7.55c) 
The components of B can be obtained in two different but equivalent ways, 
from B = V x A and from B = -VW. In the latter case we have to start 
from (7.30) with W = Do(z, r2). In both cases, we arrive at 
r2 BU 
~4 
r6 
Bz(z, r) = B(z)- 
(z) + 
B(4)(z)- 2304 B(6) (z) + O(r 8) 
(z.56~) 
r 
x 
!/ 
Br=-~RM, 
Bx=-~RM, 
By=-~RM 
(7.56b) 
with RM = i)II/Oz given by 
r 2 
r 4 
r 6 
RM(Z, r 2) = B'(z)--~B'"(z)+T~B(5)(z)- 9-~B(7)(z)+O(rS ) (7.56c) 

88 
7. SERIES EXPANSIONS 
Fig. 7.1: From left to right, multipoles of order m = 1 (dipole), m = 2 (quadrupole), 
m = 3 (sextupole) and m = 4 (octopole). The optic axis is always perpendicular to the 
plane of the diagram. 
These expressions are of particular interest in connection with the physics 
of round lenses. 
For completeness, we state the series expansions of the scalar potential: 
r6 
r2B'- r4 
'" 
B (5)-O(r 8) 
W(z,r) = - 
B dz + -~ 
-~B + 2--~ 
(7.57) 
On comparing all these series expansions, there are seen to be only two sets 
of denominators, which appear frequently in different contexts. 
7.4 Multipole fields 
In electron optics the meaning of this term is slightly different from that 
familiar in electrodynamics. In the present context, we do not consider 
series expansions of fields in terms of spherical harmonics but only those in 
terms of the azimuth in cylindrical coordinates, as given by (7.5) and (7.9). 
Multipole fields are then those that have well-defined symmetry properties 
with respect to the azimuth ~0, as is illustrated schematically in Fig. 7.1. 
In practice, such fields are often created by a suitable configuration of 
electrodes and polepieces, their major axes being parallel to the optic axis, 
see Fig. 7.2. Since the extent of these elements must be finite, fringe fields 
are inevitable. It is thus impossible to create 'pure' multipole fields in the 
sense that their dependence on the azimuth ~0 corresponds to a single har- 
monic (or finite number of them). In practice this is of no consequence; the 
only essential requirement is that a well-defined symmetry exists. Conse- 
quently each physical multipole field consists of a superposition of different 
harmonics having the same symmetry properties. The field is then classi- 
fied by its lowest order harmonic component. Here we state explicitly the 
electrostatic multipole potentials of the lowest orders m = 1 and m = 2. 
The dipole field (m = 1) is characterized by having only one plane of 
even symmetry and a perpendicular one of odd symmetry. Commonly, two 

7.4 MULTIPOLE FIELDS 
89 
Y 
\ 
x 
Fig. 7.2: Simplified diagram of a real quadrupole (see also Fig. 19.1). 
such fields, rotated at 90 ° with respect to each other, are superimposed; 
the potential is then given up to terms in r 5 by 
--~D = r cos~ Fl(z)- 
+ -~F(14)(z) 
+ 
," ¢osav p.(z)- T6p~(z) 
+ -~,~ cos 5v p~ (z) + o(,~ ) 
+ rsinqo F2(z)- --~F~'(z) + 192~2 
+ ~-,~ si~ 3~ q~(z)- igq'~'(z) 
+ 1--~r5 sin 5~0 qs(z) + O(rT) 
(7.58) 
120 
Such fields are employed in deflection units, see Chapters 32 and 40. 
The quadrupole field (m = 2) is characterized by two perpendicular 
planes of even symmetry and two planes of odd symmetry, inclined at 45* 
relative to the former. More generally, two such fields, inclined at 45 ° with 
respect to each other, may be superimposed. The electrostatic potential is 
then given up to terms in r 6 by 
12 
{ 
r2 
3-~4 
} 
ll / Z'~ 
aQ = ~r cos2~ p:(z)- ~P2~, }+ 
P~4)(z) 
lr2 
{ (z 
r2 ,,r 
r4 _(4) } 
+~ 
sin2~o q2 )-~q2tz)+~q2 
(z) 
+ 7--N 
p~(z)¢os6~, + q~(~)sin6~, 
+ o(, ~) 
(7.59) 

90 
7. SERIES EXPANSIONS 
Fields of this type occur in multiplets of quadrupole lenses (Chapter 29) 
and in stigmators (Chapter 32). 
The radial series expansions of the multipole fields of higher multipli- 
city (m > 2) can be terminated after the nonvanishing term of lowest 
order. The reason for this is that, within the paraxial domain, these fields 
represent only weak perturbations or corrections. The potential is then 
given by 
m! 
pm(z)cosm~p 4" q,,(z)sinmcp 
(7.60) 
So far we have given explicit expressions only for the electrostatic potential 
¢. The corresponding magnetostatic potential W is obtained by replacing 
the symbols as follows: 
¢---, W 
, 
F1---+ B1, 
F2 ---+ B2 
, 
pi ---* Pj 
, 
qJ "~ Qi 
(7.61) 
for each subscript j. 
7.5 Planar fields 
In Section 6.5 we introduced planar solutions of Laplace's equation as ana- 
lytic functions of a complex variable z 4- ix. This slightly unorthodox choice 
was adopted for the purposes of electron optics, where the z-axis is almost 
always made to coincide with the optic axis. We now reconsider planar 
fields in the (z, x)-plane, confining the discussion to fields with well-defined 
symmetry properties. 
The power series expansion of potentials with odd mirror symmetry 
with respect to the plane x = 0 is given by 
• 
o~ 
(-1)" x2,,+lF(2,,)(z ) 
= 
(2. + 
n-'0 
X 2 
(7.62) 
It is easily verified that this is a solution of Laplace's equation. The function 
F(z) = -OV/Ox, (x = 0), has the meaning of an axial field strength. 
Fields of this type are approximately realized in the electric deflection 
units of oscillographs (Chapter 32) and (as the analogous magnetic poten- 
tiM) in the fringe-field domains of sector magnets with plane fronts (see 

7.6 FOURIER-BESSEL SERIES EXPANSIONS 
91 
Chapter 52). Equation (7.62) can be transformed into a special case of 
(7.58), the nonzero axial harmonics then being 
1 F"(z) 
, 
ps(z) = l~f(*)(z) 
(7.63) 
pl(z) ---- r(z) 
, 
p3(z) = -~ 
This shows that the planar deflection field is a special type of dipole field. 
The paraxial series expansion of potentials with even mirror symmetry 
with respect to the plane x = 0 is given by 
z2 
z4 ¢(4)(z ) - 
z 6 
(I)(z, x) = ¢(z) - -~¢"(z) + ~ 
7-~¢(6)(z) + O(x s) 
(7.64) 
¢(z) being the potential in the symmetry plane. These planar fields are a 
special case of multipole fields with p2 = -¢"/2, p4 = ¢(4)/8. They occur 
in electrostatic slit lenses. 
7.6 Fourier-Bessel series expansions 
In Section 7.1 we introduced azimuthal Fourier series expansions with co- 
efficient functions depending on z and r. The evaluation of the paraxial 
series expansions, derived in the subsequent sections, is not the only way 
of calculating the coefficient functions. An alternative procedure is to sep- 
arate the general scalar potential V(r) into two functions, one in z only, 
the other in r only: 
Vm(z, v) = r'~U,n(z, r 2) =: Zm(z)Rm(r) 
(7.65) 
When this is introdueed~together with a factor exp(im~0)~into Laplaee's 
equation, ordinary differential equations are obtained" 
Z"(z) + k2Z,n(z) = 0 
(7.66a) 
n"~(z) + -nm(z ) 
+ 
Rm(r) = 0 
(7.66b) 
7 
The separation constant here has an arbitrary positive value k 2. The gen- 
eral solution of (7.66a) is 
Zm(z ) --Cm(k)e ikz 
, 
(-¢x:) < k < (x)) 
(7.67a) 
Cm(k) being any regular function of k. Equation (7.66b) is the differential 
equation for modified Bessel functions, its regular solution being given by 
Rm(r) = Im(kr) 
(7.67b) 

92 
7. SERIES EXPANSIONS 
Putting all this together, we obtain a solution of Laplace's equation in the 
form of a Fourier-Bessel series expansion: 
oo 
oo 
m--'O 
~ oo 
(7.68) 
The paraxial series expansion can now be obtained by introducing the well- 
known Taylor series expansion 
(:/4)- 
Ira(x) = 
~ 
n!(m + n)! 
rt-'O 
(m = O, 1, 2,...) 
(7.69) 
with z = kr into (7.68). The resulting expression will not be given here. 
The main difference between it and (7.27) is that repeated differentiations 
are replaced by Fourier integrals. 
The most important special case is that of rotational symmetry, m = 0, 
(7.68) then simplifying to 
oo 
V(z,r) = / Co(k)eikZIo(kr)dk 
--OO 
(7.70) 
The reality of this expression is guaranteed by requiring that 
C~(-k) = Co(k) 
(7.71) 
This Fourier coefficient C0(k) is the Fourier transform of the axial potential 
uo(z). The relation between differentiations and Fourier transforms is very 
simple here: 
oo 
u~ ~) (z) = / (ik)~Co(k)e ikz dk 
(7.72) 
Furthermore, it is easy to determine Co(k) from the boundary values V(z, a) 
of the potential on the surface r = a of an infinitely long cylinder. Applying 
the inverse Fourier transform to (7.70) with r = a, we obtain rapidly 
--I 
oo 
Co(k)={27rlo(ka)} 
/V(z,a)e-i'~dz 
(7.73) 
This expression satisfies (7.71). 

7.6 FOURIER-BESSEL SERIES EXPANSIONS 
93 
Historically, (7.70) and (7.73) have played an important role in the 
development of simple analytic field models for round electron lenses. A 
few details are given in Chapters 35 and 36. Nowadays, interest in these 
models has dwindled, for it is as easy to calculate field distributions ex- 
actly as to match parameters to a model. One or two models remain useful 
for teaching purposes and to gain a rapid qualitative understanding of the 
dependence of the properties of some device on various parameters. Nev- 
ertheless, the Fourier-Bessel series expansion is still of some importance. 
For instance, van der Merwe (1978a,b, 1979, 1980) used it to calculate ro- 
rationally symmetric lenses and Franzen (1984) applied it to quadrupole 
lenses in cathode-ray tubes. 

8 
Boundary-Value Problems 
Hitherto we have concentrated on fields in the extended paraxial domain. 
We axe in a position to carry out the field calculation once a sequence of 
axial harmonics urn(z), m = 0,1,2,... is known, but these functions are 
so far unspecified. The potential inside a domain of solution is specified 
by its boundary values at the surfaces of this domain and by its source 
distribution. We elaborate on this in the following sections. 
8.1 Boundary-value problems in electrostatics 
In electron optics, the electric fields inside insulators and in current-carrying 
metal conductors are of very little interest and will not be considered here. 
The domain of solution is the vacuum part of the device in question. This 
may be multiply connected but it always contains the optic axis. Its bound- 
ary is formed by the surfaces of all surrounding metallic electrodes or at 
least by relevant parts of these. It may prove to be convenient to assume 
that parts of the boundary are located in the vacuum and even to extend 
these to infinity, though this is clearly an idealization. 
In almost all cases of practical interest, the electric field exhibits sim- 
plifying symmetry properties, since a completely unsymmetric field serves 
no practical purpose. Imperfections in the machining of the electrodes will 
not be considered here; this topic is treated in Section 9.4.6. Any symme- 
try properties of the field can be exploited to reduce the relevant domain 
F of solution; the field obtained is subsequently completed by means of 
symmetry operations. 
These remarks are illustrated in the example shown in Fig. 8.1. The 
appropriate choice of the domain F and its boundary OF does, of course, 
depend strongly on the particular properties of the device in question. 
Whenever it is sufficient to consider the field in a planar axial section 
through the device, we shall adopt the notation presented in Fig. 8.2. The 
vectors n and t are unit vectors. The surface normal n is directed outwards 
from medium 1, even in the general three-dimensional case. The contour of 
the boundary in the axial section will always be oriented positively in the 
sense shown in Figs 8.1 and 8.2. This choice will be adopted throughout 
this Part. In the case of electrostatic fields, the medium 1 will be identical 
with the domain F of the desired solution. 

8.1 BOUNDARY-VALUE PROBLEMS IN ELECTROSTATICS 
95 
6 
I 
Z 
I 
I 
Fig. 8.1" Round symmetric electrostatic lens. The domain £ within which the solution 
is sought can be confined to the vacuum region for which z >_ 0, 
r >_ 0. Whether 
the domain F must be closed or can be extended to infinity depends on the method of 
calculation. 
-C 
medium 2 
-R 
/ 
medium 1 
Z 
Fig. 
8.2: 
Unit vectors normal to the surface (n) and tangent to it in the meridional 
section (t) at an arbitrary point P of the boundary. The unit vector i v is perpendicular 
to the meridional section shown and satisfies i v - t x n. 
The boundary-value problem for the electrostatic field is now defined 
in the following manner: 
(i) At all electrode surfaces the electrostatic potentials O(r) must have 
a constant value equal to the known potential of the corresponding 
electrode. 
(ii) If the boundary consists of several separate parts located in the vac- 
uum, the corresponding surface potential is generally not constant and 

96 
8. BOUNDARY-VALUE PROBLEMS 
(iii) 
(iv) 
is to be defined reasonably, for instance by means of linear, quadratic 
or logarithmic interpolations. This situation often arises in narrow 
gaps between electrodes. 
If a plane of negative mirror symmetry of the potential forms a part of 
the boundary, the potential over this plane is constant, usually zero. 
At all infinite parts of the boundary, the potential is constant. These 
constant values must be chosen consistently. 
(v) At all planes or at an axis of positive mirror symmetry, the normal 
component of the field strength (normal derivative of the potential) 
vanishes. 
The optic axis in every rotationally symmetric device is 
certainly such an axis. 
The boundary-value problem, specified in this manner, has a unique 
solution, and later we shall describe computational methods for obtaining 
this solution. In this context, the following relations are very useful. Since 
all electrode surfaces must be equipotentials, the field strength on their 
vacuum side is given by 
1 
E(,) = ---o(,)n(,) 
£0 
Its magnitude is then 
-E-n 
- On = a(r)/e0 
(8.2) 
Throughout this Part the symbol O/On = n. V denotes the familiar nor- 
mal derivative. The function a(r), defined for all metallic surfaces, is the 
surface charge density. Initially, this function is unknown, but once the 
boundary-value problem has been solved it may be used with advantage in 
the ensuing field computations, see Chapter 9. 
8.2 Boundary conditions in magnetostatics 
Whereas the material properties, of the metallic electrodes are unimportant 
in electrostatics, since the electrostatic field vanishes inside any conductor, 
the situation in magnetostatics is far more complicated. Apart from the 
case of perfect superconductors, the magnetic field inside polepieces does 
not vanish. In consequence, it is not always possible to confine the domain 
of solution to the vacuum part of the field. It is of course this region 
that is of greatest interest for calculating the optical properties, but a 
knowledge of the field distribution in the yoke is often needed when the 
shape of the latter is being designed. In the most general case, the field 

8.2 BOUNDARY CONDITIONS IN MAGNETOSTATICS 
97 
Fig. 8.3" Representation of a surface current distribution; the direction of the vector w 
is the same as that of the tangent. The current increment dI = w • ds is constant along 
the stripe indicated. 
computation will become extremely complicated; instead of treating this, 
therefore, we shall consider some classes of important field configurations 
with simplifying properties. First, however, we shall formulate the general 
boundary conditions, which must always be satisfied. 
We shall use the notation explained in Fig. 8.2; here medium 1 is the 
vacuum while medium 2 is any ferromagnetic or superconducting material. 
In the general case, at all surfaces of materials, the interface conditions 
n.(B2 -B1)=0 
(8.3) 
n x (/-/2- H1)= to(r) 
(8.4) 
must be satisfied, the subscript referring to the material in which the field 
vectors are defined. The function w(r) is the surface current density. 
This 
is a vector function defined only on surfaces. It must always have the same 
direction as the local tangent: w(r) = w(r)t~(r), t~(r) being a normalized 
tangential vector which may differ from the vector t introduced earlier. The 
physical meaning is as follows: dI = w(r)ds is the electric current flowing 
through a surface line-element ds oriented perpendicularly to to(r), see Fig. 
8.3. The whole distribution of surface currents must, of course, satisfy the 
requirements for the conservation of electric current. 
Such surface current distributions arise in superconducting devices. 
They are caused by induction effects, when the field in the vacuum domain 
is switched on. Furthermore, surface current distributions offer a conve- 
nient way of describing fiat layers of current-conducting windings located 
in the vicinity of the surfaces of magnetic shielding tubes. Further examples 
are given below. 
In very many cases, the function w(r) vanishes identically, (8.4) then 
simplifying to 
n x (/-/2 -- Hi ) = 0 
(8.5) 
Equation (8.3) expresses the continuity of the normal component of B, 
while (8.5) implies that the tangential component of H is continuous. Even 

98 
8. BOUNDARY-VALUE PROBLEMS 
////////////// 
ttl 
BI 
r~ 
s2/s 
//////z 
Fig. 8.4: Refraction of lines of magnetic flux for 122//21 : 50. 
when saturation effects occur, we may introduce material coefficients (6.3 
or 6.19). Writing Bj = #jHj, ~tj = 1/vj for j = 1,2, we can now derive 
the familiar law for the refraction of flux lines (Fig. 8.4): 
tan a2 
#2 
- 
(s.6) 
tan o/1 
~1 
The continuity laws break down at sharp edges, where no local surface 
normal n can be defined. We shall therefore assume that such edges are 
slightly rounded off, as is the case in all practical devices. 
These interface conditions are very simple but refer to vector fields. 
The computation of vector fields is possible in principle but is usually 
complicated, requiring much computing time and memory capacity. 
It 
is therefore advantageous to use scalar potentials from which the field can 
be determined by differentiation. Unfortunately, the scalar potentials X(r) 
and II(r), introduced in (6.11-6.12) and (6.28) respectively, are of only very 
limited applicability. In order to circumvent this difficulty, it is usual to 
separate the magnetic field strength H(r) into the contribution H0(r) of 
the isolated coils in vacuum and the contribution HM(r) of the ferromag- 
netic parts, 
H(r) = H0(r) + HM(r) 
(8.7) 
By definition the following conditions are to be satisfied in the whole space: 
div H0(r) = 0 
, 
curl H0(r) = j(r) 
(8.8) 
Together with the natural boundary conditions at infinity, this is already 
sufficient to calculate H0(r) uniquely by means of Biot-Savart's law: 
[ (¢- ~) x j(~') d~, 
H0(r) 
(S.9) 
47fir, - r] s 
r 
J 

8.2 BOUNDARY CONDITIONS IN MAGNETOSTATICS 
99 
S 
d__= :-=-=---- -/ 
f2 
Fig. 8.5: Pair of saddle coils. The arrows indicate the local direction of the electric 
current. The solid angle subtended by the upper surface at some arbitrary point P is 
denoted by Ft. The solid angle subtended at P by the lower surface can likewise be found 
and is to be subtracted from ft. 
This function can be obtained by differentiation of potentials. In the general 
case, the vector potential is appropriate: 
~0 f j(~' )d ~ ~' 
1---curl A0 
, 
A0(r) --= ~ 
i r-S -- ~1 
(s.z0) 
H0- 
#0 
In simply connected domains excluding any sources, we may also use (6.11- 
6.12). For a single closed winding carrying an electric current I, this rep- 
resentation takes the familiar form 
da' 
I 
(~- ~') :1~ 
(8.11) 
H0 =-gradx0 
, 
X0(r)= ~ 
Ir-r' 
s 
The two-dimensional surface integral is to be evaluated over any surface S 
enclosed by the windings. An example of this is shown in Fig. 8.5. Since 
the integral in (8.11) is equal to the solid angle f~ under which the winding 
would be seen from the point r (see Fig. 8.5), X0(r) is known as the 'solid 
angle potential'. 
As the point r passes through the surface S, xo(r) varies 
discontinously, the jump being ±I. In the case of several closed windings 
the contributions of all the windings are to be summed up appropriately. 
Important practical applications of this integral are given in Chapter 40. 
The representation (8.11) is most convenient in the extended paraxial 
domain, since it is always possible to define the surfaces S of integration 
in such a way that (8.11) is unique in this domain. 
Apart from some 
special cases, (8.10) is less convenient. The evaluation of (8.9) is always 

100 
8. BOUNDARY-VALUE PROBLEMS 
possible. In the case of surface current distributions the three-dimensional 
integration collapses to a surface integration, which means that j(r~)d3r ~ is 
to be replaced by w(r')da'. In every case, the resulting function H0(r) is 
unique in the whole space. In the following considerations we shall assume 
that these integrations can be carried out for all points of reference r that 
are to be considered. 
Let us now focus our attention on the second term HM(r) in (8.7). 
Since the whole current density j is already associated with H0, the field 
HM must satisfy curl HM --= 0, and hence 
HM(r) = -grad XM(r) 
XM(r) being a unique scalar potential in the whole space and defined as 
the reduced magnetic scalar potential. In every unsaturated medium (# = 
const) it can be concluded from div B = 0, div H0 = 0 and div H = 0 
that div HM -- 0 so that 
V2XM(r) = 0 
for 
# = const 
(8.13) 
This is invalid at the material surfaces, where formal scalar surface charge 
distributions must be introduced; these are the analogue of electrostatic 
surface charges. Magnetic surface charges, however, have no physical mean- 
ing, but are only a convenience in calculating, as will become obvious in 
Section 9.2. 
The interface conditions (8.3), (8.4) and (8.5) are considerably simpli- 
fied by the separation in (8.7) combined with (8.12). Since XM(r) must be 
a unique function in the whole space, this potential itself and the tangen- 
tim components of its gradient must be continuous at all material surfaces, 
while the normal component will be discontinous. The field contribution 
H0 has the opposite behaviour: its normal component is continous at inter- 
faces, while the tangential components are discontinuous, the corresponding 
jump being obtained from (8.4): 
This jump is already considered in the Biot-Savart integration over the 
surface currents and hence (8.4) and (8.5) contain no further information. 
Introducing (8.7) and (8.12) into (8.13) and using the fact that 
Bj = #jHj = #j Ho - VXu 
(j=1,2) 
J 

8.3 EXAMPLES OF BOUNDARY-VALUE PROBLEMS 
101 
r / " / / / , / , / / / , / / / / / / / /  
/ 
_ . 
/ 
Pig. 8.6" Magnetic flux lines in a superconducting device; the upper half of an axial 
section is shown. 
on both sides of the corresponding interface, we obtain the fundamental 
interface condition 
-- /21 
.... 0r~ 
-- (/22 
-- /21) 
•" H0 
(8.15) 
/22 
0n 
2 
1 
The implementation of this condition will be examined in Section 9.2. 
8.3 Examples of boundary-value problems in magnetostatics 
In this section we shall confine our considerations to important classes of 
boundary-value problems in the proper sense, by which we mean cases in 
which it is possible to confine the necessary field calculation entirely to one 
medium (1). The subscript 1 will then be omitted when this does not cause 
confusion, and we set /21 = 
/20 when medium (1) is the vacuum. 
8.3.1 Devices with superconducting yokes 
Owing to the Meissner-Ochsenfeld effect, the magnetic field is completely 
expelled from the interior of any superconductor. On the vacuum side of its 
surface the magnetic field must have a locally tangential direction, see Fig. 
8.6. This condition can be satisfied only by the presence of appropriate 
surface current distributions w(r), which are unknown prior to the solution 
of the corresponding boundary-value problem. Since co(r) must be known 
in order to calculate H0 (r), the separation (8.7) is unhelpful in this context. 
In rotationally symmetric devices, the necessary boundary conditions 
are most simply satisfied by use of the flux potential 9. From (6.32) it is 
obvious that B is tangential if the boundary contour C is a line q = const. 
The Dirichlet problem for q(z, r) is then very simple: 
- 
- 
con 
t 
, 
(z, 
e C 
(S.16) 
• (z,0)-0 
, 
-oo<z<oo 

102 
8. BOUNDARY-VALUE PROBLEMS 
! 
.
.
.
.
 
I 
.
.
.
.
.
 
l 
_ m  
Z 
Fig. 8.7: Highly simplified axial section through a conventional magnetic lens. 
For the field in the paraxial domain, the potential II(z, r) is more suitable. 
From (6.27), (6.28) and from the regularity requirements at the optic axis, 
the boundary conditions 
II(z,r) = ~B/~rr 2 , 
(z,r) e C 
(8.16a) 
OH~Or = 0 
for r = 0 
can be derived. The solution of the corresponding boundary-value problem 
for II is not unduly complicated. The constant q B has the physical meaning 
of the total flux through the bore of the superconducting polepiece. 
An analogous Dirichlet problem can be formulated for planar fields 
but this will not be treated here since the simplification to planar field 
structures is generally not satisfactory in superconducting devices. 
8.3.2 Conventional round magnetic lenses 
Figure 8.7 shows an axial section through a typical magnetic lens, and Fig. 
8.8 the relevant vacuum domain of the magnetic field. The contours of 
the casing are schematically simplified. It is only approximately possible 
to confine the field calculation to the domain F; for this the following 
assumptions must be made: 
(i) The permeability of the casing material must be extremely high, #2 >~ 
104#0, and saturation effects must nowhere occur. 
(ii) The cross-section of the casing must be large enough to ensure that 
practically all the magnetic flux flows through the gap. 
(iii) The gap has to be long (in the radial direction) and narrow, so that 
the field between the pole faces may be regarded as practically homo- 
geneous. 

8.3 EXAMPLES OF BOUNDARY-VALUE PROBLEMS 
103 
' 
,~1//// 
I 
L 
|_ 
F 
I 
Fig. 8.8: Enlarged view of the region of Fig. 8.7 enclosed in dashed lines; the scalar 
potential X(r) is defined within the domain F. 
These assumptions cannot, of course, be satisfied precisely in a math- 
ematical sense. The following considerations represent a technical simplifi- 
cation. 
Since the currents in the coils are located completely outside the do- 
main F, we may use the total scalar potential x(r). From (8.6) we can 
conclude that the angle al on the vacuum side of the casing surfaces must 
be extremely small. Thus the flux lines intersect these surfaces practically 
ovthogonally. This implies that the surfaces may be regarded as equipoten- 
tials x(r) = const. One surface potential Xl may be chosen arbitrarily, for 
instance Xl = 0. The other is determined by Amp~re's law 
H. 
= 
= 
X1 - 
X2 
(8.17) 
dr 
NI 
In this relation NI is the total number of ampere-turns of the coil; the 
integration loop must enclose all the windings and must pass through the 
gap. 
The boundary-value problem to be solved now takes the following form: 
(i) Inside F the potential X(z, r) is to be calculated by solving V2X = 0. 
(ii) At the surfaces of the polepieces and in asymptotic regions of the bores 
the potential is constant, X1 or X2 respectively. 
(iii) At the upper part of the boundary, inside the gap, the potential is to 
be interpolated linearly. 
(iv) On the optic axis, OX/Or = 0 must be satisfied. 
The simplifying assumptions reduce this boundary-value problem to 
the analogue of an electrostatic problem and it can be solved by means of 
corresponding techniques. As in (8.1) and (8.2), it will be convenient to 
introduce formal magnetic surface charge densities, satisfying 
H(r) = --aM(r)n(r) 
(8.18) 
-H. n = Ox/On = aM(r) 
(8.19) 
Another problem that can be solved by employing the potential X(r) is the 
fringe field of sector magnets with screening plates (Part X). 

104 
8. BOUNDARY-VALUE PROBLEMS 
r" 
I 
I 
I 
I 
Z 
Fig. 
8.9: Axial section through a very simple unconventional magnetic lens. 
8.3.3 Unconventional round magnetic lenses 
The approximations described above are of limited application and may 
break down even when comparatively simple Configurations are considered. 
A typical example is shown in Fig. 8.9. The 'gap' in the shield of this 
lens is so wide that a simple linear interpolation is unreasonable and the 
distribution of the electric current in the coil is now of importance. This is 
clearly a case for the flux potential q(z, r), since the interface conditions 
are then strongly simplified. 
The continuity of the magnetic flux requires that q(z, r) be continuous 
at any material surface not conducting surface currents. Consequently the 
tangential component of V q is also continuous. 
Hence (8.3) is already 
satisfied: introducing (6.32) into (8.3) and recalling that n x i v = $ for the 
tangential vector r (Fig. 8.2), we do indeed obtain 
\ 
(, 
= (t 
The second interface condition is obtained by introducing (6.32) into (8.5). 
After some elementary calculations, we find 
u2 
= ul 
(8.20) 
2 
1 
In the case of an unsaturated casing with extremely high permeability, 
#2 >> #1, u2 << ul, it is reasonable to make the approximation u2 ---* 0, 
(8.20) then simplifying to 
(0~) 
=0 
(8.21) 
We now have to solve the following boundary-value problem: the domain 
F of solution is the whole of space excluding all ferromagnetic parts. Inside 
this domain (6.36) is to be solved. At the optic axis and at infinity, • must 
vanish, while at the iron surfaces the Neumann condition (8.21) must be 
satisfied. 

8.3 EXAMPLES OF BOUNDARY-VALUE PROBLEMS 
105 
I 
Y 
,yoke 
.
.
.
.
 
_ 
x 
(a) 
w,,n~,, ,:~.., 
I 
(b) 
Fig. 8.10: Simplified representation of a toroidal deflection system. (a) Axial section, 
(b) cross-section. 
The simpfifications introduced above are invalid if parts of the iron 
become seriously saturated. In cases where this is liable to occur, another 
approximate field calculation is to be used, which is described in Chap- 
ter 12. 
8.3.4 Toroidal magnetic deflection systems 
Such systems are frequently employed as scanning units, for instance in 
television tubes and scanning electron microscopes. A simplified diagram 
is given in Fig. 8.10. Two pairs of coils, rotated at 90 ° with respect to 
each other, are wound round a rotationally symmetric ferrite shield in such 
a way that each winding remains in a meridional plane. 
It is convenient to regard the coils as surface current distributions. 
Following Schwertfeger and Kasper (1974), the H-field inside the yoke may 
be neglected, since the permeability is very high. The deflection currents 
are never strong enough to cause saturation effects and we can therefore 
confine the following discussion to the vacuum domain F of the device. We 
now omit the subscript 1. In view of these assumptions, (8.4) simplifies to 
tt( ) × 
e or) 
(8.22) 
OF denoting the surfaces of the coils on their vacuum side. 
Since any 
integration contour which remains completely in the vacuum never encloses 
any current lines, 5~ H.dr = 0 is always valid and hence the scalar potential 
X is unique in the whole vacuum domain. Forming the vector product of 
(8.22) with n and introducing H = -Vx we obtain 
gradx- 
(n.gradx)n=o.,xn 
on 
OF 
(8.23) 

106 
8. BOUNDARY-VALUE PROBLEMS 
The expression on the left-hand side is the tangential component of VX; 
this now has a given value for all surface points. 
So far these considerations are quite general and are also applicable to 
deflection systems with saddle coils. The characteristic feature of toroidal 
systems is that the direction of the vector function w is meridional. This 
implies that w(r) may be written 
w(r) = J(~)t(r)/r 
(8.24) 
being the azimuth with respect to the optic axis and t(r) the local tan- 
gential vector in the meridional direction; J(~) is the azimuthal current dis- 
tribution function, which means J(~)d~ is the total electric current flowing 
through the windings located between ~ and ~ + d~. 
It is now possible to integrate (8.23), since (8.23) is consistent with 
the assumption that the boundary values of X are only dependent on ~o. 
Introducing VX = r-lx'(~)i~ and (8.24)into (8.23), and recalling that 
t x n = i~, we obtain X'(~) = J(~) and hence 
x(v) = x0 + f J(-)d. 
0 
OF 
(8.25) 
This is essentially the same as the formula of Schwertfeger and Kasper 
(1974); here the derivation is more general, since (8.23) may also be applied 
to more general types of deflection systems, see Section 9.4.4. 
The boundary-value problem to be solved is now comparatively sim- 
ple: at the surface OF of a rotationally symmetric shield the potential x(r) 
has uniquely determined boundary values which are not rotationally sym- 
metric. At infinity the potential must vanish, and in the vacuum domain 
F, Laplace's equation is satisfied. 
This presentation of the important classes of boundary-value problems 
is by no means complete. We cannot devote more space to them here but we 
hope that the reader has some impression of the complexity of the problems 
to be considered. 

9 
Integral Equations 
As is well-known in classical electrodynamics, it is possible to reduce the 
problem of solving a boundary-value problem to that of solving an integral 
equation. This is very advantageous since methods of field calculation based 
upon integral equations have gained great importance. In this chapter we 
shall present the general theory; details of numerical procedures are given 
in Chapter 10. 
9.1 Integral equations for scalar potentials 
In the following account, we consider a domain F in three-dimensional space 
and its boundary OF. Inside the domain F we attempt to solve a uniquely 
specified boundary-value problem for Poisson's equation (7.1) 
V2V(r) = -S(r) 
(9.1) 
9.1.1 General theory 
In order to obtain an integral equation, we start from Green's theorem for 
a modified domain F' with boundary OF' and for a variable of integration 
1, t 
- v-gy 
,/da' 
(9.2) 
F' 
OF' 
valid for any differentiable functions a(r') and V(r'), regardless of their 
special meanings. The operator 0/0n' = n'. V' is the so-called normal 
derivative, the derivative in the direction of the outward oriented surface 
normal n' on 0F'. The boundary Or' itself may consist of several distinct 
dosed surfaces and the integral on the right-hand side of (0.2) is then the 
sum of the contributions arising from the different surfaces; this summation 
is implicit in the notation. 
The function 6: in (0.2) can be chosen arbitrarily; the most suitable 
choice is the free-space Green's function, defined by 
G(r, r') - (4~'lr - r'l) -~ 
(9.3) 

108 
9. INTEGRAL EQUATIONS 
~21: 4 7r 
• 
~ 
--E' 
~3 : ~ 
~2: 2~ 
Fig. 9.1: Two-dimensional section through a three-dimensional domain F, showing 
various positions of reference points and the associated solid angles. 
and satisfying the differential equation 
V2G = V'2G ' = -~(r- 
r') 
where ~(r-r') denotes Dirac's distribution. The use of the latter is familiar 
but not always favourable. 
Difficulties arise if the reference point r is 
located on the boundary. In order to circumvent these difficulties, we do not 
employ the 6-function formalism but instead, we modify the given domain 
F as sketched in Fig. 9.1. An internal point r is completely enclosed by 
a small sphere of solid angle f~l = 47r. Around a regular boundary point, 
a small hemisphere with solid angle f/2 = 27r is excluded; at a sharp line- 
edge of intersection angle a, a spherical segment with solid angle f~3 = 2a 
is removed; finally, an external point r needs no exclusion surface and 
hence fh = 0. In the domain F', obtained after excluding the immediate 
neighbourhood of the reference point, (9.2) is valid. 
In order to simplify the notation, we introduce the abbreviation 
I 
for r 6 F, 
e(r) := ~,~Tra(r) = 
a/27r 
for r C OF, 
0 
for r ¢ F, 
(9.4) 
which implies that a = 7r, e = 1/2 for regular boundary points. We also 
write 
OV 
- n'. V'V(¢) 
(9.5) 
"- 0.'- 
oa 
"' ('-") 
(9.6) 
P(r, r'):- On'- 4=It- r'l 3 
At the boundary these normal derivatives will be discontinuous; they are 
then defined as the limits obtained on approaching from the interior of F'. 

9.1 INTEGRAL EQUATIONS FOR SCALAR POTENTIALS 
109 
Introducing all this into (9.2), we soon notice that only the terms 
involving P are critical so far as the limit of vanishing radius ~ of the sphere 
or sector of exclusion is concerned. We may then approximate the slowly 
varying function Y(r') by Y(r). Recalling that [r - r'[ = ~ = n'-(r - r') 
on the spherical surfaces S, we obtain 
f 
i)G 
f 
fda'4 
V(r') ~ da'--, V(r')P(r,r')da'+ lim V(r) 
Q--,0 
7r ~2 
OF' 
0P 
S 
The final, surface integral is just the expression e(r) defined by (9.4). The 
symbol j: denotes the principal value of the corresponding integral, defined 
as the value obtained by proceeding to the limit p ---, 0 in the integration 
over the not-excluded parts of OF. For reference points r outside OF this 
is straightforward; for r E OF this limit exists, since in this case we have 
n ~. (r- r') --, 0 due to the orthogonality between tangents and surface 
normals. In the subsequent presentation we shall not indicate the principal 
value explicitly since all improper surface integrals are to be evaluated in 
this way. 
Putting all this together, we arrive finally at 
,(,)v(,) = f G(,, ,')S(,')d', ' 
F 
OF 
(9.7) 
The expressions on the right-hand side can be interpreted in the following 
way: the first is a space-source term, the second a surface-source term and 
the last is a surface-polarization term. Since the boundary functions V(r') 
and a(r') are still independent, (9.7) alone does not suffice to determine the 
potential distribution uniquely. We may prescribe an additional boundary 
condition 
+ 
= 
, 
e or 
(9.s) 
the surface functions a(r'), b(r') and c(r') being known with a 2 + b 2 > 0. 
It is then possible to solve (9.7). We now discuss the two most familiar 
special cases. 
9.1.2 Dirichlet problems 
Here the boundary values Y(r') are specified uniquely, while a(r') is un- 
known. In (9.8) we may choose a = 1, b = 0; c(r') = Y(r') are then the 
given boundary values. Equation (9.7) is now a two-dimensional integral 

110 
9. INTEGRAL EQUATIONS 
equation of Fredholm's first kind for the unknown cr. After solving it, the 
same equation (9.7) can be used to evaluate the potential at any point r 
in r. 
Although this procedure is perfectly correct, it is rather inconvenient 
for numerical solutions since the factor e(r) is discontinuous and the po- 
larization term requires careful handling in order to obtain the appropriate 
principal value. It is therefore highly desirable to find alternative forms of 
the integral equation that do not contain these terms. 
If the boundary or consists of a number of closed surfaces with con- 
stant boundary values V on them, the difficult terms can be eiiminated 
completely. For simplicity, we consider only one such surface or, the do- 
main r being its ezterior. The second boundary is an infinite sphere; since 
the field is required to satisfy the natural boundary condition, this sphere 
need not be considered here. We now have to evaluate the integral term 
I := / P(r, r')V(r') da' = V / P(r, r') da' 
or 
or 
Since (9.7) is quite generally valid, we are at liberty to set V equal to a 
constant; for the moment, therefore, we introduce 
V-1 
, a-O 
, 
S-O 
and recalling that r is now the exterior, we obtain the mathematical iden- 
tity 
f P(r, r') da' = 1 - e(r) 
(9.9) 
or 
The integral expression I now simplifies to 
I = {1 - e(r)}V 
Introducing this into (9.7) we find 
v(,) 
= 
a,' 
r 
8r 
(9.10) 
This Fredholm equation for a is now quite generally applicable without 
exception. When the solution is still unknown, the reference point r must 
be located at the boundary and V(r) on the left-hand side is then the 
corresponding boundary value. After obtaining the solution for a, the same 
equation (9.10) may be employed to compute the potential at any point t 

9.2 PROBLEMS WITH INTERFACE CONDITIONS 
111 
in the space, even on OF or outside F. The potential itself is continuous if 
the reference point crosses the boundary. 
We can generalize (9.10) to include configurations with a boundary 
consisting of several closed surfaces and even boundary values of V that are 
not constant on these surfaces. The basic form of (9.10) remains unaltered, 
but now the surface charge density a is the difference between the normal 
derivatives of V on each side of the corresponding surface. 
Physically, 
(9.10) can be interpreted as a Coulomb integral over space charges and 
over surface charges as a degenerate case of the former. When it comes to 
numerical evaluation, (9.10) is far more convenient than (9.7). 
9.1.3 Neumann problems 
It is now the boundary values of OV/On that are uniquely specified while 
those of V(r) are unknown. This boundary value problem has a solution 
only if ~ a(r')da' vanishes on OF. In (9.8) we may specify a = 0, b = 1, 
so that c(r') = a(r') are given boundary values. Equation (9.7)is now 
an integral equation of Fredholm's second kind for the boundary values of 
V(r). Apart from an unimportant additive constant, this integral equation 
has a unique solution. After this has been found, (9.7) can be used to 
compute the potential V(r) at arbitrary points inside F. 
The polarization term cannot be eliminated from (9.7). 
Since this 
term contains a strong singularity and is discontinuous at the boundary 
OF, great care must be taken in numerical computations. Thus the con- 
crete evaluation of such expressions should be avoided whenever possible 
by appropriate transformation of the boundary-value problem. 
9.2 Problems with interface conditions 
The theory outlined in Section 9.1.1 is quite standard in classical electro- 
dynamics and can be applied to boundary-value problems in electrostatics 
and magnetostatics. The integral equation, given below, is less familiar. 
In connection with electron optical applications it has been mentioned by 
Kasper (1982) and explicitly derived by Scherle (1983), who also demon- 
strated that it can be applied in practical numerical computations. Alter- 
native formulations will be given at the end of this section. 
Since interface conditions are most important in magnetostatic prob- 
lems, we shall confine the discussion to these, although it would be no 
problem to establish an integral equation for electric fields. It is necessary 
to assume unsaturated (linear) media. For simplicity, we consider here only 
two different domains, the vacuum domain F1 and a ferromagnetic shield 
F2, F1 U F2 being the whole space. The convention concerning the choice 

112 
9. INTEGRAL EQUATIONS 
of the surface normal, represented in Fig. 8.2, then holds. Generalizations 
to more than two different domains have been worked out (Scherle, 1983); 
apart from the introduction of an iterative solution technique, they contain 
nothing essentially new; some results will be given in Chapter 10. 
We start from (9.7). The appropriate potential is here XM(r), intro- 
duced in (8.7) and (8.12). From (8.13), we see that there is no space-source 
term. On the boundary OF = F1 CI F2 we have e = 1/2 and hence (9.7) 
specializes to 
XM(r) -- (--I)J /{XM(r')P(r' r') -- G(r' r')aj(r')} 
(9.11) 
OF 
(j=l,2 
, re0F) 
The index j indicates the domain from which the surface 0F is approached; 
we recall that in the polarization term the principal value of the integral is 
to be taken. Since neither the potential itself nor its normal derivatives a 1 
are known, a second relation is needed, namely (8.15). This enables us to 
eliminate the normal derivative from (9.11) by forming appropriate linear 
combinations. In this context we need to use (9.5) with XM ~-~ V. The 
result of these elementary calculations is as follows: 
~ ~X M ~ + 
or 
OF 
with r E 0F and 
A'= -1 /~2 +/~1 
(9.13) 
2 /~2 -/~1 
This is an integral equation of Fredholm's second kind for the surface val- 
ues of the potential. Once it has been solved, the problem reduces to an 
ordinary Dirichlet problem. We can hence introduce the calculated surface 
values of XM in the left-hand side of (9.10) and solve this equation (with 
vanishing space-source S) for a. It can be shown that a = al -a2, but 
this is of little use, since the solution of (9.10) gives a directly. 
The derivation presented here differs from Scherle's method but is 
equivalent to it. In the literature on magnetic field computation, many 
other forms of integral equation are derived, which are essentially equiva- 
lent to (9.12), but not always so suitable for numerical evaluation. Many 
technical points are elucidated in the proceedings of COMPUMAG (1976) 
and the subject has been reviewed by Iselin (1981). Besides Scherle's the- 
sis, the publications of Lucas (1976) and Kuroda (1983) are particularly 
concerned with field calculation for electron optical designs by means of in- 
tegral equations. Scherle's method has the advantage that only one scalar 

9.3 REDUCTION OF THE DIMENSIONS 
113 
integral equation for a potential is needed instead of three coupled ones for 
a vector field and that the singularity of the integral kernel P(r, r ~) is the 
weakest possible. The field can be evaluated everywhere in space. 
9.3 Reduction of the dimensions 
The derivation of a two-dimensional integral equation means that three- 
dimensional unknown functions have already been reduced to two dimen- 
sions. Very often the integral equations obtained are soluble only numeri- 
cally. In electron optics, however, there is an important class of configura- 
tions that can be treated by means of one-dimensional integral equations. 
This is the class of all devices the electrodes or polepieces of which have 
rotationally symmetric surfaces. It is not necessary to assume that the 
boundary values are also rotationally symmetric. In Chapter 7 we have 
shown that the three-dimensional Poisson equation can be reduced to a se- 
quence of uncoupled two-dimensional equations by means of Fourier series 
expansions. Here we shall show that integral equations can also be sim- 
plified in an analogous manner. For Dirichlet problems, an approximate 
theory has been developed by Kasper and Scherle (1982) and by Kasper 
(1984a,b); the theory of a method of evaluating (9.12) has been developed 
by Scherle, who has also demonstrated that it can be applied in practice. 
9.3.1 Dirichlet problems 
The space-source term in (9.10) can now be omitted without loss of gener- 
ality. This term alone produces a particular solution Vo(r). If V, # 0, then 
the subsequent reasoning is valid for V- V, instead of V. Since this adds 
nothing new, we assume that S(r) - 0, (9.10) then simplifying to a pure 
surface integral 
1 / a(r') de' 
= 
(9.14) 
OF 
There is no advantage to be gained by separating the factor r m in (7.5) 
and we thus introduce the notation 
v(,)= 
tn--'0 
The boundary OF is suitably represented in parametric form in terms of the 
azimuth qo and the arc-length s along the meridional line C passing through 
the reference point v (see Fig. 9.2). Since OF is assumed to be rotationally 
symmetric, this line C can be represented by z = z(s), r = r(s). Whenever 

114 
9. INTEGRAL EQUATIONS 
F" 
o 
z(s) 
5 
r'(s) 
L 
Fig. 9.2: Meridional section through a rotationally symmetric boundary with contour 
C, along which the arc-length s is adopted as parameter. 
this causes no confusion, we shall omit the argument s and introduce the 
simplifying notation z' = z(s'), r' = r(s'). When z, z' and r, r' appear as 
arguments of functions, the vectors u = (z, r), u'= 
(z', r') will be used. 
The values of the functions Vm, occurring in (9.15), on the boundary 
are given by the inverse Fourier transform of Y(u(s), ~p) and hence depend 
on s: 
2~ 
/¢m / V(u(s), ¢p)e -im~ &p 
(9.16) 
= 
q g  
0 
with 
1 
for m = 0 
g.~ = 2- ~m,0 = 
2 
for m # 0 
(9.16a) 
It is helpful to expand the surface charge density a as a Fourier series with 
respect to ~: 
if(r)- 
Z 
~ 
O'm(3)eimcp 
(9.17) 
m-'-O 
Introducing (9.17) and (9.15) with the coefficients vm(s)into (9.14), we 
obtain 
Z ~ vm(s)eim~ = 
~" 
am(s')eim~' 
4~r[r- r'[ da' 
m=0 
m=0 
OF 
The distance D "= Iv- r' I is explicitly given by 
1 
D(u, u', a) = (z - z') 2 + r 2 + r '2 - 2rr' cos a 

9.3 REDUCTION 
OF THE DIMENSIONS 
115 
c~ = qo' - qp being the difference of azimuth. The element of surface area 
can be written as da ~ = r'ds~da. Eliminating qo ~, we find 
~ Vm(S)e im~ 
= ~ 
~ e im~ 
am(u, u')r'am(s')ds' 
rn=0 
m=0 
C 
where the abbreviation 
2~ 
1 / 
e ima da 
am(u, u') = ~ 
D(u, u', a) 
o 
has been introduced. This expression is a real function of its arguments, 
since it can be rewritten as 
1 / 
cos(ma) da 
Gm(u, u t) = ~ 
D(u, u', c~) 
o 
(9.19) 
From (9.18) the symmetry relation 
am(u, u') = am(u', u) 
(9.20) 
is obvious. These functions are essentially the Fourier coefficients of the 
free-space Green's function G(r, r'). 
From the uniqueness of Fourier series expansions, we now obtain a se- 
quence of uncoupled one-dimensional Fredholm equations, given in explicit 
notation by 
c 
for 
m-- 0,1,2,... 
(9.9.1) 
These have the formal structure 
vm(s) - f Km(s, s')am(s')ds' 
(9.22) 
c 
In Chapter 10 we shall show that the kernel functions Gm of (9.19) can 
be evaluated analytically and that the resulting expressions contain com- 
plete elliptic integrals. We shall further show that there are convenient 

116 
9. INTEGRAL EQUATIONS 
techniques for numerical solution of (9.22). Thus the solution of Dirich- 
let problems with rotationally symmetric boundaries can be regarded as a 
standard technique. 
9.3.2 Problems with interface conditions 
In the case of rotationally symmetric boundaries, Scherle's integral equa- 
tion (9.12) can again be decomposed into a sequence of uncoupled integral 
equations for the Fourier potentials Vm(z,r). 
As before, we start from 
(9.15), with V = XM. It is now necessary to introduce a Fourier series 
expansion for the component n. H0 appearing on the right-hand side of 
(9.12): 
Then, by arguments similar to those described above, we obtain first 
f 
• H0(,')da' = 
(9.24) 
or 
m=o 
with 
f 
qm(s) "= ~ Gin(u, u')r'N,,,(u') ds' 
(9.25) 
c 
This is a known function of s which can be evaluated by numerical inte- 
gration over s *. 
In order to evaluate the integral expression on the left-hand side of 
(9.12), we need the Fourier coefficients of the function P(v, r') defined by 
(9.6). Since the normal derivative involves only the coordinates z * and r *, 
the operator O/On t can be applied after the integration over ~* has been 
carried out. We thus obtain 
21r 
Pm(vt,, lt') " = f ~G(r, r')eim(~-~') dcp ' 
o 
(9.26) 
_- 0 G 
(u, u') 
c3n ~ 
Like the integral expressions (9.19), these functions take only real values 
but the symmetry properties do not hold. 
Introducing the Fourier series expansions of V(r) into the left-hand 
side of (9.12) and considering (9.26), we finally obtain a sequence of un- 
coupled Fredholm equations of the second kind: 
-Xvm(s) + J Pm (u(s), u(s'))r(s')v,~(s') ds' = q,~(s) 
(9.27) 
c 

9.4 IMPORTANT SPECIAL CASES 
117 
m =0,1,2,... 
Since Gin, Pm and A are real, it is sufficient to investigate solution tech- 
niques for real integral equations. Complex solutions can easily be obtained 
by forming linear combinations of real solutions with constant complex fac- 
tors. We have thus achieved a major simplification of the original boundary 
value problem. 
9.3.3 Planar fields 
In this case the integral equations are already familiar. 
We shall only 
examine briefly the Dirichlet problem in the (z,x) plane. 
Let C be a 
boundary line represented parametrically in terms of the arc-length s: z = 
z(s), x = x(s). This line may consist of several distinct curves. Let v(s) = 
V(z(s),x(s)) be given boundary values. Then the integral equation takes 
the form 
v(s) = f q(s')ln[al(z - z')2 + (x - x')21-½] ds' 
(9.28) 
c 
where z' = z(s'), x = x(s') has been introduced; a is an arbitrary pos- 
itive normalization constant and q(s ~) the source distribution function on 
C. 
Since the logarithmic kernel function is singular at infinity, either 
f q(s ~) ds ~ -- 0 or the entire field must be enclosed within a closed loop 
on which V is zero. 
9.4 Important special cases 
In this section, we shall examine some field calculation problems that can 
be solved by numerical evaluation of the integral equations derived above. 
Technical details are discussed in Chapter 10. 
9.4.1 Rotationally symmetric scalar potentials 
Here it is not necessary to carry out the Fourier series expansions; the re- 
quired results are obtained directly for m = 0. The function Go(u, u') is 
the scalar potential of a uniformly charged ring of radius r' or r and is 
treated in detail in Chapter 10. Equation (9.21) with m = 0 was the start- 
ing point for the development of the boundary-element method (BEM) of 
field calculation, first introduced by Cruise (1963) and extensively stud- 
ied by Harrington (Harrington, 1967, 1968; Harrington et al., 1969; Mautz 
and Harrington, 1970). This version of the BEM can be directly applied 
to electrostatic round lenses of various shapes (Lewis, 1966; Singer and 

118 
9. INTEGRAL EQUATIONS 
;~ II 
Fig. 9.3: The relation between vectors and angles in rotationally symmetric vector- 
potential fields. M is a fixed point and I is the integration point. 
Braun, 1970; Read et al., 1971; Adams and Read, 1972; Harting and Read, 
1976), electron guns with arbitrary rotationally symmetric cathodes (Rauh, 
1971; Kuroda and Suzuki, 1972), round electron mirrors and conventional 
magnetic lenses. 
9.4.2 Rotationally symmetric vector potentials 
Though the general theory was developed for scalar potentials, it can easily 
be modified to make it applicable to vector potentials. Since each cartesian 
component of A separately satisfies a Poisson equation like (9.1) with S 
#0jk (k = 1,2,3), the general conclusions leading to (9.10) must hold for 
each component of A separately. Collecting the three integral equations 
into a single vector expression, we now find 
= ,o / 
¢)Y(¢) 
+ ,o / 
da ' 
F 
OF 
(9.29) 
The condition div A = 0 is satisfied if the surface currents are conserved, 
as must be the case for physical reasons. 
In rotationally symmetric devices, the vectors A, j and ca have only 
azimuthal components (see also Section 6.4). In the important case of 
superconducting round lenses, the space currents j are absent, (9.29) then 
simplifying to 
2~r 
A(u) 
~to J / w(u')i~ " i~' r'ds'da 
c 
0 
where the notation introduced in Section 9.3 (u = (z,r) etc.) has been 
used. The factor cos a = i~. i~, arises from the projection of ca on the 
direction of A, see Fig. 9.3. Using (9.19) with m = 1, (6.27) and the 
boundary conditions (8.16), we finally obtain the integral equation: 

9.4 IMPORTANT SPECIAL CASES 
119 
t 
2~r~o ~ G1 (u, u')r' w(u') ds' = @B = const 
(9.30) 
which may formally be considered as a special case of (9.21) with v(s) = 
It is also of some interest that the azimuthal vector potential of a 
rotationally symmetric coil in the absence of magnetic materials can be 
represented by 
Ao(u) = I~o // Gl (u, u')r'j(u') dr'dz' 
(9.31) 
F 
F being the domain r' > 0 of the axial section through the coil. This is a 
special case of (8.10). 
9.4.3 Unconventional magnetic lenses 
In Section 8.3.3 we have indicated that such lenses can be treated by ob- 
taining the solution of a Neumann problem for the rotationally symmetric 
flux potential 9. Alternatively, they can be calculated as a special case of 
(9.25) and (9.27) with m = 0. In this case, no Fourier series expansions are 
necessary, the quantities of interest being the zero-order Fourier coefficients 
themselves. In this way really complicated devices with very open struc- 
tures like those investigated by Mulvey (1982) can be calculated, provided 
that saturation effects need not be considered. 
9.4.4 Magnetic deflection coils 
The following considerations (Kasper, 1984a) are valid for both toroidal 
coils and saddle coils. If the windings are so close to the shield surface 
that the surface current distribution approximation is reasonable, the to- 
tal scalar potential x(r) may be used. The boundary conditions on X(r) 
are given by (8.23). In the case of toroidal systems, we could integrate 
this equation, but in more complicated cases the corresponding integration 
becomes very complicated. The application of Fourier series expansions, 
however, makes this integration unnecessary, as we now show. 
We again represent each surface function as a function of the azimuth 
and the arc-length s along the axial contour C. The meridional tangent 
vector is t = Or/Os. The surface potential and its gradient are then given 
by 
X = X(~, s) 
VX = 10x i~, + OX 
OX 
(9.32) 
' 
r O~ 
-~st+-~n n 
The surface current distribution may be written 
(9.33) 

120 
9. INTEGRAL EQUATIONS 
Introducing (9.33) and (9.32) into (8.23) and recalling that t × n = i~ and 
i~ × n = -t, we obtain 
OX 
OX 
= rw, 
~ 
= -w~ 
(9.34) 
O~ 
' 
Os 
The condition obtained by evaluating ~X/O~pOs from each of these, 
02X 
0 
0 
O~Os = O-~ (~') = -~~ 
(9.35) 
is identical with the continuity equation for surface currents and thus im- 
poses a restriction on the choice of surface current distributions, which is 
automatically satisfied by any real distribution of wires. 
For a single pair of deflection coils, we can choose the origin of ~ in 
such a way that the appropriate Fourier series expansions can be written 
as 
w,(cp, s) = E Mm(s) cos(mT~) 
(9.36) 
m 
w~(~p, s) = - E Am(s) sin(m~) 
(9.37 / 
m 
X(qO, s) = ~ v,,(s) sin(mqo) 
(9.38) 
m 
m always being an odd integer. Introduction of these series expansions into 
(9.34) and (9.35) results in 
and 
vm(s) = 1 r(s)Mm(s) 
m 
, 
m 
= 1,3,5,... 
(9.39) 
vm(s) = ~s 
Mm 
= Am(s) 
, 
m= 
1,3,5,... 
(9.40) 
This is an important simplification. The boundary values v,,,(s) of the 
Fourier potentials are already uniquely determined by the Fourier coeffi- 
cients of the meridional component, while the azimuthal components A,, 
can be obtained by mere differentiation and are not needed explicitly for 
the solution of the boundary-value problem: the only major computations 
needed are the Fourier transformation of w, (~, s) and the subsequent nu- 
merical solution of (9.21). Thereafter the integral expression in (9.21) can 
be evaluated to give V,,,(z, r) at any point (z, r) outside the surface. 

9.4 IMPORTANT SPECIAL CASES 
121 
wlnctlmgs 
(a) 
(b) 
' 
Fig. 9.4: Simplified representation of a magnetic multipole system. (a) Cross-section, 
(b) meridional section. Only parts of the coils and the outer screening ring are shown. 
In the case of a purely toroidal system of coils the surface current 
density is given by 
~ 
= o 
, 
,,,, = x w(~)/,.(~) 
(9.41) 
I being the electric current through the windings and W(qo) the winding 
density, by which we mean that W(qo)dcp is the number of windings between 
~0 and ~¢ + d~¢. In this case (9.39) simplies to 
jf 
,~ 
.... 
w(v) co,(my) dv 
, 
m = 1, a, 5,... 
(9.42) 
rm 
0 
(Schwertfeger and Kasper, 1974). We cannot expect any further simplifi- 
cation, as we now have to solve Dirichlet problems with constant boundary 
values. 
If the windings are not close to the shield surface, as is frequently the 
case in systems of saddle coils, the one-dimensional integral equations aris- 
ing from Scherle's equation, namely (9.25) and (9.27), must be evaluated. 
Then, of course, the necessary computation is considerably greater but the 
results will be very accurate. The details are discussed in Chapter 40. 
9.4.5 Multipole systems 
Electric or magnetic multipole systems are commonly used as stigmators 
or as strong focusing lenses in electron optical devices. Nowadays such 
systems are also used as deflectors in scanning devices. Since these sys- 
tems are in no sense rotationally symmetric, the theory of one-dimensional 
integral equations cannot be properly applied to them. If, however, parts 
of the surfaces form a rotationally symmetric face and the gaps between 

122 
9. INTEGRAL EQUATIONS 
,ctrode 
creemlng 
(b) 
'o) 
Fig. 9.5: Simplified view of an electric multipole device. (a) Cross-section, (b) perspec- 
tive view of a single electrode. 
adjacent poles are comparatively narrow, as shown in Figs 9.4 and 9.5, the 
theory is approximately applicable. Magnetic systems like the one shown 
in Fig. 9.4 are in use in the devices developed by the Darmstadt group (see 
Rose, 1971; Rose and Plies, 1973) to compensate the third-order spherical 
aberration and the axial chromatic aberration in an electron microscope of 
very high resolution. Electric systems of the kind shown in Fig. 9.5 have 
been investigated by Munro and Chu (1982) and Chu and Munro (1982) 
and are used as deflection units in electron lithography devices. 
The approximation underlying the treatment of these systems is that 
in the gaps, it must be possible to make a reasonable interpolation for the 
potential with respect to the azimuth qa, usually by a linear expression. 
Then, on a rotationally symmetrical surface--consisting of the cylindrical 
bore, the gaps, the ring-shaped parts of the end-planes and sometimes parts 
of the outer surfaces of the poles and a screening surface enclosing the 
whole systems as well--reasonable values of the potential can be defined. 
These are then to be introduced into (9.16) after which the uncoupled one- 
dimensional integral equations (9.21) can be solved. The errors caused by 
the incorrect boundary values do not seriously influence the field in the 
paraxial domain. This approximation is therefore satisfactory. 
9.4.6 Small perturbations of the rotational symmetry 
Since it is impossible to build rotationaUy symmetric devices perfectly, the 
effects of small perturbations such as shifts, tilts or ellipticity of the pole- 
pieces or electrodes on the field in the paraxial domain are of interest. Such 
effects determine the tolerance limits for the machining of electron optical 
devices, and they have attracted considerable attention (see Chapter 31). 
The first successful attempts to calculate them numerically were made by 

9.4 IMPORTANT SPECIAL CASES 
123 
u/potenhal 
surface 
. 
rotahona/ly symmetmc 
surface 
Fig. 9.6: Simplified cross-section through an imperfect lens, showing the real and the 
ideal contour of a polepiece. The vectors W, d' and HI are the projections of the position 
vector r, the shift d(r) and the field strength H(r), respectively. 
Janse (1971). Here, we describe how his method can be used to calculate 
the field in an imperfect round magnetic lens. 
Janse's method is a perturbation calculus. First, as a zero-order ap- 
proximation, the ideal round system is calculated; along the contour C in 
the axial section through the system the boundary values H(s) of the field 
strength are then determined (s being the arc-length along C). This is 
illustrated in Fig. 9.6. Owing to the rotational symmetry of the perfect 
system, the field strength H(r) = H(~o,s) at any surface point r with 
coordinates ~0 and s is then known. 
In the next step a deviation function d(r) is defined as the local shift 
from the ideal surface to the real one. In the parametrization adopted here, 
this is a function d = d(~o,s). The shift may be in any direction but must 
be very small. This is illustrated in Fig. 9.6. 
Since the real distorted pole surface coincides with the equipotentials 
X(r + d) =const, the potential at the ideal round surface is perturbed by 
a quantity 
or 
6X(r) = X(r) - X(v + d) ~ -d. grad X = d(r). H(r) 
6X(9~, s) = d(T, s) . H(T, s) 
(9.43) 
(9.43a) 
This function represents the boundary values of a perturbation potential 
and is to be introduced into (9.16). The integral equations derived above 
can then be applied go this problem. 
Janse did not in fact use integral equation techniques but solved the 
Dirichleg problems corresponding to (7.10) with vanishing source terms 
by means of the finite-difference method. By solving (9.12) with V _= X, 
however, the required normal derivative H = -nrr at the equipotential 

124 
9. INTEGRAL EQUATIONS 
surfaces is obtained directly, thus saving subsequent differentiation. These 
simplifications are, of course, not possible if a ~ i)x/On. 
After solution of the corresponding boundary-value problems, the rota- 
tionally symmetric field and the perturbation field are to be superimposed. 
It is sufficient to limit this to the paraxial domain, whereupon the influ- 
ence of various kinds of perturbations on the electron trajectories can be 
studied. 
9.5 R~sum~ 
Without entering into the details of concrete numerical calculations, we 
have developed a general theory of field calculation in systems having a 
straight optic axis. Two basic ideas, the introduction of azimuthal Fourier 
series expansions and the formulation of integral equations, have been 
worked out in some detail, since these are particularly well adapted to the 
needs of electron optical field calculations. The use of Fourier series expan- 
sions results in a sequence of uncoupled mathematical structures of lower 
dimensions. Since we shall finally be interested in the field in the paraxial 
domain, we may terminate the calculation of the Fourier coefficients (axial 
harmonics) after the first few orders, which are of most importance. This is 
thus a very economic technique. The use of integral equations rather then 
partial differential equations further reduces the number of dimensions, 
since parts of the necessary integrations have already been carried out. In 
all cases in which the material properties of the polepieces or electrodes are 
constant, integral equation methods have proved to be very powerful and 
efficient. There are, of course, problems that cannot be solved in this way. 
These will be treated in the context in which they arise. 

10 
The Boundary-Element Method 
In Chapter 9 we derived various types of integral equations. We now turn to 
their concrete numerical solution. The corresponding procedure, called the 
integral-equation method (IEM) or the boundary-element method (BEM), 
has proved to be very powerful. Since the early investigations (Cruise, 
1963; Lewis, 1966; Harrington, 1967, 1968; Singer and Braun, 1970), many 
presentations have been published, which often differ only in minor de- 
tails. The list of references given in the bibliography makes no pretence at 
completeness. We recall that the physical idea behind this method is to 
calculate the charge density distribution (in the electrostatic case) corre- 
sponding to the voltages applied to the electrodes and then calculate the 
potential distribution in space created by this charge distribution. The 
complexity of the method in some practical situations is a consequence 
of the complicated nature of the boundary conditions. We first consider 
one-dimensional integral equations. 
10.1 Evaluation of the Fourier integral kernels 
The numerical solution of (9.21) and (9.27) requires the evaluation of the 
Fourier integral kernels Gin, defined by (9.18) and (9.19), and of their par- 
tial derivatives. The special case m = 0 is already familiar in classical 
electrodynamics, since Go(z, r; z', r') is the potential at (z, r) due to a uni- 
formly charged ring located at (z ~, r~). Cases for which m ~ 0 have been 
investigated by Kasper and Scherle (1982). 
10.1.1 Introduction of moduli 
The meaning of some of the geometric variables appearing in the subsequent 
theory is presented in Fig. 10.1. We assume that a ring of radius r' is 
located in the plane z' = const. The coordinates (z, r) define an arbitrary 
point in the axial section through the field. It is convenient to introduce 
the distances 
:= V'(z - 
+ 
t: 

126 
10. THE BOUNDARY-ELEMENT METHOD 
c~" I 
~-z:- 
r" 
J 
Z, Z I 
Fig. 10.1: In an axial section through an axisymmetric configuration, a single ring is 
seen as the circles R1 and R2. P is an arbitrary reference point. 
and the quantities 
1 
, 
and 
(10.2) 
S:=dl 
+d2 = y/2 p+(z-z') 
2+r 2 +r '2 
(10.3) 
These quantities have a very simple geometric meaning: dl and d2 are the 
minimal and the maximal distance from the ring, respectively, as shown in 
Fig. 10.1, and S is the sum of these distances. The surfaces S = const are 
oblate spheroids with the ring as their common focal line. It is helpful to 
introduce dimensionless moduli: 
k" 
2 rv~ 
k"= ~/1- k 2 
dl 
- 
~ 
, 
=~-~ 
(10.4) 
4rr I 
d2 -dl 
1 - k' 
= 
= 
(10.5) 
~o := $2 
d2 + dl 
1 + k' 
These moduli are defined only in the interval [0,1]. It is of great importance 
that the relation between k and ~ is a Landen transformation of the ar- 
guments of elliptic integrals (Whittaker and Watson, 1927, Section 22.42), 
see Section 10.1.3. 
10.1.2 Radial series expansions 
Again using the abbreviations u = (z,r), u' = (z',r'), we obtain from 
(9.18) and (9.21) the explicit integral representation 
2~" 
1 / 
cos mc~ dc~ 
a~(~;~')= ~ 
{(z-z,)~ +~+~,~-2~,¢os~}~ 
0 
(~0.6) 

10.1 EVALUATION OF THE FOURIER INTEGRAL KERNELS 
127 
Introducing the variables S and 0, defined by (10.3) and (10.5), we soon 
find the simpler representation 
271" 
1 f 
cos ma da 
am(~; It t) -~ -~ 
(1 - 20cos a + 02) ½ 
0 
(10.7) 
The required radial series expansion is now most easily obtained by ex- 
panding the denominator in terms of Legendre polynomials: 
1 - 20cos c~ + 02 
= E 
0'P,(cos a) 
/=0 
Integration of each term of the resulting sum yields 
1 
~ 
om4.2j 
Gin(u; u') = ~ E amj 
j=0 
(10.8) 
the coefficients being given by 
(2j)! (2m + 2j)! 
amj - 22m+4j (j!)2 {(j + m)!} 2 
(10.9) 
Since 0 is proportional to r as long as r << r', (10.8) essentially represents 
a series expansion with respect to r. This agrees with our former results 
that the m th Fourier coefficient of the potential must be proportional to 
r m if r is very small (see Section 7.1). 
The series expansion (10.8) converges for all values of 0 in the interval 
0 _< 0 < 1. In practice it can be evaluated from a reasonable number of 
terms in the interval 0 < 0 < 0.5. The number of terms necessary depends 
on the acceptable error limit and on the actual value of 0. With jmax = 20, 
excellent accuracy is obtained. Since 0 < 0.5 usually covers the domain 
occupied by the electron trajectories, (10.8) is very useful in practical field 
computations. 
10.1.3 Recurrence relations 
The solution of the integral equation derived in Chapter 9 requires the 
Fourier kernels Gm to be evaluated in the interval 0 < 0 < 1. In the interval 
0.5 < 0 < 1 this can be performed by means of appropriate recurrence 
relations. The latter can take different forms, which have been investigated 
by Kasper and Scherle (1982). For the sake of brevity, we shall treat here 
only one of these forms. 

128 
10. THE BOUNDARY-ELEMENT 
METHOD 
Introducing the more familiar modulus k (10.4) into (10.6) and sub- 
stituting fl = a/2, we find the representation 
1 
/ 
cos 2raft d~ 
Gin(u; u') = ~ 
(1 - k 2 cos 2 fl)1/2 
0 
which is clearly a generalization of the familiar complete elliptic integral of 
the first kind. In fact, the special case m = 0 is the well-known formula for 
the potential of a uniformly charged ring. 
For the subsequent discussion, we introduce the complete elliptic inte- 
grals 
K(k) "= f (1 - k 2 sin 2 #)-½ d# 
0 
~-/2 
E(k) := / (1 - k 2 sin 2 ~) ½ d~ 
0 
D(k) := / 
~i~ ~ ~ (1 - k ~ ~i~ ~ ~)-½ d~ - (g- 
E)k -~ 
0 
(10.10) 
For all values 0 < k < 1, these can be computed very accurately by means of 
the algorithm of repeated algebraic and geometric means (see Abramowitz 
and Stegun, 1965, p. 598). In terms of (10.10), the lowest order Fourier 
kernels may be written 
1 
2D(k)-K(k) 
Go = ----;- K( k ) 
, 
G1 = 
r a 2  
- 
- 
rd2 
As it is necessary to introduce the modulus ~ for the evaluation of the radial 
series expansion, it is convenient to introduce ~ into the integral expression 
as well; this implies that we have to establish the functions Ira(O)" 
G,n(u; u') =" S-1I~(~)) 
, 
0 _< ~) < 1 
(10.11) 
As far as Go and G1 are concerned, this is easily done by means of the 
Landen transformation 
Ktk) = (1 + t~)K(~) 
2 
E(k) = i + E(O) -(1 - o)K(o) 

10.1 EVALUATION OF THE FOURIER INTEGRAL KERNELS 
129 
After some elementary calculations, it is easy to confirm that (10.11) is 
satisfied for m = 0 and m = 1 by 
I0(:~) = 2K(#) 
, 
I1(:~)= -Tr 
28D(:~) 
(10.12) 
The higher order integral expressions are given by the linear recurrence 
relation (m > 1) 
(1) 
(2m + 1)I,,+1(~)= 2m 8+ : 
I.,(~)- (2m- 1)Im_,(~) 
(10.13) 
This differs from the expressions given by Kasper and Scherle: here the 
more convenient normalization I0(0) = 1 has been chosen. 
Equations 
(10.13) can be easily evaluated in ascending sequence. This recursive pro- 
cedure is slightly unstable. For practical purposes it is stable enough if 
> 0.5 and rn < 12. There are ways of extending the region of allowable 
orders m, but these will not be treated here since m = 12 is quite suffi- 
cient. Combined with the paraxial series expansion (10.8) for 8 < 0.5, the 
recursive procedure defined by (10.12) and (10.13) provides a convenient 
way of computing generalized elliptic integrals. 
An interesting complete integral representation of the function Im(Q) 
is the expression 
~/2 
_l 
= 
sin 2m~ 1-8 2sin 2/3 
dfl 
71" 
0 
Obviously (10.12) are satisfied. By expanding the integrand as a power 
series and performing the integrations before the summation, it is possible 
to verify (10.8) and (10.9). Finally, (10.13) can be proved by induction. 
10.1.4 Analytic differentiation 
It is of great importance in connection with field computation that the 
derivatives with respect to z and r can also be calculated quite easily. 
Differentiation of the expressions for S and 8 gives 
OS 
OS 
Oz 
Oz' 
O8 
O8 
=S(z-z')/p 
(10.14) 
Oz 
Oz' 
db'_ 
r 
$2 
4rl2 
- 
ps ( 
- 
) 
Or 
08 
4rl( 
2r 2 
Or= $2 
1---+ p 
= -2Q(z- z')/p 
(10.15) 
(10.16) 
8r2r~2 ) 
ps~ 
(10.17) 

130 
10. THE BOUNDARY-ELEMENT METHOD 
The derivatives with respect to r' are obtained by interchanging r and r'. 
On the optic axis (r = 0 or r' = 0) all these derivatives remain regular. The 
differentiation of (10.8) is now a straightforward procedure. For e < 0.5 
the derivatives of (10.12) and (10.13) are to be used. From the standard 
formulae for the derivatives of complete elliptic integrals we have 
I~(~) = eIo(~) - x~(~) 
1- 8 2 
, 
I~(~)= I~(~)l~ 
(10.18) 
The differentiation of (10.13) results immediately in 
(2m+l)I'+l(e)=2m 
e+-~ I'(e)-(2m-1)I'-l(e)-2m 
1-1 Ira(e) 
For m > 1 this is an inhomogeneous linear recurrence relation, which 
can easily be solved after evaluating (10.13). 
The derivatives of Gin(u, u ~) can now be put into a very convenient 
form. From (10.14) and (10.15) we find easily 
OG~ 
OG,~ _ 
z' 
- 
z 
Oz = 
Oz' - 
pS Qm(e) , 
Q,.,(e) := Ira +2eI'(e) 
(10.20a) 
After some elementary calculations we obtain from (10.16) and (10.17) the 
result 
OGmor --1{ 
-~I'(~))+(r'~pS 
r 
- r)Qm(~)} 
(10.20b) 
As r --, 0 this formula gives a finite result since ~/r remains finite. 
Altogether we obtain a comparatively simple numerical procedure for 
the computation of the kernel functions G,n(u, u') and their derivatives. 
This procedure can be carried out for arbitrary values of the arguments 
with the exception of singular combinations, the latter being defined by 
dl =0or k= L)= 1. 
Computer programs embodying this procedure have been tested and 
its practical applicability is now well established. In the literature it is 
usually the special case of rotationally symmetric fields (m = 0) that is 
investigated. Apart from the fact that there is no need to evaluate the 
recurrence formulae, this specialization brings no major simplification. 

10.2 NUM. SOLUTION OF ONE-DIMEN. INTEGRAL EQUATIONS 
131 
/ ;/ 
I 
/ 
/ 
/ 
¢ 
/ 
/ 
/ 
~" l 1//////////.i////////. 
Io5 
---" 
~..._ P3 - P4 ~ 
P6 
P2 
~/ /t/ 
_• 
Z 
Fig. 10.2: Upper-right quadrant of an axial section through a device with axial and 
mirror symmetry. The contour C now consists of three separate curves, one closed, the 
other open. The orientation has been chosen in such a way that the field domain is always 
on the right as one follows the contour; this makes it easy to distinguish between interior 
and exterior domains. 
10.2 Numerical solution of one-dimensional integral equations 
We now discuss the solution of integral equations such as (9.21) and (9.27). 
These are special cases of a Fredholm equation of the second kind: 
f K(s,s')Y(s')ds'= U(s)+ )~Y(s) 
(10.21) 
c 
Depending on the particular application, the variables appearing in (10.21) 
have different physical meanings. 
In applications to Dirichlet problems 
(9.21), Y is a surface charge density, U is a surface potential, while ,k 
vanishes. In applications to problems with interface conditions (9.27), Y 
is a surface potential, U arises from the boundary values of an external 
field (9.23 and 9.25), while )~ is given by (9.14). The variables s and s' 
are usually arc-lengths in an axial section through the device, but may 
also be other parameters, such as angles, if these are more favourable. In 
most applications the contour line C of the boundary consists of two or 
more separated loops. As a result of using any symmetry properties of the 
device, these loops may be open or closed, as is shown in Fig. 10.2. In the 
transformation to a linear scale for s and s ~, the contours are mapped onto 
a sequence of disjoint intervals, as is shown in Fig. 10.3. On closed loops 
the functions appearing in (10.21) must satisfy cyclic conditions, since they 
must be unique. 
10.2.1 Conventional solution techniques 
The structure of the kernel function K(s, s'), is so complicated that (10.21) 

132 
10. THE BOUNDARY-ELEMENT METHOD 
Fig. 10.3: The intervals of s and the surface charge distribution corresponding to Fig. 
10.2. The three branches of C now correspond to three separated intervals. The surface 
charge density Y(s) must satisfy Y(s~) = Y(s*4) (cyclicity) and Y'(s*~) = Y'(s~) = 
Y'(s~) = 0 (even or mirror symmetry). 
! j 
! 
, 
,- 
Fig. 10.4: Part of a boundary and the appropriate discretization. The line elements 
must be short in the vicinity of edges and in regions where the boundary curvature is 
large. Abrupt large changes in the length of the elements should be avoided. 
can only be solved numerically. 
In every case, this requires a suitable 
discretization of the boundary, as is shown in Figs. 10.4 and 10.5. Usually, 
the unknown function Y(s') is assumed to vary very slowly, so that in 
each integration subinterval it can be replaced by a constant, the value at 
the centre of the subinterval. With these step functions, (10.21) is then 
approximated by 
N 
EHikY=Ui 
, 
i=l...N 
(10.22) 
k=l 
where the notation 
?k := Y(~k) 
, 
ui := v(~,) 
, 
i,k = 1... N 
and the matrix elements 
hk 
Hik := / 
K(~i,~k + ~') dr- ,~Sik 
--hit 
(10.23) 
(lo.24) 

10.2 NUM. SOLUTION OF ONE-DIMEN. INTEGRAL EQUATIONS 
133 
Y(s) 
Sk_.l 
s k 
slc+ 4 
s 
.----2h k 
Fig. 10.5" Some sub-intervals of integration and the corresponding approximation of a 
function Y(s) by a step-function. The quantity sk denotes the midpoint of the k-th 
subinterval. The area of the column of the histogram is not exactly identical with that 
under the curve Y(s). 
have been introduced. The quantities gi and gk refer to the midpoints of 
the subintervals in question and hk is the half-width of the subinterval with 
label k. 
The integration in (10.24) can be performed numerically without prob- 
lem for i ¢ k. For i = k, however, the integral becomes improper, since 
the kernel then contains a logarithmic singularity. In the case of rotational 
symmetry, the approximation 
1 
r'Go(u, u') = ~ ln(8r'/dl) + R0(dl) 
, 
dl 
<(<( r t 
(10.25) 
can be derived from (10.6), R0(dl) being a bounded function. Then for 
i = k the integrand of (10.24) becomes 
1 
K(~i,~i + r)= ~ ln(8V~/Itl) + R0(ltl) 
(10.25a) 
since dl = Itl is the distance from the singularity. From the recurrence 
formula (10.13), the Fourier integral kernels of higher orders clearly have 
the same singularity; they differ from (10.25) only in the nonsingular term 
R0(dl). 
The numerous applications of the BEM published in the literature (see 
list of references) differ essentially in the numerical procedure adopted for 
the integration over the singularity. Once this problem has been solved, the 
implementation of the BEM raises no further problem. The linear system of 
equations (10.22) can be solved directly by means of standard techniques, 
such as the Gaussian elimination algorithm, the number N usually being 
between 50 and 500 in order of magnitude. Thereafter, the surface charge 
density is known and can be introduced into the surface Coulomb integral 
in (9.10) or (9.14), giving the value at any point r in space. 

134 
10. THE BOUNDARY-ELEMENT METHOD 
0 
..----A 
0 
0 
A' 0 
o 
cz;,,~j 
o 
(Zk ,rk) 
'C 
C 
Z 
Fig. 10.6" Part of an electrode, showing the boundary curve C and a possible configu- 
ration of control points ( z~, rk) and ring positions ( z °, r°). A and A' are the upper 
halves of meridional sections through thin charged plane apertures. 
In order to circumvent the complicated evaluation of the improper in- 
tegrations in the diagonal elements Hii, Hoch et al. (1978) have replaced 
the surface charge distribution by a sequence of charged rings located inside 
the electrodes, as shown in Fig. 10.6. In addition, they introduced charged 
thin planar apertures. We postpone consideration of these to Section 10.3. 
The rings are characterized by coordinates z ~ =" z~, r ~ =: r~ and charges 
Qk (k = 1...N). At the boundary C an equal number of control points 
with coordinates z =: zi, r =: ri and boundary potentials Ui are intro- 
duced. Apart from an unimportant constant factor, the conditions that 
the rotationally symmetric potential V(z,r) has the prescribed boundary 
values are of the form 
N 
QkGo(ui, u°k) = Ui 
, 
i = 1. . . N 
(10.26) 
k--1 
(we again use u = (z, r), ui = (zi,ri), u~ = (z~, r~)). Once the solution of 
this linear system of equations is known, the potential and its gradient are 
simply given by 
N 
V(u) = ~_~ QkGo(u; u°k) 
(10.27a) 
k=l 
N 
VV(u) = ~ 
QkVao(u; u°k) 
(10.27b) 
k--1 
This is certainly the simplest version of the BEM. Kasper and Scherle 
(1982) have generalized it for Fourier series expansions like (9.15). In many 

10.2 NUM. SOLUTION OF ONE-DIMEN. INTEGRAL EQUATIONS 
135 
0 
0 
0 
0 
0 
0 
0 
0 
0 0 _ 0  
o 
0 
0 
0 
S 
Fig. 10.7: Wavy structure of equipotential lines produced by disjoint rings. This effect, 
exaggerated here for clarity, decreases rapidly with increasing distance from the surface. 
Fig. 10.8: Simplified perspective drawing of the discretization adopted for the cathode 
in an electron gun. Each control point at the physical surface S is associated with an 
interior conical mantle over which the corresponding part of the surface charge is to be 
distributed uniformly or, better, continously. 
practical applications to conventional round lenses and to deflection units 
this method has worked quite satisfactorily, the relative error in the field in 
its paraxial domain being roughly 10 -3 to 5 × 10 -3. Dimculties may arise 
in the vicinity of sharp edges and especially at the surfaces of cathode tips 
in electron guns. Depending on the shape of the boundaries and on the 
prescribed boundary values, the equipotential over which the expression 
(10.27a) assumes a constant electrode potential U has a wavy structure, as 
shown in Fig. 10.7. This causes a deviation of the local field strength from 
its correct direction parallel to the local surface normal of the electrode. In 
order to avoid this weakness, the charge can be distributed over an inner 
surface, as shown in Fig. 10.8. 
It is sufficient to assume constant charge density on each surface ele- 
ment. Replacing the summation in (10.26) by the appropriate integration, 
one obtains quite an accurate solution. Weysser (1983) has applied this 
method to electron guns and found that it works reasonably well. 

136 
10. THE BOUNDARY-ELEMENT METHOD 
In spite of its wide field of applications, the refined method of Hoch 
et al. is not quite satisfactory in every respect because it cannot be em- 
ployed to solve problems with interface conditions, since the singularities 
must then be located at the interfaces themselves. In this case, the corre- 
sponding integration over the singularities cannot be circumvented. In the 
next section we shall present a better solution technique. 
10.2.2 Combination with interpolation techniques 
If the singularities are assumed to be located at the surfaces of electrodes or 
yokes, it is necessary to approximate Y(s') in (10.21) by a smooth function, 
since in applications to Dirichlet problems this is essentially the normal 
component of the field strength. Then, of course, the integration becomes 
far more complicated. 
For reasons of conciseness we consider only one 
integration domain, So < s < sN; the generalization to more domains 
raises no difficulties. 
A fairly accurate solution is already obtained if the values Y1... YN, 
found by solving (10.22), are introduced into a smoothing program based 
upon a suitable interpolation technique. This has been noticed by Uchikawa 
et al. (1981). Another possibility consists in using more than one point 
of reference in each integration subinterval and applying Lagrange inter- 
polation techniques. The system of linear equations generated by the dis- 
cretization of (10.21) does, of course, become more complicated. The best 
approximation that can be reached in this way is a function Y(s) that 
is continuous at the internal endpoints of the chosen subintervals. The 
derivative dY/ds will, however, be discontinuous at these points. 
In order to avoid these difficulties, Scherle (1983) has approximated 
Y(s) by a cubic spline function (see Section 13.1). The points of refer- 
ence with abscissae so... s N must then be the endpoinfs of the integration 
subintervals and not the midpoints. The integration over the singularities 
was carried out in a correct numerical manner, after these singularities had 
been separated from regular terms by appropriate series expansions. The 
whole set of conditions to be satisfied forms a complicated system of lin- 
ear equations. The accuracy of the solution is, however, very high, as has 
been shown by applying it to suitable test examples. In these investiga- 
tions the appropriate integration over singular functions turned out to be 
the most complicated part of the practical application of the BEM. It is 
advantageous to choose the midpoints of the subintervals for reference, as 
was done in (10.24). The problem of performing the integration is deferred 
to Section 10.2.5. 
In order to combine these requirements with those of continuous differ- 
entiability of the solution Y(s) at the endpoints 81... 8N_l, Kasper (1983) 
developed a solution technique based on quadratic spline functions. This 

10.2 NUM. SOLUTION OF ONE-DIMEN. INTEGRAL EQUATIONS 
137 
Yls ) 
5 
~(t) 
I_ 
I 
~-I 
t 
5_~ t 
.
.
.
.
 
1 
+1 
L hi+~ A 
2 
sl 
~/+,1 
sl'+l 
Fig. 10.9" Discrete and mean values of some function Y(s), represented by different 
interpolation parabolae. At the points (the coordinates of which are written without 
bars), these parabolae are to be joined together smoothly. The midpoints (~, ~+1) are 
introduced to facilitate the integration. 
method can be still further generalized and improved, as we now show 
(Kasper, 1984a). 
In each subinterval s k-1 _< s < s k, k = 1... N, the required function 
Y(s) is represented in the form 
Y(s) -" Yk + yk(t) 
(10.28a) 
t'= (s-~k)/hk 
, 
It] < 1 
(10.28b) 
which implies 
sk = (sk + sk-1)/2 
, 
hk = (sk -- sk-1)/2 
, 
(k=l...g) 
(10.29) 
In the corresponding subinterval the function yk(t) is the departure of Y(s) 
from its mean value Y k, as is shown in Fig. 10.9. This quantity yk can be 
considered as a small perturbation; in the simple conventional approxima- 
tion (10.22-10.24), it is completely ignored, but here we shall determine it 
approximately. 
Introducing (10.28) into (10.21), we rapidly find that it is convenient 
to define a perturbation vector with the components 
N 
1 
P 
Z 
hk / K(~i,~k + hkt)yk(t)dt - Ayk(O)6ik 
(i = 1... N) (10.30) 
ui := 
k=l 
--I 
d 
eqs. (10.22) then taking the improved form 
N 
, 
k = 1...N 
(10.31) 

138 
10. THE BOUNDARY-ELEMENT METHOD 
This is now to be combined with an appropriate interpolation technique. 
In the present context this means that for given mean values Y1... YN, a 
program is to be set up that supplies the deviations yk(t) in such a way 
that the resulting solution Y(s) is continuously differentiable and assumes 
exactly the values Y1 ... YN as integral means in the corresponding subin- 
tervals. This problem can be solved in different ways. 
10.2.3 Polynomial series expansions 
A fairly simple algorithm, based on series expansions in terms of Legendre 
polynomials Pl(t), has been proposed by Kasper (1984a). We start from 
/=0 
8k_ 1 < 8 < 8 k 
(10.32) 
t being given by (10.28b) and L a fixed integer. Comparing with (10.28a) 
we notice that 
1 
hk 
--I 
--hk 
(10.33) 
and hence the terms for which l > 0 represent the perturbation yk(t). 
Introducing (10.32) into (10.30), we are led to define new matrix elements 
by 
1 
M~ ) = hk f U(~,~k + thk)P,(t) dt- ~Pk(O)~k 
--1 
(i= l...N, 
k= l...N, 
l=O...M) 
(10.34) 
~'t(°) The improved form of (10.22) 
(10.24) being thus a special case H/k .... /k • 
is now given by 
L 
N 
Z E "(" ('' 
~'/k ~k = u~ 
(i = 1...N) 
(10.35) 
l=0 k--1 
In matrix-vector notation (matrices being denoted here by sans-serif type) 
this may be rewritten as 
L 
c(°)-[(°)lU--Z~(I)c(l) I _ [(°)(U- 
u) 
(10.36) 
1--1 

10.2 NUM. SOLUTION OF ONE-DIMEN. INTEGRAL EQUATIONS 
139 
I (°) = (M(°)) -~ = H -1 denoting the inverse of the matrix of (10.24). Equa- 
tion (10.36)is a more concrete form of (10.31), as the summation term 
makes it clear how the perturbation u is to be computed. 
In order to solve the whole system (10.36) uniquely, we need additional 
conditions. These arise from the requirements of continuity at the end- 
points So ... SN of the subintervals. In this context it is helpful to introduce 
the integral function 
8 
F(s) := [ Y(s') ds' 
(10.37) 
80 
From (10.33) it is obvious that its values Fk "- F(sk) satisfy the relations 
F0 = 0 
, 
Fk = Fk-~ + AFk 
(10.3S~) 
-
-
 
(o) 
(10.38b) 
AFk = 2hkYk --2hkc k 
Hence, by means of suitable numerical differentiation procedures, we can 
now calculate the sets Yo... YN and Yd... Y~ and even derivatives of higher 
order, referring to So... S N. In order to limit the rounding errors, it is 
preferable to apply a differentiation technique that uses the increments 
AFk directly instead of the accumulated values Fk. The differentiation 
routine must be set up with some care as the resulting error may otherwise 
increase with decreasing step-width. A suitable procedure will be presented 
in Section 13.1. 
With increasing order L, the accuracy should become better, but nu- 
merical instabilities also tend to increase and the memory requirements 
soon become prohibitive. A reasonable compromise is L = 4. The val- 
ues Y k, Yk, Y~, Yk-1, Y~_I uniquely specify a polynomial of fourth order 
that is consistent with these data. The required relations for the Legendre 
coefficients with I > 0 are then given by 
4 
g c~")Pk(::]:l) = [Yk-, - Yk; Yk - Yk] 
i=1 
4 
i=1 
where the first term on the right-hand side refers to the coordinate s = sk_ 1, 
t = -1 while the second term refers to s = s k, t = 1; the dot denotes 
differentiation with respect to t. By forming suitable linear combinations, 
this linear system of equations can be easily split up into two uncoupled 

140 
10. THE BOUNDARY-ELEMENT METHOD 
subsystems of rank 2 and then solved, the results being 
) = {6(Y  - 
r,<_,) 
c (2) = { lO(Yi, + Yk-1 - 2Yk) 
_ {-(Y. - y._,) 
'i 
- 
k-l) 
//10 
- hk(Y~ - Y~_l))/14 
+ h (yl + y,' 
11o 
J 
(10.39) 
10.2.4 Iterative solution 
We now have enough conditions to determine all the quantities uniquely. 
The resulting linear system of equations could be solved directly but this 
would be most inefficient because the rank of the coefficient matrix is very 
high and the matrix is sparse, large regions containing only zero elements. 
By using a suitable iteration procedure, the memory requirements can be 
reduced drastically. 
In the initialization step, we evaluate and store the matrix elements 
M~ ), given by (10.34). The matrix M (°) is then inverted and afterwards 
its memory location is occupied by the inverse I (°). In practice, it has been 
found that in many cases, essentially in applications to systems with thick 
electrodes or polepieces, the matrix elements M~ ) with I > 2 and li-k I > 2 
can be ignored without significant loss of accuracy. Thus in favourable 
cases the memory requirement is little more than 2N 2 for these matrices. 
After storing the matrices, the inhomogeneity vector U is determined and 
vanishing start-vectors c(0, (I = 1... 4) are assumed. 
In the iteration loop, (10.36) is first solved for c(°); the increments 
AFk are then known from (10.385). Next the sets Yo... YN and Yd... Y/q 
are determined by numerical differentiation. These are now introduced on 
the right-hand side of (10.39). In this way we obtain improved vectors 
e(1) ... c (4). The norms of the differences relative to the vectors of the pre- 
ceding iteration provide a convergence control. The procedure is stopped 
when all the difference norms have fallen below given tolerance limits; oth- 
erwise a fresh loop starts with (10.36). 
This procedure usually converges after about 20 (or less) iterations. 
Finally we can obtain a continuously twice-differentiable solution Y(s) by 
numerical calculation of the second order derivatives Yd~... Y~ at so... S N 
and application of the quintic spline technique outlined in Section 13.1. 
This gives a very smooth solution. 
It is highly accurate whenever the 

10.2 NUM. SOLUTION OF ONE-DIMEN. INTEGRAL EQUATIONS 
141 
inhomogeneity U(s) varies slowly in every subinterval. This is, for instance, 
true in applications to electrostatic Dirichlet problems, where U(s) is the 
locally constant electrode potential. A more general numerical technique, 
which is also accurate for rapidly varying inhomogeneities U(s), has been 
devised by StrSer (1987), to whose work we refer the interested reader. 
10.2.5 Evaluation of improper integrals 
A careful inspection of the kernel functions to be evaluated shows that these 
contain logarithmic singularities; the derivatives of the kernels may have 
singularities of first order. For the sake of brevity, we assume the abscissa 
of the singularity in question to be x = 0. 
A singular function of the type 
fl(x) = In I~Pl(~)I 
with 
~1 (0) = 0 
, 
~ (0) ¢ 0 
can be reduced to the form 
fl(x) = In I~1 + In I~l(X)/X I 
where the second term on the right is a regular function, which can be 
expanded as a Taylor series about x -- 0. Likewise, a function of the type 
f2(x) = 1/~o2(x) 
with 
~02(0) = 0 
, 
~o~(0) # 0 
can be reduced to 
1 
x~o~ (0)- ~2(x) 
f2(x) = 
i 
• 
where again the second term is regular, since both numerator and denomi- 
nator have a common zero of second order, which cancels out. It is therefore 
sufficient to consider functions of the form 
F(x) = f~ (x)In ]x] + f2(x)/x + f3(x) 
( o.4o) 
fl(z), f2(x), and fa(x) being arbitrary regular functions. 
Kasper (1983) has developed a simple method for integration over such 
functions. The corresponding formula is similar to a Gauss quadrature and 
takes the basic form 
h 
N 
--h 
~--1 
(10.41) 

142 
10. THE BOUNDARY-ELEMENT 
METHOD 
with positive abscissae pg and weight factors w g. Thanks to the symmetric 
arrangement of these, the contributions from the singularity in f2(z)/z 
and from all antisymmetric terms cancel out, and (10.41) automatically 
furnishes the principal value of the integral. The parameters pj, and w~, are 
obtained by numerical solution of the non-linear equations 
1 
N 
tt 2t' dtt ~ 
wpplt 
0 
p=l 
1 
2v+l 
1 
N 
_ 
~ 
2.1n 1 
u 2" In 1 du = 
w t, pt , 
~ 
= 
u 
Ptt 
0 
~=I 
(2v + 1) 2 
v=0,1...N-1 
The results for the case N = 4, which are adequate in most cases, are as 
follows: 
Pl = 0.0399 4596 2203 
P2 = 0.2801 7249 6204 
P3 = 0.6361 2394 4954 
P4 - 0.9223 6045 1138 
Wl = 0.1270 7679 2574 
w2 = 0.3267 4417 6078 
w3 = 0.3523 4912 8452 
w4 --0.1938 3290 3896 
It is now easy to integrate all kernel functions K(s, s') and their normal 
derivatives over arbitrary smooth boundary contours C. It is necessary 
neither to approximate the contour by a polygon, nor to choose the arc- 
length as the variable of integration. As (10.41) makes clear, there is no 
need to express the integrand explicitly in the form (10.40), which would 
be extremely tedious. The only knowledge required is the implicit singular 
character of the integrand. The user of this method need only set up a 
program that supplies correctly the value of the integrand for arbitrary 
arguments. 
In conclusion, it emerges that the BEM, at least in its one-dimensional 
version, is a highly attractive procedure. Practical examples demonstrating 
this are given in Section 10.5. 
10.3 Superposition of aperture fields 
Though the general method described above can be applied to any axisym- 
metric Dirichlet problem, this is not always the best way of obtaining the 
solution. Problems may arise in systems with very narrow apertures in 
electrodes with plane fronts, as shown in the example presented in Fig. 

10.3 SUPERPOSITION OF APERTURE FIELDS 
143 
Fig. 10.10: Upper half of the axial section through an accelerator. 
10.10. Here many integration subintervals are necessary in order to obtain 
the electric field correctly in its asymptotic domains. The computation 
of surface charge distributions can, however, be confined to the principal 
inhomogeneous domains of the field if the asymptotic field is represented 
correctly by appropriate superpositions of the fields of thin plane circular 
apertures. A combination of the BEM with such fields has been proposed 
by Hoch et al. (1978). Pure superposition of aperture fields had been inves- 
tigated earlier by aegenstreif (1951), Lenz (1956) and Dommaschk (1965). 
In the following analysis, we shall first study the field of one single aperture 
and then superpositions of such fields. 
10.3.1 Electric field of a single aperture 
We consider now a thin plane circular aperture with radius r ~ = R. Without 
loss of generality, we can choose the coordinate system in such a manner 
that the aperture plane is given by z' - 0. It is appropriate to introduce 
oblate spheroidal coordinates (u, v, 7~, ), ~ being the usual azimuth and u, v 
defined by the transformation 
z= 
Ruv 
, 
R 
( - c ~ < u < c ~  
, 
0_<v_<l) 
(10.42) 
These are shown in Fig. I0.II. The surfaces u = const are confocal oblate 
spheroids, the surfaces v - const confocal orthogonal hyperboloids. Among 
the latter, the optic axis (v = 1) and the surface of the aperture itself 
(v - 0) are degenerate special cases. 
In these new coordinates, Laplace's equation takes the form 
(1+ 
) 
+ 
=0 
This can be solved by separation of variables, 
• (u, v) = F(u)P(v) 

A 
10. THE BOUNDARY-ELEMENT METHOD 
\ 
/ 
144 
A' 
~ v=const' 
onst 
Fig. 10.11" Coordinate lines u = const and v = const ~ in a system of oblate spheroidal 
coordinates ( u, v, ~). The azimuth ~ is constant in this axial section. 
A and A ~ denote 
the closed parts of the aperture plane; these are singularities of the coordinate system. 
Writing the separation constant in the familiar form l(l + 1), we obtain 
d 
d---~ {(1 - v2)p'(v)} = -l(l + 1)P(v) 
d 
u2 
d--~{(1 + 
)F'(u)} = l(l + llF(u) 
(10.43) 
(10.44) 
Equation (10.43) is Legendre's differential equation, its regular solutions 
being the well-known Legendre polynomials Pi(v) for integral values of the 
subscript I. Equation (10.44) reduces to (10.43) if we write u' - iu and is 
hence solved by general Legendre functions with imaginary argument. For 
physical reasons the resulting solution for • must correspond asymptoti- 
cally to a homogeneous field, which means that ~ ,.~ z = Ruv for ]u I )) 1. 
With this constraint, the general solution is 
¢(u, v) - Auv -F By(1 + u arctan u) -F C 
The coefficients A, B and C are uniquely specified by the conditions @(u, 0) 
= ~o, O~/Oz = -Et for z ~ -cx) and O~/Oz = -E~ for z ~ +co, the 
result being 
EI+Er 
EI-Er 
} 
--T--u 
+ 
+ 
u) 
(10.45) 

145 
i 
f-, 
10.3 SUPERPOSITION OF APERTURE FIELDS 
i 
f-, 
Z. 
Fig. 10.12: Equipotentials in the upper half of an axial section through the field of a 
thin charged aperture. 
(a) Symmetric field, E1 - -E2; (b) E1 = 0, the field vanishes asymptotically as 
Z "-+ --00. 
The constants ~0, El and Er have the physical meaning of the aperture 
potential and the asymptotic field strengths, respectively. 
Examples of 
such solutions, differing in the choice of the constants, are shown in Figs 
10.12a,b. 
In order to represent the potential and the asymptotic field strength in 
cylindrical coordinates, we need the inverse transformation corresponding 
to (10.42). 
This can be expressed in terms of the distances dl and d2, 
defined by (10.1) and shown in Fig. 10.1; in this context, the singular ring 
is the edge of the aperture, z' = 0, r' = R. We then have 
u2 - (dl + d2) 2 
4R 2 
-1 
, 
v 2=1- 
(d2-dl)2 
4R 2 
(10.46) 
For the later computations, it is more convenient to express the transform 
in relative coordinates ~ = z/R, F = r/R; we find 
: = ~2 + F2 _ 1 = u 2 - v 2 
(10.47a) 
7/'= ~/~2 + 4~2 - u 2 + v 2 
(10.47a) 

146 
10. THE BOUNDARY-ELEMENT METHOD 
{ x/(l~l + r#)/2 
for ~ < 0 
v = 
I~1/.,/{~ + ,7)/2 
for ~ >__ 0 
u --= -z/v 
(10.47c) 
(10.47d) 
The matrix of the partial derivatives can then be computed very easily: 
• = 
- 
R(u 2 + v 2) 
(10.48a) 
_
_
 
Ou 
o~ = wv(1 + ~) 
-- = wu~ 
(10.4sb) 
Oz 
' 
Or 
Ov 
Ov 
O---z = wu(1 - v 2) 
, 
Or 
- 
wv~ 
(10.48c) 
By means of these relations it is easy to compute O(z, r) and its derivatives 
OO/Oz, OO/Or or even derivatives of higher orders. The corresponding 
expressions are not given here. 
10.3.2 Superposition procedure 
We now consider configurations of coaxial thin apertures and their fields. 
Any such configuration of N apertures is uniquely specified by the aper- 
ture positions zi, the radii Ri and the physical surface potentials Ui, i = 
1, 2,... N, and also by the asymptotic field strengths Et for z --+ -c~ and Er 
for z ---+ cx~. The linear superposition of the corresponding single-aperture 
fields can be represented in many different but equivalent ways. Here we 
choose a superposition of N symmetric single-aperture potentials and the 
potential • H of one homogeneous field: 
N 
• a(z,,') = ~ 
C,v,(1 + u, ~r~t~ u,) +.4 + Bz 
(10.49) 
/--1 
the quantities u{ and v{ being spheroidal coordinates referring to the aper- 
ture with subscript i. This representation is the most simple. The coeffi- 
cients C1... CN are to be determined from the asymptotic field for large 
values of r: 
7rC{ 
Civi(1 + ui arctan ui) ---+ -~ilz- 
zil 
for 
r >> ni 
(10.50) 
Since the asymptotic field strength must be 
Ui - Ui+ 
Fi:= 
for 
zi<z<zi+l 
, i=l...N-1 
(10.51a) 
zi+ 1 -- z i 
F0:-Ez 
for 
z---',-c~ 
, 
FN:-E,. 
for 
z~oo 
(10.51b) 

10.3 SUPERPOSITION 
OF APERTURE 
FIELDS 
147 
at large off-axis distances r,we find 
Ck = (Fk-l - Fk)Rk/Tr 
, 
k= l...N 
(10.52) 
The total contribution of the homogeneous field can be represented as 
1{ 
} 
A + Bz = -~ U1 - Et(z - Zl)+ UN -- Er(z - ZN) 
(10.53) 
The algorithm corresponding to these formulae is very easy to program. 
10.3.3 Combination with the BEM 
In earlier investigations, prior to the publication of Hoch et al. (1978), 
mere superposition of aperture fields was used to approximate the electric 
field in devices with plane electrodes containing circular bores. 
This is 
entirely reasonable for very thin electrodes separated by large distances, 
[Zi+I -- Zi] >> 
Ri + Ri+a. 
Generally speaking, this method fails when 
applied to devices with thick electrodes although Regenstreif modelled the 
latter by two thin electrodes at the same potential. A typical example is 
shown in Fig. 10.13a, which represents equipotentials in an axial section 
through an electron gun with a thick wehnelt electrode. 
" 
In such a situation we suggest the following procedure. As a first step 
the appropriate aperture parameters are determined, so that the potentials 
ffA, given by (10.49), can be computed for any point in space. The chosen 
apertures may be located in the front planes of the electrodes, or inside 
the electrodes as suggested by Hoch et al. (1978). In the latter case the 
appropriate aperture potentials are to be obtained by linear extrapolation. 
The contribution CI, A alone, of course, will not give the full result. We 
therefore consider additional surface charge distributions. These can be 
confined to the vicinity of the bores, where the surface values of ¢I'A differ 
strongly from the prescribed boundary values. Thus, as a second step, 
we introduce a reasonable discretization of those parts B of the boundaries 
where such surface charges are to be applied. We can then solve numerically 
the integral equation 
/ 
(10 
B 
where z = z(s), z' = z(s'),..., are parametric representations of surface 
points and U(s) is the given boundary value function. 
After solving (10.54), the potential (~(z,r) and the field strength E = 
-V(I) at any point of reference can be computed by numerically superpos- 
ing (I)A and -V(I)A and the corresponding terms arising from the surface 

148 
10. THE BOUNDARY-ELEMENT METHOD 
r / c  m 
a 
2.0 
1.5 
1.0 
0.5 
0 - 
I 
0 
0.5 
1.0 
Field - Free 
space 
Fig. 10.13: Equipotentials a(.,.) = const in the upper half of an axial section through an electron gun with a 
plane cathode, a thick wehnelt and a thin anode. 
(a) Attempt to solve the Dirichlet problem by mere superposition of aperture potentials. The equipotential a(., r) = 
-900V does not fit the cylindrical bore of radius 1 cm of the wehnelt at all well. The examples makes it very clear 
that the potentials of additional surface charge distributions are indispensable. 

10.4 THREE-DIMENSIONAL DIRICHLET PROBLEMS 
149 
2.0 
1.5 
1.0 
i 
0.5 ~ 
cathode 
wehnelt 
anode 
| 
L 
, 
, 
, 
, 
, 
J 
, 
, 
, 
, 
I 
, 
i 
, 
0 
' 
' 
' 
' 
' 
I 
' 
' 
' 
' 
I 
-0.5 
0 
0.5 
1.0 
1.5 
2.0 
2.5 
3.0 
Fig. 10.13b: Equipotentials ¢(z, r) = const in the upper half of an axial section through 
an electron gun with a plane cathode, a thick wehnelt and a thin anode. The improvement 
achieved by the introduction of a suitable surface charge distribution. 
Coulomb integrals. The construction of this field is such that it satisfies 
the boundary conditions with a high degree of accuracy. The results for 
the chosen example are presented in Fig. 10.13b. 
The consideration of aperture fields is only one of many possible ways 
of extending the BEM. Another possibility is the superposition of the fields 
produced by axial charge distributions. This can be helpful for field calcu- 
lation in systems with pointed cathodes and will therefore be dealt with in 
Chapter 45. 
10.4 Three-dimensional Dirichlet problems 
There are three-dimensional Dirichlet problems that cannot be reduced to 
a sequence of two-dimensional ones. Such problems arise in most situations 
with non-rotationally symmetric boundaries. A typical example is the field 
in the vicinity of the hairpin of an electron gun, see Figs 10.19 and 10.20a,b. 
This case has been investigated by Eupper (1985) in order to estimate the 
influence of the electric field perturbation on the astigmatism in the electron 
beam. 
The extreme complexity of general three-dimensional boundary-value 
problems renders their concrete numerical solution much more complicated 
than that of two-dimensional problems. Here we can deal only with one 
family of problems, the three-dimensional Dirichlet problem for Laplace's 

150 
10. THE BOUNDARY-ELEMENT METHOD 
Fig. 10.14a: Dissection of a curved surface into surface elements by means of two families 
of surface curves. In at least one of these families, neighbouring curves are locally parallel 
(provided we consider small enough regions). 
equation V 2 V(r) - 0. 
The general method of solving such problems may appear to be straight- 
forward. The boundary OF is dissected into a set of N sufficiently small 
finite surface elements Ak, the centroids of which are located at rk (k = 
1... N). In each such element, the surface charge density ak is assumed to 
be constant. Then (9.14) is approximated by a linear system of equations: 
1 ~-~N ak[ 
da' 
V(rj) 
-- 
A~ 
, j-1...N 
(10.55) 
This system can be solved for al... aN, after which the surface Coulomb 
integral can be evaluated for any position r of reference. 
This is, in fact, the usual way of solving such problems. For instance, 
Munro and Chu (1982) have applied this method to an electrostatic deflec- 
tion unit. Such devices are still very simple, since all the surface elements 
/kk can be chosen to be rectangles. In more general cases, when triangular 
surface elements cannot be avoided, the method may become very tedious. 
It is certainly possible to calculate the potential of any triangular surface 
element with a uniform or even a linear charge distribution in a completely 
analytical manner (Durand, 1966; Eupper, 1985), but this is very laborious. 
Although the corresponding expression for V(r) can be built up entirely 
from elementary functions, its evaluation is very slow. Since the number 
of surface elements must be large in order to achieve good accuracy, the 
whole procedure is extremely inefficient. The problem of saving unneces- 
sary operations is far more important than in the case of two-dimensional 
field calculations. 
With a view to improving the efficiency, Eupper (1982, 1985) has made 
an unconventional proposal. In order to avoid the evaluation of improper 
integrals, the charges are assumed to be located on surfaces OF t chosen 

10.4 THREE-DIMENSIONAL DIRICHLET PROBLEMS 
151 
C~ 
B 
Fig. 10.14b: Perspective view of a single surface element and the associated trapezoid. 
The lines in the latter indicate the charged bars from which the surface charge element is 
built up. P and Q1,... Q4 are control points for the potential. 
close to the corresponding electrode surfaces OF, but in the interior of 
the corresponding electrode as is shown in Figs 10.14a and 10.14b. These 
surfaces are to be chosen reasonably, in the sense that the distance between 
parallel parts of OF t must be larger than the distance to the corresponding 
material surface OF. Difficulties thus arise with this method for very thin 
electrodes and in the vicinity of sharp edges. 
The interior surfaces OF t are now dissected into general trapezoidal 
elements (with parallelograms and triangles as special cases). Each such 
element Ak is associated with one control point rk located on the true elec- 
trode surface OF. The conditions that the potentials V(rI), V(r2)... V(rN) 
assume their prescribed values are now set up; this is straightforward. The 
new idea here is that one part of the necessary integrations, that in the 
longitudinal direction of each trapezium, can be carried out analytically, 
resulting in the potential of a charged bar; the corresponding expression 
will be given below. The remaining integration in the transverse direction 
is then carried out numerically. This procedure is comparatively simple 
and yet much faster than entirely analytic integration. The discretization 
by trapezia is so flexible that even complicated problems like those shown 
in Figs 10.19 and 10.20 can be solved satisfactorily. 
Let us now consider a charged bar of length 2a, the direction of which 
is indicated by a unit vector t. Let the charge per length unit be q(s) for 
-a _< s _ a. The origin of the coordinate system may be chosen to coincide 
with the centroid of the bar. The potential is then given by 
V(r)- 
1 
/ 
q(s)ds 
47re0 
[r - ts[ 
(10.56) 

152 
10. THE BOUNDARY-ELEMENT METHOD 
P 
(2 
OLj 
Fig. 10.15: Notation employed to characterize the position of an arbitrary point P 
relative to a bar of length 2a. 
There are two ways of carrying out the integration, direct analytic inte- 
gration and integration after an appropriate series expansion. In the most 
important case of a linear charge distribution q(s) = qo + ql s, direct inte- 
gration results in 
47reoV(r) = (qo + ql~)ln(dl 
+ d2 + 2a) 
dl + d2 - ~a 
+ ql (dl - d2) 
(~0.57) 
with 
dl,2 = lr T atl 
, 
~ = t " t - (d 2 - d2)/4a 
(10.57a) 
The quantities dl and d2 are the distances of the point r from the end- 
points of the bar, as shown in Fig. 10.15. 
Alternatively, we may use asymptotic multipole series expansion. After 
introducing spherical coordinates R, v~, defined by 
R := I,I 
, 
~ := cos0 := ~/R 
(~0.SS) 
we first write down the series expansion 
lr-tsl -i= R 2-2R,s+s 2 
=R -~ 
Pi(,) 
I=0 
s<R 
Introducing this into (10.56) and defining moments of the charge distribu- 
tion by 
tl 
Mi := a -(i+i) } q(s)s i ds 
(10.59) 

10.4 THREE-DIMENSIONAL DIRICHLET PROBLEMS 
153 
/ f 
i  1111 
/ 
Fig. 10.16: Equipotentials of the reduced magnetic scalar potential XM(r) of a magnetic 
lens with a very wide gap. Courtesy of W. Scherle (1983). 
we obtain 
°° (R)I+I 
= 
1--0 
MtPt(tt) 
(10.60) 
where the Pt(#) are Legendre polynomials. Using the relation I~P[(l~) + 
(I + 1)Pt(#) = P[+l(t~), the gradient of this potential can be written 
47re0VV 
1 
t+2 
= - 
Mt 
tPI(# ) - -~ /+l(.) 
a i=0 
(10.6 ) 
In the case of a linear charge distribution the moments Mt are given by 
Mt = { qo/(l + 1/2), 
l even 
qaa/(1 + I/2), 
l odd 
The series expansions (10.60) and (10.61) have a very simple structure and 
are hence attractive if they can be terminated after a very few terms. This 
is the case when R/a > 5. In conclusion, the calculation of such a potential 
field can be made fast enough to be useful as a basic routine in the numerical 
solution of three-dimensional Dirichlet problems. 
Practical tests have shown that it is quite sufficient to assume constant 
surface charge density in each trapezoidal element if the field is needed only 
in domains far from all boundaries, as is the ease in deflection units. When 

154 
10. THE BOUNDARY-ELEMENT METHOD 
(o) 
co,, 
Zr////////A'. 
(b) 
(c) 
Fig. 10.17: Equipotentials of the reduced magnetic scalar potential Xm(r) in an axial 
section through a system of saddle coils, a ferromagnetic yoke and a pierced shielding plate. 
(a) The position of the saddle coils (b) Ferromagnetic shielding plate (c) Superconducting 
shielding plate. (Note: the coils and their field H0(r) are omitted from (b) and (c) to 
prevent confusion.) Courtesy of W. Scherle (1983). 

10.4 THREE-DIMENSIONAL DIRICHLET PROBLEMS 
155 
3.6 
2.8 
,0_ 
y/~m 
1.2_ 
0.4 
-0.4 _ 
-1.2 
-2.0_ 
-2.8 
a 
-3.6 
' 
a'8 
' 
z/t.im 
x/~m 
2.8 
2.0 
7.2 
04 
-0.4_ 
-1.2 
-20_ 
b 
-2.8 
08 
16 
z/~m 
Fig. 10.18a,b: (a)-(c) Equipotentials in different sections through a field electron emis- 
sion source consisting of a cathode with a hipped roof and an anode with a rectangular 
bore. Courtesy of M. Eupper (1982). 

156 
10. THE BOUNDARY-ELEMENT 
METHOD 
E 
200, 
1.60 
1.20. 
0.8( 
0.40. 
O- 
-080. 
-1.20 
-'1.60. 
o 
i 
r 
r 
¢- 
k. 
! 
! 
I 
i 
=m .., 
==~ 
_J 
90 -a~ -~o 'o5o 
x/~ 
o~ 
I 
1.00 
Fig. 10.18c 

10.4 THREE-DIMENSIONAL DIRICHLET PROBLEMS 
157 
Fig. 10.19: Perspective view of a pointed cathode welded on a hairpin support; Only 
parts of the surface discretization are shown for reasons of clarity. Courtesy of M. Eupper 
(1983). 
I 
r 
Fig. 10.20: (a), (b) Equipotentials of the electrostatic potential in two perpendicular 
sections through the system shown in Fig. 10.19. The position of the anode is indicated. 
The total width is 10 mm and the anode-cathode distance is 2 mm. 

158 
10. THE BOUNDARY-ELEMENT METHOD 
the method is applied to asymmetric electron guns, higher accuracy-- 
especially of the field strength--can be achieved by choosing the charge 
distribution in each surface element as a bilinear function of the corre- 
sponding coordinates, so that the whole distribution becomes continuous 
(in the vicinity of the cathode). The structure of the linear system of equa- 
tions for the surface charges does, of course, become more complicated. 
Alternative techniques for the solution of three-dimensional Dirich- 
let problems are the three-dimensional versions of the finite-difference and 
finite-element methods. These are generally so dependent on the problem 
in question that they will not be treated in any detail here. For an exam- 
ple, see the detailed description of the use of the three-dimensional FDM to 
calculate electrostatic focusing fields in cathode ray tubes given by Franzen 
(1984). 
10.5 Examples of applications of the boundary-element method 
The rotationally symmetric solution of (9.11), corresponding to the order 
m = 0 in (9.27), is useful for calculating the magnetic field of a round lens 
with a very wide gap (Scherle, 1983) as is shown in Fig. 10.16. For clarity, 
only the equipotentials of the reduced scalar potential XM(r) are presented. 
A typical example of field calculation in deflection systems (Scherle, 1983) 
is shown in Figs 10.17a-c. Again, only the equipotentials of XM(r) in one 
section through the field are shown. The case in which there are three 
different domains of solution can be analysed by iterative solution of two 
coupled integral equations of the form (9.11) (Scherle, 1983). 
The three-dimensional BEM becomes a very powerful method when 
problems with very large differences in the geometrical dimensions are to 
be solved. Some typical examples are field-electron emission sources with 
a hipped-roof cathode (Figs 10.18a-c; Eupper, 1982) and with a rotation- 
ally symmetric tip welded on a hairpin-shaped support (Figs 10.19 and 
10.20a,b). More details of field calculations in electron sources are given in 
Chapter 45. 

11 
The Finite-Difference Method (FDM) 
The finite-difference method (FDM), usually combined with an iterative 
technique to solve the corresponding linear system of equations, is a stan- 
dard procedure for field computation. It was introduced by H. Liebmann 
as early as 1918 and is thus often called 'Liebmann's method'. The as- 
sociated mathematical theory is exhaustively studied in the literature, for 
instance by Varga (1962), Forsythe and Wasow (1960), Ames (1969) and 
Jacobs (1977). Survey articles on the application of the FDM to electron 
optical problems have been published by Weber (1967), Bonjour (1980) 
and Kasper (1982). In recent years, however, more powerful techniques 
have been developed for solving boundary-value problems, and the original 
form of the FDM has lost much of its earlier importance; we shall therefore 
discuss it only briefly. 
11.1 The choice of grid 
The basic idea of the FDM is to cover the entire domain of solution of a 
boundary-value problem by a finite rectangular grid. In order to obtain the 
greatest possible simplification, it is usual to specialize to square-shaped 
grids. We have to distinguish between regular internal points (A), irregular 
internal points (B), regular axial points (C,D), irregular axial points (E) 
and boundary points (F), as shown in Fig. 11.1. In the practical orga- 
nization of a FDM program, each point has to be assigned to one of the 
classes and handled accordingly, which complicates the actual application 
of the FDM. Since the boundary of the domain is in general curved, these 
complications cannot be avoided. 
In the subsequent presentation we shall consider a two-dimensional 
Dirichlet problem associated with a general elliptic differential equation: 
A(u, v)Vl,,,, + B(u, v)Vlvv + a(u, v)Vl,, + b(u, v)VIv 
(11.1) 
= 
v)y(u, v) + 
(For an explanation of the notation, see Section 2.4.) The coordinate sys- 
tem (u, v) may be curvilinear, but is almost invariably chosen to be 0r- 
thogonal. A term with ~,~ cannot then appear and is hence omitted from 
(11.1). 

160 
11. THE FINITE-DIFFERENCE METHOD (FDM) 
/ 
i 
\ 
] 
L 
L_EI] 
U 
Fig. 11.1: Grid with square meshes and distinction between different types of node. 
There are essentially two different ways of deriving discrete formu- 
lae, the Taylor series method and the integral method. Both are in very 
widespread use and equivalent in the sense that they differ only in higher 
order terms of the discretization errors. 
11.2 The Taylor series method 
Since irregular configurations are to be treated in the vicinity of the bound- 
ary at least, we now consider a general five-point configuration, as shown 
in Fig. ll.2a. In order to establish a discrete form of (11.1), we expand 
V(u, v) as a Taylor series with respect to the coordinate differences u - u0 
and v- v0. In applications to five-point configurations, we have to trun- 
cate this after the second order terms. This implies that, along the lines 
u = u0 = const and v = v0 = const, we can approximate the potential by 
Lagrange interpolation parabolae. For instance, the parabola that fits the 
potential at the points P3, P0 and P1 (see Fig. l l.2a) is given by 
1 (= _ u0)~. ~ 
v(~, v0)= v0 + (u- ~0)y~. + 
The derivatives ~u and Vlu,, refer to the central point P0 and are given by 
VI" = hlh3(hl + h3) 
VII"" = h~h3(h~ + h3) h3V~ + hlV3 -(h~ + h3)Vo 
Similar expressions are obtained for the derivatives I~,, and I,~,,,,. Introdu- 
cing all these into (11.1), we obtain a finite-difference approximation for 

11.2 THE TAYLOR SERIES METHOD 
161 
V 
2 
lv 
h2 
3 
1 
u 
a 
e 
b 
Fig. 11.2: (a) Five-point configuration for internal nodes O. (b) Four-point configuration 
to be used when the node 0 lies on the axis. 
the latter. This is to be solved for the value V0 at the grid point P0 in 
question. The resulting linear relation has the general form 
v0 = ~0 +/~1v1 + Z2v2 +/~3v3 +/bY4 
(11.2a) 
the coefficients ~0...f14 depending on the position of the grid point in 
question and being given by 
~o = Go/N 
2A0 + aoh3 
2B0 + boh4 
~1= 
, 
~2= 
hi(hi + h3)Y 
h2(h2 + h4)g 
2A0 - aohl 
2B0 - boh2 
&= 
, 
&= 
h~(hl + h~)g 
h,(h~ + h,)g 
2A0 + ao(h3 - hi) 
2B0 + bo(h4 - h2) 
N=C0+ 
+ 
hlh3 
h2h4 
(11.2b) 
A relation of this kind holds for all regular and irregular internal grid points. 
On the axis of symmetry, however, only four-point configurations can be 
evaluated, as is shown in Fig. 11.2b. In such a case the symmetry condition 
V(-u, v) = V(u, v) leads to 
- 0 
lim [ Vl'(u' v) 
' 
v--*0 [ 
V 
= yl..(u, 0) 
The second-order derivative is then given by 
y~..(., 0)= 2(y~ - Yo)h; ~ 
Introducing these approximations into (11.1) we obtain the four-point for- 
mula. It is necessary to assume that b(u, v) = b(u, v)/v, where b(u, v) is an 

162 
11. THE FINITE-DIFFERENCE METHOD (FDM) 
even function with respect to v and may also vanish. The coefficients are 
then given by 
~4=0 
, ~2=2(B0+b0)/Nh 2 
2A0 + a0(h3 - hi) 
2(B0 + b0) 
(11.2c) 
N=C0+ 
+ 
hlh3 
h~ 
while/30, ~ and ~3 remain the same as in (11.2b), apart from the different 
normalization factor N. 
As a comparatively simple example, we shall now consider the differ- 
ential equation 
Vlzz + Vlrr + -VIr= -g(z,r ) 
(11.3) 
r 
which includes (7.10) as a special case with (r = 2m+ 1. We limit the discus- 
sion to regular grid points, for which the finite-difference approximations 
can be given easily in explicit notation. With 
V/,k := V(ih, kh) (i, k 
integers) 
(11.4) 
and a similar notation for g(z, r) we obtain 
1( 
) 
V},k = ~ V}+x,k + V}-l,k + V},k+l + V},k-1 + h2gi,k 
°( 
) 
+ ~-~ 1/}+1,k - Vi-l,k 
, 
k > 1 
for internal mesh points and 
1 { 
} 
~,o = 2(~ + 2) ~+~'0 + ~-~'0 + 2(~ + 1)~,, + h~9,,. 
(11.5a) 
for axial mesh points (if a # -2). The resulting discretization error is of 
fourth order in the mesh-length h. The set of relations (11.5a,b) forms a 
linear system of equations specified by two subscripts i and k. 
11.3 The integration method 
In the subsequent presentation, we assume that the differential equation to 
be solved is self-adjoint: 
( ) °( ) 
a pvi~ + 
PVl~ = Qv + s 
(~1.6) 

11.3 THE INTEGRATION METHOD 
163 
/ 
\ 
/ 
_.,. 
\ 
/~/f/ 
\ 
',,.. 
b 
2 
/ 
\ 
j 
\ 
3 
0 
I 
Fig. 11.3: Rectangular loops and areas of integration (a) for internal nodes and (b) for 
axial nodes. In the latter case, both the loop and the area can be doubled by exploiting 
the mirror symmetry. 
the coefficients P, Q and S being regular functions of u and v. Applying 
Gauss's integral theorem to any domain R and its closed boundary C we 
obtain 
/ 
// 
P ~ 
ds = 
(QV + S)dudv 
(11.7) 
c 
R 
OV/On denoting the normal derivative of V in the outward direction. This 
integral relation is exact. Its practical evaluation, however, requires several 
simplifying assumptions. For instance, when applying (11.7) to the con- 
figuration shown in Fig. l l.3a, we can make the approximation OV/On = 
(Vi - Vo)/hi (i = 1... 4) on the corresponding side si of the rectangular 
contour. Furthermore we make the simplification V ~ V0 under the double 
integral; we then obtain the finite-difference equation 
Vi - Vo / P ds = f f (QVo + S) dudv 
i=1 
hi 
si 
R 
(ll.8a) 
Provided that the integrands are sufficiently simple analytic functions, it is 
possible to perform the remaining integrations analytically, but this brings 
no essential gain in accuracy, since the approximation made for OV/On is 
then too inaccurate. Thus, in order to obtain a practical form of the dis- 
cretization, we assume Q ~ Q0 = Q(uo, vo), s ~ So = S(uo, vo) on the 
right-hand side of (ll.8a). On the left-hand side, we assume that the inte- 
grand P is piecewise constant, for instance P(u, v) ---, P(uo + hl/2, vo) =: 
P1 on the right-hand side of the rectangular integration path shown in Fig. 
11.3a, the other parts of this path being treated analogously. We then find 

164 
11. THE FINITE-DIFFERENCE METHOD (FDM) 
immediately 
-- 
hi + h3 
(1/1 - V0) h2 + h4 p1 + (V2 - V0) 
P2 
2hl 
2h2 
h2 + h4-- 
hi + h3~4 
+(1/3-V0) 
2hs 
P3+(1/4-V0) 
2h4 
1 
= -4(Vo + QoSo)(h~ + h3)(h2 + h4) 
(ll.8b) 
Solving this for V0, we obtain a linear relation which differs from (11.2) 
only in the values of the coefficients rio.., f14. The two discretizations are 
equivalent in the sense that they differ only in discretization errors of third 
or fourth order in the mesh-length. These error terms are to be neglected 
in any case. For axial nodes O, some special considerations are necessary, 
which are not given here. For the most important special case mentioned 
below, the reader will find them in Janse (1971) and Kasper (1976). 
The above considerations can be applied to (11.3), since this differen- 
tim equation can be rewritten as 
) 0( 
) 
N 
+ N 
<Yl  
= 
(11.9) 
so that in (11.6) we have P = r ~, Q - 0, S = -r~g. The corresponding 
discretization formulae have been published by Janse (1971) and Kasper 
(1976, 1982) and will not be repeated here. The discretization differs from 
(ll.5a) essentially in the fact that here the integrations in (ll.8a) are car- 
ried out analytically and all the coefficients remain strictly positive, whereas 
in (ll.5a), the coefficient of Vi,k-1 becomes negative for a > 2k. Positive 
coefficients mean increased stability of the entire system of equations when 
these are solved by iterative techniques (see Section 11.5), but the final ac- 
curacy of the solution obtained is not better than that given by (11.5a). It 
is interesting to note that the discretization formula obtained by integration 
over the configuration shown in Fig. ll.3b is identical with (ll.5b). 
The integral method may be further generalized to discretization in 
general triangular grids. The corresponding algorithms have been derived 
by Colonias (1974) and Winslow (1967). These will not be treated here, 
since they seem to be less favourable than the finite-element method pre- 
sented in Chapter 12. Some other refinements of the FDM are possible; 
see, for example, Lenz (1973) and Kasper (1982) for further details. 

11.4 NINE-POINT FORMULAE 
165 
11.4 Nine-point formulae 
The accuracy of the FDM can be improved considerably by the use of 
nine-point formulae (Durand, 1966; Kasper, 1976, 1984a,b). 
These are 
advantageous in the case of a regular grid; the solution of the problem that 
arises for irregular grid points is given below. 
11.4.1 General formalism 
We reconsider the differential equation of the general form (11.6). More 
particularly we assume that the coefficient functions have a common factor 
v ~ with v >_ 0, a > -1, so that 
o( 
Ou P~v~Yl" 
+ N 
p~v"yl~ 
+ 
(Ov + ~) = o 
(11.10) 
p(u, v), ~(u, v) and s(u, v) being finite analytical functions of their variables 
and p > 0. There is a wide class of differential equations that fit (11.10). 
One practical example is (11.9) with p - 1, ~ - 0, v = r, s = g; we shall 
meet others below. The same type of discretization can be applied to all 
these equations, as will be obvious from the following considerations. 
We first note that by writing 
U(u,v) 
(11.11) 
V(., v) =: ;(u, v) 
(11.10) collapses to the simpler form 
A,~U=-g(u,v)'=-(q(u,v)U-Fps) 
(11.12) 
with 
and 
02 
02 
a 0 
As := Ou 2 + ~ 
+ v Ov 
(11.13) 
q(u, v) = {(u, v) 
Ao, p 
(11.14) 
P 
If we consider cylindrical coordinates, u = z and v = r, all the differential 
equations derived in Chapter 7 are seen to be special cases of (11.12). There 
are, however, important examples of representations in other coordinate 
systems, as we shall see later. 
Just as for the five-point discretization, we have to distinguish between 
on-axis formulae (v = 0) and off-axis formulae (v > 0), and again these 

166 
11. THE FINITE-DIFFERENCE METHOD (FDM) 
v.k 
B~,k 
Bo, k 
B-l, k c, 
(a) 
(b) 
A. 
T v,k 
• 
2 
~B'l,k 
B~ o 
,42o 
Blo 
,, 
,B4k 
. . . . . . .  
A-l,k 
Bqo 
Ao, o 
Bo, o 
Fig. 11.4: Notation employed for the points and coefficients in nine-point configurations. 
(a) General case and (b) on-axis node. 
can take different forms. Here we shall present only the results derived 
by Kasper (1984a), since these seem to be most favourable for practical 
applications. For reasons of space we cannot reproduce here their lengthy 
derivation, to be found in the corresponding publication. 
We again use a notation with two subscripts i = u/h, v = k/h; the 
notation for the coefficients is explained in Figs 11.4a,b. The discretization 
formulae are most conveniently given by an implicit representation in terms 
of a new array W, defined by 
Wi,k := Ui,k -f- -~gi,k ~ Pi,k Vi,k + "~ qi,k Vi,k -I- Si,k 
(11.15) 
The off-axis discretization (k ~- O) is found to be 
Wi,k = A-l,kWi,k-1 + Al,kWi,k+l -Jr Ao,kh2 gi,k 
1 
2t" E 
Bj,k (Wi-l,k+j "~" Wi+l,k+j) + O(h s) 
j=-I 
(11.16) 
The coefficients are given by 
- 
2) 
7k'= I0(24k 2+a 2-2~-6) 
1 
a 
( 
2~+5 / 
A+l,k=~+ 
1-~ +7k 1:~ 
6k 
3 
1 
A0,k= l--O-7k , 
B0,k=~--Tk 
1 
a 
a+l 
B+l,k = ~ ± ~ 
=F 7k 12k 
(11.17) 

11.4 NINE-POINT FORMULAE 
167 
This set of coefficients is obviously independent of the mesh-length h. It 
is sensible to compute it at the beginning of the program and leave it in 
store. 
On the optic axis (v = 0, k = 0) a slightly different discretization is 
necessary. Equation (11.15) remains valid but in the discretization not only 
are the coefficients different but some other terms appear: 
i1 
( 
) 
Wi,o = Al,oWi,1 -1- Z 
Bj,o 
Wi-a,j + Wi+l,j 
j=o 
+ h2{Ao,ogi,o+C(gi,o - gi,l)l+O(h6) 
(11.18) 
the set of coefficients being given by 
(1 + a)(6 + a) 
1 
~:= 
6(3+c~) 
, 
3'0"= 2(2+c~-/3) 
Aa,0 = 23'0(1 + c~-/3) 
Bo,o = '7o(1 - 3) 
, 
BI,O -- "/03 
a(1 +a) 
Ao,o=7o 
, C=7o6(3+a) 
(11.19) 
For a < 0 (a = -1 for flux fields), the axial discretization fails, but then 
we have simply Wi,o = Ui,o = gi,o = si,o = O, so that (11.18) is no longer 
needed. 
In order to reduce the necessary amount of calculations and storage 
locations, we rewrite (11.15) in the form 
h 2 yi, k = ( qi,k h -2 -'1- -f'lqi,k)pi'k'si'k) ----" Ci,k Wi,k "4" Si,k 
(11.20a) 
from which the field V has been eliminated. The sets of coefficients Ci,k and 
Si,k are calculated once in the beginning and stored. Next, the boundary 
values of W are determined from (11.15) and stored. The boundary-value 
problem for the array W can now be solved using (11.16) and (11.18) and 
with (11.20a) as source terms. In this major calculation only three arrays, 
C, S and W, are needed simultaneously. Finally the required function V 
is obtained by solving (11.15) for V~,k, or equivalently from 
-1{ 
Vi,k = Pi,k Wi,k - 
,k + s ,k) } 
(11.eob) 

G 
11. THE FINITE-DIFFERENCE METHOD (FDM) 
168 
"/ <, 
Fig. 11.5: An expanding spherical-mesh grid and part of a curved boundary that does 
not fit this grid ( h = r/20). 
This can be performed without any increase in memory requirement, since 
there is no iteration and the coefficients C, S and W are no longer needed 
once the expressions on the right-hand side have been evaluated. 
11.4.2 Expanding spherical-mesh grid 
The formalism developed above fits very many different forms of the equa- 
tions of Laplace, Poisson and Helmholtz. In electron optics, they are most 
frequently expressed in cylindrical coordinates but this is not always ad- 
vantageous. In order to calculate the field in field-emission electron guns 
(see Part IX), Kang et al. (1981, 1983)introduced an expanding spheri- 
cal grid which they called SCWIM (spherical coordinates with increasing 
mesh-width). This can be regarded as a conformal mapping of an originally 
cylindrical grid with square-shaped meshes: 
z + ir = R0 exp(u + i0) = R(cos 0 +isin 0) 
with an arbitrary positive constant R0, and hence 
R=R0expu 
, 
0-v 
(11.21) 
If the mesh-length h in the coordinates (u, v) is constant, the corresponding 
grid in the real space expands exponentially, as shown in Fig. 11.5. (This 
interpretation is not mentioned by Kang et al.). 
Introducing (11.21) into the rotationally symmetric Poisson equation 
in spherical coordinates (R, 0): 
02 v 
2 av 
1 o ~v 
cot 0 av 
~(R, ~) 
(~1.22) 
OR--- ~ + ~ ~ 
4 R2 OO 2 ~ R2 9~ - 
eo 

11.4 NINE-POINT FORMULAE 
169 
we find after some elementary calculations 
O (e,, 
OV) 
c3(i)V) 
R02e3" sin v 
Ouu 
sin v N 
+ Ov e" sin V-&v 
- 
eo 
g(Roe", v) (11.23) 
This can be brought into the form (11.10) with 
sin v 
p2 __ e" 
a=l 
, 
~ 
, 
~=-0 
v 
Ro2e 2'* 
R 2 
s = ~~O(noe", 
v) - --Lo(R, 0) 
G0 
G0 
(0 < v < ~r) 
(11.24a) 
(11.24b) 
The evaluation of (11.14) results in 
1( 
1 
1) 
1 ( ~ )  
q = 4 
sin 2 v 
v2 
= 
1 "-[- 
+ 0(1) 4) 
(11.24c) 
The derivation of the corresponding nine-point discretization is now a 
straightforward matter. 
It has been proposed by Kasper (1984a) and 
worked out by Killes (1985). In comparison with a five-point discretiza- 
tion with equal meshes, the gain in accuracy is considerable, so that it 
is certainly worthwhile to use the nine-point discretization whenever this 
is possible. All that is required is the determination of the coefficients in 
(11.20) from (11.24), the result being 
! 
1 (sinhk)  
Pj,k = exp(~jh) 
hk 
1( 
1 
1 ) 
qj,k ='qk = ~ 
sin Shk 
h 2k 2 
12q~ 
C,,k =-Ck 
= qk + 12h -2 
Sj k = 12pj, ksj,k 
' 
qk + 12h -2 
where j and k are integers. Equations (11.16) and (11.18) with (ll.20a) 
and finally (ll.20b) can then be solved. 
As Killes (1985) pointed out, this method is useful for 0 < 0 = hk < 
~r/2. For larger values of 0, it is better to discretize the variable 0' := 7r- 
and to join the fields in the two domains together smoothly at v~ = 0 ' = r/2. 
The concept of conformal mapping can be generalized further but we shall 
not pursue this here. 

170 
11. THE FINITE-DIFFERENCE METHOD (FDM) 
/ 
f 
f 
\ 
~i_- 
I .I 
/ 
.,s 
8G 
c3G 
~u 
\ ) 
Fig. 11.6: Extension of a regular grid beyond the curved boundary aG of a given 
domain G. 
11.4.3 Combination with the BEM 
It frequently happens that a boundary-value problem is to be solved in 
which the boundary contours do not fit the grid. For every irregular in- 
ternal node the general five-point formulae then have to be applied. This 
complicates the FDM very considerably and diminishes its accuracy. This 
disadvantage can be circumvented in different ways. In the case treated 
above and for the solution of other Dirichlet problems for Poisson's equa- 
tion X72V = -0(r)/e0, combination with the boundary-element method 
(BEM) is effective (Kasper, 1984a,b; Killes, 1985). First, the regular grid 
is extended beyond the boundaries so that only regular points are obtained, 
as is demonstrated in Figs 11.5 and 11.6. In this grid, Poisson's equation 
is solved with arbitrary reasonable boundary values. The values at the 
true curved boundary are then determined by interpolation. This can be 
done very accurately since interpolation in regular grids raises no problems 
(Killes, 1985). The values obtained are now subtracted from the prescribed 
boundary values, and with these differences the Dirichlet problem X72V ' = 0 
is solved using the BEM. The required total solution is then obtained by 
superposition. The advantage lies in the fact that the solution of Pois- 
son's equation by means of the FDM is much faster than the evaluation of 
Coulomb integrals, while the BEM can be applied easily to configurations 
with curved boundaries. 
11.5 Iterative solution techniques 
These will be briefly treated here; the same techniques are also used to solve 
the equations resulting from finite-element approximations. In order to 
obtain a highly accurate final solution, the mesh-length must be sufficiently 
small. Then, of course, the rank N of the system of equations for the 
potential at the internal nodes becomes very large, typically N ~ 104. It 
is then practically impossible to obtain the solution directly. However, a 

11.5 ITERATIVE SOLUTION TECHNIQUES 
171 
solution can be found iteratively, since the coefficient matrix of the system 
is sparse. 
In the past decades, numerous iterative techniques for solving large 
linear systems of equations have been developed. The corresponding math- 
ematical literature is very extensive; some of the major works are cited in 
the bibliographic listing. 
The first step in the application of any of these methods is the choice 
of an appropriate numbering of the grid points. All the internal grid points 
must be counted exactly once in a one-dimensional sequence and no bound- 
ary point must be counted as the whole domain of solution is scanned. 
For instance, an appropriate numbering of the internal points with indices 
I1 < i </2, K1 _< k _< K2 is given by 
# := i - I1 + 1 +(k-K,)(I2 
-I1 + 1) 
1 ___# _< N := (K2 - K1 +1)(/2-/1 +1) 
but permutations of this sequence are also allowed. With this linear se- 
quence of numbering, the whole system of finite-difference equations can 
be brought into the general form 
N E' 
V~, = 
C~,,,V,, + Q,, 
, 
# = 1... N 
(11.25) 
v=l 
the prime indicating that the case # - v is to be excluded. The matrix on 
the right-hand side is large but sparse, its nonzero elements can be easily 
calculated and it is therefore not necessary to store them. The inhomoge- 
neous terms Q~, arise from the boundary values of the potential and from 
the source terms. 
The standard iterative technique for solving linear systems of equa- 
tions like (11.25) is the successive overrelaxation method (SOR). 
The 
corresponding procedure is defined by 
#--1 
N 
s(n+l) " ---- E 
,..- /,L v(n+l) "~ 
" - , '  
v 
E 
"'"/~'v/~" v(n)'Jl-" 
" 
Q" 
(11.26a) 
v=l 
v= #-t-1 
V~ "+') 
V~ ") +w 
m, 
, 
# = 1...N 
(11.26b) 
Here the superscript in parentheses denotes the iteration number. 
The 
starting values V(°)... V (°) can be chosen arbitrarily; a sensible guess for 
these is quite sufficient. The constant w, the relaxation parameter, must 
satisfy 1 < w < 2. It is very important for the convergence of the iteration 

172 
11. THE FINITE-DIFFERENCE METHOD (FDM) 
P 
/ /I 
I 
/ 
I 
/ 
~ 
I 
/ 
I 
I 
/ 
I 
I w 
I 
~opt 
2 
I 
I 
I 
I 
I 
i 
I 
i 
I 
I 
[ 
w 
wopt 
Fig. 11.7: Asymptotic behaviour of the damping factor p and relative iteration number 
Nr as functions of the relaxation parameter w. 
procedure to choose it suitably, as will be discussed below. The practical 
¢(n+l) 
meaning of (11.26a,b) is as follows. The quantity ..~, 
is an approxima- 
tion for the expression on the right-hand side of (11.25). This Gauss-Seidel 
value is calculated from the newest values 1I, (u = 1... N); it is, however, 
not accepted as the next approximation, but instead the difference between 
it and the preceding value V~ ") is magnified by a factor w, as is obvious 
from (11.26b). 
In the practical setup of a SOR program, each successive approxima- 
tion V (I), 1 = 0,1, 2,...for the same variable V, is stored in a single location 
assigned to V,, and for S only one storage location is necessary. Since the 
array {Qv, u = 1... N} is usually sparse, the necessary number of storage 
locations is in practice not much greater than N. 
The theory of the convergence of the SOR is investigated exhaustively 
in the mathematical literature; see Ames (1969), Varga (1962) and We- 
ber (1967), for example. A sufficient and often necessary criterion for the 
convergence of SOR is that 
N 
Z'IC,~I<I 
, 
#=I...N 
(11.27) 
v--1 
At least one of these sums must be less then 1. For a > 1, criterion (11.27) 
is violated by (11.5a), so that SOR cannot be applied to (11.5a). When 
the process does converge, its rate depends essentially on the choice of w, 
as is shown in Fig. 11.7. The number of iterations Nit needed to reduce 
the iteration error A below a given error limit e does of course depend on 
the definition of A, the choice of e and the initialization V, (°), # = 1... N. 
But the value of Wopt, where Nit has its sharp minimum, and the relative 
iteration number, Nr = Nit/Nmin, do not depend on these quantities. 

11.5 ITERATIVE SOLUTION TECHNIQUES 
173 
According to the general theory of SOR, the optimum value of w is 
given by 
2 
Wopt = 1 + ~/1- A 2 
' 
IXl < 1 
(11.28) 
A being the largest (real) eigenvalue of the matrix C in (11.25). For any 
value of w this quantity A is related to the asymptotic damping factor p, 
(p < 1) by 
= (p+w- 1) 2 
(11.29) 
w2p 
Since )~ and p are very difficult to calculate exactly, Car% (1961) has pro- 
posed a method of estimating these quantities, and hence Wopt, from the 
actual rates of convergence during the computations. Winslow (1967) has 
modified this method. Both versions work adequately in many applications 
but not in every case. For further information the reader is~referred to the 
original papers. 
A further refinement of the SOR is the familiar successive line overre- 
laxation (SLOR) method. Here SOR is combined with Gaussian elimina- 
tion for tridiagonal subsystems. For instance, in applications to (ll.5a,b), 
these equations are first solved directly along each radial row of the grid, 
the values in the neighbouring rows being regarded as known for the mo- 
ment; thereafter the values obtained are modified by overrelaxation and the 
algorithm proceeds to the next row. The whole grid is scanned repeatedly 
in this way until sufficient convergence has been achieved. 
The main advantage of the SLOR method is that it removes the in- 
stabilities of the simple SOR when (11.27) is not satisfied. This has been 
reported by Kasper and Lenz (1980), who applied the SLOR to (ll.5a,b). 
Still more refined techniques for solving large but sparse systems of lin- 
ear equations are the alternating direction implicit methods (ADI: Peace- 
man and Rachford, 1955; Varga, 1962; Jacobs, 1977), the strongly implicit 
methods (Stone, 1968) and the cyclic reduction methods (Buneman, 1971, 
1973). With the rapid increase of memory capacity, direct solution tech- 
niques are also becoming more and more attractive. Special procedures 
that order the corresponding matrix in such a way that only its nonzero 
part is stored then become necessary. Munro (1971, 1973) has applied such 
methods to systems of equations arising in electron optical field computa- 
tions. 
In summary, we wish to emphasize that by the introduction of refined 
techniques, much computation time can be saved, but, of course, the de- 
velopment of the corresponding computer program then becomes a major 
task. In any given case, one has to make a reasonable compromise between 
the time spent on writing an adequate computer program (or the expense of 

174 
11. THE FINITE-DIFFERENCE METHOD (FDM) 
a commercial one) and the computation time (CPU) saved. Furthermore, 
we again stress that these techniques are not restricted to 
FDM but can 
also be used in combination with the FEM, treated in the next chapter. 

12 
The Finite-Element Method (FEM) 
Though the basic ideas and equations of the FDM are very simple, the 
practical application of this method to boundary-value problems can be- 
come extremely tedious if the boundaries are of an irregular shape. In the 
finite-element method (FEM), this difficulty is removed by the use of gen- 
eral triangular grids, as is shown in Fig. 12.1. Such grids can be fitted to 
any shape of boundary, once the latter has been represented approximately 
by a polygon. Since the numerical differentiation now becomes very com- 
plicated, partial differential equations are not considered here. Instead, the 
equations governing the values of the potential at the nodes of the grid are 
derived directly from an appropriate variational principle (see Section 6.3). 
The FEM was proposed by Courant (1943). It came into practical 
use with the development of modern computers and has found widespread 
application in mechanical and electrical engineering. Typical examples are 
problems in fluid dynamics and aerodynamics, elasticity, heat conduction 
and magnetic field computations for electric machines (Chari and Silvester, 
1980). For further details we refer to the books of Zienkiewicz (1967, 1971). 
Mathematical problems associated with the FEM are treated in detail by 
Norrie and de Vries (1973). In electron optics, the FEM was first used 
by Munro (1971), who applied it to the computation of magnetic fields 
in round lenses. Since this is of especial interest in electron optics, we 
now deal with this application. The presentation of the FEM given below 
differs from Munro's version in the introduction of form functions and in 
the unification of the methods for saturated and unsaturated lenses. 
12.1 Formulation for round magnetic lenses 
The appropriate variational principle 
for magnetic field calculation is 
(6.13) in combination with (6.17), (6.18) and (6.29). Though magneti- 
zation curves are usually presented in the form B = B(H) and thus (6.18) 
is quite familiar, it is more convenient for the FEM to write 
fl := B2(z,r) 
, 
V(fl):= U(B) 
(12.1) 
Then (6.19) is in agreement with 
1 
- = u(/~)= 2V'(~) 
(12.2) 
# 

l f, 
12. THE FINITE-ELEMENT METHOD (FEM) 
176 
\ 
IN/N@ 
~/\ /" 
yoke 
__..- 
~Z 
Fig. 
12.1" Finite-element discretization; this example concerns the vacuum part of a 
meridional section through a round magnetic lens. 
We now introduce cylindrical coordinates (z, r, T) and perform the integra- 
tion over ~0. The variational principle (6.13) now takes the form 
W = 2~r//{ V(~) - j(z, r)A(z, r) } rdrdz = minimum 
s 
(12.3) 
S being the domain of integration in the axial section and 
Z=(V×A)~= 
N 
+ N + 
(~2.4) 
In order to solve this variational equation, some simplifying assumptions 
are necessary. 
The expression (12.3) must be minimized with respect to any per- 
mitted variations of the vector potential A(z,r). In the FEM these are 
variations of the values Aj := A(zj, rj), j = 1...N, assumed at the internal 
nodes of a triangular grid, N being the total number of such nodes. In this 
context it is convenient to introduce dimensionless form functions fj(z, r) 
associated with the node with the corresponding subscript; a detailed def- 
inition will be given below. 
We start now from a series expansion 
N 
A(z, r) = E Akh(z, r) 
(12.5) 
k--1 
and with (12.4) in mind, we introduce the abbreviation 
rt,k(z, ~) = r,,,(z, ~) = f~l~f~,, + (f~l, + ~-, f,) (h~ + ~-~ f~) 
(12.6) 

12.1 FORMULATION FOR ROUND MAGNETIC LENSES 
177 
The function ~ may now be written as the quadratic form 
N 
N 
n(z, r) = E 
E Ft,k(z,r)AiAk 
(12.7) 
I--1 k--1 
Introducing (12.5) and (12.7) into (12.3) we obtain a discretization of this 
functional. The minimization condition now takes the form 
oa,O" ii{ 
) 
- 2, 
V'(~)-ff~, - ii(z, r)j(z, r) 
rdrdz = 0 
, 
(i = 1... N) 
S 
(12.8) 
Evaluating this expression and recalling (12.2), we soon notice that it is 
favourable to introduce the matrix elements 
Li,k -- 27r if 
~,(fl)Fi,k(z, r) rdrdz = Lk,i 
(12.9) 
S 
Mi = 2~r iiJ(z, 
r)fi(z, r)rdrdz 
(12.10) 
S 
Equation (12.8) then takes the concise form 
N 
E 
Li,k(fl)Ak = Mi 
, 
i = 1...N 
(12.11) 
k=l 
which represents a non-linear system of equations in the general case, since 
in saturated media u is a function of fl and hence depends implicitly on 
A1 ...AN. 
So far, the discussion has been quite general. The choice of the form 
functions is quite arbitrary, except that these must remain linearly inde- 
pendent so that the matrix L in (12.9) is invertible for fixed values of u. In 
order to perform the necessary numerical integrations in (12.9) and (12.10), 
however, a reasonably simple choice for the form functions is necessary. In 
the simplest choice, equivalent to Munro's version of the FEM, they are 
piecewise linear functions which are joined together continuously at the 
nodes. Even the first-order derivatives are then discontinuous on the grid 
lines, however. With an alteration of the numbering, the form function 
corresponding to an arbitrary internal node 0 is sketched in Fig. 12.2a,b. 
It is nonzero only in the configuration shown, consisting of n - 6 triangles 
with the common node 0, and there it is a pyramid of unit height. It is 
defined in one particular subdomain (i = 1), see Fig. 12.3, by 

178 
12. THE FINITE-ELEMENT METHOD (FEM) 
r 
(5) 
(4) 
f 
(6) 
(3) 
Z 
, 
~ -  
(a) 
Fig. 12.2: (a) Hexagonal configuration ( n = 6) of nearest neighbours of an arbitrary 
internal node 0. (b) Perspective view of the corresponding linear form function; outside 
the hexagonal domain, this function vanishes. 
0 
~ Z 
y 
i 
reilj 
! 
Zci 
Fig. 12.3: Notation for one of the triangular elements of which the hexagonal configu- 
ration of Fig. 12.2 is composed; dj - rj - r0 ( j = i, i + 1) denote the side vectors and 
Ci the centroid. In the text, the area is denoted by ai. 
zlr2 - z2rl + z(rl - r2) + r(z2 - Zl) 
(12.12a) 
fox~(Z, ~) = ~ r~ - z~, 
+ zo(~, - ~) + ~o(Z~ - ~1) 
which assumes the nodal values 
f01=(z0,~0) = 1 
, 
Io~=(z,,~l) = Io~=(z=,~=) = o 
(12.~eb) 
Linear functions of this type are said to be barycentric. 
The remaining calculation is elementary but very lengthy. We have 
to differentiate the linear form functions, substitute these into (12.9) and 
(12.10) and then integrate. In this context some simplifying assumptions 
are necessary, essentially concerning the factors u(fl) and j(z, r). In order to 
facilitate the integration, these factors are assumed to be piecewise linear or 

12.2 FORMULATION FOR SELF-ADJOINT ELLIPTIC EQUATIONS 
179 
even piecewise constant functions. The results of these considerations will 
be given at the end of Section 12.2, since we need the notation introduced 
there. 
12.2 Formulation for self-adjoint elliptic equations 
A variational principle is certainly a very common starting point but is 
not the only possible one. The following method is equivalent to it but 
can be made more general so that it remains applicable in cases where no 
variational principle is known. 
We now regard (z,r) as quasi-cartesian coordinates in a meridional 
plane and consider a self-adjoint elliptic differential equation of the form 
0( 0o  0(0o) 
0---~ 
~z] + Orr P~r 
+ Q(z,r) = 0 
(12.13) 
P - P(z,r) being a positive coefficient function. As in (12.5), we expand 
the potential ~ in terms of form functions: 
N 
• (z, 
= 
v g (z, 
(12.14) 
k=l 
Here M is the total number of nodes; the numbering can always be chosen 
so that i - 1... N refer to internal nodes, while j = N + 1... M refer to 
boundary nodes. In Dirichlet problems, the boundary values ~N+l... ~M 
are kept fixed. 
Substituting this in (12.13), multiplying throughout by 
fi(z, r), i - 1... N, and integrating over the whole domain S of solution, 
we find 
° 
s 
dzdr = 0 
With the necessary continuity conditions, integration by parts now leads 
to 
s 
k 
+/P~kfi(nzfklzTnrfklr) 
ds-O, 
i=l...N 
os 

180 
12. THE FINITE-ELEMENT METHOD (FEM) 
n z, nr denoting the cylindrical components of the outward-directed bound- 
ary normal. The contour integral vanishes, since the form functions refer- 
ring to inner nodes must vanish at the boundary in the case of a Dirichlet 
problem. Introducing the arrays 
Gi,k(z,r) = filzhlz + filrfklr = V fi " V fk 
(12.15a) 
g 
s 
(12.16) 
s 
we obtain the finite-element equations 
N 
~Pi,k~I'k = Qi 
, 
i = 1...N 
(12.17) 
k--1 
which are identical with those obtained by evaluating the corresponding 
variational principle. From the latter, it might be concluded that (12.17) 
with (12.15b) remains valid even when the normal derivatives of the form 
functions are discontinuous at the grid lines, but this is not always true. In 
(12.17) the contributions of the boundary values to the inhomogeneity are 
incorporated on the left-hand side, as the summation covers all the nodes. 
The matrix elements (12.15a) are considerably simpler than (12.6), as 
they are scalar products. Consequently, the results of the discretization 
using linear form functions can be cast into a fairly simple explicit form. 
Assuming that P(z,r) and Q(z,r) are constant and refer to the eentroid 
ci in each triangular element, we find, after some lengthy elementary cal- 
culations, for a configuration of n triangular elements with common node 
0 like that shown in Fig. 12.2: 
71 
~0 ~ Pci(di+l -- di)2/ai 
i=1 
- 
-- 
{d~i+l+~+~ 
i- 
• 
i 
~i+~ 
~'~L._ 
ai 
] 
Z aiQci 
Here the notation of Figs 12.2 and 12.3 has been adopted; it is cyclic in the 
sense that di+n = di, ~i+n = ~i; ai is the area of the element with the 
side vectors di and di+l. 

12.2 FORMULATION FOR SELF-ADJOINT ELLIPTIC EQUATIONS 
181 
This theory can be applied to the field in round magnetic lenses. The 
potential ~ is then to be identified with the flux function 
@ = 27rrA, 
introduced in Section 6.4, and (12.13) must be identified with the flux 
equation arising from (6.33): 
az 
-a-; 
( 2.19) 
The coefficients are hence 
P(z,r) = u(z,r)lr 
, 
Q(z,r) = 27rj(z,r) 
(12.20) 
The differential equation and the corresponding finite-element discretiza- 
tion remain applicable even in the non-linear case; we then have u = u(fl) 
with 
-- 47r2r2 ~I/~z + ~I/ 
-- 471-2r2 E 
E 
fflit~ kGi,k 
(12.21) 
i 
k 
In the vicinity of the optic axis at least, quadratic form functions are nee- 
essary, since we know that ~ o¢ r 2 in the paraxial domain. Recalling that 
must vanish at the outer boundary and at the axis, we perceive that 
all the summations run only over the internal nodes (i = 1... N), as in 
Section 12.1. 
We now state briefly the corresponding formulae for the vector poten- 
tial, which result from the considerations in Section 12.1. Although not 
identical with Munro's formulae, they are equivalent to them. 
Again adopting the notation introduced in Fig. 12.3, we find for the 
value of/3 at the centroid Ci 
1 
flei = ~a~ {di+,(ao - Ai) + di(Ai+l - Ao) + si(ao + Ai + Ai+I)} 2 
with an additional shift 
2ai 
Si = ~rci iz 
Then with t/ci := v(flci ) and jci = j(zci, re/), both referring to the centroid 
ci of the element with label i, we obtain 
n 
n 
Ao Z 
rcivei (di+l -di -I- si) 2 
4 
ai 
-- "3 E. 
rciaiJci 
i=1 
t=l 
n 
-- Z 
reit%i {Ai(di+l - si) - Ai+,(di + s/l}" (di+l - di -{- si) 
ai 
i=1 
(12.22) 

182 
12. THE FINITE-ELEMENT METHOD (FEM) 
Apart from different material coefficients, the essential difference between 
(12.22) and (12.18) lies in the appearance of the shift si which results from 
the term A/r in (12.4). 
Another interesting application of the FEM to magnetic lenses is the 
calculation of magnetic circuits made of anisotropic material. In this case 
the reluctance u(fl) is to be replaced by a symmetric tensor. Its compo- 
nents depend directly on the position v as a consequence of the variable 
crystallographic orientation in the material and indirectly due to saturation 
effects. Such calculations are extremely complicated; nevertheless, mag- 
netic circuits with anisotropic material can be advantageous. Balladore et 
al. (1981, 1984) have shown that the size and weight of the yoke can be 
appreciably reduced in this way. 
12.3 Solution of the finite-element equations 
In the case of linear (unsaturated) media, the matrix elements Li,k in 
(12.11) and Pi,k in (12.17) are constants; the corresponding systems of 
equations are therefore linear and can be solved by means of standard 
techniques. It is usual to employ direct solution techniques, in which case 
it is essential to make use of an ordering that minimizes the bandwidth 
of the corresponding sparse matrix. These techniques cannot be outlined 
here; the reader is referred to the corresponding literature (Cuthill and Mc- 
Kee, 1969; Gibbs et al., 1976; Duff, 1977). A very fast iterative procedure 
using the preconditioned conjugate-gradient method has been developed 
by Lencov~ and Lenc (1986). 
Equation (12.18) has already been cast into a form which is suitable 
for iterative techniques such as SOR and SLOR. These are efficient if the 
coefficients in (12.18), referring to each internal node (0), are computed 
once and for all at the beginning and then stored. In the absence of source 
terms Qci and with n = 6, the total memory requirement is 7N. 
When saturation or other non-linear effects are present, the situation 
becomes more complicated, as (12.11) and (12.17) are now non-linear sys- 
tems of equations: iterative procedures are unavoidable. Direct techniques 
must be combined with Newton's iterative procedure (Munro, 1973). When 
the SOR is employed, a quasi-linearization is necessary; (12.11) and (12.17) 
already have the appropriate form if v(fl) is first treated as a linear coeffi- 
cient during each iteration over the field and then recalculated before the 
next cycle according to (12.2) together with (12.7) or (12.21). 

12.4 IMPROVEMENT OF THE FINITE-ELEMENT METHOD 
183 
! 
Z 
7.- 
Fig. 12.4: Configuration of finite elements and reference points to be used in a third 
order approximation. 
12.4 Improvement 
of the finite-element 
method 
The form of the FEM presented above is only the very simplest version. 
We have chosen it in order to display the basic ideas clearly. The FEM 
can, of course, be improved in many ways. The corresponding theory has 
been developed in so much detail that it is impossible to treat it adequately 
here. It is even impossible to present a complete list of references. We must 
confine our considerations to some essential points. 
The linear form functions given by (12.12) are those of the lowest per- 
missible order. For the azimuthal component of the vector potential A(z, r) 
such a choice is reasonable, since in the most important, paraxial domain 
the function A(z, r) is proportional to r. There are also presentations of 
the FEM in which a linear approximation is made for scalar potentials 
(Munro, 1973) and flux functions (Bonjour, 1980). This is clearly a locally 
very inaccurate approximation, which has been criticized by Kasper and 
Lenz (1980), who showed that the FEM is then less accurate than the FDM, 
at least in the paraxial domain. This weakness can be avoided by using 
higher order approximations for the potential. The corresponding theory 
has been presented by Silvester and Konrad (1973). It is then necessary 
to introduce additional points of reference along the mesh lines of the grid 
and also in the interior of the elements (see Fig. 12.4). The values of the 
potentials at these additional points are unknown. The rank of the system 
of FE equations and, of course, the complexity of its structure increase 
accordingly but a gain in accuracy may be achieved. 
A second important aspect is the appropriate choice of the grid. In 
practice it is too tedious to let the user of a program choose every node 
individually. Suitable algorithms for the automatic generation of the grid 
have been proposed by Winslow (1967) and Munro (1973). Whether these 
algorithms work efficiently or not depends essentially on the shape of the 

184 
12. THE FINITE-ELEMENT METHOD (FEM) 
boundary in question. More recently, Hermeline (1982) has proposed a 
new method which works well but is highly sophisticated. The user of a 
commercial FE program is usually supplied with a method for generating 
the grid, even a curved grid, but setting up one's own program will be 
generally very laborious. 
A third aspect of the FEM--and indeed of the FDM--is the need to 
confine the spatial extension of the grid. Very often the fringe fields of 
a particular configuration spread out over a much larger region than can 
be covered by the grid. In order to keep the error introduced by cutting 
off the field at the boundary of the grid sufficiently small, the size of the 
grid must often be very large. This drawback of the FEM can be removed 
by the introduction of additional infinite elements. The trial functions 
for the potential, to be evaluated in such elements, must be consistent 
with the asymptotic form of the real potential. Such infinite elements have 
been proposed by Bettess (1977) and their use in electron optics has been 
investigated by Lencov£ and Lenc (1982, 1984). 
The most serious drawback of the FEM becomes apparent when we 
come to compute the field strength. This problem will be discussed in 
Chapter 13. 
12.5 Comparison and combination of different methods 
In the previous sections, we have dealt with three major methods of cal- 
culating potentials, the BEM, the FDM and the FEM. The question that 
now arises is which one should be preferred in a given case. The answer 
depends on the details of the particular problem to be solved. 
In all cases in which a one-dimensional linear integral equation can be 
derived, the BEM is the most advantageous means of obtaining a solution. 
The necessary discretization can be easily fitted to arbitrary boundaries, 
regardless of whether these are curved or piecewise straight with sharp 
edges. Even extreme differences in the dimensions of boundaries, as in 
field-emission electron guns, for example, are no obstacle to this method. 
There is no need to cut off fringe-fields, as theoretically the domain of 
solution is the whole space. With a comparatively modest memory ca- 
pacity, high accuracy can be achieved. The linear system of equations to 
be solved is well-conditioned and can hence be solved directly by means 
of a simple Gaussian elimination without any pivoting. After determining 
the appropriate surface-source distributions, the analytic expressions for 
the field strength can be evaluated at any point of reference. In principle, 
there is no need for additional interpolation and numerical differentiation 
techniques, though these may be helpful in some cases. 

12.5 COMPARISON AND COMBINATION OF DIFFERENT METHODS 185 
The same conclusions hold when the two-dimensional BEM is applied 
to three-dimensional boundary-value problems (Section 10.4). Of course, 
this method is then more complicated than the one-dimensional B EM, but 
this is an inevitable consequence of the greater complexity of the problem 
to be solved; alternative methods such as the FDM and the FEM will also 
become more complicated. 
The FDM is suitable only when a regular grid fits the boundary, since 
the inclusion of irregularities, though quite elementary, is very tedious. 
Since highly regular domains of solution are very rare, the FDM is not 
advantageous, in electron optics at least, unless the improvement outlined 
in Sections 11.4.2 and 11.4.3 is incorporated. 
The FEM is theoretically applicable to any kind of boundary-value 
problem, even in three dimensions. This method may be very effective if a 
completely worked-out and tested program package is available but if this 
is not the case, we should prefer the BEM, since the latter can be easily 
programmed by a single scientist, at least in the one-dimensional version. 
Only when saturation effects become important in ferromagnetic materials 
does the FEM seem to be really necessary. Moreover, after the potentials 
have been determined at the nodes, the serious problem of calculating the 
field strength will arise. 
Taking into account all the points discussed above, we come to the 
conclusion that in most cases the BEM is very advantageous and it is for 
this reason that we have dealt extensively with this method. 
There have been several investigations on combinations of the differ- 
ent methods of field calculation, and one has already been outlined in Sec- 
tion 11.4.3. In electron optics this possibility has been found valuable for 
field computation in field-emission electron guns (see Part IX). More gen- 
erally, the combination of different methods for the solution of Dirichlet 
problems in electrostatics has been investigated by Schaefer (1982, 1983), 
who has proved quite generally that iterative solutions of Dirichlet problems 
in two and more overlapping domains converge. He has developed a suit- 
able technique for the solution of such problems, which he calls Schwarz's 
alternating method. 
Though this method can be very powerful, we can- 
not describe it here for reasons of space. Unfortunately, this method does 
not work for problems with interface conditions or for non-linear problems, 
where a suitable coupling of different methods is particularly interesting. 
In these cases a combination of the FEM with the BEM is possible, as 
has been proposed by McDonald and Wexler (1972) and McDonald et al. 
(1973) and by Lencovd and Lenc (1982, 1984). A similar method has been 
proposed by Kasper (1984a,b); we now outline this briefly. 
A typical example of the application of a hybrid method is presented 
in Fig. 12.5, which shows a half-axial section through an open magnetic 

186 
12. THE FINITE-ELEMENT METHOD (FEM) 
I~IULV~=LXN~IE 
120.0 
1110.0 
100.0 
90.0 
00.0 
?0.0 
60.0 
50.0 
40.0 
30.0 
20.0 
10.0 
1 
' 
I 
' 
I 
' 
I 
' 
I 
' 
I 
' 
I 
' 
-60.0 
-50.0 
-40.0 
-30.0 
-~0.0 
-110.0 
0.0 
Fig. 12.5a: Upper half of a meridional section through an open, round, magnetic lens 
with a ferromagnetic core and a rectangular distribution of windings. Only the interior of 
the yoke is discretized by a triangular-mesh grid. 

12.5 COMPARISON AND COMBINATION OF DIFFERENT METHODS 
187 
B/T 
0.5- 
0.4- 
0.3- 
0.2- 
o.1- 
0 
, 
, 
, 
T 
, 
, 
, 
, 
-50 
18000A 
_, 
o 
z/mm 
I 
100 
R/mm 
-50 
Fig. 12.5b: Axial field strength for an excitation of 18000 A-turns. 
lens. Owing to this open structure the magnetic fringe-field extends so far 
that it becomes very impractical to apply the FEM in the vacuum domain 
V. On the other hand, the saturation effects in the polepieces make the 
application of Scherle's method impossible. We hence apply the FEM only 
to the polepieces and use the BEM in the outer domain. 
The finite-element equations can be solved if the boundary values of 
A(z,r) at the surface contour C are known. Then by means of suitable 
interpolation techniques the normal derivative (OA/On)i on the inner side 
can be determined. When this has been done, we also know the normal 
derivative (OA/On)v on the vacuum side from 
1(0 ) 
= 
# i 
-~n 
i 
#o 
--~n , 
fl " = r A 
(12.23) 
We can now solve the integral equation 
(12.24) 
#o I Gl(U,u')j(u')r'dr'dz' 
+ 
v 
in which we have written u = (z,r), u' = (z',r') and G1 is defined by 
(9.21) with m = 1. 
When the whole system of coupled equations has been solved itera- 
tively, we have the appropriate solution in the partly saturated iron to- 
gether with an unbounded and smooth vacuum field. Thus the drawbacks 
of using each of the individual methods separately have been circumvented. 

13 
Field-lnterpolation Techniques 
The finite-difference and the finite-element methods yield the values of a 
potential at the nodes of a discrete grid. This is only the first step in a full 
field calculation, since the computation of electron trajectories requires a 
knowledge of the field strength at arbitrary points in the field. This implies 
that suitable techniques for interpolation and numerical differentiation will 
be required. 
The application of predictor-corrector methods to the computation of 
trajectories requires that the field strength be a smooth function, especially 
on the grid lines separating two adjacent meshes. With respect to the FDM, 
this problem has been solved satisfactorily. The irregular grid employed 
in the FEM, however, makes accurate computation of the field strength 
practically impossible. As far as we know, a very accurate tracing of Lorentz 
trajectories through an irregular grid has never been reported. In practice, 
the use of the FEM limits us to interpolations and differentiations along 
the optic axis. 
In this respect, the boundary-element method is clearly superior, since 
the field strength can be computed as a continous superposition of analytic 
functions once the surface-source distributions have been determined. Nev- 
ertheless, in order to save computation time, interpolation techniques may 
still be valuable since the BEM is slow. 
13.1 One-dimensional differentiation and interpolation 
Numerical differentiation and interpolation in one dimension are the basis 
for all the corresponding procedures in two and three dimensions. Moreover 
they are of immediate importance in electron optics, since a knowledge of 
the axial potential and of its derivatives is sufficient for the determination 
of most electron optical properties. 
We consider here an arbitrary analytical function Y(z), which may be 
an axial potential, an axial deflection field strength or any other function 
of interest. Let us assume now that only the discrete values 
Yi :--Y(zi) 
, 
i--O...N 
, 
(zi ~> zi-1) 
(13.1) 

13.1 ONE-DIMENSIONAL DIFFERENTIATION AND INTERPOLATION 
189 
are known. They may, for instance, result from a field calculation program 
using the FDM or the FEM. We now wish to calculate Y(z) and some of 
its derivatives for arbitrary values of z with zo <_ z <_ zu. 
This is a standard problem in numerical analysis and a wide variety 
of methods has been devised to solve it but not all of these are suitable. 
If problems are not to arise in ray-tracing programs (see Chapter 33), all 
the required derivatives of Y(z) must be continuous at zo... ZN. Most of 
the familiar interpolation techniques do not satisfy this requirement, and 
the best technique proves to be Hermite interpolation, which will now be 
outlined. 
13.1.1 Hermite interpolation 
We assume for the moment that the derivatives Y~ and Y" at zo... ZN are 
known; their determination will be discussed further below. We can then 
apply cubic or quintic Hermite interpolation. In each interval zi-1 <_ z <_ 
zi(i = 1... N), cubic interpolation consists in the procedure 
hi'--- 
z i - 
zi_ 1 
, 
t "-- (2z - z i - 
zi_ 1)/h i 
, 
ItJ _< 1 
1 (2 T 3t 4- t 3 
1 
t2 
fl,2(t) -- ~ 
) 
, 
gl,2(t) = ~(t 3 T 
-- t 4- 1) 
Y(z) 
- 
Y/-afl(t) + ]~f2(t) + hi{Yi~__lgl(t) 
+ Y/'g2(t)} 
(13.3) 
(13.4) 
while quintic interpolation is given by (13.2) in combination with 
1 
t 
F1,2(t) = ~(1 zF t)T ]-~(7- 10t 2 + 3t 4) 
ai, (t) = 
lOt + 3t 
± 
(5 -6t 
+ t 
1 
t2) 2 
t) 
Y(z) 
- Y/-1FI(t) -~- Y/F2(t)+ 
hi{Yi~__lGl(t) 
-~- Y/'G2(t)} 
+ h~{Yi~lHa(t)+ Y/"H2(t)} 
(13.5) 
(13.6) 
The form functions fl,2(t), gl,2(t) or F1,2(t), Ga,2(t), H1,2(t), respectively, 
are defined in such a way that Y(z) and certain of its derivatives assume the 
prescribed values at zi and zi-a. Since each internal endpoint zi is common 
to the intervals [Zi-l,Zi] and [zi,zi+l], Y(z) and Y'(z) are continuous in 
the cubic Hermite procedure, while the quintic procedure also ensures the 
continuity of Y"(z). 
13.1.2 Cubic splines 
The formulae given above require that the derivatives at zo ... 
Z N have been 

190 
13. FIELD-INTERPOLATION TECHNIQUES 
calculated and stored prior to the actual interpolation. We now discuss the 
determination of these derivatives. In connection with (13.3) and (13.4), 
the cubic spline technique is very convenient and is in widespread use. Cu- 
bic spline functions are Hermite interpolation functions (13.4) that remain 
continuous after two differentiations. This requirement imposes conditions 
on Y~... Y~, which can be cast into the form of a tridiagonal system of 
equations. With the abbreviation ki = h:, 1, this is given by 
kiY.: ,-1 + 2(ki + ki+l)~' + ki+lY~+l 
= 3k,2" (Yi - 
Y/-1) -~- 3ki2+l(Yi+l 
- 
Yi) 
(13.7) 
i=1...N-1 
The terminal values Yd and Y~ can be chosen independently, provided 
that they are not determined uniquely by such constraints as symmetries 
or periodicity. If there is apparently no reasonable way of determining Y0' 
and Y~, the linear equations 
kl 
(D1 + D2) 
kl Yd + (k2 + ki)Y~ = 2D~ + k~ + k2 
(13.s) 
(3kN-1 -- kN)Y~_I + kNY~v = 2DN + kN + kN-i (DN + DN+I) 
Dr:=(r~-Y~-~)k 2 
, 
v=I,2;N-1,N 
can be combined with (13.7); these equations are obtained if Y"'(z) is 
assumed to be continuous at z = Zl and z = zg-1, respectively. The 
complete tridiagonal system of equations can be solved directly by means 
of the Gauss algorithm without pivoting. A generalization to quintic spline 
functions is possible but very delicate and we do not recommend this. 
In cubic splines, the second derivative is only a piecewise linear func- 
tion and hence not very accurate; one should thus not use cubic splines if 
Y"(z) is needed explicitly. In order to obtain high accuracy in such cases, 
an improved differentiation technique is necessary and quintic Hermite in- 
terpolation should then be used. 
13.1.3 Differentiation using difference schemes 
Among the many ways of performing numerical differentiations, the tech- 
nique outlined below has proved very effective. The explicit use of the 
unequal spacing of the abscissae zo... Z N makes the formulae cumbersome 
and should be avoided. This can be achieved in the following way. 
We choose a parametric representation of the function in question, the 
parameter being denoted by x: 
z = z(x) 
, 
Y = Y(x) 
(13.9a) 
x=ih 
, 
zi=z(ih) 
, 
Y~=Y(ih) 
, 
i=0,1,...N 
(13.9b) 

13.1 ONE-DIMENSIONAL DIFFERENTIATION AND INTERPOLATION 
191 
Without loss of generality we can choose h = 1, as we do below. Since the 
two functions z(x) and Y(x) are to be treated in the same manner, it is 
sufficient to deal only with the differentiation of Y(x); the corresponding 
derivatives will be denoted by dots. 
We now introduce finite differences 
AYi = Yi4-1 -- Yi 
~2y = y~+l _ 2Y~ + Y~_I = AY~ - AY~_~ 
~2n+2y~ = ~2n]/]+ 1 __ 2~2ny~ A- 62nyi-1 
, 
n > 1 
(13.10a) 
(13.10b) 
(13.10c) 
Derivatives with respect to x are then given by 
1 
1 6 
zul~ot)SYJ 
Sj'= 
~Yj- l~2Y/+ 
6~6~4Ie) - 2--ggt~ Y/+I 
- "'" 
Y/ -- 
Si+l 
-- Si--1 
Y/: ,2Y/ - I~,'Y/-~- 9~,6Y/ - 1--~--,8Y/-~- 31~,1° Y / - 
560 
"'" 
(13. 1) 
If the highest order is chosen reasonably, these formulae give accurate re- 
suits, since they are highly symmetric. In the vicinity of the margins they 
are not directly applicable. In order to avoid special asymmetric formulae, 
it is preferable to extrapolate the function Y(x) a certain distance beyond 
the interval in which the derivatives are actually needed. This can be done 
with the aid of symmetries, of periodicities or of well-known asymptotic 
properties. If none of these is applicable, a polynomial extrapolation can 
be made. For a polynomial of degree n, this extrapolation takes the simple 
form 
£ 
(~+~) 
(13.12) 
- 
+ 
-k 
k--0 
Analogous formulae with correspondingly lower degree hold for the differ- 
ences AY)+ 1 and ~5 2"* 1~+ 1. 
Sometimes the first-order increments AY1... AYk are given directly, 
for instance in the procedure outlined in Section 10.2.3. It is then possible 
to set up the differentiation procedure directly in terms of these increments. 
This provides additional numerical stability, as the subtraction of large Y- 
values is avoided. The corresponding elementary manipulations are not 
given here. 
Finally the required derivatives with respect to the coordinate z are 
given by 
Y,'= 
, 
Y," = 
, 
(i = o... N) 
(13.13) 

192 
13. FIELD-INTERPOLATION TECHNIQUES 
Derivatives of higher orders can be computed easily by applying this pro- 
cedure to these sets of derivatives instead of to the function itself. If the 
abscissae Zo... ZN are equidistant, the differentiations of z(x) can be omit- 
ted since we have simply 
Z,i = Zi+l --Zi ---- h = const 
, 
zi --0 
The procedure is thus very economic. 
For the interpolation of derivatives y(n), the following procedure is 
efficient: (13.2), (13.5) and (13.6) are completed by 
Y(n)(z) - Y/(~F1 (t)+ Y/(n)F2(t) 
~- hi(Yi(l+l)Gi(t) T Yi(n+i)G2(t) } 
(13.14) 
+ h2{Yi(~+2)Hi(t) T yi(n+2)H2(t)} 
, n > l 
This has the advantage that only the form functions themselves need to 
be computed and not their derivatives, so that computation time is saved. 
Furthermore, even the derivatives of higher orders remain twice continu- 
ously differentiable, and hence are very smooth. A very high accuracy can 
be achieved. 
13.1.4 Evaluation of radial series expansions 
In Chapter 7 we have derived a variety of radial series expansions, which are 
of particular interest in electron optics. These are all determined uniquely 
by certain axial functions, the axial harmonics. With the technique outlined 
above, their higher order derivatives can be computed numerically for a 
sequence of abscissae zo... ZN and then stored. Using the interpolation 
formula (13.14), it is now easy to evaluate the radial series expansions for 
the potential, the field strengths and even for derivatives of second order 
at any point (z, r) of reference within the domain of convergence. This is 
straightforward and is undoubtedly the fastest method of field computation. 
The analytical character of the solution obtained with the BEM allows 
analytical differentiation of the axial potential, which is clearly preferable if 
the corresponding procedure remains reasonably simple. For the functions 
involved in the calculation of rotationally symmetric fields, this is certainly 
the case. 
For a single charged ring, specified by its position (z ~, r') and the nor- 
malized charge 2r, the axial potential, here denoted by 7, can be easily 
calculated from (10.6): 
- z', ,") = ao(Z, 0; z'r') = (2n) 
(13.15a) 

13.2 TWO-DIMENSIONAL INTERPOLATION 
193 
Go 
Q'(z ~ #) 
J 
r' 
~ 
q(z,r) 
I_. 
IX 
R 
: z-z 
/ 
- 
"J 
Fig. 13.1" Notation used in the extended paraxial series expansion. Q is an arbitrary 
reference point and Q' is the trace of a ring in this meridional section. 
with 
R = x/(z - z') 2 + r '2 
(13.15b) 
These geometric quantities are sketched in Fig. 13.1. The derivatives of 7 
with respect to z can be brought into a very convenient form: 
(-1)nn!P"(#) 
(n > 0) 
(13.16a) 
7(")(z- z', r') = 
2R,+ 1 
P,(#) being Legendre polynomials with argument 
t' - 
(z- 
z')/R 
= ~os 
(13.16b) 
where the angle v9 is shown in Fig. 13.1. These formulae can be evaluated 
efficiently. 
The order in which the differentiation with respect to z and the inte- 
gration over the boundary C are performed in the integral equation can be 
exchanged. Once the source distribution a(s) is known, the axial potential 
¢(z) and its derivatives can hence be calculated from 
¢("~(z/) = J 4") (z, - z(,), ~(,)) o(,)~(,) d, 
c 
(i=0,1,2...N 
, 
n>_0) 
(13.17) 
After these values have been computed and stored, (13.14) can be employed 
for the calculation of ¢(")(z) for arbitrary z, after which the evaluation of 
the radial series expansions is straightforward. 
This concept can be generalized to include the superposition of aper- 
ture fields (Section 10.3) and of various multipole fields, but this will not 
be dealt with here. 

194 
13. FIELD-INTERPOLATION TECHNIQUES 
13.2 Two-dimensional interpolation 
Here we consider two-dimensional functions P(u, v), known at the nodes of 
a rectangular grid. The coordinates u and v will usually be the cylindri- 
cal coordinates z and r in a meridional section through an axisymmetric 
system, though this special meaning is not absolutely necessary. We now 
describe algorithms for calculating P(u, v) and its partial derivatives at an 
arbitrary point Q with coordinates (u, v). 
This problem is of importance for the computation of equipotentials 
and Lorentz trajectories at large off-axis distances. The accurate tracing 
of a Lorentz trajectory through an electron optical system may require as 
many as 2000 calls of the field program, this number rapidly increasing 
with worsening smoothness of the field strength at the grid lines. When 
the analytic fields supplied by the boundary-element method are used, this 
problem does not arise, but each single call of the field program may then 
take so much time that it is preferable to store the values of the potential 
and the components of the field strength at the nodes of a suitably cho- 
sen square-shaped grid. The frequent evaluations at arbitrary points can 
subsequently be performed very fast by means of interpolation. This is par- 
ticularly important when several Lorentz trajectories are to be computed, 
for instance in electron guns. 
This interpolation problem has been solved in many different ways. 
In electron optics, different proposals have been made by Weber (1967), 
Lenz (1973), Kern (1978) and Kasper (1982). Two- and three-dimensional 
Hermite interpolation has been used, for instance by Eupper (1985). In 
the subsequent presentation we shall first examine simple two-dimensional 
Hermite interpolation, after which we consider possible improvements. 
13.2.1 Hermite interpolation 
Our object is to calculate a function P(u, v) at some point Q, located 
arbitrarily in the grid, as shown in Fig. 13.2. It is convenient to denote the 
partial derivatives by 
OP 
OP 
U:=Pit, =- Ou 
' 
Y := Pl~ = Ov 
(13.18) 
We assume that the nodal values of P, U and V have been computed prior 
to the interpolation stage and stored in two-dimensional arrays having two 
subscripts. The array elements Pi,k, Ui,t: and V~,k refer to the node with 
coordinates (ui, vk ). 
With this information, bivariate cubic Hermite interpolation, which 
is based on the form factors (13.3), can be applied. 
The interpolation 

13.2 TWO-DIMENSIONAL INTERPOLATION 
195 
Vk 
%1 
1,2) 
," 
(2,2) 
.- 
~.~ ..... 
h v 
a 
j 
bl 
I 
1(1,1) 
, 
(2,1) 
(i-l,k-1) 
(i 
u 
hu 
. 
,k-l) 
F" 
"q 
u/. 1 
u~ 
u 
Fig. 13.2" Values of the subscripts used in two-dimensional interpolation. Outside the 
rectangle, the subscripts 
J and L are those of the potential; inside the rectangle, the 
subscripts 
j and 
I are those of the coefficients. The lengths 
a and 
b are given by 
a = hu(1 + s)/2 and b = h,,(1 + t)/2. 
formulae can be written explicitly in terms of these functions" 
P(u,v) - ~ ~-~{fj(s)ft(t)Pj, L 
j=l l=l 
+ h=gj(s)fl(t)Uj, L + hvfj(s)gl(t)Vj, L } 
with the auxiliary quantities 
hu = 
u/- 
ui_ 1 
hv = vk - 
Yk-1 
J=i+j-2 
s = (2u 
- 
ui- ui-1)/hu 
t=(2v--vk--Vk-1)/hv 
L=k+l-2 
(13.19a) 
(13.19b) 
The values of U and V at the point Q are obtained by the appropriate 
differentiations; the corresponding elementary expressions will not be given 
here. The derivatives U and V are still continuously differentiable on the 
grid lines if the arrays [Ui,k], [V~,k] are calculated by applying the cubic 
spline technique to the potentials in the corresponding rows and columns 
of the grid. This method can easily be generalized to three-dimensional 
problems. 
13.2.2 The use of derivatives of higher order 
As in the one-dimensional case, the accuracy and smoothness can be im- 
proved by the use of derivatives of higher orders at the nodes of the grid. 
Such a proposal has been made by Kasper (1982) but this requires a par- 
ticular partial differential equation to be satisfied, which is not always the 
case. Here we treat the most general case. 

196 
13. FIELD-INTERPOLATION TECHNIQUES 
3 
• 
~2 
:0 
"8 
Z 
Fig. 13.3: Simplified provisional numbering of the nodes in nine-point formulae for 
higher derivatives at the central node. 
The necessary procedure is reasonably simple only if the grid is square- 
shaped: ui = ih, vk = kh with i and k integers. We assume again that 
the arrays [Pi,k], [Ui,k] and [V~,k] are known beforehand. 
Owing to the 
higher accuracy required, the cubic spline technique is inadequate and a 
more accurate differentiation technique must be employed. 
It is now of great importance that the derivatives of higher orders can 
be calculated in the form of local finite differences, so that there is no need 
to store them all. For conciseness, we temporarily introduce the notation 
presented in Fig. 13.3. The appropriate Taylor series expansions about the 
central node 0 yield the formulae 
Pl-- = 2(P~ - 2P0 + Ps)/h 2 - 0.5(U~ - Us)/h 
PI~ = 2(/93 - 2P0 + PT)/h 2 - 0.5(V3 - VT)/h 
Pl-~ = -0.25(P2 -/94 +/96 - Ps)/h 2 
(13.20) 
+ 0.5(V~ - V5 + U3 - VT)/h 
These derivatives refer to the central node, and their remainder is of fourth 
order in the mesh-length. 
This method can be extended to the determination of derivatives of still 
higher orders. Even some of the derivatives of fifth order can be calculated 
in this way, but the finite differences involved then become quite numerous. 
For reasons of space we must confine this account to the simplest non-trivial 
case, which is sufficient in very many practical applications. The mixed 
derivatives of third order are given by fairly simple expressions: 
PI--~ = 0.25(U2 - U, + U6 - Us)/h 2 + O(h 2) 
(13.21) 
Pl.~v = 0.25(V2 - V, + V6 - Vs)/h 2 + O(h 2) 
On an axis of symmetry, typically the optic axis (v = 0), some of the 
neighbours of the node 0 are missing. We can either extend the arrays 

13.2 TWO-DIMENSIONAL INTERPOLATION 
197 
beyond this axis and fill them up according to the symmetry or make 
explicit use of the symmetry. In the case of positive symmetry, P(u,-v) - 
P(u, v), the finite differences for an axial point (v0 = 0) take the simple 
form 
= 
4(P 
 - po)/h - y 
/h 
PI-o = Plu~ = 0 
(13.22) 
PI~ = 0.5(V2 - V4)/h "2 
while Pl~u remains unaltered. 
All these finite differences are simple enough to be recalculated in every 
new call of the field-calculation program. We have to identify the central 
node 0 of Fig. 13.3 with each of the four corners in Fig. 13.2 in turn and 
then calculate the corresponding derivatives. This results in a 16-point 
configuration and the evaluation of 20 simple finite differences. 
The necessary interpolations are written most concisely in the form 
X(u,v) = ~ ~{fj(s)gt(t)Xj, L + hgj(s)ft(t)Xz, nl, 
j=l 1=1 
+ 
+ 
(J=i+j-2 
, L=k+l-2) 
(13.23) 
where the symbol X denotes P, U or V, respectively, and the subscripts 
J and L refer to the four corners of the mesh cell in question. Only the 
arrays for the potential and the first-order derivatives are stored; the rest 
are recalculated, but the time spent on the latter is compensated for by 
the saving in the computation of differentiated form functions. Equation 
(13.23) implies that the same procedure is to be carried out three times, but 
with different coefficients. The design of this interpolation scheme is such 
that the field strengths--that is, the derivatives U and V--are continuously 
differentiable. Even the second-order derivatives, needed in a procedure to 
be outlined in Chapter 34, are fairly smooth. 
In practice, many operations can be saved if the calculations are per- 
formed with a mesh-length h = 1, to which all stored derivatives and 
calculated finite differences must refer. 
Each computed result is finally 
multiplied only once by the appropriate power of the actual mesh-length. 
We have not presented this version here for pedagogic reasons but we rec- 
ommend it for any real program. Moreover, some computation time can 
be saved by calculating the finite differences referring to the four corners 
of the same mesh cell only once even though these quantities are needed 
several times. This situation can arise if several subsequent points Q of 

198 
13. FIELD-INTERPOLATION TECHNIQUES 
reference in a very accurate ray-tracing program axe located in the same 
cell. Such points can easily be identified by comparing the subscripts (i, k) 
with those of the previous call and by skipping the corresponding parts of 
the procedure when they are the same. 
In conclusion, the field interpolation can be made sufficiently accurate 
and fast for ~he purposes of ray tracing. A still more accurate but also 
more sophisticated method of interpolation has been worked out by KiUes 
(1985), to which we refer for the details. 

Part III 
The Paraxial Approximation 

This Page Intentionally Left Blank

14 
Introduction 
The general form of the trajectory equations in electromagnetic fields has 
been derived in Part I (3.22) but in many practical situations these equa- 
tions are unnecessarily complicated. In a very large class of electron optical 
instruments, the electrons remain in the vicinity of a curve, frequently a 
straight line, which we call the optic axis. The behaviour of the various 
optical elements can then be characterized by simpler equations, obtained 
by expanding the fields and potentials about this axis and retaining only 
the terms of lowest order. We shall see that these equations are usually 
second-order, linear, homogeneous differential equations and their solutions 
describe the linear imaging properties of lenses of various kinds. With a 
little care, mirrors can also be included and some aspects of electron guns 
and cathode lenses can even be characterized in this way. 
We shall give two derivations of the paraxial equations for systems with 
an axis of rotational symmetry, since these are of such importance. First, 
we simply insert the series expansions for the components of the magnetic 
flux B and the electrostatic potential ~ into the general equations (3.22) 
and neglect all but the terms of lowest order. In the alternative derivation, 
we expand the characteristic function M (4.25) as a power series in the 
off-axis coordinates and their derivatives; the Euler equations (4.26) of 
the variational relation (4.33) then yield the paraxial trajectory equation 
if we retain only quadratic terms in the expansion. For systems of lower 
symmetry, we employ only one of these methods, usually the latter. The 
function M will almost invariably be scaled with respect to (2m0e)½, as in 
(15.23). The momentum then scales to q~½ and we shall often refer to this 
quantity as the momentum, with components q~ ½ x' and q~½ y', though it of 
course does not have the proper dimensions. 
The presence of a magnetic field leads us to introduce a new coordi- 
hate system, twisted about the z-axis with respect to the cartesian system 
in terms of which the field expansions are given in Part II. In this Part 
therefore, we denote the 'fixed' cartesian system by (X, Y, z), reserving the 
lower-case (x, y, z) for the twisted or 'rotating' coordinate system, in terms 
of which all later calculations will be performed. Only static fields will be 
considered here. Dynamic fields are more conveniently treated separately. 

15 
Systems with an Axis 
of Rotational Symmetry 
Round lenses are by far the most common in electron optical instruments 
and we now examine their paraxial properties in detail. A typical electro- 
static lens consists of two, three or more electrodes, in the form of plates in 
which round holes have been cut, their centres lying on a common axis (Fig. 
15.1a), or of cylinders, again with the same axis (Fig. 15.1b). Although in 
theory the field extends indefinitely, in practice it rapidly becomes negligi- 
bly small and we speak of the field region and the field-free space outside 
it. Electrostatic lenses may have an overall accelerating or retarding effect, 
in which case the constant potential in front of the lens is not the same 
as that behind it (Fig. 15.1c); they are then often known as immersion 
lenses even though a real object is rarely immersed in the electrode field. 
An exception is the cathode lens, which is terminated by an unperforated 
electrode, the properties of which are to be studied. If the lens has no over- 
all accelerating effect, in practice it very often has three electrodes (Fig. 
15.1d) and is then known as an einzel lens or unipo~en~ial lens. We reserve 
the term einzel lens for a three-electrode design such as that illustrated in 
Fig. 15.1d. A special case of the electrostatic lens is the electron gun 
(Fig. 15.1e), in which electrons are generated by a filament or cathode, 
in the form of a point or hairpin, and rapidly accelerated to the operating 
voltage of the instrument in which they are employed. Guns need special 
treatment, however, and are discussed in detail in Part IX. 
Round magnetic lenses are devices that generate a rotationally sym- 
metric magnetic field, effectively confined to a narrow region. The tradi- 
tional design, which has changed little since its introduction by Ruska in 
the early 1930s (Knoll and Ruska, 1932a,bi Ruska, 1934a,b), consists of a 
large number of windings enclosed in an iron casing; a slot in the latter, fin- 
ished with circular polepieces, concentrates the field as shown schematically 
in Fig. 15.2a. In some designs, the windings are in the superconducting 
state and carry persistent currents. In others, the entire lens is in the 
superconducting state and the field is confined by a diamagnetic shield 
(Fig. 15.2b). More radical departures from this geometry are employed for 
special purposes; two extreme shapes are illustrated in Figs 15.2c and d. 
All these types of magnetic lens rely on current-carrying conductors to 
provide the magnetomotive force. Permanent magnets may be used instead, 

203 
0 
_ 
_
_
~
 
I 
;; T 
v~ 
½ 
vj 
¼,v~ 
I 
I 
~ehne/t anode 
e 
Fig. 15.1" Forms of electrostatic lenses. (a) Plates with circular openings. (b) Cylinders 
along a common axis. (c) Lens with an overall accelerating (V4 < V1) or retarding ( 
V4 > 1/1) effect. (d) Einzel or unipotential lens. (e) Gun nomenclature. 

204 
15. SYSTEMS WITH AN AXIS OF ROTATIONAL SYMMETRY 
windin9s 
~ke 
oolepiece 
optic axls 
-- coil 
superconducting 
shield 
optic axis 
/" 
/ 
axis 
/i 
\\ 
optic 

205 
~A 
SECTION BB 
~B 
polepiece 
anisotropic 
circuit 
A~ 
super 
polepiece 
SEC TION A A 
| 
i 
i 
• 
,, 
• 
5cm 

206 
15. SYSTEMS WITH AN AXIS OF ROTATIONAL SYMMETRY 
,5 
At 
Fig. 
15.2: 
Forms of magnetic lenses. (a) Conventional lens. (b) Superconducting 
shielding lens. (c) Single-pole lens (with bore). (d) Laminated lens. (e)-(f) Permanent- 
magnet lenses. 

15.1 DERIVATION OF THE PARAXIAL RAY EQUATION 
207 
and have been incorporated into commercial electron microscopes, but their 
inflexibility is a severe handicap. 
Figures 15.2e and f show permanent- 
magnet lenses and the axial fields within them. 
Real objects are regularly immersed deeply within the field of magnetic 
lenses, unlike electrostatic lenses. When discussing their properties, we 
need distinguish only two types of lens, those in which a real object or 
image is situated within the field and those in which the lens transfers an 
intermediate image from one plane to another. Nevertheless it is usual to 
describe lenses in terms of the role they play. Thus we speak of condenser 
lenses if the 'intermediate image' being transferred is the image of the 
source of a microscope but of intermediates or projectors if a genuine image 
is in 
question. Geometrically, these might be very similar. Likewise, the 
same lens may be an objective, if the specimen is immersed in it, or a 
probe-forming lens, if it forms a fine probe within (or indeed outside) the 
field. These distinctions will become more clear in Part VII. 
15.1 Derivation of the paraxial ray equations 
from the general ray equations 
We now derive the paraxial trajectory equations for electrostatic and mag- 
netic lenses. Into the general trajectory equations (3.22), we substitute the 
expansions for ¢(X, Y, z) and B(X, Y, z) given in Part II. We now set ¢0 
equal to zero, thereby disregarding chromatic effects. From (7.14), we find 
O~ 
1 
1 
,, 
OX ~ - 2(1 + 2e¢)X¢"= -~'7X¢ 
O---~ "~ (1 ÷ 2e¢)¢' = 7¢' 
wh~r~ ~s usual 7 = m/m0 = (~ - ~/~)-1/~ 
= 1 + 2~V (2.2, 2.2~). Ne- 
glecting quadratic and higher order terms in X, Y and their derivatives, 
the electrostatic terms on the right-hand side of (3.22a) become 
2~ 
b-2 
~ 
~ - 
(2x'¢' + x¢") 
(~5.2) 
with a similar expression for (3.22b). 
For the magnetic term, we substitute the appropriate expansions (7.18- 
19); noting that Bt can be replaced by Bz since we are neglecting quadratic 
terms, we find 
~?~ (eBy - Y'Bt) ,.m - 
~ (YB' + 2Y'B) 
(15.3a) 

208 
15. SYSTEMS WITH AN AXIS OF ROTATIONAL SYMMETRY 
and 
": 
' 
" (xB' + 2x'B) 
(15.3b) 
The pair of trajectory equations (3.22) thus collapse to the following in the 
paraxia/approximation: 
7¢' X' 
74" 
r/B y, 
X" + ,~- 
+ 4--~ X + ~ 
+ 
7¢" 
qB X' 
y,, + 74__~' 
y, + ---~ y_ 
24 
4¢ 
~TB' Y=O 
'IB' X=0 
(15.4) 
This pair of coupled linear differential equations can be cast into a simpler 
form by replacing the coordinate system (X, Y, z) by a new system, rotated 
with respect to the former by a variable angle 8(z). In order to see this, we 
introduce the complex coordinate (7.3) 
w = X + iY 
(15.5) 
so that (15.4) become 
7¢" 
r/B 
w" + 74' w' 
w' 
~B' 
2V/~ w=0 
The final two terms containing i explicitly can be removed by introducing 
a new complex coordinate, u, such that 
w =: u expiS(z) 
(15.7) 
Equation (15.6) becomes 
7¢' 
ir/B 
u" + u' (2i8' + 2q~ 
V/~) 
!17 B ~ 
7¢" 
ir/B' } 
and the terms explicitly involving i vanish if we choose 
8'- ~B 
(15.8) 
(15.9) 

15.1 DERIVATION OF THE PARAXIAL RAY EQUATION 
209 
(so that 8"= rlB'/2¢ '/2 
- 
rlBT¢'/4¢ 3/2) and we obtain 
,),¢" 
r/2B 2 
,, 
7¢' u' 
+ 
u 
+ ---= 
+ 
u = 0 
(15.10) 
2¢ 
4¢ 
We note that (15.9) is essentially the same as (2.39). Explicitly, writing 
we have 
or again 
u = x 4- iy 
(15.11) 
~,¢" 
rl2B 2 
7¢' z' 
+ 
x" + ----= 
+ 
x = 0 
2¢ 
4¢ 
"~'¢' y, 
"/'¢" 4- r/2B 2 
+ 
4q~ 
2¢ 
(15.12) 
d 
7¢" 4- r/2B 2 
d---z (¢½x') + 
4¢½ 
d 
3'¢" 4- ~7 2B2 
d--zz (¢½ Y') 4- 
4¢½ 
x=0 
y=0 
Physical significance of the coordinate rotation 
This transformation to the rotating coordinate system (x, y, z) is of 
great importance. We therefore consider it in more detail before proceeding. 
The complex transformation (15.7) may be written 
X = x cos 0 - y sin 0 
Y = x sin 0 + y cos 0 
(15.14) 
so that in any plane z - const, the axes X-Y are inclined at an angle 
O(z) to z-y (Fig. 15.3). This angle increases monotonically provided that 
the sign of B(z) does not change and the x-y-axes therefore twist round 
the z-axis like the blades of a propeller or the ridge of a screw of variable 
pitch. Figure 15.3a gives a perspective view of this and 15.3b shows a view 
along the z-axis. We shall see in Part VII that f-~o~ B(z)dz = 0 in any 
permanent-magnet lens and the total rotation in such a lens is hence zero. 
Unlike a conventional cartesian coordinate system the coordinate sur- 
faces are not planes: the surfaces x = 0 and y = 0 are curved, though 
everywhere normal to each other, intersecting along the z-axis. The ele- 
ment of length ds in (z,y,z) is not equal to (dz 2 + dy 2 + dz2)l/2 but is 
given by 
ds 2 = dX 2 + dY 2 + dz 2 
(15.15) 
= 
+ 
+ 
{1 + 
+ y2)¢  } + 
- 

210 
15. SYSTEMS WITH AN AXIS OF ROTATIONAL SYMMETRY 
x x 
z 
Y 
Fig. 
15.3: 
Fixed coordinates 
(X,Y,Z) and rotating coordinates 
(z,y,z). 
(a) Perspective view. (b) View along the optic axis. 
This rotation about the axis is closely related to the phenomenon of Larmor 
precession; if we express the rate of change of 6 as a function of time rather 
than axial distance, using dS/dt = O'dz/dt and dz/dt = 2r/¢/-y, we find, in 
agreement with (2.38) 
dO 
e 
B 
rl~ B 
-
-
 
= 
= 
(15.16) 
tit 
2m0 3' 
7 
or using (3.9) 
dO 
-- 
= r/2 B 
(15.16a) 
dr 
which is indeed the Larmor precession frequency. 
The fact that the paraxial equations separate in the rotating coordi- 
nates implies that an electron initiaUy travelling on one of the coordinate 
surfaces, or on any surface ax 4- ~y = 0, remains on this surface; this leads 
us to ask what becomes of the angular momentum, and in particular of its 
axial component N (4.14). We have 
N = (r x P)z 
(15.17) 
in which we recall that p is the canonical momentum (4.12), p = g - eA 
and 9 is the kinetic momentum (2.12, 2.19). In the paraxial approximation, 

15.1 DERIVATION OF THE PARAXIAL RAY EQUATION 
211 
for (I)0 = 0 and 
so that 
1 
-cA = -cAin, ,~ - -~ er B i~ 
p= g-eA= 
(2moe¢) ½ (i~ + r'i~) + { (2moeq~)½qo '- 1-eB} 
(15.18) 
Hence 
1 
--~eB 
r 
(15.19) 
or writing XY' - X'Y = r2q0 ' 
1 
N = (2moe¢)½(Xy '- X'Y) - -~eBr 2 
(15.20) 
From (15.14) we have 
XY' - X'Y = xy' - x'y + (x 2 + y2)0' = xy' - x'y + rl Br 2 
and hence 
N = ~/2m0e¢ (xy' - x'y) 
(15.21) 
/ 
so that in the rotating coordinate system, the magnetic field does not ap- 
pear explicitly in N. If N vanishes, the azimuthal angle q0 remains at a 
constant angular distance from 8, q0 = /9 + const and the corresponding 
trajectories are said to be meridional. 
They lie in the curved surfaces 
defined by c~x +/~y = 0, which intersect along the z-axis and are inclined at 
some fixed angle to the coordinate surfaces x = 0 and y = 0. Clearly any 
trajectory that intersects the axis at some point is a meridional trajectory, 
and vice versa. Rays that are not meridional are said to be skew. 
Note: 
we have used cartesian coordinates (X, Y, z) and rotating pseudo-cartesian 
coordinates (x, y, z) above in preference to polar coordinates, since the cal- 
culation becomes complicated when skew rays are considered in the latter 
system. Extensive discussion of the correct way of handling skew rays when 
polars are used is to be found in most of the earlier texts on electron optics 
(e.g. de Broglie, 1950; Rusterholz, 1950; Picht, 1963); the problem vanishes 
when cartesians are employed (Glazer, 1952, Section 42). 

212 
15. SYSTEMS WITH AN AXIS OF ROTATIONAL SYMMETRY 
15.2 Variational derivation of the paraxial equations 
m 
We now take as our starting point (4.34-4.36), expanding the function M 
that plays the role of refractive index as a power series in x and y and 
retaining only quadratic terms. From (4.35) and (2.13), we have 
-M(X,Y,X',Y',z) = 
2moe4'(1 + cO)(1 + X '2 + ya) 
- e(X'Ax + Y'Ay + A,) 
(15.22) 
Substituting for Ax, Ay and Az from (7.43-7.45) and for • from (7.36) 
into 
m 
M 
M:= 
(2.~o~) ~, 
- ~?(X'Ax + Y'Ay + Az) 
(15.23) 
we obtain a power series in X, Y and their derivatives, the quadratic terms 
of which, M (2), are given by 
M(2) _ 
7¢" 
1 
(X a 
ya 
1 
(XY' 
X'Y)(15.24) 
(x , + y,) + fi$,~ 
+ 
) - ~,B 
- 
It is already clear that the Euler equations of ~ f M(2)dz = 0 will be coupled 
and we therefore attempt to transform the coordinates in such a way that 
the mixed term in XY' - X'Y, the source of the coupling, is eliminated. 
From (15.14) we obtain 
X 2+Y2 =x2+y2 
X a + y,2 = x,2 + y,2 + 28r(xy,_ x'y) + 8a(x2 + y2) 
XY' - X'Y = xy' - x'y + 0'(x 2 + y2) 
(~5.25) 
Substituting into M (~), we find 
M(2) = (x2 + y2) -8--~2 + 
- ~7/B0' 
1 
+ (x,2 + y,2) 
+ (xy'- x'y)(O'¢½ - ~T1B) 
(~5.26) 

15.3 FORMS OF THE PARAXIAL EQUATION 
and the term in xy' - x'y vanishes if we select 
Oi - 
7/B 
(see 15.9). The function M (2) becomes 
M(2) -. 
1 
r/2B 2 
1 
(x,2 
y,2 
8;~, (~¢'+ 
)(x2 + y2)+ ~¢'~ 
+ 
) 
Hence 
OM (2) 
OM (2) 
Oz' 
= $ ½ z' 
, 
Oy' 
0M (2) 
1 
¢. 
r/2B2) z 
4~½ (')' 
+ 
Ox 
=4½y' 
0M (2) 
1 
¢,, 
r/2B 2 
Oy 
-- 
4¢½ (3' 
+ 
)Y 
and the paraxial equations are thus 
213 
(~5.27) 
(15.2s) 
(15.29) 
(15.30) 
) 
3'¢" 
7/2 B2 
d 
¢½x' 
+ 
d-~ 
+ 
4¢ ½ 
x = 0 
(15.31) 
with an identical equation for y(z), as already found (15.13). 
15.3 Forms of the paraxial equations and general 
properties of their solutions 
15.3.1 Reduced coordinates 
In the absence of an electrostatic field, the paraxial equations take the form 
u" + F(z)u = 0 
(15.32) 
(u = x + iy) with 
F(z) := r12B2 
4~ 
(15.33) 
When ¢(z) is not constant, they can again be reduced to this form by a 
simple transformation of the off-axis coordinates. We write 
u(z) =. v(z)a(z) 
(15.34) 

214 
15. SYSTEMS WITH AN AXIS OF ROTATIONAL SYMMETRY 
in which v is a new reduced complex coordinate and a(z) is a real function, 
chosen so that all terms involving dv/dz disappear. Substituting (15.34) 
into (15.10), we obtain 
a' 
7¢"~ v' 
7¢' 
+ r/2 
v"+ 
2--+ 
+ 
--+----z'+ 
,: 
v=O 
(15.35) 
a 
"~-] 
a 
a 2¢ 
4¢ 
and the coefficient of v' vanishes if 
a' 
7¢' 
¢' 
- 
= ---= = -= 
(15.36) 
a 
4¢ 
4¢ 
or 
giving 
with 
and 
a(z) = ~-~ 
(~5.3v) 
,"(z) + G(z)~(z) = o 
(~5.38) 
a(z)-= 
(1 + g ~4) + 
4~ 
(15.a91 
u(z) = ,,(z)/4i 
(~5.4o) 
The substitution (15.40) was introduced into electron optics by Picht (1932), 
and is widely known as Picht's transformation; see too Glaser (1933a-d) 
and Cotte (1938). This result is of interest for two reasons. First, it is 
simpler to perform numerical calculations with (15.38) than (15.10). Sec- 
ondly, the function G(z) is essentially non-negative, and we shall see that 
this imposes an interesting restriction on electron lenses: they always exert 
a converging action. 
15.3.2 Stigmatic image formation 
The paraxial equations are linear, homogeneous and of second order and 
their most general solution is therefore of the form 
u(z) = Aul(z) + Bu2(z) 
(15.41) 
in which ul(z) and uz(z) are any pair of linearly independent solutions 
of (15.10). We shall find it necessary to introduce several such pairs of 
solutions and we shall adopt a consistent notation for each in subsequent 
chapters, but many paraxial properties are quite general and in no way 
depend on any particular choice. The most important result concerns the 

15.3 FORMS OF THE PARAXIAL EQUATION 
215 
zi 
z 
~Zo 
~~~h(z) 
= 
~ g f z )  
Fig. 15.4: The paraxial solutions g(z) and h(z). 
existence of stigmatic image formation. The form of (15.10) or (15.12- 
15.13) alone is sufficient to predict that pairs of planes can always be found 
having the properties associated with point-to-point image formation. 
Consider a particular solution h(z) of the paraxial equation for the 
complex coordinate u (15.10) that intersects the axis at z = Zo and z = zi: 
h(zo) = h(zi) = 0 (Fig. 15.4). A pencil of rays intersecting the plane z = Zo 
at some point Po (Uo = Xo + iyo) may be described by 
u(z) = uog(z)+  h(z) 
(15.42) 
in which g(z) is a solution of (15.10) that is linearly independent of h(z); 
for convenience, we have set g(zo) = 1; )~ is a (complex) parameter char- 
acterizing the various members of the pencil. 
In the plane z = zi, we 
have 
u(zi) = Uog(Z ) 
(15.43) 
for all )~ and hence for every ray passing through Po. Since this is true of 
all points in the plane z = Zo, the latter will be stigmatically imaged in 
z = zi. Moreover the ratio u(zi)/Uo is constant and so the distribution of 
points Pi will be identical with the distribution of Po, apart from a change 
of scale: the image is a linearly magnified (or reduced) representation of 
the object. 
If we return to the fixed cartesian system (w = X + iY, z), we find 
W(Zi) 
-- u(zi)exp{iO(zi)} 
g( zi ) exp/i{ 0(zi ) - O( zo ) } 
P 
t 
W(Zo) 
or 
where 
w(zi) = M(zi, zo)W(Zo) 
M(zi, Zo) = g(zi)exp[i{O(zi) - O(zo)}] 
(15.44) 
(15.45) 

216 
15. SYSTEMS WITH AN AXIS OF ROTATIONAL SYMMETRY 
For single-stage image formation, in which a meridional ray from Po inter- 
sects the axis only once between Po and Pi, g(zi) is negative and we may 
write 
M(zi,zo) - 
O(Zo) ] 
The modulus of g(zi), and hence IM(zi, Zo)l, is referred to as the transverse 
magnification and the image rotation is clearly equal to arg(M)- 7r. Nev- 
ertheless, the complex magnification M(zi, Zo) is rarely used and in the 
remainder of this book we shall reserve the symbol M for the transverse 
magnification, regarded as an algebraic quantity: 
M := g(zi) 
(15.47) 
The notion of complex magnification is valuable when we need to con- 
sider the reversal of an imaging system. A pencil of rays from Pi to Po will 
not retrace the paths of those from Po to Pi since the direction of rotation 
will be opposite. This is readily seen from (15.45) which tells us that 
M(zo, zi) = M*-l(zi,zo) 
( 5.4s) 
in which the asterisk denotes the complex conjugate. 
A number of useful general relations can be deduced from the form of 
(15.32) or (15.38) alone. Thus the fact that F(z) and G(z) are never neg- 
ative tells us that all electron lenses have a net converging action although 
this need not be true of local zones of electrostatic lenses. To see this, we 
note that the curvature # of any solution of (15.32) or (15.38), given by 
= u"/(1 + u'2) 3/2 or v"/(1 + v'2) 3/2, is always opposite in sign to u or 
v respectively. Thus a solution of the appropriate paraxial equation that 
approaches the field parallel to the axis will be bent towards the latter. If 
the ray crosses the axis in the field, it will again be bent back towards it 
and if the field is long enough, the ray will oscillate about the axis. Thus 
the effect of the field is that of a converging lens. Nevertheless, care is 
needed here since rays can intersect the axis more than once in a strong 
lens and, as we shall see in the next section, the sign of the focal length 
will then be that associated with a divergent lens. 
We have been basing our argument on the positivity of F(z) or G(z) 
and it is safe to conclude that a ray incident from field:free space parallel 
to the axis will intersect the axis at least once before emerging into image 
space. It is not, however, necessarily true that actual electron trajectories 
in electrostatic (or mixed electrostatic and magnetic) fields always bend 

15.3 FORMS OF THE PARAXIAL EQUATION 
217 
towards the axis: the term in (q~o/¢) 1/4 may be large enough to reverse the 
curvature locally. Provided the electron is not driven beyond the parax- 
ial region, however, the convergent action will always dominate, as our 
reasoning based on G(z) shows. 
15.3.3 The Wronskian 
Another property of the paraxial equations is the existence of an invariant, 
the Wronskian, from which a number of interesting optical relations can be 
derived. Let Ul(Z) and u2(z) be a pair of linearly independent solutions of 
(15.10), so that 
) 
7¢" 
112B2 
d 
~½ , 
+ 
d'--z 
ua + 
4q~½ 
Ul-'0 
__( 
) 
")'¢"+r/2B2 
d 
q~½u~ + 
u2=0 
dz 
4¢½ 
(15.49) 
Multiplying the first equation by u2 and the second by u l and subtracting, 
it is easy to show that 
_½ UaU 2 -- UlU2) 
-- 0 
dz 
(15.50) 
or 
! 
! 
¢½(ulu 2 - ulu2 ) = const 
(15.51) 
The same is of course true of any pair of solutions of the separate equations 
for x(z) and y(z) (15.13). 
Suppose we choose ua(z) = h(z) and u2(z) = g(z), where as before 
(15.42) g(zo)= 1, g(zi)= M and h(zo)= h(zi)- O; we find 
^½ 
^½, 
¢o h'o = ¢i hiM 
(15.52) 
! 
! 
But hi/h o is the angular magnification, M~, and we have thus shown that 
MMo, =(¢o/¢,) ½ 
(15.53) 
or, if ¢o = ¢i as in the case of magnetic and electrostatic einzel lenses: 
1 
M~=~ 
(¢i=¢o) 
(15.54) 
We may rewrite (15.52) as 
=  
(zo)h'(zo)$t 
(15.55) 

218 
15. SYSTEMS WITH AN AXIS OF ROTATIONAL SYMMETRY 
I 
Azi -11 
-"- 
~ 
I 
z 
~c~ 
Xh(z 
) 
I 
~gfz) 
Fig. 15.5: The notion of longitudinal magnification. 
which is known in light optics as the Smith-Helmholtz formula (Born and 
Wolf, eq. 4.4.49); it is also associated with the names of Clausius and 
Lagrange and was known in a more primitive form to Cotes and Huygens 
(see Rayleigh, 1886 and Czapski and Eppenstein, 1924 p.l16). 
A final related quantity is the longitudinal magnification: 
this tells 
us how far the image plane moves when the object plane is shifted a small 
distance. Consider again the pair of rays g(z) and h(z), which we now 
specify completely as the rays that satisfy the boundary conditions 
g(zo) = g'(Zo) = 1 
V(Zo) = h(Zo) = 0 
(15.56) 
in the original object plane. In the image plane h(zi) = 0 and g(zi) = M. 
For a neighbouring object plane, distant Azo from z = zo (Fig. 15.5), the 
corresponding 'h-ray' satisfying 
h(zo + Azo) = 0 
-h'(zo + hZo)= 1 
may b~ writt~ ~ ~ li~: 
¢ombi~tio~ o~ 9(z) ~d h(z) si~ 
th~r~ ¢~ b~ 
only two linearly independent solutions" 
h(z)= Ah(z) + Bg(z) 
(15.58) 
Clearly 
so that 
giving 
h(zo + ~XZo) ~ ~X~o 
, 
9(Zo + ~XZo) ,~ 
A=I 
, B=-AZo 
m 
h - h 
- 
gAzo 
(15.59) 

15.4 THE ABBE SINE CONDITION AND HERSCHEL'S CONDITION 
219 
m 
In the shifted image plane, z = zi + Azi, 
h(z) vanishes and so 
h(zi + Azi) - g(zi + Azi)Azo -- 0 
but h' ( zi ) = M,,, and g( zi ) -- M and hence 
MaAzi -- MAzo = 0 
or 
-" 
- 
M 2 
(15.60) 
AZo -" Mt - M~, 
The quantity Mt is known as the longitudinal magnification and we have 
MtM,~ = M 
(15.61) 
If ¢o = ¢i, M~ = 1/M (15.54) and 
1 
Ml = M 2 = 
(¢o = ¢i) 
(15.62) 
M2 
15.4 The Abbe sine condition and Herschel's condition 
These two conditions do not strictly belong to paraxial optics, for they are 
conditions under which particular sets of points are imaged stigmatically 
irrespective of the ray gradient. 
They are, however, of interest in elec- 
tron optics mainly in connection with the foregoing results and we there- 
fore make a short digression to establish them here. They are most easily 
derived from the invariance of the Lagrange bracket (5.34), as shown by 
Sturrock (195fi,) following the example of Herzberger (1931). 
The invariance of the Lagrange bracket {u, v} may be translated into 
concrete terms by considering three neighbouring rays, which we label 0, 
1 and 2. The ray zero connects two points A, B as shown in Fig. 15.6; at 
these points, r = ra, p = pa and r = rb, p = Pb respectively. The ray 1 is 
shifted by a small amount from ray O, so that to its endpoints correspond 
the values ra + Aara, Pa + AlPa and ~'b "~- mlT"b, Pb + AlPb; the same is 
true for the ray 2 except that the increments are now A2ra, A2Pa, A2r b 
and A2p b. 
If these rays belong to a congruence, such that ray zero corresponds 
to the parameters (u, v), ray 1 to (u + Alu, v) and ray 2 to (u, v + A2v), 
the invariance of {u, v} is equivalent to that of Aap. A2r- 
A2p. Aar , 

220 
15. SYSTEMS WITH AN AXIS OF ROTATIONAL SYMMETRY 
Fig. 15.6: The rays employed in connection with the Lagrange invariant. 
which is known as the Lagrange differential invariant. 
We now apply this 
invariance to two special cases. 
Suppose that the points A and B are conjugate and that to every point 
A' in a plane through A we can find a conjugate point B' in a plane through 
B. The shift from A to A' and B to B' is chosen to be the displacement 
A1, while A 2 corresponds to the transition to another ray connecting A 
and B (Fig. 15.7a). 
Thus A2r a = A2~" b = 0 and Alxa = AlX b "- O, where the x-axes are 
taken perpendicular to the planes containing AA' and B B'. The invariance 
of &lP" &2r- A2p" Air shows that 
pa(A2tya " Aly a -~ A2tza" AlZa) ~- pb(A2tyb" Aly b Jr A2t;zb" AlZb) (15.63) 
where we have written p = pt and t is a unit vector, the components of 
which are the direction cosines of p. The scalar p reduces to ~1/2 near the 
axis. 
We now choose the axes Oza, Ozb to coincide with the axes of a rota- 
tionally symmetric system and consider points in the planes Xa-Za, Xb-Zb. 
Setting Aly a = Alyb = 0, tza = cOSta, tzb = COS~b (Fig 15.7b), we find 
Pa " Aza" sin0a. A20a = Pb" Azb. sin0b. A20b 
(15.64) 
Writing Azb = MtAza, and integrating with respect to 0, we obtain Her- 
schel's condition 
pa (cos 0,, - 1 ) = Mlpb(cOS Ob -- 1 ) 
( 5.65) 
or 
Pa sin2(Sa/2) = Mlpb sin2(Sb/2) 
(15.66) 

15.4 THE ABBE SINE CONDITION AND HERSCHEL'S CONDITION 
221 
A ' 
roy 2 
/ ~- /1, 2 
A 
A1za 
A' 
\ 2 
A1Zb 
z 
A i 
Alxo 
2 
z 
C 
t9' 
Fig. 15.7: The rays employed in the derivation of (a,b) Herschel's condition and (c) the 
sine condition. 
If this condition is satisfied, an element of the axis close to A will be imaged 
sharply, even if the ray gradient is not small. If 8, and ~b are small, (15.66) 
becomes 
p,~O~ = M, pbO~ 
(15.67) 
or 
P./Pb = MtM . 
(15.68) 
which is equivalent to (15.61) using p = ~1/2 and (15.53). 
We may use the Lagrange differential invariant to derive the sine con- 
dition; the three rays are now chosen as shown in Fig. 15.7c. From (15.63), 
we have 
Pa " AlYa 
" COSta • A28a -- Pb" AlYb" 
COS~b • A2~b 

222 
15. SYSTEMS WITH AN AXIS OF ROTATIONAL SYMMETRY 
(note that tv~ = sin O. and likewise for tub ). Hence 
Pa • sin 0a • A1 y~ = 
Pb" sin 0 b • A 1Yb 
(15.69) 
which is known as the sine condition, the importance of which was first 
recognized by Ernst Abbe. When the sine condition is satisfied, a small re- 
gion around the axis will be imaged sharply irrespective of the ray gradient. 
Looking ahead to Part IV, this implies that coma must vanish. 
For small angles, (15.69) reduces to 
PaOa " AlYa -- PbOb " hlYb 
(15.70) 
which is equivalent to (15.55). 
15.5 Some other transformations 
We have seen that the paraxial equations for electrostatic lenses and mixed 
lenses can be cast into a more convenient form by means of Picht's transfor- 
mation (15.40). We briefly mention some of the other transformations that 
have been proposed; we shall meet still others in connection with electron 
mirrors and with specific field models. 
We first enquire whether the term in du/dz in (15.10) can be removed, 
not by a change of the transverse (dependent) variable as in the Picht 
transformation but by introducing a different axial (independent) variable. 
We write 
=¢(z) 
, u=u(¢) 
, 
¢=¢(~) 
(15.71) 
du 
du d¢ 
and 
d2 u 
d2 u ( d~ ) 2 
du d2 ~ 
(15.72) 
d---~ = d( dz 
dz 2 = de 2 
-~z 
"4-d-'-~ dz 
---i 
so that 
The paraxial equation (for electrostatic fields only) thus becomes 
,2 
2 
~2~ 
77 (d¢ldz)2 + d 
= 0 
+ 7u 
4¢ 
in which dots denote differentiation with respect to ~. 
vanishes if 
dz 
= o 
( 
5.73) 
The term in ti 

15.5 SOME OTHER TRANSFORMATIONS 
223 
or, apart from an unimportant multiplicative constant, 
¢(z) = f 
dz' 
(15.74) 
giving 
{ __ 
81(~) 
2 } 
+ 
$- 
u = 0 
( 5.75) 
An incorrect nonrelativistic form of this equation is given by Picht (1963 
p.166). 
Another transformation, also introduced by Picht (1932, 1963 
p.167), provides a means of designing lenses for a specific purpose, by gen- 
erating the potential distribution that will create desired trajectories. We 
merely indicate the procedure: several examples are worked out in detail 
by Picht. From (15.10), in which we again set B = 0 and consider the 
nonrelativistic approximation, we see that the paraxial equation can be 
written 
u" 
¢),, 
3 m(u¢) + (u 
- 0 
(15.76) 
u 
Setting 
and 
(15.76) becomes 
u¢ =" T(z) 
(15.77a) 
u II 
3 -- =: t(z) 
(15.77b) 
u 
T"(z)+t(z)T(z)-O 
(15.78) 
Thus, given u(z) we can calculate t(z), solve (15.78) for T(z) and finally 
extract ¢(z) from (15.77a). 
Picht gives another method of solving this 
problem, which we shall not describe here. 
Hitherto, we have discussed the motion of electrons in terms of coor- 
dinates of position, deriving the ray gradients by differentiation. Position 
and canonical momentum are, however, conjugate variables, as explained 
in Part I, and we should therefore expect to be able to work in terms of 
either at will. Returning to the equations 
d (OM(2))=OM (2) 
dz 
Ox' 
Ox 
and writing p - OM(2)/Ox ', we see from (15.13) that 
X ~--- 
4¢½ 
, 
7¢" + rl 2B2 p 

224 
15. SYSTEMS WITH AN AXIS OF ROTATIONAL SYMMETRY 
so that substituting for x' in p = x'¢ 112, we obtain 
P=-¢½& 
7¢"+77282 
or writing 
"yet' + r/2B 2 
G(z) := 
44 ½ 
p. 
G' p, 
G 
--5- 
+ 4--7, p-° 
All the rules of Gaussian optics that we shall establish in Chapter 16 could 
equally well be derived from this equation; this duality is noted in Hawkes 
(1966). 

16 
Gaussian Optics of Rotationally 
Symmetric Systems 
asymptotic image formation 
16.1 Real and asymptotic image formation 
The fact that the paraxial trajectory equations are linear, second order and 
homogeneous is itself sufficient for us to anticipate that the imaging prop- 
erties of the corresponding fields can be characterized by a small number 
of quantities. We discuss this in detail in the following paragraphs but we 
must first explain the notions of real and asymptotic image formation; the 
distinction between these is not the same as that between real and virtual 
in light optics, despite some similarities. 
Since electron lenses consist of regions containing magnetic or electro- 
static fields, it is possible, and in practice common, to immerse the specimen 
of which a magnified image is required within the field itself, particularly in 
the case of magnetic lenses. The lens field is thus divided into two regions 
playing different roles (Fig. 16.1). In a light microscope, any lenses pre- 
ceding the specimen, region I in Fig. 16.1, belong to the condenser system, 
while the lens immediately after the specimen, region II, is the objective 
proper. In an electron microscope, different parts of the same lens may 
thus play different roles. The properties of region I will provide informa- 
tion about the illumination, those of region II about the image formation. 
In such a situation, it is clearly necessary to study the regions separated 
by the real object independently and the corresponding characteristics will 
be referred to as "real". 
In a multi-lens system, most of the lenses will simply transfer an in- 
termediate image from one plane to another, with the appropriate mag- 
nification, and the entire lens field contributes to this transfer. Here we 
must study the coordination between incoming and outgoing asymptotes, 
as shown in Fig. 16.2. If the intermediate image that acts as object for 
a lens is well outside the lens field, on the object side, the situation is ex- 
actly as in light optics. If it falls within the lens field or beyond it, then 
the a~yrnptotic object is analogous to the familiar "virtual object"; similar 
remarks apply to the image. In this context, we note that when discussing 

226 
16. GAUSSIAN OPTICS OF ROTATIONALLY SYMMETRIC SYSTEMS 
yoke 
I 
I I 
/wind/ngs 
Jb 
spec.i .men 
I 
REG ION 
I 
REG ION 
2 
I 
poslhon 
E 
~'z 
Fig. 16.1: The various parts of a magnetic objective lens. 
asymptotic imagery, the notions of object space and image space are used 
to refer not to regions of physical spacemthe object may lie anywhere as 
may the image--but to the space to which the corresponding asymptotes 
belong. This will become clearer when we discuss asymptotic image for- 
mation below. 
Finally, we note that both possible hybrid situations may occur: real 
object-asymptotic image and asymptotic object-real image (formation of 
a small probe within a field, for example). 
16.2 Asymptotic cardinal elements and transfer matrices 
We first discuss these matters in terms of specific solutions of the paraxial 
equations, after which we show that the same results may be obtained 
from the more abstract notion of bilinear transformations. 
In this first 
discussion, we use the form (15.12) of the paraxial equations and for ease 
of understanding we use the real x-coordinate. The reasoning for y is of 
course identical and we could naturally have used the complex u. 
Consider a field region characterized by ¢(z) and B(z) (Fig. 16.3) 
and two solutions of the paraxial equation, G(z) and G(z), satisfying the 
boundary conditions 
N 
lim a(z)= 1 
, 
lim a(z)= 1 
(16.1) 
Z'---~ ~ 
O0 
Z---~ ~ 
A general solution thus has the form 
z(z)=Aa(z)+Ba(z) 
(16.2) 

16.2 ASYMPTOTIC CARDINAL ELEMENTS AND TRANSFER MATRICES 227 
lens region 
I 
I 
I 
I 
I 
I 
I 
i 
* 
i/.~. 
\;h" 
>z 
,/..-o 
"~ .~.,.':<,,,,,<,,<,~o<,o,,,o<,,,oo 
I 
G(z) 
I 
J 
I 
I 
I 
I 
I 
I 
I 
/// 
J 
lens region 
Zi 
Fig. 16.2: (a) The paraxial solutions G(z) and H(z). (b) Asymptotic image formation. 

228 
16. GAUSSIAN OPTICS OF ROTATIONALLY SYMMETRIC SYSTEMS 
field regtbn 
.J 
I 
t 
I 
I 
I 
I 
q 
q 
1 
" 
1 
O(z) 
m 
Fig. 16.3: The paraxial solutions G(z) and G(z). 
The rays a(z) and G(z) tend to the following asymptotes: 
limoo G(z) = (z - ~i)C~ 
lim G(z) = (z - (o)G o 
Z ' - + ~ O 0  
(16.3) 
Any ray incident parallel to the axis can be written as AG(z), where A is a 
constant, and will have as its emergent asymptote A(z - (i)G~. Thus rays 
incident parallel to the axis generate emergent asymptotes that all intersect 
the axis at z = ~i and we denote this point by z = ZFi and refer to it as 
the asymptotic image focus. 
By exactly analogous reasoning, we see that 
all rays that emerge parallel to the axis correspond to incident asymptotes 
that intersect the axis at z = ~o; we write ~o = ZFo and refer to this as the 
asymptotic object focus. 
The incident asymptote to the ray G(z) and its emergent asymptote 
intersect at a point in the plane z = zpi, such that 
1 =(zp~-zFi)c'i 
or 
1 
zpi = ZFi --~ ~ 
(16.4) 
Gi 
m 
Likewise the asymptotes to G(z) intersect in a plane z = Zpo , 
1-(ZVo-ZFo)Go 
giving 
1 
zpo = ZFo + ~ 
(16.5) 
V ° 

16.2 ASYMPTOTIC 
CARDINAL 
ELEMENTS 
AND TRANSFER 
MATRICES 
229 
The planes Zpi and Zpo are known as the asymptotic principal planes. 
The 
distances 1/G~ and 1/G' o are known as the asymptotic focal lengths 
(Fig. 
16.4). We write 
1 
1 
fi'= 
~, 
, 
fo'-- 
, 
(16.6) 
Go 
so that (16.4-16.5) become 
zgi -- zgi -- fi 
, 
Zgo -- Zgo + fo 
(16.7) 
This apparent inconsistency in the choice of sign is explained by considering 
the relation between fo and fi. Since (15.51) 
q~-} (GG'- G'G) = const 
(16.8) 
we see that 
!~l 
^ ! 
I 
¢:oG o - -¢/a 
i 
(16.9) 
or using (16.6), 
,,1 
,, 
1 
fo¢o 2 - fi¢i 2 
(16.10) 
In magnetic lenses, therefore, with the sign convention of (16.6), we have 
fo - 
fi and shall frequently drop the suffix. In the class of electrostatic 
lenses that provide no overall acceleration, so that q;o - q;i, we again have 
fo = fi. Furthermore, fo and fi will both be positive if the rays G(z) and 
G(z) intersect the axis only once, since electron lenses always have a con- 
vergent focusing action. As the lens is made stronger, however, there comes 
a point at which the emergent asymptotes are parallel to the optic axis as 
well as the incident asymptotes and the lens then behaves like a telescope 
(fo and fi -+ ~o). Beyond this point, the rays return towards the axis 
but now G~ is positive and G' o negative (Fig. 16.4c). Formally, therefore, 
lenses operating in these conditions belong to the class of divergent lenses 
but since they have this character because they are so strongly convergent, 
this terminology is never used. 
Returning to the general solution (16.2), we can express the incident 
and emergent asymptotes in the following way: 
lira x(z) - A + B Z-- ZFo 
z---~o 
fo 
(16.11a) 
lim x(z) - 
-A 
z- 
zgi + B 
(16.11b) 
z--,oo 
fi 

230 
16. GAUSSIAN OPTICS OF ROTATIONALLY SYMMETRIC SYSTEMS 
I 
I 
I 
,~ 
I 
r/ 
d 
F..I~ 
! 
i 
$ 
, 
-'i--. \.. 
,-"b-.\ 
!~ 
lens r'egion 
-, 
b 
I 
! 
I 
i 
! 
I 
i 
Lens Reg/on 
I 
~J 
d':,~J" 
! 
I 
"~¢Y 
I ', 
~o 
~ol 
I 
I 
zp i 
L 
-r;. 
4 
F (°'.''v') I/ 
Fig. 16.4: The asymptotic cardinal elements. (a) Image focus and principal plane. (b) 
Object focus and principal plane. (c) Image focus and principal plane for a strong lens; 
the image focal length has become negative. 

16.2 ASYMPTOTIC 
CARDINAL ELEMENTS AND TRANSFER MATRICES 231 
Eliminating A and B, we find, with Q12 := (Zl -- ZFo)(Z2 -- ZFi) 
(x2) = ( ,z2 
(x,) 
x~ 
-llfi 
(Zl--ZFo)/fi 
Xll 
(16.12) 
in which x2 denotes x(z) in some plane z = z2 on the emergent asymp- 
tote and x~ the gradient of the latter (x~ = -A/fi); Xl denotes x(z) in 
some plane Zl on the incident asymptote and x~ the gradient (x' 1 =B/fo). 
Writing 
~ 
X # 
and 
-(z2 - ZFi)lfi 
fo + Qa21fi ) 
T - 
(16.14) 
-llfi 
(Zl--ZFo)/fi 
(16.12) reduces to 
x2 -- T;~I 
(16.15) 
The matrix T is known as the transfer matrix, 
and we shall see that 
it encapsulates in a convenient way all the paraxial behaviour of the lens. 
From it, all the familiar imaging relations may be derived straightforwardly. 
Suppose that the planes Po(zl = Zo) and Pi(z2 = zi) are conjugate, that 
is, that all rays from any point in Po converge to a point in Pi. For this, 
' and hence 
the expression for xi must be independent of x o 
fo + (zo - zFo)(zi - z~)/f~ 
= o 
(16.16) 
or 
(Zo - ZFo)(Z~ - zF~) - 
-f~fo 
(16.17) 
This is Newton's lens equation. 
Introducing the expression for Zpo and 
zpi (16.7), (16.17) becomes 
(zo - zpo)(z~ - zp~) - f~(zo - zpo) + Io(z~ - zp~) = o 
or 
Writing 
fo 
I~ 
+ 
= 1 
(16.18a) 
ZPo -- Zo 
Zi -- zpi 
]:=io 
= fi 
= (fofi) ½ 
(16.19a) 

232 
16. GAUSSIAN OPTICS OF ROTATIONALLY SYMMETRIC SYSTEMS 
so that ] is the geometric mean of the focal lengths, and 
= 
(16.19b) 
this becomes 
+ 
= -= 
(16.18b) 
Zpo -- go 
Zi -- Zpi 
f 
This is the thick-lens counterpart of the familiar thin-lens equation. 
From (16.19a) we see that, irrespective of Zl and z2, the determinant 
of the transfer matrix T (16.14) has the value 
det T = Alii = (¢o/¢i) ½ 
For conjugate planes, the matrix equation simplifies to 
x i' 
--1/fi 
(Zo -- ZFo)/fi 
Xo' 
and denoting the transverse magnification by M,,we have 
(16.20) 
--(Z i -- ZFi)/fi 
= M 
(16.21) 
' to ' is the angular magnification M~ (15.52), 
If x o = 0 the ratio of x i 
x o 
M,~ =(Zo--ZFo)/fi 
(16.22) 
so that using (16.17), 
M,~ = -fo/(zi 
- ZFi) = 
fo/fiM 
(16.23) 
Hence 
MMo, = fo/fi = (¢o/~i) 
½ 
(16.24) 
as already shown (15.53). 
Thus 
zi -- 
Z F i  
- 
fiM 
, 
zo = ZFo + Yo/M 
(16.25) 
From (16.20), we see immediately that the principal planes are the 
pair of conjugate planes with unit magnification: 
( ) ( 
)( ) 
XPi 
1 
0 
XPo 
\ 
x i 
-1/fi 
fo/f, 
xl 
(16.26) 

16.2 ASYMPTOTIC CARDINAL ELEMENTS AND TRANSFER MATRICES 233 
~-.-..~...Z 
N 0 
z N i. 
~ -- -~ ~
.
~
~
~
 
Fig. 16.5: Nodal points. 
© 
~
~
O
 
,
z
P
~
 
~ 
, 
Fig. 16.6: Asymptotic image construction. The image of an object Po is obtained by 
first drawing a line through Po and the object focus Fo, which intersects the object 
principal plane at Q'. A second line is drawn through the point Q in the image principal 
plane at the same height as Po and the image focus Fi. The point of intersection of this 
second line and a line through Q' parallel to the optic axis is the image Pi of Po. 
A third pair of axial points, the nodal points, is occasionally of interest. 
These are points having the property that a ray whose object asymptote 
intersects the axis at the object nodal point has an emergent asymptote 
intersecting the axis at the image nodal point, these asymptotes being 
parallel (Fig. 16.5). If these points are denoted by z -- ZNo, z = zgi, then 
(ZNo - ZFo)/fi = 1 
(16.27) 
so that if ¢o - 
¢i, the nodal points and principal planes coincide. 
In 
general, 
ZNo -- ZFo + fi -- Zpo -- fo + fi 
ZNi -- ZFi- 
fo -- zpi -- fo + fi 
(16.28) 
Once the loci and principal points are known, a simple construction 
enables us to obtain the point Pi conjugate to any object point Po. First, 
a line is drawn through Po parallel to the optic axis, intersecting the plane 
z = zpi at Q; a line is then drawn through Q and the image focus, Fi 
(Fig. 16.6). Next, a line is drawn through Po and the object focus Fo, 
intersecting the plane z = Zpo at Q'; a line through Q' parallel to the optic 
axis intersects the line through Q and Fi at the image point Pi. 
The various quantities that characterize the imaging properties of a 
lens--the foci, principal points, nodal points and focal lengths--are known 

234 
16. GAUSSIAN OPTICS OF ROTATIONALLY SYMMETRIC SYSTEMS 
as its cardinal elements. 
In electron optics, only the focal lengths and the 
positions of the loci are routinely tabulated. 
The matrix expression (16.12) is very convenient when we wish to 
calculate the cardinal elements of a doublet of two lenses, separated by a 
field-free region. Instead of using the general form of the matrix elements 
given in (16.12), however, we use the simple form that connects principal 
planes (16.26). We have 
(: 
1 
~'i(~ 
-i/S2~ 
o 
z~Zpo) 
s~/s2 ~ 
~" 
(16.29) 
( 
)( 
) 
XkZpo ) 
= 
1 D 
x(z~ )) 
(16.30) 
x~ 2) 
0 
1 
Xti (1) 
( 1 
o 
• ~Zpo) 
(16.31) 
,[1~ 
_l/s}x~ so~l~//}~ 
x~l~ 
in which the superscripts (1) and (2) characterize the first and second lenses 
and 
D = ~Po'(2) _ z~) 
(16.32) 
is the distance between the object principal plane of the second lens and 
the image principal plane of the first. Multiplying the matrices, we obtain 
z~Zeo) 
=To 
~'i ( ~ ) 
~'o( ~ ) 
(~6.33) 
where 
TD = ( -(z(~ -- ~Fi)/tPi 
-- l '/ ~o i 
qOo + Q, oi/(Pi 
) 
t (1) 
~,Zpo --¢Fo)l~i 
= ( 
1-- D/f~ 1) 
(D- f~l)_f(2))/f~l)f~2) 
Df(1)/f~l) 
) 
_f(1)( D + f(2))/f~l)f~2) 
(16.34) 
in which ~Fo and ~Fi denote the object and image foci of the doublet and 
~oi its image focal length; we have written Qoi 
~ (1) 
• = 
~Z~o - ~o)(Z(~ 
- ~,). 
We see that 
= 
(16.35) 
~i "-- f~l) + f(2) 
D 
OF 

16.3 GAUSSIAN OPTICS AS A PROJECTIVE TRANSFORMATION 
235 
with 
DR'= f{') + f(o 2) - D = z(~) i - "Fo"(2) 
(16.36) 
CFi - z~, ) = f(i2)(f} 1)- D)/DF 
(16.37) 
Cfo 
.,(1) 
fo(1)(fo (2) + D)/Dr 
D 
/"Po 
We have not exhausted the forms of the transfer matrix that are occasion- 
ally useful. Thus we shall encounter the focal transfer matrix between the 
(non-conjugate) foci, and the Du~ek matrix, in which z2 = zl. We shall 
discuss these as the need arises. 
16.3 Gaussian optics as a projective transformation (collineation) 
The reasoning in Section 16.2 has been based on the physical notion of rays 
and their asymptotes but the characteristic quantities of Gaussian optics, 
the cardinal elements, also emerge from a more abstract approach. The 
linearity of the equations of motion is sufficient for us to assert that the 
object space and image space of a field region are connected by a projective 
transformation, or collineation. 
By this we mean that if (Xo,yo,Zo) are 
the cartesian coordinates of a point Po in object space and (xi, yi, zi) those 
of a point Pi in image space, then 
x i = F1/ F4 
, 
Y i = F2 / F4 
, 
z i = F3 / F4 
(16.38a) 
where 
Fj = ajxo + bjyo + CjZo + dj 
(j -- 1, 2, 3, 4) 
(16.38b) 
and solving for Xo, yo, Zo 
• o = r;lf 
 
, 
yo = 
, 
Zo = rJlr:, 
F; 
' 
, 
, 
(16.39) 
-- ajxi + b~yi + cjzi + dj 
From (16.38b), it is immediately obvious that the images of all points lying 
in the plane F, = 0 are at infinity: F4 = 0 is thus the object focal plane 
and similarly, the plane F~ = 0 is the image focal plane. 
Suppose now that the system has rotational symmetry about the z- 
axis and suppose too that the coordinates in image space are rotated with 
respect to those in object space by the appropriate angle $ (15.9 or 15.27). 
An object point (0, yo, zo) will be transformed into (0, yi, zi) but zi will be 

236 
16. GAUSSIAN OPTICS OF ROTATIONALLY SYMMETRIC 
SYSTEMS 
unaltered if yo is replaced by -yo whereas Yi will become --Yi. From the 
relations 
b2yo "4- C2Zo + d2 
b3yo + C3Zo + d3 
(16.40) 
Yi --- b4Ya-l-c4zo + d4 
' 
zi = b4Yo + C4zo + d4 
we deduce that b4 = 
b3 = 
c2 -- d2 = O, giving 
b2 Yo 
Ca Zo + d° 
yi = 
, 
zi= 
(16.41) 
C4 Zo 4" d4 
c4 Zo + d4 
or 
c4d3 - c3d4 
yi 
d4zi - da 
YO--- 
, 
Z
o
=
-
-
~
 
b2 
c4zi-c3 
c4zi--c3 
The focal planes are thus given by the solution of 
C4Zo + d4 -- 0 
• 
ZFo = -d4/c4 
(16.42) 
C4 Zi -- C3 --- 0 
: 
ZFi ---- C3/C4 
On measuring distances from these planes, by writing 
zo := zo + 
(16.43) 
Zi := zi - c3/c4 
and introducing fo, fi thus: 
fo := b2/c4 
(16.44) 
we obtain 
y__, = yo = 
z, 
(16.45) 
Yo 
Zo 
fi 
This yields Newton's lens equation (16.17) 
ZoZ{ = -fofi 
(16.46) 
Furthermore, the magnification M = dyi/dyo for constant Zo is given by 
M= yi/yo = fo/Zo = -Zi/fi 
( 6.47) 
so that for M = 1 we have Zo = fo, Zi = -fi. 
The planes thus defined 
are the principal planes, situated at distances fo and fi from the loci as 
already shown (16.7). 
We shall not pursue this further but clearly all the remaining results of 
Gaussian optics can be derived straightforwardly. For lengthy discussion of 

16.4 USE OF THE ANGLE CHARACTERISTIC 
237 
the use of projective transformations in this context, see Ollendorff (1955), 
Born and Wolf (1959), Czapski and Eppenstein (1924) and Carath$odory 
(1937). 
16.4 Use of the angle characteristic to establish 
the Gaussian optical quantities 
Finally, we offer a third method of establishing the relations of Gaussian 
optics, setting out from the angle characteristic. This function is obtained 
from the point characteristic function by a Legendre transformation, which 
effectively changes the arguments from point coordinates to momenta. We 
define a function T as follows: 
T := S + pax, + qaYa -- pbXb -- qbYb 
(16.48) 
in which (p, q) are the transverse components of p. From (5.29) we know 
that 
/kS : pbAXb + qbAYb -- (paAXa + qaAya) 
(16.49) 
when the integral in S is taken along a ray so that 
AT := --(XbAPb + ybAqb) + x.Ap~ + y, Aq, 
(16.50) 
and T must be a function of pa, qa, Pb and qb; the function T is known as 
the angle characteristic. Provided that Pb is not proportional to Pa and qb 
to qa, we see that 
OT 
OT 
OT 
OT 
Yb = 
Oqb 
' 
Ya = Oqa 
(16.51) 
Consider now a pair of points A, A' in object space and B, B' in image 
space. We assume that the angle characteristic between A and B, TAB, is 
known and we calculate the new value between A', B', assuming asymptotic 
image formation. We write 
TA' B' = TA' A -}- TAB + TB B' 
(16.52) 
From (16.48), we know that 
TA'A "- SA'A "~- pA, XA, + qA'YA' -- pAXA -- qAYA 
( 6.53) 

238 
16. GAUSSIAN OPTICS OF ROTATIONALLY SYMMETRIC SYSTEMS 
in which we have used PA = PA', qA = qA', SAA, = ¢~4AA' and 
with 
XlA = PAl(CA -- p2A -- q~i) 1/2 
, 
Y~i = qA/(¢A -- p2A -- q~t) 1/2 
A similar expression is obtained for TBB,. To the paraxial approximation 
therefore 
TA, B ,= TAB--(ZA, --ZA)(1-- p2A += q2A)~b i 
2¢A 
(~s.54) 
+(ZB' --ZB)(1-- p2B +~ q2s)¢~ 
2¢z 
Since the system has rotational symmetry, the quantities p and q can only 
appear in the combinations p2 A + q2A, p2 B + q~, PAPB + qAqB and we write 
TAB = a(p2A + q2A)12 + fl(p2B + q2B)/2 -- -f(PAPB + qAqB) 
(~6.55) 
By applying (16.51) to (16.54), with xa = XA,, p,, = PA' 
-
-
 PA etc., we see 
that 
(16.56) 
• ~,=-{~-(z~,-z~)/~}w 
+Yw 
y~,=-{~-(zB,-zB)/~}q~ 
+-]qA 
If PB = 0, then XA, = 0 in the plane ZA, -- ZA = --a 
for all PA while 
if PA "- 0, then XB, vanishes in ZB, -- zB = 3~/2. These are the loci: we 
wr 
te 
= 
, zfo- ZA = --a 
. Eliminating PA or PB between 
the equations for XA, and XB,, we find 
or 
( 
zA zA) 
f XA -- 
~ + 
"~ 
XB 

16.5 THE 
EXISTENCE 
OF ASYMPTOTES 
239 
provided that 
- 
^ 1  
_ 
: 
+ ~A, 
zA) (z,~ 
z,,, + z,,) 
7 ~ ($A$,,) 
(16.57) 
,~I/2 
_. ,,~1/2 
Thus XB, = XA, if ZB, - ZB = "eB (~- 7) and ZA, - ZA 
"CA (7- 
a). 
These are therefore the principal planes, 
^1 
__ 
^1 
_
_
 
zp,- 
z, = ¢& (Z- f) 
o~ 
zp,- 
ZF, = --¢& f 
Zpo - 
ZA = ¢1 (f - 
'~) 
o~ 
Zpo - 
ZFo = ¢1 f 
(~6.5s) 
With the sign convention of (16.7), we recognize that the focal lengths are 
given by 
fo = ¢}4 f 
, 
fi = ¢~ f 
(16.59) 
Condition (15.57) may then be written in the form of Newton's lens equa- 
tion. 
16.5 The existence of asymptotes 
In the foregoing sections, we have assumed that the curved trajectories 
within the field region tend to asymptotes in object and image space, "out- 
side" the field. In theory, however, the fields continue indefinitely, though 
they of course become vanishingly small, and we need to be sure that it 
is legitimate to use the concept of asymptotes. In particular, we need to 
establish conditions concerning the rate at which the field functions tend 
to zero for large values of Iz I. These questions have been explored in detail 
by Glaser and Bergmann (1950), whom we follow closely. 
If a general solution x(z) of the paraxial equation tends to an asymp- 
tote, the gradient x'(z) and the intercept of the tangent to x(z) with an 
arbitrary plane perpendicular to the axis must both tend to constant values: 
limo x'(z ) =a 
, 
lim{x(z)-z 
x'(z)} = b 
(~6.60) 
and similarly for z ~ -c¢. In reduced coordinates (15.40), these conditions 
become 
1 7 ¢'~(z)}--a 
lira=C-¼ 
('(z)--4-~ 
{ 
lirn ¢-~ 
((z) 1+~-~ 
z 
- 
= 
(16.61a) 
(16.6~b) 

240 
16. GAUSSIAN OPTICS OF ROTATIONALLY SYMMETRIC SYSTEMS 
with ~ = x¢ '/4. Since ¢ is always finite in real fields, ~ and ~' must be 
finite. The condition (16.61a) may therefore be replaced by 
D 
lim ~'(z)= A 
, 
lim ~¢'= A 
(16.62) 
~-"+OO 
Z---+OO 
¢' must therefore vanish at infinity, and we assume that it falls to zero 
faster than 1/z, which is easily justified. The second condition (16.61b) 
thus becomes 
lirn (~ - ~'z) = B 
(16.63) 
which is immediately recognizable as the condition that solutions of the re- 
duced equation (15.38) tend to asymptotes as z ~ co. Multiplying (15.38) 
by z and integrating, we obtain (with ~ in place of v) 
- ~'z = f a(z)~z dz 
so that for any upper bounds a or H 
m 
Ot 
Ot 
Ot 
lim(~-~'z)=B= 
lim /G~zdz-/G~zdz+ lim /G~zdz 
~"'* 00 
Ot -'-+ O0 
Ot -"~ O0 
Ot 
= ] G~z dz + o,--.¢¢1im f Gz(~- ~'z)dz + ~--.oolim f G~'z2 dz 
Ot 
ol 
Choosing H very large, we find 
(~6.64) 
B-/G~zdz+B lim /Gzdz-A lim / 
Gz2dzo,..-,oo 
o,.--,oo 
Ot 
Ot 
(~6.65) 
For the existence of asymptotes in general, therefore, the integrals 
O0 
f zG(z) dz 
--00 
(~6.66) 
and 
O0 
f z G(z) dz 
(~6.67) 

16.5 THE EXISTENCE OF ASYMPTOTES 
241 
must converge; the existence of asymptotes parallel to the axis (A - 0) is, 
however, guaranteed by the convergence of foo zG(z)dz alone. 
The conditions are necessary; we now show that they are also sufficient. 
We can in principle solve (15.38) by an iterative procedure, taking as first 
approximation a linear expression of the form ~0 = c~z +/3 so that writing 
~g+l "~- e(Z)~n -" 0 
(16.68) 
or 
oo 
(2~ 
oo 
z 
~ 
z 
Given the convergence of (16.66) and (16.67), we see that for z > ~ and 
large, ]]J 
G dX < 
GX dX < 
GX 2 dX =: e(~)< 1 
(16.70) 
Ol 
~ 
Ol 
~d dearly ~s ~ --, ~, ~(~) --, O. F~om (16.69), we h~ve 
/(-~ + X)G(AX + B) dX 
and since X > ~, 
(X) 
OO 
/ 
< / 
= 
(16 71 ) 
d 
0¢ 
0¢ 
and so 
O0 
O0 
O0 
O0 
Ot 
Ol 
Ot 
Ot 
From (16.70) and (16.71), we may conclude that 
I~l] ; 2(IAI + IBI) e(~) 
Iterating , we find 
2~(~) 
[~ - ~0[ _< 1~1[ 4-1~21 + .... 
(IAI + IB[) 1 - 2e(~) 
As ~ is made larger and hence as z ~ oc, e(~) ~ 0 (16.70) and ~ tends 
to the linear solution ~0. The convergence of (16.66) and (16.67), which 
we have used in this derivation, is therefore not only a necessary but also 
a sufficient condition. 
In practice, the integrals (16.66-16.67) always do 
converge: since a total system must be electrically or magnetically neutral, 
G(z) must fall off at least as fast as z -6 and any integral of the form 
f G(z)z n dz will then converge for n _< 4. 

17 
Gaussian Optics of Rotationally 
Symmetric Systems" 
Real Cardinal Elements 
Hitherto we have considered only the coordination between asymptotes. 
When this is not appropriate, in microscope objective lenses for example, 
a different set of cardinal elements must be used. After discussing these, 
we enquire whether fields exist for which fixed real cardinal elements can 
be defined for a range of object positions. This leads us to the concept 
of Newtonian imaging fields, to which Glaser attached considerable impor- 
tance (Cllaser and Bergmann, 1950, 1951; also Glaser and Lammel, 1941, 
1943); we shall follow his discussion closely. Further contributions were 
made by Funk (1950) and by Hutter (1945), who wrongly included several 
non-Newtonian distributions in the family of Newtonian fields. 
We shall 
use the rotating coordinate frame (x, y, z) without comment, and it must 
be remembered that in magnetic lenses, the surfaces x = 0 and y = 0 are 
not plane though we shall still speak of 'parallel' rays. 
17.1 Real cardinal elements for high magnification 
and high demagnification 
Objective lenses are conventionally operated at high magnification, and to 
a good approximation we may assume that the image is formed at infinity 
(Fig. 17.1). The family of rays that emerge parallel to the axis intersect 
the latter at some point Fo ~, which we call the real object focus; 
a family 
of rays emerging from the lens parallel to one another but not parallel to 
the axis intersect in the focal plane, the plane through Fo ~ perpendicular 
to the axis. This can be seen by introducing the solutions G(z) and G(z) 
of the paraxial equations already used in Section 16.2 (16.1). A family of 
rays parallel in image space may be written 
x(z) - o~G(z) + CkG(Z) 
(17.1) 
in which the ck are constants corresponding to the different rays; since 
O/ 
lirn x(z) = o~G~(z - ZFi) + ck = --~ (z -- ZFi) + ck 
(17.2) 

17.1 REAL CARDINAL ELEMENTS 
243 
Z 
f 
I 
I 
I 
I 
_ ~
~
-
"
 
z 
- ~ ~ - - - ~ ~ . . g ( z )  
Fig. 17.1: Above: The real object focus Fo ~. Rays that intersect in a point in the real 
object focal plane emerge into image space as a parallel beam, parallel to the axis if the 
point lies on the axis. 
Below: Definition of the ray g(z), which crosses the optic axis at the real image focus 
(z - z~i ). The corresponding asymptotic focus (F*) is in practice more useful. 
where ZFi and fi are the asymptotic focus and focal length, we see that 
(17.1) represents a family of rays all with image gradient -o~/fi. 
In the 
real object focal plane, z = Z'Fo , G(z) vanishes and hence 
X(Z~Fo)- ~O(Z~Fo) 
for all 
ck 
(17.3) 
The real image focus is defined to be the point at which rays, parallel to 
the axis in the plane z = Z~Fo, intersect the axis. It is now convenient to use 
a different ray pair: instead of G(z) and G(z), we employ g(z) and G(z), 
where 
9(Z'~o) = ~ 
, 
g'(Z'Fo) = o 
(17.4) 
(Fig. 17.1). In the real image focal plane z = Z~Fi, g(z) vanishes" 
9(z'F,) = o 
(17.5) 
It is easy to show that a family of rays, parallel to one another in z = Z'Fo 
but not parallel to the axis, intersect in the real image focal plane z = ZtFi . 
Such a family may be written 
m 
~(z) = ~a(z) + ~kg(z) 

244 
17. GAUSSIAN OPTICS OF ROTATIONALLY SYMMETRIC SYSTEMS 
I 
I 
~(z) 
Fig. 17.2: The real object principal plane and the real (objective) focal length. 
and in the plane z = z~i , 
x(z'F,) 
= 
We shall see in Volume 3 that the diffraction pattern of an object placed in 
the real object focal plane and illuminated with a beam of electrons parallel 
to the axis in this plane is formed in the real image focal plane; (17.6) 
expresses a fundamental property of diffraction patterns, that is, that rays 
that are parallel in the specimen plane intersect in the 'diffraction plane', 
forming diffraction spots if only isolated directions occur. 
In practice, it is more useful to know the location of the asymptotic 
image focus corresponding to the real object focus. This is the point at 
which the emergent asymptote to g(z) intersects the axis (Fig. 17.1). 
Focal lengths are associated with each of these loci. In the case of the 
real object focus, we define the real object principal plane, z = Z~po, to 
be the plane perpendicular to the axis through the point of intersection of 
the emergent asymptote to G(z) and the tangent to G(z) at z - Z~Fo (Fig. 
17.2). The real focal length f~ is then given by 
fro = Z ~Po - Z ~Fo 
(17.7) 
and since limz--.oo G - 1, we find 
1 
/'o = 
-, 
, 
G(ZFo) 
For the real image focal length f~, we have 
1 
9'(z}i) 
The Wronskian tells us that for magnetic fields 
~g, 
~' 
- 
g - const 

17.1 REAL CARDINAL ELEMENTS 
I 
t 
I 
I 
i 
,_ co÷(,_,+ 
zi 
_I 
i-" 
q 
z--Z 
245 
/r 
___ 
m 
/ 
I 
X I" 
z 
v 
Fig. 17.3" High but not infinite magnification in an objective lens. 
and by considering the focal planes, that 
1 
V(ZtFi) 
~= 
f~ 
(17.10) 
For the hybrid focal length obtained by considering the emergent asymptote 
to g(z), which we denote f[', we have 
1 
f~'= 
g'(oo) 
(17.11) 
and the Wronskian tells us that 
f~' = f" 
(17.12) 
Finally, we consider the practical situation in which a specimen is placed 
close to but not exactly at z = Z'Fo , so that the magnification is high but 
not infinite. From Fig. 17.3a, we see that the magnification is given by 
IM ]= o~o 
Zi 
,,, Zi 
~ = f, + ¢ ~ f, 
(17.13) 
in which ~ << f" and Zi is the distance to the image from Z~o. From Fig. 
17.3b, however, we can express the magnification as 
IM I 
xi 
ft o 
= -- ~-- 
(17.14) 
Xo 
ff 

246 
17. GAUSSIAN OPTICS OF ROTATIONALLY SYMMETRIC SYSTEMS 
(by similar triangles). Thus ~Zi 
= 
f~2, in which we once again recognize 
Newton's lens equation. 
17.2 Osculating cardinal elements 
The concept of osculating cardinal elements was introduced by Glazer 
(Glazer and Lammel, 1941, 1943; Glaser and Bergmann, 1950, 1951) in 
an attempt to establish whether generalized cardinal elements can be de- 
fined that collapse to the asymptotic cardinal elements when both object 
and image lie outside the field and which also allow us to use the lens 
equation in Newton's form, 
M = 
f° 
zi -- -Zfi 
= 
-
~
_
 
(~7.~5) 
Zo ---Zfo 
f i 
even when the object or the image is located in the field. These new cardinal 
elements, -ZFo, -hFi, fo and fi, will in general vary with object position Zo 
and hence with magnification M. From (17.15), we have 
1 
1_ 
?o - dzo kM] 
' 
f i 
dzo dzi 
(17.16) 
-ZFo -" Zo -- f o/M 
, -ZFi = zi + M f i 
and we regard these as definitions of new osculating cardinal elements, so 
called from their geometrical interpretation. From the relation between 
longitudinal and lateral magnification (15.60), we note that 
/i 
/o 
(17.17) 
,,:1. 
-- 
,,1 
¢/2 
Cg 
The osculating focal lengths and the positions of the osculating loci may 
be calculated by considering an arbitrary pair of solutions of the paraxial 
equation, s(z) and t(z), such that the general solution is 
t(z) 
{ 
S(Zo) t(z)} 
(17.18) 
~(z) = ~(z) + bt(z) = t(Zo) ~o + ~ ~(z) - t(~o) 
with t(zo) ~t O, Xo := X(Zo) and b = {Xo- aS(zo)}/t(Zo). 
The image 
plane conjugate to an object plane z = Zo is the plane in which the term 
multiplied by a vanishes: 
S(Zo) t(zi) = 0 
(17.19) 
~(z~)- t(Zo) 

17.2 OSCULATING CARDINAL ELEMENTS 
247 
whereupon 
The magnification is thus 
Differentiating, we find 
dM 
dzi 
Equation (17.19) gives 
dzo 
dzi 
t(zi) 
~(Z~) = t(Zo) ~o 
(17.20) 
M = t(zi) 
s(zi) 
= 
(17.21) 
t(Zo) 
~(Zo) 
1 
dt(zi) 
t(zi) 
dt(zo)dzo 
t(Zo) 
dz~ 
t~(Zo) 
dzo 
dz~ 
(17.22) 
t(Zo)~'(zi) - ~(Zo)t'(z~) 
m 
t'(zo)~(z~)- ~'(zo)t(z~) 
t(zo) t(zo)s'(zi)- 
S(Zo)t'(zi) 
(17.23) 
t(z~) t'(zo)~(~o)- ~'(zo)t(zo) 
where primes denote differentiation with respect to the argument zo and 
zi. From (17.16) and (17.22-17.23), we see that 
1 
tt(Zo)St(Zi)- 
tt(zi)st(Zo) 
f i 
t(zo)s'(Zo) - t'(zo)S(Zo) 
1 
t'(zo)s'(zi)- 
t'(zi)s'(zo) 
(17.24) 
f o 
t(zi)s'(zi) - t'(zi)s(zi) 
Likewise from (17.16) and (17.24), we obtain 
t(z~)~'(Zo) - t'(~o)~(~i) 
Z i -- ZFi -- tt(zi)st(Zo) 
-- t'(Zo)St(Zi) 
t(Zo)~'(zi) - t'(z~)~(Zo) 
(17.25) 
Zo - zFo 
t'(zo)~'(z~) - t'(z~)~'(zo) 
The geometrical meanings of these expressions can be extracted by consid- 
ering the particular ray 
~(z) = t(z)s'(zi) - s(z)t'(zi) 
(17.26) 
In the plane z = zi, ~'(zi) - 0 and so the tangent to ~(z) is parallel to the 
axis in this plane. The osculating focal length fo is simply given by 
-]o 
~(zi) 
- ~'(Zo) 
(17.27) 

248 
17. GAUSSIAN OPTICS OF ROTATIONALLY SYMMETRIC SYSTEMS 
and the position of the focus by 
~(zo) 
Zo - -hfo = ~'(zo) 
(17.28) 
An osculating object principal plane may be defined to be the point of 
intersection of the tangent to ~(z) in the object plane and the tangent in 
the image plane. It is easy to show that 
D 
-Svo - -SFo = fo 
(17.29) 
Similar relations may be established straightforwardly for the image oscu- 
lating cardinal elements. These geometrical relations are illustrated in Fig. 
17.4a. 
These osculating cardinal elements can be used to study image forma- 
tion in the neighbourhood of a given pair of conjugate points. Consider an 
object placed in a plane distant Azo from Zo; the magnification will change 
from M to M + AM. We see that 
Also 
Hence 
mzi 
z i + Azi --~Fi 
M
+
A
M
=
M
 
_ 
=- 
_ 
(17.30) 
fi 
fi 
l 
(1) 
1Azo 
(17.31) 
M+AM=- 
m 
Zi + Azi - ~Fi 
f o 
= 
(17.32) 
f i 
zo "Jc Azo ---ZFo 
and so Newton's lens equation is satisfied for the new object position, for 
small displacements Azo. 
An example of the variation of the osculating focal length as a function 
of magnification for the magnetic lens field B(z) = Bo exp(-z 2/a 2) is shown 
in Fig. 17.4b for various values of the lens strength. 
From Fig. 17.1, it is immediately clear that the osculating object focus 
corresponding to an image at infinity is identical with the real object focus 
discussed in Section 17.1 and the osculating object principal plane likewise 
coincides with the real object principal plane. 
Finally, we consider the question of whether field distributions exist for 
which the osculating cardinal elements are stationary and thus do not vary 
with object position (or magnification). This question was very thoroughly 
studied by Glaser (Glaser and Lammel, 1941), and contributions to the 

17.2 OSCULATING CARDINAL ELEMENTS 
249 
[; (z) 
Azo 
zc 
fo 
A 
ZFo 
~ 
Zpo ZFi 
- ' . , .  
v 
\ 
\ 
Fig. 17.4a: The osculating cardinal elements. 

250 
17. GAUSSIAN OPTICS OF ROTATIONALLY SYMMETRIC SYSTEMS 
1.5 
leo 
O.Ol 
I 
I 
I 
0.1 
I 
10 
100 
M 
Fig. 17.4b: The osculating focal length as a function of magnification and lens strength 
for S(z)= Boexp(-z2/a2). 1: j2/¢ = 142A~/V; 2: 285A2/V; 3: 427A2/V. 
topic have also been made by Hurter (1945) and Funk (1950). The list of 
fields given by Hutter is misleading, however, as it contains several fields 
that do not possess fixed osculating elements. The fullest account is to be 
found in Glaser (1952, Section 68), which we follow closely. 
We set out from (17.15) and render the axial coordinate dimensionless 
by writing 
:= az/a 
(17.33) 
where a is some convenient dimension of the lens and a is defined below. 
We no longer add bars to ¢ where these were necessary for z. Solving 
(17.15) for ¢i we obtain the projective relation 
~i -- ~Fi~o -- fof i -- ~Fi~Fo 
(17.34) 
¢o--¢Fo 
and shift the origin to the point midway between Fo and Fi: ¢Fo = --~Fi. 
Anticipating a result proved in Section 17.3, we set ~i - fofi equal to -a 2 
and (17.34) becomes 
¢Fi¢o -- ,,2 
~/ = 
(:[7.35) 
~o "4- ~Fi 
We now map the whole z- or ¢-axis onto a finite domain by writing 
=: a cot ¢ 
0 < ¢ < 7r 
(17.36) 
and choose w such that 
71" 
~Fi --: or cot -- 
(17.37) 

17.2 OSCULATING CARDINAL ELEMENTS 
251 
The projective relation (17.35) then becomes 
cot ¢i = cot(r/w) cot ¢o - 1 
cot ¢o + cot(r/w) 
= cot(Co + r/w) 
(17.38) 
or 
¢i = ¢o + r/w 
(17.39) 
We now substitute these transformations into the paraxial equations of 
motion; it will be sufficient to consider the magnetic case (¢ = const). 
Replacing z by ¢ (17.33 and 17.36) and introducing a new variable ~, 
x =: ~ cosec ¢ 
(17.40) 
the paraxial equation x" + (r12B2/4¢)z = 0 becomes 
~'+ {l + k2b2(acot ¢)cosec 4¢}~ = O 
(17.41) 
in which 
and 
k 2 := r12B2o a2 
4¢ 
(17.42) 
B(z) --" Bob(z) 
(17.43) 
where B0 is the greatest value of B(z) so that b(z) < 1. 
Let s(¢) and t(¢) be two independent solutions of (17.41), correspond- 
ing to the solutions xs(a cot ¢) = s(¢)cosec ¢, xt(a cot ¢) = t(¢)cosec ¢; 
then (17.15) may be written 
M- 
,~(¢i) sin Co 
t(¢i) sin¢o 
- 
(17.44) 
S(¢o) sin ¢i 
t(¢o) sin ¢i 
Setting 
(17.19) becomes 
~(~¢ot¢) 
r(¢) := ~ = xt(a cot ¢) 
(17.45) 
~(¢o)=r(¢i) 
Since ¢i = ¢o + r/w (17.39), the function r(¢) must be such that 
(17.46) 
r(¢o + r/w) = r(¢o) 
(17.47) 

252 
17. GAUSSIAN OPTICS OF ROTATIONALLY SYMMETRIC SYSTEMS 
that is, it must be periodic with period r/w. Differentiating (17.45) gives 
si 
÷= 
t2 
(17.48) 
and using the Wronskian (~t - si = const = C), we see that 
÷ = c/t 
(17.49) 
From this we can deduce that t(¢) must be semi-periodic, 
t(¢ + r/w) = -t(¢) 
(17.50) 
and the same is true of s(¢). The derivatives of these functions are also 
semi-periodic and returning to (17.41), we see that the field function 
b2(acot ¢)cosec 4¢ must be periodic with period r/w. Writing 
b 2 (a cot ¢)cosec 4 ¢ = F 2 (¢) 
(17.51) 
we can conclude that all 'Newtonian' fields, that is, fields for which the 
osculating cardinal elements are stationary (do not vary with object posi- 
tion), must be of the form 
b(acot ¢) = F(¢)sin 2 ¢ 
, F(¢ + r/w) = F(¢) 
(17.52) 
Not all such fields are Newtonian, however: this condition is necessary but 
not sufficient. Such a condition is provided by (17.47), which we may restate 
as follows: the solutions s(¢) and t(¢) of the Hill differential equation 
~'+ (1 + k2F2(¢)/~ = 0 
F(¢ + rlw) = F(¢) 
(17.53) 
must be semi-periodic with half-period r/w. (For further details of Hill 
equations, see Kamke, 1977, Section C.2 eq. 2.30; Whittaker and Watson, 
1927, Chapter XIX). 
The simplest function F(¢) satisfying (17.52)is clearly 
F(¢) = 1 
(17.54) 
giving 
b(a cot ¢) = sin 2 ¢ 
or 
B0 
B(z) - 1 4- (z/a) 2 
(17.55) 

17.3 INVERSION OF THE PRINCIPAL PLANES 
253 
This field distribution, introduced by Glaser (1940) and very extensively 
studied, is known as Glaser'8 bell-shaped model. 
We shall examine it in 
detail in Part VII, Chapter 36. 
Newtonian fields have been studied by Glaser and Bergmann (1950, 
1951); see Glaser (1952, Section 68) for more complicated forms of F(¢), 
an example of which is 
1 + k 2 
1 - C2 sin 2 w(r - ¢) 
B(acot¢)=Bocos2¢ 
1+ 
k2 
61 {1-C3sin2~(r-¢)} 2 
1 
• sin2w(Tr - ¢)} ' 
(z7.56) 
where C1, C2 and C3 are constants (some examples are shown in Fig. 17.5). 
We shall say no more about these fields here, however, because the field 
shape is a function of the parameter k 2 cx B 2/¢. Thus any given member of 
this family of fields will be Newtonian for only one value B02/¢: they are of 
academic interest only. For some values of the parameters, they appear to 
represent grossly saturated superconducting lenses quite well (see the field 
distributions in Bonjour (1974, 1975)) but there is little or no incentive 
to use models of such restricted utility. The attractive feature of model 
fields is that they enable us to study the general behaviour of a lens as all 
the parameters are varied, even if the numerical values are not exact; if a 
model is not capable of this, there is even less reason to eschew numerical 
trajectory tracing (Chapter 33). 
Another aspect of Newtonian fields, which we shall not consider here, 
concerns the existence of osculating cardinal elements of higher order, that 
is, cardinal elements for which (17.15) is valid to better than a linear ap- 
proximation. The quadratic case is mentioned by Glaser and Bergmann 
(1951) and the general case has been studied by Putz (1951), whose un- 
published work is recapitulated in detail by Glaser (1952, Section 68). 
17.3 Inversion of the principal planes 
As we have seen, the principal planes may be defined in several ways. For 
certain definitions, which will emerge from the discussion, the object and 
image principal planes are crossed in the sense that the object principal 
plane is on the image-space side of the image principal plane: zpi < Zpo. 
Consider a pair of conjugate planes Zo, zi; from (16.25), 
ZFiZo 
-- fofi 
-- ZroZri 
Zi -" 
(17.57) 
Zo -- ZFo 

254 
17. GAUSSIAN OPTICS OF ROTATIONALLY SYMMETRIC SYSTEMS 
tO 
c-- 
b 
/ 
b-- 
-~ 
,- . . . .  
a o 
(..__ 

17.3 INVERSION OF THE PRINCIPAL PLANES 
255 
N 
.-., 
~¢) 
CQ 
la.O 
i 
b 
b 
i 
I 
a:" 
z / 
 l.i 
I 
I 
I 
I 
e-- b 
----~ 
Fig. 
17.5" 
Various Newtonian fields of the form (17.56). 
(a)-(d), 
C1 - 
-0.724, 
C2 - 
1.049, 
C3 = 0.559; (e)-(h), 
C1 - 
-0.298, 
C2 - 
1.035, 
(73 - 
0.331. 
The 
parameters 
(k2,w) are as indicated. 

256 
17. GAUSSIAN OPTICS OF ROTATIONALLY SYMMETRIC SYSTEMS 
as in (17.15). Setting the origin of coordinates midway between ZFo and 
ZFi, so that 
--Zfo 
= Zfi =: Z F > 0 
(17.58) 
we find 
ZFZo 
-- (AY~ -- Z~) 
(17.59) 
zi 
Zo +ZF 
This projective transformation must have real or imaginary self-correspond- 
ing points, that is, points for which zi = Zo =: ~, say. For this 
~2 __ --Afi 
"4- Z2F 
(17.60) 
If both object and image are real, there can be no self-corresponding points: 
a ray setting out from the axial point in z = Zo cannot intersect the axis 
again in this plane. The self-corresponding points are therefore imaginary 
and 
fofi - z~ > 0 
(17.61) 
If fo = fi =: f we may conclude that 
ZF < f 
(17.62) 
since ZF > 0 by hypothesis and the fact that electron lenses are convergent 
implies that f > 0 for single stage imaging. But 
Zpi = --Zpo -- ZF -- f < 0 
and so 
If yo # Yi, we have 
and since 
we may write 
or 
or 
Zpi < Zpo 
(17.63) 
Z2F < fofi 
(17.64) 
!(f ° _ f~)2 > o 
4 
1 
z~ < ~(f~o + 2fofi + f?) 
1 
0 < ZF < -~(fo + fi) 
(17.65) 
1 
ZPi =ZF -- fi < -~(fo -- fi) 
1 
Zpo = --ZF + fo > -~(fo -- fi) 

17.4 APPROXIMATE 
FORMULAE FOR THE CARDINAL ELEMENTS 
257 
so that finally Zpo > Zpi as before (17.63). 
The above proof is valid only if the object and image are real and if the 
image is formed in a single stage: there must be no intermediate image, for 
otherwise we could not take the square roots (17.62-17.65). This inversion 
of the principal planes was first found experimentally, by Ruska (1934b). 
A situation which appears to conflict with this has been found by Sturrock 
(1951, 1955); we return to this in Part VII, where we examine field models. 
17.4 Approximate formulae for the cardinal elements: the thin- 
lens approximation and the weak-lens approximation 
Simple expressions for the focal lengths and positions of the foci can be 
obtained if the lens field is weak. We shall find that all weak lenses can 
be treated as thin lenses, that is, as lenses in which the principal planes 
coincide when ¢i = ¢o, but the converse is not necessarily true; when 
¢i ~ ¢o, we are obliged to define thin lenses slightly differently. We set 
out from the reduced equation (15.38) in the form v" = -Gv and integrate 
twice to give 
z -/Gvd¢=: ' 
Gl(z) 
v'(z) =a0' 
a0 -- 
z0 
v(z) = ao + a~o(Z -- Zo) -- / G1 (() d( 
~r 
gO 
which may be integrated by parts to yield 
z 
zo) - /(z - ¢)a(()v(() d( 
(17.66) 
db 
v(z) = ao + ao I(Z 
qlf 
Zo 
which is a Volterra-type integral equation. A formal solution is given by 
the Picard-LindelSff iterative procedure 
Z / 
v~÷~(z) = ao + ao(Z - Zo) - 
(z - ¢)a(¢)v~(~) 
de 
zo 
for 
n- 0,1,... 
(17.67) 
Suppose now that 
(X) 
f 
1 
= := 
G(z) dz << 
f 
--(:X) 
(17.6s) 

258 
17. GAUSSIAN OPTICS OF ROTATIONALLY 
SYMMETRIC 
SYSTEMS 
where L is some length characteristic of the lens producing the field ¢(z) or 
B(z), typically a gap or bore or total length. For convenience, we set the 
origin at the 'centre of gravity' of G(z), so that its first moment vanishes: 
O0 
f zG( z ) dz = O 
--00 
(17.69) 
We denote the second moment or "moment of inertia" of G(z) by D: 
OO 
D := f 
z2G(z) dz 
--00 
(17.70) 
Clearly 
N 
D << L << f 
(17.71) 
Let us now evaluate Vl (Z) from (17.67), taking as zero-order approximation 
vo(z) = ao + a~o(Z - zo). In field-free object space, we have 
Vl(Z ) -- ao 2t- ato(Z -- Zo) 
(~7.7e) 
and in field-free image space, 
v~(z) = ao + a'o(Z - ~o) + (aloZo - ao )z + a~oD 
(17.73) 
Neglecting the final term, we see that incident and emergent rays intersect 
in the centre-of-gravity plane, z = 0. The focal lengths and loci are easily 
found by expressing the above relation between asymptotes in matrix form 
and comparing with (16.12). In the plane zl = z2 = 0 (Du~ek matrix), we 
have 
(1 
,, (i)t 
-1/] 
1 
• (0), 
v 1 
v 1 
• 
\ -p/y~ 
-pzFo/y, 
v~ °)' 
(17.74) 
where p = ((~i/(~o) 1/4, SO that 
y~ = p] 
, 
fo = -ZFo/p = ]/p 
zF, = Yi/p = ] 
, 
Z~o = -fi/p 
= -] 
(17.75) 

17.4 APPROXIMATE FORMULAE FOR THE CARDINAL ELEMENTS 
259 
If ¢i = ¢o (p = 1), the lens behaves like a thin lens situated at the centre 
of gravity of G(z), the principal planes (16.7) coinciding in this plane as 
expected. If, however, ¢i # ¢o, the object and image focal lengths are 
related to ] explicitly as follows 
= 
, 
= 
] 
(17.76) 
and so fofi = ]2: the intermediate quantity ] (16.19a)is the geometric 
mean of the object and image focal lengths_ The foci are equidistant from 
the centre-of-gravity plane: ZFi = --ZFo = f. The principal planes do not, 
however, coincide in this plane but are separated by a distance 
ZPi 
-- ZPo 
-- ZFi- 
fi 
-- ZFo 
-- fo 
-- 2]- fi - 
fo 
(17.77) 
Despite this, the lens is still regarded as thin and we have therefore proved 
that every weak electron lens can be regarded as a thin lens, where the 
criterion for weakness is (17.68). 
In the cases of magnetic lenses and electrostatic lenses, we obtain the 
following expressions: 
Magnetic lenses 
We set ¢- const in G(z) and find 
(20 
1 _ 1 _ )72 /B2(z)d 
z 
f 
f 
4~ 
(17.78) 
This expression, first derived by Busch (1927), is known as Busch's formula 
(cf. Ollendorff and Wendt, 1932). 
Electrostatic lenses 
We now set B = 0 in G(z) and obtain 
¢, 2 
4 
(17.79) 

260 
17. GAUSSIAN OPTICS OF ROTATIONALLY SYMMETRIC SYSTEMS 
or nonrelativistically (e¢ << 1, ¢ ~ ¢)" 
3 
--00 
1 
3 (~o)~ f~ '2 
~ =1"-'6 N 
-~ dz 
~00 
(17.80) 
We note that it is important to derive (17.79) or (17.80) from the reduced 
equation. If ordinary coordinates (x, y, z) are employed, it is easy to obtain 
the wrong result; this point is discussed by Sturrock (1955, p.15ff.), who 
shows how the confusion arises. 

18 
Electron Mirrors 
18.1 Introduction 
In the foregoing discussion of the paraxial properties of rotationally sym- 
metric systems, we have assumed that not only do the electron trajectories 
remain in the vicinity of the axis but that their gradients also remain small. 
If, however, the potential barrier in a retarding electrostatic lens is suffi- 
ciently high to prevent electrons from passing, the latter will be returned 
towards object space and the lens will have a mirror action. We shall see 
that to a first approximation, which it is convenient to call the paraxial 
approximation, the familiar cardinal elements can again be used for such 
contracurrent or catoptric systems, but special precautions must clearly be 
taken in the vicinity of the turning point, where the gradient is locally very 
large, passing through infinity. 
Several ways of circumventing this difficulty have been proposed, two 
of which have been studied in detail. In each case, the distance along the 
optic axis, z, is replaced by some other independent variable, preferably 
one which, unlike z, increases monotonically as the electron proceeds and 
hence does not lead to infinite gradients when the electron turns round. 
The most obvious choice is the time, or a quantity very closely related to 
it (Recknagel, 1936, 1937; Nicholl, 1938; Regenstreif, 1951; Septier, 1953, 
1960; Ehinger and Bernard, 1954; Schiske, 1957). Another possibility is 
to use a transformation introduced by Hahn (1965) as a means of unifying 
lens studies, in which the entire z-axis is mapped onto a finite region; its 
suitability for the study of mirrors is pointed out in Hahn (1971). Another 
suggestion comes from Bernard (1952), who writes s 2 = -z, with the origin 
of z at the point of reflection of an electron on the axis. The incident part 
of the trajectory then corresponds to s < 0 and the reflected part to s > 0; 
dx/ds and dy/ds do not become infinite. 
Another transformation that has been extensively studied employs 
cartesian coordinates but in such a way that the 'paraxial' equations re- 
main valid. It is still required that the charged particles remain close to 
the axis but not that their gradients remain small (Kel'man et al., 1971, 
1972a,b, 1973a,b; Daumenov el al., 1978; Ximen el al., 1983). We discuss 
this theory, which has been developed in considerable detail, in Section 18.3. 

262 
18. ELECTRON MIRRORS 
We assume throughout this Chapter that although the z-component 
of the electron velocity is reduced to zero by the potential barrier in the 
mirror, the same is not true of the retarding field: Ez ~- 0 in the plane in 
which the electron is instantaneously stationary. In the exceptional case in 
which this does occur, the electrons are trapped; this remote contingency 
is discussed b~, Recknagel (1937). 
Electron mirrors are not the only systems in which the gradients of 
electron trajectories become too large for the conditions of paraxial imagery 
to be satisfied. In electron emission structures--guns, cathode lenses and 
image converters in particular--the electron velocity is locally small and the 
gradients steep. Guns are dealt with separately in Part IX. The methods 
of Kel'man et al. and Hahn have been used to study cathode lenses in 
some detail and any technique that enables mirrors to be analysed is in 
principle equally suitable for cathode lenses, in which the rays resemble 
those returning from a mirror except that the equipotentials are determined 
by the cathode surface. We now say a few words about the instrumental 
aspect of these various devices. 
Electron mirror8 are mainly used for reflecting the particle beam in 
certain types of energy analyser and mass spectrometer. A typical example 
of the former is the analyser built by Castaing and Henry (1962), which 
is shown in Fig. 18.1. Here, the direction of the beam is reversed by a 
repulsive electrostatic field, thus causing the particles to pass twice through 
the magnetic deflection field. The points of reflection are located somewhere 
in the field, away from any material surface. 
Electron mirrors are also the essential elements of mirror or reflection 
electron microscopes. Here the beam direction is reversed just in front of 
the surface of the specimen, and contrast is produced in the image by local 
variations of some property of the specimen surface: variation in height or 
magnetic field distribution or electrostatic potential. For a detailed review, 
see Bok et al. (1971). 
In another device (Lichte, 1983), the electron mirror is used as an 
interferometer (Fig. 18.2). Here, the electrons come so close to the ma- 
terial surface that the reflected beam is modulated by any roughness, as 
in the mirror microscope. The height distribution over the surface is now 
determined by analysing the interference pattern obtained by superposing 
a uniform beam on the reflected beam. Since this effect cannot be under- 
stood without going beyond geometrical electron optics, we defer further 
discussion to Volume 3. 
Cathode lenses are employed in electron emission microscopes and in 
image-converters. 
Emission microscopes are mainly employed in metal- 
lurgical investigations. A typical cathode lens is shown schematically in 
Fig. 18.3. Here, the specimen acts as a (cold) cathode and electrons are 

18.1 INTRODUCTION 
< 
Ill 
-~ Objective 
Mirror 
~ ~ 
Magnetic 
~l 
~l 
prism 
I 
Aperture stop 
--- 
~,, 
~ Intermediate lens 
263 
Fig. 18.1" Combination of electrostatic mirror and magnetic prism that permits energy- 
filtered images or energy-loss spectra to be formed. 
ejected from it by lateral bombardment with electrons (MSllenstedt and 
Diiker, 1953), photons (Koch, 1967) or ions. The local intensity of the 
ensuing electron emission depends to some extent on the intensity of the 
irradiation, which is assumed to be practically uniform over the area illu- 
minated, and depends principally on material properties such as the work 
function. The electrons emitted are then used to form an image of the cath- 
ode surface on a recording screen, where the distribution of the properties 
that determined the image is now observable. Here, therefore, the cathode 
plays two roles: first, it serves as an electron emitter, and in addition, it 
forms the first electrode of the electrostatic lens in front of it. Such a lens 
is often known as an 'immersion objective'. 
In image converters (Fig. 18.4), the function of the cathode is simi- 
lax. Here, the cathode is a thin spherical layer, transparent to infrared or 
visible light. The inner surface of the cathode is coated with a layer of 
conducting material with a low work function so that when light falls on 
the cathode, photoelectrons are emitted. By imaging the cathode surface 

264 
18. ELECTRON MIRRORS 
electron source 
oOiect 
d 
.1..._..o.:._ 
electron mirror 
] 
E 
/t, 
! 
biprism I 
magnetic prism 
intermediate image 
biprism II 
Fig. 18.2: The arrangement of prism, mirror and biprism in an electron mirror interfer- 
ence microscope. The presence of the two biprisms enables phase differences between the 
partial waves r and o to be measured interferometrically. Courtesy of H. Lichte (1983). 
onto a viewing screen with electrons of sufficiently high energy, the feeble 
light image projected onto the cathode surface can be intensified. These 
introductory remarks are merely intended to give the reader a general idea 
of these devices; a few more technical details will be found in Chapters 37 
and 38. 
18.2 A time-like parameter as independent variable 
A common feature of electron mirrors and cathode lenses is the existence of 
a surface of vanishing acceleration potential. In the vicinity of this surface, 
the electrons travel very slowly and the angle between their trajectories 
and the optic axis can take any value. This means that the conventional 

18.2 A TIME-LIKE PARAMETER AS INDEPENDENT VARIABLE 
265 
Cathode 
bVehneit 
Anode 
Aperture 
c! 
-y 
Screen 
Fig. 18.3: Electrostatic equipotentials and electron trajectories in an electron microscope 
with a cathode lens. 
V 
V[2 F'#,stanode I 
• 
'~ 
Cathode 
.~~'~~~ ~ 
-~°~ 
~L'k\ l ~  
J 
~ Second kan:de screen 
Fig. 18.4: An electrostatic three-electrode image converter for infrared light. 
theory of electron lenses, which is based on the assumption that the gradient 
remains very small, cannot be applied. 

266 
18. ELECTRON MIRRORS 
One convenient way of overcoming this difficulty is to employ the ray 
equation in its parametric form; here, this means that we adopt the paraxial 
form of the Lorentz equation. Similar theories have already been developed 
by Glaser (1952) and by Zworykin et al. (1945). We shall use as curve 
parameter not the time t but the variable a introduced in Section 3.2. We 
recall that a is proportional to the proper time t', da/dt' = 2r/U 1/2 or 
da/dt = 27r/U 1/2. Since the kinetic energy of the electrons is low in all 
systems with mirrors or cathode lenses, a nonrelativistic theory is quite 
sufficient. 
We set out from (3.12). We assume that the beam stays in the vicin- 
ity of the optic axis of the rotationally symmetric system, even though its 
gradient may become large. On substituting the usual paraxial approxi- 
mations 
1 
¢(X, Y, Z)= ¢(Z)- ~ ¢"(Z)(X 2 + y2) 
(18.1) 
(lS.2) 
into (3.12) and truncating the resulting equations of motion after the linear 
terms in X and Y, we find 
¢" 
1yB'Z) 
(18.3a) 
2 = -4-ff x - ~u-½ (?B + 
¢" 
1 
= 
4U Y + 71U-½(XB + 
XB'Z) 
(18.3b) 
¢, 
2 = -- > o 
(18.3~) 
2U- 
where primes denote differentiation with respect to Z, while dots denote 
differentiation with respect to the curve parameter a. Here all coordinates 
referring to the laboratory frame are denoted by capital letters. The con- 
stant U is an arbitrary positive normalization potential, preferably the ac- 
celeration potential at the anode of the device. Equation (18.3c) is readily 
integrated; we first obtain 
= 
+ e 
)lU 
(lS.4a) 
where ~T is an arbitrary constant and this can be formally integrated to 
give 
! 
= ~o + 
Ul(¢(z) + ¢~) 
dZ 
(lS.4b) 

18.2 A TIME-LIKE PARAMETER AS INDEPENDENT VARIABLE 
267 
From the numerical standpoint this expression is unfavourable, since the 
integral is improper, the radicand being singular at the point of reversal. It 
is far more convenient to solve (18.3c) directly with the appropriate initial 
conditions. Equations (18.3a,b) can be further simplified by introducing 
the familiar rotating frame 
X + iY = (x + iy)exp{iO(Z(a))} 
(18.5) 
The necessary calculations are now quite similar to those for ordinary round 
lenses; the only novel feature is that we have to bear in mind that Z = Z(a) 
in the necessary differentiations. As in the theory of round lenses, the angle 
6 of rotation is chosen so that the derivatives ~ and ~ disappear from the 
equations of motion. This implies 
1 
0(z(~)) = -~,Tu-½ B(Z(~)) 
(18.6) 
which can be integrated by means of (18.4a): 
,7 f B(Z){¢(Z) + cr} -~ dz 
o(z) = i 5 
(18.7) 
This result is essentially the same as for round lenses; the normalization 
constant U has cancelled out, as it must. 
After some elementary calculations making use of (18.6), the equations 
of motion for x and y are found to be 
1{ 
y2B2 } 
~(~) + ~ 
¢"(z) + 
(z) ~(~1 - 0 
1 { 
r/2B2(Z) } 
//(~) + ~ 
¢"(z) + 
v(~) = 0 
(18.8a) 
(lS.Sb) 
These are uncoupled but depend on the solution Z(a) of (18.3c), which 
has to be obtained first. We now introduce a pair of fundamental solu- 
tions, which will enable us to establish the paraxial properties of mirrors 
and cathode lenses. First, we have to select some nominal value Z0 for 
the 'turning point' at which Z vanishes, other values then being regarded 
as aberrations. Without loss of generality we may choose the coordinate 
system such that Z0 = 0 and the origin of potential such that ¢(0) = 0, 
so that q>T = 0 in (18.4a); furthermore we choose the time origin so that 
a0 = 0 in (18.4b). The corresponding particular solution of (18.3c) will be 
denoted by z(a). It has the symmetry property 
z(-a) = z(a) 
for all 
a 
(18.9) 

268 
18. ELECTRON MIRRORS 
which means that the domain a < 0, ~ < 0 corresponds to motion towards 
the reflection surface, while a > 0, i > 0 corresponds to motion after the 
reflection. In cathode lenses only this latter domain has a physical meaning. 
In the vicinity of the turning point, the series expansion 
9090~ 
+ o(~,) 
(~8.~0) 
;(~) = Cg~ 
-,-,, 
4U 
~ 96U 2 
is valid. 
Substituting Z - z(a) in (18.8a,b), we find that 
+ F(a)x = O , ~j + F(a)y = O 
(18.11) 
with a new coefficient function 
1 {¢"(z(~)) + ~ ~B~ 
} 
f(a) "= ~ 
(z(a)) 
(18.12) 
A convenient pair of linearly independent solutions, which we adopt as the 
fundamental solutions, are u(a) and v(a), satisfying the initial conditions 
~(0) = ~(0) = ~ 
, 
~(0) = v(0) = 0 
(~8.~3) 
in the mirror plane. Obviously, besides (18.9) and as a consequence of this 
choice and of (18.13), the following symmetry properties must hold: 
F(-a)=F(a), 
u(-a)=u(a), 
v(-a)=-v(a) 
(18.14) 
The general form of these solutions is sketched in Figs 18.5a,b; in the 
parametric representations (Fig. 18.5b) there is no singularity or ambiguity. 
We now investigate image formation by an electron mirror. Consider 
an object plane, situated at z = Zo >_ 0. First, we have to determine the 
corresponding parameter ao _ 0 from the inverse function a = a(z) ~ 0; 
there is always exactly one such solution. We next introduce new funda- 
mental solutions g(a), h(a) adapted to theparticular object plane. These 
must satisfy equations of the form of (18.12) with the initial conditions 
9(°°) = h(~o)= ~ 
, 
~(~o)= h(~o) = 0 
(18.15) 
instead of (18.13). The linear relations between g, h and u, v are given by 
g(~) = 6(~o)=(~) - 6(~o)~(~) 
h(,,) = -V(~o)U(O) + u(~,o)V(,,) 
(18.16a) 
(~8.16b) 

18.2 A TIME-LIKE PARAMETER AS INDEPENDENT VARIABLE 
269 
U~V 
Z 
0 
_ _  
~ U, VjZ 
. 
5 
Fig. 18.5: Appearance of the fundamental solutions u and v (a) as functions of the 
axial coordinate z and (b) in parametric form together with z(a). 
The Wronskians of both pairs of solutions are equal to unity, as can easily 
be verified. 
The particular trajectory with the initial velocity components 
~(Oo) := ~o 
, 
#(.o):= #o 
, 
~(~o):= -x/¢(zo)lU 
(18.17a) 
at the starting point 
• (oo) = ~o 
, 
V(.o):= vo 
, 
z(oo):= zo 
(ls.17b) 
is given by z = z(a) and 
x(a) - xog(a) + ]coh(a) 
y(a) = yog(a) + ~loh(a) 
(18.18a) 
(18.18b) 
Just as in the case of ordinary round lenses the position of the conjugate 
image plane is determined by the next zero of the function h(a): h(ai) = 0 
with ai > ao. Usually the focusing fields are so weak that ai > 0, which 
means that the image is formed after the reflection. The position of the 
image plane is then given by zi := z(ai) and the lateral image coordinates 
are (irrespective of ~o and Yo) 
xi = xog(ai) 
, 
yi = yog(ai) 
(18.19) 

270 
18. ELECTRON MIRRORS 
f, 
to" ~ 
~ u(z) 
. 
<-. Z:Z a 
0 
Z 
cathode 
aperture 
Fig. 18.6: Appropriate location of an aperture in a cathode lens. 
Thus g(ai) is the lateral magnification. In a magnetic field, the image is 
rotated relative to the object; from (18.6) the corresponding angle is seen 
to be 
o'i 
(18.20) 
fro 
From this formula, which is quite unambiguous, it is obvious that the 
sense of rotation is maintained after the reflection, whereas (18.7) needs 
more care. 
Image formation by a cathode lens is a special case of the foregoing 
situation. In this case the object is located in the cathode plane zo = 0; 
hence ao = 0 and consequently 9(a) - 
u(a), h(a) =_ v(a), as is obvious 
on comparing (18.13) with (18.15). Other than this simplification, there is 
nothing new about image formation by a cathode lens. A narrow aperture 
is often brought into the beam in order to filter out electrons with very 
large lateral velocity components. In this way the chromatic aberration of 
the cathode lens can be reduced, but this can only be fully understood after 
studying the aberrations. Here we merely point out that the appropriate 
plane for this aperture is given by 
z. "= z(a,) 
with 
u(a.) = 0 
(18.21a) 
as sketched in Fig. 18.6. The lateral coordinates 
x. = koV(aa) 
, 
Ya " ~loV(a.) 
(18.21b) 
are then independent of Xo and yo, so that there is no vignetting. 
We could go on to define asymptotic cardinal elements -- loci, prin- 
cipal planes and focal lengths ~ exactly as for round lenses. If we adopt 
the same sign conventions in the definitions, namely zfi -- zpi =: .fi and 
ZPo--ZFo 
"--" fo (16.7), we find that now fi = -fo =: .f, so that with (16.25) 
Zi -- ZFi =-riM 
Zo-- ZFo = fo/M 

18.3 THE CARTESIAN REPRESENTATION 
271 
we have 
(zi - ZFi)(Zo -- ZFo) - --fofi -- f2 
If we compare this with the treatment of mirrors in light optics (e.g. Born 
and Wolf, 1959 Section 4.3, where the sign convention for fi is the opposite 
of that adopted here), we see that convergent mirrors correspond to positive 
values of fo and hence negative values of f; for divergent mirrors, fo < 0 
and hence f > 0. 
18.3 The cartesian representation 
Although the trajectories reverse their direction and have large gradients in 
the vicinity of the turning point, a paraxial ray equation can nevertheless 
be derived in the conventional cartesian form. This approach has been 
investigated by Kel'man et al. (1971, 1972a,b, 1973a,b), who first used it to 
facilitate the study of cylindrical mirrors (1971, 1972a,b) and subsequently 
employed it to analyse rotationally symmetric mirrors including magnetic 
fields (1973a,b). Their theory can be derived from a variational principle, 
as shown in detail by Daumenov et al. (1978); we shall return to this in 
Chapter 28 in connection with the aberrations. Here we present a very 
brief derivation, setting out from (18.8a,b). 
Our aim now is to eliminate the time-like parameter a from (18.8a,b), 
which can be done with the aid of (18.4a). It is helpful to introduce an 
axial potential 
V(Z) = ¢T + ¢(Z) 
(18.22) 
which depends on the particle energy e&T, as does the turning point Z0 at 
which it vanishes. With 
d_z 
d 
d 2 
2 d 
Z2 d2 
da 
-~ 
' 
da 2 - 
-~ + 
dZ 2 
and using (18.3c), (18.4a) and (18.22) we find 
d ~ 
V(Z) d 2 
V'(Z) d 
= 
I 
da 2 
U 
dZ 2 
2U 
dZ 
and so from (18.8a,b) 
v(z)~"(z) + ~v'(z)~'(z) + -~ 
(z) + 
B2(Z) 
~(Z) = 0 
(18.23a) 
} 
v(z)u"(z) + v'(z)u'(z) + -~ 
(z) + 
(z) 
u(z) = o 
(~s.23b) 

272 
18. ELECTRON MIRRORS 
These paraxial ray equations have the same formal structure as those for 
ordinary round lenses. The novel fact here is that very small values are re- 
quired only for x 2 + y2, whereas the gradients may be arbitrarily large. The 
range of validity of the paraxial approximation has clearly been extended. 
On the other hand, (18.23) also have disadvantages. A first difficulty 
is the fact that for a polychromatic beam, it is not the axial potential 
¢(z) alone that is involved but the shifted potential V(Z); the turning 
point Z0 at which V(Zo) = 0 is energy-dependent and is a singularity. A 
second drawback is that the familiar numerical solution techniques cannot 
be employed in the vicinity of a singularity and special series expansions 
have to be evaluated instead. A third disadvantage is the fact that when 
tracing rays through mirror fields, great care must be taken over the signs 
of some of the variables, whereas in the parametric form of the theory the 
correct signs are obtained automatically. The numerical solution of (18.23) 
is thus distinctly inconvenient. 
We now study the vicinity of the singularity for rays with the nominal 
energy. For these, we have 
OT = O 
, 
Zo = O 
, 
Z = z 
, 
V(Z) = ¢(z) 
(18.24) 
and since ¢(0) = 0, we can introduce a power series expansion 
oo 
I 
Z2 All 
Z n 
¢(z) = ~ ~. ¢(")(0)= z¢0 + 7~0 +... 
n=l 
(ls.25) 
For the magnetic field, a power series expansion 
o o  z"/~(.) 
fl(z) := r/2B2(z)= E 
~.. 
(0) = ~o + z~ +... 
n--~0 
(18.26) 
is introduced. It is clear that each of the differential equations (18.23a,b) 
must have two linearly independent solutions and that the general solutions 
are obtained by appropriate linear superpositions, but it is not possible to 
represent the latter in terms of initial conditions referring to the singular 
plane z = 0. In view of this situation we can proceed in the following way. 
One particular solution p(z) of (18.23) with (18.24), (18.25) and (18.26) 
is found by introducing an ordinary regular power series expansion: 
co Zn 
Z2 
p(z) = ~ ~ I,(")(Ol = po + ~p'o + ~p~ +... 
n--O 
(18.27) 

18.3 THE 
CARTESIAN 
REPRESENTATION 
273 
Substituting this together with (18.25) and (18.26) into the differential 
equation 
1 
1 {¢"(z)+ Z(z)}~(z) = 0 
¢(z)~"(z) + ~¢'(zl~'(z) + 
(18.28) 
with w(z) = p(z) and collecting up all terms with equal powers of z, we 
obtain linear recurrence relations for the coefficients p(")(0). The beginning 
of this sequence is 
, 
p0(¢g + Z0) 
P0 =-- 
2¢~ 
p~ = _p~(3¢~' + ~0) + p0(¢~' + ~) 
6¢~ 
(18.29) 
Clearly, only the initial coordinate p0 = p(0) can be prescribed arbitrarily; 
the slope p~ is then already determined. 
A second and linearly independent solution w(z) =_ q(z) of (18.28) is 
obtained in the form of a fractional power series expansion 
( 
) 
q(z) = z] E 
~ a(n)(0)= z½ ao + za' o + -~a'~ +... 
(18.30) 
n--0 
We again find a sequence of linear recurrence relations, the opening terms 
of which are 
~¢~, 
, 
a0(~ 
+ ~0) 
a0 -- m 
a~(~¢~ + ~0) + a0( ~-~''' 
(lS.31) 
,, 
~0 +~) 
a 0 : m  
~0¢~ 
The general solution now has the form 
w(z) = Ap(z) 4- Bq(z) 
(lS.32) 
the two branches of which, distinguished by the sign of the second term, 
have to be joined together appropriately at z = 0. 
The physical meaning of this solution is sketched in Fig. 18.7. For 
very small positive values of z the lowest powers in the series expansions 
dominate, hence w(z) = Apo 4-Baozl/2. This corresponds to a parabolic 
trajectory caused by uniform acceleration. In this lowest order approxima- 
tion the tangents to trajectories in a given plane z = L > 0 all intersect in 
the 'mirror plane' z = -L. This is, of course, only true for vanishing axial 
velocity ~ in the starting plane z = 0, which is clearly an idealization. A 

274 
18. ELECTRON MIRRORS 
I 
I 
._..-- --- --- 
I 
I 
I 
, 
I 
---'----4 
I 
I 
-..----""2" 
J 
"""-- 
I 
I 
t 
I 
-L 
0 
L 
Fig. 18.'/: Trajectories approximated by parabolae in the zone 0 < z < L. The tangents 
at 
z = L all intersect in z = -L. 
more realistic situation will be studied in Chapter 28, which is concerned 
with the aberrations of mirrors and cathode lenses. 
For numerical evaluation, this form of the trajectory equation is far 
less convenient than the parametric form dealt with in the previous section. 
In the case of a mirror, one has first to solve (18.28) for z decreasing from 
z0 to a small value L. A system of linear equations for p0, p~, p~, a0, a~, 
a~, arising from the requirement that as many derivatives as possible must 
be continuous at z = L, must then be solved. The trajectory, given in the 
form of a series expansions, then has to be traced until it again reaches the 
plane z = L. The numerical tracing then has to be resumed. This is a 
fairly high price to pay for any conceptual advantages gained by avoiding 
the parametric representation. Moreover we shall see in Chapter 28 that 
the presence of aberrations renders the original form z = z(z), y = y(z) 
of the trajectories untenable; the parametric form then becomes clearly 
advantageous. 
18.4 A quadratic transformation 
We mention briefly one other transformation designed to avoid the prob- 
lems arising from the large ray gradients at the turning point. This was 
introduced by Bernard (1952), who wrote 
z~ - z =: s 2 
(18.33) 
for an electron initially travelling in the negative z direction and reflected 
at z = z.. The negative sign is to be taken before the square root for the 

18.4 A QUADRATIC TRANSFORMATION 
275 
incident part of the trajectory and the positive sign for the reflected part, 
which already shows that this transformation is by no means ideal. If we 
consider only the electrostatic case (B = 0), (18.11) becomes, after some 
calculation, 
ds 2 + 
2¢ ds 
s 
-~s + -~ 
ds 2 
s ds 
x=0 
(18.34) 
with a similar equation for y(s). The term in dx/ds is eliminated by writing 
~ = ¢¼ s-½ x 
(18.35) 
whereupon (18.34) reduces to 
d2~ 
ds 2 ~- G5 = 0 
(18.36) 
with 
G(s) = 
¢ 
4s 2 
Equation (18.36) may then be analysed in the usual way and cardinal ele- 
ments defined. 

19 
Quadrupole Lenses 
Hitherto, we have been studying systems with an axis of rotational sym- 
metry~ which are by far the most common in electron optical devices in 
which the electron accelerating voltage does not exceed one or a few hun- 
dred kilovolts or, exceptionally, a few megavolts (in practice, 3 or 4 MV 
maximum). At higher voltages, focusing elements with lower symmetry are 
more commonly used, and, in particular, elements with planes of electri- 
cal symmetry forming quadrupoles. These possess the property of 'strong 
focusing', by which we mean that their fields exert a force directly on the 
electrons, towards or away from the axis, whereas in round magnetic lenses, 
the focusing force is more indirect, arising from the coupling between B z 
and the azimuthal component of the electron velocity. Quadrupoles have 
also been very thoroughly studied as elements for use at conventional ac- 
celerating voltages for a quite different reason. We shall see in Section 24.3 
that one of the most undesirable aberrations of round electron lenses cannot 
be eliminated in any straightforward manner but can in principle be can- 
celled by introducing quadrupoles and octopoles into the system. This has 
provided the incentive for exhaustive studies of quadrupole lens properties, 
comparable in thoroughness with those on round lenses. In this chapter, 
we derive the paraxial equations of quadrupole systems, and introduce the 
notion of an orthogonal system. 
A brief survey of the history of quadrupole studies is to be found at 
the beginning of Chapter 39. Here we merely remark that although strong 
focusing at high energy and aberration correction have been the principal 
stimuli for research on quadrupoles, their properties were very fully ex- 
plored long before either of these applications was known: the first study, 
which was thorough and meticulous, appeared as a Berlin dissertation in 
1943 (Melkich, 1947). 
In the discussion of Section 7.2.3, the terms in 2~ in the potential 
expansion (7.37 or 7.59) and their magnetic counterparts (7.43-7.45) were 
described as quadrupole terms. Here we use the term in a slightly less 
restrictive sense: a magnetic or electrostatic quadrupole is characterized by 
the presence of two planes of symmetry in the potential or field (Fig. 19.1), 
and rotationally symmetric fields as well as octopoles (and higher order 2n- 
poles) are not excluded. From (7.36), we see that the term in p2(z) describes 
a potential for which the planes x = 0 and y = 0 are symmetry planes, 

19.1 PARAXIAL EQUATIONS FOR QUADRUPOLES 
277 
O(x, y,z) = ¢(:i=x, ::t=y,z), and a typical electrostatic quadrupole thus has 
the form shown in Fig. 7.2 and Fig. 19.1a. The term in q2(z) simply 
corresponds to a similar quadrupole inclined at 45 ° to that of Fig. 19.1a. 
In the magnetic case, the planes x = 0 and y = 0 are planes of symmetry 
for P2(z) and planes of antisymmetry for Q2(z). For a field described by Q2 
only, Bx(x, y, z) = Bx(-x, y, z) = -B,.(x,-y, z) = -B~(-x,-y, 
z), with 
analogous relations for B~ (Fig. 19.1b). We shall learn that uncoupled 
equations can be obtained if the quadrupoles are orientated with respect 
to the coordinate axes in such a way that q2 = 0 and P2 = 0, that is, as 
shown in Figs 19.1. 
19.1 Paraxial equations for quadrupoles 
We set out from the general case in which rotationally symmetric magnetic 
and electrostatic fields may be present as well as the quadrupole fields 
themselves. The fields are thus characterized by six axial functions, ¢(z) 
and B(z) for the round lens components, p2(z) and q2(z) for the electro- 
static quadrupoles and Q2(z) and P2(z) for the magnetic quadrupoles. We 
substitute the field expansions (7.36) and (7.43-7.45) into the function M, 
M - -M/(2moe) 1/2 (15.23) as in Section 15.2 and expand M as a power 
series in X, Y and their derivatives. We find 
M (°) = ¢½ 
M(2) _ 
7¢" 
/( "/P2 
1 
) 
y2 
- 
85, 
2 
) 
( 7 q 2 )  
1 
( X '2 
y'2 
+ 
-~2 +,?P2 XY+-~¢½ 
+ 
) 
- I~?B(XY'- X'Y) 
2 
(19.1) 
The term in XY ~ - X~Y can be removed by introducing the rotating co- 
ordinate system employed in connection with round magnetic lenses (15.7, 

278 
19. QUADRUPOLE LENSES 
I F 
I~1 
I1 
/~ 
' 
\ 
I 
?01 "-I-""- 
~. 
-
:
~
~
 
.............. ~~i!i:~ii!~i;i~i~i~iii~ 
.;ii~ ~:~.¸ ....... 
~ii~i ~i~:~~i;!i~ 
" 
-:.~.=: iii::i~iiii'i!ili~ II 
.:i~i ii:ixi:., 
ii.. iIl~+ ~ 
C 
Fig. 
19.1" Quadrupoles. (a) Electrostatic quadrupole characterized by p2(z), with 
equal and opposite voltages on the electrodes. (b) Magnetic quadrupole characterized by 
Q2(z). (c) Photograph of an actual electrostatic quadrupole. 

19.1 PARAXIAL EQUATIONS FOR QUADRUPOLES 
279 
15.9) whereupon M (2) becomes 
(7¢" 
M(2)=-\8¢½ 
+ 8¢½ 
(x2+y2) 
,2~2 _r/O2) cos28+(Tq2 + r/P2) sin 
2 
+ {__(7P2 
(7q2 
cos 20} 
~,~-rlQ2) sin2O+\~+71P2 ) 
xy 
1 
(x,2 
y,2 
+ 
) 
(19.2) 
with 8' = ,7B/2¢ 1/2. 
The paraxial equations, OM(2)/Oxi - d(OM(2)/Ox~)/dz (Xl -- X, X2 -- y), 
still do not separate, however, unless 
7q2/¢ ½ + 2yP2 
(19.3) 
tan 8(z) = 7P2/¢ ½ - 27/Q2 
This is known as the orthogonality condition and has been known in various 
forms for many years (Melkich, 1947; Glaser, 1956, Section 37; Du~ek, 
1959). This condition can be satisfied in several ways but only one is a 
practical possibility. Most generally, 8(z) may vary with z, in which case 
electrodes and polepieces must be devised and constructed of such shapes 
that condition (19.3) is everywhere satisfied. More reasonably, 8(z) may 
be a constant, not necessarily zero; this requires B(z) = 0 and 7q2 + 
2r/P2¢ 1/2 cx 7P2 - 2r/Q2¢ 1/2. Finally we may set 8(z) equal to zero, so 
that q2(z) = P2(z) - 0, and at least one of p2(z) and Q2(z) is not zero 
everywhere. We retain only this final case. 
From now on, then, we consider only orthogonal systems, and we as- 
sume that the electrodes and polepieces are disposed so that only ¢(z), 
p2(z) and Q2(z) are allowed to be nonzero. The paraxial equations then 
take the form 
d 
~½x 
+ 
27p2+4r/Q2¢½ 
dz 
4¢½ 
__( 
)
d
 
~½y, 
+T¢"÷27p2-4riQ2¢½ 
dz 
4¢½ 
x -- 0 
(19.4a) 
y = 0 
( 9.4b) 
or nonrelativistically 
I 
x I 
x" + -~ 
+ 
¢' Y' 
y" + ~ 
+ 
¢" - 2p2 + 4r]Q2 ¢ ½ x = 0 
(19.5a) 
4¢ 
¢" + 2p2 - 4qQ2¢½ 
4¢ 
y = 0 
(19.5b) 

280 
19. QUADRUPOLE LENSES 
or in reduced form, ~= "-- x¢ 114, ~, :-- y~,14, 
½ 
~" + ~ 
(~ + 4) 
2yQ2 
P2 
-- 
7~-- 
~==0 
(~9.6~) 
2yQ2¢ ½ 
~;,+ a 
(~+ 4)+ w 
~-~ 
~y 
0 
(19.6b) 
Each paraxial equation is a linear, homogeneous, second-order differential 
equation and by any of the lines of reasoning set out in Chapter 16, we may 
again establish the existence of cardinal elements. For quadrupoles, it is 
usually sufficient to list the asymptotic cardinal elements, though real (and 
osculating) elements can of course be defined if needed. Unlike round lenses, 
however, two sets of cardinal elements are needed, one to characterize the 
x-z plane, the other the y-z plane. In the absence of any rotationally 
symmetric lens field (¢ = const), the lens action in one of these planes will 
be convergent while in the other it will be divergent. This is readily seen 
from (19.4-19.6). 
The action of a quadrupole lens on electron rays is most conveniently 
characterized by a pair of transfer matrices, similar to (16.12) except that 
the matrix describing the coordination between object and image space is 
different in the two planes. Before writing down these matrices, we must 
first introduce the notion of astigmatic object8 and images. 
Quadrupoles 
are commonly employed as multiplets--the quadruplet can have most at- 
tractive features--and if the cardinal elements are different in the x-z and 
y-z planes, the image plane may clearly be different as well: the system will 
not produce a stigmatic image of a point object. If a further lens follows, 
this astigmatic image will be the object for the subsequent stage, and we 
must thus expect to have to deal with astigmatic objects. 
The most general transfer matrix relates position and slope in some 
plane in object space, z = zl, to the same quantities in a plane in image 
space, z = z2 (cf. 16.15): 
and as in (16.12), we write 
Z~i) ) / f zi 
T~ = (-(z~ 
\ 
-1/I~i 
T~ = (-(~ 
\ 
-1lye, 
(19.7) 
-('))/f,~ + f,o ) 
( 2:2 - -  Z(FX/))( zl - - " F o  
(19.8a) 
-(=))/Y~i 
Zl -- "Fo 
(z~ - Z~F~,))(z, 
-(~))/h' + ho~ 
• 
- ~Fo 
(19.Sb) 
7 
(z, 
- 
~Fo)/A~ 

19.1 PARAXIAL EQUATIONS FOR QUADRUPOLES 
281 
The cardinal elements are most conveniently defined with the aid of the 
rays G,(z), G~(z), G,(z) and Gy(z), which satisfy conditions analogous to 
(16.1): 
lim G~(z)-- 
lim Gy(z)--1 
Z---~-- O0 
Z--~-- O0 
lim G,(z)= 
lim Gy(z)= 1 
(19.9) 
Z----~ OO 
Z----~ OO 
The rays G,(z) and G,(z) satisfy (19.4a) while G,(z) and G,(z) satisfy 
(19.4b). The image loci are then the points of intersection of the image 
asymptotes to Gx and Gy with the axis; the rays G, and G~ similarly 
define the object loci. The focal lengths are given by 
fxi--llGtxi 
, 
hi---lla;i 
f,o = 1/G',o 
, ho- 
1/G'yo 
(19.10) 
Let us suppose that the planes z = z~o and z = 
zxi are conjugate, in 
the sense that (Tx)12 = 0, or 
(Zxi - Z~i))(Zxo 
_(x) 
- ZFo) = --f~ifxo 
(19.11) 
so that 
M~ 
0 
) 
T~ = 
(19.12) 
-1/f,, 
([bo/¢i)~ /M~ 
in which we have used the Wronskian of (19.4a) to show that fxolfxi -- 
([~o/¢i)1/2; a similar relation is of course true for fyo/fyi. The magnitude 
M~ is the height of the image asymptote to G~(z) in the plane z = z~,i. 
In general, however, (Ty)12 ~: 0 when (19.11) is satisfied and so although 
rays from a point P(Xo, yo) all have the same x-coordinate xi = M~Xo in 
z = z~i, their y-coordinate is a function of both yo and the gradient Y'o: 
(--(Zxi - Z~)i )lhi 
T, 
-1~hi 
-(Y))(Zxo 
-(Y))lfyi "~" fyo ~ 
Zxi 
-
-
 ZFi 
-
-
 ZFo 
] 
(z~o 
"(Y) 
-
-
 "Fo)lhi 
(19.13) 
A point P(x0, y0) is therefore imaged as a line in the plane z = z,i parallel 
to the y-axis. Likewise, if we consider a pair of planes z = zyo and z = zyi 
for which (Ty)12 = 0, we find that in general (T,)12 does not vanish and 
again a line image is formed, now parallel to the x-axis. These line images 
are thus at right-angles to one another and separated by the astigmatic 
difference. 
One or both may be virtual (Fig. 19.2). If we move an axial 
point object along the axis, the line loci will move and there will always be 

282 
19. QUADRUPOLE LENSES 
X 
/ 
L 
/ 
/ 
<. 
~Z 
Fig. 19.2: Formation of a line image in a magnetic quadrupole. The arrows show the 
directions of the currents in the windings. 
real or virtual object positions for which the line foci coincide and the image 
is stigmatic. In general, however, the magnifications in the two planes will 
not be equal. 
The astigmatic difference can be expressed in terms of the cardinal 
elements and magnification. Using the quadrupole analogue of (16.25), 
"(~') 
-f~iM~ 
Zzi -- ~" Fi 
Z(~ ) 
-f, 
iM, 
Zyi -- 
• -~ 
(19.14) 

19.1 PARAXIAL EQUATIONS FOR QUADRUPOLES 
283 
and 
we see that 
where 
z~o- Z(F~)o - f~o/M, 
_(~) 
zyo- ZFo = ho/My 
( 9.15) 
Ai'- zxi- 
zyi - 
AFi -- fxiMx 
+ fyiMy 
Ao'= z~o - Zyo = AFo + fxo/Mx -/yo/My 
(19.16) 
~(~)- Z(FY/) = Ai(M~ = M~ = 0) 
iFi " --~Fi 
AFo " = z~ ) - ZFo-(') = Ao(M, = M, -~ oc) 
(19.17) 
(19.18a) 
with 
2 
2 
52 "-- (fxofxi - hofyi) 2 -~- AFoAFi + 2(fxofxi + hohi)AFoAFi 
= (fxofxi + fyofyi + AFoAFi) 2 --4fxofxifyofyi 
(19.18b) 
In the usual case in which the signs of fx and fy are different, 52 is positive 
and there are two real roots and hence two pairs of stigmatic conjugates. 
The cardinal elements of multiplets are established most easily by mul- 
tiplying the transfer matrices of the individual lenses; these must be sep- 
arated by transfer matrices corresponding to the drift spaces, the spaces 
between the planes z = z2 for one lens and z = Zl for the next. We recall 
that these planes may be chosen in various ways: Zl = z2 = 0, in which 
case incident position and gradient are related to emergent position and 
gradient in the same plane, conventionally the mid-plane of the lens, is one 
good choice, thoroughly explored by Du~ek (1959). Here we have 
X2 
Z~i)/fxi 
ZFi ZFo/fxi-t- f~o 
Xl 
x~ 
-1/fxi 
_(~),t 
--ZFo/Jzi 
Xl 
= 
Y~ 
-1~hi 
Fi ZFo/fyi + fyo 
Yl 
~(~) / ~ 
y~ 
--~'Fo/J yi 
(19.19) 
ix--" 
2AFofui 
2AFofxi 
--AFoAFi - f~of~i + f~ofyi + 5 
AFoAFi - fxofxi + fyofyi "1- 
From (19.13), it is readily seen that quadratic equations are obtained for 
M, and My if we attempt to satisfy the stigmatic imaging condition, Ai = 
Ao = 0. The discriminant 5 is the same for M, and My and we find 

284 
19. QUADRUPOLE 
LENSES 
(We note that Du~ek's matrices are trivially different since he used the 
vectors (x' x) T and (y' y)T.) 
Another convenient choice involves using different pairs of planes for 
Tx and T~, namely the focal planes, since the diagonal matrix elements 
then vanish: (0 ,o)(0 ,,o) 
T~= 
, T,= 
(19.20) 
-1~hi 
o 
-1/f~ 
o 
This choice has been studied in great detail by Regenstreif (1966, 1967), 
who has established straightforward rules for writing down the transfer 
matrices of an arbitrary number of quadrupoles. His procedure can be 
applied to Du~ek matrices (Hawkes, 1970), which we temporarily write as 
follows: 
Ti=(ai 
bi) 
ci 
di 
(19.21) 
where Ti denotes either Tx or Ty for the i-th quadrupole of a sequence and 
ZFi 
ZFoZFi 
ai : = fi 
' 
bi "- 
+ fo 
fi 
(19.22) 
1 
ZFo 
di:= 
fi 
f~ 
The separation between the i-th and (i + 1)-th quadrupoles is denoted by 
Li,i+l and we write 
T(Li,i+l) := 
(19.23) 
0 
1 
Introducing the distances Xi,i+l between the image focus of the i-th quadru- 
pole and the object focus of the (i + 1)-th quadrupole, 
ai 
di+l 
Xi,i+l "= ~ + Li,i+l + 
(19.24) 
Ci 
Ci+1 
we can show (Regenstreif, 1966, 1967; Hawkes, 1970) that the transfer 
matrix of n quadrupoles separated by n - 1 drift spaces is given by 
c(") 
d(") 
n-I 
n-I 
= 
II 
' 
= 
II,i 
 
 
i=1 
i=2 
n 
n 
c(")= 
HciT,.,, 
d(")= 
dlHci,5, 
(19.25) 
i=1 
i--2 

19.1 PARAXIAL 
EQUATIONS 
FOR QUADRUPOLES 
285 
in which 
( 
i) 
Otn -- 
Xn-l,n 
"~n--1 
anCn 
( 
1) 
anCn 
"In--2 
~. --" Xn-l,n~n-1 
2 
Cn--1 
~n--2 
6n --" Xn-1 
n6n--1 
2 
' 
Cn_l 
7--2 
2 
Cn--I 
~n--2 
2 
Cn--1 
(19.26) 
and 
")/0 = ~0 = 0 
, 
"~1 = ~1 = 1 
1 
72 = X1,2 
, 
~2 = X1,2 
cldl 
Another expression for the elements of the transfer matrix between an 
arbitrary pair of planes, z = Zn and z = z0, may be derived by using the 
transfer matrix between the principal planes. Writing 
D(0 
-- Z(inir 1) 
2 < i < n- 1 
• __ Zpo 
D(1) . 
..(1) 
D(, ) 
(,-1) 
(19.27) 
--" ~Po -- Zo 
~ 
:-- Zn -- Zpi 
we form the matrix 
T(zo,z,) = DnTn-lDn-1 . . . T2D2T1D1 
(~9.2s) 
The elements can be written as Gaussian brackets (Herzberger, 1943, 1958; 
Hawkes, 1967; Dymnikov, 1968), which are defined as follows" 
Ix] 
[xlx2] 
[XlX2X3] 
[xax2x3...x.] 
---- 
x 
-- 
XlX2+ 
1 
-- 
XlX2X3 "4- Xl -4- X3 
= 
[~1~...~.-~] 
+ ~.[~1~...~.-1] 
(19.29) 
We find 
[ [D.c._l... D2cl] 
T(zo, z,,) = l \ [Cn-lDn-1...Cl] 
[D.c.-1 ...D2clD1]) 
[c,-1D,-1...clD1] 
(19.30) 
For a proof see Hawkes (1967). Gaussian brackets are also employed by 
Dymnikov (1968) and, in connection with prisms, by Chechulin and Yavor 

286 
19. QUADRUPOLE LENSES 
(1969); renewed interest has been shown in them in light optics too (e.g. 
Tanaka, 1981, 1982, 1983, 1986). 
One common requirement for quadrupole multiplets is that their over- 
all behaviour should be the same as that of a round lens; for this, the 
cardinal elements in the x - z and y- z planes must coincide and the focal 
lengths f~ and fy must be equal. If we consider quadrupoles that may 
have a round electrostatic lens component, provided that the latter has no 
overall accelerating or retarding effect (¢i = ¢o), we can see on symme- 
try grounds that one at least of these conditions is satisfied by imposing a 
certain symmetry on the system. In particular, we perceive that the focal 
lengths in the x - z and y- z planes are automatically equal in antisym- 
metric multiplets. 
The latter are defined as follows. If a multiplet consists 
of 2N quadrupoles (N > 1) such that the central plane is a plane of geo- 
metrical symmetry and electrical antisymmetry, we say that the multiplet 
is antisymmetric. The case of N = 2 was extensively studied by a group 
in Leningrad (Yavor, 1962; Dymnikov and Yavor, 1963; Dymnikov et al., 
1963a,b, 1964a,b, 1965; Shpak and Yavor, 1964) and has come to be known 
as the Russian quadruplet (Fig. 19.3). Consider two rays, G~(z) and Gy(z). 
Because of the electrical antisymmetry, the sequence of functions p2(z) or 
Q2(z) encountered by G~(z) as it proceeds in the positive z-direction will 
be exactly the same as that traversed by Gv(z) if we imagine it travel- 
ling in the negative z-direction. The gradients of the emergent asymptotes 
will hence be equal but opposite in sign, and the focal lengths f~ and fy 
will hence be equal (since ¢i = ¢o, we already have fxi "= fxo =" fx and 
fyi := fyo =" fy). If we wish to arrange that an antisymmetric multiplet 
has the same image-forming properties as a round lens, therefore, we have 
only to ensure that the loci (or principal points) in the x - z and y- z 
planes coincide. For a given geometry, we need only vary the relative exci- 
tation until the condition is satisfied. We therefore obtain a set of pairs of 
excitations, which is known as the load characteristic of the quadruplet. 
Further details are given in Chapter 39. 
19.2 Transaxial lenses 
The foregoing discussion has been confined to the optics of quadrupoles 
in general and we have said little about the shapes of the electrodes and 
polepieces and hence about the effects of any additional symmetries. Two 
particular additional symmetry properties are of interest, however; one 
leads to cylindrical lenses, at least in the electrostatic case, as we see in 
Chapter 20. A different symmetry characterizes transaxial lenses, in which 
the field or potential is rotationally symmetric but the optic axis is no 

19.2 TRANSAXIAL LENSES 
287 
C 
D 
, 
C 
D 
I 
I 
I 
, 
I , 
,,f"---~ 
I 
1 
D 
C 
! 
O 
C 
I 
I 
I 
I 
a n t i s yrnmet r'y 
plane 
Fig. 
19.3: The antisymmetric or "Russian" quadruplet. The centre plane is a plane 
of geometrical symmetry and electrical antisymmetry. 
C, D denote convergent and 
divergent action respectively. 
longer the same as the symmetry axis but is perpendicular to it. 
The 
electron beam now passes between rotationally symmetric, typically plane 
electrodes and is focused by the fields in any gaps. Figure 19.4 shows such 
a system. The electrodes are ideally circular or annular but are in practice 
reduced to sectors since the electron beam occupies so little of the space 
available. 
It can be seen by comparison with Chapter 20 that such structures 
bear some resemblance to cylindrical lenses but differ from the latter in 
that the potential is not independent of one of the transverse cartesian 
coordinates but is the same for all azimuthal angles ~p at a given radial 
distance from the axis of rotational symmetry.The optical behaviour of such 
systems was first investigated formally by Strashkevich (1962), to whom we 
owe the name 'transaxial lenses'; the theory was set out in some detail in 
his book of 1966. In the early 1970s, it was realized (by V.M. Kel'man and 
colleagues in Alma-Ata) that certain features of these structures rendered 
them attractive for use in the collimator of a prism spectrometer, and their 
properties were investigated in some detail (Glikman et al., 1971; Brodskii 
and Yavor, 1970, 1971; Karetskaya et al., 1970, 1971a,b,). This work is 
presented in full in Kel'man et al. 
(1979), one of the three chapters of 
which is devoted wholly to these lenses. 
The symmetry conditions are now such that 
¢(~, y, z)= ¢(~,-y, z) 
(19.31) 
¢(0, y, z) = ~(~, y, (z ~ - ~) ½) 

288 
19. QUADRUPOLE LENSES 
I 
/ 
/ 
/ 
I 
/ 
i 
I 
! 
I 
t 
\ 
\ 
\ 
$t S 
-- s 
.
.
.
.
.
.
.
 
- 
-----... 
s 
• 
",~ 
x N 
/ 
I I 
I 
k 
X 
t 
i I 
~\ 
l" 
/ 
~..X 
k 
(¢, 
/ 
,t 
\ 
I II 
l/I 
I/t 
N\ 
'i 
I 
I 
', 
~-z 
'~ 
(optic axis) 
I 
\\ 
"'....... 
I 
\\ 
xx 
I 
// 
t 
~\ 
\ 
I 
/ 
I / 
1 
s" 
Fig. 19.4: A transaxial lens. The electrodes shown lie in some plane y = const and an 
identical set lies in the plane y = -const. 
For small values of x and y, therefore, 
• (=, y, ~) = ¢(z) + ~ 
+ ~z~ 
+ ¢2y2 ~- ~Z 
+ ¢4y4 
with 
¢~.=-~ ¢"+ 
¢,'=-~ 
¢~+ 
Comparing (19.32) with (7.36), we see that 
p2(z) = ¢'(z)/z -4- ¢"/2 
The paraxial equations have the form 
¢, 
¢, 
X t 
__ 
• 
2-Z 
¢' ~, 
¢2 
-T 
=0 
(19.32) 
(19.33) 
(~9.34) 
(19.35a) 
(~9.35b) 

19.2 TRANSAXIAL LENSES 
289 
All the theory for quadrupoles can hence be employed without further 
discussion. The form of (19.35a) is, however, such that simple expressions 
can be obtained for the focal length and foci. Thus on writing 
:= x/z 
(19.36) 
(19.35a) becomes 
~,, + 2 + ¢'z/2¢ ~, = 0 
z 
and after some trivial calculation, we find 
XoZ 
½ f 
d( 
z 
~-(' 
=--- 
~ozo-~o)¢oZ 
Zo 
¢½(2 
Zo z]+++) 
= ~,z + (~o - ~'oZo)¢~ 
~ 
+ -~ 
~+¢ 
2;0 
giving the transfer matrix 
with 
1 
f+ 
z zo oo,+ ++zzol )(XO)l+zol  
x o 
1 
cx) 
¢g f ¢' d( 
2 
¢]( 
--OO 
(19.37) 
(19.38) 
(19.39) 
(19.40) 
in which we have extended the limits of integration to infinity in fi since 
it is asymptotic imagery that will be of interest. The planes Zo and zi will 
be conjugate if 
l 
z+ - Zo 
+ -~i = 0 
(19.41) 
or 
1 
1 
1 
1 
1 
= 
1 
(19.42) 
¢2oZo 
¢~zi 
fi¢2o 
and the transfer matrix becomes 
(zi,zo o)(z+,zo 
o) 
= 
t 
t 
(19.43) 
-1/I+ 1 + zo/I~ 
-1/I+ zoCj /z+¢~, 
In the converging or y-z plane, there is no such simple solution of the 
paxaxial equation. 

20 
Cylindrical Lenses 
Cylindrical lenses are electrostatic or magnetic devices in which the po- 
tential or field is constant in some direction perpendicular to the optic 
axis. They are the electron optical analogues of glass lenses, the surfaces 
of which are not spheres, as in rotationally symmetric or 'round' lenses, 
but cylinders, whence their name. This nomenclature has not always been 
adhered to in electron optics, and rotationally symmetric lenses are not 
infrequently referred to as cylindrical, since their central opening is indeed 
a circular hole and some electrostatic lenses consist of a sequence of metal 
cylinders. 
Cylindrical lenses have a long history, going back to one of the earliest 
publications on lens properties, the note by Davisson and Calbick (1931) on 
the lens-like behaviour of round openings and slits. The paraxial properties 
of such lenses were first discussed by Picht (1939b) and in very much more 
detail by Gratsiatos (1940). In the same year Strashkevich (1940a,b) gave 
the ray equations for electrostatic cylindrical lenses, including the reduced 
form (15.40), and these equations are again to be found in Leitner (1942). 
Many of the properties were elucidated and rediscovered over the years; the 
relevant papers are listed in the bibliography to this Chapter. We single 
out the work of Kel'man et al. (1954), Vavor (1955) and Kel'man and 
Yavor (195ha,b) on magnetic cylindrical lenses, recapitulated in detail in 
Kel'man and Yavor (1968). 
The potential distributions in cylindrical lenses have been calculated 
or measured in particular, in connection with mass spectrometer design; see 
in particular Wallington (1970, 1971), Harting and Read (1976), Mulvey 
and Wallington (1973) and Boerboom (1959, 1960). 
We now assume that the potentials (I) (7.36) and W (7.41) are functions 
of x and z only, so that in the general expansion of (7.36), we have 
1¢,,(z) 
q2(z) = q4(z) = 0 
p4(z) = ~¢(4)(z) 
(20.1) 
and in (7.46-7.48) 
1 
P2(z) = ~B'(z) 
, 
Q2(z) = Q4(z) = 0 
1 _,,,(z) 
P4(z) = 
(20.2) 

20. CYLINDRICAL LENSES 
291 
It is immediately clear from (19.3) that an electrostatic cylindrical lens 
forms an orthogonal system whereas a magnetic one does not. We have 
¢(~, y, z)= ¢(z)-~¢"~ 
+ ~4¢(')~ ' 
Ax(x, y, z) = --~ yB + 1B" y(9x2 + y2) 
48 
1 
4_~ BI, 
Ay(x, y, z) = 
-~ xB - 
y(hx 2 - 3y 2) 
zl 
' 
~---g B"' 
y2 
Az(x, y, z) = --~xyB + 
xy(ax 2 + 
) 
(20.3) 
Expanding the function M (15.23), we obtain 
M(°) = ¢½ 
3'¢" 
1 
(x,2 
y,2 
1 
M (2) = 
~-~ x 2 + ~¢½ 
+ 
)+ -~?xyB' 
- ~B(~y' - ~'y) 
z~ 
(20.4) 
giving the paraxial equations 
d 
7¢" 
ez(~,~ ') + ~ 
• + ~B¢= o 
~z (~ y' - ,B~) = 0 
(2o.5~) 
(2o.5b) 
(We note in passing that expression (20.4) for M (2) could have been simpli- 
fied by the use of Sturrock's partial-integration rule (1955), which tells us 
that when a term of the form g(x, y, z)df(x, y, z)/dz occurs in a variational 
function such as M (2), it may be replaced by -fdg/dz; here we could have 
reduced the terms in B to -rlBxy'.) Integrating (20.5b), we find 
y, = C + ~?Bx 
(20.6) 
in which C is a constant and (20.5a) may then be written 
7¢" + 2~? 2 B2 
~CB 
x"+ 7¢^' x'+ 
x- 
(20.7) 
2~ 
2~ 
This can be recast into reduced form by writing v = z¢ 1/4 (15.40). 

292 
20. CYLINDRICAL LENSES 
Equation (20.7) is a linear, second order, differential equation but is 
no longer homogeneous when a magnetic field is present. In the absence 
of such fields (B = 0), the paraxial equation for x(z) is almost the same 
as that for round electrostatic lenses, the only difference being the factor 2 
in the denominator of the term in x. The equation for y(z) can be solved 
immediately, in this case: 
y(z) = c ] ~-½ (¢)~¢ 
(2o.s) 
The lens action in the x- z plane is thus described by a transfer ma- 
trix of the type (16.12): It is interesting to note that the best thin-lens 
approximation to the focal length is now obtained by writing 
~:=,$½ 
(and not v = x¢ 114 as in 15.40 and 17.79). In the nonrelativistic approxi- 
mation, (20.7) becomes 
dz 
= 
2¢{ 
and the focal length is then 
1 
1 
¢°2 i ¢,2 
This expression was obtained by Brodskii and Yavor (1971), who find that 
it is substantially more accurate than that given by writing v = x¢ 1/4. 
Glikman et al. (1967a) have demonstrated that electrostatic cylindrical 
lenses always have a converging action in the x - z plane, using the exact 
trajectory equation rather than the paraxial equation. 
In the y - z plane, we have 
() (2A) () 
v~ 
~ f(¢,/$)½ de 
v, 
z 1 
(20.9) 
This is the type of transfer matrix that we meet in light optics for a parallel- 
plane glass plate separating media of different refractive index. 
In the general case when B # 0, (20.7) is solved using the method 
of variation of parameters. If g(z) and h(z) are two linearly independent 

20. CYLINDRICAL LENSES 
293 
solutions of the homogeneous equation obtained from (20.7), satisfying the 
initial conditions 
g(zo) = h'(zo)= 1 
(20.10) 
g'(zo)=h(zo)=O 
in some object plane, z = zo, the general solution is 
'h(z) 
~(z)=~og(Z)+Xo 
(20.11) 
The solution of the inhomogeneous equation is thus 
• (z) = ~og(Z)+ ~'oh(Z) 
z) f g(~)B(~)d¢+ yCg_(z) f h(~)B(~) d~ 
~¢o 
~C~ 
~o ~½(¢) 
¢02 
~o ¢½(¢) 
=: xog(Z) + x~oh(z) + yCj(z) 
(20.12) 
From (20.6), we have 
^½ 
c- ¢o y'o + ~Bozo 
and so 
t 
,,1 
x(z) = xo{g(z)- rl2Boj(Z)} + x'oh(z ) + yo~7¢gj(z) 
(20.13) 
(20.14) 
Substituting into (20.6) and integrating, we obtain 
y(z) = yo + yo~ 
~ + 
~---( 
Zo 
go 
(jj 
jo ) 
de 
Bg de - 
~2B 
o 
~ 
de 
Zo 
Zo 
Zo 
' ]Bhd~ 
+ ~o,1 
¢----f 
Zo 
(20.15) 
Systems with optical properties as complicated as (20.14) and (20.15) sug- 
gest are unattractive in practice. Their general behaviour has been studied 
in the context of ophthalmological optics by Gullstrand (1900, 1906, 1908, 
1915, 1924) and a more accessible account is given by Carath6odory (1937). 
The electron optical situation has been explored in detail by Kel'man et 
al. (1954), Yavor (1955), Kel'man and Yavor (1955) and more recently by 
Rose (1966/7), and especially (1972). 

This Page Intentionally Left Blank

Part IV 
Aberrations 

This Page Intentionally Left Blank

21 
Introduction 
The paraxial approximation, characterizing the linear coupling between two 
spaces, object space and image space, describes the dominant behaviour of 
the various electron optical components but small departures from this can 
rarely be neglected. In order to assess the magnitude of such non-linear 
effects, we must proceed to the next higher order approximation, which 
involves retaining quartic terms in the expression for the refractive index 
M (4.35) for systems with a straight optic axis. We shall find that the 
results of this calculation can be compactly expressed in terms of coeffi- 
cients, the geometrical aberration coefficients, which vary in number with 
the symmetry of the system. The object of most aberration calculations is 
to obtain expressions for these coefficients in terms of the axial potential 
or field functions and of particular solutions of the paraxial ray equations. 
The calculation may be performed in two very different ways. The 
most straightforward consists in writing down the ray equations as in Sec- 
tion 15.1 but now retaining higher order terms in the various field and 
potential expansions. For the most common components, round lenses, 
quadrupoles and mirrors, this generates linear, second-order, ordinary dif- 
ferential equations, which are now inhomogeneous; the corresponding ho- 
mogeneous equations are identical with the paraxial equations. These in- 
homogeneous equations are solved by variation of parameters or by writing 
down the appropriate Green's function; the difference is purely formal and 
almost trivial. This procedure is commonly known as the trajectory method. 
The method is best understood by an example, and the reader is referred 
to Section 24.2, where round lens aberrations are studied in this way. The 
trajectory method has been used to study systems with arbitrary curved 
axes in considerable detail. We examine such systems in Part X. 
Alternatively, a general perturbation theory may be developed, which 
enables us to answer the following question: given the solutions of ray equa- 
tions derived from the paraxial refractive index, M = M (2), what will be 
the solutions for a slightly different refractive index, M - M (2) + M(P)? 
(Here M o¢ M, see (4.35) and (22.2).) By choosing M(p) = M(*), for ex- 
ample, we obtain the primary geometrical aberrations of systems with a 
straight axis. Although this second approach may seem more abstract, it 
has one distinct advantage, which will become apparent below: any inter- 
relations between the various aberration coefficients emerge automatically, 

298 
21. INTRODUCTION 
whereas they may be by no means obvious when the trajectory method 
is adopted. This second procedure, which we shall mostly use, is known 
as the eikonal method (from the term introduced by Bruns (1895) in his 
DaB Eikonal) or method of characteristic function8 (following Hamilton, 
1828-1837, see Hamilton (1931)). 
These geometrical aberrations, arising from higher order terms in the 
field expansions, or more evocatively, from allowing the electrons to stray 
a little way beyond the truly paraxial region, are not the only type that 
can arise. The next most important are the chromatic aberrations. These 
are the analogue in electron optics of effects due to variations in refractive 
index with wavelength in light optics; they can arise in several ways. We 
have been assuming that the electron energy and any magnetic lens fields 
and electrostatic lens potentials axe static and fixed. In reality, however, 
the lens excitations will inevitably fluctuate somewhat (except in supercon- 
ducting lenses operating in the persistent-current mode) and the electrons 
of the incident beam will never be perfectly monoenergetic: their energies 
will span a small range, narrow but not negligibly so, for reasons that are 
examined in Part IX. We shall see in Volume 3 that a wavelength ()~) pro- 
portional to ~-1/2 can be associated with electrons accelerated through a 
voltage drop of ~, and effects due to variations in electron energy relative to 
the lens excitation may thus be regarded as due to a change in the focusing 
properties with )~. They are hence known generically as chromatic aber- 
rations. In studying these, we establish chromatic aberration coe]flcients, 
which characterize the optical consequences of small changes in electron 
energy, electrostatic lens potential or magnetic lens field strength. In addi- 
tion, in electron microscopes, some electrons commonly lose energy within 
the specimen and this too contributes to the energy spread in the beam 
and hence to the chromatic blur. 
Various other perturbations have been characterized by aberration co- 
efficients and calculated by the methods set out in this Part: effects due 
to the inclusion of relativity, those caused by moderate space charge forces 
and those provoked by small departures from the assumed symmetry of the 
system. Most formulae are now available in relativistically correct form and 
the incentive to explore the difference between nonrelativistic and relativis- 
tic behaviour by perturbation theory has vanished. Conversely, it can still 
be useful to enquire what effect space charge will have when it has been 
neglected in a preliminary calculation and here perturbation theory is con- 
venient. The final group of aberrations, associated with small mechanical 
or electrical imperfections in the lenses, is of extreme practical importance; 
these mechanical or parasitic aberration8 must always be kept small if lens 
performance is not to be impaired. 
As we saw in Part III, it is necessary to distinguish between real and 

21. INTRODUCTION 
299 
asymptotic coupling between object and image space and this remains true 
of aberration calculations. To illustrate this, consider a real object im- 
mersed in a magnetic field; the image will be affected by the aberrations 
introduced by the part of the field downstream from the object. If, how- 
ever, the same magnetic field is used to magnify an intermediate image, 
the entire field will contribute to the aberrations and we then characterize 
the field by the coupling between incident and emergent asymptotes. In 
the first case, we speak of real aberrations, in the second, of asymptotic 
aberrations. 
The study of electron lens aberrations is almost as old as the elec- 
tron microscope itself, for the first calculations of aberration coefficients 
were made in the early 1930s by Scherzer, who preferred the trajectory 
method, and by Glazer, who introduced the eikonal method into electron 
optics (Glaser, 1933a-c, 1935, 1936a,b, 1937, 1938, 19497 Scherzer, 1933, 
1936b, 19377 see also Funk, 1936, 19377 Gratsiatos, 19367 Rogowski, 19377 
Ramberg, 19397 Busch and Br/iche 1937). During that decade, the real 
aberrations of round lenses were thoroughly studied and several equivalent 
formulae for the various coefficients were derived. In particular, Scherzer 
(1936b) demonstrated that the spherical aberration, which is of particular 
concern since it limits the resolution of microscopes, always has the same 
sign, whatever the lens design. This finding is so important that it is known 
as Scherzer's theorem, the only named theorem in the subject. 
During the 1940s, the aberration coefficients of quadrupoles were ob- 
tained by the trajectory method (Melkich, 1947) and in a celebrated paper, 
again by Scherzer (1947), a number of possible ways of cancelling spheri- 
cal aberration were adumbrated. Also during this period, Grinberg (1942, 
1943a,b, republished 1948) derived highly general ray equations, assuming 
no particular symmetry, and these, supplemented by the work of Van- 
dakurov (1956a,b, 1057) and Kas'yankov (1956, 1957, 195Sa), have been 
widely used by Russian authors, notably Strashkevich and Pilat (1951, 
1952) and Strashkevich and Gluzman (1954), who made the first attempts 
to follow Grinberg's approach in the study of aberrations. 
The late 1940s and early 1950s saw several substantial contributions. 
Tretner returned to Scherzer's proof that the spherical aberration coeffi- 
cient cannot be made to vanish by ingenious lens design, without infring- 
ing any of the conditions required by the proof, and established minimum 
values for this coefficient and for that of chromatic aberration (for which a 
similar rule holds true), subject to reasonable practical constraints on lens 
dimensions and excitation (Tretner, 1950, 1954, 1955, 1956 and especially 
1959). Sturrock (1951a,b, 1952, 1955) re-examined the eikonal theory of 
electron lens aberrations and succeeded in placing it on a firm theoretical 
foundation; he showed how higher order aberrations can be calculated and 

300 
21. INTRODUCTION 
how the theory can be used to establish asymptotic aberration coefficients. 
The credit for recognizing the importance of distinguishing between real 
and asymptotic aberrations goes to Lenz (1956, 1957), however, closely 
followed by Seman (1958a). Sturrock also examined in detail the effect of 
small imperfections in magnetic lens construction--small departures from 
circularity of the bore, for example----expressing his results in terms of para- 
sitic aberration coefficients. These last studies were inspired by the work of 
Bertein on electrostatic lenses, and simpler analysis had already led Rang 
(1949a) and Hillier and Ramberg (1947) to introduce the stigmator, a weak 
quadrupole designed to cancel the principal parasitic aberration, the axial 
astigmatism (Sturrock, 1949, 1951b; Bertein, 1947d,e, 1948a). 
We have mentioned that the formulae for the aberration coefficients 
can be cast into many equivalent forms. The technique originally employed 
for this required partial integration and substitution from the paraxial equa- 
tions to eliminate second derivatives of z(z) and y(z), using (15.12) for 
round lenses, for example. This is not only laborious but has the severe dis- 
advantage that the form of the result cannot be predicted: we cannot know, 
until all the possible equivalent forms of a given coefficient have been es- 
tablished, which terms can be eliminated simultaneously and whether there 
are any that can never be removed. A procedure that permits us to write 
down a general expression containing all possible forms of every coefficient 
was introduced by Seman (1951, 1954, 1955a,b, 1958b) for round lenses and 
has been extensively used by Hawkes (1966/7b, 1967b) for quadrupoles and 
round lenses. 
The methods of Sturrock, whose familiarity with the work of Hamilton 
and of Herzberger (1931) had enabled him to consolidate the fundamen- 
tal studies of Glaser, were later applied to quadrupole lenses by Hawkes 
(1965a,b,c), who derived formulae for all their geometrical aberration co- 
efficients, more compact than those of Melkich (1947). 
The chromatic 
aberrations of such lenses were analysed by Kel'man and Yavor (1961), 
who derived the condition that must be satisfied if a mixed electrostatic- 
magnetic quadrupole is to be achromatic, subsequently rediscovered by 
Septier (1963) and generalized by Hawkes (1965d). 
In 1963, Verster noticed in the course of his work on 'gauze lenses' (see 
Chapter 41) that some aberration coefficients can be written as polynomials 
in reciprocal magnification, the coefficients being determined by lens geom- 
etry and excitation. Such a representation had been known to the members 
of the van Heel school (see van Heel, 1949, 1964) but had not hitherto been 
recognized in electron optics. This observation led Hawkes (1968, 1970b-f) 
to examine the structure of the asymptotic aberration coefficients and of 
the real coefficients of Newtonian fields in some detail; formulae were es- 
tablished for the coefficients occurring in the various polynomials and, by 

21. INTRODUCTION 
301 
expressing the results in matrix form (cf. Brouwer, 1957, 1964), expressions 
for the aberrations of multiplets could be obtained explicitly. The aber- 
ration polynomials were also obtained by Ade (1973, 1982), by a rather 
different route. 
During the 1960s, the basic aberration theory was again reformulated 
by Rose (1968, 1968/69; Rose and Petri, 1971), who devised a system- 
atic way of handling higher order aberrations, suitable for studying the 
complicated combinations of electron optical elements needed for practical 
aberration correction in an electron microscope. 
The most far-reaching innovation of the 1960s was, however, a conse- 
quence of the increasing availability of powerful computers. With these, it 
became possible to calculate optical properties easily and accurately and 
to apply sophisticated minimization techniques to the task of finding lens 
combinations possessing some particular property (Moses, 1970, 1971a-c, 
1972, 1973, 1974; Rose and Moses, 1973). The 1970s saw the introduction 
of the finite-element and boundary-element methods for field calculation 
(Munro, 1970, 1971, 1972, 1973; Adams and Read, 1972a,b; Harrington, 
1968; Read et al., 1971; Rauh, 1971), and the extremely difficult problem 
of calculating electron gun behaviour accurately was gradually solved (see 
Lauer, 1982; Kasper, 1982; and Part IX). Systems of great complexity can 
now be analysed in detail and the subject is in a stage of rapid development. 
Computers have been used not only for numerical solution of field and 
trajectory equations but also to derive expressions for aberration coeffi- 
cients. Here, we require them to perform not arithmetic but algebra and a 
number of special languages have been devised for this purpose, of which 
REDUCE is among the most widespread (Hearn, 1985; Fitch, 1985) though 
CAMAL is very easy to use (Barton and Fitch, 1972; Fitch, 1979; see Ng, 
1979 for an overall view of the subject). CAMAL has been employed to 
calculate aberration coefficients by Hawkes (1977a,b, 1980a, 1983a) and 
REDUCE by Goto and Soma (1977) and Soma (1977), see Chapter 34. 
Computer algebra has also been found useful in the latest addition to 
the family of methods used to study aberrations, in which the properties of 
Lie algebra and the associated groups are exploited. These techniques were 
introduced into particle and later light optics by Dragt (Dragt, 1979, 1982; 
Dragt and Forest, 1983; Dragt and Douglas, 1983); full accounts are to be 
found in Dragt and Forest (1986), Dragt et al. (1986) and Mondrag6n and 
Wolf (1986). 
The foregoing survey is restricted to some of the highlights in the his- 
tory of electron lens aberration theory. Many contributions of arguably 
comparable importance have not been mentioned and this account should 
therefore be regarded as no more than a preliminary glance at the field, 
charted more fully in the remainder of this Part and in the bibliography, 

302 
21. INTRODUCTION 
where more detailed attributions are to be found. In particular, we have 
not mentioned the use of lens models and the calculation of explicit forms 
of the coefficients for the most important of these; references to these are to 
be found in the Part on instrumental optics (especially Chapters 35, 36 and 
39), but the rise of fast and accurate numerical methods is accompanied by 
the fall, not to say the demise, of many of these models, which were intro- 
duced precisely because accurate calculation was unthinkably laborious. 

22 
Perturbation Theory" 
General Formalism 
We set out from the variational principle obtained from (4.32) and (4.34): 
P2 
J M dz 
extr. 
-..+ 
1:'1 
(22.1) 
in which we have written 
M"- M(2m0e)- ½ 
t2 
t2 
t 
t 
= 4½( 1 "~- Xl -}'~2 )-- rl(AlXl -~- A2x2 + Az) 
(22.2) 
for electrons, using (2.19). We adopt the suffix notation here because the 
coordinates (Xl,X2,Z) may be curvilinear, the optic axis coinciding with 
the z-axis. At this stage, this simply means that the z-axis is the path 
of a possible ray. Although much of the text is devoted to systems with 
a straight axis, whereupon (Xl, x2, z) become the familiar cartesian coo> 
dinates, we shall meet a very important family of curved-axis systems in 
Part X. We recall that (22.1) asserts that the first-order variation of the 
integral vanishes when the integration is taken along a ray, provided that 
the endpoints remain fixed. We now consider the value of this integral for 
an arbitrary path of integration, and to prevent any possible confusion, we 
write 
P2 
/. 
:= / M dz 
(22.3) 
S* 
gl 
reserving S for the value of the integral when the integration is taken over 
a ray. We find that if the path of integration is altered from xj(z) to 
xj(z) + Axj(z), then S* increases by an amount AS*, where 
Z2 
Zl 
dz 
(22.4a) 

304 
22. PERTURBATION THEORY • GENERAL FORMALISM 
x)l 
01 
Z: Z1 
Fig. 22.1: Perturbation from zj(z) to zj(z)+ Azj(z). 
or integrating by parts, 
Z2 
/kS*=- 
Axj dz ~ 
Oxj dz 
zl 
+ 
Azj(z2) - 
Z2 
Zl 
A j(z,) 
(22.4b) 
Summation over j = 1,2 is implicit here. Furthermore, the variation is 
restricted to the surfaces z = z l and z = z2, so that the z-coordinates of 
the endpoints of the path of integration are held constant (Fig. 22.1). We 
know that/kS* must vanish (22.1) when/kxjl =/kzj2 = 0 (j = 1,2) if the 
path of integration follows a ray; we have written/kzj(zk) =:/kxjk. The 
ray equations 
d cgM 
OM 
= 
(22.5) 
dz Ox~ 
cgxj 
are then satisfied. For this situation, we denote the value of S* by S and 
from (22.4), we have 
AS(Zl, z2)= (O~x~) 2Axj2-(i)-~xtj ) 1AXjl 
(22.6) 
Introducing the ray vector 
OM 
PJ = 
(22.6) becomes 
AS(zl , z2) -- pj2Axj2 - pjl AXjl 
(22.7) 
(22.s) 

22. PERTURBATION THEORY 
305 
It is convenient to write AS12 instead of AS(z~z2). We recall that, apart 
from the trivial change of scale relating S and S, the function S is Hamil- 
ton's point characteristic function and its arguments are xjl and xj2, the 
word 'point' underlining the fact that these are the coordinates of points 
P1 and P2. Characteristic functions with other arguments are sometimes 
convenient, such as the angle characteristic already encountered in Sec- 
tion 15.5. 
Suppose now that the system is perturbed in some way, and that a 
parameter )~ characterizes this perturbation. We need to introduce two 
perturbation operators, one of which enables us to represent the perturbed 
form of a function while the other expresses the effect of perturbing its 
arguments. For the former, we write the perturbed form of a function f as 
P f, 
Pf = 1 + )~P] + )~2p]I +... 
(22.9) 
For M in particular, we write 
PIM = M + )~M I + ,X2M II +... 
(22.10) 
For the argumental perturbation operator Pa, we use the Taylor expansion 
of a function in the form f(x + e) = exp(eO/c3x)f(z) so that 
Pa = exp($D I + ,X2DII + ...) 
(22.11) 
where 
D I 
I 0 
,x 0 
= 
+ 
DII 
II 0 
,II 0 
The total perturbation is then 
(22.12) 
P=P"PI 
We now apply these general remarks to the function S12. Since 
$12 = fz~ 2 M dz, we may write 
Z2 
PS12 "- / PM dz 
Zl 
(22.13) 
(22.14) 
(22.15) 
/XPS12 = Ppj2 " /XPxj2 - PPjl " APxjl 
It is permissible to take the operator P under the integral since the argu- 
ment z is not varied by Pa. From (22.8), we have 

306 
22. PERTURBATION THEORY • GENERAL FORMALISM 
Combining (22.10, 22.11 and 22.13), we find 
Z2 
Zl 
x (M.JI-AMI JI-A2MII ~-...) dz 
Z2 
Zl 
{ 
+ )~2 MH + DIMI + DIIM + .~(DZ M 
+... dz 
In order to keep the notation reasonably compact, we write 
(22.16) 
Ps,~- s~ °) + ~s~) + ~s~) +... 
(22.17) 
so that arabic indices (1), (2),... indicate the order of total perturbation 
whereas roman numerals I, II,... signify the order of functional perturba- 
tion. Then, comparing (22.16) and (22.17), it is immediately clear that 
Z2 
1) = f 
D I 
S~2 
(M I + 
M) dz 
Zl 
(22.18) 
From (22.8), we see that for any pair ~j, 
Z2 
~j ~$j "]- ~j ~ 
dz -- Pj2~j2 -- Pjl ~jl 
Zl 
(22.19) 
so that for ~j 
_(1) 
= xj ,wehave 
DIM 
_(1) 
(1) 
dz = Pj2zj2 --PjlXjl 
and hence 
where 
S(1) 
(1) 
_(1) 
cvi 
12 
-- Pj2Xj2 
-- PjlXjl 
+ °12 
Z2 
SI2 := f M I dz 
Zl 
(22.20) 
(22.21) 

22. PERTURBATION THEORY 
307 
The final function, S/2, is known as the first-order perturbation character- 
istic function 
and we shall use it frequently. It is in fact the functional 
contribution to S~ ), the argumental part coming from fz7 DIM dz. 
Returning to (22.15), we have 
AS~ ) 
_(1) 
a 
(1) 
= Pj2 " ixj2 
+ Pj2 " I-AXj2 
--p~ll)'Axjl--Pjl 
"Ax~ll ) 
(22.22) 
so that from (22.20) and (22.22), 
AS[2 __. (p~12) " A,Tj 2 
_(1) 
- z j2 • Api 2) 
~, (1) 
_(1) 
-- (Pjl 
" iXjl 
-- Xjl • Apj 1) 
(22.23) 
This is a first-order perturbation relation but it is much more general in form 
than we commonly need. We may perturb the rays subject to various con- 
straints, which correspond to particular physical situations. Two choices 
of constraints are of especial relevance. Consider first the implications of 
setting 
X(1) 
_(1) 
jl ---- /)jl -- 0 
(22.24) 
and, for simplicity, suppose that the plane z = Zl lies in field-free space. 
' and the constraints (22.24) imply that neither the position 
Then pj o¢ x j 
nor the gradient of the ray in z = Zl is allowed to change. Thus in Fig. 
22.2a, if R is the unperturbed ray, the perturbed ray R sets out from the 
same point with the same gradient. By using this set of constraints, aber- 
ration coefficients expressed in terms of position and gradient in the object 
plane are obtained, always provided that the latter lies in field-free space. If 
it does not, the relation between p~l)(z 1) and x~l)(zl) becomes more com- 
plicated and it is easier to derive the real aberrations expressed in terms 
of position and gradient in the object plane via those based on position in 
two separate planes (object and aperture). In the case of asymptotic aber- 
rations, which describe the coupling between (field-free) object space and 
image space, this problem does not arise and the appropriate aberration 
coefficients may be obtained without difficulty. 
The other physically significant choice of constraints is 
(1) 
(1) 
Xjl = xj2 = 0 
(22.25) 
so that the unperturbed and perturbed rays must pass through the same 
point in two different_ planes, Zl and z2. This situation is shown in Fig. 
22.2b; the ray R is clearly not the same as that in Fig. 22.2a. 

x,y 
22. PERTURBATION THEORY • GENERAL FORMALISM 
R 
308 
x,y 
Fig. 22.2: The constraints described by (a) (22.24) and (b) by (22.25). 
Some caution is needed when selecting the constraints, since not all 
combinations are permissible on every occasion. Thus (22.25) cannot be 
used when the planes z = Zl and z = z2 are conjugate, since all the rays 
through a point P~ in the neighbourhood of/'2 will intersect in a point 
close to /'1; apart from this point, the neighbourhood of P1 will not be 
connected by rays to P~. 
We shall therefore study (22.23) in two forms. For constraints (22.24), 
we have 
(') 
(22.26) 
and for (22.25), 
AS1/2 
(1)AZ 2 
p~11)Azj1 
(22.27) 
= Pj2 
J 
-- 
From (92.26), we obtain the very important pair of equations 
OZkl 
OZkl 
O;Zkl 
0S[2 
_(1) OZj2 
_(1) OPj2 
Opkl --Pj20Pkl 
z J20Pkl 
(22.28) 

22. PERTURBATION THEORY 
309 
Equation (22.27) we shall handle slightly differently. We shall use it 
to express aberrations in some arbitrary plane, frequently the image plane, 
in terms of position coordinates in the object plane (suffix o) and aperture 
plane (suffix a) in a system. Returning to (22.23), we first set zl = Zo, 
X~lo ) = O, giving 
A SoI2 
(1) 
---- Pj2 " Axj2 -- x~12 )" APj2 -- p~lo) " AXjo 
_(1) = 0 giving 
and then set zl = za, zj~ 
Hence 
ASa/2 __ p~l)./~=j2 -- =~)" Apj2 -- P~la)" Axja 
(22.29a) 
(22.29b) 
O(P12, X12) 
0(P22, X22) 
+ 
(22.33) 
o(~,~) 
o(~,~) 
We have seen that the Lagrange brackets are invariant (5.34) so that A is 
likewise independent of z. Hence 
h = 
O(Plo, P2o) 
O(Pla, P2a) 
= 
(22.34) 
O(Xla,X2a) 
C~(Xlo,X2o) 
If there exists an image plane z = zi in which the object plane z = Zo 
is imaged stigmatically, all rays from a point in Zo will be reunited in z/ 
irrespective of their point of intersection with the plane z = za" 
OXki = 0 
(22.35) 
Ozja 
where [A, # ] denotes 
o+2 
opi2 
osL = 
i)xk. 
(22.30) 
OSa/2 
_(1) OXj2 
X~12) G')Pj2 
OXko = Pj2 0xko 
Oxko 
(1) 
_(1) 
These may be solved for the unknown quantities Pj2 and 
The deter- 
xj2 • 
minant of (22.30) is given by 
A = _ 0(p¢2, z¢2) 
O(Zjo,Xj.) 
(22.31) 
and may be expanded as a product of Lagrange brackets, 
A = --[Z~o, X2o][X~a,Z2a] + [X~o,X~a][X2o, X2a] 
(22.32) 
- [~,o, ~2~][~o, ~1~] 

310 
22. PERTURBATION THEORY • GENERAL FORMALISM 
and, solving (22.30) when (22.35) is satisfied, we find 
X~ 1) 
1 ( Ov2i OsIoi 
OV2i OSIoi ) 
: (OPli OSloi 
OVli OSIoi) 
x~li) = ~ 
OX2a OZla OZla OZ2a 
with 
(22.36) 
A = O(Pli,P2i) 
We note that only the perturbation characteristic Sozi appears in (22.36). 
Second-order perturbations 
Returning to (22.16) and (22.17), we see that 
Z2 /{ 
S~)= 
M H + DIM ' + D'r'M + -~(D t M 
dz 
zl 
and using (22.19) with ~J = x~ ), which tells us that 
Z2 
gl 
(22.37) 
(22.42) 
Z2 
Zl 
(2) 
+ pj 
. 
- 
The perturbed form of (22.19) enables us to simplify this further. Ap- 
plying the operator P to (22.19), we find 
1:2 
~J Oxj 
+~j 
Ox} 
dz 
(22.41) 
Zl 
= ~j2 PPj2 - (jlPPjl 
so that for (j = x 
, 
z2 
(1) (I) 
(1) (1) 
DI(M ! + DIM) dz = Pj2 xj2 -Pjl xjl 
z1 
(22.39) 
we may write 
(22.3s) 

22. PERTURBATION THEORY 
311 
1 
1)2 
This enables us to eliminate either DIM I or ~(D 
M from (22.40); we 
obtain 
_(1)X 
S~2) -Pj2Xj2- 
(2) + Pj2-(1)-(1)x'j 2 
(PjlX~21) + p~ll)xjl ) 
+ f {M" - 
dz 
(22.43a) 
or 
S~)_ 
(2) 
1 (1) (I) 
_(2) 
1 (I)(I) 
--Pj2Xj2 
+ "2PJ2 Xj2 --(PjlXjl 
+ -2PJl Xjl ) 
f 
1 
r 
I 
+ j{M ~ + -~D M } dz 
and writing 
SIII2 =/(MI 
I 
1 
) 
- 5(DI)2M 
dz 
"I( 
,o,),z 
S12 = 
M II + -~ 
M I 
it is easily shown that 
(22.43b) 
(22.44) 
, 
(2) 
_(2) 
AS1/2 / = ~,Pj2 " Axj2 - 
• Apj2) 
x j2 
--(p~21)" AXjl -- x~21 ) " Apj 1) 
, (1) 
(1) 
_(1) 
(1) 
-- ~,xj2 . Apj 2 - Xjl " Apj 1) 
~II 
, (2) 
(2) 
AS12 = ~,Pj2 " Axj 2 -- Xj2 " APj2) 
, (2) 
- p,1 
.apjl) 
1, (1) ~ 
(1) 
(1) 
,,L (1)\ 
-- "2 ~,xj2 " z'xPj2 --Pj2 
" I'AXj2 ) 
1/ (1) 
(1) 
_(1). A,x(jll) ) 
"{" -2 ~,Xjl " Apjl - Pjl 
(22.45) 
Hence 
j20Xka 
zJ2 0Xka -OXka 
Ozka 
(1) 
_(2) Oxj2 
(2) OPj2 
OSolI 2 
_(1) uPj2 
p~2 -5~zk-,, 
zJ~ OZko = Ozko + ~j2 0zko 
(22.46) 
j2) 
_(2) 
In an image plane, z = zi, the 
which may be solved for x. 
and pj . 

312 
22. PERTURBATION THEORY : GENERAL FORMALISM 
solution collapses to the simpler form 
zli = ~ 
Ozl. 
Oz2. + 
Oz2~ 
(22.47) 
.. (1) 
OPli ( OS°I/ 
} 
Ox2~ / 
where A is the corresponding determinant. (Note that the summation is 
implicit over j,j = 1,2, whereas i is simply a label signifying "image".) 
Equations (22.47) are complicated in appearance but a physical mean- 
ing may be associated with the various groups of terms. When we analyse 
a particular system, we first examine its paraxial properties, then its pri- 
mary aberrations, characterized essentially by M z and hence S I. If we 
then proceed to the secondary aberrations, a contribution will come from 
M II and hence S II. A further contribution arises because it is the paraxial 
solutions that we substitute in M II and these are not the best approxima- 
tion available since we already know the primary aberrations. This further 
contribution is the secondary aberration term arising from the primary 
aberrations. 
Before applying these general formulae to particular types of system, 
we must mention one further degree of complication that can arise. In the 
case of primary aberrations, those obtained by first-order perturbation the- 
ory, the results are additive, in the sense that if M z consists of two parts, 
M z = M[ + M/, the calculations may be performed separately for M / and 
M~ and the results added. This is no longer true for second-order pertur- 
bations, and we may need to introduce a new parameter, #, in addition to 
~. This typically arises when geometrical and chromatic aberrations are 
being considered; for primary aberrations, we have merely to calculate M I 
for the geometrical aberrations and M / for the chromatic aberrations and 
(1) For the secondary aberrations, 
add the resulting perturbation terms x j . 
there will be mixed terms, arising from the interplay between the two con- 
tributions. These are incorporated in the theory in the following way. We 
denote functional perturbations with respect to # by the superscript J and 
TIM now becomes 
TIM = M + AM z + I.tM J 4- A2M n 
(22.48) 
+ A#M IJ + tt2M JJ +... 

22. PERTURBATION THEORY 
313 
The order in which the perturbations are considered is of no importance, as 
we can readily see on physical grounds. If the contribution to the secondary 
geometrical aberrations is gradually increased from a negligibly small value, 
the chromatic contribution remaining fixed, the resulting effects must be 
the same as those observed if the geometrical aberrations are fixed at their 
final value and the chromatic aberration gradually increased from a small 
value. 
The formulae for a single perturbation parameter A given above enable 
us to manipulate all the terms of an expansion of the form (22.48) except 
the mixed term AtoM IJ. We merely state the results. The single-parameter 
reasoning may be followed provided that the following replacements are 
made: 
M 1I ._.+ M IM g 
(DI)2M ~ 2DID g 
DIM z ~ DiM J + DJM I 
(22.49) 
We define 
z2 
S[J'--/(MIJ-DID, 
JM) dz 
Zl 
Z2 
SIJ:-/{MIMJ--~- 
~(DIMJ-[-DJMI)} 
dz 
Zl 
(22.50) 
for which 
"["(X//"I " /~ P J1 "4- X j J" /~ P I1 ) 
- 
1 
I 
J 
I 
1 i 
J 
i 
. Ap]  + 
. Ap 
,) 
1 
+~(p~ . ~Xx]~ + p]~ . ZXxI~ 
1 
--~(P/1" AxJ1 -[-PJI" AXI1) 
+(pIJ. Axj2 - x JJ. Apj 2) 
__(pIJ. AXjl __ xlJ. Apjl) 
(22.5 ) 

314 
22. PERTURBATION 
THEORY 
• GENERAL 
FORMALISM 
in which we have been obliged to label zj and pj with I and J to dis- 
z might represent the primary 
tinguish the different contributions. Thus z j 
geometrical aberration, for example, and x ] the chromatic aberration. 
The mixed forms of (22.46) are as follows" 
p(:) a~j: 
_~ apj: 
aSo~ ~ + ~: apji + ~ji ap~: 
j20Xka 
~;j2 0Xka --" OXk'--~" 
~ 
C~Xk a 
C~Xk a 
o~j= 
opj= 
osW 
~ opj~ 
~ op~ 
Ox~o - Oxko 
~ 
XJ2 Oxko 
(22.52) 

23 
The Relation Between Permitted Types 
of Aberration and System Symmetry 
23.1 Introduction 
The nature of the aberrations of any given system is entirely determined 
by its symmetry. A classification of the various system types was proposed 
by Sturrock (1951a) and a detailed exploration of the relation between 
aberrations and symmetry is to be found in Hawkes (1965a). 
Consider a ray passing through an entirely general system, intersecting 
three planes (or even surfaces) normal to the optic axis, itself in general 
curved. The point of intersection of the ray with an arbitrary "current" 
plane, z = Zc, is a function of the point of intersection with the other two 
planes, which we refer to as the object plane z = zo and the aperture plane 
z = za (Fig. 23.1). Thus 
wc = X~ + iY~ - f(wo,-Co, wa, ~) 
(23.1) 
In this chapter, a bar over a symbol denotes its complex conjugate (thus 
= X-iY). Since we are interested in the optical behaviour of the system, 
and hence in rays that remain in the vicinity of the optic axis, we expand 
Wc as a power series: 
-' 
- 
(23.2) 
a,d,-y,~_>0 
in which the complex coefficient (c~/~75) is a function of z. Suppose now 
that the system is such that, on simultaneously moving the object point 
Wo to Woexp(27ri/N) and the aperture point wa to wa exp(27ri/N), the 
point wc moves to wc exp(27ri/N). We then say that the system is N-fold 
symmetrical. Clearly, not all values of N and shapes of axis are compatible, 
the higher symmetries only being found with a straight optic axis, for 
example. From (23.2), it is readily seen that in an N-fold symmetrical 
system, the indices a,/~, 7 and 5 can take only those non-negative integral 
values for which 
~- /3 +7-5-1+ 
kN 
(23.3) 

316 
23. RELATION BETWEEN ABERRATION AND SYSTEM SYMMETRY 
Wo : xo +i Yo 
~. xc 
Xa 
Z 
& 
Fig. 23.1" General ray intersecting the object, aperture and current surfaces at the 
points w0, wa and wc respectively. 
where k is a positive or negative integer or zero. For rotationally symmetric 
systems, only the values that satisfy 
a- fl + 7- 6 = 1 
(23.4) 
are acceptable. The permitted values of a, fl, 7 and 6 for values of N from 1 
to 6 are shown in Table 23.1 (Hawkes and Cosslett, 1962; Hawkes, 1965a). 
The condition that restricts the values of a, ~, 7 and 6 contains only 
the combinations (a + 7) and (/3 + 6), and this suggests a simpler method 
of obtaining the permissible members in the expansion for we. We need 
consider only one of two particular pencils of rays, either the pencil through 
the axial object point (O,O, zo) or the pencil through the axial aperture 
point (0, 0, Za). The point we can now be written 
and hence 
)wo o 
or 
we = E 
(~r/)w~W~a 
(23.5) 
¢,,>0 
~,,>0 
~-r/=l+kN 
We now have only to replace Wo or wa by Wo+Wa for the condition a-fl+ 7- 
6 = l+kN to be automatically satisfied, since the binomial theorem ensures 
that a + 7 = ~ and/3 + 6 = 7/. In optical terms, we have considered first two 
particular pencils, of which one could be affected only by distortions, and 
could not produce an indistinct image, while the other could be perturbed 
only by wholly aperture-dependent aberrations. To obtain the remaining 
aberrations we replaced these pencils by off-axial pencils, passing through 
neither the object nor the aperture origin. 
As an example of this, we might consider the secondary aberrations 
of N = 2 systems, which are fifth order. From Table 23.1, we see that 
there are 56 of these. The condition that ~- 7/ = 1 + 2k subject to ~ + 
7/ = 5 allows ~ and 7/ to take the values (50), (41), (32), (23), (14) and 

23.1 INTRODUCTION 
317 
Table 23.1 The Values of a, fl, 7 and 6 for N = 1 to N = 6 and Rotational Symmetry 
Each row contains terms for which c~ + ~ + 7 + 6 is the same (roman numeral), and 
each column all the terms with some particular value of 7- 6 (arabic numeral). The 
column headed 'D' contains distortions, for which 7 = ~ = 0. 
Rotational symmetry" (a ÷ 7) - (~ ÷ 6) = 1 
D 
-2 
- i  
0 
1 
2 
3 
I 
I000 
. 
0010 
III 
2100 
2001 
1011 
0021 
0120 
iii0 
V 
3200 
3002 
3101 
2111 
0032 
1220 
0230 
• 
. 
2012 
1022 
2210 
I031 
i121 
In all the subsequent lists, the rotationally symmetric terms just tabulated all recur; 
they are therefore not repeated in every list. 
N=6. 
(a + 7) - (fl+ ~i) = -5, 1 
D 
-5 
-4 
-3 
-2 
-1 
V 
0500 
0005 
0104 
0203 
0302 
0401 
N=5. 
(a+ 7) - (fl+ ~) --4, 
1 
D 
-4 
-3 
-2 
- i  
IV 
0400 
0004 
0103 
0202 
0301 
N=4. 
(a÷7)-(fl÷6)=-3,1,5 
D 
-4 
-3 
-2 
-1 
III 
0300 
0003 
0102 
0201 
V 
1400 
1004 
1103 
1202 
1301 
5000 
0014 
0113 
0212 
0 
5 
4 
3 
2 
1 
V 
0311 
0050 
1040 
2030 
3020 
0410 
• 
4010 
N = 3 .  
( ~ ÷ 7 ) - ( ~ ÷ 6 ) - - 5 , - 2 , 1 , 4  
D 
-5 
-4 
-3 
-2 
- I  
II 
0200 
• 
0002 
0101 
IV 
1300 
• 
I003 
1102 
1201 
4000 
• 
0013 
0112 
V 
0500 
0005 
0104 
0203 
0302 
0401 
0 
4 
3 
2 
l 
IV 
0211 
0040 
I030 
2020 
0310 
• 
• 
3010 

318 
23. RELATION 
BETWEEN 
ABERRATION 
AND SYSTEM 
SYMMETRY 
N = 2. 
(~ + 7) - (]9 + 6) = +l,-4-3,-4-5 
D 
-5 
-4 
-3 
-2 
-1 
I 
0100 .
.
.
.
 
0001 
III 
3000 . 
. 
0003 
1002 0012 
0300 . 
. 
. 
0102 0201 
1200. 
. 
. 
1101 
V 
5000 0005 1004 2003 2102 2201 
4100 . 
0104 0203 1202 1301 
2300 . 
. 
1103 1013 4001 
1400 . 
. 
0014 0113 1112 
0500 . 
. 
. 
0302 0401 
.
.
.
.
.
 
0023 
.
.
.
.
.
 
0212 
0 
5 
4 
3 
2 
1 
III 
0111 
. 
. 
0030 1020 0210 
.
.
.
.
.
 
2010 
V 
1211 0050 1040 1130 0320 
1310 
0311 
. 
0140 0041 3020 3110 
3011 
. 
. 
2030 2120 0221 
0122 . 
. 
. 
1031 2021 
.
.
.
.
 
4010 
.
.
.
.
.
 
0410 
N = 1. 
(a + 7) - (/~ + 6) = 0, +l, :h2, =h3, :t:4, +5 
+1 is included in this list 
D 
-5 
-4 
-3 
-2 
-1 
0 
0000 .
.
.
.
.
 
I 
1000 .
.
.
.
 
0001 
0100 .
.
.
.
.
 
II 
2000 . 
. 
. 
0002 0101 
1100 .
.
.
.
 
1001 
02O0 .
.
.
.
.
 
III 
3000 . 
. 
0003 0102 2001 
2100 . 
. 
1002 0201 
1200 .
.
.
.
 
1101 
0030 .
.
.
.
 
0012 
IV 
4000 . 
0004 0103 2002 3001 
3100 . 
. 
1003 0202 2101 
2200 . 
. 
. 
1102 1201 
1300 . 
. 
. 
0013 0301 
0400 .
.
.
.
 
1012 
.
.
.
.
.
 
0112 
V 
5000 0005 0104 2003 3002 4001 
4100 . 
1004 0203 2102 3101 
3200 . 
. 
1103 1202 2201 
2300 . 
. 
0014 0302 1301 
1400 . 
. 
. 
1013 0401 
0500 . 
0113 2012 
.
.
.
.
.
 
0212 
.
.
.
.
.
 
1112 
.
.
.
.
.
 
0023 
0 
5 
4 
3 
2 
1 
.
.
.
.
.
.
 
I 
.
.
.
.
 
0010 
II 
0011 
. 
. 
. 
0020 
1010 
.
.
.
.
 
0110 
III 
1011 
. 
. 
0030 1020 2010 
0111 
. 
. 
0120 0210 
• 
. 
1110 
.
.
.
.
.
 
0021 
IV 
2011 
. 
0040 
1030 2020 3010 
1111 
. 
. 
0130 1120 2110 
0211 
. 
. 
0220 
1210 
0022 . 
. 
. 
0031 0310 
.
.
.
.
 
1021 
• 
. 
. 
0121 
V 
3011 0050 1040 2030 3020 4010 
2111 
. 
0140 1130 2120 3110 
1211 . 
. 
0230 1220 2210 
0311 
. 
. 
0041 0320 
1310 
1022 . 
. 
1031 0410 
0122 . 
. 
0131 2021 
.
.
.
.
.
 
1121 
.
.
.
.
.
 
0221 
.
.
.
.
.
 
0032 

23.1 INTRODUCTION 
319 
Table 23.2 The Values of (~r/) Corresponding to each Type of Symmetry 
The bracketed symbols indicate the symmetry class of which the corresponding aber- 
rations are typical. R signifies rotationally symmetric. 
N=I 
N=2 
N-3 
N-4 
,~+r/= 1 
,~+r/= 2 
,~+r/= 3 
,~+ r/=4 
10(R) 
20 
30(2) 
40(3) 
01(2) 
ii 
21(R) 
31 
02(3) 
12(2) 
22 
03(4) 
13(3) 
04(5) 
10(R) 
01 
30 
21(R) 
12 
03(4) 
i0(R) 
02 
21(R) 
10(R) 
21(R) 
03 
N-5 
10(R) 
N=6 
10(R) 
rotational 
10 
symmetry 
21 
40 
13 
04 
~+q=5 
50(4) 
41(2) 
32(R) 
23(2) 
14(4) 
05(6) 
50(4) 
41 
32(R) 
23 
14(4) 
05(6) 
32(R) 
05(6) 
5O 
32(R) 
14 
32(R) 
O5 
32 
(05). 
Of these, (~r/) = (50) generates six aberrations and (~r/) = (14) 
generates ten aberrations; these together are characteristic of N = 4. The 
term (~q) = (32) generates the 12 aberrations characteristic of rotationally 
symmetrical systems. The six aberrations characteristic of N = 6 (which 
also afflict N = 3 systems, therefore) are generated by (~q) = (05). Finally, 
(~q) = (41) and (~r/) = (23) generate the 22 aberrations peculiar to N = 2 
systems. The full results are set out in Table 23.2. 
A particularly simple way of discussing the effects of each aberration 
term, ( af175)w'~o 
-~--6 
w a w a, or group of aberration terms, has been explored 
in detail by Chako (1957), who employed only cartesian coordinates and 
considered only rotationally symmetric systems. Amboss (1959) used the 
same method with complex coordinates to examine slightly imperfect sys- 
tems. If we wish to interpret geometrically an expression of the form 
-- 
W a W a 
(23.6) 
we can obtain a curve that is typical of each type of aberration on a general 

320 
23. RELATION BETWEEN ABERRATION AND SYSTEM SYMMETRY 
plane in image space by considering a pencil of rays that emerges from 
an object point Wo=Constant and is restricted by an annular stop in the 
aperture plane I wa I = constant = ra. These are the curves which Chako 
calls 'characteristic curves'. We can then write 
wc = y~ r~+~r~. +~ [ a/376 ] exp i{a"~6 + (a -/3)0o + (7 - 6)0. } (23.7) 
in which (~f17~)=:1 aflT~] eia~'t6. For each term, therefore, we have 
(ABrA) =1 a/~7~ I r~+~r, ~+8 
w~ = (ABrA)e 
i(7-~)°" 
~/~7~'-%+(~-~)0o 
. 
(23.8) 
If 7 = 6 = 0, we can consider the pencil that passes through a fixed 
point in the aperture plane and intersects the object plane in an annulus, 
I wo I= r o = constant. 
Not all the coefficients (a~7~) are independent, as we can see by con- 
sidering the point characteristic function S, which we expand as a power 
series in X, X', Y and Y': 
S = S (°) + S (1) + S (2) +... + S (0 +... 
(23.9) 
in which each group of terms, S (r), contains only products of degree r 
in the off-axial coordinates. Of these groups, S (°) is a constant and will 
not concern us further; S (1) is zero since the axis must also be a possible 
ray; the Gaussian or first-order (primordial) properties are given by 5 '(2) 
provided that N < 2 and the primary, secondary and further aberrations 
are given by successive nonzero terms of S. 
The function S is a definite integral of a physical quantity along a real 
path between two points; it must therefore be real and must also satisfy 
the same symmetry conditions as the whole system. This suggests that we 
might write each of the even components of S as a quadratic or Hermitian 
form 
S(r) = QTr RQ~ 
or 
S (~) = H* rH~ 
(23.10) 
Q is a column matrix and QT its transpose; H is also a column matrix and 
H* is the conjugate complex matrix of H T ; R and r are square matrices, 
which we shall refer to as the coefficient matrices. 
We have already used a four-symbol notation (aflT$) to enable the 
coefficients of the terms in the series expansion of wc to be written down 
directly. We shall employ a similar notation for the elements of the coef- 
ficient matrices, R and r. Each element will be denoted by a four-figure 
symbol (pqrs) that is automatically associated with the term ,,,p~q,,,r~s 
wo 
~ O ~ t l  ~tl 
" 

23.1 INTRODUCTION 
321 
Whereas a + fl + 7 + 6 is equal to the order of the corresponding aberration, 
p + q + r + s is equal to the order of the terms in the characteristic function 
that correspond to the same aberration, namely a + fl + 7 + 6 + 1. Since 
S must be real, we can immediately conclude that 
(pqrs) = (q--p-~) 
(23.11) 
All the relations that connect the aberration coefficients stem from this 
property. In the simplest case, that of rotational symmetry, the relation 
which we encounter below between the two parts of the coma coefficient is 
a consequence of 
(1012) = (0121) 
(23.12) 
Similarly, the fact that under certain conditions, quadrupole lens systems 
are fully characterized by three, and not four, aperture aberration coeffi- 
cients can be deduced from 
(0013)- (0013) 
(23.13) 
The condition used by de Broglie (1950, pp.131-2) to obtain the in- 
terrelations for axially symmetric systems can be straightforwardly derived 
from (23.11). This relation between the elements of the characteristic func- 
tion does, however, bring out the fact that de Broglie's condition is a con- 
sequence of more fundamental relations which remain true, even though 
the actual aberration coefficients may no longer be so simply connected. 
If the N-fold symmetry of a system is reinforced by a symmetry plane, 
the coefficients (pqrs) are either all real or all purely imaginary. For, if the 
system possesses a plane of symmetry, S will be invariant under a change 
from right-handed to left-handed axes, and hence (-1)P+a+r+S(pqrs) -- 
(qpsr). Since we have already shown that (pqrs)= (q-~), (pqrs) must be 
real if p + q + r + s is even, and imaginary if p + q + r + s is odd. 
For simplicity, we study the aberrations in field-free image space, tak- 
ing z - z~ as the exit pupil of the system. Then in image space, we have 
7z 
z=zo 
or 
w(z) = {1 + iB(z - z~)/A}w~ + 2 ~  
z- z~ OSo~ 
A 
0~ 
in which we have used the fact that the terms in S (2) containing X' and Y' 
1 
Y'~) 
B(X' 
- 
can always be cast into the form ~A(X '2 + 
+ 
Y 
XY'). Thus 
w(z) has the form 
OSo~ 
w(z) = Cwa + D 0~ 
(23.15) 

322 
23. RELATION BETWEEN ABERRATION AND SYSTEM SYMMETRY 
in which C may be complex and D is real. 
It is to be noted that the analysis set out here enables us to identify all 
aberrations permitted by symmetry but some of these may be forbidden 
for other reasons. General laws have not yet been established but some 
rules of practical importance have been found by Shao (1987a,b) and Shao 
and Crewe (1987). 
We now consider the image formation and aberrations for each type 
of symmetry, as characterized by N. 
23.2 N : 
1 
This is the most general case: the system is wholly arbitrary, the axis 
may be straight or curved, and few generalizations can be made about the 
image formation. The function S(~ ) is of the form 
T 
/ °//2ooo 
Wo 
0 
2000 
1001 
1010 
Wo 
w. 
0 
0 
0020 
O011(r) 
w. 
~. 
0 
0 
0 
0020 
~. 
(23.~6) 
and using (23.15), we find that these coefficients are related to the (aflT~) 
of (23.6) thus: 
(1000) = D(1001); 
(0100) = D(1--0~); 
(0001) = 2D(0--0--~) 
N(0010) = D(0011) 4- N(C); 
.~(0010) = ~(C) 
To understand what imagery such a system would produce, we consider 
a pencil of rays emerging from a fixed object point and restricted by an 
annular stop, [ wa [= ra = constant. We denote (1000)Wo 4- (0100)@o by 
U, and we write (aflT~) =1 aflT~ [ exp iafl~'~ and w = re i°. We find 
We -- U -[- ra [ 0010 I e i(°'+°°1°) 4- ra 1ooo1 [e -i(0"-°°°1) 
or 
N 
N 
(Wc -- U)e -½i(0010+0001) = ra 10001 l e ~°" + r~ [ 0010 [ e -~°" 
in which 
o o = o. + ~- (66i~o - oN~ ) 
(23.17) 
* (r) indicates that the adjoining element is real 

23.2 N= 1 
323 
In general, therefore, the pencil will emerge from the system as an 
astigmatic bundle of rays, which collapses to two mutually perpendicular 
focal lines in two particular current planes where [0010[ + [ 0001 [= 0 
and [0010 [ - [0001 [- 0; these focal lines are inclined to the axes wc at 
an angle which depends upon the position of the object point. If a point 
object approaches the system from infinity, the focal lines may execute any 
one of three possible manoeuvres. They may swivel round the axis of the 
system, turning always in the same sense; in this case (0010 + 0001) changes 
monotonically. Systems in which the focal lines behave in this way were 
called 'gedrehte' or 'tordierte Systeme' by Gullstrand, who first discussed 
them (1915, p.20). Alternatively, the lines may swivel round the axis until 
the object point reaches one of the two 'orthogonal points', beyond which 
they turn in the opposite sense; when the object point reaches the second 
orthogonal point, the focal lines revert to their original sense of rotation. 
These are Gullstrand's 'zur(~ckgedrehte' or 'retordierte Systeme'. Finally, 
these two orthogonal points may coincide. Between the two orthogonal 
points of the preceding type of system, the focal lines unwind through a 
quarter-turn; in these 'halbgedrehte' or 'semitordierte Systeme', the focal 
lines turn through the same angle instantaneously, with the result that as 
the object point crosses the coincident orthogonal point, the focal lines 
appear abruptly to change places, but continue to rotate in the same sense. 
In a stigmatic system, the image of a pair of straight lines X o = const 
and yo = const will be 
 ( 000 - 0100) 
Yi = - ~(1000 - 0100) xi 
~(1000 + 0100)~(1000 - 0100) + ~(1000 -t- 0100)~(1000 - 0100) 
+ 
 ( ooo - o oo) 
Xo 
and 
(23.18a) 
 ( 000 + 0 00) 
yi = ~(1000 + 0100) zi 
~(1000 + 0100)~(1000 - 0100) + ~(1000 + 0100)~(1000 - 0100) 
+ 
~(1000 + 0100) 
yo 
(23. sb) 
which represents a pair of straight lines, no longer at right angles; a rect- 
angle is therefore imaged as a parallelogram. 

324 
23. RELATION BETWEEN ABERRATION AND SYSTEM SYMMETRY 
The primary aberrations are second order, and correspond to S(3); 
using (pqrs) = (q--p-~), we can write the latter in the form 
T , 
ooo 
x oo 
o 
1o 01oo  
S (3)_ / ) / w  
1200 
3000 
0 
1002 
1020 
w, 
2010 
2001 
1110 0030 
0021 
wa 
2001 
2010 
1110 
0021 
0030 
2 
W o 
I011 1 _--..2 
W o 
I011 
wo~o 
2 
0 
W a 
0 
=2 
W a 
WaWa 
(23.19) 
No element is necessarily real. 
I 
In an arbitrary image plane, the primary aberrations we are given by 
(22.30); we substitute 
We : (lO00)Wo 4- (0100)~o -F (O010)Wa 4- (O001)~a 
and 
and obtain 
Dw I - 2A 
sc = Aw'c - iBw¢ 
OOlO OOOl OOOl as(o~)lOw. 
lOOO OlOO OlOO os(~)lO-~o 
0001 0010 0010 OS(~)/Ow. 
0100 I000 
I000 
OS(3)/OWo 
(23.20) 
Each of the elements in the fourth column is composed of ten members. 
For further details, see Hawkes (1965a). 
N = 1. Systems with a plane of symmetry 
The axis of the system is now a curve lying in a plane, and we shall sup- 
pose this to be the plane which also contains the y-axis. Certain deflection 
systems and 3-spectrometers fall within this class. The primary aberra- 
tions are still second order, but the function S (3) must be independent of 
the signs of X o and x,; it is therefore of the form 
2 
T 
2100 
2001 
X o 
XoXa 
1110 
1011 
( 
) 
2 
0120 
0021 
Yo 
X a 
y~ 
0300 
o2o~ 
Y° 
y~ 
olo2 
0003 
(23.21) 

23.3 N= 2 
325 
and so 
k~x I =h~¢{212100]Xoyo + 212001]xoy~ + [lllO]yoxa + [1011]xaya} 
- g~{(lllO)xoyo + (1011)xoy, + 2(0120)yoxa + 2(0021)xaya} 
2 
[1110]XoXa 
[0120] 2 
kyy I =hyc{[21OOlxo + 
+ 
x a 
+ 3[03001y 2 + 2[02011YoYa + [01201y 2 } 
- 
+ 
+ (0021)   
+ (0201)y o + 2(0102)yo 
+ 3(0003)y   } 
(23.22) 
In a general plane, therefore, ten coefficients suffice to characterize the 
imagery, and in the image plane of a stigmatic system, eight. 
The aperture aberrations are of the form 
I 
x c = (O011)xaya, 
y/ = (0020)x2a + (0002)y 2 
(23.23) 
1 {(0020)-+-(0002)}r 2) 
which represents an ellipse, centred on the point (0, 
1 2(0011) 1 2 
with axes ~r a 
, ~r a {(0020)- (0002)}. For a circular aperture, the 
envelope of this family of ellipses is a pair of straight lines, inclined to the 
y-axis at an angle arccot 2X/(0020)(0002)/(0011 ). In a stigmatic orthomor- 
phic system, (0011) = 2(0020), and the angle becomes arccot X/(0002/(0020) 
or arccot X/3(0003 / (0021 ). 
The distortions are similar in nature; the remaining aberrations are 
types of astigmatism, and the aberration curve for a fixed object point and 
an annular aperture is a tilted centred ellipse. 
The secondary aberrations are third order; the contribution from S (4) 
is analysed in Hawkes (1965a). 
23.3 N-- 
2 
Systems for which N = 2 and there is no symmetry plane may consist of 
any combination of round lenses and quadrupole lenses in any orientation; 
the lenses may be either electrostatic or magnetic and the electrostatic 
lenses need not be excited symmetrically nor need they be geometrically 
symmetric. The aberrations of quadrupole systems in which the azimuthal 
alignment of the individual members is imperfect thus fall within this class. 
The Gaussian imagery is no simpler than that of general systems, but the 
primary aberrations are now third order. Both the primary and secondary 
(third-order) aberrations are analysed in detail in Hawkes (1965a). 
Electron optical systems with straight axes may be orthogonal without 
possessing a plane of symmetry. These are the systems which comprise 

326 
23. RELATION 
BETWEEN 
ABERRATION 
AND SYSTEM 
SYMMETRY 
Du~ek's 'erster Hauptfalr (1959) and since they involve a complicated and 
delicate balance of electric and magnetic forces, they have as yet found 
no practical employment. The surfaces in which electrons experience no 
expulsive force are not planes but curved surfaces, which twist about the 
axis within the lens fields. 
Since such systems are orthogonal, it is simpler to use cartesian coor- 
dinates, a:-t S (4) can therefore be written 
2 
T 
X o 
S(4) 
2 
A 
--- 
Xa 
yl 
XoXa 
2 
2 
Xa 
XoXa 
YoY~ 
XoYa 
XaYo 
XoYo 
XaYa i 
(23.24) 
where 
A 
4000 
2200 
2020 
2002 
3010 
2101 
3001 
2110 
0 
0400 
0220 
0202 
1210 
0301 
1201 
0310 
0 
0 
0040 
0022 
1030 
0121 
1021 
0130 
0 
0 
0 
0004 
1012 
0103 
1003 
0112 
0 
0 
0 
0 
0 
1111 
0 
0 
3100 
2011 
1300 
0211 
1120 
0031 
1102 
0013 
0 
0 
The aberrations associated with perturbation characteristic functions of 
this form resemble the secondary aberrations of N = 1 systems. 
The aperture aberrations are of the form 
I 
hxc 
2 
[1003] 3 
xc = --~{[10301x 3 + [1012]x~y~ + [1012]x~y~ + 
y~} 
gx~ {4(0040)xa + 3(0031)x2ya + 2(0022)x,y 2 + (0013)y 2 } 
kx 
(23.25) 
-~{[01301 x3 + [0121]x~y~ + [0112]x~y~ + 
} 
g'~ {(O031)x 3 + 2(o022)x~y~ + 3(o013)xay] + 4(0004)y~} 
ky 
When the imagery is stigmatic, the aberration curve in the stigmatic image 
plane simplifies to the form 
I 
3 
3~x2y~ 
"Tx 
2 
-Ah~ixi = OllXa + 
+ 
aYa + 5Y 3 

23.3 N-- 2 
327 
I 
The secondary aberrations involve S (6). 
N = 2. Systems possessing a plane of symmetry 
Systems belonging to this class are automatically orthogonal; they rep- 
resent the special case of the preceding class for which the curved orthogo- 
nal surfaces collapse into a pair of mutually perpendicular planes (Du~ek's 
'verdrehungs~eie Orthogonalsysteme'). The elements of such systems may 
be electrostatic and magnetic quadrupole lenses, and round electrostatic 
lenses; all the electrodes of the electrostatic quadrupoles must lie in the 
same pair of (mutually perpendicular) azimuthal planes, however, and all 
the polepieces of the magnetic quadrupoles must lie in the pair of azimuthal 
planes that are inclined to the electrode planes at 45 ° . The electrodes need 
be symmetrical in neither excitation nor geometry, provided of course that 
any asymmetry is compatible with the symmetry plane. 
In complex notation, the presence of the symmetry plane implies that 
all the elements of the coefficient matrices are real; in the cartesian nota- 
tion, S (4) and 5 '(6) contain only even powers of x and even powers of y. 
Examining equation (23.24), we can see that S (4) is obtained by selecting 
the first six columns of the coefficient matrix, and retaining the first six 
elements of the ten-element column matrix, thus: 
S(4) -- 
2 
T 
2 
Xo 
4000 
2200 
2020 
2002 
3010 
2101 
Xo 
yo 2 
0 
0400 
0220 
0202 
1210 0301 
Y°2 
2 
2 
0 
0 
0040 
0022 
1030 
0121 
x 
X a 
y] 
0 
0 
0 
0004 
1012 
0103 
y2 
XoXa 
0 
0 
0 
0 
0 
1111 
XoX,, 
YoYa 
(23.26) 
The primary aberrations in a general plane are therefore given by 
I=h~c{4140001 3 
2 
[1030]x3 [1012]xa 2 
k~xc 
x o + 212200]XoYo + 
+ 
ya 
+ xa(313010]X2o + [1210]Yo 2) + 2[2101]xoyoya 
+ 212020]XoX2a + 212002]Xoy~ + [llll]yoxaya } 
- 
g~{(3010)X3o + (1210)xoy2o + 4(0040)x~ + 2(O022)Xay] 
+ xa(2(2020)X2o + 2(0220)yo 2) + (llll)xoYoYa 
3 
+ 3(1030)XoXa + (1012)xoy] + 2(0121)yoxay~ } 
k,y I =h,~ {212200]X2oYo 
+ 4[0400]yo 3 + [0121]xay,,2 + [0103]y~3 

328 
23. RELATION BETWEEN ABERRATION AND SYSTEM SYMMETRY 
3[0301]y~ 
211210]~oyo~. 
+ y.([2101]~o + 
) + 
+ 2[0220]yo~ ~. + 2[0202]yoy. ~ + [1111]~o~.y. } 
- 9,° {(2101)~.yo + (0301)~. ~ + ~(00~)~.~ + 4(0004)y.~+ 
+ ~.(2(~00~)~ ~. + 2(0~0~)~. ~ ) + (11~1)~oyo~. 
+ (0121)yo~ ~. + 3(0103)yoy. ~ + ~(1012)~o~.y. } 
(23.27) 
In a stigmatic system, there exists an image plane in which h~(zi) = 
hu(zi ) = 0; as we have remarked earlier, the aperture aberrations are then 
described by only three coefficients: 
Ah~,xi, I = -4(0040)x~ - 2(O022)x..y~ 
Ah',,y I = -2(O022)x2y. 
- 
4(0004)y] 
p~ovidCd the ~lope~ of h~(z) and h,(z) ~ 
equal ~t the im,~g¢ pl~e. S(~) 
is given by 
_. 
3 
3 
3 
3 
2 
2 
2 
2 
2 x 
YoXo 
Yo a 
Y2,,Ya X2Xo 
2 
2 
2 
XaYo XaYa YaXo 
y,, a 
XoYoX. 
XoYoYa 
XoXaya 
yox.y. 
(23.28) 
V I  T = 
and 
¢6000 
0 
0 
0 
0 
0 
0 
0 
0 
0600 
0 
0 
0 
0 
0 
0 
3030 
0 
0060 
0 
0 
0 
0 
0 
0 
0303 
0 
0006 
0 
0 
0 
0 
0 
2400 
0 
2103 
0 
0 
0 
0 
5010 
0 
2040 
0 
0 
0 
0 
0 
0 
2301 
0 
2004 
0 
0 
0 
0 
4200 
0 
1230 
0 
0 
0 
0 
0 
3210 
0 
0240 
0 
0 
0 
0 
0 
0 
0501 
0 
0204 
0 
0 
0 
0 
4020 
0 
1050 
0 
0 
0 
0 
0 
0 
0420 
0 
0123 
0 
0 
0 
0 
0 
0321 
0 
0024 
0 
0 
0 
0 
4002 
0 
1032 
0 
0 
0 
0 
0 
0 
0402 
0 
0105 
0 
0 
0 
0 
3012 
0 
0042 
0 
0 
0 
0 
0 
0 
1410 
0 
1113 2220 
0 
0 
0 
4101 
0 
1131 
0 
0 
2202 
0 
0 
, 
0 
1311 
0 
1014 2121 
0 
2022 
0 j 
\3111 
0 
0141 
0 
0 
1212 
0 
0222 / 
(23.29) 

23.4 N---- 3 
329 
23.4 N- 
3 
Systems for which N = 3 may contain any number of round lenses, together 
with elements of a new kind; these latter may consist of a diaphragm with a 
triangular opening, for example, or of a symmetric sextupole. Such a device 
has been employed by Amboss (1959) in an attempt to combat 'anticoma'. 
If the system does contain round lenses, then the first-order properties will 
be those of an ordinary rotationally symmetric system and the primary 
aberrations will be due to the three-fold symmetric element alone. If the 
system consists only of sextupolar elements, the primordial properties will 
be due to S (3) and the primary aberrations to S (4). 
When both sextupole elements and round lenses are present, the image- 
forming properties of the system are described by 
= ( 000) o + (00 0) a 
(23.30) 
in which (1000) is real, and equal to g(z), and (0010), also real, is equal to 
h(z). 
The component S (3) of S is of the form 
2 
T 
/ o// 000 0 
0lifo/ 
=2 
0 
3000 
0 
2010 
~o 
S(3) 
Wo 
= 
2 
1020 
0 
0030 
0 
wa 
W a 
_-=.2Wa 
0 
1020 
0 
0030 
~a 
so that 
os(2) 
os(2) 
Dw~ - h 
0-~ o 
g 0-~ ,, 
= h{313-b--~]@2o + 212010]@o@. + [10201@2.} 
- g{(2-O-~)W2o -4- 2(1020)@o@a 4-(0030)@ 2 } 
(23.31) 
(23.32) 
In the Gaussian image plane, h(z) vanishes. In any plane, however, there 
are three primary aberrations: a distortion, (0200)~2o, where 
Dh___ 
(2010) 
(23.33a) 
g 
(0200) = 
3[3000]- 
an aperture aberration, (0002)~2a, 
(0002) = D[1020I- D3(0030) 
(23.33b) 

330 
23. RELATION BETWEEN ABERRATION AND SYSTEM SYMMETRY 
and an astigmatism, (0101)Wo w., 
h [20101 D2(1020) 
(1010) = 52 
- 
(23.33c) 
We have so far made no assumptions about the alignment of the trian- 
gular elements, and the aberration coefficients can therefore all be complex. 
If there is only one such element, however, or if corresponding points of dif- 
ferent elements all lie in the same meridian plane, then all the coefficients 
will be imaginary, provided the y-axes (say) lie in this plane. 
The secondary aberrations will be the same as the primary aberra- 
tions of the round lenses, in nature at least; their values will be modified, 
however, by the presence of the second-order (primary) aberrations. This 
property has been exploited to correct the spherical aberration of round 
lenses (see Chapter 41). 
If no round lenses are present, we obtain a system from which all the 
familiar characteristics of a lens system have vanished. The primordial 
effect is no longer a combination of anisotropic magnification, defocusing 
and astigmatism, as in the most general cases of N = 1 and N = 2 systems. 
Instead we find 
= (0200)   + (0002)   + 
(23.34) 
so that even if (0002) and (0101) can be reduced simultaneously to zero, 
the magnification is not linear. 
The primary aberrations will be third order and the secondary aber- 
rations fourth. 
23.5 N = 
4 
Apart from rotationally symmetric lenses, the system may contain any 
number of electrostatic or magnetic octopoles, in any orientation. 
The 
Gaussian imagery is identical with that of ordinary round systems, and the 
primary aberrations are now third order. The corresponding component of 
S, namely S (a), is most compactly written as the Hermitian form 
S (4) = 
Wo2 
T 
2200 
4000 
2002 
2020 
2101 
--2Wo 
--2Wo 
4000 
0 
0 
0 
3010 
Wo2 
w.2 
2002 
0 
0022 
0040 
1012 
--2w. 
--2w, 
2020 
0 
0040 
0 
1030 
w,2 
WoW. 
2101 
3010 
1012 
1030 
1111 
~o~. 
(23.35) 

23.5 N= 
4 
331 
The aberrations in a general plane are therefore given by 
os(2 
os(J) 
DwI=hc ~---~-gc 0-~,, 
2 
' 
2[2200] 
[2101] 
W o 
=2 
4[4000] 
3 [3--0~] 
,,,o 
2 
2[20021 
[1--~-2] 
~. 
--- h 
w a 
_--..2 
w, 
2[2020] 
[ 1--0-~] 
2[21011 
[1 111 
' 
(2101) 
2(2002) 
--2 
(3010) 
2 (2-0--~) 
-g 
w~ 
(1012) 
2(0022) 
N° 
--2Wa 
3(1030) 
4(0040) 
w" 
WoWa 
(1111) 
2(1012) 
(23.36) 
There are therefore two aperture aberrations: (0003)@a~ and the ordi- 
nary spherical aberration of round lenses, (0021)W2@a; two distortions" 
(0300)@ao and the round lens distortion, (2100)W2@o; two astigmatisms: 
(0201)@2@a and the round lens astigmatism, (2001)w2@a; the round lens 
coma terms (1011)WoWa@a and (0120)@2ow~ together with an 'anticoma' 
term (0102)@o@2; and finally, the round lens field curvature, (lllO)Wo@oWa. 
If all the elements are aligned in such a way that the system possesses 
a plane of symmetry--this implies that one electrode of each electrostatic 
element lies in a single azimuthal plane, and a polepiece of each magnetic 
1 °al 1 the 
element in a plane which is inclined to the electrode plane at 22~ 
elements of the coefficient matrix will be real. 
The secondary aberrations are fifth order. S (6) can be written as a 
Hermitian form: 
S(6) = 
3 
I 
Wo 
3 
W a 
Wo~ 
Wo~ 
~wa 
w~ 
WoWoWa 
T 
A 
_--=.3 
W o 
~3 
W a 
W2~o 
~ 
2 
WoW a 
2~ 
WoWa 
2~ 
WaWa 
WoWoWa 
WoWaWa 
(23.37) 

332 
23. RELATION 
BETWEEN 
ABERRATION 
AND SYSTEM SYMMETRY 
where 
A 
__. 
f3300(r) 
3003 
5100 
3120 
5001 
3021 4110 4001~ 
3003 
0033(r) 
2130 
1005 
2031 
0051 1140 1041 
5100 
2130 
0 
3102 
3201 
2112 
0 
0 
3120 
1005 
3102 
1122(r) 
0 
1023 
0 
2013 
5001 
2031 
3201 
0 
2211(r) 
0 
0 
0 
3021 
0051 
2112 
1023 
0 
0 
0 
0 
4110 
1140 
0 
0 
0 
0 
0 
0 
\ 4011 
1041 
0 
2013 
0 
0 
0 
0 
The derivatives of S (6) with respect to wo and ~. can each be written in 
the form 
3 
I 
w o 
3 
w a 
_-=...2 
WoW o 
_--=..2 
WoW a 
_-=..2 
WaWa 
WoWoWa 
WoWaWa 
j 
2 
W o 
~2 
W o 
2 
T 
w a 
~2 
W a 
WoWa 
(23.38) 
For OS(~/~o, 
r 
__ 
,[51001 
3[33001 [31201 [3102] 
[2130] 
3 [3--0--~] [1005] [~] 
0 
515100] 313102] 313-i-~] 
0 
0 
[1122] 
[1140] 
0 
515001] 
0 
313021] 
0 
0 
0 
[1041] 
213201] 414110] 2[~] 
212130] 
0 
414--0-H] 2[~] 212031] 
[4110] ~ 
[1140] 
3132oq 
[21121 
0 
0 
212211] 
0 
J 
r 
_._ 
~ (5001) 
(2031) 
0 
0 
0 
0 
2(3102) 
~, 
o 
(3201) 
(3021) 
3(3003) 
(2--0-~) 
(0051) 
3(0033) 
(4-~) 
(2--~) 
3(2130) 
0 
3(1023) 
5(1005) 
(4--~) 
0 
3(2031) 
0 
0 
5(005~) 
2(3120) 2(1122) 4(1140) 
2(302 ~) 2(1023) 4(1041) 
(lo41) 
3(2o13) 
0 
0 
2(2112) 
0 
(23.39) 

23.6 N= 5 AND 6 
333 
These aberrations are all members of the class N = 2, and we shall therefore 
discuss them no further. 
23.6 N= 
5 and 6 
(a) N = 5. A system possessing this symmetry would consist of 'decapole' 
elements: these could be produced in the form of ordinary lenses with pen- 
tagonal openings instead of round ones, or as elements with ten poles (or 
electrodes) symmetrically disposed about the axis. Round lenses could of 
course be present also, and since the function of the decapole element would 
probably be to correct or diminish aberrations, the primordial properties 
and primary aberrations of any practical N = 5 system would be most 
likely to be those of a round lens system. The secondary aberrations would 
then be fourth order, due to the decapole unit, and just as the (primordial) 
astigmatism of a stigmator is used to annul the third-order astigmatism of 
round lens systems, it might be possible to use these fourth-order aberra- 
tions to combat either the fifth-order aberrations of an axially symmetric 
system, or the appropriate mechanical aberrations due to constructional 
shortcomings of the system. 
We shall not discuss this case in any detail; we simply state that the 
component S (5) which leads to these fourth-order aberrations is of the form 
4 
T 
w o 
5000 
4010 
0 
0 
2=2 
3020 
2030 
0 
0 
/ wo \ 
WoW a 
4 
1040 
0050 
0 
O 
/ w, / 
S( 5) 
w. 
(23.40) 
@40 
0 
0 
5000 
4ulb 
To 
@o~ 
0 
0 
3020 
2-0-30 
~. 
0 
0 
1040 
so that 
_-=._2 ~2 
c3S(~5~ 
)/0~o = 5150001w-4o + 414--0-~1w--3o@,, + 3130201WoW a 
+ 212030]~o~3~ + [1--6~]w--4~ 
and 
_-:=_2 _-=..2 
OS(S,)/O~. = (4010)w-'4o + 2(3020)w-'3o~. + 3(2030)wow. 
+ 4(T ) o 
+ 5(00501  
(23.41) 
(b) N = 6. The same general remarks also apply to these systems; the 
aberrations are the same as certain of those which afflict systems for which 
N=3. 

334 
23. RELATION BETWEEN ABERRATION AND SYSTEM SYMMETRY 
23.7 Systems with an axis of rotational symmetry 
The primordial properties and primary aberrations of these systems have 
been very thoroughly studied. The primary aberrations, which are third 
order, are most simply derived from the Hermitian form 
( --2 )T (2200(r) 
w o 
2101 
S (4) = 
~o~. 
2101 
1111(r) 
--2 
2002 
1012 
W a 
)(2) 
2002 
w o 
1012 
WOW,, 
2 
0022(r) 
w`, 
(23.42) 
The secondary aberrations are fifth order; the function S (6) can be written 
/ 3/T/3300 r wo 3201 3102 3003// wo3 / 
_--..2-- 
3201 
2211(r) 
2112 
2013 
2 
S(6) 
WoWa 
WOW`, 
= 
-- --2 
3102 
2112 
1122(r) 
1023 
WoW 2 
WoW 
a 
--3w`, 
3003 
2013 
1023 
0033(r) 
w`,a 
(23.43) 
so that 
c9S("~) 
0-~o 
\ ~  
f--w~ ) T ( 313300] 313201] 3131--~ 
= I WoW. 
213201] 212211] 2[~] 
[3102] 
[2112] [1122] 
3 / / 
212013] 
WoW~ 
[1023] 
3 
W a 
(23.44a) 
and 
~q¢(6) 
w o 
v,~oc _ 
~o~. 
2(3102) 
2(2112)2(1122) 
0-~. 
--2 
3(3003) 
3(2013) 
3(1023) 
W a 
3 / / 
2(1023) 
2 
3(0033) 
w°wa3 
W a 
(23.44b) 
In the stigmatic image plane, the contribution to the secondary aberrations 
that arises from S (6) contains the following terms: 
(32o~) 
distortion: (3200)- 
Ah~ 
(o033) 
aperture aberration: (0032) = -3 
Ah~ ' real 

23.7 SYSTEMS WITH AN AXIS OF ROTATIONAL SYMMETRY 
335 
(2211) 
astigmatism and field curvature: (2210) = 
Ah~ ' real 
(3101) = -2 (3102) 
Ah~ 
comas: (1220)= 
(2112) 
Ah~ 
(2111) = -2 (2112) 
Ah~ 
(3002) = -3 (3003) 
Ah} 
3. (0230)= 
(2013) 
terms in r a. 
Ah~ 
(1121) = -2 (1122) 
Ah~ ' real 
(2012) = -3 (2013) 
Ah~ 
4 (0131) = -2 (1023) 
terms in r a" 
Ah~ 
(1022) = -3 (1023) 
Ah} 
(23.45) 
In an electrostatic system, all the coefficients are real, and the aber- 
rations resemble those of glass lenses. If, however, the system is magnetic, 
'anisotropic aberrations' also appear as we should expect, by which we 
mean that certain of the aberration coefficients are complex numbers. 
Consider, for example, the terms in the first power of the aperture 
coordinates, (2210) and (3101), the astigmatisms: 
or 
II 
(221 
2--2 
w c = 
O)woWoW~ + (3101)W3oWoW. 
II i~b 
ro4ra {(2210)eie. + ]31011e-i(~. } 
w c e 
-- 
in which 
1 
1 
which represents a tilted ellipse, with semi-axes 4 
%r.{(2210)± I 3101 I}. 
Likewise, the comas produce an overall effect 
1I 
Awo~2 2 
2-~W2~oW.~. 
B 
3--2 
W c 
= 
W a + 
+ 
W owa 

336 
23. RELATION BETWEEN ABERRATION AND SYSTEM SYMMETRY 
or 
II iff 
3 S 
+4) 
IAle2iO. + IBle-iO. 
w e e 
/rot . = 2Ae i(0° 
4" 
with 
1(.4 4-/~) and O. : 8. - 8o 4- ~ 
¢= -Oo- 
which represents a family of ellipses for different values of r., centred on 
the line 
II 
,- 3 2-7 i0o 
w e = Zrora~e 
srl(lAI + IBI). 
with semi-axes ro 
4 give 
The terms in r. 
-- 
2 _-z._2 
H 
2A@ow~@. + 3Awow.W. 
W 
e 
----- 
or 
II 
4 
[e2iO 
w c /rora = 21A 
" + 3Ae i°° 
1 
N 
in which 0. = 8. + ~(A- 
80), which represents a family of circles, centred 
on the line w II = 3ror4-Ae i°°, radii 2rot 4 [ A [. 
3 lead to 
Finally, the terms in r. 
II 
3Aw2o 
--2 
--z--2 
3 
Bwo~oW~. 
w e : 
WaW. + Awow . 4" 
or 
s 
3[Alei(A+2eo-2e.) 
+ [Alei(-),-20o+Se.) + Be ie. 
"11.1 C 
~ 
The terms in ] A [ can be written as 
e-i#131A]e-i°" +lA]e 3iO" ) 
in which 
N 
¢ = -~A- 
~o and O. =6.-8o--~A 
II i4~ 
2 3 
X t 
and if we writev=w e e /ror .IAI= 
+iy',wehave 
x' = 4 cos3 8, 
y' = -4 sin3 
which represents an astroid. 
23.8 Note on the classification of aberrations 
We see from the earlier parts of this chapter that although the number 

23.8 NOTE ON THE CLASSIFICATION OF ABERRATIONS 
337 
of aberration coefficients needed to characterize complex systems may be 
large, the aberrations form families, the importance of which is often very 
different in different components. In electron microscopes, for example, 
the objective lens suffers from the same aberrations as the final projector 
but for the former only the aperture aberrations are important, whereas 
for the latter all but the distortions axe negligible. We therefore introduce 
a convenient nomenclature, which brings together members of the same 
family of aberrations for any optical element. Each aberration is associated 
with a term of the form p q r 
XoYoXay ~ and in the case of stigmatic imagery and 
primary aberrations, these can be related back to particular terms of S I. 
(i) Terms independent of Xo, Yo(P = q = 0): aperture aberrations 
For these aberrations, the aberration figure is independent of the choice 
of object point and, in particular, their effects do not vanish or become 
small if the latter lies on the optic axis. They are known generically as 
aperture defects or aperture aberrations and include as important special 
cases the spherical aberration of round lenses and the aperture aberrations 
of quadrupoles. The defocus also belongs to this group, since an image 
formed on a plane that is not conjugate to the object plane is blurred in an 
aperture-dependent way. The axial astigmatism associated, for example, 
with imperfect roundness of a lens intended to be rotationally symmetric 
and the primary (axial) chromatic aberration are also aperture defects. 
(ii) Terms independent of x~, ya(r = s = 0): distortions 
These are at the other extreme from aperture aberrations, for they 
depend only on the position of the object point. Hence all rays from a 
given object point will be displaced by the same amount from their paraxial 
points of arrival and, if the latter lie in a stigmatic image plane, such terms 
will shift the paraxial image point but not blur it. These aberrations are 
known as distortions and include the isotropic and anisotropic distortions 
of round lenses and the chromatic aberrations other than the axial term. 
(iii) Intermediate terms 
The intermediate terms may be classified into those linear in X o or yo; 
those linear in x a and ya; and any others. The former may be regarded as 
comas, by analogy with the primary coma of round lenses. Terms linear in 
xa and ya form the group of field curvatures and astigmatism. The others, 
which occur when we consider fourth and higher order aberrations, have 
no particular name. 

338 
23. RELATION BETWEEN ABERRATION AND SYSTEM SYMMETRY 
(iv) Phase shifts 
If we are considering a pair of conjugate planes in an imaging system, 
any terms in S z that are independent of xa and ya will not contribute to 
the aberrations, which are determined by OSI/Oza and OSI/Oy~. Such 
terms are important when we consider the dependence of the aberration 
coefficients on object and aperture position in Chapter 25 and will reappear 
in Vol. 3 in connection with the wave theory of aberrations. 

24 
The Geometrical Aberrations of Round Lenses 
24.1 Introduction 
We now obtain explicit formulae for the aberration coefficients of systems 
of round magnetic and electrostatic lenses in which the fields may overlap. 
In order to avoid repetition, we deal with the real aberrations expressed in 
terms of object and aperture coordinates in detail, then describe briefly the 
changes necessary to convert these coefficients when position and gradient 
in the object plane are used. We then show (in Chapter 25) how a similar 
calculation yields the asymptotic aberrations. These calculations will be 
based on the eikonal method but the main stages in the reasoning when 
the trajectory method is employed are also given. 
Within this overall plan , certain decisions remain to be taken: the most 
important concerns the use of reduced coordinates (15.40). If these are 
employed, as they are by Sturrock (1955), the expressions for the various 
coefficients are very different in form from those obtained in conventional 
coordinates, so different indeed that Glaser (1952) believed them to be 
wrong. (In fact, they can be shown to be equivalent but the demonstration 
is undeniably laborious.) We have chosen to use conventional coordinates 
but we list one form of the coefficients in reduced coordinates for reference 
purposes (Section 24.8). 
The other decision concerns the use of complex coordinates. There 
is no doubt that these give the analysis a more compact appearance, but 
expressions involving the third and fourth powers of complex coordinates 
are much less easy to picture than those involving first and second powers, 
which we have met in the paraxial domain. We therefore retain a certain 
flexibility, giving some important formulae in both forms; we avoid repeat- 
ing very similar equations for x and y by the use of suffix notation, as in 
Chapter 22. 
24.2 Derivation of the real aberration coefficients 
The paraxial ray equations for round lenses were obtained in Section 15.2 by 
writing down the Euler equations corresponding to the variational relation 

340 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
5 f M (2) dz = 0. If we retain the next higher order terms, M (4), in the 
series expansion for M and again write down the Euler equations, we obtain 
the inhomogeneous second-order equations from which the aberrations are 
obtained in the trajectory method; alternatively, we may set M (p) = M (4) 
and use the perturbation theory of Chapter 22. In both cases, we need 
M(O. Substituting terms of higher order for (I) and A~, Ay into (15.23), 
we find 
M(4) - 
1 
( 
¢-2) 
y2)2 
-12s$½ 
"Y¢(')- ^¢ (x2+ 
' 
3'¢" 
1~ 21 (X 2 + y2)(X,2 + y,2) 
(24.1) 
¢½ (X,2 + y,2) 
8 
r/B" 
+ --~-- (X 2 + Y2)(XY'- X'Y) 
and introducing the rotating coordinate system (x, y,z) with the aid of 
(15.26) 
M(4) _- _~Ll(X 
21 
+ y2)2 - 1L2(x22 + Y2)(x'2 + y,2) 
- ~Lal (x,2 + y,2)2 - R(xy' - x'Y) 2 
(24.2) 
_ p$~. (.2 + y~)(.y, _ ~,y) 
_ Q~½(~,2 + y,2)(~y, _ ~.y) 
in which 
1 
(¢,2 
7¢ (4) 
27¢,,r12B2 
L, = 32~ ~-~- 
+ 
r]4B 4 
~ 
4r/2BB") 
1 
. 
. 
7/2 B2 
L~ = s-~(~¢ + 
) 
v
y
 
1^½ 
L~ = ~¢ 
( 
~2B~) 
~ 
-#_'B 
B"+ 
P= 16¢½ 
¢ 
¢ 
qB 
Q= 4¢½ 
R- 
rI2B2 
(24.3) 

24.2 DERIVATION OF THE REAL ABERRATION COEFFICIENTS 
341 
Note that in purely electrostatic lenses, P, Q and R vanish, and that in 
purely magnetic lenses, L2 = R; Q is half the rate of rotation (15.9) of the 
rotating frame (x, y, z). 
The trajectory method 
We now write 
f 
+ M (4)) dz = 0 
(24.4) 
or 
-- 
= --- 
, 
+ 
(24.5) 
dz 
Ox~ 
Ozj 
dz 
xj 
Ozj 
Here and elsewhere, j = 1,2; Xl = x and x2 = y. Substituting for M (2) 
and M (4), we find 
d 
^ 
, 
7¢"+7/2B2 
d--~(¢½ xj) 4- 
4¢½ 
xj = Aj 
(24.6) 
where 
AI'= (x 2 4- y2){-LlX 4- L'2x' 4- L2x" - (P¢½)'y - 2P¢½y'} 
+ (x '2 + y'2){-L2x + L'ax' 4- Lax" - (Q¢½)'y - 2Q¢½y'} 
+ 2(xy'- x'y){-P¢½x + (Q¢½)'x' + Q¢½x" - R'y - 2Ry'} 
+ 2(xx' + yy')(L2x'- p¢½y) 
4- 2(x'x" 4- y'y")(L3x' - Q¢½y) 
4- 2(xy" - x"y)(Q¢½ x'- 2Ry) 
(24.7) 
and A2 is obtained by writing x ~ y, y -~ -x. Equation (24.6) is solved 
by replacing x and y by their paraxial expressions on the right-hand side, 
which thereby becomes a known function of z, and employing the method of 
variation of parameters. Suppose that a(z) and b(z) are two linearly inde- 
pendent solutions of the homogeneous equation, which is also the paraxial 
equation. We seek a solution of the inhomogeneous equation (24.6) of the 
form 
xj(z)- Aj(z)a(z) 4- Bj(z)b(z) 
(24.8) 
Selecting Aj(z) and Bj(z ) in such a way that 
Aia + Bib = 0 
(24.9) 

342 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
and substituting (24.8) into (24.6), we obtain 
(24.1o) 
Solving (24.9, 24.10) for A~ and B~ yields 
, 
Ajb 
_ 
Ajb 
A~ = 
¢½(ab' - a'b) - 
W 
Aja 
_ Aja 
B~ = $~,(~b, - ~,b) - 
w 
(24.11) 
where W denotes the constant Wronskian (15.51) 
W -- ¢½(ab' - a'b) 
(24.12) 
Hence 
1] 
Aj(z) = Aj(zl)- 
~ 
Ajbd¢ 
Zl 
z 1/ 
B~(z) = B~(~2)+ ~ 
h~ae¢ 
Z2 
(24.13) 
We have retained the possibility of using different lower limits in the inte- 
grals appearing in (24.13) because we need to study two sets of boundary 
conditions; when these govern ray position in two different planes, this 
extra flexibility is indispensable. 
If the aberrations are expressed in terms of position coordinates in two 
planes, the object and image planes z = Zo and z = za, then the aberration 
terms vanish there. Introducing the paraxial solutions s(z), t(z), 
a(z) =~ s(z), 
S(Zo) = t(za) = 1 
(24.14) 
b(z) ~ t(z), 
~(z.) = t(Zo) = 0 
we find 
xj(z) = Aj(zl)s(z) + Bj(z2)t(z) 
s(z) ] 
t(z) 
*f 
(24.15) 
Zl 
•2 
^½ ' is the Wronski~ for the choice 
(24.14). Inz = zo, xj = xjo so that Aj(zi) = Xjo, zl = Zo. Inz =z,, 

24.2 DERIVATION OF THE REAL ABERRATION COEFFICIENTS 
343 
xj = xj~ and hence Bj(z2) = xj~, z2 = z~. Finally, 
• i(z) = ~o~(Z)+ ~,.t(z) 
+ ~{t(z) f hjsd¢-,(z) f A, td¢} 
Za 
Zo 
(24.16) 
In the image plane, z = zi, t(z) is again zero and s(zi) = M. It is usual to 
refer the aberrations back to the object plane by considering the quantity 
{ xj(zi) - Mxjo } / M" 
zi 
xj(zi)M- Mxjo =: Axji = 
Ws1 f Ajt dz 
(24.17) 
2;0 
The individual aberration coefficients are then extracted by substituting 
xj(z) 
= XjoS(Z) + xja t(z) in the Aj and collecting terms of various 
degree in Xo, yo, xa and y~. We shall perform this step in detail below 
when using the eikonal method. 
If the aberrations are expressed in terms of position and gradient in 
the object plane, we use the pair of paraxial solutions denoted by g(z) and 
h(z) (15.56): 
a(z) =~ g(z), 
g(zo) = h'(zo)= 1 
(24.18) 
b(z) ~ h(z), 
9'(2o) = h(Zo)= 0 
and 
nOW 
xj(z)- Aj(zl)g(z)+ Bj(z2)h(z) 
1{ 
f 
f 
} 
+ ~ 
-g(z) 
Ajh d¢ + h(z) 
Ajg d~ 
Zl 
Z2 
(24.19) 
^ 
^½ 
where Wg "= ¢½ (gh'- g'h) = ¢o is the Wronskian for (24.18). In z = Zo, 
I 
xj(zo) = Xjo and xj(Zo) - X~o so that as before Aj(zl) - Xjo, zl = Zo; 
now, however, z2 is also equal to Zo and Bj(z2) = Xjo.~ • 
• ,(z) = ~og(Z)+ ~oh(Z) 
Zo 
Zo 
(24.20) 

344 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
or in the image plane, h(zi) = O, 
xji - Mxjo 
M 
zi 
1 fAjhdz 
(24.21) 
= Azji 
= 
- Wg 
Zo 
Despite their formal resemblance, there is an important difference be- 
tween (24.17) and (24.21) or (24.16) and (24.19). Since both t(z) and h(z) 
vanish in the object and image planes, these paraxial solutions axe pro- 
portional, t(z) oc h(z). The rays s(z) and g(z), though of course linearly 
related, axe not proportional: 
~'(Zo)t(z) 
g(z) -- 8(z) + g(Za)t(z) -- 8(z) -- t'(Zo) 
9(z.) h(z) 
~(z) = 9(z) + ~'(zo)h(z) = 9(z) - h(~) 
(24.22) 
With the aid of (24.17), therefore, the effect of aperture position on the 
aberration coefficients can be explored. 
The eikonal method 
Instead of using M (4) to derive (24.6), we can equally well use per- 
turbation theory, regarding M (2) as the unperturbed refractive index and 
setting M (a) = M (p). For round lenses, the formulae of Chapter 22 reduce 
to a much simpler form since M (2) contains terms in (x 2 +y2) and (x '2 +ya) 
only (15.29) so that paraxially, 
pj = ~½ ~ 
(24.23) 
For the boundary conditions (22.24), we have xj = xjog + x~oh and hence 
o~j(z) 
h(z)~ 
o~j(~) = 9(z)~j~ 
Opko 
= 
^ 
OX ko 
¢20 
opt(z) _ h'(z)~k 
Op~(~) = ~ (z)9'(z)~j~ 
OZko 
Opko 
(24.24) 
and (22.28) become 
OXjo 
osl 
 
= 
) _ 
Opio 
(24.25) 

24.2 DERIVATION OF THE REAL ABERRATION COEFFICIENTS 
345 
(I) 
_(1) 
Solving for xj (z2) and pj (z2), we find 
os[~ 
^½ 
OS~l~ 
Wgx~l)(z2) ---- h(z2)c~xj ° 
-- ¢o g(z2) 0---~j ° 
{ 
osl~ 
~, 
os~} 
Wgp~l)(z2) 
-- ~ (z2) hi(z2) (~xj ° - 90 g (z2) Opjo 
(24.26) 
or using (24.23), 
OS~l~ 
osfi 
w,=~l)(z~) = h(z~)o=~o - 9(z~) o='jo 
Wgp~I)(z2) 
__ hi(z2)°qS/2 
oqSi2 
(24.27a) 
(24.27b) 
We have already mentioned that, provided that the plane z - zo lies in 
field-free space, the boundary condition p~l o) - 0 is equivalent to X~o 1) - 0; 
if z = z2 likewise lies in field-free space, so that p(1)(z2)/¢½(z2) = x'(1)(z2), 
then (24.27) give the aberrations of position and gradient in z = z2 by 
writing the left-hand side of (24.27b) as Wgx~l)(z2). 
If the aberrations are to be expressed in terms of position in the object 
and aperture planes, we use (22.30) with xj(z)= xjos(z)+ xjat(z) so that 
- p~)t(z~)- ~ +~ t'(z~) 
Ozj, 
0S/2 
(1) 
_(1) ^½ 
x j2 
O~o = pj~ ~(~ ) - 
¢~ ~'(~) 
(24.28) 
with solution 
os'~ 
OS'o: 
Wsxj(1)(z2 ) = t(z2 ) (~zj ° - 8(z2 ) OXja 
Wsp~I)(z2) = ¢2 t'(z2)OXjo - 
(~xj a 
(24.29) 
The final stage of the calculation involves substituting the paraxial solutions 
for xj(z) into M (4) and reorganizing the result into convenient groups of 
terms. We reintroduce x and y, setting 
Xl (Z) --- XoS(Z) -~- Xa(Z) 
• ~(Z) = yo~(Z) + ~o(Z) 
(24.30) 

346 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
whereupon M (4) (24.2) takes the form 
M (4) - -I(Lls4 
4- 2L2s2s '2 + Las'4)(X2o if" y2o)2 
4 
1 
-~(L~t" + 2L~t~t '~ + Z~t")(~ + y2)2 
-{Lls2t 2 + 2L2ss'tt' + L3s'2t '2 - n(st' - s't)2}(ZoZ~ + yoU~) 2 
-1-{L~,~t~ + L~(,~t '~ + ,'~t ~) + L~'~t '~ 
2 
+ 2n(st'- s't)2}(x~ + y~)(x~ + y~) 
--{LlSZt+ L2ss'(st)' + Las'at'}(x 2 -F y2o)(XoXa h" YoYa) 
-{Last ~ + L~(~t)'tt' + L~,'t'~}(~] + u])(~o~o + UoUo) 
-W,(P~ ~ + O~'~)(~o + U~o)(~oy~ - ~yo) 
-2W,(Pst + Qs't')(xox~ + yoy~)(xoy~ - x~yo) 
-W,(Pt 2 + Ot'2)(x~ + y~)(xoy~ - x~yo) 
(24.31) 
* The notation adopted here is not that widely encountered in the literature, notably 
in Glaser (GdE, HdP), but is mnemonically superior: we shall see that A and a are 
associated with astigmatism, C with spherical aberration, D and d with distortion, F 
with field curvature and K and k with coma. 
We write 
I /( 
s2t2 
s,2t, 
2 
} 
A = ~ 
LI 
+ 2L2ss'tt' + L3 
- R(st' - s't) 2 
dz 
1/( 
) 
C - ~ 
Lit 4 + 2L2t~t '2 + L3t '4 dz 
1/( 
) 
D = W 
La~3t + L~J(~t)' + L~'3t ' dz 
1/{ s2t2 
s't)2 + 2L3s'2t '2 
R(st' 
s't)2} dz 
F = ~ 
2L1 
+ L2(st' + 
+ 
- 
1/( 
s2s, 2 
) 
E = ~ 
L1 s4 + 2L2 
+ L3 st4 dz 
1/{ 
} 
K = ~ 
List 3 + L2(st)'tt' + Las't '3 dz 
a= 2/(Pst+Qs't')dz 
(24.32) 

24.2 DERIVATION OF THE REAL ABERRATION 
COEFFICIENTS 
347 
It is clear both on general symmetry grounds and from (24.31) that the 
quantities Xo, Yo, x, and y, can only occur in S I as the rotationally invari- 
ant groups to, ra, V and v, where 
2 
2 
2 
• 
ro "= Xo + Yo = UOUo 
2 
2 
2 
• 
ra "= Xa + Ya = UaUa 
1 
. 
. 
-- 
UoU ) 
y-= 
~o~. + uouo = ~o~ ¢os(~. 
~o) = ~(.oU. + 
i 
v "= xoy, - xayo = ror~ sin(~o, - ~0o) = ~(UoU* - u*u~) 
(24.33a) 
with Xo =: ro cos~oo, yo =: ro sin ~Oo and similarly for x~, Ya; the complex 
numbers Uo = Xo + iyo and u~ = x~ + iya are those defined in (15.11). It 
will also be convenient to write 
~o := ~o, - ~o 
(24.33b) 
The quantities S/2 and So I have the following generic form, only the lower 
limit of integration changing: 
S I 
Er4 
C 4 
2 
- v2) 
w =¥ 
o+-£~o+ 
(v ~ 
F 2 2 
Dr2o V 
Kr~V 
+ -~rora + 
+ 
+ v(dr 2 + kr 2 + aV) 
- 4Cr~ + ra~ro(g cos T + k sin~o) 
l_r2r 
+2 
" o(Ac°s2~°+asin2~°)+ 1~, 2 2 
2 ~rar° 
1 Er2o 
+ r, r o 3 (D cos ~o + d sin ~o) + 
= ~ 
) 
(D +id)/2 
r/2 
u: 2 
(A + ia)/4 
(K + ik)/2 
(24.34) 
(A- ia)/4 
u o 
(K-ik)/2 
UoU, 
2 
C/4 
u, 
We add the suffix o to the coefficients A, C,..., d, k when the integration 
runs from Zo to an arbitrary plane z2; we add a when the lower limit is za; 
when no suffix is added, the integrals run from the object plane Zo to the 
image plane z = zi. 

348 
24. THE GEOMETRICAL 
ABERRATIONS OF ROUND LENSES 
In a general plane 
2 
x(')(z) = r o {xo(Dos - E.t) + x.(Fos - Aos - D.t) - yodos} 
2 
F.t + A.t) + x.(Cos 
K.t) 
+ra{xo(Kos- 
-yo(kos+a.t)-y.k.t} 
+ V{2xo(Aos - O.t) + 2x.(Kos - A.t) 
- 
yo(aos + d.t)} 
+ V{xo(aoS - 3d.t) + 2x.(kos - a.t)} 
(24.35a) 
2 
y.(Fos 
Aos 
D.t)+xodos} 
y(')(z) = ro{Yo(Dos - E.t) + 
- 
- 
+ r.2{yo(gos - F.t + A.t) + y.(Cos - g.t) 
+ xo(kos + aat) + xakat} 
+ V{2yo(Aos - Dat) + 2y.(Kos - A.t) 
+ Xo(aoS + dat)} 
+ v{yo(aos - 3dat) + 2ya(koS - aat)} 
(24.35b) 
or 
u(1)(z) = 
r 2 
(Ko + iko)S - (F. - A. - ia.)t 
Cos - (K. - ik.)t 
uo 
V 
(2Ao + iao)s - (29. -id.)t 
2(gos - A.t) 
U. 
V 
aoS -- 3d.t 
2(kos - a.t) 
(24.35 ) 
In the image plane, where t(z) vanishes and s(zi)= M, 
x l)~zi,( 
r ~ =.Axi=x.(Cr 
2+2KV+2kv+(F-A)r 
2) 
M 
+ 
+ 2AV + 
+ 
-- Yo(kr2 + aV + dr2o) 
Y(1)(Zi) --'" Ay i = ya(Cr 2 + 2KV + 2kv + (F - A)r2o) 
M 
+ yo(gr 2 + 2AV + av + Dr2o) 
+ xo(kr 2 + aV + dr2o) 
(24.36) 
Setting 
Aui := Axi + iAyi 
(24.37) 
the pair of equations (24.36) can be combined into the compact expression 
( 
*)( 
D+id 
F 
K-ik) 
u° 
UoU~ 
(24.38a) 
--" 
1C 
2 
AUi 
2:0~ 
I(A + ia) 
K + ik 
7 
u. 

24.2 DERIVATION OF THE REAL ABERRATION COEFFICIENTS 
349 
which could have been derived directly from (24.34) since O/Ox + iO/Oy = 
20/Ou*. Equation (24.38a) may also be written in the form 
Aui = Cr 2ua 
(spherical aberration) 
+2(K+ik) ]Uo+(K 
i 
* 
- k)uaUo 
(c°ma) 
+ (A + ia)u 2ou,,* 
(astigmatism) 
+ Fr2ua 
(field curvature) 
+ (D +id)r2uo 
(distortion) 
(24.38b) 
= Cr2ua 
+ 2(g + ik)rZaroe i~° + (g -ik)r2roe i(2~'-~°) 
+ (A + ia)r2orae i(2~°-~') + Fr2rae i~" 
+ (D + id)r3o ei~° 
(24.38c) 
The numerous terms of which Axi and Ayi are composed depend in 
different ways on the object and aperture coordinates and are in practice 
of unequal importance. We have indicated in (24.38b) the names by which 
they are commonly known and in Sections 24.3-24.6, we consider each in 
turn, pointing out general properties and other features of interest. For- 
mulae for particular field or potential models and information about the 
dependence of the various coefficients on lens geometry and excitation will 
be found in Part VII. 
The perturbation characteristic function S I has hitherto appeared 
as an accessory that enables us to obtain the aberrations Axi and Ayi 
by differentiation. We saw in Section 5.3, however, that pencils of rays 
propagate in such a way that they are always orthogonal to the surfaces 
S = const, p(r) = grad S(r) (5.12) or in the absence of magnetic field, 
g(r) = grad S(r). This relationship enables us to interpret (24.34) in pays- 
ical terms and sheds additional light on the origin of the various types of 
aberration. 
For simplicity, we assume that object and image are in field-free space 
(or virtual) and we introduce the entrance and exit pupils at z = Z~o and 
z = z~i. These are the images of the true aperture by the parts of the lens 
that precede and follow it, respectively. Figure 24.1 shows the two pairs 
of conjugate planes, object and image and the two pupils; in the paraxial 
approximation, the point Po is conjugate to Pi and the latter is shifted by 
aberrations to P i. Consider now a ray from 1'o that intersects the entrance 
pupil at Po' and the image pupil at P~. In the absence of aberrations, all rays 
from Po are orthogonal to a set of spheres centred on Po; the action of the 
lens converts the incident sphere into a sphere centred on Pi, and the rays 
in image space are all orthogonal to a set of spheres likewise centred on Pi. 
In the presence of aberrations, these spheres in image space are replaced 

350 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
Y 
X 
y 
Object plono 
x 
oxit pupil 
6oussion imoge 
plone 
Fig. 24.1: The object and image planes are conjugate as are the pupil planes. In the 
m 
paraxial approximation, Pi is the image of Po; aberrations shift Pi to Pi. 
by aspheric surfaces, and the distance between the paraxial spheres and 
the aberration surfaces is measured by S I. Figure 24.2 shows the spherical 
surface So centred on Pi that intersects the axis at the exit pupil and the 
aspheric surface S to which the electron trajectories are orthogonal in the 
presence of aberrations; we have again chosen the member of the set of 
such surfaces that intersects the axis at the exit pupil. The ray connecting 
P[ to Pi cuts the reference sphere So at Qo and the aspheric surface S at 
Q. The distance S(-Q, Qo) is given by S I (24.34) and we therefore associate 
each term of the latter with a particular distortion of the surface S. We 
return to this interpretation of S briefly in each of the following sections. 
24.3 Spherical aberration (terms in xa and ya only) 
We first examine the spherical or aperture aberration, of the greatest impor- 
tance in the first (objective) lens of magnifying systems and in the final lens 
of probe-forming systems. From (24.36), we see that a pencil of rays from 
some object point (Xo,yo) intersects the image plane not at the Gaussian 
* Readers familiar with similar treatments of the aberrations in light optics, Sec- 
tions 5.1-5.3 of Born and Wolf (1959) for example, may note that the role of the radius 
of the Gaussian reference sphere ( R in Born and Wolf), which occurs in the aberration 
formulae, is absorbed into the Wronskian in electron optics. Thus (5.1.10) of Born and 
Wolf is exactly equivalent to (24.29a) for t(z2) - O. 

24.3 SPHERICAL ABERRATION 
351 
q 
.................. 
Planeof 
exit pupil 
image 
plane 
Fig. 24.2: The reference sphere So is centred on Pi. Aberrations distort So into the 
aspheric surface S. 
Gaussion 
/ 
I 
I \ 
~.. 
image 
_ 
plane 
~ o 
~a s 
El 
Fig. 24.3: Spherical aberration. In the Gaussian image plane, the image of a point 
object is a circular disc of radius M Cr 3. The outermost ray intersects the axis at a 
distance ~i from the Gaussian image plane. The axial object point of which this point of 
intersection is the Gaussian image is distant (~o from the original object plane. 
image point (Mxo, Myo) but at points (xi, yi) such that 
xi = M{xo + Cxa(x2a + y2a) } 
Yi = M{yo + Cya(x2a + yea) } 
(24.39) 
2 
(j 
1, 2). Each Gaussian image point is replaced 
Hence Axji -- Cxjar a 
= 
by an aberration figure, as explained in Chapter 23. If the beam is confined 
2 
2 
within a circular aperture, radius rA, so that x a + Ya <- r2A, the aberration 
figure is circular 

352 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
+ 
< 
(24.4o) 
Thus all rays from a fixed object point that intersect the aperture around 
a circle of radius ra intersect the image plane around a circle, centred on 
the Gaussian image point, of radius MCra~. These rays intersect in a plane 
distant ~ from the Gaussian image plane. For simplicity, we consider an 
axial object point (Fig. 24.3); a ray in the neighbourhood of the image 
plane may be written 
2 
x(zi + ~) = xat(zi + ~) + MCx,r, 
2 
,,~ x,t'(zi){ + MCx,r, 
(24.41) 
and likewise for y(zi + ~). This ray crosses the axis in the plane for which 
MC 2 
(24.42) 
¢ = ----7-r~ 
ti 
and clearly all rays for which ra is constant intersect the axis at this point. 
The coefficient MC/t~ may be written W8C/¢~ t~2; it therefore has the same 
sign as CWs and hence as the integral in the expression for C (24.32b). We 
shall see that this integral is never negative, and so ~ is always negative 
(24.42). Rays affected by spherical aberration intersect before reaching the 
image plane (Fig. 24.3). The value of ~ corresponding to rA is known as 
the longitudinal spherical aberration: 
1 
M2C 
¢' 
r2A 
(24.43a) 
or referred back to object space, 
¢° := U 2 = -t~ 
r~ 
(24.43b) 
Another way of picturing the fact that ¢i is always negative is to say 
that rays far from the axis are focused more strongly than those closer to 
it. 
It is frequently more convenient to measure the size of the spherical 
aberration disc in terms of the range of ray gradients at the object instead of 
the radius of the aperture. Rather than return to the formula for aberration 
coefficients expressed in terms of position and gradient at the object, we 
can simply transform (24.39) by recalling that the rays of the pencil from 

24.3 SPHERICAL 
ABERRATION 
353 
an object point (Xo, yo) are described by x - XoS + xat, y = yos + yat so 
' = XoS" + xat', y" = yos" + yat'. Thus 
that Xo 
t2 
t2 
Axi = Cx,(x2~ + y2) = 
X'o(Xo + Yo )+ mixed terms 
C 
t- 
t2 
t2 
Ayi - Cya(x 2 + y2) = ~,~ yo(Xo + Yo )+ mixed terms 
rj 
(24.44) 
in which the mixed terms contribute to other aberrations but none of the 
latter contributes to spherical aberration. The coefficient C/t~o 3 is always 
denoted by Cs (the suffix recalling the "spherical" origin of this defect in 
the case of glass lenses): 
Ay i 
~ 
I, 12 
12 
-" ~yo(Xo 
+ Yo ) 
(24.45) 
and from (24.32b), we see that 
zi 
C, = 
1 / 
h4 
h2h, 2 
h, 4 
¢-~ 
(L1 
+ 2L2 
+ L3 
)dz 
Za 
(24.46) 
in which we have used the fact that h(z) = t(z)/t'. 
The radius of the spherical aberration disc in the Gaussian image plane 
is MCr3A . Is it smaller in any neighbouring plane? We return to (24.41), 
which we now write 
t 
2 
x(zi-~)=-xati~A-MCxar 
a 
(24.47) 
The ray that is most distant from the axis in the image plane intersects the 
2 
2 
aperture plane around the circle x a + y, - r~t; for a given magnification, 
this ray and a general ray are equidistant from the axis in some plane 
z = zi- 
~ if x(zi- 
~)= --xAt}~ A- MCxAr2A or 
3 
{t}(xA -- x,) = MC(X3A -- xa) 
or again 
- MC(X2A + XAXa + x a 
(24.48) 
(in which we have set y, = 0 to simplify the calculation--no generality is 
lost). In this plane 
x(zi - ~) = -MC(xa 
+ XA)XaXA 
(24.49) 

354 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
and this is smallest in the plane for which dx(zi- ¢)/dx. = 0, namely, that 
in which z. = --ZA/2. For this value, (24.48) tells us that 
3 
3 MCx2 A = ~1¢/I 
(24.50) 
¢-4 t} 
and the beam radius is 
x(zi - ~) = 4MCxaA 
(24.51) 
Thus the radius of this disc of least confusion is only one quarter of that 
of the spherical aberration disc in the Gaussian image plane; the disc is 
formed in a plane three-quarters of the way from the Gaussian image plane 
to the plane of the marginal focus. 
In practice, the spherical aberration coefficient is tabulated for the case 
of greatest interest, objective lenses, used either as the first lens beyond the 
specimen in a magnifying system or as the final lens just before the target in 
a demagnifying (probe-forming) system. How are these values related? We 
shall discuss such relations in detail in the case of asymptotic aberrations 
in Chapter 25 but a simple argument enables us to relate the values of 
the real spherical aberration coefficient in the two situations. When the 
aberration is expressed in terms of aperture coordinates, the question is 
almost trivial since the only ray occurring in the integral in C is t(z), which 
is unaffected by interchanging zo and zi. The size of the aberration disc, 
referred back to the particular object plane, is governed by W and hence 
,,t 
by t" and Cg only. When the aberration is expressed in terms of gradient 
(z', y'), however, confusion may arise. Consider the situation illustrated 
in Fig. 24.4a, which shows three rays; ray 1 is a paraxial ray connecting 
the axial object and image points Po and Pi. Ray 2 sets out from Po but 
strikes the image plane at Pi(xi,Yi), owing to the spherical aberration; 
ray 3, also affected by spherical aberration, passes through Pi and must 
hence have set out from some point Po off the axis. Rays 1 and 2 have the 
same gradient at Po, and rays 1 and 3 at Pi. We have Pi-Pi = MC~°i)03o 
and Po-Po 
~(io)o~/M, where "(°i) and ~(i°) 
= .~s 
.~s 
.~ 
are the values of C~ for 
the cases in which the electron travel from 1'o towards Pi and the reverse, 
respectively. From (24.39, 24.45), however, we see that 
0 = MPo-Po + MC~°i)Oao 
or 
Po-Po 
C(°i)03 
(24.52) 

24.3 SPHERICAL ABERRATION 
355 
Po 
P, 
a 
object 
field distribution 
image 
M cse 3 
source 
field distribution 
target 
oP 
orobe 
c,,e~ 
Fig. 24.4: Forward and backward aberration coefficients. (a) Calculation of the relation 
between the coefficients. (b) Aberration disc (IMI >> 1). (c) Probe size (IMI << 1), 
Hence 
or 
M 
(7,(°i) 03 
C~ i°)03 -~- --vs 
-o 
0o) 
C~ '°) =-M 
Oi 
C~ 

356 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
or for magnetic lenses 
C ('°) = M4C~ °i) 
(24.54) 
The forward and backward spherical aberration coefficients are thus very 
different. Equation (24.54) is an obvious consequence of the relation be- 
tween Cs and C (24.44). Figures 24.4b and c show a field distribution used 
as a magnifying and demagnifying system. Equation (24.52) shows that if 
the spherical aberration coefficient for the magnifying situation is Cs, the 
radius of the corresponding probe will be given by C~,O~, where 0p denotes 
the angular aperture at the probe. That this is consistent with (24.53) is 
easily seen from the fact that the probe radius rp is given by 
rp -- M(i°)c~i°)03 
(24.55) 
In practice, these relations are almost always required for magnetic lenses 
alone, and the important result is that expressed by (24.54). 
We mentioned at the end of Section 24.2 that each aberration can be 
associated with a characteristic distortion of the surfaces S=const. For 
the spherical aberration we have S z/W = 
1 
4 
, 
-~Cr a and so, as shown in 
Fig. 24.5, the true surface S (including aberrations) is everywhere closer 
to the image plane than the reference sphere So, except at the axis where 
the two touch. Since the curvature of S is greater than that of So, it is 
immediately obvious that outer rays will be more strongly focused than 
those close to the axis and hence the marginal focus retreats towards the 
lens as the aperture is opened more widely. 
We now turn to the coefficient itself, C or Gs. The formulae for these 
can be rewritten in numerous ways, very different in appearance but other- 
wise equivalent. These expressions can be obtained either by partial in- 
tegration using the paraxial equations to replace second derivatives of the 
paraxial rays s and t or g and h whenever they occur, or by an ingenious 
differential technique introduced by Seman (1951, 1954, 1955a,b, 1958b,c) 
and exploited extensively by Hawkes (1966/7b, 1967b). Seman in fact ap- 
plied his method not to individual aberration coefficients but to the char- 
acteristic function S z, as we explain in Section 24.9. We introduce it now, 
however, as it provides an extremely convenient way of analysing individual 
coefficients for which a formula is already available, without returning to 
the characteristic function. We set out from (24.46), 
1 [ 
h 2h,2 
,4 
Cs -- -:y 
(L1 h 4 + 2L2 
+ Lah ) dz 
Cg J 

24.3 SPHERICAL ABERRATION 
357 
So S 
; 
F:'---" 
- z 
Fig. 24.5: Spherical wave surface So centred on the Gaussian image point p}0) and 
aspherical wave surface S distorted by spherical aberration. As the aperture is widened, 
the image point corresponding to the outermost rays, or wave-normals, retreats towards 
the lens. 
in which L1, L2 and L3 are given by (24.3). Retention of the relativistic 
terms in the electrostatic case always renders the calculation extremely 
heavy, however, and we shall therefore apply the method to the nonrel- 
ativistic form of Cs, obtained by setting e = 0, q~ = ¢ in (24.3). 
The 
relativistic results are merely listed. 
We begin by noticing that the quantities ¢, B and h and the operator 
(d/dz) occur in only a few combinations in the integrand of Cs, namely 
(d/dz)~(B2/¢l/2)h 4 and (d/dz)4¢l/2h 4. A set of terms with comparable 
structure is obtained by differentiating once all the terms generated by 
(d/dz)(B2/¢l/2)h 4 and (d/dz)3¢l/2h 4, eliminating h" as necessary with 
the aid of the paraxial equation, h" = -(¢'/2¢)h' - (¢" + y2B2)h/4¢. 
The first term generates 
BB'h4 
B2¢ ' 
B 2 
¢---~ 
; 
~ 
h4; 
and ~h3h 
'¢½ 
and the other, 
¢,,, h 4 
¢,¢,, h 4 
¢,3 4 
¢" h a h' 
¢,2 h a h' 
¢' h 2 h'2 
½ hh 13 
~ 
; 
and 
¢ 
(24.56) 

358 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
Each of these is differentiated and then formally integrated; the term in 
¢1/2hh'3, for example, yields 
d 
¢' hh,3 
½ h, 4 
d--;(¢; hh '~1 = ~ 
+ ¢ 
- 3¢~ hh'~ (¢~'h+ ¢" +4¢ r/2 B2 h) 
(24.57a) 
so that 
]( 
) 
2;' 
¢' 
3 ¢,t "4- rl2B 2 
+ 
~hh '3 + - 
h2h '2 
½ h '4 
2;° 
¢½ 
4 
¢½ 
- ¢ 
dz - 0 (24.57b) 
2;° 
In all we have ten such identities. After first multiplying each by an ar- 
bitrary constant pj, j = 1-10, these are all added to the integral in Cs, 
• ° 
giving 
zi 
1/[ 
32¢2Cs = 
¢½ h'4(16+pl)+h'3h~(-pl 
4-2p2) 
Za 
T 
8- ~Pl +" P2 "~- 3p3 + 
--3p2 + 3p4 
772 B2 Q8 - 3 
+ h'h 3 { ~''' 
¢" ~' 
1 
--~-(P3 + 4p6)+ -7(-~P2- 
P3 + 2p4 + 4p7) 
+ 
(-2p4 + 4ps ) + 
¢2 
(-- ~P2 -- P5 4- 4p9) 
7/2 B B' (2p5 + 4plo ) } 
+ 
¢ 
+ h 4 { ¢(4) 
¢"' ¢' 
1 
-7(p6 - 11 + 
¢~ (-~p~ + p~) 
+ 
(1 - ~v~ + p~)- ~ 
v~ 
¢,,¢,2 
1 
3 
r12B2¢" 
+ 
¢3 (-~V4 - ~P7 + 3ps) + ¢------~---(2 P34 
P54 
r12B2¢ '2 
1 
3 
~2BB'¢' 
1 
+ 
¢-----z--(-~v,- ~v~)+ 
¢-----z--(2p~ - ~p~0) 
~- v9) 

24.3 SPHERICAL ABERRATION 
359 
r/4B 4 
1 
~72BB" 
rl2B t2 
}] 
+ ¢~ (x-ip~)+ 
¢ 
(-4+plO)+ 
¢ p~o 
e~ 
[ 
¢' h2h'2 
'_~__ 
- 
¢½(Pl hh'3 +t~~ 
+P3 
h 3h' 
¢t2 h 3 h' 
7}2 B2 h s h' + P6 ~-~ h4 
CttCt h 4 
¢t3 4 
772B 2¢t h 4 
+~-~- +p8~h +p9 ¢~ 
r/2 BB' h4 
(24.58) 
+ p,o 
¢ 
.o 
Since the multipliers pi are arbitrary, we may choose them in any self- 
consistent way to eliminate terms that are for some reason undesirable. 
For numerical work, for example, we usually eliminate high derivatives of ¢ 
and B; if a field model that permits the integrals to be evaluated in closed 
form is being studied, we may well prefer to have as few terms to integrate 
as possible. Again, we might wish to establish whether C, can change sign, 
in which case we enquire whether or not the integrand can be written as a 
sum of squared terms. The integrated terms all vanish since t(z) appears 
undifferentiated in each of them. They must not, however, be completely 
forgotten, for they can affect the thin-lens approximation, examined below. 
In practice, the simultaneous presence of electrostatic and magnetic 
fields is rare and we therefore list a number of forms of C, for the two 
separate cases, B = 0 and ¢ =const. The mixed forms may be obtained by 
manipulating (24.58). 
Electrostatic case (B = 0, ¢ ~ const) 
General relativistic expression 
in which 
^l 
/ 
32¢02 Cs - 
(Aoh 4 + 2A1 h3hl'q "- 2A2h2h 12 
q" 2A3hh 13 'b A4hI4) dz 
++,,, 
} 
Ao= 
~½ (P6-1)+ 
~--~ 
--~--+1 
+p7 
¢,,2 
¢'¢'" 
1 2 
-4e--(1¢½ -4- p~) 4- ¢]^ (-~"/ P6 4- P7) 
¢'¢'" 
1 
¢,2¢,, 
3 
1 
- 4~ $ ½ (p~ - ~p~) - ~ $ ~ (-3p+ + ~p~ + ~p,) 
(24.59) 

360 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
(~t2 Ctt 
t 
t 
- 2~ ,~g {p~o + ~¢p~ - 7(p~, + p,~)} 
5 72#4 
e¢,4 
2 
T 
2 e 2 ¢,4 
3 ~t p~' 
7¢'" ~p31 
¢"¢'~~-T 
~ ~p31 1 
A1 = -~( 
+ 2p~)- 
( 
+ ~p2)~2 
T 
~¢,¢,, 
- (2p, + p~) 
~ ½ (8p~ + 8p~ - p~) 
7¢ '3 
4e¢'3(p~o 
+ S-V, 
(2p~. - P~) - 
~; "-5- - p~) 
8e2¢¢,3 1 , 
- 
~ 
(~P~-Pg) 
7¢" 
3 
1 
3 
A~ = ,~--~-(4 + ~,~ + ~,~- 
g~,~) 
¢,21 
+ 3V(~, - ~ ~ T) 
T 
4e_.¢: 2 (3~ - ~~) 
7¢ ~ , 
1 
= 
~) 
A3 
-~LP2 - 
(24.60a) 
(24.60b) 
(24.60c) 
(24.60d) 
A4 = ¢½(pl + 16) 
(24.60e) 
The nonrelativistic forms of these are as follows: 
A'o'= Ao(e ~ 0) = ¢(4) 
¢,,___22 
p3 
¢--y(p~ - 1)+ ¢] (1 - T + p~) 
¢'¢'" 
1 
¢,2¢,, 1 
3 
+ 
¢~ (p, - ~p~)- 
¢~ (~p~ + ~p, - 3p8) 
5 ¢,4 
2 czPe 
, 
¢'" 
¢"¢' 1 
1 
A,.= A,(~ -~ 0)= 2-~-~ (p~ + 4p~)- ¢~ (~p~ + ~p~ -2p,- 
p~) 
¢,3 
+ w(2p~ - p~) 

24.3 SPHERICAL ABERRATION 
, 
¢" 
3 
1 
3 
¢,2 1 
P2 
A2"= A2(e ~ 0) = --(4 + ~p3 + ~p2 - ~Pl) "1- 3~y(~p4 
-- -~') 
¢~ 
, 
¢' 
1 
A3"= 
A3(e ~ 
0) -- ~(P2¢21 -- ~Pl) 
A~'= A4(e ~ 0) = ¢½(p~ + 16) 
361 
General nonrelativistic expression 
32¢gCs = 
¢½ h'4(16 +pl) + h'3h-~(-pl + 2p2) 
+h,2h2{¢" 
3 
__ 
4P~ 
_ ¢'3 
} 
¢'" 
¢"¢' 
1 
+ h'h~ -5- (p~ + 4p~) + -7(- ~p~ - p~ + 2p, + 4p,) 
+ 
(-2p4 + 4ps) 
h4 ~ ¢(4) 
CtttCt 
1 
+ 
k 
+ 
(1-4P3+PT)- 
~ ~- 
P8 
¢"¢'~ 1 
3 
}] 
+ ¢~ (-~p,-~p~+3p~) 
dz 
¢,, 
¢1 2 h,2 + P3 
h 3 h' 
- 
¢ ½ (Pl hh '3 -4- P2 ¢ h 
¢,,¢, 
¢'2 h3h, 
¢"' h4 
h 4 
¢')3h4 
(24.61) 
Numerous forms are to be found in the literature, all of which correspond 
to various choice of the coefficients pi. For example, eliminating all terms 
involving h'(z) from (24.61), we find 
f 
( ¢'"¢' 
¢,,~ 
(~)' 
¢"¢'~)h ~ 
32¢0 ~ Cs = 
¢½ 
2¢ 2 + 2--~ + 5 
- 5 ¢3 
dz 
(24.62) 
which may also be written in terms of 
¢(z) := ¢'(z)/¢(z) 
(24.63) 

362 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
as 
64¢g C, = 
¢½(4¢ '2 + 3¢ 4 - 5¢2¢ ' - ¢¢")h 4 dz 
Magnetic case (¢ = const, B # 0) 
General relativistic case 
(24.64) 
32C,, = f {h14(16 +pl)+ h2h'2r12B2(s- 
+3p5) 
¢ 
+ hSh'rl2BB'(2p5 + 4plo) + h ~irl4B4 
1 
~2 (1 - ~ps) 
+ h4 712 BB" 
rl2B ~2 
} 
^ 
(-4+plo)+h 
4 
¢ 
~ plo dz 
[p 
rl2 B B' 
] z' 
hh 's 
r/2B2 h3h ' + plo 
^ 
h 4 
(24.65) 
All derivatives of h can be eliminated by writing pl = -16,p5 = -20/3 
and pl0 = 10/3, giving 
1 /( rl2B '2 
rl2BB" 
r/lB 4 ) 
C. = ~ 
5 
~ 
+4 
h 4 
¢ 
$ 
~2 
dz 
(24.66/ 
Other useful forms are as follows: 
8¢ 
\ 32¢ 2 
85 / hi-~h2h'2 
J az 
(~) 
/{ 
} 
= 
r/4B4h4 +(hB'+ h'B) 2 
,, + 
^ h2h '2 dz 
(d) 
16¢ 2 
8¢ 
8¢ 
(24.67) 
Scherzer's theorem 
One of the aims of the designers of the first electron lenses was to 
find combinations of lens geometry and excitation for which the aberration 

24.3 SPHERICAL ABERRATION 
363 
coefficients, especially Cs, were small, preferably zero. It was not, however, 
long before Otto Scherzer (1936b) demonstrated that the formula for Cs 
can be written as the integral of a sum of squared terms, so that unless all 
these vanish, we can at best find the lens that corresponds to a minimum 
value of Cs. Scherzer's expression was nonrelativistic but Rose (1967/8) 
has since derived the relativistic expression: 
zi 
C8 = 1 / ¢2 
32q~ z0 ~-~2~ (el "~- 62)h4 dz 
{ (¢' ~'~) ,~B~ 1(5+8+~)~'~} ~ 
3(~ ¢'h' ~¢'~)~ 
+ ~ 
~ Ch 
¢¢ 
¢'2 (h' 
5~¢') ~ 
+~ ~+--~ 
6¢ 
C2 - -4r/2B2(1 + e¢) 
q 
¢ 
B 
4 ~ 
r/4 B 4 
1 + 8e¢ ¢,4 
29 r/¢ '2 B 2 
+ 
+ 
I 
(24.68) 
Scherzer's original formula is given by (24.58) if we set 
Pl =-16; 
p2=-8; 
p3----4; 
P4=-5/2; 
P5=-4; 
(24.69) 
p6 = 1; 
p7 = 1/2; 
Ps = -13/8; 
P9 = -4; 
Pl0 = 4 
The electrostatic part of the relativistic expression given by Rose corre- 
sponds to the following values of the pi given in (24.59, 24.60)" 
pl =-16; 
p2=-8; 
p3=-4; 
p4=-5/2; 
p~=l; 
P6 = 1; 
P7 = 1/2; 
Ps --43/24; 
p~ -O; 
P~o - 3; 
(24.70) 
p~, = 6 
For magnetic lenses, the appropriate formula is (24.67d). 
This result has had an immense influence on electron optical studies. It 
is true provided that the derivations of the various expressions are correct, 

364 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
which requires that the lens be round, static and free of space charge; 
furthermore, ¢ and its derivatives must be continuous and the object and 
image must be real. Scherzer himself (1947) proposed methods of correcting 
spherical aberration by relaxing one or other of these conditions: the use 
of components with lower symmetry, such as quadrupoles and octopoles; 
the introduction of space charge or a potential discontinuity; excitation 
of the electrodes of an "electrostatic" lens at high frequency. We shall 
return to these various possibilities in Chapter 41. Meanwhile, Glaser (who 
constantly sought loopholes in Scherzer's proof, see HdP p.227 footnote and 
GdE, p.677 n.163) had the ingenious idea of seeking a magnetic lens for 
which C~ = 0 by solving the differential equation obtained by setting the 
integrand in Cs equal to zero (Glaser, 1940a; recalled in Lenz, 1982b and 
Hawkes, 1986); this failed because the resulting field distribution proved to 
be incapable of producing a real image of a real object (Rebsch, 1940) but 
was found useful in fl-ray spectroscopy (Siegbahn, 1946). aecknagel (1941) 
analysed the electrostatic lens integrand in the same way. Rather later, 
Tretner established the minimum value of C~ as a function of the various 
lens parameters. His work and the complementary analysis of Moses is 
examined in Part VII. 
Thin-lens approximation 
If the lens is assumed to be thin, in the sense discussed in Section 17.4, 
each of the aberration coefficients collapses to a simpler form. For the spher- 
ical aberration, we set out from (24.66) in the magnetic case. An expression 
may likewise be derived for electrostatic lenses (Riedl, 1937) but has been 
little used in practice, no doubt because the potential distribution in the 
latter is rarely as narrow as the field distribution in many magnetic lenses; 
see however, the discussion in Hawkes (1987) concerning Renau and Heddle 
(1986) and their reply (1987). Equation (24.66) gives straightforwardly 
oo 
4 
B4 
Cs=z° 1-~ 
(z) 
~ 
00 
77 2 
2 ,z} 
(24.71) 
in which zo is the distance of the object from the lens centre but it is usual 
to rewrite this in terms of dimensionless quantities by scaling distances with 
respect to some characteristic length of the lens, such as the gap between 
the polepieces, S. Writing 
z/S =: ~ 
(24.72) 
and setting B(z) = Bob(z), where B0 is the maximum value of B(z), (24.71) 
becomes 
CBo 
C---Z--~ = $4~'o4( 
T, + 
to) 
(24.73) 
S 
12q~ = 
8S2¢ 

24.4 COMA 
365 
in which 
go 
CK) 
7"4 :-- / 
b4(~)d~ 
--OO 
OO 
ro := 
de 
--OO 
(24.74) 
in agreement with the expression given by Glaser (1952, eq.124.7) for high 
magnification, Zo = f. 
Approximate expressions for (24.73) as a func- 
tion of a parameter characterizing the lens geometry have been derived by 
Der-Shvarts (1970) and Der-Shvarts and Makarova (1972, 1973); these are 
analysed in Hawkes (1980b). Several early papers discuss these thin and/or 
weak lens approximations; see, for example, Scherzer (1936a), Rebsch and 
Schneider (1937), Gratsiatos (1937), Voit (1939) and Marschall (1939). 
24.4 Coma (terms linear in xo,Yo) 
For lenses such as objectives and probe-forming elements, in which the rays 
are inclined to the axis at a relatively steep angle, the coma is the next 
most important aberration after the spherical aberration. If we consider 
a pencil of rays intersecting the aperture around a circle of radius ra, the 
corresponding aberration figure will be given by 
Aui - 2(K + ik)r2roe i¢° = (K -ik)r2roe i(2~=-~°) 
(24.75) 
in which we have transferred the term independent of ~a to the left-hand 
side since it merely shifts the image point by a distance 2v/K 2 + 2 2 
k 
r a ro 
along a line inclined at an angle arctan(k/K) to the radius vector of the 
Gaussian image point. The term on the right-hand side causes the image 
point to rotate around a circle, centred on the shifted image point already 
discussed, of radius ~/K2+ k 2 2 
The circle is described twice as ~a 
taro. 
varies from zero to 2r. This behaviour may also be seen by multiplying 
each side of (24.75) by its complex conjugate, which gives 
- 2d(g 
o - kVo)} + {av- 
2, a(gvo + k o)} 
2 
= (g + k 
)d,o 
(24.76) 
This clearly represents a circle of radius (K 2 + k2)]r2ro centred on the 
point (2r~(Kxo - kyo), 2r~(Kyo + kzo)). The tangents to this circle from 

366 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
:;1.'Y-" 
,, 
C2 
Z 
Fig. 24.6: Coma. Rays from an object point O intersect the aperture plane around con- 
centric circles C1, C~ and subsequently intersect the image plane around non-concentric 
circles C2, C~. 
the origin are inclined to the line joining the origin to the centre at an 
angle ¢ and sin ¢ = ½; hence ¢ = 30 °. For different values of ra, we obtain 
a family of circles, the centres of which lie on a straight line, all tangent 
to the pair of straight lines inclined to the line of centres at 4-30 ° (Fig. 
24.6). A beam filling the aperture will therefore generate a comet-shaped 
aberration figure, from which the aberration takes its name. 
Coma is characterized by two coefficients, K and k; if k = 0, the line 
of centres passes through the Gaussian image point and the origin in the 
image plane: the coma is radial and is exactly analogous to that of glass 
lenses; K is thus known as the isotropic coma coefficient. 
If, on the 
other hand, K = 0 but k # 0, then the line of centres is perpendicular 
to the line joining the origin to the Gaussian image point: the coma is 
sagittal (or tangential) and has no analogue in light optics; k is known as 
the anisotropic coma coefficient, and is peculiar to magnetic lenses. 
Like every aberration, the coma may be interpreted in terms of the 
corresponding distortion of the surface S = const; we have -SI/W 
= 
(g¢os 
 + ksi  ) 
k2 ¢os(  
:= k/g and 
rat 
o 
: 
-- 
the surface S is therefore partly on the image side of the reference sphere 
So, partly on the object side. It is not so easy to relate the distortion of 
S to the aberration figure as in the case of spherical aberration; Fig. 24.7 
shows the difference between S and So. 
The coefficients K and k may be written in numerous forms. The 

24.4 COMA 
367 
-sZ/w 
ro 
' 
../ 
x 2 
Fig. 24.?: Coma. The distance between S and So as measured by -S I/W. The axes 
are such that Zl corresponds to ~p - ~k = 0 and z2 to tP - ~pk = r/2. 
relativistic expressions for mixed lenses (24.32 with 24.3) in terms of object 
and aperture coordinates are 
zi 
1/ 
K = ~ 
(List 3 + L2(st)'tt' + L3s't'3)dz 
Zo 
Zi 
k = f(pt2 + Ot,2)dz 
go 
(24.77) 
I 
I 
I 
By substituting xa = Xo/to-XoSo/t" and likewise for ya in the complete 
' t/t', h = t/t', it 
expressions for Axi, Ayi and using the relations g = s - s o 
is readily shown that the coma coefficients have the same form as (24.77), 
namely 
1/ 
K = ~ 
(Llgh 3 + L2(gh)'hh' + L3g'h'3)dz 
k =/(Ph 
2 + Qh '2) dz 
(z4.78) 
in terms of position and gradient in the object plane; note that both the 
spherical aberration and the coma contribute when making the substitu- 
tions. In the following expressions, therefore, s and t may be replaced by 
g and h at will. 
For electrostatic lenses, the general relativistic expression for K is 
zi 
A! 
1/{ 
1 
,,2 
3z¢o ~K = - 
gosd + ~A,(3~'t 2 + 
)t 
t" 
go 

368 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
1 
t 2 
+ A2(st + s't')tt' + ~A3(s t + 3st'2)t ' 
+ A4stt t3 } dz 
- 
4 ~° oo(t7 - t2) 
(24.79) 
where the Ai are given by (24.60). The corresponding nonrelativistic form 
is obtained by setting A~ (24.60') in place of Ai. 
For magnetic lenses, we find 
z~ { 
7.14 B 4 
772 S B It 
?72 B '2 
1 
st 3 ( 
+ Pl 
K = ~ 
32¢ 2 
8¢ 
go 
-1- P l ~  
712 B B" 
I/4 B 4 
7/4 B 4 
-P2 4~ 2 -P3 4~ 2 ) 
712 B B' s , ts 
"4- 
^ 
(Pl + 2p3) 
¢ 
+ 712 B^ B' st 2 t' (3pl + 2p2 ) 
¢ 
1 
1 
~2B~'t2t'(~ + v~ - 5v, + 3p~) 
+ ¢ 
~2 B 2 stt '2 ( 1 
1 
3 
+ 
$ 
~ + 2~ - ~w - ~p~) 
+ s' t '3 ( 1 
P5 
P4 
+ P4 + P5 
dz- -~o st'3 
- Ti- s'tt'2 
Zo 
~0 
go 
(24.80) 
Eliminating the term in t '2 from k gives 
~½ + 
27/3 B 3 
~ 
) t2dz 
(24.sl) 
(The general form of k, set out in Hawkes (1980b), is of less interest.) 
TMn-lens formulae 
Some care is needed in deriving the thin-lens formula for K. Choosing 
the pi in such a way that terms involving the discontinuous function t' 
vanish in the integrand, we apparently find that K - O; the presence of this 

24.5 ASTIGMATISM AND FIELD CURVATURE 
369 
discontinuity at z~ means, however, that the integrated term in [s'tt'2]~'o is 
not zero, even though s'tt '2 vanishes at the endpoints. We now have 
] 
¢o s'tta 
slttl2 
+ 
s'tta 
Zo 
2;0 
Za+ 
,2 
,2 
(24.82) 
= 
--t o + ti 
1 
1 --1) 
1 
and with P4 -=-- --~ 
11 
1 
K --+ ~ oz-%-(M-2 - 1) 
(24.83) 
or if the aberrations are expressed in terms of position and gradient at the 
object plane 
1 
1 
g ~ ~(~---~- 1) 
(24.84) 
This integrated term is neglected by Glaser (1952, eq.124.30), who thus 
finds K -~ 0. 
For the anisotropic coefficient, we find 
in which 
rl 3 B 3o S 
rl B o S 
k -+ i6~ 
T3 -~- 8~ 
Tl(t~ -~-t~ 2) 
(24.85) 
c~ 
n = / b(¢) de 
-oo 
(24.86) 
oo 
(cf. 24.74). Here too, we do not agree with Glaser (1952, e.q.124.31); for 
further discussion, see Hawkes (1980b). 
24.5 Astigmatism and field curvature (terms linear in xa,ya) 
These aberrations are usually the least important of the third-order defects 
of electron lenses. The corresponding aberration figure is obtained as usual 
by considering rays from an object point that intersect the aperture plane 
around a circle of radius ra. We have 
Aui = (A + ia)r2rae i(2~°-~') + Fr2rae i~" 
(24.87) 

370 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
The term in F resembles a defocus term; returning to the paraxial ap- 
proximation, u = UoS 4- uat, we see that in a plane close to the image 
plane zi, z = zi + ¢, say, we have u(zi + ¢) ~ u(zi) + ¢u~t~. 
Hence 
u(zi + ¢)- u(zi) ~ ¢uat~. The term in F therefore resembles the blur 
caused by a defocus ¢, ¢ o¢ Fr 2. After reading Chapter 31, it will be ap- 
parent that the term in A and a is the third-order analogue of the paraxial 
astigmatism of imperfectly round lenses. 
Equation (24.87) is the parametric representation of a tilted ellipse, 
as we can see by suitably rotating the coordinate frame. With an angle of 
rotation X, we have 
Auie -ix = (A + ia)r2rae i(2~°-~'-x) 4- Fr2ra ei(~'-×) 
= x/A 2 + a 2 r2rae i(2~°-~'+~a-x) 4- Fr2rae i(~'-x) 
(24.88) 
where A + ia =: ~/A 2 + a 2 exp(i~A). On choosing X so that the exponents 
are equal and opposite, for which 
1 
X = ~o + ~A 
(24.89) 
we have 
A'~ i + iAYi • = A~ i .= Auie-'X 
= Fr2raei(~.-~o-~A/2) + x/A 2 + a2r2r~e -i(~'-~.-~a/2) 
= (r +  
/A2 + 
co ( o - 
- 
+ i(F - x/A 2 + a2)ro2ra sin(~a - ~o - ~A/2) 
(24.90) 
Hence 
al / 
(AYi~ 2 
2ra(F 4- vIA 2 + a 2) 
(24.91) 
+ 
= 1 
, 
al,2 = ro 
\a2/ 
For a fixed object point, therefore, the beam that fills the aperture 
2 
2 < v2t) occupies an ellipse in the image plane, centred on the 
(xa, yalxa+Ya - 
Gaussian image point, with semi-axes al, a2. The major and minor axes 
are inclined to the line joining the origin to the image point. Some typical 
aberration figures are shown in Fig. 24.8. 
The aberration characterized by F is known as the field curvature while 
the coefficients A and a describe the isotropic and anisotropic astigmatism. 
The last vanishes in the absence of any magnetic field. The third-order 
astigmatism is often known as the Seidel astigmatism (as in light optics), 

24.5 ASTIGMATISM AND FIELD CURVATURE 
371 
Fig. 24.8: Astigmatism. Cross-section of an initially circular beam at various planes in 
the neighbourhood of the Gaussian image plane. To simplify the drawing, the ellipses are 
shown vertical or horizontal relative to the principal ray. 
to distinguish it from the paraxial astigmatism, which we shall meet in 
Chapter 31. 
The field curvature is so called from the observation that it vanishes 
if the image is studied not in the Gaussian image plane but on a curved 
surface tangent to the latter. In order to see why this is so, we now enquire 
how the foregoing reasoning would be modified if the object and image 
points lay not on planes but on curved surfaces, tangent to the object and 
image planes at the axis. We examine only the case of spherically curved 
surfaces, So and Si in Fig. 24.9. 
We consider a ray from the object point Po(xo,yo), intersecting So 
at Po(-~o, Yo), Si at Pi(Si, Yi) and the Gaussian plane at Pi(xi, yi). The 
distances fro and ~i are the sagittae of the chords through Po and Pi re- 
spectively, normal to the optic axes, and are hence given by 
2 
-2 
-2 
x 2 + y2 
ro 
~o=Xo+Yo~ 
o 
= 
200 
200 
200 
--2 
--2 
2 
2 
t,"i = 
xi + yi ~ 
xi + Yi 
20i 
20i 
M 2 
2 2 
_~(X2o + y2o ) _ 
M ro 
20i 
20i 
(24.92) 
The sign convention is such that 0° and 0i are regarded as positive if 
z(Co) > Zo and z(Ci) < zi, as is the case in Fig. 24.9; ~o clearly has 
the same sign as 00, and ~i the opposite sign to 0i. 

372 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
I! 
~N 
A 
i 
/ 
/ 
/ 
/ 
/ 
I 
I 
I 
/ 
o 
f 
I I 
N 
.¢/I 
/ ~° 
~o 
'~°I'--~ ,, ~ 
,,,~ 
a.. o 
~o 
II 
OI~.N 
Fig. 24.9: Field curvature. Notation used when the object and image surfaces may be 
curved. 

24.5 ASTIGMATISM 
AND FIELD CURVATURE 
373 
In the Gaussian approximation, we have 
and similarly 
Thus 
• o = ~o~(Zo + ¢) + ~.t(Zo + ¢) 
t 
tt 
3o 
2 
~ 
2 
= Xo + -~oXoro + 20oXaro 
I 
i 
-- 
3o 
2 
~o 
2 
• ~ = • o,(Z~ + ¢~) + ~. t(z~ + ¢~) 
X i -~" Xo,~]~ i -~" Xat~ i 
M 2 , 
M 2 , 
_ 
_
~
 
2 
ti 
2 
-- xi 
8i Xoro _ ~Xaro 
20/ 
20/ 
_ 
M 
2 
t 
2t 
_
~
 
M ti 
2 
Yi : 
Yi 
si yor2o 
Yaro 
20/ 
20/ 
(24.93) 
(24.94) 
5i 
xi 
Ms~ 
Slo )xor2o 
AS/:=~ 
- 50 - M 
Xo - (-~'o~ + 
Mt~ 
t'o 
'2 
M~ 
~" , 
2 
Mt~ 
t" 
~, =~y, - (~ 
+ ~ jyo o - (~ 
+ ~o )y° ~o 
Returning to (24.87), and considering first the terms in F only, we have 
(24.95) 
Ms~ 
Slo 
2 
Ahi = -(~ 
+ ~)Xor o + (F 
t 
2 
(24.96) 
Mt~ 
t o )xar ° 
20/ 
200 
2 is a distortion and will 
with a similar expression for Ayi. The term in Zor o 
be dealt with in the next section. For a plane image surface, 0i ~ cx), the 
last term vanishes if 0o is chosen so that 
t" 
~o = 5F 
(24.97) 
If now we retain all the terms of (24.87), again postponing discussion 
2 
of the term in xoro, we obtain expressions for Ahi and Ayi identical with 
those given by (24.90) except that F- Mt~/20/- t'o/20o replaces F. The 
axes of the ellipse corresponding to particular values of Xo, yo and rA are 
{ 
} 
al,2 -- rAr2o F 
Mt~ 
t'° + (A 2 + a2) ½ 
(24.98) 
20i 
200 

374 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
If ~i takes the value ~I 1) such that 
Mt~ 
t~o 
a 2 ½ 
(24.99) 
2~11 ) =F-~+(A 
2+ 
) 
the semi-axis al is zero and the ellipse then collapses to a line of length 
4(A 2 + a2)l/2r2orA; likewise, for ~i = ~2) such that 
Mt~ = r 
t'° 
(A 2 + a2)½ 
(24.100) 
(2) 
2~o 
a2 is zero and the ellipse collapses to a line of the same length. These lines 
are known as the tangential or meridional and sagittal line loci and the 
corresponding values of ~i as the tangential and sagittal field curvatures. 
For an intermediate value of ~i, ~i, the ellipse becomes a circle; here, lall = 
la21 or 
Mt[ = f 
tt° 
2-~ i 
2~o 
or 
This is sometimes known as the mean field curvature and the corresponding 
circle is again called a 'circle of least confusion'; it is essential to mention 
that the confusion caused by A, a and F is intended. 
We have not mentioned ~o in the foregoing reasoning since microscope 
objects and microprobe targets are usually (assumed to be) flat; it is, how- 
ever, necessary to consider it in some devices, especially those involving 
electron emission from surfaces. 
Finally, we note that to each ~)i corresponds a value of ¢i. Writing 
(24.92) 
:= 
r° 
(24.102) 
~1,2) 
M 2 2 
2~I I'2) 
we have 
A~'= ~2)_ ~1) _ 
M2r2o ( 1 
- 
_(2) 
2 
~i 
2Mr2o ~/A 2 + a 2 
: 
g 
1) 
_(1) 
(24.103) 
Similarly, 
2 2 = Mr2o 
to) 
- 
M r o 
(F- 
(24.104) 
¢ := 
2-~i 
t~ " 
Oi 

24.5 ASTIGMATISM AND FIELD CURVATURE 
17 
p(2) 
f 1 t/ 
~ 
/~(I) 
ray from 
I 
( x° 'Yo) ~ 
/ 
I 
//11 
I 
6aussion 
image 
plane. 
Fig. 24.10: Notation used in connection with a curved image surface. 
375 
which vanishes if F = 0 and •i -~ co: the circle of least confusion due to 
astigmatism alone lies in the Gaussian image plane. The quantity A~ is 
known as the astigmatic difference. Figure 24.10 illustrates the geometrical 
meanings of ~1,2) and A~. 
In terms of the distortion of the surfaces S=constant, the astigmatism 
1 2 2(A cos 2~ 
and field curvature have different effects. We have -S I/W = ~rar o 
1 Fr~ 2 
Thus field curvature, like spherical 
+asin2~o) and -SI/W 
= ~ 
r o. 
aberration, shifts the surface S uniformly away from the reference sphere 
So towards the image plane (F > 0) by an amount that now varies with 
the distance of the object point from the axis. 
For the astigmatism, we write -S I/W = $rar 
ol 2 2~/A 2 + a 2 cos(2~p--CpA), 
tan ¢PA := a/A and we see that the distance from So to S is now described 
by a saddle-shaped surface (Fig. 24.11), S being shifted towards the image 
around ~- ~A/2 = O, ~ and away from it in the neighbourhood of ~- 
¢pA/2 = r/2, 37r/2. The formation of line foci is readily understood. 
The coefficients F, A and a are given by the following formulae: 
zl 
1 ff{2L s2t ~ 
s't) 2 + 2Las'2t '2 
F- 
~ 
1 
+ L2(st' + 
Zo 
+ R(st' - s't) 2 } dz 
(24.105) 

376 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
-sZ/ w 
X2 
Fig. 24.11: The effect of astigmatism on the wave surface. 
zi 
1/ 
A = ~ 
{L182/2 -4- 2L2ss'tt' "4- L38'2t '2 
Zo 
- R(~t'- ~'t) ~} dz 
(24.106) 
t 
= 2 j(P~t + Q~'t')dz 
(24.107) 
a 
Replacing s by g and t by h, we obtain the expressions in terms of posi- 
tion and gradient in the object plane; spherical aberration, coma and the 
expressions for F and A now all contribute. 
The structures of F and A are very similar; we see that 
zi 
F- 2A = W~ / L2 -4- 3R 
Zo 
~ 
dz 
zi 
= ]TITs / 7¢" + 4~7 2B2 
Zo 
dz 
(24.~0s) 
which is a function of ¢(z) and B(z) only and does not contain s(z) or t(z) 
except in the Wronskian. This quantity is known as the Petzval coe~cient; 
it can be shown that it is the only linear combination of the third-order 
aberration coefficients that possesses this property. 
For electrostatic lenses the general relativistic expressions for F and A 
are 
32¢02A = ~ 
{Aos2t 2 + Alst(st)' + A3s't'(st)' 
1 
t, 2 
s, 2 
+ A4s'2t a + -~As(s 2 
+ 
t 2) + A6ss'tt'} dz 

24.5 ASTIGMATISM AND FIELD CURVATURE 
377 
1 
P~ -P2 r7¢, 
] 
- 2 pl[~½ss't'2] 4- 
4 
L~-~ ~t'= 
(24.109) 
^1 
2f 
32¢g F = ~o 
{A°s2t2 4- Alst(st)' 4- A3s't'(st)' 
1 
4- A4s'2t '2 4- ~A6(st' 4- s't) 2 4- Asss'tt'} dz 
_ pl[~ {ss,t,2] _ P~2 4- P2 "Yf's2t,2] 
(24.110) 
4 
¢-~ 
in which 
_ 7¢" 
1 
1 
A~.- 
$~ {p~ + ~(p~ -p~)- 
~pl } 
¢,2 
3 2 
+ ~ {P' - ~ 
(p~ - p~)} 
,¢2 
~ 
{ Sp; - (p~ - p~) } 
7¢" 
1 
, 
1 
A~.= $--y{s + 2p~ ÷ ~(p2 + p~)- ~pa } 
¢t2 
3 2 
+ ~-T{2p,~ - ~ 
(p~ + p~)} 
e¢ '2 
~ 
{ 16p~ - (P2 4- P~) } 
For magnetic lenses, we have 
(24.111) 
(24.112) 
zi 
1 f 
;74 B 4 
1 
1 
1 
A = ~o 
{~t~{ 
~ 
(5~ - ~P~ - ~P~) 
2;o 
;72BB" 
1 
;72B'2 
+ 
^ 
(px- 
+ 
p~} 
2;72 B B ' 
+ ----7 
st { s't(pa + Ps) + st' (Pl 4- P2 )} 
;7 2 B 2 { s, 2 t2 
1 
2 t,2 
1 
+ 
^ 
(p~ - ~p~) + ~ 
(p~ - ~p,) 
¢ 
1 
1 
1 
+ 2ss'tt'(-~ + p5 + p2 - -4p3 - -4P4) } 
1 
4- st2t'2(~ 4- p3 4- p4)} dz 

378 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
2,/ 
71 to 
B 2 
= 
dz 
s¢ 
tto 
4ss'tn + Pasntt' Zo 
(24.113) 
using (24.108), and 
2,/ 
to 
B2 dz 
F= 2A+---z- 
2¢ 
(24.114) 
Zl 1/ 3,3 
]z 
go 
(24.115) 
Thin-lens formulae 
For magnetic lenses, the isotropic and anisotropic astigmatism both 
vanish, 
A~0 
, 
a~0 
(24.116) 
and the field curvature is hence equal to the Petzval coefficient: 
2, / 
rl2 B02 r2 
71 to 
B2dz = 
F -~ ---= 
2¢ 
2¢¢0 
(24.117) 
Glaser (1952, eq.124.29,31) also finds a ~ 0 but his expression for A, 
and hence that for F, does not agree with ours. Der-Shvarts and Makarova 
(1973) find the same thin-lens expression for F but do not agree that A ~ 0. 
(Note that these authors do not adopt the definitions of field curvature and 
astigmatism employed here.) 
24.6 Distortion (terms in xo and yo only) 
These aberrations are of most importance in lenses in which the rays are 
comparatively far from the axis at the object plane. 
They are usually 
negligible in microscope objectives, therefore, but are the dominant geo- 
metrical defects of projectors. They can be kept acceptably small either 
by careful design of the column of a conventional instrument or by employ- 
ing a very compact type of lens, which we describe in Part VII. As their 
name indicates, distortions do not blur the image but merely destroy the 
proportionality between image and object coordinates. 

24.6 DISTORTION 
379 
From (24.36), we see that 
Axi -- r2o(Dxo - dyo) 
Ayi = r2(Dyo + dxo) 
(24.118) 
and to avoid repetition, we modify these expressions to include the terms 
that arise if the object and image surfaces are curved (spherical), as in 
Section 24.5; this gives 
or 
A-~i__ {(D Ms~ s'o) 
} 2 
(24.119a) 
20i 
200 
Xo - dyo r o 
A~i_ {(D Ms~ Sto ) 
} 2 
(24.1195) 
20i 
200 
Y° + dx° r o 
A~i = (D* + id)r3o ei~° 
with D* = D 
- 
Ms~/20i 
- 
S'o/20o. Writing 
Aui :: ei~°(Aro + iroATo) 
(24.120) 
we see that 
• 
3 
AT 
=dr2o 
(24.121) 
Aro - D ro 
o 
so that D* shifts the image point radially relative to its Gaussian position 
whereas d shifts it azimuthally. Consider now a square grid in the object 
plane, xo = mic 
for all yo and yo = n~1 
for all Xo, m, n = 0,1, ... (Fig. 
24.12a). For d - 0, the grid will be shrunk, as shown in Fig. 24.12b if 
D* < 0; this is known as barrel distortion. 
If D* > 0, the grid is distended 
as in Fig. 24.12c; we then speak of pincushion distortion. 
The coefficient D is the isotropic distortion coefficient. 
IfD = 0 but d # 0, the grid is warped as shown in Fig. 
24.12d. 
The coefficient d is known as the anisotropic distortion coefficient 
and 
vanishes in the absence of magnetic fields. It is often referred to as the 
spiral distortion or occasionally (Sturrock, 1955) as the pocket-handkerchief 
distortion. 
In terms of the shape of the surfaces S=const, the distortion has a 
very simple effect. We have 
-S'/W 
= rar3(DcosT + dsinT) = rar3ox/D 2 + d 2 cos T _ TD) 
with tan TD = d/D and the distance between So and S is therefore repre- 
sented by a plane. The sphere So may thus be pictured as being shifted 

380 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
b 
/.-" r'-'-"~ ~ 
~... 
~.-.-- --,,.._ ~ 
C 
Fig. 24.12: Distortion. (a) Square grid in the object plane. (b) Image with barrel 
distortion. (c) Image with pincushion distortion. (d) Image with anisotropic or "spiral" 
distortion. 
bodily so that the Gaussian image point is shifted by an amount that is 
constant for each object point but different (c(r3o) for object points at vary- 
ing distances from the axis. This is exactly the behaviour we have already 
described as characteristic of distortion. The coefficients D and d are given 
in general by 
zl 
,/ 
D = ~. 
{Ll~t + L~'(~t)' + L~'~ '} ~ 
go 
Zl 
e =/(p~ + Q~'~)ez 
Zo 
(24.122) 

24.6 DISTORTION 
381 
For electrostatic lenses, the general expression is 
zi 
A1 
,/{ 
1 
32¢o ~ D = ~ 
Aos3t + -~Als(3s2t ' + sat) + A2ss'(st + s't') 
Zo 
~-2A3st(s2tt~-3sl2t)+A4st3tt}dz 
3 
1 
7¢'s2s,t, 
- ~p,~'~t' + ~p~ ~-~, 
7¢'/ 
1 
¢'^: 
e 1'2 
]~' 
(24.123) 
For magnetic lenses, 
d 
1/{ 
(,'B" eBB" 
CB'~ 
D=~ 
~t 32g~ 
8~ +P' 
,12 BB" 
rl 4 B 4 
+ P' 
~ 
- (P~ + P~) 4~ / 
~2BB' 
+ 
s3t'(pl + 2p3) 
q2BB's2s't(3pl + 2p2) 
+ 
r/2B 2 
1 
1 
+ 
¢ 
q2 B 2 sst2t( 1 
1 
3 
+ 
~ 
-~+2p2-~p4-~ps) 
+ ~'~t'(~ +p, +p~)} dz 
t, ° P5 
+P4 
+P3 
¢ 
Zo 
zi 
1 
2'/3 B3 ~ s 2 dz 
/ 
zo 
qB 
, 
qB' 
] ,,i 
+ 4~ 
--~ -~~Jz° 
(24.124) 
(24.125) 

382 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
Thin-lens formulae 
For magnetic lenses, we find 
D=0 
d = rIB° rl 
(24.126) 
Glaser (1952, 124.30) likewise finds that the isotropic distortion coefficient 
vanishes but, unlike us, he also finds d = 0 (123.31); the origin of this 
disagreement lies in his use of a partially integrated expression. 
24.7 The variation of the aberration coefficients 
with aperture position 
The aberration coefficients clearly vary with the position of the object 
and aperture. In the case of the real aberration coefficients, with which 
we are concerned here, it is principally the aperture dependence that is 
important, since objective and probe-forming lenses are mostly operated 
with the specimen close to a focus. 
Furthermore, it is not possible to 
enunciate general laws about the dependence of the aberration coefficients 
on object position when the latter lies within the field owing to the fact that 
Zo is the lower limit of integration in SIi. Their dependence on the aperture 
position can, however, be studied as we now show, and it will transpire that 
some aberration coefficients can be made to vanish by choosing za suitably. 
Each of the integrands appearing in the aberration coefficients consists 
of one or more terms of the form f(z)sPs'qtrt ts, p + q = m, r + s = 3- m, 
in which, we recall, s(z) and t(z) correspond to some particular aperture 
position.For this choice, we have (24.36) 
2 
Xo 
D 
K 
2A 
a 
2 
Axi = 
xa 
F- 
A 
C 
2K 
2k 
Yo 
-d 
-k 
-a 
0 
v 
(24.127) 
with a similar expression for Ayi 
aperture position, we should have 
(x ~ y, y ~ -x). For another choice of 
(xo) 
AX'i = 
Xa 
Yo 
-k 
2 
2K 
(24. 2s) 

24.7 THE VARIATION OF THE ABERRATION COEFFICIENTS 
383 
with 
-2 
--2 
-2 
ra := Xa "Jr- Ya 
V := xo~a + yoY~ 
(24.129) 
V :: XoYa -- XaYo 
In (24.128), the coefficients must have the same overall structure as those 
of Axi but contain ~ and t satisfying -~(zo) = t(2,) = 1, -g(-i,) - t(zo) = O. 
Setting 
t(z) - rt(z) 
(24.130) 
we see that 
and 
(:7 = 
T 
-- 
1 
t(eo) 
(24.131) 
7t' - -~'i- T(st' -- s't) 
(24.132) 
W~ = rW~ 
From the expressions for A, C,..., k, it is a simple matter to show that 
-K 
r2 a 
r 2 
0 
0 
0 
K 
-A 
ra 2 
2ra 
r 
0 
0 
0 
A 
-F 
_ 
2ra 2 
4ra 
0 
r 
0 
F 
a 3 
3a 2 
2a 
a 
1 
D 
r 2 
0 
0 
k 
0 
2a7- 
r 
0 
a 
ti) 
o .2 
o" 
1 
\d/ 
(24. 3a) 
A number of general conclusions about the various aberrations can 
be drawn from (24.133). Disappointingly, there is no privileged aperture 
position so far as the spherical aberration is concerned: (24.133) merely 
confirms the obvious result that since the aberration is expressed in terms 
of aperture coordinates, the closer the aperture is to the image, the smaller 
will the coefficient be--but x a and ya will be large[ 
The expression for K shows that if a can be chosen so that 
K + aC - 0 
(24.134) 
the coma will vanish. The existence of a coma-free point has long been 
known in optics" see Herzberger (1931, 1958) for extensive discussion and 
Czapski and Eppenstein (1924) for the earlier history. 

384 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
The isotropic astigmatism vanishes if 
A+ 2aK + a2 C = 0 
(24.135) 
There will be two astigmatism-free aperture positions if K 2 > AC, one if it 
so happens that K 2 = AC (the Finsterwalder condition, see Finsterwalder 
1892), and otherwise none. In the case K 2 = AC, we have a = -K/C, 
so that the coma too vanishes. Similar reasoning can be applied, not very 
profitably, to the field curvature and distortion. 
Turning to the anisotropic aberrations, we see that the coma (k) cannot 
be eliminated by choosing the aperture position suitably; the astigmatism 
vanishes if a = -a/2k, and the distortion if a = {-a :t= (a 2 - 4dk)}/2k. If 
a 2 = 4dk, astigmatism and coma vanish simultaneously for a = -a/2k. 
Of these results, only the existence of a coma-free aperture position 
has found any practical application. 
We note that relations identical with (24.133) are obtained if, instead 
of replacing ~ and t by s and t, as we have done, we write Xa := X(~a) = 
X oS(-5,) + X at(-Sa) and use this to replace x a by ~a and likewise y, by ~ 
in the expressions for Axi and Ayi. Although this leads to the same result 
with less effort, it is not immediately obvious that the boundary conditions, 
Ax = Ay = 0 in the object and aperture planes, are satisfied. In fact, both 
techniques are legitimate, as the agreement between the results confirms. 
24.8 Reduced coordinates 
For reference purposes, we reproduce the expression for each aberration 
coefficient in terms of reduced coordinates (Section 15.3.1), as derived by 
$turrock (1951c, 1955). Note that not only is v(z) related to u(z) by (15.40) 
but that the paraxial solutions satisfy the reduced equation (15.38). This 
has been a pitfall in the past (Glaser, 1952, p.676; Kuyatt, 1978). 
The forms of the coefficients A, C,... k listed in Sturrock (1955) are 
as follows; these are a generalization of the earlier expressions, for electro- 
static and magnetic lenses separately, to be found in Sturrock (1951c). The 
functions a(z) and r(z) are the solutions of the reduced paraxial equations 
* For those unfamiliar with Gaussian units, a c.g.s, system employing both electromag- 
netic units (e.m.u.) and electrostatic units (e.s.u.), we note that Sturrock's units may be 
converted to SI by writing ~[Sturrock] -~ 2¢¢[SI]; p[St] -~ 2~/¢¢(1 + ¢¢) = 2(¢~)1/2[SI]; 
U[St] -~ (1/lO0)(e/moc)B[SI]. Note that when converting Sturrock's formulae, centime- 
tres must be replaced by metres, particularly in derivatives. The presence of the factor 
(1/100) above is an instance of this. 

24.8 REDUCED COORDINATES 
385 
satisfying the boundary conditions a(Zo) = r(za) = 1, a(Za) = r(zo) = O, 
and We is the corresponding Wronskian, We = r'(zo) = -a'(za). 
A + ia = i-6 
~2 
4a'r' - 7We -: + 2iWe- 
i 
We 
$2 
{ar(Pa'r' + Qar) - W~T 
o 
+ iW~(R~'r' + S~,,-)} dz 
C = -~ 
~o~2 
r2(Pr a + Qr2)dz 
D+id=- 
-~- 
-g 
+-~6¢-£-aa ' 
¢ 
1(72¢ '2 
7¢" 
rl 2B2 ) 
16 
-i--p-+5-; 
-+ 
^ ¢ 
iT/B 
i ~ 
i 
8 ,~ ~r' + i-6 
'72 o 
i 
We 
2(Pa'r' + Qar)a 2 -- WePaa' 
0 
+ iW~(Ra '2 + S(:r 2) } dz 
1 
a't'] o 
i 
W. 
~2 
ar(Pa'r' + Qar) dz 
o 
i 
1 
, 
- 2We 
~2 
(P + 2T)az 
O 

386 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
1 [(¢-~) ½ ]' 
K + ik = § 
r'2 o 
i 
w~ 
T 
0 
i 
½ 
- 2i/(~) 
O 
2(Pr a + Qr2)ar - W.PrC} dz 
(Rr'2 + Sr 2) dz 
(24.136) 
in which 
3(¢') ~ 
~ 
~B~ 
P(z)'=~ 
~ 
(1+ e¢)+ 32¢ 
Q(z):= 
R(z) : = 
S(z) 
. = 
T(z) " = 
234 ~ 
4 
°° (1+ 
10-24 
--~-~- e¢ 
( 
)7¢'~¢ '' 
65 
12e~ 
+1-~ l+T3 
~3 
256 
~ 
( 
8 )¢'~ ~m 
27 1 + e¢ 
512 
5 
~3 
37 77 2 B 2 ¢" 
97 ,/2 BB' ¢' 
256 
~2 
~128 
~2 
3 r/4B 4 
1 7/2 B '2 
128 ~2 
32 
~B 
16¢½ 
5 (l+~_~)¢'2r/B 
256 
4~ 
7 ¢"r/B 
7 ¢'r/B' 
3 ~73B 3 
32 ~} 
32 ~ 
5 
1+ 
e 
256 
-g- 
64 ~-~ 
3 ~72B 2 
64 
(24.137) 

24.9 SEMAN'S TRANSFORMATION 
24.9 Seman's transformation of the characteristic function 
387 
We have seen how useful is the technique introduced by Seman for perform- 
ing partial integration on aberration coefficients in a systematic fashion. 
Originally, however, it was not the individual coefficients but the perturba- 
tion characteristic S I to which the technique was applied, thus generating 
a set of coefficients all possessing similar characteristics, such as absence 
of high order derivatives of ¢(z) or B(z). Seman considered electrostatic 
and magnetic round lenses. The idea behind his method is to be found in 
two early notes (Seman, 1951, 1954) and a full account appeared shortly 
afterwards (Seman, 1955a,b, 1958b). We illustrate the power and simplic- 
ity of the technique in the case of orthogonal systems consisting of suitably 
orientated magnetic and electrostatic quadrupoles and round electrostatic 
lenses. Only the main steps in the reasoning are presented here; for ad- 
ditional details, see Hawkes (1966/7b). This discussion is limited to the 
nonrelativistic approximation but the relativistic case has been explored in 
detail for round electrostatic lenses (see Hawkes, 1977a and Chapter 34). 
It is convenient to introduce the vectors x := (x,y), 5~ := (x,-y), 
whereupon M (2) and M (4) may be written 
¢" 
1 
1 ½ x, 2 
M (2) = 
x 2 
~)~¢ 
8¢½ 
+ 4Q(x" 
M(4) = (¢(4) 
¢,,2 
10)x 4 
128¢½ 
128¢~ 
2 
+ 
32¢~ ~-0 (.,.i~) 2 
+ 
32¢~ 
48¢21 ~~ 
x2(~'i~) 
X2Xt2 
P2 
16¢½ 
+ 8-~ (~" 5~)~e'2 - 
~,4 
~TQ~{(x.a:)x2' 
x2(x.5:) ' } 
+-T6- 
(24.~3s) 
in which 
Q .= p2 
¢½ 
2~Q2 
p4 2~Q4) 
o.- 
and •2 and ~4 denote (~. x) and (x. x) 2 respectively. 
(24.~39) 

388 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
The individual terms of M (4) fall into groups, which have the following 
'dimensions': 
and 
[p4/4 ½ or Q4 = • 5~] 
are therefore 
[p2/¢ ~ or 
Q2 [=2] [=. ;~] [d/dz] 
(24.141) 
These generate 16 terms possessing the appropriate dimensions, eight in- 
volving ¢ alone (rl - r8), three each involving P2 alone (el - e3) and Q2 
alone (ml -m3) and two mixed terms (r9 and rio): 
111 
rl __ ¢½ =2t=t2 
r6 __ __=4 
¢½ 
¢, 
~2 = ~(~2')2 
¢,,¢, 
r7 -- 
=4 
¢] 
¢, 
r3 = __=2=t2¢~ 
r8 _-- __¢t3 =4 
¢] 
r4 ~__. CHZ2=2t 
P2¢t 
¢~ 
r9 =- __=2(= 
, ~) 
¢] 
t2 
r5=¢ =2=2, 
r/Q2 ¢' 
¢---~- 
rl 0 __ 
¢ 
=2(=. ;~) 
p2 =2t(= 
~) 
el -- __ ¢½ 
P2 =2(= 
~)t 
e2 --" __ ¢½ 
~ = L~ ~2(~ ~) 
¢½ 
ml -- ~Q2=2t(=. ~) 
m2 ._ ~Q2=2(=, ~)t 
m3 -" ~Qt=2(= . ~) 
(24.142) 
or 
2 
Since S I = f M (4) dz, the terms of S I are generated by quantities with one 
lower power of d/dz than (24.140); the only terms in which d/dz survives 

24.9 SEMAN'S TRANSFORMATION 
389 
The terms rl, rl,.., rs are identical with eight of Seman's terms ij, those 
not containing the magnetic field. 
The refractive index can be altered in form without affecting the 
eikonal by adding to it expressions that vanish; such expressions are ob- 
tained by differentiation of each of the quantities rnj, ej and rj and elimi- 
nation of x" with the aid of the paraxial equations. We find 
, 
1 
1 
1 
r 1 T ~R17 -4- ~R22 T R2a 
-
-
 2R24 
-
-
 E5 - 
~E6 -4- 2M5 + M6 - 0 
, 
3 
r2 -t- R13 - 2R15 + 4R19 + ~R21 - R22 -4R23 = 0 
, 
1 
1 
3 
r 3 ~- ~R13 - ~R16 - R17 + -~R18 + R20 - R23 - 0 
, 
1 
r 4 + ~R3 - R6 + 2R9 + R13 - R14 - 2R17 - R22 = 0 
i 
1 
r5 + ~R2 - R7 + 2R10 + 2R12 - 2R13 - 2Rls - R21 = 0 
, 
1 
r6 + ~R4 - R5 - 2R14 = 0 
I 
3 
r7 + ~R2 - R3 - R4 - 2R13 = 0 
, 
5 
rs + ~R1 - 3R2 - 2R12 - 0 
r 9' - 2R6 + 3R7 - 2R8 - 2R15 - 2R16 - 0 
' 
-Rg+R10-R11-R19-R20=0 
rl0 
I 
e I + R6 + 2R15 - 2E1 - 2E3 - 4E5 - 2E6 + 4Es = 0 
t 
e2 + R6 + 2R16 - 2E2 - 2E4 + 4E5 - 4E6 + 4Ms - 0 
t 
e3 + Rs - 2El - 2E2 - 2E7 - 0 
, 
1 
1 
m1+~Rg+~R19-Es-Ml+2Ma-2Ms-M6 
=0 
, 
1 
1 
m 2 -[- ~r9 W ~R2o - M2 -+- 2M4 ~- 2M5 - 2M6 - Ms = 0 
t 
m3-M1-M2-MT-O 
(24.143) 

390 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
in which 
¢,4 
X 4 
RI 
¢-~ 
¢,2¢,, 
R2 - 
x 4 
¢5/2 
~H2 
R3 : ¢--Q~= 
¢'"¢' =~ 
R4- 
¢3/2 
¢(4)=4 
R5 = 
p2¢"=2(=. ~) 
R6 = ¢3/2 
P2~'2 X2(~ .~) 
RT= ¢5/2 
n~ = p~¢' 
¢-~~(~. ~1 
Q~¢"=~(=. e) 
R9 = 77 
¢ 
Q2¢ '~ =2(=. ~) 
Rio - r] 
¢2 
Rll = ,~Q~~',,~(,~ • e) 
t3 
¢ 
2~2, 
R~2- ¢--Q~z 
_ 
P~ ~2,(~ 
E1 
~ 
, .~) 
P~ =~(=. ~)' 
E2 --= ~-]~ 
E3 - ¢-~ 
p2 ~4 
E4 = ¢-~ 
P2 z,2(z. ~) 
E5 = 
P2 
E~ = ~-~=~(=. ~) 
T 
E8 --p2Q2 
'~ ¢ (='~)~ 
c~tt ~ t 
2 2t 
R13 = 
¢--5~;r, = 
III 
X2X 2t 
R14 = 
p2¢' 
R15 = ~-~/2 z2'(= • ~) 
Y 
p2¢' 
), 
Ri~ = ~--~(=" 
T 
¢" 
R17 - ~--~X 2~t2 
R18 -- 
x2xt2 
Q2¢'=2'=2(=. i~ ) 
R19 = 77 ¢ 
Q~¢' ~(= ~)' 
R2o = ,7 ¢ 
= 
• 
¢'~ (=~,)~ 
R21 = 
¢" (=~,)~ 
R22 = 
l xt2~ 2t 
R23 = 
R24 = ¢ ½ z'4 
M~ = ,TQ'~=~'(= . ~) 
M~ = ,TQ'~=~(= . ~)' 
M~ - ,? Q~ 
-i~(~ " ~1~ 
M~ = ,7 ~ Q~ =~ 
M5 = ,1Q~z'2(= • ~) 
M6 - ,TQ2z2'(z • ~)' 
M~ = ,TQ'~=~(= . ~) 
p2Q2z4 
M8=,7 
¢ 
(24.144) 

24.9 SEMAN'S TRANSFORMATION 
391 
Each of the identities (24.143) is now weighted by an arbitrary multiplier, 
pj, ej and pj, and added to the expression for f M(*)dz which has the 
primitive form 
S I -- / M (4) dz 
1 fo{_z 
4 
2(z ~)2 
= -~ 
+ 
• 
}dz 
+ ~ 
-R3 + Rs + 4R6 -8R17 - 16R24 
~ ) 
- 4Ez + 16Es - ]E7 + 8M1 - 8M2 + ]M7 
dz 
(24.145) 
The general form of S I is thus as follows: 
f 
12ss ' - 64 ] o{-= ' + 2(=. ~)=} dz 
10 
3 
3 
] 
] 
/{0 
(; 
~ 
) 
( 
1 
) 
+ (~~_ ~,)~, + (1_ o~ + (~_ ~_ ~.~, + ~1 + ~~ 
+ (--05 + 309)//7 + (--209 + 03)R8 
( 
1 
1) 
"{- 204 -- 010 -~- ~]21 -~- ~"2 
R9 -~- (205 ~- 010)R10 - 010Rll 
+ 2(05 - 0s)R12 
( 
1 
+ 
02 + ~03 + 04 - 205 - 207)R~3 + (-04 - 206)R14 
(1 
) 
+2(-02-09+el)Rls+ 
-~03-209+2e2 
R16 
( 
1 
) 
(~ 
) 
+ 
-8+~01-03-204 
Rlv+ 
~03-205 R,8 
( 
) 
( 
) 
(~) 
-~- 402--010-~-~.I RI9-}- 03-010-}-1.2 R20-}- ~02-05 R21 
(1 
) 
+ 
io~ - 02 - o~ R~ + (01 - 402 - o~)R2~ + (-16 - 20~)R~ 
+ 2(-~, - ~)E~ + 2(-~2 - ~)E2 + (-4 - 2~, )E~ 

392 
24. THE GEOMETRICAL ABERRATIONS OF ROUND LENSES 
(1 
) 
- 2ezE4 + (16 - ~ol - 4el + 4ez)E5 + 
-~el 
- 2el - 4e2 
Ee 
+ 
-g - 2e3 E7 + (4~ - ~l)E8 
+ (8 - ~,~ - ~)~ 
+ (-8 - ~,2 - ~,~)M2 + 2~,~3 
+ 2p2M4 + (201 - 2pi + 2p2)Ms 
+ (O~ - p~ - 2p2)Me + (8 - p3)M, 
+ (4~2 -/~2)Ms 
dz 
) 
(24.146) 
From this very general expression, many useful forms of S ! and hence 
of the aberration coemcients can be derived. These are exhaustively ana- 
lysed in Hawkes (1966/7b) and we say no more about them here. 
Before leaving this topic, we should, however, mention that not quite 
all possible forms of the eikonal or aberration coemcients emerge from the 
foregoing expression. Further transformations, which are in practice very 
often simplifications, can be made by recalling that the Wronskian is a con- 
stant. Thus ~½(st ~- s~t) or its square may be differentiated, weighted and 
added to the aberration integrals; this frequently enables us to eliminate 
otherwise persistent but unwanted terms. 

25 
Asymptotic Aberration Coefficients 
For most lenses, projectors and condensers in particular, the "object" is 
in fact an intermediate image of the specimen or the source created by 
the lenses upstream, so that the entire lens field participates in the image 
formation. We are thus interested in the coordination between incident and 
emergent asymptotes, as explained in Chapter 16, and the corresponding 
aberrations are hence said to be asymptotic. 
They were first thoroughly 
studied by Lenz (1956, 1957), using the trajectory method; the correct 
form of the characteristic function is to be found in Sturrock (1955) and 
this was later employed by Hawkes (1968, 1970b,c) to explore them in more 
detail. As for the real aberrations we must distinguish between aberrations 
expressed in terms of position and gradient at the (asymptotic) object and 
in terms of position in the (asymptotic) object plane and real aperture 
plane (or the entrance pupil). The former are generally more useful and 
we deal with them first. 
(1) 
(1) 
X~I) 
In order to introduce the boundary conditions Xo 
- 
yo 
-- 
y,(1) 
, 
, 
o 
- 0 directly, we need the relation between p(1) q(1) Xl(1) and y'(1); to 
the paraxial approximation, we have 
p "= p(P) -- ¢ ½ x' 
q := q(P) = q~ ½ y' 
(25.1) 
while to the third-order approximation, 
p .= p(p) + p(1) = ~ ] x' (1 - 
q "-- q(P) A- q(1) = ~ ½ y, (1 - 
x'2 +2 yt2 ) 
X'2 +2 yl2 ) 
(25.2) 
Setting x' = x '(p) + x'(1) and y' = y~(P) + y'(1) we obtain 
lx,(P)(x,(p)2 
y,(p)2 } 
p(1) __ ~ 
X,(1) _ 2 
.~_ 
) 
q(1) __ ~½ {y,(1) --21y'(') (x,(,)2 +y,(,)~ }) 
(25.3) 

394 
25. ASYMPTOTIC ABERRATION COEFFICIENTS 
Thus if we impose the condition X '(1) -- y,(1) 
= 0 in the object plane, the 
quantities p(1) and q(1) must take the values 
p(o~ ) 
1 ~½ , 
= -~o 
~o(~f + y:~) 
qO) 
1 ,~ ~., (X, 2 
'2 
= -~.o 
~o~ o + Yo ) 
(25.4) 
in that plane, where we have dropped the index (p). Substituting this into 
the expression for S012 (22.23), we find 
AS~/_ p~l). Ax2 + q~l). AY2 -(x~ 1)" Ap2 -t- y~l). Aq2) 
1,-½ 
I 
+ ~¢o (~'o. A~o + yo. ~yo)(~7 + y'~) 
(25.5) 
Substituting x(z) -- xoG(z)+x~oH(z), y(z) - yoG(z)+y~oH(z) from (16.1), 
with 
lim G(z) - 1 
lim H(z) = z - Zo 
(25.6) 
Z--+--O0 
Z---+-- O0 
we find 
x(~)(z~) = ¢~ H~ OXo 
1( os£ 
y(1)(z2)-- ~ 
H~ Oyo 
OSI) 
1H. 
• 
OSI2 ) 
!H~y'o02o 
G~ Oy 5 
- 
2 
(25.7~) 
and 
1 (H~' °s~o~ 
*' °s~o~ ) 
X'(1) (Z2) : 
,,/~ 
0Xo -- G2 Ox" 
1 
1 ,-2 
- ~H~'~'oO~o + ~o2 
(25.7b) 
y'(1)(Z2) = ~ 
--G;' 
1,.,.,I In2 
1 I 2 
in which G~ and H~ denote the asymptotes to G(z) and H(z) in image 
space and we extend (24.33a) by writing 
I 
! 
eo ~ := ~7 + y~ 
ro = ~o~o + yoyo 
I 
! 
Vo -- Xoyo -- Xoyo 

25. ASYMPTOTIC ABERRATION COEFFICIENTS 
395 
SI (-oo , oo ) 
Z 
S I(zoJ-oo) 
Z 
, i 
Fig. 25.1: Branches of S~. The asymptotic branches St(zo,-Oo) and St(oo, zi) are 
straight lines, the asymptotes to S I(-oo, oo). 
These formulae are exactly analogous to (24.27) and by following the same 
reasoning as we employed for the real aberrations, aberration integrals in- 
volving B, ¢, G and H similar in appearance to those listed in Chapter 24 
are obtained. Before doing this, it is advantageous to replace the ray H(z), 
which varies with object position, by the ray G(z) introduced in Chap- 
ter 16, which does not. In this way, we obtain aberration integrals that are 
characteristic of the distribution B(z) or ¢(z), irrespective of the working 
conditions. 
The ray G(z) is, we recall, defined by the boundary condition (16.1) 
limz__.~ G(z) = 1 and hence 
/° C(z) + yoU(z) 
H(z) = ---~ 
= -fo(ma- G) 
(25.9) 
where 
1 
m "= ~ 
(25.10) 
is the reciprocal magnification (not to be confused with the demagnification, 
the term commonly employed to describe a magnification ]M[ less than 
unity). 
The characteristic function SIi now consists of three branches (Fig. 
25.1). We write 
sIi =: S'(zo,-oo) + sI(-oo, oo)+ sl(~,z,) 
(25.11a) 
The contribution SI(-oo, c~) is given by 
OO 
SI(-c~, oo) = / M (4) dz 
(25.11b) 
,a# 
into which we must substitute x(z) = xoC(z)+x~oH(z) = (xo- fox~om)C(z) 
+fox~oG(z) and similarly for y(z). The other two contributions are "vir- 
tuar'. In them, ¢(z) = const and B(z) = 0 and the rays G(z) and g(z) or 

396 
25. ASYMPTOTIC 
ABERRATION COEFFICIENTS 
m G(z) are replaced by their asymptotes. Thus 
^1 
St(Zo,- 
) = 
Cg 
- ~ 
o li.._,_moo(z - 
z o) 
,,1, 
=-¢g04{ 
lim (Z--ZFo)--fom} 
~0 
Z-'-~ 
~ 
O0 
(25.11 ) 
Sl(°°'zi)=-¢-~"~ ~ 
riM 
(25.11d) 
The reason for introducing ZFo and ZFi will become clearer below but we 
can anticipate that the convergence of integrals involving G '4 and ~,4 will 
be easier to understand in combination with the limit terms in (25.11c,d). 
Substituting for x(z) and y(z) in M (4), we find 
so'i 
^1 
cg 
= - 
u;u*' 
(D + id)/2 
F/2 
(K -ik)/2 
UoU" 
Uo'*'2 
(A + ia)/4 
(K + ik)/2 
C/4 
Uo,2 
(25.12) 
as in (24.33) or (24.34). 
The nine magnification-dependent quantities 
A, C, ...k can now be expressed in terms of nine integrals, six for the 
isotropic aberration coefficients (il - is) and three for the anisotropic coef- 
ficients (i7 - i9), that are independent of the magnification: they are prop- 
erties of the lens, determined by its geometry and excitation but unaffected 
by the working conditions. The dependence of the coefficients A, C, ...k on 
magnification is expressed by a series of polynomials in reciprocal magni- 
fication m in which simple multiples of the integrals ij(j = 1 - 9) are the 
coefficients of the various powers of m. 
Spherical aberration 
C -- C4m 4 -}" C3m 3 "}- C2rrt 2 -}- Clrrt+ Co 
(25. 3) 

25. ASYMPTOTIC ABERRATION COEFFICIENTS 
4 
1 
= Zlfo 
C3 = --4i2f 4 -- 2r2 fo 
c~ = 2(i~ + i,)f 4 
C1 = -4i5f 4 - l fo 
Co = i~f 4 
Coma 
K = Kam 3 Jr K2 m2 + Klm q- Ko 
K3 = -ilf3o 
1(2 -- 3i2f2 "4- 2r 2 
K1 = --(i3 + i4)f3o 
Ko = i~/~o 
k = k2m 2 4- klm + ko 
k2 = zTf~ 
kl = -isf 2 
ko 
• 
2 
-- z9f ~ 
Astigmatism and field curvature 
Distortion 
A = A2m 2 + Aim + Ao 
F = r2m 2 + El m + Fo 
1 
A2 = ~F2 = ill 2 
1 
r 2 
Ao 
• 
2 
2 
= z3f,~ 
Fo -- i4f~ 
a -- alm+ao 
al = -2i7fo } 
ao = is ]o 
D = D1 m + Do 
397 
(25.14) 
(25.~5) 
(25.16) 
(25.~7) 
(25.18) 
(25.19) 
(25.20) 
(25.21) 
(25.22) 
(25.23) 
(25.24) 

398 
25. ASYMPTOTIC 
ABERRATION 
COEFFICIENTS 
D1 = --ilfo 
) 
1 
Do = i2fo + "~i 
d = do = i7 
(24.25) 
(25.26) 
where 
More compactly 
(25.27) 
C 
=Q 
m 4 
m 3 
m 2 
m 
1 
a 
=q 
m 
d 
1 
(25.28) 
with 
Q ._. 
f 
ilf4o 
• 
4 
1 
2 
1 
--4Z2fo 4 -- ]r fo 
2(i3 4-i4)f 4 
--4isf 4 -- ~fo 
i6f'o 
--ilf3o 
• 
3 
it2 
3~2f~ + 
-(i~ + i4)f2 
ill 2 
--2i2f2o -- r/2 f o 
2ilf2o 
--4i2f2o --fifo 
i4/2o 
0 
-lifo 
i2f o + 1/2f? 
(25.29) 
and 
i7 fo 
--i8f20 
" 2 ) 
z9f~ 
q = 
0 
-2i7fo 
i8fo 
0 
0 
i7 
(25.30) 
The integrals i l -i9 can as usual be cast into a host of different forms, 
which can be established without difficulty by the methods explained in 
Section 24.3. We list here the primitive form, on which no partial inte- 
gration has been performed, and two particularly simple forms, one for 
magnetic lenses (¢ = const) and the other for electrostatic lenses (B = 0). 

25. ASYMPTOTIC ABERRATION COEFFICIENTS 
399 
Another set of (nonrelativistic) integrals for electrostatic lenses, well suited 
for numerical work, is to be found in Kuyatt et al. (1974). 
oo 
1 [ 
G4 
G, 2 
G, 4 
il = -:'i- 
(L1 
4- 2L2G 2 
4- L3 
) dz 
Cg_~J 
@--const 
1 
+ 2#fo limcc(zfi- z) 
oo 
f 
AnG 4 dz 
) 
B=O 
(x) 
f 
AeG dz 
oo 
1 f 
G3-G + L2GG'(G-G)' + L3G'3-G ' } dz 
i2- ~ 
{L1 
Cg-.o 
¢=const 
oo / 
1 
Am G3-G dz - 8 f---- ~ 
-- 00 
) 
B--0 
c~ / 
1 
AeG3Gdz 
Sfof2 
-- 00 
oo 
~--const 
,, 
dz 
8f 2 
¢ 
oo / 
1/ 2 2 
^ 
dz 
A~ G2~2 
6f2 
¢ 
B=0 
^! / 7¢" 
A~G2G 2 
Cg 
~ 
dz 
24fo 2 
¢~ 
--O0 

400 
25. ASYMPTOTIC ABERRATION COEFFICIENTS 
~=const 
oo 
$4 ~" ~__f {2L1G2~2+ L2(G-G) '2 "~ 2L3G'2G'2 } dz 
1 } /~_~/ ~ ~2B 2 
dz 
+gE 
~ 
1 / r/2B2 
^ dz 
2 
AmG2G 2 + ~ 
--OO 
--OO 
OO 
.~ 2 
AeG2G2 + ~ 
6-T dz 
B=0 
oo 
'5-- --~__,f {L1GG3 + L2(G-G)'-~' -.}- 53 G'-~'3 } dz 
oo 
~, 
f Am G-G 3 dz - 
1 
,=const 
8f 3 
oo 
f AeGG 3 dz- 
1 
B=0 
8fo 3 
oo 
1/ 
i6 = -=r 
(L~ ~-~ + 2L2G2G'2 + L3G'4) dz 
~b--const 
B=0 
1 
+ ~o 4 limoo(z- ZFo) 
oo 
f AjO" az 
oo 
f 
i, = / (PG 2 + QG '2) dz 
, 
f A.G 2 dz 
~--const 
--OO 

25. ASYMPTOTIC ABERRATION COEFFICIENTS 
401 
O0 
is = 2 f (PG-G + QG'-G') dz 
--00 
O0 
2 / A.G-G dz 
~=const 
--oo 
oo 
f 
0~,2 
io = 
(p~2 + 
) dz 
--OO 
oo 
, / A.G 2 dz 
~b=const 
-oo 
(25.31) 
il = i6 
i2 = i5 
i7 = i9 
(25.33) 
The asymptotic Petzval coefficient is given by F- 
2A, which is simply 
Fo - 2Ao (25.21) or ]~(i, - 2i3). Thus 
F-2A= j(¢~) 
½7+''+4''B28¢ 
--00 
dz 
i 
r/2B 
) 
,, 
e=~o.,t 
2¢ dz 
(25.34) 
a=0 
8¢ 
--OO 
In these integrals , the functions L1, L2, L3, P and Q are given by (24.3) 
and Am, A, and A. by 
1 
5~/2B '2 
~?2BB" 
Am "= ~--~( 4r/4B4 + 
~
)
 
¢,2 
¢,¢,,, 
~92~ 
¢~ 
¢~ 
(25.32) 
.r¢,2¢,, 
¢,4 
-6(5 + 17~$) $~ 
+ (22~* + 7~ ~ + ~)SW} 
r/B" 
2y3B 3 
Ao:=~(~-T+ ~ ) 
(For Am, see Jandeleit and Lenz (1959) and for A~, see Hawkes (19855).) 
For symmetric lenses (or lens combinations), G(z) - G(z) if the origin 
is set in the symmetry plane, and hence 

402 
25. ASYMPTOTIC ABERRATION COEFFICIENTS 
Expressions (25.13-25.28) for the aberration coefficients as polynomi- 
als in reciprocal magnification m are convenient in that any symmetries in 
the lens are immediately reflected in the coefficients. For design purposes, 
it may be convenient to replace m by the object (or image) position, which 
is easily done with the aid of (16.25). Again, we might wish to know the 
magnitudes of the coefficients for a specific value of the magnification (or 
object position), given those for some other value. The appropriate for- 
mulae have been derived from first principles by Ade (1973, 1982). They 
can also be read off from the polynomial expressions (25.28), see Hawkes 
(1984a). Thus suppose that C, K, A, F and D are known for some inverse 
magnification m and that the latter is altered to m + #, so that for the 
spherical aberration, for example, 
4 
C(m + #) = E Cj(m + #)J 
j=0 
,, 
and likewise for the other coefficients. Clearly, 
4 
C(m + I.t) = E CJ "#j 
(25.35) 
j=0 
where 
But 
c'4 = c4 
C~ = 4C4m + C3 
C~ = 6C4m 2 + 3C3m + C2 
C~ = 4C4m 3 + 3C3m 2 + 2C2m + C1 
C; =C(m) 
(25.36) 
1 2 
4C m + 
= 4i 
L'm- 4i2L' - 
fo 
1 2 
= 4fo4(i2 -ilm)- 
-~r fo 
(25.37) 
1 
lr2 
- 
/o 
The remaining coefficients C~ and their counterparts for all the other 
aberrations can likewise be expressed in terms of the known coefficients 
A(m)...k(rn) plus one extra quantity, il, with the following results. Re- 
calling that the change in inverse magnification # corresponds to a shift 

25. ASYMPTOTIC ABERRATION COEFFICIENTS 
403 
Azo = --fop in object position with the sign convention employed by Ade 
(1982), these expressions are identical with those derived by him. 
K(m + #) 
p3 
A(m + #) 
= Q. p2 
F(m + p) 
D(m + p) 
1 
(25.38a) 
a(m + p) 
= q. 
d(m + p) 
1 
where the elements of Q~ are as follows: 
: 
fo i~l 
, 
Q.12 = 
Q~11 
4. 
_4faoD 
3r2fo/2 
Q~,13 = 2f2o(A + F)+ 3r2 fom/2 
, 
Q#14 = -4foK + fo(r2rn 2 - 1)/2 
Q.15 = C 
, 
Q.22 : -f3i1 
, 
Q.23 = 3f~oD- r2 
Q#24 = -fo(A + F) - r2m/2 
, 
Q#25 - K 
, 
Q#33 = foZi2. 
Q~34 = -2roD + r2/2fo 
, 
QI,35 - A 
, 
Q~43 : 2f2oi1 
Q.44 = -4roD + r2/fo 
, 
Q.45 = F 
, 
Q.54 : -foil 
, 
Q#21 : Q~31 = Q#32 = Q~41 : Q.42 
= Q.51 = Q.52 = Q.53 = 0 
(25.3Sb) 
Q,55 = 
D 
(25.39a) 
and 
f2d -fo. k) 
q.= 
0 
-2rod 
a 
(25.39b) 
0 
0 
d 
One other situation remains to be examined: hitherto the aberrations 
have been expressed in terms of position and gradient in the asymptotic 
object plane but, in practice, the effect of the real aperture will often be im- 
portant; in projectors, for example, where the dominant geometrical aber- 
ration is distortion, the sign of the coefficient can be changed by varying the 
aperture position, since the aperture selects different pencils of rays from 
the beam at the asymptotic object as its position is altered. We therefore 
consider the situation illustrated in Fig. 25.2, which shows that we shall 
be concerned with the aberrations of the asymptotic image of an asymp- 
totic object with boundary conditions requiring aberrations of position to 
* The following account is confined to magnetic lenses; it can be extended straightfor- 
wardly to electrostatic lenses if needed. 

404 
25. ASYMPTOTIC 
ABERRATION COEFFICIENTS 
virtual entrance apentur'e 
object pupil 
plane 
3(z) 
, 
i 
i 
I 
I 
~o Cz/ 
' 
I 
771 
' I 
I 
T(z) 
I 
t 
Zo 
Zao 
exit 
image 
pupil 
pane 
I~Xx 
T'" " 
I ~ 
~
1
 
--~ 
i 
~" 
Po 
,~'--.~".... . 
t 
-"-.2~ 
, 
;-'.%. 
Za 
Zai 
Zi 
Fig. 25.2" The rays S(z) and T(z) have asymptotes ao(z) and to(z) in object space 
and a~(~) and r(z~) in image space. The object-image magnification M and the pupil 
magnification N are defined in terms of these asymptotes. 
vanish in two planes (cf. 24.14, 24.18): the asymptotic aberrations must 
vanish in the asymptotic object plane and the real aberrations in the real 
aperture plane. We shall, however, find it useful to introduce the entrance 
and exit pupil8 associated with the real aperture; these are the asymptotic 
images of the latter formed by the part of the lens field before the real 
aperture (entrance pupil) and the part beyond it (exit pupil). This in turn 
introduces the important notion of pupil magnification, the magnification 
between these two pupil planes, which are (asymptotically) conjugate. 
Figure 25.2 shows two paraxial solutions, analogous to s(z) and t(z), 
which we here denote S(z) and T(z); these satisfy the conditions 
lim S(z) =: ao(z) = a'o(z - Zao) 
Z--~--O0 
'(z- 
lim S(z) =: hi(z) = a i 
z--+oo 
lim T(z) =" to(Z)= r'o(Z- Zo) 
Z'-~--O0 
limoo T(z) =" n(z)= r~(z - z,) 
(25.40a) 
(25.40b) 
(25.40c) 
(25.40d) 
and 
S(za) = 0 
(25.41) 
= 1 
Clearly, z = Zao and z = zai are the entrance and exit pupil planes, respec- 
tively. From the Wronskian, we see that 
To t 
I 
=-SaTa 
MrS= 
' 
--- 
--UoTa 
o 
(25.42) 

25. ASYMPTOTIC 
ABERRATION 
COEFFICIENTS 
405 
It is convenient to denote the pupil magnification by N, and we write 
g = NoNi 
(25.43) 
where No is the magnification between the entrance pupil and the real 
aperture and Ni that between the latter and the exit pupil: 
' 
1 
S~ _ 
1 
a i - 
(25.44) 
' 
No 
S'~ 
Ni 
(7" o 
We have not yet fully specified T(z), for we see from (25.40c) that the 
object asymptote To intersects the entrance pupil at ro(Z~o) = Co(Zao - Zo) 
so that from (25.40-25.42) 
rao =-1"°- 
S'~Ta 
(25.45) 
t 
I 
(7 o 
(7" o 
or 
By choosing 
so that 
T~ 
%0 
= 
- -  
(25.46) 
No 
T(z~) = No 
(25.47) 
%,0 = 1 
(25.48) 
we express the aberrations in terms of asymptotic object coordinates (in 
z = Zo) and entrance pupil coordinates (in z = Zao). (If we had set T(za) = 
1, vao = 1~No, the aberrations would have been expressed in terms not of 
entrance pupil coordinates but of real aperture coordinates, which is not so 
convenient; the important point is that the aberrations do actually vanish 
in z = za.) These relations and some simple consequences of them are 
listed in Table 25.1 
The general paraxial solution is now 
x(z)=xoS(Z)+xaT(z) 
y(z) = yoS(z) + y.T(z) 
(25.49) 
in which x~, y~ are position coordinates in the entrance pupil plane. (They 
should strictly speaking be denoted X~o, y~o, but we drop the second suffix 
since no confusion should arise.) With the boundary conditions already 
explained, the asymptotic aberrations at the image plane zi are given by 
Axi 
-'- 
Ay i = 
v~ OX a 
1 os , 
(25.50) 
1"o Oya 

406 
25. ASYMPTOTIC ABERRATION COEFFICIENTS 
Table 25.1 Relations between the asymptotes to S(z) and T(z) and various paraxial 
properties: pupil magnification, N; magnification, M; focal length, f; and others. 
oo(z) - 
~o(Z - Zo) -4- 1 = ~(z 
- Zao) 
ai(z) = ~(z - zi) + M = ~(z 
- zai) 
~o(~) = ¢o(~ - ~o) = ¢o(, - ~.o) + 1 
n(,) = ~I(~ - ~,) = ~(z - z.,) + N 
do = 
1 
_ 
1 
di 
m 
d o 
Zo - 
zao 
f(m- 
ma) 
zi - 
zai 
N 
~o= 
1 
1 
eo 
N 
zao 
Zo =--f(m ma) 
~=--= 
- 
- 
M 
zai - 
zi 
'To 
S" 
r,=No=-~a 
Ni= _-'/" 
o i 
f = fm 
zi - ZF, - 
- f M 
zo - ZFo = --~ 
N=NoNi 
and the various coefficients can hence be written down immediately. Our 
purpose here is to enquire how they vary when the (real) aperture and 
(asymptotic) object are shifted, and how this variation compares with the 
simple polynomial forms obtained earlier. 
Let us suppose that the image magnification is initially M1 and the 
pupil magnification N1; we add the label 1 to the other relevant quantities, 
S1, T1 in particular. After moving object and aperture, the magnifications 
become M2 and N2 and the new fundamental paraxial solutions, 5'2 and 
T2, are linear combinations of their predecessors, 
$2 = )~,S1 + ArT1 
T2 = p,S, +/~,T, 
(25.51) 
By considering the relations between the asymptotes to these rays and the 
object and aperture positions (Table 25.1), it is easily seen that 
~s "-- z°l 
-- Za°2 ~ ~ 
ml 
-- n2 
Zo2 -- Zao 2 
m2 
-- n 2 
/~t -- 
Zaol 
-- Zao2 
= 
nl 
-- n2 
Zo2-- Zao 2 
m2 
-- n 2 
Zo2 -- Zol 
17/22 -- m 1 
P 
$ 
"-" 
Zo2 -- Zao2 
m2 
-- n2 
Zo2 -- Zaol 
m2 
-- nl 
Pt -" 
= 
Zo2 -- Zao 2 
m2 
-- Tt 2 
(25.52) 
The individual aberration coefficients can be expressed in terms of the 

25. ASYMPTOTIC ABERRATION COEFFICIENTS 
407 
integrals 
CO 
1 / hm(z)SiT i dz 
z,i := ~ 
--00 
O0 
Zoo := ~ 
B~(z),~z 
--OO 
in which (25.32) 
;74 B4 
Am(z) := 12q; 2 
and 
Oo 
Ji.i "= / Aa(z)S iTi dz 
--00 
i+j=4, 
i,j =0-4 
5 ;72 B,2 
;72 BB" 
48 
~ 
48¢ 
i+j=2 
i,j =0-2 
in which (25.32) 
1 ;TB" 
A~(z) .= ~( ~---F + 
For m = m l and n = n l, we have 
2;73B 3 
(25.53) 
(25.54) 
(25.55) 
(25.56) 
(25.5s) 
c, : 1o(1 ) 
K, =/1(31 ) -(1 - m~)/8f2(mx - n,) 2 
k, = Jo2 
, 
/ 
.41 =/2(1 )- grloloo + (1 - mini) 
4f2(m1 - nl) 2 
al = 2Jll 
~ 
/ 
)~ 
Fi = 2I~ ) + -grloIoo + (1 - mini)/ 2ff(mi - n~ 
D1 = I~l ) - 3(1 - n2)/8f2(m1 - nl) 2 
dl = 
J2o 
/ 
(25.57) 
For any other pair of reciprocal magnifications m2, n2, similar expressions 
relate C2,/(2, ...d2 to I~ (2) and J[}). Using (25.51), it is easy to express the 
integrals Ii? ) and J~})in terms of I~ (1) and J}))and hence C2...d2 in terms 
of C1, ...dl. The results are as follows. 

408 
25. ASYMPTOTIC 
ABERRATION 
COEFFICIENTS 
where 
and 
I = 
Wtl -- R1 I* 
?t~ 2 -- ?t 2 
6~.~, 
, 
Ih = 4~.~, ~ 
, 
I~'~ = ~,~ 
i;~=~ 
~. 
, 
x~'~=4~.~,, 
x~'~= 
~ 
* 
As[At +/~s 
~s~t 
-- Aop, 
, 
i~ 1 
2 2 
/'~'2 = 2(A2s#s~tt + As'~t#2s) 
, 
173"3 = 
2 2 
2A2t + 4AsAt 
I~i = AsP3s 
, 
I~2 
3As 
2 
3 
* 
= 
#s#, + At#, 
, 
I~3 = 3(Atp2sPt + Aspsp 2) 
Ih = ~.d + 3~,..d, 
, 
I;*~ = ~,d, 
(2~.~9) 
J = 
Xs#s 
Xs~Zt -1- At#s 
Xt#t 
(25.60) 
This question, the variation of the aberrations when object and aper- 
ture (or stop) are shifted, has a long history in light optics, and we draw 
attention to the work that is closest to the contents of this chapter. The 
earliest thorough exploration, using the eikonal or characteristic function, 
is that of T. Smith (1921/22) but owing to the extreme generality of the re- 
sults, and to the fact that the latter were not expressed in terms of familiar 
quantities, his findings were frequently referred to but little used. The prob- 
lem was solved in language of direct use to the lens designer by a series of 
members of van Heel's laboratory in Delft (Korringa, 1942; Stephan, 1947; 
Brouwer, 1957). The full matrix treatment developed by Brouwer renders 
his work easy to apply and we can derive (25.59-25.60) straightforwardly 
by his methods. This requires the notion of aberration matrices, however, 
and we therefore postpone further discussion to Chapter 27, where these 
are introduced. For a very scholarly account of the various formulations of 
aberration theory with many more references, see Focke (1965) and for a 
recent development, Velzel (1987) and Velzel and de Meijere (1988). 

26 
Chromatic Aberrations 
26.1 Real chromatic aberrations 
Electron guns do not furnish rigorously monoenergetic beams of particles 
and the voltage and current supplies needed to excite electron lenses are 
never perfectly stable. The spread of energies in a beam is usually further 
broadened by its passage through a specimen, for inelastically scattered 
electrons will emerge with diminished energy. The initial energy spread is 
typically a few electronvolts for thermionic emitters; power supplies can be 
stabilized to within a few parts in a million (better than 1 V at 100 kV) 
and although the specimen energy losses may reach tens or hundreds of 
electronvolts for moderately thick specimens, the mean loss is often much 
smaller. 
In a column of lenses, the image plane conjugate to some fixed plane 
will therefore inevitably fluctuate, retreating towards the fixed plane if the 
electron energy falls or the lens strength increases and vice versa. Since 
fluctuations of lens strength may be rapid and the energy of the beam will 
be spread over a finite if narrow range, these phenomena must be expected 
to blur the image. The resulting effects are known as the chromatic aber- 
rations and are characterized by a set of chromatic aberration coe~cients. 
The latter are conveniently calculated by perturbation theory, taking M (2) 
as the unperturbed refractive index and writing 
M(P) 
__ 0M (2) 
0M (2) 
0---¢ -zx¢ + 
OB ZXB 
(26.1) 
From (15.24), we see that 
OM (2) 
o¢ 
OM (2) 
OB 
¢" 
7__(X,2 
y,2) 
16~] (X2 + y2)+ 4¢½' 
+ 
= -1,7(XY'- X'Y) 
(26.2) 

410 
26. CHROMATIC ABERRATIONS 
so that introducing rotating coordinates (15.9), 
M(C) := M(P) = Al(x 2 4- y2) 4- A2(x,2 4- y,2) 4- A3(xy'- x'y) 
¢" + "77/2 B2 A¢ - r/2 B 
A2 = 4-~~ A¢ 
1 
7zx¢ _ 2_~) 
(26.3) 
With x = XoS + xat, y = yos + yat, we find 
M(C) = al(x 2 + y2) + a2(x 2 + y2) + a3(XoXa + YoYa) 
+ a4(XoYa -- XaYo) 
al = A1 s2 "4-A2.s ,2 
a2 = Alt 2 4- A2t '2 
a3 = 2(Alst 4- A2stt I) 
a4 = A3(st' - s't) 
(26.4) 
Using (24.29), we obtain the following expressions in a general plane: 
'(/ 
/ 
/) 
x (c) = XoS + xat+~ 
2xo 
al dz + Xa 
a3 dz + Ya 
a4 dz 
Za 
Za 
Za 
/ 
/) 
Ws 
2Xa 
a2 dz -4- xo 
a3 dz 
- 
yo 
a4 dz 
ZO 
Zo 
Zo 
'(,/ 
/ 
/) 
y(c) = yoS + y.t+~ 
2 o 
al dz + y. 
a3 dz - xa 
a4 dz 
Za 
Za 
Za 
/ 
f) 
Ws 
2ya 
a2 dz + Yo 
a3 dz + Xo 
a4 dz 
Zo 
Zo 
Zo 
(26.5) 

26.1 REAL CHROMATIC ABERRATIONS 
411 
and in the image plane 
_( z 
i 
z/ 
zi ) 
Ax(~ ). 
x. - Mxo _ 
1 
= 
- 
147. 2x~ 
a2dz+xo 
a3dz-yo 
a4dz 
Zo 
Zo 
Zo 
zi 
zi 
zi 
-(~)-Myo_ 
1 ( 
__ 
/ 
/ 
) 
Ay(,) ._ vi 
- 
- 
W. 
2ya 
a2 dz + Yo 
a3 dz + X o 
a4 dz 
Zo 
Zo 
Zo 
zi 
zi 
zi 
1 ( /  
/ 
/
)
 
Au (*) := Ax(c) + lay (~) = -W, 
2ua 
a2 dz + Uo 
aa dz + iUo 
a4 dz 
Zo 
Zo 
Z o 
(26.6) 
The integrals may be rewritten in the convenient forms 
zi 
zi 
/a2dz=/A¢{ 
7~2B2 7¢'2(3+2e¢)}t2dz 
8¢~ + 
16¢~ 
Zo 
Zo 
Zi 
- f AB ~772 B t2 dz 
Zo 
zi 
zi 
/ 
J{~2B2 ¢"(3 + 2e¢) } 
aa dz = 
7A¢ 
44} + 
8~} 
st dz 
Zo 
Zo 
Zi 
- 
AB~-~st dz + A¢ 
,,~ 
=Z 
,o 
\ 
¢20 
zi 
zi 
/a4dz-- 
~{(.st'-Jt)/ 
~B 
(~n¢--2-~)dz 
Zo 
Z o 
(26.7) 
In practice, we take A¢ to be a variation of the accelerating voltage ¢0, and 
AB a variation of the maximum magnetic field B0. Thus if B(z) = Bob(z), 
AB = b(z)ABo = BABo/Bo, provided that b(z) does not alter; this is 
true if the metal of the lens is not saturated. We can then apply Amp~re's 
circuital theorem (Fig. 36.2), so that for a lens of traditional design, with 
a winding of N turns carrying a current I, 
0o 
oo 
-- OO 
-- OO 
(e6.s) 

412 
26. CHROMATIC ABERRATIONS 
and so 
ABo 
A(NI) 
Bo 
NI 
In the magnetic case (¢ - ¢o), we write 
(7A¢o 
a~(~) • = -(c:~. + c~o - C;yo) \ ~o 
ay(o~ . = -(c:y. + C~yo + C;~o) (~ -~° 
\ ¢o 
= -{C:u. + (Cb + iC;)uo}- (7A¢o 
Au (c) 
\ ¢o 
~Bo) 
~ - 2  Bo 
ABo ) 
~ - 2  Bo 
ABo ) 
~ - 2  
Bo 
(26.9) 
(2s.~0) 
where 
Zi 
1 / rl 2 B2t 2 
* -- 
,dz 
Cc 
~o 
4¢0 
Z° 
zi 
1 / ,7 ~ B 2st dz 
C~-- ~o 
4¢o 
go 
zl 
Zo 4¢J 
In the electrostatic case, AB =__ 0 and we write 
(A¢o 
~(o) = ~=(~) + i~y(~) = -(c:~. + C;~o) \-~o] 
(26.~2) 
where 
} 
~O 
7¢'2( 3 + 2e~)~2 
go 
~o 
~,'~(3 + 2~) 
~_, _ ~o) 
Z° 
(26.~3) 
On measuring the variations in accelerating voltage or energy spread in 
terms not of ¢0 but of ¢0 in the magnetic case, so that A¢0 = 7A¢0, and 
I 
I 
replacing x., y. by x o, yo, we find the following expressions, which are the 
most common form of the chromatic aberration coefficients: 
~.(°) = -{co.'o + (cv + ~co).o} ~(~°~o -2 ~BOBo ) 
(26.~4) 

26.1 REAL CHROMATIC ABERRATIONS 
413 
with 
zi 
f r12B2 h 2 dz 
Cc = 
4q~o 
Zo 
Zi 
f ~7 2 B 2 
CD = 
4¢0 gh dz 
(26.15) 
Za 
Zi 
Zo 4¢g 
It is not convenient to use A¢0/¢ 0 in the electrostatic case, and the coun- 
terparts of (26.14-26.15) are then 
/xu (~) = -(C~u'o + CDuo)~ 
A¢0 
~0 
(26.]6) 
with 
~/~¢'=(3 + 2~$)h 2 
Za 
co=$$ 
T($, 
) 
Za 
The chromatic aberrations are therefore of two kinds: an "aperture" aber- 
ration, characterized by Co, which is invariably known simply as the chro- 
matic aberration coe.O~cient, and a distortion, characterized by CD + iCa. 
The term in Cc, like the spherical aberration, creates an aberration disc, 
the radius of which in the image plane is the same for all points in the 
object plane. This radius, MAr (c) , is given by 
MAr (c) = M(Ax(C) 2 + Ay(C)2) 1/2 
or referred back to object space, 
or 
t2 
t2 1/2 
Ar (c) = Cc(xo + Yo ) 
Ac = CcOoAc 
(26.~s) 
where 8o := (x7 + y~2)1/2, ra := (x2= + y2)1/2 and A c is the appropriate 
term in A¢0 or A¢0 and AB0. (Note that the radius of the aberration disc 

414 
26. CHROMATIC ABERRATIONS 
is the same for a variation of the form ¢0 --* ¢0 + A¢0, and likewise for 
B0, as it is for a variation ¢0 --* ¢0 - A¢0. Some thought must therefore 
be given to the meaning of A¢0 when calculating the size of the disc. Cf. 
Orloff, 1983b.) 
From (26.15, 26.17), we see that, again like Cs, Cc is always positive 
with the sign convention we have adopted (minus signs have been inserted 
in (26.14, 26.16) purely for convenience, since A¢0 and AB0 are usually 
oscillatory fluctuations about ¢0 and B0 rather than steady drifts, though 
the latter are not of course excluded if present). This result too was first 
obtained by Scherzer (1936b). Methods of correcting or eliminating this 
chromatic aberration will be discussed at the same time as those for com- 
bating spherical aberration. 
The chromatic aberration C¢ is of most concern in objective lenses, 
where the angles are comparatively large, while the distortions character- 
ized by C D and Co mainly affect projectors, where the angles are small 
but th.e rays are farther from the axis. The isotropic chromatic distortion 
coefficient, CD, is commonly known as the chromatic aberration of magni- 
fication, since we may write 
_2-0) 
 20.10  
ui = M t, l - CD k, ¢o 
Bo 
in the magnetic case, and similarly for electrostatic lenses. 
The anisotropic chromatic distortion coe~cient, Co, is often known 
as the chromatic aberration of rotation, since it causes a small change in 
the image rotation in magnetic lenses. We note that Co is equal to half the 
image rotation (15.27). 
A slightly different way of considering the chromatic aberrations yields 
forms for the coefficients that can save a lot of calculation. We now denote 
the paraxial solution corresponding to accelerating voltage ¢0 by w(z, ¢0), 
so that 
w(z, ¢o) = wog(z, ¢o) + w'oh(z, ¢0) 
(26.20) 
In the image plane zi for ¢0, we have h(zi, ¢o)= 0. Hence 
+ 
= 
+ 
+ 
Ogi A¢o) + A¢OWo Ohi 
wo(M + -~o 
0¢o 
In the fixed coordinate system, this is equivalent to 
u(zi, ¢o 4- A¢o) -- w(zi, ¢o 4- A¢0)exp 2(¢0 ~--A¢o)½ 
B dz 
Ogi 
MiOi 
, Ohi 
=exp(iOi)[Mwo4-A¢o{Wo(-~- ° 
~-~o ) 4- Wo~--o )] 

26.2 ASYMPTOTIC 
CHROMATIC ABERRATIONS 
415 
which must have the same form as 
u(zi, ¢o + A¢o) = exp(i0i) Mwo - MAC°0 
' 
] 
¢--=--{C¢wo + (CD + iCo)wo} 
so that 
¢o Ohi 
Cc = 
M 0¢o 
¢o Ogi 
(26.21) 
CD= 
M 0¢o 
1 
Co = -~Oi 
This form is most useful when the lens is operating at high magnification, 
Zo ~ ZFo. Since in general 
xi = Mx -MC¢x' o A~° 
, Ohi A¢o 
o 
= 
: 
Mxo 
+ CoX ° 
a ray intersecting the axis at z = zi leaves the object plane at X o = 
(-1/M)x~oA¢o(Ohi/O¢o). But Xo = --x'A¢o(OZFo/O¢o) so that 
OZFo 
10hi 
0¢o 
M 0(5o 
and hence 
Likewise, 
Cc - -~o OzF° 
0¢0 
(26.22a) 
¢o Ofo 
CD = fo 0¢o 
(26.22b) 
These expressions are particularly convenient when field models that yield 
explicit formulae for the cardinal elements are being studied. 
26.2 Asymptotic chromatic aberrations 
These aberration coefficients can be written down immediately as there is 
no term analogous to L3(x '2 + y,2)2 (24.2) needing special attention. We 
find 
Au (~) = -{Ccu'o + (CD + iCo)uo}( TA¢° 
2 ABo 
Bo ) 
(26.23a) 
or 

416 
26. CHROMATIC ABERRATIONS 
A.(c) = -(C#o + Co.o)~ 
a¢0 
~0 
(24.23b) 
for magnetic and electrostatic lenses, respectively, where 
OO 
Cc = 
-----------=---- dz 
^½ 
7(3 + 2e¢)¢'2H 2 
-oo 
4¢0 
or Ce-¢o 
8¢] 
oo 
oo 
/ ~2~c~ 
^:/~(~ + ~)~,2~. 
CD= 
4¢0 
dz 
or CD=¢~) 
S¢] 
DO0 
oo 
.,1 
co= 
~ 
dz 
+_4_ ( ~ 
-oo 4¢J 
dz 
dz 
~o ) 
(26.24) 
These can of course be cast into polynomial form with the aid of (25.9) 
(Shimoyama, 1982; Hawkes, 1980a): 
(co) ( c2 2 Cl 
)(m2) 
CD 
-" 
0 
-foe2 
loCi + Ce 
m 
Co 
0 
0 
Co 
1 
(26.25) 
in which for magnetic lenses, 
oo 
~72 / B 2 G 2 dz 
c2=~o 
Co - 44o_ 
B2~ ~ ~z 
Ce --0 
~2/ 
C1 = E 
B2G-G dz 
oo 
7"/2 / B2 
Co = -~o 
dz 
(26.26) 

26.2 ASYMPTOTIC CHROMATIC ABERRATIONS 
417 
and for electrostatic lenses 
oo 
^~ f 7(3 + 2~)¢'~a ~ 
c2 = ¢3 
8~ 
--00 
dz 
oo 
8,~ 
~00 
dz 
oo 
Co - ~o f 7(3 + 2~$)¢'~V ~ ~; 
^! 
Ce 
~( "/i 
70 
(26.27) 

27 
Aberration Matrices and the Aberrations 
of Lens Combinations 
We have seen in Section 16.2 that the cardinal elements of doublets and 
hence multiplets can be obtained straightforwardly by multiplying the ap- 
propriate transfer matrices. A similar procedure can be devised to express 
the aberration coefficients of a doublet (or multiplet) in terms of those of 
the individual components. From this, the coefficients of the aberration 
polynomials of the multiplet can likewise be expressed in terms of those of 
the separate lenses. 
For this, we introduce column vectors in an arbitrary pair of conjugate 
planes; we write 
(Uo~ 
! 
tt o 
2 
IL or o 
t 
2 
ttor o 
uo Vo 
uo= 
u,oV ° 
(27.1) 
uoO~o 
i 
2 
UoO o 
UoVo 
\ u~ovo j 
in the object plane, with a similar expression for Urn, the corresponding 
vector in the image plane, magnification M. Then we may write 
um = Muo 
(27.2) 
where M is a 10 x 10 matrix, which divides naturally into four block ma- 
trices: 
M-( 
MIM3 M,M2) 
(27.3) 
Mz is the 2 x 2 paraxial matrix (16.20), 

27. ABERRATION 
MATRICES 
419 
in which we have introduced the convergence, c and the relative refractive 
index r (25.27): 
c'= 
fi 
v "= ~-/ = 
'~i 
(27.5) 
The matrix M2 
has two rows and eight columns, the upper row containing 
the coefficients describing the aberrations of position and the lower row 
those of gradient: 
M2 
-.-" ( Mmllm21 
and 
Mm12 
Mm13 
Mm14 
Mrn15 
Mrn16 
Mm17 
m22 
m23 
m24 
m25 
m26 
m27 
Minis I 
m28 
(27.6) 
roll 
-- D + id 
m15 = K + ik 
m12 = F- 
A 
m16 - C 
(27.7) 
ml3=2A+ia 
mlT-a 
m14 -- 2K 
m18 = 2k 
m21 = c(D + id) - rilm 
m22 = c(F- A) -(D -id)rm + 1-c2rm 
2 
m23 -- c(2A + ia) - 2Drm + c2rrn 
m24 --= 2cK - (2A - ia)rm + cr2m 2 
(27.8) 
1 
,~ 
= ~(K + ik) - (F- A)rm + ~,~ 
1 
.~ 
- ~c- (g -ik)~m - ~m(~ - ~m ~) 
m27 = ca- 2drm 
m28 = 2ck - arm 
in which il is defined in (25.31). The matrix Ma is null and M4, generated 
by M1, expresses the rules needed for adding the aberration coefficients. 
It is easily seen that 
M4= 
( M 3 
0 
0 
0 
0 
0 
cM 2 
rM 
0 
0 
0 
0 
0 
cM 2 
0 
rM 
0 
0 
0 
0 
c2M 
rc 
rc 
r2m 
0 
0 
0 
c2M 
0 
2rc 
0 
r2m 
0 
0 
c 3 
rc2m 
2rc2m 
2r2cm 2 
r2cm 2 
r3m 3 
0 
0 
0 
0 
0 
0 
0 
rM 
0 
0 
0 
0 
0 
0 
rc 
0 
0 
0 
0 
0 
0 
0 
r2Trt 
(27.9) 

420 
27. ABERRATION MATRICES 
Suppose now that a second lens (or lens system) is characterized by a 
I 
= M~um 
similar 10 × 10 matrix, M', and that just as Um = Muo, so u m 
or 
it is convenient to write 
' 
MfMuo 
(27.10) 
U m -- 
P'= MfM 
P "= M'M 
p := p-1 
(27.11) 
and to write up instead of ' 
Urn, SO that (27.10) becomes 
up = PUo 
(27.12) 
Clearly P must have the same block structure as M and M' and indeed 
P1 is just the paraxial matrix of the combination, which we have already 
met in Chapter 16 (16.29-16.34): 
PI_M~IM1 : (P 
0 )( 
P 
0 ) 
(27.13) 
cp 
rpp 
= 
Dpcc' 
rpp 
with Dp := Z'Fo -- ZFi and rp := rrl; P2 is of course null and P4 has the 
same structure as Ma (27.9). It is P2 that is of interest, for it gives us the 
recipe for adding aberrations, long known but intermittently rediscovered 
(e.g. Orloff, 1983a). Explicitly, we find 
I 
C2 
t 
t 
camm~6 
Pll = mll q- M2m~l -[- Mc(m~2 + mla) + 
(m14 q- mls ) + 
or 
D r, + idp = D + id + M2(D ' + id') + Mc(F' + A' + ia) 
+ ca(3K ' + ik') + caC ' 
, 
rcmm~a 
t 
P12 = m12 -t- rm12 -t- 
+ rc2mm16 
or 
Fp = F + rF' + 4rcmK' + 2rc2mC I 
p~ = m~ + ~mi~ + ~m(m'~, + 2mi~) + 2~2mmi~ 
or 
2Ap + i% = 2A + ia + r(2A' + ia')+ rcm(4k' + 2ik') 
-t- 2rc2mC ~ 
P14 
m14 • r2m 2 ~ 
: 
m14 W 2r2cmam16 
or 
or 
Kp = K -t- r2m2K ' + r 2cm3C ' 
P15 
m15 T r2m 2 ~ 
: 
/15 ~- r2cmaml6 

27. ABERRATION MATRICES 
421 
or 
or 
or 
Kp + ik r, = K + ik + r2m2(K ' + ik') + r2cm3C ' 
P16 = m16 + r3m 4m16' 
Cp - C -1- r3m4C t 
t 
rcmm~s 
P17 = m17 + rrn17 + 
ap = a + ra' + 2rcmk' 
P18 
m18 ~- r2m 2 t 
-- 
m18 
kp = k q- r2m 2 k' 
(27.14) 
(The last two relations, for p17 and pls, merely repeat information already 
provided by Pl 3 and P15.) 
Just as P must have the same overall structure as M, so must the 
elements of the aberration submatrix/'2 have the polynomial dependence 
on p that the elements of M2 have on m. A somewhat lengthy calculation 
reveals that the relation between the polynomial coefficients appearing in 
/'2 and those in M2 and/~2 is as follows, in which ij corresponds to M, 
ij' to M' and ij (p) to P (j = 1- 9), cf. (25.29-25.30). 
c,{ 
r, 
4 
.t 
3 
.t 
.t 
2 
i p)=il+- 
i'lDp-4z2D p-+2 
z 3+z 4 Dp 
r 
c 
(rt) 3 
.t (rt) 4 
1 
3( 
1)} 
-4i~Dp 
~ 
+z 6 ~ 
+ -~ Dp c '2 + D---~p 
i~p) = c' 
t 
3 
.t 
2 
.t 
+ --r 
i2Dp - 
i'3 + z4 Dp ~- + 3z~Dp 
-z6 ~7 
- ~D,~7 
2 
Dp 
il 
= 
~ 
i3Dp-2i2-- 
+ 
2 
.t 
.t 
+--r i~Dp-2Z 5Dp~+z 6 
2 
Dp 
i 1 
= 
~ 
i4Dp -4i2--c + 2 
(c)2} 
+2"V 

422 
27. ABERRATION MATRICES 
., 
2 _4i,5Dp 
+ 2i~ 
+ Dp 
-I---z4Dp 
y 
~7 
7 
r 
i(sP) 
p 
isDp - (i3 + i4) Dp 
C 
+ r i'~Dp -i~y 
- ~Dp[p) 
• 
4 
_ 4isDp + 2(/3 + i4)-~- 
iy)= 
p 
z6Dp 
-~ 
Dp 
il } 
+ ~ 
~ ~ 
~ 
\~'] 
• ~ 2 
"~ 
+ z9 
~ = i~ + ~ ,~D~ -,~t~ 
\~,] 
) ( 
c'( 
2i7 +isDp 
+ c i'sD p - 2i'9 
c' 
i7 
isDp q_ zoDp + z0 
Another problem that is more easily solved with the aid of these aber- 
ration matrices than in any other way is that of determining the aberration 
coefficients for some magnification M given those for another magnification 
M. We have provided a solution in Chapter 25 (25.58-25.60) but this re- 
quired a detailed knowledge of the aberration structure The same result 
can be obtained with somewhat less effort by strMghtforward matrix mul- 
tiplication, Suppose that the elements of M2 are known and that 
ui = Muo 
(27.16) 
If the object and image 
seek shift matrices S (°) 
to Uo, where 
are shifted so that the magnification is now M, we 
and S (i) that take us from ui to ui and from uo 
. _ . _ -  
ui = MUo 
(2v.~7) 
Explicitly, we seek matrices S (°) and S (i) such that 
ui =: S(i)ui 
and 
Uo =: S(°)~o 
(27.~s) 
and hence 
(27.19) 
~i = S(i)ui = S(OMu° = S(OMS(°)~° 

27. ABERRATION MATRICES 
423 
The unknown matrix M will then be obtained from (27.17) and (27.19): 
M= s(i)MS (°) 
(27.20) 
Since Uo and ~o are connected by the incident asymptote and ui and ~i by 
the emergent asymptote we have 
~i = =i + (~i - zi)=5 
~o =~o -(~o - ~o)~o 
t 
~/ --U i 
, 
(27.21) 
Uo=~-4o 
and so S (i) and S (°) will have block structures similar to that of M: 
,,o, (,1,o,,2,o,) 
( 
) 
-- 
S3 (o) 
S4 (o) 
S(i) 
S1 (i) 
$2(i) 
= 
S3(i) 
s4(i) 
(27.22) 
where now S~°) = S~°) = s~i) = s~i) = O, 
S~O): (10 
-~'o)1 
S~i)= (10 
~'i)l 
(27.23) 
and 
$4 (°) = 
1 -~;o -2¢o 
2~o ~ 
C 
-¢o ~ 0 
0 
0 
1 
0 
-2¢o 
0 
¢o 2 
0 
0 
0 
0 
1 
-¢o 
-¢o 
~;o ~ 
0 
0 
0 
0 
0 
1 
0 
-G 
0 
0 
0 
0 
0 
0 
1 
-G 
o 
o 
0 
0 
0 
0 
0 
1 
0 
0 
o 
o 
o 
o 
o 
o 
1 
-¢o 
0 
0 
0 
0 
0 
0 
0 
1 / 
(27.24) 
S(4 i) has the same appearance as S~ °) but (i replaces -fro everywhere. We 
have written 
~o := No - Zo 
~i := -~i- zi 
(27.25) 
We are interested only in M2 and from the common block structure of S (°), 
S (i) and M, it is obvious that 
-M2 - Sx (i) M2S(o) 
(27.26) 
Since S~ i) is only 2 x 2 and S([ ) is so sparse, the elements of M2 may be 
read off immediately and of course prove to be identical with those already 
listed (25.39). The expressions (25.59) for the change in aberrations when 

424 
27. ABERRATION MATRICES 
object and aperture are shifted can likewise be obtained with less effort by 
deriving the appropriate shift matrices, as discussed in detail by Brouwer 
(1957) (cf. Hawkes, 1985a). The appropriate starting point is the matrix 
' is replaced by 
equation ui = Muo analogous to (27.16) except that Uo 
u.o 
in uo and u i by uai in ui, where u.o is the complex cartesian coordinate 
in the entrance pupil and uai is that in the exit pupil, between which the 
magnification is N. The paraxial block matrix M1 therefore has the form 
MI = ( MO 
NO) 
(27.27) 
and M4 is diagonal. Ms is of course still null and M2 is the new aberration 
matrix. 
The upper row of M2 has the usual form but the lower row, 
representing the aberrations between the pupil planes, must be derived from 
expressions analogous to (25.7a) or from (25.57-25.60), setting m2 = nl 
and n2 = ml. The results are as follows, in which the new coefficient C* 
is equal to/04 (25.53): 
m21 -" C* 
n 2- 1 
m22 = -D +id+ 2f2(n--m) 2 
n2-1 
m2z = -2D + f2(n- 
m) 2 
1 - mn 
m24 = -2A + ia + f2(n 
-
-
 m) 2 
I --nm 
m25 = -(F- 
A) + 2f2(n - m)2 
m2-1 
m26 = -K + ik + 2f2( n _ m) 2 
m27 = -2d 
Try28 --" --a 
(27.28) 
The shift matrices may be established without difficulty and the shifted 
aberration coefficients are obtained as the elements of S~i)M2S~ °) (27.26). 
The results agree with those listed earlier. 

28 
The Aberrations of Mirrors and 
Cathode Lenses 
In this chapter, we extend the theories outlined in Chapter 18 beyond the 
paraxial domain, using the notation introduced there. There are again 
two possible representations of the theory, the parametric form and the 
cartesian form. We go into details only for the former. 
28.1 The parametric form of the theory 
We again set out from (3.12), as in Section 18.2. Introducing the fields 
corresponding to (28.10) into the nonrelativistic form of (3.12), and setting 
W(a) := X(a)+iY(a) 
, 
]W I =: r(a) 
(28.1) 
we obtain the coupled differential equations 
- 
T¢(4)(z) w(~) 
+ irlU-1/2{ (B'(Z)- ~B'") 2W(a) + (B- r2B '' 
-~ 
-¥ 
)w} + o(5) 
(2s.2~) 
1 { 
r2 ¢'"} ~ U-1/2B'(Z)~(W*IiV) + 0(4) 
(28.2b) 
2= 
¢'(z)- ~_ 
-~ 
where primes denote differentiation with respect to Z, while, as before, 
dots denote differentiation with respect to the curve parameter a. 
As in Section 18.2, we introduce the rotating frame. With (28.1) and 
the new complex variable w := x + iy, the transform (18.5) is now concisely 
rewritten as 
w(a)exp{iO(Z(a)) ! , r= IWl 
(28.3) 
W(a) 
"qv 
~" 
with (18.6) for ~. In the lowest order, the coupling terms cancel out and 
we find 
+ ~ 
¢"(z)+ 
(z) w(~) 
(28.4a) 
r2w{¢(4)+4712BB '' } 
it/r2 { 
B'"'w} 
= 32U 
16U 1/2 4B"tb + 

426 
28. THE ABERRATIONS OF MIRRORS 
• . 
1 
, 
r2{ 
}~IU-1/2B'(Z)~(w'do) 
(28.4b) 
Z=~-~¢(Z)-~ 
4"'+27/2BB ' 
- 
These differential equations are valid for all values of the total energy e¢~T. 
They do not contain any singularities and we can therefore carry out the 
necessary series expansions. 
In the parazial approzimation we recover (18.3c) and (18.8a,b), which 
are still valid for all total energies e¢~T . As in Section 18.2, we now specify 
a nominal value (I)T = 0 and a corresponding solution z(a) with ¢(0) = 0. 
The coordinate Z is not identical with z, and so we must introduce an axial 
deviation s(a): 
=: 
+ 
(28.5) 
This shift s(a) is usually very small but may be larger in the vicinity of the 
mirror surface. It is now sufficient to extend the series expansions only to 
the terms of lowest order and to insert the paraxial solutions wp(a), z(a) 
in the aberration terms. The paraxial equations are then 
iiJ,(a) + F(a)w,(a) - 0 
(28.6) 
with (18.11) and 
£(a) = ¢'(z)/2U 
(28.7) 
The total lateral coordinate w(a) is rewritten as 
= 
+ 
the last term denoting the lateral aberration. This quantity then satisfies 
an inhomogeneous linear differential equation 
iiJ.(a)-}- F(a)w.(a) = R(a) 
(28.8) 
with the transverse aberration term 
32U ¢(4) + 4rI2BB '' (z)- 16-~-/2 4B",/Jp + B'"~wp (") 
l {¢"'(z) + 2~2B(z)B'(z)}s(a)w,(a) 
4U 
(28.9) 
The final term arises from the series expansion of the coefficient on the 
left-hand side of (28.4a). In this term the contributions linear in s are 
sufficient, since swp is always very small. In (28.4b) the approximation 
¢'(Z) = ¢'(z) + s¢"(z) is sufficient. Considering (28.7), we find: 
+ 
(2s.10) 
/-u 

28.1 THE PARAMETRIC FORM OF THE THEORY 
427 
with the longitudinal aberration term 
2[ 
. 
S(a) = -8--urP ¢,,, + 272 BB' 
(z) 
71 U-1/2B,(z)~(w;(vp) 
(28.11) 
We now have to solve these differential equations with the appropriate 
initial conditions. The first step is the solution of the paraxial ray equations, 
as outlined in Section 18.2. This gives us the appropriate paraxial solutions 
z = z(~) ~d 
w~(~) - wog(~) + woh(~) 
, 
r~ - Iw~l 
(28.12) 
with 
and 
Wo = Xo + iyo - Xo + iYo 
(28.~3) 
(Vo = k,o + i~)o = J(o + iYo -b?B(zo) 
(Xo + iYo~ 
(28.13) 
2vrU \ 
] 
The solution (28.12) is now introduced into (28.11); from the constancy of 
the Wronskians we have 
D := ~(w*p(vp) = xp~lp - &pyp = xo~]o - koyo 
(28.14) 
which expresses the conservation of axial angular momentum, and this leads 
to some simplification. 
With (28.12) the function S(a) is now well-specified and we can solve 
(28.10), for instance by the method of variation of parameters. The ap- 
propriate initial value for ~(ao) = So is determined by the conservation of 
energy: 
fi[2o -]- Y: ~- Z2 -- U-l (~T-]- ~(ro) ) 
(28.15) 
2¢, 
Here the approximation (I)(ro) = ¢(Zo)- r o 
(zo)/4 is sufficient. With 
• 2 _ ¢(Zo)/U we find 
So = s(zo) = 0 and z o 
• 2 
U-I{(~T__ lr2¢tt(zo)}- (R2 .~_ ]~:) 
(28.16) 
2ko~o + s o = 
4 
Once (28.10) has been solved, the function R(a), given by (28.9), is well- 
defined and we can solve (28.8) again by the method of variation of param- 
eters; the appropriate initial conditions are here simply wa(ao) = 0 and 
~(~o) =0. 

428 
28. THE ABERRATIONS OF MIRRORS 
The solution of (28.8) yields the value of the quantity wa(ab), where 
at, is the value of the parameter a at the image (the subscript b is chosen to 
avoid confusion); wa(ab) does not, however, represent the required lateral 
aberration. There are additional terms arising from aberrations of the im- 
age rotation and from the longitudinal shift s. The angle of image rotation 
is given by integration of (18.6). Here a linearized series expansion 
,1 -ll2B(z + s) 
~( z) = ~(z + ~) = ~u 
rl u-a/2 (B(z) + sB'(z) + O(s~)) 
is necessary. After calculation of the functions z(a) and s(a) we can per- 
form the necessary integration whereupon we find that Ob = Op + AO, where 
~b 
rt -1/2 / 
o, = -~u 
B(z(,,)) ,t~ 
O" a 
(28.1w) 
is the paraxial contribution and 
ab 
A8 = -~U 
s(a)B'(z(a)) da- s(ab)B(zb)/k(ab) 
(28.17b) 
~o 
the aberration. The second term under the integral is the contribution 
from the longitudinal shift. 
The complex coordinate Wb in the image plane is now given by 
- ~(,,bla,,(~,,l/S(~,b)} 
where the last contribution is again the contribution from the longitudinal 
shift. With exp(iAa) ~ 1 + iA8 we obtain finally: 
AWb " = Wb - ei°pwp(ab) =: e i0' Awb 
= e ~°, [w, + i/XOwp - ~vps/~, 
(9.8.18) 
k 
(~,) 
where all products of small aberrations have been neglected. The expression 
in brackets, to be evaluated at a = ab, represents the lateral aberration 

28.2 SYSTEMS WITH CURVED CATHODES 
429 
r l ~ s o = ro2/(2R) 
r
o
~
 
z,Z 
° I 
Fig. 28.1: Parameters characterizing a spherical cathode surface C. 
in the rotating frame. The division by :k(ab) never creates any problem 
because in practice the image plane is never located in the mirror surface 
or on the cathode. 
This theory is not very familiar, principally because the total aber- 
ration is not found in a direct manner but only emerges gradually. An 
analogous theory, which is marginally more straightforward, can be found 
in the book of Zworykin et al. (1945). The version presented here has the 
advantage that at each stage of the calculation only regular expressions are 
involved, so that the procedure can be easily put into a computer program. 
28.2 Systems with curved cathodes 
So far we have tacitly assumed the object to be planar but this excludes 
cathode lenses with curved cathode surfaces. Concave spherical cathodes 
are, however, quite common in image converters. Usually, the radius R of 
curvature is fairly large, so that 2Z = r 2/R is a sufficiently good approxi- 
mation for the equation of the cathode surface (Fig. 28.1). The theory can 
easily be generalized to include this case. The cathode surface must be an 
equipotential (I)(r) = 0. From the series expansion (7.37), we see that 
Z 2 ,. 
r 2 
(~(Z,r) = Z¢' o + -~--q)o - 
-~-¢" +--. 
(28.19) 
is valid in the vicinity of the cathode. 
Introducing 2Z 
= r2/R 
for the 
surface ~ = 0 and retaining only terms of order r 2, we find that 
¢" = 2¢'o/R 
(28.20) 
It only remains to define the initial conditions for the longitudinal aberra- 
tion s(a). We now have 
 /2R 
(28.21) 
ao = O 
, 
zo = O 
, 
Zo - 
so = r o 

430 
28. THE ABERRATIONS 
OF MIRRORS 
Recalling that q~(Vo) is zero on the cathode surface, we obtain immediately 
from (28.15) the condition 
22o~8o.2 ~_ ~T/U 
, 
so >_ 0 
(28.22) 
Apart from these special initial conditions, no other aspects of systems with 
a curved cathode need be considered here. 
28.3 Structure of the aberrations 
We have not yet expressed the complex lateral aberration in terms of the 
initial conditions; we shall do this in the rotating frame. Since we know 
that the aberration must be invariant with respect to any constant rotation 
of the coordinate system, the only possible invariants of second order in the 
transverse initial values are 
2 
2 
2 __ W;Wo 
Pl --ro -- Xo q-Yo 
P2 = ro÷o = Xo]:o + go~/o = (w*d~o + dJ*Wo)12 
P3 = D = Zo~)o - yo~o = (w*d,o - d~*Wo)/2i 
• 2 
"2 
"*Wo 
P4 = Xo -I- go -- Wo 
(28.23) 
From the paraxial solution (28.12), we find 
2 
[wp[2 
g2 
r, = 
= Pl 
(o) + 2p2o(o)h(a) + p4h2(o) 
(28.24) 
From the solution of (28.10) with (28.11), it is now obvious that the longi- 
tudinal aberration must have the basic structure 
5 
s(a) = ~pjaj(a) 
with 
p5 := So 
(28.25) 
j=l 
This holds even in the case (28.21), since so = pl/2R. Up to third order, 
the only possible complex invariants are 
pjwo 
and 
pj(vo 
, 
j=1...5 
Introducing (28.24) and (28.25) into (28.9), we find that R(a) has the form 
j----1 

28.4 THE CARTESIAN FORM OF THE ABERRATION THEORY 
431 
The solution of (28.8) must have an analogous structure. 
Introducing 
(28.25) into (28.17b), we find that the angular aberration A8 must be 
linear in pl... pb. Finally, (28.18) shows that the lateral aberration must 
have the basic form 
5 
= 
Wo + 
~bo 
(28.26) 
"_.. 
This all holds under the assumption that the longitudinal shift s(a) is very 
small, which is usually justified. It is, of course, possible to extend the 
theory further to include all terms in -2. it then becomes more realistic. 
Soy 
We can rewrite the general result very concisely in the form 
6 
ZhWb = 
pj 
cj )wo + cj 
with (28.23) and 
• 
(28.27b) 
p o=l 
, 
P~=So 
, 
P6=So 
For completeness, we have included here the contributions of any defocus 
(j = 0). It is possible to represent the complex coefficients in (28.27a) in the 
form of aberration integrals, but this is very laborious. It is much easier to 
determine them by a least-squares-fit method, as outlined in Chapter 33. It 
is then not even necessary to consider the rotating frame, since an analogous 
structure is also found in the laboratory frame. 
The value of the present theory is that it explains the origin of the 
series expansion (28.27a). This must not be expressed in terms of slopes, 
since the latter can be arbitrarily large. Moreover (28.16) must not be used 
with a prescribed value of (I)T; instead, .~o must be chosen as an indepen- 
dent parameter, since otherwise the series expansion contains complicated 
square-root expressions. Equation (28.15) can be used afterwards to de- 
termine the energy e(I)T of the particular ray. Since the determination of 
the coefficients in (28.27a) by means of a least-squares-fit method entails 
using many different sets of parameters, the resulting set of calculated rays 
is necessarily polyenergetic. 
Although we have suggested how systems with a curved cathode sur- 
face may be included, the present theory must not be applied to electron 
guns with sharply pointed cathodes. In the latter, the curvature of the 
cathode is so great and the associated aberrations are so large that a se- 
ries expansion in the form (28.27) makes no sense. A completely different 
approach is then necessary, which is the subject of Part IX. 

432 
28. THE ABERRATIONS OF MIRRORS 
28.4 The cartesian form of the aberration theory 
Cartesian theories of the aberrations of cathode lenses and, by extension, 
of electron mirrors have been presented intermittently for several decades 
and their legimitacy and accuracy have been explored in some detail. These 
theories fall into two families, those that remain very close to the familiar 
aberration theory of round lenses and those that introduce a new indepen- 
dent variable as explained in Chapter 18. The first group begins with the 
paper of Ximen (1957), to be followed by Bonshtedt (1964) (who does not 
cite Ximen). The Chinese work was repeated and completed by Zhou et al. 
(1983) and by Ximen d al. (1983) but, meanwhile, numerous Russian pub- 
lications had been published on the subject, in particular Kulikov (1971, 
1972, 1973, 1975), Monastyrskii and Kulikov (1976, 1978), Monastyrskii 
(1978, 1980), Kulikov et al. (1978) and Smimov et al. (1979). 
The second group is associated initially with the work of Kel'man et al. 
(1971, 1972, 1973) who examined rotationally and cylindrically symmetric 
systems; their analysis was recast into a more general form by Daumenov 
et al. (1978). 
It was clearly important to establish whether one of these approaches 
was superior and Dodin and Nesvizhskii (1981) in particular have examined 
the approximations involved. They come to the conclusion that the easier 
method associated with Bonshtedt, Kulikov et al. and Ximen is reliable. 
The most detailed analyses of the aberrations by the earlier method 
are to be found in the papers of Kulikov et al. (1978), Monastyrskii and 
Kulikov (1978) and Ximen et al. (1983), in which aberration integrals for 
the usual geometrical aberration coefficients and for chromatic aberration 
coefficients defined in terms of the axial component of the initial electron 
velocity are listed. The behaviour of these expressions close to the cathode 
is analysed by Monastyrskii (1978). We draw particular attention to a 
more recent paper by Nesvizhskii (1986), who shows how the aberration 
coefficients of complex cathode systems can be derived with the aid of the 
traditional methods of aberration calculation by an ingenious change of 
variable (see also the references for Chapter 38). 
Similar lists of coefficients are to be found in the papers of Kel'man et 
al. already cited but the amount of computation needed seems very heavy 
when the chromatic aberrations are being calculated. This can be seen 
by returning to (18.23), which describes any polyenergetic paraxial beam, 
for which the constant q~T in (18.22) will have a spectrum of values. For 
each of these, the corresponding turning point Zo(OT) has to be found by 
solving V(Zo) = $(Zo) + Of = 0. Series expansions about each of these 
points Zo must now be made: the origin is not the appropriate singularity 

28.4 THE CARTESIAN FORM OF THE ABERRATION THEORY 
433 
C 
/ 
! 
Fig. 28.2: Points of inflexion P" and P" of two rays starting from a common point P 
of a cathode surface with different initial velocities. 
when ~T # 0, as is shown in Fig. 28.2. 

29 
The Aberrations of Quadrupole 
Lenses and Octopoles 
29.1 Introduction 
The aberration coefficients of systems characterized by a pair of symmetry 
planes are of less interest at moderate energies than those of rotationally 
symmetric components but they are needed in two practical situations: 
instruments in which a line focus is required and quadrupole-octopole sys- 
tems intended to reduce or cancel the spherical aberration of round lenses. 
In the latter case, a sequence of quadrupole lenses, typically four, may be 
suitably combined with octopoles either as a corrector, the combination 
providing little or no paraxial focusing, or as a corrected lens, in which 
case both focusing and correction are required. Spherical aberration com- 
pensation by means of quadrupoles and octopoles was one of the ways of 
circumventing Scherzer's theorem proposed by Scherzer himself (1947); the 
idea has attracted much attention over the years, both experimental and 
theoretical, but the final result is disappointing. There is no doubt that the 
principle is sound and a measure of correction has been demonstrated ex- 
perimentally (see Chapter 41), but the mechanical and electrical complexity 
of suitable quadrupole--octopole systems is such that they have never yet 
been capable of surpassing a high-quality round lens in performance, so far 
as the spherical aberration is concerned. 
29.2 Geometrical aberration coefficients 
Although it is in theory necessary to distinguish between real and asymp- 
totic coefficients, we concentrate on the latter for it is unlikely that a real 
specimen or target would be immersed within the field of a quadrupole. 
Real aberration coefficients will therefore be mentioned only in passing; 
they are accorded much more space in earlier surveys (Hawkes, 1966, 1970a) 
and in the textbooks of Strashkevich (1959, 1966), Yavor (1968) and Bara- 
nova and Yavor (1986). 
We set out from the perturbation characteristic function denoted by 

29.2 GEOMETRICAL ABERRATION COEFFICIENTS 
435 
S[2 in Chapter 22 (22.21); for two planes z = Zo and z = zc, we may write 
SoI~ = 
2 
T 
2 
X o 
(4000) 
(2200) 
(2020) 
(2002) 
(3010) 
(2101) 
X° 
y2 
0 
(0400) 
(0220) 
(0202) 
(1210) 
(0301) 
y2 t2 
t2 
X o 
0 
0 
(0040) 
(0022) 
(1030) 
(0121) 
X° t2 
91 
yo z 
0 
0 
0 
(0004) 
(1012)(0103) 
X"w L t 
O~o 
XoXto 
0 
0 
0 
0 
0 
(1111) 
t 
YoYo 
(20.1) 
The notation for the matrix elements has been chosen so that 
sL- 
- 
X oYo 
, 
p+q+r+s=4 
(29.2) 
O<_p,q,r,s<_4 
Introducing the dimensionless coordinates 
So I becomes 
So~ = 
Xo 
Yo 
, 
r/:= 
(29.3) 
"-- fxi 
],--i 
with 
[2 
~2 
T 
(4000) 
(2200) 
(2020) 
(2002) 
(3010) 
(2101) 
-o 
~r-jt 2 
772 
0 
(0400) 
(0220) 
(0202) 
(1210) 
(0301) 
'lo t2 
t2 
X o 
X o 
0 
0 
(0040) 
(0022) 
(1030) 
(0121) 
t2 
Yo 
yo z 
0 
0 
0 
(0004) 
(1012) 
(0103) 
¢: 
t 
~OXto- 
0 
0 
0 
0 
0 
(1111) 
~°X° 
r/ o y 'o 
(4000) = (4000)f~i 
(2200) 
~ 
2 2 
= (2200)f~if~ i 
(2020) = (2020)f~i 
(2002) = (2--O-~)f~i 
(3010) = (3--01-0)f3i 
(2101) = ('~-~)f2ify i 
(0400) = (0400)f4i 
(0220) = (~)f2 
i 
(0202) = (0202)f~i 
(1210)- (1210)f~if2i 
(0301) = (0301)f3 i 
(oo4o) = (oo4o) 
(29.4) 
(0022) = (0022) 
(1030) = (1030)fx/ 
(0121) = (0121)hi 
(ooo4) = (ooo4) 
(1012) = (1012)f~i 
(0103) = (0103)f~i 
(1111) = (llll)f~ihi 
(29.5) 
or 
(pqrs) 
P q 
= fxif~i(~) 

436 
29. THE ABERRATION OF QUADRUPOLES 
If the lens or system of lenses is symmetric, in the sense that all the field 
or potential functions are symmetric about some mid-plane, the object and 
image focal lengths are equal and several of the (pqrs) are likewise equal. 
' 
' 
/fx =: ~c and 
To see this, we write Xo ~ 
-fxz c, yo ~ 
-fuY~, Xo --* x~ 
Y~o --* Yclh =: r/c in (29.4), giving 
~c 2 
T 
(0040) 
(0022) 
(2020) 
(0220) 
(1030) 
(0121) 
~c2 
~2 c 
0 
(0004) 
(2002) 
(0202) 
(1012) 
(0103) 
772 
t2 
t2 
Xc 
X c 
0 
0 
(4000) 
(2200) 
(3010) 
(2101) 
t2 
y~, 
0 
0 
0 
(0400) (1210) (0301) 
Yc 
~C.Tc 
0 
0 
0 
0 
0 
(1111) 
~c'Ttc 
~cYlc 
(29.6) 
so that 
(4000) = (0040) 
(0400) = (0004) 
(2200) = (0022) 
(2002) = (0220) 
(1030) = (3010) 
(0103) = (0301) 
(0Z21) = (2101) 
(1210) = (1012) 
(symmetric 
(29.7) 
system) 
or 
(pqrs) = (rspq) 
In another common combination, the system is antisymmetric: the centre 
plane is a plane of geometrical symmetry and electrical antisymmetry (Fig. 
29.1). Writing (29.4) in the form 
So~ = 
~ 
T 
(0004) 
(0022) 
(0202) 
(2002) 
(0103) 
(1012) 
C~2 
~i 2 
0 
(0040) 
(0220) 
(2020) 
(0121) 
(1030) 
,:t'2 
Yc 
0 
0 
(0400) 
(2200) 
(0301) 
(1210) 
12 
t2 
"Tc 
X c 
0 
0 
0 
(4000) 
(2101) 
(3010) 
I 
17cYc 
l']CYlc 
0 
0 
0 
0 
0 
(1111) 
~c Xlc 
we see that 
(4ooo) = (ooo4) 
(oo22) = (22oo) 
(2o2o) = (o2o2) 
(3olo) = (ozo3) 
(21ol)=(lo12) 
(o4oo) = (oo4o) 
(12zo) = (olez) 
(o3oz) = (zo3o) 
(29.8) 
(29.9) 

29.2 GEOMETRICAL ABERRATION COEFFICIENTS 
437 
antisymmetry 
plane (excitafions ) 
i ] 
~z 
M 
U 
symmetry 
plone (geometry) 
I 
] 
Fig. 29.1" Antisymmetric multiplets. The simplest case is the doublet (above) but the 
quadruplet and the sextuplet (below), having more variable parameters, are more useful. 
or 
(pqrs) = (srqp) 
Proceeding as in Chapters 22 and 24, we obtain expressions for the 
aberrations but with an additional degree of complexity, already mentioned 
in Chapter 19. A quadrupole lens focuses a point object into a pair of real 
or virtual line foci, and since quadrupoles are mostly used in combination, 
the "object" for an intermediate member of a multiplet will almost always 
be astigmatic. We therefore list the aberrations for the general case of 
astigmatic object and image. If Zo, and zi= are conjugate in the plane 
x-z and Zoy and ziy in the plane y-z, with magnifications M, and My 
respectively, we write 
Axi := x(zix ) - Mxxo 
M~ 
My 
(29.10) 

438 
29. THE ABERRATION OF QUADRUPOLES 
and 
Axi =: {(3000){ 2 + (1200)y2o}~0 
+{(2010)~o 2 + (0210)7/2o}x~o + (1101)~or/oY~o 
+{(102o)~ + (lOO2)~}~0 + (Olll)~o~'y" 
+{(ooao)~ + (oo12)~'~1~ • 
~y, =: {(0300)~ + (2100)~}~o 
+{(2001){ 2 + (0201)~2}y" + (1110){o~?ox~o 
+{(0120)x~ + (0102)yto2}7}o + (1011)~oxtoy~o 
+{(ooo3)y3 + (oo21)~}y: 
distortions 
field curvature 
and astigmatism 
comas 
aperture 
aberrations 
distortions 
field curvature 
and astigmatism 
comas 
aperture 
aberrations 
(29.11) 
In the case of real aberrations and a stigmatic object, x~ 1) and y~l) 
given by (22.30), into which we substitute 
are 
,(z) = ,o,.(z) + ,~t.(z) 
y(,) = ~o,,(z) + ~ot,(z) 
(29.~2) 
giving 
t~ osL 
9~ os£ 
(29.~a) 
where W~, Wy are the appropriate Wronskians. In the line-image plane 
where tx = O, sx - Mx for example, we have 
1 os£ 
(29.14,) 
Axi =-W~ Oz. 
while in the other line-image plane, where ty = 0 and gy = My, 
1 OSI~ 
Ayi = 
(29.14b) 
W~ Oy. 
In the case of asymptotic aberrations, we generalize (25.9) to include astig- 
matic imagery: 
s~ = S~(zo:,-+)+ s~(-+, +)+ s~(+, z~:) 
s; = s'(,o,,-+)+ s~(-+, +)+ s'(oo, :,~) 
(29.~5) 

29.2 GEOMETRICAL ABERRATION COEFFICIENTS 
439 
and the aberration coefficients are then obtained from equations analogous 
to (25.7)- 
os'~ 
X(1)(zc) --" 4 
H*¢ 
Cg 
OZo 
( . os; 
Y(1)(z~) = 4 
Hy~ 
Cg 
Oyo 
aS I) 
1.., ,, ,2 
,2 
a;o~, ° 
- -~~ot~o 
+ Uo ) 
, __OS I)_ 
1 
, 
, 
,2 
-ay~ Oy,o 
-~Hycyo(X~ + Yo ) 
(29.16) 
in which the asterisk indicates that the asymptote to G=(z), Gy(z), H~(z), 
Hy(z) is to be understood. 
Each of the numerous coefficients appearing in (29.11) has a polyno- 
mial structure in inverse magnification, but now the two inverse magnifi- 
cations, m= := 1/M~ and m r := 1~Mr, appear. Explicitly, we find 
Aperture aberrations 
4 
2 
(0030) -- E(00a0)im/x 
(00121 -- E 
(0012)ijmxmyi j 
i=o 
i,./=o 
4 
2 
(0003) = E(0003)im; 
(0021) = E(0021)ijmxmyi j 
i=0 
i,j=O 
(29.17a) 
Astigmatisms 
2 
2 
i 
(20101--- E(2010)im~ 
(0201 / = E(0201limy 
i=0 
i=0 
2 
2 
i 
(o21o) = ~(02~O),m'~ 
(20011 = ~(200~),m, 
i=0 
i=0 
1 
1 
i 
j 
(1101)- E (ll01),jm~my 
(11101 = E 
(lll0),jm~m~ 
i,j=O 
i,j=O 
(29.17c) 
~o}7~a8 
3 
3 
i 
(1020) = E(1020)im/~ 
(0102) = E(0102)imy 
i=0 
i=0 
1 
2 
2 
1 
i 
• 
i 
j 
(loo21 = Z Z(1002)i~m~m~ 
(0~201 = ~ 
~(O~20),~m~m, 
i=o j=o 
i=o i=o 
2 
1 
1 
2 
i 
• 
i 
j 
(01111 = E 
E(0111)i/m~m~ 
(10111 = E E(1011)ijm:,',my 
i=o j=o 
i=o j=o 
(29.17b) 

440 
29. THE ABERRATION OF QUADRUPOLES 
Distortions 
(3000) = Z(3OOO)im~ 
i=0 
1 
(0300) -- Z 
(0300)/m iy 
i=0 
1 
(1200) = Z(12OO)imi 
i=0 
1 
i 
(2100) = Z(2100)im, 
i=0 
(29.17d) 
The coefficients (pqrs)i and (pqrs)ij are themselves simply related to a set 
of integrals. We write (25.27) 
f~o 
fyo 
(¢~i) ½ 
(29.18) 
r-- 
fzi 
-
-
 
fyi 
-- 
Aperture aberrations 
(oo3o), = -4(4ooo)~ 
(0030)3= {4(3010)-f2----~°}r 2 
(0030)2 = -4(2020)r 
Lo 
(oo3o)~ = 4(~o3o) 
2 
( 0030 )o = -4(0040 )r -1 
3 
(0012)22 = - 2(2200) Fr 
(00~2)~ = 2(2~0~)~ ~ 
(0012)12 = {(2110) - f~---Z° } r2 
(0012 )2o = - 2(2002)r 
(0012)11 -- --2(1111)r 
(0012)o2 = --2(0220)r 
(0012)1o = 2(1012)- f~o 
2 
(0012)Ol = 2(0121) 
--1 
(0012)oo = - 2(0022) Fr 
(0003)4 = -4(0400 )r 3 
(ooo3)~ = {4(o3o~)- ho 
(oo03h = -4(0202)~ 
(ooo3)~ = 4(o~o3) 
ho 
2 
(0003)0 -- --4(0004)r -1 
(oo21 )~ = - 2(22oo)G~ ~ 
(0021)~ = {2(210~)- ho }~ 
Y 
(oo21)~ = 2(~2~o)~ ~ 
(0021)2o = - 2(2002)r 
(oo2~)~, = -2(11 ~ ~)~ 
(oo2 ~ )o~ = - 2(o22o)~ 
(oo21)~o = 2(~o12) 
(oo2~)o~ = 2(o121) - ho 
9. 
(002 I)oo = - 2(0022)Gr-1 
(29.19a) 

29.2 GEOMETRICAL 
ABERRATION 
COEFFICIENTS 
441 
(1020)a = 12(4000)r 2 
(1020)2= {-9(3010) + 3~}r 
(1020)1 -- 6(2020) 
( 1020 )o = - 3( 1030 )r -1 
(1002)12 = 2(2200)Fr 2 
(1002)11 = --2(2101)r 
(1002)o2= {-(1210)+ 
~}r 
(1002)1o = 2(2002) 
(1002)o, = (1111) 
(1002)oo = -(1012)r-' 
(0111)21 = 4(2200)Fr 2 
(0111)2o = --2(2101)r 
(0111),1 = {-4(1210)+ fxo}r 
(0111)1o --2(1111) 
(0111)Ol 
-- 4(0220) 
(0111 )oo = -2(0121)r -1 
Astigmatism 
(2010)2 = - 12(4000)r 
(2010)1 -- 6(3010)- 3 f~° 
2 
(2010)o = - 2(2020)r --1 
(1101)11 = -4(2200)Fr 
(1101)1o = 2(2101) 
(1101)ol = 2(1210)- fxo 
(1101)oo = -(1111)r -1 
(0210)~ = - 2(2200) Fr 
(0210)1=2(1210) 
fxo 
2 
(0210)o = - 2(0220)r --1 
(0102)3 ---- 12(0400)r 2 
{ 
(0102)2 = 
-9(0301) + 3-~-- r 
(0102)1 -- 6(0202) 
(0102)o = -3(0103)r-' 
(0120)21 
-- 2(2200)Gr 
2 
(0120)11 
-- --2(1210)r 
{ 
(0120)2o- 
-(2101)+-~- 
r 
(0120)1o = (1111) 
(0120)Ol -- 
2(0220) 
(0120)oo = -(0121)r -1 
(1011)12 = 4(2200)ar 2 
(1011)o2 - -2(1210)r 
(1011)11= {--4(2101)+ f~o}r 
(1011)1o -- 4(2002) 
(1011)Ol ----2(1111) 
(1011)oo -- --2(1012)r -1 
(29.19b) 
(0201)2 -- - 12(0400)r 
(0201)1 "- 6(0301) - 3 fyo 
2 
(0201 )o -- - 2( 0202)r-1 
( 1110 )11 -- -4(2200)Gr 
(1110)10 -- 2(2101) - fyo 
(1110)01 
-- 2(1210) 
(1110)oo = -(1111)r-' 
(2001 )2 = - 2( 2200 )Gr 
(2001)1 -- 2(2101) 
fyo 
2 
(2001)o = - 2(2002)r --1 
(29.19c) 

442 
29. THE ABERRATION OF QUADRUPOLES 
Distortions 
(3000)1 = 4(4000) 
(3000)o= {-(3010)+ ~~-~}r -1 
(1200)1 = 2(2200)F 
(1200)o= {--(1210)+/~}v -1 
(0300)~ = 4(04oo) 
(0300)0 = 
-(o3o~) + -5- 
(2100)1 = 2(2200)a 
(2100)o= 
-(2101)+--~ 
r 
(~.9.19e) 
The coefficients characterizing the aberrations of gradient, defined by 
{ 
X,o} 
a~; = f~ ~'(z,~) + ~o - f ~  
= ~{[30001~ ~ + [12001~ ~ } + ~'o{[00301~ + [oo~21y '~} 
+ X'o{[2010]~ 
2 + [021017/2 
} + ~{[lO2Olx~ + [lOO2]y~} 
+ r/Y'o{[1101]~ + [Ollllx'o} 
{ 
'} 
zx v ~ = f , 
) + yo - f .-~ 
yt(ziy 
Yo 
t 
t2 
= v{[o3oo]~ 2 + [2100]~ 2} + yo{[OOO3]y~ + [o021]Xo } 
+ y'o{[2001]~ 2 + [020117/2 } + r/{[0120lx'o 2 + [0102]y "2 } 
+ ~x~o{[lllO]r/+ [lOll]Y'o} 
(29.20) 
are also polynomials in inverse magnification. These have the following 
form: 
1 
[3OO0] = (3010)- ~f~o 
[le0o] = (1210)- 2f~o 
[2010] = -3{(3010)- lho}rmx + 2(2020) 
1 
[02101 = -{(1210)- -~fxolrmz + 2(0220) 
1 
[1101] = -2{(1210)- ~ho}rm~ + (1111) 
[102o1 = 3{(3010)- 2f~o}r~m~ -4(2020)rm~ + 3(~030) 
[1002] = {(1210) - ~ho}r2m 2 - (llll)rmy + (1012) 

29.2 GEOMETRICAL ABERRATION COEFFICIENTS 
443 
1 
- 4(0220)rmy 
[0111] = 2{(1210)- -~f~o}r2mxmy 
-(llll)m= 
+ 2(0121) 
a 
2(2020)r 2 2 
[0030] = -{(3OLO)- 
f=o}ram~ + 
m= 
- 3(~ oao)~ 
+ 4(0040) 
[00121 = -{(12101- 2f=o}ram=m~ + 2(02201r2m~ 
+ (llll)r2m~my -(1012)rmx - 2(0121)rmy 
+ 2(oo22) 
1 
[03001 = (03011- -~fyo 
1 
[21001 = (21011- ~ho 
} rm~ + 2(2oo2) 
[2001] = -{(2101)- ~ho 
1 
[0201] = -3{(0301)- -~ho}rm~ + 2(0202) 
1 
[1110] = -2{(2101)- -~fyo}rm~ + (1111 / 
2 
2 
1 o}r m x 
(1111)rmx + (0121) 
[0120] = {(2101)- ~fy 
1 
2 2 
[0102] = 3{(03011- ~fyo}r m r -(0202)rmy + 3(0103) 
1 
[1011] = 2{(2101)- -~fyo}r2m~my- 4(2002)rm~ -(llll)rmy 
+ 2(1012) 
1 
[0003] = -{(0301)- -~fyo}r a 3 + 2(0202)r 2 2 
m r 
rrty 
- 3(0103)rmy + 4(0004) 
1 
[0021] = -{(2101)- -~ f yo }r 3 rex2 mr + 2(2002)r2m 2 
+ (llll)r2m~my - 2(0102)rm~ -(0121)rmy 
+ 2(0022)G 
(29.21 ) 
The coefficients (pqrs), p + q + r + s - 4, denote the following integrals: 
(2O 
(4000) = f4 i f (A=G4. + B~G2G~ + NG~) dz 
--oo 
1 
-4- g limoo(z- Z(g~ )) 

444 
29. THE ABERRATION OF QUADRUPOLES 
O0 
(0400) = f,~ / (A,G~ + B, G2G 
'2_,_, + NG~) dz 
--00 
1 
z~ 
+ g li~moo(z- 
. ) 
oo 
(0040) 
/ (A_-4 
-2 -,2 
-a 
= 
r. + B.F.F~ + NF. ) dz 
--OO 
1 
oo 
--2 --12 
--14 
(00o4) = 
(A,r~ + B,r,r, + Nr, )dz 
--OO 
1 
--r 
lira (z- ~(y) 
8 
z--,-oo 
~Fo ) 
oo 
/ 
1 
Na,:r, x 
(30101 = 4/2i 
{A. 
3- 
~B. 
2 
G.r. + 
(G.)'(G.F.)' + 
} dz 
--OO 
OO 
(0301 / = 4f~, / {A, a,r,3- + 41B,(G,2)'(G,Y,)' + ..~'3~' 
}_,-y dz 
--OO 
OO 
1 Bx(GxF ~ItF 2v 
I--13 
(1030) = 4Yx.i 
{A.G.F~ + ~ 
.,,...., + NG.F.. } dz 
--00 
oo 
1 
(a,Y,)' -~)' 
'-'~ 
(0103) = 4 h, 
{A~ayFay + -4By 
(Fy 
+ Nayr~ } dz 
-- 00 
O0 
(2020) 
6f~i J IA~ 2-2 
1 B 
2-,2 
G,2~ 2 
= 
G~r~ + 6 ~(G~r~ + _~_~ 
12 _~12 
+ (G:)'(r2z) ') + NG~ F~ } dz 
oo / 
-: 
(02021 = 6/~, 
{A,V,r, + B,(G~r + _y _, 
--OO 
NG '2~'2 } dz 
+ (O~l'(r~)')+ 
, 
, 
oo 
f 
2--2 
2 _--12 
6~12 ~2 
12--12 
(2002) = f~ 
{CG~F~ + B,G~ry + By.~ _y + 2NG~ F~ 
--00 

29.2 GEOMETRICAL ABERRATION COEFFICIENTS 
445 
+ RG.L(G.~', 
- V'.~,)} ,~z 
oo 
_= 
= 
B,i ~, '= 
=,=.-.= 
-,= 
,= 
(0220) = g, 
{CF, G, + 
G, + B,r, ~, + 2Nrx G, 
--00 
+ RF~Gy(F~Gy - F~Gy)} dz 
oo 
,2 
C,2 ~2 
9. N C. '2 ~,2 
(2200) = s~,s~,, 
{ca~a~ + B,G~G, + B, 
+ 
--x 
--y 
.
.
.
.
 
z 
--y 
-- oo 
+ na, V,(a,a', - a'~a,)} ez 
1 Jim(z- 4~)) 
(2200) F = (2200) + 
1 lim(z 
Z(F~ ) 
(2200)G = (2200) + ~ 
- 
) 
oo 
--2 --2 
--2 --t2 
--t2--2 
--t2--t2 
(0022) = 
{cr,r, 
+ B~r~ry + Byr~ r, + 2gI'~ I'y 
+ nr, r,(r,r; 
- 
~z 
lr lira (z--(~) 
(0022)F = (OO22) - ~ .--.-~ 
~Fo) 
1 r 
(0022)G = (0022)- ~ .---~lim (z- ZFo 
-(y)) 
oo 
I --I 
I --I 
(2101) = 2f:~,f,,2 
[CG~G,ry + B,G~G,r, + B, GTG,r, + 2NGTGyr~ 
1 nla~(a,r,)' - (a~l'a,r,}] dz 
+-~ 
-- 
2 
-- 
t2 
t --t 
2 
(1210 / = 2f~,f~, 
[CG=F,G, + B~G~F,G, + B,G~F,G, + 2NG'~P' G '2 
--z 
~y 
~ 
- (a~ ' - (a,r~)' 
~ 
+ -~n{o,r, 
,, 
a,}] dz 
oo 
(1012) 
2£i /[CG.r. -2 
-,2 
,-,-2 
,-,-,2 
= 
Fy + B~G~F~Fy + B~G~F,~F~ + 2NG~F~Fy 
-- C~ 
1 
- 
-2), 
,-2 
+ ~n{a,r,(r, 
-(a,r,)r,}] 
dz 

446 
29. THE ABERRATION OF QUADRUPOLES 
oo 
-2 ,-, 
-,2 
- 
2NF~ '-' 
(0121) -- 2 hi 
[Cr~GyV, + B,r,G,r, + B,r, G,P, + 
G~ry 
--OO 
+ 1R{r~(G,r,)'- (P2~I'G,P,}I dz 
OO 
I ~ 
I --I 
-- 
(IIII) = 4f, iAi 
[CG,r,G,r~ + B,a,r, ayry + B,a,r, ayr, 
--00 
, ~ 
,-, 
1 
(G,r,)G,r,}ldz 
+ 2Na, r,G,r, + ~R{GP,(G,P,)'- 
- 
' 
(29.22) 
in which 
1 (~)½(7¢ (4) 
¢'a + 4p~ 
87Pg 
@2¢" 8r/Q~) 
+ ~ +3~ +z 
1 (¢)½(7~ 4) 
¢"2+4p22 87Pg 
A, = ~ 
~ 
- 
~ 
+ 3~ 
¢" 
8,Q~) 
4P¢ 2 
3¢½ 
+ E 
B, = -N 
4 
C- 6~ (~) ½ (7¢(4); 
¢,,2 ¢2-4P22 ) -6~ 
g=--~ 
n = ,TQ~ 
(29.23) 
4¢I 
and .=.(z) characterizes the octopole distribution: 
) 
(29.24) 

29.2 GEOMETRICAL ABERRATION COEFFICIENTS 
447 
In the foregoing formulae, we have imposed no restrictions on ¢(z), 
p2(z) and Q2(z), which may all be present simultaneously. 
Commonly, 
however, ¢ is constant and any electrostatic and magnetic quadrupole fields 
do not overlap. In these conditions, the formulae can be recast in a much 
simpler form by writing 
p2(z) =: P2o q(z) 
Q2(z) =" Q2o q(z) 
(29.25) 
p4(z) =: P40 w(z) 
@4(z)--" Q40 w(z) 
where q(z) and w(z) are functions that reach a maximum value of unity. 
We define an excitation parameter ~2 and a label n as follows: 
7p2o -. ~2 
r/Q2o _. ~ 
~2 .= ~ 
_/~: 
n := 
2,~ 
E 
~½ 
-- 
zL, 
(29.26) 
Thus for purely electrostatic quadrupoles, n = -1, for magnetic quadru- 
poles, n = 0, and as we shall see in Section 29.4, for achromatic quadrupoles, 
n = 72 ..~ 1. From (29.25-29.26), we see that 
7p2(z) _ 2n~2q(z) 
and 
r/Q2(z) = (n + 1)~2q(z) 
(29.27) 
For octopoles, we write 
"YP4o 
r/Q4o 
~o 
48¢ 
rE 
24¢½ 
--ru 
so that 
_=(z) = ~(z) 
The functions A~, A~... R now become 
TM -- rE 
"-- r 
(29.28) 
(29.29) 
1 
A~ = _~f12(f12q2~-2 + 
v 
Ay 
- 
-- 8 f12 ( f12 q2-~ 2 
1 
Bx - -By - -4 ~2 nq 
1 --4--2 2 
C-~p 
n q -6rw 
1 
N 
__. 
~ 
8 
1 fl2(n + 1)q' 
n 
- 
1 
II 
6 
q )+rw 
n-1 
- ~q") 
+ rw 
6 
(29.3o) 

448 
29. THE ABERRATION OF QUADRUPOLES 
where ~ "= n/7. The following set of coefficients (pqrs) is now more con- 
venient: 
(X) 
(4ooo) = f ~, r; dz 
m ~  /1/ 
= 
br; dz - 
r': d~ + 
2i~(z --~r, (")', 
mOO 
m ~  
f 
4 dz 
(0400) = 
ayry 
= 
br~ dz- 
F, dz + 
lim (z- 
• ) 
= / 
axF x dz 
(0040) 
=' 
= 
b~.dz- 
r, dz- 
lim(z-~o) 
m ~ 
~ OID 
O0 
(0004) = / ayr~ dz 
/ 
1 
= 
bF---'4y dz - 
ry dz - 
lim (Z -- ZFo- (y) ) 
Z----+~O0 
mOO 
~ O0 
O0 
f 
r3_ 
f, 
(3010) = 4 
a, ,F, dz + -~ 
--(X) 
OO 
OO 
= 4 
brlrx dz - g 
-x -~ 
12 
mOO 
-- C~ 
C~ 
(0301) = 4 
~,r,r, dz + g 
mOO 
OO 
OO 
= 
bryrydz--~ 
_y_~ 
+ 
mOO 
mOO 

29.2 GEOMETRICAL ABERRATION COEFFICIENTS 
oo 
f 
_~ 
f, 
(1030) = 4 
a,r,r, dz + -~ 
(2~ 
OO 
- 4 
br~r~ ez- g 
r~r~ dz + 1--2 
(0103) = 4 f a,F,r: dz + fy8 
O0 
O0 
= 4 
br,r ~, ez- g 
r,r, dz + 1--2 
mOO 
re(X) 
OO 
2m 2 
(2020) = 6 
a~r~r~ dz 
= 6 
br~r~ dz m --4 
F~ dz 
mOO 
mOO 
O0 
2-- 2 
(0202) = 6 
a~r~r~ dz 
=6 
bryrydz-~ 
y 
y 
449 
oO 
(2002) 
/ 
2-2 
3 ~q'r,r,(r,r', 
'- 
= 
{~r,r, + ~ 
-r,r,)} 
dz 
CX~ 
= 
{~r,r, 
~2 
~-,~ 
,~-~ 
- 
q(r~r, - r~ r,)} ez 
= 
w~r, dz- ~ 
r~r, dz 
2 
3 
2 
, 
--' 
(0220) = 
{crier, + g~ q'r,r,(r,r, - r,r,)} dz 

450 
29. THE ABERRATION OF QUADRUPOLES 
O0 /{ey~ ~ 
3.~ .~.,~ -,~ 
= 
r, - 
~p 
q[l.l, 
- r: r~,)} dz 
--OO 
OO 
OO 
/ 
= 
~F,Fy 
~ 
F, Fy 
--OO 
--OO 
(X) 
(2200) 
/ 
2 ~ 
3Z~ 'r 
(r,r', 
' r,)} dz 
= 
{cr, r,+~ 
q ,r, 
-r, 
--OO 
8 
OO 
/ 
2 
3 
q(F2xF ' 
F,)} dz- 
-~ 
= 
{~r~,r, 
z' 
"-r~ 
~ 
1 ,£%(2z-z?~,-z(~, ~) 
--CX:) 
2 dz- 
3 
,2 ,2 dz + 
lim (2z- Z(F~ ) - 
) 
= 
~r~,r, 
~ 
r,r, 
~_~ 
--00 
--00 
O0 
(2200)~ 
/ { 
~ ~ 
3~, 
, 
z~:, ) - ~ 
= 
~r,r, + ~ 
q r,r,(r,r, -r'r,)} 
dz- 
s 
--OO 
f 
.(.) _ z~ ) 
2 
3 
2 
12 
t2 
2 
~Fi 
" 
= 
{~r~r, - 
~/~ 
q(r~r, 
- r. r,)} dz- 
s 
--OO 
j 
i 
1 
- 2 2 
3 
r'2r '2 dz + 
lim (3z- 2z~i ) - Z(F y)) 
= 
cr~r, dz- 
-~ 
-x-y 
-4 z--.oo 
--OO 
--OO 
O0 
(2200)G 
/ 
2 2 
3 
= 
{~r~r, + ~q'r~r,(r~r', - r'~r~)} ~z + 
--00 
z(X) _ z~ 
Fi 
O0 
-2 
~ 
3 2 
,2_r~ 
2 
= 
{~r,r, - §Z q(r2,r, 
r,)} dz + 
--OO 
(y) 
Z(~ ) -- ZFi 
j- 2 2 
= 
cF~Fy dz- 
O0 
1 
_(~) 
3 
v'2W 2 dz + 
lim (3z - 2z~ - ZFi ) 
OO 
(0022) 
/ 
-2-2 
3 
. . . . .  
, - 
= 
{~r,ry + ~q'r,r,(r,r',- 
r,r,)} dz 
--00 

29.2 GEOMETRICAL 
ABERRATION 
COEFFICIENTS 
451 
lzlim 
(2z 
z(p 
.(Y) 
+g 
__ 
- 
-o~o) 
O0 
J 
-2 -2 
3 2 .-2 -,2 
-,2 -2 
1 
_(=) 
_(y) 
-- 
z -..-, -- c~ 
Z F ° 
Z F ° 
= 
{w=r, 
g# q(r~r, - r= r,)} dz + -g lira (2z- 
- 
) 
/ 
-2-2 
3/-,2-,2 
1 
= 
~r=r, dz- 
~ 
F= F, dz- 
~ =--.-~lim (2z- z (~) - "Fo 
"(')) 
--2--2 
3 
2 
t .
.
.
.
 
t 
Z(FX)o- 
-(y) 
--t -- 
Z Fo 
(oo22)~ = 
{~r=r, + g# q r=r,(r=r, - r=r,)} dz + 
s 
m2--2 
3 
2 
---2--t2 
=t2:2 
ZFo 
-- ZFo 
= 
{w=r, - g# q(r~r, - r= r~)} dz + 
s 
J 
7 
-2 -2 
3 
-,2 -,2 
1 
= 
c-TxF , dz - -~ 
F= ry dz- 
~ ~-~lim (3z- 2z (x) - *Fo 
~(~)) 
t 
--I 
ZFo 
-~-~ 
3#2 
~r,(r~r, 
r,)} dz- z~2- -~ 
(0022)~ : 
{~r=r, + g 
q'r 
- r= 
s 
O0 / 
-- 
{ CF x r y 
~ 2 
--2 -t2 
-t2 -2 
- (x) 
_ (y) 
- 
- 
q(I'=Fy - F= Fy)} dz- 
ZF° -- ZF° 
8 
= 
w,r, dz - ~ 
F= Fy dz - ~ z--.-o~ 
- zzfo -- ~Fo ) 
O0 
f 
3 
~(r,r,)' 
~)' 
h 
(2101) = 
[2~r2r,r, + ~#~q'{r= 
-(r, 
r~}] 
dz + -~ 
oo 
3 
2 
2 ,-' 
r~ryFy 
+ 
8 
= 2 
{~r2r~r, - g# q(r,r,r,- 
)} dz 
h 
00 
O0 
2/-2- 
3/,2,_, 
= 
cF=FyFy dz - -~ 
F, FyFy dz 
4 
(X) 
~ 
3 2q, 
~)' 
r,) r,}] dz + s 
(1210) = 
[2cr,r,r, + ~# 
{r,r,(r, 
-(r,- 
' ~ 
f" 
~00 

452 
29. THE ABERRATION OF QUADRUPOLES 
(X) 
_2/--2 
- 
{~r,r,r, 
- 
Z2q(r,r,ry 
)} dz + -- 
--z--z--y 
2dz_3 /W~F 
12dz 
fx 
= 2 
~F,F, Fy 
2 
-'-'-Y 
4 
--OO 
--OO 
OO 
= 
[2~r,r,r, -~- ~2qt{r,r,(r, 
- 
(r,r,) 
r,}] d~ + --s 
O0 
2 
{~r,r,r, 
~2q(r,r,r~ 2 
,-,-2 
f, 
= 
- 
- r,r,r,)} 
dz + V 
--OO 
OO 
OO 
= 2 
~I',I'~I'y dz- 
-~ 
r,r,ry 
dz- 
T 
(0121) = f [2cr~r,F,-2 
- 
+ ~z2q,{r2(r,r ,), - (r2),r,r,~] ez + -f's 
O0 
3 
2 
I--I 
--t2 
-- 
fy 
= 2 
{~2r,r, 
- g~ q(H,~r,r, - r, r,r,)} dz + T 
--OO 
OO 
OO 
OO 
(~) = 2 /[2~r,r,r,r, 
+ 3Z~q'(r,r,(r,r,)'- 
(r,r,)'r,r,}] ~z 
--OO 
OO 
3 
- 
l -l 
-l 
- 
= 4 
{~r,r,r,r, 
- g~2q(r,r,r,r, 
- r'r,r,r,)} 
dz 
--OO 
OO 
OO 
/ 
-- 
/ 
,-, ,-, 
= 4 
er,r,r,r, 
dz- 3 
r,r,r,r~ 
dz 
(29.3~) 
In these expressions, the functions a~, %, b, c and ~ are as follows" 
a z 
.~-- 
1 ~4(3~2 _ 2n -[- 3)q 2 -- 9~~2q" + -rw 
24 

29.3 APERTURE 
ABERRATIONS 
453 
1 
1 
~4(3~2 -- 2n 4- 3)q 2 4- 9-~ j32 q'' 4- Tw 
ay :-- -2-4 
:= -9--1a ~4(3~2 - 2n 4- 2)q 2 4- vw 
.
q
 
b 
c .= 1/34 (~2 _ 2n 4- 1)q2 _ 6rw 
• = 1/34 (~2 _ 2n - 2)q2 _ 6rw 
29.32) 
We have lightened the notation by setting 
r~ = AG~ 
F~ = AG~ 
Fy = LGy 
Fy = LG~ 
(29.33) 
so that F~ and F~ are the rays incident from object space parallel to the 
axis at heights f~ and fy in the two principal sections. 
If the function 
q(z) is even in z, F~(z) = F~(-z) and Fy(z) = Fy(-z); if q(z)is 
odd, 
then F~(z)= Fy(-z) and Fy(z)= F~(-z). The interrelations between the 
coefficients, derived earlier by symmetry arguments (29.7, 29.9), become 
obvious. 
29.3 Aperture aberrations 
Each of the aberration coefficients of quadrupoles is associated with an 
aberration figure. We shall examine only the aperture aberrations, however, 
and we likewise confine the detailed analysis of the aberration formulae to 
this family of defects. 
In a general plane zc, the real aperture aberrations expressed in terms 
of Xo, Yo, x~ and Ya are given by 
• 
- 
= 
+ 
+ (12)u o} 
- sy¢yo = ya{ty¢ + (03)y 
 2 + (21)x 2} 
(29.34) 
in which we have shortened (OOrs) to (vs). As in Chapter 24, we consider a 
family of rays intersecting the aperture plane around a circle, xa = ra cos 0, 
ya = ra sin 0. We find 
3 
xc -- sxcXo -- ra{txc + (30)r 2 } cosO 4- ra{(12 ) -- (30)} sin 20cosO 
3 
Yc - sucyo = ra{tyc + (03)r 2 } sin0 + ra{(21 ) -(03)} cos 2 0sin0 
(29.35) 
or writing 
~x "'- xc -- sxcXo --: (x -4- ~sin 2 0) cos 8 
@ "= Yc -- sycyo =: (~ + u cos 2 8)sin 0 
(29.36) 

454 
29. THE ABERRATION OF QUADRUPOLES 
we obtain 
5X = (1 + e + c~ sin 2 O) cos 0 
6Y = (1 - 
e + c~ cos 2 O) sin 0 
(29.37) 
with 
2u 
2A 
,SX = ~
S
x
 
5Y = ~ , S y  
,¢v + Ap 
,¢v + A~ 
,¢v- Ap 
2Av 
~u + Art 
,¢u + Art 
(29.38) 
Equations (29.37) are the parametric representation of the aberration fig- 
ure in a general plane. The resulting curve is always symmetric about the 
planes 0 = 0, 0 = ~r/2 and has an oval, star- or rosette-shaped appearance 
according to the relative values of c~ and e. Figure 29.2 shows a division 
of the c~ - e plane into regions associated with various aberration figures, 
proposed by Meads (1963) (and extensively analysed in Hawkes (1966)). A 
classification of the aberrations for quadrupole systems producing a stig- 
matic but not necessarily orthomorphic image has also been proposed by 
Burfoot (1954a,b), who writes 
Xi -- SxiXo 
-- Xa{O~xr a + 
2 
(29.39) 
so that 
1 
a, = ~{(30)+ (03) + 3(12)- (21)} 
1 
av = ~{(30) + (03) -(12) + 3(21)} 
1 
fl = ~{(30) - (03) - (12) + (21)} 
1 
3' = ~{(30)+ (03) - (12) -(21)} 
(29.40) 
The pair of coefficients a, and ay convert an image point into an ellipse 
which reduces to a circle, the familiar spherical aberration disc of round 
lenses, if M, = My, so that (12) = (21). The coefficient fl measures the 
so-called "star" aberration, and 3' the the "rosette". 
The aperture aberration coefficients can be written in many different 
ways. We now list a few of the formulae that have been found convenient 
in practice. 
(i) Real aberrations, ¢(z), p2(z) and Q2(z) may all be present. For this 
case only, we list distortions as well as aperture aberrations, to show that 

29.3 APERTURE ABERRATIONS 
455 
_ 
0 
-I 
-2 
< 
, 0  
~- Oenepa/,z~~ 
Genenahzed nosette 
-5 
\ 
0 
q 
2 
3 
4 
E 
Fig. 
29.2: 
The various forms of the aberration figure associated with the aperture 
aberrations. 
they can be derived from one another by symmetry arguments. 
a 
o 
fit 
o 

456 
29. THE ABERRATION OF QUADRUPOLES 
a 
o 
a 
o 
Wyy(a)(zc)=(tye/ay4dz-sye/au3dz)yao 
¢t 
o 
tl 
o 
tl 
o 
a 
o 
with c := zc and 
2 
t2 
t4 
^ ½ 
ax4 = 4(Axs~ + Bxs~s~ + Ys~ )¢i 
a~4 = 4(Ays~ + Bysys~ 
= 
B t 2t a + Nt~)$~ 
r~ ,,2÷,z + Nt;4)~ 
r~4 = 4(A~t~ + ..~y.y 
,,! 
~,3 = 9.¢? (2a, s~t, + B,s,s'(s,t,)' + 2Ns~t',) 
^1 
ay3 
2¢I(2Ay z 
' (s.ty)' 
,z, 
= 
syt~ + Bysysy 
+ 2Nsy ty) 
^! 
3 
r,3 = 2¢ l (2A, s,t, + B,(s,t,)'t,t', + 2Ys~t~) 
^l 
T,3 = 2¢: (2A, s,t~ + B,(s,t,)'t,t; + 2Ns;t~) 
+ 2B,s 2 ,2 + 2B. ,2 2 + 4Ns~s~] 
xSy 
Sz ,~y 
[2Ctxt, + 
t,) -(t~)t,} 
,2 
2B, t~ 2 
4Nt~t~] 
+ 2Bzt2t~ + 
ty + 
(29.41) 

29.3 APERTURE 
ABERRATIONS 
457 
2 
t 
t 
t 
t 
+ 2Bxszsyty + 2Bys~syty + 4Ns~syty] 
2 , , 
2B,t~s,t, 
4Nt~slytl u 
+ 2Bxtzsuty + 
+ 
] 
0"12 "- ¢? [2Csztxs, 
- (sztx) s,} 
t 
2 
t 
t 
t2] 
+ 2Bzsztzs~ + 2Bys~ztzsy + 4Nsztzsy 
^1 
2 t 
2 
t2 
t .t .2 
t 
t 
t2 
+ 2Bzsztzty + 2Bysz~x~y + 4Nsztzty ] 
(29.42) 
(ii) Real aberrations, quadrupole~ only, formulae indicating the sign of the 
various coefficients. 
At the real line image at which tx vanishes, z = zi =: i, we have 
i 
i 
lj',. 
1I{(,.,....o.)' 
(0030)=~ 
t . dz + ~ 
4 
¢; 
=-¢1= 
o 
o 
4p 2 
+W 
)_t~ ez 
i 
i 
i 
, 
I.. 
1 
t~dz+ 
(392-2n+2)¢~ 4 
qt~dz 
= -g 
-g 
o 
o 
i 
lt~ityi , 
3 S t'2t'2 dz 
(0012) = -2 
t'i + 2 
-x-, 
(29.43) 
o 
i 
____/ 
4,Tp2Q.2 8,2Q.~) 2 2 
' 
. 
,.,.,z 
8 
\¢~ 
~ 
¢ 
o 
i 
= - 
t~it~it;i + -~ 
t x t~ dz 
o 
i 
1 
I 
_
_
 
q tzty 
2(~2-2n-2)/74 
2 2 2dz 
o 
At the real line image at which t, vanishes, z = zj, (0003) and (0021) are 
obtained from (29.43) by interchanging tz and t~. If the image is stigmatic, 
zi = zj , then (0012) = (0021). As before, ~ = n/7. 

458 
29. THE ABERRATION OF QUADRUPOLES 
It is clear from (29.43) that (0030) and (0003) cannot change sign in 
the nonrelativistic approximation (7 = 1) and that the mixed coefficients 
cannot change sign for stigmatic magnetic quadrupole systems (Ovsyan- 
nikova and "favor, 1965; Moses, 1966; Hawkes, 1966/67b). 
Still in the 
nonrelativistic case,~0012)=(0021) is always positive in stigmatic systems 
provided that 1 - ~/3 < n < 1 + V~; this range includes magnetic (n = 0) 
and achromatic (n = 1) systems. When the relativistic correction becomes 
large, however, (0030) and (0003) can vanish as a negative term appears 
in the integrand when 6- 72 _ 0, that is, when the accelerating voltage 
exceeds about 0.7 MV (Rose, 1967). 
(iii)Ouadrupoles and octopoles only (¢ = const). Asymptotic aberra- 
' inz=zo~ 
yoandy'inz 
and 
tions expressed in terms of X o and X o 
, 
= Zoy 
evaluated at the asymptotic image planes z = zi~ and z = ziy conjugate to 
z = zo~ and z = zoy respectively. 
oo 
(0030) = / (F - -F)H~ dz 
--OO 
OO 
(0003) = /(f +-P)H~ dz 
--OO 
OO 
2 LH~Hy(H~ '- 
)} dz 
(0012) = 
{KH~H, + 
H, 
H'~H, 
--00 
+ ~l (d, mlm,2 - do) 
oo 
j( 
' 
, 
(0021) = 
{KH~H~ + LH~Hy(H~H,- HxHz,)} dz 
--00 
-- ~ 
my 
where 
2=_ 
F = 6,- ~1 (2p~, 4~Tp2Q2~½ + 3~2Q~1 + --=-6¢ - 
,ff 
_ flaq2 ( 3~2 _ 2n + 3)- 2vw 
6 
-- 
1 
, 
,, 
1 fl2q,, 
F = 4--~(7P2 - 2yO~¢½) = -~--~ 
K = - 
- ,7Q ¢ 
+ 
2--g + 
(29.44) 

29.3 APERTURE ABERRATIONS 
459 
= -134q2(~ 2 - 2n + 1) + 6Tw 
L = 3 7v~ - 2~Q~$½ 
3 _~, 
~ 
=-~fl q2 
di = zix-ziv 
do = zo= - zov 
(29.45) 
(iv) Quadrupolea and octopolea only (¢ = const). As (ii) but free of deriva- 
tives of p2 and Q2. 
j(l( 
) 
(0030) = 
7 + 16e¢p] _ 12qTp2Q2 8r/2Q~ 
4 
--00 
O0 
--( 
)} 
/-. 
1 7P2 
2r/Q2 H2H, 2 dz-2 
~H~ dz 
4 
$ 
$+ 
--=--= 
--OO 
OO 
= 
{ (3~ 2 - 2n + 2)34 q2 H~ dz + -~p qn~ H~ } dz 
-- 00 
O0 
-2v / wH~ dz 
-- 00 
0°(1(7+16e(~ 2 
.,, 
p2Q2 
87772 ) 
(0003)= / 
-~ 
$ 
pu - lzr/7'" $] 
+ 
^ 
g~ 
--(:X) 
(3<) 
1(7p2 
2r/Q2)2H,2 } 
f: 
4 
j~(1 
1-2 .-:2 '2/ 
- 
~(3~ 2 - 2n + 2)34q2H~ dz- 5p qnygy 
dz 
--oo 
O0 
-2r / wH~ dz 
-- 00 
O0 
¢oo12) 
1 
(~ + 
= -- 
-~. 
H~Hy 
(0021) 
8 
\¢2 
~g 
¢ 
--OO 
OO 
+3\ ~ 
~½ 
,__~__v - H~ gv) 
dz + 6 
~H~Hy dz 
-- 00 

460 
29. THE ABERRATION OF QUADRUPOLES 
1 ,. 
2 m 2 
4- -~t aim z 
u -- do) 
f{(2 
n 
1)fl 4 2 2 2 
3 
,2 
,2 2 } 
.
.
.
.
 
q H, g U + -~ fl2q(g~ gy - H z H~ ) 
dz 
-- C~ 
O0 
+6r / 
2 2 
1,. 
2m 2 
wgtg~ dz 4- -~(aim, 
y - do) 
(29.46) 
--00 
29.4 Chromatic aberrations 
In the general case, in which ¢(z), p2(z) and Q2(z) may all be present, the 
asymptotic chromatic aberration is given in the planes zi~ and ziy conjugate 
to Zo, and Zoo, respectively by the following expressions: 
where 
and 
A¢ 
a+, = (C.+'o + c~o) ~o 
C 
' 
A¢ 
Am = ( +yyo + CM+yo) [~o 
Ca+ = f (k¢, 4- kq)H~ dz 
--00 
O0 
Co, = f (k~, - kq)H 2 ez 
--O0 
OO 
CMx "- f (kdp -~" kq)GxHz dz 
--00 
O0 
CMy -" f (kgp- kq)GuH ~ dz 
--00 
(~o) ½ 7( 5 + 7~ )¢'~ 
k+.=- T 
(.+o)+(1 + 
+":+ = + 
4+ 
(29.47) 
(29.48) 
(.29.49) 

29.5 QUADRUPOLE MULTIPLETS 
461 
With the notation of (29.25-29.29), the coefficients (29.48) take the follow- 
ing form in the pure quadrupole case: 
1/ 
Cc, - -~u~ 2 
q(z)H 2 dz ; 
l 
O0 
O0 
in which 
oo 
1/ 
Cc~ =-~ufl 2 
q(z)H~ dz ; 
mOO 
O0 
(29.50) 
n - 72 
v = 
~ n- 1 
(29.51) 
7 
Thus if n = 72 ,,~ 1, which implies ~ 
= 2/~}, a combined electrostatic and 
magnetic quadrupole will be achromatic, provided that the field functions 
p2(z) and Q2(z) are identical. Figure 29.3 shows a quadrupole in which 
this condition is satisfied to a very good approximation. 
This achromatic condition was first derived by Kel'man and Yavor 
(1961) and rediscovered independently by Septier (1963). The relativistic 
formulae were first given by Hawkes (1964, 1965c). Extensive experimen- 
tal work on mixed magnetic and electromagnetic quadrupoles was subse- 
quently performed by Hardy (1967). The achromatic condition was origi- 
nally established for real aberration coefficients but these are identical with 
the asymptotic ones apart from the presence of different pairs of paraxial 
solutions. The condition is thus applicable in both cases. 
In a practical design, it is more than likely that p2(z) and Q2(z) will not 
have quite the same shape. The effect of small differences has been analysed 
with the aid of a particular field model, the rectangular distribution (see 
Chapter 39) by Shpak and Yavor (1964, 1965) (cf. Yavor et al., 1964). 
29.5 Quadrupole multiplets 
Since quadrupole lenses have a diverging action in one plane and a con- 
verging effect in the other, they are commonly combined into multiplets. 
Formulae from which the total aberration coefficients can be calculated, 
given those of the individual components, are therefore required. These 
have a strong family resemblance to their counterparts for round lenses, 
listed in Chapter 27; we give only the principal expressions here, referring 
to Hawkes (1970a) for further details. 

462 
29. THE ABERRATION OF QUADRUPOLES 
megnetic pole 
-
-
 electrode 
I 
5cm 
! 
Fig. 29.3a: A combined electrostatic and magnetic quadrupole, with which the achro- 
matic condition can be satisfied to a very good approximation. (a) Cross-section and (b) 
view of such a lens. Courtesy D.F. Hardy. 
As in Chapter 27, we introduce vectors, 
• ,--(X X I X 3 xy 2 X2X I y2Xl xyy I XX 12 Xy 12 yxly I X t3 Xlyl2) T 
y = (y yt y3 x2y y2yl x2yt xyx t yyt2 yxt2 xx,yl y,3 xt2yt)T 
(29.52) 
(in which T denotes transpose) with the convention that suffix o attached 
to x, x' indicates quantities in the object plane Zoo, but attached to y, y', 
quantities in z = Zo~ are meant. We write 
m 
"-- Mxo 
y. = Nyo 
(29.53) 

29.5 QUADRUPOLE MULTIPLETS 
463 
Fig. 29.3b: View of a combined electrostatic and magnetic quadrupole. 
in which Mx is now denoted by M and My by N, to prevent undue pro- 
liferation of the suffixes. The transfer matrices M and N relating zix and 
zoo, ziy and Zoy respectively, have the block structure of (27.3): 
Here M1 and N1 are the 2 x 2 paraxial transfer matrices in the x - z and 
y-z planes; M3 and N3 are null; M4 and N4 encode the addition rules for 
the aberration coefficients; and M2, N2 are the 2 x 10 aberration matrices 

464 
29. THE ABERRATION OF QUADRUPOLES 
similar to (27.6). We write 
M2=(Mmll 
Mml2 ... Mml9 Mml,lO) 
m21 
m22 
• • • 
m29 
m2,1o 
N2_ 
(Nrtll 
Nnl2 
... 
Nnl9 
Nnl,lO) 
n21 
rt22 
• • • 
rt29 
n2,10 
(29.55) 
Suppose now that we have a second quadrupole characterized by a similar 
pair of matrices, M ~ and/V', and that the total magnifications in the two 
planes are P, Q: 
P = M'M 
Q = g'g 
(29.56) 
Then 
zp = M'zm = M'M Zo =: P Zo 
(29.57) 
yp = N'y. = N'N Yo =" Q yo 
where P and Q of course have the same block structure as M, M e, N and 
/~. The paraxial sub-matrices P1 and Q1 have already been discussed in 
Section 19.1. It is the elements of the upper row of/92 and Q2, denoted by 
PPlj and Qql.i (J = 1- 10), that are of interest. It can be shown that 
Pll 
mll + M 2 
' 
c.,,Mm~ "~ 2 
t 
3 
' 
= 
mll ~ 
3 
cram16 + Cmmm19 
P12 
m12 + N2mtl2 + Cm mN2 
' 
c, Nm, 1 + 2 , 
= 
m14 + 
5 
Cnml7 + CmcnmNm~s 
2 
t 
-~- CmCnmml,lO 
t 
2 
2 
t 
P13 = 
m13 4- rm13 + 2rcmmm~6 + 3rcmm m19 
I 
P14 = m,4 4- rm2N2m114 + rcnm2Nm~8 -4- rc2m2ml,lo 
P15 = m15 + rm~5 + 2rcnnm~r + rcmmm~8 + 2rcmcnmnm;,lO 
P16 = m16 + r2m 2ml 6t -4- 3r2CmmZmtl9 
I 
P17 = m17 + r2n2m~7 + r2cmmn2ml,lO 
P18 = m18 + r2m2mll8 + 2r2cnm2nm~,lO 
P19 = m19 + rZm4m119 
p;,;o = m;,lO + r3m2n 2m;,;o 
(111 --" nll 
"~" N2 
I 
i 
2 
t 
3 
t 
nil + cnNn13 + cnn16 + cnnn19 
q12 = na2 + M 2 ' 
cnM2nn~4 
Mn~5 4- Cmnl7 + 
na2 + 
+ cm 
2 , 
cmc.Mnn~ 8 
2 
t 
-~ ¢nCmnnl,lO 
3rc2n 2 
q13 -- T~I3 "4- rn~3 "~ 2rCnnTl,16 "~ 
n19 
q14 : n14 + rM2n2nll4 + rcmMn2nll8 + rc2n2n~,lO 

29.5 QUADRUPOLE MULTIPLETS 
465 
q15 = n15 + rn15 + 
7 
q16 
hi6 + r2n 2 ~ 
-- 
rtl6 -~ 3r2Cnn3nl9 
q17 ---- n17 + r2m2n'lr + r2c, m2nn~,lo 
q18 -- n18 -~-r2n2nl 81 + 2r2Cmn2mn~,lO 
q19 : 
n19 ~-r3n4 
t 
n19 
q1,10 : 
rtl,lO -~-r3m2n2n~,lO 
(29.58) 
in which c,n := -l/fxi 
and c, = -l/hi 
as in (27.5). 
The coefficients m11, nl1 m~ 1, n~ 1, and hence Pl1 and qlj also, may 
be written as polynomials in the corresponding inverse magnification m 
and n (for ml1 and nl/), m' and n' (for m~j and n~j) and p and q (for Pl1 
and q11). The formulae giving the numerous coefficients that occur in these 
polynomials for the complete system in terms of those of the two individual 
lenses (or partial systems) are set out explicitly in Hawkes (1970e) and are 
not reproduced here. 

30 
The Aberrations of Cylindrical Lenses 
The aberrations of cylindrical lenses, the paraxial properties of which were 
outlined in Chapter 20, have been analysed by several authors. For elec- 
trostatic lenses, they were first calculated by Leitner (1942), who used the 
method of variation of parameters to obtain formulae in several different 
forms for all the aberration coefficients. Strashkevich (1965) likewise listed 
formulae for the latter, some of which had appeared earlier in Strashke- 
vich and Pilat (1951, 1952) and Strashkevich and Gluzman (1954). Full 
expressions for the primary aberrations of combined electrostatic and mag- 
netic lenses were derived by Shtepa (1952), Laudet (1955a,b) and ahein- 
furtli'(1955). Shi (1956) used Seman's formulation of the method of char- 
acteristic functions to analyse electrostatic lenses, employing the reduced 
equations of motion and eliminating derivatives of the Gaussian solutions. 
The coefficients, recalculated using characteristic functions, are listed in 
Hawkes (1966/67a), where a comparison with all the earlier formulae is to 
be found. For details of the calculation, the reader is referred to that paper; 
here we merely indicate the form of the results in the general case and list 
the full formulae only for electrostatic cylindrical lenses. We express the 
aberrations in terms of object and aperture coordinates; for details of the 
alternative choice, again see the paper cited above. 
The paraxial solution expressed in terms of position coordinates in the 
object and aperture planes was not derived explicitly in Chapter 20. With 
s(zo) = t(za) = 1 and t(zo) = s(za) = 0, a lengthy but straightforward 
calculation yields 
• (~) = -~(z)(y~ - yo) + ~o 
~(z) + ~r(z) 
¢-7 
O 
+ ~ 
t(z)+ ~(z) 
¢-72 
0 
y(z) = {1 - R(z)}yo + Rya + Sxo + Txa 
(30.1) 
with 
r(z) := 
( ]Btd¢_t~BSd( ) 
F-W ~ ¢~ 
¢~ 

30. THE ABERRATIONS OF CYLINDRICAL LENSES 
467 
R(z) .= -~ 
¢~ 
o 
o 
o 
o 
o 
o 
/// 
Bt de- ~ 
Bt dz 
de 
T(z):= 77 
¢--~- 
ff 
¢--~- 
¢---~- 
0 
o 
o 
¢~ 
¢~ 
o 
o 
o 
o 
o 
w 
¢~ 
¢½ 
o 
o 
W := ¢½ (st'- s't) 
(30.2) 
The expressions (30.1) are substituted into the perturbation M (4) (M I 
in Chapter 22), and aberration coefficients are extracted by partial differ- 
entiation (22.30). In the general case, the geometrical aberrations in an 
arbitrary plane take the form 
2 
• ¢1)(z) = (300)~o + (2~0)~o~ + (201)~oY 
-F (120)~,XoX 2 + (102)~xoY 2 + (111)~XoXaY 
(30.3) 
+ (030)~xa~ + (021)~x2aY + (012)~xaY 2 + (003)~Y 3 
with a similar expression for y(1)(z). We have introduced Y := Ya - Yo. 
The formulae for the coefficients are extremely complicated in the mixed 
case, in which electrostatic and magnetic fields are both present; they are 
listed in full in Hawkes (1966/67a) and are not reproduced here. In the 
simpler case of electrostatic cylindrical lenses, there are fewer terms. The 
results are then as follows. 
The function M (4) is given by 
M(4)__ (¢(4) 
¢.2 ) 
,, 
:~ 
¢ x~(x,~+y,~)_ 1 ~(x, ~ 
y,~)~ 
48¢½ 
32¢] 
8¢½ 
~ 
~¢ 
+ 
(30.4) 

468 
30. THE ABERRATIONS OF CYLINDRICAL LENSES 
in the nonrelativistic approximation. Into this, we substitute 
X = SXo + fXa 
v = (1 
- 
R)vo + Rv. 
(3o.5) 
where 
] d~ 
dz 
Rz 
Rz := 
-- 
F "= 
R= 7 
¢½, 
¢~, 
go 
Zo 
giving 
~(~)(z~) = (3oo)~ + (o3o)~ + (~2o)~0~ ~. + (2~o)~0~. 
+ (102)xoY 2 + (012)x,Y 2 
y(1)(z,) = (201)X2o Y + (111)Xox,Y + (021)x~Y + (003)Y s 
in some arbitrary plane z = Zc. The coefficients are given by 
(300) = ~-~ 
6¢½ 
tl 
2W 
6¢{ 
o 
s 4 - 
- ¢ 
dz 
4¢~ 
¢½ 
4~b{/s3f - --(s2)'(st) 
' ¢ {  
--¢{$t31~' 1 dz 
(a0.6) 
(30.7) 
and (300) ~ (030) when s --, t, t ~ -s, o ~ a; 
(102)= 
t 
/(¢"s2 
+ 2¢-½s'2) dz 
4F 2 
¢{ 
tl 
+ ~ 
~,¢] st + 2¢-½ s't' 
dz 
o 
and (102)--+ (012) when s ~ t, t --+ -s, o +-+ a; 
(120) = ~-~ 
3¢12 
2¢~ 
Q 
¢" (s2t '2 
s '2 
} dz 
3¢½ 
+ 4ss'tt' + 
t 2) - 2¢½s'2t '2 
4W 
3¢½ 
2¢~ 
sts- --(st)'tt'¢½ - 2¢12s't 's dz 
o 

30. THE ABERRATIONS OF CYLINDRICAL LENSES 
469 
and (120) ~ (210) when s ~ t, t ~ -s, o ~ a 
(oo3)= 
 F 
O 
O 
s 2 
2¢-½ 
dz 
(201) = ~-~ 
~, ¢] 
+ 
s a 
O 
4F 
~,~ s2 + 2¢-½s a 
dz 
O 
and (201) ~ 
(111) when s 2 --, 2st, s '2 --, 2s't' while (201) ~ 
(021) when 
s 2 ~ t 2 and s '2 ~ 
t 12 . 

31 
Parasitic Aberrations 
We have so far been assuming that the electron optical system under con- 
sideration is perfect, in the sense that the various symmetries are exactly 
respected. This is certainly unrealistic, for every real system is imperfect: 
there is a limit to the precision attainable during the manufacture and as- 
sembly of its components. For instance, the electrodes and polepieces of a 
lens system designed to have rotational symmetry are never truly round but 
slightly elliptical, and after assembly their individual axes are shifted and 
tilted with respect to one another. Moreover, in magnetic lenses, the pole- 
piece material will be slightly inhomogeneous, and in electrostatic lenses, 
an asymmetric layer of insulating but charged contamination may be de- 
posited on the electrode surfaces, again impairing the original symmetry. 
It is clear that the number of degrees of freedom in the imperfections in- 
creases drastically with the number of individual components in the device, 
so that complex systems are particularly prone to problems of this kind. 
The electron optical defects caused by the various forms of imperfection 
are known as parasitic aberrations. Unlike the systematic aberrations of 
perfect systems, they cannot be determined accurately since the mechanical 
defects that cause them are never known exactly. The aim of the theory is to 
furnish an understanding of the possible types of parasitic aberrations and 
to establish tolerance limits on the precision of machining and alignment 
of the various components of a system. 
31.1 Small deviations from rotational symmetry; 
axial astigmatism 
This situation is the most important, for in the vast majority of practi- 
cal devices, the lens systems are intended to be round. Any deviations of 
the boundaries from the ideal rotational symmetry generate weak multi- 
pole fields of various orders, as outlined in Section 9.4.6 where magnetic 
lenses were considered. From the properties of multipole fields presented 
in Chapter 7, it is obvious that the fields with the lowest multipole orders, 
m = 1, 2 and 3, will be the most important in the paraxial domain, as their 
potentials increase as r m with the radial coordinate r. 
Eccentricities, in the sense of shifts and tilts of the local optic axes, 
produce very weak dipole fields (m = 1), which merely cause a very small 

31.1 SMALL DEVIATIONS FROM ROTATIONAL SYMMETRY; 
471 
lateral deflection of the whole electron beam. The image is hence displaced 
bodily but remains stigmatic, with the result that these defects are not 
serious as long as they remain small. 
Quadrupole fields (m = 2) are caused by ellipticity of the electrodes or 
polepieces and produce an astigmatism; the latter does not vanish even for 
the axial object point and is therefore often called the axial astigmatism. 
Owing to its great practical importance, this aberration was studied com- 
prehensively in earlier decades. Substantial contributions were made by 
Glaser (1942/3), Bertein (1947e,1948a), Bertein et al. (1947), Hillier and 
aamberg (1947), Rang (1949a,b), Sturrock (1951b,1955), which should be 
read in conjunction with Archard (1953), Glaser (1952), Glaser and Schiske 
(1953), Der-Shvarts (1954) and Stoyanov (1955). 
With the advance of 
modern computational methods, these early investigations have lost much 
of their significance and we discuss them only briefly. It should, how- 
ever, not be forgotten that the idea of analysing departures from rotational 
symmetry into Fourier components, thereby revealing the character of the 
aberrations to be expected, first appeared in these studies, notably those 
of Bertein and Sturrock; this in turn led to the idea of the stigmator and 
permitted Archard to relate individual types of imperfection of magnetic 
lenses (corrugation of the polepieces, eccentricity and misorientation of the 
axes of the latter) to particular image defects. 
It is customary to introduce dimensionless ellipticity parameters el (z), 
e2(z); the electrostatic potential • in the paraxial domain then takes the 
form 
¢(z,r,~) = ¢(z) - 4¢"(z){1 + e,(z) cos 2~ + e2(z) sin2~} + O(r 4) (31.1) 
This represents the superposition of a dominant round focusing field and 
two weak quadrupole fields with variable strengths and different orienta- 
tions; we must assume that [eli << 1, [e2[ << 1. In the case of constant 
ellipticity, el = const, e2 
-- const', it is possible to relate these parameters 
to the semiaxes a > b of the bores in the electrodes. Without loss of gener- 
ality, we introduce a constant rotation of the coordinate system about the 
optic axis, so that el =: ~ > 0, e2 = 0. We then have 
a-b 
= 
(31.2) 
a+b 
The motions of the electrons in the two symmetry planes, X1 = 0 and 
X2 = 0, are decoupled and each coordinate satisfies a paraxial ray equation 
of the type associated with quadrupoles: 
¢X{',2 + ~¢'X{, 2 + 
¢"(1 4- ~)X1,2 = 0 
(31.3) 

472 
31. PARASITIC ABERRATIONS 
With the Picht transformation (15.40), X i = vie -1/4, this becomes 
,, 
~ ¢')2 ~¢" 
~,,~ + { 
(~ 
+ -~-}~,~ = 0 
(31.4) 
In the Busch approximation for weak lenses, we first find the average focal 
length f, 
1-6 
dz 
(31.5) 
--OO 
The ellipticity causes small deviations from f, given by 
oo 
- 
~ / 
¢" 
A(~/f) = ±~ ~ ~ dz 
-- 
00 
Partial integration yields an expression proportional to formula (31.5) for 
~-1 and as this deviation is very small, we can simplify the relation to 
Af 
4~- 
= t:y/ 
(31.6) 
This expression is certainly an oversimplification since in most practical 
applications, the lenses are not weak, but it gives an estimate of the axial 
astigmatism and this is sufficient for rough calculations. 
For the scalar potential in magnetic lenses an expansion similar to 
(31.1) holds and, in the case of constant ellipticity of the bores a relation 
of the form (31.2) can be derived, but thereafter the situation becomes far 
more complicated. Owing to the Larmor rotation of the electron rays in 
the lens, there is no coordinate system in which the ray equations decouple 
like eqs (31.1). We now have to employ one of the general methods for cal- 
culating aberrations. This theory is comprehensively presented by Glaser 
(1952); we shall not repeat it here, since more informative techniques are 
now available. 
31.2 Classification of the parasitic aberrations 
Quite generally, there must exist an eikonal or characteristic function, from 
which the lateral aberrations can be obtained by partial differentiation. 
For rotationally symmetric systems these relations can be cast into the 
convenient form 
AZo = 
S(xo,yo,Zo, Yo, Zo, Zi), 
OS 
AY° = Oy" 
(31.7) 

31.2 CLASSIFICATION OF THE PARASITIC ABERRATIONS 
473 
where S is a characteristic function, often called the 'wave aberration', 
and Axo, Ay o are the lateral aberrations referred back to the object plane 
in the usual way. These relations remain valid even if only the paraxial 
unperturbed contributions are rotationally symmetric; small asymmetric 
aberrations are then superimposed on the intrinsic aberrations of the round 
lens. 
The assumption that the asymmetries are small allows us to neglect 
their fourth-order contributions to S in comparison with those from the ro- 
tationally symmetric part. We can therefore terminate the series expansion 
of the eikonal after the third order if only the asymmetric aberrations are 
being studied. Even so, the possible aberrations are quite numerous since 
S is now a polynomial consisting of all terms in the variables Xo, yo, x o 
and y~ up to third order. We first examine the second-order terms. In the 
expansion, we omit any terms that depend on X o and yo only, since they 
do not contribute to the derivatives (31.7); we then find 
I 
-- Xo(Cl 4- allXo 4- al2Yo) 4- Ylo(C2 4- a21Xo 4- a22Yo) 
l(bl x~ 
, , 
,2 
4- -~ 
1 
4- 2bl2XoYo 4- b22Yo ) 
Here a12 is not necessarily the same as a21. It is now convenient to introduce 
new coefficients, writing 
i 
I 
I 
all --: a 1 4- al, 
a22 --1 a 1 -- hi, 
a21 --1 a2 4- a2, 
bll -: b~ 4-bl, 
b22 -: b~ -bl, 
b12 --: b2 
i 
a12--" a 2 --a2, 
We can then rewrite (31.8) as the sum of a rotationally symmetric term 
Ss --" al(XoXto + yoYto) 4- at2(XoYo -- XtoYo) 4- -~ 
and an essentially asymmetric contribution 
' 
( oy'o + yon'o) 
,-'Ca -- al(xoxo -- YoYlo) T a2 
l bl ( x~ 
t2 
t 
t 
! 
-- 
XoYo 
¢2Yo 
+ -~ 
Yo ) + b2 
+ C1Xto 4- 
(31.9) 
with S = S, + S,. The expression for S,, being composed of rotation- 
invariants, yields the aberrations to be expected in perfectly round lenses. 
These are an isotropic and an anisotropic alteration of the magnification 
(a~ and a~, respectively) and a defocus (b]). Since these are of no interest 
in the present context, we disregard them here. 

474 
31. PARASITIC ABERRATIONS 
Y 
/x 
Fig. 31.1: Axial astigmatism. 
The lateral aberrations, arising from (31.9), are now given by 
t 
t 
AXo -- C1 "~ al Xo + a2Yo + blx o + b2Yo 
t_b 1 t 
Ayo = C2 ~-a2Xo --alYo + b2xo 
Yo 
(31.10a) 
The constants Cl and c2 describe a lateral shift of the image: Axi = 
Mcl, 
Ayi =" Mc2, M being the magnification. Such a shift results from tilts or 
lateral displacements of the lens parts relative to each other, which produce 
a weak deflection. Since the image remains stigmatic, this is not serious. 
The terms that are proportional to Xo and yo describe a parazial distortion. 
From the affine imaging relation, 
xi = M(xo + AXo)= M{(1 + al)Xo -}-a2Yo} 
yi = M(yo + Ayo)= M{a2xo + (1- al)yo} 
(31.11) 
it can be seen that there are two principal directions in the image, which are 
orthogonal to each other and in which the magnification takes the extreme 
values 
M1,2 - M{1 4- (a 2 + a2) 1/2 } 
(31.12) 
Since [M1 - M2[ << [M[, the deviations from uniform magnification are so 
small that this error is usually of very little practical concern. 
' and 
' 
The terms in x o 
Yo in (31.10) are the most important. 
By an 
appropriate rotation of the coordinate system about the optic axis, we can 
bring them into an uncoupled form: 
b 'o, 
" 
= 
= -byo, 
b = 
+ 
(31.13) 
These describe the axial astigmatism, which is presented schematically in 
Fig. 31.1. Equations (31.13) represent the lateral aberration in the circle 
of least confusion: with " Zo 
a cos ~ and -' 
= 
Yo = a sin ~0, a being the semi- 
aperture angle, we find A~o = ba cos~0, A~o = 
basin ~0. Obviously the 
sense of rotation on the circle of least confusion is opposite to that on the 

31.3 NUMERICAL DETERMINATION OF PARASITIC ABERRATIONS 
475 
aperture cone. Referred back to object space, the distance between the two 
line foci is 2b. 
Among the lateral aberrations of second order, the corresponding pure 
aperture term is the most important. This is described by the wave aber- 
ration term 
- 
Xt3 
- 
Xt2 t 
t 
t2 
t3 
$3 =A3,0 
o "4-A2,1 oYo4-A1,2XoYo 
4-Ao,3Yo 
(31. 4) 
with the corresponding lateral aberrations 
t2 
t t 
2 
AXo = 3A3,oX o + 2A2,1xoy o + A1,2Yo 
t2 
t t 
2 
Ayo -- A2,1xo 4- 2A1 
-4- 3A0 
,2XoYo 
,3Yo 
(31.15a) 
(31.15b) 
This aberration consists of two components with different azimuthal sym- 
metry, as can be seen by writing (31.14) in polar coordinates, 
' 
' 
' 
' sin 
X o -- r ocOs~ 
Yo -- ro 
' and ' 
Expressing all powers of X o 
yo in terms of trigonometric functions of 
multiple arguments, we find $3 = S~ l) + S~ l) with 
S~I) 
1 ,3 
= -4Vo {(A3,o + A1,2) cos0 + (A2,1 + 3A0,3) sin0} 
(31.16a) 
S~3) 
1 ,3 
= ~ro {(A3,0 - A1,2)cos30 + (A2,1 - A0,3)sin30} 
(31.16b) 
The different multiplicities with respect to the azimuth ~ show that the 
aberrations due to (31.16a) are caused by weak deflection fields, produced 
by misalignments, while the aberrations corresponding to (31.16b) are 
caused by threefold deviations from the rotational symmetry. The latter 
are produced by corresponding threefold corrugations of the electrodes or 
polepieces. We shall call these two different aberrations the deflection astig- 
matism and the threefold astigmatism, respectively. They are hardly ever 
seen in their pure forms, since they are practically always superimposed on 
the numerous other lens aberrations. 
31.3 Numerical determination of parasitic aberrations 
Determination of tolerance limits for the machining and alignment of elec- 
tron optical systems requires calculation of the parasitic aberrations. Apart 
from a few oversimplified cases, this can only be accomplished numerically. 

476 
31. PARASITIC ABERRATIONS 
The main problem is the computation of the electromagnetic fields in the 
imperfect system. A rigorous calculation would proceed as follows: 
1. First, the fields in the perfect system are calculated by means of 
the methods outlined in Part II. 
2. From the solution of the appropriate boundary-value problem, the 
boundary values of the field strengths E(r) and H(r) are determined. This 
is often a very tedious task, since the numerical differentiation of potentials 
in the vicinity of their surface sources is rarely straightforward. 
3. It is now necessary to adopt realistic values of the shifts, tilts, ellip- 
ticities and any other deformations and to determine from these a surface 
deformation s(r), defined as the shift from a point r at the ideal surface 
to the point r' = r + s at the real surface. With the necessary assumption 
that Is I is very small, such a deformation s corresponds to an alteration 
6~ = E. s or 6X = H. s of the potential on the ideal boundary. 
4. 
With the boundary values 6~(r)or 6X(r), the boundary-value 
problem in the undeformed domain is solved and the resulting solution 
is added to the unperturbed one. This procedure is usually much easier 
than a direct field calculation in the deformed domain, since the explicit 
treatment of irregularly deformed surfaces is extremely tedious. 
5. A number of electron trajectories with appropriate initial conditions 
are then traced through the total fields. From the sets of final coordinates 
and slopes in a terminal (image) plane z = zi, the aberration figures and-- 
if needed--the aberration coefficients are determined. The corresponding 
methods are outlined in Part V. Very often the least-squares-fit methods 
explained there are much simpler than the evaluation of aberration inte- 
grals. 
This whole procedure requires a major effort and is therefore often 
much simplified. The greatest simplification is obtained if the axial har- 
monics, the axial amplitudes of the various multipole components in the 
field, are determined not from the solution of a boundary-value problem 
but from simple analytic models. An approximate field calculation is then 
possible by evaluation of the corresponding radial series expansions given in 
Chapter 7. This is certainly advisable whenever some parts of the bound- 
aries are not round even in the ideal case, as in electric deflectors or in 
quadrupole systems. 
For systems with circular boundaries, such as those composed of or- 
dinary lenses and magnetic deflectors with a round ferrite core, the more 
rigorous method is not too complicated. The Fourier-series method, out- 
lined in Chapter 7, can then be applied to the potential variations 6~(r) 
and 6X(r), and there remains the task of repeatedly solving the boundary- 
value problems for differential equations having thestructure of eq. (7.10). 
Calculations of this kind were first carried out, with a view to determin- 

31.4 THE ISOPLANATIC APPROXIMATION 
477 
ing tolerance limits for the shift s(r), by Janse (1971), who demonstrated 
their practical applicability. For a recent numerical study starting from 
Sturrock's theory, see Munro (1988). 
31.4 The isoplanatic approximation 
The isoplanatic approximation is invoked whenever we study the aberra- 
tions that affect the imaging of very small objects. This situation arises 
in practice in electron microscopes operating at very high magnification, 
say [M[ > 105, where only a very small part of the object is visible on the 
viewing screen. In a perfectly round system, the best image quality would 
be obtained for an object in the vicinity of the straight optic axis, but since 
no unique axis exists in a real and imperfect instrument, the question of 
the best alignment is not at all trivial. 
We confine the following discussion to the parasitic aberrations of first 
order, together with the intrinsic aberrations of a round system. We ex- 
press all lateral aberrations in complex form in terms of a complex object 
coordinate Uo := Xo + iyo UA := XA + iyA. The resulting lateral image 
aberration *ui can then be written 
I 
, 
* 
Aui = S + Puo + P Uo + QYA + Q'UA 
+ CU2AU*A + 2(g + ik)uoUAU A* + (g 
- 
ik)u*oU A2 
• 
2 
* 
* 
+ (A + la)UoU A + FuoUoUA + (D + id)u 2 oUo * 
(31.17) 
where the aberrations of third order are those dealt with comprehensively in 
Chapter 24. The constant S is a small shift due to weak parasitic deflection 
fields, The coefficient P is the deviation of the magnification from its 
nominal value due to a defocus, an error in the image rotation, and to 
lateral chromatic aberrations 
P = ,SM + iM,50 + ¢71A¢i(C M + iCo). 
(31. 8) 
The term 
' * 
P u o represents the paraxial distortion. The factor Q expresses 
the effect of the defocus A and the axial chromatic aberration and is always 
real: 
Q = 
+ 
(31. 9) 
Finally the term Q'u* A represents the axial astigmatism due to ellipticities. 
It is a crucial feature of imperfect systems that there is no way of 
determining whether the aperture is aligned perfectly relative to the optic 
axis because there is no unique axis. It hence makes sense to assume that 

478 
31. PARASITIC 
ABERRATIONS 
the centre of the aperture is shifted laterally relative to the z-axis of the 
coordinate system, w (°) := x~ ) + iy~ ), and to express the aberrations in 
terms of 
:= 
- 
= 
_ 
+ i(y 
 - y(2 )) 
(31.20) 
On doing this, we notice that there is one particular shift 
tto 
w (°) = -(K + ik)~- 
(31.21) 
for which the coma vanishes. Experimentally, this value is always chosen 
approximately, since one always tries to get the centre of the image as sharp 
as possible by an adjustment of the aperture. With (31.20) and (31.21) we 
now establish a series expansion in terms of Uo and WA instead of (31.17), 
the new coefficients being 
Co = C, 
K0 + i k0 = 0 
A0 + ia0 = A + ia - (g + ik)2/C 
F0 = F- 2(g 2 + k2)/C 
Do + ido = D + id- F(K + ik)/C + (A + ia)(g - ik)/C 
(31.22) 
+ 2(K + ik)2(K -ik)/C 2 
So=S, 
Oo =O, 
O~o =O' 
Po = P- (K + ik)Q/C 
P~ = P' - (g -ik)Q'/C 
In the isoplanatic approximation the object field in question is assumed to 
be so narrow that the variable Uo can be replaced by the complex coordinate 
of the centre of the observed field. This replacement is to be made in all 
the aberration terms. We then arrive at the representation: 
Aui = s + qwA + q'w* A "+" CW2AW*A 
(31.23) 
with the coefficients 
I 
* 
• 
2 
* 
s = So + Pouo + P~)uo + (Do + ,do)uoUo 
q = Qo + FouoU*, 
q' = Q~o + (Ao + ia0)u 2 
(3 
.24) 
The resulting lateral shift s is of very little practical importance, since 
the microscope is always adjusted in such a way that the centre of the 
object field of interest is imaged in the centre of the screen; this is achieved 
by means of weak deflection fields. We can thus ignore the shifts. The 
remaining aberrations are now the defocus, the axial chromatic aberration, 

31.4 THE ISOPLANATIC APPROXIMATION 
479 
~) 
(b) 
Fig. 31.2" Lateral shift of an aperture. 
(a) Aperture centred on the lens axis leading to asymmetric confinement of the beam with 
coma. 
(b) Aperture shifted in such a way that the beam is confined symmetrically; the beam 
axis b is now straight and the coma vanishes. 
(both combined in the term qwA), the astigmatism q'w* A and the spherical 
aberration CW2AW*A . As will be shown in Chapter 32, the astigmatism, 
here the combined effect of the axial and off-axis contributions, can be 
compensated with a stigmator; the resolution of the instrument is thus 
finally determined by the spherical and the axial chromatic aberration. 
Elimination of the coma by a shift of the aperture is important; it is 
shown schematically in Fig. 31.2. It can be understood as a straightening 
of the beam axis passing simultaneously through the centres of the object, 
the lens, the aperture and the image. Apart from the axial aberrations of 
perfectly round lenses there remains only an astigmatism, generated by the 
ellipticity and the inclination of the beam axis relative to the lens. 

This Page Intentionally Left Blank

Part V 
Deflection Systems 

This Page Intentionally Left Blank

32 
Deflection Systems and their Aberrations 
32.1 Introduction 
In virtually every kind of electron beam device, some provision is made for 
deflection, that is, for lateral shift of the electrons with as little disturbance 
of the beam structure as possible. In fixed-beam instruments, essentially 
in conventional transmission electron microscopes, deflection plays a minor 
role and is provided only to permit nonmechanical alignment of the column. 
In scanning devices, however, the role of the optics of the deflection system 
is to move a focused spot (often called the electron probe) in a raster pat- 
tern over a prescribed area of a specimen or a viewing screen, or to sweep 
a two-dimensional image over a small detector, and its design is at least as 
important as that of the lenses. The obvious examples here are cathode- 
ray oscillographs and television tubes, together with the various types of 
scanning electron and ion microscopes. In the more recent generations of 
electron microscopes, provision is made for both fixed-beam (conventional) 
transmission imaging and scanning transmission microscopy, so that the 
deflection system becomes just one member of the complex sequence of 
optical components that make up these hybrid instruments. In the past 
decade, deflection systems, mainly of the magnetic type, have acquired 
new importance, for it is their properties that determine the optical perfor- 
mance of electron lithography devices. Here, not only is the raster technique 
employed but--far more advantageously--the shaped-beam technique: in- 
stead of a narrow beam, focused into a small probe, a comparatively broad 
beam, shaped by masks, is deflected. The accuracy required in such devices 
is very high. More details will be found in Chapter 40. 
In scanning electron microscopes, the magnification is altered by vary- 
ing the area scanned with the result that high resolution is associated with 
small deflection angles. The probe size is then determined by the spherical 
and chromatic aberrations of the probe-forming lens and it is important to 
place the specimen as close as possible to the lens to keep the corresponding 
coefficients small. The scan coils are hence placed upstream from the lens. 
In lithography devices, on the other hand, the area scanned is large and 
the deflection aberrations become important; there is therefore no need to 
keep the working distance (the distance between the lens and the target) 
small and the scan coils can be inserted into this space, which has long 

484 
32. DEFLECTION SYSTEMS AND THEIR ABERRATIONS 
been known to be advantageous (e.g. Owen and Nixon, 1973). In the most 
recent designs, however, the fields of the probe-forming lens and of the scan 
coils overlap. 
Deflection systems may be either magnetic or electric and each type 
finds practical application. In television tubes, for example, the power 
consumption is higher for magnetic deflectors, but these are nevertheless 
preferred, for it is easier to provide the required deflection current than the 
voltage needed in an electric system; moreover, the distortions are lower. 
In the range of frequencies used in television systems, inductance effects do 
not yet play a role. 
In oscilloscopes, on the other hand, electric fields have been widely 
used since the deflection plates draw little or no current and only at very 
high frequency does the displacement cease to follow the signal. In magnetic 
systems, particularly in those with ferrite shielding, the inductance of the 
device begins to cause problems at much lower frequencies. In spite of this, 
magnetic systems are almost exclusively used in scanning microscopes since 
their deflection aberrations can be kept small; electric deflection is often 
included for beam blanking, that is, switching off the illuminating beam 
by abruptly deflecting it sideways so that it no longer passes through some 
centred aperture. Magnetic systems are also usually adopted in lithography 
devices, though electrostatic and hybrid arrangements are of interest for 
particular purposes. 
In the electrostatic case, deflectors usually consist of pairs of plates, 
symmetrical about a plane through the optical axis. They may have a wide 
variety of shapes, ranging from simple rectangles parallel to each other to 
tilted or curved surfaces. Some typical designs are illustrated in Fig. 32.1. 
A more advanced design consists of a family of eight or 12 plates, arranged 
symmetrically around the axis and forming sectors of a cylindrical surface 
(Fig. 32.2). By choosingthe electrode potentials appropriately, not only 
can deflection at an arbitrary azimuth be achieved but the aberrations can 
also be partially corrected. 
In the magnetic case, two geometries are common: 
saddle coils and 
toroidal coils. Saddle coils (Fig. 32.3) are usually enclosed in a ferrite 
sheath, thereby reducing the wastage of flux. The shielding is omitted only 
in devices designed to function at high deflection frequencies in order to 
decrease the inductance. In toroidal structures (Fig. 32.3b,c) the turns of 
the two individual coils are wound meridionally, or in other words, length- 
wise around a ferrite yoke, which may have a more complicated shape than 
a simple cylinder or cone (Fig. 32.3d). This is especially true of television 
tubes, where distortions must be kept very small. In these, hybrid schemes 
are often used; Fig. 32.4 illustrates a deflection system in which the ver- 
tical deflection is achieved by means of toroidal coils while the horizontal 

32.1 INTRODUCTION 
485 
b 
Fig. 32.1: (a)-(d) Cross-sections through electric deflectors of various kinds; the flared 
design (c) is frequently employed. (e) Perspective view of an electric deflector with flared 
plates. 
0 
Fig. 
32.2: Simplified drawing of an electric 12-pole deflector. 
The outer screening 
cylinder is omitted in the perspective view (right). 

486 
32. DEFLECTION SYSTEMS AND THEIR ABERRATIONS 
6"----Z ~, 
. _  
- 
\<, ~-- --¢~ 
/ 
)~---- ~- ~--.--__¢ 
/ 
..J 
\ 
L 
J 
i 
t" 
I 
I 
I 
I 
I 
I 
I 
I 
I 
I 
z 
I 
i 
i 
1 
i 
I 
I 
I 
__1. __ 
~ 
t 
I 
I 
I 
I 
c 
d 
Fig. 32.3: Different types of magnetic deflector. (a) Windings in a pair of saddle coils. 
(b) Windings in a pair of toroidal coils. (c) Axial section through a pair of toroidal coils 
wound round a conical yoke. (d) Axial section through a ferrite cone in a television tube; 
part of the tube wall is indicated. 

32.2 THE PARAXIAL OPTICS OF DEFLECTION SYSTEMS 
487 
I 
V 
/-/ 
Fig. 32.4: Hybrid system consisting of saddle coils for the horizontal deflection (H) 
and toroidal coils for the vertical deflection (V). On the optic axis, the magnetic field 
generated by the saddle coils is in the vertical direction while that created by the toroidal 
coils is horizontal. 
deflection is produced by the shielded saddle coils. The former have smaller 
aberrations, the latter lower inductance. 
These introductory remarks can give only a preliminary impression 
of the host of deflection systems in practical use. More technical details 
will be found in Chapter 40. We now develop the corresponding theory of 
paraxial properties and aberrations. 
32.2 The paraxial optics of deflection systems 
The study of the optics of deflection systems passes through essentially the 
same stages as those already encountered for round lenses or quadrupoles; 
the novel aspects arise from the new symmetry conditions. Hitherto, we 
have considered systems in which an electron travelling along the straight 
optic axisDthe axis of rotational symmetry of round lenses and the line 
of intersection of the symmetry or antisymmetry planes in quadrupole 
systems---experienced no transverse force. Terms of odd degree in x and y 
were thus excluded from the expansions (7.36) for (I)(r) and (7.45) for Az, 

488 
32. DEFLECTION SYSTEMS AND THEIR ABERRATIONS 
as were terms of even degree from Ax, Ay in (7.43-7.44). 
In this section, we first derive the most general form of the paraxial 
equations and then specialize these to the cases of practical importance. 
Just as for round lenses and quadrupole systems, these equations can be 
obtained in two equivalent ways, namely, by using the trajectory method or 
the eikonal method. Here we use the trajectory method, which is convenient 
for the paraxial theory; the eikonal method is presented in detail by Glaser 
(1952, 1956), Kaashoek (1968) and Ximen (1986). 
32.2.1 The general paraxial equations 
The paraxial equations for an arbitrary system with a straight optic axis are 
easily obtained by linearization of (3.22). Reduction to linear form implies 
that ~ = 1 from (3.16), and Bt = B~ from (3.i9). A nontrivial simplification 
arises from the fact that there is a linear relation between the transverse 
deflection field strengths at the optic axis and the coordinates xi, yi of the 
trajectory in a given recording plane z = zi, as will become obvious later. 
The axial values of E~ = -q~l~, Ey = -ely, Bx and By are thus to be 
considered as linear quantities, though this is not explicitly obvious from 
the corresponding series expansions. We may therefore replace ~(r) in the 
denominators of (3.22) by its axial value ¢(z) and V~ by (1 + 2e¢)V¢(r). 
Bringing all this together, we obtain 
• " = 
- 
+ 
- 
y'B 
) 
y" = 
- 
+ 
(-B, 
+ 
(32.1) 
Differentiating (7.36) and retaining only terms that are of linear order when 
substituted into (32.1), we find q~lz = ¢'(z) and 
lt 
~1~ = -F1 - -~x + xp2 + Yq2 
.ell 
ely = -F2 - -~y + xq2 - yp2 
(32.2a) 
The linear terms of B (7.46-7.48)are given by Bz = B and 
x B'- P2x -Q2y 
Bx 
- 
B1 - 
Y 
i 
By - B2 - ~B -Q2x -4- P2y 
(32.2b) 
All this is now to be introduced into (32.1). The result of these elementary 
calculations takes a very concise form if the following complex quantities 

32.2 THE PARAXIAL OPTICS OF DEFLECTION SYSTEMS 
489 
are introduced: 
w := x + iy 
(32.3a) 
FT(Z) := F1 + iF2 
(32.3b) 
BT(Z) := B1 + iB2 
(32.3c) 
QE(Z) := p2 + iq2 
(32.3d) 
QM(Z) := P2 + iQ2 
(32.3e) 
These have the following physical meaning: w is the transverse coordi- 
nate, FT and BT are the complex transverse axial field strengths, while 
Q E and Q M are quadrupole coefficients. Quadrupole terms are not intro- 
duced deliberately in deflection systems but may arise from constructional 
imperfections. Using (32.3), an elementary calculation yields 
w"(z) - A1 w* 4- A2w + A3w' "4- A4 
(32.4) 
the coefficients being given by 
A1 = 
7 QE "4- irl¢-½ QM 
(32.5a) 
A2 = 
3" ¢" 
i 
^ 
B' 
4 6 + ~r/¢-½ 
(32.5b) 
A3 -- 
7 ¢' 
- 
+ ir/q~--} B 
(32.5c) 
25 
A4 = 
7 FT 
irl¢- ½ BT 
(32.5d) 
The complex linear differential equation (32.4) is seldom solved in full gen- 
erality, though its numerical solution provides absolutely no problem. The 
reason is that an electron optical system of so general a type is very rarely 
encountered in practice. We now turn to the important special cases. 
First of all, a round electrostatic lens is never combined with electro- 
static elements of lower symmetry in such a way that the fields overlap, 
since the boundary conditions governing the electric field on the electrode 
surfaces do not allow this (although round lens components can of course be 
generated by elements such as quadrupoles, suitably excited). Round elec- 
trostatic lenses well separated from any other elements are better treated 
independently by the methods outlined earlier and we hence ignore them 
here. 
A second simplification concerns the term A1 w* in (32.4), which may 
be neglected. Such a term would cause axial astigmatism, which can be 

490 
32. DEFLECTION SYSTEMS AND THEIR ABERRATIONS 
compensated by means of stigmators; in practice, therefore, this term is 
always negligible. Stigmators are dealt with in Section 32.4; we say no 
more about them here and assume forthwith that A1 (z) - 0. 
The combination of round magnetic lenses and deflection units is com- 
mon in electron lithography systems, but advantageous only under very 
special conditions, as will become obvious later. If these conditions are 
not satisfied, it is better to remove the round lens from the deflection field 
region since its presence destroys the electron optical symmetry properties 
of the deflection unit. In order to establish these properties, we omit the 
magnetic lens in the first step. 
32.2.2 Ideal deflection 
With all these simplifying assumptions, (32.4) and (32.5) reduce to 
w"= D(z) 
(32.6) 
where 
D(z) - A4(z) = -
~
 
7FT(z) 
_ i~¢-½ BT(Z) 
(32.7) 
2~ 
in which ¢ is now a constant. Equation (32.6) is readily integrated, the 
solution with the general initial conditions 
W f 
I 
~(~o) = ~o, 
(~o) = ~o 
being given by 
w(z) = Wo + (z - Zo)W'o + ~d(Z) 
with the particular solution 
(32.8) 
z 
Wd(Z) = /(z- z')D(z')dz' 
Za 
(32.9) 
This is easily verified. The solution (32.9) is of particular interest since it 
describes the trajectory of a particle incident along the optic axis, so that 
(32.9) is the equation of a curved axis representing the central ray of a 
deflected beam. The most important property of Wd(Z) is its asymptotic 
behaviour for large values of z beyond the domain of the deflecting field. 
This is given by 
oo 
c~ 
(32.~0) 

32.2 THE PARAXIAL OPTICS OF DEFLECTION SYSTEMS 
491 
The limits of integration have been extended to infinity, which is justified 
if D(z') has appreciable values only in a finite interval and the coordinates 
Zo and z are located outside the latter. In practice this simplification is 
always permissible. 
Equation (32.10) describes a straight line, the asymptote of the de- 
flected principal ray. In general this does not intersect the optic axis: it is 
a skew ray. This is easily seen by writing (32.10) in real form: 
(X) 
OO 
--00 
-- 00 
oO 
O0 
yd(z) -- z / 
Dy(zl) dz I- / 
zlDy(zl) dz I 
-- (:~ 
-- (X) 
(32.11) 
This can be cast into the form 
= 
-- Zl) 
yd(Z) 
= 
-- 
f 
with the asymptotic slopes 
(32.12) 
C~ 
O0 
(32.13) 
and pivot-point coordinates 
f zD~(z)dz 
f zDy(z) dz 
Zl = 
, z2= 
(32.14) 
c~ 
oo 
f D~(z) dz 
f Dr(z )dz 
The latter depend only on the geometric forms of the function D,(z) and 
Dr(z), not on their absolute values. In the general case, these forms are 
different and, hence Zl ¢ z2. Figures 32.5a,b illustrate this for an electro- 
static deflection system, of the type employed in oscilloscopes. 
The general solution (32.8) represents the linear superposition of the 
principal ray solution wd(z) and a free-space motion Wo + (z - Zo)W' o. A 
consequence of (32.8) is that if there is stigmatic focusing in the absence 
of deflection (Wd -- 0), this remains true with deflection; there is only a 
lateral shift of the focus. Let us assume that with no deflection, the image 

492 
32. DEFLECTION SYSTEMS AND THEIR ABERRATIONS 
B
n
m
~
 
z 
Lens 
t 
x 
zl 
zi 
Fig. 32.5" (a)-(b) Principal sections through an electric deflection system. (a) x-z 
plane; (b) y-z plane. (c) Schematic description of the 'ideal' deflection in the x-z plane; 
the situation in the y-z plane is analogous. 
is a point (5i, Yi) in the plane z = Zi: Wd(Z) =-- O, W(Zi) = Wi irrespective 
! 
of w o, as is sketched in Fig. 32.5c. The initial values in the plane z = Zo 
in front of the deflection unit must satisfy the condition 
W o + (Zi- Zo)Wto = Wi 
Substituting this into (32.8) we find 
W(Z) = (Z -- Zi)Wlo + Wd(Z) "Jr" Wi 
(32.15) 
In the plane of the focus, z = zi, we then have 
Wi :: W(Zi) -" Wd(Zi)"4- Wi 
(32. 6) 

32.2 THE PARAXIAL OPTICS OF DEFLECTION SYSTEMS 
493 
! 
! 
or in real form, with the abbreviations x i = X'd(C¢), Yi = Y'd(C¢), 
} 
Xi --" Xi(Zi 
-- Zl ) 4- "Xi 
I 
Yi = Yi(Zi -- Z2) 4- Yi 
(32.17) 
! 
! 
irrespective of the initial slopes x o, Yo. This is characteristic of ideal de- 
flection and illustrated in Fig. 32.5c. 
32.2.3 The dependence on the electrical input signals 
The input signals for deflection systems are time-dependent capacitor volt- 
ages or coil currents, which generate the necessary deflection fields. Pro- 
duction of the appropriate time dependence of the signals may be a major 
technical problem, but this does not concern us here. The inertia of the 
electron beam and the contributions of the Maxwell-displacement terms 
to the field equations can always be neglected. The time is thus a mere 
parameter, and a quasi-stationary approximation is quite sufficient. There 
is no need to study any time-dependent effects here. 
The axial electric field strengths F1, F2 are proportional to the corre- 
sponding deflection voltages U1, U2 at the capacitor plates: 
Fj(z) = Ujaj(z) 
, 
j = 1,2 
(32.18) 
The functions aj(z) depend only on the geometric forms of the axial field 
distributions and have the dimension of a reciprocal length. The axial mag- 
netic field strengths B1, B2 are likewise proportional to the corresponding 
coil currents/1, I2: 
Bj(z) = #oIjbj(z) 
, 
j = 1,2 
(32.19) 
The permeability #o has been introduced for dimensional reasons: bl and 
b2 also have the dimensions of a reciprocal length. 
Let us first consider systems with no round magnetic lens term. We 
rewrite (32.7) in real form and introduce (32.18) and (32.19), giving 
Dx -- 
7al(z) U1 4- #or/b2(z) 
D, = 
7a2(z) U2 - #07/bl(z) 
(32.20) 
We see that there is indeed a linear relation between the input signals and 
the deflection functions D,, Dy, but not a simple one. If we introduce 

494 
32. DEFLECTION SYSTEMS AND THEIR ABERRATIONS 
(32.20) into (32.13) and (32.14), and then substitute the resulting expres- 
sions into (32.17), we certainly obtain linear relations between the input 
signals U1, U2, /1, /2 and the corresponding deflections xi, yi, as we as- 
sumed at the outset, but these linear relations are often too complicated 
for practical applications. We recall that the functions aa(z), a2(z), bl(z), 
b2(z) are in general different from one other, and the same may also be true 
of integrals over these functions. 
In practice, apart from very special applications like Wien filters, com- 
bined electric-magnetic deflection systems are of rare occurrence though 
the possibility of using magnetic deflection for large shifts and electrostatic 
fields for small deflections has been explored in lithography. We first spe- 
cialize to the pure cases. 
In purely electric deflection systems, (32.14) become 
f ~.i(z) dz 
zj = -OOoo 
, 
j = 1, 2 
(32.21) 
f ~i(z) dz 
and (32.17) then take the form 
xi = dEU1, 
y, = d~ U2 
(32.22) 
with the proportionality factors 
C~ 
fa, z .z, 
j - 1, 2 
(32.23) 
These factors are called the 
sensitivities and have the dimensions of a 
reciprocal field strength. Even though Zl ~t z2 (see Fig. 32.5), the condition 
d E = d E can be satisfied by appropriate choice of the functions aj(z), and 
in practice this can be achieved by suitable design of the deflection plates. 
The response is then iso~ropic. Whether this is necessary depends on the 
particular purpose of the device in question. 
In the case of purely magnetic deflection systems, the formulae are 
analogous; it is only necessary to modify certain factors, signs and sub- 
scripts. Equation (32.14) may be written 
O0 
f zbj(z)dz 
~ 
00 
zj = 
oo 
, 
j = 1, 2 
(32.24) 
f bj dz 

32.2 THE PARAXIAL OPTICS OF DEFLECTION SYSTEMS 
495 
The change of sign in (32.20) here cancels out. The response relations take 
the form 
z, = dM I=, 
Y, = --dM I~ 
(32.25) 
with the sensitivities 
OO 
= 
- 
] b,(z)dz, 
J 
1,2 
(32.26) 
--OO 
Once again, the sensitivities can be made equal by appropriate design of 
the deflection coils, even if the functions b~ (z) and b2(z) are different. The 
case bl (z) # b2(z) certainly occurs in television tubes equipped with hybrid 
deflection systems (Fig. 32.4). 
32.2.4 Rotation-invariant systems 
We now examine the effect on the electron optical properties of superim- 
posing a round magnetic field on a purely magnetic deflection system, a 
situation that occurs in lithography devices. In this situation, (32.4) and 
(32.5), in combination with (32.19), become 
1 B, 
w" = iy¢-~(~ 
w + Bw') + D(z) 
(32.27) 
in which the inhomogeneous term D(z) takes the form 
D(z) = -i#0y¢-½ {Ilbl(z) + iI2b2(z)} 
(32.2s) 
In the theory of round magnetic lenses, it is advantageous to introduce 
the familiar coordinate frame rotating with the Larmor frequency. In the 
present case, however, it is no longer obvious that this is advantageous since 
the natural symmetries of the series expansion for the magnetic deflection 
field would be destroyed. For this reason, we shall continue to use the fixed 
(cartesian) frame (X, II, z), which we here denote (x, y,z). This causes no 
particular complication. We note that this choice is not mandatory, and 
some authors have pursued the calculation in the rotating frame. 
We must now solve (32.27) for arbitrary initial conditions W(Zo) = To, 
w'(zo) = w', in some given object plane. The fundamental solutions a(z) 
and r(z) of the homogeneous differential equation with the initial conditions 
a(Zo) = r'(zo) = 1, 
a'(Zo) = r(zo) = 0 
(32.29) 
and the Wronskian 
Wo = e-2i°(Z)(r'a - a'r) = r'a* - a'r* - 1 

496 
32. DEFLECTION SYSTEMS AND THEIR ABERRATIONS 
are now appropriate, 0(z) being the angle of Larmor rotation (2.39, 15.9); 
the functions a(z), r(z) are now complex. Solution of (32.27) by variation 
of parameters is straightforward and we find 
w(z) = Wo ,(z) + W'or(Z) + 
with the particular integral 
(32.30) 
z 
Wd(Z) = /e-2i°(C')D(~){a(~)7"(z) - v(~)a(z)} d~ 
go 
= ] D((){a*(()r(z) - r*(()a(z)} d( 
So 
(32.31) 
The value of this solution in the image plane z = zi is the most important. 
There we have r(zi) = 0 and a(zi) = M exp(i~i), 8i = 8(zi) being the angle 
of image rotation relative to the object. Hence, 
zi 
Wd(Zi) -- -Me iO' / D(z)T*(z) dz -" Wdi 
2;0 
It will prove convenient to introduce the real fundamental solution h(z) in 
the rotating frame, with h(zo) = O, h'(zo) = 1 as usual. From (32.29) with 
O(zo) = 0, we see that 
T(Z)-- 
h(z)e iO(z) 
and so 
zi 
Wdi= -Me i°' / e -i0(z) D(z)h(z) dz 
go 
(32.32) 
We notice that, since r(zi) = 0, the paraxial deflection is again ideal, in 
the sense that the general solution w(zi) = Woa(Zi) + Wdi is independent of 
' 
Equation (32.28) shows that it also depends linearly on the currents 
W 0 • 
11 and/2. In the general case, however, it is not rotation-invariant. This 
means that if we apply the coil currents 
/1 = I0 cos a 
, 
I2 = I0 sin a 
(32.33) 
with a time-dependent phase a, intending to trace out a circle, the deflec- 
tion signal (with Wo = 0) does not in fact respect this but instead describes 
an ellipse. This effect is called the parazial distortion. 
In order to obtain 

32.3 THE ABERRATIONS OF DEFLECTION SYSTEMS 
497 
a circle, the deflection signal Wdi, given by (32.32), must be proportional 
to the complex current variable Ic, 
/c "= I1 + ii2 = Ioe i~ 
This proportionality can only be achieved if 
(32.34) 
zi 
zi 
/ e-i°bl(z)h(z) dz - / e-i°b2(z)h(z) dz 
Zo 
Zo 
(32.35) 
When different types of coil systems are combined, in hybrid toroidal- 
and saddle-coil systems for instance, this condition is in general not satis- 
fied. Even if (32.35) is true for a particular lens excitation, a slight variation 
of the latter to adjust the focusing renders the two integrals unequal. The 
only reasonable way of satisfying (32.35) in general is hence to impose the 
condition bl(z) - b2(z), which means that the coils, rotated at 90 ° to each 
other, must have the same geometry. Systems of this type are rotation- 
invariant. They are the only reasonable choice when a deflection field is 
to be combined with a magnetic round lens field and, in our discussion of 
aberration theory, we shall consider only this case. 
We can then drop the suffices of bl(z) and b2(z); combining (32.32) 
with (32.28), we find 
Wdi = dcIc 
(32.36) 
in which the complex sensitivity is given by 
zi 
de = ip0r/¢-½ Me i°' / e-i°(Z)b(z)h(z) dz 
2;0 
(32.37) 
The modulus of this complex quantity is of great technical importance, 
whereas the phase is not important since it merely describes a constant 
rotation between the input and output signals. 
32.3 The aberrations of deflection systems 
In this section, we again distinguish between systems with pure deflection 
fields and hybrid systems containing a round magnetic lens because the 
symmetry properties in these two situations are essentially different. We 
concentrate on the nature of the aberrations, referring to the original pub- 
lications for the full lists of aberration integrals for the following reasons: 

498 
32. DEFLECTION SYSTEMS AND THEIR ABERRATIONS 
in the more general case, the terms are extremely numerous whereas in the 
simpler cases of pure deflection fields, only a few of the aberration integrals 
have found practical use. We do, however, reproduce one set of aberration 
integrals, which is particularly convenient in that the expressions required 
in many practical situations can be obtained as special cases. 
32.3.1 Pure deflection systems 
The most important technical devices employing this kind of deflector are 
oscilloscopes and television tubes. These do of course also contain elec- 
trostatic lenses to focus the beam on the viewing screen but these lenses 
are well separated from the deflectors, and have little effect so far as the 
deflection aberrations are concerned. The situation in scanning electron 
microscopes is more complicated. For medium and high resolution oper- 
ation, the deflection structure most commonly used, the double deflector, 
can be situated far enough before the lens for the field overlap to be negli- 
gible. If, however, the microscope is designed to produce a good image at 
very low magnification where the angles involved become large, it will be 
necessary to place the the deflector within the lens field and the situation is 
that discussed in Section 32.3.2, always recalling that the deflector precedes 
the probe-forming lens. The so-called Grigson coils that are used to scan 
a diffraction pattern over a small detector do, on the other hand, belong 
to the present section. 
For simplicity, we shall assume that the undeflected beam is directed 
along the optic axis and produces a round spot, blurred by spherical and 
chromatic aberrations. When the beam is deflected, the aberration coordi- 
nates Axi, Ayi of a particular ray in the undeflected beam can simply be 
added to the corresponding deflection aberration components. 
Two different symmetric8 
Devices that fall into this category are always constructed so as to have 
two orthogonal planes of symmetry, intersecting along the optic axis within 
the limits of experimental accuracy. We have already tacitly assumed this 
in Sections 32.2.2 and 32.2.3, where these symmetry planes were the coor- 
dinate planes x = 0 and y = 0. 
In magnifying systems, it is usually the object plane that is of interest 
and the aberrations are therefore most usefully expressed in terms of po- 
sition and gradient in that plane or in terms of position in the object and 
entrance pupil planes. In probe-forming and other demagnifying systems, 
on the other hand, the plane of interest is the target or image plane and the 
most suitable variables for characterizing deflection aberrations are there- 
fore the position coordinates xi and yi corresponding to ideal deflection, 
introduced earlier, and the paraxial difference of gradient between that of 
the ray in question (gradient x~, y~) and the deflected central ray (gradient 

32.3 THE ABERRATIONS OF DEFLECTION SYSTEMS 
499 
x(0), 
. (0),~ 
, 
_(0), 
, 
(0), 
i 
, Yi 
); we write c~ "= x i - x i 
, fl := Yi - Yi 
• 
The lateral aberrations Axi and A y i can be derived from a perturba- 
tion eikonal, which we denote as in Part IV by S. The symmetry properties 
impose the following conditions on S(xi, yi, o~, fl): 
s(-=i, w,--,/~) = s(=~, w,-, Z) 
s(=i,-w,-,-/~) 
= s(=i, w,-,/~) 
(32.3s) 
These are the same symmetry properties as those we have encountered for 
well-aligned systems of quadrupole lenses. At first sight, this is surprising, 
since in quadrupoles the potentials are positively symmetric with respect to 
the symmetry planes, while in deflection systems they are antisymmetric. 
We must, however, remember that the deflection input signals are not fixed 
constants, but proportional to xi and yi respectively. 
From (32.38) it can be concluded that S will contain aberration terms 
of even order only, the lowest order being characterized by terms of fourth 
degree. We can simply adopt the classification investigated in Chapter 29 
without further ado; the cartesian representation of the transverse aberra- 
tions is given by (29.12) if we exchange the variables as follows: 
! 
! 
~o --+ xi, 
770 --+ Yi, 
x o ~ 
a, 
Yo -"* fl 
One additional simplification arises from the condition that, when the de- 
flection fields are switched off (xi = Yi = 0), the aberration must collapse to 
the spherical aberration of a round lens and hence C := (0030) = (0012) = 
(0003) = (0021)in (29.12). 
We now introduce a simplified notation, in terms of which the per- 
turbation eikonal has the basic form 
1(E1 
4 
2E12x 2 2 
E 
4 
S = -~ 
lXi + 
Yi + 
22Yi) 
2 
2 
2 
2 
+ axi(Dxl xi + D12yi ) + ~yi(D21xi 
+ D22yi ) 
012 
f12 
2 
2 
2 
6' 
2 
~2)2 
+ A3ol/3xiYi + --~(ol + 
xio~ 
°L 2 
~~_ 
~2 
152 
+--~(Kl1 
+3K12~ ~)+ 
(3K~1 +K~ 
) 
(32.39) 
There are three phase shifts (Ejk), four distortions (Djk), five astigmatisms 
(Ajk), disregarding differences between these and the field curvature, four 
comas (Kjk) and the spherical aberration (C). Since the phase shifts (Ejk) 

500 
32. DEFLECTION SYSTEMS AND THEIR ABERRATIONS 
do not contribute to the lateral aberrations, 14 relevant real independent 
terms remain. 
The function S can be normalized in such a way that the lateral aber- 
rations are simply given by 
OS 
0$ 
Axi- 
COa' 
Ayi = ~ 
(32.40) 
Differentiation of (32.39) then gives 
Axi - xi(Dll x 2 4" D12Y 2) 
2 
2 
+ c~(All x i + A12Yi ) + A3~xiyi 
4" xi(KllOL 2 4" gl2fl 2) 4" 2K21YiOlfl 
+ 
+ 
(32.41a) 
2 
2 
AYi = yi(D21xi + D22Yi ) 
2 
+ fl(A21x i + A22Y 2) + A3olxiYi 
+ yi(K21ot 2 + K22fl 2) 4- 2K12xiolfl 
+ 
+ 
(32.41b) 
Fourfold symmetry 
A further simplification is obtained if the two symmetry planes x = 0 
and y = 0 are equivalent, in the sense that the system is invariant under 
rotation through 90 ° about the optic axis. This means that interchanging 
x and y (x ~ y) and c~ and fl (or ~ fl) must leave the formulae unaffected, 
which in turn implies that for all sets of coefficients, 
~11 "-- )~22, 
~12 = )~21 
(32.42) 
where )~ stands for each of E, D, A and K. 
In order to reveal the physical meaning of the surviving coefficients, it 
is helpful to introduce complex and polar position and angular coordinates 
thus: 
Wi "-- Xi + iyi = ri el~ 
s "= c~ + ifl = ae i~" 
(32.43a) 
(32.43b) 
On expanding (32.39) as a Fourier series with respect to the azimuths ~i 

32.3 THE ABERRATIONS OF DEFLECTION SYSTEMS 
501 
and ~,, we find 
1 4 
s = ~ (Eo + E4 ¢o~4~) 
+ ar~ {Do cos(~, - ~i) + D4 cos(3~pi + ~,) } 
1 2 2 {A0 cos(2~ 
2~i) + A4 cos(2~i + 2~a)} 
+ -~tr r i 
a -- 
1 
+ ¢",~{g0 ~o~(~, - ~) + 5K~ ~os(~ + 3~,)} 
1 
22 
1 
+ -~Foa r i + -4Coa 4 
in which 
E0 = l(3EI1 + E12), 
Do = 4(3Dll + D12), 
1 
Ao = ~(All - A12 + A3), 
1 
K0 = ~(Kll + K12), 
1 
F0 = ~(All + A12), 
1 
E4 "- ~(Ell - El2) 
1 
94 = ~(Dll - D12) 
1 
A4 = ~(All - A12 - A3) 
1 
K4 = ~(Kll - 3K12) 
Co-C 
(32.44) 
(32.45) 
The transverse aberrations are now obtained by forming the gradient in 
complex polar coordinates: 
OS 
.OS = ei~o. ( O 
i ~) 
Awi= ~ 
+ ,~-~ 
Oaa + -a 
S 
(32.46) 
the result being 
3 
Awi = r i (Doe '~i + D4 e-3i~`) 
2a(Aoei(2'ai-~") + A4 e-i(2~i+9")) 
+ri 
2aF0ei~* + 2a2rigo ei~i 
(32.47) 
+ri 
+ ria2(goe i(2~*-~`) + gle -i(2~°*+~°i)) 
+ o .3 Coei~* 
or in the general complex form with (32.45): 
2 • 
.3 
Awi -- Dow i wi + D4wi 
• 2 
* 
+ Aow~s* + 24_4wi a 
+ Fowiw~s + 2Koss*wi 
(32.48) 
+ Kos 2 * 
, 
W i -{" K4 s*2 wi 
+ Cos 2s* 

502 
32. DEFLECTION SYSTEMS AND THEIR ABERRATIONS 
( 
Fig. 32.6: Various combinations of fourfold aberrations and defocus values. 
Apart from the choice of notation and the limitation to systems without 
superimposed magnetic lens fields, this is the representation which has 
long been known and has been explored in great detail in connection with 
electron lithography devices (Munro, 1974; Goto and Soma, 1977). 
In 
comparison with the aberrations of round lenses (see 24.36-24.37), there 
are three new types of error, those indicated by the subscript 4; these 
are known as fourfold errors and in particular as fourfold distortion (O4), 
astigmatism (A4) and coma (K~). This nomenclature reflects the behaviour 
of these aberrations when the entire system is rotated bodily about the optic 
axis. Let us substitute ~i = ~ + ¢ and ~a = ~" + ¢ in (32.47). It quickly 
becomes clear that all the isotropic aberration terms, labelled with the 
subscript zero and familiar from the theory of round lenses, are modified 
by a common factor exp(i¢), which means that these lateral aberrations 
rotate in synchronism with the system, just as in round systems. The 
fourfold error terms, on the other hand, are modified by a common factor 
exp(-3i¢), and their rotation relative to the system is therefore described 
by a phase factor exp(-4i¢). 
The pure fourfold errors have fourfold symmetry; some typical exam- 
ples are shown in Fig. 32.6. In practice, however, such symmetric error 
figures are never obtained. The complex superposition of all the terms ap- 
pearing in (32.47) or (32.48) can result in quite complicated asymmetric 
patterns. The possibility of designing electrostatic deflection electrodes free 
of fourfold aberrations is examined by Dodin (1983). 

503 
a 
32.3 THE ABERRATIONS OF DEFLECTION SYSTEMS 
1 
Fig. 32.7: Deflection distortions. (a) Cushion; (b) barrel; (c)-(d) hammock. 
General considerations 
Although the classification of the possible error types in deflection sys- 
tems is an intellectually pleasing and somehow beautiful task, the deter- 
mination of the corresponding aberration coefficients is very laborious. In 
principle, the calculation is strkightforward, whether the trajectory method 
or the eikonal method is employed, and formulae for the various coeffi- 
cients have been derived by Glaser (1938, 1941, 1949, see 1952), Wendt 
(1939, 1942a,b, 1947, 1953), Picht and nimpan (1941), Picht (1943) and 
Hutter (1947, 1948). They were subsequently reconsidered by Haantjes 
and Lubben (1957, 1959), by Kanaya (Kanaya and Kawalmtsu, 1961a,b, 
1962; Kawakatsu and Kanaya, 1961; Kanaya et al., 1961, 1963, 1964) and 
especially by Kaashoek (1968) and re-examined by Ding (1982). We shall 
not, however list them here as they are not much used in practice. For 
numerical values, see Wang (1966,1967a-c, 1971) and Amboss and Wolf 
(1971) as well as the papers cited above. 
In television devices and oscilloscopes the deflection angles can become 
quite large, since the viewing screen must have a given minimum size and 
the tube-length must be kept reasonably small. For such large angles a 
perturbation theory of third order is clearly insufficient, but the practical 
evaluation of error terms of higher than third order by means of the stan- 
dard perturbation calculus becomes extremely laborious. The fifth-order 
aberrations are examined by Kaashoek (1968) but it is arguable that if a 
knowledge of the third-order aberrations is insufficient, it is better to aban- 
don perturbation theory and adopt the exact ray-tracing methods outlined 
in Chapter 33. 
In electron lithography devices, the off-axis distances and deflection an- 

504 
32. DEFLECTION SYSTEMS AND THEIR ABERRATIONS 
D 
Fig. 32.8: Deflection astigmatism (the deflection is shown in only one symmetry plane); 
G: Gaussian image plane; T, M, S: tangential, mean and sagittal image curvature; D" 
principal plane of deflection. 
gles remain small enough for the third-order approximation to be adequate 
but, in such systems, a round magnetic lens is usually strongly coupled to 
the deflection. The classification given above is then incomplete. This is 
the subject of the next section. 
Before leaving the present topic, we briefly discuss how systems with 
large deflection angles can be investigated. It is unreasonable to analyse all 
the aberrations of fifth and even higher order, since the number of terms 
becomes unmanageable. The discussion must be confined to the technically 
most important defects, which are clearly the distortions and, with lower 
priority, the astigmatisms (see Figs 32.7, 32.8). Since fourfold symmetry 
is not always present, a more general form of (32.41) is required. For the 
distortions of third and fifth order, we may write 
2 
2 
DlaX 4 
2 2 
Axi -- xi(DllX i "l- D12Yi + 
+ 2D14xiYi + D15Y~) 
2 
2 
x 4 
2D24x~y~ 
D25y~) 
Ayi -- yi(D21xi + D22Yi + D23 i + 
+ 
(32.49) 
The coefficients in these expansions can be determined by exact numerical 
calculation of a sufficiently large number of electron trajectories followed 
by a least-squares fit of (32.49) to the set of numerically determined aber- 
rations (Axi, Ayi). 
32.3.2 Deflection systems with magnetic lenses 
We now study the influence of a round magnetic lens field on the deflection 
aberrations. As we have already mentioned, this is of great importance 

32.3 THE ABERRATIONS OF DEFLECTION SYSTEMS 
505 
in the theory of electron lithography devices. The practical necessity for 
superimposing deflection and lens fields will be discussed in Chapter 40. 
Geometric aberrations 
We again begin by classifying the permitted types of aberrations. As 
we have seen in Section 32.2.4, only systems with a fourfold geometric sym- 
metry of the coil system are advantageous, since the device will otherwise 
exhibit a paraxial distortion. In contrast to the case treated in the pre- 
ceding section, the planes x = 0 and y = 0 are no longer planes of mirror 
symmetry, since the round magnetic lens forces the beam to rotate about 
the optic axis. There thus remains only an invariance of the eikonal with 
respect to rotations through 90 ° about the optic axis. Instead of (32.38) 
we have 
S(w,-xi, ~,-,~) = S(~, w, ,~, ~) 
(32.50) 
~(--Xi, --Yi, --OZ, --fl) --- ~(Xi, Yi, Or, ~) 
From the second property it can be concluded that the power series ex- 
pansion of S can have only terms of even total order, the interesting ones 
being again those of fourth order. The first condition expresses the fourfold 
symmetry. 
The mathematical form of the perturbation eikonal S is most easily 
obtained by a Fourier series expansion similar to (32.44). Only terms that 
are invariant with respect to the simultaneous transforms q0i = ~O~ + 71"/2 
and qoa = qo~ + 7r/2 can occur in this expression. Furthermore, terms higher 
than fourth order need not be retained. The only permissible trigonometric 
dependences are then 
cos n(~aa - ~i), 
sinn(~a - ~i), 
n = 0,1,2 
together with the cosine and sine of the arguments 
4qoi, 
3qoi + qOa, 
2qoi + 2~oa, 
~i + 3~oa, 
4qOa 
the sum of the factors of ~i and ~a being always 4. In (32.44) only the 
cosine terms were obtained, since only these are compatible with (32.38) 
and (32.50). If (32.38)is given up, the corresponding sine terms are also 
permitted. A fourfold spherical aberration, given by the terms in 4~a, is 
compatible with the symmetries, but is excluded for technical reasons, since 
the ordinary spherical aberration of the round lens must be obtained when 
the deflection currents are switched off. 
We now have to complete the Fourier series expansion (32.44) by in- 
cluding the appropriate sine terms. The resulting expression can be cast 

506 
32. DEFLECTION 
SYSTEMS 
AND THEIR 
ABERRATIONS 
into a more concise form by introducing a complex notation. For this pur- 
pose we define the following complex aberration coefficients: 
Do = Do + ido, 
.4o = Ao + i ao, 
Ko = Ko +iko, 
/~4 -" E4 q-ie4 
D4 = D4 + id4 
A4 = A4 -4-ia4 
/~"4 --" K4 -'F ik4 
(32.51) 
The real parts denote isotropic coefficients, while the imaginary parts rep- 
resent anisotropic ones. Then, instead of (32.44), we have 
[14 
S = ~ ~r i (Eo + E,4 exp(-4iqoi) 
+ ar3 {/)o exp(iq0i - iqaa) +/)4 exp(-3i~i -- iqaa)} 
1 
2{Ao exp(2kpi 
2i~a) + A, exp(-2i~i - 2i~a)} 
2 
(32.52) 
+ -~tr r i 
+ ~r3ri{fff, oexp(itpi - itpa) + 31(4exp(-i~Pi - 3i~pa)}] 
1 
1 
or r i q--~Co 
.~_ ~F0 
2 2 
0.4 
After some elementary calculations, differentiation of (32.52) using (32.46) 
gives the geometric aberrations (suffix g) 
• 
*3 
Awg 
=. C0,_q2,5 * --1- L)oW2Wi + L)4wi 
~ 
*2 
* 
+ Fowiw*s -f- Aow2s * 4- A4w i s 
~ 
r%, 2 
* 
/~48.2 
* 
+ 2Koss*wi + lXoS W i -~" 
W i 
2 
W i 
= 
~ 
*2 
Ao 2/;o 
Co 
A4 
0 
wi 
S .2 
( 
Do 
Fo 
[f~ 
W i 
= 
-40 
2/~0 Co 
s 2 
4" (W~ 3") 
Wi 
~ 
,S .2 
A4 
0 
(32.53) 

32.3 THE ABERRATIONS 
OF DEFLECTION 
SYSTEMS 
507 
Apart from the novel fact that, with the exception of F0 and Co, all the 
coefficients have become complex, (32.53) has the same structure as (32.48). 
The formula clearly exhibits an interesting pattern: fourfold error terms 
contain only complex conjugate variables, w* and s*; moreover, the field 
curvature and the astigmatisms have the same functional structure as the 
* 
S* 
comas, if we exchange the variables wi +-+ s, w i +-+ 
. 
Chromatic aberrations 
The accuracy requirements in electron lithography devices are so de- 
manding that chromatic aberrations must also be taken into account. As 
in the corresponding theory of round lenses, a linear approximation is suffi- 
cient. The chromatic effects can be easily understood in the following way. 
In (32.30) the principal solutions a(z), r(z) and Wd(Z) depend on the accel- 
^ 
eration voltage ¢ and the lens excitation current IL as parameters, which 
may fluctuate around their mean values. For sufficiently small fluctuations, 
A¢ and AIL, an expansion of the form 
( 
0o) 
(0, 
0, ) 
&' zx$ + 
+ 
' 
zx ; + 
zxxL 
Owd A¢ + Owe 
+ o-7 
is justified. Usually, Iwol is so small that the corresponding term can be 
neglected; w' o is proportional to the final slope s. Owing to the rotation 
invariance in the paraxial domain, the whole solution Wd(Z) is proportional 
to the complex deflection current I~ and also, from (32.36), to Wdi. Since 
this is true for all values of q~ and IL, this proportionality must also hold 
for the derivatives OWd/O¢ and OWd/OIL. Moreover, T(Z), being a paraxial 
solution for an ordinary magnetic lens, depends only on /~/q~ and hence 
¢0r/0¢ = --2ILOr/OI~. 
Putting all this together and referring to the 
image plane z = zi, we obtain the general form 
Awe - Ccs( A~ - 2 AIL 
A_~¢¢ 
AIL 
T 
---~-L) "~- (CT1 
"~- CT2--~-L)Wdi 
(32.54) 
with AWdi -- Aw e + AWg aS the total lateral aberration. The first term in 
(32.54) is the familiar axial chromatic aberration of a round magnetic lens, 
referred to the image plane. The second term, being proportional to the 
deflection wi, is called the transverse chromatic error and represents a new 
type of aberration. Between the corresponding coefficients CT1 and CT2 
no simple relation can be expected, since any variation of O(z) in (32.32) 
causes complications. 

508 
32. DEFLECTION SYSTEMS AND THEIR ABERRATIONS 
Detailed aberration analyse8 
Apart from the choice of notation, the classifications (32.53) and (32.54) 
are the same as those first derived by Ohiwa (1970) and Munro (1974), who 
used the eikonal and trajectory methods respectively. Munro lists the ge- 
ometric and chromatic aberration integrals for purely magnetic deflection 
mad round lens systems. Goto mad Soma (1977) pointed out that (32.53) 
is too limited for practical purposes, since dynamic correction of the aber- 
rations is not represented whereas such correction has long been an im- 
portant feature of deflection units. Additional weak multipole fields are 
applied, generated by currents that are usually nonlinear functions of the 
principal currents. Owen and Nixon (1973) had already pointed out that 
deflection field curvature and both isotropie and anisotropie distortion can 
be eliminated in this way, and Goto and Soma demonstrated that this is 
also true of both types of astigmatism. Moreover, linear correction currents 
are capable of eliminating all the pure deflection aberrations. Their paper 
concludes with a list of aberration integrals, which are a generalization of 
those to be found in Munro (1974). Later, Soma (1977) generalized the 
formulae still further to include all possible focusing and deflection effects 
of both magnetic and electrostatic type for arbitrary superposition of the 
fields; even relativistic effects were taken into account. A correction to 
these expressions was made by Li (1983). 
Meanwhile, the possibility of eliminating or compensating the aberra- 
tions in demagnifying systems had been examined by Koops (1972, 1973; 
Koops and Bernhard, 1975) and ways of correcting all the aberrations in 
semming microscopes by Crewe and Parker (1976). A systematic analysis 
of aberration minimization for post-lens deflection, double deflection be- 
fore the lens and the 'moving objective lens' (MOL) of Ohiwa (1970, 1978, 
1979; Ohiwa et al., 1971), is to be found in Kern (1979). We shall return 
to the MOL in Chapter 40 but we mention that Ohiwa (1979) relates this 
concept to the coma-free condition and states explicitly that the introduc- 
tion of pre-lens deflection is equivalent to replacement of the position and 
angle variables by linear combinations of these and the deflection current 
(in the magnetic ease). A systematic procedure for eliminating aberrations 
from magnetic scanning and focusing combinations is set out in Hosokawa 
(1980), and the aberration coefficients of a double-deflection unit for which 
the second deflector coincides with a round magnetic lens field are listed in 
Kuroda (1980). More general formulae for adding deflection aberrations 
are to be found in Leneov£ (1981); these are applied very tellingly to sev- 
eral practical situations by Leneov£ (1988), using a model field (Lene and 
Leneov£, 1988). 
We postpone discussion of a series of papers by Munro and Chu while 
we examine the work of Ximen and Li. In the first contribution (Ximen, 

32.3 THE ABERRATIONS OF DEFLECTION SYSTEMS 
509 
1981), which extends this author's earlier work (1977, 1978), expressions 
for the terms of second and fourth order in the eikonal function are given 
explicitly in the rotating coordinate system; the fact that deflection has the 
effect of replacing position and angle (in the object or target plane) by a 
linear combination of these quantities and the deflecting current or voltage, 
mentioned above, is used to introduce a generating function, from which 
the various aberration coefficients are extracted by differentiation. This 
ingenious technique enables Ximen to formulate the aberration theory very 
compactly. Explicit aberration integrals are given in later papers by Li and 
Ximen (1982a,b), once again in the rotating coordinate system, together 
with formulae for adding the aberration coefficients of sets of deflectors. 
Finally, Ximen and Li (1982) show how dynamic correction can be used to 
eliminate various aberrations. Further details are given in Li (1981). The 
asymptotic aberration coefficients of both position and gradient are listed 
in Hawkes (1988), where the coefficients of the corresponding polynomials 
are also to be found. A less full list is given by Tang (1986). 
One important family of aberrations is not considered in any of these 
papers, namely, the parasitic aberrations; this gap has been filled by Plies 
(1982), who examined the aberrations that arise from misalignments of 
these complex hybrid systems. 
The purpose of his studies was to find 
practical tolerance limits by exploring the influence of various kinds of 
misalignment on the aberrations. 
We now return to the series of papers by Munro and Chu (1982a,b; 
Chu and Munro, 1982a,b) devoted to the numerical analysis of electron 
beam lithography systems. The first two papers are concerned with field 
calculation and the fourth with computer optimization of complex systems. 
It is the third part that particularly concerns us here, for in it Chu and 
Munro give a list of aberration integrals, which can be used to study sys- 
tems consisting of any combination of magnetic and electrostatic lenses 
and deflectors; these expressions are of immediate practical use and we 
reproduce them here, in the notation defined earlier. 
The paraxial equation for a system consisting of any combination of 
round lenses and deflectors takes the (non-relativistic) form 
tWt 
w"+ 2¢ 
+ ~-~w - ¢~ 
¢'' 
i~---~--(Bw' 
+ 2B'w) 
FT 
~ 
Uca(z) _ 
= 
2¢ 
i_BT=---~ 
ir/#0I¢ b(z) 
(32.55) 
which is a generalization of (32.27) using the notation of (32.3b,c) and 
(32.18-32.29). The solution of (32.55) is written 
- Wo (Z) + W'o (Z) + i m(z) + 
(32.56) 

510 
32. DEFLECTION SYSTEMS AND THEIR ABERRATIONS 
which replaces (32.30),/e being the complex current of (32.34) and U'c its 
electrical analogue; re(z) and e(z) are the magnetic and electrical contri- 
butions to wa(z) (32.31), after separating the current Ic and the voltage 
Uc as factors: 
ir/#o i 
m(z) = ---'i- 
b(f){r(z)a*(¢) - a(z)r*(¢)} d¢ 
cg ;0 
1 
f 
a(() 
~(z) = 
2¢ r,. ¢~(¢) {~(z)~'(¢) - ~(z)~*(¢)} a¢ 
(32.57) 
These expressions are obtained by means of the method of variation of 
parameters, applied to (32.55), as in (32.31); examination of the Wronskian 
now tells us that 
or 
¢ { (O'T t -- fit,r) -- e2i0¢~ 
(32.58a) 
¢½(***' - .'~*) = ¢~ 
(a2.ssb) 
(el. 32.39b). 
The aberrations are obtained by retaining higher order terms in the 
potential and field expansions and again using the method of variation 
of parameters--the standard trajectory method. Into the inhomogeneous 
terms is substituted a slightly modified form of (32.56), 
.(z) 
~(z) 
. <.,)m(z) 
. <~),(z) 
w(z) = wi 
+ siT 
+wi 
~ 
+ w i 
(32.59) 
ai 
v i 
mi 
ei 
in which the image parameters in terms of which the aberrations are ex- 
pressed have been introduced; ai := a(zi) and likewise for Ti, mi and 
ei The shifts- (m) and wl *) 
• 
w i 
• are given by equations analogous to (32.36): 
wl m) = d(m)Ie and wl ~) = d(*)U,. 
In the worst case, in which no term is negligible, 59 complex geometric 
aberration coefficients emerge from this calculation. It is fortunately ex- 
tremely rare that all these are required and indeed, we return below to the 
utility of an analysis such as this when so large a number of coefficients are 
relevant. At the other extreme, for a system in which the Gaussian spot 

32.3 THE ABERRATIONS OF DEFLECTION SYSTEMS 
511 
size is negligible compared with the magnetic deflection - (m) and there is 
"W i 
no electrostatic contribution, only nine coefficients survive (Munro, 1974, 
for example). In practice, the most general situation that is liable to be 
encountered is the dual-channel system, in which the Gaussian spot size 
is typically negligible, and both magnetic and electric deflection are em- 
ployed (Fig. 40.20): the magnetic deflection provides coverage of a large 
field while the electrostatic deflection offers fast response. 
Substituting (32.59) into the aberration formula, 27 aberration coef- 
ficients are obtained, as shown in the Table 32.1. The coefficients are as 
follows: 
Co = F(T,r,r*) 
Ko (m) = F(v, r, m*) 
, 
Ko (~) = r(r, r, e*) 
2/~ m) = F(r, m, r*) + F(m, r, r*) 
2/~'~ ~) = F(r, e, r*) + F(e, T, r*) 
ft~ '') = F(m,m,r*) 
, J]~) = F(e,e,r*) 
.4~"~) = F(m, e, r*) + F(e, m, r*) 
F (m) =F(r,m,m*)+F(m,r,m*) 
F (~) = r(r, e, e*) + F(e, r, e*) 
F (''~) = F(r, m, e*) + F(m, r, e*) 
F (~m) = F(r, e, m*) + F(e, r, m*) 
J0~ =) = F(m, m, m*) 
, 
b~ ~) = F(e, e, e*) 
b (mm,*) _ F(m,m,e*) 
D~ ''*~) -- F(e,e,m*) 
b (,-,m*~) _ F(m,e,m*) + F(e,m,m*) 
0 
b (m~*) _ F(e m, e*) + F(m, e, e*) 
~:(~") = a(,*,,*,m*) 
, 
~:(~) = a(r*,r*,~*) 
~iW ) - 2G(~*, m*, ~*) + 2G(,*, ~*, m*) 
b~ ~) = G(m*, 
, 
) 
, 
bl 
, 
) 
m* m* 
e) =G(e*,e* e* 
b~ m~) = G(m*, m*, e*)+ 2G(m*, e*, m*) 
b~ ~'~) - G(e*,e*,m*) + 2a(e*,m*,e*) 
(32.60) 
(These follow Chu and Munro and are a striking example of the advantage 
of the eikonal method over the trajectory method: the fact that the for- 

512 
32. DEFLECTION SYSTEMS AND THEIR ABERRATIONS 
, 
-~ -~ -~ 
~. _ _ :  
,~ 
~ 
, 
~ o~ 
"8' 
~o-~ 
~ -~--~ ~c~ 
~) 
~ 
% 
½11 
I 
I 
I 
I 
I 
I 
I 
I 
I 
m 
o 
.~ ~ 
"~ 
"~ 
~ .,.., 
-~ 
-~ ~ 
.o 
.~,.~ ~ 
o 
~ 
.~ 
~ 
~ 
o 
,....4 
o 
~o 
r.~ 
° v...q 
..~ 
~oo 
o,..4 
o 
~ 
u 
o 
,,...i 
o 
~ 
~ cr::l 
on:~ 
~'~ 
N? 
0 
~ 
~4 
-~'~ 
o 
co) 

32.3 THE ABERRATIONS OF DEFLECTION SYSTEMS 
513 
mulae for /~¢) and/~,n) and their complex conjugates, given separately 
above, are the same is far from obvious.) 
The functions F and G are as follows: 
F(xl , X2, x3 ) -- F1 -4- 
zi 
1 
/ 
, 
¢½ (F2 + F3) dz (32.61a) 
_l, 
, 
¢i 1i VliV2iV3i 
zo 
where 
[ 
{ 
F1 = 
nln2n3 
¢17"1"v2 
ViVa 
32¢ 
16¢½ 
¢~ 7"1* Vl iV2iV;i 
(s3a 
i~?m3b) 
,(sla 
ir/mlb) } 
-~- Vl 
~ 
"~- 8¢½ 
-~- v3 -~- + 
4¢½ 
lX2X3 -4- 
7" *Xl X2Xt3 t* 
¢" 
* 
~ * II 
7"* 
I1. 
/,7" X 1 X 2 *-~-" 
X X2X 3 
32¢ (7-"* xl X2X3 + 
X3 
1 
I, 
• 
I 
I 
, 
"~- 2TI*xl X2X 3 "4- 27" X 1X2X 3) 
¢"¢'(~,, 
, 
, 
,, 
+ 32¢2 
XlX2X3 + 27"x~x2x 3 + 7"XlX2X 3 ) 
3¢'¢ '2 
-
-
 
128¢ 3 7"*XlX2X~ 
ir/BI 
* -- 27"* " 
* 
7"* 
"* 
+ 16¢½ (7""*ZlX2Z3 
XlX2X3 + 
XlX2Z3 
I, _ 27",Xl t , 
+ 27"'* X 1X2X 3 
X2X 3 ) 
(32.61b) 
(32.61c) 
 1o{ 
s2a. s3a  
* 
• II , 
7"* 
II, 
27.1, 
, 
_ (~,,,~ 
+ ~ ~ 
+ 
~ 
+ 
(~)') 
_¢' * 
,), 
3~ '~ 
,} ~--~~~a 
( 
¢" 
-~ 
" 
~1+~- 
Xl 
+ ~(7- x2x3 
7-*x2x 3 + 
47-'* ' 
7-* 
s3a { 3¢" 
+ ~-~ 
~~* 
~1 ~ - ~"* ~ x~ - 2~x"ix~ - 2~* x~ ~ 
¢' 
(r'* 
3~'2 
} 
+ ~X2 
Xl + 27"*X~ )-- -4-¢-~C2 7"*XlX 2 
iqbml (7",. 
. 
" * 
"* 
27"1. 
I. 
-~; 
XiX3 -- 7"X2X 3 -~- 7"X2X 3 
-~- 
X2X 3 ) 

514 
32. DEFLECTION SYSTEMS AND THEIR ABERRATIONS 
b?bm3 (7""* 
"r * x" 
(32.61d) 
and 
zi 
, 
, 
, 
1 
f 
(s3p. 
rlm3Pm)r, , ,dz 
a(xl, x2, x3):= 
1 
¢21" 
"-~ 
XlX2 
2¢/2~.,,,,, ~,,-, 
k, 2¢ 
¢½ 
" 
"°li'°2ix3i zo 
(32.62) 
The quantities vj, nj, m I and s I that figure in these definitions take the 
following values: 
w) 
v) 
n~ 
m) 
s~ 
r 
r' 
0 
0 
0 
a 
a 
1 
0 
0 
m 
m 
1 
1 
0 
e 
e 
1 
0 
1 
(32.63) 
The field functions pe and Pm that appear in G(x~,x~,x~) denote the 
contributions from the field components with threefold symmetry: 
p3 -iq3 
Pm := -i/93 - iQ3 
(32.64) 
P"= 
(Note: the above formulae are slightly less general than those of Chu and 
Munro, who retain the possibility that the different deflection fields are not 
aligned; we have set the angles between them equal to zero.) 
These expressions can be generalized to include the other principal 
situations, namely, dual-channel systems in which each channel can be 
electrostatic or magnetic and shaped-beam systems (Gaussian spot large) 
with electrostatic or magnetic deflection (but not both). For such shaped- 
beam systems, with magnetic deflection say, (32.59) becomes 
o(z) 
. (m)re(z) 
(32.65) 
W(Z) -~ W i 
+ Si~_t 
+'wi 
O'i 
T i 
mi 
• (e) must be replaced by wi throughout Table 32.1 and column four 
so that w i 
now contains 'shaped-beam aberrations'; (32.60-32.62) give the aberration 
integrands on substituting a(z) for e(z). A similar set of substitutions yields 
the corresponding expressions for a shaped-beam system with electrostatic 
deflection. 

32.3 THE ABERRATIONS OF DEFLECTION SYSTEMS 
515 
The general dual-channel system coefficients are again given by (32.60) 
but the functions F1, F3 and G are more complicated: 
- 
Fl (Xl , X2, Xa ) = 
¢~ r-"~t, VliV2iV~d 
+v (m3al 
(m bl+  362)) 
~6¢ 
8¢~ 
, mlal + sla2 T 
(mlbl Tsl 
+ v3 
8¢ 
~ 
~0 
[¢,, 
, 
F3(Xl,X2 
x3) 
mlal 
+ sla2 
, 
=- 
8¢ 
maal + s3a2 
"~ 
¢ 
* 
z2x3+ 
~2x3 + 
(z2x3)) 
__ (Ttt*X2Xa .-~ T* tt • 
T* 
it, 
2T t* 
, t 
¢' 
. 
3¢ '2 
} 
-- 
T* 
* 
~2al + s2 a2 
• 
7"* 
__-------------x.~ 
Tt, I _ ___ 
Xl 
-I- 
16¢ 
~ 
xl 
¢ 
m3al 
+ s3a2 
TXlX 2 ~ TII*XlX2 -- ZT XlX2 ~ 
X2 
+ 
16¢ 
¢, 
(¢* 
,)_3¢ 
~ 
+-gx2 
xl+2~*xl 
-~ 
~2 
* 
* 
T*X X It* 
i~__~(m,b , + s~bu)(v"*x2x3 - v*x~x3 + 
2 3 + 2v*x2x~*) 
- 
4¢½ 
_--- 
-- ZT X lx2 -- 
X2 
~n 
)(~,,. 
= • ,, 
2~*~ ') 
(32.66) 
- 8¢~ (mabl + sab2 
xlx2 
zl 
1 
] 
~{/Yt3pel '~" S3pe2 
G(x* 
* * 
---------- 
¢ 
2¢ 
(32.67) 
+ ~-~2 (rnaPml T S3Pm2)} v" x;x~ dz 
The ~~es 
X ~a 2 ~aaea to a(z), b(z) ~a p~(z) and P,~(z) indicate 
the role of the deflection field in the dual-channel system; thus al and pc1 
are the field functions for the principal electrostatic deflection field while 
bl and Pro1 are those for the principal magnetic deflection field; these are 
of course mutually exclusive. The functions a2, p¢2, b2 and Pro2 are the 
corresponding functions for the subfield. 

516 
32. DEFLECTION SYSTEMS AND THEIR ABERRATIONS 
Chu and Munro also give compact formulae for the chromatic aber- 
ration coefficients denoted by Cc and CT1 in (32.54). For the most im- 
portant situation, magnetic main-field deflection and electrostatic sub-field 
..(m) (m)A¢/¢~ and 
deflection, CT is divided into two parts, contributing t~, w i 
c+(~) (~)~-,- 
wi ~9/9i to Awe. The coefficients are given by 
,c - - H(v) 
C(T m) = H(m) 
C(T ~) = H(e) 
(32.68) 
in which 
1. 
zi 
¢?, 
¢-½ 
_ ~ 
+ ~(, 
~ + 
) 
H(x) = Tt,Vli 
za 
sla 
r* x - 
r* 
dz 
16 
~ 
(32.69) 
A shaped-beam system may be incorporated as explained above. In the 
more general case of the dual-channel system, the function H(x) becomes 
H(x) = 
¢-½ 
-- -~T 
X 1 "Jc -~,T 
X 1 + 
Xl) 
(32.70) 
T 
li 
2;0 
r'x1 - ~(mlal + sla2) 
dz 
For a further generalization, see Smith and Munro (1986, 1987). 
The formulae for the various deflection aberration coefficients, of which 
these are a representative sample, are manifestly extremely complicated 
in appearance and, in eases that are becoming common in practice, very 
numerous. Programming them with no errors is not a light task though 
it is now possible to output the results of a computer algebra calculation 
(Chapter 34) in Fortran directly, which reduces the chance of human error. 
Moreover, when the list of aberration coefficients is long, it is difficult to 
estimate their relative importance and one is driven to wonder whether this 
kind of aberration theory is the most appropriate. An alternative approach 
may prove to be more favourable. 
32.4 Stigmators 
Stigmators are systems of weak electric or magnetic multipole fields, suit- 
ably located within an electron optical device, the role of which is to provide 

32.4 STIGMATORS 
517 
I 
L 
i-5 
i 
1 
I 
~x'<o 
~ 
___~f~~_~ 
" 
M 
i 
z 
- 
I 
I 
Fig. 32.9: Action of a stigmator. L: lens, S: stigmator, M" midplane. The stigmator 
field is confined to the domain -a < z < a. 
w 
minor correction of the beam. Such corrections are necessary to eliminate 
some of the aberrations caused by lenses and deflectors and, still more im- 
portant, those caused by misalignments and similar imperfections (parasitic 
aberrations). 
The corrections may be both static and dynamic. Static 
correction of the geometric imperfections is always necessary; in this case 
the electrode voltages or coil currents are constant. Dynamic correction 
is mainly employed in electron lithography devices; the correction currents 
are then functions of the time-dependent deflection currents. 
32.4.1 Necessary simplifications 
In this section we shall outline the operating principles of a stigmator. Since 
an exact treatment requires extensive numerical calculations, we make a 
number of simplifying assumptions that permit analytic relations to be 
found. These assumptions are approximately valid in practice. First of 
all, we assume that the necessary correction fields are weak and not su- 
perimposed on other strong fields. This means that the stigmator has to 
be located outside the lens or deflector field region. In the lowest order 
approximation, the trajectories are then straight lines within the stigma- 
tor, and a first-order perturbation yields the small deviations from these 
straight lines. 
The second assumption is illustrated in Fig. 32.9. The stigmator fields 
must be essentially confined between two planes z = -a and z = +a and 
symmetric with respect to the midplane z = 0. For asymmetric fields, the 
theory will become more complicated but the conclusions made below will 
be essentially the same. Moreover, there is no need to produce asymmetric 
correction fields, which would complicate the construction with no real 
gain; the limitation to symmetric fields is thus not a serious restriction. 
This assumption implies that the functions (I), Ex, Ey, Az, Bx, B~ are 

518 
32. DEFLECTION SYSTEMS AND THEIR ABERRATIONS 
positively symmetric in z, while Ez, A,, A,, B, are antisymmetric. These 
symmetry requirements can still be satisfied by certain round lens fields, 
but we shall exclude these, since it is not the purpose of a stigmator to 
alter the focusing. This is better done by alteration of the lens excitations. 
Finally we assume that x ~2 + y,2 << 1 for the slopes of the trajectories. 
Since some correction will result even for x ~ = 0 or y' = 0, it is permissible 
to neglect all terms of second and higher order in x ~ and y~. The latter 
would already represent aberrations caused by the stigmator itself. Since 
the stigmator ,- assumed to be weak, such aberrations will be extremely 
small and can hence be ignored. With all these simplifying assumptions, 
the theory of the stigmator can be expressed in closed form. 
32.4.2 The wave aberration 
We start from (4.34) and (4.35), and with x '2 + y,2 << 1, Q = -e, g = 
x/2m0e~, Zo = -a, Zl = a we obtain 
S,~f~/2moe{~½(r)-rl(x~A. 
} 
+ y A~ + Az) 
dz 
The electric potential has the form 
¢(,) = ¢ + ¢,(,), 
I¢,1 << ¢ 
¢ being the accelerating voltage and (I), the very small stigmator potential. 
The approximation 
is then justified. 
We now drop the constant term in S and normalize 
with respect to the factor (2m0e¢)1/2; this yields a convenient form of the 
characteristic function, called now the wave aberration: 
a 
W :-- 2a- (2moe~)1/2 - 
- 
(I)s(r) + 
(x'Ax + y'A~ + Az) 
dz 
-~ 
~/ ¢ 
(32.7 ) 
This integral is to be evaluated for an arbitrary straight trajectory with 
small slopes. The corresponding cartesian representation is 
x(z) - xo + zx', 
y(z) = yo + zy' 
(32.72) 
x0 and y0 being the coordinates of the point of intersection with the symme- 
try plane. Introducing (32.72) into (32.71) and recalling the assumptions 

32.4 STIGMATORS 
519 
made above, we find that the terms in Az and A~ cancel out. In order to 
evaluate the remaining terms, we introduce the Taylor series expansions of 
(~s and Az in x' and y' and retain only linear terms: 
,~(r) = '~(z, xo,yo) + Z(X'¢slx + y'q'sl~) (z,x0,y0) 
- 
( 
'A 
) 
A,(r) 
Az(z, xo,yo) + z x'Azl~ + y 
zl, 
(z,xo,yo) 
Introducing this into (32.71) and bearing in mind the symmetry properties, 
we see that the terms in x ~ and y~ again cancel out. We hence obtain a 
very simple formula for W: 
](_7~(z, xo,yo) 
,7 
) 
W(xo, yo) =-a 
2¢ 
+ -"~A.(z, Xo, Yo) dz 
(32.73) 
The corrections introduced by the stigmator are therefore determined by 
the coordinates (x0, y0) of the trajectory in the midplane. 
An interesting rule is obtained by forming the two-dimensional Lapla- 
clan of W. Differentiation under the integral results in 
02W 
02W 
V~W(x0 
y0) - 
~ 
+ 
' 
0~ 
0y0 ~ 
a 
- -2"-~ 
c3x~" + 
ma 
 2os / 
 2Az / 
0y0~ 
~z+ 
o~ 
+ oy0 ~ 
~z 
Now ,I,s(r) and Az(r) must satisfy the Laplace equation, since the space 
charge of the beam can be neglected in the vast majority of practical ap- 
plications and other sources are always located outside the beam. For ,I,,, 
ox~ + oy~o ' 
dz=- 
0~ 
w~ 
m~ 
dz = -~slz(z, xo,yo 
= 0 
-- tl 
since at and beyond the boundaries z = +a, all the corrector functions 
considered vanish in view of our assumptions about the confinement. A 
similar argument shows that the magnetic term also vanishes and hence 
02W 
02W 
v~ w = 
~o 
~ oy~ = 0 
(32.74) 

520 
32. DEFLECTION SYSTEMS AND THEIR ABERRATIONS 
Fig. 32.10: Cross-section through a magnetic 12-pole stigmator. 
The operation of a stigmator can now be understood in the following way. 
In the midplane, the system of lenses and deflectors located upstream pro- 
duces a wave aberration WL(xo, Yo). The stigmator adds the contribution 
W(xo, yo) so that for the part of the beam downstream the wave aberration 
is Wc = WL + W. The average value of ]We] over the cross-section of the 
beam at z - 0 should be made as small as possible. It is obvious that only 
geometric aberrations whose wave aberrations already satisfy V~WL = 0 
can be eliminated completely. These are paraxial deflections and astig- 
matisms of various multiplicity. Their wave aberrations are best given in 
polar form 
N 
WL(V0, %00) -- Z r~(an cos n~p0 -~- bn sin n~0) 
(32.75) 
n=l 
4N being the number of electrodes or poles of the stigmator. Figure 32.10 
shows a magnetic 12-pole stigmator which is suitable for the correction 
of astigmatisms up to N -- 3. It is, however, never possible to correct 
spherical aberration, since the latter produces a wave aberration 
WL 
-
-
 const(x 2 + yo 2)2 
_
_
 const x r~, 
o 
32.4.3 The deflection of trajectories 
The influence of a stigmator on the electron beam can also be understood in 
another useful manner. The trajectories are weakly bent by the stigmator 
fields, the alteration of direction being simply given by 
OW 
OW 
= 
, 
= 
(32.76) 
Ax' 
Oxo 
Ay' 
Oyo 

32.4 STIGMATORS 
521 
Carrying out this differentiation in the integrand of (32.73) and recalling 
that E = -V~ , we obtain 
7 ]Ej(zxo 
yo)dz 
r/ ] 
2¢ 
' 
' 
--"'z 
- 
A.I j dz, 
j-l,2 
In the second term we substitute Azlz = Axl, - B~ and Azlu = Aylz + Bz. 
The derivatives with respect to z do not contribute to the integral, since 
Azlz dz = [Az]~a = 0, for example. Finally, then, we obtain 
--a 
Z~X 0 --- 
Z~y t -- 
25 
Z~(z, xo, Yo)dz + q 
B,(z, xo,yo)dz 
~a 
~' 
E~(z, Xo 
B~(z, Xo, yo ) dz 
2¢ 
, Yo ) dz - 
q 
(32.77) 
This is a 
Busch approximation of first order, since the true trajectory 
over which the integration should strictly be made is replaced by a simple 
straight line parallel to the optic axis. Apart from correction terms of sec- 
ond order in x ~ and y~, this gives essentially the same results as integration 
over the straight line given by (32.72). 
The stigmator can now be considered as an optically thin element, 
which bends the trajectories sharply in the midplane, the change of gradient 
being given by (32.77). This result is very useful for practical applications. 

This Page Intentionally Left Blank

Part Vl 
Computer-Aided Electron Optics 

This Page Intentionally Left Blank

33 
Numerical Calculation of Trajectories, 
Paraxial Properties and Aberrations 
33.1 Introduction 
In the preceding section, and also in many later paragraphs, various forms 
of trajectory equations, paraxial quantities and aberration coefficients are 
presented but their practical evaluation has not yet been discussed, im- 
portant though this topic is. Attitudes to this question have changed dra- 
matically with the rapid advance of computer technology in the past few 
decades. When the basic trajectory equations were derived (StSrmer, 1907; 
Busch, 1927) and the aberration theory developed (Glaser, 1933, 1935, 
1952; Scherzer, 1936), the resulting differential equations and aberration 
integrals had to be solved by laborious hand calculations. It is clear that 
under these circumstances the amount of numerical calculation necessary 
had to be reduced to the absolute minimum and that analytical calculations 
were preferred, however sophisticated, whenever this was possible. There is 
no doubt that these constraints strongly influenced the early development 
of electron optics. 
Fortunately, the accurate solution of systems of ordinary differential 
equations is nowadays no longer an obstacle, even for comparatively com- 
plicated mathematical structures; in Section 33.2 we shall present a numer- 
ical procedure that has proved very useful. In combination with advanced 
techniques for the differentiation of axial fields (see Chapter 13) and for in- 
tegration, all the paraxial properties and aberration coefficients of electron 
optical systems can be calculated with sufficient accuracy. 
For highly complex systems like the arrangements of lenses and deflec- 
tors in lithography devices or the sequences of multipole lenses needed for 
aberration correction, the derivation of aberration coefficients and the writ- 
ing of a computer program to evaluate them are themselves major tasks. 
The labour involved can be alleviated with the aid of computer algebra sys- 
tems (Chapter 34) but without such facilities, when only hand calculation 
remains, the organization of the corresponding programs really does seem 
hopeless. A brief account of the types of task that can be performed by 
computer algebra languages is given in Chapter 34. 

526 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
Another way of determining the effects of aberrations is to plot the 
endpoints of a large number of accurately calculated electron trajectories, 
the spot diagrams of light optics. This will be discussed in some detail in 
Sections 33.5 and 33.6. Although this is not yet very common in electron 
optics, it does offer a means of assessing the performance of a complex 
system. 
33.2 Numerical solution of ordinary differential equations 
We have seen that the equations describing the motion of electrons can 
be cast into various different forms. We shall not discuss these again, but 
simply state that finally, after certain mathematical transformations, they 
can always be cast into the general form 
i= 1...N 
(33.1) 
or in more concise vector notation 
y'(x) = je(x, y) 
(33.2) 
We assume that this transformation has been made before embarking on 
any attempt to obtain a numerical solution. The variables x and y may 
have various physical meanings or even none. For instance, the variable x 
may be the time, the arc-length, the axial coordinate or, indeed, none of 
these. In the following discussion, the particular meaning is unimportant. 
For physical reasons, the vector function je(x, y) must be smooth in all its 
arguments and we exclude forthwith any cases in which exceptions such as 
singularities or discontinuities appear. 
The solution of (33.2) for given initial values 
(33.3) 
is a standard problem of numerical analysis. In practically every major 
textbook on this subject, it is dealt with in detail and a subprogram 
for solving it numerically is available in every computer routine library. 
The methods employed are, however, of unequal suitability for electron 
optical applications. We therefore outline the various standard methods 
very briefly with a few remarks concerning their advantages and disadvan- 
tages. A good general reference is the collection of surveys edited by Jacobs 
(1977). 
33.2.1 The Fox-Goodwin-Numerov method 
This method, proposed by Numerov (1923), Manning and Millman (1938) 

SOLUTION OF ORDINARY DIFFERENTIAL EQUATIONS 
527 
and Fox and Goodwin (1949) and introduced into electron optics by Bur- 
foot (1952) and Jennings and Pratt (1955), is designed for the solution of 
differential equations of the form 
+ f(x)y(x) = 
(33.4) 
which can be solved directly without conversion into the standard form 
(33.2). The method is a two-step procedure, which requires constant step- 
width h in x. With the abbreviation y,, "= y(xo + nh) and likewise for f 
and g, the corresponding discretization formula is given by 
(1 + af,,-1)Yn-1 
-
-
 (2 - lOaf,,)yn + (1 + afn+l)Yn+l 
= a(gn--1 -~- 10gn + gn+l) "4- O(h 6) 
(33.5) 
with a := h2/12. 
This formula can be used in two ways. For initial-value problems, 
two starting values y0 and yl are required. In each integration step with 
n > 1, (33.5) is then to be solved for y,+l. In boundary-value problems, two 
boundary values y0 and YN+I are given and the solution is required within 
the boundaries xo < x < XN+I. Then (33.5) represents a tridiagonalsystem 
of equations for Yl... YN. 
This can be solved by well-known standard 
procedures, for instance the Gauss-elimination algorithm. 
The main advantage of (33.5) is its simplicity. A suitable program 
can be implemented even on a small computer. In electron optics, the 
typical examples for the application of this method are the solution of 
the paraxial trajectory equations in their forms (15.32) and (15.38) and 
the inhomogeneous generalizations of these. The Numerov method does, 
however, have serious drawbacks. The first is its lack of flexibility: in very 
many practical cases, the special form (33.4) does not occur. The second 
important drawback is the restriction to constant step-width together with 
the lack of any control over the accuracy. In doubtful cases, the whole 
calculation has to be repeated after halving the step-width until sufficient 
convergence of the solution is obtained. We emphasize that in this simple 
form (33.5), the procedure is sensitive to rounding errors when a very small 
step-width is chosen. Other drawbacks are the need to set up a special 
routine to obtain the value Yl, if the initial values y0 and y~ are given, and 
the fact that additional formulae for the differentiation must be introduced 
when y'(x) is needed as well as y(x). In view of all these disadvantages, 
this method can hardly be recommended if a large computer is available. 
33.2.2 The Runge-Kutta method 
This method is free of most of the disadvantages of the Numerov method, 

528 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
when applied to the paraxial ray equations; moreover, it is suitable for 
solving the general problem (33.2) with (33.3). The aunge-Kutta (RK) 
method is the standard procedure for dealing with such equations and has 
thus been widely employed in physics and engineering. A complete list of 
all the publications in which it is used, even for the specific task of electron 
trajectory calculation, would be much too long to include here. 
The RK method may be formulated with different orders of approx- 
imation up to the fourth order and for the latter there is more than one 
version. The classical fourth-order RK procedure is to be found in every 
textbook on numerical analysis. A more refined version, which rapidly 
became standard, was derived by Gill (1951; see also Romanelli, 1960). 
We now present this procedure briefly, without giving the derivation. For 
conciseness, we introduce the notation 
y. = y(x,.,), 
Y~n = y'(x,.,) = .f(x,.,, y,), 
n > 0 
(33.6) 
and assume that this data set has been computed correctly. We now wish to 
compute the next data set referring to Xn+l = xn + h. In a form in which 
the symbol ':=' means replacement, in the sense employed by computer 
languages and which is hence suitable for practical programming, the RK 
algorithm is given by 
y' 
' 
(q "= 0) 
D := 0, 
:= y,, 
k := y' 
D := D + haj(k- 
bjq) 
j = 1...4 
q := q + 3aj(k - bjq) - cjk 
y' := j~xn + hdj, Yn + D) 
Yn+l := Y- + D, 
Yn+it .= y~ 
(33.7a) 
(33.7b) 
(33.7c) 
The constants appearing in this procedure are as follows" 
aj 
bj 
cj 
! 
2 
! 
2 
2 
i 
1+ 
1 
1+ 
! 
2 
! 
6 
2 
dj 
1 
2 
1 
2 
The introduction of the increment D is not absolutely necessary but 
is favourable in connection with the method outlined in the next section, 

SOLUTION OF ORDINARY DIFFERENTIAL EQUATIONS 
529 
and furthermore, y' and 
' 
Yn+l can occupy the same memory location. The 
starting values q = 0 are only necessary at the first step of the routine 
(n = 0); in the subsequent steps, the accumulation of q helps to minimize 
rounding errors (Romanelli, 1960). 
The step-width h can be altered in the RK procedures. There are, 
however, no direct criteria for choosing it appropriately and this is the main 
drawback of all RK methods. The accuracy can be controlled reliably only 
by repeating each integration step with half the step-width and comparing 
the two solutions -(1) 
and -(2) 
referring to the same abscissa. 
Their 
"Yn+l 
"Yn+l 
differences, or better that between the corresponding increments D (see 
33.7), is a reliable measure of the discretization error and can be used to 
adjust the step-width appropriately. This will be described in the next 
section. 
Moreover, this difference can be used to reduce the error still 
further by means of an extrapolation: 
.(2) 
1 
_(2) 
_(1) 
~n--]-I "-" Ynq.-1 "+ ~( 
- 
) 
(33.8) 
"Yn+l 
"Yn+l 
where • (2) denotes the result with twice as many steps of length hi2. 
~n+l 
In this way, a highly accurate solution can be obtained but at the 
price of evaluating the function ~x, y) very many times. In electron op- 
tics, each call of this function entails a complete calculation of the elec- 
tromagnetic field strengths, E and B, at the reference point. Since these 
time-consuming calculations represent the major part of the computation 
time, their total number should be kept as small as possible. In this respect, 
the RK method is unfavourable; it is nevertheless necessary to initiate the 
predictor-corrector method, which is the subject of the next section. 
33.2.3 The predictor-corrector method 
The predictor-corrector (PC) method is a multistep procedure; this means 
that the last vector Y,+I is calculated by forming an appropriate linear 
combination of the preceding ones. 
Since this can be done in different 
ways, it automatically provides an accuracy control. We have to distinguish 
between predictor and corrector formulae. The former have the general 
structure 
m 
m t 
~ 
' ' 
(33.9a) 
Yn+I ~ Pn+I = 
a~,y,.,_~, + h 
avyn_ v 
t*=0 
v=0 
The corresponding abscissae must be equidistant and 
' 
Yn+l must not ap- 
pear on the right-hand side. By means of (33.9a) an approximate vector 
Y~+I ~ ~x,,+I,P,+I) is obtained. This is then substituted into the cot- 

530 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
rector formula 
Y.+I ~ D.+I 
= 
b~y._~ + h 
b~y._~ 
p=O 
v=--I 
(33.9b) 
which generally gives a better approximation. The error vector 
A.+I 
:= D.+I - P.+I 
(33.10) 
represents the discretization error; its magnitude An+l = [An+l[ can be 
used as a control and for adjustment of the step-width h. If we assume that 
the discretization error is of fifth order in h and has to be smaller than a 
given tolerance limit e, then the procedure 
An+ 1 ~ e" h to be halved, ) 
0.02e < An+x < e h maintained 
An+l < 0.02e h to be doubled 
is appropriate. In the case An+ 1 ~ • the result for Yn+l is too inaccurate 
and is hence rejected. By means of interpolation formulae, the vectors 
:= 
- 
#h/2), 
# = 1, 3, 5,... 
(33.12) 
and the corresponding derivatives are then calculated; the explicit formu- 
lae will be given below. The last integration step, yielding Yn+l, is now 
repeated with h/2. The other two cases in (33.11) provide no problem. 
The procedure outlined above is essentially the same in all versions of 
the PC method. A review of the various choices for the sets of coefficients 
and some refinements are presented by Ralston (1960). In Tiibingen, one 
of these versions was employed for the computation of electron trajectories 
until 1980 (Hoch et al., 1976; Hauke, 1977; Kern, 1978; Niemitz, 1980) but 
the very high accuracy required for the calculation of Lorentz trajectories 
in electron guns stimulated further improvements (Kasper, 1982, 1984). In 
order to minimize rounding errors, the whole procedure is represented in 
incremental form. This means that the increments 
Dn := Yn -- Yn--1 
are calculated directly and not by subtraction. A suitable procedure, called 
HPCD, is as follows (n >_ 3): 
h 7 ' 
' 
_ 
~ 
29hSy~) 
Pn+l := g{ (Yn + Yn-2) 
8Y,-1} - Dn-2 + 

SOLUTION OF ORDINARY DIFFERENTIAL EQUATIONS 
531 
116 
Qn+l := Yn + Pn+l + -~An 
Xn.q. 1 :'-- X n -~- h, 
' 
On+l 
-- f(Xn+l, Qn+l) 
~ Yn+l 
On+l := 
{O, + Dn-1 + ah(Q:+l + Zy: - Y:-I)} - 
An+l := Dn+l - Pn+l, 
control (33.11) 
9 
D.+, := D.+, - 1-~ za.+l 
Yn+l := Y, + Dn+l 
! 
Y.+I := ~X.+a,Y.+l) 
(exceptional case) 
(33.13) 
This sequence represents a regular step after the necessary initializations. 
The vector P,+I is here an incremental predictor; note that this is not the 
classical formula, which is less suitable for this purpose. Qn+l is a modified 
predictor: the last term approximates the discretization error to a high 
degree of accuracy and hence Qn+l is already a very good approximation 
for Yn+l and thus 
' 
Qn+l = Yn+l" Normally, this latter approximation 
should be quite sufficient and this has been confirmed in practical tests. The 
vector Dn+l is Hamming's corrector in incremental form (for the original 
form, see Ralston, 1960). The error vector An+l is here less sensitive to 
rounding errors, since only small increments are to be subtracted and not 
large y-vectors; Dn+l is now the incremental modified corrector, the factors 
116/125 and -9/125 being chosen in such a way that the error terms of fifth 
order, given explicitly in (33.13), cancel out. The final statement is only 
necessary in exceptional cases and hence the function f has to be evaluated 
only once in each regular integration step. The remainder is h6y(6)/57.6. 
The necessary initial values Yl, Y2, Ya, their increments and derivatives 
can be calculated by means of the RK method, as explained above. The 
routine (33.7) already has the desired incremental form if we identify D 
with Dn+l. The difference 
_ (2) 
_ (1) 
/-)(2) 
/.}(1) 
Z~n+l "-- "Yn+l -- "Yn+l ~ ~'Jn+l -- ~-Sn+l 
(33.14) 
is introduced into (33.11) in order to adjust the step-width appropriately 
and into the extrapolation formula (33.8). The last error vector Aa supplied 
by the initialization routine is, however, not that needed at the start of 
(33.13). This problem will be dealt with below. 
We now return to the alteration of the step-width h. 
Doubling it 
raises no problem apart from the appropriate reorganization of the data 
sets. This can be carried out, once five acceptable data sets with subscripts 
n + 1,... n- 3 have been stored. When the step-width needs to be halved, 

532 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
two interpolations must be carried out. The original formulae are given by 
Ralston (1960). Their incremental forms, needed here, are given by 
1 
D._½ - y. - y._½ = 2--~6(176D. + 41D._~ + D.-2) 
h 
1 
' 
I 
1 
' 
256 (- 5y. + 90y._ 1 + 51/._2) 
D._~ = y._~ -y._g = 2Y6(-12D. + 109D._I + D.-2) 
h 
+ 2- 
(3y. + 54¢_  - 27y'_ ) 
(33. 5) 
The derivatives 
' 
Yn--1/2 and Y,-3/2 are obtained not by interpolation but 
by evaluation of the function f'(x, y). Thereafter the appropriate reorgani- 
zation of the data is straightforward. 
At the start (n = 3) of the PC-loop and immediately after each alter- 
ation of the step-width, the vector ,:1,, appearing in (33.13) does not have 
the appropriate components. 
Instead of deriving approximate formulae 
(Ralston, 1960), it is better to adopt the following procedure: the sequence 
(33.13) is started with ,4, = 0 and the exceptional instruction is executed. 
The resulting derivative ' 
Y,+l is identical with 
' 
Q,+l and again introduced 
into D,+l, after which ,4,+1, D,+I and y,+l are recalculated. 
The whole integration procedure can be stopped when the abscissa z 
or one of the components of y or y' satisfies some prescribed final condition. 
Since this will often not be reached exactly, the integration is halted once a 
solution has been found within the appropriate interval. An interpolation 
in x can then be carried out on the basis of a quintic polynomial using the 
values (zi, Yi, Y~) for i = n + 1, n, n- 1. When one component ym(Z) of y 
must satisfy a condition of the form Ym (z) = yE, this equation, set up with 
the corresponding interpolation polynomial, is to be solved numerically for 
z. An interpolation then gives all correct end-values yE, yE,. 
Practical experience with this method has been quite satisfactory. 
Once a corresponding computer program has been written and tested, the 
solution of (33.2), (33.3) is a mere matter of routine, whenever there are 
no singularities or discontinuities. The latter are revealed automatically, 
as the repeated halving of the step-width h is terminated when h reaches 
some given lower bound. With an error limit of e = 10 -°, an accuracy of 
this order is obtained, for not too long integration intervals at least. The 
procedure remains numerically stable when e is decreased further and the 
accuracy increases accordingly. 
In this context it is essential that the programs for calculating the 
electromagnetic fields supply sufficiently smooth results. When the field 
strengths are calculated by means of interpolation between values stored 

33.3 STANDARD APPLICATIONS IN ELECTRON OPTICS 
533 
in a grid, all their components must at least have continuous derivatives of 
first order at the grid lines, as major discontinuities may cause a breakdown 
of the algorithm for adjusting the step size. The interpolation techniques 
described in Chapter 13 satisfy this requirement. 
For practical purposes it is helpful to provide an output routine capable 
of supplying the data (zj, yj, y~), j = n,n + 1, immediately after each 
successful integration step. The integrands of the aberration coefficients 
can then be summed externally while the differential equations are being 
solved without any modification of the HPCD program itself. The fullest 
flexibility in every situation is obtained if the output routine permits the 
tolerance limits and the final conditions to be altered according to the 
particular requirements. 
We conclude that today, a single standard routine is capable of provid- 
ing efficiently an accurate solution of any non-singular system of ordinary 
differential equations and that there is hence no need to simplify these be- 
fore attempting to find a solution. This is undoubtedly important for the 
future development of electron optics. 
33.3 Standard applications in electron optics 
In very many practical cases, the geometrical forms and the excitations of 
a lens system are given and hence the electromagnetic field is known, either 
as a result of calculation or from measurement. It is then the asymptotic 
or real paraxial properties or a mixed form of these and the corresponding 
aberration coefficients that are usually required. 
33.3.1 Initial-value problems 
Let us assume that no conditions are imposed at the aperture; discussion 
of such conditions is deferred to the next section. We are thus confronted 
with an ordinary initial-value problem. The starting plane may be located 
in field-free space at a reasonable distance from the lenses or coincide with 
a real object plane z = Zo. We have to choose the appropriate form of the 
fundamental solutions vl,2(z) of the paraxial ray equations and calculate 
them for the specific initial values. The integration runs either to a terminal 
plane in the field-free space on the far side of the lens system or to the 
conjugate image plane z = zi, which is a zero of the solution v2(z) for 
which v2(zo) = 0. The paraxial ray equations have the general form 
d / 
\ 
" |P(z)v;(z)] 
+ Q(z)vj(z) = O, 
j = 1, 2 
(33.16) 
dz k 
- 
/ 
Identifying yl with Vl and Y2 with v2, the corresponding system of first 

534 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
order may be written: 
~ = ~lP, 
y'~ = Y41P 
(33.17) 
y'3=-Qyl, 
y'4=-Qy2 f 
The components Y3 = Pv'l, y4 = Pv~ are then the associated momenta. 
An equivalent form is 
,,';(z) + ,,(z),,~ + b(z)v~(z) = o, 
j = 1,2 
(33.18) 
Here we set 
Y~ = Y" 
Y~ = Y~ 
~ 
(33.1 9) 
y~ -" --ay3 -- byl 
yl4 -- -ay4 
- 
by2 ] 
and y3 = v~, y4 = v~ are now the derivatives of first order. With HPCD 
both possibilities can likewise be assimilated. In the latter case, the deriva- 
tives of second order, y~ = v~', y~ = v~',are also calculated automatically. 
On the other hand, the Numerov method requires the Picht transform that 
converts P(z) to unity or eliminates a(z) to be applied and does not even 
give v~ and v~; it is thus distinctly unattractive. 
The above transformations remain valid if all the functions involved 
take complex values, the abscissa z remaining real. A solution could then be 
found with a program for complex systems of ordinary differential equations 
but very often such a program is not available. It is not even necessary to 
write it, as the systems (33.17) and (33.19) can easily be split into their 
real and imaginary parts. The resulting system of real differential equations 
then has the rank N = 8. Very often the coefficients P(z), Q(z) and a(z), 
b(z), are real. There is then no loss of generality in assuming that the 
solutions vl (z) and v2(z), which must, of course, be linearly independent, 
are likewise real. Arbitrary complex solutions can then be obtained by 
appropriate linear combinations of these, the coefficients being complex. 
The aberration integrals may be of the quite general form 
zi 
' 
"" 
'~')d~ 
C - 
F(z;f,f',...f(4);Vl,Vl,Vl,V2,V2, 
Zo 
(33.20) 
.f(z) being any axial lens function such as the axial potential ¢(z) or the 
flux density B(z) or even any set of such functions. With the techniques for 
differentiation and interpolation outlined in Chapter 13, even derivatives of 
high order can be calculated accurately, so that it is not necessary to elim- 
inate them by partial integration, though the latter is certainly favourable. 

33.3 STANDARD APPLICATIONS IN ELECTRON OPTICS 
535 
At least in the absence of such higher order derivatives, simple integration 
by means of the trapezoidal rule is quite sufficient. 
33.3.2 Boundary-value problems 
In electron optics, the imposition of aperture conditions is the classic ex- 
ample of a boundary-value problem. We wish to solve (33.16) or (33.18) 
for two paraxial rays s(z) and t(z) satisfying 
S(Zo) = t(z,) = 1, 
s(z,) = t(zo) = 0 
(33.21) 
This creates no intrinsic problem. First we calculate two other independent 
solutions g(z), h(z) satisfying the standard initial conditions 
g(zo) = h'(zo) = 1, 
g'(zo) = h(zo) = 0 
(33.22) 
These give us the values g(z,), h(za)in the aperture plane; s(z) and t(z) 
are now obtained as linear combinations of g and h. Explicit determina- 
tion of these linear combinations after running the integration routines is 
unfavourable since all the computed data would have to be stored. Instead, 
it is better to recommence the integration with the initial conditions 
g(Za) 
s(zo) = 1 
s'(zo) = 
' 
h(z 
) 
1 
t(zo) = O, 
t'(Zo) = h(za) 
(33.23) 
While this second integration is proceeding, the appropriate integrals for 
the aperture-dependent aberration coefficients can be evaluated simultane- 
ously. 
33.3.3 Eigenvalue problems 
Very often, the positions of the object and image planes are fixed by techni- 
cal requirements and the appropriate lens excitations are not known. This 
problem can arise for electrostatic lenses as well as for magnetic ones. For 
clarity, we shall consider these two cases separately. 
In electrostatic lenses the field is usually produced by two or three 
electrodes with two different potentials U1 and U2. In a lens with three 
electrodes, the two outer ones are usually at the same potential U1, and we 
shall assume this to be the case, although a further generalization provides 
no problem. The axial potential ¢(z) must now be a linear combination of 
the form 
if(z) = Ulffl (z) + U2ff2(z) 
(33.24) 

536 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
¢1 and ¢2 being the partial potentials for U1 = 1, U2 = 0 and U1 = 0, 
U2 = 1 respectively. We now introduce a dimensionless lens parameter 
X := U2/U1. The nonrelativistic ray equation in reduced coordinates can 
be cast into the form 
~,, + ~ (4(z) + ~¢~(~)) ~ 
¢~(z) + ~¢~(z) 
~(z) = o 
(33.25) 
with 
r(Zo) = r(Zi) = 0, 
r'(Zo) = 1 
(33.26) 
The problem is to determinethe parameter X. 
In the case of magnetic lenses we must assume that there is no sat- 
uration, so that the field strength is proportional to the coil current I. 
Otherwise an alteration of I leads to a completely different field distribu- 
tion whereupon the entire field calculation procedure has to be repeated. 
We now cast the axial flux density into the form 
B(~) = ,oSb(z) 
(33.27) 
J := NI being the number of ampere-turns and b(z) a geometric form factor 
with f_oo b(z)dz = 1. We also introduce a dimensionless lens strength 
X2 .= e(/~0J) 2 
(33.28) 
8m0q~ 
The ray equation then takes the form 
~"(z) + ~b~(z)~(z) = o 
(33.29) 
where (33.26) is again to be satisfied. 
Obviously the basic underlying structure in both special cases is of the 
form 
v"(z, X) + a(z, ~)v'(z, )~) + b(z, ~)v(z, )~) -- 0 
(33.30) 
in combination with (33.26) or even more general boundary conditions. An 
appropriate technique for the solution of such problems is the well-known 
8hooting-method. Here we shall describe only an elementary version of it, 
which is quite sufficient in electron optics (see Fig. 33.1). 
Let us ignore for a moment the condition r(zi) = 0, or more completely 
r(zi, Xi) = 0, where Xi is the appropriate, but unknown, eigenvalue of the 
parameter X. The function r(z, X) then has a zero at z = z/(X), which can 

33.4 DIFFERENTIAL EQUATIONS FOR THE ABERRATIONS 
537 
Zo 
I 
l_. 
T(z,A) 
I 
I 
! 
\ 
T(z,A) 
Z 
/ 
f 
i 
Fig. 33.1: The shooting method in electron optics. The variable strength ,~ of the lens 
L is to be determined in such a way that the paraxial ray r(z, ,~i) has a zero at z = zi. 
The heavy line indicates the first eigenfunction and the dashed line the second. 
always be determined by solving the corresponding initial-value problem. 
We now define a function 
Z i -- Zo) 
F($) := (zi()~) 
_ 
zo) - 1 
(33.31) 
which remains finite for all values of zl()~ ) # Zo, even for Izs(~)l ~ 
o~. 
Obviously F(A~) = 0 leads to the required condition zs()~ ) = z~ and hence 
we have to determine the zeros of F()~). This can be done iteratively with 
a suitable program for the computation of zeros of arbitrary continuous 
functions. Since each evaluation of F($) requires a complete ray trace, this 
program for finding zeros must work very efficiently, but this is no problem. 
In the case of very high magnification, the task of solving F()~) = 0 as 
zi ~ ~ causes problems. In such a case, it is more reasonable to replace 
(33.31) by F()~) = T'(ZT) =~ 0, ZT being an end-coordinate in the field-free 
space beyond the lens. In both situations, the function F($) can have a 
sequence of zeros, and which of these zeros is found will depend on the 
initial guess for $. 
Once this problem has been solved, the remaining tasks fall within the 
province of the earlier sections. 
33.4 Differential equations for the aberrations 
Hitherto we have been dealing with the familiar form of the aberration the- 
ory and with the practical evaluation of the quantities involved. As we have 
already observed, this approach to aberration studies becomes very burden- 
some when the integral expressions for the coefficients are complicated. In 

538 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
these circumstances, we notice that there is no real need to use pertur- 
bation theory since the fields and the trajectories through them can be 
computed completely generally. But then we are confronted with another 
difficulty: in the most important case of very low aberrations, for which 
the lens designer is always striving, determination of the coefficients be- 
comes inaccurate because we are obliged to calculate the small differences 
between the lateral image-plane coordinates, which may be large. This 
numerical instability would be avoided if the ray equations could be trans- 
formed in such a way that small aberrations or shifts appeared directly in 
an incremental form, without subtraction. This proves to be possible, and 
we now describe the appropriate transformations for two general classes of 
trajectory equations. 
33.4.1 Electrostatic systems with a straight optic axis 
For systems with a straight optic axis the axial coordinate z is the best 
parameter and (3.22) is then a suitable form of the trajectory equation. For 
conciseness, we specialize to electrostatic systems and introduce w = x 4- iy 
as usual, whereupon (3.22) reduces to 
w"(z) = ¢-1(1 4- Iw'l 
b-~-~* 
2 
-~z 
(33.32) 
We now write the electrostatic potential in the form 
¢(,9 = ¢(z) + v(~) 
¢(z) being the axial potential and V the remainder. In practice, leVI << 
mo¢ 2 is always satisfied so that all terms in eV 2 can be neglected. Equation 
(33.32) takes the simpler form 
w. _ l + lw'[2 ( OV 
I(¢,+c':')V 
) 
- ¢(z)+ V 
~-w* 
2 
-~z )w' 
(33"33/ 
,,..., 
¢ :- ¢(1 + e¢)/(1 + 2e¢) being the reduced axial potential. The off-axis 
potential Y(r) consists of paraxial terms Vp(r) and the remainder Vs(r) 
causing aberrations. The paraxial term certainly contains the expression 
1 -,,, 
2 
y2 
1 ¢,, ww* if ¢" 
-~¢ (x + 
) = -~ 
# O, but may also include deflection 
and quadrupole terms. Whether such terms are main paraxial terms or 
aberrations caused by imperfections will depend on the definition of the 
electron optical system; the separation of V into Sip and Vs is to be made 
according to the particular situation. 
The term w~OV/Oz is always an 
aberration, and so the paraxial ray equations (with subscript p) are here 
,-- . 
cOVp 
1 ¢'w~ =" L(z, 
w~v) 
(33.34) 
Cwp = Ow; 
2 
wp, 

33.4 DIFFERENTIAL EQUATIONS FOR THE ABERRATIONS 
539 
We now rewrite (33.33) in the form 
,, 
1 + I~'1 ~ 
w = ~
(
L
 
+ S) 
¢+v 
and w - wp 4- ws. Introducing (33.34) into (33.33) and observing that L is 
a linear operator, we find 
:! 
¢0V8 
lw, OV 
L + S = L(z, ~, ~'~) + L(~, ~,, ~ 
+ 0~" 
2 
Oz 
% 
L(z,w,w') 
S(z,w,w') 
Note that the separation into wp and w8 is only made in the linear term[ 
In order to perform the complete separation into paraxial and aberration 
terms, we use the identity 
_ 
= 
= 
+ 
_ 
i~,l 
2 _ 
y 
¢+y 
¢ 
¢+y 
After a minor calculation we find 
(1 + Iw'12)S(z, w, w') 
,, 
-1 
' 
L(z, O, O)} + 
.. 
~ 
= 7{L(z, 
~, 
~ 
- 
¢ 
q~ 
4- V 
(33.35) 
+- 
Iw' 
- 
L(z,w, 
) 
¢+v 
This differential equation contains exactly all aberrations that are included 
in (33.33). The term in L(z, 0, 0) arises from the fact that the inhomoge- 
neous term representing the axial deflection is already present in (33.34) 
and must therefore not appear again in the aberrations; the term in braces 
in (33.35) is hence homogeneously linear in the aberrations. 
Equation (33.35) has a comparatively complicated structure and can 
be solved only in combination with the paraxial equation (33.34). By means 
of the method outlined in Section 33.2.3, an exact numerical solution can 
be obtained straightforwardly for various initial conditions. 
The result 
is numerically stable as IwsI ~ 0 and hence an analysis of the aberrations 
obtained in this way will lead to no numerical problems. A similar reasoning 
can be applied to magnetic systems, but we shall not present this here for 
reasons of space (see Kasper, 1987a,b). 
33.4.2 Separation in arbitrary systems 
A form of the ray equations that has proved very useful in numerical cal- 
culation is derived in Section 3.2 where it is given by (3.12). This is the 
starting point for the following theory, developed by Kasper (1984, 1985). 

540 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
In order to remove unnecessary constants, we introduce a normalized 
magnetic field 
b(r) := ¢U-~/~B(~) 
(33.36) 
having the dimension of a reciprocal length, where ~r is a constant acceler- 
ating potential. We likewise define a dimensionless electrostatic potential 
~(r) and its gradient a(r) by 
1 
~(r) "- ~--~, 
a = V~ 
(33.37) 
Denoting derivatives with respect to the curve parameter a by dots, we can 
rewrite (3.12) more concisely as 
~. -- a(r) + b(r) x + 
(33.38) 
Let us now consider a neighbouring ray shifted by a distance s(a) relative 
to the first. This must satisfy the equation 
+ 
= a(, + 
+ b(, + 
× 
+ 
By subtraction of (33.38) from this equation we find 
=a(r+s)-a(r)+b(r+s)×b+(b(r+s)-b(r)} 
× 
(33.39) 
This is not very helpful unless we can get rid of the differences between the 
field strengths. These can, in fact, be eliminated by means of a program 
that not only furnishes the cartesian components of the field strengths but 
also the gradients of these components, or in other words, the second-order 
derivatives of the potentials. 
For any scalar differentiable function, the 
relation 
1 
AF "= F(r + s) - F(r) =/(s. 
V')F(r']r' = r + st)dt 
o 
is an identity, in which the differentiation refers to a variable argument r', 
over which the integration is to be performed after the differentiation. This 
integration is to be carried out by means of Gauss quadrature formulae. 
With the abbreviation 
DF := s. VF = (s~O~ + syOy + szOz)F 
(33.40) 

33.4 DIFFERENTIAL EQUATIONS FOR THE ABERRATIONS 
541 
we have 
1 DF(r + hiS) -[- 1DF(r + a2s) + O(s 5) 
AF= 
1 
V~ 
(33.41a) 
with 
al,2=~+ 
AF = 
5Dr(r + blS) + 8Dr(r + ~) + 5DF(r + b2s) 
+ O(s 7) 
with 
b~,2 = ~ 4- 
(33.41b) 
In this way we can calculate increments of functions quite accurately in a 
numerically stable manner. In the case of vector functions these operations 
are carried out separately for the three cartesian components. With this in 
mind, we rewrite (33.39) in the form 
= Aa(r)+ b(r) x b + Ab(r) × (~ + b) 
(33.42) 
which is quite generally valid and easily programmable (Kasper, 1985). 
So far we have tacitly assumed chromatic aberrations to be absent, 
since we treated b(r) in (33.36) and a(r)in (33.37) as unique functions. 
We now specify explicitly that (33.36), (33.37), (33.38) and (33.42) are true 
for electrons with the nominal value of the kinetic starting energy and for 
magnetic fields with the nominal values of the coil currents. In accordance 
with (3.13), the relations 
1 
1 
_-/.2 = ~(r) 
/'-h + ---h 2 = A~(r) 
(33.43) 
2 
' 
2 
must then be satisfied at each trajectory point (including the starting point) 
if the energy has its nominal value. 
33.4.3 Chromatic shifts 
We now study the effect of altering ~ and b. If the magnetic field is gen- 
erated by a coil with current I and the lens is not saturated, an alteration 
~I changes the magnetic field by lib = I -lblfI. A nonzero kinetic starting 
energy e~(I) at the surface (I)(r) = 0 alters the function ~(r) by 
~(~) ----- (2U)-1(1 -[- 2~(1~(7.) -[- ~(I~)~(I } 
(33.44) 
To prevent any confusion, we denote the shift, caused by chromatic and 
geometric effects together, by the symbol u instead of s. The generalization 
of (33.43) with A~ := ~(r + u) -~(r) is 
lu2 
+ 
= 
+ 
+ ,,) 
(33.45) 

542 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
This condition is to be satisfied only once, at the starting point, and will 
then be valid for the whole trajectory. The practical application of (33.43) 
and (33.45) proceeds as follows: the starting vectors r0, So and u0 and 
the directions of r0, s0 and ~i0 can be chosen independently, after which 
(33.43) and (33.45) are used to determine the appropriate lengths of the 
vectors/'0, h0 and ti0 respectively. The alterations 6I and 6q~ introduce 
some additional terms in (33.42). Considering all possible increments more 
thoroughly, we find 
ii = Aa(r) + b(r) × 6 + (Ab(r)+ ~-b(r + u)) ×(/" + u) 
J 
(33.46) 
,tr 
+ 
~6q~O -1vq~(r + u) 
This differential equation contains all possible types of geometric and chro- 
matic errors and all allowed combinations of them in full generality. The 
integration formula (33.41b) is already so accurate that its remainder can 
be neglected in every practical case. Equation (33.46) shows that the shift 
between two arbitrary neighbouring trajectories can be computed quite ac- 
curately in a numerically stable manner. In practice some simplifications 
can be made. In (33.46)it is inconvenient to have Vq' and Vq, (in a) 
together in the same formula. Since e6q~ ,~ 10 -6 little error will result 
from replacing Vq, by V~ in the last term of (33.46). Furthermore, it is 
preferable to avoid explicit evaluation for the argument r + u or r + s, since 
the latter does not appear in (33.41a,b). Thus a more favourable form (see 
Kasper, 1985) is 
~t= Aa(r)+tcl(a(r)+ 
Aa(r)) + b(r) x u 
e6~ 
61 
withlcl=2e6'~= 
, 
~2 = -- 
moc 2 
I 
Comparing the formalism outlined here with that of Section 33.4.1, we 
notice an important difference. Equation (33.45) is already the differential 
equation for the lateral geometric aberration: its solution gives the required 
aberration immediately without further transformations. The price to be 
paid for this convenience is the necessary specialization. On the other hand, 
(33.47) is quite generally applicable to any electron optical system with 
stationary fields. This equation describes, however, not the aberrations 
themselves but the shift between neighbouring trajectories, from which the 
aberrations must then be determined. This formalism is most useful for 
systems with a curved optic axis, since this axis can simply be adopted as 
the reference solution of (33.38). 

33.5 LEAST-SQUARES-FIT METHODS IN ELECTRON OPTICS 
543 
33.5 Least-squares-fit methods in electron optics 
The methods discussed in the preceding sections enable us to compute 
individual geometric and chromatic aberrations with high accuracy, even 
in the most complicated cases. 
The question now arises, how can the 
corresponding aberration coefficients be calculated from a set of such data? 
One suitable procedure is the least-squares-fit (LSF) method. 
This method is already familiar in physics and numerical mathematics, 
since it is a general tool for the analysis and approximation of measured or 
calculated data. In light optics, for instance, the LSF method is in practi- 
cal use for the determination of aberration coefficients, since this is easier 
than the numerical evaluation of Seidel's aberration theory. In spite of the 
close analogy with our present concerns, the LSF method is not so familiar 
in electron optics, for the following reasons. The determination of aberra- 
tion coefficients by means of the LSF method requires the calculation of 
the end-points of many rays (up to 100). Unlike the situation in light op- 
tics, the tracing of electron trajectories is still a time-consuming procedure. 
Nevertheless, this method can be very useful and sometimes there is no al- 
ternative. This will be demonstrated by examining some telling examples 
once we have presented the general theory. 
33.5.1 General complex formulation 
We disregard for the moment the particular purpose and study a more 
general problem. We assume here that M measurements or computations 
of some complex function w(u) yield the complex numbers Wl, w2... WM, 
that is w~, = w(u~,), # = 1... M. We now wish to expand the function 
w(u) as a series of the form 
N 
w(u) = ~ 
c~¢~(u) 
(33.48) 
v--1 
in terms of well-defined functions ¢~(u) 
(v = 1... N), the trial functions, 
and initially unknown coefficients cv; of course N < M. Since the val- 
ues Wl... WM may be afflicted with small errors or the choice of the trial 
functions may not be entirely appropriate, it is often impossible to satisfy 
(33.48) for all w~,. We hence introduce the less stringent condition 
M 
N 
v--1 
2 
=" e 2 = min 
(33.49) 
G1... GM here being positive weight factors normalized to a unit sum. 

544 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
Minimization of e 2 with respect to the coefficients cx, 
~e2 
-- 0, 
Oc~ 
A=I...N 
leads immediately to the normal equations: 
N 
Z S,x,c, = T~,, 
Y----1 
A=I...N 
(33.50) 
with the Hermitian matrix 
M 
(33.51) 
and the column vector 
M 
T~ = Z 
G,¢*~(u,)w,, 
A = 1... N 
(33.52) 
~--1 
The normal equations have the advantage of being easy to program and 
the flexibility of including weight factors, which can be chosen according to 
the significance of the input data Wl ... WM. If no preferences are apparent, 
then G1 = G2 .... 
G M = 1/M is appropriate. Substituting the solution 
back into (33.49) gives us the standard deviation e, which is a good measure 
of the quality of the approximation. 
The main objection to the normal equations is that the matrix S is 
often ill-conditioned. In order to avoid this, Householder (1964) introduced 
a new method for the determination of Cl... c~ from (33.49) by means 
of suitable orthogonalizations. This method requires equal weights G1 = 
• .. - 
GM. 
Equation (33.49) can then be interpreted as the norm of a 
vector in an M-dimensional complex space; this norm is invariant under 
any unitary transformation. We cannot go into details here but simply 
state the essential procedure. The user of a Householder-transformation 
program is required to solve 
All 
... 
A1N 
.
.
.
 
. 
.
.
.
.
 
. 
AM~ 
... 
AMN 
¢1 
Wl / 
W M 
CN 
-1 
= min 
(33.53) 

33.5 LEAST-SQUARES-FIT METHODS IN ELECTRON OPTICS 
545 
with A~,, = ¢,(u~,). After setting up this matrix including the column for 
the w~,, it is left-multiplied by a succession of suitable unitary matrices of 
rank M until a triangular structure is obtained: A~,, = 0 for # > u with 
u _ N. Extraction of the coefficients cl,..., CN is then straightforward. For 
more details, we refer to the standard textbooks on numerical mathematics 
(e.g. Stoer, 1979; Lawson and Hanson, 1974). 
33.5.2 The determination of deflection aberrations 
As an example, we now study the third- and fifth-order distortions of de- 
flection systems, defined in (32.49). Since all coordinates refer to the image 
plane, we drop the subscript i. Inspection of (32.49) shows that in this par- 
ticular case we have ten real coefficients Djk (j -- 1, 2; k - 1... 5) and ten 
real trial functions 
~)1.-. ¢10 __X 3 , x2 y, xy2 , y3 ; x5 , x4y, x3 y2 , x2 y3 , xy4 , y5 
We therefore have to solve a linear system of ten real equations for the 
unknown coefficients. The real form of the LSF method is a simpler special 
case of the general complex form. 
The system of ten equations can be solved en bloc. This is, however, 
the least efficient way; we use this example to demonstrate how such a 
system can be profitably split into smaller subsystems. Careful inspection 
of (32.49) shows that the two equations have no common coefficients and 
can hence be treated separately. Thus the full system is already partitioned 
into two uncoupled subsystems of rank 5. We next consider the fact that the 
distortions are antisymmetric with respect to the coordinate planes; this 
tells us that it is sufficient to calculate trajectories with end-points in one 
quarter of the image screen. In order to obtain a true LSF, which will enable 
us to verify that (32.49) is a valid representation, it is advantageous to use 
more than the minimum number of trajectories; we therefore choose the 
pattern of ideal deflections shown in Fig. 33.2. As it is undesirable to raise 
large numbers to high powers, we normalize the equations by introducing 
dimensionless coordinates: 
x 
y 
Ax 
Ay 
= 
-, 
~ = ~, 
-~ =--, 
-~_ 
a 
a 
b 
0<~_<1, 
0<v<~ 
We then have subsystems with the following aberration components, trial 
functions and scaled coefficients: 
Cl = a 2 Dll, C2 -- a4 D13. 

546 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
i 
),,,, 
lw 
73 
dlk 
Ir 
10 
7 
Ak 
I 
74 
11 
8 
2 
dh 
Iv 
15 
dlt 
•w 
72 
Atlh 
'IF 
9 
dk 
3 
x/ 
Fig. 33.2: Pattern of ideal deflection in one quarter of a viewing screen. The centre of 
the screen coincides with the origin, O. 
2. ~ = 0, At/4, At/5, At/6, ¢3 = 71 a, ¢4 = r/5, 
c3 = b 2D22, c4 = b 4D25. 
3. r/~ ~ 0, /~7-'-/~15, 
¢5 : 
~r/2 ¢6 "-- ~3r/2 ¢7 --" ~r/4, 
c5 = b 2 D12, c6 = a 2 b 2 D14, c7 = b 4 D15 
4. ~r/~ 0, Ar/7... Ar/15, Cs = r/~2, ¢9 = r/3~2, ¢10 = r/~4, 
cs = a2D21, c9 = a2b2D24, Clo = a4D23. 
The LSF equations for subsystems 1 and 2 are solved first and the re- 
sults obtained are then introduced into the remaining equations. We shall 
not go into this elementary procedure. It is clear that such a calculation 
presents no particular difficulty whereas the second iteration of the pertur- 
bation calculation (evaluation of S II in Chapter 22) is extremely compli- 
cated, so complicated indeed that this second-order theory has hardly ever 
been used except in connection with the Darmstadt aberration correction 
project (Chapter 41). Although a list of aberration integrals for the fifth- 
order aberrations of round lenses exists, there is no proper study in the 
literature of any fifth-order aberration coefficient, not even the fifth-order 
spherical aberration of round lenses. 
33.5.3 Some other examples 
Another case in which the LSF method is obligatory is the filter lens. 
These are quite ordinary electrostatic einzel lenses (see Chapter 35), but 
the potential of the central electrode is so low that electrons with an energy 

33.6 DETERMINATION AND EVALUATION OF ABERRATION DISCS 
547 
of about 5 to 10 eV below the nominal energy cannot pass the central po- 
tential wall and are reflected , as in an electrostatic mirror. The electrons 
that do pass over the wall are slowed down so much that the associated 
slopes and off-axis distances may be very large; Fig. 33.3 shows a typical 
example. It is clear that the third-order approximation for the aberrations 
is then quite insufficient. 
Niemitz (1980), who investigated such lenses 
numerically, considered geometric aberrations of at least fifth order and 
chromatic errors up to the third order in the energy loss. The whole sys- 
tem of LSF equations then becomes so large that it is essential to split it 
into subsystems and to introduce suitable scaling. 
An interesting application of the complex LSF method concerns sys- 
tems of round magnetic lenses and deflectors. Here the complex trial func- 
tions are given by (32.53). In order to simplify the program, it may well 
be preferable to establish nine independent complex coefficients, treating 
Co and F0 as though they were complex (C0 and/~0) and regarding g~ as 
independent of K0 (writing/~c for K~ in the definin_g relation). If the nu- 
merical procedure is sound, it will be found that I~C01 << Co, I~F01 << F0 
and/~c =/~ 
with a high degree of accuracy. This also provides a useful 
check. Generally, the paraxial properties and the spherical aberration can 
be separated from the rest of the errors; the distortions also form a sepa- 
rable subsystem. Once again, it is possible to study aberrations of higher 
than third order. 
33.6 Determination and evaluation of aberration discs 
A complete determination of all permitted aberrations of a very complex 
electron optical system is a major task, regardless of the choice of method. 
We are therefore led to seek simpler special classes of aberrations, which 
can be determined with a more modest effort. One such class consists of 
the aberrations associated with a pencil of rays that start from a common 
fixed object point and pass through an aperture (see Fig. 33.4). Neither 
the object point nor the centre of the aperture need be situated on the 
optic axis. 
As a result of the lens aberrations, a blurred intensity pattern is formed 
in the image plane, the aberration disc. This is of extreme interest in 
many practical respects. For monochromatic electrons, this disc can be 
interpreted as the shadow projection cast by a grid placed over the aperture. 
This is shown in Fig. 33.5. If we assume that the grid is illuminated 
uniformly and that the meshes of the grid in the aperture have equal areas, 
then the intensities in the distorted areas will also be equal. In this way we 
obtain some idea of the intensity distribution in the aberration disc. The 

548 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
, '  l'ii 
liil 
i° "/ 
C~ 
e,l 
'~ 
o 
¢.9 
q9 
qJ 
¢9 
O 
= 
.,-., 
¢¢ 
O 
Q9 
,.~ 
'. 
qJ 
o,.~ 
o~ 
~z 
O 
= 
= 
0 
0 
.,..~ 
~ 
.,.-i 
0 
"~ 
0 
d e 

33.6 DETERMINATION AND EVALUATION OF ABERRATION DISCS 
549 
~o 
,~ 
7.o 
focusing 
object 
system 
plane 
~ 
x S 
z s 
plane 
z 
Fig. 33.4: Perspective sketch of the coordinate system and of a focused electron beam. 
The aperture cone in image space has a circular cross-section. Note that the aperture 
angles are much exaggerated. After Kasper (1985). 
a 
) 
Fig. 33.5: (a) Zone pattern of an aperture. (b) Aberration disc regarded as a shadow 
projection of the zone structure created by monoenergetic electrons from a single object 
point. 
aberrations may become so large that parts of the disc overlap others; in 
overlapping areas the corresponding intensities are to be summed. 
The determination of patterns such as those shown in Fig. 33.5b is 
quite easy, if the space between the object and the aperture is field-free, 
so that the relations between the object coordinates (Xo, yo, Zo), the initial 
slopes (x'o,y'o) and the coordinates (xa,ya,za)in the aperture plane are 
simple. In all other cases, the calculation of the ray that starts from the 
given object point and strikes a particular aperture point while under the 
influence of aberrations is already a difficult procedure, since a nonlinear 
boundary-value problem has to be solved. In order to circumvent such an 

550 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
impractical procedure, we propose that first, the corresponding paraxial 
boundary-value problem should be solved. This tells us the required initial 
! 
I 
slopes Xo, Yo. With these, the ray affected by aberrations is now calculated. 
The latter will not, of course, pass exactly through the aperture point 
(x~,y~,z~), but if the deviation is small, as it should be in every well- 
designed system, the disparity will be tolerable. 
33.6.1 Fourier analysis of the aberrations 
In very many practical devices, the image plane or the viewing screen is 
located in essentially field-free space. The rays are then orthogonal trajec- 
tories of a characteristic function. Since this is already true for the paraxial 
rays, the same must hold for the aberrations after the paraxial contribu- 
tions have been separated. If we have an aperture at a distance d from the 
image plane in the field-free space in front of the latter, then the gradient 
relations can be cast into the form 
as 
_, os 
Axi = -d ox-----~, 
Ayi = 
Oyi ' 
(xi - Xa) 2 + (Yi - Ya) 2 << d2 
t 
t 
We have x i = (xi- xa)/d, Yi = (yi- ya)ld and hence 
OS 
OS 
zx ~ ~ = 
o 
.~"~" 
zx u ~ = Oy~ 
so that this representation is independent of the particular distance between 
the aperture and the image plane. 
I 
As we have seen above, it is necessary to approximate the slopes x i, 
y~ by their paritzial values, since only for these can the simple prescribed 
conditions be ~Ktisfied. In accordance with the definitions introduced in 
Section 32.3, we flow Write 
, 
_(0), +acos~ 
~ 
_(0), 
x i 
a; i 
x i 
+or 
, 
. (0), 
I0), 
Yi, = Yi 
+ aCos~p -- y 
+ fl 
(33.54) 
for the paraxial slopes, where the subscript a has been dropped. As in 
(32.40) and (32.46), we have 
(° 
Aw = Axi + iAyi -- 
~ 
+ i 
S = e 1~ 
+ -a 
S 
(33.55) 
Since this representation is independent of the distance d to the assumed 
aperture, we may, in theory at least, consider an arbitrarily close aperture. 
In the limit d ~ 0, (33.55) must hence remain valid even if the image plane 

33.6 DETERMINATION AND EVALUATION OF ABERRATION DISCS 
551 
is located in an electric field, as is the case for the post-acceleration fields 
employed in cathode-ray tubes. 
For conciseness we first define a normalized radial coordinate r "= a/a, 
a being the maximum semiaperture angle, hence 0 < r < 1. Following 
Kasper (1985) closely, we now introduce a Fourier series expansion with 
initially unknown coefficients, which are to be determined from the com- 
puted aberrations: 
oo 
oo 
rm+2k [ a* ..irn~p Amke-irn¢p ) 
S(r, qo)= ~ ~ 2(m + k)~"~"k~ 
+ 
m=0 k=0 
(m+k>O, 
Aok 
real) 
(33.56) 
Differentiation gives 
Aw = ~-~ ~-~rm+2k-l { m + A.kei(m+l)9 +Amke_i(m_l)~} 
m k 
(33.57) 
All the coefficients for m < 4, m + 2k _< 5 can be determined from a few 
trajectories. The Fourier series expansion (33.57) then takes the explicit 
form 
Aw = e -3i~° • r3A40 + e-2i~(r2A30 + rlA31) 
+ e-i~(rA20 + r3A12) + Alo + r2A11 + r4A12 
4 
1 2i~(r2A~ 1 + 
r4A~2) 
+ 2ei~(rA01 + r3A02) + ~e 
+ 3eai~r3A~l + 4e4i~r 4A;1 
(33.58) 
This can be rewritten more concisely in the form 
N 
Aw =: uA(r, qa)= 
~ 
e,(r)e i"~, 
(N = 4) 
(33.59) 
n=-N+l 
We now try to approximate an arbitrary complex function Aw -- u(r, qa), 
defined on a disc r < 1, by a series expansion of the form (33.59). Since 
every part of the disc is a priori of equal importance, this approximation 
is best made by an integral least-squares-fit 
1 
2~" 
F ": f 
f 
lu(r,~)-uA(r, qo),2r dr d~ = min 
r=O qa--O 
(33.6o) 

552 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
Quite generally this integration is to be approximated by a suitable discrete 
summation. With 2N equidistant azimuths ~pj = (j- 1)~r/N, j = 1...2N 
and L > 2 different radii rl ... rL, SUch a summation formula has the basic 
form 
1 
2~r 
L 
2N 
F := 
f(r, ~)r dr d~ = 
E E a'ftJ 
r=--O ~o=O 
/=1 j=l 
with discrete function values ft~ := f(rl,cpj) and positive weight factors 
Gt, normalized to unit sum. 
Introducing (33.59) into (33.60) and employing this summation for- 
mula, we obtain 
F 
L 
2N 
L 
N 
2N E Ea'lu'Jl 2 +'E E 
I=1 j=l 
I=1 n=l-N 
az {Ip.tl 2 + 2~(pt.Kt*)} = min 
with utj := u(rt, ~j) and pt, := p,(rl) and the trigonometric sums 
1 2N 
{ -ir(j - 1)n ) 
Kin := 2N E utj exp 
j=l 
N 
(n = -(N - 1)...N) 
(33.61) 
Since ray tracing in electron optics is still a time-consuming procedure, 
we choose L and N as small as possible but without significant loss of 
accuracy. A reasonable compromise is N = 4 and L = 2, which suffices 
for the determination of all the coefficients in (33.58). The discretization 
of the radial integration is then simply the two-point Gauss quadrature for 
the variable r2; we hence have G1 = 
G2 
1/2 and r 2 = 0.5(1 4- 1/vf3), 
--" 
1,2 
r1'2=(2-1-~2) 
½=0"4597'. 
0.8881 
The corresponding points in the aperture disc are shown in Fig. 33.6. The 
minimizing condition is now OF/OAg~ = 0 for all values of the subscripts # 
and v. With the convenient abbreviation [X] := ~ Xt for the sum of any 
set of quantities X, we arrive at a complex linear system of equations for 
the unknowns Agv: 
1 
/ 
[r2]Aol+[r4]A02 = ~[rK1] 
1 
[r4]Aol +[r6lAo2 = ~[r 3 gl] 
(33.62a) 

33.6 DETERMINATION AND EVALUATION OF ABERRATION DISCS 553 
O/ 
Fig. 33.6: Relative directional angles, a and 13, of the selected trajectories near the 
image plane; the outer circle indicates the full extent of the electron beam. 
[r°]A10+ 
[r2]All + 
[r4]A12 -[g0] 
[r2lAl° + 
[ralA11 + 5 [r6]A12 = [r2(K° + 
K~)I 
[r4lAl° + 4[r6]A113 + 13[rSlA12 = [r4(g° + 3 g;)l 
(33.62b) 
[r2]A20 + 
[r4]A21 = IrK_l] 
} 
[r4]A20 +--[r6lA2a = [r3(K_l + 5K~)] 
(33.62c) 
[r4]A3° + 17[r6]A31 = [r2K-2] 
1 
} 
[r6]A30 + ]--~[rS]A31 = [r4(K_2 + ~K~)] 
(33.62d) 
[r6]A40 = [r3K_3] 
(33.62e) 
These form five uncoupled symmetric subsystems with maximum rank 3. 
The coefficients on the left-hand side are fixed positive numbers, which 
need to be calculated only once and are then stored. Only the coefficients 
on the right-hand side have to be recalculated in repeated applications; the 
surviving subscript is the last one (n) in Kin. 
The procedure is self-consistent in the sense that a function S(r, ~0), 
whose gradient contains exactly the terms considered in (33.58) with ar- 
bitrary coefficients, is found exactly apart from the unavoidable rounding 
errors. Moreover, the method provides an intrinsic accuracy control, which 
is effeeted by substituting the calculated coefficients into the functional F. 

554 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
Let the expression 
1 21" 
L 
2N 
1 
Ilfll := 
- 
f(r,~p)r draw 
= 
Iftjl2Gt 
~r 
2LN t=l o 
o 
o 
denote the norm of any function f(r, ~), then e = II~Xw--UAll is the absolute 
e~o~ =d 
~ = ,/ll~Xwll the relative error of the approximation; the latter 
must satisfy * << 1. 
The Fourier analysis method not only provides a way of determining 
aberration coefficients A,~, but is also a quite general mathematical pro- 
cedure for the reconstruction of a two-dimensional real function from its 
gradient. In electron optics as well as in light optics, the function S(r, ~), 
the wave aberration, is of particular interest in wave-theoretical considera- 
tions. 
33.6.2 Some practical aspects 
The application of this method requires that the paraxial rays form a round 
cone in the image space, which implies that the corresponding cone in the 
object space is elliptic, as is sketched in Fig. 33.4. How then should the 
initial conditions be chosen? This is very rarely a serious problem. In most 
cases we know--from the symmetry properties of the system in question-- 
the directions of maximum and minimum lateral magnifications M~, My, 
respectively. Let us suppose that these magnifications and the refractive 
index v = (}i/}o) 1/2 of the image relative to the object are known. The 
appropriate starting slopes (in the rotating frame) are then 
~ = ~?)' + ~V,a~, ~o~ I, l= 1... L, 
(33.63) 
y~j = y(o °)' + vMyart sin ~J / j = 1 
2N 
For equal magnifications, as in all arrangements of round lenses and de- 
flectors with a straight optic axis, it is not really necessary to refer to the 
image side. We can simply identify the angles appearing in the theory as 
those at the starting point, thereby representing the aberrations in terms 
of initial conditions, which is often very convenient. 
Until now we have considered only the aberrations in a fixed image 
plane z = zi. Determination of the variation of the aberration coefficients 
with the coordinate z is, however, straightforward, requiring no additional 
ray tracing. The routines for solving systems of ordinary differential equa- 
tions usually furnish the solution together with its first-order derivative. In 
the approximation in which each trajectory is replaced by its local tangent, 
we have 
~x~,j(z~ + ~x,) = ~xw,(z,)+ ~Xz. Aw}(z,) + O(Az=) 

33.6 DETERMINATION AND EVALUATION OF ABERRATION DISCS 
555 
It is now easy to repeat the Fourier analysis with these new aberrations 
and to study in this way the effect of a defocus. 
Another necessary extension is the calculation of chromatic aberra- 
tions. The simplest but also the slowest method is to repeat the whole 
procedure for a few different values of the kinetic starting energy. In this 
way we could even determine the chromatic variation of each aberration 
coefficient. In almost all practical applications, such highly detailed in- 
formation is hardly ever needed. The following procedure is then more 
favourable. 
For the four rays with aperture conditions 
71" 
r = rl, 
~ = (j - 1)~, 
j = 1...4 
we solve (33.47) with the initial conditions u(0) = 0,/t(0) II/'(0), the length 
[u(0)[ being determined from (33.45). The resulting aberrations are then 
purely chromatic ones. For the complex lateral aberrations Awj, j = 1... 4, 
obtained from these solutions, a series expansion similar to (33.57) can be 
set up, but this is now truncated after the terms with m < 2, m + 2k < 3, 
hence 
• 
1 
, 
Aw -- C20re -'~ -[- C10 -4- Cll r2 -f 2C01re i~ + ~C11r2e 2i~ 
(33.64) 
This approximation is quite sufficient, since the energy shift e(I)0 is usually 
very small. Writing down (33.64) for the four rays specified above and then 
forming the trigonometric interpolation sums (33.61) with l = 1, N = 2, 
we find the four simple relations 
1 (/~W 1 + iAw2 
- 
Aw3 
- 
iAw4) 
- 
C20rl 
g-1 ---~ 
K0 
K1 
K2 
1(Awl -4- Aw2 + Aw3 4- Aw4) -- C10 A- Gilt12 
=~ 
1 (AWl - iAw2 - Aw3 + iAw4) = 2C01rl 
=~ 
1 
1 
--~(AW 1 -- 
i w  2 -~- Aw 3 -- iw4)--~C;1 r2 
(33.65) 
(the subscript l = 1 being omitted in the K-coefficients). These suffice 
for the determination of the coefficients in (33.64). An accuracy control is 
given by the requirement that C01 must be real so that the imaginary part 
of C01 represents directly a numerical error. Ignoring ~(C01) we then have 
the perturbation eikonal, which is analogous to (33.56). 
33.6.3 Integral properties of aberration discs 
So far we have been exclusively concerned with the analysis of aberrations. 

556 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
A list of coefficients, which may well be long, is, however, not very easy 
to interpret in terms of the imaging quality of a practical device. A few 
geometric parameters characterizing the size and shape of the aberration 
disc would be more helpful. This problem is usually solved in the following 
way. Depending on the purpose of the device in question, the various types 
of aberrations have different priorities. The aberrations with low priority 
are ignored; for each of the remaining ones, a corresponding aberration 
radius is estimated on the basis of rough conjectural formulae. Finally a 
root-mean-square radius is calculated, on the unjustified assumption that 
the aberrations superimpose statistically. This procedure is as unsatisfac- 
tory as it is simple. A better proposal has been made by Scherle (1983, 
1984), who approximated the cross-section of the beam by a suitably de- 
fined ellipse. It is then not even necessary to determine any aberration 
coefficients. The price of this simplification is, however, that a rather large 
number of trajectories must be traced and this requires considerable com- 
putation time. This disadvantage can be avoided by combining Scherle's 
method with the Fourier analysis procedure. 
First of all we notice that every realistic electron beam has an energy 
spectrum, characterized by a distribution function g,(e) for el < e < e2, 
f g,(e) de = 1. Here e = e~¢ is the deviation of the energy from its nominal 
value. We also take into account the fact that the aperture may not be 
illuminated uniformly; this non-uniform illumination is described by an 
intensity distribution g,(a, ~), over the aperture of radius a,,.~ = a 
a 
2~" 
a--O ~a--O 
We now define the expectation value < f > of any real or complex function 
f in the recording plane z=const. 
] 
< f(z) >= 
9,(~)9a(~, ~,)f(z, ~; ~, ~,)~, d,, d~ d~ 
o'--0 ~o----O ~--~1 
(33.66) 
We recall that (a, ~) refer to the aperture, while z does not. In order to 
apply (33.64) to the aberrations, we notice first that 
e 
Aw(z, ~; ¢,v) = ~w(z, o; ~,, v)+ --Au(z, ~m; ~,V) 
em 
(33.67) 
is a good approximation for the superposition of geometric and chromatic 
aberrations Au, if e,, is the most probable energy. It is exact if only the 

33.6 DETERMINATION AND EVALUATION OF ABERRATION DISCS 
557 
chromatic and geometric aberrations of lowest order are considered (first- 
order chromatic and third-order geometric aberrations for round lenses, for 
example). We can now define an intensity-weighted distortion < Aw(z) > 
by setting f := Aw in (33.66). We also introduce a root-mean-square (rms) 
radius 
p(z) :=< I, w- < 
> I = 
(33.68a) 
and ellipticity parameters 
el(Z) + ie2(z):=< (Aw- < Aw >)2 > 
(33.68b) 
The meaning of the latter quantities is as follows: if we shift the origin of 
the coordinates to the centre < Aw > of the ellipse: 
• = Ax- < Ax >, 
r/"= Ay- < Ay > 
(33.69) 
we obtain 
2 < ~.2 >= 
Lo 2 + el, 
2 < 7/2 >= t~ 2- el, 
2 < ~r/>= e2 
(33.70) 
The transformation to the principal axes of the ellipse is given by 
m 
= ~ cos 0 + 77 sin 0, 
= -~ sin 0 + 7/cos 0 
(33.71a) 
where the angle 0 is to be calculated from 
2 < ~r/> 
_ e2(z) 
tan 20 - < ~2 >_< 
7/2 > - el(Z) 
(33.71b) 
This rotation describes the overall effect of the anisotropic errors, if the 
directions obtained in this way are not either meridional or sagittal. The 
main axes themselves are now given by 
+ 
2< 
>= p2 + 
(33.72) 
The axes obtained in this way are smaller than the true dimensions of 
the aberration figure. 
Following Scherle's (1983) proposal, we therefore 
introduce a dilatation factor, which may almost always be set equal to two. 
Finally, we obtain the semi-axes 
( 
E1,2(z ) : ~ 
/02 _[_ 
2 _.}._ e2 
(33.73) 

558 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
In his thesis, Scherle proposed that the averaging should be performed by 
summation over many individual aberrations. This is certainly necessary 
if the initial conditions of the trajectories in the beam are so general that 
a wave aberration S cannot be used. Such a case arises, for instance, if the 
electrons start from a cathode surface or from a crossover with finite extent, 
so that the initial conditions themselves have a statistical distribution. 
In very many cases, this method is unnecessarily general and would 
entail an unreasonably large effort. Instead, we can first determine the 
aberration coefficients (Amk), either from integral expressions or from a 
Fourier analysis. These are then introduced into (33.58) or more generally 
into (33.57) and, for the chromatic effects, into (33.64). These formulae 
are now regarded as continuous interpolation formulae for the aberrations. 
Numerical evaluation of the necessary integrals is then perfectly practical. 
This is always a comparatively fast procedure since it does not require any 
new ray tracing. The approximate ellipse can be determined rapidly for 
a sequence of image planes, after which the optimal defocus can be found 
easily. 
The advantage of this method lies in the fact that it gives us very 
clear and simple criteria for optimal focusing. The best approximation to a 
stigmatic focus is obtained when, after exploring all permissible variations 
of the system parameters, the largest value of the semi-axis E1 (z) is least 
for the object point with the worst aberrations. This idea has not yet been 
much exploited in practice but it seems very likely that the method will 
prove useful and gain wide acceptance. The conclusions to which it leads 
are certainly realistic. Figure 33.7 shows, for example, how the size of the 
spherical aberration disc can be reduced by defocusing. With Scherle's 
procedure, the plane in which the beam radius is smallest is found to be at 
(8/9)Az, where Az is the defocus of the theoretical plane of least confusion 
(24.50); the radius of the disc differs by a factor of only (8/9) 1/2 = 0.94 
from the familiar radius of least confusion (24.51). This is well within the 
experimental confidence limits. 
We conclude this account of the various numerical methods of comput- 
ing aberrations and assessing their importance with the observation that 
the choice of practical procedures is wide enough to enable us to study 
virtually any electron optical system, however complicated, with sufficient 
accuracy for most practical needs. 
33.7 Optimization procedures 
Once programs for the computation of fields, trajectories, focusing proper- 
ties and aberrations have been successfully completed, it is very useful to 

33.7 OPTIMIZATION PROCEDURES 
559 
R 
z Gauss 
Z 
Fig. 33.7: Form of the caustic and of the r.m.s radius as functions of the axial coordinate 
for a round lens with spherical aberration. 
incorporate them into a program for the optimization of electron optical 
systems. Usually the purpose of optimization is to determine geometric 
and electromagnetic configurations of electrodes, polepieces and coils that 
minimize certain electron optical aberrations of the system in question sub- 
ject to given constraints, typically a fixed focal length, a minimum working 
distance or an upper bound on a coil current or some other technical limit. 
It is clear that this problem cannot be solved automatically in a perfectly 
general manner, since the technical requirements and the constraints will 
differ widely for the various kinds of electron optical devices. 
For this 
reason we cannot go into much detail here. 
33.7.1 The defect function 
The first step in any optimization procedure must be the definition of an 
appropriate defect function or 'merit function'. 
This must be a strictly 
positive quantity, which is to be minimized by varying the system param- 
eters within the allowed limits. This definition already requires a precise 
formulation of the specific requirements and constraints. The arguments 
(xl ...xn) of the defect function are the set of all those system parame- 
ters that are allowed to vary, and their domain D of definition is bounded 
by constraints: (xa...xn) E D. Quite generally the constraints can be 

560 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
represented by inequalities: 
flk(xl...xn) > O, 
k = 1...r 
(33.74) 
which include equations as special cases. 
The functional expression ¢ of the defect function is usually the square 
of a total aberration radius. This is defined in the following way. First, for 
each individual aberration a simple effective defect radius is introduced, 
for instance pl = MCsoL3/4 for the spherical aberration of a round lens 
with magnification M and aperture angle er, or P2 = MCcoeA@/~ for the 
chromatic aberration, and so on. Next, a set of non-negative weight factors 
g2... g2 is introduced, which characterize the importance of the m indi- 
vidual aberrations. Large weights mean that the corresponding aberrations 
are very serious, while low weights are associated with contributions of little 
importance. Vanishing weights mean that the corresponding aberrations 
are completely ignored. The defect function is then 
m 
m 
i=1 
i=1 
(33.75) 
with fi := gipi for i = 1... m. 
It is possible to incorporate the constraints (33.74) into the defect 
function: 
M 
m 
=: ZX} 
= 
+ 
ai(e -levi) 
j--1 
i----1 
k-----1 
(33.76) 
with M = m + r being the total number of terms. The second contribution 
is a 'penalty' function: the defect function increases for ~k < 0. This form 
of the defect function may be useful if very small violations of constraints 
are allowed; such violations can be tolerated if the constraints themselves 
represent only roughly guessed technical bounds. The magnitudes of these 
violations will depend on the particular choice of the new weights G2... G 2. 
As a simple example, we describe the appropriate defect function for 
axial focusing by an ordinary unsaturated magnetic round lens. Here we 
have to consider the spherical aberration and the axial chromatic aberra- 
tion, and we include a rough guess for the blurring caused by diffraction. 
The defect function is again a sum of squares of aberration radii. This defi- 
nition is convenient for numerical purposes, though of course the chromatic 
and geometric aberrations add linearly. Thus 
( 
~2 ---- lgl Csa 3 
+ 
g2Cca 
( 
)2 
0.61gah 
+ 
(33.77) 

33.7 OPTIMIZATION PROCEDURES 
561 
a being the aperture angle at the object point, q~ the acceleration potential 
and h Planck's constant. (For further details of the diffraction term, see 
Volume 3.) Since all three terms are equally important, we set gl = g2 = 
g3 = 1. In the absence of constraints and parameters to be varied, this 
function is still incomplete. Reasonable constraints are, for instance, fixed 
values of the object coordinate Zo and of the image coordinate zi and the 
acceptable interval fmin <_ f <_ fma, for the focal length f. The definition 
of system parameters requires a decision concerning the class of shapes 
allowed for the axial field distribution B(z). If, for instance, the simple 
model with a gap of width S and cylindrical bores with radii R1 and R2 
is employed, we should use the parameters Xl = R1, x2 = R2, x3 = S 
and x4 = J, the latter being the number of aml~re-turns. If the midplane 
of the gap is kept fixed at ZM = O, we have a well-specified optimization 
problem, so that ¢ =minimum leads to a unique solution. 
This very simple example makes it clear that only with very detailed 
specification can a reasonable answer to the optimization problem be ex- 
pected. Moreover, this example is a reminder that rough estimates of the 
form (33.77) are commonly used. These can be replaced by improved for- 
mulae for more realistic intensity distributions and their expectation values, 
but this is still uncommon. 
33.7.2 The optimization of axial distributions 
As already pointed out, the focusing properties and the aberrations of 
electron optical systems are generally determined by certain axial field dis- 
tributions, such as the electrostatic potential ¢(z) and the magnetic field 
strength B(z) on the optic axis. It is therefore tempting to try to opti- 
mize these functions. This means that, subject to the given constraints, 
the defect function is minimized by finding the 'best shapes' of these axial 
distributions. 
This procedure has been followed several times and with different ap- 
proaches. 
Moses (1973), for instance, employed variational calculus for 
the minimization of spherical aberration with simultaneously vanishing 
coma. Crewe et al. (1968) designed a field-emission electron gun under 
the assumption that the axial potential ¢(z) in the space between the first 
and second anode can be represented by a cubic polynomial, the coeffi- 
cients of which were the optimization parameters; this yielded the 'Butler 
gun'. Later Munro (1973) showed that this design does not represent a 
true optimum. Szilagyi (1977) introduced dynamic programming (see Sec- 
tion 35.3.2). In this approach the integration interval Zo < z < zi between 
object and image is dissected into a set of small subintervals. Then, starting 
from the object coordinate Zo, the integrand of an aberration integral, for 
instance that for C8, is minimized under given constraints in each of these 

562 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
subintervals. The result is then a piecewise analytic axial field distribution, 
for example (Szilagyi, 1984, 1987) a cubic spline, which is then assumed to 
be the best field. 
Common to all methods starting from axial field distributions is the 
severe difficulty of finding reasonably shaped electrodes or polepieces to 
generate these axial fields. Analytic continuation of the axial potentials 
into off-axis domains by means of the radial series expansions of Chapter 7 
generally leads to equipotentials with a singular character such as sharp 
edges in the vicinity of the optic axis or even vanishing bore radii. In order 
to avoid these, the electrode structure has to be altered, but the additional 
fringe fields thus introduced cast doubt on the whole design procedure. 
For these reasons, no really convincing design, based on an optimiza- 
tion of an axial field function, has so far been published and we can hence 
not recommend this method. There remains only the laborious technique 
in which the appropriate boundary-value problems are solved repeatedly 
for different geometric shapes, with the risk that the best solution may not 
belong to the set of configurations analysed. 
33.7.3 The damped least-squares method 
The damped least-squares method was first described by Levenberg (1944) 
and has been successfully applied to light optical design problems. In 1982, 
it was introduced into electron optics (Chu and Munro, 1982; Munro and 
Chu, 1982). We now briefly outline their method. 
The defect function is represented in the form (33.75). If the arguments 
xj are varied by small increments Axj (j = 1... n), the functions fi alter 
by 
n 
/i -- fi 4- E aijAxj' 
j--1 
i)fi 
j = 1...n 
aij = Oxj ' 
i = 1...m, 
(33.78a) 
(33.78b) 
This linear approximation is adequate if all the increments Axj are suffi- 
ciently small. The new defect function is now 
m 
o 
)2 
-- E (fi "4- E aijAxj 
(33.79) 
i=1 
j=l 
The minimization conditions O~k/O(Axj) - 
0 for j - 
1...n lead to n 
simultaneous linear equations for the increments AZl ... Ax,, which could 
be solved by straightforward techniques. 

33.7 OPTIMIZATION PROCEDURES 
563 
Unfortunately this simple undamped least-squares method is unstable 
and can diverge. In order to avoid this instability, (33.79) is modified to 
n 
2AX2 
j=l 
= E 
fi-F 
aijAxj 
i 
1 
"= 
j=l 
2 
,~ 
(33.80) 
+E 
2 
2 
pjAxj 
j=l 
where the factors pj are called damping coefficients. Obviously we have 
< C t, so that a minimum of C t corresponds to a minimum of ¢. The 
minimization conditions 0¢t/O(Axk) = 0 now take the form 
i•1 
aik fi + 
aijAxj 
+ p2kAxk = 0 
"---- 
j----1 
(k = 1...n) 
(33.81) 
These form a system of n simultaneous linear equations for the unknowns 
Axl... Axn, the coefficient matrix being symmetric and positive definite. 
_(n) = xj + Axj depend on the choice of the 
The new coordinates x j 
damping coefficients. 
Two different choices are proposed by Chu and 
Munro: 
2 __p2 
Pj 
J 
2 ._.p2 
2 
PJ 
E aij 
i=1 
(additive damping method) 
(multiplicative damping method) 
(33.82a) 
(33.s2b) 
p being a constant damping factor. With (33.82a), each diagonal element 
of the matrix in (33.81) is enlarged by an additive term p2, while with 
(33.82b), each diagonal element is multiplied by (1 + p2). The numeri- 
cal solution of (33.81) must be repeated for various values of p, until the 
smallest value of ¢~ is found. 
The partial derivatives aij that appear in the above equations are to 
be calculated numerically from a simple two-point formula: 
of, 
f~(~s + ~xs) - f~(~j) 
aij = Oxj 
- 
5xj 
(33.83) 
5xj being a small increment. According to Chu and Munro, this linear 
approximation is sufficient, since the whole minimization procedure must 

564 
33. NUMERICAL CALCULATION OF TRAJECTORIES 
in any case be repeated if the starting point is far distant from the final 
optimal configuration. 
Chu and Munro have made extensive investigations concerning the ap- 
plicability of this method and set up an interactive program. For reasons 
of space we cannot outline this here and refer to the corresponding pub- 
lication, where full details are to be found. Concerning the optimization 
of geometric configurations, Chu and Munro made the following compro- 
mise: for each electron optical element, for instance round electrostatic 
and magnetic lenses and electric or magnetic deflectors, reasonable geo- 
metric shapes were assumed and for these the boundary-value problems 
were solved exactly beforehand. Later, during the optimization process, 
all operations that can be performed without a new field calculation were 
allowed: changes of electric or magnetic parameters such as the electrode 
potentials or coil currents, axial shifts of the object plane, the image plane 
or of entire deflectors, rotation of deflectors about the optic axis and scale- 
transformations in independent elements. In principle it is also possible 
to alter the geometric shape of electrode or polepiece surfaces but then 
an entirely new field calculation is necessary, which requires considerable 
computing time. 
The great advantage of this method is that each optimization step 
results in a realistic configuration, which could be constructed. The appli- 
cability of this method was demonstrated for focusing and dual-channel de- 
flection systems, which are employed in electron beam lithography. A very 
detailed knowledge of the technical requirements in electron beam lithog- 
raphy is needed to understand the particular features of the optimization; 
much more discussion is to be found in Chapter 40 and we merely observe 
that the results published by Chu and Munro are distinctly encouraging. 
We conclude that the damped least-squares method is at present the 
most effective way of solving optimization problems. 

34 
The Use of Computer Algebra Languages 
34.1 Introduction 
The familiar computer languages are designed to perform numerical cal- 
culations efficiently but are extremely ill-adapted to any kind of symbolic 
calculation: it is trivial to list z := (x + y)P for values of x and y that may 
contain many digits and any reasonable values of p but much less easy to 
output the binomial expansion; numerical integration of a function such as 
xp sin qx is again trivial but the closed form of the integral cannot be found; 
the same is true of differentiation. There are powerful routines for solving 
differential equations numerically, as we have seen in Chapter 33, but there 
is no way of knowing whether the equation has a solution in terms of tabu- 
lated (or easily computed) functions. It was for reasons such as these that 
the various members of the family of algebra languages were born, and 
indeed many were created to perform specific calculations of great com- 
plexity in such fields as celestial mechanics, general relativity and quantum 
electrodynamics. 
We shall not describe any particular language here. We simply mention 
the principal tasks that can be undertaken and indicate their relevance in 
electron optics. Details are of course to be found in the manuals of each lan- 
guage and a useful survey is given by van Hulzen and Calmet (1982). The 
languages which are most widespread among physicists at present are prob- 
ably REDUCE (Hearn, 1985; Fitch, 1985; Rayna, 1987) and MACSYMA 
(MIT, 1983; Rand, 1984; Pavelle, 1985; Rand and Armbruster, 1987). We 
know of only two examples of the use of a general language to perform 
algebraic calculations in electron optics: ALGOL (Dodin and Nesvizhskii, 
1981; Nesvizhskii, 1986) and FORTRAN (Berz and Wollnik, 1987). The 
proceedings of the conferences that are regularly held on progress in com- 
puter algebra give a vivid picture of the growth of the subject (e.g. Ng, 
1979; Calmet, 1982). For a full list with many other references, see the 
background text edited by Buchberger et al. (1982) and Davenport et al. 
(1988). 

566 
34. THE USE OF COMPUTER ALGEBRA LANGUAGES 
34.2 Computer algebra, its role in electron optics 
In physics, algebra languages were first used mainly for calculations that 
involved performing elementary operations on very large opera~ds. The 
number of terms being enormous, the risk of human error was correspond- 
ingly large and the computer was used first to check the hand calculation 
and later, as confidence in these languages grew, to replace it altogether. 
A basic operation is therefore multinomial expansion of expressions of the 
form (xl + x2... + xn) m, where the variables xi may themselves consist 
of several terms. Since the resulting expression will usually contain a very 
large number of terms, another important family of operations permits so- 
y q for given p and q. 
phisticated sorting of these into groups: all terms x i x i 
for example, or such that p + q takes a given value, or such that p < q. If 
the xi are circular or hyperbolic functions, or functions of such functions, 
some kind of reduction or simplification will probably be desirable and fa- 
cilities for replacing sin v x sin q x and similar terms by functions of multiples 
of x are provided or can be incorporated. An important aspect of these 
languages is that they can be 'taught' results that are not in their regular 
repertoire. In a program in which Bessel functions and their derivatives ap- 
peared, for example, the language could be instructed to use the well-known 
recurrence formulae that relate J,.,, JIn,Jn+l and Jn-1; indeed the numer- 
ous relations between contiguous hypergeometric functions (Whittaker and 
Watson, 1927, Section 14.7) could just as easily be included if required. A 
further elementary operation is substitution: flexible commands permitting 
substitution of an expression for a variable are provided. The next fam- 
ily of operations is concerned with calculus: these languages are capable 
of differentiating the everyday functions such as exponentials, logarithms, 
circular and hyperbolic functions and of course powers of a variable. They 
can also work correctly with the derivative of a general function so that 
an expression of the form f f'(x)sinx dx, for example, can be evaluated 
by partial integration. Depending on the degree of sophistication of the 
language, indefinite integration of more or less complicated expressions can 
likewise be performed. Integration of simple expressions is a routine matter 
but recent work has shown that these algebra languages can be extended to 
integrate any expression for which a solution in closed form exists, provided 
that the functions occurring in the integrand belong to a certain set of func- 
tions. See Norman and Davenport (1979) for a very readable account of an 
earlier stage in this development and Norman (1982). 
Expansion, substitution, sorting, differentiation and integration: al- 
though other operations are available in some languages, it is these that 
have proved most useful in electron optics, where computer algebra has 

34.2 COMPUTER ALGEBRA, ITS ROLE IN ELECTRON OPTICS 
567 
been used primarily to derive or check integral expressions for the aber- 
ration coefficients of various types of electron optical component. Let us 
consider the steps for a typical aberration coefficient. First we must sub- 
stitute the expansions for q, and the components of A into the refractive 
index {(~(1 + X '2 + Y")} ½ - rI(AxX' + AyY' + Az) (15.23) truncated after 
terms of a particular degree. If the rotating coordinate system is to be em- 
ployed, the appropriate transformation from (X, Y, z) to (x, y,z) must be 
made. The resulting terms must then be sorted according to their degree 
in x, y, x ~, y~. It is generally necessary to make a further substitution at 
this point, replacing the coordinates that appear in the group of primary 
aberration terms by the paraxial approximation. The result must be sorted 
I 
I 
according to the powers of the paraxial coordinates (e.g. x,,, yo, xo, Yo), 
in order to extract individual aberration coefficients. If higher order per- 
turbation theory is to be used, a substitution involving paraxial terms and 
the primary aberrations in an arbitrary plane is also needed, followed by 
sorting of the same kind. 
Once the aberration integrals have been derived, further laborious cal- 
culations may be needed. If the integrals are to be evaluated numerically, 
using measured or computed values of the various field functions that occur, 
it may be desirable to remove terms in which high-order derivatives appear 
by partial integration. The systematic procedure described in Chapter 24 
at some length is the best way of doing this, and once the fundamental 
structures (e.g. 24.56) have been recognized, the subsequent differentia- 
tion, incorporation of the paraxial equation, multiplication by arbitrary 
constants and addition to the original coefficients or eikonal function can 
all be performed by the computer. 
If, however, the behaviour of some unfamiliar component is being stud- 
ied as a preliminary to exact numerical computation of ranges of values of 
the parameters of apparent interest, it is often helpful to adopt a simple but 
realistic field model. Despite its shortcomings, Glaser's bell-shaped model 
(Chapter 36) is invaluable for grasping the behaviour of magnetic lenses 
and is invariably used for teaching purposes; for quadrupoles, the rectan- 
gular and bell-shaped models are perfectly adequate for many purposes, 
and several other types of component are likewise represented rather well 
by simple models. Evaluation of the aberration integrals for these models 
is another lengthy task, involving the manipulation of unwieldy expressions 
frequently involving powers of circular and hyperbolic functions. Computer 
algebra languages are well-equipped to perform this. 
We have mentioned the use of partial integration to cast aberration 
integrals into a form suitable for numerical evaluation, but how is the lat- 
ter to be implemented? Computer algebra languages originally provided 
their answers only as algebraic formulae, which had then to be programmed 

568 
34. THE USE OF COMPUTER ALGEBRA LANGUAGES 
manually in one of the ordinary high-level languages suited to numerical 
computation. This was clearly inefficient since one of the attractions of de- 
riving large formulae by computer is to eliminate the risk of human error, 
but such mistakes are just as likely to creep in when translating the alge- 
braic output into FORTRAN or PASCAL. By 1980, therefore, as a result 
of a considerable effort, symbolic-numeric interfaces had been developed, 
notably for REDUCE. The user of this language can now generate a FOR- 
TRAN routine automatically from his algebraic output, which is clearly a 
great improvement. 
The calculation of aberration integrals is not of course the only la- 
borious task facing the theoretician in electron optics, and the operations 
mentioned above are only a selection of those available. Recent versions of 
REDUCE thus include new packages for integration, for polynomial factor- 
ization, for solving ordinary differential equations and integral equations, 
for arbitrary precision floating-point arithmetic and for network analysis 
problems, including calculation of the determinants of sparse matrices (van 
Hulzen and Calmet, 1982). 
34.3 Two practical examples 
The languages CAMAL (Barton and Fitch, 1972; Fitch, 1985) and RE- 
DUCE (Hearn, 1985) have been used in electron optics to obtain relativis- 
tically correct formulae for the third-order geometric aberrations of round 
electrostatic lenses (Hawkes, 1977), to derive aberration coefficients for 
combined deflection and focusing fields (Soma, 1977, cf. Section 32.3.2) 
and to study the aberrations of microwave cavities acting as dynamic elec- 
tron lenses (Hawkes, 1983; cf. Section 41.5). We shall describe very briefly 
the first two of these; the first illustrates the simplicity of the programming 
while the second shows that a gargantuan task is well within the capacity 
of such languages. 
34.3.1 Round electrostatic lenses 
The language CAMAL, which is extremely easy to learn, represents alge- 
braic expressions in a notation very close to that in common use, apart 
from the inevitable linearization, that is, replacement of suffixes and in- 
dices by symbols in brackets or preceded by a code indicating, for example, 
exponentiation. It was adopted for the calculation of the relativistic forms 
of electrostatic lens aberration coefficients, the calculation dividing natu- 
rally into a series of short blocks. An extremely detailed account is given in 
Hawkes (1977) and here we reproduce only two short sections of program 
which illustrate two important points: first, that the actual calculation re- 

34.3 TWO PRACTICAL 
EXAMPLES 
569 
quires very few lines of program whereas the sorting may occupy a great 
many, unless the notation is chosen to facilitate this step, in which case the 
resemblance between the programmed formulae and their familiar versions 
will be reduced. The second point is that the output can be organized in 
such a way that the effort of interpretation is slight. 
The first passage represents the expansion of the refractive index M, 
F := ¢ ½ [1 + { ~(1 + x '2 + !/'2) - ¢}/¢] ½ (M has been replaced by F since M 
always denotes an integer). This is accomplished by writing 
1 
1 
A = u < 0 > -~u < 2 > b+ ~-~u < 4 > b.2 
F = A(1 +eA)(1 + c)- u < 0 > (1 +eu < 0 >) 
1 
2Ff 
8F.2f.3 
F=g+ 
- 
together with some simple housekeeping instructions, where f := ¢-½, 
u< 0 > := ¢, u< 2 > := ¢", u< 4 > := ¢(4), b'= 
(x 2+y2) andc := 
I 
(x,2 + y,2); e denotes e. Into F we substitute x = xog(z) + xoh(z ) and 
similarly for y; this entails two definitions and two instructions, each pair 
of the form 
V=z<0>g<0>.2+z< 
l>h<0>.2+2z<2>g<0>h<0 
> 
F = SUB(F, V, b) 
2 
2 Xto2 
t2 
which replace b = x 2 + y2 by V in F, the z < I > denoting x o + Yo, 
+ Yo, 
XoX: + yoy~, for I = 0,1, 2 respectively. Dots signify powers, in the sense 
that b.2 denotes b 2. 
Some 50 lines are then occupied by sorting instructions, after which 
we obtain the coefficients F[I] in 
F[41 = F[0I(x2o + y2)2 + F[ll(x~ + y~)2 
+ F[2l(xox'o + yoy,,)2 + F[3I(x~ + y~)(x 7 + y,2) 
+ F[41( x2 + Y2,,)(XoX'o + YoY'o)+ F[5l(x~ + y',,2)(XoX'o + yoy:) 
in terms of the coefficients of the various powers of g(z) =" g < 0 >, h(z) =" 
h < 0 > and their derivatives g'(z) ='g < 1 > and h'(z) =: h < 1 >. The 
following passage outputs a text to remind the user of the definitions of the 
A[I] and then lists the latter in the form A[I] .... • 

570 
34. THE USE OF COMPUTER ALGEBRA LANGUAGES 
TEXT 
F[0] = (1/4) (A[0] g<0>.4 + 2 A[1] g<0>.3 g<l> 
+ 2 A[2] g<0>.2 g<l>.2 
+ 2 A[3] g<0> g<l>.3 + A[4] g<l>.4) 
FIll = (1/4) (A[0] h<0>.4 + 2 A[1] h<0>.3 h<l> 
4- 2 A[2] h<0>.2 h< 1 >.2 
4- 2 A[3] h<0> h<1>.3 4- A[4] 5<1>.4) 
. 
F[5I = A[0I g<0> h<0>.3 
-(1/2) A[1] h<0> (3g<l> h<0>.2 + g<0> h<1>.2) 
+ A[2] h<0> h<l> (g<0> h<0> + g<l> h<l>) 
+ (1/2) A[3] h<l> (g<l> h<0>.2 + 3 g<0> h<1>.2) 
+ A[4] g<l> h<1>.3 
NOTE A[5] = A[6] - 4A[7] 
. 
FOR I = 0:1:7 
PRINT [A[I]] 
REPEAT 
PAGE 
V=0 
FOR I = 0:1"7 
A[I]= SUB(A[I],V ,e) 
PRINT [A[I]] 
REPEAT 
The last few lines list the non-relativistic approximation by setting e(= e) 
equal to zero with the aid of the instruction SUB. 
The other feature of interest in the program is the use of a SET facility 
to impose side-relations during a calculation. Here these side-relations are 
needed in the generation of functions A[I] including partial integration. The 
side-relations supplement the relations known to the language by specifying 
the derivatives of the various quantities involved and including simplifica- 
tion by means of the paraxial equation. The original refractive index (F) 
is extended as explained in Chapter 24. 
34.3.2 Superimposed focusing and deflection fields 
We have seen in Chapter 32 that the number of aberration coefficients be- 
comes very large when the various deflection fields may be magnetic or 
electrostatic or even both; relativistic terms render the formulae still more 
complicated as does inclusion of dynamic as well as static potentials. This 
very general case was studied with the aid of REDUCE by Soma (1977), 

34.3 TWO PRACTICAL EXAMPLES 
571 
who obtained relativistically correct aberration integrals for all the geomet- 
ric and chromatic aberration coefficients. Soma does not give any details 
of his REDUCE routines but two important points are worth singling out. 
First, the manuscript of the published article, including all formulae, Greek 
letters and mathematical symbols, was typed directly by means of an on- 
line text-editing system. Such systems are now becoming common, if not 
yet commonplace, but in 1977 such an original output facility was rightly 
seen as a considerable asset. Secondly, by using REDUCE, Soma was able 
to generate a FORTRAN routine directly for the numerical evaluation of 
his numerous aberration coefficients, an essential step in the search for con- 
figurations with low aberrations by the methods described in Chapter 33, 
for example, and applied to this specific case by Chu and Munro (1982), 
who employed the damped least-squares procedures very effectively. 

This Page Intentionally Left Blank

Contents of Voi ume 2 
PART VII- INSTRUMENTAL OPTICS 
Chapter 35 
Chapter 36 
Chapter 37 
Chapter 38 
Chapter 39 
Chapter 40 
Electrostatic Lenses 
Magnetic Lenses 
Electron Mirrors 
Cathode Lenses and Field-Emission 
Microscopy 
Quadrupole Lenses 
Deflection Systems 
PART VIII- ABERRATION CORRECTION AND BEAM 
INTENSITY DISTRIBUTION (CAUSTICS) 
Chapter 41 
Chapter 42 
Aberration Correction 
Caustics and their Applications 
PART IX- ELECTRON GUNS 
Chapter 43 
Chapter 44 
Chapter 45 
Chapter 46 
Chapter 47 
Chapter 48 
Chapter 49 
Chapter 50 
General Features of Electron Guns 
Theory of Electron Emission 
Pointed Cathodes without Space Charge 
Space Charge Effects 
Brightness 
Emittance 
The Boersch Effect 
Complete Electron Guns 
PART X- SYSTEMS WITH A CURVED OPTIC AXIS 
Chapter 51 
Chapter 52 
Chapter 53 
General Curvilinear Systems 
Magnetic Sector Fields 
Unified Theories of Ion Optical Systems 
573 

This Page Intentionally Left Blank

Notes and References 

This Page Intentionally Left Blank

Notes and References 
The following lists of references follow the main divisions of the book with 
the exception of those corresponding to Part VII (Instrumental Optics). 
The lists for Chapters 35 (electrostatic lenses) and 36 (magnetic lenses) are 
so long that it seemed preferable to give them separately. 
In order to avoid repetition, standard abbreviations have been adopted 
for several series of conference proceedings, namely, the European and In- 
ternational conferences on electron microscopy, which have alternated every 
two years since 1954 (prior to that date they were not quite so regular); 
the occasional conferences on high-voltage electron microscopy; the annual 
meetings of the Electron Microscopy Society of America; and the biennial 
meetings of the Electron Microscopy and Analysis Group of the British In- 
stitute of Physics. The European and International Conferences are iden- 
tiffed by date and place, the high-voltage conferences by date followed by 
HVEM and place, the American meetings by date followed by EMSA and 
meeting number and the British meetings by date followed by EMAG. Full 
bibliographic details of all these conference volumes are to be found at the 
end of this section, after the references for Part X. 
Some of the lists that follow contain papers that are not cited in the 
text. With one exception, however, all these additional references are cited 
in the notes that precede the lists with some indication of their contents. 
The exception concerns the Preface and the introductory first chapter. This 
contains a very full list of books on electron optics; texts that are devoted 
mainly to electron microscopy are not included, however. 
Despite the length of these lists, we make no claim to completeness 
and indeed, the coverage is deliberately uneven. For some topics, excellent 
bibliographies have been compiled and we have referred to these rather 
than merely repeating their contents. There are others, however, for which 
the literature is very scattered--electron guns are an example--and here 
we have attempted to give rather thorough coverage. We shall be most 
grateful to have any errors or serious omissions drawn to our attention. 
Preface and Chapter 1 
Afanas'ev, V.P. and Yavor, S.Ya. (1978). Elektrostaticheskie Energoanalizalory dlya 
Puchkov Zaryazhennykh Chastits (Nauka, Moscow). 

578 
NOTES AND REFERENCES 
Alyamovskii, I.V. (1966). Elektronnyi Puchki i Elektronnyi Pushki (Sovetskoe Radio, 
Moscow) 
Ardenne, M. von (1938). Z. Physik 109,553-572 and Z. Tech. Phys. 19,407-416. 
Ardenne, M. yon (1940).EIektronen-~]bermikroskopie 
(Springer, Berlin). 
Ardenne, M. von (1956). Tabellen der Elektronenphysik, Ionenphysik und ~]bermikrosko- 
pie, 2 vols (Deutscher Verlag der Wissenschaften, Berlin). 
Ardenne, M. von (1962). Tabellen zur Angewandten Physik. L Elektronenphysik, []ber- 
mikroskopie, Ionenphysik (Deutscher Verlag der Wissenschaften, Berlin); 2nd ed., 
1973. 
Ardenne, M. von (1978). Optik 50, 177-188 and Bild und Ton 31,293-297. 
Ardenne, M. von (1985). On the history of scanning electron microscopy, of the electron 
microprobe, and of early contributions to transmission electron microscopy. In 
Hawkes (1985), pp. 1-21. 
Balladore, J.-L. and Murillo, R. (1977). J. Microsc. Spectrosc. Electron. 2,211-222. 
Banford, A.P. (1966). The Transport of Charged Particle Beams (Spon, London). 
Baranova, L.A. and Yavor, S. Ya. (1986). Elektrostaticheskie Elektronnye Linzy (Nauka, 
Moscow); Adv. Electron. Electron Phys. 
Boersch, H., Bostanjoglo, O. and Grohmann, K. (1966). Z. Angew. Phys. 20, 193-194. 
Bonshtedt, B.E. and Markovich, M.G. (1967). 
Fokusirovka i Otklonenie Puchkov v 
Elektronno-luchevykh Priborakh (Sovetskoe Radio, Moscow). 
Borries, B. von (1949). Die Ubermikroskopie (Editio Cantor, Aulendorf). 
Borries, B. von and Ruska, E. (1940). Ergebn. Exakt. Naturwiss. 19,237-272. 
Broglie, L. de (1925). Ann. Physique (Paris) 3, 22-128. 
Broglie, L. de, ed. (1946). L'Optique Electronique (Edns Rev. Opt. Theor. Instrum., 
Paris). 
Broglie, L. de (1950). Optique Electronique et Corpusculaire (Hermann, Paris). 
Briiche, E. and Recknagel, A. (1941). 
Elektronenger?ite, Prinzipien und Systematik 
(Springer, Berlin). 
Briiche, E. and Scherzer, O. (1934). Geometrische Elektronenoptik (Springer, Berlin). 
Busch, H. (1926). Ann. Physik (Leipzig) 81,974-993. 
Busch, H. (1927). Arch. Elektrotech. 18,583-594. 
Busch, H. and Briiche, E., eds (1937). Beitrh'ge zur Elektronenoptik (Barth, Leipzig). 
Carey, D.C. (1987). The Optics of Charged Particle Beams (Harwood, Chur, London and 
New York). 
Castaing, R. (1951). Application des Sondes Electroniques h une Mdthode d'Analyse 
Ponctuelle Chimique et Cristallographique. Th~se, Paris, 92 pp. 
Castaing, R. and Henry, L. (1962). C.R. Acad. Sci. Paris 255, 76-78. 

PREFACE AND CHAPTER 1 
579 
Chen, W.-x. (1986). Introduction to Electron Optics [in Chinese] (Beijing University 
Press, Beijing). 
Cosslett, V.E. (1946). Introduction to Electron Optics (Clarendon, Oxford); 2nd ed., 
1950. 
Cosslett, V.E. (1950). Bibliography of Electron Microscopy (Arnold, London). 
Cosslett, V.E. (1981). Contemp. Phys. 22, 3-36 and 147-182. 
Cosslett, V.E. and Duncumb, P. (1956). Stockholm, pp. 12-14. 
Crewe, A.V. (1965). A scanning transmission microscope utilizing electron energy losses. 
Unpublished abstract, Conference on Non-conventional Electron Microscopy, Cam- 
bridge. 
Crewe, A.V. (1970). Q. Rev. Biophys. 3, 137-175. 
Crewe, A.V. (1973). Prog. Opt. 11,223-246. 
Crewe, A.V. (1983). Science 221,325-330. 
Crewe, A.V. (1984). J. Ultrastruct. Res. 88, 94-104. 
Crewe, A.V., Wall, J. and Welter, L.M. (1968). J. Appl. Phys. 39, 5861-5868. 
Dahl, P. (1973). Introduction to Electron and Ion Optics (Academic Press, New York 
and London). 
Davisson, C.J. and Cermet, L.H. (1927). Phys. Rev. 30,705-740; Nature 119,558-560. 
Devyatkov, N.D., ed. (1977). Melody Rascheta Elektronno-opticheskikh Sistem (Nauka, 
Moscow). 
Dietrich, I. (1976). Superconducting Electron-optic Devices (Plenum, New York and 
London). 
Dietrich, I., Pfisterer, H. and Weyl, R. (1969). Z. Angew. Phys. 28, 35-39. 
Driest, E. and Miiller, H.O. (1935). Z. Wiss. Mikrosk. 52, 53-57. 
Duncumb, P. (1958). Berlin, vol. 1, pp. 267-269. 
Dupouy, G. (1952). Eldments d'Optique Electronique (Armand Colin, Paris); 2nd ed., 
1961. 
Dupouy, G. (1968). Adv. Opt. Electron Microsc. 2, 167-250. 
Dupouy, G. (1985). In The Beginnings of Electron Microscopy (Hawkes, P.W., ed.) pp. 
103-165; Adv. Electron. Electron Phys. Suppl. 16. 
Dupouy, G., Pettier, F. and Durrieu, L. (1960). C.R. Acad. Sci. Paris 251, 2836-2841. 
E1-Kareh, A.B. and E1-Kareh, J.C.J. (1970). Electron Beams, Lenses and Optics, 2 vols 
(Academic Press, New York and London). 
Felici, N.J. (1965). Introduction h l'Optique Corpusculaire (Gauthier-Villars, Paris). 
Fern£ndez-Mor£n, H. (1965). Proc. Natl Acad. Sci. USA 53,445-451. 
Fujita, H. (1986). History of Electron Microscopes (Business Center for Academic Soci- 
eties Japan, Tokyo). 

580 
NOTES AND REFERENCES 
Gabor, D. (1945). The Electron Microscope (Hulton, London). 
Gabor, D. (1957). Elektrotech. Z. A78, 522-530. 
Gettner, M.E. and Ornstein, L. (1956). In Physical Techniques in Biological Research 
(Oster, G. and Pollister, A.W., eds) vol. 3, pp. 627-686 (Academic Press, New 
York and London). 
Gl~ser, W. (1952). Grundlagen der Elektronenoptik (Springer, Vienna). 
Glaser, W. (1956). Elektronen- und Ionenoptik. In Handbuch der Physik (Fliigge, S., 
ed.) vol. 33, pp. 123-395 (Springer, Berlin). 
Good, R.H. and Miiller, E.W. (1956). Field emission. In Handbnch der Physik (Fliigge, 
S., ed.) vol. 21, pp. 176-231 (Springer, Berlin). 
Grime, G.W. and Watt, F. (1984). Beam Optics of Quadrupole Probe-forming Systems 
(Adam Hilger, Bristol). 
Grinberg, G.A. (1942). Dokl. Akad. Nauk SSR 37, 172-178 and 261-268. 
Grinberg, G.A. (1943a). Dokl. Akad. Nauk SSR 38, 78-81. 
Grinberg G.A. (1943b). Zh. Tekh. Fiz. 13, 361-388 (Russian translation of Grinberg 
1942, 1943 a). 
Grivet, P., Bernard, M.Y. and Septier, A. (1955). Optique Electronique, vol. 1, Lentilles 
glectroniques (Bordas, Paris). 
Grivet, P., Bernard, M.Y., Bertein, F., Castaing, R., Gauzit, M. and Septier, A. (1958). 
Optique Electronique, vol. 2, Microscopes, diffractographes, spectrographes de 
masse, oscillographes cathodiques (Bordas, Paris). 
Grivet, P. (1965). Electron Optics (Pergamon, London and New York); 2nd ed., 1972. 
Grosser, J. (1983). Einfiihrung in die Teilchenoptik (Teubner, Stuttgart). 
Haine, M.E. (1961). The Electron Microscope, the Present State of the Art (Spon, Lon- 
don). 
Hall, C.E. (1953). Introduction to Electron Microscopy (McGraw-Hill, New York and 
London); 2nd ed., 1966. 
Hardy, D.F. (1973). Adv. Opt. Electron Microsc. 5, 201-237. 
Hurting, E. and Read, F.H. (1976). Electrostatic Lenses (Elsevier, Amsterdam, Oxford 
and New York). 
Hatschek, P. (1937). Optik des Unsichtbaren. Eine Einfgthrung in die Welt der Elektronen- 
Optik (Franckh'sche Verlagshandlung, Stuttgart); Electron Optics (American Pho- 
tographic Publ. Co., Boston, 1944). 
Hawkes, P.W. (1966). Quadrupole Optics (Springer, Berlin and New York); Springer 
Tracts in Modern Physics, vol. 42. 
Hawkes, P.W. (1968). Optik 27, 287-304. 
ttawkes, P.W. (1970). Quadrupoles in Electron Lens Design (Academic Press, New York 
and London); Adv. Electron. Electron Phys., Suppl. 7. 

PREFACE AND CHAPTER 1 
581 
Hawkes, P.W. (1972). Electron Optics and Electron Microscopy (Taylor and Francis, 
London). 
Hawkes, P.W., ed. (1973). Image Processing and Computer-aided Design in Electron 
Optics (Academic Press, London and New York). 
Hawkes, P.W., ed. (1982). Magnetic Electron Lenses (Springer, Berlin and New York); 
Topics in Current Physics, vol. 18. 
Hawkes, P.W., ed. (1985). The Beginnings of Electron Microscopy (Academic Press, 
Orlando and London); Adv. Electron. Electron Phys. Suppl. 16. 
Hawkes, P.W. and Valdrh, U. (1977). J. Phys. E: Sci. Instrum. 10,309-328. 
Humphries, S. (1986). Principles of Charged Particle Acceleration (Wiley-Interscience, 
New York and Chichester). 
II'in, V.P. (1974). Chislennye Melody Resheniya Zadach Elektrooptiki (Nauka, Novosi- 
birsk). 
II'in, V.P., ed. (1982). Melody Rascheta Elektronno-opticheskikh Sistem (Computer 
Centre, Novosibirsk). 
II'in, V.P., ed. (1983). Algoritmy i Melody Raschela Eleklronno-opticheskikh Sistem 
(Computer Centre, Novosibirsk). 
II'in, V.P., Kateshov, V.A., Kulikov, Yu. V. and Monastyrskii, M.A. (1987). Chislen- 
nye Melody Optimizatsii Emissionnykh Elektronno-oplicheskikh Sistem (Nauka, 
Novosibirsk); Adv. Electron. Electron Phys. 
Jacob, L. (1950). Introduction to Electron Optics (Methuen, London). 
Zasper, E. (1982). In Magnetic Electron Lenses (Hawkes, P.W., ed.) pp. 
57-118 
(Springer, Berlin and New York). 
Kasper, E. (1984). In Electron Optical Systems for Microscopy, Microanalysis and Mi- 
crolithography (Hren, J.J., Lenz, F.A., Munro, E. and Sewell, P.B., eds) pp. 63-73 
(Scanning Electron Microscopy, AMF O'Hare). 
Kasper, E. and Lenz, F. (1980). The Hague, vol. 1, pp. 10-15. 
Kas'yankov, P.P. (1956). Teoriya Eleklromagnilnykh Sistem s krivolineinoi Os'yu (Uni- 
versity Press, Leningrad). 
Kel'man, V.M. (1955). Elektronnaya Optika (Izd. Akad. Nauk SSSR, Moscow and 
Leningrad); 2nd ed., 1968 (Nauka, Moscow). 
Kel'man, V.M. and Yavor, S. Ya. (1959). Elektronnaya Optika (Izd. Akad. Nauk SSSR, 
Moscow and Leningrad); 2nd ed., 1963; 3rd ed., 1968 (Nauka, Leningrad). 
Kel'man, V.M., Karetskaya, S.P., Fedulina, L.V. and Yakushev, E.M. (1979). Elektronno- 
opticheskie Elementy Prismennykh Spektwmetrov Zaryazhennykh Chastits (Nauka, 
Alma-Ata). 
Kel'man, V.M., Rodnikova, I.V. and Sekunova, L.M. (1985). Staticheskie Mass-Spektw- 
merry (Nauka, Alma-Ata). 

582 
NOTES AND REFERENCES 
Kim, K.-H. and Choi, S.-K. (1963). Optics of Charged Particles [in Korean] (Korean 
Academy of Sciences, Pyong-Yang). 
Klemperer, O. (1939). Electron Optics (University Press, Cambridge); 2nd ed., 1953; 3rd 
ed., see Klemperer and Barnett (1971). 
Klemperer, O. (1961). Electron Physics, the Physics of the Free Electron (Butterworths, 
London). 
Klemperer, O. and Barnett, M.E. (1971). Electron Optics (University Press, Cambridge). 
Knoll, M. and Eichmeier, J. (1966). Technische Elektronik, vol. 2, Stromsteuernde und 
elektronenoptische Entladungsgerh'te (Springer, Berlin and New York). 
Knoll, M. and Ruska, E. (1932a). Ann. Physik (Leipzig) 12, 607-640 and 641-661. 
Knoll, M. and Ruska, E. (1932b). Z. Physik 78, 318-339. 
Kotov, V.I. and Miller, V.V. (1969). 
Fokusirovka i Razdelenie po Massam Chastils 
Vysokykh Energii (Atomizdat, Moscow). 
Krause, F. (1936). Z. Physik 102, 417-422. 
Laberrigue, A. and Levinson, P. (1964). C.R. Acad. Sci. Paris 259,530-532. 
Lawson, J.D. (1977). The Physics of Charged-Particle Beams (Clarendon, Oxford); 2nd 
ed., 1988. 
Lapostolle, P. and Septier, A., eds (1970). Linear Accelerators (North-Holland, Amster- 
dam). 
Lebedev, A.A., ed. (1954). Elektronnaya Mikroskopiya (Gostekhizdat, Moscow). 
Lefranc, G., Knapek, E. and Dietrich, I. (1982). Ultramicroscopy 10, 111-124. 
Leisegang, S. (1956). Elektronenmikroskope. In Handbuch der Physik (Fliigge, S., ed.) 
vol. 33, pp. 396-545. 
Lenz, F. (1956). Stockholm, pp. 48-51. 
Lenz, F. (1957). Optik 14, 74-82. 
Lenz, F. (1973). In Image Processing and Computer-aided Design in Electron Optics 
(Hawkes, P.W., ed.) pp. 274-282 (Academic Press, London and New York). 
Livingood, J.J. (1969). The Optics of Dipole Magnets (Academic Press, New York and 
London). 
Lukoshkov, V.S., Zamorozkov, B.M. and Shubin, L.V. (1968). Elek~ronnye Puchki i 
Elektronno-opticheskie Sistemy (Institut 'Elektronika', Moscow). 
Magnan, C., ed. (1961). Traitd de Microscopie Electronique, 2 vols (Hermann, Paris). 
Marchuk, G.I., ed. (1967). Chislennye Metody Raschela Elektronno-opticheskikh Sistem 
(Nauka, Novosibirsk). 
Marchuk, G.I., ed. (1970). Metody Rascheta Elektronno-Oplicheskikh Sistem (Computer 
Centre, Novosibirsk). 

PREFACE AND CHAPTER 1 
583 
Marchuk, G.I., ed. (1973). Metody Rascheta Elektronno-Opticheskikh Sistem, 2 vols 
(Computer Centre, Novosibirsk). 
Marton, C., Sass, S., Swerdlow, M., Bronkhorst, A. van and Meryman, H. (1950). Bibli- 
ography of Electron Microscopy, NBS Circular No. 502. 
Marton, L. (1934). Nature 133,911; Phys. Rev. 46,527-528. 
Marton, L. (1934-1937). Bull. C1. Sci. Acad. R. Belg. 20,439-446 (1934); 21,553-564 
and 606-617 (1935); 22, 1336-1344 (1936); 23, 672-675 (1937). 
Marton, L. (1935). Rev. Opt. 14, 129-145. 
Marton, L. (1968). Early History of the Electron Microscope (San Francisco Press, San 
Francisco). 
McMullan, D. (1953). Proc. Inst. Elec. Eng. 100,245-259. 
Molokovskii, S.I. and Sushkov, A.D. (1965). Elektronnoop~icheskie Systemy Priborov 
Sverkhvysokikh Chastot (Moscow and Leningrad). 
Mulvey, T. (1962). Brit. J. Appl. Phys. 13, 197-207. 
Mulvey, T. (1967). Proc. R. Microsc. Soc. 2,201-227. 
Mulvey, T. (1973). Phys. Bull. 24, 147-154. 
Mulvey, T. (1982). In Magnetic Electron Lenses (Hawkes, P.W., ed.) pp. 359-412 
(Springer, Berlin and New York). 
Mulvey, T. (1984). In Electron Optical Systems for Microscopy, Microanalysis and Mi- 
crolithography (Hren, J.J., Lenz, F.A., Munro, E. and Sewell, P.B., eds) pp. 15-27 
(Scanning Electron Microscopy, AMF O'Hare). 
Mulvey, T. (1985). In The Beginnings of Electron Microscopy (Hawkes, P.W., ed.) pp. 
417-442 (Academic Press, Orlando and London); Adv. Electron. Electron Phys. 
Suppl. 16. 
Myers, L.M. (1939). Electron Optics, Theoretical and Practical (Chapman and Hall, 
London). 
Newman, S.B., Borysko, E. and Swerdlow, M. (1949). J. Res. Natl. Bur. Stand. A43, 
183-199. 
Oatley, C.W. (1972). The Scanning Electron Microscope. Part I. The Instrument (Uni- 
versity Press, Cambridge). 
Oatley, C.W. (1982). J. Appl. Phys. 53, R1-R13. 
Oatley, C.W., Nixon, W.C. and Pease, R.F.W. (1965). Adv. Electron. Electron Phys. 
21, 181-247. 
Oatley, C.W., McMullan, D. and Smith, K.C.A. (1985). In The Beginnings of Electron 
Microscopy (Hawkes, P.W., ed.) pp. 443-482 (Academic Press, Orlando and 
London); Adv. Electron. Electron Phys. Suppl. 16. 
Ollendorff, F. (1955). Technische Elektrodynamik, vol. II, Innere Elektronik, Pt I, Elek- 
tronik des Einzelelektrons (Springer, Vienna). 

584 
NOTES AND REFERENCES 
Ozasa, S., Katagiri, S., Kimura, H. and Tadano, B. (1966). Kyoto, vol. 1, pp. 149-150. 
Paszkowski, B. (1960). Optyka Elektronowa (Wydawnictwa Naukowo-Techniczne, War- 
saw); 2nd ed., 1965. Translated into English as Electron Optics (Iliffe, London 
and American Elsevier, New York, 1968). 
Pease, D.C. and Baker, R.F. (1948). Proc. Soc. Exp. Biol. Med. 67, 470-474. 
Picht, J. (1939). Einf~hrung in die Theorie der Elektronenoptik (Barth, Leipzig); 2nd 
ed., 1957; 3rd ed. 1963. 
Picht, J. (1945). Was Wit abet Elektronen Wissen (Carl Winter, Heidelberg). 
Picht, J. and Gain, It. (1955). Das Elektronenmikroskop (Fachbuch, Leipzig). 
Picht, J. and Heydenreich, J. (1966). Einf~hrung in die Elektronenmikroskopie (Verlag 
Technik, Berlin). 
Pierce, J.R. (1949). Theory and Design of Electron Beams (Van Nostrand, Princeton and 
London); 2nd ed., 1954. 
Prismennye Beta-Spektrometry i ikh Primenenie (Vilnius, 1971). 
Ramsauer, C., ed. (1941). Zehn Jahre Elektronenmikroskopie; ein Selbstbericht des AEG 
Forschungs-Instituts (Springer, Berlin); 2nd ed., 1942; 3rd ed., entitled Elektro- 
nenmikroskopie; Bericht ~iber Arbeiten des AEG Forschungs-Instituts, 1930 bis 
1942 (1943). 
rtiecke, W.D. (1982). In Magnetic Electron Lenses (Hawkes, P.W., ed.) pp. 163-357 
(Springer, Berlin and New York). 
Rose, H. (1968). Optik 27, 466-474 and 497-514. 
Ruska, E. (1957). Elektrotech. Z. A78,531-543. 
Ruska, E. (1979). Die Fr~he Entwicklung der Elektronenlinsen und der Elektronen- 
mikroskopie. Acta Hist. Leopold. No. 12, 136 pp. 
Ruska, E. (1980). The Early Development of Electron Lenses and Electron Microscopy 
(Hirzel, Stuttgart). 
Ruska, E. and Knoll, M. (1931). Z. Tech. Phys. 12, 389-400 and 448. 
Rusterholz, A.A. (1950). Elektronenoptik, vol. 1, Grundzage der theoretischen Elektro- 
nenoptik (BirkhKuser, Basle). 
Scherzer, O. (1936). Z. Physik 101,593-603. 
Scherzer, O. (1947). Optik 2, 114-132. 
Seman, O.I. (1951). Dokl. Akad. Nauk SSSR 81,775-778. 
Seman, O.I. (1954). Dokl. Akad. Nauk SSSR 96, 1151-1154. 
Seman, O.I. (1955). Trudy Inst. Fiz. Astron. Akad. Nauk Eston. SSSR, No. 2, 3-49. 
Seman, O.I. (1958a). Uch. Zap. Rostov. Gos. Univ. (Ser. Fiz.) 68, No. 8, 63-75 and 
77-90. 
Seman, O.I. (1958b). Radiotekh. Elektron 3,283-287; Radio Eng. Electron. 3,402-409. 

PREFACE AND CHAPTER 1 
585 
Seman, O.I. (1959). Theoretical Foundations of Electron Optics [in Chinese] (Higher 
Education Press, Peking). 
Septier, A., ed. (1967). Focusing of Charged Particles, 2 vols (Academic Press, New York 
and London). 
Septier, A., ed. (1980). Applied Charged Particle Optics. Parts A and B; Part C, 1983 
(Academic Press, New York and London); Supplements 13A, 13B and 13C to Adv. 
Electron Electron. Phys. 
Siegel, B.M., Kitamura, N., Kropfli, R.A. and Schulhof, M.P. (1966). Kyoto, vol. 1, pp. 
151-152. 
SjSstrand, F.S. (1953). Experientia 9, 114-115. 
SjSstrand, F.S. (1967). Electron Microscopy of Cells and Tissues, vol. 1, Instrumentation 
and Techniques (Academic Press, New York and London). 
Smith, K.C.A., Considine, K. and Cosslett, V.E. (1966). Kyoto, vol. 1, pp. 99-100. 
Steffen, K.G. (1965). High Energy Beam Optics (Wiley-Interscience, New York and 
London). 
Strashkevich, A.M. (1959). Elektronnaya Optika Elektrostalicheskikh Polei ne Obla- 
dayushchikh Osevoi Simmetriei (Gos. Izd. Fiz.-Mat. Lit., Moscow). 
Strashkevich, A.M. (1966). Elektronnaya Optika Elektrostaticheskykh Sistem (Energiya, 
Moscow and Leningrad). 
Sturrock, P.A. (1952). Phil. Trans. Roy. Soc. London A245, 155-187. 
Sturrock, P.A. (1955). Static and Dynamic Electron Optics (University Press, Cam- 
bridge). 
Sugata, E. (1968). 
Electron Microscopes of Japan 1936-1965. 
A Historical Survey 
(Maruzen, Tokyo). 
Sushkin, N.G. (1949). Elektronnyi Mikroskop (Gos. Izd. Tekh.-Teor. Lit., Moscow). 
Szilagyi, M. (1988). Electron and Ion Optics (Plenum, New York and London). 
Szymafiski, H., Mulak, A., Duda, A. and Romanowski, A. (1977). Optyka Elektronowa; 
2nd ed., 1984 (Wydawnictwa Naukowo-Techniczne, Warsaw). 
Tang, T.-T. (1987). Introduction to Charged Particle Optics with Applications [in Chinese] 
(Xi'an Jiantong University Press, Xi'an). 
Taranenko, V.P. (1964). Elektronnye Pushki (Tekhnika, Uiev). 
Thomson, G.P. and Reid, A. (1927). Nature 119, 890. 
Tsukkerman, I.I. (1958). Elektronnaya Optika v Televidenii (Gosenergoizdat, Moscow and 
Leningrad); English translation Electron Optics in Television (Pergamon, Oxford 
and New York, 1961). 
Vainryb, E.A. and Milyutin, V.I. (1951). Elektronnaya Optika (Gos. Energ. Izd., Moscow 
and Leningrad); German translation by K. Keller as Wainrib, E.A. and Miljutin, 
W.I., Elektronenoptik (Verlag Technik, Berlin, 1954). 

586 
NOTES AND REFERENCES 
Vandakurov, Yu. V. (1955). Zh. Tekh. Fiz. 25, 2545-2555. 
Vandakurov, Yu. V. (1956). Zh. Tekh. Fiz. 26, 1555-1610 and 2578-2594; Soy. Phys. 
Tech. Phys. 1, 1558-1569 and 2491-2507. 
Vandakurov, Yu. V. (1957). Zh. Tekh. Fiz. 27, 1850-1862; Sov. Phys. Tech. Phys. 2, 
1719-1733. 
Watt, F. and Grime, G.W., eds (1987). Principles and Applications of High-energy Ion 
Microbeams (Adam Hilger, Bristol). 
Weyl, R., Dietrich, I. and Zerbst, H. (1972). Optik 35, 280-286. 
Wollnik, H. (1987). Optics of Charged Particles (Academic Press, Orlando and London). 
Ximen, J.-y. (1986). Aberration Theory in Electron and Ion Optics (Academic Press, 
Orlando and London); Supplement 17 to Adv. Electron. Electron Phys. 
Ximen, J.-y. and Ge, Z.-s. (1979). Principles of the Electron Microscope and its Design 
[in Chinese] (Science Press, Peking). 
Yavor, S. Ya. (1968). Fokusirovka Zaryazhennykh Chastits Kvadrupol'nymi Linzami 
(Atomizdat, Moscow). 
Zinchenko, N.S. (1961). Kurs Lektsii po Elektronnoi Optike, 2nd ed. (Izd. Khar'kovsk. 
Ordena Trudovogo Krasnogo Znameni Gos. Univ. im A.M. Gor'kogo, Khar'kov). 
Zworykin, V.K., Hillier, J. and Snyder, R.L. (1942). ASTM. Bull. No. 117, 15-23. 
Zworykin, V.K., Morton, G.A., Ramberg, E.G., Hillier, J. and Vance, A.W. (1945). 
Electron Optics and the Electron Microscope (Wiley, New York and Chapman and 
Hall, London). 

Part I, Chapters 
2-5 
PART I, CHAPTERS 2-5 
587 
The examination by Ehrenberg and Siday (1949) of the notion of refractive 
index provoked a comment by Glaser (1951) and a reply by the original 
authors (Ehrenberg and Siday, 1951). 
Aharonov, Y. and Bohm, D. (1959). Phys. Rev. 115, 485-491. 
Born, M. and Wolf, E. (1959). Principles of Optics (Pergamon, London and New York); 
6th ed., 1980. 
Bruns, H. (1895). Abh. K. Siichs. Ges. Wiss., Math-Phys. K1. 21,321-436. 
Ehrenberg, W. and Siday, R.E. (1949). Proc. Phys. Soc. (London) B62, 8-21. 
Ehrenberg, W. and Siday, R.E. (1951). Proc. Phys. Soc. (London) B64, 1088-1089. 
alaser, W. (1951). Proc. Phys. Soc. (London) B64, 114-118 and 1089. 
Glaser, W. (1952). Grundlagen der Elektronenoptik (Springer, Vienna). 
Goldstein, H. (1959). Classical Mechanics (Addison-Wesley, Reading and London). 
Grivet, P. (1965). Electron Optics (Pergamon, London and New York). 
Kasper, E. (1972). Optik 35, 83-89. 
Kasper, E. (1985). Optik 69, 117-125. 
Kel'man, V.M. and Yavor, S.Ya. (1959). Elektronnaya Oplika (Izd. Akad. Nauk, Moscow 
and Leningrad); 2nd ed., 1963; 3rd ed., 1968 (Izd. Nauka, Leningrad). 
Kel'man, V.M., Sekunova, L.M. and Yakushev, E.M. (1972). Zh. Tekh. Fiz. 42, 2279- 
2287; Sov. Phys. Tech. Phys. 17, 1786-1791. 
Kel'man, V.M., Sekunova, L.M. and Yakushev, E.M. (1973). Zh. Tekh. Fiz. 43, 1799- 
1806 and 1807-1817; Sov. Phys. Tech. Phys. 18, 1142-1146 and 1147-1152. 
Picht, J. (1939). Einfiihrung in die Theorie der Elektronenoptik (Barth, Leipzig); 2nd 
ed., 1957; 3rd ed., 1963. 
StSrmer, C. (1904). Vidensk. Selsk. Skr. Math. Nat. K1. No. 3, 32 pp. 
StSrmer, C. (1906). C.R. Acad. Sci. Paris 142, 1580-1583 and 143, 140-142, 408-411 
and 460-464. 
StSrmer, C. (1933). Ann. Physik (Leipzig) 16, 685-696. 
Sturrock, P.A. (1955). Static and Dynamic Electron Optics (University Press, Cam- 
bridge). 

588 
NOTES AND REFERENCES 
Part II, Chapters 6-13 
For further details of the work of the Imperial College school, see Munro 
(1980, 1987a,b) and for accounts of later developments in the Tfibingen 
group, see Kasper (1987a,b,c). The BEM is applied to electrostatic systems 
of arbitrary shape by Desbruslais and Munro (1987). The BEM is surveyed 
by Costabel (1987) and the FEM by Morton (1987) and Reid (1987). 
Abramowitz, M. and Stegun, I.A. (1964). Handbook of Mathematical Functions (NBS, 
Washington; Dover, New York, 1965). 
Adams, A. and Read, F.H. (1972). J. Phys. E: Sci. Instrum. 5, 150-155 and 156-160. 
Ames, W.F. (1969). Numerical Methods for Partial Differential Equations (Nelson, Lon- 
don). 
Balladore, J.L., Murillo, R., Hawkes, P.W., Trinquier, J. and Jouffrey, B. (1981). Nucl. 
Instrum. Meth. 187, 209-215. 
Balladore, J.L., Murillo, R. and Trinquier, J. (1984). In Electron Optical Systems for 
Microscopy, Microanalysis and Microlithography (Hren, J.J., Lenz, F.A., Munro, 
E. and Sewell, P.B., eds) pp. 29-35 (Scanning Electron Microscopy, AMF O'Hare). 
Bettess, P. (1977). Int. J. Numer. Meth. Eng. 11, 53-64. 
Boerboom, A.J.H. and Chen, H.-N. (1984). Int. J. Mass Spectrom. Ion Proc. 61, 1-13. 
Bonjour, P. (1980). In Applied Charged Particle Optics (Septier, A., ed.) vol. A, pp. 
1-44 (Academic Press, New York and London); Adv. Electron. Electron Phys., 
Suppl. 13A. 
Buneman, O. (1971). J. Comput. Phys. 8, 500-505. 
Buneman, O. (1973). J. Comput. Phys. 11,307-314 and 447-448. 
CarrY, B.A. (1961). Comput. J. 4, 73-78. 
Chari, M.V.K. and Silvester, P.P. (1980). Finite Elements in Electrical and Magnetic 
Field Problems (Wiley, Chichester and New York). 
Chu, H.C. and Munro, E. (1982). Optik 61, 121-145 and 213-236. 
Colonias, J.S. (1974). Particle Accelerator Design: Computer Programs (Academic Press, 
New York and London). 
Costabel, M. (1987). Principles of boundary element methods. Comput. Phys. Repts 6, 
243-274. 
Courant, R. (1943). Bull. Am. Math. Soc. 49, 1-23. 
Cruise, D.R. (1963). J. Appl. Phys. 34, 3477-3479. 
Cuthill, E. and McKee, J. (1969). In Proc. 2~th Natl. Conf. ACM pp. 157-172 (Brandon 
Systems Press, N.J.). 

PART II, CHAPTERS 6-13 
589 
Desbruslais, S.R. and Munro, E. (1987). In Proc. lnt. Symp. Electron Optics Beijing 
(Ximen, J.-y., ed.) pp. 45-48 (Institute of Electronics, Academia Sinica, Beijing). 
Dommaschk, W. (1965). Optik 23,472-477. 
Duff, I.S. (1977). Proc. IEEE 65,500-535. 
Durand, E. (1966). Electrostatique (Masson, Paris). 
Eupper, M. (1982). Optik 62, 299-307. 
Eupper, M. (1985). Eine verbesserte Integralgleichungsmethode zur numerischen Lb'sung 
dreidimensionaler Dirichletprobleme und ihre Anwendung in der Elektronenoptik. 
Dissertation, Tiibingen. 
Forsythe, G.E. and Wasow, W.R. (1960). Finite Difference Methods for Partial Differ- 
ential Equations (Wiley, New York). 
Franzen, N. (1984). In Electron Optical Systems for Microscopy, Microanalysis and 
Microlithography (Hren, J.J., Lenz, F.A., Munro, E. and Sewell, P.B., eds) pp. 
115-126 (Scanning Electron Microscopy, AMF O'Hare). 
Gibbs, N.E., Poole, W.G. and Stockmeyer, P.K. (1976). SIAM J. Numer. Anal. 13, 
236-250. 
Glaser, W. (1952). Grundlagen der Elektronenoptik (Springer, Vienna). 
Harrington, R.F. (1967). Proc. Inst. Electr. Electron. Eng. 55, 136-149. 
Harrington, R.F. (1968). Field Computation by Moment Methods (Macmillan, New York 
and Collier-Macmillan, London). 
Harrington, R.F., Pontoppidan, K., Abrahamsen P. and Albertsen, N.C. (1969). Proc. 
Inst. Electr. Eng. 116, 1715-1720. 
Harting, E. and Read, F.H. (1976). Electrostatic Lenses (Elsevier, Amsterdam, Oxford 
and New York). 
Hermeline, F. (1982). RAIRO 16,211-242. 
Hoch, H., Kasper, E. and Kern, D. (1978). Optik 50, 413-425. 
Iselin, C.F. (1981). IEEE Trans. MAG-17, 2168-2177. 
Jacobs, D.H., ed. (1977). The State of the Art in Numerical Analysis (Academic Press, 
London and New York). 
Janse, J. (1971). Optik 33,270-281. 
Kang, N.K., Orloff, J., Swanson, L.W. and Tuggle, D. (1981). J. Vac. Sci. Technol. 19, 
1077-1081. 
Kang, N.K., Tuggle, D. and Swanson, L.W. (1983). Optik 63,313-331. 
Kasper, E. (1976). Optik 46,271-286. 
Kasper, E. (1982). Magnetic field calculation and the determination of electron trajec- 
tories. In Magnetic Electron Lenses (Hawkes, P.W., ed.) pp. 57-118 (Springer, 
Berlin and New York). 

590 
NOTES AND REFERENCES 
Kasper, E. (1983). Optik 64, 157-169. 
Kasper, E. (1984a). Optik 68, 341-362. 
Kasper, E. (1984b). In Electron Optical Systems for Microscopy, Microanalysis and 
Microlithography (Hren, J.J., Lenz, F.A., Munro, E. and Sewell, P.B. eds) pp. 
63-73 (Scanning Electron Microscopy, AMF O'Hare). 
Kasper, E. (1987a). Nucl. Instrum. Meth. Phys. Res. A258, 466-479. 
Kasper, E. (1987b). Optik 77, 3-12. 
Kasper, E. (1987c). In Proc. Int. Symp. Electron Optics Beijing (Ximen J.-y., ed.) pp. 
115-118 (Institute of Electronics, Academia Sinica, Beijing). 
Kasper, E. and Lenz, F. (1980). The Hague, vol. 1, pp. 10-15. 
Kasper, E. and Scherle, W. (1982). Optik 60, 339-352. 
Kern, D. (1978). Theoretische Untersuchungen an rotationssymmetrischen Strahlerzeu- 
gungssystemen mit Feldemissionsquelle. Dissertation, Tiibingen. 
Killes, P. (1985). Optik 70, 64-71. 
Konrad, A. and Silvester, P. (1973). Comput. Phys. Commun. 5,437-455. 
Kuroda, K. (1983). Optik 64, 125-131. 
Kuroda, K. and Suzuki, T. (1972). Jpn. J. Appl. Phys. 11, 1382. 
Lencov~, B. and Lenc, M. (1982). Hamburg, vol. 1, pp. 317-318. 
Lencov~, B. and Lent, M. (1984). Optik 68, 37-60. 
Lencova, B. and Lent, M. (1986). Scanning Electron Microsc. 897-915. 
Lenz, F. (1956). Ann. Physik (Leipzig) 19, 82-88. 
Lenz, F. (1973). In Image Processing and Computer-aided Design in Electron Optics 
(Hawkes, P.W., ed.) pp. 274-282 (Academic Press, London and New York). 
Lewis, H.R. (1966). J. Appl. Phys. 37, 2541-2550. 
Lucas, I. (1976). J. Appl. Phys. 47, 1645-1652. 
Mautz, J.R. and Harrington, R.F. (1970). Proc. Inst. Electr. Eng. 117, 850-852. 
McDonald, B.H. and Wexler, A. (1972). IEEE Trans. MTT-20, 841-847. 
McDonald, B.H., Friedman, M., Decreton, M. and Wexler, A. (1973). Electron. Lett. 9, 
242. 
Merwe, J.P. van der (1978). Univ. Zululand Publ., Ser. 3, No. 23, No. 24 and No. 25. 
Merwe, J.P. van der (1979). S. Afr. J. Phys. 2, No. 4, 117-124. 
Morton, K.W. (1987). Basic course in finite element methods. Comput. Phys. Repts 6, 
1-72. 
Mulvey, T. (1982). Unconventional lens design. In Magnetic Electron Lenses (Hawkes, 
P.W., ed.) pp. 359-412 (Springer, Berlin and New York). 

PART II, CHAPTERS 6-13 
591 
Munro, E. (1971). Computer-aided Design Methods in Electron Optics. Dissertation, 
Cambridge. 
Munro, E. (1973). In Image Processing and Computer-aided Design in Electron Optics 
(Itawkes, P.W., ed.) pp. 284-323 (Academic Press, London and New York). 
Munro, E. (1980). Electron beam lithography. In Applied Charged Particle Optics (Sep- 
tier, A., ed.) vol. B, pp. 73-131 (Academic Press, New York and London); 
Supplement 13B to Adv. Electron. Electron Phys. 
Munro, E. (1987a). Nucl. Instrum. Meth. Phys. Res. A258, 443-461. 
Munro, E. (1987b). In Proc. Int. Symp. Electron Optics Beijing (Ximen, J.-y., ed.) pp. 
177-180 (Institute of Electronics, Academia Sinica, Beijing). 
Munro, E. and Chu, H.C. (1982). Optik 60,371-390 and 61, 1-16. 
Norrie, D.H. and Vries, G. de (1973). The Finite Element Method (Academic Press, New 
York and London). 
Peaceman, D.W. and Rachford, H.H. (1955). J. SIAM 3, 28-41. 
Rauh, H. (1971). Z. Naturforsch. 26a, 1667-1675. 
Read, F.H., Adams, A. and Soto-Montiel, J.R. (1971). J. Phys. E: Sci. Instrum. 4, 
625-632. 
Regenstreif, E. (1951). Ann. Radiodl. 6, 51-83 and 114-155. 
Reid, J.K. (1987). Algebraic aspects of finite element solutions. Comput. Phys. Repts 
6, 385-414. 
Rose, H. (1971). Optik 34, 285-311. 
Rose, H. and Plies, E. (1973). In Image Processing and Computer-aided Design in Electron 
Optics (Hawkes, P.W., ed.) pp. 344-369 (Academic Press, London and New York). 
Schaefer, C.H. (1982). Methoden zur numerischen Lb'sung der Laplacegleichung bei kom- 
plizierten Randwertaufgaben in drei Dimensionen und ihre Anwendung auf Prob- 
leme der Elektronenoptik. Dissertation, Tiibingen. 
Schaefer, C.H. (1983). Optik 65,347-359. 
Scherle, W. (1983). Optik 63,217-226. 
Schwertfeger, W. and Kasper, E. (1974). Optik 41, 160-173. 
Silvester, P. and Konrad, A. (1973). Int. J. Num. Meth. Eng. 5, 481-497. 
Singer, B. and Braun, M. (1970). IEEE Trans. ED-17, 926-934. 
Stone, H.L. (1968). SIAM J. Numer. Anal. 5, 530-558. 
StrSer, M. (1987). Optik 77, 15-25. 
Sturrock, P.A. (1951). Phil. Trans. Roy. Soc. (London) A243, 387-429. 
Uchikawa, Y., Ohye, T. and Gotoh, K. (1981). Trans. IEE Japan 101-A, 263-270; Elec. 
Eng. Japan 101, No. 3, 8-13. 
Varga, R.S. (1962). Matriz lterative Analysis (Prentice-Hall, Englewood Cliffs). 

592 
NOTES AND REFERENCES 
Wallington, M.J. (1970). J. Phys. E: Sci. Instrum. 3, 599-604. 
Wallington, M.J. (1971). J. Phys. E: Sci. Instrum. 4, 1-8. 
Weber, C. (1967). Philips Res. Repts Suppl. No. 6. 
Weysser, R. (1983). Feldberechnung in rotationssymmetrischen Elektronenstrahlerzeugern 
mit Spitzkathode nnter Ber~cksichtignng yon Raumladungen. 
Dissertation, 
Tiibingen. 
Whittaker, E.T. and Watson, G.N. (1927). A Course of Modern Analysis (University 
Press, Cambridge). 
Winslow, A.M. (1967). J. Comput. Phys. 2, 149-172. 
Zienkiewicz, O.C. (1967). The Finite Element Method in Structural and Continuum 
Mechanics (McGraw-Hill, London and New York). 
Zienkiewicz, O.C. (1971). The Finite Element Method in Engineering Science (McGraw- 
Hill, London and New York). 
Part III, Chapters 14-20 
All books on electron optics devote considerable space to the paraxial prop- 
erties of round lenses though the distinction between the real and asymp- 
totic cardinal elements is not always emphasized as strongly as it is here. 
Information about electrostatic and magnetic lenses is to be found in the 
surveys of de Broglie (1946, 1950), Marton (1946), Bruck and Grivet (1950), 
Mulvey and Wallington (1973), Hawkes (1982), Riecke (1982, 1984) and 
Baranova and Yavor (1984, 1986). For some early work not cited in the 
main text, see Picht (1933a,b, 1939b), Dyachenko (1935), Dyachenko and 
Sakharov (1935, 1937, 1938), Glaser (1936) and on Newtonian fields, Glaser 
( 950). 
Additional information about electron mirrors (Chapter 18) is to be 
found in Henneberg and Recknagel (1935), Hottenroth (1936, 1937), Picht 
(1939a), Regenstreif (1947), Kot (1952), Ivanov and Abalmazova (1966), 
Kel'man et al. (1982) and Yakushev and Sekunova (1986). For further 
details of the mirror in the Castaing-Henry device, see Castaing and Henry 
(1964) and Metherell (1971). 
Only a small section of the literature on quadrupoles (Chapter 19) is 
presented here. Several books deal extensively with them (Strashkevich, 
1959, 1966; Hawkes, 1966, 1970; and Yavor, 1968) and more are listed in 
Chapter 39. Many monographs and review articles aimed at higher energies 
likewise deal with them at length, though here a particular model (see 
Chapter 39) is usually adopted; see in particular Bernard (1953, 1954), 
Grivet and Septier (1960), Chamberlain (1960), Septier (1961), Luckey 

PART III, CHAPTERS 14-20 
593 
(1961), King (1964), Steffen (1965, 1985), Banford (1966), Bruck (1966a,b), 
Brown (1967), Busse and Zelazny (1984), Wollnik (1987), Carey (1987) 
and Schriber and Taylor (1987). On the origins of the strong-focusing idea, 
see Thomas (1938), Christofilos (1950), Courant et al. 
(1952) and (for 
electrostatic strong focusing) Blewett (1952). We also list an interesting 
early paper of Strashkevich (1954) and a discussion of various quadruplets 
by Dymnikov et al. (1963b). 
The optics of cylindrical lenses (Chapter 20) or their potential dis- 
tributions are further examined by Fry (1932), Henneberg (1935), Glaser 
and Henneberg (1935), Strashkevich and Glushko (1940, 1941), Glushko 
and Strashkevich (1940), Strashkevich (1940c, 1952a,b, 1955), Rabin and 
Strashkevich (1950), aabin et al. 
(1951), Strashkevich and Yurchenko 
(1952), Bdlta EHas and GSmez Garcia (1950), Archard (1954), Laudet 
(1953, 1955, 1956), Septier (1954), Baranovskii et al. (1955), Gautier and 
Latour (1959), Yavor and Szil£gyi (1960), Yavor et al. (1960), Bacquet et 
al. (1961, 1963), Kochanov (1962, 1963), Glikman and Yakushev (1967), 
Glikman et al. (1967a,b), Hibi et al. (1967), (~iri6 et al. (1976) and Vukani6 
et al. (1976). 
Archard, G.D. (1954). Brit. J. Appl. Phys. 5, 179-181 and 395-399. 
Bacquet, G., Gautier, P. and Santouil, A. (1961). C.R. Acad. Sci. Paris 252, 522-524. 
Bacquet, G., Gautier, P. and Santouil, A. (1963). J. Microscopie 2, 393-406. 
Balt£ Elias, J. and GSmez Garcia, J.A. (1950). An. R. Soc. Esp. Fis. Quim. A46, 
83-92. 
nanford, A.P. (1966). The Transport of Charged Particle Beams (Spon, London). 
Baranova, L.A. and Yavor, S.Ya. (1984). Zh. Tekh. Fiz. 54, 1417-1453; Soy. Phys. 
Tech. Phys. 29, 827-848. 
Baranova, L.A. and Yavor, S.Ya. (1986). Elektrostaticheskie Elektronnye Linzy (Nauka, 
Moscow); English translation to appear in Adv. Electron. Electron Phys. 
Baranovskii, S.N. Kaminskii, D.L. and Kel'man, V.M. (1955). Zh. Tekh. Fiz. 25, 
610-624 and 1954-1956. 
Bernard, M. (1952). C.R. Acad. Sci. Paris 234, 606-608. 
Bernard, M.-Y. (1953). C.R. Acad. Sci. Paris 236, 185-187 and 902-904. 
Bernard, M.-Y. (1954). Ann. Physique (Paris) 9, 633-682. 
Blewett, J.P. (1952). Phys. Rev. 88, 1197-1199. 
Boerboom, A.J.H. (1959). Z. Naturforsch. 14a, 809-816. 
Boerboom, A.J.H. (1960). Z. Naturforsch. 15a, 244-252 and 253-259. 
Bok, A.B., Le Poole, J.B., Roos, J., Lang, H. de, Bethge, H., Heydenreich, J. and Barnett, 
M.E. (1971). Mirror electron microscopy. Adv. Opt. Electron Microsc. 4, 161- 
261. 

594 
NOTES AND REFERENCES 
Bonjour, P. (1974). J. Microscopie 20, 219-239. 
Bonjour, P. (1975). J. Phys. E: Sci. Instrum. 8, 764-768. 
Born, M. and Wolf, E. (1959). Principles of Optics (Pergamon, Oxford). 
Brodskii, G.N. and Yavor, S.Ya. (1970). Zh. Tekh. Fiz. 40, 1310-1313; Sov. Phys. 
Tech. Phys. 15, 1011-1012. 
Brodskii, G.N. and Yavor, S.Ya. (1971). Zh. Tekh. Fiz. 41, 1550-1552; Sov. Phys. 
Tech. Phys. 16, 1218-1219. 
Broglie, L. de, ed. (1946). L'Optique Electronique (Editions Revue d'Optique, Paris). 
Sroglie, L. de (1950). Optique Eiectronique et Corpusculaire (Hermann, Paris). 
Brown, K.L. (1967). A first and second-order matrix theory for the design of beam 
transport systems and charged particle spectrometers, SLAC-75; published in Ad- 
vances in Particle Physics (Cool, R.L. and Marshak, R.E., eds) vol. 1, pp. 71-134 
(Wiley-Interscience, New York and London, 1968). 
Brown, K.L. and Servranckx, R.V. (1985). First- and second-order charged particle 
optics. In Physics of High Energy Particle Accelerators (Month, M., Dahl, P.F. 
and Dienes, M., eds) pp. 62-138 (American Institute of Physics, New York). 
Bruck, H. (1966a). Accglgrateurs Circulaires de Particules (Presses Universitaires de 
France, Paris). 
Bruck, H. (1966b). Thdorie et Technique des Accgldrateurs de Particules (Centre d'Etudes 
Nucldaires de Saclay, Gif-sur-Yvette). 
Bruck, H. and Grivet, P. (1950). Rev. Opt. 29, 164-170. 
Busch, H. (1927). Arch. Elektrotech. 18, 583-594. 
Busse, W. and Zelazny, R. (1984). Computing in Accelerator Design and Operation, 
Lecture Notes in Physics, vol. 215 (Springer, Berlin and New York). 
Carathdodory, C. (1937). Geometrische Optik. Ergeb. Math. Grenzgeb., vol. 5 (Springer, 
Berlin). 
Carey, D.C. (1987). The Optics of Charged Particle Beams (Harwood, Chur, London and 
New York). 
Castaing, R. and Henry, L. (1962). C.R. Acad. Paris 255, 76-78. 
Castaing, R. and Henry, L. (1964). J. Microscopic 3, 133-152. 
Chamberlain, O. (1960). Ann. Rev. Nucl. Sci. 10, 161-192. 
Chechulin, V.N. and Yavor, S.Ya. (1969). Zh. Tekh. Fiz. 39, 1457-1462; Sov. Phys. 
Tech. Phys. 14, 1093-1096. 
Christofilos, N. (1950). Focusing system for ions and electrons, US Patent 2736799, 
reprinted in The Development of High-Energy Accelerators (Livingston, M.S., ed) 
pp. 270-280 (Dover, New York, 1966); re unpublished paper of 1950, see Courant 
et al. (1953). 
(~iri6, D., Terzid, I. and Vukani~, J. (1976). J. Phys. E: Sci. Instrum. 9,844-846. 

PART III, CHAPTERS 14-20 
595 
Cotte, M. (1938). Ann. Physique (Paris) 10, 333-405. 
Courant, E.D., Livingston, M.S. and Snyder, H.S. (1952). Phys. Rev. 88, 1190-1196. 
Courant, E.D., Livingston, M.S., Snyder, H.S. and Blewett, J.P. (1953). Phys. Rev. 91, 
202-203. 
Czapski, S. and Eppenstein, O. (1924). Grundz~ge der Theorie der Optischen Instrumente 
nach A bbe, 3rd ed. (Barth, Leipzig). 
Daumenov, T.D., Sapargaliev, A.A. and Yakushev, E.M. (1978). Zh. Tekh. Fiz. 48, 
2447-2454; Sov. Phys. Tech. Phys. 23, 1400-1404. 
Davisson, C.J. and Calbick, C.J. (1931). Phys. Rev. 38,585; errata ibid. 42,580 (1932). 
Dugek, H. (1959). Optik 16, 419-445. 
Dyachenko, V. (1935). Ukr. Fiz. Zap. 3, 53-65. 
Dyachenko, V. and Sakharov, I.I. (1935). Ukr. Fiz. Zap. 4, 23-32. 
Dyachenko, V. and Sakharov, I.I. (1937). Ukr. Fiz. Zap. 6, 37-48 and 49-52. 
Dyachenko, V.E. and Sakharov, I.I. (1938). Ukr. Fiz. Zap. 7, 3-21 and 175-191. 
Dymnikov, A.D. (1968). Zh. Tekh. Fiz. 38, 1120-1125; Sov. Phys. Tech. Phys. 13, 
929-933. 
Dymnikov, A.D. and Yavor, S.Ya. (1963). Zh. Tekh. Fiz. 33, 851-858; Sov. Phys. Tech. 
Phys. 8,639-643. 
Dymnikov, A.D., Fishkova, T.Ya. and Yavor, S.Ya. (1963a). Izv. Akad. Nauk SSSR 
(Set. Fiz.) 27, 1131-1134; Bull. Acad. Sci. USSR (Phys. Ser.) 27, 1112-1115. 
Dymnikov, A.D., Ovsyannikova, L.P. and Yavor, S.Ya. (1963b). Zh. Tekh. Fiz. 33, 
393-397; Sov. Phys. Tech. Phys. 8,293-296. 
Fry, T.C. (1932). Am. Math. Monthly 39, 199-209. 
Funk, P. (1950). Acta Phys. Austriaca 4, 304-308. 
Gautier, P. and Latour, C. (1959). C.R. Acad. Sci. Paris 248, 1637-1640. 
Glaser, W. (1933a). Z. Physik 80, 451-464. 
Glaser, W. (1933b). Z. Physik 81,647-686. 
Glaser, W. (1933c). Z. Physik 83, 104-122. 
Glazer, W. (1933d). Ann. Physik (Leipzig) 18,557-585. 
Glaser, W. (1936). Z. Tech. Phys. 17, 617-622. 
Glaser, W. (1940). Z. Physik 117, 285-315. 
Glaser, W. (1950). Paris, pp. 158-164. 
Glaser, W. (1952). Grundlagen der Elektronenoptik (Springer, Vienna). 
Glazer, W. (1956). Elektronen- und Ionenoptik. Handbuch der Physik 33, 123-395. 
Glaser, W. and Bergmann, O. (1950). Z. Angew. Math. Phys. 1,363-379. 
Glaser, W. and Bergmann,O. (1951). Z. Angew. Math. Phys. 2, 159-188. 

596 
NOTES AND REFERENCES 
Glaser, A. and Henneberg, W. (1935). Z. Tech. Phys. 16, 222-230. 
Glaser, W. and Lammel, E. (1941). Ann. Physik (Leipzig) 40, 367-384. 
Glaser, W. and Lammel, E. (1943). Monatsh. Math. Phys. 50, 289-297. 
Glikman, L.G. and Yakushev, E.M. (1967). Zh. Tekh. Fiz. 37, 2097-2099; Soy. Phys. 
Tech. Phys. 12, 1544-1545. 
Glikman, L.G., Kel'man, V.M. and Yakushev, E.M. (1~967a). Zh. Tekh. Fiz. 37, 13-16; 
Soy. Phys. Tech. Phys. 12, 9-11. 
Glikman, L.G., Kel'man, V.M. and Yakushev, E.M. (1967b). Zh. Tekh. Fiz. 37, 1028- 
1034 and 1720-1725; Soy. Phys. Tech. Phys. 12, 740-744 and 1261-1264. 
Glikman, L.G., Karetskaya, S.P., Kel'man, V.M. and Yakushev, E.M. (1971). Zh. Tekh. 
Fiz. 41,330-335; Soy. Phys. Tech. Phys. 16, 247-251. 
Glushko, M.T. and Strashkevich, A.M. (1940). Zh. Tekh. Fiz. 10, 1793-1799. 
Glushko, M.T. and Strashkevich, A.M. (1941). Zh. Tekh. Fiz. 11,205-228. 
Gratsiatos, J. (1940). Z. Physik 115, 61-68. 
Grivet, P. and Septier, A. (1960). Nucl. Instrum. Meth. 6, 126-156 and 243-275. 
Gullstrand, A. (1900). Nova Acta R. Soc. Sci. Upsal. 20, 204 pp. 
Gullstrand, A. (1906). K. Svensk. Vetenskapsakad. Hand. 41, No. 3, 119 pp. 
Gullstrand, A. (1908). K. Svensk. Vetenskapsakad. Hand. 43, No. 2, 58 pp. 
Gullstrand, A. (1915). K. Svensk. Vetenskapsakad. Hand. 55, No. 1,139 pp. 
Gullstrand, A. (1924). K. Svensk. Vetenskapsakad. Hand. 63, No. 13, 175 pp. 
Hahn, E. (1965). Jenaer Jahrbuch, 107-145. 
Hahn, E. (1971). Wiss. Z. Tech. Univ. Dresden 20, 361-363. 
Harting, E. and Read, F.H. (1976). Electrostatic Lenses (Elsevier, Amsterdam, Oxford 
and New York). 
Hawkes, P.W. (1966). Quadrupole Optics (Springer, Berlin and New York). 
Hawkes, P.W. (1967). Brit. J. Appl. Phys. 18, 545-547. 
Hawkes, P.W. (1970). Quadrupoles in Electron Lens Design, Adv. Electron. Electron 
Phys. Suppl. 7 (Academic Press, New York and London). 
Hawkes, P.W., ed. (1982). Magnetic Electron Lenses (Springer, Berlin and New York). 
Henneberg, W. (1935). Z. Physik 94, 22-27. 
Henneberg, W. and Recknagel, A. (1935). Z. Tech. Phys. 16, 621-623. 
Herzberger, M. (1931). Strahlenoptik (Springer, Berlin). 
Herzberger, M. (1943). J. Opt. Soc. Am. 33, 651-655. 
Herzberger, M. (1958). Modern Geometrical Optics (Interscience, New York and London). 
Hibi, T., Takahashi, S. and Takahashi, K. (1967). J. Electron Microsc. 16, 225-231. 
Hottenroth, G. (1936). Z. Physik 103, 460-462. 

PART III, CHAPTERS 14-20 
597 
Hottenroth, G. (1937). Ann. Physik (Leipzig) 30, 689-712. 
Hutter, R.G.E. (1945). J. Appl. Phys. 16, 670-678. 
Ivanov, R.D. and Abalmazova, M.G. (1966). Prib. Tekh. Eksp. No. 5, 192-194; Instrum. 
Exp. Tech. 9, 1221-1222. 
Kamke, E. (1977). Differentialgleichungen, LSsungsmethoden und LSsungen, vol. 1, 9th 
ed. (Teubner, Stuttgart). 
Karetskaya, S.P., Kel'man, V.M. and Yakushev, E.M. (1970). Zh. Tekh. Fiz. 40, 
2563-2567; Sov. Phys. Tech. Phys. 15, 2010-2013. 
Karetskaya, S.P., Kel'man, V.M. and Yakushev, E.M. (1971a). Zh. Tekh. Fiz. 41, 
325-329; Sov. Phys. Tech. Phys. 16, 244-246. 
Karetskaya, S.P., Kel'man, V.M. and Yakushev, E.M. (1971b). Zh. Tekh. Fiz. 41, 
548-552; Sov. Phys. Tech. Phys. 16, 425-428. 
Kel'man, V.M. and Yavor, S.Ya. (1954). Zh. Tekh. Fiz. 24, 1329-1332. 
Kel'man, V.M. and Yavor, S.Ya. (1955). Zh. Tekh. Fiz. 25, 1405-1411. 
Kel'man, V.M. and Yavor, S.Ya. (1968). Elektronnaya Optika, 3rd ed. (Nauka, Lenin- 
grad). 
Kel'man, V.M., Kaminskii, D.L. and Yavor, S.Ya. (1954). Zh. Tekh. Fiz. 24, 1410-1427. 
Kel'man, V.M., Fedulina, L.V. and Yakushev, E.M. (1971). Zh. Tekh. Fiz. 41, 1489- 
1497, 1825-1831, 1832-1838 and 2016-2022; Sov. Phys. Tech. Phys. 16, 1171- 
1176, 1444-1448, 1449-1454 and 1598-1602. 
Kel'man, V.M., Fedulina, L.V. and Yakushev, E.M. (1972a). Zh. Tekh. Fiz. 42,297-302; 
Sov. Phys. Tech. Phys. 17, 238-241. 
Kel'man, V.M., Sekunova, L.M. and Yakushev, E.M. (1972b). Zh. Tekh. Fiz. 42, 
2279-2287; Sov. Phys. Tech. Phys. 17, 1786-1791. 
Kel'man, V.M., Sekunova, L.M. and Yakushev, E.M. (1973a). Zh. Tekh. Fiz. 43, 1799- 
1806 and 1807-1817; Sov. Phys. Tech. Phys. 18, 1142-1146 and 1147-1152. 
Kel'man, V.M., Karetskaya, S.P., Manabaev, Kh.Kh., Fedulina, L.V. and Yakushev, E.M. 
(1973b). Zh. Tekh. Fiz. 43, 2238-2245 and 2463-2471; Sov. Phys. Tech. Phys. 
18, 1418-1421 and 1552-1556. 
Kel'man, V.M., Karetskaya, S.P., Fedulina, L.V. and Yakushev, E.M. (1979). Elektronno- 
Opticheskie Elementy Prismennykh Spektrometrov Zaryazhennykh Chastits (Nauka, 
Alma-Ata). 
Kel'man, V.M., Karetskaya, S.P., Saichenko, N.Yu. and Fedulina, L.F. (1982). Zh. Tekh. 
Fiz. 52, 2140-2145; Sov. Phys. Tech. Phys. 27, 1318-1321. 
King, N.M. (1964). Theoretical techniques of high-energy beam design. Prog. Nucl. 
Phys. 9, 71-116. 
Knoll, M. and Ruska, E. (1932a). Ann. Physik (Leipzig) 12, 607-661. 
Knoll, M. and Ruska, E. (1932b). Z. Physik 78, 318-339. 

598 
NOTES AND REFERENCES 
Koch, W. (1967). Optik 25, 523-534 and 535-550. 
Kochanov, E.S. (1962). Zh. Tekh. Fiz. 32, 294-302; Soy. Phys. Tech. Phys. 7, 209-214. 
Kochanov, E.S. (1963). Zh. Tekh. Fiz. 33, 1301-1310; Soy. Phys. Tech. Phys. 8, 
969-975. 
Kot, M.V. (1952). Uchen. Zap. Chernovitskii Gos. Univ. (Ser. Fiz.-Mat. Nauk)4, 
73-94. 
Laudet, M. (1953). Cah. Phys. No. 41, 7, 73-80. 
Laudet, M. (1955). J. Phys. Radium 16, 118-124 and 908-916. 
Laudet, M. (1956). Ann. Fac. Sci. Toulouse 20, 111-230. 
Leitner, M. (1942). Die Abbildungsfehler der Elektrischen Zylinderlinse. Draft Disserta- 
tion, Berlin. 
Lichte, It. (1983). In Proc. Int. Syrup. Foundations of Quantum Mechanics in the Light 
of New Technology (Kamefuchi, S., ed.) pp. 29-38 (Physical Society of Japan, 
Tokyo). 
Luckey, D. (1961). Beam optics. In Techniques of High Energy Physics (Ritson, D.M., 
ed.) pp. 403-463 (Wiley-Interscience, New York and London). 
Marton, L. (1946). Electron microscopy. Repts Prog. Phys. 10,204-252. 
Melkich, A. (1947). Ausgezeichnete astigmatische Systeme der Elektronenoptik. Disser- 
tation, Berlin 1944; Sitzungsber. Akad. Wiss. Wien, Abt. IIA, 155,393-438 and 
440-471. 
Metherell, A.J.F. (1971). Adv. Opt. Electron Microsc. 4, 263-360. 
MSllenstedt, G. and Diiker, H. (1953). Naturwissenschaften 42, 41. 
Mulvey, T. (1984). In Electron Optical Systems for Microscopy, Microanalysis and Mi- 
crolithography (Hren, J.J., Lenz, F.A., Munro, E. and Sewell, P.B., eds) pp. 15-27 
(Scanning Electron Microscopy, AMF O'Hare). 
Mulvey, T. and Wallington, M.J. (1973). Electron lenses. Repts Prog. Phys. 36,347-421. 
Nicholl, F.H. (1938). Proc. Phys. Soc. (London) 50, 888-898. 
Ollendorff, F. (1955). Elektronik des Einzelektrons (Springer, Vienna). 
Ollendorff, F. and Wendt, G. (1932). Z. Physik 76, 655-659. 
Picht, J. (1932). Ann. Physik (Leipzig) 15, 926-964. 
Picht, J. (1933a). Z. Tech. Phys. 14, 239-241. 
Picht, J. (1933b). Z. Instrumentenkde 53, 274-282. 
Picht, J. (1939a). Ann. Physik (Leipzig) 36, 249-264. 
Picht, J. (1939b). Einfahrung in die Theorie der Elektronenoptik, 1st ed. (Barth, Leipzig). 
Picht, J. (1963). Einfahrung in die Theorie der Elektronenoptik, 3rd ed. (Barth, Leipzig). 
Putz, F. (1951). 
Uber die Elektronenoptische Abbildung in Starken Elektrischen und 
Magnetischen Abbildungsfeldern. Dissertation, Vienna. 

PART III, CHAPTERS 14-20 
599 
Rabin, B.M. and Strashkevich, A.M. (1950). Zh. Tekh. Fiz. 20, 1232-1240. 
Rabin, B.M., Strashkevich, A.M. and Khin, L.S. (1951). Zh. Tekh. Fiz. 21,438-444. 
Rayleigh, Lord [J.W. Strutt] (1886). Phil. Mag. 21,466-476. 
Recknagel, A. (1936). Z. Tech. Phys. 17, 643-645. 
Recknagel, A. (1937). Z. Physik 104, 381-394. 
Regenstreif, E. (1947). Ann. Radio~l. 2, 348-358. 
Regenstreif, E. (1951). Ann. Radio~l. 6, 51-83 and 114-154. 
Regenstreif, E. (1966). C.R. Acad. Sci. Paris B263, 1205-1207 and 1297-1299. 
Regenstreif, E. (1967). C.R. Acad. Sci. Paris B264, 596-598. 
Riecke, W.D. (1982). Practical lens design. In Magnetic Electron Lenses (Hawkes, P.W., 
ed.) pp. 164-357 (Springer, Berlin and New York). 
Riecke, W.D. (1984). In Electron Optical Systems for Microscopy, Microanalysis and 
Microlithography (Hren, J.J., Lenz, F.A., Munro, E. and Sewell, P.B., eds) pp. 
1-14 (Scanning Electron Microscopy, AMF O'Hare). 
Rose, H. (1966/67). Optik 24, 36-59 and 108-121. 
Rose, H. (1972). Optik 36, 19-36. 
Ruska, E. (1934a). Z. Physik 87, 580-602. 
Ruska, E. (1934b). Z. Physik 89, 90-128. 
Rusterholz, A.A. (1950). Elektronenoptik (Birkh~iuser, Basel). 
Schiske, P. (1957). Optik 14, 34-45. 
Schriber, S.O. and Taylor, L.S., eds (1987). Proc. 2nd Int. Conf. Charged Particle Optics, 
Nucl. Instrum. Meth. Phys. Res. A258, 289-598 (North-Holland, Amsterdam). 
Septier, A. (1953). Ann. Radio~l. 9,374-410. 
Septier, A. (1954). C.R. Acad. Sci. Paris 239, 402-404. 
Septier, A. (1961). Adv. Electron. Electron Phys. 14, 85-205. 
Shpak, E.V. and Yavor, S.Ya. (1964). Zh. Tekh. Fiz. 34, 1037-1039; Sov. Phys. Tech. 
Phys. 9, 803-805. 
Steffen, K.G. (1965). High Energy Beam Optics (Wiley-Interscience, New York and 
London). 
Steffen, K. (1985). Basic course on accelerator optics. In CERN Accelerator School, 
General Accelerator Physics (Bryant, P. and Turner, S., eds) vol. 1, pp. 25-63 
(CERN, Geneva, Report 85-19). 
Strashkevich, A.M. (1940a). J. Physics (USSR) 3,507-523. 
Strashkevich, A.M. (1940b). Kiev. Tech. Inst. Kozhevenno-obuvnoi Prom. Sb. Nauch.- 
Issled. Rabot. 3, 249-260. 
Strashkevich, A.M. (1940c). Zh. Tekh. Fiz. 10, 91-111. 

600 
NOTES AND REFERENCES 
Strashkevich, A.M. (1952a). Zh. Tekh. Fiz. 22,487-497 and 1848-1856. 
Strashkevich, A.M. (1952b). Uch. Zap. Chernovits. Gos. Univ., Ser. Fiz.-Mat. Nauk 4, 
53-58. 
Strashkevich, A.M. (1954). Zh. Tekh. Fiz. 24, 274-286. 
Strashkevich, A.M. (1955). Nauk. Zap. Chernivet'sk Derzhavn. Univ. (Ser. Fiz.-Mat.) 
12, 189-197. 
Strashkevich, A.M. (1959). 
Elektronnaya Optika Elektrostaticheskikh Polei ne Obla- 
dayushchikh Osevoi Simmetriei (Fizmatgiz, Moscow). 
Strashkevich, A.M. (1962). Zh. Tekh. Fiz. 32, 1142-1152; Sov. Phys. Tech. Phys. 7, 
841-847. 
Strashkevich, A.M. (1966). Elektronnaya Optika Elektrostaticheskikh Sistem (Energiya, 
Moscow and Leningrad). 
Strashkevich, A.M. and Glushko, M.T. (1940). Kiev. Tech. Inst. Kozhevenno-obuvnoi 
Prom. Sb. Nauch.-Issled. Rabot. 3, 239-248. 
Strashkevich, A.M. and Yurchenko, N.P. (1952). Uch. Zap. Chernovits. Gos. Univ., Ser. 
Fiz.-Mat. Nauk 4, 99-112. 
Sturrock, P.A. (1951). C.R. Acad. Sci. Paris 233,401-403. 
Sturrock, P.A. (1955). Static and Dynamic Electron Optics (University Press, Cam- 
bridge). 
Tanaka, K. (1981). Optik 58, 351-358 and 60, 73-80. 
Tanaka, K. (1982). Optik 62, 211-214. 
Tanaka, K. (1983). Optik 64, 13-24 and 89-111. 
Tanaka, K. (1986). Paraxial theory in optical design in terms of Gaussian brackets. Prog. 
Opt. 23, 63-111. 
Thomas, L.H. (1938). Phys. Rev. 54, 580-588. 
Vukanid, J., Terzi6, I., Ani~in, B. and (~irid, D. (1976). J. Phys. E: Sci. Instrum. 9, 
842-843. 
Wallington, M.J. (1970). J. Phys. E: Sci. Instrum. 3, 599-604. 
Wallington, M.J. (1971). J. Phys. E: Sci. Instrum. 4, 1-8. 
Whittaker, E.T. and Watson, G.N. (1927). A Course of Modern Analysis, 4th ed. (Uni- 
versity Press, Cambridge). 
Wollnik, H. (1987). Optics of Charged Particles (Academic Press, Orlando and London). 
Ximen, J.-y., Zhou, L-.w. and Ai, K.-c. (1983). Optik 66, 19-34. 
Yakushev, E.M. and Sekunova, L.M. (1986). Adv. Electron. Electron Phys. 68,337-416. 
Yavor, S.Ya. (1955). Zh. Tekh. Fiz. 25, 779-790. 
Yavor, S.Ya. (1962). In Proc. Symp. Electron Vacuum Phys., Budapest pp. 125-137. 

PART IV, CHAPTERS 21-31 
601 
Yavor, S.Ya. (1968). Fokusirovka Zaryazhennykh Chastits Kvadrupol'nymi Linzami (At- 
omizdat, Moscow). 
Yavor, S.Ya. and Szilagyi, M. (1960). Zh. Tekh. Fiz. 30, 927-932; Sov. Phys. Tech. 
Phys. 5, 872-876. 
Yavor, S.Ya., Shpak, E.V. and Minima, R.M. (1960). Zh. Tekh. Fiz. 30, 395-404; Sov. 
Phys. Tech. Phys. 5, 369-377. 
Zworykin, V.K., Morton, G.A., Ramberg, E.G., Hillier, J. and Vance, A.W. (1945). 
Electron Optics and the Electron Microscope (Wiley, New York and Chapman and 
Hall, London). 
Part IV, Chapters 21-31 
Further discussion or alternative presentations of the basic ideas of this 
chapter are to be found in Carath~odory (1937), Sturrock (1952) and 
Kas'yankov (1958a) and aberrations in general are surveyed in Hawkes 
(1967a) and Lenz (1982a). The historical article by Kanaya (1985) also 
takes a broad view. 
It has not been possible to find space for an account of the interesting 
new approach to aberrations in the language of Lie algebra, explained in 
detail by Dragt and Forest (1986). 
One of the attractions claimed for 
this approach is the ease with which inter-relations between aberration 
coefficients are recovered; we therefore remind the reader that this has long 
been known to be an advantage of the eikonal method and that various 
alternative ways of establishing such relations have been explored by Meads 
(1963) and Sivkov (1971). The 'symplecticity', which is a central feature 
of the Lie method, is powerfully exploited by Wollnik and Berz (1985) and 
examined critically by Rose (1987). 
Many papers have been devoted to each of the aberrations analysed 
in Chapters 24 and 25. On spherical aberration, see Rebsch and Schneider 
(1937), Pecker and Wallraff (1938), aebsch (1938), Plass (1942), Sugiura 
and Suzuki (1943), Vlasov (1944), Sorokin and Timofeev (1948), Lieb- 
mann (1951), Kanaya (1951a, 1952a), Seman (1953a,b), Kas'yankov (1955), 
Griimm (1956), Archard (1958), Petrie (1962), Der-Shvarts and Makarova 
(1966, 1967), Septier (1966), Barnes and Openshaw (1968), Brookes et 
al. (1968), Der-Shvarts (1971), Hanszen et al. (1972a,b), Lyubchik and 
Mokhnatkin (1972), Ishikawa (1978), Suzuki and Ishikawa (1978) and van 
Gorkum and Spanjer (1986). Meyer (1956) considers the fifth-order spheri- 
cal aberration present when the third-order aberration has been corrected. 
Measurements and calculations for lens models are to be found in Part VII, 
Chapters 35 and 36. 

602 
NOTES AND REFERENCES 
Coma is further considered by Kanaya (1951d), Lenz (1954), Seman 
(1959 ), aos  
Moses ( 972,  973), aos  
Moses ( 973) 
Lenz et al. (1982). 
For astigmatism and field curvature, see Becker and Wallraff (1939, 
1940), Kas'yankov (1950, 1952, 1967), Kanaya (1951c), Seman (1959c), Du- 
tova and Kas'yankov (1963), Taganov and Kas'yankov (1964, 1965, 1967), 
Waganov (1966) and Gurbanov and Kas'yankov (1966). 
The Petzval curvature is discussed by Goddard (1946), Chiang (1956), 
Seman (1968), Kas'yankov et al. (1970a,5) and Lenz (1986). 
Distortion is the subject of papers by Hillier (19465), Rang (1948), 
Mulvey and Jacob (1949), Kanaya (19515, 19525), Kanaya and Kato (1951), 
Liebmann (1952a), Wegmann (1953, 1954), De and Saha (1954), Seman 
(1959a), Kynaston and Mulvey (1962, 1963), Dutova and Kas'yankov (1963), 
aeisner (1970), Marai and Mulvey (1975, 1977), Lambrakis et el. (1977), 
Alshwaikh and Mulvey (1977), Elkamali and Mulvey (1977, 1979, 1980), 
Tsuno and Harada (1981a,5) and Tsuno et al. (19805). 
A complete list of the fifth-order aberration coefficients of round lenses 
is to be found in Hawkes (1965a) and later in Li and Ni (1988) and in Ai 
and Szilagyi (1988). As well as the paper by Meyer already cited, see also 
Archard (1960) and U (1957). 
For further theoretical work on chromatic aberration (Chapter 26), 
see Glaser (19405), Scherzer (1941), Kanaya (1951a, 1952a), Liebmann 
(19525), Katagiri (1953), Morito (1954, 1957), Vandakurov (1955a), Watan- 
abe and Morito (1955), Schiske (1956), Seman (19595) and Brookes et al. 
(1968) and as usual, the references for Chapters 35 and 36. 
To Chapter 27, we may add Hawkes (1983b, 1984b), Hanszen et al. 
(1972), Brouwer and Walther (1967) and the use by Heritage (1973) and 
Lewis et al. (1986) of aberration polynomials. 
The papers by Ximen (1957) and Ximen et al. (1983) are relevant to 
Chapter 28. 
The general texts by Steffen (1965), Banford (1966), Carey (1987) and 
Wollnik (1987) are all useful in connection with Chapter 28 as are the 
conference proceedings edited by Wollnik (1981) and Schriber and Taylor 
(1987). For very full bibliographies, see Hawkes (1966, 1970a). 
A few extra details on cylindrical lens theory (Chapter 30) are to be 
found in Bertein (1950, 1951), Laudet (1953) and Vandakurov (19555). 
Parasitic aberrations (Chapter 31) have a voluminous literature, in 
which few authors pay much attention to the work of their predecessors. 
The following list contains analyses of lens imperfections of various sorts 
and descriptions of many kinds of stigmator: Scherzer (1946), Hillier (1946a), 
Bertein (1947a-c, 19485, 1949), Bertein and Regenstreif (1947, 1949), Bruck 
(1947), Bruck and Grivet (1947, 1950), Glaser (1948), Cotte (1949, 1950), 

PART IV, CHAPTERS 21-31 
603 
Grivet et al. (1949), Inoue (1950), aabin et al. (1951), aegenstreif(1951a,b), 
Recknagel and Haufe (1952/53), Leisegang (1953, 1954), Hahn (1954, 1959, 
1966), Lenz and Hahn (1953), Kanaya (1953, 1955, 1958, 1962), Sakaki 
and Maruse (1954), Morito (1955), Stoyanov (1958a,b), Riecke (1958, 1964, 
1966/67, 1972, 1976, 1982), Kanaya and Ishikawa (1958, 1959), Kas'yankov 
(1959), Katagiri (1960a,b), Meyer (1961), Vlasov and Shakhmatova (1962), 
Watanabe and Someya (1963), Ximen and Chen (1964), Ximen and Xi 
(1964), Tadano et al. (1966), Reisner and Schuler (1967), Amboss and Jen- 
nings (1970), Yanaka and Shirota (1970) and Monastyrskii and Kolesnikov 
( 983). 
Adams, A. and Read, F.tI. (1972a). J. Phys. E: Sci. Instrum. 5, 150-155. 
Adams, A. and Read, F.H. (1972b). J. Phys. E: Sci. Instrum. 5, 156-160. 
Ade, G. (1973). Der Einfluss der Bildfehler driller Ordnung auf die elektronenmikros- 
kopische A bbildung und die Korrektur dieser Fehler dutch holographische Rekon- 
struktion. PTB-Ber. APh-3, 114 pp. 
Ade, G. (1982). Optik 63, 43-54. 
Ai, K.-c. and Szilagyi, M. (1988). Optik 79, 33-40. 
Alshwaikh, A. and Mulvey T. (1977). EMAG, pp. 25-28. 
Amboss, K. (1959). Electron Optics: aberrations of air-cored magnetic lenses. Thesis, 
London. 
Amboss, K. and Jennings, J.C.E. (1970). J. Appl. Phys. 41, 1608-1616. 
Archard, G.D. (1953). J. Sci. Instrum. 30, 352-358. 
Archard, G.D. (1958). Rev. Sci. Instrum. 29, 1049-1050. 
Archard, G.D. (1960). Brit. J. Appl. Phys 11,521-522. 
Banford, A.P. (1966). The Transport of Charged Particle Beams (Spon, London). 
Baranova, L.A. and Yavor, S.Ya (1986). Elektrostaticheskie Elektronnye Linzy (Nauka, 
Moscow). 
Barnes, R.L. and Openshaw, I.K. (1968). J. Phys. E: Sci. Instrum. 1,628-630. 
Barton, D. and Fitch, J.P. (1972). Repts Prog. Phys. 35, 235-314. 
Becket, H. and Wallraff, A. (1938). Arch. Elektrotech. 32, 664-675. 
Becket, H. and Wallraff, A. (1939). Arch. Elektrotech. 33,491-505. 
Becker, H. and Wallraff, A. (1940). Arch. Elektrotech. 34, 43-48. 
Bertein, F. (1947a). C.R. Acad. Sci. Paris 224, 106-107 and 560-562. 
Bertein, F. (1947b). C.R. Acad. Sci. Paris 225,801-803. 
Bertein, F. (1947c). C.R. Acad. Sci. 225, 863-865. 
Bertein, F. (1947d). Ann. Radiodl. 2, 249-252. 
Bertein, F. (1947e). Ann. Radiodl. 2, 379-408. 

604 
NOTES AND REFERENCES 
Bertein, F. (1948a). Ann. Radio~l. 3, 49-62. 
Bertein, F. (1948b). J. Phys. Radium 9, 104-112. 
Bertein, F. (1949). C.R. Acad. Sci. Paris 229, 291-293. 
Bertein, F. (1950). C.R. Acad. Sci. Paris 231,766-767, 1134-1136 and 1448-1449. 
Bertein, F. (1951). J. Phys. Radium 12, 595-601 and 25A-31A. 
Bertein, F. and Regenstreif, E. (1947). C.R. Acad. Sci. Paris 224, 737-739. 
Bertein, F. and Regenstreif, E. (1949). C.R. Acad. Sci. Paris 228, 1854-1856. 
Bertein, F., Bruck, H. and Grivet, P. (1947). Ann. Radiod. 2, 249-252. 
Bonshtedt, B.E. (1964). Radiotekh. Elektron. 9, 844-850; Radio Eng. Electron. 9, 
686-692. 
Born, M. and Wolf, E. (1959). Principles of Oplics (Pergamon, Oxford and New York); 
7th ed., 1988. 
Broglie, L. de (1950). Optique Electroniqne et Corpusculaire (Hermann, Paris). 
Brookes, K.A., Mulvey, T. and Wallington, M.J. (1968). Rome, vol. 1, pp. 165-166. 
Brouwer, W. (1957). The Use of Matrix Algebra in Geometrical Optics. Dissertation, 
Delft. 
Brouwer, W. (1964). Matrix Methods in Optical Instrument Design (Benjamin, New York 
and Amsterdam). 
Brouwer, W. and Walther, A. (1967). Design of optical instruments. In Advanced Optical 
Techniques (van Heel, A.C.S., ed.) pp. 571-631 (North Holland, Amsterdam). 
Bruck, H. (1947). C.R. Acad. Sci. Paris 224, 1628-1629 and 1818-1820. 
Bruck, H. and Grivet, P. (1947). C.R. Acad. Sci. Paris 224, 1768-1769. 
Bruck, H. and Grivet P. (1950). Rev. Opt. 29, 164-170. 
Bruck, H., Remillon, R. and Romani, L. (1948). C.R. Acad. Sci. Paris 226, 650-652. 
Bruns, H. (1895). Abh. K. S~ichs. Ges. Wiss., Math.-Phys. K1. 21, 321-436 ; also 
published as Das Eikonal (Hirzel, Leipzig). 
Burfoot, J. (1953). Proc. Phys. Soc. (London) B66, 775-792. 
Burfoot, J. (1954a). Proc. Phys. Soc. (London) B67, 523-528. 
Burfoot, J. (1954b). London, pp. 105-109. 
Busch H. and Brfiche, E., eds (1937). Beitr~ge znr Elektronenoptik,(Barth, Leipzig). 
Carathdodory, C. (1937). Geometrische Optik. Ergebnisse der Mathematik und ihrer 
Grenzgebiete, vol. 5 (Springer, Berlin). 
Carey, D.C. (1987). The Optics of Charged Particle Beams (Harwood, Chur, London and 
New York). 
Chako, N. (1957). Trans. Chalmers Univ. Technol. Gothenburg, Nr. 191, 50 pp. 
Chiang, M.-y. (1956). Acta Phys. Sin. 12,439-446. 

PART IV, CHAPTERS 21-31 
605 
Cotte, M. (1949). C.R. Acad. Sci. Paris 228, 377-378. 
Cotte, M. (1950). Paris, pp. 155-157. 
Czapski, S. and Eppenstein, O. (1924). Grundz~ge der Theorie der Oplischen Instrumenle 
nach A bbe, 3rd ed. (Barth, Leipzig). 
Daumenov, T.D., Sapargaliev, A.A. and Yakushev, E.M. (1978). Zh. Tekh. Fiz. 48, 
2447-2454; Sov. Phys. Tech. Phys. 23, 1400-1404. 
De, M.L. and Saha, D.K. (1954). Ind. J. Phys. 28,263-268. 
Der-Shvarts, G.V. (1954). Zh. Tekh. Fiz. 24, 859-870. 
Der-Shvarts, G.V. (1970). Elektrofiz. Elektrokhim. Met. Obrabotki, vyp. 4, pp. 7-10. 
Der-Shvarts, G.V. (1971), Radiotekh. Elektron. 16, 1305-1306; Radio Eng. Electron. 
Phys. 16, 1240-1241. 
Der-Shvarts, G.V. and Makarova I.S. (1966). Radiotekh. Elektron. 11, 89-93; Radio 
Eng. Electron. Phys. 11, 72-75. 
Der-Shvarts, G.V. and Makarova I.S. (1967). Radiotekh. Elektron. 12, 168-171; Radio 
Eng. Electron. Phys. 12, 161-163. 
Der-Shvarts, G.V. and Makarova I.S. (1972). Izv. Akad. Nauk SSSR (Ser. Fiz.) 36, 
1304-1311; Bull. Acad. Sci. USSR (Phys. Ser.) 36, 1164-1170. 
Der-Shvarts, G.V. and Makarova I.S. (1973). Radiotekh. Elektron. 18, 2374-2378; Radio 
Eng. Electron. Phys. 18, 1722-1725. 
Dodin, A.L. and Nesvizhskii, M.B. (1981). Zh. Tekh. Fiz. 51, 897-901; Sov. Phys. 
Tech. Phys. 26, 539-541. 
Douglas, D.R. and Dragt, A.J. (1983). IEEE Trans. NS-30, 2442-2444. 
Dragt, A.J. (1979). IEEE Trans. NS-26, 3601-3603. 
Dragt, A.J. (1982). J. Opt. Soc. Amer. 72, 372-379. 
Dragt, A.J. and Forest, E. (1983). J. Math. Phys. 24, 2734-2744. 
Dragt, A.J. and Forest, E. (1986). Lie algebraic theory of charged-particle optics and 
electron microscopes. Adv. Electron. Electron Phys. 67, 65-120. 
Dragt, A.J., Forest, E. and Wolf, K.B. (1986). Foundations of a Lie algebraic theory of 
geometrical optics. In Lie Methods in Optics (Mondrag6n, J.S. and Wolf, K.B., 
eds) pp. 105-157 (Springer, Berlin). 
Du~ek, H. (1959). Optik 16, 419-445. 
Dutova, K.P. and Kas'yankov, P.P. (1963). Izv. Akad. Nauk. SSSR (Ser. Fiz.) 27, 
1127-1130; Bull. Acad. Sci. USSR (Phys. Ser.) 27, 1108-1111. 
Elkamali, H.H. and Mulvey, T. (1977). EMAG, pp. 33-34. 
Elkamali, H.H. and Mulvey, T. (1979). EMAG, pp. 63-64. 
Elkamali, H.H. and Mulvey, T. (1980). The Hague, vol. 1, 74-75. 
Finsterwalder, S. (1982). Abh. Math.-Phys. KI. K. Bayr. Akad. Wiss. 17, 517-587. 

606 
NOTES AND REFERENCES 
Fitch, J.P. (1979). In Symbolic and Algebraic Computation (Ng, E.W., ed.) pp. 30-41. 
Vol. 72 of Lecture Notes in Computer Science (Springer, Berlin and New York). 
Fitch, J.P. (1985). J. Symbol. Comput. 1,211-227. 
Focke, J. (1965). Prog. Opt. 4, 1-36. 
Funk, P. (1936). Monatsh. Math. Phys. 43, 305-316. 
Funk, P. (1937). Monatsh. Math. Phys. 45, 314-319. 
Glaser, W. (1933a). Z. Physik 81,647-686. 
Glaser, W. (1933b). Z. Physik 83, 104-122. 
Glaser, W. (1933c). Ann. Physik (Leipzig) 18, 557-585. 
Glaser, W. (1935). Z. Physik 97, 177-201. 
Glaser, W. (1936a). Z. Tech. Phys. 17, 617-622. 
Glaser, W. (1936b). Z. Physik 104, 157-160. 
Glazer, W. (1937). In Beitr~ge zur Elektronenoptik (Busch, H. and Brfiche, E., eds) pp. 
24-33 (Barth, Leipzig). 
Glaser, W. (1938). Z. Physik 109,700-721. 
Glaser, W. (1940a). Z. Physik 116, 19-33 and 734-735. 
Glaser, W. (1940b). Z. Physik 116, 56-67. 
Glaser, W. (1942/43). Z. Physik 120, 1-15. 
Glaser, W. (1948). Ost. Ing.-Arch. 3, 39-46. 
Glaser, W. (1949). Ann. Physik (Leipzig) 4, 389-408. 
Glaser, W. (1952). Grundlagen der Elektronenoptik (Springer, Vienna). 
Glaser, W. and Schiske, P. (1953). Z. Angew. Phys. 5, 329-339. 
Goddard, L.S. (1946). Proc. Camb. Philos. Soc. 42, 127-131. 
Gorkum, A.A. van and Spanjer, T.G. (1986). Optik 72, 134-136. 
Goto, E. and Soma, T. (1977). Optik 48, 255-270. 
Gratsiatos, J. (1936). Z. Physik 102, 641-651. 
Gratsiatos, J. (1937). Z. Physik 107, 382-386. 
Grinberg, G.A. (1942). Dokl. Akad. Nauk SSR 37, 172-178 and 261-268. 
Grinberg, G.A. (1943a). Dokl. Akad. Nauk. SSR 38, 78-81. 
Grinberg, G.A. (1943b). Zh. Tekh. Fiz 13, 361-388 (Russian version of Grinberg 1942, 
1943a). 
Grinberg, G.A. (1948). Izbrannye Voprosy Mathematicheskoi Teorii Elektricheskikh i 
Magnitnykh Yavlenii (Academy of Sciences Press, Moscow). 
Grinberg, G.A. (1957a). Opt. Spektrosk. 3, 673. 
Grinberg, G.A. (1957b). Zh. Tekh. Fiz. 27, 2425-2431; Sov. Phys. Tech. Phys. 2, 
2259-2265. 

PART IV, CHAPTERS 21-31 
607 
Grivet, P., Bertein, F. and Regenstreif, E. (1949). Delft, pp. 86-88. 
Griimm, H. (1956). Optik 13, 92-93. 
Gullstrand, A. (1915). Kungl. Svensk. Vetenskapsakad. Handl. 63 (suppl.), No. 13, 175 
pp. 
Gurbanov, G.G. and Kas'yankov, P.P. (1966). Izv. Akad. Nauk SSSR (Ser. Fiz.) 30, 
735-738; Bull. Acad. Sci. USSR (Phys. Ser.) 30, 762-765. 
Hahn, E. (1954). Jenaer Jahrb. Pt I, 63-75. 
Hahn, E. (1959). Jenaer Jahrb. Pt I, 86-114. 
Hahn, E. (1966). Jenaer Jahrb. 145-172. 
Hamilton, W.R. (1931). The Mathematical Papers of Sir William Rowan Hamilton (Con- 
way, A.W. and Synge, J.L., eds, University Press, Cambridge). 
Hanszen, K.-J., Ade, G. and Lauer, R. (1972a). Optik 35, 567-590. 
Hanszen, K.-J., Lauer, R. and Ade, G. (1972b). Optik 36, 156-159. 
Hardy, D.F. (1967). Combined Magnetic and Electrostatic Quadrupole Electron Lenses. 
Dissertation, Cambridge. 
Harrington, R.F. (1968). Field Computation by Moment Methods (Macmillan, New York 
and Collier-Macmillan, London). 
Hawkes, P.W. (1964). Prague, vol. 1, pp. 5-6. 
Hawkes, P.W. (1965a). Phil. Trans. Roy. Soc. (London) A257, 479-522. 
Hawkes, P.W. (1965b). Optik 22,340-368. 
Hawkes, P.W. (1965c). Optik 22, 543-551. 
Hawkes, P.W. (1965d). Optik 23,244-250. 
Hawkes, P.W. (1966). Quadrupole Optics (Springer, Berlin and New York). 
Hawkes, P.W. (1966/67a). Optik 24, 60-78 and 95-107. 
Hawkes, P.W. (1966/67b). Optik 24, 252-262 and 275-282. 
Hawkes, P.W. (1967a). Lens aberrations. In Focusing of Charged Particles (Septier, A., 
ed) vol. 1, pp. 411-468 (Academic Press, New York and London). 
Hawkes, P.W. (1967b). J. Microscopie 6, 917-932. 
Hawkes, P.W. (1968). Optik 27, 287-304. 
Hawkes, P.W. (1970a). Quadrupoles in Electron Lens Design (Academic Press, New York 
and London), Supplement 7 to Adv. Electron. Electron Phys. 
Hawkes, P.W. (1970b). Optik 31,213-219. 
Hawkes, P.W. (1970c). Optik 31,302-314. 
Hawkes, P.W. (1970d). Optik 31,592-599. 
Hawkes, P.W. (1970e). Optik 32, 50-60. 
Hawkes, P.W. (1970f). J. Microscopie 9,435-454. 

608 
NOTES AND REFERENCES 
Hawkes, P.W. (1977a). Optik 48, 29-51. 
Hawkes, P.W. (1977b). HVEM Kyoto, pp. 57-60 
Hawkes, P.W. (1980a). Methods of computing optical properties and combating aber- 
rations for low-intensity beams. In Applied Charged Particle Optics (Septier, A., 
ed.) vol. A, pp. 45-157; Adv. Electron. Electron Phys. Suppl. 13A (Academic 
Press, New York and London). 
Hawkes, P.W. (1980b). Optik 56, 293-320. 
Hawkes, P.W. (1983a). Optik 63, 129-156 and 65, 227-251. 
Hawkes, P.W. (1983b). EMAG, pp. 471-474. 
Hawkes, P.W. (1984a). Optik 66, 379-380. 
Hawkes, P.W. (1984b). Budapest, vol. 1, pp. 23-24. 
Hawkes, P.W. (1985a). Optik 70, 115-123. 
ttawkes, P.W. (1985b). Optik 70, 140-142. 
ttawkes, P.W. (1986). Ultramicroscopy 20, 189-194. 
ttawkes, P.W. (1987). J. Phys. E: Sci. Instrum. 20, 234-235. 
ttawkes, P.W. and Cosslett, V.E. (1962). Brit. J. Appl. Phys. 13, 272-279. 
Hearn, A.C. (1985). REDUCE User's Manual (Rand Publication CP78, Rand Corp., 
Santa Monica, CA 90406). 
Heel, A.C.S. van (1949). In La Th~orie des Images Opliques (Fleury, P., ed.) pp. 32-67 
(Editions Revue d'Optique, Paris). 
Heel, A.C.S. van (1964). Inleiding in de Optica, 5th ed. (Nijhoff, The Hague). 
Heritage, M.B. (1973). In Image Processing and Computer-aided Design in Electron 
Optics (Hawkes, P.W., ed.) pp. 324-338 (Academic Press, London and New 
York). 
Herzberger, M. (1931). Strahlenoptik (Springer, Berlin). 
Herzberger, M. (1958). Modern Geometrical Optics (Interscience, New York and London). 
Hillier, J. (1946a). J. Appl. Phys. 17, 307-309. 
Hillier, J. (1946b). J. Appl. Phys. 17, 411-419. 
Hillier, J. and Ramberg, E.G. (1947). J. Appl. Phys. 18, 48-71. 
Inoue, Y. (1950). Paris, pp. 199-200. 
Jandeleit, O. and Lenz, F. (1959). Optik 16, 87-107. 
Janse, J. (1971). Optik 33, 270-281. 
Kanaya, K. (1951a). Bull. Electrotech. Lab. 15, 86-91. 
Kanaya, K. (1951b). Bull. Electrotech. Lab. 15, 91-94. 
Kanaya, K. (1951c). Bull. Electrotech. Lab. 15, 193-198. 
Kanaya, K. (1951d). Bull. Electrotech. Lab. 15, 199-202. 

PART IV, CHAPTERS 21-31 
609 
Kanaya, K. (1952a). Bull. Electrotech. Lab. 16, 25-30. 
Kanaya, K. (1952b). Bull. Electrotech. Lab. 16, 135-142. 
Kanaya, K. (1952c). Bull. Electrotech. Lab. 16, 184-192. 
Kanaya, K. (1953). J. Electronmicrosc. 1, 7-12. 
Kanaya, K. (1955). Res. Electrotech. Lab. No. 548, 70 pp. 
Kanaya, K. (1958). Bull. Electrotech. Lab. 22, 615-622. 
Kanaya, K. (1962). Bull. Electrotech. Lab. 26, 161-172. 
Kanaya, K. (1985). In The Beginnings of Electron Microscopy (Hawkes, P.W., ed.) pp. 
317-386 (Academic Press, Orlando and London). 
Kanaya, K. and Ishikawa, A. (1958). Bull. Electrotech. Lab. 22, 641-646. 
Kanaya, K. and Ishikawa, A. (1959). J. Electronmicrosc. 7, 13-15. 
Kanaya, K. and Kato, A. (1951). Bull. Electrotech. Lab. 15, 827-833. 
Kasper, E. (1982). Magnetic field calculation and the determination of electron trajec- 
tories. In Magnetic Electron Lenses (Hawkes, P.W., ed.) pp. 57-118 (Springer, 
Berlin and New York). 
Kas'yankov, P.P. (1950). Zh. Tekh. Fiz. 20, 1426-1434. 
Kas'yankov, P.P. (1952). Zh. Tekh. Fiz. 22, 80-83. 
Kas'yankov, P.P. (1955). Zh. Tekh. Fiz. 25, 1639-1648. 
Kas'yankov, P.P. (1956a). Dokl. Akad. Nauk. SSSR 108, 813-816; Sov. Phys. Dokl. 1, 
367-371. 
Kas'yankov, P.P. (1956b). Teoriya Elektromagnitnykh Sistem s Krivolineinoi Os'yu (Uni- 
versity Press, Leningrad). 
Kas'yankov, P.P. (1957). Opt. Spektrosk. 3, 169-179. 
Kas'yankov, P.P. (1958a). Dokl. Akad. Nauk SSSR 120,497-500; Sov. Phys. Dokl. 3, 
573-576. 
Kas'yankov, P.P. (1958b). Zh. Tekh. Fiz. 28, 915-918; Sov. Phys. Tech. Phys. 3, 
854-857. 
Kas'yankov, P.P. (1959). Izv. Akad. Nauk SSSR (Set. Fiz.) 23, 711-715; Bull. Acad. 
Sci. USSR (Phys. Set.) 23, 706-710. 
Kas'yankov, P.P. (1967). In Chislennye Metody Rascheta Elektronno-Opticheskykh Sistem 
(Marchuk, G.I., ed.) pp. 62-67 (Nauka, Novosibirsk). 
Kas'yankov, P.P. and Dutova, K.P. (1961). Izv. Akad. Nauk SSSR (Ser. Fiz.) 25, 
665-667; Bull. Acad. Sci. USSR (Phys. Set.) 25, 680-682. 
Kas'yankov, P.P., Cheremisina, N.S. and Rynkevich, N.P. (1970b). Opt.-Mekh. Prom. 
37, No. 11, 67; Sov. J. Opt. Technol. 37, 757-758. 
Kas'yankov, P.P., Cheremisina, N.S. and Rynkevich, N.P. (1970b). In Metody Rascheta 

610 
NOTES AND REFERENCES 
Elektronno-Opticheskykh Sistem (Marchuk, G.I., ed.) pp. 62-67 (Nauka, Novosi- 
birsk). 
Katagiri, S. (1953). J. Electronmicrosc. 1, 13-18. 
Katagiri, S. (1960). J. Electronmicrosc. 8, 13-16. 
Katagiri, S. (1960). J. Electronmicrosc. 9, 119. 
Kel'man, V.M. and Yavor, S.Ya (1961). Zh. Tekh. Fiz. 31, 1439-1442; Sov. Phys. Tech. 
Phys. 6, 1052-1054. 
Kel'man, V.M., Fedulina, L.V. and Yakushev, E.M. (1971). Zh. Tekh. Fiz. 41, 1489- 
1497, 1832-1838 and 2016-2022; Soy. Phys. Tech. Phys. 16, 1171-1176, 1449- 
1454 and 1598-1602. 
Kel'man, V.M., Sapargaliev, A.A. and Yakushev, E.M. (1972). Zh. Tekh. Fiz. 42, 
2001-2009; Soy. Phys. Tech. Phys. 17, 1607-1611. 
Kel'man, V.M., Sapargaliev, A.A. and Yakushev, E.M. (1973). Zh. Tekh. Phys. 43, 
52-60; Soy. Phys. Tech. Phys. 18, 33-37. 
Korringa, J. (1942). Onderzoekingen op her Gebied der Algebrai'sche Optiek. Dissertation, 
Delft. 
Kulikov, Yu.V. (1971). Radiotekh. Elektron. 16, 654-655; Radio Eng. Electron. Phys. 
16, 715-717. 
Kulikov, Yu.V. (1972). Radiotekh. Elektron. 17, 373-375; Radio Eng. Electron. Phys. 
17, 286-288. 
Ku]ikov, Yu.V. (1973). Radiotekh. E]ektron. 18, 2379-2383; Radio Eng. Electron. Phys. 
18, No. II, 286-288. 
Ku]ikov, Yu.V. (1975). Radiotekh. Elektron. 20, 1249-1254; Radio Eng. Electron. Phys. 
20, No. 6, 93. 
Ku]ikov, Yu.V., Monastyrskii, M.A. and Feygin, Kh.I. (1978). Radiotekh. Elektron. 23, 
167-175; Radio Eng. Electron. Phys. 23, No. I, 120. 
Kuyatt, C.E. (1978). J. Vac. Sci. Technol. 15, 861-864. 
Kuyatt, C.E., DiChio, D. and Natali, S.V. (1974). Rev. Sci. Instrum. 45, 1275-1280. 
Kynaston, D. and Mulvey, T. (1962). Philadelphia, vol. 1, D-2. 
Kynaston, D. and Mulvey, T. (1963). Brit. J. Appl. Phys. 14, 199-206. 
Lambrakis, E., Marai, F.Z. and Mulvey, T. (1977). EMAG, pp. 35-38. 
Laudet, M. (1953). Cah. Phys. 41, 73-80. 
Laudet, M. (1955a). Ann. Fac. Sci. Toulouse (4) 20, 111-230. 
Laudet, M. (1955b). J. Phys. Radium 16, 118-124 and 908-916. 
Lauer, R. (1982). Characteristics of triode electron guns. Adv. Opt. Electron Microsc. 
8, 137-206. 
Leisegang, S. (1953). Optik 10, 5-14. 

PART IV, CHAPTERS 21-31 
611 
Leisegang, S. (1954). Optik 11, 49-60. 
Leitner, H. (1942). Die A bbildungsfehler der Elektrischen Zylinderlinse. Dissertation 
(draft), Berlin. 
Lenz, F. (1954). London, pp. 86-88. 
Lenz, F. (1956). Stockholm, pp. 48-51. 
Lenz, F. (1957). Optik 14, 74-82. 
Lenz, F. (1982a). Properties of electron lenses. In Magnetic Electron Lenses (Hawkes, 
P.W., ed.) pp. 119-161 (Springer, Berlin and New York). 
Lenz, F. (1982b). Mikroskopie 39, 359-373. 
Lenz, F. (1986). Kyoto, vol. 1, pp. 287-288. 
Lenz, F. and Hahn, M. (1953). Optik 10, 15-27. 
Lenz, F., Speidel, R. and Kuhm, J. (1982). Optik 62, 401-411. 
Lewis, G.N., Paik, H., Mioduszewski, J. and Siegel, B.M. (1986). J. Vac. Sci. Technol. 
B4, 116-119. 
Li, Y. and Ni, W.-x. (1988). Optik 78, 45-47 
Liebmann, G. (1951). Proc. Phys. Soc. (London) B64, 972-977. 
Liebmann, G. (1952a). Proc. Phys. Soc. (London) B65, 94-108. 
Liebmann, G. (1952b). Proc. Phys. Soc. (London) B65, 188-192. 
Lyubchik, Ya.G. and Mokhnatkin, A.V. (1972). Radiotekh. Elektron. 17, 2234-2237; 
Radio Eng. Electron. Phys. 17, 1795-1798. 
Marai, F.Z. and Mulvey, T. (1975). EMAG, pp. 43-44. 
Marai, F.Z. and Mulvey, T. (1977). Ultramicroscopy 2, 187-192. 
Marschall, H.J. (1939). Telefunken-RShre 16, 190-197. 
Meads, P. (1963). The Theory of Aberrations of Quadrupole Focusing Arrays. Thesis, 
University of California; UCRL-10807. 
Melkich, A. (1947). Sitzungsber. Akad. Wiss. Wien, Math-Nat. KI., Abt. IIa, 155, 
393-438 and 439-471. 
Meyer, W.E. (1956). Optik 13, 86-91. 
Meyer, W.E. (1961). Optik 18, 69-91 and 101-114. 
Monastyrskii, M.A. (1978). Zh. Tekh. Fiz. 48, 1117-1122 and 2228-2234; Sov. Phys. 
Tech. Phys. 23,624-627 and 1275-1278. 
Monastyrskii, M.A. (1980). Zh. Tekh. Fiz. 50, 1939-1947; Sov. Phys. Tech. Phys. 25, 
1129-1133. 
Monastyrskii, M.A. and Kolesnikov, S.V. (1983). Zh. Tekh. Fiz. 53, 1668-1677; Sov. 
Phys. Tech. Phys. 28, 1029-1034. 
Monastyrskii, M.A. and Kulikov, Yu.V. (1976). Radiotekh. Elektron. 21, 2251-2254; 
Radio Eng. Electron. Phys. 21, No. 10, 148-150. 

612 
NOTES AND REFERENCES 
Monastyrskii, M.A. and Kulikov, Yu.V. (1978). Radiotekh. Elektron. 23,644-648; Radio 
Eng. Electron. Phys. 23, No. 3, 137-140. 
MondragSn, J.S. and Wolf, K.B., eds (1986). Lie Methods in Optics (Springer, Berlin). 
Morito, N. (1954). J. Appl. Phys. 25, 986-993. 
Morito, N. (1955). Hitachi Hyoron 37, 817-822. 
Morito, N. (1957). J. Electronmicrosc. 5, 1-2. 
Moses, R.W. (1966). Rev. Sci. Instrum. 37, 1370-1372. 
Moses, R.W. (1970). Rev. Sci. Instrum. 41,729-740. 
Moses, R.W. (1971a). Rev. Sci. Instrum. 42, 828-831. 
Moses, R.W. (1971b). Rev. Sci. Instrum. 42, 832-839. 
Moses, R.W. (1971c). EMAG, pp. 88-89. 
Moses, R.W. (1972). Manchester, pp. 86-87. 
Moses, R.W. (1973). In Image Processing and Computer-aided Design in Electron Optics 
(Hawkes, P.W., ed.) pp. 250-272 (Academic Press, London and New York). 
Moses, R.W. (1974). Proc. Roy. Soc. (London) A339, 483-512. 
Mulvey, T. and Jacob, L. (1949). Nature 163, 525-526. 
Munro, E. (1970). Grenoble, vol. 2, pp. 55-56. 
Munro, E. (1971). EMAG, pp. 84-87. 
Munro, E. (1972). Manchester, pp. 22-23. 
Munro, E. (1973). In Image Processing and Computer-aided Design in Electron Optics 
(Hawkes, P.W., ed.) pp. 284-323 (Academic Press, London and New York). 
Munro, E. (1988). J. Vac. Sci. Technol. B6, 941-948. 
Nesvizhskii, M.B. (1986). Radiotekh. Elektron. 31,162-168; Sov. J. Commun. Technol. 
Electron. 31, No. 5, 153-160. 
Ng, E.W., ed. (1979). Symbolic and Algebraic Computing. Lecture Notes in Computer 
Science, vol. 72 (Springer, Berlin and New York). 
Orloff, J. (1983a). Optik 63, 369-372. 
Orloff, J. (1983b). Optik 65, 369-371. 
Ovsyannikova, L.P. and Yavor, S.Ya (1965). Zh. Tekh. Fiz. 35, 940-946; Soy. Phys. 
Tech. Phys. 10, 723-726. 
Petrie, D.P.R. (1962). Philadelphia, vol. 1, KK-2. 
Plass, G.N. (1942). J. Appl. Phys. 13, 49-55 and 524. 
Rabin, B.M., Strashkevich, A.M. and Khin, L.S. (1951). Zh. Tekh. Fiz. 21,438-444. 
Ramberg, E.G. (1939). J. Opt. Soc. Am. 29, 79-83. 
Rang, O. (1948). Optik 4, 251-257. 
Rang, O. (1949a). Optik 5, 518-530. 

PART IV, CHAPTERS 21-31 
613 
Rang, O. (1949b). Phys. B1. 5, 78-80. 
Rauh, H. (1971). Z. Naturforsch. 26a, 1667-1675. 
Read, F.H., Adams, A. and Soto-Montiel, J.R. (1971). J. Phys. E: Sci. Instrum. 4, 
625-632. 
Rebsch, R. (1938). Ann. Physik (Leipzig) 31,551-560. 
Rebsch, R. (1940). Z. Physik 116, 729-733. 
Rebsch, R. and Schneider, W. (1937). Z. Physik 107, 138-143. 
Recknagel, A. (1941). Z. Physik 117, 67-73. 
Recknagel, A. and Haufe, G. (1952/3). Wiss. Z. Techn. Hochschule Dresden 2, 1-10. 
Regenstreif, E. (1951a). Ann. Radio~l. 6, 244-267 and 299-317. 
Regenstreif, E. (1951b). C.R. Acad. Sci. Paris 232, 1918-1920 and 233,854-856. 
Reisner, J.H. (1970). EMSA 28, pp. 350-351. 
Reisner, J.H. and Schuler, J.J. (1967). EMSA, pp. 226-227. 
Renau, A. and Heddle, D.W.O. (1986). J. Phys. E: Sci. Instrum. 19, 284-288 and 
288-295. 
Renau, A. and Heddle, D.W.O. (1987). J. Phys. E: Sci. Instrum. 20,235-236. 
Rheinfurth, M. (1955). Optik 12,411-416. 
Riecke, W.D. (1958). Berlin, vol. 1, pp. 189-194. 
Riecke, W.D. (1964). Prague, vol. A, pp. 7-8. 
Riecke, W.D. (1966/7). Optik 24, 397-426. 
Riecke, W.D. (1972). Optik 36, 66-84, 288-308 and 375-398. 
Riecke, W.D. (1976). Instrument operation for microscopy and microdiffraction. 
In 
Electron Microscopy in Materials Science (Valdr~, U. and Ruedl, E., eds) pp. 
19-111 (CEE, Luxembourg). 
Riecke, W.D. (1982). In Magnetic Electron Lenses (Hawkes, P.W., ed.) pp. 163-357 
(Springer, Berlin and New York). 
Riedl, H. (1937). Z. Physik 107, 210-216. 
Rogowski, W. (1937). Arch. Elektrotech. 31,555-593. 
Rose, H. (1967). Optik 25, 587-597. 
Rose, H. (1967/8). Optik 26, 289-298. 
Rose, H. (1968). Optik 27, 466-474 and 497-514. 
Rose, H. (1968/69). Optik 28,462-474. 
Rose, H. (1971a). Optik 33, 1-24. 
Rose, H. (1971b). Optik 34, 285-311. 
Rose, H. (1987). Nucl. Instrum. Meth. A258, 374-401. 
Rose, H. and Moses, R.W. (1973). Optik 37, 316-336. 

614 
NOTES AND REFERENCES 
Rose, It. and Petri, U. (1971). Optik 33, 151-165. 
Sakaki, Y. and Maruse, S. (1954). J. Electronmicrosc. 2, 8-9. 
Scherzer, O. (1933). Z. Physik 80, 193-202. 
Scherzer, O. (1936a). Z. Physik 101, 23-26. 
Scherzer, O. (1936b). Z. Physik 101,593-603. 
Scherzer, O. (1937). Berechnung der Bildfehler dritter Ordnung nach der Bahnmethode. 
In Beitr~ge zur Elektronenoptik (Busch, It. and Briiche, E., eds) pp. 33-41 (Barth, 
Leipzig). 
Scherzer, O. (1941). Z. Physik 118,461-466. 
Scherzer, O. (1946). Phys. B1. 2, 110. 
Scherzer, O. (1947). Optik 2, 114-132. 
Schiske, P. (1956). Optik 13,502-505. 
Schriber, S.O. and Taylor, L.S., eds (1987). Proc. 2nd Int. Conf. Charged Particle Optics, 
Nucl. Instrum. Meth. Phys. Res. A258, 289-598 (North-Holland, Amsterdam). 
Seman, O.I. (1951). Dokl. Akad. Nauk SSSR 81,775-778. 
Seman, O.I. (1953a). Zh. Eksp. Tekh. Fiz. 24, 581-588. 
Seman, O.I. (1953b). Dokl. Akad. Nauk SSSR 93,443-445. 
Seman, O.I. (1954). Dokl. Akad. Nauk SSSR 96, 1151-1154. 
Seman, O.I. (1955a). Trudy Inst. Fiz. Astron. Akad. Nauk Eston. SSR, No. 2, 3-29. 
Seman, O.I. (1955b). Trudy Inst. Fiz. Astron. Acad. Nauk Eston. SSR, No. 2, 30-49. 
Seman, O.I. (1958a). Uch. Zap. Rostov. Gos. Univ. 68, No. 8, 63-75. 
Seman, O.I. (1958b). Uch. Zap. Rostov. Gos. Univ. 68, No. 8, 77-90. 
Seman, O.I. (1958c). Radiotekh. Elektron. 3,283-287; Radio Eng. Electron. 3,402-409. 
Seman, O.I. (1959a). Radiotekh. Elektron. 4, 1213-1214; Radio Eng. Electron. 4, No. 7, 
227-230. 
Seman, O.I. (1959b). Radiotekh. Elektron. 4, 1702-1707; Radio Eng. Electron. 4, 
No. 10, 235-244. 
Seman, O.I. (1959c). Opt. Spektrosk. 7, 113-115; Opt. Spectrosc. 7, 68-69. 
Seman, O.I. (1968). Radiotekh. Elektron. 13, 907-912; Radio Eng. Electron. Phys. 13, 
784-788. 
Septier, A. (1963). C.R. Acad. Sci. Paris 256, 2325-2328. 
Septier, A. (1966). The struggle to overcome spherical aberration in the electron micro- 
scope. Adv. Opt. Electron Microsc. 1,204-274. 
Shao, Z. (1987a). Optik 75, 152-157. 
Shao, Z. (1987b). EMSA 45, pp. 134-135. 
Shao, Z. and Crewe, A.V. (1987). J. Appl. Phys. 62, 1149-1153. 

PART IV, CHAPTERS 21-31 
615 
Shi, C.-h. (1956). Acta Sci. Nat. Univ. Pekin 2,457-465. 
Shimoyama, H. (1982). J. Electron Microsc. 31, 8-17. 
Shpak, E.V. and Yavor, S.Ya. (1964). Zh. Tekh. Fiz. 34, 2003-2007; Sov. Phys. Tech. 
Phys. 9, 1540-1543. 
Shpak, E.V. and Yavor, S.Ya. (1965). Zh. Tekh. Fiz. 35, 947-950; Sov. Phys. Tech. 
Phys. 10, 727-729. 
Shtepa, N.I. (1952). Zh. Tekh. Fiz. 22, 216-226. 
Siegbahn, K. (1946). Phil. Mag. 37, 162-184. 
Sivkov, Yu.P. (1971). Particle Acc. 2, 243-249. 
Smirnov, N.A., Monastyrskii, M.A. and Kulikov, Yu.V. (1979). Zh. Tekh. Fiz. 49, 
2590-2595; Sov. Phys. Tech. Phys. 24, 1462-1465. 
Smith, T. (1921/22). Trans. Opt. Soc. (London)23,311-322. 
Soma, T. (1977). Optik 49,255-262. 
Sorokina, V.V. and Timofeev, P.V. (1948). Zh. Tekh. Fiz. 18,509-516. 
Steffen, K.G. (1965). High Energy Beam Optics (Wiley-Interscience, New York and 
London). 
Stephan, W.G. (1947). Praclische Toepassingen op her Gebied der Al~ebrai'sche Oplica. 
Proefschrift, Delft. 
Stoyanov, P.A. (1955a). Zh. Tekh. Fiz. 25,625-635. 
Stoyanov, P.A. (1955b). Zh. Tekh. Fiz. 25, 2537-2541. 
Stoyanov, P.A. (1958a). Berlin, vol. 1, pp. 61-66. 
Strashkevich, A.M. (1959). Elektronnaya Optika Eleklroslaticheskikh Polei ne obla- 
dayushchikh Osevoi Simmetriei (Gos. Izd. Fiz-Mat. Lit., Moscow). 
Strashkevich, A.M. (1965). Zh. Tekh. Fiz. 35, 177-183; Soy. Phys. Tech. Phys. 10, 
147-151. 
Strashkevich, A.M. (1966). Elektronnaya Optika Elektrostaticheskikh Sislem (Energiya, 
Moscow). 
Strashkevich, A.M. and Gluzman, N.G. (1954). Zh. Tekh. Fiz. 24, 2271-2284. 
Strashkevich, A.M. and Pilat, I.M. (1951). Izv. Akad. Nauk SSSR (Ser. Fiz.) 15, 
448-466. 
Strashkevich, A.M. and Pilat, I.M. (1952). Uchen. Zap. Chernovitskii Gos. Univ. (Ser. 
Fiz-Mat. Nauk) 4, 113-122. 
Sturrock, P.A. (1949). Delft, 89-93. 
Sturrock, P.A. (1951a). Proc. Roy. Soc. (London)A210, 269-289. 
Sturrock, P.A. (19515). Phil. Trans. Roy. Soc. (London) A243, 387-429. 
Sturrock, P.A. (1951c). C.R. Acad. Sci. Paris 233, 146-147 and 243-245. 

616 
NOTES AND REFERENCES 
Sturrock, P.A. (1952). Phil. Trans. Roy. Soc. (London) A245, 155-187. 
Sturrock, P.A. (1955). Static and Dynamic Electron Optics (University Press, Cam- 
bridge). 
Sugiura, Y. and Suzuki, S. (1943). Proc. Imp. Acad. Japan 19, 293-302. 
Suzuki, S. and Ishikawa, A. (1978). Toronto, vol. 1, pp. 24-25. 
Tadano, B., Kimura, H. and Onuma, Y. (1966). Hitachi Rev. 15,340-344. 
Taganov, I.N. (1966). Radiotekh. Elektron 11, 1329-1330; Radio Eng. Electron Phys. 
11, 1160-1162. 
Taganov, I.N. and Kas'yankov, P.P. (1964). Opt.-Mekh. Prom. 31, No. 11, 14-16. 
Taganov, I.N. and Kas'yankov, P.P. (1965). Opt.-Mekh. Prom. 32, No. 12, 21-23. 
Taganov, I.N. and Kas'yankov, P.P. (1967). In Chislennye Metody Rascheta Elektronno- 
Opticheskikh Sistem (Marchuk, G.I., ed.) pp. 11-22 (Nauka, Novosibirsk). 
Tretner, W. (1950). Optik 7, 242. 
Tretner, W. (1954). Optik 11,312-326; errata ibid. 12,293-294 (1955). 
Tretner, W. (1956). Optik 13, 516-519. 
Tretner, W. (1959). Optik 16, 155-184. 
Tsuno, K. and Harada, Y. (1981a). J. Phys. E: Sci. Instrum. 14, 313-319. 
Tsuno, K. and Harada, Y. (1981b). J. Phys. E: Sci. Instrum. 14, 955-960. 
Tsuno, K., Ishida, Y. and Harada, Y. (1980a). EMSA, pp. 280-281. 
Tsuno, K., Arai, Y. and Harada, Y. (1980b). The Hague, vol. 1, pp. 76-77. 
U, M.-zh. [Wu, M.-z.] (1957). Sci. Sin. 6,833-846; Acta Phys. Sin. 13, 181-206. 
Vandakurov, Yu.V. (1955a). Zh. Tekh. Fiz. 25, 1412-1425. 
Vandakurov, Yu.V. (1955b). Zh. Tekh. Fiz. 25, 2545-2555. 
Vandakurov, Yu.V. (1956a). Zh. Tekh. Fiz. 26, 1599-1610; Sov. Phys. Tech. Phys. 1, 
1558-1569. 
Vandakurov, Yu.V. (1956b). Zh. Tekh. Fiz. 26, 2578-2594; Sov. Phys. Tech. Phys. 1, 
2491-2507. 
Vandakurov, Yu.V. (1957). Zh. Tekh. Fiz. 27, 1850-1862; Sov. Phys. Tech. Phys. 2, 
1719-1733. 
Velzel, C.H.F. (1987). J. Opt. Soc. Am. A4, 1342-1348. 
Velzel, C.H.F. and Meijere, J.L.F. de (1988). J. Opt. Soc. Am. AS, 246-250 and 
251-256. 
Verster, J.L. (1963). Philips Res. Repts 18,465-605. 
Vlasov, A.G. (1944). Izv. Akad. Nauk SSSR (Set. Fiz.) 8,235-239. 
Vlasov, A.G. and Shakhmatova, I.P. (1962). Zh. Tekh. Fiz. 32, 695-705; Sov. Phys. 
Tech. Phys. 7, 507-514. 

PART V, CHAPTER 32 
617 
Voit, H. (1939). Z. Instrumentenkde 59, 71-82. 
Watanabe, A. and Morito, N. (1955). Optik 12, 166-172 and 564. 
Watanabe, M. and Someya, T. (1963). Optik 20, 99-108. 
Wegmann, L. (1953). Helv. Phys. Acta 26,448-449. 
Wegmann, L. (1954). Optik 11, 153-170. 
Wollnik, H., ed. (1981). Proc. 1st Conf. Charged Particle Optics. Nucl. Instrum. Meth. 
Phys. Res. 187, 314pp. 
Wollnik, H. (1987). Optics of Charged Particles (Academic Press, Orlando and London). 
Wollnik, H. and Berz, M. (1985). Nucl. Instrum. Meth. Phys. Res. A238, 127-140. 
Ximen, J.-y. (1957). Acta Phys. Sin. 13, 339-356. 
Ximen, J.-y. and Chen Q.-s. (1964). Acta Electron. Sin. No. 4, 72-84. 
Ximen, J.-y. and Xi Z.-h. (1964). Acta Electron. Sin. No. 3, 24-35. 
Ximen, J.-y., Zhou, L.-w. and Ai, K.-c. (1983). Optik 66, 19-34. 
Yanaka, T. and Shirota, K. (1970). Grenoble, vol. 2, pp. 59-60. 
Yavor, S.Ya. (1968). Fokusirovka Zaryazhennykh Chastits Kvadrupol'nymi Linzami (At- 
omizdat, Moscow). 
Yavor, S.Ya., Dymnikov, A.D. and Ovsyannikova, L.P. (1964). Zh. Tekh. Fiz. 24, 
99-104; Sov. Phys. Tech. Phys. 9, 76-80. 
Zhou, L.-w., Ai, K.-c. and Pan, S.-c. (1983). Acta Phys. Sin. 32, 376-392. 
Zworykin, V.K., Morton, G.A., Ramberg, E.G., Hillier, J. and Vance, A.W. (1945). 
Electron Optics and the Electron Microscope (Wiley, New York and Chapman and 
Hall, London). 
Part V, Chapter 32 
We draw attention to the survey by Ritz (1979), to the earlier papers on 
deflection aberrations by Griimm and Spumy (1956), Werner (1963), Hut- 
ter (1967) and Schiirmann and Haussmann (1967) and to other work by 
Munro (1975, 1980), Soma (1979) and Tsunagari et al. (1986), who con- 
sider parasitic aberrations. Papers on this subject frequently appear in the 
proceedings of the Electron, Ion and Laser Beam Technology conferences, 
published in g. Vac.Sci. Technol. and in those of the Microcircuit Engineering 
meetings now published in Microelectronic Engineering. 
Amboss, K. and Wolf, E.D. (1971). In Rec. 11th Symp. Electron Ion Laser Beam Technol. 
(Thornley, R.F.M., ed.) pp. 195-204 (San Francisco Press, San Francisco). 
Chu, H.C. and Munro, E. (1981). J. Vac. Sci. Technol. 19, 1054-1057. 
Chu, H.C. and Munro, E. (1982a). Optik 61, 121-145. 

618 
NOTES AND REFERENCES 
Chu, H.C. and Munro, E. (1982b). Optik 61,213-236. 
Crewe, A.V. and Parker, N.W. (1976). Optik 46, 183-194. 
Ding, S.Q. (1982). Hamburg, vol. 1, pp. 315-316. 
Dodin, A.L. (1983). Radiotekh. Elektron. 28, 357-361; Radio Eng. Electron. Phys. 28, 
No. 2, 114-118. 
Glaser, W. (1938). Z. Physik 111,357-372. 
Glaser, W. (1941). Z. Physik 117, 412. 
Glaser, W. (1949). Ann. Physik (Leipzig) 4, 389-408. 
Glaser, W. (1952). Grundlagen der Elektronenoptik (Springer, Vienna). 
Glaser, W. (1956). Elektronen- und Ionenoptik. In Handbuch der Physik 33, 123-395. 
Goto, E. and Soma, T. (1977). Optik 48, 255-270. 
Griimm, H. and Spumy, H. (1956). (~st. Ing.-Arch. 10, 104-106. 
Haantjes, J. and Lubben, G.J. (1957). Philips Tech. Repts 12, 46-68. 
Haantjes, J. and Lubben, G.J. (1959). Philips Res. Repts 14, 65-97. 
Hawkes, P.W. (1988). Optik, to be published. 
Hosokawa, T. (1980). Optik 56, 21-30. 
Hutter, R.G.E. (1947). J. Appl. Phys. 18, 740-758. 
Hutter, R.G.E. (1948). Adv. Electron. 1,167-218. 
Hutter, R.G.E. (1967). IEEE. Trans. ED-14, 694-699. 
Kaashoek, J. (1968). Philips Res. Repts Suppl. No. 11, 114 pp. 
Kanaya, K. and Kawakatsu, H. (1961a). Bull. Electrotech. Lab. 25, 241-252. 
Kanaya, K. and Kawakatsu, H. (1961b). J. Electronmicrosc. 10, 218-221. 
Kanaya, K. and Kawakatsu, H. (1962). Bull. Electrotech. Lab. 26, 241-250. 
Kanaya, K., Kawakatsu, H. and Tanaka, K. (1961). Bull. Electrotech. Lab. 25,481-494. 
Kanaya, K., Kawakatsu, H., Okazaki, I. and Takizawa, T. (1963). Bull. Electrotech. 
Lab. 27, 401-417. 
Kanaya, K., Kawakatsu, H., Okazaki, I. and Takizawa, T. (1964). J. Electronmicrosc. 
13, 8O-86. 
Kawakatsu, H. and Kanaya, K. (1961). J. Electronmicrosc. 10, 119-124. 
Kern, D.P. (1979). J. Vac. Sci. Technol. 16, 1686-1691. 
Knauer, W. (1981). J. Vac. Sci. Technol. 19, 1042-1047. 
Koops, H. (1972). Optik 36, 93-110. 
Koops, H. (1973). J. Vac. Sci. Technol. 10,909-912. 
Koops, H. and Bernhard, W. (1975). J. Vac. Sci. Technol. 12, 1141-1145, 
Kuroda, K. (1980). Optik 57, 251-258. 

PART V, CHAPTER 32 
619 
Lenc, M. and Lencov£, B. (1988). Optik 78, 127-131. 
Lencov£, B. (1981). Optik 58, 25-35. 
Lencov~i, B. (1988). Optik 79, 1-12. 
Li, Y. (1981). Acta Phys. Sin. 30, 1155-1164. 
Li, Y. (1983). Optik 63,213-216. 
Li, Y. and Ximen, J.-y. (1982a). Optik 61,315-332. 
Li, Y. and Ximen, J.-y. (1982b). Acta Phys. Sin. 31,604-614. 
Munro, E. (1974). Optik 39, 450-466. 
Munro, E. (1975). J. Vac. Sci. Technol. 12, 1146-1150. 
Munro, E. (1980). In Microcircuit Engineering (Ahmed, H. and Nixon, W.C., eds) pp. 
513-534 (University Press, Cambridge). 
Munro, E. and Chu, H.C. (1982a). Optik 60, 371-390. 
Munro, E. and Chu, H.C. (1982b). Optik 61, 1-16. 
Ohiwa, H. (1970). Elimination of Third Order Aberrations in Electron Beam Scanning 
Systems. Thesis, Tokyo. 
Ohiwa, H. (1978). J. Vac. Sci. Technol. 15, 849-852. 
Ohiwa, H. (1979). Optik 53, 63-68. 
Ohiwa, H., Goto, E. and Ono, A. (1971). Trans. Inst. Electron. Commun. Eng. Japan 
54-B, 730-737; Electron. Commun. Japan 54-B, No. 12, 44-51. 
Owen, G. (1981). J. Vac. Sci. Technol. 19, 1064-1068. 
Owen, G. and Nixon, W.C. (1973). J. Vac. Sci. Technol. 10,983-986. 
Picht, J. (1943). Ann. Physik (Leipzig) 43, 53-72. 
Picht, J. and Himpan (1941). Ann. Physik (Leipzig) 39,409-435,436-477 and 478-501. 
Plies, E. (1982). Siemens Forsch. Entwickl. Ber. 11, 38-45 and 83-90. 
Rao, V.R.M. and Nixon, W.C. (1981). J. Vac. Sci. Technol. 19, 1037-1041. 
Ritz, E.F. (1979). Adv. Electron. Electron Phys. 59,299-357. 
Schiirmann, J. and Haussmann, G. (1967). Z. Angew. Phys. 22,235-239. 
Smith, M.R. and Munro, E. (1986). Optik 74, 7-16. 
Smith, M.R. and Munro, E. (1987). J. Vac. Sci. Technol. B5, 161-164. 
Soma, T. (1977). Optik 49,255-262. 
Soma, T. (1979). Optik 53, 281-284. 
Tang, T.T. (1986). Optik 74, 43-47. 
Wang, C.C.T. (1966). J. Appl. Phys. 37, 5007-5008. 
Wang, C.C.T. (1967a). J. Appl. Phys. 38, 3991-3994. 
Wang, C.C.T. (1967b). J. Appl. Phys. 38, 4938-4944. 

620 
NOTES AND REFERENCES 
Wang, C.C.T. (1967c). IEEE Trans. ED-14, 357-365. 
Wang, C.C.T. (1971). IEEE Trans. ED-18, 258-274. 
Wendt, G. (1939). TelefunkenrShre 15, 100-136. 
Wendt, G. (1942a). Z. Physik 118, 593-517. 
Wendt, G. (1942b). Z. Physik 119,423-462. 
Wendt, G. (1947). Ann. Physik (Leipzig) 1, 83-94. 
Wendt, G. (1953). Onde Elec. 33, 93-106. 
Werner, H. (1963). Exp. Tech. Phys. 11, 32-50. 
Ximen, J.-y. (1977). Acta Phys. Sin. 26, 34-53. 
Ximen, J.-y. (1978). Acta Phys. Sin. 27, 247-259. 
Ximen, J.-y. (1981). Optik 59, 237-249; Chinese J. Sci. Instrum. 2, 1-11. 
Ximen, J.-y. (1986). Aberration Theory in Electron and Ion Optics. Adv. Electron. 
Electron Phys. Suppl. 17. 
Ximen, J.-y. and Li, Y. (1982). Optik 62, 287-297. 
Part VI, Chapters 33 and 34 
For some further development in numerical methods, see Munro (1987) and 
Str6er (1987). An early attempt to assess the combined effect of aberrations 
of different kinds is to found in Harte (1973). The use of a Russian com- 
puter algebra language (ANALITIK) for deriving aberration coefficients is 
described by Narylkov and Lyubchik (1982). 
Barton, D. and Fitch, J.P. (1972). Repts Prog. Phys. 35,235-314. 
Berz, M. and Wollnik, H. (1987). Nucl. Instrum. Meth. Phys. Res. A258, 364-373. 
Buchberger, B., Collins, G.E., Loos, R. and Albrecht, R., eds (1982). Computer Algebra, 
Symbolic and Algebraic Computation. Computing, Suppl. 4 (Springer, Vienna 
and New York). 
Burfoot, J. (1952). Brit. J. Appl. Phys. 3, 22-24. 
Busch, H. (1927). Arch. Elektrotech. 18, 583-594. 
Calmet, J. (1982). Computer Algebra. Lecture Notes in Computer Science 144 (Springer, 
Berlin and New York). 
Chu, H.C. and Munro, E. (1982). Optik 61,121-145 and 213-236. 
Crewe, A.V., Eggenberger, D.N., Wall, J. and Welter, L.M. (1968). Rev. Sci. Instrum. 
39, 576-583. 
Davenport, J.H., Siret, Y. and Tournier, E. (1988). Computer Algebra (Academic Press, 
London and San Diego). 

PART VI, CHAPTERS 33 AND 34 
621 
Dodin, A.L. and Nesvizhskii, M.B. (1981). Radiotekh. Elektron. 26, 2651-2657; Radio 
Eng. Electron Phys. 26, No. 12, 151-157. 
Fitch, J.P. (1985). J. Symbol. Comput. 1,211-227. 
Fox, L. and Goodwin, E.T. (1949). Proc. Cambridge Philos. Soc. 45,373-388. 
Gill, S. (1951). Proc. Cambridge Philos. Soc. 47, 96-108. 
Glaser, W. (1933). Ann. Physik (Leipzig) 18, 557-585. 
Glaser, W. (1935). Z. Physik 97, 177-201. 
Glaser, W. (1952). Grundlagen der Elektronenoptik (Springer, Vienna). 
Harte, K.J. (1973). J. Vac. Sci. Technol. 10, 1098-1101. 
Hauke, R. (1977). 
Theoretische Untersuchungen rotationssymmetrischer Elektronen- 
strahlerzeugungssysteme unter Beriicksichtigung yon Raumladung. Dissertation, 
Tiibingen. 
Hawkes, P.W. (1977). Optik 48, 29-51. 
Hawkes, P.W. (1983). Optik 63, 129-156 and 65,227-251. 
Hearn, A.C. (1985) REDUCE User's Manual (Rand, Santa Monica). 
Hoch, H., Kasper, E. and Kern, D. (1976). Optik 46, 463-473. 
Householder, A.S. (1964). The Theory of Matrices in Numerical Analysis (Blaisdell, New 
York). 
Hulzen, J.A. van and Calmet, J. (1982). Computing, Suppl. 4, 221-243. 
Jacobs, D., ed. (1977). The State of the Art in Numerical Analysis (Academic Press, 
London and New York). 
Jennings, J.C.E. and Pratt, R.G. (1955). Proc. Phys. Soc. (London) B68,526-536. 
Kasper, E. (1982). 
In Magnetic Electron Lenses (Hawkes, P.W., ed.) 
pp. 57-118 
(Springer, Berlin and New York). 
Kasper, E. (1984). In Electron Optical Systems for Microscopy, Microanalysis and Mi- 
crolithography (Hren, J.J., Lenz, F.A., Munro, E. and Sewell, P.B., eds) pp. 63-73 
(Scanning Electron Microscopy, AMF O'Hare). 
Kasper, E. (1985). Optik 69, 117-125. 
Kasper, E. (1987a). Nucl. Instrum. Meth. Phys. Res. A258, 466-479. 
Kasper, E. (1987b). Optik 77, 3-12. 
Kern, D. (1978). Theoretische Untersuchungen an rotationssymmetrischen Strahlerzeu- 
gungssystemen mit Feldemissionsquelle. Dissertation, Tiibingen. 
Lawson, C.L. and Hanson, R.J. (1974). Solving Least-Squares Problems (Prentice-Hall, 
Englewood Cliffs, NJ). 
Levenberg, K. (1944). Quart. Appl. Math. 2, 164-168. 
Manning, W.F. and Millman, J. (1938). Phys. Rev. 53, 673. 

622 
NOTES AND REFERENCES 
MIT (1983). The MA CSYMA Reference Manual (Massachusetts Institute of Technology, 
Cambridge). 
Moses, R.W. (1973). In Image Processing and Computer-aided Design in Electron Optics 
(Hawkes, P.W., ed.) pp. 250-272 (Academic Press, London and New York). 
Munro, E. (1973). In Image Processing and Computer-aided Design in Electron Optics 
(Hawkes, P.W., ed.) pp. 284-323 (Academic Press, London and New York). 
Munro, E. (1987). Nucl. Instrum. Meth. Phys. Res. A258, 443-461. 
Munro, E. and Chu, tt.C. (1982). Optik 60, 371-390 and 61, 1-16. 
Narylkov, S.C. and Lyubchik, Ya.G. (1982). Radiotekh. Elektron. 27, 1602-1605 (not 
translated). 
Nesvizhskii, M.B. (1986). Radiotekh. Elektron. 31, 162-168; Radio Eng. Electron. 
Phys. 31, No. 1,153-160. 
Ng, E.W., ed. (1979). Symbolic and Algebraic Computation. Lecture Notes in Computer 
Science 72 (Springer, Berlin and New York). 
Niemitz, H.P. (1980). Theoretische Untersuchung yon elektrostatischen Drei-Elektroden- 
Filterlinsen. Dissertation, Tiibingen. 
Norman, A.C. (1982). In Computer Algebra (Calmet, J., ed.) pp. 237-248 (Springer, 
Berlin and New York). 
Norman, A.C. and Davenport, J.H. (1979). In Symbolic and Algebraic Computation (Ng, 
E.W., ed.) pp. 398-407 (Springer, Berlin and New York). 
Numerov, B. (1923). Publ. Obs. Astrophys. Central Russie 2, 188-288. 
Pavelle, R., ed. (1985). Applications of Computer Algebra (Kluwer, Dordrecht). 
Pavelle, R., Rothstein, M. and Fitch, J. (1981). Sci. Am. 245, No. 6, 136-152. 
Ralston, A. (1960). In Mathematical Methods for Digital Computers (Ralston, A. and 
Wilf, H.S., eds) col. 1, pp. 95-109 (Wiley, New York). 
Rand, R.H. (1984). Computer Algebra in Applied Mathematics: an Introduction to MA C- 
SYMA (Pitman, Boston and London). 
Rand, R.H. and Armbruster, D. (1987). Perturbation Methods, Bifurcation Theory and 
Computer Algebra (Springer, New York and Berlin). 
aayna, G. (1987). REDUCE (Springer, New York and Berlin). 
Romanelli, M.J. (1960). In Mathematical Methods for Digital Computers (Ralston, A. 
and Wilf, H.S., eds) col. 1, pp. 110-120 (Wiley, New York). 
Scherle, W. (1983). Optik 63, 217-226. 
Scherle, W. (1984). Optik 67, 307-314. 
Scherzer, O. (1936). In Beitr~'ge zur Elektronenoptik (Busch, H. and Briiche, E., eds) pp. 
33-41 (Barth, Leipzig). 
Soma, T. (1977). Optik 49, 255-262. 

PART VI, CHAPTERS 33 AND 34 
623 
Stoer, J. (1979). Einfiihrung in die Numerische Malhematik, vol. I (Heidelberger 
Taschenbficher 105, Springer, Berlin and New York). 
StSrmer, C. (1907). Arch. Math. Naturvid. 28, No. 2. 
StrSer, M. (1987). Optik 77, 15-25. 
Szilagyi, M. (1977). Optik 48, 215-224. 
Szilagyi, M. (1984). In Electron Optical Systems for Microscopy, Microanalysis and 
Microlithography (Hren, J.J., Lenz, F.A., Munro, E. and Sewell, P.B., eds) pp. 
75-84 (Scanning Electron Microscopy, AMF O'Hare). 
Whittaker, E.T. and Watson, G.N. (1950). A Course of Modern Analysis, 4th ed. (Uni- 
versity Press, Cambridge). 

This Page Intentionally Left Blank

Index 

This Page Intentionally Left Blank

I
N
D
E
X
 
Abbe sine condition 219 
aberrations of foil lenses 680 
aberration correction 
11, 365, 857- 
aberrations of gradient 419,442 
878 
aberration disc 
- integral properties 555 
- numerical determination 
547- 
558 
- prisms 
1077 
aberration integrals 
534 
- for deflection systems 511 
aberration matrices 301,418-424 
aberration minimization 301,877 
- and deflection 508 
aberrations of microwave cavity len- 
ses 876 
aberrations of mirrors and cathode 
lenses 425-433 
- cartesian form 432 
- parametric form 425 
- structure 430 
aberrations of quadrupoles and octo- 
poles 
434-465 
- quadruplets 
461 
aberration polynomials 
12, 300, 396 
aberrations of round lenses 339-424 
aberration studies 
- historical development of 8, 11, 
299 
aberration theory 
- for curvilinear systems 
1053 
aberrations and system symmetry 
- exceptions 322 
-for N=2 
325 
-for N= 3 329 
-for N=4 
330 
-for N=5and6 
333 
- general case 315 
- rotational symmetry 334 
- with a symmetry plane 324 
aberrations 
- and Seman's technique 356,386 
- in reduced coordinates 
384 
aberrations, parasitic 470-479 
- numerical determination 475 
- isoplanatic approximation 
477 
acceleration potential 
19, 21 
accelerators, optics of 647 
acceptance 994 
achromatic quadrupoles 461,862 
addition rules for aberrations 
- round lenses 420 
- quadrupoles 464 
alpha filter 
1095, 1099 
alternating 
direction 
implicit 
me- 
thods 
173 
- 
differential equations for 
537- 
alternating gradient focusing 
1062 
542 
analytic continuation 
79 
- 
Fourier analysis of 550 
analytic function 
70 
aberrations 
of 
cyhndrical 
lenses analytical 
electron 
microscopy 
466-469 
(AEM) 
10 
aberrations 
of 
deflection 
systems anamorphoticsystems 
802 
497-516 
angle characteristic 237 

INDEX 
angular emission distribution 924 
angular magnification 217 
anisotropic aberrations 
- 
astigmatism 370 
- 
chromatic distortion 414 
- 
coma 366 
- 
distortion 379 
anisotropic magnetic circuit 181 
annular systems 894,895,897 
anode 908 
antisymmetric multiplets 286, 805 
aperture aberrations 337, 350 
-of quadrupoles and octopoles 
439, 440, 453 
- 
sign of 458 
aperture field 143, 193 
aperture 
-of quadrupoles and octopoles 
440 
aperture-lenses 631 
apertures, 
influence on brightness 
977 
Archard-Deltrap corrector 861 
arc lenses 810 
astigmatic difference for quadrupoles 
281 
astigmatic objects and images 280 
astigmatic tube lenses 813 
astigmatism 337, 520 
- axial 470, 474 
-of quadrupoles and octopoles 
439, 441 
- 
addition rules for 420 
astigmatism of round lenses, real 
349, 369-378 
- 
aberration figure 369 
- 
and aperture position 383 
- 
circle of least confusion 374 
- formulae for 376, 385 
- 
thin-lens formula 378 
asymptotes 226, 239 
asymptotic aberration coefficients 
- of magnetic lenses 705 
- of quadrupoles and octopoles 
434, 458 
- 
of round lenses 393-408 
- 
integrals 399 
asymptotic, aberrations 
- dependence on object and aper- 
ture position 406, 424 
- integrals for the bell-shaped mo- 
del 701 
asymptotic cardinal elements 
226, 
233 
- focal length 228 
- 
image focus 228, 244 
- object focus 228 
- of magnetic lenses 698 
- of mirrors 270 
- principal plane 228 
asymptotic image formation 225 
asymptotic object 225 
asymptotic properties of thermionic 
guns 957 
average brightness 971 
astigmatism of round lenses, asym- axial angular momentum 24, 30, 38, 
ptotic 397 
44, 210 
- 
and pupil magnification 407 
axial astigmatism 470, 474 

INDEX 
iii 
axial conductors 
870 
axial fields or potentials, optimiza- 
tion 561 
boundary-element method 
125-158, 
944 
boundary-value problem 61, 94-106 
axial focusing (prisms) 
1068 
axial harmonic 
79, 80, 82, 836 
azimuthal Fourier series expansion 
73 
- 
and finite-difference method 
170 
- electrostatic fields 94 
- for paraxial trajectories 535 
Barber's rule 
1065 
barrel distortion 
379 
basis-curve 881,887 
beam choppers 
876 
beam entropy 
1011 
beam matching 994 
beam temperature 
1007 
- longitudinal 
1008 
- transverse 1007 
beam transport systems 917 
beam-shaping techniques 848, 850 
bell-shaped models 253, 706, 801 
beta-ray spectrometers 
365, 
685, 
897 
binormal 
1041 
Biot-Savart law 98, 829 
biplanar lenses 811 
blade focus 
895 
Boersch effect 917, 1004-1016, 1036 
- analytical calculations 
1013 
- 
dimensional analysis 
1016 
-energetic Boersch effect 
1004 
- general theory 94 
- magnetic fields 
101 
BR-product 
28 
brightness 917, 971-988 
- and emittance 996 
- influence of apertures 
977 
- Lenz's theory 980 
- maximum brightness 
975 
- measurement 
985 
- of field emission guns 
1021 
- of thermionic guns 
1030 
brightness function 
971 
- generalized 972 
brightness measurement 
- lens method 
986 
- two-aperture method 
986 
Busch 
- and lens action 6 
- focal length formula 
259, 472, 
521 
calculation of aberration coefficients 
- round lenses, trajectory method 
341 
- spatial Boersch effect 
1004, 
1012 
- round lenses, eikonal method 
344 
- thermodynamic limit 
1009 
Bohm-Aharonov effect 56 
Caledonian quadruplet 
878 
CAMAL 
301,568 
boundary conditions for magnetosta- 
canonical equation 42, 973,990 
tic fields 96 
canonical formalism 41 

iv 
INDEX 
canonical momentum 37, 44, 1053 
carbon emitters 913, 1036 
cardinal elements 
- of quadrupole systems 281 
- of rotationally symmetric sy- 
stems 225-260 
cardinal elements of round lenses 
- approximate formulae 257 
- asymptotic 226 
- real 242 
cartesian theory of mirror optics 
271,432 
Castaing-Henry analyser 
262, 797, 
1058, 1095, 1099 
cathode 908, 912 
cathode lens 262, 425, 630, 799 
cathode-ray tubes 823 
catoptric systems 261 
Cauchy-Riemann equations 70 
caustic 57, 879-904 
- concept 879 
- higher-order focusing 893 
- intensity distribution 891 
-
o
f
 
a round lens 882 
-
o
f
 
astigmatic lenses 886 
characteristic function 
11, 49, 52, 
298 
- first-order perturbation 307 
- general 46 
chromatic aberration 298 
- differential equations for 541 
- numerical calculation 555 
- of deflection systems 507 
- of quadrupoles 460 
- of round lenses 409-417 
chromatic aberration coefficients, see 
also: axial chromatic aberration 
413 
chromatic 
aberration 
coefficients 
409-417 
- asymptotic coefficients of round 
lenses 415 
- of dual-channel sytems 516 
- real coefficients of round lenses 
412 
chromatic aberration 
- of magnification 414 
- of rotation 
414 
circular optic axis 
1059 
closed current loops 828 
collineation 235 
coma 337 
coma of quadrupoles and octopoles 
441 
coma of round lenses, asymptotic 
397 
- addition rules for 421 
-and pupil magnification 407 
coma of round lenses, real 349, 365- 
369 
- aberration figure 365 
- and aperture position 383 
- formulae 367, 385 
- thin-lens formula 368 
coma-free condition 508 
coma-free lens 773 
coma-free point 383, 701 
computer algebra 301,565-571 
computer programs for ion optics 
1098 
condenser lens 207 

INDEX 
condenser-objective 691,751 
cone-edge focus 
895 
cone focus 
895 
conformal mapping 
70, 685 
congruences 
56 
conservation 
-of energy 
18,30 
- 
of momentum 
24 
contracurrent systems 
261 
control electrode 
908 
convergence 419 
- of lenses 216 
convolutional models 
-for magnetic lenses 
711 
coordinate rotation 
209 
coordinate systems 
22 
correction of astigmatisms 
517 
crossed-field device 
1097 
crossed lenses 
810 
cross focus 
895 
crossover 983 
cryolenses 688, 783 
cubic spline 
189 
current loops 
828 
- with ferrite shield 831 
curvature vector 
1042 
curved cathodes 
429 
curved optic axis 
1037 
defect function 
559 
deflection 483 
deflection aberration (parasitic) 
475 
deflection coil fields 
- axial harmonics 
836 
- saddle coils 834 
- toroidal coils 834 
deflection modes 
850 
deflection systems 481,823 
- aberrations of 497-516, 545 
- addition of aberrations 508,545 
- alternative concepts 
844 
- electric system 
494 
- electrostatic system 484, 491 
- field models for magnetic deflec- 
tion 
828 
- hybrid system 495 
- in electron microscopes 
823 
- 
large-angle deflection 
504 
-magnetic system 484, 494, 828 
- parasitic aberrations 
509 
- pure deflection, aberrations 498 
- rotation invariant 
495 
- sensitivity 494 
- with magnetic lenses, aberrati- 
ons 
504, 570 
differential equations for the aberra- 
tions 
537-542 
curvilinear coordinate systems 
1040 
differentiation and interpolation 
curvilinear systems 
1039-1099 
- one-dimensional case 
188 
cyclic reduction methods 
173 
- two-dimensional case 
194 
cylindrical lens 
290-293, 466-469, 
dilatation factor 
20 
685 
diode 914 
cylindrical mirror analyser 
901 
diode approximation 
936 
Darmstadt project 
862 
diode-fieldmodel 945 

vi 
INDEX 
dipole field 88 
Dirichlet problem 
- 
general case 
109 
- 
planar case 
117 
- 
two-dimensional case 
113 
- 
three-dimensional form 
149 
disc of least confusion 
- 
for astigmatism 
374 
- for spherical aberration 
354 
distortion 
337 
- 
and triple-polepiece lenses 782 
- of deflection systems 
504 
-of quadrupoles and octopoles 
440, 442 
distortion-free 
orthogonal 
systems 
802 
distortion of round lenses, asymptotic 
397 
- 
addition rules 420 
- and pupil magnification 
407 
- elimination 
779, 782 
distortion of round lenses, real 
349, 
378-382 
- aberration figures 379 
- 
and aperture position 
384 
- 
formulae 380, 385 
- 
thin-lens formulae 382 
divergence factor 
954, 959, 961 
divergent lens 216,230 
double focusing 
1058 
doublet 
- cardinal elements of 234 
drift space 283 
dual-channel deflection systems 848 
dual-channel system 
511,515 
Du~ek matrix 
258, 283 
dynamic focusing and correction 841 
dynamic programming 
677, 773 
EBL, see electron lithography sy- 
stems 
EFF, see fringing field effects 
1072 
effective length 
- 
of a quadrupole 
803 
effective potential 
40, 45 
eigenvalue problems 
- for paraxial trajectories 
535 
eikonal function 
11, 50 
eikonal method 
298, 511 
einzel lens 202, 630, 655-679 
- figure of merit 
675 
- hyperbolic lenses 674 
- Kanaya-Baba model 666 
- measurements and exact calcu- 
lations 
671 
- multielectrode lenses 673 
- optimum design 
675 
- Regenstreif's model 656 
- Schiske's model 659 
- 
Shimoyama's analysis 
671 
- Wendt's theory 669 
EL3 
851 
electrical input signals 
493 
electromagnetic potentials 
63 
electron bombardment ion sources 
685 
electron emission 
907 
- field electron emission 927 
- theory 918 
- 
thermionic emission 921, 1034 
electron guns 
905-1036 

INDEX 
vii 
- design 
1017 
- self-adjoint form 
162, 179 
- field emission guns 
914, 1020, 
embedding material 
9 
1035 
- general features 
907 
- 
hybrid emission guns 
1022 
- 
LaB6 guns 
913, 1034 
- Lauer's model 
948 
- 
Pierce guns 
1030 
- point source model 
1017 
- thermionic guns 907, 948, 1028, 
1034 
emission microscope 
262, 907 
emittance 917 
- and brightness 
996 
- general concepts 
989-1003 
- 
two-dimensional 
991 
emittance diagram 
998 
- and aberrations 
1000 
emittance ellipses 992 
electron lithography systems 
495, 509, 825, 844, 1004 
483, 
- acceptance ellipse 995 
- drift 
993 
electron mirror microscope 
796 
electron mirrors 
261,425, 796-798 
- focusing 
993 
- transfer 
993 
- and aberration correction 870 
- cartesian representation 271,432 
- in energy analysis 
797, 1058 
- parametric representation 
264, 
425 
- quadratic transformation 
274 
electrostatic lenses 
202, 629-686 
- astigmatism and field curvature 
376 
emittance matching 
995 
energy analysis 
797 
- literature 
1098 
energy filters 630 
energy flux densities 
- in thermionic guns 
959 
entropy, and Boersch effect 
1011 
equations of motion 
267 
- coma 
367 
equidensities 
892 
- distortion 
381 
equivalent solenoid model 
712 
- 
quantitative investigations 
671 
- spherical aberration 
359 
electrostatic potential 
19 
Euler-Lagrange 
1053 
- of fields 65 
equations 
1047, 
- general definition 63 
- of trajectories 
36, 39, 44 
- series expansion 
82 
electrostatic principle 33 
electrostatic prisms 
1080, 1097 
- aberrations 
1056 
elliptic differential equation 
- general form 
159 
expanding spherical-mesh grid 
168 
exponential model 
- for magnetic lenses 
709 
extended paraxial domain 
61, 73 
FDM (see finite-difference method) 
159 

viii 
INDEX 
FEM 
(see finite-element method) 
175 
Fermat's principle 50 
ferrite shields 831 
field calculation 59-198 
-
e
l
e
c
t
r
o
n
 
sources with pointed 
cathodes 941 
- 
hybrid methods 969 
field curvature of round lenses, asym- 
ptotic 397 
- 
addition rules 420 
- and pupil magnification 407 
- 
infinite elements 184 
Finsterwalder condition 384 
five-electrode lens 655 
five-point formulae 160 
focal length, see real, asymptotic fo- 
cal length 
focus, see also real, asymptotic focus 
- 
blade focus 895 
- cone focus 895 
- cone-edge focus 895 
- cross focus 895 
- 
line focus 895 
field curvature of round lenses, real focusing in first order 1068 
337, 349, 369-378 
- 
aberration figure 369 
- 
and aperture position 384 
- circle of least confusion 374 
- formulae 375, 385 
- 
thin-lens formula 378 
field equations 62 
field emission gun 10, 185,914, 1019, 
1020, 1035 
- diode 939 
- field model 945 
field-emission microscopy 
900 
field emission, theory of 927 
field-interpolation techniques 
198 
fifth-order aberrations 
- 
of deflection systems 503 
- of round lenses 334, 1066 
filter lens 546 
finite-difference method 
159-174, 
301,944, 1026 
finite-element method 
175-187, 301 
foil lenses 679, 864, 865 
form factor of magnetic lenses 689 
fourfold errors 501 
fourfold symmetry in deflection sy- 
stems 500 
Fourier analysis of-the aberrations 
550 
Fourier integral kernels 125 
Fourier series expansion 505 
Fourier-Bessel series expansions 91 
Fowler-Nordheim equation 928 
8, 799, Fox-Goodwin-Numerov 
method 
526, 534 
Fredholm equation 
110 
188- fringing fieldeffects 1068, 1069, 1070 
- extended fringing fields 1072 
gas discharge electron sources 907 
gauge transformation 53 
Gaussian approximation 
- cylindrical lenses 290-293 
- deflection systems 487 
- mirrors 261-275 
- quadrupoles 276-289 

INDEX 
ix 
- round lenses 225-260 
Hamilton-Jacobi theory 46 
Gaussian brackets 285 
Hermite interpolation 
gauze lenses 300, 679 
- one-dimensional case 189 
generalized brightness function 972 
- two-dimensional case 194 
generalized model 
Herschel's condition 219 
- for magnetic lenses 713 
high-frequency lenses 872 
geometric aberration 298 
high-voltage microscope 9 
- differential equations for 537 
- pulsed-beam proposal 876 
-of deflection systems 483, 505, higher-order focusing 893 
506 
history of electron optics 6-12 
-
o
f
 quadrupoles and octopoles 
hollow beam 963, 1000 
434 
holography 
11,877 
- of round lenses 339 
Householder transformation 
544 
- of systems with a curved optic h-ray (definition) 
214, 217 
axis 1053 
Glaser's bell-shaped model 
- for round lenses 253, 567, 661, 
695 
- for quadrupoles 801,804 
Glaser-Robl model 638 
g-ray (definition) 215, 217 
G- and G-rays (definition) 226 
Green's theorem 107 
grid electrode 908 
grid, for finite differences 159 
grid lenses 679 
Grigson coils 498 
Grinberg's theory 
11 
Grinberg's model 639 
Grivet-Lenz model 640, 707 
Gullstrand's classification 323 
Hahn's model 723 
Hamiltonian 41, 42, 48, 919, 990 
Hamilton's central equation 47 
Hutter's model 638 
hybrid emission gun 916 
hybrid 
field 
calculation 
methods 
170, 184 
hyperbolic lens 674 
hyperemittance 991, 1011 
Ichinokawa analyser 1095, 1099 
ideal deflection 490 
image converter 263 
immersion lens 202,630,631-655 
- single aperture 631 
- three or more electrodes 
647- 
655 
- two-electrode lens 635-647 
immersion objective 263 
improper integral 
- evaluation 
141 
initial value problem 
- ordinary differential equations 
526 
Hamilton-Jacobi equation 48 
- paraxial trajectories 533 

x 
INDEX 
integral equation 107-124 
kinematic function 21 
- 
and interpolation 136 
kinetic energy 19 
- for magnetic deflection coils 119 kinetic momentum 17, 20, 36, 1046, 
- for multipoles 121 
1052 
- for parasitic aberrations 
122 
kinetic potential 36 
- for rotationally symmetric po- Lagrange bracket 57, 309 
tentials 117, 118 
- for scalar potentials 
107 
-for unconventional lenses 119 
- general theory 107 
- 
numerical solution 131 
Lagrange density 65 
Lagrange differential invariant (see 
also Lagrange bracket) 220 
Lagrange equations 36 
Lagrange formalism 35 
intensity considerations for caustics Lagrange-Helmholtz relation 1048 
891 
interface conditions 97 
- 
general case 111 
- 
two-dimensional case 116 
interferometer 262 
intermediate lens 207 
inverse problem for magnetic lenses 
737 
Lagrangian 35, 989, 1046 
Lambert's law 924 
laminated lenses 10, 181,779 
lancet cathode 912 
Langmuir-Child law 962, 1031 
lanthanum hexaboride cathode 913, 
1034 
Laplace's equation 63, 1043 
inversion of the principal planes 253 Larmor frequency 26, 210, 472 
ion microprobes 801,806 
lateral aberration 500,501, 1056 
ion optics, unified theory 1080-1099 lateral magnification 939 
- Nakabushi's studies 1085 
Lauer's triode model 948 
isophotes 893 
least-squares-fit method in electron 
isoplanatic approximation 477, 886 
optics 543, 551 
isotropic aberration terms in deflec- Legendre transform 40, 45, 990 
tion systems 501 
iterative solution techniques (in the 
FDM) 170 
Judd's rule 1065 
Kanaya-Baba model 
- for bipotential lenses 640 
- for einzel lenses 666 
Kasper's diode model 943 
Kerst-Serber equations 1062 
lens design (see also electrostatic, ma- 
gnetic lenses) 
- for analytical instruments 693 
- for three-dimensional 
reconstruction 694 
lens-mirror transition 630 
Lenz's brightness theory 980, 996 
Lie algebra and aberrations 
301, 
1065 

INDEX 
xi 
Liebmann's curves 
733 
Liebmann's method (see finite diffe- 
rence method) 
159 
line focus 
895 
Liouville's theorem 
972, 981,989 
load characteristic 
286, 809 
longitudinal 
- 
magnification 
218 
- 
temperature 
1008 
Lorentz equation 
17 
Lorentz force 
17 
Luneberg lens 
679 
MACSYMA 
565 
magnetic deflection systems 
- aberrations 
497 
- field calculation 
119 
- field models 
828 
- saddle coils 484 
- 
sensitivity 
494 
-
t
o
r
o
i
d
a
l
 
coils 
105, 484 
magnetic flux function 
24, 67 
magnetic flux potential 
101, 104, 
181 
magnetic lenses 
202, 687-795 
- astigmatism and field curvature 
377 
- coma 
368 
- convolutional models 
711 
- 
distortion 
381 
- exponential model 
709 
-field calculation 
102, 155, 175 
- field models 
695 
- form factor 
689 
- generalized model 
713 
- Glaser's bell-shaped model 
695 
- Grivet-Lenz model 
707 
- 
Hahn's mapping 
723 
- 
laminated lenses 
779 
- 
lens with low specimen field 790 
- 
measurements and universal cur- 
ves 
726 
- 
unsaturated lenses 
733 
- 
saturated lenses 
737 
- minilenses 
776 
- modes of operation 
691 
- 
notation 
694 
- optimization 
772 
-other bell-shaped models 
706 
- pancake lenses 
776 
- permanent-magnet lenses 
787 
- power-law model 
710 
- 
practical design 
691 
- rectangular model 
718 
- 
scaling rules 
689 
- single-polepiece lenses 
776 
- spherical aberration coefficient 
363 
- superconducting lenses 
687 
- supertwin lens 
792 
- symmetric 
687, 695 
- Tretner's analysis 
755 
- triple-polepiece lens 
782 
- twin lens 
792 
- unconventional 
104, 776 
- unsymmetric 
687, 718 
magnetic prisms 
1058-1079, 1096 
- aberrations 
1054, 1073 
- axial focusing 
1068 
- dispersion 
1067 
- focusing in first order 
1063 

xii 
INDEX 
- 
fringing field effects 1070 
- optimization 1076 
- radial focusing 1063 
- 
with circular axis 1059 
magnetic sector fields: see magnetic 
prisms 1058-1079 
magnetostatics, boundary conditions 
96 
magnification 
- 
angular 217 
- complex 216 
- 
longitudinal 218 
- 
transverse 216 
mass spectrometer 71, 1079, 1099 
material coefficients 98 
material equations 63 
maximum brightness 974 
Maxwell's equations 62 
Maxwell's fish-eye 679 
mean energy 923, 1005 
mechanical aberration, see parasitic 
aberration 
meridional rays 211 
merit function 559 
microwave cavity lenses 876 
minilenses 776 
mirror electron microscope 262 
mirrors 261,425, 796 
MSllenstedt analyser 1095, 1099 
monochromators 630 
multipole fields 1043 
- series expansions 88 
multipole system 
- field calculation 121 
- in ion optics 1098 
Munro--Chu formulae for deflection 
aberrations 509 
Murphy-Good-Young equation 928 
Neill parabola 884 
Neumann problems 
- general case 111 
Newton's lens equation 
231, 236, 
246 
Newtonian field 242,252,698 
nine-point formulae 165 
nodal point 232, 1022 
normalized brightness 976, 1011 
Nottingham effect 930 
numerical differentiation 190 
Numerov method (see Fox-Goodwin- 
Numerov method) 526, 534 
objective lens 207, 226, 242 
- spherical aberration 354 
omega filters 1079, 1095, 1099 
optimization procedures 
1021 
-damped least-squares method 
562 
- for axial distributions 561,771 
- for magnetic prisms 1076 
- general considerations 558 
Monte Carlo method 
1005 
moving objective lens (MOL) 
839 
multielectrode lenses 647 
multipole correctors 859 
965, 
1004, ordinary differential equations, nu- 
merical solution 526-533 
508, orthogonal trajectories 49, 52 
orthogonality condition 
- for quadrupole lenses 279 
orthomorphic systems 802, 810 

INDEX 
xiii 
oscilloscope 483, 484, 491,498 
osculating cardinal elements 246 
pancake-lenses 776 
parasitic aberration 298, 470, 517 
- classification 319, 472 
- numerical determination 475 
-
o
f
 
deflection systems 509 
paraxial deflection 496, 520 
paraxial distortion 474, 496 
paraxial ray equation 
- derivation 207, 211 
- for momentum 223 
-
o
f
 combined systems 509 
- of deflection systems 487 
- of mirrors, cartesian form 271 
- of quadrupoles 277 
-of round lenses 207, 213 
- Picht's transformation 214 
- transformations of 222 
paraxial trajectory equations 
1047 
partial-integration rule 291 
permanent-magnet lenses 202, 787 
perturbation 
- characteristic function 307 
- eikonal 499, 1055 
- first-order 307 
- general formalism 297, 303 
- operator 305 
- second-order 310 
perturbations of the rotational sym- 
metry 122 
perveance 984 
Petzval coefficient 
- asymptotic 401 
- real 376 
phase condition, for HF-lenses 872 
phase shifts 338 
phase space 989, 919, 1011 
Picht's transformation 214, 472 
Pierce systems 962, 1030 
pincushion distortion 
379 
pinhole lens 718 
pivot-point 491 
planar fields 69, 90, 117,290 
pocket-handkerchief distortion 
379 
Poincar~'s integral invariant 54, 57 
point characteristic function 49, 305 
point source: see virtual source 1017 
pointed filament 912, 934 
Poisson equation 
- scalar form 73, 170,953 
- vector form 63, 64 
polepiece design 691 
- material 687, 753 
polynomial forms of asymptotic aber- 
ration coefficients 12,396,416, 
439 
potential barrier 920 
potential energy 19 
potential minimum 955, 961 
power law model for magnetic lenses 
710 
predictor-corrector method 529 
principal normal 1041 
principal planes, see real, asymptotic 
principal planes 
principal ray 491 
probe-forming lens 207 
- spherical aberration 
354 
projective transformation 
235 
projector lens 207 

xiv 
INDEX 
pseudo-stigmatic systems 802 
pupils 
349 
quadrupole coefficients 489 
quadrupole field 89 
- bell-shaped model 801,804 
- 
rectangular model 801,803 
quadrupole lens 276-289, 801-822 
quadrupole multiplets 
284, 461 
- anamorphotic 
802 
- antisymmetric 
286, 436 
- distortion-free 
802 
- orthomorphic 
802 
- pseudo-stigmatic 
802 
- 
regular 
802 
- 
symmetric 436 
quadrupole-octopole correctors 
859 
quadrupoles 
- 
antisymmetric multiplets 
286, 
805 
- 
arc lenses 810 
- astigmatic tube lenses 813 
- 
biplanar lenses 811 
- crossed lenses 810 
- doublets 
805 
- 
ion microanalysers 
806 
- 
isolated 
805 
- load characteristic 
809 
- paraxial equations 
277 
- quadruplets 
809 
- 
radial lenses 
819 
- 
Russian quadruplet 
810 
- special geometries 810 
- 
transaxial lenses 819 
- 
triplets 
806 
quasistatic approximation 
61 
radial focusing (prisms) 
1063 
radial lenses 819 
radial series expansion 
- 
evaluation 
192 
- 
for integral kernels 
126 
- 
for fields 
78 
rare-earth polepieces 753 
raster pattern 
483 
real aberration coefficients 
- 
of round lenses 339 
- of quadrupoles 
454 
real and asymptotic aberrations 
11 
real cardinal elements 
242, 697 
- focal length 
244 
- image focal plane 
243 
- image focus 243 
- 
principal planes 
244 
- 
inversion of 253 
- object focus 
242 
Rebsch-Schneider 
measure of lens 
performance 
769 
reciprocal magnification 
395 
rectangular model 
- for magnetic lenses 
717 
recurrence relation 
- for integral kernels 
127 
REDUCE 
301,565, 568 
reduced brightness (see normalized 
brightness) 
976, 981 
reduced coordinates 
231, 339, 384- 
386 
reduced magnetic scalar potential 
100 
reference sphere 350 
- and astigmatism 
375 
- and coma 366 

INDEX 
XV 
- and distortion 376 
- series expansion 83 
- and field curvature 375 
scalar potential 
- and spherical aberration 356 
refractive index 51 
- series expansion 73, 78 
scaling rules 33 
Regenstreif's model 656 
regular systems 802 
relative refractive index 419 
relativistic kinematics 17 
relativistic mass 17 
relativistic proper-time element 29 
reluctance 63 
resolving power 1068 
Richardson-Dushman equation 922 
Richtstrahlwert 971 
scanning electron microscope (SEM) 
10, 483, 498, 823 
scanning 
transmission 
electron 
microscope (STEM) 
10, 821 
scatter-plots 802 
Scherzer's theorem 11,363,857 
Schiske's model 659 
Schottky emission 931,975 
Schwarz's alternating method 
185 
SCOFF, see fringing field effects 
1070 
rotating coordinate system: see rota- second-zone objective 691,751 
ting frame 
rotating frame 208, 267 
rotation-invariant deflection 495 
rotationally symmetric fields 
- general relations 67 
- series expansions 85 
rotationally symmetric system 202 
- general systems 38 
- geometrical aberrations 339- 
392 
- paraxial properties 202 
sector fields, magnetic 1058-1079 
self-adjoint elliptic equations, FEM 
solution 179 
Seman's technique 11,356, 387 
sensitivity of deflectors 
- complex 497 
- real 494 
series expansions 1049 
- for potentials and fields 73-93 
- with curved optic axis 1042 
seven-electrode lens 655 
- 
static systems 44 
Runge-Kutta method 527 
Ruska-Riecke lens 691 
Russian quadruplet 
286, 810 
saddle coil systems 484, 834 
saturated lenses 737 
sextupole correctors 863 
shaped-beam systems 514 
shaped-beam technique 483, 851 
sharp cutoff fringing field 1070 
shielding cryolens 688 
shift matrices 422 
saturation 66, 689 
scalar magnetic potential 78 
- general definition 64 
Shimoyama's model 671 
shooting-method 536 
sign convention 230 

xvi 
INDEX 
single aperture 
- field of 143, 631 
- optics of 632 
single octopoles as corrector 862 
single-polepiece lenses 776 
skew optic axis 1039 
skew rays 211 
-forward and backward 356 
- sign 352, 363 
- thin-lens formula 365 
spherical cathode 934 
spherical diode 953 
spherical-mesh grid 168 
spiral distortion 379 
SLOR (see successive line overrelaxa- spline 136 
tion method) 173 
Smith-Helmholtz formula 218 
SOC, see sphere-on-orthogonal cone 
model 941 
solid angle potential 99 
Sommerfeld-Bethe model 918 
SOR (see successive overrelaxation 
method) 
171 
spot diagram 526, 802 
step-width adjustment 531 
stigmatic image 214 
stigmator 471,479, 516-521,899 
StSrmer equation 45 
strong focusing 276, 1062 
Stufenfeld 723 
space charge 911,953, 963, 975,982 Sturrock's units 52, 384-386 
-
a
n
d
 
aberration correction 864 
- counting method 965, 969 
- semianalytic method 965 
spectral radiance 923 
sphere-on-orthogonal-cone 
model 
941 
spherical aberration coefficient 
- finite magnification 737 
- the bell-shaped model 701 
- the rectangular model 718 
spherical aberration of round lenses, 
asymptotic 396 
- addition rules 421 
- and pupil magnification 407 
successive line overrelaxation method 
173 
successive 
overrelaxation 
method 
171 
superconducting lenses 9, 202, 687, 
753, 783 
- yokes 101 
- zone plate 865 
superposition, of aperture fields 146, 
193 
supertwin lens 792 
surface charge density 96 
surface current density 97 
surface normal 94 
spherical aberration of round lenses, synklysmotron 875 
real 349, 350-365 
tangential vector 1041 
- and aperture position 383 
telescopic-condenser mode 691 
- disc of least confusion 354 
television tube 484, 823, 498 
-formulae 356, 385 
thermal-field (TF) emission 927 

INDEX 
xvii 
thermionic electron guns 
1034 
908, 974, 
transverse 
momentum 
distribution 
924, 931 
- conventional forms 908, 1028 
transverse temperature 
1007 
- 
diodes 939 
- field model 
945 
- 
short focus 
1029 
- telefocus 
1029 
- 
triode guns 
908, 948 
thermionic emission 921 
thermodynamics, and Boersch effect 
1006 
Tretner and ultimate lens perfor- 
mance 365,755 
- 
electrostatic lenses 
763 
- 
magnetic lenses 
766 
triode gun 
908, 948 
triple-polepiece projector lenses 
782 
truncated power series algebra 
1095 
tubular lens 901 
thin-lens approximation 
257, 365 
threefold astigmatism 
475 
toroidal coil systems 484, 834 
torsion 
1042 
total energy distribution 
923, 929 
trace space 
989, 998 
trajectory equations 
27, 1052 
- arc length representation 
27 
- cartesian representation 
30 
- in curvilinear systems 
1045, 
1052 
- parametric representation 
27 
- relativistic proper-time represen- 
tation 
29 
trajectory method 
11,297, 341 
transaxial lens 286, 819 
transfer matrices 
226, 
231, 
292, 
1065, 1069 
- of a drift space 283 
tunnel effect 914, 925 
twelve-pole stigmator 
520 
twin lenses 
792 
two different symmetries in deflection 
systems 498 
two-electrode lenses 635 
ultimate lens performance 
755 
- early studies 
769 
- Glaser's aberration-free lens 
770 
- Tretner's analysis 
365, 755 
ultramicrotome 
9 
unconventional lenses 
10, 119, 687, 
776 
unipotential lens 202, 630, 655 
unsaturated lenses, properties 
733 
unsymmetric magnetic lenses, pro- 
perties 
718 
variable-axis immersion lens (VAIL) 
843 
- of quadrupole systems 
280 
transmission factor 
919, 921 
transverse axial field strength 
489 
variable shaped-beam technique 851 
variable-axis lens (VAL) 
825, 839 
variational principle 
transverse chromatic error 507 
- for fields 65, 175 
transverse magnification 
216 
- for paraxial equations 
212 

°.o 
XVlll 
INDEX 
- for trajectories 35 
- for trajectories with curved optic 
axis 1045 
- 
time-independent form 43 
vector potential 51 
- 
general definition 63 
- 
series expansions 75, 80, 83 
vector scan technique 850 
vertical landing 839 
virtual cathode 961 
virtual source 914, 937, 940, 1021 
wave aberration 473, 518 
weak-lens approximation 257, 771 
wehnelt electrode 908,914 
Wendt's theory 669 
Wien filter 494, 1097 
work function 921, 1024 
working distance 483 
Wronskian 217, 392 
Yada's combined lens 771 
yoke design 691 
zoom lenses 647 

Corrections for Volume 1 
p. 22 
(R, _G, ~) -~ (R, O, ~) 
p. 32 
In (3.20), second equation: By ~ B~ 
p. 41 
In (4.26): L(r, p, t) --~ L(r, v, t) 
pp. 54--6 
In (5.30), first equation on p. 55 and (5.33): S ~ 
p. 70 
Fig. 6.3: (x, y) ---> (z, x) 
p. 80 
Bottom of page: m+m-~m+n 
p. 81 
In (7.32), end of top line: add (z) 
p. 86 
In (7.52b): r2/9216 -~ r6/9216 
p. 132 
In (10.22)" Y -~ Yk 
p. 166 
Line 5: v = k/h --) k = v/h 
p. 179 
In (12.14): upper limit is M instead of N 
p. 180 
Three lines above (12.18): c i ~ C i 
p. 190 
In (13.7): Y,' 
k+l -'-) Y/+I 
p. 190 
In (13.8): DN+ 1 --~ DN_ 1 
p. 191 
In (13.10b): Y--~ Y~ 
pp. 234-5 
In the last lines of (16.34) and (16.37): 
D + f(2) __) D - f(2) 
"10 
JO 
p. 239 
(15.57) --> (16.57) 
+Xl + 
p. 303 
In (22.2): (1 + x 1 + 
(1 
e 
x~)1/2 
pp. 307 and 345, texts below (22.24) and (24.27b): 
it is not true that p.(1) = 0 is equivalent to x'. (~) = 0 in 
• 
J 
field-free space. Th~ correct relation is given at the 
beginning of Chapter 25. None of the subsequent calcu- 
lations is affected. 

p. 325 
Three lines from bottom: (third-order) ~ (fifth-order)_ 
p. 331 
(0120) WoW 
~-2 _~ (0120) ~oUr~ 
p. 336 
In first equation: ~r~ ---> r~or: 
p. 340 
In (24.1): (X'2= y,2) __> (X,2= y,2)2 
p. 341 
In (24.5): insert 8 
p. 342 
Two lines above (24.14): image ~ aperture 
p. 345 
p. 353 
In (24.30): replace x~(z) and y~(z) by Xat(Z) and Yat(Z) 
In (24.46): ~2 -o 4~o/2 
p. 353 
(24.32b) --> (24.32) 
p. 363 
p. 387 
In the expression for C 2 (24.68): the term 7~b74~ should 
read 7~'/2~ and the factor 29 in the last term should 
be (21+2~) (see Preikszas, D. and Rose, H., Optik 100 
(1995) 179-187 
1 ~bl/2x,2 
In M (2), (24.138): insert + before 
p. 390 
In Rz9: delete x 2 
p. 391 
Second line: pj ~ pj 
p. 401 
In (25.32): the second line of the expression for A e should 
read 
30(1 + 6(~)--z:~_.~ + 2(27' + 11~+ 2) 
p. 401 
Two lines above (25.33): G(z) -o G(-z) 
pp. 416--17 
In CD (26.24) and Ce (26.27), replace ~o ~2 by ~o 
p. 419 
In (27.9): the missing matrix element is 0 
p. 420 
Line below (27.13): YA ~ UA 
pp. 510--511 The numbers of aberration coefficients should in fact be 
56 (instead of 59) and 24 (instead of 27); for further expla- 
nation, see Plies, E. and Elstner, R., Optik 83 (1989(, 
especially p. 12. 

