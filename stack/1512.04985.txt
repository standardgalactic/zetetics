Université Pierre et Marie Curie
École doctorale d’Astronomie et d’Astrophysique
d’Île-de-France (ED127)
Institut d’Astrophysique de Paris
Bayesian large-scale structure inference
and cosmic web analysis
Thèse de doctorat
Discipline : Cosmologie
présentée et soutenue publiquement le 24 septembre 2015
par
Florent Leclercq
devant un jury composé de :
Bertrand Laforge
Professeur, Université Pierre et Marie Curie
Président du jury
Benjamin Wandelt
Professeur, Université Pierre et Marie Curie
Directeur de thèse
Oliver Hahn
Professeur, Université Nice Sophia Antipolis
Rapporteur
Alan Heavens
Professeur, Imperial College London
Rapporteur
Ofer Lahav
Professeur, University College London
Examinateur
Will Percival
Professeur, University of Portsmouth
Examinateur
Rien van de Weygaert
Professeur, University of Groningen
Invité
Matías Zaldarriaga
Professeur, Institute for Advanced Study, Princeton
Invité
arXiv:1512.04985v1  [astro-ph.CO]  15 Dec 2015


Because all things balance – as on a wheel – and we cannot see nine-tenths of what is real,
our claims of self-reliance are pieced together by unpanned gold.
— Franklin D’Olier Reeve (1995), Coasting
There’s gold, and it’s haunting and haunting;
It’s luring me on as of old;
Yet it isn’t the gold that I’m wanting
So much as just ﬁnding the gold.
It’s the great, big, broad land ’way up yonder,
It’s the forests where silence has lease;
It’s the beauty that thrills me with wonder,
It’s the stillness that ﬁlls me with peace.
— Robert William Service (1907), The Spell of the Yukon


Preface
“But especially he loved to run in the dim twilight of the summer
midnights, listening to the subdued and sleepy murmurs of the
forest, reading signs and sounds as a man may read a book, and
seeking for the mysterious something that called – called, waking
or sleeping, at all times, for him to come.”
— Jack London (1903), The Call of the Wild
This PhD thesis is written as completion of my work at the Institut d’Astrophysique de Paris from 2012
to 2015. Three years ago, I started this project with heartfelt enthusiasm, but it turned out to be much more
than expected – an incredibly rewarding journey. This thesis is the report of this long process. It expresses my
vision – that I have had incredible trouble in organizing linearly – of the ﬁnal scientiﬁc products.
Unfortunately, it cannot describe the thought process and the strange mechanism by which something out
in there in the Universe, be it a galaxy cluster, a scientiﬁc tool, or a concept – something that a month ago was
a stranger – becomes intimate. Neither does it capture my feelings during the long days – and nights – spent
in front of a black board, a paper or a computer, alone or in the lab: the sadness and tiredness with failed
endeavors, the bittersweet taste of learning I was wrong, the hope for good results, the joy for successes, and
the wonder at the elegance of the cosmos.
As a consequence, this preface takes the occasion to describe how this thesis came into being.
Stars and physical sciences
I have always thought that modern physics is fascinating. Not only does it manipulate extraordinary ideas
and concepts (quantum mechanics, relativity), it also deals with important societal issues (energy, natural
resources). In this respect, I am fascinated by how far the physical sciences, in just a few hundred years, have
taken us in our understanding of nature. Given this incredible evolution, it is amazing to realize that looking
at the sky – the amusement during the warm summers in ancient Greece – still gathers so much attention. This
strange mixture of tradition and modernity may be the reason why, as far as I remember, I have always had a
particular attraction for astrophysics.
For most of the history of humanity, cosmology was part of religion or metaphysics. Only recently did it
become a science, its peculiarity being the uniqueness of its object of interest – the Universe as a whole. The
idea that the entire Universe can be treated as a physical system was one of the most striking revelation of my
life as a student. It is commonly predicted that early 21st century cosmology is on the verge of a revolution.
In upcoming years, surprising or unexpected results may or may not be found, but I believe that cosmology
will stay one of humanity’s greatest intellectual endeavors, and certainly the one that has produced the deepest
description of the natural world as we ﬁnd it.
Models and beliefs
Contrary to my long-held passion for the Universe, my interest in probability theory came in a rather
fortuitous manner. But faced with the immodest, enthralling questions of cosmology, one soon realizes that
there is no absolute truth, only beliefs. Colleagues showed me that this viewpoint makes all the problems of
modern cosmology appear in a very diﬀerent light. Then, in a quick succession, reading about probability
theory, which truly is the “logic of science”, in the words of Jaynes (2003), made me realize that in the much
larger and permanent world of plausible reasoning, i.e. rational thinking in the presence of uncertainty, the
current problems of physics appear only as details: what matters is the road, not the destination.
Few, if any, of our ordinary-life beliefs are certain to the degree that we cannot imagine them being over-
thrown by suﬃcient contradictory evidence. Similarly, typical commonsense inferences rely on applying rules
that are general, but not universal. Therefore, deduction does not entirely characterize commonsense reasoning.
This thesis exploits theories of inductive and abductive logic, to draw and assess the strength of conclusions
from uncertain rules and partial evidence.

vi
Probability theory, when seen as an extension of ordinary logic incorporates the description of randomness
but also statistical inference and becomes a ﬁeld of logical unity and simplicity. It allows us to solve problems
of great complexity, and reproduces many aspects of human cognitive activity, often in disturbing detail. In
doing so, it captures something about how our minds operate when we form inductive judgments, of which we
may not be consciously aware. This aspect takes a very particular meaning when we deal with the Universe.
Why bother about this thesis?
This thesis focuses on methodology for the analysis of the large-scale structure of the Universe. I should say
from the beginning that the methods presented do not have the same degree of maturity as standard techniques
for the analysis of galaxy surveys. So why should the reader bother?
1. I believe that new solutions to complex problems involving both data and uncertainty are needed to exploit
the full potential of future, but also of existing surveys. However many data sets we record and analyze, if
we use the same old models without questioning them, we will always miss the same crucially important
feature that the experiment was competent to ﬁnd, of which we may not be aware. If we want to detect
any phenomenon, we must have a data model that at least allows the possibility that it may exist.
2. Innovative methods also allow the possibility to crosscheck the validity of cosmological analyses that are
widely accepted. A false premise or a conﬁrmation bias, when built into a model that is never questioned,
cannot be removed by any amount of new data. Only a fresh look can get rid of that.
In the hope to make progress in the analysis of the cosmic large-scale structure, this thesis tries to develop
a “healthy disrespect for tradition and authority, which have retarded progress throughout the 20th century”
(Jaynes, 2003).
How to read this thesis
The thesis is divided into four parts. Part I is a preparatory discussion on the analytical and numerical
description of the large-scale structure. The heart of this thesis is part II on Bayesian large-scale structure
inference and part IV on cosmic web analysis. The transitional part III focuses on the non-linear regime of
structure formation.
It is my hope that at least some chapters are written in a suﬃciently engaging textbook style for graduate
students. This should be the case in particular for chapter 1 on structure formation, chapter 3 on Bayesian
statistics and appendix B on numerical simulations. There, except in section 1.1, I have struggled to avoid the
dreadful sentence “It can be shown that...” as much as possible. I have tried to give references to the original
literature whenever it is possible, but I certainly did not attempt a true bibliography as can be found in excellent
review papers on the large-scale structure and on probability theory. Chapter 4 describes the borg algorithm,
which is the basis this entire thesis. It gathers information scattered through published journal papers, and
hence is also intended for reference use. The rest of the thesis directly draws from the research papers that have
been published during my PhD work: chapter 2 from Leclercq et al. (2013) and its addendum, Leclercq, Jasche
& Wandelt (2015b), chapter 5 from Jasche, Leclercq & Wandelt (2015), chapter 6 from Leclercq et al. (2013),
chapter 7 from Leclercq et al. (2015) and Leclercq, Jasche & Wandelt (2015c), chapter 8 from Leclercq et al.
(2015), chapter 9 from Leclercq, Jasche & Wandelt (2015c), and chapter 10 from Leclercq, Jasche & Wandelt
(2015a). There, the style becomes more succinct and the aim is rather to describe speciﬁc projects, give a guide
to the literature and report on the results obtained.
Considering that this thesis is a rare occasion to include whatever I want in a research work, I decided to
tackle the diﬃcult task of choosing epigraphs. The various quotes spread throughout the thesis may or may
not have something to do with the main text. Some are inspirational, thought-provoking, some are openly
provocative, some can just be considered as Easter eggs, and some are just there for free.
The online version of thesis will be revised to correct for any mistakes, typographical and otherwise,
found after it goes to press and archiving.
I will try to maintain a list of corrections on my website,
currently hosted at http://www2.iap.fr/users/leclercq/.
Please feel free to send me any comments at
florent.leclercq@polytechnique.org.

vii
Cosmology is a journey
“Bien lire l’Univers, c’est bien lire la vie.”
— Victor Hugo (1856), Les Contemplations
Though physical cosmology is celebrating its ﬁrst century, it is no relic of the past. We live unique and very
exciting times, when we expect to see a qualitative leap in our knowledge of the Universe within a lifetime. I
consider myself incredibly fortunate to be part of this adventure.
In my experience, the loneliness felt by some researchers is easily overcome in our ﬁeld by a simple thought:
a cosmologist’s quest is the quest of all humanity. This is why, I believe, cosmology resonates with people all
around the world well beyond professional scientists, in diﬀerent places and cultures. It touches everybody
intellectually, but also emotionally and spiritually, without prejudice. As probability theory says something
about how our mind works, physical cosmology tells us how we can think of ourselves as a species.
Before moving to the traditionally must-read acknowledgement section, I would like to quote Paulo Coelho’s
prologue to The Alchemist (1988). When Narcissus falls into the lake and dies, the lake weeps, and declares:
“I weep for Narcissus, but I never noticed that Narcissus was beautiful. I weep because, each time he knelt
beside my banks, I could see, in the depths of his eyes, my own beauty reﬂected.” When we look into the deep
Universe, the Universe also may be looking deeply into us.
Acknowledgments
“There are all kinds of love in this world, but never the same love
twice.”
— Francis Scott Fitzgerald (1925), The Great Gatsby
What a long road this has been. It is diﬃcult to believe that the end has ﬁnally arrived. That I could write
this thesis, and much more importantly, that I became who I am to write it, is due in no small part to the
support of a great many people. It is not a process that started three years ago, but way before that. Along
the road, I met thousands of wonderful people. I wish I could mention by name anyone who has helped, in one
way or another, but the list is very, very long. I hope that I have been as kind with you as you have been with
me, and I apologize for not writing down your name.
I ﬁrst wish to express my gratitude to my supervisor, Benjamin Wandelt, who was abundantly helpful and
oﬀered invaluable assistance, support and guidance. I cannot emphasize enough how delightful it has been to
work with you, not only for your knowledge, dedication and modesty, but also for your interest in the human
being that lies behind the scientist. Your expertise, understanding, and patience added considerably to my
experience during the preparation of this thesis. Our meetings were always rich in ideas, jokes and laughs; I
learned so much from you, not only scientiﬁcally, but also on how to be successful as a researcher. This is
something very precious that I intend to keep forever.
I would like to address very special thanks to Jens Jasche for the opportunity to work within the larger eﬀort
surrounding Bayesian large-scale structure inference – such a stimulating endeavor – and for his assistance at
all levels during this research project.
I am very grateful for the time that you gave selﬂessly to provide
me with direction and technical assistance, especially during my ﬁrst two years. I greatly enjoyed our many
scientiﬁc discussions and the way you inﬂuenced my scientiﬁc approaches. You have been a friendly, creative
and supportive advisor.
I am also grateful to several researchers with whom I have had the chance to collaborate in the last three
years: Jacopo Chevallard, Héctor Gil-Marín, Nico Hamaus, Guilhem Lavaux, Emilio Romano-Díaz, Paul Sutter,
and Alice Pisani. I greatly beneﬁted from the experience of each of you, and it has been a pleasure to work
on common projects. To Nico, thanks for the organization of the weekly happy hour and for your unfailing
contribution to the good atmosphere. To Paul, thanks for a very nice workshop in Ohio and for a memorable
void barbecue at the occasion of the “Breaking of the Fellowship”. À Guilhem, merci de m’avoir fait partager
ton expérience, tout en me rappelant qu’il ne faut pas trop parler de science comme si c’était un sujet sérieux !
À Alice, merci pour ton sourire, pour nos discussions et tout ce qu’on a partagé.

viii
Two people, with whom I have not worked directly, deserve however a very special mention: Joseph Silk
and Matías Zaldarriaga. Joe is one of the scientists I admire most, not only for his immense knowledge in
astrophysics and cosmology, but also for his kindness and simplicity. Many thanks for sharing valuable insights
into your vision of science and research. Matías followed my work at various stages during my PhD project.
I am grateful for your invitations in Princeton, for your encouragements and for many useful discussions and
suggestions. This year, applying for postdoctoral positions has been both stimulating and challenging – yet
another experience of what it means to grow up. In this respect, I want to thank my recommendation letter
writers, Ben Wandelt, Jens Jasche, Joe Silk and Matías Zaldarriaga, who very kindly accepted to support my
applications. I am very obliged to Will Percival for his trust and for the perspective of thought-provoking
exchanges, stimulating discussions and a fruitful collaboration.
I am indebted to my defense committee, Oliver Hahn, Alan Heavens, Bertrand Laforge, Ofer Lahav, Will
Percival, Rien van de Weygaert and Matías Zaldarriaga for the honor to judge my work. I am extremely proud
to be able to gather such a prestigious jury. Additional thanks go to the rapporteurs, Oliver Hahn and Alan
Heavens, for having spent part of their summer reviewing the manuscript and for their positive judgment of
my work. I am very obliged to Alan Heavens for the honor to feature one of the cosmic web maps presented in
this thesis as the front cover of the proceedings of IAU Symposium 306 “Statistical challenges in 21st century
cosmology”.
Participating in various international conferences and summer schools has always been a fruitful and en-
joyable experience. I want to thank the organizers of the ICTP summer school on cosmology and workshop
on large-scale structure (2012), the Varenna summer school (2013), the Les Houches summer school (2013),
the Rencontres de Moriond (2014, Cosmology session), the IAU symposia 306 and 308 in Lisbon and Tallinn
(2014), the CCAPP workshop on cosmic voids (2014), COSMO 2014 in Chicago, the MPA-EXC workshop on
the dynamic Universe (2014, Garching), the ICTP workshop on cosmological structures (2015), the ESO-MPA-
EXC large-scale structure conference (2014, Garching), and the Rencontres du Vietnam in Quy Nhon (2015,
Cosmology session). Best greetings, in particular, to the Les Houches’ cosmologists group; thanks also to the
organizers of the student conferences I attended: Elbereth 2012, 2013, 2014, and the SCGSC 2013. On various
occasions, I have had the chance to have friendly and interesting discussions (even if sometimes short) within the
cosmology community. In particular, my work beneﬁted from interactions with Niayesh Afshordi, Raul Angulo,
Stephen Bailey, Robert Cahn, Olivier Doré, Torsten Enßlin, Luigi Guzzo, Oliver Hahn, Jean-Christophe Hamil-
ton, Alan Heavens, Shirley Ho, Mike Hudson, Eiichiro Komatsu, Ofer Lahav, Mark Neyrinck, Nelson Padilla,
Bruce Partridge, Will Percival, David Schlegel, Uroš Seljak, Sergei Shandarin, Ravi Sheth, Svetlin Tassev, and
Rien van de Weygaert (among many others). At this point, it also seems needed to acknowledge the decisive
contribution of a familiar ∼20 Mpc/h void (at coordinates x ≈−100, y ≈200 in the slice that I usually show),
which very nicely makes my point during presentations.
Cette thèse n’aurait pas été la même si elle n’avait pas été préparée dans l’excellent environnement scientiﬁque
de l’IAP. Pour cette raison, je suis reconnaissant à tous ses chercheurs, et en particuliar, pour d’intéressantes
conversations, à Francis Bernardeau, Luc Blanchet, François Bouchet, Jean-François Cardoso, Stéphane Char-
lot, Yohan Dubois, Florence Durret, Silvia Galli, Valérie de Lapparent, Matt Lehnert, Gary Mamon, Henry
McCracken, Jean-Philippe Uzan, Sébastien Peirani, Patrick Peter, Cyril Pitrou, et Sébastien Renaux-Petel.
Merci à Valérie de Lapparent pour son aide, utile pour la rédaction de l’introduction de cette thèse, concernant
l’historique des relevés de galaxies et plusieurs questions observationnelles. Thanks to Matt Lehnert for sharing
his experience of the politics of research. Une pensée amicale aux étudiants en thèse que j’ai eu l’opportunité de
côtoyer pendant trois ans: Sylvain et Guillaume (docteurs en 2013); Vincent, Vincent, Maxime, Jean, Hayley,
Guillaume, Manuel et Flavien (docteurs en 2014); Nicolas, Hélène, Sandrine, Charlotte, Vivien et Clément (vous
me devancez de quelques jours, félicitations !); et ceux pour qui ce n’est pas encore ﬁni (bon courage !): Pierre,
Thomas, Alba, Clotilde, Jean-Baptiste, Julia, Laura, Mélanie, Rebekka, Caterina, Erwan, Federico, Nicolas,
Sébastien, Tilman.
Amitiés également à quelques uns des labos voisins: Fabien, Julian, Benjamin, Julien,
Mathilde, Tico, Anaïs, François, Linc, Agnès, Marta. Pour la gestion sans faille des serveurs Horizon, dont
mon travail a beaucoup bénéﬁcié, merci à Stéphane Rouberol et Christophe Pichon. Enﬁn, merci aux services
informatique et administratif de l’IAP, en particulier à Isabelle Guillerme et Olivia Leroy pour la gestion de
mes missions.
Je voudrais exprimer ma reconnaissance à l’École polytechnique pour une formation hors pair. Tout par-
ticulièrement, je dois à certains professeurs de m’avoir ouvert les yeux sur la relativité, l’astrophysique et la
cosmologie, et d’avoir partagé avec moi leur vision de la recherche : Francis Bernardeau, David Langlois et
Martin Lemoine. Merci à Fabio Iocco d’avoir guidé mes premiers pas dans le monde de la recherche, et à tous

ix
les professeurs de la première promotion du M2 Physique des Hautes Énergies à l’X, en particulier aux directeurs
Ignatios Antoniadis et Jean-Claude Brient, de m’avoir engagé sur la bonne voie pour commencer cette thèse.
Pour leur suivi pendant ces trois ans, merci à l’ED 127 et à la commission des thèses de physique, en particulier,
respectivement, à Florence Durret et Benoît Semelin.
Bisous à mes amis de longue date (je ne suis pas sûr que vous pensiez trouver votre nom ici !): les BIP
Antoine (comment vont les caribous ?), Sébastien, Nico, Vincent, Arnaud et Nicopathe; Alex et Élise – plus un
p’tit gars dont je ne connais pas encore le prénom au moment d’écrire ces lignes; Thomas et Agathe; Amandine,
Arnaud et Aymeric; Anaëlle, Justin, Kéan et Aaron; Manuela, Thibaut, Marine, Clotilde, Benji, Julien, Samuel,
Stéphane, et tous les autres. Merci pour les soirées, les vacances, les jeux, et pour me rappeler que s’évader
n’est pas uniquement faire de la cosmologie.
« Vivre d’orgies est ma seule espérance, le seul bonheur que j’aie pu conquérir. C’est sur les ﬂots qu’j’ai
passé mon enfance, c’est sur les ﬂots qu’un forban doit mourir. » Une pensée très particulière pour les corsaires
de la Ciotat et les bretteurs de l’X: Cap’taine Daniel; mes diﬀérents partenaires Kornichon, Sasha, Seva, et
Daniel le Savant; Emmanuel le Gaucher, Guillaume la Montagne, Charles Ventre-Sec, Dino l’Italien, Lauriane
Joli-cœur, Céline Fleur d’épine, Benoît la Grenouille; et tous les corsaires ciotadens. Merci pour les combats,
l’ambiance et les chants. May your swords stay sharp!
Enﬁn, il conviendrait sûrement d’exprimer ma reconnaissance à ma famille, mais ce que j’aurais à leur dire
va bien au-delà de ce qu’il est possible d’écrire ici.
My ﬁnal thanks go to you, the reader. If you are reading this thesis linearly, you have already read 9 pages
and only have 228 to go. I hope the galaxies shine brightly over you through the rest of your life!
Florent Leclercq
Paris, September 2015


Contents
Introduction
1
I
Morphology and dynamics of the large-scale structure
5
1
Cosmological perturbations and structure formation
7
1.1
The homogeneous Universe
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
8
1.2
Statistical description of cosmological ﬁelds . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
1.2.1
Average and ergodicity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
1.2.2
Statistical homogeneity and isotropy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
1.2.3
Gaussian and log-normal random ﬁelds in cosmostatistics . . . . . . . . . . . . . . . . . .
10
1.2.4
Correlation functions and power spectra . . . . . . . . . . . . . . . . . . . . . . . . . . . .
12
1.3
Dynamics of gravitational instability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
15
1.3.1
The Vlasov-Poisson system . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
16
1.3.2
Fluid dynamics approach, evolution equations in phase space . . . . . . . . . . . . . . . .
17
1.3.3
The single-stream approximation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
18
1.4
Eulerian perturbation theory
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
18
1.4.1
Eulerian linear perturbation theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
18
1.4.2
The growth of ﬂuctuations in linear theory
. . . . . . . . . . . . . . . . . . . . . . . . . .
19
1.4.3
Eulerian perturbation theory at higher order
. . . . . . . . . . . . . . . . . . . . . . . . .
21
1.5
Lagrangian perturbation theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
22
1.5.1
Lagrangian ﬂuid approach for cold dark matter . . . . . . . . . . . . . . . . . . . . . . . .
22
1.5.2
The Zel’dovich approximation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
23
1.5.3
Second-order Lagrangian perturbation theory . . . . . . . . . . . . . . . . . . . . . . . . .
24
1.6
Non-linear approximations to gravitational instability
. . . . . . . . . . . . . . . . . . . . . . . .
25
1.6.1
The Zel’dovich approximation as a non-linear approximation
. . . . . . . . . . . . . . . .
25
1.6.2
Other velocity potential approximations . . . . . . . . . . . . . . . . . . . . . . . . . . . .
26
1.6.3
The adhesion approximation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
26
2
Numerical diagnostics of Lagrangian perturbation theory
29
2.1
Correlation functions of the density ﬁeld . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
30
2.1.1
One-point statistics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
30
2.1.2
Two-point statistics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
31
2.1.3
Three-point statistics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
34
2.2
Statistics of the Lagrangian displacement ﬁeld . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
37
2.2.1
Lagrangian ψ versus Eulerian δ: one-point statistics . . . . . . . . . . . . . . . . . . . . .
37
2.2.2
Perturbative and non-perturbative prescriptions for ψ
. . . . . . . . . . . . . . . . . . . .
41
2.2.3
Non-linear evolution of ψ and generation of a vector part
. . . . . . . . . . . . . . . . . .
43
2.3
Comparison of structure types in LPT and N-body dynamics . . . . . . . . . . . . . . . . . . . .
44
II
Bayesian large-scale structure inference
47
3
Bayesian cosmostatistics
49
3.1
Introduction: plausible reasoning . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
49
3.1.1
On the deﬁnition of probability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
50
3.1.2
On parameter determination
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
50
3.1.3
Probability theory as extended logic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
50
3.2
Inverse problems and the mechanism of experimental learning . . . . . . . . . . . . . . . . . . . .
51
3.2.1
What is Bayesian analysis? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
52
3.2.2
Prior choice . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
52
3.3
Bayesian data analysis problems
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
54

xii
Contents
3.3.1
First level analysis: Bayesian parameter inference . . . . . . . . . . . . . . . . . . . . . . .
54
3.3.2
Exploration of the posterior . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
54
3.3.3
Second level analysis: Bayesian model comparison
. . . . . . . . . . . . . . . . . . . . . .
56
3.4
Markov Chain Monte Carlo techniques for parameter inference
. . . . . . . . . . . . . . . . . . .
58
3.4.1
Markov Chains . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
58
3.4.2
The Metropolis-Hastings algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
59
3.4.3
Hamiltonian Monte Carlo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
60
4
Physical large-scale structure inference with the BORG algorithm
63
4.1
The challenge: the curse of dimensionality . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
64
4.1.1
Sparse sampling
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
64
4.1.2
Shape of high-dimensional pdfs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
65
4.1.3
Algorithms in high dimensions
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
65
4.2
The BORG data model
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
66
4.2.1
The physical density prior . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
67
4.2.2
The large-scale structure likelihood . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
68
4.2.3
The posterior distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
71
4.2.4
The Γ-distribution for noise sampling
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
71
4.3
Sampling procedure and numerical implementation . . . . . . . . . . . . . . . . . . . . . . . . . .
72
4.3.1
Calibration of the noise level
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
72
4.3.2
Hamiltonian Monte Carlo and equations of motion for the LSS density . . . . . . . . . . .
72
4.3.3
The mass matrix . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
73
4.3.4
The leapfrog scheme integrator . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
73
4.4
Testing BORG
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
74
4.4.1
Generating mock observations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
74
4.4.2
Convergence and correlations of the Markov Chain . . . . . . . . . . . . . . . . . . . . . .
74
4.4.3
Large-scale structure inference
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
75
4.5
Future extensions of BORG . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
75
5
Past and present cosmic structure in the Sloan Digital Sky Survey
79
5.1
The SDSS galaxy sample
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
80
5.2
The BORG SDSS analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
80
5.3
Inference results
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
82
5.3.1
Inferred 3D density ﬁelds
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
82
5.3.2
Inference of 3D velocity ﬁelds . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
86
5.3.3
Inference of LSS formation histories
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
86
5.4
Summary and conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
89
III
The non-linear regime of structure formation
93
6
Remapping Lagrangian perturbation theory
95
6.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
95
6.2
Method
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
97
6.2.1
Remapping procedure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
97
6.2.2
Comparison of structure types in LPT and in N-body dynamics
. . . . . . . . . . . . . .
99
6.2.3
Improvement of the remapping procedure . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
6.2.4
Remapping function and transfer function . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
6.3
Statistics of remapped ﬁelds . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101
6.3.1
One-point statistics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103
6.3.2
Two-point statistics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
6.3.3
Three-point statistics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
6.4
Discussion and conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106

Contents
xiii
7
Non-linear ﬁltering of large-scale structure samples
109
7.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109
7.1.1
Motivation for non-linear ﬁltering of large-scale structure samples . . . . . . . . . . . . . . 109
7.1.2
Filtering in the ﬁnal conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110
7.1.3
Filtering via constrained simulations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110
7.2
Fully non-linear ﬁltering with Gadget
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110
7.3
Fast non-linear ﬁltering with COLA
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112
7.3.1
The COLA method
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112
7.3.2
Non-linear BORG-COLA realizations
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113
IV
Cosmic web analysis
115
8
Dark matter voids in the SDSS galaxy survey
117
8.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117
8.2
Methodology
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120
8.2.1
Bayesian large-scale structure inference with the BORG algorithm . . . . . . . . . . . . . 120
8.2.2
Generation of data-constrained reconstructions . . . . . . . . . . . . . . . . . . . . . . . . 121
8.2.3
Void ﬁnding and processing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121
8.2.4
Blackwell-Rao estimators for dark matter void realizations . . . . . . . . . . . . . . . . . . 122
8.2.5
Void catalogs for comparison of our results
. . . . . . . . . . . . . . . . . . . . . . . . . . 124
8.3
Properties of dark matter voids . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125
8.3.1
Number function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125
8.3.2
Ellipticity distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126
8.3.3
Radial density proﬁles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127
8.4
Summary and conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128
9
Bayesian analysis of the dynamic cosmic web in the SDSS galaxy survey
131
9.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 132
9.2
Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 134
9.2.1
Bayesian large-scale structure inference with BORG
. . . . . . . . . . . . . . . . . . . . . 134
9.2.2
Non-linear ﬁltering of samples with COLA
. . . . . . . . . . . . . . . . . . . . . . . . . . 135
9.2.3
Classiﬁcation of the cosmic web . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135
9.3
The late-time large-scale structure
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136
9.3.1
Tidal environment . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136
9.3.2
Probabilistic web-type cartography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 137
9.3.3
Volume and mass ﬁlling fractions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 140
9.4
The primordial large-scale structure
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141
9.4.1
Tidal environment . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142
9.4.2
Probabilistic web-type cartography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142
9.4.3
Volume and mass ﬁlling fractions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143
9.5
Evolution of the cosmic web . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143
9.5.1
Evolution of the probabilistic maps . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147
9.5.2
Volume ﬁlling fraction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147
9.5.3
Mass ﬁlling fraction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147
9.6
Summary and Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148
10 Cosmic-web type classiﬁcation using decision theory
149
10.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 149
10.2 Method
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 150
10.3 Maps of structure types in the SDSS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 151
10.4 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 154
Summary, Conclusion and Outlook
155

xiv
Contents
Appendices
161
A Complements on Gaussian random ﬁelds
161
A.1 Characteristic function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 161
A.2 General deﬁnition of a Gaussian random vector . . . . . . . . . . . . . . . . . . . . . . . . . . . . 162
A.3 Some well-known properties of Gaussian random vectors . . . . . . . . . . . . . . . . . . . . . . . 162
A.4 Marginal and conditionals of Gaussian random vectors . . . . . . . . . . . . . . . . . . . . . . . . 163
B Simulating collisionless dark matter ﬂuids
165
B.1
Model equations
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 166
B.1.1
Model equations in the standard PM code . . . . . . . . . . . . . . . . . . . . . . . . . . . 166
B.1.2
Model equations with COLA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 166
B.2
Steps and data structures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 167
B.2.1
Main PM steps . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 167
B.2.2
Deﬁnitions and data structures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 167
B.3
Mesh assignments and interpolations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 168
B.3.1
The mesh assignment function
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 169
B.3.2
Low-pass ﬁltering . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 169
B.3.3
Common mesh assignment schemes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 170
B.3.4
Interpolation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 173
B.4
Poisson equation and accelerations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 173
B.4.1
Solving the Poisson equation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 173
B.4.2
Computation of the accelerations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 174
B.5
Update of positions and momenta
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 175
B.5.1
Time integrators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 175
B.5.2
Kick and Drift operators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 176
B.6
Setting up initial conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 177
B.6.1
The initial Gaussian random ﬁeld . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 177
B.6.2
The high-redshift particle realization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 178
C Cosmic structures identiﬁcation and classiﬁcation algorithms
179
C.1 VIDE: the Void IDentiﬁcation and Examination toolkit
. . . . . . . . . . . . . . . . . . . . . . . 179
C.1.1
Voronoi Tessellation Density Estimation . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179
C.1.2
The watershed algorithm
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 180
C.1.3
Processing and analysis of void catalogs . . . . . . . . . . . . . . . . . . . . . . . . . . . . 180
C.1.4
Radial density proﬁles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181
C.2 The T-web
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181
C.2.1
The tidal tensor
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181
C.2.2
Analogy with the Zel’dovich formalism . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 182
C.2.3
The T-web: original procedure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 182
C.2.4
Extensions of the T-web . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 183
C.2.5
Implementation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 184
C.2.6
Example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 185
Bibliography
187
Index
222

Introduction
“Make your choice, adventurous Stranger,
Strike the bell and bide the danger,
Or wonder, till it drives you mad,
What would have followed if you had.”
— Clive Staples Lewis (1955), The Chronicles of Narnia, The Ma-
gician’s Nephew
Large-scale structure surveys during the age of precision cosmology
Understanding the structure of the Universe at the largest scales is one of the main goals of cosmology.
The existence of such a structure has been suggested by early observational projects aimed at mapping the
distribution of galaxies, which resulted in a number of discoveries of individual elements – ﬁlamentary bridges
between superclusters, and large voids – on scales of tens of megaparsecs (Gregory & Thompson, 1978; Gregory,
Thompson & Tiﬀt, 1981; Kirshner et al., 1981; Zel’dovich, Einasto & Shandarin, 1982). In 1986, the results
of the Center for Astrophysics redshift survey marked a milestone, with the discovery of bubble-like structures
separated by sheets on which galaxies tend to lie (de Lapparent, Geller & Huchra, 1986). These results renewed
interest for large-scale structure cartography, leading to new galaxy catalogs up to a depth of ∼400 Mpc
(Geller & Huchra, 1989; Shectman et al., 1996; Vettolani et al., 1997; Schuecker & Ott, 1991). In spite of
their incompleteness, these maps conclusively conﬁrmed the existence of a large-scale organization of galaxies
into a hierarchical structure, the cosmic web. At the turn of the century, massive surveys, aimed at obtaining
the spectra of hundreds of thousands of galaxies (e.g. the 2dFGRS, Colless et al., 2003; the SDSS, Strauss
et al., 2002; WiggleZ, Drinkwater et al., 2010 or the 2MASS redshift survey, Huchra et al., 2012), mapped large
volumes of the nearby Universe. They allowed to largely increase the completeness of observations and to obtain
large enough samples for statistical analyses. Other observational programs (e.g. DEEP2, Davis et al., 2003,
2007; VVDS, Le Fèvre et al., 2005, 2013; zCOSMOS, Lilly et al., 2007; GAMA, Driver et al., 2009; VIPERS,
Guzzo et al., 2014) focused on targeting galaxies in a smaller area on the sky, but at higher redshift.
In the coming decade, ongoing or planned cosmological programs will measure the distribution of galaxies
at an unprecedented level. These include wide photometric surveys (DES, Dark Energy Survey Collaboration,
2005; HSC, Miyazaki et al., 2012; J-PAS, Benítez et al., 2015; LSST, LSST Science Collaboration, 2009, 2012),
deep spectroscopic surveys (eBOSS; HETDEX, Hill et al., 2008; the Subaru Prime Focus Spectrograph, Takada
et al., 2014; DESI, Schlegel et al., 2011; Abdalla et al., 2012; Levi et al., 2013), and the Euclid (Laureijs et al.,
2011; Amendola et al., 2013) and WFIRST (Green et al., 2012; Spergel et al., 2013) satellites.
How do we compare this avalanche of data to cosmological models? The standard picture of LSS forma-
tion, developed over the last three decades, relies of the gravitational self-evolution of a set of initial density
ﬂuctuations, giving rise to the complex structures observed in galaxy surveys. Extracting the wealth of infor-
mation that surveys contain thus requires a quantitative understanding of both the generation of the initial
seed perturbations and of the dynamics of gravitational instability.
Early Universe physics and generation of the initial conditions of the Uni-
verse
Inﬂation and the Hot Big Bang scenario provide an observationally well-supported physical model for the
initial conditions. The inﬂationary paradigm (see e.g. Baumann, 2011, for a review) is generally favored over
other theories for the origin of seed perturbations, since it also provides explanations for some shortcomings
of the standard Hot Big Bang picture, e.g. the statistical homogeneity and isotropy of the Universe, and the
horizon problem (Guth, 1981; Linde, 1982; Albrecht & Steinhardt, 1982). According to this model, during the
inﬂationary era, the equation of state of the Universe is governed by a potential-dominated quantum scalar ﬁeld
with negative pressure, the so-called inﬂaton ﬁeld. This quantum ﬁeld drives an exponential growth of the cosmic
scale factor. What is remarkable with inﬂation is that the accelerated expansion in the very early Universe
can magnify the vacuum quantum ﬂuctuations of the inﬂaton into macroscopic cosmological perturbations.

2
Introduction
This model naturally provides us with a statistically homogeneous and isotropic density ﬁeld with small, very
nearly Gaussian-distributed, and nearly scale-invariant density perturbations (Guth & Pi, 1982; Hawking, 1982;
Starobinsky, 1982; Bardeen, Steinhardt & Turner, 1983).
Phenomena such as primordial nucleosynthesis (Alpher, Bethe & Gamow, 1948), decoupling and recom-
bination, free-streaming of neutrinos, acoustic oscillations of the photon-baryon plasma, and transition from
radiation to matter domination, come next. They are predicted by the Hot Big Bang model, which remains
a cornerstone of our understanding of the past and present Universe (see e.g. Kolb & Turner, 1990; Peacock,
1999). They change the post-inﬂationary density ﬁeld into what we call the “initial conditions” for gravitational
evolution. Then, during the matter and dark-energy dominated eras, self-gravity and the expansion of the
Universe modify these initial conditions into an evolved density ﬁeld, at ﬁrst through linear transfer and then
through non-linear structure formation.
Due to their quantum origin, the process of generating seed perturbations is stochastic (see e.g. Baumann,
2011, section 2.3). Therefore, a probability distribution function is the most fundamental characterization of
the large-scale structure of the Universe. As a consequence, it is now standard to describe in a probabilistic
way the generation of the initial density ﬂuctuations by the above-mentioned early Universe processes.
Large-scale structure evolution and galaxy formation
According to the current picture of cosmic structure formation, all presently observed structures have their
origins in primordial seed ﬂuctuations. Zel’dovich & Novikov (1983) recognized the central role played by grav-
itational instability. Peebles (1982a, 1984) realized that baryonic models of structure formation are insuﬃcient
to explain observed galaxies morphology and distribution, and consequently proposed the introduction of cold
dark matter. The ensuing controversy between the “top-down” (in which large structures form ﬁrst, then frag-
ment; as is the case when hot dark matter, such as neutrinos, dominates) and “bottom-up” (in which small
structures such as galaxies form ﬁrst, then aggregate; as is the case when cold dark matter dominates) structure
formation scenarios was subsequently settled in favor of the latter (Bond, Szalay & Turner, 1982; Melott et al.,
1983; Blumenthal et al., 1984). Therefore, it is currently believed that structure formation is mostly governed
by the gravitational aggregation of a dark matter ﬂuid. As proposed by Rees & Ostriker (1977); Silk (1977);
White & Rees (1978), luminous objects such as galaxies form via condensation and cooling of baryonic matter
in gravitational potential wells shaped by the dark matter structure.
Physical processes and information content
The detailed appearance of the presently observed galaxy distribution contains a record of its origin and
formation history. Large-scale structure formation therefore encodes information on a wide range of processes
involving very diﬀerent physics, ranging from quantum ﬁeld theory and general relativity, to the dynamics of
collisionless dark matter and the hydrodynamics and radiation transfer processes involved in galaxy formation.
The next generation of galaxy surveys is therefore expected to provide insights into many fundamental physics
questions: What is the Universe made of? What is the microphysics of dark matter? How does dark energy
behave? What is the mass of neutrinos? Is general relativity complete or does it require modiﬁcations? What
were the conditions in the early Universe?
All LSS observations are informative in some ways about these questions, but due to an incomplete under-
standing of the dark matter-galaxy connection (the “bias problem”: see in particular the “peak-background
split model”, Bardeen et al., 1986; Cole & Kaiser, 1989, and the “halo model”, Seljak, 2000; Peacock & Smith,
2000; Cooray & Sheth, 2002) and observational eﬀects (the Alcock-Paczynski eﬀect, Alcock & Paczynski, 1979;
redshift-space distortions, Kaiser, 1987; Peacock et al., 2001; Hawkins et al., 2003; Guzzo et al., 2008; non-
trivial selection functions; see e.g. Percival, 2014, for a review), the message is encoded and sometimes hard to
extricate. Hence, crucial to the aim of answering the above questions is identifying where is the information
content and developing eﬃcient tools to extract it.
The usual strategy is to look at the shape and length scales imprinted in the galaxy power spectrum, such
as the baryon acoustic oscillation scale (Percival et al., 2001; Cole et al., 2005; Eisenstein et al., 2005; Percival
et al., 2010). However, at small scales and at late times, non-linear dynamics shifts the information content away
from the two-point function to the higher-order correlators. One of the main goals of this thesis is to access
the untapped information in late-time, non-linear modes. The number of modes accessible for cosmological

Introduction
3
analyses grows like k3, where k is the largest usable wavenumber. In the case of BAOs, a technique known as
“reconstruction” has been designed to correct for the eﬀects of non-linearities, and has been shown to improve
distance measurements (Eisenstein et al., 2007; Padmanabhan et al., 2012). Hence, our strategy is twofold:
pushing down the smallest scale that can be both modeled and resolved; and inferring the initial conditions that
give rise to the observed LSS. The reward for undertaking this project is a potentially vast gain of information
for the determination of model parameters.
The scientiﬁc method and the process of data assimilation
Generally, contact between theory and observations cannot be established directly. Historically, scientiﬁc
progress relied on experimental assessment (the “ﬁrst paradigm” of science) and theoretical modeling (the “sec-
ond paradigm”). In the last few decades, with growing complexity of the real-world processes to be described,
testable predictions of theories often had to be obtained through numerical simulations of phenomena. Addi-
tionally, even elaborate experiments do not allow for direct comparison to the results of simulations, due to
the fact that there exists no ideal observation in reality, as they are subject to a variety of uncertainties. One
has to model the response functions of devices and treat their outputs, a step we refer to as signal processing
(for example, the representation of a real-world signal and the application of fast Fourier transforms require its
computer representation to be discrete both in conﬁguration and in frequency space). Numerical simulations
and data processing constitute the “third paradigm” of science. Their outputs are compared to judge and eval-
uate current models. These results can be used to perform inferences, i.e. update our knowledge on theoretical
parameters, test hypotheses and compare competing models. They can also be used to optimize the design of
new experiments. These last two steps close loops that go from theory to data, and from data to theory, as
illustrated in ﬁgure 1. Scientiﬁc progress in any of the physical sciences crucially depends on these steps.
Evaluation
Simulation
Data processing
Theoretical
modeling
Observations,
Experiments
Inference
Experimental Design
Figure 1: Diagram illustrating steps in the scientiﬁc method. Progress in physical sciences depends on each of these
steps: experimental assessment (the ﬁrst paradigm), theoretical modeling (the second paradigm), computational studies
(simulation of phenomena and data processing – the third paradigm). The outputs of simulations and data processing
are compared to judge and evaluate current models. These results are used to infer theoretical parameters and to design
new experiments. The yellow rectangle shows the emergence of a fourth research paradigm: data-intensive scientiﬁc
discovery, where extremely large data sets captured by instruments and generated by complex simulations are used.
Several authors are now describing the emergence of a so-called “fourth paradigm” of research: data-intensive
scientiﬁc discovery (Microsoft Research, 2009; Szalay, 2014). Scientiﬁc insights are wrested from extremely vast
data sets. This transition from hypothesis-driven to data-driven research is made possible by new technologies for
gathering, processing, manipulating, analyzing, mining, and displaying data. For example, exascale computers,
expected around 2018, will be of the order of processing power of the human brain at the neural level.
This thesis falls within the context of this emerging fourth paradigm. Its ﬁeld is cosmostatistics, the discipline
that uses stochastic quantities as seeds of structure to make the connection between cosmological models and
observations.
This area is at the interface between theory and observational data (see Leclercq, Pisani &
Wandelt, 2014):
• It consists of predicting cosmological observables from stochastic quantities as seeds of structure in the
Universe (from theory to data). Theoretical hypotheses are used to model, predict and anticipate results.

4
Introduction
• It uses the departures from homogeneity and isotropy, observed in astronomical surveys, to distinguish be-
tween cosmological models (from data to theory). Data sets are used to infer parameters of the theoretical
models and to compare their relative suitability.
More speciﬁcally, this work focuses on the process of data assimilation for the large-scale structure, i.e. the
process by which observations are incorporated into a numerical model of a real system. Data assimilation
is a ﬁeld of statistics, widely understood and used outside of astrophysics (e.g. in meteorology, geophysics,
oceanography and climate sciences). The general mechanism consists of iteratively correcting the state of a
prediction based on a physical model, using successive observations. In this work, we borrow ideas from these
sciences and apply them to large-scale structure data analysis. For all quantities of interest, we do not only
provide a best-guess estimate, but fully account for all credible regions by a detailed quantiﬁcation of the
probability density.
Goal and structure of this thesis
The ambition of this work is to describe progress towards enriching the standard for the analysis of galaxy
surveys. The central ingredient is the recently proposed borg (Bayesian Origin Reconstruction from Galaxies,
Jasche & Wandelt, 2013a; Jasche, Leclercq & Wandelt, 2015) algorithm. borg is a Bayesian data assimilation
code, which provides a fully probabilistic, physical model of the non-linearly evolved density ﬁeld as probed by
LSS surveys.
The goal of this thesis is to demonstrate that Bayesian large-scale structure inference with the borg al-
gorithm has moved beyond the proof-of-concept stage. In particular, it describes the ﬁrst application to real
cosmological data from the Sloan Digital Sky Survey, and shows how these results can be used for cosmic web
classiﬁcation and analysis.
This thesis is organized as follows. Part I focuses on the analytical and numerical description of the mor-
phology and growth of the LSS. Chapter 1 is an introduction to the theory of structure formation, as relevant
for this thesis. As Lagrangian perturbation theory is a key ingredient of the borg algorithm, the reliability of
its numerical predictions is investigated in chapter 2.
Part II introduces Bayesian large-scale structure inference.
In chapter 3, we present the framework of
Bayesian probability theory. Chapter 4 reviews the latest version of the borg algorithm and its implementation.
Chapter 5 presents the application of borg to the Sloan Digital Sky Survey data. These results quantify the
distribution of initial conditions as well as the possible formation history of the observed structures.
As LSS surveys contain a wealth of information that cannot be trivially extracted due to the non-linear dy-
namical evolution of the density ﬁeld, part III discusses methods designed to improve upon standard techniques
by including non-Gaussian and non-linear data models for the description of late-time structure formation.
Chapter 6 presents a computationally fast and ﬂexible model of mildly non-linear density ﬁelds via the tech-
nique of remapping LPT. In chapter 7, we introduce the concept of non-linear ﬁltering, designed to improve
LSS samples at non-linear scales.
Finally, part IV exploits the borg SDSS analysis for diﬀerent cosmographic projects aiming at characterizing
and analyzing the cosmic web. Chapter 8 demonstrates that the inference of voids in the dark matter distribution
is possible, and that, in addition, our method yields a drastic reduction of statistical uncertainty in void catalogs.
In chapter 9, we describe a probabilistic classiﬁcation of the dynamic cosmic web into four distinct components:
voids, sheets, ﬁlaments, and clusters. Subsequently, chapter 10 introduces a new decision criterion for labeling
diﬀerent regions, on the basis of posterior probabilities and the strength of data constraints.
In the last chapter, we summarize our results and give our conclusions. Prospective applications and possible
directions for future investigations are also mentioned.
The appendices provide complementary material: a mathematical exposition of Gaussian random ﬁelds (ap-
pendix A), a review of the particle-mesh technique for dark matter simulations (appendix B), and a description
of the cosmic web analysis algorithms used in this thesis (appendix C).

Part I
Morphology and dynamics of the
large-scale structure


Chapter 1
Cosmological perturbations and structure
formation
Contents
1.1
The homogeneous Universe
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
8
1.2
Statistical description of cosmological ﬁelds
. . . . . . . . . . . . . . . . . . . . . . . .
9
1.2.1
Average and ergodicity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
1.2.2
Statistical homogeneity and isotropy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
1.2.3
Gaussian and log-normal random ﬁelds in cosmostatistics . . . . . . . . . . . . . . . . . . .
10
1.2.4
Correlation functions and power spectra . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
12
1.3
Dynamics of gravitational instability . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
15
1.3.1
The Vlasov-Poisson system
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
16
1.3.2
Fluid dynamics approach, evolution equations in phase space . . . . . . . . . . . . . . . . .
17
1.3.3
The single-stream approximation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
18
1.4
Eulerian perturbation theory
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
18
1.4.1
Eulerian linear perturbation theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
18
1.4.2
The growth of ﬂuctuations in linear theory
. . . . . . . . . . . . . . . . . . . . . . . . . . .
19
1.4.3
Eulerian perturbation theory at higher order
. . . . . . . . . . . . . . . . . . . . . . . . . .
21
1.5
Lagrangian perturbation theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
22
1.5.1
Lagrangian ﬂuid approach for cold dark matter . . . . . . . . . . . . . . . . . . . . . . . . .
22
1.5.2
The Zel’dovich approximation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
23
1.5.3
Second-order Lagrangian perturbation theory . . . . . . . . . . . . . . . . . . . . . . . . . .
24
1.6
Non-linear approximations to gravitational instability
. . . . . . . . . . . . . . . . . .
25
1.6.1
The Zel’dovich approximation as a non-linear approximation
. . . . . . . . . . . . . . . . .
25
1.6.2
Other velocity potential approximations . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
26
1.6.3
The adhesion approximation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
26
“For the mind wants to discover by reasoning what exists in the
inﬁnity of space that lies out there, beyond the ramparts of this
world – that region into which the intellect longs to peer and into
which the free projection of the mind does actually extend its ﬂight.”
— Lucretius, De Rerum Natura
Abstract
This chapter provides an overview of the current paradigm of cosmic structure formation, as relevant for this thesis.
It also reviews standard tools for large-scale structure analysis.
This chapter is organized as follows. In section 1.1, key equations of general relativistic Friedmann-Lemaître
cosmological models are brieﬂy reviewed, followed by a discussion of the statistical description of cosmological
ﬁelds in section 1.2 and of the dynamics of gravitational instability in section 1.3. In section 1.4 and 1.5 we
describe cosmological perturbation theory in Eulerian and Lagrangian descriptions. Finally, section 1.6 deals
with various non-linear approximations to gravitational instability.

8
Chapter 1. Cosmological perturbations and structure formation
1.1
The homogeneous Universe
This section provides an overview of the standard picture of cosmology, describing the homogeneous evolution
of the Universe. In particular, we reproduce some very standard equations around which perturbation theory
will be implemented in the following. A demonstration can be found in any introduction to cosmology, see for
example Peebles (1980); Kolb & Turner (1990); Liddle & Lyth (2000); Bernardeau et al. (2002); Lesgourgues
(2004); Trodden & Carroll (2004); Langlois (2005, 2010).
Let a be the cosmic scale factor, normalized to unity at the present time: a0 = 1. We denote by t the
cosmic time, by τ the conformal time, deﬁned by dt = a(τ) dτ, and by z the redshift, deﬁned by a = 1/(1 + z).
In the following, a dot denotes a diﬀerentiation with respect to t and a prime a diﬀerentiation with respect to
τ. Friedmann’s equations, describing the dynamics of the Universe, are derived from Einstein’s equations of
general relativity. In conformal time, they read:
H2
=
8πG
3
a2ρ −k,
(1.1)
and
H′
=
−4πG
3
a2(ρ + 3P),
(1.2)
where H ≡a′/a = aH is the conformal expansion rate, H ≡˙a/a is the Hubble parameter, ρ the total energy
density and P the pressure. k is the reduced curvature parameter, taking one of the following values: −1 for an
open universe, 0 for a ﬂat universe, 1 for a closed universe. G denotes the gravitational constant, and we adopt
units such that c = 1.
As a direct consequence, Friedmann’s equations immediately determine the evolution of the energy density,
described as:
ρ′ = −3H(ρ + P).
(1.3)
Throughout this thesis, we will particularly focus on the eras of matter domination and dark-energy domi-
nation within the standard ΛCDM paradigm. Hence, we will consider that the content of the Universe is limited
to two components: matter (mostly cold dark matter) and dark energy in the form of a cosmological constant
Λ. We denote by ρm and ρΛ ≡Λ/8πG their respective energy densities. Introducing their respective equations
of state, wi ≡Pi/ρi, we have w ≈0 for cold dark matter and w = −1 for the cosmological constant. For this
cosmology, equation (1.2) reads
H′ = −4πG
3
a2ρm + 8πG
3
a2ρΛ.
(1.4)
It is convenient to introduce the dimensionless cosmological parameters as the ratio of density to critical
density, ρcrit(t)
≡
3H2(t)/8πG, which corresponds to the total energy density in a ﬂat universe: Ωm(t) ≡
8πGρm(t)/3H2(t) and ΩΛ(t) ≡8πGρΛ/3H2(t) = Λ/3H2(t). Their expression in terms of conformal time is
given by
Ωm(τ)H2(τ)
=
8πG
3
ρm(τ)a2(τ),
(1.5)
ΩΛ(τ)H2(τ)
=
8πG
3
ρΛa2(τ) ≡Λ
3 a2(τ).
(1.6)
Note that Ωm(τ) and ΩΛ(τ) are time-dependent. Inserting these two expressions in equation (1.4) yields the
following form of the second Friedmann equation,
H′(τ) =

−Ωm(τ)
2
+ ΩΛ(τ)

H2(τ),
(1.7)
and the ﬁrst one reads
H2 = 8πG
3
a2ρm + 8πG
3
a2ρΛ −k = ΩmH2 + ΩΛH2 −k,
(1.8)
which yields
k = (Ωtot(τ) −1)H2(τ),
(1.9)
where Ωtot(τ) ≡Ωm(τ) + ΩΛ(τ). In the following, we will note Ω(0)
m = Ωm(a = 1) and Ω(0)
Λ
= ΩΛ(a = 1).

1.2. Statistical description of cosmological ﬁelds
9
1.2
Statistical description of cosmological ﬁelds
In this section, we consider some cosmic scalar ﬁeld λ(x) whose statistical properties are to be described. It
denotes either the cosmological density contrast, δ(x), the gravitational potential, Φ(x) (see section 1.3), or any
other ﬁeld of interest derived from vectorial ﬁelds (e.g. the velocity divergence ﬁeld), polarization ﬁelds, etc.
As discussed in the introduction, values of λ(x) have to be treated as stochastic variables. For an arbitrary
number n of spatial positions xi, one can deﬁne the joint multivariate probability distribution function to have
λ(x1) between λ1 and λ1 + dλ1, λ(x2) between λ2 and λ2 + dλ2, etc. This pdf is written
P(λ1, λ2, ..., λn) dλ1dλ2 ... dλn.
(1.10)
1.2.1
Average and ergodicity
Average.
The word “average” (and in the following, the corresponding ⟨⟩symbols) may have two diﬀerent
meanings. First, one can average by taking many realizations drawn from the distribution, all of them produced
in the same way (e.g. by N-body simulations). This is the ensemble average, deﬁned to be for any quantity
X(λ1, λ2, ..., λn):
⟨X⟩≡
Z
X(λ1, λ2, ..., λn)P(λ1, λ2, ..., λn) dλ1dλ2 ... dλn,
(1.11)
where P(λ1, λ2, ..., λn) is the joint multivariate pdf.
One can also average by considering the quantity of interest at diﬀerent locations within the same realization
of the distribution. This is the sample average. For some volume V in the Universe, the sample average over V
of a quantity X is deﬁned to be:
¯X ≡1
V
Z
V
X(x) d3x.
(1.12)
Ergodicity.
If the ensemble average of any quantity coincides with the sample average of the same quantity,
the system is said to be ergodic. In cosmology, the hypothesis of ergodicity is often adopted, at least if the
considered catalogue is large enough. For instance, if ergodicity holds, the mean density of the Universe is given
by
⟨ρ(x)⟩= ¯ρ ≡1
V
Z
V
ρ(x) d3x,
(1.13)
in the limit where V →∞. The term of ergodicity historically refers to time processes, not to spatial ones. If
the above property is fulﬁlled in cosmology, one says that the system is a fair sample of the Universe.1
1.2.2
Statistical homogeneity and isotropy
A random ﬁeld is said to be statistically homogeneous if all joint multivariate pdfs P(λ(x1), λ(x2), ..., λ(xn))
are invariant under translations of the coordinates x1, x2, ..., xn in space. Thus probabilities depend only
on relative positions, but not on locations. Note that statistical homogeneity is a weaker assumption than
homogeneity, which would mean that λ(x) takes the same value everywhere in space.
Similarly, a random ﬁeld is said to be statistically isotropic if all P(λ(x1), λ(x2), ..., λ(xn)) are invariant
under spatial rotations.
From now on, cosmic ﬁelds will be considered statistically homogeneous and isotropic, as a consequence of
the cosmological principle that underlies most inﬂationary calculations (see Guth, 1981; Linde, 1982; Albrecht
& Steinhardt, 1982; Linde, 1995), and of standard gravitational evolution (e.g. Peebles, 1980). Of course, the
validity of this assumption has to be checked against observational data. It is also important to note that
a lot of the information from galaxy surveys comes from eﬀects that distort the observed signal away from
this ideal. In particular, observational eﬀects such as the Alcock-Paczynski eﬀect (Alcock & Paczynski, 1979)
and redshift-space distortions (Kaiser, 1987) in galaxy surveys introduce signiﬁcant deviations from statistical
homogeneity and isotropy.
1 In the case of the LSS, care should be taken with deep surveys. Indeed, as data lie on the surface of the relativistic lightcone,
we cannot have access to a fair sample of the Universe at the present time. Rigorously, ergodicity is not veriﬁed.

10
Chapter 1. Cosmological perturbations and structure formation
1.2.3
Gaussian and log-normal random ﬁelds in cosmostatistics
This section draws from subsection 2.2 of Leclercq, Pisani & Wandelt (2014).
Gaussian random ﬁelds are ubiquitous in cosmostatistics (see Lahav & Suto, 2004; Wandelt, 2013; Leclercq,
Pisani & Wandelt, 2014, for reviews). Indeed, as mentioned in the introduction, inﬂationary models predict the
initial density perturbations to arise from a large number of independent quantum ﬂuctuations, and therefore
to be very nearly Gaussian-distributed. Even in models which are said to produce “large” non-Gaussianities,
deviations from Gaussianity are strongly constrained by observational tests (see Planck Collaboration, 2014b,
2015, for the latest results). Grfs are essential for the analysis of the cosmic microwave background, but the
large scale distribution of galaxies can also be approximately modeled as a grf, at least on very large scales,
where gravitational evolution is still well-described by linear perturbation theory (see sections 1.4 and 1.5). The
log-normal distribution is convenient for modeling the statistical behavior of evolved density ﬁelds, partially
accounting for non-linear gravitational eﬀects at the level of the one-point distribution.
In the following, we summarize some results about ﬁnite-dimensional Gaussian and log-normal random ﬁelds.
Without loss of generality, inﬁnite-dimensional ﬁelds can be discretized. If the ﬁeld is suﬃciently regular and
the discretization scale is small enough, no information will be lost. In practice, throughout this thesis, any
ﬁeld that we want to describe is already discretized on a grid of particles or voxels. Let us denote the values
of the considered cosmic scalar ﬁeld λ(x) at comoving positions xi as λi ≡λ(xi) for i from 1 to any arbitrary
integer n.
1.2.3.1
Gaussian random ﬁelds
The n-dimensional vector λ = (λi)1≤i≤n is a Gaussian random ﬁeld (we will often say “is Gaussian” in the
following) with mean µ ≡(µi)1≤i≤n and covariance matrix C ≡(Cij)1≤i≤n,1≤j≤n if its joint multivariate pdf is
a multivariate Gaussian:2
P(λ|µ, C) =
1
p
|2πC|
exp

−1
2(λ −µ)∗C−1(λ −µ)

=
1
p
|2πC|
exp

−1
2
n
X
i=1
n
X
j=1
(λi −µi)C−1
ij (λj −µj)

.
(1.14)
where z∗denotes the conjugate transpose of z, vertical bars indicate the determinant of the surrounded matrix
and C is assumed to be a positive-deﬁnite Hermitian matrix (and therefore invertible). In practical cases, µ is
often taken to be zero. As can be seen from this deﬁnition, a grf is completely speciﬁed by its mean µ and its
covariance matrix C.
It is interesting to note that for the density contrast δ(x), the Gaussian assumption has to break down at
later epochs of structure formation since it predicts density amplitudes to be symmetrically distributed among
positive and negative values, but weak and strong energy conditions require δ(x) ≥−1. Even in the initial
conditions, Gaussianity can not be exact due to the existence of this lower bound. The Gaussian assumption is
therefore strictly speaking only valid in the limit of inﬁnitesimally small density ﬂuctuations, |δ(x)| ≪1.
1.2.3.2
Moments of Gaussian random ﬁelds, Wick’s theorem
From equation (1.14) it is easy to check that the mean ⟨λ⟩is really µ and the covariance matrix is really
⟨(λ −µ)∗(λ −µ)⟩= C, just by evaluating the Gaussian integrals:
⟨λi⟩
=
Z
λi P(λ|µ, C) dλi = µi,
(1.15)
⟨(λi −µi)∗(λj −µj)⟩
=
Z
(λi −µi)∗(λj −µj) P(λ|µ, C) dλidλj = Cij.
(1.16)
We now want to compute higher-order moments of a grf. Let us focus on central moments, or equivalently,
let us assume in the following that the mean is µ = 0. Here we omit the star denoting conjugate transpose
for simplicity. Any odd moments, e.g. the third ⟨λiλjλk⟩, the ﬁfth ⟨λiλjλkλlλm⟩, etc. are found to be zero
2 Here we use the common terminology in physics and refer to this pdf as a “multivariate Gaussian”. It is called a “multivariate
normal” distribution in statistics.
Note that it is possible to generalize this deﬁnition to the case where C is only a positive
semi-deﬁnite Hermitian matrix, using the notion of characteristic function (see appendix A).

1.2. Statistical description of cosmological ﬁelds
11
by symmetry of the Gaussian pdf.
The higher-order even ones (e.g.
the fourth, the sixth, etc.)
can be
evaluated through the application of Wick’s theorem, an elegant method of reducing high-order statistics to a
combinatorics problem.
Wick’s theorem states that high-order even moments of a grf are computed by connecting up all possible
pairs of the ﬁeld (Wick contractions) and writing down the covariance matrix for each pair using equation
(1.16). For instance,
⟨λiλjλkλl⟩
=
⟨λiλj⟩⟨λkλl⟩+ ⟨λiλk⟩⟨λjλl⟩+ ⟨λiλl⟩⟨λjλk⟩
=
CijCkl + CikCjl + CilCjk.
(1.17)
The number of terms generated in this fashion for the n-th order moment is Qn/2
i=1(2i −1).
1.2.3.3
Marginals and conditionals of Gaussian random ﬁelds
Let us the split the grf up into two parts x = J1, mK and y = Jm + 1, nK (m < n), so that
λ =
λx
λy

,
µ =
µx
µy

and
C =
Cxx
Cxy
Cyx
Cyy

.
(1.18)
Cxy = (Cyx)∗since C is Hermitian.
Easy computation of marginal and conditional pdfs is a very convenient property of grfs.
First of all,
marginal and conditional densities of grfs are multivariate Gaussians. Therefore, all we need to calculate are
their means and covariances. For the marginal pdfs, the results are
⟨λx⟩
=
µx,
(1.19)
⟨(λx −µx)∗(λx −µx)⟩
=
Cxx,
(1.20)
⟨λy⟩
=
µy,
(1.21)
⟨(λy −µy)∗(λy −µy)⟩
=
Cyy.
(1.22)
These expressions simply mean that the marginal means and marginal covariances are just the corresponding
parts of the joint mean and covariance, as deﬁned by equation (1.18).
Less trivially, here are the parameters of the conditional densities:
µx|y ≡⟨λx|λy⟩
=
µx + CxyC−1
yy (λy −µy),
(1.23)
Cx|y ≡⟨(λx −µx)∗(λx −µx)|λy⟩
=
Cxx −CxyC−1
yy Cyx,
(1.24)
µy|x ≡⟨λy|λx⟩
=
µy + CyxC−1
xx (x −µx),
(1.25)
Cy|x ≡⟨(λy −µy)∗(λy −µy)|λx⟩
=
Cyy −CyxC−1
xx Cxy.
(1.26)
A demonstration of these formulae can be found in appendix A. From these expressions, it is easy to see
that for grfs, lack of covariance (Cxy = 0) implies independence, i.e.
P(x, y) = P(x)P(y).
This is most
certainly not the case for general random ﬁelds. Similarly, if λ1, ..., λn are jointly Gaussian, then each λi is
Gaussian-distributed, but not conversely.
A particular case is the optimal de-noising of a data set d, modeled as the sum of some signal s and a
stochastic noise contribution n: d = s+n. We model all three ﬁelds d, s, n as grfs. Assuming a vanishing signal
mean, an unbiased measurement (i.e. µd = µs = µn = 0), and lack of covariance between signal and noise (i.e.
Csn = Cns = 0, which implies Csd = Css and Cdd = Css + Cnn), equations (1.23) and (1.24) yield the famous
Wiener ﬁlter equations:
µs|d
=
Css (Css + Cnn)−1 d,
(1.27)
Cs|d
=
Css −Css (Css + Cnn)−1 Css =
 C−1
nn + C−1
ss
−1 .
(1.28)
1.2.3.4
Log-normal random ﬁelds
In the case where δ(x) is the density contrast, gravitational evolution will yield very high positive density
contrast amplitudes. In order to prevent negative mass (δ(x) < −1) while preserving ⟨δ(x)⟩= 0, the resultant

12
Chapter 1. Cosmological perturbations and structure formation
pdf must be strongly skewed (e.g. Peacock, 1999). In the absence of an exact pdf for the density ﬁeld in non-
linear regimes, solution to dynamical equations, one can describe the statistical properties of the evolved matter
distribution by phenomenological probability distributions. A common choice is the log-normal distribution,
which approximates well the one-point behavior observed in galaxy observations and N-body simulations (e.g.
Hubble, 1934; Peebles, 1980; Coles & Jones, 1991; Gaztañaga & Yokoyama, 1993; Colombi, 1994; Kayo, Taruya
& Suto, 2001; Neyrinck, Szapudi & Szalay, 2009). This is the model adopted as a prior for the density ﬁeld in
the hades algorithm (Jasche & Kitaura, 2010; Jasche & Wandelt, 2012, see also table 4.2). The assumption is
that the log-density, ln(1 + δ), instead of the density contrast δ, obeys Gaussian statistics.
If λ is a n-dimensional vector having multivariate Gaussian distribution with mean µ and covariance matrix
C, then ξ, deﬁned by its components ξi = exp(λi), has a multivariate log-normal distribution given by
P(ξ|µ, C) =
1
p
|2πC|
exp

−1
2
n
X
i=1
n
X
j=1
(ln(ξi) −µi)∗C−1
ij (ln(ξj) −µj)

Y
k
1
ξk
.
(1.29)
The mean of ξ is ν deﬁned by
νi ≡⟨ξi⟩= exp

µi + 1
2Cii

,
(1.30)
and its covariance matrix is D deﬁned by
Dij ≡⟨(ξi −µi)∗(ξj −µj)⟩= exp

µi + µj + 1
2(Cii + Cjj)

(exp(Cij) −1) .
(1.31)
In cosmology, we assume that λ = ln(1+δ) is a grf with mean µ and covariance matrix C. Then δ = exp(λ)−1
follows a log-normal distribution, given by
P(δ|µ, C) =
1
p
|2πC|
exp

−1
2
n
X
i=1
n
X
j=1
(ln(1 + δi) −µi)∗C−1
ij (ln(1 + δj) −µj)

Y
k
1
1 + δk
.
(1.32)
To ensure that ⟨δ⟩vanishes everywhere, i.e. that
νi = ⟨1 + δi⟩= exp

µi + 1
2Cii

= 1,
(1.33)
one has to impose the following choice for µ:
µi = −1
2Cii = −1
2C00 = µ0.
(1.34)
We have used that Cii = C00, since the correlation function depends only on distance (assuming statistical
homogeneity and isotropy). Hence, the mean for the lognormal distribution is the same throughout the entire
ﬁeld.
For further discussion on the log-normal behavior of density ﬁelds, see chapters 2 and 6.
1.2.4
Correlation functions and power spectra
1.2.4.1
Two-point correlation function and power spectrum
Deﬁnitions.
The two-point correlation function is deﬁned in conﬁguration space as the joint ensemble average
of the ﬁeld at two diﬀerent locations:
ξ(r) = ⟨λ∗(x)λ(x + r)⟩.
(1.35)
It depends only on the norm of r if statistical isotropy and homogeneity hold.
The scalar ﬁeld λ(x) is usually written in terms of its Fourier components,
λ(x) =
1
(2π)3/2
Z
λ(k) exp(ik · x) d3k,
(1.36)
or, equivalently,
λ(k) =
1
(2π)3/2
Z
λ(x) exp(−ik · x) d3x.
(1.37)

1.2. Statistical description of cosmological ﬁelds
13
The quantities λ(k) are complex random variables. If λ(x) is real, one has λ(−k) = λ∗(k) which means that
half of the Fourier space contains redundant information.
The computation of the two-point correlator for λ(k) in Fourier space gives:

λ∗(k)λ(k′)

=
1
(2π)3/2
1
(2π)3/2
ZZ
⟨λ∗(x)λ(x + r)⟩exp(i(k −k′) · x −ik′ · r) d3x d3r
(1.38)
=
1
(2π)3
ZZ
ξ(r) exp(i(k −k′) · x −ik′ · r) d3x d3r
(1.39)
=
1
(2π)3 δD(k −k′)
Z
ξ(r) exp(ik · r) d3r
(1.40)
≡
1
(2π)3/2 δD(k −k′) P(k),
(1.41)
where δD is a Dirac delta distribution and
P(k) ≡
1
(2π)3/2
Z
ξ(r) exp(ik · r) d3r
(1.42)
is deﬁned to be the power spectrum of the ﬁeld λ(x) (this relation is known as the Wiener-Khinchin theorem).
Because of statistical homogeneity and isotropy, it depends only on the norm of k. The inverse relation between
the two-point correlation function, ξ(r), and the power spectrum, P(k), reads
ξ(r) =
1
(2π)3/2
Z
P(k) exp(−ik · r) d3k.
(1.43)
In spherical coordinates, using
Z
Ω
exp (−ikr cos θ) dΩ=
Z π
θ=0
Z 2π
ϕ=0
exp (−ikr cos θ) sin θ dθ dϕ = 4π sin(kr)
kr
,
(1.44)
we obtain the one-dimensional relations between ξ(r) and P(k),
P(k)
=
2
√π
Z ∞
0
ξ(r) j0(kr) r2 dr,
(1.45)
ξ(r)
=
2
√π
Z ∞
0
P(k) j0(kr) k2 dk,
(1.46)
where j0 is the zero-th order spherical Bessel function,
j0(x) ≡sin(x)
x
.
(1.47)
Two-point probability function and two-point correlation function.
The following physical interpretation of
the two-point correlation function establishes a link between the ensemble average and the sample average. In-
deed, correlation functions are directly related to multivariate probability functions (in fact, they are sometimes
deﬁned from them). Here we exemplify this fact for the density contrast at position x, δ(x) ≡ρ(x)/¯ρ −1.
Let us consider two inﬁnitesimal volumes dV1 and dV2 inside the volume V . Let n1 and n2 be the particle
densities at locations x1 and x2 and n ≡N/V the average numerical density. Then the density contrasts are
δ(x1) = n1/(n dV1) −1 and δ(x2) = n2/(n dV2) −1 and the two-point correlation function reads
ξ(x12) = ⟨δ(x1)δ(x2)⟩=
dN12
n2 dV1 dV2
−1,
(1.48)
where x12 ≡|x2 −x1| and dN12 = ⟨n1n2⟩is the average number of pairs in the volumes dV1 and dV2 (i.e. the
product of the number of particles in one volume times the number in the other volume). One can then rewrite
dN12 = ⟨n1n2⟩= n2 (1 + ξ(x12)) dV1 dV2.
(1.49)
The physical interpretation of the two-point correlation function is that it measures the excess over uniform
probability that two particles at volume elements dV1 and dV2 are separated by a distance x12. If particle

14
Chapter 1. Cosmological perturbations and structure formation
positions are drawn from uniform distributions (i.e. if there is no clustering), then dN12 is independent of the
separation. In this case, the average number of pairs is the product of the average number of particles in the two
volumes, ⟨n1n2⟩= ⟨n1⟩⟨n2⟩= n2 dV1 dV2 and the correlation ξ vanishes. Particles are said to be uncorrelated.
Conversely, if ξ is non-zero, particle distributions are said to be correlated (if ξ > 0) or anti-correlated (if ξ < 0).
It is sometimes easier to derive the correlation function as the average density of particles at a distance r
from another particle, i.e. by choosing the volume element dV1 such as n dV1 = 1. Then the number of pairs is
given by the number of particles in volume dV2:
dN2 = n (1 + ξ(r)) dV2.
(1.50)
Hence, one can evaluate the correlation function as follows:
ξ(r) = dN(r)
n dV
−1 = ⟨n(r)⟩
n
−1,
(1.51)
i.e. as the average number of particles at distance r from any given particle, divided by the expected number
of particles at the same distance in a uniform distribution, minus one. As dN2 is linked to the conditional
probability that there is a particle in dV2 given that there is one in dV1, the previous expression is sometimes
referred to as the conditional density contrast.
Two-point correlation function and power spectrum of Gaussian ﬁelds.
If λ(x) is a real grf of mean 0 and
covariance matrix C, then equation (1.16) means that its two-point correlation function in conﬁguration space
is directly given by the covariance matrix: ⟨λ(xi)λ(xj)⟩= Cij.
Additionally, if λ(x) is also statistically homogeneous, equation (1.41) implies that λ(k) has independent
Fourier modes and that its covariance matrix in Fourier space is diagonal and contains the power spectrum
coeﬃcients P(k)/(2π)3/2. Finally, according to Wick’s theorem (section 1.2.3.2), one can write for any integer
p:
⟨λ(k1) ... λ(k2p+1)⟩
=
0,
(1.52)
⟨λ(k1) ... λ(k2p)⟩
=
X
all pair associations
Y
p pairs (i,j)
⟨λ(ki)λ(kj)⟩
=
X
all pair associations
Y
p pairs (i,j)
δD(ki −kj) P(ki)
(2π)3/2 .
(1.53)
Hence, for grfs, all statistical properties are included in two-point correlations. More speciﬁcally, all statistical
properties of random variables λ(k) are conclusively determined by the shape of the power spectrum P(k).
1.2.4.2
Higher-order correlation functions
Higher-order correlation functions in conﬁguration space.
It is possible to deﬁne higher-order correlation
functions, as the connected part (denoted by a subscript c) of the joint ensemble average of the ﬁeld λ(x) in an
arbitrary number of locations. This can be formally written as
ξn(x1, x2, ..., xn)
=
⟨λ(x1)λ(x2) ... λ(xn)⟩c
(1.54)
≡
⟨λ(x1)λ(x2) ... λ(xn)⟩−
X
S∈P({x1,x2,...,xn})
Y
si∈S
ξ#si(xsi(1), xsi(2), ..., xsi(#si)),
where the sum is made over the proper partitions (any partition except the set itself) of {x1, x2, ..., xn} and si
is a subset of {x1, x2, ..., xn} contained in partition S. When the average of λ(x) is zero, only partitions that
contain no singlets contribute. The decomposition in connected and non-connected parts of the joint ensemble
average of the ﬁeld can be easily visualized in a diagrammatic way (see e.g. Bernardeau et al., 2002).
For grfs, as a consequence of Wick’s theorem (section 1.2.3.2), all connected correlations functions are zero
except ξ2.

1.3. Dynamics of gravitational instability
15
Higher-order correlators in Fourier space.
This deﬁnition in conﬁguration space can be extended to Fourier
space. By statistical isotropy of the ﬁeld, the n-th Fourier-space correlator does not depend on the direction
of the k-vectors.
By statistical homogeneity, the k-vectors have to sum up to zero.
We can thus deﬁne
Pn(k1, k2, ..., kn) by
⟨λ(k1)λ(k2) ... λ(kn)⟩c ≡δD(k1 + k2 + ... + kn) Pn(k1, k2, ..., kn).
(1.55)
The Dirac delta distribution δD ensures that k-vector conﬁgurations form closed polygons: P
i ki = 0.
Let us now examine the lowest-order connected moments.
Bispectrum.
After the power spectrum, the second statistic of interest is the bispectrum B, for n = 3, deﬁned
by
⟨λ(k1)λ(k2)λ(k3)⟩= ⟨λ(k1)λ(k2)λ(k3)⟩c ≡δD(k1 + k2 + k3) B(k1, k2, k3).
(1.56)
Reduced bispectrum.
It is convenient to deﬁne the reduced bispectrum Q(k1, k2, k3) as
Q(k1, k2, k3) ≡
B(k1, k2, k3)
P(k1)P(k2) + P(k1)P(k3) + P(k2)P(k3),
(1.57)
which takes away most of the dependence on scale and cosmology.
The reduced bispectrum is useful for
comparing diﬀerent models, because its weak dependence on cosmology is known to break degeneracies between
cosmological parameters and to isolate the eﬀects of gravity (see Gil-Marín et al., 2011, for an example).
Trispectrum.
The trispectrum is the following correlator, for n = 4. It is deﬁned as
⟨λ(k1)λ(k2)λ(k3)λ(k4)⟩c ≡δD(k1 + k2 + k3 + k4) T(k1, k2, k3, k4).
(1.58)
1.3
Dynamics of gravitational instability
The standard picture for the formation of the LSS as seen in galaxy surveys is the gravitational ampliﬁcation
of primordial density ﬂuctuations. The dynamics of this process is mostly governed by gravitational interactions
of collisionless (or at least, weakly-interacting) dark matter particles in an expanding universe.
For scales much smaller than the Hubble radius, relativistic eﬀects (such as the curvature of the Universe
or the apparent distance-redshift relation) are believed to be subdominant or negligible (e.g. Kolb & Turner,
1990, and references therein) and as we will show, the expansion of the background can be factored out by a
redeﬁnition of variables. Although the microscopic nature of dark matter particles remains unknown, candidates
have to pass several tests in order to be viable (Taoso, Bertone & Masiero, 2008). In particular, particles which
are relativistic at the time of structure formation lead to a large damping of small-scale ﬂuctuations (Silk,
1968; Bond & Szalay, 1983), incompatible with observed structures. The standard theory thus requires dark
matter particles to be cold during structure formation, i.e. non-relativistic well before the matter-dominated
era (Peebles, 1982b; Blumenthal et al., 1984; Davis et al., 1985). For these two reasons, at scales much smaller
than the Hubble radius the equations of motion can be well approximated by Newtonian gravity.
In addition, all dark matter particle candidates are extremely light compared to the mass of typical astro-
physical objects such as stars or galaxies, with an expected number density of a least 1050 particles per Mpc3.
Therefore, discreteness eﬀects are negligible and collisionless dark matter can be well described in the ﬂuid limit
approximation.
In this section, we present the dynamics of gravitational instability in the framework of Newtonian gravity
within a ﬂat, expanding background and in the ﬂuid limit approximation. It is of course possible to do a detailed
relativistic treatment of structure formation dynamics and cosmological perturbation theory (Bardeen, 1980;
Mukhanov, Feldman & Brandenberger, 1992) and to derive the Newtonian limit from general relativity (see e.g.
Peebles, 1980).

16
Chapter 1. Cosmological perturbations and structure formation
1.3.1
The Vlasov-Poisson system
The cosmological Poisson equation.
Let us consider a large number of particles that interact only gravita-
tionally in an expanding universe. For a particle of velocity v at position r, the action of all other particles can
be treated as a smooth gravitational potential induced by the local mass density ρ(r),
φ(r) = G
Z ρ(r′ −r)
|r′ −r| d3r′,
(1.59)
and the equation of motion reads
dv
dt = −∇rφ = G
Z ρ(r′ −r) (r′ −r)
|r′ −r|3
d3r′.
(1.60)
Examining gravitational instabilities in the context of an expanding universe requires to consider the departure
from the homogeneous Hubble ﬂow. It is natural to describe the positions of particles in terms of their comoving
coordinates x such that the physical coordinates are r = ax and of the conformal time τ, deﬁned by dt = a(τ) dτ.
Hereafter, when there is no ambiguity, we will denote ∇≡∇x and ∆≡∆x. The Jacobian of the spatial
coordinate transformation is |J| = a3 so that the right-hand side of the previous equation becomes
G
Z ρ(r′ −r) (r′ −r)
|r′ −r|3
d3r′
=
G
Z ρ(x′ −x) a (x′ −x)
a3|x′ −x|3
a3 d3x′
(1.61)
=
Ga¯ρ
Z
(x′ −x)
|x′ −x|3 d3x′ + Ga¯ρ
Z
δ(x′ −x) (x′ −x)
|x′ −x|3 d3x′,
(1.62)
where we have introduced the density contrast δ(x), deﬁned as
ρ(x, t) ≡¯ρ(t) [1 + δ(x, t)] ,
(1.63)
where ¯ρ(t) ∝1/a3 (consequence of equation (1.3) with w = 0).
Velocities of particles are v = ˙ax + a dx/dt, permitting us to deﬁne peculiar velocities as the diﬀerence
between total velocities and the Hubble ﬂow:
u ≡a dx
dt = v −˙ax.
(1.64)
dv/dt is written in terms of u as
dv
dt
=
du
dt + ¨ax + ˙a dx
dt
(1.65)
=
du
dt + ¨ax + ˙a
a u.
(1.66)
By the use of the second Friedmann equation for the homogeneous background (equation (1.2)),
¨a = −4πG
3
a¯ρ,
(1.67)
and Gauss’s theorem,
4π
3 x = −
Z
(x′ −x)
|x′ −x|3 d3x′,
(1.68)
the term ¨ax is equal to
Ga¯ρ
Z
(x′ −x)
|x′ −x|3 d3x′ ≡−1
a∇xφ,
(1.69)
which leaves for the peculiar velocity the following equation of motion (see equations (1.60), (1.62) and (1.66)):
du
dt + ˙a
a u = Ga¯ρ
Z
δ(x′ −x) (x′ −x)
|x′ −x|3 d3x′ ≡−1
a∇xΦ.
(1.70)
Here we have deﬁned the cosmological gravitational potential Φ such that φ ≡φ + Φ with, for the background,
φ(x) = 4πG
3
a2¯ρ
1
2|x|2

= −H′
1
2|x|2

,
satisfying
∆φ = 4πGa2¯ρ.
(1.71)

1.3. Dynamics of gravitational instability
17
Using the overall Poisson equation, ∆rφ = ∆φ/a2 = 4πG¯ρ(1+δ), we ﬁnd that Φ follows a cosmological Poisson
equation sourced only by density ﬂuctuations, as expected:
∆Φ = 4πGa2¯ρδ = 3
2Ωm(τ)H2(τ)δ.
(1.72)
The second equality comes from the ﬁrst Friedmann equation in a ﬂat universe (equation (1.1) with k = 0).
The Vlasov equation.
Looking at equation (1.70), the momentum of a single particle of mass m is identiﬁed
as:
p = mau,
(1.73)
and the equation of motion reads:
dp
dt = −m∇xΦ = −ma∇rΦ
or
dp
dτ = −ma∇xΦ.
(1.74)
Let us now deﬁne the particle number density in phase space by f(x, p, τ).
Phase-space conservation and
Liouville’s theorem imply the Vlasov equation (collisionless version of the Boltzmann equation):
df
dτ = ∂f
∂τ + p
ma · ∇f −ma∇Φ · ∂f
∂p = 0.
(1.75)
Given equations (1.72) and (1.75), the Vlasov-Poisson system is closed.
1.3.2
Fluid dynamics approach, evolution equations in phase space
The Vlasov equation is very diﬃcult to solve, since it is a partial diﬀerential equation involving seven
variables, with non-linearity induced by the dependence of the potential Φ on the density through the Poisson
equation. Its complicated structure prevents the analytic analysis of dark matter dynamics. In practice, we are
usually not interested in solving the full phase-space dynamics, but only the evolution of the spatial distribution.
It is therefore convenient to take momentum moments of the distribution function. This yields a ﬂuid dynamics
approach for the motion of collisionless dark matter. The zeroth-order momentum, by construction, relates the
phase-space density to the density ﬁeld,
Z
f(x, p, τ) d3p ≡ρ(x, τ).
(1.76)
The next order moments,
Z
p
maf(x, p, τ) d3p ≡ρ(x, τ)u(x, τ),
(1.77)
Z
pipj
m2a2 f(x, p, τ) d3p ≡ρ(x, τ)ui(x, τ)uj(x, τ) + σij(x, τ),
(1.78)
deﬁne the peculiar velocity ﬂow u(x, τ) (average local velocity of particles in a region of space; for simpliﬁcation,
we use the same notation as the peculiar velocity of a single particle) and the stress tensor σij(x, τ) which can
be related to the velocity dispersion tensor, vij(x, τ), by σij(x, τ) ≡ρ(x, τ)vij(x, τ).
By taking successive momentum moments of the Vlasov equation and integrating out phase-space informa-
tion, a hierarchy of equations that couple successive moments of the distribution function can be constructed.
The zeroth moment of the Vlasov equation gives the continuity equation,
∂δ(x, τ)
∂τ
+ ∇· {[1 + δ(x, τ)] u(x, τ)} = 0,
(1.79)
which describes the conservation of mass. Taking the ﬁrst moment and subtracting ¯ρ u(x, τ) times the continuity
equation yields the Euler equation,
∂ui(x, τ)
∂τ
+ H(τ)ui(x, τ) + uj(x, τ) · ∇jui(x, τ) = −∇iΦ(x, τ) −
1
ρ(x, τ)∇j(σij(x, τ)),
(1.80)
which describes the conservation of momentum. This equation is very similar to that of hydrodynamics, apart
from an additional term which accounts for the expansion of the Universe and the fact that, contrary to perfect
ﬂuids, auto-gravitating systems may have an anisotropic stress tensor.

18
Chapter 1. Cosmological perturbations and structure formation
The inﬁnite sequence of momentum moments of the Vlasov equation is usually truncated at this point
and completed by ﬂuid dynamics assumptions to close the system. Speciﬁcally, one postulates an Ansatz for
the stress tensor, namely the equation of state of the cosmological ﬂuid. For example, if the ﬂuid is locally
thermalized, the velocity dispersion becomes isotropic and proportional to the pressure (e.g. Bernardeau et al.,
2002):
σij = −Pδij
K,
(1.81)
where δab
K is a Kronecker symbol. Standard ﬂuid dynamics also prescribes, with the addition of a viscous stress
tensor, the following equation (e.g. Bernardeau et al., 2002):
σij = −Pδij
K + ζ(∇· u)δij
K + µ

∇iuj + ∇jui −2
3(∇· u)δij
K

,
(1.82)
where ζ is the coeﬃcient of bulk viscosity and µ is the coeﬃcient of shear viscosity.
1.3.3
The single-stream approximation
At the early stages of cosmological gravitational instability, it is possible to further simplify and to rely
on a diﬀerent hypothesis, namely the single-stream approximation. At suﬃciently large scales, gravity-induced
cosmic ﬂows will dominate over the velocity dispersion due to peculiar motions. The single-stream approximation
consists in assuming that for CDM, velocity dispersion and pressure are negligible, i.e. σij = 0, and that all
particles have identical peculiar velocities. Hence, the density in phase space can be written
f(x, p, τ) = ρ(x, τ) δD[p −mau(x)] .
(1.83)
Note, that from its deﬁnition, equation (1.78), the stress tensor characterizes the deviation of particle motions
from a single coherent ﬂow.
The single-stream approximation only works at the beginning of gravitational structure formation, when
structures had no time to collapse and virialize. Because of non-linearity in the Vlasov-Poisson system, later
stages will involve the superposition of three or more streams in phase space, indicating the break down of the
approximation at increasingly larger scales. The breakdown of σij ≈0, describing the generation of velocity
dispersion or anisotropic stress due to the multiple-stream regime, is generically known as shell-crossing. Beyond
that point, the density in phase space exhibits no simple form, generally preventing further analytic analysis.
This issue will be discussed further in chapters 2 and 6.
The single-stream approximation yields the following system of equations:
∂δ(x, τ)
∂τ
+ ∇· {[1 + δ(x, τ)] u(x, τ)}
=
0,
(1.84)
∂ui(x, τ)
∂τ
+ H(τ)ui(x, τ) + uj(x, τ) · ∇jui(x, τ)
=
−∇iΦ(x, τ),
(1.85)
∆Φ(x, τ)
=
4πGa2(τ)¯ρ(τ)δ(x, τ).
(1.86)
It is a non-linear, closed system of equations involving the local density contrast, the local velocity ﬁeld and the
local gravitational potential.
There exists no general analytic solution to the ﬂuid dynamics of collisionless self-gravitating CDM, even
in the single-stream regime.
However, literature provides several diﬀerent analytic perturbative expansion
techniques to yield approximate solutions for the dark matter dynamics, which we brieﬂy review below (sections
1.4 and 1.5).
1.4
Eulerian perturbation theory
1.4.1
Eulerian linear perturbation theory
As mentioned above, at large scales and during the early stages of gravitational evolution, we expect the
matter distribution to be smooth and to follow a single velocity stream. In this regime, it is therefore pos-
sible to linearize equation (1.84) and (1.85), assuming that ﬂuctuations of density are small compared to the

1.4. Eulerian perturbation theory
19
homogeneous contribution and that gradients of velocity ﬁelds are small compared to the Hubble parameter,
|δ(x, τ)|
≪
1,
(1.87)
|∇jui(x, τ)|
≪
H(τ).
(1.88)
We obtain the equation of motion in the linear regime,
∂δ(x, τ)
∂τ
+ θ(x, τ)
=
0,
(1.89)
∂u(x, τ)
∂τ
+ H(τ)u(x, τ)
=
−∇Φ(x, τ),
(1.90)
where θ(x, τ) ≡∇· u(x, τ) is the divergence of the velocity ﬁeld. The velocity ﬁeld, as any vector ﬁeld, is
completely described by its divergence θ(x, τ) and its curl, referred to as the vorticity, w(x, τ) ≡∇× u(x, τ),
whose equations of motion follow from taking the divergence and the curl of equation (1.85) and using the
Poisson equation:
∂θ(x, τ)
∂τ
+ H(τ)θ(x, τ) + 4πGa2(τ)¯ρ(τ)δ(x, τ)
=
0,
(1.91)
∂w(x, τ)
∂τ
+ H(τ)w(x, τ)
=
0.
(1.92)
Since vorticity is not sourced in the linear regime, any initial vorticity rapidly decays due to the expansion of
the Universe. Indeed, its evolution immediately follows from equation (1.92): w(τ) ∝1/a(τ). In the non-linear
regime, the emergence of anisotropic stress in the right-hand side of Euler’s equation can lead to vorticity
generation (Pichon & Bernardeau, 1999).
The density contrast evolution follows by replacing equation (1.89) and its time derivative in equation (1.91):
∂2δ(x, τ)
∂τ 2
+ H(τ)∂δ(x, τ)
∂τ
= 4πGa2(τ)¯ρ(τ)δ(x, τ) = 3
2Ωm(τ)H2(τ)δ(x, τ).
(1.93)
1.4.2
The growth of ﬂuctuations in linear theory
This linear equation allows us to look for diﬀerent ﬂuctuation modes, decoupling spatial and time contribu-
tions by writing δ(x, τ) = D1(τ) δ(x, 0), where some “initial” reference time is labeled as 0 and where D1(τ) is
called the linear growth factor. The time dependence of the ﬂuctuation growth rate satisﬁes
d2D1(τ)
dτ 2
+ H(τ)dD1(τ)
dτ
= 3
2Ωm(τ)H2(τ)D1(τ),
(1.94)
regardless of x (or of the Fourier mode k): in the linear regime, the growth of ﬂuctuations is scale-independent.
This equation, together with Friedmann’s equations, equations (1.7) and (1.9), determines the growth of density
perturbations in the linear regime as a function of cosmological parameters. There are two independent solutions,
the fastest growing mode D(+)
1
(τ) and the slowest growing mode D(−)
1
(τ). The evolution of the density contrast
is then given by:
δ(x, τ) = D(+)
1
(τ)δ+(x) + D(−)
1
(τ)δ−(x),
(1.95)
where δ+(x) and δ−(x) are two functions of position only describing the initial density ﬁeld conﬁguration.
In terms of the scale factor and using Friedmann’s equations, equation (1.94) can be rewritten as
a2 d2D1
da2 +

ΩΛ(a) −Ωm(a)
2
+ 2

adD1
da = 3
2Ωm(a)D1,
(1.96)
where the cosmological parameters ΩΛ(a) and Ωm(a) now depend on the scale factor (for more details on this
derivation and a generalization to time-varying dark energy models, see Percival, 2005b).
Using the linearized continuity equation, equation (1.89), the velocity divergence is given by
θ(x, τ) = −H(τ) [f(Ωi)δ+(x, τ) + g(Ωi)δ−(x, τ)] .
(1.97)

20
Chapter 1. Cosmological perturbations and structure formation
It does not depend directly on the linear growth factor of each mode, but on its logarithmic derivative, the
exponent in the momentary power law relating D to a,
f(Ωi) ≡
1
H(τ)
d ln D(+)
1
dτ
= d ln D(+)
1
d ln a
,
g(Ωi) ≡
1
H(τ)
d ln D(−)
1
dτ
= d ln D(−)
1
d ln a
,
(1.98)
with δ±(x, τ) ≡D(±)
1
(τ)δ±(x).
We now review some cosmological models for which analytic expressions exist.
1. For a standard cold dark matter (SCDM) model, i.e. a particular case of an Einstein-de Sitter universe
(Einstein & de Sitter, 1932) where dark matter is cold, the cosmological parameters are time-independent:
Ωm(a) = 1 and ΩΛ(a) = 0. Using equation (1.96), the evolution of the linear growth factor satisﬁes
a2 d2D1
da2 + 3
2adD1
da = 3
2D1.
(1.99)
Two independent solutions are
D(+)
1
∝a,
f(Ωm = 1, ΩΛ = 0) = 1,
D(−)
1
∝a−3/2,
g(Ωm = 1, ΩΛ = 0) = −3
2,
(1.100)
thus density ﬂuctuations grow as the scale factor, δ ∝a, once the decaying mode has vanished.
2. For an open cold dark matter (OCDM) model, the cosmological parameters are Ωm(a) < 1 and ΩΛ(a) = 0.
The solutions of equation (1.96) are (Groth & Peebles, 1975), with x ≡a(τ)(1/Ω(0)
m −1),
D(+)
1
= 1 + 3
x + 3 (1 + x)1/2
x3/2
ln
h
(1 + x)1/2 −x1/2i
,
D(−)
1
= (1 + x)1/2
x3/2
.
(1.101)
The dimensionless parameter g is calculated to be
g(Ωm, ΩΛ = 0) = −Ωm
2
−1,
(1.102)
and the dimensionless parameter f can be approximated by (Peebles, 1976, 1980)
f(Ωm, ΩΛ = 0) ≈Ω3/5
m .
(1.103)
As Ωm →0 (a →∞and x →∞), D(+)
1
→1 and D(−)
1
∼x−1: perturbations cease to grow.
3. For a universe with cold dark matter and a cosmological constant, Ωm(a) < 1 and 0 < ΩΛ(a) ≤1 (ΛCDM
model), allowing the possibility of a curvature term (Ωtot(a) = Ωm(a) + ΩΛ(a) ̸= 1), the ﬁrst Friedmann
equation, equation (1.1), allows to write the Hubble parameter as
H(a) = H0
q
Ω(0)
Λ + (1 −Ω(0)
Λ −Ω(0)
m )a−2 + Ω(0)
m a−3.
(1.104)
It can be checked that this expression is a solution of equation (1.96). The decaying mode is then
D(−)
1
∝H(a) = H(a)
a
.
(1.105)
Using this particular solution and the variation of parameters method, the other solution is found to be
(Heath, 1977; Carroll, Press & Turner, 1992; Bernardeau et al., 2002)
D(+)
1
∝a3H3(a)
Z a
0
d˜a
˜a3H3(˜a).
(1.106)
Due to equations (1.7) and (1.105), one ﬁnds for arbitrary Ωm and ΩΛ,
g(Ωm, ΩΛ) = ΩΛ −Ωm
2
−1,
(1.107)

1.4. Eulerian perturbation theory
21
and f can be approximated by (Lahav et al., 1991)
f(Ωm, ΩΛ) ≈
"
Ω(0)
m a−3
Ω(0)
m a−3 + (1 −Ω(0)
Λ −Ω(0)
m )a−2 + Ω(0)
Λ
#3/5
(1.108)
or (Lightman & Schechter, 1990; Carroll, Press & Turner, 1992)
f(Ωm, ΩΛ) ≈
"
Ω(0)
m a−3
Ω(0)
m a−3 + (1 −Ω(0)
Λ −Ω(0)
m )a−2 + Ω(0)
Λ
#4/7
.
(1.109)
For ﬂat Universe, Ωm + ΩΛ = 1, we have (Bouchet et al., 1995; Bernardeau et al., 2002)
f(Ωm, ΩΛ = 1 −Ωm) ≈Ω5/9
m .
(1.110)
In the case of the Einstein-de Sitter universe, an interpretation of the growing and decaying modes can be
easily given. Referring to the solution for the growth factor, equation (1.100), the initial density ﬁeld (equation
(1.95)) and the initial velocity ﬁeld (equation (1.97)) are written
δinit(x)
≡
δ(x, 0) = δ+(x) + δ−(x),
(1.111)
θinit(x)
≡
θ(x, 0) = −H(0)

δ+(x) −3
2δ−(x)

,
(1.112)
if we assume that D+ and D−are normalized to unity at the initial time. These relations can be inverted to
give
δ+(x)
=
3
5

δinit(x) −2
3
θinit(x)
H(0)

,
(1.113)
δ−(x)
=
2
5

δinit(x) + θinit(x)
H(0)

.
(1.114)
From these expressions, the interpretation of the modes become clear. The sign is signiﬁcant: recall that for a
growing mode alone we would expect θinit = −H(0)δinit and for a decaying mode alone, θinit = 3/2 H(0)δinit. A
pure growing mode corresponds to the case where the density and velocity ﬁelds are initially “in phase”, in the
sense that the velocity ﬁeld converges towards the potential wells deﬁned by the density ﬁeld. A pure decaying
mode corresponds to the case where the density and velocity ﬁelds are initially “opposite in phase”, the velocity
ﬁeld being such that particles escape potential wells.
1.4.3
Eulerian perturbation theory at higher order
At higher order, Eulerian perturbation theory can be implemented by expanding the density and velocity
ﬁelds,
δ(x, τ)
=
∞
X
n=1
δ(n)(x, τ) = δ(1)(x, τ) + δ(2)(x, τ) + ... ,
(1.115)
θ(x, τ)
=
∞
X
n=1
θ(n)(x, τ) = θ(1)(x, τ) + θ(2)(x, τ) + ... ,
(1.116)
where δ(1)(x, τ) and θ(1)(x, τ) are the linear order solution studied in the previous section. Focusing only on
the growing mode, the ﬁrst-order density ﬁeld reads,
δ(1)(x, τ) = D1(τ)δinit(x),
(1.117)
with D1(τ) ≡D(+)
1
(τ) and δinit(x) = δ+(x). δ(2)(x, τ) describes to leading order the non-local evolution of the
density ﬁeld due to gravitational interactions. It is found to be proportional to the second-order growth factor,
D2(τ), which satisﬁes the diﬀerential equation (equation 43 in Bouchet et al., 1995)
a2 d2D2
da2 +

ΩΛ(a) −Ωm(a)
2
+ 2

adD2
da = 3
2Ωm(a)
h
D2 −(D(+)
1
)2i
.
(1.118)

22
Chapter 1. Cosmological perturbations and structure formation
In the codes implemented for this thesis, we use the ﬁtting function
D2(τ) ≈−3
7D2
1(τ)Ω−1/143
m
,
(1.119)
valid for a ﬂat ΛCDM model (Bouchet et al., 1995).
Depending on the cosmological parameters, diﬀerent
expressions can be found in the literature (see e.g. Bernardeau et al., 2002), but D2(τ) always stays of the order
of D2
1(τ) as expected in perturbation theory.
A detailed presentation of non-linear Eulerian perturbation theory involves new types of objects (kernels,
propagators, vertices) and is beyond the scope of this thesis. For an existing review, see e.g. Bernardeau et al.
(2002).
1.5
Lagrangian perturbation theory
1.5.1
Lagrangian ﬂuid approach for cold dark matter
As we have seen (section 1.3.2), our approach is based on the assumption that CDM is well described by
a ﬂuid. A way of looking at ﬂuid motion is to focus on speciﬁc locations in space through which the ﬂuid
ﬂows as time passes. It is then possible to study dynamics of density and velocity ﬁelds in this context, which
constitutes the Eulerian point of view. We have developed Eulerian perturbation theory in section 1.4.
Alternatively, in ﬂuid dynamics, one can choose to describe the ﬁeld by following the trajectories of particles
or ﬂuid elements. This is the so-called Lagrangian description. The goal of this paragraph is to apply this
description to the cosmological ﬂuid and to build Lagrangian perturbation theory in this framework.
Mapping from Lagrangian to Eulerian coordinates.
In Lagrangian description, the object of interest is not
the position of particles but the displacement ﬁeld Ψ(q) which maps the initial comoving particle position q
into its ﬁnal comoving Eulerian position x, (e.g. Buchert, 1989; Bouchet et al., 1995; Bernardeau et al., 2002):
x(q, τ) ≡q + Ψ(q, τ).
(1.120)
Let J(q, τ) be the Jacobian of the transformation between Lagrangian and Eulerian coordinates,
J(q, τ) ≡

∂x
∂q
 = |det D| = |det(I + R)| ,
(1.121)
where the deformation tensor D can be written as the identity tensor I plus the shear of the displacement,3
R ≡∂Ψ/∂q. The Jacobian can be obtained by requiring that the Lagrangian mass element be conserved in
the relationship between density contrast and trajectories:
ρ(x, τ) d3x = ρ(q) d3q
⇒
¯ρ(τ) [1 + δ(x, τ)] d3x = ¯ρ(τ)d3q,
(1.122)
Hence,
J(q, τ) =
1
1 + δ(x, τ)
or
δ(x, τ) = J−1(q, τ) −1.
(1.123)
Note that this result (without the absolute value for J) is valid as long as no shell-crossing occurs. At the ﬁrst
crossing of trajectories, ﬂuid elements with diﬀerent initial positions q end up at the same Eulerian position
x through the mapping in equation (1.120). The Jacobian vanishes and one expects a singularity, namely a
collapse to inﬁnite density. At this point, the description of dynamics in terms of a mapping does not hold
anymore, the correct description involves a summation over all possible streams.
Equation of motion in Lagrangian coordinates.
The equation of motion for a ﬂuid element, equation (1.70),
reads in conformal time,
∂u
∂τ + H(τ)u = −∇xΦ,
(1.124)
3 R is mathematically a tensor. It is sometimes referred to as the tidal tensor and noted T. We will avoid this nomenclature and
notation here, so as not to introduce confusion with the Hessian of the gravitational potential T ≡∂2Φ/∂x2 (see section C.2).

1.5. Lagrangian perturbation theory
23
where Φ is the cosmological gravitational potential and ∇x is the gradient operator in Eulerian comoving
coordinates x. Taking the divergence of this equation, noting that u = dx/dτ = ∂Ψ/∂τ, using equation (1.123)
and the Poisson equation, equation (1.72), and multiplying by the Jacobian, we obtain
J(q, τ) ∇x ·
∂2Ψ
∂τ 2 + H(τ)∂Ψ
∂τ

= 3
2Ωm(τ)H2(τ) [J(q, τ) −1] .
(1.125)
This equation shows the principal diﬃculty of the Lagrangian approach: the gradient operator has to be
taken with reference to the Eulerian variable x, which depends on q according to equation (1.120). Equation
(1.125) can be rewritten in terms of Lagrangian coordinates only by using (∇x)i =
h
δij
K + Ψi,j
i−1
(∇q)j, where
Ψi,j ≡∂Ψi/∂qj = Rij are the shears of the displacement. The resulting non-linear diﬀerential equation for
Ψ(q, τ) is then solved perturbatively, expanding about its linear solution.
1.5.2
The Zel’dovich approximation
Displacement ﬁeld in the Zel’dovich approximation.
In Lagrangian approach, non-linearities of the dynamics
are encoded in the relation between q and x (equation (1.120)) and in the relation between the displacement
ﬁeld and the local density (equation (1.123)). The Zel’dovich approximation (Zel’dovich, 1970; Shandarin &
Zel’dovich, 1989, hereafter ZA) is ﬁrst order Lagrangian perturbation theory. It consists of taking the linear
solution of equation (1.125) for the displacement ﬁeld while keeping the general equation with the Jacobian,
equation (1.123), to reconstruct the density ﬁeld. At linear order in the displacement ﬁeld, the relation between
the gradients in Eulerian and Lagrangian coordinates is J(q, τ)∇x ≈∇q, and the ﬁrst-order Jacobian is
J(q, τ) ≈1 + ∇q · Ψ. The equation to solve becomes
∇q ·
∂2Ψ
∂τ 2 + H(τ)∂Ψ
∂τ

= 3
2Ωm(τ)H2(τ) (∇q · Ψ) .
(1.126)
The addition of any divergence-free displacement ﬁeld to a solution of the previous equation will also be a
solution.
In the following, we remove this indeterminacy by assuming that the movement is potential, i.e.
∇q × Ψ = 0. Introducing the divergence of the Lagrangian displacement ﬁeld, ψ ≡∇q · Ψ, one has to solve,
ψ′′ + H(τ)ψ′ = 3
2Ωm(τ)H2(τ)ψ.
(1.127)
Therefore, the linear solution of equation (1.125) is separable into a product of a temporal and a spatial
contribution. It can be written as Ψ(1)(q, τ) such that
ψ(1)(q, τ) ≡∇q · Ψ(1)(q, τ) = −D1(τ) δ(q),
(1.128)
where D1(τ) denotes the linear growth factor studied in section 1.4.1 and δ(q) describes the growing mode of
the initial density contrast ﬁeld in Lagrangian coordinates. This can be checked in equation (1.127) using the
diﬀerential equation satisﬁed by the growth factor, equation (1.94). The above choice for the spatial contribution
permits to recover the linear Eulerian behaviour, since initially δ(x) ≈D1(τ)δ(q) ≈(1 + ψ)−1 −1 ≈−ψ.
Note that the evolution of ﬂuid elements at linear order is local evolution, i.e. it does not depend on the
behavior of the rest of ﬂuid elements. We have assumed that at linear order, the displacement ﬁeld is entirely
determined by its divergence, i.e. that vorticity vanishes. As we have already noted from equation (1.92), in the
linear regime, any initial vorticity decays away due to the expansion of the Universe. Thus, one might consider
that the solutions will apply anyway, even if vorticity is initially present, because at later times it will have
negligible eﬀect. Similarly, we have neglected the eﬀect of the decaying mode in equation (1.95).
Shell-crossing in the Zel’dovich approximation.
Since the displacement ﬁeld in the ZA is curl-free, it is
convenient to introduce the potential from which it derives, φ(1)(q), such that Ψ(1)(q, τ) = −D1(τ)∇qφ(1)(q).
At linear order in the displacement ﬁeld, its shear R ≡∂Ψ(1)/∂q is equal to −D1(τ)H(φ(1)(q)). Let λ1(q) ≤
λ2(q) ≤λ3(q) be the local eigenvalues of the Hessian of the Zel’dovich potential φ(1)(q). At conformal time τ,
these values have grown of a factor −D1(τ) to give the eigenvalues of the shear of the displacement R. Using
equation (1.123), the density contrast may then be written as (e.g. Bouchet et al., 1995; Bernardeau et al.,
2002)
1 + δ(x, τ) =
1
[1 −λ1(q)D1(τ)] [1 −λ2(q)D1(τ)] [1 −λ3(q)D1(τ)].
(1.129)

24
Chapter 1. Cosmological perturbations and structure formation
This equation allows an interpretation of what happens at shell-crossing in the ZA. If all eigenvalues λi are
negative, this is a developing underdense region, eventually reaching δ = −1.
If λ3 only is positive, when
λ3D1(τ) →1, the ZA leads to a planar collapse to inﬁnite density along the axis of λ3 and the formation of a
two-dimensional “cosmic pancake”. In the case when two eigenvalues are positive, λ2, λ3 > 0, there is collapse
to a ﬁlament. The case λ1, λ2, λ3 > 0 leads to gravitational collapse along all directions (spherical collapse if
λ1 ≈λ2 ≈λ3). This picture of gravitational structure formation leads to a cosmic web classiﬁcation algorithm,
which labels diﬀerent regions either as voids, sheets, ﬁlaments, or halos (see Hahn et al., 2007a; Lavaux &
Wandelt, 2010, an section C.2).
1.5.3
Second-order Lagrangian perturbation theory
Displacement ﬁeld in second-order Lagrangian perturbation theory.
The Zel’dovich approximation being
local, it fails at suﬃciently non-linear stages when particles are forming gravitationally bound structures instead
of following straight lines. Already second-order Lagrangian perturbation theory (hereafter 2LPT) provides a
remarkable improvement over the ZA in describing the global properties of density and velocity ﬁelds (Melott,
Buchert & Weiß, 1995). The solution of equation (1.125) up to second order takes into account the fact that
gravitational instability is non-local, i.e. it includes the correction to the ZA displacement due to gravitational
tidal eﬀects. It reads
x(τ) = q + Ψ(q, τ) = q + Ψ(1)(q, τ) + Ψ(2)(q, τ),
or
Ψ(q, τ) = Ψ(1)(q, τ) + Ψ(2)(q, τ),
(1.130)
where the divergence of the ﬁrst order solution is the same as in the ZA (equation (1.128)),
ψ(1)(q, τ) = ∇q · Ψ(1)(q, τ) = −D1(τ) δ(q),
(1.131)
and the divergence of the second order solution describes the tidal eﬀects,
ψ(2)(q, τ) = ∇q · Ψ(2)(q, τ) = 1
2
D2(τ)
D2
1(τ)
X
i̸=j
h
Ψ(1)
i,i Ψ(1)
j,j −Ψ(1)
i,j Ψ(1)
j,i
i
,
(1.132)
where Ψ(1)
k,l ≡∂Ψ(1)
k /∂ql and D2(τ) denotes the second-order growth factor, deﬁned in section 1.4.3.
Lagrangian potentials.
Since Lagrangian solutions up to second order are irrotational (Melott, Buchert &
Weiß, 1995; Buchert, Melott & Weiß, 1994; Bernardeau et al., 2002; this is assuming that initial conditions are
only in the growing mode, in the same spirit as neglecting completely the decaying vorticity), it is convenient
to deﬁne the Lagrangian potentials φ(1) and φ(2) from which Ψ(1) and Ψ(2) derive, so that in 2LPT,
Ψ(1)(q, τ) = −D1(τ)∇qφ(1)(q)
and
Ψ(2)(q, τ) = D2(τ)∇qφ(2)(q).
(1.133)
Since Ψ(1) is of order D1(τ) (equation (1.131)) and Ψ(2)(τ) is of order D2(τ) (equation (1.132)), the above
potentials are time-independent. They satisfy Poisson-like equations (Buchert, Melott & Weiß, 1994),
∆qφ(1)(q)
=
δ(q),
(1.134)
∆qφ(2)(q)
=
X
i>j
h
φ(1)
,ii (q)φ(1)
,jj(q) −(φ(1)
,ij (q))2i
.
(1.135)
The mapping from Eulerian to Lagrangian, equation (1.130), thus reads
x(τ) = q −D1(τ)∇qφ(1)(q) + D2(τ)∇qφ(2)(q).
(1.136)
Velocity ﬁeld in second-order Lagrangian perturbation theory.
Taking the derivative of the previous equation
yields for the velocity ﬁeld,
u = −f1(τ)D1(τ)H(τ)∇qφ(1)(q) + f2(τ)D2(τ)H(τ)∇qφ(2)(q).
(1.137)
which involves the logarithmic derivatives of the growth factors, fi ≡d ln Di/d ln a, well approximated in a ﬂat
ΛCDM model by (Bouchet et al., 1995)
f1 ≈Ω5/9
m
and
f2 ≈2 Ω6/11
m
≈2 f 54/55
1
.
(1.138)
Other expressions for diﬀerent cosmologies can be found in Bouchet et al. (1995); Bernardeau et al. (2002).

1.6. Non-linear approximations to gravitational instability
25
1.6
Non-linear approximations to gravitational instability
When ﬂuctuations become strongly non-linear in the density ﬁeld, Eulerian perturbation theory breaks
down. Lagrangian perturbation theory is often more successful, since the Lagrangian picture is intrinsically
non-linear in the density ﬁeld (see e.g. equation (1.125)). A small perturbation in the Lagrangian displacement
ﬁeld carries a considerable amount of non-linear information about the corresponding Eulerian density and
velocity ﬁelds. However, at some point, computers are required to study gravitational instability (in particular
through N-body simulations), the important drawback being that the treatment becomes numerical instead
of analytical. We will adopt this approach in this thesis. However, several non-linear approximations to the
equations of motion have been suggested in the literature to allow the extrapolation of analytical calculations
in the non-linear regime. We now brieﬂy review some of them.
Non-linear approximations consist of replacing one of the equations of the dynamics (Poisson – equation
(1.72) –, continuity – equation (1.79) – or Euler – equation (1.80)) by a diﬀerent assumption.4 In general, the
Poisson equation is replaced (Munshi & Starobinsky, 1994). These modiﬁed dynamics are often local, in the
sense described above for the ZA, in order to provide a simpler way of calculating the evolution of ﬂuctuations
than the full non-local dynamics.
1.6.1
The Zel’dovich approximation as a non-linear approximation
As we have seen in section 1.3, in Eulerian dynamics, non-linearity is encoded in the Poisson equation,
equation (1.72), ∆Φ = 4πGa2¯ρδ. The goal of this paragraph is to see what replaces the Poisson equation
in the Eulerian description of the ZA. From this point of view, the ZA is the original non-linear Eulerian
approximation, and it remains one of the most famous.
If we restrict our attention to potential movements, the peculiar velocity ﬁeld u is irrotational. It can be
written as the gradient of a velocity potential,
u = −∇xV
a
.
(1.139)
As discussed before, the main reason to restrict to this case is the decay of vortical perturbations.
It is then possible to postulate various forms for the velocity potential V . The ZA corresponds to the Ansatz
(Munshi & Starobinsky, 1994; Hui & Bertschinger, 1996; appendix B in Scoccimarro, 1997)
V =
2fa
3ΩmHΦ,
(1.140)
where Φ is the cosmological gravitational potential and f is the logarithmic derivative of the linear growth
factor. The Zel’dovich approximation is therefore equivalent to the replacement of the Poisson equation by
u = −
2f
3ΩmH∇Φ.
(1.141)
This can be explicitly checked as follows. Combining equations (1.124) and (1.141), one gets
∂u
∂τ + Hu = 3ΩmH
2f
u.
(1.142)
Then, noting that ∇q · u = ψ′, the diﬀerential equation for ψ is
ψ′′ + Hψ′ = 3ΩmH
2f
ψ′,
(1.143)
Using the time evolution of D1 (equation (1.94)) and the identity D′
1 = HfD1, one can check that the Zel’dovich
solution, ψ = −D1δ(q) indeed veriﬁes the above equation.
Equation (1.141) means that at linear order, particles just go straight (in comoving coordinates) in the
direction set by their initial velocity. In the Zel’dovich approximation, the proportionality between velocity
ﬁeld and gravitational ﬁeld always holds (not just to ﬁrst order in Ψ).
4 In this section, we have come back to a Eulerian description of the cosmological ﬂuid.

26
Chapter 1. Cosmological perturbations and structure formation
Note that during the matter era, a ∝t2/3 and thus H ≡˙a = 2a/(3t), which means that an equivalent form
for the ZA Ansatz is
V =
f
Ωm
Φt ≈Φt.
(1.144)
The ZA is a local approximation that represents exactly the true dynamics in one-dimensional collapse
(Buchert, 1989; Yoshisato et al., 2006).
It is also possible to formulate local approximations that besides
describing correctly planar collapse like the ZA, are suited for cylindrical or spherical collapse (leading to the
formation of cosmic ﬁlaments and halos, in addition to cosmic pancakes). These approximations, namely the
“non-magnetic” approximation (NMA, Bertschinger & Jain, 1994) and the “local tidal” approximation (LTA,
Hui & Bertschinger, 1996), are not straightforward to implement for the calculation of statistical properties of
density and velocity ﬁelds.
1.6.2
Other velocity potential approximations
Some other possibilities for the velocity potential can be found in literature (Coles, Melott & Shandarin,
1993; Munshi & Starobinsky, 1994). The frozen ﬂow (FF) approximation postulates
V = Φ(1)t,
(1.145)
where Φ(1) is the ﬁrst-order solution (the linear approximation) for the gravitational potential. It satisﬁes the
Poisson equation in the linear regime,
∆Φ(1) = 3
2Ωm(τ)H2(τ)δ1(x, τ),
(1.146)
where δ1(x, τ) = D1(τ) δ1(x) is the linearly extrapolated density ﬁeld. In FF, the Poisson equation is replaced
by the analog of equation (1.141), substituting equation (1.145),
u = −
2f
3ΩmH∇Φ(1),
(1.147)
or, by taking the divergence and using equation (1.146),
θ(x, τ) = −H(τ)f δ1(x, τ).
(1.148)
The physical meaning of this approximation is that the velocity ﬁeld is assumed to remain linear while the
density ﬁeld is allowed to explore the non-linear regime.
In the linear potential (LP) approximation, the gravitational potential is instead assumed to remain the
same as in the linear regime; therefore, the Poisson equation is replaced by
Φ = Φ(1),
∆Φ = 3
2Ωm(τ)H2(τ)δ1(x, τ).
(1.149)
The idea is that since Φ ∝δ/k2 in Fourier space, the gravitational potential is dominated by the long-wavelength
modes more than the density ﬁeld, and therefore it ought to obey linear perturbation theory to a better
approximation.
1.6.3
The adhesion approximation
All the above approximations (ZA, NMA, LTA, FF, LP) are local, which means that we neglect the self-
gravity of inhomogeneities. A signiﬁcant problem of the ZA, and of subsequent variations, is the fact that
after shell-crossing, matter continues to ﬂow throughout the newly-formed structure, which should instead be
gravitationally bound. This phenomenon washes out cosmic structures on small scales.
A possible phenomenological solution is to add a viscosity term to the single-stream Euler equation, equation
(1.85), which then becomes Burgers’ equation,
∂ui(x, τ)
∂τ
+ H(τ)ui(x, τ) + uj(x, τ) · ∇jui(x, τ) = −∇iΦ(x, τ) + v ∆ui(x, τ).
(1.150)
This is the so-called adhesion approximation (Kofman & Shandarin, 1988; Gurbatov, Saichev & Shandarin,
1989; Kofman et al., 1992; Valageas & Bernardeau, 2011; Hidding et al., 2012). For a potential ﬂow, it can be

1.6. Non-linear approximations to gravitational instability
27
reduced to a linear diﬀusion equation, and therefore solved exactly. Surprisingly, in the adhesion approximation,
the dynamical equations describing the evolution of the self-gravitating cosmological ﬂuid can be written in the
form of a Schrödinger equation coupled to a Poisson equation describing Newtonian gravity (Short & Coles,
2006b). The dynamics can therefore be studied with the tools of wave mechanics. An alternative to the adhesion
model is the free-particle approximation (FPA), in which the artiﬁcial viscosity term in Burgers’ equation is
replaced by a non-linear term known as the quantum pressure. This also leads to a free-particle Schrödinger
equation (Short & Coles, 2006b,a).
Comparisons of the adhesion approximation to full-gravitational numerical simulations show an improvement
over the ZA at small scales, even if the fragmentation of structures into dense clumps is still underestimated
(Weinberg & Gunn, 1990). At weakly non-linear scales, the adhesion approximation is essentially equal to the
ZA.


Chapter 2
Numerical diagnostics of Lagrangian
perturbation theory
Contents
2.1
Correlation functions of the density ﬁeld . . . . . . . . . . . . . . . . . . . . . . . . . .
30
2.1.1
One-point statistics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
30
2.1.2
Two-point statistics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
31
2.1.3
Three-point statistics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
34
2.2
Statistics of the Lagrangian displacement ﬁeld . . . . . . . . . . . . . . . . . . . . . . .
37
2.2.1
Lagrangian ψ versus Eulerian δ: one-point statistics
. . . . . . . . . . . . . . . . . . . . . .
37
2.2.2
Perturbative and non-perturbative prescriptions for ψ
. . . . . . . . . . . . . . . . . . . . .
41
2.2.3
Non-linear evolution of ψ and generation of a vector part
. . . . . . . . . . . . . . . . . . .
43
2.3
Comparison of structure types in LPT and N-body dynamics
. . . . . . . . . . . . .
44
“Hector Barbossa: The world used to be a bigger place.
Jack Sparrow: The world’s still the same. There’s just... less in
it.”
— Pirates of the Caribbean: At World’s End (2007)
Abstract
This chapter is intended as a guide on the approximation error in using Lagrangian perturbation theory instead of fully
non-linear gravity in large-scale structure analysis. We compare various properties of particle realizations produced
by LPT and by N-body simulations. In doing so, we characterize diﬀerences and similarities, as a function of scale,
resolution and redshift.
The goal of this chapter is to characterize the accuracy of Lagrangian perturbation theory in terms of a set
of numerical diagnostics. It is organized as follows. In section 2.1, we look at the correlations functions of the
density ﬁeld, which usually are the ﬁnal observable in cosmological surveys. As the displacement ﬁeld plays a
central role in LPT, we study its statistics in section 2.2. In particular, we illustrate that in some regimes, when
the perturbative parameter is large, 2LPT performs worse than the ZA. We examine the decomposition of the
displacement ﬁeld in a scalar and rotational part and review various approximations based on its divergence.
Finally, in section 2.3, we compare cosmic web elements (voids, sheets, ﬁlaments, and clusters) as predicted by
LPT and by non-linear simulations of the LSS.1
Corresponding LPT and N-body simulations used in this chapter have been run from the same initial
conditions, generated at redshift z = 63 using second-order Lagrangian perturbation theory.
The N-body
simulations have been run with the Gadget-2 cosmological code (Springel, Yoshida & White, 2001; Springel,
2005). Evolutions of the Zel’dovich approximation were performed with N-GenIC (Springel, 2005), and of
second-order Lagrangian perturbation theory with 2LPTic (Crocce, Pueblas & Scoccimarro, 2006a). To ensure
suﬃcient statistical signiﬁcance, we used eight realizations of the same cosmology, changing the seed used to
generate respective initial conditions. All computations are done after binning the dark matter particles with
a Cloud-in-Cell (CiC) method (see section B.3). The simulations contain 5123 particles in a 1024 Mpc/h cubic
box with periodic boundary conditions. We checked that with this setup, the power spectrum agrees with
1 In the following, we will often write “full gravity”, even if, strictly speaking, N-body simulations also involve some degree of
approximation.

30
Chapter 2. Numerical diagnostics of Lagrangian perturbation theory
 0.0
 0.2
 0.4
 0.6
 0.8
 1.0
 1.2
−1.0 −0.5
 0.0
 0.5
 1.0
 1.5
 2.0
 2.5
 3.0
P(δ)
Nbody
ZA
ZARM
2LPT
2LPTRM
−1.5
−1.0
−0.5
 0.0
 0.5
 1.0
 0.0
 2.0
 4.0
 6.0
 8.0
10.0
12.0
P(δ)/PNbody(δ) − 1
δ
ZA
ZARM
2LPT
 2LPTRM
Figure 2.1: Upper panel. Redshift-zero probability distribution function for the density contrast δ, computed from eight
1024 Mpc/h-box simulations of 5123 particles. The particle distribution is determined using: a full N-body simulation
(purple curve), the Zel’dovich approximation, alone (ZA, light red curve) and after remapping (ZARM, orange curve),
second-order Lagrangian perturbation theory, alone (2LPT, light blue curve) and after remapping (2LPTRM, green
curve). Lower panel. Relative deviations of the same pdfs with reference to N-body simulation results. Note that,
contrary to standard LPT approaches, remapped ﬁelds follow the one-point distribution of full N-body dynamics in an
unbiased way, especially in the high density regime.
the non-linear power spectrum of simulations run with higher mass resolution, provided by Cosmic Emula-
tor tools (Heitmann et al., 2009, 2010; Lawrence et al., 2010) (deviations are at most sub-percent level for
k ≲1 (Mpc/h)−1). Therefore, at the scales of interest of this work, k ≤0.4 (Mpc/h)−1 (corresponding to
the linear and mildly non-linear regime at redshift zero), the clustering of dark matter is correctly reproduced
by our set of simulations.
The cosmological parameters used are WMAP-7 ﬁducial values (Komatsu et al., 2011),
ΩΛ = 0.728, Ωm = 0.2715, Ωb = 0.0455, σ8 = 0.810, h = 0.704, ns = 0.967.
(2.1)
Thus, each particle carries a mass of 6.03 × 1011 M⊙/h.
2.1
Correlation functions of the density ﬁeld
This section draws from section III in Leclercq et al. (2013).
In this section, we analyze the correlation functions of the density contrast ﬁeld, δ, in LPT and N-body
ﬁelds.
Note. All plots presented in this section contain lines labeled as “ZARM” and “2LPTRM” which correspond
to remapped ﬁelds based on the ZA and on 2LPT, respectively. They are ignored in this chapter, which focuses
on diagnostics of LPT. For a description of the remapping procedure and for comments on these approximations
in comparison to the ZA, 2LPT and N-body dynamics, the reader is referred to chapter 6.
2.1.1
One-point statistics
Figure 2.1 shows the pdf for the density contrast, Pδ, at redshift zero, for N-body simulations, and for ZA
and 2LPT density ﬁelds. All pdfs are non-Gaussian with a substantial skewness, are tied down to 0 at δ = −1

2.1. Correlation functions of the density ﬁeld
31
3
4
−2
−1
log P(k) [(Mpc/h)3]
log k [(Mpc/h)−1]
Nbody
ZA
ZARM
2LPT
2LPTRM
PNL(k)
Figure 2.2: Redshift-zero dark matter power spectra in a 1024 Mpc/h simulation, with density ﬁelds computed with
a mesh size of 8 Mpc/h. The particle distribution is determined using: a full N-body simulation (purple curve), the
Zel’dovich approximation, alone (ZA, light red curve) and after remapping (ZARM, orange curve), second-order La-
grangian perturbation theory, alone (2LPT, light blue curve) and after remapping (2LPTRM, green curve). The dashed
black curve represents PNL(k), the theoretical power spectrum expected at z = 0. Both ZARM and 2LPTRM show in-
creased power in the mildly non-linear regime compared to ZA and 2LPT (at scales corresponding to k ≳0.1 (Mpc/h)−1
for this redshift), indicating an improvement of two-point statistics with the remapping procedure.
with a large tail in the high-density values. As discussed in section 1.2.3.4, the late-time pdf for density ﬁelds is
approximately log-normal. However, already at the level of one-point statistics, the detailed behaviors of LPT
and N-body simulations disagree: the peak of the pdf is shifted and the tails diﬀer. In particular, LPT largely
underpredicts the number of voxels in the high-density regime. This eﬀect is more severe for the ZA than for
2LPT. This comes from the fact that 2LPT captures some of non-local eﬀects involved in the formation of the
densest halos.
The one-point pdf of the density is further analyzed in section 2.2.1, in comparison to the one-point pdf of
the Lagrangian displacement ﬁeld.
2.1.2
Two-point statistics
2.1.2.1
Power spectrum
We measured the power spectrum of dark matter density ﬁelds, as deﬁned by equation (1.41). Dark matter
particles have been displaced according to each prescription and assigned to cells with a CiC scheme, for
diﬀerent mesh sizes. Power spectra were measured from theses meshes, with a correction for aliasing eﬀects
(Jing, 2005). Redshift-zero results computed on a 8 Mpc/h mesh are presented in ﬁgure 2.2. There, the dashed
line corresponds to the theoretical, non-linear power spectrum expected, computed with Cosmic Emulator
tools (Heitmann et al., 2009, 2010; Lawrence et al., 2010). A deviation of full N-body simulations from this
theoretical prediction can be observed at small scales. This discrepancy is a gridding artifact, completely due
to the ﬁnite mesh size used for the analysis. As a rule of thumb, a maximum threshold in k for trusting the
simulation data is set by a quarter of the Nyquist wavenumber, deﬁned by kN ≡2π/L × N 1/3
p
/2, where L is the
size of the box and Np is the number of cells in the Lagrangian grid on which particles are placed in the initial
conditions; which makes for our analysis (L = 1024 Mpc/h, Np = 5123), kN/4 ≈0.39 (Mpc/h)−1. At this
scale, it has been observed that the power spectrum starts to deviate at the percent-level with respect to higher
resolution simulations (Heitmann et al., 2010). The relative deviations of various power spectra with reference

32
Chapter 2. Numerical diagnostics of Lagrangian perturbation theory
−0.6
−0.4
−0.2
 0
 0.2
 0.4
0.05 0.10 0.15 0.20 0.25 0.30 0.35
P(k)/PNbody(k) − 1
k [(Mpc/h)−1]
Mesh size 16 Mpc/h
ZA
ZARM
2LPT
 2LPTRM
−0.6
−0.4
−0.2
 0
 0.2
0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40
k [(Mpc/h)−1]
Mesh size 8 Mpc/h
ZA
ZARM
2LPT
 2LPTRM
−0.6
−0.4
−0.2
 0
 0.2
0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40
k [(Mpc/h)−1]
Mesh size 4 Mpc/h
ZA
ZARM
2LPT
 2LPTRM
Figure 2.3: Power spectrum: mesh size-dependence. Relative deviations for the power spectra of various particle distribu-
tions, with reference to the density ﬁeld computed with a full N-body simulation. The particle distribution is determined
using: the Zel’dovich approximation, alone (ZA, light red curve) and after remapping (ZARM, orange curve), second-
order Lagrangian perturbation theory, alone (2LPT, light blue curve) and after remapping (2LPTRM, green curve). The
computation is done on diﬀerent meshes: 16 Mpc/h (643-voxel grid, left panel), 8 Mpc/h (1283-voxel grid, central panel)
and 4 Mpc/h (2563-voxel grid, right panel). All results are shown at redshift z = 0. LPT ﬁelds exhibit more small-scale
correlations after remapping and their power spectra get closer to the shape of the full non-linear power spectrum.
to full gravity are presented in ﬁgures 2.3 and 2.4. In all the plots, the error bars represent the dispersion of
the mean among eight independent realizations.
Generally, LPT correctly predicts the largest scales, when k →0 (the smallest wavelength mode accessible
here is set by the box size: kmin = 2π/L with L = 1024 Mpc/h, giving kmin ≈0.006 (Mpc/h)−1), as these
are in the linear regime. These are aﬀected by cosmic variance, but the eﬀect is not visible in our plots, as
corresponding LPT and N-body ﬁelds start from the same initial conditions. Diﬀerences arise in the mildly
non-linear and non-linear regime, where LPT predicts too little power. Indeed, as LPT only captures part of
the non-linearity of the Vlasov-Poisson system, presented in section 1.3.1, the clustering of dark matter particles
is underestimated.
The discrepancy between LPT and N-body power spectra depends both on the target resolution (see ﬁgure
2.3) and on the desired redshift (see ﬁgure 2.4). For example, at a resolution of 8 Mpc/h and at a comoving
wavelength of k = 0.40 (Mpc/h)−1, 2LPT only lacks 5% power at z = 3 but more than 50% at z = 0. At ﬁxed
redshift, the lack of small scale power in LPT weakly depends on the mesh size.
2.1.2.2
Fourier-space cross-correlation coeﬃcient
The Fourier space cross-correlation coeﬃcient between two density ﬁelds δ and δ′ is deﬁned as the cross-power
spectrum of δ and δ′, normalized by the auto-power spectra of the same ﬁelds:
R(k) ≡
Pδ×δ′(k)
p
Pδ(k)Pδ′(k)
≡
⟨δ∗(k)δ′(k)⟩
p
⟨δ∗(k)δ(k)⟩⟨δ′∗(k)δ′(k)⟩
.
(2.2)
It is a dimensionless coeﬃcient, in modulus between 0 and 1, representing the agreement, at the level of two-
point statistics, between the phases of δ and δ′ (as the overall power has been divided out). Here we choose
as a reference the density ﬁeld predicted by N-body simulations, δ′ = δNbody, and compare with approximate
density ﬁelds generated from the same initial conditions with LPT. In this fashion, we characterize the phase
accuracy of the ZA and 2LPT.
In ﬁgure 2.5 we present the Fourier-space cross-correlation coeﬃcient between the redshift-zero density ﬁeld
in the N-body simulation and other density ﬁelds. At this point, it is useful to recall that an approximation
well-correlated with the non-linear density ﬁeld can be used in a variety of cosmological applications, such as
the reconstruction of the non-linear power spectrum (Tassev & Zaldarriaga, 2012c). As pointed out by Neyrinck
(2013), the cross-correlation between 2LPT and full gravitational dynamics is higher at small k than the cross-

2.1. Correlation functions of the density ﬁeld
33
−0.6
−0.4
−0.2
 0
 0.2
0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40
P(k)/PNbody(k) − 1
k [(Mpc/h)−1]
Redshift z = 3
ZA
ZARM
2LPT
 2LPTRM
−0.6
−0.4
−0.2
 0
 0.2
0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40
k [(Mpc/h)−1]
Redshift z = 1
ZA
ZARM
2LPT
 2LPTRM
−0.6
−0.4
−0.2
 0
 0.2
0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40
k [(Mpc/h)−1]
Redshift z = 0
ZA
ZARM
2LPT
 2LPTRM
Figure 2.4: Power spectrum: redshift-dependence. Relative deviations for the power spectra of various particle distribu-
tions (see the caption of ﬁgure 2.3), with reference to the density ﬁeld computed with a full N-body simulation. The
computation is done on a 8 Mpc/h mesh (1283-voxel grid). Results at diﬀerent redshifts are shown: z = 3 (right panel),
z = 1 (central panel) and z = 0 (left panel). The remapping procedure is increasingly successful with increasing redshift.
0.92
0.93
0.94
0.95
0.96
0.97
0.98
0.99
1.00
0.1
0.2
0.3
0.4
0.5
R(k)
k [(Mpc/h)−1]
ZA
ZARM
2LPT
2LPTRM
Figure 2.5: Fourier-space cross-correlation coeﬃcient between various approximately-evolved density ﬁelds and the par-
ticle distribution as evolved with full N-body dynamics, all at redshift zero. The binning of density ﬁelds is done on
a 8 Mpc/h mesh (1283-voxel grid). At small scales, k
≥
0.2 (Mpc/h)−1, the cross-correlations with respect to the
N-body-evolved ﬁeld are notably better after remapping than with LPT alone.

34
Chapter 2. Numerical diagnostics of Lagrangian perturbation theory
6
7
8
9
−2
−1
log B(k1) [(Mpc/h)6]
log k1 [(Mpc/h)−1]
Nbody
ZA
ZARM
2LPT
2LPTRM
BNL(k1)
Figure 2.6: Redshift-zero dark matter bispectra for equilateral triangle shape, in 1024 Mpc/h simulations, with density
ﬁelds computed on mesh of 8 Mpc/h size. The particle distribution is determined using: a full N-body simulation (purple
curve), the Zel’dovich approximation, alone (ZA, light red curve) and after remapping (ZARM, orange curve), second-
order Lagrangian perturbation theory, alone (2LPT, light blue curve) and after remapping (2LPTRM, green curve).
The dashed line, BNL(k), corresponds to theoretical predictions for the bispectrum, found using the ﬁtting formula of
(Gil-Marín et al., 2012). Note that both ZARM and 2LPTRM show increased bispectrum in the mildly non-linear regime
compared to ZA and 2LPT, indicating an improvement of three-point statistics with the remapping procedure.
correlation between the ZA and the full dynamics, meaning that the position of structures is more correct when
additional physics (non-local tidal eﬀects) is taken into account.
2.1.3
Three-point statistics
In this section, we analyze the accuracy of LPT beyond second-order statistics, by studying the three-point
correlation function of the density ﬁeld in Fourier space, i.e. the bispectrum, deﬁned by equation (1.56). The
importance of three-point statistics relies in their ability to test the shape of structures. Some of the natural
applications are to test gravity (Shirata et al., 2007; Gil-Marín et al., 2011), to break degeneracies due to the
galaxy bias (Matarrese, Verde & Heavens, 1997; Verde et al., 1998; Scoccimarro et al., 2001; Verde et al., 2002)
or to test the existence of primordial non-Gaussianities in the initial matter density ﬁeld (Sefusatti & Komatsu,
2007; Jeong & Komatsu, 2009).
As for the power spectrum, we construct the dark matter density contrast ﬁeld, by assigning particles to the
grid using a CiC scheme. We then deconvolve the CiC kernel to correct for corresponding smoothing eﬀects.
The algorithm used to compute the bispectrum B(k1, k2, k3) from this δ(k) ﬁeld consists of randomly drawing
k-vectors from a speciﬁed bin, namely ∆k, and randomly orientating the (k1, k2, k3) triangle in space. We
chose the number of random triangles to depend on the number of fundamental triangle per bin, that scales as
k1k2k3∆k3 (Scoccimarro, 1997), where ∆k is the chosen k-binning: given ki we allow triangles whose i-side lies
between ki −∆k/2 and ki + ∆k/2. In this paper we always set ∆k = kmin = 2π/L, where L is the size of the
box. For the equilateral case, at scales of k ≈0.1 (Mpc/h)−1 we generate ∼1.7×106 random triangles. We have
veriﬁed that increasing the number of triangles beyond this value does not have any eﬀect on the measurement.
The rule of thumb presented in section 2.1.2.1 for the smallest scale to trust applies for the bispectrum as well.
Also, as a lower limit in k, we have observed that for scales larger than ∼3 kmin, eﬀects of cosmic variance start
to be important and considerable deviations with respect to linear theory can be observed. For this reason, we
limit the largest scale for our bispectrum analysis to 3 kmin ≈1.8 × 10−2 (Mpc/h)−1.
Error bars in bispectrum plots represent the dispersion of the mean among eight independent realizations, all

2.1. Correlation functions of the density ﬁeld
35
−1.5
−1
−0.5
 0
 0.5
 1
 1.5
0.05
0.10
0.15
0.20
B(k1)/BNbody(k1) − 1
k1 [(Mpc/h)−1]
Mesh size 16 Mpc/h
ZA
ZARM
2LPT
2LPTRM
−1.5
−1
−0.5
 0
 0.5
 1
 1.5
0.05
0.10
0.15
0.20
0.25
0.30
0.35
k1 [(Mpc/h)−1]
Mesh size 8 Mpc/h
ZA
ZARM
2LPT
2LPTRM
−1.5
−1
−0.5
 0
 0.5
 1
 1.5
0.10
0.20
0.30
0.40
0.50
0.60
0.70
k1 [(Mpc/h)−1]
Mesh size 4 Mpc/h
ZA
ZARM
2LPT
2LPTRM
Figure 2.7: Bispectrum: mesh size-dependence. Relative deviations for the bispectra B(k1) of various particle distribu-
tions, with reference to the prediction from a full N-body simulation, BNbody(k1). The particle distribution is determined
using: the Zel’dovich approximation, alone (ZA, light red curve) and after remapping (ZARM, orange curve), second-
order Lagrangian perturbation theory, alone (2LPT, light blue curve) and after remapping (2LPTRM, green curve). The
computation of bispectra is done for equilateral triangles and on diﬀerent meshes: 16 Mpc/h (643-voxel grid, left panel),
8 Mpc/h (1283-voxel grid, central panel) and 4 Mpc/h (2563-voxel grid, right panel). All results are shown at redshift
z = 0. LPT ﬁelds exhibit more small-scale three-point correlations after remapping and their bispectra get closer to the
shape of the full non-linear bispectrum.
−3
−2
−1
 0
 1
 2
 3
 4
0.05
0.10
0.15
0.20
0.25
0.30
0.35
B(k1)/BNbody(k1) − 1
k1 [(Mpc/h)−1]
Redshift z = 3
ZA
ZARM
2LPT
2LPTRM
−2
−1.5
−1
−0.5
 0
 0.5
 1
 1.5
 2
0.05
0.10
0.15
0.20
0.25
0.30
0.35
k1 [(Mpc/h)−1]
Redshift z = 1
ZA
ZARM
2LPT
2LPTRM
−1.5
−1
−0.5
 0
 0.5
 1
 1.5
0.05
0.10
0.15
0.20
0.25
0.30
0.35
k1 [(Mpc/h)−1]
Redshift z = 0
ZA
ZARM
2LPT
2LPTRM
Figure 2.8: Bispectrum: redshift-dependence. Relative deviations for the bispectra B(k1) of various particle distributions
(see the caption of ﬁgure 2.7), with reference to a full N-body simulation, BNbody(k1). The computation of bispectra is
done on a 8 Mpc/h mesh (1283-voxel grid) and for equilateral triangles. Results at diﬀerent redshifts are shown: z = 3
(right panel), z = 1 (central panel) and z = 0 (left panel).

36
Chapter 2. Numerical diagnostics of Lagrangian perturbation theory
−1
−0.5
 0
 0.5
 1
0.05
0.10
0.15
0.20
0.25
0.30
0.35
B(k1)/BNbody(k1) − 1
k1 [(Mpc/h)−1]
Squeezed triangles (k2 = k1, θ12 = π/6)
ZA
ZARM
2LPT
2LPTRM
−1
−0.5
 0
 0.5
 1
 1.5
0.05
0.10
0.15
0.20
0.25
0.30
0.35
k1 [(Mpc/h)−1]
Equilateral triangles (k2 = k1, θ12 = π/3)
ZA
ZARM
2LPT
2LPTRM
−0.6
−0.4
−0.2
 0
 0.2
 0.4
 0.6
0.05
0.10
0.15
0.20
k1 [(Mpc/h)−1]
Folded triangles (k2 = k1, θ12 = 5π/6)
ZA
ZARM
2LPT
2LPTRM
Figure 2.9: Bispectrum: scale-dependence for diﬀerent triangle shapes. Relative deviations for the bispectra B(k1) of
various particle distributions (see the caption of ﬁgure 2.7), with reference to a full N-body simulation, BNbody(k1). The
computation is done on a 8 Mpc/h mesh (1283-voxel grid) and results are shown at redshift z = 0 for various triangle
shapes as deﬁned above.
−1
−0.5
 0
 0.5
 1
 0
 0.2
 0.4
 0.6
 0.8
 1
B(k1)/BNbody(k1) − 1
θ12/π
k1 = k2 = 0.05 (Mpc/h)−1
ZA
ZARM
2LPT
2LPTRM
−0.8
−0.6
−0.4
−0.2
 0
 0.2
 0.4
 0.6
 0
 0.2
 0.4
 0.6
 0.8
 1
θ12/π
k1 = k2 = 0.10 (Mpc/h)−1
ZA
ZARM
2LPT
2LPTRM
−0.8
−0.6
−0.4
−0.2
 0
 0.2
 0.4
 0.6
 0
 0.2
 0.4
 0.6
 0.8
 1
θ12/π
k1 = k2 = 0.15 (Mpc/h)−1
ZA
ZARM
2LPT
2LPTRM
Figure 2.10: Bispectrum: triangle shape-dependence.
Relative deviations for the bispectra B(k1) of various particle
distributions (see the caption of ﬁgure 2.7), with reference to a full N-body simulation, BNbody(k1). The computation
is done on a 8 Mpc/h mesh (1283-voxel grid) and results are shown at redshift z = 0. The dependence on the angle
of the triangle θ12 = (k1, k2) is shown for diﬀerent scales: k1 = k2 = 0.05 (Mpc/h)−1 (corresponding to 125 Mpc/h),
k1 = k2 = 0.10 (Mpc/h)−1 (corresponding to 63 Mpc/h), k1 = k2 = 0.15 (Mpc/h)−1 (corresponding to 42 Mpc/h).

2.2. Statistics of the Lagrangian displacement ﬁeld
37
0.00
0.05
0.10
0.15
0.20
0.25
0.30
0.35
−5
−4
−3
−2
−1
 0
 1
 2
 3
 4
 5
P(ψ)
ψ
Nbody
ZA
2LPT
Figure 2.11: Redshift-zero probability distribution function for the divergence of the displacement ﬁeld ψ, computed
from eight 1024 Mpc/h-box simulations of 5123 particles. A quantitative analysis of the deviation from Gaussianity of
these pdfs is given in table 2.1. The particle distribution is determined using: a full N-body simulation (purple curve),
the Zel’dovich approximation (ZA, light red curve) and second-order Lagrangian perturbation theory (2LPT, light blue
curve). The vertical line at ψ = −3 represents the collapse barrier about which ψ values bob around after gravitational
collapse. A bump at this value is visible with full gravity, but LPT is unable to reproduce this feature. This regime
corresponds to virialized, overdense clusters.
of them with the same cosmological parameters. It has been tested (Gil-Marín et al., 2012), that this estimator
for the error is in good agreement with theoretical predictions based on the Gaussianity of initial conditions
(Scoccimarro, 1998).
The subtracted shot noise is always assumed to be Poissonian:
BSN(k1, k2, k3) = 1
¯n [P(k1) + P(k2) + P(k3)] + 1
¯n2 ,
(2.3)
(see e.g. Peebles, 1980, and references therein), where ¯n is the number density of particles in the box.
A triangle shape is deﬁned by the relative length of vectors k1 and k2 and the inner angle θ12, in such a way
that k1 + k2 + k3 = 0 and k1 · k2 = k1k2 cos(π −θ12). In ﬁgure 2.6, we plot the redshift-zero bispectrum,
computed on a 8 Mpc/h mesh, of the diﬀerent density ﬁelds for equilateral triangles (θ12 = π/3 and k2/k1 = 1).
There, the dashed line corresponds to theoretical predictions for the non-linear bispectrum, found using the
ﬁtting formula of Gil-Marín et al. (2012). The relative deviations of various bispectra with reference to full
N-body simulations are shown in ﬁgures 2.7, 2.8, 2.9 and 2.10.
The main result is that LPT predicts less three-point correlation than full gravity. This is true even at large
scales for the ZA: as it is local, it generally fails to predict the shape of structures. 2LPT agrees with N-body
simulations at large scales, with diﬀerences starting to appear only in the mildly non-linear regime, k ≳0.1
(Mpc/h)−1 at z = 0.
2.2
Statistics of the Lagrangian displacement ﬁeld
2.2.1
Lagrangian ψ versus Eulerian δ: one-point statistics
This section draws from Leclercq, Jasche & Wandelt (2015b), addendum to Leclercq et al. (2013).
As noted by previous authors (see in particular Neyrinck, 2013), in the Lagrangian representation of the
LSS, it is natural to use the divergence of the displacement ﬁeld ψ instead of the Eulerian density contrast δ.
This section comments the one-point statistics of ψ in LPT and full gravity and comparatively analyzes key
features of ψ and δ.
As seen in section 1.5, in the Lagrangian frame, the quantity of interest is not the position, but the displace-
ment ﬁeld Ψ(q) which maps the initial comoving particle position q to its ﬁnal comoving Eulerian position x

38
Chapter 2. Numerical diagnostics of Lagrangian perturbation theory
Model
Pδ
Pψ
Skewness γ1
ZA
2.36 ± 0.01
−0.0067 ± 0.0001
2LPT
2.83 ± 0.01
−1.5750 ± 0.0002
N-body
5.14 ± 0.05
−0.4274 ± 0.0001
Excess kurtosis γ2
ZA
9.95 ± 0.09
−2.2154 × 10−6 ± 0.0003
2LPT
13.91 ± 0.15
3.544 ± 0.0011
N-body
62.60 ± 2.75
−0.2778 ± 0.0004
Table 2.1: Non-Gaussianity parameters (the skewness γ1 and the excess kurtosis γ2) of the redshift-zero probability
distribution functions Pδ and Pψ of the density contrast δ and the divergence of the displacement ﬁeld ψ, respectively.
The conﬁdence intervals given correspond to the 1-σ standard deviations among eight realizations. In all cases, γ1 and
γ2 are reduced when measured from ψ instead of δ.
0
50
100
150
200
x [Mpc/h]
0
50
100
150
200
y [Mpc/h]
δ in Nbody
0.0
0.3
0.6
0.9
1.2
1.5
1.8
2.1
2.4
2.7
3.0
ln(2 + δ)
0
50
100
150
200
x [Mpc/h]
0
50
100
150
200
y [Mpc/h]
ψ in Nbody
−4.0
−3.2
−2.4
−1.6
−0.8
0.0
0.8
1.6
2.4
3.2
4.0
ψ
0
50
100
150
200
x [Mpc/h]
0
50
100
150
200
y [Mpc/h]
ψ in 2LPT
−4.0
−3.2
−2.4
−1.6
−0.8
0.0
0.8
1.6
2.4
3.2
4.0
ψ
0
50
100
150
200
x [Mpc/h]
0
50
100
150
200
y [Mpc/h]
ψ in ZA
−4.0
−3.2
−2.4
−1.6
−0.8
0.0
0.8
1.6
2.4
3.2
4.0
ψ
Figure 2.12: Slices of the divergence of the displacement ﬁeld, ψ, on a Lagrangian sheet of 5122 particles from a 5123-
particle simulation of box size 1024 Mpc/h, run to redshift zero. For clarity we show only a 200 Mpc/h region. Each
pixel corresponds to a particle. The particle distribution is determined using respectively a full N-body simulation, the
Zel’dovich approximation (ZA) and second-order Lagrangian perturbation theory (2LPT). In the upper left panel, the
density contrast δ in the N-body simulation is shown, after binning on a 5123-voxel grid. To guide the eye, some clusters
and voids are identiﬁed by yellow and purple dots, respectively. The “lakes”, Lagrangian regions that have collapsed
to form halos, are only visible in the N-body simulation, while the “mountains”, Lagrangian regions corresponding to
cosmic voids, are well reproduced by LPT.

2.2. Statistics of the Lagrangian displacement ﬁeld
39
−3
−2
−1
0
1
2
3
4
ln(1 + δZA)
0.0
0.4
0.8
1.2
1.6
2.0
2.4
2.8
3.2
3.6
log10(N)
−3
−2
−1
0
1
2
3
4
ln(1 + δNbody)
−3
−2
−1
0
1
2
3
4
ln(1 + δ2LPT)
0.0
0.5
1.0
1.5
2.0
2.5
3.0
3.5
4.0
log10(N)
−6
−4
−2
0
2
4
6
ψZA
0.0
0.4
0.8
1.2
1.6
2.0
2.4
2.8
3.2
log10(N)
−6
−4
−2
0
2
4
6
ψNbody
−6
−4
−2
0
2
4
6
ψ2LPT
0.0
0.4
0.8
1.2
1.6
2.0
2.4
2.8
3.2
3.6
log10(N)
Figure 2.13: Left panel. Two-dimensional histograms comparing particle densities evolved with full N-body dynamics
(the x-axis) to densities in the LPT-evolved particle distributions (the y-axis). The red lines show the ideal y = x
locus. A turn-up at low densities is visible with 2LPT, meaning that some overdense regions are predicted where there
should be deep voids. Right panel. Same plot for the divergence of the displacement ﬁeld ψ. Negative ψ corresponds to
overdensities and positive ψ correspond to underdensities. The dotted blue line shows the collapse barrier at ψ = −3
where particle get clustered in full gravity. The scatter is bigger with ψ than with δ, in particular in overdensities, since
with LPT, particles do not cluster. The turn-up at low densities with 2LPT, observed with the density contrast, is also
visible with the divergence of the displacement ﬁeld.

40
Chapter 2. Numerical diagnostics of Lagrangian perturbation theory
(see e.g. Bouchet et al., 1995 or Bernardeau et al., 2002 for overviews),
x ≡q + Ψ(q).
(2.4)
It is important to note that, though Ψ(q) is a priori a full three-dimensional vector ﬁeld, it is curl-free up to
second order in LPT (appendix D in Bernardeau, 1994 or Bernardeau et al., 2002 for a review). In this thesis,
we do not consider perturbative contributions beyond 2LPT.
Let ψ(q) ≡∇q · Ψ(q) denote the divergence of the displacement ﬁeld, where ∇q is the divergence operator
in Lagrangian coordinates. ψ quantiﬁes the angle-averaged spatial-stretching of the Lagrangian dark matter
“sheet” in comoving coordinates (Neyrinck, 2013).
Let Pψ,LPT and Pψ,Nbody be the one-point probability
distribution functions for the divergence of the displacement ﬁeld in LPT and in full N-body ﬁelds, respectively.
We denote by Pδ the corresponding pdfs for the Eulerian density contrast.
In ﬁgure 2.11, we show the pdfs of ψ for the ZA, 2LPT and full N-body gravity. The most important feature
of ψ is that, whatever the model for structure formation, the pdf exhibits reduced non-Gaussianity compared
to the pdf for the density contrast δ (see the upper panel of ﬁgure 2.1 for comparison). The main reason is that
Pδ, unlike Pψ, is tied down to zero at δ = −1. It is highly non-Gaussian in the ﬁnal conditions, both in N-body
simulations and in approximations to the true dynamics. For a quantitative analysis, we looked at the ﬁrst and
second-order non-Gaussianity statistics: the skewness γ1 and the excess kurtosis γ2,
γ1 ≡µ3
σ3
and
γ2 ≡µ4
σ4 −3,
(2.5)
where µn is the n-th moment about the mean and σ is the standard deviation. We estimated γ1 and γ2 at
redshift zero in our simulations, in the one-point statistics of the density contrast δ and of the divergence of the
displacement ﬁeld ψ. The results are shown in table 2.1. In all cases, we found that both γ1 and γ2 are much
smaller when measured from Pψ instead of Pδ.
At linear order in Lagrangian perturbation theory (the Zel’dovich approximation), the divergence of the
displacement ﬁeld is proportional to the density contrast in the initial conditions, δ(q), scaling with the negative
growth factor, −D1(τ):
ψ(1)(q, τ) = ∇q · Ψ(1)(q, τ) = −D1(τ) δ(q).
(2.6)
Since we take Gaussian initial conditions, the pdf for ψ is Gaussian at any time with the ZA. In full gravity,
non-linear evolution slightly breaks Gaussianity. Pψ,Nbody is slightly skewed towards negative values while its
mode gets shifted around ψ ≈1. Taking into account non-local eﬀects, 2LPT tries to get closer to the shape
observed in N-body simulations, but the correct skewness is overshot and the pdf is exceedingly peaked.
Figure 2.12 shows a slice of the divergence of the displacement ﬁeld, measured at redshift zero for particles
occupying a ﬂat 5122-pixel Lagrangian sheet from one of our simulations. For comparison, see also the ﬁgures
in Mohayaee et al. (2006); Pueblas & Scoccimarro (2009) and Neyrinck (2013). We used the color scheme of
the latter paper, suggesting a topographical analogy when working in Lagrangian coordinates. As structures
take shape, ψ departs from its initial value; it takes positive values in underdensities and negative values in
overdensities. The shape of voids (the “mountains”) is found to be reasonably similar in LPT and in the N-
body simulation. For this reason, the inﬂuence of late-time non-linear eﬀects in voids is milder as compared to
overdense structures, which makes them easier to relate to the initial conditions. However, in overdense regions
where ψ decreases, it is not allowed to take arbitrary values: where gravitational collapse occurs, “lakes” form
and ψ gets stuck around a collapse barrier, ψ ≈−3. As expected, these “lakes”, corresponding to virialized
clusters, can only be found in N-body simulations, since LPT fails to accurately describe the highly non-linear
physics involved. A small bump at ψ = −3 is visible in Pψ,Nbody (see ﬁgure 2.11). We checked that this bump
gets more visible in higher mass-resolution simulations (200 Mpc/h box for 2563 particles), where matter is
more clustered. This means that part of the information about gravitational clustering can be found in the
one-point statistics of ψ. Of course, the complete description of halos requires to precisely account for the shape
of the “lakes”, which can only be done via higher-order correlation functions. More generally, it is possible
to use Lagrangian information in order to classify structures of the cosmic web. In particular, diva (Lavaux
& Wandelt, 2010) uses the shear of the displacement ﬁeld and origami (Falck, Neyrinck & Szalay, 2012) the
number of phase-space folds. While these techniques cannot be straightforwardly used for the analysis of galaxy
surveys, where we lack Lagrangian information, recently proposed techniques for physical inference of the initial
conditions (chapters 4 and 5 Jasche & Wandelt, 2013a; Jasche, Leclercq & Wandelt, 2015) should allow their
use with observational data.

2.2. Statistics of the Lagrangian displacement ﬁeld
41
Figure 2.13 shows two-dimensional histograms comparing N-body simulations to the LPT realizations for
the density contrast δ and the divergence of the displacement ﬁeld ψ. At this point, it is useful to note that a
good mapping exists in the case where the relation shown is monotonic and the scatter is narrow. As pointed
out by Sahni & Shandarin (1996) and Neyrinck (2013), matter in the substructure of 2LPT-voids has incorrect
statistical properties: there are overdense particles in the low density region of the 2LPT δ-scatter plot. This
degeneracy is also visible in the ψ > 0 region of the 2LPT ψ-scatter plot. On average, the scatter is bigger with
ψ than with δ, in particular in overdensities (ψ < 0), since with LPT, particles do not cluster: ψ takes any
value between 2 and −3 where it should remain around −3.
Summing up our discussions in this paragraph, we analyzed the relative merits of the Lagrangian divergence
of the displacement ﬁeld ψ, and the Eulerian density contrast δ at the level of one-point statistics. The important
diﬀerences are the following:
1. Ψ being irrotational up to order two, its divergence ψ contains nearly all information on the displacement
ﬁeld in one dimension, instead of three. The collapse barrier at ψ = −3 is visible in Pψ for N-body
simulations but not for LPT. A part of the information about non-linear gravitational clustering is therefore
encoded in the one-point statistics of ψ.
2. ψ exhibits much fewer gravitationally-induced non-Gaussian features than δ in the ﬁnal conditions (ﬁgure
2.11 and table 2.1).
3. However, the values of ψ are more scattered than the values of δ with respect to the true dynamics (ﬁgure
2.13), meaning that an unambiguous mapping is more diﬃcult.
2.2.2
Perturbative and non-perturbative prescriptions for ψ
Even if ψ does not contain all the information about the vector displacement ﬁeld Ψ, knowledge of its
evolution allows for methods to produce approximate particle realizations at the desired redshift, for the variety
of cosmological applications described in the introduction of this thesis. These methods include, but are not
limited to, the ZA and 2LPT. On the contrary, 3LPT involves a non-zero rotational component and comes
at the expense of signiﬁcantly greater complexity, for an agreement with full gravity that does not improve
substantially (Buchert, Melott & Weiß, 1994; Bouchet et al., 1995; Sahni & Shandarin, 1996). Since we have
adopted the approximation that the displacement ﬁeld is potential, we stop our analysis of LPT at second order.
However, we will describe various non-perturbative schemes.
Importantly, ψ-based methods are essentially as fast as producing initial conditions for N-body simulations.
Their implementation can be decomposed in several steps:
1. Generation of a voxel-wise initial-density ﬁeld δ. It is typically a grf, given a prescription for the linear
power spectrum (see section B.6), but it can also include primordial non-Gaussianities.
2. Estimation of ψ from δ at the desired redshift.
3. Generation of the ﬁnal vector displacement ﬁeld Ψ from ψ with an inverse-divergence operator.
4. Application of Ψ to the particles of a regular Lagrangian lattice to get their ﬁnal positions.
In practice, steps 1 and 3 are performed in Fourier space, using fast Fourier transforms to translate between
conﬁguration space and Fourier space when necessary. In the remainder of this paragraph, we review various
prescriptions that have been proposed in the literature to estimate ψ(q, τ) from δ(q) (step 2).
The Zel’dovich approximation.
The ﬁrst scheme, already studied in section 1.5.2, is the ZA (equation (1.128)),
ψZA(q, τ) = −D1(τ) δ(q) ≡−δL(q, τ).
(2.7)
The ZA allows to separate prescriptions for ψ into two classes: local Lagrangian approximations, where ψ
depends only on its linear value, ψL(q, τ) ≡−δL(q, τ) and non-local ones (e.g. higher-order LPT) where ψ
depends on derivatives of ψL as well (which means that the behavior of a Lagrangian particle depends on its
neighbours).

42
Chapter 2. Numerical diagnostics of Lagrangian perturbation theory
Second-order Lagrangian perturbation theory.
In 2LPT, the non-local prescription for ψ is (see equation
(1.133))
ψ2LPT(q, τ) = −D1(τ)∆qφ(1)(q) + D2(τ)∆qφ(2)(q),
(2.8)
where the Lagrangian potentials follow the Poisson-like equations (1.134) and (1.135).
As pointed out by
Neyrinck (2013), since 2LPT is a second-order scheme, ψ2LPT is roughly parabolic in the local δL, which yields,
using D2(τ) ≈−3
7D2
1(τ) (Bouchet et al., 1995),
ψ2LPT(q, τ) ≈ψ2LPT,parab(q, τ) ≡−δL(q, τ) + 1
7 (δL(q, τ))2 .
(2.9)
The spherical collapse approximation.
Bernardeau (1994) provides a simple formula for the time-evolution
(collapse or expansion) of a spherical Lagrangian volume element, independent of cosmological parameters:
V (q, τ) = V (q)

1 −2
3δL(q, τ)
3/2
.
(2.10)
Building upon this result, Mohayaee et al. (2006); Lavaux (2008) and Neyrinck (2013) derived a prescription
for the divergence of the displacement ﬁeld. Considering the isotropic stretch of a Lagrangian mass element
that occupies a cube of side length 1 + ψ/3 (giving ∇q · Ψ = ψ), mass conservation imposes
V (q, τ)
V (q)
=
1
1 + δ =

1 + ψ
3
3
.
(2.11)
Equations (2.10) and (2.11) yield
ψ = 3
 r
1 −2
3δL −1
!
.
(2.12)
However, there exists no solution for δL > 3/2. Neyrinck (2013) proposes to ﬁx ψ = −3 in such volume elements.
This corresponds to the ideal case of a Lagrangian patch contracting to a single point (∇q · x = 0). The ﬁnal
prescription for the spherical collapse (SC) approximation is then
ψSC(q, τ) =





3
 r
1 −2
3δL(q, τ) −1
!
if δL < 3/2,
−3
if δL ≥3/2.
(2.13)
One possible concern with this formula is that, in full gravity, there are roughly as many particles with ψ > −3
as with ψ < −3 (see e.g. trajectories in ψ as a function of the scale factor a, ﬁgure 7 in Neyrinck, 2013). Yet,
this remains more correct than what happens with LPT, where ψ can take any negative value, indicating severe
unphysical over-crossing of particles in collapsed structures.
Compared to LPT, the SC approximation gives reduced stream-crossing, better small-scale ﬂows and one-
point pdf correspondence to the results of full gravity. However, a signiﬁcant drawback is its incorrect treatment
of large-scale ﬂows, leading to a negative oﬀset in the large-scale power spectrum (ﬁgure 14 in Neyrinck, 2013).2
LPT realizations, on the other hand, give more accurate large-scale power spectra, as well as improved cross-
correlation to the density ﬁeld evolved with full gravity.
Local Lagrangian approximations.
The SC approximation belongs to a more general family of “local La-
grangian” approximations investigated by Protogeros & Scherrer (1997), parameterized by 1 ≤α ≤3, the
eﬀective number of axes along which the considered volume element undergoes gravitational collapse.
The
corresponding density is given by
δα(ψ) =

1 + ψ
α
−α
−1.
(2.14)
2 An empirical correction may be added to the SC formula to ﬁx this issue: multiplying δL in equation (2.13) by a factor such
that the large-scale power spectrum of SC realizations agrees with that of LPT realizations (Neyrinck, 2013). See also the paragraph
on muscle.

2.2. Statistics of the Lagrangian displacement ﬁeld
43
Here, ψ is the actual non-linear displacement-divergence of a volume element, not necessarily related to the
linearly evolved ψL. From equations (2.10) and (2.11), we get
δ =

1 −2
3δL
−3/2
−1 =

1 + 2
3ψL
−3/2
−1,
(2.15)
therefore the spherical collapse approximation corresponds to the case α = 3/2 for ψ = ψL. The cubic mass-
element approximation that would follow directly from using equation (2.11) without equation (2.10) corresponds
to the case α = 3 for the full ψ. Neyrinck (2013) shows that the δ–ψ relation closely follows δ3(ψ) for ψ < 0,
whereas for ψ > 0 the result is between δ3(ψ) and δ3/2(ψ), when accounting for the anisotropy of gravitational
expansion.
Augmented Lagrangian Perturbation Theory.
As discussed before, LPT correctly describes large scales and
SC more accurately captures small, collapsed structures. Kitaura & Heß (2013) proposed a recipe to interpolate
between the LPT displacement on large scales and the SC displacement on small scales, calling it Augmented
Lagrangian Perturbation Theory (ALPT). It reads
ψALPT(q, τ) = (KRs ∗ψ2LPT)(q, τ) + [(1 −KRs) ∗ψSC](q, τ),
(2.16)
or, in Lagrangian Fourier space,3
ψALPT(κ, τ) = KRs(κ) ψ2LPT(κ, τ) + [1 −KRs(κ)] ψSC(κ, τ).
(2.17)
This method introduces a free parameter, Rs, the width of the Gaussian kernel used in the above equations
to ﬁlter between large and small displacements, KRs(k) ∝exp(−k2/2 × (Rs/2π)2). In numerical experiments,
Kitaura & Heß (2013) empirically found that the range Rs = 4−5 Mpc/h yields the best density cross-correlation
to full gravity.
Multi-scale spherical collapse evolution.
Neyrinck (2015a) argued that the major deﬁciency in the SC ap-
proximation is its treatment of the void-in-cloud process (in the terminology originally introduced by Sheth &
van de Weygaert, 2004), i.e. of small underdensities in larger-scale overdensities. Such regions should eventually
collapse, which is not accounted for in SC. To overcome this problem, he proposes to use the SC prescription
as a function of the initial density contrast on multiple Gaussian-smoothed scales, thus including the void-
in-cloud process. The resulting parameter-free scheme, muscle (MUltiscale Spherical-CoLlapse Evolution),
mathematically reads
ψMUSCLE(q, τ) =





3
 r
1 −2
3δL(q, τ) −1
!
if δL < 3/2 and ∀Rs ≥Ri, KRs ∗δL < 3/2,
−3
otherwise,
(2.18)
where Ri is the resolution of the initial density ﬁeld δ(q), and KRs ∗δL is the linearly extrapolated initial density
ﬁeld, smoothed using a Gaussian kernel of width Rs. In practice, a ﬁnite number of scales r > Ri have to be
tried (for example r = 2nRi for integers 0 ≤n ≤nmax such that 2nmaxRi ≤L and 2nmax+1Ri > L).
Neyrinck (2015a) checked that muscle corrects the problems of SC at large scales and outperforms the ZA
and 2LPT in terms of the density cross-correlation to full gravity.
2.2.3
Non-linear evolution of ψ and generation of a vector part
Beyond the approximations presented in the previous section, Chan (2014) analyzed the non-linear evolution
of Ψ in full gravity, splitting it into its scalar and vector parts (the so-called “Helmholtz decomposition”):
Ψ(q) = ∇qφ(q) + ∇q × A(q),
(2.19)
with
∆qφ
=
∇q · Ψ(q),
(2.20)
∆qA(q)
=
−∇q × Ψ(q).
(2.21)
3 We denote by κ a Fourier mode on the Lagrangian grid, κ its norm.

44
Chapter 2. Numerical diagnostics of Lagrangian perturbation theory
100
101
102
γi
ZA voids
2LPT voids
ZA clusters
2LPT clusters
16
8
4
2
Resolution [Mpc/h]
10−1
100
101
102
−γi
ZA sheets
2LPT sheets
ZA ﬁlaments
2LPT ﬁlaments
Figure 2.14: Relative volume fraction of voids, sheets, ﬁlaments and clusters predicted by LPT, compared to N-body
simulations, as a function of the resolution used for the deﬁnition of the density ﬁelds. The points are sightly randomized
on the x-axis for clarity. The estimators γi are deﬁned by eq (2.22). Eight realizations of the ZA (circles) and 2LPT
(triangles) are compared to the corresponding N-body realization, for various resolutions.
The volume fraction of
incorrectly predicted structures in LPT generally increases with increasing resolution.
Looking at two-point statistics of Ψ, he found that shell-crossing leads to a suppression of small-scale power
in the scalar part, and, subdominantly, to the generation of a vector contribution.
Even at late-time and
non-linear scales, the scalar part of the displacement ﬁeld remains the dominant contribution. The rotational
component is much smaller and does not have a coherent large-scale component.
Therefore, the potential
approximation is still good even when shell-crossing is non-negligible.
However, as pointed out by Neyrinck (2015a), even if we neglect the rotational component, there is still a
long way to go before we can perfectly predict ψ. Variants of LPT, such as ALPT (primarily motivated by the
agreement in the scatter plot of ﬁnal versus initial ψ – see ﬁgure 6 in Neyrinck, 2013 and ﬁgure 10 in Chan,
2014) or the inclusion of a suppression factor in the LPT displacement potential (Chan, 2014 – designed for
ﬁtting the non-linear power spectrum of Ψ) extract information from simulations by taking the average of some
statistics. Since shell-crossing is a highly non-linear process, it may not be surprising that such approaches
yield limited success compared to standard LPT for some other statistics (such as the density power spectrum
or phase accuracy). This suggests that a more detailed understanding and modeling of the small-scale physics
beyond the simple phenomenological approach is required for improvement in ψ-based schemes, which would
substantially increase the accuracy of particle realizations.
2.3
Comparison of structure types in LPT and N-body dynamics
This section draws from section II.B. in Leclercq et al. (2013).
In this section, we perform a study of diﬀerences in structure types in density ﬁelds predicted by LPT
and N-body simulations. We employ the web-type classiﬁcation algorithm proposed by Hahn et al. (2007a),
which relies on estimating the eigenvalues of the Hessian of the gravitational potential (see section C.2). This
algorithm dissects the voxels into four diﬀerent web types (voids, sheets, ﬁlaments and clusters). Due to the
diﬀerent representations of the non-linear regime of structure formation, we expect diﬀerences in structure
types in LPT and N-body simulations. In particular, overdense clusters are objects in the strongly non-linear
regime, far beyond shell-crossing, where predictions of LPT fail, while underdense voids are believed to be better
apprehended (e.g. Bernardeau et al., 2002).

2.3. Comparison of structure types in LPT and N-body dynamics
45
As an indicator of the mismatch between the volume occupied by diﬀerent structure types in LPT and
N-body dynamics, we use the quantities γi deﬁned by
γi ≡N LPT
i
−N Nbody
i
N Nbody
i
,
(2.22)
where i indexes one of the four structure types (T0 = void, T1 = sheet, T2 = ﬁlament, T3 = cluster), and
N LPT
i
and N Nbody
i
are the numbers of voxels ﬂagged as belonging to a structure of type Ti, in corresponding
LPT and in N-body realizations, respectively. At ﬁxed resolution, corresponding realizations have the same
total number of voxels Ntot, so we also have
γi = VFFLPT
i
VFFNbody
i
−1,
(2.23)
where the volume ﬁlling fraction of structure type Ti is deﬁned by VFFi ≡Ni/Ntot.
In ﬁgure 2.14, we plot γi as a function of the voxel size used to deﬁne the density ﬁelds. γi is positive for
clusters and voids, and negative for sheets and ﬁlaments, meaning that too large cluster and void regions are
predicted in LPT, at the detriment of sheets and ﬁlaments. More speciﬁcally, LPT predicts fuzzier halos than
N-body dynamics, and incorrectly predicts the surroundings of voids as part of them. This result indicates that
even though LPT and N-body ﬁelds look visually similar, there are crucial diﬀerences in the representation of
structure types. As demonstrated by ﬁgure 2.14, this mismatch increases with increasing resolution. This eﬀect
is of general interest when employing LPT in LSS data analysis.


Part II
Bayesian large-scale structure inference


Chapter 3
Bayesian cosmostatistics
Contents
3.1
Introduction: plausible reasoning . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
49
3.1.1
On the deﬁnition of probability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
50
3.1.2
On parameter determination
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
50
3.1.3
Probability theory as extended logic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
50
3.2
Inverse problems and the mechanism of experimental learning . . . . . . . . . . . . .
51
3.2.1
What is Bayesian analysis?
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
52
3.2.2
Prior choice . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
52
3.3
Bayesian data analysis problems
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
54
3.3.1
First level analysis: Bayesian parameter inference . . . . . . . . . . . . . . . . . . . . . . . .
54
3.3.2
Exploration of the posterior . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
54
3.3.3
Second level analysis: Bayesian model comparison
. . . . . . . . . . . . . . . . . . . . . . .
56
3.4
Markov Chain Monte Carlo techniques for parameter inference
. . . . . . . . . . . .
58
3.4.1
Markov Chains . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
58
3.4.2
The Metropolis-Hastings algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
59
3.4.3
Hamiltonian Monte Carlo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
60
“A previous acquaintance with probability and statistics is not nec-
essary; indeed, a certain amount of innocence in this area may be
desirable, because there will be less to unlearn.”
— Edwin Thompson Jaynes (2003), Probability Theory: The Logic
of Science
Abstract
In this chapter, essential concepts of Bayesian statistics in the context of cosmological data analysis are presented. We
discuss motivations for seeing probabilistic calculations as an extension of ordinary logic and justify the use of a prior
in an experimental learning process by referring to the “no-free lunch theorem”. This chapters also reviews parameter
inference, model comparison, and contains a brief introduction to the subject of Markov Chain Monte Carlo methods.
This chapter aims at introducing the necessary background in Bayesian probability theory for presenting the
borg algorithm in chapter 4 and applications in the following chapters. A much more complete picture can be
found in the reference book of Gelman et al. (2013). For introductions to Bayesian statistics in a cosmological
context, see Hobson (2010) and the reviews or lecture notes by Trotta (2008); Heavens (2009); Verde (2010);
Leclercq, Pisani & Wandelt (2014).
This chapter is organized as follows. Section 3.1 is a general introduction on plausible reasoning. Basic
concepts and deﬁnitions used in Bayesian statistics are presented in section 3.2. In section 3.3, we discuss
standard statistical inference problems. Finally, section 3.4 is summarizes the basics of Markov Chain Monte
Carlo methods.
3.1
Introduction: plausible reasoning
When discussing statistical data analysis, two diﬀerent points of view are traditionally reviewed and opposed:
the frequentist (see e.g. Kendall & Stuart, 1968) and the Bayesian approaches. In this author’s experience,

50
Chapter 3. Bayesian cosmostatistics
arguments for or against each of them are generally on the level of a philosophical or ideological position, at
least among cosmologists in 2015. Before criticizing this controversy, somewhat dated to the 20th century, and
stating that more recent scientiﬁc work suppresses the need to appeal to such arguments, we report the most
common statements encountered.
3.1.1
On the deﬁnition of probability
Frequentist and Bayesian statistics diﬀer in the epistemological interpretation of probability and their con-
sequences for testing hypotheses and comparing models. First and foremost, the methods diﬀer on the un-
derstanding of the concept of the probability P(A) of an event A. In frequentist statistics, one deﬁnes the
probability P(A) as the relative frequency with which the event A occurs in repeated experiments, i.e. the
number of times the event occurs over the total number of trials, in the limit of a inﬁnite series of equiprobable
repetitions. As forcefully argued for example by Trotta (2008), this probability (deﬁnition) has several short-
comings. Besides being useless in real life (as it assumes an inﬁnite repetition of experiments with nominally
identical test conditions, requirement that is never met in most practical cases), it cannot handle unrepeatable
situations, which have a particular importance in cosmology, as we have exactly one sample of the Universe.
More importantly, this deﬁnition is surprisingly circular, in the sense that it assumes that repeated trials are
equiprobable, whereas it is the very notion of probability that is being deﬁned in the ﬁrst place.
On the other hand, in Bayesian statistics, the probability P(A) represents the degree of belief that any
reasonable person (or machine) shall attribute to the occurrence of event A under consideration of all available
information. This deﬁnition implies that in Bayesian theory, probabilities are used to quantify uncertainties
independently of their origin, and therefore applies to any event. In other words, probabilities represent a state
of knowledge in presence of partial information. This is the intuitive concept of probability as introduced by
Laplace, Bayes, Bernoulli, Gauß, Metropolis, Jeﬀreys, etc. (see Jaynes, 2003).
3.1.2
On parameter determination
Translated to the measurement of a parameter in an experiment, the deﬁnitions of probabilities given in the
previous section yield diﬀerences in the questions addressed by frequentist and Bayesian statistical analyses.
In the frequentist point of view, statements are of the form: “the measured value x occurs with probability
P(x) if the measurand X has the true value X ”. This means that the only questions that can be answered are
of the form: “given the true value X of the measurand X, what is the probability distribution of the measured
values x?”. It also implies that statistical analyses are about building estimators, ˆX, of the truth, X .
In contrast, Bayesian statistics allows statements of the form: “given the measured value x, the measurand
X has the true value X with probability Q ”. Therefore, one can also answer the question: “given the observed
measured value x, what is the probability that the true value of X is X ?”, which arguably is the only natural
thing to demand from data analysis. For this reason, Bayesian statistics oﬀers a principled approach to the
question underlying every measurement problem, of how to infer the true value of the measurand given all
available information, including observations.
In summary, in the context of parameter determination, the fundamental diﬀerence between the two ap-
proaches is that frequentist statistics assumes the measurement to be uncertain and the measurand known, while
Bayesian statistics assumes the observation to be known and the measurand uncertain. Similar considerations
can be formulated regarding the problems of hypothesis testing and model comparison.
3.1.3
Probability theory as extended logic
As outlined in the seminal work of Cox (1946), popularized and generalized by Jaynes (in particular in his
inspirational posthumous book, Jaynes, 2003),1 neither the Bayesian nor the frequentist approach is universally
applicable. It is possible to adopt a more general viewpoint that can simply be referred to as “probability
theory”, which encompasses both approaches. This framework automatically includes all Bayesian and frequen-
tist calculations, but also contains concepts that do not ﬁt into either category (for example, the principle of
maximum entropy, which can be applied in the absence of a particular model, when very little is known beyond
the raw data).
1 At this point, the inﬂuence of Shannon (1948) and Pólya (1954a,b) should also be emphasized.

3.2. Inverse problems and the mechanism of experimental learning
51
In the author’s view, this approach is a breakthrough that remains shockingly unknown in astrophysics. As
we believe that a conceptual understanding of these concepts are of interest for the purpose of this thesis, we
now qualitatively describe the salient features of this way of thinking.
The Cox-Jaynes theorem (1946) states that there is only a single set of rules for doing plausible reasoning
which is consistent with a set of axioms that is in qualitative correspondence with common sense. These axioms,
or desiderata, are (Jaynes, 2003, section 1.7):
1. Degrees of plausibility are represented by real numbers. We denote by w(A|B) the real number assigned
to the plausibility of some proposition A, given some other proposition B.
2. Plausible reasoning qualitatively agrees with human common sense with respect to the “direction” in which
reasoning is to go. Formally, we introduce a continuity assumption: w(A) changes only inﬁnitesimally if A
changes inﬁnitesimally. In addition, if some old information C gets updated to C′ in such a way that the
plausibility of A is increased, but the plausibility of A given B is unchanged, i.e. w(A|C′) > w(A|C) and
w(B|AC′) = w(B|AC), we demand that the plausibility that A is false decrease, i.e. w( ¯A|C′) < w( ¯A|C),
and that the plausibility of A and B can only increase, i.e. w(AB|C′) ≥w(AB|C).
3. Plausible reasoning is performed consistently. This is requiring the three common colloquial meanings of
the word “consistent”:
(a) If a conclusion can be reached in more than one way, then every possible way must lead to the same
result.
(b) Consistent plausible reasoning always takes into account all of the evidence it has relevant to a
question. It does not arbitrarily ignore some of the available information, basing its conclusion on
what remains. In other words, it is completely non-ideological.
(c) Equivalent states of knowledge (up to the labeling of propositions) are represented by equal plausibility
assignments.
The Cox-Jaynes theorem demonstrates that the only consistent system to manipulate numerical “plausibilities”
that respect these rules is isomorphic to probability theory,2 and shows that this system consistently extends
the two-valued Boolean algebra {0, 1} to the continuum [0, 1]. This paradigm therefore introduces a “logical”
interpretation of probabilities that can be deduced without any reference to frequencies.
In this perspective, statistical techniques that use Bayes’ theorem or the maximum-entropy inference rule
are fully as valid as any based on the frequentist interpretation of probability. In fact, they are the unique
consistent generalization of logical deduction in the presence of uncertainty. As demonstrated by Jaynes, their
introduction enables to broaden the scope of probability theory so that it includes various seemingly unrelated
ﬁelds, such as communication theory of the maximum-entropy interpretation of thermodynamics. They also
provides a rational basis to the mechanism of logical induction and therefore to machine learning.
3.2
Inverse problems and the mechanism of experimental learning
This section draws from section 3 in Leclercq, Pisani & Wandelt (2014).
The “plausible reasoning” framework described in section 3.1 can be formulated mathematically by introduc-
ing the concept of conditional probability P(A|B), which describes the probability that event A will occur given
whatever information B is given on the right side of the vertical conditioning bar. To conditional probabilities
applies the following famous identity, which allows to go from forward modeling to the inverse problem, by
noting that if one knows how x arises from y, then one can use x to constrain y:
P(y|x)P(x) = P(x|y)P(y) = P(x, y).
(3.1)
This observation forms the basis of Bayesian statistics.
2 Formally, the theorem states that there exists an isomorphism f such that for any two propositions A, B, we have f ◦w(A|B) =
P(A|B).

52
Chapter 3. Bayesian cosmostatistics
3.2.1
What is Bayesian analysis?
Bayesian analysis is a general method for updating the probability estimate for a theory in light of new data.
It is based on Bayes’ theorem,
P(θ|d) = P(d|θ)P(θ)
P(d)
.
(3.2)
In the previous formula, θ represents the set of model parameters for a particular theory and d the data (before
it is known), written as a vector. Therefore,
• P(d|θ) is the probability of the data before it is known, given the theory. It is called the likelihood;
• P(θ) is the probability of the theory in the absence of data. It is called the prior probability distribution
function or simply the prior;
• P(θ|d) is the probability of the theory after the data is known.
It is called the posterior probability
distribution function or simply the posterior;
• P(d) is the probability of the data before it is known, without any assumption about the theory. It is
called the evidence.
A simple way to summarize Bayesian analysis can be formulated by the following:
Whatever is uncertain gets a pdf.
This statement can be a little disturbing at ﬁrst (e.g.
the value of Ωm is a constant of nature, certainly
not a random number of an experiment).
What it means is that in Bayesian statistics, pdfs are used to
quantify uncertainty of all kinds, not just what is usually referred to as “randomness” in the outcome of an
experiment.
In other words, the pdf for an uncertain parameter can be thought as a “belief distribution
function”, quantifying the degree of truth that one attributes to the possible values for some parameter (see the
discussion in section 3.1.1). Certainty can be represented by a Dirac distribution, e.g. if the data determine the
parameters completely.
The inputs of a Bayesian analysis are of two sorts:
• the prior: it includes modeling assumptions, both theoretical and experimental. Specifying a prior is a
systematic way of quantifying what one assumes true about a theory before looking at the data.
• the data: in cosmology, these can include the temperature in pixels of a CMB map, galaxy redshifts,
photometric redshifts pdfs, etc. Details of the survey speciﬁcations have also to be accounted for at this
point: noise, mask, survey geometry, selection eﬀects, biases, etc.
A key point is that the output of a Bayesian analysis is a pdf, the posterior density. Therefore, contrary to
frequentist statistics, the output of the analysis is not an estimator for the parameters. The word “estimator”
has a precise meaning in frequentist statistics: it is a function of the data which returns a number that is meant
to be close to the parameter it is designed to estimate; or the left and right ends of a conﬁdence interval, etc.
The outcome of a Bayesian analysis is the posterior pdf, a pdf whose values give a quantitative measure of the
relative degree of rational belief in diﬀerent parameter values given the combination of prior information and
the data.
3.2.2
Prior choice
The prior choice is a key ingredient of Bayesian statistics. It is sometimes considered problematic, since
there is no unique prescription for selecting the prior. Here we argue that prior speciﬁcation is not a limitation
of Bayesian statistics and does not undermine objectivity as sometimes misstated.
The guiding principle is that there can be no inference without assumptions, that there does not exist an
“external truth”, but that science is building predictive models in certain axiomatic frameworks. In this regard,
stating a prior in Bayesian probability theory becomes a systematic way to quantify one’s assumptions and
state of knowledge about the problem in question before the data is examined. While it is true that such
probability assignment does not describe something that could be measured in a physical experiment, it is
completely objective in the sense that it is independent of the “personal feelings” of the user. Anyone who has

3.2. Inverse problems and the mechanism of experimental learning
53
the same information, but comes to a diﬀerent conclusion, is necessarily violating one of Cox’s desiderata (see
the discussion in section 3.1.3).
Bayes’ theorem gives an unequivocal procedure to update even diﬀerent degrees of beliefs. As long as the
prior has a support that is non-zero in regions where the likelihood is large (Cromwell’s rule), the repeated
application of the theorem will converge to a unique posterior distribution (Bernstein-von Mises theorem).
Generally, objectivity is assured in Bayesian statistics by the fact that, if the likelihood is more informative
than the prior, the posterior converges to a common function.
Specifying priors exposes assumptions to falsiﬁcation and scientiﬁc criticism. This is a positive feature of
Bayesian probability theory, because frequentists also have to make assumptions that may be more diﬃcult
to ﬁnd within the analysis. An important theorem (Wolpert & Macready, 1997) states that there is “no-free
lunch” for optimization problems: when searching for the local extremum of a target function (the likelihood
in our case) in a ﬁnite space, the average performance of algorithms (that do not resample points) across all
possible problems is identical. An important implication is that no universally good algorithm exists (Ho &
Pepyne, 2002); prior information should always be used to match procedures to problems.
In many situations, domain knowledge is highly relevant and should be included in the analysis. For example,
when trying to estimate a mass m from some data, one should certainly enforce it to be a positive quantity
by setting a prior such that P(m) = 0 for m < 0. Frequentist techniques based on the likelihood can give
estimates and conﬁdence intervals that include negative values. Taken at face value, this result is meaningless,
unless special care is taken (e.g. the so-called “constrained likelihood” methods). The use of Bayes’ theorem
ensures that meaningless results are excluded from the beginning and that one knows how to place bets on
values of the parameter given the actual data set at hand.
As discussed in the introduction, in cosmology, the current state-of-the-art is that previous data (COBE,
WMAP, Planck, SDSS etc.) allowed to establish an extremely solid theoretical footing: the so-called ΛCDM
model. Even when trying to detect deviations from this model in the most recent data, it is absolutely well-
founded to use it as prior knowledge about the physical behaviour of the Universe.
Therefore, using less
informative priors would be refusing to “climb on the shoulder of giants”.
It can happen that the data are not informative enough to override the prior (e.g. for sparsely sampled
data or very high-dimensional parameter space), in which case care must be given in assessing how much of
the ﬁnal (ﬁrst level, see section 3.3.1) inference depends on the prior choice. A good way to perform such a
check is to simulate data using the posterior and see if it agrees with the observed data. This can be thought of
as “calculating doubt” (Starkman, Trotta & Vaudrevange, 2008; March et al., 2011) to quantify the degree of
belief in a model given observational data in the absence of explicit alternative models. Note that even in the
case where the inference strongly depends on prior knowledge, information has been gained on the constraining
power (or lack thereof) of the data.
For model selection questions (second level analysis, see section 3.3.3), the impact of the prior choice is
much stronger, since it is precisely the available prior volume that matters in determining the penalty that
more complex models should incur. Hence, care should be taken in assessing how much the outcome would
change for physically reasonable changes in the prior.
There exists a vast literature about quantitative prescriptions for prior choice that we cannot summarize
here. An important topic concerns the determination of “ignorance priors” or “Jeﬀreys’ priors”: a systematic
way to quantify a maximum level of uncertainty and to reﬂect a state of indiﬀerence with respect to symmetries
of the problem considered. While the ignorance prior is unphysical (nothing is ever completely uncertain) it can
be viewed as a convenient approximation to the problem of carefully constructing an accurate representation of
weak prior information, which can be very challenging – especially in high dimensional parameter spaces.
For example, it can be shown that, if one is wholly uncertain about the position of the pdf, a “ﬂat prior”
should be chosen. In this case, the prior is taken to be constant (within some minimum and maximum value of
the parameters so as to be proper, i.e. normalizable to unity). In this fashion, equal probability is assigned to
equal states of knowledge. However, note that a ﬂat prior on a parameter θ does not necessarily correspond to
a ﬂat prior on a non-linear function of that parameter, ϕ(θ). Since P(ϕ) = P(θ) × |dθ/dϕ|, a non-informative
(ﬂat) prior on θ can be strongly informative about ϕ. Analogously, if one is entirely uncertain about the width of
the pdf, i.e. about the scale of the inferred quantity θ, it can be shown that the appropriate prior is P(θ) ∝1/θ,
which gives the same probability in logarithmic bins, i.e. the same weight to all orders of magnitude.

54
Chapter 3. Bayesian cosmostatistics
3.3
Bayesian data analysis problems
This section draws from section 3 in Leclercq, Pisani & Wandelt (2014).
Bayesian data analysis problems can be typically classiﬁed as: parameter inference, model comparison,
hypothesis testing. For example, cosmological questions of these three types, related to the large-scale structure,
would be respectively
• What is the value of w, the equation of state of dark energy?
• Is structure formation driven by general relativity or by massive gravity?
• Are large-scale structure observations consistent with the hypothesis of a spatially ﬂat universe?
In this section; we describe the methodology for questions of the ﬁrst two types. Hypothesis testing, i.e.
inference within an uncertain model, in the absence of an explicit alternative, can be treated in a similar manner.
3.3.1
First level analysis: Bayesian parameter inference
The general problem of Bayesian parameter inference can be stated as follows. Given a physical model
M,3 a set of hypotheses is speciﬁed in the form of a vector of parameters, θ. Together with the model, priors
for each parameter must be speciﬁed: P(θ|M). The next step is to construct the likelihood function for the
measurement, with a probabilistic, generative model of the data: P(d|θ, M). The likelihood reﬂects how the
data are obtained: for example, a measurement with Gaussian noise will be represented by a normal distribution.
Once the prior is speciﬁed and the data is incorporated in the likelihood function, one immediately obtains
the posterior distribution for the model parameters, integrating all the information known to date, by using
Bayes’ theorem (equation (3.2)):
P(θ|d, M) ∝P(d|θ, M)P(θ|M).
(3.3)
Note that the normalizing constant P(d|M) (the Bayesian evidence) is irrelevant for parameter inference (but
fundamental for model comparison, see section 3.3.3).
Usually, the set of parameters θ can be divided in some physically interesting quantities ϕ and a set of
nuisance parameters ψ. The posterior obtained by equation (3.3) is the joint posterior for θ = (ϕ, ψ). The
marginal posterior for the parameters of interest is written as (marginalizing over the nuisance parameters)
P(ϕ|d, M) ∝
Z
P(d|ϕ, ψ, M)P(ϕ, ψ|M) dψ.
(3.4)
This pdf is the ﬁnal inference on ϕ from the joint posterior. The following step, to apprehend and exploit this
information, is to explore the posterior. It is the subject of the next section.
3.3.2
Exploration of the posterior
The result of parameter inference is contained in the posterior pdf, which is the actual output of the sta-
tistical analysis. Since this pdf cannot always be easily represented, convenient communication of the posterior
information can take diﬀerent forms:
• a direct visualization, which is only possible if the parameter space has suﬃciently small dimension (see
ﬁgure 3.1).
• the computation of statistical summaries of the posterior, e.g. the mean, the median, or the mode of
the distribution of each parameter, marginalizing over all others, its standard deviation; the means and
covariance matrices of some groups of parameters, etc. It is also common to present the inference by
plotting two-dimensional subsets of parameters, with the other components marginalized over (this is
especially useful when the posterior is multi-modal or with heavy tails).
3 In this section, we make explicit the choice of a model M by writing it on the right-hand side of the conditioning symbol of all
pdfs.

3.3. Bayesian data analysis problems
55
- 4
- 2
2
4
0.1
0.2
0.3
0.4
Figure 3.1: Example visualizations of posterior densities in low-dimensional parameter spaces (from left to right: one,
two and three).
−3
−2
−1
 0
 1
 2
 3−3 −2 −1  0  1  2  3
0.00
0.05
0.10
0.15
0.20
Figure 3.2: Example of a sampled representation of a posterior distribution in two dimensions. A set of samples is
constructed in such a way that at any point, the posterior probability is proportional to the local density of samples in
parameter space.
For typical problems in cosmology, the exploration of a posterior density meets practical challenges, depend-
ing on the dimension D of the parameter space. Due to the computational time requirements, direct integration
and mapping of the posterior density is almost never a smart idea, except for D < 4. Besides, computing
statistical summaries by marginalization means integrating out the other parameters. This is rarely possible
analytically (Gaussian random ﬁelds being one notable exception), and even numerical direct integration is
basically hopeless for D > 5.
In this thesis, we will be looking at cases where D is of the order of 107: the density in each voxel of the
map to infer is a parameter of the analysis. This means that direct evaluation of the posterior is impossible and
one has to rely on a numerical approximation: sampling the posterior distribution.
The idea is to approximate the posterior by a set of samples drawn from the real posterior distribution.
In this fashion, one replaces the real posterior distribution, P(θ|d), by the sum of N Dirac delta distributions,
PN(θ|d):
P(θ|d) ≈PN(θ|d) = 1
N
N
X
i=1
δD(θ −θi).
(3.5)
A sampled representation of the posterior is constructed in such a way that at any point, the posterior probability
is proportional to the local density of samples in parameter space (see ﬁgure 3.2).
An intuitive way to think about these samples is to consider each of them as a “possible version of the
truth”. The variation between diﬀerent samples quantiﬁes the uncertainty. At this point, it is worth stressing
again that an advantage of Bayesian approach is that it deals with uncertainty independently of its origin, i.e.
there is no fundamental distinction between “statistical uncertainty” coming from the stochastic nature of the
experiment and “systematic uncertainty”, deriving from deterministic eﬀects that are only partially known.

56
Chapter 3. Bayesian cosmostatistics
The advantage of a sampling approach is that marginalization over some parameters becomes trivial: one
just has to histogram. Speciﬁcally, it is suﬃcient to count the number of samples falling within diﬀerent bins
of some subset of parameters, simply ignoring the values of the others parameters. Integration to get means
and variances is also much simpler, since the problem is limited to the computation of discrete sums. More
generally, the expectation value of any function of the parameters, f(θ) is
⟨f(θ)⟩=
Z
f(θ)P(θ)dθ ≈1
N
N
X
i=1
f(θi).
(3.6)
We make an extensive use of this last property in part IV of this thesis, when exploiting the borg SDSS analysis
for cosmic web classiﬁcation.
How can one get a sampled representation of the posterior? The ideal case would be to have an inﬁnitely
powerful computer. Then, a naïve but straightforward sampling algorithm would be the following: simulate
data from the generative model (draw θ from the prior, then data from the likelihood knowing θ) and check that
the real data agree with the simulated data. If it is the case, keep θ as one sample, otherwise try again. This
is correct in principle, but hugely ineﬃcient, particularly in high dimensions where it can become prohibitively
expensive to evaluate the posterior pdf. Fortunately, a battery of powerful methods exists for approximating
and sampling from probability distributions. Interestingly, sampling algorithms exist that do not evaluate the
posterior pdf (except perhaps occasionally, to maintain high numerical precision).
One class of approaches is Approximate Bayesian Computation (ABC) sometimes also known as “likelihood-
free” methods (see Marin et al., 2011 for an overview, or Cameron & Pettitt, 2012; Weyant, Schafer & Wood-
Vasey, 2013; Lin & Kilbinger, 2015 for applications to astrophysics). The general principle is similar to the naïve
approach described above, but ABC makes it practical by using an approximate forward model, the outcomes
˜d of which are compared with the observed data d. The candidate sample ˜d is accepted with tolerance ε > 0 if
ρ( ˜d, d) ≤ε, where the distance measure ρ determines the allowed level of discrepancy between ˜d and d based
on a given metric.
Another important class of standard techniques to sample the posterior is to use Markov Chain Monte Carlo,
which is the subject of section 3.4.
3.3.3
Second level analysis: Bayesian model comparison
In the case where there are several competing theoretical models, second level inference (or Bayesian model
comparison) provides a systematic way of evaluating their relative probability in light of the data and any prior
information available. It does not replace parameter inference, but rather extends the assessment of hypotheses
to the space of theoretical models.
This allows quantitatively to address everyday questions in cosmology – Is the Universe ﬂat or should one
allow a non-zero curvature parameter? Are the primordial perturbations Gaussian or non-Gaussian? Are there
isocurvature modes? Are the perturbations strictly scale-invariant (ns = 1) or should the spectrum be allowed
to deviate from scale-invariance? Is there evidence for a deviation from general relativity? Is the equation of
state of dark energy equal to −1?
In many of the situations above, Bayesian model comparison oﬀers a way of balancing complexity and
goodness of ﬁt: it is obvious that a model with more free parameters will always ﬁt the data better, but it
should also be “penalized” for being more complex and hence, less predictive. The notion of predictiveness really
is central to Bayesian model comparison in a very speciﬁc way: the evidence is actually the prior predictive pdf,
the pdf over all data sets predicted for the experiment before data are taken. Since predictiveness is a criterion
for good science everyone can agree on, it is only natural to compare models based on how well they predicted
the data set before it was obtained. This criterion arises automatically in the Bayesian framework.
The guiding scientiﬁc principle is known as Occam’s razor: the simplest model compatible with the available
information ought to be preferred. We now understand this principle as a consequence of using predictiveness
as the criterion. A model that is so vague (e.g. has so many parameters) that it can predict a large range of
possible outcomes will predict any data set with smaller probability than a model that is highly speciﬁc and
therefore has to commit to predicting only a small range of possible data sets. It is clear that the speciﬁc
model should be preferred if the data falls within the narrow range of its prediction. Conversely we default to
the broader more general model only if the data are incompatible with the speciﬁc model. Therefore, Bayesian
model comparison oﬀers formal statistical grounds for selecting models based on an evaluation whether the data
truly favor the extra complexity of one model compared to another.

3.3. Bayesian data analysis problems
57
Contrary to frequentists goodness-of-ﬁt tests, second level inference always requires an alternative explana-
tion for comparison (ﬁnding that the data are unlikely within a theory does not mean that the theory itself is
improbable, unless compared with an alternative). The prior speciﬁcation is crucial for model selection issues:
since it is the range of values that parameters can take that controls the sharpness of Occam’s razor, the prior
should exactly reﬂect the available parameter space under the model before obtaining the data.
The evaluation of model M’s performance given the data is quantiﬁed by P(M|d). Using Bayes’ theorem
to invert the order of conditioning, we see that it is proportional to the product of the prior probability for the
model itself, P(M), and of the Bayesian evidence already encountered in ﬁrst level inference, P(d|M):
P(M|d) ∝P(M) P(d|M).
(3.7)
Usually, prior probabilities for the models are taken as all equal to 1/Nm if one considers Nm diﬀerent models
(this choice is said to be non-committal). When comparing two competing models denoted by M1 and M2,
one is interested in the ratio of the posterior probabilities, or posterior odds, given by
P12 ≡P(M1|d)
P(M2|d) = P(M1)
P(M2)
P(d|M1)
P(d|M2).
(3.8)
With non-committal priors on the models, P(M1) = P(M2), the ratio simpliﬁes to the ratio of evidences, called
the Bayes factor,
B12 ≡P(d|M1)
P(d|M2).
(3.9)
The Bayes factor is the relevant quantity to update our state of belief in two competing models in light
of the data, regardless of the relative prior probabilities we assign to them: a value of B12 greater than one
means that the data support model M1 over model M2. Note that, generally, the Bayes factor is very diﬀerent
from the ratio of likelihoods: a more complicated model will always yield higher likelihood values, whereas the
evidence will favor a simpler model if the ﬁt is nearly as good, through the smaller prior volume.
Posterior odds (or directly the Bayes factor in case of non-committal priors) are usually interpreted against
the Jeﬀreys’ scale for the strength of evidence. For two competing models M1 and M2 with non-committal
priors (P(M1) = P(M2) = 1/2) and exhausting the model space (P(M1|d) + P(M2|d) = 1), the relevant
quantity is the logarithm or the Bayes factor, ln B12 for which thresholds at values of 1.0, 2.5 and 5.0 are
set (corresponding to odds of about 3:1, 12:1 and 150:1, representing weak, moderate and strong evidence,
respectively). The use of a logarithm in this empirical scale quantiﬁes the principle that the evidence for a
model only accumulates slowly with new informative data: rising up one level in the evidence strength requires
about one order of magnitude more support.
The computation of the Bayesian evidence is generally technically challenging. For this reason, simplifying
assumptions often have to be introduced (see Heavens, Kitching & Verde, 2007, for the Gaussian likelihood
approximation within a model selection context). Another important particular situation is when M2 is a
simpler model, described by fewer (n′ < n) parameters than M1. M2 is said to be nested in model M1 if the
n′ parameters of M2 are also parameters of M1. M1 has p ≡n −n′ extra parameters that are ﬁxed to ﬁducial
values in M2. For simplicity, let us assume that there is only one extra parameter ζ in model M1, ﬁxed to 0
in M2 (ζ describes the continuous deformation from one model to the other). Let us denote the set of other
parameters by θ. Under these hypotheses, the evidence for M1 is P(d|M1) ≡P(d|Mθ,ζ) and the evidence for
M2 is P(d|M2) ≡P(d|Mθ,ζ=0) = P(d|ζ = 0, Mθ,ζ). We also assume non-committal priors for M1 and M2.
If the prior for the additional parameter ζ is independent of the other parameters (which makes the joint
prior separable: P(ζ, θ|Mθ,ζ) = P(ζ|Mθ,ζ)P(θ|Mθ,ζ=0)), it can be shown that the Bayes factor takes a simple
form, the Savage-Dickey ratio (Dickey, 1971; Verdinelli & Wasserman, 1995)
B12 =
P(d|Mθ,ζ)
P(d|Mθ,ζ=0) = P(ζ = 0|Mθ,ζ)
P(ζ = 0|d, Mθ,ζ),
(3.10)
that is, the ratio of the marginal prior and the marginal posterior of the larger model M1, where the additional
parameter ζ is held at its ﬁducial value. The Bayes factor favors the “larger” model only if the data decreases
the posterior pdf at the ﬁducial value compared to the prior. Operationally, if n −n′ is small, one can easily
compute the Savage-Dickey ratio given samples from the posterior and prior of M1 by simply estimating the
marginal densities at the ﬁducial value.

58
Chapter 3. Bayesian cosmostatistics
3.4
Markov Chain Monte Carlo techniques for parameter inference
This section draws from section 3 in Leclercq, Pisani & Wandelt (2014).
3.4.1
Markov Chains
The purpose of Markov Chain Monte Carlo (MCMC) sampling is to construct a sequence of points in
parameter space (a so-called “chain”), whose density is proportional to the pdf that we want to sample.
A sequence {θ0, θ1, θ2, ..., θn, ...} of random elements of some set (the “state space”) is called a Markov Chain
if the conditional distribution of θn+1 given all the previous elements θ1, ... θn depends only on θn (the Markov
property). It is said to have stationary transition probability if, additionally, this distribution does not depend
on n. This is the main kind of Markov chains of interest for MCMC.
Such stationary chains are completely characterized by the marginal distribution for the ﬁrst element θ0
(the initial distribution) and the conditional distribution of θn+1 given θn, called the transition probability
distribution.
Let us denote by P(θ) the target pdf and by T (θ′|θ) the transition pdf. When designing a MCMC method,
we want to construct a chain with the following properties.
1. The desired distribution P(θ) should be an invariant distribution of the chain, namely the probability of
the next state being θ must satisfy the general balance property,
P(θ) =
Z
T (θ|θ′) P(θ′) dθ′.
(3.11)
Formally, an invariant distribution is a ﬁxed point of the transition probability operator, i.e. an eigenvector
with eigenvalue 1.
2. The chain should be ergodic (or irreducible) which means that it is possible to go from every state to every
state (not necessarily in one move).
Property 1 ensures the existence of an invariant distribution, and property 2 its uniqueness: it is the target
pdf P(θ). Therefore, the crucial property of such Markov chains is that, after some steps depending on the
initial position (the so-called “burn-in” phase), they reach a state where successive elements of the chain are
drawn from the high-density regions of the target distribution, in our case the posterior of a Bayesian parameter
inference: the probability to draw θ as the n-th element of the chain, P (n)(θ), satisﬁes
P (n)(θ) →P(θ) as n →∞, for any θ0.
(3.12)
Exploiting this property, MCMC algorithms use Markovian processes to move from one state to another in
parameter space; then, given a set of random samples, they reconstruct the probability heuristically. Several
MCMC algorithms exist and the relevant choice is highly dependent on the problem addressed and on the
posterior distribution to be explored (see the discussion of the “no-free lunch” theorem in section 3.2.2), but
the basic principle is always similar to that of the popular CosmoMC code (Lewis & Bridle, 2002): perform a
random walk in parameter space, constrained by the posterior probability distribution.
Many useful transition probabilities satisfy the detailed balance property,
T (θ|θ′) P(θ′) = T (θ′|θ) P(θ).
(3.13)
While general balance expresses the “balance of ﬂow” into and out of any state θ, detailed balance expresses the
“balance of ﬂow” between every pair of states: the ﬂow from θ to θ′ is the ﬂow from θ′ to θ. Markov chains that
satisfy detailed balance are also called reversible Markov chains. The reason why the detailed balance property
is of interest is that it is a suﬃcient (but not necessary) condition for the invariance of the distribution P under
the transition pdf T (equation (3.11)), which can be easily checked:
Z
T (θ|θ′) P(θ′) dθ′ =
Z
T (θ′|θ) P(θ) dθ′ = P(θ)
Z
T (θ′|θ) dθ′ = P(θ).
(3.14)

3.4. Markov Chain Monte Carlo techniques for parameter inference
59
Figure 3.3: Left panel. An example of Markov chain constructed by the Metropolis-Hastings algorithm: starting at θ1,
θ2 is proposed and accepted (step A), θ3 is proposed and refused (step B), θ4 is proposed and accepted (step C). The
resulting chain is {θ1, θ2, θ2, θ4, ...}. Central panel. An example of what happens with too broad a jump size: the chain
lacks mobility because all the proposals are unlikely. Right panel. An example of what happens with too narrow a jump
size: the chain samples the parameter space very slowly.
3.4.2
The Metropolis-Hastings algorithm
A popular version of MCMC is called the Metropolis-Hastings (MH) algorithm, which works as follows.
Initially, one chooses an arbitrary point θ0 to be the ﬁrst sample, and speciﬁes a distribution Q (θ′|θ) which
proposes a candidate θ′ for the next sample value, given the previous sample value θ (Q is called the proposal
density or jumping distribution). At each step, one draws a realization θ′ from Q (θ′|θ) and calculates the
Hastings ratio:
r(θ, θ′) ≡P(θ′)
P(θ)
Q (θ|θ′)
Q (θ′|θ).
(3.15)
The proposed move to θ′ is accepted with probability a(θ, θ′) ≡min [1; r(θ, θ′)] = T (θ′|θ). In case it is accepted,
θ′ becomes the new state of the chain, otherwise the chain stays at θ. A graphical illustration of the MH
algorithm is shown in ﬁgure 3.3. Note that each step only depends on the previous one and is also independent
of the number of previous steps, therefore the ensemble of samples of the target distribution, constructed by
the algorithm, is a stationary Markov chain.
The probability that the next state is θ′ is the sum of the probability that the current state is θ′ and the
update leads to rejection – which happens that a probability that we note R (θ′) – and of the probability that
the current state is some θ and a move from θ to θ′ is proposed and accepted. This is formally written
P(θ′) =
Z
P(θ)T (θ′|θ) dθ = P(θ′) R (θ′) +
Z
P(θ) Q (θ′|θ) dθ.
(3.16)
The probability to depart from θ′ to any θ is
R Q (θ|θ′) dθ = 1 −R (θ′).
The special case of a symmetric proposal distribution, i.e. Q (θ|θ′) = Q (θ′|θ) for all θ and θ′ is called the
Metropolis update. Then the Hastings ratio simpliﬁes to
r(θ, θ′) = P(θ′)
P(θ)
(3.17)
and is called the Metropolis ratio. Given this result, the detailed balance condition, equation (3.13) reads
P(θ′) min

1 ; P(θ)
P(θ′)

= P(θ) min

1 ; P(θ′)
P(θ)

,
(3.18)
which is easily seen to be true.
In many cases, the MH algorithm will be ineﬃcient if the proposal distribution is sub-optimal. It is often hard
to ﬁnd good proposal distributions if the parameter space has high dimension (e.g. larger than 10). Typically,
the chain moves very slowly, either due to a tiny step size, either because only a tiny fraction of proposals are

60
Chapter 3. Bayesian cosmostatistics
suitable step size
step size too large
step size too small
200
400
600
800
1000
20
40
60
80
100
200
400
600
800
1000
20
40
60
80
100
200
400
600
800
1000
20
40
60
80
100
Figure 3.4: Example of Markov chains constructed by the Metropolis-Hastings algorithm, sampling the same target
distribution but with varying proposal distribution (step size). The plots show the value of the sampled parameter as
a function of the position in the chain. The ideal behavior with a suitable step size is shown in the left panel. On the
central panel, the step size is too large: the maximum likelihood region is not well sampled. On the right panel, the step
size is too small: the burn-in phase is very long and the sampling is slow. Note that this phenomena are easily diagnosed
using the auto-correlation function of the chain, equation (3.19).
accepted. The initial burn-in phase can be very long, i.e. the chain takes some time to reach high likelihood
regions, where the initial position chosen has no inﬂuence on the statistics of the chain. Even in the stationary
state, suﬃcient sampling of the likelihood surface can take a very large number of steps. In the central and left
panels of ﬁgure 3.3, we illustrate what happens with too broad a jump size (the chain lacks mobility and all
proposals are unlikely) or too narrow (the chain moves slowly to sample all the parameter space). Note that
the step-size issues can be diagnosed using the lagged auto-correlation function of the chain,
ξ(∆) =
Z
θ(t)θ(t + ∆) dt.
(3.19)
A convergence criterion using diﬀerent chains or sections of chains is proposed in Gelman & Rubin (1992).
Possible solutions to the issues mentioned involve an adaptive step size or reﬁnements of the standard Metropolis-
Hastings procedure.
In some particular cases, the proposal density itself satisﬁes the detailed balance property,
Q (θ|θ′) P(θ′) = Q (θ′|θ) P(θ),
(3.20)
which implies that the Hastings ratio is always unity, i.e. that proposed states are always accepted (Q is T
and R is zero). For example, Gibbs sampling is a particular case of a generalized MH algorithm, alternating
between diﬀerent proposals (see e.g. Wandelt, Larson & Lakshminarayanan, 2004 for a cosmological example).
It is particularly helpful when the joint probability distribution is diﬃcult to sample directly, but the conditional
distribution of some parameters given the others is known. It uses a block scheme of individual Gibbs updates
to sample an instance from the distribution of each variable in turn, conditional on the current values of the
other variables. Formally, the proposal for a single Gibbs update is from a conditional distribution of the target
pdf: Q (θ′|θ) ≡P(θ′|f(θ)) where f(θ) is θ with some components omitted. θ′ is an update of these missing
components, keeping the others at the values they had in θ. Therefore, f(θ′) = f(θ), and we have
Q (θ′|θ) ≡P(θ′|f(θ)) = P(θ′|f(θ′)) = P(θ′),
(3.21)
which trivially implies the detailed balance property (equation (3.20)) and ensures an acceptance rate of unity.
3.4.3
Hamiltonian Monte Carlo
A very eﬃcient MCMC algorithm for high-dimensional problems such as those encountered in cosmology is
Hamiltonian Monte Carlo (HMC, originally introduced under the name of hybrid Monte Carlo, Duane et al.,
1987). A detailed overview is provided by Neal (2011).
The general idea of HMC is to use concepts borrowed from classical mechanics to solve statistical problems.
As it is a core ingredient in the borg code, we now discuss the most important features of HMC. We start by
reviewing physical properties of Hamiltonian dynamics. The system is described by the Hamiltonian H(θ, p),

3.4. Markov Chain Monte Carlo techniques for parameter inference
61
a function of the D-dimensional position vector θ and of the D-dimensional momentum vector p.4 Its time
evolution is described by Hamilton’s equations,
dθ
dt
=
∂H
∂p ,
(3.22)
dp
dt
=
−∂H
∂θ .
(3.23)
For any time interval of duration s, these equations deﬁne a mapping Ts from the state at any time t to the
state at time t + s. The ﬁrst important property of Hamiltonian dynamics is time reversibility, which means
for any s, that the mapping Ts has an inverse. It is easy to check that this inverse is T−s.
A second property of the dynamics is that it conserves the Hamiltonian during the evolution, which can be
checked explicitly:
dH
dt = ∂H
∂θ
dθ
dt + ∂H
∂p
dp
dt = ∂H
∂θ
∂H
∂p −∂H
∂p
∂H
∂θ = 0.
(3.24)
In 2D dimensions, using z = (θ, p) and the matrix
J =
 0D
ID
−ID
0

,
(3.25)
one can rewrite Hamilton’s equations as
dz
dt = J · ∇H.
(3.26)
The third important property is that Hamiltonian dynamics is symplectic, which means that the Jacobian matrix
Bs of the mapping Ts satisﬁes
B⊺
s J−1 Bs = J−1.
(3.27)
This property implies volume conservation in (θ, p) phase space (a result also known as Liouville’s theorem),
since det(Bs)2 must be one.
Crucially, reversibility and symplecticity are properties that can be maintained exactly, even when Hamil-
tonian dynamics is approximated by numerical integrators (see section 4.3.4).
The link between probabilities and Hamiltonian dynamics is established via the concept of canonical dis-
tribution from statistical mechanics. Given the energy distribution E(x) for possibles states x of the physical
system, the canonical distribution over states x has pdf
P(x) = 1
Z exp
−E(x)
kBT

(3.28)
where kB is the Boltzmann constant, T the temperature of the system, and the partition function Z is the
normalization constant needed to ensure
R P(x) dx = 1. In Hamiltonian dynamics, H is an energy function for
the joint state of positions θ and momenta p, and hence deﬁnes a joint pdf as
P(θ, p) = 1
Z exp
−H(θ, p)
kBT

(3.29)
Viewing this the opposite way, if we are interested in some joint distribution with probability P(θ, p), we can
obtain it as a canonical distribution with temperature kBT = 1, by setting H(θ, p) = −ln P(θ, p)−ln Z, where
Z is any convenient positive constant (we choose Z = 1 in the following for simplicity).
We are now ready to discuss the Hamiltonian Monte Carlo algorithm. HMC interprets the negative logarithm
of the pdf to sample as a physical potential, ψ(θ) = −ln P(θ) and introduces auxiliary variables: “conjugate
momenta” pi for all the diﬀerent parameters.
Using these new variables as nuisance parameters, one can
formulate a Hamiltonian describing the dynamics in the multi-dimensional phase space. Such a Hamiltonian is
given as:
H(θ, p) = 1
2p⊺M−1 p + ψ(θ) = −ln P(θ, p),
(3.30)
where the kinetic term, K(p) ≡1
2p⊺M−1 p involves M, a symmetric positive deﬁnite “mass matrix” whose
choice can strongly impact the performance of the sampler. Masses characterize the inertia of parameters when
4 In this section we use boldface notations for all vectors, to strengthen the link between physics and statistics.

62
Chapter 3. Bayesian cosmostatistics
moving through the parameter space. Consequently, too large masses will result in slow exploration eﬃciency,
while too light masses will result in large rejection rates (see also ﬁgure 3.4).
Each iteration of the HMC algorithm works as follows. One draws a realization of the momenta from the
distribution deﬁned by the kinetic energy term, i.e. a multi-dimensional Gaussian with a covariance matrix M,
then moves the positions θ using a Hamiltonian integrator in parameter space, respecting symplectic symmetry.
In other words, we ﬁrst “kick the system” then follow its deterministic dynamical evolution in phase space
according to Hamilton’s equations, which read
dθ
dt
=
M−1 p,
(3.31)
dp
dt
=
−∂ψ(θ)
∂θ
.
(3.32)
If the integrator is reversible, then the proposal is symmetric, and the acceptance probability for the new
point (θ′, p′) follows the Metropolis rule (see equation (3.17)):
a(θ′, p′, θ, p) = min

1 ; P(θ′, p′)
P(θ, p)

= min

1 ; exp(−H(θ′, p′) + H(θ, p))

.
(3.33)
Using the results of sections 3.4.1 and 3.4.2, this proves that detailed balance is veriﬁed and that HMC leaves
the canonical distribution invariant.
In exact Hamiltonian dynamics, the energy is conserved, and therefore, ideally, this procedure always provides
an acceptance rate of unity. In practice, numerical errors can lead to a somewhat lower acceptance rate but
HMC remains computationally much cheaper than standard MH techniques in which proposals are often refused.
In the end, we discard the momenta and yield the target parameters by marginalization:
P(θ) =
Z
P(θ, p) dp.
(3.34)
Applications of HMC in cosmology include: the determination of cosmological parameters (Hajian, 2007;
in combination with Pico, Fendt & Wandelt, 2007), CMB power spectrum inference (Taylor, Ashdown &
Hobson, 2008) and Bayesian approach to non-Gaussianity analysis (Elsner & Wandelt, 2010), log-normal density
reconstruction (Jasche & Kitaura, 2010; including from photometric redshift surveys, Jasche & Wandelt, 2012),
dynamical, non-linear reconstruction of the initial conditions from galaxy surveys (Jasche & Wandelt, 2013a),
joint power spectrum and bias model inference (Jasche & Wandelt, 2013b), inference of CMB lensing (Anderes,
Wandelt & Lavaux, 2015).

Chapter 4
Physical large-scale structure inference
with the BORG algorithm
Contents
4.1
The challenge: the curse of dimensionality . . . . . . . . . . . . . . . . . . . . . . . . .
64
4.1.1
Sparse sampling
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
64
4.1.2
Shape of high-dimensional pdfs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
65
4.1.3
Algorithms in high dimensions
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
65
4.2
The BORG data model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
66
4.2.1
The physical density prior . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
67
4.2.2
The large-scale structure likelihood . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
68
4.2.3
The posterior distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
71
4.2.4
The Γ-distribution for noise sampling
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
71
4.3
Sampling procedure and numerical implementation . . . . . . . . . . . . . . . . . . . .
72
4.3.1
Calibration of the noise level
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
72
4.3.2
Hamiltonian Monte Carlo and equations of motion for the LSS density . . . . . . . . . . . .
72
4.3.3
The mass matrix . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
73
4.3.4
The leapfrog scheme integrator . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
73
4.4
Testing BORG . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
74
4.4.1
Generating mock observations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
74
4.4.2
Convergence and correlations of the Markov Chain . . . . . . . . . . . . . . . . . . . . . . .
74
4.4.3
Large-scale structure inference
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
75
4.5
Future extensions of BORG . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
75
“We are the Borg. Lower your shields and surrender your ships.
We will add your biological and technological distinctiveness to our
own. Your culture will adapt to service us. Resistance is futile.”
— Star Trek: First Contact (1996)
Abstract
This chapter describes the development and implementation of the borg algorithm, which aims at physical large-scale
structure inference in the linear and mildly non-linear regime. It describes the data model, which jointly accounts for
the shape of three-dimensional matter ﬁeld and its formation history. Based on an eﬃcient implementation of the
Hamiltonian Monte Carlo algorithm, borg samples the joint posterior of the several millions parameters involved,
which allows for thorough uncertainty quantiﬁcation.
This chapter presents borg (Bayesian Origin Reconstruction from Galaxies), a data assimilation method for
probabilistic, physical large-scale structure inference. In section 4.1, the main challenge faced, namely the curse
of dimensionality, is discussed. In section 4.2, we describe the latest formulation of borg data model, initially
introduced by Jasche & Wandelt (2013a) and updated by Jasche, Leclercq & Wandelt (2015). Section 4.3 gives
considerations about the sampling procedure and the numerical implementation of the algorithm. Finally, in
section 4.4, we report on a test of the borg algorithm using a synthetic catalog of tracers.

64
Chapter 4. Physical large-scale structure inference with the BORG algorithm
0.0
0.5
1.0
0.0
0.5
1.0
0.0
0.5
1.0
0.
0.5
0.0
0.5
1.0
0.0
0.5
1.0
Figure 4.1: Illustration of the curse of dimensionality in one, two and three dimensions. We draw an original sample of
100 random points uniformly distributed in [0; 1], then progressively add a second and third coordinate, also uniformly
drawn in [0; 1]. The sparsity of the data (here illustrated by the number of samples in the 
0; 1
2

hypercube, in cyan)
increases exponentially with the number of dimensions.
Dimension D
PD = 2−D
Numerical representation
1
2−1
0.5
10
2−10
9.77 × 10−4
100
2−100
7.89 × 10−31
1000
2−1000
9.33 × 10−302
10000
2−10000
0.
Table 4.1: Probability for a sample uniformly drawn in [0; 1]D to be in 
0; 1
2
D, as a function of the dimension D. The
mathematical result, 2−D (second column) is compared to its double-precision computer representation (third column).
For D ≥1075, PD is below the minimum positive subnormal double representable.
4.1
The challenge: the curse of dimensionality
Statistical analyses of large-scale structure surveys require to go from the few parameters describing the ho-
mogeneous Universe to a point-by-point characterization of the inhomogeneous Universe. The latter description
typically involves tens of millions of parameters: the density in each voxel of the discretized survey volume.
“Curse of dimensionality” phenomena (Bellman, 1961) are the signiﬁcant obstacle in this high-dimensional
data analysis problem. They refer to the diﬃculties caused by the exponential increase in volume associated
with adding extra dimensions to a mathematical space. In the following, we discuss the basic aspects of the
high-dimensional situation. In particular, we outline three aspects of the curse of dimensionality phenomena.
4.1.1
Sparse sampling
The ﬁrst and most obvious aspect is the exponential increase of sparsity given a ﬁxed amount of sampling
points. Reciprocally, the number of points drawn from a uniform distribution, needed for sampling at a constant
density a region in parameter space, increases exponentially with its dimension.
We illustrate this phenomenon in ﬁgure 4.1 with 100 points randomly drawn in [0; 1]D for D = 1, 2, 3.
The number of samples that fall in some ﬁxed region in parameter space exponentially decreases with the
dimensionality of the problem.
For example, the probability PD for a random point to be in the

0; 1
2
D
hyperquadrant (shown in cyan in ﬁgure 4.1) is 2−D. Diﬃculties to represent such probabilities numerically
(table 4.1) arise well before D = 107, as we now discuss.
In standard double-precision binary ﬂoating-point format (the IEEE 754 “binary64” norm), numbers are
represented in base b = 2. The bits are laid out as follows (ﬁgure 4.2): 1 sign bit, 11 bits for the exponent width,
and p = 52 bits for the signiﬁcand precision. The real value assigned by the machine to a set of binary64 digits

4.1. The challenge: the curse of dimensionality
65
exponent
(11 bit)
sign
fraction
(52 bit)
63
52
0
Figure 4.2: Computer representation of double-precision binary ﬂoating-point numbers. One bit is used to store the sign,
11 to store the exponent, and 52 bits to store the fractional part. This representation on a ﬁnite number of bits implies
the existence of both a minimal and a maximal positive representable number.
is
(−1)sign
 
1 +
52
X
i=1
b52−i2−i
!
× 2e−1023,
(4.1)
where 1 ≤e ≤2046 is the “biased exponent” encoded in the 11 exponent bits and bi are the values of the
signiﬁcand bits.
This representation implies that the maximum relative rounding error when rounding a number to the
nearest representable one (the “machine epsilon”) is b−(p−1) = 2−52. Therefore, the maximum positive double is
max_double ≡(1+(1−2−52))×21023 ≈1.798×10308 and the minimum positive double is min_normal_double ≡
2−1022 ≈2.225 × 10−308.
In a normal ﬂoating-point value, there are no leading zeros in the signiﬁcand; instead leading zeros are moved
to the exponent. By using leading zeros in the signiﬁcand, it is possible to represent “subnormal numbers”,
i.e. numbers where this representation would result in an exponent that is too small for the allowed number
of bits. The smallest subnormal number representable with the binary64 norm is min_subnormal_double ≡
2−52 × 2−1022 ≈4.941 × 10−324.
Coming back to the representation of PD is a large number of dimensions, the discussion above implies
that PD is exactly zero, at computer precision, for D ≥1075. More generally, typical probabilities are often
below min_subnormal_double for D ≳1000, which means that their computer representations as doubles is
impossible. Representing such numbers requires more than 64 bits. This number of dimensions is well below
that of the problem that we want to tackle, D ≈107.
4.1.2
Shape of high-dimensional pdfs
Generally, high-dimensional functions can have more complex features than low-dimensional functions (there
is more “space” for that), and hence can be harder to characterize.
Since it is not possible to store arbitrarily small positive numbers, numerical representations of high-
dimensional pdfs will tend to have narrow support and very peaked features. This can also cause diﬃculties,
as pdfs have to be normalized to unity: if the support is suﬃciently small, the value of the pdf at its peaks can
easily be above the maximum double max_double, which will cause computer crashes.
4.1.3
Algorithms in high dimensions
It is important to note that curse of dimensionality phenomena are generally not an intrinsic problem
of high-dimensional problems, but a joint problem of the data set and the algorithm used. In particular, a
dramatic increase of computational time (both to get one sample and to reach the required number of samples)
is common. The curse of dimensionality often means that the number of samples available is small compared
to the dimension of the space, which can lead to issues such as overﬁtting the data or getting poor classiﬁcation
or clustering when searching for speciﬁc patterns (Verleysen & François, 2005).
For most MCMC algorithms, the slow convergence, due a high rejection rate, is the most signiﬁcant ob-
stacle. In particular, for many interesting problems (typically non-linear and where components are not inde-
pendently distributed), traditional sampling techniques that perform a random walk in parameter space, like
the Metropolis-Hastings algorithm (see section 3.4.2) will unequivocally fail in D ≈107.1 However, gradients
1 At least, unless the proposal distribution approximates extremely well the target distribution – which would imply to have
already solved the problem!

66
Chapter 4. Physical large-scale structure inference with the BORG algorithm
Code
Density
ﬁeld
model
Response
operator
Multi-
survey
P(k)
Photo-z
Galaxy
bias
model
b
˜
N
RSD
ares
Gaussian
(J+10b)
(J+10b)
(JW13b)
(J+10b)
linear
(J+10b);
M-dep.,
linear
(JW13b)
sampled
(JW13b)
(JW13b)
(J+in
prep.)
hades
Log-
normal
(JK10)
(JK10)
(J+in
prep.)
(J+in
prep.)
(JW12)
linear
(JK10)
(J+in
prep.)
borg
2LPT
(JW13a)
(JW13a)
(JLW15)
linear
(JW13a);
M-dep.,
power-
law
(JLW15)
calibrated
with ares
(LJ16);
sampled
(J+in
prep.)
(JLW15)
Table 4.2: Current status of Bayesian large-scale structure analysis codes ares, hades and borg. Green cells correspond
to features implemented in the data model and tested, as reported in the corresponding papers. Blue cells correspond to
features which will be described in upcoming publications. The column correspond respectively to: the model used to
describe the prior density ﬁeld; treatment of the survey response operator (survey mask and selection eﬀects); treatment
of multiple, independent surveys (or sub-samples of the same survey); power spectrum sampling; photometric redshifts
sampling; galaxy bias model (M-dep. stands for luminosity-dependent bias); treatment of bias parameters; sampling of
noise levels; treatment of peculiar velocities and redshift-space distortions. The references are J+10b = Jasche et al.
(2010a); JK10 = Jasche & Kitaura (2010); JW12 = Jasche & Wandelt (2012); JW13a = Jasche & Wandelt (2013a);
JW13b = Jasche & Wandelt (2013b); JLW15 = Jasche, Leclercq & Wandelt (2015); LJ16 = Lavaux & Jasche (2016).
of pdfs carry capital information, as they indicate the direction to high-density regions, permitting fast travel
through a large volume in parameter space.
One way forward is to reduce the dimensionality of the problem, which is actually an entire research ﬁeld.
For example, principal component analysis converts a set of correlated variables to a set of linearly uncorrelated
“principal components”. Unfortunately, due to the highly non-linear and complex physics involved in structure
formation (see chapter 1), no obvious reduction of the problem size exists in our case. Under the assumption
of an initial grf with independent density amplitudes in Fourier space, we cannot make any further dimension
reduction, and we have to deal with all D ≈107 dimensions. Dimensionality can only be reduced by coarsening
the resolution and discarding information.
As we will demonstrate in the rest of this chapter, Hamiltonian Monte Carlo (see section 3.4.3) beats the
curse of dimensionality for the problem of physical large-scale structure inference. In particular, the approximate
conservation of the Hamiltonian enables us to keep a high acceptance rate, and the use of gradients of the
posterior pdf (∂ψ(θ)/∂θ in Hamilton’s equations) allows eﬃcient search for high density of probability regions.
4.2
The BORG data model
In this section, we discuss the borg data model, i.e. the set of assumptions concerning the generation of
observed large-scale structure data. In other words, we write down a probabilistic data-generating process.
This model was initially introduced by Jasche & Wandelt (2013a). In Jasche, Leclercq & Wandelt (2015), we
updated the data model and modiﬁed to the original formulation of the borg sampling scheme to introduce the
improvements presented in Jasche & Wandelt (2013b). These improvements permit to account for luminosity-
dependent galaxy bias and to perform automatic noise level calibration.
borg is the successor of ares (Algorithm for REconstruction and Sampling, Jasche et al., 2010a; Jasche &
Wandelt, 2013b) and hades (HAmiltonian Density Estimation and Sampling Jasche & Kitaura, 2010; Jasche
& Wandelt, 2012). In table 4.2, we summarize the diﬀerent aspects covered by the ares, hades, and borg
data models. Contrary to ares and hades, which use phenomenological models to describe the density ﬁeld,
borg involves a physical structure formation model (see table 4.2). LSS observations are merged with actual
dynamics. Therefore, even if it is the least advanced algorithm in terms of the aspects covered by the data

4.2. The BORG data model
67
model, its physical modeling is the most sophisticated.
In the following, x labels one of the D voxels of the discretized domain, δi and δf are realizations of the
initial (at a = 10−3) and ﬁnal (at a = 1) density contrast, respectively, expressed as D-dimensional vectors. For
improved clarity, we use colors in equations to distinguish the diﬀerent quantities that are involved in the data
model.
4.2.1
The physical density prior
In contrast to earlier algorithms (see table 4.2) borg includes a physical density prior i.e. involves a model for
structure formation. This makes the prior (expressed in terms of the ﬁnal density contrast) highly non-Gaussian
and non-linear. Writing down this prior is the subject of the present section.
4.2.1.1
The initial Gaussian prior
As discussed in the introduction and in chapter 1, it is commonly admitted that the density contrast early
in the matter era obeys Gaussian statistics. Consistently with the discussion of section 3.2.2, this is the prior
that we adopt.
Explicitly, in Fourier space, the prior for the initial density contrast is a multivariate Gaussian process with
zero mean and diagonal covariance matrix ˆS (see equation (1.14)):
P(ˆδi| ˆS) =
1
r2π ˆS

exp

−1
2
X
k,k′
ˆδi
k ˆS−1
kk′ˆδi
k′

.
(4.2)
where we explicitly noted by a hat the Fourier-space quantities.
The elements in matrix ˆS are ﬁxed parameters in borg.
They characterize the variance of the initial
density ﬁeld and therefore contain a cosmological dependence. We further assume that the covariance matrix
ˆS is diagonal in Fourier space (this is assuming statistical homogeneity of the initial density contrast, as seen
in section 1.2.4.1).
The diagonal coeﬃcients are
p
P(k)/(2π)3/2, where P(k) are the initial power spectra
coeﬃcients for the adopted ﬁducial cosmological parameters. They are chosen to follow the prescription of
Eisenstein & Hu (1998, 1999), including baryonic wiggles.
Alternatively, using the conﬁguration space representation yields
P(δi|S) =
1
p
|2πS|
exp

−1
2
X
x,x′
δi
xS−1
xx′δi
x′

.
(4.3)
4.2.1.2
Translating to the ﬁnal density ﬁeld
Following Jasche & Wandelt (2013a), we now show that the problem of physical inference of ﬁnal density ﬁelds
can be recast into the problem of inferring the corresponding initial conditions, given the structure formation
model.
As seen before, it is straightforward to express a prior in the initial conditions, P(δi). Given this, we can
obtain a prior distribution for the ﬁnal density contrast at scale factor a by using the standard formula for
conditional probabilities:
P(δf)
=
Z
P(δf, δi) dδi
(4.4)
=
Z
P(δf|δi) P(δi) dδi.
(4.5)
For a deterministic model of structure formation δi 7→G
 δi, a

, the conditional probability is given by Dirac
delta distributions:
P(δf|δi) =
Y
x
δD
 δf
x −

G(δi, a)

x

.
(4.6)
Therefore, given a model G for structure formation, a prior distribution for the late-time density ﬁeld can be
obtained by a two-step sampling process:

68
Chapter 4. Physical large-scale structure inference with the BORG algorithm
1. drawing an initial condition realization from the prior P(δi);
2. propagating the initial state forward in time with G (this step is entirely deterministic).
This process amounts to drawing samples from the joint prior distribution of initial and ﬁnal conditions:
P(δf, δi) = P(δi)
Y
x
δD
 δf
x −

G(δi, a)

x

.
(4.7)
Marginalization over initial density realizations then yields samples of the non-Gaussian prior for ﬁnal density
ﬁelds. In practice, as initial conditions are also interesting for a variety of cosmological applications, we do not
discard them and we always store them, whenever we draw a sample from the prior.
4.2.1.3
The structure formation model
Ideally, the structure formation model should be fully non-linear gravity. For reasons of computational
feasibility, in borg, G is obtained from second-order Lagrangian perturbation theory and the cloud-in-cell
scheme.
More speciﬁcally, the initial density ﬁeld is populated by dark matter particles that are evolved
according to the equations for 2LPT displacements given in section 1.5.3. In the ﬁnal state, these particles
are assigned to the grid using a CiC scheme, yielding the ﬁnal density contrast δf. The reader is referred to
appendix B for details on the numerical implementation of 2LPT and CiC.
Using equations (4.3) and (4.7), the joint physical prior for initial and late-time density ﬁelds is found to be
P(δf, δi|S) =
1
p
|2πS|
exp

−1
2
X
x,x′
δi
xS−1
xx′δi
x′

Y
x
δD
 δf
x −

G(δi, a)

x

.
(4.8)
Note that the ﬁrst part (corresponding to the initial conditions) is more easily handled in Fourier space,
while the second part (corresponding to the propagation from initial to ﬁnal conditions) involves density ﬁelds
in conﬁguration space.
4.2.2
The large-scale structure likelihood
This section discusses the borg likelihood, P(d|δi). The data d used by borg are galaxy (or matter tracer)
number counts in each voxel of the discretized domain. To compute it, the position of galaxies is translated
from spherical to Cartesian coordinates using the following coordinate transform:
x
=
dcom(z) cos(λ) cos(η),
(4.9)
y
=
dcom(z) cos(λ) sin(η),
(4.10)
z
=
dcom(z) sin(λ),
(4.11)
with λ being the declination, η the right ascension and dcom(z) the radial comoving distance to redshift z for
the ﬁducial cosmology. Galaxies are then binned using the Nearest Grid Point (NGP) assignment scheme to
get voxel-wise galaxy number counts.
4.2.2.1
Splitting the galaxy distribution
In order to account for the luminosity-dependence of selection eﬀects and galaxy biases, we split the data
into several bins of absolute magnitude. In the following, ℓlabels one of these bins, and N ℓis the data set
containing the number counts of galaxies in the luminosity bin ℓand in voxel x, N ℓ
x.
borg treats diﬀerent magnitude bins as independent data sets.
Each of them is assigned a likelihood
function, P(N ℓ|δi). Since it is fair to assume that galaxies in diﬀerent luminosity bins are independent and
identically distributed, once the density ﬁeld is given, the ﬁnal likelihood of the total data set d = {N ℓ} is
obtained by multiplying these likelihood functions,
P(d|δi) =
Y
ℓ
P(N ℓ|δi).
(4.12)

4.2. The BORG data model
69
4.2.2.2
The galaxy distribution as an inhomogeneous Poisson process
Galaxies are tracers of the mass distribution. The statistical uncertainty due to the discrete nature of their
distribution is often modeled as a Poisson process (Layzer, 1956; Peebles, 1980; Martínez & Saar, 2002). Before
borg, Poissonian likelihoods have been successfully applied to perform reconstructions of the matter density
by Kitaura, Jasche & Metcalf (2010); Jasche & Kitaura (2010); Jasche et al. (2010a). Adopting this picture,
we write
P(N ℓ|λ(δi)) =
Y
x
exp
 −λℓ
x(δi)
  λℓ
x(δi)
Nℓ
x
N ℓx!
.
(4.13)
The Poisson intensity ﬁeld, λℓ(δi), characterizes the expected number of galaxies in voxel x given the initial
density contrast δi. As it depends on the position, it is an inhomogeneous Poisson process.
Real galaxy samples can have a sub- or super-Poissonian behavior (i.e. be under- or over-dispersed), de-
pending on local and non-local properties (Mo & White, 1996; Somerville et al., 2001; Casas-Miranda et al.,
2002). These eﬀects are neglected here, but in the context of large-scale structure reconstructions, deviations
from Poissonity have been introduced in the likelihood by Kitaura (2012); Ata, Kitaura & Müller (2015).
4.2.2.3
The Poisson intensity ﬁeld
The expected number of galaxies in a voxel depends – of course – on the underlying large-scale structure, but
also on galaxy bias, redshift-space distortions, dynamical processes along the observer’s backwards lightcone,
selection eﬀects, and instrumental noise. All these eﬀects should in principle be taken into account in the Poisson
intensity ﬁeld. In the following, we detail, step by step, how to go from δi to λ(δi) in the borg likelihood.
1. Structure formation. The ﬁrst step is to translate initial to evolved dark matter overdensity:
δi 7→G(δi, a).
(4.14)
As discussed before, for this step borg relies on 2LPT instead of fully non-linear gravitational dynamics,
meaning that there exists some degree of approximation in the inference process. Accurate quantiﬁcation
this level of approximation is unfortunately not currently possible, as it would require the fully non-linear
inference process for reference, which so far is not computationally tractable.
2. Lightcone eﬀects. Along with step 1, we could account for lightcone eﬀects so that the distant structures
are less evolved than the closest ones. This is exploiting the dependence of G on a to build the dark matter
density on the lightcone. For simplicity, this is not currently implemented in borg; rather, we run 2LPT
up to a = 1 everywhere. In the following we simplify the notations and we write δf ≡G(δi) ≡G(δi, a = 1).
3. Redshift-space distortions. At this point, the data model could also include a treatment of redshift-space
distortions (see Heavens & Taylor, 1995; Tadros et al., 1999; Percival, Verde & Peacock, 2004; Percival,
2005a; Percival & White, 2009). Though not explicitly included in the present borg data model, we
ﬁnd empirically that redshift-space distortions are mitigated by the prior preference for homogeneity
and isotropy (see chapter 5): borg interprets deviations from isotropy as noise, and ﬁts an isotropic
distribution to the data.
4. Galaxy bias. The following step is to get the galaxy density ρg given the dark matter density ρ. This is
making assumptions for physical biasing in galaxy formation. Various LSS inference algorithms assume a
linear bias model. In order to be well deﬁned, a Poisson likelihood requires intensities of the inhomogeneous
Poisson process to be strictly positive. Since a linear bias model does not guarantee a positive density ﬁeld
and corresponding Poisson intensity, it is not applicable to the present case. For this reason, we assume
a phenomenological power-law to account for galaxy biasing:
ρg ∝βρα.
(4.15)
In luminosity bin ℓand in terms of the dark matter overdensity, this is step written
δf 7→βℓ(1 + δf)αℓ∝ρℓ
g.
(4.16)

70
Chapter 4. Physical large-scale structure inference with the BORG algorithm
0
50
100
150
200
250
300
z [Mpc/h]
300
250
200
150
100
50
0
−x [Mpc/h]
0.0
0.4
0.8
1.2
1.6
2.0
2.4
2.8
3.2
3.6
ln(2 + δf
x)
0
50
100
150
200
250
300
z [Mpc/h]
300
250
200
150
100
50
0
0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.0
R2
x
0
50
100
150
200
250
300
z [Mpc/h]
300
250
200
150
100
50
0
0
10
20
30
40
50
60
70
80
λ2
x
Figure 4.3: Slices through the box used in the borg SDSS analysis (see chapter 5). Left panel. Density in one sample
(for clarity, the quantity shown is ln(2 + δf
x)). Middle panel. Survey response operator R2
x in the ℓ= 2 luminosity
bin, corresponding to absolute r-band magnitudes in the range −19.67
<
M 2
0.1r
<
−19.00. Right panel. Poisson
intensity ﬁeld λ2
x for this sample and luminosity bin, computed with equation (4.20). The bias and noise parameters are
respectively α2 = 1.30822 and e
N 2 = 1.39989 (see table 5.1).
Note that coeﬃcients αℓand βℓdepend on ℓ, which means that the data model accounts for luminosity-
dependent galaxy biases. Parameters βℓare automatically calibrated during the generation of the Markov
Chain (see section 4.3.1). For simplicity, parameters αℓare kept at ﬁxed, ﬁducial values. In the borg
analysis of the SDSS (chapter 5), these values are determined using a standard model for luminosity-
dependent galaxy bias.
In their analysis of the 2M++ catalog (Lavaux & Hudson, 2011), Lavaux &
Jasche (2016) show that it is possible to calibrate these values with a preliminary ares inference, for
subsequent use in borg.
5. Mean number of galaxies. To get the expected number of galaxies from the unnormalized galaxy density,
the quantity βℓ(1 + δf)αℓhas to be multiplied by the mean number of galaxies in bin ℓ, ¯N ℓ. This step is
therefore simply:
βℓ(1 + δf)αℓ7→¯N ℓβℓ(1 + δf)αℓ.
(4.17)
6. Observational eﬀects. The last step is to put in the luminosity-dependent selection eﬀects and the survey
mask. For this, we multiply with the linear survey response operator Rℓ
x, a voxel-wise three-dimensional
function that incorporates survey geometries and selection eﬀects:
¯N ℓβℓ(1 + δf
x)αℓ7→Rℓ
x ¯N ℓβℓ(1 + δf
x)αℓ.
(4.18)
Eventually, the Poisson intensity ﬁeld is given by
λℓ
x(δi) = Rℓ
x ¯N ℓβℓ 1 +

G(δi)

x
αℓ
.
(4.19)
We note that ¯N ℓand βℓare degenerate, in the sense that only the product ¯N ℓβℓmatters. We deﬁne e
N ℓ≡¯N ℓβℓ,
so that
λℓ
x(δi) = Rℓ
x e
N ℓ 1 +

G(δi)

x
αℓ
.
(4.20)
e
N ℓrepresents the overall noise level in bin ℓ. With the improved borg data model (Jasche, Leclercq & Wandelt,
2015), we automatically calibrate this parameter (see section 4.3.1). In ﬁgure 4.3, we illustrate the construction
of the Poisson intensity ﬁeld for the ℓ= 2 bin of the SDSS analysis. We show the dark matter density, δf
x, the
survey response operator R2
x and the Poisson intensity λ2
x.

4.2. The BORG data model
71
4.2.2.4
The comprehensive large-scale structure likelihood
Noting d ≡{N ℓ} the total data set, i.e. all available galaxy number counts, and e
N ≡{ e
N ℓ} the set of noise
parameters in each bin, we obtain the ﬁnal expression for the LSS likelihood using equations (4.12), (4.13) and
(4.20). It reads
P(d|δi, e
N) =
Y
x,ℓ
exp

−Rℓ
x e
N ℓ(1 +

G(δi)

x)αℓ 
Rℓ
x e
N ℓ(1 +

G(δi)

x)αℓN ℓ
x
N ℓx!
(4.21)
In this equation, we omitted on the right side of the conditioning bar the sets {Rℓ
x} and {αℓ} (one can consider
that all probabilities inferred by borg are conditional on these). However, we now write explicitly e
N, as this
will be of importance later.
4.2.3
The posterior distribution
As usual in Bayesian statistics, the posterior distribution is obtained, up to a normalization constant, by
the use of Bayes’ formula,
P(δi|d, S, e
N) ∝P(δi|S, e
N) P(d|δi, S, e
N) = P(δi|S) P(d|δi, e
N).
(4.22)
Substituting equations (4.3) and (4.21) allows to write down the full problem solved by borg for the density
distribution:
P(δi|d, S, e
N) ∝
1
p
|2πS|
exp

−1
2
X
x,x′
δi
xS−1
xx′δi
x′

Y
x,ℓ
exp

−Rℓ
x e
N ℓ(1 +

G(δi)

x)αℓ 
Rℓ
x e
N ℓ(1 +

G(δi)

x)αℓN ℓ
x
N ℓx!
.
(4.23)
It is simpler to express the borg posterior in terms of the initial conditions, but recall that one gets the
ﬁnal conditions (and in fact the entire LSS history, as demonstrated in chapter 5) automatically and entirely
deterministically via the structure formation model G (see section 4.2.1.2):
P(δf, δi|d, S, e
N) = P(δi|d, S, e
N)
Y
x
δD
 δf
x −

G(δi)

x

.
(4.24)
4.2.4
The Γ-distribution for noise sampling
This section draws from appendix A of Jasche, Leclercq & Wandelt (2015).
We aim at automatically calibrating, during the sampling procedure, the noise level of each luminosity
bin, given the data and the current density sample. This requires to write down the conditional probability
P( e
N ℓ|N ℓ, δf), which we do in this section.
According to Bayes’ formula, we can write
P( e
N ℓ|N ℓ, δf) ∝P( e
N ℓ) P(N ℓ| e
N ℓ, δf),
(4.25)
where we have assumed the conditional independence P( e
N ℓ|δf) = P( e
N ℓ). In the absence of any further informa-
tion on the parameter e
N ℓ, we follow the maximum agnostic approach pursued by Jasche & Wandelt (2013b) by
setting the prior distribution e
N ℓconstant. By using the Poisson likelihood for P(N ℓ| e
N ℓ, δf) (equations (4.13)
and (4.20)) into equation (4.25), we obtain the conditional posterior for the noise parameter e
N ℓas:
P( e
N ℓ|N ℓ, δf) ∝exp

−e
N ℓAℓ

×

e
N ℓBℓ,
(4.26)
where Aℓ≡P
x
Rℓ
x(1 + δf
x)αℓand Bℓ≡P
x
N ℓ
x. By choosing kℓ≡Bℓ+ 1 and θℓ≡1/Aℓ, we yield a properly
normalized Γ-distribution for the noise parameter e
N ℓ, given as:
P( e
N ℓ|N ℓ, δf) = Γ[kℓ, θℓ]

e
N ℓ
=

e
N ℓkℓ−1
exp

−e
Nℓ
θℓ

θkℓ
ℓΓ(kℓ)
.
(4.27)

72
Chapter 4. Physical large-scale structure inference with the BORG algorithm
data
d = {N ℓ}
density sampling
P(δf, δi|d, S, e
N)
new e
N
sample
new δ
sample
noise sampling
P( e
N ℓ|N ℓ, δf)
data
d = {N ℓ}
Figure 4.4: Flow chart depicting the multi-step iterative block sampling procedure. In the ﬁrst step, borg generates
random realizations of the initial and ﬁnal density ﬁelds conditional on the galaxy samples d and on the noise levels
{ e
N ℓ}. In a subsequent step, the noise parameters e
N ℓare sampled conditional on the previous density realizations.
with shape parameter
kℓ≡1 +
X
x
N ℓ
x,
(4.28)
and scale parameter
θℓ≡
1
P
x
Rℓx(1 + δfx)αℓ.
(4.29)
4.3
Sampling procedure and numerical implementation
4.3.1
Calibration of the noise level
This section draws from section 3.2. in Jasche, Leclercq & Wandelt (2015).
Following the approach described in Jasche & Wandelt (2013b), density ﬁelds and noise level parameters
can be jointly inferred by introducing an additional sampling block to the original implementation of the borg
algorithm. The additional sampling block is designed to provide random samples of the noise parameters e
N ℓ
given the galaxy data set N ℓand the current ﬁnal density sample δf.
As indicated by ﬁgure 4.4, in a ﬁrst step, the algorithm infers density ﬁelds, then conditionally samples the
noise parameters. Iteration of this procedure yields Markovian samples from the joint target distribution.
As demonstrated in section 4.2.4, the posterior distributions of noise parameters e
N ℓare Γ-distributions. In
the new sampling block, random variates of the Γ-distribution are generated by standard routines provided by
the GNU scientiﬁc library (Galassi et al., 2003).
4.3.2
Hamiltonian Monte Carlo and equations of motion for the LSS density
Sampling of the posterior distribution for density ﬁelds is achieved via Hamiltonian Monte Carlo.
As
described in section 3.4.3, HMC permits to explore the non-linear posterior by following Hamiltonian dynamics
in the high-dimensional parameter space. Omitting normalization constants, the Hamiltonian potential ψ(δi)
can be written as:
ψ(δi)
=
−ln P(δi|d, S, e
N) −ln Z
(4.30)
=
ψprior(δi) + ψlikelihood(δi),
(4.31)

4.3. Sampling procedure and numerical implementation
73
with the “prior potential” ψprior(δi) given as
ψprior(δi) = 1
2
X
x,x′
δi
xS−1
xx′δi
x′,
(4.32)
and the “likelihood potential” ψlikelihood(δi) given as
ψlikelihood(δi) =
X
x,ℓ
Rℓ
x e
N ℓ 1 +

G(δi)

x
αℓ
−N ℓ
x ln

Rℓ
x e
N ℓ 1 +

G(δi)

x
αℓ
.
(4.33)
Given the above deﬁnitions of the potential ψ(δi), one can obtain the required Hamiltonian force (see
equation (3.32)) by diﬀerentiating with respect to δi
x:
∂ψ(δi)
∂δix
= ∂ψprior(δi)
∂δix
+ ∂ψlikelihood(δi)
∂δix
.
(4.34)
The prior term is given by
∂ψprior(δi)
∂δix
=
X
x′
S−1
xx′δi
x′
(4.35)
The likelihood term cannot be obtained trivially. However, the choice of 2LPT and a CiC kernel to model
G(δi) makes possible to derive this term analytically. This is of crucial importance, because a numerical estima-
tion of gradients is very expensive. A detailed computation can be found in appendix D of Jasche & Wandelt
(2013a). The result is
∂ψlikelihood(δi)
∂δix
= −D1Jx + D2
X
a>b
 τaabb
x
+ τbbaa
x
−2τabab
x

,
(4.36)
where D1 and D2 are the ﬁrst and second-order growth factors at the desired time (a = 1), and Jx and τabcd
x
are a vector and a tensor that depend on Rℓ
x, e
N ℓ, αℓ, N ℓ
x.
Finally, the equations of motion for the Hamiltonian system can be written as
dδi
x
dt
=
X
x′
M −1
xx′ px′,
(4.37)
dpx
dt
=
−
X
x′
S−1
xx′δi
x′ + D1Jx(δi) −D2
X
a>b
 τaabb
x
(δi) + τbbaa
x
(δi) −2τabab
x
(δi)

(4.38)
4.3.3
The mass matrix
As mentioned in section 3.4.3, the HMC algorithm possesses a large number of tunable parameters contained
in the mass matrix M, whose choice can strongly impact the eﬃciency of the sampler. As shown in Jasche
& Wandelt (2013a, section 5.2 and appendix F), a good approach to obtain suitable masses is to perform a
stability analysis of the numerical leapfrog scheme (see section 4.3.4) implemented as integrator. This results
in the following prescription:
Mxx′ ≡S−1
xx′ −δxx′
K D1
∂Jx(δi)
∂δix
(ξx) ,
(4.39)
where δK is a Kronecker delta symbol and ξx is assumed to be the mean initial density contrast in high
probability regions, i.e. once the sampler has moved beyond the burn-in phase.
Due to the high-dimensionality of the problem, inverting M and storing M −1 is computationally impractical.
Therefore, a diagonal mass matrix is constructed from equation (4.39).
4.3.4
The leapfrog scheme integrator
For computer implementation, Hamilton’s equations, (4.37) and (4.38), must be approximated by discretizing
time, using some small stepsize, ε. Several choices of integrator, such as the popular Euler’s method, are possible
(see section B.5.1).

74
Chapter 4. Physical large-scale structure inference with the BORG algorithm
As discussed in section 3.4.3, it is essential that the adopted scheme respect reversibility and symplecticity,
to ensure incompressibility in phase space. Additionally, achieving high acceptance rates require the numerical
integration scheme to be very accurate in order to conserve the Hamiltonian. For these reasons, the integrator
adopted for implementing borg is the leapfrog scheme (e.g. Birdsall & Langdon, 1985), which relies on a
sequence of “kick–drift–kick” operations that work as follows (see also ﬁgure B.3):
px

t + ε
2

=
px(t) −ε
2
∂ψ(δi)
∂δix
 δi
x (t)

,
(4.40)
δi
x (t + ε)
=
δi
x (t) + ε px
 t + ε
2

mx
,
(4.41)
px (t + ε)
=
px

t + ε
2

−ε
2
∂ψ(δi)
∂δix
 δi
x (t + ε)

,
(4.42)
where mx is the element of the diagonal mass matrix at position x.
The equations of motion are integrated by making n such steps with a ﬁnite step size ε. In order to prevent
resonant trajectories, time steps are slightly randomized (ε is randomly drawn from a uniform distribution).
4.4
Testing BORG
Demonstrating of the performance of the borg algorithm is the subject of sections 6 and 7 in Jasche &
Wandelt (2013a). As these results are relevant to set the borg SDSS analysis on ﬁrm statistical grounds, in
the following, we brieﬂy report on the original test using mock observations.
4.4.1
Generating mock observations
The ﬁrst step is to generate an initial Gaussian random ﬁeld (see section B.3). This was done on a three-
dimensional Cartesian grid of 1283 voxels covering a comoving cubic box of length 750 Mpc/h with periodic
boundary conditions. The Fourier-space covariance matrix includes an Eisenstein & Hu (1998, 1999) cosmolog-
ical power spectrum with baryonic wiggles. The cosmological parameters are ﬁxed at ﬁducial values,
ΩΛ = 0.78, Ωm = 0.22, Ωb = 0.04, σ8 = 0.807, h = 0.702, ns = 0.961.
(4.43)
The Gaussian initial conditions are populated by a Lagrangian lattice of 2563 particles, that are propagated
forward in time using the same implementation of second-order Lagrangian perturbation theory as used in
borg.
The ﬁnal density ﬁeld is constructed from the resultant particle distribution using the cloud-in-cell
scheme. Note that it is crucial to use the 2LPT model for structure formation at this point, instead of, for
example, a full N-body simulation, in order to demonstrate that borg correctly infers the input ﬁeld. Only
in this fashion can we demonstrate that the borg complicated statistical machinery works, and compare the
input and output without diﬀerences due to additional physics.
An artiﬁcial tracer catalog is then generated by simulating an inhomogeneous Poisson process characterized
by equations (4.13) and (4.20) (see also ﬁgure 4.3 for an illustration). For the purpose of the test run, the
problem is simpliﬁed to only one luminosity bin (ℓ= 0), the mean number of galaxies ¯N 0 is ﬁxed, and the
tracers are supposed to be unbiased (which amounts to ﬁxing α0 = 1, β0 = 1). However, the survey response
operator R0
x involves a highly-structured survey mask (mimicking the geometry of the Sloan Digital Sky Survey
data release 7) and realistic selection functions (based on standard Schechter luminosity functions), in order to
demonstrate the possibility of doing large-scale structure inference from real data sets.
4.4.2
Convergence and correlations of the Markov Chain
As mentioned in section 3.4.3, HMC is designed to have the target distribution as its stationary distribution.
Therefore, the sampling process provides samples of the posterior distribution (equation (4.23)) after an initial
burn-in phase. Jasche & Wandelt (2013a) showed that during this phase, of the order of 600 samples, the power
spectrum converges at all scales towards the true power in the initial density ﬁeld. The absence of any power
excess or deﬁciency demonstrates the correct treatment of the response operator. The analysis also showed that
burn-in also manifests itself in the acceptance rate, which has a dip around after 100 samples, then increases
and asymptotes at a constant value of around 84%.

4.5. Future extensions of BORG
75
Generally, successive samples of the chain will be correlated to previous samples. The correlation length of
the chain determines the amount of independent samples that can be drawn from the total chain. Jasche &
Wandelt (2013a) estimated the correlation length to about 200 samples and obtained a total of 15,000 samples;
which amounts to around 72 independent samples after burn-in.
These statistical tests demonstrate that exploring the large-scale structure posterior is numerically feasible
despite the high dimensionality of the problem.
4.4.3
Large-scale structure inference
This section discusses the large-scale structure inferred via the application of borg to the synthetic data set.
Figure 4.5 shows slices through various three-dimensional quantities: the true initial density ﬁeld, one sample
of initial conditions, the posterior mean for the initial density ﬁeld; the same quantities for ﬁnal density ﬁelds;
the posterior standard deviation in the initial and ﬁnal conditions; and the mock data set.
Comparison of initial and ﬁnal density ﬁelds permits to check the correspondence between structures with
growing statistical complexity. Furthermore, comparison of ﬁnal density ﬁelds to the data demonstrates the
accuracy of the inference of the underlying dark matter density ﬁeld. In particular, one can see that the algo-
rithm extrapolates unobserved ﬁlaments between clusters, based on the physical picture of structure formation
provided by 2LPT. At high redshift or near the survey boundaries, complex structures appear continuous,
which proves that the algorithm augments unobserved or poorly constrained regions with statistically correct
information, consistently with the structure formation model. Therefore, each individual sample is a physical
dark matter realization, to the level of accuracy of 2LPT.
The variation between samples quantiﬁes joint and correlated uncertainties. This is illustrated in ﬁgure
4.5 by unobserved regions in the posterior means, where the values in diﬀerent samples average to cosmic
mean density, and by the posterior standard deviations. Therefore, contrary to other reconstruction approaches
found in the literature, borg possesses a demonstrated capability of quantifying uncertainty of inferred maps,
locally and globally. These uncertainties can then be propagated to any derived quantity, as we demonstrate
for example with cosmic web types in chapter 9.
Finally, Jasche & Wandelt (2013a) demonstrated that the inferred initial density contrast follows Gaussian
one-point statistics, that inferred density ﬁelds cross-correlate with the true solution as expected (i.e. R(k) ≡
Pδinferred×δtrue/
p
PδinferredPδtrue →1 as k →0), and that borg also infers the underlying velocity ﬁeld in detail.
4.5
Future extensions of BORG
The method described in this chapter forms the basis of a sophisticated, but also extensible, physical large-
scale structure inference framework.
In particular, natural extensions of the borg algorithm would enable
automatic calibration of bias parameters (the exponents αℓin previous sections) and of the covariance matrix of
initial ﬂuctuations (the matrix S). This would allow precise inference of the early-time matter power spectrum
from biased catalogs of tracers. As noted in the introduction, this endeavor could yield a vast gain of information
for the determination of cosmological parameters, in comparison to state-of-the-art techniques.
Let us consider a set of comoving wavenumbers {kn} and let us denote by P ≡{P(kn)} the set of corre-
sponding power spectrum coeﬃcients. Since direct sampling from P(P|d) is impossible, or at least diﬃcult,
Jasche et al. (2010a) proposed to explore the full multi-dimensional joint posterior of power spectra coeﬃcients
and density ﬂuctuations, P(δf, P|d). They employ a two-steps Gibbs sampling scheme, a method previously
applied to CMB data analysis (Wandelt, Larson & Lakshminarayanan, 2004; Eriksen et al., 2004; Jewell, Levin
& Anderson, 2004):
δf
↶
P(δf|P, d),
(4.44)
P
↶
P(P|δf, d),
(4.45)
where the arrow denotes a random draw from the pdf on its right. The ares code is an implementation of
this scheme. It assumes the conditional independence P(P|δf, d) = P(P|δf), which yields an inverse-Gamma
distribution for power spectrum coeﬃcients, and a Gaussian prior for δf (i.e. a Wiener posterior for P(δf|P, d);
see Jasche et al., 2010a). In Jasche & Wandelt (2013b), updates and improvements of ares are introduced, in
order to account for uncertainties arising from galaxy biases and normalizations of the galaxy density (i.e. noise
levels).

76
Chapter 4. Physical large-scale structure inference with the BORG algorithm
0
100
200
300
400
500
600
700
x [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
true initial perturbations
in simulation
−0.010
−0.005
0.000
0.005
δ
0
100
200
300
400
500
600
700
x [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
one sample
(initial conditions)
−0.010
−0.005
0.000
0.005
δ
0
100
200
300
400
500
600
700
x [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
posterior mean
(initial conditions)
−0.004
−0.002
0.000
0.002
0.004
δ
0
100
200
300
400
500
600
700
x [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
true evolved perturbations
in simulation
0.0
0.4
0.8
1.2
1.6
2.0
2.4
2.8
3.2
ln(2 + δ)
0
100
200
300
400
500
600
700
x [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
one sample
(ﬁnal conditions)
0.0
0.4
0.8
1.2
1.6
2.0
2.4
2.8
3.2
ln(2 + δ)
0
100
200
300
400
500
600
700
x [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
posterior mean
(ﬁnal conditions)
0.0
0.4
0.8
1.2
1.6
2.0
2.4
2.8
3.2
ln(2 + δ)
0
100
200
300
400
500
600
700
x [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
posterior standard deviation
(initial conditions)
−1.48
−1.42
−1.36
−1.30
log
rD
(δi −⟨δi⟩)2E
0
100
200
300
400
500
600
700
x [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
posterior standard deviation
(ﬁnal conditions)
−0.6
−0.3
0.0
0.3
log
rD
(δf −⟨δf⟩)2E
0
100
200
300
400
500
600
700
x [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
galaxy number counts
0
1
2
3
4
5
6
7
8
Figure 4.5: Slices through the box used for testing borg on a synthetic data set. Various quantities (indicated above
the panels) are shown. The comparison between panels illustrates the performance of borg at inferring density ﬁelds
and demonstrates its capability of quantifying uncertainties. This ﬁgure shows results originally obtained by Jasche &
Wandelt (2013a), courtesy of Jens Jasche.

4.5. Future extensions of BORG
77
data
d = {N ℓ}
density sampling
P(δf, δi|d, S, e
N, α)
new δ
sample
bias sampling
P(αℓ|d, δf, e
N ℓ)
data
d = {N ℓ}
new α
sample
new e
N
sample
noise sampling
P( e
N ℓ|N ℓ, δf)
data
d = {N ℓ}
new S
sample
power spectrum sampling
P(S|δi, e
N, α)
Figure 4.6: Flow chart depicting the multi-step iterative block sampling procedure for a natural extension of the borg
algorithm. In the ﬁrst step, borg generates random realizations of initial and ﬁnal density ﬁelds conditional on the
galaxy samples d, on the covariance matrix of initial ﬂuctuations, S, on the noise levels { e
N ℓ} and on the bias parameters
{αℓ}. In subsequent steps, the bias parameters, the covariance matrix and the noise parameters are sampled conditional
on respective previous samples and on the data when necessary. Iterations of this procedure yield samples from the full
joint posterior distribution, P(δf, δi, S, e
N, α|d).
Following these ideas, an extended borg algorithm should perform iterative block sampling according to
the scheme given in ﬁgure 4.6 (for reference, see also ﬁgure 4.4 for the current borg algorithm, and ﬁgure 1
in Jasche & Wandelt, 2013b, for the ares algorithm). In comparison to the conditional posterior expressions
written down by Jasche et al. (2010a) and Jasche & Wandelt (2013b), this procedure would involve the expression
of P(αℓ|d, δf, e
N ℓ) in terms of the borg power-law bias model (instead of the linear bias model of ares) and
of P(S|δi, e
N, α) in terms of initial (instead of ﬁnal) density ﬁelds.2 In ares, density sampling is by far the
most expensive step. It can be done by constructing the Wiener-ﬁltered map (which requires inversions of large
matrices, see equations (1.27) and (1.28)) and augmenting missing ﬂuctuations from the prior (Jasche et al.,
2010a), by means of HMC (Jasche & Wandelt, 2013b), or by using an auxiliary messenger ﬁeld, which removes
the need for matrix inversion (Jasche & Lavaux, 2015; see also Elsner & Wandelt, 2013). For the borg data
model, involving a structure formation model instead of a Gaussian prior for the galaxy density, HMC is the
state-of-the-art technique.
An upcoming improvement of borg will involve the joint sampling of density δi, noise levels e
N ℓand bias
parameters αℓ. Unfortunately, computational time issues mean that joint, physical inference of density and
power spectra is still out of reach. Correlation lengths are of the order of 200 samples for borg density ﬁelds
(Jasche & Wandelt, 2013a) and 100 samples for ares power spectrum coeﬃcients (Jasche & Wandelt, 2013b).3
Preliminary tests indicate that the correlation length for the joint inference process is of the order of a few
hundred samples. However, even with a correlation length of 100 samples, accurate characterization of power
spectra and corresponding uncertainties require, at least, about 40,000 samples. With the current performance
of the borg sampler (discussed in sections 4.4.2 and 5.2), such a run would take several years on a typical
computer. For this reason, this thesis focuses on sampling the matter density ﬁeld for a ﬁxed power spectrum
of primordial ﬂuctuations, rather than sampling this as well.
Algorithmic and methodological innovations
that would render such a run possible are currently being discussed but will require a considerable additional
implementation eﬀort and are outside the scope of this thesis.
2 As noted in section 4.2.1.1, the Fourier-space representation of S is a diagonal matrix containing the coeﬃcients
p
P(k)/(2π)3/2.
3 See Jasche & Wandelt, 2013b; Jewell et al., 2009, for the discussion of a method designed to reduce the otherwise prohibitively
long correlation length of ares chains.


Chapter 5
Past and present cosmic structure in the
Sloan Digital Sky Survey
Contents
5.1
The SDSS galaxy sample . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
80
5.2
The BORG SDSS analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
80
5.3
Inference results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
82
5.3.1
Inferred 3D density ﬁelds
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
82
5.3.2
Inference of 3D velocity ﬁelds . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
86
5.3.3
Inference of LSS formation histories
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
86
5.4
Summary and conclusions
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
89
“Map-making had never been a precise art on the Discworld. People
tended to start oﬀwith good intentions and then get so carried away
with the spouting whales, monsters, waves, and other twiddly bits
of cartographic furniture that they often forgot to put the boring
mountains and rivers in at all.”
— Terry Pratchett (1990), Moving Pictures
Abstract
We present a chrono-cosmography project, aiming at the inference of the four dimensional formation history of the
observed large-scale structure from its origin to the present epoch. To do so, we perform a full-scale Bayesian analysis
of the northern galactic cap of the Sloan Digital Sky Survey (SDSS) Data Release 7 main galaxy sample, relying on
a fully probabilistic, physical model of the non-linearly evolved density ﬁeld. Besides inferring initial conditions from
observations, our methodology naturally and accurately reconstructs non-linear features at the present epoch, such as
walls and ﬁlaments, corresponding to high-order correlation functions generated by late-time structure formation. Our
inference framework self-consistently accounts for typical observational systematic and statistical uncertainties such as
noise, survey geometry and selection eﬀects. We further account for luminosity dependent galaxy biases and automatic
noise calibration within a fully Bayesian approach. As a result, this analysis provides highly-detailed and accurate
reconstructions of the present density ﬁeld on scales larger than ∼
3 Mpc/h, constrained by SDSS observations.
This approach also leads to the ﬁrst quantitative inference of plausible formation histories of the dynamic large
scale structure underlying the observed galaxy distribution. The results described in this chapter constitute the ﬁrst
full Bayesian non-linear analysis of the cosmic large scale structure with the demonstrated capability of uncertainty
quantiﬁcation. Some of these results have been made publicly available along with the corresponding paper. The
level of detail of inferred results and the high degree of control on observational uncertainties pave the path towards
high precision chrono-cosmography, the subject of simultaneously studying the dynamics and the morphology of the
inhomogeneous Universe.
This chapter is adapted from its corresponding publication, Jasche, Leclercq & Wandelt (2015).
This chapter describes the borg analysis of the Sloan Digital Sky Survey Data Release 7 main galaxy sample.
It is structured as follows. In section 5.1, we give a brief overview about the SDSS data set used in the analysis.
In section 5.2, we demonstrate the application of the borg inference algorithm to observations and discuss

80
Chapter 5. Past and present cosmic structure in the Sloan Digital Sky Survey
the general performance of the Hamiltonian Monte Carlo sampler. Section 5.3 describes the inference results
obtained in the course of this work. In particular, we present results on inferred 3D initial and ﬁnal density
as well as velocity ﬁelds and show the ability of our method to provide accurate uncertainty quantiﬁcation for
any ﬁnally inferred quantity. Further, we also demonstrate the ability of our methodology to perform chrono-
cosmography, by accurately inferring plausible 4D formation histories for the observed LSS from its origins to
the present epoch. In section 5.4, we conclude by summarizing and discussing the results obtained in the course
of this project.
5.1
The SDSS galaxy sample
In this work, we follow a similar procedure as described in Jasche et al. (2010b), by applying the borg
algorithm to the SDSS main galaxy sample. Speciﬁcally, we employ the Sample dr72 of the New York University
Value Added Catalogue1 (NYU-VAGC). This is an updated version of the catalogue originally constructed by
Blanton et al. (2005) and is based on the ﬁnal data release (DR7; Abazajian et al., 2009) of the Sloan Digital
Sky Survey (SDSS; York et al., 2000).
Based on Sample dr72, we construct a ﬂux-limited galaxy sample
with spectroscopically measured redshifts in the range 0.001 < z < 0.4, r-band Petrosian apparent magnitude
r ≤17.6 after correction for Galactic extinction, and r-band absolute magnitude −21 < M0.1r < −17. Absolute
r-band magnitudes are corrected to their z = 0.1 values using the K-correction code of Blanton et al. (2003a);
Blanton & Roweis (2007) and the luminosity evolution model described in Blanton et al. (2003b). We also
restrict our analysis to the main contiguous region of the SDSS in the northern Galactic cap, excluding the
three survey strips in the southern cap (about 10 per cent of the full survey area). The NYU-VAGC provides
required information on the incompleteness in our spectroscopic sample. This includes a mask, indicating which
areas of the sky have been targeted and which not. The mask deﬁnes the eﬀective area of the survey on the
sky, which is 6437 deg2 for the sample we use here. This survey area is divided into a large number of smaller
subareas, called polygons, for each of which the NYU-VAGC lists a spectroscopic completeness, deﬁned as the
fraction of photometrically identiﬁed target galaxies in the polygon for which usable spectra were obtained.
Throughout our sample the average completeness is 0.92. To account for radial selection functions, deﬁned as
the fraction of galaxies in the absolute magnitude range considered here, that are within the apparent magnitude
range of the sample at a given redshift, we use a standard luminosity function proposed by Schechter (1976)
with r-band parameters α = −1.05, M∗−5 log10(h) = −20.44 (Blanton et al., 2003c).
Our analysis accounts for luminosity dependent galaxy biases, by following the approach described in section
4.2. In order to do so, we subdivide our galaxy sample into six equidistant bins in absolute r-band magnitude in
the range −21 < M0.1r < −17, resulting in a total of 372, 198 main sample galaxies to be used in the analysis.
As described in section 4.2, splitting the galaxy sample permits us to treat each of these sub-samples as an
individual data set, with its respective selection eﬀects, biases and noise levels.
5.2
The BORG SDSS analysis
We performed the analysis of the SDSS main galaxy sample on a cubic Cartesian domain with a side length
of 750 Mpc/h consisting of 2563 equidistant grid nodes, resulting in ∼1.6× 107 inference parameters. Thus, the
inference procedure provides data-constrained realizations for initial and ﬁnal density ﬁelds at a grid resolution
of about ∼3 Mpc/h. For the analysis, we assume a standard ΛCDM cosmology with the set of cosmological
parameters
ΩΛ = 0.728, Ωm = 0.272, Ωb = 0.045, σ8 = 0.807, h = 0.702, ns = 0.961.
(5.1)
The cosmological power spectrum for initial density ﬁelds is calculated according to the prescription provided
by Eisenstein & Hu (1998, 1999). In order to suﬃciently resolve the ﬁnal density ﬁeld, the 2LPT model is
evaluated with 5123 particles, by oversampling initial conditions by a factor of eight.
We adjusted the parameters αℓof the assumed power-law bias model during the initial 1000 sampling steps,
but kept them ﬁxed afterwards. For the purpose of this work, the power-law indices αℓof the bias relations
are determined by requiring them to resemble the linear luminosity dependent bias when expanded in a Taylor
series to linear order as:
(1 + δf)αℓ= 1 + αℓδf + O
 δf2
.
(5.2)
1 http://sdss.physics.nyu.edu/vagc/

5.2. The BORG SDSS analysis
81
M ℓ
0.1r
αℓ
e
N ℓ
−21.00 < M 0
0.1r < −20.33
1.58029
4.67438 ×10−2 ± 3.51298 × 10−4
−20.33 < M 1
0.1r < −19.67
1.41519
9.54428 ×10−2 ± 5.77786 × 10−4
−19.67 < M 2
0.1r < −19.00
1.30822
1.39989 ×10−1 ± 1.21087 × 10−3
−19.00 < M 3
0.1r < −18.33
1.23272
1.74284 ×10−1 ± 1.89168 × 10−3
−18.33 < M 4
0.1r < −17.67
1.17424
2.19634 ×10−1 ± 3.42586 × 10−3
−17.67 < M 5
0.1r < −17.00
1.12497
2.86236 ×10−1 ± 5.57014 × 10−3
Table 5.1: Bias and noise parameters, as described in the text, for six galaxy sub-samples, subdivided by their absolute
r-band magnitudes.
500
1000 1500 2000 2500 3000 3500 4000
n
0.35
0.40
0.45
0.50
0.55
0.60
0.65
0.70
0.75
acceptance rate
500
1000 1500 2000 2500 3000 3500 4000
n
500
1000
1500
2000
2500
3000
tsamp [s]
Figure 5.1: Diagnotics of the Markov chain: scatter plot of sample generation times (left panel) and Markov acceptance
rates during the initial burn-in phase (right panel). As shown by the left panel, times to generate individual samples
range from zero to about 3000 seconds. The average execution time per sample generation is about 1500 seconds on 16
cores. Initially, acceptance rates drop during burn-in but rise again to reach an asymptotic value of about 60 percent.
In particular, we assume the functional shape of the luminosity dependent bias parameter αℓto follow a standard
model for the linear luminosity dependent bias in terms of absolute r-band magnitudes M0.1r, as given by:
αℓ= b(M ℓ
0.1r) = b∗

a + b × 100.4(M∗−M ℓ
0.1r) + c ×
 M ℓ
0.1r −M∗

,
(5.3)
with the ﬁtting parameters a = 0.895, b = 0.150, c = −0.040 and M∗= −20.40 (see e.g. Norberg et al., 2001;
Tegmark et al., 2004, for details). The parameter b∗was adjusted during the initial burn-in phase and was
ﬁnally set to a ﬁxed value of b∗= 1.44, such that the sampler recovers the correct shape of the assumed initial
power spectrum.
As described in sections 4.2.4 and 4.3.1, contrary to bias exponents, corresponding noise parameters e
N ℓare
sampled and explored throughout the entire Markov chain. Inferred ensemble means and standard deviations
for the e
N ℓalong with chosen power-law parameters αℓare provided in table 5.1.
The entire analysis yielded 12, 000 realizations for initial and ﬁnal density ﬁelds. The generation of a single
Markov sample requires an operation count equivalent to about ∼
200 2LPT model evaluations.
Typical
generation times for data-constrained realizations are shown in the left panel of ﬁgure 5.1. On average the
sampler requires about 1500 seconds to generate a single density ﬁeld realization on 16 cores. The total analysis
consumed several months of computing time and produced on the order of ∼3 TB of information represented
by the set of Markov samples.

82
Chapter 5. Past and present cosmic structure in the Sloan Digital Sky Survey
10
-6
10
-5
10
-4
10
-3
10
-2
10
-1
P(k) [(h−1 Mpc)3 ]
10
-1
10
0
k [h Mpc−1 ]
−0.4
−0.2
0.0
0.2
0.4
ξ
0
205
410
615
820
1025
1230
1435
1640
1845
sample number
0
205
410
615
820
1025
1230
1435
1640
1845
sample number
Figure 5.2: Burn-in power spectra measured from the ﬁrst 2000 samples of the Markov chain colored corresponding
to their sample number as indicated by the colorbar. The black line represents a ﬁducial reference power spectrum
for the cosmology assumed in this work. Subsequent power spectra approach the ﬁducial cosmological power spectrum
homogeneously throughout all scales in Fourier space.
The numerical eﬃciency of any Markov Chain Monte Carlo algorithm, particularly in high dimensions, is
crucially determined by the average acceptance rate. As demonstrated by the right panel of ﬁgure 5.1, after an
initial burn-in period, the acceptance rate asymptotes at a value of about 60 percent, rendering our analysis
numerically feasible. As a simple consistency check, we follow a standard procedure to determine the initial
burn-in behavior of the sampler via a simple experiment (see e.g. Eriksen et al., 2004; Jasche & Kitaura, 2010;
Jasche & Wandelt, 2013a, for more details). The sampler is initialized with an overdispersed state, far remote
from the target region in parameter space, by scaling normal random amplitudes of the initial density ﬁeld at a
cosmic scale factor of a = 10−3 by a constant factor of 0.01. In the course of the initial burn-in phase, the Markov
chain should then drift towards preferred regions in parameter space. As demonstrated by ﬁgure 5.2, this drift is
manifested by a sequence of posterior power spectra measured from subsequent initial density ﬁeld realizations.
It can be clearly seen that the chain approaches the target region within the ﬁrst 2000 sampling steps. The
sequence of power spectra shows a homogeneous drift of all modes with no indication of any particular hysteresis
or bias across diﬀerent scales in Fourier space. As improper treatment of survey systematics, uncertainties and
galaxy bias typically result in obvious erroneous features in power spectra, ﬁgure 5.2 clearly demonstrates that
these eﬀects have been accurately accounted for by the algorithm.
5.3
Inference results
This section describes inference results obtained by our Bayesian analysis of the SDSS main galaxy sample.
5.3.1
Inferred 3D density ﬁelds
A major goal of this work is to provide inferred 3D initial and ﬁnal density ﬁelds along with corresponding
uncertainty quantiﬁcation in a ∼
1.6 × 107 dimensional parameter space. To do this, the borg algorithm
provides a sampled LSS posterior distribution in terms of an ensemble of data-constrained samples, via an
eﬃcient implementation of a Markov Chain Monte Carlo algorithm. It should be remarked that, past the initial

5.3. Inference results
83
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
initial conditions
-0.012
-0.006
0.0
0.006
0.012
δ
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
ﬁnal conditions
0.0 0.4 0.8 1.2 1.6 2.0 2.4 2.8 3.2 3.6
ln(2 + δ)
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
survey response operator
0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0
R
Figure 5.3: Slices through the initial (left panel) and corresponding ﬁnal (middle panel) density ﬁelds of the 5000th
sample.
The right panel shows a corresponding slice through the combined survey response operator R for the six
absolute magnitude bins considered in this work.
As can be seen, unobserved and observed regions in the inferred
initial and ﬁnal density ﬁelds do not appear visually distinct, demonstrating the fact that individual data-constrained
realizations constitute physically meaningful density ﬁelds. It also shows that the sampler naturally extends observed
large scale structures beyond the survey boundaries in a physically and statistically fully consistent fashion.
burn-in phase, all individual samples reﬂect physically meaningful density ﬁelds, limited only by the validity of
the employed 2LPT model. In particular, the present analysis correctly accounts for selection eﬀects, survey
geometries, luminosity dependent galaxy biases and automatically calibrates the noise levels of the six luminosity
bins as described above. As can be seen in ﬁgure 5.2, past the initial burn-in phase, individual samples possess
physically correct power throughout all ranges in Fourier space, and do not show any sign of attenuation due
to survey characteristics such as survey geometry, selection eﬀects or galaxy biases.
To further illustrate that individual samples qualify for physically meaningful density ﬁelds, in ﬁgure 5.3
we show slices through data-constrained realizations of the initial and ﬁnal density ﬁelds of the 5000th sample
as well as the corresponding slice through the combined survey response operator R, averaged over the six
luminosity bins. It can be seen that the algorithm correctly augments unobserved regions with statistically
correct information.
Note that unobserved and observed regions in the inferred ﬁnal density ﬁelds do not
appear visually distinct, a consequence of the excellent approximation of 2LPT not just to the ﬁrst but also
higher-order moments (Moutarde et al., 1991; Buchert, Melott & Weiß, 1994; Bouchet et al., 1995; Scoccimarro,
2000; Scoccimarro & Sheth, 2002). Figure 5.3 therefore clearly reﬂects the fact that our sampler naturally
extends observed large scale structures beyond the survey boundaries in a physically and statistically fully
consistent fashion. This is a great advantage over previous methods relying on Gaussian or log-normal models
specifying the statistics of the density ﬁeld correctly only to two-point statistics by assuming a cosmological
power spectrum. The interested reader may want to qualitatively compare with ﬁgure 2 in Jasche et al. (2010b),
where a log-normal model, unable to represent ﬁlamentary structures, was employed.
The ensemble of the 12, 000 inferred data-constrained initial and ﬁnal density ﬁelds permits us to provide
any desired statistical summary, such as mean and variance, for full 3D ﬁelds. In ﬁgure 5.4, we show slices
through the ensemble mean initial and ﬁnal density ﬁelds, to be used in subsequent analyses. The plot shows
the correct anticipated behavior for inferred posterior mean ﬁnal density ﬁelds, since observed regions represent
data constraints, while unobserved regions approach cosmic mean density. This behavior is also present in
corresponding initial density ﬁelds. In particular, the ensemble mean ﬁnal density ﬁeld shows a highly detailed
LSS in regions where data constraints are available, and approaches cosmic mean density in regions where
data are uninformative on average (see also Jasche et al., 2010b, for comparison). Analogously, these results
translate to the ensemble mean initial density ﬁeld. Comparing the ensemble mean ﬁnal density ﬁeld to the
galaxy number densities, depicted in the lower panels of ﬁgure 5.4, demonstrates the performance of the method
in regions only poorly sampled by galaxies. In particular, comparing the right middle and right lower panel of
ﬁgure 5.4 reveals the capability of our algorithm to recover highly detailed structures even in noise dominated
regions (for a discussion see chapter 4 and Jasche & Wandelt, 2013a). By comparing ensemble mean initial and

84
Chapter 5. Past and present cosmic structure in the Sloan Digital Sky Survey
−300 −200 −100
0
100
200
300
400
y [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
0
100
200
300
400
500
600
700
−x [Mpc/h]
initial conditions
700
600
500
400
300
200
100
0
−x [Mpc/h]
−300
−200
−100
0
100
200
300
400
y [Mpc/h]
−0.008
−0.006
−0.004
−0.002
0.000
0.002
0.004
0.006
0.008
δ
−300 −200 −100
0
100
200
300
400
y [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
0
100
200
300
400
500
600
700
−x [Mpc/h]
ﬁnal conditions
700
600
500
400
300
200
100
0
−x [Mpc/h]
−300
−200
−100
0
100
200
300
400
y [Mpc/h]
0.4
0.8
1.2
1.6
2.0
2.4
2.8
3.2
ln(2 + δ)
−300 −200 −100
0
100
200
300
400
y [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
0
100
200
300
400
500
600
700
−x [Mpc/h]
galaxy number counts
700
600
500
400
300
200
100
0
−x [Mpc/h]
−300
−200
−100
0
100
200
300
400
y [Mpc/h]
0
1
2
3
4
5
6
Figure 5.4: Three slices from diﬀerent directions through the three dimensional ensemble posterior means for the ini-
tial (upper panels) and ﬁnal density ﬁelds (middle panels) estimated from 12, 000 samples. The lower panels depict
corresponding slices through the galaxy number counts ﬁeld of the SDSS main sample.

5.3. Inference results
85
−300 −200 −100
0
100
200
300
400
y [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
0
100
200
300
400
500
600
700
−x [Mpc/h]
initial conditions
700
600
500
400
300
200
100
0
−x [Mpc/h]
−300
−200
−100
0
100
200
300
400
y [Mpc/h]
−2.88
−2.80
−2.72
−2.64
−2.56
−2.48
−2.40
−2.32
log
rD
(δi −⟨δi⟩)2E
−300 −200 −100
0
100
200
300
400
y [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
0
100
200
300
400
500
600
700
z [Mpc/h]
0
100
200
300
400
500
600
700
−x [Mpc/h]
ﬁnal conditions
700
600
500
400
300
200
100
0
−x [Mpc/h]
−300
−200
−100
0
100
200
300
400
y [Mpc/h]
−1.25
−1.00
−0.75
−0.50
−0.25
0.00
0.25
0.50
0.75
log
rD
(δf −⟨δf⟩)2E
Figure 5.5: Three slices from diﬀerent directions through the three dimensional voxel-wise posterior standard deviation
for the initial (upper panels) and ﬁnal density ﬁelds (lower panels) estimated from 12, 000 samples. It can be seen that
regions covered by observations show on average lower variance than unobserved regions. Also note, that voxel-wise
standard deviations for the ﬁnal density ﬁelds are highly structured, reﬂecting the signal-dependence of the inhomoge-
neous shot noise of the galaxy distribution. In contrast, voxel-wise standard deviations in the initial conditions are more
homogeneously distributed, manifesting the ﬂow of information between data and initial conditions as discussed in the
text.
ﬁnal density ﬁelds, upper and middle panels in ﬁgure 5.4, one can also see correspondences between structures
in the present Universe and their origins at a scale factor of a = 10−3.
The ensemble of data-constrained realizations also permits to provide corresponding uncertainty quantiﬁ-
cation. In ﬁgure 5.5 we plot voxel-wise standard deviations for initial and ﬁnal density ﬁelds estimated from
12, 000 samples. It can be seen that regions covered by data exhibit on average lower variances than unobserved
regions, as expected. Note that for non-linear inference problems, signal and noise are typically correlated. This
is particularly true for inhomogeneous point processes, such as discrete galaxy distributions tracing an underly-
ing density ﬁeld. In ﬁgure 5.5, the correlation between signal and noise is clearly visible for standard deviation
estimates of ﬁnal density ﬁelds. In particular high density regions also correspond to high variance regions, as is
expected for Poissonian likelihoods since signal-to-noise ratios scale as the square root of the number of observed
galaxies (also see Jasche et al., 2010b, for a similar discussion). Also note that voxel-wise standard deviations
for ﬁnal density ﬁelds are highly structured, while standard deviations of initial conditions appear to be more
homogeneous. This is related to the fact that our algorithm naturally and correctly translates information of
the observations non-locally to the initial conditions via Lagrangian transport, as discussed below in section
5.3.3.
As mentioned in the introduction, results for the ensemble mean ﬁnal density ﬁeld and corresponding voxel-
wise standard deviations have been published as as supplementary material to the article (Jasche, Leclercq &
Wandelt, 2015).2
2 These data can be accessed at http://iopscience.iop.org/1475-7516/2015/01/036.

86
Chapter 5. Past and present cosmic structure in the Sloan Digital Sky Survey
5.3.2
Inference of 3D velocity ﬁelds
In addition to initial and ﬁnal density ﬁelds, the analysis further provides information on the dynamics of
the large scale structure as mediated by the employed 2LPT model. Indeed, the borg algorithm shows excellent
performance in recovering large scale modes, typically poorly constrained by masked galaxy observations (Jasche
& Wandelt, 2013a).
This a crucial feature when deriving 3D velocity ﬁelds, which are predominantly governed by the largest
scales. In this fashion, we can derive 3D velocity ﬁelds from our inference results. Note that these velocity ﬁelds
are derived a posteriori and are only predictions of the 2LPT model given inferred initial density ﬁelds, since
currently the algorithm does not exploit velocity information contained in the data. However, since inferred
2LPT displacement vectors are constrained by observations, and since 2LPT displacement vectors and velocities
diﬀer only by constant prefactors given a ﬁxed cosmology, inferred velocities are considered to be accurate. For
this reason, exploitation of velocity information contained in the data itself, being the subject of a future
publication, is not expected to crucially change present results. To demonstrate the capability of recovering 3D
velocity ﬁelds, in ﬁgure 5.6 we show the three components of the velocity ﬁeld for the 5000th sample in spherical
coordinates. More precisely, ﬁgure 5.6 shows the corresponding 2LPT particle distribution evolved to redshift
z = 0 in a 4 Mpc/h slice around the celestial equator. Particles are colored by their radial (upper panel), polar
(middle panel) and azimuthal (lower panel) velocity components. To translate between Cartesian and spherical
coordinates we used the standard coordinate transform,
x
=
dcom cos(λ) cos(η)
(5.4)
y
=
dcom cos(λ) sin(η)
(5.5)
z
=
dcom sin(λ),
(5.6)
where λ is the declination, η is the right ascension and dcom is the radial comoving distance.
5.3.3
Inference of LSS formation histories
As described in chapter 4, the borg algorithm employs a 2LPT model to connect initial conditions to
present SDSS observations in a fully probabilistic approach. Besides inferred 3D initial and ﬁnal density ﬁelds,
our algorithm therefore also provides full four dimensional formation histories for the observed LSS as mediated
by the 2LPT model. As an example, in ﬁgure 5.7 we depict the LSS formation history for the 5000th Markov
sample ranging from a scale factor of a = 0.02 to the present epoch at a = 1.00. Initially, the density ﬁeld
seems to obey close to Gaussian statistics and corresponding amplitudes are low.
In the course of cosmic
history, amplitudes grow and higher-order statistics such as three-point statistics are generated, as indicated
by the appearance of ﬁlamentary structures. The ﬁnal panel of ﬁgure 5.7, at a cosmic scale factor of a = 1.00,
shows the inferred ﬁnal density ﬁeld overplotted by SDSS galaxies for the six bins in absolute magnitude, as
described previously. Observed galaxies nicely trace the underlying density ﬁeld. This clearly demonstrates that
our algorithm infers plausible formation histories for large scale structures observed by the SDSS survey. By
exploring the corresponding LSS posterior distribution, the borg algorithm naturally generates an ensemble of
such data-constrained LSS formation histories, permitting to accurately quantify the 4D dynamical state of our
Universe and corresponding observational uncertainties inherent to galaxy surveys. Detailed and quantitative
analysis of these cosmic formation histories will be the subject of forthcoming publications (see also chapter 9).
The borg algorithm also provides a statistically valid framework for propagating observational systematics
and uncertainties from observations to any ﬁnally inferred result. This is of particular importance, since detailed
treatment of survey geometries and selection eﬀects is a crucial issue if inferred results are to be used for thorough
scientiﬁc analyses. These eﬀects generally vary greatly across the observed domain and will result in erroneous
artifacts if not accounted for properly.
Since large scale structure formation is a non-local process, exact
information propagation is complex, as it requires to translate uncertainties and systematics from observations
to the inferred initial conditions. Consequently, the information content of observed data has to be distributed
diﬀerently in initial and ﬁnal density ﬁelds, even though the total amount of information is conserved. Following
2LPT particles from high density regions, and corresponding high signal-to-noise regions in the data, backward
in time, demonstrates that the same amount of information contained in the data will be distributed over
a larger region in the initial conditions. Analogously, for underdense regions, such as voids, the information
content of the data will amass in a smaller volume at the initial state. This means that the signal-to-noise ratio
for a given comoving Eulerian volume is a function of time along inferred cosmic histories (Jasche & Wandelt,

5.3. Inference results
87
Figure 5.6: Slices through the 3D velocity ﬁelds, derived from the 5000th sample, for the radial (upper panel), polar
(middle panel) and the azimuthal (lower panel) velocity components. The plot shows 2LPT particles in a 4 Mpc/h thick
slice around the celestial equator for the observed domain, colored by their respective velocity components.

88
Chapter 5. Past and present cosmic structure in the Sloan Digital Sky Survey
0
100 200 300 400 500 600 700
0
100
200
300
400
500
600
700
−x [Mpc/h]
a = 0.02
0
100 200 300 400 500 600 700
0
100
200
300
400
500
600
700
a = 0.12
0
100 200 300 400 500 600 700
0
100
200
300
400
500
600
700
a = 0.25
0
100 200 300 400 500 600 700
0
100
200
300
400
500
600
700
a = 0.30
0.0
0.3
0.6
0.9
1.2
1.5
1.8
2.1
2.4
2.7
3.0
ln(2 + δ)
0
100 200 300 400 500 600 700
z [Mpc/h]
0
100
200
300
400
500
600
700
−x [Mpc/h]
a = 0.40
0
100 200 300 400 500 600 700
z [Mpc/h]
0
100
200
300
400
500
600
700
a = 0.50
0
100 200 300 400 500 600 700
z [Mpc/h]
0
100
200
300
400
500
600
700
a = 0.70
0
100 200 300 400 500 600 700
z [Mpc/h]
0
100
200
300
400
500
600
700
a = 1.00
0.0
0.3
0.6
0.9
1.2
1.5
1.8
2.1
2.4
2.7
3.0
ln(2 + δ)
Figure 5.7: Slices through the inferred three dimensional density ﬁeld of the 5000th sample at diﬀerent stages of its
evolution, as indicated by the cosmic scale factor in the respective panels. The plot describes a possible formation scenario
for the LSS in the observed domain starting at a scale factor of a = 0.02 to the present epoch a = 1.0. In the lower right
panel, we overplotted the inferred present density ﬁeld with the observed galaxies in the respective six absolute magnitude
ranges −21.00 < M0.1r < −20.33 (red dots), −20.33 < M0.1r < −19.67 (orange dots), −19.67 < M0.1r < −19.00 (yellow
dots), −19.00 < M0.1r < −18.33 (green dots) , −18.33 < M0.1r < −17.67 (cyan dots) and , −17.67 < M0.1r < −17.00
(blue dots).
As can be clearly seen, observed galaxies trace the recovered three dimensional density ﬁeld.
Besides
measurements of three dimensional initial and ﬁnal density ﬁelds, this plot demonstrates that our algorithm also provides
plausible four dimensional formation histories, describing the evolution of the presently observed LSS.

5.4. Summary and conclusions
89
2013a). This fact manifests itself in the diﬀerent behaviour of voxel-wise standard deviations for ﬁnal and initial
conditions, as presented in ﬁgure 5.5. While the signal-to-noise ratio is highly clustered in ﬁnal conditions, the
same amount of observational information is distributed more evenly over the entire volume in corresponding
initial conditions.
Non-local propagation of observational information across survey boundaries, together with cosmological
correlations in the initial density ﬁeld, is also the reason why our method is able to extrapolate the cosmic
LSS beyond survey boundaries, as discussed in section 5.3.1 above and demonstrated by ﬁgure 5.4. To further
demonstrate this fact, in ﬁgure 5.8, we show the density ﬁeld of the 5000th sample traced by particles from
inside and outside the observed domain at the present epoch. At the present epoch, the set of particles can be
sub-divided into two sets for particles inside and outside the observed domain. The boundary between these two
sets of particles is the sharp outline of the SDSS survey geometry. When tracing these particles back to an earlier
epoch at a scale factor of a = 0.02, it can clearly be seen that this sharp boundary starts to frazzle. Particles
within the observed domain at the ﬁnal state may originate from regions outside the corresponding Eulerian
volume at the initial state, and vice versa. Information from within the observed domain non-locally inﬂuences
the large scale structure outside the observed domain, thus increasing the region inﬂuenced by data beyond
the survey boundaries. Figure 5.8 therefore demonstrates the ability of our algorithm to correctly account for
information propagation via Lagrangian transport within a fully probabilistic approach. The ability to provide
4D dynamic formation histories for SDSS data together with accurate uncertainty quantiﬁcation paves the
path towards high precision chrono-cosmography, permitting us to study the inhomogeneous evolution of our
Universe. Detailed and quantitative analysis of the various aspects of the results obtained in this chapter are
discussed in part IV of this thesis and will be the subject of future publications.
5.4
Summary and conclusions
This chapter discusses a fully Bayesian chrono-cosmographic analysis of the 3D cosmological large scale
structure underlying the SDSS main galaxy sample (Abazajian et al., 2009). We presented a data applica-
tion of the recently proposed borg algorithm (see chapter 4 and Jasche & Wandelt, 2013a), which permits
to simultaneously infer initial and present non-linear 3D density ﬁelds from galaxy observations within a fully
probabilistic approach. As discussed in chapter 4, the algorithm incorporates a second-order Lagrangian per-
turbation model to connect observations to initial conditions and to perform dynamical large-scale structure
inference from galaxy redshift surveys.
Besides correctly accounting for usual statistical and systematic uncertainties, such as noise, survey geome-
tries and selection eﬀects, this methodology also physically treats gravitational structure formation in the linear
and mildly non-linear regime and captures higher-order statistics present in non-linear density ﬁelds (see e.g.
Moutarde et al., 1991; Buchert, Melott & Weiß, 1994; Bouchet et al., 1995; Scoccimarro, 2000; Scoccimarro
& Sheth, 2002). The borg algorithm explores a high-dimensional posterior distribution via an eﬃcient imple-
mentation of a Hamiltonian Monte Carlo sampler and therefore provides naturally and fully self-consistently
accurate uncertainty quantiﬁcation for any ﬁnally inferred quantity.
In the paper corresponding to this work (Jasche, Leclercq & Wandelt, 2015), we upgraded the original
sampling procedure described in Jasche & Wandelt (2013a) to account for automatic noise calibration and
luminosity dependent galaxy biases (see sections 4.2.4 and 4.3.1). To do so, we followed the philosophy described
in Jasche & Wandelt (2013b) and splitted the main galaxy sample into six absolute magnitude bins in the range
−21 < M0.1r < −17. The Bayesian analysis treats each of this six galaxy sub-samples as an individual data
set with its individual statistical and systematic uncertainties. As described in sections 4.2.4 and 4.3.1, the
original algorithm described in Jasche & Wandelt (2013a) has been augmented by a power-law bias model and
an additional sampling procedure to jointly infer corresponding noise levels for the respective galaxy samples.
As discussed in section 5.2, we applied this modiﬁed version of the borg algorithm to the SDSS DR7 main
galaxy samples and generated about 12,000 full three dimensional data-constrained initial conditions in the
course of this work. The initial density ﬁeld, at a scale factor of a = 10−3, has been inferred on a comoving
Cartesian equidistant grid, of side length 750 Mpc/h and 2563 grid nodes. This amounts to a target resolution
of about ∼
3 Mpc/h for respective volume elements.
Density amplitudes at these Lagrangian grid nodes
correspond to about ∼107 parameters to be constrained by our inference procedure. Typically, the generation
of individual data-constrained realizations involves an equivalent of ∼200 2LPT evaluations and requires on
the order of 1500 seconds on 16 cores. Despite the complexity of the problem, we demonstrated that our sampler

90
Chapter 5. Past and present cosmic structure in the Sloan Digital Sky Survey
0
100
200
300
400
500
600
700
0
100
200
300
400
500
600
700
−x [Mpc/h]
a = 0.02
0
100
200
300
400
500
600
700
0
100
200
300
400
500
600
700
−x [Mpc/h]
a = 0.02
0
100
200
300
400
500
600
700
z [Mpc/h]
0
100
200
300
400
500
600
700
−x [Mpc/h]
a = 1.00
0.0
0.3
0.6
0.9
1.2
1.5
1.8
2.1
2.4
2.7
3.0
ln(2 + δ)
0
100
200
300
400
500
600
700
z [Mpc/h]
0
100
200
300
400
500
600
700
−x [Mpc/h]
a = 1.00
0.0
0.3
0.6
0.9
1.2
1.5
1.8
2.1
2.4
2.7
3.0
ln(2 + δ)
Figure 5.8: Slices through the distribution of particles in the 5000th sample, which are located inside (left panels) and
outside (right panels) the observed domain at the time of observation, at two time snapshots as indicated above the
panels. It can be seen that particles located within the observed region at the present time may originate from regions
outside the corresponding comoving Eulerian volume at an earlier epoch and vice versa. As discussed in the text, this
plot demonstrates the non-local transport of information, which provides accurate inference of the cosmic large scale
structure beyond survey boundaries within a rigorous probabilistic approach.

5.4. Summary and conclusions
91
can explore multi-million dimensional parameter spaces via eﬃcient Markov Chain Monte Carlo algorithms with
an asymptotic acceptance rate of about 60 percent, rendering our numerical inference framework numerically
feasible.
To test the performance of the sampler, we followed a standard approach for testing the initial burn-in
behavior via experiments (see e.g. Eriksen et al., 2004; Jasche & Kitaura, 2010; Jasche & Wandelt, 2013a). We
initialized the sampler with a Gaussian random ﬁeld scaled by a factor of 0.01, to start from an over-dispersed
state. During an initial burn-in period the sampler performed a systematic drift towards the target region in pa-
rameter space. We examined the initial burn-in behavior by following the sequence of a posteriori power spectra,
measured from the ﬁrst 2500 samples, and showed that subsequent samples homogeneously approach the target
spectrum throughout all regions in Fourier space without any sign of hysteresis. This indicates the eﬃciency
of the sampler to rapidly explore all scales of the inference problem. The absence of any particular bias or
erroneous power throughout all scales in Fourier space, further demonstrates the fact that survey geometry, se-
lection eﬀects, galaxy biasing and observational noise have been accurately accounted for in this analysis. These
a posteriori power spectra also indicate that individual data-constrained realizations possess the correct physical
power in all regions in Fourier space, and can therefore be considered as physically meaningful density ﬁelds.
This fact has been further demonstrated in section 5.3.1 by showing slices through an arbitrary data-constrained
realization. These results clearly demonstrate the power of our Bayesian methodology to correctly treat the
ill-posed inverse problem of inferring signals from incomplete observations, by augmenting unobserved regions
with statistically and physically meaningful information. In particular, constrained and unconstrained regions
in the samples are visually indistinguishable, demonstrating a major improvement over previous approaches,
typically relying on Gaussian or log-normal statistics, incapable of representing the ﬁlamentary structure of the
cosmic web (see e.g. Jasche & Kitaura, 2010). It should be remarked that this fact not only demonstrates the
ability to access high-order statistics in ﬁnally inferred quantities such as 3D density maps, but also reﬂects the
control of high-order statistics in uncertainty quantiﬁcation far beyond standard normal statistics.
The ensemble of 12, 000 full 3D data-constrained samples permits us to estimate any desired statistical sum-
mary. In particular, in section 5.3.1, we showed ensemble mean density ﬁelds for ﬁnal and initial conditions. A
particularly interesting aspect is the fact that the algorithm manages to infer highly-detailed large scale struc-
tures even in regimes only poorly covered by observations (for further comments see chapter 4 and Jasche &
Wandelt, 2013a). To demonstrate the possibility of uncertainty quantiﬁcation, we also calculated the ensemble
voxel-wise posterior standard deviation, which reﬂects the degree of statistical uncertainty at every volume ele-
ment in the inference domain. As discussed in section 5.3.1, these results clearly reﬂect the signal-dependence of
noise for any inhomogeneous point processes, such as discrete Poissonian galaxy distribution. As expected, high
signal regions correspond to high variance regions. These results further demonstrate the ability to accurately
translate uncertainties in the ﬁnal conditions to initial density ﬁelds, as demonstrated by the plots of voxel-wise
standard deviations for corresponding initial density ﬁelds. However, note that voxel-wise standard deviations
are just an approximation to the full joint and correlated uncertainty that otherwise can by correctly quantiﬁed
by considering the entire set of data-constrained realizations. Besides 3D initial and ﬁnal density ﬁelds, the
methodology also provides information on cosmic dynamics, as mediated by the 2LPT model. In section 5.3.2,
we showed a velocity ﬁeld realization in one sample. In particular, we showed the radial, polar and azimuthal
velocity components in a 4 Mpc/h thick slice around the celestial equator for the observed domain. These
velocities are not primarily constrained by observations, but are derived from the 2LPT model. However, since
2LPT displacement vectors are data-constrained, and since displacement vectors and velocities diﬀer only by
constant factors independent of the inference process, derived velocities are considered to be accurate.
As pointed out frequently, the borg algorithm employs 2LPT as a dynamical model to connect initial
conditions to present observations of SDSS galaxies. As a consequence, the algorithm not only provides 3D
density and velocity ﬁelds but also infers plausible 4D formation histories for the observed LSS. In section
5.3.3, we illustrated this feature with an individual sample. We followed its cosmic evolution from a initial
scale factor of a = 0.02 to the present epoch at a = 1.00. As could be seen, the initial density ﬁeld appears
homogeneous and obeys Gaussian statistics. In the course of structure formation clusters, ﬁlaments and voids
are formed. To demonstrate that this formation history correctly recovers the observed large scale structure, we
plotted the observed galaxies, for the six luminosity bins, on top of the ﬁnal density ﬁeld. These results clearly
demonstrate the ability of our algorithm to infer plausible large scale structure formation histories compatible
with observations. Additionally, since the borg algorithm is a full Bayesian inference framework, it not only
provides a single 4D history, but an ensemble of such data-constrained formation histories and thus accurate
means to quantify corresponding observational uncertainties. In particular, our methodology correctly accounts

92
Chapter 5. Past and present cosmic structure in the Sloan Digital Sky Survey
for the non-local transport of observational information between present observations and corresponding inferred
initial conditions. As discussed in section 5.3.3, the information content in initial and ﬁnal conditions has to be
conserved but can be distributed diﬀerently. High-density regions in the ﬁnal conditions, typically coinciding
with high signal-to-noise regions in the data, form by clustering of matter which was originally distributed over
a larger Eulerian volume in the initial conditions. For this reason, the observational information associated to a
cluster in the ﬁnal density ﬁeld will be distributed over a larger volume in the corresponding initial density ﬁeld.
Conversely, the information content of voids in the ﬁnal conditions will be conﬁned to a smaller volume in the
initial conditions. This fact is also reﬂected by the analysis of voxel-wise standard deviations presented in section
5.3.1. While the signal-to-noise ratio is highly clustered in the ﬁnal conditions, the same amount of observational
information is distributed more homogeneously over the entire volume in corresponding initial conditions. As
discussed in section 5.3.3, particles within the observed domain at the ﬁnal state may originate from regions
outside the corresponding comoving Eulerian volume in the initial conditions and vice versa (also see chapter 4
and Jasche & Wandelt, 2013a). This non-local translation of information along Lagrangian trajectories is also
the reason for the ability of our methodology to extrapolate beyond the survey boundaries of the SDSS and infer
the LSS there within a fully probabilistic and rigorous approach. In particular, the high degree of control on
statistical uncertainties permit us to perform accurate inferences on the nature of initial conditions and formation
histories for the observed LSS in these regions. For these reasons we believe that inferred ﬁnal ensemble mean
ﬁelds and corresponding voxel-wise standard deviations as a means of uncertainty quantiﬁcation, may be of
interest to the scientiﬁc community. These data products have been published as supplementary material along
with the article, and are accessible at http://iopscience.iop.org/1475-7516/2015/01/036.
In summary, this chapter describes an application of the previously proposed borg algorithm to the SDSS
DR7 main galaxy sample.
As demonstrated, our methodology produces a rich variety of scientiﬁc results,
various aspects of which are objects of detailed and quantitative analyses in subsequent chapters of this thesis
and forthcoming publications. Besides pure three dimensional reconstructions of the present density ﬁeld, the
algorithm provides detailed information on corresponding initial conditions, large scale dynamics and formation
histories for the observed LSS. Together with a thorough quantiﬁcation of joint and correlated observational
uncertainties, these results mark the ﬁrst steps towards high precision chrono-cosmography, the subject of
analyzing the four dimensional state of our Universe.

Part III
The non-linear regime of structure
formation


Chapter 6
Remapping Lagrangian perturbation
theory
Contents
6.1
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
95
6.2
Method
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
97
6.2.1
Remapping procedure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
97
6.2.2
Comparison of structure types in LPT and in N-body dynamics
. . . . . . . . . . . . . . .
99
6.2.3
Improvement of the remapping procedure . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
6.2.4
Remapping function and transfer function . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
6.3
Statistics of remapped ﬁelds . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
101
6.3.1
One-point statistics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103
6.3.2
Two-point statistics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
6.3.3
Three-point statistics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
6.4
Discussion and conclusion
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
106
“Everyone thinks of changing the world, but no one thinks of chang-
ing himself.”
— Leo Tolstoy
Quoted in Bryan, Cameron & Allen (1999), The Artist’s Way at
Work: Riding the Dragon
Abstract
On the smallest scales, three-dimensional large-scale structure surveys contain a wealth of cosmological information
which cannot be trivially extracted due to the non-linear dynamical evolution of the density ﬁeld. Lagrangian pertur-
bation theory is widely applied to the generation of mock halo catalogs and data analysis. In this chapter, we propose
a method designed to improve the correspondence between these density ﬁelds, in the mildly non-linear regime. We
develop a computationally fast and ﬂexible tool for a variety of cosmological applications. Our method is based on
a remapping of the approximately-evolved density ﬁeld, using information extracted from N-body simulations. The
remapping procedure consists of replacing the one-point distribution of the density contrast by one which better
accounts for the full gravitational dynamics. As a result, we obtain a physically more pertinent density ﬁeld on a
point-by-point basis, while also improving higher-order statistics predicted by LPT. We quantify the approximation
error in the power spectrum and in the bispectrum as a function of scale and redshift. Our remapping procedures
improves one-, two- and three-point statistics at scales down to 8 Mpc/h.
This chapter is adapted from its corresponding publication, Leclercq et al. (2013).
6.1
Introduction
At present, observations of the three-dimensional LSS are major sources of information on the origin and
evolution of the Universe. According to the current paradigm of cosmological structure formation, the presently
observed structures formed via gravitational clustering of cold dark matter particles and condensation of baryonic
matter in gravitational potential wells. Consequently, the large-scale matter distribution retains a memory of

96
Chapter 6. Remapping Lagrangian perturbation theory
its formation history, enabling us to study the homogeneous as well as the inhomogeneous evolution of our
Universe.
Due to non-linearities involved in the formation process, at present there exists just limited analytic under-
standing of structure formation in terms of perturbative expansions in Eulerian or Lagrangian representations.
Both of these approaches rely on a truncated sequence of momentum moments of the Vlasov-Poisson system,
completed by ﬂuid dynamic assumptions (see chapter 1 or e.g. Bernardeau et al., 2002, and references therein).
For this reason, the validity of these approaches ceases, once the evolution of the LSS enters the multi-stream
regime (see e.g. Pueblas & Scoccimarro, 2009).
Nevertheless, Eulerian and Lagrangian approximations have been successfully applied to the analysis of
three-dimensional density ﬁelds in regimes where they are still applicable, either at large scales or in the early
Universe. Particularly, LPT captures signiﬁcant mode-coupling information that is encoded beyond linear the-
ory, such as large-scale ﬂows and free-streaming, yielding three-dimensional matter distributions approximating
those of full scale numerical simulations with reasonable accuracy (Moutarde et al., 1991; Buchert, Melott &
Weiß, 1994; Bouchet et al., 1995; Scoccimarro, 1998, 2000; Scoccimarro & Sheth, 2002; Yoshisato et al., 2006).
Especially, second-order Lagrangian perturbation theory has been widely applied in data analysis and for fast
generation of galaxy mock catalogs (e.g. PTHalos: Scoccimarro & Sheth, 2002; Manera et al., 2013; Pinoc-
chio: Monaco et al., 2002; Monaco, Theuns & Taﬀoni, 2002; Taﬀoni, Monaco & Theuns, 2002; Heisenberg,
Schäfer & Bartelmann, 2011; Monaco et al., 2013) that can be useful to estimate error bounds when analyzing
observations.
Modern cosmological data analysis has an increasing demand for analytic and computationally inexpensive
models providing accurate representations of the mildly non-linear regime of structure formation. Over the
years, various non-linear approximations and attempts to extend the validity of LPT have been proposed (see
section 1.6). These include the spherical collapse model (Gunn & Gott, 1972; Bernardeau, 1994), the truncated
Zel’dovich approximation (Melott, Pellman & Shandarin, 1994) and models with various forms for the velocity
potential (Coles, Melott & Shandarin, 1993; Munshi & Starobinsky, 1994) or the addition of a viscosity term
in the Euler equation (the adhesion model, Gurbatov, Saichev & Shandarin, 1989). Analytical techniques to
improve the convergence and behavior of standard perturbation theory, successfully employed in quantum ﬁeld
theory and statistical physics, have also been applied in the context of gravitational clustering. These include
renormalized perturbation theory (Crocce & Scoccimarro, 2006), the path integral formalism (Valageas, 2007),
and the renormalization group ﬂow (Matarrese, Verde & Heavens, 1997). More recently, Tassev & Zaldarriaga
(2012a,c) constructed a physical picture of the matter distribution in the mildly non-linear regime, and developed
a method yielding improvements over LPT (Tassev, Zaldarriaga & Eisenstein, 2013), in particular at the scales
relevant for baryon acoustic peak reconstruction (Tassev & Zaldarriaga, 2012b).
In this chapter, we propose a numerically eﬃcient method designed to improve the correspondence between
approximate models and full numerical simulations of gravitational large-scale structure formation. Generally,
it can be applied to any approximate model of gravitational instability, but it is especially targeted to improving
Lagrangian methods. We illustrate both these methods on ﬁelds evolved with LPT: at order one, the Zel’dovich
approximation (Zel’dovich, 1970; Shandarin & Zel’dovich, 1989) and second-order Lagrangian perturbation
theory.
LPT and N-body density ﬁelds are visually similar, which suggests that the properties of LPT could be
improved by one-to-one mapping in voxel space, following a similar line of thoughts as the “Gaussianization”
idea originally proposed by Weinberg (1992) and inspired existing techniques, widely used in cosmology (Melott,
1993; Croft et al., 1998; Narayanan & Weinberg, 1998; Croft et al., 1999; Feng & Fang, 2000; Neyrinck, Szapudi
& Szalay, 2011; Yu et al., 2011, 2012; Neyrinck & Yang, 2013).
The method described in this chapter is
based on a remapping of the approximately evolved particle distribution using information extracted from N-
body simulations. It basically consists of replacing the one-point distribution of the approximately evolved
distribution by one which better accounts for the full gravitational system.
In this fashion, we adjust the
one-point distribution to construct a physically more reasonable representation of the three-dimensional matter
distribution, while retaining or improving higher order statistics, described already reasonably well by the ZA
(Zel’dovich, 1970; Doroshkevich, 1970a; Shandarin & Zel’dovich, 1989; Buchert, 1989; Moutarde et al., 1991;
Yoshisato et al., 2006) and by 2LPT (Moutarde et al., 1991; Buchert, Melott & Weiß, 1994; Bouchet et al.,
1995; Scoccimarro, 1998, 2000; Scoccimarro & Sheth, 2002).
Major problems with naive approaches to remapping LPT density ﬁelds arise from minor deviations in
structure types represented by LPT models and full gravity. For this reason, in chapter 2, we discussed the
diﬀerent representations of clusters, voids, sheets, and ﬁlaments, predicted by LPT and N-body simulations.

6.2. Method
97
Besides being of general interest for LSS data analysis, the insights gained from this comparison will allow us
to improve the remapping procedure.
Implementing and testing the accuracy and the regime of validity of our method is essential, and is subject
of the present chapter. Our study quantiﬁes the approximation error as a function of scale in terms of a set
of statistical diagnostics. From cosmographic measurements, σ8 is known to be of order unity, which means
that gravity becomes highly non-linear at some scale around 8 Mpc/h. Our method is expected to break down
due to shell-crossing in LPT, at some scale larger than 8 Mpc/h. Achieving a resolution of 16 Mpc/h would
already constitute substantial improvement with respect to existing methods, since non-linearities begin to
aﬀect even large-scale cosmographic measurements such as the determination of the baryon acoustic oscillations
scale from galaxy surveys (about 125 Mpc/h, e.g. Eisenstein et al., 2005). However, we explore the validity of
the improvement at 8 Mpc/h down to 4 Mpc/h, to see to what extent we can push the limit for possible data
analysis applications into the non-linear regime. Recall that in three-dimensional LSS surveys, the number of
modes usable for cosmological exploitation scales as the cube of the largest wavenumber, k3, meaning that even
minor improvements in the mildly non-linear regime would give access to much more cosmological information
from existing and upcoming observations.
As will be demonstrated, this method can be used to generate realizations of density ﬁelds much faster than
N-body simulations. Even though approximate, these fast realizations of mock density ﬁelds may be suﬃcient
to model the salient features of the non-linear density ﬁeld for certain applications.
This chapter is structured as follows. In section 6.2, we describe the remapping procedure for the den-
sity contrast of present-day density ﬁelds, analyze the obstacles to straightforward application and present an
improved method. In section 6.3, we apply the procedure to cosmological models using data from numerical
simulations, we study the statistics of remapped ﬁelds and quantify the approximation error. We discuss our
results and give our conclusions in section 6.4.
The setup of LPT and N-body simulations used in this chapter are described at the beginning of chapter 2.
6.2
Method
In this section, we discuss the remapping procedure and apply it to cosmological density ﬁelds evolved with
LPT. Naively following the approach of Weinberg (1992) for present-day density ﬁelds yields the procedure
described in section 6.2.1. This approach is not entirely satisfactory and we analyze the reasons for its short-
comings in section 6.2.2. In consequence, we propose a improvement of the remapping procedure in section
6.2.3. The properties of the remapping function are examined in section 6.2.4.
6.2.1
Remapping procedure
In this section, we describe the remapping algorithm used to go from a low-redshift realization of a density
ﬁeld evolved with LPT to one evolved with full N-body gravitational dynamics. Note that both ﬁelds obey the
same initial conditions but are evolved by diﬀerent physical models.
Density ﬁelds are deﬁned on Cartesian grids of cubic voxels. Linear gravitational evolution exactly main-
tains the relative amplitude of ﬂuctuations in diﬀerent voxels. Due to mode coupling, positive and negative
ﬂuctuations grow at diﬀerent rates in the non-linear regime, but even non-linear evolution tends to preserve the
rank order of the voxels, sorted by density.
The one-point probability distribution functions and the cumulative distribution functions (cdf) of the ﬁnal
density ﬁelds, evolved with either LPT or full N-body gravitational dynamics, exhibit similar, but not identical
shapes. This result suggests a way to improve the approximation with information extracted from the N-body
simulation: maintain the rank order of the voxels, but reassign densities so that the two cdfs match. The method
therefore resembles the “Gaussianization” procedure proposed by Weinberg (1992), an attempt to reconstruct
the initial conditions of a density ﬁeld from its ﬁnal cdf.
Let PLPT and PNbody denote the probability distribution functions for the density contrast in the LPT and in
the full N-body density ﬁelds, respectively. Let CLPT and CNbody be their integrals, the cumulative distribution
functions. CLPT(δLPT) is the fractional rank for δLPT i.e. the probability that the density contrast at a given
voxel is smaller than δLPT, PLPT(δ ≤δLPT), and the analogous for the N-body ﬁeld. The remapping procedure
works as follows. A voxel with rank order δLPT is assigned a new density δNbody such that
CLPT(δLPT) = CNbody(δNbody)
(6.1)

98
Chapter 6. Remapping Lagrangian perturbation theory
 0.0
 0.2
 0.4
 0.6
 0.8
 1.0
 1.2
 1.4
−1
 0
 1
 2
 3
 4
 5
ε
δZA
PZA(δZA)
CZA(δZA)
−1
 0
 1
 2
 3
 4
 5
δNbody
smoothing
PNbody(δNbody)
PNbody,S(ZA)(δNbody)
CNbody,S(ZA)(δNbody)
 0.0
 0.2
 0.4
 0.6
 0.8
 1.0
 1.2
 1.4
−1
 0
 1
 2
 3
 4
 5
ε
δ2LPT
P2LPT(δ2LPT)
C2LPT(δ2LPT)
−1
 0
 1
 2
 3
 4
 5
δNbody
smoothing
PNbody(δNbody)
PNbody,S(2LPT)(δNbody)
CNbody,S(2LPT)(δNbody)
Figure 6.1: A graphical illustration of the improved remapping procedure at redshift zero, for the ZA (upper panel)
and 2LPT (lower panel). On the right panels, the dotted purple curves are the probability distribution function for the
density contrast in full N-body dynamics. The ﬁrst step of the procedure is to smooth the N-body density ﬁeld using
the transfer function given by equation (6.2), which yields slightly diﬀerent pdfs (dashed dark red and dark blue curves
on the right panels). On the left panels, the dashed curves are the pdfs for the density contrast in the ﬁnal density ﬁeld,
evolved from the same initial conditions with LPT (ZA: red line and 2LPT: blue line). The pdfs are computed on a
8 Mpc/h mesh (1283-voxel grid) using the full statistics from eight realizations of 5123-particles in a 1024 Mpc/h box with
periodic boundary conditions. The solid curves are their respective integrals, the cumulative distribution functions. The
second step is remapping, which assigns a voxel with density contrast δLPT and fractional rank ε the value of δNbody that
would have the same fractional rank in the smoothed N-body distribution (equation (6.3)). This remapping is illustrated
for 2LPT with three sample points: δ2LPT = −0.60 maps to δNbody = −0.56, δ2LPT = 0.00 maps to δNbody = −0.01, and
δ2LPT = 3.50 maps to δNbody = 3.56. The remapping procedure imposes the one-point distribution of the smoothed N-
body ﬁeld while maintaining the rank order of the LPT-evolved density ﬁelds. The last step is an increase of small-scale
power in the remapped distribution using the reciprocal transfer function, equation (6.4).

6.2. Method
99
0
5
10
15
20
25
30
35
40
|γi|
1.0
1.1
1.2
1.3
1.4
1.5
1.6
1.7
1.8
P(k →0)/PNbody(k →0)
ZA voids
2LPT voids
ZA sheets
2LPT sheets
ZA ﬁlaments
2LPT ﬁlaments
ZA clusters
2LPT clusters
Figure 6.2: The large-scale bias in the power spectrum of density ﬁelds, remapped with the procedure described in
section 6.2.1, as a function of the mismatch between structure types. The estimators γi are deﬁned by equation (2.22).
Eight realizations of the ZA (circles) and 2LPT (triangles) are compared to the corresponding N-body realization, for
various resolutions (from bottom to top: 16 Mpc/h, 8 Mpc/h, 4 Mpc/h). The large-scale bias in the power spectra of
remapped ﬁelds is strongly correlated to the volume fraction of structures incorrectly predicted by LPT.
(also see ﬁgure 6.1 for a schematic outline of this method). The left panels of ﬁgure 6.1 show PLPT (dashed
curves) and the corresponding cumulative distributions, CLPT (solid curves). On the right panels, the dotted
curves represent the pdf of the corresponding N-body realization, PNbody. Remapping assigns to a voxel with
density contrast δLPT and fractional rank ε
=
CLPT(δLPT) the value of δNbody that would have the same
fractional rank in the N-body distribution.
Since CNbody contains exactly the same information as PNbody, the remapping procedure imposes the one-
point distribution taken from the N-body-evolved density ﬁeld while maintaining the rank order of the LPT-
evolved density ﬁeld. In other words, only the weight of underdensities and overdensities is modiﬁed, while their
locations remain unchanged. In this fashion, we seek to adjust the density ﬁeld while maintaining higher-order
statistics provided by LPT with reasonable accuracy. We checked numerically that mass is always conserved in
this procedure.
6.2.2
Comparison of structure types in LPT and in N-body dynamics
We implemented the remapping procedure described in the previous section and checked that we are able to
modify LPT density ﬁelds so as to correctly reproduce the one-point distribution of a full N-body simulation.
However, we experience a large-scale bias in the power spectrum, namely the amplitude of the spectrum of
the remapped ﬁelds is slightly too high. Generally, a non-linear transformation in voxel space can change the
variance of a ﬁeld. This is consistent with the ﬁndings of Weinberg (1992), who found a similar eﬀect in his
reconstructions of the initial conditions, and who addressed the issue by rescaling the density ﬁeld in Fourier
space. However, such an approach will generally destroy the remapped one-point distribution, and may even
further lead to Gibbs ringing eﬀects which will make the remapped ﬁeld unphysical.
The bias indicates a stronger clustering in the remapped density ﬁeld. Since remapping is a local operation in
voxel space, this large-scale bias means that erroneous remapping of small-scale structures aﬀects the clustering
at larger scales. To identify the cause of this bias, we performed a study of diﬀerences in structure types (voids,
sheets, ﬁlaments, and clusters) in density ﬁelds predicted by LPT and N-body simulations. With this analysis,
we wanted to understand the eﬀect of remapping in diﬀerent density and dynamical regimes of the LSS. The
results are presented in section 2.3. We identiﬁed, in particular, a mismatch between the volume occupied by
diﬀerent structure types in LPT and N-body dynamics, quantiﬁed by the parameters γi deﬁned by equation

100
Chapter 6. Remapping Lagrangian perturbation theory
(2.22).
In ﬁgure 6.2, we plot the large-scale bias observed in remapped ﬁelds obtained with the procedure of section
6.2.1 as a function of γi, for various resolutions. A strong correlation is observed between the bias and the
mismatch in the volume occupied by diﬀerent structure types. The diﬀerence in the prediction of the volume
of extended objects is the cause of the bias: in clusters and in voids, remapping enhances a larger volume than
should be enhanced, which yields on average a stronger clustering in the box.
6.2.3
Improvement of the remapping procedure
In the previous section, we noted that because too much volume of LPT density ﬁelds is mapped to the tails
of the N-body one-point distribution (dense clusters and deep voids), the average two-point correlations are
larger after remapping. Given this result, minor modiﬁcations of the procedure described in section 6.2.1 can
solve the problem. We now propose to improve the remapping procedure of Weinberg (1992) for present-day
density ﬁelds, in a similar fashion as in Narayanan & Weinberg (1998), combining it with transfer function
techniques to deal with the mildly non-linear modes as in Tassev & Zaldarriaga (2012a,c). Our method works
as follows.
1. We degrade the N-body density ﬁeld to the same degree of smoothness as the LPT density ﬁeld, by
multiplying the Fourier modes of the density ﬁeld by the transfer function
T(k) ≡
s
PLPT(k)
PNbody(k).
(6.2)
This steps yields a new density ﬁeld, noted Nbody,S(LPT), whose power spectrum matches that of the
LPT density ﬁeld.
2. We remap the LPT density ﬁeld in the fashion described in section 6.2.1, but using as a reference the cdf
of the smoothed density ﬁeld, CNbody,S(LPT), instead of the full N-body density ﬁeld (see ﬁgure 6.1). The
remapping condition, equation (6.1), now reads
CLPT(δLPT) = CNbody,S(LPT)(δNbody).
(6.3)
3. We increase the power of small scales modes in the remapped distribution to the same value as in a full
N-body simulation, using the reciprocal of the transfer function (6.2), namely
T −1(k) =
s
PNbody(k)
PLPT(k) .
(6.4)
This procedure cures the large-scale bias issue experienced with the simple implementation of the remapping
described in section 6.2.1, without requiring any prior knowledge on the corresponding N-body simulation. As
we will demonstrate in section 6.3, it yields improvement of one-, two- and three-point statistics of LPT.
6.2.4
Remapping function and transfer function
Since CLPT and CNbody,S(LPT) are monotonically increasing functions, there is no ambiguity in the choice of
δNbody, and this procedure deﬁnes a remapping function f such that
δLPT 7→δNbody = C −1
Nbody,S(LPT)(CLPT(δLPT)) ≡f(δLPT).
(6.5)
Establishing a remapping function f requires knowledge of both LPT and N-body density ﬁeld statistics.
Ideally, several realizations with diﬀerent initial conditions should be combined in order to compute a precise
remapping function. Indeed, a limited amount of available N-body simulations results in a lack of statistics and
hence uncertainties for the remapping procedure in the high density regime. However, this eﬀect is irrelevant
from a practical point of view, since these high density events are very unlikely and aﬀect only a negligible
number of voxels. As a consequence this uncertainty will only aﬀect to sub-percent level the usual statistical
summaries of the density ﬁeld. Note that in any case, if desired, the accuracy of the remapping function in the
high density regime can be trivially enhanced by enlarging the size or number of N-body simulations used for

6.3. Statistics of remapped ﬁelds
101
its construction. For the analysis presented in this chapter, the remapping functions have been computed using
the full statistics from eight realizations of 5123 particles in a 1024 Mpc/h box.
Note that once the relationship between the statistical behavior of the LPT ﬁelds and the full non-linear
ﬁeld is known, this procedure can be used on LPT realizations without the need of evolving corresponding
N-body simulations. More speciﬁcally, the remapping function f (equation (6.5)) and the transfer function T
(equation (6.2)) can be tabulated and stored, then used for the fast construction of a large number of large-
scale structure density ﬁelds. Since producing LPT realizations is computationally faster than running full
gravitational simulations by a factor of several hundreds, our method can be used to produce a large set of
N-body-like realizations in a short time.
Some remapping functions are presented in ﬁgure 6.3. In each panel, the solid curves represent the remapping
function fz at redshift z, computed with the LPT and N-body simulations. The dashed black line shows the
identity function. We checked that the remapping function converges to the identity function with increasing
redshift, as expected. Critical values where the remapping function crosses the identity function are identiﬁed.
Between these critical values, remapping either increases or decreases the local density.
The pdfs for the density contrast are evaluated on a grid after a CiC assignment of particles. This means
that the remapping function a priori depends on the size of voxels. The problem of choosing a voxel size for
the computation of the remapping function is linked to the more general problem of choosing a mesh for the
CiC evaluation of density. Choosing too coarse a binning will result in an underestimation of the clustering of
particles, whereas choosing too ﬁne a binning will also result in artifacts in overdensities (some voxels may be
empty due to their too small size). The right choice of voxel size for the evaluation of the remapping function is
the one giving the best evaluation of the density contrast. This choice has to be made depending on the desired
application of the remapped data.
The remapping function describes how the pdf for the density contrast is aﬀected by non-linear structure
formation. For this reason, it depends on the nature of the gravitational interaction, as described by LPT and
by full N-body dynamics, but weakly depends on the detail of the cosmological parameters. We checked the
cosmology-dependence of the remapping function in simulations with the dark matter and baryon density in
the Universe, Ωm and Ωb, varying the WMAP-7 ﬁducial values (equation (2.1)) by ± 3σ (still assuming a ﬂat
Universe):
ΩΛ = 0.750, Ωm = 0.2494, Ωb = 0.0428, σ8 = 0.810, h = 0.704, ns = 0.967;
(6.6)
ΩΛ = 0.700, Ωm = 0.2992, Ωb = 0.0488, σ8 = 0.810, h = 0.704, ns = 0.967.
(6.7)
Even for these models notably far from the ﬁducial values, we found that the remapping function almost
perfectly overlaps that of our main analysis, for the density range δ ∈[−1; 5], containing typically 98 to 99% of
the voxels. We found a diﬀerence of less than 5% for δ = 5 (see the left panel of ﬁgure 6.4).
The transfer function used in steps 1 and 3 of the improved procedure also exhibits very weak redshift-
dependence, with deviations limited to a few percents at the smallest scales of interest of this work (k ≈0.4
(Mpc/h)−1, see the right panel of ﬁgure 6.4).
6.3
Statistics of remapped ﬁelds
In this section, we discuss the validity of the improved remapping procedure described in section 6.2.3,
by studying the correlators of the remapped ﬁeld in comparison to the input LPT and N-body ﬁelds. The
remapping procedure based on the Eulerian density contrast essentially replaces the LPT one-point function
by that of the smoothed N-body-evolved ﬁeld. Since the position and shape of structures is left unchanged,
we expect the higher-order correlators of the density ﬁeld to be respected by the remapping procedure. Of
particular interest is to check how remapping aﬀects higher-order statistics and if possible improvements could
be exploited in data analysis or artiﬁcial galaxy survey applications.
We implemented a numerical algorithm that computes and analyzes a remapped density ﬁeld. The procedure
can be divided in three steps:
1. We take as input two cosmological density ﬁelds, evolved from the same initial conditions with LPT (ZA
or 2LPT) and with full N-body dynamics, and estimate the one-point statistics (pdf and cdf for δ) and
the transfer function for this particular realization. We repeat this step for the eight realizations used in
our analysis.

102
Chapter 6. Remapping Lagrangian perturbation theory
 0
 10
 20
 30
 40
 50
 0
 5
 10
 15
 20
δNbody
δZA
f0(δZA)
Id
 0
 10
 20
 30
 40
 50
 0
 5
 10
 15
 20
δNbody
δ2LPT
f0(δ2LPT)
Id
−1
 0
 1
 2
 3
 4
 5
 6
−1
 0
 1
 2
 3
 4
 5
δNbody
δZA
f1(δZA)
f0.5(δZA)
f0(δZA)
Id
−1
 0
 1
 2
 3
 4
 5
 6
−1
 0
 1
 2
 3
 4
 5
δNbody
δ2LPT
f1(δ2LPT)
f0.5(δ2LPT)
f0(δ2LPT)
Id
Figure 6.3: The remapping functions from LPT to smoothed N-body density ﬁelds, for the ZA (left panel) and 2LPT
(right panel), all computed on a 8 Mpc/h mesh. The precise redshift-zero remapping functions f0 (red and blue solid
curves) have been computed using the full statistics from eight realizations (darker red and blue solid curves). The error
bars shown are the 1-σ dispersion among the eight runs with reference to the full remapping function. The lower plots
show the detail of the shaded area, in a density range containing most of the voxels. The redshift-dependence of the
remapping function fz is shown for z = 1, z = 0.5 and z = 0. The dashed line shows the identity function. Critical
values of δLPT for which remapping does not change the local density are identiﬁed.

6.3. Statistics of remapped ﬁelds
103
−0.1
−0.05
 0
 0.05
 0.1
−1
 0
 1
 2
 3
 4
 5
f(δ)/fWMAP7(δ) − 1
δLPT
Remapping function
ZA, Ωm/b − 3σ
ZA, Ωm/b + 3σ
2LPT, Ωm/b − 3σ
2LPT, Ωm/b + 3σ
−0.04
−0.02
 0
 0.02
 0.04
−2
−1
T(k)/TWMAP7(k) − 1
log k [(Mpc/h)−1]
Transfer function
ZA, Ωm/b − 3σ
ZA, Ωm/b + 3σ
2LPT, Ωm/b − 3σ
2LPT, Ωm/b + 3σ
Figure 6.4: Relative deviations of the remapping function (left panel) and of the transfer function (right panel) for
varying cosmological parameters (equations (6.6) and (6.7)), with respect to their behaviour in a ﬁducial cosmology
(equation (2.1)).
2. We take as input all the one-point statistics computed with individual realizations, and we compute a
precise remapping function using the full statistics of all available realizations, as described in section 6.2.1.
The transfer function used as a reference is the mean of all available realizations. At this point, the
remapping function and the transfer function can be tabulated and stored for later use, and N-body
simulations are no longer required.
3. For each realization, we remap the density ﬁeld using the improved three-step procedure described in
section 6.2.3 and we analyze its correlation functions.
Our algorithm provides the one-point (section 6.3.1) and two-point (section 6.3.2) statistics. We used the
code described in Gil-Marín et al. (2011, 2012) to study the three-point statistics (section 6.3.3). The results
are presented below.
6.3.1
One-point statistics
The remapping procedure, described in section 6.2, is essentially a replacement of the cumulative distribution
function of the density contrast δ of the input LPT-evolved ﬁeld, CLPT, by that of the reference N-body-evolved
ﬁeld after smoothing, CNbody,S(LPT). After having applied the remapping procedure, we recomputed the pdf of
the remapped ﬁeld and veriﬁed that it matches that of the ﬁducial ﬁeld as a sanity check.
Remapping and rescaling the density modes alters local density values but positions of structures remain
unchanged.
It is therefore important to check that remapping visually alters the LPT-evolved distribution
in such a way that structures resemble more their N-body evolved counterparts. Figure 6.5 shows a slice of
the density contrast δ, measured at redshift zero, on a 1282-pixel sheet of a 5123-particles realization in a
1024 Mpc/h box. The corresponding mesh size is 8 Mpc/h. Visually, remapped ﬁelds (ZARM and 2LPTRM)
are closer to the full N-body result than their originals (ZA and 2LPT), with plausible particle distribution.
Since the improved remapping procedure involves a rescaling of the density modes in Fourier space (step
3), the pdf for the density contrast of the remapped ﬁelds is not guaranteed to be correct by construction,
as would be the case with a naive remapping (section 6.2.1).
Therefore, the one-point distribution has to
be carefully checked at this point. In ﬁgure 2.1, we plot the pdf for the density contrast at redshift zero for
N-body simulations and the approximately evolved ﬁelds: with the ZA and 2LPT alone, and after remapping
(ZARM and 2LPTRM). It can be observed that the peaks of the pdfs get closer to the reference set by N-body
dynamics and that the pdf of remapped ﬁelds accurately follows that of full gravitational dynamics for δ > 0.
The procedure being successful on average for one-point statistics and accurate for the most common events in
overdensities, we expect the number count of objects such as clusters predicted by LPT to be made more robust
by our procedure.

104
Chapter 6. Remapping Lagrangian perturbation theory
0
50
100
150
200
250
300
350
400
x [Mpc/h]
0
50
100
150
200
250
300
350
400
y [Mpc/h]
ICs
0
50
100
150
200
250
300
350
400
x [Mpc/h]
0
50
100
150
200
250
300
350
400
y [Mpc/h]
Nbody
0.0
0.3
0.6
0.9
1.2
1.5
1.8
2.1
2.4
2.7
3.0
ln(2 + δ)
0
50
100
150
200
250
300
350
400
x [Mpc/h]
0
50
100
150
200
250
300
350
400
y [Mpc/h]
ZA
0
50
100
150
200
250
300
350
400
x [Mpc/h]
0
50
100
150
200
250
300
350
400
y [Mpc/h]
ZARM
0.0
0.3
0.6
0.9
1.2
1.5
1.8
2.1
2.4
2.7
3.0
ln(2 + δ)
0
50
100
150
200
250
300
350
400
x [Mpc/h]
0
50
100
150
200
250
300
350
400
y [Mpc/h]
2LPT
0
50
100
150
200
250
300
350
400
x [Mpc/h]
0
50
100
150
200
250
300
350
400
y [Mpc/h]
2LPTRM
0.0
0.3
0.6
0.9
1.2
1.5
1.8
2.1
2.4
2.7
3.0
ln(2 + δ)
Figure 6.5: Redshift-zero density contrast on a 1282-pixel slice of a 5123-particles realization in a 1024 Mpc/h box with
periodic boundary conditions. For clarity, the slice is limited to a square of 400 Mpc/h side, and the quantity shown is
the log-density ﬁeld, ln(2 + δ). For comparison with the initial conditions, the density ﬁeld at high redshift (z = 5) is
shown in the top left corner. The redshift-zero density ﬁelds are determined using, from top to bottom and from left
to right: a full N-body simulation, the Zel’dovich approximation, alone (ZA) and after remapping (ZARM), second-
order Lagrangian perturbation theory, alone (2LPT) and after remapping (2LPTRM). The remapping and the transfer
function operations are performed on a 1283-voxel grid, corresponding to a mesh size of 8 Mpc/h.

6.3. Statistics of remapped ﬁelds
105
6.3.2
Two-point statistics
6.3.2.1
Power spectrum
In ﬁgure 2.2, we plot the redshift-zero power spectrum of the diﬀerent density ﬁelds.1 The relative deviations
of power spectra with reference to the density ﬁeld computed with a full N-body simulation are presented in
ﬁgures 2.3 and 2.4.
At high redshift (z > 1), we found no notable diﬀerence between the power spectrum of matter evolved with
full N-body dynamics and that of LPT-remapped distributions. This indicates that our remapping procedure
is increasingly successful as we go backwards in time towards the initial conditions, where LPT gives accurate
results.
At low redshift, the power spectrum shape of remapped LPT ﬁelds is closer to the shape of the full non-linear
power spectrum, turning down at smaller scales than the LPT power spectra. In particular, LPT ﬁelds exhibit
more small-scale correlations after remapping, illustrating the success of our procedure in the mildly non-linear
regime of large-scale structure formation.
Contrary to the density ﬁelds obtained via a naive remapping approach, whose power spectra exhibit a
positive artiﬁcial oﬀset at large scales as discussed in section 6.2.2, the ﬁelds obtained with the improved
procedure have correct two-point statistics at all scales for coarse grids (down to 8 Mpc/h). For ﬁner grids, a
negative large-scale bias appears in the power spectrum, meaning that we have suppressed too much small-scale
power in the N-body ﬁeld in the ﬁrst step of our procedure, which propagates to large scales with remapping.
Comparing the panels of ﬁgures 2.3 and 2.4, it can be observed that this eﬀect is suppressed at higher redshift
and for coarser binning. We found that a voxel size of 8 Mpc/h is the best compromise, with a large-scale power
spectrum compatible with the error bars and clear improvement at small scales, as can be seen in ﬁgure 2.2.
This mesh size corresponds to the target resolution for analyses in the mildly non-linear regime, as discussed in
the introduction of this chapter.
6.3.2.2
Fourier-space cross-correlation coeﬃcient
In ﬁgure 2.5, we present the Fourier-space cross-correlation coeﬃcient R ≡Pδ×δ′/√PδPδ′ between the
redshift-zero density ﬁeld in the N-body simulation and several other density ﬁelds. At redshift zero and at
small scales, the agreement is better with remapped LPT ﬁelds than with LPT alone, conﬁrming the success
of the remapping procedure to explore the mildly non-linear regime. In particular, the remapping of 2LPT
predicts more than 96% level accuracy at k = 0.4 (Mpc/h)−1 (corresponding to scales of 16 Mpc/h), where
2LPT gives only 93%. The cross-correlation coeﬃcient indicates better agreements for the remapping of 2LPT
than for the remapping of the ZA, which is consistent with the better performance of 2LPT in predicting the
phases of the full N-body ﬁeld (see section 2.1.2.2).
6.3.3
Three-point statistics
We analyzed the accuracy of our method beyond second-order statistics by studying the bispectrum, using
the code described in Gil-Marín et al. (2011, 2012).2 Figure 2.6 shows the redshift-zero bispectrum for equilateral
triangles. The overall result is a clear improvement of the bispectrum of LPT-evolved ﬁelds with the remapping
procedure, especially on the small scales shown, probing the mildly non-linear regime, k ≳0.1 (Mpc/h)−1
corresponding to scales ≲62 Mpc/h, where LPT predicts less three-point correlation than full gravity. At large
scales, the approximation error remains ≲1σ of the estimated statistical uncertainty, even for a resolution of
8 Mpc/h and at late times (z = 0).
The relative deviations of approximate bispectra with reference to full N-body simulations are shown in
ﬁgures 2.7, 2.8, 2.9 and 2.10. As expected, the success of our remapping procedure in exploring small scales
(k ≳0.1 (Mpc/h)−1) is increased for more coarsely-binned density ﬁelds (see ﬁgure 2.7) and at higher redshift
(see ﬁgure 2.8). In ﬁgure 2.9 we examine the scale-dependence of the bispectrum for various triangle shapes.
The precise dependence on the triangle shape at diﬀerent scales is shown in ﬁgure 2.10.
1 The reader is referred to section 2.1.2.1 for practical details on the computation of these power spectra.
2 Technical considerations concerning the computation of bispectra are presented in section 2.1.3.

106
Chapter 6. Remapping Lagrangian perturbation theory
6.4
Discussion and conclusion
The main subject of this chapter is the development of a method designed to improve the correspondence
between approximate models for gravitational dynamics and full numerical simulation of large-scale structure
formation. Our methodology relies on a remapping of the one-point distribution of the density contrast of the
approximately evolved particle distribution using information extracted from N-body simulations.
Due to the diﬀerences in the precise structure of the density ﬁelds in Lagrangian perturbation theory and in
full gravity, the naive implementation of this procedure, inspired by Weinberg (1992), gives a large-scale bias
in the power spectrum. This is not solved by a simple rescaling of Fourier modes, which leads to Gibbs ringing
artifacts and an overall unphysical representation of the density ﬁelds. Smoothing LPT and N-body density
ﬁelds with the same kernel is also unsuccessful, as smoothed N-body ﬁelds will always keep a sharper structure
than smoothed LPT ﬁelds.
We ﬁgured out that the cause of this large-scale bias is not the diﬀerent density predicted locally by LPT
and N-body dynamics on a point-by-point basis, but a problem of mismatch between the volume of extended
objects. Our ﬁndings question the reliability of LPT for LSS data analysis and generation of mock catalogs at
low redshift and high mass resolution. They are also a likely explanation for the discrepancy between the power
spectrum of initial conditions reconstructed via Gaussianization and linear theory expectations, encountered by
Weinberg (1992).
Considering these results, we improved Weinberg’s remapping procedure for present-day density ﬁelds by
the use of a transfer function. In this fashion, we obtain a physically more accurate representation of the three-
dimensional matter distribution in the mildly non-linear regime, while improving higher-order statistics. Since
LPT captures well the cosmological dependence and remapping operates on small-scale aspects of the density
ﬁeld, we found that our procedure that is nearly independent of cosmological parameters.
The aim of this method is to develop a fast, ﬂexible and eﬃcient way to generate realizations of LSS density
ﬁelds, accurately representing the mildly non-linear regime. Our procedure, therefore, responds to the increasing
demand for numerically inexpensive models of three-dimensional LSS, for applications to modern cosmological
data analysis. At the level of statistical error in our numerical experiments, the approach provides a good method
for producing mock halo catalogs and low-redshift initial conditions for simulations, if desired. The resulting
information can also be used in a variety of cosmological analyses of present and upcoming observations.
We showed that our approach allows fast generation of cosmological density ﬁelds that correlate with N-body
simulations at better than 96% down to scales of k ≈0.4 (Mpc/h)−1 at redshift zero and are substantially
better than standard LPT results at higher redshifts on the same comoving scales. Remapping improves the fast
LPT bispectrum predictions on small scales while the large scale bispectrum remains accurate to within about
1σ of the measurement in our N-body simulations. Since real observations will have larger statistical errors
for the foreseeable future, our method provides an adequate fast model of the non-linear density ﬁeld on scales
down to ∼8 Mpc/h. These results constitute a substantial improvement with respect to existing techniques,
since non-linearities begin to aﬀect even large-scale measurements in galaxy surveys. Since the number of modes
usable for cosmological exploitation scale as k3, even minor improvements in the smallest scale k allow access to
much more knowledge from existing and upcoming observations. This work is a step further in the non-linear
regime, which contains a wealth of yet unexploited cosmological information. For possible applications, we
provided a cosmographic and statistical characterization of approximation errors.
Our remapping procedure predicts the two-point correlation function at around 95% level accuracy and three-
point correlation function at around 80% level accuracy at redshift 3, for k between 0.1 and 0.4 (Mpc/h)−1,
illustrating the increasing success of our methods as we go backwards in time towards the initial conditions,
when LPT is an accurate description of early structure formation. This is of particular interest in several areas
of high-redshift cosmology, such as forecasting 21 cm surveys (Lidz et al., 2007), analyzing the properties of the
intergalactic medium via the Lyman-α forest (Kitaura, Gallerani & Ferrara, 2012) or probing the reionization
epoch (Mesinger & Furlanetto, 2007). This work might also add to methods of data analysis for the ongoing
and upcoming high-redshift galaxy surveys mentioned in the introduction.
However, the realization of density ﬁelds with these procedures stays approximate, since the full non-linear
gravitational physics involves information contained in the shape of structures, which cannot be captured from
a one-point modiﬁcation of LPT, especially after shell-crossing.
We studied the performance of one-point
remapping of LPT and presented a statistical characterization of the errors, but additional reﬁnements, such as
a non-linear, density-dependent smoothing of the N-body ﬁeld, could further improve on these approximations,
for an increased computational cost. This is, however, beyond the scope and intent of this work. Generally,

6.4. Discussion and conclusion
107
the complications at large scales that we encounter when applying a local remapping seem diﬃcult to solve in
a Eulerian density ﬁeld approach and would favor a Lagrangian, particle-based perspective.
As mentioned in section 6.1, fast and accurate methods to model the non-linearly evolved mass distribution
in the Universe have the potential of profound inﬂuence on modern cosmological data analysis. Full Bayesian
large-scale structure inference methods such as the borg algorithm, which extract information on the matter
distribution in the Universe from galaxy redshift surveys, rely on LPT (see chapter 4). The technique proposed
in this chapter can be envisioned as a numerically eﬃcient and ﬂexible extension of these methods, permitting
us to push dynamic analyses of the large scale structure further into the non-linear regime.


Chapter 7
Non-linear ﬁltering of large-scale structure
samples
Contents
7.1
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
109
7.1.1
Motivation for non-linear ﬁltering of large-scale structure samples . . . . . . . . . . . . . . . 109
7.1.2
Filtering in the ﬁnal conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110
7.1.3
Filtering via constrained simulations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110
7.2
Fully non-linear ﬁltering with Gadget . . . . . . . . . . . . . . . . . . . . . . . . . . . .
110
7.3
Fast non-linear ﬁltering with COLA . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
112
7.3.1
The COLA method
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112
7.3.2
Non-linear BORG-COLA realizations
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113
“While o’er him fast, through sail and shroud,
The wreathing ﬁres made way.
They wrapt the ship in splendour wild,
They caught the ﬂag on high,
And streamed above the gallant child,
Like banners in the sky.”
— Felicia Hemans (1826), Casabianca
Abstract
Due to the approximate 2LPT model implemented in the borg algorithm, inferred large-scale structure samples are
only correct in the linear and mildly non-linear regime of structure formation. This chapter describes subsequent
improvement of such samples at non-linear scales, via an operation that we refer to as “non-linear ﬁltering”. This
process does not replace fully non-linear large-scale structure inference, but rather ﬁlls small scales with physically
reasonable information. Several approaches to non-linear ﬁltering are considered and discussed.
This chapter discusses the generation of non-linear, constrained realizations of the late-time large-scale
structure via an operation that we call “ﬁltering” of borg samples.
It is structured as follows.
We give
motivation for non-linear ﬁltering and describe two diﬀerent approaches (direct improvement of ﬁnal conditions,
and constrained simulations) in section 7.1. For later use in chapter 8, we describe a set of samples optimally
ﬁltered with Gadget in section 7.2. In section 7.3, we describe the eﬃcient cola scheme for fast production
of non-linear large-scale structure realizations, and apply it to generate a large ensemble of samples, used in
chapter 9.
7.1
Introduction
7.1.1
Motivation for non-linear ﬁltering of large-scale structure samples
As noted in section 4.2.1.2, the likelihood for Bayesian large-scale structure inference involves a structure
formation model to translate from the initial to the ﬁnal density ﬁeld:
δi 7→δf = G(δi, a).
(7.1)

110
Chapter 7. Non-linear ﬁltering of large-scale structure samples
Ideally, this step should involve a numerical model that fully accounts for the non-linearities of the Vlasov-
Poisson system, which describes structure formation (see chapter 1). Unfortunately, this is not currently com-
putationally tractable. For this reason, borg uses 2LPT as a proxy for gravitational dynamics.1
Nevertheless, the description of particular patterns of the cosmic web (as presented in part IV of this thesis)
requires description of the LSS not only correct at the scales correctly described by 2LPT (k ≲0.1 Mpc/h, see
chapter 2), but also physically reasonable at smaller scales, up to k ∼1 Mpc/h. At this point, it is also useful
to recall that the number of Fourier modes usable for cosmology scales as the cube of the smallest accessible
mode, k3.
For these reasons, data-constrained, non-linear realizations of the LSS have a large variety of applications. As
noted before, constraining small, non-linear scales within the inference framework is not yet possible; therefore,
such realizations will rely on fusing data-constrained large scales and unconstrained small scales that only
reﬂect our theoretical understanding of structure formation. Throughout this thesis, we refer to the production
of data-constrained, non-linear realizations, on the basis of borg large-scale structure samples, as non-linear
ﬁltering.
7.1.2
Filtering in the ﬁnal conditions
One possible way to perform non-linear ﬁltering is to directly improve the ﬁnal conditions produced as
borg outputs. The technique of remapping Lagrangian perturbation theory can be useful in this context: as
demonstrated in chapter 6, it cheaply yields improvements of density ﬁelds in the mildly non-linear regime. A
particular advantage of remapping is its very low computational cost, which allows to process a large number
of samples.2 As seen in chapters 4 and 5, this is crucial for adequate uncertainty quantiﬁcation.
7.1.3
Filtering via constrained simulations
Another idea is to capitalize on the inference of the initial conditions by borg.
Starting from inferred
density ﬁelds, which contain the data constraints (see in particular section 5.3.3 for a discussion of information
transport), it is possible to go forward in time using an alternative structure formation model, noted Gnl, that
improves upon G for the description of small scales structures:
δi 7→δf
nl = Gnl(δi, a).
(7.2)
This process is known in the literature as running constrained simulations. Final density ﬁelds δf
nl constructed
in this way agree with corresponding borg ﬁnal conditions δf at large scales, but are also physically reasonable
at smaller scales, up to the validity limit of Gnl.
In this picture, interesting questions are the determination of the smallest scale inﬂuenced by the data
and the characterization of the reliability of structures extrapolated in unobserved regions, at high redshift or
near survey boundaries. An upcoming publication will investigate the validity of constrained simulations, in
particular the strength of data constraints in domains or at scales that have not been considered in the inference
scheme.
In the following, we examine two particular cases for Gnl, corresponding to the Gadget-2 cosmological code
(section 7.2) and to the fast cola scheme (section 7.3).
7.2
Fully non-linear ﬁltering with Gadget
This section draws from section II.B. in Leclercq et al. (2015).
Optimal non-linear ﬁltering of borg results is achieved when Gnl fully accounts for non-linear gravitational
dynamics. This is the case when a cosmological simulation code is used. For the purpose of this thesis, we
consider that non-linear ﬁltering of borg results with the Gadget-2 cosmological code (Springel, Yoshida &
White, 2001; Springel, 2005) is optimal.
For a variety of later uses, in particular for inference of dark matter voids in the Sloan volume (chapter 8),
we generate a set of such optimally ﬁltered, data-constrained realizations of the present large-scale structure.
1 For the record, a borg run, using 2LPT, takes of the order of a year (wall-clock time).
2 The computational cost for remapping all the outputs of a borg run, about 10, 000 samples, would be comparable to a few
full-gravity dark matter simulations using Gadget-2.

7.2. Fully non-linear ﬁltering with Gadget
111
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
initial conditions
-0.012
-0.006
0.0
0.006
0.012
δ
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
ﬁnal conditions (2LPT)
0.0
0.4
0.8
1.2
1.6
2.0
2.4
2.8
3.2
3.6
ln(2 + δ)
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
ﬁnal conditions (non-linear)
0.0
0.8
1.6
2.4
3.2
4.0
4.8
5.6
ln(2 + δ)
Figure 7.1: Non-linear ﬁltering of borg results. Slices through one sample of initial (left panel) and ﬁnal density ﬁelds
(middle panel) inferred by borg. The ﬁnal density ﬁeld (middle panel) is a prediction of the 2LPT model used by
borg. On the right panel, a slice through the data-constrained realization obtained with the same sample via non-linear
ﬁltering (fully non-linear gravitational structure formation starting from the same initial conditions) is shown.
To do so, we rely on a subset of statistically independent initial conditions realizations, provided by Jasche,
Leclercq & Wandelt (2015) (see chapter 5). The initial density ﬁeld, deﬁned on a cubic equidistant grid with
side length of 750 Mpc/h and 2563 voxels, is populated by 5123 dark matter particles placed on a regular
Lagrangian grid. The particles are evolved with 2LPT to the redshift of z = 69, followed by a propagation with
Gadget-2 from z = 69 to z = 0. In this fashion, we generate fully non-linear, data-constrained reconstructions
of the present-day large-scale dark matter distribution.
As discussed in section 7.1, ﬁnal conditions inferred by borg are accurate only at linear and mildly non-linear
scales. Application of fully non-linear dynamics to the corresponding initial conditions acts as an additional
ﬁltering step, extrapolating predictions to unconstrained non-linear regimes. In a Bayesian approach, this new
information can then be tested with complementary observations in the actual sky for updating our knowledge
on the Universe.
An illustration of the non-linear ﬁltering procedure is presented in ﬁgure 7.1.3 By comparing initial and
ﬁnal density ﬁelds, one can see correspondences between structures in the present Universe and their origins.
Comparing ﬁnal density ﬁelds before and after ﬁltering (middle and left panels), one can check the conformity
of the linear and mildly non-linear structures at large and intermediate scales, correctly predicted by 2LPT.
Small-scale structures, corresponding to the deeply non-linear regime, are much better represented after non-
linear ﬁltering (resulting particularly in sharper ﬁlaments and clusters). N-body dynamics also resolves much
more ﬁnely the substructure of voids – known to suﬀer from spurious artifacts in 2LPT, namely the presence of
peaky, overdense spots where there should be deep voids (Sahni & Shandarin, 1996; Neyrinck, 2013; Leclercq
et al., 2013; see also chapter 2) – which is of particular relevance for the purpose of inferring dark matter voids
(see chapter 8).
The improvement introduced by non-linear ﬁltering at the level of two-point statistics is presented in ﬁgure
7.2, where we plot the power spectra of dark matter density ﬁelds at z = 0. The agreement between uncon-
strained and constrained realizations at all scales can be checked. The plot also shows that our set of constrained
reconstructions contains the additional power expected in the non-linear regime4, up to k ≈0.4 (Mpc/h)−1.
3 In ﬁgure 7.1 and in all slice plots of the rest of this thesis, we keep the coordinate system of Jasche, Leclercq & Wandelt (2015),
also used in chapter 5.
4 Note that the lack of small scale power in Gadget and cola with respect to theoretical predictions, for k ≳0.5 (Mpc/h)−1, is
a gridding artifact due to the ﬁnite mesh size used for the analysis. This value corresponds to around one quarter of the Nyquist
wavenumber.

112
Chapter 7. Non-linear ﬁltering of large-scale structure samples
10−2
10−1
100
k [(Mpc/h)−1]
101
102
103
104
105
P(k) [(Mpc/h)3]
PNL(k)
2LPT, posterior
2LPT, prior
Gadget, posterior
Gadget, prior
COLA, posterior
COLA, prior
Figure 7.2: Power spectra of dark matter density ﬁelds at redshift zero, computed with a mesh size of 3 Mpc/h. The
particle distributions are determined using: 1, 000 unconstrained 2LPT realizations (“2LPT, prior”), 4, 473 constrained
2LPT samples inferred by borg (“2LPT, posterior”), 11 unconstrained Gadget-2 realizations (“Gadget, prior”), 11
constrained samples inferred by borg and ﬁltered with Gadget-2 (“Gadget, posterior”), 1, 000 unconstrained cola
realizations (“COLA, prior”), 1, 097 constrained samples inferred by borg and ﬁltered with cola (“COLA, posterior”).
The solid lines correspond to the mean among all realizations used in this work, and the shaded regions correspond to
the 2-σ credible interval estimated from the standard error of the mean. The dashed black curve represents PNL(k), the
theoretical power spectrum expected at z = 0 from high-resolution N-body simulations.
7.3
Fast non-linear ﬁltering with COLA
For means of uncertainty quantiﬁcation within large-scale structure inference, it is necessary to process a
large number of samples. Unfortunately, optimal non-linear ﬁltering with Gadget-2 is too expensive for the
∼10, 000 samples of a single borg run. However, an approximate model for non-linear structure formation,
correct up to scales of a few Mpc/h, is enough for our purposes, as long as the approximation error is controlled
and quantiﬁed.
7.3.1
The COLA method
The cola (COmoving Lagrangian Acceleration, Tassev, Zaldarriaga & Eisenstein, 2013; Tassev et al., 2015)
technique oﬀers a cheap way to perform non-linear ﬁltering of a large number of borg samples. A particular
advantage (in opposition to standard particle-mesh codes) is its ﬂexibility in trading accuracy at small scales
for computational speed, without sacriﬁcing accuracy at the largest scales.
The general idea of cola is to use our analytic understanding of structure formation at large scales via
LPT, and to solve numerically only for a subdominant contribution describing small scales. Speciﬁcally, Tassev
& Zaldarriaga (2012c) propose to expand the Lagrangian displacement of particles as
Ψ(x, τ) = ΨLPT(x, τ) + ΨMC(x, τ)
(7.3)
where ΨLPT(x, τ) is the analytic displacement prescribed by LPT5 (the ZA or 2LPT, see chapter 2) and
ΨMC(x, τ) ≡Ψ(x, τ) −ΨLPT(x, τ) is the “mode-coupling residual”. Using this Ansatz, the Eulerian position is
x = q + ΨLPT + ΨMC, and the equation of motion, which reads schematically (omitting constants and Hubble
expansion; see equation (1.74))
d2x
dτ 2 = −∇xΦ,
(7.4)
5 Following
Tassev
&
Zaldarriaga
(2012c),
this
ﬁrst
term
can
be
written
more
generally
in
Fourier
space
as
Ψ⋆(k, τ) = RLPT(k, τ) ΨLPT(k, τ), where RLPT(k, τ) is a transfer function that we ignore here for simplicity.

7.3. Fast non-linear ﬁltering with COLA
113
0
10
20
30
40
50
x [Mpc/h]
0
10
20
30
40
50
y [Mpc/h]
2LPT
∼3 timesteps
0
10
20
30
40
50
x [Mpc/h]
0
10
20
30
40
50
y [Mpc/h]
cola
10 timesteps
0
10
20
30
40
50
x [Mpc/h]
0
10
20
30
40
50
y [Mpc/h]
Gadget
∼2000 timesteps
Figure 7.3: Slices through three particle realizations evolved from the same initial conditions up to z = 0. The particles
are shown as black points. Each slice is 20 Mpc/h thick and 50 Mpc/h on the side. The left panel shows the 2LPT
approximation, of computational cost roughly equivalent to 3 timesteps of a N-body code. The right panel shows the
reference result obtained from Gadget-2 after ∼2000 timesteps, starting from 2LPT initial conditions at z = 69. The
middle panel shows the result obtained with cola with 10 timesteps, starting from 2LPT initial conditions at z = 9.
can be rewritten in a frame comoving with “LPT observers”, whose trajectories are given by ΨLPT, as
d2ΨMC
dτ 2
= −∇xΦ −d2ΨLPT
dτ 2
.
(7.5)
In analogy with classical mechanics, d2ΨLPT/dτ 2 can be thought of as a ﬁctitious force acting on particles,
coming from the fact that we are working in a non-inertial frame of reference.
The standard approach in PM codes (see appendix B) is to discretize the second-derivative time operator
in equation (7.4). At large scales, this is nothing more than solving for the linear growth factor. Thereforce,
if few timesteps are used in PM codes, the large-scale structure will be miscalculated only because of a faulty
estimation of the growth factor, the exact value of which being well-known.
In contrast, the cola method uses a numerical discretization of the operator d2/dτ 2 only on the left-hand
side of equation (7.5) and exploits the exact analytic expression for the ﬁctitious force, d2ΨLPT/dτ 2. The
equation solved by cola, equation (7.5), is obviously equivalent to (7.4). However, as demonstrated by Tassev,
Zaldarriaga & Eisenstein (2013), using this framework requires a smaller number of timesteps to recover accurate
particle realizations. In particular, they show that as few as 10 timesteps from z = 9 to z = 0 are suﬃcient to
obtain an accurate description of halo statistics up to halos of mass 1011 M⊙/h, without resolving the internal
dynamics of halos. Concerning the description of the large-scale matter density ﬁeld, 10 cola timesteps achieve
better than 95% cross-correlation with the true result up k ∼2 Mpc/h.
As an illustration of the performance of cola, we show slices through corresponding 2LPT, cola and
Gadget particle realizations in ﬁgure 7.3. The simulations contain 5123 particles in a 750 Mpc/h cubic box
with periodic boundary conditions. Forces are calculated on a PM grid of 5123 cells. The initial conditions are
generated with 2LPT at a redshift of z = 69 for Gadget and z = 9 for cola.
7.3.2
Non-linear BORG-COLA realizations
This section draws from section II.B. in Leclercq, Jasche & Wandelt (2015c).
In chapter 9, we use an ensemble of 1, 097 large-scale structure realizations produced via non-linear ﬁltering
of borg samples with cola. The initial density ﬁeld, deﬁned on a cubic equidistant grid with side length of
750 Mpc/h and 2563 voxels, is populated by 5123 particles placed on a regular Lagrangian lattice. The particles
are evolved with 2LPT to the redshift of z = 69 and with cola from z = 69 to z = 0. The ﬁnal density
ﬁeld is constructed by binning the particles with a CiC method on a 2563-voxel grid. This choice corresponds
to a resolution of around 3 Mpc/h for all the maps described in chapter 9. In this fashion, we generate a

114
Chapter 7. Non-linear ﬁltering of large-scale structure samples
10−1
100
k [(Mpc/h)−1]
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.0
R(k) [(Mpc/h)3]
2LPT, posterior
2LPT, prior
COLA, posterior
COLA, prior
Figure 7.4: Cross-correlations between density ﬁelds at redshift zero, computed with a mesh size of 3 Mpc/h. The
reference ﬁelds are the result of Gadget-2. The lines correspond to the cross-correlation between unconstrained 2LPT
realizations and corresponding simulations (“2LPT, prior”), constrained 2LPT samples inferred by borg and corre-
sponding optimal ﬁltering (“2LPT, posterior”), unconstrained cola realizations and corresponding simulations (“COLA,
prior”), constrained borg-cola samples and corresponding optimal ﬁltering (“COLA, posterior”). In each case, we use
11 constrained or unconstrained realizations. The solid lines correspond to the mean among all realizations used in this
work, and the shaded regions correspond to the 2-σ credible interval estimated from the standard error of the mean.
large set of data-constrained reconstructions of the present-day dark matter distribution (see also Lavaux, 2010;
Kitaura, 2013; Heß, Kitaura & Gottlöber, 2013; Nuza et al., 2014). To ensure suﬃcient accuracy, 30 timesteps
logarithmically-spaced in the scale factor are used for the evolution with cola.
cola enables us to cheaply generate non-linear density ﬁelds at the required accuracy, as we now show.
The power spectrum of non-linear borg-cola realizations is shown in ﬁgure 7.2 in comparison to that of
unconstrained realizations and to samples optimally ﬁltered with Gadget-2. In ﬁgure 7.4, we plot the cross-
correlation between approximate density ﬁelds (predicted by 2LPT or by cola) and the result of Gadget-2,
for both unconstrained and constrained realizations. On these plots, it can be checked that our constrained
samples, inferred by borg and ﬁltered with cola, contain the additional power expected in the non-linear
regime and cross-correlate at better that 95% accuracy with the corresponding fully non-linear realizations, up
to k ≈0.4 Mpc/h. Therefore, as for unconstrained simulations, our setup yields vanishing diﬀerence between
the representation of constrained density ﬁelds with cola and with Gadget-2, at the scales of interest of this
work.

Part IV
Cosmic web analysis


Chapter 8
Dark matter voids in the SDSS galaxy
survey
Contents
8.1
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
117
8.2
Methodology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
120
8.2.1
Bayesian large-scale structure inference with the BORG algorithm . . . . . . . . . . . . . . 120
8.2.2
Generation of data-constrained reconstructions . . . . . . . . . . . . . . . . . . . . . . . . . 121
8.2.3
Void ﬁnding and processing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121
8.2.4
Blackwell-Rao estimators for dark matter void realizations . . . . . . . . . . . . . . . . . . . 122
8.2.5
Void catalogs for comparison of our results
. . . . . . . . . . . . . . . . . . . . . . . . . . . 124
8.3
Properties of dark matter voids . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
125
8.3.1
Number function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125
8.3.2
Ellipticity distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126
8.3.3
Radial density proﬁles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127
8.4
Summary and conclusions
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
128
“Lost and forgotten be, darker than the darkness,
Where gates stand for ever shut, till the world is mended.”
— John Ronald Reuel Tolkien (1954), The Fellowship of the Ring
Abstract
What do we know about voids in the dark matter distribution given the Sloan Digital Sky Survey and assuming
the ΛCDM model? In chapter 5, application of the Bayesian inference algorithm borg to the SDSS Data Release
7 main galaxy sample has generated detailed Eulerian and Lagrangian representations of the large-scale structure as
well as the possibility to accurately quantify corresponding uncertainties. Building upon these results, we present
constrained catalogs of voids in the Sloan volume, aiming at a physical representation of dark matter underdensities
and at the alleviation of the problems due to sparsity and biasing on galaxy void catalogs. To do so, we generate
data-constrained reconstructions of the presently observed large-scale structure using a fully non-linear gravitational
model. We then ﬁnd and analyze void candidates using the vide toolkit. Our methodology therefore predicts the
properties of voids based on fusing prior information from simulations and data constraints. For usual void statistics
(number function, ellipticity distribution and radial density proﬁle), all the results obtained are in agreement with dark
matter simulations. Our dark matter void candidates probe a deeper void hierarchy than voids directly based on the
observed galaxies alone. The use of our catalogs therefore opens the way to high-precision void cosmology at the level
of the dark matter ﬁeld. We have made the void catalogs used in this work available at http://www.cosmicvoids.net.
This chapter is adapted from its corresponding publication, Leclercq et al. (2015).
8.1
Introduction
Observations of the cosmic large-scale structure have revealed that galaxies tend to lie in thin wall-like
structures surrounding large underdense regions known as voids, which constitute most of the volume of the
Universe.
Although the discovery of cosmic voids dates back to some of the ﬁrst galaxy redshift surveys

118
Chapter 8. Dark matter voids in the SDSS galaxy survey
(Gregory & Thompson, 1978; Kirshner et al., 1981; de Lapparent, Geller & Huchra, 1986) and their signiﬁcance
was assessed in some early studies (Martel & Wasserman, 1990; van de Weygaert & van Kampen, 1993; Goldberg
& Vogeley, 2004), the systematic analysis of void properties has only been considered seriously as a source of
cosmological information in the last decade (e.g. Sheth & van de Weygaert, 2004; Colberg et al., 2005; Viel,
Colberg & Kim, 2008; Betancort-Rijo et al., 2009; Lavaux & Wandelt, 2010; Biswas, Alizadeh & Wandelt, 2010;
van de Weygaert & Platen, 2011; Lavaux & Wandelt, 2012, and references therein). Like overdense tracers
of the density ﬁeld such as clusters, voids can be studied by statistical methods in order to learn about their
distribution and properties compared to theoretical predictions.
Generally, direct sensitivity of void statistics to cosmology is only guaranteed for the underdense regions of
the overall matter density ﬁeld, which includes a large fraction of dark matter. These are the physical voids
in the LSS, for which theoretical modeling is established. However, absent direct measurements of dark matter
underdensities, current void catalogs are deﬁned using the locations of galaxies in large redshift surveys (Pan
et al., 2012; Sutter et al., 2012b, 2014d; Nadathur & Hotchkiss, 2014). Since galaxies trace the underlying mass
distribution only sparsely, void catalogs are subject to uncertainty and noise. Additionally, numerical simula-
tions show that there exists a population of particles in cosmic voids. This is an indication of physical biasing in
galaxy formation: there is primordial dark and baryonic matter in voids, but due to the low density, little galaxy
formation takes place there. Additionally, due to complex baryonic physics eﬀects during their formation and
evolution, galaxies are biased tracers of the underlying density ﬁeld, which gives rise to qualitatively diﬀerent
void properties.
The sensitivity of void properties to the sampling density and biasing of the tracers has only been recently
analyzed in depth on simulations, by using synthetic models to mimic realistic surveys. Little & Weinberg
(1994); Benson et al. (2003); Tinker & Conroy (2009); Sutter et al. (2014c) found that the statistical properties
of voids in galaxy surveys are not the same as those in dark matter distributions. At lower tracer density,
small voids disappear and the remaining voids are larger and more spherical. Their density proﬁles get slightly
steeper, with a considerable increase of their compensation scale, which potentially may serve as a static ruler
to probe the expansion history of the Universe (Hamaus et al., 2014b). Hamaus, Sutter & Wandelt (2014)
recently proposed a universal formula for the density proﬁles of voids, describing in particular dark matter voids
in simulations (see also Colberg et al., 2005; Paz et al., 2013; Ricciardelli, Quilis & Varela, 2014; Nadathur
et al., 2014). The connection between galaxy voids and dark matter voids on a one-by-one basis is diﬃcult due
to the complex internal hierarchical structure of voids (Dubinski et al., 1993; van de Weygaert & van Kampen,
1993; Sahni, Sathyaprakah & Shandarin, 1994; Sheth & van de Weygaert, 2004; Aragon-Calvo & Szalay, 2013;
Sutter et al., 2014d,b). However, the nature of this relationship determines the link between a survey, with its
particular tracer density, and the portion of the cosmic web that it represents. Understanding this connection is
of particular importance in light of recent results that probe the LSS via its eﬀect on photons geodesics. These
results include Melchior et al. (2014); Clampitt & Jain (2014), which probe the dark matter distribution via
weak gravitational lensing; Ilić, Langer & Douspis (2013); Planck Collaboration (2014a) for the detection of the
integrated Sachs-Wolfe eﬀect in the cosmic microwave background, sensitive to the properties of dark energy.
As a response to this demand, Sutter et al. (2014b) found that voids in galaxy surveys always correspond to
underdensities in the dark matter, but that their centers may be oﬀset and their size can diﬀer, in particular in
sparsely sampled surveys where void edges suﬀer fragmentation.
While previous authors oﬀer broad prescriptions to assess the eﬀects of sparsity and biasing of the tracers
on voids, the connection between galaxy voids of a particular survey and dark matter underdensities remains
complex.
In particular, disentangling these eﬀects from cosmological signals in presence of the uncertainty
inherent to any cosmological observation (selection eﬀects, survey mask, noise, cosmic variance) remains an
open question. In this work, we propose a method designed to circumvent the issues due to the conjugate and
intricate eﬀects of sparsity and biasing on galaxy void catalogs. In doing so, we will show that voids in the
dark matter distribution can be constrained by the ab initio analysis of surveys of tracers, such as galaxies. We
will demonstrate the feasibility of our method and obtain catalogs of dark matter voids candidates in the Sloan
Digital Sky Survey Data Release 7.
Our method is based on the identiﬁcation of voids in the dark matter distribution inferred from large-scale
structure surveys. The constitution of such maps from galaxy positions, also known as “reconstruction”, is
a ﬁeld in which Bayesian methods have led to enormous progress over the last few years. Initial approaches
typically relied on approximations such as a multivariate Gaussian or log-normal distribution for density ﬁelds,
with a prescription for the power spectrum to account for the correct two-point statistics (Lahav et al., 1994;
Zaroubi, 2002; Erdoˇgdu et al., 2004; Kitaura & Enßlin, 2008; Kitaura et al., 2009; Kitaura, Jasche & Metcalf,

8.1. Introduction
119
2010; Jasche & Kitaura, 2010; Jasche et al., 2010b,a). However, due to their potentially complex shapes, proper
identiﬁcation of structures such as voids requires reconstructions correct not only at the level of the power
spectrum, but also higher-order correlators. Inferences of this kind from observational data have only been
made possible very recently by the introduction of physical models of structure formation in the likelihood.
This naturally moves the problem to the inference of the initial conditions from which the large-scale structure
originates (Jasche & Wandelt, 2013a; Kitaura, 2013; Wang et al., 2013).
This work exploits the recent application of the borg (Bayesian Origin Reconstruction from Galaxies,
Jasche & Wandelt (2013a), see chapter 4) algorithm to the Sloan Digital Sky Survey galaxies (Jasche, Leclercq
& Wandelt, 2015, see chapter 5), and on the subsequent generation of constrained non-linear realizations of
the present large-scale distribution of dark matter. borg is a full-scale Bayesian framework, permitting the
four-dimensional physical inference of density ﬁelds in the linear and mildly non-linear regime, evolving grav-
itationally from the initial conditions to the presently observed large-scale structure. By exploring a highly
non-linear and non-Gaussian LSS posterior distribution via eﬃcient Markov Chain Monte Carlo methods, it
also provides naturally and fully self-consistently accurate uncertainty quantiﬁcation for all derived quantities.
A straightforward use of reconstructed initial conditions is to resimulate the considered volume (Lavaux, 2010;
Kitaura, 2013; Heß, Kitaura & Gottlöber, 2013). In the same spirit, building upon the inference of the initial
conditions by borg, one can generate a set of data-constrained realizations of the present large-scale structure
via full N-body dynamics. As we will show, we make use of initial conditions reconstructed by borg without
any further post-processing, which demonstrates the high quality of inference results.
Due to the limited number of phase-space foldings, the inﬂuence of non-linearity in cosmic voids is expected
to be milder as compared to galaxies and dark matter halos (Neyrinck, 2012; Neyrinck & Yang, 2013; Leclercq
et al., 2013, see also Abel, Hahn & Kaehler, 2012; Falck, Neyrinck & Szalay, 2012; Shandarin, Habib & Heitmann,
2012). For this reason, voids are more closely related to the initial conditions of the Universe, which makes
them the ideal laboratories for physical application of Bayesian inference with borg. In this work, we apply
the void ﬁnder algorithm vide (Sutter et al., 2015b), based on ZOBOV (Neyrinck, 2008), to data-constrained,
non-linear reconstructions of the LSS. Each of them is a full physical realization of densely-sampled particles
tracing the dark matter density ﬁeld. In this fashion, we construct catalogs of dark matter voids in the SDSS
volume robust to sparsity and biasing of galaxies. As we will show, this procedure drastically reduces statistical
uncertainty in void catalogs. Additionally, the use of data-constrained reconstructions allows us to extrapolate
the void identiﬁcation in existing data (e.g. at very small or at the largest scales, at high redshift or near the
survey boundary).
As described in chapters 4 and 5, (see Jasche & Wandelt, 2013a; Jasche, Leclercq & Wandelt, 2015), the
borg inference framework possesses a high degree of control on observational systematic and statistical uncer-
tainties such as noise, survey geometry and selection eﬀects. Uncertainty quantiﬁcation is provided via eﬃcient
sampling of the corresponding LSS posterior distribution. The resultant set of initial and ﬁnal density ﬁeld
realizations yields a numerical representation of the full posterior distribution, capturing all data constraints
and observational uncertainties. Building upon these results, in this work, we will extend our Bayesian rea-
soning to void catalogs. Speciﬁcally, we apply full non-linear N-body dynamics to a set of data-constrained
initial conditions to arrive at a set of non-linear dark matter density ﬁelds at the present epoch. As a result, we
obtain a probabilistic description of non-linear density ﬁelds constrained by SDSS observations. Applying the
vide void ﬁnder to this set of reconstructions yields N data-constrained realizations of the catalog, representing
the posterior probability distribution for dark matter voids given observations. In this fashion, we have fully
Bayesian access to uncertainty quantiﬁcation via the variation between diﬀerent realizations. In particular, we
are now able to devise improved estimators for any void statistics by the use of Blackwell-Rao estimators. To
assess the robustness of this technique for cosmological application, we focus on three key void observables:
number functions, ellipticity distributions and radial density proﬁles. These are especially sensitive probes of
non-standard cosmologies (Bos et al., 2012) and are well understood in both data and simulations (e.g Sutter
et al., 2014d).
As a general matter, we stress that these data-constrained realizations of dark matter void catalogs were
obtained assuming a ΛCDM prior. Using our products for model testing therefore requires care: in the absence
of data constraints, one will simply be dealing with realizations of the ΛCDM prior. Consequently, any departure
from unconstrained ΛCDM predictions are driven by the data. Conversely, for model tests where the data are
not strongly informative, agreement with ΛCDM is the default answer.
This chapter is organized as follows. In section 8.2, we describe our methodology: Bayesian inference with the
borg algorithm, non-linear ﬁltering of the results, void identiﬁcation technique and Blackwell-Rao estimators

120
Chapter 8. Dark matter voids in the SDSS galaxy survey
Standard galaxy void identiﬁcation
VIDE 
Sparsely-sampled, biased galaxies as tracers 
Estimators for galaxy void statistics 
SDSS galaxies 
Inference of dark matter voids
Selection effects, survey boundaries, galaxy bias 
Fully non-linear gravitational dynamics 
Densely-sampled DM particles as tracers 
SDSS galaxies 
BORG 
Inferred initial conditions 
Gadget2 
Data-constrained realizations of DM particles 
VIDE 
Void estimator for each DM realization 
Blackwell-Rao 
Estimators for DM void statistics 
Figure 8.1: Schematic representation of our methodology for the inference of dark matter voids (lower panel) in compar-
ison to the standard approach for the identiﬁcation of galaxy voids (upper panel).
for void statistics. In section 8.3, we examine the properties of the dark matter voids in our catalogs. Finally, in
section 8.4 we summarize our results, discuss perspectives for existing and upcoming galaxy surveys and oﬀer
concluding comments.
8.2
Methodology
In this section, we describe our methodology step by step:
1. inference of the initial conditions with borg (section 8.2.1),
2. generation of data-constrained realizations of the SDSS volume (section 8.2.2),
3. void ﬁnding and processing (section 8.2.3),
4. combination of diﬀerent void catalogs with Blackwell-Rao estimators (section 8.2.4).
In section 8.2.5, we describe the void catalogs used as references for comparison with our results. These are
galaxy void catalogs directly based on SDSS galaxies without use of our methodology, and catalogs of voids in
dark matter simulations.
A schematic representation of our procedure is represented in ﬁgure 8.1, in comparison to the standard
approach of ﬁnding voids using galaxies as tracers.
8.2.1
Bayesian large-scale structure inference with the BORG algorithm
This works builds upon previous results, obtained by the application of borg (Bayesian Origin Reconstruc-
tion from Galaxies, Jasche & Wandelt, 2013a) to SDSS main galaxy data (Jasche, Leclercq & Wandelt, 2015).
In the rest of this section, we summarize its most stringent features; the reader is referred to chapters 4 and 5
for all details.
The borg algorithm is a fully probabilistic inference machinery aiming at the analysis of linear and mildly-
non-linear density and velocity ﬁelds in galaxy observations. It incorporates a physical model of cosmological

8.2. Methodology
121
structure formation, which translates the traditional task of reconstructing the non-linear three-dimensional
density ﬁeld into the task of inferring corresponding initial conditions from present cosmological observations.
This approach yields a highly non-trivial Bayesian inference, requiring to explore very high-dimensional and
non-linear spaces of possible solutions to the initial conditions problem from incomplete observations. Typically,
these parameter spaces comprise on the order of 106 to 107 parameters, corresponding to the elements of the
discretized observational domain.
Speciﬁcally, the borg algorithm explores a posterior distribution consisting of a Gaussian prior, describing
the statistical behavior of the initial density ﬁeld at a cosmic scale factor of a = 10−3, linked via second-order
Lagrangian perturbation theory to a Poissonian model of galaxy formation at the present epoch (for details
see Jasche & Wandelt, 2013a and Jasche, Leclercq & Wandelt, 2015). As pointed out by previous authors (see
e.g. Moutarde et al., 1991; Buchert, Melott & Weiß, 1994; Bouchet et al., 1995; Scoccimarro, 2000; Bernardeau
et al., 2002; Scoccimarro & Sheth, 2002, and chapter 2), 2LPT describes the one-, two- and three-point statistics
correctly and represents higher-order statistics very well. Consequently, the borg algorithm naturally accounts
for features of the cosmic web, such as ﬁlaments, that are typically associated to high-order statistics induced
by non-linear gravitational structure formation processes.
Besides physical structure formation, the posterior distribution also accounts for survey geometry, selection
eﬀects and noise, inherent to any cosmological observation (see section 4.2). Corresponding full Bayesian un-
certainty quantiﬁcation is provided by exploring this highly non-Gaussian and non-linear posterior distribution
via an eﬃcient Hamiltonian Markov Chain Monte Carlo sampling algorithm (see Jasche & Wandelt, 2013a, and
sections 3.4.3, 4.3.2, for details). In order to account for luminosity dependent galaxy bias (Jasche & Wandelt,
2013b) and to make use of automatic noise calibration, we further use modiﬁcations introduced to the original
borg algorithm by Jasche, Leclercq & Wandelt (2015) (see section 4.3.1).
In this work, we make use of the 12, 000 samples of the posterior distribution generated by Jasche, Leclercq
& Wandelt (2015), described in chapter 5, which constitute highly-detailed and accurate reconstructions of the
initial and present-day density ﬁelds constrained by SDSS observations.
8.2.2
Generation of data-constrained reconstructions
Starting form 11 statistically independent initial conditions realizations from the borg SDSS analysis, we
generated a set of fully non-linear, constrained reconstructions of the LSS. This step is achieved via optimal
ﬁltering of borg results with the Gadget-2 (Springel, Yoshida & White, 2001; Springel, 2005) cosmological
code. For details on the non-linear ﬁltering procedure, see chapter 7, in particular section 7.2 for the description
of the set of realizations used in this chapter.
8.2.3
Void ﬁnding and processing
8.2.3.1
Void ﬁnding
We identify and post-process voids with the vide (Void IDentiﬁcation and Examination) toolkit1 (Sutter
et al., 2015b, also described in section C.1 of appendix C), which uses a highly modiﬁed version of ZOBOV
(Neyrinck, 2008; Lavaux & Wandelt, 2012; Sutter et al., 2012b) to create a Voronoi tessellation of the tracer
particle population and the watershed transform to group Voronoi cells into zones and voids (Platen, van de
Weygaert & Jones, 2007).
The watershed transform identiﬁes catchment basins as the cores of voids, and
ridgelines, which separate the ﬂow of water, as the boundaries of voids. It naturally builds a nested hierarchy
of voids (Lavaux & Wandelt, 2012; Bos et al., 2012). For the purposes of this work, we examine all voids
regardless of their position in the hierarchy. The pipeline imposes a density-based threshold within the void
ﬁnding operation: voids only include as additional members Voronoi zones if the minimum ridge density between
that zone and the void is less than 0.2 times the mean particle density (Platen, van de Weygaert & Jones,
2007; see Blumenthal et al., 1992; Sheth & van de Weygaert, 2004 for the role of the corresponding δ = −0.8
underdensity). If a void consists of only a single zone (as they often do in sparse populations) then this restriction
does not apply.
vide provides several useful deﬁnitions used in this work, such as the eﬀective radius,
Rv ≡
 3
4π V
1/3
,
(8.1)
1 http://www.cosmicvoids.net

122
Chapter 8. Dark matter voids in the SDSS galaxy survey
where V is the total volume of the Voronoi cells that contribute to the void. We use this radius deﬁnition to
ignore voids with Rv below the mean particle spacing ¯n−1/3 of the tracer population, as these are increasingly
aﬀected by Poisson ﬂuctuations. vide also reports the volume-weighted center, or macrocenter, as
xv ≡
1
P
i Vi
X
i
xiVi,
(8.2)
where xi and Vi are the positions and Voronoi volumes of each tracer particle i, respectively.
In each tracer population, the vide pipeline provides void estimators ; in particular, the three statistics we
will focus on in section 8.3: number count, ellipticity distribution and radial density proﬁle.
In ﬁgure 8.2, we show slices through diﬀerent data-constrained realizations. The density of dark matter
particles identiﬁed by vide as being part of a void is represented in gray scale. Note that, since ZOBOV
essentially performs a division of space in diﬀerent void regions with vanishingly-thin ridges, almost all particles
initially present in the dark matter ﬁeld are conserved. For clarity of the visualization, the quantity represented
is ln(2 + δ) where δ is the density contrast of particles in voids. The SDSS galaxies used for the borg analysis
are overplotted as red dots. The core of dark matter voids (using a density threshold δ < −0.3) is shown in
color. As can be observed, dark matter voids also correspond to underdensities in the ﬁeld traced by galaxies,
which is in agreement with the results obtained by Sutter et al. (2014b) in simulations.
8.2.3.2
Selection of voids
The vide pipeline identiﬁes all dark matter voids in the non-linear data-constrained realizations described
in section 8.2.2. These live in boxes of 750 Mpc/h side length with periodic boundary conditions. In order to
select physically meaningful dark matter void candidates, we have to select a subsample of voids which intersect
the volume of the box actually constrained by SDSS galaxies.
As described in chapter 5, unobserved and observed regions in the inferred ﬁnal density ﬁelds do not appear
visually distinct, a consequence of the excellent performance of the 2LPT model implemented in borg as
a physical description of structure formation.
In addition, due to the non-local transport of observational
information between initial and ﬁnal conditions, the region inﬂuenced by data extends beyond the survey
boundaries and the large-scale structure appears continuous there. The fact that data constraints can radiate
out of the survey volume has been known since the ﬁrst constrained reconstructions of the mass distribution
(Bertschinger, 1987; Hoﬀman & Ribak, 1991; van de Weygaert & Bertschinger, 1996), where a power spectrum
prior was assumed to sample constrained Gaussian random ﬁelds.
Here, as detailed in chapters 4 and 5,
constraints are propagated by the structure formation model assumed in the inference process (2LPT), which
accounts not only for two-point statistics, but for the full hierarchy of correlators, in its regime of validity.
Therefore, dark matter voids candidates intersecting the survey boundaries can be considered as physical if a
signiﬁcant fraction of their volume is inﬂuenced by the data.
The survey response operator R is a voxel-wise function representing simultaneously the survey geometry
(observed and unobserved regions) and the selection eﬀects in galaxy catalogs. Here, we kept for R the average
over the six luminosity bins used in the borg SDSS run (for details see chapter 5). For the purpose of this
work, we keep all void candidates whose center is in a region where R is strictly positive. This region represents
7.9 × 107 cubic Mpc/h, around 18.7% of the full box. In each of the 11 realizations used in this work, we kept
around 166, 000 data-constrained voids out of 886, 000 voids in the entire box.
In ﬁgure 8.2, the survey response operator is shown in color from purple (totally unobserved region) to blue
(region fully constrained by the data). One can see the correct propagation of information operated by borg,
as voids appear continuous at the survey boundaries.
8.2.4
Blackwell-Rao estimators for dark matter void realizations
A particular advantage of our Bayesian methodology is the ability to provide accurate uncertainty quantiﬁ-
cation for derived dark matter void properties. In particular, the Markovian samples described in chapter 5
permit us to employ a Blackwell-Rao estimator to describe the posterior distribution for inferred dark matter
voids. Speciﬁcally, we are interested in deriving the posterior distribution P(x|d) of a dark matter void property
x given observations d. Using the realizations of the initial conditions δi and the dark matter void realizations
V generated by the approach described in sections 8.2.2 and 8.2.3, we obtain

8.2. Methodology
123
0
50
100
150
200
250
300
350
400
z [Mpc/h]
400
350
300
250
200
150
100
50
0
−x [Mpc/h]
0.0
0.3
0.6
0.9
1.2
1.5
1.8
2.1
2.4
2.7
3.0
ln(2 + δ)
0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.0
R
0
50
100
150
200
250
300
350
400
z [Mpc/h]
400
350
300
250
200
150
100
50
0
−x [Mpc/h]
0.0
0.3
0.6
0.9
1.2
1.5
1.8
2.1
2.4
2.7
3.0
ln(2 + δ)
0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.0
R
0
50
100
150
200
250
300
350
400
z [Mpc/h]
400
350
300
250
200
150
100
50
0
−x [Mpc/h]
0.0
0.3
0.6
0.9
1.2
1.5
1.8
2.1
2.4
2.7
3.0
ln(2 + δ)
0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.0
R
0
50
100
150
200
250
300
350
400
z [Mpc/h]
400
350
300
250
200
150
100
50
0
−x [Mpc/h]
0.0
0.3
0.6
0.9
1.2
1.5
1.8
2.1
2.4
2.7
3.0
ln(2 + δ)
0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.0
R
Figure 8.2: Slices through diﬀerent data-constrained realizations used to build samples of the dark matter void catalog.
The SDSS galaxies used for the inference with borg are represented as red dots. The density of dark matter particles
identiﬁed by vide as being part of a void is shown in gray scale. In color, we show the particles that live in the core of dark
matter voids (in a density environment smaller than −0.3 times the average density). The survey response operator R
shows how well the results are constrained by the data (see text for details). In the observed region, the data are strongly
informative about the cosmic web in general and voids in particular; the reconstructions are not prior-dominated.

124
Chapter 8. Dark matter voids in the SDSS galaxy survey
P(x|d)
=
Z
P(x|V ) P(V, δi|d) dV dδi
=
Z
P(x|V ) P(V |δi, d) P(δi|d) dV dδi
=
Z
P(x|V ) δD(V −˜V (δi)) P(δi|d) dV dδi
=
Z
P(x| ˜V (δi)) P(δi|d) dδi
≈
1
N
X
k
P
 x| ˜V (δi
k)

=
1
N
X
k
P (x|Vk) ,
(8.3)
where we assumed the dark matter void templates V to be conditionally independent of the data d given the
initial conditions δi, and to derive uniquely from the initial density ﬁeld via the procedure described in sections
8.2.2 and 8.2.3, yielding P(V |δi, d) = P(V |δi) = δD(V −˜V (δi)). We also exploited the fact that we have a
sampled representation of the initial conditions posterior distribution P(δi|d) ≈1/N P
k δD(δi −δi
k), where k
labels one of the N samples. The last line of equation (8.3) represents the Blackwell-Rao estimator for void
property x to be inferred from our dark matter void catalogs Vk, providing thorough Bayesian means to quantify
uncertainties. It consists of a mixture distribution over diﬀerent realizations of dark matter void templates.
The vide pipeline provides estimated means and variances for derived quantities x, allowing us to model the
distributions P(x|Vk) as Gaussians with mean xk and variance σ2
k, for respective dark matter void templates.
The ﬁnal expression for the posterior distribution of x given the data is therefore
P(x|d) ≈1
N
X
k
1
p
2πσ2
k
exp
 
−1
2
(x −xk)2
σ2
k
!
.
(8.4)
Even though we have access to non-Gaussian uncertainty quantiﬁcation via the posterior distribution given in
equation (8.4), for the presentation in this chapter we will be content with estimating means and variances.
The mean for x given d is
⟨x|d⟩≈1
N
X
k
xk,
(8.5)
and the variance is
⟨(x −⟨x⟩)2 |d⟩≈1
N
X
k
(x2
k + σ2
k) −⟨x|d⟩2.
(8.6)
As described in section 8.2.3.2, we select voids in the data-constrained regions of reconstructions of the dark
matter density ﬁeld. Since these regions are the same in diﬀerent reconstructions, the diﬀerent void catalogs
describe the same region of the actual Universe. For this reason, while estimating uncertainties, it is not possible
to simply use all the voids in our catalogs as if they were independent.2 However, using an increasing number
of reconstructions, we shall still see a decrease of statistical uncertainty. Indeed, from (8.5) and (8.6) it follows
that
⟨(x −⟨x⟩)2 |d⟩≤1
N
X
k
σ2
k,
(8.7)
which means that the combination of diﬀerent realizations will generally yield an improved estimator for any
original statistics.
Note that this procedure is completely general and applies to any estimator provided by the vide pipeline.
8.2.5
Void catalogs for comparison of our results
In section 8.3, we will compare our results for dark matter voids to state-of-the-art results for galaxy voids.
To do so, we use the catalogs of Sutter et al. (2012b) based on the SDSS DR7 galaxies, publicly available at
2 We generally recommend special care for proper statistical treatment while working with the data-constrained realizations of
our dark matter void catalog, especially if one wants to use frequentist estimators of void properties.

8.3. Properties of dark matter voids
125
0
5
10
15
20
25
30
35
40
Rv [Mpc/h]
0
1
2
3
4
5
6
7
8
log(n(R > Rv) [(Gpc/h)−3])
SDSS galaxies (dim1 sample)
SDSS galaxies (bright1 sample)
11 borg reconstructions
11 dark matter simulations
Figure 8.3: Cumulative void number functions. The results from 11 borg reconstructions (blue) are compared to a dark
matter N-body simulation (green) and to the galaxy voids directly found in two volume-limited sub-samples of the SDSS
DR7 (dim1, purple and bright1, red). The solid lines are the measured or predicted number functions and the shaded
regions are the 2-σ Poisson uncertainties. Fewer voids are found in observations than in dark matter simulations, due
to the sparsity and bias of tracers, as well as observational uncertainty coming from the survey geometry and selection
eﬀects. Number functions from borg reconstructions agree with simulations at all scales.
http://www.cosmicvoids.net. In particular, we compare to the voids found in the bright1 and dim1 volume-
limited galaxy catalogs, for which the mean galaxy separations are 8 and 3 Mpc/h, respectively (for details, see
Sutter et al., 2012b).
Assessment of our results for dark matter voids in SDSS data also require systematic comparison to dark
matter voids found in cosmological simulations. We ran 11 such unconstrained simulations with the same setup
as described in section 8.2.2 for the generation of data-constrained realizations. We started from Gaussian
random ﬁelds with an Eisenstein & Hu (1998, 1999) power spectrum using the ﬁducial cosmological parameters
of the borg analysis (Ωm
=
0.272, ΩΛ
=
0.728, Ωb
=
0.045, h
=
0.702, σ8
=
0.807, ns
=
0.961,
see chapter 5). These initial density ﬁelds, deﬁned in a 750 Mpc/h cubic box of 2563 voxels, are occupied by a
Lagrangian lattice of 5123 dark matter particles. These are evolved to z = 69 with 2LPT and from z = 69 to
z = 0 with Gadget-2. As for constrained realizations, in our simulations we selected the voids located inside
the observed SDSS volume (see section 8.2.3.2) and combined properties using Blackwell-Rao estimators (see
section 8.2.4).
8.3
Properties of dark matter voids
In this section, we describe the statistical properties of the dark matter voids found in the data-constrained
parts of our reconstructions of the SDSS volume. We focus on three key statistical summaries abundantly
described in the literature: number count, ellipticity distribution and radial density proﬁles.
8.3.1
Number function
The number function of voids provides a simple, easily accessible, and surprisingly sensitive cosmological
probe.
For example, the number function has been shown to respond to coupled dark matter-dark energy
(Li & Zhao, 2009; Sutter et al., 2015a), modiﬁed gravity (Li, Zhao & Koyama, 2012; Clampitt, Cai & Li,
2013), and variations in fundamental cosmological parameters (Pisani et al., 2015). While most studies of the
number function take place in N-body simulations, there has also been signiﬁcant theoretical and analytical
work, beginning with the excursion set formulation of Sheth & van de Weygaert (2004) and continuing through
further enhancements to account for the complex nature of void shapes (Jennings, Li & Hu, 2013). As previous
authors (Müller et al., 2000; Sutter et al., 2012b, 2014d; Nadathur & Hotchkiss, 2014; Nadathur et al., 2014)

126
Chapter 8. Dark matter voids in the SDSS galaxy survey
have noted, there tend to be fewer voids in observations than in numerical simulations, especially for small
voids. This is due to the conjugate eﬀects of sparsity and biasing of tracers, which can modify the number
function in complex ways (Furlanetto & Piran, 2006; Sutter et al., 2014c,d), as well as survey geometries and
selection eﬀects, which can non-trivially diminish the void population. However, recently Sutter et al. (2014d)
showed a correspondence between observed and theoretical number functions once these factors are taken into
account.
Figure 8.3 shows the cumulative void number function in borg reconstructions (blue) compared to dark
matter simulations using the same setup (green) and to galaxy voids in the SDSS DR7 (red and purple). The
conﬁdence regions are 2-σ Poisson uncertainties and the blue and green lines use Blackwell-Rao estimators to
combine the results in 11 realizations.
We can immediately note the excellent agreement between simulations and dark matter voids candidates
in the SDSS as found by our methodology.
The two void populations are almost indistinguishable at all
scales, which demonstrates that the data-constrained number function predicted by our methodology is exactly
that of dark matter voids in numerical simulations. In particular, this proves that our framework correctly
permits to circumvent the eﬀects of sparsity and biasing of SDSS galaxies on void number count.
Indeed,
dark matter voids in our reconstructions are densely-sampled with the same number density as in simulations,
¯n = 0.318 (Mpc/h)−3 (5123 particles in (750 Mpc/h)3) compared to ¯n ≈10−3 (Mpc/h)−3 for SDSS galaxies
(Sutter et al., 2012b).
Furthermore, any incorrect treatment of galaxy bias by the borg algorithm would
result in a residual bias in our reconstructions that would yield an erroneous void number function as compared
to simulations (Sutter et al., 2014c). The absence of any such feature conﬁrms that galaxy bias is correctly
accounted for in our analysis and further validates the framework described in chapter 5 (Jasche, Leclercq &
Wandelt, 2015).
Additionally, due to the high density of tracer particles, we ﬁnd at least around one order of magnitude
more voids at all scales than the voids directly traced by the SDSS galaxies, which sample the underlying mass
distribution only sparsely. This results in a drastic reduction of statistical uncertainty in void catalogs, as we
demonstrate in sections 8.3.2 and 8.3.3.
8.3.2
Ellipticity distribution
The shape distribution of voids is complementary to overdense probes of the dark matter density ﬁeld such
as galaxy clusters. Indeed, as matter collapses to form galaxies, voids expand and can do so aspherically. While
Icke (1984) argued that voids are expected to become more spherical as they expand, Platen, van de Weygaert
& Jones (2008) found that the shape distribution of voids remains complex at late times and showed that
the aspherical expansion of voids is strongly linked to the external tidal inﬂuence.3 Therefore, the shapes of
empty regions generally change during cosmic evolution and retain information on their formation history. In
particular, the void shape distribution potentially serves as a powerful tracer of the equation of state of dark
energy (Lee & Park, 2006; Park & Lee, 2007; Biswas, Alizadeh & Wandelt, 2010; Lavaux & Wandelt, 2012; Bos
et al., 2012). In addition, the mean stretch of voids along the line of sight may be used for an application of the
Alcock-Paczynski test (Alcock & Paczynski, 1979; Ryden, 1995; Lavaux & Wandelt, 2012; Sutter et al., 2012a,
2014a; Hamaus et al., 2014a).
For these applications, it is of crucial importance for the void catalog to be unaﬀected by systematics due
to baryonic physics. Furthermore, as pointed out by Bos et al. (2012), in sparse populations such as galaxies
it is very diﬃcult to statistically separate ΛCDM from alternative cosmologies using void shapes. As we now
show, our framework allows to access void shapes at the level of the dark matter distribution, deeper than with
the galaxies, and to reduce the statistical uncertainty due to their sparsity. Note that all the phase information
and spatial organization of the LSS is unaﬀected by our prior assumptions, which generally aﬀect the density
amplitudes via the cosmological power spectrum. The geometry of voids discussed here is therefore strongly
constrained by the observations.
We simplify the discussion by focusing on the ellipticity, computed by the vide toolkit using the eigenvalues
of the inertia tensor (for details, see section C.1.3.2 and Sutter et al., 2015b). Figure 8.4 shows the mean
ellipticity and the standard error on the mean (i.e. σ/√Nv, where σ is the standard deviation and Nv is the
number of voids) as a function of void eﬀective radius. The red line represents the galaxy voids directly found in
the SDSS data, the blue line the dark matter voids of our data-constrained catalogs, and the green line the voids
3 Tidal eﬀects are taken into account in our analysis since borg models gravitational evolution up to second order in Lagrangian
perturbation theory.

8.3. Properties of dark matter voids
127
5
10
15
20
25
30
35
40
Rv [Mpc/h]
0.00
0.05
0.10
0.15
0.20
0.25
0.30
0.35
0.40
Ellipticity ǫ
SDSS galaxies (bright1 sample) (Nv = 219)
11 borg reconstructions (Nv = 1,835,852)
11 dark matter simulations (Nv = 1,827,821)
Figure 8.4: Distribution of ellipticities ε versus eﬀective radii of voids. The solid line shows the mean, and the shaded
region is the 2-σ conﬁdence region estimated from the standard error on the mean in each radial bin. Small galaxy
voids are found more elliptical than dark matter voids because of important Poisson ﬂuctuations below the mean galaxy
separation (8 Mpc/h). Ellipticities of dark matter voids in borg reconstructions and simulations agree at all scales, and
the statistical uncertainty in their determination is drastically reduced in comparison to galaxy void catalogs.
found in dark matter simulations prepared with the same setup. The blue and green lines use Blackwell-Rao
estimators to combine the results of 11 realizations. For the interpretation of the ellipticity of small galaxy
voids, it is useful to recall that the mean galaxy separation in the bright1 sample is 8 Mpc/h, meaning that
Poisson ﬂuctuations will be of importance for voids whose eﬀective radius is below this scale.
The comparison between dark matter voids of borg reconstructions and of simulations shows that the pre-
dicted ellipticities fully agree with the expectations at all scales. This further demonstrates that our candidates
qualify as dark matter voids as deﬁned by numerical simulations, in particular alleviating the galaxy bias prob-
lem. Furthermore, as already noted, our inference framework produces many more voids than sparse galaxy
catalogs, especially at small scales. This results in a radical reduction of statistical uncertainty in the ellipticity
prediction for small dark matter voids as compared to galaxy voids, as can be observed in ﬁgure 8.4.
8.3.3
Radial density proﬁles
The radial density proﬁle of voids, reconstructed in real space using techniques such as those described in
Pisani et al. (2014), can be used to test general relativity and constrain dynamical dark energy models (Shoji &
Lee, 2012; Spolyar, Sahlén & Silk, 2013). More generally, it shows a self-similar structure (Colberg et al., 2005;
Ricciardelli, Quilis & Varela, 2014; Hamaus, Sutter & Wandelt, 2014; Nadathur et al., 2014), and characterizes
the LSS in a fundamental way (van de Weygaert & van Kampen, 1993). All results presented in this section
assume that dark matter particles in borg reconstructions and in simulations live in physical space.
The
borg algorithm automatically mitigates redshift-space distortions by treating anisotropic features in the data
as noise (Jasche, Leclercq & Wandelt, 2015). Furthermore, as pointed out by Padilla, Ceccarelli & Lambas
(2005), redshift-space distortions have very mild eﬀects on void density proﬁles. We therefore expect our results
to be robust under the transformation from real to redshift space.
Using vide, we construct the one-dimensional radial density proﬁles of stacked voids for various void sizes.
Note that we do not apply any rescaling to the void sizes as we stack. Figure 8.5 shows two such proﬁles, for
voids of eﬀective radius in the range 6-8 Mpc/h (left panel) and 20-25 Mpc/h (right panel). The solid lines
show the mean and the shaded regions are the 2-σ conﬁdence regions estimated from the standard error on the
mean, using Blackwell-Rao estimators for borg reconstructions and dark matter simulations. At the level of
statistical error in our results, our reconstructions show radial density proﬁles in agreement with simulations
at all radii and for all void sizes. Note that, if small voids essentially reﬂect the prior information used for the
borg analysis and N-body ﬁltering, bigger voids are strongly constrained by the data. The proﬁle shapes agree

128
Chapter 8. Dark matter voids in the SDSS galaxy survey
0.0
0.5
1.0
1.5
2.0
2.5
3.0
r/ ˜R
−1.0
−0.8
−0.6
−0.4
−0.2
0.0
0.2
0.4
ρ(r)/¯ρ −1
Rv = 6-8 Mpc/h
SDSS galaxies (bright1 sample) (Nv = 28)
11 borg reconstructions (Nv = 192,014)
11 dark matter simulations (Nv = 192,255)
0.0
0.5
1.0
1.5
2.0
2.5
3.0
r/ ˜R
−1.0
−0.8
−0.6
−0.4
−0.2
0.0
0.2
0.4
ρ(r)/¯ρ −1
Rv = 20-25 Mpc/h
SDSS galaxies (bright1 sample) (Nv = 17)
11 borg reconstructions (Nv = 1,771)
11 dark matter simulations (Nv = 1,853)
Figure 8.5: One-dimensional radial density proﬁles of stacked voids, for voids of eﬀective radius in the range 6-8 Mpc/h
(left) and 20-25 Mpc/h (right).
˜R corresponds to the median void size in the stack. The solid line shows the mean,
and the shaded region is the 2-σ conﬁdence region estimated from the standard error on the mean in each radial bin.
Galaxy void proﬁles are strongly noise-dominated, contrary to dark matter voids. The heights of compensation ridges are
diﬀerent because dark matter voids are identiﬁed in a higher density of tracers, which induces a deeper void hierarchy.
nicely with the results of Sutter et al. (2014c); Hamaus, Sutter & Wandelt (2014) from dark matter simulations:
higher ridges and lower central densities in smaller voids. Speciﬁcally, our reconstructions exhibit the same
behaviour as simulations, with a transition scale between small overcompensated to large undercompensated
voids (Ceccarelli et al., 2013; Paz et al., 2013; Cai et al., 2014; Hamaus et al., 2014b).
In contrast, galaxy void proﬁles at the same scales are strongly noise-dominated. This is due to the sparsity
and biasing of galaxies, which are alleviated with the present approach. In particular, our methodology performs
a meaningful compromise between data and prior information, which predicts corrected shapes and smaller
variance for the proﬁles of dark matter voids as compared to galaxy voids. Note that at the same physical scales
(e.g. 20 Mpc/h), galaxy voids and dark matter voids have diﬀerent ridge heights. This is because a deeper
void hierarchy emerges in higher tracer sampling densities, aﬀecting the compensation of voids at a given size
(Sutter et al., 2014c).
In addition to the location of all dark matter particles, our inference framework also provides their individual
velocity vectors, which are predicted from gravitational clustering. While the direct measurement of individual
galaxy velocities is very diﬃcult in most observations, our reconstruction technique readily allows to infer the
velocity proﬁle of voids. This allows to make a connection between a static (based on the density proﬁles) and
a dynamic (based on the velocity proﬁles) characterization of voids. In particular, as mentioned before, our
results agree with the existence of a transition scale between two regimes: undercompensated, inﬂowing voids
and overcompensated, outﬂowing voids, respectively known as void-in-cloud and void-in-void in the terminology
originally introduced by Sheth & van de Weygaert (2004).
8.4
Summary and conclusions
This chapter is an example of the rich variety of scientiﬁc results that have been produced by the recent
application (Jasche, Leclercq & Wandelt, 2015) of the Bayesian inference framework borg (Jasche & Wandelt,
2013a) to the Sloan Digital Sky Survey main sample galaxies. We proposed a method designed to ﬁnd dark
matter void candidates in the Sloan volume. In doing so, we proved that physical voids in the dark matter
distribution can be correctly identiﬁed by the ab initio analysis of galaxy surveys.
Our method relies on the physical inference of the initial conditions for the entire LSS (Jasche & Wandelt,
2013a; Jasche, Leclercq & Wandelt, 2015). Starting from these, we generated realizations of the LSS using a fully
non-linear cosmological code. In this fashion, as described in section 8.2.2, we obtained a set of data-constrained
reconstructions of the present-day dark matter distribution. The use of fully non-linear dynamics as a ﬁlter
allowed us to extrapolate the predictions of borg to the unconstrained non-linear regimes and to obtain an

8.4. Summary and conclusions
129
accurate description of structures. As described in section 8.2.3, we identiﬁed the voids in these reconstructions
using the void ﬁnder of the vide pipeline (Sutter et al., 2015b) and applied an additional selection criterion
to limit the ﬁnal catalogs of dark matter voids candidates to regions covered by observations. To check that
these candidates qualify for physical voids, we analyzed our catalogs in terms of a set of statistical diagnostics.
We focused on three key void statistics, well understood both in data and in simulations, provided by the vide
toolkit: number function, ellipticity distribution and radial density proﬁle. As mentioned in section 8.2.5, for
comparison of our results, we used the void catalog of Sutter et al. (2012b), directly based on SDSS main sample
galaxies, and unconstrained dark matter simulations produced with the same setup as our reconstructions.
For quantifying the uncertainty, we adopted the same Bayesian philosophy as in the LSS inference framework:
several void catalogs are produced, based on diﬀerent samples of the borg posterior probability distribution
function. Each of them represents a realization of the actual dark matter voids in the Sloan volume, and the
variation between these catalogs quantiﬁes the remaining uncertainties of various sources (in particular, survey
geometry and selection eﬀects, see chapter 5 for a complete discussion). In order to produce a statistically
meaningful combination of our diﬀerent dark matter void catalogs, in section 8.2.4, we introduced Blackwell-
Rao estimators. We showed that the combination of diﬀerent realizations generally yields an improved estimator
for any original void statistic.
For all usual void statistics (number function in section 8.3.1, ellipticity distribution in section 8.3.2 and
radial density proﬁles in section 8.3.3), we found remarkably good agreement between predictions for dark
matter voids in our reconstructions and expectations from numerical simulations. This validates our inference
framework and qualiﬁes the candidates to physically reasonable dark matter voids, probing a level deeper in the
mass distribution hierarchy than galaxies. Further, since sparsity and biasing of tracers modify these statistics
(Sutter et al., 2014c), it means that these eﬀects have been correctly accounted for in our analysis. Indeed,
in chapter 5 we showed that borg accurately accounts for luminosity-dependent galaxy bias and performs
automatic calibration of the noise level within a fully Bayesian approach. Building on the detailed representation
of initial density ﬁelds, our reconstructions possess a high density of tracers, ¯n = 0.318 (Mpc/h)−3, contrary to
galaxies, which sample the underlying mass distribution only sparsely (¯n ≈10−3 (Mpc/h)−3).
Another important aspect of our methodology is that the use of full-scale physical density ﬁelds instead of a
scarce population of galaxies allows to adjust the density of tracers to reduce shot noise at the desired level. In
our analysis, we found at least one order of magnitude more voids at all scales. This yields a radical reduction
of statistical uncertainty in noise-dominated void catalogs, as we have shown for ellipticity distributions and
density proﬁles.
In summary, our methodology permits to alleviate the issues due to the conjugate and intricate eﬀects of
sparsity and biasing on galaxy void catalogs, to drastically reduce statistical uncertainty in void statistics, and
yields new catalogs of dark matter voids for a variety of cosmological applications. For example, these enhanced
data sets can be used for cross-correlation with other cosmological probes such as the cosmic microwave back-
ground, to study the integrated Sachs-Wolfe eﬀect, or gravitational lensing shear maps. Along with the ensemble
mean density ﬁeld and corresponding standard deviations inferred by borg, published as supplementary mate-
rial with Jasche, Leclercq & Wandelt (2015), we believe that the catalogs of our dark matter voids candidates
in the Sloan volume can be of interest to the scientiﬁc community. For this reason, all the void catalogs used to
produce the results described in this chapter have been made publicly available at http://www.cosmicvoids.net,
along with the paper corresponding to this chapter (Leclercq et al., 2015).
Our Bayesian methodology, based on inference with borg and subsequent non-linear ﬁltering of the results,
assumes some prior information, namely the standard ΛCDM cosmological framework and initially Gaussian
density ﬂuctuations. We want to emphasize that any analysis using our constrained catalogs will be biased
toward the conﬁrmation of these assumptions.
Therefore, this method will be only applicable if the data
contain suﬃcient support for the presence of non-standard cosmology to overrule the preference for ΛCDM and
Gaussianity in our prior. However, any signiﬁcant departure from standard cosmology means that the prior has
been overridden by the likelihood and that such deviations really are supported by the data.
While the recommendations of Sutter et al. (2014c) for quantifying and disentangling the eﬀects of sparsity
and biasing depend on speciﬁc survey details, our inference framework is extremely general. It allows to translate
void statistics from current and future galaxy surveys to theory-like, high-resolution dark matter predictions.
In this fashion, it is straightforward to decide if any particular void statistic can be directly informative about
cosmology. These results indicate a new promising path towards eﬀective and precise void cosmology at the
level of the dark matter ﬁeld.


Chapter 9
Bayesian analysis of the dynamic cosmic
web in the SDSS galaxy survey
“I just wonder how things were put together.”
— Claude Shannon
Contents
9.1
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
132
9.2
Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
134
9.2.1
Bayesian large-scale structure inference with BORG
. . . . . . . . . . . . . . . . . . . . . . 134
9.2.2
Non-linear ﬁltering of samples with COLA
. . . . . . . . . . . . . . . . . . . . . . . . . . . 135
9.2.3
Classiﬁcation of the cosmic web . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135
9.3
The late-time large-scale structure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
136
9.3.1
Tidal environment . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136
9.3.2
Probabilistic web-type cartography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 137
9.3.3
Volume and mass ﬁlling fractions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 140
9.4
The primordial large-scale structure . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
141
9.4.1
Tidal environment . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142
9.4.2
Probabilistic web-type cartography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142
9.4.3
Volume and mass ﬁlling fractions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143
9.5
Evolution of the cosmic web . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
143
9.5.1
Evolution of the probabilistic maps . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147
9.5.2
Volume ﬁlling fraction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147
9.5.3
Mass ﬁlling fraction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147
9.6
Summary and Conclusion
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
148
Abstract
Recent application of the Bayesian algorithm borg to the Sloan Digital Sky Survey main sample galaxies resulted
in the physical inference of the formation history of the observed large-scale structure from its origin to the present
epoch. In this work, we use these inferences as inputs for a detailed probabilistic cosmic web-type analysis. To do
so, we generate a large set of data-constrained realizations of the large-scale structure using a fast, fully non-linear
gravitational model.
We then perform a dynamic classiﬁcation of the cosmic web into four distinct components
(voids, sheets, ﬁlaments, and clusters) on the basis of the tidal ﬁeld. Our inference framework automatically and self-
consistently propagates typical observational uncertainties to web-type classiﬁcation. As a result, this study produces
accurate cosmographic classiﬁcation of large-scale structure elements in the SDSS volume.
By also providing the
history of these structure maps, the approach allows an analysis of the origin and growth of the early traces of the
cosmic web present in the initial density ﬁeld and of the evolution of global quantities such as the volume and mass
ﬁlling fractions of diﬀerent structures. For the problem of web-type classiﬁcation, the results described in this chapter
constitute the ﬁrst connection between theory and observations at non-linear scales including a physical model of
structure formation and the demonstrated capability of uncertainty quantiﬁcation. A connection between cosmology
and information theory using real data also naturally emerges from our probabilistic approach. Our results constitute
quantitative chrono-cosmography of the complex web-like patterns underlying the observed galaxy distribution.
This chapter is adapted from its corresponding publication, Leclercq, Jasche & Wandelt (2015c).

132
Chapter 9. Bayesian analysis of the dynamic cosmic web in the SDSS galaxy survey
9.1
Introduction
The large-scale distribution of matter in the Universe is known to form intricate, complex patterns traced
by galaxies.
The existence of this large-scale structure, also known as the cosmic web (Bond, Kofman &
Pogosyan, 1996), has been suggested by early observational projects aiming at mapping the Universe (Gregory
& Thompson, 1978; Kirshner et al., 1981; de Lapparent, Geller & Huchra, 1986; Geller & Huchra, 1989; Shectman
et al., 1996), and has been extensively analyzed since then by massive surveys such as the 2dFGRS (Colless
et al., 2003), the SDSS (e.g. Gott et al., 2005) or the 2MASS redshift survey (Huchra et al., 2012). The cosmic
web is usually segmented into diﬀerent elements: voids, sheets, ﬁlaments, and clusters. At late times, low-
density regions (voids) occupy most of the volume of the Universe. They are surrounded by walls (or sheets)
from which departs a network of denser ﬁlaments. At the intersection of ﬁlaments lie the densest clumps of
matter (clusters). Dynamically, matter tends to ﬂow out of the voids to their compensation walls, transits
through ﬁlaments and ﬁnally accretes in the densest halos.
Describing the cosmic web morphology is an involved task due to the intrinsic complexity of individual
structures, but also to their connectivity and the hierarchical nature of their global organization. First ap-
proaches (e.g. Barrow, Bhavsar & Sonoda, 1985; Gott, Dickinson & Melott, 1986; Babul & Starkman, 1992;
Mecke, Buchert & Wagner, 1994; Sahni, Sathyaprakash & Shandarin, 1998) often characterized the LSS with a
set of global and statistical diagnostics, without providing a way to locally identify cosmic web elements. In the
last decade, a variety of methods has been developed for segmenting the LSS into its components and applied
to numerical simulations and observations. Among them, some focus on investigating one component at a time,
in particular ﬁlaments (e.g. the Candy model – Stoica et al., 2005; Stoica, Martínez & Saar, 2007, 2010, the
skeleton analysis – Novikov, Colombi & Doré, 2006; Sousbie et al., 2008, and DisPerSE – Sousbie, 2011; Sousbie,
Pichon & Kawahara, 2011) or voids (e.g. Plionis & Basilakos, 2002; Colberg et al., 2005; Shandarin et al., 2006;
Platen, van de Weygaert & Jones, 2007; Neyrinck, 2008; Sutter et al., 2015b; Elyiv et al., 2015, see also Colberg
et al., 2008 for a void ﬁnder comparison project). Unfortunately, this approach does not allow an analysis of
the connections between cosmic web components, identiﬁed in the same framework. Another important class
of web classiﬁers dissects clusters, ﬁlaments, walls, and voids at the same time. In particular, several recent
studies deserve special attention due to their methodological richness. The “T-web” and “V-web” (Hahn et al.,
2007a; Forero-Romero et al., 2009; Hoﬀman et al., 2012) characterize the cosmic web based on the tidal and
velocity shear ﬁelds. diva (Lavaux & Wandelt, 2010) rather uses the shear of the Lagrangian displacement ﬁeld.
origami (Falck, Neyrinck & Szalay, 2012) identiﬁes single and multi-stream regions in the full six-dimensional
phase-space information (Abel, Hahn & Kaehler, 2012; Neyrinck, 2012; Shandarin, Habib & Heitmann, 2012).
The Multiscale Morphology Filter (Aragón-Calvo et al., 2007) and later reﬁnements nexus/nexus+ (Cautun,
van de Weygaert & Jones, 2013) follow a multiscale approach which probes the hierarchical nature of the cosmic
web.
In the standard theoretical picture, the cosmic web arises from the anisotropic nature of gravitational
collapse, which drives the formation of structure in the Universe from primordial ﬂuctuations (Peebles, 1980).
The capital importance of the large-scale tidal ﬁeld in the formation and evolution of the cosmic web was
ﬁrst pointed out in the seminal work of Zel’dovich (1970).
In the Zel’dovich approximation, the late-time
morphology of structures is linked to the eigenvalues of the tidal tensor in the initial conditions. Gravitational
collapse ampliﬁes any anisotropy present in the primordial density ﬁeld to give rise to highly asymmetrical
structures.
This picture explains the segmented nature of the LSS, but not its connectivity.
The cosmic
web theory of Bond, Kofman & Pogosyan (1996) asserted the deep connection between the tidal ﬁeld around
rare density peaks in the initial ﬂuctuations and the ﬁnal web pattern, in particular the ﬁlamentary cluster-
cluster bridges. More generally, the shaping of the cosmic web through gravitational clustering is essentially
a deterministic process described by Einstein’s equations and the main source of stochasticity in the problem
enters in the generation of initial conditions, which are known, from inﬂationary theory, to resemble a Gaussian
random ﬁeld to very high accuracy (Guth & Pi, 1982; Hawking, 1982; Bardeen, Steinhardt & Turner, 1983).
For these reasons, considerable eﬀort has been devoted to a theoretical understanding of the LSS in terms of
perturbation theory in the Eulerian and Lagrangian frames (for a review, see Bernardeau et al., 2002). While
this approach oﬀers important analytical insights, it only permits to describe structure formation in the linear
and mildly non-linear regimes and it is usually limited to the ﬁrst few correlation functions of the density ﬁeld.
The complete description of the connection between primordial ﬂuctuations and the late-time LSS, including
a full phase-space treatment and the entire hierarchy of correlators, has to rely on a numerical treatment
through N-body simulations. The characterization of cosmic web environments in the non-linear regime and

9.1. Introduction
133
the description of their time evolution has only been treated recently, following the application of web classiﬁers
to state-of-the-art simulations. In particular, Hahn et al. (2007a); Aragón-Calvo, van de Weygaert & Jones
(2010) presented a local description of structure types in high-resolution cosmological simulations. Hahn et al.
(2007b); Bond, Strauss & Cen (2010); Cautun et al. (2014) analyzed the time evolution of the cosmic web in
terms of the mass and volume content of web-type components, their density distribution, and a set of new
analysis tools especially designed for particular elements.
To the best of our knowledge, neither the classiﬁcation of cosmic environments at non-linear scales in physical
realizations of the LSS nor the investigation of their genesis and growth, using real data and with demonstrated
capability of uncertainty quantiﬁcation, have been treated in the existing literature. In this work, we propose
the ﬁrst probabilistic web-type analysis conducted with observational data in the deeply non-linear regime
of LSS formation. We build accurate maps of dynamic cosmic web components with a resolution of around
3 Mpc/h, constrained by observations. In addition, our approach leads to the ﬁrst quantitative inference of
the formation history of these environments and allows the construction of maps of the embryonic traces in the
initial perturbations of the late-time morphological features of the cosmic web.
Cosmographic descriptions of the LSS in terms of three-dimensional maps, and in particular a dynamic struc-
ture type cartography carry potential for a rich variety of applications. Such maps characterize the anisotropic
nature of gravitational structure formation, the clustering behavior of galaxies as a function of their tidal envi-
ronment and permit to describe the traces of the cosmic web already imprinted in the initial conditions. So far,
most investigations focused on understanding the physical properties of dark halos and galaxies in relation to
the LSS. Hahn et al. (2007a,b, 2009); Hahn, Angulo & Abel (2014); Aragón-Calvo, van de Weygaert & Jones
(2010) found a systematic dependence of halo properties such as morphological type, color, luminosity and
spin parameter on their cosmic environment (local density, velocity and tidal ﬁeld). In addition, a correlation
between halo shapes and spins and the orientations of nearby ﬁlaments and sheets, predicted in simulations
(Altay, Colberg & Croft, 2006; Hahn et al., 2007a,b, 2009; Paz, Stasyszyn & Padilla, 2008; Zhang et al., 2009;
Codis et al., 2012; Libeskind et al., 2013; Welker et al., 2014; Aragon-Calvo & Yang, 2014; Laigle et al., 2015),
has been conﬁrmed by observational galaxy data (Paz, Stasyszyn & Padilla, 2008; Jones, van de Weygaert &
Aragón-Calvo, 2010; Tempel, Stoica & Saar, 2013; Zhang et al., 2013). Cartographic descriptions of the cosmic
web also permit to study the environmental dependence of galaxy properties (see e.g. Lee & Lee, 2008; Lee &
Li, 2008; Park, Kim & Park, 2010; Yan, Fan & White, 2012; Kovač et al., 2014) and to make the connection be-
tween the sophisticated predictions for galaxy properties in hydrodynamic simulations (e.g. Vogelsberger et al.,
2014; Dubois et al., 2014; Codis et al., 2015) and observations. Another wide range of applications of structure
type reconstructions is to probe the eﬀect of the inhomogeneous large-scale structure on photon properties and
geodesics. For example, it is possible to interpret the weak gravitational lensing eﬀects of voids (Melchior et al.,
2014; Clampitt & Jain, 2014). Dynamic information can also be used to produce prediction templates for sec-
ondary eﬀects expected in the cosmic microwave background such as the kinetic Sunyaev-Zel’dovich eﬀect (Li
et al., 2014), the integrated Sachs-Wolfe and Rees-Sciama eﬀects (e.g. Cai et al., 2010; Ilić, Langer & Douspis,
2013; Planck Collaboration, 2014a). Lastly, as the cosmic web morphology arises from gravitational instability,
it can be used to test general relativity (Falck, Koyama & Zhao, 2015).
Building such reﬁned cosmographic descriptions of the Universe requires high-dimensional, non-linear infer-
ences. In chapter 5 (Jasche, Leclercq & Wandelt, 2015), we presented a chrono-cosmography project, aiming
at reconstructing simultaneously the density distribution, the velocity ﬁeld and the formation history of the
LSS from galaxies. To do so, we used an advanced Bayesian inference algorithm to assimilate the Sloan Digital
Sky Survey DR7 data into the forecasts of a physical model of structure formation (second order Lagrangian
perturbation theory). Besides inferring the four-dimensional history of the matter distribution, these results
permit us an analysis of the genesis and growth of the complex web-like patterns that have been observed in
our Universe. Therefore, this work constitutes a new chrono-cosmography project, aiming at the analysis of the
evolving cosmic web.
Our investigations rely on the inference of the initial conditions in the SDSS volume (see chapter 5). Starting
from these, we generate a large set of constrained realizations of the Universe using the cola method (Tassev,
Zaldarriaga & Eisenstein, 2013, see also section 7.3.1).
This physical model allows us to perform the ﬁrst
description of the cosmic web in the non-linear regime, using real data, and to follow the time evolution
of its constituting elements. Throughout this chapter, we adopt the Hahn et al. (2007a) dynamic “T-web”
classiﬁer, which segments the LSS into voids, sheets, ﬁlaments, and clusters. This choice is motivated by the
close relation between the equations that dictate the dynamics of the growth of structures in the Zel’dovich
formalism and the Lagrangian description of the LSS which naturally emerges with borg. As this procedure

134
Chapter 9. Bayesian analysis of the dynamic cosmic web in the SDSS galaxy survey
relies on the estimation of the eigenvalues of the tidal tensor in Fourier space, it constitutes a non-linear and
non-local estimator of structure types, requiring adequate means to propagate observational uncertainties to
ﬁnally inferred products (web-type maps and all derived quantities), in order not to misinterpret results. The
borg algorithm naturally addresses this problem by providing a set of density realizations constrained by the
data. The variation between these samples constitute a thorough quantiﬁcation of uncertainty coming from all
observational eﬀects (in particular the incompleteness of the data because of the survey mask and the radial
selection functions, as well as luminosity-dependent galaxy biases, see chapter 5 for details), not only with a
point estimation but with a detailed treatment of the likelihood. Hence, for all problems addressed in this
work, we get a fully probabilistic answer in terms of a prior and a posterior distribution. Building upon the
robustness of our uncertainty quantiﬁcation procedure, we are able to make the ﬁrst observationally-supported
link between cosmology and information theory (see Neyrinck, 2015b, for theoretical considerations related to
this question) by looking at the entropy and Kullback-Leibler divergence of probability distribution functions.
This chapter is organized as follows. In section 9.2, we describe our methodology: Bayesian large-scale
structure inference with the borg algorithm, non-linear ﬁltering of samples with cola and web-type classiﬁca-
tion using the T-web procedure. In sections 9.3 and 9.4, we describe the cosmic web at present and primordial
times, respectively. In section 9.5, we follow the time evolution of web-types as structures form in the Universe.
Finally, we summarize our results and oﬀer concluding comments in section 9.6.
9.2
Methods
In this section, we describe our methodology step by step:
1. inference of the initial conditions with borg (section 9.2.1),
2. generation of data-constrained realizations of the SDSS volume via non-linear ﬁltering of borg samples
with cola (section 9.2.2),
3. classiﬁcation of the cosmic web in voids, sheets, ﬁlaments, and clusters, using the T-web algorithm (section
9.2.3).
9.2.1
Bayesian large-scale structure inference with BORG
This work builds upon results previously obtained by application of the borg (Bayesian Origin Reconstruc-
tion from Galaxies, Jasche & Wandelt, 2013a) algorithm to the Sloan Digital Sky Survey data release 7 (Jasche,
Leclercq & Wandelt, 2015). borg is a full-scale Bayesian inference code which permits to simultaneously analyze
morphology and formation history of the cosmic web (see chapters 4 and 5 for a complete description).
As discussed in Jasche & Wandelt (2013a), accurate and detailed cosmographic inferences from observations
require modeling the mildly non-linear and non-linear regime of the presently observed matter distribution. The
exact statistical behavior of the LSS in terms of a full probability distribution function for non-linearly evolved
density ﬁelds is not known.
For this reason, the ﬁrst full-scale reconstructions relied on phenomenological
approximations, such as multivariate Gaussian or log-normal distributions, incorporating a cosmological power
spectrum to accurately represent correct two-point statistics of density ﬁelds (see e.g. Lahav et al., 1994;
Zaroubi, 2002; Erdoˇgdu et al., 2004; Kitaura & Enßlin, 2008; Kitaura et al., 2009; Kitaura, Jasche & Metcalf,
2010; Jasche & Kitaura, 2010; Jasche et al., 2010b,a). However, these prescriptions only model the one and
two-point statistics of the matter distribution. Additional statistical complexity of the evolved density ﬁeld
arises from the fact that gravitational structure formation introduces mode coupling and phase correlations.
This manifests itself not only in a sheer amplitude diﬀerence of density and velocity ﬁelds at diﬀerent redshifts,
but also in a modiﬁcation of their statistical behavior by the generation of higher-order correlation functions.
An accurate modeling of these high-order correlators is of crucial importance for a precise description of the
connectivity and hierarchical nature of the cosmic web, which is the aim of this chapter.
While the statistical nature of the late-time density ﬁeld is poorly understood, the initial conditions from
which it formed are known to obey Gaussian statistics to very great accuracy (Planck Collaboration, 2015).
Therefore, it is reasonable to account for the increasing statistical complexity of the evolving matter distribution
by a dynamical model of structure formation linking initial and ﬁnal conditions.
This naturally turns the
problem of LSS analysis to the task of inferring the initial conditions from present cosmological observations
(Jasche & Wandelt, 2013a; Kitaura, 2013; Wang et al., 2013). This approach yields a very high-dimensional

9.2. Methods
135
and non-linear inference problem. Typically, the parameter space to explore comprises on the order of 106 to
107 elements, corresponding to the voxels of the map to be inferred. For reasons linked to computational cost,
the borg algorithm employs 2LPT as an approximation for the actual gravitational dynamics linking initial
three-dimensional Gaussian density ﬁelds to present, non-Gaussian density ﬁelds. As known from perturbation
theory (see e.g. Bernardeau et al., 2002), in the linear and mildly non-linear regime, 2LPT correctly describes
the one-, two- and three-point statistics of the matter distribution and also approximates very well higher-
order correlators. It accounts in particular for tidal eﬀects in its regime of validity. Consequently, the borg
algorithm correctly transports the observational information corresponding to complex web-like features from
the ﬁnal density ﬁeld to the corresponding initial conditions. Note that such an explicit Bayesian forward-
modeling approach is always more powerful than constraining (part of) the sequence of correlation functions,
as it accounts for the entire dark matter dynamics (in particular for the inﬁnite hierarchy of correlators), in its
regime of validity. This is of particular importance, since the hierarchy of correlation functions has been shown
to be an insuﬃcient description of density ﬁelds in the non-linear regime (Carron, 2012; Carron & Neyrinck,
2012).
As discussed in chapter 5 (Jasche, Leclercq & Wandelt, 2015), our analysis comprehensively accounts for
observational eﬀects such as selection functions, survey geometry, luminosity-dependent galaxy biases and
noise. Corresponding uncertainty quantiﬁcation is provided by sampling from the high-dimensional posterior
distribution via an eﬃcient implementation of the Hamiltonian Markov Chain Monte Carlo method (see chapter
4 and Jasche & Wandelt, 2013a, for details). In particular, luminosity-dependent galaxy biases are explicitly
part of the borg likelihood and the bias amplitudes are inferred self-consistently during the run.
Though
not explicitly modeled, redshift-space distortions are automatically mitigated: due to the prior preference for
homogeneity and isotropy, such anisotropic features are treated as noise in the data.
In the following, we make use of the 12, 000 samples of the posterior distribution for primordial density ﬁelds,
obtained in chapter 5. These reconstructions, constrained by SDSS observations, act as initial conditions for
the generation of constrained large-scale structure realizations. It is important to note that we directly make
use of borg outputs without any further post-processing, which demonstrates the remarkable quality of our
inference results.
9.2.2
Non-linear ﬁltering of samples with COLA
In section 2.3 (Leclercq et al., 2013, section 2.A), we performed a study of diﬀerences in the representation
of structure types in density ﬁelds predicted by LPT and N-body simulations. To do so, we used the same
web-type classiﬁcation procedure as in this work (see sections 9.2.3 and C.2). In spite of the visual similarity
of LPT and N-body density ﬁelds at large and intermediate scales (above a few Mpc/h), we found crucial
diﬀerences in the representation of structures. Speciﬁcally, LPT predicts fuzzier halos than full gravity, and
incorrectly assigns the surroundings of voids as part of them. This manifests itself in an overprediction of the
volume occupied by clusters and voids at the detriment of sheets and ﬁlaments. The substructure of voids is
also known to be incorrectly represented in 2LPT (Sahni & Shandarin, 1996; Neyrinck, 2013; Leclercq et al.,
2013).
For these reasons, in this chapter we cannot directly make use of the ﬁnal borg density samples, which
are a prediction of the 2LPT model. Instead, we rely on the inferred initial conditions, which contain the data
constraints (as described in chapter 5) and on a non-linear ﬁltering step (see chapter 7) similar to the one
described in chapter 8 (Leclercq et al., 2015). Due to the large number of samples to be processed for this work,
we do not use a fully non-linear simulation code as in chapter 8, but the cola method (Tassev, Zaldarriaga &
Eisenstein, 2013, see also section 7.3.1).
The generation of the set of non-linear borg-cola samples, used in this chapter, is described in section
7.3.2.
9.2.3
Classiﬁcation of the cosmic web
The borg ﬁltered reconstructions permit a variety of scientiﬁc analyses of the large scale structure in the
observed Universe. In this work, we focus speciﬁcally on the possibility to characterize the cosmic web by
distinct structure types. Generally, any of the methods cited in the introduction (section 9.1) can be employed
for analysis of our density samples, however for the purpose of this chapter, we follow the “T-web” classiﬁcation
procedure as proposed by Hahn et al. (2007a), described in section C.2.

136
Chapter 9. Bayesian analysis of the dynamic cosmic web in the SDSS galaxy survey
The basic idea of this dynamical classiﬁcation approach is that the eigenvalues µ1 ≤µ2 ≤µ3 of the tidal
tensor Tij ≡H(˜Φ)ij (Hessian of the rescaled gravitational potential) characterize the geometrical properties of
each point in space. With these deﬁnitions, the three eigenvalues of the tidal tensor form a decomposition of
the density contrast ﬁeld, in the sense that the trace of T is µ1 + µ2 + µ3 = δ. Each spatial point can then be
classiﬁed as a speciﬁc web type by considering the signs of µ1, µ2, µ3, according to the rules given in table C.1.
Several extensions of this classiﬁcation procedure exist, that permit diﬀerent classiﬁcation up to sub-
megaparsec scales (see section C.2.4).
In this work, we will probe scales down to ∼3 Mpc/h (the voxel
size in our reconstructions). Therefore, we will be content with the original classiﬁcation procedure as proposed
by Hahn et al. (2007a).
It is important to note that the tidal tensor and the rescaled gravitational potential are both physical
quantities, and hence their calculation requires the availability of a full physical density ﬁeld in contrast to a
smoothed mean reconstruction of the density ﬁeld. As described in chapter 5, density samples obtained by
the borg algorithm provide such required full physical density ﬁelds. The tidal tensor can therefore easily
be calculated in each density sample from the Fourier space representations of equations (C.6) and (C.7) (see
section C.2.5 and Hahn et al., 2007a; Forero-Romero et al., 2009, for details on the technical implementation).
The web classiﬁer provides four voxel-wise scalar ﬁelds that characterize the large scale structure. In a
speciﬁc realization, the answer is unique, meaning that these ﬁelds obey the following conditions at each voxel
position ⃗xk:
Ti(⃗xk) ∈{0, 1} for i ∈J0, 3K
and
3
X
i=0
Ti(⃗xk) = 1
(9.1)
where T0 = void, T1 = sheet, T2 = ﬁlament, T3 = cluster. In this work, we follow the Bayesian approach of
Jasche, Leclercq & Wandelt (2015) and quantify the degree of belief in structure type classiﬁcation. Speciﬁcally,
our web classiﬁcation is given in terms of four voxel-wise scalar ﬁelds that obey the following conditions at each
voxel position ⃗xk:
Ti(⃗xk) ∈[0, 1] for i ∈J0, 3K
and
3
X
i=0
Ti(⃗xk) = 1.
(9.2)
Here, Ti(⃗xk) ≡⟨Ti(⃗xk)⟩P(Ti(⃗xk)|d) = P(Ti(⃗xk)|d) are the posterior probabilities indicating the possibility to
encounter speciﬁc structure types at a given position in the observed volume, conditional on the data. These
are estimated by applying the web classiﬁcation to all density samples and counting the relative frequencies at
each individual spatial coordinate within the set of samples (see section 5 in Jasche et al., 2010b). With this
deﬁnition, the cosmic web-type posterior mean is given by
⟨P(Ti(⃗xk)|d)⟩= 1
N
N
X
n=1
3
X
j=0
δ
Ti(⃗xk)Tn
j (⃗xk)
K
,
(9.3)
where n labels one of the N samples, Tn
j (⃗xk) is the result of the web classiﬁer on the n-th sample (i.e. a unit
four-vector at each voxel position ⃗xk containing zeros except for one component, which indicates the structure
type), and δab
K is a Kronecker symbol.
9.3
The late-time large-scale structure
In this section, we discuss the results of our analysis of the ﬁnal density ﬁeld, at a = 1. For reasons of
computational time with cola ﬁltering (see section 9.2.2), we kept around 10% of the original set of samples
obtained in chapter 5. In order to mitigate as much as possible the eﬀects of correlation among samples, we
maximally separated the samples kept for the present analysis, keeping one out of ten consecutive samples of
the original Markov Chain. Hence, for all results discussed in this section, we used a total of 1, 097 samples
inferred by borg and ﬁltered with cola.
9.3.1
Tidal environment
As a natural byproduct, the application of the T-web classiﬁer to density samples yields samples of the
pdfs for the three eigenvalues of the tidal ﬁeld tensor. These pdfs account for the assumed physical model
of structure formation and the data constraints, and quantify uncertainty coming in particular from selection

9.3. The late-time large-scale structure
137
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
⟨µ1⟩
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
⟨µ2⟩
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
⟨µ3⟩
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
⟨δ⟩
−10
−5
0
5
10
15
20
25
30
Figure 9.1: Slices through the three-dimensional ensemble posterior mean for the eigenvalues µ1 ≤µ2 ≤µ3 of the tidal
ﬁeld tensor in the ﬁnal conditions, estimated from 1, 097 samples. The rightmost panel shows the corresponding slice
through the posterior mean for the ﬁnal density contrast δ = µ1 + µ2 + µ3, obtained in section 5.3.1.
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
voids
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
sheets
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
ﬁlaments
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
clusters
0.0
0.2
0.4
0.6
0.8
1.0
Figure 9.2: Slices through the posterior mean for diﬀerent structure types (from left to right: void, sheet, ﬁlament, and
cluster) in the late-time large-scale structure in the Sloan volume (a = 1). These four three-dimensional voxel-wise pdfs
sum up to one on a voxel basis.
eﬀects, surveys geometries and galaxy biases. In a similar fashion as described in section 5.3, the ensemble of
samples permits us to provide any desired statistical summary such as mean and variance.
In ﬁgure 9.1, we show slices through the ensemble mean ﬁelds µ1, µ2 and µ3. For visual comparison, the
rightmost panel of ﬁgure 9.1 shows the corresponding slice through the posterior mean of the ﬁnal density
contrast, δ = µ1 + µ2 + µ3, obtained in section 5.3.1. Diﬀerent morphologies can be observed in the data-
constrained parts of these slices: µ1, µ2 and µ3 respectively trace well the clusters, ﬁlaments and sheets, as
we now argue. The µ1 ﬁeld is rather homogeneous, apart for small spots where all eigenvalues are largely
positive, i.e. undergoing dramatic gravitational collapse along three axes. These correspond to the dynamic
clusters. Note that there exists a form of “tidal compensation”: these clusters are surrounded by regions where
µ1 is smaller than its cosmic mean. More patterns can be observed in the µ2 ﬁeld: it also exhibits ﬁlaments
(appearing as dots when piercing the slice). Finally, the µ3 ﬁeld is highly-structured, as it also traces sheets
(which appear ﬁlamentary when sliced). Dynamic voids can also be easily distinguished in this ﬁeld, wherever
µ3 is negative.
9.3.2
Probabilistic web-type cartography
Building upon previous results and using the procedure described in section 9.2.3, we obtain probabilistic
maps of structures. More precisely, we obtain four probability distributions at each spatial position, P(Ti( ⃗xk)|d),
indicating the possibility to encounter a speciﬁc structure type (cluster, ﬁlament, sheet, void) at that position.
As noted in section 9.2.3, these pdfs take their values in the range [0, 1] and sum up to one on a voxel-basis.
Figure 9.2 shows slices through their means (see equation (9.3)). The plot shows the anticipated behavior, with
a high degree of structure and values close to certainty (i.e. zero or one) in regions covered by data, while the
unobserved regions approach a uniform value corresponding to the prior. At this point, it is worth noting that
the T-web classiﬁer has a prior preference for some structure types. Using unconstrained large-scale structure

138
Chapter 9. Bayesian analysis of the dynamic cosmic web in the SDSS galaxy survey
Structure type
µP(Ti)
σP(Ti)
Late-time large-scale structure (a = 1)
Void
0.14261
6.1681 × 10−4
Sheet
0.59561
6.3275 × 10−4
Filament
0.24980
5.5637 × 10−4
Cluster
0.01198
5.8793 × 10−5
Table 9.1: Prior probabilities assigned by the T-web classiﬁer to the diﬀerent structures types, in the late-time large-scale
structure (a = 1).
realizations produced with the same setup,1 we measured that these prior probabilities, P(Ti), can be well
described by Gaussians whose mean and standard deviation are given in table 9.1.
In addition to their ensemble mean, the set of samples permits to propagate uncertainty quantiﬁcation
to web-type classiﬁcation.
In particular, it allows us to locally assess the strength of data constraints.
In
information theory, a convenient way to characterize the uncertainty content of a random source S is the
Shannon entropy (Shannon, 1948), deﬁned by
H [S] ≡−
X
i
pi log2(pi),
(9.4)
where the pi are the probabilities of possible events. This deﬁnition yields expected properties and accounts for
the intuition that the more likely an event is, the less information it provides when it occurs (i.e. the more it
contributes to the source entropy). We follow this prescription and write the voxel-wise entropy of the web-type
posterior, P(T(⃗xk)|d), as
H [P(T(⃗xk)|d)] ≡−
3
X
i=0
P(Ti(⃗xk)|d) log2(P(Ti(⃗xk)|d)).
(9.5)
It is a number in the range [0, 2] and its natural unit is the shannon (Sh). H = 0 Sh in the case of perfect
certainty, i.e. when the data constraints entirely determine the underlying structure type: P(Ti0(⃗xk)|d) is 1 for
one i0 and 0 for i ̸= i0. H reaches its maximum value of 2 Sh when all P(Ti(⃗xk)|d) are equal to 1/4. This is
the case of maximal randomness: all the events being equally likely, no information is gained when one occurs.
A slice through the voxel-wise entropy of the web-type posterior is shown in the left panel of ﬁgure 9.3.
Generally, the entropy map reﬂects the information content of the posterior pdf, which comes from augmenting
the information content of the prior pdf with the data constraints, in the Bayesian way.
The entropy takes low values and shows a high degree of structure in the regions where data constraints
exist, and even reaches zero in some spots where the data are perfectly informative. Comparing with ﬁgures
9.1 and 9.2, one can note that this structure is highly non-trivial and does not follow any of the previously
described patterns. This is due to the facts that in a Poisson process, the signal (here the density, inferred in
section 5.3.1) is correlated with the uncertainty and that structure types classiﬁcation further is a non-linear
function of the density ﬁeld. In the unobserved regions, the entropy ﬂuctuates around a constant value of about
1.4 Sh, which characterizes the information content of the prior. This value is consistent with the expectation,
which can be computed using equation (9.5) (unconditional on the data) and the numbers given in table 9.1.
The information-theoretic quantity that measures the information gain (in shannons) due to the data is the
relative entropy or Kullback-Leibler divergence (Kullback & Leibler, 1951) of the posterior from the prior,
DKL [P(T(⃗xk)|d)∥P(T)]
≡
3
X
i=0
P(Ti(⃗xk)|d) log2
P(Ti(⃗xk)|d)
P(Ti)

=
−H [P(T(⃗xk)|d)] −
3
X
i=0
P(Ti(⃗xk)|d) log2(P(Ti)).
(9.6)
1 By this, we speciﬁcally mean realizations obtained from initial randomly-generated Gaussian density ﬁelds with an Eisenstein
& Hu (1998, 1999) power spectrum using the ﬁducial cosmological parameters of the borg analysis (Ωm = 0.272, Ωµ = 0.728,
Ωb = 0.045, h = 0.702, σ8 = 0.807, ns = 0.961, see equation (5.1)). The density ﬁeld is deﬁned on a 750 Mpc/h cubic grid of
2563-voxels and populated by 5123 dark matter particles, which are evolved to z = 69 with 2LPT and from z = 69 to z = 0 with
cola, using 30 timesteps logarithmically-spaced in the scale factor. The particles are binned on a 2563-voxel grid with the CiC
scheme to get the ﬁnal density ﬁeld.

9.3. The late-time large-scale structure
139
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
0.0
0.2
0.4
0.6
0.8
1.0
1.2
1.4
1.6
1.8
2.0
H [Sh]
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
0.0
0.8
1.6
2.4
3.2
4.0
4.8
5.6
DKL [Sh]
Figure 9.3: Slices through the entropy of the structure types posterior (left panel) and the Kullback-Leibler divergence
of the posterior from the prior (right panel), in the ﬁnal conditions. The entropy H, deﬁned by equation (9.5), quantiﬁes
the information content of the posterior pdf represented in ﬁgure 9.2, which results from fusing the information content
of the prior and the data constraints. The Kullback-Leibler divergence DKL, deﬁned by equation (9.6), represents the
information gained in moving from the prior to the posterior. It quantiﬁes the information that has been learned on
structure types by looking at SDSS galaxies.

140
Chapter 9. Bayesian analysis of the dynamic cosmic web in the SDSS galaxy survey
It is a non-symmetric measure of the diﬀerence between the two probability distributions.
A slice through the voxel-wise Kullback-Leibler divergence of the web-type posterior from the prior is shown
in the right panel of ﬁgure 9.3. As expected, the information gain is zero out of the survey boundaries. In the
observed regions, SDSS galaxies are informative on underlying structure types at the level of at least ∼1 Sh.
This number can go to ∼3 Sh in the interior of deep voids and up to ∼6 Sh in the densest clusters. This map
permits to visualize the regions where additional data would be needed to improve structure type classiﬁcation,
e.g. in some high-redshift regions where uncertainty remains due to selection eﬀects.
9.3.3
Volume and mass ﬁlling fractions
A characterization of large scale environments commonly found in literature involves evaluating global
quantities such as the volume and mass content of these structures. In a particular realization, the volume
ﬁlling fraction (VFF) for structure type Ti is the number of voxels of type Ti divided by the total number of
voxels in the considered volume,
VFF(Ti) ≡
P
⃗xk
P3
j=0 δ
Ti(⃗xk)Tn
j (⃗xk)
K
Nvox
.
(9.7)
The mass ﬁlling fraction (MFF) can be obtained in a similar manner by weighting the same sum by the local
density ρ(⃗xk) = ¯ρ (1 + δ(⃗xk)),
MFF(Ti) ≡
P
⃗xk
P3
j=0(1 + δ(⃗xk))δ
Ti(⃗xk)Tn
j (⃗xk)
K
P
⃗xk(1 + δ(⃗xk))
.
(9.8)
To ensure that results are not prior-dominated, we measured the VFFs and MFFs in the data-constrained
parts of our realizations. More precisely, we limited ourselves to the voxels where the survey response operator
(representing simultaneously the survey geometry and the selection eﬀects, see sections 4.2 and 5.1) is strictly
positive. This amounts to Nvox = 3,148,504 out of 2563 = 16,777,216 voxels, around 18.7% of the full box (see
also section 8.2.3.2 and ﬁgure 8.2). In equations (9.7) and (9.8), ⃗xk labels one of these voxels.
By measuring the VFF and MFF of diﬀerent structure types in each constrained realization of our ensemble,
we obtained the posterior pdfs, P(VFF(Ti)|d) and P(MFF(Ti)|d), conditional on the data.
Similarly, we
computed the prior pdfs, P(VFF(Ti)) and P(MFF(Ti)), using unconstrained realizations produced with the
same setup. We found that all these pdfs can be well described by Gaussians, the mean and variance of which
are given in tables 9.2 and 9.3.
Previous studies on this topic (e.g. Doroshkevich, 1970b; Shen et al., 2006; Hahn et al., 2007a; Forero-
Romero et al., 2009; Jasche et al., 2010b; Aragón-Calvo, van de Weygaert & Jones, 2010; Shandarin, Habib &
Heitmann, 2012; Cautun et al., 2014) have found a wide range of values for the VFF and MFF of structures
(see e.g. table 3 in Cautun et al., 2014). For example, existing studies found that clusters occupy at most a
few percent of the volume of the Universe but contribute signiﬁcantly to the mass content, with a MFF ranging
from ∼10% (Hahn et al., 2007a; Cautun et al., 2014) to ∼40% (Shandarin, Habib & Heitmann, 2012). The
void volume fraction can vary from ∼10% (Hahn et al., 2007a) to ∼80% (Aragón-Calvo, van de Weygaert
& Jones, 2010; Shandarin, Habib & Heitmann, 2012; Cautun et al., 2014); in the Forero-Romero et al. (2009)
formalism (see section C.2.4), it is a very sensitive function of the threshold µth (ﬁgure 9 in Jasche et al., 2010b).
These large disparities in the literature arise because diﬀerent algorithms use various information and criteria
for classifying the cosmic web. For this reason, we believe that it is only relevant to make relative statements
for the same setup, i.e. to compare our results to the corresponding prior quantities, as done in tables 9.2 and
9.3. In this purpose, the large number of samples used allowed a precise characterization of the pdfs so that all
digits quoted in the tables are signiﬁcant. Note that all our analyses are repeatable for diﬀerent setups, which
allows in principle a comparison with any previous work.
As expected for a Bayesian update of the degree of belief, the posterior quantities generally have smaller
variance and a mean value displaced from the prior mean. For the MFF, the posterior means are always within
two standard deviations of the corresponding prior means. The analysis shows that in the SDSS, a larger mass
fraction is occupied by clusters, sheets, and voids, at the detriment of ﬁlaments, in comparison to the prior
expectation. The data also favor a smaller ﬁlling of the Sloan volume by ﬁlaments and sheets and larger ﬁlling
by voids and clusters. For the cluster VFF, the posterior mean, µVFF(T3)|d = 0.01499 is at about 15 standard
deviations (σVFF(T3) = 1.9194 × 10−4) of the prior mean, µVFF(T3) = 0.01198. Given other results on the
VFF and MFF, we believe that the data truly favor a higher volume content in clusters as compared to the

9.4. The primordial large-scale structure
141
Structure type
µVFF
σVFF
µVFF
σVFF
Late-time large-scale structure (a = 1)
Posterior
Prior
Void
0.14897
1.8256 × 10−3
0.14254
6.2930 × 10−3
Sheet
0.58914
1.3021 × 10−3
0.59562
2.2375 × 10−3
Filament
0.24689
1.1295 × 10−3
0.24986
4.4440 × 10−3
Cluster
0.01499
8.7274 × 10−5
0.01198
1.9194 × 10−4
Table 9.2: Mean and standard deviation of the prior and posterior pdfs for the volume ﬁlling fraction of diﬀerent structure
types in the late-time large-scale structure (a = 1).
Structure type
µMFF
σMFF
µMFF
σMFF
Late-time large-scale structure (a = 1)
Posterior
Prior
Void
0.04050
8.3531 × 10−4
0.03876
2.3352 × 10−3
Sheet
0.35605
1.2723 × 10−3
0.35286
3.6854 × 10−3
Filament
0.47356
1.5661 × 10−3
0.48170
4.2215 × 10−3
Cluster
0.12990
6.4966 × 10−4
0.12666
1.8284 × 10−3
Table 9.3: Mean and standard deviation of the prior and posterior pdfs for the mass ﬁlling fraction of diﬀerent structure
types in the late-time large-scale structure (a = 1).
structure formation model used as prior. However, this surprising result should be treated with care; part of
the discrepancy is likely due to the original borg analysis, which optimizes the initial conditions for evolution
with 2LPT (instead of the non-linear evolution with cola used for the present work). LPT predicts fuzzier
halos than N-body dynamics, which results in the incorrect prediction of a high cluster VFF (see section 2.3;
Leclercq et al., 2013).
9.4
The primordial large-scale structure
In this section, we discuss the results of our analysis of the initial density ﬁeld, at a = 10−3. Since the
analysis of the primordial large-scale structure does not involve an additional ﬁltering step, we have been able
to keep a larger number of samples of the posterior pdf for initial conditions, obtained in chapter 5. Hence, for
all results described in this section, we used a total of 4, 473 samples.
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
⟨µ1⟩
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
⟨µ2⟩
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
⟨µ3⟩
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
⟨δ⟩
−0.004
−0.003
−0.002
−0.001
0.000
0.001
0.002
0.003
0.004
Figure 9.4: Slices through the three-dimensional ensemble posterior mean for the eigenvalues µ1 ≤µ2 ≤µ3 of the tidal
ﬁeld tensor in the initial conditions, estimated from 4, 473 samples. The rightmost panel shows the corresponding slice
through the posterior mean for the initial density contrast δ = µ1 + µ2 + µ3, obtained in section 5.3.1.

142
Chapter 9. Bayesian analysis of the dynamic cosmic web in the SDSS galaxy survey
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
voids
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
sheets
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
ﬁlaments
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
clusters
0.0
0.2
0.4
0.6
0.8
1.0
Figure 9.5: Slices through the posterior mean for diﬀerent structure types (from left to right: void, sheet, ﬁlament, and
cluster) in the primordial large-scale structure in the Sloan volume (a = 10−3). These four three-dimensional voxel-wise
pdfs sum up to one on a voxel basis.
9.4.1
Tidal environment
In a similar fashion as in section 9.3.1, the application of the T-web classiﬁer to initial density samples yields
the posterior pdf for the three eigenvalues, µ1, µ2 and µ3, of the initial tidal ﬁeld tensor. Figure 9.4 shows
slices through their means. For visual comparison, the rightmost panel shows the corresponding slice through
the posterior mean of the initial density contrast, δ = µ1 + µ2 + µ3, obtained in section 5.3.1.
In a Gaussian random ﬁeld, µ1 is generally negative, µ3 is generally positive and µ2 close to zero (see the
unobserved parts of the slices in ﬁgure 9.4). In addition, µ2 closely resembles the total density contrast δ up to
a global scaling. In the constrained regions, the eigenvalues of the initial tidal tensor follow this behavior. The
structure observed in their maps is visually consistent with the decomposition of Gaussian density ﬂuctuations
as shown by the right panel.
9.4.2
Probabilistic web-type cartography
Looking at the sign of the eigenvalues of the initial tidal tensor and following the procedure described in
section 9.2.3, we obtain a probabilistic cartography of the primordial large-scale structure. As before, we obtain
four voxel-wise pdfs P(Ti( ⃗xk)|d), taking their values in the range [0, 1] and summing up to one. Figure 9.5 shows
slices through their means, deﬁned by equation (9.3). As in the ﬁnal conditions, the maps exhibit structure
in the data-constrained regions and approach uniform values in the unobserved parts, corresponding to the
respective priors. Using unconstrained realizations of Gaussian random ﬁelds produced with the same setup,2
we measured these prior probabilities. Their means and standard deviations are given in table 9.4.
At this point, it is worth mentioning that there exists an additional symmetry for Gaussian random ﬁelds.
Since the deﬁnition of the tidal tensor is linear in the density contrast (see equations (C.6) and (C.7)) and since
positive and negative density contrasts are equally likely, a positive and negative value for a given µi have the
same probabilities. Because of this sign symmetry, the pdfs for voids and clusters (0 or 3 positive/negative
eigenvalues) and the pdfs for sheets and ﬁlaments (1 or 2 positive/negative eigenvalues) are equal. This can be
checked both in table 9.4 and in the unconstrained regions of the maps in ﬁgure 9.5. In the constrained regions,
a qualitative complementarity between pdfs for voids and clusters and for sheets and ﬁlaments can be observed.
This can be explained by the following. As P
i P(Ti( ⃗xk)|d) = 1 and assuming that P(Ti( ⃗xk)|d) ≈P(T3−i( ⃗xk)|d)
for unlikely events, consistently with the previous remark, we get P(T0( ⃗xk)|d) ≈1 −P(T3( ⃗xk)|d) wherever
P(T1( ⃗xk)|d) ≈P(T2( ⃗xk)|d) is suﬃciently small; and P(T1( ⃗xk)|d) ≈1 −P(T2( ⃗xk)|d) wherever P(T0( ⃗xk)|d) ≈
P(T3( ⃗xk)|d) is suﬃciently small. These results are therefore consistent with expectations based on Gaussianity
for the primordial large-scale structure in the Sloan volume.
In a similar fashion as in section 9.3.2, the ensemble of samples permits us to propagate uncertainties to
structure type classiﬁcation and to characterize the strength of data constraints. In the left panel of ﬁgure 9.6,
we show a slice through the voxel-wise entropy of the web-type posterior pdf in the initial conditions, deﬁned
by equation (9.5). This function quantiﬁes the information content of the posterior, which comes from both
the prior and the data constraints. As in the ﬁnal conditions, the entropy takes lower values inside the survey
2 We used the initial conditions of our set of unconstrained simulations (see footnote 1).

9.5. Evolution of the cosmic web
143
Structure type
µP(Ti)
σP(Ti)
Primordial large-scale structure (a = 10−3)
Void
0.07979
5.4875 × 10−5
Sheet
0.42022
1.0240 × 10−4
Filament
0.42022
1.0412 × 10−4
Cluster
0.07978
5.6337 × 10−5
Table 9.4: Prior probabilities assigned by the T-web classiﬁer to the diﬀerent structures types, in the primordial large-
scale structure (a = 10−3).
Structure type
µVFF
σVFF
µVFF
σVFF
Primordial large-scale structure (a = 10−3)
Posterior
Prior
Void
0.07994
4.0221 × 10−4
0.07977
1.0200 × 10−3
Sheet
0.41994
6.1770 × 10−4
0.42019
1.7885 × 10−3
Filament
0.42048
6.3589 × 10−4
0.42024
1.7820 × 10−3
Cluster
0.07964
3.8043 × 10−4
0.07980
1.0260 × 10−3
Table 9.5: Mean and standard deviation of the prior and posterior pdfs for the volume ﬁlling fraction of diﬀerent structure
types in the primordial large-scale structure (a = 10−3).
region. In the unobserved parts, the entropy ﬂuctuates around 1.6 Sh, value which characterizes the information
content of the prior. Using equation (9.5) (unconditional on the data) and the numbers given in table 9.4, one
can check that this number is consistent with the expectation. In the right panel of ﬁgure 9.6, we show a map
of the Kullback-Leibler divergence of the posterior from the prior, which represents the information gain due to
the data.
9.4.3
Volume and mass ﬁlling fractions
We computed the volume and mass ﬁlling fractions (deﬁned by equations (9.7) and (9.8)) of diﬀerent structure
types in the primordial large-scale structure in the Sloan volume. As for the ﬁnal conditions, we kept only the
regions where the survey response operator is strictly positive. Consequently, we obtained the posterior pdfs
P(VFF(Ti)|d) and P(MFF(Ti)|d). Using a set of unconstrained Gaussian random ﬁelds, we also measured
P(VFF(Ti)) and P(MFF(Ti)) and found that all these pdfs are well described by Gaussians, the means and
standard deviations of which are given in table 9.5 and 9.6.
All posterior quantities obtained are within two standard deviations of the corresponding prior means, and
show smaller variance, as expected. Hence, all results obtained are consistent with Gaussian initial conditions.
9.5
Evolution of the cosmic web
In addition to the inference of initial and ﬁnal density ﬁelds, borg allows to simultaneously analyze the
formation history and morphology of the observed large-scale structure, a subject that we refer to as chrono-
Structure type
µMFF
σMFF
µMFF
σMFF
Primordial large-scale structure (a = 10−3)
Posterior
Prior
Void
0.07958
4.0122 × 10−4
0.07941
1.0163 × 10−3
Sheet
0.41933
6.1907 × 10−4
0.41957
1.7912 × 10−3
Filament
0.42110
6.3543 × 10−4
0.42087
1.7785 × 10−3
Cluster
0.07999
3.8206 × 10−4
0.08015
1.0293 × 10−3
Table 9.6: Mean and standard deviation of the prior and posterior pdfs for the mass ﬁlling fraction of diﬀerent structure
types in the primordial large-scale structure (a = 10−3).

144
Chapter 9. Bayesian analysis of the dynamic cosmic web in the SDSS galaxy survey
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
0.0
0.2
0.4
0.6
0.8
1.0
1.2
1.4
1.6
1.8
2.0
H [Sh]
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
0.0
0.4
0.8
1.2
1.6
2.0
2.4
2.8
DKL [Sh]
Figure 9.6: Slices through the entropy of the structure types posterior (left panel) and the Kullback-Leibler divergence of
the posterior from the prior (right panel), in the initial conditions. The entropy H, deﬁned by equation (9.5), quantiﬁes
the information content of the posterior pdf represented in ﬁgure 9.5, which results from fusing the information content
of the prior and the data constraints. The Kullback-Leibler divergence DKL, deﬁned by equation (9.6), represents the
information gained in moving from the prior to the posterior. It quantiﬁes the information that has been learned on
structure types by looking at SDSS galaxies.

9.5. Evolution of the cosmic web
145
0.0
0.2
0.4
0.6
0.8
1.0
a
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
0.09
VFF
clusters, prior
clusters, posterior
0.0
0.2
0.4
0.6
0.8
1.0
a
0.20
0.25
0.30
0.35
0.40
0.45
VFF
ﬁlaments, prior
ﬁlaments, posterior
0.0
0.2
0.4
0.6
0.8
1.0
a
0.40
0.45
0.50
0.55
0.60
VFF
sheets, prior
sheets, posterior
0.0
0.2
0.4
0.6
0.8
1.0
a
0.07
0.08
0.09
0.10
0.11
0.12
0.13
0.14
0.15
0.16
VFF
voids, prior
voids, posterior
Figure 9.7: Time evolution of the volume ﬁlling fractions of diﬀerent structure types (from left to right and top to
bottom: clusters, ﬁlaments, sheets, voids). The solid lines show the pdf means and the shaded regions are the 2-σ
credible intervals. Light colors are used for the priors and dark colors for the posteriors.

146
Chapter 9. Bayesian analysis of the dynamic cosmic web in the SDSS galaxy survey
0.0
0.2
0.4
0.6
0.8
1.0
a
0.07
0.08
0.09
0.10
0.11
0.12
0.13
0.14
MFF
clusters, prior
clusters, posterior
0.0
0.2
0.4
0.6
0.8
1.0
a
0.41
0.42
0.43
0.44
0.45
0.46
0.47
0.48
0.49
0.50
MFF
ﬁlaments, prior
ﬁlaments, posterior
0.0
0.2
0.4
0.6
0.8
1.0
a
0.34
0.36
0.38
0.40
0.42
0.44
MFF
sheets, prior
sheets, posterior
0.0
0.2
0.4
0.6
0.8
1.0
a
0.03
0.04
0.05
0.06
0.07
0.08
0.09
MFF
voids, prior
voids, posterior
Figure 9.8: Same as ﬁgure 9.7 but for the mass ﬁlling fractions.

9.5. Evolution of the cosmic web
147
cosmography. In this section, we discuss the evolution of the cosmic web from its origin (a = 10−3, analyzed in
section 9.4) to the present epoch (a = 1, analyzed in section 9.3). To do so, we use 11 snapshots saved during
the cola ﬁltering of our results (see section 9.2.2). These are linearly separated in redshift from z = 10 to
z = 0. We perform this analysis in the 1, 097 samples ﬁltered with cola considered in section 9.3. For each of
these samples and for each redshift, we follow the procedure described in sections 9.2.2 and 9.2.3 to compute
the density ﬁeld and to classify the structure types.
9.5.1
Evolution of the probabilistic maps
We followed the time evolution of the probabilistic web-type maps from the primordial (ﬁgure 9.5) to the
late-time large-scale structure (ﬁgure 9.2). In unconstrained regions, these maps show the evolution of the prior
preference for speciﬁc structure types (see tables 9.1 and 9.4), in particular the breaking of the initial symmetry
between voids and clusters and between sheets and ﬁlaments, discussed in section 9.4.2.
In data-constrained regions, the time evolution of web-type maps permits to visually check the expansion
history of individual regions where the posterior probability of one speciﬁc structure is high. In particular, it
is easy to see that, as expected from their dynamical deﬁnition, voids expand and clusters shrink in comoving
coordinates, from a = 10−3 to a = 1 (the reader is invited to compare the leftmost and rightmost panels of
ﬁgures 9.2 and 9.5). Similarly, regions corresponding with high probability to sheets and ﬁlaments expand along
two and one axis, respectively, and shrink along the others. This phenomenon is more diﬃcult to see in slices,
however, as the slicing plane intersects randomly the eigendirections of the tidal tensor.
The time evolution of maps of the web-type posterior entropy (absolute and relative to the prior) also exhibit
some interesting features. There, it is possible to simultaneously check the increase of the information content
of the prior (from H ≈1.6 Sh to H ≈1.4 Sh) and the displacement of observational information operated by
the physical model. As the large-scale structure forms in the Sloan volume, data constraints are propagated
and the complex structure of the ﬁnal entropy map (ﬁgure 9.3), discussed in section 9.3.2, takes shape.
9.5.2
Volume ﬁlling fraction
Our ensemble of snapshots allows us to check the time evolution of global characterizations of the large-scale
structure such as the volume and mass ﬁlling fractions of diﬀerent structures. As in sections 9.3.3 and 9.4.3, we
computed these quantities using only the volume where the survey response operator is non-zero. In ﬁgure 9.7,
we plot these VFF as a function of the scale factor. There, the solid lines correspond to the pdf means and the
shaded regions to the 2-σ credible intervals, with light colors for the priors and dark colors for the posteriors.
The time variation of the VFF in ﬁgure 9.7 is consistent with the expected dynamical behavior of structures.
As voids and sheets expand along three and two axes, respectively, their volume fraction increases.
Here,
the posterior probabilities are mild updates of this prediction. Conversely, as clusters and ﬁlaments shrink
along three and two axes, respectively, their volume fraction decreases. An explanation for the substantial
displacement of the posterior from the prior, observed for clusters, can be found in section 9.3.3.
As already noted, the VFF is a very sensitive function of the precise deﬁnition of structures, grid size,
density assignment scheme, smoothing scale, etc. For this reason, even for prior probabilities, our results can
be in qualitative disagreement with previous authors (e.g. ﬁgure 23 in Cautun et al., 2014), due to their very
diﬀerent deﬁnitions of structures. Therefore, we only found relevant to compare our posterior results with the
prior predictions based on unconstrained realizations. The same remark applies to the MFF in the following
section.
9.5.3
Mass ﬁlling fraction
In ﬁgure 9.8, we show the time evolution of the mass ﬁlling fractions using the same plotting conventions.
Results are consistent with an interpretation based on large scale ﬂows of matter. According to this picture,
voids always loose mass while clusters always become more massive. The behavior of sheets and ﬁlaments can
in principle be more complex, since these regions have both inﬂows and outﬂows of matter depending on the
detail of their expansion proﬁles. In our setup, we found that the number of axes along which there is expansion
dominates in the determination of the balance of inﬂow versus outﬂow, for global quantities such as the MFF.
Therefore, ﬁlaments always gain mass and sheets always loose mass. Summing up our prior predictions, as they
expand along at least two axes, matter ﬂows out of voids and sheets and streams towards ﬁlaments and clusters.

148
Chapter 9. Bayesian analysis of the dynamic cosmic web in the SDSS galaxy survey
The posterior probabilities slightly update this picture. Observations support smaller outﬂowing of matter
from voids. For structures globally gaining matter, the priors are displaced towards less massive ﬁlaments and
more massive clusters. All posterior predictions fall within the ∼2-σ credible interval from corresponding prior
means.
9.6
Summary and Conclusion
Along with chapter 8 (Leclercq et al., 2015), this work exploits the high quality of inference results produced
by the application of the Bayesian code borg (chapter 4; Jasche & Wandelt, 2013a) to the Sloan Digital Sky
Survey main galaxy sample (chapter 5; Jasche, Leclercq & Wandelt, 2015). We presented a Bayesian cosmic
web analysis of the nearby Universe probed by the northern cap of the SDSS and its surrounding. In doing so,
we produced the ﬁrst probabilistic, four-dimensional maps of dynamic structure types in real observations.
As described in section 9.2.1, our method relies on the physical inference of the initial density ﬁeld in
the LSS (Jasche & Wandelt, 2013a; Jasche, Leclercq & Wandelt, 2015). Starting from these, we generated
a large set of data-constrained realizations using the fast cola method (section 9.2.2).
The use of 2LPT
as a physical model in the inference process and of the fully non-linear gravitational dynamics, provided by
cola, as a ﬁlter allowed us to describe structures at the required statistical accuracy, by very well representing
the full hierarchy of correlation functions. Even though initial conditions were inferred with the approximate
2LPT model, we checked that the clustering statistics of constrained non-linear model evaluations agree with
theoretical expectations up to scales considered in this work. As described in section 9.2.3, we used the dynamic
web-type classiﬁcation algorithm proposed by Hahn et al. (2007a) to dissect the cosmic web into voids, sheets,
ﬁlaments, and clusters.
In sections 9.3 and 9.4, we presented the resulting maps of structures in the ﬁnal and initial conditions, re-
spectively, and studied the distribution of global quantities such as volume fraction and mass ﬁlling fractions. In
section 9.5, we further analyzed the time evolution of our results, in a rigorous chrono-cosmographic framework.
For all results presented in this chapter, we demonstrated a thorough capability of uncertainty quantiﬁcation.
Speciﬁcally, for all inferred maps and derived quantities, we got a probabilistic answer in terms of a prior and
a posterior distribution. The variation between samples of the posterior distribution quantiﬁes the remaining
uncertainties of various origins (in particular noise, selection eﬀects, survey geometry and galaxy bias, see
chapters 4 and 5 for a detailed discussion). Building upon our accurate probabilistic treatment, we looked at
the entropy of the structure type posterior and at the relative entropy between posterior and prior. In doing
so, we quantiﬁed the information gain due to SDSS galaxy data with respect to the underlying dynamic cosmic
web and analyzed how this information is propagated during cosmic history. This study constitutes the ﬁrst
link between cosmology and information theory using real data.
In summary, our methodology yields an accurate cosmographic description of web types in the non-linear
regime of structure formation, permits to analyze their time evolution and allows a precise uncertainty quantiﬁ-
cation in a full-scale Bayesian framework. These inference results can be used for a rich variety of applications,
ranging from studying galaxies inside their environment to cross-correlating with other cosmological probes.
They count among the ﬁrst steps towards accurate chrono-cosmography, the subject of simultaneously analyz-
ing the morphology and formation history of the inhomogeneous Universe.
Note added: As we were ﬁnalizing the paper corresponding to this chapter (Leclercq, Jasche & Wandelt,
2015c) for submission, the works by Zhao et al. (2015) and Shi, Wang & Mo (2015) appeared where the
relationship between halos and the cosmic web environment deﬁned by the tidal tensor is being studied.

Chapter 10
Cosmic-web type classiﬁcation using
decision theory
Contents
10.1 Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
149
10.2 Method
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
150
10.3 Maps of structure types in the SDSS
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
151
10.4 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
154
“If no mistake have you made, yet losing you are... a diﬀerent game
you should play.”
Master Yoda, in recollections of Mace Windu,
— Matthew Stover (2003), Star Wars: Shatterpoint
Abstract
We propose a decision criterion for segmenting the cosmic web into diﬀerent structure types (voids, sheets, ﬁlaments,
and clusters) on the basis of their respective probabilities and the strength of data constraints. Our approach is inspired
by an analysis of games of chance where the gambler only plays if a positive expected net gain can be achieved based
on some degree of privileged information. The result is a general solution for classiﬁcation problems in the face of
uncertainty, including the option of not committing to a class for a candidate object. As an illustration, we produce
high-resolution maps of web-type constituents in the nearby Universe as probed by the Sloan Digital Sky Survey
main galaxy sample. Other possible applications include the selection and labeling of objects in catalogs derived from
astronomical survey data.
This chapter is adapted from its corresponding publication, Leclercq, Jasche & Wandelt (2015a).
Credit: Leclercq et al. 2015, A&A, 576, L17. Reproduced with permission © ESO.
10.1
Introduction
Building accurate maps of the cosmic web from galaxy surveys is one of the most challenging tasks in
modern cosmology.
Rapid progress in this ﬁeld took place in the last few years with the introduction of
inference techniques based on Bayesian probability theory (Kitaura et al., 2009; Jasche et al., 2010b; Nuza
et al., 2014; Jasche, Leclercq & Wandelt, 2015). This facilitates the connection between the properties of the
cosmic web, thoroughly analyzed in simulations (e.g. Hahn et al., 2007a; Aragón-Calvo, van de Weygaert &
Jones, 2010; Cautun et al., 2014), and observations (see chapter 3 and Leclercq, Pisani & Wandelt, 2014, for a
review on the interface between theory and data in cosmology).
In chapter 9 (Leclercq, Jasche & Wandelt, 2015c), we conducted a fully probabilistic analysis of structure
types in the cosmic web as probed by the Sloan Digital Sky Survey main galaxy sample. This study capitalized
on the large-scale structure inference performed by Jasche, Leclercq & Wandelt (2015, chapter 5) using the
borg (Bayesian Origin Reconstruction from Galaxies, Jasche & Wandelt, 2013a, chapter 4) algorithm. As the
full gravitational model of structure formation cola (COmoving Lagrangian Acceleration, Tassev, Zaldarriaga
& Eisenstein, 2013; see also section 7.3.1) was used, our approach resulted in the ﬁrst probabilistic and time-
dependent classiﬁcation of cosmic environments at non-linear scales in physical realizations of the large-scale

150
Chapter 10. Cosmic-web type classiﬁcation using decision theory
structure conducted with real data.
Using the Hahn et al. (2007a) deﬁnition (appendix C.2, see also its
extensions, Forero-Romero et al., 2009; Hoﬀman et al., 2012), we obtained three-dimensional, time-dependent
maps of the posterior probability for each voxel to belong to a void, sheet, ﬁlament or cluster.
These posterior probabilities represent all the available structure type information in the observational data
assuming the framework of ΛCDM cosmology. Since the large-scale structure cannot be uniquely determined
from observations, uncertainty remains about how to assign each voxel to a particular structure type. The
question we address in this chapter is how to proceed from the posterior probabilities to a particular choice of
assigning a structure type to each voxel. Decision theory (see, for example, Berger, 1985) oﬀers a way forward,
since it addresses the general problem of how to choose between diﬀerent actions under uncertainty. A key
ingredient beyond the posterior is the utility function that assigns a quantitative proﬁt to diﬀerent actions for
all possible outcomes of the uncertain quantity. The optimal decision is that which maximizes the expected
utility.
After setting up the problem using our example and brieﬂy recalling the relevant notions of Bayesian decision
theory, we will discuss diﬀerent utility functions and explore the results based on a particular choice.
10.2
Method
The decision problem for structure-type classiﬁcation can be stated as follows. We have four diﬀerent web-
types that constitute the “space of input features:” {T0 = void, T1 = sheet, T2 = ﬁlament, T3 = cluster}. We
want to either choose one of them, or remain undecided if the data constraints are not suﬃcient. Therefore
our “space of actions” consists of ﬁve diﬀerent elements: {a0 = “decide void,” a1 = “decide sheet,” a2 =
“decide ﬁlament,” a3 = “decide cluster,” and a−1 = “do not decide.”} The goal is to write down a decision rule
prescribing which action to take based on the posterior information.
Bayesian decision theory states that the action aj that should be taken is that which maximizes the expected
utility function (conditional on the data d), given in this example by
U(aj(⃗xk)|d) =
3
X
i=0
G(aj|Ti) P(Ti(⃗xk)|d),
(10.1)
where ⃗xk labels one voxel of the considered domain, P(Ti(⃗xk)|d) are the posterior probabilities of the diﬀerent
structure types given the data, and G(aj|Ti) are the gain functions that state the proﬁtability of each action,
given the “true” underlying structure. Formally, G is a mapping from the space of input features to the space
of actions. For our particular problem, it can be thought of as a 5 × 4 matrix G such that Gij ≡G(aj|Ti), in
which case eq. (10.1) can be rewritten as a linear algebra equation, U = G.P where the 5-vector U and the
4-vector P contain the elements Uj ≡U(aj(⃗xk)|d) and Pi ≡P(Ti(⃗xk)|d), respectively.
Let us consider the choice of gain functions. Several choices are possible. For example, the 0/1-gain functions
reward a correct decision with 1 for each voxel, while an incorrect decision yields 0. This leads to choosing
the structure type with the highest posterior probability. While this seems like a reasonable choice, we need
to consider that a decision is made in each voxel, whereas we are interested in identifying structures as objects
that are made of many voxels. For instance, since clusters are far smaller than voids, the a priori probability
for a voxel to belong to a cluster is much smaller than for the same voxel to belong to a void.
To treat
diﬀerent structures on an equal footing, it makes sense to reward the correct choice of structure type Ti by an
amount inversely proportional to the average volume Vi of one such structure. In the following, we use the prior
probability as a proxy for the volume fractions,
P(Ti) ≈
Vi
V0 + V1 + V2 + V3
.
(10.2)
We further introduce an overall cost for choosing a structure with respect to remaining undecided, leading to
the following speciﬁcation of the utility,
G(aj|Ti) =







1
P(Ti) −α
if j ∈J0, 3K and i = j,
−α
if j ∈J0, 3K and i ̸= j,
0
if j = −1.
(10.3)

10.3. Maps of structure types in the SDSS
151
This choice limits 20 free functions to only one free parameter, α. With this set of gain functions, making (or
not) a decision between structure types can be thought of as choosing to play or not to play a gambling game
costing α. Not playing the game, i.e. remaining undecided (j = −1), is always free (G(a−1|Ti) = 0 for all i). If
the gambler decides to play the game, i.e. to make a decision (j ∈J0, 3K), they pay α but may win a reward,
1
P(Ti), by betting on the correct underlying structure (i = j).
In the absence of data, the posterior probabilities in equation (10.1) are the prior probabilities P(Ti), which
are independent of the position ⃗xk, and the utility functions are, for j ∈J0, 3K,
U(aj)
=
3
X
i=0
G(aj|Ti) P(Ti)
=

1
P(Tj) −α

P(Tj) −
3
X
i=0
i̸=j
α P(Ti)
=
1 −α


P(Tj) +
3
X
i=0
i̸=j
P(Ti)



=
1 −α,
(10.4)
and
U(a−1)
=
0.
(10.5)
Equations (10.4) and (10.5) mean that, in the absence of data, this reduces to the roulette game utility function,
where, if correctly guessed, a priori unlikely outcomes receive a higher reward, inversely proportional to the
fraction of the probability space they occupy. Betting on outcomes according to the prior probability while
paying α = 1 leads to a fair game with zero expected net gain. The gambler will always choose to play if the
cost per game is α ≤1 and will never play if α > 1.
The posterior probabilities update the prior information in light of the data, providing an advantage to the
gambler through privileged information about the outcome. In the presence of informative data, betting on
outcomes based on the posterior probabilities will therefore ensure a positive expected net gain and the gambler
will choose to play even if α > 1. Increasing the parameter α therefore represents a growing aversion for risk
and limits the probability of losing. Indeed, for high α, the gambler will only play in cases where the posterior
probabilities give suﬃcient conﬁdence that the game will be won, i.e. that the decision will be correct.
10.3
Maps of structure types in the SDSS
We applied the above decision rule to the web-type posterior probabilities presented in chapter 9 (Leclercq,
Jasche & Wandelt, 2015c), for diﬀerent values of α ≥1 as deﬁned by equation (10.3). In doing so, we produced
various maps of the volume of interest, consisting of the northern Galactic cap of the SDSS main galaxy sample
and its surroundings. Slices through these three-dimensional maps are shown in ﬁgure 10.1 for the late-time
large-scale structure (at a = 1) and in ﬁgure 10.2 for the primordial large-scale structure (at a = 10−3).
When the game is fair (namely when α = 1), it is always played, i.e. a decision between one of the four
structure types is always made. This results in the speculative map of structure types (top left panel of ﬁgures
10.1 and 10.2). There, a decision is made even in regions that are not constrained by the data (at high redshift
or outside of the survey boundaries), based on prior betting odds.
By increasing the value of α > 1, we demand higher conﬁdence in making the correct decision. This yields
increasingly conservative maps of the Sloan volume (see ﬁgures 10.1 and 10.2). In particular, at high values of
α, the algorithm makes decisions in the regions where data constraints are strong (see ﬁgures 9.3 and 9.6), but
often stays undecided in the unobserved regions. It can be observed that even at very high values, α ≳3, a
decision for one structure is made in some unconstrained voxels (typically in favor of the structure for which
the reward is the highest: clusters in the ﬁnal conditions, and clusters or voids in the initial conditions). This
eﬀect is caused by the limited number of samples used in our analysis. Indeed, because of the ﬁnite length of
the Markov Chain, the sampled representation of the posterior has not yet fully converged to the true posterior.
For this reason, the numerical representation of the posterior can be artiﬁcially displaced too much from the
prior, which results in an incorrect web-type decision. This eﬀect could be mitigated by obtaining more samples
in the original borg analysis (for an increased computational cost); or can be avoided by further increasing α,

152
Chapter 10. Cosmic-web type classiﬁcation using decision theory
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
α = 1.0
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
α = 1.2
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
α = 1.4
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
α = 1.5
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
α = 2.0
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
α = 2.5
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
α = 3.0
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
α = 3.5
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
α = 4.0
Figure 10.1: Slices through maps of structure types in the late-time large-scale structure, at a = 1. The color coding
is blue for voids, green for sheets, yellow for ﬁlaments, and red for clusters. Black corresponds to regions where data
constraints are insuﬃcient to make a decision. The parameter α, deﬁned by equation (10.3), quantiﬁes to the risk aversion
in the map: α = 1.0 corresponds to the most speculative map of the large-scale structure, and maps with α ≥1 are
increasingly conservative. These maps are based on the posterior probabilities inferred in chapter 9 and on the Bayesian
decision rule subject of the present chapter.

10.3. Maps of structure types in the SDSS
153
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
α = 1.0
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
α = 1.2
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
α = 1.4
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
α = 1.5
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
α = 2.0
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
α = 2.5
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
α = 3.0
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
α = 3.5
0
100
200
300
400
500
z [Mpc/h]
500
400
300
200
100
0
−x [Mpc/h]
α = 4.0
Figure 10.2: Same as ﬁgure 10.1 for the primordial large-scale structure, at a = 10−3.

154
Chapter 10. Cosmic-web type classiﬁcation using decision theory
at the expense of also degrading the map in the observed regions. We found the value of α = 4 (bottom right
panel of ﬁgures 10.1 and 10.2) to be the best compromise between reducing the number of unobserved voxels
in which a decision is made to a tiny fraction and keeping information in the volume covered by the data.
As expected, structures for which the prior probabilities are the highest disappear ﬁrst from the map when
one increases α: betting on these structures being poorly rewarded, this choice is avoided in case of high risk
aversion. In the ﬁnal conditions (ﬁgure 10.1), we found that sheets completely disappear for α ≈1.68 and
ﬁlaments for α ≈4.01. In the initial conditions (ﬁgure 10.2), the critical value is around α ≈2.36 for both
sheets and ﬁlaments. In the most conservative maps displayed in ﬁgures 10.1 and 10.2 (α = 4.0), the SDSS
data provide extremely high evidence for the voids and clusters shown. In constrained parts, extended regions
belonging to a given structure type may not have the expected shape. This is true in particular for ﬁlamentary
regions. Several factors can explain this: ﬁrst, slicing through ﬁlaments make them appear as dots; second, with
the dynamic T-web deﬁnition, ﬁlament regions often extend out into sheets and voids, and their static skeleton
geometry is not the most prominent at the voxel scale (3 Mpc/h in this work).
As detailed in chapters 4 and 5, data constraints are propagated by the structure formation model assumed
in the inference process (second-order Lagrangian perturbation theory) and therefore radiate out of the SDSS
boundaries. For this reason, for moderate values of α, web-type classiﬁcation can be extended beyond the survey
boundaries to regions inﬂuenced by data. This can be observed in ﬁgures 10.1 and 10.2, where one can see,
for instance, that the shape of voids that intersect the mask is correctly recovered. Similarly, the classiﬁcation
of high-redshift structures conﬁrms that the treatment of selection eﬀects by borg is correctly propagated to
web-type analysis.
We ﬁnally comment on the required computational resources for the complete chain for running borg,
computing the web-type posterior, and making a decision. Inference with borg is the most expensive part: on
average, one sample is generated in 1500 seconds on 16 cores (chapter 5; Jasche, Leclercq & Wandelt, 2015).
Then, in each sample, tidal shear analysis (chapter 9; Leclercq, Jasche & Wandelt, 2015c) is a matter of a few
seconds. Once the web-type posterior is known, making a decision, which is the subject of the present chapter,
is almost instantaneous. Therefore, once the density ﬁeld has been inferred, which is useful for a much larger
variety of applications, our method is substantially cheaper than several state-of-the-art techniques for cosmic
web analysis (e.g. the method of Tempel, Stoica & Saar, 2013; Tempel et al., 2014, for detecting ﬁlaments).
10.4
Conclusions
In this chapter, we proposed a rule for optimal decision making in the context of cosmic web classiﬁcation.
We described the problem set-up in Bayesian decision theory and proposed a set of gain functions that permit an
interpretation of the problem in the context of game theory. This framework enables the dissection of the cosmic
web into diﬀerent elements (voids, sheets, ﬁlaments, and clusters) given their prior and posterior probabilities
and naturally accounts for the strength of data constraints.
As an illustration, we produced three-dimensional templates of structure types with various risk aversion,
describing a volume covered by the SDSS main galaxy sample and its surrounding. These maps constitute an
eﬃcient statistical summary of the inference results presented in chapter 9 (Leclercq, Jasche & Wandelt, 2015c)
for cross-use with other astrophysical and cosmological data sets.
Beyond this speciﬁc application, our approach is more generally relevant to the solution of classiﬁcation
problems in the face of uncertainty. For example, the construction of catalogs from astronomical surveys is
directly analogous to the problem we describe here: it simultaneously involves a decision about whether or not
to include a candidate object and which class label (e.g. star or galaxy) to assign to it.

Summary, Conclusion and Outlook
“Je crois qu’on obtiendra des résultats étonnants. C’est justement
pour cela que je ne puis rien vous en dire; car si je les prévoyais,
que leur resterait-il d’étonnant?”
— Henri Poincaré (1900)
Summary
The main subject of this thesis is the process of data assimilation for the analysis of the cosmological large-
scale structure. It aims at ﬁnding the best realizations of a physical model of structure formation in light of
the data, while fully accounting for all uncertainties inherent to the inference problem. To this end, the borg
(Bayesian Origin Reconstruction from Galaxies) algorithm derives the initial conditions and produces physical
large-scale structure reconstructions, by assimilating survey data into a cosmological model. It is an inference
engine that allows the simultaneous analysis of the morphology and the formation history of the cosmic web, a
subject introduced in this work that we refer to as chrono-cosmography. The present thesis contributed to the
establishment of physical large-scale structure inference as a functional and eﬀective tool for the analysis of real
survey data.
We started by a review of the standard picture of LSS formation, discussing the gravitational self-evolution
of the dark matter ﬂuid and introducing cosmological perturbation theory (chapter 1). We then examined the
accuracy of Lagrangian perturbation theory, a tool widely applied in LSS data analysis and also a key ingredient
of the borg algorithm (chapter 2). We characterized the approximation error in particle realizations produced
by LPT at ﬁrst or second order instead of fully non-linear gravity. In particular, we analyzed the one-, two- and
three-point statistics of the density ﬁeld, examined the displacement ﬁeld and compared the volume of diﬀerent
cosmic web elements. In spite of visual similarities, we found that LSS realizations produced by LPT and by
N-body simulations can drastically diﬀer in some regimes, an eﬀect of general interest for data analysis.
Since unique recovery of signals from data subject to observational eﬀects (incomplete sky coverage, selection
eﬀects, biases and noise) is not possible, borg uses a Bayesian approach to quantify uncertainties. We discussed
the fundamental concepts, mathematical framework and computer implementation of Bayesian probability
theory (chapter 3). Building upon these notions, we introduced physical large-scale structure inference with the
borg algorithm (chapter 4). We exposed the data model and described the numerical sampler, based on the
Hamiltonian Monte Carlo technique. Our approach allows the exploration of the posterior distribution, which
lives in an extremely high-dimensional parameter space (usually of the order of 10 million free parameters), in
computationally reasonable times. As a result, it provides a sampled representation of the large-scale structure
inferred from the data, in the form of four-dimensional cosmographic maps of the matter distribution. We
applied the borg algorithm to the Sloan Digital Sky Survey main galaxy sample data and presented our
analysis (chapter 5). Our results constitute accurate three-dimensional reconstructions of the present density
and velocity ﬁelds, but also of the initial conditions and of the formation history of the large-scale structures in
the observed domain.
The full data-assimilation problem is deeply non-linear, implying that probability distributions for observed
cosmic ﬁelds are far from a multivariate Gaussian. We discussed the challenges associated with a fully non-
linear description of late-time structure formation. We proposed a fast method to improve the correspondence
between density ﬁelds in approximate models and in full numerical simulations (chapter 6). The technique relies
on remapping the one-point distribution of approximate ﬁelds using information extracted from simulations, and
allows to extend the validity of LPT beyond shell-crossing, in the mildly non-linear regime. We introduced the
concept of non-linear ﬁltering of borg samples (chapter 7). This procedure improves constrained realizations
by augmenting them with physically plausible information at small scales. We checked the accuracy of the fast
cola scheme as a non-linear ﬁlter versus Gadget-2, and used it to produce a large ensemble of non-linear
borg-cola samples for subsequent use.
We ﬁnally made use of our results for cosmic web analysis. With the vide toolkit, we produced and analyzed
constrained catalogs of cosmic voids in the Sloan volume. In doing so, we showed that the inference of voids
at the level of the dark matter ﬁeld, deeper than with the galaxies, is achievable, and that suitable inference
technology is capable of tapping a mine of information even in existing surveys. In particular, we found at least

156
Summary, Conclusion and Outlook
one order of magnitude more voids at all scales considered, between 5 and 40 Mpc/h. As a consequence, our
method yields a drastic reduction of statistical uncertainty for the determination of void properties and carries a
vast potential for their use as cosmological probes. We presented a probabilistic analysis of the dynamic cosmic
web, dissected into voids, sheets, ﬁlaments, and clusters, on the basis of the tidal ﬁeld (chapter 9). We examined
the history and characterized the information content of our web-type maps. This study demonstrated that
our inference framework allows self-consistent propagation of observational uncertainties to cosmic web analysis,
and counts among the pioneering steps toward a data-supported connection between cosmology and information
theory. Eventually, we introduced a new framework for optimal decision-making based on the web-type posterior
probabilities and the strength of data constraints (chapter 10). We obtained eﬃcient statistical summaries of
our inference results and outlined more general applications to classiﬁcation problems in the face of uncertainty.
Conclusion and Outlook
What does chrono-cosmography predict about the Universe?
The aim of physical large-scale structure inference is to provide a cosmographic description of a subvolume
of the observable Universe, as well as a probabilistic characterization of uncertainties. In this fashion, we have
access to a wealth of information on the present and past of this region. This material can be used in a variety
of subsequent astrophysical and cosmological analyses, many of which can be already conducted based on the
results obtained during this PhD project.
A ﬁrst class of possible projects build upon the inference of the initial conditions, in which gravitational
non-Gaussianity is largely suppressed.
Genesis and growth of the cosmic web.
As we have shown, Bayesian large-scale structure inference paves
the path toward a high-ﬁdelity description of the complex web-like patterns in cosmic structure. A natural
follow-up project is to exploit the richness of the information inferred by borg, including quantities so far only
accessible in simulations, to build and compare classiﬁcations of the cosmic web. These will use, for example:
the Lagrangian displacement ﬁeld (diva, Lavaux & Wandelt, 2010) or the stretchings and foldings of the dark
matter phase-space sheet (origami, Falck, Neyrinck & Szalay, 2012).
Primordial non-Gaussianity and inﬂation.
The borg algorithm has the potential to accurately characterize
the statistics of primordial seeds. In particular, estimators of bispectra (Schmittfull, Baldauf & Seljak, 2015)
or based on the phases of inferred ﬁelds (Obreschkow et al., 2013; Wolstenhulme, Bonvin & Obreschkow,
2014) – for which no prior information is assumed – may detect signatures of primordial non-Gaussianity or
constrain models of inﬂation. While it will be extremely challenging for LSS measurements to improve upon
CMB constraints on inﬂation, the theoretically interesting threshold for many models involving deviations from
Gaussian initial conditions has not yet been reached. Hence, it is crucial to develop new methods that will
extract this information from the LSS.
Galaxies within the large-scale structure.
Physical properties of galaxies (luminosity, color, spin, morpholog-
ical type, etc.) are known to be correlated with their large-scale environment (see e.g. Lee & Lee, 2008; Park,
Kim & Park, 2010; Eardley et al., 2015). Cosmic web analyses enabled by borg straightforwardly allow to test
models of galaxy formation and evolution within their time-varying environment. The resulting information
could then be used in future large-scale structure inference procedures, to obtain more reﬁned information on
the matter density ﬁeld traced by these galaxies.
borg provides a complete description of the gravitational dynamics of the volume of interest. A second
class of projects is to use this information and see what it implies for other cosmological observables. In this
regard, we use borg as a forecast-generating machine, whose predictions can be tested with complementary
observations in the actual sky.
Eﬀects of the inhomogeneous large-scale structure on photons.
Inferred information permits to produce var-
ious prediction templates for cross-correlations with other cosmological data sets. In particular, it is possible to
predict the eﬀects of inhomogeneities in the LSS on photon properties and geodesics, given galaxy observations:

Summary, Conclusion and Outlook
157
deviations in redshift (in the radial direction) and weak gravitational lensing eﬀects (in the angular directions).
In a similar fashion, dynamic information such as velocity ﬁelds and evolution of the gravitational potential can
be used to enhance the detectability of secondary eﬀects expected in the cosmic microwave background, such as
the kinetic Sunyaev-Zel’dovich eﬀect, the integrated Sachs-Wolfe eﬀect, and the non-linear Rees-Sciama eﬀect.
Cosmological parameters, baryon acoustic oscillations and dynamic dark energy.
The incorporation of a
physical model in the likelihood provides a natural way to infer cosmological parameters from observations.
The work presented in this thesis is also expected to provide an alternative way to reconstruct the baryon
acoustic oscillation signal (Padmanabhan et al., 2012) and to infer the equation of state of a possible dark
energy component. This approach will yield a more precise picture of the expansion history of the Universe and
help to understand the origin of cosmic acceleration.
How do we include more aspects in the data model?
Contrary to traditional approaches, which apply various cosmological tests to data separately and combine
constraints in a suboptimal fashion, the approach presented in this thesis automatically and fully self-consistently
performs a joint analysis of all aspects. It models their interdependence and accounts for the ways in which
diﬀerent observables can mutually enhance one another. The joint analysis of all phenomena can be used to
perform consistency tests of the standard cosmological model and has the potential to rule out some of its
possible extensions.
However, many relevant aspects are still absent of the current borg data model: a fully non-linear treat-
ment of gravitational structure formation, redshift-space distortions, lightcone eﬀects, photometric redshifts
uncertainty, density-dependent selection eﬀects, scale-dependent and stochastic galaxy bias or predictions of
non-standard cosmologies. The joint analysis of other probes of the LSS (CMB lensing, weak lensing shear
maps, etc.) should also be addressed in our framework, via a joint likelihood or sequential data assimilation.
The inclusion of these aspects in the LSS data model involves conceptual, but also technical challenges. Bayesian
large-scale structure inference is highly computationally expensive, to the degree that it touches the border of
what is currently possible.
In the author’s opinion, future progress will not only depend on adequate approximations, but also on
the development of new methodological ways to implement sampling. In comparison to the state-of-the-art
Hamiltonian Monte Carlo algorithm, eﬃcient, advanced non-linear data assimilation techniques will have to
allow a much cheaper statistical inference (presumably by several orders of magnitude), which will open the
way for the inclusion of more physical eﬀects.
What can ultimately be learned from the large-scale structure?
How deterministic is the formation of structure in the Universe? In other words, at what scale does one-to-
one mapping from initial to ﬁnal conditions (valid at large, linear and weakly non-linear scales) break down?
Since state-of-the-art simulations are still very far from resolving all relevant physical processes, the issue of
the scale at which structure formation is non-deterministic is not yet considered crucial for numerical modeling.
However, a theoretical understanding of this question would be of central interest in the context of an Eﬀective
Field Theory of the LSS (Baumann et al., 2012; Carrasco, Hertzberg & Senatore, 2012; Senatore & Zaldarriaga,
2014). A quantiﬁcation of the information content of primordial patches that collapse to form structures (such
as the Milky Way) characterizes the LSS in a fundamental way and contains a wealth of information on the
properties of matter at the highest energies, far beyond the reach of particle colliders.
High amount of primordial information contained in small-scale structures would for example disfavor warm
dark matter or any mechanism suppressing small-scale density ﬂuctuations, and could even require further initial
degrees of freedom such as isocurvature perturbations. Issues related to the information content of primordial
patches have been recently speculatively examined by Neyrinck (2015b), who proposed, as a thought experiment,
a test about the scale at which structure formation is deterministic. Unfortunately, simulations do not provide
much insight into the questions of where the information content is, and how to optimally extract it from the
data.
Building upon the inference of initial conditions from which the LSS originates, the ﬁrst steps toward a
practical implementation of a scale-dependent test of determinism in structure formation can be taken. This
task will involve the careful deﬁnition of a measure of complexity in Lagrangian patches inferred by borg and of

158
Summary, Conclusion and Outlook
a means to compare initial and ﬁnal information. It will also require careful analysis of information propagation
via Lagrangian transport within a fully probabilistic approach (see sections 5.3.3 and 9.5.1; ﬁgures 5.8, 9.3 and
9.6 for a preparatory discussion). Further investigation will have to consider information sinks such as baryonic
processes and black hole formation, and information sources that broadcast non-primordial randomness at large
scales, such as supernovae, active galactic nuclei and unstable astrophysical phenomena. The link between
astrophysical, thermodynamic entropy, as well as statistical, information-theoretic entropy will also have to be
clariﬁed.
In the last few years, ESA’s Planck mission conﬁrmed our picture of the evolution of the homogeneous
Universe to spectacular accuracy and provided the highest precision probe to date of the physical origin of cosmic
structure. Challenges for accurate cosmology now arise from studying the inhomogeneous cosmic structure.
This research will provide an exceptionally detailed characterization of the cosmic web underlying the observed
galaxy distribution, extract information about the nature of dark energy, and furnish unprecedentedly accurate
information on the initial conditions from which structure appeared in the Universe. Progress will not only
depend on our ability to handle ever larger data sets: crucial to the longer-term aims is developing eﬃcient tools
for assimilating data into the forecasts of a physical model and quantifying the information content uniquely
encoded in the primordial large-scale structure. Only through such a quantitative statistical approach can we
expand our understanding of the dynamic Universe and make signiﬁcant progress on the age-old puzzles of
cosmic beginning and ultimate fate of the Universe. I am conﬁdent that the methods and results described
in this thesis, counting among the ﬁrst steps towards precision chrono-cosmography, will contribute to this
endeavor.

Appendices


Appendix A
Complements on Gaussian random ﬁelds
Contents
A.1
Characteristic function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
161
A.2
General deﬁnition of a Gaussian random vector . . . . . . . . . . . . . . . . . . . . . .
162
A.3
Some well-known properties of Gaussian random vectors
. . . . . . . . . . . . . . . .
162
A.4
Marginal and conditionals of Gaussian random vectors . . . . . . . . . . . . . . . . . .
163
“I have had my results for a long time: but I do not yet know how
I am to arrive at them.”
— Carl Friedrich Gauß
Quoted in Arber (1954), The Mind and the Eye
Abstract
This appendix provides complements on Gaussian random ﬁelds. It oﬀers a mathematical exposition of their deﬁnition
and demonstrates well-known properties, used in particular in chapter 1 and for the generation of initial conditions
for cosmological simulations (section B.6).
A.1
Characteristic function
Deﬁnition A.1.
For a random scalar vector λ ∈Cn whose pdf is P(λ), the characteristic function ϕλ is deﬁned
as the inverse Fourier transform of P(λ). In other words, it is the expectation value of eit∗λ, where t ∈Cn is
the argument of the characteristic function (e.g. Manolakis, Ingle & Kogon, 2000):
ϕλ(t) ≡
D
eit∗λE
=
Z
C
eit∗λ P(λ) dλ.
(A.1)
Characteristic functions have well-known properties. In particular, an important theorem is the following.
Theorem A.2. (Kac’s theorem).
Let λ1, λ2 ∈Cn be random vectors. The following statements are equivalent:
1. λ1 and λ2 are independent (we note λ1 ⊥⊥λ2),
2. the characteristic function of the joint random vector (λ1, λ2) is the product of the characteristic functions
of λ1 and λ2 i.e. ϕ(λ1,λ2) = ϕλ1ϕλ2.
Proof. 1. ⇒2. is straightforward using ⟨f(λ1)g(λ2)⟩= ⟨f(λ1)⟩⟨g(λ2)⟩.
2. ⇒1. Let f
λ1 and f
λ2 be random vectors such that f
λ1 and λ1 have the same pdf, f
λ2 and λ2 have the same
pdf and f
λ1 ⊥⊥f
λ2. Then
ϕ(λ1,λ2)
=
ϕλ1ϕλ2
using 2.
=
ϕ e
λ1ϕ e
λ2
using the pdfs
=
ϕ( e
λ1, e
λ2)
using 1. ⇒2.
i.e. the characteristic functions of (λ1, λ2) and (f
λ1, f
λ2) coincide. From the uniqueness of the inverse Fourier
transform we conclude that (λ1, λ2) and (f
λ1, f
λ2) are drawn from the same distribution, hence λ1 ⊥⊥λ2.

162
Appendix A. Complements on Gaussian random ﬁelds
A.2
General deﬁnition of a Gaussian random vector
Deﬁnition A.3.
A multivariate random scalar vector λ ∈Cn is a Gaussian random vector if and only if there
exists a vector µ ∈Cn and a Hermitian, positive semi-deﬁnite matrix C ∈Mn(C) such that the characteristic
function of λ is
ϕλ(t) = exp

it∗µ −1
2t∗Ct

.
(A.2)
In this case, µ and C are called the mean and covariance matrix of λ, respectively, and we note λ ∼Nn [µ, C].
Here, the covariance matrix is allowed to be singular. This deﬁnition generalizes the one given in section 1.2.3.1,
as we see from the following theorem.
Theorem A.4.
When C is positive-deﬁnite (and therefore invertible), the distribution of λ has a multivariate
normal density
P(λ|µ, C) =
1
p
|2πC|
exp

−1
2(λ −µ)∗C−1(λ −µ)

.
(A.3)
Proof. By explicitly computing the inverse Fourier transform of the multivariate normal distribution above (i.e.
calculating the Gaussian integral), we can check that the characteristic function of this distribution coincides
with the value of equation (A.2). From the uniqueness of the inverse Fourier transform, we conclude that λ is
drawn from the distribution whose pdf is given above.
When this condition is fulﬁlled, we say that λ is non-degenerate.
A.3
Some well-known properties of Gaussian random vectors
Proposition A.5.
Linear transformations preserve Gaussianity, i.e. for all A ∈Mm×n(C) and b ∈Cm, if
λ ∼Nn [µ, C], then Aλ + b ∼Nm [Aµ + b, ACA∗].
Proof. The characteristic function of Aλ + b is, for all s ∈Cm,
ϕAλ+b(s)
=
D
eis∗(Aλ+b)E
=
D
ei(A∗s)∗λE
eis∗b
=
ϕλ(A∗s) eis∗b
=
exp

i(A∗s)∗µ −1
2(A∗s)∗CA∗s

exp (i s∗b)
=
exp

is∗(Aµ + b) −1
2s∗(ACA∗)s

.
Proposition A.6.
Adding two independent Gaussians yields a Gaussian, i.e.
if λ1 ∼Nn [µ1, C1], λ2 ∼
Nn [µ2, C2] and λ1 ⊥⊥λ2, then λ1 + λ2 ∼Nn [µ1 + µ2, C1 + C2].
Proof. The independence of λ1 and λ2 implies the independence of eit∗λ1 and eit∗λ2. Therefore,
ϕλ1+λ2(t) =
D
eit∗(λ1+λ2)E
=
D
eit∗λ1eit∗λ2E
=
D
eit∗λ1E D
eit∗λ2E
= ϕλ1(t)ϕλ2(t).
Using the characteristic functions of λ1 and λ2 yields
ϕλ1+λ2(t) = exp

it∗µ1 −1
2t∗C1t

exp

it∗µ2 −1
2t∗C2t

= exp

it∗(µ1 + µ2) −1
2t∗(C1 + C2)t

.

A.4. Marginal and conditionals of Gaussian random vectors
163
A.4
Marginal and conditionals of Gaussian random vectors
To study the partition of Gaussian random vectors, let us deﬁne
λ =
λx
λy

,
µ =
µx
µy

and
C =
Cxx
Cxy
Cyx
Cyy

,
(A.4)
where λx, µx ∈Cm, Cxx ∈Mm(C), λy, µy ∈Cn−m, Cyy ∈Mn−m(C), Cxy ∈Mm×(n−m)(C) and Cyx =
(Cxy)∗∈M(n−m)×m(C). We assume that m < n and we want to prove that the marginal and conditional
distributions of λx and λy are Gaussians with parameters given by equations (1.19)–(1.22) and (1.23)–(1.26).
By symmetry, we limit the discussion to λx and λx|λy.
Proposition A.7.
The marginal distribution of λx is that of a Gaussian random vector with mean µx and
variance Cxx.
Proof. Consider A =
1xx
0xy
0yx
0yy

. Proposition A.5. yields Aλ = λx ∼Nm [Aµ, ACA∗] = Nm [µx, Cxx].
Let us now consider the conditionals.
Lemma A.8.
λx and λy are independently distributed if and only if Cxy = 0xy.
Proof. This proposition follows by considering the characteristic function of λ:
ϕλ(t)
=
ϕ(λx,λy)(tx, ty)
=
exp

it∗µ −1
2t∗Ct

=
exp

it∗
xµx + it∗
yµy −1
2t∗
xCxxtx −1
2t∗
xCxyty −1
2t∗
yCyyty −1
2t∗
yCyxtx

=
ϕλx(tx)ϕλy(ty) exp (−t∗
xCxyty)
and using Kac’s theorem (theorem A.2.), λx ⊥⊥λy ⇔ϕ(λx,λy) = ϕλxϕλy ⇔Cxy = 0xy.
Deﬁnition A.9.
Let Cxx.y ≡Cxx −CxyC−1
yy Cyx, the so-called generalized Schur-complement of Cyy in C.
Lemma A.10.
λx −CxyC−1
yy λy
λy

∼Nn
µx −CxyC−1
yy µy
µy

,
Cxx.y
0xy
0yx
Cyy

.
(A.5)
Proof. Consider A =
1xx
−CxyC−1
yy
0yx
1yy

. The lemma follows by considering Aλ and using proposition A.5.
Proposition A.11.
The conditional distribution of λx given λy is the Gaussian distribution given by
Nm

µx + CxyC−1
yy (λy −µy), Cxx.y

.
Proof. Since λx −CxyC−1
yy λy and λy have zero covariance matrix (lemma A.10.), they are independently dis-
tributed according to lemma A.8. Therefore, using also the result obtained for the marginals (proposition A.7.),
we get
(λx −CxyC−1
yy λy)|λy
∼
λx −CxyC−1
yy λy
∼
Nm

µx −CxyC−1
yy µy, Cxx.y

and hence
λx|λy
∼
(λx −CxyC−1
yy λy + CxyC−1
yy λy)|λy
∼
Nm

µx + CxyC−1
yy (λy −µy), Cxx.y

by just translating the above normal density by the constant vector CxyC−1
yy λy.


Appendix B
Simulating collisionless dark matter ﬂuids
Contents
B.1
Model equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
166
B.1.1
Model equations in the standard PM code . . . . . . . . . . . . . . . . . . . . . . . . . . . . 166
B.1.2
Model equations with COLA
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 166
B.2
Steps and data structures
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
167
B.2.1
Main PM steps . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 167
B.2.2
Deﬁnitions and data structures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 167
B.3
Mesh assignments and interpolations
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
168
B.3.1
The mesh assignment function
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 169
B.3.2
Low-pass ﬁltering . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 169
B.3.3
Common mesh assignment schemes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 170
B.3.4
Interpolation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 173
B.4
Poisson equation and accelerations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
173
B.4.1
Solving the Poisson equation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 173
B.4.2
Computation of the accelerations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 174
B.5
Update of positions and momenta
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
175
B.5.1
Time integrators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 175
B.5.2
Kick and Drift operators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 176
B.6
Setting up initial conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
177
B.6.1
The initial Gaussian random ﬁeld . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 177
B.6.2
The high-redshift particle realization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 178
“Simulation:
1. a. The action or practice of simulating, with intent to deceive;
false pretence, deceitful profession. (...)
2. A false assumption or display, a surface resemblance or imita-
tion, of something. (...)”
— The Oxford English Dictionary
Quoted by Peter Coles (2014)
Abstract
This technical appendix describes the implementation of the simulation codes used in this thesis.
It reviews the
particle-mesh approach for simulating a collisionless cold dark matter ﬂuid, as well as the cola modiﬁcation. The
generation of initial conditions using Lagrangian perturbation theory is also discussed.
Many of the projects described in this thesis rely on the particle-mesh (PM) simulation technique. It has
originally been introduced and applied in many diﬀerent areas of physics, such as electromagnetism, hydrody-
namics, magnetohydrodynamics, plasma physics and self-gravitating systems (see e.g. the books by Hockney &
Eastwood, 1981 and Birdsall & Langdon, 1985). In a cosmological context, the reference papers include Klypin
& Shandarin (1983); Efstathiou et al. (1985).
This appendix reviews the PM technique, the cola modiﬁcation, and the numerical implementation of La-
grangian perturbation theory. More details on cosmological PM codes can be found in the review by Bertschinger
(1998) or the lectures notes by Kravtsov (2002); Springel (2014); Teyssier (2014). The reader is also referred

166
Appendix B. Simulating collisionless dark matter ﬂuids
to the cola papers, Tassev, Zaldarriaga & Eisenstein (2013); Tassev et al. (2015); and to Scoccimarro (1998,
appendix D), for the implementation of LPT.
This appendix is organized as follows.
In section B.1, we write down the equations actually solved by
PM/cola codes. We describe the main PM steps and the required data structures in section B.2. Section
B.3 reviews mesh assignments and interpolation schemes; section B.4 discusses the resolution of the Poisson
equation and the computation of forces; and section B.5 examines how to update the positions and momenta of
particles. Finally, B.6 describes the generation of cosmological initial conditions using Lagrangian perturbation
theory.
B.1
Model equations
B.1.1
Model equations in the standard PM code
A PM codes solves the equation of motion for dark matter particles in comoving coordinates (see equation
(1.74); below the mass of particles m is absorbed in the deﬁnition of the momentum p):
p = adx
dτ ,
(B.1)
dp
dτ = −a∇Φ,
(B.2)
coupled with the Poisson equation for the gravitational potential (equation (1.72)),
∆Φ = 4πGa2¯ρ(τ)δ = 3
2Ωm(τ)H2(τ)δ.
(B.3)
It is convenient to choose the scale factor as time variable. Using ∂τ = a′ ∂a = ˙aa ∂a and ¯ρ(τ) = ρ(0)a−3, the
equations to solve are rewritten:
dx
da
=
p
a′a =
p
˙aa2 ,
(B.4)
dp
da
=
−a∇Φ
a′
= −∇Φ
˙a ,
(B.5)
∆Φ
=
4πGρ(0)a−1δ = 3
2Ω(0)
m a−1δ.
(B.6)
We will use the equivalent formulation
dx
da
=
D(a)p,
(B.7)
dp
da
=
K (a)∇
 ∆−1δ

,
(B.8)
where we have combined equations (B.5) and (B.6), and deﬁned f(a) ≡˙a−1 = a/a′ = H−1(a); D(a) ≡f(a)/a2
(the “drift prefactor”) and K (a) ≡−(3/2)Ω(0)
m f(a)/a (the “kick prefactor”).
B.1.2
Model equations with COLA
If one desires to include the cola scheme (see Tassev, Zaldarriaga & Eisenstein, 2013, and section 7.3.1),
then one works in a frame comoving with the Lagrangian displacements. Recall the LPT position of a particle
is given by (see section 1.5),
xLPT(a) = q −D1(a)Ψ1 + D2(a)Ψ2.
(B.9)
Noting x(a) = xLPT(a) + xMC(a) the real position of the same particle, including the mode-coupling residual
xMC(a), one has (see equation (B.9)):
dx
da = dxLPT
da
+ dxMC
da
;
with
dxLPT
da
= −dD1
da Ψ1 + dD2
da Ψ2 ≡D(a)pLPT.
(B.10)
We also deﬁne pMC such that dxMC/da ≡D(a)pMC. Then p = pLPT +pMC (see equation (B.7)). Furthermore,
dpLPT
da
= d
da

1
D(a)
dxLPT
da

≡−K (a)V [xLPT](a),
(B.11)

B.2. Steps and data structures
167
where the diﬀerential operator V [·](a) is deﬁned by
V [·](a) ≡−
1
K (a)
d
da

1
D(a)
d ·
da

.
(B.12)
With these notations, equation (B.8) reads
dp
da = dpLPT
da
+ dpMC
da
= −K (a)V [xLPT](a) + dpMC
da
= K (a)∇
 ∆−1δ

.
(B.13)
It is straightforward to check from equation (B.9) that V [xLPT](a) = −V [D1](a)Ψ1 + V [D2](a)Ψ2. Using the
diﬀerential equation veriﬁed by D1 (equation (1.96)) and the second Friedmann equation (equation (1.7)), we
get
V [D1](a) = D1(a).
(B.14)
Similarly for the second-order growth factor, using equation (1.118),
V [D2](a) = D2(a) −D2
1(a).
(B.15)
In the cola framework, the natural variables are therefore x and pMC, and the equations of motion to solve
(equivalents of equations (B.7) and (B.8)) are
dx
da
=
D(a)pMC −dD1
da Ψ1 + dD2
da Ψ2,
(B.16)
dpMC
da
=
K (a)

∇
 ∆−1δ

−V [D1](a)Ψ1 + V [D2](a)Ψ2

.
(B.17)
In the initial conditions, generated with LPT (see section B.6), we have p = pLPT; therefore the mode-
coupling momentum residual in the rest frame of LPT observers, pMC, should be initialized to zero (this
corresponds to the L−operator in Tassev, Zaldarriaga & Eisenstein, 2013, appendix A). At the end, the LPT
momentum pLPT has to be added to pMC to recover the full momentum of particles, p (this corresponds to
the L+ operator in Tassev, Zaldarriaga & Eisenstein, 2013, appendix A). In the following, wherever we do not
make the explicit distinction between the standard PM and the cola approaches, we will drop the subscript
“MC” for cola momenta and simply note p; however, one should keep in mind these two transformations at
the beginning and at the end.
B.2
Steps and data structures
B.2.1
Main PM steps
Equations (B.7) and (B.8) are solved iteratively in a PM code, which consists of three main steps:
1. estimate the density ﬁeld on the grid from current particle positions; solve the Poisson equation on the grid
to get the potential; take the gradient of the potential to get the accelerations on the grid; and interpolate
back to particles (see sections B.3 and B.4),
2. advance particle momenta using the new accelerations (equation (B.8); see section B.5)
3. update particle positions using their new momenta (equation (B.7); see section B.5).
In the cola scheme, steps 2 and 3 are replaced with the equivalents that come from equations (B.17) and
(B.16), respectively.
B.2.2
Deﬁnitions and data structures
Grids and box size.
A PM cosmological simulation is characterized by
• the number of particles, Np (if particles start from a regular Lagrangian grid – see section B.6 –, we note
Np0, Np1, Np2 the number of particles along each direction, such that Np ≡Np0Np1Np2);

168
Appendix B. Simulating collisionless dark matter ﬂuids
• the size of the periodic box along each direction, L0, L1, L2 (the total volume simulated is therefore
V ≡L0L1L2);
• and the number of cells of the PM grid (i.e. the grid on which density and potential are deﬁned) along
each direction, Ng0, Ng1, Ng2, with Ng ≡Ng0Ng1Ng2.
In many cases we will assume that the box is cubic, and that the particle grid and the PM grid are isotropic:
L0 = L1 = L2 ≡L; Np0 = Np1 = Np2; Ng0 = Ng1 = Ng2. In the following, we denote the side lengths of cells
by ∆x ≡L0/Ng0, ∆y ≡L1/Ng1, ∆z ≡L2/Ng2 and their volume by Vc ≡∆x∆y∆z. We have V = NgVc.
Particle variables.
Assuming that particles all have the same mass,1 a PM code needs a minimum of six real
numbers (float or double) for each particle: three coordinates and three momenta. If the cola modiﬁcation
is included (see section 7.3.1), a minimum of nine (for LPT at order one) or twelve (for LPT at order two) real
numbers per particle is required (three additional real numbers per particle to store the LPT displacements at
each order).
We call these arrays x[mp], y[mp], z[mp] (particles’ positions); px[mp], py[mp], pz[mp] (particles’ mo-
menta); and if cola is enabled, psix_1[mp], psiy_1[mp], psiz_1[mp] (for the ZA displacements, Ψ1),
psix_2[mp], psiy_2[mp], psiz_2[mp] (for the 2LPT displacements, Ψ2).
Here mp indexes a particle.
It
is interesting to note that the arrays containing the Lagrangian displacements are constants, i.e. that they
are never updated within the code (their time-independence can be checked in equations (B.16) and (B.17)).
Convenient data structures are 1D arrays of size Np for particles’ variables.
Grid variables.
In addition, the code needs real numbers (float or double) for the density contrast δ and
the potential Φ at each grid cell. An array of size Ng is needed to store such grid variables. This array can be
shared between density and potential: we ﬁrst use it to store the density contrast δ, then replace its values with
the potential when the Poisson equation is solved.2
We call this array density_or_Phi. A convenient data structure is a 3D array, such that the grid quantity
at position (i, j, k) is density_or_Phi[i,j,k] (with 0 ≤i < Ng0, 0 ≤j < Ng1, 0 ≤k < Ng2). Equivalently, we
decided to implement density_or_Phi as a 1D array of size Ng, such that the grid quantity at position (i, j, k)
is given by density_or_Phi[mc] where the current cell is indexed by mc = k + Ng2 × (j + Ng1 × i).
Accelerations.
It is also convenient to have three additional arrays of size Ng to store the components of the
acceleration on the grid, and three arrays of size Np to store the components of particles’ acceleration.3 In
the following, we note these arrays gx[mc], gy[mc], gz[mc], gpx[mp], gpy[mp], gpz[mp], where 0 ≤mc < Ng
indexes a grid cell and 0 ≤mp < Np indexes a particle.4
B.3
Mesh assignments and interpolations
This section describes how to assign to the grid a quantity carried by particles (the “mesh assignment”
operation, from particles to the grid), and how to distribute to particles a quantity that is known on the grid
(the “interpolation” operation, from the grid to particles).
In a PM code, the ﬁrst operation is used to compute the density on the grid from particle positions; and the
second operation is used to assign an acceleration to each particle from grid values. Both are used in step 1 of
the main PM steps (see section B.2.1).
1 From the deﬁnition of Ω(0)
m , it is easy to see that the mass carried by each particle is m = 3Ω(0)
m H2
0
8πG
V
Np
(this number is called
the mass resolution).
2 The quantity stored is actually the reduced gravitational potential, eΦ ≡∆−1δ, as the overall time-dependent coeﬃcients needed
to go from eΦ to Φ are factored out in K (a) (see equations (B.8) and (B.17)).
3 Actually the reduced acceleration ˜g ≡∇ ∆−1δ
instead of the physical acceleration, see footnote 2.
4 These arrays are not absolutely required. Indeed, it is possible to get rid of them and to make the code more memory-eﬃcient,
if one performs in one step the ﬁnite diﬀerence (to go from ∆−1δ to ∇(∆−1δ)), the interpolation (from the grid quantities to
particles, see section B.3) and the kick operation (see section B.5).

B.3. Mesh assignments and interpolations
169
B.3.1
The mesh assignment function
The general idea to assign particles to the grid is to assume that they have a “shape” S that intersects the
grid. Let us ﬁrst describe the one-dimensional case, where S(x) is the 1D particle shape. The fraction of the
particle at xp assigned to the cell at xc is the shape function averaged over this cell:
W(xp −xc) ≡
Z xc+∆x/2
xc−∆x/2
S(x′ −xp) dx′ =
Z
Π
x′ −xc
∆x

S(x′ −xp) dx′
(B.18)
The assignment function is hence the convolution:
W(x) = Π
 x
∆x

∗S(x)
where
Π(s) =
 1
if |s| ≤1
2
0
otherwise.
(B.19)
In 3D,
W(xp −xc) ≡W(xp −xc)W(yp −yc)W(zp −zc).
(B.20)
For some quantity A, if Ap are the values carried by the particles at positions xp, the quantity A at position
xc on the grid is
A(xc) =
X
{xp}
ApW(xp −xc).
(B.21)
In particular, for gravitational PM codes, the quantity carried by particles is their mass m. The density on the
mesh is then a sum over the contributions of each particle as given by the assignment function,
ρ(xc) = 1
Vc
X
{xp}
mW(xp −xc).
(B.22)
The mean density is ¯ρ = mNp/V , from which we deduce the density contrast δ ≡ρ/¯ρ −1 on the mesh,
δ(xc) =

Ng
Np
X
{xp}
W(xp −xc)

−1.
(B.23)
B.3.2
Low-pass ﬁltering
The Nyquist-Shannon sampling theorem (Nyquist, 1928; Shannon, 1948, 1949) states that the information
content of a sampled signal can be correctly recovered if two conditions hold: the signal must be band-limited,
and the sampling frequency must be greater than twice the maximum frequency present in the signal. If this
is not the case, replicated spectra cannot be separated of the signal we seek to recover, a phenomenon known
as aliasing (e.g. Manolakis, Ingle & Kogon, 2000). Natural signals, however, are generally not band-limited,
so must be low-pass ﬁltered before they are sampled. Equivalently, the sampling operation must include some
form of local averaging, reﬂecting the ﬁnite spatial resolution.
The Fourier representation5 of the ideal low-pass ﬁlter that one should use as assignment function is given
as
W(k) =
1
√
2π Π

k
kNyq,x

=
1
√
2π ×
 1
if |k| < kmax
0
if |k| ≥kmax,
(B.24)
where kmax ≡kNyq,x/2, and kNyq,x ≡2π/∆x is the Nyquist wavenumber. This ﬁlter is ideal in the sense that it
has unity gain in the pass-band region and it perfectly suppresses all the power in the stop-band regions. The
conﬁguration space representation is
W(x) =
1
∆x sinc
 x
∆x

,
(B.25)
where s 7→sinc(s) ≡sin(πs)
πs
is the cardinal sine function (using the signal processing convention). It is interesting
to note that W(x) is not always positive. Therefore, the physical property of a continuous density ﬁeld to be
positive will not be reﬂected in its discretized representation, using ideal low-pass ﬁltering. The loss of physicality
is an expression of a fundamental problem of any data processing procedure: the loss of information due to
discretizing the continuous signal.
5 Here, we use the conventions for forward and inverse Fourier transforms as introduced in section 1.2.4.1.

170
Appendix B. Simulating collisionless dark matter ﬂuids
Furthermore, due to the inﬁnite support of the cardinal sine function in conﬁguration space, the ideal
sampling method is generally not tractable, because computationally too expensive. For this reason, practical
approaches often rely on approximating the ideal cardinal sine operator by less accurate, but faster calculable
functions (often with compact support in conﬁguration space). In Fourier space, this will generally introduce
artiﬁcial attenuation of the pass-band modes and leakage of stop-band modes into the signal (i.e. incomplete
suppression of the aliasing power). The optimal choice of a low-pass ﬁlter approximation is therefore always
a choice between accuracy and computational speed (see e.g. Manolakis, Ingle & Kogon, 2000, for detailed
studies). In the following section we discuss common approaches used in particle simulations.
B.3.3
Common mesh assignment schemes
Commonly used particle shape functions and assignment schemes are often presented as a hierarchy (Hockney
& Eastwood, 1981). The simplest scheme is to consider that particles are punctual and to assign each of them
to the nearest grid point: W(xp −xc) = 1 if xc −∆x
2
≤xp ≤xc + ∆x
2 , 0 otherwise. The shape function is
therefore
SNGP(x) ≡δD(x)
and
SNGP(x) ≡δD(x)δD(y)δD(z).
(B.26)
This is the Nearest Grid Point (NGP) assignment scheme.
The second particle shape function in the hierarchy is a rectangular parallelepiped (a “cloud”) of side length
∆x, ∆y, ∆z. This scheme involves the 8 nearest cells for each particle and is called the Cloud-in-Cell (CiC)
scheme. The shape function is
SCiC(x) ≡
1
∆xΠ
 x
∆x

and
SCiC(x) ≡
1
∆x∆y∆z Π
 x
∆x

Π
 y
∆y

Π
 z
∆z

.
(B.27)
This shape function can be seen as the convolution
1
∆xΠ
  x
∆x

∗δD(x). Higher-order assignment schemes
are obtained by successively convolving with
1
∆xΠ
  x
∆x

along each direction. For example, the third-order
scheme is called the Triangular Shaped Cloud (TSC) and involves the 27 neighboring cells for each particle. In
one-dimension, the shape function is
STSC(x) ≡
1
∆xΠ
 x
∆x

∗1
∆xΠ
 x
∆x

.
(B.28)
The Fourier transform of x 7→
1
∆xΠ
 x
∆x

is k 7→
1
√
2π sinc

k
kNyq,x

. Therefore, in Fourier space, building
the hierarchy is taking successive powers of
1
√
2π sinc

k
kNyq,x

. The assignment function W is found by an
additional convolution of S with x 7→Π
 x
∆x

, which means, in Fourier space, an additional multiplication by
∆x
√
2π × sinc

k
kNyq,x

. In ﬁgure B.1, we show the shape functions S for the NGP, CiC and TSC schemes (ﬁrst
row), the corresponding assignment functions W (second row) and their normalized Fourier transforms, ˆW/∆x
(rescaled such that ˆW(k = 0)/∆x = 1; third row).
High order schemes are obviously more expensive numerically, but they also give more precise results: from
equation (B.21) and the shape functions, we see that resulting quantities on the grid (density, forces) are
piecewise constant in cells (NGP); C0 and piecewise linear (CiC); C1 with piecewise linear ﬁrst derivative
(TSC), etc. (see ﬁgure B.1). The choice is a tradeoﬀbetween accuracy and computational expense.
We summarize the results of this section in table B.1. In the following, we further comment on the well-
known CiC scheme, which is the prescription used to assign particles to the grid throughout this thesis, including
in PM and cola implementations.
Let us consider the CiC density assignment for a particle with coordinates (xp, yp, zp). The cell containing
the particle has indexes given by
i =
j xp
∆x
k
;
j =
 yp
∆y

;
k =
j zp
∆z
k
,
(B.29)
where ⌊·⌋is the integer ﬂoor function. We consider that the cell center is at (xc, yc, zc) = (i×∆x, j×∆y, k×∆z).6
6 The other common convention is to displace the cell center by half a voxel with respect to (i × ∆x, j × ∆y, k × ∆z), i.e.
(xc, yc, zc) = (i × ∆x + ∆x
2 , j × ∆y + ∆y
2 , k × ∆z + ∆z
2 ).

B.3. Mesh assignments and interpolations
171
−2
−1
0
1
2
x
∆x
0
1
SNGP(x)
−2
−1
0
1
2
x
∆x
0
1
SCiC(x) × ∆x
−2
−1
0
1
2
x
∆x
0
1
STSC(x) × (∆x)2
−2
−1
0
1
2
x
∆x
0
1
WNGP(x)
−2
−1
0
1
2
x
∆x
0
1
WCiC(x)
−2
−1
0
1
2
x
∆x
0
1
WTSC(x)
−2
−1
0
1
2
k
kNyq,x
0
1
ˆWNGP(k)
∆x
−2
−1
0
1
2
k
kNyq,x
0
1
ˆWCiC(k)
∆x
−2
−1
0
1
2
k
kNyq,x
0
1
ˆWTSC(k)
∆x
Figure B.1: Shape functions in conﬁguration space for the ﬁrst three schemes of the natural hierarchy of mesh assignments
(S, ﬁrst row); the corresponding assignment functions (W, second row) and their normalized Fourier transform ( ˆ
W, third
row). From left to right, the schemes are: Nearest Grid Point (NGP), Cloud-in-Cell (CiC), Triangular Shaped Cloud
(TSC). The Nyquist wavenumber is deﬁned by kNyq,x ≡2π/∆x.
For comparison, the dashed black lines show the
conﬁguration and Fourier space representations of the ideal low-pass ﬁlter kernel.
Name
Shape function
S(x)
Number of
cells involved
Properties of
grid-wise quantities
NGP
δ(x)
13 = 1
Piecewise constant in cells
CiC
1
∆xΠ
 x
∆x

23 = 8
C0, piecewise linear
TSC
1
∆xΠ
 x
∆x

∗1
∆xΠ
 x
∆x

33 = 27
C1,
diﬀerentiable
with
piecewise linear derivative
Table B.1: Summary of the properties of commonly used particle shape functions.

172
Appendix B. Simulating collisionless dark matter ﬂuids
(i,j,k) 
(ii,j,k) 
(ii,jj,k) 
(i,jj,k) 
dx 
tx 
dy 
ty 
Figure B.2: Two-dimensional illustration of the Cloud-in-Cell assignment scheme. Evertyhing is expressed in units of
the cell size, ∆x along the x direction and ∆y along the y direction. In three dimensions, the particle is assigned to the
eight neighboring cells with diﬀerent weights given by equations (B.33)–(B.40).
As noted before the particle may contribute to densities in the parent cell (xc, yc, zc) and the seven neigh-
boring cells. Let us deﬁne
ii = mod(i + 1, Ng0);
jj = mod(j + 1, Ng1);
kk = mod(k + 1, Ng2).
(B.30)
The modulo function enforces periodic boundary conditions. The particle contributes to the eight cells indexed
by (i, j, k), (ii, j, k), (i, jj, k), (i, j, kk), (ii, jj, k), (ii, j, kk), (i, jj, kk) and (ii, jj, kk). Let us deﬁne
dx = xp −xc
∆x
= xp
∆x −i;
dy = yp −yc
∆y
= yp
∆y −j;
dz = zp −zc
∆z
= zp
∆z −k;
(B.31)
tx = 1 −dx;
ty = 1 −dy;
tz = 1 −dz.
(B.32)
Contributions to the eight cells are given by the formulae below, which also correspond to linear interpolations
in 3D:
W
 xp −x(i,j,k)

=
txtytz,
(B.33)
W
 xp −x(ii,j,k)

=
dxtytz,
(B.34)
W
 xp −x(i,jj,k)

=
txdytz,
(B.35)
W
 xp −x(i,j,kk)

=
txtydz,
(B.36)
W
 xp −x(ii,jj,k)

=
dxdytz,
(B.37)
W
 xp −x(ii,j,kk)

=
dxtydz,
(B.38)
W
 xp −x(i,jj,kk)

=
txdydz,
(B.39)
W
 xp −x(ii,jj,kk)

=
dxdydz.
(B.40)
Summing over all particles will result in the calculation of any quantity A on the grid (equation (B.21)), in
particular the density contrast (equation (B.23)).
In ﬁgure B.2, we illustrate the CiC scheme in two dimensions. The ﬁrst step is to identify the cell indexes
i, ii, j, jj, k, kk. Then, one computes the weight coeﬃcients dx, tx, dy, ty, dz, tz as shown on the ﬁgure, and assigns
the particle to the neighboring cells using the formulae above.

B.4. Poisson equation and accelerations
173
B.3.4
Interpolation
Interpolation is used to distribute a grid-wise quantity to particles. For example, for PM codes, accelerations
are computed on the grid (see section B.4), then interpolated back to each particle’s position.
Using the same notations as before, for some quantity A, the problem is to compute Ap given the values of
A(xc) in all the cells. This can be written in a similar fashion as equation (B.21), but summing on grid cells
instead of particles:
Ap = A(xp) =
X
{xc}
A(xc)W(xp −xc).
(B.41)
W is the assignment function deﬁned in section B.3.1, which involves a shape function S as previously (NGP,
CiC, TSC, etc.).
It is generally important to be consistent between the mesh assignment scheme and the
interpolation scheme. In particular, for PM codes, the same prescription should be used for density assignment
and for interpolating accelerations at particles’ positions. This ensures the absence of artiﬁcial self-forces (forces
exerted by a particle on itself) and momentum conservation (Hockney & Eastwood, 1981).
For the NGP scheme, the value of Ap for a particle is just the value of A(xc) in its parent cell (i, j, k). For
the CiC scheme, using equations (B.41) and (B.33)–(B.40), we ﬁnd:
Ap =
A(i,j,k)txtytz + A(ii,j,k)dxtytz + A(i,jj,k)txdytz + A(i,j,kk)txtydz
+A(ii,jj,k)dxdytz + A(ii,j,kk)dxtydz + A(i,jj,kk)txdydz + A(ii,jj,kk)dxdydz.
(B.42)
This is identical to trilinear interpolation.
B.4
Poisson equation and accelerations
After density assignment, several steps are done on the mesh in PM codes: solving the Poisson equation to
get the reduced gravitational potential eΦ ≡∆−1δ (section B.4.1), and then diﬀerentiating to get the reduced
accelerations ˜g ≡∇
 ∆−1δ

(section B.4.2).
B.4.1
Solving the Poisson equation
It is customary to solve the Poisson equation in Fourier space:
1. the conﬁguration-space density contrast δ(x) is Fourier-transformed to get δ(k);
2. the reduced gravitational potential is estimated by solving the Poisson equation in Fourier space,
eΦ(k) = G(k)δ(k), where G(k) is a Green’s function for the Laplacian, discussed below;
3. the reduced gravitational potential eΦ(k) is transformed back to real space to get eΦ(x).
As noted in section B.2.2, the same array can be used to store δ and eΦ, by doing in-place Fourier transforms.
Fourier transforms.
Steps 1 and 3 involve forward and backward discrete Fourier transforms. In the codes im-
plemented for this thesis, we use the Fast Fourier Transform approach for discrete data, provided by the FFTW
software library,7 deﬁned and normalized as follows, for the forward and backward operations respectively:
ˆfℓ,m,n
=
∆x∆y∆z
Ng0−1
X
i=0
Ng1−1
X
j=0
Ng2−1
X
k=0
fi,j,k e−2iπ(iℓ+jm+kn)/Ng,
fi,j,k
=
1
L0L1L2
Ng0−1
X
i=0
Ng1−1
X
j=0
Ng2−1
X
k=0
ˆfℓ,m,n e2iπ(iℓ+jm+kn)/Ng.
In the following, we note the components of a Fourier mode k as kx = 2π
L0 ℓ, ky = 2π
L1 m, kz = 2π
L2 n.
7 http://www.ﬀtw.org/

174
Appendix B. Simulating collisionless dark matter ﬂuids
Green’s function.
The choice for the Green’s function G(k) depends on how one wants to represent to Laplacian
in conﬁguration space. In Fourier space, the reduced potential obeys −k2eΦ(k) ≡δ(k) where k2 ≡|k|2 =
k2
x + k2
y + k2
z. It is therefore natural to simply use as Green’s function for the Laplacian G(k) = −1/k2. This is
the choice adopted in Gadget-2 (Springel, Yoshida & White, 2001; Springel, 2005) and in the codes used in this
thesis. Care should be taken however, as this choice corresponds to a highly non-local function in conﬁguration
space (see e.g. the discussion in Birdsall & Langdon, 1985, appendix E). Alternatively, we can discretize the
Laplacian operator using the so-called 7-point template,
(∆Φ)i,j,k = Φi−1,j,k + Φi+1,j,k + Φi,j−1,k + Φi,j+1,k + Φi,j,k−1 + Φi,j,k+1 −6Φi,j,k,
(B.43)
for which the Green’s function is given by
G(k) = −1
4

sin2
kx∆x
2

+ sin2
ky∆y
2

+ sin2
kz∆z
2
−1
.
(B.44)
Force smoothing.
Due to the ﬁnite resolution of the PM grid, short-range forces cannot be accurately resolved,
which can cause spurious eﬀects in simulations (Hockney & Eastwood, 1981). For this reason, we smooth the
short-range forces by multiplying by a Gaussian kernel in Fourier space,
Kks(k) = exp

−1
2
k2
k2s

,
where
ks ≡2π
L As.
(B.45)
As is a free parameter that deﬁnes the split between long-range and short-range forces, in units of mesh cells.
In our codes, we adopted As = 1.25, the default value used in Gadget-2.
Deconvolution of the CiC kernel.
We also correct for the convolution with the CiC kernel, by dividing twice
by (see section B.3.3)
KCiC(k) = sinc2

kx
kNyq,x

sinc2

ky
kNyq,y

sinc2

kz
kNyq,z

.
(B.46)
One deconvolution corrects for the smoothing eﬀect of the CiC in the density assignment, the other for the force
interpolation (Springel, 2005).
Overall factor in Fourier space.
Summing up our discussions in this section, the overall factor that we apply
to δ in Fourier space (that we still note G(k) for convenience) is
G(k) = −1
k2 ×
Kks(k)
KCiC(k)2 .
(B.47)
After performing an inverse Fourier transform, we obtain the reduced gravitational potential on the mesh.
B.4.2
Computation of the accelerations
We get the reduced accelerations on the mesh by ﬁnite diﬀerencing the reduced potential. It would also
be possible to take the gradient in Fourier space, by multiplying the potential by a factor −ik and obtaining
directly the accelerations. However, this would require an inverse Fourier transform for each coordinate (i.e.
three instead of one), with little gain in accuracy compared to ﬁnite diﬀerences (Springel, 2005).
We adopt central ﬁnite diﬀerences. Several schemes are possible depending on the desired accuracy. The
two-point ﬁnite diﬀerence approximation (FDA2) is
˜gx(i,j,k) ≡∂eΦ
∂x

(i,j,k)
≈
1
∆x
1
2
eΦ(i+1,j,k) −1
2
eΦ(i−1,j,k)

(B.48)
and similar formulae for the other coordinates ˜gy and ˜gz. The accuracy is of order O(∆x2).
In the codes implemented for this thesis, we adopted the four-point ﬁnite diﬀerence approximation (FDA4),
as in Gadget-2,
˜gx(i,j,k) ≡∂eΦ
∂x

(i,j,k)
≈
1
∆x
2
3

eΦ(i+1,j,k) −eΦ(i−1,j,k)

−1
12

eΦ(i+2,j,k) −eΦ(i−2,j,k)

(B.49)

B.5. Update of positions and momenta
175
which oﬀers order O(∆x4) accuracy. In the two equations above, periodic boundary conditions should always
be enforced: i + 1 is actually mod(i + 1, Ng0), etc.
After having computed the three components of the accelerations on the grid, ˜gx(xc), ˜gy(xc), ˜gz(xc), we
interpolate with the CiC scheme (see section B.3.4) to get the accelerations at particles’ positions, ˜gx(xp),
˜gy(xp), ˜gz(xp).
B.5
Update of positions and momenta
Now that we have the accelerations for each particle from the grid-based Poisson solver (step 1 in section
B.2.1), we are able to update their momenta (“kick”) and their positions (“drift”). This corresponds to steps
2 and 3 in section B.2.1. At this point, we have to adopt a time integration scheme to update positions and
momenta from ai to af, and to deﬁne Kick and Drift operators. This is the object of sections B.5.1 and B.5.2,
respectively.
B.5.1
Time integrators
Let us consider a Hamiltonian system, described in phase space by the canonical coordinates z = (q, p) and
the Hamiltonian H(p, q) ≡p2/2 + Φ(q). If we call f(z) = (p, −∂Φ/∂q), then Hamilton’s equations simply read
˙z = f(z). Hamilton’s equations are a symplectic map, which means that the energy and the volume in phase
space are time-invariants:
dH
dt = 0
and
∇· f = 0.
(B.50)
It is generally important to adopt a numerical integrator that respects these two conditions, at least ap-
proximately (see also the discussion in section 3.4.3). For a map z(t) = F(z0), the volume in phase space is
conserved if det ∂F
∂z = 1. Classical ﬁrst order time integrators use Euler’s method. In particular, the explicit
Euler method,
zn+1 = zn + f(zn)∆t;
for which
det ∂F
∂z = 1 + ∆t2 ∂2Φ
∂q2 ,
(B.51)
and the implicit Euler method,
zn+1 = zn + f(zn+1)∆t;
for which
det ∂F
∂z =
1
1 + ∆t2 ∂2Φ
∂q2
,
(B.52)
are only approximately symplectic. Using the particles’ positions at time tn and momenta at time tn+1 makes
the Euler integrator symplectic:
zn+1 = zn + f(qn, pn+1)∆t;
det ∂F
∂z = 1.
(B.53)
For this thesis, we adopted the second-order symplectic “kick-drift-kick” algorithm, also known as the
leapfrog scheme (e.g. Birdsall & Langdon, 1985, see also section 4.3.4):
pn+1/2
=
pn −∂Φ
∂q

n
∆t
2 ,
(B.54)
qn+1
=
qn + pn+1/2 ∆t,
(B.55)
pn+1
=
pn+1/2 −∂Φ
∂q

n+1
∆t
2 .
(B.56)
It is a straightforward exercise to check that this scheme exactly preserves volume in phase space.
For PM and cola codes, we assume a constant integration step ∆a ≡af −ai
n
, in such a way that the initial
scale factor is ai = a0 and the ﬁnal scale factor is af = an+1 = ai + n∆a. A schematic view of the leapfrog
integration scheme is show in ﬁgure B.3.
Note that during the evolution, positions and momenta are not
synchronized but displaced by half a timestep. For this reason during the ﬁrst timestep, we give the particles
only “half a kick” using the accelerations computed at ai; and during the last timestep, we give the particles an
additional “half a kick”, to synchronize momenta with positions at af.

176
Appendix B. Simulating collisionless dark matter ﬂuids
a0 = ai 
 
D 
a0 = ai 
 
K 
a1 
D 
a2 
D 
an D 
an K 
a1 
K 
a2 
K 
an{1 
K 
an+1 = af 
 
K 
an+1 = af 
 
D 
p 
x 
Figure B.3: Schematic illustration of the leapfrog integrator. Particles’ momenta and positions are updated in turn,
given the value of the other variable within the time interval.
B.5.2
Kick and Drift operators
In equations (B.7) and (B.8), all the explicit dependence on the scale factor is in the prefactors D(a) and
K (a). The leapfrog scheme algorithm relies on integrating the equations on a small timestep and approximating
the momenta or accelerations in the integrands by their value at some time within the interval. More precisely,
for the “drift equation”:
x
 aD
f

−x
 aD
i

=
Z aD
f
aD
i
D(˜a)p(˜a) d˜a ≈
 Z aD
f
aD
i
D(˜a) d˜a
!
p
 aK
(B.57)
and similarly for the “kick equation”:
p
 aK
f

−p
 aK
i

=
Z aK
f
aK
i
K (˜a)

∇
 ∆−1δ

(˜a) d˜a ≈
 Z aK
f
aK
i
K (˜a) d˜a
!

∇
 ∆−1δ

(aD)
(B.58)
This deﬁnes the Drift (D) and Kick (K) operators:
D(aD
i , aD
f , aK) :
x(aD
i ) 7→x(aD
f ) = x(aD
i ) +
 Z aD
f
aD
i
D(˜a) d˜a
!
p
 aK
(B.59)
K(aK
i , aK
f , aD) :
p(aD
i ) 7→p(aD
f ) = p(aD
i ) +
 Z aK
f
aK
i
K (˜a) d˜a
!

∇
 ∆−1δ

(aD)
(B.60)
Consistently with the scheme described in section B.5.1, the time evolution between a0 and an+1 is then achieved
by applying the following operator, E(an+1, a0), to the initial state (x(a0), p(a0)):
K(an+1/2, an+1, an+1)D(an, an+1, an+1/2)
" n
Y
i=0
K(ai+1/2, ai+3/2, ai+1)D(ai, ai+1, ai+1/2)
#
K(a0, a1/2, a0).
(B.61)
If the cola scheme is adopted, we obtain in a similar manner, from equations (B.16) and (B.17):
x
 aD
f

−x
 aD
i

≈
 Z aD
f
aD
i
D(˜a) d˜a
!
pMC
 aK
−
 Z aD
f
aD
i
dD1(˜a)
d˜a
d˜a
!
Ψ1 +
 Z aD
f
aD
i
dD2(˜a)
d˜a
d˜a
!
Ψ2,
=
 Z aD
f
aD
i
D(˜a) d˜a
!
pMC
 aK
−[D1]
aD
f
aD
i Ψ1 + [D2]
aD
f
aD
i Ψ2,
(B.62)
pMC
 aK
f

−pMC
 aK
i

≈
 Z aK
f
aK
i
K (˜a) d˜a
!
 
∇
 ∆−1δ

(aD) −V [D1](aD)Ψ1 −V [D2](aD)Ψ2

=
 Z aK
f
aK
i
K (˜a) d˜a
!
 
∇
 ∆−1δ

(aD) −D1(aD)Ψ1 +
 D2(aD) −D2
1(aD)

Ψ2

.(B.63)

B.6. Setting up initial conditions
177
In the last line we used equations (B.14) and (B.15). This deﬁnes new Drift (eD) and Kick (eK) operators:
eD(aD
i , aD
f , aK) :
x(aD
i ) 7→x(aD
f ) = x(aD
i ) +
 Z aD
f
aD
i
D(˜a) d˜a
!
pMC
 aK
−[D1]
aD
f
aD
i Ψ1 + [D2]
aD
f
aD
i Ψ2 (B.64)
eK(aK
i , aK
f , aD) :
pMC(aD
i ) 7→pMC(aD
f ) = pMC(aD
i ) +
 Z aK
f
aK
i
K (˜a) d˜a
!
×
 
∇
 ∆−1δ

(aD) −D1(aD)Ψ1 +
 D2(aD) −D2
1(aD)

Ψ2

. (B.65)
With cola, the time evolution between a0 and an+1 is achieved by applying the following operator to the initial
state (x(a0), p(a0)):
L+(an+1)eE(an+1, a0)L−(a0),
(B.66)
where eE(an+1, a0) is the operator given by equation (B.61), replacing D by eD and K by eK, and we where we
use (see Tassev, Zaldarriaga & Eisenstein, 2013, appendix A):
L±(a) :
p(a) 7→p(a) ± pLPT(a) = p(a) ±
1
D(a)

−dD1
da Ψ1 + dD2
da Ψ2

.
(B.67)
L−transforms the initial conditions to the rest frame of LPT observers (this is the same as initializing pMC to
zero), and L+ adds back the LPT momenta to pMC at the end.
In the codes implemented for this thesis, the integrals appearing in the Kick and Drift operators (equations
(B.59), (B.60), (B.64), (B.65)) are explicitly computed numerically. Another approach for the discretization of
time operators is proposed by Tassev, Zaldarriaga & Eisenstein (2013, section A.3.2.). When needed, the ﬁrst
order growth factor D1 and its logarithmic derivative f1 are also computed numerically by explicit integration.
For the second-order growth factor and its logarithmic derivative, we use the ﬁtting functions given by equations
(1.119) and (1.138) (Bouchet et al., 1995),
D2(τ) ≈−3
7D1(τ)Ω−1/143
m
and
f2(τ) ≈2f1(τ)54/55.
(B.68)
B.6
Setting up initial conditions
The last missing part for a full cosmological pipeline including the PM/cola codes described in previous
sections is a way to set up initial conditions at a = ai. The ﬁrst step (section B.6.1) is to generate a realization
of the random density ﬁeld describing the early Universe. As argued in chapter 1, it is physically relevant to
describe this ﬁeld as a Gaussian random ﬁeld.
The second step (section B.6.2) is to produce a high-redshift particle realization from this initial density
ﬁeld, to be given to the PM code. The common approach is to use Lagrangian perturbation theory (the ZA
or 2LPT). Several existing codes perform this task: among others, Grafic (Bertschinger, 2001), N-GenIC
(Springel, Yoshida & White, 2001; Springel, 2005, using the ZA) and its 2LPT extension, 2LPTic (Crocce,
Pueblas & Scoccimarro, 2006b; Pueblas & Scoccimarro, 2009), MPGrafic (Prunet et al., 2008), music (Hahn
& Abel, 2011).
However, for the purpose of this thesis, we implemented an independent ZA/2LPT initial
conditions generator. It is especially designed for full consistency with the borg algorithm (see chapter 4); in
particular, it uses the same routine as borg for the generation of LPT displacement ﬁelds.
B.6.1
The initial Gaussian random ﬁeld
There exists many software packages that allow generating normal random variates (i.e. single Gaussian
random variates with mean 0 and variance 1), for example using the well-known Box-Müller method. We choose
the routines provided by the GNU scientiﬁc library (Galassi et al., 2003). We generate one such normal random
variate in each cell of the initial grid, and call the resulting vector the “initial white noise ﬁeld” ξ. It is a random
signal with constant power spectrum (⟨ξξ⊺= 1⟩). Alternatively, we can choose to import “constrained white
noise” that comes, for example, of large-scale structure inferences performed with borg.
Generally, using a vector of normal variates ξ, one can generate a realization of a grf with mean µ and
covariance matrix C by simply taking any matrix
√
C that satisﬁes
√
C
√
C
⊺= C and computing x =
√
Cξ +µ.

178
Appendix B. Simulating collisionless dark matter ﬂuids
One general way to generate
√
C under the condition that C has only positive deﬁnite eigenvalues is to use the
so-called Cholesky decomposition, implemented in many numerical packages.
For cosmological initial conditions, however, the problem is generally much simpler. As we are generating a
random realization of the density contrast δ, the mean is µ = 0 and, from statistical homogeneity and isotropy,
the covariance matrix C should be diagonal in Fourier space and contain the power spectrum coeﬃcients
P(k)/(2π)3/2 (see section 1.2.4.1). Hence, an obvious choice for the matrix
√
C is the diagonal matrix containing
the coeﬃcients
p
P(k)/(2π)3/2. Therefore, the procedure is to Fourier-transform ξ, to multiply each of its
Fourier modes of norm k by
p
P(k)/(2π)3/2, and to perform an inverse Fourier transform to get δ in conﬁguration
space.
Physical assumptions are needed for the power spectrum coeﬃcients P(k). One possible approach is to use
the outputs of Boltzmann codes that describe the early Universe (e.g. cmbfast – Seljak & Zaldarriaga, 1996,
camb – Lewis & Challinor, 2002, or class – Lesgourgues, 2011; Blas, Lesgourgues & Tram, 2011). However,
in our implementation, we choose (as in borg) to use the analytical power spectrum from Eisenstein & Hu
(1998, 1999) for the baryon-CDM ﬂuid (including baryonic wiggles). It depends on the following cosmological
parameters, which have to be speciﬁed: ΩΛ, Ωm, Ωb, ns and σ8.
When performing constrained simulations (see section 7.1.3), all the steps described in this section are
bypassed, and we directly make use of the initial density contrast ﬁeld inferred with borg.
B.6.2
The high-redshift particle realization
We start from “grid-like” initial conditions, i.e. a realization of Np dark matter particles, placed on a regular
lattice. More precisely, for 0 ≤i < Np0, 0 ≤j < Np1, 0 ≤k < Np2, we place a particle at Lagrangian
coordinates q = (iL0/Np0, jL1/Np1, k L2/Np2). All the masses are set to the constant value given in footnote
1, and at this point all the velocities are zero. Finally, each particle’s id is set to mp = k + Np2 ×
 j + Np1 × i

.
This allows to keep a memory of the initial position of particles at any later time, even in the PM code.
The following step is to compute the ZA and 2LPT displacements for each particle, given the initial density
contrast ﬁeld δ(q) generated in section B.6.1. We proceed as follows. The ﬁrst-order potential ﬁeld, φ(1)(q), is
evaluated on the Lagrangian grid by solving equation (1.134) in Fourier space,8
φ(1)(κ) = −δ(κ)/κ2.
(B.69)
Each of its second order derivatives are also evaluated in Fourier space, using
φ(1)
,ab(κ) = −φ(1)(κ)κa · κb.
(B.70)
and inverse Fourier-transformed. From the conﬁguration-space quantity
φ(q) ≡φ(1)
,xx(q)φ(1)
,yy(q) + φ(1)
,xx(q)φ(1)
,zz(q) + φ(1)
,yy(q)φ(1)
,zz(q) −φ(1)
,xy(q)2 −φ(1)
,xz(q)2 −φ(1)
,yz(q)2,
(B.71)
we compute the second-order potential ﬁeld, φ(2)(q), again in Fourier space, using (see equation (1.135))
φ(2)(κ) = −φ(κ)/κ2.
(B.72)
Once φ(1)(q) and φ(2)(q) are known, we evaluate the ﬁrst and second order displacements Ψ(1)(q) ≡
∇qφ(1)(q) and Ψ(2)(q) ≡∇qφ(2)(q) on the initial grid in conﬁguration space, by using a ﬁnite diﬀerence ap-
proximation scheme at order 2 (see section B.4.2). Then, we interpolate from the grid to particles’ Lagrangian
positions using a CiC scheme (see section B.3.4).
Finally, particles are displaced from their Lagrangian positions and their velocities are modiﬁed as prescribed
by LPT (equations (1.136) and (1.137)). More precisely, particles are given a zeroth “kick”,
K0(ai) :
u = 0 7→u(ai) = −f1(ai)D1(ai)H(ai)Ψ1(q) + f2(ai)D2(ai)H(ai)Ψ2(q),
(B.73)
where u ≡dx/dτ = aHdx/da. From this we deduce the initial momenta in code units,
p(ai) =
1
aiH(ai)D(ai)u(ai).
(B.74)
They also follow a zeroth “drift”:
D0(ai) :
q 7→x(ai) = q −D1(ai)Ψ1(q) + D2(ai)Ψ2(q).
(B.75)
The required numerical prefactors are computed as described at the end of section B.5.2.
8 We denote by κ a Fourier mode on the Lagrangian grid, κ its norm.

Appendix C
Cosmic structures identiﬁcation and
classiﬁcation algorithms
Contents
C.1
VIDE: the Void IDentiﬁcation and Examination toolkit . . . . . . . . . . . . . . . . .
179
C.1.1
Voronoi Tessellation Density Estimation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179
C.1.2
The watershed algorithm
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 180
C.1.3
Processing and analysis of void catalogs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 180
C.1.4
Radial density proﬁles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181
C.2
The T-web
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
181
C.2.1
The tidal tensor
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181
C.2.2
Analogy with the Zel’dovich formalism . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 182
C.2.3
The T-web: original procedure
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 182
C.2.4
Extensions of the T-web . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 183
C.2.5
Implementation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 184
C.2.6
Example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 185
“Whenever a theory appears to you as the only possible one, take
this as a sign that you have neither understood the theory nor the
problem which it was intended to solve.”
— Karl Popper (1972), Objective Knowledge: An Evolutionary Ap-
proach
Abstract
This appendix discusses methods for identifying and classifying structures in the cosmic web. As many approaches
exist (see the introduction of chapter 9), in the following we only focus on the algorithms used in this thesis: the vide
toolkit for the identiﬁcation of static voids (section C.1), and the T-web approach for dissecting the dynamic cosmic
web into clusters, ﬁlaments, sheets, and voids (section C.2).
C.1
VIDE: the Void IDentiﬁcation and Examination toolkit
This section describes vide, the Void IDentiﬁcation and Examination toolkit.
It is a static void ﬁnder
operating on density ﬁelds, used in chapter 8 of this thesis.
The details behind vide are described in its
accompanying paper, Sutter et al. (2015b), and its website http://www.cosmicvoids.net/. vide is based on
ZOBOV (ZOnes Bordering On Voidness, Neyrinck, 2008) for the void ﬁnding part (sections C.1.1 and C.1.2),
and includes a set of additional features for pre- and post-processing void catalogs (section C.1.3).
C.1.1
Voronoi Tessellation Density Estimation
The algorithm begins by building a Voronoi tessellation of the tracer particle population (Schaap & van
de Weygaert, 2000; Schaap, 2007).
This provides a density ﬁeld estimator (the Voronoi Tessellation Field
Estimator, vtfe) based on the underlying particle positions. The vtfe (along with its dual, the Delaunay

180
Appendix C. Cosmic structures identiﬁcation and classiﬁcation algorithms
Tessellation Field Estimator, dtfe) is a local density estimate that is especially suitable for astronomical data
(van de Weygaert & Schaap, 2009; Cautun & van de Weygaert, 2011).
The Voronoi tessellation is a partitioning of space into cells around each particle. For each particle i, the
corresponding Voronoi cell is the region consisting of all points closer to that particle than to any other. The
density estimate at particle i is 1/V (i), where V (i) is the volume of the Voronoi cell around particle i. It is
further assumed constant density across the volume of each Voronoi cell, which eﬀectively sets a smoothing
scale for the continuous density ﬁeld.
Finally, the Voronoi tessellation also provides the adjacency measurement for each particle i (i.e. the set of
particles whose Voronoi cells have a common boundary with i’s cell), which ZOBOV uses in the next step.
C.1.2
The watershed algorithm
ZOBOV then uses the watershed transform (Platen, van de Weygaert & Jones, 2007) to group Voronoi cells
into zones and subsequently voids. Minima (also called cores or basins) are ﬁrst identiﬁed as particles with
lower density than any of their Voronoi neighbors. Then, the algorithm merges nearby Voronoi cells into zones
(the set of cells for which density ﬂows downward into the zone’s core). Finally, the watershed transform groups
adjacent zones into voids by ﬁnding minimum-density barriers between them and joining zones together. This
can be thought of, for each zone z, as setting the “water level” to its minimum density and raising it gradually.
Water may ﬂow along lines joining adjacent Voronoi zones, adding them to the void deﬁned around zone z.
The process is stopped when water ﬂows into a deeper zone (one with a lower core than z) or if z is the deepest
“parent” void, when water ﬂoods the whole ﬁeld. The void corresponding to zone z is deﬁned as the set of zones
ﬁlled with water just before this happens, and its boundary is the ridgeline which retains the ﬂow of water. As
can be understood from this description, the watershed transform naturally builds a nested hierarchy of voids
(Lavaux & Wandelt, 2012; Bos et al., 2012).
ZOBOV imposes a density-based criterion within the void ﬁnding operation: adjacent zones are only added
to a void if the density of the wall between them is less than 0.2 times the mean particle density (Platen,
van de Weygaert & Jones, 2007; see Blumenthal et al., 1992; Sheth & van de Weygaert, 2004 for the role of
the corresponding δ = −0.8 underdensity). This density threshold prevents voids from expanding deeply into
overdense structures and limits the depth of the void hierarchy (Neyrinck, 2008). By default, vide reports every
identiﬁed basin as a void (regardless of the density of the initial zone), but facilities exist for ﬁltering the void
catalogs based on various criteria (Sutter et al., 2015b).
C.1.3
Processing and analysis of void catalogs
The vide toolkit provides routines for performing many analysis tasks, such as manipulating, ﬁltering, and
comparing void catalogs, plotting void properties, stacking, computing clustering statistics and ﬁtting density
proﬁles (Sutter et al., 2015b). In this section, we brieﬂy describe the details behind the three void statistics
used in chapter 8: number functions, ellipticity distributions, and density proﬁles.
C.1.3.1
Number functions
The eﬀective radius of a void is deﬁned as
Rv ≡
 3
4π V
1/3
,
(C.1)
where V is the total volume of the Voronoi cells that make up the void. From this deﬁnition, voids with eﬀective
radius smaller than ¯n−1/3, where ¯n is the mean number density of tracers, are excluded to prevent the eﬀects
of shot noise.
Based on this deﬁnition, vide includes a built-in plotting routine for the cumulative number functions of
multiple void catalogs on a logarithmic scale (see ﬁgure 8.3).
C.1.3.2
Ellipticity distributions
For each void in the catalog, vide also reports the volume-weighted center of all Voronoi cells in the void,
or macrocenter:
xv ≡
1
P
i Vi
X
i
xiVi,
(C.2)

C.2. The T-web
181
where xi and Vi are the positions and Voronoi volumes of each tracer particle i, respectively.
Void shapes are computed from void member particles by constructing the inertia tensor:
Mxx
=
Np
X
i=1
 y2
i + z2
i

,
(C.3)
Mxy
=
−
Np
X
i=1
xiyi,
(C.4)
where Np is the number of particles in the void, and (xi, yi, zi) is the set of coordinates of particle i relative
to the void macrocenter. The other components of the inertia tensor are obtained by cyclic permutation of
coordinates. The eigenstructure of the inertia tensor gives the ellipticity of the void:
ε = 1 −
J1
J3
1/4
,
(C.5)
where J1 and J3 are the smallest and the largest eigenvalues of the inertia tensor, respectively. The ellipticity
distribution of voids as a function of their eﬀective radius follows from this deﬁnition (see ﬁgure 8.4).
C.1.4
Radial density proﬁles
vide contains a routine to construct three-dimensional stacks of voids, where void macrocenters are super-
posed and particle positions are shifted to be expressed as relative to the stack center. This routine builds
stacks of voids whose eﬀective radius is in some given range. From each of these three-dimensional stacks, vide
builds a spherically-averaged one-dimensional proﬁle.
This is used in particular for building radial density proﬁles of voids at a given size (see ﬁgure 8.5).
C.2
The T-web
This section describes the “T-web”, a dynamic web classiﬁer which dissects the entire large-scale structure
into diﬀerent structure types: voids, sheets, ﬁlaments, and clusters. It is used in section 2.3, chapters 9 and 10
of this thesis.
C.2.1
The tidal tensor
We start here from the Vlasov-Poisson system in Eulerian coordinates, equations (1.72) and (1.75). It is
always possible to rescale the cosmological gravitational potential by deﬁning ˜Φ ≡Φ/(4πGa2¯ρ) in such a way
that ˜Φ obeys a reduced Poisson equation,
∆˜Φ(x) = δ(x).
(C.6)
In this context, we deﬁne the tidal tensor T as the Hessian H(˜Φ) of the rescaled gravitational potential ˜Φ,
Tij ≡H(˜Φ)ij =
∂2 ˜Φ
∂xi∂xj
.
(C.7)
With this deﬁnition, the left-hand side of equation (C.6) can be seen as the application of the Laplace-Beltrami
operator LB (or tensor Laplacian), trace of the Hessian, to ˜Φ:
LB(˜Φ) ≡tr(H(˜Φ)) = ∆˜Φ.
(C.8)
Let us denote by µ1(x) ≤µ2(x) ≤µ3(x) the three local eigenvalues of the tidal tensor.1 They are dimensionless
and real (since T is symmetric). We have tr(T)(x) = µ1(x) + µ2(x) + µ3(x), and the reduced Poisson equation
can therefore be seen as a decomposition of the Eulerian density contrast ﬁeld, in the sense that it reads
µ1(x) + µ2(x) + µ3(x) = δ(x).
(C.9)
1 These eigenvalues are often noted λi in the literature. We changed the notation in this thesis to avoid the confusion with the
Zel’dovich formalism (see sections 1.5.2 and C.2.2).

182
Appendix C. Cosmic structures identiﬁcation and classiﬁcation algorithms
At this point, it is useful to introduce some notations commonly found in the literature to characterize the
tidal ﬁeld. Given equation (C.9), the eigenvalues of the tidal tensor deﬁne an ellipsoid with semi-axes (e.g.
Peacock & Heavens, 1985)
ai(x) ≡
s
δ(x)
µi(x).
(C.10)
The triaxiality parameters are deﬁned by Bardeen et al. (1986) in terms of the eigenvalues as
ε(x) = µ1(x) −µ3(x)
2δ(x)
and
p(x) = µ1(x) −2µ2(x) + µ3(x)
2δ(x)
.
(C.11)
ε is called the ellipticity (in the µ1 −µ3 plane) and p the prolateness (or oblateness). If −ε ≤p ≤0 then the
ellipsoid is prolate-like, and if 0 ≤p ≤ε it is oblate-like. The limiting cases are p = −ε for prolate spheroids
and p = ε for oblate spheroids.
C.2.2
Analogy with the Zel’dovich formalism
The above equations have a strong similarity with that of the Zel’dovich formalism. Indeed, we have seen
that the ﬁrst Lagrangian potential φ(1), deﬁned by Ψ(1)(q, τ) = −D1(τ)∇qφ(1)(q), satisﬁes a reduced Poisson
equation (equation (1.134)),
∆qφ(1)(q) = δ(q).
(C.12)
As discussed in section 1.5.2, the shear of the displacement R ≡∂Ψ/∂q veriﬁes
Rij = −D1(τ)H(φ(1))ij = −D1(τ) ∂2φ(1)
∂qi∂qj
.
(C.13)
The local eigenvalues of Hessian of the ﬁrst Lagrangian potential, λ1(q) ≤λ2(q) ≤λ3(q), permit to rewrite the
reduced Poisson equation as a decomposition of the initial density contrast,
λ1(q) + λ2(q) + λ3(q) = δ(q).
(C.14)
C.2.3
The T-web: original procedure
In analogy with the Zel’dovich “pancake” theory, where the sign of the λi permit an interpretation of what
happens at shell-crossing in the ZA in terms of structure types (see section 1.5.2), Hahn et al. (2007a) proposed
to classify structures using the sign of the µi. Namely, a void point corresponds to no positive eigenvalue, a
sheet to one, a ﬁlament to two, and a cluster to three positive eigenvalues (see table C.1).
Structure type
Rule
Void
µ1, µ2, µ3 < 0
Sheet
µ1, µ2 < 0 and µ3 > 0
Filament
µ1 < 0 and µ2, µ3 > 0
Cluster
µ1, µ2, µ3 > 0
Table C.1: Rules for classiﬁcation of structure types according to the T-web procedure (Hahn et al., 2007a).
The interpretation of this rule is straightforward, as the sign of an eigenvalue at a given position deﬁnes
whether the gravitational force in the direction of the corresponding eigenvector is contracting (positive eigen-
values) or expanding (negative eigenvalues). Thus, the signature of the tidal tensor characterizes the number of
axes along which there is gravitational expansion or collapse. This procedure is sometimes called the “T-web”,
in reference to the tidal tensor.
In Hahn et al. (2007a), an interpretation of the above rule in terms of the orbit stability of test particles
is also discussed. The equation of motion in comoving coordinates and in conformal time reads (see equation
(1.74))
dp
dτ = −ma∇Φ
with
p = madx
dτ
(C.15)

C.2. The T-web
183
The local extrema of the gravitational potential (i.e. points ¯x such that ∇Φ(¯x) = 0) are ﬁxed points of the test
particle equation of motion. These can be, for example, the center of mass of halos. In their neighborhood, we
can linearize the equation of motion at the points ¯x, which yields the linear system
d
dτ

madx
dτ

≈−ma ∇2Φ(¯x) · (x −¯x) ,
(C.16)
or, in terms of coordinates,
d
dτ

madxi
dτ

≈−ma
X
j
∂2Φ
∂xi∂xj
(¯x) (xj −¯xj) ∝−ma
X
j
Tij(¯x) (xj −¯xj) .
(C.17)
This equation means that the linear dynamics near local extrema of the gravitational potential is fully governed
by the tidal ﬁeld. The number of positive eigenvalues is equivalent to the dimension of the stable manifold at
the ﬁxed points:
• voids are regions of space where the orbits of test particles are unstable (no positive eigenvalue);
• sheets correspond to one-dimensional stable manifolds (one positive, two negative eigenvalues);
• ﬁlaments correspond to two-dimensional stable manifolds (two positive, one negative eigenvalues);
• clusters are attractive ﬁxed points (three positive eigenvalues).
Dropping the assumption of local extrema of the gravitational potential introduces a constant acceleration
term to the linearized equation of motion. This zeroth-order eﬀect can be ignored by changing to free-falling
coordinates. The behavior introduced by the ﬁrst-order term, representing the tidal deformation of orbits, and
thus the web-type classiﬁcation, remain unchanged.
C.2.4
Extensions of the T-web
C.2.4.1
Varying threshold
Several extensions of this classiﬁcation procedure exist. Forero-Romero et al. (2009) pointed out that rather
than using a threshold value µth of zero, diﬀerent positive values can be used. The corresponding set of rules is
given by table C.2.
Structure type
Rule
Void
µ1, µ2, µ3 < µth
Sheet
µ1, µ2 < µth and µ3 > µth
Filament
µ1 < µth and µ2, µ3 > µth
Cluster
µ1, µ2, µ3 > µth
Table C.2: Rules for classiﬁcation of structure types according to the extended T-web procedure with varying threshold
(Forero-Romero et al., 2009).
This introduces a new free parameter, which a priori can take any value. However, Forero-Romero et al.
(2009) argued that a natural threshold can be roughly estimated by equating the collapse time (determined
by the eigenvalues) to the age of the Universe. For an isotropic collapse, they calculated explicitly µth = 3.21
(appendix A in Forero-Romero et al., 2009). As gravitational collapse is often highly anisotropic, they used an
empirical approach to determine the threshold and argued that µth ≈1 can yield better web classiﬁcations than
the original T-web, down to the megaparsec scale.
The T-web procedure and/or this extension have been used, for example, by Jasche et al. (2010b); Wang
et al. (2012); Forero-Romero, Contreras & Padilla (2014); Nuza et al. (2014); Alonso, Eardley & Peacock (2015);
Eardley et al. (2015); Forero-Romero & González (2015); Leclercq, Jasche & Wandelt (2015c); Zhao et al. (2015);
Aung & Cohn (2015).

184
Appendix C. Cosmic structures identiﬁcation and classiﬁcation algorithms
C.2.4.2
The V-web
Hoﬀman et al. (2012) reformulated the extended T-web procedure using the velocity shear tensor instead
of the gravitational tidal tensor. More precisely, they use the eigenvalues µV
i (x) of the rescaled shear tensor
deﬁned by
Σij ≡−
1
2H(z)
∂vi
∂rj
+ ∂vj
∂ri

.
(C.18)
This new scheme is generally referred to as the “V-web” and the rules are given in table C.3. Hoﬀman et al.
(2012) showed that the two classiﬁcations coincide at large scales (where the gravitational and velocity ﬁelds are
proportional) and that the velocity ﬁeld resolves ﬁner structure than the gravitational ﬁeld at the smallest scales
(sub-megaparsec). They empirically determined the threshold value µV
th = 0.44 to yield the best visualization
of the geometrical characteristics of the four environments at z = 0.
Structure type
Rule
Void
µV
1 , µV
2 , µV
3 < µV
th
Sheet
µV
1 , µV
2 < µth and µV
3 > µV
th
Filament
µV
1 < µV
th and µV
2 , µV
3 > µV
th
Cluster
µV
1 , µV
2 , µV
3 > µV
th
Table C.3: Rules for classiﬁcation of structure types according to the V-web procedure (Hoﬀman et al., 2012).
The V-web has been used, for example, by Libeskind et al. (2013); Carlesi et al. (2014); Nuza et al. (2014);
Lee, Rey & Kim (2014); Libeskind, Hoﬀman & Gottlöber (2014). In this thesis, we probe scales down to a few
Mpc/h (the voxel size in our reconstructions or simulations). Therefore, we will be content with the original
T-web procedure as formulated by Hahn et al. (2007a).
C.2.5
Implementation
This section gives details on how the T-web procedure is implemented when used in this thesis. First, the
density contrast ﬁeld is computed by assigning particles to the grid with a CiC scheme (see section B.3). It is
transformed to Fourier space using a Fourier transform on the grid. At this point, if desired, the density ﬁeld
can be smoothed using a Gaussian kernel Kks(k) ≡exp

−1
2
k2
k2s

(usually this step is bypassed in the projects
described in this thesis). This corresponds to a mass scale Ms which is linked to the smoothing length Rs ≡2π
ks
by
Rs =
1
√
2π
Ms
¯ρ
1/3
.
(C.19)
The reduced gravitational potential is estimated by solving the Poisson equation in Fourier space, ˜Φ(k) =
G(k)δ(k), where G(k) is the Green function corresponding to the discretization adopted for the Laplacian.
For the projects described in this thesis, we adopted the simple form G(k) = −1/k2 (with also a smoothing
of short-range forces and two deconvolutions of the CiC kernel, see section B.4.1). Hence, the gravitational
potential is given by the convolution
˜Φ(x) = (G ∗δ)(x),
(C.20)
or, if the density ﬁeld had been smoothed, by
˜ΦRs(x) = (G ∗Kks ∗δ)(x).
(C.21)
We compute the components of the tidal tensor in Fourier space using Tab = −˜Φ(k)kakb, and transform them
back to conﬁguration space by inverse Fourier transform. In practice, only one Fourier transform is required to
go from δ to Tab ∝−δ(k)kakb/k2 (or Tab ∝−δ(k)kakbKks(k)/k2). Finally, we compute the eigenvalues of the
tidal tensor at each voxel of the grid and classify structures using the rules given in table C.1. In this fashion,
every voxel of the density ﬁeld gets assigned a ﬂag corresponding to the structure type: T0 for voids, T1 for
sheets, T2 for ﬁlaments, T3 for clusters.
The T-web classiﬁcation takes a few seconds on 8 cores, for a typical density ﬁeld used in this thesis
(L = 750 Mpc/h, Nv = 2563).

C.2. The T-web
185
0
50
100
150
200
x [Mpc/h]
200
150
100
50
0
y [Mpc/h]
µ1
0
50
100
150
200
x [Mpc/h]
200
150
100
50
0
µ2
0
50
100
150
200
x [Mpc/h]
200
150
100
50
0
µ3
0
50
100
150
200
x [Mpc/h]
200
150
100
50
0
δ
−50
−25
0
25
50
75
100
125
150
Figure C.1: Slices through the voxel-wise eigenvalues µ1 ≤µ2 ≤µ3 of the tidal ﬁeld tensor in the ﬁnal conditions of a dark
matter simulation. The rightmost panel shows the corresponding slice through the ﬁnal density contrast δ = µ1 +µ2 +µ3
(equation (C.9)). See also ﬁgure 9.2 for comparison.
0
50
100
150
200
x [Mpc/h]
200
150
100
50
0
y [Mpc/h]
voids
sheets
ﬁlaments
clusters
0
50
100
150
200
x [Mpc/h]
200
150
100
50
0
y [Mpc/h]
0.0
0.8
1.6
2.4
3.2
4.0
4.8
5.6
ln(2 + δ)
Figure C.2: Left panel. Classiﬁcation of structures with the T-web procedure in the ﬁnal conditions of a dark matter
simulation. The color coding is blue for voids, green for sheets, yellow for ﬁlaments and red for clusters. Right panel.
Dark matter density in the corresponding slice (for convenience, the quantity shown in ln(2 + δ)).
C.2.6
Example
As an example, in this section, we show the results of the T-web classiﬁcation for a simulated density ﬁeld.
The simulation contains 5123 dark matter particles in a comoving box of 750 Mpc/h with periodic boundary
conditions. The initial conditions have been generated at z = 69 using second-order Lagrangian perturbation
theory. They obey Gaussian statistics with an Eisenstein & Hu (1998, 1999) power spectrum. The N-body
simulation has been run to z = 0 with Gadget-2 (Springel, Yoshida & White, 2001; Springel, 2005). Particles
are assigned to the grid using a CiC method. The cosmological parameters used are
ΩΛ = 0.728, Ωm = 0.272, Ωb = 0.045, σ8 = 0.807, h = 0.702, ns = 0.961,
(C.22)
which gives a mass resolution of 2.37 × 1011 M⊙/h.
For clarity, we show slices through a 200 Mpc/h region of the simulation. Figure C.1 shows the eigenvalues
of the tidal tensor and the density contrast.
A slice through the corresponding voxel-wise classiﬁcation of
structures is shown in the left panel of ﬁgure C.2.


Bibliography
(Abazajian et al., 2009) K. N. Abazajian, J. K. Adelman-McCarthy, M. A. Agüeros, S. S. Allam, C. Allende
Prieto, D. An, K. S. J. Anderson, S. F. Anderson, J. Annis, N. A. Bahcall, et al., The Seventh Data Release
of the Sloan Digital Sky Survey, Astrophysical Journal Supplement 182, 543 (2009), arXiv:0812.0649.
(Abdalla et al., 2012) F. Abdalla, J. Annis, D. Bacon, S. Bridle, F. Castander, M. Colless, D. DePoy, H. T.
Diehl, M. Eriksen, B. Flaugher, J. Frieman, E. Gaztanaga, C. Hogan, S. Jouvel, S. Kent, D. Kirk, R. Kron,
S. Kuhlmann, O. Lahav, J. Lawrence, H. Lin, J. Marriner, J. Marshall, J. Mohr, R. C. Nichol, M. Sako,
W. Saunders, M. Soares-Santos, D. Thomas, R. Wechsler, A. West, H. Wu, The Dark Energy Spectrometer
(DESpec): A Multi-Fiber Spectroscopic Upgrade of the Dark Energy Camera and Survey for the Blanco
Telescope, ArXiv e-prints (2012), arXiv:1209.2451 [astro-ph.CO].
(Abel, Hahn & Kaehler, 2012) T. Abel, O. Hahn, R. Kaehler, Tracing the dark matter sheet in phase space,
Monthly Notices of the Royal Astronomical Society 427, 61 (2012), arXiv:1111.3944 [astro-ph.CO].
(Albrecht & Steinhardt, 1982) A. Albrecht, P. J. Steinhardt, Cosmology for grand uniﬁed theories with radiatively
induced symmetry breaking, Physical Review Letters 48, 1220 (1982).
(Alcock & Paczynski, 1979) C. Alcock, B. Paczynski, An evolution free test for non-zero cosmological constant,
Nature 281, 358 (1979).
(Alonso, Eardley & Peacock, 2015) D. Alonso, E. Eardley, J. A. Peacock, Halo abundances within the cosmic
web, Monthly Notices of the Royal Astronomical Society 447, 2683 (2015), arXiv:1406.4159.
(Alpher, Bethe & Gamow, 1948) R. A. Alpher, H. Bethe, G. Gamow, The Origin of Chemical Elements, Physical
Review 73, 803 (1948).
(Altay, Colberg & Croft, 2006) G. Altay, J. M. Colberg, R. A. C. Croft, The inﬂuence of large-scale structures
on halo shapes and alignments, Monthly Notices of the Royal Astronomical Society 370, 1422 (2006), astro-
ph/0605296.
(Amendola et al., 2013) L. Amendola, S. Appleby, D. Bacon, T. Baker, M. Baldi, N. Bartolo, A. Blanchard,
C. Bonvin, S. Borgani, E. Branchini, C. Burrage, S. Camera, C. Carbone, L. Casarini, M. Cropper, C. de
Rham, C. Di Porto, A. Ealet, P. G. Ferreira, F. Finelli, J. García-Bellido, T. Giannantonio, L. Guzzo,
A. Heavens, L. Heisenberg, C. Heymans, H. Hoekstra, L. Hollenstein, R. Holmes, O. Horst, K. Jahnke, T. D.
Kitching, T. Koivisto, M. Kunz, G. La Vacca, M. March, E. Majerotto, K. Markovic, D. Marsh, F. Marulli,
R. Massey, Y. Mellier, D. F. Mota, N. Nunes, W. Percival, V. Pettorino, C. Porciani, C. Quercellini, J. Read,
M. Rinaldi, D. Sapone, R. Scaramella, C. Skordis, F. Simpson, A. Taylor, S. Thomas, R. Trotta, L. Verde,
F. Vernizzi, A. Vollmer, Y. Wang, J. Weller, T. Zlosnik, Cosmology and Fundamental Physics with the Euclid
Satellite, Living Reviews in Relativity 16, 6 (2013), arXiv:1206.1225.
(Anderes, Wandelt & Lavaux, 2015) E. Anderes, B. D. Wandelt, G. Lavaux, Bayesian Inference of CMB
Gravitational Lensing, Astrophysical Journal 808, 152 (2015), arXiv:1412.4079.
(Aragon-Calvo & Szalay, 2013) M. A. Aragon-Calvo, A. S. Szalay, The hierarchical structure and dynamics of
voids, Monthly Notices of the Royal Astronomical Society 428, 3409 (2013), arXiv:1203.0248 [astro-ph.CO].
(Aragon-Calvo & Yang, 2014) M. A. Aragon-Calvo, L. F. Yang, The hierarchical nature of the spin alignment
of dark matter haloes in ﬁlaments, Monthly Notices of the Royal Astronomical Society 440, L46 (2014),
arXiv:1303.1590 [astro-ph.CO].
(Aragón-Calvo, van de Weygaert & Jones, 2010) M. A. Aragón-Calvo, R. van de Weygaert, B. J. T. Jones,
Multiscale phenomenology of the cosmic web, Monthly Notices of the Royal Astronomical Society 408, 2163
(2010), arXiv:1007.0742 [astro-ph.CO].
(Aragón-Calvo et al., 2007) M. A. Aragón-Calvo, B. J. T. Jones, R. van de Weygaert, J. M. van der Hulst, The
multiscale morphology ﬁlter: identifying and extracting spatial patterns in the galaxy distribution, Astronomy
and Astrophysics 474, 315 (2007), arXiv:0705.2072.

188
Bibliography
(Arber, 1954) A. R. Arber, The Mind and the Eye (Cambridge University Press, 1954).
(Ata, Kitaura & Müller, 2015) M. Ata, F.-S. Kitaura, V. Müller, Bayesian inference of cosmic density ﬁelds
from non-linear, scale-dependent, and stochastic biased tracers, Monthly Notices of the Royal Astronomical
Society 446, 4250 (2015), arXiv:1408.2566.
(Aung & Cohn, 2015) H. Aung, J. D. Cohn, Mean maps for cosmic web structures in cosmological initial
conditions, ArXiv e-prints (2015), arXiv:1505.07887.
(Babul & Starkman, 1992) A. Babul, G. D. Starkman, A quantitative measure of structure in the three-
dimensional galaxy distribution - Sheets and ﬁlaments, Astrophysical Journal 401, 28 (1992).
(Bardeen, 1980) J. M. Bardeen, Gauge-invariant cosmological perturbations, Physical Review D 22, 1882 (1980).
(Bardeen, Steinhardt & Turner, 1983) J. M. Bardeen, P. J. Steinhardt, M. S. Turner, Spontaneous creation of
almost scale-free density perturbations in an inﬂationary universe, Physical Review D 28, 679 (1983).
(Bardeen et al., 1986) J. M. Bardeen, J. R. Bond, N. Kaiser, A. S. Szalay, The statistics of peaks of Gaussian
random ﬁelds, Astrophysical Journal 304, 15 (1986).
(Barrow, Bhavsar & Sonoda, 1985) J. D. Barrow, S. P. Bhavsar, D. H. Sonoda, Minimal spanning trees, ﬁlaments
and galaxy clustering, Monthly Notices of the Royal Astronomical Society 216, 17 (1985).
(Baumann, 2011) D. Baumann, The Physics of Inﬂation (2011).
(Baumann et al., 2012) D. Baumann, A. Nicolis, L. Senatore, M. Zaldarriaga, Cosmological non-linearities as an
eﬀective ﬂuid, Journal of Cosmology and Astroparticle Physics 7, 051 (2012), arXiv:1004.2488 [astro-ph.CO].
(Bellman, 1961) R. E. Bellman, Adaptive Control Processes: A Guided Tour (Princeton University Press, 1961).
(Benítez et al., 2015) N. Benítez, R. Dupke, M. Moles, L. Sodré, A. J. Cenarro, A. Marín Franch, K. Tay-
lor, D. Cristóbal, A. Fernández-Soto, C. Mendes de Oliveira, J. Cepa-Nogué, L. R. Abramo, J. S. Alcaniz,
R. Overzier, C. Hernández-Monteagudo, E. J. Alfaro, A. Kanaan, M. Carvano, R. R. R. Reis, J-PAS col-
laboration, J-PAS: The Javalambre-Physics of the Accelerated Universe Astrophysical Survey, in Highlights
of Spanish Astrophysics VIII, edited by A. J. Cenarro, F. Figueras, C. Hernández-Monteagudo, J. Trujillo
Bueno, L. Valdivielso (2015) pp. 148–153, arXiv:1403.5237 [astro-ph.CO].
(Benson et al., 2003) A. J. Benson, F. Hoyle, F. Torres, M. S. Vogeley, Galaxy voids in cold dark matter
universes, Monthly Notices of the Royal Astronomical Society 340, 160 (2003), astro-ph/0208257.
(Berger, 1985) J. O. Berger, Statistical decision theory and Bayesian analysis (Springer, 1985).
(Bernardeau, 1994) F. Bernardeau, The nonlinear evolution of rare events, Astrophysical Journal 427, 51 (1994),
astro-ph/9311066.
(Bernardeau et al., 2002) F. Bernardeau, S. Colombi, E. Gaztañaga, R. Scoccimarro, Large-scale structure of
the Universe and cosmological perturbation theory, Physics Reports 367, 1 (2002), astro-ph/0112551.
(Bertschinger, 1998) E. Bertschinger, Simulations of Structure Formation in the Universe, Annual review of
astronomy and astrophysics 36, 599 (1998).
(Bertschinger, 2001) E. Bertschinger, Multiscale Gaussian Random Fields and Their Application to Cosmological
Simulations, Astrophysical Journal Supplement 137, 1 (2001), astro-ph/0103301.
(Bertschinger, 1987) E. Bertschinger, Path integral methods for primordial density perturbations - Sampling of
constrained Gaussian random ﬁelds, Astrophysical Journal Letters 323, L103 (1987).
(Bertschinger & Jain, 1994) E. Bertschinger, B. Jain, Gravitational instability of cold matter, Astrophysical
Journal 431, 486 (1994), arXiv:astro-ph/9307033.
(Betancort-Rijo et al., 2009) J. Betancort-Rijo, S. G. Patiri, F. Prada, A. E. Romano, The statistics of voids as
a tool to constrain cosmological parameters: σ8 and Ωmh, Monthly Notices of the Royal Astronomical Society
400, 1835 (2009), arXiv:0901.1609.

Bibliography
189
(Birdsall & Langdon, 1985) C. K. Birdsall, A. B. Langdon, Plasma Physics via Computer Simulation (CRC
Press, 1985).
(Biswas, Alizadeh & Wandelt, 2010) R. Biswas, E. Alizadeh, B. D. Wandelt, Voids as a precision probe of dark
energy, Physical Review D 82, 023002 (2010), arXiv:1002.0014 [astro-ph.CO].
(Blanton & Roweis, 2007) M. R. Blanton, S. Roweis, K-Corrections and Filter Transformations in the Ultraviolet,
Optical, and Near-Infrared, Astronomical Journal 133, 734 (2007), astro-ph/0606170.
(Blanton et al., 2003a) M. R. Blanton, H. Lin, R. H. Lupton, F. M. Maley, N. Young, I. Zehavi, J. Loveday,
An Eﬃcient Targeting Strategy for Multiobject Spectrograph Surveys: the Sloan Digital Sky Survey “Tiling”
Algorithm, Astronomical Journal 125, 2276 (2003a), astro-ph/0105535.
(Blanton et al., 2003b) M. R. Blanton, J. Brinkmann, I. Csabai, M. Doi, D. Eisenstein, M. Fukugita, J. E.
Gunn, D. W. Hogg, D. J. Schlegel, Estimating Fixed-Frame Galaxy Magnitudes in the Sloan Digital Sky
Survey, Astronomical Journal 125, 2348 (2003b), astro-ph/0205243.
(Blanton et al., 2005) M. R. Blanton, D. J. Schlegel, M. A. Strauss, J. Brinkmann, D. Finkbeiner, M. Fukugita,
J. E. Gunn, D. W. Hogg, Ž. Ivezić, G. R. Knapp, R. H. Lupton, J. A. Munn, D. P. Schneider, M. Tegmark,
I. Zehavi, New York University Value-Added Galaxy Catalog: A Galaxy Catalog Based on New Public Surveys,
Astronomical Journal 129, 2562 (2005), astro-ph/0410166.
(Blanton et al., 2003c) M. R. Blanton, D. W. Hogg, N. A. Bahcall, J. Brinkmann, M. Britton, A. J. Con-
nolly, I. Csabai, M. Fukugita, J. Loveday, A. Meiksin, J. A. Munn, R. C. Nichol, S. Okamura, T. Quinn,
D. P. Schneider, K. Shimasaku, M. A. Strauss, M. Tegmark, M. S. Vogeley, D. H. Weinberg, The Galaxy
Luminosity Function and Luminosity Density at Redshift z = 0.1, Astrophysical Journal 592, 819 (2003c),
astro-ph/0210215.
(Blas, Lesgourgues & Tram, 2011) D. Blas, J. Lesgourgues, T. Tram, The Cosmic Linear Anisotropy Solving
System (CLASS). Part II: Approximation schemes, Journal of Cosmology and Astroparticle Physics 7, 034
(2011), arXiv:1104.2933.
(Blumenthal et al., 1984) G. R. Blumenthal, S. M. Faber, J. R. Primack, M. J. Rees, Formation of galaxies and
large-scale structure with cold dark matter, Nature 311, 517 (1984).
(Blumenthal et al., 1992) G. R. Blumenthal, L. N. da Costa, D. S. Goldwirth, M. Lecar, T. Piran, The largest
possible voids, Astrophysical Journal 388, 234 (1992).
(Bond & Szalay, 1983) J. R. Bond, A. S. Szalay, The collisionless damping of density ﬂuctuations in an expanding
universe, Astrophysical Journal 274, 443 (1983).
(Bond, Kofman & Pogosyan, 1996) J. R. Bond, L. Kofman, D. Pogosyan, How ﬁlaments of galaxies are woven
into the cosmic web, Nature 380, 603 (1996), astro-ph/9512141.
(Bond, Szalay & Turner, 1982) J. R. Bond, A. S. Szalay, M. S. Turner, Formation of galaxies in a gravitino-
dominated universe, Physical Review Letters 48, 1636 (1982).
(Bond, Strauss & Cen, 2010) N. A. Bond, M. A. Strauss, R. Cen, Crawling the cosmic network: identifying
and quantifying ﬁlamentary structure, Monthly Notices of the Royal Astronomical Society 409, 156 (2010),
arXiv:1003.3237 [astro-ph.CO].
(Bos et al., 2012) E. G. P. Bos, R. van de Weygaert, K. Dolag, V. Pettorino, The darkness that shaped the
void: dark energy and cosmic voids, Monthly Notices of the Royal Astronomical Society 426, 440 (2012),
arXiv:1205.4238 [astro-ph.CO].
(Bouchet et al., 1995) F. R. Bouchet, S. Colombi, E. Hivon, R. Juszkiewicz, Perturbative Lagrangian approach
to gravitational instability, Astronomy and Astrophysics 296, 575 (1995), astro-ph/9406013.
(Bryan, Cameron & Allen, 1999) M. Bryan, J. Cameron, C. A. Allen, The Artist’s Way at Work: Riding the
Dragon (William Morrow, 1999).

190
Bibliography
(Buchert, 1989) T. Buchert, A class of solutions in Newtonian cosmology and the pancake theory, Astronomy
and Astrophysics 223, 9 (1989).
(Buchert, Melott & Weiß, 1994) T. Buchert, A. L. Melott, A. G. Weiß, Testing higher-order Lagrangian pertur-
bation theory against numerical simulations I. Pancake models, Astronomy and Astrophysics 288, 349 (1994),
astro-ph/9309056.
(Cai et al., 2010) Y.-C. Cai, S. Cole, A. Jenkins, C. S. Frenk, Full-sky map of the ISW and Rees-Sciama eﬀect
from Gpc simulations, Monthly Notices of the Royal Astronomical Society 407, 201 (2010), arXiv:1003.0974
[astro-ph.CO].
(Cai et al., 2014) Y.-C. Cai, M. C. Neyrinck, I. Szapudi, S. Cole, C. S. Frenk, A Possible Cold Imprint of Voids on
the Microwave Background Radiation, Astrophysical Journal 786, 110 (2014), arXiv:1301.6136 [astro-ph.CO].
(Cameron & Pettitt, 2012) E. Cameron, A. N. Pettitt, Approximate Bayesian Computation for astronomi-
cal model analysis: a case study in galaxy demographics and morphological transformation at high redshift,
Monthly Notices of the Royal Astronomical Society 425, 44 (2012), arXiv:1202.1426 [astro-ph.IM].
(Carlesi et al., 2014) E. Carlesi, A. Knebe, G. F. Lewis, S. Wales, G. Yepes, Hydrodynamical simulations of
coupled and uncoupled quintessence models - I. Halo properties and the cosmic web, Monthly Notices of the
Royal Astronomical Society 439, 2943 (2014), arXiv:1401.5005 [astro-ph.CO].
(Carrasco, Hertzberg & Senatore, 2012) J. J. M. Carrasco, M. P. Hertzberg, L. Senatore, The eﬀective ﬁeld
theory of cosmological large scale structures, Journal of High Energy Physics 9, 82 (2012), arXiv:1206.2926
[astro-ph.CO].
(Carroll, Press & Turner, 1992) S. M. Carroll, W. H. Press, E. L. Turner, The cosmological constant, Annual
review of astronomy and astrophysics 30, 499 (1992).
(Carron, 2012) J. Carron, Information Escaping the Correlation Hierarchy of the Convergence Field in the Study
of Cosmological Parameters, Physical Review Letters 108, 071301 (2012), arXiv:1201.1000 [astro-ph.IM].
(Carron & Neyrinck, 2012) J. Carron, M. C. Neyrinck, On the Inadequacy of N-point Correlation Functions
to Describe Nonlinear Cosmological Fields: Explicit Examples and Connection to Simulations, Astrophysical
Journal 750, 28 (2012), arXiv:1201.1444 [astro-ph.CO].
(Casas-Miranda et al., 2002) R. Casas-Miranda, H. J. Mo, R. K. Sheth, G. Boerner, On the distribution of haloes,
galaxies and mass, Monthly Notices of the Royal Astronomical Society 333, 730 (2002), astro-ph/0105008.
(Cautun & van de Weygaert, 2011) M. C. Cautun, R. van de Weygaert, The DTFE public software - The
Delaunay Tessellation Field Estimator code, ArXiv e-prints (2011), arXiv:1105.0370 [astro-ph.IM].
(Cautun, van de Weygaert & Jones, 2013) M. Cautun, R. van de Weygaert, B. J. T. Jones, NEXUS: tracing the
cosmic web connection, Monthly Notices of the Royal Astronomical Society 429, 1286 (2013), arXiv:1209.2043
[astro-ph.CO].
(Cautun et al., 2014) M. Cautun, R. van de Weygaert, B. J. T. Jones, C. S. Frenk, Evolution of the cosmic web,
Monthly Notices of the Royal Astronomical Society 441, 2923 (2014), arXiv:1401.7866.
(Ceccarelli et al., 2013) L. Ceccarelli, D. Paz, M. Lares, N. Padilla, D. G. Lambas, Clues on void evolution - I.
Large-scale galaxy distributions around voids, Monthly Notices of the Royal Astronomical Society 434, 1435
(2013), arXiv:1306.5798 [astro-ph.CO].
(Chan, 2014) K. C. Chan, Helmholtz decomposition of the Lagrangian displacement, Physical Review D 89,
083515 (2014), arXiv:1309.2243.
(Clampitt & Jain, 2014) J. Clampitt, B. Jain, Lensing Measurements of the Mass Distribution in SDSS Voids,
ArXiv e-prints (2014), arXiv:1404.1834.
(Clampitt, Cai & Li, 2013) J. Clampitt, Y.-C. Cai, B. Li, Voids in modiﬁed gravity: excursion set predictions,
Monthly Notices of the Royal Astronomical Society 431, 749 (2013), arXiv:1212.2216 [astro-ph.CO].

Bibliography
191
(Codis et al., 2012) S. Codis, C. Pichon, J. Devriendt, A. Slyz, D. Pogosyan, Y. Dubois, T. Sousbie, Connecting
the cosmic web to the spin of dark haloes: implications for galaxy formation, Monthly Notices of the Royal
Astronomical Society 427, 3320 (2012), arXiv:1201.5794 [astro-ph.CO].
(Codis et al., 2015) S. Codis, R. Gavazzi, Y. Dubois, C. Pichon, K. Benabed, V. Desjacques, D. Pogosyan,
J. Devriendt, A. Slyz, Intrinsic alignment of simulated galaxies in the cosmic web: implications for weak
lensing surveys, Monthly Notices of the Royal Astronomical Society 448, 3391 (2015), arXiv:1406.4668.
(Coelho, 1988) P. Coelho, The Alchemist (HarperTorch, 1988).
(Colberg et al., 2005) J. M. Colberg, R. K. Sheth, A. Diaferio, L. Gao, N. Yoshida, Voids in a ΛCDM universe,
Monthly Notices of the Royal Astronomical Society 360, 216 (2005), astro-ph/0409162.
(Colberg et al., 2008) J. M. Colberg, F. Pearce, C. Foster, E. Platen, R. Brunino, M. Neyrinck, S. Basilakos,
A. Fairall, H. Feldman, S. Gottlöber, O. Hahn, F. Hoyle, V. Müller, L. Nelson, M. Plionis, C. Porciani,
S. Shandarin, M. S. Vogeley, R. van de Weygaert, The Aspen-Amsterdam void ﬁnder comparison project,
Monthly Notices of the Royal Astronomical Society 387, 933 (2008), arXiv:0803.0918.
(Cole & Kaiser, 1989) S. Cole, N. Kaiser, Biased clustering in the cold dark matter cosmogony, Monthly Notices
of the Royal Astronomical Society 237, 1127 (1989).
(Cole et al., 2005) S. Cole, W. J. Percival, J. A. Peacock, P. Norberg, C. M. Baugh, C. S. Frenk, I. Baldry,
J. Bland-Hawthorn, T. Bridges, R. Cannon, M. Colless, C. Collins, W. Couch, N. J. G. Cross, G. Dalton,
V. R. Eke, R. De Propris, S. P. Driver, G. Efstathiou, R. S. Ellis, K. Glazebrook, C. Jackson, A. Jenkins,
O. Lahav, I. Lewis, S. Lumsden, S. Maddox, D. Madgwick, B. A. Peterson, W. Sutherland, K. Taylor, The
2dF Galaxy Redshift Survey: power-spectrum analysis of the ﬁnal data set and cosmological implications,
Monthly Notices of the Royal Astronomical Society 362, 505 (2005), astro-ph/0501174.
(Coles & Jones, 1991) P. Coles, B. Jones, A lognormal model for the cosmological mass distribution, Monthly
Notices of the Royal Astronomical Society 248, 1 (1991).
(Coles, Melott & Shandarin, 1993) P. Coles, A. L. Melott, S. F. Shandarin, Testing approximations for non-linear
gravitational clustering, Monthly Notices of the Royal Astronomical Society 260, 765 (1993).
(Colless et al., 2003) M. Colless, B. A. Peterson, C. Jackson, J. A. Peacock, S. Cole, P. Norberg, I. K. Baldry,
C. M. Baugh, J. Bland-Hawthorn, T. Bridges, R. Cannon, C. Collins, W. Couch, N. Cross, G. Dalton, R. De
Propris, S. P. Driver, G. Efstathiou, R. S. Ellis, C. S. Frenk, K. Glazebrook, O. Lahav, I. Lewis, S. Lumsden,
S. Maddox, D. Madgwick, W. Sutherland, K. Taylor, The 2dF Galaxy Redshift Survey: Final Data Release,
ArXiv Astrophysics e-prints (2003), astro-ph/0306581.
(Colombi, 1994) S. Colombi, A ’skewed’ lognormal approximation to the probablility distribution function of the
large-scale density ﬁeld, Astrophysical Journal 435, 536 (1994), astro-ph/9402071.
(Cooray & Sheth, 2002) A. Cooray, R. Sheth, Halo models of large scale structure, Physics Reports 372, 1
(2002), arXiv:astro-ph/0206508.
(Cox, 1946) R. T. Cox, Probability, Frequency and Reasonable Expectation, American Journal of Physics 14, 1
(1946).
(Crocce & Scoccimarro, 2006) M. Crocce, R. Scoccimarro, Renormalized cosmological perturbation theory, Phys-
ical Review D 73, 063519 (2006), astro-ph/0509418.
(Crocce, Pueblas & Scoccimarro, 2006a) M. Crocce, S. Pueblas, R. Scoccimarro, Transients from initial con-
ditions in cosmological simulations, Monthly Notices of the Royal Astronomical Society 373, 369 (2006a),
astro-ph/0606505.
(Crocce, Pueblas & Scoccimarro, 2006b) M. Crocce, S. Pueblas, R. Scoccimarro, Transients from initial con-
ditions in cosmological simulations, Monthly Notices of the Royal Astronomical Society 373, 369 (2006b),
astro-ph/0606505.

192
Bibliography
(Croft et al., 1998) R. A. C. Croft, D. H. Weinberg, N. Katz, L. Hernquist, Recovery of the Power Spec-
trum of Mass Fluctuations from Observations of the Ly alpha Forest, Astrophysical Journal 495, 44 (1998),
arXiv:astro-ph/9708018.
(Croft et al., 1999) R. A. C. Croft, D. H. Weinberg, M. Pettini, L. Hernquist, N. Katz, The Power Spectrum of
Mass Fluctuations Measured from the LYalpha Forest at Redshift Z=2.5, Astrophysical Journal 520, 1 (1999),
arXiv:astro-ph/9809401.
(Dark Energy Survey Collaboration, 2005) Dark Energy Survey Collaboration, The Dark Energy Survey, ArXiv
Astrophysics e-prints (2005), astro-ph/0510346.
(Davis et al., 1985) M. Davis, G. Efstathiou, C. S. Frenk, S. D. M. White, The evolution of large-scale structure
in a universe dominated by cold dark matter, Astrophysical Journal 292, 371 (1985).
(Davis et al., 2003) M. Davis, S. M. Faber, J. Newman, A. C. Phillips, R. S. Ellis, C. C. Steidel, C. Conselice,
A. L. Coil, D. P. Finkbeiner, D. C. Koo, P. Guhathakurta, B. Weiner, R. Schiavon, C. Willmer, N. Kaiser,
G. A. Luppino, G. Wirth, A. Connolly, P. Eisenhardt, M. Cooper, B. Gerke, Science Objectives and Early
Results of the DEEP2 Redshift Survey, in Discoveries and Research Prospects from 6- to 10-Meter-Class
Telescopes II, Society of Photo-Optical Instrumentation Engineers (SPIE) Conference Series, Vol. 4834, edited
by P. Guhathakurta (2003) pp. 161–172, astro-ph/0209419.
(Davis et al., 2007) M. Davis, P. Guhathakurta, N. P. Konidaris, J. A. Newman, M. L. N. Ashby, A. D. Biggs,
P. Barmby, K. Bundy, S. C. Chapman, A. L. Coil, C. J. Conselice, M. C. Cooper, D. J. Croton, P. R. M.
Eisenhardt, R. S. Ellis, S. M. Faber, T. Fang, G. G. Fazio, A. Georgakakis, B. F. Gerke, W. M. Goss, S. Gwyn,
J. Harker, A. M. Hopkins, J.-S. Huang, R. J. Ivison, S. A. Kassin, E. N. Kirby, A. M. Koekemoer, D. C. Koo,
E. S. Laird, E. Le Floc’h, L. Lin, J. M. Lotz, P. J. Marshall, D. C. Martin, A. J. Metevier, L. A. Moustakas,
K. Nandra, K. G. Noeske, C. Papovich, A. C. Phillips, R. M. Rich, G. H. Rieke, D. Rigopoulou, S. Salim,
D. Schiminovich, L. Simard, I. Smail, T. A. Small, B. J. Weiner, C. N. A. Willmer, S. P. Willner, G. Wilson,
E. L. Wright, R. Yan, The All-Wavelength Extended Groth Strip International Survey (AEGIS) Data Sets,
Astrophysical Journal Letters 660, L1 (2007), astro-ph/0607355.
(de Lapparent, Geller & Huchra, 1986) V. de Lapparent, M. J. Geller, J. P. Huchra, A slice of the universe,
Astrophysical Journal Letters 302, L1 (1986).
(Dickey, 1971) J. M. Dickey, The weighted likelihood ratio, linear hypotheses on normal location parameters,
The Annals of Mathematical Statistics 42, 204 (1971).
(Doroshkevich, 1970a) A. G. Doroshkevich, The space structure of perturbations and the origin of rotation of
galaxies in the theory of ﬂuctuation., Astroﬁzika 6, 581 (1970a).
(Doroshkevich, 1970b) A. G. Doroshkevich, Spatial structure of perturbations and origin of galactic rotation in
ﬂuctuation theory, Astrophysics 6, 320 (1970b).
(Drinkwater et al., 2010) M. J. Drinkwater, R. J. Jurek, C. Blake, D. Woods, K. A. Pimbblet, K. Glazebrook,
R. Sharp, M. B. Pracy, S. Brough, M. Colless, W. J. Couch, S. M. Croom, T. M. Davis, D. Forbes, K. Forster,
D. G. Gilbank, M. Gladders, B. Jelliﬀe, N. Jones, I.-H. Li, B. Madore, D. C. Martin, G. B. Poole, T. Small,
E. Wisnioski, T. Wyder, H. K. C. Yee, The WiggleZ Dark Energy Survey: survey design and ﬁrst data release,
Monthly Notices of the Royal Astronomical Society 401, 1429 (2010), arXiv:0911.4246.
(Driver et al., 2009) S. P. Driver, P. Norberg, I. K. Baldry, S. P. Bamford, A. M. Hopkins, J. Liske, J. Loveday,
J. A. Peacock, D. T. Hill, L. S. Kelvin, A. S. G. Robotham, N. J. G. Cross, H. R. Parkinson, M. Prescott,
C. J. Conselice, L. Dunne, S. Brough, H. Jones, R. G. Sharp, E. van Kampen, S. Oliver, I. G. Roseboom,
J. Bland-Hawthorn, S. M. Croom, S. Ellis, E. Cameron, S. Cole, C. S. Frenk, W. J. Couch, A. W. Graham,
R. Proctor, R. De Propris, I. F. Doyle, E. M. Edmondson, R. C. Nichol, D. Thomas, S. A. Eales, M. J. Jarvis,
K. Kuijken, O. Lahav, B. F. Madore, M. Seibert, M. J. Meyer, L. Staveley-Smith, S. Phillipps, C. C. Popescu,
A. E. Sansom, W. J. Sutherland, R. J. Tuﬀs, S. J. Warren, GAMA: towards a physical understanding of galaxy
formation, Astronomy and Geophysics 50, 12 (2009), arXiv:0910.5123 [astro-ph.CO].
(Duane et al., 1987) S. Duane, A. D. Kennedy, B. J. Pendleton, D. Roweth, Hybrid Monte Carlo, Physics
Letters B 195, 216 (1987).

Bibliography
193
(Dubinski et al., 1993) J. Dubinski, L. N. da Costa, D. S. Goldwirth, M. Lecar, T. Piran, Void evolution and
the large-scale structure, Astrophysical Journal 410, 458 (1993).
(Dubois et al., 2014) Y. Dubois, C. Pichon, C. Welker, D. Le Borgne, J. Devriendt, C. Laigle, S. Codis,
D. Pogosyan, S. Arnouts, K. Benabed, E. Bertin, J. Blaizot, F. Bouchet, J.-F. Cardoso, S. Colombi, V. de
Lapparent, V. Desjacques, R. Gavazzi, S. Kassin, T. Kimm, H. McCracken, B. Milliard, S. Peirani, S. Prunet,
S. Rouberol, J. Silk, A. Slyz, T. Sousbie, R. Teyssier, L. Tresse, M. Treyer, D. Vibert, M. Volonteri, Danc-
ing in the dark: galactic properties trace spin swings along the cosmic web, Monthly Notices of the Royal
Astronomical Society 444, 1453 (2014), arXiv:1402.1165.
(Eardley et al., 2015) E. Eardley, J. A. Peacock, T. McNaught-Roberts, C. Heymans, P. Norberg, M. Alpaslan,
I. Baldry, J. Bland-Hawthorn, S. Brough, M. E. Cluver, S. P. Driver, D. J. Farrow, J. Liske, J. Loveday,
A. S. G. Robotham, Galaxy And Mass Assembly (GAMA): the galaxy luminosity function within the cosmic
web, Monthly Notices of the Royal Astronomical Society 448, 3665 (2015), arXiv:1412.2141.
(Efstathiou et al., 1985) G. Efstathiou, M. Davis, S. D. M. White, C. S. Frenk, Numerical techniques for large
cosmological N-body simulations, Astrophysical Journal Supplement 57, 241 (1985).
(Einstein & de Sitter, 1932) A. Einstein, W. de Sitter, On the Relation between the Expansion and the Mean
Density of the Universe, Proceedings of the National Academy of Science 18, 213 (1932).
(Eisenstein & Hu, 1999) D. J. Eisenstein, W. Hu, Power Spectra for Cold Dark Matter and Its Variants,
Astrophysical Journal 511, 5 (1999), astro-ph/9710252.
(Eisenstein & Hu, 1998) D. J. Eisenstein, W. Hu, Baryonic Features in the Matter Transfer Function, Astro-
physical Journal 496, 605 (1998), astro-ph/9709112.
(Eisenstein et al., 2007) D. J. Eisenstein, H.-J. Seo, E. Sirko, D. N. Spergel, Improving Cosmological Distance
Measurements by Reconstruction of the Baryon Acoustic Peak, Astrophysical Journal 664, 675 (2007), astro-
ph/0604362.
(Eisenstein et al., 2005) D. J. Eisenstein, I. Zehavi, D. W. Hogg, R. Scoccimarro, M. R. Blanton, R. C. Nichol,
R. Scranton, H.-J. Seo, M. Tegmark, Z. Zheng, S. F. Anderson, J. Annis, N. Bahcall, J. Brinkmann, S. Burles,
F. J. Castander, A. Connolly, I. Csabai, M. Doi, M. Fukugita, J. A. Frieman, K. Glazebrook, J. E. Gunn, J. S.
Hendry, G. Hennessy, Z. Ivezić, S. Kent, G. R. Knapp, H. Lin, Y.-S. Loh, R. H. Lupton, B. Margon, T. A.
McKay, A. Meiksin, J. A. Munn, A. Pope, M. W. Richmond, D. Schlegel, D. P. Schneider, K. Shimasaku,
C. Stoughton, M. A. Strauss, M. SubbaRao, A. S. Szalay, I. Szapudi, D. L. Tucker, B. Yanny, D. G. York,
Detection of the Baryon Acoustic Peak in the Large-Scale Correlation Function of SDSS Luminous Red
Galaxies, Astrophysical Journal 633, 560 (2005), astro-ph/0501171.
(Elsner & Wandelt, 2013) F. Elsner, B. D. Wandelt, Eﬃcient Wiener ﬁltering without preconditioning, Astron-
omy and Astrophysics 549, A111 (2013), arXiv:1210.4931 [astro-ph.CO].
(Elsner & Wandelt, 2010) F. Elsner, B. D. Wandelt, Local Non-Gaussianity in the Cosmic Microwave Back-
ground the Bayesian Way, Astrophysical Journal 724, 1262 (2010), arXiv:1010.1254 [astro-ph.CO].
(Elyiv et al., 2015) A. Elyiv, F. Marulli, G. Pollina, M. Baldi, E. Branchini, A. Cimatti, L. Moscardini, Cosmic
voids detection without density measurements, Monthly Notices of the Royal Astronomical Society 448, 642
(2015), arXiv:1410.4559.
(Erdoˇgdu et al., 2004) P. Erdoˇgdu, O. Lahav, S. Zaroubi, G. Efstathiou, S. Moody, J. A. Peacock, M. Colless,
I. K. Baldry, C. M. Baugh, J. Bland-Hawthorn, T. Bridges, R. Cannon, S. Cole, C. Collins, W. Couch,
G. Dalton, R. De Propris, S. P. Driver, R. S. Ellis, C. S. Frenk, K. Glazebrook, C. Jackson, I. Lewis,
S. Lumsden, S. Maddox, D. Madgwick, P. Norberg, B. A. Peterson, W. Sutherland, K. Taylor, The 2dF
Galaxy Redshift Survey: Wiener reconstruction of the cosmic web, Monthly Notices of the Royal Astronomical
Society 352, 939 (2004), astro-ph/0312546.
(Eriksen et al., 2004) H. K. Eriksen, I. J. O’Dwyer, J. B. Jewell, B. D. Wandelt, D. L. Larson, K. M. Górski,
S. Levin, A. J. Banday, P. B. Lilje, Power Spectrum Estimation from High-Resolution Maps by Gibbs Sampling,
Astrophysical Journal Supplement 155, 227 (2004), astro-ph/0407028.

194
Bibliography
(Falck, Neyrinck & Szalay, 2012) B. L. Falck, M. C. Neyrinck, A. S. Szalay, ORIGAMI: Delineating Halos Using
Phase-space Folds, Astrophysical Journal 754, 126 (2012), arXiv:1201.2353 [astro-ph.CO].
(Falck, Koyama & Zhao, 2015) B. Falck, K. Koyama, G.-B. Zhao, Cosmic web and environmental depen-
dence of screening: Vainshtein vs. chameleon, Journal of Cosmology and Astroparticle Physics 7, 049 (2015),
arXiv:1503.06673.
(Fendt & Wandelt, 2007) W. A. Fendt, B. D. Wandelt, Pico: Parameters for the Impatient Cosmologist,
Astrophysical Journal 654, 2 (2007), astro-ph/0606709.
(Feng & Fang, 2000) L.-L. Feng, L.-Z. Fang, Non-Gaussianity and the Recovery of the Mass Power Spectrum
from the Lyα Forest, Astrophysical Journal 535, 519 (2000), arXiv:astro-ph/0001348.
(Fitzgerald, 1925) F. S. Fitzgerald, The Great Gatsby (Charles Scribner’s Sons, 1925).
(Forero-Romero & González, 2015) J. E. Forero-Romero, R. González, The Local Group in the Cosmic Web,
Astrophysical Journal 799, 45 (2015), arXiv:1408.3166.
(Forero-Romero, Contreras & Padilla, 2014) J. E. Forero-Romero, S. Contreras, N. Padilla, Cosmic web align-
ments with the shape, angular momentum and peculiar velocities of dark matter haloes, Monthly Notices of
the Royal Astronomical Society 443, 1090 (2014), arXiv:1406.0508.
(Forero-Romero et al., 2009) J. E. Forero-Romero, Y. Hoﬀman, S. Gottlöber, A. Klypin, G. Yepes, A dynam-
ical classiﬁcation of the cosmic web, Monthly Notices of the Royal Astronomical Society 396, 1815 (2009),
arXiv:0809.4135.
(Furlanetto & Piran, 2006) S. R. Furlanetto, T. Piran, The evidence of absence: galaxy voids in the excursion
set formalism, Monthly Notices of the Royal Astronomical Society 366, 467 (2006), astro-ph/0509148.
(Galassi et al., 2003) M. Galassi, J. Davies, J. Theiler, B. Gough, G. Jungman, M. Booth, F. Rossi, Gnu
Scientiﬁc Library: Reference Manual (Network Theory Ltd., 2003).
(Gaztañaga & Yokoyama, 1993) E. Gaztañaga, J. Yokoyama, Probing the statistics of primordial ﬂuctuations
and their evolution, Astrophysical Journal 403, 450 (1993).
(Geller & Huchra, 1989) M. J. Geller, J. P. Huchra, Mapping the universe, Science 246, 897 (1989).
(Gelman & Rubin, 1992) A. Gelman, D. B. Rubin, Inference from Iterative Simulation Using Multiple Sequences,
Statistical Science 7, 457 (1992).
(Gelman et al., 2013) A. Gelman, J. B. Carlin, H. S. Stern, D. B. Dunson, A. Vehtari, D. B. Rubin, Bayesian
Data Analysis, Third Edition (Taylor & Francis, 2013).
(Gil-Marín et al., 2012) H. Gil-Marín, C. Wagner, F. Fragkoudi, R. Jimenez, L. Verde, An improved ﬁtting
formula for the dark matter bispectrum, Journal of Cosmology and Astroparticle Physics 2, 047 (2012),
arXiv:1111.4477 [astro-ph.CO].
(Gil-Marín et al., 2011) H. Gil-Marín, F. Schmidt, W. Hu, R. Jimenez, L. Verde, The bispectrum of f(R)
cosmologies, Journal of Cosmology and Astroparticle Physics 11, 019 (2011), arXiv:1109.2115 [astro-ph.CO].
(Goldberg & Vogeley, 2004) D. M. Goldberg, M. S. Vogeley, Simulating Voids, Astrophysical Journal 605, 1
(2004), astro-ph/0307191.
(Gott, Dickinson & Melott, 1986) J. R. Gott, III, M. Dickinson, A. L. Melott, The sponge-like topology of
large-scale structure in the universe, Astrophysical Journal 306, 341 (1986).
(Gott et al., 2005) J. R. Gott, III, M. Jurić, D. Schlegel, F. Hoyle, M. Vogeley, M. Tegmark, N. Bahcall,
J. Brinkmann, A Map of the Universe, Astrophysical Journal 624, 463 (2005), astro-ph/0310571.

Bibliography
195
(Green et al., 2012) J. Green, P. Schechter, C. Baltay, R. Bean, D. Bennett, R. Brown, C. Conselice, M. Donahue,
X. Fan, B. S. Gaudi, C. Hirata, J. Kalirai, T. Lauer, B. Nichol, N. Padmanabhan, S. Perlmutter, B. Rauscher,
J. Rhodes, T. Roellig, D. Stern, T. Sumi, A. Tanner, Y. Wang, D. Weinberg, E. Wright, N. Gehrels, R. Sam-
bruna, W. Traub, J. Anderson, K. Cook, P. Garnavich, L. Hillenbrand, Z. Ivezic, E. Kerins, J. Lunine, P. Mc-
Donald, M. Penny, M. Phillips, G. Rieke, A. Riess, R. van der Marel, R. K. Barry, E. Cheng, D. Content,
R. Cutri, R. Goullioud, K. Grady, G. Helou, C. Jackson, J. Kruk, M. Melton, C. Peddie, N. Rioux, M. Seif-
fert, Wide-Field InfraRed Survey Telescope (WFIRST) Final Report, ArXiv e-prints (2012), arXiv:1208.4012
[astro-ph.IM].
(Gregory & Thompson, 1978) S. A. Gregory, L. A. Thompson, The Coma/A1367 supercluster and its environs,
Astrophysical Journal 222, 784 (1978).
(Gregory, Thompson & Tiﬀt, 1981) S. A. Gregory, L. A. Thompson, W. G. Tiﬀt, The Perseus supercluster,
Astrophysical Journal 243, 411 (1981).
(Groth & Peebles, 1975) E. J. Groth, P. J. E. Peebles, Closed-form solutions for the evolution of density
perturbations in some cosmological models, Astronomy and Astrophysics 41, 143 (1975).
(Gunn & Gott, 1972) J. E. Gunn, J. R. Gott, III, On the Infall of Matter Into Clusters of Galaxies and Some
Eﬀects on Their Evolution, Astrophysical Journal 176, 1 (1972).
(Gurbatov, Saichev & Shandarin, 1989) S. N. Gurbatov, A. I. Saichev, S. F. Shandarin, The large-scale structure
of the universe in the frame of the model equation of non-linear diﬀusion, Monthly Notices of the Royal
Astronomical Society 236, 385 (1989).
(Guth, 1981) A. H. Guth, Inﬂationary universe: A possible solution to the horizon and ﬂatness problems,
Physical Review D 23, 347 (1981).
(Guth & Pi, 1982) A. H. Guth, S.-Y. Pi, Fluctuations in the new inﬂationary universe, Physical Review Letters
49, 1110 (1982).
(Guzzo et al., 2014) L. Guzzo, M. Scodeggio, B. Garilli, B. R. Granett, A. Fritz, U. Abbas, C. Adami, S. Arnouts,
J. Bel, M. Bolzonella, D. Bottini, E. Branchini, A. Cappi, J. Coupon, O. Cucciati, I. Davidzon, G. De Lucia,
S. de la Torre, P. Franzetti, M. Fumana, P. Hudelot, O. Ilbert, A. Iovino, J. Krywult, V. Le Brun, O. Le
Fèvre, D. Maccagni, K. Małek, F. Marulli, H. J. McCracken, L. Paioro, J. A. Peacock, M. Polletta, A. Pollo,
H. Schlagenhaufer, L. A. M. Tasca, R. Tojeiro, D. Vergani, G. Zamorani, A. Zanichelli, A. Burden, C. Di Porto,
A. Marchetti, C. Marinoni, Y. Mellier, L. Moscardini, R. C. Nichol, W. J. Percival, S. Phleps, M. Wolk, The
VIMOS Public Extragalactic Redshift Survey (VIPERS). An unprecedented view of galaxies and large-scale
structure at 0.5 < z < 1.2, Astronomy and Astrophysics 566, A108 (2014), arXiv:1303.2623.
(Guzzo et al., 2008) L. Guzzo, M. Pierleoni, B. Meneux, E. Branchini, O. Le Fèvre, C. Marinoni, B. Garilli,
J. Blaizot, G. De Lucia, A. Pollo, H. J. McCracken, D. Bottini, V. Le Brun, D. Maccagni, J. P. Picat,
R. Scaramella, M. Scodeggio, L. Tresse, G. Vettolani, A. Zanichelli, C. Adami, S. Arnouts, S. Bardelli,
M. Bolzonella, A. Bongiorno, A. Cappi, S. Charlot, P. Ciliegi, T. Contini, O. Cucciati, S. de la Torre, K. Dolag,
S. Foucaud, P. Franzetti, I. Gavignaud, O. Ilbert, A. Iovino, F. Lamareille, B. Marano, A. Mazure, P. Memeo,
R. Merighi, L. Moscardini, S. Paltani, R. Pellò, E. Perez-Montero, L. Pozzetti, M. Radovich, D. Vergani,
G. Zamorani, E. Zucca, A test of the nature of cosmic acceleration using galaxy redshift distortions, Nature
451, 541 (2008), arXiv:0802.1944.
(Hahn & Abel, 2011) O. Hahn, T. Abel, Multi-scale initial conditions for cosmological simulations, Monthly
Notices of the Royal Astronomical Society 415, 2101 (2011), arXiv:1103.6031.
(Hahn, Angulo & Abel, 2014) O. Hahn, R. E. Angulo, T. Abel, The Properties of Cosmic Velocity Fields, ArXiv
e-prints (2014), arXiv:1404.2280.
(Hahn et al., 2007a) O. Hahn, C. Porciani, C. M. Carollo, A. Dekel, Properties of dark matter haloes in
clusters, ﬁlaments, sheets and voids, Monthly Notices of the Royal Astronomical Society 375, 489 (2007a),
astro-ph/0610280.

196
Bibliography
(Hahn et al., 2007b) O. Hahn, C. M. Carollo, C. Porciani, A. Dekel, The evolution of dark matter halo properties
in clusters, ﬁlaments, sheets and voids, Monthly Notices of the Royal Astronomical Society 381, 41 (2007b),
arXiv:0704.2595.
(Hahn et al., 2009) O. Hahn, C. Porciani, A. Dekel, C. M. Carollo, Tidal eﬀects and the environment dependence
of halo assembly, Monthly Notices of the Royal Astronomical Society 398, 1742 (2009), arXiv:0803.4211.
(Hajian, 2007) A. Hajian, Eﬃcient cosmological parameter estimation with Hamiltonian MonteCarlo technique,
Physical Review D 75, 083525 (2007), arXiv:astro-ph/0608679.
(Hamaus, Sutter & Wandelt, 2014) N. Hamaus, P. M. Sutter, B. D. Wandelt, Universal Density Proﬁle for
Cosmic Voids, Physical Review Letters 112, 251302 (2014), arXiv:1403.5499.
(Hamaus et al., 2014a) N. Hamaus, P. M. Sutter, G. Lavaux, B. D. Wandelt, Testing cosmic geometry with-
out dynamic distortions using voids, Journal of Cosmology and Astroparticle Physics 12, 013 (2014a),
arXiv:1409.3580.
(Hamaus et al., 2014b) N. Hamaus, B. D. Wandelt, P. M. Sutter, G. Lavaux, M. S. Warren, Cosmology with
Void-Galaxy Correlations, Physical Review Letters 112, 041304 (2014b), arXiv:1307.2571 [astro-ph.CO].
(Hawking, 1982) S. W. Hawking, The development of irregularities in a single bubble inﬂationary universe,
Physics Letters B 115, 295 (1982).
(Hawkins et al., 2003) E. Hawkins, S. Maddox, S. Cole, O. Lahav, D. S. Madgwick, P. Norberg, J. A. Peacock,
I. K. Baldry, C. M. Baugh, J. Bland-Hawthorn, T. Bridges, R. Cannon, M. Colless, C. Collins, W. Couch,
G. Dalton, R. De Propris, S. P. Driver, G. Efstathiou, R. S. Ellis, C. S. Frenk, K. Glazebrook, C. Jackson,
B. Jones, I. Lewis, S. Lumsden, W. Percival, B. A. Peterson, W. Sutherland, K. Taylor, The 2dF Galaxy
Redshift Survey: correlation functions, peculiar velocities and the matter density of the Universe, Monthly
Notices of the Royal Astronomical Society 346, 78 (2003), astro-ph/0212375.
(Heath, 1977) D. J. Heath, The growth of density perturbations in zero pressure Friedmann-Lemaitre universes,
Monthly Notices of the Royal Astronomical Society 179, 351 (1977).
(Heavens, 2009) A. F. Heavens, Statistical techniques in cosmology, ArXiv e-prints
(2009), arXiv:0906.0664
[astro-ph.CO].
(Heavens & Taylor, 1995) A. F. Heavens, A. N. Taylor, A spherical harmonic analysis of redshift space, Monthly
Notices of the Royal Astronomical Society 275, 483 (1995), astro-ph/9409027.
(Heavens, Kitching & Verde, 2007) A. F. Heavens, T. D. Kitching, L. Verde, On model selection forecasting,
dark energy and modiﬁed gravity, Monthly Notices of the Royal Astronomical Society 380, 1029 (2007),
astro-ph/0703191.
(Heisenberg, Schäfer & Bartelmann, 2011) L. Heisenberg, B. M. Schäfer, M. Bartelmann, A study of rela-
tive velocity statistics in Lagrangian perturbation theory with PINOCCHIO, Monthly Notices of the Royal
Astronomical Society 416, 3057 (2011), arXiv:1011.1559 [astro-ph.CO].
(Heitmann et al., 2010) K. Heitmann, M. White, C. Wagner, S. Habib, D. Higdon, The Coyote Universe. I.
Precision Determination of the Nonlinear Matter Power Spectrum, Astrophysical Journal 715, 104 (2010),
arXiv:0812.1052.
(Heitmann et al., 2009) K. Heitmann, D. Higdon, M. White, S. Habib, B. J. Williams, E. Lawrence, C. Wagner,
The Coyote Universe. II. Cosmological Models and Precision Emulation of the Nonlinear Matter Power
Spectrum, Astrophysical Journal 705, 156 (2009), arXiv:0902.0429 [astro-ph.CO].
(Hemans, 1826) F. Hemans, Casabianca, in The New Monthly Magazine (1826).
(Heß, Kitaura & Gottlöber, 2013) S. Heß, F.-S. Kitaura, S. Gottlöber, Simulating structure formation of the
Local Universe, Monthly Notices of the Royal Astronomical Society 435, 2065 (2013), arXiv:1304.6565 [astro-
ph.CO].

Bibliography
197
(Hidding et al., 2012) J. Hidding, R. van de Weygaert, G. Vegter, B. J. T. Jones, Adhesion and the Geometry
of the Cosmic Web, ArXiv e-prints (2012), arXiv:1211.5385 [astro-ph.CO].
(Hill et al., 2008) G. J. Hill, K. Gebhardt, E. Komatsu, N. Drory, P. J. MacQueen, J. Adams, G. A. Blanc,
R. Koehler, M. Rafal, M. M. Roth, A. Kelz, C. Gronwall, R. Ciardullo, D. P. Schneider, The Hobby-Eberly
Telescope Dark Energy Experiment (HETDEX): Description and Early Pilot Survey Results, in Panoramic
Views of Galaxy Formation and Evolution, Astronomical Society of the Paciﬁc Conference Series, Vol. 399,
edited by T. Kodama, T. Yamada, K. Aoki (2008) p. 115, arXiv:0806.0183.
(Ho & Pepyne, 2002) Y. C. Ho, D. L. Pepyne, Simple Explanation of the No-Free-Lunch Theorem and Its
Implications, Journal of Optimization Theory and Applications 115, 549 (2002).
(Hobson, 2010) M. P. Hobson, Bayesian Methods in Cosmology, edited by M. P. Hobson, A. H. Jaﬀe, A. R.
Liddle, P. Mukherjee, D. Parkinson (Cambridge University Press, 2010).
(Hockney & Eastwood, 1981) R. W. Hockney, J. W. Eastwood, Computer Simulation Using Particles (McGraw-
Hill, 1981).
(Hoﬀman & Ribak, 1991) Y. Hoﬀman, E. Ribak, Constrained realizations of Gaussian ﬁelds - A simple algorithm,
Astrophysical Journal Letters 380, L5 (1991).
(Hoﬀman et al., 2012) Y. Hoﬀman, O. Metuki, G. Yepes, S. Gottlöber, J. E. Forero-Romero, N. I. Libeskind,
A. Knebe, A kinematic classiﬁcation of the cosmic web, Monthly Notices of the Royal Astronomical Society
425, 2049 (2012), arXiv:1201.3367 [astro-ph.CO].
(Hubble, 1934) E. Hubble, The Distribution of Extra-Galactic Nebulae, Astrophysical Journal 79, 8 (1934).
(Huchra et al., 2012) J. P. Huchra, L. M. Macri, K. L. Masters, T. H. Jarrett, P. Berlind, M. Calkins, A. C. Crook,
R. Cutri, P. Erdoˇgdu, E. Falco, T. George, C. M. Hutcheson, O. Lahav, J. Mader, J. D. Mink, N. Martimbeau,
S. Schneider, M. Skrutskie, S. Tokarz, M. Westover, The 2MASS Redshift Survey – Description and Data
Release, Astrophysical Journal Supplement 199, 26 (2012), arXiv:1108.0669 [astro-ph.CO].
(Hugo, 1856) V. Hugo, Les Contemplations (1856).
(Hui & Bertschinger, 1996) L. Hui, E. Bertschinger, Local Approximations to the Gravitational Collapse of Cold
Matter, Astrophysical Journal 471, 1 (1996), arXiv:astro-ph/9508114.
(Icke, 1984) V. Icke, Voids and ﬁlaments, Monthly Notices of the Royal Astronomical Society 206, 1P (1984).
(Ilić, Langer & Douspis, 2013) S. Ilić, M. Langer, M. Douspis, Detecting the integrated Sachs-Wolfe eﬀect with
stacked voids, Astronomy and Astrophysics 556, A51 (2013), arXiv:1301.5849 [astro-ph.CO].
(Jasche & Lavaux, 2015) J. Jasche, G. Lavaux, Matrix-free large-scale Bayesian inference in cosmology, Monthly
Notices of the Royal Astronomical Society 447, 1204 (2015), arXiv:1402.1763.
(Jasche & Wandelt, 2013a) J. Jasche, B. D. Wandelt, Bayesian physical reconstruction of initial conditions
from large-scale structure surveys, Monthly Notices of the Royal Astronomical Society 432, 894 (2013a),
arXiv:1203.3639 [astro-ph.CO].
(Jasche & Kitaura, 2010) J. Jasche, F. S. Kitaura, Fast Hamiltonian sampling for large-scale structure inference,
Monthly Notices of the Royal Astronomical Society 407, 29 (2010), arXiv:0911.2496 [astro-ph.CO].
(Jasche & Wandelt, 2012) J. Jasche, B. D. Wandelt, Bayesian inference from photometric redshift surveys,
Monthly Notices of the Royal Astronomical Society 425, 1042 (2012), arXiv:1106.2757 [astro-ph.CO].
(Jasche & Wandelt, 2013b) J. Jasche, B. D. Wandelt, Methods for Bayesian Power Spectrum Inference with
Galaxy Surveys, Astrophysical Journal 779, 15 (2013b), arXiv:1306.1821 [astro-ph.CO].
(Jasche, Leclercq & Wandelt, 2015) J. Jasche, F. Leclercq, B. D. Wandelt, Past and present cosmic structure in
the SDSS DR7 main sample, Journal of Cosmology and Astroparticle Physics 1, 036 (2015), arXiv:1409.6308.

198
Bibliography
(Jasche et al., 2010a) J. Jasche, F. S. Kitaura, B. D. Wandelt, T. A. Enßlin, Bayesian power-spectrum in-
ference for large-scale structure data, Monthly Notices of the Royal Astronomical Society 406, 60 (2010a),
arXiv:0911.2493 [astro-ph.CO].
(Jasche et al., 2010b) J. Jasche, F. S. Kitaura, C. Li, T. A. Enßlin, Bayesian non-linear large-scale structure
inference of the Sloan Digital Sky Survey Data Release 7, Monthly Notices of the Royal Astronomical Society
409, 355 (2010b), arXiv:0911.2498 [astro-ph.CO].
(Jaynes, 2003) E. T. Jaynes, Probability Theory: The Logic of Science, edited by G. L. Bretthorst (Cambridge
University Press, 2003).
(Jennings, Li & Hu, 2013) E. Jennings, Y. Li, W. Hu, The abundance of voids and the excursion set formalism,
Monthly Notices of the Royal Astronomical Society 434, 2167 (2013), arXiv:1304.6087.
(Jeong & Komatsu, 2009) D. Jeong, E. Komatsu, Primordial Non-Gaussianity, Scale-dependent Bias, and the
Bispectrum of Galaxies, Astrophysical Journal 703, 1230 (2009), arXiv:0904.0497 [astro-ph.CO].
(Jewell et al., 2009) J. B. Jewell, H. K. Eriksen, B. D. Wandelt, I. J. O’Dwyer, G. Huey, K. M. Górski, A
Markov Chain Monte Carlo Algorithm for Analysis of Low Signal-To-Noise Cosmic Microwave Background
Data, Astrophysical Journal 697, 258 (2009), arXiv:0807.0624.
(Jewell, Levin & Anderson, 2004) J. Jewell, S. Levin, C. H. Anderson, Application of Monte Carlo Algorithms
to the Bayesian Analysis of the Cosmic Microwave Background, Astrophysical Journal 609, 1 (2004), astro-
ph/0209560.
(Jing, 2005) Y. P. Jing, Correcting for the Alias Eﬀect When Measuring the Power Spectrum Using a Fast
Fourier Transform, Astrophysical Journal 620, 559 (2005), astro-ph/0409240.
(Jones, van de Weygaert & Aragón-Calvo, 2010) B. J. T. Jones, R. van de Weygaert, M. A. Aragón-Calvo,
Fossil evidence for spin alignment of Sloan Digital Sky Survey galaxies in ﬁlaments, Monthly Notices of the
Royal Astronomical Society 408, 897 (2010), arXiv:1001.4479 [astro-ph.CO].
(Kaiser, 1987) N. Kaiser, Clustering in real space and in redshift space, Monthly Notices of the Royal Astro-
nomical Society 227, 1 (1987).
(Kayo, Taruya & Suto, 2001) I. Kayo, A. Taruya, Y. Suto, Probability Distribution Function of Cosmological
Density Fluctuations from a Gaussian Initial Condition: Comparison of One-Point and Two-Point Lognormal
Model Predictions with N-Body Simulations, Astrophysical Journal 561, 22 (2001), arXiv:astro-ph/0105218.
(Kendall & Stuart, 1968) M. G. Kendall, A. Stuart, The advanced theory of statistics (Griﬃn, 1968).
(Kirshner et al., 1981) R. P. Kirshner, A. Oemler, Jr., P. L. Schechter, S. A. Shectman, A million cubic
megaparsec void in Bootes, Astrophysical Journal Letters 248, L57 (1981).
(Kitaura, 2012) F.-S. Kitaura, Bayesian Analysis of Cosmic Structures, in Astrostatistics and Data Mining,
edited by L. M. Sarro, L. Eyer, W. O’Mullane, J. De Ridder (2012) p. 143.
(Kitaura, 2013) F.-S. Kitaura, The initial conditions of the Universe from constrained simulations, Monthly
Notices of the Royal Astronomical Society 429, L84 (2013), arXiv:1203.4184 [astro-ph.CO].
(Kitaura & Heß, 2013) F.-S. Kitaura, S. Heß, Cosmological structure formation with augmented Lagrangian
perturbation theory, Monthly Notices of the Royal Astronomical Society 435, L78 (2013), arXiv:1212.3514
[astro-ph.CO].
(Kitaura & Enßlin, 2008) F. S. Kitaura, T. A. Enßlin, Bayesian reconstruction of the cosmological large-scale
structure: methodology, inverse algorithms and numerical optimization, Monthly Notices of the Royal Astro-
nomical Society 389, 497 (2008), arXiv:0705.0429.
(Kitaura, Gallerani & Ferrara, 2012) F.-S. Kitaura, S. Gallerani, A. Ferrara, Multiscale inference of matter ﬁelds
and baryon acoustic oscillations from the Lyα forest, Monthly Notices of the Royal Astronomical Society 420,
61 (2012), arXiv:1011.6233 [astro-ph.CO].

Bibliography
199
(Kitaura, Jasche & Metcalf, 2010) F.-S. Kitaura, J. Jasche, R. B. Metcalf, Recovering the non-linear density
ﬁeld from the galaxy distribution with a Poisson-lognormal ﬁlter, Monthly Notices of the Royal Astronomical
Society 403, 589 (2010), arXiv:0911.1407 [astro-ph.CO].
(Kitaura et al., 2009) F. S. Kitaura, J. Jasche, C. Li, T. A. Enßlin, R. B. Metcalf, B. D. Wandelt, G. Lemson,
S. D. M. White, Cosmic cartography of the large-scale structure with Sloan Digital Sky Survey data release 6,
Monthly Notices of the Royal Astronomical Society 400, 183 (2009), arXiv:0906.3978 [astro-ph.CO].
(Klypin & Shandarin, 1983) A. A. Klypin, S. F. Shandarin, Three-dimensional numerical model of the formation
of large-scale structure in the Universe, Monthly Notices of the Royal Astronomical Society 204, 891 (1983).
(Kofman & Shandarin, 1988) L. A. Kofman, S. F. Shandarin, Theory of adhesion for the large-scale structure
of the universe, Nature 334, 129 (1988).
(Kofman et al., 1992) L. Kofman, D. Pogosyan, S. F. Shandarin, A. L. Melott, Coherent structures in the
universe and the adhesion model, Astrophysical Journal 393, 437 (1992).
(Kolb & Turner, 1990) E. W. Kolb, M. S. Turner, Front. Phys., Vol. 69, (Westview Press, 1990).
(Komatsu et al., 2011) E. Komatsu, K. M. Smith, J. Dunkley, C. L. Bennett, B. Gold, G. Hinshaw, N. Jarosik,
D. Larson, M. R. Nolta, L. Page, D. N. Spergel, M. Halpern, R. S. Hill, A. Kogut, M. Limon, S. S. Meyer,
N. Odegard, G. S. Tucker, J. L. Weiland, E. Wollack, E. L. Wright, Seven-year Wilkinson Microwave
Anisotropy Probe (WMAP) Observations: Cosmological Interpretation, Astrophysical Journal Supplement
192, 18 (2011), arXiv:1001.4538 [astro-ph.CO].
(Kovač et al., 2014) K. Kovač, S. J. Lilly, C. Knobel, T. J. Bschorr, Y. Peng, C. M. Carollo, T. Contini,
J.-P. Kneib, O. Le Févre, V. Mainieri, A. Renzini, M. Scodeggio, G. Zamorani, S. Bardelli, M. Bolzonella,
A. Bongiorno, K. Caputi, O. Cucciati, S. de la Torre, L. de Ravel, P. Franzetti, B. Garilli, A. Iovino,
P. Kampczyk, F. Lamareille, J.-F. Le Borgne, V. Le Brun, C. Maier, M. Mignoli, P. Oesch, R. Pello, E. P.
Montero, V. Presotto, J. Silverman, M. Tanaka, L. Tasca, L. Tresse, D. Vergani, E. Zucca, H. Aussel, A. M.
Koekemoer, E. Le Floc’h, M. Moresco, L. Pozzetti, zCOSMOS 20k: satellite galaxies are the main drivers of
environmental eﬀects in the galaxy population at least to z ∼0.7, Monthly Notices of the Royal Astronomical
Society 438, 717 (2014), arXiv:1307.4402 [astro-ph.CO].
(Kravtsov, 2002) A. Kravtsov, Writing a PM code (2002).
(Kullback & Leibler, 1951) S. Kullback, R. A. Leibler, On Information and Suﬃciency, The Annals of Mathe-
matical Statistics 22, 79 (1951).
(Lahav & Suto, 2004) O. Lahav, Y. Suto, Measuring our Universe from Galaxy Redshift Surveys, Living Reviews
in Relativity 7, 8 (2004), arXiv:astro-ph/0310642.
(Lahav et al., 1991) O. Lahav, P. B. Lilje, J. R. Primack, M. J. Rees, Dynamical eﬀects of the cosmological
constant, Monthly Notices of the Royal Astronomical Society 251, 128 (1991).
(Lahav et al., 1994) O. Lahav, K. B. Fisher, Y. Hoﬀman, C. A. Scharf, S. Zaroubi, Wiener Reconstruction
of All-Sky Galaxy Surveys in Spherical Harmonics, Astrophysical Journal Letters 423, L93 (1994), astro-
ph/9311059.
(Laigle et al., 2015) C. Laigle, C. Pichon, S. Codis, Y. Dubois, D. Le Borgne, D. Pogosyan, J. Devriendt,
S. Peirani, S. Prunet, S. Rouberol, A. Slyz, T. Sousbie, Swirling around ﬁlaments: are large-scale structure
vortices spinning up dark haloes?, Monthly Notices of the Royal Astronomical Society 446, 2744 (2015),
arXiv:1310.3801.
(Langlois, 2005) D. Langlois, Inﬂation, Quantum Fluctuations and Cosmological Perturbations, in NATO ASIB
Proc. 188: Particle Physics and Cosmology: the Interface, edited by D. Kazakov, G. Smadja (2005) p. 235,
arXiv:hep-th/0405053.
(Langlois, 2010) D. Langlois, Inﬂation and Cosmological Perturbations, in Lectures on Cosmology Accelerated
Expansion of the Universe by Georg Wolschin, Lecture Notes in Physics vol. 800, Springer Berlin / Heidel-
berg, ISSN 1616-6361; ISBN 978-3-642-10597-5, pp.1-57, Vol. 800, edited by G. Wolschin (2010) pp. 1–57,
arXiv:1001.5259 [astro-ph.CO].

200
Bibliography
(Laureijs et al., 2011) R. Laureijs, J. Amiaux, S. Arduini, J. . Auguères, J. Brinchmann, R. Cole, M. Cropper,
C. Dabin, L. Duvet, A. Ealet, et al., Euclid Deﬁnition Study Report, ArXiv e-prints (2011), arXiv:1110.3193
[astro-ph.CO].
(Lavaux, 2008) G. Lavaux, Reconstruction of peculiar velocities of galaxies: methods and applications to obser-
vations, Ph.D. thesis, Institut d’Astrophysique de Paris, UMR 7095 CNRS – Université Pierre et Marie Curie
– Paris 6 (2008).
(Lavaux, 2010) G. Lavaux, Precision constrained simulation of the local Universe, Monthly Notices of the Royal
Astronomical Society 406, 1007 (2010), arXiv:0912.3525.
(Lavaux & Jasche, 2016) G. Lavaux, J. Jasche, Unmasking the masked Universe: the 2M++ catalogue through
Bayesian eyes, Monthly Notices of the Royal Astronomical Society 455, 3169 (2016), arXiv:1509.05040.
(Lavaux & Wandelt, 2010) G. Lavaux, B. D. Wandelt, Precision cosmology with voids: deﬁnition, methods,
dynamics, Monthly Notices of the Royal Astronomical Society 403, 1392 (2010), arXiv:0906.4101 [astro-
ph.CO].
(Lavaux & Wandelt, 2012) G. Lavaux, B. D. Wandelt, Precision Cosmography with Stacked Voids, Astrophysical
Journal 754, 109 (2012), arXiv:1110.0345 [astro-ph.CO].
(Lavaux & Hudson, 2011) G. Lavaux, M. J. Hudson, The 2M++ galaxy redshift catalogue, Monthly Notices of
the Royal Astronomical Society 416, 2840 (2011), arXiv:1105.6107.
(Lawrence et al., 2010) E. Lawrence, K. Heitmann, M. White, D. Higdon, C. Wagner, S. Habib, B. Williams, The
Coyote Universe. III. Simulation Suite and Precision Emulator for the Nonlinear Matter Power Spectrum,
Astrophysical Journal 713, 1322 (2010), arXiv:0912.4490 [astro-ph.CO].
(Layzer, 1956) D. Layzer, A new model for the distribution of galaxies in space, Astronomical Journal 61, 383
(1956).
(Le Fèvre et al., 2005) O. Le Fèvre, G. Vettolani, B. Garilli, L. Tresse, D. Bottini, V. Le Brun, D. Maccagni,
J. P. Picat, R. Scaramella, M. Scodeggio, A. Zanichelli, C. Adami, M. Arnaboldi, S. Arnouts, S. Bardelli,
M. Bolzonella, A. Cappi, S. Charlot, P. Ciliegi, T. Contini, S. Foucaud, P. Franzetti, I. Gavignaud, L. Guzzo,
O. Ilbert, A. Iovino, H. J. McCracken, B. Marano, C. Marinoni, G. Mathez, A. Mazure, B. Meneux, R. Merighi,
S. Paltani, R. Pellò, A. Pollo, L. Pozzetti, M. Radovich, G. Zamorani, E. Zucca, M. Bondi, A. Bongiorno,
G. Busarello, F. Lamareille, Y. Mellier, P. Merluzzi, V. Ripepi, D. Rizzo, The VIMOS VLT deep survey. First
epoch VVDS-deep survey: 11 564 spectra with 17.5 ≤iAB ≤24, and the redshift distribution over 0 ≤z ≤5,
Astronomy and Astrophysics 439, 845 (2005), astro-ph/0409133.
(Le Fèvre et al., 2013) O. Le Fèvre, P. Cassata, O. Cucciati, B. Garilli, O. Ilbert, V. Le Brun, D. Maccagni,
C. Moreau, M. Scodeggio, L. Tresse, G. Zamorani, C. Adami, S. Arnouts, S. Bardelli, M. Bolzonella, M. Bondi,
A. Bongiorno, D. Bottini, A. Cappi, S. Charlot, P. Ciliegi, T. Contini, S. de la Torre, S. Foucaud, P. Franzetti,
I. Gavignaud, L. Guzzo, A. Iovino, B. Lemaux, C. López-Sanjuan, H. J. McCracken, B. Marano, C. Marinoni,
A. Mazure, Y. Mellier, R. Merighi, P. Merluzzi, S. Paltani, R. Pellò, A. Pollo, L. Pozzetti, R. Scaramella,
L. Tasca, D. Vergani, G. Vettolani, A. Zanichelli, E. Zucca, The VIMOS VLT Deep Survey ﬁnal data release: a
spectroscopic sample of 35 016 galaxies and AGN out to z ∼6.7 selected with 17.5 ≤iAB ≤24.75, Astronomy
and Astrophysics 559, A14 (2013), arXiv:1307.0545.
(Leclercq, Pisani & Wandelt, 2014) F. Leclercq, A. Pisani, B. D. Wandelt, Cosmology: from theory to data,
from data to theory, in New horizons for observational cosmology, Proceedings of the International School of
Physics “Enrico Fermi”, Vol. 186, edited by A. Cooray, A. Melchiorri, E. Komatsu, L. Lamagna (2014) pp.
189–233, arXiv:1403.1260 [astro-ph.CO].
(Leclercq, Jasche & Wandelt, 2015a) F. Leclercq, J. Jasche, B. Wandelt, Cosmic web-type classiﬁcation using
decision theory, Astronomy and Astrophysics 576, L17 (2015a), arXiv:1503.00730.
(Leclercq, Jasche & Wandelt, 2015b) F. Leclercq, J. Jasche, B. Wandelt, One-point statistics of the Lagrangian
displacement ﬁeld, Journal of Cosmology and Astroparticle Physics 4, 026 (2015b), arXiv:1507.08664.

Bibliography
201
(Leclercq, Jasche & Wandelt, 2015c) F. Leclercq, J. Jasche, B. Wandelt, Bayesian analysis of the dynamic
cosmic web in the SDSS galaxy survey, Journal of Cosmology and Astroparticle Physics 6, 015 (2015c),
arXiv:1502.02690.
(Leclercq et al., 2013) F. Leclercq, J. Jasche, H. Gil-Marín, B. Wandelt, One-point remapping of Lagrangian
perturbation theory in the mildly non-linear regime of cosmic structure formation, Journal of Cosmology and
Astroparticle Physics 11, 048 (2013), arXiv:1305.4642 [astro-ph.CO].
(Leclercq et al., 2015) F. Leclercq, J. Jasche, P. M. Sutter, N. Hamaus, B. Wandelt, Dark matter voids in the
SDSS galaxy survey, Journal of Cosmology and Astroparticle Physics 3, 047 (2015), arXiv:1410.0355.
(Lee & Li, 2008) J. Lee, C. Li, Connecting the Physical Properties of Galaxies with the Overdensity and Tidal
Shear of the Large-Scale Environment, ArXiv e-prints (2008), arXiv:0803.1759.
(Lee & Park, 2006) J. Lee, D. Park, Rotation of Cosmic Voids and Void Spin Statistics, Astrophysical Journal
652, 1 (2006), astro-ph/0606477.
(Lee & Lee, 2008) J. Lee, B. Lee, The Variation of Galaxy Morphological Type with Environmental Shear,
Astrophysical Journal 688, 78 (2008), arXiv:0801.1558.
(Lee, Rey & Kim, 2014) J. Lee, S. C. Rey, S. Kim, Alignments of the Galaxies in and around the Virgo Cluster
with the Local Velocity Shear, Astrophysical Journal 791, 15 (2014), arXiv:1406.5250.
(Lesgourgues, 2011) J. Lesgourgues, The Cosmic Linear Anisotropy Solving System (CLASS) I: Overview, ArXiv
e-prints (2011), arXiv:1104.2932 [astro-ph.IM].
(Lesgourgues, 2004) J. Lesgourgues, An overview of Cosmology, ArXiv Astrophysics e-prints
(2004), astro-
ph/0409426.
(Levi et al., 2013) M. Levi, C. Bebek, T. Beers, R. Blum, R. Cahn, D. Eisenstein, B. Flaugher, K. Honscheid,
R. Kron, O. Lahav, P. McDonald, N. Roe, D. Schlegel, representing the DESI collaboration, The DESI
Experiment, a whitepaper for Snowmass 2013, ArXiv e-prints (2013), arXiv:1308.0847 [astro-ph.CO].
(Lewis & Challinor, 2002) A. Lewis, A. Challinor, Evolution of cosmological dark matter perturbations, Physical
Review D 66, 023531 (2002), astro-ph/0203507.
(Lewis & Bridle, 2002) A. Lewis, S. Bridle, Cosmological parameters from CMB and other data: A Monte Carlo
approach, Physical Review D 66, 103511 (2002), arXiv:astro-ph/0205436.
(Lewis, 1955) C. S. Lewis, The Chronicles of Narnia, The Magician’s Nephew (The Bodley Head, 1955).
(Li & Zhao, 2009) B. Li, H. Zhao, Structure formation by a ﬁfth force: N-body versus linear simulations, Physical
Review D 80, 044027 (2009), arXiv:0906.3880 [astro-ph.CO].
(Li, Zhao & Koyama, 2012) B. Li, G.-B. Zhao, K. Koyama, Haloes and voids in f(R) gravity, Monthly Notices
of the Royal Astronomical Society 421, 3481 (2012), arXiv:1111.2602 [astro-ph.CO].
(Li et al., 2014) M. Li, R. E. Angulo, S. D. M. White, J. Jasche, Matched ﬁlter optimization of kSZ measurements
with a reconstructed cosmological ﬂow ﬁeld, Monthly Notices of the Royal Astronomical Society 443, 2311
(2014), arXiv:1404.0007.
(Libeskind, Hoﬀman & Gottlöber, 2014) N. I. Libeskind, Y. Hoﬀman, S. Gottlöber, The velocity shear and
vorticity across redshifts and non-linear scales, Monthly Notices of the Royal Astronomical Society 441, 1974
(2014), arXiv:1310.5706.
(Libeskind et al., 2013) N. I. Libeskind, Y. Hoﬀman, J. Forero-Romero, S. Gottlöber, A. Knebe, M. Steinmetz,
A. Klypin, The velocity shear tensor: tracer of halo alignment, Monthly Notices of the Royal Astronomical
Society 428, 2489 (2013), arXiv:1210.4559 [astro-ph.CO].
(Liddle & Lyth, 2000) A. R. Liddle, D. H. Lyth, Cosmological Inﬂation and Large-Scale Structure, by Andrew
R. Liddle and David H. Lyth, pp. 414. ISBN 052166022X. Cambridge, UK: Cambridge University Press,
April 2000. (Cambridge University Press, 2000).

202
Bibliography
(Lidz et al., 2007) A. Lidz, O. Zahn, M. McQuinn, M. Zaldarriaga, S. Dutta, L. Hernquist, Higher Order
Contributions to the 21 cm Power Spectrum, Astrophysical Journal 659, 865 (2007), astro-ph/0610054.
(Lightman & Schechter, 1990) A. P. Lightman, P. L. Schechter, The Omega dependence of peculiar velocities
induced by spherical density perturbations, Astrophysical Journal Supplement 74, 831 (1990).
(Lilly et al., 2007) S. J. Lilly, O. Le Fèvre, A. Renzini, G. Zamorani, M. Scodeggio, T. Contini, C. M. Carollo,
G. Hasinger, J.-P. Kneib, A. Iovino, V. Le Brun, C. Maier, V. Mainieri, M. Mignoli, J. Silverman, L. A. M.
Tasca, M. Bolzonella, A. Bongiorno, D. Bottini, P. Capak, K. Caputi, A. Cimatti, O. Cucciati, E. Daddi,
R. Feldmann, P. Franzetti, B. Garilli, L. Guzzo, O. Ilbert, P. Kampczyk, K. Kovac, F. Lamareille, A. Leau-
thaud, J.-F. L. Borgne, H. J. McCracken, C. Marinoni, R. Pello, E. Ricciardelli, C. Scarlata, D. Vergani, D. B.
Sanders, E. Schinnerer, N. Scoville, Y. Taniguchi, S. Arnouts, H. Aussel, S. Bardelli, M. Brusa, A. Cappi,
P. Ciliegi, A. Finoguenov, S. Foucaud, A. Franceschini, C. Halliday, C. Impey, C. Knobel, A. Koekemoer,
J. Kurk, D. Maccagni, S. Maddox, B. Marano, G. Marconi, B. Meneux, B. Mobasher, C. Moreau, J. A. Pea-
cock, C. Porciani, L. Pozzetti, R. Scaramella, D. Schiminovich, P. Shopbell, I. Smail, D. Thompson, L. Tresse,
G. Vettolani, A. Zanichelli, E. Zucca, zCOSMOS: A Large VLT/VIMOS Redshift Survey Covering 0 < z < 3
in the COSMOS Field, Astrophysical Journal Supplement 172, 70 (2007), astro-ph/0612291.
(Lin & Kilbinger, 2015) C.-A. Lin, M. Kilbinger, A new model to predict weak-lensing peak counts II. Parameter
constraint strategies, ArXiv e-prints (2015), arXiv:1506.01076.
(Linde, 1995) A. Linde, Lectures on inﬂationary cosmology., in Particle Physics and Cosmology, edited by
A. Astbury, B. A. Campbell, W. Israel, F. C. Khanna, D. Page, J. L. Pinfold (1995) p. 72, arXiv:hep-
th/9410082.
(Linde, 1982) A. D. Linde, A new inﬂationary universe scenario: A possible solution of the horizon, ﬂatness,
homogeneity, isotropy and primordial monopole problems, Physics Letters B 108, 389 (1982).
(Little & Weinberg, 1994) B. Little, D. H. Weinberg, Cosmic Voids and Biased Galaxy Formation, Monthly
Notices of the Royal Astronomical Society 267, 605 (1994), astro-ph/9306006.
(London, 1903) J. London, The Call of the Wild (Macmillan, 1903).
(LSST Science Collaboration, 2012) LSST Science Collaboration, Large Synoptic Survey Telescope: Dark Energy
Science Collaboration, ArXiv e-prints (2012), arXiv:1211.0310 [astro-ph.CO].
(LSST Science Collaboration, 2009) LSST Science Collaboration, LSST Science Book, Version 2.0, ArXiv e-
prints (2009), arXiv:0912.0201 [astro-ph.IM].
(Lucretius, c. 55 BC) Lucretius, De Rerum Natura (On the Nature of Things) (c. 55 BC) Trad. R. E. Latham,
J. Godwin, 1951.
(Manera et al., 2013) M. Manera, R. Scoccimarro, W. J. Percival, L. Samushia, C. K. McBride, A. J. Ross, R. K.
Sheth, M. White, B. A. Reid, A. G. Sánchez, R. de Putter, X. Xu, A. A. Berlind, J. Brinkmann, C. Maraston,
B. Nichol, F. Montesano, N. Padmanabhan, R. A. Skibba, R. Tojeiro, B. A. Weaver, The clustering of galaxies
in the SDSS-III Baryon Oscillation Spectroscopic Survey: a large sample of mock galaxy catalogues, Monthly
Notices of the Royal Astronomical Society 428, 1036 (2013), arXiv:1203.6609 [astro-ph.CO].
(Manolakis, Ingle & Kogon, 2000) D. G. Manolakis, V. K. Ingle, S. M. Kogon, Statistical and Adaptive Signal
Processing: Spectral Estimation, Signal Modeling, Adaptive Filtering, and Array Processing (McGraw-Hill,
2000).
(March et al., 2011) M. C. March, G. D. Starkman, R. Trotta, P. M. Vaudrevange, Should we doubt the
cosmological constant?, Monthly Notices of the Royal Astronomical Society 410, 2488 (2011), arXiv:1005.3655
[astro-ph.CO].
(Marin et al., 2011) J.-M. Marin, P. Pudlo, C. P. Robert, R. Ryder, Approximate Bayesian Computational
methods, ArXiv e-prints (2011), arXiv:1101.0955 [stat.CO].
(Martel & Wasserman, 1990) H. Martel, I. Wasserman, Simulation of cosmological voids in Lambda greater than
0 Friedmann models, Astrophysical Journal 348, 1 (1990).

Bibliography
203
(Martínez & Saar, 2002) V. J. Martínez, E. Saar, Statistics of the Galaxy Distribution (Chapman & Hall, 2002).
(Matarrese, Verde & Heavens, 1997) S. Matarrese, L. Verde, A. F. Heavens, Large-scale bias in the Universe:
bispectrum method, Monthly Notices of the Royal Astronomical Society 290, 651 (1997), astro-ph/9706059.
(Mecke, Buchert & Wagner, 1994) K. R. Mecke, T. Buchert, H. Wagner, Robust Morphological Measures for
Large-Scale Structure in the Universe, Astronomy and Astrophysics 288, 697 (1994), astro-ph/9312028.
(Melchior et al., 2014) P. Melchior, P. M. Sutter, E. S. Sheldon, E. Krause, B. D. Wandelt, First measurement
of gravitational lensing by cosmic voids in SDSS, Monthly Notices of the Royal Astronomical Society 440,
2922 (2014), arXiv:1309.2045.
(Melott, 1993) A. L. Melott, Improving the reconstruction of the velocity potential and primordial density ﬂuc-
tuations by choice of smoothing windows, Astrophysical Journal 414, L73 (1993).
(Melott, Buchert & Weiß, 1995) A. L. Melott, T. Buchert, A. G. Weiß, Testing higher-order Lagrangian pertur-
bation theory against numerical simulations. 2: Hierarchical models, Astronomy and Astrophysics 294, 345
(1995), astro-ph/9404018.
(Melott, Pellman & Shandarin, 1994) A. L. Melott, T. F. Pellman, S. F. Shandarin, Optimizing the Zeldovich
Approximation, Monthly Notices of the Royal Astronomical Society 269, 626 (1994), astro-ph/9312044.
(Melott et al., 1983) A. L. Melott, J. Einasto, E. Saar, I. Suisalu, A. A. Klypin, S. F. Shandarin, Cluster analysis
of the nonlinear evolution of large-scale structure in an axion/gravitino/photino-dominated universe, Physical
Review Letters 51, 935 (1983).
(Mesinger & Furlanetto, 2007) A. Mesinger, S. Furlanetto, Eﬃcient Simulations of Early Structure Formation
and Reionization, Astrophysical Journal 669, 663 (2007), arXiv:0704.0946.
(Microsoft Research, 2009) Microsoft Research, The Fourth Paradigm: Data-intensive Scientiﬁc Discovery,
edited by T. Hey, S. Tansley, K. Tolle (Microsoft Research, 2009).
(Miyazaki et al., 2012) S. Miyazaki, Y. Komiyama, H. Nakaya, Y. Kamata, Y. Doi, T. Hamana, H. Karoji,
H. Furusawa, S. Kawanomoto, T. Morokuma, Y. Ishizuka, K. Nariai, Y. Tanaka, F. Uraguchi, Y. Utsumi,
Y. Obuchi, Y. Okura, M. Oguri, T. Takata, D. Tomono, T. Kurakami, K. Namikawa, T. Usuda, H. Yamanoi,
T. Terai, H. Uekiyo, Y. Yamada, M. Koike, H. Aihara, Y. Fujimori, S. Mineo, H. Miyatake, N. Yasuda,
J. Nishizawa, T. Saito, M. Tanaka, T. Uchida, N. Katayama, S.-Y. Wang, H.-Y. Chen, R. Lupton, C. Loomis,
S. Bickerton, P. Price, J. Gunn, H. Suzuki, Y. Miyazaki, M. Muramatsu, K. Yamamoto, M. Endo, Y. Ezaki,
N. Itoh, Y. Miwa, H. Yokota, T. Matsuda, R. Ebinuma, K. Takeshi, Hyper Suprime-Cam, in Society of
Photo-Optical Instrumentation Engineers (SPIE) Conference Series, Society of Photo-Optical Instrumenta-
tion Engineers (SPIE) Conference Series, Vol. 8446 (2012) p. 0.
(Mo & White, 1996) H. J. Mo, S. D. M. White, An analytic model for the spatial clustering of dark matter
haloes, Monthly Notices of the Royal Astronomical Society 282, 347 (1996), astro-ph/9512127.
(Mohayaee et al., 2006) R. Mohayaee, H. Mathis, S. Colombi, J. Silk, Reconstruction of primordial density
ﬁelds, Monthly Notices of the Royal Astronomical Society 365, 939 (2006), astro-ph/0501217.
(Monaco, Theuns & Taﬀoni, 2002) P. Monaco, T. Theuns, G. Taﬀoni, The pinocchio algorithm: pinpointing
orbit-crossing collapsed hierarchical objects in a linear density ﬁeld, Monthly Notices of the Royal Astronomical
Society 331, 587 (2002), astro-ph/0109323.
(Monaco et al., 2002) P. Monaco, T. Theuns, G. Taﬀoni, F. Governato, T. Quinn, J. Stadel, Predicting the
Number, Spatial Distribution, and Merging History of Dark Matter Halos, Astrophysical Journal 564, 8
(2002), astro-ph/0109322.
(Monaco et al., 2013) P. Monaco, E. Sefusatti, S. Borgani, M. Crocce, P. Fosalba, R. K. Sheth, T. Theuns, An
accurate tool for the fast generation of dark matter halo catalogues, Monthly Notices of the Royal Astronomical
Society 433, 2389 (2013), arXiv:1305.1505 [astro-ph.CO].

204
Bibliography
(Moutarde et al., 1991) F. Moutarde, J.-M. Alimi, F. R. Bouchet, R. Pellat, A. Ramani, Precollapse scale
invariance in gravitational instability, Astrophysical Journal 382, 377 (1991).
(Mukhanov, Feldman & Brandenberger, 1992) V. F. Mukhanov, H. A. Feldman, R. H. Brandenberger, Theory
of cosmological perturbations, Physics Reports 215, 203 (1992).
(Müller et al., 2000) V. Müller, S. Arbabi-Bidgoli, J. Einasto, D. Tucker, Voids in the Las Campanas Redshift
Survey versus cold dark matter models, Monthly Notices of the Royal Astronomical Society 318, 280 (2000),
astro-ph/0005063.
(Munshi & Starobinsky, 1994) D. Munshi, A. A. Starobinsky, Nonlinear approximations to gravitational in-
stability: A comparison in second-order perturbation theory, Astrophysical Journal 428, 433 (1994), astro-
ph/9311056.
(Nadathur & Hotchkiss, 2014) S. Nadathur, S. Hotchkiss, A robust public catalogue of voids and superclusters
in the SDSS Data Release 7 galaxy surveys, Monthly Notices of the Royal Astronomical Society 440, 1248
(2014), arXiv:1310.2791.
(Nadathur et al., 2014) S. Nadathur, S. Hotchkiss, J. M. Diego, I. T. Iliev, S. Gottlöber, W. A. Watson, G. Yepes,
Self-similarity and universality of void density proﬁles in simulation and SDSS data, ArXiv e-prints (2014),
arXiv:1407.1295.
(Narayanan & Weinberg, 1998) V. K. Narayanan, D. H. Weinberg, Reconstruction Analysis of Galaxy Redshift
Surveys: A Hybrid Reconstruction Method, Astrophysical Journal 508, 440 (1998), arXiv:astro-ph/9806238.
(Neal, 2011) R. Neal, Handbook of Markov Chain Monte Carlo (Chapman & Hall/CRC, 2011) Chap. MCMC
Using Hamiltonian Dynamics, pp. 113–162.
(Neyrinck, 2013) M. C. Neyrinck, Quantifying distortions of the Lagrangian dark-matter mesh in cosmology,
Monthly Notices of the Royal Astronomical Society 428, 141 (2013), arXiv:1204.1326 [astro-ph.CO].
(Neyrinck, 2015a) M. C. Neyrinck, Truthing the stretch: Non-perturbative cosmological realizations with multi-
scale spherical collapse, ArXiv e-prints (2015a), arXiv:1503.07534.
(Neyrinck, 2008) M. C. Neyrinck, ZOBOV: a parameter-free void-ﬁnding algorithm, Monthly Notices of the
Royal Astronomical Society 386, 2101 (2008), arXiv:0712.3049.
(Neyrinck, 2015b) M. C. Neyrinck, Kolmogorov complexity in the Milky Way and its reduction with warm dark
matter, Monthly Notices of the Royal Astronomical Society 452, L26 (2015b), arXiv:1409.0057.
(Neyrinck, 2012) M. C. Neyrinck, Origami constraints on the initial-conditions arrangement of dark-matter
caustics and streams, Monthly Notices of the Royal Astronomical Society 427, 494 (2012), arXiv:1202.3364
[astro-ph.CO].
(Neyrinck & Yang, 2013) M. C. Neyrinck, L. F. Yang, Ringing the initial Universe: the response of overdensity
and transformed-density power spectra to initial spikes, Monthly Notices of the Royal Astronomical Society
433, 1628 (2013), arXiv:1305.1629 [astro-ph.CO].
(Neyrinck, Szapudi & Szalay, 2011) M. C. Neyrinck, I. Szapudi, A. S. Szalay, Rejuvenating Power Spectra.
II. The Gaussianized Galaxy Density Field, Astrophysical Journal 731, 116 (2011), arXiv:1009.5680 [astro-
ph.CO].
(Neyrinck, Szapudi & Szalay, 2009) M. C. Neyrinck, I. Szapudi, A. S. Szalay, Rejuvenating the Matter Power
Spectrum: Restoring Information with a Logarithmic Density Mapping, Astrophysical Journal Letters 698,
L90 (2009), arXiv:0903.4693 [astro-ph.CO].
(Norberg et al., 2001) P. Norberg, C. M. Baugh, E. Hawkins, S. Maddox, J. A. Peacock, S. Cole, C. S. Frenk,
J. Bland-Hawthorn, T. Bridges, R. Cannon, M. Colless, C. Collins, W. Couch, G. Dalton, R. De Propris, S. P.
Driver, G. Efstathiou, R. S. Ellis, K. Glazebrook, C. Jackson, O. Lahav, I. Lewis, S. Lumsden, D. Madgwick,
B. A. Peterson, W. Sutherland, K. Taylor, The 2dF Galaxy Redshift Survey: luminosity dependence of galaxy
clustering, Monthly Notices of the Royal Astronomical Society 328, 64 (2001), astro-ph/0105500.

Bibliography
205
(Novikov, Colombi & Doré, 2006) D. Novikov, S. Colombi, O. Doré, Skeleton as a probe of the cosmic web: the
two-dimensional case, Monthly Notices of the Royal Astronomical Society 366, 1201 (2006), astro-ph/0307003.
(Nuza et al., 2014) S. E. Nuza, F.-S. Kitaura, S. Heß, N. I. Libeskind, V. Müller, The cosmic web of the Local
Universe: cosmic variance, matter content and its relation to galaxy morphology, Monthly Notices of the
Royal Astronomical Society 445, 988 (2014), arXiv:1406.1004.
(Nyquist, 1928) H. Nyquist, Certain Topics in Telegraph Transmission Theory, Transactions of the American
Institute of Electrical Engineers 47, 617 (1928).
(Obreschkow et al., 2013) D. Obreschkow, C. Power, M. Bruderer, C. Bonvin, A Robust Measure of Cosmic
Structure beyond the Power Spectrum: Cosmic Filaments and the Temperature of Dark Matter, Astrophysical
Journal 762, 115 (2013), arXiv:1211.5213 [astro-ph.CO].
(Padilla, Ceccarelli & Lambas, 2005) N. D. Padilla, L. Ceccarelli, D. G. Lambas, Spatial and dynamical properties
of voids in a Λ cold dark matter universe, Monthly Notices of the Royal Astronomical Society 363, 977 (2005),
astro-ph/0508297.
(Padmanabhan et al., 2012) N. Padmanabhan, X. Xu, D. J. Eisenstein, R. Scalzo, A. J. Cuesta, K. T. Mehta,
E. Kazin, A 2 per cent distance to z = 0.35 by reconstructing baryon acoustic oscillations - I. Methods and
application to the Sloan Digital Sky Survey, Monthly Notices of the Royal Astronomical Society 427, 2132
(2012), arXiv:1202.0090.
(Pan et al., 2012) D. C. Pan, M. S. Vogeley, F. Hoyle, Y.-Y. Choi, C. Park, Cosmic voids in Sloan Digital Sky
Survey Data Release 7, Monthly Notices of the Royal Astronomical Society 421, 926 (2012), arXiv:1103.4156
[astro-ph.CO].
(Park & Lee, 2007) D. Park, J. Lee, Void Ellipticity Distribution as a Probe of Cosmology, Physical Review
Letters 98, 081301 (2007), astro-ph/0610520.
(Park, Kim & Park, 2010) H. Park, J. Kim, C. Park, Gravitational Potential Environment of Galaxies. I.
Simulation, Astrophysical Journal 714, 207 (2010), arXiv:1004.0280 [astro-ph.CO].
(Paz, Stasyszyn & Padilla, 2008) D. J. Paz, F. Stasyszyn, N. D. Padilla, Angular momentum-large-scale structure
alignments in ΛCDM models and the SDSS, Monthly Notices of the Royal Astronomical Society 389, 1127
(2008), arXiv:0804.4477.
(Paz et al., 2013) D. Paz, M. Lares, L. Ceccarelli, N. Padilla, D. G. Lambas, Clues on void evolution-II.
Measuring density and velocity proﬁles on SDSS galaxy redshift space distortions, Monthly Notices of the
Royal Astronomical Society 436, 3480 (2013), arXiv:1306.5799 [astro-ph.CO].
(Peacock, 1999) J. A. Peacock, Cosmological Physics (Cambridge University Press, 1999).
(Peacock & Smith, 2000) J. A. Peacock, R. E. Smith, Halo occupation numbers and galaxy bias, Monthly Notices
of the Royal Astronomical Society 318, 1144 (2000), astro-ph/0005010.
(Peacock & Heavens, 1985) J. A. Peacock, A. F. Heavens, The statistics of maxima in primordial density
perturbations, Monthly Notices of the Royal Astronomical Society 217, 805 (1985).
(Peacock et al., 2001) J. A. Peacock, S. Cole, P. Norberg, C. M. Baugh, J. Bland-Hawthorn, T. Bridges, R. D.
Cannon, M. Colless, C. Collins, W. Couch, G. Dalton, K. Deeley, R. De Propris, S. P. Driver, G. Efstathiou,
R. S. Ellis, C. S. Frenk, K. Glazebrook, C. Jackson, O. Lahav, I. Lewis, S. Lumsden, S. Maddox, W. J.
Percival, B. A. Peterson, I. Price, W. Sutherland, K. Taylor, A measurement of the cosmological mass density
from clustering in the 2dF Galaxy Redshift Survey, Nature 410, 169 (2001), astro-ph/0103143.
(Peebles, 1980) P. J. E. Peebles, The large-scale structure of the universe (Princeton University Press, 1980).
(Peebles, 1984) P. J. E. Peebles, Dark matter and the origin of galaxies and globular star clusters, Astrophysical
Journal 277, 470 (1984).
(Peebles, 1976) P. J. E. Peebles, The Peculiar Velocity Field in the Local Supercluster, Astrophysical Journal
205, 318 (1976).

206
Bibliography
(Peebles, 1982a) P. J. E. Peebles, Primeval adiabatic perturbations - Eﬀect of massive neutrinos, Astrophysical
Journal 258, 415 (1982a).
(Peebles, 1982b) P. J. E. Peebles, Large-scale background temperature and mass ﬂuctuations due to scale-
invariant primeval perturbations, Astrophysical Journal Letters 263, L1 (1982b).
(Percival, 2005a) W. J. Percival, Markov chain reconstruction of the 2dF Galaxy Redshift Survey real-space
power spectrum, Monthly Notices of the Royal Astronomical Society 356, 1168 (2005a), astro-ph/0410631.
(Percival, 2005b) W. J. Percival, Cosmological structure formation in a homogeneous dark energy background,
Astronomy and Astrophysics 443, 819 (2005b), astro-ph/0508156.
(Percival, 2014) W. J. Percival, Large Scale Structure Observations, in Lecture Notes of the Les Houches Summer
School “Post-Planck Cosmology”: Volume 100, July 2013, edited by C. Deﬀayet, P. Peter, B. Wandelt,
M. Zaldarriaga, L. F. Cugliandolo (2014) arXiv:1312.5490 [astro-ph.CO].
(Percival & White, 2009) W. J. Percival, M. White, Testing cosmological structure formation using redshift-space
distortions, Monthly Notices of the Royal Astronomical Society 393, 297 (2009), arXiv:0808.0003.
(Percival, Verde & Peacock, 2004) W. J. Percival, L. Verde, J. A. Peacock, Fourier analysis of luminosity-
dependent galaxy clustering, Monthly Notices of the Royal Astronomical Society 347, 645 (2004), astro-
ph/0306511.
(Percival et al., 2001) W. J. Percival, C. M. Baugh, J. Bland-Hawthorn, T. Bridges, R. Cannon, S. Cole,
M. Colless, C. Collins, W. Couch, G. Dalton, R. De Propris, S. P. Driver, G. Efstathiou, R. S. Ellis, C. S.
Frenk, K. Glazebrook, C. Jackson, O. Lahav, I. Lewis, S. Lumsden, S. Maddox, S. Moody, P. Norberg, J. A.
Peacock, B. A. Peterson, W. Sutherland, K. Taylor, The 2dF Galaxy Redshift Survey: the power spectrum
and the matter content of the Universe, Monthly Notices of the Royal Astronomical Society 327, 1297 (2001),
astro-ph/0105252.
(Percival et al., 2010) W. J. Percival, B. A. Reid, D. J. Eisenstein, N. A. Bahcall, T. Budavari, J. A. Frieman,
M. Fukugita, J. E. Gunn, Ž. Ivezić, G. R. Knapp, R. G. Kron, J. Loveday, R. H. Lupton, T. A. McKay,
A. Meiksin, R. C. Nichol, A. C. Pope, D. J. Schlegel, D. P. Schneider, D. N. Spergel, C. Stoughton, M. A.
Strauss, A. S. Szalay, M. Tegmark, M. S. Vogeley, D. H. Weinberg, D. G. York, I. Zehavi, Baryon acoustic
oscillations in the Sloan Digital Sky Survey Data Release 7 galaxy sample, Monthly Notices of the Royal
Astronomical Society 401, 2148 (2010), arXiv:0907.1660 [astro-ph.CO].
(Pichon & Bernardeau, 1999) C. Pichon, F. Bernardeau, Vorticity generation in large-scale structure caustics,
Astronomy and Astrophysics 343, 663 (1999), astro-ph/9902142.
(Pirates of the Caribbean: At World’s End, 2007) Pirates of the Caribbean: At World’s End, (2007).
(Pisani et al., 2014) A. Pisani, G. Lavaux, P. M. Sutter, B. D. Wandelt, Real-space density proﬁle reconstruction
of stacked voids, Monthly Notices of the Royal Astronomical Society 443, 3238 (2014), arXiv:1306.3052 [astro-
ph.CO].
(Pisani et al., 2015) A. Pisani, P. M. Sutter, N. Hamaus, E. Alizadeh, R. Biswas, B. D. Wandelt, C. M. Hirata,
Counting voids to probe dark energy, ArXiv e-prints (2015), arXiv:1503.07690.
(Planck Collaboration, 2015) Planck Collaboration, Planck 2015 results. XVII. Constraints on primordial non-
Gaussianity, ArXiv e-prints (2015), arXiv:1502.01592.
(Planck Collaboration, 2014a) Planck Collaboration, Planck 2013 results. XIX. The integrated Sachs-Wolfe
eﬀect, Astronomy and Astrophysics 571, A19 (2014a), arXiv:1303.5079 [astro-ph.CO].
(Planck Collaboration, 2014b) Planck Collaboration, Planck 2013 results. XXIV. Constraints on primordial
non-Gaussianity, Astronomy and Astrophysics 571, A24 (2014b), arXiv:1303.5084.
(Platen, van de Weygaert & Jones, 2008) E. Platen, R. van de Weygaert, B. J. T. Jones, Alignment of voids in
the cosmic web, Monthly Notices of the Royal Astronomical Society 387, 128 (2008), arXiv:0711.2480.

Bibliography
207
(Platen, van de Weygaert & Jones, 2007) E. Platen, R. van de Weygaert, B. J. T. Jones, A cosmic watershed:
the WVF void detection technique, Monthly Notices of the Royal Astronomical Society 380, 551 (2007),
arXiv:0706.2788.
(Plionis & Basilakos, 2002) M. Plionis, S. Basilakos, The size and shape of local voids, Monthly Notices of the
Royal Astronomical Society 330, 399 (2002), astro-ph/0106491.
(Poincaré, 1900) H. Poincaré, Letter in Le Temps (1900).
(Pólya, 1954a) G. Pólya, Mathematics and Plausible Reasoning, Volume 1: Induction and Analogy in Mathe-
matics (Princeton University Press, 1954).
(Pólya, 1954b) G. Pólya, Mathematics and Plausible Reasoning, Volume 2: Patterns of Plausible Inference
(Princeton University Press, 1954).
(Popper, 1972) K. R. Popper, Objective Knowledge: An Evolutionary Approach (Oxford University Press, 1972).
(Pratchett, 1990) T. Pratchett, Moving Pictures (Victor Gollancz, 1990).
(Protogeros & Scherrer, 1997) Z. A. M. Protogeros, R. J. Scherrer, Local Lagrangian approximations for the evo-
lution of the density distribution function in large-scale structure, Monthly Notices of the Royal Astronomical
Society 284, 425 (1997), astro-ph/9603155.
(Prunet et al., 2008) S. Prunet, C. Pichon, D. Aubert, D. Pogosyan, R. Teyssier, S. Gottloeber, Initial Conditions
For Large Cosmological Simulations, Astrophysical Journal Supplement 178, 179 (2008), arXiv:0804.3536.
(Pueblas & Scoccimarro, 2009) S. Pueblas, R. Scoccimarro, Generation of vorticity and velocity dispersion by
orbit crossing, Physical Review D 80, 043504 (2009), arXiv:0809.4606.
(Rees & Ostriker, 1977) M. J. Rees, J. P. Ostriker, Cooling, dynamics and fragmentation of massive gas clouds
- Clues to the masses and radii of galaxies and clusters, Monthly Notices of the Royal Astronomical Society
179, 541 (1977).
(Reeve, 1995) F. D. Reeve, Coasting, in The American Poetry Review, Vol. 24 (1995) p. 38.
(Ricciardelli, Quilis & Varela, 2014) E. Ricciardelli, V. Quilis, J. Varela, On the universality of void density
proﬁles, Monthly Notices of the Royal Astronomical Society 440, 601 (2014), arXiv:1402.2976 [astro-ph.CO].
(Ryden, 1995) B. S. Ryden, Measuring Q 0 from the Distortion of Voids in Redshift Space, Astrophysical Journal
452, 25 (1995), astro-ph/9506028.
(Sahni & Shandarin, 1996) V. Sahni, S. Shandarin, Accuracy of Lagrangian approximations in voids, Monthly
Notices of the Royal Astronomical Society 282, 641 (1996), astro-ph/9510142.
(Sahni, Sathyaprakash & Shandarin, 1998) V. Sahni, B. S. Sathyaprakash, S. F. Shandarin, Shapeﬁnders: A New
Shape Diagnostic for Large-Scale Structure, Astrophysical Journal Letters 495, L5 (1998), astro-ph/9801053.
(Sahni, Sathyaprakah & Shandarin, 1994) V. Sahni, B. S. Sathyaprakah, S. F. Shandarin, The evolution of
voids in the adhesion approximation, Astrophysical Journal 431, 20 (1994), astro-ph/9403044.
(Schaap, 2007) W. E. Schaap, DTFE: the Delaunay Tessellation Field Estimator, Ph.D. thesis, University of
Groningen (2007).
(Schaap & van de Weygaert, 2000) W. E. Schaap, R. van de Weygaert, Continuous ﬁelds and discrete sam-
ples: reconstruction through Delaunay tessellations, Astronomy and Astrophysics 363, L29 (2000), astro-
ph/0011007.
(Schechter, 1976) P. Schechter, An analytic expression for the luminosity function for galaxies., Astrophysical
Journal 203, 297 (1976).

208
Bibliography
(Schlegel et al., 2011) D. Schlegel, F. Abdalla, T. Abraham, C. Ahn, C. Allende Prieto, J. Annis, E. Aubourg,
M. Azzaro, S. B. C. Baltay, C. Baugh, C. Bebek, S. Becerril, M. Blanton, A. Bolton, B. Bromley, R. Cahn,
P. . Carton, J. L. Cervantes-Cota, Y. Chu, M. Cortes, K. Dawson, A. Dey, M. Dickinson, H. T. Diehl,
P. Doel, A. Ealet, J. Edelstein, D. Eppelle, S. Escoﬃer, A. Evrard, L. Faccioli, C. Frenk, M. Geha, D. Gerdes,
P. Gondolo, A. Gonzalez-Arroyo, B. Grossan, T. Heckman, H. Heetderks, S. Ho, K. Honscheid, D. Huterer,
O. Ilbert, I. Ivans, P. Jelinsky, Y. Jing, D. Joyce, R. Kennedy, S. Kent, D. Kieda, A. Kim, C. Kim, J. .
Kneib, X. Kong, A. Kosowsky, K. Krishnan, O. Lahav, M. Lampton, S. LeBohec, V. Le Brun, M. Levi, C. Li,
M. Liang, H. Lim, W. Lin, E. Linder, W. Lorenzon, A. de la Macorra, C. Magneville, R. Malina, C. Marinoni,
V. Martinez, S. Majewski, T. Matheson, R. McCloskey, P. McDonald, T. McKay, J. McMahon, B. Menard,
J. Miralda-Escude, M. Modjaz, A. Montero-Dorta, I. Morales, N. Mostek, J. Newman, R. Nichol, P. Nugent,
K. Olsen, N. Padmanabhan, N. Palanque-Delabrouille, I. Park, J. Peacock, W. Percival, S. Perlmutter, C. Per-
oux, P. Petitjean, F. Prada, E. Prieto, J. Prochaska, K. Reil, C. Rockosi, N. Roe, E. Rollinde, A. Roodman,
N. Ross, G. Rudnick, V. Ruhlmann-Kleider, J. Sanchez, D. Sawyer, C. Schimd, M. Schubnell, R. Scoccimaro,
U. Seljak, H. Seo, E. Sheldon, M. Sholl, R. Shulte-Ladbeck, A. Slosar, D. S. Smith, G. Smoot, W. Springer,
A. Stril, A. S. Szalay, C. Tao, G. Tarle, E. Taylor, A. Tilquin, J. Tinker, F. Valdes, J. Wang, T. Wang,
B. A. Weaver, D. Weinberg, M. White, M. Wood-Vasey, J. Yang, X. Y. C. Yeche, N. Zakamska, A. Zentner,
C. Zhai, P. Zhang, The BigBOSS Experiment, ArXiv e-prints (2011), arXiv:1106.1706 [astro-ph.IM].
(Schmittfull, Baldauf & Seljak, 2015) M. Schmittfull, T. Baldauf, U. Seljak, Near optimal bispectrum estimators
for large-scale structure, Physical Review D 91, 043530 (2015), arXiv:1411.6595.
(Schuecker & Ott, 1991) P. Schuecker, H.-A. Ott, Scales of structures and homogeneity in the universe, Astro-
physical Journal Letters 378, L1 (1991).
(Scoccimarro, 1997) R. Scoccimarro, Cosmological Perturbations: Entering the Nonlinear Regime, Astrophysical
Journal 487, 1 (1997), astro-ph/9612207.
(Scoccimarro, 1998) R. Scoccimarro, Transients from initial conditions: a perturbative analysis, Monthly Notices
of the Royal Astronomical Society 299, 1097 (1998), astro-ph/9711187.
(Scoccimarro, 2000) R. Scoccimarro, The Bispectrum: From Theory to Observations, Astrophysical Journal
544, 597 (2000), astro-ph/0004086.
(Scoccimarro & Sheth, 2002) R. Scoccimarro, R. K. Sheth, PTHALOS: a fast method for generating mock galaxy
distributions, Monthly Notices of the Royal Astronomical Society 329, 629 (2002), astro-ph/0106120.
(Scoccimarro et al., 2001) R. Scoccimarro, H. A. Feldman, J. N. Fry, J. A. Frieman, The Bispectrum of IRAS
Redshift Catalogs, Astrophysical Journal 546, 652 (2001), astro-ph/0004087.
(Sefusatti & Komatsu, 2007) E. Sefusatti, E. Komatsu, Bispectrum of galaxies from high-redshift galaxy surveys:
Primordial non-Gaussianity and nonlinear galaxy bias, Physical Review D 76, 083004 (2007), arXiv:0705.0343.
(Seljak, 2000) U. Seljak, Analytic model for galaxy and dark matter clustering, Monthly Notices of the Royal
Astronomical Society 318, 203 (2000), astro-ph/0001493.
(Seljak & Zaldarriaga, 1996) U. Seljak, M. Zaldarriaga, A Line-of-Sight Integration Approach to Cosmic Mi-
crowave Background Anisotropies, Astrophysical Journal 469, 437 (1996), astro-ph/9603033.
(Senatore & Zaldarriaga, 2014) L. Senatore, M. Zaldarriaga, The IR-resummed Eﬀective Field Theory of Large
Scale Structures, ArXiv e-prints (2014), arXiv:1404.5954.
(Service, 1907) R. W. Service, The Spell of the Yukon, in Songs of a Sourdough (1907).
(Shandarin & Zel’dovich, 1989) S. F. Shandarin, Y. B. Zel’dovich, The large-scale structure of the universe:
Turbulence, intermittency, structures in a self-gravitating medium, Reviews of Modern Physics 61, 185 (1989).
(Shandarin, Habib & Heitmann, 2012) S. Shandarin, S. Habib, K. Heitmann, Cosmic web, multistream ﬂows,
and tessellations, Physical Review D 85, 083005 (2012), arXiv:1111.2366 [astro-ph.CO].

Bibliography
209
(Shandarin et al., 2006) S. Shandarin, H. A. Feldman, K. Heitmann, S. Habib, Shapes and sizes of voids in
the Lambda cold dark matter universe: excursion set approach, Monthly Notices of the Royal Astronomical
Society 367, 1629 (2006), astro-ph/0509858.
(Shannon, 1948) C. E. Shannon, A Mathematical Theory of Communication, Bell System Technical Journal 27,
379 (1948).
(Shannon, 1949) C. E. Shannon, Communication in the Presence of Noise, Proc. Institute of Radio Engineers
37, 10 (1949).
(Shectman et al., 1996) S. A. Shectman, S. D. Landy, A. Oemler, D. L. Tucker, H. Lin, R. P. Kirshner, P. L.
Schechter, The Las Campanas Redshift Survey, Astrophysical Journal 470, 172 (1996), astro-ph/9604167.
(Shen et al., 2006) J. Shen, T. Abel, H. J. Mo, R. K. Sheth, An Excursion Set Model of the Cosmic Web: The
Abundance of Sheets, Filaments, and Halos, Astrophysical Journal 645, 783 (2006), astro-ph/0511365.
(Sheth & van de Weygaert, 2004) R. K. Sheth, R. van de Weygaert, A hierarchy of voids: much ado about
nothing, Monthly Notices of the Royal Astronomical Society 350, 517 (2004), astro-ph/0311260.
(Shi, Wang & Mo, 2015) J. Shi, H. Wang, H. Mo, Flow Patterns around Dark Matter Halos: the Link between
Halo Dynamical Properties and Large Scale Tidal Field, ArXiv e-prints (2015), arXiv:1501.07764.
(Shirata et al., 2007) A. Shirata, Y. Suto, C. Hikage, T. Shiromizu, N. Yoshida, Galaxy clustering constraints
on deviations from Newtonian gravity at cosmological scales. II. Perturbative and numerical analyses of power
spectrum and bispectrum, Physical Review D 76, 044026 (2007), arXiv:0705.1311.
(Shoji & Lee, 2012) M. Shoji, J. Lee, Voids in Redshift Space, ArXiv e-prints (2012), arXiv:1203.0869 [astro-
ph.CO].
(Short & Coles, 2006a) C. J. Short, P. Coles, Gravitational instability via the Schrödinger equation, Journal of
Cosmology and Astroparticle Physics 12, 12 (2006a), arXiv:astro-ph/0605012.
(Short & Coles, 2006b) C. J. Short, P. Coles, Wave mechanics and the adhesion approximation, Journal of
Cosmology and Astroparticle Physics 12, 16 (2006b), arXiv:astro-ph/0605013.
(Silk, 1968) J. Silk, Cosmic Black-Body Radiation and Galaxy Formation, Astrophysical Journal 151, 459 (1968).
(Silk, 1977) J. Silk, On the fragmentation of cosmic gas clouds. I - The formation of galaxies and the ﬁrst
generation of stars, Astrophysical Journal 211, 638 (1977).
(Somerville et al., 2001) R. S. Somerville, G. Lemson, Y. Sigad, A. Dekel, G. Kauﬀmann, S. D. M. White,
Non-linear stochastic galaxy biasing in cosmological simulations, Monthly Notices of the Royal Astronomical
Society 320, 289 (2001), astro-ph/9912073.
(Sousbie, 2011) T. Sousbie, The persistent cosmic web and its ﬁlamentary structure - I. Theory and implemen-
tation, Monthly Notices of the Royal Astronomical Society 414, 350 (2011), arXiv:1009.4015 [astro-ph.CO].
(Sousbie, Pichon & Kawahara, 2011) T. Sousbie, C. Pichon, H. Kawahara, The persistent cosmic web and its
ﬁlamentary structure - II. Illustrations, Monthly Notices of the Royal Astronomical Society 414, 384 (2011),
arXiv:1009.4014 [astro-ph.CO].
(Sousbie et al., 2008) T. Sousbie, C. Pichon, S. Colombi, D. Novikov, D. Pogosyan, The 3D skeleton: tracing the
ﬁlamentary structure of the Universe, Monthly Notices of the Royal Astronomical Society 383, 1655 (2008),
arXiv:0707.3123.
(Spergel et al., 2013) D. Spergel, N. Gehrels, J. Breckinridge, M. Donahue, A. Dressler, B. S. Gaudi, T. Greene,
O. Guyon, C. Hirata, J. Kalirai, N. J. Kasdin, W. Moos, S. Perlmutter, M. Postman, B. Rauscher, J. Rhodes,
Y. Wang, D. Weinberg, J. Centrella, W. Traub, C. Baltay, J. Colbert, D. Bennett, A. Kiessling, B. Macintosh,
J. Merten, M. Mortonson, M. Penny, E. Rozo, D. Savransky, K. Stapelfeldt, Y. Zu, C. Baker, E. Cheng,
D. Content, J. Dooley, M. Foote, R. Goullioud, K. Grady, C. Jackson, J. Kruk, M. Levine, M. Melton,
C. Peddie, J. Ruﬀa, S. Shaklan, Wide-Field InfraRed Survey Telescope-Astrophysics Focused Telescope Assets
WFIRST-AFTA Final Report, ArXiv e-prints (2013), arXiv:1305.5422 [astro-ph.IM].

210
Bibliography
(Spolyar, Sahlén & Silk, 2013) D. Spolyar, M. Sahlén, J. Silk, Topology and Dark Energy: Testing Gravity in
Voids, Physical Review Letters 111, 241103 (2013), arXiv:1304.5239 [astro-ph.CO].
(Springel, 2005) V. Springel, The cosmological simulation code GADGET-2, Monthly Notices of the Royal
Astronomical Society 364, 1105 (2005), astro-ph/0505010.
(Springel, 2014) V. Springel, High performance computing and numerical modelling, in Lecture notes given at the
43rd Saas Fee Advanced School, March 11-16, 2013, Villars-sur-Ollon, Switzerland (2014) arXiv:1412.5187.
(Springel, Yoshida & White, 2001) V. Springel, N. Yoshida, S. D. M. White, GADGET: a code for collisionless
and gasdynamical cosmological simulations, New Astronomy 6, 79 (2001), astro-ph/0003162.
(Star Trek: First Contact, 1996) Star Trek: First Contact, (1996).
(Starkman, Trotta & Vaudrevange, 2008) G. D. Starkman, R. Trotta, P. M. Vaudrevange, Introducing doubt in
Bayesian model comparison, ArXiv e-prints (2008), 0811.2415.
(Starobinsky, 1982) A. A. Starobinsky, Dynamics of phase transition in the new inﬂationary universe scenario
and generation of perturbations, Physics Letters B 117, 175 (1982).
(Stoica, Martínez & Saar, 2010) R. S. Stoica, V. J. Martínez, E. Saar, Filaments in observed and mock galaxy
catalogues, Astronomy and Astrophysics 510, A38 (2010), arXiv:0912.2021 [astro-ph.CO].
(Stoica, Martínez & Saar, 2007) R. S. Stoica, V. J. Martínez, E. Saar, A three-dimensional object point process
for detection of cosmic ﬁlaments., Journal of the Royal Statistical Society: Series C (Applied Statistics) 56
(4), 459-477 56, 1 (2007).
(Stoica et al., 2005) R. S. Stoica, V. J. Martínez, J. Mateu, E. Saar, Detection of cosmic ﬁlaments using the
Candy model, Astronomy and Astrophysics 434, 423 (2005), astro-ph/0405370.
(Stover, 2003) M. Stover, Star Wars: Shatterpoint (Del Rey, 2003).
(Strauss et al., 2002) M. A. Strauss, D. H. Weinberg, R. H. Lupton, V. K. Narayanan, J. Annis, M. Bernardi,
M. Blanton, S. Burles, A. J. Connolly, J. Dalcanton, M. Doi, D. Eisenstein, J. A. Frieman, M. Fukugita,
J. E. Gunn, Ž. Ivezić, S. Kent, R. S. J. Kim, G. R. Knapp, R. G. Kron, J. A. Munn, H. J. Newberg, R. C.
Nichol, S. Okamura, T. R. Quinn, M. W. Richmond, D. J. Schlegel, K. Shimasaku, M. SubbaRao, A. S.
Szalay, D. Vanden Berk, M. S. Vogeley, B. Yanny, N. Yasuda, D. G. York, I. Zehavi, Spectroscopic Target
Selection in the Sloan Digital Sky Survey: The Main Galaxy Sample, Astronomical Journal 124, 1810 (2002),
astro-ph/0206225.
(Sutter et al., 2015a) P. M. Sutter, E. Carlesi, B. D. Wandelt, A. Knebe, On the observability of coupled dark en-
ergy with cosmic voids, Monthly Notices of the Royal Astronomical Society 446, L1 (2015a), arXiv:1406.0511.
(Sutter et al., 2014a) P. M. Sutter, A. Pisani, B. D. Wandelt, D. H. Weinberg, A measurement of the Alcock-
Paczyński eﬀect using cosmic voids in the SDSS, Monthly Notices of the Royal Astronomical Society 443,
2983 (2014a), arXiv:1404.5618.
(Sutter et al., 2012a) P. M. Sutter, G. Lavaux, B. D. Wandelt, D. H. Weinberg, A First Application of the
Alcock-Paczynski Test to Stacked Cosmic Voids, Astrophysical Journal 761, 187 (2012a), arXiv:1208.1058
[astro-ph.CO].
(Sutter et al., 2012b) P. M. Sutter, G. Lavaux, B. D. Wandelt, D. H. Weinberg, A Public Void Catalog from
the SDSS DR7 Galaxy Redshift Surveys Based on the Watershed Transform, Astrophysical Journal 761, 44
(2012b), arXiv:1207.2524 [astro-ph.CO].
(Sutter et al., 2014b) P. M. Sutter, G. Lavaux, B. D. Wandelt, D. H. Weinberg, M. S. Warren, The dark matter
of galaxy voids, Monthly Notices of the Royal Astronomical Society 438, 3177 (2014b), arXiv:1311.3301
[astro-ph.CO].
(Sutter et al., 2014c) P. M. Sutter, G. Lavaux, N. Hamaus, B. D. Wandelt, D. H. Weinberg, M. S. Warren,
Sparse sampling, galaxy bias, and voids, Monthly Notices of the Royal Astronomical Society 442, 462 (2014c),
arXiv:1309.5087.

Bibliography
211
(Sutter et al., 2014d) P. M. Sutter, G. Lavaux, B. D. Wandelt, D. H. Weinberg, M. S. Warren, A. Pisani, Voids
in the SDSS DR9: observations, simulations, and the impact of the survey mask, Monthly Notices of the
Royal Astronomical Society 442, 3127 (2014d), arXiv:1310.7155.
(Sutter et al., 2015b) P. M. Sutter, G. Lavaux, N. Hamaus, A. Pisani, B. D. Wandelt, M. Warren, F. Villaescusa-
Navarro, P. Zivick, Q. Mao, B. B. Thompson, VIDE: The Void IDentiﬁcation and Examination toolkit,
Astronomy and Computing 9, 1 (2015b), arXiv:1406.1191.
(Szalay, 2014) A. Szalay, From Genes to Stars: the Fourth Paradigm of Science (Public conference given at the
Academia das Ciências de Lisboa on May 27th, 2014).
(Tadros et al., 1999) H. Tadros, W. E. Ballinger, A. N. Taylor, A. F. Heavens, G. Efstathiou, W. Saunders, C. S.
Frenk, O. Keeble, R. McMahon, S. J. Maddox, S. Oliver, M. Rowan-Robinson, W. J. Sutherland, S. D. M.
White, Spherical harmonic analysis of the PSCz galaxy catalogue: redshift distortions and the real-space power
spectrum, Monthly Notices of the Royal Astronomical Society 305, 527 (1999), astro-ph/9901351.
(Taﬀoni, Monaco & Theuns, 2002) G. Taﬀoni, P. Monaco, T. Theuns, PINOCCHIO and the hierarchical build-up
of dark matter haloes, Monthly Notices of the Royal Astronomical Society 333, 623 (2002), astro-ph/0109324.
(Takada et al., 2014) M. Takada, R. S. Ellis, M. Chiba, J. E. Greene, H. Aihara, N. Arimoto, K. Bundy,
J. Cohen, O. Doré, G. Graves, J. E. Gunn, T. Heckman, C. M. Hirata, P. Ho, J.-P. Kneib, O. L. Fèvre,
L. Lin, S. More, H. Murayama, T. Nagao, M. Ouchi, M. Seiﬀert, J. D. Silverman, L. Sodré, D. N. Spergel,
M. A. Strauss, H. Sugai, Y. Suto, H. Takami, R. Wyse, Extragalactic science, cosmology, and Galactic
archaeology with the Subaru Prime Focus Spectrograph, Publications of the Astronomical Society of Japan 66,
R1 (2014), arXiv:1206.0737.
(Taoso, Bertone & Masiero, 2008) M. Taoso, G. Bertone, A. Masiero, Dark matter candidates: a ten-point test,
Journal of Cosmology and Astroparticle Physics 3, 022 (2008), arXiv:0711.4996.
(Tassev & Zaldarriaga, 2012a) S. Tassev, M. Zaldarriaga, The mildly non-linear regime of structure formation,
Journal of Cosmology and Astroparticle Physics 4, 013 (2012a), arXiv:1109.4939 [astro-ph.CO].
(Tassev & Zaldarriaga, 2012b) S. Tassev, M. Zaldarriaga, Towards an optimal reconstruction of baryon oscilla-
tions, Journal of Cosmology and Astroparticle Physics 10, 006 (2012b), arXiv:1203.6066 [astro-ph.CO].
(Tassev & Zaldarriaga, 2012c) S. Tassev, M. Zaldarriaga, Estimating CDM particle trajectories in the mildly
non-linear regime of structure formation. Implications for the density ﬁeld in real and redshift space, Journal
of Cosmology and Astroparticle Physics 12, 011 (2012c), arXiv:1203.5785 [astro-ph.CO].
(Tassev, Zaldarriaga & Eisenstein, 2013) S. Tassev, M. Zaldarriaga, D. J. Eisenstein, Solving large scale structure
in ten easy steps with COLA, Journal of Cosmology and Astroparticle Physics 6, 036 (2013), arXiv:1301.0322
[astro-ph.CO].
(Tassev et al., 2015) S. Tassev, D. J. Eisenstein, B. D. Wandelt, M. Zaldarriaga, sCOLA: The N-body COLA
Method Extended to the Spatial Domain, ArXiv e-prints (2015), arXiv:1502.07751.
(Taylor, Ashdown & Hobson, 2008) J. F. Taylor, M. A. J. Ashdown, M. P. Hobson, Fast optimal CMB power
spectrum estimation with Hamiltonian sampling, Monthly Notices of the Royal Astronomical Society 389,
1284 (2008), arXiv:0708.2989.
(Tegmark et al., 2004) M. Tegmark, M. R. Blanton, M. A. Strauss, F. Hoyle, D. Schlegel, R. Scoccimarro, M. S.
Vogeley, D. H. Weinberg, I. Zehavi, A. Berlind, T. Budavari, A. Connolly, D. J. Eisenstein, D. Finkbeiner,
J. A. Frieman, J. E. Gunn, A. J. S. Hamilton, L. Hui, B. Jain, D. Johnston, S. Kent, H. Lin, R. Nakajima,
R. C. Nichol, J. P. Ostriker, A. Pope, R. Scranton, U. Seljak, R. K. Sheth, A. Stebbins, A. S. Szalay,
I. Szapudi, L. Verde, Y. Xu, J. Annis, N. A. Bahcall, J. Brinkmann, S. Burles, F. J. Castander, I. Csabai,
J. Loveday, M. Doi, M. Fukugita, J. R. Gott, III, G. Hennessy, D. W. Hogg, Ž. Ivezić, G. R. Knapp, D. Q.
Lamb, B. C. Lee, R. H. Lupton, T. A. McKay, P. Kunszt, J. A. Munn, L. O’Connell, J. Peoples, J. R. Pier,
M. Richmond, C. Rockosi, D. P. Schneider, C. Stoughton, D. L. Tucker, D. E. Vanden Berk, B. Yanny, D. G.
York, SDSS Collaboration, The Three-Dimensional Power Spectrum of Galaxies from the Sloan Digital Sky
Survey, Astrophysical Journal 606, 702 (2004), astro-ph/0310725.

212
Bibliography
(Tempel, Stoica & Saar, 2013) E. Tempel, R. S. Stoica, E. Saar, Evidence for spin alignment of spiral and
elliptical/S0 galaxies in ﬁlaments, Monthly Notices of the Royal Astronomical Society 428, 1827 (2013),
arXiv:1207.0068 [astro-ph.CO].
(Tempel et al., 2014) E. Tempel, R. S. Stoica, V. J. Martínez, L. J. Liivamägi, G. Castellan, E. Saar, Detecting
ﬁlamentary pattern in the cosmic web: a catalogue of ﬁlaments for the SDSS, Monthly Notices of the Royal
Astronomical Society 438, 3465 (2014), arXiv:1308.2533 [astro-ph.CO].
(Teyssier, 2014) R. Teyssier, Computational cosmology, in Lecture Notes of the Les Houches Summer School
“Post-Planck Cosmology”: Volume 100, July 2013, edited by C. Deﬀayet, P. Peter, B. Wandelt, M. Zaldar-
riaga, L. F. Cugliandolo (2014).
(Tinker & Conroy, 2009) J. L. Tinker, C. Conroy, The Void Phenomenon Explained, Astrophysical Journal
691, 633 (2009), arXiv:0804.2475.
(Tolkien, 1954) J. R. R. Tolkien, The Lord of the Rings – The Fellowship of the Ring (George Allen & Unwin,
1954).
(Trodden & Carroll, 2004) M. Trodden, S. M. Carroll, TASI Lectures: Introduction to Cosmology, Astronomy
(2004), arXiv:astro-ph/0401547.
(Trotta, 2008) R. Trotta, Bayes in the sky: Bayesian inference and model selection in cosmology, Contemporary
Physics 49, 71 (2008), arXiv:0803.4089.
(Valageas, 2007) P. Valageas, Large-N expansions applied to gravitational clustering, Astronomy and Astro-
physics 465, 725 (2007), astro-ph/0611849.
(Valageas & Bernardeau, 2011) P. Valageas, F. Bernardeau, Density ﬁelds and halo mass functions in the
geometrical adhesion toy model, Physical Review D 83, 043508 (2011), arXiv:1009.1974 [astro-ph.CO].
(van de Weygaert & Schaap, 2009) R. van de Weygaert, W. Schaap, The Cosmic Web: Geometric Analysis,
in Data Analysis in Cosmology, Lecture Notes in Physics, Berlin Springer Verlag, Vol. 665, edited by V. J.
Martínez, E. Saar, E. Martínez-González, M.-J. Pons-Bordería (2009) pp. 291–413.
(van de Weygaert & Platen, 2011) R. van de Weygaert, E. Platen, Cosmic Voids: Structure, Dynamics and
Galaxies, International Journal of Modern Physics Conference Series 1, 41 (2011), arXiv:0912.2997 [astro-
ph.CO].
(van de Weygaert & van Kampen, 1993) R. van de Weygaert, E. van Kampen, Voids in Gravitational Instability
Scenarios - Part One - Global Density and Velocity Fields in an Einstein - De-Sitter Universe, Monthly
Notices of the Royal Astronomical Society 263, 481 (1993).
(van de Weygaert & Bertschinger, 1996) R. van de Weygaert, E. Bertschinger, Peak and gravity constraints
in Gaussian primordial density ﬁelds: An application of the Hoﬀman-Ribak method, Monthly Notices of the
Royal Astronomical Society 281, 84 (1996), astro-ph/9507024.
(Verde, 2010) L. Verde, Statistical Methods in Cosmology, in Lecture Notes in Physics, Berlin Springer Ver-
lag, Lecture Notes in Physics, Berlin Springer Verlag, Vol. 800, edited by G. Wolschin (2010) pp. 147–177,
arXiv:0911.3105.
(Verde et al., 1998) L. Verde, A. F. Heavens, S. Matarrese, L. Moscardini, Large-scale bias in the Universe
- II. Redshift-space bispectrum, Monthly Notices of the Royal Astronomical Society 300, 747 (1998), astro-
ph/9806028.
(Verde et al., 2002) L. Verde, A. F. Heavens, W. J. Percival, S. Matarrese, C. M. Baugh, J. Bland-Hawthorn,
T. Bridges, R. Cannon, S. Cole, M. Colless, C. Collins, W. Couch, G. Dalton, R. De Propris, S. P. Driver,
G. Efstathiou, R. S. Ellis, C. S. Frenk, K. Glazebrook, C. Jackson, O. Lahav, I. Lewis, S. Lumsden, S. Maddox,
D. Madgwick, P. Norberg, J. A. Peacock, B. A. Peterson, W. Sutherland, K. Taylor, The 2dF Galaxy Redshift
Survey: the bias of galaxies and the density of the Universe, Monthly Notices of the Royal Astronomical
Society 335, 432 (2002), arXiv:astro-ph/0112161.

Bibliography
213
(Verdinelli & Wasserman, 1995) I. Verdinelli, L. Wasserman, Computing Bayes Factors Using a Generalization
of the Savage-Dickey Density Ratio, Journal of the American Statistical Association 90, 614 (1995).
(Verleysen & François, 2005) M. Verleysen, D. François, The curse of dimensionality in data mining and time
series prediction, in Computational Intelligence and Bioinspired Systems (Springer, 2005) pp. 758–770.
(Vettolani et al., 1997) G. Vettolani, E. Zucca, G. Zamorani, A. Cappi, R. Merighi, M. Mignoli, G. M. Stirpe,
H. MacGillivray, C. Collins, C. Balkowski, V. Cayatte, S. Maurogordato, D. Proust, G. Chincarini, L. Guzzo,
D. Maccagni, R. Scaramella, A. Blanchard, M. Ramella, The ESO Slice Project (ESP) galaxy redshift survey.
I. Description and ﬁrst results., Astronomy and Astrophysics 325, 954 (1997), astro-ph/9704097.
(Viel, Colberg & Kim, 2008) M. Viel, J. M. Colberg, T.-S. Kim, On the importance of high-redshift intergalactic
voids, Monthly Notices of the Royal Astronomical Society 386, 1285 (2008), arXiv:0801.1105.
(Vogelsberger et al., 2014) M. Vogelsberger, S. Genel, V. Springel, P. Torrey, D. Sijacki, D. Xu, G. Snyder,
S. Bird, D. Nelson, L. Hernquist, Properties of galaxies reproduced by a hydrodynamic simulation, Nature
509, 177 (2014), arXiv:1405.1418.
(Wandelt, 2013) B. D. Wandelt, Astrostatistical Challenges for the New Astronomy (Springer, 2013) Chap.
Gaussian Random Fields in Cosmostatistics, pp. 87–105.
(Wandelt, Larson & Lakshminarayanan, 2004) B. D. Wandelt, D. L. Larson, A. Lakshminarayanan, Global,
exact cosmic microwave background data analysis using Gibbs sampling, Physical Review D 70, 083511 (2004),
astro-ph/0310080.
(Wang et al., 2012) H. Wang, H. J. Mo, X. Yang, F. C. van den Bosch, Reconstructing the cosmic velocity
and tidal ﬁelds with galaxy groups selected from the Sloan Digital Sky Survey, Monthly Notices of the Royal
Astronomical Society 420, 1809 (2012), arXiv:1108.1008 [astro-ph.CO].
(Wang et al., 2013) H. Wang, H. J. Mo, X. Yang, F. C. van den Bosch, Reconstructing the Initial Density
Field of the Local Universe: Methods and Tests with Mock Catalogs, Astrophysical Journal 772, 63 (2013),
arXiv:1301.1348 [astro-ph.CO].
(Weinberg, 1992) D. H. Weinberg, Reconstructing primordial density ﬂuctuations. I - Method, Monthly Notices
of the Royal Astronomical Society 254, 315 (1992).
(Weinberg & Gunn, 1990) D. H. Weinberg, J. E. Gunn, Large-scale Structure and the Adhesion Approximation,
Monthly Notices of the Royal Astronomical Society 247, 260 (1990).
(Welker et al., 2014) C. Welker, J. Devriendt, Y. Dubois, C. Pichon, S. Peirani, Mergers drive spin swings
along the cosmic web, Monthly Notices of the Royal Astronomical Society 445, L46 (2014), arXiv:1403.2728
[astro-ph.CO].
(Weyant, Schafer & Wood-Vasey, 2013) A. Weyant, C. Schafer, W. M. Wood-Vasey, Likelihood-free Cosmolog-
ical Inference with Type Ia Supernovae: Approximate Bayesian Computation for a Complete Treatment of
Uncertainty, Astrophysical Journal 764, 116 (2013), arXiv:1206.2563 [astro-ph.CO].
(White & Rees, 1978) S. D. M. White, M. J. Rees, Core condensation in heavy halos - A two-stage theory for
galaxy formation and clustering, Monthly Notices of the Royal Astronomical Society 183, 341 (1978).
(Wolpert & Macready, 1997) D. H. Wolpert, W. G. Macready, No free lunch theorems for optimization, IEEE
Transactions on Evolutionary Computation 1, 67 (1997).
(Wolstenhulme, Bonvin & Obreschkow, 2014) R. Wolstenhulme, C. Bonvin, D. Obreschkow, Three-point phase
correlations: A new measure of non-linear large-scale structure, ArXiv e-prints (2014), arXiv:1409.3007.
(Yan, Fan & White, 2012) H. Yan, Z. Fan, S. D. M. White, On the Tidal Dependence of Galaxy Properties,
ArXiv e-prints (2012), arXiv:1203.1225 [astro-ph.GA].
(York et al., 2000) D. G. York, J. Adelman, J. E. Anderson, Jr., et al., The Sloan Digital Sky Survey: Technical
Summary, Astronomical Journal 120, 1579 (2000), astro-ph/0006396.

214
Bibliography
(Yoshisato et al., 2006) A. Yoshisato, M. Morikawa, N. Gouda, H. Mouri, Why is the Zel’dovich Approximation
So Accurate?, Astrophysical Journal 637, 555 (2006), astro-ph/0510107.
(Yu et al., 2011) Y. Yu, P. Zhang, W. Lin, W. Cui, J. N. Fry, Gaussianizing the non-Gaussian lensing conver-
gence ﬁeld: The performance of the Gaussianization, Physical Review D 84, 023523 (2011), arXiv:1103.2858
[astro-ph.CO].
(Yu et al., 2012) Y. Yu, P. Zhang, W. Lin, W. Cui, J. N. Fry, Gaussianizing the non-Gaussian lensing con-
vergence ﬁeld II. The applicability to noisy data, Physical Review D 86, 023515 (2012), arXiv:1201.4527
[astro-ph.CO].
(Zaroubi, 2002) S. Zaroubi, Unbiased reconstruction of the large-scale structure, Monthly Notices of the Royal
Astronomical Society 331, 901 (2002), astro-ph/0010561.
(Zel’dovich & Novikov, 1983) I. B. Zel’dovich, I. D. Novikov, Chicago, IL, University of Chicago Press, 1983,
751 p. Translation. (University of Chicago Press, 1983).
(Zel’dovich, Einasto & Shandarin, 1982) I. B. Zel’dovich, J. Einasto, S. F. Shandarin, Giant voids in the universe,
Nature 300, 407 (1982).
(Zel’dovich, 1970) Y. B. Zel’dovich, Gravitational instability: An approximate theory for large density perturba-
tions., Astronomy and Astrophysics 5, 84 (1970).
(Zhang et al., 2009) Y. Zhang, X. Yang, A. Faltenbacher, V. Springel, W. Lin, H. Wang, The Spin and Orienta-
tion of Dark Matter Halos Within Cosmic Filaments, Astrophysical Journal 706, 747 (2009), arXiv:0906.1654
[astro-ph.GA].
(Zhang et al., 2013) Y. Zhang, X. Yang, H. Wang, L. Wang, H. J. Mo, F. C. van den Bosch, Alignments of
Galaxies within Cosmic Filaments from SDSS DR7, Astrophysical Journal 779, 160 (2013), arXiv:1309.3847
[astro-ph.CO].
(Zhao et al., 2015) C. Zhao, F.-S. Kitaura, C.-H. Chuang, F. Prada, G. Yepes, C. Tao, Halo mass distribution
reconstruction across the cosmic web, ArXiv e-prints (2015), arXiv:1501.05520.

Index
N-body simulation 4, 12, 25, 29–41, 44, 45, 74,
95–103, 105, 106, 112, 114, 117, 120, 125, 132,
135, 141, 149, 155, 161, 165, 167, 170, 174, 184,
185
Γ-distribution 71, 72
ΛCDM lambda cold dark matter 8, 20, 22, 24, 53,
80, 117, 119, 126, 129, 150, 157
21 cm surveys 106
2LPT second-order Lagrangian perturbation the-
ory 24, 29–32, 34, 35, 37–44, 68, 69, 73–75,
80, 81, 83, 86, 87, 89, 91, 96, 98, 99, 101–105,
109–114, 121, 122, 125, 126, 133, 135, 138, 141,
148, 154, 155, 168, 177, 178, 185
2LPTRM second-order Lagrangian perturbation
theory remapped 30–32, 34, 35, 103, 104
2LPTic 29, 177
3LPT third-order Lagrangian perturbation theory
41
ABC Approximate Bayesian Computation 56
acceptance rate 59, 60, 62, 66, 74, 81, 82, 91
adhesion approximation 26, 27, 96
Alcock-Paczynski eﬀect 2, 9, 126
aliasing 31, 169, 170
ALPT Augmented Lagrangian perturbation theory
43, 44
ARES Algorithm for REconstruction and Sampling
66, 70, 75, 77
assignment function 169–171, 173
auto-correlation function (Markov chain) 60
BAO baryon acoustic oscillations 2, 3, 67, 74, 96,
97, 157, 178
Bayes factor 57
Bayes’ theorem 51–54, 57, 71
Bayesian statistics 4, 49–53, 56, 62, 71, 111, 118,
129, 138, 149, 155
BBN Big Bang nucleosynthesis 2
Bernstein-von Mises theorem 53
bias 2, 34, 52, 62, 66, 68–70, 74, 75, 77, 79–83, 89,
91, 117–119, 121, 125–129, 134, 135, 137, 148,
155, 157
bispectrum 15, 34–37, 95, 105, 106, 156
Blackwell-Rao estimator 119, 120, 122, 124–127,
129
Boltzmann constant 61
BORG Bayesian
Origin
Reconstruction
from
Galaxies 4, 49, 56, 60, 63, 66–72, 74–77, 79,
80, 82, 86, 89, 91, 92, 109–114, 117, 119–123,
125–129, 131, 133–136, 138, 143, 148, 149, 151,
154–157, 177, 178
Box-Müller method 177
Burgers’ equation 26, 27
burn-in 58, 60, 73–75, 81–83, 91
canonical distribution 61, 62
cdf cumulative distribution function 97, 100, 101
CDM cold dark matter 2, 8, 15, 18, 20, 22, 95, 165
characteristic function 161–163
Cholesky decomposition 178
chrono-cosmography 79, 80, 89, 92, 131, 133, 143,
148, 155, 158
CiC cloud-in-cell 29, 31, 34, 68, 73, 74, 101, 113,
138, 170–175, 178, 184, 185
classical mechanics 60, 113
cluster 4, 29, 37, 38, 40, 44, 45, 75, 91, 92, 96, 99,
100, 103, 111, 118, 126, 131–137, 140–142, 145,
147–152, 154, 156, 179, 181–185
CMB cosmic microwave background 10, 52, 62, 75,
118, 129, 133, 156, 157
CMB lensing 62, 157
COLA COmoving Lagrangian Acceleration 109,
111–114, 133–136, 138, 148, 155, 165–168, 170,
175–177
comoving coordinates 10, 16, 22, 23, 25, 37, 40,
68, 74, 75, 86, 89, 90, 92, 106, 147, 166, 182,
185
compensation 118, 128, 132, 137
conditional density contrast 14
conditional independence 11, 71, 75, 121, 124,
161–163

216
Glossary
conditional pdf 11, 14, 51, 58, 60, 67, 71, 72, 77,
136, 140, 150, 163
conformal expansion rate 8
conformal time 8, 16, 22, 23, 182
conservative map 151, 152, 154
constrained likelihood 53
constrained simulation 109, 110, 117, 119, 121,
122, 128, 131, 133, 134, 140, 148, 155, 178
continuity equation 17, 19, 25
Cosmic Emulator 30, 31
cosmic time 8
cosmic variance 32, 34, 118
cosmic web 1, 4, 29, 40, 75, 91, 110, 118, 121, 123,
131–135, 140, 147–149, 154–156, 158, 179
cosmic web classiﬁcation 4, 24, 44, 56, 131, 133–
136, 138, 140, 142, 147–150, 154, 156, 179, 181–
185
cosmological constant 8, 20
cosmological parameters 8, 15, 19, 20, 22, 30, 37,
42, 62, 67, 74, 75, 80, 101, 103, 106, 125, 138,
157, 178, 185
CosmoMC 58
cosmostatistics 3, 10, 49
Cox’s desiderata 51, 53
Cox-Jaynes theorem 51
Cromwell’s rule 53
cross-correlation 32, 33, 42, 43, 75, 105, 113, 114,
129, 148, 154, 156
curse of dimensionality 63–66
dark energy 2, 8, 19, 54, 56, 118, 125–127, 157,
158
dark matter 2, 15, 17, 18, 40, 117–119, 125, 129,
135, 155, 156
dark matter particles 15, 29, 31, 32, 34, 41, 42,
68, 74, 80, 86, 87, 89, 90, 92, 95, 107, 111–113,
119, 122, 123, 125–128, 138, 166–170, 172, 173,
175, 178, 185
dark matter void 4, 110, 111, 117–120, 122–129,
155
dark-energy domination 2, 8
data 52, 53, 66, 68, 71, 72, 74, 75, 79, 80, 83, 85,
86, 89, 92, 110, 117, 119, 122–124, 127–129,
133–140, 142–144, 147–152, 154–158
data assimilation 4, 63, 155, 157, 158
data model 4, 54, 63, 66, 67, 69, 70, 155, 157
decaying mode 19–21, 23
decision theory 4, 149–152, 154, 156
declination 68, 86
decoupling 2
density contrast 9–13, 16–19, 22, 23, 30, 34, 37–
41, 43, 67–69, 73, 75, 95, 97–99, 101, 103, 104,
106, 121, 122, 136, 137, 141, 142, 168, 169, 172,
173, 178, 180–182, 184, 185
density ﬁeld 2, 4, 10, 12, 17, 19, 21–26, 29–34, 37,
41–45, 66–69, 72, 74–77, 79–86, 88, 89, 91, 92,
95–107, 109–114, 118–122, 124–126, 129, 131–
136, 138, 141, 143, 147, 148, 154–156, 167–170,
177, 179, 180, 184, 185
density proﬁle 117–119, 122, 125, 127–129, 180,
181
detailed balance 58–60
diﬀusion equation 27
Dirac delta distribution 13, 15, 52, 55, 67
displacement ﬁeld 22, 23, 25, 29, 31, 37, 40, 41,
44, 112, 132, 155, 156, 166, 168, 177, 178
DIVA DynamIcal Void Analysis 40, 132
divergence of the Lagrangian displacement ﬁeld
23, 29, 37–42
drift 74, 166, 175–178
eigenvalue 23, 24, 44, 132, 134, 136, 137, 141, 142,
178, 181–185
Einstein’s equations 8, 132
Einstein-de Sitter universe 20, 21
ellipticity distribution 117, 119, 122, 125–127,
129, 180, 181
ensemble average 9, 12–14
entropy 134, 138, 139, 142–144, 147, 148
EPT Eulerian perturbation theory 7, 18, 21, 25, 96,
101, 107, 132

Glossary
217
equation of motion 15–17, 19, 22, 73, 74, 112,
166, 182, 183
equation of state 1, 8, 18, 54, 56, 126, 157
ergodicity 9, 58
estimator 37, 44, 50, 52, 99, 179
Euler’s equation 17, 19, 25, 26, 96
Euler’s method 175
evidence 52, 54, 56, 57
exascale computers 3
excess kurtosis 38, 40
expansion 1, 2, 15–17, 19, 23, 118, 147, 157
exploration of the posterior 54, 55, 62
extended logic 49, 51
fair game 151
FDA ﬁnite diﬀerence approximation 168, 174, 178
ﬁlament 4, 24, 26, 29, 44, 45, 75, 79, 83, 86, 91, 96,
99, 111, 121, 131–137, 140, 142, 145, 147–150,
152, 154, 156, 179, 181–185
ﬁnal conditions 40, 41, 67, 68, 71, 72, 74, 75, 77,
80–86, 88, 89, 91, 92, 97, 98, 100, 106, 109–111,
113, 114, 117, 119, 122, 128, 132–139, 141–143,
147, 151, 152, 154, 155, 157, 158, 175, 185
ﬂat prior 53
ﬂuid 2, 15, 17, 18, 22, 23, 25, 27, 96, 155, 165, 178
formation history 2, 4, 63, 71, 79, 80, 86, 88, 89,
91, 92, 96, 126, 131, 133, 134, 143, 148, 155,
156
forward modeling 51, 68, 74, 110, 135
Fourier transform 3, 41, 161, 162, 169–171, 173,
174, 178, 184
free-particle approximation 27
frequentist statistics 49–53, 57, 124
Friedmann’s equations 8, 16, 17, 19, 20, 167
frozen ﬂow approximation 26
full gravity 29, 32, 37, 39–43, 68, 69, 95–101, 103–
106, 109–111, 114, 117, 119, 121, 128, 131, 135,
148, 155
Gadget-2 29, 109–114, 121, 125, 155, 174, 185
gain function 150, 151, 154
galaxy formation 2, 69, 118, 121, 156
galaxy survey 1, 2, 4, 9, 12, 15, 29, 40, 62, 64, 66,
80, 86, 89, 95, 97, 106, 107, 117, 118, 120, 128,
129, 132, 134, 149, 155
galaxy void 117, 118, 120, 122, 124–129
Gaussian kernel 43, 174, 184
Gaussianization 96, 97, 106
general relativity 2, 7, 8, 15, 54, 56, 127, 133
Gibbs sampling 60, 75
gravitational constant 8
gravitational evolution 1, 2, 7, 9–11, 15, 16, 18,
24, 25, 97, 110, 126, 133, 155, 156, 182
gravitational ﬁeld 25, 184
gravitational potential 9, 16–18, 23, 25, 26, 44,
136, 157, 166–168, 173, 174, 181, 183, 184
Green function 173, 174, 184
grf Gaussian random ﬁeld 2, 4, 10–12, 14, 41, 55, 66,
67, 74, 75, 77, 83, 86, 91, 118, 121, 122, 125,
129, 132, 134, 135, 138, 142, 143, 155, 161, 162,
177, 185
growing mode 19, 21, 23, 24
HADES HAmiltonian
Density
Estimation
and
Sampling 12, 66
halo 2, 24, 26, 31, 38, 40, 45, 113, 119, 132, 133,
135, 141, 148, 183
Hamilton’s equations 61, 62, 66, 73, 175
Hastings ratio 59, 60
HDM hot dark matter 2
Helmholtz decomposition 43
high-dimensional function 65, 89
high-dimensional parameter space 53, 55, 56,
59, 60, 64, 65, 72, 73, 75, 80, 82, 89, 91, 121,
133–135, 155
high-order correlation function 2, 10, 11, 14,
40, 79, 83, 86, 89, 91, 95, 96, 99, 101, 106,
119, 121, 132, 134, 135, 148
HMC Hamiltonian Monte Carlo 60–63, 66, 72–74,
77, 80, 89, 121, 135, 155, 157
homogeneous Universe 8, 16, 19, 64, 96, 158

218
Glossary
Hot Big Bang 1, 2
Hubble ﬂow 16, 112
Hubble parameter 8, 19, 20
Hubble radius 15
hypothesis testing 50, 54
inference 49, 50, 52, 54, 62, 79, 80, 85, 89, 91, 92,
133–135, 143, 148, 154, 156, 157
inﬂation 1, 2, 9, 10, 132, 156
inﬂaton 1
information content 2, 4, 86, 92, 95, 97, 106, 107,
135, 138, 139, 142–144, 147, 148, 156–158, 169
information theory 51, 131, 134, 138, 148, 156
initial conditions 1–4, 10, 15, 24, 29, 31, 32, 37,
40, 41, 43, 62, 66–69, 71–75, 77, 79–86, 88,
89, 91, 92, 97–101, 104–106, 109–111, 113, 117,
119–122, 124, 125, 128, 129, 131–135, 138, 141–
144, 148, 151, 154–158, 161, 165–167, 175–178,
182, 185
integrated Sachs-Wolfe eﬀect 118, 129, 133, 157
interpolation 166–168, 172–175, 178
invariant distribution 58
inverse problem 51, 91
isocurvature perturbations 56, 157
Jeﬀreys’ priors 53
Jeﬀreys’ scale 57
Kac’s theorem 161, 163
KDK kick drift kick 74, 175
kick 62, 74, 166, 168, 175–178
Kronecker symbol 18, 73, 136
Kullback-Leibler divergence 134, 138–140, 143,
144, 148
Lagrangian potential 24, 42, 44, 178, 182
Lagrangian transport 85, 89, 90, 92, 110, 122,
135, 147, 148, 158
large-scale structure inference 4, 63, 66, 69, 74,
75, 79, 82, 86, 89, 90, 107, 109, 112, 117–120,
129, 131, 133–135, 148, 149, 154–157, 177
large-scale structure likelihood 68, 69, 71, 75,
109, 119, 129, 135
leapfrog 73, 74, 175, 176
lightcone 9, 69, 157
likelihood 52–54, 56, 57, 60, 68, 73, 134
likelihood-free methods 56
linear evolution 2, 96
linear growth factor 19–21, 23, 25, 40, 73, 113,
167, 177
linear potential approximation 26
linear regime 19, 23, 26, 30, 32, 63, 89, 109, 111,
119, 120, 132, 135, 157
Liouville’s theorem 17, 61
local 23–26, 37, 41, 69, 99, 107, 133, 169, 180
local Lagrangian approximations 42
local tidal approximation 26
log-normal distribution 10, 12, 31, 62, 83, 91,
118, 134
low-pass ﬁlter 169–171
LPT Lagrangian perturbation theory 4, 7, 22, 23,
25, 29–35, 37–45, 95–103, 105–107, 110, 112,
113, 132, 135, 141, 155, 165–168, 177, 178
LSS large-scale structure. 1–4, 9, 15, 29, 37, 45, 64,
66, 71, 79, 80, 82, 83, 86, 88, 89, 91, 92, 95–
97, 99, 101, 106, 109, 110, 117–119, 121, 122,
126–128, 131–135, 137, 138, 141–143, 147–153,
155–157, 181
luminosity 66, 68–71, 74, 79–81, 83, 86, 88, 89, 91,
121, 122, 129, 133–135, 156
machine epsilon 65
machine learning 51
marginal pdf 11, 54–58, 62, 68, 163
mask 52, 66, 70, 74, 80, 86, 118, 134, 154
mass matrix 61, 73, 74
mass resolution 30, 106, 168, 185
matter domination 2, 8, 15, 67
maximum-entropy 51
MCMC Markov Chain Monte Carlo 49, 56, 58–60,
65, 82, 91, 119

Glossary
219
mesh assignment 34, 68, 101, 147, 166, 168, 170–
174, 184
Metropolis ratio 59
Metropolis update 59, 62
MFF mass ﬁlling fraction 131, 133, 140, 141, 143,
146–148
MH Metropolis-Hastings 59, 60, 62, 65
mildly non-linear regime 4, 30–32, 34, 37, 63,
89, 95–97, 100, 105, 106, 109–111, 119, 120,
132, 134, 135, 155, 157
mock catalog 63, 74–76, 95–97, 101, 106, 118
mode coupling 96, 97, 112, 134, 166, 167
model comparison 15, 49, 50, 53, 54, 56, 57, 119
moment 10, 11, 15, 17, 18, 40, 96
momentum 17, 18, 61, 62, 96, 166–168, 173, 175–
178
MUSCLE Multiscale spherical collapse 42, 43
N-GenIC 29, 177
nested model 57
neutrino 2
Newtonian gravity 15, 27
NGP nearest grid point 68, 170, 171, 173
no-free lunch theorem 49, 53, 58
noise 52, 54, 66, 69, 79, 83, 85, 89, 91, 118, 119,
121, 127–129, 135, 148, 155
noise parameter 66, 70–72, 75, 77, 80, 81, 83, 89,
129
non-committal prior 57
non-Gaussianity 4, 10, 30, 34, 40, 41, 56, 62, 67,
119, 121, 124, 135, 156
non-linear approximation 7, 25, 96
non-linear evolution 2, 4, 10, 23, 25, 40, 43, 66,
95–97, 101, 106, 107, 110, 119, 121, 134, 141,
155, 157
non-linear ﬁltering 4, 109–113, 119, 121, 127–
129, 134–136, 141, 147, 155
non-linear regime 12, 19, 25, 26, 32, 44, 97, 106,
107, 111, 114, 128, 131–135, 148, 149
non-local 21, 24, 25, 31, 34, 40–42, 69, 85, 86, 89,
90, 92, 122, 134, 174
non-magnetic approximation 26
nuisance parameters 54, 61
number function 68, 71, 84, 103, 117, 119, 122,
125, 126, 129, 180
Nyquist wavenumber 31, 111, 169, 171
Nyquist-Shannon sampling theorem 169
Occam’s razor 56, 57
OCDM open cold dark matter 20
one-point distribution 10, 12, 30, 31, 37, 40–42,
75, 95–101, 103, 106, 121, 134, 135, 155
ORIGAMI Order-ReversIng
Gravity,
Appre-
hended Mangling Indices 40, 132
pancake 24, 26, 182
paradigms of science 3
parameter inference 49, 50, 54, 56, 58
particle realization 29, 41, 44, 45, 68, 72, 74, 75,
86, 98, 99, 101, 103, 104, 109–114, 155, 177,
178
partition function 61
path integral formalism 96
pdf probability distribution function 2, 9–13, 30, 31,
37, 40, 52–54, 56–58, 60, 61, 65, 66, 75, 97–99,
101, 103, 119, 129, 134, 136–145, 147, 155, 161,
162
peculiar velocity 16–18, 66
peculiar velocity ﬂow 17, 25
periodic boundary conditions 29, 74, 98, 104,
113, 122, 168, 172, 175, 185
phase 32, 44, 105, 126, 134, 156
phase space 17, 18, 40, 61, 62, 74, 119, 132, 156,
175
photometric redshift 52, 62, 66, 157
physical density prior 67, 68
plausibility 51
plausible reasoning 49, 51
PM particle-mesh 4, 112, 113, 165–170, 173–175,
177, 178

220
Glossary
Poisson equation 17, 19, 23–27, 42, 166–168, 173,
181, 182, 184
Poisson intensity ﬁeld 69, 70
Poisson likelihood 69, 71, 85, 121
Poisson process 69, 74, 85, 91, 138
posterior 4, 52–58, 63, 66, 71, 72, 74, 75, 77, 82,
86, 119, 121, 122, 124, 129, 134–136, 138–145,
147, 148, 150–152, 154–156
posterior mean 54, 75, 81, 83–85, 91, 92, 136, 137,
140–142
posterior odds 57
posterior standard deviation 54, 75, 81, 83, 85,
89, 91, 92, 137
potential well 2, 21, 95
power spectrum 2, 13–15, 29–34, 41, 42, 44, 62,
66, 67, 74, 75, 77, 80–83, 91, 95, 99, 100, 105,
106, 111, 112, 118, 119, 122, 125, 126, 134, 138,
177, 178, 185
principal component analysis 66
prior 12, 49, 52–54, 56, 57, 66–69, 71, 73, 75, 77,
117, 119, 121–123, 126–129, 134, 135, 137–145,
147, 148, 150, 151, 154, 156
prior choice 52, 53
prior volume 53, 57
probability (deﬁnition) 50
probability theory 4, 49–53, 149, 155
proper prior 53
proposal distribution 59, 60, 62, 65
quantum ﬁeld theory 2, 96
quantum ﬂuctuation 1, 10
radiation domination 2
recombination 2
reconstruction 3, 32, 62, 69, 75, 79, 92, 96, 99,
111, 114, 118, 119, 121, 123–129, 133–136, 155,
184
redshift 8, 29–38, 40, 41, 52, 68, 75, 80, 86, 95, 97,
98, 101–106, 110–114, 119, 134, 140, 147, 151,
154, 157, 177
redshift-space distortions 2, 9, 66, 69, 127, 135,
157
reduced bispectrum 15
Rees-Sciama eﬀect 133, 157
reionization 106
remapping 4, 30–35, 95–107, 110
remapping function 97, 100–103
renormalization group ﬂow 96
renormalized perturbation theory 96
reversibility 58, 61, 62, 74
right ascension 68, 86
risk aversion 151, 152, 154
sample 4, 50, 55–59, 63–65, 68–72, 74, 75, 77, 80–
91, 109–113, 121–124, 129, 134–138, 140–142,
147, 148, 151, 154, 155
sample average 9, 13
sampling 55, 56, 58–61, 63–67, 71, 72, 74, 75, 77,
89, 118, 119, 121, 122, 126, 128, 129, 135, 155,
157, 169, 170
Savage-Dickey ratio 57
SC spherical collapse 24, 26, 42, 43, 96, 183
scalar ﬁeld 1, 9, 10, 12, 136, 161, 162
scalar part 43, 44
scale factor 1, 8, 19, 20, 42, 67, 82, 85, 86, 88, 89,
91, 114, 121, 138, 147, 166, 175, 176
SCDM standard cold dark matter 20
Schechter luminosity functions 74, 80
Schrödinger equation 27
Schur-complement 163
SDSS Sloan Digital Sky Survey 4, 53, 56, 70, 74,
79, 80, 82, 84, 86, 89, 91, 92, 117–126, 128,
129, 131–135, 137, 139, 140, 142–144, 147–149,
151, 154, 155
second-order growth factor 21, 24, 73, 167, 177
selection eﬀects 2, 52, 66, 68–70, 74, 79, 80, 83,
86, 89, 91, 118, 119, 121, 122, 125, 126, 129,
134–136, 140, 148, 154, 155, 157
shape function 169–171, 173
sheet 4, 24, 29, 44, 45, 79, 96, 99, 117, 131–137, 140,
142, 145, 147–150, 152, 154, 156, 179, 181–185

Glossary
221
shell-crossing 18, 22, 24, 26, 42, 44, 96, 97, 106,
155, 182
shot noise 37, 85, 129, 180
single-stream approximation 18, 26
skewness 30, 38, 40
sparsity 53, 64, 117–119, 121, 125–129
spectroscopic redshift 80
speculative map 151, 152
statistical homogeneity 1, 2, 4, 9, 12–15, 67, 69,
135, 178
statistical isotropy 1, 2, 4, 9, 12, 13, 15, 69, 135,
178
statistical mechanics 61, 96
statistical uncertainty 4, 55, 69, 79, 89, 91, 92,
105, 119, 124, 126, 127, 129, 156
stress tensor 17–19
structure formation 2, 4, 7, 10, 15, 18, 24, 40, 44,
54, 66–68, 71, 74, 75, 79, 86, 89, 91, 95, 96,
101, 105, 106, 109–112, 119, 121, 122, 131–134,
136, 141, 148, 149, 154, 155, 157
structure type 44, 45, 75, 96, 99, 100, 131–145,
147–152, 154, 155, 179, 181–184
Sunyaev-Zel’dovich eﬀect 133, 157
survey geometry 52, 70, 74, 75, 79, 83, 86, 89–92,
110, 119, 121, 122, 125, 126, 129, 135, 137, 140,
148, 151, 154, 155
survey response operator 66, 70, 74, 83, 122,
123, 140, 143, 147
symplecticity 61, 62, 74, 175
systematic uncertainty 55, 79, 82, 86, 89, 119,
126
T-web 132–138, 142, 143, 148, 150, 154, 179, 181–
185
three-point correlation function 34, 35, 37, 86,
95, 100, 103, 105, 106, 121, 135, 155
tidal eﬀects 24, 34, 126, 135, 183
tidal ﬁeld 126, 131–133, 137, 154, 156, 182, 183
tidal tensor 22, 132, 134, 136, 137, 141, 142, 147,
148, 181, 182, 184, 185
transfer function 98, 100, 101, 103, 104, 106, 112
transition probability 58–60
trispectrum 15
TSC triangular shaped cloud 170, 171, 173
two-point correlation function 2, 12–14, 31, 32,
34, 44, 83, 95, 100, 103, 105, 106, 111, 118, 121,
122, 134, 135, 155
uncertainty quantiﬁcation 50, 52, 53, 55, 63, 75,
76, 79, 80, 82, 85, 89, 91, 92, 110, 112, 117, 119,
121, 122, 124, 129, 131, 133–136, 138, 148, 155
utility function 150, 151
V-web 132, 150, 184
vector part 41, 43, 44
velocity dispersion 17, 18
velocity ﬁeld 9, 16, 18, 19, 21, 22, 24–26, 75, 80,
86, 87, 91, 120, 128, 133, 134, 155, 157, 184
velocity potential 25, 26, 96
velocity proﬁle 128
velocity shear ﬁeld 132, 184
VFF volume ﬁlling fraction 44, 45, 99, 131, 133,
135, 140, 141, 143, 145, 147, 148, 150
VIDE Void IDentiﬁcation and Examination toolkit
119, 121–124, 126, 127, 129, 155, 179–181
viscosity 18, 26, 27, 96
Vlasov equation 17, 18
Vlasov-Poisson system 17, 18, 32, 96, 110, 181
void 4, 24, 29, 38–41, 44, 45, 86, 91, 92, 96, 99, 100,
111, 117–129, 131–137, 140, 142, 145, 147–152,
154–156, 179–185
void hierarchy 1, 117, 118, 121, 128, 129, 132, 134,
180
void-in-cloud 43, 128
void-in-void 128
Voronoi tessellation 121, 122, 179–181
vorticity 19, 23–25
watershed transform 121, 180
WDM warm dark matter 157
weak gravitational lensing 118, 129, 133, 157
white noise 177

222
Glossary
Wick’s theorem 11, 14
Wiener ﬁlter 11, 75, 77
WMAP-7 30, 101
ZA Zel’dovich approximation 23–27, 29–32, 34, 35,
37, 38, 40, 41, 43, 44, 96, 98, 99, 101–105, 112,
155, 168, 177, 178, 182
ZARM Zel’dovich approximation remapped 30–32,
34, 35, 103, 104
ZOBOV 119, 121, 122, 179, 180

Bayesian large-scale structure inference and cosmic web analysis
Surveys of the cosmic large-scale structure carry opportunities for building and testing cosmological theories
about the origin and evolution of the Universe. This endeavor requires appropriate data assimilation tools, for
establishing the contact between survey catalogs and models of structure formation.
In this thesis, we present an innovative statistical approach for the ab initio simultaneous analysis of the forma-
tion history and morphology of the cosmic web: the borg algorithm infers the primordial density ﬂuctuations
and produces physical reconstructions of the dark matter distribution that underlies observed galaxies, by as-
similating the survey data into a cosmological structure formation model. The method, based on Bayesian
probability theory, provides accurate means of uncertainty quantiﬁcation.
We demonstrate the application of borg to the Sloan Digital Sky Survey data and describe the primordial and
late-time large-scale structure in the observed volume. We show how the approach has led to the ﬁrst quanti-
tative inference of the cosmological initial conditions and of the formation history of the observed structures.
We then use these results for several cosmographic projects aiming at analyzing and classifying the large-scale
structure. In particular, we build an enhanced catalog of cosmic voids probed at the level of the dark matter
distribution, deeper than with the galaxies. We present detailed probabilistic maps of the dynamic cosmic web,
and oﬀer a general solution to the problem of classifying structures in the presence of uncertainty.
The results described in this thesis constitute accurate chrono-cosmography of the inhomogeneous cosmic struc-
ture.
Inférence bayésienne et analyse des grandes structures de l’Univers
Les observations de la structure à grande échelle de l’Univers sont précieuses pour établir et tester des théories
cosmologiques sur son origine et son évolution. Cette démarche requiert des outils appropriés d’assimilation des
données, aﬁn d’établir le contact entre les catalogues de galaxies et les modèles de formation des structures.
Dans cette thèse, une nouvelle approche pour l’analyse ab initio et simultanée de la formation et de la mor-
phologie de la toile cosmique est présentée : l’algorithme borg infère les ﬂuctuations de densité primordiales et
produit des reconstructions physiques de la distribution de matière noire, en assimilant les relevés de galaxies
dans un modèle cosmologique de formation des structures. La méthode, basée sur la théorie bayésienne des
probabilités, fournit un moyen de quantiﬁer précisément les incertitudes.
On présente l’application de borg aux données du Sloan Digital Sky Survey et on décrit la structure de l’Univers
dans le volume considéré. On démontre que cette approche a mené à la première inférence quantitative des
conditions initiales et du scénario de formation des structures observées. On utilise ces résultats pour plusieurs
projets cosmographiques visant à analyser et classiﬁer la toile cosmique. En particulier, on construit un catalogue
de vides, décrits au niveau de la matière noire et non des galaxies. On présente des cartes probabilistes détaillées
de la dynamique de la toile cosmique et on propose une solution générale pour la classiﬁcation des structures
en présence d’incertitude.
Les résultats de cette thèse constituent une précise description chrono-cosmographique des inhomogénéités de
la structure cosmique.

