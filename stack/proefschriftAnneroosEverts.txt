A GEOMETRIC APPROACH TO
M U LT I - M O DAL AND MULTI- AGENT SYSTEMS
FR O M D I S T URBANCE DECOUPLING TO CONSENSUS
anneroos r.f. everts

The research for this doctoral dissertation has been carried out
at the Faculty of Mathematics and Natural Sciences, University
of Groningen, The Netherlands, within the Johann Bernoulli
Institute for Mathematics and Computer Science.
This research was supported by the Netherlands Organisa-
tion for Scientiﬁc Research (nwo) under the project CODAVI
(613.001.108).
The research reported in this dissertation is part of the research
program of the Dutch Institute of Systems and Control (DISC).
The author has successfully completed the educational pro-
gram of the Graduate School DISC.
A geometric approach to multi-modal and multi-agent systems:
From disturbance decoupling to consensus
Anneroos R.F. Everts
PhD Thesis University of Groningen
Printed by Ipskamp Printing
Cover design by Hanneke Everts
isbn 978-90-367-9270-7 (printed version)
isbn 978-90-367-9269-1 (electronic version)
ii

A geometric approach to multi-modal
and multi-agent systems
From disturbance decoupling to consensus
Proefschrift
ter verkrijging van de graad van doctor aan de
Rijksuniversiteit Groningen
op gezag van de
rector magniﬁcus prof. dr. E. Sterken
en volgens besluit van het College voor Promoties.
De openbare verdediging zal plaatsvinden op
vrijdag 2 december 2016 om 12.45 uur
door
Annerosa Roelienke Fleur Everts
geboren op 8 juni 1988
te Hoogeveen

Promotores
Prof. dr. M.K. Çamlıbel
Prof. dr. A.J. van der Schaft
Beoordelingscommissie
Prof. dr. A.M. Perdon
Prof. dr. J.M. Schumacher
Prof. dr. H.L. Trentelman
iv

C O N T E N TS
1
introduction
1
1.1
Linear multi-modal systems
1
1.2
The disturbance decoupling problem
2
1.3
The fault detection and isolation problem
5
1.4
Nonlinear consensus protocols for digraphs
6
1.5
Preliminaries and notation
7
1.5.1
Geometric control theory
7
2
disturbance decoupling for continuous piece-
wise linear bimodal systems
11
2.1
Introduction
11
2.2
Disturbance decoupled bimodal systems
13
2.3
Disturbance decoupling by state feedback
20
2.3.1
Mode-dependent state feedback
20
2.3.2
Mode-independent state feedback
22
2.4
Disturbance decoupling by dynamic feedback
23
2.4.1
Mode-dependent dynamic feedback
24
2.4.2
Mode-independent dynamic feedback
28
2.5
Subspace algorithms
30
2.5.1
Algorithm for V∗
md(H, {A1, A2}, B)
30
2.5.2
Algorithm for V∗
mi(H, {A1, A2}, B)
31
2.5.3
Algorithm for T ∗
mi(E, {A1, A2}, C)
31
2.6
Conclusions
32
3
disturbance decoupling for piecewise affine
systems
33
3.1
Introduction
33
3.2
Piecewise afﬁne systems
34
3.3
The disturbance decoupling problem
39
3.4
Necessary and sufﬁcient conditions
42
3.5
State feedback
46
3.6
Conclusions
48
4
disturbance decoupled linear complemen-
tarity systems
49
4.1
Introduction
49
4.2
Linear complementarity problem/system
50
4.3
Disturbance decoupled LCSs
51
4.4
Conclusions
58
v

contents
5
disturbance decoupled linear multi-modal
systems
59
5.1
Introduction
59
5.2
Linear multi-modal systems
60
5.3
Disturbance decoupled systems
65
5.4
Special classes of systems
70
5.4.1
Switched linear systems
70
5.4.2
Conewise linear systems
71
5.4.3
Linear complementarity systems
72
5.5
Conclusions
77
6
fault detection and isolation for bimodal
systems
79
6.1
Introduction
79
6.2
Fault detection and isolation
80
6.3
Fault detection and isolation for bimodal sys-
tems
83
6.4
Conclusions
89
7
fault detection and isolation for systems
defined over graphs
91
7.1
Introduction
91
7.2
Background material
92
7.3
Problem statement
93
7.4
Graph-theoretic conditions
95
7.5
Conclusions
101
8
consensus dynamics with arbitrary sign-pre-
serving nonlinearities
103
8.1
Introduction
103
8.2
Preliminaries and notations
104
8.3
Main results
107
8.3.1
Problem formulation
107
8.3.2
Node nonlinearity
110
8.3.3
Edge nonlinearity
116
8.3.4
Combining node and edge nonlineari-
ties
121
8.4
Conclusions
122
9
conclusions and future research
123
9.1
Disturbance decoupling for linear multi-modal
systems
123
9.2
Fault detection and isolation
125
9.3
Consensus dynamics with nonlinearities
125
vi

contents
bibliography
127
summary
135
samenvatting
137
biography
139
acknowledgements
141
vii


1
I N T R O D UCTION
Dynamical systems with nonsmooth components arise in vari-
ous settings. For example, nonsmoothness may occur due to
dry friction, impacts or backlash in mechanical systems, or due
to diode elements in electrical circuits. The governing differ-
ential equations of nonsmooth dynamical systems have right-
hand sides which are not differentiable or even discontinuous.
Consequently, the classical control theory for smooth systems
cannot be applied; a different and more careful approach is
needed. This approach includes extending differential equa-
tions to differential inclusions and adopting different solution
concepts.
In this thesis, we focus our attention on two types of non-
smooth dynamical systems. First, we study linear multi-modal
systems. These systems consist of a collection of linear systems,
each of which is active on a polyhedral region of the state
space. Although these systems exhibit linear behavior locally,
they are nonsmooth, since their vector ﬁelds lack differentia-
bility. Second, we study multi-agent systems with a nonlinear
communication protocol. The nonlinear functions in these sys-
tems do not have the property that they are locally linear, but
they do satisfy a property that we call sign-preservation.
In the rest of this chapter, we have a closer look at both
types of nonsmooth dynamical systems and we introduce the
problems that are studied in this thesis for these systems.
1.1
linear multi-modal systems
Linear multi-modal systems form a class of hybrid systems;
they are a combination of continuous-time linear systems, the
modes, together with the discrete dynamics of switching be-
tween these modes. In this thesis, we study two general classes
of linear multi-modal systems.
First, we consider continuous piecewise afﬁne systems. The
state space of a piecewise afﬁne system is divided into solid
polyhedral regions, on each of which a different linear or afﬁne
system is active. We call the regions with their corresponding
linear systems the modes. Switching between different modes
1

introduction
of a piecewise afﬁne system is state-dependent: if the state
lies in a certain region, then the corresponding linear or afﬁne
system is active at that moment. The resulting vector ﬁeld is not
differentiable, but we do assume continuity of the right-hand
side of the governing differential equations. Piecewise afﬁne
systems can be used to approximate nonlinear systems, but
they can also appear naturally, for example in systems that deal
with friction.
Second, we generalize piecewise linear systems to linear
multi-modal systems for which the polyhedral regions may
overlap and do not have to cover the full state space. As a
consequence, we have to replace the differential equations by
differential inclusions. Examples of such linear multi-modal
systems are switched linear systems, conewise linear systems,
and linear complementarity systems.
In this thesis, we study two geometric control theory prob-
lems for linear multi-modal systems, namely the disturbance
decoupling problem and the fault detection and isolation prob-
lem.
1.2
the disturbance decoupling problem
Annihilating or reducing the effects of disturbances is of ma-
jor importance in many real-life control problems. Designing
feedback laws that decouple the disturbances from a certain
to-be-controlled output constitutes the well-known disturbance
decoupling problem. An input/state/output system is called
disturbance decoupled if for each ﬁxed initial condition and zero
input, the output corresponding to one disturbance is exactly
the same as the output corresponding to another disturbance.
The disturbance decoupling problem amounts to ﬁnding a
feedback law that renders the system disturbance decoupled
by eliminating the effect of disturbances on the output. The
investigation of this problem for linear and (smooth) nonlinear
systems has been the starting point for the development of
geometric control theory [Basile and Marro, 1969a,b; Wonham
and Morse, 1970]. For both linear and (smooth) nonlinear sys-
tems, geometric control theory has been proven to be very
efﬁcient in solving various control problems, including the
disturbance decoupling problem (see e.g. [Wonham, 1985; Ni-
jmeijer and van der Schaft, 1990; Basile and Marro, 1992; Isidori,
1995; Trentelman et al., 2001]). In this thesis, we use tools from
geometric control theory to study the disturbance decoupling
2

1.2 the disturbance decoupling problem
problem for both piecewise afﬁne systems and the more general
linear multi-modal systems.
So far, in the context of hybrid dynamical systems, the results
on the disturbance decoupling problem are limited to jumping
hybrid systems [Conte et al., 2015] and switched linear systems
[Conte et al., 2014; Otsuka, 2010, 2011, 2015; Yurtseven et al.,
2012; Zattoni and Marro, 2013; Zattoni et al., 2016]. The ma-
jor difference between piecewise afﬁne systems and switched
linear systems is the nature of the switching behavior. For piece-
wise afﬁne systems the switching behavior is state-dependent
whereas it is state-independent for switched linear systems.
For the case of state-independent switching, the solution of
the disturbance decoupling problem can be obtained by fol-
lowing mainly the footsteps of the (non-switching) linear case.
An interesting consequence of the state-independent switch-
ing is that the set of reachable states under the inﬂuence of
disturbances is a subspace. This allows one to generalize the
so-called controlled invariant subspaces of linear systems to
switched linear systems. Such a generalization leads to elegant
necessary and sufﬁcient conditions [Otsuka, 2010; Yurtseven
et al., 2012] for a switched linear system to be disturbance de-
coupled. In the same papers, disturbance decoupling problems
by different feedback schemes have also been solved based on
these necessary and sufﬁcient conditions.
However, a similar approach breaks down in the case of
state-dependent switching as the set of reachable states under
the inﬂuence of disturbances is not anymore a subspace, not
even a convex set in general. As such, neither the results nor
the approach adopted for the state-independent case can be
applied to the state-dependent switching case.
In this thesis, we develop a new approach that takes into
account the state-dependent switching behavior of piecewise
afﬁne systems. In Chapter 2, based on the conference paper [Ev-
erts and Camlibel, 2014b], we start by studying a simple class
of piecewise afﬁne systems, namely bimodal linear systems.
Our approach provides easily veriﬁable geometric necessary
and sufﬁcient conditions for these systems to be disturbance de-
coupled. Based on these conditions, we study the disturbance
decoupling problem for both state feedback controllers and
dynamic feedback controllers. For both feedback schemes, we
consider mode-independent and mode-dependent controllers,
and provide necessary and sufﬁcient conditions for the solvabil-
ity of the disturbance decoupling problem. These conditions
amount to checking certain subspace inclusions very much anal-
3

introduction
ogous to linear systems and linear state-independent switching
systems.
In Chapter 3, we study the disturbance decoupling problem
for general continuous piecewise afﬁne systems, based on the
conference paper [Everts and Camlibel, 2014a]. We provide a set
of necessary conditions and a set of sufﬁcient conditions under
which such a system is disturbance decoupled. Although these
conditions do not coincide in general, we point out some special
cases in which they do coincide. Furthermore, we present con-
ditions for the existence of mode-independent static feedback
controllers that render the closed-loop system disturbance de-
coupled. All the conditions we present are geometric in nature
and easily veriﬁable.
Next, we consider a particular linear complementarity sys-
tem and study when such a system is disturbance decoupled
in Chapter 4, based on the book chapter [Everts and Cam-
libel, 2015]. Linear complementarity systems are nonsmooth
dynamical systems that are obtained by taking a standard linear
input/output system and imposing certain complementarity
relations on a number of input/output pairs at each time in-
stant. A wealth of examples, from various areas of engineering
as well as operations research, of linear complementarity sys-
tems can be found in [Camlibel et al., 2004; Schumacher, 2004;
van der Schaft and Schumacher, 2000; Heemels and Brogliato,
2003]. For the work on the analysis of linear complementarity
systems, we refer to [Camlibel et al., 2003; Heemels et al., 2002;
Camlibel et al., 2002; van der Schaft and Schumacher, 1996;
Camlibel, 2007; van der Schaft and Schumacher, 1998; Heemels
et al., 2000]. Particular linear complementarity systems can be
written as linear multi-modal systems, namely those of index
zero [Camlibel, 2001, Chapter 2]. Different from the piecewise
afﬁne systems treated before, the polyhedral regions on which
the modes are active, can now be non-solid, and together they
do not cover the full state space. It turns out that the resulting
linear subsystems share a certain geometric structure, which
we exploit to ﬁnd necessary and sufﬁcient conditions for dis-
turbance decoupledness that are crisp and easily checkable.
Finally, in Chapter 5, we study the disturbance decoupling
problem for general linear multi-modal systems. We recover
almost all results from Chapters 2, 3 and 4, as well as known
results for a particular class of switched linear systems. More-
over, this general approach gives us the possibility to treat the
disturbance decoupling problem for another class of linear com-
plementarity systems, namely linear passive-like complemen-
4

1.3 the fault detection and isolation problem
tarity systems [Camlibel, 2001; Camlibel et al., 2002; Camlibel
and Schumacher, 2016]. We ﬁnd novel necessary and sufﬁcient
conditions for this kind of linear complementarity systems to
be disturbance decoupled. Chapter 5 is based on the journal
paper [Everts and Camlibel, 2016].
1.3
the fault detection and isolation problem
The second geometric control problem that we consider in
this thesis is the fault detection and isolation problem, which
we ﬁrst study for bimodal piecewise linear systems. Given a
system that is prone to faults, the fault detection and isolation
problem amounts to ﬁnding an observer that detects when
a faults occurs. Moreover, if a fault occurs then the observer
should identify what kind of fault it is. Examples of faults
are the complete failure of an actuator, a biased actuator, or
changes in the system dynamics.
Fault detection and isolation (FDI) is an active area of re-
search in control theory, due to the essential requirement of
high reliability for many applications of control systems. Var-
ious types of FDI techniques have been proposed for linear
systems and for some classes of nonlinear ones. There is a large
number of contributions in this area, and consequently we di-
rect the interested reader to the comprehensive survey papers
[Frank, 1990; Hwang et al., 2010; Isermann, 2006; Isermann and
Bailé, 1997]. On the other hand, research on FDI for hybrid
and switched systems, and in particular for piecewise linear
systems, has been less intensive and fruitful (see [Balluchi et al.,
2002; Cocquempot et al., 2004; Narasimhan et al., 2000; Wang
et al., 2009]).
In Chapter 6 of this thesis, based on the paper [Everts et al.,
2016], we use the classical geometric control theory framework
(see [Basile and Marro, 1992; Wonham, 1985]) to investigate
the problem of fault detection and isolation for bimodal linear
systems. Our approach is inspired by the ideas pioneered in
[Massoumnia, 1986a], where several formulations of the fault
detection and isolation problem were stated and solved in
geometric terms for linear systems. We give a sufﬁcient condi-
tion for solving the fault detection and isolation problem for
bimodal linear systems.
As a by-product, and before we continue with the second
class of nonsmooth dynamical systems, we consider the FDI
problem for a class of linear dynamical systems deﬁned over
5

introduction
an undirected graph. Two disjoint sets of agents are identiﬁed
in the network: the faultable agents, which are prone to failure,
and the observer agents, whose output is measurable. Fault
detection is performed by an unknown input observer, and
stated in the geometric language of [Massoumnia, 1986a], i.e.
output separability of fault subspaces. In Chapter 7, which is
based on the paper [Rapisarda et al., 2015], we present a charac-
terization of the smallest conditioned invariant subspaces that
are generated by the faults. This characterization is exploited
in order to give graph-theoretical conditions guaranteeing out-
put separability in terms of distances between faultable agents
and observer ones. In addition, we study the case where two
faultable vertices share exactly the same neighbors in order to
present a condition under which fault detectability fails.
In this thesis, we make extensive use of geometric control
theory for both the disturbance decoupling problem and the
FDI problem. Although the resulting conditions often are some-
what similar to those of the linear case, the methods to obtain
these conditions are fundamentally different, since we have to
take state-dependent switching into account.
As a last subject in this thesis, we study a truly nonlinear
system, that does not exhibit linear behavior locally.
1.4
nonlinear consensus protocols for digraphs
The second class of nonsmooth dynamical systems that we con-
sider in this thesis arises in the context of nonlinear consensus
protocols. We consider a network of agents that communicate
according to a ﬁxed communication topology, represented by a
directed graph containing a directed spanning tree. For the well-
known linear consensus protocol these graph-theoretical are
known to be a sufﬁcient and necessary condition for reaching
state consensus. In Chapter 8 of this thesis, we generalize this
result and study the consensus problem for a general nonlinear
consensus protocol. A nonlinear consensus protocol may arise
due to the nature of the controller [Jafarian and De Persis, 2015;
Saber and Murray, 2003], or may describe the physical cou-
pling existing in the network [Bürger et al., 2014; Monshizadeh
and De Persis, 2015]. The nonlinear functions in our model
are assumed to be sign-preserving and are allowed to have
possible discontinuities. Examples of such functions are the
saturation function and the sign function. To deal with the pos-
sible discontinuities, we will need to employ Filippov solutions
6

1.5 preliminaries and notation
and replace the differential equations by differential inclusions
[Filippov, 1988; Smirnov, 2002; Aubin and Cellina, 1984]. In
this framework, we ﬁrst study the case that these nonlinearities
happen at the level of the nodes. Next, we consider the case
that we have nonlinearities at the edges. Finally, we combine
these results. Chapter 8 is based on the paper [Wei et al., 2016].
The last section of this chapter is devoted to discussing some
notation and notions in geometric control theory, which we use
throughout this thesis.
1.5
preliminaries and notation
First, we ﬁx some notation and deﬁnitions that we use through-
out this thesis. Let R denote the set of real numbers. For a
vector v we denote its transpose by vT and its dimension by nv.
For two vectors v and w, we let col(v, w) denote the column
vector that is obtained by stacking v and w. We denote the set
{1, 2, . . . , m} by Im. For a subset α of Im, αc denotes the subset
Im \ α. A cone is a subset of a vector space that is closed under
multiplication by positive scalars.
Let S be a set in Rn. The Minkowski sum of two subsets S1
and S2 of S is given by
S1 + S2 = {x + y | x ∈S1, y ∈S2}.
The afﬁne hull of S is the smallest afﬁne set containing S in Rn
and is denoted by aff(S). The relative interior of S is deﬁned as
rint(S) := {x ∈S : ∃ϵ > 0, Nϵ(x) ∩aff(S) ⊆S},
where Nϵ(x) is an ϵ-neighborhood of x. We call the set S solid if
the afﬁne hull of rint(S) is n-dimensional. With S⊥we denote
the orthogonal complement of S with respect to the inner
product vTw for v, w ∈Rn.
1.5.1
Geometric control theory
Geometric control theory, illustrated in depth in e.g. [Basile and
Marro, 1992] and [Trentelman et al., 2001], plays an important
role in this thesis. The rest of this section quickly summarizes
some deﬁnitions and results from geometric control theory that
are relevant to this thesis.
7

introduction
Consider the linear, time-invariant system Σ = Σ(A, B, C, D)
given by
˙x(t) = Ax(t) + Bu(t)
(1.1a)
y(t) = Cx(t) + Du(t),
(1.1b)
where x ∈Rnx is the state, u ∈Rnu is the input, y ∈Rny is
the output, and A, B, C and D are matrices of appropriate
dimensions.
A subspace V ⊆Rnx is called A-invariant if V satisﬁes AV ⊆
V. The controllable subspace is the smallest A-invariant subspace
containing im B. It is denoted by ⟨A | im B⟩and satisﬁes
⟨A | im B⟩= im B + im AB + · · · + im Anx−1B.
(1.2)
Note that for any matrix K ∈Rnu×nx we have
⟨A + BK | im B⟩= ⟨A | im B⟩.
(1.3)
A subspace V ⊆Rnx is called controlled invariant with respect
to A and B, or (A, B)-invariant in short, if there exists a matrix
F such that V is (A + BF)-invariant. Such a matrix F is called a
friend of V. Equivalently, a subspace is controlled invariant if
AV ⊆V + im B.
(1.4)
From (1.4) it follows that the sum of two controlled invariant
subspaces is again controlled invariant.
A subspace V ⊆Rnx is called an output nulling controlled
invariant subspace of Σ if
A
C

V ⊆
 V × {0}
 + im
B
D

.
The weakly unobservable subspace of Σ is the largest (with respect
to the subspace inclusion) output nulling controlled invariant
subspace and will be denoted by V∗(Σ). In the case that D = 0,
we sometimes write V∗(C, A, B) to denote V∗(Σ), which is then
the largest (A, B)-invariant subspace contained in ker C.
A subspace T ⊆Rnx is called conditioned invariant with
respect to C and A, or (C, A)-invariant in short, if
A(T ∩ker C) ⊆T .
This condition is equivalent to the existence of a matrix K ∈
Rnx×ny such that T is (A + KC)-invariant, i.e.
(A + KC)T ⊆T .
8

1.5 preliminaries and notation
We call such a matrix K a friend of T . The intersection of two
conditioned invariant subspaces is again conditioned invariant.
We call a subspace T ⊆Rnx input containing conditioned
invariant if

A
B
  (T × Rnu) ∩ker

C
D
 ⊆T .
It is well-known that a subspace T is an input containing
conditioned invariant subspace if and only if there exists a
matrix L ∈Rnx×ny such that
(A + LC)T ⊆T
and
im (B + LD) ⊆T .
(1.5)
The strongly reachable subspace of Σ is deﬁned to be the small-
est (with respect to the subspace inclusion) input containing
conditioned invariant subspace and will be denoted by T ∗(Σ).
Let K and L be m × n and n × p matrices, respectively. Denote
the system Σ(A + BK + LC + LDK, B + LD, C + DK, D) by ΣK,L.
Then we have the following equality:
T ∗(ΣK,L) = T ∗(Σ).
(1.6)
It follows from (1.5) with the choice of L = 0 that the con-
trollable subspace is an input containing conditioned invariant
subspace. Hence, we have
T ∗(Σ) ⊆⟨A | im B⟩.
(1.7)
In the case that D = 0, we sometimes write T ∗(B, C, A)
to denote T ∗(Σ), which is then the smallest (C, A)-invariant
subspace containing im B. It can be shown that for a friend
K of T ∗(B, C, A), we have T ∗(B, C, A) = ⟨A + KC | im B⟩.
The subspace T ∗(B, C, A) can be computed by the following
subspace algorithm (see e.g. Algorithm 4.1.1 p. 203 of [Basile
and Marro, 1992]):
T 0 := im B
(1.8a)
T k := im B + A

T k−1 ∩ker C

(1.8b)
for k ⩾1. As these subspaces are nested, that is
T k ⊆T k+1,
it follows that there exists an integer ℓsuch that 0 ⩽ℓ⩽n and
T ℓ= T ℓ+1.
9

introduction
It is well-known that
T ∗(B, C, A) = T ℓ.
A pair of subspaces (T , V) is called a (C, A, B)-pair if T is
(C, A)-invariant, V is (A, B)-invariant and T ⊆V. If (T , V)
is a (C, A, B)-pair, then there is a linear map N : Rny →Rnu
such that (A + BNC)T ⊆V (see e.g. [Trentelman et al., 2001,
Lemma 6.3]).
It is well-known that the transfer matrix D + C(sI −A)−1B
is right-invertible as a rational matrix if and only if
V∗(Σ) + T ∗(Σ) = Rnx and

C
D

is of full row rank.
Straightforward linear algebra arguments (see e.g. [Kaba, 2001,
Ch. 2, Thm. 4] and [Trentelman et al., 2001, Thm. 8.27]) show
that these conditions are equivalent to
im D + CT ∗(Σ) = Rny.
(1.9)
10

2
D I S T U R BANCE DECOUPLING FOR
C O N T I N UOUS PIECEWISE LINEAR BIMODAL
S Y S T E M S
abstract:
In this chapter we tackle the disturbance decoupling problem for
continuous bimodal piecewise linear systems. After establishing necessary and sufﬁcient
geometric conditions for such a system to be disturbance decoupled, we study state
feedback and dynamic feedback controllers, both mode-dependent and mode-independent.
For these feedback schemes, we provide necessary and sufﬁcient conditions for the
solvability of the disturbance decoupling problem. Also, we provide subspace algorithms
in order to verify the presented conditions. This chapter is based on the conference
paper [Everts and Camlibel, 2014b].
2.1
introduction
One of the main problems that will be addressed in this the-
sis is the disturbance decoupling problem for piecewise afﬁne
systems and other linear multi-modal systems. As introduced
in Chapter 1, the disturbance decoupling problem amounts
to eliminating, by means of feedback, the effect of the distur-
bance from the output of a given input/state/output dynamical
system. In this chapter, we study the disturbance decoupling
problem for a simple class of piecewise afﬁne systems, namely
piecewise linear systems with only two modes.
In the context of hybrid dynamical systems, the results on the
disturbance decoupling problem are limited to jumping hybrid
systems [Conte et al., 2015] and switched linear systems [Conte
et al., 2014; Otsuka, 2010, 2011, 2015; Yurtseven et al., 2012;
Zattoni and Marro, 2013; Zattoni et al., 2016]. In this chapter, we
focus on a particular class of hybrid systems exhibiting state-
dependent switchings, namely continuous piecewise linear
bimodal systems. The main goal of this chapter is to provide
necessary and sufﬁcient conditions for the solvability of the
disturbance decoupling problem for this class of systems.
The main difference, in the context of disturbance decoupling,
between the state-independent and state-dependent switchings
stems from the different nature of the set of reachable states
by the disturbances for these two cases. In the case of linear
state-independent switching systems, the set of states that can
11

2. disturbance decoupling for bimodal systems
be reached from the origin by the disturbances constitute a
subspace of the whole state space. In [Otsuka, 2010; Yurtseven
et al., 2012], this leads to the solution of the disturbance decou-
pling problem by following the footsteps of the classical results
for the linear systems. However, the same set of states is, in
general, neither a subspace nor even a convex set for the case
of state-dependent switchings. As such, the ideas employed
in the context of linear state-independent switching systems
cannot be indiscriminately applied to linear state-dependent
switching systems.
To overcome this obstacle, we ﬁrst investigate under which
conditions a given bimodal system is disturbance decoupled. It
turns out that one can still provide easily veriﬁable geometric
necessary and sufﬁcient conditions for disturbance decoupling
(see Theorem 2.3), even though the set of reachable states does
not, in general, enjoy nice geometric properties such as being
convex. Based on these geometric necessary and sufﬁcient con-
ditions, we study the disturbance decoupling problem for both
state feedback controllers and dynamic feedback controllers.
For both feedback schemes, we consider mode-independent
and mode-dependent controllers, and provide necessary and
sufﬁcient conditions for the solvability of the disturbance de-
coupling problem. These conditions amount to checking certain
subspace inclusions very much analogous to linear systems
and linear state-independent switching systems. To verify these
conditions, we also propose subspace algorithms.
In the following section, we introduce the class of continuous
piecewise linear bimodal systems as well as the disturbance
decoupling problem for this class of systems. This is followed
by a complete characterization of the disturbance decoupled
(open-loop) bimodal systems. Based on this characterization,
we ﬁrst turn our attention to the disturbance decoupling prob-
lem by state feedback in Section 2.3. Subsequently, we discuss
the disturbance decoupling problem by dynamic feedback in
Section 2.4. In order to verify the conditions presented in these
sections, we provide subspace algorithms in Section 2.5. Finally,
the chapter closes with conclusions in Section 2.6.
12

2.2 disturbance decoupled bimodal systems
2.2
disturbance decoupled bimodal systems
We consider bimodal systems of the form
˙x(t) =
(
A1x(t) + Ed(t)
if cTx(t) ⩽0,
A2x(t) + Ed(t)
if cTx(t) ⩾0,
(2.1a)
z(t) = Hx(t),
(2.1b)
where x ∈Rnx is the state, d ∈Rnd is the unknown disturbance,
z ∈Rnz is the output, and the matrices A1, A2, E, H and the
vector c are of appropriate sizes. Throughout this chapter we
assume that the right-hand side of (2.1a) is continuous in x. In
other words, the implication
cTx = 0
⇒
A1x = A2x
holds. Equivalently, we have
A1 −A2 = hcT
(2.2)
for a vector h ∈Rnx. As such, the right-hand side of (2.1a)
is Lipschitz continuous in the variable x. Therefore, for each
initial condition x0 and locally integrable disturbance d there
exists a unique absolutely continuous function xx0,d(t) satis-
fying xx0,d(0) = x0 and (2.1a) for almost all t. We denote the
corresponding output of the system by zx0,d(t).
Example 2.1 As an example, consider the bimodal system
˙x(t) =









3
2
0
1

x(t) +
 1
−1

d(t)
if

1
1

x(t) ⩽0,
4
3
2
3

x(t) +
 1
−1

d(t)
if

1
1

x(t) ⩾0,
z(t) =

1
1

x(t).
We use the following deﬁnition of disturbance decoupled-
ness.
Deﬁnition 2.2 A continuous piecewise linear bimodal system
of the form (2.1) is disturbance decoupled if
zx0,d1(t) = zx0,d2(t),
∀t ⩾0
for all initial states x0 ∈Rnx and all locally integrable distur-
bances d1 and d2.
13

2. disturbance decoupling for bimodal systems
In order to ﬁnd necessary and sufﬁcient conditions for a
bimodal system to be disturbance decoupled, we deﬁne the set
R(x0, T) := {xx0,d(T) | d is locally integrable}
for each initial state x0 ∈Rnx and T ⩾0. It follows immediately
that system (2.1) is disturbance decoupled if and only if for
every x0 ∈Rnx and T ⩾0 the difference between any two
elements in R(x0, T) is in the kernel of H, or equivalently,
[
T⩾0
[
x0∈Rnx
 R(x0, T) + (−R(x0, T))
 ⊆ker H.
(2.3)
Neither the set R(x0, T) nor R(x0, T) + (−R(x0, T)) is neces-
sarily convex in general. As such, condition (2.3) is rather hard
to check. However, by making use of controllable subspaces,
as deﬁned in equation (1.2), we can provide an equivalent
geometric condition which is easier to verify.
Theorem 2.3 The system (2.1) is disturbance decoupled if and only
if
⟨A1 | im E⟩+ ⟨A2 | im E⟩⊆ker H.
(2.4)
Before we give a proof of Theorem 2.3, we state and prove
the following three auxiliary lemmas.
Lemma 2.4 Let A1 and A2 be two square matrices such that A1 −
A2 = hcT. Then the rational vector cT(sI −A1)−1E is identically
zero if and only if so is cT(sI −A2)−1E.
Proof. We use the well-known identity
(sI −X)−1 −(sI −Y)−1 = (sI −X)−1(X −Y)(sI −Y)−1,
with X = A1 and Y = A2. By premultiplying both sides by cT,
post-multiplying by E, and using A1 −A2 = hcT we get
cT(sI −A1)−1E −cT(sI −A2)−1E =
cT(sI −A1)−1hcT(sI −A2)−1E.
Hence, if cT(sI −A2)−1E is identically zero, then so is cT(sI −
A1)−1E. By symmetry, the converse also holds.
■
14

2.2 disturbance decoupled bimodal systems
Lemma 2.5 Let A1 and A2 be two square matrices such that A1 −
A2 = hcT. Then the subspace ⟨A1 | im E⟩+ ⟨A2 | im E⟩is the
smallest subspace containing im E that is invariant under both A1
and A2. Furthermore, if cT(sI −A1)−1E is not identically zero, then
⟨A1 | im E⟩+ ⟨A2 | im E⟩= ⟨A1 | im

h
E
⟩.
(2.5)
Proof. Let V = ⟨A1 | im E⟩+ ⟨A2 | im E⟩and U = ⟨A1 |
im

h
E
⟩. The subspace U contains im h and is invariant un-
der A1, hence it is also invariant under A2 = A1 −hcT. Since
U contains im E and ⟨Ai | im E⟩is the smallest Ai-invariant
subspace containing im E, we have ⟨Ai | im E⟩⊆U for i = 1, 2.
Hence, the inclusion V ⊆U follows.
Suppose that
cT(sI −A1)−1E =
∞
∑
k=0
1
sk+1 cTAk
1E
is not identically zero, and let p be the smallest non-negative
integer such that cTAp
1E ̸= 0. From equation (1.2) it follows
that for any element y ∈V⊥it holds that
yTAk
1E = yTAk
2E = 0,
∀k ⩾0.
In particular, by choosing k = p + 1 we obtain
0 = yTAp+1
2
E = yT(A1 −hcT)p+1E = −yThcTAp
1E,
where we use that cTAk
1E = 0 for 0 ⩽k ⩽p −1. Since cTAp
1E is
nonzero, this implies that yTh = 0. Hence, we get h ∈(V⊥)⊥=
V. Consequently, for all v1 ∈⟨A1 | im E⟩and v2 ∈⟨A2 | im E⟩
we have A1(v1 + v2) = A1v1 + A2v2 + hcTv2 ∈V. As such, V
is A1-invariant. Furthermore, V contains both im h and im E.
It follows that U ⊆V, since U is the smallest A1-invariant
subspace containing im h and im E. Hence, (2.5) holds. Since U
is invariant under both A1 and A2, so is the subspace V.
In the case that cT(sI −A1)−1E is identically zero, we have
cTAk
1E = 0 for all integers k ⩾0. We claim that Ak
1E = Ak
2E
for all k ⩾0. To prove this claim, we employ mathematical
induction on k. It clearly holds for k = 0. Suppose that Ak
1E =
Ak
2E holds for k = 0, 1, . . . , ℓ, then
Aℓ+1
1
E = A1Aℓ
1E = (A2 + hcT)Aℓ
1E = A2Aℓ
1E = Aℓ+1
2
E.
Hence, we have ⟨A1 | im E⟩= ⟨A2 | im E⟩= V. Consequently,
also in this case V is invariant under both A1 and A2.
15

2. disturbance decoupling for bimodal systems
Since any subspace that contains im E and is invariant under
A1 and A2 must contain both ⟨A1 | im E⟩and ⟨A2 | im E⟩, we
see that V is the smallest of such subspaces.
■
Lemma 2.6 If cT(sI −A1)−1E is identically zero, then for all ini-
tial states x0 ∈Rn and integrable disturbances d1 and d2 we have
cTxx0,d1(t) = cTxx0,d2(t) for all t ⩾0.
Proof. Let V = ⟨A1 | im E⟩+ ⟨A2 | im E⟩. It follows from
Lemma 2.4 that cTAk
1E = cTAk
2E = 0 for k ⩾0. Hence, we get
V ⊆ker cT. By Lemma 2.5, V is invariant under both A1 and
A2. Let v1, v2, . . . , vℓbe a basis for V, and extend this to a basis
v1, v2, . . . , vnx for Rnx. Let S = [v1 v2 . . . vnx], then the basis
transformation ξ = S−1x results in the system
˙ξ(t) =
( ˜A1ξ(t) + ˜Ed(t)
if ˜cTξ(t) ⩽0,
˜A2ξ(t) + ˜Ed(t)
if ˜cTξ(t) ⩾0.
Decompose ξ as ξ = col(ξ1, ξ2), where ξ1 contains the ﬁrst ℓ
entries of ξ. Since im E ⊆V and V ⊆ker cT, we see that the
matrices ˜A1, ˜A2, ˜E and ˜cT are of the form
˜A1 =
A1
11
A1
12
0
A1
22

,
˜A2 =
A2
11
A2
12
0
A2
22

,
˜E =
E1
0

,
˜cT =

0
cT
2

.
In particular, ξ2 satisﬁes
˙ξ2 =
(
A1
22ξ2
if cT
2 ξ2 ⩽0,
A2
22ξ2
if cT
2 ξ2 ⩾0.
Note that ξ2 does not depend on the disturbance d. Therefore,
the value of cTx = ˜cTξ = cT
2 ξ2 does not depend on the distur-
bance. Hence, we see that cTxx0,d1(t) = cTxx0,d2(t) for all t ⩾0,
initial conditions x0 and integrable disturbances d1, d2.
■
Now we are in a position to give a proof of Theorem 2.3.
Proof of Theorem 2.3. Necessity: Suppose that the system (2.1)
is disturbance decoupled. Let x0 be such that cTx0 < 0 and
take d1(t) = d ∈Rnd a constant vector, and d2(t) = 0. Let
xi(t) = xx0,di(t) for i = 1, 2 denote the state trajectories of the
16

2.2 disturbance decoupled bimodal systems
system (2.1) corresponding to the initial state x0 and distur-
bances di, and let zi(t) = Hxi(t) denote their outputs. Since
x1 and x2 are continuous, there exists an ε > 0 such that
cTxi(t) < 0 for all t ∈(0, ε) and i = 1, 2. This means that for
t ∈(0, ε) we have
˙xi(t) = A1xi(t) + Edi(t),
i = 1, 2.
Since the system (2.1) is disturbance decoupled, the outputs
satisfy z1(t) = z2(t) for t ⩾0. Therefore, we have
Hx1(t) = Hx2(t),
t ⩾0.
Note that d1(t) and d2(t) are both taken to be constant, so we
can differentiate both sides k times, resulting in
HAk
1x1(t) + HAk−1
1
Ed = HAk
1x2(t),
t ∈(0, ε),
k ⩾1.
Taking the limit as t ↓0 and using x1(0) = x2(0) gives us
HAk
1Ed = 0,
k ⩾0.
Since this holds for every vector d ∈Rq, we can conclude that
HAk
1E = 0 for all k ⩾0. By choosing x0 such that cTx0 > 0
and employing similar arguments, we obtain HAk
2E = 0 for all
k ⩾0. Consequently, (2.4) holds.
Sufﬁciency: Let V = ⟨A1 | im E⟩+ ⟨A2 | im E⟩. In view of
(2.3), it sufﬁces to show that R(x0, T) −R(x0, T) ⊆V, or equiv-
alently V⊥⊆(R(x0, T) −R(x0, T))⊥for all x0 and T ⩾0.
Let x0 be an initial state and d1, d2 two disturbances. Also,
let xi(t) = xx0,di(t) for i = 1, 2 denote the two corresponding
trajectories of the system (2.1). Let y be an element of V⊥=
⟨A1 | im E⟩⊥∩⟨A2 | im E⟩⊥. Then yTAk
1E = 0 and yTAk
2E = 0
for all k ⩾0. In the case that cT(sI −A1)−1E is not identically
zero, we know from Lemma 2.5 that im h ⊆V. As such, we
have yTh = 0. Together with yTE = 0, this yields
yT ˙xi(t) =
(
yTA1xi(t)
if cTxi(t) ⩽0
yTA2xi(t)
if cTxi(t) ⩾0
= yTA1xi(t),
for t ⩾0 and i = 1, 2. In the case that cT(sI −A1)−1E is
identically zero, it follows from Lemma 2.6 that cTx1(t) =
17

2. disturbance decoupling for bimodal systems
cTx2(t) for all t ⩾0. Hence, we have hcT(x1(t) −x2(t)) = 0,
which implies that
yT( ˙x1(t) −˙x2(t)) =
(
yTA1(x1(t) −x2(t)),
cTx1(t) ⩽0
yTA2(x1(t) −x2(t)),
cTx1(t) ⩾0
= yTA1(x1(t) −x2(t)),
for t ⩾0.
In conclusion, in both cases we have
yT( ˙x1(t) −˙x2(t)) = yTA1(x1(t) −x2(t)),
(2.6)
for all y ∈V⊥and for almost all t ⩾0. To study equation (2.6),
we ﬁrst suppose that λ is an eigenvalue of AT
1 and y ∈V⊥
satisﬁes
(AT
1 −λI)ky = 0
(2.7)
for some integer k ⩾1. The vector y generates a Jordan chain
y1, y2, . . . , yk for the eigenvalue λ as follows:
yj = (AT
1 −λI)k−jy
for
1 ⩽j ⩽k.
Since yk = y ∈V⊥and V⊥is AT
1 -invariant, we see that yj ∈V⊥
for all j = 1, 2, . . . , k. We will prove by mathematical induction
on j that
yT
j (x1(t) −x2(t)) = 0
(2.8)
for j = 1, 2, . . . , k and all t ⩾0. For j = 1, we have AT
1 y1 = λy1.
Hence, it follows from (2.6) that
d
dt[yT
1 (x1(t) −x2(t))] = λyT
1 (x1(t) −x2(t)),
for almost all t ⩾0. This results in
yT
1 (x1(t) −x2(t)) = eλtyT
1 (x1(0) −x2(0)) = 0,
since x1(0) = x2(0). Now, assume that (2.8) holds for j =
1, 2, . . . , ℓfor some integer ℓwith 1 ⩽ℓ< k. By using (2.6) and
AT
1 yℓ+1 = λyℓ+1 + yℓ, we obtain
d
dt[yT
ℓ+1(x1(t) −x2(t))] = yT
ℓ+1A1(x1(t) −x2(t))
= (λyℓ+1 + yℓ)T(x1(t) −x2(t))
= λyT
ℓ+1(x1(t) −x2(t)),
18

2.2 disturbance decoupled bimodal systems
for almost all t ⩾0. Therefore, we have
yT
ℓ+1(x1(t) −x2(t)) = eλtyT
ℓ+1(x1(0) −x2(0)) = 0.
This completes the proof of (2.8). Clearly, (2.8) implies that
yj ∈(R(x0, T) −R(x0, T))⊥for all j, x0 and T ⩾0.
To generalize this result to all y ∈V⊥, we deﬁne M ⊆Cn
to be the subspace M = V⊥⊕iV⊥. Consider AT
1 as a linear
map from Cn to Cn. Since V⊥is AT
1 -invariant, so is M. Let
λ1, λ2, . . . , λr be the distinct eigenvalues of AT
1 and deﬁne the
corresponding root subspaces Rλi for i = 1, 2, . . . , r as
Rλi(AT
1 ) := ker(AT
1 −λiI)pi,
where pi is the geometric multiplicity of the eigenvalue λi. By
[Gohberg et al., 2006, Thm. 2.1.5], we can decompose M as
follows:
M =
r
M
i=1
(M ∩Rλi(AT
1 )).
For ﬁxed x0 and T ⩾0, we can consider R(x0, T) −R(x0, T)
as a subset of Cn. Since each root subspace Rλi is spanned
by a Jordan chain, it follows from the preceding argument on
Jordan chains that M ⊆(R(x0, T) −R(x0, T))⊥. Hence, V⊥⊆
(R(x0, T) −R(x0, T))⊥for all x0 and T ⩾0, which completes
the proof.
■
For later use in the next two sections, and to relate our result
to similar results for switched linear systems, we state the
following corollary, which follows from combining Theorem
2.3 with Lemma 2.5.
Corollary 2.7 The system (2.1) is disturbance decoupled if and only
if there exists a subspace V ⊆Rnx that is invariant under both A1
and A2 such that im E ⊆V ⊆ker H.
Example 2.8 We revisit Example 2.1. For this system, notice
that A1E = E and A2E = E, which implies that ⟨A1 | im E⟩=
⟨A2 | im E⟩= im E. Since HE = 0, we see that this bimodal
system satisﬁes (2.4), and hence it is disturbance decoupled.
Remark 2.9 In [Yurtseven et al., 2012], the disturbance decou-
pling problem for switched linear systems is studied. The re-
sults presented in [Yurtseven et al., 2012, Thm. 3.7 and 3.9]
19

2. disturbance decoupling for bimodal systems
provide sufﬁcient conditions for the disturbance decoupling
of piecewise linear systems. Applied to the bimodal system
(2.1), these conditions boil down to the conditions in Corollary
2.7, but with the extra condition that the subspace V and the
matrices A1 and A2 should satisfy im(A1 −A2) = im hcT ⊆V.
This last condition implies that h ∈V, which is not necessary
in the case that cT(sI −A1)−1E is identically zero.
2.3
disturbance decoupling by state feedback
The next question we address is under what conditions a bi-
modal system can be rendered disturbance decoupled by means
of static state feedback. To do so, we consider the bimodal sys-
tem
˙x(t) =
(
A1x(t) + Bu(t) + Ed(t)
if cTx(t) ⩽0
A2x(t) + Bu(t) + Ed(t)
if cTx(t) ⩾0
(2.9a)
z(t) = Hx(t)
(2.9b)
where u ∈Rnu is the input, B is an nx × nu input matrix, and
x, z, d, A1, A2, E, H and c are as before. We assume that B
has full column rank and that A1 and A2 satisfy the continuity
condition (2.2).
In this section we provide necessary and sufﬁcient condi-
tions for the existence of a static state feedback law that ren-
ders the closed-loop system disturbance decoupled. We con-
sider two forms of static feedback: mode-dependent and mode-
independent.
2.3.1
Mode-dependent state feedback
Consider a mode-dependent static feedback law of the form
u(t) =
(
F1x(t)
if cTx(t) ⩽0
F2x(t)
if cTx(t) ⩾0
(2.10)
for two matrices F1, F2 ∈Rnu×nx with the property that cTx = 0
implies F1x = F2x, or equivalently, ker cT ⊆ker(F1 −F2). This
implies that there exists a vector f ∈Rnu such that
F1 −F2 = f cT.
(2.11)
20

2.3 disturbance decoupling by state feedback
In other words, we consider mode-dependent and continuous
(in x) state feedback. Clearly, such a feedback results in the
(continuous) closed-loop system
˙x(t) =
(
(A1 + BF1)x(t) + Ed(t)
if cTx(t) ⩽0
(A2 + BF2)x(t) + Ed(t)
if cTx(t) ⩾0
(2.12a)
z(t) = Hx(t).
(2.12b)
In view of Corollary 2.7, we see that the closed-loop system
(2.12) is disturbance decoupled if and only if there exist a
subspace V and matrices F1 and F2 such that V is invariant
under both A1 + BF1 and A2 + BF2, im E ⊆V ⊆ker H, and
ker cT ⊆ker(F1 −F2).
In order to check whether such a subspace exists or not,
we need to introduce some nomenclature. Deﬁne the set of
subspaces
Vmd(H, {A1, A2}, B) :=
(2.13)
{ V ⊆ker H | ∃F1, F2 s.t. (Aj + BFj)V ⊆V, j = 1, 2 },
where the subscript ‘md’ stands for mode-dependent. Let V and
W be two subspaces in Vmd(H, {A1, A2}, B). Then, since V and
W are both (A1, B)-invariant, the subspace V + W is (A1, B)-
invariant as well. Similarly, we see that V + W is (A2, B)-
invariant too. Therefore, Vmd(H, {A1, A2}, B) is closed under
subspace addition. Let V∗
md(H, {A1, A2}, B) be the largest of
the subspaces in Vmd(H, {A1, A2}, B). If the context is clear, we
will denote it by V∗
md.
Note that in the deﬁnition of Vmd(H, {A1, A2}, B) in (2.13)
we do not consider the continuity condition (2.11). However, for
any subspace V in Vmd(ker H, {A1, A2}, B), there exist matrices
F1 and F2 such that the feedback (2.10) is continuous in x and
(Ai + BFi)V ⊆V for i = 1, 2, as shown in the following lemma.
Lemma 2.10 If a subspace V is (A1, B)-invariant and (A2, B)-
invariant, and A1 −A2 = hcT, then there exist matrices F1, F2 ∈
Rnu×nx such that F1 −F2 = f cT for some f ∈Rnu and (Ai +
BFi)V ⊆V for i = 1, 2.
Proof. V is (A1, B)-invariant, so there exists a matrix F1 such
that (A1 + BF1)V ⊆V. Since V is (A2, B)-invariant as well, V
is also (hcT, B)-invariant, so hcTV ⊆V + im B. This implies
that we have h ∈V + im B or V ⊆ker cT. In the former case,
21

2. disturbance decoupling for bimodal systems
there exists an f ∈Rnu such that h + B f ∈V. In the latter
case, let f be any vector in Rnu. Hence, in both cases we have
(h + B f )cTV ⊆V. Let F2 = F1 −f cT, then A2 + BF2 = A1 +
BF1 −(h + B f )cT, which implies that (A2 + BF2)V ⊆V.
■
The following theorem shows how we can use the subspace
V∗
md(H, {A1, A2}, B) to determine whether there exists a mode-
dependent state feedback controller that renders the system
(2.9) disturbance decoupled.
Theorem 2.11 There exists a mode-dependent static state feedback
of the form (2.10) that renders the closed-loop system (2.12) distur-
bance decoupled if and only if
im E ⊆V∗
md(H, {A1, A2}, B).
Proof. Sufﬁciency: Since V∗
md is (A1, B)-invariant and (A2, B)-
invariant, by Lemma 2.10 there exist matrices F1 and F2 such
that F1 −F2 = f cT for some f ∈Rnu and (Ai + BFi)V∗
md ⊆V∗
md
for i = 1, 2. From the hypothesis, we have im E ⊆V∗
md ⊆ker H.
Then, it follows from Corollary 2.7 that mode-dependent static
feedback given by (2.10) renders the closed-loop system (2.12)
disturbance decoupled.
Necessity: Suppose that F1 and F2 are such that the input (2.10)
renders the closed-loop system (2.12) disturbance decoupled.
It follows from Corollary 2.7 that there exists a subspace V that
is invariant under both A1 + BF1 and A2 + BF2, and such that
im E ⊆V ⊆ker H. Therefore, V ∈Vmd(H, {A1, A2}, B). Hence,
im E ⊆V ⊆V∗
md.
■
In Section 2.5 we will provide an algorithm to compute
the subspace V∗
md(H, {A1, A2}, B). Once the condition im E ⊆
V∗
md(H, {A1, A2}, B) is satisﬁed, one can construct the feedback
matrices F1 and F2 by following the steps in the proof of Lemma
2.10.
2.3.2
Mode-independent state feedback
Consider the static state feedback law u = Fx for a matrix
F ∈Rnu×nx. This can be seen as a special case of the mode-
dependent state feedback, with F1 = F2. Such a feedback law
results in the closed-loop system
˙x(t) =
(
(A1 + BF)x(t) + Ed(t)
if cTx(t) ⩽0
(A2 + BF)x(t) + Ed(t)
if cTx(t) ⩾0.
(2.14)
22

2.4 disturbance decoupling by dynamic feedback
By Corollary 2.7, we see that the closed-loop system is dis-
turbance decoupled if and only if there exist a subspace V
and a feedback matrix F such that V is invariant under both
A1 + BF and A2 + BF, and im E ⊆V ⊆ker H. Similar to the
mode-dependent case, we deﬁne the set of subspaces
Vmi(H, {A1, A2}, B) :=
(2.15)
{ V ⊆ker H | ∃F s.t. (Aj + BF)V ⊆V for j = 1, 2 },
where the subscript ‘mi’ stands for mode-independent. The
set Vmi(H, {A1, A2}, B) is closed under subspace addition, and
hence it has a largest element, denoted by V∗
mi(H, {A1, A2}, B),
or simply by V∗
mi if the context is clear. In Section 2.5 we provide
an algorithm to compute V∗
mi.
The following theorem can be proven by using similar argu-
ments as employed in the proof of Theorem 2.11.
Theorem 2.12 There exists a matrix F ∈Rnu×nx such that the
state feedback u(t) = Fx(t) renders the closed-loop system (2.9)
disturbance decoupled if and only if
im E ⊆V∗
mi(H, {A1, A2}, B).
2.4
disturbance decoupling by dynamic feedback
In this section, we address the disturbance decoupling prob-
lem by dynamic feedback. Consider the bimodal system (2.9)
together with the output
y(t) = Cx(t),
(2.16)
where y ∈Rny. The main goal of this section is to investigate
under which conditions there exists a dynamic controller from
y to u rendering the closed-loop system disturbance decoupled.
Similar to the state feedback problem, we distinguish two cases:
mode-dependent and mode-independent controllers.
23

2. disturbance decoupling for bimodal systems
2.4.1
Mode-dependent dynamic feedback
We start with the mode-dependent dynamic feedback controller
given by
˙w(t) =
(
Kw(t) + L1y(t)
if cTx ⩽0
Kw(t) + L2y(t)
if cTx ⩾0
(2.17a)
u(t) =
(
Mw(t) + N1y(t)
if cTx ⩽0
Mw(t) + N2y(t)
if cTx ⩾0
(2.17b)
where w ∈Rnw is the state of the controller, u ∈Rnu and
y ∈Rny are as before, and the matrices K, L1, L2, M, N1 and
N2 are of suitable sizes. Interconnecting this controller with
the system given by (2.9) and (2.16) results in the closed-loop
system
 ˙x(t)
˙w(t)

=













Ae,1
x(t)
w(t)

+ Eed(t)
if cT
e
x(t)
w(t)

⩽0
Ae,2
x(t)
w(t)

+ Eed(t)
if cT
e
x(t)
w(t)

⩾0
(2.18a)
z(t) = He
x(t)
w(t)

,
(2.18b)
where
Ae,i =
Ai + BNiC
BM
LiC
K

,
i = 1, 2,
(2.18c)
Ee =
E
0

,
He =

H
0

,
cT
e =

cT
0

.
(2.18d)
We only consider mode-dependent feedback controllers that
render the closed-loop system continuous (both in x and w).
This amounts to imposing the following conditions on the
matrices L1, L2, N1 and N2:
ker cT ⊆ker(L1 −L2)C,
ker cT ⊆ker(N1 −N2)C. (2.19)
Equivalently, we assume that there are vectors ℓ∈Rnw and
n ∈Rnu such that
(L1 −L2)C = ℓcT,
(N1 −N2)C = ncT.
(2.20)
As a result, we have ker cT
e ⊆ker(Ae,1 −Ae,2).
24

2.4 disturbance decoupling by dynamic feedback
The objective of this section is to ﬁnd such a mode-dependent
dynamic controller that renders the closed-loop system distur-
bance decoupled. By employing (C, A1, B)-pairs (see Section
1.5.1), the following theorem provides necessary and sufﬁcient
conditions for the existence of such a controller.
Theorem 2.13 There exists a mode-dependent dynamic controller of
the form (2.17) satisfying the continuity condition (2.19) such that
the closed-loop system (2.18) is disturbance decoupled if and only if
there exist subspaces T and V such that (T , V) is a (C, A1, B)-pair
satisfying im E ⊆T ⊆V ⊆ker H and hcTV ⊆V + im B.
Proof. Necessity: Assume that there exists such a controller
given by K, L1, L2, M, N1 and N2. Let Rnw denote the state
space of the controller. The (extended) state space of the inter-
connected system is then given by Rnx × Rnw. By Corollary 2.7,
there exists a subspace Ve ⊆Rnx × Rnw that is invariant under
both Ae,1 and Ae,2, satisfying im Ee ⊆Ve ⊆ker He. For this
subspace Ve, we deﬁne the following two subspaces of Rnx:
p(Ve) := {x ∈Rnx | ∃w ∈Rnw such that
x
w

∈Ve},
i(Ve) := {x ∈Rnx |
x
0

∈Ve},
which can be seen as the projection of Ve on Rnx and the
intersection of Ve and Rnx × {0} respectively. Let T = i(Ve)
and V = p(Ve). Since Ve is Ae,1-invariant, (T , V) is a (C, A1, B)-
pair (see e.g. [Trentelman et al., 2001, Theorem 6.2]). Next, we
will show that this (C, A1, B)-pair (T , V) satisﬁes im E ⊆T ,
V ⊆ker H and hcTV ⊆V + im B.
For any x ∈im E, we have that col(x, 0) ∈im Ee ⊆Ve.
Therefore, we get x ∈i(Ve) = T , hence we have im E ⊆T . For
x ∈V = p(Ve), there exists a w ∈Rnx such that col(x, w) ∈
Ve ⊆ker He. Then, we get Hx = He col(x, w) = 0 and hence
V ⊆ker H.
Since L1, L2, N1 and N2 satisfy (2.19), there are vectors ℓand
n such that (2.20) holds. Consequently, we have
Ae,1 −Ae,2 =
(h + Bn)cT
0
ℓcT
0

.
(2.21)
Let x ∈V. Then, a w ∈Rw such that (xT, wT)T ∈Ve. Since Ve
is invariant under both Ae,1 and Ae,2, we have
(Ae,1 −Ae,2)
x
w

=
(h + Bn)cTx
ℓcTx

∈Ve.
25

2. disturbance decoupling for bimodal systems
Consequently, we obtain (h + Bn)cTx ∈V and hence hcTV ⊆
V + im B.
Sufﬁciency: Let (T , V) be a such a (C, A1, B)-pair. Then there
exist F and G such that
(A1 + BF)V ⊆V,
(A1 + GC)T ⊆T .
Furthermore, there exists a linear mapping N1 such that (see
e.g. [Trentelman et al., 2001, Lemma 6.3])
(A1 + BN1C)T ⊆V.
Since hcTV ⊆V + im B, we have V ⊆ker cT or h ∈V + im B.
If the latter holds, then there exists an n ∈Rnu such that
h + Bn ∈V. Then choose ℓ∈V such that h + Bn −ℓ∈T .
If we have V ⊆ker cT, then we can choose n ∈Rnu and
ℓ∈V arbitrarily. In both cases, we can ﬁnd n and ℓsuch that
(h + Bn −ℓ)cTV ⊆T .
Let L1 = BN1 −G and deﬁne
K = A1 + BF + GC −BN1C,
L2 = L1 −ℓcT,
M = F −N1C,
N2 = N1 −ncT.
and let K, L1, L2, M, N1 and N2 deﬁne a controller of the
form (2.17), with nw = nx. Note that (L1 −L2)C = ℓcT and
(N1 −N2)C = ncT, so L1, L2, N1 and N2 satisfy the continuity
condition (2.19). The system matrices of the corresponding
closed-loop system (2.18) are then given by
Ae,i =
Ai + BNiC
B(F −N1C)
LiC
A1 + BF + GC −BN1C

,
for i = 1, 2.
Let Ve be the subspace of Rnx × Rnw given by
Ve = {
s
0

+
v
v

∈Rnx × Rnw | s ∈T , v ∈V }.
First we show that Ve is invariant under both Ae,1 and Ae,2. For
any s ∈T and v ∈V we have that
Ae,1
s
0

=
(A1 + GC)s
0

+
(A1 + BNC)s
(A1 + BNC)s

−
(A1 + GC)s
(A1 + GC)s

,
Ae,1
v
v

=
(A1 + BF)v
(A1 + BF)v

,
26

2.4 disturbance decoupling by dynamic feedback
are both elements of Ve, so Ve is invariant under Ae,1. Using
equation (2.21), ℓ∈V, and (h + Bn −ℓ)cTV ⊆T , we see that
for all s ∈T and v ∈V we have that
(Ae,1 −Ae,2)
s
0

=
(h + Bn)cTs
ℓcTs

=
ℓcTs
ℓcTs

+
(h + Bn −ℓ)cTs
0

,
(Ae,1 −Ae,2)
v
v

=
(h + Bn)cTv
ℓcTv

=
ℓcTv
ℓcTv

+
(h + Bn −ℓ)cTv
0

,
are also both elements of Ve. Consequently, Ae,2 col(s, 0) and
Ae,2 col(v, v) are contained in Ve as well. Therefore, Ve is in-
variant under both Ae,1 and Ae,2.
Next, we show that Ve satisﬁes im Ee ⊆Ve ⊆ker He. For
any point col(x, w) ∈im Ee, we have x ∈im E ⊆T and w = 0.
Consequently, col(x, w) = col(x, 0) ∈Ve and hence im Ee ⊆Ve.
Further, we have x ∈V ⊆ker H for any col(x, w) ∈Ve. This
implies that He col(x, w) = Hx = 0, i.e. col(x, w) ∈ker He.
Then, we can conclude that Ve ⊆ker He. Now we can use
Corollary 2.7 to prove that the closed-loop system (2.18) is
disturbance decoupled.
■
The conditions presented in Theorem 2.13 are existential
in nature. Next, we articulate these conditions and provide
easily veriﬁable conditions based on subspace algorithms. Re-
call that T ∗(E, A1, C) is the smallest (C, A1)-invariant subspace
containing im E.
Theorem 2.14 There exists a mode-dependent dynamic controller
of the form (2.17) satisfying the continuity condition (2.19) that ren-
ders the closed-loop system (2.18) disturbance decoupled if and only
if
T ∗(E, A1, C) ⊆V∗
md(H, {A1, A2}, B).
Proof. Necessity: If there exists such a controller, then by The-
orem 2.13 there are subspaces T and V such that (T , V) is a
(C, A1, B)-pair, im E ⊆T ⊆V ⊆ker H and hcTV ⊆V + im B.
We clearly have T ∗(E, A1, C) ⊆T . The subspace V is (A1, B)-
invariant. Since hcTV ⊆V + im B, the subspace V is also
27

2. disturbance decoupling for bimodal systems
(A2, B)-invariant. Therefore, we have V ⊆V∗
md(H, {A1, A2}, B).
Hence, we can conclude that
T ∗(E, A1, C) ⊆T ⊆V ⊆V∗
md(H, {A1, A2}, B).
Sufﬁciency: Let (T , V) be the (C, A1, B)-pair given by T
=
T ∗(E, A1, C) and V = V∗
md(H, {A1, A2}, B). Then we have
im E ⊆T ⊆V ⊆ker H. Since V is both (A1, B)-invariant
and (A2, B)-invariant, we have AiV ⊆V + im B for i = 1, 2.
As such, we obtain hcTV = (A1 −A2)V ⊆V + im B. It fol-
lows from Theorem 2.13 that the closed-loop system (2.18) is
disturbance decoupled.
■
2.4.2
Mode-independent dynamic feedback
As a special case, we consider in this section the linear time-
invariant mode-independent feedback controller
˙w(t) = Kw(t) + Ly(t)
(2.22a)
u(t) = Mw(t) + Ny(t),
(2.22b)
where w ∈Rnw, u ∈Rnu, y ∈Rny, and K, L, M and N are of
suitable sizes. By interconnecting this controller with system
given by (2.9) and (2.16), we obtain the closed-loop system
(2.18) with the system matrices Ae,1 and Ae,2 now given by
Ae,i =
Ai + BNC
BM
LC
K

for i = 1, 2.
(2.23)
We can adapt Theorem 2.13 for mode-dependent dynamic
controllers to obtain a similar, but more restrictive, result for
mode-independent dynamic controllers.
Theorem 2.15 There exists a mode-independent dynamic controller
of the form (2.22) that renders the system given by (2.9) and (2.16)
disturbance decoupled if and only if there exist subspaces T and V
such that (T , V) is a (C, A1, B)-pair, im E ⊆T ⊆V ⊆ker H and
hcTV ⊆T .
Proof. A proof of the statement follows from the proof of
Theorem 2.13 by taking L1 = L2, N1 = N2, n = 0 and ℓ= 0. ■
Note that the condition hcTV ⊆T in Theorem 2.15 is more
restrictive than the condition hcTV ⊆V + im B that appears in
Theorem 2.13.
28

2.4 disturbance decoupling by dynamic feedback
Just as for the mode-dependent case, we would like to de-
ﬁne some minimal T ∗and maximal V∗such that (T ∗, V∗) is a
(C, A1, B)-pair that satisﬁes the conditions of Theorem 2.15 ex-
actly when the system can be rendered disturbance decoupled
by means of a mode-dependent dynamic feedback controller.
For this reason, we deﬁne the set of subspaces
Tmi(E,{A1, A2}, C) := {T ⊆Rnx | im E ⊆T ,
(2.24)
and ∃G s.t. (Aj + GC)T ⊆T for j = 1, 2}.
Similar to the fact that the set Vmi (deﬁned in (2.15)) has a
maximal element with respect to subspace addition, the set
Tmi has a minimal element. Let T ∗
mi(E, {A1, A2}, C) denote the
smallest subspace in Tmi. In Section 2.5 we present an algorithm
to compute T ∗
mi.
The existence of a controller of the form (2.22) that renders
the closed-loop system disturbance decoupled does not imply
that (T ∗
mi, V∗
mi) is a (C, A1, B)-pair satisfying the conditions of
Theorem 2.15, since hcTV∗
mi ⊆T ∗
mi is not necessarily satisﬁed.
However, the following assertion holds.
Theorem 2.16 There exists a controller of the form (2.22) that ren-
ders the system given by (2.9) and (2.16) disturbance decoupled if
and only if at least one of the following two conditions holds
1. T ∗
mi(

E
h

, {A1, A2}, C) ⊆V∗
mi(H, {A1, A2}, B),
2. T ∗
mi(E, {A1, A2}, C) ⊆V∗
mi(

HT
c
T , {A1, A2}, B).
Proof. Sufﬁciency: If the ﬁrst condition holds, then let
T = T ∗
mi(

E
h

, {A1, A2}, C),
V = V∗
mi(H, {A1, A2}, B).
Then, we have h ∈T which implies that hcTV ⊆T .
If the second condition holds, let
T = T ∗
mi(E, {A1, A2}, C),
V = V∗
mi(

HT
c
T , {A1, A2}, B).
Then, we have V ⊆ker cT which implies that hcTV ⊆T .
In both cases we have that (T , V) is a (C, A1, B)-pair satis-
fying im E ⊆T ⊆V ⊆ker H and hcTV ⊆T . Therefore, it
follows from Theorem 2.15 that there exists a controller of the
form (2.22) such that the closed-loop system is disturbance
decoupled.
Necessity: Suppose there exists such a controller. By Theo-
rem 2.15, there exist subspaces T and V such that (T , V) is a
29

2. disturbance decoupling for bimodal systems
(C, A1, B)-pair, im E ⊆T ⊆V ⊆ker H, and hcTV ⊆T . The
last condition implies that hcTV ⊆V and hcTT ⊆T , and
hence (T , V) is also a (C, A2, B)-pair. Therefore, we have T ∈
Tmi(E, {A1, A2}, ker H) and V ∈Vmi(H, {A1, A2}, B). Further-
more, hcTV ⊆T also implies that we have h ∈T or V ⊆ker cT.
If h ∈T , then T is an element of Tmi([E h], {A1, A2}, C), which
means that
T ∗
mi(

E
h

, {A1, A2}, C) ⊆T ⊆V ⊆V∗
mi(H, {A1, A2}, B).
If V ⊆ker cT, then V ∈Vmi([HT c]T, {A1, A2}, B). Hence, we
get
T ∗
mi(E, {A1, A2}, C) ⊆T ⊆V ⊆V∗
mi(

HT
c
T , {A1, A2}, B).
In conclusion, at least one of the two conditions in the statement
holds.
■
2.5
subspace algorithms
In this section we ﬁrst propose subspace algorithms for com-
puting V∗
md(H, {A1, A2}, B) and V∗
mi(H, {A1, A2}, B). Both al-
gorithms are similar to the invariant subspace algorithm for
computing V∗(H, A1, B) for linear systems (see e.g. [Trentelman
et al., 2001]), and to the subspace algorithms proposed in [Yurt-
seven et al., 2012] for switched linear systems. Afterwards, we
will provide an algorithm for computing T ∗
mi(E, {A1, A2}, C).
2.5.1
Algorithm for V∗
md(H, {A1, A2}, B)
For computing V∗
md(H, {A1, A2}, B), we propose the following
algorithm. We ﬁrst deﬁne
V0 = ker H.
(2.25a)
Then, for i ⩾0, we deﬁne
Vi+1 = Vi ∩A−1
1 (Vi + im B),
(2.25b)
if h ∈Vi + im B, and otherwise
Vi+1 = Vi ∩A−1
1 (Vi + im B) ∩ker cT.
(2.25c)
It is clear that we have Vi+1 ⊆Vi for all i ⩾0 and hence there
is a k ⩽nx such that Vk = Vk+1. Moreover, it follows from the
deﬁnition of Vi that we then have Vk+2 = Vk+1. Therefore, we
get Vi = Vk for all i ⩾k.
30

2.5 subspace algorithms
Theorem 2.17 Let Vi be deﬁned as in algorithm (2.25). Then for
q = min{k ∈N | Vk = Vk+1} ⩽nx we have
Vq = V∗
md(H, {A1, A2}, B).
Proof. As the subspaces Vi are nested, we have Vq ⊆V0 =
ker H. Since Vq satisﬁes Vq = Vq+1, it follows that Vq = Vq ∩
A−1
1 (Vq + im B) if h ∈Vq + im B, and Vq = Vq ∩A−1
1 (Vq +
im B) ∩ker cT otherwise. In both cases we have A1Vq ⊆Vq +
im B, so Vq is (A1, B)-invariant. Furthermore, we have h ∈Vq +
im B or Vq ⊆ker cT, which implies that hcTVq ⊆Vq + im B.
Hence, A2Vq ⊆A1Vq + hcTVq ⊆Vq + im B, so Vq is (A2, B)-
invariant as well. Therefore, we see that Vq is an element of
Vmd(H, {A1, A2}, B), and hence Vq ⊆V∗
md.
To prove that we have V∗
md ⊆Vq as well, we use mathemat-
ical induction on i. Firstly, we have that V∗
md ⊆V0 = ker H.
Secondly, assume that V∗
md ⊆Vi for some i ⩾0. Since V∗
md
is both (A1, B)-invariant and (A2, B)-invariant, it is (hcT, B)-
invariant as well. Therefore, we have
hcTV∗
md ⊆V∗
md + im B
⊆Vi + im B.
Hence, we get h ∈Vi + im B or V∗
md ⊆ker cT. In both cases, it
holds that V∗
md ⊆Vi+1. Therefore, we see that V∗
md ⊆Vk for all
k ⩾0. In particular, we have V∗
md ⊆Vq.
■
2.5.2
Algorithm for V∗
mi(H, {A1, A2}, B)
To compute V∗
mi(H, {A1, A2}, B), we refer to Algorithm 5.3 in
[Yurtseven et al., 2012], which in our case simpliﬁes to
V0 = ker H
(2.26a)
and
Vi+1 = Vi ∩A−1
1 (Vi + im B) ∩(A1 −A2)−1(Vi)
(2.26b)
for i ⩾0.
2.5.3
Algorithm for T ∗
mi(E, {A1, A2}, C)
By making use of the well-known duality between controlled
invariance and conditioned invariance (see e.g. [Trentelman
31

2. disturbance decoupling for bimodal systems
et al., 2001, Theorem 5.6]), we adapt the algorithm (2.26) for
computing V∗
mi to obtain the following algorithm. We deﬁne
T0 = im E,
(2.27a)
and
Ti+1 = im E + A1(Ti ∩ker C) + hcTTi
(2.27b)
for i ⩾0. It is easy to see that Ti ⊆Ti+1 for i ⩾0. Since nx is
ﬁnite and Ti ∈Rnx for all i ⩾0, it follows that there is a k such
that Tk = Tk+1. Furthermore, it follows from the deﬁnition of Ti
that we have Ti = Tk for all i ⩾k. The next theorem shows that
this algorithm indeed gives us T ∗
mi(E, {A1, A2}, C). We omit
the proof, since it follows from similar arguments as employed
in the proof of Theorem 2.17.
Theorem 2.18 Let Ti be deﬁned as in algorithm (2.27). Then for
q = min{k ∈N | Tk = Tk+1} ⩽nx we have
Tq = T ∗
mi(E, {A1, A2}, C).
2.6
conclusions
In this chapter, we studied the disturbance decoupling problem
for continuous piecewise linear bimodal systems. The main
contributions of this chapter include necessary and sufﬁcient
conditions for such systems to be disturbance decoupled as
well as a complete characterization of the solvability of the
disturbance decoupling problem with mode-independent and
mode-dependent feedback controllers. Furthermore, we pro-
vided subspace algorithms in order to compute the minimal
and maximal subspaces that are used in the presented condi-
tions for disturbance decoupling by both state feedback and
dynamic feedback.
Future research possibilities include the extension of the
presented results to general piecewise afﬁne dynamical systems,
which will be the subject of the next chapter.
32

3
D I S T U R BANCE DECOUPLING FOR
P I E C E W I SE AFFINE SYSTEMS
abstract:
In this chapter we study the disturbance decoupling problem for
continuous piecewise afﬁne systems. We establish a set of necessary conditions and a
set of sufﬁcient conditions, both geometric in nature, for such systems to be disturbance
decoupled. Furthermore, we investigate mode-independent state feedback controllers
for piecewise afﬁne systems and provide sufﬁcient conditions for the solvability of
the disturbance decoupling problem by state feedback. This chapter is based on the
conference paper [Everts and Camlibel, 2014a].
3.1
introduction
In this chapter we continue studying the disturbance decou-
pling problem for linear multi-modal systems. We extend the
bimodal systems studied in Chapter 2 to more general contin-
uous piecewise afﬁne systems. Piecewise afﬁne systems are a
class of hybrid systems; they are a combination of continuous-
time linear systems, the modes, together with the discrete
dynamics of switching between these modes.
The switching between the several modes of a piecewise
afﬁne system is state-dependent. As discussed in more detail
in Sections 1.1, 1.2 and 2.1, this state-dependent switching be-
havior of piecewise afﬁne systems calls for a different approach
than for switched linear systems, for which the switching is
state-independent.
In this chapter, we develop a new approach that takes into
account the state-dependent switching behavior of piecewise
afﬁne systems. This approach allows us to provide a set of nec-
essary conditions and a set of sufﬁcient conditions under which
a continuous piecewise afﬁne system is disturbance decoupled.
Although these conditions do not coincide in general, we point
out some special cases in which they do coincide. Furthermore,
we present conditions for the existence of mode-independent
static feedback controllers that render the closed-loop system
disturbance decoupled. All conditions we present are geometric
in nature and easily veriﬁable.
The following section introduces the class of continuous
piecewise afﬁne systems. For this class of systems, we deﬁne
33

3. disturbance decoupling for piecewise affine systems
the disturbance decoupling problem in Section 3.3 and give a
set of necessary conditions and a set of sufﬁcient conditions for
such a system to be disturbance decoupled. In Section 3.4, we
provide conditions under which the necessary conditions and
the sufﬁcient conditions coincide. The problem of disturbance
decoupling by state feedback is discussed in Section 3.5. Finally,
Section 3.6 contains the main conclusions of this chapter.
3.2
piecewise affine systems
Before we can deﬁne the class of continuous piecewise afﬁne
systems, we need the notions of afﬁne functions and piecewise
afﬁne functions. An afﬁne function is a function θ : Rn →Rm
of the form θ(x) = Qx + q, with Q a m × n matrix and q an
m-vector. A function f : Rn →Rm is called piecewise afﬁne if
there exists a ﬁnite set of afﬁne functions fi : Rn →Rm, i ∈Ip,
such that for each x ∈Rn we have
f (x) ∈{ f1(x), f2(x), . . . , fp(x)}.
The domain of a continuous piecewise afﬁne function can be
divided into a set of polyhedral regions in such a way that the
restriction of the function f to any of the regions is given by
an afﬁne function [Scholtes, 2012, Prop. 2.2.3]. To make this
statement more precise, we quickly review some deﬁnitions
and results about polyhedral sets.
A polyhedron (or polyhedral set) in Rn is the intersection of
a ﬁnite number of closed half-spaces. Therefore, a polyhedron
P can be represented as P = {x ∈Rn | Ax ⩽b}, where
A is a p × n matrix and b is a p-vector. The dimension of a
polyhedron is equal to the dimension of its afﬁne hull. We
call a polyhedron solid if it has dimension n. A subset F of a
polyhedron P is called a face of P if there is a vector y ∈Rn
such that
F = {x ∈P | yTx ⩾yTz for every z ∈P}.
A face of a polyhedron P is also a polyhedron and is called
proper if its dimension is strictly less than that of P. If a face is
(n −1)-dimensional we call it a facet.
A ﬁnite collection Ξ = {X1, X2, . . . , XN} of polyhedral sets
in Rn is a polyhedral subdivision of Rn if every polyhedron in
Ξ is solid, the union of all polyhedra in Ξ equals Rn, and the
intersection of any two polyhedra in Ξ is either empty or a
common proper face of both polyhedra (see Figure 3.1).
34

3.2 piecewise affine systems
(a)
(b)
Figure 3.1: (a) Example of a polyhedral subdivision of R2. (b) This is
not a polyhedral subdivision of R2, since the intersection
of X1 and X2 is a proper face of X2 but not of X1.
As shown in [Scholtes, 2012, Prop. 2.2.3], for a given contin-
uous piecewise afﬁne function f there are a ﬁnite number of
polyhedral sets Xk with corresponding matrices Qk ∈Rm×n
and vectors qk ∈Rm for all k ∈IN, such that {X1, X2, . . . , XN}
is a polyhedral subdivision of Rn and f satisﬁes
f (x) = Qkx + qk
∀x ∈Xk.
A continuous piecewise afﬁne system is a system of the form
˙x(t) = f (x(t)) + Ed(t)
(3.1a)
z(t) = Hx(t),
(3.1b)
where x ∈Rnx is the state, d ∈Rnd is the unknown disturbance,
z ∈Rnz is the output to be controlled, E and H are matrices of
appropriate sizes, and f : Rnx →Rnx is a continuous piecewise
afﬁne function.
Since the right-hand side of (3.1a) is Lipschitz continuous in
the variable x, for each x0 and locally integrable disturbance
d there exists a unique absolutely continuous function xx0,d(t)
satisfying x(0) = x0 and (3.1a) for almost all t. We denote the
corresponding output by zx0,d(t).
As stated above, the function f admits a polyhedral subdi-
vision. So there are polyhedral regions Xk, matrices Ak and
vectors gk, for each k ∈IN, such that {X1, X2, . . . , XN} is a
polyhedral subdivision of Rnx and
f (x) = Akx + gk
∀x ∈Xk.
35

3. disturbance decoupling for piecewise affine systems
Hence, we can write system (3.1) as
˙x(t) = Akx(t) + gk + Ed(t)
∀x ∈Xk
(3.2a)
z(t) = Hx(t).
(3.2b)
We can exploit the continuity of f (x) to obtain relations
between the matrices Ak. Note that for any two polyhedral
regions Xk and Xℓsharing a facet Fkℓ:= Xk ∩Xℓ, we can
choose a vector ckℓand a scalar fkℓsuch that the afﬁne hull of
Fkℓis given by the hyperplane
Hkℓ:= {x ∈Rnx | cT
kℓx + fkℓ= 0}.
The continuity of f implies that for all x ∈Fkℓ⊆Hkℓwe have
Akx + gk = Aℓx + gℓ, or equivalently
(Ak −Al)x + gk −gℓ= 0.
(3.3)
Since Fkℓis (nx −1)-dimensional, it follows that ker cT
kℓ⊆
ker(Ak −Aℓ). Hence, there is a vector hkℓ∈Rnx such that
Ak −Aℓ= hkℓcT
kℓ.
(3.4)
By combining this with (3.3) and the fact that cT
kℓx + fkℓ= 0 for
all x ∈Fkℓ, we ﬁnd that gk and gℓsatisfy
gk −gℓ= hkℓfkℓ.
(3.5)
Notice that, since facet Fkℓis equal to facet Fℓk, we can assume
that ckℓ= cℓk, fkℓ= fℓk and hkℓ= −hℓk. If the state x passes
from one polyhedral region to another, it will always cross one
or more facets, which is why facets will play an important role
in this chapter.
Example 3.1 Conewise linear systems are a special class of
piecewise linear systems. In such systems, the polyhedral re-
gions are convex cones and the corresponding subsystems are
linear. As an example, consider the piecewise linear system
with four modes, given by
A1 =
 14
11
10.25
8

,
A2 =
 6
7
0.25
3

,
A3 =
 6
0
0.25
0

,
A4 =
 14
8
10.25
10

,
E = 0,
f12 = f23 = f34 = f41 = g1 = g2 = g3 = g4 = 0,
cT
23 =

2
1

, cT
34 =

1
1

, cT
12 = cT
41 =

1
0

.
See Figure 3.2 for a sketch of the corresponding vector ﬁeld.
36

3.2 piecewise affine systems
Figure 3.2: Sketch of the vector ﬁeld corresponding to the continuous
piecewise afﬁne system with four modes (without distur-
bances) in Example 3.1. The line segments denote the facets
between the polyhedral regions.
For continuous piecewise afﬁne systems, it is sometimes
more convenient to write system (3.2) in the following alterna-
tive way:
˙x(t) = Ax(t) + Ed(t) + g(y)
(3.6a)
y(t) = Cx(t)
(3.6b)
z(t) = Hx(t),
(3.6c)
where x, z, E and H are as before, y ∈Rny is the measured
output, A and C are matrices of appropriate sizes, and g :
Rny →Rnx is a continuous piecewise afﬁne function. In this
representation, the domain Rny of g admits a polyhedral subdi-
vision: there are solid (i.e., ny-dimensional) polyhedral regions
Yk, matrices Fk ∈Rnx×ny and vectors gk ∈Rnx, for all k ∈IN,
such that {Y1, Y2, . . . , YN} is a polyhedral subdivision of Rny
and
g(y) = Fky + gk,
if y ∈Yk.
(3.6d)
If Yk and Yℓshare a facet ˜Fkℓ, there is a vector ˜ckℓ∈Rny and
scalar ˜fkℓsuch that
˜Fkℓ⊆{y ∈Rny | ˜cT
kℓy + ˜fkℓ= 0}.
Since g is continuous, we can employ the same reasoning as
above to see that there is a vector ˜hkℓsuch that
Fk −Fℓ= ˜hkℓ˜cT
kℓ,
gk −gℓ= ˜hkℓ˜fkℓ.
37

3. disturbance decoupling for piecewise affine systems
To see the equivalence between the two representations, no-
tice that we can write system (3.2) in the form of system (3.6)
by taking C = I, A = A1, Yk = Xk and Fk = Ak −A1 for
k ∈IN. On the other hand, we can write system (3.6) in the
form of system (3.2) by letting Ak = A + FkC and Xk = C−1Yk
for k ∈IN, and using the same gk, E and H. It can be shown
that resulting set {X1, X2, . . . , XN} is a polyhedral subdivision
of Rnx. The corresponding facets Fkℓare equal to C−1 ˜Fkℓ, with
cT
kℓ= ˜cT
kℓC and fkℓ= ˜fkℓ.
Combinations of linear systems and static (piecewise linear)
nonlinearities, such as saturation, dead-zone and backlash, lead
naturally to piecewise afﬁne systems. A concrete example of a
continuous piecewise afﬁne system is given next.
Example 3.2 ([Thuan and Camlibel, 2014, Example 2.2]) In
high-accuracy motion control of a DC servo system, one has
to deal with deadzone-type nonlinear relations between the
motor torque T and the current i through the motor windings
(see e.g. [Zhonghua et al., 2006]). This can be modeled by the
continuous piecewise afﬁne function
g(y) =





kTy −T−−Tℓ
if kTy ⩽T−
−Tℓ
if T−⩽kTy ⩽T+
kTy −T+ −Tℓ
if T+ ⩽kTy,
(3.7)
with kT the torque constant, Tℓthe torque applied to the rotor,
and T−and T+ constant values. If we assume that Tℓis constant,
we can describe the dynamics of the current i through the
motor windings and the angular position θ of the rotor with
the following piecewise afﬁne system:
d
dt


i
θ
ω

=


−R
L
0
−kb
L
0
0
1
0
0
−
Bf
J




i
θ
ω

+


0
0
g(y)


(3.8a)
y =

1
0
0



i
θ
ω

,
(3.8b)
where ω = ˙θ, J is the moment of inertia of the rotor, and L, R,
kb and Bf are some constants (see [Thuan and Camlibel, 2014]
for details).
38

3.3 the disturbance decoupling problem
3.3
the disturbance decoupling problem
We say that a piecewise afﬁne system, given by (3.1), (3.2) or
(3.6), is disturbance decoupled if for all initial states x0 ∈Rnx and
all locally integrable disturbances d1 and d2 we have
zx0,d1(t) = zx0,d2(t),
∀t ⩾0.
In this section, we give a necessary condition for a piecewise
afﬁne system to be disturbance decoupled, as well as a sufﬁcient
condition. Both conditions are geometric in nature.
Theorem 3.3 If the system (3.2) is disturbance decoupled, then
N
∑
k=1
⟨Ak | im E⟩⊆ker H.
(3.9)
Proof. Let k ∈IN, and let d1(t) = d ∈Rnd and d2 = 0 be two
distinct constant disturbances. Since Xk is solid, we can choose
an interior point x0 of Xk. Let xi(t) denote the trajectory xx0,di(t)
and let zi(t) denote the corresponding output, for i = 1, 2. Since
x1 and x2 are continuous, there exists an ε > 0 such that x1(t)
and x2(t) stay in Xk for t ∈[0, ε). Thus, the trajectories x1 and
x2 satisfy
˙xi(t) = Akxi(t) + gk + Edi(t),
for t ∈[0, ε), i = 1, 2.
As the system is disturbance decoupled, we have that z1(t) =
z2(t) and hence
Hx1(t) = Hx2(t)
(3.10)
for all t ⩾0. Since d1 and d2 are constant, we can differentiate
equation (3.10) p ⩾1 times and obtain
HAp
k x1(t) + HAp−1
k
Ed = HAp
k x2(t)
for all t ∈[0, ε). Using t = 0 and x1(0) = x2(0) we get
HAp
k Ed = 0
∀p ⩾0.
Since this holds for any vector d ∈Rnd, we conclude that
HAp
k E = 0 for all p ⩾0, and hence by (1.2) we have ⟨Ak |
im E⟩⊆ker H. By letting k vary over {1, . . . , N}, we see that
(3.9) holds.
■
For the alternative representation of the system, given by
(3.6), we have the following corollary.
39

3. disturbance decoupling for piecewise affine systems
Corollary 3.4 If the system (3.6) is disturbance decoupled, then
N
∑
k=1
⟨A + FkC | im E⟩⊆ker H.
(3.11)
In general, the subspace ∑N
k=1⟨Ak | im E⟩that appears in
Theorem 3.3 is not necessarily invariant under Ak for all k ∈
IN. The following theorem shows that such joint invariance
relations lead to a sufﬁcient condition.
Theorem 3.5 The system (3.2) is disturbance decoupled if there is a
subspace V of ker H that contains im E and that is invariant under
Ak for all k ∈IN.
Proof. Let r be the dimension of V and write x = col(v, w),
where v consists of the ﬁrst r entries of x. Note that a piecewise
afﬁne function is still piecewise afﬁne after a basis transfor-
mation. Moreover, the property of disturbance decoupling is
invariant under basis transformations as well. Therefore, we
can assume without loss of generality that the vectors col(v, 0)
correspond to the subspace V.
Since V is invariant under each Ak and satisﬁes im E ⊆V ⊆
ker H, the system matrices are of the form
E =
E1
0

,
H =

0
H2

,
Ak =
Ak
11
Ak
12
0
Ak
22

,
gk =
gk
1
gk
2

,
k ∈IN,
where Ak
11 ∈Rr×r, gk
1 ∈Rr, E1 ∈Rr×nd and H2 ∈Rnz×(nx−r).
Hence, we can write system (3.2) as
˙v = Ak
11v + Ak
12w + E1d + gk
1
∀col(v, w) ∈Xk
˙w = Ak
22w + gk
2
∀col(v, w) ∈Xk
z = H2w.
Notice that the output z depends only on w and that w does not
directly depend on the disturbance d. However, the disturbance
might inﬂuence the switching behavior of x and in this way the
disturbance might still inﬂuence the evolution of w. In the rest
of the proof, we will show that this is not the case.
Since the subspace V is invariant under all Ak, we also have
(Ai −Aj)V ⊆V
40

3.3 the disturbance decoupling problem
for each i and j. In particular, when the polyhedral regions Xi
and Xj share a facet Fij we can use equation (3.4) to ﬁnd that
hijcT
ij V ⊆V.
It follows that we have hij ∈V or V ⊆ker cT
ij . We write hij =
col(hij,1, hij,2) and cij = col(cij,1, cij,2), where hij,1 and cij,1 are
r-dimensional. Note that if hij ∈V, then hij,2 = 0. Consequently,
using equations (3.4) and (3.5), we see that in this case Ai
22 =
Aj
22 and gi
2 = gj
2. Next, we will use this observation to deﬁne
clusters of modes.
We partition IN into equivalence classes as follows: i and j
are in the same equivalence class if Ai
22 = Aj
22 and gi
2 = gj
2. Let
I1, I2, . . . , Ip denote the resulting equivalence classes and deﬁne
clusters C1, C2, . . . , Cp as
Cℓ= ∪k∈IℓXk
for all ℓ∈Ip. Although the union of the clusters is equal to Rnx,
{C1, C2, . . . , Cp} is not necessarily a polyhedral subdivision of
Rnx, since a cluster is not necessarily convex. However, within
the cluster Cℓ, w satisﬁes
˙w = Aℓ
22w + gℓ
2
∀x ∈Cℓ.
Note that in the case that there is just one distinct cluster, equal
to Rnx, w satisﬁes an autonomous afﬁne system, which implies
that the system (3.2) is disturbance decoupled.
If there are two or more clusters, then we have Ai
22 ̸= Aj
22 or
gi
2 ̸= gj
2 for any facet Fij for which i and j are not in the same
equivalence class. Both inequalities imply that hij,2 ̸= 0, which
means that hij is not an element of V. Consequently, the normal
cij of the facet Fij satisﬁes V ⊆ker cT
ij , and hence cij must be of
the form cij = col(0, cij,2). Since there are at least two clusters,
there is at least one such cluster-separating facet.
Suppose that a point a is in cluster Cℓ, but another point b
is not. Then the line segment between a and b must intersect
a cluster-separating facet Fij for some i and j. For this facet,
cT
ij a + fij and cT
ij b + fij have different signs. Hence, although
the clusters might not be convex, we can determine for each
x ∈Rnx in which cluster it resides by only checking the values
of cT
ij x + fij for each cluster-separating facet Fij. For such cluster-
separating facets, we have cT
ij x + fij = cT
ij,2w + fij. Consequently,
41

3. disturbance decoupling for piecewise affine systems
the value of w is enough to completely determine the cluster
that x is in, so w determines the switching between modes.
Hence, we have
˙w = Aℓ
22w + gℓ
2
for
0
w

∈Cℓ.
(3.12)
Thus we see that w satisﬁes an autonomous piecewise afﬁne
differential equation.
We are now in a position to prove that system (3.1) is dis-
turbance decoupled. Let x0 be any initial condition and let d1
and d2 be two locally integrable disturbances. Denote the two
corresponding trajectories by xi(t) = xx0,di(t), i = 1, 2, and
write xi = col(vi, wi). From (3.12) we see that w1(t) = w2(t) for
all t ⩾0. Consequently, we have z1(t) = z2(t) for all t ⩾0, and
hence the system is disturbance decoupled.
■
For the alternative representation of the system, given by
(3.6), we have the following corollary.
Corollary 3.6 The system (3.6) is disturbance decoupled if there is a
subspace V ⊆ker H that contains im E and that is invariant under
A + FkC for all k ∈IN.
3.4
necessary and sufficient conditions
The sufﬁcient conditions for system (3.2) to be disturbance de-
coupled, as given by Theorem 3.5, do not coincide in general
with the necessary conditions provided by Theorem 3.3, be-
cause ∑N
i=1⟨Ai | im E⟩is not necessarily invariant under each
Ai. In this section, we identify a number of particular cases for
which the conditions do coincide.
Corollary 3.7 If ∑N
i=1⟨Ai | im E⟩is invariant under Ai for all
i ∈IN, then system (3.2) is disturbance decoupled if and only if
N
∑
i=1
⟨Ai | im E⟩⊆ker H.
Proof. Theorem 3.3 implies the necessity of the condition. For
the sufﬁciency, let V = ∑N
i=1⟨Ai | im E⟩. Then im E ⊆V, and
by assumption we have V ⊆ker H and AiV ⊆V for all i ∈
IN. Hence, using Theorem 3.5, we see that system (3.2) is
disturbance decoupled.
■
42

3.4 necessary and sufficient conditions
To investigate when ∑N
i=1⟨Ai | im E⟩is invariant under A1,
A2, . . . , AN, we ﬁrst look at the case that N = 2, which corre-
sponds to a bimodal linear system, as discussed in Chapter
2.
Lemma 3.8 For two square matrices A1 and A2 satisfying A1 −
A2 = hcT, the subspace ⟨A1 | im E⟩+ ⟨A2 | im E⟩is invariant
under both A1 and A2. Furthermore, we have h ∈⟨A1 | im E⟩+
⟨A2 | im E⟩, or ⟨A1 | im E⟩+ ⟨A2 | im E⟩⊆ker cT.
Proof. Let V = ⟨A1 | im E⟩+ ⟨A2 | im E⟩. Since im A1E and
im A2E are both in V, we see that
im hcTE ⊆V.
This implies that either h ∈V, or cTE = 0. Suppose that h ̸∈V,
then we must have cTE = 0, which gives us A1E = (A2 +
hcT)E = A2E. Since im A2
1E and im A2
2E are both contained in
V, we see that im(A2
1 −A2
2)E ⊆V, so
im hcTA2E = im(A1 −A2)A2E = im(A2
1 −A2
2)E ⊆V.
Hence, since h ̸∈V, we have cTA2E = 0, which implies
A2
1E = A1A2E = (A2 + hcT)A2E = A2
2E.
By continuing this argument, we see that cTAk
2E = cTAk
1E = 0
and Ak
2E = Ak
1E for all k ⩾0. This implies that V = ⟨A1 |
im E⟩= ⟨A2 | im E⟩and V ⊆ker cT. Hence, we have h ∈V or
V ⊆ker cT. This means that hcTv ∈V for any v ∈V. Since any
v ∈V can be written as v = v1 + v2, with vi ∈⟨Ai | im E⟩, i =
1, 2, we have A1v = A1v1 + A1v2 = A1v1 + A2v2 + hcTv2 ∈V
for all v ∈V. Similarly, we get A2v ∈V for all v ∈V. Hence, V
is invariant under both A1 and A2.
■
Next, we ﬁnd a sufﬁcient condition for ∑N
i=1⟨Ai | im E⟩to be
invariant under all Ai.
Lemma 3.9 Consider system (3.2). If hkℓ∈∑N
i=1⟨Ai | im E⟩for
all facets Fkℓ, then ∑N
i=1⟨Ai | im E⟩is invariant under Ai for all
i ∈IN.
Proof. From Theorem 2 in [Shen, 2014] we know that for every
i, j ∈IN there is a ﬁnite sequence of indices k1, k2, . . . , kr+1
43

3. disturbance decoupling for piecewise affine systems
such that k1 = i, kr+1 = j and such that Xks and Xks+1 share a
facet for each s ∈Ir. Hence, we can write Ai as
Ai = Aj +
r
∑
s=1
hksks+1cT
ksks+1.
Therefore, for any element vj ∈⟨Aj | im E⟩we have
Aivj = Ajvj +
r
∑
s=1
hksks+1cT
ksks+1vj ∈V,
since hksks+1 ∈V for all s ∈Ir. Hence, we have Ai⟨Aj | im E⟩⊆
V for every i and j and we can conclude that V is invariant
under each Ai for all i ∈IN.
■
We now investigate two special cases of systems for which the
necessary conditions and sufﬁcient conditions for disturbance
decoupling coincide.
Corollary 3.10 Consider system (3.6). If C(sI −A)−1E is right-
invertible as a rational matrix, then system (3.6) is disturbance de-
coupled if and only if
N
∑
k=1
⟨A + FkC | im E⟩⊆ker H.
Proof. We begin by proving the following claim: if C(sI −
A)−1E is right-invertible, then so is C(sI −A −FC)−1E for any
matrix F ∈Rny×nx. For this we use the well-known property
(sI −B)−1−(sI −A)−1 = (sI −B)−1(B −A)(sI −A)−1.
We take B = A + FC and multiply both sides with C from
the left and with E from the right. Rearranging the terms then
gives us
C(sI−A −FC)−1E =

I + C(sI −A −FC)−1F

C(sI −A)−1E.
Since I + C(sI −A −FC)−1F and C(sI −A)−1E are both right-
invertible as a rational matrices, the claim follows.
Let V = ∑N
k=1⟨A + FkC | im E⟩. From the claim above it
follows that C(sI −A −FiC)−1E ̸= 0 for each i, so for any
facet ˜Fkℓwe have ˜cT
kℓC(sI −A −FiC)−1E ̸= 0 since ˜cT
kℓ̸= 0.
Equivalently, ˜cT
kℓC⟨A + FiC | im E⟩̸= {0}. Hence, by Lemma
44

3.4 necessary and sufficient conditions
3.8, we see that hkℓ∈V for all facets ˜Fkℓ. Then, by Lemma 3.9,
V is invariant under all A + FkC. From Corollaries 3.6 and 3.7
we see that system (3.6) is disturbance decoupled if and only if
V ⊆ker H.
■
Corollary 3.11 Consider system (3.2). If all normals cij to facets Fij
are parallel, then system (3.2) is disturbance decoupled if and only if
N
∑
i=1
⟨Ai | im E⟩⊆ker H.
Proof. Let V = ∑N
i=1⟨Ai | im E⟩. If all normals cT
ij to facets Fij
are parallel, then all the facets are parallel. This means that
the state space is sliced up into parallel regions, each of which
shares a facet with at most two other regions.
Suppose that there is a facet Fij for which we have
cT
ij ⟨Ai | im E⟩= {0},
then this implies that cT
ij Ap
i E = 0 for all p ⩾0. It follows that
Ap
i E = Ap
j E for all p ⩾0, which we will prove by mathematical
induction. Clearly it holds for p = 0. Suppose that it holds for
some value of p, then for p + 1 we have
Ap+1
j
E = AjAp
j E = (Ai −hijcT
ij )Ap
i E = Ap+1
i
E,
which proves the claim. Consequently, we have that ⟨Ai |
im E⟩= ⟨Aj | im E⟩, so we also have that
cT
ij ⟨Aj | im E⟩= {0}.
Moreover, if Xj shares a facet Fjk with some other region Xk as
well, then we see that
cT
jk⟨Aj | im E⟩= {0},
since cjk is a multiple of cij. By the same reasoning as above,
we see that ⟨Ak | im E⟩= ⟨Aj | im E⟩. By continuing this
argument from region to region, we ﬁnd that for all facets Fij
we have cT
ij ⟨Ai | im E⟩= {0} and ⟨Aj | im E⟩= ⟨Ai | im E⟩.
Hence, we conclude that V = ⟨Ai | im E⟩for any i ∈IN. As a
consequence, V is invariant under Ai for all i ∈IN.
On the other hand, suppose that cT
ij ⟨Ai | im E⟩̸= {0} for all
facets Fij. From Lemma 3.8 we know that hij ∈V for all facets.
45

3. disturbance decoupling for piecewise affine systems
Using Lemma 3.9, we see that also in this case V is invariant
under Ai for all i ∈IN.
Hence, in both cases V is invariant under all Ai. By Corol-
lary 3.7, system (3.6) is disturbance decoupled if and only if
V ⊆ker H.
■
Example 3.12 We consider the system as given in Example 3.2
and add a disturbance d:
d
dt


i
θ
ω

=


−R
L
0
−kb
L
0
0
1
0
0
−
Bf
J




i
θ
ω

+


0
0
g(y)

+ Ed (3.13a)
y = z =

1
0
0
 
i
θ
ω
T ,
(3.13b)
with E ∈Rnx×1 and g(y) as in (3.7). To illustrate the theory
developed in this section, we discuss whether this system is
disturbance decoupled for three choices for E: E1, E2 and E3,
where Ei is the ith column of the 3 × 3 identity matrix. First
note that the system satisﬁes the conditions in Corollary 3.11.
Hence, we only have to check if ∑3
k=1⟨Ak | im E⟩⊆ker H,
where Ak = A + FkC. For E2, we have ⟨Ak | im E⟩= im E ⊆
ker H for k = 1, 2, 3. Therefore, ∑3
k=1⟨Ak | im E⟩equals ker H,
implying that the system is disturbance decoupled. For E1, we
see that im E1 ̸⊆ker H, hence ∑3
k=1⟨Ak | im E⟩̸⊆ker H. For
E3, we have im E ⊆ker H, but ∑3
k=1⟨Ak | im E⟩= Rnx ̸⊆ker H.
Consequently, the system is not disturbance decoupled for both
E = E1 and E = E3.
3.5
state feedback
In this section, we discuss the problem of ﬁnding a state feed-
back law that renders a given piecewise afﬁne system distur-
bance decoupled. We consider the continuous piecewise afﬁne
system
˙x(t) = f (x(t)) + Ed(t) + Bu(t)
(3.14a)
z(t) = Hx(t),
(3.14b)
with x, d, z, E and H as before, u ∈Rnu the input, B ∈Rnx×nu,
and f : Rnx →Rnx a piecewise afﬁne function. Like before, the
function f admits a polyhedral subdivision {X1, X2, . . . , XN}
of Rnx. For each region Xk, there are matrices Ak and vectors
46

3.5 state feedback
gk such that f (x) = Akx + gk for all x ∈Xk. Using this, we can
write system (3.14) as
˙x(t) = Akx(t) + gk + Ed(t) + Bu(t)
∀x ∈Xk
(3.15a)
z(t) = Hx(t).
(3.15b)
In the rest of this section we will investigate conditions for
the existence of a mode-independent state feedback law that
renders system (3.15) disturbance decoupled.
We consider a mode-independent feedback law u = Kx, for
some matrix K ∈Rnu×nx. Applying such a feedback law to
system (3.15) results in the following closed-loop system
˙x(t) = (Ak + BK)x(t) + gk + Ed(t)
∀x ∈Xk
(3.16a)
z(t) = Hx(t).
(3.16b)
In view of Theorem 3.5 we see that system (3.16) is disturbance
decoupled if there is a subspace V that satisﬁes
(Ai + BK)V ⊆V,
∀i ∈IN
(3.17)
im E ⊆V ⊆ker H.
(3.18)
To investigate whether such a subspace with a corresponding
matrix K exists, we deﬁne the following set of subspaces:
V(H, {Ak}N
k=1, B) = {V ⊆ker H | ∃K ∈Rnu×nx
s.t. (Ak + BK)V ⊆V for all k ∈IN}.
It is easy to see that V ∈V(H, {Ak}N
k=1, B) if and only if
A1V ⊆V + im B and (Ai −Aj)V ⊆V for all i, j ∈IN. It
follows that the set V(H, {Ak}N
k=1, B) is closed under sub-
space addition. Thus we can deﬁne V∗(H, {Ak}N
k=1, B) to be the
largest element in V(H, {Ak}N
k=1, B). We observe that im E ⊆
V∗(H, {Ak}N
k=1, B) if and only if there is a subspace V satisfying
(3.17)-(3.18). Hence, we arrive at the following theorem.
Theorem 3.13 There exists a feedback law u = Kx that renders the
system (3.16) disturbance decoupled if
im E ⊆V∗(H, {Ak}N
k=1, B).
Remark 3.14 To compute V∗(H, {Ak}N
k=1, B), we refer to [Yurt-
seven et al., 2012, Algorithm 5.3].
47

3. disturbance decoupling for piecewise affine systems
Example 3.15 We extend on Example 1 and 2, by adding state
feedback in the form of applying a voltage v to the motor. This
results in the system
d
dt


i
θ
ω

=


−R
L
0
−kb
L
0
0
1
0
0
−
Bf
J




i
θ
ω

+


0
0
g(y)

+ Ed + Bu
(3.19a)
y = z =

1
0
0
 
i
θ
ω
T ,
(3.19b)
where we choose B = [1 0 0]T and E = [0 0 1]T. Then for
K = [0 0 kb/L], we have that (Ai + BK) ker H ⊆ker H for
i = 1, 2, 3, hence ker H ⊆V∗(H, {A1, A2, A3}, B). On the other
hand, V∗(H, {A1, A2, A3}, B) is contained in ker H. Therefore,
we have V∗(H, {A1, A2, A3}, B) = ker H. Since im E ⊆ker H,
we conclude that the feedback u = Kx renders the system
disturbance decoupled.
3.6
conclusions
In this paper, we established necessary conditions as well as
sufﬁcient conditions for a continuous piecewise afﬁne system
to be disturbance decoupled. These conditions do not coincide
in general. However, we identiﬁed a number of particular cases
for which they do coincide. Furthermore, we provided sufﬁ-
cient conditions for the existence of a mode-independent static
feedback controller that renders a given piecewise afﬁne system
disturbance decoupled. All presented conditions are geometric
in nature and can be easily veriﬁed by utilizing extensions of
the well-known subspace algorithms.
Further research possibilities include investigating the gap
between the necessary conditions and sufﬁcient conditions as
well as studying mode-dependent state feedback for distur-
bance decoupling.
In the next chapter we will study the disturbance decoupling
problem for a particular class of linear complementarity prob-
lems, which are closely related to the piecewise afﬁne systems
in this chapter.
48

4
D I S T U R BANCE DECOUPLED LINEAR
C O M P L E MENTARITY SYSTEMS
abstract:
In this chapter we study the disturbance decoupling problem for a
particular class of linear complementarity systems. We rewrite the linear complemen-
tarity system as a linear multi-modal system and provide crisp necessary and sufﬁcient
conditions for such a system to be disturbance decoupled. This chapter is based on the
book chapter [Everts and Camlibel, 2015], dedicated to Prof. Dr. Harry L. Trentelman
on the occasion of his sixtieth birthday.
4.1
introduction
In this chapter we study the disturbance decoupling problem
for a particular class of linear complementarity systems. Linear
complementarity systems are nonsmooth dynamical systems
that are obtained by taking a standard linear input/output
system and imposing certain complementarity relations on a
number of input/output pairs at each time instant. A wealth of
examples, from various areas of engineering as well as opera-
tions research, of linear complementarity systems can be found
in [Camlibel et al., 2004; Schumacher, 2004; van der Schaft and
Schumacher, 2000; Heemels and Brogliato, 2003]. For the work
on the analysis of linear complementarity systems, we refer to
[Camlibel et al., 2003; Heemels et al., 2002; Camlibel et al., 2002;
van der Schaft and Schumacher, 1996; Camlibel, 2007; van der
Schaft and Schumacher, 1998; Heemels et al., 2000].
Particular linear complementarity systems can be written
as linear multi-modal systems, namely those of index zero
[Camlibel, 2001, Chapter 2]. Different from the piecewise afﬁne
systems treated in Chapter 3, the resulting polyhedral regions
on which the modes are active, can now be non-solid, and
together they do not cover the full state space. The linear sub-
systems of a linear complementarity system share a certain
geometric structure. By exploiting this geometric structure, we
provide a necessary and sufﬁcient condition for disturbance
decoupledness that is crisp and easily checkable.
The structure of this chapter is as follows. In Section 4.2
we start with the formulation of the linear complementarity
problem, and introduce linear complementarity systems. In
49

4. disturbance decoupled lin. comp. systems
Section 4.3 we ﬁrst deﬁne what we mean by a linear comple-
mentarity system to be disturbance decoupled. After providing
some technical auxiliary results that are, in a way, of interest
themselves, we present a necessary and sufﬁcient condition
for disturbance decoupledness, which is the main result of
this chapter. Finally, the chapter closes with conclusions in
Section 4.4.
4.2
linear complementarity problem/system
The problem of ﬁnding a vector z ∈Rnz such that
z ⩾0
(4.1a)
q + Mz ⩾0
(4.1b)
zT(q + Mz) = 0
(4.1c)
for a given vector q ∈Rnz and a matrix M ∈Rnz×nz is known
as the linear complementarity problem. Here, the inequalities for
vectors are componentwise inequalities. We denote (4.1) by
LCP(q, M). It is well-known [Cottle et al., 1992, Thm. 3.3.7] that
the LCP(q, M) admits a unique solution for each q if and only if
all principal minors of M are positive. Such matrices are called
P-matrices in the literature of the mathematical programming.
It is well-known (see for instance [Cottle et al., 1992, Thm. 3.1.6
and Thm. 3.3.7]) that every positive deﬁnite matrix is in this
class.
When the matrix M is a P-matrix, the unique solution z(q)
of the LCP(q, M) depends on q in a Lipschitz continuous way.
In particular, for each q there exists an index set α ⊆Inz such
that the solution z = z(q) satisﬁes
zα ⩾0,
(q + Mz)α = 0,
zαc = 0,
(q + Mz)αc ⩾0,
or equivalently,
zα = −(Mαα)−1qα,
−(Mαα)−1qα ⩾0,
(4.2a)
zαc = 0,
qαc −Mαcα(Mαα)−1qα ⩾0,
(4.2b)
where αc denotes the set Inz \ α.
Linear complementarity systems (LCSs) are nonsmooth dy-
namical systems that are obtained in the following way. Take
a standard linear input/output system. Select a number of in-
put/output pairs (zi, wi), and impose for each of these pairs a
50

4.3 disturbance decoupled lcss
complementarity relation of the type (4.1) at each time instant.
In this chapter we will focus on the LCSs of the following form:
˙x(t) = Ax(t) + Bz(t) + Ed(t)
(4.3a)
w(t) = Cx(t) + Dz(t) + Fd(t)
(4.3b)
0 ⩽z(t) ⊥w(t) ⩾0
(4.3c)
y(t) = Jx(t).
(4.3d)
Here x ∈Rnx is the state, (z, w) ∈R2nz are the complementar-
ity variables, d ∈Rnd is the disturbance, y ∈Rny is the output,
⊥denotes orthogonality and all the matrices are of appropriate
sizes.
In the sequel we will work under the following blanket
assumptions:
1. The matrix D is a P-matrix.
2. The transfer matrix F + C(sI −A)−1E is right-invertible
as a rational matrix.
Since D is a P-matrix, z(t) is a piecewise linear function of
Cx(t) + Fd(t) (see e.g. [Cottle et al., 1992]). This means that for
each initial state x0 and locally-integrable disturbance d there
exist unique absolutely continuous trajectories (xx0,d, yx0,d) and
locally-integrable trajectories (zx0,d, wx0,d) such that xx0,d(0) =
x0 and the quadruple (xx0,d, zx0,d, wx0,d, yx0,d) satisﬁes the rela-
tions (4.3) for almost all t ⩾0.
Although LCSs are nonsmooth and nonlinear, their local
linear behavior enables elegant characterizations of certain
system-theoretic properties. In the next section we will study
the disturbance decoupling problem for LCSs.
4.3
disturbance decoupled lcss
We say that an LCS (4.3) is disturbance decoupled if for all initial
states x0 and all locally integrable disturbances d1 and d2 we
have
yx0,d1(t) = yx0,d2(t),
∀t ⩾0.
In this section, we will investigate necessary and sufﬁcient
conditions for an LCS (4.3) to be disturbance decoupled. To do
so, we ﬁrst derive an alternative representation of an LCS. This
representation is closely related to the piecewise afﬁne systems
51

4. disturbance decoupled lin. comp. systems
in Chapter 3 and makes the underlying switching behavior
more transparent.
Since D is a P-matrix, we can solve the LCP given by (4.3c)
by employing (4.2). To simplify notation later on, we ﬁrst deﬁne
the following matrices for a given index set α ⊆Inz:
Nα = −B•α(Dαα)−1Iα•
(4.4)
Aα = A + NαC
(4.5)
Eα = E + NαF
(4.6)
Gα =

−(Dαα)−1Cα•
Cαc• −Dαcα(Dαα)−1Cα•

(4.7)
Hα =

−(Dαα)−1Fα•
Fαc• −Dαcα(Dαα)−1Fα•

,
(4.8)
where a subscript αβ selects rows α and columns β of a matrix,
for given index sets α and β. Furthermore, the • means selecting
all rows or columns and αc denotes the complement of α in Inz.
If the quadruple (x, d, z, w) satisﬁes (4.3a)-(4.3c) for almost
all t ⩾0 then for almost all t ⩾0 there exists an index set
αt ⊆Inz such that
˙x(t) = Aαtx(t) + Eαtd(t) when

Gαt
Hαt
 x(t)
d(t)

⩾0. (4.9)
The resulting system (4.9) is a linear multi-modal system. Dif-
ferent from the piecewise afﬁne systems in Chapter 3, the
underlying polyhedral regions are not all solid and their union
is not equal to Rnx. However, the linear subsystems of (4.9)
share a certain geometric structure, which we will exploit to
prove the following auxiliary result concerning the subspace
∑γ⊆Inz ⟨Aγ | im Eγ⟩, which plays an important role in the
disturbance decoupling problem later on.
Lemma 4.1 Let S = ∑γ⊆Inz ⟨Aγ | im Eγ⟩. The following state-
ments hold:
1. im (Nα −Nβ) ⊆S for any α, β ⊆Inz.
2. S is invariant under Aα for any α ⊆Inz.
3. S = ⟨A | im

B
E
⟩.
Proof. To prove the ﬁrst statement, let Σγ denote the linear
system Σ(Aγ, Eγ, C, F) for γ ⊆Inz. It follows from (1.7) that
T ∗(Σγ) ⊆⟨Aγ | im Eγ⟩⊆S.
52

4.3 disturbance decoupled lcss
Then, we have
(A + NγC)T ∗(Σγ) = (A + NγC)⟨Aγ | im Eγ⟩
⊆⟨Aγ | im Eγ⟩⊆S.
Let eΣ denote the linear system Σ(A, E, C, F). It follows from
(1.6) that T ∗(Σγ) = T ∗(eΣ) and hence that
(A + NγC)T ∗(eΣ) ⊆S
for any γ ⊆Inz. This yields
(Nα −Nβ)CT ∗(eΣ) ⊆S
(4.10)
for any α, β ⊆Inz. Also we have
im (E + NγF) ⊆⟨Aγ | im Eγ⟩⊆S
for any γ ⊆Inz. Thus, we get
(Nα −Nβ)im F ⊆S.
By combining the last relation with (4.10), we obtain
(Nα −Nβ)
 im F + CT ∗(eΣ)
 ⊆S.
Since the transfer matrix F + C(sI −A)−1E is right-invertible
as a rational matrix, it follows from (1.9) that im F + CT ∗(eΣ) =
Rny. Therefore, we have
im (Nα −Nβ) ⊆S.
To prove the second statement, let α, γ ⊆Inz. Note that
Aα⟨Aγ | im Eγ⟩⊆Aγ⟨Aγ | im Eγ⟩+ im (Aα −Aγ)
⊆⟨Aγ | im Eγ⟩+ im (Nα −Nγ).
It follows from the deﬁnition of S and the ﬁrst statement that
Aα⟨Aγ | im Eγ⟩⊆S.
Hence, we have
AαS ⊆Aα
  ∑
γ⊆Inz
⟨Aγ | im Eγ⟩

⊆∑
γ⊆Inz
Aα⟨Aγ | im Eγ⟩⊆S.
53

4. disturbance decoupled lin. comp. systems
To prove the third statement, note ﬁrst that im Nγ ⊆im B
for any γ ⊆Inz. Hence, we have
im Eγ = im (E + NγC) ⊆im

B
E

.
This results in
⟨Aγ | im Eγ⟩⊆⟨Aγ | im

B
E
⟩
(4.11)
for any γ ⊆Inz. Since Aγ = A + NγC and im Nγ ⊆im B, it
follows from (1.3) that
⟨Aγ | im

B
E
⟩= ⟨A | im

B
E
⟩.
In view of (4.11), this means that
⟨Aγ | im Eγ⟩⊆⟨A | im

B
E
⟩
for any γ ⊆Inz. Consequently, we obtain
S = ∑
γ⊆Inz
⟨Aγ | im Eγ⟩⊆⟨A | im

B
E
⟩.
(4.12)
It follows from the fact that ⟨Aγ | im Eγ⟩⊆S and that
⟨A | im E⟩⊆S
⟨A −BD−1C | im (E −BD−1F)⟩⊆S
for the particular choices γ = ∅and γ = Inz, respectively. We
know from (1.6) that the strongly reachable subspaces of the
systems Σ(A, E, C, F) and Σ(A −BD−1C, E −BD−1F, C, F) co-
incide. Let T ∗denote this common strongly reachable subspace.
It follows from (1.7) that
T ∗⊆⟨A | im E⟩⊆S
T ∗⊆⟨AInz | im EInz ⟩⊆S.
These inclusions yield
AT ∗⊆A⟨A | im E⟩⊆⟨A | im E⟩⊆S
AInz T ∗⊆AInz ⟨Inz | im EInz ⟩⊆⟨AInz | im EInz ⟩⊆S.
Using A −AInz = BD−1C, we can conclude that
BD−1CT ∗⊆S.
(4.13)
On the other hand, we readily have
im E ⊆⟨A | im E⟩⊆S
im(E −BD−1F) ⊆⟨A−BD−1C | im (E −BD−1F)⟩⊆S.
54

4.3 disturbance decoupled lcss
Combining these two inclusions results in
BD−1im F ⊆S.
Together with (4.13), this implies that
BD−1(im F + CT ∗) ⊆S.
It follows from the blanket assumption and (1.9) that
im F + CT ∗= Rny.
Thus, we get
im B ⊆S.
From the second statement of Lemma 4.1, we know that the
subspace S is Aα-invariant for any α ⊆Inz. In particular, the
choice of α = ∅implies that S is A-invariant. Since ⟨A | im B⟩
is the smallest A-invariant subspace that contains im B, we
have
⟨A | im B⟩⊆S.
(4.14)
As we readily have
⟨A | im E⟩⊆S,
the inclusion (4.14) implies that
⟨A | im B⟩+ ⟨A | im E⟩= ⟨A | im

B
E
⟩⊆S.
Together with (4.12), this proves that
S = ⟨A | im

B
E
⟩.
■
Now we are ready to present necessary and sufﬁcient condi-
tions for an LCS to be disturbance decoupled.
Theorem 4.2 An LCS of the form (4.3) is disturbance decoupled if
and only if
⟨A | im

B
E
⟩⊆ker J.
Proof. Necessity: Let γ ⊆Inz. Note that

Gγ
Hγ
 =

−(Dγγ)−1
0
−Dγcγ(Dγγ)−1
I
  Cγ•
Fγ•
Cγc•
Fγc•

. (4.15)
55

4. disturbance decoupled lin. comp. systems
Since F + C(sI −A)−1E is right-invertible as a rational matrix
by the blanket assumption, [C F] is of full row rank. So must
be the matrix [Gγ Hγ] due to (4.15). Then, one can ﬁnd x0 and
d such that

Gγ
Hγ
 x0
d

> 0.
Let e ∈Rnz. Clearly, there exists a sufﬁciently small µ > 0 such
that

Gγ
Hγ
 
x0
d + µe

> 0.
Now deﬁne
d1(t) = d
and
d2(t) = d + µe
for all t ⩾0. Let xi(t) denote the trajectory xx0,di(t) for i = 1, 2.
Since xi and di are continuous, there exists an ϵ > 0 such that

Gγ
Hγ
 xi(t)
di(t)

> 0
holds for all t ∈[0, ϵ). Thus, the trajectories x1 and x2 satisfy
˙xi(t) = Aγxi(t) + Eγdi(t)
for all t ∈[0, ϵ) and i = 1, 2. As the system is disturbance
decoupled, we have that
Jx1(t) = Jx2(t)
for all t ∈[0, ϵ). Since d1 and d2 are constant, we obtain
J(Aγx0 + Eγd) = J
 Aγx0 + Eγ(d + µe)

by differentiating and evaluating at t = 0. This results in
JEγe = 0.
By repeating the differentiation and evaluation at t = 0, we get
JAk
γEγe = 0
for all k ⩾0. Since e is arbitrary, we have
JAk
γEγ = 0
56

4.3 disturbance decoupled lcss
for all k ⩾0. Consequently, one gets
⟨Aγ | im Eγ⟩⊆ker J.
Thus, we have
∑
γ⊆Inz
⟨Aγ | im Eγ⟩⊆ker J.
It follows from the third statement of Lemma 4.1 that
⟨A | im

B
E
⟩⊆ker J.
Sufﬁciency: It is enough to show that
xx0,d1(t) −xx0,d2(t) ∈⟨A | im

B
E
⟩,
∀t ⩾0
for any initial state x0 ∈Rnx and all locally-integrable distur-
bances d1 and d2. To do so, let V := ⟨A | im

B
E
⟩and let
v ∈V⊥. From (4.3a), we have
vT  ˙xx0,d1(t) −˙xx0,d2(t)
 = vTA
 xx0,d1(t) −xx0,d2(t)

(4.16)
for almost all t ⩾0. Deﬁne
ζ(t) := vT xx0,d1(t) −xx0,d2(t)

.
From (4.16) and AT-invariance of V⊥, we get
dkζ
dtk (t) = vTAk xx0,d1(t) −xx0,d2(t)

for k ⩾0. The Cayley-Hamilton theorem implies that there
exist real numbers ci with i = 0, 1, . . . , n −1 such that
dnxζ
dtnx (t) + cnx−1
dnx−1ζ
dtnx−1 (t) + · · · + c1
dζ
dt (t) + c0ζ(t) = 0.
Since
dkζ
dtk (0) = 0
for k ⩾0, we get ζ(t) = 0 for all t ⩾0. Consequently, we have
xx0,d1(t) −xx0,d2(t) ∈(V⊥)⊥= V = ⟨A | im

B
E
⟩
which completes the proof.
■
57

4. disturbance decoupled lin. comp. systems
4.4
conclusions
In this chapter we studied a class of nonsmooth and nonlinear
dynamical systems, namely linear complementarity systems of
index zero. These systems belong to the larger family of linear
multi-modal systems, and are closely related to the piecewise
afﬁne dynamical systems in Chapter 3, for which the distur-
bance decoupling problem has already been solved. In this
chapter we have shown that the linear subsystems of a linear
complementarity system share certain geometric structure. By
exploiting this geometric structure, we provided a necessary
and sufﬁcient condition for a linear complementarity system
to be disturbance decoupled. Compared to the conditions for
general piecewise afﬁne systems in Chapter 3, this condition is
crisper and more insightful.
Future research possibilities are weakening the technical blan-
ket assumptions and studying disturbance decoupling prob-
lem under different feedback schemes. In the next chapter we
will study the disturbance decoupling problem for a general
class of linear multi-modal systems, and as a special case we
study another class of linear complementarity systems, namely
passive-like LCSs.
58

5
D I S T U R BANCE DECOUPLED LINEAR
M U LT I - MODAL SYSTEMS
abstract: In this chapter we introduce the general framework of linear multi-modal
systems and study the question under which conditions such a system is disturbance de-
coupled. We establish necessary conditions and sufﬁcient conditions, both geometric in
nature, from which almost all existing results on disturbance decoupledness for bimodal
systems (Chapter 2), conewise linear systems (Chapter 3), linear complementarity
systems of index zero (Chapter 4) and a particular class of switched linear systems can
be recovered as special cases. Furthermore, we use this result to ﬁnd novel conditions
for disturbance decoupledness of a class of passive-like linear complementarity systems.
This chapter is based on the journal paper [Everts and Camlibel, 2016], dedicated to
the memory of J.C. Willems.
5.1
introduction
Annihilating or reducing the effects of disturbances is of major
importance virtually in every real-life control problem. Design-
ing feedback laws that decouple the disturbances from a certain
to-be-controlled output constitute the well-known disturbance
decoupling problem. The study of this problem for linear sys-
tems led to the development of geometric control theory [Basile
and Marro, 1969a,b; Wonham and Morse, 1970] which provided
solutions to numerous control problems as well as a deep un-
derstanding of the dynamics of linear systems [Wonham, 1985;
Basile and Marro, 1992; Trentelman et al., 2001] and (smooth)
nonlinear systems [Nijmeijer and van der Schaft, 1990; Isidori,
1995].
In this chapter, we focus on a class of hybrid dynamical
systems and provide necessary and sufﬁcient geometric con-
ditions under which these systems are disturbance decoupled.
Within the hybrid systems, the results on disturbance decou-
pling problem so far are limited to jumping hybrid systems
[Conte et al., 2015], switched linear systems [Conte et al., 2014;
Otsuka, 2010, 2011, 2015; Yurtseven et al., 2012; Zattoni et al.,
2016; Zattoni and Marro, 2013], bimodal linear systems (Chap-
ter 2), continuous piecewise afﬁne systems 3 and a class of
linear complementarity systems of index zero (Chapter 4). The
results presented in these papers and chapters very much re-
59

5. disturbance decoupled linear multi-modal systems
semble those for the linear systems although their derivation is
much harder, in particular, in the presence of state-dependent
switching.
Within this chapter, we try to generalize these results by intro-
ducing the general framework of linear multi-modal systems,
which contains the so-called conewise linear systems, linear
complementarity systems [Heemels, 1999; Camlibel, 2001], and
a particular class of switched linear systems [Sun and Ge, 2005;
Liberzon, 2003] (as well as combinations of these) as particular
cases. Later, we investigate necessary and sufﬁcient conditions
for a general linear multi-modal system to be disturbance de-
coupled. In addition, we show that almost all the existing re-
sults for the hybrid systems mentioned above can be recovered
from the presented results as special cases.
Furthermore, we study a class of passive-like linear comple-
mentarity systems in detail in order to ﬁnd novel necessary and
sufﬁcient conditions for this kind of systems to be disturbance
decoupled.
The organization of this chapter is as follows. We introduce
the framework of general linear multi-modal systems in Sec-
tion 5.2 and discuss a few special cases. In Section 5.3 we deﬁne
the property of being disturbance decoupled for a linear multi-
modal system. We present our main results in Theorem 5.8
and in Theorem 5.9, which give a necessary condition and a
sufﬁcient condition for a linear multi-modal system to be distur-
bance decoupled. In Corollary 5.11 we show that in some cases
these conditions coincide. We apply these results in Section 5.4
to the special cases introduced in Section 5.2. For one type of
linear complementarity systems, this will lead to novel results,
stated in Theorem 5.14. The chapter closes with the conclusions
and discussions of possible future work in Section 5.5.
5.2
linear multi-modal systems
In this chapter we consider linear multi-modal systems given
by the differential inclusion
˙x(t) ∈Ax(t) + Ed(t) + Φ(y(t))
(5.1a)
y(t) = Cx(t) + Fd(t)
(5.1b)
z(t) = Jx(t)
(5.1c)
where x is the state, d is the disturbance, y is the selection
output, z is the to-be-controlled output, A, C, E, F and J are
60

5.2 linear multi-modal systems
matrices of appropriate sizes and Φ : Rny →Rnx is a set-valued
map satisfying
Φ(y) = {Miy | i ∈I s.t. y ∈Yi},
where I is a ﬁnite index set, {Yi}i∈I is a collection of cones in
Rny, and {Mi}i∈I is a collection of nx × ny matrices. The cones
Yi are not necessarily solid (i.e., ny-dimensional). Moreover, the
cones may overlap and their union does not have to be equal to
Rny. Without loss of generality we can assume that the matrix

C
F

has full row rank.
Let T > 0. For a given initial state x0 and an integrable
disturbance d we call an absolutely continuous function x :
[0, T) →Rnx a solution on [0, T) of system (5.1) if (5.1a) holds
for almost all t ∈[0, T) and x(0) = x0. If T = +∞, we simply
say that x is a (complete) solution of (5.1). In the sequel, we will
allow multiple solutions for a given initial state and disturbance
but make two assumptions regarding the existence of solutions.
The ﬁrst assumption we make is that local solutions can be
extended to complete solutions.
Assumption 5.1 If the system (5.1) admits a local solution xT
on [0, T) for some T > 0, initial state x0, and disturbance d,
then there exists a complete solution x for the same initial state
x0 and disturbance satisfying x(t) = xT(t) for all t ∈[0, T).
The second assumption regarding the existence of solutions
requires that the disturbances are not restricted by the dynamics
of the system.
Assumption 5.2 If the system (5.1) admits a complete solution
for some initial state and disturbance, then there exists a com-
plete solution for the same initial state and for any disturbance.
Later on, we will elaborate on these assumptions when we
discuss speciﬁc classes of systems that fall into the framework
of (5.1).
We say that an initial state is feasible if for all locally integrable
disturbances d there exists a complete solution of (5.1). The set
of all feasible states will be denoted by X0.
To simplify the notation, we deﬁne
Ai = A + MiC,
Ei = E + MiF
(5.2)
61

5. disturbance decoupled linear multi-modal systems
and rewrite system (5.1) as
˙x(t) ∈{Aix(t) + Eid(t) | i ∈I s.t. y(t) ∈Yi}
(5.3a)
y(t) = Cx(t) + Fd(t)
(5.3b)
z(t) = Jx(t).
(5.3c)
We will work mainly with this form of the linear multi-modal
system in the rest of the chapter.
Examples of systems that fall into this framework include
switched linear systems, conewise linear systems, and linear
complementarity problems, which we discuss next.
Example 5.3 (Switched Linear Systems) We consider the fol-
lowing particular class of linear switched systems
˙x(t) = Aσ(t)x(t) + Eσ(t)d(t)
(5.4a)
z(t) = Jx(t),
(5.4b)
where σ is a switching signal from R⩾0 to a ﬁnite index set I.
By taking A = Aj and E = Ej for some j ∈I, we can rewrite
(5.4) in the form of a multi-modal system as
˙x(t) ∈Ax(t) + Ed(t) + Φ(y)
(5.5a)
y(t) = col(x(t), d(t)),
(5.5b)
z(t) = Jx(t),
(5.5c)
with
Φ(y) = {

Ai −A
Ei −E

y | i ∈I s.t. y ∈Yi}
and Yi = Rnx for all i. Note that Assumptions 5.1 and 5.2
naturally hold for switched linear systems and X0 = Rnx.
Example 5.4 (Conewise Linear Systems) We say that a contin-
uous function Φ : Rny →Rnx is conewise linear if there exist a
ﬁnite family of solid polyhedral cones {Yi}i∈I with ∪i∈IYi =
Rny and nx × ny matrices {Mi}i∈I such that g(y) = Miy for
y ∈Yi.
Consider systems of the form
˙x(t) = Ax(t) + Ed(t) + Φ(y(t))
(5.6a)
y(t) = Cx(t) + Fd(t)
(5.6b)
z(t) = Jx(t)
(5.6c)
62

5.2 linear multi-modal systems
where Φ : Rny →Rnx is a continuous conewise linear function.
These systems will be called conewise linear systems (CLS) and
were studied in [Camlibel et al., 2006; Arapostathis and Broucke,
2007; Camlibel et al., 2008]. CLSs can be seen as a special case
of piecewise afﬁne systems (Chapter 3) and fall naturally into
the framework of (5.1). As the union of the (solid) cones Yi
is the entire Rny, Assumptions 5.1 and 5.2 are satisﬁed and
X0 = Rnx.
Example 5.5 (Complementarity Systems) We consider the lin-
ear complementarity system (LCS)
˙x(t) = Ax(t) + Ed(t) + Gζ(t)
(5.7a)
η(t) = Nx(t) + Rd(t) + Hζ(t)
(5.7b)
0 ⩽ζ(t) ⊥η(t) ⩾0
(5.7c)
z(t) = Jx(t),
(5.7d)
where ζ, η ∈Rnη are the so-called complementarity variables
and all involved matrices are of appropriate dimensions.
Here, the inequalities for vectors are componentwise inequal-
ities and ⊥denotes orthogonality. Linear complementarity
systems are encountered in applications from various areas of
engineering as well as operations research [van der Schaft and
Schumacher, 2000; Heemels and Brogliato, 2003; Schumacher,
2004; Vasca et al., 2009]. For the work on the analysis and con-
trol of linear complementarity systems, we refer to [Heemels
et al., 2000, 2002; Camlibel et al., 2002, 2003; Camlibel, 2007;
Han et al., 2009; Heemels et al., 2011; Camlibel et al., 2014].
In this chapter, we focus on two particular classes of lin-
ear complementarity systems that were heavily studied in the
literature:
1. H is a P-matrix, that is a matrix whose principal minors
are all positive (see e.g. [Cottle et al., 1992]).
2. R = 0, H = 0, and NG is a symmetric positive deﬁnite
matrix.
In what follows we will brieﬂy derive the corresponding
linear multi-modal systems for these two cases by skipping
technical details for which we refer to [Heemels et al., 2000] for
the ﬁrst case and [Camlibel et al., 2014] for the second.
63

5. disturbance decoupled linear multi-modal systems
In the case that H is a P-matrix, the LCS (5.7) is of index zero
and boils down to the multi-modal system
˙x(t) ∈{Aαx(t) + Eαd(t) | α ∈I s.t. y(t) ∈Yα}
(5.8a)
y(t) = Cx(t) + Fd(t)
(5.8b)
z(t) = Jx(t)
(5.8c)
where I is the set of all subsets of Inη = {1, 2, . . . , nη}, and
C = N
F = R
Aα = A −G•α
 Hαα
−1Nα•
Eα = E −G•α
 Hαα
−1Nα•
Yα = {y ∈Rnη |

−(Hαα)−1Iα•
Iαc• −Hαcα(Hαα)−1Iα•

y ⩾0}.
Note that in the above on the left-hand side the subscript α is
used as an index, whereas on the right-hand side the subscript
αβ selects rows α and columns β of a matrix, for given index
sets α and β. Here, the • means selecting all rows or columns
and αc denotes the complement of α in Inη.
In the case that R = 0, H = 0, and NG is a symmetric positive
deﬁnite matrix, the LCS (5.7) is passiﬁable by pole-shifting (see
Deﬁnition 3.4.2 in [Camlibel, 2001] and [Camlibel et al., 2014])
and boils down to the multi-modal system (5.8) where α ⊆Inη
and
C =
 N
NA

F =
 0
NE

Aα = A −G•α(Nα•G•α)−1Nα•A
Eα = E −G•α(Nα•G•α)−1Nα•E
Yα = {y ∈R2nη |
Iαc•
0
0
−(Nα•G•α)−1Iα•

y ⩾0,

Iα•
0

y = 0}.
For both cases, Assumptions 5.1 and 5.2 are satisﬁed [Heemels
et al., 2000; Camlibel et al., 2014]. We have X0 = Rnx (see e.g.
[Heemels et al., 2000]) in case H is a P-matrix and X0 = {x0 |
Cx0 ⩾0} for the second case (see e.g. [Camlibel et al., 2014]).
64

5.3 disturbance decoupled systems
5.3
disturbance decoupled systems
We start with the following deﬁnition of a disturbance decou-
pled system.
Deﬁnition 5.6 We say that system (5.3) is disturbance decoupled
if for any given feasible initial state x0 ∈X0 and any two so-
lutions (x1(t), y1(t), z1(t)) and (x2(t), y2(t), z2(t)), correspond-
ing to any two locally integrable disturbances d1(t) and d2(t)
respectively, satisfy
z1(t) = z2(t)
for all t ⩾0.
In this chapter we investigate when system (5.3) is distur-
bance decoupled. Throughout the chapter we assume the fol-
lowing.
Assumption 5.7 For each i ∈I, the cone Yi and the subspace
im F + C⟨Ai | im Ei⟩satisfy
i. im F + C⟨Ai | im Ei⟩⊆span(Yi),
ii.
 im F + C⟨Ai | im Ei⟩
 ∩rint(Yi) ̸= ∅, or Yi is solid.
The ﬁrst assumption is trivial when each cone Yi is solid. A
consequence of this assumption is that im F ⊆∩i∈I span(Yi).
The second assumption assures a certain ‘liveliness’ of each
cone Yi; for every cone Yi there exist a point x0 and a locally
integrable disturbance d(t) such that yx0,d(t) stays in rint(Yi)
for some time t. If F + C(sI −A)−1E is right invertible, using
(1.9), (1.6), and (1.7), one can see that im F + C⟨Ai | im Ei⟩=
Rny, which implies the second assumption.
A necessary condition for a linear multi-modal system to be
disturbance decoupled is stated in the following theorem.
Theorem 5.8 If a linear multi-modal system of the form (5.3), sat-
isfying Assumptions 5.1, 5.2 and 5.7, is disturbance decoupled, then
∑
i∈I
⟨Ai | im Ei⟩⊆ker J.
(5.9)
Proof. Fix i ∈I. Since

C
F

is of full row rank, there exist an
x0 ∈Rnx and a d ∈Rnd such that
y0 := Cx0 + Fd ∈rint(Yi).
65

5. disturbance decoupled linear multi-modal systems
If the ﬁrst condition in Assumption 5.7 holds, then we can even
pick x0 ∈⟨Ai | im Ei⟩. Consider the solution ( ˜x(t), ˜y(t)) of the
following linear system
˙˜x(t) = Ai ˜x(t) + Eid(t)
(5.10a)
˜y(t) = C ˜x(t) + Fd(t),
(5.10b)
where d(t) = d and with ˜x(0) = x0. If Yi is solid, then the
continuity of ˜y(t) implies that there exists an ε > 0 such that
˜y(t) ∈rint(Yi) for all t ∈[0, ε]. In the case that we have x0 ∈
⟨Ai | im Ei⟩, we see that ˜x(t) ∈⟨Ai | im Ei⟩for all t ⩾0. Hence,
by Assumption 5.7(i),
˜y(t) ∈im F + C⟨Ai | im Ei⟩⊆span(Yi)
for all t ⩾0. Since ˜y(t) is continuous, and ˜y(0) = y0 ∈rint(Yi),
it follows that there again exists an ε > 0 such that ˜y(t) ∈
rint(Yi) for all t ∈[0, ε].
Let e be any vector in Rnd, then we have
Cx0 + F(d + µe) = y0 + Fµe ∈span(Yi),
for any µ ∈R, since im F ⊆span(Yi) by Assumption 5.7(i).
By taking |µ| sufﬁciently small, we have Cx0 + F(d + µe) ∈
rint(Yi). Let ˜xe(t) be the solution of (5.10) for the constant
disturbance de(t) = d + µe and initial condition ˜xe(0) = x0,
with corresponding output ˜ye(t). For ˜ye(t) there is an εe > 0
such that ˜ye(t) ∈rint(Yi) for t ∈[0, εe].
Let ε∗= min(ε, εe). Due to Assumption 5.1, we can extend
˜x(t) and ˜xe(t) from t = ε∗onwards to obtain complete solutions
x(t) and xe(t) of system (5.3), with corresponding outputs
(y(t), z(t)) and (ye(t), ze(t)), respectively. Moreover, x0 ∈X0
due to Assumption 5.2.
Since system (5.3) is disturbance decoupled, we have that
z(t) −ze(t) = J(x(t) −xe(t)) = 0
(5.11)
for all t ⩾0. Since d(t) and de(t) are constant, we can differen-
tiate (5.11) repeatedly and evaluate at t = 0 to obtain
JAk
i Eiµe = 0
for all k ⩾0. Since this holds for all e ∈Rnd, we have JAk
i Ei = 0
for all k. Consequently, by (1.2), we have ⟨Ai | im Ei⟩⊆ker J.
As this holds for all i ∈I, we can conclude that (5.9) holds. ■
66

5.3 disturbance decoupled systems
Next we give a sufﬁcient condition for a linear multi-modal
system to be disturbance decoupled. For this purpose, we
deﬁne the subspaces
A := ∑
i,j∈I
im(Aj −Ai),
E := ∑
i
im Ei.
(5.12)
Theorem 5.9 If there is a subspace V ⊆ker J such that AiV ⊆V
for each i ∈I, E ⊆V and A ⊆V, then the linear multi-modal
system (5.3) satisfying Assumption 5.7 is disturbance decoupled.
Proof. Let x0 ∈X0 be any given feasible initial state, and let
nv = dim V. Furthermore, let {ξ1, ξ2, . . . , ξnx} be a basis for
Rnx such that {ξ1, ξ2, . . . , ξnv} forms a basis for V. With respect
to these coordinates, we can write every x ∈Rnx uniquely
as x = col(v, w) for some v ∈Rnv and w ∈Rnx−nv such
that col(v, 0) ∈V. Since V is Ai-invariant for each i ∈I and
E ⊆V ⊆ker J, with respect to the new coordinates we have
Ai =
Ai
11
Ai
12
0
Ai
22

,
Ei =
Ei
1
0

,
J =

0
J2

,
for every i ∈I, where Ai
11 ∈Rnv×nv, Ei
1 ∈Rnv×nd and J2 ∈
R(nx−nv)×nx. Let x0 = col(v0, w0), and let d(t) be any locally
integrable disturbance. Write x(t) = col(v(t), w(t)), then v(t)
and w(t) satisfy
˙v(t) ∈{Ai
11v(t) + Ai
12w(t) + Ei
1d(t) |
for i ∈I s.t. C
v(t)
w(t)

+ Fd(t) ∈Yi}
˙w(t) = Ai
22w(t)
z(t) = J2w(t)
for almost all t, with v(0) = v0 and w(0) = w0. Since im(Aj −
Ai) ⊆V for all i, j ∈I, we have Ai
22 = Aj
22 for all i, j ∈I.
Therefore, w(t) will satisfy the linear differential equation
˙w(t) = Ai
22w(t),
w(0) = w0
for any ﬁxed i ∈I and almost all t. We see that w(t) does
not depend on the disturbance d(t). Since the output z satisﬁes
z(t) = J2w(t), we see that z does not depend on the disturbance
either. Hence, system (5.3) is disturbance decoupled.
■
The subspace ∑i∈I⟨Ai | im Ei⟩plays an important role in
our main results. Although each subspace ⟨Aj | im Ej⟩is in-
variant under Aj, their sum ∑i∈I⟨Ai | im Ei⟩is not necessarily
67

5. disturbance decoupled linear multi-modal systems
invariant under each Aj, so it is not always possible to use
∑i∈I⟨Ai | im Ei⟩as the subspace V in Theorem 5.9. In the next
lemma we give some conditions under which the subspace
∑i∈I⟨Ai | im Ei⟩is Ai-invariant for each i ∈I and has a more
compact form.
Lemma 5.10 Let Ai and Ei satisfy (5.2). The subspace ∑i∈I⟨Ai |
im Ei⟩is Aj-invariant and satisﬁes
∑
i∈I
⟨Ai | im Ei⟩= ⟨Aj | A + E⟩
(5.13)
for each j ∈I if one of the following conditions holds:
i. A ⊆∑i∈I⟨Ai | im Ei⟩,
ii. im(Mj −Mi) ⊆∑i∈I⟨Ai | im Ei⟩for all i, j ∈I,
iii. (Mj −Mi)(im F + CT ∗(A, E, C, F)) = im(Mj −Mi) for
all i, j ∈I,
iv. F + C(sI −A)−1E is right invertible.
Proof. We will prove this lemma by showing that iv. ⇒iii. ⇒
ii. ⇒i. ⇒(5.13). Deﬁne
V := ∑
i∈I
⟨Ai | im Ei⟩,
T ∗:= T ∗(A, E, C, F).
(iv. ⇒iii.) If F + C(sI −A)−1E is right invertible, then using
(1.9) we ﬁnd that im F + CT ∗= Rny, which implies the third
condition.
(iii. ⇒ii.) From (1.6), we see that the subspace T ∗satisﬁes
T ∗= T ∗(Ai, Ei, C, F) for each i ∈I. Using (1.7) this gives us
T ∗⊆⟨Ai | im Ei⟩,
for each i ∈I, which implies
AiT ∗⊆Ai⟨Ai | im Ei⟩⊆⟨Ai | im Ei⟩⊆V.
Furthermore, we have that
im Ei ⊆⟨Ai | im Ei⟩⊆V
for all i in I. This yields
(Mj −Mi)CT ∗= (Aj −Ai)T ∗⊆V
im(Mj −Mi)F = im(Ej −Ei) ⊆V
68

5.3 disturbance decoupled systems
for any i, j ∈I. Together, this gives us
(Mj −Mi)(im F + CT ∗) ⊆V.
From the third condition it follows that im(Mj −Mi) ⊆V for
all i, j ∈I.
(ii. ⇒i.) This follows from the fact that im(Aj −Ai) =
im(Mj −Mi)C ⊆im(Mj −Mi).
(i. ⇒(5.13)) For any i, j ∈I we have
Aj⟨Ai | im Ei⟩⊆Ai⟨Ai | im Ei⟩
+ (Aj −Ai)⟨Ai | im Ei⟩
⊆⟨Ai | im Ei⟩+ im(Aj −Ai)
⊆V,
where we used A ⊆V in the last step. Hence, we see that
AjV = Aj(∑
i∈I
⟨Ai | im Ei⟩)
⊆∑
i∈I
Aj⟨Ai | im Ei⟩⊆V,
thus V is Aj-invariant for every j ∈I. Since im Ei ⊆V for all i ∈
I it follows that E ⊆V, and hence A + E ⊆V. Consequently,
⟨Aj | A + E⟩⊆V,
(5.14)
since ⟨Aj | A + E⟩is the smallest Aj-invariant subspace con-
taining A + E.
For the other inclusion, note that
Ai⟨Aj | A + E⟩⊆Aj⟨Aj | A + E⟩
+ (Ai −Aj)⟨Aj | A + E⟩
⊆⟨Aj | A + E⟩+ A
⊆⟨Aj | A + E⟩,
which means that ⟨Aj | A + E⟩is Ai-invariant for all i ∈
I. Furthermore, we have im Ei ⊆⟨Aj | A + E⟩for each i ∈
I. Since ⟨Ai | im Ei⟩is the smallest Ai-invariant subspace
containing im Ei, we see that
⟨Ai | im Ei⟩⊆⟨Aj | A + E⟩,
69

5. disturbance decoupled linear multi-modal systems
for each i ∈I, and hence V ⊆⟨Aj | A + E⟩. Together with
(5.14) this completes the proof.
■
If one of the conditions in Lemma 5.10 is satisﬁed, we can
combine Theorems 5.8 and 5.9 to obtain the following necessary
and sufﬁcient conditions for system (5.3) to be disturbance
decoupled.
Corollary 5.11 Assume that Assumptions 5.1, 5.2, and 5.7 are sat-
isﬁed. If one of the conditions in Lemma 5.10 holds, then the linear
multi-modal system (5.3) is disturbance decoupled if and only if
⟨Aj | A + E⟩⊆ker J,
for every j ∈I.
5.4
special classes of systems
In this section we revisit the examples discussed in Section 5.2
and apply Theorem 5.8, Theorem 5.9, and Corollary 5.11 to
these systems. For the linear complementarity problem with
R = 0, H = 0, and NG a symmetric positive deﬁnite matrix this
will lead to new results, which are presented in Section 5.4.3.2.
For the switched linear systems, conewise linear systems and
the other linear complementarity problem, we compare our
result with existing results in the literature.
5.4.1
Switched linear systems
The disturbance decoupling problem for switched linear sys-
tems has been studied in [Yurtseven et al., 2012], in which a
distinction is made between disturbance decoupling (DD) w.r.t.
d and DD w.r.t. the switching signal σ. From Theorem 3.7 in
[Yurtseven et al., 2012] we see that system (5.4) is disturbance
decoupled (w.r.t. both d and σ) if and only if there exists a
subspace V that is invariant under all Ai, satisfying
im(Ai −Aj) ⊆V ⊆ker J,
im Ei ⊆V,
for all i, j ∈I.
The switched linear system satisﬁes Assumption 5.7 since ev-
ery Yi equals Rny. Therefore, we can apply Theorem 5.9, which
gives the same sufﬁcient condition as above for system (5.4) to
be disturbance decoupled. However, the necessary condition
70

5.4 special classes of systems
we get from Theorem 5.8 is slightly weaker. This discrepancy
can be explained by the observation that for switched linear
systems the relative interior of every two cones Yi and Yj in-
tersect, which means that for each i, j ∈I there is an open
neighborhood in Rny in which the mode can change arbitrarily
from i to j and back.
In the case that A ⊆∑i∈I⟨Ai | im Ei⟩, we have that ∑i∈I⟨Ai |
im Ei⟩is the smallest subspace that contains im Ei and is Ai-
invariant for each i ∈I, and hence we could take ∑i∈I⟨Ai |
im Ei⟩as the subspace V in Theorem 3.7 in [Yurtseven et al.,
2012].
5.4.2
Conewise linear systems
Conewise linear systems can be seen as a special case of piece-
wise afﬁne systems. In the case that F = 0, Corollary 3.4 in
Chapter 3 shows that
∑
i∈I
⟨Ai | im E⟩⊆ker J
(5.15)
is a necessary condition for the conewise linear system (5.6)
to be disturbance decoupled. Corollary 3.6 in Chapter 3 states
that system (5.6) is disturbance decoupled if there is a subspace
V ⊆ker J that contains im E and is invariant under each Ai.
The necessary condition (5.15) can be recovered by Theorem 5.8,
since Assumption 5.7 is satisﬁed, as each cone Yi is solid. From
Theorem 5.9 we ﬁnd that the existence of a subspace V ⊆
ker J that is invariant under each Ai and contains im E and
A is a sufﬁcient condition for system (5.6) to be disturbance
decoupled. This condition is stronger than the condition in
Corollary 3.6. This difference can be explained by the continuity
assumption for the conewise linear system, which cannot be
exploited for general linear multi-modal systems. In the case
that C(sI −A)−1E is right invertible, then Corollary 3.10 in
Chapter 3 yields (5.15) as a necessary and sufﬁcient condition
for disturbance decoupledness, which can be recovered by
Corollary 5.11 in this chapter.
A bimodal linear system is a special case of conewise linear
systems. We consider the case that y = cTx for some vector c.
We have shown in Chapter 2 that such a bimodal linear system
is disturbance decoupled if and only if
⟨A1 | im E⟩+ ⟨A2 | im E⟩⊆ker J,
71

5. disturbance decoupled linear multi-modal systems
even if cT(sI −A)−1E is not right invertible. For this particular
system, the condition (i) of Lemma 5.10 holds regardless of
whether cT(sI −A)−1E is right-invertible or not. As such, the
necessary and sufﬁcient conditions for bimodal systems in
Chapter 2 can be recovered from Corollary 5.11.
5.4.3
Linear complementarity systems
5.4.3.1
Case 1
In Theorem 4.2 in Chapter 4 we have shown that linear com-
plementarity system (5.7), with H being a P-matrix and the
transfer matrix R + N(sI −A)−1E right invertible, is distur-
bance decoupled if and only if
∑
α∈I
⟨Aα | im Eα⟩⊆ker J.
(5.16)
This result can be recovered from Corollary 5.11. To see this,
note that the cones Yi are solid for this linear complementarity
system, which can be seen from the right-invertibility of R +
N(sI −A)−1E and H being a P-matrix. Thus, Assumption 5.7
is satisﬁed, and since Assumptions 5.1 and 5.2 also hold (see
Example 5.5), we can indeed apply Corollary 5.11 and ﬁnd
(5.16) as a necessary and sufﬁcient condition for system (5.7) to
be disturbance decoupled.
By exploiting the special relation between the matrices Aα
and Eα, we have shown in Lemma 4.1 in Chapter 4 that
∑
α∈I
⟨Aα | im Eα⟩= ⟨A | im

E
G
⟩.
Therefore, we ﬁnd that
⟨A | im

E
G
⟩⊆ker J.
is a necessary and sufﬁcient geometric condition for system
(5.7) to be disturbance decoupled.
5.4.3.2
Case 2
We consider again the Linear Complementarity System (5.7),
and now we assume that R = 0, H = 0, NG is a symmetric
positive deﬁnite matrix and that the transfer matrix N(sI −
A)−1E is right invertible as a rational matrix.
It turns out that checking that system (5.7) satisﬁes Assump-
tion 5.7 requires more effort than case 1, as the cones Yi in this
case are not all solid.
72

5.4 special classes of systems
Lemma 5.12 Suppose that R = 0, H = 0, NG is a symmetric
positive deﬁnite matrix and that N(sI −A)−1E is right invertible.
Then system (5.7) satisﬁes Assumption 5.7.
Proof. We start with the observation that the right-invertibility
of the transfer matrix N(sI −A)−1E implies that the transfer
matrix
Tα(s) :=

0
Nα•E

+
 Nαc•
Nα•A

(sI −A)−1E
is also right invertible for any α ⊆Inη. Indeed, suppose that
there is a rational vector col(uαc(s), uα(s)) such that

uT
αc(s)
uT
α (s)

Tα(s) = 0.
Then, from the relation
s · Nα•(sI −A)−1E = Nα•E + Nα•A(sI −A)−1E,
we see that

uT
αc(s)
1
s · uT
α (s)

Tα(s)
=

uT
αc(s)
uT
α (s)
 Nαc•
Nα•

(sI −A)−1E = 0.
The right-invertibility of the rational matrix N(sI −A)−1E im-
plies that

uT
αc(s)
uT
α (s)
 = 0. Consequently, Tα(s) is right
invertible.
Next, we use (1.6) and (1.7) to observe that
T ∗(A, E,
 Nαc•
Nα•A

,

0
Nα•E

)
= T ∗(Aα, Eα,
 Nαc•
Nα•A

,

0
Nα•E

)
⊆⟨Aα | im Eα⟩.
Since Tα(s) is right invertible we can use this together with (1.9)
to ﬁnd that
im

0
Nα•E

+
 Nαc•
Nα•A

⟨Aα | im Eα⟩= Rnη
or, equivalently,
 Nαc•
0
Nα•A
Nα•E
  ⟨Aα | im Eα⟩× Rnd = Rnη.
(5.17)
73

5. disturbance decoupled linear multi-modal systems
We rewrite Yα as
Yα =
 N
0
NA
NE

˜Yα
with
˜Yα = {
x
d

| Θα
x
d

⩾0} ∩ker

Nα•
0

,
where
Θα =
I
0
0
−(Nα•G•α)−1
  Nαc•
0
Nα•A
Nα•E

.
(5.18)
From (5.17) we see that
Θα
 ⟨Aα | im Eα⟩× Rnd = Rnη
(5.19)
since the ﬁrst matrix on the right-hand-side of (5.18) is non-
singular. Hence Θα has full row rank, which gives us that
rint{
x
d

| Θα
x
d

⩾0} = {
x
d

| Θα
x
d

> 0}.
Furthermore, (5.17) also shows that
{
x
d

| Θα
x
d

> 0} ∩ker

Nα•
0
 ̸= ∅.
(5.20)
Therefore, we can use Proposition 2.42 in [Rockafellar and Wets,
2009] to ﬁnd that the relative interior of ˜Yα is given by
rint ˜Yα = {
x
d

| Θα
x
d

> 0} ∩ker

Nα•
0

.
Note that
Nα•Aα = 0,
Nα•Eα = 0,
(5.21)
and hence ⟨Aα | im Eα⟩⊆ker Nα•. Consequently, we have that
(⟨Aα | im Eα⟩× Rnd) ∩rint ˜Yα
= (⟨Aα | im Eα⟩× Rnd) ∩{
x
d

| Θα
x
d

> 0},
which is non-empty, due to (5.19). Hence, the set
 N
0
NA
NE
  (⟨Aα | im Eα⟩× Rnd) ∩rint ˜Yα

74

5.4 special classes of systems
is also non-empty. Using Proposition 2.44(a) in [Rockafellar and
Wets, 2009], this implies that
 N
NA

⟨Aα | im Eα⟩+ im
 0
NE

∩rint(Yα) ̸= ∅,
which is Assumption 5.7(ii).
From (5.20) we know that there is a point ¯y such that Θα ¯y > 0
and

Nα•
0
 ¯y = 0. This implies that for every y ∈

Nα•
0

there is a γ ∈R such that y + γ ¯y ∈˜Yα, so y ∈span( ˜Yα). Hence,
ker

Nα•
0
 ⊆span( ˜Yα). Together with ˜Yα ⊆ker

Nα•
0

this gives us
span( ˜Yα) = ker

Nα•
0

.
With (5.21) this gives us
⟨Aα | im Eα⟩× Rnd ⊆span( ˜Yα).
Hence,
 N
NA

⟨Aα | im Eα⟩+ im
 0
NE

⊆span(Yα),
and hence system (5.7) also satisﬁes Assumption 5.7(i).
■
Lemma 5.10 cannot directly be applied to system (5.7), since
the right-invertibility of N(sI −A)−1E does not imply that
 0
NE

+
 N
NA

(sI −A)−1E
is right invertible. However, the relation
N(sI −A)−1E = 1
s

NE + NA(sI −A)−1E

reveals that the right-invertibility of N(sI −A)−1E implies that
NE + NA(sI −A)−1E is right invertible as well. So if we take
˜C = NA and ˜F = NE and write
Aα = A + Mα ˜C,
Eα = E + Mα ˜F
where
Mα = −G•α(Nα•G•α)−1Iα•,
then condition (iv) of Lemma 5.10 holds with C and F replaced
by ˜C and ˜F respectively. Consequently, ∑α∈I⟨Aα | im Eα⟩is
Aα-invariant for all α, and contains A. Therefore, we can apply
Corollary 5.11 to system (5.7). Before we do so, we ﬁrst ﬁnd a
more compact form of ∑α∈I⟨Aα | im Eα⟩.
75

5. disturbance decoupled linear multi-modal systems
Lemma 5.13 Suppose that R = 0, H = 0, NG is a symmetric
positive deﬁnite matrix and that N(sI −A)−1E is right invertible.
Then we have
∑
α∈I
⟨Aα | im Eα⟩= ⟨A | im

E
G
⟩.
Proof. From the discussion above and taking α = ∅in Lemma
5.10, we see that
∑
α∈I
⟨Aα | im Eα⟩= ⟨A | A + E⟩,
(5.22)
with A and E as in (5.12). Note that im Eα ⊆im

E
G

for
each α ∈I, so E ⊆im

E
G

. Furthermore, for every α, β ∈I
we have im(Aβ −Aα) ⊆im G, and hence A ⊆im G. So we can
conclude that A + E ⊆im

E
G

.
To prove that the other inclusion also holds, choose α = Inη
and β = ∅, then we see that
Aβ −Aα
Eβ −Eα
 = G(NG)−1 
NA
NE

.
The right-invertibility of NE + NA(sI −A)−1E implies that

NA
NE

is of full row rank, and since NG is symmetric
positive deﬁnite, this implies that
im
Aβ −Aα
Eβ −Eα
 = im G,
and hence im G ⊆A + E. By taking α = ∅we ﬁnd that im E ⊆
E, and hence im

E
G
 ⊆A + E.
Together, this gives us
A + E = im

E
G

,
which, combined with (5.22), proves the statement.
■
Now, combining Corollary 5.11 with Lemma 5.12 and Lemma
5.13, we have the following result.
Theorem 5.14 Suppose that R = 0, H = 0, NG is a symmetric
positive deﬁnite matrix and that N(sI −A)−1E is right invertible
as a rational matrix. Then the linear complementarity system (5.7)
is disturbance decoupled if and only if
⟨A | im

E
G
⟩⊆ker J.
76

5.5 conclusions
Here we see that, although system (5.7) is highly non-linear
and nonsmooth, the conditions for system (5.7) to be distur-
bance decoupled are geometric in nature and very akin to those
for linear systems, for which ⟨A | im E⟩⊆ker J is the condi-
tion. For the linear complementarity system we see that the
effect of the complementarity variables on the state, captured
by ⟨A | im G⟩, also has to be taken into account.
5.5
conclusions
In this chapter, we presented necessary and sufﬁcient con-
ditions, geometric in nature, under which a general linear
multi-modal system is disturbance decoupled. The main results,
presented in Theorem 5.8, Theorem 5.9, and Corollary 5.11 gen-
eralize almost all existing results in the literature on switched
linear systems [Yurtseven et al., 2012], bimodal systems (Chap-
ter 2), conewise linear systems (special case of Chapter 3), and
linear complementarity systems of index zero (Chapter 4). In
addition, these results led to necessary and sufﬁcient conditions
for a class of passive-like linear complementarity systems (see
Theorem 5.14) whose disturbance decoupling properties have
not been studied before.
For the presented general linear multi-modal system the
necessary condition in Theorem 5.8 and the sufﬁcient condition
in Theorem 5.9 for being disturbance decoupled do not coincide.
In Corollary 5.11 we presented several conditions under which
these conditions do coincide.
In this chapter we only studied under what conditions a
general linear multi-modal system is disturbance decoupled;
rendering a system disturbance decoupled by means of feed-
back is the next step. Finding a static state feedback such that
the resulting closed-loop system satisﬁes (5.9) becomes a linear
algebraic problem and can be solved mimicking the footsteps
for the linear case.
Possible future research lines include extending the results
presented in this chapter to (discontinuous) piecewise afﬁne
systems and to study the extension to Filippov solutions. Fur-
thermore, the results for the linear complementarity systems
might be extended to the more general case with a not neces-
sarily symmetric but positive semi-deﬁnite H for which there
exists a positive symmetric matrix K such that KGu = NTu for
all u ∈ker(H + HT).
77


6
FA U LT DETECTION AND ISOLATION FOR
B I M O D A L SYSTEMS
abstract:
We consider the problem of fault detection and identiﬁcation for
continuous bimodal piecewise-linear systems. Failures are modeled as disturbances from
the nominal model and geometric techniques are employed to derive conditions under
which one can detect and isolate faults. In addition, we discuss how an asymptotic
observer can be designed by using the results of this chapter in combination with the
existing results on observer design for bimodal systems. This chapter is based on the
paper [Everts et al., 2016].
6.1
introduction
Fault detection and isolation (FDI) is an active area of research
in control theory, due to the essential requirement of high
reliability for many applications of control systems. Various
types of FDI techniques have been proposed for linear systems
and for some classes of nonlinear ones, see the comprehensive
survey papers [Frank, 1990; Hwang et al., 2010; Isermann, 2006;
Isermann and Bailé, 1997]. On the other hand, research on the
FDI problem for hybrid and switched systems, and in particular
for piecewise linear systems, has been less intensive and fruitful
(see [Balluchi et al., 2002; Cocquempot et al., 2004; Narasimhan
et al., 2000; Wang et al., 2009]).
In this chapter, we use the classical geometric control theory
framework to investigate the problem of fault detection and
isolation for bimodal piecewise linear systems. Our approach
is inspired by the ideas pioneered in [Massoumnia, 1986a],
where several formulations of the fault detection and isola-
tion problem were stated and solved in geometric terms. As
in [Massoumnia, 1986a], we consider the problem of how to
deﬁne functions (called residuals in the following) of the system
variables that are zero if no fault is present, and nonzero if a
fault occurs. If the residual is nonzero, i.e. if a fault is affecting
the system, the directional properties of such residuals give in-
formation on the type of failure. We give a sufﬁcient condition
for the residuals to provide sufﬁcient information to solve the
fault detection and isolation problem.
This chapter is organized as follows. We introduce the FDI
problem in Section 6.2, by reviewing the FDI problem for linear
systems. In Section 6.3 we consider the FDI problem for contin-
79

6. fault detection and isolation for bimodal systems
uous piecewise-linear systems with two modes and state our
main result in Theorem 6.8. We conclude the chapter in Section
6.4.
6.2
fault detection and isolation
To introduce the problem of fault detection and isolation (FDI)
we ﬁrst review the formulation of the FDI problem for linear
systems as treated in [Massoumnia, 1986a]. Consider the linear
system described by
˙x(t) = Ax(t) + Bu(t) +
k
∑
i=1
Fimi(t)
(6.1a)
y(t) = Cx(t),
(6.1b)
with state x(t) ∈Rnx, input u(t) ∈Rnu, output y(t) ∈Rny,
fault modes mi(t) ∈Rfi for i ∈Ik, and matrices A, B, C and
Fi of appropriate sizes. This system consists of a nominal plant
described by (A, B, C) and by additional terms associated with
the matrices Fi, the fault signatures. By choosing the Fis one can
model different kind of faults. For example, by setting F1 = Bj,
where Bj is the j-th column of the input matrix B, the effect
of a complete failure of the j-th actuator can be modeled by
letting m1 = −uj. A biased actuator can be modeled by setting
m1(·) to be a constant function. Other types of faults (including
changes in the system dynamics represented by the matrices
A) can be accommodated in this framework too; see section
III of [Massoumnia, 1986a] for more details. Without loss of
generality we can assume that the Fis have full column rank
and deﬁne
F :=

F1
F2
· · ·
Fk

.
In order to detect and identify faults, we deﬁne a Luenberger
observer for the linear system (6.1)
˙ˆx(t) = A ˆx(t) + Bu(t) −K(y(t) −ˆy(t))
(6.2a)
ˆy(t) = C ˆx(t)
(6.2b)
where the observer state ˆx and output ˆy are of the same di-
mensions as x and y respectively, and K is a to-be-designed
nx × ny-matrix. In addition, for this observer we deﬁne residuals
ri by
ri(t) := Di(y(t) −ˆy(t))
i ∈Ik,
(6.3)
80

6.2 fault detection and isolation
where D1, D2, . . . , Dk are to-be-designed ny × ny-matrices. In
order to detect and identify faults, we want the ith residual to
be nonzero exactly when the ith fault occurred.
Deﬁnition 6.1 The observer (6.2), (6.3) is a fault detector for
system (6.1) if the following property holds whenever x(0) =
ˆx(0): ri(t) = 0 for all t ⩾0 if and only if mi(t) = 0 for almost
all t ⩾0.
Remark 6.2 The assumption x(0) = ˆx(0) corresponds to the
observer being initialized with the correct value of the actual
plant state. In practice, a stability requirement on the observer
needs to be added to guarantee that the error e(t) = x(t) −ˆx(t)
converges to zero asymptotically. A discussion of such generic
and more realistic case is given in Remark 6.11 below.
Clearly, a necessary condition for the existence of a fault de-
tector for a linear system is that the fault matrix F should have
full column rank, otherwise there would be no possibility of dis-
tinguishing faults that differ by elements in ker F. Furthermore,
to make sure that a nonzero mi has an effect on the output y,
the transfer matrix C(sI −A)−1Fi has to be left-invertible.
Before we state the main result for the FDI problem for linear
systems, we deﬁne the following notions of separability and
compatibility and present a proposition which connects these
two notions. A collection of subspaces {Ti}N
i=1 is called output
separable if
CTi ∩
 
∑
j̸=i
CTj
!
= {0}
(6.4)
for i ∈IN (see also formula (8) in [Massoumnia, 1986a]). We call
a collection of (C, A)-invariant subspaces {Ti}N
i=1 compatible if
they admit a common friend, i.e., there exists a map K ∈Rnx×ny
such that
(A + KC)Ti ⊆Ti,
(6.5)
for all i ∈IN.
Proposition 6.3 ([Massoumnia, 1986a, Lemma 2]) A set of out-
put separable (C, A)-invariant subspaces {Ti}N
i=1 is compatible.
81

6. fault detection and isolation for bimodal systems
We present the following variation on Theorem 3 in [Mas-
soumnia, 1986a], using the notion of fault detectors.
Theorem 6.4 If C(sI −A)−1Fi is left-invertible for i ∈Ik and the
subspaces {T ∗(Fi, C, A)}k
i=1 are output separable, then the system
(6.1) has a fault detector of the form (6.2), (6.3).
Proof. Deﬁne T ∗
i
:= T ∗(Fi, C, A), for i ∈Ik. From the as-
sumption of output separability it follows from Proposition 6.3
that there is a map K that satisﬁes (A + KC)T ∗
i
⊆T ∗
i
for all
i ∈Ik. Furthermore, output separability guarantees that we can
choose maps Di such that Diy = y for y ∈CT ∗
i
and Diy = 0
for y ∈CT ∗
j
whenever j ̸= i, for i, j ∈Ik. We will show that
with this choice of D1, D2, . . . , Dk and K the observer (6.2) is a
fault detector for system (6.1).
Denote by e := x −ˆx the error signal; its dynamics is given
by
˙e(t) = (A + KC)e(t) +
k
∑
i=1
Fimi(t).
(6.6)
Since we assume that e(0) = x(0) −ˆx(0) = 0, the error e(t) will
stay in the subspace ⟨A + KC | im F⟩for all t ⩾0. For a given
i ∈Ik, we write e(t) = ei(t) + ˜ei(t) where ei and ˜ei respectively
satisfy
˙ei(t) = (A + KC)ei(t) + Fimi(t)
(6.7)
˙˜ei(t) = (A + KC)˜ei(t) + ∑
j̸=i
Fjmj(t)
(6.8)
with ei(0) = ˜ei(0) = 0. By the choice of K it follows that
T ∗
j = ⟨A + KC | im Fj⟩for all j, and consequently
˜ei(t) ∈⟨A + KC | ∑
j̸=i
im Fj⟩
= ∑
j̸=i
⟨A + KC | im Fj⟩
= ∑
j̸=i
T ∗
j ⊆ker DiC
for all t. Therefore, ri(t) = DiCei(t) + DiC˜ei(t) = DiCei(t) and
ri can thus be interpreted as an output of the linear system
given by (6.7). Hence, if mi(t) = 0 for almost all t ⩾0, then
from (6.7) and ei(0) = 0 we see that ei(t) = 0 for all t ⩾0, and
as a result ri(t) = DiCei(t) = 0 for all t ⩾0.
On the other hand, by using the identity
(sI −X)−1 −(sI −Y)−1 = (sI −X)(X −Y)(sI −Y)−1,
82

6.3 fault detection and isolation for bimodal systems
it can be veriﬁed that
C(sI −A −KC)−1Fi =
(I −C(sI −A −KC)−1K)C(sI −A)−1Fi.
Since C(sI −A)−1Fi and I −C(sI −A −KC)−1K are both left-
invertible, so is C(sI −A −KC)−1Fi. Because Diy = y for all
y ∈CT ∗
i
= C⟨A + KC | im Fi⟩, we have that DiC(sI −A −
KC)−1Fi = C(sI −A −KC)−1Fi. Therefore, the transfer matrix
from mi to ri is left-invertible. Consequently, if ri(t) = 0 for all
t ⩾0, then mi(t) = 0 for almost all t ⩾0.
Hence, this choice of D1, D2, . . . , Dk and K results in a fault
detector for system (6.1).
■
6.3
fault detection and isolation for bimodal sys-
tems
We now consider the FDI problem for continuous piecewise-
linear systems with two modes. Such systems are described by
˙x(t) =











A1x + Bu +
k
∑
i=1
Fimi
if cTx ⩽0
A2x + Bu +
k
∑
i=1
Fimi
if cTx ⩾0
(6.9a)
y = Cx,
(6.9b)
where Aj ∈Rnx×nx for j = 1, 2, c ∈Rnx, and x, y, u, mi, B, C
and Fi are as before. We assume that the right-hand side of
(6.9a) is continuous in x, which is equivalent to saying that A1
and A2 satisfy
A1 −A2 = hcT
(6.10)
for some h ∈Rnx. Without loss of generality we can assume
that every fault signature Fi has full column rank and we deﬁne
F
:=

F1
F2
· · ·
Fk

m
:=

mT
1
mT
2
· · ·
mT
k
T .
Similar to the linear case, we aim at designing a Luenberger-
type observer that produces a residual signal which provides
83

6. fault detection and isolation for bimodal systems
information about the presence and the nature of failures on
the basis of the inputs and outputs of the plant. The dynamics
of the to-be-designed observer are
˙bx =
(
A1bx + Bu −K(y −by)
if cTbx ⩽0
A2bx + Bu −K(y −by)
if cTbx ⩾0
(6.11a)
by = Cbx
(6.11b)
ri = Di(y −ˆy),
∀i ∈Ik,
(6.11c)
where bx ∈Rnx, by ∈Rny, ri is the ith residual, and K ∈Rnx×ny
and Di ∈Rny×ny are design parameters. Analogously to the
linear case, we call observer (6.11) a fault detector for system
(6.9) if the following holds whenever x(0) = ˆx(0): ri(t) = 0 for
all t ⩾0 if and only if mi(t) = 0 for almost all t ⩾0.
To study the dynamics of the residuals, we deﬁne the error
by e(t) := x(t) −ˆx(t). The dynamics of e depends on both the
mode of the system (6.9) and the mode of the observer (6.11),
and hence has four modes, described by:
˙e =













(A1 + KC)e + Fm
if cTx ⩽0, cTbx ⩽0
(A1 + KC)e + hcTbx + Fm
if cTx ⩽0, cTbx ⩾0
(A2 + KC)e −hcTbx + Fm
if cTx ⩾0, cTbx ⩽0
(A2 + KC)e + Fm
if cTx ⩾0, cTbx ⩾0.
(6.12)
We now deﬁne some subspaces that play a similar role as the
subspaces T ∗(Fi, C, A) for the linear system FDI situation:
Z j
0
:=
T ∗(Aj, C, im h)
(6.13a)
Z j
i
:=
T ∗(Aj, C, im Fi)
(6.13b)
W j
i
:=
T ∗(Aj, C, im

h
Fi
)
(6.13c)
for j = 1, 2 and i ∈Ik. In these subspaces, we treat h analo-
gously to a fault signature; this will enable us to distinguish
between mode-switching and faults. Firstly, we show that some
of these subspaces coincide.
Proposition 6.5 Let Z j
i and W j
i be as in (6.13a)-(6.13c). Then
Z1
0 = Z2
0 and W1
i = W2
i for i ∈Ik. Moreover, Z j
0 ⊆W j
i and
Z j
i ⊆W j
i for j = 1, 2 and i ∈Ik.
84

6.3 fault detection and isolation for bimodal systems
Proof. Since Z1
0 is (C, A1)-invariant, there exists a map K ∈
Rn×p such that (A1 + KC)Z1
0 ⊆Z1
0. From equation (6.10) it
follows that for any z ∈Z1
0 we have
(A2 + KC)z = (A1 + KC −hcT)z
= (A1 + KC)z −hcTz
∈Z1
0,
since Z1
0 is invariant under A1 + KC and contains h. It follows
that Z1
0 is also (C, A2)-invariant, and since Z2
0 is the smallest
(C, A2)-invariant subspace containing im h, we conclude that
Z1
0 ⊆Z2
0. A symmetric argument proves the converse inclusion,
and hence we conclude that Z1
0 = Z2
0. The equality W1
i = W2
i
can be proved in an analogous manner.
The inclusions Z j
0 ⊆W j
i and Z j
i ⊆W j
i , for j = 1, 2 and
i ∈Ik, follow from the deﬁnition of the subspaces, and from
the fact that im h and im Fi are both contained in im

h
Fi

. ■
In light of the result of Proposition 6.5, in the following
we denote the subspaces W1
i = W2
i simply by Wi for i ∈Ik,
and the subspace Z1
0 = Z2
0 by Z0. Next, we show that under
the assumption ker C ⊆ker cT, the subspaces Z1
i and Z2
i also
coincide.
Proposition 6.6 If ker C ⊆ker cT, then Z1
i = Z2
i for i ∈Ik.
Proof. We ﬁrst prove that Z1
i is (C, A2)-invariant. Since ker C ⊆
ker cT, we have hcT |ker C= {0}. Hence, using A2 = A1 −hcT
we see that
A2(Z1
i ∩ker C) = (A1 −hcT)(Z1
i ∩ker C)
= A1(Z1
i ∩ker C)
⊆Z1
i ,
where the last inclusion follows from the fact that Z1
i is (C, A1)-
invariant. Consequently, Z1
i is (C, A2)-invariant; moreover, it
contains im Fi. Since Z2
i is the smallest such subspace, it follows
that Z2
i ⊆Z1
i . An analogous argument proves that Z2
i is also
(C, A1)-invariant, and consequently Z1
i ⊆Z2
i . The claimed
equality follows.
■
When under the assumption of Prop. 6.6, the subspace Z1
i =
Z2
i will be denoted by Zi. The output separability of the sub-
spaces {Z1
i }k
i=0 (or {Z2
i }k
i=0) has some important consequences.
85

6. fault detection and isolation for bimodal systems
Proposition 6.7 If {Z1
i }k
i=0 and {Z2
i }k
i=0 are output separable,
then Wi = Z j
0 + Z j
i , for j = 1, 2 and i ∈Ik. Moreover, the sub-
spaces {Wi}k
i=1 are compatible.
Proof. We prove the claim for j = 1, the case j = 2 being
completely analogous. From the inclusions Z1
0 ⊆W1
i and
Z1
i ⊆W1
i , i ∈Ik proved in Proposition 6.5 conclude that
Z1
0 + Z1
i ⊆Wi for i ∈Ik.
Using Proposition 6.3 we conclude that {Z1
i }k
i=0 have a com-
mon friend K. Since (A1 + KC)Z1
i
⊆Z1
i , i = 0, 1, . . . , k, it
follows that (A1 + KC)(Z1
0 + Z1
i ) ⊆(Z1
0 + Z1
i ). Consequently
Z1
0 + Z1
i is a (C, A1)-invariant subspace for i ∈Ik. Note that
Z1
0 + Z1
i contains im h and im Fi, and that Wi is the smallest
(C, A1)-conditioned invariant with this property; it follows that
Z1
0 + Z1
i ⊇Wi, and hence Wi = Z1
0 + Z1
i for i ∈Ik. Since K
is a common friend of the subspaces {Wi}k
i=1, the subspaces
{Wi}k
i=1 are compatible.
■
In the proof of the following theorem, which is the main
result of this chapter, we treat state-switching analogously to a
fault occurrence, with fault signature h.
Theorem 6.8 Consider system (6.9), and assume ker C ⊆ker cT.
If C(sI −A)−1Fi is left-invertible for all 1 ⩽i ⩽k and the subspaces
{Zi}k
i=0 in (6.13a)-(6.13b) are output separable, then there exists a
fault detector of the form (6.11) for system (6.9).
Proof. By Proposition 6.3 the subspaces {Zi}k
i=0 are compatible;
let K be a common friend for these subspaces. For each i ∈Ik
let the map Di be such that Diy = y for y ∈CZi and
CZj ⊆ker Di
(6.14)
for j = 0, 1, . . . , k with j ̸= i. We show that with this choice of
D1, D2, . . . , Dk and K, the observer (6.11) is a fault detector for
system (6.9).
Given a initial state x0, an input u(·) and a fault signal m(·),
the trajectories of x and ˆx are known and can be used to the
deﬁne the following function:
θ(t) :=













0
if cTx(t) ⩽0, cTbx(t) ⩽0
cTbx(t)
if cTx(t) ⩽0, cTbx(t) ⩾0
cTx(t)
if cTx(t) ⩾0, cTbx(t) ⩽0
cT(bx(t) −x(t))
if cTx(t) ⩾0, cTbx(t) ⩾0.
86

6.3 fault detection and isolation for bimodal systems
Using θ(t), we can rewrite the error dynamics (6.12) as
˙e(t) = (A1 + KC)e(t) + hθ(t) + Fm(t).
(6.15)
Hence, the error e can be seen as a solution of a linear system
with inputs θ and m. Furthermore, for a given index i ∈Ik we
can write the error e as e = ei + ˜ei, where ei is the part of the
error that corresponds to the effects of fault mi, with ei and ˜ei
satisfying
˙ei(t) = (A1 + KC)ei(t) + Fimi(t)
(6.16)
˙˜ei(t) = (A1 + KC)˜ei(t) +
k
∑
j=1
j̸=i
Fjmj(t) + hθ(t)
(6.17)
and ei(0) = ˜ei(0) = 0. We write F0 = h and note that from the
choice of K it follows that
˜ei(t) ∈⟨A + KC |
k
∑
j=0
j̸=i
im Fj⟩
=
k
∑
j=0
j̸=i
⟨A + KC | im Fj⟩=
k
∑
j=0
j̸=i
Zj
⊆ker DiC,
for all t. Therefore, ri(t) = DiCei(t) + DiC˜ei(t) = DiCei(t) and
ri can thus be seen as an output of the linear system described
by (6.16).
Suppose that mi(t) = 0 for almost all t ⩾0. Then from (6.16)
and ei(0) = 0 we see that ei(t) = 0 for all t ⩾0, and hence
ri(t) = DiCei(t) = 0.
On the other hand, by using the identity
(sI −X)−1 −(sI −Y)−1 = (sI −X)(X −Y)(sI −Y)−1
for two square matrices X and Y, we conclude that
C(sI −A1 −KC)−1Fi =
(I −C(sI −A1 −KC)−1K)C(sI −A1)−1Fi.
Since both I −C(sI −A1 −KC)−1K and C(sI −A1)−1Fi are
left-invertible as rational matrices, so is C(sI −A1 −KC)−1Fi.
The choice of Di guarantees that the transfer function DiC(sI −
87

6. fault detection and isolation for bimodal systems
A1 −KC)−1Fi equals C(sI −A1 −KC)−1Fi and is therefore left-
invertible as well. Consequently, if ri(t) = 0 for all t ⩾0, then
mi(t) = 0 for almost all t ⩾0.
■
Remark 6.9 The assumption that ker C ⊆ker cT implies that
cT = hTC for some vector h. Consequently, the mode that the
system is in at time t can be determined based on the output
y(t).
Remark 6.10 If all the fault signals are scalar, i.e. fi = 1 for all
i, then all the Fis are vectors. In this case left-invertibility of
C(sI −A1 −KC)Fi is equivalent with input observability of the
system given by (6.16) with output Cei. Furthermore, if
{0} = im Fi ∩ker C,
for i ∈Ik, then using Algorithm 4.1.1 p. 202 of [Basile and
Marro, 1992] we conclude that Z j
i = im Fi, i ∈Ik, j = 1, 2,
in which case the assumption ker C ⊆ker cT is not needed
in Theorem 6.8 since Z1
i = Z2
i is already satisﬁed for all i =
0, 1, . . . , k.
Remark 6.11 In the generic case e(0) ̸= 0 the issue of the
asymptotic stability of the observer comes into play: the gain K
must not only be a common friend of the Zi but also guarantee
that e(t) →0 as t →0 in the absence of faults. Then, if (the
norm of) ri(t) is above a certain threshold, one can observe
that a fault has occurred. The following sufﬁcient condition for
the existence of asymptotic observers for bimodal systems has
been proved in [Juloski et al., 2007].
Proposition 6.12 Consider the plant (6.9) with m(·) = 0, and the
observer (6.11). If there exist matrices P = PT > 0, K, M, and
λ, µ ∈R with λ ⩾0, µ > 0 such that
X11
X12
X21
X22

⩽0,
(6.18)
88

6.4 conclusions
where
X11
:=
(A1 + KC)TP + P(A1 + KC) + µIn
X12
:=
−PhcT + λ
2 (c −CTM)cT
X21
:=
XT
12
X22
:=
−λccT,
then the error dynamics (6.12) is globally asymptotically stable in
the sense of Lyapunov.
To apply Proposition 6.12 in the setting for FDI described in
the previous section, the stabilizing observer gain K solving the
matrix inequality (6.18) must also be a common friend of the
subspaces {Zi}k
i=0. Replacing K in (6.18) by a parametrization
of the common friends of the Zi, one ﬁnds a bilinear matrix
inequality since it contains products of the indeterminates.
This results in a non-convex optimization problem. However,
such bilinear matrix inequalities can be sub-optimally solved
(i.e. local optima can be computed) for instance by employing
standard LMI solvers, e.g. Yalmip (see [Löfberg, 2004]).
6.4
conclusions
We have illustrated a geometric approach to the design of
fault detection systems for a class of bimodal piecewise-linear
systems. Sufﬁcient conditions (Theorem 6.8) have been given
for the existence of an observer that produces residuals that are
sufﬁciently informative about the fault. A method for ﬁnding
an asymptotic observer based on bilinear matrix inequalities
has been discussed. Extension of the ideas and results towards
multi-modal piecewise linear systems is a possible research
direction.
In the next chapter we continue with the FDI problem for a
class of linear dynamical systems deﬁned over an undirected
graph.
89


7
FA U LT DETECTION AND ISOLATION FOR
S Y S T E M S DEFINED OVER GRAPHS
abstract: In this chapter we consider the problem of fault detection and isolation
for a class of linear dynamical systems deﬁned over a graph containing faultable vertices
and observer vertices. Using a geometric approach, we provide a characterization of the
smallest conditioned invariant subspaces generated by faults in terms of the underlying
graph structure. Based on this characterization, we give graph-theoretic conditions
guaranteeing fault detectability. In addition, we provide a condition under which fault
detectability fails. This chapter is based on our conference paper [Rapisarda et al.,
2015].
7.1
introduction
Detecting and identifying faults in multi-agent systems is par-
ticularly relevant, as faults either in the agents or in the com-
munication structure can have serious consequences. This leads
naturally to considering design issues. Of primary importance
is designing a communication structure that guarantees the
prompt detection and accurate identiﬁcation of faults.
In the literature on multi-agent systems, within the control
community several approaches have been proposed for fault
detection and isolation. Among these, those closer to the re-
sults presented here are [Jafari et al., 2011; Pasqualetti et al.,
2012; Rahimian and Aghdam, 2013]. In these references the
geometric approach to fault detection and isolation based on
unknown input observers pioneered in [Massoumnia, 1986b,a]
is used. In [Jafari et al., 2011; Rahimian and Aghdam, 2013]
problems of leader collocation to guarantee controllability of a
multi-agent system under communication failure are studied;
in [Pasqualetti et al., 2012] the authors study the problem of
reliable computation in consensus networks.
In this chapter, we consider a class of linear dynamical sys-
tems deﬁned over an undirected graph. In this network, we
identify two disjoint sets of agents: the faultable agents, which
are prone to failure, and the observer agents, whose output is
measurable. Faults such as total communication failures, biased
sensing, etc. can be modeled in a straightforward way in our
framework. Fault detection is performed by an unknown input
observer, and stated in the geometric language of [Massoumnia,
1986a], i.e. output separability of fault subspaces.
91

7. fdi for systems defined over graphs
First we present a characterization of the smallest condi-
tioned invariant subspaces that are generated by the faults. This
characterization is exploited in order to give graph-theoretical
conditions guaranteeing output separability in terms of dis-
tances between faultable agents and observer ones. In addition,
we study the case where two faultable vertices share exactly the
same neighbors in order to present a condition under which
fault detectability fails.
The organization of this chapter is as follows. Section 7.2
introduces graph-theoretical tools that will be used later on in
this chapter. Section 7.3 discusses the problem of fault detection
in a geometric setting. In section 7.4, we present the main results
of this chapter. Finally, the chapter closes with the conclusions
in section 7.5.
7.2
background material
Consider a simple graph G = (V, E), i.e. undirected and un-
weighted graph containing no multiple edges or loops on ver-
tices. Let the vertex set V be given by
V = {1, 2, . . . , n}
and the edge set E be a subset of all unordered pairs of vertices,
that is, E ⊆{{i, j} | i, j ∈V}.
Associated to such a graph G = (V, E), we deﬁne a family
of matrices, called the qualitative class of G, by
Q(G) = {X ∈Rn×n | for i ̸= j, Xij ̸= 0 ⇔{i, j} ∈E}.
Typical elements of the qualitative class are adjacency, Laplacian
and normalized Laplacian matrices corresponding to a simple
graph. Note that the elements of the qualitative class may
correspond to matrices associated to a weighted graph, even
though the graph G is itself simple and hence unweighted.
We say that a graph H = (V, E) is bipartite if there exist
disjoint vertex sets V−and V+ such that V−∪V+ = V and
the edge set E contains only edges connecting one vertex from
V−and the other from V+. With a slight abuse of notation, we
write H = (V−, V+, E) for bipartite graphs.
Associated to a bipartite graph H = (V−, V+, E) with
V−= {r1, r2, . . . , rp}
V+ = {c1, c2, . . . , cq},
92

7.3 problem statement
we deﬁne a pattern class by
P(H) := {Y ∈Rp×q | Yij ̸= 0 ⇔{ri, cj} ∈E}.
Note that the matrices in the pattern class are not necessarily
square unlike those in the qualitative class.
A set of t edges of a bipartite graph H = (V−, V+, E) that do
not share a common vertex is called a t-matching. A t-matching
is called constrained if there is no other t-matching between the
matched vertices.
The following is a classical result (see [Hershkowitz and
Schneider, 1993, Thm. 3.9]) in the study of the minimal rank of
a given pattern class.
Theorem 7.1 Let H = (V−, V+, E) be a bipartite graph with ver-
tex sets V−= {r1, r2, . . . , rp} and V+ = {c1, c2, . . . , cq}. All ma-
trices Y ∈P(H) are of full rank if and only if H admits a con-
strained min(p, q)-matching.
7.3
problem statement
Let G = (V, E) be a simple and connected graph with the vertex
set
V = {1, 2, . . . , n}.
Two subsets of V will play an important role in the sequel.
We denote these sets by VF (faultable vertices) and VO (observer
vertices). For simplicity, we assume that these sets are disjoint
and that the ﬁrst q vertices are faultable and the last s are
observer, that is
VF = {1, 2, . . . , q}
VO = {n −s + 1, n −s + 2, . . . , n}.
Throughout this chapter, we will consider systems of the
form
˙x(t) = Xx(t) + M f (t)
(7.1a)
y(t) = Nx(t)
(7.1b)
where x is the state, f is the fault mode and y is the output
vector. The matrices X, M and N are related to the given simple
graph G and the pair (VF, VO) in the sense that X belongs to
93

7. fdi for systems defined over graphs
Q(G), M encodes the faultable vertices and N the observer
vertices, that is
M =

Iq
0n−q,q

and
N =

0s,n−s
Is

.
The problem we will address in this chapter amounts to
setting up an observer
˙bx(t) = (X + KN)bx(t) −Ky(t)
(7.2a)
by(t) = Nbx(t)
(7.2b)
where K ∈Rn×s, in order to detect if and which faults are
active.
To elaborate on what we mean by detecting faults, deﬁne the
error by
e(t) := bx(t) −x(t)
and note that it satisﬁes the dynamics
˙e(t) = (X + KN)e(t) −M f (t)
(7.3a)
r(t) = Ne(t)
(7.3b)
where r is the residual term.
Assuming that e(0) = 0, if only the i-th fault occurs, i.e., if
fi ̸= 0 and fj = 0 for j ̸= i, the error in (7.3) is conﬁned to the
smallest (X + KN)-invariant subspace containing im Mi, where
Mi denotes the ith column of the matrix M. Under such strong
assumption (implying that the observer is initialized precisely
with the same initial conditions as the system), the fault de-
tection and isolation problem can be stated in the geometric
language illustrated in sect. 7.2 as follows:
Given the dynamics (7.1), ﬁnd a family {Ti}q
i=1 of sub-
spaces of Rn and associated K ∈Rn×s such that
C1) (X + KN)Ti ⊆Ti, i ∈Iq,
C2) im Mi ⊆Ti, i ∈Iq,
C3) NTi ∩

∑j̸=i NTj

= {0}, i ∈Iq.
If such a family of subspaces exists, e(0) = 0, and only the i-th
fault occurs, then it follows from the structure of the observer
(7.2) that e(t) belongs to Ti for all t ∈R (condition C1 and
94

7.4 graph-theoretic conditions
C2). Because of output separability (condition C3, see (6.4)), in
case of multiple faults, information on the presence and type
of faults can be obtained by projecting the residual vector r on
NTi for i ∈Iq.
In the generic case of e(0) ̸= 0, the asymptotic stability of the
observer comes into play, and the common friend K (condition
C1, see (6.5)) of the family {Ti} must be such that
lim
t→∞e(t) = 0,
i.e. the conditions C1–C3 must be supplemented by the condi-
tion
C4) σ(X + KN) ⊂C−.
The main goal of this chapter is to ﬁnd graph-theoretical
sufﬁcient conditions that enable fault detection and isolation as
explained above.
7.4
graph-theoretic conditions
Given particular choices of X, M and N in (7.1), checking
for the existence of an output separable family {Ti}q
i=1 that
satisﬁes conditions C1–C3 is a straightforward linear algebra
problem. For this, we deﬁne T ∗
i to be T ∗(Mi, N, X); the smallest
(N, X)-invariant subspace containing im Mi for i ∈Iq. Then
the following result holds.
Lemma 7.2 Consider the system (7.1). There exists a family of sub-
spaces {Ti}q
i=1 satisfying conditions C1–C3 if and only if {T ∗
i }q
i=1
is output separable.
Proof. See the proof of Theorem 3 p. 841 of [Massoumnia,
1986a].
■
Thus in order to check whether the FDI approach of section
7.3 can be applied to a given network, one needs to compute
the (N, X)-invariant subspaces T ∗
i
via the algorithm (1.8), and
then check the output separability of {T ∗
i }q
i=1. Necessary and
sufﬁcient conditions for the existence of a stabilizing common
friend of subspaces Ti are given in Theorems 9 and 10 of [Mas-
soumnia, 1986a].
95

7. fdi for systems defined over graphs
In this section we pursue another line of thought, providing
a sufﬁcient condition for output separability based on graph-
theoretical considerations, as in [Jafari et al., 2011; Rahimian and
Aghdam, 2013]. Such approach has the advantage of avoid-
ing potential numerical and computational complexity issues
associated with linear algebra computations for large-scale
networks, providing instead robust conditions based on dis-
crete mathematics. Moreover, it offers insight into the structural
properties of networks, with potentially useful applications for
example in the design of network systems.
Moreover, the conditions we will provide are going to be
valid not only for a particular choice of the matrix X but rather
for a family of matrices within the qualitative class, namely the
so-called distance-information preserving matrices.
To elaborate on this class of matrices, recall that for a graph
G = (V, E) the distance between two vertices is the length
of the shortest path connecting them. The distance between
the vertices i and j is denoted by dist(i, j). By convention,
dist(i, j) := ∞if no path exists between vertex i and vertex
j, and dist(i, i) = 0 for any vertex i. In this chapter we as-
sume that the graph G is connected, hence dist(i, j) < ∞for all
vertices i and j.
Deﬁnition 7.3 A matrix X ∈Rn×n is distance-information pre-
serving with respect to the graph G = (V, E) if
(Xk)i,j
(
= 0
if dist(i, j) > k,
̸= 0
if dist(i, j) = k
for k ⩾0.
Clearly, every distance-information preserving matrix be-
longs to the qualitative class Q(G) but the converse is not
true in general. Laplacian and adjacency matrices, frequently
used in describing graph structures, are typical instances of
distance-information preserving matrices.
Furthermore, we deﬁne the distance of a vertex i ∈V from a
nonempty subset of vertices V′ ⊆V as follows:
dist(i, V′) := min
j∈V′ dist(i, j).
We begin with presenting a characterization of the subspaces
T ∗
i .
96

7.4 graph-theoretic conditions
Lemma 7.4 Consider the system (7.1). Suppose that X is a distance-
information preserving matrix with respect to the simple and con-
nected graph G = (V, E). Let i ∈VF and di = dist(i, VO). Then,
we have
T ∗
i = im

Mi
Xi
· · ·
(Xdi)i

(7.4a)
NT ∗
i = im N(Xdi)i
(7.4b)
where Xi denotes the ith column of the matrix X.
Proof. We prove the statement by employing the recursion (1.8),
starting with
T 0 = im Mi.
Since VF ∩VO = ∅, it follows that
im Mi ⊆ker N.
(7.5)
Thus, we obtain
T 1 = im Mi + X

T 0 ∩ker N

= im Mi + X (im Mi ∩ker N)
= im Mi + X im Mi.
Note that X im Mi = im Xi by the deﬁnition of M. Hence, we
get
T 1 = im Mi + im Xi.
Since VF ∩VO = ∅, we have di > 0. Together with the connect-
edness of G this implies that T 1 is strictly larger than T 0.
Next, we note that
T 2 = im Mi + X

T 1 ∩ker N

= im Mi + X
 (im Mi + im Xi) ∩ker N

.
It follows from (7.5) that
(im Mi + im Xi) ∩ker N = im Mi + (im Xi ∩ker N).
Now, we distinguish the following two cases: dist(i, VO) = 1
and dist(i, VO) > 1. In the ﬁrst case, we have
im Xi ∩ker N = {0}
97

7. fdi for systems defined over graphs
and hence we ﬁnd
T 2 = im Mi + im Xi = T 1,
and the algorithm stops. In the second case we have
im Xi ⊆ker N,
(7.6)
which further implies that
im Xi ∩ker N = im Xi.
Therefore, we obtain
T 2 = im Mi + im Xi + im(X2)i.
Since X is a distance-information preserving matrix with re-
spect to a connected graph and dist(i, VO) > 1, there is vertex j
such that (X2)i,j ̸= 0 while Mi,j = 0 and Xi,j = 0. Hence, T 2 is
strictly larger than T 1, and we can continue with the algorithm.
By applying the same arguments repeatedly, we obtain (7.4a).
In addition, it follows from (7.5) and (7.6) that
NMi = NXi = · · · = N(Xdi−1)i = 0.
Furthermore, we have
N(Xdi)i ̸= 0.
As such, (7.4b) holds.
■
The subspaces T ∗
i are (N, X)-invariant and contain im(Mi)
by deﬁnition, and so they satisfy conditions C1 and C2 of the
geometric version of the fault detection and identiﬁcation prob-
lem discussed in section 7.3. The result of Lemma 7.4 enables
us to device a purely graph-theoretical sufﬁcient condition for
the output separability condition C3. To formulate the graph-
theoretical condition, we need to introduce some nomenclature.
Given a simple graph G = (V, E) and a pair (VF, VO), deﬁne
WO = {j ∈VO | dist(i, j) = dist(i, VO) for some i ∈VF}.
In other words, WO consists of the observer vertices that are
the closest to one of the faultable vertices. Now, we deﬁne the
bipartite graph GOF = (WO, VF, EOF) by
{j, i} ∈EOF ⇔j ∈WO, i ∈VF, dist(i, j) = dist(i, VO).
With these preparations, we are ready to state the graph-
theoretical sufﬁcient condition for the output separability re-
quirement C3 for the class of distance-information preserving
matrices.
98

7.4 graph-theoretic conditions
Theorem 7.5 Consider the system (7.1) for a simple and connected
graph G = (V, E) with faultable vertices VF and observer vertices
VO. Then the family of subspaces {T ∗
i }q
i=1 is output separable for
any distance-information preserving matrix X ∈Q(G) if the bipar-
tite graph GOF admits a constrained q-matching.
Proof. For a given distance-information preserving matrix X ∈
Q(G), let
R =

N(Xd1)1
N(Xd2)2
· · ·
N(Xdq)q

,
where di = dist(i, VO). Lemma 7.4 gives us that
NT ∗
i = im N(Xdi)i,
which implies that the output separability of the subspaces
{T ∗
i }q
i=1 is equivalent to the condition that
rank R = q.
(7.7)
Observe that the jth entry of the column vector N(Xdi)i is
nonzero if and only if dist(i, j) = di = dist(i, VO). Furthermore,
note that the vertices in WO correspond to the nonzero rows of
the matrix R. This means that the matrix obtained from R by
discarding the zero rows belongs to the pattern class P(GOF).
Since the bipartite graph GOF admits a constrained q-matching,
it follows from Theorem 7.1 that rank R = q. Consequently, the
family {T ∗
i }q
i=1 is output separable.
■
1
2
3
4
5
6
7
8
9
0
Figure 7.3: A 10-vertex graph.
Next we illustrate the result of Theorem 7.5 by means of an
example.
99

7. fdi for systems defined over graphs
3
4
9
0
(a)
2
3
9
0
(b)
Figure 7.4: The graph GOF for two different choices of observer ver-
tices for the graph in Figure 7.3; (a) VF = {0, 9} and
VO = {3, 4} and (b) VF = {0, 9} and VO = {2, 3}.
Example 7.6 Consider the graph depicted in Figure 7.3. First,
we choose VF = {0, 9} and VO = {3, 4}. Note that dist(0, VO) =
dist(9, VO) = 2 and WO = {3, 4}. For this case, the bipartite
graph GOF is depicted in Figure 7.4a in which the observer ver-
tices are indicated by octagons. The 2-matching
{0, 4}, {9, 3}
	
is a constrained matching. As such, Theorem 7.5 concludes that
the output separability condition C3 holds for this case, for any
distance-information preserving matrix X ∈Q(G).
Now, take the same graph and faultable vertices but change
the set of observer vertices to VO = {2, 3}. Again, we have
dist(0, VO) = dist(9, VO) = 2, but this time WO = {2, 3}. The
new bipartite graph GOF is depicted in Figure 7.4b. There are
two 2-matchings, namely
{0, 3}, {9, 2}
	
and
{0, 4}, {9, 3}
	
.
As such, neither of them is a constrained matching and we
cannot conclude whether the output separability condition is
satisﬁed by employing Theorem 7.5.
The result of Theorem 7.5 can also be used for the design of
systems on graphs: given a set of faultable vertices VF, one way
to guarantee output separability is to place sensors at certain
(non-faultable) observer vertices so that the matching condition
of Theorem 7.5 is satisﬁed.
The next example illustrates a pathological case for which
the matching condition of Theorem 7.5 is not satisﬁed for any
choice of observer vertices.
Example 7.7 Consider the graph depicted in Figure 7.3. Sup-
pose that VF = {1, 5}. Since dist(1, i) = dist(5, i) for any vertex
i ̸∈VF, there is no choice of VO for which the matching condi-
tion of Theorem 7.5 can be satisﬁed.
100

7.5 conclusions
Based on this example, we can prove the following lemma,
which can be seen as a necessary condition for output separa-
bility for the class of distance-information preserving matrices.
Lemma 7.8 Consider the system (7.1) for a simple and connected
graph G = (V, E) with faultable vertices VF and observer vertices
VO. Let {i, j} ⊆VF. Suppose that dist(i, k) = dist(j, k) for any k ̸∈
{i, j}. Then there exists at least one choice of a distance-information
preserving matrix X with respect to the graph G = (V, E) such that
the subspaces NT ∗
i and NT ∗
j coincide.
Proof. Let A denote the adjacency matrix corresponding to the
graph G = (V, E), then A is a distance-information preserving
matrix with respect to the graph G. As dist(i, k) = dist(j, k)
for any k ̸∈{i, j}, we have that Ai,k = Aj,k for any k ̸∈{i, j}.
Moreover, we have
(Aℓ)i,k = (Aℓ)j,k
for any integer ℓ⩾1 and k ̸∈{i, j}, which implies that
N(Aℓ)i = N(Aℓ)j
for all ℓ⩾1. Then, Lemma 7.4 implies that
NT ∗
i = NT ∗
j .
As such, the output separability requirement is not satisﬁed by
the choice of X = A.
■
7.5
conclusions
In this chapter we have studied the fault detection and isolation
problem for systems deﬁned over graphs. First, we have pro-
vided a characterization of the so-called conditioned invariant
subspaces of such systems with the distance-information preser-
vation property. These subspaces play a major role in the analy-
sis of fault detection as well as design of fault detectors. Based
on this characterization, we have presented graph-theoretical
sufﬁcient conditions for the so-called output separability re-
quirement that is the crux of the fault detection problem in the
setting of geometric control. The graph-theoretical sufﬁcient
condition was illustrated on two examples. Based on another
example, we have also presented a condition under which the
101

7. fdi for systems defined over graphs
output separability fails for the class of distance-information
preserving matrices.
Investigating sharper sufﬁcient conditions, devising an ob-
server vertex selection method and formulating conditions that
would guarantee the asymptotic stability of fault detectors are
among the future research problems.
102

8
C O N S E NSUS DYNAMICS WITH ARBITRARY
S I G N - P R ESERVING NONLINEARITIES
abstract: This chapter studies consensus problems for multi-agent systems deﬁned
on directed graphs where the consensus dynamics involves nonlinear and discontinuous
functions. Sufﬁcient conditions, involving the nonlinear functions and the topology
of the underlying graph, for the agents to converge to consensus are provided. This
chapter is based on the paper [Wei et al., 2016].
8.1
introduction
Apart from the popular linear consensus protocols, nonlinear
agreement protocols have recently attracted the attention of
many researchers. The nonlinear consensus protocols may arise
due to the nature of the controller, see e.g. [Jafarian and De Per-
sis, 2015; Saber and Murray, 2003], or may describe the physical
coupling existing in the network, see e.g. [Bürger et al., 2014;
Monshizadeh and De Persis, 2015]. In this chapter, we consider
a general nonlinear consensus protocol. The topology among
the agents is assumed to be a directed graph containing a di-
rected spanning tree, which for the linear consensus protocol is
known to be a sufﬁcient and necessary condition for reaching
state consensus.
The related works to this chapter can be divided into two cat-
egories, depending on whether the dynamical systems are con-
tinuous or not. For the case of continuous dynamical systems,
closely related to this chapter are [Papachristodoulou et al.,
2010] and [Lin et al., 2007]. In [Papachristodoulou et al., 2010],
a general ﬁrst-order consensus protocol with a continuous non-
linear function is considered for the case that there is a delay
in the communication. In [Lin et al., 2007], the authors consid-
ered a nonlinear consensus protocol with Lipschitz continuous
functions, under a switching topology. For the case of discon-
tinuous dynamical system, [Cortés, 2006] is one of the major
motivations of this chapter. Nonlinearities of the form of sign
functions were considered in [Cortés, 2006], where the notion of
Filippov solutions is employed. However, in order to guarantee
the conclusion about the second network consensus protocol in
[Cortés, 2006], more precise conditions turn out to be necessary.
103

8. consensus with sign-preserving nonlinearities
This is formulated as the main result in Section 8.3.2. In [De Per-
sis and Frasca, 2013], the authors considered a similar control
protocol as in [Cortés, 2006] in a hybrid dynamical systems
framework with a self-triggered communication policy, which
avoids the notion of Filippov solutions. In addition, in [De Per-
sis and Frasca, 2013] practical consensus is considered, that is,
consensus within a predeﬁned margin. The results presented
in [Cortés, 2006; De Persis and Frasca, 2013] are restricted to
undirected graphs. In [Dimarogonas and Johansson, 2010], the
authors considered quantized communication protocols within
the framework of hybrid dynamical systems, without using the
notion of Filippov solutions. In this chapter we will consider a
general nonlinear consensus protocol which incorporates the
corresponding models in the previous works, and analyze the
asymptotic stability of Filippov solutions.
The contribution of this chapter is to provide a uniform
framework to analyze the asymptotic convergence towards
consensus of a ﬁrst-order consensus protocol for a very general
class of discontinuous nonlinear functions, under the weakest
ﬁxed topology assumption, i.e., a directed graph containing
a directed spanning tree. The analysis is conducted with the
notion of Filippov solutions, and generalizes and corrects the
second network consensus protocol in Cortés [2006]
The structure of the chapter is as follows. In Section 8.2, we
introduce some terminology and notation in the context of
graph theory and stability analysis of discontinuous dynam-
ical systems. The main results are presented in Theorem 8.7
and Theorem 8.18 in Section 8.3. The general problem is intro-
duced in Section 8.3.1, whereafter in Sections 8.3.2 and 8.3.3,
two important subcases are considered. These results are then
combined in Section 8.3.4.
8.2
preliminaries and notations
In this section we brieﬂy review some notions from graph the-
ory, and give some deﬁnitions and notation regarding Filippov
solutions.
Let G = (V, E, A) be a weighted digraph with node set
V = {v1, . . . , vn}, edge set E ⊆V × V, and weighted adja-
cency matrix A = [aij] with nonnegative adjacency elements
aij. An edge of G is denoted by eij := (vi, vj) and we write
I = {1, 2, . . . , n}. The adjacency elements aij are associated
with the edges of the graph in the following way: aij > 0 if and
104

8.2 preliminaries and notations
only if eji ∈E. Moreover, aii = 0 for all i ∈I. For undirected
graphs, A = AT.
The set of neighbors of node vi is denoted by Ni := {vj ∈
V : eji ∈E}. For each node vi, its in-degree and out-degree are
deﬁned as
degin(vi) =
n
∑
j=1
aij,
degout(vi) =
n
∑
j=1
aji.
The degree matrix of the digraph G is a diagonal matrix ∆
where ∆ii = degin(vi). The graph Laplacian is deﬁned as
L = ∆−A
and satisﬁes L1 = 0, where 1 is the n-vector containing only
ones. We say that a node vi is balanced if its in-degree and out-
degree are equal. The graph G is called balanced if all of its
nodes are balanced or, equivalently, if 1TL = 0.
A directed path from node vi to node vj is a chain of edges
from E such that the ﬁrst edge starts from vi, the last edge
ends at vj and every edge in between starts where the previous
edge ends. If for every two nodes vi and vj there is a directed
path from vi to vj, then the graph G is called strongly connected.
A subgraph G′ = (V′, E′, A′) of G is called a directed spanning
tree for G if V′ = V, E′ ⊆E, and for every node vi ∈V′ there
is exactly one node vj such that eji ∈E′, except for one node,
which is called the root of the spanning tree. Furthermore, we
call a node v ∈V a root of G if there is a directed spanning tree
for G with v as a root. In other words, if v is a root of G, then
there is a directed path from v to every other node in the graph.
A digraph G is called weakly connected if Go is connected, where
Go is the undirected graph obtained from G by ignoring the
orientation of the edges.
The saturation function sat(x ; u−, u+) : Rn →Rn is deﬁned
component-wisely as
sat(x ; u−, u+)i =





u−
i
if xi < u−
i ,
xi
if xi ∈[u−
i , u+
i ],
u+
i
if xi > u+
i ,
i ∈I,
(8.1)
where u−and u+ are n-vectors containing the lower and upper
bounds respectively. The sign function sign(x) : Rn →Rn is
deﬁned as
sign(x)i =





−1
if xi < 0,
0
if xi = 0,
1
if xi > 0,
i ∈I.
(8.2)
105

8. consensus with sign-preserving nonlinearities
With R−, R+ and R⩾0 we denote the sets of negative, pos-
itive and nonnegative real numbers respectively. The vectors
e1, e2, . . . , en denote the canonical basis of Rn. The ith row and
jth column of a matrix M are denoted by Mi• and M•j re-
spectively. For the empty set, we adopt the convention that
max ∅= −∞.
In the rest of this section we give some deﬁnitions and nota-
tion regarding Filippov solutions (see, e.g., [Cortés, 2008]). Let
F be a map from Rn to Rn, and let 2Rn denote the collection
of all subsets of Rn. The map F is essentially bounded if there
is a bound B such that ∥F(x)∥2 < B for almost every x ∈Rn.
The map F is locally essentially bounded if the restriction of F to
every compact subset of Rn is essentially bounded. We deﬁne
the Filippov set-valued map of F, denoted F[F] : Rn →2Rn, as
F[F](x) ≜
\
δ>0
\
µ(S)=0
co{F(B(x, δ)\S)},
(8.3)
where B(x, δ) is the open ball centered at x with radius δ > 0,
S is a subset of Rn, µ denotes the Lebesgue measure and co
denotes the convex closure. The zero measure set S is arbitrarily
chosen. Hence, the set F[F](x) is independent of the value of
F(x). If F is continuous at x, then F[F](x) contains only the
point F(x). A Filippov solution of the differential equation ˙x(t) =
F(x(t)) on [0, t1] ⊂R is an absolutely continuous function
x : [0, t1] →Rn that satisﬁes the differential inclusion
˙x(t) ∈F[F](x(t))
(8.4)
for almost all t ∈[0, t1].
Let f be a map from Rn to R. The right directional derivative
of f at x in the direction of v ∈Rn is deﬁned as
f ′(x; v) = lim
h→0+
f (x + hv) −f (x)
h
,
when this limit exists. The generalized derivative of f at x in
the direction of v ∈Rn is given by
f o(x; v) = lim sup
y→x
h→0+
f (y + hv) −f (y)
h
= lim
δ→0+
ϵ→0+
sup
y∈B(x,δ)
h∈(0,ϵ)
f (y + hv) −f (y)
h
.
106

8.3 main results
We call the function f regular at x if f ′(x; v) and f o(x; v) are
equal for all v ∈Rn. For example, convex functions are regular,
see e.g.,[Clarke, 1990].
If f : Rn →R is locally Lipschitz, then its generalized gradi-
ent ∂f : Rn →2Rn is a set-valued function deﬁned by
∂f (x) := co{lim
i→∞∇f (xi) : xi →x, xi /∈S ∪Ωf },
(8.5)
where ∇denotes the gradient operator, Ωf ⊂Rn denotes the
set of points where f fails to be differentiable, and S ⊂Rn is a
set of measure zero that can be chosen arbitrarily to simplify
the computation. The resulting set ∂f (x) is independent of the
choice of S [Clarke, 1990].
Given a set-valued map F : Rn →2Rn, the set-valued Lie
derivative ˜LF f : Rn →2R of a locally Lipschitz function f :
Rn →R with respect to F at x is deﬁned as
˜LF f (x) := {a ∈R |∃ν ∈F(x) such that
ζTν = a for all ζ ∈∂f (x)}.
(8.6)
A Filippov solution t 7→x(t) is maximal if it cannot be ex-
tended forward in time, that is, if t →x(t) is not the result of
the truncation of another solution with a larger interval of deﬁ-
nition. Since the Filippov solutions of a discontinuous system
(8.4) are not necessarily unique, we need to specify two types
of invariant set. A set R ⊂Rn is called weakly invariant for
(8.4) if, for each x0 ∈R, at least one maximal solution of (8.4)
with initial condition x0 is contained in R. Similarly, R ⊂Rn
is called strongly invariant for (8.4) if, for each x0 ∈R, every
maximal solution of (8.4) with initial condition x0 is contained
in R. For more details, see [Cortés, 2008].
8.3
main results
8.3.1
Problem formulation
In this chapter we consider a network of n agents, who com-
municate according to a communication topology given by a
weighted directed graph G = (V, E, A). In this network, agent i
receives information from agent j if and only if there is an edge
from node vj to node vi in the graph G. We denote the state
107

8. consensus with sign-preserving nonlinearities
of agent i at time t as xi(t) ∈R, and consider the following
dynamics for agent i
˙xi = fi(
n
∑
j=1
aijgij(xj −xi)) =: hi(x),
(8.7)
where fi and gij are functions from R to R and aij are the
elements of the adjacency matrix A.
Each function fi describes how agent i handles incoming
information, while the functions gij are concerned with the
ﬂow of information along the edges of the graph G. All these
functions are nonlinear and may have discontinuities, but we
will use the concept of sign-preserving functions.
Deﬁnition 8.1 We say that a function ϕ : R →R is sign pre-
serving if ϕ(0) = 0 and for each y ∈R \ {0} we have both
yϕ(y) > 0 and min yF[ϕ](y) > 0.
Examples of sign-preserving functions are the signum func-
tion sign and the saturation function sat. If a function ϕ has
only ﬁnitely many discontinuities, e.g. when it is piecewise
continuous, then the condition yF[ϕ](y) > 0 only needs to be
checked for its discontinuity points. The second condition in
Deﬁnition 8.1, min yF[ϕ](y) > 0 for all y ∈R \ {0}, will be
illustrated in Example 8.4.
Throughout this chapter, we assume the following.
Assumption 8.2 The functions fi and gij are sign preserving,
Lebesgue measurable, and locally essentially bounded.
To handle possible discontinuities in the right-hand side of (8.7),
we consider Filippov solutions of the differential inclusion
˙x(t) ∈F[h](x(t)).
(8.8)
The existence of a Filippov solution for each initial condition
is guaranteed by the Lebesgue measurability and the local
essential boundedness of the functions fi and gij in Assumption
8.2. In this chapter we assume the completeness of Filippov
solutions of (8.8) for any initial condition. Notice that when the
functions hi are globally bounded, e.g., if fi and gij are chosen
as signum or saturation functions, then the completeness of
Filippov solution of (8.8) is guaranteed by Theorem 1 in §7
108

8.3 main results
of Chapter 2 in [Filippov, 1988]. Moreover, by property 3 of
Theorem 1 in [Paden and Sastry, 1987], we have
F[h](x(t)) ⊂
n×
i=1
F[hi](x(t))
(8.9)
where×denotes the Cartesian product.
The agents of the network are said to achieve consensus if
they all converge to the same value, that is,
lim
t→∞x(t) = η1
for some constant η ∈R, where x(t) = [x1(t), . . . , xn(t)]T is a
solution of (8.7) with x(0) = x0. It is well known that if all
functions fi and gij are the identity function, in which case (8.7)
boils down to the linear consensus protocol, then the agents will
achieve consensus if and only if the graph G contains a directed
spanning tree [Agaev and Chebotarev, 2005; Ren et al., 2005]. In
this chapter, we investigate the consensus problem for general
functions fi and gij satisfying Assumption 8.2. First, in Section
8.3.2, we consider the special case that the functions gij are
equal to the identity function, that is ˙xi = fi(∑n
j=1 aij(xj −xi)).
Thereafter, in Section 8.3.3, we consider the case where the func-
tions fi are the identity function, that is ˙xi = ∑n
j=1 aijgij(xj −xi).
Finally, in section 8.3.4, we will combine these results.
The following examples motivate the sign-preserving condi-
tion by showing what happens if the functions fi and gij do
not satisfy this property.
Example 8.3 Consider the following system deﬁned on the
graph given in Fig. 8.5a
˙x1 = f1(0)
(8.10a)
˙x2 = f2(x1 −x2),
(8.10b)
with fi(y) = sat(y; 0, 1) for i = 1, 2. Notice that fi satisﬁes
y fi(y) = 0 for all y < 0, and hence fi is not sign preserving.
In this case the existence of a directed spanning tree is not a
sufﬁcient condition for convergence to consensus. Indeed, if
the initial condition satisﬁes x2(0) > x1(0), then x1(t) = x1(0)
and x2(t) = x2(0) for all t ⩾0. Hence, the agents do not reach
consensus.
109

8. consensus with sign-preserving nonlinearities
v1
v2
e12
(a)
v1
v2
e12
e21
(b)
Figure 8.5: Two digraphs with two nodes for Examples 8.3, 8.10 and
8.11. (a) Digraph with spanning tree and (b) Strongly con-
nected digraph.
Example 8.4 Consider the system (8.10) deﬁned on the digraph
in Fig. 8.5a with fi given by
fi(y) =





y + 1
if y < −1
y
if y ∈[−1, 1],
y −1
if y > 1
i = 1, 2.
(8.11)
Then the function fi satisﬁes fi(0) = 0 and y fi(y) > 0 for all
y ̸= 0. However, since F[ fi](1) = [0, 1] and F[ fi](−1) = [−1, 0],
we have that min yF[ fi](y) > 0 is not satisﬁed for y = ±1.
Hence, fi is not sign preserving. Consider the point x∗= [0, 1]T,
we have
F[h](x∗) = co{[0, −1]T, [0, 0]T},
which contains the point [0, 0]T. Consequently, x∗is an equilib-
rium point of the differential inclusion ˙x(t) ∈F[h](x(t)). For
example, the trajectory
x1(t) = 0, x2(t) = 1 + e−t
is a solution of (8.10) which converges to x∗. Therefore, the
agents do not reach consensus.
8.3.2
Node nonlinearity
We ﬁrst consider the system (8.7) where the functions gij are all
the identity function, and focus our attention on the functions fi,
which describe how agent i handles the incoming information
ﬂow. In this case, the total dynamics of the agents can be written
as
˙x = f (−Lx),
(8.12)
110

8.3 main results
where L is the graph Laplacian induced by the information
ﬂow digraph G = (V, E, A), and f : Rn →Rn is deﬁned as
f (y) = [ f1(y1), f2(y2), . . . , fn(yn)]T.
In this case we consider Filippov solutions of the differential
inclusion
˙x(t) ∈F[h](x(t)),
(8.13)
where h(x) = f (−Lx). Note that, since L is a singular matrix,
we have F[h](x(t)) ̸= F[ f ](−Lx(t)) in general.
The aim of this section is to investigate under which condi-
tions the Filippov solutions of the system (8.13) achieve con-
sensus. Because of possible discontinuity of the right-hand
side of (8.12), there can be Filippov solutions of (8.13) that are
unbounded. The following example illustrates this unwanted
behavior.
Example 8.5 Consider a dynamical system (8.12) deﬁned on
an undirected graph with three nodes, as given in Fig. 8.6a,
where the functions fi are all given by the signum function:
˙x1 = sign(x2 + x3 −2x1)
˙x2 = sign(x1 + x3 −2x2)
˙x3 = sign(x1 + x2 −2x3).
Suppose that at time t0 we have x(t0) ∈span{1}, then
F[h](x(t0)) = co {ν1, ν2, ν3, −ν1, −ν2, −ν3} ,
(8.14)
where ν1 = [1, 1, −1]T, ν2 = [1, −1, 1]T, and ν3 = [−1, 1, 1]T.
Since ∑3
i=1
1
3νi =
1
31, we have that {η1 | η ∈[−1
3, 1
3]} ⊂
F[h](x(t0)). Hence, any function x(t) = η(t)1 with η(t) dif-
ferentiable almost everywhere and satisfying ˙η(t) ∈[−1
3, 1
3] is
a Filippov solution for this system. For example, x(t) = 1
31
and x(t) = 1
3 sin (t)1 are Filippov solutions for this system that
exhibit sliding consensus.
The undesirable behavior x(t) = η(t)1 with η(t) a noncon-
stant function in the previous example will be called sliding
consensus. Sliding consensus arises whenever η1 is contained in
F[h](α1) for some scalars η ̸= 0 and sufﬁciently many α. Note
that this example shows that for the validity of Theorem 11 in
[Cortés, 2006] we need extra conditions; a counter example to
Theorem 11 (i) in Cortés [2006] can be constructed similarly to
111

8. consensus with sign-preserving nonlinearities
v1
v2
v3
(a)
v1
v2
v3
(b)
Figure 8.6: Two graphs with three nodes, used in Examples 8.5, 8.9,
8.13 and 8.16. (a) Undirected graph and (b) Directed graph.
Example 8.5. In fact, it will turn out that the sliding consensus
can be excluded by replacing the signum function for at least
one node by a function that is continuous at the origin. This
motivates the introduction of the following subsets of the index
set I corresponding to the digraph G:
Ir = {i ∈I | vi is a root of G},
Ic = {i ∈I | fi is continuous at the origin}.
Before we present the main result of this section, we ﬁrst
state a preparatory lemma [Clarke, 1990, Prop. 2.2.6 and Prop.
2.3.6].
Lemma 8.6 The following functions are regular and Lipschitz con-
tinuous,
V(x) := max
i∈I xi,
W(x) := −min
i∈I xi.
(8.15)
Theorem 8.7 Consider system (8.13) deﬁned on a digraph G =
(V, E, A). If one of the following three conditions holds, i.e.,
(i) Ic ∩Ir is not empty,
(ii) |Ir| = 1,
(iii) |Ir| = 2, fi(0−) and fi(0+) exist, and fi(0−) = −fi(0+) for
i ∈Ir,
then all the trajectories of system (8.13) achieve consensus asymp-
totically, for any initial condition. Furthermore, they will remain in
the set [mini xi(0), maxi xi(0)]n for all t ⩾0.
112

8.3 main results
Proof. Notice that in all three cases the index set Ir is nonempty,
which implies that the graph G contains a directed spanning
tree. Condition (i) implies that the digraph G has a root vi for
which fi is continuous at the origin.
Consider candidate Lyapunov functions V and W as given
in (8.15). By Lemma 8.6, the functions V and W are regular
and Lipschitz continuous. Let x(t) be a trajectory of (8.13) and
deﬁne
α(t) = {k ∈I | xk(t) = V(x(t))}.
The generalized gradient of V is given as [Clarke, 1990, Exam-
ple 2.2.8]
∂V(x(t)) = co{ek ∈Rn | k ∈α(t)}.
(8.16)
Let Ψ be deﬁned as
Ψ = {t ⩾0 | both ˙x(t) and d
dtV(x(t)) exist}.
(8.17)
Since x is absolutely continuous and V is locally Lipschitz, we
have that Ψ = R⩾0 \ ¯Ψ for a set ¯Ψ of measure zero. By Lemma
1 in [Bacciotti and Ceragioli, 1999], we have
d
dtV(x(t)) ∈˜LF[h]V(x(t))
(8.18)
for all t ∈Ψ and hence that the set ˜LF[h]V(x(t)) is nonempty
for all t ∈Ψ. For t ∈¯Ψ, we have that ˜LF[h]V(x(t)) is empty, and
hence max ˜LF[h]V(x(t)) < 0. For t ∈Ψ, let a ∈˜LF[h]V(x(t)).
By deﬁnition, there exists a νa ∈F[h](x(t)) such that a = νa · ζ
for all ζ ∈∂V(x(t)). Consequently, by choosing ζ = ek for
k ∈α(t), we observe that νa satisﬁes
νa
k = a
∀k ∈α(t).
(8.19)
Next, we want to show that max ˜LF[h]V(x(t)) ⩽0 for all t ∈Ψ
by considering two possible cases: Ir ⊈α(t) or Ir ⊆α(t).
If Ir ⊈α(t), then there exists an i ∈Ir such that xi(t) <
V(x(t)). Furthermore, since vi is a root, we can choose an index
j ∈α(t) such that the shortest path from vi to vj has the least
number of edges. By our choice of j, there is at least one edge
ekj ∈E such that xk(t) < xj(t), which implies that we have
−Lj•x(t) < 0. Moreover, the existence of an edge ekj implies
that rank Lj• = 1, which together with property 4 of Theorem
1 in [Paden and Sastry, 1987] gives us
F[hi](x(t)) = F[ fj](−Lj•x(t)).
(8.20)
113

8. consensus with sign-preserving nonlinearities
By the sign-preserving property of fj and −Lj•x(t) < 0, we
have that F[hj](x(t)) ⊂R−. By (8.9), we ﬁnd that νj < 0 for
any ν ∈F[h](x(t)). Using observation (8.19) for k = j, we see
that every a ∈˜LF[h]V(x(t)) satisﬁes a < 0. By the fact that
˜LF[h]V(x(t)) is a closed set, we have max ˜LF[h]V(x(t)) < 0.
If Ir ⊆α(t), we will consider the conditions (i), (ii) and (iii)
separately and prove that ˜LF[h]V(x(t)) = {0}. First, we note
that if a node vk is a root, then ejk ∈E implies that vj is a root
as well, and hence we have
(−Lx)k = ∑
j∈I
akj(xj −xk) = ∑
j∈Ir
akj(xj −xk).
(8.21)
(i) In this case Ic ∩Ir ⊆α(t). For any i ∈Ic ∩Ir, we have
that fi is continuous at 0 and satisﬁes fi(0) = 0. This
implies that any ν ∈F[h](x(t)) satisﬁes νi = 0. Using
observation (8.19), we can conclude that ˜LF[h]V(x(t)) =
{0}.
(ii) Let Ir = {i}. Since there is only one root in this case,
namely vi, we have Li• = 0 and hence fi((Lx(t))i) =
fi(0) = 0 for all t. Consequently, each ν ∈F[h](x(t))
satisﬁes νi = 0. Using observation (8.19) again, we see
that ˜LF[h]V(x(t)) = {0}.
(iii) Let Ir = {i, j}. By (8.21), the dynamics of xi and xj are
given as ˙xi = fi(aij(xj −xi)) and ˙xj = fj(aji(xi −xj))
respectively.
Since Ir ⊆α(t), we have xi(t) = xj(t) and hence any
ν ∈F[h](x(t)) satisﬁes
νi
νj

⊆co{
 fi(0−)
fj(0+)

,
 fi(0+)
fj(0−)

}
= co{
 fi(0−)
fj(0+)

, −
 fi(0−)
fj(0+)

},
(8.22)
where the last equality is implied by condition (iii). More-
over, by condition (iii), the convex set given in (8.22) is a
line segment that only crosses span{[1, 1]T} in the origin.
This implies that any ν ∈F[h](x(t)) with νi = νj must
satisfy νi = νj = 0. Using ∂V(x(t)) = co{ei, ej ∈Rn} and
(8.19), we see that ˜LF[h]V(x(t)) = {0}.
Deﬁne β(t) = {i ∈I | xi(t) = −W(x(t))}. By using sim-
ilar computations and observations as above, we ﬁnd that
114

8.3 main results
max ˜LF[h]W(x(t)) < 0 if Ir ⊈β(t), and max ˜LF[h]W(x(t)) ⩽0
if Ir ⊆β(t).
We conclude that V(x(t)) and W(x(t)) are not increasing
along the trajectories x(t) of the system (8.13). Hence, the trajec-
tories are bounded and remain in [mini xi(0), maxi xi(0)]n for
all t ⩾0. Therefore, for any N ∈R+, the set SN = {x ∈Rn |
∥x∥∞⩽N} is strongly invariant for (8.13). By Theorem 2 in
[Cortés, 2008], we have that all solutions of (8.13) starting at SN
converge to the largest weakly invariant set M contained in
SN ∩{x | 0 ∈˜LF[h]V(x)} ∩{x | 0 ∈˜LF[h]W(x)}.
(8.23)
From the argument above we see that 0 ∈
˜LF[h]V(x(t)) is
only possible if Ir ⊆α(t), and 0 ∈
˜LF[h]W(x(t)) can only
happen if Ir ⊆β(t). This implies that for every root vi, the
state xi converges simultaneously to the maximum and to
the minimum, i.e., the trajectories x(t) of the system achieve
consensus for any initial condition.
■
Remark 8.8 The set Ic collects all the functions which are
continuous at the origin. In fact, this set can be enlarged such
that it contains all the functions which are essentially continuous
at the origin, i.e., ess limxi→0−fi(xi) = ess limxi→0+ fi(xi) = 0
(for deﬁnitions see e.g. [Arutyunov, 2000; Chung and Walsh,
2006]). This can be done since in the deﬁnitions of both essential
limits and Filippov set-valued map, any zero measure set can be
excluded. For condition (iii) in Theorem 8.7, the same extension
is possible; considering essential limits in stead of limits.
The conditions (i), (ii) and (iii) in Theorem 8.7 all exclude
the possibility of sliding consensus, and guarantee asymptotic
consensus. The role of each condition will be illustrated in the
following examples.
Example 8.9 Consider system (8.12) deﬁned on the undirected
graph in Fig. 8.6a, deﬁned as
˙x1 = f1(x2 + x3 −2x1)
˙x2 = f2(x1 + x3 −2x2)
˙x3 = f3(x1 + x2 −2x3).
Suppose that f1 is continuous at the origin, so that condition
(i) in Theorem 8.7 is satisﬁed. Then the sliding consensus is
not a Filippov solution. Indeed, if at time t0 we have x(t0) ∈
115

8. consensus with sign-preserving nonlinearities
span{1}, then the ﬁrst component of the Filippov set-valued
map F[h](x(t0)) is equal to {0}. This implies that x(t) = x(t0),
for all t ⩾t0.
Example 8.10 Consider system (8.10) deﬁned on the digraph
in Fig. 8.5a. It satisﬁes condition (ii) of Theorem 8.7. Since
f1(0) = 0, the state of the root v1 is constant. Consensus is
achieved by the fact that f2 is sign preserving.
Example 8.11 Consider system (8.12) deﬁned on the digraph
given in Fig. 8.5b with a12 = a21 = 1. The dynamics are given
by
˙x1 = f1(x2 −x1)
˙x2 = f2(x1 −x2).
First, we consider a case in which f1 and f2 satisfy condi-
tion (iii) of Theorem 8.7 and take f1 = f2 = sign(·). If the
trajectory achieves consensus at time t, the Filippov set-valued
map F[h](x(t)) equals co{[1, −1]T, [−1, 1]T}, which intersects
span{1} only at [0, 0]T. Hence ˜LF[h]V(x) = ˜LF[h]W(x) = 0,
which implies that the trajectory remains constant, i.e., there is
no sliding consensus.
Second, we consider a case in which fi(0−) ̸= −fi(0+) for
i = 1, 2, which means that the conditions of Theorem 8.7 (and
condition (iii) in particular) are not satisﬁed. In this case, sliding
consensus can be a Filippov solution. For instance, take
fi(x) =



2
if x > 0
0
if x = 0,
−1
if x < 0
i = 1, 2.
Suppose that at t0 the state x achieves consensus. Then the
Filippov set-valued map at x(t0) is co{[−1, 2]T, [2, −1]T} which
intersects span{1} at [ 1
2, 1
2]T. Then x(t) =
1
21t + x(t0) is a
Filippov solution for t ⩾t0 that exhibits sliding consensus.
8.3.3
Edge nonlinearity
In this section we consider the case where the functions fi are
all the identity function, that is,
˙xi =
N
∑
j=1
aijgij(xj −xi)
(8.24)
=: hi(x),
i ∈I.
116

8.3 main results
We consider two cases, corresponding to the underlying graph
G = {V, E} being undirected or directed, starting with the
undirected case. We introduce the following assumption on the
functions gij.
Assumption 8.12 For all eji ∈E, the right and left limits of gij
and gji at the origin exist, and satisfy gij(0−) = −gji(0+).
To illustrate the need of Assumption 8.12, we give the following
example.
Example 8.13 If gij(0−) ̸= −gji(0+), then sliding consensus
may occur. For instance, consider the system (8.24) deﬁned on
the undirected graph in Fig. 8.6a given by
˙x1(t) = g12(x2(t) −x1(t)) + g13(x3(t) −x1(t))
˙x2(t) = g21(x1(t) −x2(t)) + g23(x3(t) −x2(t))
˙x3(t) = g31(x1(t) −x3(t)) + g32(x2(t) −x3(t))
where
gij(x) =





1.5
if x > 0,
0
if x = 0,
−0.5
if x < 0,
∀eji ∈E,
Suppose that at time t0 the state satisﬁes x(t0) ∈span{1}, then
F[h](x(t0)) is the closed convex hull of
{


−1
1
3

,


−1
3
1

,


1
−1
3

,


3
−1
1

,


1
3
−1

,


3
1
−1

}.
Hence, 1 is an element in F[h](x(t0)) and thus x(t) = t1 +
x(t0) is a Filippov solution for t > t0.
Next, we present the main result of this section.
Theorem 8.14 Consider the dynamics (8.24) deﬁned on a connected
undirected graph. Suppose the functions gij satisfy Assumptions 8.2
and 8.12. Then the trajectories of the system (8.24) achieve consensus
asymptotically.
Proof. Consider the Lyapunov candidate functions V and W as
deﬁned in (8.15). We use the same notations as in the proof of
Theorem 8.7. Similarly, as the proof of Theorem 8.7, we only
prove that max ˜LF[h]V(x(t)) ⩽0 for all t ∈Ψ where R⩾0 \ Ψ
117

8. consensus with sign-preserving nonlinearities
is a set of measure zero and the set ˜LF[h]V(x(t)) is nonempty
for all t ∈Ψ.
By introducing the functions ϕji(x) = (ej −ei)Tx for i, j ∈I,
the function hi(x) in (8.24) can be rewritten as
hi(x) =
n
∑
j=1
aij(gij ◦ϕji)(x).
(8.25)
Then, using Theorem 1 in [Paden and Sastry, 1987], we see that
the Filippov set-valued map F[h](x) satisﬁes
F[h](x) ⊂
n×
i=1
F[hi](x)
⊂
n×
i=1
n
∑
j=1
aijF[gij ◦ϕji](x)
=
n×
i=1
n
∑
j=1
aijF[gij](ϕji(x)).
(8.26)
By property 1 in Theorem 1 in [Paden and Sastry, 1987], for
each gij there exists a set Ngij ⊂Rn with µ(Ngij) = 0 such that
F[gij](z) = co{ lim
k→∞h(zk) | lim
k→∞zk = z, zk /∈Ngij ∪N′} (8.27)
for any set N′ with µ(N′) = 0. Similarly, there exists a set
Nh ⊂Rn with ∪eij∈ENgij ⊂Nh and µ(Nh) = 0 such that
F[h](x(t)) = co{ lim
k→∞h(yk) | lim
k→∞yk = x(t), yk /∈Nh ∪S},
(8.28)
where S = {x ∈Rn | ∃i, j ∈I such that xi = xj}, which has
measure zero in Rn. Notice that Rn \ S admits a partition Rn \
S = S1 ∪S2 ∪· · · ∪S2n, with S1, S2, . . . , S2n open sets satisfying
Si ∩Sj = ∅for all i ̸= j, such that within a ﬁxed open set Si, the
components y1, y2, . . . , yn of each vector y ∈Si are all different
and have the same ﬁxed order.
Now, to study the right-hand side of (8.28), let t be a given
time and let (yk) be a sequence in Rn \ (Nh ∪S) that converges
to x(t) for which the limit ˜h := limk→∞h(yk) exists. Note that
the existence of limk→∞h(yk) means that all the components
˜hi := hi(yk) have a limit. We will study the term ∑i∈α(t) ˜hi in
order to derive that ∑i∈α(t) νi ⩽0 for each ν ∈F[h](x(t)). For
this, we ﬁrst deﬁne two sets of edges, namely
E1(t) = {eij ∈E | i, j ∈α(t)},
E2(t) = {eij ∈E | i ∈α(t), j /∈α(t)}.
(8.29)
118

8.3 main results
The sequence (yk) has a subsequence (ykℓ) such that ykℓ∈Sr
for all ℓfor a ﬁxed r ∈{1, 2, . . . , 2n}. For an edge eij ∈E1, we
have ykℓ
i −ykℓ
j
↑0 or ykℓ
i −ykℓ
j
↓0, depending on the set Sr.
Therefore, we have
lim
ℓ→∞
gij(ϕji(ykℓ))
gji(ϕij(ykℓ))

=
gij(0−)
gji(0+)

or
lim
ℓ→∞
gij(ϕji(ykℓ))
gji(ϕij(ykℓ))

=
gij(0+)
gji(0−)

.
(8.30)
Using Assumption 8.12, we see that in both cases we have
lim
ℓ→∞gij(ϕji(ykℓ)) + gji(ϕij(ykℓ)) = 0.
(8.31)
Now, we can write
∑
i∈α(t)
lim
k→∞hi(yk) = lim
ℓ→∞∑
i∈α(t)
n
∑
j=1
aijgij(ϕji(ykℓ))
= lim
ℓ→∞∑
eij∈E2
aijgij(ϕji(ykℓ)) +
lim
ℓ→∞∑
eij∈E1
aijgij(ϕji(ykℓ))
= lim
ℓ→∞∑
eij∈E2
aijgij(ϕji(ykℓ)) +
1
2 ∑
eij∈E1
lim
ℓ→∞aijgij(ϕji(ykℓ)) + ajigji(ϕij(ykℓ))
= lim
ℓ→∞∑
eij∈E2
aijgij(ϕji(ykℓ)),
(8.32)
where the last two equalities are implied by the fact that the
graph G is undirected and by equation (8.31). Next, we consider
two possible cases: x(t) /∈span{1}, and x(t) ∈span{1}.
First, we look at the case that x(t) /∈span{1}, in which case
E2 ̸= ∅. For an edge eij ∈E2 we have xj < xi, and since gij is a
sign-preserving function, this implies that F[gij](xj −xi) ⊂R−.
As ykℓ/∈Ngij, all the accumulation points of the sequence
{gij(ϕji(ykℓ))} belong to F[gij](xj −xi). Therefore, we see that
∑
i∈α(t)
lim
k→∞hi(yk) = lim
ℓ→∞∑
eij∈E2
aijgij(ϕji(ykℓ)) < 0,
i.e., ∑i∈α(t) ˜hi < 0. By equation (8.28), we can conclude that
∑i∈α(t) νi < 0 for any ν ∈F[h](x(t)). Hence, by observa-
119

8. consensus with sign-preserving nonlinearities
tion (8.19), we have ˜LF[h]V(x(t)) ⊂R−. Since ˜LF[h]V(x(t))
is closed (see e.g. page 63 in [Cortés, 2008]), we have
max ˜LF[h]V(x(t)) < 0.
Second, we consider the case that x(t) ∈span{1}, in which
case E1(t) = E and E2(t) = ∅. In this case, equation (8.32) boils
down to
∑
i∈α(t)
˜hi = ∑
i∈I
lim
k→∞hi(yk) = 0.
(8.33)
By equation (8.28), we can conclude that ∑i∈I νi = 0 for any
ν ∈F[h](x(t)). This implies that ˜LF[h]V(x(t)) = {0} since
1
n1 ∈∂V(x(t)).
By using the same arguments as above, we can prove that
max ˜LF[h]W(x(t)) < 0 if x(t) /∈span{1} and ˜LF[h]W(x(t)) =
{0} if x(t) ∈span{1}.
The above analysis implies that all trajectories are bounded.
Indeed for any N ∈R+ the set SN = {x ∈Rn | ∥x∥∞⩽
N} is strongly invariant. By Theorem 2 in [Cortés, 2008], the
conclusion follows.
■
Remark 8.15 A stronger assumption is to assume that gij(y) =
−gji(−y) for all eij ∈E and all y ∈R. This would imply that
∑i∈I hi(x) = 0 for any x ∈Rn. Hence for any x ∈Rn and
for any ν ∈F[h](x), we have 1Tν = 0. Then any Filippov
solution x(t) of system (8.24) satisﬁes 1T ˙x(t) = 0. Under the
same assumption as in Theorem 8.14, the trajectories of (8.24)
converge to a consensus value deﬁned by the average of the
initial condition.
For the rest of this section, we consider directed graphs. In this
case, Assumption 8.12 is not sufﬁcient to guarantee convergence
to consensus as shown by the following example.
Example 8.16 Consider system (8.24) on the directed graph as
in Fig. 8.6b, where the functions gij are the signum function.
Hence the dynamics can be written as
˙x1 = sign(x3 −x1)
˙x2 = sign(x1 −x2)
˙x3 = sign(x2 −x3).
120

8.3 main results
Suppose that at time t0, the state satisﬁes x(t0) ∈span{1}.
Then the Filippov set-valued map F[h](x(t0)) is the same as in
(8.14). Hence, by the same argument as in Example 8.5, there
are Filippov solutions that exhibit sliding consensus.
For digraphs, we quote the following result for the case that
the functions gij are continuous.
Theorem 8.17 (Papachristodoulou et al. [2010])
Consider the
system (8.24) with continuous functions gij. If the underlying graph
G = {V, E} contains a directed spanning tree, then the trajectories
of (8.24) achieve consensus asymptotically.
Extension of Theorem 8.17 to the case of discontinuous func-
tions gij is a topic for further research.
8.3.4
Combining node and edge nonlinearities
The multi-agent system given in (8.7) can be seen as a combi-
nation of system (8.12) and system (8.24). For this system, we
have the following result.
Theorem 8.18 Consider system (8.7) deﬁned on a digraph G =
{V, E}, with continuous functions gij. If one of the following three
conditions holds, i.e.,
(i) Ir ∩Ic is not empty,
(ii) |Ir| = 1,
(iii) |Ir| = 2, fi(0−) and fi(0+) exist, and fi(0−) = −fi(0+) for
i ∈Ir,
then all Filippov solutions of system (8.12) achieve consensus asymp-
totically, for all initial conditions.
Proof. Since the proof is similar to the proof of Theorem 8.7,
we only provide a sketch of the proof. Recall that α(t) = {i ∈
I | xi(t) = V(x(t))} and β(t) = {i ∈I | xi(t) = −W(x(t))}.
Let V and W be candidate Lyapunov functions. We will show
that max ˜LF[h]V ⩽0 by considering two cases: Ir ⊈α(t) and
Ir ⊆α(t).
When Ir ⊈α(t), there exists at least one k ∈α(t) satisfying
∑n
j=1 akjgkj(xj −xk) < 0. This implies that the kth component
of F[h](x(t)) is contained in R−. Hence, max ˜LF[h]V < 0.
121

8. consensus with sign-preserving nonlinearities
When Ir ⊆α(t), we can use similar arguments as in the
proof of Theorem 8.7 to see that the set-valued Lie derivative
˜LF[h]V(x(t)) is either {0} or ∅if one of the conditions (i), (ii)
and (iii) holds. Hence max ˜LF[h]V(x(t)) ⩽0.
Similarly, we have that max ˜LF[h]W(x(t)) < 0 if Ir ⊈β(t),
and max ˜LF[h]W(x(t)) ⩽0 if Ir ⊆β(t). Based on Theorem 2
in [Cortés, 2008], the conclusion follows.
■
8.4
conclusions
In this chapter, we considered a general model of distributed
multi-agent systems deﬁned on a directed graph, with non-
linear discontinuous functions deﬁned on the nodes and edges.
Since the right-hand sides of the differential equations are dis-
continuous, we interpret the solutions in the Filippov sense.
Under the crucial assumptions of (i) the graph containing a
directed spanning tree, (ii) all nonlinear functions to be sign-
preserving, we provided sufﬁcient conditions for all Filippov
solutions of a nonlinear consensus protocol to achieve consen-
sus.
122

9
C O N C L USIONS AND FUTURE RESEARCH
In this thesis, we studied two types of nonsmooth dynamical
systems; linear multi-modal systems and multi-agent systems
with a nonlinear communication protocol. First, we studied two
problems for linear multi-modal systems: the disturbance de-
coupling problem and the fault detection and isolation problem.
We used ideas and results from geometric control theory for
linear systems and nonsmooth dynamical systems, but had to
take state-dependent switching into account. Finally, we stud-
ied multi-agent systems with nonlinear consensus protocols.
The nonlinear, possibly discontinuous, functions appear on the
nodes and edges of the directed communication graph.
9.1
disturbance decoupling for linear
multi-modal systems
In Chapter 2 we started by studying the disturbance decoupling
problem for a simple class of piecewise linear systems: bimodal
systems. We presented necessary and sufﬁcient conditions for
such systems to be disturbance decoupled. Furthermore, we
have given a complete characterization of the solvability of the
disturbance decoupling problem with mode-independent and
mode-dependent feedback controllers. In order to verify the
presented conditions, we provided subspace algorithms.
Next, in Chapter 3, we directed our attention to more general
continuous piecewise afﬁne systems. We established necessary
conditions as well as sufﬁcient conditions for a piecewise afﬁne
system to be disturbance decoupled. Unfortunately, these con-
ditions do not coincide in general. However, we identiﬁed a
number of particular cases for which they do coincide. Fur-
thermore, we provided conditions for the existence of a mode-
independent static feedback controller that renders a given
piecewise afﬁne system disturbance decoupled. All presented
conditions are geometric in nature and easily veriﬁable.
Then in Chapter 4, we turned our attention to linear comple-
mentarity systems of index zero, which can be rewritten as a
particular class of linear multi-modal systems. The resulting
system is closely related to the piecewise afﬁne systems in
123

9. conclusions and future research
Chapter 3, and its linear subsystems exhibit a certain geometric
structure. By exploiting this geometric structure, we provided
necessary and sufﬁcient conditions for a linear complemen-
tarity system to be disturbance decoupled. These conditions
are more compact and perhaps more insightful than the con-
ditions that we found for general piecewise afﬁne systems in
Chapter 3.
Finally, in Chapter 5, we combined the ideas developed in
the previous chapters to tackle the disturbance decoupling
problem for a general class of linear multi-modal systems.
We presented necessary conditions and sufﬁcient conditions,
geometric in nature, under which such multi-modal systems
are disturbance decoupled. These results generalize the existing
results in the literature on switched linear systems [Yurtseven
et al., 2012], as well as bimodal systems (Chapter 2), conewise
linear systems (Chapter 3) and linear complementarity systems
namely those of index zero (Chapter 4). In addition, these
results led to novel necessary and sufﬁcient conditions for
passive-like linear complementarity systems whose disturbance
decoupling properties were not been studied before. For the
presented general linear multi-modal system the necessary
condition and the sufﬁcient condition for being disturbance
decoupled do not coincide. However, we presented several
conditions under which these conditions do coincide.
In Chapter 4 and Chapter 5 we studied under what con-
ditions a linear complementarity system or a general linear
multi-modal system is disturbance decoupled; rendering such
systems disturbance decoupled by means of feedback is the
next step. Finding a static state feedback such that the resulting
closed-loop system satisﬁes the necessary condition for dis-
turbance decoupledness becomes a linear algebraic problem
and can be solved mimicking the footsteps for the linear case.
Studying the disturbance decoupling problem under different
feedback schemes is a future research possibility. Regarding
the disturbance decoupling problem for continuous piecewise
afﬁne systems, further research possibilities include investigat-
ing the gap between the necessary conditions and sufﬁcient
conditions as well as studying mode-dependent state feedback.
Another possible future research line is to study the exten-
sion to Filippov solutions. Furthermore, the results for the
linear complementarity systems might be extended to the more
general case with a not necessarily symmetric but positive semi-
deﬁnite matrix H for which there exists a positive symmetric
matrix K such that KGu = NTu for all u ∈ker(H + HT).
124

9.2 fault detection and isolation
9.2
fault detection and isolation
The next geometric control problem we addressed for bimodal
piecewise linear systems is the fault detection and isolation
problem. We used a geometric approach to ﬁnd sufﬁcient con-
ditions for the existence of an observer that produces residuals
that are sufﬁciently informative about the fault. A method
for ﬁnding an asymptotic observer based on bilinear matrix
inequalities has been discussed. A possible future research
direction includes extending these ideas and results towards
multi-modal piecewise linear systems.
As a by-product, in Chapter 7 we considered the fault detec-
tion and isolation problem for a class of linear systems deﬁned
on an undirected graph, containing faultable vertices and ob-
server vertices. We provided a characterization of the so-called
conditioned invariant subspaces of such systems that satisfy the
distance-information preservation property. These subspaces
play a major role in the analysis of fault detection as well as
in the design of fault detectors. Based on this characterization,
we presented a graph-topological sufﬁcient condition for the
so-called output separability requirement, which is the crux of
the fault detection problem in the setting of geometric control.
Furthermore, we have presented a condition under which the
output separability fails for the class of distance-information
preserving matrices. Future research problems include investi-
gating sharper sufﬁcient conditions, devising observer vertex
selection methods and formulating conditions that would guar-
antee the asymptotic stability of fault detectors.
9.3
consensus dynamics with nonlinearities
The last problem that we studied in this thesis is a consensus
problem for a general model of distributed multi-agent sys-
tems deﬁned on a directed graph, with nonlinear discontinuous
functions deﬁned on the nodes and edges. In Chapter 8, we
provided sufﬁcient conditions for all Filippov solutions of a
nonlinear consensus protocol to achieve consensus, whenever
the underlying communication graph contains a directed span-
ning tree and all the nonlinear functions are sign-preserving.
Future research possibilities include extending the results to
multi-agent systems with switching communication topologies
and studying higher-order nonlinear consensus protocols.
125


B I B L I O G RAPHY
R. Agaev and P. Chebotarev. On the spectra of nonsymmetric
Laplacian matrices. Linear Algebra and its Applications, 399:
157–168, 2005.
A. Arapostathis and M. Broucke. Stability and controllability
of planar, conewise linear systems. Systems & Control Letters,
56(2):150–158, 2007.
A. V. Arutyunov. Optimality Conditions: Abnormal and Degen-
erate Problems (Mathematics and Its Applications Volume 526).
Springer-Verlag New York, Inc., 2000.
J. P. Aubin and A. Cellina.
Differential Inclusions: Set-Valued
Maps and Viability Theory, volume 264 of Grundlehren der
mathematischen Wissenschaften. Springer Berlin Heidelberg,
1984.
A. Bacciotti and F. Ceragioli.
Stability and stabilization of
discontinuous systems and nonsmooth Lyapunov functions.
ESAIM: Control, Optimisation and Calculus of Variations, 4:361–
376, 1999.
A. Balluchi, L. Benvenuti, M. D. Di Benedetto, and A. L.
Sangiovanni-Vincentelli. Design of Observers for Hybrid Sys-
tems, pages 76–89. Springer Berlin Heidelberg, Berlin, Hei-
delberg, 2002.
G. Basile and G. Marro. Controlled and conditioned invariant
subspaces in linear system theory. Journal of Optimization
Theory and Applications, 3:306–315, 1969a.
G. Basile and G. Marro. On the observability of linear, time-
invariant systems with unknown inputs. Journal of Optimiza-
tion Theory and Applications, 3:410–415, 1969b.
G. Basile and G. Marro. Controlled and Conditioned Invariants in
Linear System Theory. Englewood Cliffs: Prentice-Hall, 1992.
M. Bürger, D. Zelazo, and F. Allgöwer. Duality and network
theory in passivity-based cooperative control. Automatica, 50
(8):2051–2061, 2014.
127

bibliography
M. K. Camlibel. Complementarity Methods in the Analysis of Piece-
wise Linear Dynamical Systems. PhD Thesis, Tilburg Univer-
sity, 2001.
M. K. Camlibel.
Popov-Belevitch-Hautus type tests for the
controllability of linear complementarity systems. Systems &
Control Letters, 65(5):381–387, 2007.
M. K. Camlibel and J. M. Schumacher. Linear passive systems
and maximal monotone mappings. Mathematical Program-
ming, 157(2):397–420, 2016.
M. K. Camlibel, W. P. M. H. Heemels, and J. M. Schumacher. On
linear passive complementarity systems. European Journal of
Control, 8(3):220–237, 2002.
M. K. Camlibel, W. P. M. H. Heemels, A. J. van der Schaft, and
J. M. Schumacher. Switched networks and complementar-
ity. IEEE Transactions on Circuits and Systems I: Fundamental
Theory and Applications, 50(8):1036–1046, 2003.
M. K. Camlibel, L. Iannelli, and F. Vasca. Modelling switching
power converters as complementarity systems. In Proceedings
of the 43rd IEEE Conference on Decision and Control, pages 2328–
2333, Paradise Islands (The Bahamas), 2004.
M. K. Camlibel, J. S. Pang, and J. Shen. Conewise linear systems:
non-Zenoness and observability. SIAM Journal on Control and
Optimization, 45(5):1769–1800, 2006.
M. K. Camlibel, W. P. M. H. Heemels, and J. M. Schumacher.
Algebraic necessary and sufﬁcient conditions for the con-
trollability of conewise linear systems. IEEE Transactions on
Automatic Control, 53(3):762–774, 2008.
M. K. Camlibel, L. Iannelli, and F. Vasca. Passivity and com-
plementarity.
Mathematical Programming, 145(1-2):531–563,
2014.
K. L. Chung and J. B. Walsh. Markov Processes, Brownian Motion,
and Time Symmetry. Springer New York, 2006.
F. H. Clarke. Optimization and Nonsmooth Analysis. Classics in
Applied Mathematics. Society for Industrial and Applied
Mathematics, 1990.
V. Cocquempot, T. El Mezyani, and M. Staroswiecki. Fault
detection and isolation for hybrid systems using structured
128

bibliography
parity residuals. In 5th Asian Control Conference, 2004, vol-
ume 2, pages 1204–1212, 2004.
G. Conte, A. M. Perdon, and N. Otsuka. The disturbance decou-
pling problem with stability for switching dynamical systems.
Systems & Control Letters, 70:1–7, 2014.
G. Conte, A. M. Perdon, and E. Zattoni. The disturbance decou-
pling problem for jumping hybrid systems. In Proceedings of
the 54th IEEE Conference on Decision and Control, pages 1589–
1594, Osaka (Japan), 2015.
J. Cortés. Finite-time convergent gradient ﬂows with applica-
tions to network consensus. Automatica, 42(11):1993–2000,
2006.
J. Cortés.
Discontinuous dynamical systems.
IEEE Control
Systems Magazine, 28(3):36–73, 2008.
R. W. Cottle, J. S. Pang, and R. E. Stone. The Linear Complemen-
tarity Problem. Boston: Academic Press, 1992.
C. De Persis and P. Frasca. Robust self-triggered coordina-
tion with ternary controllers. IEEE Transactions on Automatic
Control, 58(12):3024–3038, 2013.
D. V. Dimarogonas and K. H. Johansson. Stability analysis for
multi-agent systems using the incidence matrix: Quantized
communication and formation control.
Automatica, 46(4):
695–700, 2010.
A. R. F. Everts and M. K. Camlibel. The disturbance decoupling
problem for continuous piecewise afﬁne systems. In Proceed-
ings of the 53rd IEEE Conference on Decision and Control, Los
Angeles (USA), 2014a.
A. R. F. Everts and M. K. Camlibel. Disturbance decoupling for
continuous piecewise linear bimodal systems. In Proceedings
of the 21st International Symposium on Mathematical Theory of
Networks and Systems, Groningen (The Netherlands), 2014b.
A. R. F. Everts and M. K. Camlibel. When is a linear comple-
mentarity system disturbance decoupled? In M. N. Belur,
M. K. Camlibel, P. Rapisarda, and J. M. A. Scherpen, editors,
Mathematical Control Theory II: Behavioral Systems and Robust
Control, Lecture Notes in Control and Information Sciences,
pages 243–255. Springer, 2015.
129

bibliography
A. R. F. Everts and M. K. Camlibel. When is a linear multi-
modal system disturbance decoupled? Systems and Control
Letters, 2016. In press.
A. R. F. Everts, P. Rapisarda, and M. K. Camlibel. A geomet-
ric approach to fault detection and isolation for a class of
bimodal piecewise-linear systems. Under preparation, 2016.
A. F. Filippov. Differential Equations with Discontinuous Right-
hand Sides: Control Systems. Mathematics and its Applications.
Springer, 1988.
P. M. Frank. Fault diagnosis in dynamic systems using analyt-
ical and knowledge based redundancy: a survey and some
new results. Automatica, 26:459–474, 1990.
I. Gohberg, P. Lancaster, and L. Rodman. Invariant Subspaces
of Matrices with Applications, volume 51 of Classics in Applied
Mathematics. Society for Industrial and Applied Mathematics
(SIAM), 2006.
L. Han, A. Tiwari, M. K. Camlibel, and J. S. Pang.
Conver-
gence of time-stepping schemes for passive and extended
linear complementarity systems. SIAM Journal on Numerical
Analysis, 47(5):3768–3796, 2009.
W. P. M. H. Heemels. Linear Complementarity Systems: A Study
in Hybrid Dynamics. PhD Thesis, Eindhoven University of
Technology, 1999.
W. P. M. H. Heemels and B. Brogliato. The complementarity
class of hybrid dynamical systems. European Journal of Con-
trol, 26(4):651–677, 2003.
W. P. M. H. Heemels, J. M. Schumacher, and S. Weiland. Linear
complementarity systems. SIAM Journal on Applied Mathe-
matics, 60(4):1234–1269, 2000.
W. P. M. H. Heemels, M. K. Camlibel, and J. M. Schumacher.
On the dynamic analysis of piecewise-linear networks. IEEE
Transactions on Circuits and Systems I: Fundamental Theory and
Applications, 49(3):315–327, 2002.
W. P. M. H. Heemels, M. K. Camlibel, J. M. Schumacher, and
B. Brogliato. Observer-based control of linear complemen-
tarity systems. International Journal of Robust and Nonlinear
Control, 21(10):1193–1218, 2011.
130

bibliography
D. Hershkowitz and H. Schneider. Ranks of zero patterns and
sign patterns. Linear and Multilinear Algebra, 34:3–19, 1993.
I. Hwang, S. Kim, Y. Kim, and C. E. Seah. A survey of fault de-
tection, isolation, and reconﬁguration methods. IEEE Trans-
actions on Control Systems Technology, 18(3):636–653, 2010.
R. Isermann. Fault-Diagnosis Systems: An Introduction from Fault
Detection to Fault Tolerance. Springer-Verlag, 2006.
R. Isermann and P. Bailé. Trends in the application of model-
based fault detection and diagnosis of technical processes.
Control Engineering Practice, 5(5):709–719, 1997.
A. Isidori. Nonlinear Control Systems. Communications and
Control Engineering. Springer, 1995.
S. Jafari, A. Ajorlou, and A. G. Aghdam. Leader localization
in multi-agent systems subject to failure: A graph-theoretic
approach. Automatica, 47(8):1744–1750, 2011.
M. Jafarian and C. De Persis. Formation control using binary
information. Automatica, 53:125–135, 2015.
A. L. Juloski, W. P. M. H. Heemels, and S. Weiland. Observer
design for a class of piecewise linear systems. International
Journal of Robust and Nonlinear Control, 17:1387–1404, 2007.
M. D. Kaba. Applications of geometric control: constrained systems
and switched systems. PhD Thesis, University of Groningen,
2001.
D. Liberzon.
Switching in Systems and Control.
Birkhauser.
Boston, Basel, Berlin, 2003.
Z. Lin, B. Francis, and M. Maggiore.
State agreement for
continuous-time coupled nonlinear systems. SIAM Journal
on Control and Optimization, 46(1):288–307, 2007.
J. Löfberg. Yalmip: A toolbox for modeling and optimization
in MATLAB. In Proceedings of IEEE Conference on Computer
Aided Control System Design, Taipei, Taiwan, 2004.
M. A. Massoumnia. A geometric approach to the synthesis
of failure detection ﬁlters. IEEE Transactions on Automatic
Control, 31(9):839–846, 1986a.
M. A. Massoumnia. A geometric approach to failure detection and
identiﬁcation in linear systems. PhD thesis, MIT, 1986b.
131

bibliography
N. Monshizadeh and C. De Persis.
Output agreement in
networks with unmatched disturbances and algebraic con-
straints. In Proceedings of the 54th IEEE Conference on Decision
and Control, 2015.
S. Narasimhan, G. Biswas, G. Karsai, T. Pasternak, and F. Zhao.
Building observers to address fault isolation and control
problems in hybrid dynamic systems. In IEEE International
Conference on Systems, Man, and Cybernetics, volume 4, pages
2393–2398 vol.4, 2000.
H. Nijmeijer and A. J. van der Schaft.
Nonlinear Dynamical
Control Systems. Springer, 1990.
N. Otsuka. Disturbance decoupling with quadratic stability
for switched linear systems. Systems & Control Letters, 59(6):
349–352, 2010.
N. Otsuka. Disturbance decoupling via dynamic output feed-
back for switched linear systems. In Proceedings of the IFAC
World Congress, 2011.
N. Otsuka. Disturbance decoupling via measurement feedback
for switched linear systems. Systems & Control Letters, 82:
99–107, 2015.
B. Paden and S. Sastry. A calculus for computing Filippov’s dif-
ferential inclusion with application to the variable structure
control of robot manipulators. IEEE Transactions on Circuits
and Systems, 34(1):73–82, 1987.
A. Papachristodoulou, A. Jadbabaie, and U. Münz. Effects of
delay in multi-agent consensus and oscillator synchroniza-
tion. IEEE Transactions on Automatic Control, 55(6):1471–1477,
June 2010.
F. Pasqualetti, A. Bicchi, and F. Bullo. Consensus computation
in unreliable networks: A system theoretic approach. IEEE
Transactions on Automatic Control, 57:90–104, 2012.
M. A. Rahimian and A. G. Aghdam. Structural controllability
of multi-agent networks: Robustness against simultaneous
failures. Automatica, 49(11):3149–3157, 2013.
P. Rapisarda, A. R. F. Everts, and M. K. Camlibel. Fault detection
and isolation for systems deﬁned over graphs. Proceedings of
the 54th IEEE Conference on Decision and Control, 2015. Osaka
(Japan).
132

bibliography
W. Ren, R. W. Beard, and T. W. McLain. Coordination variables
and consensus building in multiple vehicle systems. In V. Ku-
mar, N. Leonard, and A. Morse, editors, Cooperative Control,
volume 309 of Lecture Notes in Control and Information Science,
pages 171–188. Springer Berlin Heidelberg, 2005.
R. T. Rockafellar and R. J. B. Wets.
Variational Analysis, vol-
ume 317 of Grundlehren der mathematischen Wissenschaften.
Springer, 2009.
R. O. Saber and R. M. Murray. Consensus protocols for networks
of dynamic agents.
In Proceedings of the American Control
Conference, volume 2, pages 951–956, 2003.
S. Scholtes.
Introduction to Piecewise Differentiable Equations.
Springer New York, 2012.
J. M. Schumacher. Complementarity systems in optimization.
Mathematical Programming Series B, 101:263–295, 2004.
J. Shen.
Robust non-Zenoness of piecewise afﬁne systems
with applications to linear complementarity systems. SIAM
Journal on Optimization, 24:2023–2056, 2014.
G. V. Smirnov. Introduction to the Theory of Differential Inclusions.
American Mathematical Society, 2002.
Z. Sun and S. S. Ge. Switched Linear Systems: Control and Design.
Springer-Verlag, London, 2005.
L. Q. Thuan and M. K. Camlibel. Controllability and stabiliz-
ability of a class of continuous piecewise afﬁne dynamical
systems. SIAM Journal of Control and Optimization, 52(3):1914–
1934, 2014.
H. L. Trentelman, A. A. Stoorvogel, and M. L. J. Hautus. Control
Theory for Linear Systems. Springer, London, 2001.
A. J. van der Schaft and J. M. Schumacher. The complementary-
slackness class of hybrid systems. Mathematics of Control,
Signals and Systems, 9:266–301, 1996.
A. J. van der Schaft and J. M. Schumacher. Complementarity
modelling of hybrid systems. IEEE Transactions on Automatic
Control, 43(4):483–490, 1998.
A. J. van der Schaft and J. M. Schumacher. An Introduction to
Hybrid Dynamical Systems. Springer-Verlag, 2000.
133

bibliography
F. Vasca, L. Iannelli, M. K. Camlibel, and R. Frasca. A new per-
spective for modeling power electronics converters: Comple-
mentarity framework. IEEE Transactions on Power Electronics,
24(2):456–468, 2009.
D. Wang, W. Wang, and P. Shi.
Robust fault detection for
switched linear systems with state delays. IEEE Transactions
on Systems, Man, and Cybernetics, Part B: Cybernetics, 39(3):
800–805, 2009.
J. Wei, A. R. F. Everts, M. K. Camlibel, and A. J. van der Schaft.
Consensus dynamics with arbitrary sign-preserving nonlin-
earities. Automatica, 2016. Accepted for publication.
W. M. Wonham. Linear Multivariable Control: a Geometric Ap-
proach. Applications of Mathematics. Springer-Verlag, 1985.
W. M. Wonham and A. S. Morse. Decoupling and pole assign-
ment in linear multivariable systems: A geometric approach.
Journal of Optimization Theory and Applications, 8:1–18, 1970.
E. Yurtseven, W. P. M. H. Heemels, and M. K. Camlibel. Dis-
turbance decoupling of switched linear systems. Systems &
Control Letters, 61(1):69–78, 2012.
E. Zattoni and G. Marro. Measurable disturbance rejection
with quadratic stability in continuous-time linear switching
systems.
In Proceedings of the European Control Conference,
2013.
E. Zattoni, A. M. Perdon, and G. Conte. Disturbance decou-
pling with closed-loop modes stability in switched linear
systems. IEEE Transactions on Automatic Control, 61(10):3115–
3121, 2016.
W. Zhonghua, Y. Bo, C. Lin, and Z. Shusheng. Robust adaptive
deadzone compensation of DC servo system. IEE Proceedings
of Control Theory and Applications, 153(6):709–713, 2006.
134

S U M M A RY
In this thesis, we used ideas and results from control theory to
study several problems for two types of nonsmooth dynamical
systems; linear multi-modal systems and multi-agent systems
with a nonlinear communication protocol.
The ﬁrst problem that we addressed is the disturbance decou-
pling problem for linear multi-modal systems. We started by
studying the disturbance decoupling problem for a simple class
of piecewise linear systems: continuous bimodal systems. We
presented necessary and sufﬁcient conditions for such systems
to be disturbance decoupled. Furthermore, we have given a
complete characterization of the solvability of the disturbance
decoupling problem with both state feedback controllers and
dynamic feedback controllers.
Thereupon we directed our attention to more general con-
tinuous piecewise afﬁne systems. We established necessary
conditions as well as sufﬁcient conditions for a piecewise afﬁne
system to be disturbance decoupled. Furthermore, we identi-
ﬁed a number of particular cases for which these conditions
coincide. Additionally, we provided conditions for the existence
of a mode-independent static feedback controller that renders
a given piecewise afﬁne system disturbance decoupled.
After that we studied the disturbance decoupling problem
for linear complementarity systems of index zero. Such systems
can be rewritten as a particular class of linear multi-modal sys-
tems. We exploited the geometric structure that the resulting
linear subsystems exhibit and provided necessary and sufﬁ-
cient conditions for a linear complementarity system to be
disturbance decoupled.
Finally, we tackle the disturbance decoupling problem for a
general class of linear multi-modal systems. We presented nec-
essary conditions and sufﬁcient conditions under which such
multi-modal systems are disturbance decoupled. Furthermore,
we presented several conditions under which these conditions
coincide. All presented conditions are geometric in nature and
easily veriﬁable. These results generalize almost all results in
the ﬁrst chapters of this thesis as well as the existing literature
on switched linear systems. In addition, these results led to
novel necessary and sufﬁcient conditions for passive-like linear
complementarity systems.
135

summary
The second geometric control problem we addressed is the
fault detection and isolation problem for bimodal piecewise
linear systems. Using a geometric approach, we presented suf-
ﬁcient conditions for the existence of an observer that produces
residuals that are sufﬁciently informative about the fault. In
addition, we discussed a method for ﬁnding an asymptotic
observer based on bilinear matrix inequalities.
As a by-product, we studied the fault detection and isolation
problem for a class of linear systems deﬁned on an undirected
graph, containing faultable vertices and observer vertices. In
this graph, two disjoint sets of agents are identiﬁed in the
network: those prone to failure and those whose output is
measurable. For systems that satisfy the distance-information
preservation property we provided a characterization of the
so-called conditioned invariant subspaces. Based on this charac-
terization, we presented a graph-theoretical sufﬁcient condition
for the so-called output separability requirement, which is the
crux of the fault detection problem in the setting of geometric
control.
The last problem that we have studied in this thesis is a
consensus problem for multi-agent systems deﬁned on a di-
rected graph, with nonlinear discontinuous functions deﬁned
on the nodes and edges. We provided sufﬁcient conditions
for all Filippov solutions of a nonlinear consensus protocol to
achieve consensus, whenever the underlying communication
graph contains a directed spanning tree and all the nonlinear
functions are sign-preserving.
136

S A M E N VATTING
In dit proefschrift maken we gebruik van ideeën en resultaten
uit de systeem- en regeltheorie om verschillende problemen te
bestuderen voor twee soorten niet-gladde dynamische syste-
men, namelijk lineaire multimodale systemen en multi-agent
systemen met een niet-lineair communicatieprotocol.
Het eerste probleem waar we ons op richten is het probleem
van storingsontkoppeling voor lineaire multimodale systemen.
Een systeem is storingsontkoppeld als het uitgangssignaal van
het systeem onafhankelijk is van eventuele storingsingangen.
We bestuderen het storingsontkoppelingsprobleem eerst voor
een eenvoudige klasse van stuksgewijs lineaire systemen, na-
melijk bimodale systemen. In Hoofdstuk 2 presenteren we
noodzakelijke en voldoende voorwaarden voor deze systemen
om storingsontkoppeld te zijn. Verder geven we een volledige
karakterisering van de oplosbaarheid van het storingsontkop-
pelingsprobleem met behulp van toestandsterugkoppeling en
dynamische uitgangsterugkoppeling.
Daarna richten we ons op algemenere stukgewijs afﬁene sys-
temen. In dergelijke systemen is de toestandsruimte opgedeeld
in polyhedrale deelgebieden, elk met een corresponderend af-
ﬁen dynamisch systeem. Welk afﬁen systeem actief is, hangt
af van het deelgebied waarin de toestand zich op dat moment
bevindt. In Hoofdstuk 3 geven we noodzakelijke voorwaarden
evenals voldoende voorwaarden voor storingsontkoppeling van
een stuksgewijs afﬁen systeem. Bovendien identiﬁceren we een
aantal bijzondere gevallen waarin deze voorwaarden samenval-
len. Daarnaast geven we voorwaarden voor het bestaan van een
mode-onafhankelijke toestandsterugkoppeling die een gegeven
stuksgewijs afﬁen systeem storingsontkoppeld maakt.
Vervolgens onderzoeken we in Hoofdstuk 4 het storingsont-
koppelingprobleem voor lineaire complementariteitssystemen
met index nul. Deze systemen kunnen worden herschreven als
lineaire multimodale systemen. We maken gebruik van de geo-
metrische structuur van de resulterende lineaire subsystemen
om noodzakelijke en voldoende voorwaarden te vinden voor
de storingsontkoppeling van deze lineaire complementariteits-
systemen.
Tot slot bestuderen we het storingsontkoppelingsprobleem
voor een algemene klasse van lineaire multimodale systemen
137

samenvatting
in Hoofdstuk 5. We presenteren noodzakelijke voorwaarden
en voldoende voorwaarden voor de storingsontkoppeling van
dergelijke multimodale systemen. Verder beschrijven we een
aantal speciale gevallen waarin deze voorwaarden samenvallen.
Alle gepresenteerde voorwaarden zijn meetkundig van aard en
gemakkelijk te veriﬁëren. Deze resultaten generaliseren vrijwel
alle resultaten in de eerste hoofdstukken van dit proefschrift
en ook die in de bestaande literatuur over geschakelde lineaire
systemen. Daarnaast gebruiken we deze resultaten om nieuwe
noodzakelijke en voldoende voorwaarden af te leiden voor
storingsontkoppeling van een ander type lineaire complemen-
tariteitssystemen, namelijk die systemen die passief gemaakt
kunnen worden met pole-shifting.
Het tweede probleem waar we ons op richten is het probleem
van foutdetectie en -isolatie voor bimodale stuksgewijs line-
aire systemen. Gebruikmakend van de meetkundige aanpak
binnen de lineaire systeemtheorie, presenteren we voldoende
voorwaarden voor het bestaan van een op een waarnemer geba-
seerd foutdetectieﬁlter. Daarnaast bespreken we een methode
voor het vinden van een asymptotische waarnemer gebaseerd
op bilineaire matrixongelijkheden.
Vervolgens bestuderen we foutdetectie en -isolatie voor een
klasse van lineaire multi-agent systemen. Zulke systemen zijn
gedeﬁnieerd op een ongerichte graaf, waarbij elke knoop een
agent representeert. In deze graaf wijzen we twee disjuncte deel-
verzamelingen van agents aan: de storingsgevoelige agents en
de waarnemende agents. Het doel is om uit de uitgangssignalen
van de waarnemende agents af te leiden of de storingsgevoelige
agents aan storing onderhevig zijn, en zo ja, welke agents dat
dan zijn. Voor afstandsinformatiebehoudende systemen geven
we een karakterisering van de zogenaamde conditioneel invari-
ante deelruimten. Gebaseerd op deze karakterisering vinden
we vervolgens een graaftheoretische voldoende voorwaarde
voor foutdetectie en -isolatie.
Het laatste probleem dat we bestuderen in dit proefschrift
is een consensusprobleem voor multi-agent systemen, waarbij
de communicatiegraaf gericht is en er bovendien niet-lineaire
discontinue functies voorkomen op de knopen of kanten. In het
geval dat de onderliggende communicatiegraaf een gerichte
opspannende boom bevat en alle niet-lineaire functies teken-
behoudend zijn, geven we voldoende voorwaarden waaronder
alle Filippov oplossingen van een dergelijk niet-lineaire consen-
susprotocol consensus bereiken.
138

B I O G R A PHY
Annerosa Roelienke Fleur Everts was born on 8 June 1988 in
Hoogeveen, The Netherlands. She obtained both her bachelor’s
degree in Mathematics and her master’s degree in Algebra and
Geometry with the designation cum laude from the University
of Groningen. After that she started her PhD in the research
group Systems, Control and Applied Analysis (SCAA) at the
University of Groningen, under the supervision of M. Kanat
Çamlıbel. Her research interests include systems and control
theory, geometric control theory, piecewise afﬁne dynamical
systems, hybrid systems, multi-agent networks, and graph
theory.
journal papers
A.R.F. Everts, M.K. Camlibel, When is a linear multi-modal
system disturbance decoupled? Systems & Control Letters. In
press, 2016.
J. Wei, A.R.F. Everts, M.K. Camlibel and A.J. van der Schaft.
Consensus dynamics with arbitrary sign-preserving nonlin-
earities. Automatica. Accepted for publication, 2016.
A.R.F. Everts, P. Rapisarda, M.K. Camlibel, A geometric ap-
proach to fault detection and isolation for a class of bimodal
piecewise-linear systems. Under preparation.
book chapters
A.R.F. Everts and M.K. Camlibel. When is a linear comple-
mentarity system disturbance decoupled? In M.N. Belur,
M.K. Camlibel, P. Rapisarda, and J.M.A. Scherpen, editors,
Mathematical Control Theory II: Behavioral Systems and Robust
Control. Lecture Notes in Control and Information Sciences,
pages 243–255. Springer, 2015.
peer-reviewed conference papers
P. Rapisarda, A.R.F. Everts, and M.K. Camlibel. Fault detection
and isolation for systems deﬁned over graphs. In Proc. of the
139

biography
54th IEEE Conference on Decision and Control. Osaka, Japan,
2015.
A.R.F. Everts and M.K. Camlibel. The disturbance decoupling
problem for continuous piecewise afﬁne systems. In Proc. of
the 53rd IEEE Conference on Decision and Control. Los Angeles,
USA, 2014.
A.R.F. Everts and M.K. Camlibel. Disturbance decoupling for
continuous piecewise linear bimodal systems. In Proc. of the
21st International Symposium on Mathematical Theory of Net-
works and Systems. Groningen, The Netherlands, 2014.
140

A C K N O WLEDGEMENTS
This thesis would not have existed without the help and sup-
port of many people. I would like to use this opportunity to
express my gratitude to all of them for their support, trust,
constructive criticism, humor, and friendly advice throughout
the course of this PhD project.
First of all, I would like to express my utmost gratitude to
my promotors Kanat Camlibel and Arjan van der Schaft for
their trust in me and for giving me the opportunity to pursue
my PhD. I would like to thank Kanat, my ‘scientiﬁc father’,
for introducing me to the academic world. I learned so much
from you; on doing research and about writing articles, reviews,
and letters. I very much enjoyed doing research together. I am
grateful towards Arjan van der Schaft for always being positive
and supportive.
I would like to thank the members of the assessment com-
mittee, Prof. dr. A.M. Perdon, Prof. dr. J.M. Schumacher, and
Prof. dr. H.L. Trentelman, for reading the manuscript of my
thesis and making valuable comments.
Paolo Rapisarda, I very much enjoyed collaborating with you,
which resulted in Chapter 6 and Chapter 7 of this thesis, as
well as experiencing kabuki and karaoke with you in Japan.
I am grateful for the ﬁnancial support from the NWO for
this PhD research under the project CODAVI (613.001.108).
It is my pleasure to thank all my colleagues from the third
and fourth ﬂoor of the Bernoulliborg, for all those enjoyable
conversations, lunches, jokes, game nights, and frisbee sessions.
I am especially grateful towards my wonderful ofﬁce mates
and scientiﬁc brothers, Devrim Mustafa and Jieqiang Wei, for
making our ofﬁce such an enjoyable place to work during
the ﬁrst years of my PhD. Thank you so much for the lovely
conversations on culture, sports, and life in general. I miss
you guys! Jieqiang, I greatly enjoyed the pleasant collaboration
that resulted in Chapter 8 of this thesis and of course our trip
to Los Angeles. Vladimir, thank you for agreeing to be my
paranymph, and for all the pancakes and wonderful game
nights. Hidde-Jan, thanks for being my paranymph, for always
being joyful, for meticulously checking some of my texts, and
for helping me with LaTeX and other computer problems. Tjerk
and Hidde-Jan, thank you for being such pleasant company on
141

acknowledgements
our exciting trip to Japan. Mónika and Pooya, thank you for
your cheerful presence in our corridor, at game nights, while
watching performances, and during Benelux meetings. Harry
Trentelman, thank you for livening up our corridor, interrupting
my meetings with Kanat to share your opinions and jokes, and
helping me with the Dutch summary. Furthermore, I would
like to thank the secretaries for their support.
To all my friends, thank you for supporting me, giving me
advice, and taking my mind of my research with dinners, board
games, computer games, dancing, puzzle quests, and juggling.
I could not have done this without the support and uncondi-
tional love of my family. I am very grateful towards my parents,
who always supported me, but never pushed me. Maarten,
thank you for providing the template for this thesis and for
your support with LaTeX and BibTeX. Hanneke, thanks to
your never-ending creativity, the cover of this thesis bears a
wonderful artistic impression of polyhedral subdivisions and
multi-agent systems.
Last but certainly not least, I am immensely thankful to Jelle,
mijn lief, for his support, love, patience, trust, and encourage-
ment throughout this journey that is called a PhD. ♥
Anneroos
Groningen, 24 October 2016
142

colophon
This thesis was typeset with LATEX2ε. The style of this thesis is
based on André Miede’s excellent Classic Thesis Style.


